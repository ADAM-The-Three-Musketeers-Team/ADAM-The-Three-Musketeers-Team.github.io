var nx=Object.defineProperty;var ax=(ye,ge,t)=>ge in ye?nx(ye,ge,{enumerable:!0,configurable:!0,writable:!0,value:t}):ye[ge]=t;var tc=(ye,ge,t)=>(ax(ye,typeof ge!="symbol"?ge+"":ge,t),t),Sp=(ye,ge,t)=>{if(!ge.has(ye))throw TypeError("Cannot "+t)};var Ep=(ye,ge,t)=>(Sp(ye,ge,"read from private field"),t?t.call(ye):ge.get(ye)),zf=(ye,ge,t)=>{if(ge.has(ye))throw TypeError("Cannot add the same private member more than once");ge instanceof WeakSet?ge.add(ye):ge.set(ye,t)},p0=(ye,ge,t,P)=>(Sp(ye,ge,"write to private field"),P?P.call(ye,t):ge.set(ye,t),t);var Bf=(ye,ge,t)=>(Sp(ye,ge,"access private method"),t);(function(){const ge=document.createElement("link").relList;if(ge&&ge.supports&&ge.supports("modulepreload"))return;for(const R of document.querySelectorAll('link[rel="modulepreload"]'))P(R);new MutationObserver(R=>{for(const h of R)if(h.type==="childList")for(const u of h.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&P(u)}).observe(document,{childList:!0,subtree:!0});function t(R){const h={};return R.integrity&&(h.integrity=R.integrity),R.referrerpolicy&&(h.referrerPolicy=R.referrerpolicy),R.crossorigin==="use-credentials"?h.credentials="include":R.crossorigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function P(R){if(R.ep)return;R.ep=!0;const h=t(R);fetch(R.href,h)}})();const ix=[[5.1,3.5,1.4,.2,"setosa"],[4.9,3,1.4,.2,"setosa"],[4.7,3.2,1.3,.2,"setosa"],[4.6,3.1,1.5,.2,"setosa"],[5,3.6,1.4,.2,"setosa"],[5.4,3.9,1.7,.4,"setosa"],[4.6,3.4,1.4,.3,"setosa"],[5,3.4,1.5,.2,"setosa"],[4.4,2.9,1.4,.2,"setosa"],[4.9,3.1,1.5,.1,"setosa"],[5.4,3.7,1.5,.2,"setosa"],[4.8,3.4,1.6,.2,"setosa"],[4.8,3,1.4,.1,"setosa"],[4.3,3,1.1,.1,"setosa"],[5.8,4,1.2,.2,"setosa"],[5.7,4.4,1.5,.4,"setosa"],[5.4,3.9,1.3,.4,"setosa"],[5.1,3.5,1.4,.3,"setosa"],[5.7,3.8,1.7,.3,"setosa"],[5.1,3.8,1.5,.3,"setosa"],[5.4,3.4,1.7,.2,"setosa"],[5.1,3.7,1.5,.4,"setosa"],[4.6,3.6,1,.2,"setosa"],[5.1,3.3,1.7,.5,"setosa"],[4.8,3.4,1.9,.2,"setosa"],[5,3,1.6,.2,"setosa"],[5,3.4,1.6,.4,"setosa"],[5.2,3.5,1.5,.2,"setosa"],[5.2,3.4,1.4,.2,"setosa"],[4.7,3.2,1.6,.2,"setosa"],[4.8,3.1,1.6,.2,"setosa"],[5.4,3.4,1.5,.4,"setosa"],[5.2,4.1,1.5,.1,"setosa"],[5.5,4.2,1.4,.2,"setosa"],[4.9,3.1,1.5,.2,"setosa"],[5,3.2,1.2,.2,"setosa"],[5.5,3.5,1.3,.2,"setosa"],[4.9,3.6,1.4,.1,"setosa"],[4.4,3,1.3,.2,"setosa"],[5.1,3.4,1.5,.2,"setosa"],[5,3.5,1.3,.3,"setosa"],[4.5,2.3,1.3,.3,"setosa"],[4.4,3.2,1.3,.2,"setosa"],[5,3.5,1.6,.6,"setosa"],[5.1,3.8,1.9,.4,"setosa"],[4.8,3,1.4,.3,"setosa"],[5.1,3.8,1.6,.2,"setosa"],[4.6,3.2,1.4,.2,"setosa"],[5.3,3.7,1.5,.2,"setosa"],[5,3.3,1.4,.2,"setosa"],[7,3.2,4.7,1.4,"versicolor"],[6.4,3.2,4.5,1.5,"versicolor"],[6.9,3.1,4.9,1.5,"versicolor"],[5.5,2.3,4,1.3,"versicolor"],[6.5,2.8,4.6,1.5,"versicolor"],[5.7,2.8,4.5,1.3,"versicolor"],[6.3,3.3,4.7,1.6,"versicolor"],[4.9,2.4,3.3,1,"versicolor"],[6.6,2.9,4.6,1.3,"versicolor"],[5.2,2.7,3.9,1.4,"versicolor"],[5,2,3.5,1,"versicolor"],[5.9,3,4.2,1.5,"versicolor"],[6,2.2,4,1,"versicolor"],[6.1,2.9,4.7,1.4,"versicolor"],[5.6,2.9,3.6,1.3,"versicolor"],[6.7,3.1,4.4,1.4,"versicolor"],[5.6,3,4.5,1.5,"versicolor"],[5.8,2.7,4.1,1,"versicolor"],[6.2,2.2,4.5,1.5,"versicolor"],[5.6,2.5,3.9,1.1,"versicolor"],[5.9,3.2,4.8,1.8,"versicolor"],[6.1,2.8,4,1.3,"versicolor"],[6.3,2.5,4.9,1.5,"versicolor"],[6.1,2.8,4.7,1.2,"versicolor"],[6.4,2.9,4.3,1.3,"versicolor"],[6.6,3,4.4,1.4,"versicolor"],[6.8,2.8,4.8,1.4,"versicolor"],[6.7,3,5,1.7,"versicolor"],[6,2.9,4.5,1.5,"versicolor"],[5.7,2.6,3.5,1,"versicolor"],[5.5,2.4,3.8,1.1,"versicolor"],[5.5,2.4,3.7,1,"versicolor"],[5.8,2.7,3.9,1.2,"versicolor"],[6,2.7,5.1,1.6,"versicolor"],[5.4,3,4.5,1.5,"versicolor"],[6,3.4,4.5,1.6,"versicolor"],[6.7,3.1,4.7,1.5,"versicolor"],[6.3,2.3,4.4,1.3,"versicolor"],[5.6,3,4.1,1.3,"versicolor"],[5.5,2.5,4,1.3,"versicolor"],[5.5,2.6,4.4,1.2,"versicolor"],[6.1,3,4.6,1.4,"versicolor"],[5.8,2.6,4,1.2,"versicolor"],[5,2.3,3.3,1,"versicolor"],[5.6,2.7,4.2,1.3,"versicolor"],[5.7,3,4.2,1.2,"versicolor"],[5.7,2.9,4.2,1.3,"versicolor"],[6.2,2.9,4.3,1.3,"versicolor"],[5.1,2.5,3,1.1,"versicolor"],[5.7,2.8,4.1,1.3,"versicolor"],[6.3,3.3,6,2.5,"virginica"],[5.8,2.7,5.1,1.9,"virginica"],[7.1,3,5.9,2.1,"virginica"],[6.3,2.9,5.6,1.8,"virginica"],[6.5,3,5.8,2.2,"virginica"],[7.6,3,6.6,2.1,"virginica"],[4.9,2.5,4.5,1.7,"virginica"],[7.3,2.9,6.3,1.8,"virginica"],[6.7,2.5,5.8,1.8,"virginica"],[7.2,3.6,6.1,2.5,"virginica"],[6.5,3.2,5.1,2,"virginica"],[6.4,2.7,5.3,1.9,"virginica"],[6.8,3,5.5,2.1,"virginica"],[5.7,2.5,5,2,"virginica"],[5.8,2.8,5.1,2.4,"virginica"],[6.4,3.2,5.3,2.3,"virginica"],[6.5,3,5.5,1.8,"virginica"],[7.7,3.8,6.7,2.2,"virginica"],[7.7,2.6,6.9,2.3,"virginica"],[6,2.2,5,1.5,"virginica"],[6.9,3.2,5.7,2.3,"virginica"],[5.6,2.8,4.9,2,"virginica"],[7.7,2.8,6.7,2,"virginica"],[6.3,2.7,4.9,1.8,"virginica"],[6.7,3.3,5.7,2.1,"virginica"],[7.2,3.2,6,1.8,"virginica"],[6.2,2.8,4.8,1.8,"virginica"],[6.1,3,4.9,1.8,"virginica"],[6.4,2.8,5.6,2.1,"virginica"],[7.2,3,5.8,1.6,"virginica"],[7.4,2.8,6.1,1.9,"virginica"],[7.9,3.8,6.4,2,"virginica"],[6.4,2.8,5.6,2.2,"virginica"],[6.3,2.8,5.1,1.5,"virginica"],[6.1,2.6,5.6,1.4,"virginica"],[7.7,3,6.1,2.3,"virginica"],[6.3,3.4,5.6,2.4,"virginica"],[6.4,3.1,5.5,1.8,"virginica"],[6,3,4.8,1.8,"virginica"],[6.9,3.1,5.4,2.1,"virginica"],[6.7,3.1,5.6,2.4,"virginica"],[6.9,3.1,5.1,2.3,"virginica"],[5.8,2.7,5.1,1.9,"virginica"],[6.8,3.2,5.9,2.3,"virginica"],[6.7,3.3,5.7,2.5,"virginica"],[6.7,3,5.2,2.3,"virginica"],[6.3,2.5,5,1.9,"virginica"],[6.5,3,5.2,2,"virginica"],[6.2,3.4,5.4,2.3,"virginica"],[5.9,3,5.1,1.8,"virginica"]],ox=ix;function sx(){return ox.slice()}const Hp=ye=>new Promise(ge=>setTimeout(ge,ye));window.getValidData=async()=>(await Hp(1e3),{x:[1999,2e3,2001,2002],y:[10,15,13,17]});window.getAnotherValidData=async()=>(await Hp(1e3),{x:[1,2,3,4,5,6,7,8,9],y:[1,2,3,4,5,6,7,8,9]});window.getInvalidData=async()=>(await Hp(2e3),[[1,2,3]]);window.syncFn=()=>[[1,2,3],[4,5,6]];window.loadIrisDataset=async()=>sx();const lx=`.plot-space{height:800px;width:800px;border:1px black dashed;display:flex;align-items:center;justify-content:center}.error-msg{position:relative;color:red;text-align:center;font-weight:600}.error-msg:before{position:absolute;bottom:100%;left:0;right:0;content:"\\274c";font-size:12px;color:red}.loading:after{content:"";box-sizing:border-box;display:block;width:64px;height:64px;margin:8px;border:8px solid #fff;border-radius:50%;animation:lds-ring 1.2s cubic-bezier(.5,0,.5,1) infinite;border-color:blue transparent transparent transparent}.loading{position:relative}.loading:after:nth-child(1){animation-delay:-.45s}.loading:after:nth-child(2){animation-delay:-.3s}.loading:after:nth-child(3){animation-delay:-.15s}@keyframes lds-ring{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.js-plotly-plot .plotly .main-svg{position:absolute;top:0;left:0;pointer-events:none}
`;var ah,Iv,ng,zv,ag,Bv,ig,Nv,og,Ov,sg,zh,Pp,Uv,lg;const Of=class extends HTMLElement{constructor(t){super();zf(this,Iv);zf(this,zv);zf(this,Bv);zf(this,Nv);zf(this,Ov);zf(this,zh);zf(this,Uv);tc(this,"dataLoaderFn",null);tc(this,"data",null);zf(this,ah,null);tc(this,"plotSpace",null);Bf(this,Nv,og).call(this),Bf(this,Iv,ng).call(this,t)}static get attrNames(){return{dataLoader:"dataloader"}}displayError(t,P){let R=document.createElement("p");throw R.textContent=t,R.classList.add(Of.errorMsgClassName),R.part.add(Of.errorMsgClassName),this.plotSpace.appendChild(R),Bf(this,zh,Pp).call(this),P}async connectedCallback(){Bf(this,Ov,sg).call(this),Bf(this,Uv,lg).call(this),await this.validateData(),this.analyzeAndVisualizeData(),Bf(this,zh,Pp).call(this)}get dataLoaderAttr(){return this.getAttribute(Of.attrNames.dataLoader)}};let $c=Of;ah=new WeakMap,Iv=new WeakSet,ng=function(t){p0(this,ah,this.attachShadow({mode:"closed"})),Bf(this,zv,ag).call(this,t),Bf(this,Bv,ig).call(this)},zv=new WeakSet,ag=function(t){let P=document.createElement("style");P.innerHTML=t,Ep(this,ah).appendChild(P)},Bv=new WeakSet,ig=function(){this.plotSpace=document.createElement("div"),Ep(this,ah).appendChild(this.plotSpace),this.plotSpace.classList.add(Of.plotSpaceClassName),this.plotSpace.part.add(Of.plotSpaceClassName)},Nv=new WeakSet,og=function(){this.validateData===void 0&&this.displayError("Initialization error",'function "validateData" must be implemented'),this.analyzeAndVisualizeData===void 0&&this.displayError("Initialization error",'function "validateData" must be implemented')},Ov=new WeakSet,sg=function(){this.plotSpace.classList.add(Of.loadingClassName)},zh=new WeakSet,Pp=function(){this.plotSpace.classList.remove(Of.loadingClassName)},Uv=new WeakSet,lg=function(){this.dataLoaderAttr===""&&this.displayError("Attribute error",'"data-vis" element requires "dataLoader" attribute to be set');let t=window[this.dataLoaderAttr];(t==null||t.constructor.name!=="AsyncFunction")&&this.displayError("dataLoader function error","dataLoader function does not exist or is not async"),this.dataLoaderFn=t},tc($c,"loadingClassName","loading"),tc($c,"plotSpaceClassName","plot-space"),tc($c,"errorMsgClassName","error-msg");const ux=Object.prototype.toString;function eu(ye){return ux.call(ye).endsWith("Array]")}function fx(ye){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!eu(ye))throw new TypeError("input must be an array");if(ye.length===0)throw new TypeError("input must not be empty");var t=ge.fromIndex,P=t===void 0?0:t,R=ge.toIndex,h=R===void 0?ye.length:R;if(P<0||P>=ye.length||!Number.isInteger(P))throw new Error("fromIndex must be a positive integer smaller than length");if(h<=P||h>ye.length||!Number.isInteger(h))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var u=ye[P],A=P+1;A<h;A++)ye[A]>u&&(u=ye[A]);return u}function cx(ye){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!eu(ye))throw new TypeError("input must be an array");if(ye.length===0)throw new TypeError("input must not be empty");var t=ge.fromIndex,P=t===void 0?0:t,R=ge.toIndex,h=R===void 0?ye.length:R;if(P<0||P>=ye.length||!Number.isInteger(P))throw new Error("fromIndex must be a positive integer smaller than length");if(h<=P||h>ye.length||!Number.isInteger(h))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var u=ye[P],A=P+1;A<h;A++)ye[A]<u&&(u=ye[A]);return u}function d0(ye){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(eu(ye)){if(ye.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var t;if(ge.output!==void 0){if(!eu(ge.output))throw new TypeError("output option must be an array if specified");t=ge.output}else t=new Array(ye.length);var P=cx(ye),R=fx(ye);if(P===R)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var h=ge.min,u=h===void 0?ge.autoMinMax?P:0:h,A=ge.max,T=A===void 0?ge.autoMinMax?R:1:A;if(u>=T)throw new RangeError("min option must be smaller than max option");for(var e=(T-u)/(R-P),i=0;i<ye.length;i++)t[i]=(ye[i]-P)*e+u;return t}const gv=" ".repeat(2),ug=" ".repeat(4);function hx(){return fg(this)}function fg(ye,ge={}){const{maxRows:t=15,maxColumns:P=10,maxNumSize:R=8,padMinus:h="auto"}=ge;return`${ye.constructor.name} {
${gv}[
${ug}${vx(ye,t,P,R,h)}
${gv}]
${gv}rows: ${ye.rows}
${gv}columns: ${ye.columns}
}`}function vx(ye,ge,t,P,R){const{rows:h,columns:u}=ye,A=Math.min(h,ge),T=Math.min(u,t),e=[];if(R==="auto"){R=!1;e:for(let i=0;i<A;i++)for(let n=0;n<T;n++)if(ye.get(i,n)<0){R=!0;break e}}for(let i=0;i<A;i++){let n=[];for(let a=0;a<T;a++)n.push(px(ye.get(i,a),P,R));e.push(`${n.join(" ")}`)}return T!==u&&(e[e.length-1]+=` ... ${u-t} more columns`),A!==h&&e.push(`... ${h-ge} more rows`),e.join(`
${ug}`)}function px(ye,ge,t){return(ye>=0&&t?` ${g0(ye,ge-1)}`:g0(ye,ge)).padEnd(ge)}function g0(ye,ge){let t=ye.toString();if(t.length<=ge)return t;let P=ye.toFixed(ge);if(P.length>ge&&(P=ye.toFixed(Math.max(0,ge-(P.length-ge)))),P.length<=ge&&!P.startsWith("0.000")&&!P.startsWith("-0.000"))return P;let R=ye.toExponential(ge);return R.length>ge&&(R=ye.toExponential(Math.max(0,ge-(R.length-ge)))),R.slice(0)}function dx(ye,ge){ye.prototype.add=function(P){return typeof P=="number"?this.addS(P):this.addM(P)},ye.prototype.addS=function(P){for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)+P);return this},ye.prototype.addM=function(P){if(P=ge.checkMatrix(P),this.rows!==P.rows||this.columns!==P.columns)throw new RangeError("Matrices dimensions must be equal");for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)+P.get(R,h));return this},ye.add=function(P,R){return new ge(P).add(R)},ye.prototype.sub=function(P){return typeof P=="number"?this.subS(P):this.subM(P)},ye.prototype.subS=function(P){for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)-P);return this},ye.prototype.subM=function(P){if(P=ge.checkMatrix(P),this.rows!==P.rows||this.columns!==P.columns)throw new RangeError("Matrices dimensions must be equal");for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)-P.get(R,h));return this},ye.sub=function(P,R){return new ge(P).sub(R)},ye.prototype.subtract=ye.prototype.sub,ye.prototype.subtractS=ye.prototype.subS,ye.prototype.subtractM=ye.prototype.subM,ye.subtract=ye.sub,ye.prototype.mul=function(P){return typeof P=="number"?this.mulS(P):this.mulM(P)},ye.prototype.mulS=function(P){for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)*P);return this},ye.prototype.mulM=function(P){if(P=ge.checkMatrix(P),this.rows!==P.rows||this.columns!==P.columns)throw new RangeError("Matrices dimensions must be equal");for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)*P.get(R,h));return this},ye.mul=function(P,R){return new ge(P).mul(R)},ye.prototype.multiply=ye.prototype.mul,ye.prototype.multiplyS=ye.prototype.mulS,ye.prototype.multiplyM=ye.prototype.mulM,ye.multiply=ye.mul,ye.prototype.div=function(P){return typeof P=="number"?this.divS(P):this.divM(P)},ye.prototype.divS=function(P){for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)/P);return this},ye.prototype.divM=function(P){if(P=ge.checkMatrix(P),this.rows!==P.rows||this.columns!==P.columns)throw new RangeError("Matrices dimensions must be equal");for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)/P.get(R,h));return this},ye.div=function(P,R){return new ge(P).div(R)},ye.prototype.divide=ye.prototype.div,ye.prototype.divideS=ye.prototype.divS,ye.prototype.divideM=ye.prototype.divM,ye.divide=ye.div,ye.prototype.mod=function(P){return typeof P=="number"?this.modS(P):this.modM(P)},ye.prototype.modS=function(P){for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)%P);return this},ye.prototype.modM=function(P){if(P=ge.checkMatrix(P),this.rows!==P.rows||this.columns!==P.columns)throw new RangeError("Matrices dimensions must be equal");for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)%P.get(R,h));return this},ye.mod=function(P,R){return new ge(P).mod(R)},ye.prototype.modulus=ye.prototype.mod,ye.prototype.modulusS=ye.prototype.modS,ye.prototype.modulusM=ye.prototype.modM,ye.modulus=ye.mod,ye.prototype.and=function(P){return typeof P=="number"?this.andS(P):this.andM(P)},ye.prototype.andS=function(P){for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)&P);return this},ye.prototype.andM=function(P){if(P=ge.checkMatrix(P),this.rows!==P.rows||this.columns!==P.columns)throw new RangeError("Matrices dimensions must be equal");for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)&P.get(R,h));return this},ye.and=function(P,R){return new ge(P).and(R)},ye.prototype.or=function(P){return typeof P=="number"?this.orS(P):this.orM(P)},ye.prototype.orS=function(P){for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)|P);return this},ye.prototype.orM=function(P){if(P=ge.checkMatrix(P),this.rows!==P.rows||this.columns!==P.columns)throw new RangeError("Matrices dimensions must be equal");for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)|P.get(R,h));return this},ye.or=function(P,R){return new ge(P).or(R)},ye.prototype.xor=function(P){return typeof P=="number"?this.xorS(P):this.xorM(P)},ye.prototype.xorS=function(P){for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)^P);return this},ye.prototype.xorM=function(P){if(P=ge.checkMatrix(P),this.rows!==P.rows||this.columns!==P.columns)throw new RangeError("Matrices dimensions must be equal");for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)^P.get(R,h));return this},ye.xor=function(P,R){return new ge(P).xor(R)},ye.prototype.leftShift=function(P){return typeof P=="number"?this.leftShiftS(P):this.leftShiftM(P)},ye.prototype.leftShiftS=function(P){for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)<<P);return this},ye.prototype.leftShiftM=function(P){if(P=ge.checkMatrix(P),this.rows!==P.rows||this.columns!==P.columns)throw new RangeError("Matrices dimensions must be equal");for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)<<P.get(R,h));return this},ye.leftShift=function(P,R){return new ge(P).leftShift(R)},ye.prototype.signPropagatingRightShift=function(P){return typeof P=="number"?this.signPropagatingRightShiftS(P):this.signPropagatingRightShiftM(P)},ye.prototype.signPropagatingRightShiftS=function(P){for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)>>P);return this},ye.prototype.signPropagatingRightShiftM=function(P){if(P=ge.checkMatrix(P),this.rows!==P.rows||this.columns!==P.columns)throw new RangeError("Matrices dimensions must be equal");for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)>>P.get(R,h));return this},ye.signPropagatingRightShift=function(P,R){return new ge(P).signPropagatingRightShift(R)},ye.prototype.rightShift=function(P){return typeof P=="number"?this.rightShiftS(P):this.rightShiftM(P)},ye.prototype.rightShiftS=function(P){for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)>>>P);return this},ye.prototype.rightShiftM=function(P){if(P=ge.checkMatrix(P),this.rows!==P.rows||this.columns!==P.columns)throw new RangeError("Matrices dimensions must be equal");for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,this.get(R,h)>>>P.get(R,h));return this},ye.rightShift=function(P,R){return new ge(P).rightShift(R)},ye.prototype.zeroFillRightShift=ye.prototype.rightShift,ye.prototype.zeroFillRightShiftS=ye.prototype.rightShiftS,ye.prototype.zeroFillRightShiftM=ye.prototype.rightShiftM,ye.zeroFillRightShift=ye.rightShift,ye.prototype.not=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,~this.get(P,R));return this},ye.not=function(P){return new ge(P).not()},ye.prototype.abs=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.abs(this.get(P,R)));return this},ye.abs=function(P){return new ge(P).abs()},ye.prototype.acos=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.acos(this.get(P,R)));return this},ye.acos=function(P){return new ge(P).acos()},ye.prototype.acosh=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.acosh(this.get(P,R)));return this},ye.acosh=function(P){return new ge(P).acosh()},ye.prototype.asin=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.asin(this.get(P,R)));return this},ye.asin=function(P){return new ge(P).asin()},ye.prototype.asinh=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.asinh(this.get(P,R)));return this},ye.asinh=function(P){return new ge(P).asinh()},ye.prototype.atan=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.atan(this.get(P,R)));return this},ye.atan=function(P){return new ge(P).atan()},ye.prototype.atanh=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.atanh(this.get(P,R)));return this},ye.atanh=function(P){return new ge(P).atanh()},ye.prototype.cbrt=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.cbrt(this.get(P,R)));return this},ye.cbrt=function(P){return new ge(P).cbrt()},ye.prototype.ceil=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.ceil(this.get(P,R)));return this},ye.ceil=function(P){return new ge(P).ceil()},ye.prototype.clz32=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.clz32(this.get(P,R)));return this},ye.clz32=function(P){return new ge(P).clz32()},ye.prototype.cos=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.cos(this.get(P,R)));return this},ye.cos=function(P){return new ge(P).cos()},ye.prototype.cosh=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.cosh(this.get(P,R)));return this},ye.cosh=function(P){return new ge(P).cosh()},ye.prototype.exp=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.exp(this.get(P,R)));return this},ye.exp=function(P){return new ge(P).exp()},ye.prototype.expm1=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.expm1(this.get(P,R)));return this},ye.expm1=function(P){return new ge(P).expm1()},ye.prototype.floor=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.floor(this.get(P,R)));return this},ye.floor=function(P){return new ge(P).floor()},ye.prototype.fround=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.fround(this.get(P,R)));return this},ye.fround=function(P){return new ge(P).fround()},ye.prototype.log=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.log(this.get(P,R)));return this},ye.log=function(P){return new ge(P).log()},ye.prototype.log1p=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.log1p(this.get(P,R)));return this},ye.log1p=function(P){return new ge(P).log1p()},ye.prototype.log10=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.log10(this.get(P,R)));return this},ye.log10=function(P){return new ge(P).log10()},ye.prototype.log2=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.log2(this.get(P,R)));return this},ye.log2=function(P){return new ge(P).log2()},ye.prototype.round=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.round(this.get(P,R)));return this},ye.round=function(P){return new ge(P).round()},ye.prototype.sign=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.sign(this.get(P,R)));return this},ye.sign=function(P){return new ge(P).sign()},ye.prototype.sin=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.sin(this.get(P,R)));return this},ye.sin=function(P){return new ge(P).sin()},ye.prototype.sinh=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.sinh(this.get(P,R)));return this},ye.sinh=function(P){return new ge(P).sinh()},ye.prototype.sqrt=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.sqrt(this.get(P,R)));return this},ye.sqrt=function(P){return new ge(P).sqrt()},ye.prototype.tan=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.tan(this.get(P,R)));return this},ye.tan=function(P){return new ge(P).tan()},ye.prototype.tanh=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.tanh(this.get(P,R)));return this},ye.tanh=function(P){return new ge(P).tanh()},ye.prototype.trunc=function(){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.set(P,R,Math.trunc(this.get(P,R)));return this},ye.trunc=function(P){return new ge(P).trunc()},ye.pow=function(P,R){return new ge(P).pow(R)},ye.prototype.pow=function(P){return typeof P=="number"?this.powS(P):this.powM(P)},ye.prototype.powS=function(P){for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,Math.pow(this.get(R,h),P));return this},ye.prototype.powM=function(P){if(P=ge.checkMatrix(P),this.rows!==P.rows||this.columns!==P.columns)throw new RangeError("Matrices dimensions must be equal");for(let R=0;R<this.rows;R++)for(let h=0;h<this.columns;h++)this.set(R,h,Math.pow(this.get(R,h),P.get(R,h)));return this}}function rf(ye,ge,t){let P=t?ye.rows:ye.rows-1;if(ge<0||ge>P)throw new RangeError("Row index out of range")}function nf(ye,ge,t){let P=t?ye.columns:ye.columns-1;if(ge<0||ge>P)throw new RangeError("Column index out of range")}function qc(ye,ge){if(ge.to1DArray&&(ge=ge.to1DArray()),ge.length!==ye.columns)throw new RangeError("vector size must be the same as the number of columns");return ge}function eh(ye,ge){if(ge.to1DArray&&(ge=ge.to1DArray()),ge.length!==ye.rows)throw new RangeError("vector size must be the same as the number of rows");return ge}function gx(ye,ge){if(!eu(ge))throw new TypeError("row indices must be an array");for(let t=0;t<ge.length;t++)if(ge[t]<0||ge[t]>=ye.rows)throw new RangeError("row indices are out of range")}function yx(ye,ge){if(!eu(ge))throw new TypeError("column indices must be an array");for(let t=0;t<ge.length;t++)if(ge[t]<0||ge[t]>=ye.columns)throw new RangeError("column indices are out of range")}function y0(ye,ge,t,P,R){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(yv("startRow",ge),yv("endRow",t),yv("startColumn",P),yv("endColumn",R),ge>t||P>R||ge<0||ge>=ye.rows||t<0||t>=ye.rows||P<0||P>=ye.columns||R<0||R>=ye.columns)throw new RangeError("Submatrix indices are out of range")}function Vv(ye,ge=0){let t=[];for(let P=0;P<ye;P++)t.push(ge);return t}function yv(ye,ge){if(typeof ge!="number")throw new TypeError(`${ye} must be a number`)}function Kc(ye){if(ye.isEmpty())throw new Error("Empty matrix has no elements to index")}function mx(ye){let ge=Vv(ye.rows);for(let t=0;t<ye.rows;++t)for(let P=0;P<ye.columns;++P)ge[t]+=ye.get(t,P);return ge}function xx(ye){let ge=Vv(ye.columns);for(let t=0;t<ye.rows;++t)for(let P=0;P<ye.columns;++P)ge[P]+=ye.get(t,P);return ge}function bx(ye){let ge=0;for(let t=0;t<ye.rows;t++)for(let P=0;P<ye.columns;P++)ge+=ye.get(t,P);return ge}function _x(ye){let ge=Vv(ye.rows,1);for(let t=0;t<ye.rows;++t)for(let P=0;P<ye.columns;++P)ge[t]*=ye.get(t,P);return ge}function wx(ye){let ge=Vv(ye.columns,1);for(let t=0;t<ye.rows;++t)for(let P=0;P<ye.columns;++P)ge[P]*=ye.get(t,P);return ge}function Tx(ye){let ge=1;for(let t=0;t<ye.rows;t++)for(let P=0;P<ye.columns;P++)ge*=ye.get(t,P);return ge}function Ax(ye,ge,t){const P=ye.rows,R=ye.columns,h=[];for(let u=0;u<P;u++){let A=0,T=0,e=0;for(let i=0;i<R;i++)e=ye.get(u,i)-t[u],A+=e,T+=e*e;ge?h.push((T-A*A/R)/(R-1)):h.push((T-A*A/R)/R)}return h}function Mx(ye,ge,t){const P=ye.rows,R=ye.columns,h=[];for(let u=0;u<R;u++){let A=0,T=0,e=0;for(let i=0;i<P;i++)e=ye.get(i,u)-t[u],A+=e,T+=e*e;ge?h.push((T-A*A/P)/(P-1)):h.push((T-A*A/P)/P)}return h}function Sx(ye,ge,t){const P=ye.rows,R=ye.columns,h=P*R;let u=0,A=0,T=0;for(let e=0;e<P;e++)for(let i=0;i<R;i++)T=ye.get(e,i)-t,u+=T,A+=T*T;return ge?(A-u*u/h)/(h-1):(A-u*u/h)/h}function Ex(ye,ge){for(let t=0;t<ye.rows;t++)for(let P=0;P<ye.columns;P++)ye.set(t,P,ye.get(t,P)-ge[t])}function Cx(ye,ge){for(let t=0;t<ye.rows;t++)for(let P=0;P<ye.columns;P++)ye.set(t,P,ye.get(t,P)-ge[P])}function kx(ye,ge){for(let t=0;t<ye.rows;t++)for(let P=0;P<ye.columns;P++)ye.set(t,P,ye.get(t,P)-ge)}function Dx(ye){const ge=[];for(let t=0;t<ye.rows;t++){let P=0;for(let R=0;R<ye.columns;R++)P+=Math.pow(ye.get(t,R),2)/(ye.columns-1);ge.push(Math.sqrt(P))}return ge}function Lx(ye,ge){for(let t=0;t<ye.rows;t++)for(let P=0;P<ye.columns;P++)ye.set(t,P,ye.get(t,P)/ge[t])}function Px(ye){const ge=[];for(let t=0;t<ye.columns;t++){let P=0;for(let R=0;R<ye.rows;R++)P+=Math.pow(ye.get(R,t),2)/(ye.rows-1);ge.push(Math.sqrt(P))}return ge}function Fx(ye,ge){for(let t=0;t<ye.rows;t++)for(let P=0;P<ye.columns;P++)ye.set(t,P,ye.get(t,P)/ge[P])}function Rx(ye){const ge=ye.size-1;let t=0;for(let P=0;P<ye.columns;P++)for(let R=0;R<ye.rows;R++)t+=Math.pow(ye.get(R,P),2)/ge;return Math.sqrt(t)}function Ix(ye,ge){for(let t=0;t<ye.rows;t++)for(let P=0;P<ye.columns;P++)ye.set(t,P,ye.get(t,P)/ge)}class Zi{static from1DArray(ge,t,P){if(ge*t!==P.length)throw new RangeError("data length does not match given dimensions");let h=new Pi(ge,t);for(let u=0;u<ge;u++)for(let A=0;A<t;A++)h.set(u,A,P[u*t+A]);return h}static rowVector(ge){let t=new Pi(1,ge.length);for(let P=0;P<ge.length;P++)t.set(0,P,ge[P]);return t}static columnVector(ge){let t=new Pi(ge.length,1);for(let P=0;P<ge.length;P++)t.set(P,0,ge[P]);return t}static zeros(ge,t){return new Pi(ge,t)}static ones(ge,t){return new Pi(ge,t).fill(1)}static rand(ge,t,P={}){if(typeof P!="object")throw new TypeError("options must be an object");const{random:R=Math.random}=P;let h=new Pi(ge,t);for(let u=0;u<ge;u++)for(let A=0;A<t;A++)h.set(u,A,R());return h}static randInt(ge,t,P={}){if(typeof P!="object")throw new TypeError("options must be an object");const{min:R=0,max:h=1e3,random:u=Math.random}=P;if(!Number.isInteger(R))throw new TypeError("min must be an integer");if(!Number.isInteger(h))throw new TypeError("max must be an integer");if(R>=h)throw new RangeError("min must be smaller than max");let A=h-R,T=new Pi(ge,t);for(let e=0;e<ge;e++)for(let i=0;i<t;i++){let n=R+Math.round(u()*A);T.set(e,i,n)}return T}static eye(ge,t,P){t===void 0&&(t=ge),P===void 0&&(P=1);let R=Math.min(ge,t),h=this.zeros(ge,t);for(let u=0;u<R;u++)h.set(u,u,P);return h}static diag(ge,t,P){let R=ge.length;t===void 0&&(t=R),P===void 0&&(P=t);let h=Math.min(R,t,P),u=this.zeros(t,P);for(let A=0;A<h;A++)u.set(A,A,ge[A]);return u}static min(ge,t){ge=this.checkMatrix(ge),t=this.checkMatrix(t);let P=ge.rows,R=ge.columns,h=new Pi(P,R);for(let u=0;u<P;u++)for(let A=0;A<R;A++)h.set(u,A,Math.min(ge.get(u,A),t.get(u,A)));return h}static max(ge,t){ge=this.checkMatrix(ge),t=this.checkMatrix(t);let P=ge.rows,R=ge.columns,h=new this(P,R);for(let u=0;u<P;u++)for(let A=0;A<R;A++)h.set(u,A,Math.max(ge.get(u,A),t.get(u,A)));return h}static checkMatrix(ge){return Zi.isMatrix(ge)?ge:new Pi(ge)}static isMatrix(ge){return ge!=null&&ge.klass==="Matrix"}get size(){return this.rows*this.columns}apply(ge){if(typeof ge!="function")throw new TypeError("callback must be a function");for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)ge.call(this,t,P);return this}to1DArray(){let ge=[];for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)ge.push(this.get(t,P));return ge}to2DArray(){let ge=[];for(let t=0;t<this.rows;t++){ge.push([]);for(let P=0;P<this.columns;P++)ge[t].push(this.get(t,P))}return ge}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let ge=0;ge<this.rows;ge++)for(let t=0;t<=ge;t++)if(this.get(ge,t)!==this.get(t,ge))return!1;return!0}return!1}isEchelonForm(){let ge=0,t=0,P=-1,R=!0,h=!1;for(;ge<this.rows&&R;){for(t=0,h=!1;t<this.columns&&h===!1;)this.get(ge,t)===0?t++:this.get(ge,t)===1&&t>P?(h=!0,P=t):(R=!1,h=!0);ge++}return R}isReducedEchelonForm(){let ge=0,t=0,P=-1,R=!0,h=!1;for(;ge<this.rows&&R;){for(t=0,h=!1;t<this.columns&&h===!1;)this.get(ge,t)===0?t++:this.get(ge,t)===1&&t>P?(h=!0,P=t):(R=!1,h=!0);for(let u=t+1;u<this.rows;u++)this.get(ge,u)!==0&&(R=!1);ge++}return R}echelonForm(){let ge=this.clone(),t=0,P=0;for(;t<ge.rows&&P<ge.columns;){let R=t;for(let h=t;h<ge.rows;h++)ge.get(h,P)>ge.get(R,P)&&(R=h);if(ge.get(R,P)===0)P++;else{ge.swapRows(t,R);let h=ge.get(t,P);for(let u=P;u<ge.columns;u++)ge.set(t,u,ge.get(t,u)/h);for(let u=t+1;u<ge.rows;u++){let A=ge.get(u,P)/ge.get(t,P);ge.set(u,P,0);for(let T=P+1;T<ge.columns;T++)ge.set(u,T,ge.get(u,T)-ge.get(t,T)*A)}t++,P++}}return ge}reducedEchelonForm(){let ge=this.echelonForm(),t=ge.columns,P=ge.rows,R=P-1;for(;R>=0;)if(ge.maxRow(R)===0)R--;else{let h=0,u=!1;for(;h<P&&u===!1;)ge.get(R,h)===1?u=!0:h++;for(let A=0;A<R;A++){let T=ge.get(A,h);for(let e=h;e<t;e++){let i=ge.get(A,e)-T*ge.get(R,e);ge.set(A,e,i)}}R--}return ge}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(ge={}){if(typeof ge!="object")throw new TypeError("options must be an object");const{rows:t=1,columns:P=1}=ge;if(!Number.isInteger(t)||t<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(P)||P<=0)throw new TypeError("columns must be a positive integer");let R=new Pi(this.rows*t,this.columns*P);for(let h=0;h<t;h++)for(let u=0;u<P;u++)R.setSubMatrix(this,this.rows*h,this.columns*u);return R}fill(ge){for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)this.set(t,P,ge);return this}neg(){return this.mulS(-1)}getRow(ge){rf(this,ge);let t=[];for(let P=0;P<this.columns;P++)t.push(this.get(ge,P));return t}getRowVector(ge){return Pi.rowVector(this.getRow(ge))}setRow(ge,t){rf(this,ge),t=qc(this,t);for(let P=0;P<this.columns;P++)this.set(ge,P,t[P]);return this}swapRows(ge,t){rf(this,ge),rf(this,t);for(let P=0;P<this.columns;P++){let R=this.get(ge,P);this.set(ge,P,this.get(t,P)),this.set(t,P,R)}return this}getColumn(ge){nf(this,ge);let t=[];for(let P=0;P<this.rows;P++)t.push(this.get(P,ge));return t}getColumnVector(ge){return Pi.columnVector(this.getColumn(ge))}setColumn(ge,t){nf(this,ge),t=eh(this,t);for(let P=0;P<this.rows;P++)this.set(P,ge,t[P]);return this}swapColumns(ge,t){nf(this,ge),nf(this,t);for(let P=0;P<this.rows;P++){let R=this.get(P,ge);this.set(P,ge,this.get(P,t)),this.set(P,t,R)}return this}addRowVector(ge){ge=qc(this,ge);for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)this.set(t,P,this.get(t,P)+ge[P]);return this}subRowVector(ge){ge=qc(this,ge);for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)this.set(t,P,this.get(t,P)-ge[P]);return this}mulRowVector(ge){ge=qc(this,ge);for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)this.set(t,P,this.get(t,P)*ge[P]);return this}divRowVector(ge){ge=qc(this,ge);for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)this.set(t,P,this.get(t,P)/ge[P]);return this}addColumnVector(ge){ge=eh(this,ge);for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)this.set(t,P,this.get(t,P)+ge[t]);return this}subColumnVector(ge){ge=eh(this,ge);for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)this.set(t,P,this.get(t,P)-ge[t]);return this}mulColumnVector(ge){ge=eh(this,ge);for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)this.set(t,P,this.get(t,P)*ge[t]);return this}divColumnVector(ge){ge=eh(this,ge);for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)this.set(t,P,this.get(t,P)/ge[t]);return this}mulRow(ge,t){rf(this,ge);for(let P=0;P<this.columns;P++)this.set(ge,P,this.get(ge,P)*t);return this}mulColumn(ge,t){nf(this,ge);for(let P=0;P<this.rows;P++)this.set(P,ge,this.get(P,ge)*t);return this}max(ge){if(this.isEmpty())return NaN;switch(ge){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.get(P,R)>t[P]&&(t[P]=this.get(P,R));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.get(P,R)>t[R]&&(t[R]=this.get(P,R));return t}case void 0:{let t=this.get(0,0);for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.get(P,R)>t&&(t=this.get(P,R));return t}default:throw new Error(`invalid option: ${ge}`)}}maxIndex(){Kc(this);let ge=this.get(0,0),t=[0,0];for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.get(P,R)>ge&&(ge=this.get(P,R),t[0]=P,t[1]=R);return t}min(ge){if(this.isEmpty())return NaN;switch(ge){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.get(P,R)<t[P]&&(t[P]=this.get(P,R));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.get(P,R)<t[R]&&(t[R]=this.get(P,R));return t}case void 0:{let t=this.get(0,0);for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.get(P,R)<t&&(t=this.get(P,R));return t}default:throw new Error(`invalid option: ${ge}`)}}minIndex(){Kc(this);let ge=this.get(0,0),t=[0,0];for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)this.get(P,R)<ge&&(ge=this.get(P,R),t[0]=P,t[1]=R);return t}maxRow(ge){if(rf(this,ge),this.isEmpty())return NaN;let t=this.get(ge,0);for(let P=1;P<this.columns;P++)this.get(ge,P)>t&&(t=this.get(ge,P));return t}maxRowIndex(ge){rf(this,ge),Kc(this);let t=this.get(ge,0),P=[ge,0];for(let R=1;R<this.columns;R++)this.get(ge,R)>t&&(t=this.get(ge,R),P[1]=R);return P}minRow(ge){if(rf(this,ge),this.isEmpty())return NaN;let t=this.get(ge,0);for(let P=1;P<this.columns;P++)this.get(ge,P)<t&&(t=this.get(ge,P));return t}minRowIndex(ge){rf(this,ge),Kc(this);let t=this.get(ge,0),P=[ge,0];for(let R=1;R<this.columns;R++)this.get(ge,R)<t&&(t=this.get(ge,R),P[1]=R);return P}maxColumn(ge){if(nf(this,ge),this.isEmpty())return NaN;let t=this.get(0,ge);for(let P=1;P<this.rows;P++)this.get(P,ge)>t&&(t=this.get(P,ge));return t}maxColumnIndex(ge){nf(this,ge),Kc(this);let t=this.get(0,ge),P=[0,ge];for(let R=1;R<this.rows;R++)this.get(R,ge)>t&&(t=this.get(R,ge),P[0]=R);return P}minColumn(ge){if(nf(this,ge),this.isEmpty())return NaN;let t=this.get(0,ge);for(let P=1;P<this.rows;P++)this.get(P,ge)<t&&(t=this.get(P,ge));return t}minColumnIndex(ge){nf(this,ge),Kc(this);let t=this.get(0,ge),P=[0,ge];for(let R=1;R<this.rows;R++)this.get(R,ge)<t&&(t=this.get(R,ge),P[0]=R);return P}diag(){let ge=Math.min(this.rows,this.columns),t=[];for(let P=0;P<ge;P++)t.push(this.get(P,P));return t}norm(ge="frobenius"){let t=0;if(ge==="max")return this.max();if(ge==="frobenius"){for(let P=0;P<this.rows;P++)for(let R=0;R<this.columns;R++)t=t+this.get(P,R)*this.get(P,R);return Math.sqrt(t)}else throw new RangeError(`unknown norm type: ${ge}`)}cumulativeSum(){let ge=0;for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)ge+=this.get(t,P),this.set(t,P,ge);return this}dot(ge){Zi.isMatrix(ge)&&(ge=ge.to1DArray());let t=this.to1DArray();if(t.length!==ge.length)throw new RangeError("vectors do not have the same size");let P=0;for(let R=0;R<t.length;R++)P+=t[R]*ge[R];return P}mmul(ge){ge=Pi.checkMatrix(ge);let t=this.rows,P=this.columns,R=ge.columns,h=new Pi(t,R),u=new Float64Array(P);for(let A=0;A<R;A++){for(let T=0;T<P;T++)u[T]=ge.get(T,A);for(let T=0;T<t;T++){let e=0;for(let i=0;i<P;i++)e+=this.get(T,i)*u[i];h.set(T,A,e)}}return h}strassen2x2(ge){ge=Pi.checkMatrix(ge);let t=new Pi(2,2);const P=this.get(0,0),R=ge.get(0,0),h=this.get(0,1),u=ge.get(0,1),A=this.get(1,0),T=ge.get(1,0),e=this.get(1,1),i=ge.get(1,1),n=(P+e)*(R+i),a=(A+e)*R,r=P*(u-i),f=e*(T-R),o=(P+h)*i,s=(A-P)*(R+u),m=(h-e)*(T+i),g=n+f-o+m,p=r+o,v=a+f,x=n-a+r+s;return t.set(0,0,g),t.set(0,1,p),t.set(1,0,v),t.set(1,1,x),t}strassen3x3(ge){ge=Pi.checkMatrix(ge);let t=new Pi(3,3);const P=this.get(0,0),R=this.get(0,1),h=this.get(0,2),u=this.get(1,0),A=this.get(1,1),T=this.get(1,2),e=this.get(2,0),i=this.get(2,1),n=this.get(2,2),a=ge.get(0,0),r=ge.get(0,1),f=ge.get(0,2),o=ge.get(1,0),s=ge.get(1,1),m=ge.get(1,2),g=ge.get(2,0),p=ge.get(2,1),v=ge.get(2,2),x=(P+R+h-u-A-i-n)*s,l=(P-u)*(-r+s),b=A*(-a+r+o-s-m-g+v),c=(-P+u+A)*(a-r+s),M=(u+A)*(-a+r),_=P*a,y=(-P+e+i)*(a-f+m),w=(-P+e)*(f-m),d=(e+i)*(-a+f),C=(P+R+h-A-T-e-i)*m,S=i*(-a+f+o-s-m-g+p),E=(-h+i+n)*(s+g-p),k=(h-n)*(s-p),B=h*g,z=(i+n)*(-g+p),F=(-h+A+T)*(m+g-v),I=(h-T)*(m-v),O=(A+T)*(-g+v),N=R*o,V=T*p,H=u*f,j=e*r,Z=n*v,X=_+B+N,re=x+c+M+_+E+B+z,ue=_+y+d+C+B+F+O,K=l+b+c+_+B+F+I,te=l+c+M+_+V,G=B+F+I+O+H,Y=_+y+w+S+E+k+B,ee=E+k+B+z+j,ne=_+y+w+d+Z;return t.set(0,0,X),t.set(0,1,re),t.set(0,2,ue),t.set(1,0,K),t.set(1,1,te),t.set(1,2,G),t.set(2,0,Y),t.set(2,1,ee),t.set(2,2,ne),t}mmulStrassen(ge){ge=Pi.checkMatrix(ge);let t=this.clone(),P=t.rows,R=t.columns,h=ge.rows,u=ge.columns;R!==h&&console.warn(`Multiplying ${P} x ${R} and ${h} x ${u} matrix: dimensions do not match.`);function A(n,a,r){let f=n.rows,o=n.columns;if(f===a&&o===r)return n;{let s=Zi.zeros(a,r);return s=s.setSubMatrix(n,0,0),s}}let T=Math.max(P,h),e=Math.max(R,u);t=A(t,T,e),ge=A(ge,T,e);function i(n,a,r,f){if(r<=512||f<=512)return n.mmul(a);r%2===1&&f%2===1?(n=A(n,r+1,f+1),a=A(a,r+1,f+1)):r%2===1?(n=A(n,r+1,f),a=A(a,r+1,f)):f%2===1&&(n=A(n,r,f+1),a=A(a,r,f+1));let o=parseInt(n.rows/2,10),s=parseInt(n.columns/2,10),m=n.subMatrix(0,o-1,0,s-1),g=a.subMatrix(0,o-1,0,s-1),p=n.subMatrix(0,o-1,s,n.columns-1),v=a.subMatrix(0,o-1,s,a.columns-1),x=n.subMatrix(o,n.rows-1,0,s-1),l=a.subMatrix(o,a.rows-1,0,s-1),b=n.subMatrix(o,n.rows-1,s,n.columns-1),c=a.subMatrix(o,a.rows-1,s,a.columns-1),M=i(Zi.add(m,b),Zi.add(g,c),o,s),_=i(Zi.add(x,b),g,o,s),y=i(m,Zi.sub(v,c),o,s),w=i(b,Zi.sub(l,g),o,s),d=i(Zi.add(m,p),c,o,s),C=i(Zi.sub(x,m),Zi.add(g,v),o,s),S=i(Zi.sub(p,b),Zi.add(l,c),o,s),E=Zi.add(M,w);E.sub(d),E.add(S);let k=Zi.add(y,d),B=Zi.add(_,w),z=Zi.sub(M,_);z.add(y),z.add(C);let F=Zi.zeros(2*E.rows,2*E.columns);return F=F.setSubMatrix(E,0,0),F=F.setSubMatrix(k,E.rows,0),F=F.setSubMatrix(B,0,E.columns),F=F.setSubMatrix(z,E.rows,E.columns),F.subMatrix(0,r-1,0,f-1)}return i(t,ge,T,e)}scaleRows(ge={}){if(typeof ge!="object")throw new TypeError("options must be an object");const{min:t=0,max:P=1}=ge;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(P))throw new TypeError("max must be a number");if(t>=P)throw new RangeError("min must be smaller than max");let R=new Pi(this.rows,this.columns);for(let h=0;h<this.rows;h++){const u=this.getRow(h);u.length>0&&d0(u,{min:t,max:P,output:u}),R.setRow(h,u)}return R}scaleColumns(ge={}){if(typeof ge!="object")throw new TypeError("options must be an object");const{min:t=0,max:P=1}=ge;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(P))throw new TypeError("max must be a number");if(t>=P)throw new RangeError("min must be smaller than max");let R=new Pi(this.rows,this.columns);for(let h=0;h<this.columns;h++){const u=this.getColumn(h);u.length&&d0(u,{min:t,max:P,output:u}),R.setColumn(h,u)}return R}flipRows(){const ge=Math.ceil(this.columns/2);for(let t=0;t<this.rows;t++)for(let P=0;P<ge;P++){let R=this.get(t,P),h=this.get(t,this.columns-1-P);this.set(t,P,h),this.set(t,this.columns-1-P,R)}return this}flipColumns(){const ge=Math.ceil(this.rows/2);for(let t=0;t<this.columns;t++)for(let P=0;P<ge;P++){let R=this.get(P,t),h=this.get(this.rows-1-P,t);this.set(P,t,h),this.set(this.rows-1-P,t,R)}return this}kroneckerProduct(ge){ge=Pi.checkMatrix(ge);let t=this.rows,P=this.columns,R=ge.rows,h=ge.columns,u=new Pi(t*R,P*h);for(let A=0;A<t;A++)for(let T=0;T<P;T++)for(let e=0;e<R;e++)for(let i=0;i<h;i++)u.set(R*A+e,h*T+i,this.get(A,T)*ge.get(e,i));return u}kroneckerSum(ge){if(ge=Pi.checkMatrix(ge),!this.isSquare()||!ge.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let t=this.rows,P=ge.rows,R=this.kroneckerProduct(Pi.eye(P,P)),h=Pi.eye(t,t).kroneckerProduct(ge);return R.add(h)}transpose(){let ge=new Pi(this.columns,this.rows);for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)ge.set(P,t,this.get(t,P));return ge}sortRows(ge=m0){for(let t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(ge));return this}sortColumns(ge=m0){for(let t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(ge));return this}subMatrix(ge,t,P,R){y0(this,ge,t,P,R);let h=new Pi(t-ge+1,R-P+1);for(let u=ge;u<=t;u++)for(let A=P;A<=R;A++)h.set(u-ge,A-P,this.get(u,A));return h}subMatrixRow(ge,t,P){if(t===void 0&&(t=0),P===void 0&&(P=this.columns-1),t>P||t<0||t>=this.columns||P<0||P>=this.columns)throw new RangeError("Argument out of range");let R=new Pi(ge.length,P-t+1);for(let h=0;h<ge.length;h++)for(let u=t;u<=P;u++){if(ge[h]<0||ge[h]>=this.rows)throw new RangeError(`Row index out of range: ${ge[h]}`);R.set(h,u-t,this.get(ge[h],u))}return R}subMatrixColumn(ge,t,P){if(t===void 0&&(t=0),P===void 0&&(P=this.rows-1),t>P||t<0||t>=this.rows||P<0||P>=this.rows)throw new RangeError("Argument out of range");let R=new Pi(P-t+1,ge.length);for(let h=0;h<ge.length;h++)for(let u=t;u<=P;u++){if(ge[h]<0||ge[h]>=this.columns)throw new RangeError(`Column index out of range: ${ge[h]}`);R.set(u-t,h,this.get(u,ge[h]))}return R}setSubMatrix(ge,t,P){if(ge=Pi.checkMatrix(ge),ge.isEmpty())return this;let R=t+ge.rows-1,h=P+ge.columns-1;y0(this,t,R,P,h);for(let u=0;u<ge.rows;u++)for(let A=0;A<ge.columns;A++)this.set(t+u,P+A,ge.get(u,A));return this}selection(ge,t){gx(this,ge),yx(this,t);let P=new Pi(ge.length,t.length);for(let R=0;R<ge.length;R++){let h=ge[R];for(let u=0;u<t.length;u++){let A=t[u];P.set(R,u,this.get(h,A))}}return P}trace(){let ge=Math.min(this.rows,this.columns),t=0;for(let P=0;P<ge;P++)t+=this.get(P,P);return t}clone(){let ge=new Pi(this.rows,this.columns);for(let t=0;t<this.rows;t++)for(let P=0;P<this.columns;P++)ge.set(t,P,this.get(t,P));return ge}sum(ge){switch(ge){case"row":return mx(this);case"column":return xx(this);case void 0:return bx(this);default:throw new Error(`invalid option: ${ge}`)}}product(ge){switch(ge){case"row":return _x(this);case"column":return wx(this);case void 0:return Tx(this);default:throw new Error(`invalid option: ${ge}`)}}mean(ge){const t=this.sum(ge);switch(ge){case"row":{for(let P=0;P<this.rows;P++)t[P]/=this.columns;return t}case"column":{for(let P=0;P<this.columns;P++)t[P]/=this.rows;return t}case void 0:return t/this.size;default:throw new Error(`invalid option: ${ge}`)}}variance(ge,t={}){if(typeof ge=="object"&&(t=ge,ge=void 0),typeof t!="object")throw new TypeError("options must be an object");const{unbiased:P=!0,mean:R=this.mean(ge)}=t;if(typeof P!="boolean")throw new TypeError("unbiased must be a boolean");switch(ge){case"row":{if(!eu(R))throw new TypeError("mean must be an array");return Ax(this,P,R)}case"column":{if(!eu(R))throw new TypeError("mean must be an array");return Mx(this,P,R)}case void 0:{if(typeof R!="number")throw new TypeError("mean must be a number");return Sx(this,P,R)}default:throw new Error(`invalid option: ${ge}`)}}standardDeviation(ge,t){typeof ge=="object"&&(t=ge,ge=void 0);const P=this.variance(ge,t);if(ge===void 0)return Math.sqrt(P);for(let R=0;R<P.length;R++)P[R]=Math.sqrt(P[R]);return P}center(ge,t={}){if(typeof ge=="object"&&(t=ge,ge=void 0),typeof t!="object")throw new TypeError("options must be an object");const{center:P=this.mean(ge)}=t;switch(ge){case"row":{if(!eu(P))throw new TypeError("center must be an array");return Ex(this,P),this}case"column":{if(!eu(P))throw new TypeError("center must be an array");return Cx(this,P),this}case void 0:{if(typeof P!="number")throw new TypeError("center must be a number");return kx(this,P),this}default:throw new Error(`invalid option: ${ge}`)}}scale(ge,t={}){if(typeof ge=="object"&&(t=ge,ge=void 0),typeof t!="object")throw new TypeError("options must be an object");let P=t.scale;switch(ge){case"row":{if(P===void 0)P=Dx(this);else if(!eu(P))throw new TypeError("scale must be an array");return Lx(this,P),this}case"column":{if(P===void 0)P=Px(this);else if(!eu(P))throw new TypeError("scale must be an array");return Fx(this,P),this}case void 0:{if(P===void 0)P=Rx(this);else if(typeof P!="number")throw new TypeError("scale must be a number");return Ix(this,P),this}default:throw new Error(`invalid option: ${ge}`)}}toString(ge){return fg(this,ge)}}Zi.prototype.klass="Matrix";typeof Symbol<"u"&&(Zi.prototype[Symbol.for("nodejs.util.inspect.custom")]=hx);function m0(ye,ge){return ye-ge}function zx(ye){return ye.every(ge=>typeof ge=="number")}Zi.random=Zi.rand;Zi.randomInt=Zi.randInt;Zi.diagonal=Zi.diag;Zi.prototype.diagonal=Zi.prototype.diag;Zi.identity=Zi.eye;Zi.prototype.negate=Zi.prototype.neg;Zi.prototype.tensorProduct=Zi.prototype.kroneckerProduct;class Pi extends Zi{constructor(ge,t){if(super(),Pi.isMatrix(ge))return ge.clone();if(Number.isInteger(ge)&&ge>=0)if(this.data=[],Number.isInteger(t)&&t>=0)for(let P=0;P<ge;P++)this.data.push(new Float64Array(t));else throw new TypeError("nColumns must be a positive integer");else if(eu(ge)){const P=ge;if(ge=P.length,t=ge?P[0].length:0,typeof t!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let R=0;R<ge;R++){if(P[R].length!==t)throw new RangeError("Inconsistent array dimensions");if(!zx(P[R]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(P[R]))}}else throw new TypeError("First argument must be a positive number or an array");this.rows=ge,this.columns=t}set(ge,t,P){return this.data[ge][t]=P,this}get(ge,t){return this.data[ge][t]}removeRow(ge){return rf(this,ge),this.data.splice(ge,1),this.rows-=1,this}addRow(ge,t){return t===void 0&&(t=ge,ge=this.rows),rf(this,ge,!0),t=Float64Array.from(qc(this,t)),this.data.splice(ge,0,t),this.rows+=1,this}removeColumn(ge){nf(this,ge);for(let t=0;t<this.rows;t++){const P=new Float64Array(this.columns-1);for(let R=0;R<ge;R++)P[R]=this.data[t][R];for(let R=ge+1;R<this.columns;R++)P[R-1]=this.data[t][R];this.data[t]=P}return this.columns-=1,this}addColumn(ge,t){typeof t>"u"&&(t=ge,ge=this.columns),nf(this,ge,!0),t=eh(this,t);for(let P=0;P<this.rows;P++){const R=new Float64Array(this.columns+1);let h=0;for(;h<ge;h++)R[h]=this.data[P][h];for(R[h++]=t[P];h<this.columns+1;h++)R[h]=this.data[P][h-1];this.data[P]=R}return this.columns+=1,this}}dx(Zi,Pi);function Bx(ye,ge=ye,t={}){ye=new Pi(ye);let P=!1;if(typeof ge=="object"&&!Pi.isMatrix(ge)&&!eu(ge)?(t=ge,ge=ye,P=!0):ge=new Pi(ge),ye.rows!==ge.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:R=!0}=t;R&&(ye=ye.center("column"),P||(ge=ge.center("column")));const h=ye.transpose().mmul(ge);for(let u=0;u<h.rows;u++)for(let A=0;A<h.columns;A++)h.set(u,A,h.get(u,A)*(1/(ye.rows-1)));return h}function _v(){return _v=Object.assign?Object.assign.bind():function(ye){for(var ge=1;ge<arguments.length;ge++){var t=arguments[ge];for(var P in t)Object.prototype.hasOwnProperty.call(t,P)&&(ye[P]=t[P])}return ye},_v.apply(this,arguments)}var cg={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function as(ye){return typeof ye=="number"}function ul(ye){return!ye||typeof ye!="object"||typeof ye.constructor!="function"?!1:ye.isBigNumber===!0&&typeof ye.constructor.prototype=="object"&&ye.constructor.prototype.isBigNumber===!0||typeof ye.constructor.isDecimal=="function"&&ye.constructor.isDecimal(ye)===!0}function Gp(ye){return ye&&typeof ye=="object"&&Object.getPrototypeOf(ye).isComplex===!0||!1}function Yp(ye){return ye&&typeof ye=="object"&&Object.getPrototypeOf(ye).isFraction===!0||!1}function hg(ye){return ye&&ye.constructor.prototype.isUnit===!0||!1}function af(ye){return typeof ye=="string"}var Po=Array.isArray;function is(ye){return ye&&ye.constructor.prototype.isMatrix===!0||!1}function wv(ye){return Array.isArray(ye)||is(ye)}function vg(ye){return ye&&ye.isDenseMatrix&&ye.constructor.prototype.isMatrix===!0||!1}function pg(ye){return ye&&ye.isSparseMatrix&&ye.constructor.prototype.isMatrix===!0||!1}function dg(ye){return ye&&ye.constructor.prototype.isRange===!0||!1}function Wp(ye){return ye&&ye.constructor.prototype.isIndex===!0||!1}function Nx(ye){return typeof ye=="boolean"}function Ox(ye){return ye&&ye.constructor.prototype.isResultSet===!0||!1}function Ux(ye){return ye&&ye.constructor.prototype.isHelp===!0||!1}function Vx(ye){return typeof ye=="function"}function Hx(ye){return ye instanceof Date}function Gx(ye){return ye instanceof RegExp}function Yx(ye){return!!(ye&&typeof ye=="object"&&ye.constructor===Object&&!Gp(ye)&&!Yp(ye))}function Wx(ye){return ye===null}function Xx(ye){return ye===void 0}function Zx(ye){return ye&&ye.isAccessorNode===!0&&ye.constructor.prototype.isNode===!0||!1}function jx(ye){return ye&&ye.isArrayNode===!0&&ye.constructor.prototype.isNode===!0||!1}function Jx(ye){return ye&&ye.isAssignmentNode===!0&&ye.constructor.prototype.isNode===!0||!1}function Kx(ye){return ye&&ye.isBlockNode===!0&&ye.constructor.prototype.isNode===!0||!1}function Qx(ye){return ye&&ye.isConditionalNode===!0&&ye.constructor.prototype.isNode===!0||!1}function $x(ye){return ye&&ye.isConstantNode===!0&&ye.constructor.prototype.isNode===!0||!1}function qx(ye){return ye&&ye.isFunctionAssignmentNode===!0&&ye.constructor.prototype.isNode===!0||!1}function eb(ye){return ye&&ye.isFunctionNode===!0&&ye.constructor.prototype.isNode===!0||!1}function tb(ye){return ye&&ye.isIndexNode===!0&&ye.constructor.prototype.isNode===!0||!1}function rb(ye){return ye&&ye.isNode===!0&&ye.constructor.prototype.isNode===!0||!1}function nb(ye){return ye&&ye.isObjectNode===!0&&ye.constructor.prototype.isNode===!0||!1}function ab(ye){return ye&&ye.isOperatorNode===!0&&ye.constructor.prototype.isNode===!0||!1}function ib(ye){return ye&&ye.isParenthesisNode===!0&&ye.constructor.prototype.isNode===!0||!1}function ob(ye){return ye&&ye.isRangeNode===!0&&ye.constructor.prototype.isNode===!0||!1}function sb(ye){return ye&&ye.isRelationalNode===!0&&ye.constructor.prototype.isNode===!0||!1}function lb(ye){return ye&&ye.isSymbolNode===!0&&ye.constructor.prototype.isNode===!0||!1}function ub(ye){return ye&&ye.constructor.prototype.isChain===!0||!1}function ac(ye){var ge=typeof ye;return ge==="object"?ye===null?"null":ul(ye)?"BigNumber":ye.constructor&&ye.constructor.name?ye.constructor.name:"Object":ge}function yo(ye){var ge=typeof ye;if(ge==="number"||ge==="string"||ge==="boolean"||ye===null||ye===void 0)return ye;if(typeof ye.clone=="function")return ye.clone();if(Array.isArray(ye))return ye.map(function(t){return yo(t)});if(ye instanceof Date)return new Date(ye.valueOf());if(ul(ye))return ye;if(ye instanceof RegExp)throw new TypeError("Cannot clone "+ye);return fb(ye,yo)}function fb(ye,ge){var t={};for(var P in ye)Rh(ye,P)&&(t[P]=ge(ye[P]));return t}function cb(ye,ge){for(var t in ge)Rh(ge,t)&&(ye[t]=ge[t]);return ye}function Tv(ye,ge){var t,P,R;if(Array.isArray(ye)){if(!Array.isArray(ge)||ye.length!==ge.length)return!1;for(P=0,R=ye.length;P<R;P++)if(!Tv(ye[P],ge[P]))return!1;return!0}else{if(typeof ye=="function")return ye===ge;if(ye instanceof Object){if(Array.isArray(ge)||!(ge instanceof Object))return!1;for(t in ye)if(!(t in ge)||!Tv(ye[t],ge[t]))return!1;for(t in ge)if(!(t in ye))return!1;return!0}else return ye===ge}}function Rh(ye,ge){return ye&&Object.hasOwnProperty.call(ye,ge)}function hb(ye,ge){for(var t={},P=0;P<ge.length;P++){var R=ge[P],h=ye[R];h!==void 0&&(t[R]=h)}return t}var vb=["Matrix","Array"],pb=["number","BigNumber","Fraction"],yu=function(ge){if(ge)throw new Error(`The global config is readonly. 
Please create a mathjs instance if you want to change the default configuration. 
Example:

  import { create, all } from 'mathjs';
  const mathjs = create(all);
  mathjs.config({ number: 'BigNumber' });
`);return Object.freeze(cg)};_v(yu,cg,{MATRIX_OPTIONS:vb,NUMBER_OPTIONS:pb});function tf(ye,ge){var t=typeof Symbol<"u"&&ye[Symbol.iterator]||ye["@@iterator"];if(!t){if(Array.isArray(ye)||(t=db(ye))||ge&&ye&&typeof ye.length=="number"){t&&(ye=t);var P=0,R=function(){};return{s:R,n:function(){return P>=ye.length?{done:!0}:{done:!1,value:ye[P++]}},e:function(e){throw e},f:R}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,u=!1,A;return{s:function(){t=t.call(ye)},n:function(){var e=t.next();return h=e.done,e},e:function(e){u=!0,A=e},f:function(){try{!h&&t.return!=null&&t.return()}finally{if(u)throw A}}}}function db(ye,ge){if(!!ye){if(typeof ye=="string")return x0(ye,ge);var t=Object.prototype.toString.call(ye).slice(8,-1);if(t==="Object"&&ye.constructor&&(t=ye.constructor.name),t==="Map"||t==="Set")return Array.from(ye);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return x0(ye,ge)}}function x0(ye,ge){(ge==null||ge>ye.length)&&(ge=ye.length);for(var t=0,P=new Array(ge);t<ge;t++)P[t]=ye[t];return P}function th(ye){return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ge){return typeof ge}:function(ge){return ge&&typeof Symbol=="function"&&ge.constructor===Symbol&&ge!==Symbol.prototype?"symbol":typeof ge},th(ye)}function b0(){return!0}function Pu(){return!1}function Qc(){}var _0="Argument is not a typed-function.";function gg(){function ye(xe){return th(xe)==="object"&&xe!==null&&xe.constructor===Object}var ge=[{name:"number",test:function(oe){return typeof oe=="number"}},{name:"string",test:function(oe){return typeof oe=="string"}},{name:"boolean",test:function(oe){return typeof oe=="boolean"}},{name:"Function",test:function(oe){return typeof oe=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(oe){return oe instanceof Date}},{name:"RegExp",test:function(oe){return oe instanceof RegExp}},{name:"Object",test:ye},{name:"null",test:function(oe){return oe===null}},{name:"undefined",test:function(oe){return oe===void 0}}],t={name:"any",test:b0,isAny:!0},P,R,h=0,u={createCount:0};function A(xe){var oe=P.get(xe);if(oe)return oe;var he='Unknown type "'+xe+'"',be=xe.toLowerCase(),me,_e=tf(R),Se;try{for(_e.s();!(Se=_e.n()).done;)if(me=Se.value,me.toLowerCase()===be){he+='. Did you mean "'+me+'" ?';break}}catch(De){_e.e(De)}finally{_e.f()}throw new TypeError(he)}function T(xe){for(var oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"any",he=oe?A(oe).index:R.length,be=[],me=0;me<xe.length;++me){if(!xe[me]||typeof xe[me].name!="string"||typeof xe[me].test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");var _e=xe[me].name;if(P.has(_e))throw new TypeError('Duplicate type name "'+_e+'"');be.push(_e),P.set(_e,{name:_e,test:xe[me].test,isAny:xe[me].isAny,index:he+me,conversionsTo:[]})}var Se=R.slice(he);R=R.slice(0,he).concat(be).concat(Se);for(var De=he+be.length;De<R.length;++De)P.get(R[De]).index=De}function e(){P=new Map,R=[],h=0,T([t],!1)}e(),T(ge);function i(){var xe,oe=tf(R),he;try{for(oe.s();!(he=oe.n()).done;)xe=he.value,P.get(xe).conversionsTo=[]}catch(be){oe.e(be)}finally{oe.f()}h=0}function n(xe){var oe=R.filter(function(he){var be=P.get(he);return!be.isAny&&be.test(xe)});return oe.length?oe:["any"]}function a(xe){return xe&&typeof xe=="function"&&"_typedFunctionData"in xe}function r(xe,oe,he){if(!a(xe))throw new TypeError(_0);var be=he&&he.exact,me=Array.isArray(oe)?oe.join(","):oe,_e=v(me),Se=s(_e);if(!be||Se in xe.signatures){var De=xe._typedFunctionData.signatureMap.get(Se);if(De)return De}var Ie=_e.length,Te;if(be){Te=[];var Ce;for(Ce in xe.signatures)Te.push(xe._typedFunctionData.signatureMap.get(Ce))}else Te=xe._typedFunctionData.signatures;for(var He=0;He<Ie;++He){var Xe=_e[He],Be=[],Re=void 0,We=tf(Te),vt;try{for(We.s();!(vt=We.n()).done;){Re=vt.value;var Pt=c(Re.params,He);if(!(!Pt||Xe.restParam&&!Pt.restParam)){if(!Pt.hasAny){var Zt=function(){var Bt=p(Pt);if(Xe.types.some(function(Ct){return!Bt.has(Ct.name)}))return"continue"}();if(Zt==="continue")continue}Be.push(Re)}}}catch(Bt){We.e(Bt)}finally{We.f()}if(Te=Be,Te.length===0)break}var zt,At=tf(Te),Wt;try{for(At.s();!(Wt=At.n()).done;)if(zt=Wt.value,zt.params.length<=Ie)return zt}catch(Bt){At.e(Bt)}finally{At.f()}throw new TypeError("Signature not found (signature: "+(xe.name||"unnamed")+"("+s(_e,", ")+"))")}function f(xe,oe,he){return r(xe,oe,he).implementation}function o(xe,oe){var he=A(oe);if(he.test(xe))return xe;var be=he.conversionsTo;if(be.length===0)throw new Error("There are no conversions to "+oe+" defined.");for(var me=0;me<be.length;me++){var _e=A(be[me].from);if(_e.test(xe))return be[me].convert(xe)}throw new Error("Cannot convert "+xe+" to "+oe)}function s(xe){var oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",";return xe.map(function(he){return he.name}).join(oe)}function m(xe){var oe=xe.indexOf("...")===0,he=oe?xe.length>3?xe.slice(3):"any":xe,be=he.split("|").map(function(De){return A(De.trim())}),me=!1,_e=oe?"...":"",Se=be.map(function(De){return me=De.isAny||me,_e+=De.name+"|",{name:De.name,typeIndex:De.index,test:De.test,isAny:De.isAny,conversion:null,conversionIndex:-1}});return{types:Se,name:_e.slice(0,-1),hasAny:me,hasConversion:!1,restParam:oe}}function g(xe){var oe=xe.types.map(function(Se){return Se.name}),he=k(oe),be=xe.hasAny,me=xe.name,_e=he.map(function(Se){var De=A(Se.from);return be=De.isAny||be,me+="|"+Se.from,{name:Se.from,typeIndex:De.index,test:De.test,isAny:De.isAny,conversion:Se,conversionIndex:Se.index}});return{types:xe.types.concat(_e),name:me,hasAny:be,hasConversion:_e.length>0,restParam:xe.restParam}}function p(xe){return xe.typeSet||(xe.typeSet=new Set,xe.types.forEach(function(oe){return xe.typeSet.add(oe.name)})),xe.typeSet}function v(xe){var oe=[];if(typeof xe!="string")throw new TypeError("Signatures must be strings");var he=xe.trim();if(he==="")return oe;for(var be=he.split(","),me=0;me<be.length;++me){var _e=m(be[me].trim());if(_e.restParam&&me!==be.length-1)throw new SyntaxError('Unexpected rest parameter "'+be[me]+'": only allowed for the last parameter');if(_e.types.length===0)return null;oe.push(_e)}return oe}function x(xe){var oe=re(xe);return oe?oe.restParam:!1}function l(xe){if(!xe||xe.types.length===0)return b0;if(xe.types.length===1)return A(xe.types[0].name).test;if(xe.types.length===2){var oe=A(xe.types[0].name).test,he=A(xe.types[1].name).test;return function(_e){return oe(_e)||he(_e)}}else{var be=xe.types.map(function(me){return A(me.name).test});return function(_e){for(var Se=0;Se<be.length;Se++)if(be[Se](_e))return!0;return!1}}}function b(xe){var oe,he,be;if(x(xe)){oe=X(xe).map(l);var me=oe.length,_e=l(re(xe)),Se=function(Ie){for(var Te=me;Te<Ie.length;Te++)if(!_e(Ie[Te]))return!1;return!0};return function(Ie){for(var Te=0;Te<oe.length;Te++)if(!oe[Te](Ie[Te]))return!1;return Se(Ie)&&Ie.length>=me+1}}else return xe.length===0?function(Ie){return Ie.length===0}:xe.length===1?(he=l(xe[0]),function(Ie){return he(Ie[0])&&Ie.length===1}):xe.length===2?(he=l(xe[0]),be=l(xe[1]),function(Ie){return he(Ie[0])&&be(Ie[1])&&Ie.length===2}):(oe=xe.map(l),function(Ie){for(var Te=0;Te<oe.length;Te++)if(!oe[Te](Ie[Te]))return!1;return Ie.length===oe.length})}function c(xe,oe){return oe<xe.length?xe[oe]:x(xe)?re(xe):null}function M(xe,oe){var he=c(xe,oe);return he?p(he):new Set}function _(xe){return xe.conversion===null||xe.conversion===void 0}function y(xe,oe){var he=new Set;return xe.forEach(function(be){var me=M(be.params,oe),_e,Se=tf(me),De;try{for(Se.s();!(De=Se.n()).done;)_e=De.value,he.add(_e)}catch(Ie){Se.e(Ie)}finally{Se.f()}}),he.has("any")?["any"]:Array.from(he)}function w(xe,oe,he){var be,me,_e=xe||"unnamed",Se=he,De,Ie=function(){var We=[];if(Se.forEach(function(Pt){var Zt=c(Pt.params,De),zt=l(Zt);(De<Pt.params.length||x(Pt.params))&&zt(oe[De])&&We.push(Pt)}),We.length===0){if(me=y(Se,De),me.length>0){var vt=n(oe[De]);return be=new TypeError("Unexpected type of argument in function "+_e+" (expected: "+me.join(" or ")+", actual: "+vt.join(" | ")+", index: "+De+")"),be.data={category:"wrongType",fn:_e,index:De,actual:vt,expected:me},{v:be}}}else Se=We};for(De=0;De<oe.length;De++){var Te=Ie();if(th(Te)==="object")return Te.v}var Ce=Se.map(function(Re){return x(Re.params)?1/0:Re.params.length});if(oe.length<Math.min.apply(null,Ce))return me=y(Se,De),be=new TypeError("Too few arguments in function "+_e+" (expected: "+me.join(" or ")+", index: "+oe.length+")"),be.data={category:"tooFewArgs",fn:_e,index:oe.length,expected:me},be;var He=Math.max.apply(null,Ce);if(oe.length>He)return be=new TypeError("Too many arguments in function "+_e+" (expected: "+He+", actual: "+oe.length+")"),be.data={category:"tooManyArgs",fn:_e,index:oe.length,expectedLength:He},be;for(var Xe=[],Be=0;Be<oe.length;++Be)Xe.push(n(oe[Be]).join("|"));return be=new TypeError('Arguments of type "'+Xe.join(", ")+'" do not match any of the defined signatures of function '+_e+"."),be.data={category:"mismatch",actual:Xe},be}function d(xe){for(var oe=R.length+1,he=0;he<xe.types.length;he++)_(xe.types[he])&&(oe=Math.min(oe,xe.types[he].typeIndex));return oe}function C(xe){for(var oe=h+1,he=0;he<xe.types.length;he++)_(xe.types[he])||(oe=Math.min(oe,xe.types[he].conversionIndex));return oe}function S(xe,oe){if(xe.hasAny){if(!oe.hasAny)return 1}else if(oe.hasAny)return-1;if(xe.restParam){if(!oe.restParam)return 1}else if(oe.restParam)return-1;if(xe.hasConversion){if(!oe.hasConversion)return 1}else if(oe.hasConversion)return-1;var he=d(xe)-d(oe);if(he<0)return-1;if(he>0)return 1;var be=C(xe)-C(oe);return be<0?-1:be>0?1:0}function E(xe,oe){var he=xe.params,be=oe.params,me=re(he),_e=re(be),Se=x(he),De=x(be);if(Se&&me.hasAny){if(!De||!_e.hasAny)return 1}else if(De&&_e.hasAny)return-1;var Ie=0,Te=0,Ce,He=tf(he),Xe;try{for(He.s();!(Xe=He.n()).done;)Ce=Xe.value,Ce.hasAny&&++Ie,Ce.hasConversion&&++Te}catch(nt){He.e(nt)}finally{He.f()}var Be=0,Re=0,We=tf(be),vt;try{for(We.s();!(vt=We.n()).done;)Ce=vt.value,Ce.hasAny&&++Be,Ce.hasConversion&&++Re}catch(nt){We.e(nt)}finally{We.f()}if(Ie!==Be)return Ie-Be;if(Se&&me.hasConversion){if(!De||!_e.hasConversion)return 1}else if(De&&_e.hasConversion)return-1;if(Te!==Re)return Te-Re;if(Se){if(!De)return 1}else if(De)return-1;var Pt=(he.length-be.length)*(Se?-1:1);if(Pt!==0)return Pt;for(var Zt=[],zt=0,At=0;At<he.length;++At){var Wt=S(he[At],be[At]);Zt.push(Wt),zt+=Wt}if(zt!==0)return zt;for(var Bt,Ct=0,Ze=Zt;Ct<Ze.length;Ct++)if(Bt=Ze[Ct],Bt!==0)return Bt;return 0}function k(xe){if(xe.length===0)return[];var oe=xe.map(A);xe.length>1&&oe.sort(function(Ie,Te){return Ie.index-Te.index});var he=oe[0].conversionsTo;if(xe.length===1)return he;he=he.concat([]);for(var be=new Set(xe),me=1;me<oe.length;++me){var _e=void 0,Se=tf(oe[me].conversionsTo),De;try{for(Se.s();!(De=Se.n()).done;)_e=De.value,be.has(_e.from)||(he.push(_e),be.add(_e.from))}catch(Ie){Se.e(Ie)}finally{Se.f()}}return he}function B(xe,oe){var he=oe;if(xe.some(function(De){return De.hasConversion})){var be=x(xe),me=xe.map(z);he=function(){for(var Ie=[],Te=be?arguments.length-1:arguments.length,Ce=0;Ce<Te;Ce++)Ie[Ce]=me[Ce](arguments[Ce]);return be&&(Ie[Te]=arguments[Te].map(me[Te])),oe.apply(this,Ie)}}var _e=he;if(x(xe)){var Se=xe.length-1;_e=function(){return he.apply(this,ue(arguments,0,Se).concat([ue(arguments,Se)]))}}return _e}function z(xe){var oe,he,be,me,_e=[],Se=[];switch(xe.types.forEach(function(De){De.conversion&&(_e.push(A(De.conversion.from).test),Se.push(De.conversion.convert))}),Se.length){case 0:return function(Ie){return Ie};case 1:return oe=_e[0],be=Se[0],function(Ie){return oe(Ie)?be(Ie):Ie};case 2:return oe=_e[0],he=_e[1],be=Se[0],me=Se[1],function(Ie){return oe(Ie)?be(Ie):he(Ie)?me(Ie):Ie};default:return function(Ie){for(var Te=0;Te<Se.length;Te++)if(_e[Te](Ie))return Se[Te](Ie);return Ie}}}function F(xe){function oe(he,be,me){if(be<he.length){var _e=he[be],Se=[];if(_e.restParam){var De=_e.types.filter(_);De.length<_e.types.length&&Se.push({types:De,name:"..."+De.map(function(Ie){return Ie.name}).join("|"),hasAny:De.some(function(Ie){return Ie.isAny}),hasConversion:!1,restParam:!0}),Se.push(_e)}else Se=_e.types.map(function(Ie){return{types:[Ie],name:Ie.name,hasAny:Ie.isAny,hasConversion:Ie.conversion,restParam:!1}});return te(Se,function(Ie){return oe(he,be+1,me.concat([Ie]))})}else return[me]}return oe(xe,0,[])}function I(xe,oe){for(var he=Math.max(xe.length,oe.length),be=0;be<he;be++){var me=M(xe,be),_e=M(oe,be),Se=!1,De=void 0,Ie=tf(_e),Te;try{for(Ie.s();!(Te=Ie.n()).done;)if(De=Te.value,me.has(De)){Se=!0;break}}catch(Re){Ie.e(Re)}finally{Ie.f()}if(!Se)return!1}var Ce=xe.length,He=oe.length,Xe=x(xe),Be=x(oe);return Xe?Be?Ce===He:He>=Ce:Be?Ce>=He:Ce===He}function O(xe){return xe.map(function(oe){return J(oe)?ee(oe.referToSelf.callback):ne(oe)?Y(oe.referTo.references,oe.referTo.callback):oe})}function N(xe,oe,he){var be=[],me,_e=tf(xe),Se;try{for(_e.s();!(Se=_e.n()).done;){me=Se.value;var De=he[me];if(typeof De!="number")throw new TypeError('No definition for referenced signature "'+me+'"');if(De=oe[De],typeof De!="function")return!1;be.push(De)}}catch(Ie){_e.e(Ie)}finally{_e.f()}return be}function V(xe,oe,he){for(var be=O(xe),me=new Array(be.length).fill(!1),_e=!0;_e;){_e=!1;for(var Se=!0,De=0;De<be.length;++De)if(!me[De]){var Ie=be[De];if(J(Ie))be[De]=Ie.referToSelf.callback(he),be[De].referToSelf=Ie.referToSelf,me[De]=!0,Se=!1;else if(ne(Ie)){var Te=N(Ie.referTo.references,be,oe);Te?(be[De]=Ie.referTo.callback.apply(this,Te),be[De].referTo=Ie.referTo,me[De]=!0,Se=!1):_e=!0}}if(Se&&_e)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return be}function H(xe){var oe=/\bthis(\(|\.signatures\b)/;Object.keys(xe).forEach(function(he){var be=xe[he];if(oe.test(be.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}function j(xe,oe){if(u.createCount++,Object.keys(oe).length===0)throw new SyntaxError("No signatures provided");u.warnAgainstDeprecatedThis&&H(oe);var he=[],be=[],me={},_e=[],Se,De=function(){if(!Object.prototype.hasOwnProperty.call(oe,Se))return"continue";var ke=v(Se);if(!ke)return"continue";he.forEach(function(Xt){if(I(Xt,ke))throw new TypeError('Conflicting signatures "'+s(Xt)+'" and "'+s(ke)+'".')}),he.push(ke);var it=be.length;be.push(oe[Se]);var ut=ke.map(g),ht=void 0,Et=tf(F(ut)),yt;try{for(Et.s();!(yt=Et.n()).done;){ht=yt.value;var Dt=s(ht);_e.push({params:ht,name:Dt,fn:it}),ht.every(function(Xt){return!Xt.hasConversion})&&(me[Dt]=it)}}catch(Xt){Et.e(Xt)}finally{Et.f()}};for(Se in oe)var Ie=De();_e.sort(E);var Te=V(be,me,Ut),Ce;for(Ce in me)Object.prototype.hasOwnProperty.call(me,Ce)&&(me[Ce]=Te[me[Ce]]);for(var He=[],Xe=new Map,Be=0,Re=_e;Be<Re.length;Be++)Ce=Re[Be],Xe.has(Ce.name)||(Ce.fn=Te[Ce.fn],He.push(Ce),Xe.set(Ce.name,Ce));for(var We=He[0]&&He[0].params.length<=2&&!x(He[0].params),vt=He[1]&&He[1].params.length<=2&&!x(He[1].params),Pt=He[2]&&He[2].params.length<=2&&!x(He[2].params),Zt=He[3]&&He[3].params.length<=2&&!x(He[3].params),zt=He[4]&&He[4].params.length<=2&&!x(He[4].params),At=He[5]&&He[5].params.length<=2&&!x(He[5].params),Wt=We&&vt&&Pt&&Zt&&zt&&At,Bt=0;Bt<He.length;++Bt)He[Bt].test=b(He[Bt].params);for(var Ct=We?l(He[0].params[0]):Pu,Ze=vt?l(He[1].params[0]):Pu,nt=Pt?l(He[2].params[0]):Pu,Ye=Zt?l(He[3].params[0]):Pu,Ee=zt?l(He[4].params[0]):Pu,Ge=At?l(He[5].params[0]):Pu,Je=We?l(He[0].params[1]):Pu,qe=vt?l(He[1].params[1]):Pu,Tt=Pt?l(He[2].params[1]):Pu,mt=Zt?l(He[3].params[1]):Pu,Mt=zt?l(He[4].params[1]):Pu,Ht=At?l(He[5].params[1]):Pu,Rt=0;Rt<He.length;++Rt)He[Rt].implementation=B(He[Rt].params,He[Rt].fn);var Vt=We?He[0].implementation:Qc,Jt=vt?He[1].implementation:Qc,Yt=Pt?He[2].implementation:Qc,or=Zt?He[3].implementation:Qc,Hr=zt?He[4].implementation:Qc,an=At?He[5].implementation:Qc,Kr=We?He[0].params.length:-1,ot=vt?He[1].params.length:-1,er=Pt?He[2].params.length:-1,Kt=Zt?He[3].params.length:-1,ur=zt?He[4].params.length:-1,Ar=At?He[5].params.length:-1,et=Wt?6:0,$e=He.length,st=He.map(function(Pe){return Pe.test}),ft=He.map(function(Pe){return Pe.implementation}),St=function(){for(var ke=et;ke<$e;ke++)if(st[ke](arguments))return ft[ke].apply(this,arguments);return u.onMismatch(xe,arguments,He)};function Ut(Pe,ke){return arguments.length===Kr&&Ct(Pe)&&Je(ke)?Vt.apply(this,arguments):arguments.length===ot&&Ze(Pe)&&qe(ke)?Jt.apply(this,arguments):arguments.length===er&&nt(Pe)&&Tt(ke)?Yt.apply(this,arguments):arguments.length===Kt&&Ye(Pe)&&mt(ke)?or.apply(this,arguments):arguments.length===ur&&Ee(Pe)&&Mt(ke)?Hr.apply(this,arguments):arguments.length===Ar&&Ge(Pe)&&Ht(ke)?an.apply(this,arguments):St.apply(this,arguments)}try{Object.defineProperty(Ut,"name",{value:xe})}catch{}return Ut.signatures=me,Ut._typedFunctionData={signatures:He,signatureMap:Xe},Ut}function Z(xe,oe,he){throw w(xe,oe,he)}function X(xe){return ue(xe,0,xe.length-1)}function re(xe){return xe[xe.length-1]}function ue(xe,oe,he){return Array.prototype.slice.call(xe,oe,he)}function K(xe,oe){for(var he=0;he<xe.length;he++)if(oe(xe[he]))return xe[he]}function te(xe,oe){return Array.prototype.concat.apply([],xe.map(oe))}function G(){var xe=X(arguments).map(function(he){return s(v(he))}),oe=re(arguments);if(typeof oe!="function")throw new TypeError("Callback function expected as last argument");return Y(xe,oe)}function Y(xe,oe){return{referTo:{references:xe,callback:oe}}}function ee(xe){if(typeof xe!="function")throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:xe}}}function ne(xe){return xe&&th(xe.referTo)==="object"&&Array.isArray(xe.referTo.references)&&typeof xe.referTo.callback=="function"}function J(xe){return xe&&th(xe.referToSelf)==="object"&&typeof xe.referToSelf.callback=="function"}function q(xe,oe){if(!xe)return oe;if(oe&&oe!==xe){var he=new Error("Function names do not match (expected: "+xe+", actual: "+oe+")");throw he.data={actual:oe,expected:xe},he}return xe}function ae(xe){var oe;for(var he in xe)Object.prototype.hasOwnProperty.call(xe,he)&&(a(xe[he])||typeof xe[he].signature=="string")&&(oe=q(oe,xe[he].name));return oe}function le(xe,oe){var he;for(he in oe)if(Object.prototype.hasOwnProperty.call(oe,he)){if(he in xe&&oe[he]!==xe[he]){var be=new Error('Signature "'+he+'" is defined twice');throw be.data={signature:he,sourceFunction:oe[he],destFunction:xe[he]},be}xe[he]=oe[he]}}var ie=u;u=function(oe){for(var he=typeof oe=="string",be=he?1:0,me=he?oe:"",_e={},Se=be;Se<arguments.length;++Se){var De=arguments[Se],Ie={},Te=void 0;if(typeof De=="function"?(Te=De.name,typeof De.signature=="string"?Ie[De.signature]=De:a(De)&&(Ie=De.signatures)):ye(De)&&(Ie=De,he||(Te=ae(De))),Object.keys(Ie).length===0){var Ce=new TypeError("Argument to 'typed' at index "+Se+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw Ce.data={index:Se,argument:De},Ce}he||(me=q(me,Te)),le(_e,Ie)}return j(me||"",_e)},u.create=gg,u.createCount=ie.createCount,u.onMismatch=Z,u.throwMismatchError=Z,u.createError=w,u.clear=e,u.clearConversions=i,u.addTypes=T,u._findType=A,u.referTo=G,u.referToSelf=ee,u.convert=o,u.findSignature=r,u.find=f,u.isTypedFunction=a,u.warnAgainstDeprecatedThis=!0,u.addType=function(xe,oe){var he="any";oe!==!1&&P.has("Object")&&(he="Object"),u.addTypes([xe],he)};function se(xe){if(!xe||typeof xe.from!="string"||typeof xe.to!="string"||typeof xe.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(xe.to===xe.from)throw new SyntaxError('Illegal to define conversion from "'+xe.from+'" to itself.')}return u.addConversion=function(xe){se(xe);var oe=A(xe.to);if(oe.conversionsTo.every(function(he){return he.from!==xe.from}))oe.conversionsTo.push({from:xe.from,convert:xe.convert,index:h++});else throw new Error('There is already a conversion from "'+xe.from+'" to "'+oe.name+'"')},u.addConversions=function(xe){xe.forEach(u.addConversion)},u.removeConversion=function(xe){se(xe);var oe=A(xe.to),he=K(oe.conversionsTo,function(me){return me.from===xe.from});if(!he)throw new Error("Attempt to remove nonexistent conversion from "+xe.from+" to "+xe.to);if(he.convert!==xe.convert)throw new Error("Conversion to remove does not match existing conversion");var be=oe.conversionsTo.indexOf(he);oe.conversionsTo.splice(be,1)},u.resolve=function(xe,oe){if(!a(xe))throw new TypeError(_0);for(var he=xe._typedFunctionData.signatures,be=0;be<he.length;++be)if(he[be].test(oe))return he[be];return null},u}const w0=gg();function cs(ye){return typeof ye=="boolean"?!0:isFinite(ye)?ye===Math.round(ye):!1}var gb=Math.sign||function(ye){return ye>0?1:ye<0?-1:0};function Cp(ye,ge,t){var P={2:"0b",8:"0o",16:"0x"},R=P[ge],h="";if(t){if(t<1)throw new Error("size must be in greater than 0");if(!cs(t))throw new Error("size must be an integer");if(ye>2**(t-1)-1||ye<-(2**(t-1)))throw new Error("Value must be in range [-2^".concat(t-1,", 2^").concat(t-1,"-1]"));if(!cs(ye))throw new Error("Value must be an integer");ye<0&&(ye=ye+2**t),h="i".concat(t)}var u="";return ye<0&&(ye=-ye,u="-"),"".concat(u).concat(R).concat(ye.toString(ge)).concat(h)}function Fp(ye,ge){if(typeof ge=="function")return ge(ye);if(ye===1/0)return"Infinity";if(ye===-1/0)return"-Infinity";if(isNaN(ye))return"NaN";var t="auto",P,R;if(ge&&(ge.notation&&(t=ge.notation),as(ge)?P=ge:as(ge.precision)&&(P=ge.precision),ge.wordSize&&(R=ge.wordSize,typeof R!="number")))throw new Error('Option "wordSize" must be a number');switch(t){case"fixed":return mb(ye,P);case"exponential":return yg(ye,P);case"engineering":return yb(ye,P);case"bin":return Cp(ye,2,R);case"oct":return Cp(ye,8,R);case"hex":return Cp(ye,16,R);case"auto":return xb(ye,P,ge&&ge).replace(/((\.\d*?)(0+))($|e)/,function(){var h=arguments[2],u=arguments[4];return h!=="."?h+u:u});default:throw new Error('Unknown notation "'+t+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Hv(ye){var ge=String(ye).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!ge)throw new SyntaxError("Invalid number "+ye);var t=ge[1],P=ge[2],R=parseFloat(ge[4]||"0"),h=P.indexOf(".");R+=h!==-1?h-1:P.length-1;var u=P.replace(".","").replace(/^0*/,function(A){return R-=A.length,""}).replace(/0*$/,"").split("").map(function(A){return parseInt(A)});return u.length===0&&(u.push(0),R++),{sign:t,coefficients:u,exponent:R}}function yb(ye,ge){if(isNaN(ye)||!isFinite(ye))return String(ye);var t=Hv(ye),P=Gv(t,ge),R=P.exponent,h=P.coefficients,u=R%3===0?R:R<0?R-3-R%3:R-R%3;if(as(ge))for(;ge>h.length||R-u+1>h.length;)h.push(0);else for(var A=Math.abs(R-u)-(h.length-1),T=0;T<A;T++)h.push(0);for(var e=Math.abs(R-u),i=1;e>0;)i++,e--;var n=h.slice(i).join(""),a=as(ge)&&n.length||n.match(/[1-9]/)?"."+n:"",r=h.slice(0,i).join("")+a+"e"+(R>=0?"+":"")+u.toString();return P.sign+r}function mb(ye,ge){if(isNaN(ye)||!isFinite(ye))return String(ye);var t=Hv(ye),P=typeof ge=="number"?Gv(t,t.exponent+1+ge):t,R=P.coefficients,h=P.exponent+1,u=h+(ge||0);return R.length<u&&(R=R.concat(nh(u-R.length))),h<0&&(R=nh(-h+1).concat(R),h=1),h<R.length&&R.splice(h,0,h===0?"0.":"."),P.sign+R.join("")}function yg(ye,ge){if(isNaN(ye)||!isFinite(ye))return String(ye);var t=Hv(ye),P=ge?Gv(t,ge):t,R=P.coefficients,h=P.exponent;R.length<ge&&(R=R.concat(nh(ge-R.length)));var u=R.shift();return P.sign+u+(R.length>0?"."+R.join(""):"")+"e"+(h>=0?"+":"")+h}function xb(ye,ge,t){if(isNaN(ye)||!isFinite(ye))return String(ye);var P=t&&t.lowerExp!==void 0?t.lowerExp:-3,R=t&&t.upperExp!==void 0?t.upperExp:5,h=Hv(ye),u=ge?Gv(h,ge):h;if(u.exponent<P||u.exponent>=R)return yg(ye,ge);var A=u.coefficients,T=u.exponent;A.length<ge&&(A=A.concat(nh(ge-A.length))),A=A.concat(nh(T-A.length+1+(A.length<ge?ge-A.length:0))),A=nh(-T).concat(A);var e=T>0?T:0;return e<A.length-1&&A.splice(e+1,0,"."),u.sign+A.join("")}function Gv(ye,ge){for(var t={sign:ye.sign,coefficients:ye.coefficients,exponent:ye.exponent},P=t.coefficients;ge<=0;)P.unshift(0),t.exponent++,ge++;if(P.length>ge){var R=P.splice(ge,P.length-ge);if(R[0]>=5){var h=ge-1;for(P[h]++;P[h]===10;)P.pop(),h===0&&(P.unshift(0),t.exponent++,h++),h--,P[h]++}}return t}function nh(ye){for(var ge=[],t=0;t<ye;t++)ge.push(0);return ge}function bb(ye){return ye.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}var _b=Number.EPSILON||2220446049250313e-31;function ic(ye,ge,t){if(t==null)return ye===ge;if(ye===ge)return!0;if(isNaN(ye)||isNaN(ge))return!1;if(isFinite(ye)&&isFinite(ge)){var P=Math.abs(ye-ge);return P<_b?!0:P<=Math.max(Math.abs(ye),Math.abs(ge))*t}return!1}function kp(ye,ge,t){var P=ye.constructor,R=new P(2),h="";if(t){if(t<1)throw new Error("size must be in greater than 0");if(!cs(t))throw new Error("size must be an integer");if(ye.greaterThan(R.pow(t-1).sub(1))||ye.lessThan(R.pow(t-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(t-1,", 2^").concat(t-1,"-1]"));if(!ye.isInteger())throw new Error("Value must be an integer");ye.lessThan(0)&&(ye=ye.add(R.pow(t))),h="i".concat(t)}switch(ge){case 2:return"".concat(ye.toBinary()).concat(h);case 8:return"".concat(ye.toOctal()).concat(h);case 16:return"".concat(ye.toHexadecimal()).concat(h);default:throw new Error("Base ".concat(ge," not supported "))}}function wb(ye,ge){if(typeof ge=="function")return ge(ye);if(!ye.isFinite())return ye.isNaN()?"NaN":ye.gt(0)?"Infinity":"-Infinity";var t="auto",P,R;if(ge!==void 0&&(ge.notation&&(t=ge.notation),typeof ge=="number"?P=ge:ge.precision&&(P=ge.precision),ge.wordSize&&(R=ge.wordSize,typeof R!="number")))throw new Error('Option "wordSize" must be a number');switch(t){case"fixed":return Ab(ye,P);case"exponential":return T0(ye,P);case"engineering":return Tb(ye,P);case"bin":return kp(ye,2,R);case"oct":return kp(ye,8,R);case"hex":return kp(ye,16,R);case"auto":{var h=ge&&ge.lowerExp!==void 0?ge.lowerExp:-3,u=ge&&ge.upperExp!==void 0?ge.upperExp:5;if(ye.isZero())return"0";var A,T=ye.toSignificantDigits(P),e=T.e;return e>=h&&e<u?A=T.toFixed():A=T0(ye,P),A.replace(/((\.\d*?)(0+))($|e)/,function(){var i=arguments[2],n=arguments[4];return i!=="."?i+n:n})}default:throw new Error('Unknown notation "'+t+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Tb(ye,ge){var t=ye.e,P=t%3===0?t:t<0?t-3-t%3:t-t%3,R=ye.mul(Math.pow(10,-P)),h=R.toPrecision(ge);return h.indexOf("e")!==-1&&(h=R.toString()),h+"e"+(t>=0?"+":"")+P.toString()}function T0(ye,ge){return ge!==void 0?ye.toExponential(ge-1):ye.toExponential()}function Ab(ye,ge){return ye.toFixed(ge)}function ns(ye,ge){var t=Mb(ye,ge);return ge&&typeof ge=="object"&&"truncate"in ge&&t.length>ge.truncate?t.substring(0,ge.truncate-3)+"...":t}function Mb(ye,ge){if(typeof ye=="number")return Fp(ye,ge);if(ul(ye))return wb(ye,ge);if(Sb(ye))return!ge||ge.fraction!=="decimal"?ye.s*ye.n+"/"+ye.d:ye.toString();if(Array.isArray(ye))return mg(ye,ge);if(af(ye))return'"'+ye+'"';if(typeof ye=="function")return ye.syntax?String(ye.syntax):"function";if(ye&&typeof ye=="object"){if(typeof ye.format=="function")return ye.format(ge);if(ye&&ye.toString(ge)!=={}.toString())return ye.toString(ge);var t=Object.keys(ye).map(P=>'"'+P+'": '+ns(ye[P],ge));return"{"+t.join(", ")+"}"}return String(ye)}function mg(ye,ge){if(Array.isArray(ye)){for(var t="[",P=ye.length,R=0;R<P;R++)R!==0&&(t+=", "),t+=mg(ye[R],ge);return t+="]",t}else return ns(ye,ge)}function Sb(ye){return ye&&typeof ye=="object"&&typeof ye.s=="number"&&typeof ye.n=="number"&&typeof ye.d=="number"||!1}function Ao(ye,ge,t){if(!(this instanceof Ao))throw new SyntaxError("Constructor must be called with the new operator");this.actual=ye,this.expected=ge,this.relation=t,this.message="Dimension mismatch ("+(Array.isArray(ye)?"["+ye.join(", ")+"]":ye)+" "+(this.relation||"!=")+" "+(Array.isArray(ge)?"["+ge.join(", ")+"]":ge)+")",this.stack=new Error().stack}Ao.prototype=new RangeError;Ao.prototype.constructor=RangeError;Ao.prototype.name="DimensionError";Ao.prototype.isDimensionError=!0;function sh(ye,ge,t){if(!(this instanceof sh))throw new SyntaxError("Constructor must be called with the new operator");this.index=ye,arguments.length<3?(this.min=0,this.max=ge):(this.min=ge,this.max=t),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}sh.prototype=new RangeError;sh.prototype.constructor=RangeError;sh.prototype.name="IndexError";sh.prototype.isIndexError=!0;function Nl(ye){for(var ge=[];Array.isArray(ye);)ge.push(ye.length),ye=ye[0];return ge}function xg(ye,ge,t){var P,R=ye.length;if(R!==ge[t])throw new Ao(R,ge[t]);if(t<ge.length-1){var h=t+1;for(P=0;P<R;P++){var u=ye[P];if(!Array.isArray(u))throw new Ao(ge.length-1,ge.length,"<");xg(ye[P],ge,h)}}else for(P=0;P<R;P++)if(Array.isArray(ye[P]))throw new Ao(ge.length+1,ge.length,">")}function A0(ye,ge){var t=ge.length===0;if(t){if(Array.isArray(ye))throw new Ao(ye.length,0)}else xg(ye,ge,0)}function Zo(ye,ge){if(!as(ye)||!cs(ye))throw new TypeError("Index must be an integer (value: "+ye+")");if(ye<0||typeof ge=="number"&&ye>=ge)throw new sh(ye,ge)}function Av(ye,ge,t){if(!Array.isArray(ye)||!Array.isArray(ge))throw new TypeError("Array expected");if(ge.length===0)throw new Error("Resizing to scalar is not supported");ge.forEach(function(R){if(!as(R)||!cs(R)||R<0)throw new TypeError("Invalid size, must contain positive integers (size: "+ns(ge)+")")});var P=t!==void 0?t:0;return Rp(ye,ge,0,P),ye}function Rp(ye,ge,t,P){var R,h,u=ye.length,A=ge[t],T=Math.min(u,A);if(ye.length=A,t<ge.length-1){var e=t+1;for(R=0;R<T;R++)h=ye[R],Array.isArray(h)||(h=[h],ye[R]=h),Rp(h,ge,e,P);for(R=T;R<A;R++)h=[],ye[R]=h,Rp(h,ge,e,P)}else{for(R=0;R<T;R++)for(;Array.isArray(ye[R]);)ye[R]=ye[R][0];for(R=T;R<A;R++)ye[R]=P}}function Eb(ye,ge){var t=Ip(ye),P=t.length;if(!Array.isArray(ye)||!Array.isArray(ge))throw new TypeError("Array expected");if(ge.length===0)throw new Ao(0,P,"!=");ge=Xp(ge,P);var R=bg(ge);if(P!==R)throw new Ao(R,P,"!=");try{return Cb(t,ge)}catch(h){throw h instanceof Ao?new Ao(R,P,"!="):h}}function Xp(ye,ge){var t=bg(ye),P=ye.slice(),R=-1,h=ye.indexOf(R),u=ye.indexOf(R,h+1)>=0;if(u)throw new Error("More than one wildcard in sizes");var A=h>=0,T=ge%t===0;if(A)if(T)P[h]=-ge/t;else throw new Error("Could not replace wildcard, since "+ge+" is no multiple of "+-t);return P}function bg(ye){return ye.reduce((ge,t)=>ge*t,1)}function Cb(ye,ge){for(var t=ye,P,R=ge.length-1;R>0;R--){var h=ge[R];P=[];for(var u=t.length/h,A=0;A<u;A++)P.push(t.slice(A*h,(A+1)*h));t=P}return t}function _g(ye,ge,t,P){var R=P||Nl(ye);if(t)for(var h=0;h<t;h++)ye=[ye],R.unshift(1);for(ye=wg(ye,ge,0);R.length<ge;)R.push(1);return ye}function wg(ye,ge,t){var P,R;if(Array.isArray(ye)){var h=t+1;for(P=0,R=ye.length;P<R;P++)ye[P]=wg(ye[P],ge,h)}else for(var u=t;u<ge;u++)ye=[ye];return ye}function Ip(ye){if(!Array.isArray(ye))return ye;var ge=[];return ye.forEach(function t(P){Array.isArray(P)?P.forEach(t):ge.push(P)}),ge}function Mv(ye,ge){for(var t,P=0,R=0;R<ye.length;R++){var h=ye[R],u=Array.isArray(h);if(R===0&&u&&(P=h.length),u&&h.length!==P)return;var A=u?Mv(h,ge):ge(h);if(t===void 0)t=A;else if(t!==A)return"mixed"}return t}function Wa(ye,ge,t,P){function R(h){var u=hb(h,ge.map(Lb));return kb(ye,ge,h),t(u)}return R.isFactory=!0,R.fn=ye,R.dependencies=ge.slice().sort(),P&&(R.meta=P),R}function kb(ye,ge,t){var P=ge.filter(h=>!Db(h)).every(h=>t[h]!==void 0);if(!P){var R=ge.filter(h=>t[h]===void 0);throw new Error('Cannot create function "'.concat(ye,'", ')+"some dependencies are missing: ".concat(R.map(h=>'"'.concat(h,'"')).join(", "),"."))}}function Db(ye){return ye&&ye[0]==="?"}function Lb(ye){return ye&&ye[0]==="?"?ye.slice(1):ye}function Pb(ye,ge){if(Ag(ye)&&Tg(ye,ge))return ye[ge];throw typeof ye[ge]=="function"&&Ib(ye,ge)?new Error('Cannot access method "'+ge+'" as a property'):new Error('No access to property "'+ge+'"')}function Fb(ye,ge,t){if(Ag(ye)&&Tg(ye,ge))return ye[ge]=t,t;throw new Error('No access to property "'+ge+'"')}function Rb(ye,ge){return ge in ye}function Tg(ye,ge){return!ye||typeof ye!="object"?!1:Rh(zb,ge)?!0:!(ge in Object.prototype||ge in Function.prototype)}function Ib(ye,ge){return ye==null||typeof ye[ge]!="function"||Rh(ye,ge)&&Object.getPrototypeOf&&ge in Object.getPrototypeOf(ye)?!1:Rh(Bb,ge)?!0:!(ge in Object.prototype||ge in Function.prototype)}function Ag(ye){return typeof ye=="object"&&ye&&ye.constructor===Object}var zb={length:!0,name:!0},Bb={toString:!0,valueOf:!0,toLocaleString:!0};class Nb{constructor(ge){this.wrappedObject=ge}keys(){return Object.keys(this.wrappedObject)}get(ge){return Pb(this.wrappedObject,ge)}set(ge,t){return Fb(this.wrappedObject,ge,t),this}has(ge){return Rb(this.wrappedObject,ge)}}function Ob(ye){return ye?ye instanceof Map||ye instanceof Nb||typeof ye.set=="function"&&typeof ye.get=="function"&&typeof ye.keys=="function"&&typeof ye.has=="function":!1}var Mg=function(){return Mg=w0.create,w0},Ub=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],Vb=Wa("typed",Ub,function(ge){var{BigNumber:t,Complex:P,DenseMatrix:R,Fraction:h}=ge,u=Mg();return u.clear(),u.addTypes([{name:"number",test:as},{name:"Complex",test:Gp},{name:"BigNumber",test:ul},{name:"Fraction",test:Yp},{name:"Unit",test:hg},{name:"identifier",test:A=>af&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])*$/.test(A)},{name:"string",test:af},{name:"Chain",test:ub},{name:"Array",test:Po},{name:"Matrix",test:is},{name:"DenseMatrix",test:vg},{name:"SparseMatrix",test:pg},{name:"Range",test:dg},{name:"Index",test:Wp},{name:"boolean",test:Nx},{name:"ResultSet",test:Ox},{name:"Help",test:Ux},{name:"function",test:Vx},{name:"Date",test:Hx},{name:"RegExp",test:Gx},{name:"null",test:Wx},{name:"undefined",test:Xx},{name:"AccessorNode",test:Zx},{name:"ArrayNode",test:jx},{name:"AssignmentNode",test:Jx},{name:"BlockNode",test:Kx},{name:"ConditionalNode",test:Qx},{name:"ConstantNode",test:$x},{name:"FunctionNode",test:eb},{name:"FunctionAssignmentNode",test:qx},{name:"IndexNode",test:tb},{name:"Node",test:rb},{name:"ObjectNode",test:nb},{name:"OperatorNode",test:ab},{name:"ParenthesisNode",test:ib},{name:"RangeNode",test:ob},{name:"RelationalNode",test:sb},{name:"SymbolNode",test:lb},{name:"Map",test:Ob},{name:"Object",test:Yx}]),u.addConversions([{from:"number",to:"BigNumber",convert:function(T){if(t||Dp(T),bb(T)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+T+"). Use function bignumber(x) to convert to BigNumber.");return new t(T)}},{from:"number",to:"Complex",convert:function(T){return P||mv(T),new P(T,0)}},{from:"BigNumber",to:"Complex",convert:function(T){return P||mv(T),new P(T.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(T){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(T){return P||mv(T),new P(T.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(T){h||Lp(T);var e=new h(T);if(e.valueOf()!==T)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+T+"). Use function fraction(x) to convert to Fraction.");return e}},{from:"string",to:"number",convert:function(T){var e=Number(T);if(isNaN(e))throw new Error('Cannot convert "'+T+'" to a number');return e}},{from:"string",to:"BigNumber",convert:function(T){t||Dp(T);try{return new t(T)}catch{throw new Error('Cannot convert "'+T+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(T){h||Lp(T);try{return new h(T)}catch{throw new Error('Cannot convert "'+T+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(T){P||mv(T);try{return new P(T)}catch{throw new Error('Cannot convert "'+T+'" to Complex')}}},{from:"boolean",to:"number",convert:function(T){return+T}},{from:"boolean",to:"BigNumber",convert:function(T){return t||Dp(T),new t(+T)}},{from:"boolean",to:"Fraction",convert:function(T){return h||Lp(T),new h(+T)}},{from:"boolean",to:"string",convert:function(T){return String(T)}},{from:"Array",to:"Matrix",convert:function(T){return R||Hb(),new R(T)}},{from:"Matrix",to:"Array",convert:function(T){return T.valueOf()}}]),u.onMismatch=(A,T,e)=>{var i=u.createError(A,T,e);if(["wrongType","mismatch"].includes(i.data.category)&&T.length===1&&wv(T[0])&&e.some(a=>!a.params.includes(","))){var n=new TypeError("Function '".concat(A,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(A,")'."));throw n.data=i.data,n}throw i},u.onMismatch=(A,T,e)=>{var i=u.createError(A,T,e);if(["wrongType","mismatch"].includes(i.data.category)&&T.length===1&&wv(T[0])&&e.some(a=>!a.params.includes(","))){var n=new TypeError("Function '".concat(A,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(A,")'."));throw n.data=i.data,n}throw i},u});function Dp(ye){throw new Error("Cannot convert value ".concat(ye," into a BigNumber: no class 'BigNumber' provided"))}function mv(ye){throw new Error("Cannot convert value ".concat(ye," into a Complex number: no class 'Complex' provided"))}function Hb(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function Lp(ye){throw new Error("Cannot convert value ".concat(ye," into a Fraction, no class 'Fraction' provided."))}/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var rh=9e15,sc=1e9,zp="0123456789abcdef",Sv="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Ev="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Bp={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-rh,maxE:rh,crypto:!1},Sg,Uf,xi=!0,Yv="[DecimalError] ",oc=Yv+"Invalid argument: ",Eg=Yv+"Precision limit exceeded",Cg=Yv+"crypto unavailable",kg="[object Decimal]",Sl=Math.floor,Us=Math.pow,Gb=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Yb=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Wb=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Dg=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,sf=1e7,yi=7,Xb=9007199254740991,Zb=Sv.length-1,Np=Ev.length-1,ca={toStringTag:kg};ca.absoluteValue=ca.abs=function(){var ye=new this.constructor(this);return ye.s<0&&(ye.s=1),hi(ye)};ca.ceil=function(){return hi(new this.constructor(this),this.e+1,2)};ca.clampedTo=ca.clamp=function(ye,ge){var t,P=this,R=P.constructor;if(ye=new R(ye),ge=new R(ge),!ye.s||!ge.s)return new R(NaN);if(ye.gt(ge))throw Error(oc+ge);return t=P.cmp(ye),t<0?ye:P.cmp(ge)>0?ge:new R(P)};ca.comparedTo=ca.cmp=function(ye){var ge,t,P,R,h=this,u=h.d,A=(ye=new h.constructor(ye)).d,T=h.s,e=ye.s;if(!u||!A)return!T||!e?NaN:T!==e?T:u===A?0:!u^T<0?1:-1;if(!u[0]||!A[0])return u[0]?T:A[0]?-e:0;if(T!==e)return T;if(h.e!==ye.e)return h.e>ye.e^T<0?1:-1;for(P=u.length,R=A.length,ge=0,t=P<R?P:R;ge<t;++ge)if(u[ge]!==A[ge])return u[ge]>A[ge]^T<0?1:-1;return P===R?0:P>R^T<0?1:-1};ca.cosine=ca.cos=function(){var ye,ge,t=this,P=t.constructor;return t.d?t.d[0]?(ye=P.precision,ge=P.rounding,P.precision=ye+Math.max(t.e,t.sd())+yi,P.rounding=1,t=jb(P,Ig(P,t)),P.precision=ye,P.rounding=ge,hi(Uf==2||Uf==3?t.neg():t,ye,ge,!0)):new P(1):new P(NaN)};ca.cubeRoot=ca.cbrt=function(){var ye,ge,t,P,R,h,u,A,T,e,i=this,n=i.constructor;if(!i.isFinite()||i.isZero())return new n(i);for(xi=!1,h=i.s*Us(i.s*i,1/3),!h||Math.abs(h)==1/0?(t=fl(i.d),ye=i.e,(h=(ye-t.length+1)%3)&&(t+=h==1||h==-2?"0":"00"),h=Us(t,1/3),ye=Sl((ye+1)/3)-(ye%3==(ye<0?-1:2)),h==1/0?t="5e"+ye:(t=h.toExponential(),t=t.slice(0,t.indexOf("e")+1)+ye),P=new n(t),P.s=i.s):P=new n(h.toString()),u=(ye=n.precision)+3;;)if(A=P,T=A.times(A).times(A),e=T.plus(i),P=Fo(e.plus(i).times(A),e.plus(T),u+2,1),fl(A.d).slice(0,u)===(t=fl(P.d)).slice(0,u))if(t=t.slice(u-3,u+1),t=="9999"||!R&&t=="4999"){if(!R&&(hi(A,ye+1,0),A.times(A).times(A).eq(i))){P=A;break}u+=4,R=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(hi(P,ye+1,1),ge=!P.times(P).times(P).eq(i));break}return xi=!0,hi(P,ye,n.rounding,ge)};ca.decimalPlaces=ca.dp=function(){var ye,ge=this.d,t=NaN;if(ge){if(ye=ge.length-1,t=(ye-Sl(this.e/yi))*yi,ye=ge[ye],ye)for(;ye%10==0;ye/=10)t--;t<0&&(t=0)}return t};ca.dividedBy=ca.div=function(ye){return Fo(this,new this.constructor(ye))};ca.dividedToIntegerBy=ca.divToInt=function(ye){var ge=this,t=ge.constructor;return hi(Fo(ge,new t(ye),0,1,1),t.precision,t.rounding)};ca.equals=ca.eq=function(ye){return this.cmp(ye)===0};ca.floor=function(){return hi(new this.constructor(this),this.e+1,3)};ca.greaterThan=ca.gt=function(ye){return this.cmp(ye)>0};ca.greaterThanOrEqualTo=ca.gte=function(ye){var ge=this.cmp(ye);return ge==1||ge===0};ca.hyperbolicCosine=ca.cosh=function(){var ye,ge,t,P,R,h=this,u=h.constructor,A=new u(1);if(!h.isFinite())return new u(h.s?1/0:NaN);if(h.isZero())return A;t=u.precision,P=u.rounding,u.precision=t+Math.max(h.e,h.sd())+4,u.rounding=1,R=h.d.length,R<32?(ye=Math.ceil(R/3),ge=(1/Xv(4,ye)).toString()):(ye=16,ge="2.3283064365386962890625e-10"),h=ih(u,1,h.times(ge),new u(1),!0);for(var T,e=ye,i=new u(8);e--;)T=h.times(h),h=A.minus(T.times(i.minus(T.times(i))));return hi(h,u.precision=t,u.rounding=P,!0)};ca.hyperbolicSine=ca.sinh=function(){var ye,ge,t,P,R=this,h=R.constructor;if(!R.isFinite()||R.isZero())return new h(R);if(ge=h.precision,t=h.rounding,h.precision=ge+Math.max(R.e,R.sd())+4,h.rounding=1,P=R.d.length,P<3)R=ih(h,2,R,R,!0);else{ye=1.4*Math.sqrt(P),ye=ye>16?16:ye|0,R=R.times(1/Xv(5,ye)),R=ih(h,2,R,R,!0);for(var u,A=new h(5),T=new h(16),e=new h(20);ye--;)u=R.times(R),R=R.times(A.plus(u.times(T.times(u).plus(e))))}return h.precision=ge,h.rounding=t,hi(R,ge,t,!0)};ca.hyperbolicTangent=ca.tanh=function(){var ye,ge,t=this,P=t.constructor;return t.isFinite()?t.isZero()?new P(t):(ye=P.precision,ge=P.rounding,P.precision=ye+7,P.rounding=1,Fo(t.sinh(),t.cosh(),P.precision=ye,P.rounding=ge)):new P(t.s)};ca.inverseCosine=ca.acos=function(){var ye,ge=this,t=ge.constructor,P=ge.abs().cmp(1),R=t.precision,h=t.rounding;return P!==-1?P===0?ge.isNeg()?of(t,R,h):new t(0):new t(NaN):ge.isZero()?of(t,R+4,h).times(.5):(t.precision=R+6,t.rounding=1,ge=ge.asin(),ye=of(t,R+4,h).times(.5),t.precision=R,t.rounding=h,ye.minus(ge))};ca.inverseHyperbolicCosine=ca.acosh=function(){var ye,ge,t=this,P=t.constructor;return t.lte(1)?new P(t.eq(1)?0:NaN):t.isFinite()?(ye=P.precision,ge=P.rounding,P.precision=ye+Math.max(Math.abs(t.e),t.sd())+4,P.rounding=1,xi=!1,t=t.times(t).minus(1).sqrt().plus(t),xi=!0,P.precision=ye,P.rounding=ge,t.ln()):new P(t)};ca.inverseHyperbolicSine=ca.asinh=function(){var ye,ge,t=this,P=t.constructor;return!t.isFinite()||t.isZero()?new P(t):(ye=P.precision,ge=P.rounding,P.precision=ye+2*Math.max(Math.abs(t.e),t.sd())+6,P.rounding=1,xi=!1,t=t.times(t).plus(1).sqrt().plus(t),xi=!0,P.precision=ye,P.rounding=ge,t.ln())};ca.inverseHyperbolicTangent=ca.atanh=function(){var ye,ge,t,P,R=this,h=R.constructor;return R.isFinite()?R.e>=0?new h(R.abs().eq(1)?R.s/0:R.isZero()?R:NaN):(ye=h.precision,ge=h.rounding,P=R.sd(),Math.max(P,ye)<2*-R.e-1?hi(new h(R),ye,ge,!0):(h.precision=t=P-R.e,R=Fo(R.plus(1),new h(1).minus(R),t+ye,1),h.precision=ye+4,h.rounding=1,R=R.ln(),h.precision=ye,h.rounding=ge,R.times(.5))):new h(NaN)};ca.inverseSine=ca.asin=function(){var ye,ge,t,P,R=this,h=R.constructor;return R.isZero()?new h(R):(ge=R.abs().cmp(1),t=h.precision,P=h.rounding,ge!==-1?ge===0?(ye=of(h,t+4,P).times(.5),ye.s=R.s,ye):new h(NaN):(h.precision=t+6,h.rounding=1,R=R.div(new h(1).minus(R.times(R)).sqrt().plus(1)).atan(),h.precision=t,h.rounding=P,R.times(2)))};ca.inverseTangent=ca.atan=function(){var ye,ge,t,P,R,h,u,A,T,e=this,i=e.constructor,n=i.precision,a=i.rounding;if(e.isFinite()){if(e.isZero())return new i(e);if(e.abs().eq(1)&&n+4<=Np)return u=of(i,n+4,a).times(.25),u.s=e.s,u}else{if(!e.s)return new i(NaN);if(n+4<=Np)return u=of(i,n+4,a).times(.5),u.s=e.s,u}for(i.precision=A=n+10,i.rounding=1,t=Math.min(28,A/yi+2|0),ye=t;ye;--ye)e=e.div(e.times(e).plus(1).sqrt().plus(1));for(xi=!1,ge=Math.ceil(A/yi),P=1,T=e.times(e),u=new i(e),R=e;ye!==-1;)if(R=R.times(T),h=u.minus(R.div(P+=2)),R=R.times(T),u=h.plus(R.div(P+=2)),u.d[ge]!==void 0)for(ye=ge;u.d[ye]===h.d[ye]&&ye--;);return t&&(u=u.times(2<<t-1)),xi=!0,hi(u,i.precision=n,i.rounding=a,!0)};ca.isFinite=function(){return!!this.d};ca.isInteger=ca.isInt=function(){return!!this.d&&Sl(this.e/yi)>this.d.length-2};ca.isNaN=function(){return!this.s};ca.isNegative=ca.isNeg=function(){return this.s<0};ca.isPositive=ca.isPos=function(){return this.s>0};ca.isZero=function(){return!!this.d&&this.d[0]===0};ca.lessThan=ca.lt=function(ye){return this.cmp(ye)<0};ca.lessThanOrEqualTo=ca.lte=function(ye){return this.cmp(ye)<1};ca.logarithm=ca.log=function(ye){var ge,t,P,R,h,u,A,T,e=this,i=e.constructor,n=i.precision,a=i.rounding,r=5;if(ye==null)ye=new i(10),ge=!0;else{if(ye=new i(ye),t=ye.d,ye.s<0||!t||!t[0]||ye.eq(1))return new i(NaN);ge=ye.eq(10)}if(t=e.d,e.s<0||!t||!t[0]||e.eq(1))return new i(t&&!t[0]?-1/0:e.s!=1?NaN:t?0:1/0);if(ge)if(t.length>1)h=!0;else{for(R=t[0];R%10===0;)R/=10;h=R!==1}if(xi=!1,A=n+r,u=nc(e,A),P=ge?Cv(i,A+10):nc(ye,A),T=Fo(u,P,A,1),Ih(T.d,R=n,a))do if(A+=10,u=nc(e,A),P=ge?Cv(i,A+10):nc(ye,A),T=Fo(u,P,A,1),!h){+fl(T.d).slice(R+1,R+15)+1==1e14&&(T=hi(T,n+1,0));break}while(Ih(T.d,R+=10,a));return xi=!0,hi(T,n,a)};ca.minus=ca.sub=function(ye){var ge,t,P,R,h,u,A,T,e,i,n,a,r=this,f=r.constructor;if(ye=new f(ye),!r.d||!ye.d)return!r.s||!ye.s?ye=new f(NaN):r.d?ye.s=-ye.s:ye=new f(ye.d||r.s!==ye.s?r:NaN),ye;if(r.s!=ye.s)return ye.s=-ye.s,r.plus(ye);if(e=r.d,a=ye.d,A=f.precision,T=f.rounding,!e[0]||!a[0]){if(a[0])ye.s=-ye.s;else if(e[0])ye=new f(r);else return new f(T===3?-0:0);return xi?hi(ye,A,T):ye}if(t=Sl(ye.e/yi),i=Sl(r.e/yi),e=e.slice(),h=i-t,h){for(n=h<0,n?(ge=e,h=-h,u=a.length):(ge=a,t=i,u=e.length),P=Math.max(Math.ceil(A/yi),u)+2,h>P&&(h=P,ge.length=1),ge.reverse(),P=h;P--;)ge.push(0);ge.reverse()}else{for(P=e.length,u=a.length,n=P<u,n&&(u=P),P=0;P<u;P++)if(e[P]!=a[P]){n=e[P]<a[P];break}h=0}for(n&&(ge=e,e=a,a=ge,ye.s=-ye.s),u=e.length,P=a.length-u;P>0;--P)e[u++]=0;for(P=a.length;P>h;){if(e[--P]<a[P]){for(R=P;R&&e[--R]===0;)e[R]=sf-1;--e[R],e[P]+=sf}e[P]-=a[P]}for(;e[--u]===0;)e.pop();for(;e[0]===0;e.shift())--t;return e[0]?(ye.d=e,ye.e=Wv(e,t),xi?hi(ye,A,T):ye):new f(T===3?-0:0)};ca.modulo=ca.mod=function(ye){var ge,t=this,P=t.constructor;return ye=new P(ye),!t.d||!ye.s||ye.d&&!ye.d[0]?new P(NaN):!ye.d||t.d&&!t.d[0]?hi(new P(t),P.precision,P.rounding):(xi=!1,P.modulo==9?(ge=Fo(t,ye.abs(),0,3,1),ge.s*=ye.s):ge=Fo(t,ye,0,P.modulo,1),ge=ge.times(ye),xi=!0,t.minus(ge))};ca.naturalExponential=ca.exp=function(){return Op(this)};ca.naturalLogarithm=ca.ln=function(){return nc(this)};ca.negated=ca.neg=function(){var ye=new this.constructor(this);return ye.s=-ye.s,hi(ye)};ca.plus=ca.add=function(ye){var ge,t,P,R,h,u,A,T,e,i,n=this,a=n.constructor;if(ye=new a(ye),!n.d||!ye.d)return!n.s||!ye.s?ye=new a(NaN):n.d||(ye=new a(ye.d||n.s===ye.s?n:NaN)),ye;if(n.s!=ye.s)return ye.s=-ye.s,n.minus(ye);if(e=n.d,i=ye.d,A=a.precision,T=a.rounding,!e[0]||!i[0])return i[0]||(ye=new a(n)),xi?hi(ye,A,T):ye;if(h=Sl(n.e/yi),P=Sl(ye.e/yi),e=e.slice(),R=h-P,R){for(R<0?(t=e,R=-R,u=i.length):(t=i,P=h,u=e.length),h=Math.ceil(A/yi),u=h>u?h+1:u+1,R>u&&(R=u,t.length=1),t.reverse();R--;)t.push(0);t.reverse()}for(u=e.length,R=i.length,u-R<0&&(R=u,t=i,i=e,e=t),ge=0;R;)ge=(e[--R]=e[R]+i[R]+ge)/sf|0,e[R]%=sf;for(ge&&(e.unshift(ge),++P),u=e.length;e[--u]==0;)e.pop();return ye.d=e,ye.e=Wv(e,P),xi?hi(ye,A,T):ye};ca.precision=ca.sd=function(ye){var ge,t=this;if(ye!==void 0&&ye!==!!ye&&ye!==1&&ye!==0)throw Error(oc+ye);return t.d?(ge=Lg(t.d),ye&&t.e+1>ge&&(ge=t.e+1)):ge=NaN,ge};ca.round=function(){var ye=this,ge=ye.constructor;return hi(new ge(ye),ye.e+1,ge.rounding)};ca.sine=ca.sin=function(){var ye,ge,t=this,P=t.constructor;return t.isFinite()?t.isZero()?new P(t):(ye=P.precision,ge=P.rounding,P.precision=ye+Math.max(t.e,t.sd())+yi,P.rounding=1,t=Kb(P,Ig(P,t)),P.precision=ye,P.rounding=ge,hi(Uf>2?t.neg():t,ye,ge,!0)):new P(NaN)};ca.squareRoot=ca.sqrt=function(){var ye,ge,t,P,R,h,u=this,A=u.d,T=u.e,e=u.s,i=u.constructor;if(e!==1||!A||!A[0])return new i(!e||e<0&&(!A||A[0])?NaN:A?u:1/0);for(xi=!1,e=Math.sqrt(+u),e==0||e==1/0?(ge=fl(A),(ge.length+T)%2==0&&(ge+="0"),e=Math.sqrt(ge),T=Sl((T+1)/2)-(T<0||T%2),e==1/0?ge="5e"+T:(ge=e.toExponential(),ge=ge.slice(0,ge.indexOf("e")+1)+T),P=new i(ge)):P=new i(e.toString()),t=(T=i.precision)+3;;)if(h=P,P=h.plus(Fo(u,h,t+2,1)).times(.5),fl(h.d).slice(0,t)===(ge=fl(P.d)).slice(0,t))if(ge=ge.slice(t-3,t+1),ge=="9999"||!R&&ge=="4999"){if(!R&&(hi(h,T+1,0),h.times(h).eq(u))){P=h;break}t+=4,R=1}else{(!+ge||!+ge.slice(1)&&ge.charAt(0)=="5")&&(hi(P,T+1,1),ye=!P.times(P).eq(u));break}return xi=!0,hi(P,T,i.rounding,ye)};ca.tangent=ca.tan=function(){var ye,ge,t=this,P=t.constructor;return t.isFinite()?t.isZero()?new P(t):(ye=P.precision,ge=P.rounding,P.precision=ye+10,P.rounding=1,t=t.sin(),t.s=1,t=Fo(t,new P(1).minus(t.times(t)).sqrt(),ye+10,0),P.precision=ye,P.rounding=ge,hi(Uf==2||Uf==4?t.neg():t,ye,ge,!0)):new P(NaN)};ca.times=ca.mul=function(ye){var ge,t,P,R,h,u,A,T,e,i=this,n=i.constructor,a=i.d,r=(ye=new n(ye)).d;if(ye.s*=i.s,!a||!a[0]||!r||!r[0])return new n(!ye.s||a&&!a[0]&&!r||r&&!r[0]&&!a?NaN:!a||!r?ye.s/0:ye.s*0);for(t=Sl(i.e/yi)+Sl(ye.e/yi),T=a.length,e=r.length,T<e&&(h=a,a=r,r=h,u=T,T=e,e=u),h=[],u=T+e,P=u;P--;)h.push(0);for(P=e;--P>=0;){for(ge=0,R=T+P;R>P;)A=h[R]+r[P]*a[R-P-1]+ge,h[R--]=A%sf|0,ge=A/sf|0;h[R]=(h[R]+ge)%sf|0}for(;!h[--u];)h.pop();return ge?++t:h.shift(),ye.d=h,ye.e=Wv(h,t),xi?hi(ye,n.precision,n.rounding):ye};ca.toBinary=function(ye,ge){return Zp(this,2,ye,ge)};ca.toDecimalPlaces=ca.toDP=function(ye,ge){var t=this,P=t.constructor;return t=new P(t),ye===void 0?t:(tu(ye,0,sc),ge===void 0?ge=P.rounding:tu(ge,0,8),hi(t,ye+t.e+1,ge))};ca.toExponential=function(ye,ge){var t,P=this,R=P.constructor;return ye===void 0?t=Ef(P,!0):(tu(ye,0,sc),ge===void 0?ge=R.rounding:tu(ge,0,8),P=hi(new R(P),ye+1,ge),t=Ef(P,!0,ye+1)),P.isNeg()&&!P.isZero()?"-"+t:t};ca.toFixed=function(ye,ge){var t,P,R=this,h=R.constructor;return ye===void 0?t=Ef(R):(tu(ye,0,sc),ge===void 0?ge=h.rounding:tu(ge,0,8),P=hi(new h(R),ye+R.e+1,ge),t=Ef(P,!1,ye+P.e+1)),R.isNeg()&&!R.isZero()?"-"+t:t};ca.toFraction=function(ye){var ge,t,P,R,h,u,A,T,e,i,n,a,r=this,f=r.d,o=r.constructor;if(!f)return new o(r);if(e=t=new o(1),P=T=new o(0),ge=new o(P),h=ge.e=Lg(f)-r.e-1,u=h%yi,ge.d[0]=Us(10,u<0?yi+u:u),ye==null)ye=h>0?ge:e;else{if(A=new o(ye),!A.isInt()||A.lt(e))throw Error(oc+A);ye=A.gt(ge)?h>0?ge:e:A}for(xi=!1,A=new o(fl(f)),i=o.precision,o.precision=h=f.length*yi*2;n=Fo(A,ge,0,1,1),R=t.plus(n.times(P)),R.cmp(ye)!=1;)t=P,P=R,R=e,e=T.plus(n.times(R)),T=R,R=ge,ge=A.minus(n.times(R)),A=R;return R=Fo(ye.minus(t),P,0,1,1),T=T.plus(R.times(e)),t=t.plus(R.times(P)),T.s=e.s=r.s,a=Fo(e,P,h,1).minus(r).abs().cmp(Fo(T,t,h,1).minus(r).abs())<1?[e,P]:[T,t],o.precision=i,xi=!0,a};ca.toHexadecimal=ca.toHex=function(ye,ge){return Zp(this,16,ye,ge)};ca.toNearest=function(ye,ge){var t=this,P=t.constructor;if(t=new P(t),ye==null){if(!t.d)return t;ye=new P(1),ge=P.rounding}else{if(ye=new P(ye),ge===void 0?ge=P.rounding:tu(ge,0,8),!t.d)return ye.s?t:ye;if(!ye.d)return ye.s&&(ye.s=t.s),ye}return ye.d[0]?(xi=!1,t=Fo(t,ye,0,ge,1).times(ye),xi=!0,hi(t)):(ye.s=t.s,t=ye),t};ca.toNumber=function(){return+this};ca.toOctal=function(ye,ge){return Zp(this,8,ye,ge)};ca.toPower=ca.pow=function(ye){var ge,t,P,R,h,u,A=this,T=A.constructor,e=+(ye=new T(ye));if(!A.d||!ye.d||!A.d[0]||!ye.d[0])return new T(Us(+A,e));if(A=new T(A),A.eq(1))return A;if(P=T.precision,h=T.rounding,ye.eq(1))return hi(A,P,h);if(ge=Sl(ye.e/yi),ge>=ye.d.length-1&&(t=e<0?-e:e)<=Xb)return R=Pg(T,A,t,P),ye.s<0?new T(1).div(R):hi(R,P,h);if(u=A.s,u<0){if(ge<ye.d.length-1)return new T(NaN);if((ye.d[ge]&1)==0&&(u=1),A.e==0&&A.d[0]==1&&A.d.length==1)return A.s=u,A}return t=Us(+A,e),ge=t==0||!isFinite(t)?Sl(e*(Math.log("0."+fl(A.d))/Math.LN10+A.e+1)):new T(t+"").e,ge>T.maxE+1||ge<T.minE-1?new T(ge>0?u/0:0):(xi=!1,T.rounding=A.s=1,t=Math.min(12,(ge+"").length),R=Op(ye.times(nc(A,P+t)),P),R.d&&(R=hi(R,P+5,1),Ih(R.d,P,h)&&(ge=P+10,R=hi(Op(ye.times(nc(A,ge+t)),ge),ge+5,1),+fl(R.d).slice(P+1,P+15)+1==1e14&&(R=hi(R,P+1,0)))),R.s=u,xi=!0,T.rounding=h,hi(R,P,h))};ca.toPrecision=function(ye,ge){var t,P=this,R=P.constructor;return ye===void 0?t=Ef(P,P.e<=R.toExpNeg||P.e>=R.toExpPos):(tu(ye,1,sc),ge===void 0?ge=R.rounding:tu(ge,0,8),P=hi(new R(P),ye,ge),t=Ef(P,ye<=P.e||P.e<=R.toExpNeg,ye)),P.isNeg()&&!P.isZero()?"-"+t:t};ca.toSignificantDigits=ca.toSD=function(ye,ge){var t=this,P=t.constructor;return ye===void 0?(ye=P.precision,ge=P.rounding):(tu(ye,1,sc),ge===void 0?ge=P.rounding:tu(ge,0,8)),hi(new P(t),ye,ge)};ca.toString=function(){var ye=this,ge=ye.constructor,t=Ef(ye,ye.e<=ge.toExpNeg||ye.e>=ge.toExpPos);return ye.isNeg()&&!ye.isZero()?"-"+t:t};ca.truncated=ca.trunc=function(){return hi(new this.constructor(this),this.e+1,1)};ca.valueOf=ca.toJSON=function(){var ye=this,ge=ye.constructor,t=Ef(ye,ye.e<=ge.toExpNeg||ye.e>=ge.toExpPos);return ye.isNeg()?"-"+t:t};function fl(ye){var ge,t,P,R=ye.length-1,h="",u=ye[0];if(R>0){for(h+=u,ge=1;ge<R;ge++)P=ye[ge]+"",t=yi-P.length,t&&(h+=rc(t)),h+=P;u=ye[ge],P=u+"",t=yi-P.length,t&&(h+=rc(t))}else if(u===0)return"0";for(;u%10===0;)u/=10;return h+u}function tu(ye,ge,t){if(ye!==~~ye||ye<ge||ye>t)throw Error(oc+ye)}function Ih(ye,ge,t,P){var R,h,u,A;for(h=ye[0];h>=10;h/=10)--ge;return--ge<0?(ge+=yi,R=0):(R=Math.ceil((ge+1)/yi),ge%=yi),h=Us(10,yi-ge),A=ye[R]%h|0,P==null?ge<3?(ge==0?A=A/100|0:ge==1&&(A=A/10|0),u=t<4&&A==99999||t>3&&A==49999||A==5e4||A==0):u=(t<4&&A+1==h||t>3&&A+1==h/2)&&(ye[R+1]/h/100|0)==Us(10,ge-2)-1||(A==h/2||A==0)&&(ye[R+1]/h/100|0)==0:ge<4?(ge==0?A=A/1e3|0:ge==1?A=A/100|0:ge==2&&(A=A/10|0),u=(P||t<4)&&A==9999||!P&&t>3&&A==4999):u=((P||t<4)&&A+1==h||!P&&t>3&&A+1==h/2)&&(ye[R+1]/h/1e3|0)==Us(10,ge-3)-1,u}function bv(ye,ge,t){for(var P,R=[0],h,u=0,A=ye.length;u<A;){for(h=R.length;h--;)R[h]*=ge;for(R[0]+=zp.indexOf(ye.charAt(u++)),P=0;P<R.length;P++)R[P]>t-1&&(R[P+1]===void 0&&(R[P+1]=0),R[P+1]+=R[P]/t|0,R[P]%=t)}return R.reverse()}function jb(ye,ge){var t,P,R;if(ge.isZero())return ge;P=ge.d.length,P<32?(t=Math.ceil(P/3),R=(1/Xv(4,t)).toString()):(t=16,R="2.3283064365386962890625e-10"),ye.precision+=t,ge=ih(ye,1,ge.times(R),new ye(1));for(var h=t;h--;){var u=ge.times(ge);ge=u.times(u).minus(u).times(8).plus(1)}return ye.precision-=t,ge}var Fo=function(){function ye(P,R,h){var u,A=0,T=P.length;for(P=P.slice();T--;)u=P[T]*R+A,P[T]=u%h|0,A=u/h|0;return A&&P.unshift(A),P}function ge(P,R,h,u){var A,T;if(h!=u)T=h>u?1:-1;else for(A=T=0;A<h;A++)if(P[A]!=R[A]){T=P[A]>R[A]?1:-1;break}return T}function t(P,R,h,u){for(var A=0;h--;)P[h]-=A,A=P[h]<R[h]?1:0,P[h]=A*u+P[h]-R[h];for(;!P[0]&&P.length>1;)P.shift()}return function(P,R,h,u,A,T){var e,i,n,a,r,f,o,s,m,g,p,v,x,l,b,c,M,_,y,w,d=P.constructor,C=P.s==R.s?1:-1,S=P.d,E=R.d;if(!S||!S[0]||!E||!E[0])return new d(!P.s||!R.s||(S?E&&S[0]==E[0]:!E)?NaN:S&&S[0]==0||!E?C*0:C/0);for(T?(r=1,i=P.e-R.e):(T=sf,r=yi,i=Sl(P.e/r)-Sl(R.e/r)),y=E.length,M=S.length,m=new d(C),g=m.d=[],n=0;E[n]==(S[n]||0);n++);if(E[n]>(S[n]||0)&&i--,h==null?(l=h=d.precision,u=d.rounding):A?l=h+(P.e-R.e)+1:l=h,l<0)g.push(1),f=!0;else{if(l=l/r+2|0,n=0,y==1){for(a=0,E=E[0],l++;(n<M||a)&&l--;n++)b=a*T+(S[n]||0),g[n]=b/E|0,a=b%E|0;f=a||n<M}else{for(a=T/(E[0]+1)|0,a>1&&(E=ye(E,a,T),S=ye(S,a,T),y=E.length,M=S.length),c=y,p=S.slice(0,y),v=p.length;v<y;)p[v++]=0;w=E.slice(),w.unshift(0),_=E[0],E[1]>=T/2&&++_;do a=0,e=ge(E,p,y,v),e<0?(x=p[0],y!=v&&(x=x*T+(p[1]||0)),a=x/_|0,a>1?(a>=T&&(a=T-1),o=ye(E,a,T),s=o.length,v=p.length,e=ge(o,p,s,v),e==1&&(a--,t(o,y<s?w:E,s,T))):(a==0&&(e=a=1),o=E.slice()),s=o.length,s<v&&o.unshift(0),t(p,o,v,T),e==-1&&(v=p.length,e=ge(E,p,y,v),e<1&&(a++,t(p,y<v?w:E,v,T))),v=p.length):e===0&&(a++,p=[0]),g[n++]=a,e&&p[0]?p[v++]=S[c]||0:(p=[S[c]],v=1);while((c++<M||p[0]!==void 0)&&l--);f=p[0]!==void 0}g[0]||g.shift()}if(r==1)m.e=i,Sg=f;else{for(n=1,a=g[0];a>=10;a/=10)n++;m.e=n+i*r-1,hi(m,A?h+m.e+1:h,u,f)}return m}}();function hi(ye,ge,t,P){var R,h,u,A,T,e,i,n,a,r=ye.constructor;e:if(ge!=null){if(n=ye.d,!n)return ye;for(R=1,A=n[0];A>=10;A/=10)R++;if(h=ge-R,h<0)h+=yi,u=ge,i=n[a=0],T=i/Us(10,R-u-1)%10|0;else if(a=Math.ceil((h+1)/yi),A=n.length,a>=A)if(P){for(;A++<=a;)n.push(0);i=T=0,R=1,h%=yi,u=h-yi+1}else break e;else{for(i=A=n[a],R=1;A>=10;A/=10)R++;h%=yi,u=h-yi+R,T=u<0?0:i/Us(10,R-u-1)%10|0}if(P=P||ge<0||n[a+1]!==void 0||(u<0?i:i%Us(10,R-u-1)),e=t<4?(T||P)&&(t==0||t==(ye.s<0?3:2)):T>5||T==5&&(t==4||P||t==6&&(h>0?u>0?i/Us(10,R-u):0:n[a-1])%10&1||t==(ye.s<0?8:7)),ge<1||!n[0])return n.length=0,e?(ge-=ye.e+1,n[0]=Us(10,(yi-ge%yi)%yi),ye.e=-ge||0):n[0]=ye.e=0,ye;if(h==0?(n.length=a,A=1,a--):(n.length=a+1,A=Us(10,yi-h),n[a]=u>0?(i/Us(10,R-u)%Us(10,u)|0)*A:0),e)for(;;)if(a==0){for(h=1,u=n[0];u>=10;u/=10)h++;for(u=n[0]+=A,A=1;u>=10;u/=10)A++;h!=A&&(ye.e++,n[0]==sf&&(n[0]=1));break}else{if(n[a]+=A,n[a]!=sf)break;n[a--]=0,A=1}for(h=n.length;n[--h]===0;)n.pop()}return xi&&(ye.e>r.maxE?(ye.d=null,ye.e=NaN):ye.e<r.minE&&(ye.e=0,ye.d=[0])),ye}function Ef(ye,ge,t){if(!ye.isFinite())return Rg(ye);var P,R=ye.e,h=fl(ye.d),u=h.length;return ge?(t&&(P=t-u)>0?h=h.charAt(0)+"."+h.slice(1)+rc(P):u>1&&(h=h.charAt(0)+"."+h.slice(1)),h=h+(ye.e<0?"e":"e+")+ye.e):R<0?(h="0."+rc(-R-1)+h,t&&(P=t-u)>0&&(h+=rc(P))):R>=u?(h+=rc(R+1-u),t&&(P=t-R-1)>0&&(h=h+"."+rc(P))):((P=R+1)<u&&(h=h.slice(0,P)+"."+h.slice(P)),t&&(P=t-u)>0&&(R+1===u&&(h+="."),h+=rc(P))),h}function Wv(ye,ge){var t=ye[0];for(ge*=yi;t>=10;t/=10)ge++;return ge}function Cv(ye,ge,t){if(ge>Zb)throw xi=!0,t&&(ye.precision=t),Error(Eg);return hi(new ye(Sv),ge,1,!0)}function of(ye,ge,t){if(ge>Np)throw Error(Eg);return hi(new ye(Ev),ge,t,!0)}function Lg(ye){var ge=ye.length-1,t=ge*yi+1;if(ge=ye[ge],ge){for(;ge%10==0;ge/=10)t--;for(ge=ye[0];ge>=10;ge/=10)t++}return t}function rc(ye){for(var ge="";ye--;)ge+="0";return ge}function Pg(ye,ge,t,P){var R,h=new ye(1),u=Math.ceil(P/yi+4);for(xi=!1;;){if(t%2&&(h=h.times(ge),S0(h.d,u)&&(R=!0)),t=Sl(t/2),t===0){t=h.d.length-1,R&&h.d[t]===0&&++h.d[t];break}ge=ge.times(ge),S0(ge.d,u)}return xi=!0,h}function M0(ye){return ye.d[ye.d.length-1]&1}function Fg(ye,ge,t){for(var P,R=new ye(ge[0]),h=0;++h<ge.length;)if(P=new ye(ge[h]),P.s)R[t](P)&&(R=P);else{R=P;break}return R}function Op(ye,ge){var t,P,R,h,u,A,T,e=0,i=0,n=0,a=ye.constructor,r=a.rounding,f=a.precision;if(!ye.d||!ye.d[0]||ye.e>17)return new a(ye.d?ye.d[0]?ye.s<0?0:1/0:1:ye.s?ye.s<0?0:ye:0/0);for(ge==null?(xi=!1,T=f):T=ge,A=new a(.03125);ye.e>-2;)ye=ye.times(A),n+=5;for(P=Math.log(Us(2,n))/Math.LN10*2+5|0,T+=P,t=h=u=new a(1),a.precision=T;;){if(h=hi(h.times(ye),T,1),t=t.times(++i),A=u.plus(Fo(h,t,T,1)),fl(A.d).slice(0,T)===fl(u.d).slice(0,T)){for(R=n;R--;)u=hi(u.times(u),T,1);if(ge==null)if(e<3&&Ih(u.d,T-P,r,e))a.precision=T+=10,t=h=A=new a(1),i=0,e++;else return hi(u,a.precision=f,r,xi=!0);else return a.precision=f,u}u=A}}function nc(ye,ge){var t,P,R,h,u,A,T,e,i,n,a,r=1,f=10,o=ye,s=o.d,m=o.constructor,g=m.rounding,p=m.precision;if(o.s<0||!s||!s[0]||!o.e&&s[0]==1&&s.length==1)return new m(s&&!s[0]?-1/0:o.s!=1?NaN:s?0:o);if(ge==null?(xi=!1,i=p):i=ge,m.precision=i+=f,t=fl(s),P=t.charAt(0),Math.abs(h=o.e)<15e14){for(;P<7&&P!=1||P==1&&t.charAt(1)>3;)o=o.times(ye),t=fl(o.d),P=t.charAt(0),r++;h=o.e,P>1?(o=new m("0."+t),h++):o=new m(P+"."+t.slice(1))}else return e=Cv(m,i+2,p).times(h+""),o=nc(new m(P+"."+t.slice(1)),i-f).plus(e),m.precision=p,ge==null?hi(o,p,g,xi=!0):o;for(n=o,T=u=o=Fo(o.minus(1),o.plus(1),i,1),a=hi(o.times(o),i,1),R=3;;){if(u=hi(u.times(a),i,1),e=T.plus(Fo(u,new m(R),i,1)),fl(e.d).slice(0,i)===fl(T.d).slice(0,i))if(T=T.times(2),h!==0&&(T=T.plus(Cv(m,i+2,p).times(h+""))),T=Fo(T,new m(r),i,1),ge==null)if(Ih(T.d,i-f,g,A))m.precision=i+=f,e=u=o=Fo(n.minus(1),n.plus(1),i,1),a=hi(o.times(o),i,1),R=A=1;else return hi(T,m.precision=p,g,xi=!0);else return m.precision=p,T;T=e,R+=2}}function Rg(ye){return String(ye.s*ye.s/0)}function Up(ye,ge){var t,P,R;for((t=ge.indexOf("."))>-1&&(ge=ge.replace(".","")),(P=ge.search(/e/i))>0?(t<0&&(t=P),t+=+ge.slice(P+1),ge=ge.substring(0,P)):t<0&&(t=ge.length),P=0;ge.charCodeAt(P)===48;P++);for(R=ge.length;ge.charCodeAt(R-1)===48;--R);if(ge=ge.slice(P,R),ge){if(R-=P,ye.e=t=t-P-1,ye.d=[],P=(t+1)%yi,t<0&&(P+=yi),P<R){for(P&&ye.d.push(+ge.slice(0,P)),R-=yi;P<R;)ye.d.push(+ge.slice(P,P+=yi));ge=ge.slice(P),P=yi-ge.length}else P-=R;for(;P--;)ge+="0";ye.d.push(+ge),xi&&(ye.e>ye.constructor.maxE?(ye.d=null,ye.e=NaN):ye.e<ye.constructor.minE&&(ye.e=0,ye.d=[0]))}else ye.e=0,ye.d=[0];return ye}function Jb(ye,ge){var t,P,R,h,u,A,T,e,i;if(ge.indexOf("_")>-1){if(ge=ge.replace(/(\d)_(?=\d)/g,"$1"),Dg.test(ge))return Up(ye,ge)}else if(ge==="Infinity"||ge==="NaN")return+ge||(ye.s=NaN),ye.e=NaN,ye.d=null,ye;if(Yb.test(ge))t=16,ge=ge.toLowerCase();else if(Gb.test(ge))t=2;else if(Wb.test(ge))t=8;else throw Error(oc+ge);for(h=ge.search(/p/i),h>0?(T=+ge.slice(h+1),ge=ge.substring(2,h)):ge=ge.slice(2),h=ge.indexOf("."),u=h>=0,P=ye.constructor,u&&(ge=ge.replace(".",""),A=ge.length,h=A-h,R=Pg(P,new P(t),h,h*2)),e=bv(ge,t,sf),i=e.length-1,h=i;e[h]===0;--h)e.pop();return h<0?new P(ye.s*0):(ye.e=Wv(e,i),ye.d=e,xi=!1,u&&(ye=Fo(ye,R,A*4)),T&&(ye=ye.times(Math.abs(T)<54?Us(2,T):oh.pow(2,T))),xi=!0,ye)}function Kb(ye,ge){var t,P=ge.d.length;if(P<3)return ge.isZero()?ge:ih(ye,2,ge,ge);t=1.4*Math.sqrt(P),t=t>16?16:t|0,ge=ge.times(1/Xv(5,t)),ge=ih(ye,2,ge,ge);for(var R,h=new ye(5),u=new ye(16),A=new ye(20);t--;)R=ge.times(ge),ge=ge.times(h.plus(R.times(u.times(R).minus(A))));return ge}function ih(ye,ge,t,P,R){var h,u,A,T,e=ye.precision,i=Math.ceil(e/yi);for(xi=!1,T=t.times(t),A=new ye(P);;){if(u=Fo(A.times(T),new ye(ge++*ge++),e,1),A=R?P.plus(u):P.minus(u),P=Fo(u.times(T),new ye(ge++*ge++),e,1),u=A.plus(P),u.d[i]!==void 0){for(h=i;u.d[h]===A.d[h]&&h--;);if(h==-1)break}h=A,A=P,P=u,u=h}return xi=!0,u.d.length=i+1,u}function Xv(ye,ge){for(var t=ye;--ge;)t*=ye;return t}function Ig(ye,ge){var t,P=ge.s<0,R=of(ye,ye.precision,1),h=R.times(.5);if(ge=ge.abs(),ge.lte(h))return Uf=P?4:1,ge;if(t=ge.divToInt(R),t.isZero())Uf=P?3:2;else{if(ge=ge.minus(t.times(R)),ge.lte(h))return Uf=M0(t)?P?2:3:P?4:1,ge;Uf=M0(t)?P?1:4:P?3:2}return ge.minus(R).abs()}function Zp(ye,ge,t,P){var R,h,u,A,T,e,i,n,a,r=ye.constructor,f=t!==void 0;if(f?(tu(t,1,sc),P===void 0?P=r.rounding:tu(P,0,8)):(t=r.precision,P=r.rounding),!ye.isFinite())i=Rg(ye);else{for(i=Ef(ye),u=i.indexOf("."),f?(R=2,ge==16?t=t*4-3:ge==8&&(t=t*3-2)):R=ge,u>=0&&(i=i.replace(".",""),a=new r(1),a.e=i.length-u,a.d=bv(Ef(a),10,R),a.e=a.d.length),n=bv(i,10,R),h=T=n.length;n[--T]==0;)n.pop();if(!n[0])i=f?"0p+0":"0";else{if(u<0?h--:(ye=new r(ye),ye.d=n,ye.e=h,ye=Fo(ye,a,t,P,0,R),n=ye.d,h=ye.e,e=Sg),u=n[t],A=R/2,e=e||n[t+1]!==void 0,e=P<4?(u!==void 0||e)&&(P===0||P===(ye.s<0?3:2)):u>A||u===A&&(P===4||e||P===6&&n[t-1]&1||P===(ye.s<0?8:7)),n.length=t,e)for(;++n[--t]>R-1;)n[t]=0,t||(++h,n.unshift(1));for(T=n.length;!n[T-1];--T);for(u=0,i="";u<T;u++)i+=zp.charAt(n[u]);if(f){if(T>1)if(ge==16||ge==8){for(u=ge==16?4:3,--T;T%u;T++)i+="0";for(n=bv(i,R,ge),T=n.length;!n[T-1];--T);for(u=1,i="1.";u<T;u++)i+=zp.charAt(n[u])}else i=i.charAt(0)+"."+i.slice(1);i=i+(h<0?"p":"p+")+h}else if(h<0){for(;++h;)i="0"+i;i="0."+i}else if(++h>T)for(h-=T;h--;)i+="0";else h<T&&(i=i.slice(0,h)+"."+i.slice(h))}i=(ge==16?"0x":ge==2?"0b":ge==8?"0o":"")+i}return ye.s<0?"-"+i:i}function S0(ye,ge){if(ye.length>ge)return ye.length=ge,!0}function Qb(ye){return new this(ye).abs()}function $b(ye){return new this(ye).acos()}function qb(ye){return new this(ye).acosh()}function e2(ye,ge){return new this(ye).plus(ge)}function t2(ye){return new this(ye).asin()}function r2(ye){return new this(ye).asinh()}function n2(ye){return new this(ye).atan()}function a2(ye){return new this(ye).atanh()}function i2(ye,ge){ye=new this(ye),ge=new this(ge);var t,P=this.precision,R=this.rounding,h=P+4;return!ye.s||!ge.s?t=new this(NaN):!ye.d&&!ge.d?(t=of(this,h,1).times(ge.s>0?.25:.75),t.s=ye.s):!ge.d||ye.isZero()?(t=ge.s<0?of(this,P,R):new this(0),t.s=ye.s):!ye.d||ge.isZero()?(t=of(this,h,1).times(.5),t.s=ye.s):ge.s<0?(this.precision=h,this.rounding=1,t=this.atan(Fo(ye,ge,h,1)),ge=of(this,h,1),this.precision=P,this.rounding=R,t=ye.s<0?t.minus(ge):t.plus(ge)):t=this.atan(Fo(ye,ge,h,1)),t}function o2(ye){return new this(ye).cbrt()}function s2(ye){return hi(ye=new this(ye),ye.e+1,2)}function l2(ye,ge,t){return new this(ye).clamp(ge,t)}function u2(ye){if(!ye||typeof ye!="object")throw Error(Yv+"Object expected");var ge,t,P,R=ye.defaults===!0,h=["precision",1,sc,"rounding",0,8,"toExpNeg",-rh,0,"toExpPos",0,rh,"maxE",0,rh,"minE",-rh,0,"modulo",0,9];for(ge=0;ge<h.length;ge+=3)if(t=h[ge],R&&(this[t]=Bp[t]),(P=ye[t])!==void 0)if(Sl(P)===P&&P>=h[ge+1]&&P<=h[ge+2])this[t]=P;else throw Error(oc+t+": "+P);if(t="crypto",R&&(this[t]=Bp[t]),(P=ye[t])!==void 0)if(P===!0||P===!1||P===0||P===1)if(P)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(Cg);else this[t]=!1;else throw Error(oc+t+": "+P);return this}function f2(ye){return new this(ye).cos()}function c2(ye){return new this(ye).cosh()}function zg(ye){var ge,t,P;function R(h){var u,A,T,e=this;if(!(e instanceof R))return new R(h);if(e.constructor=R,E0(h)){e.s=h.s,xi?!h.d||h.e>R.maxE?(e.e=NaN,e.d=null):h.e<R.minE?(e.e=0,e.d=[0]):(e.e=h.e,e.d=h.d.slice()):(e.e=h.e,e.d=h.d?h.d.slice():h.d);return}if(T=typeof h,T==="number"){if(h===0){e.s=1/h<0?-1:1,e.e=0,e.d=[0];return}if(h<0?(h=-h,e.s=-1):e.s=1,h===~~h&&h<1e7){for(u=0,A=h;A>=10;A/=10)u++;xi?u>R.maxE?(e.e=NaN,e.d=null):u<R.minE?(e.e=0,e.d=[0]):(e.e=u,e.d=[h]):(e.e=u,e.d=[h]);return}else if(h*0!==0){h||(e.s=NaN),e.e=NaN,e.d=null;return}return Up(e,h.toString())}else if(T!=="string")throw Error(oc+h);return(A=h.charCodeAt(0))===45?(h=h.slice(1),e.s=-1):(A===43&&(h=h.slice(1)),e.s=1),Dg.test(h)?Up(e,h):Jb(e,h)}if(R.prototype=ca,R.ROUND_UP=0,R.ROUND_DOWN=1,R.ROUND_CEIL=2,R.ROUND_FLOOR=3,R.ROUND_HALF_UP=4,R.ROUND_HALF_DOWN=5,R.ROUND_HALF_EVEN=6,R.ROUND_HALF_CEIL=7,R.ROUND_HALF_FLOOR=8,R.EUCLID=9,R.config=R.set=u2,R.clone=zg,R.isDecimal=E0,R.abs=Qb,R.acos=$b,R.acosh=qb,R.add=e2,R.asin=t2,R.asinh=r2,R.atan=n2,R.atanh=a2,R.atan2=i2,R.cbrt=o2,R.ceil=s2,R.clamp=l2,R.cos=f2,R.cosh=c2,R.div=h2,R.exp=v2,R.floor=p2,R.hypot=d2,R.ln=g2,R.log=y2,R.log10=x2,R.log2=m2,R.max=b2,R.min=_2,R.mod=w2,R.mul=T2,R.pow=A2,R.random=M2,R.round=S2,R.sign=E2,R.sin=C2,R.sinh=k2,R.sqrt=D2,R.sub=L2,R.sum=P2,R.tan=F2,R.tanh=R2,R.trunc=I2,ye===void 0&&(ye={}),ye&&ye.defaults!==!0)for(P=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],ge=0;ge<P.length;)ye.hasOwnProperty(t=P[ge++])||(ye[t]=this[t]);return R.config(ye),R}function h2(ye,ge){return new this(ye).div(ge)}function v2(ye){return new this(ye).exp()}function p2(ye){return hi(ye=new this(ye),ye.e+1,3)}function d2(){var ye,ge,t=new this(0);for(xi=!1,ye=0;ye<arguments.length;)if(ge=new this(arguments[ye++]),ge.d)t.d&&(t=t.plus(ge.times(ge)));else{if(ge.s)return xi=!0,new this(1/0);t=ge}return xi=!0,t.sqrt()}function E0(ye){return ye instanceof oh||ye&&ye.toStringTag===kg||!1}function g2(ye){return new this(ye).ln()}function y2(ye,ge){return new this(ye).log(ge)}function m2(ye){return new this(ye).log(2)}function x2(ye){return new this(ye).log(10)}function b2(){return Fg(this,arguments,"lt")}function _2(){return Fg(this,arguments,"gt")}function w2(ye,ge){return new this(ye).mod(ge)}function T2(ye,ge){return new this(ye).mul(ge)}function A2(ye,ge){return new this(ye).pow(ge)}function M2(ye){var ge,t,P,R,h=0,u=new this(1),A=[];if(ye===void 0?ye=this.precision:tu(ye,1,sc),P=Math.ceil(ye/yi),this.crypto)if(crypto.getRandomValues)for(ge=crypto.getRandomValues(new Uint32Array(P));h<P;)R=ge[h],R>=429e7?ge[h]=crypto.getRandomValues(new Uint32Array(1))[0]:A[h++]=R%1e7;else if(crypto.randomBytes){for(ge=crypto.randomBytes(P*=4);h<P;)R=ge[h]+(ge[h+1]<<8)+(ge[h+2]<<16)+((ge[h+3]&127)<<24),R>=214e7?crypto.randomBytes(4).copy(ge,h):(A.push(R%1e7),h+=4);h=P/4}else throw Error(Cg);else for(;h<P;)A[h++]=Math.random()*1e7|0;for(P=A[--h],ye%=yi,P&&ye&&(R=Us(10,yi-ye),A[h]=(P/R|0)*R);A[h]===0;h--)A.pop();if(h<0)t=0,A=[0];else{for(t=-1;A[0]===0;t-=yi)A.shift();for(P=1,R=A[0];R>=10;R/=10)P++;P<yi&&(t-=yi-P)}return u.e=t,u.d=A,u}function S2(ye){return hi(ye=new this(ye),ye.e+1,this.rounding)}function E2(ye){return ye=new this(ye),ye.d?ye.d[0]?ye.s:0*ye.s:ye.s||NaN}function C2(ye){return new this(ye).sin()}function k2(ye){return new this(ye).sinh()}function D2(ye){return new this(ye).sqrt()}function L2(ye,ge){return new this(ye).sub(ge)}function P2(){var ye=0,ge=arguments,t=new this(ge[ye]);for(xi=!1;t.s&&++ye<ge.length;)t=t.plus(ge[ye]);return xi=!0,hi(t,this.precision,this.rounding)}function F2(ye){return new this(ye).tan()}function R2(ye){return new this(ye).tanh()}function I2(ye){return hi(ye=new this(ye),ye.e+1,1)}ca[Symbol.for("nodejs.util.inspect.custom")]=ca.toString;ca[Symbol.toStringTag]="Decimal";var oh=ca.constructor=zg(Bp);Sv=new oh(Sv);Ev=new oh(Ev);var z2="BigNumber",B2=["?on","config"],N2=Wa(z2,B2,ye=>{var{on:ge,config:t}=ye,P=oh.clone({precision:t.precision,modulo:oh.EUCLID});return P.prototype=Object.create(P.prototype),P.prototype.type="BigNumber",P.prototype.isBigNumber=!0,P.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},P.fromJSON=function(R){return new P(R.value)},ge&&ge("config",function(R,h){R.precision!==h.precision&&P.config({precision:R.precision})}),P},{isClass:!0}),Bo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jp(ye){return ye&&ye.__esModule&&Object.prototype.hasOwnProperty.call(ye,"default")?ye.default:ye}var Bg={exports:{}};/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(ye,ge){(function(t){var P=Math.cosh||function(n){return Math.abs(n)<1e-9?1-n:(Math.exp(n)+Math.exp(-n))*.5},R=Math.sinh||function(n){return Math.abs(n)<1e-9?n:(Math.exp(n)-Math.exp(-n))*.5},h=function(n){var a=Math.PI/4;if(-a>n||n>a)return Math.cos(n)-1;var r=n*n;return r*(r*(r*(r*(r*(r*(r*(r/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},u=function(n,a){var r=Math.abs(n),f=Math.abs(a);return r<3e3&&f<3e3?Math.sqrt(r*r+f*f):(r<f?(r=f,f=n/a):f=a/n,r*Math.sqrt(1+f*f))},A=function(){throw SyntaxError("Invalid Param")};function T(n,a){var r=Math.abs(n),f=Math.abs(a);return n===0?Math.log(f):a===0?Math.log(r):r<3e3&&f<3e3?Math.log(n*n+a*a)*.5:(n=n/2,a=a/2,.5*Math.log(n*n+a*a)+Math.LN2)}var e=function(n,a){var r={re:0,im:0};if(n==null)r.re=r.im=0;else if(a!==void 0)r.re=n,r.im=a;else switch(typeof n){case"object":if("im"in n&&"re"in n)r.re=n.re,r.im=n.im;else if("abs"in n&&"arg"in n){if(!Number.isFinite(n.abs)&&Number.isFinite(n.arg))return i.INFINITY;r.re=n.abs*Math.cos(n.arg),r.im=n.abs*Math.sin(n.arg)}else if("r"in n&&"phi"in n){if(!Number.isFinite(n.r)&&Number.isFinite(n.phi))return i.INFINITY;r.re=n.r*Math.cos(n.phi),r.im=n.r*Math.sin(n.phi)}else n.length===2?(r.re=n[0],r.im=n[1]):A();break;case"string":r.im=r.re=0;var f=n.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),o=1,s=0;f===null&&A();for(var m=0;m<f.length;m++){var g=f[m];g===" "||g==="	"||g===`
`||(g==="+"?o++:g==="-"?s++:g==="i"||g==="I"?(o+s===0&&A(),f[m+1]!==" "&&!isNaN(f[m+1])?(r.im+=parseFloat((s%2?"-":"")+f[m+1]),m++):r.im+=parseFloat((s%2?"-":"")+"1"),o=s=0):((o+s===0||isNaN(g))&&A(),f[m+1]==="i"||f[m+1]==="I"?(r.im+=parseFloat((s%2?"-":"")+g),m++):r.re+=parseFloat((s%2?"-":"")+g),o=s=0))}o+s>0&&A();break;case"number":r.im=0,r.re=n;break;default:A()}return isNaN(r.re)||isNaN(r.im),r};function i(n,a){if(!(this instanceof i))return new i(n,a);var r=e(n,a);this.re=r.re,this.im=r.im}i.prototype={re:0,im:0,sign:function(){var n=this.abs();return new i(this.re/n,this.im/n)},add:function(n,a){var r=new i(n,a);return this.isInfinite()&&r.isInfinite()?i.NAN:this.isInfinite()||r.isInfinite()?i.INFINITY:new i(this.re+r.re,this.im+r.im)},sub:function(n,a){var r=new i(n,a);return this.isInfinite()&&r.isInfinite()?i.NAN:this.isInfinite()||r.isInfinite()?i.INFINITY:new i(this.re-r.re,this.im-r.im)},mul:function(n,a){var r=new i(n,a);return this.isInfinite()&&r.isZero()||this.isZero()&&r.isInfinite()?i.NAN:this.isInfinite()||r.isInfinite()?i.INFINITY:r.im===0&&this.im===0?new i(this.re*r.re,0):new i(this.re*r.re-this.im*r.im,this.re*r.im+this.im*r.re)},div:function(n,a){var r=new i(n,a);if(this.isZero()&&r.isZero()||this.isInfinite()&&r.isInfinite())return i.NAN;if(this.isInfinite()||r.isZero())return i.INFINITY;if(this.isZero()||r.isInfinite())return i.ZERO;n=this.re,a=this.im;var f=r.re,o=r.im,s,m;return o===0?new i(n/f,a/f):Math.abs(f)<Math.abs(o)?(m=f/o,s=f*m+o,new i((n*m+a)/s,(a*m-n)/s)):(m=o/f,s=o*m+f,new i((n+a*m)/s,(a-n*m)/s))},pow:function(n,a){var r=new i(n,a);if(n=this.re,a=this.im,r.isZero())return i.ONE;if(r.im===0){if(a===0&&n>0)return new i(Math.pow(n,r.re),0);if(n===0)switch((r.re%4+4)%4){case 0:return new i(Math.pow(a,r.re),0);case 1:return new i(0,Math.pow(a,r.re));case 2:return new i(-Math.pow(a,r.re),0);case 3:return new i(0,-Math.pow(a,r.re))}}if(n===0&&a===0&&r.re>0&&r.im>=0)return i.ZERO;var f=Math.atan2(a,n),o=T(n,a);return n=Math.exp(r.re*o-r.im*f),a=r.im*o+r.re*f,new i(n*Math.cos(a),n*Math.sin(a))},sqrt:function(){var n=this.re,a=this.im,r=this.abs(),f,o;if(n>=0){if(a===0)return new i(Math.sqrt(n),0);f=.5*Math.sqrt(2*(r+n))}else f=Math.abs(a)/Math.sqrt(2*(r-n));return n<=0?o=.5*Math.sqrt(2*(r-n)):o=Math.abs(a)/Math.sqrt(2*(r+n)),new i(f,a<0?-o:o)},exp:function(){var n=Math.exp(this.re);return this.im,new i(n*Math.cos(this.im),n*Math.sin(this.im))},expm1:function(){var n=this.re,a=this.im;return new i(Math.expm1(n)*Math.cos(a)+h(a),Math.exp(n)*Math.sin(a))},log:function(){var n=this.re,a=this.im;return new i(T(n,a),Math.atan2(a,n))},abs:function(){return u(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var n=this.re,a=this.im;return new i(Math.sin(n)*P(a),Math.cos(n)*R(a))},cos:function(){var n=this.re,a=this.im;return new i(Math.cos(n)*P(a),-Math.sin(n)*R(a))},tan:function(){var n=2*this.re,a=2*this.im,r=Math.cos(n)+P(a);return new i(Math.sin(n)/r,R(a)/r)},cot:function(){var n=2*this.re,a=2*this.im,r=Math.cos(n)-P(a);return new i(-Math.sin(n)/r,R(a)/r)},sec:function(){var n=this.re,a=this.im,r=.5*P(2*a)+.5*Math.cos(2*n);return new i(Math.cos(n)*P(a)/r,Math.sin(n)*R(a)/r)},csc:function(){var n=this.re,a=this.im,r=.5*P(2*a)-.5*Math.cos(2*n);return new i(Math.sin(n)*P(a)/r,-Math.cos(n)*R(a)/r)},asin:function(){var n=this.re,a=this.im,r=new i(a*a-n*n+1,-2*n*a).sqrt(),f=new i(r.re-a,r.im+n).log();return new i(f.im,-f.re)},acos:function(){var n=this.re,a=this.im,r=new i(a*a-n*n+1,-2*n*a).sqrt(),f=new i(r.re-a,r.im+n).log();return new i(Math.PI/2-f.im,f.re)},atan:function(){var n=this.re,a=this.im;if(n===0){if(a===1)return new i(0,1/0);if(a===-1)return new i(0,-1/0)}var r=n*n+(1-a)*(1-a),f=new i((1-a*a-n*n)/r,-2*n/r).log();return new i(-.5*f.im,.5*f.re)},acot:function(){var n=this.re,a=this.im;if(a===0)return new i(Math.atan2(1,n),0);var r=n*n+a*a;return r!==0?new i(n/r,-a/r).atan():new i(n!==0?n/0:0,a!==0?-a/0:0).atan()},asec:function(){var n=this.re,a=this.im;if(n===0&&a===0)return new i(0,1/0);var r=n*n+a*a;return r!==0?new i(n/r,-a/r).acos():new i(n!==0?n/0:0,a!==0?-a/0:0).acos()},acsc:function(){var n=this.re,a=this.im;if(n===0&&a===0)return new i(Math.PI/2,1/0);var r=n*n+a*a;return r!==0?new i(n/r,-a/r).asin():new i(n!==0?n/0:0,a!==0?-a/0:0).asin()},sinh:function(){var n=this.re,a=this.im;return new i(R(n)*Math.cos(a),P(n)*Math.sin(a))},cosh:function(){var n=this.re,a=this.im;return new i(P(n)*Math.cos(a),R(n)*Math.sin(a))},tanh:function(){var n=2*this.re,a=2*this.im,r=P(n)+Math.cos(a);return new i(R(n)/r,Math.sin(a)/r)},coth:function(){var n=2*this.re,a=2*this.im,r=P(n)-Math.cos(a);return new i(R(n)/r,-Math.sin(a)/r)},csch:function(){var n=this.re,a=this.im,r=Math.cos(2*a)-P(2*n);return new i(-2*R(n)*Math.cos(a)/r,2*P(n)*Math.sin(a)/r)},sech:function(){var n=this.re,a=this.im,r=Math.cos(2*a)+P(2*n);return new i(2*P(n)*Math.cos(a)/r,-2*R(n)*Math.sin(a)/r)},asinh:function(){var n=this.im;this.im=-this.re,this.re=n;var a=this.asin();return this.re=-this.im,this.im=n,n=a.re,a.re=-a.im,a.im=n,a},acosh:function(){var n=this.acos();if(n.im<=0){var a=n.re;n.re=-n.im,n.im=a}else{var a=n.im;n.im=-n.re,n.re=a}return n},atanh:function(){var n=this.re,a=this.im,r=n>1&&a===0,f=1-n,o=1+n,s=f*f+a*a,m=s!==0?new i((o*f-a*a)/s,(a*f+o*a)/s):new i(n!==-1?n/0:0,a!==0?a/0:0),g=m.re;return m.re=T(m.re,m.im)/2,m.im=Math.atan2(m.im,g)/2,r&&(m.im=-m.im),m},acoth:function(){var n=this.re,a=this.im;if(n===0&&a===0)return new i(0,Math.PI/2);var r=n*n+a*a;return r!==0?new i(n/r,-a/r).atanh():new i(n!==0?n/0:0,a!==0?-a/0:0).atanh()},acsch:function(){var n=this.re,a=this.im;if(a===0)return new i(n!==0?Math.log(n+Math.sqrt(n*n+1)):1/0,0);var r=n*n+a*a;return r!==0?new i(n/r,-a/r).asinh():new i(n!==0?n/0:0,a!==0?-a/0:0).asinh()},asech:function(){var n=this.re,a=this.im;if(this.isZero())return i.INFINITY;var r=n*n+a*a;return r!==0?new i(n/r,-a/r).acosh():new i(n!==0?n/0:0,a!==0?-a/0:0).acosh()},inverse:function(){if(this.isZero())return i.INFINITY;if(this.isInfinite())return i.ZERO;var n=this.re,a=this.im,r=n*n+a*a;return new i(n/r,-a/r)},conjugate:function(){return new i(this.re,-this.im)},neg:function(){return new i(-this.re,-this.im)},ceil:function(n){return n=Math.pow(10,n||0),new i(Math.ceil(this.re*n)/n,Math.ceil(this.im*n)/n)},floor:function(n){return n=Math.pow(10,n||0),new i(Math.floor(this.re*n)/n,Math.floor(this.im*n)/n)},round:function(n){return n=Math.pow(10,n||0),new i(Math.round(this.re*n)/n,Math.round(this.im*n)/n)},equals:function(n,a){var r=new i(n,a);return Math.abs(r.re-this.re)<=i.EPSILON&&Math.abs(r.im-this.im)<=i.EPSILON},clone:function(){return new i(this.re,this.im)},toString:function(){var n=this.re,a=this.im,r="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(n)<i.EPSILON&&(n=0),Math.abs(a)<i.EPSILON&&(a=0),a===0?r+n:(n!==0?(r+=n,r+=" ",a<0?(a=-a,r+="-"):r+="+",r+=" "):a<0&&(a=-a,r+="-"),a!==1&&(r+=a),r+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},i.ZERO=new i(0,0),i.ONE=new i(1,0),i.I=new i(0,1),i.PI=new i(Math.PI,0),i.E=new i(Math.E,0),i.INFINITY=new i(1/0,1/0),i.NAN=new i(NaN,NaN),i.EPSILON=1e-15,Object.defineProperty(i,"__esModule",{value:!0}),i.default=i,i.Complex=i,ye.exports=i})()})(Bg);const ll=jp(Bg.exports);var O2="Complex",U2=[],V2=Wa(O2,U2,()=>(Object.defineProperty(ll,"name",{value:"Complex"}),ll.prototype.constructor=ll,ll.prototype.type="Complex",ll.prototype.isComplex=!0,ll.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},ll.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},ll.prototype.format=function(ye){var ge="",t=this.im,P=this.re,R=Fp(this.re,ye),h=Fp(this.im,ye),u=as(ye)?ye:ye?ye.precision:null;if(u!==null){var A=Math.pow(10,-u);Math.abs(P/t)<A&&(P=0),Math.abs(t/P)<A&&(t=0)}return t===0?ge=R:P===0?t===1?ge="i":t===-1?ge="-i":ge=h+"i":t<0?t===-1?ge=R+" - i":ge=R+" - "+h.substring(1)+"i":t===1?ge=R+" + i":ge=R+" + "+h+"i",ge},ll.fromPolar=function(ye){switch(arguments.length){case 1:{var ge=arguments[0];if(typeof ge=="object")return ll(ge);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var t=arguments[0],P=arguments[1];if(as(t)){if(hg(P)&&P.hasBase("ANGLE")&&(P=P.toNumber("rad")),as(P))return new ll({r:t,phi:P});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},ll.prototype.valueOf=ll.prototype.toString,ll.fromJSON=function(ye){return new ll(ye)},ll.compare=function(ye,ge){return ye.re>ge.re?1:ye.re<ge.re?-1:ye.im>ge.im?1:ye.im<ge.im?-1:0},ll),{isClass:!0}),Ng={exports:{}};/**
 * @license Fraction.js v4.2.0 05/03/2022
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2021, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(ye,ge){(function(t){var P=2e3,R={s:1,n:0,d:1};function h(f,o){if(isNaN(f=parseInt(f,10)))throw r.InvalidParameter;return f*o}function u(f,o){if(o===0)throw r.DivisionByZero;var s=Object.create(r.prototype);s.s=f<0?-1:1,f=f<0?-f:f;var m=a(f,o);return s.n=f/m,s.d=o/m,s}function A(f){for(var o={},s=f,m=2,g=4;g<=s;){for(;s%m===0;)s/=m,o[m]=(o[m]||0)+1;g+=1+2*m++}return s!==f?s>1&&(o[s]=(o[s]||0)+1):o[f]=(o[f]||0)+1,o}var T=function(f,o){var s=0,m=1,g=1,p=0,v=0,x=0,l=1,b=1,c=0,M=1,_=1,y=1,w=1e7,d;if(f!=null)if(o!==void 0){if(s=f,m=o,g=s*m,s%1!==0||m%1!==0)throw r.NonIntegerParameter}else switch(typeof f){case"object":{if("d"in f&&"n"in f)s=f.n,m=f.d,"s"in f&&(s*=f.s);else if(0 in f)s=f[0],1 in f&&(m=f[1]);else throw r.InvalidParameter;g=s*m;break}case"number":{if(f<0&&(g=f,f=-f),f%1===0)s=f;else if(f>0){for(f>=1&&(b=Math.pow(10,Math.floor(1+Math.log(f)/Math.LN10)),f/=b);M<=w&&y<=w;)if(d=(c+_)/(M+y),f===d){M+y<=w?(s=c+_,m=M+y):y>M?(s=_,m=y):(s=c,m=M);break}else f>d?(c+=_,M+=y):(_+=c,y+=M),M>w?(s=_,m=y):(s=c,m=M);s*=b}else(isNaN(f)||isNaN(o))&&(m=s=NaN);break}case"string":{if(M=f.match(/\d+|./g),M===null)throw r.InvalidParameter;if(M[c]==="-"?(g=-1,c++):M[c]==="+"&&c++,M.length===c+1?v=h(M[c++],g):M[c+1]==="."||M[c]==="."?(M[c]!=="."&&(p=h(M[c++],g)),c++,(c+1===M.length||M[c+1]==="("&&M[c+3]===")"||M[c+1]==="'"&&M[c+3]==="'")&&(v=h(M[c],g),l=Math.pow(10,M[c].length),c++),(M[c]==="("&&M[c+2]===")"||M[c]==="'"&&M[c+2]==="'")&&(x=h(M[c+1],g),b=Math.pow(10,M[c+1].length)-1,c+=3)):M[c+1]==="/"||M[c+1]===":"?(v=h(M[c],g),l=h(M[c+2],1),c+=3):M[c+3]==="/"&&M[c+1]===" "&&(p=h(M[c],g),v=h(M[c+2],g),l=h(M[c+4],1),c+=5),M.length<=c){m=l*b,g=s=x+m*p+b*v;break}}default:throw r.InvalidParameter}if(m===0)throw r.DivisionByZero;R.s=g<0?-1:1,R.n=Math.abs(s),R.d=Math.abs(m)};function e(f,o,s){for(var m=1;o>0;f=f*f%s,o>>=1)o&1&&(m=m*f%s);return m}function i(f,o){for(;o%2===0;o/=2);for(;o%5===0;o/=5);if(o===1)return 0;for(var s=10%o,m=1;s!==1;m++)if(s=s*10%o,m>P)return 0;return m}function n(f,o,s){for(var m=1,g=e(10,s,o),p=0;p<300;p++){if(m===g)return p;m=m*10%o,g=g*10%o}return 0}function a(f,o){if(!f)return o;if(!o)return f;for(;;){if(f%=o,!f)return o;if(o%=f,!o)return f}}function r(f,o){if(T(f,o),this instanceof r)f=a(R.d,R.n),this.s=R.s,this.n=R.n/f,this.d=R.d/f;else return u(R.s*R.n,R.d)}r.DivisionByZero=new Error("Division by Zero"),r.InvalidParameter=new Error("Invalid argument"),r.NonIntegerParameter=new Error("Parameters must be integer"),r.prototype={s:1,n:0,d:1,abs:function(){return u(this.n,this.d)},neg:function(){return u(-this.s*this.n,this.d)},add:function(f,o){return T(f,o),u(this.s*this.n*R.d+R.s*this.d*R.n,this.d*R.d)},sub:function(f,o){return T(f,o),u(this.s*this.n*R.d-R.s*this.d*R.n,this.d*R.d)},mul:function(f,o){return T(f,o),u(this.s*R.s*this.n*R.n,this.d*R.d)},div:function(f,o){return T(f,o),u(this.s*R.s*this.n*R.d,this.d*R.n)},clone:function(){return u(this.s*this.n,this.d)},mod:function(f,o){if(isNaN(this.n)||isNaN(this.d))return new r(NaN);if(f===void 0)return u(this.s*this.n%this.d,1);if(T(f,o),R.n===0&&this.d===0)throw r.DivisionByZero;return u(this.s*(R.d*this.n)%(R.n*this.d),R.d*this.d)},gcd:function(f,o){return T(f,o),u(a(R.n,this.n)*a(R.d,this.d),R.d*this.d)},lcm:function(f,o){return T(f,o),R.n===0&&this.n===0?u(0,1):u(R.n*this.n,a(R.n,this.n)*a(R.d,this.d))},ceil:function(f){return f=Math.pow(10,f||0),isNaN(this.n)||isNaN(this.d)?new r(NaN):u(Math.ceil(f*this.s*this.n/this.d),f)},floor:function(f){return f=Math.pow(10,f||0),isNaN(this.n)||isNaN(this.d)?new r(NaN):u(Math.floor(f*this.s*this.n/this.d),f)},round:function(f){return f=Math.pow(10,f||0),isNaN(this.n)||isNaN(this.d)?new r(NaN):u(Math.round(f*this.s*this.n/this.d),f)},inverse:function(){return u(this.s*this.d,this.n)},pow:function(f,o){if(T(f,o),R.d===1)return R.s<0?u(Math.pow(this.s*this.d,R.n),Math.pow(this.n,R.n)):u(Math.pow(this.s*this.n,R.n),Math.pow(this.d,R.n));if(this.s<0)return null;var s=A(this.n),m=A(this.d),g=1,p=1;for(var v in s)if(v!=="1"){if(v==="0"){g=0;break}if(s[v]*=R.n,s[v]%R.d===0)s[v]/=R.d;else return null;g*=Math.pow(v,s[v])}for(var v in m)if(v!=="1"){if(m[v]*=R.n,m[v]%R.d===0)m[v]/=R.d;else return null;p*=Math.pow(v,m[v])}return R.s<0?u(p,g):u(g,p)},equals:function(f,o){return T(f,o),this.s*this.n*R.d===R.s*R.n*this.d},compare:function(f,o){T(f,o);var s=this.s*this.n*R.d-R.s*R.n*this.d;return(0<s)-(s<0)},simplify:function(f){if(isNaN(this.n)||isNaN(this.d))return this;f=f||.001;for(var o=this.abs(),s=o.toContinued(),m=1;m<s.length;m++){for(var g=u(s[m-1],1),p=m-2;p>=0;p--)g=g.inverse().add(s[p]);if(g.sub(o).abs().valueOf()<f)return g.mul(this.s)}return this},divisible:function(f,o){return T(f,o),!(!(R.n*this.d)||this.n*R.d%(R.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(f){var o,s="",m=this.n,g=this.d;return this.s<0&&(s+="-"),g===1?s+=m:(f&&(o=Math.floor(m/g))>0&&(s+=o,s+=" ",m%=g),s+=m,s+="/",s+=g),s},toLatex:function(f){var o,s="",m=this.n,g=this.d;return this.s<0&&(s+="-"),g===1?s+=m:(f&&(o=Math.floor(m/g))>0&&(s+=o,m%=g),s+="\\frac{",s+=m,s+="}{",s+=g,s+="}"),s},toContinued:function(){var f,o=this.n,s=this.d,m=[];if(isNaN(o)||isNaN(s))return m;do m.push(Math.floor(o/s)),f=o%s,o=s,s=f;while(o!==1);return m},toString:function(f){var o=this.n,s=this.d;if(isNaN(o)||isNaN(s))return"NaN";f=f||15;var m=i(o,s),g=n(o,s,m),p=this.s<0?"-":"";if(p+=o/s|0,o%=s,o*=10,o&&(p+="."),m){for(var v=g;v--;)p+=o/s|0,o%=s,o*=10;p+="(";for(var v=m;v--;)p+=o/s|0,o%=s,o*=10;p+=")"}else for(var v=f;o&&v--;)p+=o/s|0,o%=s,o*=10;return p}},Object.defineProperty(r,"__esModule",{value:!0}),r.default=r,r.Fraction=r,ye.exports=r})()})(Ng);const Nf=jp(Ng.exports);var H2="Fraction",G2=[],Y2=Wa(H2,G2,()=>(Object.defineProperty(Nf,"name",{value:"Fraction"}),Nf.prototype.constructor=Nf,Nf.prototype.type="Fraction",Nf.prototype.isFraction=!0,Nf.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},Nf.fromJSON=function(ye){return new Nf(ye)},Nf),{isClass:!0}),W2="Matrix",X2=[],Z2=Wa(W2,X2,()=>{function ye(){if(!(this instanceof ye))throw new SyntaxError("Constructor must be called with the new operator")}return ye.prototype.type="Matrix",ye.prototype.isMatrix=!0,ye.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},ye.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},ye.prototype.create=function(ge,t){throw new Error("Cannot invoke create on a Matrix interface")},ye.prototype.subset=function(ge,t,P){throw new Error("Cannot invoke subset on a Matrix interface")},ye.prototype.get=function(ge){throw new Error("Cannot invoke get on a Matrix interface")},ye.prototype.set=function(ge,t,P){throw new Error("Cannot invoke set on a Matrix interface")},ye.prototype.resize=function(ge,t){throw new Error("Cannot invoke resize on a Matrix interface")},ye.prototype.reshape=function(ge,t){throw new Error("Cannot invoke reshape on a Matrix interface")},ye.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},ye.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},ye.prototype.map=function(ge,t){throw new Error("Cannot invoke map on a Matrix interface")},ye.prototype.forEach=function(ge){throw new Error("Cannot invoke forEach on a Matrix interface")},ye.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},ye.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},ye.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},ye.prototype.format=function(ge){throw new Error("Cannot invoke format on a Matrix interface")},ye.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},ye},{isClass:!0});function Og(ye){return Object.keys(ye.signatures||{}).reduce(function(ge,t){var P=(t.match(/,/g)||[]).length+1;return Math.max(ge,P)},-1)}var j2="DenseMatrix",J2=["Matrix"],K2=Wa(j2,J2,ye=>{var{Matrix:ge}=ye;function t(i,n){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(n&&!af(n))throw new Error("Invalid datatype: "+n);if(is(i))i.type==="DenseMatrix"?(this._data=yo(i._data),this._size=yo(i._size),this._datatype=n||i._datatype):(this._data=i.toArray(),this._size=i.size(),this._datatype=n||i._datatype);else if(i&&Po(i.data)&&Po(i.size))this._data=i.data,this._size=i.size,A0(this._data,this._size),this._datatype=n||i.datatype;else if(Po(i))this._data=e(i),this._size=Nl(this._data),A0(this._data,this._size),this._datatype=n;else{if(i)throw new TypeError("Unsupported type of data ("+ac(i)+")");this._data=[],this._size=[0],this._datatype=n}}t.prototype=new ge,t.prototype.createDenseMatrix=function(i,n){return new t(i,n)},Object.defineProperty(t,"name",{value:"DenseMatrix"}),t.prototype.constructor=t,t.prototype.type="DenseMatrix",t.prototype.isDenseMatrix=!0,t.prototype.getDataType=function(){return Mv(this._data,ac)},t.prototype.storage=function(){return"dense"},t.prototype.datatype=function(){return this._datatype},t.prototype.create=function(i,n){return new t(i,n)},t.prototype.subset=function(i,n,a){switch(arguments.length){case 1:return P(this,i);case 2:case 3:return h(this,i,n,a);default:throw new SyntaxError("Wrong number of arguments")}},t.prototype.get=function(i){if(!Po(i))throw new TypeError("Array expected");if(i.length!==this._size.length)throw new Ao(i.length,this._size.length);for(var n=0;n<i.length;n++)Zo(i[n],this._size[n]);for(var a=this._data,r=0,f=i.length;r<f;r++){var o=i[r];Zo(o,a.length),a=a[o]}return a},t.prototype.set=function(i,n,a){if(!Po(i))throw new TypeError("Array expected");if(i.length<this._size.length)throw new Ao(i.length,this._size.length,"<");var r,f,o,s=i.map(function(g){return g+1});T(this,s,a);var m=this._data;for(r=0,f=i.length-1;r<f;r++)o=i[r],Zo(o,m.length),m=m[o];return o=i[i.length-1],Zo(o,m.length),m[o]=n,this};function P(i,n){if(!Wp(n))throw new TypeError("Invalid index");var a=n.isScalar();if(a)return i.get(n.min());var r=n.size();if(r.length!==i._size.length)throw new Ao(r.length,i._size.length);for(var f=n.min(),o=n.max(),s=0,m=i._size.length;s<m;s++)Zo(f[s],i._size[s]),Zo(o[s],i._size[s]);return new t(R(i._data,n,r.length,0),i._datatype)}function R(i,n,a,r){var f=r===a-1,o=n.dimension(r);return f?o.map(function(s){return Zo(s,i.length),i[s]}).valueOf():o.map(function(s){Zo(s,i.length);var m=i[s];return R(m,n,a,r+1)}).valueOf()}function h(i,n,a,r){if(!n||n.isIndex!==!0)throw new TypeError("Invalid index");var f=n.size(),o=n.isScalar(),s;if(is(a)?(s=a.size(),a=a.valueOf()):s=Nl(a),o){if(s.length!==0)throw new TypeError("Scalar expected");i.set(n.min(),a,r)}else{if(f.length<i._size.length)throw new Ao(f.length,i._size.length,"<");if(s.length<f.length){for(var m=0,g=0;f[m]===1&&s[m]===1;)m++;for(;f[m]===1;)g++,m++;a=_g(a,f.length,g,s)}if(!Tv(f,s))throw new Ao(f,s,">");var p=n.max().map(function(l){return l+1});T(i,p,r);var v=f.length,x=0;u(i._data,n,a,v,x)}return i}function u(i,n,a,r,f){var o=f===r-1,s=n.dimension(f);o?s.forEach(function(m,g){Zo(m),i[m]=a[g[0]]}):s.forEach(function(m,g){Zo(m),u(i[m],n,a[g[0]],r,f+1)})}t.prototype.resize=function(i,n,a){if(!wv(i))throw new TypeError("Array or Matrix expected");var r=i.valueOf().map(o=>Array.isArray(o)&&o.length===1?o[0]:o),f=a?this.clone():this;return A(f,r,n)};function A(i,n,a){if(n.length===0){for(var r=i._data;Po(r);)r=r[0];return r}return i._size=n.slice(0),i._data=Av(i._data,i._size,a),i}t.prototype.reshape=function(i,n){var a=n?this.clone():this;a._data=Eb(a._data,i);var r=a._size.reduce((f,o)=>f*o);return a._size=Xp(i,r),a};function T(i,n,a){for(var r=i._size.slice(0),f=!1;r.length<n.length;)r.push(0),f=!0;for(var o=0,s=n.length;o<s;o++)n[o]>r[o]&&(r[o]=n[o],f=!0);f&&A(i,r,a)}t.prototype.clone=function(){var i=new t({data:yo(this._data),size:yo(this._size),datatype:this._datatype});return i},t.prototype.size=function(){return this._size.slice(0)},t.prototype.map=function(i){var n=this,a=Og(i),r=function s(m,g){return Po(m)?m.map(function(p,v){return s(p,g.concat(v))}):a===1?i(m):a===2?i(m,g):i(m,g,n)},f=r(this._data,[]),o=this._datatype!==void 0?Mv(f,ac):void 0;return new t(f,o)},t.prototype.forEach=function(i){var n=this,a=function r(f,o){Po(f)?f.forEach(function(s,m){r(s,o.concat(m))}):i(f,o,n)};a(this._data,[])},t.prototype[Symbol.iterator]=function*(){var i=function*n(a,r){if(Po(a))for(var f=0;f<a.length;f++)yield*n(a[f],r.concat(f));else yield{value:a,index:r}};yield*i(this._data,[])},t.prototype.rows=function(){var i=[],n=this.size();if(n.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");var a=this._data;for(var r of a)i.push(new t([r],this._datatype));return i},t.prototype.columns=function(){var i=this,n=[],a=this.size();if(a.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var r=this._data,f=function(m){var g=r.map(p=>[p[m]]);n.push(new t(g,i._datatype))},o=0;o<a[1];o++)f(o);return n},t.prototype.toArray=function(){return yo(this._data)},t.prototype.valueOf=function(){return this._data},t.prototype.format=function(i){return ns(this._data,i)},t.prototype.toString=function(){return ns(this._data)},t.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},t.prototype.diagonal=function(i){if(i){if(ul(i)&&(i=i.toNumber()),!as(i)||!cs(i))throw new TypeError("The parameter k must be an integer number")}else i=0;for(var n=i>0?i:0,a=i<0?-i:0,r=this._size[0],f=this._size[1],o=Math.min(r-a,f-n),s=[],m=0;m<o;m++)s[m]=this._data[m+a][m+n];return new t({data:s,size:[o],datatype:this._datatype})},t.diagonal=function(i,n,a,r){if(!Po(i))throw new TypeError("Array expected, size parameter");if(i.length!==2)throw new Error("Only two dimensions matrix are supported");if(i=i.map(function(b){if(ul(b)&&(b=b.toNumber()),!as(b)||!cs(b)||b<1)throw new Error("Size values must be positive integers");return b}),a){if(ul(a)&&(a=a.toNumber()),!as(a)||!cs(a))throw new TypeError("The parameter k must be an integer number")}else a=0;var f=a>0?a:0,o=a<0?-a:0,s=i[0],m=i[1],g=Math.min(s-o,m-f),p;if(Po(n)){if(n.length!==g)throw new Error("Invalid value array length");p=function(c){return n[c]}}else if(is(n)){var v=n.size();if(v.length!==1||v[0]!==g)throw new Error("Invalid matrix length");p=function(c){return n.get([c])}}else p=function(){return n};r||(r=ul(p(0))?p(0).mul(0):0);var x=[];if(i.length>0){x=Av(x,i,r);for(var l=0;l<g;l++)x[l+o][l+f]=p(l)}return new t({data:x,size:[s,m]})},t.fromJSON=function(i){return new t(i)},t.prototype.swapRows=function(i,n){if(!as(i)||!cs(i)||!as(n)||!cs(n))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return Zo(i,this._size[0]),Zo(n,this._size[0]),t._swapRows(i,n,this._data),this},t._swapRows=function(i,n,a){var r=a[i];a[i]=a[n],a[n]=r};function e(i){for(var n=0,a=i.length;n<a;n++){var r=i[n];Po(r)?i[n]=e(r):r&&r.isMatrix===!0&&(i[n]=e(r.valueOf()))}return i}return t},{isClass:!0});function Fu(ye,ge,t){return ye&&typeof ye.map=="function"?ye.map(function(P){return Fu(P,ge)}):ge(ye)}var Jp="number",Ug="number, number";function Vg(ye){return Math.abs(ye)}Vg.signature=Jp;function Hg(ye,ge){return ye+ge}Hg.signature=Ug;function Gg(ye,ge){return ye*ge}Gg.signature=Ug;function Yg(ye){return-ye}Yg.signature=Jp;function Vp(ye){return gb(ye)}Vp.signature=Jp;var Q2="number";function Wg(ye){return ye===0}Wg.signature=Q2;var C0="isZero",$2=["typed"],q2=Wa(C0,$2,ye=>{var{typed:ge}=ye;return ge(C0,{number:Wg,BigNumber:function(P){return P.isZero()},Complex:function(P){return P.re===0&&P.im===0},Fraction:function(P){return P.d===1&&P.n===0},Unit:ge.referToSelf(t=>P=>ge.find(t,P.valueType())(P.value)),"Array | Matrix":ge.referToSelf(t=>P=>Fu(P,t))})});function Bh(ye,ge,t){if(t==null)return ye.eq(ge);if(ye.eq(ge))return!0;if(ye.isNaN()||ge.isNaN())return!1;if(ye.isFinite()&&ge.isFinite()){var P=ye.minus(ge).abs();if(P.isZero())return!0;var R=ye.constructor.max(ye.abs(),ge.abs());return P.lte(R.times(t))}return!1}function e_(ye,ge,t){return ic(ye.re,ge.re,t)&&ic(ye.im,ge.im,t)}var Nh=Wa("compareUnits",["typed"],ye=>{var{typed:ge}=ye;return{"Unit, Unit":ge.referToSelf(t=>(P,R)=>{if(!P.equalBase(R))throw new Error("Cannot compare units with different base");return ge.find(t,[P.valueType(),R.valueType()])(P.value,R.value)})}}),kv="equalScalar",t_=["typed","config"],r_=Wa(kv,t_,ye=>{var{typed:ge,config:t}=ye,P=Nh({typed:ge});return ge(kv,{"boolean, boolean":function(h,u){return h===u},"number, number":function(h,u){return ic(h,u,t.epsilon)},"BigNumber, BigNumber":function(h,u){return h.eq(u)||Bh(h,u,t.epsilon)},"Fraction, Fraction":function(h,u){return h.equals(u)},"Complex, Complex":function(h,u){return e_(h,u,t.epsilon)}},P)});Wa(kv,["typed","config"],ye=>{var{typed:ge,config:t}=ye;return ge(kv,{"number, number":function(R,h){return ic(R,h,t.epsilon)}})});var n_="SparseMatrix",a_=["typed","equalScalar","Matrix"],i_=Wa(n_,a_,ye=>{var{typed:ge,equalScalar:t,Matrix:P}=ye;function R(o,s){if(!(this instanceof R))throw new SyntaxError("Constructor must be called with the new operator");if(s&&!af(s))throw new Error("Invalid datatype: "+s);if(is(o))h(this,o,s);else if(o&&Po(o.index)&&Po(o.ptr)&&Po(o.size))this._values=o.values,this._index=o.index,this._ptr=o.ptr,this._size=o.size,this._datatype=s||o.datatype;else if(Po(o))u(this,o,s);else{if(o)throw new TypeError("Unsupported type of data ("+ac(o)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=s}}function h(o,s,m){s.type==="SparseMatrix"?(o._values=s._values?yo(s._values):void 0,o._index=yo(s._index),o._ptr=yo(s._ptr),o._size=yo(s._size),o._datatype=m||s._datatype):u(o,s.valueOf(),m||s._datatype)}function u(o,s,m){o._values=[],o._index=[],o._ptr=[],o._datatype=m;var g=s.length,p=0,v=t,x=0;if(af(m)&&(v=ge.find(t,[m,m])||t,x=ge.convert(0,m)),g>0){var l=0;do{o._ptr.push(o._index.length);for(var b=0;b<g;b++){var c=s[b];if(Po(c)){if(l===0&&p<c.length&&(p=c.length),l<c.length){var M=c[l];v(M,x)||(o._values.push(M),o._index.push(b))}}else l===0&&p<1&&(p=1),v(c,x)||(o._values.push(c),o._index.push(b))}l++}while(l<p)}o._ptr.push(o._index.length),o._size=[g,p]}R.prototype=new P,R.prototype.createSparseMatrix=function(o,s){return new R(o,s)},Object.defineProperty(R,"name",{value:"SparseMatrix"}),R.prototype.constructor=R,R.prototype.type="SparseMatrix",R.prototype.isSparseMatrix=!0,R.prototype.getDataType=function(){return Mv(this._values,ac)},R.prototype.storage=function(){return"sparse"},R.prototype.datatype=function(){return this._datatype},R.prototype.create=function(o,s){return new R(o,s)},R.prototype.density=function(){var o=this._size[0],s=this._size[1];return o!==0&&s!==0?this._index.length/(o*s):0},R.prototype.subset=function(o,s,m){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return A(this,o);case 2:case 3:return T(this,o,s,m);default:throw new SyntaxError("Wrong number of arguments")}};function A(o,s){if(!Wp(s))throw new TypeError("Invalid index");var m=s.isScalar();if(m)return o.get(s.min());var g=s.size();if(g.length!==o._size.length)throw new Ao(g.length,o._size.length);var p,v,x,l,b=s.min(),c=s.max();for(p=0,v=o._size.length;p<v;p++)Zo(b[p],o._size[p]),Zo(c[p],o._size[p]);var M=o._values,_=o._index,y=o._ptr,w=s.dimension(0),d=s.dimension(1),C=[],S=[];w.forEach(function(z,F){S[z]=F[0],C[z]=!0});var E=M?[]:void 0,k=[],B=[];return d.forEach(function(z){for(B.push(k.length),x=y[z],l=y[z+1];x<l;x++)p=_[x],C[p]===!0&&(k.push(S[p]),E&&E.push(M[x]))}),B.push(k.length),new R({values:E,index:k,ptr:B,size:g,datatype:o._datatype})}function T(o,s,m,g){if(!s||s.isIndex!==!0)throw new TypeError("Invalid index");var p=s.size(),v=s.isScalar(),x;if(is(m)?(x=m.size(),m=m.toArray()):x=Nl(m),v){if(x.length!==0)throw new TypeError("Scalar expected");o.set(s.min(),m,g)}else{if(p.length!==1&&p.length!==2)throw new Ao(p.length,o._size.length,"<");if(x.length<p.length){for(var l=0,b=0;p[l]===1&&x[l]===1;)l++;for(;p[l]===1;)b++,l++;m=_g(m,p.length,b,x)}if(!Tv(p,x))throw new Ao(p,x,">");if(p.length===1){var c=s.dimension(0);c.forEach(function(y,w){Zo(y),o.set([y,0],m[w[0]],g)})}else{var M=s.dimension(0),_=s.dimension(1);M.forEach(function(y,w){Zo(y),_.forEach(function(d,C){Zo(d),o.set([y,d],m[w[0]][C[0]],g)})})}}return o}R.prototype.get=function(o){if(!Po(o))throw new TypeError("Array expected");if(o.length!==this._size.length)throw new Ao(o.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var s=o[0],m=o[1];Zo(s,this._size[0]),Zo(m,this._size[1]);var g=e(s,this._ptr[m],this._ptr[m+1],this._index);return g<this._ptr[m+1]&&this._index[g]===s?this._values[g]:0},R.prototype.set=function(o,s,m){if(!Po(o))throw new TypeError("Array expected");if(o.length!==this._size.length)throw new Ao(o.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var g=o[0],p=o[1],v=this._size[0],x=this._size[1],l=t,b=0;af(this._datatype)&&(l=ge.find(t,[this._datatype,this._datatype])||t,b=ge.convert(0,this._datatype)),(g>v-1||p>x-1)&&(a(this,Math.max(g+1,v),Math.max(p+1,x),m),v=this._size[0],x=this._size[1]),Zo(g,v),Zo(p,x);var c=e(g,this._ptr[p],this._ptr[p+1],this._index);return c<this._ptr[p+1]&&this._index[c]===g?l(s,b)?i(c,p,this._values,this._index,this._ptr):this._values[c]=s:l(s,b)||n(c,g,p,s,this._values,this._index,this._ptr),this};function e(o,s,m,g){if(m-s===0)return m;for(var p=s;p<m;p++)if(g[p]===o)return p;return s}function i(o,s,m,g,p){m.splice(o,1),g.splice(o,1);for(var v=s+1;v<p.length;v++)p[v]--}function n(o,s,m,g,p,v,x){p.splice(o,0,g),v.splice(o,0,s);for(var l=m+1;l<x.length;l++)x[l]++}R.prototype.resize=function(o,s,m){if(!wv(o))throw new TypeError("Array or Matrix expected");var g=o.valueOf().map(v=>Array.isArray(v)&&v.length===1?v[0]:v);if(g.length!==2)throw new Error("Only two dimensions matrix are supported");g.forEach(function(v){if(!as(v)||!cs(v)||v<0)throw new TypeError("Invalid size, must contain positive integers (size: "+ns(g)+")")});var p=m?this.clone():this;return a(p,g[0],g[1],s)};function a(o,s,m,g){var p=g||0,v=t,x=0;af(o._datatype)&&(v=ge.find(t,[o._datatype,o._datatype])||t,x=ge.convert(0,o._datatype),p=ge.convert(p,o._datatype));var l=!v(p,x),b=o._size[0],c=o._size[1],M,_,y;if(m>c){for(_=c;_<m;_++)if(o._ptr[_]=o._values.length,l)for(M=0;M<b;M++)o._values.push(p),o._index.push(M);o._ptr[m]=o._values.length}else m<c&&(o._ptr.splice(m+1,c-m),o._values.splice(o._ptr[m],o._values.length),o._index.splice(o._ptr[m],o._index.length));if(c=m,s>b){if(l){var w=0;for(_=0;_<c;_++){o._ptr[_]=o._ptr[_]+w,y=o._ptr[_+1]+w;var d=0;for(M=b;M<s;M++,d++)o._values.splice(y+d,0,p),o._index.splice(y+d,0,M),w++}o._ptr[c]=o._values.length}}else if(s<b){var C=0;for(_=0;_<c;_++){o._ptr[_]=o._ptr[_]-C;var S=o._ptr[_],E=o._ptr[_+1]-C;for(y=S;y<E;y++)M=o._index[y],M>s-1&&(o._values.splice(y,1),o._index.splice(y,1),C++)}o._ptr[_]=o._values.length}return o._size[0]=s,o._size[1]=m,o}R.prototype.reshape=function(o,s){if(!Po(o))throw new TypeError("Array expected");if(o.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");o.forEach(function(z){if(!as(z)||!cs(z)||z<=-2||z===0)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+ns(o)+")")});var m=this._size[0]*this._size[1];o=Xp(o,m);var g=o[0]*o[1];if(m!==g)throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var p=s?this.clone():this;if(this._size[0]===o[0]&&this._size[1]===o[1])return p;for(var v=[],x=0;x<p._ptr.length;x++)for(var l=0;l<p._ptr[x+1]-p._ptr[x];l++)v.push(x);for(var b=p._values.slice(),c=p._index.slice(),M=0;M<p._index.length;M++){var _=c[M],y=v[M],w=_*p._size[1]+y;v[M]=w%o[1],c[M]=Math.floor(w/o[1])}p._values.length=0,p._index.length=0,p._ptr.length=o[1]+1,p._size=o.slice();for(var d=0;d<p._ptr.length;d++)p._ptr[d]=0;for(var C=0;C<b.length;C++){var S=c[C],E=v[C],k=b[C],B=e(S,p._ptr[E],p._ptr[E+1],p._index);n(B,S,E,k,p._values,p._index,p._ptr)}return p},R.prototype.clone=function(){var o=new R({values:this._values?yo(this._values):void 0,index:yo(this._index),ptr:yo(this._ptr),size:yo(this._size),datatype:this._datatype});return o},R.prototype.size=function(){return this._size.slice(0)},R.prototype.map=function(o,s){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var m=this,g=this._size[0],p=this._size[1],v=Og(o),x=function(b,c,M){return v===1?o(b):v===2?o(b,[c,M]):o(b,[c,M],m)};return r(this,0,g-1,0,p-1,x,s)};function r(o,s,m,g,p,v,x){var l=[],b=[],c=[],M=t,_=0;af(o._datatype)&&(M=ge.find(t,[o._datatype,o._datatype])||t,_=ge.convert(0,o._datatype));for(var y=function(N,V,H){N=v(N,V,H),M(N,_)||(l.push(N),b.push(V))},w=g;w<=p;w++){c.push(l.length);var d=o._ptr[w],C=o._ptr[w+1];if(x)for(var S=d;S<C;S++){var E=o._index[S];E>=s&&E<=m&&y(o._values[S],E-s,w-g)}else{for(var k={},B=d;B<C;B++){var z=o._index[B];k[z]=o._values[B]}for(var F=s;F<=m;F++){var I=F in k?k[F]:0;y(I,F-s,w-g)}}}return c.push(l.length),new R({values:l,index:b,ptr:c,size:[m-s+1,p-g+1]})}R.prototype.forEach=function(o,s){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var m=this,g=this._size[0],p=this._size[1],v=0;v<p;v++){var x=this._ptr[v],l=this._ptr[v+1];if(s)for(var b=x;b<l;b++){var c=this._index[b];o(this._values[b],[c,v],m)}else{for(var M={},_=x;_<l;_++){var y=this._index[_];M[y]=this._values[_]}for(var w=0;w<g;w++){var d=w in M?M[w]:0;o(d,[w,v],m)}}}},R.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var o=this._size[1],s=0;s<o;s++)for(var m=this._ptr[s],g=this._ptr[s+1],p=m;p<g;p++){var v=this._index[p];yield{value:this._values[p],index:[v,s]}}},R.prototype.toArray=function(){return f(this._values,this._index,this._ptr,this._size,!0)},R.prototype.valueOf=function(){return f(this._values,this._index,this._ptr,this._size,!1)};function f(o,s,m,g,p){var v=g[0],x=g[1],l=[],b,c;for(b=0;b<v;b++)for(l[b]=[],c=0;c<x;c++)l[b][c]=0;for(c=0;c<x;c++)for(var M=m[c],_=m[c+1],y=M;y<_;y++)b=s[y],l[b][c]=o?p?yo(o[y]):o[y]:1;return l}return R.prototype.format=function(o){for(var s=this._size[0],m=this._size[1],g=this.density(),p="Sparse Matrix ["+ns(s,o)+" x "+ns(m,o)+"] density: "+ns(g,o)+`
`,v=0;v<m;v++)for(var x=this._ptr[v],l=this._ptr[v+1],b=x;b<l;b++){var c=this._index[b];p+=`
    (`+ns(c,o)+", "+ns(v,o)+") ==> "+(this._values?ns(this._values[b],o):"X")}return p},R.prototype.toString=function(){return ns(this.toArray())},R.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},R.prototype.diagonal=function(o){if(o){if(ul(o)&&(o=o.toNumber()),!as(o)||!cs(o))throw new TypeError("The parameter k must be an integer number")}else o=0;var s=o>0?o:0,m=o<0?-o:0,g=this._size[0],p=this._size[1],v=Math.min(g-m,p-s),x=[],l=[],b=[];b[0]=0;for(var c=s;c<p&&x.length<v;c++)for(var M=this._ptr[c],_=this._ptr[c+1],y=M;y<_;y++){var w=this._index[y];if(w===c-s+m){x.push(this._values[y]),l[x.length-1]=w-m;break}}return b.push(x.length),new R({values:x,index:l,ptr:b,size:[v,1]})},R.fromJSON=function(o){return new R(o)},R.diagonal=function(o,s,m,g,p){if(!Po(o))throw new TypeError("Array expected, size parameter");if(o.length!==2)throw new Error("Only two dimensions matrix are supported");if(o=o.map(function(z){if(ul(z)&&(z=z.toNumber()),!as(z)||!cs(z)||z<1)throw new Error("Size values must be positive integers");return z}),m){if(ul(m)&&(m=m.toNumber()),!as(m)||!cs(m))throw new TypeError("The parameter k must be an integer number")}else m=0;var v=t,x=0;af(p)&&(v=ge.find(t,[p,p])||t,x=ge.convert(0,p));var l=m>0?m:0,b=m<0?-m:0,c=o[0],M=o[1],_=Math.min(c-b,M-l),y;if(Po(s)){if(s.length!==_)throw new Error("Invalid value array length");y=function(F){return s[F]}}else if(is(s)){var w=s.size();if(w.length!==1||w[0]!==_)throw new Error("Invalid matrix length");y=function(F){return s.get([F])}}else y=function(){return s};for(var d=[],C=[],S=[],E=0;E<M;E++){S.push(d.length);var k=E-l;if(k>=0&&k<_){var B=y(k);v(B,x)||(C.push(k+b),d.push(B))}}return S.push(d.length),new R({values:d,index:C,ptr:S,size:[c,M]})},R.prototype.swapRows=function(o,s){if(!as(o)||!cs(o)||!as(s)||!cs(s))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return Zo(o,this._size[0]),Zo(s,this._size[0]),R._swapRows(o,s,this._size[1],this._values,this._index,this._ptr),this},R._forEachRow=function(o,s,m,g,p){for(var v=g[o],x=g[o+1],l=v;l<x;l++)p(m[l],s[l])},R._swapRows=function(o,s,m,g,p,v){for(var x=0;x<m;x++){var l=v[x],b=v[x+1],c=e(o,l,b,p),M=e(s,l,b,p);if(c<b&&M<b&&p[c]===o&&p[M]===s){if(g){var _=g[c];g[c]=g[M],g[M]=_}continue}if(c<b&&p[c]===o&&(M>=b||p[M]!==s)){var y=g?g[c]:void 0;p.splice(M,0,s),g&&g.splice(M,0,y),p.splice(M<=c?c+1:c,1),g&&g.splice(M<=c?c+1:c,1);continue}if(M<b&&p[M]===s&&(c>=b||p[c]!==o)){var w=g?g[M]:void 0;p.splice(c,0,o),g&&g.splice(c,0,w),p.splice(c<=M?M+1:M,1),g&&g.splice(c<=M?M+1:M,1)}}},R},{isClass:!0}),o_="number",s_=["typed"];function l_(ye){var ge=ye.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);if(ge){var t={"0b":2,"0o":8,"0x":16}[ge[1]],P=ge[2],R=ge[3];return{input:ye,radix:t,integerPart:P,fractionalPart:R}}else return null}function u_(ye){for(var ge=parseInt(ye.integerPart,ye.radix),t=0,P=0;P<ye.fractionalPart.length;P++){var R=parseInt(ye.fractionalPart[P],ye.radix);t+=R/Math.pow(ye.radix,P+1)}var h=ge+t;if(isNaN(h))throw new SyntaxError('String "'+ye.input+'" is no valid number');return h}var f_=Wa(o_,s_,ye=>{var{typed:ge}=ye,t=ge("number",{"":function(){return 0},number:function(R){return R},string:function(R){if(R==="NaN")return NaN;var h=l_(R);if(h)return u_(h);var u=0,A=R.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);A&&(u=Number(A[2]),R=A[1]);var T=Number(R);if(isNaN(T))throw new SyntaxError('String "'+R+'" is no valid number');if(A){if(T>2**u-1)throw new SyntaxError('String "'.concat(R,'" is out of range'));T>=2**(u-1)&&(T=T-2**u)}return T},BigNumber:function(R){return R.toNumber()},Fraction:function(R){return R.valueOf()},Unit:function(R){throw new Error("Second argument with valueless unit expected")},null:function(R){return 0},"Unit, string | Unit":function(R,h){return R.toNumber(h)},"Array | Matrix":ge.referToSelf(P=>R=>Fu(R,P))});return t.fromJSON=function(P){return parseFloat(P.value)},t}),c_="bignumber",h_=["typed","BigNumber"],v_=Wa(c_,h_,ye=>{var{typed:ge,BigNumber:t}=ye;return ge("bignumber",{"":function(){return new t(0)},number:function(R){return new t(R+"")},string:function(R){var h=R.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(h){var u=h[2],A=t(h[1]),T=new t(2).pow(Number(u));if(A.gt(T.sub(1)))throw new SyntaxError('String "'.concat(R,'" is out of range'));var e=new t(2).pow(Number(u)-1);return A.gte(e)?A.sub(T):A}return new t(R)},BigNumber:function(R){return R},Fraction:function(R){return new t(R.n).div(R.d).times(R.s)},null:function(R){return new t(0)},"Array | Matrix":ge.referToSelf(P=>R=>Fu(R,P))})}),p_="complex",d_=["typed","Complex"],g_=Wa(p_,d_,ye=>{var{typed:ge,Complex:t}=ye;return ge("complex",{"":function(){return t.ZERO},number:function(R){return new t(R,0)},"number, number":function(R,h){return new t(R,h)},"BigNumber, BigNumber":function(R,h){return new t(R.toNumber(),h.toNumber())},Fraction:function(R){return new t(R.valueOf(),0)},Complex:function(R){return R.clone()},string:function(R){return t(R)},null:function(R){return t(0)},Object:function(R){if("re"in R&&"im"in R)return new t(R.re,R.im);if("r"in R&&"phi"in R||"abs"in R&&"arg"in R)return new t(R);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":ge.referToSelf(P=>R=>Fu(R,P))})}),y_="fraction",m_=["typed","Fraction"],x_=Wa(y_,m_,ye=>{var{typed:ge,Fraction:t}=ye;return ge("fraction",{number:function(R){if(!isFinite(R)||isNaN(R))throw new Error(R+" cannot be represented as a fraction");return new t(R)},string:function(R){return new t(R)},"number, number":function(R,h){return new t(R,h)},null:function(R){return new t(0)},BigNumber:function(R){return new t(R.toString())},Fraction:function(R){return R},Object:function(R){return new t(R)},"Array | Matrix":ge.referToSelf(P=>R=>Fu(R,P))})}),k0="matrix",b_=["typed","Matrix","DenseMatrix","SparseMatrix"],__=Wa(k0,b_,ye=>{var{typed:ge,Matrix:t,DenseMatrix:P,SparseMatrix:R}=ye;return ge(k0,{"":function(){return h([])},string:function(A){return h([],A)},"string, string":function(A,T){return h([],A,T)},Array:function(A){return h(A)},Matrix:function(A){return h(A,A.storage())},"Array | Matrix, string":h,"Array | Matrix, string, string":h});function h(u,A,T){if(A==="dense"||A==="default"||A===void 0)return new P(u,T);if(A==="sparse")return new R(u,T);throw new TypeError("Unknown matrix type "+JSON.stringify(A)+".")}}),D0="matrixFromColumns",w_=["typed","matrix","flatten","size"],T_=Wa(D0,w_,ye=>{var{typed:ge,matrix:t,flatten:P,size:R}=ye;return ge(D0,{"...Array":function(T){return h(T)},"...Matrix":function(T){return t(h(T.map(e=>e.toArray())))}});function h(A){if(A.length===0)throw new TypeError("At least one column is needed to construct a matrix.");for(var T=u(A[0]),e=[],i=0;i<T;i++)e[i]=[];for(var n of A){var a=u(n);if(a!==T)throw new TypeError("The vectors had different length: "+(T|0)+" \u2260 "+(a|0));for(var r=P(n),f=0;f<T;f++)e[f].push(r[f])}return e}function u(A){var T=R(A);if(T.length===1)return T[0];if(T.length===2){if(T[0]===1)return T[1];if(T[1]===1)return T[0];throw new TypeError("At least one of the arguments is not a vector.")}else throw new TypeError("Only one- or two-dimensional vectors are supported.")}}),L0="unaryMinus",A_=["typed"],M_=Wa(L0,A_,ye=>{var{typed:ge}=ye;return ge(L0,{number:Yg,"Complex | BigNumber | Fraction":t=>t.neg(),Unit:ge.referToSelf(t=>P=>{var R=P.clone();return R.value=ge.find(t,R.valueType())(P.value),R}),"Array | Matrix":ge.referToSelf(t=>P=>Fu(P,t))})}),P0="abs",S_=["typed"],E_=Wa(P0,S_,ye=>{var{typed:ge}=ye;return ge(P0,{number:Vg,"Complex | BigNumber | Fraction | Unit":t=>t.abs(),"Array | Matrix":ge.referToSelf(t=>P=>Fu(P,t))})}),F0="addScalar",C_=["typed"],k_=Wa(F0,C_,ye=>{var{typed:ge}=ye;return ge(F0,{"number, number":Hg,"Complex, Complex":function(P,R){return P.add(R)},"BigNumber, BigNumber":function(P,R){return P.plus(R)},"Fraction, Fraction":function(P,R){return P.add(R)},"Unit, Unit":ge.referToSelf(t=>(P,R)=>{if(P.value===null||P.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(R.value===null||R.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!P.equalBase(R))throw new Error("Units do not match");var h=P.clone();return h.value=ge.find(t,[h.valueType(),R.valueType()])(h.value,R.value),h.fixPrefix=!1,h})})}),D_="matAlgo11xS0s",L_=["typed","equalScalar"],P_=Wa(D_,L_,ye=>{var{typed:ge,equalScalar:t}=ye;return function(R,h,u,A){var T=R._values,e=R._index,i=R._ptr,n=R._size,a=R._datatype;if(!T)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var r=n[0],f=n[1],o,s=t,m=0,g=u;typeof a=="string"&&(o=a,s=ge.find(t,[o,o]),m=ge.convert(0,o),h=ge.convert(h,o),g=ge.find(u,[o,o]));for(var p=[],v=[],x=[],l=0;l<f;l++){x[l]=v.length;for(var b=i[l],c=i[l+1],M=b;M<c;M++){var _=e[M],y=A?g(h,T[M]):g(T[M],h);s(y,m)||(v.push(_),p.push(y))}}return x[f]=v.length,R.createSparseMatrix({values:p,index:v,ptr:x,size:[r,f],datatype:o})}}),F_="matAlgo12xSfs",R_=["typed","DenseMatrix"],lh=Wa(F_,R_,ye=>{var{typed:ge,DenseMatrix:t}=ye;return function(R,h,u,A){var T=R._values,e=R._index,i=R._ptr,n=R._size,a=R._datatype;if(!T)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var r=n[0],f=n[1],o,s=u;typeof a=="string"&&(o=a,h=ge.convert(h,o),s=ge.find(u,[o,o]));for(var m=[],g=[],p=[],v=0;v<f;v++){for(var x=v+1,l=i[v],b=i[v+1],c=l;c<b;c++){var M=e[c];g[M]=T[c],p[M]=x}for(var _=0;_<r;_++)v===0&&(m[_]=[]),p[_]===x?m[_][v]=A?s(h,g[_]):s(g[_],h):m[_][v]=A?s(h,0):s(0,h)}return new t({data:m,size:[r,f],datatype:o})}}),I_="matAlgo14xDs",z_=["typed"],Xg=Wa(I_,z_,ye=>{var{typed:ge}=ye;return function(R,h,u,A){var T=R._data,e=R._size,i=R._datatype,n,a=u;typeof i=="string"&&(n=i,h=ge.convert(h,n),a=ge.find(u,[n,n]));var r=e.length>0?t(a,0,e,e[0],T,h,A):[];return R.createDenseMatrix({data:r,size:yo(e),datatype:n})};function t(P,R,h,u,A,T,e){var i=[];if(R===h.length-1)for(var n=0;n<u;n++)i[n]=e?P(T,A[n]):P(A[n],T);else for(var a=0;a<u;a++)i[a]=t(P,R+1,h,h[R+1],A[a],T,e);return i}}),B_="matAlgo01xDSid",N_=["typed"],Zg=Wa(B_,N_,ye=>{var{typed:ge}=ye;return function(P,R,h,u){var A=P._data,T=P._size,e=P._datatype,i=R._values,n=R._index,a=R._ptr,r=R._size,f=R._datatype;if(T.length!==r.length)throw new Ao(T.length,r.length);if(T[0]!==r[0]||T[1]!==r[1])throw new RangeError("Dimension mismatch. Matrix A ("+T+") must match Matrix B ("+r+")");if(!i)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var o=T[0],s=T[1],m=typeof e=="string"&&e===f?e:void 0,g=m?ge.find(h,[m,m]):h,p,v,x=[];for(p=0;p<o;p++)x[p]=[];var l=[],b=[];for(v=0;v<s;v++){for(var c=v+1,M=a[v],_=a[v+1],y=M;y<_;y++)p=n[y],l[p]=u?g(i[y],A[p][v]):g(A[p][v],i[y]),b[p]=c;for(p=0;p<o;p++)b[p]===c?x[p][v]=l[p]:x[p][v]=A[p][v]}return P.createDenseMatrix({data:x,size:[o,s],datatype:m})}}),O_="matAlgo04xSidSid",U_=["typed","equalScalar"],V_=Wa(O_,U_,ye=>{var{typed:ge,equalScalar:t}=ye;return function(R,h,u){var A=R._values,T=R._index,e=R._ptr,i=R._size,n=R._datatype,a=h._values,r=h._index,f=h._ptr,o=h._size,s=h._datatype;if(i.length!==o.length)throw new Ao(i.length,o.length);if(i[0]!==o[0]||i[1]!==o[1])throw new RangeError("Dimension mismatch. Matrix A ("+i+") must match Matrix B ("+o+")");var m=i[0],g=i[1],p,v=t,x=0,l=u;typeof n=="string"&&n===s&&(p=n,v=ge.find(t,[p,p]),x=ge.convert(0,p),l=ge.find(u,[p,p]));var b=A&&a?[]:void 0,c=[],M=[],_=A&&a?[]:void 0,y=A&&a?[]:void 0,w=[],d=[],C,S,E,k,B;for(S=0;S<g;S++){M[S]=c.length;var z=S+1;for(k=e[S],B=e[S+1],E=k;E<B;E++)C=T[E],c.push(C),w[C]=z,_&&(_[C]=A[E]);for(k=f[S],B=f[S+1],E=k;E<B;E++)if(C=r[E],w[C]===z){if(_){var F=l(_[C],a[E]);v(F,x)?w[C]=null:_[C]=F}}else c.push(C),d[C]=z,y&&(y[C]=a[E]);if(_&&y)for(E=M[S];E<c.length;)C=c[E],w[C]===z?(b[E]=_[C],E++):d[C]===z?(b[E]=y[C],E++):c.splice(E,1)}return M[g]=c.length,R.createSparseMatrix({values:b,index:c,ptr:M,size:[m,g],datatype:p})}}),H_="matAlgo10xSids",G_=["typed","DenseMatrix"],jg=Wa(H_,G_,ye=>{var{typed:ge,DenseMatrix:t}=ye;return function(R,h,u,A){var T=R._values,e=R._index,i=R._ptr,n=R._size,a=R._datatype;if(!T)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var r=n[0],f=n[1],o,s=u;typeof a=="string"&&(o=a,h=ge.convert(h,o),s=ge.find(u,[o,o]));for(var m=[],g=[],p=[],v=0;v<f;v++){for(var x=v+1,l=i[v],b=i[v+1],c=l;c<b;c++){var M=e[c];g[M]=T[c],p[M]=x}for(var _=0;_<r;_++)v===0&&(m[_]=[]),p[_]===x?m[_][v]=A?s(h,g[_]):s(g[_],h):m[_][v]=h}return new t({data:m,size:[r,f],datatype:o})}}),Y_="matAlgo13xDD",W_=["typed"],X_=Wa(Y_,W_,ye=>{var{typed:ge}=ye;return function(R,h,u){var A=R._data,T=R._size,e=R._datatype,i=h._data,n=h._size,a=h._datatype,r=[];if(T.length!==n.length)throw new Ao(T.length,n.length);for(var f=0;f<T.length;f++){if(T[f]!==n[f])throw new RangeError("Dimension mismatch. Matrix A ("+T+") must match Matrix B ("+n+")");r[f]=T[f]}var o,s=u;typeof e=="string"&&e===a&&(o=e,s=ge.find(u,[o,o]));var m=r.length>0?t(s,0,r,r[0],A,i):[];return R.createDenseMatrix({data:m,size:r,datatype:o})};function t(P,R,h,u,A,T){var e=[];if(R===h.length-1)for(var i=0;i<u;i++)e[i]=P(A[i],T[i]);else for(var n=0;n<u;n++)e[n]=t(P,R+1,h,h[R+1],A[n],T[n]);return e}}),Z_="matrixAlgorithmSuite",j_=["typed","matrix"],bc=Wa(Z_,j_,ye=>{var{typed:ge,matrix:t}=ye,P=X_({typed:ge}),R=Xg({typed:ge});return function(u){var A=u.elop,T=u.SD||u.DS,e;A?(e={"DenseMatrix, DenseMatrix":(r,f)=>P(r,f,A),"Array, Array":(r,f)=>P(t(r),t(f),A).valueOf(),"Array, DenseMatrix":(r,f)=>P(t(r),f,A),"DenseMatrix, Array":(r,f)=>P(r,t(f),A)},u.SS&&(e["SparseMatrix, SparseMatrix"]=(r,f)=>u.SS(r,f,A,!1)),u.DS&&(e["DenseMatrix, SparseMatrix"]=(r,f)=>u.DS(r,f,A,!1),e["Array, SparseMatrix"]=(r,f)=>u.DS(t(r),f,A,!1)),T&&(e["SparseMatrix, DenseMatrix"]=(r,f)=>T(f,r,A,!0),e["SparseMatrix, Array"]=(r,f)=>T(t(f),r,A,!0))):(e={"DenseMatrix, DenseMatrix":ge.referToSelf(r=>(f,o)=>P(f,o,r)),"Array, Array":ge.referToSelf(r=>(f,o)=>P(t(f),t(o),r).valueOf()),"Array, DenseMatrix":ge.referToSelf(r=>(f,o)=>P(t(f),o,r)),"DenseMatrix, Array":ge.referToSelf(r=>(f,o)=>P(f,t(o),r))},u.SS&&(e["SparseMatrix, SparseMatrix"]=ge.referToSelf(r=>(f,o)=>u.SS(f,o,r,!1))),u.DS&&(e["DenseMatrix, SparseMatrix"]=ge.referToSelf(r=>(f,o)=>u.DS(f,o,r,!1)),e["Array, SparseMatrix"]=ge.referToSelf(r=>(f,o)=>u.DS(t(f),o,r,!1))),T&&(e["SparseMatrix, DenseMatrix"]=ge.referToSelf(r=>(f,o)=>T(o,f,r,!0)),e["SparseMatrix, Array"]=ge.referToSelf(r=>(f,o)=>T(t(o),f,r,!0))));var i=u.scalar||"any",n=u.Ds||u.Ss;n&&(A?(e["DenseMatrix,"+i]=(r,f)=>R(r,f,A,!1),e[i+", DenseMatrix"]=(r,f)=>R(f,r,A,!0),e["Array,"+i]=(r,f)=>R(t(r),f,A,!1).valueOf(),e[i+", Array"]=(r,f)=>R(t(f),r,A,!0).valueOf()):(e["DenseMatrix,"+i]=ge.referToSelf(r=>(f,o)=>R(f,o,r,!1)),e[i+", DenseMatrix"]=ge.referToSelf(r=>(f,o)=>R(o,f,r,!0)),e["Array,"+i]=ge.referToSelf(r=>(f,o)=>R(t(f),o,r,!1).valueOf()),e[i+", Array"]=ge.referToSelf(r=>(f,o)=>R(t(o),f,r,!0).valueOf())));var a=u.sS!==void 0?u.sS:u.Ss;return A?(u.Ss&&(e["SparseMatrix,"+i]=(r,f)=>u.Ss(r,f,A,!1)),a&&(e[i+", SparseMatrix"]=(r,f)=>a(f,r,A,!0))):(u.Ss&&(e["SparseMatrix,"+i]=ge.referToSelf(r=>(f,o)=>u.Ss(f,o,r,!1))),a&&(e[i+", SparseMatrix"]=ge.referToSelf(r=>(f,o)=>a(o,f,r,!0)))),A&&A.signatures&&cb(e,A.signatures),e}}),J_="matAlgo03xDSf",K_=["typed"],uh=Wa(J_,K_,ye=>{var{typed:ge}=ye;return function(P,R,h,u){var A=P._data,T=P._size,e=P._datatype,i=R._values,n=R._index,a=R._ptr,r=R._size,f=R._datatype;if(T.length!==r.length)throw new Ao(T.length,r.length);if(T[0]!==r[0]||T[1]!==r[1])throw new RangeError("Dimension mismatch. Matrix A ("+T+") must match Matrix B ("+r+")");if(!i)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var o=T[0],s=T[1],m,g=0,p=h;typeof e=="string"&&e===f&&(m=e,g=ge.convert(0,m),p=ge.find(h,[m,m]));for(var v=[],x=0;x<o;x++)v[x]=[];for(var l=[],b=[],c=0;c<s;c++){for(var M=c+1,_=a[c],y=a[c+1],w=_;w<y;w++){var d=n[w];l[d]=u?p(i[w],A[d][c]):p(A[d][c],i[w]),b[d]=M}for(var C=0;C<o;C++)b[C]===M?v[C][c]=l[C]:v[C][c]=u?p(g,A[C][c]):p(A[C][c],g)}return P.createDenseMatrix({data:v,size:[o,s],datatype:m})}}),Q_="matAlgo05xSfSf",$_=["typed","equalScalar"],q_=Wa(Q_,$_,ye=>{var{typed:ge,equalScalar:t}=ye;return function(R,h,u){var A=R._values,T=R._index,e=R._ptr,i=R._size,n=R._datatype,a=h._values,r=h._index,f=h._ptr,o=h._size,s=h._datatype;if(i.length!==o.length)throw new Ao(i.length,o.length);if(i[0]!==o[0]||i[1]!==o[1])throw new RangeError("Dimension mismatch. Matrix A ("+i+") must match Matrix B ("+o+")");var m=i[0],g=i[1],p,v=t,x=0,l=u;typeof n=="string"&&n===s&&(p=n,v=ge.find(t,[p,p]),x=ge.convert(0,p),l=ge.find(u,[p,p]));var b=A&&a?[]:void 0,c=[],M=[],_=b?[]:void 0,y=b?[]:void 0,w=[],d=[],C,S,E,k;for(S=0;S<g;S++){M[S]=c.length;var B=S+1;for(E=e[S],k=e[S+1];E<k;E++)C=T[E],c.push(C),w[C]=B,_&&(_[C]=A[E]);for(E=f[S],k=f[S+1];E<k;E++)C=r[E],w[C]!==B&&c.push(C),d[C]=B,y&&(y[C]=a[E]);if(b)for(E=M[S];E<c.length;){C=c[E];var z=w[C],F=d[C];if(z===B||F===B){var I=z===B?_[C]:x,O=F===B?y[C]:x,N=l(I,O);v(N,x)?c.splice(E,1):(b.push(N),E++)}}}return M[g]=c.length,R.createSparseMatrix({values:b,index:c,ptr:M,size:[m,g],datatype:p})}}),ew="multiplyScalar",tw=["typed"],rw=Wa(ew,tw,ye=>{var{typed:ge}=ye;return ge("multiplyScalar",{"number, number":Gg,"Complex, Complex":function(P,R){return P.mul(R)},"BigNumber, BigNumber":function(P,R){return P.times(R)},"Fraction, Fraction":function(P,R){return P.mul(R)},"number | Fraction | BigNumber | Complex, Unit":(t,P)=>P.multiply(t),"Unit, number | Fraction | BigNumber | Complex | Unit":(t,P)=>t.multiply(P)})}),R0="multiply",nw=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],aw=Wa(R0,nw,ye=>{var{typed:ge,matrix:t,addScalar:P,multiplyScalar:R,equalScalar:h,dot:u}=ye,A=P_({typed:ge,equalScalar:h}),T=Xg({typed:ge});function e(x,l){switch(x.length){case 1:switch(l.length){case 1:if(x[0]!==l[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(x[0]!==l[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+x[0]+") must match Matrix rows ("+l[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+l.length+" dimensions)")}break;case 2:switch(l.length){case 1:if(x[1]!==l[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+x[1]+") must match Vector length ("+l[0]+")");break;case 2:if(x[1]!==l[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+x[1]+") must match Matrix B rows ("+l[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+l.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+x.length+" dimensions)")}}function i(x,l,b){if(b===0)throw new Error("Cannot multiply two empty vectors");return u(x,l)}function n(x,l){if(l.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return a(x,l)}function a(x,l){var b=x._data,c=x._size,M=x._datatype,_=l._data,y=l._size,w=l._datatype,d=c[0],C=y[1],S,E=P,k=R;M&&w&&M===w&&typeof M=="string"&&(S=M,E=ge.find(P,[S,S]),k=ge.find(R,[S,S]));for(var B=[],z=0;z<C;z++){for(var F=k(b[0],_[0][z]),I=1;I<d;I++)F=E(F,k(b[I],_[I][z]));B[z]=F}return x.createDenseMatrix({data:B,size:[C],datatype:S})}var r=ge("_multiplyMatrixVector",{"DenseMatrix, any":o,"SparseMatrix, any":g}),f=ge("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":s,"DenseMatrix, SparseMatrix":m,"SparseMatrix, DenseMatrix":p,"SparseMatrix, SparseMatrix":v});function o(x,l){var b=x._data,c=x._size,M=x._datatype,_=l._data,y=l._datatype,w=c[0],d=c[1],C,S=P,E=R;M&&y&&M===y&&typeof M=="string"&&(C=M,S=ge.find(P,[C,C]),E=ge.find(R,[C,C]));for(var k=[],B=0;B<w;B++){for(var z=b[B],F=E(z[0],_[0]),I=1;I<d;I++)F=S(F,E(z[I],_[I]));k[B]=F}return x.createDenseMatrix({data:k,size:[w],datatype:C})}function s(x,l){var b=x._data,c=x._size,M=x._datatype,_=l._data,y=l._size,w=l._datatype,d=c[0],C=c[1],S=y[1],E,k=P,B=R;M&&w&&M===w&&typeof M=="string"&&(E=M,k=ge.find(P,[E,E]),B=ge.find(R,[E,E]));for(var z=[],F=0;F<d;F++){var I=b[F];z[F]=[];for(var O=0;O<S;O++){for(var N=B(I[0],_[0][O]),V=1;V<C;V++)N=k(N,B(I[V],_[V][O]));z[F][O]=N}}return x.createDenseMatrix({data:z,size:[d,S],datatype:E})}function m(x,l){var b=x._data,c=x._size,M=x._datatype,_=l._values,y=l._index,w=l._ptr,d=l._size,C=l._datatype;if(!_)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var S=c[0],E=d[1],k,B=P,z=R,F=h,I=0;M&&C&&M===C&&typeof M=="string"&&(k=M,B=ge.find(P,[k,k]),z=ge.find(R,[k,k]),F=ge.find(h,[k,k]),I=ge.convert(0,k));for(var O=[],N=[],V=[],H=l.createSparseMatrix({values:O,index:N,ptr:V,size:[S,E],datatype:k}),j=0;j<E;j++){V[j]=N.length;var Z=w[j],X=w[j+1];if(X>Z)for(var re=0,ue=0;ue<S;ue++){for(var K=ue+1,te=void 0,G=Z;G<X;G++){var Y=y[G];re!==K?(te=z(b[ue][Y],_[G]),re=K):te=B(te,z(b[ue][Y],_[G]))}re===K&&!F(te,I)&&(N.push(ue),O.push(te))}}return V[E]=N.length,H}function g(x,l){var b=x._values,c=x._index,M=x._ptr,_=x._datatype;if(!b)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var y=l._data,w=l._datatype,d=x._size[0],C=l._size[0],S=[],E=[],k=[],B,z=P,F=R,I=h,O=0;_&&w&&_===w&&typeof _=="string"&&(B=_,z=ge.find(P,[B,B]),F=ge.find(R,[B,B]),I=ge.find(h,[B,B]),O=ge.convert(0,B));var N=[],V=[];k[0]=0;for(var H=0;H<C;H++){var j=y[H];if(!I(j,O))for(var Z=M[H],X=M[H+1],re=Z;re<X;re++){var ue=c[re];V[ue]?N[ue]=z(N[ue],F(j,b[re])):(V[ue]=!0,E.push(ue),N[ue]=F(j,b[re]))}}for(var K=E.length,te=0;te<K;te++){var G=E[te];S[te]=N[G]}return k[1]=E.length,x.createSparseMatrix({values:S,index:E,ptr:k,size:[d,1],datatype:B})}function p(x,l){var b=x._values,c=x._index,M=x._ptr,_=x._datatype;if(!b)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var y=l._data,w=l._datatype,d=x._size[0],C=l._size[0],S=l._size[1],E,k=P,B=R,z=h,F=0;_&&w&&_===w&&typeof _=="string"&&(E=_,k=ge.find(P,[E,E]),B=ge.find(R,[E,E]),z=ge.find(h,[E,E]),F=ge.convert(0,E));for(var I=[],O=[],N=[],V=x.createSparseMatrix({values:I,index:O,ptr:N,size:[d,S],datatype:E}),H=[],j=[],Z=0;Z<S;Z++){N[Z]=O.length;for(var X=Z+1,re=0;re<C;re++){var ue=y[re][Z];if(!z(ue,F))for(var K=M[re],te=M[re+1],G=K;G<te;G++){var Y=c[G];j[Y]!==X?(j[Y]=X,O.push(Y),H[Y]=B(ue,b[G])):H[Y]=k(H[Y],B(ue,b[G]))}}for(var ee=N[Z],ne=O.length,J=ee;J<ne;J++){var q=O[J];I[J]=H[q]}}return N[S]=O.length,V}function v(x,l){var b=x._values,c=x._index,M=x._ptr,_=x._datatype,y=l._values,w=l._index,d=l._ptr,C=l._datatype,S=x._size[0],E=l._size[1],k=b&&y,B,z=P,F=R;_&&C&&_===C&&typeof _=="string"&&(B=_,z=ge.find(P,[B,B]),F=ge.find(R,[B,B]));for(var I=k?[]:void 0,O=[],N=[],V=x.createSparseMatrix({values:I,index:O,ptr:N,size:[S,E],datatype:B}),H=k?[]:void 0,j=[],Z,X,re,ue,K,te,G,Y,ee=0;ee<E;ee++){N[ee]=O.length;var ne=ee+1;for(K=d[ee],te=d[ee+1],ue=K;ue<te;ue++)if(Y=w[ue],k)for(X=M[Y],re=M[Y+1],Z=X;Z<re;Z++)G=c[Z],j[G]!==ne?(j[G]=ne,O.push(G),H[G]=F(y[ue],b[Z])):H[G]=z(H[G],F(y[ue],b[Z]));else for(X=M[Y],re=M[Y+1],Z=X;Z<re;Z++)G=c[Z],j[G]!==ne&&(j[G]=ne,O.push(G));if(k)for(var J=N[ee],q=O.length,ae=J;ae<q;ae++){var le=O[ae];I[ae]=H[le]}}return N[E]=O.length,V}return ge(R0,R,{"Array, Array":ge.referTo("Matrix, Matrix",x=>(l,b)=>{e(Nl(l),Nl(b));var c=x(t(l),t(b));return is(c)?c.valueOf():c}),"Matrix, Matrix":function(l,b){var c=l.size(),M=b.size();return e(c,M),c.length===1?M.length===1?i(l,b,c[0]):n(l,b):M.length===1?r(l,b):f(l,b)},"Matrix, Array":ge.referTo("Matrix,Matrix",x=>(l,b)=>x(l,t(b))),"Array, Matrix":ge.referToSelf(x=>(l,b)=>x(t(l,b.storage()),b)),"SparseMatrix, any":function(l,b){return A(l,b,R,!1)},"DenseMatrix, any":function(l,b){return T(l,b,R,!1)},"any, SparseMatrix":function(l,b){return A(b,l,R,!0)},"any, DenseMatrix":function(l,b){return T(b,l,R,!0)},"Array, any":function(l,b){return T(t(l),b,R,!1).valueOf()},"any, Array":function(l,b){return T(t(b),l,R,!0).valueOf()},"any, any":R,"any, any, ...any":ge.referToSelf(x=>(l,b,c)=>{for(var M=x(l,b),_=0;_<c.length;_++)M=x(M,c[_]);return M})})}),I0="sign",iw=["typed","BigNumber","Fraction","complex"],ow=Wa(I0,iw,ye=>{var{typed:ge,BigNumber:t,complex:P,Fraction:R}=ye;return ge(I0,{number:Vp,Complex:function(u){return u.im===0?P(Vp(u.re)):u.sign()},BigNumber:function(u){return new t(u.cmp(0))},Fraction:function(u){return new R(u.s,1)},"Array | Matrix":ge.referToSelf(h=>u=>Fu(u,h)),Unit:ge.referToSelf(h=>u=>{if(!u._isDerived()&&u.units[0].unit.offset!==0)throw new TypeError("sign is ambiguous for units with offset");return ge.find(h,u.valueType())(u.value)})})}),sw="sqrt",lw=["config","typed","Complex"],uw=Wa(sw,lw,ye=>{var{config:ge,typed:t,Complex:P}=ye;return t("sqrt",{number:R,Complex:function(u){return u.sqrt()},BigNumber:function(u){return!u.isNegative()||ge.predictable?u.sqrt():R(u.toNumber())},Unit:function(u){return u.pow(.5)}});function R(h){return isNaN(h)?NaN:h>=0||ge.predictable?Math.sqrt(h):new P(h,0).sqrt()}}),z0="subtract",fw=["typed","matrix","equalScalar","addScalar","unaryMinus","DenseMatrix"],cw=Wa(z0,fw,ye=>{var{typed:ge,matrix:t,equalScalar:P,addScalar:R,unaryMinus:h,DenseMatrix:u}=ye,A=Zg({typed:ge}),T=uh({typed:ge}),e=q_({typed:ge,equalScalar:P}),i=jg({typed:ge,DenseMatrix:u}),n=lh({typed:ge,DenseMatrix:u}),a=bc({typed:ge,matrix:t});return ge(z0,{"number, number":(r,f)=>r-f,"Complex, Complex":(r,f)=>r.sub(f),"BigNumber, BigNumber":(r,f)=>r.minus(f),"Fraction, Fraction":(r,f)=>r.sub(f),"Unit, Unit":ge.referToSelf(r=>(f,o)=>{if(f.value===null)throw new Error("Parameter x contains a unit with undefined value");if(o.value===null)throw new Error("Parameter y contains a unit with undefined value");if(!f.equalBase(o))throw new Error("Units do not match");var s=f.clone();return s.value=ge.find(r,[s.valueType(),o.valueType()])(s.value,o.value),s.fixPrefix=!1,s})},a({SS:e,DS:A,SD:T,Ss:n,sS:i}))}),hw="matAlgo07xSSf",vw=["typed","DenseMatrix"],Oh=Wa(hw,vw,ye=>{var{typed:ge,DenseMatrix:t}=ye;return function(h,u,A){var T=h._size,e=h._datatype,i=u._size,n=u._datatype;if(T.length!==i.length)throw new Ao(T.length,i.length);if(T[0]!==i[0]||T[1]!==i[1])throw new RangeError("Dimension mismatch. Matrix A ("+T+") must match Matrix B ("+i+")");var a=T[0],r=T[1],f,o=0,s=A;typeof e=="string"&&e===n&&(f=e,o=ge.convert(0,f),s=ge.find(A,[f,f]));var m,g,p=[];for(m=0;m<a;m++)p[m]=[];var v=[],x=[],l=[],b=[];for(g=0;g<r;g++){var c=g+1;for(P(h,g,l,v,c),P(u,g,b,x,c),m=0;m<a;m++){var M=l[m]===c?v[m]:o,_=b[m]===c?x[m]:o;p[m][g]=s(M,_)}}return new t({data:p,size:[a,r],datatype:f})};function P(R,h,u,A,T){for(var e=R._values,i=R._index,n=R._ptr,a=n[h],r=n[h+1];a<r;a++){var f=i[a];u[f]=T,A[f]=e[a]}}}),B0="conj",pw=["typed"],dw=Wa(B0,pw,ye=>{var{typed:ge}=ye;return ge(B0,{"number | BigNumber | Fraction":t=>t,Complex:t=>t.conjugate(),"Array | Matrix":ge.referToSelf(t=>P=>Fu(P,t))})}),N0="im",gw=["typed"],yw=Wa(N0,gw,ye=>{var{typed:ge}=ye;return ge(N0,{number:()=>0,"BigNumber | Fraction":t=>t.mul(0),Complex:t=>t.im,"Array | Matrix":ge.referToSelf(t=>P=>Fu(P,t))})}),O0="re",mw=["typed"],xw=Wa(O0,mw,ye=>{var{typed:ge}=ye;return ge(O0,{"number | BigNumber | Fraction":t=>t,Complex:t=>t.re,"Array | Matrix":ge.referToSelf(t=>P=>Fu(P,t))})}),U0="column",bw=["typed","Index","matrix","range"],_w=Wa(U0,bw,ye=>{var{typed:ge,Index:t,matrix:P,range:R}=ye;return ge(U0,{"Matrix, number":h,"Array, number":function(A,T){return h(P(yo(A)),T).valueOf()}});function h(u,A){if(u.size().length!==2)throw new Error("Only two dimensional matrix is supported");Zo(A,u.size()[1]);var T=R(0,u.size()[0]),e=new t(T,A);return u.subset(e)}}),V0="diag",ww=["typed","matrix","DenseMatrix","SparseMatrix"],Tw=Wa(V0,ww,ye=>{var{typed:ge,matrix:t,DenseMatrix:P,SparseMatrix:R}=ye;return ge(V0,{Array:function(e){return h(e,0,Nl(e),null)},"Array, number":function(e,i){return h(e,i,Nl(e),null)},"Array, BigNumber":function(e,i){return h(e,i.toNumber(),Nl(e),null)},"Array, string":function(e,i){return h(e,0,Nl(e),i)},"Array, number, string":function(e,i,n){return h(e,i,Nl(e),n)},"Array, BigNumber, string":function(e,i,n){return h(e,i.toNumber(),Nl(e),n)},Matrix:function(e){return h(e,0,e.size(),e.storage())},"Matrix, number":function(e,i){return h(e,i,e.size(),e.storage())},"Matrix, BigNumber":function(e,i){return h(e,i.toNumber(),e.size(),e.storage())},"Matrix, string":function(e,i){return h(e,0,e.size(),i)},"Matrix, number, string":function(e,i,n){return h(e,i,e.size(),n)},"Matrix, BigNumber, string":function(e,i,n){return h(e,i.toNumber(),e.size(),n)}});function h(T,e,i,n){if(!cs(e))throw new TypeError("Second parameter in function diag must be an integer");var a=e>0?e:0,r=e<0?-e:0;switch(i.length){case 1:return u(T,e,n,i[0],r,a);case 2:return A(T,e,n,i,r,a)}throw new RangeError("Matrix for function diag must be 2 dimensional")}function u(T,e,i,n,a,r){var f=[n+a,n+r];if(i&&i!=="sparse"&&i!=="dense")throw new TypeError("Unknown matrix type ".concat(i,'"'));var o=i==="sparse"?R.diagonal(f,T,e):P.diagonal(f,T,e);return i!==null?o:o.valueOf()}function A(T,e,i,n,a,r){if(is(T)){var f=T.diagonal(e);return i!==null?i!==f.storage()?t(f,i):f:f.valueOf()}for(var o=Math.min(n[0]-a,n[1]-r),s=[],m=0;m<o;m++)s[m]=T[m+a][m+r];return i!==null?t(s):s}}),H0="flatten",Aw=["typed","matrix"],Mw=Wa(H0,Aw,ye=>{var{typed:ge,matrix:t}=ye;return ge(H0,{Array:function(R){return Ip(R)},Matrix:function(R){var h=Ip(R.toArray());return t(h)}})}),G0="identity",Sw=["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],Ew=Wa(G0,Sw,ye=>{var{typed:ge,config:t,matrix:P,BigNumber:R,DenseMatrix:h,SparseMatrix:u}=ye;return ge(G0,{"":function(){return t.matrix==="Matrix"?P([]):[]},string:function(i){return P(i)},"number | BigNumber":function(i){return T(i,i,t.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, string":function(i,n){return T(i,i,n)},"number | BigNumber, number | BigNumber":function(i,n){return T(i,n,t.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(i,n,a){return T(i,n,a)},Array:function(i){return A(i)},"Array, string":function(i,n){return A(i,n)},Matrix:function(i){return A(i.valueOf(),i.storage())},"Matrix, string":function(i,n){return A(i.valueOf(),n)}});function A(e,i){switch(e.length){case 0:return i?P(i):[];case 1:return T(e[0],e[0],i);case 2:return T(e[0],e[1],i);default:throw new Error("Vector containing two values expected")}}function T(e,i,n){var a=ul(e)||ul(i)?R:null;if(ul(e)&&(e=e.toNumber()),ul(i)&&(i=i.toNumber()),!cs(e)||e<1)throw new Error("Parameters in function identity must be positive integers");if(!cs(i)||i<1)throw new Error("Parameters in function identity must be positive integers");var r=a?new R(1):1,f=a?new a(0):0,o=[e,i];if(n){if(n==="sparse")return u.diagonal(o,r,0,f);if(n==="dense")return h.diagonal(o,r,0,f);throw new TypeError('Unknown matrix type "'.concat(n,'"'))}for(var s=Av([],o,f),m=e<i?e:i,g=0;g<m;g++)s[g][g]=r;return s}});function Jg(){throw new Error('No "bignumber" implementation available')}function Cw(){throw new Error('No "fraction" implementation available')}function Kg(){throw new Error('No "matrix" implementation available')}var Y0="range",kw=["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq"],Dw=Wa(Y0,kw,ye=>{var{typed:ge,config:t,matrix:P,bignumber:R,smaller:h,smallerEq:u,larger:A,largerEq:T}=ye;return ge(Y0,{string:i,"string, boolean":i,"number, number":function(m,g){return e(n(m,g,1))},"number, number, number":function(m,g,p){return e(n(m,g,p))},"number, number, boolean":function(m,g,p){return e(p?a(m,g,1):n(m,g,1))},"number, number, number, boolean":function(m,g,p,v){return e(v?a(m,g,p):n(m,g,p))},"BigNumber, BigNumber":function(m,g){var p=m.constructor;return e(r(m,g,new p(1)))},"BigNumber, BigNumber, BigNumber":function(m,g,p){return e(r(m,g,p))},"BigNumber, BigNumber, boolean":function(m,g,p){var v=m.constructor;return e(p?f(m,g,new v(1)):r(m,g,new v(1)))},"BigNumber, BigNumber, BigNumber, boolean":function(m,g,p,v){return e(v?f(m,g,p):r(m,g,p))}});function e(s){return t.matrix==="Matrix"?P?P(s):Kg():s}function i(s,m){var g=o(s);if(!g)throw new SyntaxError('String "'+s+'" is no valid range');var p;return t.number==="BigNumber"?(R===void 0&&Jg(),p=m?f:r,e(p(R(g.start),R(g.end),R(g.step)))):(p=m?a:n,e(p(g.start,g.end,g.step)))}function n(s,m,g){var p=[],v=s;if(g>0)for(;h(v,m);)p.push(v),v+=g;else if(g<0)for(;A(v,m);)p.push(v),v+=g;return p}function a(s,m,g){var p=[],v=s;if(g>0)for(;u(v,m);)p.push(v),v+=g;else if(g<0)for(;T(v,m);)p.push(v),v+=g;return p}function r(s,m,g){var p=R(0),v=[],x=s;if(g.gt(p))for(;h(x,m);)v.push(x),x=x.plus(g);else if(g.lt(p))for(;A(x,m);)v.push(x),x=x.plus(g);return v}function f(s,m,g){var p=R(0),v=[],x=s;if(g.gt(p))for(;u(x,m);)v.push(x),x=x.plus(g);else if(g.lt(p))for(;T(x,m);)v.push(x),x=x.plus(g);return v}function o(s){var m=s.split(":"),g=m.map(function(v){return Number(v)}),p=g.some(function(v){return isNaN(v)});if(p)return null;switch(g.length){case 2:return{start:g[0],end:g[1],step:1};case 3:return{start:g[0],end:g[2],step:g[1]};default:return null}}}),W0="size",Lw=["typed","config","?matrix"],Pw=Wa(W0,Lw,ye=>{var{typed:ge,config:t,matrix:P}=ye;return ge(W0,{Matrix:function(h){return h.create(h.size())},Array:Nl,string:function(h){return t.matrix==="Array"?[h.length]:P([h.length])},"number | Complex | BigNumber | Unit | boolean | null":function(h){return t.matrix==="Array"?[]:P?P([]):Kg()}})}),X0="zeros",Fw=["typed","config","matrix","BigNumber"],Rw=Wa(X0,Fw,ye=>{var{typed:ge,config:t,matrix:P,BigNumber:R}=ye;return ge(X0,{"":function(){return t.matrix==="Array"?h([]):h([],"default")},"...number | BigNumber | string":function(e){var i=e[e.length-1];if(typeof i=="string"){var n=e.pop();return h(e,n)}else return t.matrix==="Array"?h(e):h(e,"default")},Array:h,Matrix:function(e){var i=e.storage();return h(e.valueOf(),i)},"Array | Matrix, string":function(e,i){return h(e.valueOf(),i)}});function h(T,e){var i=u(T),n=i?new R(0):0;if(A(T),e){var a=P(e);return T.length>0?a.resize(T,n):a}else{var r=[];return T.length>0?Av(r,T,n):r}}function u(T){var e=!1;return T.forEach(function(i,n,a){ul(i)&&(e=!0,a[n]=i.toNumber())}),e}function A(T){T.forEach(function(e){if(typeof e!="number"||!cs(e)||e<0)throw new Error("Parameters in function zeros must be positive integers")})}}),Iw="numeric",zw=["number","?bignumber","?fraction"],Bw=Wa(Iw,zw,ye=>{var{number:ge,bignumber:t,fraction:P}=ye,R={string:!0,number:!0,BigNumber:!0,Fraction:!0},h={number:u=>ge(u),BigNumber:t?u=>t(u):Jg,Fraction:P?u=>P(u):Cw};return function(A){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"number",e=arguments.length>2?arguments[2]:void 0;if(e!==void 0)throw new SyntaxError("numeric() takes one or two arguments");var i=ac(A);if(!(i in R))throw new TypeError("Cannot convert "+A+' of type "'+i+'"; valid input types are '+Object.keys(R).join(", "));if(!(T in h))throw new TypeError("Cannot convert "+A+' to type "'+T+'"; valid output types are '+Object.keys(h).join(", "));return T===i?A:h[T](A)}}),Z0="divideScalar",Nw=["typed","numeric"],Ow=Wa(Z0,Nw,ye=>{var{typed:ge,numeric:t}=ye;return ge(Z0,{"number, number":function(R,h){return R/h},"Complex, Complex":function(R,h){return R.div(h)},"BigNumber, BigNumber":function(R,h){return R.div(h)},"Fraction, Fraction":function(R,h){return R.div(h)},"Unit, number | Complex | Fraction | BigNumber | Unit":(P,R)=>P.divide(R),"number | Fraction | Complex | BigNumber, Unit":(P,R)=>R.divideInto(P)})});function Qg(ye){var{DenseMatrix:ge}=ye;return function(P,R,h){var u=P.size();if(u.length!==2)throw new RangeError("Matrix must be two dimensional (size: "+ns(u)+")");var A=u[0],T=u[1];if(A!==T)throw new RangeError("Matrix must be square (size: "+ns(u)+")");var e=[];if(is(R)){var i=R.size(),n=R._data;if(i.length===1){if(i[0]!==A)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var a=0;a<A;a++)e[a]=[n[a]];return new ge({data:e,size:[A,1],datatype:R._datatype})}if(i.length===2){if(i[0]!==A||i[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(vg(R)){if(h){e=[];for(var r=0;r<A;r++)e[r]=[n[r][0]];return new ge({data:e,size:[A,1],datatype:R._datatype})}return R}if(pg(R)){for(var f=0;f<A;f++)e[f]=[0];for(var o=R._values,s=R._index,m=R._ptr,g=m[1],p=m[0];p<g;p++){var v=s[p];e[v][0]=o[p]}return new ge({data:e,size:[A,1],datatype:R._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(Po(R)){var x=Nl(R);if(x.length===1){if(x[0]!==A)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var l=0;l<A;l++)e[l]=[R[l]];return new ge({data:e,size:[A,1]})}if(x.length===2){if(x[0]!==A||x[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var b=0;b<A;b++)e[b]=[R[b][0]];return new ge({data:e,size:[A,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var j0="usolve",Uw=["typed","matrix","divideScalar","multiplyScalar","subtract","equalScalar","DenseMatrix"],Vw=Wa(j0,Uw,ye=>{var{typed:ge,matrix:t,divideScalar:P,multiplyScalar:R,subtract:h,equalScalar:u,DenseMatrix:A}=ye,T=Qg({DenseMatrix:A});return ge(j0,{"SparseMatrix, Array | Matrix":function(a,r){return i(a,r)},"DenseMatrix, Array | Matrix":function(a,r){return e(a,r)},"Array, Array | Matrix":function(a,r){var f=t(a),o=e(f,r);return o.valueOf()}});function e(n,a){a=T(n,a,!0);for(var r=a._data,f=n._size[0],o=n._size[1],s=[],m=n._data,g=o-1;g>=0;g--){var p=r[g][0]||0,v=void 0;if(u(p,0))v=0;else{var x=m[g][g];if(u(x,0))throw new Error("Linear system cannot be solved since matrix is singular");v=P(p,x);for(var l=g-1;l>=0;l--)r[l]=[h(r[l][0]||0,R(v,m[l][g]))]}s[g]=[v]}return new A({data:s,size:[f,1]})}function i(n,a){a=T(n,a,!0);for(var r=a._data,f=n._size[0],o=n._size[1],s=n._values,m=n._index,g=n._ptr,p=[],v=o-1;v>=0;v--){var x=r[v][0]||0;if(u(x,0))p[v]=[0];else{for(var l=0,b=[],c=[],M=g[v],_=g[v+1],y=_-1;y>=M;y--){var w=m[y];w===v?l=s[y]:w<v&&(b.push(s[y]),c.push(w))}if(u(l,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var d=P(x,l),C=0,S=c.length;C<S;C++){var E=c[C];r[E]=[h(r[E][0],R(d,b[C]))]}p[v]=[d]}}return new A({data:p,size:[f,1]})}}),J0="usolveAll",Hw=["typed","matrix","divideScalar","multiplyScalar","subtract","equalScalar","DenseMatrix"],Gw=Wa(J0,Hw,ye=>{var{typed:ge,matrix:t,divideScalar:P,multiplyScalar:R,subtract:h,equalScalar:u,DenseMatrix:A}=ye,T=Qg({DenseMatrix:A});return ge(J0,{"SparseMatrix, Array | Matrix":function(a,r){return i(a,r)},"DenseMatrix, Array | Matrix":function(a,r){return e(a,r)},"Array, Array | Matrix":function(a,r){var f=t(a),o=e(f,r);return o.map(s=>s.valueOf())}});function e(n,a){for(var r=[T(n,a,!0)._data.map(c=>c[0])],f=n._data,o=n._size[0],s=n._size[1],m=s-1;m>=0;m--)for(var g=r.length,p=0;p<g;p++){var v=r[p];if(u(f[m][m],0))if(u(v[m],0)){if(p===0){var l=[...v];l[m]=1;for(var b=m-1;b>=0;b--)l[b]=h(l[b],f[b][m]);r.push(l)}}else{if(p===0)return[];r.splice(p,1),p-=1,g-=1}else{v[m]=P(v[m],f[m][m]);for(var x=m-1;x>=0;x--)v[x]=h(v[x],R(v[m],f[x][m]))}}return r.map(c=>new A({data:c.map(M=>[M]),size:[o,1]}))}function i(n,a){for(var r=[T(n,a,!0)._data.map(I=>I[0])],f=n._size[0],o=n._size[1],s=n._values,m=n._index,g=n._ptr,p=o-1;p>=0;p--)for(var v=r.length,x=0;x<v;x++){for(var l=r[x],b=[],c=[],M=g[p],_=g[p+1],y=0,w=_-1;w>=M;w--){var d=m[w];d===p?y=s[w]:d<p&&(b.push(s[w]),c.push(d))}if(u(y,0))if(u(l[p],0)){if(x===0){var k=[...l];k[p]=1;for(var B=0,z=c.length;B<z;B++){var F=c[B];k[F]=h(k[F],b[B])}r.push(k)}}else{if(x===0)return[];r.splice(x,1),x-=1,v-=1}else{l[p]=P(l[p],y);for(var C=0,S=c.length;C<S;C++){var E=c[C];l[E]=h(l[E],R(l[p],b[C]))}}}return r.map(I=>new A({data:I.map(O=>[O]),size:[f,1]}))}}),Dv="equal",Yw=["typed","matrix","equalScalar","DenseMatrix"],Ww=Wa(Dv,Yw,ye=>{var{typed:ge,matrix:t,equalScalar:P,DenseMatrix:R}=ye,h=uh({typed:ge}),u=Oh({typed:ge,DenseMatrix:R}),A=lh({typed:ge,DenseMatrix:R}),T=bc({typed:ge,matrix:t});return ge(Dv,Xw({typed:ge,equalScalar:P}),T({elop:P,SS:u,DS:h,Ss:A}))}),Xw=Wa(Dv,["typed","equalScalar"],ye=>{var{typed:ge,equalScalar:t}=ye;return ge(Dv,{"any, any":function(R,h){return R===null?h===null:h===null?R===null:R===void 0?h===void 0:h===void 0?R===void 0:t(R,h)}})}),Lv="smaller",Zw=["typed","config","matrix","DenseMatrix"],jw=Wa(Lv,Zw,ye=>{var{typed:ge,config:t,matrix:P,DenseMatrix:R}=ye,h=uh({typed:ge}),u=Oh({typed:ge,DenseMatrix:R}),A=lh({typed:ge,DenseMatrix:R}),T=bc({typed:ge,matrix:P}),e=Nh({typed:ge});return ge(Lv,Jw({typed:ge,config:t}),{"boolean, boolean":(i,n)=>i<n,"BigNumber, BigNumber":function(n,a){return n.lt(a)&&!Bh(n,a,t.epsilon)},"Fraction, Fraction":(i,n)=>i.compare(n)===-1,"Complex, Complex":function(n,a){throw new TypeError("No ordering relation is defined for complex numbers")}},e,T({SS:u,DS:h,Ss:A}))}),Jw=Wa(Lv,["typed","config"],ye=>{var{typed:ge,config:t}=ye;return ge(Lv,{"number, number":function(R,h){return R<h&&!ic(R,h,t.epsilon)}})}),Pv="smallerEq",Kw=["typed","config","matrix","DenseMatrix"],Qw=Wa(Pv,Kw,ye=>{var{typed:ge,config:t,matrix:P,DenseMatrix:R}=ye,h=uh({typed:ge}),u=Oh({typed:ge,DenseMatrix:R}),A=lh({typed:ge,DenseMatrix:R}),T=bc({typed:ge,matrix:P}),e=Nh({typed:ge});return ge(Pv,$w({typed:ge,config:t}),{"boolean, boolean":(i,n)=>i<=n,"BigNumber, BigNumber":function(n,a){return n.lte(a)||Bh(n,a,t.epsilon)},"Fraction, Fraction":(i,n)=>i.compare(n)!==1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},e,T({SS:u,DS:h,Ss:A}))}),$w=Wa(Pv,["typed","config"],ye=>{var{typed:ge,config:t}=ye;return ge(Pv,{"number, number":function(R,h){return R<=h||ic(R,h,t.epsilon)}})}),Fv="larger",qw=["typed","config","matrix","DenseMatrix"],e3=Wa(Fv,qw,ye=>{var{typed:ge,config:t,matrix:P,DenseMatrix:R}=ye,h=uh({typed:ge}),u=Oh({typed:ge,DenseMatrix:R}),A=lh({typed:ge,DenseMatrix:R}),T=bc({typed:ge,matrix:P}),e=Nh({typed:ge});return ge(Fv,t3({typed:ge,config:t}),{"boolean, boolean":(i,n)=>i>n,"BigNumber, BigNumber":function(n,a){return n.gt(a)&&!Bh(n,a,t.epsilon)},"Fraction, Fraction":(i,n)=>i.compare(n)===1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},e,T({SS:u,DS:h,Ss:A}))}),t3=Wa(Fv,["typed","config"],ye=>{var{typed:ge,config:t}=ye;return ge(Fv,{"number, number":function(R,h){return R>h&&!ic(R,h,t.epsilon)}})}),Rv="largerEq",r3=["typed","config","matrix","DenseMatrix"],n3=Wa(Rv,r3,ye=>{var{typed:ge,config:t,matrix:P,DenseMatrix:R}=ye,h=uh({typed:ge}),u=Oh({typed:ge,DenseMatrix:R}),A=lh({typed:ge,DenseMatrix:R}),T=bc({typed:ge,matrix:P}),e=Nh({typed:ge});return ge(Rv,a3({typed:ge,config:t}),{"boolean, boolean":(i,n)=>i>=n,"BigNumber, BigNumber":function(n,a){return n.gte(a)||Bh(n,a,t.epsilon)},"Fraction, Fraction":(i,n)=>i.compare(n)!==-1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},e,T({SS:u,DS:h,Ss:A}))}),a3=Wa(Rv,["typed","config"],ye=>{var{typed:ge,config:t}=ye;return ge(Rv,{"number, number":function(R,h){return R>=h||ic(R,h,t.epsilon)}})}),i3="ImmutableDenseMatrix",o3=["smaller","DenseMatrix"],s3=Wa(i3,o3,ye=>{var{smaller:ge,DenseMatrix:t}=ye;function P(R,h){if(!(this instanceof P))throw new SyntaxError("Constructor must be called with the new operator");if(h&&!af(h))throw new Error("Invalid datatype: "+h);if(is(R)||Po(R)){var u=new t(R,h);this._data=u._data,this._size=u._size,this._datatype=u._datatype,this._min=null,this._max=null}else if(R&&Po(R.data)&&Po(R.size))this._data=R.data,this._size=R.size,this._datatype=R.datatype,this._min=typeof R.min<"u"?R.min:null,this._max=typeof R.max<"u"?R.max:null;else{if(R)throw new TypeError("Unsupported type of data ("+ac(R)+")");this._data=[],this._size=[0],this._datatype=h,this._min=null,this._max=null}}return P.prototype=new t,P.prototype.type="ImmutableDenseMatrix",P.prototype.isImmutableDenseMatrix=!0,P.prototype.subset=function(R){switch(arguments.length){case 1:{var h=t.prototype.subset.call(this,R);return is(h)?new P({data:h._data,size:h._size,datatype:h._datatype}):h}case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},P.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},P.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},P.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},P.prototype.clone=function(){return new P({data:yo(this._data),size:yo(this._size),datatype:this._datatype})},P.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},P.fromJSON=function(R){return new P(R)},P.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},P.prototype.min=function(){if(this._min===null){var R=null;this.forEach(function(h){(R===null||ge(h,R))&&(R=h)}),this._min=R!==null?R:void 0}return this._min},P.prototype.max=function(){if(this._max===null){var R=null;this.forEach(function(h){(R===null||ge(R,h))&&(R=h)}),this._max=R!==null?R:void 0}return this._max},P},{isClass:!0}),l3="Index",u3=["ImmutableDenseMatrix"],f3=Wa(l3,u3,ye=>{var{ImmutableDenseMatrix:ge}=ye;function t(R){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._isScalar=!0;for(var h=0,u=arguments.length;h<u;h++){var A=arguments[h];if(dg(A))this._dimensions.push(A),this._isScalar=!1;else if(Array.isArray(A)||is(A)){var T=P(A.valueOf());this._dimensions.push(T);var e=T.size();(e.length!==1||e[0]!==1)&&(this._isScalar=!1)}else if(typeof A=="number")this._dimensions.push(P([A]));else if(typeof A=="string")this._dimensions.push(A);else throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range")}}t.prototype.type="Index",t.prototype.isIndex=!0;function P(R){for(var h=0,u=R.length;h<u;h++)if(typeof R[h]!="number"||!cs(R[h]))throw new TypeError("Index parameters must be positive integer numbers");return new ge(R)}return t.prototype.clone=function(){var R=new t;return R._dimensions=yo(this._dimensions),R._isScalar=this._isScalar,R},t.create=function(R){var h=new t;return t.apply(h,R),h},t.prototype.size=function(){for(var R=[],h=0,u=this._dimensions.length;h<u;h++){var A=this._dimensions[h];R[h]=typeof A=="string"?1:A.size()[0]}return R},t.prototype.max=function(){for(var R=[],h=0,u=this._dimensions.length;h<u;h++){var A=this._dimensions[h];R[h]=typeof A=="string"?A:A.max()}return R},t.prototype.min=function(){for(var R=[],h=0,u=this._dimensions.length;h<u;h++){var A=this._dimensions[h];R[h]=typeof A=="string"?A:A.min()}return R},t.prototype.forEach=function(R){for(var h=0,u=this._dimensions.length;h<u;h++)R(this._dimensions[h],h,this)},t.prototype.dimension=function(R){return this._dimensions[R]||null},t.prototype.isObjectProperty=function(){return this._dimensions.length===1&&typeof this._dimensions[0]=="string"},t.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},t.prototype.isScalar=function(){return this._isScalar},t.prototype.toArray=function(){for(var R=[],h=0,u=this._dimensions.length;h<u;h++){var A=this._dimensions[h];R.push(typeof A=="string"?A:A.toArray())}return R},t.prototype.valueOf=t.prototype.toArray,t.prototype.toString=function(){for(var R=[],h=0,u=this._dimensions.length;h<u;h++){var A=this._dimensions[h];typeof A=="string"?R.push(JSON.stringify(A)):R.push(A.toString())}return"["+R.join(", ")+"]"},t.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},t.fromJSON=function(R){return t.create(R.dimensions)},t},{isClass:!0}),c3="atan",h3=["typed"],v3=Wa(c3,h3,ye=>{var{typed:ge}=ye;return ge("atan",{number:function(P){return Math.atan(P)},Complex:function(P){return P.atan()},BigNumber:function(P){return P.atan()}})}),$g=Wa("trigUnit",["typed"],ye=>{var{typed:ge}=ye;return{Unit:ge.referToSelf(t=>P=>{if(!P.hasBase(P.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return ge.find(t,P.valueType())(P.value)})}}),K0="cos",p3=["typed"],d3=Wa(K0,p3,ye=>{var{typed:ge}=ye,t=$g({typed:ge});return ge(K0,{number:Math.cos,"Complex | BigNumber":P=>P.cos()},t)}),Q0="sin",g3=["typed"],y3=Wa(Q0,g3,ye=>{var{typed:ge}=ye,t=$g({typed:ge});return ge(Q0,{number:Math.sin,"Complex | BigNumber":P=>P.sin()},t)}),$0="add",m3=["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix"],x3=Wa($0,m3,ye=>{var{typed:ge,matrix:t,addScalar:P,equalScalar:R,DenseMatrix:h,SparseMatrix:u}=ye,A=Zg({typed:ge}),T=V_({typed:ge,equalScalar:R}),e=jg({typed:ge,DenseMatrix:h}),i=bc({typed:ge,matrix:t});return ge($0,{"any, any":P,"any, any, ...any":ge.referToSelf(n=>(a,r,f)=>{for(var o=n(a,r),s=0;s<f.length;s++)o=n(o,f[s]);return o})},i({elop:P,DS:A,SS:T,Ss:e}))}),q0="dot",b3=["typed","addScalar","multiplyScalar","conj","size"],_3=Wa(q0,b3,ye=>{var{typed:ge,addScalar:t,multiplyScalar:P,conj:R,size:h}=ye;return ge(q0,{"Array | DenseMatrix, Array | DenseMatrix":A,"SparseMatrix, SparseMatrix":T});function u(i,n){var a=e(i),r=e(n),f,o;if(a.length===1)f=a[0];else if(a.length===2&&a[1]===1)f=a[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+a.join(", ")+")");if(r.length===1)o=r[0];else if(r.length===2&&r[1]===1)o=r[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+r.join(", ")+")");if(f!==o)throw new RangeError("Vectors must have equal length ("+f+" != "+o+")");if(f===0)throw new RangeError("Cannot calculate the dot product of empty vectors");return f}function A(i,n){var a=u(i,n),r=is(i)?i._data:i,f=is(i)?i._datatype:void 0,o=is(n)?n._data:n,s=is(n)?n._datatype:void 0,m=e(i).length===2,g=e(n).length===2,p=t,v=P;if(f&&s&&f===s&&typeof f=="string"){var x=f;p=ge.find(t,[x,x]),v=ge.find(P,[x,x])}if(!m&&!g){for(var l=v(R(r[0]),o[0]),b=1;b<a;b++)l=p(l,v(R(r[b]),o[b]));return l}if(!m&&g){for(var c=v(R(r[0]),o[0][0]),M=1;M<a;M++)c=p(c,v(R(r[M]),o[M][0]));return c}if(m&&!g){for(var _=v(R(r[0][0]),o[0]),y=1;y<a;y++)_=p(_,v(R(r[y][0]),o[y]));return _}if(m&&g){for(var w=v(R(r[0][0]),o[0][0]),d=1;d<a;d++)w=p(w,v(R(r[d][0]),o[d][0]));return w}}function T(i,n){u(i,n);for(var a=i._index,r=i._values,f=n._index,o=n._values,s=0,m=t,g=P,p=0,v=0;p<a.length&&v<f.length;){var x=a[p],l=f[v];if(x<l){p++;continue}if(x>l){v++;continue}x===l&&(s=m(s,g(r[p],o[v])),p++,v++)}return s}function e(i){return is(i)?i.size():h(i)}}),eg="qr",w3=["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtract","complex"],T3=Wa(eg,w3,ye=>{var{typed:ge,matrix:t,zeros:P,identity:R,isZero:h,equal:u,sign:A,sqrt:T,conj:e,unaryMinus:i,addScalar:n,divideScalar:a,multiplyScalar:r,subtract:f,complex:o}=ye;return _v(ge(eg,{DenseMatrix:function(v){return m(v)},SparseMatrix:function(v){return g()},Array:function(v){var x=t(v),l=m(x);return{Q:l.Q.valueOf(),R:l.R.valueOf()}}}),{_denseQRimpl:s});function s(p){var v=p._size[0],x=p._size[1],l=R([v],"dense"),b=l._data,c=p.clone(),M=c._data,_,y,w,d=P([v],"");for(w=0;w<Math.min(x,v);++w){var C=M[w][w],S=i(u(C,0)?1:A(C)),E=e(S),k=0;for(_=w;_<v;_++)k=n(k,r(M[_][w],e(M[_][w])));var B=r(S,T(k));if(!h(B)){var z=f(C,B);for(d[w]=1,_=w+1;_<v;_++)d[_]=a(M[_][w],z);var F=i(e(a(z,B))),I=void 0;for(y=w;y<x;y++){for(I=0,_=w;_<v;_++)I=n(I,r(e(d[_]),M[_][y]));for(I=r(I,F),_=w;_<v;_++)M[_][y]=r(f(M[_][y],r(d[_],I)),E)}for(_=0;_<v;_++){for(I=0,y=w;y<v;y++)I=n(I,r(b[_][y],d[y]));for(I=r(I,F),y=w;y<v;++y)b[_][y]=a(f(b[_][y],r(I,e(d[y]))),E)}}}return{Q:l,R:c,toString:function(){return"Q: "+this.Q.toString()+`
R: `+this.R.toString()}}}function m(p){var v=s(p),x=v.R._data;if(p._data.length>0)for(var l=x[0][0].type==="Complex"?o(0):0,b=0;b<x.length;++b)for(var c=0;c<b&&c<(x[0]||[]).length;++c)x[b][c]=l;return v}function g(p){throw new Error("qr not implemented for sparse matrices yet")}}),tg="det",A3=["typed","matrix","subtract","multiply","divideScalar","isZero","unaryMinus"],M3=Wa(tg,A3,ye=>{var{typed:ge,matrix:t,subtract:P,multiply:R,divideScalar:h,isZero:u,unaryMinus:A}=ye;return ge(tg,{any:function(i){return yo(i)},"Array | Matrix":function(i){var n;switch(is(i)?n=i.size():Array.isArray(i)?(i=t(i),n=i.size()):n=[],n.length){case 0:return yo(i);case 1:if(n[0]===1)return yo(i.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+ns(n)+")");case 2:{var a=n[0],r=n[1];if(a===r)return T(i.clone().valueOf(),a);throw new RangeError("Matrix must be square (size: "+ns(n)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+ns(n)+")")}}});function T(e,i,n){if(i===1)return yo(e[0][0]);if(i===2)return P(R(e[0][0],e[1][1]),R(e[1][0],e[0][1]));for(var a=!1,r=new Array(i).fill(0).map((b,c)=>c),f=0;f<i;f++){var o=r[f];if(u(e[o][f])){var s=void 0;for(s=f+1;s<i;s++)if(!u(e[r[s]][f])){o=r[s],r[s]=r[f],r[f]=o,a=!a;break}if(s===i)return e[o][f]}for(var m=e[o][f],g=f===0?1:e[r[f-1]][f-1],p=f+1;p<i;p++)for(var v=r[p],x=f+1;x<i;x++)e[v][x]=h(P(R(e[v][x],m),R(e[v][f],e[o][x])),g)}var l=e[r[i-1]][i-1];return a?A(l):l}}),rg="inv",S3=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],E3=Wa(rg,S3,ye=>{var{typed:ge,matrix:t,divideScalar:P,addScalar:R,multiply:h,unaryMinus:u,det:A,identity:T,abs:e}=ye;return ge(rg,{"Array | Matrix":function(a){var r=is(a)?a.size():Nl(a);switch(r.length){case 1:if(r[0]===1)return is(a)?t([P(1,a.valueOf()[0])]):[P(1,a[0])];throw new RangeError("Matrix must be square (size: "+ns(r)+")");case 2:{var f=r[0],o=r[1];if(f===o)return is(a)?t(i(a.valueOf(),f,o),a.storage()):i(a,f,o);throw new RangeError("Matrix must be square (size: "+ns(r)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+ns(r)+")")}},any:function(a){return P(1,a)}});function i(n,a,r){var f,o,s,m,g;if(a===1){if(m=n[0][0],m===0)throw Error("Cannot calculate inverse, determinant is zero");return[[P(1,m)]]}else if(a===2){var p=A(n);if(p===0)throw Error("Cannot calculate inverse, determinant is zero");return[[P(n[1][1],p),P(u(n[0][1]),p)],[P(u(n[1][0]),p),P(n[0][0],p)]]}else{var v=n.concat();for(f=0;f<a;f++)v[f]=v[f].concat();for(var x=T(a).valueOf(),l=0;l<r;l++){var b=e(v[l][l]),c=l;for(f=l+1;f<a;)e(v[f][l])>b&&(b=e(v[f][l]),c=f),f++;if(b===0)throw Error("Cannot calculate inverse, determinant is zero");f=c,f!==l&&(g=v[l],v[l]=v[f],v[f]=g,g=x[l],x[l]=x[f],x[f]=g);var M=v[l],_=x[l];for(f=0;f<a;f++){var y=v[f],w=x[f];if(f!==l){if(y[l]!==0){for(s=P(u(y[l]),M[l]),o=l;o<r;o++)y[o]=R(y[o],h(s,M[o]));for(o=0;o<r;o++)w[o]=R(w[o],h(s,_[o]))}}else{for(s=M[l],o=l;o<r;o++)y[o]=P(y[o],s);for(o=0;o<r;o++)w[o]=P(w[o],s)}}}return x}}});function C3(ye){var{addScalar:ge,subtract:t,flatten:P,multiply:R,multiplyScalar:h,divideScalar:u,sqrt:A,abs:T,bignumber:e,diag:i,inv:n,qr:a,usolve:r,usolveAll:f,equal:o,complex:s,larger:m,smaller:g,matrixFromColumns:p,dot:v}=ye;function x(F,I,O,N,V){V===void 0&&(V=!0);var H=l(F,I,O,N,V);b(F,I,O,N,V,H);var{values:j,C:Z}=c(F,I,O,N,V),X;return V&&(X=M(F,I,Z,H,j,O,N),X=p(...X)),{values:j,vectors:X}}function l(F,I,O,N,V){var H=N==="BigNumber",j=N==="Complex",Z=H?e(0):0,X=H?e(1):j?s(1):1,re=H?e(1):1,ue=H?e(10):2,K=h(ue,ue),te;V&&(te=Array(I).fill(X));for(var G=!1;!G;){G=!0;for(var Y=0;Y<I;Y++){for(var ee=Z,ne=Z,J=0;J<I;J++)if(Y!==J){var q=T(F[Y][J]);ee=ge(ee,q),ne=ge(ne,q)}if(!o(ee,0)&&!o(ne,0)){for(var ae=re,le=ee,ie=u(ne,ue),se=h(ne,ue);g(le,ie);)le=h(le,K),ae=h(ae,ue);for(;m(le,se);)le=u(le,K),ae=u(ae,ue);var xe=g(u(ge(le,ne),ae),h(ge(ee,ne),.95));if(xe){G=!1;for(var oe=u(1,ae),he=0;he<I;he++)Y!==he&&(F[Y][he]=h(F[Y][he],ae),F[he][Y]=h(F[he][Y],oe));V&&(te[Y]=h(te[Y],ae))}}}}return i(te)}function b(F,I,O,N,V,H){var j=N==="BigNumber",Z=N==="Complex",X=j?e(0):Z?s(0):0;j&&(O=e(O));for(var re=0;re<I-2;re++){for(var ue=0,K=X,te=re+1;te<I;te++){var G=F[te][re];g(T(K),T(G))&&(K=G,ue=te)}if(!g(T(K),O)){if(ue!==re+1){var Y=F[ue];F[ue]=F[re+1],F[re+1]=Y;for(var ee=0;ee<I;ee++){var ne=F[ee][ue];F[ee][ue]=F[ee][re+1],F[ee][re+1]=ne}if(V){var J=H[ue];H[ue]=H[re+1],H[re+1]=J}}for(var q=re+2;q<I;q++){var ae=u(F[q][re],K);if(ae!==0){for(var le=0;le<I;le++)F[q][le]=t(F[q][le],h(ae,F[re+1][le]));for(var ie=0;ie<I;ie++)F[ie][re+1]=ge(F[ie][re+1],h(ae,F[ie][q]));if(V)for(var se=0;se<I;se++)H[q][se]=t(H[q][se],h(ae,H[re+1][se]))}}}}return H}function c(F,I,O,N,V){var H=N==="BigNumber",j=N==="Complex",Z=H?e(1):j?s(1):1;H&&(O=e(O));for(var X=yo(F),re=[],ue=I,K=[],te=V?i(Array(I).fill(Z)):void 0,G=V?i(Array(ue).fill(Z)):void 0,Y=0;Y<=100;){Y+=1;for(var ee=0,ne=0;ne<ue;ne++)X[ne][ne]=t(X[ne][ne],ee);var{Q:J,R:q}=a(X);X=R(q,J);for(var ae=0;ae<ue;ae++)X[ae][ae]=ge(X[ae][ae],ee);if(V&&(G=R(G,J)),ue===1||g(T(X[ue-1][ue-2]),O)){Y=0,re.push(X[ue-1][ue-1]),V&&(K.unshift([[1]]),w(G,I),te=R(te,G),ue>1&&(G=i(Array(ue-1).fill(Z)))),ue-=1,X.pop();for(var le=0;le<ue;le++)X[le].pop()}else if(ue===2||g(T(X[ue-2][ue-3]),O)){Y=0;var ie=_(X[ue-2][ue-2],X[ue-2][ue-1],X[ue-1][ue-2],X[ue-1][ue-1]);re.push(...ie),V&&(K.unshift(y(X[ue-2][ue-2],X[ue-2][ue-1],X[ue-1][ue-2],X[ue-1][ue-1],ie[0],ie[1],O,N)),w(G,I),te=R(te,G),ue>2&&(G=i(Array(ue-2).fill(Z)))),ue-=2,X.pop(),X.pop();for(var se=0;se<ue;se++)X[se].pop(),X[se].pop()}if(ue===0)break}if(re.sort((he,be)=>+t(T(he),T(be))),Y>100){var xe=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+re.join(", "));throw xe.values=re,xe.vectors=[],xe}var oe=V?R(te,d(K,I)):void 0;return{values:re,C:oe}}function M(F,I,O,N,V,H,j){var Z=n(O),X=R(Z,F,O),re=j==="BigNumber",ue=j==="Complex",K=re?e(0):ue?s(0):0,te=re?e(1):ue?s(1):1,G=[],Y=[];for(var ee of V){var ne=C(G,ee,o);ne===-1?(G.push(ee),Y.push(1)):Y[ne]+=1}for(var J=[],q=G.length,ae=Array(I).fill(K),le=i(Array(I).fill(te)),ie=[],se=function(be){var me=G[be],_e=t(X,R(me,le)),Se=f(_e,ae);for(Se.shift();Se.length<Y[be];){var De=S(_e,I,Se,H,j);if(De==null){ie.push(me);break}Se.push(De)}var Ie=R(n(N),O);Se=Se.map(Te=>R(Ie,Te)),J.push(...Se.map(Te=>P(Te)))},xe=0;xe<q;xe++)se(xe);if(ie.length!==0){var oe=new Error("Failed to find eigenvectors for the following eigenvalues: "+ie.join(", "));throw oe.values=V,oe.vectors=J,oe}return J}function _(F,I,O,N){var V=ge(F,N),H=t(h(F,N),h(I,O)),j=h(V,.5),Z=h(A(t(h(V,V),h(4,H))),.5);return[ge(j,Z),t(j,Z)]}function y(F,I,O,N,V,H,j,Z){var X=Z==="BigNumber",re=Z==="Complex",ue=X?e(0):re?s(0):0,K=X?e(1):re?s(1):1;if(g(T(O),j))return[[K,ue],[ue,K]];if(m(T(t(V,H)),j))return[[t(V,N),t(H,N)],[O,O]];var te=t(F,V),G=t(I,V),Y=t(O,V),ee=t(N,V);return g(T(G),j)?[[te,K],[Y,ue]]:[[G,ue],[ee,K]]}function w(F,I){for(var O=0;O<F.length;O++)F[O].push(...Array(I-F[O].length).fill(0));for(var N=F.length;N<I;N++)F.push(Array(I).fill(0)),F[N][N]=1;return F}function d(F,I){for(var O=[],N=0;N<I;N++)O[N]=Array(I).fill(0);var V=0;for(var H of F){for(var j=H.length,Z=0;Z<j;Z++)for(var X=0;X<j;X++)O[V+Z][V+X]=H[Z][X];V+=j}return O}function C(F,I,O){for(var N=0;N<F.length;N++)if(O(F[N],I))return N;return-1}function S(F,I,O,N,V){for(var H=V==="BigNumber"?e(1e3):1e3,j,Z=0;j=E(I,O,V),j=r(F,j),!m(B(j),H);)if(++Z>=5)return null;for(Z=0;;){var X=r(F,j);if(g(B(k(j,[X])),N))break;if(++Z>=10)return null;j=z(X)}return j}function E(F,I,O){var N=O==="BigNumber",V=O==="Complex",H=Array(F).fill(0).map(j=>2*Math.random()-1);return N&&(H=H.map(j=>e(j))),V&&(H=H.map(j=>s(j))),H=k(H,I),z(H,O)}function k(F,I){for(var O of I)F=t(F,R(u(v(O,F),v(O,O)),O));return F}function B(F){return T(A(v(F,F)))}function z(F,I){var O=I==="BigNumber",N=I==="Complex",V=O?e(1):N?s(1):1;return R(u(V,B(F)),F)}return x}function k3(ye){var{config:ge,addScalar:t,subtract:P,abs:R,atan:h,cos:u,sin:A,multiplyScalar:T,inv:e,bignumber:i,multiply:n,add:a}=ye;function r(_,y){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ge.epsilon,d=arguments.length>3?arguments[3]:void 0;if(d==="number")return f(_,w);if(d==="BigNumber")return o(_,w);throw TypeError("Unsupported data type: "+d)}function f(_,y){for(var w=_.length,d=Math.abs(y/w),C,S=new Array(w),E=0;E<w;E++)S[E]=M(w,0),S[E][E]=1;for(var k=l(_);Math.abs(k[1])>=Math.abs(d);){var B=k[0][0],z=k[0][1];C=s(_[B][B],_[z][z],_[B][z]),_=x(_,C,B,z),S=g(S,C,B,z),k=l(_)}for(var F=M(w,0),I=0;I<w;I++)F[I]=_[I][I];return c(yo(F),yo(S))}function o(_,y){for(var w=_.length,d=R(y/w),C,S=new Array(w),E=0;E<w;E++)S[E]=M(w,0),S[E][E]=1;for(var k=b(_);R(k[1])>=R(d);){var B=k[0][0],z=k[0][1];C=m(_[B][B],_[z][z],_[B][z]),_=v(_,C,B,z),S=p(S,C,B,z),k=b(_)}for(var F=M(w,0),I=0;I<w;I++)F[I]=_[I][I];return c(yo(F),yo(S))}function s(_,y,w){var d=y-_;return Math.abs(d)<=ge.epsilon?Math.PI/4:.5*Math.atan(2*w/(y-_))}function m(_,y,w){var d=P(y,_);return R(d)<=ge.epsilon?i(-1).acos().div(4):T(.5,h(n(2,w,e(d))))}function g(_,y,w,d){for(var C=_.length,S=Math.cos(y),E=Math.sin(y),k=M(C,0),B=M(C,0),z=0;z<C;z++)k[z]=S*_[z][w]-E*_[z][d],B[z]=E*_[z][w]+S*_[z][d];for(var F=0;F<C;F++)_[F][w]=k[F],_[F][d]=B[F];return _}function p(_,y,w,d){for(var C=_.length,S=u(y),E=A(y),k=M(C,i(0)),B=M(C,i(0)),z=0;z<C;z++)k[z]=P(T(S,_[z][w]),T(E,_[z][d])),B[z]=t(T(E,_[z][w]),T(S,_[z][d]));for(var F=0;F<C;F++)_[F][w]=k[F],_[F][d]=B[F];return _}function v(_,y,w,d){for(var C=_.length,S=i(u(y)),E=i(A(y)),k=T(S,S),B=T(E,E),z=M(C,i(0)),F=M(C,i(0)),I=n(i(2),S,E,_[w][d]),O=t(P(T(k,_[w][w]),I),T(B,_[d][d])),N=a(T(B,_[w][w]),I,T(k,_[d][d])),V=0;V<C;V++)z[V]=P(T(S,_[w][V]),T(E,_[d][V])),F[V]=t(T(E,_[w][V]),T(S,_[d][V]));_[w][w]=O,_[d][d]=N,_[w][d]=i(0),_[d][w]=i(0);for(var H=0;H<C;H++)H!==w&&H!==d&&(_[w][H]=z[H],_[H][w]=z[H],_[d][H]=F[H],_[H][d]=F[H]);return _}function x(_,y,w,d){for(var C=_.length,S=Math.cos(y),E=Math.sin(y),k=S*S,B=E*E,z=M(C,0),F=M(C,0),I=k*_[w][w]-2*S*E*_[w][d]+B*_[d][d],O=B*_[w][w]+2*S*E*_[w][d]+k*_[d][d],N=0;N<C;N++)z[N]=S*_[w][N]-E*_[d][N],F[N]=E*_[w][N]+S*_[d][N];_[w][w]=I,_[d][d]=O,_[w][d]=0,_[d][w]=0;for(var V=0;V<C;V++)V!==w&&V!==d&&(_[w][V]=z[V],_[V][w]=z[V],_[d][V]=F[V],_[V][d]=F[V]);return _}function l(_){for(var y=_.length,w=0,d=[0,1],C=0;C<y;C++)for(var S=C+1;S<y;S++)Math.abs(w)<Math.abs(_[C][S])&&(w=Math.abs(_[C][S]),d=[C,S]);return[d,w]}function b(_){for(var y=_.length,w=0,d=[0,1],C=0;C<y;C++)for(var S=C+1;S<y;S++)R(w)<R(_[C][S])&&(w=R(_[C][S]),d=[C,S]);return[d,w]}function c(_,y){for(var w=_.length,d=Array(w),C=Array(w),S=0;S<w;S++)C[S]=Array(w);for(var E=0;E<w;E++){for(var k=0,B=_[0],z=0;z<_.length;z++)R(_[z])<R(B)&&(k=z,B=_[k]);d[E]=_.splice(k,1)[0];for(var F=0;F<w;F++)C[F][E]=y[F][k],y[F].splice(k,1)}return{values:d,vectors:C}}function M(_,y){for(var w=new Array(_),d=0;d<_;d++)w[d]=y;return w}return r}var D3="eigs",L3=["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],P3=Wa(D3,L3,ye=>{var{config:ge,typed:t,matrix:P,addScalar:R,subtract:h,equal:u,abs:A,atan:T,cos:e,sin:i,multiplyScalar:n,divideScalar:a,inv:r,bignumber:f,multiply:o,add:s,larger:m,column:g,flatten:p,number:v,complex:x,sqrt:l,diag:b,qr:c,usolve:M,usolveAll:_,im:y,re:w,smaller:d,matrixFromColumns:C,dot:S}=ye,E=k3({config:ge,addScalar:R,subtract:h,column:g,flatten:p,equal:u,abs:A,atan:T,cos:e,sin:i,multiplyScalar:n,inv:r,bignumber:f,complex:x,multiply:o,add:s}),k=C3({config:ge,addScalar:R,subtract:h,multiply:o,multiplyScalar:n,flatten:p,divideScalar:a,sqrt:l,abs:A,bignumber:f,diag:b,qr:c,inv:r,usolve:M,usolveAll:_,equal:u,complex:x,larger:m,smaller:d,matrixFromColumns:C,dot:S});return t("eigs",{Array:function(V){var H=P(V);return B(H)},"Array, number|BigNumber":function(V,H){var j=P(V);return B(j,H)},Matrix:function(V){var{values:H,vectors:j}=B(V);return{values:P(H),vectors:P(j)}},"Matrix, number|BigNumber":function(V,H){var{values:j,vectors:Z}=B(V,H);return{values:P(j),vectors:P(Z)}}});function B(N,V){V===void 0&&(V=ge.epsilon);var H=N.size();if(H.length!==2||H[0]!==H[1])throw new RangeError("Matrix must be square (size: "+ns(H)+")");var j=N.toArray(),Z=H[0];if(F(j,Z,V)&&(I(j,Z),z(j,Z,V))){var X=O(N,j,Z);return E(j,Z,V,X)}var re=O(N,j,Z);return k(j,Z,V,re)}function z(N,V,H){for(var j=0;j<V;j++)for(var Z=j;Z<V;Z++)if(m(f(A(h(N[j][Z],N[Z][j]))),H))return!1;return!0}function F(N,V,H){for(var j=0;j<V;j++)for(var Z=0;Z<V;Z++)if(m(f(A(y(N[j][Z]))),H))return!1;return!0}function I(N,V){for(var H=0;H<V;H++)for(var j=0;j<V;j++)N[H][j]=w(N[H][j])}function O(N,V,H){var j=N.datatype();if(j==="number"||j==="BigNumber"||j==="Complex")return j;for(var Z=!1,X=!1,re=!1,ue=0;ue<H;ue++)for(var K=0;K<H;K++){var te=V[ue][K];if(as(te)||Yp(te))Z=!0;else if(ul(te))X=!0;else if(Gp(te))re=!0;else throw TypeError("Unsupported type in Matrix: "+ac(te))}if(X&&re&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),re){for(var G=0;G<H;G++)for(var Y=0;Y<H;Y++)V[G][Y]=x(V[G][Y]);return"Complex"}if(X){for(var ee=0;ee<H;ee++)for(var ne=0;ne<H;ne++)V[ee][ne]=f(V[ee][ne]);return"BigNumber"}if(Z){for(var J=0;J<H;J++)for(var q=0;q<H;q++)V[J][q]=v(V[J][q]);return"number"}else throw TypeError("Matrix contains unsupported types only.")}}),Uh=N2({config:yu}),Kp=V2({}),Qp=Y2({}),$p=Z2({}),ru=K2({Matrix:$p}),Mi=Vb({BigNumber:Uh,Complex:Kp,DenseMatrix:ru,Fraction:Qp}),qg=E_({typed:Mi}),_c=k_({typed:Mi}),F3=v3({typed:Mi}),qp=v_({BigNumber:Uh,typed:Mi}),ed=g_({Complex:Kp,typed:Mi}),ey=dw({typed:Mi}),wc=r_({config:yu,typed:Mi}),R3=yw({typed:Mi}),ty=q2({typed:Mi}),fh=rw({typed:Mi}),ry=f_({typed:Mi}),I3=xw({typed:Mi}),z3=ow({BigNumber:Uh,Fraction:Qp,complex:ed,typed:Mi}),B3=y3({typed:Mi}),Zv=i_({Matrix:$p,equalScalar:wc,typed:Mi}),N3=d3({typed:Mi}),ny=uw({Complex:Kp,config:yu,typed:Mi}),jv=M_({typed:Mi}),O3=x_({Fraction:Qp,typed:Mi}),hs=__({DenseMatrix:ru,Matrix:$p,SparseMatrix:Zv,typed:Mi}),U3=Bw({bignumber:qp,fraction:O3,number:ry}),ay=Pw({matrix:hs,config:yu,typed:Mi}),td=jw({DenseMatrix:ru,config:yu,matrix:hs,typed:Mi}),Vh=cw({DenseMatrix:ru,addScalar:_c,equalScalar:wc,matrix:hs,typed:Mi,unaryMinus:jv}),V3=Rw({BigNumber:Uh,config:yu,matrix:hs,typed:Mi}),H3=Tw({DenseMatrix:ru,SparseMatrix:Zv,matrix:hs,typed:Mi}),ch=Ow({numeric:U3,typed:Mi}),iy=Ww({DenseMatrix:ru,equalScalar:wc,matrix:hs,typed:Mi}),oy=Mw({matrix:hs,typed:Mi}),G3=n3({DenseMatrix:ru,config:yu,matrix:hs,typed:Mi}),Y3=T_({flatten:oy,matrix:hs,size:ay,typed:Mi}),W3=Qw({DenseMatrix:ru,config:yu,matrix:hs,typed:Mi}),X3=Vw({DenseMatrix:ru,divideScalar:ch,equalScalar:wc,matrix:hs,multiplyScalar:fh,subtract:Vh,typed:Mi}),Z3=x3({DenseMatrix:ru,SparseMatrix:Zv,addScalar:_c,equalScalar:wc,matrix:hs,typed:Mi}),sy=_3({addScalar:_c,conj:ey,multiplyScalar:fh,size:ay,typed:Mi}),ly=Ew({BigNumber:Uh,DenseMatrix:ru,SparseMatrix:Zv,config:yu,matrix:hs,typed:Mi}),uy=e3({DenseMatrix:ru,config:yu,matrix:hs,typed:Mi}),rd=aw({addScalar:_c,dot:sy,equalScalar:wc,matrix:hs,multiplyScalar:fh,typed:Mi}),j3=T3({addScalar:_c,complex:ed,conj:ey,divideScalar:ch,equal:iy,identity:ly,isZero:ty,matrix:hs,multiplyScalar:fh,sign:z3,sqrt:ny,subtract:Vh,typed:Mi,unaryMinus:jv,zeros:V3}),J3=Dw({bignumber:qp,matrix:hs,config:yu,larger:uy,largerEq:G3,smaller:td,smallerEq:W3,typed:Mi}),K3=Gw({DenseMatrix:ru,divideScalar:ch,equalScalar:wc,matrix:hs,multiplyScalar:fh,subtract:Vh,typed:Mi}),Q3=M3({divideScalar:ch,isZero:ty,matrix:hs,multiply:rd,subtract:Vh,typed:Mi,unaryMinus:jv}),$3=s3({DenseMatrix:ru,smaller:td}),q3=f3({ImmutableDenseMatrix:$3}),e5=_w({Index:q3,matrix:hs,range:J3,typed:Mi}),t5=E3({abs:qg,addScalar:_c,det:Q3,divideScalar:ch,identity:ly,matrix:hs,multiply:rd,typed:Mi,unaryMinus:jv}),r5=P3({abs:qg,add:Z3,addScalar:_c,atan:F3,bignumber:qp,column:e5,complex:ed,config:yu,cos:N3,diag:H3,divideScalar:ch,dot:sy,equal:iy,flatten:oy,im:R3,inv:t5,larger:uy,matrix:hs,matrixFromColumns:Y3,multiply:rd,multiplyScalar:fh,number:ry,qr:j3,re:I3,sin:B3,smaller:td,sqrt:ny,subtract:Vh,typed:Mi,usolve:X3,usolveAll:K3});function n5(ye){let ge=ye.map(e=>e[e.length-1]),t=ye.map(e=>e.slice(0,-1)),P=s5(t),R=a5(P),h=i5(R),u=o5(h),A=R.mmul(u.vectors),T={fractionsExplained:{byX:u.values[1],byY:u.values[0]},x:[],y:[],name:[]};return A.to2DArray().forEach((e,i)=>{T.x[i]=e[1],T.y[i]=e[0],T.name[i]=ge[i]}),T}function a5(ye){if(!ye instanceof Pi)throw"matrixDataset should be an instance of a Matrix";for(let ge=0;ge<ye.columns;ge++){let t=ye.getColumnVector(ge);t.sub(t.mean()),t.divide(t.standardDeviation()),ye.setColumn(ge,t)}return ye}function i5(ye){return Bx(ye)}function o5(ye){let ge=r5(ye.to2DArray()),t=ge.vectors.length-1;return{values:[ge.values[t],ge.values[t-1]],vectors:new Pi([ge.vectors[t],ge.vectors[t-1]]).transpose()}}function s5(ye){return new Pi(ye)}function xv(ye){throw new Error('Could not dynamically require "'+ye+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fy={exports:{}};(function(ye,ge){(function(t){ye.exports=t()})(function(){return function(){function t(P,R,h){function u(e,i){if(!R[e]){if(!P[e]){var n=typeof xv=="function"&&xv;if(!i&&n)return n(e,!0);if(A)return A(e,!0);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}var r=R[e]={exports:{}};P[e][0].call(r.exports,function(f){var o=P[e][1][f];return u(o||f)},r,r.exports,t,P,R,h)}return R[e].exports}for(var A=typeof xv=="function"&&xv,T=0;T<h.length;T++)u(h[T]);return u}return t}()({1:[function(t,P,R){var h=t("../src/lib"),u={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:rgba(0,0,0,0);border:6px solid rgba(0,0,0,0);z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid rgba(0,0,0,0);border-left-color:#69738a;margin-top:8px;margin-right:-30px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var A in u){var T=A.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");h.addStyleRule(T,u[A])}},{"../src/lib":515}],2:[function(t,P,R){P.exports=t("../src/transforms/aggregate")},{"../src/transforms/aggregate":1127}],3:[function(t,P,R){P.exports=t("../src/traces/bar")},{"../src/traces/bar":665}],4:[function(t,P,R){P.exports=t("../src/traces/barpolar")},{"../src/traces/barpolar":678}],5:[function(t,P,R){P.exports=t("../src/traces/box")},{"../src/traces/box":688}],6:[function(t,P,R){P.exports=t("../src/components/calendars")},{"../src/components/calendars":365}],7:[function(t,P,R){P.exports=t("../src/traces/candlestick")},{"../src/traces/candlestick":697}],8:[function(t,P,R){P.exports=t("../src/traces/carpet")},{"../src/traces/carpet":716}],9:[function(t,P,R){P.exports=t("../src/traces/choropleth")},{"../src/traces/choropleth":730}],10:[function(t,P,R){P.exports=t("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":737}],11:[function(t,P,R){P.exports=t("../src/traces/cone")},{"../src/traces/cone":743}],12:[function(t,P,R){P.exports=t("../src/traces/contour")},{"../src/traces/contour":758}],13:[function(t,P,R){P.exports=t("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":769}],14:[function(t,P,R){P.exports=t("../src/core")},{"../src/core":493}],15:[function(t,P,R){P.exports=t("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":777}],16:[function(t,P,R){P.exports=t("../src/transforms/filter")},{"../src/transforms/filter":1128}],17:[function(t,P,R){P.exports=t("../src/traces/funnel")},{"../src/traces/funnel":787}],18:[function(t,P,R){P.exports=t("../src/traces/funnelarea")},{"../src/traces/funnelarea":796}],19:[function(t,P,R){P.exports=t("../src/transforms/groupby")},{"../src/transforms/groupby":1129}],20:[function(t,P,R){P.exports=t("../src/traces/heatmap")},{"../src/traces/heatmap":809}],21:[function(t,P,R){P.exports=t("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":820}],22:[function(t,P,R){P.exports=t("../src/traces/histogram")},{"../src/traces/histogram":832}],23:[function(t,P,R){P.exports=t("../src/traces/histogram2d")},{"../src/traces/histogram2d":838}],24:[function(t,P,R){P.exports=t("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":842}],25:[function(t,P,R){P.exports=t("../src/traces/icicle")},{"../src/traces/icicle":848}],26:[function(t,P,R){P.exports=t("../src/traces/image")},{"../src/traces/image":861}],27:[function(t,P,R){var h=t("./core");h.register([t("./bar"),t("./box"),t("./heatmap"),t("./histogram"),t("./histogram2d"),t("./histogram2dcontour"),t("./contour"),t("./scatterternary"),t("./violin"),t("./funnel"),t("./waterfall"),t("./image"),t("./pie"),t("./sunburst"),t("./treemap"),t("./icicle"),t("./funnelarea"),t("./scatter3d"),t("./surface"),t("./isosurface"),t("./volume"),t("./mesh3d"),t("./cone"),t("./streamtube"),t("./scattergeo"),t("./choropleth"),t("./scattergl"),t("./splom"),t("./pointcloud"),t("./heatmapgl"),t("./parcoords"),t("./parcats"),t("./scattermapbox"),t("./choroplethmapbox"),t("./densitymapbox"),t("./sankey"),t("./indicator"),t("./table"),t("./carpet"),t("./scattercarpet"),t("./contourcarpet"),t("./ohlc"),t("./candlestick"),t("./scatterpolar"),t("./scatterpolargl"),t("./barpolar"),t("./scattersmith"),t("./aggregate"),t("./filter"),t("./groupby"),t("./sort"),t("./calendars")]),P.exports=h},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(t,P,R){P.exports=t("../src/traces/indicator")},{"../src/traces/indicator":869}],29:[function(t,P,R){P.exports=t("../src/traces/isosurface")},{"../src/traces/isosurface":875}],30:[function(t,P,R){P.exports=t("../src/traces/mesh3d")},{"../src/traces/mesh3d":880}],31:[function(t,P,R){P.exports=t("../src/traces/ohlc")},{"../src/traces/ohlc":885}],32:[function(t,P,R){P.exports=t("../src/traces/parcats")},{"../src/traces/parcats":894}],33:[function(t,P,R){P.exports=t("../src/traces/parcoords")},{"../src/traces/parcoords":905}],34:[function(t,P,R){P.exports=t("../src/traces/pie")},{"../src/traces/pie":916}],35:[function(t,P,R){P.exports=t("../src/traces/pointcloud")},{"../src/traces/pointcloud":925}],36:[function(t,P,R){P.exports=t("../src/traces/sankey")},{"../src/traces/sankey":931}],37:[function(t,P,R){P.exports=t("../src/traces/scatter3d")},{"../src/traces/scatter3d":969}],38:[function(t,P,R){P.exports=t("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":976}],39:[function(t,P,R){P.exports=t("../src/traces/scattergeo")},{"../src/traces/scattergeo":984}],40:[function(t,P,R){P.exports=t("../src/traces/scattergl")},{"../src/traces/scattergl":998}],41:[function(t,P,R){P.exports=t("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1008}],42:[function(t,P,R){P.exports=t("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1016}],43:[function(t,P,R){P.exports=t("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1024}],44:[function(t,P,R){P.exports=t("../src/traces/scattersmith")},{"../src/traces/scattersmith":1031}],45:[function(t,P,R){P.exports=t("../src/traces/scatterternary")},{"../src/traces/scatterternary":1039}],46:[function(t,P,R){P.exports=t("../src/transforms/sort")},{"../src/transforms/sort":1131}],47:[function(t,P,R){P.exports=t("../src/traces/splom")},{"../src/traces/splom":1049}],48:[function(t,P,R){P.exports=t("../src/traces/streamtube")},{"../src/traces/streamtube":1057}],49:[function(t,P,R){P.exports=t("../src/traces/sunburst")},{"../src/traces/sunburst":1065}],50:[function(t,P,R){P.exports=t("../src/traces/surface")},{"../src/traces/surface":1074}],51:[function(t,P,R){P.exports=t("../src/traces/table")},{"../src/traces/table":1082}],52:[function(t,P,R){P.exports=t("../src/traces/treemap")},{"../src/traces/treemap":1093}],53:[function(t,P,R){P.exports=t("../src/traces/violin")},{"../src/traces/violin":1106}],54:[function(t,P,R){P.exports=t("../src/traces/volume")},{"../src/traces/volume":1114}],55:[function(t,P,R){P.exports=t("../src/traces/waterfall")},{"../src/traces/waterfall":1122}],56:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R,t("d3-array"),t("d3-collection"),t("d3-shape"),t("elementary-circuits-directed-graph")):u(h.d3=h.d3||{},h.d3,h.d3,h.d3,null)})(this,function(h,u,A,T,e){e=e&&e.hasOwnProperty("default")?e.default:e;function i(oe){return oe.target.depth}function n(oe){return oe.depth}function a(oe,he){return he-1-oe.height}function r(oe,he){return oe.sourceLinks.length?oe.depth:he-1}function f(oe){return oe.targetLinks.length?oe.depth:oe.sourceLinks.length?u.min(oe.sourceLinks,i)-1:0}function o(oe){return function(){return oe}}var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(oe){return typeof oe}:function(oe){return oe&&typeof Symbol=="function"&&oe.constructor===Symbol&&oe!==Symbol.prototype?"symbol":typeof oe};function m(oe,he){return p(oe.source,he.source)||oe.index-he.index}function g(oe,he){return p(oe.target,he.target)||oe.index-he.index}function p(oe,he){return oe.partOfCycle===he.partOfCycle?oe.y0-he.y0:oe.circularLinkType==="top"||he.circularLinkType==="bottom"?-1:1}function v(oe){return oe.value}function x(oe){return(oe.y0+oe.y1)/2}function l(oe){return x(oe.source)}function b(oe){return x(oe.target)}function c(oe){return oe.index}function M(oe){return oe.nodes}function _(oe){return oe.links}function y(oe,he){var be=oe.get(he);if(!be)throw new Error("missing: "+he);return be}function w(oe,he){return he(oe)}var d=25,C=10,S=.3;function E(){var oe=0,he=0,be=1,me=1,_e=24,Se,De=c,Ie=r,Te=M,Ce=_,He=32,Xe=2,Be,Re=null;function We(){var Ct={nodes:Te.apply(null,arguments),links:Ce.apply(null,arguments)};vt(Ct),k(Ct,De,Re),Pt(Ct),At(Ct),B(Ct,De),Wt(Ct,He,De),Bt(Ct);for(var Ze=4,nt=0;nt<Ze;nt++)q(Ct,me,De),ae(Ct,me,De),ee(Ct,he,me,De),q(Ct,me,De),ae(Ct,me,De);return xe(Ct,he,me),V(Ct,Xe,me,De),Ct}We.nodeId=function(Ct){return arguments.length?(De=typeof Ct=="function"?Ct:o(Ct),We):De},We.nodeAlign=function(Ct){return arguments.length?(Ie=typeof Ct=="function"?Ct:o(Ct),We):Ie},We.nodeWidth=function(Ct){return arguments.length?(_e=+Ct,We):_e},We.nodePadding=function(Ct){return arguments.length?(Se=+Ct,We):Se},We.nodes=function(Ct){return arguments.length?(Te=typeof Ct=="function"?Ct:o(Ct),We):Te},We.links=function(Ct){return arguments.length?(Ce=typeof Ct=="function"?Ct:o(Ct),We):Ce},We.size=function(Ct){return arguments.length?(oe=he=0,be=+Ct[0],me=+Ct[1],We):[be-oe,me-he]},We.extent=function(Ct){return arguments.length?(oe=+Ct[0][0],be=+Ct[1][0],he=+Ct[0][1],me=+Ct[1][1],We):[[oe,he],[be,me]]},We.iterations=function(Ct){return arguments.length?(He=+Ct,We):He},We.circularLinkGap=function(Ct){return arguments.length?(Xe=+Ct,We):Xe},We.nodePaddingRatio=function(Ct){return arguments.length?(Be=+Ct,We):Be},We.sortNodes=function(Ct){return arguments.length?(Re=Ct,We):Re},We.update=function(Ct){return B(Ct,De),Bt(Ct),Ct.links.forEach(function(Ze){Ze.circular&&(Ze.circularLinkType=Ze.y0+Ze.y1<me?"top":"bottom",Ze.source.circularLinkType=Ze.circularLinkType,Ze.target.circularLinkType=Ze.circularLinkType)}),q(Ct,me,De,!1),ae(Ct,me,De),V(Ct,Xe,me,De),Ct};function vt(Ct){Ct.nodes.forEach(function(nt,Ye){nt.index=Ye,nt.sourceLinks=[],nt.targetLinks=[]});var Ze=A.map(Ct.nodes,De);return Ct.links.forEach(function(nt,Ye){nt.index=Ye;var Ee=nt.source,Ge=nt.target;(typeof Ee>"u"?"undefined":s(Ee))!=="object"&&(Ee=nt.source=y(Ze,Ee)),(typeof Ge>"u"?"undefined":s(Ge))!=="object"&&(Ge=nt.target=y(Ze,Ge)),Ee.sourceLinks.push(nt),Ge.targetLinks.push(nt)}),Ct}function Pt(Ct){Ct.nodes.forEach(function(Ze){Ze.partOfCycle=!1,Ze.value=Math.max(u.sum(Ze.sourceLinks,v),u.sum(Ze.targetLinks,v)),Ze.sourceLinks.forEach(function(nt){nt.circular&&(Ze.partOfCycle=!0,Ze.circularLinkType=nt.circularLinkType)}),Ze.targetLinks.forEach(function(nt){nt.circular&&(Ze.partOfCycle=!0,Ze.circularLinkType=nt.circularLinkType)})})}function Zt(Ct){var Ze=0,nt=0,Ye=0,Ee=0,Ge=u.max(Ct.nodes,function(Je){return Je.column});return Ct.links.forEach(function(Je){Je.circular&&(Je.circularLinkType=="top"?Ze=Ze+Je.width:nt=nt+Je.width,Je.target.column==0&&(Ee=Ee+Je.width),Je.source.column==Ge&&(Ye=Ye+Je.width))}),Ze=Ze>0?Ze+d+C:Ze,nt=nt>0?nt+d+C:nt,Ye=Ye>0?Ye+d+C:Ye,Ee=Ee>0?Ee+d+C:Ee,{top:Ze,bottom:nt,left:Ee,right:Ye}}function zt(Ct,Ze){var nt=u.max(Ct.nodes,function(mt){return mt.column}),Ye=be-oe,Ee=me-he,Ge=Ye+Ze.right+Ze.left,Je=Ee+Ze.top+Ze.bottom,qe=Ye/Ge,Tt=Ee/Je;return oe=oe*qe+Ze.left,be=Ze.right==0?be:be*qe,he=he*Tt+Ze.top,me=me*Tt,Ct.nodes.forEach(function(mt){mt.x0=oe+mt.column*((be-oe-_e)/nt),mt.x1=mt.x0+_e}),Tt}function At(Ct){var Ze,nt,Ye;for(Ze=Ct.nodes,nt=[],Ye=0;Ze.length;++Ye,Ze=nt,nt=[])Ze.forEach(function(Ee){Ee.depth=Ye,Ee.sourceLinks.forEach(function(Ge){nt.indexOf(Ge.target)<0&&!Ge.circular&&nt.push(Ge.target)})});for(Ze=Ct.nodes,nt=[],Ye=0;Ze.length;++Ye,Ze=nt,nt=[])Ze.forEach(function(Ee){Ee.height=Ye,Ee.targetLinks.forEach(function(Ge){nt.indexOf(Ge.source)<0&&!Ge.circular&&nt.push(Ge.source)})});Ct.nodes.forEach(function(Ee){Ee.column=Math.floor(Ie.call(null,Ee,Ye))})}function Wt(Ct,Ze,nt){var Ye=A.nest().key(function(mt){return mt.column}).sortKeys(u.ascending).entries(Ct.nodes).map(function(mt){return mt.values});Je(nt),Tt();for(var Ee=1,Ge=Ze;Ge>0;--Ge)qe(Ee*=.99,nt),Tt();function Je(mt){if(Be){var Mt=1/0;Ye.forEach(function(Jt){var Yt=me*Be/(Jt.length+1);Mt=Yt<Mt?Yt:Mt}),Se=Mt}var Ht=u.min(Ye,function(Jt){return(me-he-(Jt.length-1)*Se)/u.sum(Jt,v)});Ht=Ht*S,Ct.links.forEach(function(Jt){Jt.width=Jt.value*Ht});var Rt=Zt(Ct),Vt=zt(Ct,Rt);Ht=Ht*Vt,Ct.links.forEach(function(Jt){Jt.width=Jt.value*Ht}),Ye.forEach(function(Jt){var Yt=Jt.length;Jt.forEach(function(or,Hr){or.depth==Ye.length-1&&Yt==1||or.depth==0&&Yt==1?(or.y0=me/2-or.value*Ht,or.y1=or.y0+or.value*Ht):or.partOfCycle?I(or,mt)==0?(or.y0=me/2+Hr,or.y1=or.y0+or.value*Ht):or.circularLinkType=="top"?(or.y0=he+Hr,or.y1=or.y0+or.value*Ht):(or.y0=me-or.value*Ht-Hr,or.y1=or.y0+or.value*Ht):Rt.top==0||Rt.bottom==0?(or.y0=(me-he)/Yt*Hr,or.y1=or.y0+or.value*Ht):(or.y0=(me-he)/2-Yt/2+Hr,or.y1=or.y0+or.value*Ht)})})}function qe(mt,Mt){var Ht=Ye.length;Ye.forEach(function(Rt){var Vt=Rt.length,Jt=Rt[0].depth;Rt.forEach(function(Yt){var or;if((Yt.sourceLinks.length||Yt.targetLinks.length)&&!(Yt.partOfCycle&&I(Yt,Mt)>0))if(Jt==0&&Vt==1)or=Yt.y1-Yt.y0,Yt.y0=me/2-or/2,Yt.y1=me/2+or/2;else if(Jt==Ht-1&&Vt==1)or=Yt.y1-Yt.y0,Yt.y0=me/2-or/2,Yt.y1=me/2+or/2;else{var Hr=0,an=u.mean(Yt.sourceLinks,b),Kr=u.mean(Yt.targetLinks,l);an&&Kr?Hr=(an+Kr)/2:Hr=an||Kr;var ot=(Hr-x(Yt))*mt;Yt.y0+=ot,Yt.y1+=ot}})})}function Tt(){Ye.forEach(function(mt){var Mt,Ht,Rt=he,Vt=mt.length,Jt;for(mt.sort(p),Jt=0;Jt<Vt;++Jt)Mt=mt[Jt],Ht=Rt-Mt.y0,Ht>0&&(Mt.y0+=Ht,Mt.y1+=Ht),Rt=Mt.y1+Se;if(Ht=Rt-Se-me,Ht>0)for(Rt=Mt.y0-=Ht,Mt.y1-=Ht,Jt=Vt-2;Jt>=0;--Jt)Mt=mt[Jt],Ht=Mt.y1+Se-Rt,Ht>0&&(Mt.y0-=Ht,Mt.y1-=Ht),Rt=Mt.y0})}}function Bt(Ct){Ct.nodes.forEach(function(Ze){Ze.sourceLinks.sort(g),Ze.targetLinks.sort(m)}),Ct.nodes.forEach(function(Ze){var nt=Ze.y0,Ye=nt,Ee=Ze.y1,Ge=Ee;Ze.sourceLinks.forEach(function(Je){Je.circular?(Je.y0=Ee-Je.width/2,Ee=Ee-Je.width):(Je.y0=nt+Je.width/2,nt+=Je.width)}),Ze.targetLinks.forEach(function(Je){Je.circular?(Je.y1=Ge-Je.width/2,Ge=Ge-Je.width):(Je.y1=Ye+Je.width/2,Ye+=Je.width)})})}return We}function k(oe,he,be){var me=0;if(be===null){for(var _e=[],Se=0;Se<oe.links.length;Se++){var De=oe.links[Se],Ie=De.source.index,Te=De.target.index;_e[Ie]||(_e[Ie]=[]),_e[Te]||(_e[Te]=[]),_e[Ie].indexOf(Te)===-1&&_e[Ie].push(Te)}var Ce=e(_e);Ce.sort(function(Re,We){return Re.length-We.length});var He={};for(Se=0;Se<Ce.length;Se++){var Xe=Ce[Se],Be=Xe.slice(-2);He[Be[0]]||(He[Be[0]]={}),He[Be[0]][Be[1]]=!0}oe.links.forEach(function(Re){var We=Re.target.index,vt=Re.source.index;We===vt||He[vt]&&He[vt][We]?(Re.circular=!0,Re.circularLinkID=me,me=me+1):Re.circular=!1})}else oe.links.forEach(function(Re){Re.source[be]<Re.target[be]?Re.circular=!1:(Re.circular=!0,Re.circularLinkID=me,me=me+1)})}function B(oe,he){var be=0,me=0;oe.links.forEach(function(_e){_e.circular&&(_e.source.circularLinkType||_e.target.circularLinkType?_e.circularLinkType=_e.source.circularLinkType?_e.source.circularLinkType:_e.target.circularLinkType:_e.circularLinkType=be<me?"top":"bottom",_e.circularLinkType=="top"?be=be+1:me=me+1,oe.nodes.forEach(function(Se){(w(Se,he)==w(_e.source,he)||w(Se,he)==w(_e.target,he))&&(Se.circularLinkType=_e.circularLinkType)}))}),oe.links.forEach(function(_e){_e.circular&&(_e.source.circularLinkType==_e.target.circularLinkType&&(_e.circularLinkType=_e.source.circularLinkType),se(_e,he)&&(_e.circularLinkType=_e.source.circularLinkType))})}function z(oe){var he=Math.abs(oe.y1-oe.y0),be=Math.abs(oe.target.x0-oe.source.x1);return Math.atan(be/he)}function F(oe,he){return oe.source.column<he.target.column?!1:!(oe.target.column>he.source.column)}function I(oe,he){var be=0;oe.sourceLinks.forEach(function(_e){be=_e.circular&&!se(_e,he)?be+1:be});var me=0;return oe.targetLinks.forEach(function(_e){me=_e.circular&&!se(_e,he)?me+1:me}),be+me}function O(oe){var he=oe.source.sourceLinks,be=0;he.forEach(function(Se){be=Se.circular?be+1:be});var me=oe.target.targetLinks,_e=0;return me.forEach(function(Se){_e=Se.circular?_e+1:_e}),!(be>1||_e>1)}function N(oe,he,be){return oe.sort(j),oe.forEach(function(me,_e){var Se=0;if(se(me,be)&&O(me))me.circularPathData.verticalBuffer=Se+me.width/2;else{var De=0;for(De;De<_e;De++)if(F(oe[_e],oe[De])){var Ie=oe[De].circularPathData.verticalBuffer+oe[De].width/2+he;Se=Ie>Se?Ie:Se}me.circularPathData.verticalBuffer=Se+me.width/2}}),oe}function V(oe,he,be,me){var _e=5,Se=u.min(oe.links,function(Te){return Te.source.y0});oe.links.forEach(function(Te){Te.circular&&(Te.circularPathData={})});var De=oe.links.filter(function(Te){return Te.circularLinkType=="top"});N(De,he,me);var Ie=oe.links.filter(function(Te){return Te.circularLinkType=="bottom"});N(Ie,he,me),oe.links.forEach(function(Te){if(Te.circular){if(Te.circularPathData.arcRadius=Te.width+C,Te.circularPathData.leftNodeBuffer=_e,Te.circularPathData.rightNodeBuffer=_e,Te.circularPathData.sourceWidth=Te.source.x1-Te.source.x0,Te.circularPathData.sourceX=Te.source.x0+Te.circularPathData.sourceWidth,Te.circularPathData.targetX=Te.target.x0,Te.circularPathData.sourceY=Te.y0,Te.circularPathData.targetY=Te.y1,se(Te,me)&&O(Te))Te.circularPathData.leftSmallArcRadius=C+Te.width/2,Te.circularPathData.leftLargeArcRadius=C+Te.width/2,Te.circularPathData.rightSmallArcRadius=C+Te.width/2,Te.circularPathData.rightLargeArcRadius=C+Te.width/2,Te.circularLinkType=="bottom"?(Te.circularPathData.verticalFullExtent=Te.source.y1+d+Te.circularPathData.verticalBuffer,Te.circularPathData.verticalLeftInnerExtent=Te.circularPathData.verticalFullExtent-Te.circularPathData.leftLargeArcRadius,Te.circularPathData.verticalRightInnerExtent=Te.circularPathData.verticalFullExtent-Te.circularPathData.rightLargeArcRadius):(Te.circularPathData.verticalFullExtent=Te.source.y0-d-Te.circularPathData.verticalBuffer,Te.circularPathData.verticalLeftInnerExtent=Te.circularPathData.verticalFullExtent+Te.circularPathData.leftLargeArcRadius,Te.circularPathData.verticalRightInnerExtent=Te.circularPathData.verticalFullExtent+Te.circularPathData.rightLargeArcRadius);else{var Ce=Te.source.column,He=Te.circularLinkType,Xe=oe.links.filter(function(We){return We.source.column==Ce&&We.circularLinkType==He});Te.circularLinkType=="bottom"?Xe.sort(X):Xe.sort(Z);var Be=0;Xe.forEach(function(We,vt){We.circularLinkID==Te.circularLinkID&&(Te.circularPathData.leftSmallArcRadius=C+Te.width/2+Be,Te.circularPathData.leftLargeArcRadius=C+Te.width/2+vt*he+Be),Be=Be+We.width}),Ce=Te.target.column,Xe=oe.links.filter(function(We){return We.target.column==Ce&&We.circularLinkType==He}),Te.circularLinkType=="bottom"?Xe.sort(ue):Xe.sort(re),Be=0,Xe.forEach(function(We,vt){We.circularLinkID==Te.circularLinkID&&(Te.circularPathData.rightSmallArcRadius=C+Te.width/2+Be,Te.circularPathData.rightLargeArcRadius=C+Te.width/2+vt*he+Be),Be=Be+We.width}),Te.circularLinkType=="bottom"?(Te.circularPathData.verticalFullExtent=Math.max(be,Te.source.y1,Te.target.y1)+d+Te.circularPathData.verticalBuffer,Te.circularPathData.verticalLeftInnerExtent=Te.circularPathData.verticalFullExtent-Te.circularPathData.leftLargeArcRadius,Te.circularPathData.verticalRightInnerExtent=Te.circularPathData.verticalFullExtent-Te.circularPathData.rightLargeArcRadius):(Te.circularPathData.verticalFullExtent=Se-d-Te.circularPathData.verticalBuffer,Te.circularPathData.verticalLeftInnerExtent=Te.circularPathData.verticalFullExtent+Te.circularPathData.leftLargeArcRadius,Te.circularPathData.verticalRightInnerExtent=Te.circularPathData.verticalFullExtent+Te.circularPathData.rightLargeArcRadius)}Te.circularPathData.leftInnerExtent=Te.circularPathData.sourceX+Te.circularPathData.leftNodeBuffer,Te.circularPathData.rightInnerExtent=Te.circularPathData.targetX-Te.circularPathData.rightNodeBuffer,Te.circularPathData.leftFullExtent=Te.circularPathData.sourceX+Te.circularPathData.leftLargeArcRadius+Te.circularPathData.leftNodeBuffer,Te.circularPathData.rightFullExtent=Te.circularPathData.targetX-Te.circularPathData.rightLargeArcRadius-Te.circularPathData.rightNodeBuffer}if(Te.circular)Te.path=H(Te);else{var Re=T.linkHorizontal().source(function(We){var vt=We.source.x0+(We.source.x1-We.source.x0),Pt=We.y0;return[vt,Pt]}).target(function(We){var vt=We.target.x0,Pt=We.y1;return[vt,Pt]});Te.path=Re(Te)}})}function H(oe){var he="";return oe.circularLinkType=="top"?he="M"+oe.circularPathData.sourceX+" "+oe.circularPathData.sourceY+" L"+oe.circularPathData.leftInnerExtent+" "+oe.circularPathData.sourceY+" A"+oe.circularPathData.leftLargeArcRadius+" "+oe.circularPathData.leftSmallArcRadius+" 0 0 0 "+oe.circularPathData.leftFullExtent+" "+(oe.circularPathData.sourceY-oe.circularPathData.leftSmallArcRadius)+" L"+oe.circularPathData.leftFullExtent+" "+oe.circularPathData.verticalLeftInnerExtent+" A"+oe.circularPathData.leftLargeArcRadius+" "+oe.circularPathData.leftLargeArcRadius+" 0 0 0 "+oe.circularPathData.leftInnerExtent+" "+oe.circularPathData.verticalFullExtent+" L"+oe.circularPathData.rightInnerExtent+" "+oe.circularPathData.verticalFullExtent+" A"+oe.circularPathData.rightLargeArcRadius+" "+oe.circularPathData.rightLargeArcRadius+" 0 0 0 "+oe.circularPathData.rightFullExtent+" "+oe.circularPathData.verticalRightInnerExtent+" L"+oe.circularPathData.rightFullExtent+" "+(oe.circularPathData.targetY-oe.circularPathData.rightSmallArcRadius)+" A"+oe.circularPathData.rightLargeArcRadius+" "+oe.circularPathData.rightSmallArcRadius+" 0 0 0 "+oe.circularPathData.rightInnerExtent+" "+oe.circularPathData.targetY+" L"+oe.circularPathData.targetX+" "+oe.circularPathData.targetY:he="M"+oe.circularPathData.sourceX+" "+oe.circularPathData.sourceY+" L"+oe.circularPathData.leftInnerExtent+" "+oe.circularPathData.sourceY+" A"+oe.circularPathData.leftLargeArcRadius+" "+oe.circularPathData.leftSmallArcRadius+" 0 0 1 "+oe.circularPathData.leftFullExtent+" "+(oe.circularPathData.sourceY+oe.circularPathData.leftSmallArcRadius)+" L"+oe.circularPathData.leftFullExtent+" "+oe.circularPathData.verticalLeftInnerExtent+" A"+oe.circularPathData.leftLargeArcRadius+" "+oe.circularPathData.leftLargeArcRadius+" 0 0 1 "+oe.circularPathData.leftInnerExtent+" "+oe.circularPathData.verticalFullExtent+" L"+oe.circularPathData.rightInnerExtent+" "+oe.circularPathData.verticalFullExtent+" A"+oe.circularPathData.rightLargeArcRadius+" "+oe.circularPathData.rightLargeArcRadius+" 0 0 1 "+oe.circularPathData.rightFullExtent+" "+oe.circularPathData.verticalRightInnerExtent+" L"+oe.circularPathData.rightFullExtent+" "+(oe.circularPathData.targetY+oe.circularPathData.rightSmallArcRadius)+" A"+oe.circularPathData.rightLargeArcRadius+" "+oe.circularPathData.rightSmallArcRadius+" 0 0 1 "+oe.circularPathData.rightInnerExtent+" "+oe.circularPathData.targetY+" L"+oe.circularPathData.targetX+" "+oe.circularPathData.targetY,he}function j(oe,he){return K(oe)==K(he)?oe.circularLinkType=="bottom"?X(oe,he):Z(oe,he):K(he)-K(oe)}function Z(oe,he){return oe.y0-he.y0}function X(oe,he){return he.y0-oe.y0}function re(oe,he){return oe.y1-he.y1}function ue(oe,he){return he.y1-oe.y1}function K(oe){return oe.target.column-oe.source.column}function te(oe){return oe.target.x0-oe.source.x1}function G(oe,he){var be=z(oe),me=te(he)/Math.tan(be),_e=ie(oe)=="up"?oe.y1+me:oe.y1-me;return _e}function Y(oe,he){var be=z(oe),me=te(he)/Math.tan(be),_e=ie(oe)=="up"?oe.y1-me:oe.y1+me;return _e}function ee(oe,he,be,me){oe.links.forEach(function(_e){if(!_e.circular&&_e.target.column-_e.source.column>1){var Se=_e.source.column+1,De=_e.target.column-1,Ie=1,Te=De-Se+1;for(Ie=1;Se<=De;Se++,Ie++)oe.nodes.forEach(function(Ce){if(Ce.column==Se){var He=Ie/(Te+1),Xe=Math.pow(1-He,3),Be=3*He*Math.pow(1-He,2),Re=3*Math.pow(He,2)*(1-He),We=Math.pow(He,3),vt=Xe*_e.y0+Be*_e.y0+Re*_e.y1+We*_e.y1,Pt=vt-_e.width/2,Zt=vt+_e.width/2,zt;Pt>Ce.y0&&Pt<Ce.y1?(zt=Ce.y1-Pt+10,zt=Ce.circularLinkType=="bottom"?zt:-zt,Ce=J(Ce,zt,he,be),oe.nodes.forEach(function(At){w(At,me)==w(Ce,me)||At.column!=Ce.column||ne(Ce,At)&&J(At,zt,he,be)})):Zt>Ce.y0&&Zt<Ce.y1?(zt=Zt-Ce.y0+10,Ce=J(Ce,zt,he,be),oe.nodes.forEach(function(At){w(At,me)==w(Ce,me)||At.column!=Ce.column||At.y0<Ce.y1&&At.y1>Ce.y1&&J(At,zt,he,be)})):Pt<Ce.y0&&Zt>Ce.y1&&(zt=Zt-Ce.y0+10,Ce=J(Ce,zt,he,be),oe.nodes.forEach(function(At){w(At,me)==w(Ce,me)||At.column!=Ce.column||At.y0<Ce.y1&&At.y1>Ce.y1&&J(At,zt,he,be)}))}})}})}function ne(oe,he){return oe.y0>he.y0&&oe.y0<he.y1||oe.y1>he.y0&&oe.y1<he.y1?!0:oe.y0<he.y0&&oe.y1>he.y1}function J(oe,he,be,me){return oe.y0+he>=be&&oe.y1+he<=me&&(oe.y0=oe.y0+he,oe.y1=oe.y1+he,oe.targetLinks.forEach(function(_e){_e.y1=_e.y1+he}),oe.sourceLinks.forEach(function(_e){_e.y0=_e.y0+he})),oe}function q(oe,he,be,me){oe.nodes.forEach(function(_e){me&&_e.y+(_e.y1-_e.y0)>he&&(_e.y=_e.y-(_e.y+(_e.y1-_e.y0)-he));var Se=oe.links.filter(function(Te){return w(Te.source,be)==w(_e,be)}),De=Se.length;De>1&&Se.sort(function(Te,Ce){if(!Te.circular&&!Ce.circular){if(Te.target.column==Ce.target.column)return Te.y1-Ce.y1;if(le(Te,Ce)){if(Te.target.column>Ce.target.column){var He=Y(Ce,Te);return Te.y1-He}if(Ce.target.column>Te.target.column){var Xe=Y(Te,Ce);return Xe-Ce.y1}}else return Te.y1-Ce.y1}if(Te.circular&&!Ce.circular)return Te.circularLinkType=="top"?-1:1;if(Ce.circular&&!Te.circular)return Ce.circularLinkType=="top"?1:-1;if(Te.circular&&Ce.circular)return Te.circularLinkType===Ce.circularLinkType&&Te.circularLinkType=="top"?Te.target.column===Ce.target.column?Te.target.y1-Ce.target.y1:Ce.target.column-Te.target.column:Te.circularLinkType===Ce.circularLinkType&&Te.circularLinkType=="bottom"?Te.target.column===Ce.target.column?Ce.target.y1-Te.target.y1:Te.target.column-Ce.target.column:Te.circularLinkType=="top"?-1:1});var Ie=_e.y0;Se.forEach(function(Te){Te.y0=Ie+Te.width/2,Ie=Ie+Te.width}),Se.forEach(function(Te,Ce){if(Te.circularLinkType=="bottom"){var He=Ce+1,Xe=0;for(He;He<De;He++)Xe=Xe+Se[He].width;Te.y0=_e.y1-Xe-Te.width/2}})})}function ae(oe,he,be){oe.nodes.forEach(function(me){var _e=oe.links.filter(function(Ie){return w(Ie.target,be)==w(me,be)}),Se=_e.length;Se>1&&_e.sort(function(Ie,Te){if(!Ie.circular&&!Te.circular){if(Ie.source.column==Te.source.column)return Ie.y0-Te.y0;if(le(Ie,Te)){if(Te.source.column<Ie.source.column){var Ce=G(Te,Ie);return Ie.y0-Ce}if(Ie.source.column<Te.source.column){var He=G(Ie,Te);return He-Te.y0}}else return Ie.y0-Te.y0}if(Ie.circular&&!Te.circular)return Ie.circularLinkType=="top"?-1:1;if(Te.circular&&!Ie.circular)return Te.circularLinkType=="top"?1:-1;if(Ie.circular&&Te.circular)return Ie.circularLinkType===Te.circularLinkType&&Ie.circularLinkType=="top"?Ie.source.column===Te.source.column?Ie.source.y1-Te.source.y1:Ie.source.column-Te.source.column:Ie.circularLinkType===Te.circularLinkType&&Ie.circularLinkType=="bottom"?Ie.source.column===Te.source.column?Ie.source.y1-Te.source.y1:Te.source.column-Ie.source.column:Ie.circularLinkType=="top"?-1:1});var De=me.y0;_e.forEach(function(Ie){Ie.y1=De+Ie.width/2,De=De+Ie.width}),_e.forEach(function(Ie,Te){if(Ie.circularLinkType=="bottom"){var Ce=Te+1,He=0;for(Ce;Ce<Se;Ce++)He=He+_e[Ce].width;Ie.y1=me.y1-He-Ie.width/2}})})}function le(oe,he){return ie(oe)==ie(he)}function ie(oe){return oe.y0-oe.y1>0?"up":"down"}function se(oe,he){return w(oe.source,he)==w(oe.target,he)}function xe(oe,he,be){var me=oe.nodes,_e=oe.links,Se=!1,De=!1;if(_e.forEach(function(Be){Be.circularLinkType=="top"?Se=!0:Be.circularLinkType=="bottom"&&(De=!0)}),Se==!1||De==!1){var Ie=u.min(me,function(Be){return Be.y0}),Te=u.max(me,function(Be){return Be.y1}),Ce=Te-Ie,He=be-he,Xe=He/Ce;me.forEach(function(Be){var Re=(Be.y1-Be.y0)*Xe;Be.y0=(Be.y0-Ie)*Xe,Be.y1=Be.y0+Re}),_e.forEach(function(Be){Be.y0=(Be.y0-Ie)*Xe,Be.y1=(Be.y1-Ie)*Xe,Be.width=Be.width*Xe})}}h.sankeyCircular=E,h.sankeyCenter=f,h.sankeyLeft=n,h.sankeyRight=a,h.sankeyJustify=r,Object.defineProperty(h,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R,t("d3-array"),t("d3-collection"),t("d3-shape")):u(h.d3=h.d3||{},h.d3,h.d3,h.d3)})(this,function(h,u,A,T){function e(C){return C.target.depth}function i(C){return C.depth}function n(C,S){return S-1-C.height}function a(C,S){return C.sourceLinks.length?C.depth:S-1}function r(C){return C.targetLinks.length?C.depth:C.sourceLinks.length?u.min(C.sourceLinks,e)-1:0}function f(C){return function(){return C}}function o(C,S){return m(C.source,S.source)||C.index-S.index}function s(C,S){return m(C.target,S.target)||C.index-S.index}function m(C,S){return C.y0-S.y0}function g(C){return C.value}function p(C){return(C.y0+C.y1)/2}function v(C){return p(C.source)*C.value}function x(C){return p(C.target)*C.value}function l(C){return C.index}function b(C){return C.nodes}function c(C){return C.links}function M(C,S){var E=C.get(S);if(!E)throw new Error("missing: "+S);return E}var _=function(){var C=0,S=0,E=1,k=1,B=24,z=8,F=l,I=a,O=b,N=c,V=32,H=2/3;function j(){var te={nodes:O.apply(null,arguments),links:N.apply(null,arguments)};return Z(te),X(te),re(te),ue(te),K(te),te}j.update=function(te){return K(te),te},j.nodeId=function(te){return arguments.length?(F=typeof te=="function"?te:f(te),j):F},j.nodeAlign=function(te){return arguments.length?(I=typeof te=="function"?te:f(te),j):I},j.nodeWidth=function(te){return arguments.length?(B=+te,j):B},j.nodePadding=function(te){return arguments.length?(z=+te,j):z},j.nodes=function(te){return arguments.length?(O=typeof te=="function"?te:f(te),j):O},j.links=function(te){return arguments.length?(N=typeof te=="function"?te:f(te),j):N},j.size=function(te){return arguments.length?(C=S=0,E=+te[0],k=+te[1],j):[E-C,k-S]},j.extent=function(te){return arguments.length?(C=+te[0][0],E=+te[1][0],S=+te[0][1],k=+te[1][1],j):[[C,S],[E,k]]},j.iterations=function(te){return arguments.length?(V=+te,j):V};function Z(te){te.nodes.forEach(function(Y,ee){Y.index=ee,Y.sourceLinks=[],Y.targetLinks=[]});var G=A.map(te.nodes,F);te.links.forEach(function(Y,ee){Y.index=ee;var ne=Y.source,J=Y.target;typeof ne!="object"&&(ne=Y.source=M(G,ne)),typeof J!="object"&&(J=Y.target=M(G,J)),ne.sourceLinks.push(Y),J.targetLinks.push(Y)})}function X(te){te.nodes.forEach(function(G){G.value=Math.max(u.sum(G.sourceLinks,g),u.sum(G.targetLinks,g))})}function re(te){var G,Y,ee;for(G=te.nodes,Y=[],ee=0;G.length;++ee,G=Y,Y=[])G.forEach(function(J){J.depth=ee,J.sourceLinks.forEach(function(q){Y.indexOf(q.target)<0&&Y.push(q.target)})});for(G=te.nodes,Y=[],ee=0;G.length;++ee,G=Y,Y=[])G.forEach(function(J){J.height=ee,J.targetLinks.forEach(function(q){Y.indexOf(q.source)<0&&Y.push(q.source)})});var ne=(E-C-B)/(ee-1);te.nodes.forEach(function(J){J.x1=(J.x0=C+Math.max(0,Math.min(ee-1,Math.floor(I.call(null,J,ee))))*ne)+B})}function ue(te){var G=A.nest().key(function(le){return le.x0}).sortKeys(u.ascending).entries(te.nodes).map(function(le){return le.values});ne(),ae();for(var Y=1,ee=V;ee>0;--ee)q(Y*=.99),ae(),J(Y),ae();function ne(){var le=u.max(G,function(xe){return xe.length}),ie=H*(k-S)/(le-1);z>ie&&(z=ie);var se=u.min(G,function(xe){return(k-S-(xe.length-1)*z)/u.sum(xe,g)});G.forEach(function(xe){xe.forEach(function(oe,he){oe.y1=(oe.y0=he)+oe.value*se})}),te.links.forEach(function(xe){xe.width=xe.value*se})}function J(le){G.forEach(function(ie){ie.forEach(function(se){if(se.targetLinks.length){var xe=(u.sum(se.targetLinks,v)/u.sum(se.targetLinks,g)-p(se))*le;se.y0+=xe,se.y1+=xe}})})}function q(le){G.slice().reverse().forEach(function(ie){ie.forEach(function(se){if(se.sourceLinks.length){var xe=(u.sum(se.sourceLinks,x)/u.sum(se.sourceLinks,g)-p(se))*le;se.y0+=xe,se.y1+=xe}})})}function ae(){G.forEach(function(le){var ie,se,xe=S,oe=le.length,he;for(le.sort(m),he=0;he<oe;++he)ie=le[he],se=xe-ie.y0,se>0&&(ie.y0+=se,ie.y1+=se),xe=ie.y1+z;if(se=xe-z-k,se>0)for(xe=ie.y0-=se,ie.y1-=se,he=oe-2;he>=0;--he)ie=le[he],se=ie.y1+z-xe,se>0&&(ie.y0-=se,ie.y1-=se),xe=ie.y0})}}function K(te){te.nodes.forEach(function(G){G.sourceLinks.sort(s),G.targetLinks.sort(o)}),te.nodes.forEach(function(G){var Y=G.y0,ee=Y;G.sourceLinks.forEach(function(ne){ne.y0=Y+ne.width/2,Y+=ne.width}),G.targetLinks.forEach(function(ne){ne.y1=ee+ne.width/2,ee+=ne.width})})}return j};function y(C){return[C.source.x1,C.y0]}function w(C){return[C.target.x0,C.y1]}var d=function(){return T.linkHorizontal().source(y).target(w)};h.sankey=_,h.sankeyCenter=r,h.sankeyLeft=i,h.sankeyRight=n,h.sankeyJustify=a,h.sankeyLinkHorizontal=d,Object.defineProperty(h,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(t,P,R){(function(){var h={version:"3.8.0"},u=[].slice,A=function(fe){return u.call(fe)},T=self.document;function e(fe){return fe&&(fe.ownerDocument||fe.document||fe).documentElement}function i(fe){return fe&&(fe.ownerDocument&&fe.ownerDocument.defaultView||fe.document&&fe||fe.defaultView)}if(T)try{A(T.documentElement.childNodes)[0].nodeType}catch{A=function(Ae){for(var Fe=Ae.length,Ve=new Array(Fe);Fe--;)Ve[Fe]=Ae[Fe];return Ve}}if(Date.now||(Date.now=function(){return+new Date}),T)try{T.createElement("DIV").style.setProperty("opacity",0,"")}catch{var n=this.Element.prototype,a=n.setAttribute,r=n.setAttributeNS,f=this.CSSStyleDeclaration.prototype,o=f.setProperty;n.setAttribute=function(Ae,Fe){a.call(this,Ae,Fe+"")},n.setAttributeNS=function(Ae,Fe,Ve){r.call(this,Ae,Fe,Ve+"")},f.setProperty=function(Ae,Fe,Ve){o.call(this,Ae,Fe+"",Ve)}}h.ascending=s;function s(fe,Ae){return fe<Ae?-1:fe>Ae?1:fe>=Ae?0:NaN}h.descending=function(fe,Ae){return Ae<fe?-1:Ae>fe?1:Ae>=fe?0:NaN},h.min=function(fe,Ae){var Fe=-1,Ve=fe.length,Ue,Qe;if(arguments.length===1){for(;++Fe<Ve;)if((Qe=fe[Fe])!=null&&Qe>=Qe){Ue=Qe;break}for(;++Fe<Ve;)(Qe=fe[Fe])!=null&&Ue>Qe&&(Ue=Qe)}else{for(;++Fe<Ve;)if((Qe=Ae.call(fe,fe[Fe],Fe))!=null&&Qe>=Qe){Ue=Qe;break}for(;++Fe<Ve;)(Qe=Ae.call(fe,fe[Fe],Fe))!=null&&Ue>Qe&&(Ue=Qe)}return Ue},h.max=function(fe,Ae){var Fe=-1,Ve=fe.length,Ue,Qe;if(arguments.length===1){for(;++Fe<Ve;)if((Qe=fe[Fe])!=null&&Qe>=Qe){Ue=Qe;break}for(;++Fe<Ve;)(Qe=fe[Fe])!=null&&Qe>Ue&&(Ue=Qe)}else{for(;++Fe<Ve;)if((Qe=Ae.call(fe,fe[Fe],Fe))!=null&&Qe>=Qe){Ue=Qe;break}for(;++Fe<Ve;)(Qe=Ae.call(fe,fe[Fe],Fe))!=null&&Qe>Ue&&(Ue=Qe)}return Ue},h.extent=function(fe,Ae){var Fe=-1,Ve=fe.length,Ue,Qe,_t;if(arguments.length===1){for(;++Fe<Ve;)if((Qe=fe[Fe])!=null&&Qe>=Qe){Ue=_t=Qe;break}for(;++Fe<Ve;)(Qe=fe[Fe])!=null&&(Ue>Qe&&(Ue=Qe),_t<Qe&&(_t=Qe))}else{for(;++Fe<Ve;)if((Qe=Ae.call(fe,fe[Fe],Fe))!=null&&Qe>=Qe){Ue=_t=Qe;break}for(;++Fe<Ve;)(Qe=Ae.call(fe,fe[Fe],Fe))!=null&&(Ue>Qe&&(Ue=Qe),_t<Qe&&(_t=Qe))}return[Ue,_t]};function m(fe){return fe===null?NaN:+fe}function g(fe){return!isNaN(fe)}h.sum=function(fe,Ae){var Fe=0,Ve=fe.length,Ue,Qe=-1;if(arguments.length===1)for(;++Qe<Ve;)g(Ue=+fe[Qe])&&(Fe+=Ue);else for(;++Qe<Ve;)g(Ue=+Ae.call(fe,fe[Qe],Qe))&&(Fe+=Ue);return Fe},h.mean=function(fe,Ae){var Fe=0,Ve=fe.length,Ue,Qe=-1,_t=Ve;if(arguments.length===1)for(;++Qe<Ve;)g(Ue=m(fe[Qe]))?Fe+=Ue:--_t;else for(;++Qe<Ve;)g(Ue=m(Ae.call(fe,fe[Qe],Qe)))?Fe+=Ue:--_t;if(_t)return Fe/_t},h.quantile=function(fe,Ae){var Fe=(fe.length-1)*Ae+1,Ve=Math.floor(Fe),Ue=+fe[Ve-1],Qe=Fe-Ve;return Qe?Ue+Qe*(fe[Ve]-Ue):Ue},h.median=function(fe,Ae){var Fe=[],Ve=fe.length,Ue,Qe=-1;if(arguments.length===1)for(;++Qe<Ve;)g(Ue=m(fe[Qe]))&&Fe.push(Ue);else for(;++Qe<Ve;)g(Ue=m(Ae.call(fe,fe[Qe],Qe)))&&Fe.push(Ue);if(Fe.length)return h.quantile(Fe.sort(s),.5)},h.variance=function(fe,Ae){var Fe=fe.length,Ve=0,Ue,Qe,_t=0,dt=-1,It=0;if(arguments.length===1)for(;++dt<Fe;)g(Ue=m(fe[dt]))&&(Qe=Ue-Ve,Ve+=Qe/++It,_t+=Qe*(Ue-Ve));else for(;++dt<Fe;)g(Ue=m(Ae.call(fe,fe[dt],dt)))&&(Qe=Ue-Ve,Ve+=Qe/++It,_t+=Qe*(Ue-Ve));if(It>1)return _t/(It-1)},h.deviation=function(){var fe=h.variance.apply(this,arguments);return fe&&Math.sqrt(fe)};function p(fe){return{left:function(Ae,Fe,Ve,Ue){for(arguments.length<3&&(Ve=0),arguments.length<4&&(Ue=Ae.length);Ve<Ue;){var Qe=Ve+Ue>>>1;fe(Ae[Qe],Fe)<0?Ve=Qe+1:Ue=Qe}return Ve},right:function(Ae,Fe,Ve,Ue){for(arguments.length<3&&(Ve=0),arguments.length<4&&(Ue=Ae.length);Ve<Ue;){var Qe=Ve+Ue>>>1;fe(Ae[Qe],Fe)>0?Ue=Qe:Ve=Qe+1}return Ve}}}var v=p(s);h.bisectLeft=v.left,h.bisect=h.bisectRight=v.right,h.bisector=function(fe){return p(fe.length===1?function(Ae,Fe){return s(fe(Ae),Fe)}:fe)},h.shuffle=function(fe,Ae,Fe){(Ve=arguments.length)<3&&(Fe=fe.length,Ve<2&&(Ae=0));for(var Ve=Fe-Ae,Ue,Qe;Ve;)Qe=Math.random()*Ve--|0,Ue=fe[Ve+Ae],fe[Ve+Ae]=fe[Qe+Ae],fe[Qe+Ae]=Ue;return fe},h.permute=function(fe,Ae){for(var Fe=Ae.length,Ve=new Array(Fe);Fe--;)Ve[Fe]=fe[Ae[Fe]];return Ve},h.pairs=function(fe){for(var Ae=0,Fe=fe.length-1,Ve=fe[0],Ue=new Array(Fe<0?0:Fe);Ae<Fe;)Ue[Ae]=[Ve,Ve=fe[++Ae]];return Ue},h.transpose=function(fe){if(!(Qe=fe.length))return[];for(var Ae=-1,Fe=h.min(fe,x),Ve=new Array(Fe);++Ae<Fe;)for(var Ue=-1,Qe,_t=Ve[Ae]=new Array(Qe);++Ue<Qe;)_t[Ue]=fe[Ue][Ae];return Ve};function x(fe){return fe.length}h.zip=function(){return h.transpose(arguments)},h.keys=function(fe){var Ae=[];for(var Fe in fe)Ae.push(Fe);return Ae},h.values=function(fe){var Ae=[];for(var Fe in fe)Ae.push(fe[Fe]);return Ae},h.entries=function(fe){var Ae=[];for(var Fe in fe)Ae.push({key:Fe,value:fe[Fe]});return Ae},h.merge=function(fe){for(var Ae=fe.length,Fe,Ve=-1,Ue=0,Qe,_t;++Ve<Ae;)Ue+=fe[Ve].length;for(Qe=new Array(Ue);--Ae>=0;)for(_t=fe[Ae],Fe=_t.length;--Fe>=0;)Qe[--Ue]=_t[Fe];return Qe};var l=Math.abs;h.range=function(fe,Ae,Fe){if(arguments.length<3&&(Fe=1,arguments.length<2&&(Ae=fe,fe=0)),(Ae-fe)/Fe===1/0)throw new Error("infinite range");var Ve=[],Ue=b(l(Fe)),Qe=-1,_t;if(fe*=Ue,Ae*=Ue,Fe*=Ue,Fe<0)for(;(_t=fe+Fe*++Qe)>Ae;)Ve.push(_t/Ue);else for(;(_t=fe+Fe*++Qe)<Ae;)Ve.push(_t/Ue);return Ve};function b(fe){for(var Ae=1;fe*Ae%1;)Ae*=10;return Ae}function c(fe,Ae){for(var Fe in Ae)Object.defineProperty(fe.prototype,Fe,{value:Ae[Fe],enumerable:!1})}h.map=function(fe,Ae){var Fe=new M;if(fe instanceof M)fe.forEach(function(dt,It){Fe.set(dt,It)});else if(Array.isArray(fe)){var Ve=-1,Ue=fe.length,Qe;if(arguments.length===1)for(;++Ve<Ue;)Fe.set(Ve,fe[Ve]);else for(;++Ve<Ue;)Fe.set(Ae.call(fe,Qe=fe[Ve],Ve),Qe)}else for(var _t in fe)Fe.set(_t,fe[_t]);return Fe};function M(){this._=Object.create(null)}var _="__proto__",y="\0";c(M,{has:C,get:function(fe){return this._[w(fe)]},set:function(fe,Ae){return this._[w(fe)]=Ae},remove:S,keys:E,values:function(){var fe=[];for(var Ae in this._)fe.push(this._[Ae]);return fe},entries:function(){var fe=[];for(var Ae in this._)fe.push({key:d(Ae),value:this._[Ae]});return fe},size:k,empty:B,forEach:function(fe){for(var Ae in this._)fe.call(this,d(Ae),this._[Ae])}});function w(fe){return(fe+="")===_||fe[0]===y?y+fe:fe}function d(fe){return(fe+="")[0]===y?fe.slice(1):fe}function C(fe){return w(fe)in this._}function S(fe){return(fe=w(fe))in this._&&delete this._[fe]}function E(){var fe=[];for(var Ae in this._)fe.push(d(Ae));return fe}function k(){var fe=0;for(var Ae in this._)++fe;return fe}function B(){for(var fe in this._)return!1;return!0}h.nest=function(){var fe={},Ae=[],Fe=[],Ve,Ue;function Qe(dt,It,Qt){if(Qt>=Ae.length)return Ue?Ue.call(fe,It):Ve?It.sort(Ve):It;for(var tr=-1,rr=It.length,Er=Ae[Qt++],qr,fn,Pr,Vr=new M,Jr;++tr<rr;)(Jr=Vr.get(qr=Er(fn=It[tr])))?Jr.push(fn):Vr.set(qr,[fn]);return dt?(fn=dt(),Pr=function(sn,un){fn.set(sn,Qe(dt,un,Qt))}):(fn={},Pr=function(sn,un){fn[sn]=Qe(dt,un,Qt)}),Vr.forEach(Pr),fn}function _t(dt,It){if(It>=Ae.length)return dt;var Qt=[],tr=Fe[It++];return dt.forEach(function(rr,Er){Qt.push({key:rr,values:_t(Er,It)})}),tr?Qt.sort(function(rr,Er){return tr(rr.key,Er.key)}):Qt}return fe.map=function(dt,It){return Qe(It,dt,0)},fe.entries=function(dt){return _t(Qe(h.map,dt,0),0)},fe.key=function(dt){return Ae.push(dt),fe},fe.sortKeys=function(dt){return Fe[Ae.length-1]=dt,fe},fe.sortValues=function(dt){return Ve=dt,fe},fe.rollup=function(dt){return Ue=dt,fe},fe},h.set=function(fe){var Ae=new z;if(fe)for(var Fe=0,Ve=fe.length;Fe<Ve;++Fe)Ae.add(fe[Fe]);return Ae};function z(){this._=Object.create(null)}c(z,{has:C,add:function(fe){return this._[w(fe+="")]=!0,fe},remove:S,values:E,size:k,empty:B,forEach:function(fe){for(var Ae in this._)fe.call(this,d(Ae))}}),h.behavior={};function F(fe){return fe}h.rebind=function(fe,Ae){for(var Fe=1,Ve=arguments.length,Ue;++Fe<Ve;)fe[Ue=arguments[Fe]]=I(fe,Ae,Ae[Ue]);return fe};function I(fe,Ae,Fe){return function(){var Ve=Fe.apply(Ae,arguments);return Ve===Ae?fe:Ve}}function O(fe,Ae){if(Ae in fe)return Ae;Ae=Ae.charAt(0).toUpperCase()+Ae.slice(1);for(var Fe=0,Ve=N.length;Fe<Ve;++Fe){var Ue=N[Fe]+Ae;if(Ue in fe)return Ue}}var N=["webkit","ms","moz","Moz","o","O"];function V(){}h.dispatch=function(){for(var fe=new H,Ae=-1,Fe=arguments.length;++Ae<Fe;)fe[arguments[Ae]]=j(fe);return fe};function H(){}H.prototype.on=function(fe,Ae){var Fe=fe.indexOf("."),Ve="";if(Fe>=0&&(Ve=fe.slice(Fe+1),fe=fe.slice(0,Fe)),fe)return arguments.length<2?this[fe].on(Ve):this[fe].on(Ve,Ae);if(arguments.length===2){if(Ae==null)for(fe in this)this.hasOwnProperty(fe)&&this[fe].on(Ve,null);return this}};function j(fe){var Ae=[],Fe=new M;function Ve(){for(var Ue=Ae,Qe=-1,_t=Ue.length,dt;++Qe<_t;)(dt=Ue[Qe].on)&&dt.apply(this,arguments);return fe}return Ve.on=function(Ue,Qe){var _t=Fe.get(Ue),dt;return arguments.length<2?_t&&_t.on:(_t&&(_t.on=null,Ae=Ae.slice(0,dt=Ae.indexOf(_t)).concat(Ae.slice(dt+1)),Fe.remove(Ue)),Qe&&Ae.push(Fe.set(Ue,{on:Qe})),fe)},Ve}h.event=null;function Z(){h.event.preventDefault()}function X(){for(var fe=h.event,Ae;Ae=fe.sourceEvent;)fe=Ae;return fe}function re(fe){for(var Ae=new H,Fe=0,Ve=arguments.length;++Fe<Ve;)Ae[arguments[Fe]]=j(Ae);return Ae.of=function(Ue,Qe){return function(_t){try{var dt=_t.sourceEvent=h.event;_t.target=fe,h.event=_t,Ae[_t.type].apply(Ue,Qe)}finally{h.event=dt}}},Ae}h.requote=function(fe){return fe.replace(ue,"\\$&")};var ue=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,K={}.__proto__?function(fe,Ae){fe.__proto__=Ae}:function(fe,Ae){for(var Fe in Ae)fe[Fe]=Ae[Fe]};function te(fe){return K(fe,ne),fe}var G=function(fe,Ae){return Ae.querySelector(fe)},Y=function(fe,Ae){return Ae.querySelectorAll(fe)},ee=function(fe,Ae){var Fe=fe.matches||fe[O(fe,"matchesSelector")];return ee=function(Ve,Ue){return Fe.call(Ve,Ue)},ee(fe,Ae)};typeof Sizzle=="function"&&(G=function(fe,Ae){return Sizzle(fe,Ae)[0]||null},Y=Sizzle,ee=Sizzle.matchesSelector),h.selection=function(){return h.select(T.documentElement)};var ne=h.selection.prototype=[];ne.select=function(fe){var Ae=[],Fe,Ve,Ue,Qe;fe=J(fe);for(var _t=-1,dt=this.length;++_t<dt;){Ae.push(Fe=[]),Fe.parentNode=(Ue=this[_t]).parentNode;for(var It=-1,Qt=Ue.length;++It<Qt;)(Qe=Ue[It])?(Fe.push(Ve=fe.call(Qe,Qe.__data__,It,_t)),Ve&&"__data__"in Qe&&(Ve.__data__=Qe.__data__)):Fe.push(null)}return te(Ae)};function J(fe){return typeof fe=="function"?fe:function(){return G(fe,this)}}ne.selectAll=function(fe){var Ae=[],Fe,Ve;fe=q(fe);for(var Ue=-1,Qe=this.length;++Ue<Qe;)for(var _t=this[Ue],dt=-1,It=_t.length;++dt<It;)(Ve=_t[dt])&&(Ae.push(Fe=A(fe.call(Ve,Ve.__data__,dt,Ue))),Fe.parentNode=Ve);return te(Ae)};function q(fe){return typeof fe=="function"?fe:function(){return Y(fe,this)}}var ae="http://www.w3.org/1999/xhtml",le={svg:"http://www.w3.org/2000/svg",xhtml:ae,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};h.ns={prefix:le,qualify:function(fe){var Ae=fe.indexOf(":"),Fe=fe;return Ae>=0&&(Fe=fe.slice(0,Ae))!=="xmlns"&&(fe=fe.slice(Ae+1)),le.hasOwnProperty(Fe)?{space:le[Fe],local:fe}:fe}},ne.attr=function(fe,Ae){if(arguments.length<2){if(typeof fe=="string"){var Fe=this.node();return fe=h.ns.qualify(fe),fe.local?Fe.getAttributeNS(fe.space,fe.local):Fe.getAttribute(fe)}for(Ae in fe)this.each(ie(Ae,fe[Ae]));return this}return this.each(ie(fe,Ae))};function ie(fe,Ae){fe=h.ns.qualify(fe);function Fe(){this.removeAttribute(fe)}function Ve(){this.removeAttributeNS(fe.space,fe.local)}function Ue(){this.setAttribute(fe,Ae)}function Qe(){this.setAttributeNS(fe.space,fe.local,Ae)}function _t(){var It=Ae.apply(this,arguments);It==null?this.removeAttribute(fe):this.setAttribute(fe,It)}function dt(){var It=Ae.apply(this,arguments);It==null?this.removeAttributeNS(fe.space,fe.local):this.setAttributeNS(fe.space,fe.local,It)}return Ae==null?fe.local?Ve:Fe:typeof Ae=="function"?fe.local?dt:_t:fe.local?Qe:Ue}function se(fe){return fe.trim().replace(/\s+/g," ")}ne.classed=function(fe,Ae){if(arguments.length<2){if(typeof fe=="string"){var Fe=this.node(),Ve=(fe=oe(fe)).length,Ue=-1;if(Ae=Fe.classList){for(;++Ue<Ve;)if(!Ae.contains(fe[Ue]))return!1}else for(Ae=Fe.getAttribute("class");++Ue<Ve;)if(!xe(fe[Ue]).test(Ae))return!1;return!0}for(Ae in fe)this.each(he(Ae,fe[Ae]));return this}return this.each(he(fe,Ae))};function xe(fe){return new RegExp("(?:^|\\s+)"+h.requote(fe)+"(?:\\s+|$)","g")}function oe(fe){return(fe+"").trim().split(/^|\s+/)}function he(fe,Ae){fe=oe(fe).map(be);var Fe=fe.length;function Ve(){for(var Qe=-1;++Qe<Fe;)fe[Qe](this,Ae)}function Ue(){for(var Qe=-1,_t=Ae.apply(this,arguments);++Qe<Fe;)fe[Qe](this,_t)}return typeof Ae=="function"?Ue:Ve}function be(fe){var Ae=xe(fe);return function(Fe,Ve){if(Ue=Fe.classList)return Ve?Ue.add(fe):Ue.remove(fe);var Ue=Fe.getAttribute("class")||"";Ve?(Ae.lastIndex=0,Ae.test(Ue)||Fe.setAttribute("class",se(Ue+" "+fe))):Fe.setAttribute("class",se(Ue.replace(Ae," ")))}}ne.style=function(fe,Ae,Fe){var Ve=arguments.length;if(Ve<3){if(typeof fe!="string"){Ve<2&&(Ae="");for(Fe in fe)this.each(me(Fe,fe[Fe],Ae));return this}if(Ve<2){var Ue=this.node();return i(Ue).getComputedStyle(Ue,null).getPropertyValue(fe)}Fe=""}return this.each(me(fe,Ae,Fe))};function me(fe,Ae,Fe){function Ve(){this.style.removeProperty(fe)}function Ue(){this.style.setProperty(fe,Ae,Fe)}function Qe(){var _t=Ae.apply(this,arguments);_t==null?this.style.removeProperty(fe):this.style.setProperty(fe,_t,Fe)}return Ae==null?Ve:typeof Ae=="function"?Qe:Ue}ne.property=function(fe,Ae){if(arguments.length<2){if(typeof fe=="string")return this.node()[fe];for(Ae in fe)this.each(_e(Ae,fe[Ae]));return this}return this.each(_e(fe,Ae))};function _e(fe,Ae){function Fe(){delete this[fe]}function Ve(){this[fe]=Ae}function Ue(){var Qe=Ae.apply(this,arguments);Qe==null?delete this[fe]:this[fe]=Qe}return Ae==null?Fe:typeof Ae=="function"?Ue:Ve}ne.text=function(fe){return arguments.length?this.each(typeof fe=="function"?function(){var Ae=fe.apply(this,arguments);this.textContent=Ae==null?"":Ae}:fe==null?function(){this.textContent=""}:function(){this.textContent=fe}):this.node().textContent},ne.html=function(fe){return arguments.length?this.each(typeof fe=="function"?function(){var Ae=fe.apply(this,arguments);this.innerHTML=Ae==null?"":Ae}:fe==null?function(){this.innerHTML=""}:function(){this.innerHTML=fe}):this.node().innerHTML},ne.append=function(fe){return fe=Se(fe),this.select(function(){return this.appendChild(fe.apply(this,arguments))})};function Se(fe){function Ae(){var Ve=this.ownerDocument,Ue=this.namespaceURI;return Ue===ae&&Ve.documentElement.namespaceURI===ae?Ve.createElement(fe):Ve.createElementNS(Ue,fe)}function Fe(){return this.ownerDocument.createElementNS(fe.space,fe.local)}return typeof fe=="function"?fe:(fe=h.ns.qualify(fe)).local?Fe:Ae}ne.insert=function(fe,Ae){return fe=Se(fe),Ae=J(Ae),this.select(function(){return this.insertBefore(fe.apply(this,arguments),Ae.apply(this,arguments)||null)})},ne.remove=function(){return this.each(De)};function De(){var fe=this.parentNode;fe&&fe.removeChild(this)}ne.data=function(fe,Ae){var Fe=-1,Ve=this.length,Ue,Qe;if(!arguments.length){for(fe=new Array(Ve=(Ue=this[0]).length);++Fe<Ve;)(Qe=Ue[Fe])&&(fe[Fe]=Qe.__data__);return fe}function _t(tr,rr){var Er,qr=tr.length,fn=rr.length,Pr=Math.min(qr,fn),Vr=new Array(fn),Jr=new Array(fn),sn=new Array(qr),un,Qr;if(Ae){var Hn=new M,aa=new Array(qr),Aa;for(Er=-1;++Er<qr;)(un=tr[Er])&&(Hn.has(Aa=Ae.call(un,un.__data__,Er))?sn[Er]=un:Hn.set(Aa,un),aa[Er]=Aa);for(Er=-1;++Er<fn;)(un=Hn.get(Aa=Ae.call(rr,Qr=rr[Er],Er)))?un!==!0&&(Vr[Er]=un,un.__data__=Qr):Jr[Er]=Ie(Qr),Hn.set(Aa,!0);for(Er=-1;++Er<qr;)Er in aa&&Hn.get(aa[Er])!==!0&&(sn[Er]=tr[Er])}else{for(Er=-1;++Er<Pr;)un=tr[Er],Qr=rr[Er],un?(un.__data__=Qr,Vr[Er]=un):Jr[Er]=Ie(Qr);for(;Er<fn;++Er)Jr[Er]=Ie(rr[Er]);for(;Er<qr;++Er)sn[Er]=tr[Er]}Jr.update=Vr,Jr.parentNode=Vr.parentNode=sn.parentNode=tr.parentNode,dt.push(Jr),It.push(Vr),Qt.push(sn)}var dt=Xe([]),It=te([]),Qt=te([]);if(typeof fe=="function")for(;++Fe<Ve;)_t(Ue=this[Fe],fe.call(Ue,Ue.parentNode.__data__,Fe));else for(;++Fe<Ve;)_t(Ue=this[Fe],fe);return It.enter=function(){return dt},It.exit=function(){return Qt},It};function Ie(fe){return{__data__:fe}}ne.datum=function(fe){return arguments.length?this.property("__data__",fe):this.property("__data__")},ne.filter=function(fe){var Ae=[],Fe,Ve,Ue;typeof fe!="function"&&(fe=Te(fe));for(var Qe=0,_t=this.length;Qe<_t;Qe++){Ae.push(Fe=[]),Fe.parentNode=(Ve=this[Qe]).parentNode;for(var dt=0,It=Ve.length;dt<It;dt++)(Ue=Ve[dt])&&fe.call(Ue,Ue.__data__,dt,Qe)&&Fe.push(Ue)}return te(Ae)};function Te(fe){return function(){return ee(this,fe)}}ne.order=function(){for(var fe=-1,Ae=this.length;++fe<Ae;)for(var Fe=this[fe],Ve=Fe.length-1,Ue=Fe[Ve],Qe;--Ve>=0;)(Qe=Fe[Ve])&&(Ue&&Ue!==Qe.nextSibling&&Ue.parentNode.insertBefore(Qe,Ue),Ue=Qe);return this},ne.sort=function(fe){fe=Ce.apply(this,arguments);for(var Ae=-1,Fe=this.length;++Ae<Fe;)this[Ae].sort(fe);return this.order()};function Ce(fe){return arguments.length||(fe=s),function(Ae,Fe){return Ae&&Fe?fe(Ae.__data__,Fe.__data__):!Ae-!Fe}}ne.each=function(fe){return He(this,function(Ae,Fe,Ve){fe.call(Ae,Ae.__data__,Fe,Ve)})};function He(fe,Ae){for(var Fe=0,Ve=fe.length;Fe<Ve;Fe++)for(var Ue=fe[Fe],Qe=0,_t=Ue.length,dt;Qe<_t;Qe++)(dt=Ue[Qe])&&Ae(dt,Qe,Fe);return fe}ne.call=function(fe){var Ae=A(arguments);return fe.apply(Ae[0]=this,Ae),this},ne.empty=function(){return!this.node()},ne.node=function(){for(var fe=0,Ae=this.length;fe<Ae;fe++)for(var Fe=this[fe],Ve=0,Ue=Fe.length;Ve<Ue;Ve++){var Qe=Fe[Ve];if(Qe)return Qe}return null},ne.size=function(){var fe=0;return He(this,function(){++fe}),fe};function Xe(fe){return K(fe,Be),fe}var Be=[];h.selection.enter=Xe,h.selection.enter.prototype=Be,Be.append=ne.append,Be.empty=ne.empty,Be.node=ne.node,Be.call=ne.call,Be.size=ne.size,Be.select=function(fe){for(var Ae=[],Fe,Ve,Ue,Qe,_t,dt=-1,It=this.length;++dt<It;){Ue=(Qe=this[dt]).update,Ae.push(Fe=[]),Fe.parentNode=Qe.parentNode;for(var Qt=-1,tr=Qe.length;++Qt<tr;)(_t=Qe[Qt])?(Fe.push(Ue[Qt]=Ve=fe.call(Qe.parentNode,_t.__data__,Qt,dt)),Ve.__data__=_t.__data__):Fe.push(null)}return te(Ae)},Be.insert=function(fe,Ae){return arguments.length<2&&(Ae=Re(this)),ne.insert.call(this,fe,Ae)};function Re(fe){var Ae,Fe;return function(Ve,Ue,Qe){var _t=fe[Qe].update,dt=_t.length,It;for(Qe!=Fe&&(Fe=Qe,Ae=0),Ue>=Ae&&(Ae=Ue+1);!(It=_t[Ae])&&++Ae<dt;);return It}}h.select=function(fe){var Ae;return typeof fe=="string"?(Ae=[G(fe,T)],Ae.parentNode=T.documentElement):(Ae=[fe],Ae.parentNode=e(fe)),te([Ae])},h.selectAll=function(fe){var Ae;return typeof fe=="string"?(Ae=A(Y(fe,T)),Ae.parentNode=T.documentElement):(Ae=A(fe),Ae.parentNode=null),te([Ae])},ne.on=function(fe,Ae,Fe){var Ve=arguments.length;if(Ve<3){if(typeof fe!="string"){Ve<2&&(Ae=!1);for(Fe in fe)this.each(We(Fe,fe[Fe],Ae));return this}if(Ve<2)return(Ve=this.node()["__on"+fe])&&Ve._;Fe=!1}return this.each(We(fe,Ae,Fe))};function We(fe,Ae,Fe){var Ve="__on"+fe,Ue=fe.indexOf("."),Qe=Pt;Ue>0&&(fe=fe.slice(0,Ue));var _t=vt.get(fe);_t&&(fe=_t,Qe=Zt);function dt(){var tr=this[Ve];tr&&(this.removeEventListener(fe,tr,tr.$),delete this[Ve])}function It(){var tr=Qe(Ae,A(arguments));dt.call(this),this.addEventListener(fe,this[Ve]=tr,tr.$=Fe),tr._=Ae}function Qt(){var tr=new RegExp("^__on([^.]+)"+h.requote(fe)+"$"),rr;for(var Er in this)if(rr=Er.match(tr)){var qr=this[Er];this.removeEventListener(rr[1],qr,qr.$),delete this[Er]}}return Ue?Ae?It:dt:Ae?V:Qt}var vt=h.map({mouseenter:"mouseover",mouseleave:"mouseout"});T&&vt.forEach(function(fe){"on"+fe in T&&vt.remove(fe)});function Pt(fe,Ae){return function(Fe){var Ve=h.event;h.event=Fe,Ae[0]=this.__data__;try{fe.apply(this,Ae)}finally{h.event=Ve}}}function Zt(fe,Ae){var Fe=Pt(fe,Ae);return function(Ve){var Ue=this,Qe=Ve.relatedTarget;(!Qe||Qe!==Ue&&!(Qe.compareDocumentPosition(Ue)&8))&&Fe.call(Ue,Ve)}}var zt,At=0;function Wt(fe){var Ae=".dragsuppress-"+ ++At,Fe="click"+Ae,Ve=h.select(i(fe)).on("touchmove"+Ae,Z).on("dragstart"+Ae,Z).on("selectstart"+Ae,Z);if(zt==null&&(zt="onselectstart"in fe?!1:O(fe.style,"userSelect")),zt){var Ue=e(fe).style,Qe=Ue[zt];Ue[zt]="none"}return function(_t){if(Ve.on(Ae,null),zt&&(Ue[zt]=Qe),_t){var dt=function(){Ve.on(Fe,null)};Ve.on(Fe,function(){Z(),dt()},!0),setTimeout(dt,0)}}}h.mouse=function(fe){return Ct(fe,X())};var Bt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function Ct(fe,Ae){Ae.changedTouches&&(Ae=Ae.changedTouches[0]);var Fe=fe.ownerSVGElement||fe;if(Fe.createSVGPoint){var Ve=Fe.createSVGPoint();if(Bt<0){var Ue=i(fe);if(Ue.scrollX||Ue.scrollY){Fe=h.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var Qe=Fe[0][0].getScreenCTM();Bt=!(Qe.f||Qe.e),Fe.remove()}}return Bt?(Ve.x=Ae.pageX,Ve.y=Ae.pageY):(Ve.x=Ae.clientX,Ve.y=Ae.clientY),Ve=Ve.matrixTransform(fe.getScreenCTM().inverse()),[Ve.x,Ve.y]}var _t=fe.getBoundingClientRect();return[Ae.clientX-_t.left-fe.clientLeft,Ae.clientY-_t.top-fe.clientTop]}h.touch=function(fe,Ae,Fe){if(arguments.length<3&&(Fe=Ae,Ae=X().changedTouches),Ae){for(var Ve=0,Ue=Ae.length,Qe;Ve<Ue;++Ve)if((Qe=Ae[Ve]).identifier===Fe)return Ct(fe,Qe)}},h.behavior.drag=function(){var fe=re(Ue,"drag","dragstart","dragend"),Ae=null,Fe=Qe(V,h.mouse,i,"mousemove","mouseup"),Ve=Qe(Ze,h.touch,F,"touchmove","touchend");function Ue(){this.on("mousedown.drag",Fe).on("touchstart.drag",Ve)}function Qe(_t,dt,It,Qt,tr){return function(){var rr=this,Er=h.event.target.correspondingElement||h.event.target,qr=rr.parentNode,fn=fe.of(rr,arguments),Pr=0,Vr=_t(),Jr=".drag"+(Vr==null?"":"-"+Vr),sn,un=h.select(It(Er)).on(Qt+Jr,aa).on(tr+Jr,Aa),Qr=Wt(Er),Hn=dt(qr,Vr);Ae?(sn=Ae.apply(rr,arguments),sn=[sn.x-Hn[0],sn.y-Hn[1]]):sn=[0,0],fn({type:"dragstart"});function aa(){var sa=dt(qr,Vr),Da,fa;!sa||(Da=sa[0]-Hn[0],fa=sa[1]-Hn[1],Pr|=Da|fa,Hn=sa,fn({type:"drag",x:sa[0]+sn[0],y:sa[1]+sn[1],dx:Da,dy:fa}))}function Aa(){!dt(qr,Vr)||(un.on(Qt+Jr,null).on(tr+Jr,null),Qr(Pr),fn({type:"dragend"}))}}}return Ue.origin=function(_t){return arguments.length?(Ae=_t,Ue):Ae},h.rebind(Ue,fe,"on")};function Ze(){return h.event.changedTouches[0].identifier}h.touches=function(fe,Ae){return arguments.length<2&&(Ae=X().touches),Ae?A(Ae).map(function(Fe){var Ve=Ct(fe,Fe);return Ve.identifier=Fe.identifier,Ve}):[]};var nt=1e-6,Ye=nt*nt,Ee=Math.PI,Ge=2*Ee,Je=Ge-nt,qe=Ee/2,Tt=Ee/180,mt=180/Ee;function Mt(fe,Ae,Fe){return(Ae[0]-fe[0])*(Fe[1]-fe[1])-(Ae[1]-fe[1])*(Fe[0]-fe[0])}function Ht(fe){return fe>1?qe:fe<-1?-qe:Math.asin(fe)}function Rt(fe){return((fe=Math.exp(fe))-1/fe)/2}function Vt(fe){return((fe=Math.exp(fe))+1/fe)/2}function Jt(fe){return((fe=Math.exp(2*fe))-1)/(fe+1)}var Yt=Math.SQRT2,or=2,Hr=4;h.interpolateZoom=function(fe,Ae){var Fe=fe[0],Ve=fe[1],Ue=fe[2],Qe=Ae[0],_t=Ae[1],dt=Ae[2],It=Qe-Fe,Qt=_t-Ve,tr=It*It+Qt*Qt,rr,Er;if(tr<Ye)Er=Math.log(dt/Ue)/Yt,rr=function(sn){return[Fe+sn*It,Ve+sn*Qt,Ue*Math.exp(Yt*sn*Er)]};else{var qr=Math.sqrt(tr),fn=(dt*dt-Ue*Ue+Hr*tr)/(2*Ue*or*qr),Pr=(dt*dt-Ue*Ue-Hr*tr)/(2*dt*or*qr),Vr=Math.log(Math.sqrt(fn*fn+1)-fn),Jr=Math.log(Math.sqrt(Pr*Pr+1)-Pr);Er=(Jr-Vr)/Yt,rr=function(sn){var un=sn*Er,Qr=Vt(Vr),Hn=Ue/(or*qr)*(Qr*Jt(Yt*un+Vr)-Rt(Vr));return[Fe+Hn*It,Ve+Hn*Qt,Ue*Qr/Vt(Yt*un+Vr)]}}return rr.duration=Er*1e3,rr},h.behavior.zoom=function(){var fe={x:0,y:0,k:1},Ae,Fe,Ve,Ue=[960,500],Qe=an,_t=250,dt=0,It="mousedown.zoom",Qt="mousemove.zoom",tr="mouseup.zoom",rr,Er="touchstart.zoom",qr,fn=re(un,"zoomstart","zoom","zoomend"),Pr,Vr,Jr,sn;ot||(ot="onwheel"in T?(Kr=function(){return-h.event.deltaY*(h.event.deltaMode?120:1)},"wheel"):"onmousewheel"in T?(Kr=function(){return h.event.wheelDelta},"mousewheel"):(Kr=function(){return-h.event.detail},"MozMousePixelScroll"));function un(va){va.on(It,ri).on(ot+".zoom",wo).on("dblclick.zoom",Gi).on(Er,Ai)}un.event=function(va){va.each(function(){var li=fn.of(this,arguments),Ka=fe;ja?h.select(this).transition().each("start.zoom",function(){fe=this.__chart__||{x:0,y:0,k:1},fa(li)}).tween("zoom:zoom",function(){var Ii=Ue[0],ci=Ue[1],go=Fe?Fe[0]:Ii/2,so=Fe?Fe[1]:ci/2,Co=h.interpolateZoom([(go-fe.x)/fe.k,(so-fe.y)/fe.k,Ii/fe.k],[(go-Ka.x)/Ka.k,(so-Ka.y)/Ka.k,Ii/Ka.k]);return function(ss){var Qo=Co(ss),ls=Ii/Qo[2];this.__chart__=fe={x:go-Qo[0]*ls,y:so-Qo[1]*ls,k:ls},Ha(li)}}).each("interrupt.zoom",function(){Ra(li)}).each("end.zoom",function(){Ra(li)}):(this.__chart__=fe,fa(li),Ha(li),Ra(li))})},un.translate=function(va){return arguments.length?(fe={x:+va[0],y:+va[1],k:fe.k},Da(),un):[fe.x,fe.y]},un.scale=function(va){return arguments.length?(fe={x:fe.x,y:fe.y,k:null},aa(+va),Da(),un):fe.k},un.scaleExtent=function(va){return arguments.length?(Qe=va==null?an:[+va[0],+va[1]],un):Qe},un.center=function(va){return arguments.length?(Ve=va&&[+va[0],+va[1]],un):Ve},un.size=function(va){return arguments.length?(Ue=va&&[+va[0],+va[1]],un):Ue},un.duration=function(va){return arguments.length?(_t=+va,un):_t},un.x=function(va){return arguments.length?(Vr=va,Pr=va.copy(),fe={x:0,y:0,k:1},un):Vr},un.y=function(va){return arguments.length?(sn=va,Jr=va.copy(),fe={x:0,y:0,k:1},un):sn};function Qr(va){return[(va[0]-fe.x)/fe.k,(va[1]-fe.y)/fe.k]}function Hn(va){return[va[0]*fe.k+fe.x,va[1]*fe.k+fe.y]}function aa(va){fe.k=Math.max(Qe[0],Math.min(Qe[1],va))}function Aa(va,li){li=Hn(li),fe.x+=va[0]-li[0],fe.y+=va[1]-li[1]}function sa(va,li,Ka,Ii){va.__chart__={x:fe.x,y:fe.y,k:fe.k},aa(Math.pow(2,Ii)),Aa(Fe=li,Ka),va=h.select(va),_t>0&&(va=va.transition().duration(_t)),va.call(un.event)}function Da(){Vr&&Vr.domain(Pr.range().map(function(va){return(va-fe.x)/fe.k}).map(Pr.invert)),sn&&sn.domain(Jr.range().map(function(va){return(va-fe.y)/fe.k}).map(Jr.invert))}function fa(va){dt++||va({type:"zoomstart"})}function Ha(va){Da(),va({type:"zoom",scale:fe.k,translate:[fe.x,fe.y]})}function Ra(va){--dt||(va({type:"zoomend"}),Fe=null)}function ri(){var va=this,li=fn.of(va,arguments),Ka=0,Ii=h.select(i(va)).on(Qt,so).on(tr,Co),ci=Qr(h.mouse(va)),go=Wt(va);Rn.call(va),fa(li);function so(){Ka=1,Aa(h.mouse(va),ci),Ha(li)}function Co(){Ii.on(Qt,null).on(tr,null),go(Ka),Ra(li)}}function Ai(){var va=this,li=fn.of(va,arguments),Ka={},Ii=0,ci,go=".zoom-"+h.event.changedTouches[0].identifier,so="touchmove"+go,Co="touchend"+go,ss=[],Qo=h.select(va),ls=Wt(va);ji(),fa(li),Qo.on(It,null).on(Er,ji);function qi(){var Lo=h.touches(va);return ci=fe.k,Lo.forEach(function(fo){fo.identifier in Ka&&(Ka[fo.identifier]=Qr(fo))}),Lo}function ji(){var Lo=h.event.target;h.select(Lo).on(so,Ba).on(Co,Qa),ss.push(Lo);for(var fo=h.event.changedTouches,Wo=0,ro=fo.length;Wo<ro;++Wo)Ka[fo[Wo].identifier]=null;var us=qi(),Ns=Date.now();if(us.length===1){if(Ns-qr<500){var vu=us[0];sa(va,vu,Ka[vu.identifier],Math.floor(Math.log(fe.k)/Math.LN2)+1),Z()}qr=Ns}else if(us.length>1){var vu=us[0],no=us[1],Hf=vu[0]-no[0],Jl=vu[1]-no[1];Ii=Hf*Hf+Jl*Jl}}function Ba(){var Lo=h.touches(va),fo,Wo,ro,us;Rn.call(va);for(var Ns=0,vu=Lo.length;Ns<vu;++Ns,us=null)if(ro=Lo[Ns],us=Ka[ro.identifier]){if(Wo)break;fo=ro,Wo=us}if(us){var no=(no=ro[0]-fo[0])*no+(no=ro[1]-fo[1])*no,Hf=Ii&&Math.sqrt(no/Ii);fo=[(fo[0]+ro[0])/2,(fo[1]+ro[1])/2],Wo=[(Wo[0]+us[0])/2,(Wo[1]+us[1])/2],aa(Hf*ci)}qr=null,Aa(fo,Wo),Ha(li)}function Qa(){if(h.event.touches.length){for(var Lo=h.event.changedTouches,fo=0,Wo=Lo.length;fo<Wo;++fo)delete Ka[Lo[fo].identifier];for(var ro in Ka)return void qi()}h.selectAll(ss).on(go,null),Qo.on(It,ri).on(Er,Ai),ls(),Ra(li)}}function wo(){var va=fn.of(this,arguments);rr?clearTimeout(rr):(Rn.call(this),Ae=Qr(Fe=Ve||h.mouse(this)),fa(va)),rr=setTimeout(function(){rr=null,Ra(va)},50),Z(),aa(Math.pow(2,Kr()*.002)*fe.k),Aa(Fe,Ae),Ha(va)}function Gi(){var va=h.mouse(this),li=Math.log(fe.k)/Math.LN2;sa(this,va,Qr(va),h.event.shiftKey?Math.ceil(li)-1:Math.floor(li)+1)}return h.rebind(un,fn,"on")};var an=[0,1/0],Kr,ot;h.color=er;function er(){}er.prototype.toString=function(){return this.rgb()+""},h.hsl=Kt;function Kt(fe,Ae,Fe){return this instanceof Kt?(this.h=+fe,this.s=+Ae,void(this.l=+Fe)):arguments.length<2?fe instanceof Kt?new Kt(fe.h,fe.s,fe.l):Zr(""+fe,ir,Kt):new Kt(fe,Ae,Fe)}var ur=Kt.prototype=new er;ur.brighter=function(fe){return fe=Math.pow(.7,arguments.length?fe:1),new Kt(this.h,this.s,this.l/fe)},ur.darker=function(fe){return fe=Math.pow(.7,arguments.length?fe:1),new Kt(this.h,this.s,fe*this.l)},ur.rgb=function(){return Ar(this.h,this.s,this.l)};function Ar(fe,Ae,Fe){var Ve,Ue;fe=isNaN(fe)?0:(fe%=360)<0?fe+360:fe,Ae=isNaN(Ae)||Ae<0?0:Ae>1?1:Ae,Fe=Fe<0?0:Fe>1?1:Fe,Ue=Fe<=.5?Fe*(1+Ae):Fe+Ae-Fe*Ae,Ve=2*Fe-Ue;function Qe(dt){return dt>360?dt-=360:dt<0&&(dt+=360),dt<60?Ve+(Ue-Ve)*dt/60:dt<180?Ue:dt<240?Ve+(Ue-Ve)*(240-dt)/60:Ve}function _t(dt){return Math.round(Qe(dt)*255)}return new Xt(_t(fe+120),_t(fe),_t(fe-120))}h.hcl=et;function et(fe,Ae,Fe){return this instanceof et?(this.h=+fe,this.c=+Ae,void(this.l=+Fe)):arguments.length<2?fe instanceof et?new et(fe.h,fe.c,fe.l):fe instanceof ft?ht(fe.l,fe.a,fe.b):ht((fe=xr((fe=h.rgb(fe)).r,fe.g,fe.b)).l,fe.a,fe.b):new et(fe,Ae,Fe)}var $e=et.prototype=new er;$e.brighter=function(fe){return new et(this.h,this.c,Math.min(100,this.l+St*(arguments.length?fe:1)))},$e.darker=function(fe){return new et(this.h,this.c,Math.max(0,this.l-St*(arguments.length?fe:1)))},$e.rgb=function(){return st(this.h,this.c,this.l).rgb()};function st(fe,Ae,Fe){return isNaN(fe)&&(fe=0),isNaN(Ae)&&(Ae=0),new ft(Fe,Math.cos(fe*=Tt)*Ae,Math.sin(fe)*Ae)}h.lab=ft;function ft(fe,Ae,Fe){return this instanceof ft?(this.l=+fe,this.a=+Ae,void(this.b=+Fe)):arguments.length<2?fe instanceof ft?new ft(fe.l,fe.a,fe.b):fe instanceof et?st(fe.h,fe.c,fe.l):xr((fe=Xt(fe)).r,fe.g,fe.b):new ft(fe,Ae,Fe)}var St=18,Ut=.95047,Pe=1,ke=1.08883,it=ft.prototype=new er;it.brighter=function(fe){return new ft(Math.min(100,this.l+St*(arguments.length?fe:1)),this.a,this.b)},it.darker=function(fe){return new ft(Math.max(0,this.l-St*(arguments.length?fe:1)),this.a,this.b)},it.rgb=function(){return ut(this.l,this.a,this.b)};function ut(fe,Ae,Fe){var Ve=(fe+16)/116,Ue=Ve+Ae/500,Qe=Ve-Fe/200;return Ue=Et(Ue)*Ut,Ve=Et(Ve)*Pe,Qe=Et(Qe)*ke,new Xt(Dt(3.2404542*Ue-1.5371385*Ve-.4985314*Qe),Dt(-.969266*Ue+1.8760108*Ve+.041556*Qe),Dt(.0556434*Ue-.2040259*Ve+1.0572252*Qe))}function ht(fe,Ae,Fe){return fe>0?new et(Math.atan2(Fe,Ae)*mt,Math.sqrt(Ae*Ae+Fe*Fe),fe):new et(NaN,NaN,fe)}function Et(fe){return fe>.206893034?fe*fe*fe:(fe-4/29)/7.787037}function yt(fe){return fe>.008856?Math.pow(fe,1/3):7.787037*fe+4/29}function Dt(fe){return Math.round(255*(fe<=.00304?12.92*fe:1.055*Math.pow(fe,1/2.4)-.055))}h.rgb=Xt;function Xt(fe,Ae,Fe){return this instanceof Xt?(this.r=~~fe,this.g=~~Ae,void(this.b=~~Fe)):arguments.length<2?fe instanceof Xt?new Xt(fe.r,fe.g,fe.b):Zr(""+fe,Xt,Ar):new Xt(fe,Ae,Fe)}function ar(fe){return new Xt(fe>>16,fe>>8&255,fe&255)}function kr(fe){return ar(fe)+""}var wr=Xt.prototype=new er;wr.brighter=function(fe){fe=Math.pow(.7,arguments.length?fe:1);var Ae=this.r,Fe=this.g,Ve=this.b,Ue=30;return!Ae&&!Fe&&!Ve?new Xt(Ue,Ue,Ue):(Ae&&Ae<Ue&&(Ae=Ue),Fe&&Fe<Ue&&(Fe=Ue),Ve&&Ve<Ue&&(Ve=Ue),new Xt(Math.min(255,Ae/fe),Math.min(255,Fe/fe),Math.min(255,Ve/fe)))},wr.darker=function(fe){return fe=Math.pow(.7,arguments.length?fe:1),new Xt(fe*this.r,fe*this.g,fe*this.b)},wr.hsl=function(){return ir(this.r,this.g,this.b)},wr.toString=function(){return"#"+Sr(this.r)+Sr(this.g)+Sr(this.b)};function Sr(fe){return fe<16?"0"+Math.max(0,fe).toString(16):Math.min(255,fe).toString(16)}function Zr(fe,Ae,Fe){var Ve=0,Ue=0,Qe=0,_t,dt,It;if(_t=/([a-z]+)\((.*)\)/.exec(fe=fe.toLowerCase()),_t)switch(dt=_t[2].split(","),_t[1]){case"hsl":return Fe(parseFloat(dt[0]),parseFloat(dt[1])/100,parseFloat(dt[2])/100);case"rgb":return Ae(Or(dt[0]),Or(dt[1]),Or(dt[2]))}return(It=Cr.get(fe))?Ae(It.r,It.g,It.b):(fe!=null&&fe.charAt(0)==="#"&&!isNaN(It=parseInt(fe.slice(1),16))&&(fe.length===4?(Ve=(It&3840)>>4,Ve=Ve>>4|Ve,Ue=It&240,Ue=Ue>>4|Ue,Qe=It&15,Qe=Qe<<4|Qe):fe.length===7&&(Ve=(It&16711680)>>16,Ue=(It&65280)>>8,Qe=It&255)),Ae(Ve,Ue,Qe))}function ir(fe,Ae,Fe){var Ve=Math.min(fe/=255,Ae/=255,Fe/=255),Ue=Math.max(fe,Ae,Fe),Qe=Ue-Ve,_t,dt,It=(Ue+Ve)/2;return Qe?(dt=It<.5?Qe/(Ue+Ve):Qe/(2-Ue-Ve),fe==Ue?_t=(Ae-Fe)/Qe+(Ae<Fe?6:0):Ae==Ue?_t=(Fe-fe)/Qe+2:_t=(fe-Ae)/Qe+4,_t*=60):(_t=NaN,dt=It>0&&It<1?0:_t),new Kt(_t,dt,It)}function xr(fe,Ae,Fe){fe=Fr(fe),Ae=Fr(Ae),Fe=Fr(Fe);var Ve=yt((.4124564*fe+.3575761*Ae+.1804375*Fe)/Ut),Ue=yt((.2126729*fe+.7151522*Ae+.072175*Fe)/Pe),Qe=yt((.0193339*fe+.119192*Ae+.9503041*Fe)/ke);return ft(116*Ue-16,500*(Ve-Ue),200*(Ue-Qe))}function Fr(fe){return(fe/=255)<=.04045?fe/12.92:Math.pow((fe+.055)/1.055,2.4)}function Or(fe){var Ae=parseFloat(fe);return fe.charAt(fe.length-1)==="%"?Math.round(Ae*2.55):Ae}var Cr=h.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Cr.forEach(function(fe,Ae){Cr.set(fe,ar(Ae))});function at(fe){return typeof fe=="function"?fe:function(){return fe}}h.functor=at,h.xhr=Ft(F);function Ft(fe){return function(Ae,Fe,Ve){return arguments.length===2&&typeof Fe=="function"&&(Ve=Fe,Fe=null),jt(Ae,Fe,fe,Ve)}}function jt(fe,Ae,Fe,Ve){var Ue={},Qe=h.dispatch("beforesend","progress","load","error"),_t={},dt=new XMLHttpRequest,It=null;self.XDomainRequest&&!("withCredentials"in dt)&&/^(http(s)?:)?\/\//.test(fe)&&(dt=new XDomainRequest),"onload"in dt?dt.onload=dt.onerror=Qt:dt.onreadystatechange=function(){dt.readyState>3&&Qt()};function Qt(){var tr=dt.status,rr;if(!tr&&zr(dt)||tr>=200&&tr<300||tr===304){try{rr=Fe.call(Ue,dt)}catch(Er){Qe.error.call(Ue,Er);return}Qe.load.call(Ue,rr)}else Qe.error.call(Ue,dt)}return dt.onprogress=function(tr){var rr=h.event;h.event=tr;try{Qe.progress.call(Ue,dt)}finally{h.event=rr}},Ue.header=function(tr,rr){return tr=(tr+"").toLowerCase(),arguments.length<2?_t[tr]:(rr==null?delete _t[tr]:_t[tr]=rr+"",Ue)},Ue.mimeType=function(tr){return arguments.length?(Ae=tr==null?null:tr+"",Ue):Ae},Ue.responseType=function(tr){return arguments.length?(It=tr,Ue):It},Ue.response=function(tr){return Fe=tr,Ue},["get","post"].forEach(function(tr){Ue[tr]=function(){return Ue.send.apply(Ue,[tr].concat(A(arguments)))}}),Ue.send=function(tr,rr,Er){if(arguments.length===2&&typeof rr=="function"&&(Er=rr,rr=null),dt.open(tr,fe,!0),Ae!=null&&!("accept"in _t)&&(_t.accept=Ae+",*/*"),dt.setRequestHeader)for(var qr in _t)dt.setRequestHeader(qr,_t[qr]);return Ae!=null&&dt.overrideMimeType&&dt.overrideMimeType(Ae),It!=null&&(dt.responseType=It),Er!=null&&Ue.on("error",Er).on("load",function(fn){Er(null,fn)}),Qe.beforesend.call(Ue,dt),dt.send(rr==null?null:rr),Ue},Ue.abort=function(){return dt.abort(),Ue},h.rebind(Ue,Qe,"on"),Ve==null?Ue:Ue.get(sr(Ve))}function sr(fe){return fe.length===1?function(Ae,Fe){fe(Ae==null?Fe:null)}:fe}function zr(fe){var Ae=fe.responseType;return Ae&&Ae!=="text"?fe.response:fe.responseText}h.dsv=function(fe,Ae){var Fe=new RegExp('["'+fe+`
]`),Ve=fe.charCodeAt(0);function Ue(Qt,tr,rr){arguments.length<3&&(rr=tr,tr=null);var Er=jt(Qt,Ae,tr==null?Qe:_t(tr),rr);return Er.row=function(qr){return arguments.length?Er.response((tr=qr)==null?Qe:_t(qr)):tr},Er}function Qe(Qt){return Ue.parse(Qt.responseText)}function _t(Qt){return function(tr){return Ue.parse(tr.responseText,Qt)}}Ue.parse=function(Qt,tr){var rr;return Ue.parseRows(Qt,function(Er,qr){if(rr)return rr(Er,qr-1);var fn=function(Pr){for(var Vr={},Jr=Er.length,sn=0;sn<Jr;++sn)Vr[Er[sn]]=Pr[sn];return Vr};rr=tr?function(Pr,Vr){return tr(fn(Pr),Vr)}:fn})},Ue.parseRows=function(Qt,tr){var rr={},Er={},qr=[],fn=Qt.length,Pr=0,Vr=0,Jr,sn;function un(){if(Pr>=fn)return Er;if(sn)return sn=!1,rr;var Hn=Pr;if(Qt.charCodeAt(Hn)===34){for(var aa=Hn;aa++<fn;)if(Qt.charCodeAt(aa)===34){if(Qt.charCodeAt(aa+1)!==34)break;++aa}Pr=aa+2;var Aa=Qt.charCodeAt(aa+1);return Aa===13?(sn=!0,Qt.charCodeAt(aa+2)===10&&++Pr):Aa===10&&(sn=!0),Qt.slice(Hn+1,aa).replace(/""/g,'"')}for(;Pr<fn;){var Aa=Qt.charCodeAt(Pr++),sa=1;if(Aa===10)sn=!0;else if(Aa===13)sn=!0,Qt.charCodeAt(Pr)===10&&(++Pr,++sa);else if(Aa!==Ve)continue;return Qt.slice(Hn,Pr-sa)}return Qt.slice(Hn)}for(;(Jr=un())!==Er;){for(var Qr=[];Jr!==rr&&Jr!==Er;)Qr.push(Jr),Jr=un();tr&&(Qr=tr(Qr,Vr++))==null||qr.push(Qr)}return qr},Ue.format=function(Qt){if(Array.isArray(Qt[0]))return Ue.formatRows(Qt);var tr=new z,rr=[];return Qt.forEach(function(Er){for(var qr in Er)tr.has(qr)||rr.push(tr.add(qr))}),[rr.map(It).join(fe)].concat(Qt.map(function(Er){return rr.map(function(qr){return It(Er[qr])}).join(fe)})).join(`
`)},Ue.formatRows=function(Qt){return Qt.map(dt).join(`
`)};function dt(Qt){return Qt.map(It).join(fe)}function It(Qt){return Fe.test(Qt)?'"'+Qt.replace(/\"/g,'""')+'"':Qt}return Ue},h.csv=h.dsv(",","text/csv"),h.tsv=h.dsv("	","text/tab-separated-values");var Ur,Dr,Tr,Wr,An=this[O(this,"requestAnimationFrame")]||function(fe){setTimeout(fe,17)};h.timer=function(){vn.apply(this,arguments)};function vn(fe,Ae,Fe){var Ve=arguments.length;Ve<2&&(Ae=0),Ve<3&&(Fe=Date.now());var Ue=Fe+Ae,Qe={c:fe,t:Ue,n:null};return Dr?Dr.n=Qe:Ur=Qe,Dr=Qe,Tr||(Wr=clearTimeout(Wr),Tr=1,An(Un)),Qe}function Un(){var fe=Dn(),Ae=Xn()-fe;Ae>24?(isFinite(Ae)&&(clearTimeout(Wr),Wr=setTimeout(Un,Ae)),Tr=0):(Tr=1,An(Un))}h.timer.flush=function(){Dn(),Xn()};function Dn(){for(var fe=Date.now(),Ae=Ur;Ae;)fe>=Ae.t&&Ae.c(fe-Ae.t)&&(Ae.c=null),Ae=Ae.n;return fe}function Xn(){for(var fe,Ae=Ur,Fe=1/0;Ae;)Ae.c?(Ae.t<Fe&&(Fe=Ae.t),Ae=(fe=Ae).n):Ae=fe?fe.n=Ae.n:Ur=Ae.n;return Dr=fe,Fe}h.round=function(fe,Ae){return Ae?Math.round(fe*(Ae=Math.pow(10,Ae)))/Ae:Math.round(fe)},h.geom={};function Yn(fe){return fe[0]}function ya(fe){return fe[1]}h.geom.hull=function(fe){var Ae=Yn,Fe=ya;if(arguments.length)return Ve(fe);function Ve(Ue){if(Ue.length<3)return[];var Qe=at(Ae),_t=at(Fe),dt,It=Ue.length,Qt=[],tr=[];for(dt=0;dt<It;dt++)Qt.push([+Qe.call(this,Ue[dt],dt),+_t.call(this,Ue[dt],dt),dt]);for(Qt.sort(gi),dt=0;dt<It;dt++)tr.push([Qt[dt][0],-Qt[dt][1]]);var rr=Ca(Qt),Er=Ca(tr),qr=Er[0]===rr[0],fn=Er[Er.length-1]===rr[rr.length-1],Pr=[];for(dt=rr.length-1;dt>=0;--dt)Pr.push(Ue[Qt[rr[dt]][2]]);for(dt=+qr;dt<Er.length-fn;++dt)Pr.push(Ue[Qt[Er[dt]][2]]);return Pr}return Ve.x=function(Ue){return arguments.length?(Ae=Ue,Ve):Ae},Ve.y=function(Ue){return arguments.length?(Fe=Ue,Ve):Fe},Ve};function Ca(fe){for(var Ae=fe.length,Fe=[0,1],Ve=2,Ue=2;Ue<Ae;Ue++){for(;Ve>1&&Mt(fe[Fe[Ve-2]],fe[Fe[Ve-1]],fe[Ue])<=0;)--Ve;Fe[Ve++]=Ue}return Fe.slice(0,Ve)}function gi(fe,Ae){return fe[0]-Ae[0]||fe[1]-Ae[1]}h.geom.polygon=function(fe){return K(fe,Xa),fe};var Xa=h.geom.polygon.prototype=[];Xa.area=function(){for(var fe=-1,Ae=this.length,Fe,Ve=this[Ae-1],Ue=0;++fe<Ae;)Fe=Ve,Ve=this[fe],Ue+=Fe[1]*Ve[0]-Fe[0]*Ve[1];return Ue*.5},Xa.centroid=function(fe){var Ae=-1,Fe=this.length,Ve=0,Ue=0,Qe,_t=this[Fe-1],dt;for(arguments.length||(fe=-1/(6*this.area()));++Ae<Fe;)Qe=_t,_t=this[Ae],dt=Qe[0]*_t[1]-_t[0]*Qe[1],Ve+=(Qe[0]+_t[0])*dt,Ue+=(Qe[1]+_t[1])*dt;return[Ve*fe,Ue*fe]},Xa.clip=function(fe){for(var Ae,Fe=Mr(fe),Ve=-1,Ue=this.length-Mr(this),Qe,_t,dt=this[Ue-1],It,Qt,tr;++Ve<Ue;){for(Ae=fe.slice(),fe.length=0,It=this[Ve],Qt=Ae[(_t=Ae.length-Fe)-1],Qe=-1;++Qe<_t;)tr=Ae[Qe],$a(tr,dt,It)?($a(Qt,dt,It)||fe.push(Ja(Qt,tr,dt,It)),fe.push(tr)):$a(Qt,dt,It)&&fe.push(Ja(Qt,tr,dt,It)),Qt=tr;Fe&&fe.push(fe[0]),dt=It}return fe};function $a(fe,Ae,Fe){return(Fe[0]-Ae[0])*(fe[1]-Ae[1])<(Fe[1]-Ae[1])*(fe[0]-Ae[0])}function Ja(fe,Ae,Fe,Ve){var Ue=fe[0],Qe=Fe[0],_t=Ae[0]-Ue,dt=Ve[0]-Qe,It=fe[1],Qt=Fe[1],tr=Ae[1]-It,rr=Ve[1]-Qt,Er=(dt*(It-Qt)-rr*(Ue-Qe))/(rr*_t-dt*tr);return[Ue+Er*_t,It+Er*tr]}function Mr(fe){var Ae=fe[0],Fe=fe[fe.length-1];return!(Ae[0]-Fe[0]||Ae[1]-Fe[1])}var gn,hn,Sn,Jn=[],ha,ra,In=[];function jn(){ua(this),this.edge=this.site=this.circle=null}function Ga(fe){var Ae=Jn.pop()||new jn;return Ae.site=fe,Ae}function vi(fe){br(fe),Sn.remove(fe),Jn.push(fe),ua(fe)}function Gt(fe){var Ae=fe.circle,Fe=Ae.x,Ve=Ae.cy,Ue={x:Fe,y:Ve},Qe=fe.P,_t=fe.N,dt=[fe];vi(fe);for(var It=Qe;It.circle&&l(Fe-It.circle.x)<nt&&l(Ve-It.circle.cy)<nt;)Qe=It.P,dt.unshift(It),vi(It),It=Qe;dt.unshift(It),br(It);for(var Qt=_t;Qt.circle&&l(Fe-Qt.circle.x)<nt&&l(Ve-Qt.circle.cy)<nt;)_t=Qt.N,dt.push(Qt),vi(Qt),Qt=_t;dt.push(Qt),br(Qt);var tr=dt.length,rr;for(rr=1;rr<tr;++rr)Qt=dt[rr],It=dt[rr-1],oa(Qt.edge,It.site,Qt.site,Ue);It=dt[0],Qt=dt[tr-1],Qt.edge=Tn(It.site,Qt.site,null,Ue),mr(It),mr(Qt)}function pr(fe){for(var Ae=fe.x,Fe=fe.y,Ve,Ue,Qe,_t,dt=Sn._;dt;)if(Qe=on(dt,Fe)-Ae,Qe>nt)dt=dt.L;else if(_t=Ae-dn(dt,Fe),_t>nt){if(!dt.R){Ve=dt;break}dt=dt.R}else{Qe>-nt?(Ve=dt.P,Ue=dt):_t>-nt?(Ve=dt,Ue=dt.N):Ve=Ue=dt;break}var It=Ga(fe);if(Sn.insert(Ve,It),!(!Ve&&!Ue)){if(Ve===Ue){br(Ve),Ue=Ga(Ve.site),Sn.insert(It,Ue),It.edge=Ue.edge=Tn(Ve.site,It.site),mr(Ve),mr(Ue);return}if(!Ue){It.edge=Tn(Ve.site,It.site);return}br(Ve),br(Ue);var Qt=Ve.site,tr=Qt.x,rr=Qt.y,Er=fe.x-tr,qr=fe.y-rr,fn=Ue.site,Pr=fn.x-tr,Vr=fn.y-rr,Jr=2*(Er*Vr-qr*Pr),sn=Er*Er+qr*qr,un=Pr*Pr+Vr*Vr,Qr={x:(Vr*sn-qr*un)/Jr+tr,y:(Er*un-Pr*sn)/Jr+rr};oa(Ue.edge,Qt,fn,Qr),It.edge=Tn(Qt,fe,null,Qr),Ue.edge=Tn(fe,fn,null,Qr),mr(Ve),mr(Ue)}}function on(fe,Ae){var Fe=fe.site,Ve=Fe.x,Ue=Fe.y,Qe=Ue-Ae;if(!Qe)return Ve;var _t=fe.P;if(!_t)return-1/0;Fe=_t.site;var dt=Fe.x,It=Fe.y,Qt=It-Ae;if(!Qt)return dt;var tr=dt-Ve,rr=1/Qe-1/Qt,Er=tr/Qt;return rr?(-Er+Math.sqrt(Er*Er-2*rr*(tr*tr/(-2*Qt)-It+Qt/2+Ue-Qe/2)))/rr+Ve:(Ve+dt)/2}function dn(fe,Ae){var Fe=fe.N;if(Fe)return on(Fe,Ae);var Ve=fe.site;return Ve.y===Ae?Ve.x:1/0}function rn(fe){this.site=fe,this.edges=[]}rn.prototype.prepare=function(){for(var fe=this.edges,Ae=fe.length,Fe;Ae--;)Fe=fe[Ae].edge,(!Fe.b||!Fe.a)&&fe.splice(Ae,1);return fe.sort(_n),fe.length};function Mn(fe){for(var Ae=fe[0][0],Fe=fe[1][0],Ve=fe[0][1],Ue=fe[1][1],Qe,_t,dt,It,Qt=hn,tr=Qt.length,rr,Er,qr,fn,Pr,Vr;tr--;)if(rr=Qt[tr],!(!rr||!rr.prepare()))for(qr=rr.edges,fn=qr.length,Er=0;Er<fn;)Vr=qr[Er].end(),dt=Vr.x,It=Vr.y,Pr=qr[++Er%fn].start(),Qe=Pr.x,_t=Pr.y,(l(dt-Qe)>nt||l(It-_t)>nt)&&(qr.splice(Er,0,new ma(Kn(rr.site,Vr,l(dt-Ae)<nt&&Ue-It>nt?{x:Ae,y:l(Qe-Ae)<nt?_t:Ue}:l(It-Ue)<nt&&Fe-dt>nt?{x:l(_t-Ue)<nt?Qe:Fe,y:Ue}:l(dt-Fe)<nt&&It-Ve>nt?{x:Fe,y:l(Qe-Fe)<nt?_t:Ve}:l(It-Ve)<nt&&dt-Ae>nt?{x:l(_t-Ve)<nt?Qe:Ae,y:Ve}:null),rr.site,null)),++fn)}function _n(fe,Ae){return Ae.angle-fe.angle}function cn(){ua(this),this.x=this.y=this.arc=this.site=this.cy=null}function mr(fe){var Ae=fe.P,Fe=fe.N;if(!(!Ae||!Fe)){var Ve=Ae.site,Ue=fe.site,Qe=Fe.site;if(Ve!==Qe){var _t=Ue.x,dt=Ue.y,It=Ve.x-_t,Qt=Ve.y-dt,tr=Qe.x-_t,Vr=Qe.y-dt,rr=2*(It*Vr-Qt*tr);if(!(rr>=-Ye)){var Er=It*It+Qt*Qt,qr=tr*tr+Vr*Vr,fn=(Vr*Er-Qt*qr)/rr,Pr=(It*qr-tr*Er)/rr,Vr=Pr+dt,Jr=In.pop()||new cn;Jr.arc=fe,Jr.site=Ue,Jr.x=fn+_t,Jr.y=Vr+Math.sqrt(fn*fn+Pr*Pr),Jr.cy=Vr,fe.circle=Jr;for(var sn=null,un=ra._;un;)if(Jr.y<un.y||Jr.y===un.y&&Jr.x<=un.x)if(un.L)un=un.L;else{sn=un.P;break}else if(un.R)un=un.R;else{sn=un;break}ra.insert(sn,Jr),sn||(ha=Jr)}}}}function br(fe){var Ae=fe.circle;Ae&&(Ae.P||(ha=Ae.N),ra.remove(Ae),In.push(Ae),ua(Ae),fe.circle=null)}function Br(fe,Ae,Fe,Ve){return function(Ue){var Qe=Ue.a,_t=Ue.b,dt=Qe.x,It=Qe.y,Qt=_t.x,tr=_t.y,rr=0,Er=1,qr=Qt-dt,fn=tr-It,Pr;if(Pr=fe-dt,!(!qr&&Pr>0)){if(Pr/=qr,qr<0){if(Pr<rr)return;Pr<Er&&(Er=Pr)}else if(qr>0){if(Pr>Er)return;Pr>rr&&(rr=Pr)}if(Pr=Fe-dt,!(!qr&&Pr<0)){if(Pr/=qr,qr<0){if(Pr>Er)return;Pr>rr&&(rr=Pr)}else if(qr>0){if(Pr<rr)return;Pr<Er&&(Er=Pr)}if(Pr=Ae-It,!(!fn&&Pr>0)){if(Pr/=fn,fn<0){if(Pr<rr)return;Pr<Er&&(Er=Pr)}else if(fn>0){if(Pr>Er)return;Pr>rr&&(rr=Pr)}if(Pr=Ve-It,!(!fn&&Pr<0)){if(Pr/=fn,fn<0){if(Pr>Er)return;Pr>rr&&(rr=Pr)}else if(fn>0){if(Pr<rr)return;Pr<Er&&(Er=Pr)}return rr>0&&(Ue.a={x:dt+rr*qr,y:It+rr*fn}),Er<1&&(Ue.b={x:dt+Er*qr,y:It+Er*fn}),Ue}}}}}}function mn(fe){for(var Ae=gn,Fe=Br(fe[0][0],fe[0][1],fe[1][0],fe[1][1]),Ve=Ae.length,Ue;Ve--;)Ue=Ae[Ve],(!On(Ue,fe)||!Fe(Ue)||l(Ue.a.x-Ue.b.x)<nt&&l(Ue.a.y-Ue.b.y)<nt)&&(Ue.a=Ue.b=null,Ae.splice(Ve,1))}function On(fe,Ae){var Fe=fe.b;if(Fe)return!0;var Ve=fe.a,Ue=Ae[0][0],Qe=Ae[1][0],_t=Ae[0][1],dt=Ae[1][1],It=fe.l,Qt=fe.r,tr=It.x,rr=It.y,Er=Qt.x,qr=Qt.y,fn=(tr+Er)/2,Pr=(rr+qr)/2,Vr,Jr;if(qr===rr){if(fn<Ue||fn>=Qe)return;if(tr>Er){if(!Ve)Ve={x:fn,y:_t};else if(Ve.y>=dt)return;Fe={x:fn,y:dt}}else{if(!Ve)Ve={x:fn,y:dt};else if(Ve.y<_t)return;Fe={x:fn,y:_t}}}else if(Vr=(tr-Er)/(qr-rr),Jr=Pr-Vr*fn,Vr<-1||Vr>1)if(tr>Er){if(!Ve)Ve={x:(_t-Jr)/Vr,y:_t};else if(Ve.y>=dt)return;Fe={x:(dt-Jr)/Vr,y:dt}}else{if(!Ve)Ve={x:(dt-Jr)/Vr,y:dt};else if(Ve.y<_t)return;Fe={x:(_t-Jr)/Vr,y:_t}}else if(rr<qr){if(!Ve)Ve={x:Ue,y:Vr*Ue+Jr};else if(Ve.x>=Qe)return;Fe={x:Qe,y:Vr*Qe+Jr}}else{if(!Ve)Ve={x:Qe,y:Vr*Qe+Jr};else if(Ve.x<Ue)return;Fe={x:Ue,y:Vr*Ue+Jr}}return fe.a=Ve,fe.b=Fe,!0}function na(fe,Ae){this.l=fe,this.r=Ae,this.a=this.b=null}function Tn(fe,Ae,Fe,Ve){var Ue=new na(fe,Ae);return gn.push(Ue),Fe&&oa(Ue,fe,Ae,Fe),Ve&&oa(Ue,Ae,fe,Ve),hn[fe.i].edges.push(new ma(Ue,fe,Ae)),hn[Ae.i].edges.push(new ma(Ue,Ae,fe)),Ue}function Kn(fe,Ae,Fe){var Ve=new na(fe,null);return Ve.a=Ae,Ve.b=Fe,gn.push(Ve),Ve}function oa(fe,Ae,Fe,Ve){!fe.a&&!fe.b?(fe.a=Ve,fe.l=Ae,fe.r=Fe):fe.l===Fe?fe.b=Ve:fe.a=Ve}function ma(fe,Ae,Fe){var Ve=fe.a,Ue=fe.b;this.edge=fe,this.site=Ae,this.angle=Fe?Math.atan2(Fe.y-Ae.y,Fe.x-Ae.x):fe.l===Ae?Math.atan2(Ue.x-Ve.x,Ve.y-Ue.y):Math.atan2(Ve.x-Ue.x,Ue.y-Ve.y)}ma.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function _a(){this._=null}function ua(fe){fe.U=fe.C=fe.L=fe.R=fe.P=fe.N=null}_a.prototype={insert:function(fe,Ae){var Fe,Ve,Ue;if(fe){if(Ae.P=fe,Ae.N=fe.N,fe.N&&(fe.N.P=Ae),fe.N=Ae,fe.R){for(fe=fe.R;fe.L;)fe=fe.L;fe.L=Ae}else fe.R=Ae;Fe=fe}else this._?(fe=jo(this._),Ae.P=null,Ae.N=fe,fe.P=fe.L=Ae,Fe=fe):(Ae.P=Ae.N=null,this._=Ae,Fe=null);for(Ae.L=Ae.R=null,Ae.U=Fe,Ae.C=!0,fe=Ae;Fe&&Fe.C;)Ve=Fe.U,Fe===Ve.L?(Ue=Ve.R,Ue&&Ue.C?(Fe.C=Ue.C=!1,Ve.C=!0,fe=Ve):(fe===Fe.R&&(Ea(this,Fe),fe=Fe,Fe=fe.U),Fe.C=!1,Ve.C=!0,Mo(this,Ve))):(Ue=Ve.L,Ue&&Ue.C?(Fe.C=Ue.C=!1,Ve.C=!0,fe=Ve):(fe===Fe.L&&(Mo(this,Fe),fe=Fe,Fe=fe.U),Fe.C=!1,Ve.C=!0,Ea(this,Ve))),Fe=fe.U;this._.C=!1},remove:function(fe){fe.N&&(fe.N.P=fe.P),fe.P&&(fe.P.N=fe.N),fe.N=fe.P=null;var Ae=fe.U,Fe,Ve=fe.L,Ue=fe.R,Qe,_t;if(Ve?Ue?Qe=jo(Ue):Qe=Ve:Qe=Ue,Ae?Ae.L===fe?Ae.L=Qe:Ae.R=Qe:this._=Qe,Ve&&Ue?(_t=Qe.C,Qe.C=fe.C,Qe.L=Ve,Ve.U=Qe,Qe!==Ue?(Ae=Qe.U,Qe.U=fe.U,fe=Qe.R,Ae.L=fe,Qe.R=Ue,Ue.U=Qe):(Qe.U=Ae,Ae=Qe,fe=Qe.R)):(_t=fe.C,fe=Qe),fe&&(fe.U=Ae),!_t){if(fe&&fe.C){fe.C=!1;return}do{if(fe===this._)break;if(fe===Ae.L){if(Fe=Ae.R,Fe.C&&(Fe.C=!1,Ae.C=!0,Ea(this,Ae),Fe=Ae.R),Fe.L&&Fe.L.C||Fe.R&&Fe.R.C){(!Fe.R||!Fe.R.C)&&(Fe.L.C=!1,Fe.C=!0,Mo(this,Fe),Fe=Ae.R),Fe.C=Ae.C,Ae.C=Fe.R.C=!1,Ea(this,Ae),fe=this._;break}}else if(Fe=Ae.L,Fe.C&&(Fe.C=!1,Ae.C=!0,Mo(this,Ae),Fe=Ae.L),Fe.L&&Fe.L.C||Fe.R&&Fe.R.C){(!Fe.L||!Fe.L.C)&&(Fe.R.C=!1,Fe.C=!0,Ea(this,Fe),Fe=Ae.L),Fe.C=Ae.C,Ae.C=Fe.L.C=!1,Mo(this,Ae),fe=this._;break}Fe.C=!0,fe=Ae,Ae=Ae.U}while(!fe.C);fe&&(fe.C=!1)}}};function Ea(fe,Ae){var Fe=Ae,Ve=Ae.R,Ue=Fe.U;Ue?Ue.L===Fe?Ue.L=Ve:Ue.R=Ve:fe._=Ve,Ve.U=Ue,Fe.U=Ve,Fe.R=Ve.L,Fe.R&&(Fe.R.U=Fe),Ve.L=Fe}function Mo(fe,Ae){var Fe=Ae,Ve=Ae.L,Ue=Fe.U;Ue?Ue.L===Fe?Ue.L=Ve:Ue.R=Ve:fe._=Ve,Ve.U=Ue,Fe.U=Ve,Fe.L=Ve.R,Fe.L&&(Fe.L.U=Fe),Ve.R=Fe}function jo(fe){for(;fe.L;)fe=fe.L;return fe}function vs(fe,Ae){var Fe=fe.sort(El).pop(),Ve,Ue,Qe;for(gn=[],hn=new Array(fe.length),Sn=new _a,ra=new _a;;)if(Qe=ha,Fe&&(!Qe||Fe.y<Qe.y||Fe.y===Qe.y&&Fe.x<Qe.x))(Fe.x!==Ve||Fe.y!==Ue)&&(hn[Fe.i]=new rn(Fe),pr(Fe),Ve=Fe.x,Ue=Fe.y),Fe=fe.pop();else if(Qe)Gt(Qe.arc);else break;Ae&&(mn(Ae),Mn(Ae));var _t={cells:hn,edges:gn};return Sn=ra=gn=hn=null,_t}function El(fe,Ae){return Ae.y-fe.y||Ae.x-fe.x}h.geom.voronoi=function(fe){var Ae=Yn,Fe=ya,Ve=Ae,Ue=Fe,Qe=Ol;if(fe)return _t(fe);function _t(It){var Qt=new Array(It.length),tr=Qe[0][0],rr=Qe[0][1],Er=Qe[1][0],qr=Qe[1][1];return vs(dt(It),Qe).cells.forEach(function(fn,Pr){var Vr=fn.edges,Jr=fn.site,sn=Qt[Pr]=Vr.length?Vr.map(function(un){var Qr=un.start();return[Qr.x,Qr.y]}):Jr.x>=tr&&Jr.x<=Er&&Jr.y>=rr&&Jr.y<=qr?[[tr,qr],[Er,qr],[Er,rr],[tr,rr]]:[];sn.point=It[Pr]}),Qt}function dt(It){return It.map(function(Qt,tr){return{x:Math.round(Ve(Qt,tr)/nt)*nt,y:Math.round(Ue(Qt,tr)/nt)*nt,i:tr}})}return _t.links=function(It){return vs(dt(It)).edges.filter(function(Qt){return Qt.l&&Qt.r}).map(function(Qt){return{source:It[Qt.l.i],target:It[Qt.r.i]}})},_t.triangles=function(It){var Qt=[];return vs(dt(It)).cells.forEach(function(tr,rr){for(var Er=tr.site,qr=tr.edges.sort(_n),fn=-1,Pr=qr.length,Vr,Jr=qr[Pr-1].edge,sn=Jr.l===Er?Jr.r:Jr.l;++fn<Pr;)Vr=sn,Jr=qr[fn].edge,sn=Jr.l===Er?Jr.r:Jr.l,rr<Vr.i&&rr<sn.i&&mu(Er,Vr,sn)<0&&Qt.push([It[rr],It[Vr.i],It[sn.i]])}),Qt},_t.x=function(It){return arguments.length?(Ve=at(Ae=It),_t):Ae},_t.y=function(It){return arguments.length?(Ue=at(Fe=It),_t):Fe},_t.clipExtent=function(It){return arguments.length?(Qe=It==null?Ol:It,_t):Qe===Ol?null:Qe},_t.size=function(It){return arguments.length?_t.clipExtent(It&&[[0,0],It]):Qe===Ol?null:Qe&&Qe[1]},_t};var Ol=[[-1e6,-1e6],[1e6,1e6]];function mu(fe,Ae,Fe){return(fe.x-Fe.x)*(Ae.y-fe.y)-(fe.x-Ae.x)*(Fe.y-fe.y)}h.geom.delaunay=function(fe){return h.geom.voronoi().triangles(fe)},h.geom.quadtree=function(fe,Ae,Fe,Ve,Ue){var Qe=Yn,_t=ya,dt;if(dt=arguments.length)return Qe=bi,_t=cl,dt===3&&(Ue=Fe,Ve=Ae,Fe=Ae=0),It(fe);function It(Qt){var tr,rr=at(Qe),Er=at(_t),qr,fn,Pr,Vr,Jr,sn,un,Qr;if(Ae!=null)Jr=Ae,sn=Fe,un=Ve,Qr=Ue;else if(un=Qr=-(Jr=sn=1/0),qr=[],fn=[],Vr=Qt.length,dt)for(Pr=0;Pr<Vr;++Pr)tr=Qt[Pr],tr.x<Jr&&(Jr=tr.x),tr.y<sn&&(sn=tr.y),tr.x>un&&(un=tr.x),tr.y>Qr&&(Qr=tr.y),qr.push(tr.x),fn.push(tr.y);else for(Pr=0;Pr<Vr;++Pr){var Hn=+rr(tr=Qt[Pr],Pr),aa=+Er(tr,Pr);Hn<Jr&&(Jr=Hn),aa<sn&&(sn=aa),Hn>un&&(un=Hn),aa>Qr&&(Qr=aa),qr.push(Hn),fn.push(aa)}var Aa=un-Jr,sa=Qr-sn;Aa>sa?Qr=sn+Aa:un=Jr+sa;function Da(Ra,ri,Ai,wo,Gi,va,li,Ka){if(!(isNaN(Ai)||isNaN(wo)))if(Ra.leaf){var Ii=Ra.x,ci=Ra.y;if(Ii!=null)if(l(Ii-Ai)+l(ci-wo)<.01)fa(Ra,ri,Ai,wo,Gi,va,li,Ka);else{var go=Ra.point;Ra.x=Ra.y=Ra.point=null,fa(Ra,go,Ii,ci,Gi,va,li,Ka),fa(Ra,ri,Ai,wo,Gi,va,li,Ka)}else Ra.x=Ai,Ra.y=wo,Ra.point=ri}else fa(Ra,ri,Ai,wo,Gi,va,li,Ka)}function fa(Ra,ri,Ai,wo,Gi,va,li,Ka){var Ii=(Gi+li)*.5,ci=(va+Ka)*.5,go=Ai>=Ii,so=wo>=ci,Co=so<<1|go;Ra.leaf=!1,Ra=Ra.nodes[Co]||(Ra.nodes[Co]=$s()),go?Gi=Ii:li=Ii,so?va=ci:Ka=ci,Da(Ra,ri,Ai,wo,Gi,va,li,Ka)}var Ha=$s();if(Ha.add=function(Ra){Da(Ha,Ra,+rr(Ra,++Pr),+Er(Ra,Pr),Jr,sn,un,Qr)},Ha.visit=function(Ra){Ki(Ra,Ha,Jr,sn,un,Qr)},Ha.find=function(Ra){return No(Ha,Ra[0],Ra[1],Jr,sn,un,Qr)},Pr=-1,Ae==null){for(;++Pr<Vr;)Da(Ha,Qt[Pr],qr[Pr],fn[Pr],Jr,sn,un,Qr);--Pr}else Qt.forEach(Ha.add);return qr=fn=Qt=tr=null,Ha}return It.x=function(Qt){return arguments.length?(Qe=Qt,It):Qe},It.y=function(Qt){return arguments.length?(_t=Qt,It):_t},It.extent=function(Qt){return arguments.length?(Qt==null?Ae=Fe=Ve=Ue=null:(Ae=+Qt[0][0],Fe=+Qt[0][1],Ve=+Qt[1][0],Ue=+Qt[1][1]),It):Ae==null?null:[[Ae,Fe],[Ve,Ue]]},It.size=function(Qt){return arguments.length?(Qt==null?Ae=Fe=Ve=Ue=null:(Ae=Fe=0,Ve=+Qt[0],Ue=+Qt[1]),It):Ae==null?null:[Ve-Ae,Ue-Fe]},It};function bi(fe){return fe.x}function cl(fe){return fe.y}function $s(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Ki(fe,Ae,Fe,Ve,Ue,Qe){if(!fe(Ae,Fe,Ve,Ue,Qe)){var _t=(Fe+Ue)*.5,dt=(Ve+Qe)*.5,It=Ae.nodes;It[0]&&Ki(fe,It[0],Fe,Ve,_t,dt),It[1]&&Ki(fe,It[1],_t,Ve,Ue,dt),It[2]&&Ki(fe,It[2],Fe,dt,_t,Qe),It[3]&&Ki(fe,It[3],_t,dt,Ue,Qe)}}function No(fe,Ae,Fe,Ve,Ue,Qe,_t){var dt=1/0,It;return function Qt(tr,rr,Er,qr,fn){if(!(rr>Qe||Er>_t||qr<Ve||fn<Ue)){if(Pr=tr.point){var Pr,Vr=Ae-tr.x,Jr=Fe-tr.y,sn=Vr*Vr+Jr*Jr;if(sn<dt){var un=Math.sqrt(dt=sn);Ve=Ae-un,Ue=Fe-un,Qe=Ae+un,_t=Fe+un,It=Pr}}for(var Qr=tr.nodes,Hn=(rr+qr)*.5,aa=(Er+fn)*.5,Aa=Ae>=Hn,sa=Fe>=aa,Da=sa<<1|Aa,fa=Da+4;Da<fa;++Da)if(tr=Qr[Da&3])switch(Da&3){case 0:Qt(tr,rr,Er,Hn,aa);break;case 1:Qt(tr,Hn,Er,qr,aa);break;case 2:Qt(tr,rr,aa,Hn,fn);break;case 3:Qt(tr,Hn,aa,qr,fn);break}}}(fe,Ve,Ue,Qe,_t),It}h.interpolateRgb=Ul;function Ul(fe,Ae){fe=h.rgb(fe),Ae=h.rgb(Ae);var Fe=fe.r,Ve=fe.g,Ue=fe.b,Qe=Ae.r-Fe,_t=Ae.g-Ve,dt=Ae.b-Ue;return function(It){return"#"+Sr(Math.round(Fe+Qe*It))+Sr(Math.round(Ve+_t*It))+Sr(Math.round(Ue+dt*It))}}h.interpolateObject=Ps;function Ps(fe,Ae){var Fe={},Ve={},Ue;for(Ue in fe)Ue in Ae?Fe[Ue]=vo(fe[Ue],Ae[Ue]):Ve[Ue]=fe[Ue];for(Ue in Ae)Ue in fe||(Ve[Ue]=Ae[Ue]);return function(Qe){for(Ue in Fe)Ve[Ue]=Fe[Ue](Qe);return Ve}}h.interpolateNumber=Vi;function Vi(fe,Ae){return fe=+fe,Ae=+Ae,function(Fe){return fe*(1-Fe)+Ae*Fe}}h.interpolateString=Cl;function Cl(fe,Ae){var Fe=io.lastIndex=Wi.lastIndex=0,Ve,Ue,Qe,_t=-1,dt=[],It=[];for(fe=fe+"",Ae=Ae+"";(Ve=io.exec(fe))&&(Ue=Wi.exec(Ae));)(Qe=Ue.index)>Fe&&(Qe=Ae.slice(Fe,Qe),dt[_t]?dt[_t]+=Qe:dt[++_t]=Qe),(Ve=Ve[0])===(Ue=Ue[0])?dt[_t]?dt[_t]+=Ue:dt[++_t]=Ue:(dt[++_t]=null,It.push({i:_t,x:Vi(Ve,Ue)})),Fe=Wi.lastIndex;return Fe<Ae.length&&(Qe=Ae.slice(Fe),dt[_t]?dt[_t]+=Qe:dt[++_t]=Qe),dt.length<2?It[0]?(Ae=It[0].x,function(Qt){return Ae(Qt)+""}):function(){return Ae}:(Ae=It.length,function(Qt){for(var tr=0,rr;tr<Ae;++tr)dt[(rr=It[tr]).i]=rr.x(Qt);return dt.join("")})}var io=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Wi=new RegExp(io.source,"g");h.interpolate=vo;function vo(fe,Ae){for(var Fe=h.interpolators.length,Ve;--Fe>=0&&!(Ve=h.interpolators[Fe](fe,Ae)););return Ve}h.interpolators=[function(fe,Ae){var Fe=typeof Ae;return(Fe==="string"?Cr.has(Ae.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(Ae)?Ul:Cl:Ae instanceof er?Ul:Array.isArray(Ae)?oo:Fe==="object"&&isNaN(Ae)?Ps:Vi)(fe,Ae)}],h.interpolateArray=oo;function oo(fe,Ae){var Fe=[],Ve=[],Ue=fe.length,Qe=Ae.length,_t=Math.min(fe.length,Ae.length),dt;for(dt=0;dt<_t;++dt)Fe.push(vo(fe[dt],Ae[dt]));for(;dt<Ue;++dt)Ve[dt]=fe[dt];for(;dt<Qe;++dt)Ve[dt]=Ae[dt];return function(It){for(dt=0;dt<_t;++dt)Ve[dt]=Fe[dt](It);return Ve}}var bs=function(){return F},hl=h.map({linear:bs,poly:Vs,quad:function(){return Oo},cubic:function(){return lf},sin:function(){return nu},exp:function(){return uf},circle:function(){return ff},elastic:vl,back:au,bounce:function(){return Hs}}),Ru=h.map({in:F,out:Iu,"in-out":qs,"out-in":function(fe){return qs(Iu(fe))}});h.ease=function(fe){var Ae=fe.indexOf("-"),Fe=Ae>=0?fe.slice(0,Ae):fe,Ve=Ae>=0?fe.slice(Ae+1):"in";return Fe=hl.get(Fe)||bs,Ve=Ru.get(Ve)||F,ps(Ve(Fe.apply(null,u.call(arguments,1))))};function ps(fe){return function(Ae){return Ae<=0?0:Ae>=1?1:fe(Ae)}}function Iu(fe){return function(Ae){return 1-fe(1-Ae)}}function qs(fe){return function(Ae){return .5*(Ae<.5?fe(2*Ae):2-fe(2-2*Ae))}}function Oo(fe){return fe*fe}function lf(fe){return fe*fe*fe}function el(fe){if(fe<=0)return 0;if(fe>=1)return 1;var Ae=fe*fe,Fe=Ae*fe;return 4*(fe<.5?Fe:3*(fe-Ae)+Fe-.75)}function Vs(fe){return function(Ae){return Math.pow(Ae,fe)}}function nu(fe){return 1-Math.cos(fe*qe)}function uf(fe){return Math.pow(2,10*(fe-1))}function ff(fe){return 1-Math.sqrt(1-fe*fe)}function vl(fe,Ae){var Fe;return arguments.length<2&&(Ae=.45),arguments.length?Fe=Ae/Ge*Math.asin(1/fe):(fe=1,Fe=Ae/4),function(Ve){return 1+fe*Math.pow(2,-10*Ve)*Math.sin((Ve-Fe)*Ge/Ae)}}function au(fe){return fe||(fe=1.70158),function(Ae){return Ae*Ae*((fe+1)*Ae-fe)}}function Hs(fe){return fe<1/2.75?7.5625*fe*fe:fe<2/2.75?7.5625*(fe-=1.5/2.75)*fe+.75:fe<2.5/2.75?7.5625*(fe-=2.25/2.75)*fe+.9375:7.5625*(fe-=2.625/2.75)*fe+.984375}h.interpolateHcl=xu;function xu(fe,Ae){fe=h.hcl(fe),Ae=h.hcl(Ae);var Fe=fe.h,Ve=fe.c,Ue=fe.l,Qe=Ae.h-Fe,_t=Ae.c-Ve,dt=Ae.l-Ue;return isNaN(_t)&&(_t=0,Ve=isNaN(Ve)?Ae.c:Ve),isNaN(Qe)?(Qe=0,Fe=isNaN(Fe)?Ae.h:Fe):Qe>180?Qe-=360:Qe<-180&&(Qe+=360),function(It){return st(Fe+Qe*It,Ve+_t*It,Ue+dt*It)+""}}h.interpolateHsl=kl;function kl(fe,Ae){fe=h.hsl(fe),Ae=h.hsl(Ae);var Fe=fe.h,Ve=fe.s,Ue=fe.l,Qe=Ae.h-Fe,_t=Ae.s-Ve,dt=Ae.l-Ue;return isNaN(_t)&&(_t=0,Ve=isNaN(Ve)?Ae.s:Ve),isNaN(Qe)?(Qe=0,Fe=isNaN(Fe)?Ae.h:Fe):Qe>180?Qe-=360:Qe<-180&&(Qe+=360),function(It){return Ar(Fe+Qe*It,Ve+_t*It,Ue+dt*It)+""}}h.interpolateLab=bu;function bu(fe,Ae){fe=h.lab(fe),Ae=h.lab(Ae);var Fe=fe.l,Ve=fe.a,Ue=fe.b,Qe=Ae.l-Fe,_t=Ae.a-Ve,dt=Ae.b-Ue;return function(It){return ut(Fe+Qe*It,Ve+_t*It,Ue+dt*It)+""}}h.interpolateRound=zu;function zu(fe,Ae){return Ae-=fe,function(Fe){return Math.round(fe+Ae*Fe)}}h.transform=function(fe){var Ae=T.createElementNS(h.ns.prefix.svg,"g");return(h.transform=function(Fe){if(Fe!=null){Ae.setAttribute("transform",Fe);var Ve=Ae.transform.baseVal.consolidate()}return new iu(Ve?Ve.matrix:ou)})(fe)};function iu(fe){var Ae=[fe.a,fe.b],Fe=[fe.c,fe.d],Ve=pl(Ae),Ue=cf(Ae,Fe),Qe=pl(_u(Fe,Ae,-Ue))||0;Ae[0]*Fe[1]<Fe[0]*Ae[1]&&(Ae[0]*=-1,Ae[1]*=-1,Ve*=-1,Ue*=-1),this.rotate=(Ve?Math.atan2(Ae[1],Ae[0]):Math.atan2(-Fe[0],Fe[1]))*mt,this.translate=[fe.e,fe.f],this.scale=[Ve,Qe],this.skew=Qe?Math.atan2(Ue,Qe)*mt:0}iu.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function cf(fe,Ae){return fe[0]*Ae[0]+fe[1]*Ae[1]}function pl(fe){var Ae=Math.sqrt(cf(fe,fe));return Ae&&(fe[0]/=Ae,fe[1]/=Ae),Ae}function _u(fe,Ae,Fe){return fe[0]+=Fe*Ae[0],fe[1]+=Fe*Ae[1],fe}var ou={a:1,b:0,c:0,d:1,e:0,f:0};h.interpolateTransform=su;function Fs(fe){return fe.length?fe.pop()+",":""}function Vl(fe,Ae,Fe,Ve){if(fe[0]!==Ae[0]||fe[1]!==Ae[1]){var Ue=Fe.push("translate(",null,",",null,")");Ve.push({i:Ue-4,x:Vi(fe[0],Ae[0])},{i:Ue-2,x:Vi(fe[1],Ae[1])})}else(Ae[0]||Ae[1])&&Fe.push("translate("+Ae+")")}function wu(fe,Ae,Fe,Ve){fe!==Ae?(fe-Ae>180?Ae+=360:Ae-fe>180&&(fe+=360),Ve.push({i:Fe.push(Fs(Fe)+"rotate(",null,")")-2,x:Vi(fe,Ae)})):Ae&&Fe.push(Fs(Fe)+"rotate("+Ae+")")}function Bu(fe,Ae,Fe,Ve){fe!==Ae?Ve.push({i:Fe.push(Fs(Fe)+"skewX(",null,")")-2,x:Vi(fe,Ae)}):Ae&&Fe.push(Fs(Fe)+"skewX("+Ae+")")}function Nu(fe,Ae,Fe,Ve){if(fe[0]!==Ae[0]||fe[1]!==Ae[1]){var Ue=Fe.push(Fs(Fe)+"scale(",null,",",null,")");Ve.push({i:Ue-4,x:Vi(fe[0],Ae[0])},{i:Ue-2,x:Vi(fe[1],Ae[1])})}else(Ae[0]!==1||Ae[1]!==1)&&Fe.push(Fs(Fe)+"scale("+Ae+")")}function su(fe,Ae){var Fe=[],Ve=[];return fe=h.transform(fe),Ae=h.transform(Ae),Vl(fe.translate,Ae.translate,Fe,Ve),wu(fe.rotate,Ae.rotate,Fe,Ve),Bu(fe.skew,Ae.skew,Fe,Ve),Nu(fe.scale,Ae.scale,Fe,Ve),fe=Ae=null,function(Ue){for(var Qe=-1,_t=Ve.length,dt;++Qe<_t;)Fe[(dt=Ve[Qe]).i]=dt.x(Ue);return Fe.join("")}}function hf(fe,Ae){return Ae=(Ae-=fe=+fe)||1/Ae,function(Fe){return(Fe-fe)/Ae}}function Ou(fe,Ae){return Ae=(Ae-=fe=+fe)||1/Ae,function(Fe){return Math.max(0,Math.min(1,(Fe-fe)/Ae))}}h.layout={},h.layout.bundle=function(){return function(fe){for(var Ae=[],Fe=-1,Ve=fe.length;++Fe<Ve;)Ae.push(ds(fe[Fe]));return Ae}};function ds(fe){for(var Ae=fe.source,Fe=fe.target,Ve=Ll(Ae,Fe),Ue=[Ae];Ae!==Ve;)Ae=Ae.parent,Ue.push(Ae);for(var Qe=Ue.length;Fe!==Ve;)Ue.splice(Qe,0,Fe),Fe=Fe.parent;return Ue}function Dl(fe){for(var Ae=[],Fe=fe.parent;Fe!=null;)Ae.push(fe),fe=Fe,Fe=Fe.parent;return Ae.push(fe),Ae}function Ll(fe,Ae){if(fe===Ae)return fe;for(var Fe=Dl(fe),Ve=Dl(Ae),Ue=Fe.pop(),Qe=Ve.pop(),_t=null;Ue===Qe;)_t=Ue,Ue=Fe.pop(),Qe=Ve.pop();return _t}h.layout.chord=function(){var fe={},Ae,Fe,Ve,Ue,Qe=0,_t,dt,It;function Qt(){var rr={},Er=[],qr=h.range(Ue),fn=[],Pr,Vr,Jr,sn,un;for(Ae=[],Fe=[],Pr=0,sn=-1;++sn<Ue;){for(Vr=0,un=-1;++un<Ue;)Vr+=Ve[sn][un];Er.push(Vr),fn.push(h.range(Ue)),Pr+=Vr}for(_t&&qr.sort(function(Ha,Ra){return _t(Er[Ha],Er[Ra])}),dt&&fn.forEach(function(Ha,Ra){Ha.sort(function(ri,Ai){return dt(Ve[Ra][ri],Ve[Ra][Ai])})}),Pr=(Ge-Qe*Ue)/Pr,Vr=0,sn=-1;++sn<Ue;){for(Jr=Vr,un=-1;++un<Ue;){var Qr=qr[sn],Hn=fn[Qr][un],aa=Ve[Qr][Hn],Aa=Vr,sa=Vr+=aa*Pr;rr[Qr+"-"+Hn]={index:Qr,subindex:Hn,startAngle:Aa,endAngle:sa,value:aa}}Fe[Qr]={index:Qr,startAngle:Jr,endAngle:Vr,value:Er[Qr]},Vr+=Qe}for(sn=-1;++sn<Ue;)for(un=sn-1;++un<Ue;){var Da=rr[sn+"-"+un],fa=rr[un+"-"+sn];(Da.value||fa.value)&&Ae.push(Da.value<fa.value?{source:fa,target:Da}:{source:Da,target:fa})}It&&tr()}function tr(){Ae.sort(function(rr,Er){return It((rr.source.value+rr.target.value)/2,(Er.source.value+Er.target.value)/2)})}return fe.matrix=function(rr){return arguments.length?(Ue=(Ve=rr)&&Ve.length,Ae=Fe=null,fe):Ve},fe.padding=function(rr){return arguments.length?(Qe=rr,Ae=Fe=null,fe):Qe},fe.sortGroups=function(rr){return arguments.length?(_t=rr,Ae=Fe=null,fe):_t},fe.sortSubgroups=function(rr){return arguments.length?(dt=rr,Ae=null,fe):dt},fe.sortChords=function(rr){return arguments.length?(It=rr,Ae&&tr(),fe):It},fe.chords=function(){return Ae||Qt(),Ae},fe.groups=function(){return Fe||Qt(),Fe},fe},h.layout.force=function(){var fe={},Ae=h.dispatch("start","tick","end"),Fe,Ve=[1,1],Ue,Qe,_t=.9,dt=Ys,It=mo,Qt=-30,tr=Hl,rr=.1,Er=.64,qr=[],fn=[],Pr,Vr,Jr;function sn(Qr){return function(Hn,aa,Aa,sa){if(Hn.point!==Qr){var Da=Hn.cx-Qr.x,fa=Hn.cy-Qr.y,Ha=sa-aa,Ra=Da*Da+fa*fa;if(Ha*Ha/Er<Ra){if(Ra<tr){var ri=Hn.charge/Ra;Qr.px-=Da*ri,Qr.py-=fa*ri}return!0}if(Hn.point&&Ra&&Ra<tr){var ri=Hn.pointCharge/Ra;Qr.px-=Da*ri,Qr.py-=fa*ri}}return!Hn.charge}}fe.tick=function(){if((Qe*=.99)<.005)return Fe=null,Ae.end({type:"end",alpha:Qe=0}),!0;var Qr=qr.length,Hn=fn.length,aa,Aa,sa,Da,fa,Ha,Ra,ri,Ai;for(Aa=0;Aa<Hn;++Aa)sa=fn[Aa],Da=sa.source,fa=sa.target,ri=fa.x-Da.x,Ai=fa.y-Da.y,(Ha=ri*ri+Ai*Ai)&&(Ha=Qe*Vr[Aa]*((Ha=Math.sqrt(Ha))-Pr[Aa])/Ha,ri*=Ha,Ai*=Ha,fa.x-=ri*(Ra=Da.weight+fa.weight?Da.weight/(Da.weight+fa.weight):.5),fa.y-=Ai*Ra,Da.x+=ri*(Ra=1-Ra),Da.y+=Ai*Ra);if((Ra=Qe*rr)&&(ri=Ve[0]/2,Ai=Ve[1]/2,Aa=-1,Ra))for(;++Aa<Qr;)sa=qr[Aa],sa.x+=(ri-sa.x)*Ra,sa.y+=(Ai-sa.y)*Ra;if(Qt)for(Gs(aa=h.geom.quadtree(qr),Qe,Jr),Aa=-1;++Aa<Qr;)(sa=qr[Aa]).fixed||aa.visit(sn(sa));for(Aa=-1;++Aa<Qr;)sa=qr[Aa],sa.fixed?(sa.x=sa.px,sa.y=sa.py):(sa.x-=(sa.px-(sa.px=sa.x))*_t,sa.y-=(sa.py-(sa.py=sa.y))*_t);Ae.tick({type:"tick",alpha:Qe})},fe.nodes=function(Qr){return arguments.length?(qr=Qr,fe):qr},fe.links=function(Qr){return arguments.length?(fn=Qr,fe):fn},fe.size=function(Qr){return arguments.length?(Ve=Qr,fe):Ve},fe.linkDistance=function(Qr){return arguments.length?(dt=typeof Qr=="function"?Qr:+Qr,fe):dt},fe.distance=fe.linkDistance,fe.linkStrength=function(Qr){return arguments.length?(It=typeof Qr=="function"?Qr:+Qr,fe):It},fe.friction=function(Qr){return arguments.length?(_t=+Qr,fe):_t},fe.charge=function(Qr){return arguments.length?(Qt=typeof Qr=="function"?Qr:+Qr,fe):Qt},fe.chargeDistance=function(Qr){return arguments.length?(tr=Qr*Qr,fe):Math.sqrt(tr)},fe.gravity=function(Qr){return arguments.length?(rr=+Qr,fe):rr},fe.theta=function(Qr){return arguments.length?(Er=Qr*Qr,fe):Math.sqrt(Er)},fe.alpha=function(Qr){return arguments.length?(Qr=+Qr,Qe?Qr>0?Qe=Qr:(Fe.c=null,Fe.t=NaN,Fe=null,Ae.end({type:"end",alpha:Qe=0})):Qr>0&&(Ae.start({type:"start",alpha:Qe=Qr}),Fe=vn(fe.tick)),fe):Qe},fe.start=function(){var Qr,Hn=qr.length,aa=fn.length,Aa=Ve[0],sa=Ve[1],Da,fa;for(Qr=0;Qr<Hn;++Qr)(fa=qr[Qr]).index=Qr,fa.weight=0;for(Qr=0;Qr<aa;++Qr)fa=fn[Qr],typeof fa.source=="number"&&(fa.source=qr[fa.source]),typeof fa.target=="number"&&(fa.target=qr[fa.target]),++fa.source.weight,++fa.target.weight;for(Qr=0;Qr<Hn;++Qr)fa=qr[Qr],isNaN(fa.x)&&(fa.x=Ha("x",Aa)),isNaN(fa.y)&&(fa.y=Ha("y",sa)),isNaN(fa.px)&&(fa.px=fa.x),isNaN(fa.py)&&(fa.py=fa.y);if(Pr=[],typeof dt=="function")for(Qr=0;Qr<aa;++Qr)Pr[Qr]=+dt.call(this,fn[Qr],Qr);else for(Qr=0;Qr<aa;++Qr)Pr[Qr]=dt;if(Vr=[],typeof It=="function")for(Qr=0;Qr<aa;++Qr)Vr[Qr]=+It.call(this,fn[Qr],Qr);else for(Qr=0;Qr<aa;++Qr)Vr[Qr]=It;if(Jr=[],typeof Qt=="function")for(Qr=0;Qr<Hn;++Qr)Jr[Qr]=+Qt.call(this,qr[Qr],Qr);else for(Qr=0;Qr<Hn;++Qr)Jr[Qr]=Qt;function Ha(Ra,ri){if(!Da){for(Da=new Array(Hn),Gi=0;Gi<Hn;++Gi)Da[Gi]=[];for(Gi=0;Gi<aa;++Gi){var Ai=fn[Gi];Da[Ai.source.index].push(Ai.target),Da[Ai.target.index].push(Ai.source)}}for(var wo=Da[Qr],Gi=-1,va=wo.length,li;++Gi<va;)if(!isNaN(li=wo[Gi][Ra]))return li;return Math.random()*ri}return fe.resume()},fe.resume=function(){return fe.alpha(.1)},fe.stop=function(){return fe.alpha(0)},fe.drag=function(){if(Ue||(Ue=h.behavior.drag().origin(F).on("dragstart.force",Tu).on("drag.force",un).on("dragend.force",Rs)),!arguments.length)return Ue;this.on("mouseover.force",Uo).on("mouseout.force",lu).call(Ue)};function un(Qr){Qr.px=h.event.x,Qr.py=h.event.y,fe.resume()}return h.rebind(fe,Ae,"on")};function Tu(fe){fe.fixed|=2}function Rs(fe){fe.fixed&=-7}function Uo(fe){fe.fixed|=4,fe.px=fe.x,fe.py=fe.y}function lu(fe){fe.fixed&=-5}function Gs(fe,Ae,Fe){var Ve=0,Ue=0;if(fe.charge=0,!fe.leaf)for(var Qe=fe.nodes,_t=Qe.length,dt=-1,It;++dt<_t;)It=Qe[dt],It!=null&&(Gs(It,Ae,Fe),fe.charge+=It.charge,Ve+=It.charge*It.cx,Ue+=It.charge*It.cy);if(fe.point){fe.leaf||(fe.point.x+=Math.random()-.5,fe.point.y+=Math.random()-.5);var Qt=Ae*Fe[fe.point.index];fe.charge+=fe.pointCharge=Qt,Ve+=Qt*fe.point.x,Ue+=Qt*fe.point.y}fe.cx=Ve/fe.charge,fe.cy=Ue/fe.charge}var Ys=20,mo=1,Hl=1/0;h.layout.hierarchy=function(){var fe=uu,Ae=Yl,Fe=Pl;function Ve(Ue){var Qe=[Ue],_t=[],dt;for(Ue.depth=0;(dt=Qe.pop())!=null;)if(_t.push(dt),(Qt=Ae.call(Ve,dt,dt.depth))&&(It=Qt.length)){for(var It,Qt,tr;--It>=0;)Qe.push(tr=Qt[It]),tr.parent=dt,tr.depth=dt.depth+1;Fe&&(dt.value=0),dt.children=Qt}else Fe&&(dt.value=+Fe.call(Ve,dt,dt.depth)||0),delete dt.children;return Is(Ue,function(rr){var Er,qr;fe&&(Er=rr.children)&&Er.sort(fe),Fe&&(qr=rr.parent)&&(qr.value+=rr.value)}),_t}return Ve.sort=function(Ue){return arguments.length?(fe=Ue,Ve):fe},Ve.children=function(Ue){return arguments.length?(Ae=Ue,Ve):Ae},Ve.value=function(Ue){return arguments.length?(Fe=Ue,Ve):Fe},Ve.revalue=function(Ue){return Fe&&(dl(Ue,function(Qe){Qe.children&&(Qe.value=0)}),Is(Ue,function(Qe){var _t;Qe.children||(Qe.value=+Fe.call(Ve,Qe,Qe.depth)||0),(_t=Qe.parent)&&(_t.value+=Qe.value)})),Ue},Ve};function Gl(fe,Ae){return h.rebind(fe,Ae,"sort","children","value"),fe.nodes=fe,fe.links=Wl,fe}function dl(fe,Ae){for(var Fe=[fe];(fe=Fe.pop())!=null;)if(Ae(fe),(Ue=fe.children)&&(Ve=Ue.length))for(var Ve,Ue;--Ve>=0;)Fe.push(Ue[Ve])}function Is(fe,Ae){for(var Fe=[fe],Ve=[];(fe=Fe.pop())!=null;)if(Ve.push(fe),(_t=fe.children)&&(Qe=_t.length))for(var Ue=-1,Qe,_t;++Ue<Qe;)Fe.push(_t[Ue]);for(;(fe=Ve.pop())!=null;)Ae(fe)}function Yl(fe){return fe.children}function Pl(fe){return fe.value}function uu(fe,Ae){return Ae.value-fe.value}function Wl(fe){return h.merge(fe.map(function(Ae){return(Ae.children||[]).map(function(Fe){return{source:Ae,target:Fe}})}))}h.layout.partition=function(){var fe=h.layout.hierarchy(),Ae=[1,1];function Fe(Qe,_t,dt,It){var Qt=Qe.children;if(Qe.x=_t,Qe.y=Qe.depth*It,Qe.dx=dt,Qe.dy=It,Qt&&(rr=Qt.length)){var tr=-1,rr,Er,qr;for(dt=Qe.value?dt/Qe.value:0;++tr<rr;)Fe(Er=Qt[tr],_t,qr=Er.value*dt,It),_t+=qr}}function Ve(Qe){var _t=Qe.children,dt=0;if(_t&&(Qt=_t.length))for(var It=-1,Qt;++It<Qt;)dt=Math.max(dt,Ve(_t[It]));return 1+dt}function Ue(Qe,_t){var dt=fe.call(this,Qe,_t);return Fe(dt[0],0,Ae[0],Ae[1]/Ve(dt[0])),dt}return Ue.size=function(Qe){return arguments.length?(Ae=Qe,Ue):Ae},Gl(Ue,fe)},h.layout.pie=function(){var fe=Number,Ae=yl,Fe=0,Ve=Ge,Ue=0;function Qe(_t){var dt=_t.length,It=_t.map(function(sn,un){return+fe.call(Qe,sn,un)}),Qt=+(typeof Fe=="function"?Fe.apply(this,arguments):Fe),tr=(typeof Ve=="function"?Ve.apply(this,arguments):Ve)-Qt,rr=Math.min(Math.abs(tr)/dt,+(typeof Ue=="function"?Ue.apply(this,arguments):Ue)),Er=rr*(tr<0?-1:1),qr=h.sum(It),fn=qr?(tr-dt*Er)/qr:0,Pr=h.range(dt),Vr=[],Jr;return Ae!=null&&Pr.sort(Ae===yl?function(sn,un){return It[un]-It[sn]}:function(sn,un){return Ae(_t[sn],_t[un])}),Pr.forEach(function(sn){Vr[sn]={data:_t[sn],value:Jr=It[sn],startAngle:Qt,endAngle:Qt+=Jr*fn+Er,padAngle:rr}}),Vr}return Qe.value=function(_t){return arguments.length?(fe=_t,Qe):fe},Qe.sort=function(_t){return arguments.length?(Ae=_t,Qe):Ae},Qe.startAngle=function(_t){return arguments.length?(Fe=_t,Qe):Fe},Qe.endAngle=function(_t){return arguments.length?(Ve=_t,Qe):Ve},Qe.padAngle=function(_t){return arguments.length?(Ue=_t,Qe):Ue},Qe};var yl={};h.layout.stack=function(){var fe=F,Ae=Xl,Fe=ml,Ve=Cf,Ue=vf,Qe=_s;function _t(dt,It){if(!(fn=dt.length))return dt;var Qt=dt.map(function(sn,un){return fe.call(_t,sn,un)}),tr=Qt.map(function(sn){return sn.map(function(un,Qr){return[Ue.call(_t,un,Qr),Qe.call(_t,un,Qr)]})}),rr=Ae.call(_t,tr,It);Qt=h.permute(Qt,rr),tr=h.permute(tr,rr);var Er=Fe.call(_t,tr,It),qr=Qt[0].length,fn,Pr,Vr,Jr;for(Vr=0;Vr<qr;++Vr)for(Ve.call(_t,Qt[0][Vr],Jr=Er[Vr],tr[0][Vr][1]),Pr=1;Pr<fn;++Pr)Ve.call(_t,Qt[Pr][Vr],Jr+=tr[Pr-1][Vr][1],tr[Pr][Vr][1]);return dt}return _t.values=function(dt){return arguments.length?(fe=dt,_t):fe},_t.order=function(dt){return arguments.length?(Ae=typeof dt=="function"?dt:Au.get(dt)||Xl,_t):Ae},_t.offset=function(dt){return arguments.length?(Fe=typeof dt=="function"?dt:Fl.get(dt)||ml,_t):Fe},_t.x=function(dt){return arguments.length?(Ue=dt,_t):Ue},_t.y=function(dt){return arguments.length?(Qe=dt,_t):Qe},_t.out=function(dt){return arguments.length?(Ve=dt,_t):Ve},_t};function vf(fe){return fe.x}function _s(fe){return fe.y}function Cf(fe,Ae,Fe){fe.y0=Ae,fe.y=Fe}var Au=h.map({"inside-out":function(fe){var Ae=fe.length,Fe,Ve,Ue=fe.map(Zl),Qe=fe.map(Uu),_t=h.range(Ae).sort(function(rr,Er){return Ue[rr]-Ue[Er]}),dt=0,It=0,Qt=[],tr=[];for(Fe=0;Fe<Ae;++Fe)Ve=_t[Fe],dt<It?(dt+=Qe[Ve],Qt.push(Ve)):(It+=Qe[Ve],tr.push(Ve));return tr.reverse().concat(Qt)},reverse:function(fe){return h.range(fe.length).reverse()},default:Xl}),Fl=h.map({silhouette:function(fe){var Ae=fe.length,Fe=fe[0].length,Ve=[],Ue=0,Qe,_t,dt,It=[];for(_t=0;_t<Fe;++_t){for(Qe=0,dt=0;Qe<Ae;Qe++)dt+=fe[Qe][_t][1];dt>Ue&&(Ue=dt),Ve.push(dt)}for(_t=0;_t<Fe;++_t)It[_t]=(Ue-Ve[_t])/2;return It},wiggle:function(fe){var Ae=fe.length,Fe=fe[0],Ve=Fe.length,Ue,Qe,_t,dt,It,Qt,tr,rr,Er,qr=[];for(qr[0]=rr=Er=0,Qe=1;Qe<Ve;++Qe){for(Ue=0,dt=0;Ue<Ae;++Ue)dt+=fe[Ue][Qe][1];for(Ue=0,It=0,tr=Fe[Qe][0]-Fe[Qe-1][0];Ue<Ae;++Ue){for(_t=0,Qt=(fe[Ue][Qe][1]-fe[Ue][Qe-1][1])/(2*tr);_t<Ue;++_t)Qt+=(fe[_t][Qe][1]-fe[_t][Qe-1][1])/tr;It+=Qt*fe[Ue][Qe][1]}qr[Qe]=rr-=dt?It/dt*tr:0,rr<Er&&(Er=rr)}for(Qe=0;Qe<Ve;++Qe)qr[Qe]-=Er;return qr},expand:function(fe){var Ae=fe.length,Fe=fe[0].length,Ve=1/Ae,Ue,Qe,_t,dt=[];for(Qe=0;Qe<Fe;++Qe){for(Ue=0,_t=0;Ue<Ae;Ue++)_t+=fe[Ue][Qe][1];if(_t)for(Ue=0;Ue<Ae;Ue++)fe[Ue][Qe][1]/=_t;else for(Ue=0;Ue<Ae;Ue++)fe[Ue][Qe][1]=Ve}for(Qe=0;Qe<Fe;++Qe)dt[Qe]=0;return dt},zero:ml});function Xl(fe){return h.range(fe.length)}function ml(fe){for(var Ae=-1,Fe=fe[0].length,Ve=[];++Ae<Fe;)Ve[Ae]=0;return Ve}function Zl(fe){for(var Ae=1,Fe=0,Ve=fe[0][1],Ue,Qe=fe.length;Ae<Qe;++Ae)(Ue=fe[Ae][1])>Ve&&(Fe=Ae,Ve=Ue);return Fe}function Uu(fe){return fe.reduce(Vu,0)}function Vu(fe,Ae){return fe+Ae[1]}h.layout.histogram=function(){var fe=!0,Ae=Number,Fe=Rl,Ve=kf;function Ue(Qe,Er){for(var dt=[],It=Qe.map(Ae,this),Qt=Fe.call(this,It,Er),tr=Ve.call(this,Qt,It,Er),rr,Er=-1,qr=It.length,fn=tr.length-1,Pr=fe?1:1/qr,Vr;++Er<fn;)rr=dt[Er]=[],rr.dx=tr[Er+1]-(rr.x=tr[Er]),rr.y=0;if(fn>0)for(Er=-1;++Er<qr;)Vr=It[Er],Vr>=Qt[0]&&Vr<=Qt[1]&&(rr=dt[h.bisect(tr,Vr,1,fn)-1],rr.y+=Pr,rr.push(Qe[Er]));return dt}return Ue.value=function(Qe){return arguments.length?(Ae=Qe,Ue):Ae},Ue.range=function(Qe){return arguments.length?(Fe=at(Qe),Ue):Fe},Ue.bins=function(Qe){return arguments.length?(Ve=typeof Qe=="number"?function(_t){return Hi(_t,Qe)}:at(Qe),Ue):Ve},Ue.frequency=function(Qe){return arguments.length?(fe=!!Qe,Ue):fe},Ue};function kf(fe,Ae){return Hi(fe,Math.ceil(Math.log(Ae.length)/Math.LN2+1))}function Hi(fe,Ae){for(var Fe=-1,Ve=+fe[0],Ue=(fe[1]-Ve)/Ae,Qe=[];++Fe<=Ae;)Qe[Fe]=Ue*Fe+Ve;return Qe}function Rl(fe){return[h.min(fe),h.max(fe)]}h.layout.pack=function(){var fe=h.layout.hierarchy().sort(xl),Ae=0,Fe=[1,1],Ve;function Ue(Qe,_t){var dt=fe.call(this,Qe,_t),It=dt[0],Qt=Fe[0],tr=Fe[1],rr=Ve==null?Math.sqrt:typeof Ve=="function"?Ve:function(){return Ve};if(It.x=It.y=0,Is(It,function(qr){qr.r=+rr(qr.value)}),Is(It,xo),Ae){var Er=Ae*(Ve?1:Math.max(2*It.r/Qt,2*It.r/tr))/2;Is(It,function(qr){qr.r+=Er}),Is(It,xo),Is(It,function(qr){qr.r-=Er})}return tl(It,Qt/2,tr/2,Ve?1:1/Math.max(2*It.r/Qt,2*It.r/tr)),dt}return Ue.size=function(Qe){return arguments.length?(Fe=Qe,Ue):Fe},Ue.radius=function(Qe){return arguments.length?(Ve=Qe==null||typeof Qe=="function"?Qe:+Qe,Ue):Ve},Ue.padding=function(Qe){return arguments.length?(Ae=+Qe,Ue):Ae},Gl(Ue,fe)};function xl(fe,Ae){return fe.value-Ae.value}function gs(fe,Ae){var Fe=fe._pack_next;fe._pack_next=Ae,Ae._pack_prev=fe,Ae._pack_next=Fe,Fe._pack_prev=Ae}function ws(fe,Ae){fe._pack_next=Ae,Ae._pack_prev=fe}function jl(fe,Ae){var Fe=Ae.x-fe.x,Ve=Ae.y-fe.y,Ue=fe.r+Ae.r;return .999*Ue*Ue>Fe*Fe+Ve*Ve}function xo(fe){if(!(Ae=fe.children)||!(Er=Ae.length))return;var Ae,Fe=1/0,Ve=-1/0,Ue=1/0,Qe=-1/0,_t,dt,It,Qt,tr,rr,Er;function qr(Qr){Fe=Math.min(Qr.x-Qr.r,Fe),Ve=Math.max(Qr.x+Qr.r,Ve),Ue=Math.min(Qr.y-Qr.r,Ue),Qe=Math.max(Qr.y+Qr.r,Qe)}if(Ae.forEach(Hu),_t=Ae[0],_t.x=-_t.r,_t.y=0,qr(_t),Er>1&&(dt=Ae[1],dt.x=dt.r,dt.y=0,qr(dt),Er>2))for(It=Ae[2],rl(_t,dt,It),qr(It),gs(_t,It),_t._pack_prev=It,gs(It,dt),dt=_t._pack_next,Qt=3;Qt<Er;Qt++){rl(_t,dt,It=Ae[Qt]);var fn=0,Pr=1,Vr=1;for(tr=dt._pack_next;tr!==dt;tr=tr._pack_next,Pr++)if(jl(tr,It)){fn=1;break}if(fn==1)for(rr=_t._pack_prev;rr!==tr._pack_prev&&!jl(rr,It);rr=rr._pack_prev,Vr++);fn?(Pr<Vr||Pr==Vr&&dt.r<_t.r?ws(_t,dt=tr):ws(_t=rr,dt),Qt--):(gs(_t,It),dt=It,qr(It))}var Jr=(Fe+Ve)/2,sn=(Ue+Qe)/2,un=0;for(Qt=0;Qt<Er;Qt++)It=Ae[Qt],It.x-=Jr,It.y-=sn,un=Math.max(un,It.r+Math.sqrt(It.x*It.x+It.y*It.y));fe.r=un,Ae.forEach(Ts)}function Hu(fe){fe._pack_next=fe._pack_prev=fe}function Ts(fe){delete fe._pack_next,delete fe._pack_prev}function tl(fe,Ae,Fe,Ve){var Ue=fe.children;if(fe.x=Ae+=Ve*fe.x,fe.y=Fe+=Ve*fe.y,fe.r*=Ve,Ue)for(var Qe=-1,_t=Ue.length;++Qe<_t;)tl(Ue[Qe],Ae,Fe,Ve)}function rl(fe,Ae,Fe){var Ve=fe.r+Fe.r,Ue=Ae.x-fe.x,Qe=Ae.y-fe.y;if(Ve&&(Ue||Qe)){var _t=Ae.r+Fe.r,dt=Ue*Ue+Qe*Qe;_t*=_t,Ve*=Ve;var It=.5+(Ve-_t)/(2*dt),Qt=Math.sqrt(Math.max(0,2*_t*(Ve+dt)-(Ve-=dt)*Ve-_t*_t))/(2*dt);Fe.x=fe.x+It*Ue+Qt*Qe,Fe.y=fe.y+It*Qe-Qt*Ue}else Fe.x=fe.x+Ve,Fe.y=fe.y}h.layout.tree=function(){var fe=h.layout.hierarchy().sort(null).value(null),Ae=Ws,Fe=[1,1],Ve=null;function Ue(tr,rr){var Er=fe.call(this,tr,rr),qr=Er[0],fn=Qe(qr);if(Is(fn,_t),fn.parent.m=-fn.z,dl(fn,dt),Ve)dl(qr,Qt);else{var Pr=qr,Vr=qr,Jr=qr;dl(qr,function(Hn){Hn.x<Pr.x&&(Pr=Hn),Hn.x>Vr.x&&(Vr=Hn),Hn.depth>Jr.depth&&(Jr=Hn)});var sn=Ae(Pr,Vr)/2-Pr.x,un=Fe[0]/(Vr.x+Ae(Vr,Pr)/2+sn),Qr=Fe[1]/(Jr.depth||1);dl(qr,function(Hn){Hn.x=(Hn.x+sn)*un,Hn.y=Hn.depth*Qr})}return Er}function Qe(tr){for(var rr={A:null,children:[tr]},Er=[rr],qr;(qr=Er.pop())!=null;)for(var fn=qr.children,Pr,Vr=0,Jr=fn.length;Vr<Jr;++Vr)Er.push((fn[Vr]=Pr={_:fn[Vr],parent:qr,children:(Pr=fn[Vr].children)&&Pr.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:Vr}).a=Pr);return rr.children[0]}function _t(tr){var rr=tr.children,Er=tr.parent.children,qr=tr.i?Er[tr.i-1]:null;if(rr.length){Ms(tr);var fn=(rr[0].z+rr[rr.length-1].z)/2;qr?(tr.z=qr.z+Ae(tr._,qr._),tr.m=tr.z-fn):tr.z=fn}else qr&&(tr.z=qr.z+Ae(tr._,qr._));tr.parent.A=It(tr,qr,tr.parent.A||Er[0])}function dt(tr){tr._.x=tr.z+tr.parent.m,tr.m+=tr.parent.m}function It(tr,rr,Er){if(rr){for(var qr=tr,fn=tr,Pr=rr,Vr=qr.parent.children[0],Jr=qr.m,sn=fn.m,un=Pr.m,Qr=Vr.m,Hn;Pr=Qi(Pr),qr=As(qr),Pr&&qr;)Vr=As(Vr),fn=Qi(fn),fn.a=tr,Hn=Pr.z+un-qr.z-Jr+Ae(Pr._,qr._),Hn>0&&(Vo(Gu(Pr,tr,Er),tr,Hn),Jr+=Hn,sn+=Hn),un+=Pr.m,Jr+=qr.m,Qr+=Vr.m,sn+=fn.m;Pr&&!Qi(fn)&&(fn.t=Pr,fn.m+=un-sn),qr&&!As(Vr)&&(Vr.t=qr,Vr.m+=Jr-Qr,Er=tr)}return Er}function Qt(tr){tr.x*=Fe[0],tr.y=tr.depth*Fe[1]}return Ue.separation=function(tr){return arguments.length?(Ae=tr,Ue):Ae},Ue.size=function(tr){return arguments.length?(Ve=(Fe=tr)==null?Qt:null,Ue):Ve?null:Fe},Ue.nodeSize=function(tr){return arguments.length?(Ve=(Fe=tr)==null?null:Qt,Ue):Ve?Fe:null},Gl(Ue,fe)};function Ws(fe,Ae){return fe.parent==Ae.parent?1:2}function As(fe){var Ae=fe.children;return Ae.length?Ae[0]:fe.t}function Qi(fe){var Ae=fe.children,Fe;return(Fe=Ae.length)?Ae[Fe-1]:fe.t}function Vo(fe,Ae,Fe){var Ve=Fe/(Ae.i-fe.i);Ae.c-=Ve,Ae.s+=Fe,fe.c+=Ve,Ae.z+=Fe,Ae.m+=Fe}function Ms(fe){for(var Ae=0,Fe=0,Ve=fe.children,Ue=Ve.length,Qe;--Ue>=0;)Qe=Ve[Ue],Qe.z+=Ae,Qe.m+=Ae,Ae+=Qe.s+(Fe+=Qe.c)}function Gu(fe,Ae,Fe){return fe.a.parent===Ae.parent?fe.a:Fe}h.layout.cluster=function(){var fe=h.layout.hierarchy().sort(null).value(null),Ae=Ws,Fe=[1,1],Ve=!1;function Ue(Qe,_t){var dt=fe.call(this,Qe,_t),It=dt[0],Qt,tr=0;Is(It,function(Pr){var Vr=Pr.children;Vr&&Vr.length?(Pr.x=Yu(Vr),Pr.y=fu(Vr)):(Pr.x=Qt?tr+=Ae(Pr,Qt):0,Pr.y=0,Qt=Pr)});var rr=xt(It),Er=Ot(It),qr=rr.x-Ae(rr,Er)/2,fn=Er.x+Ae(Er,rr)/2;return Is(It,Ve?function(Pr){Pr.x=(Pr.x-It.x)*Fe[0],Pr.y=(It.y-Pr.y)*Fe[1]}:function(Pr){Pr.x=(Pr.x-qr)/(fn-qr)*Fe[0],Pr.y=(1-(It.y?Pr.y/It.y:1))*Fe[1]}),dt}return Ue.separation=function(Qe){return arguments.length?(Ae=Qe,Ue):Ae},Ue.size=function(Qe){return arguments.length?(Ve=(Fe=Qe)==null,Ue):Ve?null:Fe},Ue.nodeSize=function(Qe){return arguments.length?(Ve=(Fe=Qe)!=null,Ue):Ve?Fe:null},Gl(Ue,fe)};function fu(fe){return 1+h.max(fe,function(Ae){return Ae.y})}function Yu(fe){return fe.reduce(function(Ae,Fe){return Ae+Fe.x},0)/fe.length}function xt(fe){var Ae=fe.children;return Ae&&Ae.length?xt(Ae[0]):fe}function Ot(fe){var Ae=fe.children,Fe;return Ae&&(Fe=Ae.length)?Ot(Ae[Fe-1]):fe}h.layout.treemap=function(){var fe=h.layout.hierarchy(),Ae=Math.round,Fe=[1,1],Ve=null,Ue=vr,Qe=!1,_t,dt="squarify",It=.5*(1+Math.sqrt(5));function Qt(Pr,Vr){for(var Jr=-1,sn=Pr.length,un,Qr;++Jr<sn;)Qr=(un=Pr[Jr]).value*(Vr<0?0:Vr),un.area=isNaN(Qr)||Qr<=0?0:Qr}function tr(Pr){var Vr=Pr.children;if(Vr&&Vr.length){var Jr=Ue(Pr),sn=[],un=Vr.slice(),Qr,Hn=1/0,aa,Aa=dt==="slice"?Jr.dx:dt==="dice"?Jr.dy:dt==="slice-dice"?Pr.depth&1?Jr.dy:Jr.dx:Math.min(Jr.dx,Jr.dy),sa;for(Qt(un,Jr.dx*Jr.dy/Pr.value),sn.area=0;(sa=un.length)>0;)sn.push(Qr=un[sa-1]),sn.area+=Qr.area,dt!=="squarify"||(aa=Er(sn,Aa))<=Hn?(un.pop(),Hn=aa):(sn.area-=sn.pop().area,qr(sn,Aa,Jr,!1),Aa=Math.min(Jr.dx,Jr.dy),sn.length=sn.area=0,Hn=1/0);sn.length&&(qr(sn,Aa,Jr,!0),sn.length=sn.area=0),Vr.forEach(tr)}}function rr(Pr){var Vr=Pr.children;if(Vr&&Vr.length){var Jr=Ue(Pr),sn=Vr.slice(),un,Qr=[];for(Qt(sn,Jr.dx*Jr.dy/Pr.value),Qr.area=0;un=sn.pop();)Qr.push(un),Qr.area+=un.area,un.z!=null&&(qr(Qr,un.z?Jr.dx:Jr.dy,Jr,!sn.length),Qr.length=Qr.area=0);Vr.forEach(rr)}}function Er(Pr,Vr){for(var Jr=Pr.area,sn,un=0,Qr=1/0,Hn=-1,aa=Pr.length;++Hn<aa;)!(sn=Pr[Hn].area)||(sn<Qr&&(Qr=sn),sn>un&&(un=sn));return Jr*=Jr,Vr*=Vr,Jr?Math.max(Vr*un*It/Jr,Jr/(Vr*Qr*It)):1/0}function qr(Pr,Vr,Jr,sn){var un=-1,Qr=Pr.length,Hn=Jr.x,aa=Jr.y,Aa=Vr?Ae(Pr.area/Vr):0,sa;if(Vr==Jr.dx){for((sn||Aa>Jr.dy)&&(Aa=Jr.dy);++un<Qr;)sa=Pr[un],sa.x=Hn,sa.y=aa,sa.dy=Aa,Hn+=sa.dx=Math.min(Jr.x+Jr.dx-Hn,Aa?Ae(sa.area/Aa):0);sa.z=!0,sa.dx+=Jr.x+Jr.dx-Hn,Jr.y+=Aa,Jr.dy-=Aa}else{for((sn||Aa>Jr.dx)&&(Aa=Jr.dx);++un<Qr;)sa=Pr[un],sa.x=Hn,sa.y=aa,sa.dx=Aa,aa+=sa.dy=Math.min(Jr.y+Jr.dy-aa,Aa?Ae(sa.area/Aa):0);sa.z=!1,sa.dy+=Jr.y+Jr.dy-aa,Jr.x+=Aa,Jr.dx-=Aa}}function fn(Pr){var Vr=_t||fe(Pr),Jr=Vr[0];return Jr.x=Jr.y=0,Jr.value?(Jr.dx=Fe[0],Jr.dy=Fe[1]):Jr.dx=Jr.dy=0,_t&&fe.revalue(Jr),Qt([Jr],Jr.dx*Jr.dy/Jr.value),(_t?rr:tr)(Jr),Qe&&(_t=Vr),Vr}return fn.size=function(Pr){return arguments.length?(Fe=Pr,fn):Fe},fn.padding=function(Pr){if(!arguments.length)return Ve;function Vr(un){var Qr=Pr.call(fn,un,un.depth);return Qr==null?vr(un):lr(un,typeof Qr=="number"?[Qr,Qr,Qr,Qr]:Qr)}function Jr(un){return lr(un,Pr)}var sn;return Ue=(Ve=Pr)==null?vr:(sn=typeof Pr)=="function"?Vr:(sn==="number"&&(Pr=[Pr,Pr,Pr,Pr]),Jr),fn},fn.round=function(Pr){return arguments.length?(Ae=Pr?Math.round:Number,fn):Ae!=Number},fn.sticky=function(Pr){return arguments.length?(Qe=Pr,_t=null,fn):Qe},fn.ratio=function(Pr){return arguments.length?(It=Pr,fn):It},fn.mode=function(Pr){return arguments.length?(dt=Pr+"",fn):dt},Gl(fn,fe)};function vr(fe){return{x:fe.x,y:fe.y,dx:fe.dx,dy:fe.dy}}function lr(fe,Ae){var Fe=fe.x+Ae[3],Ve=fe.y+Ae[0],Ue=fe.dx-Ae[1]-Ae[3],Qe=fe.dy-Ae[0]-Ae[2];return Ue<0&&(Fe+=Ue/2,Ue=0),Qe<0&&(Ve+=Qe/2,Qe=0),{x:Fe,y:Ve,dx:Ue,dy:Qe}}h.random={normal:function(fe,Ae){var Fe=arguments.length;return Fe<2&&(Ae=1),Fe<1&&(fe=0),function(){var Ve,Ue,Qe;do Ve=Math.random()*2-1,Ue=Math.random()*2-1,Qe=Ve*Ve+Ue*Ue;while(!Qe||Qe>1);return fe+Ae*Ve*Math.sqrt(-2*Math.log(Qe)/Qe)}},logNormal:function(){var fe=h.random.normal.apply(h,arguments);return function(){return Math.exp(fe())}},bates:function(fe){var Ae=h.random.irwinHall(fe);return function(){return Ae()/fe}},irwinHall:function(fe){return function(){for(var Ae=0,Fe=0;Fe<fe;Fe++)Ae+=Math.random();return Ae}}},h.scale={};function Ir(fe){var Ae=fe[0],Fe=fe[fe.length-1];return Ae<Fe?[Ae,Fe]:[Fe,Ae]}function nn(fe){return fe.rangeExtent?fe.rangeExtent():Ir(fe.range())}function yn(fe,Ae,Fe,Ve){var Ue=Fe(fe[0],fe[1]),Qe=Ve(Ae[0],Ae[1]);return function(_t){return Qe(Ue(_t))}}function En(fe,Ae){var Fe=0,Ve=fe.length-1,Ue=fe[Fe],Qe=fe[Ve],_t;return Qe<Ue&&(_t=Fe,Fe=Ve,Ve=_t,_t=Ue,Ue=Qe,Qe=_t),fe[Fe]=Ae.floor(Ue),fe[Ve]=Ae.ceil(Qe),fe}function Pn(fe){return fe?{floor:function(Ae){return Math.floor(Ae/fe)*fe},ceil:function(Ae){return Math.ceil(Ae/fe)*fe}}:Vn}var Vn={floor:F,ceil:F};function xn(fe,Ae,Fe,Ve){var Ue=[],Qe=[],_t=0,dt=Math.min(fe.length,Ae.length)-1;for(fe[dt]<fe[0]&&(fe=fe.slice().reverse(),Ae=Ae.slice().reverse());++_t<=dt;)Ue.push(Fe(fe[_t-1],fe[_t])),Qe.push(Ve(Ae[_t-1],Ae[_t]));return function(It){var Qt=h.bisect(fe,It,1,dt)-1;return Qe[Qt](Ue[Qt](It))}}h.scale.linear=function(){return Bn([0,1],[0,1],vo,!1)};function Bn(fe,Ae,Fe,Ve){var Ue,Qe;function _t(){var It=Math.min(fe.length,Ae.length)>2?xn:yn,Qt=Ve?Ou:hf;return Ue=It(fe,Ae,Qt,Fe),Qe=It(Ae,fe,Qt,vo),dt}function dt(It){return Ue(It)}return dt.invert=function(It){return Qe(It)},dt.domain=function(It){return arguments.length?(fe=It.map(Number),_t()):fe},dt.range=function(It){return arguments.length?(Ae=It,_t()):Ae},dt.rangeRound=function(It){return dt.range(It).interpolate(zu)},dt.clamp=function(It){return arguments.length?(Ve=It,_t()):Ve},dt.interpolate=function(It){return arguments.length?(Fe=It,_t()):Fe},dt.ticks=function(It){return Na(fe,It)},dt.tickFormat=function(It,Qt){return d3_scale_linearTickFormat(fe,It,Qt)},dt.nice=function(It){return Gn(fe,It),_t()},dt.copy=function(){return Bn(fe,Ae,Fe,Ve)},_t()}function Fn(fe,Ae){return h.rebind(fe,Ae,"range","rangeRound","interpolate","clamp")}function Gn(fe,Ae){return En(fe,Pn(ea(fe,Ae)[2])),En(fe,Pn(ea(fe,Ae)[2])),fe}function ea(fe,Ae){Ae==null&&(Ae=10);var Fe=Ir(fe),Ve=Fe[1]-Fe[0],Ue=Math.pow(10,Math.floor(Math.log(Ve/Ae)/Math.LN10)),Qe=Ae/Ve*Ue;return Qe<=.15?Ue*=10:Qe<=.35?Ue*=5:Qe<=.75&&(Ue*=2),Fe[0]=Math.ceil(Fe[0]/Ue)*Ue,Fe[1]=Math.floor(Fe[1]/Ue)*Ue+Ue*.5,Fe[2]=Ue,Fe}function Na(fe,Ae){return h.range.apply(h,ea(fe,Ae))}h.scale.log=function(){return La(h.scale.linear().domain([0,1]),10,!0,[1,10])};function La(fe,Ae,Fe,Ve){function Ue(dt){return(Fe?Math.log(dt<0?0:dt):-Math.log(dt>0?0:-dt))/Math.log(Ae)}function Qe(dt){return Fe?Math.pow(Ae,dt):-Math.pow(Ae,-dt)}function _t(dt){return fe(Ue(dt))}return _t.invert=function(dt){return Qe(fe.invert(dt))},_t.domain=function(dt){return arguments.length?(Fe=dt[0]>=0,fe.domain((Ve=dt.map(Number)).map(Ue)),_t):Ve},_t.base=function(dt){return arguments.length?(Ae=+dt,fe.domain(Ve.map(Ue)),_t):Ae},_t.nice=function(){var dt=En(Ve.map(Ue),Fe?Math:Oa);return fe.domain(dt),Ve=dt.map(Qe),_t},_t.ticks=function(){var dt=Ir(Ve),It=[],Qt=dt[0],tr=dt[1],rr=Math.floor(Ue(Qt)),Er=Math.ceil(Ue(tr)),qr=Ae%1?2:Ae;if(isFinite(Er-rr)){if(Fe){for(;rr<Er;rr++)for(var fn=1;fn<qr;fn++)It.push(Qe(rr)*fn);It.push(Qe(rr))}else for(It.push(Qe(rr));rr++<Er;)for(var fn=qr-1;fn>0;fn--)It.push(Qe(rr)*fn);for(rr=0;It[rr]<Qt;rr++);for(Er=It.length;It[Er-1]>tr;Er--);It=It.slice(rr,Er)}return It},_t.copy=function(){return La(fe.copy(),Ae,Fe,Ve)},Fn(_t,fe)}var Oa={floor:function(fe){return-Math.ceil(-fe)},ceil:function(fe){return-Math.floor(-fe)}};h.scale.pow=function(){return Ua(h.scale.linear(),1,[0,1])};function Ua(fe,Ae,Fe){var Ve=$n(Ae),Ue=$n(1/Ae);function Qe(_t){return fe(Ve(_t))}return Qe.invert=function(_t){return Ue(fe.invert(_t))},Qe.domain=function(_t){return arguments.length?(fe.domain((Fe=_t.map(Number)).map(Ve)),Qe):Fe},Qe.ticks=function(_t){return Na(Fe,_t)},Qe.tickFormat=function(_t,dt){return d3_scale_linearTickFormat(Fe,_t,dt)},Qe.nice=function(_t){return Qe.domain(Gn(Fe,_t))},Qe.exponent=function(_t){return arguments.length?(Ve=$n(Ae=_t),Ue=$n(1/Ae),fe.domain(Fe.map(Ve)),Qe):Ae},Qe.copy=function(){return Ua(fe.copy(),Ae,Fe)},Fn(Qe,fe)}function $n(fe){return function(Ae){return Ae<0?-Math.pow(-Ae,fe):Math.pow(Ae,fe)}}h.scale.sqrt=function(){return h.scale.pow().exponent(.5)},h.scale.ordinal=function(){return da([],{t:"range",a:[[]]})};function da(fe,Ae){var Fe,Ve,Ue;function Qe(dt){return Ve[((Fe.get(dt)||(Ae.t==="range"?Fe.set(dt,fe.push(dt)):NaN))-1)%Ve.length]}function _t(dt,It){return h.range(fe.length).map(function(Qt){return dt+It*Qt})}return Qe.domain=function(dt){if(!arguments.length)return fe;fe=[],Fe=new M;for(var It=-1,Qt=dt.length,tr;++It<Qt;)Fe.has(tr=dt[It])||Fe.set(tr,fe.push(tr));return Qe[Ae.t].apply(Qe,Ae.a)},Qe.range=function(dt){return arguments.length?(Ve=dt,Ue=0,Ae={t:"range",a:arguments},Qe):Ve},Qe.rangePoints=function(dt,It){arguments.length<2&&(It=0);var Qt=dt[0],tr=dt[1],rr=fe.length<2?(Qt=(Qt+tr)/2,0):(tr-Qt)/(fe.length-1+It);return Ve=_t(Qt+rr*It/2,rr),Ue=0,Ae={t:"rangePoints",a:arguments},Qe},Qe.rangeRoundPoints=function(dt,It){arguments.length<2&&(It=0);var Qt=dt[0],tr=dt[1],rr=fe.length<2?(Qt=tr=Math.round((Qt+tr)/2),0):(tr-Qt)/(fe.length-1+It)|0;return Ve=_t(Qt+Math.round(rr*It/2+(tr-Qt-(fe.length-1+It)*rr)/2),rr),Ue=0,Ae={t:"rangeRoundPoints",a:arguments},Qe},Qe.rangeBands=function(dt,It,Qt){arguments.length<2&&(It=0),arguments.length<3&&(Qt=It);var tr=dt[1]<dt[0],rr=dt[tr-0],Er=dt[1-tr],qr=(Er-rr)/(fe.length-It+2*Qt);return Ve=_t(rr+qr*Qt,qr),tr&&Ve.reverse(),Ue=qr*(1-It),Ae={t:"rangeBands",a:arguments},Qe},Qe.rangeRoundBands=function(dt,It,Qt){arguments.length<2&&(It=0),arguments.length<3&&(Qt=It);var tr=dt[1]<dt[0],rr=dt[tr-0],Er=dt[1-tr],qr=Math.floor((Er-rr)/(fe.length-It+2*Qt));return Ve=_t(rr+Math.round((Er-rr-(fe.length-It)*qr)/2),qr),tr&&Ve.reverse(),Ue=Math.round(qr*(1-It)),Ae={t:"rangeRoundBands",a:arguments},Qe},Qe.rangeBand=function(){return Ue},Qe.rangeExtent=function(){return Ir(Ae.a[0])},Qe.copy=function(){return da(fe,Ae)},Qe.domain(fe)}h.scale.category10=function(){return h.scale.ordinal().range(Za)},h.scale.category20=function(){return h.scale.ordinal().range(ti)},h.scale.category20b=function(){return h.scale.ordinal().range(wi)},h.scale.category20c=function(){return h.scale.ordinal().range(Ti)};var Za=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(kr),ti=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(kr),wi=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(kr),Ti=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(kr);h.scale.quantile=function(){return Si([],[])};function Si(fe,Ae){var Fe;function Ve(){var Qe=0,_t=Ae.length;for(Fe=[];++Qe<_t;)Fe[Qe-1]=h.quantile(fe,Qe/_t);return Ue}function Ue(Qe){if(!isNaN(Qe=+Qe))return Ae[h.bisect(Fe,Qe)]}return Ue.domain=function(Qe){return arguments.length?(fe=Qe.map(m).filter(g).sort(s),Ve()):fe},Ue.range=function(Qe){return arguments.length?(Ae=Qe,Ve()):Ae},Ue.quantiles=function(){return Fe},Ue.invertExtent=function(Qe){return Qe=Ae.indexOf(Qe),Qe<0?[NaN,NaN]:[Qe>0?Fe[Qe-1]:fe[0],Qe<Fe.length?Fe[Qe]:fe[fe.length-1]]},Ue.copy=function(){return Si(fe,Ae)},Ve()}h.scale.quantize=function(){return Fi(0,1,[0,1])};function Fi(fe,Ae,Fe){var Ve,Ue;function Qe(dt){return Fe[Math.max(0,Math.min(Ue,Math.floor(Ve*(dt-fe))))]}function _t(){return Ve=Fe.length/(Ae-fe),Ue=Fe.length-1,Qe}return Qe.domain=function(dt){return arguments.length?(fe=+dt[0],Ae=+dt[dt.length-1],_t()):[fe,Ae]},Qe.range=function(dt){return arguments.length?(Fe=dt,_t()):Fe},Qe.invertExtent=function(dt){return dt=Fe.indexOf(dt),dt=dt<0?NaN:dt/Ve+fe,[dt,dt+1/Ve]},Qe.copy=function(){return Fi(fe,Ae,Fe)},_t()}h.scale.threshold=function(){return fi([.5],[0,1])};function fi(fe,Ae){function Fe(Ve){if(Ve<=Ve)return Ae[h.bisect(fe,Ve)]}return Fe.domain=function(Ve){return arguments.length?(fe=Ve,Fe):fe},Fe.range=function(Ve){return arguments.length?(Ae=Ve,Fe):Ae},Fe.invertExtent=function(Ve){return Ve=Ae.indexOf(Ve),[fe[Ve-1],fe[Ve]]},Fe.copy=function(){return fi(fe,Ae)},Fe}h.scale.identity=function(){return ko([0,1])};function ko(fe){function Ae(Fe){return+Fe}return Ae.invert=Ae,Ae.domain=Ae.range=function(Fe){return arguments.length?(fe=Fe.map(Ae),Ae):fe},Ae.ticks=function(Fe){return Na(fe,Fe)},Ae.tickFormat=function(Fe,Ve){return d3_scale_linearTickFormat(fe,Fe,Ve)},Ae.copy=function(){return ko(fe)},Ae}h.svg={};function uo(){return 0}h.svg.arc=function(){var fe=ga,Ae=Ei,Fe=uo,Ve=ei,Ue=bo,Qe=So,_t=Ss;function dt(){var Qt=Math.max(0,+fe.apply(this,arguments)),tr=Math.max(0,+Ae.apply(this,arguments)),rr=Ue.apply(this,arguments)-qe,Er=Qe.apply(this,arguments)-qe,qr=Math.abs(Er-rr),fn=rr>Er?0:1;if(tr<Qt&&(Pr=tr,tr=Qt,Qt=Pr),qr>=Je)return It(tr,fn)+(Qt?It(Qt,1-fn):"")+"Z";var Pr,Vr,Jr,sn,un=0,Qr=0,Hn,aa,Aa,sa,Da,fa,Ha,Ra,ri=[];if((sn=(+_t.apply(this,arguments)||0)/2)&&(Jr=Ve===ei?Math.sqrt(Qt*Qt+tr*tr):+Ve.apply(this,arguments),fn||(Qr*=-1),tr&&(Qr=Ht(Jr/tr*Math.sin(sn))),Qt&&(un=Ht(Jr/Qt*Math.sin(sn)))),tr){Hn=tr*Math.cos(rr+Qr),aa=tr*Math.sin(rr+Qr),Aa=tr*Math.cos(Er-Qr),sa=tr*Math.sin(Er-Qr);var Ai=Math.abs(Er-rr-2*Qr)<=Ee?0:1;if(Qr&&Xs(Hn,aa,Aa,sa)===fn^Ai){var wo=(rr+Er)/2;Hn=tr*Math.cos(wo),aa=tr*Math.sin(wo),Aa=sa=null}}else Hn=aa=0;if(Qt){Da=Qt*Math.cos(Er-un),fa=Qt*Math.sin(Er-un),Ha=Qt*Math.cos(rr+un),Ra=Qt*Math.sin(rr+un);var Gi=Math.abs(rr-Er+2*un)<=Ee?0:1;if(un&&Xs(Da,fa,Ha,Ra)===1-fn^Gi){var va=(rr+Er)/2;Da=Qt*Math.cos(va),fa=Qt*Math.sin(va),Ha=Ra=null}}else Da=fa=0;if(qr>nt&&(Pr=Math.min(Math.abs(tr-Qt)/2,+Fe.apply(this,arguments)))>.001){Vr=Qt<tr^fn?0:1;var li=Pr,Ka=Pr;if(qr<Ee){var Ii=Ha==null?[Da,fa]:Aa==null?[Hn,aa]:Ja([Hn,aa],[Ha,Ra],[Aa,sa],[Da,fa]),ci=Hn-Ii[0],go=aa-Ii[1],so=Aa-Ii[0],Co=sa-Ii[1],ss=1/Math.sin(Math.acos((ci*so+go*Co)/(Math.sqrt(ci*ci+go*go)*Math.sqrt(so*so+Co*Co)))/2),Qo=Math.sqrt(Ii[0]*Ii[0]+Ii[1]*Ii[1]);Ka=Math.min(Pr,(Qt-Qo)/(ss-1)),li=Math.min(Pr,(tr-Qo)/(ss+1))}if(Aa!=null){var ls=Jo(Ha==null?[Da,fa]:[Ha,Ra],[Hn,aa],tr,li,fn),qi=Jo([Aa,sa],[Da,fa],tr,li,fn);Pr===li?ri.push("M",ls[0],"A",li,",",li," 0 0,",Vr," ",ls[1],"A",tr,",",tr," 0 ",1-fn^Xs(ls[1][0],ls[1][1],qi[1][0],qi[1][1]),",",fn," ",qi[1],"A",li,",",li," 0 0,",Vr," ",qi[0]):ri.push("M",ls[0],"A",li,",",li," 0 1,",Vr," ",qi[0])}else ri.push("M",Hn,",",aa);if(Ha!=null){var ji=Jo([Hn,aa],[Ha,Ra],Qt,-Ka,fn),Ba=Jo([Da,fa],Aa==null?[Hn,aa]:[Aa,sa],Qt,-Ka,fn);Pr===Ka?ri.push("L",Ba[0],"A",Ka,",",Ka," 0 0,",Vr," ",Ba[1],"A",Qt,",",Qt," 0 ",fn^Xs(Ba[1][0],Ba[1][1],ji[1][0],ji[1][1]),",",1-fn," ",ji[1],"A",Ka,",",Ka," 0 0,",Vr," ",ji[0]):ri.push("L",Ba[0],"A",Ka,",",Ka," 0 0,",Vr," ",ji[0])}else ri.push("L",Da,",",fa)}else ri.push("M",Hn,",",aa),Aa!=null&&ri.push("A",tr,",",tr," 0 ",Ai,",",fn," ",Aa,",",sa),ri.push("L",Da,",",fa),Ha!=null&&ri.push("A",Qt,",",Qt," 0 ",Gi,",",1-fn," ",Ha,",",Ra);return ri.push("Z"),ri.join("")}function It(Qt,tr){return"M0,"+Qt+"A"+Qt+","+Qt+" 0 1,"+tr+" 0,"+-Qt+"A"+Qt+","+Qt+" 0 1,"+tr+" 0,"+Qt}return dt.innerRadius=function(Qt){return arguments.length?(fe=at(Qt),dt):fe},dt.outerRadius=function(Qt){return arguments.length?(Ae=at(Qt),dt):Ae},dt.cornerRadius=function(Qt){return arguments.length?(Fe=at(Qt),dt):Fe},dt.padRadius=function(Qt){return arguments.length?(Ve=Qt==ei?ei:at(Qt),dt):Ve},dt.startAngle=function(Qt){return arguments.length?(Ue=at(Qt),dt):Ue},dt.endAngle=function(Qt){return arguments.length?(Qe=at(Qt),dt):Qe},dt.padAngle=function(Qt){return arguments.length?(_t=at(Qt),dt):_t},dt.centroid=function(){var Qt=(+fe.apply(this,arguments)+ +Ae.apply(this,arguments))/2,tr=(+Ue.apply(this,arguments)+ +Qe.apply(this,arguments))/2-qe;return[Math.cos(tr)*Qt,Math.sin(tr)*Qt]},dt};var ei="auto";function ga(fe){return fe.innerRadius}function Ei(fe){return fe.outerRadius}function bo(fe){return fe.startAngle}function So(fe){return fe.endAngle}function Ss(fe){return fe&&fe.padAngle}function Xs(fe,Ae,Fe,Ve){return(fe-Fe)*Ae-(Ae-Ve)*fe>0?0:1}function Jo(fe,Ae,Fe,Ve,Ue){var Qe=fe[0]-Ae[0],_t=fe[1]-Ae[1],dt=(Ue?Ve:-Ve)/Math.sqrt(Qe*Qe+_t*_t),It=dt*_t,Qt=-dt*Qe,tr=fe[0]+It,rr=fe[1]+Qt,Er=Ae[0]+It,qr=Ae[1]+Qt,fn=(tr+Er)/2,Pr=(rr+qr)/2,Vr=Er-tr,Jr=qr-rr,sn=Vr*Vr+Jr*Jr,un=Fe-Ve,Qr=tr*qr-Er*rr,Hn=(Jr<0?-1:1)*Math.sqrt(Math.max(0,un*un*sn-Qr*Qr)),aa=(Qr*Jr-Vr*Hn)/sn,Aa=(-Qr*Vr-Jr*Hn)/sn,sa=(Qr*Jr+Vr*Hn)/sn,Da=(-Qr*Vr+Jr*Hn)/sn,fa=aa-fn,Ha=Aa-Pr,Ra=sa-fn,ri=Da-Pr;return fa*fa+Ha*Ha>Ra*Ra+ri*ri&&(aa=sa,Aa=Da),[[aa-It,Aa-Qt],[aa*Fe/un,Aa*Fe/un]]}function bl(){return!0}function zs(fe){var Ae=Yn,Fe=ya,Ve=bl,Ue=Do,Qe=Ue.key,_t=.7;function dt(It){var Qt=[],tr=[],rr=-1,Er=It.length,qr,fn=at(Ae),Pr=at(Fe);function Vr(){Qt.push("M",Ue(fe(tr),_t))}for(;++rr<Er;)Ve.call(this,qr=It[rr],rr)?tr.push([+fn.call(this,qr,rr),+Pr.call(this,qr,rr)]):tr.length&&(Vr(),tr=[]);return tr.length&&Vr(),Qt.length?Qt.join(""):null}return dt.x=function(It){return arguments.length?(Ae=It,dt):Ae},dt.y=function(It){return arguments.length?(Fe=It,dt):Fe},dt.defined=function(It){return arguments.length?(Ve=It,dt):Ve},dt.interpolate=function(It){return arguments.length?(typeof It=="function"?Qe=Ue=It:Qe=(Ue=Es.get(It)||Do).key,dt):Qe},dt.tension=function(It){return arguments.length?(_t=It,dt):_t},dt}h.svg.line=function(){return zs(F)};var Es=h.map({linear:Do,"linear-closed":cu,step:Mu,"step-before":Cs,"step-after":Wu,basis:Zs,"basis-open":Df,"basis-closed":gf,bundle:yf,cardinal:pf,"cardinal-open":hu,"cardinal-closed":lc,monotone:je});Es.forEach(function(fe,Ae){Ae.key=fe,Ae.closed=/-closed$/.test(fe)});function Do(fe){return fe.length>1?fe.join("L"):fe+"Z"}function cu(fe){return fe.join("L")+"Z"}function Mu(fe){for(var Ae=0,Fe=fe.length,Ve=fe[0],Ue=[Ve[0],",",Ve[1]];++Ae<Fe;)Ue.push("H",(Ve[0]+(Ve=fe[Ae])[0])/2,"V",Ve[1]);return Fe>1&&Ue.push("H",Ve[0]),Ue.join("")}function Cs(fe){for(var Ae=0,Fe=fe.length,Ve=fe[0],Ue=[Ve[0],",",Ve[1]];++Ae<Fe;)Ue.push("V",(Ve=fe[Ae])[1],"H",Ve[0]);return Ue.join("")}function Wu(fe){for(var Ae=0,Fe=fe.length,Ve=fe[0],Ue=[Ve[0],",",Ve[1]];++Ae<Fe;)Ue.push("H",(Ve=fe[Ae])[0],"V",Ve[1]);return Ue.join("")}function hu(fe,Ae){return fe.length<4?Do(fe):fe[1]+Xu(fe.slice(1,-1),df(fe,Ae))}function lc(fe,Ae){return fe.length<3?cu(fe):fe[0]+Xu((fe.push(fe[0]),fe),df([fe[fe.length-2]].concat(fe,[fe[1]]),Ae))}function pf(fe,Ae){return fe.length<3?Do(fe):fe[0]+Xu(fe,df(fe,Ae))}function Xu(fe,Ae){if(Ae.length<1||fe.length!=Ae.length&&fe.length!=Ae.length+2)return Do(fe);var Fe=fe.length!=Ae.length,Ve="",Ue=fe[0],Qe=fe[1],_t=Ae[0],dt=_t,It=1;if(Fe&&(Ve+="Q"+(Qe[0]-_t[0]*2/3)+","+(Qe[1]-_t[1]*2/3)+","+Qe[0]+","+Qe[1],Ue=fe[1],It=2),Ae.length>1){dt=Ae[1],Qe=fe[It],It++,Ve+="C"+(Ue[0]+_t[0])+","+(Ue[1]+_t[1])+","+(Qe[0]-dt[0])+","+(Qe[1]-dt[1])+","+Qe[0]+","+Qe[1];for(var Qt=2;Qt<Ae.length;Qt++,It++)Qe=fe[It],dt=Ae[Qt],Ve+="S"+(Qe[0]-dt[0])+","+(Qe[1]-dt[1])+","+Qe[0]+","+Qe[1]}if(Fe){var tr=fe[It];Ve+="Q"+(Qe[0]+dt[0]*2/3)+","+(Qe[1]+dt[1]*2/3)+","+tr[0]+","+tr[1]}return Ve}function df(fe,Ae){for(var Fe=[],Ve=(1-Ae)/2,Ue,Qe=fe[0],_t=fe[1],dt=1,It=fe.length;++dt<It;)Ue=Qe,Qe=_t,_t=fe[dt],Fe.push([Ve*(_t[0]-Ue[0]),Ve*(_t[1]-Ue[1])]);return Fe}function Zs(fe){if(fe.length<3)return Do(fe);var Ae=1,Fe=fe.length,Ve=fe[0],Ue=Ve[0],Qe=Ve[1],_t=[Ue,Ue,Ue,(Ve=fe[1])[0]],dt=[Qe,Qe,Qe,Ve[1]],It=[Ue,",",Qe,"L",Ko(Bs,_t),",",Ko(Bs,dt)];for(fe.push(fe[Fe-1]);++Ae<=Fe;)Ve=fe[Ae],_t.shift(),_t.push(Ve[0]),dt.shift(),dt.push(Ve[1]),Zu(It,_t,dt);return fe.pop(),It.push("L",Ve),It.join("")}function Df(fe){if(fe.length<4)return Do(fe);for(var Ae=[],Fe=-1,Ve=fe.length,Ue,Qe=[0],_t=[0];++Fe<3;)Ue=fe[Fe],Qe.push(Ue[0]),_t.push(Ue[1]);for(Ae.push(Ko(Bs,Qe)+","+Ko(Bs,_t)),--Fe;++Fe<Ve;)Ue=fe[Fe],Qe.shift(),Qe.push(Ue[0]),_t.shift(),_t.push(Ue[1]),Zu(Ae,Qe,_t);return Ae.join("")}function gf(fe){for(var Ae,Fe=-1,Ve=fe.length,Ue=Ve+4,Qe,_t=[],dt=[];++Fe<4;)Qe=fe[Fe%Ve],_t.push(Qe[0]),dt.push(Qe[1]);for(Ae=[Ko(Bs,_t),",",Ko(Bs,dt)],--Fe;++Fe<Ue;)Qe=fe[Fe%Ve],_t.shift(),_t.push(Qe[0]),dt.shift(),dt.push(Qe[1]),Zu(Ae,_t,dt);return Ae.join("")}function yf(fe,Ae){var Fe=fe.length-1;if(Fe)for(var Ve=fe[0][0],Ue=fe[0][1],Qe=fe[Fe][0]-Ve,_t=fe[Fe][1]-Ue,dt=-1,It,Qt;++dt<=Fe;)It=fe[dt],Qt=dt/Fe,It[0]=Ae*It[0]+(1-Ae)*(Ve+Qt*Qe),It[1]=Ae*It[1]+(1-Ae)*(Ue+Qt*_t);return Zs(fe)}function Ko(fe,Ae){return fe[0]*Ae[0]+fe[1]*Ae[1]+fe[2]*Ae[2]+fe[3]*Ae[3]}var mf=[0,2/3,1/3,0],Vf=[0,1/3,2/3,0],Bs=[0,1/6,2/3,1/6];function Zu(fe,Ae,Fe){fe.push("C",Ko(mf,Ae),",",Ko(mf,Fe),",",Ko(Vf,Ae),",",Ko(Vf,Fe),",",Ko(Bs,Ae),",",Ko(Bs,Fe))}function ju(fe,Ae){return(Ae[1]-fe[1])/(Ae[0]-fe[0])}function xf(fe){for(var Ae=0,Fe=fe.length-1,Ve=[],Ue=fe[0],Qe=fe[1],_t=Ve[0]=ju(Ue,Qe);++Ae<Fe;)Ve[Ae]=(_t+(_t=ju(Ue=Qe,Qe=fe[Ae+1])))/2;return Ve[Ae]=_t,Ve}function Ne(fe){for(var Ae=[],Fe,Ve,Ue,Qe,_t=xf(fe),dt=-1,It=fe.length-1;++dt<It;)Fe=ju(fe[dt],fe[dt+1]),l(Fe)<nt?_t[dt]=_t[dt+1]=0:(Ve=_t[dt]/Fe,Ue=_t[dt+1]/Fe,Qe=Ve*Ve+Ue*Ue,Qe>9&&(Qe=Fe*3/Math.sqrt(Qe),_t[dt]=Qe*Ve,_t[dt+1]=Qe*Ue));for(dt=-1;++dt<=It;)Qe=(fe[Math.min(It,dt+1)][0]-fe[Math.max(0,dt-1)][0])/(6*(1+_t[dt]*_t[dt])),Ae.push([Qe||0,_t[dt]*Qe||0]);return Ae}function je(fe){return fe.length<3?Do(fe):fe[0]+Xu(fe,Ne(fe))}h.svg.line.radial=function(){var fe=zs(rt);return fe.radius=fe.x,delete fe.x,fe.angle=fe.y,delete fe.y,fe};function rt(fe){for(var Ae,Fe=-1,Ve=fe.length,Ue,Qe;++Fe<Ve;)Ae=fe[Fe],Ue=Ae[0],Qe=Ae[1]-qe,Ae[0]=Ue*Math.cos(Qe),Ae[1]=Ue*Math.sin(Qe);return fe}function lt(fe){var Ae=Yn,Fe=Yn,Ve=0,Ue=ya,Qe=bl,_t=Do,dt=_t.key,It=_t,Qt="L",tr=.7;function rr(Er){var qr=[],fn=[],Pr=[],Vr=-1,Jr=Er.length,sn,un=at(Ae),Qr=at(Ve),Hn=Ae===Fe?function(){return Aa}:at(Fe),aa=Ve===Ue?function(){return sa}:at(Ue),Aa,sa;function Da(){qr.push("M",_t(fe(Pr),tr),Qt,It(fe(fn.reverse()),tr),"Z")}for(;++Vr<Jr;)Qe.call(this,sn=Er[Vr],Vr)?(fn.push([Aa=+un.call(this,sn,Vr),sa=+Qr.call(this,sn,Vr)]),Pr.push([+Hn.call(this,sn,Vr),+aa.call(this,sn,Vr)])):fn.length&&(Da(),fn=[],Pr=[]);return fn.length&&Da(),qr.length?qr.join(""):null}return rr.x=function(Er){return arguments.length?(Ae=Fe=Er,rr):Fe},rr.x0=function(Er){return arguments.length?(Ae=Er,rr):Ae},rr.x1=function(Er){return arguments.length?(Fe=Er,rr):Fe},rr.y=function(Er){return arguments.length?(Ve=Ue=Er,rr):Ue},rr.y0=function(Er){return arguments.length?(Ve=Er,rr):Ve},rr.y1=function(Er){return arguments.length?(Ue=Er,rr):Ue},rr.defined=function(Er){return arguments.length?(Qe=Er,rr):Qe},rr.interpolate=function(Er){return arguments.length?(typeof Er=="function"?dt=_t=Er:dt=(_t=Es.get(Er)||Do).key,It=_t.reverse||_t,Qt=_t.closed?"M":"L",rr):dt},rr.tension=function(Er){return arguments.length?(tr=Er,rr):tr},rr}Cs.reverse=Wu,Wu.reverse=Cs,h.svg.area=function(){return lt(F)},h.svg.area.radial=function(){var fe=lt(rt);return fe.radius=fe.x,delete fe.x,fe.innerRadius=fe.x0,delete fe.x0,fe.outerRadius=fe.x1,delete fe.x1,fe.angle=fe.y,delete fe.y,fe.startAngle=fe.y0,delete fe.y0,fe.endAngle=fe.y1,delete fe.y1,fe};function wt(fe){return fe.source}function bt(fe){return fe.target}h.svg.chord=function(){var fe=wt,Ae=bt,Fe=kt,Ve=bo,Ue=So;function Qe(tr,rr){var Er=_t(this,fe,tr,rr),qr=_t(this,Ae,tr,rr);return"M"+Er.p0+It(Er.r,Er.p1,Er.a1-Er.a0)+(dt(Er,qr)?Qt(Er.r,Er.p1,Er.r,Er.p0):Qt(Er.r,Er.p1,qr.r,qr.p0)+It(qr.r,qr.p1,qr.a1-qr.a0)+Qt(qr.r,qr.p1,Er.r,Er.p0))+"Z"}function _t(tr,rr,Er,qr){var fn=rr.call(tr,Er,qr),Pr=Fe.call(tr,fn,qr),Vr=Ve.call(tr,fn,qr)-qe,Jr=Ue.call(tr,fn,qr)-qe;return{r:Pr,a0:Vr,a1:Jr,p0:[Pr*Math.cos(Vr),Pr*Math.sin(Vr)],p1:[Pr*Math.cos(Jr),Pr*Math.sin(Jr)]}}function dt(tr,rr){return tr.a0==rr.a0&&tr.a1==rr.a1}function It(tr,rr,Er){return"A"+tr+","+tr+" 0 "+ +(Er>Ee)+",1 "+rr}function Qt(tr,rr,Er,qr){return"Q 0,0 "+qr}return Qe.radius=function(tr){return arguments.length?(Fe=at(tr),Qe):Fe},Qe.source=function(tr){return arguments.length?(fe=at(tr),Qe):fe},Qe.target=function(tr){return arguments.length?(Ae=at(tr),Qe):Ae},Qe.startAngle=function(tr){return arguments.length?(Ve=at(tr),Qe):Ve},Qe.endAngle=function(tr){return arguments.length?(Ue=at(tr),Qe):Ue},Qe};function kt(fe){return fe.radius}h.svg.diagonal=function(){var fe=wt,Ae=bt,Fe=hr;function Ve(Ue,Qe){var _t=fe.call(this,Ue,Qe),dt=Ae.call(this,Ue,Qe),It=(_t.y+dt.y)/2,Qt=[_t,{x:_t.x,y:It},{x:dt.x,y:It},dt];return Qt=Qt.map(Fe),"M"+Qt[0]+"C"+Qt[1]+" "+Qt[2]+" "+Qt[3]}return Ve.source=function(Ue){return arguments.length?(fe=at(Ue),Ve):fe},Ve.target=function(Ue){return arguments.length?(Ae=at(Ue),Ve):Ae},Ve.projection=function(Ue){return arguments.length?(Fe=Ue,Ve):Fe},Ve};function hr(fe){return[fe.x,fe.y]}h.svg.diagonal.radial=function(){var fe=h.svg.diagonal(),Ae=hr,Fe=fe.projection;return fe.projection=function(Ve){return arguments.length?Fe(gr(Ae=Ve)):Ae},fe};function gr(fe){return function(){var Ae=fe.apply(this,arguments),Fe=Ae[0],Ve=Ae[1]-qe;return[Fe*Math.cos(Ve),Fe*Math.sin(Ve)]}}h.svg.symbol=function(){var fe=_r,Ae=fr;function Fe(Ve,Ue){return(jr.get(fe.call(this,Ve,Ue))||Rr)(Ae.call(this,Ve,Ue))}return Fe.type=function(Ve){return arguments.length?(fe=at(Ve),Fe):fe},Fe.size=function(Ve){return arguments.length?(Ae=at(Ve),Fe):Ae},Fe};function fr(){return 64}function _r(){return"circle"}function Rr(fe){var Ae=Math.sqrt(fe/Ee);return"M0,"+Ae+"A"+Ae+","+Ae+" 0 1,1 0,"+-Ae+"A"+Ae+","+Ae+" 0 1,1 0,"+Ae+"Z"}var jr=h.map({circle:Rr,cross:function(fe){var Ae=Math.sqrt(fe/5)/2;return"M"+-3*Ae+","+-Ae+"H"+-Ae+"V"+-3*Ae+"H"+Ae+"V"+-Ae+"H"+3*Ae+"V"+Ae+"H"+Ae+"V"+3*Ae+"H"+-Ae+"V"+Ae+"H"+-3*Ae+"Z"},diamond:function(fe){var Ae=Math.sqrt(fe/(2*wn)),Fe=Ae*wn;return"M0,"+-Ae+"L"+Fe+",0 0,"+Ae+" "+-Fe+",0Z"},square:function(fe){var Ae=Math.sqrt(fe)/2;return"M"+-Ae+","+-Ae+"L"+Ae+","+-Ae+" "+Ae+","+Ae+" "+-Ae+","+Ae+"Z"},"triangle-down":function(fe){var Ae=Math.sqrt(fe/tn),Fe=Ae*tn/2;return"M0,"+Fe+"L"+Ae+","+-Fe+" "+-Ae+","+-Fe+"Z"},"triangle-up":function(fe){var Ae=Math.sqrt(fe/tn),Fe=Ae*tn/2;return"M0,"+-Fe+"L"+Ae+","+Fe+" "+-Ae+","+Fe+"Z"}});h.svg.symbolTypes=jr.keys();var tn=Math.sqrt(3),wn=Math.tan(30*Tt);ne.transition=function(fe){for(var Ae=ja||++qa,Fe=oi(fe),Ve=[],Ue,Qe,_t=ai||{time:Date.now(),ease:el,delay:0,duration:250},dt=-1,It=this.length;++dt<It;){Ve.push(Ue=[]);for(var Qt=this[dt],tr=-1,rr=Qt.length;++tr<rr;)(Qe=Qt[tr])&&$i(Qe,tr,Fe,Ae,_t),Ue.push(Qe)}return xa(Ve,Fe,Ae)},ne.interrupt=function(fe){return this.each(fe==null?Rn:Zn(oi(fe)))};var Rn=Zn(oi());function Zn(fe){return function(){var Ae,Fe,Ve;(Ae=this[fe])&&(Ve=Ae[Fe=Ae.active])&&(Ve.timer.c=null,Ve.timer.t=NaN,--Ae.count?delete Ae[Fe]:delete this[fe],Ae.active+=.5,Ve.event&&Ve.event.interrupt.call(this,this.__data__,Ve.index))}}function xa(fe,Ae,Fe){return K(fe,wa),fe.namespace=Ae,fe.id=Fe,fe}var wa=[],qa=0,ja,ai;wa.call=ne.call,wa.empty=ne.empty,wa.node=ne.node,wa.size=ne.size,h.transition=function(fe,Ae){return fe&&fe.transition?ja?fe.transition(Ae):fe:h.selection().transition(fe)},h.transition.prototype=wa,wa.select=function(fe){var Ae=this.id,Fe=this.namespace,Ve=[],Ue,Qe,_t;fe=J(fe);for(var dt=-1,It=this.length;++dt<It;){Ve.push(Ue=[]);for(var Qt=this[dt],tr=-1,rr=Qt.length;++tr<rr;)(_t=Qt[tr])&&(Qe=fe.call(_t,_t.__data__,tr,dt))?("__data__"in _t&&(Qe.__data__=_t.__data__),$i(Qe,tr,Fe,Ae,_t[Fe][Ae]),Ue.push(Qe)):Ue.push(null)}return xa(Ve,Fe,Ae)},wa.selectAll=function(fe){var Ae=this.id,Fe=this.namespace,Ve=[],Ue,Qe,_t,dt,It;fe=q(fe);for(var Qt=-1,tr=this.length;++Qt<tr;)for(var rr=this[Qt],Er=-1,qr=rr.length;++Er<qr;)if(_t=rr[Er]){It=_t[Fe][Ae],Qe=fe.call(_t,_t.__data__,Er,Qt),Ve.push(Ue=[]);for(var fn=-1,Pr=Qe.length;++fn<Pr;)(dt=Qe[fn])&&$i(dt,fn,Fe,Ae,It),Ue.push(dt)}return xa(Ve,Fe,Ae)},wa.filter=function(fe){var Ae=[],Fe,Ve,Ue;typeof fe!="function"&&(fe=Te(fe));for(var Qe=0,_t=this.length;Qe<_t;Qe++){Ae.push(Fe=[]);for(var Ve=this[Qe],dt=0,It=Ve.length;dt<It;dt++)(Ue=Ve[dt])&&fe.call(Ue,Ue.__data__,dt,Qe)&&Fe.push(Ue)}return xa(Ae,this.namespace,this.id)},wa.tween=function(fe,Ae){var Fe=this.id,Ve=this.namespace;return arguments.length<2?this.node()[Ve][Fe].tween.get(fe):He(this,Ae==null?function(Ue){Ue[Ve][Fe].tween.remove(fe)}:function(Ue){Ue[Ve][Fe].tween.set(fe,Ae)})};function mi(fe,Ae,Fe,Ve){var Ue=fe.id,Qe=fe.namespace;return He(fe,typeof Fe=="function"?function(_t,dt,It){_t[Qe][Ue].tween.set(Ae,Ve(Fe.call(_t,_t.__data__,dt,It)))}:(Fe=Ve(Fe),function(_t){_t[Qe][Ue].tween.set(Ae,Fe)}))}wa.attr=function(fe,Ae){if(arguments.length<2){for(Ae in fe)this.attr(Ae,fe[Ae]);return this}var Fe=fe=="transform"?su:vo,Ve=h.ns.qualify(fe);function Ue(){this.removeAttribute(Ve)}function Qe(){this.removeAttributeNS(Ve.space,Ve.local)}function _t(It){return It==null?Ue:(It+="",function(){var Qt=this.getAttribute(Ve),tr;return Qt!==It&&(tr=Fe(Qt,It),function(rr){this.setAttribute(Ve,tr(rr))})})}function dt(It){return It==null?Qe:(It+="",function(){var Qt=this.getAttributeNS(Ve.space,Ve.local),tr;return Qt!==It&&(tr=Fe(Qt,It),function(rr){this.setAttributeNS(Ve.space,Ve.local,tr(rr))})})}return mi(this,"attr."+fe,Ae,Ve.local?dt:_t)},wa.attrTween=function(fe,Ae){var Fe=h.ns.qualify(fe);function Ve(Qe,_t){var dt=Ae.call(this,Qe,_t,this.getAttribute(Fe));return dt&&function(It){this.setAttribute(Fe,dt(It))}}function Ue(Qe,_t){var dt=Ae.call(this,Qe,_t,this.getAttributeNS(Fe.space,Fe.local));return dt&&function(It){this.setAttributeNS(Fe.space,Fe.local,dt(It))}}return this.tween("attr."+fe,Fe.local?Ue:Ve)},wa.style=function(fe,Ae,Fe){var Ve=arguments.length;if(Ve<3){if(typeof fe!="string"){Ve<2&&(Ae="");for(Fe in fe)this.style(Fe,fe[Fe],Ae);return this}Fe=""}function Ue(){this.style.removeProperty(fe)}function Qe(_t){return _t==null?Ue:(_t+="",function(){var dt=i(this).getComputedStyle(this,null).getPropertyValue(fe),It;return dt!==_t&&(It=vo(dt,_t),function(Qt){this.style.setProperty(fe,It(Qt),Fe)})})}return mi(this,"style."+fe,Ae,Qe)},wa.styleTween=function(fe,Ae,Fe){arguments.length<3&&(Fe="");function Ve(Ue,Qe){var _t=Ae.call(this,Ue,Qe,i(this).getComputedStyle(this,null).getPropertyValue(fe));return _t&&function(dt){this.style.setProperty(fe,_t(dt),Fe)}}return this.tween("style."+fe,Ve)},wa.text=function(fe){return mi(this,"text",fe,po)};function po(fe){return fe==null&&(fe=""),function(){this.textContent=fe}}wa.remove=function(){var fe=this.namespace;return this.each("end.transition",function(){var Ae;this[fe].count<2&&(Ae=this.parentNode)&&Ae.removeChild(this)})},wa.ease=function(fe){var Ae=this.id,Fe=this.namespace;return arguments.length<1?this.node()[Fe][Ae].ease:(typeof fe!="function"&&(fe=h.ease.apply(h,arguments)),He(this,function(Ve){Ve[Fe][Ae].ease=fe}))},wa.delay=function(fe){var Ae=this.id,Fe=this.namespace;return arguments.length<1?this.node()[Fe][Ae].delay:He(this,typeof fe=="function"?function(Ve,Ue,Qe){Ve[Fe][Ae].delay=+fe.call(Ve,Ve.__data__,Ue,Qe)}:(fe=+fe,function(Ve){Ve[Fe][Ae].delay=fe}))},wa.duration=function(fe){var Ae=this.id,Fe=this.namespace;return arguments.length<1?this.node()[Fe][Ae].duration:He(this,typeof fe=="function"?function(Ve,Ue,Qe){Ve[Fe][Ae].duration=Math.max(1,fe.call(Ve,Ve.__data__,Ue,Qe))}:(fe=Math.max(1,fe),function(Ve){Ve[Fe][Ae].duration=fe}))},wa.each=function(fe,Ae){var Fe=this.id,Ve=this.namespace;if(arguments.length<2){var Ue=ai,Qe=ja;try{ja=Fe,He(this,function(_t,dt,It){ai=_t[Ve][Fe],fe.call(_t,_t.__data__,dt,It)})}finally{ai=Ue,ja=Qe}}else He(this,function(_t){var dt=_t[Ve][Fe];(dt.event||(dt.event=h.dispatch("start","end","interrupt"))).on(fe,Ae)});return this},wa.transition=function(){for(var fe=this.id,Ae=++qa,Fe=this.namespace,Ve=[],Ue,Qe,_t,dt,It=0,Qt=this.length;It<Qt;It++){Ve.push(Ue=[]);for(var Qe=this[It],tr=0,rr=Qe.length;tr<rr;tr++)(_t=Qe[tr])&&(dt=_t[Fe][fe],$i(_t,tr,Fe,Ae,{time:dt.time,ease:dt.ease,delay:dt.delay+dt.duration,duration:dt.duration})),Ue.push(_t)}return xa(Ve,Fe,Ae)};function oi(fe){return fe==null?"__transition__":"__transition_"+fe+"__"}function $i(fe,Ae,Fe,Ve,Ue){var Qe=fe[Fe]||(fe[Fe]={active:0,count:0}),_t=Qe[Ve],dt,It,Qt,tr,rr;function Er(Pr){var Vr=_t.delay;if(It.t=Vr+dt,Vr<=Pr)return qr(Pr-Vr);It.c=qr}function qr(Pr){var Vr=Qe.active,Jr=Qe[Vr];Jr&&(Jr.timer.c=null,Jr.timer.t=NaN,--Qe.count,delete Qe[Vr],Jr.event&&Jr.event.interrupt.call(fe,fe.__data__,Jr.index));for(var sn in Qe)if(+sn<Ve){var un=Qe[sn];un.timer.c=null,un.timer.t=NaN,--Qe.count,delete Qe[sn]}It.c=fn,vn(function(){return It.c&&fn(Pr||1)&&(It.c=null,It.t=NaN),1},0,dt),Qe.active=Ve,_t.event&&_t.event.start.call(fe,fe.__data__,Ae),rr=[],_t.tween.forEach(function(Qr,Hn){(Hn=Hn.call(fe,fe.__data__,Ae))&&rr.push(Hn)}),tr=_t.ease,Qt=_t.duration}function fn(Pr){for(var Vr=Pr/Qt,Jr=tr(Vr),sn=rr.length;sn>0;)rr[--sn].call(fe,Jr);if(Vr>=1)return _t.event&&_t.event.end.call(fe,fe.__data__,Ae),--Qe.count?delete Qe[Ve]:delete fe[Fe],1}_t||(dt=Ue.time,It=vn(Er,0,dt),_t=Qe[Ve]={tween:new M,time:dt,timer:It,delay:Ue.delay,duration:Ue.duration,ease:Ue.ease,index:Ae},Ue=null,++Qe.count)}h.svg.axis=function(){var fe=h.scale.linear(),Ae=_o,Fe=6,Ve=6,Ue=3,Qe=[10],_t=null,dt;function It(Qt){Qt.each(function(){var tr=h.select(this),rr=this.__chart__||fe,Er=this.__chart__=fe.copy(),qr=_t==null?Er.ticks?Er.ticks.apply(Er,Qe):Er.domain():_t,fn=dt==null?Er.tickFormat?Er.tickFormat.apply(Er,Qe):F:dt,Pr=tr.selectAll(".tick").data(qr,Er),Vr=Pr.enter().insert("g",".domain").attr("class","tick").style("opacity",nt),Jr=h.transition(Pr.exit()).style("opacity",nt).remove(),sn=h.transition(Pr.order()).style("opacity",1),un=Math.max(Fe,0)+Ue,Qr,Hn=nn(Er),aa=tr.selectAll(".domain").data([0]),Aa=(aa.enter().append("path").attr("class","domain"),h.transition(aa));Vr.append("line"),Vr.append("text");var sa=Vr.select("line"),Da=sn.select("line"),fa=Pr.select("text").text(fn),Ha=Vr.select("text"),Ra=sn.select("text"),ri=Ae==="top"||Ae==="left"?-1:1,Ai,wo,Gi,va;if(Ae==="bottom"||Ae==="top"?(Qr=Ci,Ai="x",Gi="y",wo="x2",va="y2",fa.attr("dy",ri<0?"0em":".71em").style("text-anchor","middle"),Aa.attr("d","M"+Hn[0]+","+ri*Ve+"V0H"+Hn[1]+"V"+ri*Ve)):(Qr=Ri,Ai="y",Gi="x",wo="y2",va="x2",fa.attr("dy",".32em").style("text-anchor",ri<0?"end":"start"),Aa.attr("d","M"+ri*Ve+","+Hn[0]+"H0V"+Hn[1]+"H"+ri*Ve)),sa.attr(va,ri*Fe),Ha.attr(Gi,ri*un),Da.attr(wo,0).attr(va,ri*Fe),Ra.attr(Ai,0).attr(Gi,ri*un),Er.rangeBand){var li=Er,Ka=li.rangeBand()/2;rr=Er=function(Ii){return li(Ii)+Ka}}else rr.rangeBand?rr=Er:Jr.call(Qr,Er,rr);Vr.call(Qr,rr,Er),sn.call(Qr,Er,Er)})}return It.scale=function(Qt){return arguments.length?(fe=Qt,It):fe},It.orient=function(Qt){return arguments.length?(Ae=Qt in Ro?Qt+"":_o,It):Ae},It.ticks=function(){return arguments.length?(Qe=A(arguments),It):Qe},It.tickValues=function(Qt){return arguments.length?(_t=Qt,It):_t},It.tickFormat=function(Qt){return arguments.length?(dt=Qt,It):dt},It.tickSize=function(Qt){var tr=arguments.length;return tr?(Fe=+Qt,Ve=+arguments[tr-1],It):Fe},It.innerTickSize=function(Qt){return arguments.length?(Fe=+Qt,It):Fe},It.outerTickSize=function(Qt){return arguments.length?(Ve=+Qt,It):Ve},It.tickPadding=function(Qt){return arguments.length?(Ue=+Qt,It):Ue},It.tickSubdivide=function(){return arguments.length&&It},It};var _o="bottom",Ro={top:1,right:1,bottom:1,left:1};function Ci(fe,Ae,Fe){fe.attr("transform",function(Ve){var Ue=Ae(Ve);return"translate("+(isFinite(Ue)?Ue:Fe(Ve))+",0)"})}function Ri(fe,Ae,Fe){fe.attr("transform",function(Ve){var Ue=Ae(Ve);return"translate(0,"+(isFinite(Ue)?Ue:Fe(Ve))+")"})}h.svg.brush=function(){var fe=re(tr,"brushstart","brush","brushend"),Ae=null,Fe=null,Ve=[0,0],Ue=[0,0],Qe,_t,dt=!0,It=!0,Qt=Eo[0];function tr(Pr){Pr.each(function(){var Vr=h.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",fn).on("touchstart.brush",fn),Jr=Vr.selectAll(".background").data([0]);Jr.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Vr.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var sn=Vr.selectAll(".resize").data(Qt,F);sn.exit().remove(),sn.enter().append("g").attr("class",function(aa){return"resize "+aa}).style("cursor",function(aa){return ks[aa]}).append("rect").attr("x",function(aa){return/[ew]$/.test(aa)?-3:null}).attr("y",function(aa){return/^[ns]/.test(aa)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),sn.style("display",tr.empty()?"none":null);var un=h.transition(Vr),Qr=h.transition(Jr),Hn;Ae&&(Hn=nn(Ae),Qr.attr("x",Hn[0]).attr("width",Hn[1]-Hn[0]),Er(un)),Fe&&(Hn=nn(Fe),Qr.attr("y",Hn[0]).attr("height",Hn[1]-Hn[0]),qr(un)),rr(un)})}tr.event=function(Pr){Pr.each(function(){var Vr=fe.of(this,arguments),Jr={x:Ve,y:Ue,i:Qe,j:_t},sn=this.__chart__||Jr;this.__chart__=Jr,ja?h.select(this).transition().each("start.brush",function(){Qe=sn.i,_t=sn.j,Ve=sn.x,Ue=sn.y,Vr({type:"brushstart"})}).tween("brush:brush",function(){var un=oo(Ve,Jr.x),Qr=oo(Ue,Jr.y);return Qe=_t=null,function(Hn){Ve=Jr.x=un(Hn),Ue=Jr.y=Qr(Hn),Vr({type:"brush",mode:"resize"})}}).each("end.brush",function(){Qe=Jr.i,_t=Jr.j,Vr({type:"brush",mode:"resize"}),Vr({type:"brushend"})}):(Vr({type:"brushstart"}),Vr({type:"brush",mode:"resize"}),Vr({type:"brushend"}))})};function rr(Pr){Pr.selectAll(".resize").attr("transform",function(Vr){return"translate("+Ve[+/e$/.test(Vr)]+","+Ue[+/^s/.test(Vr)]+")"})}function Er(Pr){Pr.select(".extent").attr("x",Ve[0]),Pr.selectAll(".extent,.n>rect,.s>rect").attr("width",Ve[1]-Ve[0])}function qr(Pr){Pr.select(".extent").attr("y",Ue[0]),Pr.selectAll(".extent,.e>rect,.w>rect").attr("height",Ue[1]-Ue[0])}function fn(){var Pr=this,Vr=h.select(h.event.target),Jr=fe.of(Pr,arguments),sn=h.select(Pr),un=Vr.datum(),Qr=!/^(n|s)$/.test(un)&&Ae,Hn=!/^(e|w)$/.test(un)&&Fe,aa=Vr.classed("extent"),Aa=Wt(Pr),sa,Da=h.mouse(Pr),fa,Ha=h.select(i(Pr)).on("keydown.brush",Ai).on("keyup.brush",wo);if(h.event.changedTouches?Ha.on("touchmove.brush",Gi).on("touchend.brush",li):Ha.on("mousemove.brush",Gi).on("mouseup.brush",li),sn.interrupt().selectAll("*").interrupt(),aa)Da[0]=Ve[0]-Da[0],Da[1]=Ue[0]-Da[1];else if(un){var Ra=+/w$/.test(un),ri=+/^n/.test(un);fa=[Ve[1-Ra]-Da[0],Ue[1-ri]-Da[1]],Da[0]=Ve[Ra],Da[1]=Ue[ri]}else h.event.altKey&&(sa=Da.slice());sn.style("pointer-events","none").selectAll(".resize").style("display",null),h.select("body").style("cursor",Vr.style("cursor")),Jr({type:"brushstart"}),Gi();function Ai(){h.event.keyCode==32&&(aa||(sa=null,Da[0]-=Ve[1],Da[1]-=Ue[1],aa=2),Z())}function wo(){h.event.keyCode==32&&aa==2&&(Da[0]+=Ve[1],Da[1]+=Ue[1],aa=0,Z())}function Gi(){var Ka=h.mouse(Pr),Ii=!1;fa&&(Ka[0]+=fa[0],Ka[1]+=fa[1]),aa||(h.event.altKey?(sa||(sa=[(Ve[0]+Ve[1])/2,(Ue[0]+Ue[1])/2]),Da[0]=Ve[+(Ka[0]<sa[0])],Da[1]=Ue[+(Ka[1]<sa[1])]):sa=null),Qr&&va(Ka,Ae,0)&&(Er(sn),Ii=!0),Hn&&va(Ka,Fe,1)&&(qr(sn),Ii=!0),Ii&&(rr(sn),Jr({type:"brush",mode:aa?"move":"resize"}))}function va(Ka,Ii,ci){var go=nn(Ii),so=go[0],Co=go[1],ss=Da[ci],Qo=ci?Ue:Ve,ls=Qo[1]-Qo[0],qi,ji;if(aa&&(so-=ss,Co-=ls+ss),qi=(ci?It:dt)?Math.max(so,Math.min(Co,Ka[ci])):Ka[ci],aa?ji=(qi+=ss)+ls:(sa&&(ss=Math.max(so,Math.min(Co,2*sa[ci]-qi))),ss<qi?(ji=qi,qi=ss):ji=ss),Qo[0]!=qi||Qo[1]!=ji)return ci?_t=null:Qe=null,Qo[0]=qi,Qo[1]=ji,!0}function li(){Gi(),sn.style("pointer-events","all").selectAll(".resize").style("display",tr.empty()?"none":null),h.select("body").style("cursor",null),Ha.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),Aa(),Jr({type:"brushend"})}}return tr.x=function(Pr){return arguments.length?(Ae=Pr,Qt=Eo[!Ae<<1|!Fe],tr):Ae},tr.y=function(Pr){return arguments.length?(Fe=Pr,Qt=Eo[!Ae<<1|!Fe],tr):Fe},tr.clamp=function(Pr){return arguments.length?(Ae&&Fe?(dt=!!Pr[0],It=!!Pr[1]):Ae?dt=!!Pr:Fe&&(It=!!Pr),tr):Ae&&Fe?[dt,It]:Ae?dt:Fe?It:null},tr.extent=function(Pr){var Vr,Jr,sn,un,Qr;return arguments.length?(Ae&&(Vr=Pr[0],Jr=Pr[1],Fe&&(Vr=Vr[0],Jr=Jr[0]),Qe=[Vr,Jr],Ae.invert&&(Vr=Ae(Vr),Jr=Ae(Jr)),Jr<Vr&&(Qr=Vr,Vr=Jr,Jr=Qr),(Vr!=Ve[0]||Jr!=Ve[1])&&(Ve=[Vr,Jr])),Fe&&(sn=Pr[0],un=Pr[1],Ae&&(sn=sn[1],un=un[1]),_t=[sn,un],Fe.invert&&(sn=Fe(sn),un=Fe(un)),un<sn&&(Qr=sn,sn=un,un=Qr),(sn!=Ue[0]||un!=Ue[1])&&(Ue=[sn,un])),tr):(Ae&&(Qe?(Vr=Qe[0],Jr=Qe[1]):(Vr=Ve[0],Jr=Ve[1],Ae.invert&&(Vr=Ae.invert(Vr),Jr=Ae.invert(Jr)),Jr<Vr&&(Qr=Vr,Vr=Jr,Jr=Qr))),Fe&&(_t?(sn=_t[0],un=_t[1]):(sn=Ue[0],un=Ue[1],Fe.invert&&(sn=Fe.invert(sn),un=Fe.invert(un)),un<sn&&(Qr=sn,sn=un,un=Qr))),Ae&&Fe?[[Vr,sn],[Jr,un]]:Ae?[Vr,Jr]:Fe&&[sn,un])},tr.clear=function(){return tr.empty()||(Ve=[0,0],Ue=[0,0],Qe=_t=null),tr},tr.empty=function(){return!!Ae&&Ve[0]==Ve[1]||!!Fe&&Ue[0]==Ue[1]},h.rebind(tr,fe,"on")};var ks={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Eo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];h.text=Ft(function(fe){return fe.responseText}),h.json=function(fe,Ae){return jt(fe,"application/json",Yo,Ae)};function Yo(fe){return JSON.parse(fe.responseText)}h.html=function(fe,Ae){return jt(fe,"text/html",os,Ae)};function os(fe){var Ae=T.createRange();return Ae.selectNode(T.body),Ae.createContextualFragment(fe.responseText)}h.xml=Ft(function(fe){return fe.responseXML}),typeof P=="object"&&P.exports?P.exports=h:this.d3=h}).apply(self)},{}],59:[function(t,P,R){P.exports=t("./quad")},{"./quad":60}],60:[function(t,P,R){var h=t("binary-search-bounds"),u=t("clamp"),A=t("parse-rect"),T=t("array-bounds"),e=t("pick-by-alias"),i=t("defined"),n=t("flatten-vertex-data"),a=t("is-obj"),r=t("dtype"),f=t("math-log2"),o=1073741824;P.exports=function(g,p){p||(p={}),g=n(g,"float64"),p=e(p,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var v=i(p.maxDepth,255),x=i(p.bounds,T(g,2));x[0]===x[2]&&x[2]++,x[1]===x[3]&&x[3]++;var l=s(g,x),b=g.length>>>1,c;p.dtype||(p.dtype="array"),typeof p.dtype=="string"?c=new(r(p.dtype))(b):p.dtype&&(c=p.dtype,Array.isArray(c)&&(c.length=b));for(var M=0;M<b;++M)c[M]=M;var _=[],y=[],w=[],d=[];F(0,0,1,c,0,1);for(var C=0,S=0;S<_.length;S++){var E=_[S];if(c.set)c.set(E,C);else for(var k=0,B=E.length;k<B;k++)c[k+C]=E[k];var z=C+_[S].length;d[S]=[C,z],C=z}return c.range=I,c;function F(V,H,j,Z,X,re){if(!Z.length)return null;var ue=_[X]||(_[X]=[]),K=w[X]||(w[X]=[]),te=y[X]||(y[X]=[]),G=ue.length;if(X++,X>v||re>o){for(var Y=0;Y<Z.length;Y++)ue.push(Z[Y]),K.push(re),te.push(null,null,null,null);return G}if(ue.push(Z[0]),K.push(re),Z.length<=1)return te.push(null,null,null,null),G;for(var ee=j*.5,ne=V+ee,J=H+ee,q=[],ae=[],le=[],ie=[],se=1,xe=Z.length;se<xe;se++){var oe=Z[se],he=l[oe*2],be=l[oe*2+1];he<ne?be<J?q.push(oe):ae.push(oe):be<J?le.push(oe):ie.push(oe)}return re<<=2,te.push(F(V,H,ee,q,X,re),F(V,J,ee,ae,X,re+1),F(ne,H,ee,le,X,re+2),F(ne,J,ee,ie,X,re+3)),G}function I(){for(var V=[],H=arguments.length;H--;)V[H]=arguments[H];var j;if(a(V[V.length-1])){var Z=V.pop();!V.length&&(Z.x!=null||Z.l!=null||Z.left!=null)&&(V=[Z],j={}),j=e(Z,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else j={};V.length||(V=x);var X=A.apply(void 0,V),re=[Math.min(X.x,X.x+X.width),Math.min(X.y,X.y+X.height),Math.max(X.x,X.x+X.width),Math.max(X.y,X.y+X.height)],ue=re[0],K=re[1],te=re[2],G=re[3],Y=s([ue,K,te,G],x),ee=Y[0],ne=Y[1],J=Y[2],q=Y[3],ae=i(j.level,_.length);if(j.d!=null){var le;typeof j.d=="number"?le=[j.d,j.d]:j.d.length&&(le=j.d),ae=Math.min(Math.max(Math.ceil(-f(Math.abs(le[0])/(x[2]-x[0]))),Math.ceil(-f(Math.abs(le[1])/(x[3]-x[1])))),ae)}if(ae=Math.min(ae,_.length),j.lod)return O(ee,ne,J,q,ae);var ie=[];se(0,0,1,0,0,1);function se(oe,he,be,me,_e,Se){if(!(_e===null||Se===null)){var De=oe+be,Ie=he+be;if(!(ee>De||ne>Ie||J<oe||q<he)&&!(me>=ae)&&_e!==Se){var Te=_[me];Se===void 0&&(Se=Te.length);for(var Ce=_e;Ce<Se;Ce++){var He=Te[Ce],Xe=g[He*2],Be=g[He*2+1];Xe>=ue&&Xe<=te&&Be>=K&&Be<=G&&ie.push(He)}var Re=y[me],We=Re[_e*4+0],vt=Re[_e*4+1],Pt=Re[_e*4+2],Zt=Re[_e*4+3],zt=xe(Re,_e+1),At=be*.5,Wt=me+1;se(oe,he,At,Wt,We,vt||Pt||Zt||zt),se(oe,he+At,At,Wt,vt,Pt||Zt||zt),se(oe+At,he,At,Wt,Pt,Zt||zt),se(oe+At,he+At,At,Wt,Zt,zt)}}}function xe(oe,he){for(var be=null,me=0;be===null;)if(be=oe[he*4+me],me++,me>oe.length)return null;return be}return ie}function O(V,H,j,Z,X){for(var re=[],ue=0;ue<X;ue++){var K=w[ue],te=d[ue][0],G=N(V,H,ue),Y=N(j,Z,ue),ee=h.ge(K,G),ne=h.gt(K,Y,ee,K.length-1);re[ue]=[ee+te,ne+te]}return re}function N(V,H,j){for(var Z=1,X=.5,re=.5,ue=.5,K=0;K<j;K++)Z<<=2,Z+=V<X?H<re?0:1:H<re?2:3,ue*=.5,X+=V<X?-ue:ue,re+=H<re?-ue:ue;return Z}};function s(m,g){for(var p=g[0],v=g[1],x=g[2],l=g[3],b=1/(x-p),c=1/(l-v),M=new Array(m.length),_=0,y=m.length/2;_<y;_++)M[2*_]=u((m[2*_]-p)*b,0,1),M[2*_+1]=u((m[2*_+1]-v)*c,0,1);return M}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(t,P,R){Object.defineProperty(R,"__esModule",{value:!0});var h=t("@turf/meta"),u=6378137;function A(a){return h.geomReduce(a,function(r,f){return r+T(f)},0)}R.default=A;function T(a){var r=0,f;switch(a.type){case"Polygon":return e(a.coordinates);case"MultiPolygon":for(f=0;f<a.coordinates.length;f++)r+=e(a.coordinates[f]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function e(a){var r=0;if(a&&a.length>0){r+=Math.abs(i(a[0]));for(var f=1;f<a.length;f++)r-=Math.abs(i(a[f]))}return r}function i(a){var r,f,o,s,m,g,p,v=0,x=a.length;if(x>2){for(p=0;p<x;p++)p===x-2?(s=x-2,m=x-1,g=0):p===x-1?(s=x-1,m=0,g=1):(s=p,m=p+1,g=p+2),r=a[s],f=a[m],o=a[g],v+=(n(o[0])-n(r[0]))*Math.sin(n(f[1]));v=v*u*u/2}return v}function n(a){return a*Math.PI/180}},{"@turf/meta":63}],62:[function(t,P,R){Object.defineProperty(R,"__esModule",{value:!0}),R.earthRadius=63710088e-1,R.factors={centimeters:R.earthRadius*100,centimetres:R.earthRadius*100,degrees:R.earthRadius/111325,feet:R.earthRadius*3.28084,inches:R.earthRadius*39.37,kilometers:R.earthRadius/1e3,kilometres:R.earthRadius/1e3,meters:R.earthRadius,metres:R.earthRadius,miles:R.earthRadius/1609.344,millimeters:R.earthRadius*1e3,millimetres:R.earthRadius*1e3,nauticalmiles:R.earthRadius/1852,radians:1,yards:R.earthRadius*1.0936},R.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/R.earthRadius,yards:1.0936133},R.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function h(S,E,k){k===void 0&&(k={});var B={type:"Feature"};return(k.id===0||k.id)&&(B.id=k.id),k.bbox&&(B.bbox=k.bbox),B.properties=E||{},B.geometry=S,B}R.feature=h;function u(S,E,k){switch(S){case"Point":return A(E).geometry;case"LineString":return n(E).geometry;case"Polygon":return e(E).geometry;case"MultiPoint":return o(E).geometry;case"MultiLineString":return f(E).geometry;case"MultiPolygon":return s(E).geometry;default:throw new Error(S+" is invalid")}}R.geometry=u;function A(S,E,k){if(k===void 0&&(k={}),!S)throw new Error("coordinates is required");if(!Array.isArray(S))throw new Error("coordinates must be an Array");if(S.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!y(S[0])||!y(S[1]))throw new Error("coordinates must contain numbers");var B={type:"Point",coordinates:S};return h(B,E,k)}R.point=A;function T(S,E,k){return k===void 0&&(k={}),r(S.map(function(B){return A(B,E)}),k)}R.points=T;function e(S,E,k){k===void 0&&(k={});for(var B=0,z=S;B<z.length;B++){var F=z[B];if(F.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var I=0;I<F[F.length-1].length;I++)if(F[F.length-1][I]!==F[0][I])throw new Error("First and last Position are not equivalent.")}var O={type:"Polygon",coordinates:S};return h(O,E,k)}R.polygon=e;function i(S,E,k){return k===void 0&&(k={}),r(S.map(function(B){return e(B,E)}),k)}R.polygons=i;function n(S,E,k){if(k===void 0&&(k={}),S.length<2)throw new Error("coordinates must be an array of two or more positions");var B={type:"LineString",coordinates:S};return h(B,E,k)}R.lineString=n;function a(S,E,k){return k===void 0&&(k={}),r(S.map(function(B){return n(B,E)}),k)}R.lineStrings=a;function r(S,E){E===void 0&&(E={});var k={type:"FeatureCollection"};return E.id&&(k.id=E.id),E.bbox&&(k.bbox=E.bbox),k.features=S,k}R.featureCollection=r;function f(S,E,k){k===void 0&&(k={});var B={type:"MultiLineString",coordinates:S};return h(B,E,k)}R.multiLineString=f;function o(S,E,k){k===void 0&&(k={});var B={type:"MultiPoint",coordinates:S};return h(B,E,k)}R.multiPoint=o;function s(S,E,k){k===void 0&&(k={});var B={type:"MultiPolygon",coordinates:S};return h(B,E,k)}R.multiPolygon=s;function m(S,E,k){k===void 0&&(k={});var B={type:"GeometryCollection",geometries:S};return h(B,E,k)}R.geometryCollection=m;function g(S,E){if(E===void 0&&(E=0),E&&!(E>=0))throw new Error("precision must be a positive number");var k=Math.pow(10,E||0);return Math.round(S*k)/k}R.round=g;function p(S,E){E===void 0&&(E="kilometers");var k=R.factors[E];if(!k)throw new Error(E+" units is invalid");return S*k}R.radiansToLength=p;function v(S,E){E===void 0&&(E="kilometers");var k=R.factors[E];if(!k)throw new Error(E+" units is invalid");return S/k}R.lengthToRadians=v;function x(S,E){return b(v(S,E))}R.lengthToDegrees=x;function l(S){var E=S%360;return E<0&&(E+=360),E}R.bearingToAzimuth=l;function b(S){var E=S%(2*Math.PI);return E*180/Math.PI}R.radiansToDegrees=b;function c(S){var E=S%360;return E*Math.PI/180}R.degreesToRadians=c;function M(S,E,k){if(E===void 0&&(E="kilometers"),k===void 0&&(k="kilometers"),!(S>=0))throw new Error("length must be a positive number");return p(v(S,E),k)}R.convertLength=M;function _(S,E,k){if(E===void 0&&(E="meters"),k===void 0&&(k="kilometers"),!(S>=0))throw new Error("area must be a positive number");var B=R.areaFactors[E];if(!B)throw new Error("invalid original units");var z=R.areaFactors[k];if(!z)throw new Error("invalid final units");return S/B*z}R.convertArea=_;function y(S){return!isNaN(S)&&S!==null&&!Array.isArray(S)}R.isNumber=y;function w(S){return!!S&&S.constructor===Object}R.isObject=w;function d(S){if(!S)throw new Error("bbox is required");if(!Array.isArray(S))throw new Error("bbox must be an Array");if(S.length!==4&&S.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");S.forEach(function(E){if(!y(E))throw new Error("bbox must only contain numbers")})}R.validateBBox=d;function C(S){if(!S)throw new Error("id is required");if(["string","number"].indexOf(typeof S)===-1)throw new Error("id must be a number or a string")}R.validateId=C},{}],63:[function(t,P,R){Object.defineProperty(R,"__esModule",{value:!0});var h=t("@turf/helpers");function u(b,c,M){if(b!==null)for(var _,y,w,d,C,S,E,k=0,B=0,z,F=b.type,I=F==="FeatureCollection",O=F==="Feature",N=I?b.features.length:1,V=0;V<N;V++){E=I?b.features[V].geometry:O?b.geometry:b,z=E?E.type==="GeometryCollection":!1,C=z?E.geometries.length:1;for(var H=0;H<C;H++){var j=0,Z=0;if(d=z?E.geometries[H]:E,d!==null){S=d.coordinates;var X=d.type;switch(k=M&&(X==="Polygon"||X==="MultiPolygon")?1:0,X){case null:break;case"Point":if(c(S,B,V,j,Z)===!1)return!1;B++,j++;break;case"LineString":case"MultiPoint":for(_=0;_<S.length;_++){if(c(S[_],B,V,j,Z)===!1)return!1;B++,X==="MultiPoint"&&j++}X==="LineString"&&j++;break;case"Polygon":case"MultiLineString":for(_=0;_<S.length;_++){for(y=0;y<S[_].length-k;y++){if(c(S[_][y],B,V,j,Z)===!1)return!1;B++}X==="MultiLineString"&&j++,X==="Polygon"&&Z++}X==="Polygon"&&j++;break;case"MultiPolygon":for(_=0;_<S.length;_++){for(Z=0,y=0;y<S[_].length;y++){for(w=0;w<S[_][y].length-k;w++){if(c(S[_][y][w],B,V,j,Z)===!1)return!1;B++}Z++}j++}break;case"GeometryCollection":for(_=0;_<d.geometries.length;_++)if(u(d.geometries[_],c,M)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function A(b,c,M,_){var y=M;return u(b,function(w,d,C,S,E){d===0&&M===void 0?y=w:y=c(y,w,d,C,S,E)},_),y}function T(b,c){var M;switch(b.type){case"FeatureCollection":for(M=0;M<b.features.length&&c(b.features[M].properties,M)!==!1;M++);break;case"Feature":c(b.properties,0);break}}function e(b,c,M){var _=M;return T(b,function(y,w){w===0&&M===void 0?_=y:_=c(_,y,w)}),_}function i(b,c){if(b.type==="Feature")c(b,0);else if(b.type==="FeatureCollection")for(var M=0;M<b.features.length&&c(b.features[M],M)!==!1;M++);}function n(b,c,M){var _=M;return i(b,function(y,w){w===0&&M===void 0?_=y:_=c(_,y,w)}),_}function a(b){var c=[];return u(b,function(M){c.push(M)}),c}function r(b,c){var M,_,y,w,d,C,S,E,k,B,z=0,F=b.type==="FeatureCollection",I=b.type==="Feature",O=F?b.features.length:1;for(M=0;M<O;M++){for(C=F?b.features[M].geometry:I?b.geometry:b,E=F?b.features[M].properties:I?b.properties:{},k=F?b.features[M].bbox:I?b.bbox:void 0,B=F?b.features[M].id:I?b.id:void 0,S=C?C.type==="GeometryCollection":!1,d=S?C.geometries.length:1,y=0;y<d;y++){if(w=S?C.geometries[y]:C,w===null){if(c(null,z,E,k,B)===!1)return!1;continue}switch(w.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(c(w,z,E,k,B)===!1)return!1;break}case"GeometryCollection":{for(_=0;_<w.geometries.length;_++)if(c(w.geometries[_],z,E,k,B)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}z++}}function f(b,c,M){var _=M;return r(b,function(y,w,d,C,S){w===0&&M===void 0?_=y:_=c(_,y,w,d,C,S)}),_}function o(b,c){r(b,function(M,_,y,w,d){var C=M===null?null:M.type;switch(C){case null:case"Point":case"LineString":case"Polygon":return c(h.feature(M,y,{bbox:w,id:d}),_,0)===!1?!1:void 0}var S;switch(C){case"MultiPoint":S="Point";break;case"MultiLineString":S="LineString";break;case"MultiPolygon":S="Polygon";break}for(var E=0;E<M.coordinates.length;E++){var k=M.coordinates[E],B={type:S,coordinates:k};if(c(h.feature(B,y),_,E)===!1)return!1}})}function s(b,c,M){var _=M;return o(b,function(y,w,d){w===0&&d===0&&M===void 0?_=y:_=c(_,y,w,d)}),_}function m(b,c){o(b,function(M,_,y){var w=0;if(!!M.geometry){var d=M.geometry.type;if(!(d==="Point"||d==="MultiPoint")){var C,S=0,E=0,k=0;if(u(M,function(B,z,F,I,O){if(C===void 0||_>S||I>E||O>k){C=B,S=_,E=I,k=O,w=0;return}var N=h.lineString([C,B],M.properties);if(c(N,_,y,O,w)===!1)return!1;w++,C=B})===!1)return!1}}})}function g(b,c,M){var _=M,y=!1;return m(b,function(w,d,C,S,E){y===!1&&M===void 0?_=w:_=c(_,w,d,C,S,E),y=!0}),_}function p(b,c){if(!b)throw new Error("geojson is required");o(b,function(M,_,y){if(M.geometry!==null){var w=M.geometry.type,d=M.geometry.coordinates;switch(w){case"LineString":if(c(M,_,y,0,0)===!1)return!1;break;case"Polygon":for(var C=0;C<d.length;C++)if(c(h.lineString(d[C],M.properties),_,y,C)===!1)return!1;break}}})}function v(b,c,M){var _=M;return p(b,function(y,w,d,C){w===0&&M===void 0?_=y:_=c(_,y,w,d,C)}),_}function x(b,c){if(c=c||{},!h.isObject(c))throw new Error("options is invalid");var M=c.featureIndex||0,_=c.multiFeatureIndex||0,y=c.geometryIndex||0,w=c.segmentIndex||0,d=c.properties,C;switch(b.type){case"FeatureCollection":M<0&&(M=b.features.length+M),d=d||b.features[M].properties,C=b.features[M].geometry;break;case"Feature":d=d||b.properties,C=b.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":C=b;break;default:throw new Error("geojson is invalid")}if(C===null)return null;var S=C.coordinates;switch(C.type){case"Point":case"MultiPoint":return null;case"LineString":return w<0&&(w=S.length+w-1),h.lineString([S[w],S[w+1]],d,c);case"Polygon":return y<0&&(y=S.length+y),w<0&&(w=S[y].length+w-1),h.lineString([S[y][w],S[y][w+1]],d,c);case"MultiLineString":return _<0&&(_=S.length+_),w<0&&(w=S[_].length+w-1),h.lineString([S[_][w],S[_][w+1]],d,c);case"MultiPolygon":return _<0&&(_=S.length+_),y<0&&(y=S[_].length+y),w<0&&(w=S[_][y].length-w-1),h.lineString([S[_][y][w],S[_][y][w+1]],d,c)}throw new Error("geojson is invalid")}function l(b,c){if(c=c||{},!h.isObject(c))throw new Error("options is invalid");var M=c.featureIndex||0,_=c.multiFeatureIndex||0,y=c.geometryIndex||0,w=c.coordIndex||0,d=c.properties,C;switch(b.type){case"FeatureCollection":M<0&&(M=b.features.length+M),d=d||b.features[M].properties,C=b.features[M].geometry;break;case"Feature":d=d||b.properties,C=b.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":C=b;break;default:throw new Error("geojson is invalid")}if(C===null)return null;var S=C.coordinates;switch(C.type){case"Point":return h.point(S,d,c);case"MultiPoint":return _<0&&(_=S.length+_),h.point(S[_],d,c);case"LineString":return w<0&&(w=S.length+w),h.point(S[w],d,c);case"Polygon":return y<0&&(y=S.length+y),w<0&&(w=S[y].length+w),h.point(S[y][w],d,c);case"MultiLineString":return _<0&&(_=S.length+_),w<0&&(w=S[_].length+w),h.point(S[_][w],d,c);case"MultiPolygon":return _<0&&(_=S.length+_),y<0&&(y=S[_].length+y),w<0&&(w=S[_][y].length-w),h.point(S[_][y][w],d,c)}throw new Error("geojson is invalid")}R.coordEach=u,R.coordReduce=A,R.propEach=T,R.propReduce=e,R.featureEach=i,R.featureReduce=n,R.coordAll=a,R.geomEach=r,R.geomReduce=f,R.flattenEach=o,R.flattenReduce=s,R.segmentEach=m,R.segmentReduce=g,R.lineEach=p,R.lineReduce=v,R.findSegment=x,R.findPoint=l},{"@turf/helpers":62}],64:[function(t,P,R){Object.defineProperty(R,"__esModule",{value:!0});var h=t("@turf/meta");function u(A){var T=[1/0,1/0,-1/0,-1/0];return h.coordEach(A,function(e){T[0]>e[0]&&(T[0]=e[0]),T[1]>e[1]&&(T[1]=e[1]),T[2]<e[0]&&(T[2]=e[0]),T[3]<e[1]&&(T[3]=e[1])}),T}u.default=u,R.default=u},{"@turf/meta":66}],65:[function(t,P,R){arguments[4][62][0].apply(R,arguments)},{dup:62}],66:[function(t,P,R){arguments[4][63][0].apply(R,arguments)},{"@turf/helpers":65,dup:63}],67:[function(t,P,R){Object.defineProperty(R,"__esModule",{value:!0});var h=t("@turf/meta"),u=t("@turf/helpers");function A(T,e){e===void 0&&(e={});var i=0,n=0,a=0;return h.coordEach(T,function(r){i+=r[0],n+=r[1],a++}),u.point([i/a,n/a],e.properties)}R.default=A},{"@turf/helpers":68,"@turf/meta":69}],68:[function(t,P,R){Object.defineProperty(R,"__esModule",{value:!0}),R.earthRadius=63710088e-1,R.factors={centimeters:R.earthRadius*100,centimetres:R.earthRadius*100,degrees:R.earthRadius/111325,feet:R.earthRadius*3.28084,inches:R.earthRadius*39.37,kilometers:R.earthRadius/1e3,kilometres:R.earthRadius/1e3,meters:R.earthRadius,metres:R.earthRadius,miles:R.earthRadius/1609.344,millimeters:R.earthRadius*1e3,millimetres:R.earthRadius*1e3,nauticalmiles:R.earthRadius/1852,radians:1,yards:R.earthRadius/1.0936},R.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/R.earthRadius,yards:1/1.0936},R.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function h(O,N,V){V===void 0&&(V={});var H={type:"Feature"};return(V.id===0||V.id)&&(H.id=V.id),V.bbox&&(H.bbox=V.bbox),H.properties=N||{},H.geometry=O,H}R.feature=h;function u(O,N,V){switch(O){case"Point":return A(N).geometry;case"LineString":return n(N).geometry;case"Polygon":return e(N).geometry;case"MultiPoint":return o(N).geometry;case"MultiLineString":return f(N).geometry;case"MultiPolygon":return s(N).geometry;default:throw new Error(O+" is invalid")}}R.geometry=u;function A(O,N,V){V===void 0&&(V={});var H={type:"Point",coordinates:O};return h(H,N,V)}R.point=A;function T(O,N,V){return V===void 0&&(V={}),r(O.map(function(H){return A(H,N)}),V)}R.points=T;function e(O,N,V){V===void 0&&(V={});for(var H=0,j=O;H<j.length;H++){var Z=j[H];if(Z.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var X=0;X<Z[Z.length-1].length;X++)if(Z[Z.length-1][X]!==Z[0][X])throw new Error("First and last Position are not equivalent.")}var re={type:"Polygon",coordinates:O};return h(re,N,V)}R.polygon=e;function i(O,N,V){return V===void 0&&(V={}),r(O.map(function(H){return e(H,N)}),V)}R.polygons=i;function n(O,N,V){if(V===void 0&&(V={}),O.length<2)throw new Error("coordinates must be an array of two or more positions");var H={type:"LineString",coordinates:O};return h(H,N,V)}R.lineString=n;function a(O,N,V){return V===void 0&&(V={}),r(O.map(function(H){return n(H,N)}),V)}R.lineStrings=a;function r(O,N){N===void 0&&(N={});var V={type:"FeatureCollection"};return N.id&&(V.id=N.id),N.bbox&&(V.bbox=N.bbox),V.features=O,V}R.featureCollection=r;function f(O,N,V){V===void 0&&(V={});var H={type:"MultiLineString",coordinates:O};return h(H,N,V)}R.multiLineString=f;function o(O,N,V){V===void 0&&(V={});var H={type:"MultiPoint",coordinates:O};return h(H,N,V)}R.multiPoint=o;function s(O,N,V){V===void 0&&(V={});var H={type:"MultiPolygon",coordinates:O};return h(H,N,V)}R.multiPolygon=s;function m(O,N,V){V===void 0&&(V={});var H={type:"GeometryCollection",geometries:O};return h(H,N,V)}R.geometryCollection=m;function g(O,N){if(N===void 0&&(N=0),N&&!(N>=0))throw new Error("precision must be a positive number");var V=Math.pow(10,N||0);return Math.round(O*V)/V}R.round=g;function p(O,N){N===void 0&&(N="kilometers");var V=R.factors[N];if(!V)throw new Error(N+" units is invalid");return O*V}R.radiansToLength=p;function v(O,N){N===void 0&&(N="kilometers");var V=R.factors[N];if(!V)throw new Error(N+" units is invalid");return O/V}R.lengthToRadians=v;function x(O,N){return b(v(O,N))}R.lengthToDegrees=x;function l(O){var N=O%360;return N<0&&(N+=360),N}R.bearingToAzimuth=l;function b(O){var N=O%(2*Math.PI);return N*180/Math.PI}R.radiansToDegrees=b;function c(O){var N=O%360;return N*Math.PI/180}R.degreesToRadians=c;function M(O,N,V){if(N===void 0&&(N="kilometers"),V===void 0&&(V="kilometers"),!(O>=0))throw new Error("length must be a positive number");return p(v(O,N),V)}R.convertLength=M;function _(O,N,V){if(N===void 0&&(N="meters"),V===void 0&&(V="kilometers"),!(O>=0))throw new Error("area must be a positive number");var H=R.areaFactors[N];if(!H)throw new Error("invalid original units");var j=R.areaFactors[V];if(!j)throw new Error("invalid final units");return O/H*j}R.convertArea=_;function y(O){return!isNaN(O)&&O!==null&&!Array.isArray(O)&&!/^\s*$/.test(O)}R.isNumber=y;function w(O){return!!O&&O.constructor===Object}R.isObject=w;function d(O){if(!O)throw new Error("bbox is required");if(!Array.isArray(O))throw new Error("bbox must be an Array");if(O.length!==4&&O.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");O.forEach(function(N){if(!y(N))throw new Error("bbox must only contain numbers")})}R.validateBBox=d;function C(O){if(!O)throw new Error("id is required");if(["string","number"].indexOf(typeof O)===-1)throw new Error("id must be a number or a string")}R.validateId=C;function S(){throw new Error("method has been renamed to `radiansToDegrees`")}R.radians2degrees=S;function E(){throw new Error("method has been renamed to `degreesToRadians`")}R.degrees2radians=E;function k(){throw new Error("method has been renamed to `lengthToDegrees`")}R.distanceToDegrees=k;function B(){throw new Error("method has been renamed to `lengthToRadians`")}R.distanceToRadians=B;function z(){throw new Error("method has been renamed to `radiansToLength`")}R.radiansToDistance=z;function F(){throw new Error("method has been renamed to `bearingToAzimuth`")}R.bearingToAngle=F;function I(){throw new Error("method has been renamed to `convertLength`")}R.convertDistance=I},{}],69:[function(t,P,R){Object.defineProperty(R,"__esModule",{value:!0});var h=t("@turf/helpers");function u(b,c,M){if(b!==null)for(var _,y,w,d,C,S,E,k=0,B=0,z,F=b.type,I=F==="FeatureCollection",O=F==="Feature",N=I?b.features.length:1,V=0;V<N;V++){E=I?b.features[V].geometry:O?b.geometry:b,z=E?E.type==="GeometryCollection":!1,C=z?E.geometries.length:1;for(var H=0;H<C;H++){var j=0,Z=0;if(d=z?E.geometries[H]:E,d!==null){S=d.coordinates;var X=d.type;switch(k=M&&(X==="Polygon"||X==="MultiPolygon")?1:0,X){case null:break;case"Point":if(c(S,B,V,j,Z)===!1)return!1;B++,j++;break;case"LineString":case"MultiPoint":for(_=0;_<S.length;_++){if(c(S[_],B,V,j,Z)===!1)return!1;B++,X==="MultiPoint"&&j++}X==="LineString"&&j++;break;case"Polygon":case"MultiLineString":for(_=0;_<S.length;_++){for(y=0;y<S[_].length-k;y++){if(c(S[_][y],B,V,j,Z)===!1)return!1;B++}X==="MultiLineString"&&j++,X==="Polygon"&&Z++}X==="Polygon"&&j++;break;case"MultiPolygon":for(_=0;_<S.length;_++){for(Z=0,y=0;y<S[_].length;y++){for(w=0;w<S[_][y].length-k;w++){if(c(S[_][y][w],B,V,j,Z)===!1)return!1;B++}Z++}j++}break;case"GeometryCollection":for(_=0;_<d.geometries.length;_++)if(u(d.geometries[_],c,M)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function A(b,c,M,_){var y=M;return u(b,function(w,d,C,S,E){d===0&&M===void 0?y=w:y=c(y,w,d,C,S,E)},_),y}function T(b,c){var M;switch(b.type){case"FeatureCollection":for(M=0;M<b.features.length&&c(b.features[M].properties,M)!==!1;M++);break;case"Feature":c(b.properties,0);break}}function e(b,c,M){var _=M;return T(b,function(y,w){w===0&&M===void 0?_=y:_=c(_,y,w)}),_}function i(b,c){if(b.type==="Feature")c(b,0);else if(b.type==="FeatureCollection")for(var M=0;M<b.features.length&&c(b.features[M],M)!==!1;M++);}function n(b,c,M){var _=M;return i(b,function(y,w){w===0&&M===void 0?_=y:_=c(_,y,w)}),_}function a(b){var c=[];return u(b,function(M){c.push(M)}),c}function r(b,c){var M,_,y,w,d,C,S,E,k,B,z=0,F=b.type==="FeatureCollection",I=b.type==="Feature",O=F?b.features.length:1;for(M=0;M<O;M++){for(C=F?b.features[M].geometry:I?b.geometry:b,E=F?b.features[M].properties:I?b.properties:{},k=F?b.features[M].bbox:I?b.bbox:void 0,B=F?b.features[M].id:I?b.id:void 0,S=C?C.type==="GeometryCollection":!1,d=S?C.geometries.length:1,y=0;y<d;y++){if(w=S?C.geometries[y]:C,w===null){if(c(null,z,E,k,B)===!1)return!1;continue}switch(w.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(c(w,z,E,k,B)===!1)return!1;break}case"GeometryCollection":{for(_=0;_<w.geometries.length;_++)if(c(w.geometries[_],z,E,k,B)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}z++}}function f(b,c,M){var _=M;return r(b,function(y,w,d,C,S){w===0&&M===void 0?_=y:_=c(_,y,w,d,C,S)}),_}function o(b,c){r(b,function(M,_,y,w,d){var C=M===null?null:M.type;switch(C){case null:case"Point":case"LineString":case"Polygon":return c(h.feature(M,y,{bbox:w,id:d}),_,0)===!1?!1:void 0}var S;switch(C){case"MultiPoint":S="Point";break;case"MultiLineString":S="LineString";break;case"MultiPolygon":S="Polygon";break}for(var E=0;E<M.coordinates.length;E++){var k=M.coordinates[E],B={type:S,coordinates:k};if(c(h.feature(B,y),_,E)===!1)return!1}})}function s(b,c,M){var _=M;return o(b,function(y,w,d){w===0&&d===0&&M===void 0?_=y:_=c(_,y,w,d)}),_}function m(b,c){o(b,function(M,_,y){var w=0;if(!!M.geometry){var d=M.geometry.type;if(!(d==="Point"||d==="MultiPoint")){var C,S=0,E=0,k=0;if(u(M,function(B,z,F,I,O){if(C===void 0||_>S||I>E||O>k){C=B,S=_,E=I,k=O,w=0;return}var N=h.lineString([C,B],M.properties);if(c(N,_,y,O,w)===!1)return!1;w++,C=B})===!1)return!1}}})}function g(b,c,M){var _=M,y=!1;return m(b,function(w,d,C,S,E){y===!1&&M===void 0?_=w:_=c(_,w,d,C,S,E),y=!0}),_}function p(b,c){if(!b)throw new Error("geojson is required");o(b,function(M,_,y){if(M.geometry!==null){var w=M.geometry.type,d=M.geometry.coordinates;switch(w){case"LineString":if(c(M,_,y,0,0)===!1)return!1;break;case"Polygon":for(var C=0;C<d.length;C++)if(c(h.lineString(d[C],M.properties),_,y,C)===!1)return!1;break}}})}function v(b,c,M){var _=M;return p(b,function(y,w,d,C){w===0&&M===void 0?_=y:_=c(_,y,w,d,C)}),_}function x(b,c){if(c=c||{},!h.isObject(c))throw new Error("options is invalid");var M=c.featureIndex||0,_=c.multiFeatureIndex||0,y=c.geometryIndex||0,w=c.segmentIndex||0,d=c.properties,C;switch(b.type){case"FeatureCollection":M<0&&(M=b.features.length+M),d=d||b.features[M].properties,C=b.features[M].geometry;break;case"Feature":d=d||b.properties,C=b.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":C=b;break;default:throw new Error("geojson is invalid")}if(C===null)return null;var S=C.coordinates;switch(C.type){case"Point":case"MultiPoint":return null;case"LineString":return w<0&&(w=S.length+w-1),h.lineString([S[w],S[w+1]],d,c);case"Polygon":return y<0&&(y=S.length+y),w<0&&(w=S[y].length+w-1),h.lineString([S[y][w],S[y][w+1]],d,c);case"MultiLineString":return _<0&&(_=S.length+_),w<0&&(w=S[_].length+w-1),h.lineString([S[_][w],S[_][w+1]],d,c);case"MultiPolygon":return _<0&&(_=S.length+_),y<0&&(y=S[_].length+y),w<0&&(w=S[_][y].length-w-1),h.lineString([S[_][y][w],S[_][y][w+1]],d,c)}throw new Error("geojson is invalid")}function l(b,c){if(c=c||{},!h.isObject(c))throw new Error("options is invalid");var M=c.featureIndex||0,_=c.multiFeatureIndex||0,y=c.geometryIndex||0,w=c.coordIndex||0,d=c.properties,C;switch(b.type){case"FeatureCollection":M<0&&(M=b.features.length+M),d=d||b.features[M].properties,C=b.features[M].geometry;break;case"Feature":d=d||b.properties,C=b.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":C=b;break;default:throw new Error("geojson is invalid")}if(C===null)return null;var S=C.coordinates;switch(C.type){case"Point":return h.point(S,d,c);case"MultiPoint":return _<0&&(_=S.length+_),h.point(S[_],d,c);case"LineString":return w<0&&(w=S.length+w),h.point(S[w],d,c);case"Polygon":return y<0&&(y=S.length+y),w<0&&(w=S[y].length+w),h.point(S[y][w],d,c);case"MultiLineString":return _<0&&(_=S.length+_),w<0&&(w=S[_].length+w),h.point(S[_][w],d,c);case"MultiPolygon":return _<0&&(_=S.length+_),y<0&&(y=S[_].length+y),w<0&&(w=S[_][y].length-w),h.point(S[_][y][w],d,c)}throw new Error("geojson is invalid")}R.coordEach=u,R.coordReduce=A,R.propEach=T,R.propReduce=e,R.featureEach=i,R.featureReduce=n,R.coordAll=a,R.geomEach=r,R.geomReduce=f,R.flattenEach=o,R.flattenReduce=s,R.segmentEach=m,R.segmentReduce=g,R.lineEach=p,R.lineReduce=v,R.findSegment=x,R.findPoint=l},{"@turf/helpers":68}],70:[function(t,P,R){P.exports=h;function h(u){var A=0,T=0,e=0,i=0;return u.map(function(n){n=n.slice();var a=n[0],r=a.toUpperCase();if(a!=r)switch(n[0]=r,a){case"a":n[6]+=e,n[7]+=i;break;case"v":n[1]+=i;break;case"h":n[1]+=e;break;default:for(var f=1;f<n.length;)n[f++]+=e,n[f++]+=i}switch(r){case"Z":e=A,i=T;break;case"H":e=n[1];break;case"V":i=n[1];break;case"M":e=A=n[1],i=T=n[2];break;default:e=n[n.length-2],i=n[n.length-1]}return n})}},{}],71:[function(t,P,R){P.exports=h;function h(u,A){if(!u||u.length==null)throw Error("Argument should be an array");A==null?A=1:A=Math.floor(A);for(var T=Array(A*2),e=0;e<A;e++){for(var i=-1/0,n=1/0,a=e,r=u.length;a<r;a+=A)u[a]>i&&(i=u[a]),u[a]<n&&(n=u[a]);T[e]=n,T[A+e]=i}return T}},{}],72:[function(t,P,R){P.exports=function(h,u,A){if(typeof Array.prototype.findIndex=="function")return h.findIndex(u,A);if(typeof u!="function")throw new TypeError("predicate must be a function");var T=Object(h),e=T.length;if(e===0)return-1;for(var i=0;i<e;i++)if(u.call(A,T[i],i,T))return i;return-1}},{}],73:[function(t,P,R){var h=t("array-bounds");P.exports=u;function u(A,T,e){if(!A||A.length==null)throw Error("Argument should be an array");T==null&&(T=1),e==null&&(e=h(A,T));for(var i=0;i<T;i++){var n=e[T+i],a=e[i],r=i,f=A.length;if(n===1/0&&a===-1/0)for(r=i;r<f;r+=T)A[r]=A[r]===n?1:A[r]===a?0:.5;else if(n===1/0)for(r=i;r<f;r+=T)A[r]=A[r]===n?1:0;else if(a===-1/0)for(r=i;r<f;r+=T)A[r]=A[r]===a?0:1;else{var o=n-a;for(r=i;r<f;r+=T)isNaN(A[r])||(A[r]=o===0?.5:(A[r]-a)/o)}}return A}},{"array-bounds":71}],74:[function(t,P,R){P.exports=function(u,A){var T=typeof u=="number",e=typeof A=="number";T&&!e?(A=u,u=0):!T&&!e&&(u=0,A=0),u=u|0,A=A|0;var i=A-u;if(i<0)throw new Error("array length must be positive");for(var n=new Array(i),a=0,r=u;a<i;a++,r++)n[a]=r;return n}},{}],75:[function(t,P,R){(function(h){(function(){var u=t("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function A(E,k){if(E===k)return 0;for(var B=E.length,z=k.length,F=0,I=Math.min(B,z);F<I;++F)if(E[F]!==k[F]){B=E[F],z=k[F];break}return B<z?-1:z<B?1:0}function T(E){return h.Buffer&&typeof h.Buffer.isBuffer=="function"?h.Buffer.isBuffer(E):!!(E!=null&&E._isBuffer)}var e=t("util/"),i=Object.prototype.hasOwnProperty,n=Array.prototype.slice,a=function(){return function(){}.name==="foo"}();function r(E){return Object.prototype.toString.call(E)}function f(E){return T(E)||typeof h.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(E):E?!!(E instanceof DataView||E.buffer&&E.buffer instanceof ArrayBuffer):!1}var o=P.exports=l,s=/\s*function\s+([^\(\s]*)\s*/;function m(E){if(!!e.isFunction(E)){if(a)return E.name;var k=E.toString(),B=k.match(s);return B&&B[1]}}o.AssertionError=function(k){this.name="AssertionError",this.actual=k.actual,this.expected=k.expected,this.operator=k.operator,k.message?(this.message=k.message,this.generatedMessage=!1):(this.message=v(this),this.generatedMessage=!0);var B=k.stackStartFunction||x;if(Error.captureStackTrace)Error.captureStackTrace(this,B);else{var z=new Error;if(z.stack){var F=z.stack,I=m(B),O=F.indexOf(`
`+I);if(O>=0){var N=F.indexOf(`
`,O+1);F=F.substring(N+1)}this.stack=F}}},e.inherits(o.AssertionError,Error);function g(E,k){return typeof E=="string"?E.length<k?E:E.slice(0,k):E}function p(E){if(a||!e.isFunction(E))return e.inspect(E);var k=m(E),B=k?": "+k:"";return"[Function"+B+"]"}function v(E){return g(p(E.actual),128)+" "+E.operator+" "+g(p(E.expected),128)}function x(E,k,B,z,F){throw new o.AssertionError({message:B,actual:E,expected:k,operator:z,stackStartFunction:F})}o.fail=x;function l(E,k){E||x(E,!0,k,"==",o.ok)}o.ok=l,o.equal=function(k,B,z){k!=B&&x(k,B,z,"==",o.equal)},o.notEqual=function(k,B,z){k==B&&x(k,B,z,"!=",o.notEqual)},o.deepEqual=function(k,B,z){b(k,B,!1)||x(k,B,z,"deepEqual",o.deepEqual)},o.deepStrictEqual=function(k,B,z){b(k,B,!0)||x(k,B,z,"deepStrictEqual",o.deepStrictEqual)};function b(E,k,B,z){if(E===k)return!0;if(T(E)&&T(k))return A(E,k)===0;if(e.isDate(E)&&e.isDate(k))return E.getTime()===k.getTime();if(e.isRegExp(E)&&e.isRegExp(k))return E.source===k.source&&E.global===k.global&&E.multiline===k.multiline&&E.lastIndex===k.lastIndex&&E.ignoreCase===k.ignoreCase;if((E===null||typeof E!="object")&&(k===null||typeof k!="object"))return B?E===k:E==k;if(f(E)&&f(k)&&r(E)===r(k)&&!(E instanceof Float32Array||E instanceof Float64Array))return A(new Uint8Array(E.buffer),new Uint8Array(k.buffer))===0;if(T(E)!==T(k))return!1;z=z||{actual:[],expected:[]};var F=z.actual.indexOf(E);return F!==-1&&F===z.expected.indexOf(k)?!0:(z.actual.push(E),z.expected.push(k),M(E,k,B,z))}function c(E){return Object.prototype.toString.call(E)=="[object Arguments]"}function M(E,k,B,z){if(E==null||k===null||k===void 0)return!1;if(e.isPrimitive(E)||e.isPrimitive(k))return E===k;if(B&&Object.getPrototypeOf(E)!==Object.getPrototypeOf(k))return!1;var F=c(E),I=c(k);if(F&&!I||!F&&I)return!1;if(F)return E=n.call(E),k=n.call(k),b(E,k,B);var O=S(E),N=S(k),V,H;if(O.length!==N.length)return!1;for(O.sort(),N.sort(),H=O.length-1;H>=0;H--)if(O[H]!==N[H])return!1;for(H=O.length-1;H>=0;H--)if(V=O[H],!b(E[V],k[V],B,z))return!1;return!0}o.notDeepEqual=function(k,B,z){b(k,B,!1)&&x(k,B,z,"notDeepEqual",o.notDeepEqual)},o.notDeepStrictEqual=_;function _(E,k,B){b(E,k,!0)&&x(E,k,B,"notDeepStrictEqual",_)}o.strictEqual=function(k,B,z){k!==B&&x(k,B,z,"===",o.strictEqual)},o.notStrictEqual=function(k,B,z){k===B&&x(k,B,z,"!==",o.notStrictEqual)};function y(E,k){if(!E||!k)return!1;if(Object.prototype.toString.call(k)=="[object RegExp]")return k.test(E);try{if(E instanceof k)return!0}catch{}return Error.isPrototypeOf(k)?!1:k.call({},E)===!0}function w(E){var k;try{E()}catch(B){k=B}return k}function d(E,k,B,z){var F;if(typeof k!="function")throw new TypeError('"block" argument must be a function');typeof B=="string"&&(z=B,B=null),F=w(k),z=(B&&B.name?" ("+B.name+").":".")+(z?" "+z:"."),E&&!F&&x(F,B,"Missing expected exception"+z);var I=typeof z=="string",O=!E&&e.isError(F),N=!E&&F&&!B;if((O&&I&&y(F,B)||N)&&x(F,B,"Got unwanted exception"+z),E&&F&&B&&!y(F,B)||!E&&F)throw F}o.throws=function(E,k,B){d(!0,E,k,B)},o.doesNotThrow=function(E,k,B){d(!1,E,k,B)},o.ifError=function(E){if(E)throw E};function C(E,k){E||x(E,!0,k,"==",C)}o.strict=u(C,o,{equal:o.strictEqual,deepEqual:o.deepStrictEqual,notEqual:o.notStrictEqual,notDeepEqual:o.notDeepStrictEqual}),o.strict.strict=o.strict;var S=Object.keys||function(E){var k=[];for(var B in E)i.call(E,B)&&k.push(B);return k}}).call(this)}).call(this,typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":247,"util/":78}],76:[function(t,P,R){typeof Object.create=="function"?P.exports=function(u,A){u.super_=A,u.prototype=Object.create(A.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}})}:P.exports=function(u,A){u.super_=A;var T=function(){};T.prototype=A.prototype,u.prototype=new T,u.prototype.constructor=u}},{}],77:[function(t,P,R){P.exports=function(u){return u&&typeof u=="object"&&typeof u.copy=="function"&&typeof u.fill=="function"&&typeof u.readUInt8=="function"}},{}],78:[function(t,P,R){(function(h,u){(function(){var A=/%[sdj%]/g;R.format=function(N){if(!M(N)){for(var V=[],H=0;H<arguments.length;H++)V.push(i(arguments[H]));return V.join(" ")}for(var H=1,j=arguments,Z=j.length,X=String(N).replace(A,function(ue){if(ue==="%%")return"%";if(H>=Z)return ue;switch(ue){case"%s":return String(j[H++]);case"%d":return Number(j[H++]);case"%j":try{return JSON.stringify(j[H++])}catch{return"[Circular]"}default:return ue}}),re=j[H];H<Z;re=j[++H])l(re)||!d(re)?X+=" "+re:X+=" "+i(re);return X},R.deprecate=function(N,V){if(y(u.process))return function(){return R.deprecate(N,V).apply(this,arguments)};if(h.noDeprecation===!0)return N;var H=!1;function j(){if(!H){if(h.throwDeprecation)throw new Error(V);h.traceDeprecation?console.trace(V):console.error(V),H=!0}return N.apply(this,arguments)}return j};var T={},e;R.debuglog=function(N){if(y(e)&&(e=h.env.NODE_DEBUG||""),N=N.toUpperCase(),!T[N])if(new RegExp("\\b"+N+"\\b","i").test(e)){var V=h.pid;T[N]=function(){var H=R.format.apply(R,arguments);console.error("%s %d: %s",N,V,H)}}else T[N]=function(){};return T[N]};function i(N,V){var H={seen:[],stylize:a};return arguments.length>=3&&(H.depth=arguments[2]),arguments.length>=4&&(H.colors=arguments[3]),x(V)?H.showHidden=V:V&&R._extend(H,V),y(H.showHidden)&&(H.showHidden=!1),y(H.depth)&&(H.depth=2),y(H.colors)&&(H.colors=!1),y(H.customInspect)&&(H.customInspect=!0),H.colors&&(H.stylize=n),f(H,N,H.depth)}R.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function n(N,V){var H=i.styles[V];return H?"\x1B["+i.colors[H][0]+"m"+N+"\x1B["+i.colors[H][1]+"m":N}function a(N,V){return N}function r(N){var V={};return N.forEach(function(H,j){V[H]=!0}),V}function f(N,V,H){if(N.customInspect&&V&&E(V.inspect)&&V.inspect!==R.inspect&&!(V.constructor&&V.constructor.prototype===V)){var j=V.inspect(H,N);return M(j)||(j=f(N,j,H)),j}var Z=o(N,V);if(Z)return Z;var X=Object.keys(V),re=r(X);if(N.showHidden&&(X=Object.getOwnPropertyNames(V)),S(V)&&(X.indexOf("message")>=0||X.indexOf("description")>=0))return s(V);if(X.length===0){if(E(V)){var ue=V.name?": "+V.name:"";return N.stylize("[Function"+ue+"]","special")}if(w(V))return N.stylize(RegExp.prototype.toString.call(V),"regexp");if(C(V))return N.stylize(Date.prototype.toString.call(V),"date");if(S(V))return s(V)}var K="",te=!1,G=["{","}"];if(v(V)&&(te=!0,G=["[","]"]),E(V)){var Y=V.name?": "+V.name:"";K=" [Function"+Y+"]"}if(w(V)&&(K=" "+RegExp.prototype.toString.call(V)),C(V)&&(K=" "+Date.prototype.toUTCString.call(V)),S(V)&&(K=" "+s(V)),X.length===0&&(!te||V.length==0))return G[0]+K+G[1];if(H<0)return w(V)?N.stylize(RegExp.prototype.toString.call(V),"regexp"):N.stylize("[Object]","special");N.seen.push(V);var ee;return te?ee=m(N,V,H,re,X):ee=X.map(function(ne){return g(N,V,H,re,ne,te)}),N.seen.pop(),p(ee,K,G)}function o(N,V){if(y(V))return N.stylize("undefined","undefined");if(M(V)){var H="'"+JSON.stringify(V).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return N.stylize(H,"string")}if(c(V))return N.stylize(""+V,"number");if(x(V))return N.stylize(""+V,"boolean");if(l(V))return N.stylize("null","null")}function s(N){return"["+Error.prototype.toString.call(N)+"]"}function m(N,V,H,j,Z){for(var X=[],re=0,ue=V.length;re<ue;++re)O(V,String(re))?X.push(g(N,V,H,j,String(re),!0)):X.push("");return Z.forEach(function(K){K.match(/^\d+$/)||X.push(g(N,V,H,j,K,!0))}),X}function g(N,V,H,j,Z,X){var re,ue,K;if(K=Object.getOwnPropertyDescriptor(V,Z)||{value:V[Z]},K.get?K.set?ue=N.stylize("[Getter/Setter]","special"):ue=N.stylize("[Getter]","special"):K.set&&(ue=N.stylize("[Setter]","special")),O(j,Z)||(re="["+Z+"]"),ue||(N.seen.indexOf(K.value)<0?(l(H)?ue=f(N,K.value,null):ue=f(N,K.value,H-1),ue.indexOf(`
`)>-1&&(X?ue=ue.split(`
`).map(function(te){return"  "+te}).join(`
`).substr(2):ue=`
`+ue.split(`
`).map(function(te){return"   "+te}).join(`
`))):ue=N.stylize("[Circular]","special")),y(re)){if(X&&Z.match(/^\d+$/))return ue;re=JSON.stringify(""+Z),re.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(re=re.substr(1,re.length-2),re=N.stylize(re,"name")):(re=re.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),re=N.stylize(re,"string"))}return re+": "+ue}function p(N,V,H){var j=N.reduce(function(Z,X){return X.indexOf(`
`)>=0,Z+X.replace(/\u001b\[\d\d?m/g,"").length+1},0);return j>60?H[0]+(V===""?"":V+`
 `)+" "+N.join(`,
  `)+" "+H[1]:H[0]+V+" "+N.join(", ")+" "+H[1]}function v(N){return Array.isArray(N)}R.isArray=v;function x(N){return typeof N=="boolean"}R.isBoolean=x;function l(N){return N===null}R.isNull=l;function b(N){return N==null}R.isNullOrUndefined=b;function c(N){return typeof N=="number"}R.isNumber=c;function M(N){return typeof N=="string"}R.isString=M;function _(N){return typeof N=="symbol"}R.isSymbol=_;function y(N){return N===void 0}R.isUndefined=y;function w(N){return d(N)&&B(N)==="[object RegExp]"}R.isRegExp=w;function d(N){return typeof N=="object"&&N!==null}R.isObject=d;function C(N){return d(N)&&B(N)==="[object Date]"}R.isDate=C;function S(N){return d(N)&&(B(N)==="[object Error]"||N instanceof Error)}R.isError=S;function E(N){return typeof N=="function"}R.isFunction=E;function k(N){return N===null||typeof N=="boolean"||typeof N=="number"||typeof N=="string"||typeof N=="symbol"||typeof N>"u"}R.isPrimitive=k,R.isBuffer=t("./support/isBuffer");function B(N){return Object.prototype.toString.call(N)}function z(N){return N<10?"0"+N.toString(10):N.toString(10)}var F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(){var N=new Date,V=[z(N.getHours()),z(N.getMinutes()),z(N.getSeconds())].join(":");return[N.getDate(),F[N.getMonth()],V].join(" ")}R.log=function(){console.log("%s - %s",I(),R.format.apply(R,arguments))},R.inherits=t("inherits"),R._extend=function(N,V){if(!V||!d(V))return N;for(var H=Object.keys(V),j=H.length;j--;)N[H[j]]=V[H[j]];return N};function O(N,V){return Object.prototype.hasOwnProperty.call(N,V)}}).call(this)}).call(this,t("_process"),typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":77,_process:278,inherits:76}],79:[function(t,P,R){R.byteLength=a,R.toByteArray=f,R.fromByteArray=m;for(var h=[],u=[],A=typeof Uint8Array<"u"?Uint8Array:Array,T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,i=T.length;e<i;++e)h[e]=T[e],u[T.charCodeAt(e)]=e;u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63;function n(g){var p=g.length;if(p%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=g.indexOf("=");v===-1&&(v=p);var x=v===p?0:4-v%4;return[v,x]}function a(g){var p=n(g),v=p[0],x=p[1];return(v+x)*3/4-x}function r(g,p,v){return(p+v)*3/4-v}function f(g){var p,v=n(g),x=v[0],l=v[1],b=new A(r(g,x,l)),c=0,M=l>0?x-4:x,_;for(_=0;_<M;_+=4)p=u[g.charCodeAt(_)]<<18|u[g.charCodeAt(_+1)]<<12|u[g.charCodeAt(_+2)]<<6|u[g.charCodeAt(_+3)],b[c++]=p>>16&255,b[c++]=p>>8&255,b[c++]=p&255;return l===2&&(p=u[g.charCodeAt(_)]<<2|u[g.charCodeAt(_+1)]>>4,b[c++]=p&255),l===1&&(p=u[g.charCodeAt(_)]<<10|u[g.charCodeAt(_+1)]<<4|u[g.charCodeAt(_+2)]>>2,b[c++]=p>>8&255,b[c++]=p&255),b}function o(g){return h[g>>18&63]+h[g>>12&63]+h[g>>6&63]+h[g&63]}function s(g,p,v){for(var x,l=[],b=p;b<v;b+=3)x=(g[b]<<16&16711680)+(g[b+1]<<8&65280)+(g[b+2]&255),l.push(o(x));return l.join("")}function m(g){for(var p,v=g.length,x=v%3,l=[],b=16383,c=0,M=v-x;c<M;c+=b)l.push(s(g,c,c+b>M?M:c+b));return x===1?(p=g[v-1],l.push(h[p>>2]+h[p<<4&63]+"==")):x===2&&(p=(g[v-2]<<8)+g[v-1],l.push(h[p>>10]+h[p>>4&63]+h[p<<2&63]+"=")),l.join("")}},{}],80:[function(t,P,R){function h(n,a,r,f,o){for(var s=o+1;f<=o;){var m=f+o>>>1,g=n[m],p=r!==void 0?r(g,a):g-a;p>=0?(s=m,o=m-1):f=m+1}return s}function u(n,a,r,f,o){for(var s=o+1;f<=o;){var m=f+o>>>1,g=n[m],p=r!==void 0?r(g,a):g-a;p>0?(s=m,o=m-1):f=m+1}return s}function A(n,a,r,f,o){for(var s=f-1;f<=o;){var m=f+o>>>1,g=n[m],p=r!==void 0?r(g,a):g-a;p<0?(s=m,f=m+1):o=m-1}return s}function T(n,a,r,f,o){for(var s=f-1;f<=o;){var m=f+o>>>1,g=n[m],p=r!==void 0?r(g,a):g-a;p<=0?(s=m,f=m+1):o=m-1}return s}function e(n,a,r,f,o){for(;f<=o;){var s=f+o>>>1,m=n[s],g=r!==void 0?r(m,a):m-a;if(g===0)return s;g<=0?f=s+1:o=s-1}return-1}function i(n,a,r,f,o,s){return typeof r=="function"?s(n,a,r,f===void 0?0:f|0,o===void 0?n.length-1:o|0):s(n,a,void 0,r===void 0?0:r|0,f===void 0?n.length-1:f|0)}P.exports={ge:function(n,a,r,f,o){return i(n,a,r,f,o,h)},gt:function(n,a,r,f,o){return i(n,a,r,f,o,u)},lt:function(n,a,r,f,o){return i(n,a,r,f,o,A)},le:function(n,a,r,f,o){return i(n,a,r,f,o,T)},eq:function(n,a,r,f,o){return i(n,a,r,f,o,e)}}},{}],81:[function(t,P,R){var h=32;R.INT_BITS=h,R.INT_MAX=2147483647,R.INT_MIN=-1<<h-1,R.sign=function(T){return(T>0)-(T<0)},R.abs=function(T){var e=T>>h-1;return(T^e)-e},R.min=function(T,e){return e^(T^e)&-(T<e)},R.max=function(T,e){return T^(T^e)&-(T<e)},R.isPow2=function(T){return!(T&T-1)&&!!T},R.log2=function(T){var e,i;return e=(T>65535)<<4,T>>>=e,i=(T>255)<<3,T>>>=i,e|=i,i=(T>15)<<2,T>>>=i,e|=i,i=(T>3)<<1,T>>>=i,e|=i,e|T>>1},R.log10=function(T){return T>=1e9?9:T>=1e8?8:T>=1e7?7:T>=1e6?6:T>=1e5?5:T>=1e4?4:T>=1e3?3:T>=100?2:T>=10?1:0},R.popCount=function(T){return T=T-(T>>>1&1431655765),T=(T&858993459)+(T>>>2&858993459),(T+(T>>>4)&252645135)*16843009>>>24};function u(T){var e=32;return T&=-T,T&&e--,T&65535&&(e-=16),T&16711935&&(e-=8),T&252645135&&(e-=4),T&858993459&&(e-=2),T&1431655765&&(e-=1),e}R.countTrailingZeros=u,R.nextPow2=function(T){return T+=T===0,--T,T|=T>>>1,T|=T>>>2,T|=T>>>4,T|=T>>>8,T|=T>>>16,T+1},R.prevPow2=function(T){return T|=T>>>1,T|=T>>>2,T|=T>>>4,T|=T>>>8,T|=T>>>16,T-(T>>>1)},R.parity=function(T){return T^=T>>>16,T^=T>>>8,T^=T>>>4,T&=15,27030>>>T&1};var A=new Array(256);(function(T){for(var e=0;e<256;++e){var i=e,n=e,a=7;for(i>>>=1;i;i>>>=1)n<<=1,n|=i&1,--a;T[e]=n<<a&255}})(A),R.reverse=function(T){return A[T&255]<<24|A[T>>>8&255]<<16|A[T>>>16&255]<<8|A[T>>>24&255]},R.interleave2=function(T,e){return T&=65535,T=(T|T<<8)&16711935,T=(T|T<<4)&252645135,T=(T|T<<2)&858993459,T=(T|T<<1)&1431655765,e&=65535,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,T|e<<1},R.deinterleave2=function(T,e){return T=T>>>e&1431655765,T=(T|T>>>1)&858993459,T=(T|T>>>2)&252645135,T=(T|T>>>4)&16711935,T=(T|T>>>16)&65535,T<<16>>16},R.interleave3=function(T,e,i){return T&=1023,T=(T|T<<16)&4278190335,T=(T|T<<8)&251719695,T=(T|T<<4)&3272356035,T=(T|T<<2)&1227133513,e&=1023,e=(e|e<<16)&4278190335,e=(e|e<<8)&251719695,e=(e|e<<4)&3272356035,e=(e|e<<2)&1227133513,T|=e<<1,i&=1023,i=(i|i<<16)&4278190335,i=(i|i<<8)&251719695,i=(i|i<<4)&3272356035,i=(i|i<<2)&1227133513,T|i<<2},R.deinterleave3=function(T,e){return T=T>>>e&1227133513,T=(T|T>>>2)&3272356035,T=(T|T>>>4)&251719695,T=(T|T>>>8)&4278190335,T=(T|T>>>16)&1023,T<<22>>22},R.nextCombination=function(T){var e=T|T-1;return e+1|(~e&-~e)-1>>>u(T)+1}},{}],82:[function(t,P,R){var h=t("clamp");P.exports=A;var u=1e20;function A(i,n){n||(n={});var a=n.cutoff==null?.25:n.cutoff,r=n.radius==null?8:n.radius,f=n.channel||0,o,s,m,g,p,v,x,l,b,c,M;if(ArrayBuffer.isView(i)||Array.isArray(i)){if(!n.width||!n.height)throw Error("For raw data width and height should be provided by options");o=n.width,s=n.height,g=i,n.stride?v=n.stride:v=Math.floor(i.length/o/s)}else window.HTMLCanvasElement&&i instanceof window.HTMLCanvasElement?(l=i,x=l.getContext("2d"),o=l.width,s=l.height,b=x.getImageData(0,0,o,s),g=b.data,v=4):window.CanvasRenderingContext2D&&i instanceof window.CanvasRenderingContext2D?(l=i.canvas,x=i,o=l.width,s=l.height,b=x.getImageData(0,0,o,s),g=b.data,v=4):window.ImageData&&i instanceof window.ImageData&&(b=i,o=i.width,s=i.height,g=b.data,v=4);if(m=Math.max(o,s),window.Uint8ClampedArray&&g instanceof window.Uint8ClampedArray||window.Uint8Array&&g instanceof window.Uint8Array)for(p=g,g=Array(o*s),c=0,M=p.length;c<M;c++)g[c]=p[c*v+f]/255;else if(v!==1)throw Error("Raw data can have only 1 value per pixel");var _=Array(o*s),y=Array(o*s),w=Array(m),d=Array(m),C=Array(m+1),S=Array(m);for(c=0,M=o*s;c<M;c++){var E=g[c];_[c]=E===1?0:E===0?u:Math.pow(Math.max(0,.5-E),2),y[c]=E===1?u:E===0?0:Math.pow(Math.max(0,E-.5),2)}T(_,o,s,w,d,S,C),T(y,o,s,w,d,S,C);var k=window.Float32Array?new Float32Array(o*s):new Array(o*s);for(c=0,M=o*s;c<M;c++)k[c]=h(1-((_[c]-y[c])/r+a),0,1);return k}function T(i,n,a,r,f,o,s){for(var m=0;m<n;m++){for(var g=0;g<a;g++)r[g]=i[g*n+m];for(e(r,f,o,s,a),g=0;g<a;g++)i[g*n+m]=f[g]}for(g=0;g<a;g++){for(m=0;m<n;m++)r[m]=i[g*n+m];for(e(r,f,o,s,n),m=0;m<n;m++)i[g*n+m]=Math.sqrt(f[m])}}function e(i,n,a,r,f){a[0]=0,r[0]=-u,r[1]=+u;for(var o=1,s=0;o<f;o++){for(var m=(i[o]+o*o-(i[a[s]]+a[s]*a[s]))/(2*o-2*a[s]);m<=r[s];)s--,m=(i[o]+o*o-(i[a[s]]+a[s]*a[s]))/(2*o-2*a[s]);s++,a[s]=o,r[s]=m,r[s+1]=+u}for(o=0,s=0;o<f;o++){for(;r[s+1]<o;)s++;n[o]=(o-a[s])*(o-a[s])+i[a[s]]}}},{clamp:86}],83:[function(t,P,R){},{}],84:[function(t,P,R){var h=typeof Reflect=="object"?Reflect:null,u=h&&typeof h.apply=="function"?h.apply:function(c,M,_){return Function.prototype.apply.call(c,M,_)},A;h&&typeof h.ownKeys=="function"?A=h.ownKeys:Object.getOwnPropertySymbols?A=function(c){return Object.getOwnPropertyNames(c).concat(Object.getOwnPropertySymbols(c))}:A=function(c){return Object.getOwnPropertyNames(c)};function T(b){console&&console.warn&&console.warn(b)}var e=Number.isNaN||function(c){return c!==c};function i(){i.init.call(this)}P.exports=i,P.exports.once=l,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var n=10;function a(b){if(typeof b!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof b)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return n},set:function(b){if(typeof b!="number"||b<0||e(b))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+b+".");n=b}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(c){if(typeof c!="number"||c<0||e(c))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+c+".");return this._maxListeners=c,this};function r(b){return b._maxListeners===void 0?i.defaultMaxListeners:b._maxListeners}i.prototype.getMaxListeners=function(){return r(this)},i.prototype.emit=function(c){for(var M=[],_=1;_<arguments.length;_++)M.push(arguments[_]);var y=c==="error",w=this._events;if(w!==void 0)y=y&&w.error===void 0;else if(!y)return!1;if(y){var d;if(M.length>0&&(d=M[0]),d instanceof Error)throw d;var C=new Error("Unhandled error."+(d?" ("+d.message+")":""));throw C.context=d,C}var S=w[c];if(S===void 0)return!1;if(typeof S=="function")u(S,this,M);else for(var E=S.length,k=p(S,E),_=0;_<E;++_)u(k[_],this,M);return!0};function f(b,c,M,_){var y,w,d;if(a(M),w=b._events,w===void 0?(w=b._events=Object.create(null),b._eventsCount=0):(w.newListener!==void 0&&(b.emit("newListener",c,M.listener?M.listener:M),w=b._events),d=w[c]),d===void 0)d=w[c]=M,++b._eventsCount;else if(typeof d=="function"?d=w[c]=_?[M,d]:[d,M]:_?d.unshift(M):d.push(M),y=r(b),y>0&&d.length>y&&!d.warned){d.warned=!0;var C=new Error("Possible EventEmitter memory leak detected. "+d.length+" "+String(c)+" listeners added. Use emitter.setMaxListeners() to increase limit");C.name="MaxListenersExceededWarning",C.emitter=b,C.type=c,C.count=d.length,T(C)}return b}i.prototype.addListener=function(c,M){return f(this,c,M,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(c,M){return f(this,c,M,!0)};function o(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function s(b,c,M){var _={fired:!1,wrapFn:void 0,target:b,type:c,listener:M},y=o.bind(_);return y.listener=M,_.wrapFn=y,y}i.prototype.once=function(c,M){return a(M),this.on(c,s(this,c,M)),this},i.prototype.prependOnceListener=function(c,M){return a(M),this.prependListener(c,s(this,c,M)),this},i.prototype.removeListener=function(c,M){var _,y,w,d,C;if(a(M),y=this._events,y===void 0)return this;if(_=y[c],_===void 0)return this;if(_===M||_.listener===M)--this._eventsCount===0?this._events=Object.create(null):(delete y[c],y.removeListener&&this.emit("removeListener",c,_.listener||M));else if(typeof _!="function"){for(w=-1,d=_.length-1;d>=0;d--)if(_[d]===M||_[d].listener===M){C=_[d].listener,w=d;break}if(w<0)return this;w===0?_.shift():v(_,w),_.length===1&&(y[c]=_[0]),y.removeListener!==void 0&&this.emit("removeListener",c,C||M)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(c){var M,_,y;if(_=this._events,_===void 0)return this;if(_.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):_[c]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete _[c]),this;if(arguments.length===0){var w=Object.keys(_),d;for(y=0;y<w.length;++y)d=w[y],d!=="removeListener"&&this.removeAllListeners(d);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(M=_[c],typeof M=="function")this.removeListener(c,M);else if(M!==void 0)for(y=M.length-1;y>=0;y--)this.removeListener(c,M[y]);return this};function m(b,c,M){var _=b._events;if(_===void 0)return[];var y=_[c];return y===void 0?[]:typeof y=="function"?M?[y.listener||y]:[y]:M?x(y):p(y,y.length)}i.prototype.listeners=function(c){return m(this,c,!0)},i.prototype.rawListeners=function(c){return m(this,c,!1)},i.listenerCount=function(b,c){return typeof b.listenerCount=="function"?b.listenerCount(c):g.call(b,c)},i.prototype.listenerCount=g;function g(b){var c=this._events;if(c!==void 0){var M=c[b];if(typeof M=="function")return 1;if(M!==void 0)return M.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?A(this._events):[]};function p(b,c){for(var M=new Array(c),_=0;_<c;++_)M[_]=b[_];return M}function v(b,c){for(;c+1<b.length;c++)b[c]=b[c+1];b.pop()}function x(b){for(var c=new Array(b.length),M=0;M<c.length;++M)c[M]=b[M].listener||b[M];return c}function l(b,c){return new Promise(function(M,_){function y(){w!==void 0&&b.removeListener("error",w),M([].slice.call(arguments))}var w;c!=="error"&&(w=function(C){b.removeListener(c,y),_(C)},b.once("error",w)),b.once(c,y)})}},{}],85:[function(t,P,R){(function(h){(function(){var u=t("base64-js"),A=t("ieee754");R.Buffer=n,R.SlowBuffer=x,R.INSPECT_MAX_BYTES=50;var T=2147483647;R.kMaxLength=T,n.TYPED_ARRAY_SUPPORT=e(),!n.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function e(){try{var le=new Uint8Array(1);return le.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},le.foo()===42}catch{return!1}}Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(!!n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(!!n.isBuffer(this))return this.byteOffset}});function i(le){if(le>T)throw new RangeError('The value "'+le+'" is invalid for option "size"');var ie=new Uint8Array(le);return ie.__proto__=n.prototype,ie}function n(le,ie,se){if(typeof le=="number"){if(typeof ie=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return o(le)}return a(le,ie,se)}typeof Symbol<"u"&&Symbol.species!=null&&n[Symbol.species]===n&&Object.defineProperty(n,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),n.poolSize=8192;function a(le,ie,se){if(typeof le=="string")return s(le,ie);if(ArrayBuffer.isView(le))return m(le);if(le==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof le);if(q(le,ArrayBuffer)||le&&q(le.buffer,ArrayBuffer))return g(le,ie,se);if(typeof le=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var xe=le.valueOf&&le.valueOf();if(xe!=null&&xe!==le)return n.from(xe,ie,se);var oe=p(le);if(oe)return oe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof le[Symbol.toPrimitive]=="function")return n.from(le[Symbol.toPrimitive]("string"),ie,se);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof le)}n.from=function(le,ie,se){return a(le,ie,se)},n.prototype.__proto__=Uint8Array.prototype,n.__proto__=Uint8Array;function r(le){if(typeof le!="number")throw new TypeError('"size" argument must be of type number');if(le<0)throw new RangeError('The value "'+le+'" is invalid for option "size"')}function f(le,ie,se){return r(le),le<=0?i(le):ie!==void 0?typeof se=="string"?i(le).fill(ie,se):i(le).fill(ie):i(le)}n.alloc=function(le,ie,se){return f(le,ie,se)};function o(le){return r(le),i(le<0?0:v(le)|0)}n.allocUnsafe=function(le){return o(le)},n.allocUnsafeSlow=function(le){return o(le)};function s(le,ie){if((typeof ie!="string"||ie==="")&&(ie="utf8"),!n.isEncoding(ie))throw new TypeError("Unknown encoding: "+ie);var se=l(le,ie)|0,xe=i(se),oe=xe.write(le,ie);return oe!==se&&(xe=xe.slice(0,oe)),xe}function m(le){for(var ie=le.length<0?0:v(le.length)|0,se=i(ie),xe=0;xe<ie;xe+=1)se[xe]=le[xe]&255;return se}function g(le,ie,se){if(ie<0||le.byteLength<ie)throw new RangeError('"offset" is outside of buffer bounds');if(le.byteLength<ie+(se||0))throw new RangeError('"length" is outside of buffer bounds');var xe;return ie===void 0&&se===void 0?xe=new Uint8Array(le):se===void 0?xe=new Uint8Array(le,ie):xe=new Uint8Array(le,ie,se),xe.__proto__=n.prototype,xe}function p(le){if(n.isBuffer(le)){var ie=v(le.length)|0,se=i(ie);return se.length===0||le.copy(se,0,0,ie),se}if(le.length!==void 0)return typeof le.length!="number"||ae(le.length)?i(0):m(le);if(le.type==="Buffer"&&Array.isArray(le.data))return m(le.data)}function v(le){if(le>=T)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+T.toString(16)+" bytes");return le|0}function x(le){return+le!=le&&(le=0),n.alloc(+le)}n.isBuffer=function(ie){return ie!=null&&ie._isBuffer===!0&&ie!==n.prototype},n.compare=function(ie,se){if(q(ie,Uint8Array)&&(ie=n.from(ie,ie.offset,ie.byteLength)),q(se,Uint8Array)&&(se=n.from(se,se.offset,se.byteLength)),!n.isBuffer(ie)||!n.isBuffer(se))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ie===se)return 0;for(var xe=ie.length,oe=se.length,he=0,be=Math.min(xe,oe);he<be;++he)if(ie[he]!==se[he]){xe=ie[he],oe=se[he];break}return xe<oe?-1:oe<xe?1:0},n.isEncoding=function(ie){switch(String(ie).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(ie,se){if(!Array.isArray(ie))throw new TypeError('"list" argument must be an Array of Buffers');if(ie.length===0)return n.alloc(0);var xe;if(se===void 0)for(se=0,xe=0;xe<ie.length;++xe)se+=ie[xe].length;var oe=n.allocUnsafe(se),he=0;for(xe=0;xe<ie.length;++xe){var be=ie[xe];if(q(be,Uint8Array)&&(be=n.from(be)),!n.isBuffer(be))throw new TypeError('"list" argument must be an Array of Buffers');be.copy(oe,he),he+=be.length}return oe};function l(le,ie){if(n.isBuffer(le))return le.length;if(ArrayBuffer.isView(le)||q(le,ArrayBuffer))return le.byteLength;if(typeof le!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof le);var se=le.length,xe=arguments.length>2&&arguments[2]===!0;if(!xe&&se===0)return 0;for(var oe=!1;;)switch(ie){case"ascii":case"latin1":case"binary":return se;case"utf8":case"utf-8":return G(le).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se*2;case"hex":return se>>>1;case"base64":return ne(le).length;default:if(oe)return xe?-1:G(le).length;ie=(""+ie).toLowerCase(),oe=!0}}n.byteLength=l;function b(le,ie,se){var xe=!1;if((ie===void 0||ie<0)&&(ie=0),ie>this.length||((se===void 0||se>this.length)&&(se=this.length),se<=0)||(se>>>=0,ie>>>=0,se<=ie))return"";for(le||(le="utf8");;)switch(le){case"hex":return N(this,ie,se);case"utf8":case"utf-8":return B(this,ie,se);case"ascii":return I(this,ie,se);case"latin1":case"binary":return O(this,ie,se);case"base64":return k(this,ie,se);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V(this,ie,se);default:if(xe)throw new TypeError("Unknown encoding: "+le);le=(le+"").toLowerCase(),xe=!0}}n.prototype._isBuffer=!0;function c(le,ie,se){var xe=le[ie];le[ie]=le[se],le[se]=xe}n.prototype.swap16=function(){var ie=this.length;if(ie%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var se=0;se<ie;se+=2)c(this,se,se+1);return this},n.prototype.swap32=function(){var ie=this.length;if(ie%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var se=0;se<ie;se+=4)c(this,se,se+3),c(this,se+1,se+2);return this},n.prototype.swap64=function(){var ie=this.length;if(ie%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var se=0;se<ie;se+=8)c(this,se,se+7),c(this,se+1,se+6),c(this,se+2,se+5),c(this,se+3,se+4);return this},n.prototype.toString=function(){var ie=this.length;return ie===0?"":arguments.length===0?B(this,0,ie):b.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(ie){if(!n.isBuffer(ie))throw new TypeError("Argument must be a Buffer");return this===ie?!0:n.compare(this,ie)===0},n.prototype.inspect=function(){var ie="",se=R.INSPECT_MAX_BYTES;return ie=this.toString("hex",0,se).replace(/(.{2})/g,"$1 ").trim(),this.length>se&&(ie+=" ... "),"<Buffer "+ie+">"},n.prototype.compare=function(ie,se,xe,oe,he){if(q(ie,Uint8Array)&&(ie=n.from(ie,ie.offset,ie.byteLength)),!n.isBuffer(ie))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ie);if(se===void 0&&(se=0),xe===void 0&&(xe=ie?ie.length:0),oe===void 0&&(oe=0),he===void 0&&(he=this.length),se<0||xe>ie.length||oe<0||he>this.length)throw new RangeError("out of range index");if(oe>=he&&se>=xe)return 0;if(oe>=he)return-1;if(se>=xe)return 1;if(se>>>=0,xe>>>=0,oe>>>=0,he>>>=0,this===ie)return 0;for(var be=he-oe,me=xe-se,_e=Math.min(be,me),Se=this.slice(oe,he),De=ie.slice(se,xe),Ie=0;Ie<_e;++Ie)if(Se[Ie]!==De[Ie]){be=Se[Ie],me=De[Ie];break}return be<me?-1:me<be?1:0};function M(le,ie,se,xe,oe){if(le.length===0)return-1;if(typeof se=="string"?(xe=se,se=0):se>2147483647?se=2147483647:se<-2147483648&&(se=-2147483648),se=+se,ae(se)&&(se=oe?0:le.length-1),se<0&&(se=le.length+se),se>=le.length){if(oe)return-1;se=le.length-1}else if(se<0)if(oe)se=0;else return-1;if(typeof ie=="string"&&(ie=n.from(ie,xe)),n.isBuffer(ie))return ie.length===0?-1:_(le,ie,se,xe,oe);if(typeof ie=="number")return ie=ie&255,typeof Uint8Array.prototype.indexOf=="function"?oe?Uint8Array.prototype.indexOf.call(le,ie,se):Uint8Array.prototype.lastIndexOf.call(le,ie,se):_(le,[ie],se,xe,oe);throw new TypeError("val must be string, number or Buffer")}function _(le,ie,se,xe,oe){var he=1,be=le.length,me=ie.length;if(xe!==void 0&&(xe=String(xe).toLowerCase(),xe==="ucs2"||xe==="ucs-2"||xe==="utf16le"||xe==="utf-16le")){if(le.length<2||ie.length<2)return-1;he=2,be/=2,me/=2,se/=2}function _e(Ce,He){return he===1?Ce[He]:Ce.readUInt16BE(He*he)}var Se;if(oe){var De=-1;for(Se=se;Se<be;Se++)if(_e(le,Se)===_e(ie,De===-1?0:Se-De)){if(De===-1&&(De=Se),Se-De+1===me)return De*he}else De!==-1&&(Se-=Se-De),De=-1}else for(se+me>be&&(se=be-me),Se=se;Se>=0;Se--){for(var Ie=!0,Te=0;Te<me;Te++)if(_e(le,Se+Te)!==_e(ie,Te)){Ie=!1;break}if(Ie)return Se}return-1}n.prototype.includes=function(ie,se,xe){return this.indexOf(ie,se,xe)!==-1},n.prototype.indexOf=function(ie,se,xe){return M(this,ie,se,xe,!0)},n.prototype.lastIndexOf=function(ie,se,xe){return M(this,ie,se,xe,!1)};function y(le,ie,se,xe){se=Number(se)||0;var oe=le.length-se;xe?(xe=Number(xe),xe>oe&&(xe=oe)):xe=oe;var he=ie.length;xe>he/2&&(xe=he/2);for(var be=0;be<xe;++be){var me=parseInt(ie.substr(be*2,2),16);if(ae(me))return be;le[se+be]=me}return be}function w(le,ie,se,xe){return J(G(ie,le.length-se),le,se,xe)}function d(le,ie,se,xe){return J(Y(ie),le,se,xe)}function C(le,ie,se,xe){return d(le,ie,se,xe)}function S(le,ie,se,xe){return J(ne(ie),le,se,xe)}function E(le,ie,se,xe){return J(ee(ie,le.length-se),le,se,xe)}n.prototype.write=function(ie,se,xe,oe){if(se===void 0)oe="utf8",xe=this.length,se=0;else if(xe===void 0&&typeof se=="string")oe=se,xe=this.length,se=0;else if(isFinite(se))se=se>>>0,isFinite(xe)?(xe=xe>>>0,oe===void 0&&(oe="utf8")):(oe=xe,xe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var he=this.length-se;if((xe===void 0||xe>he)&&(xe=he),ie.length>0&&(xe<0||se<0)||se>this.length)throw new RangeError("Attempt to write outside buffer bounds");oe||(oe="utf8");for(var be=!1;;)switch(oe){case"hex":return y(this,ie,se,xe);case"utf8":case"utf-8":return w(this,ie,se,xe);case"ascii":return d(this,ie,se,xe);case"latin1":case"binary":return C(this,ie,se,xe);case"base64":return S(this,ie,se,xe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,ie,se,xe);default:if(be)throw new TypeError("Unknown encoding: "+oe);oe=(""+oe).toLowerCase(),be=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function k(le,ie,se){return ie===0&&se===le.length?u.fromByteArray(le):u.fromByteArray(le.slice(ie,se))}function B(le,ie,se){se=Math.min(le.length,se);for(var xe=[],oe=ie;oe<se;){var he=le[oe],be=null,me=he>239?4:he>223?3:he>191?2:1;if(oe+me<=se){var _e,Se,De,Ie;switch(me){case 1:he<128&&(be=he);break;case 2:_e=le[oe+1],(_e&192)===128&&(Ie=(he&31)<<6|_e&63,Ie>127&&(be=Ie));break;case 3:_e=le[oe+1],Se=le[oe+2],(_e&192)===128&&(Se&192)===128&&(Ie=(he&15)<<12|(_e&63)<<6|Se&63,Ie>2047&&(Ie<55296||Ie>57343)&&(be=Ie));break;case 4:_e=le[oe+1],Se=le[oe+2],De=le[oe+3],(_e&192)===128&&(Se&192)===128&&(De&192)===128&&(Ie=(he&15)<<18|(_e&63)<<12|(Se&63)<<6|De&63,Ie>65535&&Ie<1114112&&(be=Ie))}}be===null?(be=65533,me=1):be>65535&&(be-=65536,xe.push(be>>>10&1023|55296),be=56320|be&1023),xe.push(be),oe+=me}return F(xe)}var z=4096;function F(le){var ie=le.length;if(ie<=z)return String.fromCharCode.apply(String,le);for(var se="",xe=0;xe<ie;)se+=String.fromCharCode.apply(String,le.slice(xe,xe+=z));return se}function I(le,ie,se){var xe="";se=Math.min(le.length,se);for(var oe=ie;oe<se;++oe)xe+=String.fromCharCode(le[oe]&127);return xe}function O(le,ie,se){var xe="";se=Math.min(le.length,se);for(var oe=ie;oe<se;++oe)xe+=String.fromCharCode(le[oe]);return xe}function N(le,ie,se){var xe=le.length;(!ie||ie<0)&&(ie=0),(!se||se<0||se>xe)&&(se=xe);for(var oe="",he=ie;he<se;++he)oe+=te(le[he]);return oe}function V(le,ie,se){for(var xe=le.slice(ie,se),oe="",he=0;he<xe.length;he+=2)oe+=String.fromCharCode(xe[he]+xe[he+1]*256);return oe}n.prototype.slice=function(ie,se){var xe=this.length;ie=~~ie,se=se===void 0?xe:~~se,ie<0?(ie+=xe,ie<0&&(ie=0)):ie>xe&&(ie=xe),se<0?(se+=xe,se<0&&(se=0)):se>xe&&(se=xe),se<ie&&(se=ie);var oe=this.subarray(ie,se);return oe.__proto__=n.prototype,oe};function H(le,ie,se){if(le%1!==0||le<0)throw new RangeError("offset is not uint");if(le+ie>se)throw new RangeError("Trying to access beyond buffer length")}n.prototype.readUIntLE=function(ie,se,xe){ie=ie>>>0,se=se>>>0,xe||H(ie,se,this.length);for(var oe=this[ie],he=1,be=0;++be<se&&(he*=256);)oe+=this[ie+be]*he;return oe},n.prototype.readUIntBE=function(ie,se,xe){ie=ie>>>0,se=se>>>0,xe||H(ie,se,this.length);for(var oe=this[ie+--se],he=1;se>0&&(he*=256);)oe+=this[ie+--se]*he;return oe},n.prototype.readUInt8=function(ie,se){return ie=ie>>>0,se||H(ie,1,this.length),this[ie]},n.prototype.readUInt16LE=function(ie,se){return ie=ie>>>0,se||H(ie,2,this.length),this[ie]|this[ie+1]<<8},n.prototype.readUInt16BE=function(ie,se){return ie=ie>>>0,se||H(ie,2,this.length),this[ie]<<8|this[ie+1]},n.prototype.readUInt32LE=function(ie,se){return ie=ie>>>0,se||H(ie,4,this.length),(this[ie]|this[ie+1]<<8|this[ie+2]<<16)+this[ie+3]*16777216},n.prototype.readUInt32BE=function(ie,se){return ie=ie>>>0,se||H(ie,4,this.length),this[ie]*16777216+(this[ie+1]<<16|this[ie+2]<<8|this[ie+3])},n.prototype.readIntLE=function(ie,se,xe){ie=ie>>>0,se=se>>>0,xe||H(ie,se,this.length);for(var oe=this[ie],he=1,be=0;++be<se&&(he*=256);)oe+=this[ie+be]*he;return he*=128,oe>=he&&(oe-=Math.pow(2,8*se)),oe},n.prototype.readIntBE=function(ie,se,xe){ie=ie>>>0,se=se>>>0,xe||H(ie,se,this.length);for(var oe=se,he=1,be=this[ie+--oe];oe>0&&(he*=256);)be+=this[ie+--oe]*he;return he*=128,be>=he&&(be-=Math.pow(2,8*se)),be},n.prototype.readInt8=function(ie,se){return ie=ie>>>0,se||H(ie,1,this.length),this[ie]&128?(255-this[ie]+1)*-1:this[ie]},n.prototype.readInt16LE=function(ie,se){ie=ie>>>0,se||H(ie,2,this.length);var xe=this[ie]|this[ie+1]<<8;return xe&32768?xe|4294901760:xe},n.prototype.readInt16BE=function(ie,se){ie=ie>>>0,se||H(ie,2,this.length);var xe=this[ie+1]|this[ie]<<8;return xe&32768?xe|4294901760:xe},n.prototype.readInt32LE=function(ie,se){return ie=ie>>>0,se||H(ie,4,this.length),this[ie]|this[ie+1]<<8|this[ie+2]<<16|this[ie+3]<<24},n.prototype.readInt32BE=function(ie,se){return ie=ie>>>0,se||H(ie,4,this.length),this[ie]<<24|this[ie+1]<<16|this[ie+2]<<8|this[ie+3]},n.prototype.readFloatLE=function(ie,se){return ie=ie>>>0,se||H(ie,4,this.length),A.read(this,ie,!0,23,4)},n.prototype.readFloatBE=function(ie,se){return ie=ie>>>0,se||H(ie,4,this.length),A.read(this,ie,!1,23,4)},n.prototype.readDoubleLE=function(ie,se){return ie=ie>>>0,se||H(ie,8,this.length),A.read(this,ie,!0,52,8)},n.prototype.readDoubleBE=function(ie,se){return ie=ie>>>0,se||H(ie,8,this.length),A.read(this,ie,!1,52,8)};function j(le,ie,se,xe,oe,he){if(!n.isBuffer(le))throw new TypeError('"buffer" argument must be a Buffer instance');if(ie>oe||ie<he)throw new RangeError('"value" argument is out of bounds');if(se+xe>le.length)throw new RangeError("Index out of range")}n.prototype.writeUIntLE=function(ie,se,xe,oe){if(ie=+ie,se=se>>>0,xe=xe>>>0,!oe){var he=Math.pow(2,8*xe)-1;j(this,ie,se,xe,he,0)}var be=1,me=0;for(this[se]=ie&255;++me<xe&&(be*=256);)this[se+me]=ie/be&255;return se+xe},n.prototype.writeUIntBE=function(ie,se,xe,oe){if(ie=+ie,se=se>>>0,xe=xe>>>0,!oe){var he=Math.pow(2,8*xe)-1;j(this,ie,se,xe,he,0)}var be=xe-1,me=1;for(this[se+be]=ie&255;--be>=0&&(me*=256);)this[se+be]=ie/me&255;return se+xe},n.prototype.writeUInt8=function(ie,se,xe){return ie=+ie,se=se>>>0,xe||j(this,ie,se,1,255,0),this[se]=ie&255,se+1},n.prototype.writeUInt16LE=function(ie,se,xe){return ie=+ie,se=se>>>0,xe||j(this,ie,se,2,65535,0),this[se]=ie&255,this[se+1]=ie>>>8,se+2},n.prototype.writeUInt16BE=function(ie,se,xe){return ie=+ie,se=se>>>0,xe||j(this,ie,se,2,65535,0),this[se]=ie>>>8,this[se+1]=ie&255,se+2},n.prototype.writeUInt32LE=function(ie,se,xe){return ie=+ie,se=se>>>0,xe||j(this,ie,se,4,4294967295,0),this[se+3]=ie>>>24,this[se+2]=ie>>>16,this[se+1]=ie>>>8,this[se]=ie&255,se+4},n.prototype.writeUInt32BE=function(ie,se,xe){return ie=+ie,se=se>>>0,xe||j(this,ie,se,4,4294967295,0),this[se]=ie>>>24,this[se+1]=ie>>>16,this[se+2]=ie>>>8,this[se+3]=ie&255,se+4},n.prototype.writeIntLE=function(ie,se,xe,oe){if(ie=+ie,se=se>>>0,!oe){var he=Math.pow(2,8*xe-1);j(this,ie,se,xe,he-1,-he)}var be=0,me=1,_e=0;for(this[se]=ie&255;++be<xe&&(me*=256);)ie<0&&_e===0&&this[se+be-1]!==0&&(_e=1),this[se+be]=(ie/me>>0)-_e&255;return se+xe},n.prototype.writeIntBE=function(ie,se,xe,oe){if(ie=+ie,se=se>>>0,!oe){var he=Math.pow(2,8*xe-1);j(this,ie,se,xe,he-1,-he)}var be=xe-1,me=1,_e=0;for(this[se+be]=ie&255;--be>=0&&(me*=256);)ie<0&&_e===0&&this[se+be+1]!==0&&(_e=1),this[se+be]=(ie/me>>0)-_e&255;return se+xe},n.prototype.writeInt8=function(ie,se,xe){return ie=+ie,se=se>>>0,xe||j(this,ie,se,1,127,-128),ie<0&&(ie=255+ie+1),this[se]=ie&255,se+1},n.prototype.writeInt16LE=function(ie,se,xe){return ie=+ie,se=se>>>0,xe||j(this,ie,se,2,32767,-32768),this[se]=ie&255,this[se+1]=ie>>>8,se+2},n.prototype.writeInt16BE=function(ie,se,xe){return ie=+ie,se=se>>>0,xe||j(this,ie,se,2,32767,-32768),this[se]=ie>>>8,this[se+1]=ie&255,se+2},n.prototype.writeInt32LE=function(ie,se,xe){return ie=+ie,se=se>>>0,xe||j(this,ie,se,4,2147483647,-2147483648),this[se]=ie&255,this[se+1]=ie>>>8,this[se+2]=ie>>>16,this[se+3]=ie>>>24,se+4},n.prototype.writeInt32BE=function(ie,se,xe){return ie=+ie,se=se>>>0,xe||j(this,ie,se,4,2147483647,-2147483648),ie<0&&(ie=4294967295+ie+1),this[se]=ie>>>24,this[se+1]=ie>>>16,this[se+2]=ie>>>8,this[se+3]=ie&255,se+4};function Z(le,ie,se,xe,oe,he){if(se+xe>le.length)throw new RangeError("Index out of range");if(se<0)throw new RangeError("Index out of range")}function X(le,ie,se,xe,oe){return ie=+ie,se=se>>>0,oe||Z(le,ie,se,4),A.write(le,ie,se,xe,23,4),se+4}n.prototype.writeFloatLE=function(ie,se,xe){return X(this,ie,se,!0,xe)},n.prototype.writeFloatBE=function(ie,se,xe){return X(this,ie,se,!1,xe)};function re(le,ie,se,xe,oe){return ie=+ie,se=se>>>0,oe||Z(le,ie,se,8),A.write(le,ie,se,xe,52,8),se+8}n.prototype.writeDoubleLE=function(ie,se,xe){return re(this,ie,se,!0,xe)},n.prototype.writeDoubleBE=function(ie,se,xe){return re(this,ie,se,!1,xe)},n.prototype.copy=function(ie,se,xe,oe){if(!n.isBuffer(ie))throw new TypeError("argument should be a Buffer");if(xe||(xe=0),!oe&&oe!==0&&(oe=this.length),se>=ie.length&&(se=ie.length),se||(se=0),oe>0&&oe<xe&&(oe=xe),oe===xe||ie.length===0||this.length===0)return 0;if(se<0)throw new RangeError("targetStart out of bounds");if(xe<0||xe>=this.length)throw new RangeError("Index out of range");if(oe<0)throw new RangeError("sourceEnd out of bounds");oe>this.length&&(oe=this.length),ie.length-se<oe-xe&&(oe=ie.length-se+xe);var he=oe-xe;if(this===ie&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(se,xe,oe);else if(this===ie&&xe<se&&se<oe)for(var be=he-1;be>=0;--be)ie[be+se]=this[be+xe];else Uint8Array.prototype.set.call(ie,this.subarray(xe,oe),se);return he},n.prototype.fill=function(ie,se,xe,oe){if(typeof ie=="string"){if(typeof se=="string"?(oe=se,se=0,xe=this.length):typeof xe=="string"&&(oe=xe,xe=this.length),oe!==void 0&&typeof oe!="string")throw new TypeError("encoding must be a string");if(typeof oe=="string"&&!n.isEncoding(oe))throw new TypeError("Unknown encoding: "+oe);if(ie.length===1){var he=ie.charCodeAt(0);(oe==="utf8"&&he<128||oe==="latin1")&&(ie=he)}}else typeof ie=="number"&&(ie=ie&255);if(se<0||this.length<se||this.length<xe)throw new RangeError("Out of range index");if(xe<=se)return this;se=se>>>0,xe=xe===void 0?this.length:xe>>>0,ie||(ie=0);var be;if(typeof ie=="number")for(be=se;be<xe;++be)this[be]=ie;else{var me=n.isBuffer(ie)?ie:n.from(ie,oe),_e=me.length;if(_e===0)throw new TypeError('The value "'+ie+'" is invalid for argument "value"');for(be=0;be<xe-se;++be)this[be+se]=me[be%_e]}return this};var ue=/[^+/0-9A-Za-z-_]/g;function K(le){if(le=le.split("=")[0],le=le.trim().replace(ue,""),le.length<2)return"";for(;le.length%4!==0;)le=le+"=";return le}function te(le){return le<16?"0"+le.toString(16):le.toString(16)}function G(le,ie){ie=ie||1/0;for(var se,xe=le.length,oe=null,he=[],be=0;be<xe;++be){if(se=le.charCodeAt(be),se>55295&&se<57344){if(!oe){if(se>56319){(ie-=3)>-1&&he.push(239,191,189);continue}else if(be+1===xe){(ie-=3)>-1&&he.push(239,191,189);continue}oe=se;continue}if(se<56320){(ie-=3)>-1&&he.push(239,191,189),oe=se;continue}se=(oe-55296<<10|se-56320)+65536}else oe&&(ie-=3)>-1&&he.push(239,191,189);if(oe=null,se<128){if((ie-=1)<0)break;he.push(se)}else if(se<2048){if((ie-=2)<0)break;he.push(se>>6|192,se&63|128)}else if(se<65536){if((ie-=3)<0)break;he.push(se>>12|224,se>>6&63|128,se&63|128)}else if(se<1114112){if((ie-=4)<0)break;he.push(se>>18|240,se>>12&63|128,se>>6&63|128,se&63|128)}else throw new Error("Invalid code point")}return he}function Y(le){for(var ie=[],se=0;se<le.length;++se)ie.push(le.charCodeAt(se)&255);return ie}function ee(le,ie){for(var se,xe,oe,he=[],be=0;be<le.length&&!((ie-=2)<0);++be)se=le.charCodeAt(be),xe=se>>8,oe=se%256,he.push(oe),he.push(xe);return he}function ne(le){return u.toByteArray(K(le))}function J(le,ie,se,xe){for(var oe=0;oe<xe&&!(oe+se>=ie.length||oe>=le.length);++oe)ie[oe+se]=le[oe];return oe}function q(le,ie){return le instanceof ie||le!=null&&le.constructor!=null&&le.constructor.name!=null&&le.constructor.name===ie.name}function ae(le){return le!==le}}).call(this)}).call(this,t("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(t,P,R){P.exports=h;function h(u,A,T){return A<T?u<A?A:u>T?T:u:u<T?T:u>A?A:u}},{}],87:[function(t,P,R){var h=t("clamp");P.exports=u,P.exports.to=u,P.exports.from=A;function u(T,e){e==null&&(e=!0);var i=T[0],n=T[1],a=T[2],r=T[3];r==null&&(r=e?1:255),e&&(i*=255,n*=255,a*=255,r*=255),i=h(i,0,255)&255,n=h(n,0,255)&255,a=h(a,0,255)&255,r=h(r,0,255)&255;var f=i*16777216+(n<<16)+(a<<8)+r;return f}function A(T,e){T=+T;var i=T>>>24,n=(T&16711680)>>>16,a=(T&65280)>>>8,r=T&255;return e===!1?[i,n,a,r]:[i/255,n/255,a/255,r/255]}},{clamp:86}],88:[function(t,P,R){P.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(t,P,R){var h=t("color-rgba"),u=t("clamp"),A=t("dtype");P.exports=function(i,n){(n==="float"||!n)&&(n="array"),n==="uint"&&(n="uint8"),n==="uint_clamped"&&(n="uint8_clamped");var a=A(n),r=new a(4),f=n!=="uint8"&&n!=="uint8_clamped";return(!i.length||typeof i=="string")&&(i=h(i),i[0]/=255,i[1]/=255,i[2]/=255),T(i)?(r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3]!=null?i[3]:255,f&&(r[0]/=255,r[1]/=255,r[2]/=255,r[3]/=255),r):(f?(r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3]!=null?i[3]:1):(r[0]=u(Math.floor(i[0]*255),0,255),r[1]=u(Math.floor(i[1]*255),0,255),r[2]=u(Math.floor(i[2]*255),0,255),r[3]=i[3]==null?255:u(Math.floor(i[3]*255),0,255)),r)};function T(e){return!!(e instanceof Uint8Array||e instanceof Uint8ClampedArray||Array.isArray(e)&&(e[0]>1||e[0]===0)&&(e[1]>1||e[1]===0)&&(e[2]>1||e[2]===0)&&(!e[3]||e[3]>1))}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(t,P,R){(function(h){(function(){var u=t("color-name"),A=t("is-plain-obj"),T=t("defined");P.exports=i;var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function i(n){var a,r=[],f=1,o;if(typeof n=="string")if(u[n])r=u[n].slice(),o="rgb";else if(n==="transparent")f=0,o="rgb",r=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(n)){var s=n.slice(1),m=s.length,g=m<=4;f=1,g?(r=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],m===4&&(f=parseInt(s[3]+s[3],16)/255)):(r=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],m===8&&(f=parseInt(s[6]+s[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),o="rgb"}else if(a=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(n)){var p=a[1],v=p==="rgb",s=p.replace(/a$/,"");o=s;var m=s==="cmyk"?4:s==="gray"?1:3;r=a[2].trim().split(/\s*,\s*/).map(function(c,M){if(/%$/.test(c))return M===m?parseFloat(c)/100:s==="rgb"?parseFloat(c)*255/100:parseFloat(c);if(s[M]==="h"){if(/deg$/.test(c))return parseFloat(c);if(e[c]!==void 0)return e[c]}return parseFloat(c)}),p===s&&r.push(1),f=v||r[m]===void 0?1:r[m],r=r.slice(0,m)}else n.length>10&&/[0-9](?:\s|\/)/.test(n)&&(r=n.match(/([0-9]+)/g).map(function(l){return parseFloat(l)}),o=n.match(/([a-z])/ig).join("").toLowerCase());else if(!isNaN(n))o="rgb",r=[n>>>16,(n&65280)>>>8,n&255];else if(A(n)){var x=T(n.r,n.red,n.R,null);x!==null?(o="rgb",r=[x,T(n.g,n.green,n.G),T(n.b,n.blue,n.B)]):(o="hsl",r=[T(n.h,n.hue,n.H),T(n.s,n.saturation,n.S),T(n.l,n.lightness,n.L,n.b,n.brightness)]),f=T(n.a,n.alpha,n.opacity,1),n.opacity!=null&&(f/=100)}else(Array.isArray(n)||h.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(n))&&(r=[n[0],n[1],n[2]],o="rgb",f=n.length===4?n[3]:1);return{space:o,values:r,alpha:f}}}).call(this)}).call(this,typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(t,P,R){var h=t("color-parse"),u=t("color-space/hsl"),A=t("clamp");P.exports=function(e){var i,n=h(e);return n.space?(i=Array(3),i[0]=A(n.values[0],0,255),i[1]=A(n.values[1],0,255),i[2]=A(n.values[2],0,255),n.space[0]==="h"&&(i=u.rgb(i)),i.push(A(n.alpha,0,1)),i):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(t,P,R){var h=t("./rgb");P.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(u){var A=u[0]/360,T=u[1]/100,e=u[2]/100,i,n,a,r,f;if(T===0)return f=e*255,[f,f,f];e<.5?n=e*(1+T):n=e+T-e*T,i=2*e-n,r=[0,0,0];for(var o=0;o<3;o++)a=A+1/3*-(o-1),a<0?a++:a>1&&a--,6*a<1?f=i+(n-i)*6*a:2*a<1?f=n:3*a<2?f=i+(n-i)*(2/3-a)*6:f=i,r[o]=f*255;return r}},h.hsl=function(u){var A=u[0]/255,T=u[1]/255,e=u[2]/255,i=Math.min(A,T,e),n=Math.max(A,T,e),a=n-i,r,f,o;return n===i?r=0:A===n?r=(T-e)/a:T===n?r=2+(e-A)/a:e===n&&(r=4+(A-T)/a),r=Math.min(r*60,360),r<0&&(r+=360),o=(i+n)/2,n===i?f=0:o<=.5?f=a/(n+i):f=a/(2-n-i),[r,f*100,o*100]}},{"./rgb":93}],93:[function(t,P,R){P.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(t,P,R){P.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(t,P,R){P.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(t,P,R){P.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(t,P,R){P.exports=["normal","italic","oblique"]},{}],98:[function(t,P,R){P.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(t,P,R){P.exports={parse:t("./parse"),stringify:t("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(t,P,R){var h=t("css-font-size-keywords");P.exports={isSize:function(A){return/^[\d\.]/.test(A)||A.indexOf("/")!==-1||h.indexOf(A)!==-1}}},{"css-font-size-keywords":95}],101:[function(t,P,R){var h=t("unquote"),u=t("css-global-keywords"),A=t("css-system-font-keywords"),T=t("css-font-weight-keywords"),e=t("css-font-style-keywords"),i=t("css-font-stretch-keywords"),n=t("string-split-by"),a=t("./lib/util").isSize;P.exports=f;var r=f.cache={};function f(s){if(typeof s!="string")throw new Error("Font argument must be a string.");if(r[s])return r[s];if(s==="")throw new Error("Cannot parse an empty string.");if(A.indexOf(s)!==-1)return r[s]={system:s};for(var m={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},g=n(s,/\s+/),p;p=g.shift();){if(u.indexOf(p)!==-1)return["style","variant","weight","stretch"].forEach(function(x){m[x]=p}),r[s]=m;if(e.indexOf(p)!==-1){m.style=p;continue}if(p==="normal"||p==="small-caps"){m.variant=p;continue}if(i.indexOf(p)!==-1){m.stretch=p;continue}if(T.indexOf(p)!==-1){m.weight=p;continue}if(a(p)){var v=n(p,"/");if(m.size=v[0],v[1]!=null?m.lineHeight=o(v[1]):g[0]==="/"&&(g.shift(),m.lineHeight=o(g.shift())),!g.length)throw new Error("Missing required font-family.");return m.family=n(g.join(" "),/\s*,\s*/).map(h),r[s]=m}throw new Error("Unknown or unsupported font token: "+p)}throw new Error("Missing required font-size.")}function o(s){var m=parseFloat(s);return m.toString()===s?m:s}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":306,unquote:329}],102:[function(t,P,R){var h=t("pick-by-alias"),u=t("./lib/util").isSize,A=s(t("css-global-keywords")),T=s(t("css-system-font-keywords")),e=s(t("css-font-weight-keywords")),i=s(t("css-font-style-keywords")),n=s(t("css-font-stretch-keywords")),a={normal:1,"small-caps":1},r={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},f={style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"1rem",lineHeight:"normal",family:"serif"};P.exports=function(g){if(g=h(g,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"}),g.system)return g.system&&o(g.system,T),g.system;if(o(g.style,i),o(g.variant,a),o(g.weight,e),o(g.stretch,n),g.size==null&&(g.size=f.size),typeof g.size=="number"&&(g.size+="px"),!u)throw Error("Bad size value `"+g.size+"`");g.family||(g.family=f.family),Array.isArray(g.family)&&(g.family.length||(g.family=[f.family]),g.family=g.family.map(function(v){return r[v]?v:'"'+v+'"'}).join(", "));var p=[];return p.push(g.style),g.variant!==g.style&&p.push(g.variant),g.weight!==g.variant&&g.weight!==g.style&&p.push(g.weight),g.stretch!==g.weight&&g.stretch!==g.variant&&g.stretch!==g.style&&p.push(g.stretch),p.push(g.size+(g.lineHeight==null||g.lineHeight==="normal"||g.lineHeight+""=="1"?"":"/"+g.lineHeight)),p.push(g.family),p.filter(Boolean).join(" ")};function o(m,g){if(m&&!g[m]&&!A[m])throw Error("Unknown keyword `"+m+"`");return m}function s(m){for(var g={},p=0;p<m.length;p++)g[m[p]]=1;return g}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(t,P,R){P.exports=["inherit","initial","unset"]},{}],104:[function(t,P,R){P.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(t,P,R){var h=t("type/value/is"),u=t("type/value/ensure"),A=t("type/plain-function/ensure"),T=t("es5-ext/object/copy"),e=t("es5-ext/object/normalize-options"),i=t("es5-ext/object/map"),n=Function.prototype.bind,a=Object.defineProperty,r=Object.prototype.hasOwnProperty,f;f=function(o,s,m){var g=u(s)&&A(s.value),p;return p=T(s),delete p.writable,delete p.value,p.get=function(){return!m.overwriteDefinition&&r.call(this,o)?g:(s.value=n.call(g,m.resolveContext?m.resolveContext(this):this),a(this,o,s),this[o])},p},P.exports=function(o){var s=e(arguments[1]);return h(s.resolveContext)&&A(s.resolveContext),i(o,function(m,g){return f(g,m,s)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":322,"type/value/ensure":326,"type/value/is":327}],106:[function(t,P,R){var h=t("type/value/is"),u=t("type/plain-function/is"),A=t("es5-ext/object/assign"),T=t("es5-ext/object/normalize-options"),e=t("es5-ext/string/#/contains"),i=P.exports=function(n,a){var r,f,o,s,m;return arguments.length<2||typeof n!="string"?(s=a,a=n,n=null):s=arguments[2],h(n)?(r=e.call(n,"c"),f=e.call(n,"e"),o=e.call(n,"w")):(r=o=!0,f=!1),m={value:a,configurable:r,enumerable:f,writable:o},s?A(T(s),m):m};i.gs=function(n,a,r){var f,o,s,m;return typeof n!="string"?(s=r,r=a,a=n,n=null):s=arguments[3],h(a)?u(a)?h(r)?u(r)||(s=r,r=void 0):r=void 0:(s=a,a=r=void 0):a=void 0,h(n)?(f=e.call(n,"c"),o=e.call(n,"e")):(f=!0,o=!1),m={get:a,set:r,configurable:f,enumerable:o},s?A(T(s),m):m}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":323,"type/value/is":327}],107:[function(t,P,R){(function(h,u){u(typeof R=="object"&&typeof P<"u"?R:h.d3=h.d3||{})})(this,function(h){function u(G,Y){return G<Y?-1:G>Y?1:G>=Y?0:NaN}function A(G){return G.length===1&&(G=T(G)),{left:function(Y,ee,ne,J){for(ne==null&&(ne=0),J==null&&(J=Y.length);ne<J;){var q=ne+J>>>1;G(Y[q],ee)<0?ne=q+1:J=q}return ne},right:function(Y,ee,ne,J){for(ne==null&&(ne=0),J==null&&(J=Y.length);ne<J;){var q=ne+J>>>1;G(Y[q],ee)>0?J=q:ne=q+1}return ne}}}function T(G){return function(Y,ee){return u(G(Y),ee)}}var e=A(u),i=e.right,n=e.left;function a(G,Y){Y==null&&(Y=r);for(var ee=0,ne=G.length-1,J=G[0],q=new Array(ne<0?0:ne);ee<ne;)q[ee]=Y(J,J=G[++ee]);return q}function r(G,Y){return[G,Y]}function f(G,Y,ee){var ne=G.length,J=Y.length,q=new Array(ne*J),ae,le,ie,se;for(ee==null&&(ee=r),ae=ie=0;ae<ne;++ae)for(se=G[ae],le=0;le<J;++le,++ie)q[ie]=ee(se,Y[le]);return q}function o(G,Y){return Y<G?-1:Y>G?1:Y>=G?0:NaN}function s(G){return G===null?NaN:+G}function m(G,Y){var ee=G.length,ne=0,J=-1,q=0,ae,le,ie=0;if(Y==null)for(;++J<ee;)isNaN(ae=s(G[J]))||(le=ae-q,q+=le/++ne,ie+=le*(ae-q));else for(;++J<ee;)isNaN(ae=s(Y(G[J],J,G)))||(le=ae-q,q+=le/++ne,ie+=le*(ae-q));if(ne>1)return ie/(ne-1)}function g(G,Y){var ee=m(G,Y);return ee&&Math.sqrt(ee)}function p(G,Y){var ee=G.length,ne=-1,J,q,ae;if(Y==null){for(;++ne<ee;)if((J=G[ne])!=null&&J>=J)for(q=ae=J;++ne<ee;)(J=G[ne])!=null&&(q>J&&(q=J),ae<J&&(ae=J))}else for(;++ne<ee;)if((J=Y(G[ne],ne,G))!=null&&J>=J)for(q=ae=J;++ne<ee;)(J=Y(G[ne],ne,G))!=null&&(q>J&&(q=J),ae<J&&(ae=J));return[q,ae]}var v=Array.prototype,x=v.slice,l=v.map;function b(G){return function(){return G}}function c(G){return G}function M(G,Y,ee){G=+G,Y=+Y,ee=(J=arguments.length)<2?(Y=G,G=0,1):J<3?1:+ee;for(var ne=-1,J=Math.max(0,Math.ceil((Y-G)/ee))|0,q=new Array(J);++ne<J;)q[ne]=G+ne*ee;return q}var _=Math.sqrt(50),y=Math.sqrt(10),w=Math.sqrt(2);function d(G,Y,ee){var ne,J=-1,q,ae,le;if(Y=+Y,G=+G,ee=+ee,G===Y&&ee>0)return[G];if((ne=Y<G)&&(q=G,G=Y,Y=q),(le=C(G,Y,ee))===0||!isFinite(le))return[];if(le>0)for(G=Math.ceil(G/le),Y=Math.floor(Y/le),ae=new Array(q=Math.ceil(Y-G+1));++J<q;)ae[J]=(G+J)*le;else for(G=Math.floor(G*le),Y=Math.ceil(Y*le),ae=new Array(q=Math.ceil(G-Y+1));++J<q;)ae[J]=(G-J)/le;return ne&&ae.reverse(),ae}function C(G,Y,ee){var ne=(Y-G)/Math.max(0,ee),J=Math.floor(Math.log(ne)/Math.LN10),q=ne/Math.pow(10,J);return J>=0?(q>=_?10:q>=y?5:q>=w?2:1)*Math.pow(10,J):-Math.pow(10,-J)/(q>=_?10:q>=y?5:q>=w?2:1)}function S(G,Y,ee){var ne=Math.abs(Y-G)/Math.max(0,ee),J=Math.pow(10,Math.floor(Math.log(ne)/Math.LN10)),q=ne/J;return q>=_?J*=10:q>=y?J*=5:q>=w&&(J*=2),Y<G?-J:J}function E(G){return Math.ceil(Math.log(G.length)/Math.LN2)+1}function k(){var G=c,Y=p,ee=E;function ne(J){var q,ae=J.length,le,ie=new Array(ae);for(q=0;q<ae;++q)ie[q]=G(J[q],q,J);var se=Y(ie),xe=se[0],oe=se[1],he=ee(ie,xe,oe);Array.isArray(he)||(he=S(xe,oe,he),he=M(Math.ceil(xe/he)*he,oe,he));for(var be=he.length;he[0]<=xe;)he.shift(),--be;for(;he[be-1]>oe;)he.pop(),--be;var me=new Array(be+1),_e;for(q=0;q<=be;++q)_e=me[q]=[],_e.x0=q>0?he[q-1]:xe,_e.x1=q<be?he[q]:oe;for(q=0;q<ae;++q)le=ie[q],xe<=le&&le<=oe&&me[i(he,le,0,be)].push(J[q]);return me}return ne.value=function(J){return arguments.length?(G=typeof J=="function"?J:b(J),ne):G},ne.domain=function(J){return arguments.length?(Y=typeof J=="function"?J:b([J[0],J[1]]),ne):Y},ne.thresholds=function(J){return arguments.length?(ee=typeof J=="function"?J:Array.isArray(J)?b(x.call(J)):b(J),ne):ee},ne}function B(G,Y,ee){if(ee==null&&(ee=s),!!(ne=G.length)){if((Y=+Y)<=0||ne<2)return+ee(G[0],0,G);if(Y>=1)return+ee(G[ne-1],ne-1,G);var ne,J=(ne-1)*Y,q=Math.floor(J),ae=+ee(G[q],q,G),le=+ee(G[q+1],q+1,G);return ae+(le-ae)*(J-q)}}function z(G,Y,ee){return G=l.call(G,s).sort(u),Math.ceil((ee-Y)/(2*(B(G,.75)-B(G,.25))*Math.pow(G.length,-1/3)))}function F(G,Y,ee){return Math.ceil((ee-Y)/(3.5*g(G)*Math.pow(G.length,-1/3)))}function I(G,Y){var ee=G.length,ne=-1,J,q;if(Y==null){for(;++ne<ee;)if((J=G[ne])!=null&&J>=J)for(q=J;++ne<ee;)(J=G[ne])!=null&&J>q&&(q=J)}else for(;++ne<ee;)if((J=Y(G[ne],ne,G))!=null&&J>=J)for(q=J;++ne<ee;)(J=Y(G[ne],ne,G))!=null&&J>q&&(q=J);return q}function O(G,Y){var ee=G.length,ne=ee,J=-1,q,ae=0;if(Y==null)for(;++J<ee;)isNaN(q=s(G[J]))?--ne:ae+=q;else for(;++J<ee;)isNaN(q=s(Y(G[J],J,G)))?--ne:ae+=q;if(ne)return ae/ne}function N(G,Y){var ee=G.length,ne=-1,J,q=[];if(Y==null)for(;++ne<ee;)isNaN(J=s(G[ne]))||q.push(J);else for(;++ne<ee;)isNaN(J=s(Y(G[ne],ne,G)))||q.push(J);return B(q.sort(u),.5)}function V(G){for(var Y=G.length,ee,ne=-1,J=0,q,ae;++ne<Y;)J+=G[ne].length;for(q=new Array(J);--Y>=0;)for(ae=G[Y],ee=ae.length;--ee>=0;)q[--J]=ae[ee];return q}function H(G,Y){var ee=G.length,ne=-1,J,q;if(Y==null){for(;++ne<ee;)if((J=G[ne])!=null&&J>=J)for(q=J;++ne<ee;)(J=G[ne])!=null&&q>J&&(q=J)}else for(;++ne<ee;)if((J=Y(G[ne],ne,G))!=null&&J>=J)for(q=J;++ne<ee;)(J=Y(G[ne],ne,G))!=null&&q>J&&(q=J);return q}function j(G,Y){for(var ee=Y.length,ne=new Array(ee);ee--;)ne[ee]=G[Y[ee]];return ne}function Z(G,Y){if(!!(ee=G.length)){var ee,ne=0,J=0,q,ae=G[J];for(Y==null&&(Y=u);++ne<ee;)(Y(q=G[ne],ae)<0||Y(ae,ae)!==0)&&(ae=q,J=ne);if(Y(ae,ae)===0)return J}}function X(G,Y,ee){for(var ne=(ee==null?G.length:ee)-(Y=Y==null?0:+Y),J,q;ne;)q=Math.random()*ne--|0,J=G[ne+Y],G[ne+Y]=G[q+Y],G[q+Y]=J;return G}function re(G,Y){var ee=G.length,ne=-1,J,q=0;if(Y==null)for(;++ne<ee;)(J=+G[ne])&&(q+=J);else for(;++ne<ee;)(J=+Y(G[ne],ne,G))&&(q+=J);return q}function ue(G){if(!(q=G.length))return[];for(var Y=-1,ee=H(G,K),ne=new Array(ee);++Y<ee;)for(var J=-1,q,ae=ne[Y]=new Array(q);++J<q;)ae[J]=G[J][Y];return ne}function K(G){return G.length}function te(){return ue(arguments)}h.bisect=i,h.bisectRight=i,h.bisectLeft=n,h.ascending=u,h.bisector=A,h.cross=f,h.descending=o,h.deviation=g,h.extent=p,h.histogram=k,h.thresholdFreedmanDiaconis=z,h.thresholdScott=F,h.thresholdSturges=E,h.max=I,h.mean=O,h.median=N,h.merge=V,h.min=H,h.pairs=a,h.permute=j,h.quantile=B,h.range=M,h.scan=Z,h.shuffle=X,h.sum=re,h.ticks=d,h.tickIncrement=C,h.tickStep=S,h.transpose=ue,h.variance=m,h.zip=te,Object.defineProperty(h,"__esModule",{value:!0})})},{}],108:[function(t,P,R){(function(h,u){u(typeof R=="object"&&typeof P<"u"?R:h.d3=h.d3||{})})(this,function(h){var u="$";function A(){}A.prototype=T.prototype={constructor:A,has:function(v){return u+v in this},get:function(v){return this[u+v]},set:function(v,x){return this[u+v]=x,this},remove:function(v){var x=u+v;return x in this&&delete this[x]},clear:function(){for(var v in this)v[0]===u&&delete this[v]},keys:function(){var v=[];for(var x in this)x[0]===u&&v.push(x.slice(1));return v},values:function(){var v=[];for(var x in this)x[0]===u&&v.push(this[x]);return v},entries:function(){var v=[];for(var x in this)x[0]===u&&v.push({key:x.slice(1),value:this[x]});return v},size:function(){var v=0;for(var x in this)x[0]===u&&++v;return v},empty:function(){for(var v in this)if(v[0]===u)return!1;return!0},each:function(v){for(var x in this)x[0]===u&&v(this[x],x.slice(1),this)}};function T(v,x){var l=new A;if(v instanceof A)v.each(function(y,w){l.set(w,y)});else if(Array.isArray(v)){var b=-1,c=v.length,M;if(x==null)for(;++b<c;)l.set(b,v[b]);else for(;++b<c;)l.set(x(M=v[b],b,v),M)}else if(v)for(var _ in v)l.set(_,v[_]);return l}function e(){var v=[],x=[],l,b,c;function M(y,w,d,C){if(w>=v.length)return l!=null&&y.sort(l),b!=null?b(y):y;for(var S=-1,E=y.length,k=v[w++],B,z,F=T(),I,O=d();++S<E;)(I=F.get(B=k(z=y[S])+""))?I.push(z):F.set(B,[z]);return F.each(function(N,V){C(O,V,M(N,w,d,C))}),O}function _(y,w){if(++w>v.length)return y;var d,C=x[w-1];return b!=null&&w>=v.length?d=y.entries():(d=[],y.each(function(S,E){d.push({key:E,values:_(S,w)})})),C!=null?d.sort(function(S,E){return C(S.key,E.key)}):d}return c={object:function(y){return M(y,0,i,n)},map:function(y){return M(y,0,a,r)},entries:function(y){return _(M(y,0,a,r),0)},key:function(y){return v.push(y),c},sortKeys:function(y){return x[v.length-1]=y,c},sortValues:function(y){return l=y,c},rollup:function(y){return b=y,c}}}function i(){return{}}function n(v,x,l){v[x]=l}function a(){return T()}function r(v,x,l){v.set(x,l)}function f(){}var o=T.prototype;f.prototype=s.prototype={constructor:f,has:o.has,add:function(v){return v+="",this[u+v]=v,this},remove:o.remove,clear:o.clear,values:o.keys,size:o.size,empty:o.empty,each:o.each};function s(v,x){var l=new f;if(v instanceof f)v.each(function(M){l.add(M)});else if(v){var b=-1,c=v.length;if(x==null)for(;++b<c;)l.add(v[b]);else for(;++b<c;)l.add(x(v[b],b,v))}return l}function m(v){var x=[];for(var l in v)x.push(l);return x}function g(v){var x=[];for(var l in v)x.push(v[l]);return x}function p(v){var x=[];for(var l in v)x.push({key:l,value:v[l]});return x}h.nest=e,h.set=s,h.map=T,h.keys=m,h.values=g,h.entries=p,Object.defineProperty(h,"__esModule",{value:!0})})},{}],109:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R):(h=h||self,u(h.d3=h.d3||{}))})(this,function(h){function u(Re,We,vt){Re.prototype=We.prototype=vt,vt.constructor=Re}function A(Re,We){var vt=Object.create(Re.prototype);for(var Pt in We)vt[Pt]=We[Pt];return vt}function T(){}var e=.7,i=1/e,n="\\s*([+-]?\\d+)\\s*",a="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",r="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",f=/^#([0-9a-f]{3,8})$/,o=new RegExp("^rgb\\("+[n,n,n]+"\\)$"),s=new RegExp("^rgb\\("+[r,r,r]+"\\)$"),m=new RegExp("^rgba\\("+[n,n,n,a]+"\\)$"),g=new RegExp("^rgba\\("+[r,r,r,a]+"\\)$"),p=new RegExp("^hsl\\("+[a,r,r]+"\\)$"),v=new RegExp("^hsla\\("+[a,r,r,a]+"\\)$"),x={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};u(T,M,{copy:function(Re){return Object.assign(new this.constructor,this,Re)},displayable:function(){return this.rgb().displayable()},hex:l,formatHex:l,formatHsl:b,formatRgb:c,toString:c});function l(){return this.rgb().formatHex()}function b(){return z(this).formatHsl()}function c(){return this.rgb().formatRgb()}function M(Re){var We,vt;return Re=(Re+"").trim().toLowerCase(),(We=f.exec(Re))?(vt=We[1].length,We=parseInt(We[1],16),vt===6?_(We):vt===3?new C(We>>8&15|We>>4&240,We>>4&15|We&240,(We&15)<<4|We&15,1):vt===8?y(We>>24&255,We>>16&255,We>>8&255,(We&255)/255):vt===4?y(We>>12&15|We>>8&240,We>>8&15|We>>4&240,We>>4&15|We&240,((We&15)<<4|We&15)/255):null):(We=o.exec(Re))?new C(We[1],We[2],We[3],1):(We=s.exec(Re))?new C(We[1]*255/100,We[2]*255/100,We[3]*255/100,1):(We=m.exec(Re))?y(We[1],We[2],We[3],We[4]):(We=g.exec(Re))?y(We[1]*255/100,We[2]*255/100,We[3]*255/100,We[4]):(We=p.exec(Re))?B(We[1],We[2]/100,We[3]/100,1):(We=v.exec(Re))?B(We[1],We[2]/100,We[3]/100,We[4]):x.hasOwnProperty(Re)?_(x[Re]):Re==="transparent"?new C(NaN,NaN,NaN,0):null}function _(Re){return new C(Re>>16&255,Re>>8&255,Re&255,1)}function y(Re,We,vt,Pt){return Pt<=0&&(Re=We=vt=NaN),new C(Re,We,vt,Pt)}function w(Re){return Re instanceof T||(Re=M(Re)),Re?(Re=Re.rgb(),new C(Re.r,Re.g,Re.b,Re.opacity)):new C}function d(Re,We,vt,Pt){return arguments.length===1?w(Re):new C(Re,We,vt,Pt==null?1:Pt)}function C(Re,We,vt,Pt){this.r=+Re,this.g=+We,this.b=+vt,this.opacity=+Pt}u(C,d,A(T,{brighter:function(Re){return Re=Re==null?i:Math.pow(i,Re),new C(this.r*Re,this.g*Re,this.b*Re,this.opacity)},darker:function(Re){return Re=Re==null?e:Math.pow(e,Re),new C(this.r*Re,this.g*Re,this.b*Re,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:S,formatHex:S,formatRgb:E,toString:E}));function S(){return"#"+k(this.r)+k(this.g)+k(this.b)}function E(){var Re=this.opacity;return Re=isNaN(Re)?1:Math.max(0,Math.min(1,Re)),(Re===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(Re===1?")":", "+Re+")")}function k(Re){return Re=Math.max(0,Math.min(255,Math.round(Re)||0)),(Re<16?"0":"")+Re.toString(16)}function B(Re,We,vt,Pt){return Pt<=0?Re=We=vt=NaN:vt<=0||vt>=1?Re=We=NaN:We<=0&&(Re=NaN),new I(Re,We,vt,Pt)}function z(Re){if(Re instanceof I)return new I(Re.h,Re.s,Re.l,Re.opacity);if(Re instanceof T||(Re=M(Re)),!Re)return new I;if(Re instanceof I)return Re;Re=Re.rgb();var We=Re.r/255,vt=Re.g/255,Pt=Re.b/255,Zt=Math.min(We,vt,Pt),zt=Math.max(We,vt,Pt),At=NaN,Wt=zt-Zt,Bt=(zt+Zt)/2;return Wt?(We===zt?At=(vt-Pt)/Wt+(vt<Pt)*6:vt===zt?At=(Pt-We)/Wt+2:At=(We-vt)/Wt+4,Wt/=Bt<.5?zt+Zt:2-zt-Zt,At*=60):Wt=Bt>0&&Bt<1?0:At,new I(At,Wt,Bt,Re.opacity)}function F(Re,We,vt,Pt){return arguments.length===1?z(Re):new I(Re,We,vt,Pt==null?1:Pt)}function I(Re,We,vt,Pt){this.h=+Re,this.s=+We,this.l=+vt,this.opacity=+Pt}u(I,F,A(T,{brighter:function(Re){return Re=Re==null?i:Math.pow(i,Re),new I(this.h,this.s,this.l*Re,this.opacity)},darker:function(Re){return Re=Re==null?e:Math.pow(e,Re),new I(this.h,this.s,this.l*Re,this.opacity)},rgb:function(){var Re=this.h%360+(this.h<0)*360,We=isNaN(Re)||isNaN(this.s)?0:this.s,vt=this.l,Pt=vt+(vt<.5?vt:1-vt)*We,Zt=2*vt-Pt;return new C(O(Re>=240?Re-240:Re+120,Zt,Pt),O(Re,Zt,Pt),O(Re<120?Re+240:Re-120,Zt,Pt),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var Re=this.opacity;return Re=isNaN(Re)?1:Math.max(0,Math.min(1,Re)),(Re===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(Re===1?")":", "+Re+")")}}));function O(Re,We,vt){return(Re<60?We+(vt-We)*Re/60:Re<180?vt:Re<240?We+(vt-We)*(240-Re)/60:We)*255}var N=Math.PI/180,V=180/Math.PI,H=18,j=.96422,Z=1,X=.82521,re=4/29,ue=6/29,K=3*ue*ue,te=ue*ue*ue;function G(Re){if(Re instanceof ne)return new ne(Re.l,Re.a,Re.b,Re.opacity);if(Re instanceof oe)return he(Re);Re instanceof C||(Re=w(Re));var We=le(Re.r),vt=le(Re.g),Pt=le(Re.b),Zt=J((.2225045*We+.7168786*vt+.0606169*Pt)/Z),zt,At;return We===vt&&vt===Pt?zt=At=Zt:(zt=J((.4360747*We+.3850649*vt+.1430804*Pt)/j),At=J((.0139322*We+.0971045*vt+.7141733*Pt)/X)),new ne(116*Zt-16,500*(zt-Zt),200*(Zt-At),Re.opacity)}function Y(Re,We){return new ne(Re,0,0,We==null?1:We)}function ee(Re,We,vt,Pt){return arguments.length===1?G(Re):new ne(Re,We,vt,Pt==null?1:Pt)}function ne(Re,We,vt,Pt){this.l=+Re,this.a=+We,this.b=+vt,this.opacity=+Pt}u(ne,ee,A(T,{brighter:function(Re){return new ne(this.l+H*(Re==null?1:Re),this.a,this.b,this.opacity)},darker:function(Re){return new ne(this.l-H*(Re==null?1:Re),this.a,this.b,this.opacity)},rgb:function(){var Re=(this.l+16)/116,We=isNaN(this.a)?Re:Re+this.a/500,vt=isNaN(this.b)?Re:Re-this.b/200;return We=j*q(We),Re=Z*q(Re),vt=X*q(vt),new C(ae(3.1338561*We-1.6168667*Re-.4906146*vt),ae(-.9787684*We+1.9161415*Re+.033454*vt),ae(.0719453*We-.2289914*Re+1.4052427*vt),this.opacity)}}));function J(Re){return Re>te?Math.pow(Re,1/3):Re/K+re}function q(Re){return Re>ue?Re*Re*Re:K*(Re-re)}function ae(Re){return 255*(Re<=.0031308?12.92*Re:1.055*Math.pow(Re,1/2.4)-.055)}function le(Re){return(Re/=255)<=.04045?Re/12.92:Math.pow((Re+.055)/1.055,2.4)}function ie(Re){if(Re instanceof oe)return new oe(Re.h,Re.c,Re.l,Re.opacity);if(Re instanceof ne||(Re=G(Re)),Re.a===0&&Re.b===0)return new oe(NaN,0<Re.l&&Re.l<100?0:NaN,Re.l,Re.opacity);var We=Math.atan2(Re.b,Re.a)*V;return new oe(We<0?We+360:We,Math.sqrt(Re.a*Re.a+Re.b*Re.b),Re.l,Re.opacity)}function se(Re,We,vt,Pt){return arguments.length===1?ie(Re):new oe(vt,We,Re,Pt==null?1:Pt)}function xe(Re,We,vt,Pt){return arguments.length===1?ie(Re):new oe(Re,We,vt,Pt==null?1:Pt)}function oe(Re,We,vt,Pt){this.h=+Re,this.c=+We,this.l=+vt,this.opacity=+Pt}function he(Re){if(isNaN(Re.h))return new ne(Re.l,0,0,Re.opacity);var We=Re.h*N;return new ne(Re.l,Math.cos(We)*Re.c,Math.sin(We)*Re.c,Re.opacity)}u(oe,xe,A(T,{brighter:function(Re){return new oe(this.h,this.c,this.l+H*(Re==null?1:Re),this.opacity)},darker:function(Re){return new oe(this.h,this.c,this.l-H*(Re==null?1:Re),this.opacity)},rgb:function(){return he(this).rgb()}}));var be=-.14861,me=1.78277,_e=-.29227,Se=-.90649,De=1.97294,Ie=De*Se,Te=De*me,Ce=me*_e-Se*be;function He(Re){if(Re instanceof Be)return new Be(Re.h,Re.s,Re.l,Re.opacity);Re instanceof C||(Re=w(Re));var We=Re.r/255,vt=Re.g/255,Pt=Re.b/255,Zt=(Ce*Pt+Ie*We-Te*vt)/(Ce+Ie-Te),zt=Pt-Zt,At=(De*(vt-Zt)-_e*zt)/Se,Wt=Math.sqrt(At*At+zt*zt)/(De*Zt*(1-Zt)),Bt=Wt?Math.atan2(At,zt)*V-120:NaN;return new Be(Bt<0?Bt+360:Bt,Wt,Zt,Re.opacity)}function Xe(Re,We,vt,Pt){return arguments.length===1?He(Re):new Be(Re,We,vt,Pt==null?1:Pt)}function Be(Re,We,vt,Pt){this.h=+Re,this.s=+We,this.l=+vt,this.opacity=+Pt}u(Be,Xe,A(T,{brighter:function(Re){return Re=Re==null?i:Math.pow(i,Re),new Be(this.h,this.s,this.l*Re,this.opacity)},darker:function(Re){return Re=Re==null?e:Math.pow(e,Re),new Be(this.h,this.s,this.l*Re,this.opacity)},rgb:function(){var Re=isNaN(this.h)?0:(this.h+120)*N,We=+this.l,vt=isNaN(this.s)?0:this.s*We*(1-We),Pt=Math.cos(Re),Zt=Math.sin(Re);return new C(255*(We+vt*(be*Pt+me*Zt)),255*(We+vt*(_e*Pt+Se*Zt)),255*(We+vt*(De*Pt)),this.opacity)}})),h.color=M,h.cubehelix=Xe,h.gray=Y,h.hcl=xe,h.hsl=F,h.lab=ee,h.lch=se,h.rgb=d,Object.defineProperty(h,"__esModule",{value:!0})})},{}],110:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R):(h=h||self,u(h.d3=h.d3||{}))})(this,function(h){var u={value:function(){}};function A(){for(var a=0,r=arguments.length,f={},o;a<r;++a){if(!(o=arguments[a]+"")||o in f||/[\s.]/.test(o))throw new Error("illegal type: "+o);f[o]=[]}return new T(f)}function T(a){this._=a}function e(a,r){return a.trim().split(/^|\s+/).map(function(f){var o="",s=f.indexOf(".");if(s>=0&&(o=f.slice(s+1),f=f.slice(0,s)),f&&!r.hasOwnProperty(f))throw new Error("unknown type: "+f);return{type:f,name:o}})}T.prototype=A.prototype={constructor:T,on:function(a,r){var f=this._,o=e(a+"",f),s,m=-1,g=o.length;if(arguments.length<2){for(;++m<g;)if((s=(a=o[m]).type)&&(s=i(f[s],a.name)))return s;return}if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++m<g;)if(s=(a=o[m]).type)f[s]=n(f[s],a.name,r);else if(r==null)for(s in f)f[s]=n(f[s],a.name,null);return this},copy:function(){var a={},r=this._;for(var f in r)a[f]=r[f].slice();return new T(a)},call:function(a,r){if((s=arguments.length-2)>0)for(var f=new Array(s),o=0,s,m;o<s;++o)f[o]=arguments[o+2];if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(m=this._[a],o=0,s=m.length;o<s;++o)m[o].value.apply(r,f)},apply:function(a,r,f){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var o=this._[a],s=0,m=o.length;s<m;++s)o[s].value.apply(r,f)}};function i(a,r){for(var f=0,o=a.length,s;f<o;++f)if((s=a[f]).name===r)return s.value}function n(a,r,f){for(var o=0,s=a.length;o<s;++o)if(a[o].name===r){a[o]=u,a=a.slice(0,o).concat(a.slice(o+1));break}return f!=null&&a.push({name:r,value:f}),a}h.dispatch=A,Object.defineProperty(h,"__esModule",{value:!0})})},{}],111:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R,t("d3-quadtree"),t("d3-collection"),t("d3-dispatch"),t("d3-timer")):u(h.d3=h.d3||{},h.d3,h.d3,h.d3,h.d3)})(this,function(h,u,A,T,e){function i(w,d){var C;w==null&&(w=0),d==null&&(d=0);function S(){var E,k=C.length,B,z=0,F=0;for(E=0;E<k;++E)B=C[E],z+=B.x,F+=B.y;for(z=z/k-w,F=F/k-d,E=0;E<k;++E)B=C[E],B.x-=z,B.y-=F}return S.initialize=function(E){C=E},S.x=function(E){return arguments.length?(w=+E,S):w},S.y=function(E){return arguments.length?(d=+E,S):d},S}function n(w){return function(){return w}}function a(){return(Math.random()-.5)*1e-6}function r(w){return w.x+w.vx}function f(w){return w.y+w.vy}function o(w){var d,C,S=1,E=1;typeof w!="function"&&(w=n(w==null?1:+w));function k(){for(var F,I=d.length,O,N,V,H,j,Z,X=0;X<E;++X)for(O=u.quadtree(d,r,f).visitAfter(B),F=0;F<I;++F)N=d[F],j=C[N.index],Z=j*j,V=N.x+N.vx,H=N.y+N.vy,O.visit(re);function re(ue,K,te,G,Y){var ee=ue.data,ne=ue.r,J=j+ne;if(ee){if(ee.index>N.index){var q=V-ee.x-ee.vx,ae=H-ee.y-ee.vy,le=q*q+ae*ae;le<J*J&&(q===0&&(q=a(),le+=q*q),ae===0&&(ae=a(),le+=ae*ae),le=(J-(le=Math.sqrt(le)))/le*S,N.vx+=(q*=le)*(J=(ne*=ne)/(Z+ne)),N.vy+=(ae*=le)*J,ee.vx-=q*(J=1-J),ee.vy-=ae*J)}return}return K>V+J||G<V-J||te>H+J||Y<H-J}}function B(F){if(F.data)return F.r=C[F.data.index];for(var I=F.r=0;I<4;++I)F[I]&&F[I].r>F.r&&(F.r=F[I].r)}function z(){if(!!d){var F,I=d.length,O;for(C=new Array(I),F=0;F<I;++F)O=d[F],C[O.index]=+w(O,F,d)}}return k.initialize=function(F){d=F,z()},k.iterations=function(F){return arguments.length?(E=+F,k):E},k.strength=function(F){return arguments.length?(S=+F,k):S},k.radius=function(F){return arguments.length?(w=typeof F=="function"?F:n(+F),z(),k):w},k}function s(w){return w.index}function m(w,d){var C=w.get(d);if(!C)throw new Error("missing: "+d);return C}function g(w){var d=s,C=O,S,E=n(30),k,B,z,F,I=1;w==null&&(w=[]);function O(Z){return 1/Math.min(z[Z.source.index],z[Z.target.index])}function N(Z){for(var X=0,re=w.length;X<I;++X)for(var ue=0,K,te,G,Y,ee,ne,J;ue<re;++ue)K=w[ue],te=K.source,G=K.target,Y=G.x+G.vx-te.x-te.vx||a(),ee=G.y+G.vy-te.y-te.vy||a(),ne=Math.sqrt(Y*Y+ee*ee),ne=(ne-k[ue])/ne*Z*S[ue],Y*=ne,ee*=ne,G.vx-=Y*(J=F[ue]),G.vy-=ee*J,te.vx+=Y*(J=1-J),te.vy+=ee*J}function V(){if(!!B){var Z,X=B.length,re=w.length,ue=A.map(B,d),K;for(Z=0,z=new Array(X);Z<re;++Z)K=w[Z],K.index=Z,typeof K.source!="object"&&(K.source=m(ue,K.source)),typeof K.target!="object"&&(K.target=m(ue,K.target)),z[K.source.index]=(z[K.source.index]||0)+1,z[K.target.index]=(z[K.target.index]||0)+1;for(Z=0,F=new Array(re);Z<re;++Z)K=w[Z],F[Z]=z[K.source.index]/(z[K.source.index]+z[K.target.index]);S=new Array(re),H(),k=new Array(re),j()}}function H(){if(!!B)for(var Z=0,X=w.length;Z<X;++Z)S[Z]=+C(w[Z],Z,w)}function j(){if(!!B)for(var Z=0,X=w.length;Z<X;++Z)k[Z]=+E(w[Z],Z,w)}return N.initialize=function(Z){B=Z,V()},N.links=function(Z){return arguments.length?(w=Z,V(),N):w},N.id=function(Z){return arguments.length?(d=Z,N):d},N.iterations=function(Z){return arguments.length?(I=+Z,N):I},N.strength=function(Z){return arguments.length?(C=typeof Z=="function"?Z:n(+Z),H(),N):C},N.distance=function(Z){return arguments.length?(E=typeof Z=="function"?Z:n(+Z),j(),N):E},N}function p(w){return w.x}function v(w){return w.y}var x=10,l=Math.PI*(3-Math.sqrt(5));function b(w){var d,C=1,S=.001,E=1-Math.pow(S,1/300),k=0,B=.6,z=A.map(),F=e.timer(O),I=T.dispatch("tick","end");w==null&&(w=[]);function O(){N(),I.call("tick",d),C<S&&(F.stop(),I.call("end",d))}function N(j){var Z,X=w.length,re;j===void 0&&(j=1);for(var ue=0;ue<j;++ue)for(C+=(k-C)*E,z.each(function(K){K(C)}),Z=0;Z<X;++Z)re=w[Z],re.fx==null?re.x+=re.vx*=B:(re.x=re.fx,re.vx=0),re.fy==null?re.y+=re.vy*=B:(re.y=re.fy,re.vy=0);return d}function V(){for(var j=0,Z=w.length,X;j<Z;++j){if(X=w[j],X.index=j,X.fx!=null&&(X.x=X.fx),X.fy!=null&&(X.y=X.fy),isNaN(X.x)||isNaN(X.y)){var re=x*Math.sqrt(j),ue=j*l;X.x=re*Math.cos(ue),X.y=re*Math.sin(ue)}(isNaN(X.vx)||isNaN(X.vy))&&(X.vx=X.vy=0)}}function H(j){return j.initialize&&j.initialize(w),j}return V(),d={tick:N,restart:function(){return F.restart(O),d},stop:function(){return F.stop(),d},nodes:function(j){return arguments.length?(w=j,V(),z.each(H),d):w},alpha:function(j){return arguments.length?(C=+j,d):C},alphaMin:function(j){return arguments.length?(S=+j,d):S},alphaDecay:function(j){return arguments.length?(E=+j,d):+E},alphaTarget:function(j){return arguments.length?(k=+j,d):k},velocityDecay:function(j){return arguments.length?(B=1-j,d):1-B},force:function(j,Z){return arguments.length>1?(Z==null?z.remove(j):z.set(j,H(Z)),d):z.get(j)},find:function(j,Z,X){var re=0,ue=w.length,K,te,G,Y,ee;for(X==null?X=1/0:X*=X,re=0;re<ue;++re)Y=w[re],K=j-Y.x,te=Z-Y.y,G=K*K+te*te,G<X&&(ee=Y,X=G);return ee},on:function(j,Z){return arguments.length>1?(I.on(j,Z),d):I.on(j)}}}function c(){var w,d,C,S=n(-30),E,k=1,B=1/0,z=.81;function F(V){var H,j=w.length,Z=u.quadtree(w,p,v).visitAfter(O);for(C=V,H=0;H<j;++H)d=w[H],Z.visit(N)}function I(){if(!!w){var V,H=w.length,j;for(E=new Array(H),V=0;V<H;++V)j=w[V],E[j.index]=+S(j,V,w)}}function O(V){var H=0,j,Z,X=0,re,ue,K;if(V.length){for(re=ue=K=0;K<4;++K)(j=V[K])&&(Z=Math.abs(j.value))&&(H+=j.value,X+=Z,re+=Z*j.x,ue+=Z*j.y);V.x=re/X,V.y=ue/X}else{j=V,j.x=j.data.x,j.y=j.data.y;do H+=E[j.data.index];while(j=j.next)}V.value=H}function N(V,H,j,Z){if(!V.value)return!0;var X=V.x-d.x,re=V.y-d.y,ue=Z-H,K=X*X+re*re;if(ue*ue/z<K)return K<B&&(X===0&&(X=a(),K+=X*X),re===0&&(re=a(),K+=re*re),K<k&&(K=Math.sqrt(k*K)),d.vx+=X*V.value*C/K,d.vy+=re*V.value*C/K),!0;if(V.length||K>=B)return;(V.data!==d||V.next)&&(X===0&&(X=a(),K+=X*X),re===0&&(re=a(),K+=re*re),K<k&&(K=Math.sqrt(k*K)));do V.data!==d&&(ue=E[V.data.index]*C/K,d.vx+=X*ue,d.vy+=re*ue);while(V=V.next)}return F.initialize=function(V){w=V,I()},F.strength=function(V){return arguments.length?(S=typeof V=="function"?V:n(+V),I(),F):S},F.distanceMin=function(V){return arguments.length?(k=V*V,F):Math.sqrt(k)},F.distanceMax=function(V){return arguments.length?(B=V*V,F):Math.sqrt(B)},F.theta=function(V){return arguments.length?(z=V*V,F):Math.sqrt(z)},F}function M(w,d,C){var S,E=n(.1),k,B;typeof w!="function"&&(w=n(+w)),d==null&&(d=0),C==null&&(C=0);function z(I){for(var O=0,N=S.length;O<N;++O){var V=S[O],H=V.x-d||1e-6,j=V.y-C||1e-6,Z=Math.sqrt(H*H+j*j),X=(B[O]-Z)*k[O]*I/Z;V.vx+=H*X,V.vy+=j*X}}function F(){if(!!S){var I,O=S.length;for(k=new Array(O),B=new Array(O),I=0;I<O;++I)B[I]=+w(S[I],I,S),k[I]=isNaN(B[I])?0:+E(S[I],I,S)}}return z.initialize=function(I){S=I,F()},z.strength=function(I){return arguments.length?(E=typeof I=="function"?I:n(+I),F(),z):E},z.radius=function(I){return arguments.length?(w=typeof I=="function"?I:n(+I),F(),z):w},z.x=function(I){return arguments.length?(d=+I,z):d},z.y=function(I){return arguments.length?(C=+I,z):C},z}function _(w){var d=n(.1),C,S,E;typeof w!="function"&&(w=n(w==null?0:+w));function k(z){for(var F=0,I=C.length,O;F<I;++F)O=C[F],O.vx+=(E[F]-O.x)*S[F]*z}function B(){if(!!C){var z,F=C.length;for(S=new Array(F),E=new Array(F),z=0;z<F;++z)S[z]=isNaN(E[z]=+w(C[z],z,C))?0:+d(C[z],z,C)}}return k.initialize=function(z){C=z,B()},k.strength=function(z){return arguments.length?(d=typeof z=="function"?z:n(+z),B(),k):d},k.x=function(z){return arguments.length?(w=typeof z=="function"?z:n(+z),B(),k):w},k}function y(w){var d=n(.1),C,S,E;typeof w!="function"&&(w=n(w==null?0:+w));function k(z){for(var F=0,I=C.length,O;F<I;++F)O=C[F],O.vy+=(E[F]-O.y)*S[F]*z}function B(){if(!!C){var z,F=C.length;for(S=new Array(F),E=new Array(F),z=0;z<F;++z)S[z]=isNaN(E[z]=+w(C[z],z,C))?0:+d(C[z],z,C)}}return k.initialize=function(z){C=z,B()},k.strength=function(z){return arguments.length?(d=typeof z=="function"?z:n(+z),B(),k):d},k.y=function(z){return arguments.length?(w=typeof z=="function"?z:n(+z),B(),k):w},k}h.forceCenter=i,h.forceCollide=o,h.forceLink=g,h.forceManyBody=c,h.forceRadial=M,h.forceSimulation=b,h.forceX=_,h.forceY=y,Object.defineProperty(h,"__esModule",{value:!0})})},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R):(h=typeof globalThis<"u"?globalThis:h||self,u(h.d3=h.d3||{}))})(this,function(h){function u(w){return Math.abs(w=Math.round(w))>=1e21?w.toLocaleString("en").replace(/,/g,""):w.toString(10)}function A(w,d){if((C=(w=d?w.toExponential(d-1):w.toExponential()).indexOf("e"))<0)return null;var C,S=w.slice(0,C);return[S.length>1?S[0]+S.slice(2):S,+w.slice(C+1)]}function T(w){return w=A(Math.abs(w)),w?w[1]:NaN}function e(w,d){return function(C,S){for(var E=C.length,k=[],B=0,z=w[0],F=0;E>0&&z>0&&(F+z+1>S&&(z=Math.max(1,S-F)),k.push(C.substring(E-=z,E+z)),!((F+=z+1)>S));)z=w[B=(B+1)%w.length];return k.reverse().join(d)}}function i(w){return function(d){return d.replace(/[0-9]/g,function(C){return w[+C]})}}var n=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function a(w){if(!(d=n.exec(w)))throw new Error("invalid format: "+w);var d;return new r({fill:d[1],align:d[2],sign:d[3],symbol:d[4],zero:d[5],width:d[6],comma:d[7],precision:d[8]&&d[8].slice(1),trim:d[9],type:d[10]})}a.prototype=r.prototype;function r(w){this.fill=w.fill===void 0?" ":w.fill+"",this.align=w.align===void 0?">":w.align+"",this.sign=w.sign===void 0?"-":w.sign+"",this.symbol=w.symbol===void 0?"":w.symbol+"",this.zero=!!w.zero,this.width=w.width===void 0?void 0:+w.width,this.comma=!!w.comma,this.precision=w.precision===void 0?void 0:+w.precision,this.trim=!!w.trim,this.type=w.type===void 0?"":w.type+""}r.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function f(w){e:for(var d=w.length,C=1,S=-1,E;C<d;++C)switch(w[C]){case".":S=E=C;break;case"0":S===0&&(S=C),E=C;break;default:if(!+w[C])break e;S>0&&(S=0);break}return S>0?w.slice(0,S)+w.slice(E+1):w}var o;function s(w,d){var C=A(w,d);if(!C)return w+"";var S=C[0],E=C[1],k=E-(o=Math.max(-8,Math.min(8,Math.floor(E/3)))*3)+1,B=S.length;return k===B?S:k>B?S+new Array(k-B+1).join("0"):k>0?S.slice(0,k)+"."+S.slice(k):"0."+new Array(1-k).join("0")+A(w,Math.max(0,d+k-1))[0]}function m(w,d){var C=A(w,d);if(!C)return w+"";var S=C[0],E=C[1];return E<0?"0."+new Array(-E).join("0")+S:S.length>E+1?S.slice(0,E+1)+"."+S.slice(E+1):S+new Array(E-S.length+2).join("0")}var g={"%":function(w,d){return(w*100).toFixed(d)},b:function(w){return Math.round(w).toString(2)},c:function(w){return w+""},d:u,e:function(w,d){return w.toExponential(d)},f:function(w,d){return w.toFixed(d)},g:function(w,d){return w.toPrecision(d)},o:function(w){return Math.round(w).toString(8)},p:function(w,d){return m(w*100,d)},r:m,s,X:function(w){return Math.round(w).toString(16).toUpperCase()},x:function(w){return Math.round(w).toString(16)}};function p(w){return w}var v=Array.prototype.map,x=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function l(w){var d=w.grouping===void 0||w.thousands===void 0?p:e(v.call(w.grouping,Number),w.thousands+""),C=w.currency===void 0?"":w.currency[0]+"",S=w.currency===void 0?"":w.currency[1]+"",E=w.decimal===void 0?".":w.decimal+"",k=w.numerals===void 0?p:i(v.call(w.numerals,String)),B=w.percent===void 0?"%":w.percent+"",z=w.minus===void 0?"-":w.minus+"",F=w.nan===void 0?"NaN":w.nan+"";function I(N){N=a(N);var V=N.fill,H=N.align,j=N.sign,Z=N.symbol,X=N.zero,re=N.width,ue=N.comma,K=N.precision,te=N.trim,G=N.type;G==="n"?(ue=!0,G="g"):g[G]||(K===void 0&&(K=12),te=!0,G="g"),(X||V==="0"&&H==="=")&&(X=!0,V="0",H="=");var Y=Z==="$"?C:Z==="#"&&/[boxX]/.test(G)?"0"+G.toLowerCase():"",ee=Z==="$"?S:/[%p]/.test(G)?B:"",ne=g[G],J=/[defgprs%]/.test(G);K=K===void 0?6:/[gprs]/.test(G)?Math.max(1,Math.min(21,K)):Math.max(0,Math.min(20,K));function q(ae){var le=Y,ie=ee,se,xe,oe;if(G==="c")ie=ne(ae)+ie,ae="";else{ae=+ae;var he=ae<0||1/ae<0;if(ae=isNaN(ae)?F:ne(Math.abs(ae),K),te&&(ae=f(ae)),he&&+ae==0&&j!=="+"&&(he=!1),le=(he?j==="("?j:z:j==="-"||j==="("?"":j)+le,ie=(G==="s"?x[8+o/3]:"")+ie+(he&&j==="("?")":""),J){for(se=-1,xe=ae.length;++se<xe;)if(oe=ae.charCodeAt(se),48>oe||oe>57){ie=(oe===46?E+ae.slice(se+1):ae.slice(se))+ie,ae=ae.slice(0,se);break}}}ue&&!X&&(ae=d(ae,1/0));var be=le.length+ae.length+ie.length,me=be<re?new Array(re-be+1).join(V):"";switch(ue&&X&&(ae=d(me+ae,me.length?re-ie.length:1/0),me=""),H){case"<":ae=le+ae+ie+me;break;case"=":ae=le+me+ae+ie;break;case"^":ae=me.slice(0,be=me.length>>1)+le+ae+ie+me.slice(be);break;default:ae=me+le+ae+ie;break}return k(ae)}return q.toString=function(){return N+""},q}function O(N,V){var H=I((N=a(N),N.type="f",N)),j=Math.max(-8,Math.min(8,Math.floor(T(V)/3)))*3,Z=Math.pow(10,-j),X=x[8+j/3];return function(re){return H(Z*re)+X}}return{format:I,formatPrefix:O}}var b;c({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function c(w){return b=l(w),h.format=b.format,h.formatPrefix=b.formatPrefix,b}function M(w){return Math.max(0,-T(Math.abs(w)))}function _(w,d){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(T(d)/3)))*3-T(Math.abs(w)))}function y(w,d){return w=Math.abs(w),d=Math.abs(d)-w,Math.max(0,T(d)-T(w))+1}h.FormatSpecifier=r,h.formatDefaultLocale=c,h.formatLocale=l,h.formatSpecifier=a,h.precisionFixed=M,h.precisionPrefix=_,h.precisionRound=y,Object.defineProperty(h,"__esModule",{value:!0})})},{}],113:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R,t("d3-geo"),t("d3-array")):u(h.d3=h.d3||{},h.d3,h.d3)})(this,function(h,u,A){var T=Math.abs,e=Math.atan,i=Math.atan2,n=Math.cos,a=Math.exp,r=Math.floor,f=Math.log,o=Math.max,s=Math.min,m=Math.pow,g=Math.round,p=Math.sign||function(Ne){return Ne>0?1:Ne<0?-1:0},v=Math.sin,x=Math.tan,l=1e-6,b=1e-12,c=Math.PI,M=c/2,_=c/4,y=Math.SQRT1_2,w=F(2),d=F(c),C=c*2,S=180/c,E=c/180;function k(Ne){return Ne?Ne/Math.sin(Ne):1}function B(Ne){return Ne>1?M:Ne<-1?-M:Math.asin(Ne)}function z(Ne){return Ne>1?0:Ne<-1?c:Math.acos(Ne)}function F(Ne){return Ne>0?Math.sqrt(Ne):0}function I(Ne){return Ne=a(2*Ne),(Ne-1)/(Ne+1)}function O(Ne){return(a(Ne)-a(-Ne))/2}function N(Ne){return(a(Ne)+a(-Ne))/2}function V(Ne){return f(Ne+F(Ne*Ne+1))}function H(Ne){return f(Ne+F(Ne*Ne-1))}function j(Ne){var je=x(Ne/2),rt=2*f(n(Ne/2))/(je*je);function lt(wt,bt){var kt=n(wt),hr=n(bt),gr=v(bt),fr=hr*kt,_r=-((1-fr?f((1+fr)/2)/(1-fr):-.5)+rt/(1+fr));return[_r*hr*v(wt),_r*gr]}return lt.invert=function(wt,bt){var kt=F(wt*wt+bt*bt),hr=-Ne/2,gr=50,fr;if(!kt)return[0,0];do{var _r=hr/2,Rr=n(_r),jr=v(_r),tn=jr/Rr,wn=-f(T(Rr));hr-=fr=(2/tn*wn-rt*tn-kt)/(-wn/(jr*jr)+1-rt/(2*Rr*Rr))*(Rr<0?.7:1)}while(T(fr)>l&&--gr>0);var Rn=v(hr);return[i(wt*Rn,kt*n(hr)),B(bt*Rn/kt)]},lt}function Z(){var Ne=M,je=u.geoProjectionMutator(j),rt=je(Ne);return rt.radius=function(lt){return arguments.length?je(Ne=lt*E):Ne*S},rt.scale(179.976).clipAngle(147)}function X(Ne,je){var rt=n(je),lt=k(z(rt*n(Ne/=2)));return[2*rt*v(Ne)*lt,v(je)*lt]}X.invert=function(Ne,je){if(!(Ne*Ne+4*je*je>c*c+l)){var rt=Ne,lt=je,wt=25;do{var bt=v(rt),kt=v(rt/2),hr=n(rt/2),gr=v(lt),fr=n(lt),_r=v(2*lt),Rr=gr*gr,jr=fr*fr,tn=kt*kt,wn=1-jr*hr*hr,Rn=wn?z(fr*hr)*F(Zn=1/wn):Zn=0,Zn,xa=2*Rn*fr*kt-Ne,wa=Rn*gr-je,qa=Zn*(jr*tn+Rn*fr*hr*Rr),ja=Zn*(.5*bt*_r-Rn*2*gr*kt),ai=Zn*.25*(_r*kt-Rn*gr*jr*bt),mi=Zn*(Rr*hr+Rn*tn*fr),po=ja*ai-mi*qa;if(!po)break;var oi=(wa*ja-xa*mi)/po,$i=(xa*ai-wa*qa)/po;rt-=oi,lt-=$i}while((T(oi)>l||T($i)>l)&&--wt>0);return[rt,lt]}};function re(){return u.geoProjection(X).scale(152.63)}function ue(Ne){var je=v(Ne),rt=n(Ne),lt=Ne>=0?1:-1,wt=x(lt*Ne),bt=(1+je-rt)/2;function kt(hr,gr){var fr=n(gr),_r=n(hr/=2);return[(1+fr)*v(hr),(lt*gr>-i(_r,wt)-.001?0:-lt*10)+bt+v(gr)*rt-(1+fr)*je*_r]}return kt.invert=function(hr,gr){var fr=0,_r=0,Rr=50;do{var jr=n(fr),tn=v(fr),wn=n(_r),Rn=v(_r),Zn=1+wn,xa=Zn*tn-hr,wa=bt+Rn*rt-Zn*je*jr-gr,qa=Zn*jr/2,ja=-tn*Rn,ai=je*Zn*tn/2,mi=rt*wn+je*jr*Rn,po=ja*ai-mi*qa,oi=(wa*ja-xa*mi)/po/2,$i=(xa*ai-wa*qa)/po;T($i)>2&&($i/=2),fr-=oi,_r-=$i}while((T(oi)>l||T($i)>l)&&--Rr>0);return lt*_r>-i(n(fr),wt)-.001?[fr*2,_r]:null},kt}function K(){var Ne=20*E,je=Ne>=0?1:-1,rt=x(je*Ne),lt=u.geoProjectionMutator(ue),wt=lt(Ne),bt=wt.stream;return wt.parallel=function(kt){return arguments.length?(rt=x((je=(Ne=kt*E)>=0?1:-1)*Ne),lt(Ne)):Ne*S},wt.stream=function(kt){var hr=wt.rotate(),gr=bt(kt),fr=(wt.rotate([0,0]),bt(kt)),_r=wt.precision();return wt.rotate(hr),gr.sphere=function(){fr.polygonStart(),fr.lineStart();for(var Rr=je*-180;je*Rr<180;Rr+=je*90)fr.point(Rr,je*90);if(Ne)for(;je*(Rr-=3*je*_r)>=-180;)fr.point(Rr,je*-i(n(Rr*E/2),rt)*S);fr.lineEnd(),fr.polygonEnd()},gr},wt.scale(218.695).center([0,28.0974])}function te(Ne,je){var rt=x(je/2),lt=F(1-rt*rt),wt=1+lt*n(Ne/=2),bt=v(Ne)*lt/wt,kt=rt/wt,hr=bt*bt,gr=kt*kt;return[4/3*bt*(3+hr-3*gr),4/3*kt*(3+3*hr-gr)]}te.invert=function(Ne,je){if(Ne*=3/8,je*=3/8,!Ne&&T(je)>1)return null;var rt=Ne*Ne,lt=je*je,wt=1+rt+lt,bt=F((wt-F(wt*wt-4*je*je))/2),kt=B(bt)/3,hr=bt?H(T(je/bt))/3:V(T(Ne))/3,gr=n(kt),fr=N(hr),_r=fr*fr-gr*gr;return[p(Ne)*2*i(O(hr)*gr,.25-_r),p(je)*2*i(fr*v(kt),.25+_r)]};function G(){return u.geoProjection(te).scale(66.1603)}var Y=F(8),ee=f(1+w);function ne(Ne,je){var rt=T(je);return rt<_?[Ne,f(x(_+je/2))]:[Ne*n(rt)*(2*w-1/v(rt)),p(je)*(2*w*(rt-_)-f(x(rt/2)))]}ne.invert=function(Ne,je){if((bt=T(je))<ee)return[Ne,2*e(a(je))-M];var rt=_,lt=25,wt,bt;do{var kt=n(rt/2),hr=x(rt/2);rt-=wt=(Y*(rt-_)-f(hr)-bt)/(Y-kt*kt/(2*hr))}while(T(wt)>b&&--lt>0);return[Ne/(n(rt)*(Y-1/v(rt))),p(je)*rt]};function J(){return u.geoProjection(ne).scale(112.314)}function q(Ne){var je=2*c/Ne;function rt(lt,wt){var bt=u.geoAzimuthalEquidistantRaw(lt,wt);if(T(lt)>M){var kt=i(bt[1],bt[0]),hr=F(bt[0]*bt[0]+bt[1]*bt[1]),gr=je*g((kt-M)/je)+M,fr=i(v(kt-=gr),2-n(kt));kt=gr+B(c/hr*v(fr))-fr,bt[0]=hr*n(kt),bt[1]=hr*v(kt)}return bt}return rt.invert=function(lt,wt){var bt=F(lt*lt+wt*wt);if(bt>M){var kt=i(wt,lt),hr=je*g((kt-M)/je)+M,gr=kt>hr?-1:1,fr=bt*n(hr-kt),_r=1/x(gr*z((fr-c)/F(c*(c-2*fr)+bt*bt)));kt=hr+2*e((_r+gr*F(_r*_r-3))/3),lt=bt*n(kt),wt=bt*v(kt)}return u.geoAzimuthalEquidistantRaw.invert(lt,wt)},rt}function ae(){var Ne=5,je=u.geoProjectionMutator(q),rt=je(Ne),lt=rt.stream,wt=.01,bt=-n(wt*E),kt=v(wt*E);return rt.lobes=function(hr){return arguments.length?je(Ne=+hr):Ne},rt.stream=function(hr){var gr=rt.rotate(),fr=lt(hr),_r=(rt.rotate([0,0]),lt(hr));return rt.rotate(gr),fr.sphere=function(){_r.polygonStart(),_r.lineStart();for(var Rr=0,jr=360/Ne,tn=2*c/Ne,wn=90-180/Ne,Rn=M;Rr<Ne;++Rr,wn-=jr,Rn-=tn)_r.point(i(kt*n(Rn),bt)*S,B(kt*v(Rn))*S),wn<-90?(_r.point(-90,-180-wn-wt),_r.point(-90,-180-wn+wt)):(_r.point(90,wn+wt),_r.point(90,wn-wt));_r.lineEnd(),_r.polygonEnd()},fr},rt.scale(87.8076).center([0,17.1875]).clipAngle(180-.001)}function le(Ne,je){if(arguments.length<2&&(je=Ne),je===1)return u.geoAzimuthalEqualAreaRaw;if(je===1/0)return ie;function rt(lt,wt){var bt=u.geoAzimuthalEqualAreaRaw(lt/je,wt);return bt[0]*=Ne,bt}return rt.invert=function(lt,wt){var bt=u.geoAzimuthalEqualAreaRaw.invert(lt/Ne,wt);return bt[0]*=je,bt},rt}function ie(Ne,je){return[Ne*n(je)/n(je/=2),2*v(je)]}ie.invert=function(Ne,je){var rt=2*B(je/2);return[Ne*n(rt/2)/n(rt),rt]};function se(){var Ne=2,je=u.geoProjectionMutator(le),rt=je(Ne);return rt.coefficient=function(lt){return arguments.length?je(Ne=+lt):Ne},rt.scale(169.529)}function xe(Ne,je,rt){var lt=100,wt,bt,kt;rt=rt===void 0?0:+rt,je=+je;do bt=Ne(rt),kt=Ne(rt+l),bt===kt&&(kt=bt+l),rt-=wt=-1*l*(bt-je)/(bt-kt);while(lt-- >0&&T(wt)>l);return lt<0?NaN:rt}function oe(Ne,je,rt){return je===void 0&&(je=40),rt===void 0&&(rt=b),function(lt,wt,bt,kt){var hr,gr,fr;bt=bt===void 0?0:+bt,kt=kt===void 0?0:+kt;for(var _r=0;_r<je;_r++){var Rr=Ne(bt,kt),jr=Rr[0]-lt,tn=Rr[1]-wt;if(T(jr)<rt&&T(tn)<rt)break;var wn=jr*jr+tn*tn;if(wn>hr){bt-=gr/=2,kt-=fr/=2;continue}hr=wn;var Rn=(bt>0?-1:1)*rt,Zn=(kt>0?-1:1)*rt,xa=Ne(bt+Rn,kt),wa=Ne(bt,kt+Zn),qa=(xa[0]-Rr[0])/Rn,ja=(xa[1]-Rr[1])/Rn,ai=(wa[0]-Rr[0])/Zn,mi=(wa[1]-Rr[1])/Zn,po=mi*qa-ja*ai,oi=(T(po)<.5?.5:1)/po;if(gr=(tn*ai-jr*mi)*oi,fr=(jr*ja-tn*qa)*oi,bt+=gr,kt+=fr,T(gr)<rt&&T(fr)<rt)break}return[bt,kt]}}function he(){var Ne=le(1.68,2),je=1.4,rt=12;function lt(wt,bt){if(wt+bt<-je){var kt=(wt-bt+1.6)*(wt+bt+je)/8;wt+=kt,bt-=.8*kt*v(bt+c/2)}var hr=Ne(wt,bt),gr=(1-n(wt*bt))/rt;return hr[1]<0&&(hr[0]*=1+gr),hr[1]>0&&(hr[1]*=1+gr/1.5*hr[0]*hr[0]),hr}return lt.invert=oe(lt),lt}function be(){return u.geoProjection(he()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])}function me(Ne,je){var rt=Ne*v(je),lt=30,wt;do je-=wt=(je+v(je)-rt)/(1+n(je));while(T(wt)>l&&--lt>0);return je/2}function _e(Ne,je,rt){function lt(wt,bt){return[Ne*wt*n(bt=me(rt,bt)),je*v(bt)]}return lt.invert=function(wt,bt){return bt=B(bt/je),[wt/(Ne*n(bt)),B((2*bt+v(2*bt))/rt)]},lt}var Se=_e(w/M,w,c);function De(){return u.geoProjection(Se).scale(169.529)}var Ie=2.00276,Te=1.11072;function Ce(Ne,je){var rt=me(c,je);return[Ie*Ne/(1/n(je)+Te/n(rt)),(je+w*v(rt))/Ie]}Ce.invert=function(Ne,je){var rt=Ie*je,lt=je<0?-_:_,wt=25,bt,kt;do kt=rt-w*v(lt),lt-=bt=(v(2*lt)+2*lt-c*v(kt))/(2*n(2*lt)+2+c*n(kt)*w*n(lt));while(T(bt)>l&&--wt>0);return kt=rt-w*v(lt),[Ne*(1/n(kt)+Te/n(lt))/Ie,kt]};function He(){return u.geoProjection(Ce).scale(160.857)}function Xe(Ne){var je=0,rt=u.geoProjectionMutator(Ne),lt=rt(je);return lt.parallel=function(wt){return arguments.length?rt(je=wt*E):je*S},lt}function Be(Ne,je){return[Ne*n(je),je]}Be.invert=function(Ne,je){return[Ne/n(je),je]};function Re(){return u.geoProjection(Be).scale(152.63)}function We(Ne){if(!Ne)return Be;var je=1/x(Ne);function rt(lt,wt){var bt=je+Ne-wt,kt=bt&&lt*n(wt)/bt;return[bt*v(kt),je-bt*n(kt)]}return rt.invert=function(lt,wt){var bt=F(lt*lt+(wt=je-wt)*wt),kt=je+Ne-bt;return[bt/n(kt)*i(lt,wt),kt]},rt}function vt(){return Xe(We).scale(123.082).center([0,26.1441]).parallel(45)}function Pt(Ne){function je(rt,lt){var wt=M-lt,bt=wt&&rt*Ne*v(wt)/wt;return[wt*v(bt)/Ne,M-wt*n(bt)]}return je.invert=function(rt,lt){var wt=rt*Ne,bt=M-lt,kt=F(wt*wt+bt*bt),hr=i(wt,bt);return[(kt?kt/v(kt):1)*hr/Ne,M-kt]},je}function Zt(){var Ne=.5,je=u.geoProjectionMutator(Pt),rt=je(Ne);return rt.fraction=function(lt){return arguments.length?je(Ne=+lt):Ne},rt.scale(158.837)}var zt=_e(1,4/c,c);function At(){return u.geoProjection(zt).scale(152.63)}function Wt(Ne,je,rt,lt,wt,bt){var kt=n(bt),hr;if(T(Ne)>1||T(bt)>1)hr=z(rt*wt+je*lt*kt);else{var gr=v(Ne/2),fr=v(bt/2);hr=2*B(F(gr*gr+je*lt*fr*fr))}return T(hr)>l?[hr,i(lt*v(bt),je*wt-rt*lt*kt)]:[0,0]}function Bt(Ne,je,rt){return z((Ne*Ne+je*je-rt*rt)/(2*Ne*je))}function Ct(Ne){return Ne-2*c*r((Ne+c)/(2*c))}function Ze(Ne,je,rt){for(var lt=[[Ne[0],Ne[1],v(Ne[1]),n(Ne[1])],[je[0],je[1],v(je[1]),n(je[1])],[rt[0],rt[1],v(rt[1]),n(rt[1])]],wt=lt[2],bt,kt=0;kt<3;++kt,wt=bt)bt=lt[kt],wt.v=Wt(bt[1]-wt[1],wt[3],wt[2],bt[3],bt[2],bt[0]-wt[0]),wt.point=[0,0];var hr=Bt(lt[0].v[0],lt[2].v[0],lt[1].v[0]),gr=Bt(lt[0].v[0],lt[1].v[0],lt[2].v[0]),fr=c-hr;lt[2].point[1]=0,lt[0].point[0]=-(lt[1].point[0]=lt[0].v[0]/2);var _r=[lt[2].point[0]=lt[0].point[0]+lt[2].v[0]*n(hr),2*(lt[0].point[1]=lt[1].point[1]=lt[2].v[0]*v(hr))];function Rr(jr,tn){var wn=v(tn),Rn=n(tn),Zn=new Array(3),xa;for(xa=0;xa<3;++xa){var wa=lt[xa];if(Zn[xa]=Wt(tn-wa[1],wa[3],wa[2],Rn,wn,jr-wa[0]),!Zn[xa][0])return wa.point;Zn[xa][1]=Ct(Zn[xa][1]-wa.v[1])}var qa=_r.slice();for(xa=0;xa<3;++xa){var ja=xa==2?0:xa+1,ai=Bt(lt[xa].v[0],Zn[xa][0],Zn[ja][0]);Zn[xa][1]<0&&(ai=-ai),xa?xa==1?(ai=gr-ai,qa[0]-=Zn[xa][0]*n(ai),qa[1]-=Zn[xa][0]*v(ai)):(ai=fr-ai,qa[0]+=Zn[xa][0]*n(ai),qa[1]+=Zn[xa][0]*v(ai)):(qa[0]+=Zn[xa][0]*n(ai),qa[1]-=Zn[xa][0]*v(ai))}return qa[0]/=3,qa[1]/=3,qa}return Rr}function nt(Ne){return Ne[0]*=E,Ne[1]*=E,Ne}function Ye(){return Ee([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])}function Ee(Ne,je,rt){var lt=u.geoCentroid({type:"MultiPoint",coordinates:[Ne,je,rt]}),wt=[-lt[0],-lt[1]],bt=u.geoRotation(wt),kt=Ze(nt(bt(Ne)),nt(bt(je)),nt(bt(rt)));kt.invert=oe(kt);var hr=u.geoProjection(kt).rotate(wt),gr=hr.center;return delete hr.rotate,hr.center=function(fr){return arguments.length?gr(bt(fr)):bt.invert(gr())},hr.clipAngle(90)}function Ge(Ne,je){var rt=F(1-v(je));return[2/d*Ne*rt,d*(1-rt)]}Ge.invert=function(Ne,je){var rt=(rt=je/d-1)*rt;return[rt>0?Ne*F(c/rt)/2:0,B(1-rt)]};function Je(){return u.geoProjection(Ge).scale(95.6464).center([0,30])}function qe(Ne){var je=x(Ne);function rt(lt,wt){return[lt,(lt?lt/v(lt):1)*(v(wt)*n(lt)-je*n(wt))]}return rt.invert=je?function(lt,wt){lt&&(wt*=v(lt)/lt);var bt=n(lt);return[lt,2*i(F(bt*bt+je*je-wt*wt)-bt,je-wt)]}:function(lt,wt){return[lt,B(lt?wt*x(lt)/lt:wt)]},rt}function Tt(){return Xe(qe).scale(249.828).clipAngle(90)}var mt=F(3);function Mt(Ne,je){return[mt*Ne*(2*n(2*je/3)-1)/d,mt*d*v(je/3)]}Mt.invert=function(Ne,je){var rt=3*B(je/(mt*d));return[d*Ne/(mt*(2*n(2*rt/3)-1)),rt]};function Ht(){return u.geoProjection(Mt).scale(156.19)}function Rt(Ne){var je=n(Ne);function rt(lt,wt){return[lt*je,v(wt)/je]}return rt.invert=function(lt,wt){return[lt/je,B(wt*je)]},rt}function Vt(){return Xe(Rt).parallel(38.58).scale(195.044)}function Jt(Ne){var je=n(Ne);function rt(lt,wt){return[lt*je,(1+je)*x(wt/2)]}return rt.invert=function(lt,wt){return[lt/je,e(wt/(1+je))*2]},rt}function Yt(){return Xe(Jt).scale(124.75)}function or(Ne,je){var rt=F(8/(3*c));return[rt*Ne*(1-T(je)/c),rt*je]}or.invert=function(Ne,je){var rt=F(8/(3*c)),lt=je/rt;return[Ne/(rt*(1-T(lt)/c)),lt]};function Hr(){return u.geoProjection(or).scale(165.664)}function an(Ne,je){var rt=F(4-3*v(T(je)));return[2/F(6*c)*Ne*rt,p(je)*F(2*c/3)*(2-rt)]}an.invert=function(Ne,je){var rt=2-T(je)/F(2*c/3);return[Ne*F(6*c)/(2*rt),p(je)*B((4-rt*rt)/3)]};function Kr(){return u.geoProjection(an).scale(165.664)}function ot(Ne,je){var rt=F(c*(4+c));return[2/rt*Ne*(1+F(1-4*je*je/(c*c))),4/rt*je]}ot.invert=function(Ne,je){var rt=F(c*(4+c))/2;return[Ne*rt/(1+F(1-je*je*(4+c)/(4*c))),je*rt/2]};function er(){return u.geoProjection(ot).scale(180.739)}function Kt(Ne,je){var rt=(2+M)*v(je);je/=2;for(var lt=0,wt=1/0;lt<10&&T(wt)>l;lt++){var bt=n(je);je-=wt=(je+v(je)*(bt+2)-rt)/(2*bt*(1+bt))}return[2/F(c*(4+c))*Ne*(1+n(je)),2*F(c/(4+c))*v(je)]}Kt.invert=function(Ne,je){var rt=je*F((4+c)/c)/2,lt=B(rt),wt=n(lt);return[Ne/(2/F(c*(4+c))*(1+wt)),B((lt+rt*(wt+2))/(2+M))]};function ur(){return u.geoProjection(Kt).scale(180.739)}function Ar(Ne,je){return[Ne*(1+n(je))/F(2+c),2*je/F(2+c)]}Ar.invert=function(Ne,je){var rt=F(2+c),lt=je*rt/2;return[rt*Ne/(1+n(lt)),lt]};function et(){return u.geoProjection(Ar).scale(173.044)}function $e(Ne,je){for(var rt=(1+M)*v(je),lt=0,wt=1/0;lt<10&&T(wt)>l;lt++)je-=wt=(je+v(je)-rt)/(1+n(je));return rt=F(2+c),[Ne*(1+n(je))/rt,2*je/rt]}$e.invert=function(Ne,je){var rt=1+M,lt=F(rt/2);return[Ne*2*lt/(1+n(je*=lt)),B((je+v(je))/rt)]};function st(){return u.geoProjection($e).scale(173.044)}var ft=3+2*w;function St(Ne,je){var rt=v(Ne/=2),lt=n(Ne),wt=F(n(je)),bt=n(je/=2),kt=v(je)/(bt+w*lt*wt),hr=F(2/(1+kt*kt)),gr=F((w*bt+(lt+rt)*wt)/(w*bt+(lt-rt)*wt));return[ft*(hr*(gr-1/gr)-2*f(gr)),ft*(hr*kt*(gr+1/gr)-2*e(kt))]}St.invert=function(Ne,je){if(!(bt=te.invert(Ne/1.2,je*1.065)))return null;var rt=bt[0],lt=bt[1],wt=20,bt;Ne/=ft,je/=ft;do{var kt=rt/2,hr=lt/2,gr=v(kt),fr=n(kt),_r=v(hr),Rr=n(hr),jr=n(lt),tn=F(jr),wn=_r/(Rr+w*fr*tn),Rn=wn*wn,Zn=F(2/(1+Rn)),xa=w*Rr+(fr+gr)*tn,wa=w*Rr+(fr-gr)*tn,qa=xa/wa,ja=F(qa),ai=ja-1/ja,mi=ja+1/ja,po=Zn*ai-2*f(ja)-Ne,oi=Zn*wn*mi-2*e(wn)-je,$i=_r&&y*tn*gr*Rn/_r,_o=(w*fr*Rr+tn)/(2*(Rr+w*fr*tn)*(Rr+w*fr*tn)*tn),Ro=-.5*wn*Zn*Zn*Zn,Ci=Ro*$i,Ri=Ro*_o,ks=(ks=2*Rr+w*tn*(fr-gr))*ks*ja,Eo=(w*fr*Rr*tn+jr)/ks,Yo=-(w*gr*_r)/(tn*ks),os=ai*Ci-2*Eo/ja+Zn*(Eo+Eo/qa),fe=ai*Ri-2*Yo/ja+Zn*(Yo+Yo/qa),Ae=wn*mi*Ci-2*$i/(1+Rn)+Zn*mi*$i+Zn*wn*(Eo-Eo/qa),Fe=wn*mi*Ri-2*_o/(1+Rn)+Zn*mi*_o+Zn*wn*(Yo-Yo/qa),Ve=fe*Ae-Fe*os;if(!Ve)break;var Ue=(oi*fe-po*Fe)/Ve,Qe=(po*Ae-oi*os)/Ve;rt-=Ue,lt=o(-M,s(M,lt-Qe))}while((T(Ue)>l||T(Qe)>l)&&--wt>0);return T(T(lt)-M)<l?[0,lt]:wt&&[rt,lt]};function Ut(){return u.geoProjection(St).scale(62.5271)}var Pe=n(35*E);function ke(Ne,je){var rt=x(je/2);return[Ne*Pe*F(1-rt*rt),(1+Pe)*rt]}ke.invert=function(Ne,je){var rt=je/(1+Pe);return[Ne&&Ne/(Pe*F(1-rt*rt)),2*e(rt)]};function it(){return u.geoProjection(ke).scale(137.152)}function ut(Ne,je){var rt=je/2,lt=n(rt);return[2*Ne/d*n(je)*lt*lt,d*x(rt)]}ut.invert=function(Ne,je){var rt=e(je/d),lt=n(rt),wt=2*rt;return[Ne*d/2/(n(wt)*lt*lt),wt]};function ht(){return u.geoProjection(ut).scale(135.264)}function Et(Ne){var je=1-Ne,rt=bt(c,0)[0]-bt(-c,0)[0],lt=bt(0,M)[1]-bt(0,-M)[1],wt=F(2*lt/rt);function bt(gr,fr){var _r=n(fr),Rr=v(fr);return[_r/(je+Ne*_r)*gr,je*fr+Ne*Rr]}function kt(gr,fr){var _r=bt(gr,fr);return[_r[0]*wt,_r[1]/wt]}function hr(gr){return kt(0,gr)[1]}return kt.invert=function(gr,fr){var _r=xe(hr,fr),Rr=gr/wt*(Ne+je/n(_r));return[Rr,_r]},kt}function yt(){var Ne=.5,je=u.geoProjectionMutator(Et),rt=je(Ne);return rt.alpha=function(lt){return arguments.length?je(Ne=+lt):Ne},rt.scale(168.725)}function Dt(Ne){return[Ne[0]/2,B(x(Ne[1]/2*E))*S]}function Xt(Ne){return[Ne[0]*2,2*e(v(Ne[1]*E))*S]}function ar(Ne){Ne==null&&(Ne=u.geoOrthographic);var je=Ne(),rt=u.geoEquirectangular().scale(S).precision(0).clipAngle(null).translate([0,0]);function lt(bt){return je(Dt(bt))}je.invert&&(lt.invert=function(bt){return Xt(je.invert(bt))}),lt.stream=function(bt){var kt=je.stream(bt),hr=rt.stream({point:function(gr,fr){kt.point(gr/2,B(x(-fr/2*E))*S)},lineStart:function(){kt.lineStart()},lineEnd:function(){kt.lineEnd()},polygonStart:function(){kt.polygonStart()},polygonEnd:function(){kt.polygonEnd()}});return hr.sphere=kt.sphere,hr};function wt(bt){lt[bt]=function(){return arguments.length?(je[bt].apply(je,arguments),lt):je[bt]()}}return lt.rotate=function(bt){return arguments.length?(rt.rotate(bt),lt):rt.rotate()},lt.center=function(bt){return arguments.length?(je.center(Dt(bt)),lt):Xt(je.center())},wt("angle"),wt("clipAngle"),wt("clipExtent"),wt("fitExtent"),wt("fitHeight"),wt("fitSize"),wt("fitWidth"),wt("scale"),wt("translate"),wt("precision"),lt.scale(249.5)}function kr(Ne,je){var rt=2*c/je,lt=Ne*Ne;function wt(bt,kt){var hr=u.geoAzimuthalEquidistantRaw(bt,kt),gr=hr[0],fr=hr[1],_r=gr*gr+fr*fr;if(_r>lt){var Rr=F(_r),jr=i(fr,gr),tn=rt*g(jr/rt),wn=jr-tn,Rn=Ne*n(wn),Zn=(Ne*v(wn)-wn*v(Rn))/(M-Rn),xa=wr(wn,Zn),wa=(c-Ne)/Sr(xa,Rn,c);gr=Rr;var qa=50,ja;do gr-=ja=(Ne+Sr(xa,Rn,gr)*wa-Rr)/(xa(gr)*wa);while(T(ja)>l&&--qa>0);fr=wn*v(gr),gr<M&&(fr-=Zn*(gr-M));var ai=v(tn),mi=n(tn);hr[0]=gr*mi-fr*ai,hr[1]=gr*ai+fr*mi}return hr}return wt.invert=function(bt,kt){var hr=bt*bt+kt*kt;if(hr>lt){var gr=F(hr),fr=i(kt,bt),_r=rt*g(fr/rt),Rr=fr-_r;bt=gr*n(Rr),kt=gr*v(Rr);for(var jr=bt-M,tn=v(bt),wn=kt/tn,Rn=bt<M?1/0:0,Zn=10;;){var xa=Ne*v(wn),wa=Ne*n(wn),qa=v(wa),ja=M-wa,ai=(xa-wn*qa)/ja,mi=wr(wn,ai);if(T(Rn)<b||!--Zn)break;wn-=Rn=(wn*tn-ai*jr-kt)/(tn-jr*2*(ja*(wa+wn*xa*n(wa)-qa)-xa*(xa-wn*qa))/(ja*ja))}gr=Ne+Sr(mi,wa,bt)*(c-Ne)/Sr(mi,wa,c),fr=_r+wn,bt=gr*n(fr),kt=gr*v(fr)}return u.geoAzimuthalEquidistantRaw.invert(bt,kt)},wt}function wr(Ne,je){return function(rt){var lt=Ne*n(rt);return rt<M&&(lt-=je),F(1+lt*lt)}}function Sr(Ne,je,rt){for(var lt=50,wt=(rt-je)/lt,bt=Ne(je)+Ne(rt),kt=1,hr=je;kt<lt;++kt)bt+=2*Ne(hr+=wt);return bt*.5*wt}function Zr(){var Ne=6,je=30*E,rt=n(je),lt=v(je),wt=u.geoProjectionMutator(kr),bt=wt(je,Ne),kt=bt.stream,hr=.01,gr=-n(hr*E),fr=v(hr*E);return bt.radius=function(_r){return arguments.length?(rt=n(je=_r*E),lt=v(je),wt(je,Ne)):je*S},bt.lobes=function(_r){return arguments.length?wt(je,Ne=+_r):Ne},bt.stream=function(_r){var Rr=bt.rotate(),jr=kt(_r),tn=(bt.rotate([0,0]),kt(_r));return bt.rotate(Rr),jr.sphere=function(){tn.polygonStart(),tn.lineStart();for(var wn=0,Rn=2*c/Ne,Zn=0;wn<Ne;++wn,Zn-=Rn)tn.point(i(fr*n(Zn),gr)*S,B(fr*v(Zn))*S),tn.point(i(lt*n(Zn-Rn/2),rt)*S,B(lt*v(Zn-Rn/2))*S);tn.lineEnd(),tn.polygonEnd()},jr},bt.rotate([90,-40]).scale(91.7095).clipAngle(180-.001)}function ir(Ne,je,rt,lt,wt,bt,kt,hr){arguments.length<8&&(hr=0);function gr(fr,_r){if(!_r)return[Ne*fr/c,0];var Rr=_r*_r,jr=Ne+Rr*(je+Rr*(rt+Rr*lt)),tn=_r*(wt-1+Rr*(bt-hr+Rr*kt)),wn=(jr*jr+tn*tn)/(2*tn),Rn=fr*B(jr/wn)/c;return[wn*v(Rn),_r*(1+Rr*hr)+wn*(1-n(Rn))]}return gr.invert=function(fr,_r){var Rr=c*fr/Ne,jr=_r,tn,wn,Rn=50;do{var Zn=jr*jr,xa=Ne+Zn*(je+Zn*(rt+Zn*lt)),wa=jr*(wt-1+Zn*(bt-hr+Zn*kt)),qa=xa*xa+wa*wa,ja=2*wa,ai=qa/ja,mi=ai*ai,po=B(xa/ai)/c,oi=Rr*po,$i=xa*xa,_o=(2*je+Zn*(4*rt+Zn*6*lt))*jr,Ro=wt+Zn*(3*bt+Zn*5*kt),Ci=2*(xa*_o+wa*(Ro-1)),Ri=2*(Ro-1),ks=(Ci*ja-qa*Ri)/(ja*ja),Eo=n(oi),Yo=v(oi),os=ai*Eo,fe=ai*Yo,Ae=Rr/c*(1/F(1-$i/mi))*(_o*ai-xa*ks)/mi,Fe=fe-fr,Ve=jr*(1+Zn*hr)+ai-os-_r,Ue=ks*Yo+os*Ae,Qe=os*po,_t=1+ks-(ks*Eo-fe*Ae),dt=fe*po,It=Ue*dt-_t*Qe;if(!It)break;Rr-=tn=(Ve*Ue-Fe*_t)/It,jr-=wn=(Fe*dt-Ve*Qe)/It}while((T(tn)>l||T(wn)>l)&&--Rn>0);return[Rr,jr]},gr}var xr=ir(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);function Fr(){return u.geoProjection(xr).scale(149.995)}var Or=ir(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);function Cr(){return u.geoProjection(Or).scale(153.93)}var at=ir(5/6*c,-.62636,-.0344,0,1.3493,-.05524,0,.045);function Ft(){return u.geoProjection(at).scale(130.945)}function jt(Ne,je){var rt=Ne*Ne,lt=je*je;return[Ne*(1-.162388*lt)*(.87-952426e-9*rt*rt),je*(1+lt/12)]}jt.invert=function(Ne,je){var rt=Ne,lt=je,wt=50,bt;do{var kt=lt*lt;lt-=bt=(lt*(1+kt/12)-je)/(1+kt/4)}while(T(bt)>l&&--wt>0);wt=50,Ne/=1-.162388*kt;do{var hr=(hr=rt*rt)*hr;rt-=bt=(rt*(.87-952426e-9*hr)-Ne)/(.87-.00476213*hr)}while(T(bt)>l&&--wt>0);return[rt,lt]};function sr(){return u.geoProjection(jt).scale(131.747)}var zr=ir(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function Ur(){return u.geoProjection(zr).scale(131.087)}function Dr(Ne){var je=Ne(M,0)[0]-Ne(-M,0)[0];function rt(lt,wt){var bt=lt>0?-.5:.5,kt=Ne(lt+bt*c,wt);return kt[0]-=bt*je,kt}return Ne.invert&&(rt.invert=function(lt,wt){var bt=lt>0?-.5:.5,kt=Ne.invert(lt+bt*je,wt),hr=kt[0]-bt*c;return hr<-c?hr+=2*c:hr>c&&(hr-=2*c),kt[0]=hr,kt}),rt}function Tr(Ne,je){var rt=p(Ne),lt=p(je),wt=n(je),bt=n(Ne)*wt,kt=v(Ne)*wt,hr=v(lt*je);Ne=T(i(kt,hr)),je=B(bt),T(Ne-M)>l&&(Ne%=M);var gr=Wr(Ne>c/4?M-Ne:Ne,je);return Ne>c/4&&(hr=gr[0],gr[0]=-gr[1],gr[1]=-hr),gr[0]*=rt,gr[1]*=-lt,gr}Tr.invert=function(Ne,je){T(Ne)>1&&(Ne=p(Ne)*2-Ne),T(je)>1&&(je=p(je)*2-je);var rt=p(Ne),lt=p(je),wt=-rt*Ne,bt=-lt*je,kt=bt/wt<1,hr=An(kt?bt:wt,kt?wt:bt),gr=hr[0],fr=hr[1],_r=n(fr);return kt&&(gr=-M-gr),[rt*(i(v(gr)*_r,-v(fr))+c),lt*B(n(gr)*_r)]};function Wr(Ne,je){if(je===M)return[0,0];var rt=v(je),lt=rt*rt,wt=lt*lt,bt=1+wt,kt=1+3*wt,hr=1-wt,gr=B(1/F(bt)),fr=hr+lt*bt*gr,_r=(1-rt)/fr,Rr=F(_r),jr=_r*bt,tn=F(jr),wn=Rr*hr,Rn,Zn;if(Ne===0)return[0,-(wn+lt*tn)];var xa=n(je),wa=1/xa,qa=2*rt*xa,ja=(-3*lt+gr*kt)*qa,ai=(-fr*xa-(1-rt)*ja)/(fr*fr),mi=.5*ai/Rr,po=hr*mi-2*lt*Rr*qa,oi=lt*bt*ai+_r*kt*qa,$i=-wa*qa,_o=-wa*oi,Ro=-2*wa*po,Ci=4*Ne/c,Ri;if(Ne>.222*c||je<c/4&&Ne>.175*c){if(Rn=(wn+lt*F(jr*(1+wt)-wn*wn))/(1+wt),Ne>c/4)return[Rn,Rn];var ks=Rn,Eo=.5*Rn;Rn=.5*(Eo+ks),Zn=50;do{var Yo=F(jr-Rn*Rn),os=Rn*(Ro+$i*Yo)+_o*B(Rn/tn)-Ci;if(!os)break;os<0?Eo=Rn:ks=Rn,Rn=.5*(Eo+ks)}while(T(ks-Eo)>l&&--Zn>0)}else{Rn=l,Zn=25;do{var fe=Rn*Rn,Ae=F(jr-fe),Fe=Ro+$i*Ae,Ve=Rn*Fe+_o*B(Rn/tn)-Ci,Ue=Fe+(_o-$i*fe)/Ae;Rn-=Ri=Ae?Ve/Ue:0}while(T(Ri)>l&&--Zn>0)}return[Rn,-wn-lt*F(jr-Rn*Rn)]}function An(Ne,je){for(var rt=0,lt=1,wt=.5,bt=50;;){var kt=wt*wt,hr=F(wt),gr=B(1/F(1+kt)),fr=1-kt+wt*(1+kt)*gr,_r=(1-hr)/fr,Rr=F(_r),jr=_r*(1+kt),tn=Rr*(1-kt),wn=jr-Ne*Ne,Rn=F(wn),Zn=je+tn+wt*Rn;if(T(lt-rt)<b||--bt===0||Zn===0)break;Zn>0?rt=wt:lt=wt,wt=.5*(rt+lt)}if(!bt)return null;var xa=B(hr),wa=n(xa),qa=1/wa,ja=2*hr*wa,ai=(-3*wt+gr*(1+3*kt))*ja,mi=(-fr*wa-(1-hr)*ai)/(fr*fr),po=.5*mi/Rr,oi=(1-kt)*po-2*wt*Rr*ja,$i=-2*qa*oi,_o=-qa*ja,Ro=-qa*(wt*(1+kt)*mi+_r*(1+3*kt)*ja);return[c/4*(Ne*($i+_o*Rn)+Ro*B(Ne/F(jr))),xa]}function vn(){return u.geoProjection(Dr(Tr)).scale(239.75)}function Un(Ne,je,rt){var lt,wt,bt;return Ne?(lt=Dn(Ne,rt),je?(wt=Dn(je,1-rt),bt=wt[1]*wt[1]+rt*lt[0]*lt[0]*wt[0]*wt[0],[[lt[0]*wt[2]/bt,lt[1]*lt[2]*wt[0]*wt[1]/bt],[lt[1]*wt[1]/bt,-lt[0]*lt[2]*wt[0]*wt[2]/bt],[lt[2]*wt[1]*wt[2]/bt,-rt*lt[0]*lt[1]*wt[0]/bt]]):[[lt[0],0],[lt[1],0],[lt[2],0]]):(wt=Dn(je,1-rt),[[0,wt[0]/wt[1]],[1/wt[1],0],[wt[2]/wt[1],0]])}function Dn(Ne,je){var rt,lt,wt,bt,kt;if(je<l)return bt=v(Ne),lt=n(Ne),rt=je*(Ne-bt*lt)/4,[bt-rt*lt,lt+rt*bt,1-je*bt*bt/2,Ne-rt];if(je>=1-l)return rt=(1-je)/4,lt=N(Ne),bt=I(Ne),wt=1/lt,kt=lt*O(Ne),[bt+rt*(kt-Ne)/(lt*lt),wt-rt*bt*wt*(kt-Ne),wt+rt*bt*wt*(kt+Ne),2*e(a(Ne))-M+rt*(kt-Ne)/lt];var hr=[1,0,0,0,0,0,0,0,0],gr=[F(je),0,0,0,0,0,0,0,0],fr=0;for(lt=F(1-je),kt=1;T(gr[fr]/hr[fr])>l&&fr<8;)rt=hr[fr++],gr[fr]=(rt-lt)/2,hr[fr]=(rt+lt)/2,lt=F(rt*lt),kt*=2;wt=kt*hr[fr]*Ne;do bt=gr[fr]*v(lt=wt)/hr[fr],wt=(B(bt)+wt)/2;while(--fr);return[v(wt),bt=n(wt),bt/n(wt-lt),wt]}function Xn(Ne,je,rt){var lt=T(Ne),wt=T(je),bt=O(wt);if(lt){var kt=1/v(lt),hr=1/(x(lt)*x(lt)),gr=-(hr+rt*(bt*bt*kt*kt)-1+rt),fr=(rt-1)*hr,_r=(-gr+F(gr*gr-4*fr))/2;return[Yn(e(1/F(_r)),rt)*p(Ne),Yn(e(F((_r/hr-1)/rt)),1-rt)*p(je)]}return[0,Yn(e(bt),1-rt)*p(je)]}function Yn(Ne,je){if(!je)return Ne;if(je===1)return f(x(Ne/2+_));for(var rt=1,lt=F(1-je),wt=F(je),bt=0;T(wt)>l;bt++){if(Ne%c){var kt=e(lt*x(Ne)/rt);kt<0&&(kt+=c),Ne+=kt+~~(Ne/c)*c}else Ne+=Ne;wt=(rt+lt)/2,lt=F(rt*lt),wt=((rt=wt)-lt)/2}return Ne/(m(2,bt)*rt)}function ya(Ne,je){var rt=(w-1)/(w+1),lt=F(1-rt*rt),wt=Yn(M,lt*lt),bt=-1,kt=f(x(c/4+T(je)/2)),hr=a(bt*kt)/F(rt),gr=Ca(hr*n(bt*Ne),hr*v(bt*Ne)),fr=Xn(gr[0],gr[1],lt*lt);return[-fr[1],(je>=0?1:-1)*(.5*wt-fr[0])]}function Ca(Ne,je){var rt=Ne*Ne,lt=je+1,wt=1-rt-je*je;return[.5*((Ne>=0?M:-M)-i(wt,2*Ne)),-.25*f(wt*wt+4*rt)+.5*f(lt*lt+rt)]}function gi(Ne,je){var rt=je[0]*je[0]+je[1]*je[1];return[(Ne[0]*je[0]+Ne[1]*je[1])/rt,(Ne[1]*je[0]-Ne[0]*je[1])/rt]}ya.invert=function(Ne,je){var rt=(w-1)/(w+1),lt=F(1-rt*rt),wt=Yn(M,lt*lt),bt=-1,kt=Un(.5*wt-je,-Ne,lt*lt),hr=gi(kt[0],kt[1]),gr=i(hr[1],hr[0])/bt;return[gr,2*e(a(.5/bt*f(rt*hr[0]*hr[0]+rt*hr[1]*hr[1])))-M]};function Xa(){return u.geoProjection(Dr(ya)).scale(151.496)}function $a(Ne){var je=v(Ne),rt=n(Ne),lt=Ja(Ne);lt.invert=Ja(-Ne);function wt(bt,kt){var hr=lt(bt,kt);bt=hr[0],kt=hr[1];var gr=v(kt),fr=n(kt),_r=n(bt),Rr=z(je*gr+rt*fr*_r),jr=v(Rr),tn=T(jr)>l?Rr/jr:1;return[tn*rt*v(bt),(T(bt)>M?tn:-tn)*(je*fr-rt*gr*_r)]}return wt.invert=function(bt,kt){var hr=F(bt*bt+kt*kt),gr=-v(hr),fr=n(hr),_r=hr*fr,Rr=-kt*gr,jr=hr*je,tn=F(_r*_r+Rr*Rr-jr*jr),wn=i(_r*jr+Rr*tn,Rr*jr-_r*tn),Rn=(hr>M?-1:1)*i(bt*gr,hr*n(wn)*fr+kt*v(wn)*gr);return lt.invert(Rn,wn)},wt}function Ja(Ne){var je=v(Ne),rt=n(Ne);return function(lt,wt){var bt=n(wt),kt=n(lt)*bt,hr=v(lt)*bt,gr=v(wt);return[i(hr,kt*rt-gr*je),B(gr*rt+kt*je)]}}function Mr(){var Ne=0,je=u.geoProjectionMutator($a),rt=je(Ne),lt=rt.rotate,wt=rt.stream,bt=u.geoCircle();return rt.parallel=function(kt){if(!arguments.length)return Ne*S;var hr=rt.rotate();return je(Ne=kt*E).rotate(hr)},rt.rotate=function(kt){return arguments.length?(lt.call(rt,[kt[0],kt[1]-Ne*S]),bt.center([-kt[0],-kt[1]]),rt):(kt=lt.call(rt),kt[1]+=Ne*S,kt)},rt.stream=function(kt){return kt=wt(kt),kt.sphere=function(){kt.polygonStart();var hr=.01,gr=bt.radius(90-hr)().coordinates[0],fr=gr.length-1,_r=-1,Rr;for(kt.lineStart();++_r<fr;)kt.point((Rr=gr[_r])[0],Rr[1]);for(kt.lineEnd(),gr=bt.radius(90+hr)().coordinates[0],fr=gr.length-1,kt.lineStart();--_r>=0;)kt.point((Rr=gr[_r])[0],Rr[1]);kt.lineEnd(),kt.polygonEnd()},kt},rt.scale(79.4187).parallel(45).clipAngle(180-.001)}var gn=3,hn=B(1-1/gn)*S,Sn=Rt(0);function Jn(Ne){var je=hn*E,rt=Ge(c,je)[0]-Ge(-c,je)[0],lt=Sn(0,je)[1],wt=Ge(0,je)[1],bt=d-wt,kt=C/Ne,hr=4/C,gr=lt+bt*bt*4/C;function fr(_r,Rr){var jr,tn=T(Rr);if(tn>je){var wn=s(Ne-1,o(0,r((_r+c)/kt)));_r+=c*(Ne-1)/Ne-wn*kt,jr=Ge(_r,tn),jr[0]=jr[0]*C/rt-C*(Ne-1)/(2*Ne)+wn*C/Ne,jr[1]=lt+(jr[1]-wt)*4*bt/C,Rr<0&&(jr[1]=-jr[1])}else jr=Sn(_r,Rr);return jr[0]*=hr,jr[1]/=gr,jr}return fr.invert=function(_r,Rr){_r/=hr,Rr*=gr;var jr=T(Rr);if(jr>lt){var tn=s(Ne-1,o(0,r((_r+c)/kt)));_r=(_r+c*(Ne-1)/Ne-tn*kt)*rt/C;var wn=Ge.invert(_r,.25*(jr-lt)*C/bt+wt);return wn[0]-=c*(Ne-1)/Ne-tn*kt,Rr<0&&(wn[1]=-wn[1]),wn}return Sn.invert(_r,Rr)},fr}function ha(Ne,je){return[Ne,je&1?90-l:hn]}function ra(Ne,je){return[Ne,je&1?-90+l:-hn]}function In(Ne){return[Ne[0]*(1-l),Ne[1]]}function jn(Ne){var je=[].concat(A.range(-180,180+Ne/2,Ne).map(ha),A.range(180,-180-Ne/2,-Ne).map(ra));return{type:"Polygon",coordinates:[Ne===180?je.map(In):je]}}function Ga(){var Ne=4,je=u.geoProjectionMutator(Jn),rt=je(Ne),lt=rt.stream;return rt.lobes=function(wt){return arguments.length?je(Ne=+wt):Ne},rt.stream=function(wt){var bt=rt.rotate(),kt=lt(wt),hr=(rt.rotate([0,0]),lt(wt));return rt.rotate(bt),kt.sphere=function(){u.geoStream(jn(180/Ne),hr)},kt},rt.scale(239.75)}function vi(Ne){var je=1+Ne,rt=v(1/je),lt=B(rt),wt=2*F(c/(bt=c+4*lt*je)),bt,kt=.5*wt*(je+F(Ne*(2+Ne))),hr=Ne*Ne,gr=je*je;function fr(_r,Rr){var jr=1-v(Rr),tn,wn;if(jr&&jr<2){var Rn=M-Rr,Zn=25,xa;do{var wa=v(Rn),qa=n(Rn),ja=lt+i(wa,je-qa),ai=1+gr-2*je*qa;Rn-=xa=(Rn-hr*lt-je*wa+ai*ja-.5*jr*bt)/(2*je*wa*ja)}while(T(xa)>b&&--Zn>0);tn=wt*F(ai),wn=_r*ja/c}else tn=wt*(Ne+jr),wn=_r*lt/c;return[tn*v(wn),kt-tn*n(wn)]}return fr.invert=function(_r,Rr){var jr=_r*_r+(Rr-=kt)*Rr,tn=(1+gr-jr/(wt*wt))/(2*je),wn=z(tn),Rn=v(wn),Zn=lt+i(Rn,je-tn);return[B(_r/F(jr))*c/Zn,B(1-2*(wn-hr*lt-je*Rn+(1+gr-2*je*tn)*Zn)/bt)]},fr}function Gt(){var Ne=1,je=u.geoProjectionMutator(vi),rt=je(Ne);return rt.ratio=function(lt){return arguments.length?je(Ne=+lt):Ne},rt.scale(167.774).center([0,18.67])}var pr=.7109889596207567,on=.0528035274542;function dn(Ne,je){return je>-pr?(Ne=Se(Ne,je),Ne[1]+=on,Ne):Be(Ne,je)}dn.invert=function(Ne,je){return je>-pr?Se.invert(Ne,je-on):Be.invert(Ne,je)};function rn(){return u.geoProjection(dn).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}function Mn(Ne,je){return T(je)>pr?(Ne=Se(Ne,je),Ne[1]-=je>0?on:-on,Ne):Be(Ne,je)}Mn.invert=function(Ne,je){return T(je)>pr?Se.invert(Ne,je+(je>0?on:-on)):Be.invert(Ne,je)};function _n(){return u.geoProjection(Mn).scale(152.63)}function cn(Ne,je,rt,lt){var wt=F(4*c/(2*rt+(1+Ne-je/2)*v(2*rt)+(Ne+je)/2*v(4*rt)+je/2*v(6*rt))),bt=F(lt*v(rt)*F((1+Ne*n(2*rt)+je*n(4*rt))/(1+Ne+je))),kt=rt*gr(1);function hr(Rr){return F(1+Ne*n(2*Rr)+je*n(4*Rr))}function gr(Rr){var jr=Rr*rt;return(2*jr+(1+Ne-je/2)*v(2*jr)+(Ne+je)/2*v(4*jr)+je/2*v(6*jr))/rt}function fr(Rr){return hr(Rr)*v(Rr)}var _r=function(Rr,jr){var tn=rt*xe(gr,kt*v(jr)/rt,jr/c);isNaN(tn)&&(tn=rt*p(jr));var wn=wt*hr(tn);return[wn*bt*Rr/c*n(tn),wn/bt*v(tn)]};return _r.invert=function(Rr,jr){var tn=xe(fr,jr*bt/wt);return[Rr*c/(n(tn)*wt*bt*hr(tn)),B(rt*gr(tn/rt)/kt)]},rt===0&&(wt=F(lt/c),_r=function(Rr,jr){return[Rr*wt,v(jr)/wt]},_r.invert=function(Rr,jr){return[Rr/wt,B(jr*wt)]}),_r}function mr(){var Ne=1,je=0,rt=45*E,lt=2,wt=u.geoProjectionMutator(cn),bt=wt(Ne,je,rt,lt);return bt.a=function(kt){return arguments.length?wt(Ne=+kt,je,rt,lt):Ne},bt.b=function(kt){return arguments.length?wt(Ne,je=+kt,rt,lt):je},bt.psiMax=function(kt){return arguments.length?wt(Ne,je,rt=+kt*E,lt):rt*S},bt.ratio=function(kt){return arguments.length?wt(Ne,je,rt,lt=+kt):lt},bt.scale(180.739)}function br(Ne,je,rt,lt,wt,bt,kt,hr,gr,fr,_r){if(_r.nanEncountered)return NaN;var Rr,jr,tn,wn,Rn,Zn,xa,wa,qa,ja;if(Rr=rt-je,jr=Ne(je+Rr*.25),tn=Ne(rt-Rr*.25),isNaN(jr)){_r.nanEncountered=!0;return}if(isNaN(tn)){_r.nanEncountered=!0;return}return wn=Rr*(lt+4*jr+wt)/12,Rn=Rr*(wt+4*tn+bt)/12,Zn=wn+Rn,ja=(Zn-kt)/15,fr>gr?(_r.maxDepthCount++,Zn+ja):Math.abs(ja)<hr?Zn+ja:(xa=je+Rr*.5,wa=br(Ne,je,xa,lt,jr,wt,wn,hr*.5,gr,fr+1,_r),isNaN(wa)?(_r.nanEncountered=!0,NaN):(qa=br(Ne,xa,rt,wt,tn,bt,Rn,hr*.5,gr,fr+1,_r),isNaN(qa)?(_r.nanEncountered=!0,NaN):wa+qa))}function Br(Ne,je,rt,lt,wt){var bt={maxDepthCount:0,nanEncountered:!1};lt===void 0&&(lt=1e-8),wt===void 0&&(wt=20);var kt=Ne(je),hr=Ne(.5*(je+rt)),gr=Ne(rt),fr=(kt+4*hr+gr)*(rt-je)/6,_r=br(Ne,je,rt,kt,hr,gr,fr,lt,wt,1,bt);return _r}function mn(Ne,je,rt){function lt(tn){return Ne+(1-Ne)*m(1-m(tn,je),1/je)}function wt(tn){return Br(lt,0,tn,1e-4)}for(var bt=1/wt(1),kt=1e3,hr=(1+1e-8)*bt,gr=[],fr=0;fr<=kt;fr++)gr.push(wt(fr/kt)*hr);function _r(tn){var wn=0,Rn=kt,Zn=kt>>1;do gr[Zn]>tn?Rn=Zn:wn=Zn,Zn=wn+Rn>>1;while(Zn>wn);var xa=gr[Zn+1]-gr[Zn];return xa&&(xa=(tn-gr[Zn+1])/xa),(Zn+1+xa)/kt}var Rr=2*_r(1)/c*bt/rt,jr=function(tn,wn){var Rn=_r(T(v(wn))),Zn=lt(Rn)*tn;return Rn/=Rr,[Zn,wn>=0?Rn:-Rn]};return jr.invert=function(tn,wn){var Rn;return wn*=Rr,T(wn)<1&&(Rn=p(wn)*B(wt(T(wn))*bt)),[tn/lt(T(wn)),Rn]},jr}function On(){var Ne=0,je=2.5,rt=1.183136,lt=u.geoProjectionMutator(mn),wt=lt(Ne,je,rt);return wt.alpha=function(bt){return arguments.length?lt(Ne=+bt,je,rt):Ne},wt.k=function(bt){return arguments.length?lt(Ne,je=+bt,rt):je},wt.gamma=function(bt){return arguments.length?lt(Ne,je,rt=+bt):rt},wt.scale(152.63)}function na(Ne,je){return T(Ne[0]-je[0])<l&&T(Ne[1]-je[1])<l}function Tn(Ne,je){for(var rt=-1,lt=Ne.length,wt=Ne[0],bt,kt,hr,gr=[];++rt<lt;){bt=Ne[rt],kt=(bt[0]-wt[0])/je,hr=(bt[1]-wt[1])/je;for(var fr=0;fr<je;++fr)gr.push([wt[0]+fr*kt,wt[1]+fr*hr]);wt=bt}return gr.push(bt),gr}function Kn(Ne){var je=[],rt,lt,wt,bt,kt,hr,gr,fr=Ne[0].length;for(gr=0;gr<fr;++gr)rt=Ne[0][gr],lt=rt[0][0],wt=rt[0][1],bt=rt[1][1],kt=rt[2][0],hr=rt[2][1],je.push(Tn([[lt+l,wt+l],[lt+l,bt-l],[kt-l,bt-l],[kt-l,hr+l]],30));for(gr=Ne[1].length-1;gr>=0;--gr)rt=Ne[1][gr],lt=rt[0][0],wt=rt[0][1],bt=rt[1][1],kt=rt[2][0],hr=rt[2][1],je.push(Tn([[kt-l,hr-l],[kt-l,bt+l],[lt+l,bt+l],[lt+l,wt-l]],30));return{type:"Polygon",coordinates:[A.merge(je)]}}function oa(Ne,je,rt){var lt,wt;function bt(gr,fr){for(var _r=fr<0?-1:1,Rr=je[+(fr<0)],jr=0,tn=Rr.length-1;jr<tn&&gr>Rr[jr][2][0];++jr);var wn=Ne(gr-Rr[jr][1][0],fr);return wn[0]+=Ne(Rr[jr][1][0],_r*fr>_r*Rr[jr][0][1]?Rr[jr][0][1]:fr)[0],wn}rt?bt.invert=rt(bt):Ne.invert&&(bt.invert=function(gr,fr){for(var _r=wt[+(fr<0)],Rr=je[+(fr<0)],jr=0,tn=_r.length;jr<tn;++jr){var wn=_r[jr];if(wn[0][0]<=gr&&gr<wn[1][0]&&wn[0][1]<=fr&&fr<wn[1][1]){var Rn=Ne.invert(gr-Ne(Rr[jr][1][0],0)[0],fr);return Rn[0]+=Rr[jr][1][0],na(bt(Rn[0],Rn[1]),[gr,fr])?Rn:null}}});var kt=u.geoProjection(bt),hr=kt.stream;return kt.stream=function(gr){var fr=kt.rotate(),_r=hr(gr),Rr=(kt.rotate([0,0]),hr(gr));return kt.rotate(fr),_r.sphere=function(){u.geoStream(lt,Rr)},_r},kt.lobes=function(gr){return arguments.length?(lt=Kn(gr),je=gr.map(function(fr){return fr.map(function(_r){return[[_r[0][0]*E,_r[0][1]*E],[_r[1][0]*E,_r[1][1]*E],[_r[2][0]*E,_r[2][1]*E]]})}),wt=je.map(function(fr){return fr.map(function(_r){var Rr=Ne(_r[0][0],_r[0][1])[0],jr=Ne(_r[2][0],_r[2][1])[0],tn=Ne(_r[1][0],_r[0][1])[1],wn=Ne(_r[1][0],_r[1][1])[1],Rn;return tn>wn&&(Rn=tn,tn=wn,wn=Rn),[[Rr,tn],[jr,wn]]})}),kt):je.map(function(fr){return fr.map(function(_r){return[[_r[0][0]*S,_r[0][1]*S],[_r[1][0]*S,_r[1][1]*S],[_r[2][0]*S,_r[2][1]*S]]})})},je!=null&&kt.lobes(je),kt}var ma=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function _a(){return oa(Ce,ma).scale(160.857)}var ua=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function Ea(){return oa(Mn,ua).scale(152.63)}var Mo=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function jo(){return oa(Se,Mo).scale(169.529)}var vs=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function El(){return oa(Se,vs).scale(169.529).rotate([20,0])}var Ol=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]];function mu(){return oa(dn,Ol,oe).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}var bi=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function cl(){return oa(Be,bi).scale(152.63).rotate([-20,0])}function $s(Ne,je){return[3/C*Ne*F(c*c/3-je*je),je]}$s.invert=function(Ne,je){return[C/3*Ne/F(c*c/3-je*je),je]};function Ki(){return u.geoProjection($s).scale(158.837)}function No(Ne){function je(rt,lt){if(T(T(lt)-M)<l)return[0,lt<0?-2:2];var wt=v(lt),bt=m((1+wt)/(1-wt),Ne/2),kt=.5*(bt+1/bt)+n(rt*=Ne);return[2*v(rt)/kt,(bt-1/bt)/kt]}return je.invert=function(rt,lt){var wt=T(lt);if(T(wt-2)<l)return rt?null:[0,p(lt)*M];if(wt>2)return null;rt/=2,lt/=2;var bt=rt*rt,kt=lt*lt,hr=2*lt/(1+bt+kt);return hr=m((1+hr)/(1-hr),1/Ne),[i(2*rt,1-bt-kt)/Ne,B((hr-1)/(hr+1))]},je}function Ul(){var Ne=.5,je=u.geoProjectionMutator(No),rt=je(Ne);return rt.spacing=function(lt){return arguments.length?je(Ne=+lt):Ne},rt.scale(124.75)}var Ps=c/w;function Vi(Ne,je){return[Ne*(1+F(n(je)))/2,je/(n(je/2)*n(Ne/6))]}Vi.invert=function(Ne,je){var rt=T(Ne),lt=T(je),wt=l,bt=M;lt<Ps?bt*=lt/Ps:wt+=6*z(Ps/lt);for(var kt=0;kt<25;kt++){var hr=v(bt),gr=F(n(bt)),fr=v(bt/2),_r=n(bt/2),Rr=v(wt/6),jr=n(wt/6),tn=.5*wt*(1+gr)-rt,wn=bt/(_r*jr)-lt,Rn=gr?-.25*wt*hr/gr:0,Zn=.5*(1+gr),xa=(1+.5*bt*fr/_r)/(_r*jr),wa=bt/_r*(Rr/6)/(jr*jr),qa=Rn*wa-xa*Zn,ja=(tn*wa-wn*Zn)/qa,ai=(wn*Rn-tn*xa)/qa;if(bt-=ja,wt-=ai,T(ja)<l&&T(ai)<l)break}return[Ne<0?-wt:wt,je<0?-bt:bt]};function Cl(){return u.geoProjection(Vi).scale(97.2672)}function io(Ne,je){var rt=Ne*Ne,lt=je*je;return[Ne*(.975534+lt*(-.119161+rt*-.0143059+lt*-.0547009)),je*(1.00384+rt*(.0802894+lt*-.02855+rt*199025e-9)+lt*(.0998909+lt*-.0491032))]}io.invert=function(Ne,je){var rt=p(Ne)*c,lt=je/2,wt=50;do{var bt=rt*rt,kt=lt*lt,hr=rt*lt,gr=rt*(.975534+kt*(-.119161+bt*-.0143059+kt*-.0547009))-Ne,fr=lt*(1.00384+bt*(.0802894+kt*-.02855+bt*199025e-9)+kt*(.0998909+kt*-.0491032))-je,_r=.975534-kt*(.119161+3*bt*.0143059+kt*.0547009),Rr=-hr*(2*.119161+4*.0547009*kt+2*.0143059*bt),jr=hr*(2*.0802894+4*199025e-9*bt+2*-.02855*kt),tn=1.00384+bt*(.0802894+199025e-9*bt)+kt*(3*(.0998909-.02855*bt)-5*.0491032*kt),wn=Rr*jr-tn*_r,Rn=(fr*Rr-gr*tn)/wn,Zn=(gr*jr-fr*_r)/wn;rt-=Rn,lt-=Zn}while((T(Rn)>l||T(Zn)>l)&&--wt>0);return wt&&[rt,lt]};function Wi(){return u.geoProjection(io).scale(139.98)}function vo(Ne,je){return[v(Ne)/n(je),x(je)*n(Ne)]}vo.invert=function(Ne,je){var rt=Ne*Ne,lt=je*je,wt=lt+1,bt=rt+wt,kt=Ne?y*F((bt-F(bt*bt-4*rt))/rt):1/F(wt);return[B(Ne*kt),p(je)*z(kt)]};function oo(){return u.geoProjection(vo).scale(144.049).clipAngle(90-.001)}function bs(Ne){var je=n(Ne),rt=x(_+Ne/2);function lt(wt,bt){var kt=bt-Ne,hr=T(kt)<l?wt*je:T(hr=_+bt/2)<l||T(T(hr)-M)<l?0:wt*kt/f(x(hr)/rt);return[hr,kt]}return lt.invert=function(wt,bt){var kt,hr=bt+Ne;return[T(bt)<l?wt/je:T(kt=_+hr/2)<l||T(T(kt)-M)<l?0:wt*f(x(kt)/rt)/bt,hr]},lt}function hl(){return Xe(bs).parallel(40).scale(158.837)}function Ru(Ne,je){return[Ne,1.25*f(x(_+.4*je))]}Ru.invert=function(Ne,je){return[Ne,2.5*e(a(.8*je))-.625*c]};function ps(){return u.geoProjection(Ru).scale(108.318)}function Iu(Ne){var je=Ne.length-1;function rt(lt,wt){for(var bt=n(wt),kt=2/(1+bt*n(lt)),hr=kt*bt*v(lt),gr=kt*v(wt),fr=je,_r=Ne[fr],Rr=_r[0],jr=_r[1],tn;--fr>=0;)_r=Ne[fr],Rr=_r[0]+hr*(tn=Rr)-gr*jr,jr=_r[1]+hr*jr+gr*tn;return Rr=hr*(tn=Rr)-gr*jr,jr=hr*jr+gr*tn,[Rr,jr]}return rt.invert=function(lt,wt){var bt=20,kt=lt,hr=wt;do{for(var gr=je,fr=Ne[gr],_r=fr[0],Rr=fr[1],jr=0,tn=0,wn;--gr>=0;)fr=Ne[gr],jr=_r+kt*(wn=jr)-hr*tn,tn=Rr+kt*tn+hr*wn,_r=fr[0]+kt*(wn=_r)-hr*Rr,Rr=fr[1]+kt*Rr+hr*wn;jr=_r+kt*(wn=jr)-hr*tn,tn=Rr+kt*tn+hr*wn,_r=kt*(wn=_r)-hr*Rr-lt,Rr=kt*Rr+hr*wn-wt;var Rn=jr*jr+tn*tn,Zn,xa;kt-=Zn=(_r*jr+Rr*tn)/Rn,hr-=xa=(Rr*jr-_r*tn)/Rn}while(T(Zn)+T(xa)>l*l&&--bt>0);if(bt){var wa=F(kt*kt+hr*hr),qa=2*e(wa*.5),ja=v(qa);return[i(kt*ja,wa*n(qa)),wa?B(hr*ja/wa):0]}},rt}var qs=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],Oo=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],lf=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],el=[[.9245,0],[0,0],[.01943,0]],Vs=[[.721316,0],[0,0],[-.00881625,-.00617325]];function nu(){return Hs(qs,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)}function uf(){return Hs(Oo,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])}function ff(){return Hs(lf,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])}function vl(){return Hs(el,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)}function au(){return Hs(Vs,[165,10]).scale(250).clipAngle(130).center([-165,-10])}function Hs(Ne,je){var rt=u.geoProjection(Iu(Ne)).rotate(je).clipAngle(90),lt=u.geoRotation(je),wt=rt.center;return delete rt.rotate,rt.center=function(bt){return arguments.length?wt(lt(bt)):lt.invert(wt())},rt}var xu=F(6),kl=F(7);function bu(Ne,je){var rt=B(7*v(je)/(3*xu));return[xu*Ne*(2*n(2*rt/3)-1)/kl,9*v(rt/3)/kl]}bu.invert=function(Ne,je){var rt=3*B(je*kl/9);return[Ne*kl/(xu*(2*n(2*rt/3)-1)),B(v(rt)*3*xu/7)]};function zu(){return u.geoProjection(bu).scale(164.859)}function iu(Ne,je){for(var rt=(1+y)*v(je),lt=je,wt=0,bt;wt<25&&(lt-=bt=(v(lt/2)+v(lt)-rt)/(.5*n(lt/2)+n(lt)),!(T(bt)<l));wt++);return[Ne*(1+2*n(lt)/n(lt/2))/(3*w),2*F(3)*v(lt/2)/F(2+w)]}iu.invert=function(Ne,je){var rt=je*F(2+w)/(2*F(3)),lt=2*B(rt);return[3*w*Ne/(1+2*n(lt)/n(lt/2)),B((rt+v(lt))/(1+y))]};function cf(){return u.geoProjection(iu).scale(188.209)}function pl(Ne,je){for(var rt=F(6/(4+c)),lt=(1+c/4)*v(je),wt=je/2,bt=0,kt;bt<25&&(wt-=kt=(wt/2+v(wt)-lt)/(.5+n(wt)),!(T(kt)<l));bt++);return[rt*(.5+n(wt))*Ne/1.5,rt*wt]}pl.invert=function(Ne,je){var rt=F(6/(4+c)),lt=je/rt;return T(T(lt)-M)<l&&(lt=lt<0?-M:M),[1.5*Ne/(rt*(.5+n(lt))),B((lt/2+v(lt))/(1+c/4))]};function _u(){return u.geoProjection(pl).scale(166.518)}function ou(Ne,je){var rt=je*je,lt=rt*rt,wt=rt*lt;return[Ne*(.84719-.13063*rt+wt*wt*(-.04515+.05494*rt-.02326*lt+.00331*wt)),je*(1.01183+lt*lt*(-.02625+.01926*rt-.00396*lt))]}ou.invert=function(Ne,je){var rt=je,lt=25,wt,bt,kt,hr;do bt=rt*rt,kt=bt*bt,rt-=wt=(rt*(1.01183+kt*kt*(-.02625+.01926*bt-.00396*kt))-je)/(1.01183+kt*kt*(9*-.02625+11*.01926*bt+13*-.00396*kt));while(T(wt)>b&&--lt>0);return bt=rt*rt,kt=bt*bt,hr=bt*kt,[Ne/(.84719-.13063*bt+hr*hr*(-.04515+.05494*bt-.02326*kt+.00331*hr)),rt]};function Fs(){return u.geoProjection(ou).scale(175.295)}function Vl(Ne,je){return[Ne*(1+n(je))/2,2*(je-x(je/2))]}Vl.invert=function(Ne,je){for(var rt=je/2,lt=0,wt=1/0;lt<10&&T(wt)>l;++lt){var bt=n(je/2);je-=wt=(je-x(je/2)-rt)/(1-.5/(bt*bt))}return[2*Ne/(1+n(je)),je]};function wu(){return u.geoProjection(Vl).scale(152.63)}var Bu=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function Nu(){return oa(le(1/0),Bu).rotate([20,0]).scale(152.63)}function su(Ne,je){var rt=v(je),lt=n(je),wt=p(Ne);if(Ne===0||T(je)===M)return[0,je];if(je===0)return[Ne,0];if(T(Ne)===M)return[Ne*lt,M*rt];var bt=c/(2*Ne)-2*Ne/c,kt=2*je/c,hr=(1-kt*kt)/(rt-kt),gr=bt*bt,fr=hr*hr,_r=1+gr/fr,Rr=1+fr/gr,jr=(bt*rt/hr-bt/2)/_r,tn=(fr*rt/gr+hr/2)/Rr,wn=jr*jr+lt*lt/_r,Rn=tn*tn-(fr*rt*rt/gr+hr*rt-1)/Rr;return[M*(jr+F(wn)*wt),M*(tn+F(Rn<0?0:Rn)*p(-je*bt)*wt)]}su.invert=function(Ne,je){Ne/=M,je/=M;var rt=Ne*Ne,lt=je*je,wt=rt+lt,bt=c*c;return[Ne?(wt-1+F((1-wt)*(1-wt)+4*rt))/(2*Ne)*M:0,xe(function(kt){return wt*(c*v(kt)-2*kt)*c+4*kt*kt*(je-v(kt))+2*c*kt-bt*je},0)]};function hf(){return u.geoProjection(su).scale(127.267)}var Ou=1.0148,ds=.23185,Dl=-.14499,Ll=.02406,Tu=Ou,Rs=5*ds,Uo=7*Dl,lu=9*Ll,Gs=1.790857183;function Ys(Ne,je){var rt=je*je;return[Ne,je*(Ou+rt*rt*(ds+rt*(Dl+Ll*rt)))]}Ys.invert=function(Ne,je){je>Gs?je=Gs:je<-Gs&&(je=-Gs);var rt=je,lt;do{var wt=rt*rt;rt-=lt=(rt*(Ou+wt*wt*(ds+wt*(Dl+Ll*wt)))-je)/(Tu+wt*wt*(Rs+wt*(Uo+lu*wt)))}while(T(lt)>l);return[Ne,rt]};function mo(){return u.geoProjection(Ys).scale(139.319)}function Hl(Ne,je){if(T(je)<l)return[Ne,0];var rt=x(je),lt=Ne*v(je);return[v(lt)/rt,je+(1-n(lt))/rt]}Hl.invert=function(Ne,je){if(T(je)<l)return[Ne,0];var rt=Ne*Ne+je*je,lt=je*.5,wt=10,bt;do{var kt=x(lt),hr=1/n(lt),gr=rt-2*je*lt+lt*lt;lt-=bt=(kt*gr+2*(lt-je))/(2+gr*hr*hr+2*(lt-je)*kt)}while(T(bt)>l&&--wt>0);return kt=x(lt),[(T(je)<T(lt+1/kt)?B(Ne*kt):p(je)*p(Ne)*(z(T(Ne*kt))+M))/v(lt),lt]};function Gl(){return u.geoProjection(Hl).scale(103.74)}function dl(Ne,je){var rt=Pl(Ne[1],Ne[0]),lt=Pl(je[1],je[0]),wt=Wl(rt,lt),bt=uu(rt)/uu(lt);return Yl([1,0,Ne[0][0],0,1,Ne[0][1]],Yl([bt,0,0,0,bt,0],Yl([n(wt),v(wt),0,-v(wt),n(wt),0],[1,0,-je[0][0],0,1,-je[0][1]])))}function Is(Ne){var je=1/(Ne[0]*Ne[4]-Ne[1]*Ne[3]);return[je*Ne[4],-je*Ne[1],je*(Ne[1]*Ne[5]-Ne[2]*Ne[4]),-je*Ne[3],je*Ne[0],je*(Ne[2]*Ne[3]-Ne[0]*Ne[5])]}function Yl(Ne,je){return[Ne[0]*je[0]+Ne[1]*je[3],Ne[0]*je[1]+Ne[1]*je[4],Ne[0]*je[2]+Ne[1]*je[5]+Ne[2],Ne[3]*je[0]+Ne[4]*je[3],Ne[3]*je[1]+Ne[4]*je[4],Ne[3]*je[2]+Ne[4]*je[5]+Ne[5]]}function Pl(Ne,je){return[Ne[0]-je[0],Ne[1]-je[1]]}function uu(Ne){return F(Ne[0]*Ne[0]+Ne[1]*Ne[1])}function Wl(Ne,je){return i(Ne[0]*je[1]-Ne[1]*je[0],Ne[0]*je[0]+Ne[1]*je[1])}function yl(Ne,je,rt){lt(Ne,{transform:null});function lt(fr,_r){if(fr.edges=Au(fr.face),_r.face){var Rr=fr.shared=Cf(fr.face,_r.face),jr=dl(Rr.map(_r.project),Rr.map(fr.project));fr.transform=_r.transform?Yl(_r.transform,jr):jr;for(var tn=_r.edges,wn=0,Rn=tn.length;wn<Rn;++wn)_s(Rr[0],tn[wn][1])&&_s(Rr[1],tn[wn][0])&&(tn[wn]=fr),_s(Rr[0],tn[wn][0])&&_s(Rr[1],tn[wn][1])&&(tn[wn]=fr);for(tn=fr.edges,wn=0,Rn=tn.length;wn<Rn;++wn)_s(Rr[0],tn[wn][0])&&_s(Rr[1],tn[wn][1])&&(tn[wn]=_r),_s(Rr[0],tn[wn][1])&&_s(Rr[1],tn[wn][0])&&(tn[wn]=_r)}else fr.transform=_r.transform;return fr.children&&fr.children.forEach(function(Zn){lt(Zn,fr)}),fr}function wt(fr,_r){var Rr=je(fr,_r),jr=Rr.project([fr*S,_r*S]),tn;return(tn=Rr.transform)?[tn[0]*jr[0]+tn[1]*jr[1]+tn[2],-(tn[3]*jr[0]+tn[4]*jr[1]+tn[5])]:(jr[1]=-jr[1],jr)}Fl(Ne)&&(wt.invert=function(fr,_r){var Rr=bt(Ne,[fr,-_r]);return Rr&&(Rr[0]*=E,Rr[1]*=E,Rr)});function bt(fr,_r){var Rr=fr.project.invert,jr=fr.transform,tn=_r;if(jr&&(jr=Is(jr),tn=[jr[0]*tn[0]+jr[1]*tn[1]+jr[2],jr[3]*tn[0]+jr[4]*tn[1]+jr[5]]),Rr&&fr===kt(wn=Rr(tn)))return wn;for(var wn,Rn=fr.children,Zn=0,xa=Rn&&Rn.length;Zn<xa;++Zn)if(wn=bt(Rn[Zn],_r))return wn}function kt(fr){return je(fr[0]*E,fr[1]*E)}var hr=u.geoProjection(wt),gr=hr.stream;return hr.stream=function(fr){var _r=hr.rotate(),Rr=gr(fr),jr=(hr.rotate([0,0]),gr(fr));return hr.rotate(_r),Rr.sphere=function(){jr.polygonStart(),jr.lineStart(),vf(jr,Ne),jr.lineEnd(),jr.polygonEnd()},Rr},hr.angle(rt==null?-30:rt*S)}function vf(Ne,je,rt){var lt,wt=je.edges,bt=wt.length,kt,hr={type:"MultiPoint",coordinates:je.face},gr=je.face.filter(function(Rn){return T(Rn[1])!==90}),fr=u.geoBounds({type:"MultiPoint",coordinates:gr}),_r=!1,Rr=-1,jr=fr[1][0]-fr[0][0],tn=jr===180||jr===360?[(fr[0][0]+fr[1][0])/2,(fr[0][1]+fr[1][1])/2]:u.geoCentroid(hr);if(rt)for(;++Rr<bt&&wt[Rr]!==rt;);++Rr;for(var wn=0;wn<bt;++wn)kt=wt[(wn+Rr)%bt],Array.isArray(kt)?(_r||(Ne.point((lt=u.geoInterpolate(kt[0],tn)(l))[0],lt[1]),_r=!0),Ne.point((lt=u.geoInterpolate(kt[1],tn)(l))[0],lt[1])):(_r=!1,kt!==rt&&vf(Ne,kt,je))}function _s(Ne,je){return Ne&&je&&Ne[0]===je[0]&&Ne[1]===je[1]}function Cf(Ne,je){for(var rt,lt,wt=Ne.length,bt=null,kt=0;kt<wt;++kt){rt=Ne[kt];for(var hr=je.length;--hr>=0;)if(lt=je[hr],rt[0]===lt[0]&&rt[1]===lt[1]){if(bt)return[bt,rt];bt=rt}}}function Au(Ne){for(var je=Ne.length,rt=[],lt=Ne[je-1],wt=0;wt<je;++wt)rt.push([lt,lt=Ne[wt]]);return rt}function Fl(Ne){return Ne.project.invert||Ne.children&&Ne.children.some(Fl)}var Xl=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],ml=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(Ne){return Ne.map(function(je){return Xl[je]})});function Zl(Ne){Ne=Ne||function(rt){var lt=u.geoCentroid({type:"MultiPoint",coordinates:rt});return u.geoGnomonic().scale(1).translate([0,0]).rotate([-lt[0],-lt[1]])};var je=ml.map(function(rt){return{face:rt,project:Ne(rt)}});return[-1,0,0,1,0,1,4,5].forEach(function(rt,lt){var wt=je[rt];wt&&(wt.children||(wt.children=[])).push(je[lt])}),yl(je[0],function(rt,lt){return je[rt<-c/2?lt<0?6:4:rt<0?lt<0?2:0:rt<c/2?lt<0?3:1:lt<0?7:5]}).angle(-30).scale(101.858).center([0,45])}var Uu=2/F(3);function Vu(Ne,je){var rt=Ge(Ne,je);return[rt[0]*Uu,rt[1]]}Vu.invert=function(Ne,je){return Ge.invert(Ne/Uu,je)};function kf(Ne){Ne=Ne||function(rt){var lt=u.geoCentroid({type:"MultiPoint",coordinates:rt});return u.geoProjection(Vu).translate([0,0]).scale(1).rotate(lt[1]>0?[-lt[0],0]:[180-lt[0],180])};var je=ml.map(function(rt){return{face:rt,project:Ne(rt)}});return[-1,0,0,1,0,1,4,5].forEach(function(rt,lt){var wt=je[rt];wt&&(wt.children||(wt.children=[])).push(je[lt])}),yl(je[0],function(rt,lt){return je[rt<-c/2?lt<0?6:4:rt<0?lt<0?2:0:rt<c/2?lt<0?3:1:lt<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])}function Hi(Ne){Ne=Ne||function(kt){var hr=kt.length===6?u.geoCentroid({type:"MultiPoint",coordinates:kt}):kt[0];return u.geoGnomonic().scale(1).translate([0,0]).rotate([-hr[0],-hr[1]])};var je=ml.map(function(kt){for(var hr=kt.map(ws),gr=hr.length,fr=hr[gr-1],_r,Rr=[],jr=0;jr<gr;++jr)_r=hr[jr],Rr.push(gs([fr[0]*.9486832980505138+_r[0]*.31622776601683794,fr[1]*.9486832980505138+_r[1]*.31622776601683794,fr[2]*.9486832980505138+_r[2]*.31622776601683794]),gs([_r[0]*.9486832980505138+fr[0]*.31622776601683794,_r[1]*.9486832980505138+fr[1]*.31622776601683794,_r[2]*.9486832980505138+fr[2]*.31622776601683794])),fr=_r;return Rr}),rt=[],lt=[-1,0,0,1,0,1,4,5];je.forEach(function(kt,hr){for(var gr=ml[hr],fr=gr.length,_r=rt[hr]=[],Rr=0;Rr<fr;++Rr)je.push([gr[Rr],kt[(Rr*2+2)%(2*fr)],kt[(Rr*2+1)%(2*fr)]]),lt.push(hr),_r.push(xl(ws(kt[(Rr*2+2)%(2*fr)]),ws(kt[(Rr*2+1)%(2*fr)])))});var wt=je.map(function(kt){return{project:Ne(kt),face:kt}});lt.forEach(function(kt,hr){var gr=wt[kt];gr&&(gr.children||(gr.children=[])).push(wt[hr])});function bt(kt,hr){var gr=n(hr),fr=[gr*n(kt),gr*v(kt),v(hr)],_r=kt<-c/2?hr<0?6:4:kt<0?hr<0?2:0:kt<c/2?hr<0?3:1:hr<0?7:5,Rr=rt[_r];return wt[Rl(Rr[0],fr)<0?8+3*_r:Rl(Rr[1],fr)<0?8+3*_r+1:Rl(Rr[2],fr)<0?8+3*_r+2:_r]}return yl(wt[0],bt).angle(-30).scale(110.625).center([0,45])}function Rl(Ne,je){for(var rt=0,lt=Ne.length,wt=0;rt<lt;++rt)wt+=Ne[rt]*je[rt];return wt}function xl(Ne,je){return[Ne[1]*je[2]-Ne[2]*je[1],Ne[2]*je[0]-Ne[0]*je[2],Ne[0]*je[1]-Ne[1]*je[0]]}function gs(Ne){return[i(Ne[1],Ne[0])*S,B(o(-1,s(1,Ne[2])))*S]}function ws(Ne){var je=Ne[0]*E,rt=Ne[1]*E,lt=n(rt);return[lt*n(je),lt*v(je),v(rt)]}function jl(){}function xo(Ne){if((rt=Ne.length)<4)return!1;for(var je=0,rt,lt=Ne[rt-1][1]*Ne[0][0]-Ne[rt-1][0]*Ne[0][1];++je<rt;)lt+=Ne[je-1][1]*Ne[je][0]-Ne[je-1][0]*Ne[je][1];return lt<=0}function Hu(Ne,je){for(var rt=je[0],lt=je[1],wt=!1,bt=0,kt=Ne.length,hr=kt-1;bt<kt;hr=bt++){var gr=Ne[bt],fr=gr[0],_r=gr[1],Rr=Ne[hr],jr=Rr[0],tn=Rr[1];_r>lt^tn>lt&&rt<(jr-fr)*(lt-_r)/(tn-_r)+fr&&(wt=!wt)}return wt}function Ts(Ne,je){var rt=je.stream,lt;if(!rt)throw new Error("invalid projection");switch(Ne&&Ne.type){case"Feature":lt=rl;break;case"FeatureCollection":lt=tl;break;default:lt=As;break}return lt(Ne,rt)}function tl(Ne,je){return{type:"FeatureCollection",features:Ne.features.map(function(rt){return rl(rt,je)})}}function rl(Ne,je){return{type:"Feature",id:Ne.id,properties:Ne.properties,geometry:As(Ne.geometry,je)}}function Ws(Ne,je){return{type:"GeometryCollection",geometries:Ne.geometries.map(function(rt){return As(rt,je)})}}function As(Ne,je){if(!Ne)return null;if(Ne.type==="GeometryCollection")return Ws(Ne,je);var rt;switch(Ne.type){case"Point":rt=Ms;break;case"MultiPoint":rt=Ms;break;case"LineString":rt=Gu;break;case"MultiLineString":rt=Gu;break;case"Polygon":rt=fu;break;case"MultiPolygon":rt=fu;break;case"Sphere":rt=fu;break;default:return null}return u.geoStream(Ne,je(rt)),rt.result()}var Qi=[],Vo=[],Ms={point:function(Ne,je){Qi.push([Ne,je])},result:function(){var Ne=Qi.length?Qi.length<2?{type:"Point",coordinates:Qi[0]}:{type:"MultiPoint",coordinates:Qi}:null;return Qi=[],Ne}},Gu={lineStart:jl,point:function(Ne,je){Qi.push([Ne,je])},lineEnd:function(){Qi.length&&(Vo.push(Qi),Qi=[])},result:function(){var Ne=Vo.length?Vo.length<2?{type:"LineString",coordinates:Vo[0]}:{type:"MultiLineString",coordinates:Vo}:null;return Vo=[],Ne}},fu={polygonStart:jl,lineStart:jl,point:function(Ne,je){Qi.push([Ne,je])},lineEnd:function(){var Ne=Qi.length;if(Ne){do Qi.push(Qi[0].slice());while(++Ne<4);Vo.push(Qi),Qi=[]}},polygonEnd:jl,result:function(){if(!Vo.length)return null;var Ne=[],je=[];return Vo.forEach(function(rt){xo(rt)?Ne.push([rt]):je.push(rt)}),je.forEach(function(rt){var lt=rt[0];Ne.some(function(wt){if(Hu(wt[0],lt))return wt.push(rt),!0})||Ne.push([rt])}),Vo=[],Ne.length?Ne.length>1?{type:"MultiPolygon",coordinates:Ne}:{type:"Polygon",coordinates:Ne[0]}:null}};function Yu(Ne){var je=Ne(M,0)[0]-Ne(-M,0)[0];function rt(lt,wt){var bt=T(lt)<M,kt=Ne(bt?lt:lt>0?lt-c:lt+c,wt),hr=(kt[0]-kt[1])*y,gr=(kt[0]+kt[1])*y;if(bt)return[hr,gr];var fr=je*y,_r=hr>0^gr>0?-1:1;return[_r*hr-p(gr)*fr,_r*gr-p(hr)*fr]}return Ne.invert&&(rt.invert=function(lt,wt){var bt=(lt+wt)*y,kt=(wt-lt)*y,hr=T(bt)<.5*je&&T(kt)<.5*je;if(!hr){var gr=je*y,fr=bt>0^kt>0?-1:1,_r=-fr*lt+(kt>0?1:-1)*gr,Rr=-fr*wt+(bt>0?1:-1)*gr;bt=(-_r-Rr)*y,kt=(_r-Rr)*y}var jr=Ne.invert(bt,kt);return hr||(jr[0]+=bt>0?c:-c),jr}),u.geoProjection(rt).rotate([-90,-90,45]).clipAngle(180-.001)}function xt(){return Yu(Tr).scale(176.423)}function Ot(){return Yu(ya).scale(111.48)}function vr(Ne,je){if(!(0<=(je=+je)&&je<=20))throw new Error("invalid digits");function rt(fr){var _r=fr.length,Rr=2,jr=new Array(_r);for(jr[0]=+fr[0].toFixed(je),jr[1]=+fr[1].toFixed(je);Rr<_r;)jr[Rr]=fr[Rr],++Rr;return jr}function lt(fr){return fr.map(rt)}function wt(fr){for(var _r=rt(fr[0]),Rr=[_r],jr=1;jr<fr.length;jr++){var tn=rt(fr[jr]);(tn.length>2||tn[0]!=_r[0]||tn[1]!=_r[1])&&(Rr.push(tn),_r=tn)}return Rr.length===1&&fr.length>1&&Rr.push(rt(fr[fr.length-1])),Rr}function bt(fr){return fr.map(wt)}function kt(fr){if(fr==null)return fr;var _r;switch(fr.type){case"GeometryCollection":_r={type:"GeometryCollection",geometries:fr.geometries.map(kt)};break;case"Point":_r={type:"Point",coordinates:rt(fr.coordinates)};break;case"MultiPoint":_r={type:fr.type,coordinates:lt(fr.coordinates)};break;case"LineString":_r={type:fr.type,coordinates:wt(fr.coordinates)};break;case"MultiLineString":case"Polygon":_r={type:fr.type,coordinates:bt(fr.coordinates)};break;case"MultiPolygon":_r={type:"MultiPolygon",coordinates:fr.coordinates.map(bt)};break;default:return fr}return fr.bbox!=null&&(_r.bbox=fr.bbox),_r}function hr(fr){var _r={type:"Feature",properties:fr.properties,geometry:kt(fr.geometry)};return fr.id!=null&&(_r.id=fr.id),fr.bbox!=null&&(_r.bbox=fr.bbox),_r}if(Ne!=null)switch(Ne.type){case"Feature":return hr(Ne);case"FeatureCollection":{var gr={type:"FeatureCollection",features:Ne.features.map(hr)};return Ne.bbox!=null&&(gr.bbox=Ne.bbox),gr}default:return kt(Ne)}return Ne}function lr(Ne){var je=v(Ne);function rt(lt,wt){var bt=je?x(lt*je/2)/je:lt/2;if(!wt)return[2*bt,-Ne];var kt=2*e(bt*v(wt)),hr=1/x(wt);return[v(kt)*hr,wt+(1-n(kt))*hr-Ne]}return rt.invert=function(lt,wt){if(T(wt+=Ne)<l)return[je?2*e(je*lt/2)/je:lt,0];var bt=lt*lt+wt*wt,kt=0,hr=10,gr;do{var fr=x(kt),_r=1/n(kt),Rr=bt-2*wt*kt+kt*kt;kt-=gr=(fr*Rr+2*(kt-wt))/(2+Rr*_r*_r+2*(kt-wt)*fr)}while(T(gr)>l&&--hr>0);var jr=lt*(fr=x(kt)),tn=x(T(wt)<T(kt+1/fr)?B(jr)*.5:z(jr)*.5+c/4)/v(kt);return[je?2*e(je*tn)/je:2*tn,kt]},rt}function Ir(){return Xe(lr).scale(131.215)}var nn=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];nn.forEach(function(Ne){Ne[1]*=1.0144});function yn(Ne,je){var rt=s(18,T(je)*36/c),lt=r(rt),wt=rt-lt,bt=(Rr=nn[lt])[0],kt=Rr[1],hr=(Rr=nn[++lt])[0],gr=Rr[1],fr=(Rr=nn[s(19,++lt)])[0],_r=Rr[1],Rr;return[Ne*(hr+wt*(fr-bt)/2+wt*wt*(fr-2*hr+bt)/2),(je>0?M:-M)*(gr+wt*(_r-kt)/2+wt*wt*(_r-2*gr+kt)/2)]}yn.invert=function(Ne,je){var rt=je/M,lt=rt*90,wt=s(18,T(lt/5)),bt=o(0,r(wt));do{var kt=nn[bt][1],hr=nn[bt+1][1],gr=nn[s(19,bt+2)][1],fr=gr-kt,_r=gr-2*hr+kt,Rr=2*(T(rt)-hr)/fr,jr=_r/fr,tn=Rr*(1-jr*Rr*(1-2*jr*Rr));if(tn>=0||bt===1){lt=(je>=0?5:-5)*(tn+wt);var wn=50,Rn;do wt=s(18,T(lt)/5),bt=r(wt),tn=wt-bt,kt=nn[bt][1],hr=nn[bt+1][1],gr=nn[s(19,bt+2)][1],lt-=(Rn=(je>=0?M:-M)*(hr+tn*(gr-kt)/2+tn*tn*(gr-2*hr+kt)/2)-je)*S;while(T(Rn)>b&&--wn>0);break}}while(--bt>=0);var Zn=nn[bt][0],xa=nn[bt+1][0],wa=nn[s(19,bt+2)][0];return[Ne/(xa+tn*(wa-Zn)/2+tn*tn*(wa-2*xa+Zn)/2),lt*E]};function En(){return u.geoProjection(yn).scale(152.63)}function Pn(Ne){function je(rt,lt){var wt=n(lt),bt=(Ne-1)/(Ne-wt*n(rt));return[bt*wt*v(rt),bt*v(lt)]}return je.invert=function(rt,lt){var wt=rt*rt+lt*lt,bt=F(wt),kt=(Ne-F(1-wt*(Ne+1)/(Ne-1)))/((Ne-1)/bt+bt/(Ne-1));return[i(rt*kt,bt*F(1-kt*kt)),bt?B(lt*kt/bt):0]},je}function Vn(Ne,je){var rt=Pn(Ne);if(!je)return rt;var lt=n(je),wt=v(je);function bt(kt,hr){var gr=rt(kt,hr),fr=gr[1],_r=fr*wt/(Ne-1)+lt;return[gr[0]*lt/_r,fr/_r]}return bt.invert=function(kt,hr){var gr=(Ne-1)/(Ne-1-hr*wt);return rt.invert(gr*kt,gr*hr*lt)},bt}function xn(){var Ne=2,je=0,rt=u.geoProjectionMutator(Vn),lt=rt(Ne,je);return lt.distance=function(wt){return arguments.length?rt(Ne=+wt,je):Ne},lt.tilt=function(wt){return arguments.length?rt(Ne,je=wt*E):je*S},lt.scale(432.147).clipAngle(z(1/Ne)*S-1e-6)}var Bn=1e-4,Fn=1e4,Gn=-180,ea=Gn+Bn,Na=180,La=Na-Bn,Oa=-90,Ua=Oa+Bn,$n=90,da=$n-Bn;function Za(Ne){return Ne.length>0}function ti(Ne){return Math.floor(Ne*Fn)/Fn}function wi(Ne){return Ne===Oa||Ne===$n?[0,Ne]:[Gn,ti(Ne)]}function Ti(Ne){var je=Ne[0],rt=Ne[1],lt=!1;return je<=ea?(je=Gn,lt=!0):je>=La&&(je=Na,lt=!0),rt<=Ua?(rt=Oa,lt=!0):rt>=da&&(rt=$n,lt=!0),lt?[je,rt]:Ne}function Si(Ne){return Ne.map(Ti)}function Fi(Ne,je,rt){for(var lt=0,wt=Ne.length;lt<wt;++lt){var bt=Ne[lt].slice();rt.push({index:-1,polygon:je,ring:bt});for(var kt=0,hr=bt.length;kt<hr;++kt){var gr=bt[kt],fr=gr[0],_r=gr[1];if(fr<=ea||fr>=La||_r<=Ua||_r>=da){bt[kt]=Ti(gr);for(var Rr=kt+1;Rr<hr;++Rr){var jr=bt[Rr],tn=jr[0],wn=jr[1];if(tn>ea&&tn<La&&wn>Ua&&wn<da)break}if(Rr===kt+1)continue;if(kt){var Rn={index:-1,polygon:je,ring:bt.slice(0,kt+1)};Rn.ring[Rn.ring.length-1]=wi(_r),rt[rt.length-1]=Rn}else rt.pop();if(Rr>=hr)break;rt.push({index:-1,polygon:je,ring:bt=bt.slice(Rr-1)}),bt[0]=wi(bt[0][1]),kt=-1,hr=bt.length}}}}function fi(Ne){var je,rt=Ne.length,lt={},wt={},bt,kt,hr,gr,fr;for(je=0;je<rt;++je){if(bt=Ne[je],kt=bt.ring[0],gr=bt.ring[bt.ring.length-1],kt[0]===gr[0]&&kt[1]===gr[1]){bt.polygon.push(bt.ring),Ne[je]=null;continue}bt.index=je,lt[kt]=wt[gr]=bt}for(je=0;je<rt;++je)if(bt=Ne[je],bt){if(kt=bt.ring[0],gr=bt.ring[bt.ring.length-1],hr=wt[kt],fr=lt[gr],delete lt[kt],delete wt[gr],kt[0]===gr[0]&&kt[1]===gr[1]){bt.polygon.push(bt.ring);continue}hr?(delete wt[kt],delete lt[hr.ring[0]],hr.ring.pop(),Ne[hr.index]=null,bt={index:-1,polygon:hr.polygon,ring:hr.ring.concat(bt.ring)},hr===fr?bt.polygon.push(bt.ring):(bt.index=rt++,Ne.push(lt[bt.ring[0]]=wt[bt.ring[bt.ring.length-1]]=bt))):fr?(delete lt[gr],delete wt[fr.ring[fr.ring.length-1]],bt.ring.pop(),bt={index:rt++,polygon:fr.polygon,ring:bt.ring.concat(fr.ring)},Ne[fr.index]=null,Ne.push(lt[bt.ring[0]]=wt[bt.ring[bt.ring.length-1]]=bt)):(bt.ring.push(bt.ring[0]),bt.polygon.push(bt.ring))}}function ko(Ne){var je={type:"Feature",geometry:uo(Ne.geometry)};return Ne.id!=null&&(je.id=Ne.id),Ne.bbox!=null&&(je.bbox=Ne.bbox),Ne.properties!=null&&(je.properties=Ne.properties),je}function uo(Ne){if(Ne==null)return Ne;var je,rt,lt,wt;switch(Ne.type){case"GeometryCollection":je={type:"GeometryCollection",geometries:Ne.geometries.map(uo)};break;case"Point":je={type:"Point",coordinates:Ti(Ne.coordinates)};break;case"MultiPoint":case"LineString":je={type:Ne.type,coordinates:Si(Ne.coordinates)};break;case"MultiLineString":je={type:"MultiLineString",coordinates:Ne.coordinates.map(Si)};break;case"Polygon":{var bt=[];Fi(Ne.coordinates,bt,rt=[]),fi(rt),je={type:"Polygon",coordinates:bt};break}case"MultiPolygon":{rt=[],lt=-1,wt=Ne.coordinates.length;for(var kt=new Array(wt);++lt<wt;)Fi(Ne.coordinates[lt],kt[lt]=[],rt);fi(rt),je={type:"MultiPolygon",coordinates:kt.filter(Za)};break}default:return Ne}return Ne.bbox!=null&&(je.bbox=Ne.bbox),je}function ei(Ne){if(Ne==null)return Ne;switch(Ne.type){case"Feature":return ko(Ne);case"FeatureCollection":{var je={type:"FeatureCollection",features:Ne.features.map(ko)};return Ne.bbox!=null&&(je.bbox=Ne.bbox),je}default:return uo(Ne)}}function ga(Ne,je){var rt=x(je/2),lt=v(_*rt);return[Ne*(.74482-.34588*lt*lt),1.70711*rt]}ga.invert=function(Ne,je){var rt=je/1.70711,lt=v(_*rt);return[Ne/(.74482-.34588*lt*lt),2*e(rt)]};function Ei(){return u.geoProjection(ga).scale(146.153)}function bo(Ne,je,rt){var lt=u.geoInterpolate(je,rt),wt=lt(.5),bt=u.geoRotation([-wt[0],-wt[1]])(je),kt=lt.distance/2,hr=-B(v(bt[1]*E)/v(kt)),gr=[-wt[0],-wt[1],-(bt[0]>0?c-hr:hr)*S],fr=u.geoProjection(Ne(kt)).rotate(gr),_r=u.geoRotation(gr),Rr=fr.center;return delete fr.rotate,fr.center=function(jr){return arguments.length?Rr(_r(jr)):_r.invert(Rr())},fr.clipAngle(90)}function So(Ne){var je=n(Ne);function rt(lt,wt){var bt=u.geoGnomonicRaw(lt,wt);return bt[0]*=je,bt}return rt.invert=function(lt,wt){return u.geoGnomonicRaw.invert(lt/je,wt)},rt}function Ss(){return Xs([-158,21.5],[-77,39]).clipAngle(60).scale(400)}function Xs(Ne,je){return bo(So,Ne,je)}function Jo(Ne){if(!(Ne*=2))return u.geoAzimuthalEquidistantRaw;var je=-Ne/2,rt=-je,lt=Ne*Ne,wt=x(rt),bt=.5/v(rt);function kt(hr,gr){var fr=z(n(gr)*n(hr-je)),_r=z(n(gr)*n(hr-rt)),Rr=gr<0?-1:1;return fr*=fr,_r*=_r,[(fr-_r)/(2*Ne),Rr*F(4*lt*_r-(lt-fr+_r)*(lt-fr+_r))/(2*Ne)]}return kt.invert=function(hr,gr){var fr=gr*gr,_r=n(F(fr+(jr=hr+je)*jr)),Rr=n(F(fr+(jr=hr+rt)*jr)),jr,tn;return[i(tn=_r-Rr,jr=(_r+Rr)*wt),(gr<0?-1:1)*z(F(jr*jr+tn*tn)*bt)]},kt}function bl(){return zs([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)}function zs(Ne,je){return bo(Jo,Ne,je)}function Es(Ne,je){if(T(je)<l)return[Ne,0];var rt=T(je/M),lt=B(rt);if(T(Ne)<l||T(T(je)-M)<l)return[0,p(je)*c*x(lt/2)];var wt=n(lt),bt=T(c/Ne-Ne/c)/2,kt=bt*bt,hr=wt/(rt+wt-1),gr=hr*(2/rt-1),fr=gr*gr,_r=fr+kt,Rr=hr-fr,jr=kt+hr;return[p(Ne)*c*(bt*Rr+F(kt*Rr*Rr-_r*(hr*hr-fr)))/_r,p(je)*c*(gr*jr-bt*F((kt+1)*_r-jr*jr))/_r]}Es.invert=function(Ne,je){if(T(je)<l)return[Ne,0];if(T(Ne)<l)return[0,M*v(2*e(je/c))];var rt=(Ne/=c)*Ne,lt=(je/=c)*je,wt=rt+lt,bt=wt*wt,kt=-T(je)*(1+wt),hr=kt-2*lt+rt,gr=-2*kt+1+2*lt+bt,fr=lt/gr+(2*hr*hr*hr/(gr*gr*gr)-9*kt*hr/(gr*gr))/27,_r=(kt-hr*hr/(3*gr))/gr,Rr=2*F(-_r/3),jr=z(3*fr/(_r*Rr))/3;return[c*(wt-1+F(1+2*(rt-lt)+bt))/(2*Ne),p(je)*c*(-Rr*n(jr+c/3)-hr/(3*gr))]};function Do(){return u.geoProjection(Es).scale(79.4183)}function cu(Ne,je){if(T(je)<l)return[Ne,0];var rt=T(je/M),lt=B(rt);if(T(Ne)<l||T(T(je)-M)<l)return[0,p(je)*c*x(lt/2)];var wt=n(lt),bt=T(c/Ne-Ne/c)/2,kt=bt*bt,hr=wt*(F(1+kt)-bt*wt)/(1+kt*rt*rt);return[p(Ne)*c*hr,p(je)*c*F(1-hr*(2*bt+hr))]}cu.invert=function(Ne,je){if(!Ne)return[0,M*v(2*e(je/c))];var rt=T(Ne/c),lt=(1-rt*rt-(je/=c)*je)/(2*rt),wt=lt*lt,bt=F(wt+1);return[p(Ne)*c*(bt-lt),p(je)*M*v(2*i(F((1-2*lt*rt)*(lt+bt)-rt),F(bt+lt+rt)))]};function Mu(){return u.geoProjection(cu).scale(79.4183)}function Cs(Ne,je){if(T(je)<l)return[Ne,0];var rt=je/M,lt=B(rt);if(T(Ne)<l||T(T(je)-M)<l)return[0,c*x(lt/2)];var wt=(c/Ne-Ne/c)/2,bt=rt/(1+n(lt));return[c*(p(Ne)*F(wt*wt+1-bt*bt)-wt),c*bt]}Cs.invert=function(Ne,je){if(!je)return[Ne,0];var rt=je/c,lt=(c*c*(1-rt*rt)-Ne*Ne)/(2*c*Ne);return[Ne?c*(p(Ne)*F(lt*lt+1)-lt):0,M*v(2*e(rt))]};function Wu(){return u.geoProjection(Cs).scale(79.4183)}function hu(Ne,je){if(!je)return[Ne,0];var rt=T(je);if(!Ne||rt===M)return[0,je];var lt=rt/M,wt=lt*lt,bt=(8*lt-wt*(wt+2)-5)/(2*wt*(lt-1)),kt=bt*bt,hr=lt*bt,gr=wt+kt+2*hr,fr=lt+3*bt,_r=Ne/M,Rr=_r+1/_r,jr=p(T(Ne)-M)*F(Rr*Rr-4),tn=jr*jr,wn=gr*(wt+kt*tn-1)+(1-wt)*(wt*(fr*fr+4*kt)+12*hr*kt+4*kt*kt),Rn=(jr*(gr+kt-1)+2*F(wn))/(4*gr+tn);return[p(Ne)*M*Rn,p(je)*M*F(1+jr*T(Rn)-Rn*Rn)]}hu.invert=function(Ne,je){var rt;if(!Ne||!je)return[Ne,je];je/=c;var lt=p(Ne)*Ne/M,wt=(lt*lt-1+4*je*je)/T(lt),bt=wt*wt,kt=2*je,hr=50;do{var gr=kt*kt,fr=(8*kt-gr*(gr+2)-5)/(2*gr*(kt-1)),_r=(3*kt-gr*kt-10)/(2*gr*kt),Rr=fr*fr,jr=kt*fr,tn=kt+fr,wn=tn*tn,Rn=kt+3*fr,Zn=wn*(gr+Rr*bt-1)+(1-gr)*(gr*(Rn*Rn+4*Rr)+Rr*(12*jr+4*Rr)),xa=-2*tn*(4*jr*Rr+(1-4*gr+3*gr*gr)*(1+_r)+Rr*(-6+14*gr-bt+(-8+8*gr-2*bt)*_r)+jr*(-8+12*gr+(-10+10*gr-bt)*_r)),wa=F(Zn),qa=wt*(wn+Rr-1)+2*wa-lt*(4*wn+bt),ja=wt*(2*fr*_r+2*tn*(1+_r))+xa/wa-8*tn*(wt*(-1+Rr+wn)+2*wa)*(1+_r)/(bt+4*wn);kt-=rt=qa/ja}while(rt>l&&--hr>0);return[p(Ne)*(F(wt*wt+4)+wt)*c/4,M*kt]};function lc(){return u.geoProjection(hu).scale(127.16)}function pf(Ne,je,rt,lt,wt){function bt(kt,hr){var gr=rt*v(lt*hr),fr=F(1-gr*gr),_r=F(2/(1+fr*n(kt*=wt)));return[Ne*fr*_r*v(kt),je*gr*_r]}return bt.invert=function(kt,hr){var gr=kt/Ne,fr=hr/je,_r=F(gr*gr+fr*fr),Rr=2*B(_r/2);return[i(kt*x(Rr),Ne*_r)/wt,_r&&B(hr*v(Rr)/(je*rt*_r))/lt]},bt}function Xu(Ne,je,rt,lt){var wt=c/3;Ne=o(Ne,l),je=o(je,l),Ne=s(Ne,M),je=s(je,c-l),rt=o(rt,0),rt=s(rt,100-l),lt=o(lt,l);var bt=rt/100+1,kt=lt/100,hr=z(bt*n(wt))/wt,gr=v(Ne)/v(hr*M),fr=je/c,_r=F(kt*v(Ne/2)/v(je/2)),Rr=_r/F(fr*gr*hr),jr=1/(_r*F(fr*gr*hr));return pf(Rr,jr,gr,hr,fr)}function df(){var Ne=65*E,je=60*E,rt=20,lt=200,wt=u.geoProjectionMutator(Xu),bt=wt(Ne,je,rt,lt);return bt.poleline=function(kt){return arguments.length?wt(Ne=+kt*E,je,rt,lt):Ne*S},bt.parallels=function(kt){return arguments.length?wt(Ne,je=+kt*E,rt,lt):je*S},bt.inflation=function(kt){return arguments.length?wt(Ne,je,rt=+kt,lt):rt},bt.ratio=function(kt){return arguments.length?wt(Ne,je,rt,lt=+kt):lt},bt.scale(163.775)}function Zs(){return df().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)}var Df=4*c+3*F(3),gf=2*F(2*c*F(3)/Df),yf=_e(gf*F(3)/c,gf,Df/6);function Ko(){return u.geoProjection(yf).scale(176.84)}function mf(Ne,je){return[Ne*F(1-3*je*je/(c*c)),je]}mf.invert=function(Ne,je){return[Ne/F(1-3*je*je/(c*c)),je]};function Vf(){return u.geoProjection(mf).scale(152.63)}function Bs(Ne,je){var rt=n(je),lt=n(Ne)*rt,wt=1-lt,bt=n(Ne=i(v(Ne)*rt,-v(je))),kt=v(Ne);return rt=F(1-lt*lt),[kt*rt-bt*wt,-bt*rt-kt*wt]}Bs.invert=function(Ne,je){var rt=(Ne*Ne+je*je)/-2,lt=F(-rt*(2+rt)),wt=je*rt+Ne*lt,bt=Ne*rt-je*lt,kt=F(bt*bt+wt*wt);return[i(lt*wt,kt*(1+rt)),kt?-B(lt*bt/kt):0]};function Zu(){return u.geoProjection(Bs).rotate([0,-90,45]).scale(124.75).clipAngle(180-.001)}function ju(Ne,je){var rt=X(Ne,je);return[(rt[0]+Ne/M)/2,(rt[1]+je)/2]}ju.invert=function(Ne,je){var rt=Ne,lt=je,wt=25;do{var bt=n(lt),kt=v(lt),hr=v(2*lt),gr=kt*kt,fr=bt*bt,_r=v(rt),Rr=n(rt/2),jr=v(rt/2),tn=jr*jr,wn=1-fr*Rr*Rr,Rn=wn?z(bt*Rr)*F(Zn=1/wn):Zn=0,Zn,xa=.5*(2*Rn*bt*jr+rt/M)-Ne,wa=.5*(Rn*kt+lt)-je,qa=.5*Zn*(fr*tn+Rn*bt*Rr*gr)+.5/M,ja=Zn*(_r*hr/4-Rn*kt*jr),ai=.125*Zn*(hr*jr-Rn*kt*fr*_r),mi=.5*Zn*(gr*Rr+Rn*tn*bt)+.5,po=ja*ai-mi*qa,oi=(wa*ja-xa*mi)/po,$i=(xa*ai-wa*qa)/po;rt-=oi,lt-=$i}while((T(oi)>l||T($i)>l)&&--wt>0);return[rt,lt]};function xf(){return u.geoProjection(ju).scale(158.837)}h.geoNaturalEarth=u.geoNaturalEarth1,h.geoNaturalEarthRaw=u.geoNaturalEarth1Raw,h.geoAiry=Z,h.geoAiryRaw=j,h.geoAitoff=re,h.geoAitoffRaw=X,h.geoArmadillo=K,h.geoArmadilloRaw=ue,h.geoAugust=G,h.geoAugustRaw=te,h.geoBaker=J,h.geoBakerRaw=ne,h.geoBerghaus=ae,h.geoBerghausRaw=q,h.geoBertin1953=be,h.geoBertin1953Raw=he,h.geoBoggs=He,h.geoBoggsRaw=Ce,h.geoBonne=vt,h.geoBonneRaw=We,h.geoBottomley=Zt,h.geoBottomleyRaw=Pt,h.geoBromley=At,h.geoBromleyRaw=zt,h.geoChamberlin=Ee,h.geoChamberlinRaw=Ze,h.geoChamberlinAfrica=Ye,h.geoCollignon=Je,h.geoCollignonRaw=Ge,h.geoCraig=Tt,h.geoCraigRaw=qe,h.geoCraster=Ht,h.geoCrasterRaw=Mt,h.geoCylindricalEqualArea=Vt,h.geoCylindricalEqualAreaRaw=Rt,h.geoCylindricalStereographic=Yt,h.geoCylindricalStereographicRaw=Jt,h.geoEckert1=Hr,h.geoEckert1Raw=or,h.geoEckert2=Kr,h.geoEckert2Raw=an,h.geoEckert3=er,h.geoEckert3Raw=ot,h.geoEckert4=ur,h.geoEckert4Raw=Kt,h.geoEckert5=et,h.geoEckert5Raw=Ar,h.geoEckert6=st,h.geoEckert6Raw=$e,h.geoEisenlohr=Ut,h.geoEisenlohrRaw=St,h.geoFahey=it,h.geoFaheyRaw=ke,h.geoFoucaut=ht,h.geoFoucautRaw=ut,h.geoFoucautSinusoidal=yt,h.geoFoucautSinusoidalRaw=Et,h.geoGilbert=ar,h.geoGingery=Zr,h.geoGingeryRaw=kr,h.geoGinzburg4=Fr,h.geoGinzburg4Raw=xr,h.geoGinzburg5=Cr,h.geoGinzburg5Raw=Or,h.geoGinzburg6=Ft,h.geoGinzburg6Raw=at,h.geoGinzburg8=sr,h.geoGinzburg8Raw=jt,h.geoGinzburg9=Ur,h.geoGinzburg9Raw=zr,h.geoGringorten=vn,h.geoGringortenRaw=Tr,h.geoGuyou=Xa,h.geoGuyouRaw=ya,h.geoHammer=se,h.geoHammerRaw=le,h.geoHammerRetroazimuthal=Mr,h.geoHammerRetroazimuthalRaw=$a,h.geoHealpix=Ga,h.geoHealpixRaw=Jn,h.geoHill=Gt,h.geoHillRaw=vi,h.geoHomolosine=_n,h.geoHomolosineRaw=Mn,h.geoHufnagel=mr,h.geoHufnagelRaw=cn,h.geoHyperelliptical=On,h.geoHyperellipticalRaw=mn,h.geoInterrupt=oa,h.geoInterruptedBoggs=_a,h.geoInterruptedHomolosine=Ea,h.geoInterruptedMollweide=jo,h.geoInterruptedMollweideHemispheres=El,h.geoInterruptedSinuMollweide=mu,h.geoInterruptedSinusoidal=cl,h.geoKavrayskiy7=Ki,h.geoKavrayskiy7Raw=$s,h.geoLagrange=Ul,h.geoLagrangeRaw=No,h.geoLarrivee=Cl,h.geoLarriveeRaw=Vi,h.geoLaskowski=Wi,h.geoLaskowskiRaw=io,h.geoLittrow=oo,h.geoLittrowRaw=vo,h.geoLoximuthal=hl,h.geoLoximuthalRaw=bs,h.geoMiller=ps,h.geoMillerRaw=Ru,h.geoModifiedStereographic=Hs,h.geoModifiedStereographicRaw=Iu,h.geoModifiedStereographicAlaska=nu,h.geoModifiedStereographicGs48=uf,h.geoModifiedStereographicGs50=ff,h.geoModifiedStereographicMiller=vl,h.geoModifiedStereographicLee=au,h.geoMollweide=De,h.geoMollweideRaw=Se,h.geoMtFlatPolarParabolic=zu,h.geoMtFlatPolarParabolicRaw=bu,h.geoMtFlatPolarQuartic=cf,h.geoMtFlatPolarQuarticRaw=iu,h.geoMtFlatPolarSinusoidal=_u,h.geoMtFlatPolarSinusoidalRaw=pl,h.geoNaturalEarth2=Fs,h.geoNaturalEarth2Raw=ou,h.geoNellHammer=wu,h.geoNellHammerRaw=Vl,h.geoInterruptedQuarticAuthalic=Nu,h.geoNicolosi=hf,h.geoNicolosiRaw=su,h.geoPatterson=mo,h.geoPattersonRaw=Ys,h.geoPolyconic=Gl,h.geoPolyconicRaw=Hl,h.geoPolyhedral=yl,h.geoPolyhedralButterfly=Zl,h.geoPolyhedralCollignon=kf,h.geoPolyhedralWaterman=Hi,h.geoProject=Ts,h.geoGringortenQuincuncial=xt,h.geoPeirceQuincuncial=Ot,h.geoPierceQuincuncial=Ot,h.geoQuantize=vr,h.geoQuincuncial=Yu,h.geoRectangularPolyconic=Ir,h.geoRectangularPolyconicRaw=lr,h.geoRobinson=En,h.geoRobinsonRaw=yn,h.geoSatellite=xn,h.geoSatelliteRaw=Vn,h.geoSinuMollweide=rn,h.geoSinuMollweideRaw=dn,h.geoSinusoidal=Re,h.geoSinusoidalRaw=Be,h.geoStitch=ei,h.geoTimes=Ei,h.geoTimesRaw=ga,h.geoTwoPointAzimuthal=Xs,h.geoTwoPointAzimuthalRaw=So,h.geoTwoPointAzimuthalUsa=Ss,h.geoTwoPointEquidistant=zs,h.geoTwoPointEquidistantRaw=Jo,h.geoTwoPointEquidistantUsa=bl,h.geoVanDerGrinten=Do,h.geoVanDerGrintenRaw=Es,h.geoVanDerGrinten2=Mu,h.geoVanDerGrinten2Raw=cu,h.geoVanDerGrinten3=Wu,h.geoVanDerGrinten3Raw=Cs,h.geoVanDerGrinten4=lc,h.geoVanDerGrinten4Raw=hu,h.geoWagner=df,h.geoWagner7=Zs,h.geoWagnerRaw=Xu,h.geoWagner4=Ko,h.geoWagner4Raw=yf,h.geoWagner6=Vf,h.geoWagner6Raw=mf,h.geoWiechel=Zu,h.geoWiechelRaw=Bs,h.geoWinkel3=xf,h.geoWinkel3Raw=ju,Object.defineProperty(h,"__esModule",{value:!0})})},{"d3-array":107,"d3-geo":114}],114:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R,t("d3-array")):(h=h||self,u(h.d3=h.d3||{},h.d3))})(this,function(h,u){function A(){return new T}function T(){this.reset()}T.prototype={constructor:T,reset:function(){this.s=this.t=0},add:function(xt){i(e,xt,this.t),i(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new T;function i(xt,Ot,vr){var lr=xt.s=Ot+vr,Ir=lr-Ot,nn=lr-Ir;xt.t=Ot-nn+(vr-Ir)}var n=1e-6,a=1e-12,r=Math.PI,f=r/2,o=r/4,s=r*2,m=180/r,g=r/180,p=Math.abs,v=Math.atan,x=Math.atan2,l=Math.cos,b=Math.ceil,c=Math.exp,M=Math.log,_=Math.pow,y=Math.sin,w=Math.sign||function(xt){return xt>0?1:xt<0?-1:0},d=Math.sqrt,C=Math.tan;function S(xt){return xt>1?0:xt<-1?r:Math.acos(xt)}function E(xt){return xt>1?f:xt<-1?-f:Math.asin(xt)}function k(xt){return(xt=y(xt/2))*xt}function B(){}function z(xt,Ot){xt&&I.hasOwnProperty(xt.type)&&I[xt.type](xt,Ot)}var F={Feature:function(xt,Ot){z(xt.geometry,Ot)},FeatureCollection:function(xt,Ot){for(var vr=xt.features,lr=-1,Ir=vr.length;++lr<Ir;)z(vr[lr].geometry,Ot)}},I={Sphere:function(xt,Ot){Ot.sphere()},Point:function(xt,Ot){xt=xt.coordinates,Ot.point(xt[0],xt[1],xt[2])},MultiPoint:function(xt,Ot){for(var vr=xt.coordinates,lr=-1,Ir=vr.length;++lr<Ir;)xt=vr[lr],Ot.point(xt[0],xt[1],xt[2])},LineString:function(xt,Ot){O(xt.coordinates,Ot,0)},MultiLineString:function(xt,Ot){for(var vr=xt.coordinates,lr=-1,Ir=vr.length;++lr<Ir;)O(vr[lr],Ot,0)},Polygon:function(xt,Ot){N(xt.coordinates,Ot)},MultiPolygon:function(xt,Ot){for(var vr=xt.coordinates,lr=-1,Ir=vr.length;++lr<Ir;)N(vr[lr],Ot)},GeometryCollection:function(xt,Ot){for(var vr=xt.geometries,lr=-1,Ir=vr.length;++lr<Ir;)z(vr[lr],Ot)}};function O(xt,Ot,vr){var lr=-1,Ir=xt.length-vr,nn;for(Ot.lineStart();++lr<Ir;)nn=xt[lr],Ot.point(nn[0],nn[1],nn[2]);Ot.lineEnd()}function N(xt,Ot){var vr=-1,lr=xt.length;for(Ot.polygonStart();++vr<lr;)O(xt[vr],Ot,1);Ot.polygonEnd()}function V(xt,Ot){xt&&F.hasOwnProperty(xt.type)?F[xt.type](xt,Ot):z(xt,Ot)}var H=A(),j=A(),Z,X,re,ue,K,te={point:B,lineStart:B,lineEnd:B,polygonStart:function(){H.reset(),te.lineStart=G,te.lineEnd=Y},polygonEnd:function(){var xt=+H;j.add(xt<0?s+xt:xt),this.lineStart=this.lineEnd=this.point=B},sphere:function(){j.add(s)}};function G(){te.point=ee}function Y(){ne(Z,X)}function ee(xt,Ot){te.point=ne,Z=xt,X=Ot,xt*=g,Ot*=g,re=xt,ue=l(Ot=Ot/2+o),K=y(Ot)}function ne(xt,Ot){xt*=g,Ot*=g,Ot=Ot/2+o;var vr=xt-re,lr=vr>=0?1:-1,Ir=lr*vr,nn=l(Ot),yn=y(Ot),En=K*yn,Pn=ue*nn+En*l(Ir),Vn=En*lr*y(Ir);H.add(x(Vn,Pn)),re=xt,ue=nn,K=yn}function J(xt){return j.reset(),V(xt,te),j*2}function q(xt){return[x(xt[1],xt[0]),E(xt[2])]}function ae(xt){var Ot=xt[0],vr=xt[1],lr=l(vr);return[lr*l(Ot),lr*y(Ot),y(vr)]}function le(xt,Ot){return xt[0]*Ot[0]+xt[1]*Ot[1]+xt[2]*Ot[2]}function ie(xt,Ot){return[xt[1]*Ot[2]-xt[2]*Ot[1],xt[2]*Ot[0]-xt[0]*Ot[2],xt[0]*Ot[1]-xt[1]*Ot[0]]}function se(xt,Ot){xt[0]+=Ot[0],xt[1]+=Ot[1],xt[2]+=Ot[2]}function xe(xt,Ot){return[xt[0]*Ot,xt[1]*Ot,xt[2]*Ot]}function oe(xt){var Ot=d(xt[0]*xt[0]+xt[1]*xt[1]+xt[2]*xt[2]);xt[0]/=Ot,xt[1]/=Ot,xt[2]/=Ot}var he,be,me,_e,Se,De,Ie,Te,Ce=A(),He,Xe,Be={point:Re,lineStart:vt,lineEnd:Pt,polygonStart:function(){Be.point=Zt,Be.lineStart=zt,Be.lineEnd=At,Ce.reset(),te.polygonStart()},polygonEnd:function(){te.polygonEnd(),Be.point=Re,Be.lineStart=vt,Be.lineEnd=Pt,H<0?(he=-(me=180),be=-(_e=90)):Ce>n?_e=90:Ce<-n&&(be=-90),Xe[0]=he,Xe[1]=me},sphere:function(){he=-(me=180),be=-(_e=90)}};function Re(xt,Ot){He.push(Xe=[he=xt,me=xt]),Ot<be&&(be=Ot),Ot>_e&&(_e=Ot)}function We(xt,Ot){var vr=ae([xt*g,Ot*g]);if(Te){var lr=ie(Te,vr),Ir=[lr[1],-lr[0],0],nn=ie(Ir,lr);oe(nn),nn=q(nn);var yn=xt-Se,En=yn>0?1:-1,Pn=nn[0]*m*En,Vn,xn=p(yn)>180;xn^(En*Se<Pn&&Pn<En*xt)?(Vn=nn[1]*m,Vn>_e&&(_e=Vn)):(Pn=(Pn+360)%360-180,xn^(En*Se<Pn&&Pn<En*xt)?(Vn=-nn[1]*m,Vn<be&&(be=Vn)):(Ot<be&&(be=Ot),Ot>_e&&(_e=Ot))),xn?xt<Se?Wt(he,xt)>Wt(he,me)&&(me=xt):Wt(xt,me)>Wt(he,me)&&(he=xt):me>=he?(xt<he&&(he=xt),xt>me&&(me=xt)):xt>Se?Wt(he,xt)>Wt(he,me)&&(me=xt):Wt(xt,me)>Wt(he,me)&&(he=xt)}else He.push(Xe=[he=xt,me=xt]);Ot<be&&(be=Ot),Ot>_e&&(_e=Ot),Te=vr,Se=xt}function vt(){Be.point=We}function Pt(){Xe[0]=he,Xe[1]=me,Be.point=Re,Te=null}function Zt(xt,Ot){if(Te){var vr=xt-Se;Ce.add(p(vr)>180?vr+(vr>0?360:-360):vr)}else De=xt,Ie=Ot;te.point(xt,Ot),We(xt,Ot)}function zt(){te.lineStart()}function At(){Zt(De,Ie),te.lineEnd(),p(Ce)>n&&(he=-(me=180)),Xe[0]=he,Xe[1]=me,Te=null}function Wt(xt,Ot){return(Ot-=xt)<0?Ot+360:Ot}function Bt(xt,Ot){return xt[0]-Ot[0]}function Ct(xt,Ot){return xt[0]<=xt[1]?xt[0]<=Ot&&Ot<=xt[1]:Ot<xt[0]||xt[1]<Ot}function Ze(xt){var Ot,vr,lr,Ir,nn,yn,En;if(_e=me=-(he=be=1/0),He=[],V(xt,Be),vr=He.length){for(He.sort(Bt),Ot=1,lr=He[0],nn=[lr];Ot<vr;++Ot)Ir=He[Ot],Ct(lr,Ir[0])||Ct(lr,Ir[1])?(Wt(lr[0],Ir[1])>Wt(lr[0],lr[1])&&(lr[1]=Ir[1]),Wt(Ir[0],lr[1])>Wt(lr[0],lr[1])&&(lr[0]=Ir[0])):nn.push(lr=Ir);for(yn=-1/0,vr=nn.length-1,Ot=0,lr=nn[vr];Ot<=vr;lr=Ir,++Ot)Ir=nn[Ot],(En=Wt(lr[1],Ir[0]))>yn&&(yn=En,he=Ir[0],me=lr[1])}return He=Xe=null,he===1/0||be===1/0?[[NaN,NaN],[NaN,NaN]]:[[he,be],[me,_e]]}var nt,Ye,Ee,Ge,Je,qe,Tt,mt,Mt,Ht,Rt,Vt,Jt,Yt,or,Hr,an={sphere:B,point:Kr,lineStart:er,lineEnd:Ar,polygonStart:function(){an.lineStart=et,an.lineEnd=$e},polygonEnd:function(){an.lineStart=er,an.lineEnd=Ar}};function Kr(xt,Ot){xt*=g,Ot*=g;var vr=l(Ot);ot(vr*l(xt),vr*y(xt),y(Ot))}function ot(xt,Ot,vr){++nt,Ee+=(xt-Ee)/nt,Ge+=(Ot-Ge)/nt,Je+=(vr-Je)/nt}function er(){an.point=Kt}function Kt(xt,Ot){xt*=g,Ot*=g;var vr=l(Ot);Yt=vr*l(xt),or=vr*y(xt),Hr=y(Ot),an.point=ur,ot(Yt,or,Hr)}function ur(xt,Ot){xt*=g,Ot*=g;var vr=l(Ot),lr=vr*l(xt),Ir=vr*y(xt),nn=y(Ot),yn=x(d((yn=or*nn-Hr*Ir)*yn+(yn=Hr*lr-Yt*nn)*yn+(yn=Yt*Ir-or*lr)*yn),Yt*lr+or*Ir+Hr*nn);Ye+=yn,qe+=yn*(Yt+(Yt=lr)),Tt+=yn*(or+(or=Ir)),mt+=yn*(Hr+(Hr=nn)),ot(Yt,or,Hr)}function Ar(){an.point=Kr}function et(){an.point=st}function $e(){ft(Vt,Jt),an.point=Kr}function st(xt,Ot){Vt=xt,Jt=Ot,xt*=g,Ot*=g,an.point=ft;var vr=l(Ot);Yt=vr*l(xt),or=vr*y(xt),Hr=y(Ot),ot(Yt,or,Hr)}function ft(xt,Ot){xt*=g,Ot*=g;var vr=l(Ot),lr=vr*l(xt),Ir=vr*y(xt),nn=y(Ot),yn=or*nn-Hr*Ir,En=Hr*lr-Yt*nn,Pn=Yt*Ir-or*lr,Vn=d(yn*yn+En*En+Pn*Pn),xn=E(Vn),Bn=Vn&&-xn/Vn;Mt+=Bn*yn,Ht+=Bn*En,Rt+=Bn*Pn,Ye+=xn,qe+=xn*(Yt+(Yt=lr)),Tt+=xn*(or+(or=Ir)),mt+=xn*(Hr+(Hr=nn)),ot(Yt,or,Hr)}function St(xt){nt=Ye=Ee=Ge=Je=qe=Tt=mt=Mt=Ht=Rt=0,V(xt,an);var Ot=Mt,vr=Ht,lr=Rt,Ir=Ot*Ot+vr*vr+lr*lr;return Ir<a&&(Ot=qe,vr=Tt,lr=mt,Ye<n&&(Ot=Ee,vr=Ge,lr=Je),Ir=Ot*Ot+vr*vr+lr*lr,Ir<a)?[NaN,NaN]:[x(vr,Ot)*m,E(lr/d(Ir))*m]}function Ut(xt){return function(){return xt}}function Pe(xt,Ot){function vr(lr,Ir){return lr=xt(lr,Ir),Ot(lr[0],lr[1])}return xt.invert&&Ot.invert&&(vr.invert=function(lr,Ir){return lr=Ot.invert(lr,Ir),lr&&xt.invert(lr[0],lr[1])}),vr}function ke(xt,Ot){return[p(xt)>r?xt+Math.round(-xt/s)*s:xt,Ot]}ke.invert=ke;function it(xt,Ot,vr){return(xt%=s)?Ot||vr?Pe(ht(xt),Et(Ot,vr)):ht(xt):Ot||vr?Et(Ot,vr):ke}function ut(xt){return function(Ot,vr){return Ot+=xt,[Ot>r?Ot-s:Ot<-r?Ot+s:Ot,vr]}}function ht(xt){var Ot=ut(xt);return Ot.invert=ut(-xt),Ot}function Et(xt,Ot){var vr=l(xt),lr=y(xt),Ir=l(Ot),nn=y(Ot);function yn(En,Pn){var Vn=l(Pn),xn=l(En)*Vn,Bn=y(En)*Vn,Fn=y(Pn),Gn=Fn*vr+xn*lr;return[x(Bn*Ir-Gn*nn,xn*vr-Fn*lr),E(Gn*Ir+Bn*nn)]}return yn.invert=function(En,Pn){var Vn=l(Pn),xn=l(En)*Vn,Bn=y(En)*Vn,Fn=y(Pn),Gn=Fn*Ir-Bn*nn;return[x(Bn*Ir+Fn*nn,xn*vr+Gn*lr),E(Gn*vr-xn*lr)]},yn}function yt(xt){xt=it(xt[0]*g,xt[1]*g,xt.length>2?xt[2]*g:0);function Ot(vr){return vr=xt(vr[0]*g,vr[1]*g),vr[0]*=m,vr[1]*=m,vr}return Ot.invert=function(vr){return vr=xt.invert(vr[0]*g,vr[1]*g),vr[0]*=m,vr[1]*=m,vr},Ot}function Dt(xt,Ot,vr,lr,Ir,nn){if(!!vr){var yn=l(Ot),En=y(Ot),Pn=lr*vr;Ir==null?(Ir=Ot+lr*s,nn=Ot-Pn/2):(Ir=Xt(yn,Ir),nn=Xt(yn,nn),(lr>0?Ir<nn:Ir>nn)&&(Ir+=lr*s));for(var Vn,xn=Ir;lr>0?xn>nn:xn<nn;xn-=Pn)Vn=q([yn,-En*l(xn),-En*y(xn)]),xt.point(Vn[0],Vn[1])}}function Xt(xt,Ot){Ot=ae(Ot),Ot[0]-=xt,oe(Ot);var vr=S(-Ot[1]);return((-Ot[2]<0?-vr:vr)+s-n)%s}function ar(){var xt=Ut([0,0]),Ot=Ut(90),vr=Ut(6),lr,Ir,nn={point:yn};function yn(Pn,Vn){lr.push(Pn=Ir(Pn,Vn)),Pn[0]*=m,Pn[1]*=m}function En(){var Pn=xt.apply(this,arguments),Vn=Ot.apply(this,arguments)*g,xn=vr.apply(this,arguments)*g;return lr=[],Ir=it(-Pn[0]*g,-Pn[1]*g,0).invert,Dt(nn,Vn,xn,1),Pn={type:"Polygon",coordinates:[lr]},lr=Ir=null,Pn}return En.center=function(Pn){return arguments.length?(xt=typeof Pn=="function"?Pn:Ut([+Pn[0],+Pn[1]]),En):xt},En.radius=function(Pn){return arguments.length?(Ot=typeof Pn=="function"?Pn:Ut(+Pn),En):Ot},En.precision=function(Pn){return arguments.length?(vr=typeof Pn=="function"?Pn:Ut(+Pn),En):vr},En}function kr(){var xt=[],Ot;return{point:function(vr,lr,Ir){Ot.push([vr,lr,Ir])},lineStart:function(){xt.push(Ot=[])},lineEnd:B,rejoin:function(){xt.length>1&&xt.push(xt.pop().concat(xt.shift()))},result:function(){var vr=xt;return xt=[],Ot=null,vr}}}function wr(xt,Ot){return p(xt[0]-Ot[0])<n&&p(xt[1]-Ot[1])<n}function Sr(xt,Ot,vr,lr){this.x=xt,this.z=Ot,this.o=vr,this.e=lr,this.v=!1,this.n=this.p=null}function Zr(xt,Ot,vr,lr,Ir){var nn=[],yn=[],En,Pn;if(xt.forEach(function(ea){if(!((Na=ea.length-1)<=0)){var Na,La=ea[0],Oa=ea[Na],Ua;if(wr(La,Oa)){if(!La[2]&&!Oa[2]){for(Ir.lineStart(),En=0;En<Na;++En)Ir.point((La=ea[En])[0],La[1]);Ir.lineEnd();return}Oa[0]+=2*n}nn.push(Ua=new Sr(La,ea,null,!0)),yn.push(Ua.o=new Sr(La,null,Ua,!1)),nn.push(Ua=new Sr(Oa,ea,null,!1)),yn.push(Ua.o=new Sr(Oa,null,Ua,!0))}}),!!nn.length){for(yn.sort(Ot),ir(nn),ir(yn),En=0,Pn=yn.length;En<Pn;++En)yn[En].e=vr=!vr;for(var Vn=nn[0],xn,Bn;;){for(var Fn=Vn,Gn=!0;Fn.v;)if((Fn=Fn.n)===Vn)return;xn=Fn.z,Ir.lineStart();do{if(Fn.v=Fn.o.v=!0,Fn.e){if(Gn)for(En=0,Pn=xn.length;En<Pn;++En)Ir.point((Bn=xn[En])[0],Bn[1]);else lr(Fn.x,Fn.n.x,1,Ir);Fn=Fn.n}else{if(Gn)for(xn=Fn.p.z,En=xn.length-1;En>=0;--En)Ir.point((Bn=xn[En])[0],Bn[1]);else lr(Fn.x,Fn.p.x,-1,Ir);Fn=Fn.p}Fn=Fn.o,xn=Fn.z,Gn=!Gn}while(!Fn.v);Ir.lineEnd()}}}function ir(xt){if(!!(Ot=xt.length)){for(var Ot,vr=0,lr=xt[0],Ir;++vr<Ot;)lr.n=Ir=xt[vr],Ir.p=lr,lr=Ir;lr.n=Ir=xt[0],Ir.p=lr}}var xr=A();function Fr(xt){return p(xt[0])<=r?xt[0]:w(xt[0])*((p(xt[0])+r)%s-r)}function Or(xt,Ot){var vr=Fr(Ot),lr=Ot[1],Ir=y(lr),nn=[y(vr),-l(vr),0],yn=0,En=0;xr.reset(),Ir===1?lr=f+n:Ir===-1&&(lr=-f-n);for(var Pn=0,Vn=xt.length;Pn<Vn;++Pn)if(!!(Bn=(xn=xt[Pn]).length))for(var xn,Bn,Fn=xn[Bn-1],Gn=Fr(Fn),ea=Fn[1]/2+o,Na=y(ea),La=l(ea),Oa=0;Oa<Bn;++Oa,Gn=$n,Na=Za,La=ti,Fn=Ua){var Ua=xn[Oa],$n=Fr(Ua),da=Ua[1]/2+o,Za=y(da),ti=l(da),wi=$n-Gn,Ti=wi>=0?1:-1,Si=Ti*wi,Fi=Si>r,fi=Na*Za;if(xr.add(x(fi*Ti*y(Si),La*ti+fi*l(Si))),yn+=Fi?wi+Ti*s:wi,Fi^Gn>=vr^$n>=vr){var ko=ie(ae(Fn),ae(Ua));oe(ko);var uo=ie(nn,ko);oe(uo);var ei=(Fi^wi>=0?-1:1)*E(uo[2]);(lr>ei||lr===ei&&(ko[0]||ko[1]))&&(En+=Fi^wi>=0?1:-1)}}return(yn<-n||yn<n&&xr<-n)^En&1}function Cr(xt,Ot,vr,lr){return function(Ir){var nn=Ot(Ir),yn=kr(),En=Ot(yn),Pn=!1,Vn,xn,Bn,Fn={point:Gn,lineStart:Na,lineEnd:La,polygonStart:function(){Fn.point=Oa,Fn.lineStart=Ua,Fn.lineEnd=$n,xn=[],Vn=[]},polygonEnd:function(){Fn.point=Gn,Fn.lineStart=Na,Fn.lineEnd=La,xn=u.merge(xn);var da=Or(Vn,lr);xn.length?(Pn||(Ir.polygonStart(),Pn=!0),Zr(xn,Ft,da,vr,Ir)):da&&(Pn||(Ir.polygonStart(),Pn=!0),Ir.lineStart(),vr(null,null,1,Ir),Ir.lineEnd()),Pn&&(Ir.polygonEnd(),Pn=!1),xn=Vn=null},sphere:function(){Ir.polygonStart(),Ir.lineStart(),vr(null,null,1,Ir),Ir.lineEnd(),Ir.polygonEnd()}};function Gn(da,Za){xt(da,Za)&&Ir.point(da,Za)}function ea(da,Za){nn.point(da,Za)}function Na(){Fn.point=ea,nn.lineStart()}function La(){Fn.point=Gn,nn.lineEnd()}function Oa(da,Za){Bn.push([da,Za]),En.point(da,Za)}function Ua(){En.lineStart(),Bn=[]}function $n(){Oa(Bn[0][0],Bn[0][1]),En.lineEnd();var da=En.clean(),Za=yn.result(),ti,wi=Za.length,Ti,Si,Fi;if(Bn.pop(),Vn.push(Bn),Bn=null,!!wi){if(da&1){if(Si=Za[0],(Ti=Si.length-1)>0){for(Pn||(Ir.polygonStart(),Pn=!0),Ir.lineStart(),ti=0;ti<Ti;++ti)Ir.point((Fi=Si[ti])[0],Fi[1]);Ir.lineEnd()}return}wi>1&&da&2&&Za.push(Za.pop().concat(Za.shift())),xn.push(Za.filter(at))}}return Fn}}function at(xt){return xt.length>1}function Ft(xt,Ot){return((xt=xt.x)[0]<0?xt[1]-f-n:f-xt[1])-((Ot=Ot.x)[0]<0?Ot[1]-f-n:f-Ot[1])}var jt=Cr(function(){return!0},sr,Ur,[-r,-f]);function sr(xt){var Ot=NaN,vr=NaN,lr=NaN,Ir;return{lineStart:function(){xt.lineStart(),Ir=1},point:function(nn,yn){var En=nn>0?r:-r,Pn=p(nn-Ot);p(Pn-r)<n?(xt.point(Ot,vr=(vr+yn)/2>0?f:-f),xt.point(lr,vr),xt.lineEnd(),xt.lineStart(),xt.point(En,vr),xt.point(nn,vr),Ir=0):lr!==En&&Pn>=r&&(p(Ot-lr)<n&&(Ot-=lr*n),p(nn-En)<n&&(nn-=En*n),vr=zr(Ot,vr,nn,yn),xt.point(lr,vr),xt.lineEnd(),xt.lineStart(),xt.point(En,vr),Ir=0),xt.point(Ot=nn,vr=yn),lr=En},lineEnd:function(){xt.lineEnd(),Ot=vr=NaN},clean:function(){return 2-Ir}}}function zr(xt,Ot,vr,lr){var Ir,nn,yn=y(xt-vr);return p(yn)>n?v((y(Ot)*(nn=l(lr))*y(vr)-y(lr)*(Ir=l(Ot))*y(xt))/(Ir*nn*yn)):(Ot+lr)/2}function Ur(xt,Ot,vr,lr){var Ir;if(xt==null)Ir=vr*f,lr.point(-r,Ir),lr.point(0,Ir),lr.point(r,Ir),lr.point(r,0),lr.point(r,-Ir),lr.point(0,-Ir),lr.point(-r,-Ir),lr.point(-r,0),lr.point(-r,Ir);else if(p(xt[0]-Ot[0])>n){var nn=xt[0]<Ot[0]?r:-r;Ir=vr*nn/2,lr.point(-nn,Ir),lr.point(0,Ir),lr.point(nn,Ir)}else lr.point(Ot[0],Ot[1])}function Dr(xt){var Ot=l(xt),vr=6*g,lr=Ot>0,Ir=p(Ot)>n;function nn(xn,Bn,Fn,Gn){Dt(Gn,xt,vr,Fn,xn,Bn)}function yn(xn,Bn){return l(xn)*l(Bn)>Ot}function En(xn){var Bn,Fn,Gn,ea,Na;return{lineStart:function(){ea=Gn=!1,Na=1},point:function(La,Oa){var Ua=[La,Oa],$n,da=yn(La,Oa),Za=lr?da?0:Vn(La,Oa):da?Vn(La+(La<0?r:-r),Oa):0;if(!Bn&&(ea=Gn=da)&&xn.lineStart(),da!==Gn&&($n=Pn(Bn,Ua),(!$n||wr(Bn,$n)||wr(Ua,$n))&&(Ua[2]=1)),da!==Gn)Na=0,da?(xn.lineStart(),$n=Pn(Ua,Bn),xn.point($n[0],$n[1])):($n=Pn(Bn,Ua),xn.point($n[0],$n[1],2),xn.lineEnd()),Bn=$n;else if(Ir&&Bn&&lr^da){var ti;!(Za&Fn)&&(ti=Pn(Ua,Bn,!0))&&(Na=0,lr?(xn.lineStart(),xn.point(ti[0][0],ti[0][1]),xn.point(ti[1][0],ti[1][1]),xn.lineEnd()):(xn.point(ti[1][0],ti[1][1]),xn.lineEnd(),xn.lineStart(),xn.point(ti[0][0],ti[0][1],3)))}da&&(!Bn||!wr(Bn,Ua))&&xn.point(Ua[0],Ua[1]),Bn=Ua,Gn=da,Fn=Za},lineEnd:function(){Gn&&xn.lineEnd(),Bn=null},clean:function(){return Na|(ea&&Gn)<<1}}}function Pn(xn,Bn,Fn){var Gn=ae(xn),ea=ae(Bn),Na=[1,0,0],La=ie(Gn,ea),Oa=le(La,La),Ua=La[0],$n=Oa-Ua*Ua;if(!$n)return!Fn&&xn;var da=Ot*Oa/$n,Za=-Ot*Ua/$n,ti=ie(Na,La),wi=xe(Na,da),Ti=xe(La,Za);se(wi,Ti);var Si=ti,Fi=le(wi,Si),fi=le(Si,Si),ko=Fi*Fi-fi*(le(wi,wi)-1);if(!(ko<0)){var uo=d(ko),ei=xe(Si,(-Fi-uo)/fi);if(se(ei,wi),ei=q(ei),!Fn)return ei;var ga=xn[0],Ei=Bn[0],bo=xn[1],So=Bn[1],Ss;Ei<ga&&(Ss=ga,ga=Ei,Ei=Ss);var Xs=Ei-ga,Jo=p(Xs-r)<n,bl=Jo||Xs<n;if(!Jo&&So<bo&&(Ss=bo,bo=So,So=Ss),bl?Jo?bo+So>0^ei[1]<(p(ei[0]-ga)<n?bo:So):bo<=ei[1]&&ei[1]<=So:Xs>r^(ga<=ei[0]&&ei[0]<=Ei)){var zs=xe(Si,(-Fi+uo)/fi);return se(zs,wi),[ei,q(zs)]}}}function Vn(xn,Bn){var Fn=lr?xt:r-xt,Gn=0;return xn<-Fn?Gn|=1:xn>Fn&&(Gn|=2),Bn<-Fn?Gn|=4:Bn>Fn&&(Gn|=8),Gn}return Cr(yn,En,nn,lr?[0,-xt]:[-r,xt-r])}function Tr(xt,Ot,vr,lr,Ir,nn){var yn=xt[0],En=xt[1],Pn=Ot[0],Vn=Ot[1],xn=0,Bn=1,Fn=Pn-yn,Gn=Vn-En,ea;if(ea=vr-yn,!(!Fn&&ea>0)){if(ea/=Fn,Fn<0){if(ea<xn)return;ea<Bn&&(Bn=ea)}else if(Fn>0){if(ea>Bn)return;ea>xn&&(xn=ea)}if(ea=Ir-yn,!(!Fn&&ea<0)){if(ea/=Fn,Fn<0){if(ea>Bn)return;ea>xn&&(xn=ea)}else if(Fn>0){if(ea<xn)return;ea<Bn&&(Bn=ea)}if(ea=lr-En,!(!Gn&&ea>0)){if(ea/=Gn,Gn<0){if(ea<xn)return;ea<Bn&&(Bn=ea)}else if(Gn>0){if(ea>Bn)return;ea>xn&&(xn=ea)}if(ea=nn-En,!(!Gn&&ea<0)){if(ea/=Gn,Gn<0){if(ea>Bn)return;ea>xn&&(xn=ea)}else if(Gn>0){if(ea<xn)return;ea<Bn&&(Bn=ea)}return xn>0&&(xt[0]=yn+xn*Fn,xt[1]=En+xn*Gn),Bn<1&&(Ot[0]=yn+Bn*Fn,Ot[1]=En+Bn*Gn),!0}}}}}var Wr=1e9,An=-Wr;function vn(xt,Ot,vr,lr){function Ir(Vn,xn){return xt<=Vn&&Vn<=vr&&Ot<=xn&&xn<=lr}function nn(Vn,xn,Bn,Fn){var Gn=0,ea=0;if(Vn==null||(Gn=yn(Vn,Bn))!==(ea=yn(xn,Bn))||Pn(Vn,xn)<0^Bn>0)do Fn.point(Gn===0||Gn===3?xt:vr,Gn>1?lr:Ot);while((Gn=(Gn+Bn+4)%4)!==ea);else Fn.point(xn[0],xn[1])}function yn(Vn,xn){return p(Vn[0]-xt)<n?xn>0?0:3:p(Vn[0]-vr)<n?xn>0?2:1:p(Vn[1]-Ot)<n?xn>0?1:0:xn>0?3:2}function En(Vn,xn){return Pn(Vn.x,xn.x)}function Pn(Vn,xn){var Bn=yn(Vn,1),Fn=yn(xn,1);return Bn!==Fn?Bn-Fn:Bn===0?xn[1]-Vn[1]:Bn===1?Vn[0]-xn[0]:Bn===2?Vn[1]-xn[1]:xn[0]-Vn[0]}return function(Vn){var xn=Vn,Bn=kr(),Fn,Gn,ea,Na,La,Oa,Ua,$n,da,Za,ti,wi={point:Ti,lineStart:ko,lineEnd:uo,polygonStart:Fi,polygonEnd:fi};function Ti(ga,Ei){Ir(ga,Ei)&&xn.point(ga,Ei)}function Si(){for(var ga=0,Ei=0,bo=Gn.length;Ei<bo;++Ei)for(var So=Gn[Ei],Ss=1,Xs=So.length,Jo=So[0],bl,zs,Es=Jo[0],Do=Jo[1];Ss<Xs;++Ss)bl=Es,zs=Do,Jo=So[Ss],Es=Jo[0],Do=Jo[1],zs<=lr?Do>lr&&(Es-bl)*(lr-zs)>(Do-zs)*(xt-bl)&&++ga:Do<=lr&&(Es-bl)*(lr-zs)<(Do-zs)*(xt-bl)&&--ga;return ga}function Fi(){xn=Bn,Fn=[],Gn=[],ti=!0}function fi(){var ga=Si(),Ei=ti&&ga,bo=(Fn=u.merge(Fn)).length;(Ei||bo)&&(Vn.polygonStart(),Ei&&(Vn.lineStart(),nn(null,null,1,Vn),Vn.lineEnd()),bo&&Zr(Fn,En,ga,nn,Vn),Vn.polygonEnd()),xn=Vn,Fn=Gn=ea=null}function ko(){wi.point=ei,Gn&&Gn.push(ea=[]),Za=!0,da=!1,Ua=$n=NaN}function uo(){Fn&&(ei(Na,La),Oa&&da&&Bn.rejoin(),Fn.push(Bn.result())),wi.point=Ti,da&&xn.lineEnd()}function ei(ga,Ei){var bo=Ir(ga,Ei);if(Gn&&ea.push([ga,Ei]),Za)Na=ga,La=Ei,Oa=bo,Za=!1,bo&&(xn.lineStart(),xn.point(ga,Ei));else if(bo&&da)xn.point(ga,Ei);else{var So=[Ua=Math.max(An,Math.min(Wr,Ua)),$n=Math.max(An,Math.min(Wr,$n))],Ss=[ga=Math.max(An,Math.min(Wr,ga)),Ei=Math.max(An,Math.min(Wr,Ei))];Tr(So,Ss,xt,Ot,vr,lr)?(da||(xn.lineStart(),xn.point(So[0],So[1])),xn.point(Ss[0],Ss[1]),bo||xn.lineEnd(),ti=!1):bo&&(xn.lineStart(),xn.point(ga,Ei),ti=!1)}Ua=ga,$n=Ei,da=bo}return wi}}function Un(){var xt=0,Ot=0,vr=960,lr=500,Ir,nn,yn;return yn={stream:function(En){return Ir&&nn===En?Ir:Ir=vn(xt,Ot,vr,lr)(nn=En)},extent:function(En){return arguments.length?(xt=+En[0][0],Ot=+En[0][1],vr=+En[1][0],lr=+En[1][1],Ir=nn=null,yn):[[xt,Ot],[vr,lr]]}}}var Dn=A(),Xn,Yn,ya,Ca={sphere:B,point:B,lineStart:gi,lineEnd:B,polygonStart:B,polygonEnd:B};function gi(){Ca.point=$a,Ca.lineEnd=Xa}function Xa(){Ca.point=Ca.lineEnd=B}function $a(xt,Ot){xt*=g,Ot*=g,Xn=xt,Yn=y(Ot),ya=l(Ot),Ca.point=Ja}function Ja(xt,Ot){xt*=g,Ot*=g;var vr=y(Ot),lr=l(Ot),Ir=p(xt-Xn),nn=l(Ir),yn=y(Ir),En=lr*yn,Pn=ya*vr-Yn*lr*nn,Vn=Yn*vr+ya*lr*nn;Dn.add(x(d(En*En+Pn*Pn),Vn)),Xn=xt,Yn=vr,ya=lr}function Mr(xt){return Dn.reset(),V(xt,Ca),+Dn}var gn=[null,null],hn={type:"LineString",coordinates:gn};function Sn(xt,Ot){return gn[0]=xt,gn[1]=Ot,Mr(hn)}var Jn={Feature:function(xt,Ot){return ra(xt.geometry,Ot)},FeatureCollection:function(xt,Ot){for(var vr=xt.features,lr=-1,Ir=vr.length;++lr<Ir;)if(ra(vr[lr].geometry,Ot))return!0;return!1}},ha={Sphere:function(){return!0},Point:function(xt,Ot){return In(xt.coordinates,Ot)},MultiPoint:function(xt,Ot){for(var vr=xt.coordinates,lr=-1,Ir=vr.length;++lr<Ir;)if(In(vr[lr],Ot))return!0;return!1},LineString:function(xt,Ot){return jn(xt.coordinates,Ot)},MultiLineString:function(xt,Ot){for(var vr=xt.coordinates,lr=-1,Ir=vr.length;++lr<Ir;)if(jn(vr[lr],Ot))return!0;return!1},Polygon:function(xt,Ot){return Ga(xt.coordinates,Ot)},MultiPolygon:function(xt,Ot){for(var vr=xt.coordinates,lr=-1,Ir=vr.length;++lr<Ir;)if(Ga(vr[lr],Ot))return!0;return!1},GeometryCollection:function(xt,Ot){for(var vr=xt.geometries,lr=-1,Ir=vr.length;++lr<Ir;)if(ra(vr[lr],Ot))return!0;return!1}};function ra(xt,Ot){return xt&&ha.hasOwnProperty(xt.type)?ha[xt.type](xt,Ot):!1}function In(xt,Ot){return Sn(xt,Ot)===0}function jn(xt,Ot){for(var vr,lr,Ir,nn=0,yn=xt.length;nn<yn;nn++){if(lr=Sn(xt[nn],Ot),lr===0||nn>0&&(Ir=Sn(xt[nn],xt[nn-1]),Ir>0&&vr<=Ir&&lr<=Ir&&(vr+lr-Ir)*(1-Math.pow((vr-lr)/Ir,2))<a*Ir))return!0;vr=lr}return!1}function Ga(xt,Ot){return!!Or(xt.map(vi),Gt(Ot))}function vi(xt){return xt=xt.map(Gt),xt.pop(),xt}function Gt(xt){return[xt[0]*g,xt[1]*g]}function pr(xt,Ot){return(xt&&Jn.hasOwnProperty(xt.type)?Jn[xt.type]:ra)(xt,Ot)}function on(xt,Ot,vr){var lr=u.range(xt,Ot-n,vr).concat(Ot);return function(Ir){return lr.map(function(nn){return[Ir,nn]})}}function dn(xt,Ot,vr){var lr=u.range(xt,Ot-n,vr).concat(Ot);return function(Ir){return lr.map(function(nn){return[nn,Ir]})}}function rn(){var xt,Ot,vr,lr,Ir,nn,yn,En,Pn=10,Vn=Pn,xn=90,Bn=360,Fn,Gn,ea,Na,La=2.5;function Oa(){return{type:"MultiLineString",coordinates:Ua()}}function Ua(){return u.range(b(lr/xn)*xn,vr,xn).map(ea).concat(u.range(b(En/Bn)*Bn,yn,Bn).map(Na)).concat(u.range(b(Ot/Pn)*Pn,xt,Pn).filter(function($n){return p($n%xn)>n}).map(Fn)).concat(u.range(b(nn/Vn)*Vn,Ir,Vn).filter(function($n){return p($n%Bn)>n}).map(Gn))}return Oa.lines=function(){return Ua().map(function($n){return{type:"LineString",coordinates:$n}})},Oa.outline=function(){return{type:"Polygon",coordinates:[ea(lr).concat(Na(yn).slice(1),ea(vr).reverse().slice(1),Na(En).reverse().slice(1))]}},Oa.extent=function($n){return arguments.length?Oa.extentMajor($n).extentMinor($n):Oa.extentMinor()},Oa.extentMajor=function($n){return arguments.length?(lr=+$n[0][0],vr=+$n[1][0],En=+$n[0][1],yn=+$n[1][1],lr>vr&&($n=lr,lr=vr,vr=$n),En>yn&&($n=En,En=yn,yn=$n),Oa.precision(La)):[[lr,En],[vr,yn]]},Oa.extentMinor=function($n){return arguments.length?(Ot=+$n[0][0],xt=+$n[1][0],nn=+$n[0][1],Ir=+$n[1][1],Ot>xt&&($n=Ot,Ot=xt,xt=$n),nn>Ir&&($n=nn,nn=Ir,Ir=$n),Oa.precision(La)):[[Ot,nn],[xt,Ir]]},Oa.step=function($n){return arguments.length?Oa.stepMajor($n).stepMinor($n):Oa.stepMinor()},Oa.stepMajor=function($n){return arguments.length?(xn=+$n[0],Bn=+$n[1],Oa):[xn,Bn]},Oa.stepMinor=function($n){return arguments.length?(Pn=+$n[0],Vn=+$n[1],Oa):[Pn,Vn]},Oa.precision=function($n){return arguments.length?(La=+$n,Fn=on(nn,Ir,90),Gn=dn(Ot,xt,La),ea=on(En,yn,90),Na=dn(lr,vr,La),Oa):La},Oa.extentMajor([[-180,-90+n],[180,90-n]]).extentMinor([[-180,-80-n],[180,80+n]])}function Mn(){return rn()()}function _n(xt,Ot){var vr=xt[0]*g,lr=xt[1]*g,Ir=Ot[0]*g,nn=Ot[1]*g,yn=l(lr),En=y(lr),Pn=l(nn),Vn=y(nn),xn=yn*l(vr),Bn=yn*y(vr),Fn=Pn*l(Ir),Gn=Pn*y(Ir),ea=2*E(d(k(nn-lr)+yn*Pn*k(Ir-vr))),Na=y(ea),La=ea?function(Oa){var Ua=y(Oa*=ea)/Na,$n=y(ea-Oa)/Na,da=$n*xn+Ua*Fn,Za=$n*Bn+Ua*Gn,ti=$n*En+Ua*Vn;return[x(Za,da)*m,x(ti,d(da*da+Za*Za))*m]}:function(){return[vr*m,lr*m]};return La.distance=ea,La}function cn(xt){return xt}var mr=A(),br=A(),Br,mn,On,na,Tn={point:B,lineStart:B,lineEnd:B,polygonStart:function(){Tn.lineStart=Kn,Tn.lineEnd=_a},polygonEnd:function(){Tn.lineStart=Tn.lineEnd=Tn.point=B,mr.add(p(br)),br.reset()},result:function(){var xt=mr/2;return mr.reset(),xt}};function Kn(){Tn.point=oa}function oa(xt,Ot){Tn.point=ma,Br=On=xt,mn=na=Ot}function ma(xt,Ot){br.add(na*xt-On*Ot),On=xt,na=Ot}function _a(){ma(Br,mn)}var ua=1/0,Ea=ua,Mo=-ua,jo=Mo,vs={point:El,lineStart:B,lineEnd:B,polygonStart:B,polygonEnd:B,result:function(){var xt=[[ua,Ea],[Mo,jo]];return Mo=jo=-(Ea=ua=1/0),xt}};function El(xt,Ot){xt<ua&&(ua=xt),xt>Mo&&(Mo=xt),Ot<Ea&&(Ea=Ot),Ot>jo&&(jo=Ot)}var Ol=0,mu=0,bi=0,cl=0,$s=0,Ki=0,No=0,Ul=0,Ps=0,Vi,Cl,io,Wi,vo={point:oo,lineStart:bs,lineEnd:ps,polygonStart:function(){vo.lineStart=Iu,vo.lineEnd=qs},polygonEnd:function(){vo.point=oo,vo.lineStart=bs,vo.lineEnd=ps},result:function(){var xt=Ps?[No/Ps,Ul/Ps]:Ki?[cl/Ki,$s/Ki]:bi?[Ol/bi,mu/bi]:[NaN,NaN];return Ol=mu=bi=cl=$s=Ki=No=Ul=Ps=0,xt}};function oo(xt,Ot){Ol+=xt,mu+=Ot,++bi}function bs(){vo.point=hl}function hl(xt,Ot){vo.point=Ru,oo(io=xt,Wi=Ot)}function Ru(xt,Ot){var vr=xt-io,lr=Ot-Wi,Ir=d(vr*vr+lr*lr);cl+=Ir*(io+xt)/2,$s+=Ir*(Wi+Ot)/2,Ki+=Ir,oo(io=xt,Wi=Ot)}function ps(){vo.point=oo}function Iu(){vo.point=Oo}function qs(){lf(Vi,Cl)}function Oo(xt,Ot){vo.point=lf,oo(Vi=io=xt,Cl=Wi=Ot)}function lf(xt,Ot){var vr=xt-io,lr=Ot-Wi,Ir=d(vr*vr+lr*lr);cl+=Ir*(io+xt)/2,$s+=Ir*(Wi+Ot)/2,Ki+=Ir,Ir=Wi*xt-io*Ot,No+=Ir*(io+xt),Ul+=Ir*(Wi+Ot),Ps+=Ir*3,oo(io=xt,Wi=Ot)}function el(xt){this._context=xt}el.prototype={_radius:4.5,pointRadius:function(xt){return this._radius=xt,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(xt,Ot){switch(this._point){case 0:{this._context.moveTo(xt,Ot),this._point=1;break}case 1:{this._context.lineTo(xt,Ot);break}default:{this._context.moveTo(xt+this._radius,Ot),this._context.arc(xt,Ot,this._radius,0,s);break}}},result:B};var Vs=A(),nu,uf,ff,vl,au,Hs={point:B,lineStart:function(){Hs.point=xu},lineEnd:function(){nu&&kl(uf,ff),Hs.point=B},polygonStart:function(){nu=!0},polygonEnd:function(){nu=null},result:function(){var xt=+Vs;return Vs.reset(),xt}};function xu(xt,Ot){Hs.point=kl,uf=vl=xt,ff=au=Ot}function kl(xt,Ot){vl-=xt,au-=Ot,Vs.add(d(vl*vl+au*au)),vl=xt,au=Ot}function bu(){this._string=[]}bu.prototype={_radius:4.5,_circle:zu(4.5),pointRadius:function(xt){return(xt=+xt)!==this._radius&&(this._radius=xt,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(xt,Ot){switch(this._point){case 0:{this._string.push("M",xt,",",Ot),this._point=1;break}case 1:{this._string.push("L",xt,",",Ot);break}default:{this._circle==null&&(this._circle=zu(this._radius)),this._string.push("M",xt,",",Ot,this._circle);break}}},result:function(){if(this._string.length){var xt=this._string.join("");return this._string=[],xt}else return null}};function zu(xt){return"m0,"+xt+"a"+xt+","+xt+" 0 1,1 0,"+-2*xt+"a"+xt+","+xt+" 0 1,1 0,"+2*xt+"z"}function iu(xt,Ot){var vr=4.5,lr,Ir;function nn(yn){return yn&&(typeof vr=="function"&&Ir.pointRadius(+vr.apply(this,arguments)),V(yn,lr(Ir))),Ir.result()}return nn.area=function(yn){return V(yn,lr(Tn)),Tn.result()},nn.measure=function(yn){return V(yn,lr(Hs)),Hs.result()},nn.bounds=function(yn){return V(yn,lr(vs)),vs.result()},nn.centroid=function(yn){return V(yn,lr(vo)),vo.result()},nn.projection=function(yn){return arguments.length?(lr=yn==null?(xt=null,cn):(xt=yn).stream,nn):xt},nn.context=function(yn){return arguments.length?(Ir=yn==null?(Ot=null,new bu):new el(Ot=yn),typeof vr!="function"&&Ir.pointRadius(vr),nn):Ot},nn.pointRadius=function(yn){return arguments.length?(vr=typeof yn=="function"?yn:(Ir.pointRadius(+yn),+yn),nn):vr},nn.projection(xt).context(Ot)}function cf(xt){return{stream:pl(xt)}}function pl(xt){return function(Ot){var vr=new _u;for(var lr in xt)vr[lr]=xt[lr];return vr.stream=Ot,vr}}function _u(){}_u.prototype={constructor:_u,point:function(xt,Ot){this.stream.point(xt,Ot)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function ou(xt,Ot,vr){var lr=xt.clipExtent&&xt.clipExtent();return xt.scale(150).translate([0,0]),lr!=null&&xt.clipExtent(null),V(vr,xt.stream(vs)),Ot(vs.result()),lr!=null&&xt.clipExtent(lr),xt}function Fs(xt,Ot,vr){return ou(xt,function(lr){var Ir=Ot[1][0]-Ot[0][0],nn=Ot[1][1]-Ot[0][1],yn=Math.min(Ir/(lr[1][0]-lr[0][0]),nn/(lr[1][1]-lr[0][1])),En=+Ot[0][0]+(Ir-yn*(lr[1][0]+lr[0][0]))/2,Pn=+Ot[0][1]+(nn-yn*(lr[1][1]+lr[0][1]))/2;xt.scale(150*yn).translate([En,Pn])},vr)}function Vl(xt,Ot,vr){return Fs(xt,[[0,0],Ot],vr)}function wu(xt,Ot,vr){return ou(xt,function(lr){var Ir=+Ot,nn=Ir/(lr[1][0]-lr[0][0]),yn=(Ir-nn*(lr[1][0]+lr[0][0]))/2,En=-nn*lr[0][1];xt.scale(150*nn).translate([yn,En])},vr)}function Bu(xt,Ot,vr){return ou(xt,function(lr){var Ir=+Ot,nn=Ir/(lr[1][1]-lr[0][1]),yn=-nn*lr[0][0],En=(Ir-nn*(lr[1][1]+lr[0][1]))/2;xt.scale(150*nn).translate([yn,En])},vr)}var Nu=16,su=l(30*g);function hf(xt,Ot){return+Ot?ds(xt,Ot):Ou(xt)}function Ou(xt){return pl({point:function(Ot,vr){Ot=xt(Ot,vr),this.stream.point(Ot[0],Ot[1])}})}function ds(xt,Ot){function vr(lr,Ir,nn,yn,En,Pn,Vn,xn,Bn,Fn,Gn,ea,Na,La){var Oa=Vn-lr,Ua=xn-Ir,$n=Oa*Oa+Ua*Ua;if($n>4*Ot&&Na--){var da=yn+Fn,Za=En+Gn,ti=Pn+ea,wi=d(da*da+Za*Za+ti*ti),Ti=E(ti/=wi),Si=p(p(ti)-1)<n||p(nn-Bn)<n?(nn+Bn)/2:x(Za,da),Fi=xt(Si,Ti),fi=Fi[0],ko=Fi[1],uo=fi-lr,ei=ko-Ir,ga=Ua*uo-Oa*ei;(ga*ga/$n>Ot||p((Oa*uo+Ua*ei)/$n-.5)>.3||yn*Fn+En*Gn+Pn*ea<su)&&(vr(lr,Ir,nn,yn,En,Pn,fi,ko,Si,da/=wi,Za/=wi,ti,Na,La),La.point(fi,ko),vr(fi,ko,Si,da,Za,ti,Vn,xn,Bn,Fn,Gn,ea,Na,La))}}return function(lr){var Ir,nn,yn,En,Pn,Vn,xn,Bn,Fn,Gn,ea,Na,La={point:Oa,lineStart:Ua,lineEnd:da,polygonStart:function(){lr.polygonStart(),La.lineStart=Za},polygonEnd:function(){lr.polygonEnd(),La.lineStart=Ua}};function Oa(Ti,Si){Ti=xt(Ti,Si),lr.point(Ti[0],Ti[1])}function Ua(){Bn=NaN,La.point=$n,lr.lineStart()}function $n(Ti,Si){var Fi=ae([Ti,Si]),fi=xt(Ti,Si);vr(Bn,Fn,xn,Gn,ea,Na,Bn=fi[0],Fn=fi[1],xn=Ti,Gn=Fi[0],ea=Fi[1],Na=Fi[2],Nu,lr),lr.point(Bn,Fn)}function da(){La.point=Oa,lr.lineEnd()}function Za(){Ua(),La.point=ti,La.lineEnd=wi}function ti(Ti,Si){$n(Ir=Ti,Si),nn=Bn,yn=Fn,En=Gn,Pn=ea,Vn=Na,La.point=$n}function wi(){vr(Bn,Fn,xn,Gn,ea,Na,nn,yn,Ir,En,Pn,Vn,Nu,lr),La.lineEnd=da,da()}return La}}var Dl=pl({point:function(xt,Ot){this.stream.point(xt*g,Ot*g)}});function Ll(xt){return pl({point:function(Ot,vr){var lr=xt(Ot,vr);return this.stream.point(lr[0],lr[1])}})}function Tu(xt,Ot,vr,lr,Ir){function nn(yn,En){return yn*=lr,En*=Ir,[Ot+xt*yn,vr-xt*En]}return nn.invert=function(yn,En){return[(yn-Ot)/xt*lr,(vr-En)/xt*Ir]},nn}function Rs(xt,Ot,vr,lr,Ir,nn){var yn=l(nn),En=y(nn),Pn=yn*xt,Vn=En*xt,xn=yn/xt,Bn=En/xt,Fn=(En*vr-yn*Ot)/xt,Gn=(En*Ot+yn*vr)/xt;function ea(Na,La){return Na*=lr,La*=Ir,[Pn*Na-Vn*La+Ot,vr-Vn*Na-Pn*La]}return ea.invert=function(Na,La){return[lr*(xn*Na-Bn*La+Fn),Ir*(Gn-Bn*Na-xn*La)]},ea}function Uo(xt){return lu(function(){return xt})()}function lu(xt){var Ot,vr=150,lr=480,Ir=250,nn=0,yn=0,En=0,Pn=0,Vn=0,xn,Bn=0,Fn=1,Gn=1,ea=null,Na=jt,La=null,Oa,Ua,$n,da=cn,Za=.5,ti,wi,Ti,Si,Fi;function fi(ga){return Ti(ga[0]*g,ga[1]*g)}function ko(ga){return ga=Ti.invert(ga[0],ga[1]),ga&&[ga[0]*m,ga[1]*m]}fi.stream=function(ga){return Si&&Fi===ga?Si:Si=Dl(Ll(xn)(Na(ti(da(Fi=ga)))))},fi.preclip=function(ga){return arguments.length?(Na=ga,ea=void 0,ei()):Na},fi.postclip=function(ga){return arguments.length?(da=ga,La=Oa=Ua=$n=null,ei()):da},fi.clipAngle=function(ga){return arguments.length?(Na=+ga?Dr(ea=ga*g):(ea=null,jt),ei()):ea*m},fi.clipExtent=function(ga){return arguments.length?(da=ga==null?(La=Oa=Ua=$n=null,cn):vn(La=+ga[0][0],Oa=+ga[0][1],Ua=+ga[1][0],$n=+ga[1][1]),ei()):La==null?null:[[La,Oa],[Ua,$n]]},fi.scale=function(ga){return arguments.length?(vr=+ga,uo()):vr},fi.translate=function(ga){return arguments.length?(lr=+ga[0],Ir=+ga[1],uo()):[lr,Ir]},fi.center=function(ga){return arguments.length?(nn=ga[0]%360*g,yn=ga[1]%360*g,uo()):[nn*m,yn*m]},fi.rotate=function(ga){return arguments.length?(En=ga[0]%360*g,Pn=ga[1]%360*g,Vn=ga.length>2?ga[2]%360*g:0,uo()):[En*m,Pn*m,Vn*m]},fi.angle=function(ga){return arguments.length?(Bn=ga%360*g,uo()):Bn*m},fi.reflectX=function(ga){return arguments.length?(Fn=ga?-1:1,uo()):Fn<0},fi.reflectY=function(ga){return arguments.length?(Gn=ga?-1:1,uo()):Gn<0},fi.precision=function(ga){return arguments.length?(ti=hf(wi,Za=ga*ga),ei()):d(Za)},fi.fitExtent=function(ga,Ei){return Fs(fi,ga,Ei)},fi.fitSize=function(ga,Ei){return Vl(fi,ga,Ei)},fi.fitWidth=function(ga,Ei){return wu(fi,ga,Ei)},fi.fitHeight=function(ga,Ei){return Bu(fi,ga,Ei)};function uo(){var ga=Rs(vr,0,0,Fn,Gn,Bn).apply(null,Ot(nn,yn)),Ei=(Bn?Rs:Tu)(vr,lr-ga[0],Ir-ga[1],Fn,Gn,Bn);return xn=it(En,Pn,Vn),wi=Pe(Ot,Ei),Ti=Pe(xn,wi),ti=hf(wi,Za),ei()}function ei(){return Si=Fi=null,fi}return function(){return Ot=xt.apply(this,arguments),fi.invert=Ot.invert&&ko,uo()}}function Gs(xt){var Ot=0,vr=r/3,lr=lu(xt),Ir=lr(Ot,vr);return Ir.parallels=function(nn){return arguments.length?lr(Ot=nn[0]*g,vr=nn[1]*g):[Ot*m,vr*m]},Ir}function Ys(xt){var Ot=l(xt);function vr(lr,Ir){return[lr*Ot,y(Ir)/Ot]}return vr.invert=function(lr,Ir){return[lr/Ot,E(Ir*Ot)]},vr}function mo(xt,Ot){var vr=y(xt),lr=(vr+y(Ot))/2;if(p(lr)<n)return Ys(xt);var Ir=1+vr*(2*lr-vr),nn=d(Ir)/lr;function yn(En,Pn){var Vn=d(Ir-2*lr*y(Pn))/lr;return[Vn*y(En*=lr),nn-Vn*l(En)]}return yn.invert=function(En,Pn){var Vn=nn-Pn,xn=x(En,p(Vn))*w(Vn);return Vn*lr<0&&(xn-=r*w(En)*w(Vn)),[xn/lr,E((Ir-(En*En+Vn*Vn)*lr*lr)/(2*lr))]},yn}function Hl(){return Gs(mo).scale(155.424).center([0,33.6442])}function Gl(){return Hl().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function dl(xt){var Ot=xt.length;return{point:function(vr,lr){for(var Ir=-1;++Ir<Ot;)xt[Ir].point(vr,lr)},sphere:function(){for(var vr=-1;++vr<Ot;)xt[vr].sphere()},lineStart:function(){for(var vr=-1;++vr<Ot;)xt[vr].lineStart()},lineEnd:function(){for(var vr=-1;++vr<Ot;)xt[vr].lineEnd()},polygonStart:function(){for(var vr=-1;++vr<Ot;)xt[vr].polygonStart()},polygonEnd:function(){for(var vr=-1;++vr<Ot;)xt[vr].polygonEnd()}}}function Is(){var xt,Ot,vr=Gl(),lr,Ir=Hl().rotate([154,0]).center([-2,58.5]).parallels([55,65]),nn,yn=Hl().rotate([157,0]).center([-3,19.9]).parallels([8,18]),En,Pn,Vn={point:function(Fn,Gn){Pn=[Fn,Gn]}};function xn(Fn){var Gn=Fn[0],ea=Fn[1];return Pn=null,lr.point(Gn,ea),Pn||(nn.point(Gn,ea),Pn)||(En.point(Gn,ea),Pn)}xn.invert=function(Fn){var Gn=vr.scale(),ea=vr.translate(),Na=(Fn[0]-ea[0])/Gn,La=(Fn[1]-ea[1])/Gn;return(La>=.12&&La<.234&&Na>=-.425&&Na<-.214?Ir:La>=.166&&La<.234&&Na>=-.214&&Na<-.115?yn:vr).invert(Fn)},xn.stream=function(Fn){return xt&&Ot===Fn?xt:xt=dl([vr.stream(Ot=Fn),Ir.stream(Fn),yn.stream(Fn)])},xn.precision=function(Fn){return arguments.length?(vr.precision(Fn),Ir.precision(Fn),yn.precision(Fn),Bn()):vr.precision()},xn.scale=function(Fn){return arguments.length?(vr.scale(Fn),Ir.scale(Fn*.35),yn.scale(Fn),xn.translate(vr.translate())):vr.scale()},xn.translate=function(Fn){if(!arguments.length)return vr.translate();var Gn=vr.scale(),ea=+Fn[0],Na=+Fn[1];return lr=vr.translate(Fn).clipExtent([[ea-.455*Gn,Na-.238*Gn],[ea+.455*Gn,Na+.238*Gn]]).stream(Vn),nn=Ir.translate([ea-.307*Gn,Na+.201*Gn]).clipExtent([[ea-.425*Gn+n,Na+.12*Gn+n],[ea-.214*Gn-n,Na+.234*Gn-n]]).stream(Vn),En=yn.translate([ea-.205*Gn,Na+.212*Gn]).clipExtent([[ea-.214*Gn+n,Na+.166*Gn+n],[ea-.115*Gn-n,Na+.234*Gn-n]]).stream(Vn),Bn()},xn.fitExtent=function(Fn,Gn){return Fs(xn,Fn,Gn)},xn.fitSize=function(Fn,Gn){return Vl(xn,Fn,Gn)},xn.fitWidth=function(Fn,Gn){return wu(xn,Fn,Gn)},xn.fitHeight=function(Fn,Gn){return Bu(xn,Fn,Gn)};function Bn(){return xt=Ot=null,xn}return xn.scale(1070)}function Yl(xt){return function(Ot,vr){var lr=l(Ot),Ir=l(vr),nn=xt(lr*Ir);return[nn*Ir*y(Ot),nn*y(vr)]}}function Pl(xt){return function(Ot,vr){var lr=d(Ot*Ot+vr*vr),Ir=xt(lr),nn=y(Ir),yn=l(Ir);return[x(Ot*nn,lr*yn),E(lr&&vr*nn/lr)]}}var uu=Yl(function(xt){return d(2/(1+xt))});uu.invert=Pl(function(xt){return 2*E(xt/2)});function Wl(){return Uo(uu).scale(124.75).clipAngle(180-.001)}var yl=Yl(function(xt){return(xt=S(xt))&&xt/y(xt)});yl.invert=Pl(function(xt){return xt});function vf(){return Uo(yl).scale(79.4188).clipAngle(180-.001)}function _s(xt,Ot){return[xt,M(C((f+Ot)/2))]}_s.invert=function(xt,Ot){return[xt,2*v(c(Ot))-f]};function Cf(){return Au(_s).scale(961/s)}function Au(xt){var Ot=Uo(xt),vr=Ot.center,lr=Ot.scale,Ir=Ot.translate,nn=Ot.clipExtent,yn=null,En,Pn,Vn;Ot.scale=function(Bn){return arguments.length?(lr(Bn),xn()):lr()},Ot.translate=function(Bn){return arguments.length?(Ir(Bn),xn()):Ir()},Ot.center=function(Bn){return arguments.length?(vr(Bn),xn()):vr()},Ot.clipExtent=function(Bn){return arguments.length?(Bn==null?yn=En=Pn=Vn=null:(yn=+Bn[0][0],En=+Bn[0][1],Pn=+Bn[1][0],Vn=+Bn[1][1]),xn()):yn==null?null:[[yn,En],[Pn,Vn]]};function xn(){var Bn=r*lr(),Fn=Ot(yt(Ot.rotate()).invert([0,0]));return nn(yn==null?[[Fn[0]-Bn,Fn[1]-Bn],[Fn[0]+Bn,Fn[1]+Bn]]:xt===_s?[[Math.max(Fn[0]-Bn,yn),En],[Math.min(Fn[0]+Bn,Pn),Vn]]:[[yn,Math.max(Fn[1]-Bn,En)],[Pn,Math.min(Fn[1]+Bn,Vn)]])}return xn()}function Fl(xt){return C((f+xt)/2)}function Xl(xt,Ot){var vr=l(xt),lr=xt===Ot?y(xt):M(vr/l(Ot))/M(Fl(Ot)/Fl(xt)),Ir=vr*_(Fl(xt),lr)/lr;if(!lr)return _s;function nn(yn,En){Ir>0?En<-f+n&&(En=-f+n):En>f-n&&(En=f-n);var Pn=Ir/_(Fl(En),lr);return[Pn*y(lr*yn),Ir-Pn*l(lr*yn)]}return nn.invert=function(yn,En){var Pn=Ir-En,Vn=w(lr)*d(yn*yn+Pn*Pn),xn=x(yn,p(Pn))*w(Pn);return Pn*lr<0&&(xn-=r*w(yn)*w(Pn)),[xn/lr,2*v(_(Ir/Vn,1/lr))-f]},nn}function ml(){return Gs(Xl).scale(109.5).parallels([30,30])}function Zl(xt,Ot){return[xt,Ot]}Zl.invert=Zl;function Uu(){return Uo(Zl).scale(152.63)}function Vu(xt,Ot){var vr=l(xt),lr=xt===Ot?y(xt):(vr-l(Ot))/(Ot-xt),Ir=vr/lr+xt;if(p(lr)<n)return Zl;function nn(yn,En){var Pn=Ir-En,Vn=lr*yn;return[Pn*y(Vn),Ir-Pn*l(Vn)]}return nn.invert=function(yn,En){var Pn=Ir-En,Vn=x(yn,p(Pn))*w(Pn);return Pn*lr<0&&(Vn-=r*w(yn)*w(Pn)),[Vn/lr,Ir-w(lr)*d(yn*yn+Pn*Pn)]},nn}function kf(){return Gs(Vu).scale(131.154).center([0,13.9389])}var Hi=1.340264,Rl=-.081106,xl=893e-6,gs=.003796,ws=d(3)/2,jl=12;function xo(xt,Ot){var vr=E(ws*y(Ot)),lr=vr*vr,Ir=lr*lr*lr;return[xt*l(vr)/(ws*(Hi+3*Rl*lr+Ir*(7*xl+9*gs*lr))),vr*(Hi+Rl*lr+Ir*(xl+gs*lr))]}xo.invert=function(xt,Ot){for(var vr=Ot,lr=vr*vr,Ir=lr*lr*lr,nn=0,yn,En,Pn;nn<jl&&(En=vr*(Hi+Rl*lr+Ir*(xl+gs*lr))-Ot,Pn=Hi+3*Rl*lr+Ir*(7*xl+9*gs*lr),vr-=yn=En/Pn,lr=vr*vr,Ir=lr*lr*lr,!(p(yn)<a));++nn);return[ws*xt*(Hi+3*Rl*lr+Ir*(7*xl+9*gs*lr))/l(vr),E(y(vr)/ws)]};function Hu(){return Uo(xo).scale(177.158)}function Ts(xt,Ot){var vr=l(Ot),lr=l(xt)*vr;return[vr*y(xt)/lr,y(Ot)/lr]}Ts.invert=Pl(v);function tl(){return Uo(Ts).scale(144.049).clipAngle(60)}function rl(){var xt=1,Ot=0,vr=0,lr=1,Ir=1,nn=0,yn,En,Pn=null,Vn,xn,Bn,Fn=1,Gn=1,ea=pl({point:function(da,Za){var ti=$n([da,Za]);this.stream.point(ti[0],ti[1])}}),Na=cn,La,Oa;function Ua(){return Fn=xt*lr,Gn=xt*Ir,La=Oa=null,$n}function $n(da){var Za=da[0]*Fn,ti=da[1]*Gn;if(nn){var wi=ti*yn-Za*En;Za=Za*yn+ti*En,ti=wi}return[Za+Ot,ti+vr]}return $n.invert=function(da){var Za=da[0]-Ot,ti=da[1]-vr;if(nn){var wi=ti*yn+Za*En;Za=Za*yn-ti*En,ti=wi}return[Za/Fn,ti/Gn]},$n.stream=function(da){return La&&Oa===da?La:La=ea(Na(Oa=da))},$n.postclip=function(da){return arguments.length?(Na=da,Pn=Vn=xn=Bn=null,Ua()):Na},$n.clipExtent=function(da){return arguments.length?(Na=da==null?(Pn=Vn=xn=Bn=null,cn):vn(Pn=+da[0][0],Vn=+da[0][1],xn=+da[1][0],Bn=+da[1][1]),Ua()):Pn==null?null:[[Pn,Vn],[xn,Bn]]},$n.scale=function(da){return arguments.length?(xt=+da,Ua()):xt},$n.translate=function(da){return arguments.length?(Ot=+da[0],vr=+da[1],Ua()):[Ot,vr]},$n.angle=function(da){return arguments.length?(nn=da%360*g,En=y(nn),yn=l(nn),Ua()):nn*m},$n.reflectX=function(da){return arguments.length?(lr=da?-1:1,Ua()):lr<0},$n.reflectY=function(da){return arguments.length?(Ir=da?-1:1,Ua()):Ir<0},$n.fitExtent=function(da,Za){return Fs($n,da,Za)},$n.fitSize=function(da,Za){return Vl($n,da,Za)},$n.fitWidth=function(da,Za){return wu($n,da,Za)},$n.fitHeight=function(da,Za){return Bu($n,da,Za)},$n}function Ws(xt,Ot){var vr=Ot*Ot,lr=vr*vr;return[xt*(.8707-.131979*vr+lr*(-.013791+lr*(.003971*vr-.001529*lr))),Ot*(1.007226+vr*(.015085+lr*(-.044475+.028874*vr-.005916*lr)))]}Ws.invert=function(xt,Ot){var vr=Ot,lr=25,Ir;do{var nn=vr*vr,yn=nn*nn;vr-=Ir=(vr*(1.007226+nn*(.015085+yn*(-.044475+.028874*nn-.005916*yn)))-Ot)/(1.007226+nn*(.015085*3+yn*(-.044475*7+.028874*9*nn-.005916*11*yn)))}while(p(Ir)>n&&--lr>0);return[xt/(.8707+(nn=vr*vr)*(-.131979+nn*(-.013791+nn*nn*nn*(.003971-.001529*nn)))),vr]};function As(){return Uo(Ws).scale(175.295)}function Qi(xt,Ot){return[l(Ot)*y(xt),y(Ot)]}Qi.invert=Pl(E);function Vo(){return Uo(Qi).scale(249.5).clipAngle(90+n)}function Ms(xt,Ot){var vr=l(Ot),lr=1+l(xt)*vr;return[vr*y(xt)/lr,y(Ot)/lr]}Ms.invert=Pl(function(xt){return 2*v(xt)});function Gu(){return Uo(Ms).scale(250).clipAngle(142)}function fu(xt,Ot){return[M(C((f+Ot)/2)),-xt]}fu.invert=function(xt,Ot){return[-Ot,2*v(c(xt))-f]};function Yu(){var xt=Au(fu),Ot=xt.center,vr=xt.rotate;return xt.center=function(lr){return arguments.length?Ot([-lr[1],lr[0]]):(lr=Ot(),[lr[1],-lr[0]])},xt.rotate=function(lr){return arguments.length?vr([lr[0],lr[1],lr.length>2?lr[2]+90:90]):(lr=vr(),[lr[0],lr[1],lr[2]-90])},vr([0,0,90]).scale(159.155)}h.geoAlbers=Gl,h.geoAlbersUsa=Is,h.geoArea=J,h.geoAzimuthalEqualArea=Wl,h.geoAzimuthalEqualAreaRaw=uu,h.geoAzimuthalEquidistant=vf,h.geoAzimuthalEquidistantRaw=yl,h.geoBounds=Ze,h.geoCentroid=St,h.geoCircle=ar,h.geoClipAntimeridian=jt,h.geoClipCircle=Dr,h.geoClipExtent=Un,h.geoClipRectangle=vn,h.geoConicConformal=ml,h.geoConicConformalRaw=Xl,h.geoConicEqualArea=Hl,h.geoConicEqualAreaRaw=mo,h.geoConicEquidistant=kf,h.geoConicEquidistantRaw=Vu,h.geoContains=pr,h.geoDistance=Sn,h.geoEqualEarth=Hu,h.geoEqualEarthRaw=xo,h.geoEquirectangular=Uu,h.geoEquirectangularRaw=Zl,h.geoGnomonic=tl,h.geoGnomonicRaw=Ts,h.geoGraticule=rn,h.geoGraticule10=Mn,h.geoIdentity=rl,h.geoInterpolate=_n,h.geoLength=Mr,h.geoMercator=Cf,h.geoMercatorRaw=_s,h.geoNaturalEarth1=As,h.geoNaturalEarth1Raw=Ws,h.geoOrthographic=Vo,h.geoOrthographicRaw=Qi,h.geoPath=iu,h.geoProjection=Uo,h.geoProjectionMutator=lu,h.geoRotation=yt,h.geoStereographic=Gu,h.geoStereographicRaw=Ms,h.geoStream=V,h.geoTransform=cf,h.geoTransverseMercator=Yu,h.geoTransverseMercatorRaw=fu,Object.defineProperty(h,"__esModule",{value:!0})})},{"d3-array":107}],115:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R):(h=h||self,u(h.d3=h.d3||{}))})(this,function(h){function u(Ye,Ee){return Ye.parent===Ee.parent?1:2}function A(Ye){return Ye.reduce(T,0)/Ye.length}function T(Ye,Ee){return Ye+Ee.x}function e(Ye){return 1+Ye.reduce(i,0)}function i(Ye,Ee){return Math.max(Ye,Ee.y)}function n(Ye){for(var Ee;Ee=Ye.children;)Ye=Ee[0];return Ye}function a(Ye){for(var Ee;Ee=Ye.children;)Ye=Ee[Ee.length-1];return Ye}function r(){var Ye=u,Ee=1,Ge=1,Je=!1;function qe(Tt){var mt,Mt=0;Tt.eachAfter(function(Yt){var or=Yt.children;or?(Yt.x=A(or),Yt.y=e(or)):(Yt.x=mt?Mt+=Ye(Yt,mt):0,Yt.y=0,mt=Yt)});var Ht=n(Tt),Rt=a(Tt),Vt=Ht.x-Ye(Ht,Rt)/2,Jt=Rt.x+Ye(Rt,Ht)/2;return Tt.eachAfter(Je?function(Yt){Yt.x=(Yt.x-Tt.x)*Ee,Yt.y=(Tt.y-Yt.y)*Ge}:function(Yt){Yt.x=(Yt.x-Vt)/(Jt-Vt)*Ee,Yt.y=(1-(Tt.y?Yt.y/Tt.y:1))*Ge})}return qe.separation=function(Tt){return arguments.length?(Ye=Tt,qe):Ye},qe.size=function(Tt){return arguments.length?(Je=!1,Ee=+Tt[0],Ge=+Tt[1],qe):Je?null:[Ee,Ge]},qe.nodeSize=function(Tt){return arguments.length?(Je=!0,Ee=+Tt[0],Ge=+Tt[1],qe):Je?[Ee,Ge]:null},qe}function f(Ye){var Ee=0,Ge=Ye.children,Je=Ge&&Ge.length;if(!Je)Ee=1;else for(;--Je>=0;)Ee+=Ge[Je].value;Ye.value=Ee}function o(){return this.eachAfter(f)}function s(Ye){var Ee=this,Ge,Je=[Ee],qe,Tt,mt;do for(Ge=Je.reverse(),Je=[];Ee=Ge.pop();)if(Ye(Ee),qe=Ee.children,qe)for(Tt=0,mt=qe.length;Tt<mt;++Tt)Je.push(qe[Tt]);while(Je.length);return this}function m(Ye){for(var Ee=this,Ge=[Ee],Je,qe;Ee=Ge.pop();)if(Ye(Ee),Je=Ee.children,Je)for(qe=Je.length-1;qe>=0;--qe)Ge.push(Je[qe]);return this}function g(Ye){for(var Ee=this,Ge=[Ee],Je=[],qe,Tt,mt;Ee=Ge.pop();)if(Je.push(Ee),qe=Ee.children,qe)for(Tt=0,mt=qe.length;Tt<mt;++Tt)Ge.push(qe[Tt]);for(;Ee=Je.pop();)Ye(Ee);return this}function p(Ye){return this.eachAfter(function(Ee){for(var Ge=+Ye(Ee.data)||0,Je=Ee.children,qe=Je&&Je.length;--qe>=0;)Ge+=Je[qe].value;Ee.value=Ge})}function v(Ye){return this.eachBefore(function(Ee){Ee.children&&Ee.children.sort(Ye)})}function x(Ye){for(var Ee=this,Ge=l(Ee,Ye),Je=[Ee];Ee!==Ge;)Ee=Ee.parent,Je.push(Ee);for(var qe=Je.length;Ye!==Ge;)Je.splice(qe,0,Ye),Ye=Ye.parent;return Je}function l(Ye,Ee){if(Ye===Ee)return Ye;var Ge=Ye.ancestors(),Je=Ee.ancestors(),qe=null;for(Ye=Ge.pop(),Ee=Je.pop();Ye===Ee;)qe=Ye,Ye=Ge.pop(),Ee=Je.pop();return qe}function b(){for(var Ye=this,Ee=[Ye];Ye=Ye.parent;)Ee.push(Ye);return Ee}function c(){var Ye=[];return this.each(function(Ee){Ye.push(Ee)}),Ye}function M(){var Ye=[];return this.eachBefore(function(Ee){Ee.children||Ye.push(Ee)}),Ye}function _(){var Ye=this,Ee=[];return Ye.each(function(Ge){Ge!==Ye&&Ee.push({source:Ge.parent,target:Ge})}),Ee}function y(Ye,Ee){var Ge=new E(Ye),Je=+Ye.value&&(Ge.value=Ye.value),qe,Tt=[Ge],mt,Mt,Ht,Rt;for(Ee==null&&(Ee=d);qe=Tt.pop();)if(Je&&(qe.value=+qe.data.value),(Mt=Ee(qe.data))&&(Rt=Mt.length))for(qe.children=new Array(Rt),Ht=Rt-1;Ht>=0;--Ht)Tt.push(mt=qe.children[Ht]=new E(Mt[Ht])),mt.parent=qe,mt.depth=qe.depth+1;return Ge.eachBefore(S)}function w(){return y(this).eachBefore(C)}function d(Ye){return Ye.children}function C(Ye){Ye.data=Ye.data.data}function S(Ye){var Ee=0;do Ye.height=Ee;while((Ye=Ye.parent)&&Ye.height<++Ee)}function E(Ye){this.data=Ye,this.depth=this.height=0,this.parent=null}E.prototype=y.prototype={constructor:E,count:o,each:s,eachAfter:g,eachBefore:m,sum:p,sort:v,path:x,ancestors:b,descendants:c,leaves:M,links:_,copy:w};var k=Array.prototype.slice;function B(Ye){for(var Ee=Ye.length,Ge,Je;Ee;)Je=Math.random()*Ee--|0,Ge=Ye[Ee],Ye[Ee]=Ye[Je],Ye[Je]=Ge;return Ye}function z(Ye){for(var Ee=0,Ge=(Ye=B(k.call(Ye))).length,Je=[],qe,Tt;Ee<Ge;)qe=Ye[Ee],Tt&&O(Tt,qe)?++Ee:(Tt=V(Je=F(Je,qe)),Ee=0);return Tt}function F(Ye,Ee){var Ge,Je;if(N(Ee,Ye))return[Ee];for(Ge=0;Ge<Ye.length;++Ge)if(I(Ee,Ye[Ge])&&N(j(Ye[Ge],Ee),Ye))return[Ye[Ge],Ee];for(Ge=0;Ge<Ye.length-1;++Ge)for(Je=Ge+1;Je<Ye.length;++Je)if(I(j(Ye[Ge],Ye[Je]),Ee)&&I(j(Ye[Ge],Ee),Ye[Je])&&I(j(Ye[Je],Ee),Ye[Ge])&&N(Z(Ye[Ge],Ye[Je],Ee),Ye))return[Ye[Ge],Ye[Je],Ee];throw new Error}function I(Ye,Ee){var Ge=Ye.r-Ee.r,Je=Ee.x-Ye.x,qe=Ee.y-Ye.y;return Ge<0||Ge*Ge<Je*Je+qe*qe}function O(Ye,Ee){var Ge=Ye.r-Ee.r+1e-6,Je=Ee.x-Ye.x,qe=Ee.y-Ye.y;return Ge>0&&Ge*Ge>Je*Je+qe*qe}function N(Ye,Ee){for(var Ge=0;Ge<Ee.length;++Ge)if(!O(Ye,Ee[Ge]))return!1;return!0}function V(Ye){switch(Ye.length){case 1:return H(Ye[0]);case 2:return j(Ye[0],Ye[1]);case 3:return Z(Ye[0],Ye[1],Ye[2])}}function H(Ye){return{x:Ye.x,y:Ye.y,r:Ye.r}}function j(Ye,Ee){var Ge=Ye.x,Je=Ye.y,qe=Ye.r,Tt=Ee.x,mt=Ee.y,Mt=Ee.r,Ht=Tt-Ge,Rt=mt-Je,Vt=Mt-qe,Jt=Math.sqrt(Ht*Ht+Rt*Rt);return{x:(Ge+Tt+Ht/Jt*Vt)/2,y:(Je+mt+Rt/Jt*Vt)/2,r:(Jt+qe+Mt)/2}}function Z(Ye,Ee,Ge){var Je=Ye.x,qe=Ye.y,Tt=Ye.r,mt=Ee.x,Mt=Ee.y,Ht=Ee.r,Rt=Ge.x,Vt=Ge.y,Jt=Ge.r,Yt=Je-mt,or=Je-Rt,Hr=qe-Mt,an=qe-Vt,Kr=Ht-Tt,ot=Jt-Tt,er=Je*Je+qe*qe-Tt*Tt,Kt=er-mt*mt-Mt*Mt+Ht*Ht,ur=er-Rt*Rt-Vt*Vt+Jt*Jt,Ar=or*Hr-Yt*an,et=(Hr*ur-an*Kt)/(Ar*2)-Je,$e=(an*Kr-Hr*ot)/Ar,st=(or*Kt-Yt*ur)/(Ar*2)-qe,ft=(Yt*ot-or*Kr)/Ar,St=$e*$e+ft*ft-1,Ut=2*(Tt+et*$e+st*ft),Pe=et*et+st*st-Tt*Tt,ke=-(St?(Ut+Math.sqrt(Ut*Ut-4*St*Pe))/(2*St):Pe/Ut);return{x:Je+et+$e*ke,y:qe+st+ft*ke,r:ke}}function X(Ye,Ee,Ge){var Je=Ye.x-Ee.x,qe,Tt,mt=Ye.y-Ee.y,Mt,Ht,Rt=Je*Je+mt*mt;Rt?(Tt=Ee.r+Ge.r,Tt*=Tt,Ht=Ye.r+Ge.r,Ht*=Ht,Tt>Ht?(qe=(Rt+Ht-Tt)/(2*Rt),Mt=Math.sqrt(Math.max(0,Ht/Rt-qe*qe)),Ge.x=Ye.x-qe*Je-Mt*mt,Ge.y=Ye.y-qe*mt+Mt*Je):(qe=(Rt+Tt-Ht)/(2*Rt),Mt=Math.sqrt(Math.max(0,Tt/Rt-qe*qe)),Ge.x=Ee.x+qe*Je-Mt*mt,Ge.y=Ee.y+qe*mt+Mt*Je)):(Ge.x=Ee.x+Ge.r,Ge.y=Ee.y)}function re(Ye,Ee){var Ge=Ye.r+Ee.r-1e-6,Je=Ee.x-Ye.x,qe=Ee.y-Ye.y;return Ge>0&&Ge*Ge>Je*Je+qe*qe}function ue(Ye){var Ee=Ye._,Ge=Ye.next._,Je=Ee.r+Ge.r,qe=(Ee.x*Ge.r+Ge.x*Ee.r)/Je,Tt=(Ee.y*Ge.r+Ge.y*Ee.r)/Je;return qe*qe+Tt*Tt}function K(Ye){this._=Ye,this.next=null,this.previous=null}function te(Ye){if(!(qe=Ye.length))return 0;var Ee,Ge,Je,qe,Tt,mt,Mt,Ht,Rt,Vt,Jt;if(Ee=Ye[0],Ee.x=0,Ee.y=0,!(qe>1))return Ee.r;if(Ge=Ye[1],Ee.x=-Ge.r,Ge.x=Ee.r,Ge.y=0,!(qe>2))return Ee.r+Ge.r;X(Ge,Ee,Je=Ye[2]),Ee=new K(Ee),Ge=new K(Ge),Je=new K(Je),Ee.next=Je.previous=Ge,Ge.next=Ee.previous=Je,Je.next=Ge.previous=Ee;e:for(Mt=3;Mt<qe;++Mt){X(Ee._,Ge._,Je=Ye[Mt]),Je=new K(Je),Ht=Ge.next,Rt=Ee.previous,Vt=Ge._.r,Jt=Ee._.r;do if(Vt<=Jt){if(re(Ht._,Je._)){Ge=Ht,Ee.next=Ge,Ge.previous=Ee,--Mt;continue e}Vt+=Ht._.r,Ht=Ht.next}else{if(re(Rt._,Je._)){Ee=Rt,Ee.next=Ge,Ge.previous=Ee,--Mt;continue e}Jt+=Rt._.r,Rt=Rt.previous}while(Ht!==Rt.next);for(Je.previous=Ee,Je.next=Ge,Ee.next=Ge.previous=Ge=Je,Tt=ue(Ee);(Je=Je.next)!==Ge;)(mt=ue(Je))<Tt&&(Ee=Je,Tt=mt);Ge=Ee.next}for(Ee=[Ge._],Je=Ge;(Je=Je.next)!==Ge;)Ee.push(Je._);for(Je=z(Ee),Mt=0;Mt<qe;++Mt)Ee=Ye[Mt],Ee.x-=Je.x,Ee.y-=Je.y;return Je.r}function G(Ye){return te(Ye),Ye}function Y(Ye){return Ye==null?null:ee(Ye)}function ee(Ye){if(typeof Ye!="function")throw new Error;return Ye}function ne(){return 0}function J(Ye){return function(){return Ye}}function q(Ye){return Math.sqrt(Ye.value)}function ae(){var Ye=null,Ee=1,Ge=1,Je=ne;function qe(Tt){return Tt.x=Ee/2,Tt.y=Ge/2,Ye?Tt.eachBefore(le(Ye)).eachAfter(ie(Je,.5)).eachBefore(se(1)):Tt.eachBefore(le(q)).eachAfter(ie(ne,1)).eachAfter(ie(Je,Tt.r/Math.min(Ee,Ge))).eachBefore(se(Math.min(Ee,Ge)/(2*Tt.r))),Tt}return qe.radius=function(Tt){return arguments.length?(Ye=Y(Tt),qe):Ye},qe.size=function(Tt){return arguments.length?(Ee=+Tt[0],Ge=+Tt[1],qe):[Ee,Ge]},qe.padding=function(Tt){return arguments.length?(Je=typeof Tt=="function"?Tt:J(+Tt),qe):Je},qe}function le(Ye){return function(Ee){Ee.children||(Ee.r=Math.max(0,+Ye(Ee)||0))}}function ie(Ye,Ee){return function(Ge){if(Je=Ge.children){var Je,qe,Tt=Je.length,mt=Ye(Ge)*Ee||0,Mt;if(mt)for(qe=0;qe<Tt;++qe)Je[qe].r+=mt;if(Mt=te(Je),mt)for(qe=0;qe<Tt;++qe)Je[qe].r-=mt;Ge.r=Mt+mt}}}function se(Ye){return function(Ee){var Ge=Ee.parent;Ee.r*=Ye,Ge&&(Ee.x=Ge.x+Ye*Ee.x,Ee.y=Ge.y+Ye*Ee.y)}}function xe(Ye){Ye.x0=Math.round(Ye.x0),Ye.y0=Math.round(Ye.y0),Ye.x1=Math.round(Ye.x1),Ye.y1=Math.round(Ye.y1)}function oe(Ye,Ee,Ge,Je,qe){for(var Tt=Ye.children,mt,Mt=-1,Ht=Tt.length,Rt=Ye.value&&(Je-Ee)/Ye.value;++Mt<Ht;)mt=Tt[Mt],mt.y0=Ge,mt.y1=qe,mt.x0=Ee,mt.x1=Ee+=mt.value*Rt}function he(){var Ye=1,Ee=1,Ge=0,Je=!1;function qe(mt){var Mt=mt.height+1;return mt.x0=mt.y0=Ge,mt.x1=Ye,mt.y1=Ee/Mt,mt.eachBefore(Tt(Ee,Mt)),Je&&mt.eachBefore(xe),mt}function Tt(mt,Mt){return function(Ht){Ht.children&&oe(Ht,Ht.x0,mt*(Ht.depth+1)/Mt,Ht.x1,mt*(Ht.depth+2)/Mt);var Rt=Ht.x0,Vt=Ht.y0,Jt=Ht.x1-Ge,Yt=Ht.y1-Ge;Jt<Rt&&(Rt=Jt=(Rt+Jt)/2),Yt<Vt&&(Vt=Yt=(Vt+Yt)/2),Ht.x0=Rt,Ht.y0=Vt,Ht.x1=Jt,Ht.y1=Yt}}return qe.round=function(mt){return arguments.length?(Je=!!mt,qe):Je},qe.size=function(mt){return arguments.length?(Ye=+mt[0],Ee=+mt[1],qe):[Ye,Ee]},qe.padding=function(mt){return arguments.length?(Ge=+mt,qe):Ge},qe}var be="$",me={depth:-1},_e={};function Se(Ye){return Ye.id}function De(Ye){return Ye.parentId}function Ie(){var Ye=Se,Ee=De;function Ge(Je){var qe,Tt,mt=Je.length,Mt,Ht,Rt,Vt=new Array(mt),Jt,Yt,or={};for(Tt=0;Tt<mt;++Tt)qe=Je[Tt],Rt=Vt[Tt]=new E(qe),(Jt=Ye(qe,Tt,Je))!=null&&(Jt+="")&&(Yt=be+(Rt.id=Jt),or[Yt]=Yt in or?_e:Rt);for(Tt=0;Tt<mt;++Tt)if(Rt=Vt[Tt],Jt=Ee(Je[Tt],Tt,Je),Jt==null||!(Jt+="")){if(Mt)throw new Error("multiple roots");Mt=Rt}else{if(Ht=or[be+Jt],!Ht)throw new Error("missing: "+Jt);if(Ht===_e)throw new Error("ambiguous: "+Jt);Ht.children?Ht.children.push(Rt):Ht.children=[Rt],Rt.parent=Ht}if(!Mt)throw new Error("no root");if(Mt.parent=me,Mt.eachBefore(function(Hr){Hr.depth=Hr.parent.depth+1,--mt}).eachBefore(S),Mt.parent=null,mt>0)throw new Error("cycle");return Mt}return Ge.id=function(Je){return arguments.length?(Ye=ee(Je),Ge):Ye},Ge.parentId=function(Je){return arguments.length?(Ee=ee(Je),Ge):Ee},Ge}function Te(Ye,Ee){return Ye.parent===Ee.parent?1:2}function Ce(Ye){var Ee=Ye.children;return Ee?Ee[0]:Ye.t}function He(Ye){var Ee=Ye.children;return Ee?Ee[Ee.length-1]:Ye.t}function Xe(Ye,Ee,Ge){var Je=Ge/(Ee.i-Ye.i);Ee.c-=Je,Ee.s+=Ge,Ye.c+=Je,Ee.z+=Ge,Ee.m+=Ge}function Be(Ye){for(var Ee=0,Ge=0,Je=Ye.children,qe=Je.length,Tt;--qe>=0;)Tt=Je[qe],Tt.z+=Ee,Tt.m+=Ee,Ee+=Tt.s+(Ge+=Tt.c)}function Re(Ye,Ee,Ge){return Ye.a.parent===Ee.parent?Ye.a:Ge}function We(Ye,Ee){this._=Ye,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=Ee}We.prototype=Object.create(E.prototype);function vt(Ye){for(var Ee=new We(Ye,0),Ge,Je=[Ee],qe,Tt,mt,Mt;Ge=Je.pop();)if(Tt=Ge._.children)for(Ge.children=new Array(Mt=Tt.length),mt=Mt-1;mt>=0;--mt)Je.push(qe=Ge.children[mt]=new We(Tt[mt],mt)),qe.parent=Ge;return(Ee.parent=new We(null,0)).children=[Ee],Ee}function Pt(){var Ye=Te,Ee=1,Ge=1,Je=null;function qe(Rt){var Vt=vt(Rt);if(Vt.eachAfter(Tt),Vt.parent.m=-Vt.z,Vt.eachBefore(mt),Je)Rt.eachBefore(Ht);else{var Jt=Rt,Yt=Rt,or=Rt;Rt.eachBefore(function(er){er.x<Jt.x&&(Jt=er),er.x>Yt.x&&(Yt=er),er.depth>or.depth&&(or=er)});var Hr=Jt===Yt?1:Ye(Jt,Yt)/2,an=Hr-Jt.x,Kr=Ee/(Yt.x+Hr+an),ot=Ge/(or.depth||1);Rt.eachBefore(function(er){er.x=(er.x+an)*Kr,er.y=er.depth*ot})}return Rt}function Tt(Rt){var Vt=Rt.children,Jt=Rt.parent.children,Yt=Rt.i?Jt[Rt.i-1]:null;if(Vt){Be(Rt);var or=(Vt[0].z+Vt[Vt.length-1].z)/2;Yt?(Rt.z=Yt.z+Ye(Rt._,Yt._),Rt.m=Rt.z-or):Rt.z=or}else Yt&&(Rt.z=Yt.z+Ye(Rt._,Yt._));Rt.parent.A=Mt(Rt,Yt,Rt.parent.A||Jt[0])}function mt(Rt){Rt._.x=Rt.z+Rt.parent.m,Rt.m+=Rt.parent.m}function Mt(Rt,Vt,Jt){if(Vt){for(var Yt=Rt,or=Rt,Hr=Vt,an=Yt.parent.children[0],Kr=Yt.m,ot=or.m,er=Hr.m,Kt=an.m,ur;Hr=He(Hr),Yt=Ce(Yt),Hr&&Yt;)an=Ce(an),or=He(or),or.a=Rt,ur=Hr.z+er-Yt.z-Kr+Ye(Hr._,Yt._),ur>0&&(Xe(Re(Hr,Rt,Jt),Rt,ur),Kr+=ur,ot+=ur),er+=Hr.m,Kr+=Yt.m,Kt+=an.m,ot+=or.m;Hr&&!He(or)&&(or.t=Hr,or.m+=er-ot),Yt&&!Ce(an)&&(an.t=Yt,an.m+=Kr-Kt,Jt=Rt)}return Jt}function Ht(Rt){Rt.x*=Ee,Rt.y=Rt.depth*Ge}return qe.separation=function(Rt){return arguments.length?(Ye=Rt,qe):Ye},qe.size=function(Rt){return arguments.length?(Je=!1,Ee=+Rt[0],Ge=+Rt[1],qe):Je?null:[Ee,Ge]},qe.nodeSize=function(Rt){return arguments.length?(Je=!0,Ee=+Rt[0],Ge=+Rt[1],qe):Je?[Ee,Ge]:null},qe}function Zt(Ye,Ee,Ge,Je,qe){for(var Tt=Ye.children,mt,Mt=-1,Ht=Tt.length,Rt=Ye.value&&(qe-Ge)/Ye.value;++Mt<Ht;)mt=Tt[Mt],mt.x0=Ee,mt.x1=Je,mt.y0=Ge,mt.y1=Ge+=mt.value*Rt}var zt=(1+Math.sqrt(5))/2;function At(Ye,Ee,Ge,Je,qe,Tt){for(var mt=[],Mt=Ee.children,Ht,Rt,Vt=0,Jt=0,Yt=Mt.length,or,Hr,an=Ee.value,Kr,ot,er,Kt,ur,Ar,et;Vt<Yt;){or=qe-Ge,Hr=Tt-Je;do Kr=Mt[Jt++].value;while(!Kr&&Jt<Yt);for(ot=er=Kr,Ar=Math.max(Hr/or,or/Hr)/(an*Ye),et=Kr*Kr*Ar,ur=Math.max(er/et,et/ot);Jt<Yt;++Jt){if(Kr+=Rt=Mt[Jt].value,Rt<ot&&(ot=Rt),Rt>er&&(er=Rt),et=Kr*Kr*Ar,Kt=Math.max(er/et,et/ot),Kt>ur){Kr-=Rt;break}ur=Kt}mt.push(Ht={value:Kr,dice:or<Hr,children:Mt.slice(Vt,Jt)}),Ht.dice?oe(Ht,Ge,Je,qe,an?Je+=Hr*Kr/an:Tt):Zt(Ht,Ge,Je,an?Ge+=or*Kr/an:qe,Tt),an-=Kr,Vt=Jt}return mt}var Wt=function Ye(Ee){function Ge(Je,qe,Tt,mt,Mt){At(Ee,Je,qe,Tt,mt,Mt)}return Ge.ratio=function(Je){return Ye((Je=+Je)>1?Je:1)},Ge}(zt);function Bt(){var Ye=Wt,Ee=!1,Ge=1,Je=1,qe=[0],Tt=ne,mt=ne,Mt=ne,Ht=ne,Rt=ne;function Vt(Yt){return Yt.x0=Yt.y0=0,Yt.x1=Ge,Yt.y1=Je,Yt.eachBefore(Jt),qe=[0],Ee&&Yt.eachBefore(xe),Yt}function Jt(Yt){var or=qe[Yt.depth],Hr=Yt.x0+or,an=Yt.y0+or,Kr=Yt.x1-or,ot=Yt.y1-or;Kr<Hr&&(Hr=Kr=(Hr+Kr)/2),ot<an&&(an=ot=(an+ot)/2),Yt.x0=Hr,Yt.y0=an,Yt.x1=Kr,Yt.y1=ot,Yt.children&&(or=qe[Yt.depth+1]=Tt(Yt)/2,Hr+=Rt(Yt)-or,an+=mt(Yt)-or,Kr-=Mt(Yt)-or,ot-=Ht(Yt)-or,Kr<Hr&&(Hr=Kr=(Hr+Kr)/2),ot<an&&(an=ot=(an+ot)/2),Ye(Yt,Hr,an,Kr,ot))}return Vt.round=function(Yt){return arguments.length?(Ee=!!Yt,Vt):Ee},Vt.size=function(Yt){return arguments.length?(Ge=+Yt[0],Je=+Yt[1],Vt):[Ge,Je]},Vt.tile=function(Yt){return arguments.length?(Ye=ee(Yt),Vt):Ye},Vt.padding=function(Yt){return arguments.length?Vt.paddingInner(Yt).paddingOuter(Yt):Vt.paddingInner()},Vt.paddingInner=function(Yt){return arguments.length?(Tt=typeof Yt=="function"?Yt:J(+Yt),Vt):Tt},Vt.paddingOuter=function(Yt){return arguments.length?Vt.paddingTop(Yt).paddingRight(Yt).paddingBottom(Yt).paddingLeft(Yt):Vt.paddingTop()},Vt.paddingTop=function(Yt){return arguments.length?(mt=typeof Yt=="function"?Yt:J(+Yt),Vt):mt},Vt.paddingRight=function(Yt){return arguments.length?(Mt=typeof Yt=="function"?Yt:J(+Yt),Vt):Mt},Vt.paddingBottom=function(Yt){return arguments.length?(Ht=typeof Yt=="function"?Yt:J(+Yt),Vt):Ht},Vt.paddingLeft=function(Yt){return arguments.length?(Rt=typeof Yt=="function"?Yt:J(+Yt),Vt):Rt},Vt}function Ct(Ye,Ee,Ge,Je,qe){var Tt=Ye.children,mt,Mt=Tt.length,Ht,Rt=new Array(Mt+1);for(Rt[0]=Ht=mt=0;mt<Mt;++mt)Rt[mt+1]=Ht+=Tt[mt].value;Vt(0,Mt,Ye.value,Ee,Ge,Je,qe);function Vt(Jt,Yt,or,Hr,an,Kr,ot){if(Jt>=Yt-1){var er=Tt[Jt];er.x0=Hr,er.y0=an,er.x1=Kr,er.y1=ot;return}for(var Kt=Rt[Jt],ur=or/2+Kt,Ar=Jt+1,et=Yt-1;Ar<et;){var $e=Ar+et>>>1;Rt[$e]<ur?Ar=$e+1:et=$e}ur-Rt[Ar-1]<Rt[Ar]-ur&&Jt+1<Ar&&--Ar;var st=Rt[Ar]-Kt,ft=or-st;if(Kr-Hr>ot-an){var St=(Hr*ft+Kr*st)/or;Vt(Jt,Ar,st,Hr,an,St,ot),Vt(Ar,Yt,ft,St,an,Kr,ot)}else{var Ut=(an*ft+ot*st)/or;Vt(Jt,Ar,st,Hr,an,Kr,Ut),Vt(Ar,Yt,ft,Hr,Ut,Kr,ot)}}}function Ze(Ye,Ee,Ge,Je,qe){(Ye.depth&1?Zt:oe)(Ye,Ee,Ge,Je,qe)}var nt=function Ye(Ee){function Ge(Je,qe,Tt,mt,Mt){if((Ht=Je._squarify)&&Ht.ratio===Ee)for(var Ht,Rt,Vt,Jt,Yt=-1,or,Hr=Ht.length,an=Je.value;++Yt<Hr;){for(Rt=Ht[Yt],Vt=Rt.children,Jt=Rt.value=0,or=Vt.length;Jt<or;++Jt)Rt.value+=Vt[Jt].value;Rt.dice?oe(Rt,qe,Tt,mt,Tt+=(Mt-Tt)*Rt.value/an):Zt(Rt,qe,Tt,qe+=(mt-qe)*Rt.value/an,Mt),an-=Rt.value}else Je._squarify=Ht=At(Ee,Je,qe,Tt,mt,Mt),Ht.ratio=Ee}return Ge.ratio=function(Je){return Ye((Je=+Je)>1?Je:1)},Ge}(zt);h.cluster=r,h.hierarchy=y,h.pack=ae,h.packEnclose=z,h.packSiblings=G,h.partition=he,h.stratify=Ie,h.tree=Pt,h.treemap=Bt,h.treemapBinary=Ct,h.treemapDice=oe,h.treemapResquarify=nt,h.treemapSlice=Zt,h.treemapSliceDice=Ze,h.treemapSquarify=Wt,Object.defineProperty(h,"__esModule",{value:!0})})},{}],116:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R,t("d3-color")):(h=h||self,u(h.d3=h.d3||{},h.d3))})(this,function(h,u){function A(Te,Ce,He,Xe,Be){var Re=Te*Te,We=Re*Te;return((1-3*Te+3*Re-We)*Ce+(4-6*Re+3*We)*He+(1+3*Te+3*Re-3*We)*Xe+We*Be)/6}function T(Te){var Ce=Te.length-1;return function(He){var Xe=He<=0?He=0:He>=1?(He=1,Ce-1):Math.floor(He*Ce),Be=Te[Xe],Re=Te[Xe+1],We=Xe>0?Te[Xe-1]:2*Be-Re,vt=Xe<Ce-1?Te[Xe+2]:2*Re-Be;return A((He-Xe/Ce)*Ce,We,Be,Re,vt)}}function e(Te){var Ce=Te.length;return function(He){var Xe=Math.floor(((He%=1)<0?++He:He)*Ce),Be=Te[(Xe+Ce-1)%Ce],Re=Te[Xe%Ce],We=Te[(Xe+1)%Ce],vt=Te[(Xe+2)%Ce];return A((He-Xe/Ce)*Ce,Be,Re,We,vt)}}function i(Te){return function(){return Te}}function n(Te,Ce){return function(He){return Te+He*Ce}}function a(Te,Ce,He){return Te=Math.pow(Te,He),Ce=Math.pow(Ce,He)-Te,He=1/He,function(Xe){return Math.pow(Te+Xe*Ce,He)}}function r(Te,Ce){var He=Ce-Te;return He?n(Te,He>180||He<-180?He-360*Math.round(He/360):He):i(isNaN(Te)?Ce:Te)}function f(Te){return(Te=+Te)==1?o:function(Ce,He){return He-Ce?a(Ce,He,Te):i(isNaN(Ce)?He:Ce)}}function o(Te,Ce){var He=Ce-Te;return He?n(Te,He):i(isNaN(Te)?Ce:Te)}var s=function Te(Ce){var He=f(Ce);function Xe(Be,Re){var We=He((Be=u.rgb(Be)).r,(Re=u.rgb(Re)).r),vt=He(Be.g,Re.g),Pt=He(Be.b,Re.b),Zt=o(Be.opacity,Re.opacity);return function(zt){return Be.r=We(zt),Be.g=vt(zt),Be.b=Pt(zt),Be.opacity=Zt(zt),Be+""}}return Xe.gamma=Te,Xe}(1);function m(Te){return function(Ce){var He=Ce.length,Xe=new Array(He),Be=new Array(He),Re=new Array(He),We,vt;for(We=0;We<He;++We)vt=u.rgb(Ce[We]),Xe[We]=vt.r||0,Be[We]=vt.g||0,Re[We]=vt.b||0;return Xe=Te(Xe),Be=Te(Be),Re=Te(Re),vt.opacity=1,function(Pt){return vt.r=Xe(Pt),vt.g=Be(Pt),vt.b=Re(Pt),vt+""}}}var g=m(T),p=m(e);function v(Te,Ce){Ce||(Ce=[]);var He=Te?Math.min(Ce.length,Te.length):0,Xe=Ce.slice(),Be;return function(Re){for(Be=0;Be<He;++Be)Xe[Be]=Te[Be]*(1-Re)+Ce[Be]*Re;return Xe}}function x(Te){return ArrayBuffer.isView(Te)&&!(Te instanceof DataView)}function l(Te,Ce){return(x(Ce)?v:b)(Te,Ce)}function b(Te,Ce){var He=Ce?Ce.length:0,Xe=Te?Math.min(He,Te.length):0,Be=new Array(Xe),Re=new Array(He),We;for(We=0;We<Xe;++We)Be[We]=E(Te[We],Ce[We]);for(;We<He;++We)Re[We]=Ce[We];return function(vt){for(We=0;We<Xe;++We)Re[We]=Be[We](vt);return Re}}function c(Te,Ce){var He=new Date;return Te=+Te,Ce=+Ce,function(Xe){return He.setTime(Te*(1-Xe)+Ce*Xe),He}}function M(Te,Ce){return Te=+Te,Ce=+Ce,function(He){return Te*(1-He)+Ce*He}}function _(Te,Ce){var He={},Xe={},Be;(Te===null||typeof Te!="object")&&(Te={}),(Ce===null||typeof Ce!="object")&&(Ce={});for(Be in Ce)Be in Te?He[Be]=E(Te[Be],Ce[Be]):Xe[Be]=Ce[Be];return function(Re){for(Be in He)Xe[Be]=He[Be](Re);return Xe}}var y=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,w=new RegExp(y.source,"g");function d(Te){return function(){return Te}}function C(Te){return function(Ce){return Te(Ce)+""}}function S(Te,Ce){var He=y.lastIndex=w.lastIndex=0,Xe,Be,Re,We=-1,vt=[],Pt=[];for(Te=Te+"",Ce=Ce+"";(Xe=y.exec(Te))&&(Be=w.exec(Ce));)(Re=Be.index)>He&&(Re=Ce.slice(He,Re),vt[We]?vt[We]+=Re:vt[++We]=Re),(Xe=Xe[0])===(Be=Be[0])?vt[We]?vt[We]+=Be:vt[++We]=Be:(vt[++We]=null,Pt.push({i:We,x:M(Xe,Be)})),He=w.lastIndex;return He<Ce.length&&(Re=Ce.slice(He),vt[We]?vt[We]+=Re:vt[++We]=Re),vt.length<2?Pt[0]?C(Pt[0].x):d(Ce):(Ce=Pt.length,function(Zt){for(var zt=0,At;zt<Ce;++zt)vt[(At=Pt[zt]).i]=At.x(Zt);return vt.join("")})}function E(Te,Ce){var He=typeof Ce,Xe;return Ce==null||He==="boolean"?i(Ce):(He==="number"?M:He==="string"?(Xe=u.color(Ce))?(Ce=Xe,s):S:Ce instanceof u.color?s:Ce instanceof Date?c:x(Ce)?v:Array.isArray(Ce)?b:typeof Ce.valueOf!="function"&&typeof Ce.toString!="function"||isNaN(Ce)?_:M)(Te,Ce)}function k(Te){var Ce=Te.length;return function(He){return Te[Math.max(0,Math.min(Ce-1,Math.floor(He*Ce)))]}}function B(Te,Ce){var He=r(+Te,+Ce);return function(Xe){var Be=He(Xe);return Be-360*Math.floor(Be/360)}}function z(Te,Ce){return Te=+Te,Ce=+Ce,function(He){return Math.round(Te*(1-He)+Ce*He)}}var F=180/Math.PI,I={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function O(Te,Ce,He,Xe,Be,Re){var We,vt,Pt;return(We=Math.sqrt(Te*Te+Ce*Ce))&&(Te/=We,Ce/=We),(Pt=Te*He+Ce*Xe)&&(He-=Te*Pt,Xe-=Ce*Pt),(vt=Math.sqrt(He*He+Xe*Xe))&&(He/=vt,Xe/=vt,Pt/=vt),Te*Xe<Ce*He&&(Te=-Te,Ce=-Ce,Pt=-Pt,We=-We),{translateX:Be,translateY:Re,rotate:Math.atan2(Ce,Te)*F,skewX:Math.atan(Pt)*F,scaleX:We,scaleY:vt}}var N,V,H,j;function Z(Te){return Te==="none"?I:(N||(N=document.createElement("DIV"),V=document.documentElement,H=document.defaultView),N.style.transform=Te,Te=H.getComputedStyle(V.appendChild(N),null).getPropertyValue("transform"),V.removeChild(N),Te=Te.slice(7,-1).split(","),O(+Te[0],+Te[1],+Te[2],+Te[3],+Te[4],+Te[5]))}function X(Te){return Te==null||(j||(j=document.createElementNS("http://www.w3.org/2000/svg","g")),j.setAttribute("transform",Te),!(Te=j.transform.baseVal.consolidate()))?I:(Te=Te.matrix,O(Te.a,Te.b,Te.c,Te.d,Te.e,Te.f))}function re(Te,Ce,He,Xe){function Be(Zt){return Zt.length?Zt.pop()+" ":""}function Re(Zt,zt,At,Wt,Bt,Ct){if(Zt!==At||zt!==Wt){var Ze=Bt.push("translate(",null,Ce,null,He);Ct.push({i:Ze-4,x:M(Zt,At)},{i:Ze-2,x:M(zt,Wt)})}else(At||Wt)&&Bt.push("translate("+At+Ce+Wt+He)}function We(Zt,zt,At,Wt){Zt!==zt?(Zt-zt>180?zt+=360:zt-Zt>180&&(Zt+=360),Wt.push({i:At.push(Be(At)+"rotate(",null,Xe)-2,x:M(Zt,zt)})):zt&&At.push(Be(At)+"rotate("+zt+Xe)}function vt(Zt,zt,At,Wt){Zt!==zt?Wt.push({i:At.push(Be(At)+"skewX(",null,Xe)-2,x:M(Zt,zt)}):zt&&At.push(Be(At)+"skewX("+zt+Xe)}function Pt(Zt,zt,At,Wt,Bt,Ct){if(Zt!==At||zt!==Wt){var Ze=Bt.push(Be(Bt)+"scale(",null,",",null,")");Ct.push({i:Ze-4,x:M(Zt,At)},{i:Ze-2,x:M(zt,Wt)})}else(At!==1||Wt!==1)&&Bt.push(Be(Bt)+"scale("+At+","+Wt+")")}return function(Zt,zt){var At=[],Wt=[];return Zt=Te(Zt),zt=Te(zt),Re(Zt.translateX,Zt.translateY,zt.translateX,zt.translateY,At,Wt),We(Zt.rotate,zt.rotate,At,Wt),vt(Zt.skewX,zt.skewX,At,Wt),Pt(Zt.scaleX,Zt.scaleY,zt.scaleX,zt.scaleY,At,Wt),Zt=zt=null,function(Bt){for(var Ct=-1,Ze=Wt.length,nt;++Ct<Ze;)At[(nt=Wt[Ct]).i]=nt.x(Bt);return At.join("")}}}var ue=re(Z,"px, ","px)","deg)"),K=re(X,", ",")",")"),te=Math.SQRT2,G=2,Y=4,ee=1e-12;function ne(Te){return((Te=Math.exp(Te))+1/Te)/2}function J(Te){return((Te=Math.exp(Te))-1/Te)/2}function q(Te){return((Te=Math.exp(2*Te))-1)/(Te+1)}function ae(Te,Ce){var He=Te[0],Xe=Te[1],Be=Te[2],Re=Ce[0],We=Ce[1],vt=Ce[2],Pt=Re-He,Zt=We-Xe,zt=Pt*Pt+Zt*Zt,At,Wt;if(zt<ee)Wt=Math.log(vt/Be)/te,At=function(Ee){return[He+Ee*Pt,Xe+Ee*Zt,Be*Math.exp(te*Ee*Wt)]};else{var Bt=Math.sqrt(zt),Ct=(vt*vt-Be*Be+Y*zt)/(2*Be*G*Bt),Ze=(vt*vt-Be*Be-Y*zt)/(2*vt*G*Bt),nt=Math.log(Math.sqrt(Ct*Ct+1)-Ct),Ye=Math.log(Math.sqrt(Ze*Ze+1)-Ze);Wt=(Ye-nt)/te,At=function(Ee){var Ge=Ee*Wt,Je=ne(nt),qe=Be/(G*Bt)*(Je*q(te*Ge+nt)-J(nt));return[He+qe*Pt,Xe+qe*Zt,Be*Je/ne(te*Ge+nt)]}}return At.duration=Wt*1e3,At}function le(Te){return function(Ce,He){var Xe=Te((Ce=u.hsl(Ce)).h,(He=u.hsl(He)).h),Be=o(Ce.s,He.s),Re=o(Ce.l,He.l),We=o(Ce.opacity,He.opacity);return function(vt){return Ce.h=Xe(vt),Ce.s=Be(vt),Ce.l=Re(vt),Ce.opacity=We(vt),Ce+""}}}var ie=le(r),se=le(o);function xe(Te,Ce){var He=o((Te=u.lab(Te)).l,(Ce=u.lab(Ce)).l),Xe=o(Te.a,Ce.a),Be=o(Te.b,Ce.b),Re=o(Te.opacity,Ce.opacity);return function(We){return Te.l=He(We),Te.a=Xe(We),Te.b=Be(We),Te.opacity=Re(We),Te+""}}function oe(Te){return function(Ce,He){var Xe=Te((Ce=u.hcl(Ce)).h,(He=u.hcl(He)).h),Be=o(Ce.c,He.c),Re=o(Ce.l,He.l),We=o(Ce.opacity,He.opacity);return function(vt){return Ce.h=Xe(vt),Ce.c=Be(vt),Ce.l=Re(vt),Ce.opacity=We(vt),Ce+""}}}var he=oe(r),be=oe(o);function me(Te){return function Ce(He){He=+He;function Xe(Be,Re){var We=Te((Be=u.cubehelix(Be)).h,(Re=u.cubehelix(Re)).h),vt=o(Be.s,Re.s),Pt=o(Be.l,Re.l),Zt=o(Be.opacity,Re.opacity);return function(zt){return Be.h=We(zt),Be.s=vt(zt),Be.l=Pt(Math.pow(zt,He)),Be.opacity=Zt(zt),Be+""}}return Xe.gamma=Ce,Xe}(1)}var _e=me(r),Se=me(o);function De(Te,Ce){for(var He=0,Xe=Ce.length-1,Be=Ce[0],Re=new Array(Xe<0?0:Xe);He<Xe;)Re[He]=Te(Be,Be=Ce[++He]);return function(We){var vt=Math.max(0,Math.min(Xe-1,Math.floor(We*=Xe)));return Re[vt](We-vt)}}function Ie(Te,Ce){for(var He=new Array(Ce),Xe=0;Xe<Ce;++Xe)He[Xe]=Te(Xe/(Ce-1));return He}h.interpolate=E,h.interpolateArray=l,h.interpolateBasis=T,h.interpolateBasisClosed=e,h.interpolateCubehelix=_e,h.interpolateCubehelixLong=Se,h.interpolateDate=c,h.interpolateDiscrete=k,h.interpolateHcl=he,h.interpolateHclLong=be,h.interpolateHsl=ie,h.interpolateHslLong=se,h.interpolateHue=B,h.interpolateLab=xe,h.interpolateNumber=M,h.interpolateNumberArray=v,h.interpolateObject=_,h.interpolateRgb=s,h.interpolateRgbBasis=g,h.interpolateRgbBasisClosed=p,h.interpolateRound=z,h.interpolateString=S,h.interpolateTransformCss=ue,h.interpolateTransformSvg=K,h.interpolateZoom=ae,h.piecewise=De,h.quantize=Ie,Object.defineProperty(h,"__esModule",{value:!0})})},{"d3-color":109}],117:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R):(h=h||self,u(h.d3=h.d3||{}))})(this,function(h){var u=Math.PI,A=2*u,T=1e-6,e=A-T;function i(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function n(){return new i}i.prototype=n.prototype={constructor:i,moveTo:function(a,r){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+r)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(a,r){this._+="L"+(this._x1=+a)+","+(this._y1=+r)},quadraticCurveTo:function(a,r,f,o){this._+="Q"+ +a+","+ +r+","+(this._x1=+f)+","+(this._y1=+o)},bezierCurveTo:function(a,r,f,o,s,m){this._+="C"+ +a+","+ +r+","+ +f+","+ +o+","+(this._x1=+s)+","+(this._y1=+m)},arcTo:function(a,r,f,o,s){a=+a,r=+r,f=+f,o=+o,s=+s;var m=this._x1,g=this._y1,p=f-a,v=o-r,x=m-a,l=g-r,b=x*x+l*l;if(s<0)throw new Error("negative radius: "+s);if(this._x1===null)this._+="M"+(this._x1=a)+","+(this._y1=r);else if(b>T)if(!(Math.abs(l*p-v*x)>T)||!s)this._+="L"+(this._x1=a)+","+(this._y1=r);else{var c=f-m,M=o-g,_=p*p+v*v,y=c*c+M*M,w=Math.sqrt(_),d=Math.sqrt(b),C=s*Math.tan((u-Math.acos((_+b-y)/(2*w*d)))/2),S=C/d,E=C/w;Math.abs(S-1)>T&&(this._+="L"+(a+S*x)+","+(r+S*l)),this._+="A"+s+","+s+",0,0,"+ +(l*c>x*M)+","+(this._x1=a+E*p)+","+(this._y1=r+E*v)}},arc:function(a,r,f,o,s,m){a=+a,r=+r,f=+f,m=!!m;var g=f*Math.cos(o),p=f*Math.sin(o),v=a+g,x=r+p,l=1^m,b=m?o-s:s-o;if(f<0)throw new Error("negative radius: "+f);this._x1===null?this._+="M"+v+","+x:(Math.abs(this._x1-v)>T||Math.abs(this._y1-x)>T)&&(this._+="L"+v+","+x),f&&(b<0&&(b=b%A+A),b>e?this._+="A"+f+","+f+",0,1,"+l+","+(a-g)+","+(r-p)+"A"+f+","+f+",0,1,"+l+","+(this._x1=v)+","+(this._y1=x):b>T&&(this._+="A"+f+","+f+",0,"+ +(b>=u)+","+l+","+(this._x1=a+f*Math.cos(s))+","+(this._y1=r+f*Math.sin(s))))},rect:function(a,r,f,o){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+r)+"h"+ +f+"v"+ +o+"h"+-f+"Z"},toString:function(){return this._}},h.path=n,Object.defineProperty(h,"__esModule",{value:!0})})},{}],118:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R):(h=h||self,u(h.d3=h.d3||{}))})(this,function(h){function u(w){var d=+this._x.call(null,w),C=+this._y.call(null,w);return A(this.cover(d,C),d,C,w)}function A(w,d,C,S){if(isNaN(d)||isNaN(C))return w;var E,k=w._root,B={data:S},z=w._x0,F=w._y0,I=w._x1,O=w._y1,N,V,H,j,Z,X,re,ue;if(!k)return w._root=B,w;for(;k.length;)if((Z=d>=(N=(z+I)/2))?z=N:I=N,(X=C>=(V=(F+O)/2))?F=V:O=V,E=k,!(k=k[re=X<<1|Z]))return E[re]=B,w;if(H=+w._x.call(null,k.data),j=+w._y.call(null,k.data),d===H&&C===j)return B.next=k,E?E[re]=B:w._root=B,w;do E=E?E[re]=new Array(4):w._root=new Array(4),(Z=d>=(N=(z+I)/2))?z=N:I=N,(X=C>=(V=(F+O)/2))?F=V:O=V;while((re=X<<1|Z)===(ue=(j>=V)<<1|H>=N));return E[ue]=k,E[re]=B,w}function T(w){var d,C,S=w.length,E,k,B=new Array(S),z=new Array(S),F=1/0,I=1/0,O=-1/0,N=-1/0;for(C=0;C<S;++C)isNaN(E=+this._x.call(null,d=w[C]))||isNaN(k=+this._y.call(null,d))||(B[C]=E,z[C]=k,E<F&&(F=E),E>O&&(O=E),k<I&&(I=k),k>N&&(N=k));if(F>O||I>N)return this;for(this.cover(F,I).cover(O,N),C=0;C<S;++C)A(this,B[C],z[C],w[C]);return this}function e(w,d){if(isNaN(w=+w)||isNaN(d=+d))return this;var C=this._x0,S=this._y0,E=this._x1,k=this._y1;if(isNaN(C))E=(C=Math.floor(w))+1,k=(S=Math.floor(d))+1;else{for(var B=E-C,z=this._root,F,I;C>w||w>=E||S>d||d>=k;)switch(I=(d<S)<<1|w<C,F=new Array(4),F[I]=z,z=F,B*=2,I){case 0:E=C+B,k=S+B;break;case 1:C=E-B,k=S+B;break;case 2:E=C+B,S=k-B;break;case 3:C=E-B,S=k-B;break}this._root&&this._root.length&&(this._root=z)}return this._x0=C,this._y0=S,this._x1=E,this._y1=k,this}function i(){var w=[];return this.visit(function(d){if(!d.length)do w.push(d.data);while(d=d.next)}),w}function n(w){return arguments.length?this.cover(+w[0][0],+w[0][1]).cover(+w[1][0],+w[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function a(w,d,C,S,E){this.node=w,this.x0=d,this.y0=C,this.x1=S,this.y1=E}function r(w,d,C){var S,E=this._x0,k=this._y0,B,z,F,I,O=this._x1,N=this._y1,V=[],H=this._root,j,Z;for(H&&V.push(new a(H,E,k,O,N)),C==null?C=1/0:(E=w-C,k=d-C,O=w+C,N=d+C,C*=C);j=V.pop();)if(!(!(H=j.node)||(B=j.x0)>O||(z=j.y0)>N||(F=j.x1)<E||(I=j.y1)<k))if(H.length){var X=(B+F)/2,re=(z+I)/2;V.push(new a(H[3],X,re,F,I),new a(H[2],B,re,X,I),new a(H[1],X,z,F,re),new a(H[0],B,z,X,re)),(Z=(d>=re)<<1|w>=X)&&(j=V[V.length-1],V[V.length-1]=V[V.length-1-Z],V[V.length-1-Z]=j)}else{var ue=w-+this._x.call(null,H.data),K=d-+this._y.call(null,H.data),te=ue*ue+K*K;if(te<C){var G=Math.sqrt(C=te);E=w-G,k=d-G,O=w+G,N=d+G,S=H.data}}return S}function f(w){if(isNaN(O=+this._x.call(null,w))||isNaN(N=+this._y.call(null,w)))return this;var d,C=this._root,S,E,k,B=this._x0,z=this._y0,F=this._x1,I=this._y1,O,N,V,H,j,Z,X,re;if(!C)return this;if(C.length)for(;;){if((j=O>=(V=(B+F)/2))?B=V:F=V,(Z=N>=(H=(z+I)/2))?z=H:I=H,d=C,!(C=C[X=Z<<1|j]))return this;if(!C.length)break;(d[X+1&3]||d[X+2&3]||d[X+3&3])&&(S=d,re=X)}for(;C.data!==w;)if(E=C,!(C=C.next))return this;return(k=C.next)&&delete C.next,E?(k?E.next=k:delete E.next,this):d?(k?d[X]=k:delete d[X],(C=d[0]||d[1]||d[2]||d[3])&&C===(d[3]||d[2]||d[1]||d[0])&&!C.length&&(S?S[re]=C:this._root=C),this):(this._root=k,this)}function o(w){for(var d=0,C=w.length;d<C;++d)this.remove(w[d]);return this}function s(){return this._root}function m(){var w=0;return this.visit(function(d){if(!d.length)do++w;while(d=d.next)}),w}function g(w){var d=[],C,S=this._root,E,k,B,z,F;for(S&&d.push(new a(S,this._x0,this._y0,this._x1,this._y1));C=d.pop();)if(!w(S=C.node,k=C.x0,B=C.y0,z=C.x1,F=C.y1)&&S.length){var I=(k+z)/2,O=(B+F)/2;(E=S[3])&&d.push(new a(E,I,O,z,F)),(E=S[2])&&d.push(new a(E,k,O,I,F)),(E=S[1])&&d.push(new a(E,I,B,z,O)),(E=S[0])&&d.push(new a(E,k,B,I,O))}return this}function p(w){var d=[],C=[],S;for(this._root&&d.push(new a(this._root,this._x0,this._y0,this._x1,this._y1));S=d.pop();){var E=S.node;if(E.length){var k,B=S.x0,z=S.y0,F=S.x1,I=S.y1,O=(B+F)/2,N=(z+I)/2;(k=E[0])&&d.push(new a(k,B,z,O,N)),(k=E[1])&&d.push(new a(k,O,z,F,N)),(k=E[2])&&d.push(new a(k,B,N,O,I)),(k=E[3])&&d.push(new a(k,O,N,F,I))}C.push(S)}for(;S=C.pop();)w(S.node,S.x0,S.y0,S.x1,S.y1);return this}function v(w){return w[0]}function x(w){return arguments.length?(this._x=w,this):this._x}function l(w){return w[1]}function b(w){return arguments.length?(this._y=w,this):this._y}function c(w,d,C){var S=new M(d==null?v:d,C==null?l:C,NaN,NaN,NaN,NaN);return w==null?S:S.addAll(w)}function M(w,d,C,S,E,k){this._x=w,this._y=d,this._x0=C,this._y0=S,this._x1=E,this._y1=k,this._root=void 0}function _(w){for(var d={data:w.data},C=d;w=w.next;)C=C.next={data:w.data};return d}var y=c.prototype=M.prototype;y.copy=function(){var w=new M(this._x,this._y,this._x0,this._y0,this._x1,this._y1),d=this._root,C,S;if(!d)return w;if(!d.length)return w._root=_(d),w;for(C=[{source:d,target:w._root=new Array(4)}];d=C.pop();)for(var E=0;E<4;++E)(S=d.source[E])&&(S.length?C.push({source:S,target:d.target[E]=new Array(4)}):d.target[E]=_(S));return w},y.add=u,y.addAll=T,y.cover=e,y.data=i,y.extent=n,y.find=r,y.remove=f,y.removeAll=o,y.root=s,y.size=m,y.visit=g,y.visitAfter=p,y.x=x,y.y=b,h.quadtree=c,Object.defineProperty(h,"__esModule",{value:!0})})},{}],119:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R,t("d3-path")):(h=h||self,u(h.d3=h.d3||{},h.d3))})(this,function(h,u){function A(at){return function(){return at}}var T=Math.abs,e=Math.atan2,i=Math.cos,n=Math.max,a=Math.min,r=Math.sin,f=Math.sqrt,o=1e-12,s=Math.PI,m=s/2,g=2*s;function p(at){return at>1?0:at<-1?s:Math.acos(at)}function v(at){return at>=1?m:at<=-1?-m:Math.asin(at)}function x(at){return at.innerRadius}function l(at){return at.outerRadius}function b(at){return at.startAngle}function c(at){return at.endAngle}function M(at){return at&&at.padAngle}function _(at,Ft,jt,sr,zr,Ur,Dr,Tr){var Wr=jt-at,An=sr-Ft,vn=Dr-zr,Un=Tr-Ur,Dn=Un*Wr-vn*An;if(!(Dn*Dn<o))return Dn=(vn*(Ft-Ur)-Un*(at-zr))/Dn,[at+Dn*Wr,Ft+Dn*An]}function y(at,Ft,jt,sr,zr,Ur,Dr){var Tr=at-jt,Wr=Ft-sr,An=(Dr?Ur:-Ur)/f(Tr*Tr+Wr*Wr),vn=An*Wr,Un=-An*Tr,Dn=at+vn,Xn=Ft+Un,Yn=jt+vn,ya=sr+Un,Ca=(Dn+Yn)/2,gi=(Xn+ya)/2,Xa=Yn-Dn,$a=ya-Xn,Ja=Xa*Xa+$a*$a,Mr=zr-Ur,gn=Dn*ya-Yn*Xn,hn=($a<0?-1:1)*f(n(0,Mr*Mr*Ja-gn*gn)),Sn=(gn*$a-Xa*hn)/Ja,Jn=(-gn*Xa-$a*hn)/Ja,ha=(gn*$a+Xa*hn)/Ja,ra=(-gn*Xa+$a*hn)/Ja,In=Sn-Ca,jn=Jn-gi,Ga=ha-Ca,vi=ra-gi;return In*In+jn*jn>Ga*Ga+vi*vi&&(Sn=ha,Jn=ra),{cx:Sn,cy:Jn,x01:-vn,y01:-Un,x11:Sn*(zr/Mr-1),y11:Jn*(zr/Mr-1)}}function w(){var at=x,Ft=l,jt=A(0),sr=null,zr=b,Ur=c,Dr=M,Tr=null;function Wr(){var An,vn,Un=+at.apply(this,arguments),Dn=+Ft.apply(this,arguments),Xn=zr.apply(this,arguments)-m,Yn=Ur.apply(this,arguments)-m,ya=T(Yn-Xn),Ca=Yn>Xn;if(Tr||(Tr=An=u.path()),Dn<Un&&(vn=Dn,Dn=Un,Un=vn),!(Dn>o))Tr.moveTo(0,0);else if(ya>g-o)Tr.moveTo(Dn*i(Xn),Dn*r(Xn)),Tr.arc(0,0,Dn,Xn,Yn,!Ca),Un>o&&(Tr.moveTo(Un*i(Yn),Un*r(Yn)),Tr.arc(0,0,Un,Yn,Xn,Ca));else{var gi=Xn,Xa=Yn,$a=Xn,Ja=Yn,Mr=ya,gn=ya,hn=Dr.apply(this,arguments)/2,Sn=hn>o&&(sr?+sr.apply(this,arguments):f(Un*Un+Dn*Dn)),Jn=a(T(Dn-Un)/2,+jt.apply(this,arguments)),ha=Jn,ra=Jn,In,jn;if(Sn>o){var Ga=v(Sn/Un*r(hn)),vi=v(Sn/Dn*r(hn));(Mr-=Ga*2)>o?(Ga*=Ca?1:-1,$a+=Ga,Ja-=Ga):(Mr=0,$a=Ja=(Xn+Yn)/2),(gn-=vi*2)>o?(vi*=Ca?1:-1,gi+=vi,Xa-=vi):(gn=0,gi=Xa=(Xn+Yn)/2)}var Gt=Dn*i(gi),pr=Dn*r(gi),on=Un*i(Ja),dn=Un*r(Ja);if(Jn>o){var rn=Dn*i(Xa),Mn=Dn*r(Xa),_n=Un*i($a),cn=Un*r($a),mr;if(ya<s&&(mr=_(Gt,pr,_n,cn,rn,Mn,on,dn))){var br=Gt-mr[0],Br=pr-mr[1],mn=rn-mr[0],On=Mn-mr[1],na=1/r(p((br*mn+Br*On)/(f(br*br+Br*Br)*f(mn*mn+On*On)))/2),Tn=f(mr[0]*mr[0]+mr[1]*mr[1]);ha=a(Jn,(Un-Tn)/(na-1)),ra=a(Jn,(Dn-Tn)/(na+1))}}gn>o?ra>o?(In=y(_n,cn,Gt,pr,Dn,ra,Ca),jn=y(rn,Mn,on,dn,Dn,ra,Ca),Tr.moveTo(In.cx+In.x01,In.cy+In.y01),ra<Jn?Tr.arc(In.cx,In.cy,ra,e(In.y01,In.x01),e(jn.y01,jn.x01),!Ca):(Tr.arc(In.cx,In.cy,ra,e(In.y01,In.x01),e(In.y11,In.x11),!Ca),Tr.arc(0,0,Dn,e(In.cy+In.y11,In.cx+In.x11),e(jn.cy+jn.y11,jn.cx+jn.x11),!Ca),Tr.arc(jn.cx,jn.cy,ra,e(jn.y11,jn.x11),e(jn.y01,jn.x01),!Ca))):(Tr.moveTo(Gt,pr),Tr.arc(0,0,Dn,gi,Xa,!Ca)):Tr.moveTo(Gt,pr),!(Un>o)||!(Mr>o)?Tr.lineTo(on,dn):ha>o?(In=y(on,dn,rn,Mn,Un,-ha,Ca),jn=y(Gt,pr,_n,cn,Un,-ha,Ca),Tr.lineTo(In.cx+In.x01,In.cy+In.y01),ha<Jn?Tr.arc(In.cx,In.cy,ha,e(In.y01,In.x01),e(jn.y01,jn.x01),!Ca):(Tr.arc(In.cx,In.cy,ha,e(In.y01,In.x01),e(In.y11,In.x11),!Ca),Tr.arc(0,0,Un,e(In.cy+In.y11,In.cx+In.x11),e(jn.cy+jn.y11,jn.cx+jn.x11),Ca),Tr.arc(jn.cx,jn.cy,ha,e(jn.y11,jn.x11),e(jn.y01,jn.x01),!Ca))):Tr.arc(0,0,Un,Ja,$a,Ca)}if(Tr.closePath(),An)return Tr=null,An+""||null}return Wr.centroid=function(){var An=(+at.apply(this,arguments)+ +Ft.apply(this,arguments))/2,vn=(+zr.apply(this,arguments)+ +Ur.apply(this,arguments))/2-s/2;return[i(vn)*An,r(vn)*An]},Wr.innerRadius=function(An){return arguments.length?(at=typeof An=="function"?An:A(+An),Wr):at},Wr.outerRadius=function(An){return arguments.length?(Ft=typeof An=="function"?An:A(+An),Wr):Ft},Wr.cornerRadius=function(An){return arguments.length?(jt=typeof An=="function"?An:A(+An),Wr):jt},Wr.padRadius=function(An){return arguments.length?(sr=An==null?null:typeof An=="function"?An:A(+An),Wr):sr},Wr.startAngle=function(An){return arguments.length?(zr=typeof An=="function"?An:A(+An),Wr):zr},Wr.endAngle=function(An){return arguments.length?(Ur=typeof An=="function"?An:A(+An),Wr):Ur},Wr.padAngle=function(An){return arguments.length?(Dr=typeof An=="function"?An:A(+An),Wr):Dr},Wr.context=function(An){return arguments.length?(Tr=An==null?null:An,Wr):Tr},Wr}function d(at){this._context=at}d.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(at,Ft){switch(at=+at,Ft=+Ft,this._point){case 0:this._point=1,this._line?this._context.lineTo(at,Ft):this._context.moveTo(at,Ft);break;case 1:this._point=2;default:this._context.lineTo(at,Ft);break}}};function C(at){return new d(at)}function S(at){return at[0]}function E(at){return at[1]}function k(){var at=S,Ft=E,jt=A(!0),sr=null,zr=C,Ur=null;function Dr(Tr){var Wr,An=Tr.length,vn,Un=!1,Dn;for(sr==null&&(Ur=zr(Dn=u.path())),Wr=0;Wr<=An;++Wr)!(Wr<An&&jt(vn=Tr[Wr],Wr,Tr))===Un&&((Un=!Un)?Ur.lineStart():Ur.lineEnd()),Un&&Ur.point(+at(vn,Wr,Tr),+Ft(vn,Wr,Tr));if(Dn)return Ur=null,Dn+""||null}return Dr.x=function(Tr){return arguments.length?(at=typeof Tr=="function"?Tr:A(+Tr),Dr):at},Dr.y=function(Tr){return arguments.length?(Ft=typeof Tr=="function"?Tr:A(+Tr),Dr):Ft},Dr.defined=function(Tr){return arguments.length?(jt=typeof Tr=="function"?Tr:A(!!Tr),Dr):jt},Dr.curve=function(Tr){return arguments.length?(zr=Tr,sr!=null&&(Ur=zr(sr)),Dr):zr},Dr.context=function(Tr){return arguments.length?(Tr==null?sr=Ur=null:Ur=zr(sr=Tr),Dr):sr},Dr}function B(){var at=S,Ft=null,jt=A(0),sr=E,zr=A(!0),Ur=null,Dr=C,Tr=null;function Wr(vn){var Un,Dn,Xn,Yn=vn.length,ya,Ca=!1,gi,Xa=new Array(Yn),$a=new Array(Yn);for(Ur==null&&(Tr=Dr(gi=u.path())),Un=0;Un<=Yn;++Un){if(!(Un<Yn&&zr(ya=vn[Un],Un,vn))===Ca)if(Ca=!Ca)Dn=Un,Tr.areaStart(),Tr.lineStart();else{for(Tr.lineEnd(),Tr.lineStart(),Xn=Un-1;Xn>=Dn;--Xn)Tr.point(Xa[Xn],$a[Xn]);Tr.lineEnd(),Tr.areaEnd()}Ca&&(Xa[Un]=+at(ya,Un,vn),$a[Un]=+jt(ya,Un,vn),Tr.point(Ft?+Ft(ya,Un,vn):Xa[Un],sr?+sr(ya,Un,vn):$a[Un]))}if(gi)return Tr=null,gi+""||null}function An(){return k().defined(zr).curve(Dr).context(Ur)}return Wr.x=function(vn){return arguments.length?(at=typeof vn=="function"?vn:A(+vn),Ft=null,Wr):at},Wr.x0=function(vn){return arguments.length?(at=typeof vn=="function"?vn:A(+vn),Wr):at},Wr.x1=function(vn){return arguments.length?(Ft=vn==null?null:typeof vn=="function"?vn:A(+vn),Wr):Ft},Wr.y=function(vn){return arguments.length?(jt=typeof vn=="function"?vn:A(+vn),sr=null,Wr):jt},Wr.y0=function(vn){return arguments.length?(jt=typeof vn=="function"?vn:A(+vn),Wr):jt},Wr.y1=function(vn){return arguments.length?(sr=vn==null?null:typeof vn=="function"?vn:A(+vn),Wr):sr},Wr.lineX0=Wr.lineY0=function(){return An().x(at).y(jt)},Wr.lineY1=function(){return An().x(at).y(sr)},Wr.lineX1=function(){return An().x(Ft).y(jt)},Wr.defined=function(vn){return arguments.length?(zr=typeof vn=="function"?vn:A(!!vn),Wr):zr},Wr.curve=function(vn){return arguments.length?(Dr=vn,Ur!=null&&(Tr=Dr(Ur)),Wr):Dr},Wr.context=function(vn){return arguments.length?(vn==null?Ur=Tr=null:Tr=Dr(Ur=vn),Wr):Ur},Wr}function z(at,Ft){return Ft<at?-1:Ft>at?1:Ft>=at?0:NaN}function F(at){return at}function I(){var at=F,Ft=z,jt=null,sr=A(0),zr=A(g),Ur=A(0);function Dr(Tr){var Wr,An=Tr.length,vn,Un,Dn=0,Xn=new Array(An),Yn=new Array(An),ya=+sr.apply(this,arguments),Ca=Math.min(g,Math.max(-g,zr.apply(this,arguments)-ya)),gi,Xa=Math.min(Math.abs(Ca)/An,Ur.apply(this,arguments)),$a=Xa*(Ca<0?-1:1),Ja;for(Wr=0;Wr<An;++Wr)(Ja=Yn[Xn[Wr]=Wr]=+at(Tr[Wr],Wr,Tr))>0&&(Dn+=Ja);for(Ft!=null?Xn.sort(function(Mr,gn){return Ft(Yn[Mr],Yn[gn])}):jt!=null&&Xn.sort(function(Mr,gn){return jt(Tr[Mr],Tr[gn])}),Wr=0,Un=Dn?(Ca-An*$a)/Dn:0;Wr<An;++Wr,ya=gi)vn=Xn[Wr],Ja=Yn[vn],gi=ya+(Ja>0?Ja*Un:0)+$a,Yn[vn]={data:Tr[vn],index:Wr,value:Ja,startAngle:ya,endAngle:gi,padAngle:Xa};return Yn}return Dr.value=function(Tr){return arguments.length?(at=typeof Tr=="function"?Tr:A(+Tr),Dr):at},Dr.sortValues=function(Tr){return arguments.length?(Ft=Tr,jt=null,Dr):Ft},Dr.sort=function(Tr){return arguments.length?(jt=Tr,Ft=null,Dr):jt},Dr.startAngle=function(Tr){return arguments.length?(sr=typeof Tr=="function"?Tr:A(+Tr),Dr):sr},Dr.endAngle=function(Tr){return arguments.length?(zr=typeof Tr=="function"?Tr:A(+Tr),Dr):zr},Dr.padAngle=function(Tr){return arguments.length?(Ur=typeof Tr=="function"?Tr:A(+Tr),Dr):Ur},Dr}var O=V(C);function N(at){this._curve=at}N.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(at,Ft){this._curve.point(Ft*Math.sin(at),Ft*-Math.cos(at))}};function V(at){function Ft(jt){return new N(at(jt))}return Ft._curve=at,Ft}function H(at){var Ft=at.curve;return at.angle=at.x,delete at.x,at.radius=at.y,delete at.y,at.curve=function(jt){return arguments.length?Ft(V(jt)):Ft()._curve},at}function j(){return H(k().curve(O))}function Z(){var at=B().curve(O),Ft=at.curve,jt=at.lineX0,sr=at.lineX1,zr=at.lineY0,Ur=at.lineY1;return at.angle=at.x,delete at.x,at.startAngle=at.x0,delete at.x0,at.endAngle=at.x1,delete at.x1,at.radius=at.y,delete at.y,at.innerRadius=at.y0,delete at.y0,at.outerRadius=at.y1,delete at.y1,at.lineStartAngle=function(){return H(jt())},delete at.lineX0,at.lineEndAngle=function(){return H(sr())},delete at.lineX1,at.lineInnerRadius=function(){return H(zr())},delete at.lineY0,at.lineOuterRadius=function(){return H(Ur())},delete at.lineY1,at.curve=function(Dr){return arguments.length?Ft(V(Dr)):Ft()._curve},at}function X(at,Ft){return[(Ft=+Ft)*Math.cos(at-=Math.PI/2),Ft*Math.sin(at)]}var re=Array.prototype.slice;function ue(at){return at.source}function K(at){return at.target}function te(at){var Ft=ue,jt=K,sr=S,zr=E,Ur=null;function Dr(){var Tr,Wr=re.call(arguments),An=Ft.apply(this,Wr),vn=jt.apply(this,Wr);if(Ur||(Ur=Tr=u.path()),at(Ur,+sr.apply(this,(Wr[0]=An,Wr)),+zr.apply(this,Wr),+sr.apply(this,(Wr[0]=vn,Wr)),+zr.apply(this,Wr)),Tr)return Ur=null,Tr+""||null}return Dr.source=function(Tr){return arguments.length?(Ft=Tr,Dr):Ft},Dr.target=function(Tr){return arguments.length?(jt=Tr,Dr):jt},Dr.x=function(Tr){return arguments.length?(sr=typeof Tr=="function"?Tr:A(+Tr),Dr):sr},Dr.y=function(Tr){return arguments.length?(zr=typeof Tr=="function"?Tr:A(+Tr),Dr):zr},Dr.context=function(Tr){return arguments.length?(Ur=Tr==null?null:Tr,Dr):Ur},Dr}function G(at,Ft,jt,sr,zr){at.moveTo(Ft,jt),at.bezierCurveTo(Ft=(Ft+sr)/2,jt,Ft,zr,sr,zr)}function Y(at,Ft,jt,sr,zr){at.moveTo(Ft,jt),at.bezierCurveTo(Ft,jt=(jt+zr)/2,sr,jt,sr,zr)}function ee(at,Ft,jt,sr,zr){var Ur=X(Ft,jt),Dr=X(Ft,jt=(jt+zr)/2),Tr=X(sr,jt),Wr=X(sr,zr);at.moveTo(Ur[0],Ur[1]),at.bezierCurveTo(Dr[0],Dr[1],Tr[0],Tr[1],Wr[0],Wr[1])}function ne(){return te(G)}function J(){return te(Y)}function q(){var at=te(ee);return at.angle=at.x,delete at.x,at.radius=at.y,delete at.y,at}var ae={draw:function(at,Ft){var jt=Math.sqrt(Ft/s);at.moveTo(jt,0),at.arc(0,0,jt,0,g)}},le={draw:function(at,Ft){var jt=Math.sqrt(Ft/5)/2;at.moveTo(-3*jt,-jt),at.lineTo(-jt,-jt),at.lineTo(-jt,-3*jt),at.lineTo(jt,-3*jt),at.lineTo(jt,-jt),at.lineTo(3*jt,-jt),at.lineTo(3*jt,jt),at.lineTo(jt,jt),at.lineTo(jt,3*jt),at.lineTo(-jt,3*jt),at.lineTo(-jt,jt),at.lineTo(-3*jt,jt),at.closePath()}},ie=Math.sqrt(1/3),se=ie*2,xe={draw:function(at,Ft){var jt=Math.sqrt(Ft/se),sr=jt*ie;at.moveTo(0,-jt),at.lineTo(sr,0),at.lineTo(0,jt),at.lineTo(-sr,0),at.closePath()}},oe=.8908130915292852,he=Math.sin(s/10)/Math.sin(7*s/10),be=Math.sin(g/10)*he,me=-Math.cos(g/10)*he,_e={draw:function(at,Ft){var jt=Math.sqrt(Ft*oe),sr=be*jt,zr=me*jt;at.moveTo(0,-jt),at.lineTo(sr,zr);for(var Ur=1;Ur<5;++Ur){var Dr=g*Ur/5,Tr=Math.cos(Dr),Wr=Math.sin(Dr);at.lineTo(Wr*jt,-Tr*jt),at.lineTo(Tr*sr-Wr*zr,Wr*sr+Tr*zr)}at.closePath()}},Se={draw:function(at,Ft){var jt=Math.sqrt(Ft),sr=-jt/2;at.rect(sr,sr,jt,jt)}},De=Math.sqrt(3),Ie={draw:function(at,Ft){var jt=-Math.sqrt(Ft/(De*3));at.moveTo(0,jt*2),at.lineTo(-De*jt,-jt),at.lineTo(De*jt,-jt),at.closePath()}},Te=-.5,Ce=Math.sqrt(3)/2,He=1/Math.sqrt(12),Xe=(He/2+1)*3,Be={draw:function(at,Ft){var jt=Math.sqrt(Ft/Xe),sr=jt/2,zr=jt*He,Ur=sr,Dr=jt*He+jt,Tr=-Ur,Wr=Dr;at.moveTo(sr,zr),at.lineTo(Ur,Dr),at.lineTo(Tr,Wr),at.lineTo(Te*sr-Ce*zr,Ce*sr+Te*zr),at.lineTo(Te*Ur-Ce*Dr,Ce*Ur+Te*Dr),at.lineTo(Te*Tr-Ce*Wr,Ce*Tr+Te*Wr),at.lineTo(Te*sr+Ce*zr,Te*zr-Ce*sr),at.lineTo(Te*Ur+Ce*Dr,Te*Dr-Ce*Ur),at.lineTo(Te*Tr+Ce*Wr,Te*Wr-Ce*Tr),at.closePath()}},Re=[ae,le,xe,Se,_e,Ie,Be];function We(){var at=A(ae),Ft=A(64),jt=null;function sr(){var zr;if(jt||(jt=zr=u.path()),at.apply(this,arguments).draw(jt,+Ft.apply(this,arguments)),zr)return jt=null,zr+""||null}return sr.type=function(zr){return arguments.length?(at=typeof zr=="function"?zr:A(zr),sr):at},sr.size=function(zr){return arguments.length?(Ft=typeof zr=="function"?zr:A(+zr),sr):Ft},sr.context=function(zr){return arguments.length?(jt=zr==null?null:zr,sr):jt},sr}function vt(){}function Pt(at,Ft,jt){at._context.bezierCurveTo((2*at._x0+at._x1)/3,(2*at._y0+at._y1)/3,(at._x0+2*at._x1)/3,(at._y0+2*at._y1)/3,(at._x0+4*at._x1+Ft)/6,(at._y0+4*at._y1+jt)/6)}function Zt(at){this._context=at}Zt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Pt(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(at,Ft){switch(at=+at,Ft=+Ft,this._point){case 0:this._point=1,this._line?this._context.lineTo(at,Ft):this._context.moveTo(at,Ft);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Pt(this,at,Ft);break}this._x0=this._x1,this._x1=at,this._y0=this._y1,this._y1=Ft}};function zt(at){return new Zt(at)}function At(at){this._context=at}At.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(at,Ft){switch(at=+at,Ft=+Ft,this._point){case 0:this._point=1,this._x2=at,this._y2=Ft;break;case 1:this._point=2,this._x3=at,this._y3=Ft;break;case 2:this._point=3,this._x4=at,this._y4=Ft,this._context.moveTo((this._x0+4*this._x1+at)/6,(this._y0+4*this._y1+Ft)/6);break;default:Pt(this,at,Ft);break}this._x0=this._x1,this._x1=at,this._y0=this._y1,this._y1=Ft}};function Wt(at){return new At(at)}function Bt(at){this._context=at}Bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(at,Ft){switch(at=+at,Ft=+Ft,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var jt=(this._x0+4*this._x1+at)/6,sr=(this._y0+4*this._y1+Ft)/6;this._line?this._context.lineTo(jt,sr):this._context.moveTo(jt,sr);break;case 3:this._point=4;default:Pt(this,at,Ft);break}this._x0=this._x1,this._x1=at,this._y0=this._y1,this._y1=Ft}};function Ct(at){return new Bt(at)}function Ze(at,Ft){this._basis=new Zt(at),this._beta=Ft}Ze.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var at=this._x,Ft=this._y,jt=at.length-1;if(jt>0)for(var sr=at[0],zr=Ft[0],Ur=at[jt]-sr,Dr=Ft[jt]-zr,Tr=-1,Wr;++Tr<=jt;)Wr=Tr/jt,this._basis.point(this._beta*at[Tr]+(1-this._beta)*(sr+Wr*Ur),this._beta*Ft[Tr]+(1-this._beta)*(zr+Wr*Dr));this._x=this._y=null,this._basis.lineEnd()},point:function(at,Ft){this._x.push(+at),this._y.push(+Ft)}};var nt=function at(Ft){function jt(sr){return Ft===1?new Zt(sr):new Ze(sr,Ft)}return jt.beta=function(sr){return at(+sr)},jt}(.85);function Ye(at,Ft,jt){at._context.bezierCurveTo(at._x1+at._k*(at._x2-at._x0),at._y1+at._k*(at._y2-at._y0),at._x2+at._k*(at._x1-Ft),at._y2+at._k*(at._y1-jt),at._x2,at._y2)}function Ee(at,Ft){this._context=at,this._k=(1-Ft)/6}Ee.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ye(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(at,Ft){switch(at=+at,Ft=+Ft,this._point){case 0:this._point=1,this._line?this._context.lineTo(at,Ft):this._context.moveTo(at,Ft);break;case 1:this._point=2,this._x1=at,this._y1=Ft;break;case 2:this._point=3;default:Ye(this,at,Ft);break}this._x0=this._x1,this._x1=this._x2,this._x2=at,this._y0=this._y1,this._y1=this._y2,this._y2=Ft}};var Ge=function at(Ft){function jt(sr){return new Ee(sr,Ft)}return jt.tension=function(sr){return at(+sr)},jt}(0);function Je(at,Ft){this._context=at,this._k=(1-Ft)/6}Je.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(at,Ft){switch(at=+at,Ft=+Ft,this._point){case 0:this._point=1,this._x3=at,this._y3=Ft;break;case 1:this._point=2,this._context.moveTo(this._x4=at,this._y4=Ft);break;case 2:this._point=3,this._x5=at,this._y5=Ft;break;default:Ye(this,at,Ft);break}this._x0=this._x1,this._x1=this._x2,this._x2=at,this._y0=this._y1,this._y1=this._y2,this._y2=Ft}};var qe=function at(Ft){function jt(sr){return new Je(sr,Ft)}return jt.tension=function(sr){return at(+sr)},jt}(0);function Tt(at,Ft){this._context=at,this._k=(1-Ft)/6}Tt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(at,Ft){switch(at=+at,Ft=+Ft,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ye(this,at,Ft);break}this._x0=this._x1,this._x1=this._x2,this._x2=at,this._y0=this._y1,this._y1=this._y2,this._y2=Ft}};var mt=function at(Ft){function jt(sr){return new Tt(sr,Ft)}return jt.tension=function(sr){return at(+sr)},jt}(0);function Mt(at,Ft,jt){var sr=at._x1,zr=at._y1,Ur=at._x2,Dr=at._y2;if(at._l01_a>o){var Tr=2*at._l01_2a+3*at._l01_a*at._l12_a+at._l12_2a,Wr=3*at._l01_a*(at._l01_a+at._l12_a);sr=(sr*Tr-at._x0*at._l12_2a+at._x2*at._l01_2a)/Wr,zr=(zr*Tr-at._y0*at._l12_2a+at._y2*at._l01_2a)/Wr}if(at._l23_a>o){var An=2*at._l23_2a+3*at._l23_a*at._l12_a+at._l12_2a,vn=3*at._l23_a*(at._l23_a+at._l12_a);Ur=(Ur*An+at._x1*at._l23_2a-Ft*at._l12_2a)/vn,Dr=(Dr*An+at._y1*at._l23_2a-jt*at._l12_2a)/vn}at._context.bezierCurveTo(sr,zr,Ur,Dr,at._x2,at._y2)}function Ht(at,Ft){this._context=at,this._alpha=Ft}Ht.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(at,Ft){if(at=+at,Ft=+Ft,this._point){var jt=this._x2-at,sr=this._y2-Ft;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(jt*jt+sr*sr,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(at,Ft):this._context.moveTo(at,Ft);break;case 1:this._point=2;break;case 2:this._point=3;default:Mt(this,at,Ft);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=at,this._y0=this._y1,this._y1=this._y2,this._y2=Ft}};var Rt=function at(Ft){function jt(sr){return Ft?new Ht(sr,Ft):new Ee(sr,0)}return jt.alpha=function(sr){return at(+sr)},jt}(.5);function Vt(at,Ft){this._context=at,this._alpha=Ft}Vt.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(at,Ft){if(at=+at,Ft=+Ft,this._point){var jt=this._x2-at,sr=this._y2-Ft;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(jt*jt+sr*sr,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=at,this._y3=Ft;break;case 1:this._point=2,this._context.moveTo(this._x4=at,this._y4=Ft);break;case 2:this._point=3,this._x5=at,this._y5=Ft;break;default:Mt(this,at,Ft);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=at,this._y0=this._y1,this._y1=this._y2,this._y2=Ft}};var Jt=function at(Ft){function jt(sr){return Ft?new Vt(sr,Ft):new Je(sr,0)}return jt.alpha=function(sr){return at(+sr)},jt}(.5);function Yt(at,Ft){this._context=at,this._alpha=Ft}Yt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(at,Ft){if(at=+at,Ft=+Ft,this._point){var jt=this._x2-at,sr=this._y2-Ft;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(jt*jt+sr*sr,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Mt(this,at,Ft);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=at,this._y0=this._y1,this._y1=this._y2,this._y2=Ft}};var or=function at(Ft){function jt(sr){return Ft?new Yt(sr,Ft):new Tt(sr,0)}return jt.alpha=function(sr){return at(+sr)},jt}(.5);function Hr(at){this._context=at}Hr.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(at,Ft){at=+at,Ft=+Ft,this._point?this._context.lineTo(at,Ft):(this._point=1,this._context.moveTo(at,Ft))}};function an(at){return new Hr(at)}function Kr(at){return at<0?-1:1}function ot(at,Ft,jt){var sr=at._x1-at._x0,zr=Ft-at._x1,Ur=(at._y1-at._y0)/(sr||zr<0&&-0),Dr=(jt-at._y1)/(zr||sr<0&&-0),Tr=(Ur*zr+Dr*sr)/(sr+zr);return(Kr(Ur)+Kr(Dr))*Math.min(Math.abs(Ur),Math.abs(Dr),.5*Math.abs(Tr))||0}function er(at,Ft){var jt=at._x1-at._x0;return jt?(3*(at._y1-at._y0)/jt-Ft)/2:Ft}function Kt(at,Ft,jt){var sr=at._x0,zr=at._y0,Ur=at._x1,Dr=at._y1,Tr=(Ur-sr)/3;at._context.bezierCurveTo(sr+Tr,zr+Tr*Ft,Ur-Tr,Dr-Tr*jt,Ur,Dr)}function ur(at){this._context=at}ur.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Kt(this,this._t0,er(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(at,Ft){var jt=NaN;if(at=+at,Ft=+Ft,!(at===this._x1&&Ft===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(at,Ft):this._context.moveTo(at,Ft);break;case 1:this._point=2;break;case 2:this._point=3,Kt(this,er(this,jt=ot(this,at,Ft)),jt);break;default:Kt(this,this._t0,jt=ot(this,at,Ft));break}this._x0=this._x1,this._x1=at,this._y0=this._y1,this._y1=Ft,this._t0=jt}}};function Ar(at){this._context=new et(at)}(Ar.prototype=Object.create(ur.prototype)).point=function(at,Ft){ur.prototype.point.call(this,Ft,at)};function et(at){this._context=at}et.prototype={moveTo:function(at,Ft){this._context.moveTo(Ft,at)},closePath:function(){this._context.closePath()},lineTo:function(at,Ft){this._context.lineTo(Ft,at)},bezierCurveTo:function(at,Ft,jt,sr,zr,Ur){this._context.bezierCurveTo(Ft,at,sr,jt,Ur,zr)}};function $e(at){return new ur(at)}function st(at){return new Ar(at)}function ft(at){this._context=at}ft.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var at=this._x,Ft=this._y,jt=at.length;if(jt)if(this._line?this._context.lineTo(at[0],Ft[0]):this._context.moveTo(at[0],Ft[0]),jt===2)this._context.lineTo(at[1],Ft[1]);else for(var sr=St(at),zr=St(Ft),Ur=0,Dr=1;Dr<jt;++Ur,++Dr)this._context.bezierCurveTo(sr[0][Ur],zr[0][Ur],sr[1][Ur],zr[1][Ur],at[Dr],Ft[Dr]);(this._line||this._line!==0&&jt===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(at,Ft){this._x.push(+at),this._y.push(+Ft)}};function St(at){var Ft,jt=at.length-1,sr,zr=new Array(jt),Ur=new Array(jt),Dr=new Array(jt);for(zr[0]=0,Ur[0]=2,Dr[0]=at[0]+2*at[1],Ft=1;Ft<jt-1;++Ft)zr[Ft]=1,Ur[Ft]=4,Dr[Ft]=4*at[Ft]+2*at[Ft+1];for(zr[jt-1]=2,Ur[jt-1]=7,Dr[jt-1]=8*at[jt-1]+at[jt],Ft=1;Ft<jt;++Ft)sr=zr[Ft]/Ur[Ft-1],Ur[Ft]-=sr,Dr[Ft]-=sr*Dr[Ft-1];for(zr[jt-1]=Dr[jt-1]/Ur[jt-1],Ft=jt-2;Ft>=0;--Ft)zr[Ft]=(Dr[Ft]-zr[Ft+1])/Ur[Ft];for(Ur[jt-1]=(at[jt]+zr[jt-1])/2,Ft=0;Ft<jt-1;++Ft)Ur[Ft]=2*at[Ft+1]-zr[Ft+1];return[zr,Ur]}function Ut(at){return new ft(at)}function Pe(at,Ft){this._context=at,this._t=Ft}Pe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(at,Ft){switch(at=+at,Ft=+Ft,this._point){case 0:this._point=1,this._line?this._context.lineTo(at,Ft):this._context.moveTo(at,Ft);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,Ft),this._context.lineTo(at,Ft);else{var jt=this._x*(1-this._t)+at*this._t;this._context.lineTo(jt,this._y),this._context.lineTo(jt,Ft)}break}}this._x=at,this._y=Ft}};function ke(at){return new Pe(at,.5)}function it(at){return new Pe(at,0)}function ut(at){return new Pe(at,1)}function ht(at,Ft){if((Dr=at.length)>1)for(var jt=1,sr,zr,Ur=at[Ft[0]],Dr,Tr=Ur.length;jt<Dr;++jt)for(zr=Ur,Ur=at[Ft[jt]],sr=0;sr<Tr;++sr)Ur[sr][1]+=Ur[sr][0]=isNaN(zr[sr][1])?zr[sr][0]:zr[sr][1]}function Et(at){for(var Ft=at.length,jt=new Array(Ft);--Ft>=0;)jt[Ft]=Ft;return jt}function yt(at,Ft){return at[Ft]}function Dt(){var at=A([]),Ft=Et,jt=ht,sr=yt;function zr(Ur){var Dr=at.apply(this,arguments),Tr,Wr=Ur.length,An=Dr.length,vn=new Array(An),Un;for(Tr=0;Tr<An;++Tr){for(var Dn=Dr[Tr],Xn=vn[Tr]=new Array(Wr),Yn=0,ya;Yn<Wr;++Yn)Xn[Yn]=ya=[0,+sr(Ur[Yn],Dn,Yn,Ur)],ya.data=Ur[Yn];Xn.key=Dn}for(Tr=0,Un=Ft(vn);Tr<An;++Tr)vn[Un[Tr]].index=Tr;return jt(vn,Un),vn}return zr.keys=function(Ur){return arguments.length?(at=typeof Ur=="function"?Ur:A(re.call(Ur)),zr):at},zr.value=function(Ur){return arguments.length?(sr=typeof Ur=="function"?Ur:A(+Ur),zr):sr},zr.order=function(Ur){return arguments.length?(Ft=Ur==null?Et:typeof Ur=="function"?Ur:A(re.call(Ur)),zr):Ft},zr.offset=function(Ur){return arguments.length?(jt=Ur==null?ht:Ur,zr):jt},zr}function Xt(at,Ft){if((sr=at.length)>0){for(var jt,sr,zr=0,Ur=at[0].length,Dr;zr<Ur;++zr){for(Dr=jt=0;jt<sr;++jt)Dr+=at[jt][zr][1]||0;if(Dr)for(jt=0;jt<sr;++jt)at[jt][zr][1]/=Dr}ht(at,Ft)}}function ar(at,Ft){if((Wr=at.length)>0)for(var jt,sr=0,zr,Ur,Dr,Tr,Wr,An=at[Ft[0]].length;sr<An;++sr)for(Dr=Tr=0,jt=0;jt<Wr;++jt)(Ur=(zr=at[Ft[jt]][sr])[1]-zr[0])>0?(zr[0]=Dr,zr[1]=Dr+=Ur):Ur<0?(zr[1]=Tr,zr[0]=Tr+=Ur):(zr[0]=0,zr[1]=Ur)}function kr(at,Ft){if((zr=at.length)>0){for(var jt=0,sr=at[Ft[0]],zr,Ur=sr.length;jt<Ur;++jt){for(var Dr=0,Tr=0;Dr<zr;++Dr)Tr+=at[Dr][jt][1]||0;sr[jt][1]+=sr[jt][0]=-Tr/2}ht(at,Ft)}}function wr(at,Ft){if(!(!((Dr=at.length)>0)||!((Ur=(zr=at[Ft[0]]).length)>0))){for(var jt=0,sr=1,zr,Ur,Dr;sr<Ur;++sr){for(var Tr=0,Wr=0,An=0;Tr<Dr;++Tr){for(var vn=at[Ft[Tr]],Un=vn[sr][1]||0,Dn=vn[sr-1][1]||0,Xn=(Un-Dn)/2,Yn=0;Yn<Tr;++Yn){var ya=at[Ft[Yn]],Ca=ya[sr][1]||0,gi=ya[sr-1][1]||0;Xn+=Ca-gi}Wr+=Un,An+=Xn*Un}zr[sr-1][1]+=zr[sr-1][0]=jt,Wr&&(jt-=An/Wr)}zr[sr-1][1]+=zr[sr-1][0]=jt,ht(at,Ft)}}function Sr(at){var Ft=at.map(Zr);return Et(at).sort(function(jt,sr){return Ft[jt]-Ft[sr]})}function Zr(at){for(var Ft=-1,jt=0,sr=at.length,zr,Ur=-1/0;++Ft<sr;)(zr=+at[Ft][1])>Ur&&(Ur=zr,jt=Ft);return jt}function ir(at){var Ft=at.map(xr);return Et(at).sort(function(jt,sr){return Ft[jt]-Ft[sr]})}function xr(at){for(var Ft=0,jt=-1,sr=at.length,zr;++jt<sr;)(zr=+at[jt][1])&&(Ft+=zr);return Ft}function Fr(at){return ir(at).reverse()}function Or(at){var Ft=at.length,jt,sr,zr=at.map(xr),Ur=Sr(at),Dr=0,Tr=0,Wr=[],An=[];for(jt=0;jt<Ft;++jt)sr=Ur[jt],Dr<Tr?(Dr+=zr[sr],Wr.push(sr)):(Tr+=zr[sr],An.push(sr));return An.reverse().concat(Wr)}function Cr(at){return Et(at).reverse()}h.arc=w,h.area=B,h.areaRadial=Z,h.curveBasis=zt,h.curveBasisClosed=Wt,h.curveBasisOpen=Ct,h.curveBundle=nt,h.curveCardinal=Ge,h.curveCardinalClosed=qe,h.curveCardinalOpen=mt,h.curveCatmullRom=Rt,h.curveCatmullRomClosed=Jt,h.curveCatmullRomOpen=or,h.curveLinear=C,h.curveLinearClosed=an,h.curveMonotoneX=$e,h.curveMonotoneY=st,h.curveNatural=Ut,h.curveStep=ke,h.curveStepAfter=ut,h.curveStepBefore=it,h.line=k,h.lineRadial=j,h.linkHorizontal=ne,h.linkRadial=q,h.linkVertical=J,h.pie=I,h.pointRadial=X,h.radialArea=Z,h.radialLine=j,h.stack=Dt,h.stackOffsetDiverging=ar,h.stackOffsetExpand=Xt,h.stackOffsetNone=ht,h.stackOffsetSilhouette=kr,h.stackOffsetWiggle=wr,h.stackOrderAppearance=Sr,h.stackOrderAscending=ir,h.stackOrderDescending=Fr,h.stackOrderInsideOut=Or,h.stackOrderNone=Et,h.stackOrderReverse=Cr,h.symbol=We,h.symbolCircle=ae,h.symbolCross=le,h.symbolDiamond=xe,h.symbolSquare=Se,h.symbolStar=_e,h.symbolTriangle=Ie,h.symbolWye=Be,h.symbols=Re,Object.defineProperty(h,"__esModule",{value:!0})})},{"d3-path":117}],120:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R,t("d3-time")):(h=h||self,u(h.d3=h.d3||{},h.d3))})(this,function(h,u){function A(Ze){if(0<=Ze.y&&Ze.y<100){var nt=new Date(-1,Ze.m,Ze.d,Ze.H,Ze.M,Ze.S,Ze.L);return nt.setFullYear(Ze.y),nt}return new Date(Ze.y,Ze.m,Ze.d,Ze.H,Ze.M,Ze.S,Ze.L)}function T(Ze){if(0<=Ze.y&&Ze.y<100){var nt=new Date(Date.UTC(-1,Ze.m,Ze.d,Ze.H,Ze.M,Ze.S,Ze.L));return nt.setUTCFullYear(Ze.y),nt}return new Date(Date.UTC(Ze.y,Ze.m,Ze.d,Ze.H,Ze.M,Ze.S,Ze.L))}function e(Ze,nt,Ye){return{y:Ze,m:nt,d:Ye,H:0,M:0,S:0,L:0}}function i(Ze){var nt=Ze.dateTime,Ye=Ze.date,Ee=Ze.time,Ge=Ze.periods,Je=Ze.days,qe=Ze.shortDays,Tt=Ze.months,mt=Ze.shortMonths,Mt=m(Ge),Ht=g(Ge),Rt=m(Je),Vt=g(Je),Jt=m(qe),Yt=g(qe),or=m(Tt),Hr=g(Tt),an=m(mt),Kr=g(mt),ot={a:ut,A:ht,b:Et,B:yt,c:null,d:N,e:N,f:X,H:V,I:H,j,L:Z,m:re,M:ue,p:Dt,q:Xt,Q:We,s:vt,S:K,u:te,U:G,V:Y,w:ee,W:ne,x:null,X:null,y:J,Y:q,Z:ae,"%":Re},er={a:ar,A:kr,b:wr,B:Sr,c:null,d:le,e:le,f:he,H:ie,I:se,j:xe,L:oe,m:be,M:me,p:Zr,q:ir,Q:We,s:vt,S:_e,u:Se,U:De,V:Ie,w:Te,W:Ce,x:null,X:null,y:He,Y:Xe,Z:Be,"%":Re},Kt={a:st,A:ft,b:St,B:Ut,c:Pe,d,e:d,f:z,H:S,I:S,j:C,L:B,m:w,M:E,p:$e,q:y,Q:I,s:O,S:k,u:v,U:x,V:l,w:p,W:b,x:ke,X:it,y:M,Y:c,Z:_,"%":F};ot.x=ur(Ye,ot),ot.X=ur(Ee,ot),ot.c=ur(nt,ot),er.x=ur(Ye,er),er.X=ur(Ee,er),er.c=ur(nt,er);function ur(xr,Fr){return function(Or){var Cr=[],at=-1,Ft=0,jt=xr.length,sr,zr,Ur;for(Or instanceof Date||(Or=new Date(+Or));++at<jt;)xr.charCodeAt(at)===37&&(Cr.push(xr.slice(Ft,at)),(zr=n[sr=xr.charAt(++at)])!=null?sr=xr.charAt(++at):zr=sr==="e"?" ":"0",(Ur=Fr[sr])&&(sr=Ur(Or,zr)),Cr.push(sr),Ft=at+1);return Cr.push(xr.slice(Ft,at)),Cr.join("")}}function Ar(xr,Fr){return function(Or){var Cr=e(1900,void 0,1),at=et(Cr,xr,Or+="",0),Ft,jt;if(at!=Or.length)return null;if("Q"in Cr)return new Date(Cr.Q);if("s"in Cr)return new Date(Cr.s*1e3+("L"in Cr?Cr.L:0));if(Fr&&!("Z"in Cr)&&(Cr.Z=0),"p"in Cr&&(Cr.H=Cr.H%12+Cr.p*12),Cr.m===void 0&&(Cr.m="q"in Cr?Cr.q:0),"V"in Cr){if(Cr.V<1||Cr.V>53)return null;"w"in Cr||(Cr.w=1),"Z"in Cr?(Ft=T(e(Cr.y,0,1)),jt=Ft.getUTCDay(),Ft=jt>4||jt===0?u.utcMonday.ceil(Ft):u.utcMonday(Ft),Ft=u.utcDay.offset(Ft,(Cr.V-1)*7),Cr.y=Ft.getUTCFullYear(),Cr.m=Ft.getUTCMonth(),Cr.d=Ft.getUTCDate()+(Cr.w+6)%7):(Ft=A(e(Cr.y,0,1)),jt=Ft.getDay(),Ft=jt>4||jt===0?u.timeMonday.ceil(Ft):u.timeMonday(Ft),Ft=u.timeDay.offset(Ft,(Cr.V-1)*7),Cr.y=Ft.getFullYear(),Cr.m=Ft.getMonth(),Cr.d=Ft.getDate()+(Cr.w+6)%7)}else("W"in Cr||"U"in Cr)&&("w"in Cr||(Cr.w="u"in Cr?Cr.u%7:"W"in Cr?1:0),jt="Z"in Cr?T(e(Cr.y,0,1)).getUTCDay():A(e(Cr.y,0,1)).getDay(),Cr.m=0,Cr.d="W"in Cr?(Cr.w+6)%7+Cr.W*7-(jt+5)%7:Cr.w+Cr.U*7-(jt+6)%7);return"Z"in Cr?(Cr.H+=Cr.Z/100|0,Cr.M+=Cr.Z%100,T(Cr)):A(Cr)}}function et(xr,Fr,Or,Cr){for(var at=0,Ft=Fr.length,jt=Or.length,sr,zr;at<Ft;){if(Cr>=jt)return-1;if(sr=Fr.charCodeAt(at++),sr===37){if(sr=Fr.charAt(at++),zr=Kt[sr in n?Fr.charAt(at++):sr],!zr||(Cr=zr(xr,Or,Cr))<0)return-1}else if(sr!=Or.charCodeAt(Cr++))return-1}return Cr}function $e(xr,Fr,Or){var Cr=Mt.exec(Fr.slice(Or));return Cr?(xr.p=Ht[Cr[0].toLowerCase()],Or+Cr[0].length):-1}function st(xr,Fr,Or){var Cr=Jt.exec(Fr.slice(Or));return Cr?(xr.w=Yt[Cr[0].toLowerCase()],Or+Cr[0].length):-1}function ft(xr,Fr,Or){var Cr=Rt.exec(Fr.slice(Or));return Cr?(xr.w=Vt[Cr[0].toLowerCase()],Or+Cr[0].length):-1}function St(xr,Fr,Or){var Cr=an.exec(Fr.slice(Or));return Cr?(xr.m=Kr[Cr[0].toLowerCase()],Or+Cr[0].length):-1}function Ut(xr,Fr,Or){var Cr=or.exec(Fr.slice(Or));return Cr?(xr.m=Hr[Cr[0].toLowerCase()],Or+Cr[0].length):-1}function Pe(xr,Fr,Or){return et(xr,nt,Fr,Or)}function ke(xr,Fr,Or){return et(xr,Ye,Fr,Or)}function it(xr,Fr,Or){return et(xr,Ee,Fr,Or)}function ut(xr){return qe[xr.getDay()]}function ht(xr){return Je[xr.getDay()]}function Et(xr){return mt[xr.getMonth()]}function yt(xr){return Tt[xr.getMonth()]}function Dt(xr){return Ge[+(xr.getHours()>=12)]}function Xt(xr){return 1+~~(xr.getMonth()/3)}function ar(xr){return qe[xr.getUTCDay()]}function kr(xr){return Je[xr.getUTCDay()]}function wr(xr){return mt[xr.getUTCMonth()]}function Sr(xr){return Tt[xr.getUTCMonth()]}function Zr(xr){return Ge[+(xr.getUTCHours()>=12)]}function ir(xr){return 1+~~(xr.getUTCMonth()/3)}return{format:function(xr){var Fr=ur(xr+="",ot);return Fr.toString=function(){return xr},Fr},parse:function(xr){var Fr=Ar(xr+="",!1);return Fr.toString=function(){return xr},Fr},utcFormat:function(xr){var Fr=ur(xr+="",er);return Fr.toString=function(){return xr},Fr},utcParse:function(xr){var Fr=Ar(xr+="",!0);return Fr.toString=function(){return xr},Fr}}}var n={"-":"",_:" ",0:"0"},a=/^\s*\d+/,r=/^%/,f=/[\\^$*+?|[\]().{}]/g;function o(Ze,nt,Ye){var Ee=Ze<0?"-":"",Ge=(Ee?-Ze:Ze)+"",Je=Ge.length;return Ee+(Je<Ye?new Array(Ye-Je+1).join(nt)+Ge:Ge)}function s(Ze){return Ze.replace(f,"\\$&")}function m(Ze){return new RegExp("^(?:"+Ze.map(s).join("|")+")","i")}function g(Ze){for(var nt={},Ye=-1,Ee=Ze.length;++Ye<Ee;)nt[Ze[Ye].toLowerCase()]=Ye;return nt}function p(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+1));return Ee?(Ze.w=+Ee[0],Ye+Ee[0].length):-1}function v(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+1));return Ee?(Ze.u=+Ee[0],Ye+Ee[0].length):-1}function x(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+2));return Ee?(Ze.U=+Ee[0],Ye+Ee[0].length):-1}function l(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+2));return Ee?(Ze.V=+Ee[0],Ye+Ee[0].length):-1}function b(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+2));return Ee?(Ze.W=+Ee[0],Ye+Ee[0].length):-1}function c(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+4));return Ee?(Ze.y=+Ee[0],Ye+Ee[0].length):-1}function M(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+2));return Ee?(Ze.y=+Ee[0]+(+Ee[0]>68?1900:2e3),Ye+Ee[0].length):-1}function _(Ze,nt,Ye){var Ee=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(nt.slice(Ye,Ye+6));return Ee?(Ze.Z=Ee[1]?0:-(Ee[2]+(Ee[3]||"00")),Ye+Ee[0].length):-1}function y(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+1));return Ee?(Ze.q=Ee[0]*3-3,Ye+Ee[0].length):-1}function w(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+2));return Ee?(Ze.m=Ee[0]-1,Ye+Ee[0].length):-1}function d(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+2));return Ee?(Ze.d=+Ee[0],Ye+Ee[0].length):-1}function C(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+3));return Ee?(Ze.m=0,Ze.d=+Ee[0],Ye+Ee[0].length):-1}function S(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+2));return Ee?(Ze.H=+Ee[0],Ye+Ee[0].length):-1}function E(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+2));return Ee?(Ze.M=+Ee[0],Ye+Ee[0].length):-1}function k(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+2));return Ee?(Ze.S=+Ee[0],Ye+Ee[0].length):-1}function B(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+3));return Ee?(Ze.L=+Ee[0],Ye+Ee[0].length):-1}function z(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye,Ye+6));return Ee?(Ze.L=Math.floor(Ee[0]/1e3),Ye+Ee[0].length):-1}function F(Ze,nt,Ye){var Ee=r.exec(nt.slice(Ye,Ye+1));return Ee?Ye+Ee[0].length:-1}function I(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye));return Ee?(Ze.Q=+Ee[0],Ye+Ee[0].length):-1}function O(Ze,nt,Ye){var Ee=a.exec(nt.slice(Ye));return Ee?(Ze.s=+Ee[0],Ye+Ee[0].length):-1}function N(Ze,nt){return o(Ze.getDate(),nt,2)}function V(Ze,nt){return o(Ze.getHours(),nt,2)}function H(Ze,nt){return o(Ze.getHours()%12||12,nt,2)}function j(Ze,nt){return o(1+u.timeDay.count(u.timeYear(Ze),Ze),nt,3)}function Z(Ze,nt){return o(Ze.getMilliseconds(),nt,3)}function X(Ze,nt){return Z(Ze,nt)+"000"}function re(Ze,nt){return o(Ze.getMonth()+1,nt,2)}function ue(Ze,nt){return o(Ze.getMinutes(),nt,2)}function K(Ze,nt){return o(Ze.getSeconds(),nt,2)}function te(Ze){var nt=Ze.getDay();return nt===0?7:nt}function G(Ze,nt){return o(u.timeSunday.count(u.timeYear(Ze)-1,Ze),nt,2)}function Y(Ze,nt){var Ye=Ze.getDay();return Ze=Ye>=4||Ye===0?u.timeThursday(Ze):u.timeThursday.ceil(Ze),o(u.timeThursday.count(u.timeYear(Ze),Ze)+(u.timeYear(Ze).getDay()===4),nt,2)}function ee(Ze){return Ze.getDay()}function ne(Ze,nt){return o(u.timeMonday.count(u.timeYear(Ze)-1,Ze),nt,2)}function J(Ze,nt){return o(Ze.getFullYear()%100,nt,2)}function q(Ze,nt){return o(Ze.getFullYear()%1e4,nt,4)}function ae(Ze){var nt=Ze.getTimezoneOffset();return(nt>0?"-":(nt*=-1,"+"))+o(nt/60|0,"0",2)+o(nt%60,"0",2)}function le(Ze,nt){return o(Ze.getUTCDate(),nt,2)}function ie(Ze,nt){return o(Ze.getUTCHours(),nt,2)}function se(Ze,nt){return o(Ze.getUTCHours()%12||12,nt,2)}function xe(Ze,nt){return o(1+u.utcDay.count(u.utcYear(Ze),Ze),nt,3)}function oe(Ze,nt){return o(Ze.getUTCMilliseconds(),nt,3)}function he(Ze,nt){return oe(Ze,nt)+"000"}function be(Ze,nt){return o(Ze.getUTCMonth()+1,nt,2)}function me(Ze,nt){return o(Ze.getUTCMinutes(),nt,2)}function _e(Ze,nt){return o(Ze.getUTCSeconds(),nt,2)}function Se(Ze){var nt=Ze.getUTCDay();return nt===0?7:nt}function De(Ze,nt){return o(u.utcSunday.count(u.utcYear(Ze)-1,Ze),nt,2)}function Ie(Ze,nt){var Ye=Ze.getUTCDay();return Ze=Ye>=4||Ye===0?u.utcThursday(Ze):u.utcThursday.ceil(Ze),o(u.utcThursday.count(u.utcYear(Ze),Ze)+(u.utcYear(Ze).getUTCDay()===4),nt,2)}function Te(Ze){return Ze.getUTCDay()}function Ce(Ze,nt){return o(u.utcMonday.count(u.utcYear(Ze)-1,Ze),nt,2)}function He(Ze,nt){return o(Ze.getUTCFullYear()%100,nt,2)}function Xe(Ze,nt){return o(Ze.getUTCFullYear()%1e4,nt,4)}function Be(){return"+0000"}function Re(){return"%"}function We(Ze){return+Ze}function vt(Ze){return Math.floor(+Ze/1e3)}var Pt;Zt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Zt(Ze){return Pt=i(Ze),h.timeFormat=Pt.format,h.timeParse=Pt.parse,h.utcFormat=Pt.utcFormat,h.utcParse=Pt.utcParse,Pt}var zt="%Y-%m-%dT%H:%M:%S.%LZ";function At(Ze){return Ze.toISOString()}var Wt=Date.prototype.toISOString?At:h.utcFormat(zt);function Bt(Ze){var nt=new Date(Ze);return isNaN(nt)?null:nt}var Ct=+new Date("2000-01-01T00:00:00.000Z")?Bt:h.utcParse(zt);h.isoFormat=Wt,h.isoParse=Ct,h.timeFormatDefaultLocale=Zt,h.timeFormatLocale=i,Object.defineProperty(h,"__esModule",{value:!0})})},{"d3-time":121}],121:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R):(h=h||self,u(h.d3=h.d3||{}))})(this,function(h){var u=new Date,A=new Date;function T(Te,Ce,He,Xe){function Be(Re){return Te(Re=arguments.length===0?new Date:new Date(+Re)),Re}return Be.floor=function(Re){return Te(Re=new Date(+Re)),Re},Be.ceil=function(Re){return Te(Re=new Date(Re-1)),Ce(Re,1),Te(Re),Re},Be.round=function(Re){var We=Be(Re),vt=Be.ceil(Re);return Re-We<vt-Re?We:vt},Be.offset=function(Re,We){return Ce(Re=new Date(+Re),We==null?1:Math.floor(We)),Re},Be.range=function(Re,We,vt){var Pt=[],Zt;if(Re=Be.ceil(Re),vt=vt==null?1:Math.floor(vt),!(Re<We)||!(vt>0))return Pt;do Pt.push(Zt=new Date(+Re)),Ce(Re,vt),Te(Re);while(Zt<Re&&Re<We);return Pt},Be.filter=function(Re){return T(function(We){if(We>=We)for(;Te(We),!Re(We);)We.setTime(We-1)},function(We,vt){if(We>=We)if(vt<0)for(;++vt<=0;)for(;Ce(We,-1),!Re(We););else for(;--vt>=0;)for(;Ce(We,1),!Re(We););})},He&&(Be.count=function(Re,We){return u.setTime(+Re),A.setTime(+We),Te(u),Te(A),Math.floor(He(u,A))},Be.every=function(Re){return Re=Math.floor(Re),!isFinite(Re)||!(Re>0)?null:Re>1?Be.filter(Xe?function(We){return Xe(We)%Re===0}:function(We){return Be.count(0,We)%Re===0}):Be}),Be}var e=T(function(){},function(Te,Ce){Te.setTime(+Te+Ce)},function(Te,Ce){return Ce-Te});e.every=function(Te){return Te=Math.floor(Te),!isFinite(Te)||!(Te>0)?null:Te>1?T(function(Ce){Ce.setTime(Math.floor(Ce/Te)*Te)},function(Ce,He){Ce.setTime(+Ce+He*Te)},function(Ce,He){return(He-Ce)/Te}):e};var i=e.range,n=1e3,a=6e4,r=36e5,f=864e5,o=6048e5,s=T(function(Te){Te.setTime(Te-Te.getMilliseconds())},function(Te,Ce){Te.setTime(+Te+Ce*n)},function(Te,Ce){return(Ce-Te)/n},function(Te){return Te.getUTCSeconds()}),m=s.range,g=T(function(Te){Te.setTime(Te-Te.getMilliseconds()-Te.getSeconds()*n)},function(Te,Ce){Te.setTime(+Te+Ce*a)},function(Te,Ce){return(Ce-Te)/a},function(Te){return Te.getMinutes()}),p=g.range,v=T(function(Te){Te.setTime(Te-Te.getMilliseconds()-Te.getSeconds()*n-Te.getMinutes()*a)},function(Te,Ce){Te.setTime(+Te+Ce*r)},function(Te,Ce){return(Ce-Te)/r},function(Te){return Te.getHours()}),x=v.range,l=T(function(Te){Te.setHours(0,0,0,0)},function(Te,Ce){Te.setDate(Te.getDate()+Ce)},function(Te,Ce){return(Ce-Te-(Ce.getTimezoneOffset()-Te.getTimezoneOffset())*a)/f},function(Te){return Te.getDate()-1}),b=l.range;function c(Te){return T(function(Ce){Ce.setDate(Ce.getDate()-(Ce.getDay()+7-Te)%7),Ce.setHours(0,0,0,0)},function(Ce,He){Ce.setDate(Ce.getDate()+He*7)},function(Ce,He){return(He-Ce-(He.getTimezoneOffset()-Ce.getTimezoneOffset())*a)/o})}var M=c(0),_=c(1),y=c(2),w=c(3),d=c(4),C=c(5),S=c(6),E=M.range,k=_.range,B=y.range,z=w.range,F=d.range,I=C.range,O=S.range,N=T(function(Te){Te.setDate(1),Te.setHours(0,0,0,0)},function(Te,Ce){Te.setMonth(Te.getMonth()+Ce)},function(Te,Ce){return Ce.getMonth()-Te.getMonth()+(Ce.getFullYear()-Te.getFullYear())*12},function(Te){return Te.getMonth()}),V=N.range,H=T(function(Te){Te.setMonth(0,1),Te.setHours(0,0,0,0)},function(Te,Ce){Te.setFullYear(Te.getFullYear()+Ce)},function(Te,Ce){return Ce.getFullYear()-Te.getFullYear()},function(Te){return Te.getFullYear()});H.every=function(Te){return!isFinite(Te=Math.floor(Te))||!(Te>0)?null:T(function(Ce){Ce.setFullYear(Math.floor(Ce.getFullYear()/Te)*Te),Ce.setMonth(0,1),Ce.setHours(0,0,0,0)},function(Ce,He){Ce.setFullYear(Ce.getFullYear()+He*Te)})};var j=H.range,Z=T(function(Te){Te.setUTCSeconds(0,0)},function(Te,Ce){Te.setTime(+Te+Ce*a)},function(Te,Ce){return(Ce-Te)/a},function(Te){return Te.getUTCMinutes()}),X=Z.range,re=T(function(Te){Te.setUTCMinutes(0,0,0)},function(Te,Ce){Te.setTime(+Te+Ce*r)},function(Te,Ce){return(Ce-Te)/r},function(Te){return Te.getUTCHours()}),ue=re.range,K=T(function(Te){Te.setUTCHours(0,0,0,0)},function(Te,Ce){Te.setUTCDate(Te.getUTCDate()+Ce)},function(Te,Ce){return(Ce-Te)/f},function(Te){return Te.getUTCDate()-1}),te=K.range;function G(Te){return T(function(Ce){Ce.setUTCDate(Ce.getUTCDate()-(Ce.getUTCDay()+7-Te)%7),Ce.setUTCHours(0,0,0,0)},function(Ce,He){Ce.setUTCDate(Ce.getUTCDate()+He*7)},function(Ce,He){return(He-Ce)/o})}var Y=G(0),ee=G(1),ne=G(2),J=G(3),q=G(4),ae=G(5),le=G(6),ie=Y.range,se=ee.range,xe=ne.range,oe=J.range,he=q.range,be=ae.range,me=le.range,_e=T(function(Te){Te.setUTCDate(1),Te.setUTCHours(0,0,0,0)},function(Te,Ce){Te.setUTCMonth(Te.getUTCMonth()+Ce)},function(Te,Ce){return Ce.getUTCMonth()-Te.getUTCMonth()+(Ce.getUTCFullYear()-Te.getUTCFullYear())*12},function(Te){return Te.getUTCMonth()}),Se=_e.range,De=T(function(Te){Te.setUTCMonth(0,1),Te.setUTCHours(0,0,0,0)},function(Te,Ce){Te.setUTCFullYear(Te.getUTCFullYear()+Ce)},function(Te,Ce){return Ce.getUTCFullYear()-Te.getUTCFullYear()},function(Te){return Te.getUTCFullYear()});De.every=function(Te){return!isFinite(Te=Math.floor(Te))||!(Te>0)?null:T(function(Ce){Ce.setUTCFullYear(Math.floor(Ce.getUTCFullYear()/Te)*Te),Ce.setUTCMonth(0,1),Ce.setUTCHours(0,0,0,0)},function(Ce,He){Ce.setUTCFullYear(Ce.getUTCFullYear()+He*Te)})};var Ie=De.range;h.timeDay=l,h.timeDays=b,h.timeFriday=C,h.timeFridays=I,h.timeHour=v,h.timeHours=x,h.timeInterval=T,h.timeMillisecond=e,h.timeMilliseconds=i,h.timeMinute=g,h.timeMinutes=p,h.timeMonday=_,h.timeMondays=k,h.timeMonth=N,h.timeMonths=V,h.timeSaturday=S,h.timeSaturdays=O,h.timeSecond=s,h.timeSeconds=m,h.timeSunday=M,h.timeSundays=E,h.timeThursday=d,h.timeThursdays=F,h.timeTuesday=y,h.timeTuesdays=B,h.timeWednesday=w,h.timeWednesdays=z,h.timeWeek=M,h.timeWeeks=E,h.timeYear=H,h.timeYears=j,h.utcDay=K,h.utcDays=te,h.utcFriday=ae,h.utcFridays=be,h.utcHour=re,h.utcHours=ue,h.utcMillisecond=e,h.utcMilliseconds=i,h.utcMinute=Z,h.utcMinutes=X,h.utcMonday=ee,h.utcMondays=se,h.utcMonth=_e,h.utcMonths=Se,h.utcSaturday=le,h.utcSaturdays=me,h.utcSecond=s,h.utcSeconds=m,h.utcSunday=Y,h.utcSundays=ie,h.utcThursday=q,h.utcThursdays=he,h.utcTuesday=ne,h.utcTuesdays=xe,h.utcWednesday=J,h.utcWednesdays=oe,h.utcWeek=Y,h.utcWeeks=ie,h.utcYear=De,h.utcYears=Ie,Object.defineProperty(h,"__esModule",{value:!0})})},{}],122:[function(t,P,R){arguments[4][121][0].apply(R,arguments)},{dup:121}],123:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R):(h=h||self,u(h.d3=h.d3||{}))})(this,function(h){var u=0,A=0,T=0,e=1e3,i,n,a=0,r=0,f=0,o=typeof performance=="object"&&performance.now?performance:Date,s=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(w){setTimeout(w,17)};function m(){return r||(s(g),r=o.now()+f)}function g(){r=0}function p(){this._call=this._time=this._next=null}p.prototype=v.prototype={constructor:p,restart:function(w,d,C){if(typeof w!="function")throw new TypeError("callback is not a function");C=(C==null?m():+C)+(d==null?0:+d),!this._next&&n!==this&&(n?n._next=this:i=this,n=this),this._call=w,this._time=C,M()},stop:function(){this._call&&(this._call=null,this._time=1/0,M())}};function v(w,d,C){var S=new p;return S.restart(w,d,C),S}function x(){m(),++u;for(var w=i,d;w;)(d=r-w._time)>=0&&w._call.call(null,d),w=w._next;--u}function l(){r=(a=o.now())+f,u=A=0;try{x()}finally{u=0,c(),r=0}}function b(){var w=o.now(),d=w-a;d>e&&(f-=d,a=w)}function c(){for(var w,d=i,C,S=1/0;d;)d._call?(S>d._time&&(S=d._time),w=d,d=d._next):(C=d._next,d._next=null,d=w?w._next=C:i=C);n=w,M(S)}function M(w){if(!u){A&&(A=clearTimeout(A));var d=w-r;d>24?(w<1/0&&(A=setTimeout(l,w-o.now()-f)),T&&(T=clearInterval(T))):(T||(a=o.now(),T=setInterval(b,e)),u=1,s(l))}}function _(w,d,C){var S=new p;return d=d==null?0:+d,S.restart(function(E){S.stop(),w(E+d)},d,C),S}function y(w,d,C){var S=new p,E=d;return d==null?(S.restart(w,d,C),S):(d=+d,C=C==null?m():+C,S.restart(function k(B){B+=E,S.restart(k,E+=d,C),w(B)},d,C),S)}h.interval=y,h.now=m,h.timeout=_,h.timer=v,h.timerFlush=x,Object.defineProperty(h,"__esModule",{value:!0})})},{}],124:[function(t,P,R){P.exports=function(){for(var h=0;h<arguments.length;h++)if(arguments[h]!==void 0)return arguments[h]}},{}],125:[function(t,P,R){P.exports=T;var h=T.canvas=document.createElement("canvas"),u=h.getContext("2d"),A=e([32,126]);T.createPairs=e,T.ascii=A;function T(i,n){Array.isArray(i)&&(i=i.join(", "));var a={},r,f=16,o=.05;n&&(n.length===2&&typeof n[0]=="number"?r=e(n):Array.isArray(n)?r=n:(n.o?r=e(n.o):n.pairs&&(r=n.pairs),n.fontSize&&(f=n.fontSize),n.threshold!=null&&(o=n.threshold))),r||(r=A),u.font=f+"px "+i;for(var s=0;s<r.length;s++){var m=r[s],g=u.measureText(m[0]).width+u.measureText(m[1]).width,p=u.measureText(m).width;if(Math.abs(g-p)>f*o){var v=(p-g)/f;a[m]=v*1e3}}return a}function e(i){for(var n=[],a=i[0];a<=i[1];a++)for(var r=String.fromCharCode(a),f=i[0];f<i[1];f++){var o=String.fromCharCode(f),s=r+o;n.push(s)}return n}},{}],126:[function(t,P,R){var h=t("abs-svg-path"),u=t("normalize-svg-path"),A={M:"moveTo",C:"bezierCurveTo"};P.exports=function(T,e){T.beginPath(),u(h(e)).forEach(function(i){var n=i[0],a=i.slice(1);T[A[n]].apply(T,a)}),T.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(t,P,R){P.exports=function(h){switch(h){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(t,P,R){function h(T,e,i){var n=T[i]|0;if(n<=0)return[];var a=new Array(n),r;if(i===T.length-1)for(r=0;r<n;++r)a[r]=e;else for(r=0;r<n;++r)a[r]=h(T,e,i+1);return a}function u(T,e){var i,n;for(i=new Array(T),n=0;n<T;++n)i[n]=e;return i}function A(T,e){switch(typeof e>"u"&&(e=0),typeof T){case"number":if(T>0)return u(T|0,e);break;case"object":if(typeof T.length=="number")return h(T,e,0);break}return[]}P.exports=A},{}],129:[function(t,P,R){P.exports=h,P.exports.default=h;function h(I,O,N){N=N||2;var V=O&&O.length,H=V?O[0]*N:I.length,j=u(I,0,H,N,!0),Z=[];if(!j||j.next===j.prev)return Z;var X,re,ue,K,te,G,Y;if(V&&(j=r(I,O,j,N)),I.length>80*N){X=ue=I[0],re=K=I[1];for(var ee=N;ee<H;ee+=N)te=I[ee],G=I[ee+1],te<X&&(X=te),G<re&&(re=G),te>ue&&(ue=te),G>K&&(K=G);Y=Math.max(ue-X,K-re),Y=Y!==0?1/Y:0}return T(j,Z,N,X,re,Y),Z}function u(I,O,N,V,H){var j,Z;if(H===F(I,O,N,V)>0)for(j=O;j<N;j+=V)Z=k(j,I[j],I[j+1],Z);else for(j=N-V;j>=O;j-=V)Z=k(j,I[j],I[j+1],Z);return Z&&M(Z,Z.next)&&(B(Z),Z=Z.next),Z}function A(I,O){if(!I)return I;O||(O=I);var N=I,V;do if(V=!1,!N.steiner&&(M(N,N.next)||c(N.prev,N,N.next)===0)){if(B(N),N=O=N.prev,N===N.next)break;V=!0}else N=N.next;while(V||N!==O);return O}function T(I,O,N,V,H,j,Z){if(!!I){!Z&&j&&g(I,V,H,j);for(var X=I,re,ue;I.prev!==I.next;){if(re=I.prev,ue=I.next,j?i(I,V,H,j):e(I)){O.push(re.i/N),O.push(I.i/N),O.push(ue.i/N),B(I),I=ue.next,X=ue.next;continue}if(I=ue,I===X){Z?Z===1?(I=n(A(I),O,N),T(I,O,N,V,H,j,2)):Z===2&&a(I,O,N,V,H,j):T(A(I),O,N,V,H,j,1);break}}}}function e(I){var O=I.prev,N=I,V=I.next;if(c(O,N,V)>=0)return!1;for(var H=I.next.next;H!==I.prev;){if(l(O.x,O.y,N.x,N.y,V.x,V.y,H.x,H.y)&&c(H.prev,H,H.next)>=0)return!1;H=H.next}return!0}function i(I,O,N,V){var H=I.prev,j=I,Z=I.next;if(c(H,j,Z)>=0)return!1;for(var X=H.x<j.x?H.x<Z.x?H.x:Z.x:j.x<Z.x?j.x:Z.x,re=H.y<j.y?H.y<Z.y?H.y:Z.y:j.y<Z.y?j.y:Z.y,ue=H.x>j.x?H.x>Z.x?H.x:Z.x:j.x>Z.x?j.x:Z.x,K=H.y>j.y?H.y>Z.y?H.y:Z.y:j.y>Z.y?j.y:Z.y,te=v(X,re,O,N,V),G=v(ue,K,O,N,V),Y=I.prevZ,ee=I.nextZ;Y&&Y.z>=te&&ee&&ee.z<=G;){if(Y!==I.prev&&Y!==I.next&&l(H.x,H.y,j.x,j.y,Z.x,Z.y,Y.x,Y.y)&&c(Y.prev,Y,Y.next)>=0||(Y=Y.prevZ,ee!==I.prev&&ee!==I.next&&l(H.x,H.y,j.x,j.y,Z.x,Z.y,ee.x,ee.y)&&c(ee.prev,ee,ee.next)>=0))return!1;ee=ee.nextZ}for(;Y&&Y.z>=te;){if(Y!==I.prev&&Y!==I.next&&l(H.x,H.y,j.x,j.y,Z.x,Z.y,Y.x,Y.y)&&c(Y.prev,Y,Y.next)>=0)return!1;Y=Y.prevZ}for(;ee&&ee.z<=G;){if(ee!==I.prev&&ee!==I.next&&l(H.x,H.y,j.x,j.y,Z.x,Z.y,ee.x,ee.y)&&c(ee.prev,ee,ee.next)>=0)return!1;ee=ee.nextZ}return!0}function n(I,O,N){var V=I;do{var H=V.prev,j=V.next.next;!M(H,j)&&_(H,V,V.next,j)&&C(H,j)&&C(j,H)&&(O.push(H.i/N),O.push(V.i/N),O.push(j.i/N),B(V),B(V.next),V=I=j),V=V.next}while(V!==I);return A(V)}function a(I,O,N,V,H,j){var Z=I;do{for(var X=Z.next.next;X!==Z.prev;){if(Z.i!==X.i&&b(Z,X)){var re=E(Z,X);Z=A(Z,Z.next),re=A(re,re.next),T(Z,O,N,V,H,j),T(re,O,N,V,H,j);return}X=X.next}Z=Z.next}while(Z!==I)}function r(I,O,N,V){var H=[],j,Z,X,re,ue;for(j=0,Z=O.length;j<Z;j++)X=O[j]*V,re=j<Z-1?O[j+1]*V:I.length,ue=u(I,X,re,V,!1),ue===ue.next&&(ue.steiner=!0),H.push(x(ue));for(H.sort(f),j=0;j<H.length;j++)o(H[j],N),N=A(N,N.next);return N}function f(I,O){return I.x-O.x}function o(I,O){if(O=s(I,O),O){var N=E(O,I);A(O,O.next),A(N,N.next)}}function s(I,O){var N=O,V=I.x,H=I.y,j=-1/0,Z;do{if(H<=N.y&&H>=N.next.y&&N.next.y!==N.y){var X=N.x+(H-N.y)*(N.next.x-N.x)/(N.next.y-N.y);if(X<=V&&X>j){if(j=X,X===V){if(H===N.y)return N;if(H===N.next.y)return N.next}Z=N.x<N.next.x?N:N.next}}N=N.next}while(N!==O);if(!Z)return null;if(V===j)return Z;var re=Z,ue=Z.x,K=Z.y,te=1/0,G;N=Z;do V>=N.x&&N.x>=ue&&V!==N.x&&l(H<K?V:j,H,ue,K,H<K?j:V,H,N.x,N.y)&&(G=Math.abs(H-N.y)/(V-N.x),C(N,I)&&(G<te||G===te&&(N.x>Z.x||N.x===Z.x&&m(Z,N)))&&(Z=N,te=G)),N=N.next;while(N!==re);return Z}function m(I,O){return c(I.prev,I,O.prev)<0&&c(O.next,I,I.next)<0}function g(I,O,N,V){var H=I;do H.z===null&&(H.z=v(H.x,H.y,O,N,V)),H.prevZ=H.prev,H.nextZ=H.next,H=H.next;while(H!==I);H.prevZ.nextZ=null,H.prevZ=null,p(H)}function p(I){var O,N,V,H,j,Z,X,re,ue=1;do{for(N=I,I=null,j=null,Z=0;N;){for(Z++,V=N,X=0,O=0;O<ue&&(X++,V=V.nextZ,!!V);O++);for(re=ue;X>0||re>0&&V;)X!==0&&(re===0||!V||N.z<=V.z)?(H=N,N=N.nextZ,X--):(H=V,V=V.nextZ,re--),j?j.nextZ=H:I=H,H.prevZ=j,j=H;N=V}j.nextZ=null,ue*=2}while(Z>1);return I}function v(I,O,N,V,H){return I=32767*(I-N)*H,O=32767*(O-V)*H,I=(I|I<<8)&16711935,I=(I|I<<4)&252645135,I=(I|I<<2)&858993459,I=(I|I<<1)&1431655765,O=(O|O<<8)&16711935,O=(O|O<<4)&252645135,O=(O|O<<2)&858993459,O=(O|O<<1)&1431655765,I|O<<1}function x(I){var O=I,N=I;do(O.x<N.x||O.x===N.x&&O.y<N.y)&&(N=O),O=O.next;while(O!==I);return N}function l(I,O,N,V,H,j,Z,X){return(H-Z)*(O-X)-(I-Z)*(j-X)>=0&&(I-Z)*(V-X)-(N-Z)*(O-X)>=0&&(N-Z)*(j-X)-(H-Z)*(V-X)>=0}function b(I,O){return I.next.i!==O.i&&I.prev.i!==O.i&&!d(I,O)&&(C(I,O)&&C(O,I)&&S(I,O)&&(c(I.prev,I,O.prev)||c(I,O.prev,O))||M(I,O)&&c(I.prev,I,I.next)>0&&c(O.prev,O,O.next)>0)}function c(I,O,N){return(O.y-I.y)*(N.x-O.x)-(O.x-I.x)*(N.y-O.y)}function M(I,O){return I.x===O.x&&I.y===O.y}function _(I,O,N,V){var H=w(c(I,O,N)),j=w(c(I,O,V)),Z=w(c(N,V,I)),X=w(c(N,V,O));return!!(H!==j&&Z!==X||H===0&&y(I,N,O)||j===0&&y(I,V,O)||Z===0&&y(N,I,V)||X===0&&y(N,O,V))}function y(I,O,N){return O.x<=Math.max(I.x,N.x)&&O.x>=Math.min(I.x,N.x)&&O.y<=Math.max(I.y,N.y)&&O.y>=Math.min(I.y,N.y)}function w(I){return I>0?1:I<0?-1:0}function d(I,O){var N=I;do{if(N.i!==I.i&&N.next.i!==I.i&&N.i!==O.i&&N.next.i!==O.i&&_(N,N.next,I,O))return!0;N=N.next}while(N!==I);return!1}function C(I,O){return c(I.prev,I,I.next)<0?c(I,O,I.next)>=0&&c(I,I.prev,O)>=0:c(I,O,I.prev)<0||c(I,I.next,O)<0}function S(I,O){var N=I,V=!1,H=(I.x+O.x)/2,j=(I.y+O.y)/2;do N.y>j!=N.next.y>j&&N.next.y!==N.y&&H<(N.next.x-N.x)*(j-N.y)/(N.next.y-N.y)+N.x&&(V=!V),N=N.next;while(N!==I);return V}function E(I,O){var N=new z(I.i,I.x,I.y),V=new z(O.i,O.x,O.y),H=I.next,j=O.prev;return I.next=O,O.prev=I,N.next=H,H.prev=N,V.next=N,N.prev=V,j.next=V,V.prev=j,V}function k(I,O,N,V){var H=new z(I,O,N);return V?(H.next=V.next,H.prev=V,V.next.prev=H,V.next=H):(H.prev=H,H.next=H),H}function B(I){I.next.prev=I.prev,I.prev.next=I.next,I.prevZ&&(I.prevZ.nextZ=I.nextZ),I.nextZ&&(I.nextZ.prevZ=I.prevZ)}function z(I,O,N){this.i=I,this.x=O,this.y=N,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}h.deviation=function(I,O,N,V){var H=O&&O.length,j=H?O[0]*N:I.length,Z=Math.abs(F(I,0,j,N));if(H)for(var X=0,re=O.length;X<re;X++){var ue=O[X]*N,K=X<re-1?O[X+1]*N:I.length;Z-=Math.abs(F(I,ue,K,N))}var te=0;for(X=0;X<V.length;X+=3){var G=V[X]*N,Y=V[X+1]*N,ee=V[X+2]*N;te+=Math.abs((I[G]-I[ee])*(I[Y+1]-I[G+1])-(I[G]-I[Y])*(I[ee+1]-I[G+1]))}return Z===0&&te===0?0:Math.abs((te-Z)/Z)};function F(I,O,N,V){for(var H=0,j=O,Z=N-V;j<N;j+=V)H+=(I[Z]-I[j])*(I[j+1]+I[Z+1]),Z=j;return H}h.flatten=function(I){for(var O=I[0][0].length,N={vertices:[],holes:[],dimensions:O},V=0,H=0;H<I.length;H++){for(var j=0;j<I[H].length;j++)for(var Z=0;Z<O;Z++)N.vertices.push(I[H][j][Z]);H>0&&(V+=I[H-1].length,N.holes.push(V))}return N}},{}],130:[function(t,P,R){var h=t("strongly-connected-components");P.exports=function(A,T){var e=[],i=[],n=[],a={},r=[],f;function o(M){n[M]=!1,a.hasOwnProperty(M)&&Object.keys(a[M]).forEach(function(_){delete a[M][_],n[_]&&o(_)})}function s(M){var _=!1;i.push(M),n[M]=!0;var y,w;for(y=0;y<r[M].length;y++)w=r[M][y],w===f?(m(f,i),_=!0):n[w]||(_=s(w));if(_)o(M);else for(y=0;y<r[M].length;y++){w=r[M][y];var d=a[w];d||(d={},a[w]=d),d[w]=!0}return i.pop(),_}function m(M,_){var y=[].concat(_).concat(M);T?T(s):e.push(y)}function g(M){for(var _=0;_<A.length;_++)_<M&&(A[_]=[]),A[_]=A[_].filter(function(y){return y>=M})}function p(M){g(M);for(var _=A,y=h(_),w=y.components.filter(function(z){return z.length>1}),d=1/0,C,S=0;S<w.length;S++)for(var E=0;E<w[S].length;E++)w[S][E]<d&&(d=w[S][E],C=S);var k=w[C];if(!k)return!1;var B=A.map(function(z,F){return k.indexOf(F)===-1?[]:z.filter(function(I){return k.indexOf(I)!==-1})});return{leastVertex:d,adjList:B}}f=0;for(var v=A.length;f<v;){var x=p(f);if(f=x.leastVertex,r=x.adjList,r){for(var l=0;l<r.length;l++)for(var b=0;b<r[l].length;b++){var c=r[l][b];n[+c]=!1,a[c]={}}s(f),f=f+1}else f=v}if(!T)return e}},{"strongly-connected-components":307}],131:[function(t,P,R){var h=t("../../object/valid-value");P.exports=function(){return h(this).length=0,this}},{"../../object/valid-value":162}],132:[function(t,P,R){P.exports=t("./is-implemented")()?Array.from:t("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(t,P,R){P.exports=function(){var h=Array.from,u,A;return typeof h!="function"?!1:(u=["raz","dwa"],A=h(u),Boolean(A&&A!==u&&A[1]==="dwa"))}},{}],134:[function(t,P,R){var h=t("es6-symbol").iterator,u=t("../../function/is-arguments"),A=t("../../function/is-function"),T=t("../../number/to-pos-integer"),e=t("../../object/valid-callable"),i=t("../../object/valid-value"),n=t("../../object/is-value"),a=t("../../string/is-string"),r=Array.isArray,f=Function.prototype.call,o={configurable:!0,enumerable:!0,writable:!0,value:null},s=Object.defineProperty;P.exports=function(m){var g=arguments[1],p=arguments[2],v,x,l,b,c,M,_,y,w,d;if(m=Object(i(m)),n(g)&&e(g),!this||this===Array||!A(this)){if(!g){if(u(m))return c=m.length,c!==1?Array.apply(null,m):(b=new Array(1),b[0]=m[0],b);if(r(m)){for(b=new Array(c=m.length),x=0;x<c;++x)b[x]=m[x];return b}}b=[]}else v=this;if(!r(m)){if((w=m[h])!==void 0){for(_=e(w).call(m),v&&(b=new v),y=_.next(),x=0;!y.done;)d=g?f.call(g,p,y.value,x):y.value,v?(o.value=d,s(b,x,o)):b[x]=d,y=_.next(),++x;c=x}else if(a(m)){for(c=m.length,v&&(b=new v),x=0,l=0;x<c;++x)d=m[x],x+1<c&&(M=d.charCodeAt(0),M>=55296&&M<=56319&&(d+=m[++x])),d=g?f.call(g,p,d,l):d,v?(o.value=d,s(b,l,o)):b[l]=d,++l;c=l}}if(c===void 0)for(c=T(m.length),v&&(b=new v(c)),x=0;x<c;++x)d=g?f.call(g,p,m[x],x):m[x],v?(o.value=d,s(b,x,o)):b[x]=d;return v&&(o.value=null,b.length=c),b}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(t,P,R){var h=Object.prototype.toString,u=h.call(function(){return arguments}());P.exports=function(A){return h.call(A)===u}},{}],136:[function(t,P,R){var h=Object.prototype.toString,u=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);P.exports=function(A){return typeof A=="function"&&u(h.call(A))}},{}],137:[function(t,P,R){P.exports=function(){}},{}],138:[function(t,P,R){P.exports=t("./is-implemented")()?Math.sign:t("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(t,P,R){P.exports=function(){var h=Math.sign;return typeof h!="function"?!1:h(10)===1&&h(-20)===-1}},{}],140:[function(t,P,R){P.exports=function(h){return h=Number(h),isNaN(h)||h===0?h:h>0?1:-1}},{}],141:[function(t,P,R){var h=t("../math/sign"),u=Math.abs,A=Math.floor;P.exports=function(T){return isNaN(T)?0:(T=Number(T),T===0||!isFinite(T)?T:h(T)*A(u(T)))}},{"../math/sign":138}],142:[function(t,P,R){var h=t("./to-integer"),u=Math.max;P.exports=function(A){return u(0,h(A))}},{"./to-integer":141}],143:[function(t,P,R){var h=t("./valid-callable"),u=t("./valid-value"),A=Function.prototype.bind,T=Function.prototype.call,e=Object.keys,i=Object.prototype.propertyIsEnumerable;P.exports=function(n,a){return function(r,f){var o,s=arguments[2],m=arguments[3];return r=Object(u(r)),h(f),o=e(r),m&&o.sort(typeof m=="function"?A.call(m,r):void 0),typeof n!="function"&&(n=o[n]),T.call(n,o,function(g,p){return i.call(r,g)?T.call(f,s,r[g],g,r,p):a})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(t,P,R){P.exports=t("./is-implemented")()?Object.assign:t("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(t,P,R){P.exports=function(){var h=Object.assign,u;return typeof h!="function"?!1:(u={foo:"raz"},h(u,{bar:"dwa"},{trzy:"trzy"}),u.foo+u.bar+u.trzy==="razdwatrzy")}},{}],146:[function(t,P,R){var h=t("../keys"),u=t("../valid-value"),A=Math.max;P.exports=function(T,e){var i,n,a=A(arguments.length,2),r;for(T=Object(u(T)),r=function(f){try{T[f]=e[f]}catch(o){i||(i=o)}},n=1;n<a;++n)e=arguments[n],h(e).forEach(r);if(i!==void 0)throw i;return T}},{"../keys":152,"../valid-value":162}],147:[function(t,P,R){var h=t("../array/from"),u=t("./assign"),A=t("./valid-value");P.exports=function(T){var e=Object(A(T)),i=arguments[1],n=Object(arguments[2]);if(e!==T&&!i)return e;var a={};return i?h(i,function(r){(n.ensure||r in T)&&(a[r]=T[r])}):u(a,T),a}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(t,P,R){var h=Object.create,u;t("./set-prototype-of/is-implemented")()||(u=t("./set-prototype-of/shim")),P.exports=function(){var A,T,e;return!u||u.level!==1?h:(A={},T={},e={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(i){if(i==="__proto__"){T[i]={configurable:!0,enumerable:!1,writable:!0,value:void 0};return}T[i]=e}),Object.defineProperties(A,T),Object.defineProperty(u,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:A}),function(i,n){return h(i===null?A:i,n)})}()},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(t,P,R){P.exports=t("./_iterate")("forEach")},{"./_iterate":143}],150:[function(t,P,R){var h=t("./is-value"),u={function:!0,object:!0};P.exports=function(A){return h(A)&&u[typeof A]||!1}},{"./is-value":151}],151:[function(t,P,R){var h=t("../function/noop")();P.exports=function(u){return u!==h&&u!==null}},{"../function/noop":137}],152:[function(t,P,R){P.exports=t("./is-implemented")()?Object.keys:t("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(t,P,R){P.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},{}],154:[function(t,P,R){var h=t("../is-value"),u=Object.keys;P.exports=function(A){return u(h(A)?Object(A):A)}},{"../is-value":151}],155:[function(t,P,R){var h=t("./valid-callable"),u=t("./for-each"),A=Function.prototype.call;P.exports=function(T,e){var i={},n=arguments[2];return h(e),u(T,function(a,r,f,o){i[r]=A.call(e,n,a,r,f,o)}),i}},{"./for-each":149,"./valid-callable":160}],156:[function(t,P,R){var h=t("./is-value"),u=Array.prototype.forEach,A=Object.create,T=function(e,i){var n;for(n in e)i[n]=e[n]};P.exports=function(e){var i=A(null);return u.call(arguments,function(n){!h(n)||T(Object(n),i)}),i}},{"./is-value":151}],157:[function(t,P,R){P.exports=t("./is-implemented")()?Object.setPrototypeOf:t("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(t,P,R){var h=Object.create,u=Object.getPrototypeOf,A={};P.exports=function(){var T=Object.setPrototypeOf,e=arguments[0]||h;return typeof T!="function"?!1:u(T(e(null),A))===A}},{}],159:[function(t,P,R){var h=t("../is-object"),u=t("../valid-value"),A=Object.prototype.isPrototypeOf,T=Object.defineProperty,e={configurable:!0,enumerable:!1,writable:!0,value:void 0},i;i=function(n,a){if(u(n),a===null||h(a))return n;throw new TypeError("Prototype must be null or an object")},P.exports=function(n){var a,r;return n?(n.level===2?n.set?(r=n.set,a=function(f,o){return r.call(i(f,o),o),f}):a=function(f,o){return i(f,o).__proto__=o,f}:a=function f(o,s){var m;return i(o,s),m=A.call(f.nullPolyfill,o),m&&delete f.nullPolyfill.__proto__,s===null&&(s=f.nullPolyfill),o.__proto__=s,m&&T(f.nullPolyfill,"__proto__",e),o},Object.defineProperty(a,"level",{configurable:!1,enumerable:!1,writable:!1,value:n.level})):null}(function(){var n=Object.create(null),a={},r,f=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(f){try{r=f.set,r.call(n,a)}catch{}if(Object.getPrototypeOf(n)===a)return{set:r,level:2}}return n.__proto__=a,Object.getPrototypeOf(n)===a?{level:2}:(n={},n.__proto__=a,Object.getPrototypeOf(n)===a?{level:1}:!1)}()),t("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(t,P,R){P.exports=function(h){if(typeof h!="function")throw new TypeError(h+" is not a function");return h}},{}],161:[function(t,P,R){var h=t("./is-object");P.exports=function(u){if(!h(u))throw new TypeError(u+" is not an Object");return u}},{"./is-object":150}],162:[function(t,P,R){var h=t("./is-value");P.exports=function(u){if(!h(u))throw new TypeError("Cannot use null or undefined");return u}},{"./is-value":151}],163:[function(t,P,R){P.exports=t("./is-implemented")()?String.prototype.contains:t("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(t,P,R){var h="razdwatrzy";P.exports=function(){return typeof h.contains!="function"?!1:h.contains("dwa")===!0&&h.contains("foo")===!1}},{}],165:[function(t,P,R){var h=String.prototype.indexOf;P.exports=function(u){return h.call(this,u,arguments[1])>-1}},{}],166:[function(t,P,R){var h=Object.prototype.toString,u=h.call("");P.exports=function(A){return typeof A=="string"||A&&typeof A=="object"&&(A instanceof String||h.call(A)===u)||!1}},{}],167:[function(t,P,R){var h=Object.create(null),u=Math.random;P.exports=function(){var A;do A=u().toString(36).slice(2);while(h[A]);return A}},{}],168:[function(t,P,R){var h=t("es5-ext/object/set-prototype-of"),u=t("es5-ext/string/#/contains"),A=t("d"),T=t("es6-symbol"),e=t("./"),i=Object.defineProperty,n;n=P.exports=function(a,r){if(!(this instanceof n))throw new TypeError("Constructor requires 'new'");e.call(this,a),r?u.call(r,"key+value")?r="key+value":u.call(r,"key")?r="key":r="value":r="value",i(this,"__kind__",A("",r))},h&&h(n,e),delete n.prototype.constructor,n.prototype=Object.create(e.prototype,{_resolve:A(function(a){return this.__kind__==="value"?this.__list__[a]:this.__kind__==="key+value"?[a,this.__list__[a]]:a})}),i(n.prototype,T.toStringTag,A("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(t,P,R){var h=t("es5-ext/function/is-arguments"),u=t("es5-ext/object/valid-callable"),A=t("es5-ext/string/is-string"),T=t("./get"),e=Array.isArray,i=Function.prototype.call,n=Array.prototype.some;P.exports=function(a,r){var f,o=arguments[2],s,m,g,p,v,x,l;if(e(a)||h(a)?f="array":A(a)?f="string":a=T(a),u(r),m=function(){g=!0},f==="array"){n.call(a,function(b){return i.call(r,o,b,m),g});return}if(f==="string"){for(v=a.length,p=0;p<v&&(x=a[p],p+1<v&&(l=x.charCodeAt(0),l>=55296&&l<=56319&&(x+=a[++p])),i.call(r,o,x,m),!g);++p);return}for(s=a.next();!s.done;){if(i.call(r,o,s.value,m),g)return;s=a.next()}}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(t,P,R){var h=t("es5-ext/function/is-arguments"),u=t("es5-ext/string/is-string"),A=t("./array"),T=t("./string"),e=t("./valid-iterable"),i=t("es6-symbol").iterator;P.exports=function(n){return typeof e(n)[i]=="function"?n[i]():h(n)?new A(n):u(n)?new T(n):new A(n)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(t,P,R){var h=t("es5-ext/array/#/clear"),u=t("es5-ext/object/assign"),A=t("es5-ext/object/valid-callable"),T=t("es5-ext/object/valid-value"),e=t("d"),i=t("d/auto-bind"),n=t("es6-symbol"),a=Object.defineProperty,r=Object.defineProperties,f;P.exports=f=function(o,s){if(!(this instanceof f))throw new TypeError("Constructor requires 'new'");r(this,{__list__:e("w",T(o)),__context__:e("w",s),__nextIndex__:e("w",0)}),s&&(A(s.on),s.on("_add",this._onAdd),s.on("_delete",this._onDelete),s.on("_clear",this._onClear))},delete f.prototype.constructor,r(f.prototype,u({_next:e(function(){var o;if(!!this.__list__){if(this.__redo__&&(o=this.__redo__.shift(),o!==void 0))return o;if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind()}}),next:e(function(){return this._createResult(this._next())}),_createResult:e(function(o){return o===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(o)}}),_resolve:e(function(o){return this.__list__[o]}),_unBind:e(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:e(function(){return"[object "+(this[n.toStringTag]||"Object")+"]"})},i({_onAdd:e(function(o){if(!(o>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__){a(this,"__redo__",e("c",[o]));return}this.__redo__.forEach(function(s,m){s>=o&&(this.__redo__[m]=++s)},this),this.__redo__.push(o)}}),_onDelete:e(function(o){var s;o>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(s=this.__redo__.indexOf(o),s!==-1&&this.__redo__.splice(s,1),this.__redo__.forEach(function(m,g){m>o&&(this.__redo__[g]=--m)},this)))}),_onClear:e(function(){this.__redo__&&h.call(this.__redo__),this.__nextIndex__=0})}))),a(f.prototype,n.iterator,e(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(t,P,R){var h=t("es5-ext/function/is-arguments"),u=t("es5-ext/object/is-value"),A=t("es5-ext/string/is-string"),T=t("es6-symbol").iterator,e=Array.isArray;P.exports=function(i){return u(i)?e(i)||A(i)||h(i)?!0:typeof i[T]=="function":!1}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(t,P,R){var h=t("es5-ext/object/set-prototype-of"),u=t("d"),A=t("es6-symbol"),T=t("./"),e=Object.defineProperty,i;i=P.exports=function(n){if(!(this instanceof i))throw new TypeError("Constructor requires 'new'");n=String(n),T.call(this,n),e(this,"__length__",u("",n.length))},h&&h(i,T),delete i.prototype.constructor,i.prototype=Object.create(T.prototype,{_next:u(function(){if(!!this.__list__){if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind()}}),_resolve:u(function(n){var a=this.__list__[n],r;return this.__nextIndex__===this.__length__?a:(r=a.charCodeAt(0),r>=55296&&r<=56319?a+this.__list__[this.__nextIndex__++]:a)})}),e(i.prototype,A.toStringTag,u("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(t,P,R){var h=t("./is-iterable");P.exports=function(u){if(!h(u))throw new TypeError(u+" is not iterable");return u}},{"./is-iterable":172}],175:[function(t,P,R){P.exports=t("./is-implemented")()?t("ext/global-this").Symbol:t("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(t,P,R){var h=t("ext/global-this"),u={object:!0,symbol:!0};P.exports=function(){var A=h.Symbol,T;if(typeof A!="function")return!1;T=A("test symbol");try{String(T)}catch{return!1}return!(!u[typeof A.iterator]||!u[typeof A.toPrimitive]||!u[typeof A.toStringTag])}},{"ext/global-this":188}],177:[function(t,P,R){P.exports=function(h){return h?typeof h=="symbol"?!0:!h.constructor||h.constructor.name!=="Symbol"?!1:h[h.constructor.toStringTag]==="Symbol":!1}},{}],178:[function(t,P,R){var h=t("d"),u=Object.create,A=Object.defineProperty,T=Object.prototype,e=u(null);P.exports=function(i){for(var n=0,a,r;e[i+(n||"")];)++n;return i+=n||"",e[i]=!0,a="@@"+i,A(T,a,h.gs(null,function(f){r||(r=!0,A(this,a,h(f)),r=!1)})),a}},{d:106}],179:[function(t,P,R){var h=t("d"),u=t("ext/global-this").Symbol;P.exports=function(A){return Object.defineProperties(A,{hasInstance:h("",u&&u.hasInstance||A("hasInstance")),isConcatSpreadable:h("",u&&u.isConcatSpreadable||A("isConcatSpreadable")),iterator:h("",u&&u.iterator||A("iterator")),match:h("",u&&u.match||A("match")),replace:h("",u&&u.replace||A("replace")),search:h("",u&&u.search||A("search")),species:h("",u&&u.species||A("species")),split:h("",u&&u.split||A("split")),toPrimitive:h("",u&&u.toPrimitive||A("toPrimitive")),toStringTag:h("",u&&u.toStringTag||A("toStringTag")),unscopables:h("",u&&u.unscopables||A("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(t,P,R){var h=t("d"),u=t("../../../validate-symbol"),A=Object.create(null);P.exports=function(T){return Object.defineProperties(T,{for:h(function(e){return A[e]?A[e]:A[e]=T(String(e))}),keyFor:h(function(e){var i;u(e);for(i in A)if(A[i]===e)return i})})}},{"../../../validate-symbol":182,d:106}],181:[function(t,P,R){var h=t("d"),u=t("./validate-symbol"),A=t("ext/global-this").Symbol,T=t("./lib/private/generate-name"),e=t("./lib/private/setup/standard-symbols"),i=t("./lib/private/setup/symbol-registry"),n=Object.create,a=Object.defineProperties,r=Object.defineProperty,f,o,s;if(typeof A=="function")try{String(A()),s=!0}catch{}else A=null;o=function(g){if(this instanceof o)throw new TypeError("Symbol is not a constructor");return f(g)},P.exports=f=function m(g){var p;if(this instanceof m)throw new TypeError("Symbol is not a constructor");return s?A(g):(p=n(o.prototype),g=g===void 0?"":String(g),a(p,{__description__:h("",g),__name__:h("",T(g))}))},e(f),i(f),a(o.prototype,{constructor:h(f),toString:h("",function(){return this.__name__})}),a(f.prototype,{toString:h(function(){return"Symbol ("+u(this).__description__+")"}),valueOf:h(function(){return u(this)})}),r(f.prototype,f.toPrimitive,h("",function(){var m=u(this);return typeof m=="symbol"?m:m.toString()})),r(f.prototype,f.toStringTag,h("c","Symbol")),r(o.prototype,f.toStringTag,h("c",f.prototype[f.toStringTag])),r(o.prototype,f.toPrimitive,h("c",f.prototype[f.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(t,P,R){var h=t("./is-symbol");P.exports=function(u){if(!h(u))throw new TypeError(u+" is not a symbol");return u}},{"./is-symbol":177}],183:[function(t,P,R){P.exports=t("./is-implemented")()?WeakMap:t("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(t,P,R){P.exports=function(){var h,u;if(typeof WeakMap!="function")return!1;try{h=new WeakMap([[u={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return!(String(h)!=="[object WeakMap]"||typeof h.set!="function"||h.set({},1)!==h||typeof h.delete!="function"||typeof h.has!="function"||h.get(u)!=="one")}},{}],185:[function(t,P,R){P.exports=function(){return typeof WeakMap!="function"?!1:Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"}()},{}],186:[function(t,P,R){var h=t("es5-ext/object/is-value"),u=t("es5-ext/object/set-prototype-of"),A=t("es5-ext/object/valid-object"),T=t("es5-ext/object/valid-value"),e=t("es5-ext/string/random-uniq"),i=t("d"),n=t("es6-iterator/get"),a=t("es6-iterator/for-of"),r=t("es6-symbol").toStringTag,f=t("./is-native-implemented"),o=Array.isArray,s=Object.defineProperty,m=Object.prototype.hasOwnProperty,g=Object.getPrototypeOf,p;P.exports=p=function(){var v=arguments[0],x;if(!(this instanceof p))throw new TypeError("Constructor requires 'new'");return x=f&&u&&WeakMap!==p?u(new WeakMap,g(this)):this,h(v)&&(o(v)||(v=n(v))),s(x,"__weakMapData__",i("c","$weakMap$"+e())),v&&a(v,function(l){T(l),x.set(l[0],l[1])}),x},f&&(u&&u(p,WeakMap),p.prototype=Object.create(WeakMap.prototype,{constructor:i(p)})),Object.defineProperties(p.prototype,{delete:i(function(v){return m.call(A(v),this.__weakMapData__)?(delete v[this.__weakMapData__],!0):!1}),get:i(function(v){if(!!m.call(A(v),this.__weakMapData__))return v[this.__weakMapData__]}),has:i(function(v){return m.call(A(v),this.__weakMapData__)}),set:i(function(v,x){return s(A(v),this.__weakMapData__,i("c",x)),this}),toString:i(function(){return"[object WeakMap]"})}),s(p.prototype,r,i("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(t,P,R){var h=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};P.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return h()}try{return __global__||h()}finally{delete Object.prototype.__global__}}()},{}],188:[function(t,P,R){P.exports=t("./is-implemented")()?globalThis:t("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(t,P,R){P.exports=function(){return typeof globalThis!="object"||!globalThis?!1:globalThis.Array===Array}},{}],190:[function(t,P,R){var h=t("is-string-blank");P.exports=function(u){var A=typeof u;if(A==="string"){var T=u;if(u=+u,u===0&&h(T))return!1}else if(A!=="number")return!1;return u-u<1}},{"is-string-blank":237}],191:[function(t,P,R){var h=t("dtype");P.exports=u;function u(A,T,e){if(!A)throw new TypeError("must specify data as first parameter");if(e=+(e||0)|0,Array.isArray(A)&&A[0]&&typeof A[0][0]=="number"){var i=A[0].length,n=A.length*i,a,r,f,o;(!T||typeof T=="string")&&(T=new(h(T||"float32"))(n+e));var s=T.length-e;if(n!==s)throw new Error("source length "+n+" ("+i+"x"+A.length+") does not match destination length "+s);for(a=0,f=e;a<A.length;a++)for(r=0;r<i;r++)T[f++]=A[a][r]===null?NaN:A[a][r]}else if(!T||typeof T=="string"){var m=h(T||"float32");if(Array.isArray(A)||T==="array")for(T=new m(A.length+e),a=0,f=e,o=T.length;f<o;f++,a++)T[f]=A[a]===null?NaN:A[a];else e===0?T=new m(A):(T=new m(A.length+e),T.set(A,e))}else T.set(A,e);return T}},{dtype:127}],192:[function(t,P,R){var h=t("css-font/stringify"),u=[32,126];P.exports=A;function A(T){T=T||{};var e=T.shape?T.shape:T.canvas?[T.canvas.width,T.canvas.height]:[512,512],i=T.canvas||document.createElement("canvas"),n=T.font,a=typeof T.step=="number"?[T.step,T.step]:T.step||[32,32],r=T.chars||u;if(n&&typeof n!="string"&&(n=h(n)),!Array.isArray(r))r=String(r).split("");else if(r.length===2&&typeof r[0]=="number"&&typeof r[1]=="number"){for(var f=[],o=r[0],s=0;o<=r[1];o++)f[s++]=String.fromCharCode(o);r=f}e=e.slice(),i.width=e[0],i.height=e[1];var m=i.getContext("2d");m.fillStyle="#000",m.fillRect(0,0,i.width,i.height),m.font=n,m.textAlign="center",m.textBaseline="middle",m.fillStyle="#fff";for(var g=a[0]/2,p=a[1]/2,o=0;o<r.length;o++)m.fillText(r[o],g,p),(g+=a[0])>e[0]-a[0]/2&&(g=a[0]/2,p+=a[1]);return i}},{"css-font/stringify":102}],193:[function(t,P,R){P.exports=h,h.canvas=document.createElement("canvas"),h.cache={};function h(o,i){i||(i={}),(typeof o=="string"||Array.isArray(o))&&(i.family=o);var n=Array.isArray(i.family)?i.family.join(", "):i.family;if(!n)throw Error("`family` must be defined");var a=i.size||i.fontSize||i.em||48,r=i.weight||i.fontWeight||"",f=i.style||i.fontStyle||"",o=[f,r,a].join(" ")+"px "+n,s=i.origin||"top";if(h.cache[n]&&a<=h.cache[n].em)return u(h.cache[n],s);var m=i.canvas||h.canvas,g=m.getContext("2d"),p={upper:i.upper!==void 0?i.upper:"H",lower:i.lower!==void 0?i.lower:"x",descent:i.descent!==void 0?i.descent:"p",ascent:i.ascent!==void 0?i.ascent:"h",tittle:i.tittle!==void 0?i.tittle:"i",overshoot:i.overshoot!==void 0?i.overshoot:"O"},v=Math.ceil(a*1.5);m.height=v,m.width=v*.5,g.font=o;var x="H",l={top:0};g.clearRect(0,0,v,v),g.textBaseline="top",g.fillStyle="black",g.fillText(x,0,0);var b=A(g.getImageData(0,0,v,v));g.clearRect(0,0,v,v),g.textBaseline="bottom",g.fillText(x,0,v);var c=A(g.getImageData(0,0,v,v));l.lineHeight=l.bottom=v-c+b,g.clearRect(0,0,v,v),g.textBaseline="alphabetic",g.fillText(x,0,v);var M=A(g.getImageData(0,0,v,v)),_=v-M-1+b;l.baseline=l.alphabetic=_,g.clearRect(0,0,v,v),g.textBaseline="middle",g.fillText(x,0,v*.5);var y=A(g.getImageData(0,0,v,v));l.median=l.middle=v-y-1+b-v*.5,g.clearRect(0,0,v,v),g.textBaseline="hanging",g.fillText(x,0,v*.5);var w=A(g.getImageData(0,0,v,v));l.hanging=v-w-1+b-v*.5,g.clearRect(0,0,v,v),g.textBaseline="ideographic",g.fillText(x,0,v);var d=A(g.getImageData(0,0,v,v));if(l.ideographic=v-d-1+b,p.upper&&(g.clearRect(0,0,v,v),g.textBaseline="top",g.fillText(p.upper,0,0),l.upper=A(g.getImageData(0,0,v,v)),l.capHeight=l.baseline-l.upper),p.lower&&(g.clearRect(0,0,v,v),g.textBaseline="top",g.fillText(p.lower,0,0),l.lower=A(g.getImageData(0,0,v,v)),l.xHeight=l.baseline-l.lower),p.tittle&&(g.clearRect(0,0,v,v),g.textBaseline="top",g.fillText(p.tittle,0,0),l.tittle=A(g.getImageData(0,0,v,v))),p.ascent&&(g.clearRect(0,0,v,v),g.textBaseline="top",g.fillText(p.ascent,0,0),l.ascent=A(g.getImageData(0,0,v,v))),p.descent&&(g.clearRect(0,0,v,v),g.textBaseline="top",g.fillText(p.descent,0,0),l.descent=T(g.getImageData(0,0,v,v))),p.overshoot){g.clearRect(0,0,v,v),g.textBaseline="top",g.fillText(p.overshoot,0,0);var C=T(g.getImageData(0,0,v,v));l.overshoot=C-_}for(var S in l)l[S]/=a;return l.em=a,h.cache[n]=l,u(l,s)}function u(e,i){var n={};typeof i=="string"&&(i=e[i]);for(var a in e)a!=="em"&&(n[a]=e[a]-i);return n}function A(e){for(var i=e.height,n=e.data,a=3;a<n.length;a+=4)if(n[a]!==0)return Math.floor((a-3)*.25/i)}function T(e){for(var i=e.height,n=e.data,a=n.length-1;a>0;a-=4)if(n[a]!==0)return Math.floor((a-3)*.25/i)}},{}],194:[function(t,P,R){P.exports=h;function h(u,A){if(typeof u!="string")throw new TypeError("must specify type string");if(A=A||{},typeof document>"u"&&!A.canvas)return null;var T=A.canvas||document.createElement("canvas");typeof A.width=="number"&&(T.width=A.width),typeof A.height=="number"&&(T.height=A.height);var e=A,i;try{var n=[u];u.indexOf("webgl")===0&&n.push("experimental-"+u);for(var a=0;a<n.length;a++)if(i=T.getContext(n[a],e),i)return i}catch{i=null}return i||null}},{}],195:[function(t,P,R){P.exports=h;function h(u,A){var T=A[0],e=A[1],i=A[2],n=A[3],a=A[4],r=A[5],f=A[6],o=A[7],s=A[8],m=A[9],g=A[10],p=A[11],v=A[12],x=A[13],l=A[14],b=A[15];return u[0]=r*(g*b-p*l)-m*(f*b-o*l)+x*(f*p-o*g),u[1]=-(e*(g*b-p*l)-m*(i*b-n*l)+x*(i*p-n*g)),u[2]=e*(f*b-o*l)-r*(i*b-n*l)+x*(i*o-n*f),u[3]=-(e*(f*p-o*g)-r*(i*p-n*g)+m*(i*o-n*f)),u[4]=-(a*(g*b-p*l)-s*(f*b-o*l)+v*(f*p-o*g)),u[5]=T*(g*b-p*l)-s*(i*b-n*l)+v*(i*p-n*g),u[6]=-(T*(f*b-o*l)-a*(i*b-n*l)+v*(i*o-n*f)),u[7]=T*(f*p-o*g)-a*(i*p-n*g)+s*(i*o-n*f),u[8]=a*(m*b-p*x)-s*(r*b-o*x)+v*(r*p-o*m),u[9]=-(T*(m*b-p*x)-s*(e*b-n*x)+v*(e*p-n*m)),u[10]=T*(r*b-o*x)-a*(e*b-n*x)+v*(e*o-n*r),u[11]=-(T*(r*p-o*m)-a*(e*p-n*m)+s*(e*o-n*r)),u[12]=-(a*(m*l-g*x)-s*(r*l-f*x)+v*(r*g-f*m)),u[13]=T*(m*l-g*x)-s*(e*l-i*x)+v*(e*g-i*m),u[14]=-(T*(r*l-f*x)-a*(e*l-i*x)+v*(e*f-i*r)),u[15]=T*(r*g-f*m)-a*(e*g-i*m)+s*(e*f-i*r),u}},{}],196:[function(t,P,R){P.exports=h;function h(u){var A=new Float32Array(16);return A[0]=u[0],A[1]=u[1],A[2]=u[2],A[3]=u[3],A[4]=u[4],A[5]=u[5],A[6]=u[6],A[7]=u[7],A[8]=u[8],A[9]=u[9],A[10]=u[10],A[11]=u[11],A[12]=u[12],A[13]=u[13],A[14]=u[14],A[15]=u[15],A}},{}],197:[function(t,P,R){P.exports=h;function h(u,A){return u[0]=A[0],u[1]=A[1],u[2]=A[2],u[3]=A[3],u[4]=A[4],u[5]=A[5],u[6]=A[6],u[7]=A[7],u[8]=A[8],u[9]=A[9],u[10]=A[10],u[11]=A[11],u[12]=A[12],u[13]=A[13],u[14]=A[14],u[15]=A[15],u}},{}],198:[function(t,P,R){P.exports=h;function h(){var u=new Float32Array(16);return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}},{}],199:[function(t,P,R){P.exports=h;function h(u){var A=u[0],T=u[1],e=u[2],i=u[3],n=u[4],a=u[5],r=u[6],f=u[7],o=u[8],s=u[9],m=u[10],g=u[11],p=u[12],v=u[13],x=u[14],l=u[15],b=A*a-T*n,c=A*r-e*n,M=A*f-i*n,_=T*r-e*a,y=T*f-i*a,w=e*f-i*r,d=o*v-s*p,C=o*x-m*p,S=o*l-g*p,E=s*x-m*v,k=s*l-g*v,B=m*l-g*x;return b*B-c*k+M*E+_*S-y*C+w*d}},{}],200:[function(t,P,R){P.exports=h;function h(u,A){var T=A[0],e=A[1],i=A[2],n=A[3],a=T+T,r=e+e,f=i+i,o=T*a,s=e*a,m=e*r,g=i*a,p=i*r,v=i*f,x=n*a,l=n*r,b=n*f;return u[0]=1-m-v,u[1]=s+b,u[2]=g-l,u[3]=0,u[4]=s-b,u[5]=1-o-v,u[6]=p+x,u[7]=0,u[8]=g+l,u[9]=p-x,u[10]=1-o-m,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}},{}],201:[function(t,P,R){P.exports=h;function h(u,A,T){var e,i,n,a=T[0],r=T[1],f=T[2],o=Math.sqrt(a*a+r*r+f*f);return Math.abs(o)<1e-6?null:(o=1/o,a*=o,r*=o,f*=o,e=Math.sin(A),i=Math.cos(A),n=1-i,u[0]=a*a*n+i,u[1]=r*a*n+f*e,u[2]=f*a*n-r*e,u[3]=0,u[4]=a*r*n-f*e,u[5]=r*r*n+i,u[6]=f*r*n+a*e,u[7]=0,u[8]=a*f*n+r*e,u[9]=r*f*n-a*e,u[10]=f*f*n+i,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u)}},{}],202:[function(t,P,R){P.exports=h;function h(u,A,T){var e=A[0],i=A[1],n=A[2],a=A[3],r=e+e,f=i+i,o=n+n,s=e*r,m=e*f,g=e*o,p=i*f,v=i*o,x=n*o,l=a*r,b=a*f,c=a*o;return u[0]=1-(p+x),u[1]=m+c,u[2]=g-b,u[3]=0,u[4]=m-c,u[5]=1-(s+x),u[6]=v+l,u[7]=0,u[8]=g+b,u[9]=v-l,u[10]=1-(s+p),u[11]=0,u[12]=T[0],u[13]=T[1],u[14]=T[2],u[15]=1,u}},{}],203:[function(t,P,R){P.exports=h;function h(u,A){return u[0]=A[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=A[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=A[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}},{}],204:[function(t,P,R){P.exports=h;function h(u,A){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=A[0],u[13]=A[1],u[14]=A[2],u[15]=1,u}},{}],205:[function(t,P,R){P.exports=h;function h(u,A){var T=Math.sin(A),e=Math.cos(A);return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=e,u[6]=T,u[7]=0,u[8]=0,u[9]=-T,u[10]=e,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}},{}],206:[function(t,P,R){P.exports=h;function h(u,A){var T=Math.sin(A),e=Math.cos(A);return u[0]=e,u[1]=0,u[2]=-T,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=T,u[9]=0,u[10]=e,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}},{}],207:[function(t,P,R){P.exports=h;function h(u,A){var T=Math.sin(A),e=Math.cos(A);return u[0]=e,u[1]=T,u[2]=0,u[3]=0,u[4]=-T,u[5]=e,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}},{}],208:[function(t,P,R){P.exports=h;function h(u,A,T,e,i,n,a){var r=1/(T-A),f=1/(i-e),o=1/(n-a);return u[0]=n*2*r,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=n*2*f,u[6]=0,u[7]=0,u[8]=(T+A)*r,u[9]=(i+e)*f,u[10]=(a+n)*o,u[11]=-1,u[12]=0,u[13]=0,u[14]=a*n*2*o,u[15]=0,u}},{}],209:[function(t,P,R){P.exports=h;function h(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}},{}],210:[function(t,P,R){P.exports={create:t("./create"),clone:t("./clone"),copy:t("./copy"),identity:t("./identity"),transpose:t("./transpose"),invert:t("./invert"),adjoint:t("./adjoint"),determinant:t("./determinant"),multiply:t("./multiply"),translate:t("./translate"),scale:t("./scale"),rotate:t("./rotate"),rotateX:t("./rotateX"),rotateY:t("./rotateY"),rotateZ:t("./rotateZ"),fromRotation:t("./fromRotation"),fromRotationTranslation:t("./fromRotationTranslation"),fromScaling:t("./fromScaling"),fromTranslation:t("./fromTranslation"),fromXRotation:t("./fromXRotation"),fromYRotation:t("./fromYRotation"),fromZRotation:t("./fromZRotation"),fromQuat:t("./fromQuat"),frustum:t("./frustum"),perspective:t("./perspective"),perspectiveFromFieldOfView:t("./perspectiveFromFieldOfView"),ortho:t("./ortho"),lookAt:t("./lookAt"),str:t("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(t,P,R){P.exports=h;function h(u,A){var T=A[0],e=A[1],i=A[2],n=A[3],a=A[4],r=A[5],f=A[6],o=A[7],s=A[8],m=A[9],g=A[10],p=A[11],v=A[12],x=A[13],l=A[14],b=A[15],c=T*r-e*a,M=T*f-i*a,_=T*o-n*a,y=e*f-i*r,w=e*o-n*r,d=i*o-n*f,C=s*x-m*v,S=s*l-g*v,E=s*b-p*v,k=m*l-g*x,B=m*b-p*x,z=g*b-p*l,F=c*z-M*B+_*k+y*E-w*S+d*C;return F?(F=1/F,u[0]=(r*z-f*B+o*k)*F,u[1]=(i*B-e*z-n*k)*F,u[2]=(x*d-l*w+b*y)*F,u[3]=(g*w-m*d-p*y)*F,u[4]=(f*E-a*z-o*S)*F,u[5]=(T*z-i*E+n*S)*F,u[6]=(l*_-v*d-b*M)*F,u[7]=(s*d-g*_+p*M)*F,u[8]=(a*B-r*E+o*C)*F,u[9]=(e*E-T*B-n*C)*F,u[10]=(v*w-x*_+b*c)*F,u[11]=(m*_-s*w-p*c)*F,u[12]=(r*S-a*k-f*C)*F,u[13]=(T*k-e*S+i*C)*F,u[14]=(x*M-v*y-l*c)*F,u[15]=(s*y-m*M+g*c)*F,u):null}},{}],212:[function(t,P,R){var h=t("./identity");P.exports=u;function u(A,T,e,i){var n,a,r,f,o,s,m,g,p,v,x=T[0],l=T[1],b=T[2],c=i[0],M=i[1],_=i[2],y=e[0],w=e[1],d=e[2];return Math.abs(x-y)<1e-6&&Math.abs(l-w)<1e-6&&Math.abs(b-d)<1e-6?h(A):(m=x-y,g=l-w,p=b-d,v=1/Math.sqrt(m*m+g*g+p*p),m*=v,g*=v,p*=v,n=M*p-_*g,a=_*m-c*p,r=c*g-M*m,v=Math.sqrt(n*n+a*a+r*r),v?(v=1/v,n*=v,a*=v,r*=v):(n=0,a=0,r=0),f=g*r-p*a,o=p*n-m*r,s=m*a-g*n,v=Math.sqrt(f*f+o*o+s*s),v?(v=1/v,f*=v,o*=v,s*=v):(f=0,o=0,s=0),A[0]=n,A[1]=f,A[2]=m,A[3]=0,A[4]=a,A[5]=o,A[6]=g,A[7]=0,A[8]=r,A[9]=s,A[10]=p,A[11]=0,A[12]=-(n*x+a*l+r*b),A[13]=-(f*x+o*l+s*b),A[14]=-(m*x+g*l+p*b),A[15]=1,A)}},{"./identity":209}],213:[function(t,P,R){P.exports=h;function h(u,A,T){var e=A[0],i=A[1],n=A[2],a=A[3],r=A[4],f=A[5],o=A[6],s=A[7],m=A[8],g=A[9],p=A[10],v=A[11],x=A[12],l=A[13],b=A[14],c=A[15],M=T[0],_=T[1],y=T[2],w=T[3];return u[0]=M*e+_*r+y*m+w*x,u[1]=M*i+_*f+y*g+w*l,u[2]=M*n+_*o+y*p+w*b,u[3]=M*a+_*s+y*v+w*c,M=T[4],_=T[5],y=T[6],w=T[7],u[4]=M*e+_*r+y*m+w*x,u[5]=M*i+_*f+y*g+w*l,u[6]=M*n+_*o+y*p+w*b,u[7]=M*a+_*s+y*v+w*c,M=T[8],_=T[9],y=T[10],w=T[11],u[8]=M*e+_*r+y*m+w*x,u[9]=M*i+_*f+y*g+w*l,u[10]=M*n+_*o+y*p+w*b,u[11]=M*a+_*s+y*v+w*c,M=T[12],_=T[13],y=T[14],w=T[15],u[12]=M*e+_*r+y*m+w*x,u[13]=M*i+_*f+y*g+w*l,u[14]=M*n+_*o+y*p+w*b,u[15]=M*a+_*s+y*v+w*c,u}},{}],214:[function(t,P,R){P.exports=h;function h(u,A,T,e,i,n,a){var r=1/(A-T),f=1/(e-i),o=1/(n-a);return u[0]=-2*r,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*f,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*o,u[11]=0,u[12]=(A+T)*r,u[13]=(i+e)*f,u[14]=(a+n)*o,u[15]=1,u}},{}],215:[function(t,P,R){P.exports=h;function h(u,A,T,e,i){var n=1/Math.tan(A/2),a=1/(e-i);return u[0]=n/T,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=n,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=(i+e)*a,u[11]=-1,u[12]=0,u[13]=0,u[14]=2*i*e*a,u[15]=0,u}},{}],216:[function(t,P,R){P.exports=h;function h(u,A,T,e){var i=Math.tan(A.upDegrees*Math.PI/180),n=Math.tan(A.downDegrees*Math.PI/180),a=Math.tan(A.leftDegrees*Math.PI/180),r=Math.tan(A.rightDegrees*Math.PI/180),f=2/(a+r),o=2/(i+n);return u[0]=f,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=o,u[6]=0,u[7]=0,u[8]=-((a-r)*f*.5),u[9]=(i-n)*o*.5,u[10]=e/(T-e),u[11]=-1,u[12]=0,u[13]=0,u[14]=e*T/(T-e),u[15]=0,u}},{}],217:[function(t,P,R){P.exports=h;function h(u,A,T,e){var i=e[0],n=e[1],a=e[2],r=Math.sqrt(i*i+n*n+a*a),f,o,s,m,g,p,v,x,l,b,c,M,_,y,w,d,C,S,E,k,B,z,F,I;return Math.abs(r)<1e-6?null:(r=1/r,i*=r,n*=r,a*=r,f=Math.sin(T),o=Math.cos(T),s=1-o,m=A[0],g=A[1],p=A[2],v=A[3],x=A[4],l=A[5],b=A[6],c=A[7],M=A[8],_=A[9],y=A[10],w=A[11],d=i*i*s+o,C=n*i*s+a*f,S=a*i*s-n*f,E=i*n*s-a*f,k=n*n*s+o,B=a*n*s+i*f,z=i*a*s+n*f,F=n*a*s-i*f,I=a*a*s+o,u[0]=m*d+x*C+M*S,u[1]=g*d+l*C+_*S,u[2]=p*d+b*C+y*S,u[3]=v*d+c*C+w*S,u[4]=m*E+x*k+M*B,u[5]=g*E+l*k+_*B,u[6]=p*E+b*k+y*B,u[7]=v*E+c*k+w*B,u[8]=m*z+x*F+M*I,u[9]=g*z+l*F+_*I,u[10]=p*z+b*F+y*I,u[11]=v*z+c*F+w*I,A!==u&&(u[12]=A[12],u[13]=A[13],u[14]=A[14],u[15]=A[15]),u)}},{}],218:[function(t,P,R){P.exports=h;function h(u,A,T){var e=Math.sin(T),i=Math.cos(T),n=A[4],a=A[5],r=A[6],f=A[7],o=A[8],s=A[9],m=A[10],g=A[11];return A!==u&&(u[0]=A[0],u[1]=A[1],u[2]=A[2],u[3]=A[3],u[12]=A[12],u[13]=A[13],u[14]=A[14],u[15]=A[15]),u[4]=n*i+o*e,u[5]=a*i+s*e,u[6]=r*i+m*e,u[7]=f*i+g*e,u[8]=o*i-n*e,u[9]=s*i-a*e,u[10]=m*i-r*e,u[11]=g*i-f*e,u}},{}],219:[function(t,P,R){P.exports=h;function h(u,A,T){var e=Math.sin(T),i=Math.cos(T),n=A[0],a=A[1],r=A[2],f=A[3],o=A[8],s=A[9],m=A[10],g=A[11];return A!==u&&(u[4]=A[4],u[5]=A[5],u[6]=A[6],u[7]=A[7],u[12]=A[12],u[13]=A[13],u[14]=A[14],u[15]=A[15]),u[0]=n*i-o*e,u[1]=a*i-s*e,u[2]=r*i-m*e,u[3]=f*i-g*e,u[8]=n*e+o*i,u[9]=a*e+s*i,u[10]=r*e+m*i,u[11]=f*e+g*i,u}},{}],220:[function(t,P,R){P.exports=h;function h(u,A,T){var e=Math.sin(T),i=Math.cos(T),n=A[0],a=A[1],r=A[2],f=A[3],o=A[4],s=A[5],m=A[6],g=A[7];return A!==u&&(u[8]=A[8],u[9]=A[9],u[10]=A[10],u[11]=A[11],u[12]=A[12],u[13]=A[13],u[14]=A[14],u[15]=A[15]),u[0]=n*i+o*e,u[1]=a*i+s*e,u[2]=r*i+m*e,u[3]=f*i+g*e,u[4]=o*i-n*e,u[5]=s*i-a*e,u[6]=m*i-r*e,u[7]=g*i-f*e,u}},{}],221:[function(t,P,R){P.exports=h;function h(u,A,T){var e=T[0],i=T[1],n=T[2];return u[0]=A[0]*e,u[1]=A[1]*e,u[2]=A[2]*e,u[3]=A[3]*e,u[4]=A[4]*i,u[5]=A[5]*i,u[6]=A[6]*i,u[7]=A[7]*i,u[8]=A[8]*n,u[9]=A[9]*n,u[10]=A[10]*n,u[11]=A[11]*n,u[12]=A[12],u[13]=A[13],u[14]=A[14],u[15]=A[15],u}},{}],222:[function(t,P,R){P.exports=h;function h(u){return"mat4("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+", "+u[4]+", "+u[5]+", "+u[6]+", "+u[7]+", "+u[8]+", "+u[9]+", "+u[10]+", "+u[11]+", "+u[12]+", "+u[13]+", "+u[14]+", "+u[15]+")"}},{}],223:[function(t,P,R){P.exports=h;function h(u,A,T){var e=T[0],i=T[1],n=T[2],a,r,f,o,s,m,g,p,v,x,l,b;return A===u?(u[12]=A[0]*e+A[4]*i+A[8]*n+A[12],u[13]=A[1]*e+A[5]*i+A[9]*n+A[13],u[14]=A[2]*e+A[6]*i+A[10]*n+A[14],u[15]=A[3]*e+A[7]*i+A[11]*n+A[15]):(a=A[0],r=A[1],f=A[2],o=A[3],s=A[4],m=A[5],g=A[6],p=A[7],v=A[8],x=A[9],l=A[10],b=A[11],u[0]=a,u[1]=r,u[2]=f,u[3]=o,u[4]=s,u[5]=m,u[6]=g,u[7]=p,u[8]=v,u[9]=x,u[10]=l,u[11]=b,u[12]=a*e+s*i+v*n+A[12],u[13]=r*e+m*i+x*n+A[13],u[14]=f*e+g*i+l*n+A[14],u[15]=o*e+p*i+b*n+A[15]),u}},{}],224:[function(t,P,R){P.exports=h;function h(u,A){if(u===A){var T=A[1],e=A[2],i=A[3],n=A[6],a=A[7],r=A[11];u[1]=A[4],u[2]=A[8],u[3]=A[12],u[4]=T,u[6]=A[9],u[7]=A[13],u[8]=e,u[9]=n,u[11]=A[14],u[12]=i,u[13]=a,u[14]=r}else u[0]=A[0],u[1]=A[4],u[2]=A[8],u[3]=A[12],u[4]=A[1],u[5]=A[5],u[6]=A[9],u[7]=A[13],u[8]=A[2],u[9]=A[6],u[10]=A[10],u[11]=A[14],u[12]=A[3],u[13]=A[7],u[14]=A[11],u[15]=A[15];return u}},{}],225:[function(t,P,R){var h=t("css-font"),u=t("pick-by-alias"),A=t("regl"),T=t("gl-util/context"),e=t("es6-weak-map"),i=t("color-normalize"),n=t("font-atlas"),a=t("typedarray-pool"),r=t("parse-rect"),f=t("is-plain-obj"),o=t("parse-unit"),s=t("to-px"),m=t("detect-kerning"),g=t("object-assign"),p=t("font-measure"),v=t("flatten-vertex-data"),x=t("bit-twiddle"),l=x.nextPow2,b=new e,c=!1;if(document.body){var M=document.body.appendChild(document.createElement("div"));M.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(M).fontStretch&&(c=!0),document.body.removeChild(M)}var _=function(d){y(d)?(d={regl:d},this.gl=d.regl._gl):this.gl=T(d),this.shader=b.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=d.regl||A({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),b.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(f(d)?d:{})};_.prototype.createShader=function(){var d=this.regl,C=d({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:d.prop("count"),offset:d.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:d.this("sizeBuffer")},width:{offset:0,stride:8,buffer:d.this("sizeBuffer")},char:d.this("charBuffer"),position:d.this("position")},uniforms:{atlasSize:function(E,k){return[k.atlas.width,k.atlas.height]},atlasDim:function(E,k){return[k.atlas.cols,k.atlas.rows]},atlas:function(E,k){return k.atlas.texture},charStep:function(E,k){return k.atlas.step},em:function(E,k){return k.atlas.em},color:d.prop("color"),opacity:d.prop("opacity"),viewport:d.this("viewportArray"),scale:d.this("scale"),align:d.prop("align"),baseline:d.prop("baseline"),translate:d.this("translate"),positionOffset:d.prop("positionOffset")},primitive:"points",viewport:d.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ vec2(positionOffset.x, -positionOffset.y)))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			uniform sampler2D atlas;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`}),S={};return{regl:d,draw:C,atlas:S}},_.prototype.update=function(d){var C=this;if(typeof d=="string")d={text:d};else if(!d)return;d=u(d,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0),d.opacity!=null&&(Array.isArray(d.opacity)?this.opacity=d.opacity.map(function(Te){return parseFloat(Te)}):this.opacity=parseFloat(d.opacity)),d.viewport!=null&&(this.viewport=r(d.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),d.kerning!=null&&(this.kerning=d.kerning),d.offset!=null&&(typeof d.offset=="number"&&(d.offset=[d.offset,0]),this.positionOffset=v(d.offset)),d.direction&&(this.direction=d.direction),d.range&&(this.range=d.range,this.scale=[1/(d.range[2]-d.range[0]),1/(d.range[3]-d.range[1])],this.translate=[-d.range[0],-d.range[1]]),d.scale&&(this.scale=d.scale),d.translate&&(this.translate=d.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),!this.font.length&&!d.font&&(d.font=_.baseFontSize+"px sans-serif");var S=!1,E=!1;if(d.font&&(Array.isArray(d.font)?d.font:[d.font]).forEach(function(Te,Ce){if(typeof Te=="string")try{Te=h.parse(Te)}catch{Te=h.parse(_.baseFontSize+"px "+Te)}else Te=h.parse(h.stringify(Te));var He=h.stringify({size:_.baseFontSize,family:Te.family,stretch:c?Te.stretch:void 0,variant:Te.variant,weight:Te.weight,style:Te.style}),Xe=o(Te.size),Be=Math.round(Xe[0]*s(Xe[1]));if(Be!==C.fontSize[Ce]&&(E=!0,C.fontSize[Ce]=Be),(!C.font[Ce]||He!=C.font[Ce].baseString)&&(S=!0,C.font[Ce]=_.fonts[He],!C.font[Ce])){var Re=Te.family.join(", "),We=[Te.style];Te.style!=Te.variant&&We.push(Te.variant),Te.variant!=Te.weight&&We.push(Te.weight),c&&Te.weight!=Te.stretch&&We.push(Te.stretch),C.font[Ce]={baseString:He,family:Re,weight:Te.weight,stretch:Te.stretch,style:Te.style,variant:Te.variant,width:{},kerning:{},metrics:p(Re,{origin:"top",fontSize:_.baseFontSize,fontStyle:We.join(" ")})},_.fonts[He]=C.font[Ce]}}),(S||E)&&this.font.forEach(function(Te,Ce){var He=h.stringify({size:C.fontSize[Ce],family:Te.family,stretch:c?Te.stretch:void 0,variant:Te.variant,weight:Te.weight,style:Te.style});if(C.fontAtlas[Ce]=C.shader.atlas[He],!C.fontAtlas[Ce]){var Xe=Te.metrics;C.shader.atlas[He]=C.fontAtlas[Ce]={fontString:He,step:Math.ceil(C.fontSize[Ce]*Xe.bottom*.5)*2,em:C.fontSize[Ce],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:C.regl.texture()}}d.text==null&&(d.text=C.text)}),typeof d.text=="string"&&d.position&&d.position.length>2){for(var k=Array(d.position.length*.5),B=0;B<k.length;B++)k[B]=d.text;d.text=k}var z;if(d.text!=null||S){if(this.textOffsets=[0],Array.isArray(d.text)){this.count=d.text[0].length,this.counts=[this.count];for(var F=1;F<d.text.length;F++)this.textOffsets[F]=this.textOffsets[F-1]+d.text[F-1].length,this.count+=d.text[F].length,this.counts.push(d.text[F].length);this.text=d.text.join("")}else this.text=d.text,this.count=this.text.length,this.counts=[this.count];z=[],this.font.forEach(function(Te,Ce){_.atlasContext.font=Te.baseString;for(var He=C.fontAtlas[Ce],Xe=0;Xe<C.text.length;Xe++){var Be=C.text.charAt(Xe);if(He.ids[Be]==null&&(He.ids[Be]=He.chars.length,He.chars.push(Be),z.push(Be)),Te.width[Be]==null&&(Te.width[Be]=_.atlasContext.measureText(Be).width/_.baseFontSize,C.kerning)){var Re=[];for(var We in Te.width)Re.push(We+Be,Be+We);g(Te.kerning,m(Te.family,{pairs:Re}))}}})}if(d.position)if(d.position.length>2){for(var I=!d.position[0].length,O=a.mallocFloat(this.count*2),N=0,V=0;N<this.counts.length;N++){var H=this.counts[N];if(I)for(var j=0;j<H;j++)O[V++]=d.position[N*2],O[V++]=d.position[N*2+1];else for(var Z=0;Z<H;Z++)O[V++]=d.position[N][0],O[V++]=d.position[N][1]}this.position.call?this.position({type:"float",data:O}):this.position=this.regl.buffer({type:"float",data:O}),a.freeFloat(O)}else this.position.destroy&&this.position.destroy(),this.position={constant:d.position};if(d.text||S){var X=a.mallocUint8(this.count),re=a.mallocFloat(this.count*2);this.textWidth=[];for(var ue=0,K=0;ue<this.counts.length;ue++){for(var te=this.counts[ue],G=this.font[ue]||this.font[0],Y=this.fontAtlas[ue]||this.fontAtlas[0],ee=0;ee<te;ee++){var ne=this.text.charAt(K),J=this.text.charAt(K-1);if(X[K]=Y.ids[ne],re[K*2]=G.width[ne],ee){var q=re[K*2-2],ae=re[K*2],le=re[K*2-1],ie=le+q*.5+ae*.5;if(this.kerning){var se=G.kerning[J+ne];se&&(ie+=se*.001)}re[K*2+1]=ie}else re[K*2+1]=re[K*2]*.5;K++}this.textWidth.push(re.length?re[K*2-2]*.5+re[K*2-1]:0)}d.align||(d.align=this.align),this.charBuffer({data:X,type:"uint8",usage:"stream"}),this.sizeBuffer({data:re,type:"float",usage:"stream"}),a.freeUint8(X),a.freeFloat(re),z.length&&this.font.forEach(function(Te,Ce){var He=C.fontAtlas[Ce],Xe=He.step,Be=Math.floor(_.maxAtlasSize/Xe),Re=Math.min(Be,He.chars.length),We=Math.ceil(He.chars.length/Re),vt=l(Re*Xe),Pt=l(We*Xe);He.width=vt,He.height=Pt,He.rows=We,He.cols=Re,He.em&&He.texture({data:n({canvas:_.atlasCanvas,font:He.fontString,chars:He.chars,shape:[vt,Pt],step:[Xe,Xe]})})})}if(d.align&&(this.align=d.align,this.alignOffset=this.textWidth.map(function(Te,Ce){var He=Array.isArray(C.align)?C.align.length>1?C.align[Ce]:C.align[0]:C.align;if(typeof He=="number")return He;switch(He){case"right":case"end":return-Te;case"center":case"centre":case"middle":return-Te*.5}return 0})),this.baseline==null&&d.baseline==null&&(d.baseline=0),d.baseline!=null&&(this.baseline=d.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(Te,Ce){var He=(C.font[Ce]||C.font[0]).metrics,Xe=0;return Xe+=He.bottom*.5,typeof Te=="number"?Xe+=Te-He.baseline:Xe+=-He[Te],Xe*=-1,Xe})),d.color!=null)if(d.color||(d.color="transparent"),typeof d.color=="string"||!isNaN(d.color))this.color=i(d.color,"uint8");else{var xe;if(typeof d.color[0]=="number"&&d.color.length>this.counts.length){var oe=d.color.length;xe=a.mallocUint8(oe);for(var he=(d.color.subarray||d.color.slice).bind(d.color),be=0;be<oe;be+=4)xe.set(i(he(be,be+4),"uint8"),be)}else{var me=d.color.length;xe=a.mallocUint8(me*4);for(var _e=0;_e<me;_e++)xe.set(i(d.color[_e]||0,"uint8"),_e*4)}this.color=xe}if(d.position||d.text||d.color||d.baseline||d.align||d.font||d.offset||d.opacity){var Se=this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2;if(Se){var De=Math.max(this.position.length*.5||0,this.color.length*.25||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,this.positionOffset.length*.5||0);this.batch=Array(De);for(var Ie=0;Ie<this.batch.length;Ie++)this.batch[Ie]={count:this.counts.length>1?this.counts[Ie]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[Ie]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(Ie*4,Ie*4+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[Ie]:this.opacity,baseline:this.baselineOffset[Ie]!=null?this.baselineOffset[Ie]:this.baselineOffset[0],align:this.align?this.alignOffset[Ie]!=null?this.alignOffset[Ie]:this.alignOffset[0]:0,atlas:this.fontAtlas[Ie]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(Ie*2,Ie*2+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]}},_.prototype.destroy=function(){},_.prototype.kerning=!0,_.prototype.position={constant:new Float32Array(2)},_.prototype.translate=null,_.prototype.scale=null,_.prototype.font=null,_.prototype.text="",_.prototype.positionOffset=[0,0],_.prototype.opacity=1,_.prototype.color=new Uint8Array([0,0,0,255]),_.prototype.alignOffset=[0,0],_.maxAtlasSize=1024,_.atlasCanvas=document.createElement("canvas"),_.atlasContext=_.atlasCanvas.getContext("2d",{alpha:!1}),_.baseFontSize=64,_.fonts={};function y(w){return typeof w=="function"&&w._gl&&w.prop&&w.texture&&w.buffer}P.exports=_},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:284,"to-px":315,"typedarray-pool":328}],226:[function(t,P,R){(function(h){(function(){var u=t("pick-by-alias");P.exports=function(r){if(r?typeof r=="string"&&(r={container:r}):r={},T(r)?r={container:r}:e(r)?r={container:r}:i(r)?r={gl:r}:r=u(r,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),r.pixelRatio||(r.pixelRatio=h.pixelRatio||1),r.gl)return r.gl;if(r.canvas&&(r.container=r.canvas.parentNode),r.container){if(typeof r.container=="string"){var f=document.querySelector(r.container);if(!f)throw Error("Element "+r.container+" is not found");r.container=f}T(r.container)?(r.canvas=r.container,r.container=r.canvas.parentNode):r.canvas||(r.canvas=n(),r.container.appendChild(r.canvas),A(r))}else if(!r.canvas)if(typeof document<"u")r.container=document.body||document.documentElement,r.canvas=n(),r.container.appendChild(r.canvas),A(r);else throw Error("Not DOM environment. Use headless-gl.");return r.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(o){try{r.gl=r.canvas.getContext(o,r.attrs)}catch{}return r.gl}),r.gl};function A(a){if(a.container)if(a.container==document.body)document.body.style.width||(a.canvas.width=a.width||a.pixelRatio*h.innerWidth),document.body.style.height||(a.canvas.height=a.height||a.pixelRatio*h.innerHeight);else{var r=a.container.getBoundingClientRect();a.canvas.width=a.width||r.right-r.left,a.canvas.height=a.height||r.bottom-r.top}}function T(a){return typeof a.getContext=="function"&&"width"in a&&"height"in a}function e(a){return typeof a.nodeName=="string"&&typeof a.appendChild=="function"&&typeof a.getBoundingClientRect=="function"}function i(a){return typeof a.drawArrays=="function"||typeof a.drawElements=="function"}function n(){var a=document.createElement("canvas");return a.style.position="absolute",a.style.top=0,a.style.left=0,a}}).call(this)}).call(this,typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{"pick-by-alias":253}],227:[function(t,P,R){P.exports=function(h){typeof h=="string"&&(h=[h]);for(var u=[].slice.call(arguments,1),A=[],T=0;T<h.length-1;T++)A.push(h[T],u[T]||"");return A.push(h[T]),A.join("")}},{}],228:[function(t,P,R){(function(h){(function(){var u=t("is-browser"),A;typeof h.matchMedia=="function"?A=!h.matchMedia("(hover: none)").matches:A=u,P.exports=A}).call(this)}).call(this,typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{"is-browser":232}],229:[function(t,P,R){var h=t("is-browser");function u(){var A=!1;try{var T=Object.defineProperty({},"passive",{get:function(){A=!0}});window.addEventListener("test",null,T),window.removeEventListener("test",null,T)}catch{A=!1}return A}P.exports=h&&u()},{"is-browser":232}],230:[function(t,P,R){R.read=function(h,u,A,T,e){var i,n,a=e*8-T-1,r=(1<<a)-1,f=r>>1,o=-7,s=A?e-1:0,m=A?-1:1,g=h[u+s];for(s+=m,i=g&(1<<-o)-1,g>>=-o,o+=a;o>0;i=i*256+h[u+s],s+=m,o-=8);for(n=i&(1<<-o)-1,i>>=-o,o+=T;o>0;n=n*256+h[u+s],s+=m,o-=8);if(i===0)i=1-f;else{if(i===r)return n?NaN:(g?-1:1)*(1/0);n=n+Math.pow(2,T),i=i-f}return(g?-1:1)*n*Math.pow(2,i-T)},R.write=function(h,u,A,T,e,i){var n,a,r,f=i*8-e-1,o=(1<<f)-1,s=o>>1,m=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=T?0:i-1,p=T?1:-1,v=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(a=isNaN(u)?1:0,n=o):(n=Math.floor(Math.log(u)/Math.LN2),u*(r=Math.pow(2,-n))<1&&(n--,r*=2),n+s>=1?u+=m/r:u+=m*Math.pow(2,1-s),u*r>=2&&(n++,r/=2),n+s>=o?(a=0,n=o):n+s>=1?(a=(u*r-1)*Math.pow(2,e),n=n+s):(a=u*Math.pow(2,s-1)*Math.pow(2,e),n=0));e>=8;h[A+g]=a&255,g+=p,a/=256,e-=8);for(n=n<<e|a,f+=e;f>0;h[A+g]=n&255,g+=p,n/=256,f-=8);h[A+g-p]|=v*128}},{}],231:[function(t,P,R){typeof Object.create=="function"?P.exports=function(u,A){A&&(u.super_=A,u.prototype=Object.create(A.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}))}:P.exports=function(u,A){if(A){u.super_=A;var T=function(){};T.prototype=A.prototype,u.prototype=new T,u.prototype.constructor=u}}},{}],232:[function(t,P,R){P.exports=!0},{}],233:[function(t,P,R){P.exports=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(t,P,R){P.exports=A,P.exports.isMobile=A,P.exports.default=A;var h=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,u=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function A(T){T||(T={});var e=T.ua;if(!e&&typeof navigator<"u"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var i=T.tablet?u.test(e):h.test(e);return!i&&T.tablet&&T.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(i=!0),i}},{}],235:[function(t,P,R){P.exports=function(h){var u=typeof h;return h!==null&&(u==="object"||u==="function")}},{}],236:[function(t,P,R){var h=Object.prototype.toString;P.exports=function(u){var A;return h.call(u)==="[object Object]"&&(A=Object.getPrototypeOf(u),A===null||A===Object.getPrototypeOf({}))}},{}],237:[function(t,P,R){P.exports=function(h){for(var u=h.length,A,T=0;T<u;T++)if(A=h.charCodeAt(T),(A<9||A>13)&&A!==32&&A!==133&&A!==160&&A!==5760&&A!==6158&&(A<8192||A>8205)&&A!==8232&&A!==8233&&A!==8239&&A!==8287&&A!==8288&&A!==12288&&A!==65279)return!1;return!0}},{}],238:[function(t,P,R){P.exports=function(u){return typeof u!="string"?!1:(u=u.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(u)&&/[\dz]$/i.test(u)&&u.length>4))}},{}],239:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?P.exports=u():(h=h||self,h.mapboxgl=u())})(this,function(){var h,u,A;function T(e,i){if(!h)h=i;else if(!u)u=i;else{var n="var sharedChunk = {}; ("+h+")(sharedChunk); ("+u+")(sharedChunk);",a={};h(a),A=i(a),A.workerUrl=window.URL.createObjectURL(new Blob([n],{type:"text/javascript"}))}}return T(["exports"],function(e){function i(D,L){return L={exports:{}},D(L,L.exports),L.exports}var n="1.10.1",a=r;function r(D,L,U,$){this.cx=3*D,this.bx=3*(U-D)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*L,this.by=3*($-L)-this.cy,this.ay=1-this.cy-this.by,this.p1x=D,this.p1y=$,this.p2x=U,this.p2y=$}r.prototype.sampleCurveX=function(D){return((this.ax*D+this.bx)*D+this.cx)*D},r.prototype.sampleCurveY=function(D){return((this.ay*D+this.by)*D+this.cy)*D},r.prototype.sampleCurveDerivativeX=function(D){return(3*this.ax*D+2*this.bx)*D+this.cx},r.prototype.solveCurveX=function(D,L){typeof L>"u"&&(L=1e-6);var U,$,ve,we,Me;for(ve=D,Me=0;Me<8;Me++){if(we=this.sampleCurveX(ve)-D,Math.abs(we)<L)return ve;var Oe=this.sampleCurveDerivativeX(ve);if(Math.abs(Oe)<1e-6)break;ve=ve-we/Oe}if(U=0,$=1,ve=D,ve<U)return U;if(ve>$)return $;for(;U<$;){if(we=this.sampleCurveX(ve),Math.abs(we-D)<L)return ve;D>we?U=ve:$=ve,ve=($-U)*.5+U}return ve},r.prototype.solve=function(D,L){return this.sampleCurveY(this.solveCurveX(D,L))};var f=o;function o(D,L){this.x=D,this.y=L}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(D){return this.clone()._add(D)},sub:function(D){return this.clone()._sub(D)},multByPoint:function(D){return this.clone()._multByPoint(D)},divByPoint:function(D){return this.clone()._divByPoint(D)},mult:function(D){return this.clone()._mult(D)},div:function(D){return this.clone()._div(D)},rotate:function(D){return this.clone()._rotate(D)},rotateAround:function(D,L){return this.clone()._rotateAround(D,L)},matMult:function(D){return this.clone()._matMult(D)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(D){return this.x===D.x&&this.y===D.y},dist:function(D){return Math.sqrt(this.distSqr(D))},distSqr:function(D){var L=D.x-this.x,U=D.y-this.y;return L*L+U*U},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(D){return Math.atan2(this.y-D.y,this.x-D.x)},angleWith:function(D){return this.angleWithSep(D.x,D.y)},angleWithSep:function(D,L){return Math.atan2(this.x*L-this.y*D,this.x*D+this.y*L)},_matMult:function(D){var L=D[0]*this.x+D[1]*this.y,U=D[2]*this.x+D[3]*this.y;return this.x=L,this.y=U,this},_add:function(D){return this.x+=D.x,this.y+=D.y,this},_sub:function(D){return this.x-=D.x,this.y-=D.y,this},_mult:function(D){return this.x*=D,this.y*=D,this},_div:function(D){return this.x/=D,this.y/=D,this},_multByPoint:function(D){return this.x*=D.x,this.y*=D.y,this},_divByPoint:function(D){return this.x/=D.x,this.y/=D.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var D=this.y;return this.y=this.x,this.x=-D,this},_rotate:function(D){var L=Math.cos(D),U=Math.sin(D),$=L*this.x-U*this.y,ve=U*this.x+L*this.y;return this.x=$,this.y=ve,this},_rotateAround:function(D,L){var U=Math.cos(D),$=Math.sin(D),ve=L.x+U*(this.x-L.x)-$*(this.y-L.y),we=L.y+$*(this.x-L.x)+U*(this.y-L.y);return this.x=ve,this.y=we,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(D){return D instanceof o?D:Array.isArray(D)?new o(D[0],D[1]):D};function s(D,L){if(Array.isArray(D)){if(!Array.isArray(L)||D.length!==L.length)return!1;for(var U=0;U<D.length;U++)if(!s(D[U],L[U]))return!1;return!0}if(typeof D=="object"&&D!==null&&L!==null){if(typeof L!="object")return!1;var $=Object.keys(D);if($.length!==Object.keys(L).length)return!1;for(var ve in D)if(!s(D[ve],L[ve]))return!1;return!0}return D===L}function m(D){if(D<=0)return 0;if(D>=1)return 1;var L=D*D,U=L*D;return 4*(D<.5?U:3*(D-L)+U-.75)}function g(D,L,U,$){var ve=new a(D,L,U,$);return function(we){return ve.solve(we)}}var p=g(.25,.1,.25,1);function v(D,L,U){return Math.min(U,Math.max(L,D))}function x(D,L,U){var $=U-L,ve=((D-L)%$+$)%$+L;return ve===L?U:ve}function l(D,L,U){if(!D.length)return U(null,[]);var $=D.length,ve=new Array(D.length),we=null;D.forEach(function(Me,Oe){L(Me,function(tt,pt){tt&&(we=tt),ve[Oe]=pt,--$===0&&U(we,ve)})})}function b(D){var L=[];for(var U in D)L.push(D[U]);return L}function c(D,L){var U=[];for(var $ in D)$ in L||U.push($);return U}function M(D){for(var L=[],U=arguments.length-1;U-- >0;)L[U]=arguments[U+1];for(var $=0,ve=L;$<ve.length;$+=1){var we=ve[$];for(var Me in we)D[Me]=we[Me]}return D}function _(D,L){for(var U={},$=0;$<L.length;$++){var ve=L[$];ve in D&&(U[ve]=D[ve])}return U}var y=1;function w(){return y++}function d(){function D(L){return L?(L^Math.random()*16>>L/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,D)}return D()}function C(D){return D?/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(D):!1}function S(D,L){D.forEach(function(U){!L[U]||(L[U]=L[U].bind(L))})}function E(D,L){return D.indexOf(L,D.length-L.length)!==-1}function k(D,L,U){var $={};for(var ve in D)$[ve]=L.call(U||this,D[ve],ve,D);return $}function B(D,L,U){var $={};for(var ve in D)L.call(U||this,D[ve],ve,D)&&($[ve]=D[ve]);return $}function z(D){return Array.isArray(D)?D.map(z):typeof D=="object"&&D?k(D,z):D}function F(D,L){for(var U=0;U<D.length;U++)if(L.indexOf(D[U])>=0)return!0;return!1}var I={};function O(D){I[D]||(typeof console<"u"&&console.warn(D),I[D]=!0)}function N(D,L,U){return(U.y-D.y)*(L.x-D.x)>(L.y-D.y)*(U.x-D.x)}function V(D){for(var L=0,U=0,$=D.length,ve=$-1,we=void 0,Me=void 0;U<$;ve=U++)we=D[U],Me=D[ve],L+=(Me.x-we.x)*(we.y+Me.y);return L}function H(D){var L=D[0],U=D[1],$=D[2];return U+=90,U*=Math.PI/180,$*=Math.PI/180,{x:L*Math.cos(U)*Math.sin($),y:L*Math.sin(U)*Math.sin($),z:L*Math.cos($)}}function j(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Z(D){var L=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,U={};if(D.replace(L,function(ve,we,Me,Oe){var tt=Me||Oe;return U[we]=tt?tt.toLowerCase():!0,""}),U["max-age"]){var $=parseInt(U["max-age"],10);isNaN($)?delete U["max-age"]:U["max-age"]=$}return U}var X=null;function re(D){if(X==null){var L=D.navigator?D.navigator.userAgent:null;X=!!D.safari||!!(L&&(/\b(iPad|iPhone|iPod)\b/.test(L)||!!L.match("Safari")&&!L.match("Chrome")))}return X}function ue(D){try{var L=self[D];return L.setItem("_mapbox_test_",1),L.removeItem("_mapbox_test_"),!0}catch{return!1}}function K(D){return self.btoa(encodeURIComponent(D).replace(/%([0-9A-F]{2})/g,function(L,U){return String.fromCharCode(Number("0x"+U))}))}function te(D){return decodeURIComponent(self.atob(D).split("").map(function(L){return"%"+("00"+L.charCodeAt(0).toString(16)).slice(-2)}).join(""))}var G=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),Y=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,ee=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,ne,J,q={now:G,frame:function(L){var U=Y(L);return{cancel:function(){return ee(U)}}},getImageData:function(L,U){U===void 0&&(U=0);var $=self.document.createElement("canvas"),ve=$.getContext("2d");if(!ve)throw new Error("failed to create canvas 2d context");return $.width=L.width,$.height=L.height,ve.drawImage(L,0,0,L.width,L.height),ve.getImageData(-U,-U,L.width+2*U,L.height+2*U)},resolveURL:function(L){return ne||(ne=self.document.createElement("a")),ne.href=L,ne.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return self.matchMedia?(J==null&&(J=self.matchMedia("(prefers-reduced-motion: reduce)")),J.matches):!1}},ae={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},le={supported:!1,testSupport:he},ie,se=!1,xe,oe=!1;self.document&&(xe=self.document.createElement("img"),xe.onload=function(){ie&&be(ie),ie=null,oe=!0},xe.onerror=function(){se=!0,ie=null},xe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");function he(D){se||!xe||(oe?be(D):ie=D)}function be(D){var L=D.createTexture();D.bindTexture(D.TEXTURE_2D,L);try{if(D.texImage2D(D.TEXTURE_2D,0,D.RGBA,D.RGBA,D.UNSIGNED_BYTE,xe),D.isContextLost())return;le.supported=!0}catch{}D.deleteTexture(L),se=!0}var me="01";function _e(){for(var D="1",L="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",U="",$=0;$<10;$++)U+=L[Math.floor(Math.random()*62)];var ve=12*60*60*1e3,we=[D,me,U].join(""),Me=Date.now()+ve;return{token:we,tokenExpiresAt:Me}}var Se=function(L,U){this._transformRequestFn=L,this._customAccessToken=U,this._createSkuToken()};Se.prototype._createSkuToken=function(){var L=_e();this._skuToken=L.token,this._skuTokenExpiresAt=L.tokenExpiresAt},Se.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Se.prototype.transformRequest=function(L,U){return this._transformRequestFn?this._transformRequestFn(L,U)||{url:L}:{url:L}},Se.prototype.normalizeStyleURL=function(L,U){if(!De(L))return L;var $=Be(L);return $.path="/styles/v1"+$.path,this._makeAPIURL($,this._customAccessToken||U)},Se.prototype.normalizeGlyphsURL=function(L,U){if(!De(L))return L;var $=Be(L);return $.path="/fonts/v1"+$.path,this._makeAPIURL($,this._customAccessToken||U)},Se.prototype.normalizeSourceURL=function(L,U){if(!De(L))return L;var $=Be(L);return $.path="/v4/"+$.authority+".json",$.params.push("secure"),this._makeAPIURL($,this._customAccessToken||U)},Se.prototype.normalizeSpriteURL=function(L,U,$,ve){var we=Be(L);return De(L)?(we.path="/styles/v1"+we.path+"/sprite"+U+$,this._makeAPIURL(we,this._customAccessToken||ve)):(we.path+=""+U+$,Re(we))},Se.prototype.normalizeTileURL=function(L,U){if(this._isSkuTokenExpired()&&this._createSkuToken(),L&&!De(L))return L;var $=Be(L),ve=/(\.(png|jpg)\d*)(?=$)/,we=/^.+\/v4\//,Me=q.devicePixelRatio>=2||U===512?"@2x":"",Oe=le.supported?".webp":"$1";$.path=$.path.replace(ve,""+Me+Oe),$.path=$.path.replace(we,"/"),$.path="/v4"+$.path;var tt=this._customAccessToken||He($.params)||ae.ACCESS_TOKEN;return ae.REQUIRE_ACCESS_TOKEN&&tt&&this._skuToken&&$.params.push("sku="+this._skuToken),this._makeAPIURL($,tt)},Se.prototype.canonicalizeTileURL=function(L,U){var $="/v4/",ve=/\.[\w]+$/,we=Be(L);if(!we.path.match(/(^\/v4\/)/)||!we.path.match(ve))return L;var Me="mapbox://tiles/";Me+=we.path.replace($,"");var Oe=we.params;return U&&(Oe=Oe.filter(function(tt){return!tt.match(/^access_token=/)})),Oe.length&&(Me+="?"+Oe.join("&")),Me},Se.prototype.canonicalizeTileset=function(L,U){for(var $=U?De(U):!1,ve=[],we=0,Me=L.tiles||[];we<Me.length;we+=1){var Oe=Me[we];Te(Oe)?ve.push(this.canonicalizeTileURL(Oe,$)):ve.push(Oe)}return ve},Se.prototype._makeAPIURL=function(L,U){var $="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",ve=Be(ae.API_URL);if(L.protocol=ve.protocol,L.authority=ve.authority,ve.path!=="/"&&(L.path=""+ve.path+L.path),!ae.REQUIRE_ACCESS_TOKEN)return Re(L);if(U=U||ae.ACCESS_TOKEN,!U)throw new Error("An API access token is required to use Mapbox GL. "+$);if(U[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+$);return L.params=L.params.filter(function(we){return we.indexOf("access_token")===-1}),L.params.push("access_token="+U),Re(L)};function De(D){return D.indexOf("mapbox:")===0}var Ie=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Te(D){return Ie.test(D)}function Ce(D){return D.indexOf("sku=")>0&&Te(D)}function He(D){for(var L=0,U=D;L<U.length;L+=1){var $=U[L],ve=$.match(/^access_token=(.*)$/);if(ve)return ve[1]}return null}var Xe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Be(D){var L=D.match(Xe);if(!L)throw new Error("Unable to parse URL object");return{protocol:L[1],authority:L[2],path:L[3]||"/",params:L[4]?L[4].split("&"):[]}}function Re(D){var L=D.params.length?"?"+D.params.join("&"):"";return D.protocol+"://"+D.authority+D.path+L}var We="mapbox.eventData";function vt(D){if(!D)return null;var L=D.split(".");if(!L||L.length!==3)return null;try{var U=JSON.parse(te(L[1]));return U}catch{return null}}var Pt=function(L){this.type=L,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Pt.prototype.getStorageKey=function(L){var U=vt(ae.ACCESS_TOKEN),$="";return U&&U.u?$=K(U.u):$=ae.ACCESS_TOKEN||"",L?We+"."+L+":"+$:We+":"+$},Pt.prototype.fetchEventData=function(){var L=ue("localStorage"),U=this.getStorageKey(),$=this.getStorageKey("uuid");if(L)try{var ve=self.localStorage.getItem(U);ve&&(this.eventData=JSON.parse(ve));var we=self.localStorage.getItem($);we&&(this.anonId=we)}catch{O("Unable to read from LocalStorage")}},Pt.prototype.saveEventData=function(){var L=ue("localStorage"),U=this.getStorageKey(),$=this.getStorageKey("uuid");if(L)try{self.localStorage.setItem($,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(U,JSON.stringify(this.eventData))}catch{O("Unable to write to LocalStorage")}},Pt.prototype.processRequests=function(L){},Pt.prototype.postEvent=function(L,U,$,ve){var we=this;if(!!ae.EVENTS_URL){var Me=Be(ae.EVENTS_URL);Me.params.push("access_token="+(ve||ae.ACCESS_TOKEN||""));var Oe={event:this.type,created:new Date(L).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:n,skuId:me,userId:this.anonId},tt=U?M(Oe,U):Oe,pt={url:Re(Me),headers:{"Content-Type":"text/plain"},body:JSON.stringify([tt])};this.pendingRequest=St(pt,function(gt){we.pendingRequest=null,$(gt),we.saveEventData(),we.processRequests(ve)})}},Pt.prototype.queueRequest=function(L,U){this.queue.push(L),this.processRequests(U)};var Zt=function(D){function L(){D.call(this,"map.load"),this.success={},this.skuToken=""}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.postMapLoadEvent=function($,ve,we,Me){this.skuToken=we,(ae.EVENTS_URL&&Me||ae.ACCESS_TOKEN&&Array.isArray($)&&$.some(function(Oe){return De(Oe)||Te(Oe)}))&&this.queueRequest({id:ve,timestamp:Date.now()},Me)},L.prototype.processRequests=function($){var ve=this;if(!(this.pendingRequest||this.queue.length===0)){var we=this.queue.shift(),Me=we.id,Oe=we.timestamp;Me&&this.success[Me]||(this.anonId||this.fetchEventData(),C(this.anonId)||(this.anonId=d()),this.postEvent(Oe,{skuToken:this.skuToken},function(tt){tt||Me&&(ve.success[Me]=!0)},$))}},L}(Pt),zt=function(D){function L(U){D.call(this,"appUserTurnstile"),this._customAccessToken=U}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.postTurnstileEvent=function($,ve){ae.EVENTS_URL&&ae.ACCESS_TOKEN&&Array.isArray($)&&$.some(function(we){return De(we)||Te(we)})&&this.queueRequest(Date.now(),ve)},L.prototype.processRequests=function($){var ve=this;if(!(this.pendingRequest||this.queue.length===0)){(!this.anonId||!this.eventData.lastSuccess||!this.eventData.tokenU)&&this.fetchEventData();var we=vt(ae.ACCESS_TOKEN),Me=we?we.u:ae.ACCESS_TOKEN,Oe=Me!==this.eventData.tokenU;C(this.anonId)||(this.anonId=d(),Oe=!0);var tt=this.queue.shift();if(this.eventData.lastSuccess){var pt=new Date(this.eventData.lastSuccess),gt=new Date(tt),Nt=(tt-this.eventData.lastSuccess)/(24*60*60*1e3);Oe=Oe||Nt>=1||Nt<-1||pt.getDate()!==gt.getDate()}else Oe=!0;if(!Oe)return this.processRequests();this.postEvent(tt,{"enabled.telemetry":!1},function(nr){nr||(ve.eventData.lastSuccess=tt,ve.eventData.tokenU=Me)},$)}},L}(Pt),At=new zt,Wt=At.postTurnstileEvent.bind(At),Bt=new Zt,Ct=Bt.postMapLoadEvent.bind(Bt),Ze="mapbox-tiles",nt=500,Ye=50,Ee=1e3*60*7,Ge;function Je(){self.caches&&!Ge&&(Ge=self.caches.open(Ze))}var qe;function Tt(D,L){if(qe===void 0)try{new Response(new ReadableStream),qe=!0}catch{qe=!1}qe?L(D.body):D.blob().then(L)}function mt(D,L,U){if(Je(),!!Ge){var $={status:L.status,statusText:L.statusText,headers:new self.Headers};L.headers.forEach(function(Me,Oe){return $.headers.set(Oe,Me)});var ve=Z(L.headers.get("Cache-Control")||"");if(!ve["no-store"]){ve["max-age"]&&$.headers.set("Expires",new Date(U+ve["max-age"]*1e3).toUTCString());var we=new Date($.headers.get("Expires")).getTime()-U;we<Ee||Tt(L,function(Me){var Oe=new self.Response(Me,$);Je(),Ge&&Ge.then(function(tt){return tt.put(Mt(D.url),Oe)}).catch(function(tt){return O(tt.message)})})}}}function Mt(D){var L=D.indexOf("?");return L<0?D:D.slice(0,L)}function Ht(D,L){if(Je(),!Ge)return L(null);var U=Mt(D.url);Ge.then(function($){$.match(U).then(function(ve){var we=Rt(ve);$.delete(U),we&&$.put(U,ve.clone()),L(null,ve,we)}).catch(L)}).catch(L)}function Rt(D){if(!D)return!1;var L=new Date(D.headers.get("Expires")||0),U=Z(D.headers.get("Cache-Control")||"");return L>Date.now()&&!U["no-cache"]}var Vt=1/0;function Jt(D){Vt++,Vt>Ye&&(D.getActor().send("enforceCacheSizeLimit",nt),Vt=0)}function Yt(D){Je(),Ge&&Ge.then(function(L){L.keys().then(function(U){for(var $=0;$<U.length-D;$++)L.delete(U[$])})})}function or(D){var L=self.caches.delete(Ze);D&&L.catch(D).then(function(){return D()})}function Hr(D,L){nt=D,Ye=L}var an;function Kr(){return an==null&&(an=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),an}var ot={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ot);var er=function(D){function L(U,$,ve){$===401&&Te(ve)&&(U+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),D.call(this,U),this.status=$,this.url=ve,this.name=this.constructor.name,this.message=U}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},L}(Error),Kt=j()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href},ur=function(D){return/^file:/.test(D)||/^file:/.test(Kt())&&!/^\w+:/.test(D)};function Ar(D,L){var U=new self.AbortController,$=new self.Request(D.url,{method:D.method||"GET",body:D.body,credentials:D.credentials,headers:D.headers,referrer:Kt(),signal:U.signal}),ve=!1,we=!1,Me=Ce($.url);D.type==="json"&&$.headers.set("Accept","application/json");var Oe=function(pt,gt,Nt){if(!we){if(pt&&pt.message!=="SecurityError"&&O(pt),gt&&Nt)return tt(gt);var nr=Date.now();self.fetch($).then(function(qt){if(qt.ok){var yr=Me?qt.clone():null;return tt(qt,yr,nr)}else return L(new er(qt.statusText,qt.status,D.url))}).catch(function(qt){qt.code!==20&&L(new Error(qt.message))})}},tt=function(pt,gt,Nt){(D.type==="arrayBuffer"?pt.arrayBuffer():D.type==="json"?pt.json():pt.text()).then(function(nr){we||(gt&&Nt&&mt($,gt,Nt),ve=!0,L(null,nr,pt.headers.get("Cache-Control"),pt.headers.get("Expires")))}).catch(function(nr){we||L(new Error(nr.message))})};return Me?Ht($,Oe):Oe(null,null),{cancel:function(){we=!0,ve||U.abort()}}}function et(D,L){var U=new self.XMLHttpRequest;U.open(D.method||"GET",D.url,!0),D.type==="arrayBuffer"&&(U.responseType="arraybuffer");for(var $ in D.headers)U.setRequestHeader($,D.headers[$]);return D.type==="json"&&(U.responseType="text",U.setRequestHeader("Accept","application/json")),U.withCredentials=D.credentials==="include",U.onerror=function(){L(new Error(U.statusText))},U.onload=function(){if((U.status>=200&&U.status<300||U.status===0)&&U.response!==null){var ve=U.response;if(D.type==="json")try{ve=JSON.parse(U.response)}catch(we){return L(we)}L(null,ve,U.getResponseHeader("Cache-Control"),U.getResponseHeader("Expires"))}else L(new er(U.statusText,U.status,D.url))},U.send(D.body),{cancel:function(){return U.abort()}}}var $e=function(D,L){if(!ur(D.url)){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return Ar(D,L);if(j()&&self.worker&&self.worker.actor){var U=!0;return self.worker.actor.send("getResource",D,L,void 0,U)}}return et(D,L)},st=function(D,L){return $e(M(D,{type:"json"}),L)},ft=function(D,L){return $e(M(D,{type:"arrayBuffer"}),L)},St=function(D,L){return $e(M(D,{method:"POST"}),L)};function Ut(D){var L=self.document.createElement("a");return L.href=D,L.protocol===self.document.location.protocol&&L.host===self.document.location.host}var Pe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function ke(D,L,U,$){var ve=new self.Image,we=self.URL;ve.onload=function(){L(null,ve),we.revokeObjectURL(ve.src)},ve.onerror=function(){return L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Me=new self.Blob([new Uint8Array(D)],{type:"image/png"});ve.cacheControl=U,ve.expires=$,ve.src=D.byteLength?we.createObjectURL(Me):Pe}function it(D,L){var U=new self.Blob([new Uint8Array(D)],{type:"image/png"});self.createImageBitmap(U).then(function($){L(null,$)}).catch(function($){L(new Error("Could not load image because of "+$.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}var ut,ht,Et=function(){ut=[],ht=0};Et();var yt=function(D,L){if(le.supported&&(D.headers||(D.headers={}),D.headers.accept="image/webp,*/*"),ht>=ae.MAX_PARALLEL_IMAGE_REQUESTS){var U={requestParameters:D,callback:L,cancelled:!1,cancel:function(){this.cancelled=!0}};return ut.push(U),U}ht++;var $=!1,ve=function(){if(!$)for($=!0,ht--;ut.length&&ht<ae.MAX_PARALLEL_IMAGE_REQUESTS;){var Me=ut.shift(),Oe=Me.requestParameters,tt=Me.callback,pt=Me.cancelled;pt||(Me.cancel=yt(Oe,tt).cancel)}},we=ft(D,function(Me,Oe,tt,pt){ve(),Me?L(Me):Oe&&(Kr()?it(Oe,L):ke(Oe,L,tt,pt))});return{cancel:function(){we.cancel(),ve()}}},Dt=function(D,L){var U=self.document.createElement("video");U.muted=!0,U.onloadstart=function(){L(null,U)};for(var $=0;$<D.length;$++){var ve=self.document.createElement("source");Ut(D[$])||(U.crossOrigin="Anonymous"),ve.src=D[$],U.appendChild(ve)}return{cancel:function(){}}};function Xt(D,L,U){var $=U[D]&&U[D].indexOf(L)!==-1;$||(U[D]=U[D]||[],U[D].push(L))}function ar(D,L,U){if(U&&U[D]){var $=U[D].indexOf(L);$!==-1&&U[D].splice($,1)}}var kr=function(L,U){U===void 0&&(U={}),M(this,U),this.type=L},wr=function(D){function L(U,$){$===void 0&&($={}),D.call(this,"error",M({error:U},$))}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L}(kr),Sr=function(){};Sr.prototype.on=function(L,U){return this._listeners=this._listeners||{},Xt(L,U,this._listeners),this},Sr.prototype.off=function(L,U){return ar(L,U,this._listeners),ar(L,U,this._oneTimeListeners),this},Sr.prototype.once=function(L,U){return this._oneTimeListeners=this._oneTimeListeners||{},Xt(L,U,this._oneTimeListeners),this},Sr.prototype.fire=function(L,U){typeof L=="string"&&(L=new kr(L,U||{}));var $=L.type;if(this.listens($)){L.target=this;for(var ve=this._listeners&&this._listeners[$]?this._listeners[$].slice():[],we=0,Me=ve;we<Me.length;we+=1){var Oe=Me[we];Oe.call(this,L)}for(var tt=this._oneTimeListeners&&this._oneTimeListeners[$]?this._oneTimeListeners[$].slice():[],pt=0,gt=tt;pt<gt.length;pt+=1){var Nt=gt[pt];ar($,Nt,this._oneTimeListeners),Nt.call(this,L)}var nr=this._eventedParent;nr&&(M(L,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),nr.fire(L))}else L instanceof wr&&console.error(L.error);return this},Sr.prototype.listens=function(L){return this._listeners&&this._listeners[L]&&this._listeners[L].length>0||this._oneTimeListeners&&this._oneTimeListeners[L]&&this._oneTimeListeners[L].length>0||this._eventedParent&&this._eventedParent.listens(L)},Sr.prototype.setEventedParent=function(L,U){return this._eventedParent=L,this._eventedParentData=U,this};var Zr=8,ir={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},xr={"*":{type:"source"}},Fr=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],Or={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},Cr={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},at={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},Ft={type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},jt={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},sr={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},zr={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Ur=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Dr={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Tr={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Wr={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},An={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},vn={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Un={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Dn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Xn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Yn={type:"array",value:"*"},ya={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},Ca={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},gi={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},Xa={type:"array",value:"*",minimum:1},$a={type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},Ja={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},Mr=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],gn={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},hn={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},Sn={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},Jn={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ha={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},ra={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},In={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},jn={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Ga={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},vi={"*":{type:"string"}},Gt={$version:Zr,$root:ir,sources:xr,source:Fr,source_vector:Or,source_raster:Cr,source_raster_dem:at,source_geojson:Ft,source_video:jt,source_image:sr,layer:zr,layout:Ur,layout_background:Dr,layout_fill:Tr,layout_circle:Wr,layout_heatmap:An,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:vn,layout_symbol:Un,layout_raster:Dn,layout_hillshade:Xn,filter:Yn,filter_operator:ya,geometry_type:Ca,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:gi,expression:Xa,expression_name:$a,light:Ja,paint:Mr,paint_fill:gn,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:hn,paint_circle:Sn,paint_heatmap:Jn,paint_symbol:ha,paint_raster:ra,paint_hillshade:In,paint_background:jn,transition:Ga,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:vi},pr=function(L,U,$,ve){this.message=(L?L+": ":"")+$,ve&&(this.identifier=ve),U!=null&&U.__line__&&(this.line=U.__line__)};function on(D){var L=D.key,U=D.value;return U?[new pr(L,U,"constants have been deprecated as of v8")]:[]}function dn(D){for(var L=[],U=arguments.length-1;U-- >0;)L[U]=arguments[U+1];for(var $=0,ve=L;$<ve.length;$+=1){var we=ve[$];for(var Me in we)D[Me]=we[Me]}return D}function rn(D){return D instanceof Number||D instanceof String||D instanceof Boolean?D.valueOf():D}function Mn(D){if(Array.isArray(D))return D.map(Mn);if(D instanceof Object&&!(D instanceof Number||D instanceof String||D instanceof Boolean)){var L={};for(var U in D)L[U]=Mn(D[U]);return L}return rn(D)}var _n=function(D){function L(U,$){D.call(this,$),this.message=$,this.key=U}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L}(Error),cn=function(L,U){U===void 0&&(U=[]),this.parent=L,this.bindings={};for(var $=0,ve=U;$<ve.length;$+=1){var we=ve[$],Me=we[0],Oe=we[1];this.bindings[Me]=Oe}};cn.prototype.concat=function(L){return new cn(this,L)},cn.prototype.get=function(L){if(this.bindings[L])return this.bindings[L];if(this.parent)return this.parent.get(L);throw new Error(L+" not found in scope.")},cn.prototype.has=function(L){return this.bindings[L]?!0:this.parent?this.parent.has(L):!1};var mr={kind:"null"},br={kind:"number"},Br={kind:"string"},mn={kind:"boolean"},On={kind:"color"},na={kind:"object"},Tn={kind:"value"},Kn={kind:"error"},oa={kind:"collator"},ma={kind:"formatted"},_a={kind:"resolvedImage"};function ua(D,L){return{kind:"array",itemType:D,N:L}}function Ea(D){if(D.kind==="array"){var L=Ea(D.itemType);return typeof D.N=="number"?"array<"+L+", "+D.N+">":D.itemType.kind==="value"?"array":"array<"+L+">"}else return D.kind}var Mo=[mr,br,Br,mn,On,ma,na,ua(Tn),_a];function jo(D,L){if(L.kind==="error")return null;if(D.kind==="array"){if(L.kind==="array"&&(L.N===0&&L.itemType.kind==="value"||!jo(D.itemType,L.itemType))&&(typeof D.N!="number"||D.N===L.N))return null}else{if(D.kind===L.kind)return null;if(D.kind==="value")for(var U=0,$=Mo;U<$.length;U+=1){var ve=$[U];if(!jo(ve,L))return null}}return"Expected "+Ea(D)+" but found "+Ea(L)+" instead."}function vs(D,L){return L.some(function(U){return U.kind===D.kind})}function El(D,L){return L.some(function(U){return U==="null"?D===null:U==="array"?Array.isArray(D):U==="object"?D&&!Array.isArray(D)&&typeof D=="object":U===typeof D})}var Ol=i(function(D,L){var U={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function $(pt){return pt=Math.round(pt),pt<0?0:pt>255?255:pt}function ve(pt){return pt<0?0:pt>1?1:pt}function we(pt){return pt[pt.length-1]==="%"?$(parseFloat(pt)/100*255):$(parseInt(pt))}function Me(pt){return pt[pt.length-1]==="%"?ve(parseFloat(pt)/100):ve(parseFloat(pt))}function Oe(pt,gt,Nt){return Nt<0?Nt+=1:Nt>1&&(Nt-=1),Nt*6<1?pt+(gt-pt)*Nt*6:Nt*2<1?gt:Nt*3<2?pt+(gt-pt)*(2/3-Nt)*6:pt}function tt(pt){var gt=pt.replace(/ /g,"").toLowerCase();if(gt in U)return U[gt].slice();if(gt[0]==="#"){if(gt.length===4){var Nt=parseInt(gt.substr(1),16);return Nt>=0&&Nt<=4095?[(Nt&3840)>>4|(Nt&3840)>>8,Nt&240|(Nt&240)>>4,Nt&15|(Nt&15)<<4,1]:null}else if(gt.length===7){var Nt=parseInt(gt.substr(1),16);return Nt>=0&&Nt<=16777215?[(Nt&16711680)>>16,(Nt&65280)>>8,Nt&255,1]:null}return null}var nr=gt.indexOf("("),qt=gt.indexOf(")");if(nr!==-1&&qt+1===gt.length){var yr=gt.substr(0,nr),Nr=gt.substr(nr+1,qt-(nr+1)).split(","),ln=1;switch(yr){case"rgba":if(Nr.length!==4)return null;ln=Me(Nr.pop());case"rgb":return Nr.length!==3?null:[we(Nr[0]),we(Nr[1]),we(Nr[2]),ln];case"hsla":if(Nr.length!==4)return null;ln=Me(Nr.pop());case"hsl":if(Nr.length!==3)return null;var en=(parseFloat(Nr[0])%360+360)%360/360,kn=Me(Nr[1]),bn=Me(Nr[2]),Cn=bn<=.5?bn*(kn+1):bn+kn-bn*kn,zn=bn*2-Cn;return[$(Oe(zn,Cn,en+1/3)*255),$(Oe(zn,Cn,en)*255),$(Oe(zn,Cn,en-1/3)*255),ln];default:return null}}return null}try{L.parseCSSColor=tt}catch{}}),mu=Ol.parseCSSColor,bi=function(L,U,$,ve){ve===void 0&&(ve=1),this.r=L,this.g=U,this.b=$,this.a=ve};bi.parse=function(L){if(!!L){if(L instanceof bi)return L;if(typeof L=="string"){var U=mu(L);if(!!U)return new bi(U[0]/255*U[3],U[1]/255*U[3],U[2]/255*U[3],U[3])}}},bi.prototype.toString=function(){var L=this.toArray(),U=L[0],$=L[1],ve=L[2],we=L[3];return"rgba("+Math.round(U)+","+Math.round($)+","+Math.round(ve)+","+we+")"},bi.prototype.toArray=function(){var L=this,U=L.r,$=L.g,ve=L.b,we=L.a;return we===0?[0,0,0,0]:[U*255/we,$*255/we,ve*255/we,we]},bi.black=new bi(0,0,0,1),bi.white=new bi(1,1,1,1),bi.transparent=new bi(0,0,0,0),bi.red=new bi(1,0,0,1);var cl=function(L,U,$){L?this.sensitivity=U?"variant":"case":this.sensitivity=U?"accent":"base",this.locale=$,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};cl.prototype.compare=function(L,U){return this.collator.compare(L,U)},cl.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var $s=function(L,U,$,ve,we){this.text=L,this.image=U,this.scale=$,this.fontStack=ve,this.textColor=we},Ki=function(L){this.sections=L};Ki.fromString=function(L){return new Ki([new $s(L,null,null,null,null)])},Ki.prototype.isEmpty=function(){return this.sections.length===0?!0:!this.sections.some(function(L){return L.text.length!==0||L.image&&L.image.name.length!==0})},Ki.factory=function(L){return L instanceof Ki?L:Ki.fromString(L)},Ki.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(L){return L.text}).join("")},Ki.prototype.serialize=function(){for(var L=["format"],U=0,$=this.sections;U<$.length;U+=1){var ve=$[U];if(ve.image){L.push(["image",ve.image.name]);continue}L.push(ve.text);var we={};ve.fontStack&&(we["text-font"]=["literal",ve.fontStack.split(",")]),ve.scale&&(we["font-scale"]=ve.scale),ve.textColor&&(we["text-color"]=["rgba"].concat(ve.textColor.toArray())),L.push(we)}return L};var No=function(L){this.name=L.name,this.available=L.available};No.prototype.toString=function(){return this.name},No.fromString=function(L){return L?new No({name:L,available:!1}):null},No.prototype.serialize=function(){return["image",this.name]};function Ul(D,L,U,$){if(!(typeof D=="number"&&D>=0&&D<=255&&typeof L=="number"&&L>=0&&L<=255&&typeof U=="number"&&U>=0&&U<=255)){var ve=typeof $=="number"?[D,L,U,$]:[D,L,U];return"Invalid rgba value ["+ve.join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}return typeof $>"u"||typeof $=="number"&&$>=0&&$<=1?null:"Invalid rgba value ["+[D,L,U,$].join(", ")+"]: 'a' must be between 0 and 1."}function Ps(D){if(D===null)return!0;if(typeof D=="string")return!0;if(typeof D=="boolean")return!0;if(typeof D=="number")return!0;if(D instanceof bi)return!0;if(D instanceof cl)return!0;if(D instanceof Ki)return!0;if(D instanceof No)return!0;if(Array.isArray(D)){for(var L=0,U=D;L<U.length;L+=1){var $=U[L];if(!Ps($))return!1}return!0}else if(typeof D=="object"){for(var ve in D)if(!Ps(D[ve]))return!1;return!0}else return!1}function Vi(D){if(D===null)return mr;if(typeof D=="string")return Br;if(typeof D=="boolean")return mn;if(typeof D=="number")return br;if(D instanceof bi)return On;if(D instanceof cl)return oa;if(D instanceof Ki)return ma;if(D instanceof No)return _a;if(Array.isArray(D)){for(var L=D.length,U,$=0,ve=D;$<ve.length;$+=1){var we=ve[$],Me=Vi(we);if(!U)U=Me;else{if(U===Me)continue;U=Tn;break}}return ua(U||Tn,L)}else return na}function Cl(D){var L=typeof D;return D===null?"":L==="string"||L==="number"||L==="boolean"?String(D):D instanceof bi||D instanceof Ki||D instanceof No?D.toString():JSON.stringify(D)}var io=function(L,U){this.type=L,this.value=U};io.parse=function(L,U){if(L.length!==2)return U.error("'literal' expression requires exactly one argument, but found "+(L.length-1)+" instead.");if(!Ps(L[1]))return U.error("invalid value");var $=L[1],ve=Vi($),we=U.expectedType;return ve.kind==="array"&&ve.N===0&&we&&we.kind==="array"&&(typeof we.N!="number"||we.N===0)&&(ve=we),new io(ve,$)},io.prototype.evaluate=function(){return this.value},io.prototype.eachChild=function(){},io.prototype.outputDefined=function(){return!0},io.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof bi?["rgba"].concat(this.value.toArray()):this.value instanceof Ki?this.value.serialize():this.value};var Wi=function(L){this.name="ExpressionEvaluationError",this.message=L};Wi.prototype.toJSON=function(){return this.message};var vo={string:Br,number:br,boolean:mn,object:na},oo=function(L,U){this.type=L,this.args=U};oo.parse=function(L,U){if(L.length<2)return U.error("Expected at least one argument.");var $=1,ve,we=L[0];if(we==="array"){var Me;if(L.length>2){var Oe=L[1];if(typeof Oe!="string"||!(Oe in vo)||Oe==="object")return U.error('The item type argument of "array" must be one of string, number, boolean',1);Me=vo[Oe],$++}else Me=Tn;var tt;if(L.length>3){if(L[2]!==null&&(typeof L[2]!="number"||L[2]<0||L[2]!==Math.floor(L[2])))return U.error('The length argument to "array" must be a positive integer literal',2);tt=L[2],$++}ve=ua(Me,tt)}else ve=vo[we];for(var pt=[];$<L.length;$++){var gt=U.parse(L[$],$,Tn);if(!gt)return null;pt.push(gt)}return new oo(ve,pt)},oo.prototype.evaluate=function(L){for(var U=0;U<this.args.length;U++){var $=this.args[U].evaluate(L),ve=jo(this.type,Vi($));if(ve){if(U===this.args.length-1)throw new Wi("Expected value to be of type "+Ea(this.type)+", but found "+Ea(Vi($))+" instead.")}else return $}return null},oo.prototype.eachChild=function(L){this.args.forEach(L)},oo.prototype.outputDefined=function(){return this.args.every(function(L){return L.outputDefined()})},oo.prototype.serialize=function(){var L=this.type,U=[L.kind];if(L.kind==="array"){var $=L.itemType;if($.kind==="string"||$.kind==="number"||$.kind==="boolean"){U.push($.kind);var ve=L.N;(typeof ve=="number"||this.args.length>1)&&U.push(ve)}}return U.concat(this.args.map(function(we){return we.serialize()}))};var bs=function(L){this.type=ma,this.sections=L};bs.parse=function(L,U){if(L.length<2)return U.error("Expected at least one argument.");var $=L[1];if(!Array.isArray($)&&typeof $=="object")return U.error("First argument must be an image or text section.");for(var ve=[],we=!1,Me=1;Me<=L.length-1;++Me){var Oe=L[Me];if(we&&typeof Oe=="object"&&!Array.isArray(Oe)){we=!1;var tt=null;if(Oe["font-scale"]&&(tt=U.parse(Oe["font-scale"],1,br),!tt))return null;var pt=null;if(Oe["text-font"]&&(pt=U.parse(Oe["text-font"],1,ua(Br)),!pt))return null;var gt=null;if(Oe["text-color"]&&(gt=U.parse(Oe["text-color"],1,On),!gt))return null;var Nt=ve[ve.length-1];Nt.scale=tt,Nt.font=pt,Nt.textColor=gt}else{var nr=U.parse(L[Me],1,Tn);if(!nr)return null;var qt=nr.type.kind;if(qt!=="string"&&qt!=="value"&&qt!=="null"&&qt!=="resolvedImage")return U.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");we=!0,ve.push({content:nr,scale:null,font:null,textColor:null})}}return new bs(ve)},bs.prototype.evaluate=function(L){var U=function($){var ve=$.content.evaluate(L);return Vi(ve)===_a?new $s("",ve,null,null,null):new $s(Cl(ve),null,$.scale?$.scale.evaluate(L):null,$.font?$.font.evaluate(L).join(","):null,$.textColor?$.textColor.evaluate(L):null)};return new Ki(this.sections.map(U))},bs.prototype.eachChild=function(L){for(var U=0,$=this.sections;U<$.length;U+=1){var ve=$[U];L(ve.content),ve.scale&&L(ve.scale),ve.font&&L(ve.font),ve.textColor&&L(ve.textColor)}},bs.prototype.outputDefined=function(){return!1},bs.prototype.serialize=function(){for(var L=["format"],U=0,$=this.sections;U<$.length;U+=1){var ve=$[U];L.push(ve.content.serialize());var we={};ve.scale&&(we["font-scale"]=ve.scale.serialize()),ve.font&&(we["text-font"]=ve.font.serialize()),ve.textColor&&(we["text-color"]=ve.textColor.serialize()),L.push(we)}return L};var hl=function(L){this.type=_a,this.input=L};hl.parse=function(L,U){if(L.length!==2)return U.error("Expected two arguments.");var $=U.parse(L[1],1,Br);return $?new hl($):U.error("No image name provided.")},hl.prototype.evaluate=function(L){var U=this.input.evaluate(L),$=No.fromString(U);return $&&L.availableImages&&($.available=L.availableImages.indexOf(U)>-1),$},hl.prototype.eachChild=function(L){L(this.input)},hl.prototype.outputDefined=function(){return!1},hl.prototype.serialize=function(){return["image",this.input.serialize()]};var Ru={"to-boolean":mn,"to-color":On,"to-number":br,"to-string":Br},ps=function(L,U){this.type=L,this.args=U};ps.parse=function(L,U){if(L.length<2)return U.error("Expected at least one argument.");var $=L[0];if(($==="to-boolean"||$==="to-string")&&L.length!==2)return U.error("Expected one argument.");for(var ve=Ru[$],we=[],Me=1;Me<L.length;Me++){var Oe=U.parse(L[Me],Me,Tn);if(!Oe)return null;we.push(Oe)}return new ps(ve,we)},ps.prototype.evaluate=function(L){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(L));if(this.type.kind==="color"){for(var U,$,ve=0,we=this.args;ve<we.length;ve+=1){var Me=we[ve];if(U=Me.evaluate(L),$=null,U instanceof bi)return U;if(typeof U=="string"){var Oe=L.parseColor(U);if(Oe)return Oe}else if(Array.isArray(U)&&(U.length<3||U.length>4?$="Invalid rbga value "+JSON.stringify(U)+": expected an array containing either three or four numeric values.":$=Ul(U[0],U[1],U[2],U[3]),!$))return new bi(U[0]/255,U[1]/255,U[2]/255,U[3])}throw new Wi($||"Could not parse color from value '"+(typeof U=="string"?U:String(JSON.stringify(U)))+"'")}else if(this.type.kind==="number"){for(var tt=null,pt=0,gt=this.args;pt<gt.length;pt+=1){var Nt=gt[pt];if(tt=Nt.evaluate(L),tt===null)return 0;var nr=Number(tt);if(!isNaN(nr))return nr}throw new Wi("Could not convert "+JSON.stringify(tt)+" to number.")}else return this.type.kind==="formatted"?Ki.fromString(Cl(this.args[0].evaluate(L))):this.type.kind==="resolvedImage"?No.fromString(Cl(this.args[0].evaluate(L))):Cl(this.args[0].evaluate(L))},ps.prototype.eachChild=function(L){this.args.forEach(L)},ps.prototype.outputDefined=function(){return this.args.every(function(L){return L.outputDefined()})},ps.prototype.serialize=function(){if(this.type.kind==="formatted")return new bs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new hl(this.args[0]).serialize();var L=["to-"+this.type.kind];return this.eachChild(function(U){L.push(U.serialize())}),L};var Iu=["Unknown","Point","LineString","Polygon"],qs=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};qs.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},qs.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Iu[this.feature.type]:this.feature.type:null},qs.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},qs.prototype.canonicalID=function(){return this.canonical},qs.prototype.properties=function(){return this.feature&&this.feature.properties||{}},qs.prototype.parseColor=function(L){var U=this._parseColorCache[L];return U||(U=this._parseColorCache[L]=bi.parse(L)),U};var Oo=function(L,U,$,ve){this.name=L,this.type=U,this._evaluate=$,this.args=ve};Oo.prototype.evaluate=function(L){return this._evaluate(L,this.args)},Oo.prototype.eachChild=function(L){this.args.forEach(L)},Oo.prototype.outputDefined=function(){return!1},Oo.prototype.serialize=function(){return[this.name].concat(this.args.map(function(L){return L.serialize()}))},Oo.parse=function(L,U){var $,ve=L[0],we=Oo.definitions[ve];if(!we)return U.error('Unknown expression "'+ve+'". If you wanted a literal array, use ["literal", [...]].',0);for(var Me=Array.isArray(we)?we[0]:we.type,Oe=Array.isArray(we)?[[we[1],we[2]]]:we.overloads,tt=Oe.filter(function(Fa){var Ia=Fa[0];return!Array.isArray(Ia)||Ia.length===L.length-1}),pt=null,gt=0,Nt=tt;gt<Nt.length;gt+=1){var nr=Nt[gt],qt=nr[0],yr=nr[1];pt=new Uo(U.registry,U.path,null,U.scope);for(var Nr=[],ln=!1,en=1;en<L.length;en++){var kn=L[en],bn=Array.isArray(qt)?qt[en-1]:qt.type,Cn=pt.parse(kn,1+Nr.length,bn);if(!Cn){ln=!0;break}Nr.push(Cn)}if(!ln){if(Array.isArray(qt)&&qt.length!==Nr.length){pt.error("Expected "+qt.length+" arguments, but found "+Nr.length+" instead.");continue}for(var zn=0;zn<Nr.length;zn++){var Wn=Array.isArray(qt)?qt[zn]:qt.type,la=Nr[zn];pt.concat(zn+1).checkSubtype(Wn,la.type)}if(pt.errors.length===0)return new Oo(ve,Me,yr,Nr)}}if(tt.length===1)($=U.errors).push.apply($,pt.errors);else{for(var ia=tt.length?tt:Oe,za=ia.map(function(Fa){var Ia=Fa[0];return lf(Ia)}).join(" | "),Ma=[],ka=1;ka<L.length;ka++){var ii=U.parse(L[ka],1+Ma.length);if(!ii)return null;Ma.push(Ea(ii.type))}U.error("Expected arguments of type "+za+", but found ("+Ma.join(", ")+") instead.")}return null},Oo.register=function(L,U){Oo.definitions=U;for(var $ in U)L[$]=Oo};function lf(D){return Array.isArray(D)?"("+D.map(Ea).join(", ")+")":"("+Ea(D.type)+"...)"}var el=function(L,U,$){this.type=oa,this.locale=$,this.caseSensitive=L,this.diacriticSensitive=U};el.parse=function(L,U){if(L.length!==2)return U.error("Expected one argument.");var $=L[1];if(typeof $!="object"||Array.isArray($))return U.error("Collator options argument must be an object.");var ve=U.parse($["case-sensitive"]===void 0?!1:$["case-sensitive"],1,mn);if(!ve)return null;var we=U.parse($["diacritic-sensitive"]===void 0?!1:$["diacritic-sensitive"],1,mn);if(!we)return null;var Me=null;return $.locale&&(Me=U.parse($.locale,1,Br),!Me)?null:new el(ve,we,Me)},el.prototype.evaluate=function(L){return new cl(this.caseSensitive.evaluate(L),this.diacriticSensitive.evaluate(L),this.locale?this.locale.evaluate(L):null)},el.prototype.eachChild=function(L){L(this.caseSensitive),L(this.diacriticSensitive),this.locale&&L(this.locale)},el.prototype.outputDefined=function(){return!1},el.prototype.serialize=function(){var L={};return L["case-sensitive"]=this.caseSensitive.serialize(),L["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(L.locale=this.locale.serialize()),["collator",L]};var Vs=8192;function nu(D,L){D[0]=Math.min(D[0],L[0]),D[1]=Math.min(D[1],L[1]),D[2]=Math.max(D[2],L[0]),D[3]=Math.max(D[3],L[1])}function uf(D){return(180+D)/360}function ff(D){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+D*Math.PI/360)))/360}function vl(D,L){return!(D[0]<=L[0]||D[2]>=L[2]||D[1]<=L[1]||D[3]>=L[3])}function au(D,L){var U=uf(D[0]),$=ff(D[1]),ve=Math.pow(2,L.z);return[Math.round(U*ve*Vs),Math.round($*ve*Vs)]}function Hs(D,L,U){var $=D[0]-L[0],ve=D[1]-L[1],we=D[0]-U[0],Me=D[1]-U[1];return $*Me-we*ve===0&&$*we<=0&&ve*Me<=0}function xu(D,L,U){return L[1]>D[1]!=U[1]>D[1]&&D[0]<(U[0]-L[0])*(D[1]-L[1])/(U[1]-L[1])+L[0]}function kl(D,L){for(var U=!1,$=0,ve=L.length;$<ve;$++)for(var we=L[$],Me=0,Oe=we.length;Me<Oe-1;Me++){if(Hs(D,we[Me],we[Me+1]))return!1;xu(D,we[Me],we[Me+1])&&(U=!U)}return U}function bu(D,L){for(var U=0;U<L.length;U++)if(kl(D,L[U]))return!0;return!1}function zu(D,L){return D[0]*L[1]-D[1]*L[0]}function iu(D,L,U,$){var ve=D[0]-U[0],we=D[1]-U[1],Me=L[0]-U[0],Oe=L[1]-U[1],tt=$[0]-U[0],pt=$[1]-U[1],gt=ve*pt-tt*we,Nt=Me*pt-tt*Oe;return gt>0&&Nt<0||gt<0&&Nt>0}function cf(D,L,U,$){var ve=[L[0]-D[0],L[1]-D[1]],we=[$[0]-U[0],$[1]-U[1]];return zu(we,ve)===0?!1:!!(iu(D,L,U,$)&&iu(U,$,D,L))}function pl(D,L,U){for(var $=0,ve=U;$<ve.length;$+=1)for(var we=ve[$],Me=0;Me<we.length-1;++Me)if(cf(D,L,we[Me],we[Me+1]))return!0;return!1}function _u(D,L){for(var U=0;U<D.length;++U)if(!kl(D[U],L))return!1;for(var $=0;$<D.length-1;++$)if(pl(D[$],D[$+1],L))return!1;return!0}function ou(D,L){for(var U=0;U<L.length;U++)if(_u(D,L[U]))return!0;return!1}function Fs(D,L,U){for(var $=[],ve=0;ve<D.length;ve++){for(var we=[],Me=0;Me<D[ve].length;Me++){var Oe=au(D[ve][Me],U);nu(L,Oe),we.push(Oe)}$.push(we)}return $}function Vl(D,L,U){for(var $=[],ve=0;ve<D.length;ve++){var we=Fs(D[ve],L,U);$.push(we)}return $}function wu(D,L,U,$){if(D[0]<U[0]||D[0]>U[2]){var ve=$*.5,we=D[0]-U[0]>ve?-$:U[0]-D[0]>ve?$:0;we===0&&(we=D[0]-U[2]>ve?-$:U[2]-D[0]>ve?$:0),D[0]+=we}nu(L,D)}function Bu(D){D[0]=D[1]=1/0,D[2]=D[3]=-1/0}function Nu(D,L,U,$){for(var ve=Math.pow(2,$.z)*Vs,we=[$.x*Vs,$.y*Vs],Me=[],Oe=0,tt=D;Oe<tt.length;Oe+=1)for(var pt=tt[Oe],gt=0,Nt=pt;gt<Nt.length;gt+=1){var nr=Nt[gt],qt=[nr.x+we[0],nr.y+we[1]];wu(qt,L,U,ve),Me.push(qt)}return Me}function su(D,L,U,$){for(var ve=Math.pow(2,$.z)*Vs,we=[$.x*Vs,$.y*Vs],Me=[],Oe=0,tt=D;Oe<tt.length;Oe+=1){for(var pt=tt[Oe],gt=[],Nt=0,nr=pt;Nt<nr.length;Nt+=1){var qt=nr[Nt],yr=[qt.x+we[0],qt.y+we[1]];nu(L,yr),gt.push(yr)}Me.push(gt)}if(L[2]-L[0]<=ve/2){Bu(L);for(var Nr=0,ln=Me;Nr<ln.length;Nr+=1)for(var en=ln[Nr],kn=0,bn=en;kn<bn.length;kn+=1){var Cn=bn[kn];wu(Cn,L,U,ve)}}return Me}function hf(D,L){var U=[1/0,1/0,-1/0,-1/0],$=[1/0,1/0,-1/0,-1/0],ve=D.canonicalID();if(L.type==="Polygon"){var we=Fs(L.coordinates,$,ve),Me=Nu(D.geometry(),U,$,ve);if(!vl(U,$))return!1;for(var Oe=0,tt=Me;Oe<tt.length;Oe+=1){var pt=tt[Oe];if(!kl(pt,we))return!1}}if(L.type==="MultiPolygon"){var gt=Vl(L.coordinates,$,ve),Nt=Nu(D.geometry(),U,$,ve);if(!vl(U,$))return!1;for(var nr=0,qt=Nt;nr<qt.length;nr+=1){var yr=qt[nr];if(!bu(yr,gt))return!1}}return!0}function Ou(D,L){var U=[1/0,1/0,-1/0,-1/0],$=[1/0,1/0,-1/0,-1/0],ve=D.canonicalID();if(L.type==="Polygon"){var we=Fs(L.coordinates,$,ve),Me=su(D.geometry(),U,$,ve);if(!vl(U,$))return!1;for(var Oe=0,tt=Me;Oe<tt.length;Oe+=1){var pt=tt[Oe];if(!_u(pt,we))return!1}}if(L.type==="MultiPolygon"){var gt=Vl(L.coordinates,$,ve),Nt=su(D.geometry(),U,$,ve);if(!vl(U,$))return!1;for(var nr=0,qt=Nt;nr<qt.length;nr+=1){var yr=qt[nr];if(!ou(yr,gt))return!1}}return!0}var ds=function(L,U){this.type=mn,this.geojson=L,this.geometries=U};ds.parse=function(L,U){if(L.length!==2)return U.error("'within' expression requires exactly one argument, but found "+(L.length-1)+" instead.");if(Ps(L[1])){var $=L[1];if($.type==="FeatureCollection")for(var ve=0;ve<$.features.length;++ve){var we=$.features[ve].geometry.type;if(we==="Polygon"||we==="MultiPolygon")return new ds($,$.features[ve].geometry)}else if($.type==="Feature"){var Me=$.geometry.type;if(Me==="Polygon"||Me==="MultiPolygon")return new ds($,$.geometry)}else if($.type==="Polygon"||$.type==="MultiPolygon")return new ds($,$)}return U.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ds.prototype.evaluate=function(L){if(L.geometry()!=null&&L.canonicalID()!=null){if(L.geometryType()==="Point")return hf(L,this.geometries);if(L.geometryType()==="LineString")return Ou(L,this.geometries)}return!1},ds.prototype.eachChild=function(){},ds.prototype.outputDefined=function(){return!0},ds.prototype.serialize=function(){return["within",this.geojson]};function Dl(D){if(D instanceof Oo){if(D.name==="get"&&D.args.length===1)return!1;if(D.name==="feature-state")return!1;if(D.name==="has"&&D.args.length===1)return!1;if(D.name==="properties"||D.name==="geometry-type"||D.name==="id")return!1;if(/^filter-/.test(D.name))return!1}if(D instanceof ds)return!1;var L=!0;return D.eachChild(function(U){L&&!Dl(U)&&(L=!1)}),L}function Ll(D){if(D instanceof Oo&&D.name==="feature-state")return!1;var L=!0;return D.eachChild(function(U){L&&!Ll(U)&&(L=!1)}),L}function Tu(D,L){if(D instanceof Oo&&L.indexOf(D.name)>=0)return!1;var U=!0;return D.eachChild(function($){U&&!Tu($,L)&&(U=!1)}),U}var Rs=function(L,U){this.type=U.type,this.name=L,this.boundExpression=U};Rs.parse=function(L,U){if(L.length!==2||typeof L[1]!="string")return U.error("'var' expression requires exactly one string literal argument.");var $=L[1];return U.scope.has($)?new Rs($,U.scope.get($)):U.error('Unknown variable "'+$+'". Make sure "'+$+'" has been bound in an enclosing "let" expression before using it.',1)},Rs.prototype.evaluate=function(L){return this.boundExpression.evaluate(L)},Rs.prototype.eachChild=function(){},Rs.prototype.outputDefined=function(){return!1},Rs.prototype.serialize=function(){return["var",this.name]};var Uo=function(L,U,$,ve,we){U===void 0&&(U=[]),ve===void 0&&(ve=new cn),we===void 0&&(we=[]),this.registry=L,this.path=U,this.key=U.map(function(Me){return"["+Me+"]"}).join(""),this.scope=ve,this.errors=we,this.expectedType=$};Uo.prototype.parse=function(L,U,$,ve,we){return we===void 0&&(we={}),U?this.concat(U,$,ve)._parse(L,we):this._parse(L,we)},Uo.prototype._parse=function(L,U){(L===null||typeof L=="string"||typeof L=="boolean"||typeof L=="number")&&(L=["literal",L]);function $(gt,Nt,nr){return nr==="assert"?new oo(Nt,[gt]):nr==="coerce"?new ps(Nt,[gt]):gt}if(Array.isArray(L)){if(L.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var ve=L[0];if(typeof ve!="string")return this.error("Expression name must be a string, but found "+typeof ve+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var we=this.registry[ve];if(we){var Me=we.parse(L,this);if(!Me)return null;if(this.expectedType){var Oe=this.expectedType,tt=Me.type;if((Oe.kind==="string"||Oe.kind==="number"||Oe.kind==="boolean"||Oe.kind==="object"||Oe.kind==="array")&&tt.kind==="value")Me=$(Me,Oe,U.typeAnnotation||"assert");else if((Oe.kind==="color"||Oe.kind==="formatted"||Oe.kind==="resolvedImage")&&(tt.kind==="value"||tt.kind==="string"))Me=$(Me,Oe,U.typeAnnotation||"coerce");else if(this.checkSubtype(Oe,tt))return null}if(!(Me instanceof io)&&Me.type.kind!=="resolvedImage"&&lu(Me)){var pt=new qs;try{Me=new io(Me.type,Me.evaluate(pt))}catch(gt){return this.error(gt.message),null}}return Me}return this.error('Unknown expression "'+ve+'". If you wanted a literal array, use ["literal", [...]].',0)}else return typeof L>"u"?this.error("'undefined' value invalid. Use null instead."):typeof L=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof L+" instead.")},Uo.prototype.concat=function(L,U,$){var ve=typeof L=="number"?this.path.concat(L):this.path,we=$?this.scope.concat($):this.scope;return new Uo(this.registry,ve,U||null,we,this.errors)},Uo.prototype.error=function(L){for(var U=[],$=arguments.length-1;$-- >0;)U[$]=arguments[$+1];var ve=""+this.key+U.map(function(we){return"["+we+"]"}).join("");this.errors.push(new _n(ve,L))},Uo.prototype.checkSubtype=function(L,U){var $=jo(L,U);return $&&this.error($),$};function lu(D){if(D instanceof Rs)return lu(D.boundExpression);if(D instanceof Oo&&D.name==="error")return!1;if(D instanceof el)return!1;if(D instanceof ds)return!1;var L=D instanceof ps||D instanceof oo,U=!0;return D.eachChild(function($){L?U=U&&lu($):U=U&&$ instanceof io}),U?Dl(D)&&Tu(D,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function Gs(D,L){for(var U=D.length-1,$=0,ve=U,we=0,Me,Oe;$<=ve;)if(we=Math.floor(($+ve)/2),Me=D[we],Oe=D[we+1],Me<=L){if(we===U||L<Oe)return we;$=we+1}else if(Me>L)ve=we-1;else throw new Wi("Input is not a number.");return 0}var Ys=function(L,U,$){this.type=L,this.input=U,this.labels=[],this.outputs=[];for(var ve=0,we=$;ve<we.length;ve+=1){var Me=we[ve],Oe=Me[0],tt=Me[1];this.labels.push(Oe),this.outputs.push(tt)}};Ys.parse=function(L,U){if(L.length-1<4)return U.error("Expected at least 4 arguments, but found only "+(L.length-1)+".");if((L.length-1)%2!==0)return U.error("Expected an even number of arguments.");var $=U.parse(L[1],1,br);if(!$)return null;var ve=[],we=null;U.expectedType&&U.expectedType.kind!=="value"&&(we=U.expectedType);for(var Me=1;Me<L.length;Me+=2){var Oe=Me===1?-1/0:L[Me],tt=L[Me+1],pt=Me,gt=Me+1;if(typeof Oe!="number")return U.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',pt);if(ve.length&&ve[ve.length-1][0]>=Oe)return U.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',pt);var Nt=U.parse(tt,gt,we);if(!Nt)return null;we=we||Nt.type,ve.push([Oe,Nt])}return new Ys(we,$,ve)},Ys.prototype.evaluate=function(L){var U=this.labels,$=this.outputs;if(U.length===1)return $[0].evaluate(L);var ve=this.input.evaluate(L);if(ve<=U[0])return $[0].evaluate(L);var we=U.length;if(ve>=U[we-1])return $[we-1].evaluate(L);var Me=Gs(U,ve);return $[Me].evaluate(L)},Ys.prototype.eachChild=function(L){L(this.input);for(var U=0,$=this.outputs;U<$.length;U+=1){var ve=$[U];L(ve)}},Ys.prototype.outputDefined=function(){return this.outputs.every(function(L){return L.outputDefined()})},Ys.prototype.serialize=function(){for(var L=["step",this.input.serialize()],U=0;U<this.labels.length;U++)U>0&&L.push(this.labels[U]),L.push(this.outputs[U].serialize());return L};function mo(D,L,U){return D*(1-U)+L*U}function Hl(D,L,U){return new bi(mo(D.r,L.r,U),mo(D.g,L.g,U),mo(D.b,L.b,U),mo(D.a,L.a,U))}function Gl(D,L,U){return D.map(function($,ve){return mo($,L[ve],U)})}var dl=Object.freeze({__proto__:null,number:mo,color:Hl,array:Gl}),Is=.95047,Yl=1,Pl=1.08883,uu=4/29,Wl=6/29,yl=3*Wl*Wl,vf=Wl*Wl*Wl,_s=Math.PI/180,Cf=180/Math.PI;function Au(D){return D>vf?Math.pow(D,1/3):D/yl+uu}function Fl(D){return D>Wl?D*D*D:yl*(D-uu)}function Xl(D){return 255*(D<=.0031308?12.92*D:1.055*Math.pow(D,1/2.4)-.055)}function ml(D){return D/=255,D<=.04045?D/12.92:Math.pow((D+.055)/1.055,2.4)}function Zl(D){var L=ml(D.r),U=ml(D.g),$=ml(D.b),ve=Au((.4124564*L+.3575761*U+.1804375*$)/Is),we=Au((.2126729*L+.7151522*U+.072175*$)/Yl),Me=Au((.0193339*L+.119192*U+.9503041*$)/Pl);return{l:116*we-16,a:500*(ve-we),b:200*(we-Me),alpha:D.a}}function Uu(D){var L=(D.l+16)/116,U=isNaN(D.a)?L:L+D.a/500,$=isNaN(D.b)?L:L-D.b/200;return L=Yl*Fl(L),U=Is*Fl(U),$=Pl*Fl($),new bi(Xl(3.2404542*U-1.5371385*L-.4985314*$),Xl(-.969266*U+1.8760108*L+.041556*$),Xl(.0556434*U-.2040259*L+1.0572252*$),D.alpha)}function Vu(D,L,U){return{l:mo(D.l,L.l,U),a:mo(D.a,L.a,U),b:mo(D.b,L.b,U),alpha:mo(D.alpha,L.alpha,U)}}function kf(D){var L=Zl(D),U=L.l,$=L.a,ve=L.b,we=Math.atan2(ve,$)*Cf;return{h:we<0?we+360:we,c:Math.sqrt($*$+ve*ve),l:U,alpha:D.a}}function Hi(D){var L=D.h*_s,U=D.c,$=D.l;return Uu({l:$,a:Math.cos(L)*U,b:Math.sin(L)*U,alpha:D.alpha})}function Rl(D,L,U){var $=L-D;return D+U*($>180||$<-180?$-360*Math.round($/360):$)}function xl(D,L,U){return{h:Rl(D.h,L.h,U),c:mo(D.c,L.c,U),l:mo(D.l,L.l,U),alpha:mo(D.alpha,L.alpha,U)}}var gs={forward:Zl,reverse:Uu,interpolate:Vu},ws={forward:kf,reverse:Hi,interpolate:xl},jl=Object.freeze({__proto__:null,lab:gs,hcl:ws}),xo=function(L,U,$,ve,we){this.type=L,this.operator=U,this.interpolation=$,this.input=ve,this.labels=[],this.outputs=[];for(var Me=0,Oe=we;Me<Oe.length;Me+=1){var tt=Oe[Me],pt=tt[0],gt=tt[1];this.labels.push(pt),this.outputs.push(gt)}};xo.interpolationFactor=function(L,U,$,ve){var we=0;if(L.name==="exponential")we=Hu(U,L.base,$,ve);else if(L.name==="linear")we=Hu(U,1,$,ve);else if(L.name==="cubic-bezier"){var Me=L.controlPoints,Oe=new a(Me[0],Me[1],Me[2],Me[3]);we=Oe.solve(Hu(U,1,$,ve))}return we},xo.parse=function(L,U){var $=L[0],ve=L[1],we=L[2],Me=L.slice(3);if(!Array.isArray(ve)||ve.length===0)return U.error("Expected an interpolation type expression.",1);if(ve[0]==="linear")ve={name:"linear"};else if(ve[0]==="exponential"){var Oe=ve[1];if(typeof Oe!="number")return U.error("Exponential interpolation requires a numeric base.",1,1);ve={name:"exponential",base:Oe}}else if(ve[0]==="cubic-bezier"){var tt=ve.slice(1);if(tt.length!==4||tt.some(function(en){return typeof en!="number"||en<0||en>1}))return U.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);ve={name:"cubic-bezier",controlPoints:tt}}else return U.error("Unknown interpolation type "+String(ve[0]),1,0);if(L.length-1<4)return U.error("Expected at least 4 arguments, but found only "+(L.length-1)+".");if((L.length-1)%2!==0)return U.error("Expected an even number of arguments.");if(we=U.parse(we,2,br),!we)return null;var pt=[],gt=null;$==="interpolate-hcl"||$==="interpolate-lab"?gt=On:U.expectedType&&U.expectedType.kind!=="value"&&(gt=U.expectedType);for(var Nt=0;Nt<Me.length;Nt+=2){var nr=Me[Nt],qt=Me[Nt+1],yr=Nt+3,Nr=Nt+4;if(typeof nr!="number")return U.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',yr);if(pt.length&&pt[pt.length-1][0]>=nr)return U.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',yr);var ln=U.parse(qt,Nr,gt);if(!ln)return null;gt=gt||ln.type,pt.push([nr,ln])}return gt.kind!=="number"&&gt.kind!=="color"&&!(gt.kind==="array"&&gt.itemType.kind==="number"&&typeof gt.N=="number")?U.error("Type "+Ea(gt)+" is not interpolatable."):new xo(gt,$,ve,we,pt)},xo.prototype.evaluate=function(L){var U=this.labels,$=this.outputs;if(U.length===1)return $[0].evaluate(L);var ve=this.input.evaluate(L);if(ve<=U[0])return $[0].evaluate(L);var we=U.length;if(ve>=U[we-1])return $[we-1].evaluate(L);var Me=Gs(U,ve),Oe=U[Me],tt=U[Me+1],pt=xo.interpolationFactor(this.interpolation,ve,Oe,tt),gt=$[Me].evaluate(L),Nt=$[Me+1].evaluate(L);return this.operator==="interpolate"?dl[this.type.kind.toLowerCase()](gt,Nt,pt):this.operator==="interpolate-hcl"?ws.reverse(ws.interpolate(ws.forward(gt),ws.forward(Nt),pt)):gs.reverse(gs.interpolate(gs.forward(gt),gs.forward(Nt),pt))},xo.prototype.eachChild=function(L){L(this.input);for(var U=0,$=this.outputs;U<$.length;U+=1){var ve=$[U];L(ve)}},xo.prototype.outputDefined=function(){return this.outputs.every(function(L){return L.outputDefined()})},xo.prototype.serialize=function(){var L;this.interpolation.name==="linear"?L=["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?L=["linear"]:L=["exponential",this.interpolation.base]:L=["cubic-bezier"].concat(this.interpolation.controlPoints);for(var U=[this.operator,L,this.input.serialize()],$=0;$<this.labels.length;$++)U.push(this.labels[$],this.outputs[$].serialize());return U};function Hu(D,L,U,$){var ve=$-U,we=D-U;return ve===0?0:L===1?we/ve:(Math.pow(L,we)-1)/(Math.pow(L,ve)-1)}var Ts=function(L,U){this.type=L,this.args=U};Ts.parse=function(L,U){if(L.length<2)return U.error("Expectected at least one argument.");var $=null,ve=U.expectedType;ve&&ve.kind!=="value"&&($=ve);for(var we=[],Me=0,Oe=L.slice(1);Me<Oe.length;Me+=1){var tt=Oe[Me],pt=U.parse(tt,1+we.length,$,void 0,{typeAnnotation:"omit"});if(!pt)return null;$=$||pt.type,we.push(pt)}var gt=ve&&we.some(function(Nt){return jo(ve,Nt.type)});return gt?new Ts(Tn,we):new Ts($,we)},Ts.prototype.evaluate=function(L){for(var U=null,$=0,ve,we=0,Me=this.args;we<Me.length;we+=1){var Oe=Me[we];if($++,U=Oe.evaluate(L),U&&U instanceof No&&!U.available&&(ve||(ve=U.name),U=null,$===this.args.length&&(U=ve)),U!==null)break}return U},Ts.prototype.eachChild=function(L){this.args.forEach(L)},Ts.prototype.outputDefined=function(){return this.args.every(function(L){return L.outputDefined()})},Ts.prototype.serialize=function(){var L=["coalesce"];return this.eachChild(function(U){L.push(U.serialize())}),L};var tl=function(L,U){this.type=U.type,this.bindings=[].concat(L),this.result=U};tl.prototype.evaluate=function(L){return this.result.evaluate(L)},tl.prototype.eachChild=function(L){for(var U=0,$=this.bindings;U<$.length;U+=1){var ve=$[U];L(ve[1])}L(this.result)},tl.parse=function(L,U){if(L.length<4)return U.error("Expected at least 3 arguments, but found "+(L.length-1)+" instead.");for(var $=[],ve=1;ve<L.length-1;ve+=2){var we=L[ve];if(typeof we!="string")return U.error("Expected string, but found "+typeof we+" instead.",ve);if(/[^a-zA-Z0-9_]/.test(we))return U.error("Variable names must contain only alphanumeric characters or '_'.",ve);var Me=U.parse(L[ve+1],ve+1);if(!Me)return null;$.push([we,Me])}var Oe=U.parse(L[L.length-1],L.length-1,U.expectedType,$);return Oe?new tl($,Oe):null},tl.prototype.outputDefined=function(){return this.result.outputDefined()},tl.prototype.serialize=function(){for(var L=["let"],U=0,$=this.bindings;U<$.length;U+=1){var ve=$[U],we=ve[0],Me=ve[1];L.push(we,Me.serialize())}return L.push(this.result.serialize()),L};var rl=function(L,U,$){this.type=L,this.index=U,this.input=$};rl.parse=function(L,U){if(L.length!==3)return U.error("Expected 2 arguments, but found "+(L.length-1)+" instead.");var $=U.parse(L[1],1,br),ve=U.parse(L[2],2,ua(U.expectedType||Tn));if(!$||!ve)return null;var we=ve.type;return new rl(we.itemType,$,ve)},rl.prototype.evaluate=function(L){var U=this.index.evaluate(L),$=this.input.evaluate(L);if(U<0)throw new Wi("Array index out of bounds: "+U+" < 0.");if(U>=$.length)throw new Wi("Array index out of bounds: "+U+" > "+($.length-1)+".");if(U!==Math.floor(U))throw new Wi("Array index must be an integer, but found "+U+" instead.");return $[U]},rl.prototype.eachChild=function(L){L(this.index),L(this.input)},rl.prototype.outputDefined=function(){return!1},rl.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ws=function(L,U){this.type=mn,this.needle=L,this.haystack=U};Ws.parse=function(L,U){if(L.length!==3)return U.error("Expected 2 arguments, but found "+(L.length-1)+" instead.");var $=U.parse(L[1],1,Tn),ve=U.parse(L[2],2,Tn);return!$||!ve?null:vs($.type,[mn,Br,br,mr,Tn])?new Ws($,ve):U.error("Expected first argument to be of type boolean, string, number or null, but found "+Ea($.type)+" instead")},Ws.prototype.evaluate=function(L){var U=this.needle.evaluate(L),$=this.haystack.evaluate(L);if(!$)return!1;if(!El(U,["boolean","string","number","null"]))throw new Wi("Expected first argument to be of type boolean, string, number or null, but found "+Ea(Vi(U))+" instead.");if(!El($,["string","array"]))throw new Wi("Expected second argument to be of type array or string, but found "+Ea(Vi($))+" instead.");return $.indexOf(U)>=0},Ws.prototype.eachChild=function(L){L(this.needle),L(this.haystack)},Ws.prototype.outputDefined=function(){return!0},Ws.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var As=function(L,U,$){this.type=br,this.needle=L,this.haystack=U,this.fromIndex=$};As.parse=function(L,U){if(L.length<=2||L.length>=5)return U.error("Expected 3 or 4 arguments, but found "+(L.length-1)+" instead.");var $=U.parse(L[1],1,Tn),ve=U.parse(L[2],2,Tn);if(!$||!ve)return null;if(!vs($.type,[mn,Br,br,mr,Tn]))return U.error("Expected first argument to be of type boolean, string, number or null, but found "+Ea($.type)+" instead");if(L.length===4){var we=U.parse(L[3],3,br);return we?new As($,ve,we):null}else return new As($,ve)},As.prototype.evaluate=function(L){var U=this.needle.evaluate(L),$=this.haystack.evaluate(L);if(!El(U,["boolean","string","number","null"]))throw new Wi("Expected first argument to be of type boolean, string, number or null, but found "+Ea(Vi(U))+" instead.");if(!El($,["string","array"]))throw new Wi("Expected second argument to be of type array or string, but found "+Ea(Vi($))+" instead.");if(this.fromIndex){var ve=this.fromIndex.evaluate(L);return $.indexOf(U,ve)}return $.indexOf(U)},As.prototype.eachChild=function(L){L(this.needle),L(this.haystack),this.fromIndex&&L(this.fromIndex)},As.prototype.outputDefined=function(){return!1},As.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var L=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),L]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Qi=function(L,U,$,ve,we,Me){this.inputType=L,this.type=U,this.input=$,this.cases=ve,this.outputs=we,this.otherwise=Me};Qi.parse=function(L,U){if(L.length<5)return U.error("Expected at least 4 arguments, but found only "+(L.length-1)+".");if(L.length%2!==1)return U.error("Expected an even number of arguments.");var $,ve;U.expectedType&&U.expectedType.kind!=="value"&&(ve=U.expectedType);for(var we={},Me=[],Oe=2;Oe<L.length-1;Oe+=2){var tt=L[Oe],pt=L[Oe+1];Array.isArray(tt)||(tt=[tt]);var gt=U.concat(Oe);if(tt.length===0)return gt.error("Expected at least one branch label.");for(var Nt=0,nr=tt;Nt<nr.length;Nt+=1){var qt=nr[Nt];if(typeof qt!="number"&&typeof qt!="string")return gt.error("Branch labels must be numbers or strings.");if(typeof qt=="number"&&Math.abs(qt)>Number.MAX_SAFE_INTEGER)return gt.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof qt=="number"&&Math.floor(qt)!==qt)return gt.error("Numeric branch labels must be integer values.");if(!$)$=Vi(qt);else if(gt.checkSubtype($,Vi(qt)))return null;if(typeof we[String(qt)]<"u")return gt.error("Branch labels must be unique.");we[String(qt)]=Me.length}var yr=U.parse(pt,Oe,ve);if(!yr)return null;ve=ve||yr.type,Me.push(yr)}var Nr=U.parse(L[1],1,Tn);if(!Nr)return null;var ln=U.parse(L[L.length-1],L.length-1,ve);return!ln||Nr.type.kind!=="value"&&U.concat(1).checkSubtype($,Nr.type)?null:new Qi($,ve,Nr,we,Me,ln)},Qi.prototype.evaluate=function(L){var U=this.input.evaluate(L),$=Vi(U)===this.inputType&&this.outputs[this.cases[U]]||this.otherwise;return $.evaluate(L)},Qi.prototype.eachChild=function(L){L(this.input),this.outputs.forEach(L),L(this.otherwise)},Qi.prototype.outputDefined=function(){return this.outputs.every(function(L){return L.outputDefined()})&&this.otherwise.outputDefined()},Qi.prototype.serialize=function(){for(var L=this,U=["match",this.input.serialize()],$=Object.keys(this.cases).sort(),ve=[],we={},Me=0,Oe=$;Me<Oe.length;Me+=1){var tt=Oe[Me],pt=we[this.cases[tt]];pt===void 0?(we[this.cases[tt]]=ve.length,ve.push([this.cases[tt],[tt]])):ve[pt][1].push(tt)}for(var gt=function(Nr){return L.inputType.kind==="number"?Number(Nr):Nr},Nt=0,nr=ve;Nt<nr.length;Nt+=1){var qt=nr[Nt],pt=qt[0],yr=qt[1];yr.length===1?U.push(gt(yr[0])):U.push(yr.map(gt)),U.push(this.outputs[outputIndex$1].serialize())}return U.push(this.otherwise.serialize()),U};var Vo=function(L,U,$){this.type=L,this.branches=U,this.otherwise=$};Vo.parse=function(L,U){if(L.length<4)return U.error("Expected at least 3 arguments, but found only "+(L.length-1)+".");if(L.length%2!==0)return U.error("Expected an odd number of arguments.");var $;U.expectedType&&U.expectedType.kind!=="value"&&($=U.expectedType);for(var ve=[],we=1;we<L.length-1;we+=2){var Me=U.parse(L[we],we,mn);if(!Me)return null;var Oe=U.parse(L[we+1],we+1,$);if(!Oe)return null;ve.push([Me,Oe]),$=$||Oe.type}var tt=U.parse(L[L.length-1],L.length-1,$);return tt?new Vo($,ve,tt):null},Vo.prototype.evaluate=function(L){for(var U=0,$=this.branches;U<$.length;U+=1){var ve=$[U],we=ve[0],Me=ve[1];if(we.evaluate(L))return Me.evaluate(L)}return this.otherwise.evaluate(L)},Vo.prototype.eachChild=function(L){for(var U=0,$=this.branches;U<$.length;U+=1){var ve=$[U],we=ve[0],Me=ve[1];L(we),L(Me)}L(this.otherwise)},Vo.prototype.outputDefined=function(){return this.branches.every(function(L){L[0];var U=L[1];return U.outputDefined()})&&this.otherwise.outputDefined()},Vo.prototype.serialize=function(){var L=["case"];return this.eachChild(function(U){L.push(U.serialize())}),L};var Ms=function(L,U,$,ve){this.type=L,this.input=U,this.beginIndex=$,this.endIndex=ve};Ms.parse=function(L,U){if(L.length<=2||L.length>=5)return U.error("Expected 3 or 4 arguments, but found "+(L.length-1)+" instead.");var $=U.parse(L[1],1,Tn),ve=U.parse(L[2],2,br);if(!$||!ve)return null;if(!vs($.type,[ua(Tn),Br,Tn]))return U.error("Expected first argument to be of type array or string, but found "+Ea($.type)+" instead");if(L.length===4){var we=U.parse(L[3],3,br);return we?new Ms($.type,$,ve,we):null}else return new Ms($.type,$,ve)},Ms.prototype.evaluate=function(L){var U=this.input.evaluate(L),$=this.beginIndex.evaluate(L);if(!El(U,["string","array"]))throw new Wi("Expected first argument to be of type array or string, but found "+Ea(Vi(U))+" instead.");if(this.endIndex){var ve=this.endIndex.evaluate(L);return U.slice($,ve)}return U.slice($)},Ms.prototype.eachChild=function(L){L(this.input),L(this.beginIndex),this.endIndex&&L(this.endIndex)},Ms.prototype.outputDefined=function(){return!1},Ms.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var L=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),L]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};function Gu(D,L){return D==="=="||D==="!="?L.kind==="boolean"||L.kind==="string"||L.kind==="number"||L.kind==="null"||L.kind==="value":L.kind==="string"||L.kind==="number"||L.kind==="value"}function fu(D,L,U){return L===U}function Yu(D,L,U){return L!==U}function xt(D,L,U){return L<U}function Ot(D,L,U){return L>U}function vr(D,L,U){return L<=U}function lr(D,L,U){return L>=U}function Ir(D,L,U,$){return $.compare(L,U)===0}function nn(D,L,U,$){return!Ir(D,L,U,$)}function yn(D,L,U,$){return $.compare(L,U)<0}function En(D,L,U,$){return $.compare(L,U)>0}function Pn(D,L,U,$){return $.compare(L,U)<=0}function Vn(D,L,U,$){return $.compare(L,U)>=0}function xn(D,L,U){var $=D!=="=="&&D!=="!=";return function(){function ve(we,Me,Oe){this.type=mn,this.lhs=we,this.rhs=Me,this.collator=Oe,this.hasUntypedArgument=we.type.kind==="value"||Me.type.kind==="value"}return ve.parse=function(Me,Oe){if(Me.length!==3&&Me.length!==4)return Oe.error("Expected two or three arguments.");var tt=Me[0],pt=Oe.parse(Me[1],1,Tn);if(!pt)return null;if(!Gu(tt,pt.type))return Oe.concat(1).error('"'+tt+`" comparisons are not supported for type '`+Ea(pt.type)+"'.");var gt=Oe.parse(Me[2],2,Tn);if(!gt)return null;if(!Gu(tt,gt.type))return Oe.concat(2).error('"'+tt+`" comparisons are not supported for type '`+Ea(gt.type)+"'.");if(pt.type.kind!==gt.type.kind&&pt.type.kind!=="value"&&gt.type.kind!=="value")return Oe.error("Cannot compare types '"+Ea(pt.type)+"' and '"+Ea(gt.type)+"'.");$&&(pt.type.kind==="value"&&gt.type.kind!=="value"?pt=new oo(gt.type,[pt]):pt.type.kind!=="value"&&gt.type.kind==="value"&&(gt=new oo(pt.type,[gt])));var Nt=null;if(Me.length===4){if(pt.type.kind!=="string"&&gt.type.kind!=="string"&&pt.type.kind!=="value"&&gt.type.kind!=="value")return Oe.error("Cannot use collator to compare non-string types.");if(Nt=Oe.parse(Me[3],3,oa),!Nt)return null}return new ve(pt,gt,Nt)},ve.prototype.evaluate=function(Me){var Oe=this.lhs.evaluate(Me),tt=this.rhs.evaluate(Me);if($&&this.hasUntypedArgument){var pt=Vi(Oe),gt=Vi(tt);if(pt.kind!==gt.kind||!(pt.kind==="string"||pt.kind==="number"))throw new Wi('Expected arguments for "'+D+'" to be (string, string) or (number, number), but found ('+pt.kind+", "+gt.kind+") instead.")}if(this.collator&&!$&&this.hasUntypedArgument){var Nt=Vi(Oe),nr=Vi(tt);if(Nt.kind!=="string"||nr.kind!=="string")return L(Me,Oe,tt)}return this.collator?U(Me,Oe,tt,this.collator.evaluate(Me)):L(Me,Oe,tt)},ve.prototype.eachChild=function(Me){Me(this.lhs),Me(this.rhs),this.collator&&Me(this.collator)},ve.prototype.outputDefined=function(){return!0},ve.prototype.serialize=function(){var Me=[D];return this.eachChild(function(Oe){Me.push(Oe.serialize())}),Me},ve}()}var Bn=xn("==",fu,Ir),Fn=xn("!=",Yu,nn),Gn=xn("<",xt,yn),ea=xn(">",Ot,En),Na=xn("<=",vr,Pn),La=xn(">=",lr,Vn),Oa=function(L,U,$,ve,we){this.type=Br,this.number=L,this.locale=U,this.currency=$,this.minFractionDigits=ve,this.maxFractionDigits=we};Oa.parse=function(L,U){if(L.length!==3)return U.error("Expected two arguments.");var $=U.parse(L[1],1,br);if(!$)return null;var ve=L[2];if(typeof ve!="object"||Array.isArray(ve))return U.error("NumberFormat options argument must be an object.");var we=null;if(ve.locale&&(we=U.parse(ve.locale,1,Br),!we))return null;var Me=null;if(ve.currency&&(Me=U.parse(ve.currency,1,Br),!Me))return null;var Oe=null;if(ve["min-fraction-digits"]&&(Oe=U.parse(ve["min-fraction-digits"],1,br),!Oe))return null;var tt=null;return ve["max-fraction-digits"]&&(tt=U.parse(ve["max-fraction-digits"],1,br),!tt)?null:new Oa($,we,Me,Oe,tt)},Oa.prototype.evaluate=function(L){return new Intl.NumberFormat(this.locale?this.locale.evaluate(L):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(L):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(L):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(L):void 0}).format(this.number.evaluate(L))},Oa.prototype.eachChild=function(L){L(this.number),this.locale&&L(this.locale),this.currency&&L(this.currency),this.minFractionDigits&&L(this.minFractionDigits),this.maxFractionDigits&&L(this.maxFractionDigits)},Oa.prototype.outputDefined=function(){return!1},Oa.prototype.serialize=function(){var L={};return this.locale&&(L.locale=this.locale.serialize()),this.currency&&(L.currency=this.currency.serialize()),this.minFractionDigits&&(L["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(L["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),L]};var Ua=function(L){this.type=br,this.input=L};Ua.parse=function(L,U){if(L.length!==2)return U.error("Expected 1 argument, but found "+(L.length-1)+" instead.");var $=U.parse(L[1],1);return $?$.type.kind!=="array"&&$.type.kind!=="string"&&$.type.kind!=="value"?U.error("Expected argument of type string or array, but found "+Ea($.type)+" instead."):new Ua($):null},Ua.prototype.evaluate=function(L){var U=this.input.evaluate(L);if(typeof U=="string")return U.length;if(Array.isArray(U))return U.length;throw new Wi("Expected value to be of type string or array, but found "+Ea(Vi(U))+" instead.")},Ua.prototype.eachChild=function(L){L(this.input)},Ua.prototype.outputDefined=function(){return!1},Ua.prototype.serialize=function(){var L=["length"];return this.eachChild(function(U){L.push(U.serialize())}),L};var $n={"==":Bn,"!=":Fn,">":ea,"<":Gn,">=":La,"<=":Na,array:oo,at:rl,boolean:oo,case:Vo,coalesce:Ts,collator:el,format:bs,image:hl,in:Ws,"index-of":As,interpolate:xo,"interpolate-hcl":xo,"interpolate-lab":xo,length:Ua,let:tl,literal:io,match:Qi,number:oo,"number-format":Oa,object:oo,slice:Ms,step:Ys,string:oo,"to-boolean":ps,"to-color":ps,"to-number":ps,"to-string":ps,var:Rs,within:ds};function da(D,L){var U=L[0],$=L[1],ve=L[2],we=L[3];U=U.evaluate(D),$=$.evaluate(D),ve=ve.evaluate(D);var Me=we?we.evaluate(D):1,Oe=Ul(U,$,ve,Me);if(Oe)throw new Wi(Oe);return new bi(U/255*Me,$/255*Me,ve/255*Me,Me)}function Za(D,L){return D in L}function ti(D,L){var U=L[D];return typeof U>"u"?null:U}function wi(D,L,U,$){for(;U<=$;){var ve=U+$>>1;if(L[ve]===D)return!0;L[ve]>D?$=ve-1:U=ve+1}return!1}function Ti(D){return{type:D}}Oo.register($n,{error:[Kn,[Br],function(D,L){var U=L[0];throw new Wi(U.evaluate(D))}],typeof:[Br,[Tn],function(D,L){var U=L[0];return Ea(Vi(U.evaluate(D)))}],"to-rgba":[ua(br,4),[On],function(D,L){var U=L[0];return U.evaluate(D).toArray()}],rgb:[On,[br,br,br],da],rgba:[On,[br,br,br,br],da],has:{type:mn,overloads:[[[Br],function(D,L){var U=L[0];return Za(U.evaluate(D),D.properties())}],[[Br,na],function(D,L){var U=L[0],$=L[1];return Za(U.evaluate(D),$.evaluate(D))}]]},get:{type:Tn,overloads:[[[Br],function(D,L){var U=L[0];return ti(U.evaluate(D),D.properties())}],[[Br,na],function(D,L){var U=L[0],$=L[1];return ti(U.evaluate(D),$.evaluate(D))}]]},"feature-state":[Tn,[Br],function(D,L){var U=L[0];return ti(U.evaluate(D),D.featureState||{})}],properties:[na,[],function(D){return D.properties()}],"geometry-type":[Br,[],function(D){return D.geometryType()}],id:[Tn,[],function(D){return D.id()}],zoom:[br,[],function(D){return D.globals.zoom}],"heatmap-density":[br,[],function(D){return D.globals.heatmapDensity||0}],"line-progress":[br,[],function(D){return D.globals.lineProgress||0}],accumulated:[Tn,[],function(D){return D.globals.accumulated===void 0?null:D.globals.accumulated}],"+":[br,Ti(br),function(D,L){for(var U=0,$=0,ve=L;$<ve.length;$+=1){var we=ve[$];U+=we.evaluate(D)}return U}],"*":[br,Ti(br),function(D,L){for(var U=1,$=0,ve=L;$<ve.length;$+=1){var we=ve[$];U*=we.evaluate(D)}return U}],"-":{type:br,overloads:[[[br,br],function(D,L){var U=L[0],$=L[1];return U.evaluate(D)-$.evaluate(D)}],[[br],function(D,L){var U=L[0];return-U.evaluate(D)}]]},"/":[br,[br,br],function(D,L){var U=L[0],$=L[1];return U.evaluate(D)/$.evaluate(D)}],"%":[br,[br,br],function(D,L){var U=L[0],$=L[1];return U.evaluate(D)%$.evaluate(D)}],ln2:[br,[],function(){return Math.LN2}],pi:[br,[],function(){return Math.PI}],e:[br,[],function(){return Math.E}],"^":[br,[br,br],function(D,L){var U=L[0],$=L[1];return Math.pow(U.evaluate(D),$.evaluate(D))}],sqrt:[br,[br],function(D,L){var U=L[0];return Math.sqrt(U.evaluate(D))}],log10:[br,[br],function(D,L){var U=L[0];return Math.log(U.evaluate(D))/Math.LN10}],ln:[br,[br],function(D,L){var U=L[0];return Math.log(U.evaluate(D))}],log2:[br,[br],function(D,L){var U=L[0];return Math.log(U.evaluate(D))/Math.LN2}],sin:[br,[br],function(D,L){var U=L[0];return Math.sin(U.evaluate(D))}],cos:[br,[br],function(D,L){var U=L[0];return Math.cos(U.evaluate(D))}],tan:[br,[br],function(D,L){var U=L[0];return Math.tan(U.evaluate(D))}],asin:[br,[br],function(D,L){var U=L[0];return Math.asin(U.evaluate(D))}],acos:[br,[br],function(D,L){var U=L[0];return Math.acos(U.evaluate(D))}],atan:[br,[br],function(D,L){var U=L[0];return Math.atan(U.evaluate(D))}],min:[br,Ti(br),function(D,L){return Math.min.apply(Math,L.map(function(U){return U.evaluate(D)}))}],max:[br,Ti(br),function(D,L){return Math.max.apply(Math,L.map(function(U){return U.evaluate(D)}))}],abs:[br,[br],function(D,L){var U=L[0];return Math.abs(U.evaluate(D))}],round:[br,[br],function(D,L){var U=L[0],$=U.evaluate(D);return $<0?-Math.round(-$):Math.round($)}],floor:[br,[br],function(D,L){var U=L[0];return Math.floor(U.evaluate(D))}],ceil:[br,[br],function(D,L){var U=L[0];return Math.ceil(U.evaluate(D))}],"filter-==":[mn,[Br,Tn],function(D,L){var U=L[0],$=L[1];return D.properties()[U.value]===$.value}],"filter-id-==":[mn,[Tn],function(D,L){var U=L[0];return D.id()===U.value}],"filter-type-==":[mn,[Br],function(D,L){var U=L[0];return D.geometryType()===U.value}],"filter-<":[mn,[Br,Tn],function(D,L){var U=L[0],$=L[1],ve=D.properties()[U.value],we=$.value;return typeof ve==typeof we&&ve<we}],"filter-id-<":[mn,[Tn],function(D,L){var U=L[0],$=D.id(),ve=U.value;return typeof $==typeof ve&&$<ve}],"filter->":[mn,[Br,Tn],function(D,L){var U=L[0],$=L[1],ve=D.properties()[U.value],we=$.value;return typeof ve==typeof we&&ve>we}],"filter-id->":[mn,[Tn],function(D,L){var U=L[0],$=D.id(),ve=U.value;return typeof $==typeof ve&&$>ve}],"filter-<=":[mn,[Br,Tn],function(D,L){var U=L[0],$=L[1],ve=D.properties()[U.value],we=$.value;return typeof ve==typeof we&&ve<=we}],"filter-id-<=":[mn,[Tn],function(D,L){var U=L[0],$=D.id(),ve=U.value;return typeof $==typeof ve&&$<=ve}],"filter->=":[mn,[Br,Tn],function(D,L){var U=L[0],$=L[1],ve=D.properties()[U.value],we=$.value;return typeof ve==typeof we&&ve>=we}],"filter-id->=":[mn,[Tn],function(D,L){var U=L[0],$=D.id(),ve=U.value;return typeof $==typeof ve&&$>=ve}],"filter-has":[mn,[Tn],function(D,L){var U=L[0];return U.value in D.properties()}],"filter-has-id":[mn,[],function(D){return D.id()!==null&&D.id()!==void 0}],"filter-type-in":[mn,[ua(Br)],function(D,L){var U=L[0];return U.value.indexOf(D.geometryType())>=0}],"filter-id-in":[mn,[ua(Tn)],function(D,L){var U=L[0];return U.value.indexOf(D.id())>=0}],"filter-in-small":[mn,[Br,ua(Tn)],function(D,L){var U=L[0],$=L[1];return $.value.indexOf(D.properties()[U.value])>=0}],"filter-in-large":[mn,[Br,ua(Tn)],function(D,L){var U=L[0],$=L[1];return wi(D.properties()[U.value],$.value,0,$.value.length-1)}],all:{type:mn,overloads:[[[mn,mn],function(D,L){var U=L[0],$=L[1];return U.evaluate(D)&&$.evaluate(D)}],[Ti(mn),function(D,L){for(var U=0,$=L;U<$.length;U+=1){var ve=$[U];if(!ve.evaluate(D))return!1}return!0}]]},any:{type:mn,overloads:[[[mn,mn],function(D,L){var U=L[0],$=L[1];return U.evaluate(D)||$.evaluate(D)}],[Ti(mn),function(D,L){for(var U=0,$=L;U<$.length;U+=1){var ve=$[U];if(ve.evaluate(D))return!0}return!1}]]},"!":[mn,[mn],function(D,L){var U=L[0];return!U.evaluate(D)}],"is-supported-script":[mn,[Br],function(D,L){var U=L[0],$=D.globals&&D.globals.isSupportedScript;return $?$(U.evaluate(D)):!0}],upcase:[Br,[Br],function(D,L){var U=L[0];return U.evaluate(D).toUpperCase()}],downcase:[Br,[Br],function(D,L){var U=L[0];return U.evaluate(D).toLowerCase()}],concat:[Br,Ti(Tn),function(D,L){return L.map(function(U){return Cl(U.evaluate(D))}).join("")}],"resolved-locale":[Br,[oa],function(D,L){var U=L[0];return U.evaluate(D).resolvedLocale()}]});function Si(D){return{result:"success",value:D}}function Fi(D){return{result:"error",value:D}}function fi(D){return D["property-type"]==="data-driven"||D["property-type"]==="cross-faded-data-driven"}function ko(D){return!!D.expression&&D.expression.parameters.indexOf("zoom")>-1}function uo(D){return!!D.expression&&D.expression.interpolated}function ei(D){return D instanceof Number?"number":D instanceof String?"string":D instanceof Boolean?"boolean":Array.isArray(D)?"array":D===null?"null":typeof D}function ga(D){return typeof D=="object"&&D!==null&&!Array.isArray(D)}function Ei(D){return D}function bo(D,L){var U=L.type==="color",$=D.stops&&typeof D.stops[0][0]=="object",ve=$||D.property!==void 0,we=$||!ve,Me=D.type||(uo(L)?"exponential":"interval");if(U&&(D=dn({},D),D.stops&&(D.stops=D.stops.map(function(ia){return[ia[0],bi.parse(ia[1])]})),D.default?D.default=bi.parse(D.default):D.default=bi.parse(L.default)),D.colorSpace&&D.colorSpace!=="rgb"&&!jl[D.colorSpace])throw new Error("Unknown color space: "+D.colorSpace);var Oe,tt,pt;if(Me==="exponential")Oe=Jo;else if(Me==="interval")Oe=Xs;else if(Me==="categorical"){Oe=Ss,tt=Object.create(null);for(var gt=0,Nt=D.stops;gt<Nt.length;gt+=1){var nr=Nt[gt];tt[nr[0]]=nr[1]}pt=typeof D.stops[0][0]}else if(Me==="identity")Oe=bl;else throw new Error('Unknown function type "'+Me+'"');if($){for(var qt={},yr=[],Nr=0;Nr<D.stops.length;Nr++){var ln=D.stops[Nr],en=ln[0].zoom;qt[en]===void 0&&(qt[en]={zoom:en,type:D.type,property:D.property,default:D.default,stops:[]},yr.push(en)),qt[en].stops.push([ln[0].value,ln[1]])}for(var kn=[],bn=0,Cn=yr;bn<Cn.length;bn+=1){var zn=Cn[bn];kn.push([qt[zn].zoom,bo(qt[zn],L)])}var Wn={name:"linear"};return{kind:"composite",interpolationType:Wn,interpolationFactor:xo.interpolationFactor.bind(void 0,Wn),zoomStops:kn.map(function(ia){return ia[0]}),evaluate:function(za,Ma){var ka=za.zoom;return Jo({stops:kn,base:D.base},L,ka).evaluate(ka,Ma)}}}else if(we){var la=Me==="exponential"?{name:"exponential",base:D.base!==void 0?D.base:1}:null;return{kind:"camera",interpolationType:la,interpolationFactor:xo.interpolationFactor.bind(void 0,la),zoomStops:D.stops.map(function(ia){return ia[0]}),evaluate:function(ia){var za=ia.zoom;return Oe(D,L,za,tt,pt)}}}else return{kind:"source",evaluate:function(za,Ma){var ka=Ma&&Ma.properties?Ma.properties[D.property]:void 0;return ka===void 0?So(D.default,L.default):Oe(D,L,ka,tt,pt)}}}function So(D,L,U){if(D!==void 0)return D;if(L!==void 0)return L;if(U!==void 0)return U}function Ss(D,L,U,$,ve){var we=typeof U===ve?$[U]:void 0;return So(we,D.default,L.default)}function Xs(D,L,U){if(ei(U)!=="number")return So(D.default,L.default);var $=D.stops.length;if($===1||U<=D.stops[0][0])return D.stops[0][1];if(U>=D.stops[$-1][0])return D.stops[$-1][1];var ve=Gs(D.stops.map(function(we){return we[0]}),U);return D.stops[ve][1]}function Jo(D,L,U){var $=D.base!==void 0?D.base:1;if(ei(U)!=="number")return So(D.default,L.default);var ve=D.stops.length;if(ve===1||U<=D.stops[0][0])return D.stops[0][1];if(U>=D.stops[ve-1][0])return D.stops[ve-1][1];var we=Gs(D.stops.map(function(Nt){return Nt[0]}),U),Me=zs(U,$,D.stops[we][0],D.stops[we+1][0]),Oe=D.stops[we][1],tt=D.stops[we+1][1],pt=dl[L.type]||Ei;if(D.colorSpace&&D.colorSpace!=="rgb"){var gt=jl[D.colorSpace];pt=function(Nt,nr){return gt.reverse(gt.interpolate(gt.forward(Nt),gt.forward(nr),Me))}}return typeof Oe.evaluate=="function"?{evaluate:function(){for(var nr=[],qt=arguments.length;qt--;)nr[qt]=arguments[qt];var yr=Oe.evaluate.apply(void 0,nr),Nr=tt.evaluate.apply(void 0,nr);if(!(yr===void 0||Nr===void 0))return pt(yr,Nr,Me)}}:pt(Oe,tt,Me)}function bl(D,L,U){return L.type==="color"?U=bi.parse(U):L.type==="formatted"?U=Ki.fromString(U.toString()):L.type==="resolvedImage"?U=No.fromString(U.toString()):ei(U)!==L.type&&(L.type!=="enum"||!L.values[U])&&(U=void 0),So(U,D.default,L.default)}function zs(D,L,U,$){var ve=$-U,we=D-U;return ve===0?0:L===1?we/ve:(Math.pow(L,we)-1)/(Math.pow(L,ve)-1)}var Es=function(L,U){this.expression=L,this._warningHistory={},this._evaluator=new qs,this._defaultValue=U?df(U):null,this._enumValues=U&&U.type==="enum"?U.values:null};Es.prototype.evaluateWithoutErrorHandling=function(L,U,$,ve,we,Me){return this._evaluator.globals=L,this._evaluator.feature=U,this._evaluator.featureState=$,this._evaluator.canonical=ve,this._evaluator.availableImages=we||null,this._evaluator.formattedSection=Me,this.expression.evaluate(this._evaluator)},Es.prototype.evaluate=function(L,U,$,ve,we,Me){this._evaluator.globals=L,this._evaluator.feature=U||null,this._evaluator.featureState=$||null,this._evaluator.canonical=ve,this._evaluator.availableImages=we||null,this._evaluator.formattedSection=Me||null;try{var Oe=this.expression.evaluate(this._evaluator);if(Oe==null||typeof Oe=="number"&&Oe!==Oe)return this._defaultValue;if(this._enumValues&&!(Oe in this._enumValues))throw new Wi("Expected value to be one of "+Object.keys(this._enumValues).map(function(tt){return JSON.stringify(tt)}).join(", ")+", but found "+JSON.stringify(Oe)+" instead.");return Oe}catch(tt){return this._warningHistory[tt.message]||(this._warningHistory[tt.message]=!0,typeof console<"u"&&console.warn(tt.message)),this._defaultValue}};function Do(D){return Array.isArray(D)&&D.length>0&&typeof D[0]=="string"&&D[0]in $n}function cu(D,L){var U=new Uo($n,[],L?Xu(L):void 0),$=U.parse(D,void 0,void 0,void 0,L&&L.type==="string"?{typeAnnotation:"coerce"}:void 0);return $?Si(new Es($,L)):Fi(U.errors)}var Mu=function(L,U){this.kind=L,this._styleExpression=U,this.isStateDependent=L!=="constant"&&!Ll(U.expression)};Mu.prototype.evaluateWithoutErrorHandling=function(L,U,$,ve,we,Me){return this._styleExpression.evaluateWithoutErrorHandling(L,U,$,ve,we,Me)},Mu.prototype.evaluate=function(L,U,$,ve,we,Me){return this._styleExpression.evaluate(L,U,$,ve,we,Me)};var Cs=function(L,U,$,ve){this.kind=L,this.zoomStops=$,this._styleExpression=U,this.isStateDependent=L!=="camera"&&!Ll(U.expression),this.interpolationType=ve};Cs.prototype.evaluateWithoutErrorHandling=function(L,U,$,ve,we,Me){return this._styleExpression.evaluateWithoutErrorHandling(L,U,$,ve,we,Me)},Cs.prototype.evaluate=function(L,U,$,ve,we,Me){return this._styleExpression.evaluate(L,U,$,ve,we,Me)},Cs.prototype.interpolationFactor=function(L,U,$){return this.interpolationType?xo.interpolationFactor(this.interpolationType,L,U,$):0};function Wu(D,L){if(D=cu(D,L),D.result==="error")return D;var U=D.value.expression,$=Dl(U);if(!$&&!fi(L))return Fi([new _n("","data expressions not supported")]);var ve=Tu(U,["zoom"]);if(!ve&&!ko(L))return Fi([new _n("","zoom expressions not supported")]);var we=pf(U);if(!we&&!ve)return Fi([new _n("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(we instanceof _n)return Fi([we]);if(we instanceof xo&&!uo(L))return Fi([new _n("",'"interpolate" expressions cannot be used with this property')]);if(!we)return Si($?new Mu("constant",D.value):new Mu("source",D.value));var Me=we instanceof xo?we.interpolation:void 0;return Si($?new Cs("camera",D.value,we.labels,Me):new Cs("composite",D.value,we.labels,Me))}var hu=function(L,U){this._parameters=L,this._specification=U,dn(this,bo(this._parameters,this._specification))};hu.deserialize=function(L){return new hu(L._parameters,L._specification)},hu.serialize=function(L){return{_parameters:L._parameters,_specification:L._specification}};function lc(D,L){if(ga(D))return new hu(D,L);if(Do(D)){var U=Wu(D,L);if(U.result==="error")throw new Error(U.value.map(function(ve){return ve.key+": "+ve.message}).join(", "));return U.value}else{var $=D;return typeof D=="string"&&L.type==="color"&&($=bi.parse(D)),{kind:"constant",evaluate:function(){return $}}}}function pf(D){var L=null;if(D instanceof tl)L=pf(D.result);else if(D instanceof Ts)for(var U=0,$=D.args;U<$.length;U+=1){var ve=$[U];if(L=pf(ve),L)break}else(D instanceof Ys||D instanceof xo)&&D.input instanceof Oo&&D.input.name==="zoom"&&(L=D);return L instanceof _n||D.eachChild(function(we){var Me=pf(we);Me instanceof _n?L=Me:!L&&Me?L=new _n("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):L&&Me&&L!==Me&&(L=new _n("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),L}function Xu(D){var L={color:On,string:Br,number:br,enum:Br,boolean:mn,formatted:ma,resolvedImage:_a};return D.type==="array"?ua(L[D.value]||Tn,D.length):L[D.type]}function df(D){return D.type==="color"&&ga(D.default)?new bi(0,0,0,0):D.type==="color"?bi.parse(D.default)||null:D.default===void 0?null:D.default}function Zs(D){var L=D.key,U=D.value,$=D.valueSpec||{},ve=D.objectElementValidators||{},we=D.style,Me=D.styleSpec,Oe=[],tt=ei(U);if(tt!=="object")return[new pr(L,U,"object expected, "+tt+" found")];for(var pt in U){var gt=pt.split(".")[0],Nt=$[gt]||$["*"],nr=void 0;if(ve[gt])nr=ve[gt];else if($[gt])nr=mi;else if(ve["*"])nr=ve["*"];else if($["*"])nr=mi;else{Oe.push(new pr(L,U[pt],'unknown property "'+pt+'"'));continue}Oe=Oe.concat(nr({key:(L&&L+".")+pt,value:U[pt],valueSpec:Nt,style:we,styleSpec:Me,object:U,objectKey:pt},U))}for(var qt in $)ve[qt]||$[qt].required&&$[qt].default===void 0&&U[qt]===void 0&&Oe.push(new pr(L,U,'missing required property "'+qt+'"'));return Oe}function Df(D){var L=D.value,U=D.valueSpec,$=D.style,ve=D.styleSpec,we=D.key,Me=D.arrayElementValidator||mi;if(ei(L)!=="array")return[new pr(we,L,"array expected, "+ei(L)+" found")];if(U.length&&L.length!==U.length)return[new pr(we,L,"array length "+U.length+" expected, length "+L.length+" found")];if(U["min-length"]&&L.length<U["min-length"])return[new pr(we,L,"array length at least "+U["min-length"]+" expected, length "+L.length+" found")];var Oe={type:U.value,values:U.values};ve.$version<7&&(Oe.function=U.function),ei(U.value)==="object"&&(Oe=U.value);for(var tt=[],pt=0;pt<L.length;pt++)tt=tt.concat(Me({array:L,arrayIndex:pt,value:L[pt],valueSpec:Oe,style:$,styleSpec:ve,key:we+"["+pt+"]"}));return tt}function gf(D){var L=D.key,U=D.value,$=D.valueSpec,ve=ei(U);return ve==="number"&&U!==U&&(ve="NaN"),ve!=="number"?[new pr(L,U,"number expected, "+ve+" found")]:"minimum"in $&&U<$.minimum?[new pr(L,U,U+" is less than the minimum value "+$.minimum)]:"maximum"in $&&U>$.maximum?[new pr(L,U,U+" is greater than the maximum value "+$.maximum)]:[]}function yf(D){var L=D.valueSpec,U=rn(D.value.type),$,ve={},we,Me,Oe=U!=="categorical"&&D.value.property===void 0,tt=!Oe,pt=ei(D.value.stops)==="array"&&ei(D.value.stops[0])==="array"&&ei(D.value.stops[0][0])==="object",gt=Zs({key:D.key,value:D.value,valueSpec:D.styleSpec.function,style:D.style,styleSpec:D.styleSpec,objectElementValidators:{stops:Nt,default:yr}});return U==="identity"&&Oe&&gt.push(new pr(D.key,D.value,'missing required property "property"')),U!=="identity"&&!D.value.stops&&gt.push(new pr(D.key,D.value,'missing required property "stops"')),U==="exponential"&&D.valueSpec.expression&&!uo(D.valueSpec)&&gt.push(new pr(D.key,D.value,"exponential functions not supported")),D.styleSpec.$version>=8&&(tt&&!fi(D.valueSpec)?gt.push(new pr(D.key,D.value,"property functions not supported")):Oe&&!ko(D.valueSpec)&&gt.push(new pr(D.key,D.value,"zoom functions not supported"))),(U==="categorical"||pt)&&D.value.property===void 0&&gt.push(new pr(D.key,D.value,'"property" property is required')),gt;function Nt(Nr){if(U==="identity")return[new pr(Nr.key,Nr.value,'identity function may not have a "stops" property')];var ln=[],en=Nr.value;return ln=ln.concat(Df({key:Nr.key,value:en,valueSpec:Nr.valueSpec,style:Nr.style,styleSpec:Nr.styleSpec,arrayElementValidator:nr})),ei(en)==="array"&&en.length===0&&ln.push(new pr(Nr.key,en,"array must have at least one stop")),ln}function nr(Nr){var ln=[],en=Nr.value,kn=Nr.key;if(ei(en)!=="array")return[new pr(kn,en,"array expected, "+ei(en)+" found")];if(en.length!==2)return[new pr(kn,en,"array length 2 expected, length "+en.length+" found")];if(pt){if(ei(en[0])!=="object")return[new pr(kn,en,"object expected, "+ei(en[0])+" found")];if(en[0].zoom===void 0)return[new pr(kn,en,"object stop key must have zoom")];if(en[0].value===void 0)return[new pr(kn,en,"object stop key must have value")];if(Me&&Me>rn(en[0].zoom))return[new pr(kn,en[0].zoom,"stop zoom values must appear in ascending order")];rn(en[0].zoom)!==Me&&(Me=rn(en[0].zoom),we=void 0,ve={}),ln=ln.concat(Zs({key:kn+"[0]",value:en[0],valueSpec:{zoom:{}},style:Nr.style,styleSpec:Nr.styleSpec,objectElementValidators:{zoom:gf,value:qt}}))}else ln=ln.concat(qt({key:kn+"[0]",value:en[0],valueSpec:{},style:Nr.style,styleSpec:Nr.styleSpec},en));return Do(Mn(en[1]))?ln.concat([new pr(kn+"[1]",en[1],"expressions are not allowed in function stops.")]):ln.concat(mi({key:kn+"[1]",value:en[1],valueSpec:L,style:Nr.style,styleSpec:Nr.styleSpec}))}function qt(Nr,ln){var en=ei(Nr.value),kn=rn(Nr.value),bn=Nr.value!==null?Nr.value:ln;if(!$)$=en;else if(en!==$)return[new pr(Nr.key,bn,en+" stop domain type must match previous stop domain type "+$)];if(en!=="number"&&en!=="string"&&en!=="boolean")return[new pr(Nr.key,bn,"stop domain value must be a number, string, or boolean")];if(en!=="number"&&U!=="categorical"){var Cn="number expected, "+en+" found";return fi(L)&&U===void 0&&(Cn+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new pr(Nr.key,bn,Cn)]}return U==="categorical"&&en==="number"&&(!isFinite(kn)||Math.floor(kn)!==kn)?[new pr(Nr.key,bn,"integer expected, found "+kn)]:U!=="categorical"&&en==="number"&&we!==void 0&&kn<we?[new pr(Nr.key,bn,"stop domain values must appear in ascending order")]:(we=kn,U==="categorical"&&kn in ve?[new pr(Nr.key,bn,"stop domain values must be unique")]:(ve[kn]=!0,[]))}function yr(Nr){return mi({key:Nr.key,value:Nr.value,valueSpec:L,style:Nr.style,styleSpec:Nr.styleSpec})}}function Ko(D){var L=(D.expressionContext==="property"?Wu:cu)(Mn(D.value),D.valueSpec);if(L.result==="error")return L.value.map(function($){return new pr(""+D.key+$.key,D.value,$.message)});var U=L.value.expression||L.value._styleExpression.expression;if(D.expressionContext==="property"&&D.propertyKey==="text-font"&&!U.outputDefined())return[new pr(D.key,D.value,'Invalid data expression for "'+D.propertyKey+'". Output values must be contained as literals within the expression.')];if(D.expressionContext==="property"&&D.propertyType==="layout"&&!Ll(U))return[new pr(D.key,D.value,'"feature-state" data expressions are not supported with layout properties.')];if(D.expressionContext==="filter"&&!Ll(U))return[new pr(D.key,D.value,'"feature-state" data expressions are not supported with filters.')];if(D.expressionContext&&D.expressionContext.indexOf("cluster")===0){if(!Tu(U,["zoom","feature-state"]))return[new pr(D.key,D.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(D.expressionContext==="cluster-initial"&&!Dl(U))return[new pr(D.key,D.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function mf(D){var L=D.value,U=D.key,$=ei(L);return $!=="boolean"?[new pr(U,L,"boolean expected, "+$+" found")]:[]}function Vf(D){var L=D.key,U=D.value,$=ei(U);return $!=="string"?[new pr(L,U,"color expected, "+$+" found")]:mu(U)===null?[new pr(L,U,'color expected, "'+U+'" found')]:[]}function Bs(D){var L=D.key,U=D.value,$=D.valueSpec,ve=[];return Array.isArray($.values)?$.values.indexOf(rn(U))===-1&&ve.push(new pr(L,U,"expected one of ["+$.values.join(", ")+"], "+JSON.stringify(U)+" found")):Object.keys($.values).indexOf(rn(U))===-1&&ve.push(new pr(L,U,"expected one of ["+Object.keys($.values).join(", ")+"], "+JSON.stringify(U)+" found")),ve}function Zu(D){if(D===!0||D===!1)return!0;if(!Array.isArray(D)||D.length===0)return!1;switch(D[0]){case"has":return D.length>=2&&D[1]!=="$id"&&D[1]!=="$type";case"in":return D.length>=3&&(typeof D[1]!="string"||Array.isArray(D[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return D.length!==3||Array.isArray(D[1])||Array.isArray(D[2]);case"any":case"all":for(var L=0,U=D.slice(1);L<U.length;L+=1){var $=U[L];if(!Zu($)&&typeof $!="boolean")return!1}return!0;default:return!0}}var ju={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function xf(D){if(D==null)return{filter:function(){return!0},needGeometry:!1};Zu(D)||(D=rt(D));var L=cu(D,ju);if(L.result==="error")throw new Error(L.value.map(function($){return $.key+": "+$.message}).join(", "));var U=je(D);return{filter:function($,ve,we){return L.value.evaluate($,ve,{},we)},needGeometry:U}}function Ne(D,L){return D<L?-1:D>L?1:0}function je(D){if(!Array.isArray(D))return!1;if(D[0]==="within")return!0;for(var L=1;L<D.length;L++)if(je(D[L]))return!0;return!1}function rt(D){if(!D)return!0;var L=D[0];if(D.length<=1)return L!=="any";var U=L==="=="?lt(D[1],D[2],"=="):L==="!="?hr(lt(D[1],D[2],"==")):L==="<"||L===">"||L==="<="||L===">="?lt(D[1],D[2],L):L==="any"?wt(D.slice(1)):L==="all"?["all"].concat(D.slice(1).map(rt)):L==="none"?["all"].concat(D.slice(1).map(rt).map(hr)):L==="in"?bt(D[1],D.slice(2)):L==="!in"?hr(bt(D[1],D.slice(2))):L==="has"?kt(D[1]):L==="!has"?hr(kt(D[1])):L==="within"?D:!0;return U}function lt(D,L,U){switch(D){case"$type":return["filter-type-"+U,L];case"$id":return["filter-id-"+U,L];default:return["filter-"+U,D,L]}}function wt(D){return["any"].concat(D.map(rt))}function bt(D,L){if(L.length===0)return!1;switch(D){case"$type":return["filter-type-in",["literal",L]];case"$id":return["filter-id-in",["literal",L]];default:return L.length>200&&!L.some(function(U){return typeof U!=typeof L[0]})?["filter-in-large",D,["literal",L.sort(Ne)]]:["filter-in-small",D,["literal",L]]}}function kt(D){switch(D){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",D]}}function hr(D){return["!",D]}function gr(D){return Zu(Mn(D.value))?Ko(dn({},D,{expressionContext:"filter",valueSpec:{value:"boolean"}})):fr(D)}function fr(D){var L=D.value,U=D.key;if(ei(L)!=="array")return[new pr(U,L,"array expected, "+ei(L)+" found")];var $=D.styleSpec,ve,we=[];if(L.length<1)return[new pr(U,L,"filter array must have at least 1 element")];switch(we=we.concat(Bs({key:U+"[0]",value:L[0],valueSpec:$.filter_operator,style:D.style,styleSpec:D.styleSpec})),rn(L[0])){case"<":case"<=":case">":case">=":L.length>=2&&rn(L[1])==="$type"&&we.push(new pr(U,L,'"$type" cannot be use with operator "'+L[0]+'"'));case"==":case"!=":L.length!==3&&we.push(new pr(U,L,'filter array for operator "'+L[0]+'" must have 3 elements'));case"in":case"!in":L.length>=2&&(ve=ei(L[1]),ve!=="string"&&we.push(new pr(U+"[1]",L[1],"string expected, "+ve+" found")));for(var Me=2;Me<L.length;Me++)ve=ei(L[Me]),rn(L[1])==="$type"?we=we.concat(Bs({key:U+"["+Me+"]",value:L[Me],valueSpec:$.geometry_type,style:D.style,styleSpec:D.styleSpec})):ve!=="string"&&ve!=="number"&&ve!=="boolean"&&we.push(new pr(U+"["+Me+"]",L[Me],"string, number, or boolean expected, "+ve+" found"));break;case"any":case"all":case"none":for(var Oe=1;Oe<L.length;Oe++)we=we.concat(fr({key:U+"["+Oe+"]",value:L[Oe],style:D.style,styleSpec:D.styleSpec}));break;case"has":case"!has":ve=ei(L[1]),L.length!==2?we.push(new pr(U,L,'filter array for "'+L[0]+'" operator must have 2 elements')):ve!=="string"&&we.push(new pr(U+"[1]",L[1],"string expected, "+ve+" found"));break;case"within":ve=ei(L[1]),L.length!==2?we.push(new pr(U,L,'filter array for "'+L[0]+'" operator must have 2 elements')):ve!=="object"&&we.push(new pr(U+"[1]",L[1],"object expected, "+ve+" found"));break}return we}function _r(D,L){var U=D.key,$=D.style,ve=D.styleSpec,we=D.value,Me=D.objectKey,Oe=ve[L+"_"+D.layerType];if(!Oe)return[];var tt=Me.match(/^(.*)-transition$/);if(L==="paint"&&tt&&Oe[tt[1]]&&Oe[tt[1]].transition)return mi({key:U,value:we,valueSpec:ve.transition,style:$,styleSpec:ve});var pt=D.valueSpec||Oe[Me];if(!pt)return[new pr(U,we,'unknown property "'+Me+'"')];var gt;if(ei(we)==="string"&&fi(pt)&&!pt.tokens&&(gt=/^{([^}]+)}$/.exec(we)))return[new pr(U,we,'"'+Me+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(gt[1])+" }`.")];var Nt=[];return D.layerType==="symbol"&&(Me==="text-field"&&$&&!$.glyphs&&Nt.push(new pr(U,we,'use of "text-field" requires a style "glyphs" property')),Me==="text-font"&&ga(Mn(we))&&rn(we.type)==="identity"&&Nt.push(new pr(U,we,'"text-font" does not support identity functions'))),Nt.concat(mi({key:D.key,value:we,valueSpec:pt,style:$,styleSpec:ve,expressionContext:"property",propertyType:L,propertyKey:Me}))}function Rr(D){return _r(D,"paint")}function jr(D){return _r(D,"layout")}function tn(D){var L=[],U=D.value,$=D.key,ve=D.style,we=D.styleSpec;!U.type&&!U.ref&&L.push(new pr($,U,'either "type" or "ref" is required'));var Me=rn(U.type),Oe=rn(U.ref);if(U.id)for(var tt=rn(U.id),pt=0;pt<D.arrayIndex;pt++){var gt=ve.layers[pt];rn(gt.id)===tt&&L.push(new pr($,U.id,'duplicate layer id "'+U.id+'", previously used at line '+gt.id.__line__))}if("ref"in U){["type","source","source-layer","filter","layout"].forEach(function(yr){yr in U&&L.push(new pr($,U[yr],'"'+yr+'" is prohibited for ref layers'))});var Nt;ve.layers.forEach(function(yr){rn(yr.id)===Oe&&(Nt=yr)}),Nt?Nt.ref?L.push(new pr($,U.ref,"ref cannot reference another ref layer")):Me=rn(Nt.type):L.push(new pr($,U.ref,'ref layer "'+Oe+'" not found'))}else if(Me!=="background")if(!U.source)L.push(new pr($,U,'missing required property "source"'));else{var nr=ve.sources&&ve.sources[U.source],qt=nr&&rn(nr.type);nr?qt==="vector"&&Me==="raster"?L.push(new pr($,U.source,'layer "'+U.id+'" requires a raster source')):qt==="raster"&&Me!=="raster"?L.push(new pr($,U.source,'layer "'+U.id+'" requires a vector source')):qt==="vector"&&!U["source-layer"]?L.push(new pr($,U,'layer "'+U.id+'" must specify a "source-layer"')):qt==="raster-dem"&&Me!=="hillshade"?L.push(new pr($,U.source,"raster-dem source can only be used with layer type 'hillshade'.")):Me==="line"&&U.paint&&U.paint["line-gradient"]&&(qt!=="geojson"||!nr.lineMetrics)&&L.push(new pr($,U,'layer "'+U.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):L.push(new pr($,U.source,'source "'+U.source+'" not found'))}return L=L.concat(Zs({key:$,value:U,valueSpec:we.layer,style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return mi({key:$+".type",value:U.type,valueSpec:we.layer.type,style:D.style,styleSpec:D.styleSpec,object:U,objectKey:"type"})},filter:gr,layout:function(Nr){return Zs({layer:U,key:Nr.key,value:Nr.value,style:Nr.style,styleSpec:Nr.styleSpec,objectElementValidators:{"*":function(en){return jr(dn({layerType:Me},en))}}})},paint:function(Nr){return Zs({layer:U,key:Nr.key,value:Nr.value,style:Nr.style,styleSpec:Nr.styleSpec,objectElementValidators:{"*":function(en){return Rr(dn({layerType:Me},en))}}})}}})),L}function wn(D){var L=D.value,U=D.key,$=ei(L);return $!=="string"?[new pr(U,L,"string expected, "+$+" found")]:[]}var Rn={promoteId:xa};function Zn(D){var L=D.value,U=D.key,$=D.styleSpec,ve=D.style;if(!L.type)return[new pr(U,L,'"type" is required')];var we=rn(L.type),Me;switch(we){case"vector":case"raster":case"raster-dem":return Me=Zs({key:U,value:L,valueSpec:$["source_"+we.replace("-","_")],style:D.style,styleSpec:$,objectElementValidators:Rn}),Me;case"geojson":if(Me=Zs({key:U,value:L,valueSpec:$.source_geojson,style:ve,styleSpec:$,objectElementValidators:Rn}),L.cluster)for(var Oe in L.clusterProperties){var tt=L.clusterProperties[Oe],pt=tt[0],gt=tt[1],Nt=typeof pt=="string"?[pt,["accumulated"],["get",Oe]]:pt;Me.push.apply(Me,Ko({key:U+"."+Oe+".map",value:gt,expressionContext:"cluster-map"})),Me.push.apply(Me,Ko({key:U+"."+Oe+".reduce",value:Nt,expressionContext:"cluster-reduce"}))}return Me;case"video":return Zs({key:U,value:L,valueSpec:$.source_video,style:ve,styleSpec:$});case"image":return Zs({key:U,value:L,valueSpec:$.source_image,style:ve,styleSpec:$});case"canvas":return[new pr(U,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bs({key:U+".type",value:L.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:ve,styleSpec:$})}}function xa(D){var L=D.key,U=D.value;if(ei(U)==="string")return wn({key:L,value:U});var $=[];for(var ve in U)$.push.apply($,wn({key:L+"."+ve,value:U[ve]}));return $}function wa(D){var L=D.value,U=D.styleSpec,$=U.light,ve=D.style,we=[],Me=ei(L);if(L===void 0)return we;if(Me!=="object")return we=we.concat([new pr("light",L,"object expected, "+Me+" found")]),we;for(var Oe in L){var tt=Oe.match(/^(.*)-transition$/);tt&&$[tt[1]]&&$[tt[1]].transition?we=we.concat(mi({key:Oe,value:L[Oe],valueSpec:U.transition,style:ve,styleSpec:U})):$[Oe]?we=we.concat(mi({key:Oe,value:L[Oe],valueSpec:$[Oe],style:ve,styleSpec:U})):we=we.concat([new pr(Oe,L[Oe],'unknown property "'+Oe+'"')])}return we}function qa(D){return wn(D).length===0?[]:Ko(D)}function ja(D){return wn(D).length===0?[]:Ko(D)}var ai={"*":function(){return[]},array:Df,boolean:mf,number:gf,color:Vf,constants:on,enum:Bs,filter:gr,function:yf,layer:tn,object:Zs,source:Zn,light:wa,string:wn,formatted:qa,resolvedImage:ja};function mi(D){var L=D.value,U=D.valueSpec,$=D.styleSpec;if(U.expression&&ga(rn(L)))return yf(D);if(U.expression&&Do(Mn(L)))return Ko(D);if(U.type&&ai[U.type])return ai[U.type](D);var ve=Zs(dn({},D,{valueSpec:U.type?$[U.type]:U}));return ve}function po(D){var L=D.value,U=D.key,$=wn(D);return $.length||(L.indexOf("{fontstack}")===-1&&$.push(new pr(U,L,'"glyphs" url must include a "{fontstack}" token')),L.indexOf("{range}")===-1&&$.push(new pr(U,L,'"glyphs" url must include a "{range}" token'))),$}function oi(D,L){L===void 0&&(L=Gt);var U=[];return U=U.concat(mi({key:"",value:D,valueSpec:L.$root,styleSpec:L,style:D,objectElementValidators:{glyphs:po,"*":function(){return[]}}})),D.constants&&(U=U.concat(on({key:"constants",value:D.constants,style:D,styleSpec:L}))),$i(U)}oi.source=_o(Zn),oi.light=_o(wa),oi.layer=_o(tn),oi.filter=_o(gr),oi.paintProperty=_o(Rr),oi.layoutProperty=_o(jr);function $i(D){return[].concat(D).sort(function(L,U){return L.line-U.line})}function _o(D){return function(){for(var L=[],U=arguments.length;U--;)L[U]=arguments[U];return $i(D.apply(this,L))}}var Ro=oi,Ci=Ro.light,Ri=Ro.paintProperty,ks=Ro.layoutProperty;function Eo(D,L){var U=!1;if(L&&L.length)for(var $=0,ve=L;$<ve.length;$+=1){var we=ve[$];D.fire(new wr(new Error(we.message))),U=!0}return U}var Yo=fe,os=3;function fe(D,L,U){var $=this.cells=[];if(D instanceof ArrayBuffer){this.arrayBuffer=D;var ve=new Int32Array(this.arrayBuffer);D=ve[0],L=ve[1],U=ve[2],this.d=L+2*U;for(var we=0;we<this.d*this.d;we++){var Me=ve[os+we],Oe=ve[os+we+1];$.push(Me===Oe?null:ve.subarray(Me,Oe))}var tt=ve[os+$.length],pt=ve[os+$.length+1];this.keys=ve.subarray(tt,pt),this.bboxes=ve.subarray(pt),this.insert=this._insertReadonly}else{this.d=L+2*U;for(var gt=0;gt<this.d*this.d;gt++)$.push([]);this.keys=[],this.bboxes=[]}this.n=L,this.extent=D,this.padding=U,this.scale=L/D,this.uid=0;var Nt=U/L*D;this.min=-Nt,this.max=D+Nt}fe.prototype.insert=function(D,L,U,$,ve){this._forEachCell(L,U,$,ve,this._insertCell,this.uid++),this.keys.push(D),this.bboxes.push(L),this.bboxes.push(U),this.bboxes.push($),this.bboxes.push(ve)},fe.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},fe.prototype._insertCell=function(D,L,U,$,ve,we){this.cells[ve].push(we)},fe.prototype.query=function(D,L,U,$,ve){var we=this.min,Me=this.max;if(D<=we&&L<=we&&Me<=U&&Me<=$&&!ve)return Array.prototype.slice.call(this.keys);var Oe=[],tt={};return this._forEachCell(D,L,U,$,this._queryCell,Oe,tt,ve),Oe},fe.prototype._queryCell=function(D,L,U,$,ve,we,Me,Oe){var tt=this.cells[ve];if(tt!==null)for(var pt=this.keys,gt=this.bboxes,Nt=0;Nt<tt.length;Nt++){var nr=tt[Nt];if(Me[nr]===void 0){var qt=nr*4;(Oe?Oe(gt[qt+0],gt[qt+1],gt[qt+2],gt[qt+3]):D<=gt[qt+2]&&L<=gt[qt+3]&&U>=gt[qt+0]&&$>=gt[qt+1])?(Me[nr]=!0,we.push(pt[nr])):Me[nr]=!1}}},fe.prototype._forEachCell=function(D,L,U,$,ve,we,Me,Oe){for(var tt=this._convertToCellCoord(D),pt=this._convertToCellCoord(L),gt=this._convertToCellCoord(U),Nt=this._convertToCellCoord($),nr=tt;nr<=gt;nr++)for(var qt=pt;qt<=Nt;qt++){var yr=this.d*qt+nr;if(!(Oe&&!Oe(this._convertFromCellCoord(nr),this._convertFromCellCoord(qt),this._convertFromCellCoord(nr+1),this._convertFromCellCoord(qt+1)))&&ve.call(this,D,L,U,$,yr,we,Me,Oe))return}},fe.prototype._convertFromCellCoord=function(D){return(D-this.padding)/this.scale},fe.prototype._convertToCellCoord=function(D){return Math.max(0,Math.min(this.d-1,Math.floor(D*this.scale)+this.padding))},fe.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var D=this.cells,L=os+this.cells.length+1+1,U=0,$=0;$<this.cells.length;$++)U+=this.cells[$].length;var ve=new Int32Array(L+U+this.keys.length+this.bboxes.length);ve[0]=this.extent,ve[1]=this.n,ve[2]=this.padding;for(var we=L,Me=0;Me<D.length;Me++){var Oe=D[Me];ve[os+Me]=we,ve.set(Oe,we),we+=Oe.length}return ve[os+D.length]=we,ve.set(this.keys,we),we+=this.keys.length,ve[os+D.length+1]=we,ve.set(this.bboxes,we),we+=this.bboxes.length,ve.buffer};var Ae=self.ImageData,Fe=self.ImageBitmap,Ve={};function Ue(D,L,U){U===void 0&&(U={}),Object.defineProperty(L,"_classRegistryKey",{value:D,writeable:!1}),Ve[D]={klass:L,omit:U.omit||[],shallow:U.shallow||[]}}Ue("Object",Object),Yo.serialize=function(L,U){var $=L.toArrayBuffer();return U&&U.push($),{buffer:$}},Yo.deserialize=function(L){return new Yo(L.buffer)},Ue("Grid",Yo),Ue("Color",bi),Ue("Error",Error),Ue("ResolvedImage",No),Ue("StylePropertyFunction",hu),Ue("StyleExpression",Es,{omit:["_evaluator"]}),Ue("ZoomDependentExpression",Cs),Ue("ZoomConstantExpression",Mu),Ue("CompoundExpression",Oo,{omit:["_evaluate"]});for(var Qe in $n)$n[Qe]._classRegistryKey||Ue("Expression_"+Qe,$n[Qe]);function _t(D){return D&&typeof ArrayBuffer<"u"&&(D instanceof ArrayBuffer||D.constructor&&D.constructor.name==="ArrayBuffer")}function dt(D){return Fe&&D instanceof Fe}function It(D,L){if(D==null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"||D instanceof Boolean||D instanceof Number||D instanceof String||D instanceof Date||D instanceof RegExp)return D;if(_t(D)||dt(D))return L&&L.push(D),D;if(ArrayBuffer.isView(D)){var U=D;return L&&L.push(U.buffer),U}if(D instanceof Ae)return L&&L.push(D.data.buffer),D;if(Array.isArray(D)){for(var $=[],ve=0,we=D;ve<we.length;ve+=1){var Me=we[ve];$.push(It(Me,L))}return $}if(typeof D=="object"){var Oe=D.constructor,tt=Oe._classRegistryKey;if(!tt)throw new Error("can't serialize object of unregistered class");var pt=Oe.serialize?Oe.serialize(D,L):{};if(!Oe.serialize){for(var gt in D)if(!!D.hasOwnProperty(gt)&&!(Ve[tt].omit.indexOf(gt)>=0)){var Nt=D[gt];pt[gt]=Ve[tt].shallow.indexOf(gt)>=0?Nt:It(Nt,L)}D instanceof Error&&(pt.message=D.message)}if(pt.$name)throw new Error("$name property is reserved for worker serialization logic.");return tt!=="Object"&&(pt.$name=tt),pt}throw new Error("can't serialize object of type "+typeof D)}function Qt(D){if(D==null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"||D instanceof Boolean||D instanceof Number||D instanceof String||D instanceof Date||D instanceof RegExp||_t(D)||dt(D)||ArrayBuffer.isView(D)||D instanceof Ae)return D;if(Array.isArray(D))return D.map(Qt);if(typeof D=="object"){var L=D.$name||"Object",U=Ve[L],$=U.klass;if(!$)throw new Error("can't deserialize unregistered class "+L);if($.deserialize)return $.deserialize(D);for(var ve=Object.create($.prototype),we=0,Me=Object.keys(D);we<Me.length;we+=1){var Oe=Me[we];if(Oe!=="$name"){var tt=D[Oe];ve[Oe]=Ve[L].shallow.indexOf(Oe)>=0?tt:Qt(tt)}}return ve}throw new Error("can't deserialize object of type "+typeof D)}var tr=function(){this.first=!0};tr.prototype.update=function(L,U){var $=Math.floor(L);return this.first?(this.first=!1,this.lastIntegerZoom=$,this.lastIntegerZoomTime=0,this.lastZoom=L,this.lastFloorZoom=$,!0):(this.lastFloorZoom>$?(this.lastIntegerZoom=$+1,this.lastIntegerZoomTime=U):this.lastFloorZoom<$&&(this.lastIntegerZoom=$,this.lastIntegerZoomTime=U),L!==this.lastZoom?(this.lastZoom=L,this.lastFloorZoom=$,!0):!1)};var rr={"Latin-1 Supplement":function(D){return D>=128&&D<=255},Arabic:function(D){return D>=1536&&D<=1791},"Arabic Supplement":function(D){return D>=1872&&D<=1919},"Arabic Extended-A":function(D){return D>=2208&&D<=2303},"Hangul Jamo":function(D){return D>=4352&&D<=4607},"Unified Canadian Aboriginal Syllabics":function(D){return D>=5120&&D<=5759},Khmer:function(D){return D>=6016&&D<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(D){return D>=6320&&D<=6399},"General Punctuation":function(D){return D>=8192&&D<=8303},"Letterlike Symbols":function(D){return D>=8448&&D<=8527},"Number Forms":function(D){return D>=8528&&D<=8591},"Miscellaneous Technical":function(D){return D>=8960&&D<=9215},"Control Pictures":function(D){return D>=9216&&D<=9279},"Optical Character Recognition":function(D){return D>=9280&&D<=9311},"Enclosed Alphanumerics":function(D){return D>=9312&&D<=9471},"Geometric Shapes":function(D){return D>=9632&&D<=9727},"Miscellaneous Symbols":function(D){return D>=9728&&D<=9983},"Miscellaneous Symbols and Arrows":function(D){return D>=11008&&D<=11263},"CJK Radicals Supplement":function(D){return D>=11904&&D<=12031},"Kangxi Radicals":function(D){return D>=12032&&D<=12255},"Ideographic Description Characters":function(D){return D>=12272&&D<=12287},"CJK Symbols and Punctuation":function(D){return D>=12288&&D<=12351},Hiragana:function(D){return D>=12352&&D<=12447},Katakana:function(D){return D>=12448&&D<=12543},Bopomofo:function(D){return D>=12544&&D<=12591},"Hangul Compatibility Jamo":function(D){return D>=12592&&D<=12687},Kanbun:function(D){return D>=12688&&D<=12703},"Bopomofo Extended":function(D){return D>=12704&&D<=12735},"CJK Strokes":function(D){return D>=12736&&D<=12783},"Katakana Phonetic Extensions":function(D){return D>=12784&&D<=12799},"Enclosed CJK Letters and Months":function(D){return D>=12800&&D<=13055},"CJK Compatibility":function(D){return D>=13056&&D<=13311},"CJK Unified Ideographs Extension A":function(D){return D>=13312&&D<=19903},"Yijing Hexagram Symbols":function(D){return D>=19904&&D<=19967},"CJK Unified Ideographs":function(D){return D>=19968&&D<=40959},"Yi Syllables":function(D){return D>=40960&&D<=42127},"Yi Radicals":function(D){return D>=42128&&D<=42191},"Hangul Jamo Extended-A":function(D){return D>=43360&&D<=43391},"Hangul Syllables":function(D){return D>=44032&&D<=55215},"Hangul Jamo Extended-B":function(D){return D>=55216&&D<=55295},"Private Use Area":function(D){return D>=57344&&D<=63743},"CJK Compatibility Ideographs":function(D){return D>=63744&&D<=64255},"Arabic Presentation Forms-A":function(D){return D>=64336&&D<=65023},"Vertical Forms":function(D){return D>=65040&&D<=65055},"CJK Compatibility Forms":function(D){return D>=65072&&D<=65103},"Small Form Variants":function(D){return D>=65104&&D<=65135},"Arabic Presentation Forms-B":function(D){return D>=65136&&D<=65279},"Halfwidth and Fullwidth Forms":function(D){return D>=65280&&D<=65519}};function Er(D){for(var L=0,U=D;L<U.length;L+=1){var $=U[L];if(Vr($.charCodeAt(0)))return!0}return!1}function qr(D){for(var L=0,U=D;L<U.length;L+=1){var $=U[L];if(!fn($.charCodeAt(0)))return!1}return!0}function fn(D){return!(rr.Arabic(D)||rr["Arabic Supplement"](D)||rr["Arabic Extended-A"](D)||rr["Arabic Presentation Forms-A"](D)||rr["Arabic Presentation Forms-B"](D))}function Pr(D){return D<11904?!1:!!(rr["Bopomofo Extended"](D)||rr.Bopomofo(D)||rr["CJK Compatibility Forms"](D)||rr["CJK Compatibility Ideographs"](D)||rr["CJK Compatibility"](D)||rr["CJK Radicals Supplement"](D)||rr["CJK Strokes"](D)||rr["CJK Symbols and Punctuation"](D)||rr["CJK Unified Ideographs Extension A"](D)||rr["CJK Unified Ideographs"](D)||rr["Enclosed CJK Letters and Months"](D)||rr["Halfwidth and Fullwidth Forms"](D)||rr.Hiragana(D)||rr["Ideographic Description Characters"](D)||rr["Kangxi Radicals"](D)||rr["Katakana Phonetic Extensions"](D)||rr.Katakana(D)||rr["Vertical Forms"](D)||rr["Yi Radicals"](D)||rr["Yi Syllables"](D))}function Vr(D){return D===746||D===747?!0:D<4352?!1:!!(rr["Bopomofo Extended"](D)||rr.Bopomofo(D)||rr["CJK Compatibility Forms"](D)&&!(D>=65097&&D<=65103)||rr["CJK Compatibility Ideographs"](D)||rr["CJK Compatibility"](D)||rr["CJK Radicals Supplement"](D)||rr["CJK Strokes"](D)||rr["CJK Symbols and Punctuation"](D)&&!(D>=12296&&D<=12305)&&!(D>=12308&&D<=12319)&&D!==12336||rr["CJK Unified Ideographs Extension A"](D)||rr["CJK Unified Ideographs"](D)||rr["Enclosed CJK Letters and Months"](D)||rr["Hangul Compatibility Jamo"](D)||rr["Hangul Jamo Extended-A"](D)||rr["Hangul Jamo Extended-B"](D)||rr["Hangul Jamo"](D)||rr["Hangul Syllables"](D)||rr.Hiragana(D)||rr["Ideographic Description Characters"](D)||rr.Kanbun(D)||rr["Kangxi Radicals"](D)||rr["Katakana Phonetic Extensions"](D)||rr.Katakana(D)&&D!==12540||rr["Halfwidth and Fullwidth Forms"](D)&&D!==65288&&D!==65289&&D!==65293&&!(D>=65306&&D<=65310)&&D!==65339&&D!==65341&&D!==65343&&!(D>=65371&&D<=65503)&&D!==65507&&!(D>=65512&&D<=65519)||rr["Small Form Variants"](D)&&!(D>=65112&&D<=65118)&&!(D>=65123&&D<=65126)||rr["Unified Canadian Aboriginal Syllabics"](D)||rr["Unified Canadian Aboriginal Syllabics Extended"](D)||rr["Vertical Forms"](D)||rr["Yijing Hexagram Symbols"](D)||rr["Yi Syllables"](D)||rr["Yi Radicals"](D))}function Jr(D){return!!(rr["Latin-1 Supplement"](D)&&(D===167||D===169||D===174||D===177||D===188||D===189||D===190||D===215||D===247)||rr["General Punctuation"](D)&&(D===8214||D===8224||D===8225||D===8240||D===8241||D===8251||D===8252||D===8258||D===8263||D===8264||D===8265||D===8273)||rr["Letterlike Symbols"](D)||rr["Number Forms"](D)||rr["Miscellaneous Technical"](D)&&(D>=8960&&D<=8967||D>=8972&&D<=8991||D>=8996&&D<=9e3||D===9003||D>=9085&&D<=9114||D>=9150&&D<=9165||D===9167||D>=9169&&D<=9179||D>=9186&&D<=9215)||rr["Control Pictures"](D)&&D!==9251||rr["Optical Character Recognition"](D)||rr["Enclosed Alphanumerics"](D)||rr["Geometric Shapes"](D)||rr["Miscellaneous Symbols"](D)&&!(D>=9754&&D<=9759)||rr["Miscellaneous Symbols and Arrows"](D)&&(D>=11026&&D<=11055||D>=11088&&D<=11097||D>=11192&&D<=11243)||rr["CJK Symbols and Punctuation"](D)||rr.Katakana(D)||rr["Private Use Area"](D)||rr["CJK Compatibility Forms"](D)||rr["Small Form Variants"](D)||rr["Halfwidth and Fullwidth Forms"](D)||D===8734||D===8756||D===8757||D>=9984&&D<=10087||D>=10102&&D<=10131||D===65532||D===65533)}function sn(D){return!(Vr(D)||Jr(D))}function un(D){return rr.Arabic(D)||rr["Arabic Supplement"](D)||rr["Arabic Extended-A"](D)||rr["Arabic Presentation Forms-A"](D)||rr["Arabic Presentation Forms-B"](D)}function Qr(D){return D>=1424&&D<=2303||rr["Arabic Presentation Forms-A"](D)||rr["Arabic Presentation Forms-B"](D)}function Hn(D,L){return!(!L&&Qr(D)||D>=2304&&D<=3583||D>=3840&&D<=4255||rr.Khmer(D))}function aa(D){for(var L=0,U=D;L<U.length;L+=1){var $=U[L];if(Qr($.charCodeAt(0)))return!0}return!1}function Aa(D,L){for(var U=0,$=D;U<$.length;U+=1){var ve=$[U];if(!Hn(ve.charCodeAt(0),L))return!1}return!0}var sa={unavailable:"unavailable",deferred:"deferred",loading:"loading",loaded:"loaded",error:"error"},Da=null,fa=sa.unavailable,Ha=null,Ra=function(D){D&&typeof D=="string"&&D.indexOf("NetworkError")>-1&&(fa=sa.error),Da&&Da(D)};function ri(){Ai.fire(new kr("pluginStateChange",{pluginStatus:fa,pluginURL:Ha}))}var Ai=new Sr,wo=function(){return fa},Gi=function(D){return D({pluginStatus:fa,pluginURL:Ha}),Ai.on("pluginStateChange",D),D},va=function(D,L,U){if(U===void 0&&(U=!1),fa===sa.deferred||fa===sa.loading||fa===sa.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ha=q.resolveURL(D),fa=sa.deferred,Da=L,ri(),U||li()},li=function(){if(fa!==sa.deferred||!Ha)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");fa=sa.loading,ri(),Ha&&ft({url:Ha},function(D){D?Ra(D):(fa=sa.loaded,ri())})},Ka={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return fa===sa.loaded||Ka.applyArabicShaping!=null},isLoading:function(){return fa===sa.loading},setState:function(L){fa=L.pluginStatus,Ha=L.pluginURL},isParsed:function(){return Ka.applyArabicShaping!=null&&Ka.processBidirectionalText!=null&&Ka.processStyledBidirectionalText!=null},getPluginURL:function(){return Ha}},Ii=function(){!Ka.isLoading()&&!Ka.isLoaded()&&wo()==="deferred"&&li()},ci=function(L,U){this.zoom=L,U?(this.now=U.now,this.fadeDuration=U.fadeDuration,this.zoomHistory=U.zoomHistory,this.transition=U.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new tr,this.transition={})};ci.prototype.isSupportedScript=function(L){return Aa(L,Ka.isLoaded())},ci.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ci.prototype.getCrossfadeParameters=function(){var L=this.zoom,U=L-Math.floor(L),$=this.crossFadingFactor();return L>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:U+(1-U)*$}:{fromScale:.5,toScale:1,t:1-(1-$)*U}};var go=function(L,U){this.property=L,this.value=U,this.expression=lc(U===void 0?L.specification.default:U,L.specification)};go.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},go.prototype.possiblyEvaluate=function(L,U,$){return this.property.possiblyEvaluate(this,L,U,$)};var so=function(L){this.property=L,this.value=new go(L,void 0)};so.prototype.transitioned=function(L,U){return new ss(this.property,this.value,U,M({},L.transition,this.transition),L.now)},so.prototype.untransitioned=function(){return new ss(this.property,this.value,null,{},0)};var Co=function(L){this._properties=L,this._values=Object.create(L.defaultTransitionablePropertyValues)};Co.prototype.getValue=function(L){return z(this._values[L].value.value)},Co.prototype.setValue=function(L,U){this._values.hasOwnProperty(L)||(this._values[L]=new so(this._values[L].property)),this._values[L].value=new go(this._values[L].property,U===null?void 0:z(U))},Co.prototype.getTransition=function(L){return z(this._values[L].transition)},Co.prototype.setTransition=function(L,U){this._values.hasOwnProperty(L)||(this._values[L]=new so(this._values[L].property)),this._values[L].transition=z(U)||void 0},Co.prototype.serialize=function(){for(var L={},U=0,$=Object.keys(this._values);U<$.length;U+=1){var ve=$[U],we=this.getValue(ve);we!==void 0&&(L[ve]=we);var Me=this.getTransition(ve);Me!==void 0&&(L[ve+"-transition"]=Me)}return L},Co.prototype.transitioned=function(L,U){for(var $=new Qo(this._properties),ve=0,we=Object.keys(this._values);ve<we.length;ve+=1){var Me=we[ve];$._values[Me]=this._values[Me].transitioned(L,U._values[Me])}return $},Co.prototype.untransitioned=function(){for(var L=new Qo(this._properties),U=0,$=Object.keys(this._values);U<$.length;U+=1){var ve=$[U];L._values[ve]=this._values[ve].untransitioned()}return L};var ss=function(L,U,$,ve,we){this.property=L,this.value=U,this.begin=we+ve.delay||0,this.end=this.begin+ve.duration||0,L.specification.transition&&(ve.delay||ve.duration)&&(this.prior=$)};ss.prototype.possiblyEvaluate=function(L,U,$){var ve=L.now||0,we=this.value.possiblyEvaluate(L,U,$),Me=this.prior;if(Me){if(ve>this.end)return this.prior=null,we;if(this.value.isDataDriven())return this.prior=null,we;if(ve<this.begin)return Me.possiblyEvaluate(L,U,$);var Oe=(ve-this.begin)/(this.end-this.begin);return this.property.interpolate(Me.possiblyEvaluate(L,U,$),we,m(Oe))}else return we};var Qo=function(L){this._properties=L,this._values=Object.create(L.defaultTransitioningPropertyValues)};Qo.prototype.possiblyEvaluate=function(L,U,$){for(var ve=new ji(this._properties),we=0,Me=Object.keys(this._values);we<Me.length;we+=1){var Oe=Me[we];ve._values[Oe]=this._values[Oe].possiblyEvaluate(L,U,$)}return ve},Qo.prototype.hasTransition=function(){for(var L=0,U=Object.keys(this._values);L<U.length;L+=1){var $=U[L];if(this._values[$].prior)return!0}return!1};var ls=function(L){this._properties=L,this._values=Object.create(L.defaultPropertyValues)};ls.prototype.getValue=function(L){return z(this._values[L].value)},ls.prototype.setValue=function(L,U){this._values[L]=new go(this._values[L].property,U===null?void 0:z(U))},ls.prototype.serialize=function(){for(var L={},U=0,$=Object.keys(this._values);U<$.length;U+=1){var ve=$[U],we=this.getValue(ve);we!==void 0&&(L[ve]=we)}return L},ls.prototype.possiblyEvaluate=function(L,U,$){for(var ve=new ji(this._properties),we=0,Me=Object.keys(this._values);we<Me.length;we+=1){var Oe=Me[we];ve._values[Oe]=this._values[Oe].possiblyEvaluate(L,U,$)}return ve};var qi=function(L,U,$){this.property=L,this.value=U,this.parameters=$};qi.prototype.isConstant=function(){return this.value.kind==="constant"},qi.prototype.constantOr=function(L){return this.value.kind==="constant"?this.value.value:L},qi.prototype.evaluate=function(L,U,$,ve){return this.property.evaluate(this.value,this.parameters,L,U,$,ve)};var ji=function(L){this._properties=L,this._values=Object.create(L.defaultPossiblyEvaluatedValues)};ji.prototype.get=function(L){return this._values[L]};var Ba=function(L){this.specification=L};Ba.prototype.possiblyEvaluate=function(L,U){return L.expression.evaluate(U)},Ba.prototype.interpolate=function(L,U,$){var ve=dl[this.specification.type];return ve?ve(L,U,$):L};var Qa=function(L,U){this.specification=L,this.overrides=U};Qa.prototype.possiblyEvaluate=function(L,U,$,ve){return L.expression.kind==="constant"||L.expression.kind==="camera"?new qi(this,{kind:"constant",value:L.expression.evaluate(U,null,{},$,ve)},U):new qi(this,L.expression,U)},Qa.prototype.interpolate=function(L,U,$){if(L.value.kind!=="constant"||U.value.kind!=="constant")return L;if(L.value.value===void 0||U.value.value===void 0)return new qi(this,{kind:"constant",value:void 0},L.parameters);var ve=dl[this.specification.type];return ve?new qi(this,{kind:"constant",value:ve(L.value.value,U.value.value,$)},L.parameters):L},Qa.prototype.evaluate=function(L,U,$,ve,we,Me){return L.kind==="constant"?L.value:L.evaluate(U,$,ve,we,Me)};var Lo=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.possiblyEvaluate=function($,ve,we,Me){if($.value===void 0)return new qi(this,{kind:"constant",value:void 0},ve);if($.expression.kind==="constant"){var Oe=$.expression.evaluate(ve,null,{},we,Me),tt=$.property.specification.type==="resolvedImage",pt=tt&&typeof Oe!="string"?Oe.name:Oe,gt=this._calculate(pt,pt,pt,ve);return new qi(this,{kind:"constant",value:gt},ve)}else if($.expression.kind==="camera"){var Nt=this._calculate($.expression.evaluate({zoom:ve.zoom-1}),$.expression.evaluate({zoom:ve.zoom}),$.expression.evaluate({zoom:ve.zoom+1}),ve);return new qi(this,{kind:"constant",value:Nt},ve)}else return new qi(this,$.expression,ve)},L.prototype.evaluate=function($,ve,we,Me,Oe,tt){if($.kind==="source"){var pt=$.evaluate(ve,we,Me,Oe,tt);return this._calculate(pt,pt,pt,ve)}else return $.kind==="composite"?this._calculate($.evaluate({zoom:Math.floor(ve.zoom)-1},we,Me),$.evaluate({zoom:Math.floor(ve.zoom)},we,Me),$.evaluate({zoom:Math.floor(ve.zoom)+1},we,Me),ve):$.value},L.prototype._calculate=function($,ve,we,Me){var Oe=Me.zoom;return Oe>Me.zoomHistory.lastIntegerZoom?{from:$,to:ve}:{from:we,to:ve}},L.prototype.interpolate=function($){return $},L}(Qa),fo=function(L){this.specification=L};fo.prototype.possiblyEvaluate=function(L,U,$,ve){if(L.value!==void 0)if(L.expression.kind==="constant"){var we=L.expression.evaluate(U,null,{},$,ve);return this._calculate(we,we,we,U)}else return this._calculate(L.expression.evaluate(new ci(Math.floor(U.zoom-1),U)),L.expression.evaluate(new ci(Math.floor(U.zoom),U)),L.expression.evaluate(new ci(Math.floor(U.zoom+1),U)),U)},fo.prototype._calculate=function(L,U,$,ve){var we=ve.zoom;return we>ve.zoomHistory.lastIntegerZoom?{from:L,to:U}:{from:$,to:U}},fo.prototype.interpolate=function(L){return L};var Wo=function(L){this.specification=L};Wo.prototype.possiblyEvaluate=function(L,U,$,ve){return!!L.expression.evaluate(U,null,{},$,ve)},Wo.prototype.interpolate=function(){return!1};var ro=function(L){this.properties=L,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(var U in L){var $=L[U];$.specification.overridable&&this.overridableProperties.push(U);var ve=this.defaultPropertyValues[U]=new go($,void 0),we=this.defaultTransitionablePropertyValues[U]=new so($);this.defaultTransitioningPropertyValues[U]=we.untransitioned(),this.defaultPossiblyEvaluatedValues[U]=ve.possiblyEvaluate({})}};Ue("DataDrivenProperty",Qa),Ue("DataConstantProperty",Ba),Ue("CrossFadedDataDrivenProperty",Lo),Ue("CrossFadedProperty",fo),Ue("ColorRampProperty",Wo);var us="-transition",Ns=function(D){function L(U,$){if(D.call(this),this.id=U.id,this.type=U.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},U.type!=="custom"&&(U=U,this.metadata=U.metadata,this.minzoom=U.minzoom,this.maxzoom=U.maxzoom,U.type!=="background"&&(this.source=U.source,this.sourceLayer=U["source-layer"],this.filter=U.filter),$.layout&&(this._unevaluatedLayout=new ls($.layout)),$.paint)){this._transitionablePaint=new Co($.paint);for(var ve in U.paint)this.setPaintProperty(ve,U.paint[ve],{validate:!1});for(var we in U.layout)this.setLayoutProperty(we,U.layout[we],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ji($.paint)}}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},L.prototype.getLayoutProperty=function($){return $==="visibility"?this.visibility:this._unevaluatedLayout.getValue($)},L.prototype.setLayoutProperty=function($,ve,we){if(we===void 0&&(we={}),ve!=null){var Me="layers."+this.id+".layout."+$;if(this._validate(ks,Me,$,ve,we))return}if($==="visibility"){this.visibility=ve;return}this._unevaluatedLayout.setValue($,ve)},L.prototype.getPaintProperty=function($){return E($,us)?this._transitionablePaint.getTransition($.slice(0,-us.length)):this._transitionablePaint.getValue($)},L.prototype.setPaintProperty=function($,ve,we){if(we===void 0&&(we={}),ve!=null){var Me="layers."+this.id+".paint."+$;if(this._validate(Ri,Me,$,ve,we))return!1}if(E($,us))return this._transitionablePaint.setTransition($.slice(0,-us.length),ve||void 0),!1;var Oe=this._transitionablePaint._values[$],tt=Oe.property.specification["property-type"]==="cross-faded-data-driven",pt=Oe.value.isDataDriven(),gt=Oe.value;this._transitionablePaint.setValue($,ve),this._handleSpecialPaintPropertyUpdate($);var Nt=this._transitionablePaint._values[$].value,nr=Nt.isDataDriven();return nr||pt||tt||this._handleOverridablePaintPropertyUpdate($,gt,Nt)},L.prototype._handleSpecialPaintPropertyUpdate=function($){},L.prototype._handleOverridablePaintPropertyUpdate=function($,ve,we){return!1},L.prototype.isHidden=function($){return this.minzoom&&$<this.minzoom||this.maxzoom&&$>=this.maxzoom?!0:this.visibility==="none"},L.prototype.updateTransitions=function($){this._transitioningPaint=this._transitionablePaint.transitioned($,this._transitioningPaint)},L.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},L.prototype.recalculate=function($,ve){$.getCrossfadeParameters&&(this._crossfadeParameters=$.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate($,void 0,ve)),this.paint=this._transitioningPaint.possiblyEvaluate($,void 0,ve)},L.prototype.serialize=function(){var $={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&($.layout=$.layout||{},$.layout.visibility=this.visibility),B($,function(ve,we){return ve!==void 0&&!(we==="layout"&&!Object.keys(ve).length)&&!(we==="paint"&&!Object.keys(ve).length)})},L.prototype._validate=function($,ve,we,Me,Oe){return Oe===void 0&&(Oe={}),Oe&&Oe.validate===!1?!1:Eo(this,$.call(Ro,{key:ve,layerType:this.type,objectKey:we,value:Me,styleSpec:Gt,style:{glyphs:!0,sprite:!0}}))},L.prototype.is3D=function(){return!1},L.prototype.isTileClipped=function(){return!1},L.prototype.hasOffscreenPass=function(){return!1},L.prototype.resize=function(){},L.prototype.isStateDependent=function(){for(var $ in this.paint._values){var ve=this.paint.get($);if(!(!(ve instanceof qi)||!fi(ve.property.specification))&&(ve.value.kind==="source"||ve.value.kind==="composite")&&ve.value.isStateDependent)return!0}return!1},L}(Sr),vu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},no=function(L,U){this._structArray=L,this._pos1=U*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Hf=128,Jl=5,Xi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};Xi.serialize=function(L,U){return L._trim(),U&&(L.isTransferred=!0,U.push(L.arrayBuffer)),{length:L.length,arrayBuffer:L.arrayBuffer}},Xi.deserialize=function(L){var U=Object.create(this.prototype);return U.arrayBuffer=L.arrayBuffer,U.length=L.length,U.capacity=L.arrayBuffer.byteLength/U.bytesPerElement,U._refreshViews(),U},Xi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Xi.prototype.clear=function(){this.length=0},Xi.prototype.resize=function(L){this.reserve(L),this.length=L},Xi.prototype.reserve=function(L){if(L>this.capacity){this.capacity=Math.max(L,Math.floor(this.capacity*Jl),Hf),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var U=this.uint8;this._refreshViews(),U&&this.uint8.set(U)}},Xi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};function Xo(D,L){L===void 0&&(L=1);var U=0,$=0,ve=D.map(function(Me){var Oe=Jv(Me.type),tt=U=Tc(U,Math.max(L,Oe)),pt=Me.components||1;return $=Math.max($,Oe),U+=Oe*pt,{name:Me.name,type:Me.type,components:pt,offset:tt}}),we=Tc(U,Math.max($,L));return{members:ve,size:we,alignment:L}}function Jv(D){return vu[D].BYTES_PER_ELEMENT}function Tc(D,L){return Math.ceil(D/L)*L}var uc=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve){var we=this.length;return this.resize(we+1),this.emplace(we,$,ve)},L.prototype.emplace=function($,ve,we){var Me=$*2;return this.int16[Me+0]=ve,this.int16[Me+1]=we,$},L}(Xi);uc.prototype.bytesPerElement=4,Ue("StructArrayLayout2i4",uc);var bf=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we,Me){var Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,$,ve,we,Me)},L.prototype.emplace=function($,ve,we,Me,Oe){var tt=$*4;return this.int16[tt+0]=ve,this.int16[tt+1]=we,this.int16[tt+2]=Me,this.int16[tt+3]=Oe,$},L}(Xi);bf.prototype.bytesPerElement=8,Ue("StructArrayLayout4i8",bf);var Gf=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we,Me,Oe,tt){var pt=this.length;return this.resize(pt+1),this.emplace(pt,$,ve,we,Me,Oe,tt)},L.prototype.emplace=function($,ve,we,Me,Oe,tt,pt){var gt=$*6;return this.int16[gt+0]=ve,this.int16[gt+1]=we,this.int16[gt+2]=Me,this.int16[gt+3]=Oe,this.int16[gt+4]=tt,this.int16[gt+5]=pt,$},L}(Xi);Gf.prototype.bytesPerElement=12,Ue("StructArrayLayout2i4i12",Gf);var Ac=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we,Me,Oe,tt){var pt=this.length;return this.resize(pt+1),this.emplace(pt,$,ve,we,Me,Oe,tt)},L.prototype.emplace=function($,ve,we,Me,Oe,tt,pt){var gt=$*4,Nt=$*8;return this.int16[gt+0]=ve,this.int16[gt+1]=we,this.uint8[Nt+4]=Me,this.uint8[Nt+5]=Oe,this.uint8[Nt+6]=tt,this.uint8[Nt+7]=pt,$},L}(Xi);Ac.prototype.bytesPerElement=8,Ue("StructArrayLayout2i4ub8",Ac);var nl=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we,Me,Oe,tt,pt,gt,Nt,nr){var qt=this.length;return this.resize(qt+1),this.emplace(qt,$,ve,we,Me,Oe,tt,pt,gt,Nt,nr)},L.prototype.emplace=function($,ve,we,Me,Oe,tt,pt,gt,Nt,nr,qt){var yr=$*9,Nr=$*18;return this.uint16[yr+0]=ve,this.uint16[yr+1]=we,this.uint16[yr+2]=Me,this.uint16[yr+3]=Oe,this.uint16[yr+4]=tt,this.uint16[yr+5]=pt,this.uint16[yr+6]=gt,this.uint16[yr+7]=Nt,this.uint8[Nr+16]=nr,this.uint8[Nr+17]=qt,$},L}(Xi);nl.prototype.bytesPerElement=18,Ue("StructArrayLayout8ui2ub18",nl);var _f=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we,Me,Oe,tt,pt,gt,Nt,nr,qt,yr){var Nr=this.length;return this.resize(Nr+1),this.emplace(Nr,$,ve,we,Me,Oe,tt,pt,gt,Nt,nr,qt,yr)},L.prototype.emplace=function($,ve,we,Me,Oe,tt,pt,gt,Nt,nr,qt,yr,Nr){var ln=$*12;return this.int16[ln+0]=ve,this.int16[ln+1]=we,this.int16[ln+2]=Me,this.int16[ln+3]=Oe,this.uint16[ln+4]=tt,this.uint16[ln+5]=pt,this.uint16[ln+6]=gt,this.uint16[ln+7]=Nt,this.int16[ln+8]=nr,this.int16[ln+9]=qt,this.int16[ln+10]=yr,this.int16[ln+11]=Nr,$},L}(Xi);_f.prototype.bytesPerElement=24,Ue("StructArrayLayout4i4ui4i24",_f);var hh=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we){var Me=this.length;return this.resize(Me+1),this.emplace(Me,$,ve,we)},L.prototype.emplace=function($,ve,we,Me){var Oe=$*3;return this.float32[Oe+0]=ve,this.float32[Oe+1]=we,this.float32[Oe+2]=Me,$},L}(Xi);hh.prototype.bytesPerElement=12,Ue("StructArrayLayout3f12",hh);var vh=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},L.prototype.emplaceBack=function($){var ve=this.length;return this.resize(ve+1),this.emplace(ve,$)},L.prototype.emplace=function($,ve){var we=$*1;return this.uint32[we+0]=ve,$},L}(Xi);vh.prototype.bytesPerElement=4,Ue("StructArrayLayout1ul4",vh);var fc=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we,Me,Oe,tt,pt,gt,Nt){var nr=this.length;return this.resize(nr+1),this.emplace(nr,$,ve,we,Me,Oe,tt,pt,gt,Nt)},L.prototype.emplace=function($,ve,we,Me,Oe,tt,pt,gt,Nt,nr){var qt=$*10,yr=$*5;return this.int16[qt+0]=ve,this.int16[qt+1]=we,this.int16[qt+2]=Me,this.int16[qt+3]=Oe,this.int16[qt+4]=tt,this.int16[qt+5]=pt,this.uint32[yr+3]=gt,this.uint16[qt+8]=Nt,this.uint16[qt+9]=nr,$},L}(Xi);fc.prototype.bytesPerElement=20,Ue("StructArrayLayout6i1ul2ui20",fc);var Mc=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we,Me,Oe,tt){var pt=this.length;return this.resize(pt+1),this.emplace(pt,$,ve,we,Me,Oe,tt)},L.prototype.emplace=function($,ve,we,Me,Oe,tt,pt){var gt=$*6;return this.int16[gt+0]=ve,this.int16[gt+1]=we,this.int16[gt+2]=Me,this.int16[gt+3]=Oe,this.int16[gt+4]=tt,this.int16[gt+5]=pt,$},L}(Xi);Mc.prototype.bytesPerElement=12,Ue("StructArrayLayout2i2i2i12",Mc);var Ju=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we,Me,Oe){var tt=this.length;return this.resize(tt+1),this.emplace(tt,$,ve,we,Me,Oe)},L.prototype.emplace=function($,ve,we,Me,Oe,tt){var pt=$*4,gt=$*8;return this.float32[pt+0]=ve,this.float32[pt+1]=we,this.float32[pt+2]=Me,this.int16[gt+6]=Oe,this.int16[gt+7]=tt,$},L}(Xi);Ju.prototype.bytesPerElement=16,Ue("StructArrayLayout2f1f2i16",Ju);var _l=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we,Me){var Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,$,ve,we,Me)},L.prototype.emplace=function($,ve,we,Me,Oe){var tt=$*12,pt=$*3;return this.uint8[tt+0]=ve,this.uint8[tt+1]=we,this.float32[pt+1]=Me,this.float32[pt+2]=Oe,$},L}(Xi);_l.prototype.bytesPerElement=12,Ue("StructArrayLayout2ub2f12",_l);var Ku=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we){var Me=this.length;return this.resize(Me+1),this.emplace(Me,$,ve,we)},L.prototype.emplace=function($,ve,we,Me){var Oe=$*3;return this.uint16[Oe+0]=ve,this.uint16[Oe+1]=we,this.uint16[Oe+2]=Me,$},L}(Xi);Ku.prototype.bytesPerElement=6,Ue("StructArrayLayout3ui6",Ku);var cc=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we,Me,Oe,tt,pt,gt,Nt,nr,qt,yr,Nr,ln,en,kn,bn){var Cn=this.length;return this.resize(Cn+1),this.emplace(Cn,$,ve,we,Me,Oe,tt,pt,gt,Nt,nr,qt,yr,Nr,ln,en,kn,bn)},L.prototype.emplace=function($,ve,we,Me,Oe,tt,pt,gt,Nt,nr,qt,yr,Nr,ln,en,kn,bn,Cn){var zn=$*24,Wn=$*12,la=$*48;return this.int16[zn+0]=ve,this.int16[zn+1]=we,this.uint16[zn+2]=Me,this.uint16[zn+3]=Oe,this.uint32[Wn+2]=tt,this.uint32[Wn+3]=pt,this.uint32[Wn+4]=gt,this.uint16[zn+10]=Nt,this.uint16[zn+11]=nr,this.uint16[zn+12]=qt,this.float32[Wn+7]=yr,this.float32[Wn+8]=Nr,this.uint8[la+36]=ln,this.uint8[la+37]=en,this.uint8[la+38]=kn,this.uint32[Wn+10]=bn,this.int16[zn+22]=Cn,$},L}(Xi);cc.prototype.bytesPerElement=48,Ue("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",cc);var Sc=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we,Me,Oe,tt,pt,gt,Nt,nr,qt,yr,Nr,ln,en,kn,bn,Cn,zn,Wn,la,ia,za,Ma,ka,ii,Fa,Ia){var di=this.length;return this.resize(di+1),this.emplace(di,$,ve,we,Me,Oe,tt,pt,gt,Nt,nr,qt,yr,Nr,ln,en,kn,bn,Cn,zn,Wn,la,ia,za,Ma,ka,ii,Fa,Ia)},L.prototype.emplace=function($,ve,we,Me,Oe,tt,pt,gt,Nt,nr,qt,yr,Nr,ln,en,kn,bn,Cn,zn,Wn,la,ia,za,Ma,ka,ii,Fa,Ia,di){var ni=$*34,zi=$*17;return this.int16[ni+0]=ve,this.int16[ni+1]=we,this.int16[ni+2]=Me,this.int16[ni+3]=Oe,this.int16[ni+4]=tt,this.int16[ni+5]=pt,this.int16[ni+6]=gt,this.int16[ni+7]=Nt,this.uint16[ni+8]=nr,this.uint16[ni+9]=qt,this.uint16[ni+10]=yr,this.uint16[ni+11]=Nr,this.uint16[ni+12]=ln,this.uint16[ni+13]=en,this.uint16[ni+14]=kn,this.uint16[ni+15]=bn,this.uint16[ni+16]=Cn,this.uint16[ni+17]=zn,this.uint16[ni+18]=Wn,this.uint16[ni+19]=la,this.uint16[ni+20]=ia,this.uint16[ni+21]=za,this.uint16[ni+22]=Ma,this.uint32[zi+12]=ka,this.float32[zi+13]=ii,this.float32[zi+14]=Fa,this.float32[zi+15]=Ia,this.float32[zi+16]=di,$},L}(Xi);Sc.prototype.bytesPerElement=68,Ue("StructArrayLayout8i15ui1ul4f68",Sc);var Yf=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function($){var ve=this.length;return this.resize(ve+1),this.emplace(ve,$)},L.prototype.emplace=function($,ve){var we=$*1;return this.float32[we+0]=ve,$},L}(Xi);Yf.prototype.bytesPerElement=4,Ue("StructArrayLayout1f4",Yf);var ph=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we){var Me=this.length;return this.resize(Me+1),this.emplace(Me,$,ve,we)},L.prototype.emplace=function($,ve,we,Me){var Oe=$*3;return this.int16[Oe+0]=ve,this.int16[Oe+1]=we,this.int16[Oe+2]=Me,$},L}(Xi);ph.prototype.bytesPerElement=6,Ue("StructArrayLayout3i6",ph);var wf=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we){var Me=this.length;return this.resize(Me+1),this.emplace(Me,$,ve,we)},L.prototype.emplace=function($,ve,we,Me){var Oe=$*2,tt=$*4;return this.uint32[Oe+0]=ve,this.uint16[tt+2]=we,this.uint16[tt+3]=Me,$},L}(Xi);wf.prototype.bytesPerElement=8,Ue("StructArrayLayout1ul2ui8",wf);var hc=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve){var we=this.length;return this.resize(we+1),this.emplace(we,$,ve)},L.prototype.emplace=function($,ve,we){var Me=$*2;return this.uint16[Me+0]=ve,this.uint16[Me+1]=we,$},L}(Xi);hc.prototype.bytesPerElement=4,Ue("StructArrayLayout2ui4",hc);var Wf=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function($){var ve=this.length;return this.resize(ve+1),this.emplace(ve,$)},L.prototype.emplace=function($,ve){var we=$*1;return this.uint16[we+0]=ve,$},L}(Xi);Wf.prototype.bytesPerElement=2,Ue("StructArrayLayout1ui2",Wf);var Tf=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve){var we=this.length;return this.resize(we+1),this.emplace(we,$,ve)},L.prototype.emplace=function($,ve,we){var Me=$*2;return this.float32[Me+0]=ve,this.float32[Me+1]=we,$},L}(Xi);Tf.prototype.bytesPerElement=8,Ue("StructArrayLayout2f8",Tf);var dh=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function($,ve,we,Me){var Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,$,ve,we,Me)},L.prototype.emplace=function($,ve,we,Me,Oe){var tt=$*4;return this.float32[tt+0]=ve,this.float32[tt+1]=we,this.float32[tt+2]=Me,this.float32[tt+3]=Oe,$},L}(Xi);dh.prototype.bytesPerElement=16,Ue("StructArrayLayout4f16",dh);var Hh=function(D){function L(){D.apply(this,arguments)}D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L;var U={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return U.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},U.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},U.x1.get=function(){return this._structArray.int16[this._pos2+2]},U.y1.get=function(){return this._structArray.int16[this._pos2+3]},U.x2.get=function(){return this._structArray.int16[this._pos2+4]},U.y2.get=function(){return this._structArray.int16[this._pos2+5]},U.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},U.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},U.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},U.anchorPoint.get=function(){return new f(this.anchorPointX,this.anchorPointY)},Object.defineProperties(L.prototype,U),L}(no);Hh.prototype.size=20;var Af=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.get=function($){return new Hh(this,$)},L}(fc);Ue("CollisionBoxArray",Af);var gh=function(D){function L(){D.apply(this,arguments)}D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L;var U={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return U.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},U.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},U.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},U.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},U.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},U.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},U.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},U.segment.get=function(){return this._structArray.uint16[this._pos2+10]},U.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},U.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},U.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},U.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},U.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},U.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},U.placedOrientation.set=function($){this._structArray.uint8[this._pos1+37]=$},U.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},U.hidden.set=function($){this._structArray.uint8[this._pos1+38]=$},U.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},U.crossTileID.set=function($){this._structArray.uint32[this._pos4+10]=$},U.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(L.prototype,U),L}(no);gh.prototype.size=48;var Xf=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.get=function($){return new gh(this,$)},L}(cc);Ue("PlacedSymbolArray",Xf);var Gh=function(D){function L(){D.apply(this,arguments)}D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L;var U={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return U.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},U.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},U.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},U.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},U.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},U.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},U.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},U.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},U.key.get=function(){return this._structArray.uint16[this._pos2+8]},U.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},U.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},U.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},U.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},U.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},U.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},U.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},U.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},U.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},U.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},U.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},U.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},U.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},U.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},U.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},U.crossTileID.set=function($){this._structArray.uint32[this._pos4+12]=$},U.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},U.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},U.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},U.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(L.prototype,U),L}(no);Gh.prototype.size=68;var Yh=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.get=function($){return new Gh(this,$)},L}(Sc);Ue("SymbolInstanceArray",Yh);var pu=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.getoffsetX=function($){return this.float32[$*1+0]},L}(Yf);Ue("GlyphOffsetArray",pu);var Wh=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.getx=function($){return this.int16[$*3+0]},L.prototype.gety=function($){return this.int16[$*3+1]},L.prototype.gettileUnitDistanceFromAnchor=function($){return this.int16[$*3+2]},L}(ph);Ue("SymbolLineVertexArray",Wh);var Xh=function(D){function L(){D.apply(this,arguments)}D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L;var U={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return U.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},U.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},U.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(L.prototype,U),L}(no);Xh.prototype.size=8;var yh=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.get=function($){return new Xh(this,$)},L}(wf);Ue("FeatureIndexArray",yh);var Zh=Xo([{name:"a_pos",components:2,type:"Int16"}],4),ce=Zh.members,W=function(L){L===void 0&&(L=[]),this.segments=L};W.prototype.prepareSegment=function(L,U,$,ve){var we=this.segments[this.segments.length-1];return L>W.MAX_VERTEX_ARRAY_LENGTH&&O("Max vertices per segment is "+W.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+L),(!we||we.vertexLength+L>W.MAX_VERTEX_ARRAY_LENGTH||we.sortKey!==ve)&&(we={vertexOffset:U.length,primitiveOffset:$.length,vertexLength:0,primitiveLength:0},ve!==void 0&&(we.sortKey=ve),this.segments.push(we)),we},W.prototype.get=function(){return this.segments},W.prototype.destroy=function(){for(var L=0,U=this.segments;L<U.length;L+=1){var $=U[L];for(var ve in $.vaos)$.vaos[ve].destroy()}},W.simpleSegment=function(L,U,$,ve){return new W([{vertexOffset:L,primitiveOffset:U,vertexLength:$,primitiveLength:ve,vaos:{},sortKey:0}])},W.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ue("SegmentVector",W);function pe(D,L){return D=v(Math.floor(D),0,255),L=v(Math.floor(L),0,255),256*D+L}var Q=Xo([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),de=i(function(D){function L(U,$){var ve,we,Me,Oe,tt,pt,gt,Nt;for(ve=U.length&3,we=U.length-ve,Me=$,tt=3432918353,pt=461845907,Nt=0;Nt<we;)gt=U.charCodeAt(Nt)&255|(U.charCodeAt(++Nt)&255)<<8|(U.charCodeAt(++Nt)&255)<<16|(U.charCodeAt(++Nt)&255)<<24,++Nt,gt=(gt&65535)*tt+(((gt>>>16)*tt&65535)<<16)&4294967295,gt=gt<<15|gt>>>17,gt=(gt&65535)*pt+(((gt>>>16)*pt&65535)<<16)&4294967295,Me^=gt,Me=Me<<13|Me>>>19,Oe=(Me&65535)*5+(((Me>>>16)*5&65535)<<16)&4294967295,Me=(Oe&65535)+27492+(((Oe>>>16)+58964&65535)<<16);switch(gt=0,ve){case 3:gt^=(U.charCodeAt(Nt+2)&255)<<16;case 2:gt^=(U.charCodeAt(Nt+1)&255)<<8;case 1:gt^=U.charCodeAt(Nt)&255,gt=(gt&65535)*tt+(((gt>>>16)*tt&65535)<<16)&4294967295,gt=gt<<15|gt>>>17,gt=(gt&65535)*pt+(((gt>>>16)*pt&65535)<<16)&4294967295,Me^=gt}return Me^=U.length,Me^=Me>>>16,Me=(Me&65535)*2246822507+(((Me>>>16)*2246822507&65535)<<16)&4294967295,Me^=Me>>>13,Me=(Me&65535)*3266489909+(((Me>>>16)*3266489909&65535)<<16)&4294967295,Me^=Me>>>16,Me>>>0}D.exports=L}),Le=i(function(D){function L(U,$){for(var ve=U.length,we=$^ve,Me=0,Oe;ve>=4;)Oe=U.charCodeAt(Me)&255|(U.charCodeAt(++Me)&255)<<8|(U.charCodeAt(++Me)&255)<<16|(U.charCodeAt(++Me)&255)<<24,Oe=(Oe&65535)*1540483477+(((Oe>>>16)*1540483477&65535)<<16),Oe^=Oe>>>24,Oe=(Oe&65535)*1540483477+(((Oe>>>16)*1540483477&65535)<<16),we=(we&65535)*1540483477+(((we>>>16)*1540483477&65535)<<16)^Oe,ve-=4,++Me;switch(ve){case 3:we^=(U.charCodeAt(Me+2)&255)<<16;case 2:we^=(U.charCodeAt(Me+1)&255)<<8;case 1:we^=U.charCodeAt(Me)&255,we=(we&65535)*1540483477+(((we>>>16)*1540483477&65535)<<16)}return we^=we>>>13,we=(we&65535)*1540483477+(((we>>>16)*1540483477&65535)<<16),we^=we>>>15,we>>>0}D.exports=L}),ze=de,Ke=de,ct=Le;ze.murmur3=Ke,ze.murmur2=ct;var Lt=function(){this.ids=[],this.positions=[],this.indexed=!1};Lt.prototype.add=function(L,U,$,ve){this.ids.push(cr(L)),this.positions.push(U,$,ve)},Lt.prototype.getPositions=function(L){for(var U=cr(L),$=0,ve=this.ids.length-1;$<ve;){var we=$+ve>>1;this.ids[we]>=U?ve=we:$=we+1}for(var Me=[];this.ids[$]===U;){var Oe=this.positions[3*$],tt=this.positions[3*$+1],pt=this.positions[3*$+2];Me.push({index:Oe,start:tt,end:pt}),$++}return Me},Lt.serialize=function(L,U){var $=new Float64Array(L.ids),ve=new Uint32Array(L.positions);return dr($,ve,0,$.length-1),U&&U.push($.buffer,ve.buffer),{ids:$,positions:ve}},Lt.deserialize=function(L){var U=new Lt;return U.ids=L.ids,U.positions=L.positions,U.indexed=!0,U};var $t=Math.pow(2,53)-1;function cr(D){var L=+D;return!isNaN(L)&&L<=$t?L:ze(String(D))}function dr(D,L,U,$){for(;U<$;){for(var ve=D[U+$>>1],we=U-1,Me=$+1;;){do we++;while(D[we]<ve);do Me--;while(D[Me]>ve);if(we>=Me)break;Lr(D,we,Me),Lr(L,3*we,3*Me),Lr(L,3*we+1,3*Me+1),Lr(L,3*we+2,3*Me+2)}Me-U<$-Me?(dr(D,L,U,Me),U=Me+1):(dr(D,L,Me+1,$),$=Me)}}function Lr(D,L,U){var $=D[L];D[L]=D[U],D[U]=$}Ue("FeaturePositionMap",Lt);var Yr=function(L,U){this.gl=L.gl,this.location=U},Xr=function(D){function L(U,$){D.call(this,U,$),this.current=0}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.set=function($){this.current!==$&&(this.current=$,this.gl.uniform1i(this.location,$))},L}(Yr),Gr=function(D){function L(U,$){D.call(this,U,$),this.current=0}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.set=function($){this.current!==$&&(this.current=$,this.gl.uniform1f(this.location,$))},L}(Yr),$r=function(D){function L(U,$){D.call(this,U,$),this.current=[0,0]}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.set=function($){($[0]!==this.current[0]||$[1]!==this.current[1])&&(this.current=$,this.gl.uniform2f(this.location,$[0],$[1]))},L}(Yr),pn=function(D){function L(U,$){D.call(this,U,$),this.current=[0,0,0]}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.set=function($){($[0]!==this.current[0]||$[1]!==this.current[1]||$[2]!==this.current[2])&&(this.current=$,this.gl.uniform3f(this.location,$[0],$[1],$[2]))},L}(Yr),Ln=function(D){function L(U,$){D.call(this,U,$),this.current=[0,0,0,0]}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.set=function($){($[0]!==this.current[0]||$[1]!==this.current[1]||$[2]!==this.current[2]||$[3]!==this.current[3])&&(this.current=$,this.gl.uniform4f(this.location,$[0],$[1],$[2],$[3]))},L}(Yr),Nn=function(D){function L(U,$){D.call(this,U,$),this.current=bi.transparent}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.set=function($){($.r!==this.current.r||$.g!==this.current.g||$.b!==this.current.b||$.a!==this.current.a)&&(this.current=$,this.gl.uniform4f(this.location,$.r,$.g,$.b,$.a))},L}(Yr),Qn=new Float32Array(16),ta=function(D){function L(U,$){D.call(this,U,$),this.current=Qn}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.set=function($){if($[12]!==this.current[12]||$[0]!==this.current[0]){this.current=$,this.gl.uniformMatrix4fv(this.location,!1,$);return}for(var ve=1;ve<16;ve++)if($[ve]!==this.current[ve]){this.current=$,this.gl.uniformMatrix4fv(this.location,!1,$);break}},L}(Yr);function qn(D){return[pe(255*D.r,255*D.g),pe(255*D.b,255*D.a)]}var pa=function(L,U,$){this.value=L,this.uniformNames=U.map(function(ve){return"u_"+ve}),this.type=$};pa.prototype.setUniform=function(L,U,$){L.set($.constantOr(this.value))},pa.prototype.getBinding=function(L,U,$){return this.type==="color"?new Nn(L,U):new Gr(L,U)};var Ta=function(L,U){this.uniformNames=U.map(function($){return"u_"+$}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Ta.prototype.setConstantPatternPositions=function(L,U){this.pixelRatioFrom=U.pixelRatio,this.pixelRatioTo=L.pixelRatio,this.patternFrom=U.tlbr,this.patternTo=L.tlbr},Ta.prototype.setUniform=function(L,U,$,ve){var we=ve==="u_pattern_to"?this.patternTo:ve==="u_pattern_from"?this.patternFrom:ve==="u_pixel_ratio_to"?this.pixelRatioTo:ve==="u_pixel_ratio_from"?this.pixelRatioFrom:null;we&&L.set(we)},Ta.prototype.getBinding=function(L,U,$){return $.substr(0,9)==="u_pattern"?new Ln(L,U):new Gr(L,U)};var ba=function(L,U,$,ve){this.expression=L,this.type=$,this.maxValue=0,this.paintVertexAttributes=U.map(function(we){return{name:"a_"+we,type:"Float32",components:$==="color"?2:1,offset:0}}),this.paintVertexArray=new ve};ba.prototype.populatePaintArray=function(L,U,$,ve,we){var Me=this.paintVertexArray.length,Oe=this.expression.evaluate(new ci(0),U,{},ve,[],we);this.paintVertexArray.resize(L),this._setPaintValue(Me,L,Oe)},ba.prototype.updatePaintArray=function(L,U,$,ve){var we=this.expression.evaluate({zoom:0},$,ve);this._setPaintValue(L,U,we)},ba.prototype._setPaintValue=function(L,U,$){if(this.type==="color")for(var ve=qn($),we=L;we<U;we++)this.paintVertexArray.emplace(we,ve[0],ve[1]);else{for(var Me=L;Me<U;Me++)this.paintVertexArray.emplace(Me,$);this.maxValue=Math.max(this.maxValue,Math.abs($))}},ba.prototype.upload=function(L){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=L.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ba.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Sa=function(L,U,$,ve,we,Me){this.expression=L,this.uniformNames=U.map(function(Oe){return"u_"+Oe+"_t"}),this.type=$,this.useIntegerZoom=ve,this.zoom=we,this.maxValue=0,this.paintVertexAttributes=U.map(function(Oe){return{name:"a_"+Oe,type:"Float32",components:$==="color"?4:2,offset:0}}),this.paintVertexArray=new Me};Sa.prototype.populatePaintArray=function(L,U,$,ve,we){var Me=this.expression.evaluate(new ci(this.zoom),U,{},ve,[],we),Oe=this.expression.evaluate(new ci(this.zoom+1),U,{},ve,[],we),tt=this.paintVertexArray.length;this.paintVertexArray.resize(L),this._setPaintValue(tt,L,Me,Oe)},Sa.prototype.updatePaintArray=function(L,U,$,ve){var we=this.expression.evaluate({zoom:this.zoom},$,ve),Me=this.expression.evaluate({zoom:this.zoom+1},$,ve);this._setPaintValue(L,U,we,Me)},Sa.prototype._setPaintValue=function(L,U,$,ve){if(this.type==="color")for(var we=qn($),Me=qn(ve),Oe=L;Oe<U;Oe++)this.paintVertexArray.emplace(Oe,we[0],we[1],Me[0],Me[1]);else{for(var tt=L;tt<U;tt++)this.paintVertexArray.emplace(tt,$,ve);this.maxValue=Math.max(this.maxValue,Math.abs($),Math.abs(ve))}},Sa.prototype.upload=function(L){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=L.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Sa.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Sa.prototype.setUniform=function(L,U){var $=this.useIntegerZoom?Math.floor(U.zoom):U.zoom,ve=v(this.expression.interpolationFactor($,this.zoom,this.zoom+1),0,1);L.set(ve)},Sa.prototype.getBinding=function(L,U,$){return new Gr(L,U)};var Pa=function(L,U,$,ve,we,Me){this.expression=L,this.type=U,this.useIntegerZoom=$,this.zoom=ve,this.layerId=Me,this.zoomInPaintVertexArray=new we,this.zoomOutPaintVertexArray=new we};Pa.prototype.populatePaintArray=function(L,U,$){var ve=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(L),this.zoomOutPaintVertexArray.resize(L),this._setPaintValues(ve,L,U.patterns&&U.patterns[this.layerId],$)},Pa.prototype.updatePaintArray=function(L,U,$,ve,we){this._setPaintValues(L,U,$.patterns&&$.patterns[this.layerId],we)},Pa.prototype._setPaintValues=function(L,U,$,ve){if(!(!ve||!$)){var we=$.min,Me=$.mid,Oe=$.max,tt=ve[we],pt=ve[Me],gt=ve[Oe];if(!(!tt||!pt||!gt))for(var Nt=L;Nt<U;Nt++)this.zoomInPaintVertexArray.emplace(Nt,pt.tl[0],pt.tl[1],pt.br[0],pt.br[1],tt.tl[0],tt.tl[1],tt.br[0],tt.br[1],pt.pixelRatio,tt.pixelRatio),this.zoomOutPaintVertexArray.emplace(Nt,pt.tl[0],pt.tl[1],pt.br[0],pt.br[1],gt.tl[0],gt.tl[1],gt.br[0],gt.br[1],pt.pixelRatio,gt.pixelRatio)}},Pa.prototype.upload=function(L){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=L.createVertexBuffer(this.zoomInPaintVertexArray,Q.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=L.createVertexBuffer(this.zoomOutPaintVertexArray,Q.members,this.expression.isStateDependent))},Pa.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ya=function(L,U,$,ve){this.binders={},this.layoutAttributes=ve,this._buffers=[];var we=[];for(var Me in L.paint._values)if(!!$(Me)){var Oe=L.paint.get(Me);if(!(!(Oe instanceof qi)||!fi(Oe.property.specification))){var tt=Oi(Me,L.type),pt=Oe.value,gt=Oe.property.specification.type,Nt=Oe.property.useIntegerZoom,nr=Oe.property.specification["property-type"],qt=nr==="cross-faded"||nr==="cross-faded-data-driven";if(pt.kind==="constant")this.binders[Me]=qt?new Ta(pt.value,tt):new pa(pt.value,tt,gt),we.push("/u_"+Me);else if(pt.kind==="source"||qt){var yr=_i(Me,gt,"source");this.binders[Me]=qt?new Pa(pt,gt,Nt,U,yr,L.id):new ba(pt,tt,gt,yr),we.push("/a_"+Me)}else{var Nr=_i(Me,gt,"composite");this.binders[Me]=new Sa(pt,tt,gt,Nt,U,Nr),we.push("/z_"+Me)}}}this.cacheKey=we.sort().join("")};Ya.prototype.getMaxValue=function(L){var U=this.binders[L];return U instanceof ba||U instanceof Sa?U.maxValue:0},Ya.prototype.populatePaintArrays=function(L,U,$,ve,we){for(var Me in this.binders){var Oe=this.binders[Me];(Oe instanceof ba||Oe instanceof Sa||Oe instanceof Pa)&&Oe.populatePaintArray(L,U,$,ve,we)}},Ya.prototype.setConstantPatternPositions=function(L,U){for(var $ in this.binders){var ve=this.binders[$];ve instanceof Ta&&ve.setConstantPatternPositions(L,U)}},Ya.prototype.updatePaintArrays=function(L,U,$,ve,we){var Me=!1;for(var Oe in L)for(var tt=U.getPositions(Oe),pt=0,gt=tt;pt<gt.length;pt+=1){var Nt=gt[pt],nr=$.feature(Nt.index);for(var qt in this.binders){var yr=this.binders[qt];if((yr instanceof ba||yr instanceof Sa||yr instanceof Pa)&&yr.expression.isStateDependent===!0){var Nr=ve.paint.get(qt);yr.expression=Nr.value,yr.updatePaintArray(Nt.start,Nt.end,nr,L[Oe],we),Me=!0}}}return Me},Ya.prototype.defines=function(){var L=[];for(var U in this.binders){var $=this.binders[U];($ instanceof pa||$ instanceof Ta)&&L.push.apply(L,$.uniformNames.map(function(ve){return"#define HAS_UNIFORM_"+ve}))}return L},Ya.prototype.getPaintVertexBuffers=function(){return this._buffers},Ya.prototype.getUniforms=function(L,U){var $=[];for(var ve in this.binders){var we=this.binders[ve];if(we instanceof pa||we instanceof Ta||we instanceof Sa)for(var Me=0,Oe=we.uniformNames;Me<Oe.length;Me+=1){var tt=Oe[Me];if(U[tt]){var pt=we.getBinding(L,U[tt],tt);$.push({name:tt,property:ve,binding:pt})}}}return $},Ya.prototype.setUniforms=function(L,U,$,ve){for(var we=0,Me=U;we<Me.length;we+=1){var Oe=Me[we],tt=Oe.name,pt=Oe.property,gt=Oe.binding;this.binders[pt].setUniform(gt,ve,$.get(pt),tt)}},Ya.prototype.updatePaintBuffers=function(L){this._buffers=[];for(var U in this.binders){var $=this.binders[U];if(L&&$ instanceof Pa){var ve=L.fromScale===2?$.zoomInPaintVertexBuffer:$.zoomOutPaintVertexBuffer;ve&&this._buffers.push(ve)}else($ instanceof ba||$ instanceof Sa)&&$.paintVertexBuffer&&this._buffers.push($.paintVertexBuffer)}},Ya.prototype.upload=function(L){for(var U in this.binders){var $=this.binders[U];($ instanceof ba||$ instanceof Sa||$ instanceof Pa)&&$.upload(L)}this.updatePaintBuffers()},Ya.prototype.destroy=function(){for(var L in this.binders){var U=this.binders[L];(U instanceof ba||U instanceof Sa||U instanceof Pa)&&U.destroy()}};var si=function(L,U,$,ve){ve===void 0&&(ve=function(){return!0}),this.programConfigurations={};for(var we=0,Me=U;we<Me.length;we+=1){var Oe=Me[we];this.programConfigurations[Oe.id]=new Ya(Oe,$,ve,L)}this.needsUpload=!1,this._featureMap=new Lt,this._bufferOffset=0};si.prototype.populatePaintArrays=function(L,U,$,ve,we,Me){for(var Oe in this.programConfigurations)this.programConfigurations[Oe].populatePaintArrays(L,U,ve,we,Me);U.id!==void 0&&this._featureMap.add(U.id,$,this._bufferOffset,L),this._bufferOffset=L,this.needsUpload=!0},si.prototype.updatePaintArrays=function(L,U,$,ve){for(var we=0,Me=$;we<Me.length;we+=1){var Oe=Me[we];this.needsUpload=this.programConfigurations[Oe.id].updatePaintArrays(L,this._featureMap,U,Oe,ve)||this.needsUpload}},si.prototype.get=function(L){return this.programConfigurations[L]},si.prototype.upload=function(L){if(!!this.needsUpload){for(var U in this.programConfigurations)this.programConfigurations[U].upload(L);this.needsUpload=!1}},si.prototype.destroy=function(){for(var L in this.programConfigurations)this.programConfigurations[L].destroy()};function Oi(D,L){var U={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]};return U[D]||[D.replace(L+"-","").replace(/-/g,"_")]}function pi(D){var L={"line-pattern":{source:nl,composite:nl},"fill-pattern":{source:nl,composite:nl},"fill-extrusion-pattern":{source:nl,composite:nl}};return L[D]}function _i(D,L,U){var $={color:{source:Tf,composite:dh},number:{source:Yf,composite:Tf}},ve=pi(D);return ve&&ve[U]||$[L][U]}Ue("ConstantBinder",pa),Ue("CrossFadedConstantBinder",Ta),Ue("SourceExpressionBinder",ba),Ue("CrossFadedCompositeBinder",Pa),Ue("CompositeExpressionBinder",Sa),Ue("ProgramConfiguration",Ya,{omit:["_buffers"]}),Ue("ProgramConfigurationSet",si);var Va=8192;function Ui(D){return{min:-1*Math.pow(2,D-1),max:Math.pow(2,D-1)-1}}var Yi=Ui(15);function Ji(D){for(var L=Va/D.extent,U=D.loadGeometry(),$=0;$<U.length;$++)for(var ve=U[$],we=0;we<ve.length;we++){var Me=ve[we];Me.x=Math.round(Me.x*L),Me.y=Math.round(Me.y*L),(Me.x<Yi.min||Me.x>Yi.max||Me.y<Yi.min||Me.y>Yi.max)&&(O("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Me.x=v(Me.x,Yi.min,Yi.max),Me.y=v(Me.y,Yi.min,Yi.max))}return U}function ki(D,L,U,$,ve){D.emplaceBack(L*2+($+1)/2,U*2+(ve+1)/2)}var ao=function(L){this.zoom=L.zoom,this.overscaling=L.overscaling,this.layers=L.layers,this.layerIds=this.layers.map(function(U){return U.id}),this.index=L.index,this.hasPattern=!1,this.layoutVertexArray=new uc,this.indexArray=new Ku,this.segments=new W,this.programConfigurations=new si(ce,L.layers,L.zoom),this.stateDependentLayerIds=this.layers.filter(function(U){return U.isStateDependent()}).map(function(U){return U.id})};ao.prototype.populate=function(L,U,$){var ve=this.layers[0],we=[],Me=null;ve.type==="circle"&&(Me=ve.layout.get("circle-sort-key"));for(var Oe=0,tt=L;Oe<tt.length;Oe+=1){var pt=tt[Oe],gt=pt.feature,Nt=pt.id,nr=pt.index,qt=pt.sourceLayerIndex,yr=this.layers[0]._featureFilter.needGeometry,Nr={type:gt.type,id:Nt,properties:gt.properties,geometry:yr?Ji(gt):[]};if(!!this.layers[0]._featureFilter.filter(new ci(this.zoom),Nr,$)){yr||(Nr.geometry=Ji(gt));var ln=Me?Me.evaluate(Nr,{},$):void 0,en={id:Nt,properties:gt.properties,type:gt.type,sourceLayerIndex:qt,index:nr,geometry:Nr.geometry,patterns:{},sortKey:ln};we.push(en)}}Me&&we.sort(function(Ma,ka){return Ma.sortKey-ka.sortKey});for(var kn=0,bn=we;kn<bn.length;kn+=1){var Cn=bn[kn],zn=Cn,Wn=zn.geometry,la=zn.index,ia=zn.sourceLayerIndex,za=L[la].feature;this.addFeature(Cn,Wn,la,$),U.featureIndex.insert(za,Wn,la,ia,this.index)}},ao.prototype.update=function(L,U,$){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(L,U,this.stateDependentLayers,$)},ao.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ao.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ao.prototype.upload=function(L){this.uploaded||(this.layoutVertexBuffer=L.createVertexBuffer(this.layoutVertexArray,ce),this.indexBuffer=L.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(L),this.uploaded=!0},ao.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ao.prototype.addFeature=function(L,U,$,ve){for(var we=0,Me=U;we<Me.length;we+=1)for(var Oe=Me[we],tt=0,pt=Oe;tt<pt.length;tt+=1){var gt=pt[tt],Nt=gt.x,nr=gt.y;if(!(Nt<0||Nt>=Va||nr<0||nr>=Va)){var qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,L.sortKey),yr=qt.vertexLength;ki(this.layoutVertexArray,Nt,nr,-1,-1),ki(this.layoutVertexArray,Nt,nr,1,-1),ki(this.layoutVertexArray,Nt,nr,1,1),ki(this.layoutVertexArray,Nt,nr,-1,1),this.indexArray.emplaceBack(yr,yr+1,yr+2),this.indexArray.emplaceBack(yr,yr+3,yr+2),qt.vertexLength+=4,qt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,L,$,{},ve)},Ue("CircleBucket",ao,{omit:["layers"]});function ui(D,L){for(var U=0;U<D.length;U++)if(al(L,D[U]))return!0;for(var $=0;$<L.length;$++)if(al(D,L[$]))return!0;return!!Ql(D,L)}function Di(D,L,U){return!!(al(D,L)||Eu(L,D,U))}function Io(D,L){if(D.length===1)return Cu(L,D[0]);for(var U=0;U<L.length;U++)for(var $=L[U],ve=0;ve<$.length;ve++)if(al(D,$[ve]))return!0;for(var we=0;we<D.length;we++)if(Cu(L,D[we]))return!0;for(var Me=0;Me<L.length;Me++)if(Ql(D,L[Me]))return!0;return!1}function $o(D,L,U){for(var $=0;$<L.length;$++){var ve=L[$];if(D.length>=3){for(var we=0;we<ve.length;we++)if(al(D,ve[we]))return!0}if(Kl(D,ve,U))return!0}return!1}function Kl(D,L,U){if(D.length>1){if(Ql(D,L))return!0;for(var $=0;$<L.length;$++)if(Eu(L[$],D,U))return!0}for(var ve=0;ve<D.length;ve++)if(Eu(D[ve],L,U))return!0;return!1}function Ql(D,L){if(D.length===0||L.length===0)return!1;for(var U=0;U<D.length-1;U++)for(var $=D[U],ve=D[U+1],we=0;we<L.length-1;we++){var Me=L[we],Oe=L[we+1];if(Su($,ve,Me,Oe))return!0}return!1}function Su(D,L,U,$){return N(D,U,$)!==N(L,U,$)&&N(D,L,U)!==N(D,L,$)}function Eu(D,L,U){var $=U*U;if(L.length===1)return D.distSqr(L[0])<$;for(var ve=1;ve<L.length;ve++){var we=L[ve-1],Me=L[ve];if(Qu(D,we,Me)<$)return!0}return!1}function Qu(D,L,U){var $=L.distSqr(U);if($===0)return D.distSqr(L);var ve=((D.x-L.x)*(U.x-L.x)+(D.y-L.y)*(U.y-L.y))/$;return ve<0?D.distSqr(L):ve>1?D.distSqr(U):D.distSqr(U.sub(L)._mult(ve)._add(L))}function Cu(D,L){for(var U=!1,$,ve,we,Me=0;Me<D.length;Me++){$=D[Me];for(var Oe=0,tt=$.length-1;Oe<$.length;tt=Oe++)ve=$[Oe],we=$[tt],ve.y>L.y!=we.y>L.y&&L.x<(we.x-ve.x)*(L.y-ve.y)/(we.y-ve.y)+ve.x&&(U=!U)}return U}function al(D,L){for(var U=!1,$=0,ve=D.length-1;$<D.length;ve=$++){var we=D[$],Me=D[ve];we.y>L.y!=Me.y>L.y&&L.x<(Me.x-we.x)*(L.y-we.y)/(Me.y-we.y)+we.x&&(U=!U)}return U}function Mf(D,L,U,$,ve){for(var we=0,Me=D;we<Me.length;we+=1){var Oe=Me[we];if(L<=Oe.x&&U<=Oe.y&&$>=Oe.x&&ve>=Oe.y)return!0}var tt=[new f(L,U),new f(L,ve),new f($,ve),new f($,U)];if(D.length>2)for(var pt=0,gt=tt;pt<gt.length;pt+=1){var Nt=gt[pt];if(al(D,Nt))return!0}for(var nr=0;nr<D.length-1;nr++){var qt=D[nr],yr=D[nr+1];if(Os(qt,yr,tt))return!0}return!1}function Os(D,L,U){var $=U[0],ve=U[2];if(D.x<$.x&&L.x<$.x||D.x>ve.x&&L.x>ve.x||D.y<$.y&&L.y<$.y||D.y>ve.y&&L.y>ve.y)return!1;var we=N(D,L,U[0]);return we!==N(D,L,U[1])||we!==N(D,L,U[2])||we!==N(D,L,U[3])}function Il(D,L,U){var $=L.paint.get(D).value;return $.kind==="constant"?$.value:U.programConfigurations.get(L.id).getMaxValue(D)}function ku(D){return Math.sqrt(D[0]*D[0]+D[1]*D[1])}function du(D,L,U,$,ve){if(!L[0]&&!L[1])return D;var we=f.convert(L)._mult(ve);U==="viewport"&&we._rotate(-$);for(var Me=[],Oe=0;Oe<D.length;Oe++){var tt=D[Oe];Me.push(tt.sub(we))}return Me}var Du=new ro({"circle-sort-key":new Qa(Gt.layout_circle["circle-sort-key"])}),Ec=new ro({"circle-radius":new Qa(Gt.paint_circle["circle-radius"]),"circle-color":new Qa(Gt.paint_circle["circle-color"]),"circle-blur":new Qa(Gt.paint_circle["circle-blur"]),"circle-opacity":new Qa(Gt.paint_circle["circle-opacity"]),"circle-translate":new Ba(Gt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ba(Gt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ba(Gt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ba(Gt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Qa(Gt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Qa(Gt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Qa(Gt.paint_circle["circle-stroke-opacity"])}),Lf={paint:Ec,layout:Du},Ds=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var D=arguments,L=0,U=arguments.length;U--;)L+=D[U]*D[U];return Math.sqrt(L)});function vc(){var D=new Ds(4);return Ds!=Float32Array&&(D[1]=0,D[2]=0),D[0]=1,D[3]=1,D}function js(D,L,U){var $=L[0],ve=L[1],we=L[2],Me=L[3],Oe=Math.sin(U),tt=Math.cos(U);return D[0]=$*tt+we*Oe,D[1]=ve*tt+Me*Oe,D[2]=$*-Oe+we*tt,D[3]=ve*-Oe+Me*tt,D}function pc(){var D=new Ds(9);return Ds!=Float32Array&&(D[1]=0,D[2]=0,D[3]=0,D[5]=0,D[6]=0,D[7]=0),D[0]=1,D[4]=1,D[8]=1,D}function Cc(D,L){var U=Math.sin(L),$=Math.cos(L);return D[0]=$,D[1]=U,D[2]=0,D[3]=-U,D[4]=$,D[5]=0,D[6]=0,D[7]=0,D[8]=1,D}function kc(){var D=new Ds(16);return Ds!=Float32Array&&(D[1]=0,D[2]=0,D[3]=0,D[4]=0,D[6]=0,D[7]=0,D[8]=0,D[9]=0,D[11]=0,D[12]=0,D[13]=0,D[14]=0),D[0]=1,D[5]=1,D[10]=1,D[15]=1,D}function jh(D){var L=new Ds(16);return L[0]=D[0],L[1]=D[1],L[2]=D[2],L[3]=D[3],L[4]=D[4],L[5]=D[5],L[6]=D[6],L[7]=D[7],L[8]=D[8],L[9]=D[9],L[10]=D[10],L[11]=D[11],L[12]=D[12],L[13]=D[13],L[14]=D[14],L[15]=D[15],L}function Dc(D){return D[0]=1,D[1]=0,D[2]=0,D[3]=0,D[4]=0,D[5]=1,D[6]=0,D[7]=0,D[8]=0,D[9]=0,D[10]=1,D[11]=0,D[12]=0,D[13]=0,D[14]=0,D[15]=1,D}function Zf(D,L){var U=L[0],$=L[1],ve=L[2],we=L[3],Me=L[4],Oe=L[5],tt=L[6],pt=L[7],gt=L[8],Nt=L[9],nr=L[10],qt=L[11],yr=L[12],Nr=L[13],ln=L[14],en=L[15],kn=U*Oe-$*Me,bn=U*tt-ve*Me,Cn=U*pt-we*Me,zn=$*tt-ve*Oe,Wn=$*pt-we*Oe,la=ve*pt-we*tt,ia=gt*Nr-Nt*yr,za=gt*ln-nr*yr,Ma=gt*en-qt*yr,ka=Nt*ln-nr*Nr,ii=Nt*en-qt*Nr,Fa=nr*en-qt*ln,Ia=kn*Fa-bn*ii+Cn*ka+zn*Ma-Wn*za+la*ia;return Ia?(Ia=1/Ia,D[0]=(Oe*Fa-tt*ii+pt*ka)*Ia,D[1]=(ve*ii-$*Fa-we*ka)*Ia,D[2]=(Nr*la-ln*Wn+en*zn)*Ia,D[3]=(nr*Wn-Nt*la-qt*zn)*Ia,D[4]=(tt*Ma-Me*Fa-pt*za)*Ia,D[5]=(U*Fa-ve*Ma+we*za)*Ia,D[6]=(ln*Cn-yr*la-en*bn)*Ia,D[7]=(gt*la-nr*Cn+qt*bn)*Ia,D[8]=(Me*ii-Oe*Ma+pt*ia)*Ia,D[9]=($*Ma-U*ii-we*ia)*Ia,D[10]=(yr*Wn-Nr*Cn+en*kn)*Ia,D[11]=(Nt*Cn-gt*Wn-qt*kn)*Ia,D[12]=(Oe*za-Me*ka-tt*ia)*Ia,D[13]=(U*ka-$*za+ve*ia)*Ia,D[14]=(Nr*bn-yr*zn-ln*kn)*Ia,D[15]=(gt*zn-Nt*bn+nr*kn)*Ia,D):null}function jf(D,L,U){var $=L[0],ve=L[1],we=L[2],Me=L[3],Oe=L[4],tt=L[5],pt=L[6],gt=L[7],Nt=L[8],nr=L[9],qt=L[10],yr=L[11],Nr=L[12],ln=L[13],en=L[14],kn=L[15],bn=U[0],Cn=U[1],zn=U[2],Wn=U[3];return D[0]=bn*$+Cn*Oe+zn*Nt+Wn*Nr,D[1]=bn*ve+Cn*tt+zn*nr+Wn*ln,D[2]=bn*we+Cn*pt+zn*qt+Wn*en,D[3]=bn*Me+Cn*gt+zn*yr+Wn*kn,bn=U[4],Cn=U[5],zn=U[6],Wn=U[7],D[4]=bn*$+Cn*Oe+zn*Nt+Wn*Nr,D[5]=bn*ve+Cn*tt+zn*nr+Wn*ln,D[6]=bn*we+Cn*pt+zn*qt+Wn*en,D[7]=bn*Me+Cn*gt+zn*yr+Wn*kn,bn=U[8],Cn=U[9],zn=U[10],Wn=U[11],D[8]=bn*$+Cn*Oe+zn*Nt+Wn*Nr,D[9]=bn*ve+Cn*tt+zn*nr+Wn*ln,D[10]=bn*we+Cn*pt+zn*qt+Wn*en,D[11]=bn*Me+Cn*gt+zn*yr+Wn*kn,bn=U[12],Cn=U[13],zn=U[14],Wn=U[15],D[12]=bn*$+Cn*Oe+zn*Nt+Wn*Nr,D[13]=bn*ve+Cn*tt+zn*nr+Wn*ln,D[14]=bn*we+Cn*pt+zn*qt+Wn*en,D[15]=bn*Me+Cn*gt+zn*yr+Wn*kn,D}function Ho(D,L,U){var $=U[0],ve=U[1],we=U[2],Me,Oe,tt,pt,gt,Nt,nr,qt,yr,Nr,ln,en;return L===D?(D[12]=L[0]*$+L[4]*ve+L[8]*we+L[12],D[13]=L[1]*$+L[5]*ve+L[9]*we+L[13],D[14]=L[2]*$+L[6]*ve+L[10]*we+L[14],D[15]=L[3]*$+L[7]*ve+L[11]*we+L[15]):(Me=L[0],Oe=L[1],tt=L[2],pt=L[3],gt=L[4],Nt=L[5],nr=L[6],qt=L[7],yr=L[8],Nr=L[9],ln=L[10],en=L[11],D[0]=Me,D[1]=Oe,D[2]=tt,D[3]=pt,D[4]=gt,D[5]=Nt,D[6]=nr,D[7]=qt,D[8]=yr,D[9]=Nr,D[10]=ln,D[11]=en,D[12]=Me*$+gt*ve+yr*we+L[12],D[13]=Oe*$+Nt*ve+Nr*we+L[13],D[14]=tt*$+nr*ve+ln*we+L[14],D[15]=pt*$+qt*ve+en*we+L[15]),D}function wl(D,L,U){var $=U[0],ve=U[1],we=U[2];return D[0]=L[0]*$,D[1]=L[1]*$,D[2]=L[2]*$,D[3]=L[3]*$,D[4]=L[4]*ve,D[5]=L[5]*ve,D[6]=L[6]*ve,D[7]=L[7]*ve,D[8]=L[8]*we,D[9]=L[9]*we,D[10]=L[10]*we,D[11]=L[11]*we,D[12]=L[12],D[13]=L[13],D[14]=L[14],D[15]=L[15],D}function Tl(D,L,U){var $=Math.sin(U),ve=Math.cos(U),we=L[4],Me=L[5],Oe=L[6],tt=L[7],pt=L[8],gt=L[9],Nt=L[10],nr=L[11];return L!==D&&(D[0]=L[0],D[1]=L[1],D[2]=L[2],D[3]=L[3],D[12]=L[12],D[13]=L[13],D[14]=L[14],D[15]=L[15]),D[4]=we*ve+pt*$,D[5]=Me*ve+gt*$,D[6]=Oe*ve+Nt*$,D[7]=tt*ve+nr*$,D[8]=pt*ve-we*$,D[9]=gt*ve-Me*$,D[10]=Nt*ve-Oe*$,D[11]=nr*ve-tt*$,D}function Lc(D,L,U){var $=Math.sin(U),ve=Math.cos(U),we=L[0],Me=L[1],Oe=L[2],tt=L[3],pt=L[4],gt=L[5],Nt=L[6],nr=L[7];return L!==D&&(D[8]=L[8],D[9]=L[9],D[10]=L[10],D[11]=L[11],D[12]=L[12],D[13]=L[13],D[14]=L[14],D[15]=L[15]),D[0]=we*ve+pt*$,D[1]=Me*ve+gt*$,D[2]=Oe*ve+Nt*$,D[3]=tt*ve+nr*$,D[4]=pt*ve-we*$,D[5]=gt*ve-Me*$,D[6]=Nt*ve-Oe*$,D[7]=nr*ve-tt*$,D}function mh(D,L,U,$,ve){var we=1/Math.tan(L/2),Me;return D[0]=we/U,D[1]=0,D[2]=0,D[3]=0,D[4]=0,D[5]=we,D[6]=0,D[7]=0,D[8]=0,D[9]=0,D[11]=-1,D[12]=0,D[13]=0,D[15]=0,ve!=null&&ve!==1/0?(Me=1/($-ve),D[10]=(ve+$)*Me,D[14]=2*ve*$*Me):(D[10]=-1,D[14]=-2*$),D}function Kv(D,L,U,$,ve,we,Me){var Oe=1/(L-U),tt=1/($-ve),pt=1/(we-Me);return D[0]=-2*Oe,D[1]=0,D[2]=0,D[3]=0,D[4]=0,D[5]=-2*tt,D[6]=0,D[7]=0,D[8]=0,D[9]=0,D[10]=2*pt,D[11]=0,D[12]=(L+U)*Oe,D[13]=(ve+$)*tt,D[14]=(Me+we)*pt,D[15]=1,D}var Qv=jf;function dc(){var D=new Ds(3);return Ds!=Float32Array&&(D[0]=0,D[1]=0,D[2]=0),D}function $v(D){var L=new Ds(3);return L[0]=D[0],L[1]=D[1],L[2]=D[2],L}function Pc(D,L,U){return D[0]=L[0]+U[0],D[1]=L[1]+U[1],D[2]=L[2]+U[2],D}function qv(D,L,U){return D[0]=L[0]-U[0],D[1]=L[1]-U[1],D[2]=L[2]-U[2],D}function ep(D,L,U){return D[0]=L[0]*U,D[1]=L[1]*U,D[2]=L[2]*U,D}function xh(D,L){var U=L[0],$=L[1],ve=L[2],we=U*U+$*$+ve*ve;return we>0&&(we=1/Math.sqrt(we)),D[0]=L[0]*we,D[1]=L[1]*we,D[2]=L[2]*we,D}function cy(D,L){return D[0]*L[0]+D[1]*L[1]+D[2]*L[2]}function hy(D,L,U){var $=L[0],ve=L[1],we=L[2],Me=U[0],Oe=U[1],tt=U[2];return D[0]=ve*tt-we*Oe,D[1]=we*Me-$*tt,D[2]=$*Oe-ve*Me,D}function vy(D,L,U){var $=L[0],ve=L[1],we=L[2];return D[0]=$*U[0]+ve*U[3]+we*U[6],D[1]=$*U[1]+ve*U[4]+we*U[7],D[2]=$*U[2]+ve*U[5]+we*U[8],D}var py=qv;(function(){var D=dc();return function(L,U,$,ve,we,Me){var Oe,tt;for(U||(U=3),$||($=0),ve?tt=Math.min(ve*U+$,L.length):tt=L.length,Oe=$;Oe<tt;Oe+=U)D[0]=L[Oe],D[1]=L[Oe+1],D[2]=L[Oe+2],we(D,D,Me),L[Oe]=D[0],L[Oe+1]=D[1],L[Oe+2]=D[2];return L}})();function dy(){var D=new Ds(4);return Ds!=Float32Array&&(D[0]=0,D[1]=0,D[2]=0,D[3]=0),D}function gy(D,L,U){return D[0]=L[0]*U,D[1]=L[1]*U,D[2]=L[2]*U,D[3]=L[3]*U,D}function yy(D,L){return D[0]*L[0]+D[1]*L[1]+D[2]*L[2]+D[3]*L[3]}function Jh(D,L,U){var $=L[0],ve=L[1],we=L[2],Me=L[3];return D[0]=U[0]*$+U[4]*ve+U[8]*we+U[12]*Me,D[1]=U[1]*$+U[5]*ve+U[9]*we+U[13]*Me,D[2]=U[2]*$+U[6]*ve+U[10]*we+U[14]*Me,D[3]=U[3]*$+U[7]*ve+U[11]*we+U[15]*Me,D}(function(){var D=dy();return function(L,U,$,ve,we,Me){var Oe,tt;for(U||(U=4),$||($=0),ve?tt=Math.min(ve*U+$,L.length):tt=L.length,Oe=$;Oe<tt;Oe+=U)D[0]=L[Oe],D[1]=L[Oe+1],D[2]=L[Oe+2],D[3]=L[Oe+3],we(D,D,Me),L[Oe]=D[0],L[Oe+1]=D[1],L[Oe+2]=D[2],L[Oe+3]=D[3];return L}})();function my(){var D=new Ds(2);return Ds!=Float32Array&&(D[0]=0,D[1]=0),D}function xy(D){var L=D[0],U=D[1];return L*L+U*U}var by=xy;(function(){var D=my();return function(L,U,$,ve,we,Me){var Oe,tt;for(U||(U=2),$||($=0),ve?tt=Math.min(ve*U+$,L.length):tt=L.length,Oe=$;Oe<tt;Oe+=U)D[0]=L[Oe],D[1]=L[Oe+1],we(D,D,Me),L[Oe]=D[0],L[Oe+1]=D[1];return L}})();var _y=function(D){function L(U){D.call(this,U,Lf)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.createBucket=function($){return new ao($)},L.prototype.queryRadius=function($){var ve=$;return Il("circle-radius",this,ve)+Il("circle-stroke-width",this,ve)+ku(this.paint.get("circle-translate"))},L.prototype.queryIntersectsFeature=function($,ve,we,Me,Oe,tt,pt,gt){for(var Nt=du($,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),tt.angle,pt),nr=this.paint.get("circle-radius").evaluate(ve,we),qt=this.paint.get("circle-stroke-width").evaluate(ve,we),yr=nr+qt,Nr=this.paint.get("circle-pitch-alignment")==="map",ln=Nr?Nt:wy(Nt,gt),en=Nr?yr*pt:yr,kn=0,bn=Me;kn<bn.length;kn+=1)for(var Cn=bn[kn],zn=0,Wn=Cn;zn<Wn.length;zn+=1){var la=Wn[zn],ia=Nr?la:nd(la,gt),za=en,Ma=Jh([],[la.x,la.y,0,1],gt);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?za*=Ma[3]/tt.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(za*=tt.cameraToCenterDistance/Ma[3]),Di(ln,ia,za))return!0}return!1},L}(Ns);function nd(D,L){var U=Jh([],[D.x,D.y,0,1],L);return new f(U[0]/U[3],U[1]/U[3])}function wy(D,L){return D.map(function(U){return nd(U,L)})}var ad=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L}(ao);Ue("HeatmapBucket",ad,{omit:["layers"]});function tp(D,L,U,$){var ve=L.width,we=L.height;if(!$)$=new Uint8Array(ve*we*U);else if($ instanceof Uint8ClampedArray)$=new Uint8Array($.buffer);else if($.length!==ve*we*U)throw new RangeError("mismatched image size");return D.width=ve,D.height=we,D.data=$,D}function id(D,L,U){var $=L.width,ve=L.height;if(!($===D.width&&ve===D.height)){var we=tp({},{width:$,height:ve},U);rp(D,we,{x:0,y:0},{x:0,y:0},{width:Math.min(D.width,$),height:Math.min(D.height,ve)},U),D.width=$,D.height=ve,D.data=we.data}}function rp(D,L,U,$,ve,we){if(ve.width===0||ve.height===0)return L;if(ve.width>D.width||ve.height>D.height||U.x>D.width-ve.width||U.y>D.height-ve.height)throw new RangeError("out of range source coordinates for image copy");if(ve.width>L.width||ve.height>L.height||$.x>L.width-ve.width||$.y>L.height-ve.height)throw new RangeError("out of range destination coordinates for image copy");for(var Me=D.data,Oe=L.data,tt=0;tt<ve.height;tt++)for(var pt=((U.y+tt)*D.width+U.x)*we,gt=(($.y+tt)*L.width+$.x)*we,Nt=0;Nt<ve.width*we;Nt++)Oe[gt+Nt]=Me[pt+Nt];return L}var gc=function(L,U){tp(this,L,1,U)};gc.prototype.resize=function(L){id(this,L,1)},gc.prototype.clone=function(){return new gc({width:this.width,height:this.height},new Uint8Array(this.data))},gc.copy=function(L,U,$,ve,we){rp(L,U,$,ve,we,1)};var Al=function(L,U){tp(this,L,4,U)};Al.prototype.resize=function(L){id(this,L,4)},Al.prototype.replace=function(L,U){U?this.data.set(L):L instanceof Uint8ClampedArray?this.data=new Uint8Array(L.buffer):this.data=L},Al.prototype.clone=function(){return new Al({width:this.width,height:this.height},new Uint8Array(this.data))},Al.copy=function(L,U,$,ve,we){rp(L,U,$,ve,we,4)},Ue("AlphaImage",gc),Ue("RGBAImage",Al);var Ty=new ro({"heatmap-radius":new Qa(Gt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Qa(Gt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ba(Gt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Wo(Gt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ba(Gt.paint_heatmap["heatmap-opacity"])}),Ay={paint:Ty};function od(D,L){for(var U=new Uint8Array(1024),$={},ve=0,we=0;ve<256;ve++,we+=4){$[L]=ve/255;var Me=D.evaluate($);U[we+0]=Math.floor(Me.r*255/Me.a),U[we+1]=Math.floor(Me.g*255/Me.a),U[we+2]=Math.floor(Me.b*255/Me.a),U[we+3]=Math.floor(Me.a*255)}return new Al({width:256,height:1},U)}var My=function(D){function L(U){D.call(this,U,Ay),this._updateColorRamp()}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.createBucket=function($){return new ad($)},L.prototype._handleSpecialPaintPropertyUpdate=function($){$==="heatmap-color"&&this._updateColorRamp()},L.prototype._updateColorRamp=function(){var $=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=od($,"heatmapDensity"),this.colorRampTexture=null},L.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},L.prototype.queryRadius=function(){return 0},L.prototype.queryIntersectsFeature=function(){return!1},L.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},L}(Ns),Sy=new ro({"hillshade-illumination-direction":new Ba(Gt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ba(Gt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ba(Gt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ba(Gt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ba(Gt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ba(Gt.paint_hillshade["hillshade-accent-color"])}),Ey={paint:Sy},Cy=function(D){function L(U){D.call(this,U,Ey)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},L}(Ns),ky=Xo([{name:"a_pos",components:2,type:"Int16"}],4),sd=ky.members,np=Kh,Dy=Kh;function Kh(D,L,U){U=U||2;var $=L&&L.length,ve=$?L[0]*U:D.length,we=ld(D,0,ve,U,!0),Me=[];if(!we||we.next===we.prev)return Me;var Oe,tt,pt,gt,Nt,nr,qt;if($&&(we=Iy(D,L,we,U)),D.length>80*U){Oe=pt=D[0],tt=gt=D[1];for(var yr=U;yr<ve;yr+=U)Nt=D[yr],nr=D[yr+1],Nt<Oe&&(Oe=Nt),nr<tt&&(tt=nr),Nt>pt&&(pt=Nt),nr>gt&&(gt=nr);qt=Math.max(pt-Oe,gt-tt),qt=qt!==0?1/qt:0}return bh(we,Me,U,Oe,tt,qt),Me}function ld(D,L,U,$,ve){var we,Me;if(ve===op(D,L,U,$)>0)for(we=L;we<U;we+=$)Me=cd(we,D[we],D[we+1],Me);else for(we=U-$;we>=L;we-=$)Me=cd(we,D[we],D[we+1],Me);return Me&&Qh(Me,Me.next)&&(wh(Me),Me=Me.next),Me}function Jf(D,L){if(!D)return D;L||(L=D);var U=D,$;do if($=!1,!U.steiner&&(Qh(U,U.next)||qo(U.prev,U,U.next)===0)){if(wh(U),U=L=U.prev,U===U.next)break;$=!0}else U=U.next;while($||U!==L);return L}function bh(D,L,U,$,ve,we,Me){if(!!D){!Me&&we&&Uy(D,$,ve,we);for(var Oe=D,tt,pt;D.prev!==D.next;){if(tt=D.prev,pt=D.next,we?Py(D,$,ve,we):Ly(D)){L.push(tt.i/U),L.push(D.i/U),L.push(pt.i/U),wh(D),D=pt.next,Oe=pt.next;continue}if(D=pt,D===Oe){Me?Me===1?(D=Fy(Jf(D),L,U),bh(D,L,U,$,ve,we,2)):Me===2&&Ry(D,L,U,$,ve,we):bh(Jf(D),L,U,$,ve,we,1);break}}}}function Ly(D){var L=D.prev,U=D,$=D.next;if(qo(L,U,$)>=0)return!1;for(var ve=D.next.next;ve!==D.prev;){if(Fc(L.x,L.y,U.x,U.y,$.x,$.y,ve.x,ve.y)&&qo(ve.prev,ve,ve.next)>=0)return!1;ve=ve.next}return!0}function Py(D,L,U,$){var ve=D.prev,we=D,Me=D.next;if(qo(ve,we,Me)>=0)return!1;for(var Oe=ve.x<we.x?ve.x<Me.x?ve.x:Me.x:we.x<Me.x?we.x:Me.x,tt=ve.y<we.y?ve.y<Me.y?ve.y:Me.y:we.y<Me.y?we.y:Me.y,pt=ve.x>we.x?ve.x>Me.x?ve.x:Me.x:we.x>Me.x?we.x:Me.x,gt=ve.y>we.y?ve.y>Me.y?ve.y:Me.y:we.y>Me.y?we.y:Me.y,Nt=ap(Oe,tt,L,U,$),nr=ap(pt,gt,L,U,$),qt=D.prevZ,yr=D.nextZ;qt&&qt.z>=Nt&&yr&&yr.z<=nr;){if(qt!==D.prev&&qt!==D.next&&Fc(ve.x,ve.y,we.x,we.y,Me.x,Me.y,qt.x,qt.y)&&qo(qt.prev,qt,qt.next)>=0||(qt=qt.prevZ,yr!==D.prev&&yr!==D.next&&Fc(ve.x,ve.y,we.x,we.y,Me.x,Me.y,yr.x,yr.y)&&qo(yr.prev,yr,yr.next)>=0))return!1;yr=yr.nextZ}for(;qt&&qt.z>=Nt;){if(qt!==D.prev&&qt!==D.next&&Fc(ve.x,ve.y,we.x,we.y,Me.x,Me.y,qt.x,qt.y)&&qo(qt.prev,qt,qt.next)>=0)return!1;qt=qt.prevZ}for(;yr&&yr.z<=nr;){if(yr!==D.prev&&yr!==D.next&&Fc(ve.x,ve.y,we.x,we.y,Me.x,Me.y,yr.x,yr.y)&&qo(yr.prev,yr,yr.next)>=0)return!1;yr=yr.nextZ}return!0}function Fy(D,L,U){var $=D;do{var ve=$.prev,we=$.next.next;!Qh(ve,we)&&ud(ve,$,$.next,we)&&_h(ve,we)&&_h(we,ve)&&(L.push(ve.i/U),L.push($.i/U),L.push(we.i/U),wh($),wh($.next),$=D=we),$=$.next}while($!==D);return Jf($)}function Ry(D,L,U,$,ve,we){var Me=D;do{for(var Oe=Me.next.next;Oe!==Me.prev;){if(Me.i!==Oe.i&&Gy(Me,Oe)){var tt=fd(Me,Oe);Me=Jf(Me,Me.next),tt=Jf(tt,tt.next),bh(Me,L,U,$,ve,we),bh(tt,L,U,$,ve,we);return}Oe=Oe.next}Me=Me.next}while(Me!==D)}function Iy(D,L,U,$){var ve=[],we,Me,Oe,tt,pt;for(we=0,Me=L.length;we<Me;we++)Oe=L[we]*$,tt=we<Me-1?L[we+1]*$:D.length,pt=ld(D,Oe,tt,$,!1),pt===pt.next&&(pt.steiner=!0),ve.push(Hy(pt));for(ve.sort(zy),we=0;we<ve.length;we++)By(ve[we],U),U=Jf(U,U.next);return U}function zy(D,L){return D.x-L.x}function By(D,L){if(L=Ny(D,L),L){var U=fd(L,D);Jf(L,L.next),Jf(U,U.next)}}function Ny(D,L){var U=L,$=D.x,ve=D.y,we=-1/0,Me;do{if(ve<=U.y&&ve>=U.next.y&&U.next.y!==U.y){var Oe=U.x+(ve-U.y)*(U.next.x-U.x)/(U.next.y-U.y);if(Oe<=$&&Oe>we){if(we=Oe,Oe===$){if(ve===U.y)return U;if(ve===U.next.y)return U.next}Me=U.x<U.next.x?U:U.next}}U=U.next}while(U!==L);if(!Me)return null;if($===we)return Me;var tt=Me,pt=Me.x,gt=Me.y,Nt=1/0,nr;U=Me;do $>=U.x&&U.x>=pt&&$!==U.x&&Fc(ve<gt?$:we,ve,pt,gt,ve<gt?we:$,ve,U.x,U.y)&&(nr=Math.abs(ve-U.y)/($-U.x),_h(U,D)&&(nr<Nt||nr===Nt&&(U.x>Me.x||U.x===Me.x&&Oy(Me,U)))&&(Me=U,Nt=nr)),U=U.next;while(U!==tt);return Me}function Oy(D,L){return qo(D.prev,D,L.prev)<0&&qo(L.next,D,D.next)<0}function Uy(D,L,U,$){var ve=D;do ve.z===null&&(ve.z=ap(ve.x,ve.y,L,U,$)),ve.prevZ=ve.prev,ve.nextZ=ve.next,ve=ve.next;while(ve!==D);ve.prevZ.nextZ=null,ve.prevZ=null,Vy(ve)}function Vy(D){var L,U,$,ve,we,Me,Oe,tt,pt=1;do{for(U=D,D=null,we=null,Me=0;U;){for(Me++,$=U,Oe=0,L=0;L<pt&&(Oe++,$=$.nextZ,!!$);L++);for(tt=pt;Oe>0||tt>0&&$;)Oe!==0&&(tt===0||!$||U.z<=$.z)?(ve=U,U=U.nextZ,Oe--):(ve=$,$=$.nextZ,tt--),we?we.nextZ=ve:D=ve,ve.prevZ=we,we=ve;U=$}we.nextZ=null,pt*=2}while(Me>1);return D}function ap(D,L,U,$,ve){return D=32767*(D-U)*ve,L=32767*(L-$)*ve,D=(D|D<<8)&16711935,D=(D|D<<4)&252645135,D=(D|D<<2)&858993459,D=(D|D<<1)&1431655765,L=(L|L<<8)&16711935,L=(L|L<<4)&252645135,L=(L|L<<2)&858993459,L=(L|L<<1)&1431655765,D|L<<1}function Hy(D){var L=D,U=D;do(L.x<U.x||L.x===U.x&&L.y<U.y)&&(U=L),L=L.next;while(L!==D);return U}function Fc(D,L,U,$,ve,we,Me,Oe){return(ve-Me)*(L-Oe)-(D-Me)*(we-Oe)>=0&&(D-Me)*($-Oe)-(U-Me)*(L-Oe)>=0&&(U-Me)*(we-Oe)-(ve-Me)*($-Oe)>=0}function Gy(D,L){return D.next.i!==L.i&&D.prev.i!==L.i&&!Yy(D,L)&&(_h(D,L)&&_h(L,D)&&Wy(D,L)&&(qo(D.prev,D,L.prev)||qo(D,L.prev,L))||Qh(D,L)&&qo(D.prev,D,D.next)>0&&qo(L.prev,L,L.next)>0)}function qo(D,L,U){return(L.y-D.y)*(U.x-L.x)-(L.x-D.x)*(U.y-L.y)}function Qh(D,L){return D.x===L.x&&D.y===L.y}function ud(D,L,U,$){var ve=qh(qo(D,L,U)),we=qh(qo(D,L,$)),Me=qh(qo(U,$,D)),Oe=qh(qo(U,$,L));return!!(ve!==we&&Me!==Oe||ve===0&&$h(D,U,L)||we===0&&$h(D,$,L)||Me===0&&$h(U,D,$)||Oe===0&&$h(U,L,$))}function $h(D,L,U){return L.x<=Math.max(D.x,U.x)&&L.x>=Math.min(D.x,U.x)&&L.y<=Math.max(D.y,U.y)&&L.y>=Math.min(D.y,U.y)}function qh(D){return D>0?1:D<0?-1:0}function Yy(D,L){var U=D;do{if(U.i!==D.i&&U.next.i!==D.i&&U.i!==L.i&&U.next.i!==L.i&&ud(U,U.next,D,L))return!0;U=U.next}while(U!==D);return!1}function _h(D,L){return qo(D.prev,D,D.next)<0?qo(D,L,D.next)>=0&&qo(D,D.prev,L)>=0:qo(D,L,D.prev)<0||qo(D,D.next,L)<0}function Wy(D,L){var U=D,$=!1,ve=(D.x+L.x)/2,we=(D.y+L.y)/2;do U.y>we!=U.next.y>we&&U.next.y!==U.y&&ve<(U.next.x-U.x)*(we-U.y)/(U.next.y-U.y)+U.x&&($=!$),U=U.next;while(U!==D);return $}function fd(D,L){var U=new ip(D.i,D.x,D.y),$=new ip(L.i,L.x,L.y),ve=D.next,we=L.prev;return D.next=L,L.prev=D,U.next=ve,ve.prev=U,$.next=U,U.prev=$,we.next=$,$.prev=we,$}function cd(D,L,U,$){var ve=new ip(D,L,U);return $?(ve.next=$.next,ve.prev=$,$.next.prev=ve,$.next=ve):(ve.prev=ve,ve.next=ve),ve}function wh(D){D.next.prev=D.prev,D.prev.next=D.next,D.prevZ&&(D.prevZ.nextZ=D.nextZ),D.nextZ&&(D.nextZ.prevZ=D.prevZ)}function ip(D,L,U){this.i=D,this.x=L,this.y=U,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}Kh.deviation=function(D,L,U,$){var ve=L&&L.length,we=ve?L[0]*U:D.length,Me=Math.abs(op(D,0,we,U));if(ve)for(var Oe=0,tt=L.length;Oe<tt;Oe++){var pt=L[Oe]*U,gt=Oe<tt-1?L[Oe+1]*U:D.length;Me-=Math.abs(op(D,pt,gt,U))}var Nt=0;for(Oe=0;Oe<$.length;Oe+=3){var nr=$[Oe]*U,qt=$[Oe+1]*U,yr=$[Oe+2]*U;Nt+=Math.abs((D[nr]-D[yr])*(D[qt+1]-D[nr+1])-(D[nr]-D[qt])*(D[yr+1]-D[nr+1]))}return Me===0&&Nt===0?0:Math.abs((Nt-Me)/Me)};function op(D,L,U,$){for(var ve=0,we=L,Me=U-$;we<U;we+=$)ve+=(D[Me]-D[we])*(D[we+1]+D[Me+1]),Me=we;return ve}Kh.flatten=function(D){for(var L=D[0][0].length,U={vertices:[],holes:[],dimensions:L},$=0,ve=0;ve<D.length;ve++){for(var we=0;we<D[ve].length;we++)for(var Me=0;Me<L;Me++)U.vertices.push(D[ve][we][Me]);ve>0&&($+=D[ve-1].length,U.holes.push($))}return U},np.default=Dy;function Xy(D,L,U,$,ve){hd(D,L,U||0,$||D.length-1,ve||Zy)}function hd(D,L,U,$,ve){for(;$>U;){if($-U>600){var we=$-U+1,Me=L-U+1,Oe=Math.log(we),tt=.5*Math.exp(2*Oe/3),pt=.5*Math.sqrt(Oe*tt*(we-tt)/we)*(Me-we/2<0?-1:1),gt=Math.max(U,Math.floor(L-Me*tt/we+pt)),Nt=Math.min($,Math.floor(L+(we-Me)*tt/we+pt));hd(D,L,gt,Nt,ve)}var nr=D[L],qt=U,yr=$;for(Th(D,U,L),ve(D[$],nr)>0&&Th(D,U,$);qt<yr;){for(Th(D,qt,yr),qt++,yr--;ve(D[qt],nr)<0;)qt++;for(;ve(D[yr],nr)>0;)yr--}ve(D[U],nr)===0?Th(D,U,yr):(yr++,Th(D,yr,$)),yr<=L&&(U=yr+1),L<=yr&&($=yr-1)}}function Th(D,L,U){var $=D[L];D[L]=D[U],D[U]=$}function Zy(D,L){return D<L?-1:D>L?1:0}function sp(D,L){var U=D.length;if(U<=1)return[D];for(var $=[],ve,we,Me=0;Me<U;Me++){var Oe=V(D[Me]);Oe!==0&&(D[Me].area=Math.abs(Oe),we===void 0&&(we=Oe<0),we===Oe<0?(ve&&$.push(ve),ve=[D[Me]]):ve.push(D[Me]))}if(ve&&$.push(ve),L>1)for(var tt=0;tt<$.length;tt++)$[tt].length<=L||(Xy($[tt],L,1,$[tt].length-1,jy),$[tt]=$[tt].slice(0,L));return $}function jy(D,L){return L.area-D.area}function lp(D,L,U){for(var $=U.patternDependencies,ve=!1,we=0,Me=L;we<Me.length;we+=1){var Oe=Me[we],tt=Oe.paint.get(D+"-pattern");tt.isConstant()||(ve=!0);var pt=tt.constantOr(null);pt&&(ve=!0,$[pt.to]=!0,$[pt.from]=!0)}return ve}function up(D,L,U,$,ve){for(var we=ve.patternDependencies,Me=0,Oe=L;Me<Oe.length;Me+=1){var tt=Oe[Me],pt=tt.paint.get(D+"-pattern"),gt=pt.value;if(gt.kind!=="constant"){var Nt=gt.evaluate({zoom:$-1},U,{},ve.availableImages),nr=gt.evaluate({zoom:$},U,{},ve.availableImages),qt=gt.evaluate({zoom:$+1},U,{},ve.availableImages);Nt=Nt&&Nt.name?Nt.name:Nt,nr=nr&&nr.name?nr.name:nr,qt=qt&&qt.name?qt.name:qt,we[Nt]=!0,we[nr]=!0,we[qt]=!0,U.patterns[tt.id]={min:Nt,mid:nr,max:qt}}}return U}var Jy=500,$u=function(L){this.zoom=L.zoom,this.overscaling=L.overscaling,this.layers=L.layers,this.layerIds=this.layers.map(function(U){return U.id}),this.index=L.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new uc,this.indexArray=new Ku,this.indexArray2=new hc,this.programConfigurations=new si(sd,L.layers,L.zoom),this.segments=new W,this.segments2=new W,this.stateDependentLayerIds=this.layers.filter(function(U){return U.isStateDependent()}).map(function(U){return U.id})};$u.prototype.populate=function(L,U,$){this.hasPattern=lp("fill",this.layers,U);for(var ve=this.layers[0].layout.get("fill-sort-key"),we=[],Me=0,Oe=L;Me<Oe.length;Me+=1){var tt=Oe[Me],pt=tt.feature,gt=tt.id,Nt=tt.index,nr=tt.sourceLayerIndex,qt=this.layers[0]._featureFilter.needGeometry,yr={type:pt.type,id:gt,properties:pt.properties,geometry:qt?Ji(pt):[]};if(!!this.layers[0]._featureFilter.filter(new ci(this.zoom),yr,$)){qt||(yr.geometry=Ji(pt));var Nr=ve?ve.evaluate(yr,{},$,U.availableImages):void 0,ln={id:gt,properties:pt.properties,type:pt.type,sourceLayerIndex:nr,index:Nt,geometry:yr.geometry,patterns:{},sortKey:Nr};we.push(ln)}}ve&&we.sort(function(Ma,ka){return Ma.sortKey-ka.sortKey});for(var en=0,kn=we;en<kn.length;en+=1){var bn=kn[en],Cn=bn,zn=Cn.geometry,Wn=Cn.index,la=Cn.sourceLayerIndex;if(this.hasPattern){var ia=up("fill",this.layers,bn,this.zoom,U);this.patternFeatures.push(ia)}else this.addFeature(bn,zn,Wn,$,{});var za=L[Wn].feature;U.featureIndex.insert(za,zn,Wn,la,this.index)}},$u.prototype.update=function(L,U,$){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(L,U,this.stateDependentLayers,$)},$u.prototype.addFeatures=function(L,U,$){for(var ve=0,we=this.patternFeatures;ve<we.length;ve+=1){var Me=we[ve];this.addFeature(Me,Me.geometry,Me.index,U,$)}},$u.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},$u.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},$u.prototype.upload=function(L){this.uploaded||(this.layoutVertexBuffer=L.createVertexBuffer(this.layoutVertexArray,sd),this.indexBuffer=L.createIndexBuffer(this.indexArray),this.indexBuffer2=L.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(L),this.uploaded=!0},$u.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},$u.prototype.addFeature=function(L,U,$,ve,we){for(var Me=0,Oe=sp(U,Jy);Me<Oe.length;Me+=1){for(var tt=Oe[Me],pt=0,gt=0,Nt=tt;gt<Nt.length;gt+=1){var nr=Nt[gt];pt+=nr.length}for(var qt=this.segments.prepareSegment(pt,this.layoutVertexArray,this.indexArray),yr=qt.vertexLength,Nr=[],ln=[],en=0,kn=tt;en<kn.length;en+=1){var bn=kn[en];if(bn.length!==0){bn!==tt[0]&&ln.push(Nr.length/2);var Cn=this.segments2.prepareSegment(bn.length,this.layoutVertexArray,this.indexArray2),zn=Cn.vertexLength;this.layoutVertexArray.emplaceBack(bn[0].x,bn[0].y),this.indexArray2.emplaceBack(zn+bn.length-1,zn),Nr.push(bn[0].x),Nr.push(bn[0].y);for(var Wn=1;Wn<bn.length;Wn++)this.layoutVertexArray.emplaceBack(bn[Wn].x,bn[Wn].y),this.indexArray2.emplaceBack(zn+Wn-1,zn+Wn),Nr.push(bn[Wn].x),Nr.push(bn[Wn].y);Cn.vertexLength+=bn.length,Cn.primitiveLength+=bn.length}}for(var la=np(Nr,ln),ia=0;ia<la.length;ia+=3)this.indexArray.emplaceBack(yr+la[ia],yr+la[ia+1],yr+la[ia+2]);qt.vertexLength+=pt,qt.primitiveLength+=la.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,L,$,we,ve)},Ue("FillBucket",$u,{omit:["layers","patternFeatures"]});var Ky=new ro({"fill-sort-key":new Qa(Gt.layout_fill["fill-sort-key"])}),Qy=new ro({"fill-antialias":new Ba(Gt.paint_fill["fill-antialias"]),"fill-opacity":new Qa(Gt.paint_fill["fill-opacity"]),"fill-color":new Qa(Gt.paint_fill["fill-color"]),"fill-outline-color":new Qa(Gt.paint_fill["fill-outline-color"]),"fill-translate":new Ba(Gt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ba(Gt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Lo(Gt.paint_fill["fill-pattern"])}),$y={paint:Qy,layout:Ky},qy=function(D){function L(U){D.call(this,U,$y)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.recalculate=function($,ve){D.prototype.recalculate.call(this,$,ve);var we=this.paint._values["fill-outline-color"];we.value.kind==="constant"&&we.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},L.prototype.createBucket=function($){return new $u($)},L.prototype.queryRadius=function(){return ku(this.paint.get("fill-translate"))},L.prototype.queryIntersectsFeature=function($,ve,we,Me,Oe,tt,pt){var gt=du($,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),tt.angle,pt);return Io(gt,Me)},L.prototype.isTileClipped=function(){return!0},L}(Ns),em=Xo([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),vd=em.members,pd=Rc;function Rc(D,L,U,$,ve){this.properties={},this.extent=U,this.type=0,this._pbf=D,this._geometry=-1,this._keys=$,this._values=ve,D.readFields(tm,this,L)}function tm(D,L,U){D==1?L.id=U.readVarint():D==2?rm(U,L):D==3?L.type=U.readVarint():D==4&&(L._geometry=U.pos)}function rm(D,L){for(var U=D.readVarint()+D.pos;D.pos<U;){var $=L._keys[D.readVarint()],ve=L._values[D.readVarint()];L.properties[$]=ve}}Rc.types=["Unknown","Point","LineString","Polygon"],Rc.prototype.loadGeometry=function(){var D=this._pbf;D.pos=this._geometry;for(var L=D.readVarint()+D.pos,U=1,$=0,ve=0,we=0,Me=[],Oe;D.pos<L;){if($<=0){var tt=D.readVarint();U=tt&7,$=tt>>3}if($--,U===1||U===2)ve+=D.readSVarint(),we+=D.readSVarint(),U===1&&(Oe&&Me.push(Oe),Oe=[]),Oe.push(new f(ve,we));else if(U===7)Oe&&Oe.push(Oe[0].clone());else throw new Error("unknown command "+U)}return Oe&&Me.push(Oe),Me},Rc.prototype.bbox=function(){var D=this._pbf;D.pos=this._geometry;for(var L=D.readVarint()+D.pos,U=1,$=0,ve=0,we=0,Me=1/0,Oe=-1/0,tt=1/0,pt=-1/0;D.pos<L;){if($<=0){var gt=D.readVarint();U=gt&7,$=gt>>3}if($--,U===1||U===2)ve+=D.readSVarint(),we+=D.readSVarint(),ve<Me&&(Me=ve),ve>Oe&&(Oe=ve),we<tt&&(tt=we),we>pt&&(pt=we);else if(U!==7)throw new Error("unknown command "+U)}return[Me,tt,Oe,pt]},Rc.prototype.toGeoJSON=function(D,L,U){var $=this.extent*Math.pow(2,U),ve=this.extent*D,we=this.extent*L,Me=this.loadGeometry(),Oe=Rc.types[this.type],tt,pt;function gt(qt){for(var yr=0;yr<qt.length;yr++){var Nr=qt[yr],ln=180-(Nr.y+we)*360/$;qt[yr]=[(Nr.x+ve)*360/$-180,360/Math.PI*Math.atan(Math.exp(ln*Math.PI/180))-90]}}switch(this.type){case 1:var Nt=[];for(tt=0;tt<Me.length;tt++)Nt[tt]=Me[tt][0];Me=Nt,gt(Me);break;case 2:for(tt=0;tt<Me.length;tt++)gt(Me[tt]);break;case 3:for(Me=nm(Me),tt=0;tt<Me.length;tt++)for(pt=0;pt<Me[tt].length;pt++)gt(Me[tt][pt]);break}Me.length===1?Me=Me[0]:Oe="Multi"+Oe;var nr={type:"Feature",geometry:{type:Oe,coordinates:Me},properties:this.properties};return"id"in this&&(nr.id=this.id),nr};function nm(D){var L=D.length;if(L<=1)return[D];for(var U=[],$,ve,we=0;we<L;we++){var Me=am(D[we]);Me!==0&&(ve===void 0&&(ve=Me<0),ve===Me<0?($&&U.push($),$=[D[we]]):$.push(D[we]))}return $&&U.push($),U}function am(D){for(var L=0,U=0,$=D.length,ve=$-1,we,Me;U<$;ve=U++)we=D[U],Me=D[ve],L+=(Me.x-we.x)*(we.y+Me.y);return L}var dd=gd;function gd(D,L){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=D,this._keys=[],this._values=[],this._features=[],D.readFields(im,this,L),this.length=this._features.length}function im(D,L,U){D===15?L.version=U.readVarint():D===1?L.name=U.readString():D===5?L.extent=U.readVarint():D===2?L._features.push(U.pos):D===3?L._keys.push(U.readString()):D===4&&L._values.push(om(U))}function om(D){for(var L=null,U=D.readVarint()+D.pos;D.pos<U;){var $=D.readVarint()>>3;L=$===1?D.readString():$===2?D.readFloat():$===3?D.readDouble():$===4?D.readVarint64():$===5?D.readVarint():$===6?D.readSVarint():$===7?D.readBoolean():null}return L}gd.prototype.feature=function(D){if(D<0||D>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[D];var L=this._pbf.readVarint()+this._pbf.pos;return new pd(this._pbf,L,this.extent,this._keys,this._values)};var sm=lm;function lm(D,L){this.layers=D.readFields(um,{},L)}function um(D,L,U){if(D===3){var $=new dd(U,U.readVarint()+U.pos);$.length&&(L[$.name]=$)}}var fm=sm,cm=pd,hm=dd,Ic={VectorTile:fm,VectorTileFeature:cm,VectorTileLayer:hm},vm=Ic.VectorTileFeature.types,pm=500,fp=Math.pow(2,13);function Ah(D,L,U,$,ve,we,Me,Oe){D.emplaceBack(L,U,Math.floor($*fp)*2+Me,ve*fp*2,we*fp*2,Math.round(Oe))}var qu=function(L){this.zoom=L.zoom,this.overscaling=L.overscaling,this.layers=L.layers,this.layerIds=this.layers.map(function(U){return U.id}),this.index=L.index,this.hasPattern=!1,this.layoutVertexArray=new Gf,this.indexArray=new Ku,this.programConfigurations=new si(vd,L.layers,L.zoom),this.segments=new W,this.stateDependentLayerIds=this.layers.filter(function(U){return U.isStateDependent()}).map(function(U){return U.id})};qu.prototype.populate=function(L,U,$){this.features=[],this.hasPattern=lp("fill-extrusion",this.layers,U);for(var ve=0,we=L;ve<we.length;ve+=1){var Me=we[ve],Oe=Me.feature,tt=Me.id,pt=Me.index,gt=Me.sourceLayerIndex,Nt=this.layers[0]._featureFilter.needGeometry,nr={type:Oe.type,id:tt,properties:Oe.properties,geometry:Nt?Ji(Oe):[]};if(!!this.layers[0]._featureFilter.filter(new ci(this.zoom),nr,$)){var qt={id:tt,sourceLayerIndex:gt,index:pt,geometry:Nt?nr.geometry:Ji(Oe),properties:Oe.properties,type:Oe.type,patterns:{}};typeof Oe.id<"u"&&(qt.id=Oe.id),this.hasPattern?this.features.push(up("fill-extrusion",this.layers,qt,this.zoom,U)):this.addFeature(qt,qt.geometry,pt,$,{}),U.featureIndex.insert(Oe,qt.geometry,pt,gt,this.index,!0)}}},qu.prototype.addFeatures=function(L,U,$){for(var ve=0,we=this.features;ve<we.length;ve+=1){var Me=we[ve],Oe=Me.geometry;this.addFeature(Me,Oe,Me.index,U,$)}},qu.prototype.update=function(L,U,$){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(L,U,this.stateDependentLayers,$)},qu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},qu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},qu.prototype.upload=function(L){this.uploaded||(this.layoutVertexBuffer=L.createVertexBuffer(this.layoutVertexArray,vd),this.indexBuffer=L.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(L),this.uploaded=!0},qu.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},qu.prototype.addFeature=function(L,U,$,ve,we){for(var Me=0,Oe=sp(U,pm);Me<Oe.length;Me+=1){for(var tt=Oe[Me],pt=0,gt=0,Nt=tt;gt<Nt.length;gt+=1){var nr=Nt[gt];pt+=nr.length}for(var qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),yr=0,Nr=tt;yr<Nr.length;yr+=1){var ln=Nr[yr];if(ln.length!==0&&!gm(ln))for(var en=0,kn=0;kn<ln.length;kn++){var bn=ln[kn];if(kn>=1){var Cn=ln[kn-1];if(!dm(bn,Cn)){qt.vertexLength+4>W.MAX_VERTEX_ARRAY_LENGTH&&(qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var zn=bn.sub(Cn)._perp()._unit(),Wn=Cn.dist(bn);en+Wn>32768&&(en=0),Ah(this.layoutVertexArray,bn.x,bn.y,zn.x,zn.y,0,0,en),Ah(this.layoutVertexArray,bn.x,bn.y,zn.x,zn.y,0,1,en),en+=Wn,Ah(this.layoutVertexArray,Cn.x,Cn.y,zn.x,zn.y,0,0,en),Ah(this.layoutVertexArray,Cn.x,Cn.y,zn.x,zn.y,0,1,en);var la=qt.vertexLength;this.indexArray.emplaceBack(la,la+2,la+1),this.indexArray.emplaceBack(la+1,la+2,la+3),qt.vertexLength+=4,qt.primitiveLength+=2}}}}if(qt.vertexLength+pt>W.MAX_VERTEX_ARRAY_LENGTH&&(qt=this.segments.prepareSegment(pt,this.layoutVertexArray,this.indexArray)),vm[L.type]==="Polygon"){for(var ia=[],za=[],Ma=qt.vertexLength,ka=0,ii=tt;ka<ii.length;ka+=1){var Fa=ii[ka];if(Fa.length!==0){Fa!==tt[0]&&za.push(ia.length/2);for(var Ia=0;Ia<Fa.length;Ia++){var di=Fa[Ia];Ah(this.layoutVertexArray,di.x,di.y,0,0,1,1,0),ia.push(di.x),ia.push(di.y)}}}for(var ni=np(ia,za),zi=0;zi<ni.length;zi+=3)this.indexArray.emplaceBack(Ma+ni[zi],Ma+ni[zi+2],Ma+ni[zi+1]);qt.primitiveLength+=ni.length/3,qt.vertexLength+=pt}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,L,$,we,ve)},Ue("FillExtrusionBucket",qu,{omit:["layers","features"]});function dm(D,L){return D.x===L.x&&(D.x<0||D.x>Va)||D.y===L.y&&(D.y<0||D.y>Va)}function gm(D){return D.every(function(L){return L.x<0})||D.every(function(L){return L.x>Va})||D.every(function(L){return L.y<0})||D.every(function(L){return L.y>Va})}var ym=new ro({"fill-extrusion-opacity":new Ba(Gt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Qa(Gt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ba(Gt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ba(Gt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Lo(Gt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Qa(Gt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Qa(Gt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ba(Gt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),mm={paint:ym},xm=function(D){function L(U){D.call(this,U,mm)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.createBucket=function($){return new qu($)},L.prototype.queryRadius=function(){return ku(this.paint.get("fill-extrusion-translate"))},L.prototype.is3D=function(){return!0},L.prototype.queryIntersectsFeature=function($,ve,we,Me,Oe,tt,pt,gt){var Nt=du($,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),tt.angle,pt),nr=this.paint.get("fill-extrusion-height").evaluate(ve,we),qt=this.paint.get("fill-extrusion-base").evaluate(ve,we),yr=wm(Nt,gt,tt,0),Nr=_m(Me,qt,nr,gt),ln=Nr[0],en=Nr[1];return bm(ln,en,yr)},L}(Ns);function Mh(D,L){return D.x*L.x+D.y*L.y}function yd(D,L){if(D.length===1){for(var U=0,$=L[U++],ve;!ve||$.equals(ve);)if(ve=L[U++],!ve)return 1/0;for(;U<L.length;U++){var we=L[U],Me=D[0],Oe=ve.sub($),tt=we.sub($),pt=Me.sub($),gt=Mh(Oe,Oe),Nt=Mh(Oe,tt),nr=Mh(tt,tt),qt=Mh(pt,Oe),yr=Mh(pt,tt),Nr=gt*nr-Nt*Nt,ln=(nr*qt-Nt*yr)/Nr,en=(gt*yr-Nt*qt)/Nr,kn=1-ln-en,bn=$.z*kn+ve.z*ln+we.z*en;if(isFinite(bn))return bn}return 1/0}else{for(var Cn=1/0,zn=0,Wn=L;zn<Wn.length;zn+=1){var la=Wn[zn];Cn=Math.min(Cn,la.z)}return Cn}}function bm(D,L,U){var $=1/0;Io(U,L)&&($=yd(U,L[0]));for(var ve=0;ve<L.length;ve++)for(var we=L[ve],Me=D[ve],Oe=0;Oe<we.length-1;Oe++){var tt=we[Oe],pt=we[Oe+1],gt=Me[Oe],Nt=Me[Oe+1],nr=[tt,pt,Nt,gt,tt];ui(U,nr)&&($=Math.min($,yd(U,nr)))}return $===1/0?!1:$}function _m(D,L,U,$){for(var ve=[],we=[],Me=$[8]*L,Oe=$[9]*L,tt=$[10]*L,pt=$[11]*L,gt=$[8]*U,Nt=$[9]*U,nr=$[10]*U,qt=$[11]*U,yr=0,Nr=D;yr<Nr.length;yr+=1){for(var ln=Nr[yr],en=[],kn=[],bn=0,Cn=ln;bn<Cn.length;bn+=1){var zn=Cn[bn],Wn=zn.x,la=zn.y,ia=$[0]*Wn+$[4]*la+$[12],za=$[1]*Wn+$[5]*la+$[13],Ma=$[2]*Wn+$[6]*la+$[14],ka=$[3]*Wn+$[7]*la+$[15],ii=ia+Me,Fa=za+Oe,Ia=Ma+tt,di=ka+pt,ni=ia+gt,zi=za+Nt,to=Ma+nr,Bi=ka+qt,Ni=new f(ii/di,Fa/di);Ni.z=Ia/di,en.push(Ni);var Li=new f(ni/Bi,zi/Bi);Li.z=to/Bi,kn.push(Li)}ve.push(en),we.push(kn)}return[ve,we]}function wm(D,L,U,$){for(var ve=[],we=0,Me=D;we<Me.length;we+=1){var Oe=Me[we],tt=[Oe.x,Oe.y,$,1];Jh(tt,tt,L),ve.push(new f(tt[0]/tt[3],tt[1]/tt[3]))}return ve}var Tm=Xo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),md=Tm.members,Am=Ic.VectorTileFeature.types,xd=63,Mm=Math.cos(75/2*(Math.PI/180)),Sm=15,Em=20,Cm=15,bd=1/2,_d=Math.pow(2,Cm-1)/bd,Ml=function(L){this.zoom=L.zoom,this.overscaling=L.overscaling,this.layers=L.layers,this.layerIds=this.layers.map(function(U){return U.id}),this.index=L.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ac,this.indexArray=new Ku,this.programConfigurations=new si(md,L.layers,L.zoom),this.segments=new W,this.stateDependentLayerIds=this.layers.filter(function(U){return U.isStateDependent()}).map(function(U){return U.id})};Ml.prototype.populate=function(L,U,$){this.hasPattern=lp("line",this.layers,U);for(var ve=this.layers[0].layout.get("line-sort-key"),we=[],Me=0,Oe=L;Me<Oe.length;Me+=1){var tt=Oe[Me],pt=tt.feature,gt=tt.id,Nt=tt.index,nr=tt.sourceLayerIndex,qt=this.layers[0]._featureFilter.needGeometry,yr={type:pt.type,id:gt,properties:pt.properties,geometry:qt?Ji(pt):[]};if(!!this.layers[0]._featureFilter.filter(new ci(this.zoom),yr,$)){qt||(yr.geometry=Ji(pt));var Nr=ve?ve.evaluate(yr,{},$):void 0,ln={id:gt,properties:pt.properties,type:pt.type,sourceLayerIndex:nr,index:Nt,geometry:yr.geometry,patterns:{},sortKey:Nr};we.push(ln)}}ve&&we.sort(function(Ma,ka){return Ma.sortKey-ka.sortKey});for(var en=0,kn=we;en<kn.length;en+=1){var bn=kn[en],Cn=bn,zn=Cn.geometry,Wn=Cn.index,la=Cn.sourceLayerIndex;if(this.hasPattern){var ia=up("line",this.layers,bn,this.zoom,U);this.patternFeatures.push(ia)}else this.addFeature(bn,zn,Wn,$,{});var za=L[Wn].feature;U.featureIndex.insert(za,zn,Wn,la,this.index)}},Ml.prototype.update=function(L,U,$){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(L,U,this.stateDependentLayers,$)},Ml.prototype.addFeatures=function(L,U,$){for(var ve=0,we=this.patternFeatures;ve<we.length;ve+=1){var Me=we[ve];this.addFeature(Me,Me.geometry,Me.index,U,$)}},Ml.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ml.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ml.prototype.upload=function(L){this.uploaded||(this.layoutVertexBuffer=L.createVertexBuffer(this.layoutVertexArray,md),this.indexBuffer=L.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(L),this.uploaded=!0},Ml.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ml.prototype.addFeature=function(L,U,$,ve,we){for(var Me=this.layers[0].layout,Oe=Me.get("line-join").evaluate(L,{}),tt=Me.get("line-cap"),pt=Me.get("line-miter-limit"),gt=Me.get("line-round-limit"),Nt=0,nr=U;Nt<nr.length;Nt+=1){var qt=nr[Nt];this.addLine(qt,L,Oe,tt,pt,gt)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,L,$,we,ve)},Ml.prototype.addLine=function(L,U,$,ve,we,Me){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,!!U.properties&&U.properties.hasOwnProperty("mapbox_clip_start")&&U.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+U.properties.mapbox_clip_start,this.clipEnd=+U.properties.mapbox_clip_end;for(var Oe=0;Oe<L.length-1;Oe++)this.totalDistance+=L[Oe].dist(L[Oe+1]);this.updateScaledDistance()}for(var tt=Am[U.type]==="Polygon",pt=L.length;pt>=2&&L[pt-1].equals(L[pt-2]);)pt--;for(var gt=0;gt<pt-1&&L[gt].equals(L[gt+1]);)gt++;if(!(pt<(tt?3:2))){$==="bevel"&&(we=1.05);var Nt=this.overscaling<=16?Sm*Va/(512*this.overscaling):0,nr=this.segments.prepareSegment(pt*10,this.layoutVertexArray,this.indexArray),qt,yr=void 0,Nr=void 0,ln=void 0,en=void 0;this.e1=this.e2=-1,tt&&(qt=L[pt-2],en=L[gt].sub(qt)._unit()._perp());for(var kn=gt;kn<pt;kn++)if(Nr=kn===pt-1?tt?L[gt+1]:void 0:L[kn+1],!(Nr&&L[kn].equals(Nr))){en&&(ln=en),qt&&(yr=qt),qt=L[kn],en=Nr?Nr.sub(qt)._unit()._perp():ln,ln=ln||en;var bn=ln.add(en);(bn.x!==0||bn.y!==0)&&bn._unit();var Cn=ln.x*en.x+ln.y*en.y,zn=bn.x*en.x+bn.y*en.y,Wn=zn!==0?1/zn:1/0,la=2*Math.sqrt(2-2*zn),ia=zn<Mm&&yr&&Nr,za=ln.x*en.y-ln.y*en.x>0;if(ia&&kn>gt){var Ma=qt.dist(yr);if(Ma>2*Nt){var ka=qt.sub(qt.sub(yr)._mult(Nt/Ma)._round());this.updateDistance(yr,ka),this.addCurrentVertex(ka,ln,0,0,nr),yr=ka}}var ii=yr&&Nr,Fa=ii?$:tt?"butt":ve;if(ii&&Fa==="round"&&(Wn<Me?Fa="miter":Wn<=2&&(Fa="fakeround")),Fa==="miter"&&Wn>we&&(Fa="bevel"),Fa==="bevel"&&(Wn>2&&(Fa="flipbevel"),Wn<we&&(Fa="miter")),yr&&this.updateDistance(yr,qt),Fa==="miter")bn._mult(Wn),this.addCurrentVertex(qt,bn,0,0,nr);else if(Fa==="flipbevel"){if(Wn>100)bn=en.mult(-1);else{var Ia=Wn*ln.add(en).mag()/ln.sub(en).mag();bn._perp()._mult(Ia*(za?-1:1))}this.addCurrentVertex(qt,bn,0,0,nr),this.addCurrentVertex(qt,bn.mult(-1),0,0,nr)}else if(Fa==="bevel"||Fa==="fakeround"){var di=-Math.sqrt(Wn*Wn-1),ni=za?di:0,zi=za?0:di;if(yr&&this.addCurrentVertex(qt,ln,ni,zi,nr),Fa==="fakeround")for(var to=Math.round(la*180/Math.PI/Em),Bi=1;Bi<to;Bi++){var Ni=Bi/to;if(Ni!==.5){var Li=Ni-.5,lo=1.0904+Cn*(-3.2452+Cn*(3.55645-Cn*1.43519)),ho=.848013+Cn*(-1.06021+Cn*.215638);Ni=Ni+Ni*Li*(Ni-1)*(lo*Li*Li+ho)}var zo=en.sub(ln)._mult(Ni)._add(ln)._unit()._mult(za?-1:1);this.addHalfVertex(qt,zo.x,zo.y,!1,za,0,nr)}Nr&&this.addCurrentVertex(qt,en,-ni,-zi,nr)}else if(Fa==="butt")this.addCurrentVertex(qt,bn,0,0,nr);else if(Fa==="square"){var Go=yr?1:-1;this.addCurrentVertex(qt,bn,Go,Go,nr)}else Fa==="round"&&(yr&&(this.addCurrentVertex(qt,ln,0,0,nr),this.addCurrentVertex(qt,ln,1,1,nr,!0)),Nr&&(this.addCurrentVertex(qt,en,-1,-1,nr,!0),this.addCurrentVertex(qt,en,0,0,nr)));if(ia&&kn<pt-1){var ms=qt.dist(Nr);if(ms>2*Nt){var rs=qt.add(Nr.sub(qt)._mult(Nt/ms)._round());this.updateDistance(qt,rs),this.addCurrentVertex(rs,en,0,0,nr),qt=rs}}}}},Ml.prototype.addCurrentVertex=function(L,U,$,ve,we,Me){Me===void 0&&(Me=!1);var Oe=U.x+U.y*$,tt=U.y-U.x*$,pt=-U.x+U.y*ve,gt=-U.y-U.x*ve;this.addHalfVertex(L,Oe,tt,Me,!1,$,we),this.addHalfVertex(L,pt,gt,Me,!0,-ve,we),this.distance>_d/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(L,U,$,ve,we,Me))},Ml.prototype.addHalfVertex=function(L,U,$,ve,we,Me,Oe){var tt=L.x,pt=L.y,gt=this.scaledDistance*bd;this.layoutVertexArray.emplaceBack((tt<<1)+(ve?1:0),(pt<<1)+(we?1:0),Math.round(xd*U)+128,Math.round(xd*$)+128,(Me===0?0:Me<0?-1:1)+1|(gt&63)<<2,gt>>6);var Nt=Oe.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Nt),Oe.primitiveLength++),we?this.e2=Nt:this.e1=Nt},Ml.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(_d-1):this.distance},Ml.prototype.updateDistance=function(L,U){this.distance+=L.dist(U),this.updateScaledDistance()},Ue("LineBucket",Ml,{omit:["layers","patternFeatures"]});var km=new ro({"line-cap":new Ba(Gt.layout_line["line-cap"]),"line-join":new Qa(Gt.layout_line["line-join"]),"line-miter-limit":new Ba(Gt.layout_line["line-miter-limit"]),"line-round-limit":new Ba(Gt.layout_line["line-round-limit"]),"line-sort-key":new Qa(Gt.layout_line["line-sort-key"])}),Dm=new ro({"line-opacity":new Qa(Gt.paint_line["line-opacity"]),"line-color":new Qa(Gt.paint_line["line-color"]),"line-translate":new Ba(Gt.paint_line["line-translate"]),"line-translate-anchor":new Ba(Gt.paint_line["line-translate-anchor"]),"line-width":new Qa(Gt.paint_line["line-width"]),"line-gap-width":new Qa(Gt.paint_line["line-gap-width"]),"line-offset":new Qa(Gt.paint_line["line-offset"]),"line-blur":new Qa(Gt.paint_line["line-blur"]),"line-dasharray":new fo(Gt.paint_line["line-dasharray"]),"line-pattern":new Lo(Gt.paint_line["line-pattern"]),"line-gradient":new Wo(Gt.paint_line["line-gradient"])}),wd={paint:Dm,layout:km},Lm=function(D){function L(){D.apply(this,arguments)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.possiblyEvaluate=function($,ve){return ve=new ci(Math.floor(ve.zoom),{now:ve.now,fadeDuration:ve.fadeDuration,zoomHistory:ve.zoomHistory,transition:ve.transition}),D.prototype.possiblyEvaluate.call(this,$,ve)},L.prototype.evaluate=function($,ve,we,Me){return ve=M({},ve,{zoom:Math.floor(ve.zoom)}),D.prototype.evaluate.call(this,$,ve,we,Me)},L}(Qa),Td=new Lm(wd.paint.properties["line-width"].specification);Td.useIntegerZoom=!0;var Pm=function(D){function L(U){D.call(this,U,wd)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype._handleSpecialPaintPropertyUpdate=function($){$==="line-gradient"&&this._updateGradient()},L.prototype._updateGradient=function(){var $=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=od($,"lineProgress"),this.gradientTexture=null},L.prototype.recalculate=function($,ve){D.prototype.recalculate.call(this,$,ve),this.paint._values["line-floorwidth"]=Td.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,$)},L.prototype.createBucket=function($){return new Ml($)},L.prototype.queryRadius=function($){var ve=$,we=Ad(Il("line-width",this,ve),Il("line-gap-width",this,ve)),Me=Il("line-offset",this,ve);return we/2+Math.abs(Me)+ku(this.paint.get("line-translate"))},L.prototype.queryIntersectsFeature=function($,ve,we,Me,Oe,tt,pt){var gt=du($,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),tt.angle,pt),Nt=pt/2*Ad(this.paint.get("line-width").evaluate(ve,we),this.paint.get("line-gap-width").evaluate(ve,we)),nr=this.paint.get("line-offset").evaluate(ve,we);return nr&&(Me=Fm(Me,nr*pt)),$o(gt,Me,Nt)},L.prototype.isTileClipped=function(){return!0},L}(Ns);function Ad(D,L){return L>0?L+2*D:D}function Fm(D,L){for(var U=[],$=new f(0,0),ve=0;ve<D.length;ve++){for(var we=D[ve],Me=[],Oe=0;Oe<we.length;Oe++){var tt=we[Oe-1],pt=we[Oe],gt=we[Oe+1],Nt=Oe===0?$:pt.sub(tt)._unit()._perp(),nr=Oe===we.length-1?$:gt.sub(pt)._unit()._perp(),qt=Nt._add(nr)._unit(),yr=qt.x*nr.x+qt.y*nr.y;qt._mult(1/yr),Me.push(qt._mult(L)._add(pt))}U.push(Me)}return U}var cp=Xo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Rm=Xo([{name:"a_projected_pos",components:3,type:"Float32"}],4);Xo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var Im=Xo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Xo([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var Md=Xo([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),zm=Xo([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Xo([{name:"triangle",components:3,type:"Uint16"}]),Xo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Xo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Xo([{type:"Float32",name:"offsetX"}]),Xo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function Bm(D,L,U){var $=L.layout.get("text-transform").evaluate(U,{});return $==="uppercase"?D=D.toLocaleUpperCase():$==="lowercase"&&(D=D.toLocaleLowerCase()),Ka.applyArabicShaping&&(D=Ka.applyArabicShaping(D)),D}function Nm(D,L,U){return D.sections.forEach(function($){$.text=Bm($.text,L,U)}),D}function Om(D){var L={},U={},$=[],ve=0;function we(en){$.push(D[en]),ve++}function Me(en,kn,bn){var Cn=U[en];return delete U[en],U[kn]=Cn,$[Cn].geometry[0].pop(),$[Cn].geometry[0]=$[Cn].geometry[0].concat(bn[0]),Cn}function Oe(en,kn,bn){var Cn=L[kn];return delete L[kn],L[en]=Cn,$[Cn].geometry[0].shift(),$[Cn].geometry[0]=bn[0].concat($[Cn].geometry[0]),Cn}function tt(en,kn,bn){var Cn=bn?kn[0][kn[0].length-1]:kn[0][0];return en+":"+Cn.x+":"+Cn.y}for(var pt=0;pt<D.length;pt++){var gt=D[pt],Nt=gt.geometry,nr=gt.text?gt.text.toString():null;if(!nr){we(pt);continue}var qt=tt(nr,Nt),yr=tt(nr,Nt,!0);if(qt in U&&yr in L&&U[qt]!==L[yr]){var Nr=Oe(qt,yr,Nt),ln=Me(qt,yr,$[Nr].geometry);delete L[qt],delete U[yr],U[tt(nr,$[ln].geometry,!0)]=ln,$[Nr].geometry=null}else qt in U?Me(qt,yr,Nt):yr in L?Oe(qt,yr,Nt):(we(pt),L[qt]=ve-1,U[yr]=ve-1)}return $.filter(function(en){return en.geometry})}var Sh={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function Um(D){for(var L="",U=0;U<D.length;U++){var $=D.charCodeAt(U+1)||null,ve=D.charCodeAt(U-1)||null,we=(!$||!sn($)||Sh[D[U+1]])&&(!ve||!sn(ve)||Sh[D[U-1]]);we&&Sh[D[U]]?L+=Sh[D[U]]:L+=D[U]}return L}var Ls=24,Vm=function(D,L,U,$,ve){var we,Me,Oe=ve*8-$-1,tt=(1<<Oe)-1,pt=tt>>1,gt=-7,Nt=U?ve-1:0,nr=U?-1:1,qt=D[L+Nt];for(Nt+=nr,we=qt&(1<<-gt)-1,qt>>=-gt,gt+=Oe;gt>0;we=we*256+D[L+Nt],Nt+=nr,gt-=8);for(Me=we&(1<<-gt)-1,we>>=-gt,gt+=$;gt>0;Me=Me*256+D[L+Nt],Nt+=nr,gt-=8);if(we===0)we=1-pt;else{if(we===tt)return Me?NaN:(qt?-1:1)*(1/0);Me=Me+Math.pow(2,$),we=we-pt}return(qt?-1:1)*Me*Math.pow(2,we-$)},Hm=function(D,L,U,$,ve,we){var Me,Oe,tt,pt=we*8-ve-1,gt=(1<<pt)-1,Nt=gt>>1,nr=ve===23?Math.pow(2,-24)-Math.pow(2,-77):0,qt=$?0:we-1,yr=$?1:-1,Nr=L<0||L===0&&1/L<0?1:0;for(L=Math.abs(L),isNaN(L)||L===1/0?(Oe=isNaN(L)?1:0,Me=gt):(Me=Math.floor(Math.log(L)/Math.LN2),L*(tt=Math.pow(2,-Me))<1&&(Me--,tt*=2),Me+Nt>=1?L+=nr/tt:L+=nr*Math.pow(2,1-Nt),L*tt>=2&&(Me++,tt/=2),Me+Nt>=gt?(Oe=0,Me=gt):Me+Nt>=1?(Oe=(L*tt-1)*Math.pow(2,ve),Me=Me+Nt):(Oe=L*Math.pow(2,Nt-1)*Math.pow(2,ve),Me=0));ve>=8;D[U+qt]=Oe&255,qt+=yr,Oe/=256,ve-=8);for(Me=Me<<ve|Oe,pt+=ve;pt>0;D[U+qt]=Me&255,qt+=yr,Me/=256,pt-=8);D[U+qt-yr]|=Nr*128},ev={read:Vm,write:Hm},tv=co;function co(D){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(D)?D:new Uint8Array(D||0),this.pos=0,this.type=0,this.length=this.buf.length}co.Varint=0,co.Fixed64=1,co.Bytes=2,co.Fixed32=5;var hp=(1<<16)*(1<<16),Sd=1/hp,Gm=12,Ed=typeof TextDecoder>"u"?null:new TextDecoder("utf8");co.prototype={destroy:function(){this.buf=null},readFields:function(D,L,U){for(U=U||this.length;this.pos<U;){var $=this.readVarint(),ve=$>>3,we=this.pos;this.type=$&7,D(ve,L,this),this.pos===we&&this.skip($)}return L},readMessage:function(D,L){return this.readFields(D,L,this.readVarint()+this.pos)},readFixed32:function(){var D=rv(this.buf,this.pos);return this.pos+=4,D},readSFixed32:function(){var D=kd(this.buf,this.pos);return this.pos+=4,D},readFixed64:function(){var D=rv(this.buf,this.pos)+rv(this.buf,this.pos+4)*hp;return this.pos+=8,D},readSFixed64:function(){var D=rv(this.buf,this.pos)+kd(this.buf,this.pos+4)*hp;return this.pos+=8,D},readFloat:function(){var D=ev.read(this.buf,this.pos,!0,23,4);return this.pos+=4,D},readDouble:function(){var D=ev.read(this.buf,this.pos,!0,52,8);return this.pos+=8,D},readVarint:function(D){var L=this.buf,U,$;return $=L[this.pos++],U=$&127,$<128||($=L[this.pos++],U|=($&127)<<7,$<128)||($=L[this.pos++],U|=($&127)<<14,$<128)||($=L[this.pos++],U|=($&127)<<21,$<128)?U:($=L[this.pos],U|=($&15)<<28,Ym(U,D,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var D=this.readVarint();return D%2===1?(D+1)/-2:D/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var D=this.readVarint()+this.pos,L=this.pos;return this.pos=D,D-L>=Gm&&Ed?a1(this.buf,L,D):n1(this.buf,L,D)},readBytes:function(){var D=this.readVarint()+this.pos,L=this.buf.subarray(this.pos,D);return this.pos=D,L},readPackedVarint:function(D,L){if(this.type!==co.Bytes)return D.push(this.readVarint(L));var U=Pf(this);for(D=D||[];this.pos<U;)D.push(this.readVarint(L));return D},readPackedSVarint:function(D){if(this.type!==co.Bytes)return D.push(this.readSVarint());var L=Pf(this);for(D=D||[];this.pos<L;)D.push(this.readSVarint());return D},readPackedBoolean:function(D){if(this.type!==co.Bytes)return D.push(this.readBoolean());var L=Pf(this);for(D=D||[];this.pos<L;)D.push(this.readBoolean());return D},readPackedFloat:function(D){if(this.type!==co.Bytes)return D.push(this.readFloat());var L=Pf(this);for(D=D||[];this.pos<L;)D.push(this.readFloat());return D},readPackedDouble:function(D){if(this.type!==co.Bytes)return D.push(this.readDouble());var L=Pf(this);for(D=D||[];this.pos<L;)D.push(this.readDouble());return D},readPackedFixed32:function(D){if(this.type!==co.Bytes)return D.push(this.readFixed32());var L=Pf(this);for(D=D||[];this.pos<L;)D.push(this.readFixed32());return D},readPackedSFixed32:function(D){if(this.type!==co.Bytes)return D.push(this.readSFixed32());var L=Pf(this);for(D=D||[];this.pos<L;)D.push(this.readSFixed32());return D},readPackedFixed64:function(D){if(this.type!==co.Bytes)return D.push(this.readFixed64());var L=Pf(this);for(D=D||[];this.pos<L;)D.push(this.readFixed64());return D},readPackedSFixed64:function(D){if(this.type!==co.Bytes)return D.push(this.readSFixed64());var L=Pf(this);for(D=D||[];this.pos<L;)D.push(this.readSFixed64());return D},skip:function(D){var L=D&7;if(L===co.Varint)for(;this.buf[this.pos++]>127;);else if(L===co.Bytes)this.pos=this.readVarint()+this.pos;else if(L===co.Fixed32)this.pos+=4;else if(L===co.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+L)},writeTag:function(D,L){this.writeVarint(D<<3|L)},realloc:function(D){for(var L=this.length||16;L<this.pos+D;)L*=2;if(L!==this.length){var U=new Uint8Array(L);U.set(this.buf),this.buf=U,this.length=L}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(D){this.realloc(4),Bc(this.buf,D,this.pos),this.pos+=4},writeSFixed32:function(D){this.realloc(4),Bc(this.buf,D,this.pos),this.pos+=4},writeFixed64:function(D){this.realloc(8),Bc(this.buf,D&-1,this.pos),Bc(this.buf,Math.floor(D*Sd),this.pos+4),this.pos+=8},writeSFixed64:function(D){this.realloc(8),Bc(this.buf,D&-1,this.pos),Bc(this.buf,Math.floor(D*Sd),this.pos+4),this.pos+=8},writeVarint:function(D){if(D=+D||0,D>268435455||D<0){Wm(D,this);return}this.realloc(4),this.buf[this.pos++]=D&127|(D>127?128:0),!(D<=127)&&(this.buf[this.pos++]=(D>>>=7)&127|(D>127?128:0),!(D<=127)&&(this.buf[this.pos++]=(D>>>=7)&127|(D>127?128:0),!(D<=127)&&(this.buf[this.pos++]=D>>>7&127)))},writeSVarint:function(D){this.writeVarint(D<0?-D*2-1:D*2)},writeBoolean:function(D){this.writeVarint(Boolean(D))},writeString:function(D){D=String(D),this.realloc(D.length*4),this.pos++;var L=this.pos;this.pos=i1(this.buf,D,this.pos);var U=this.pos-L;U>=128&&Cd(L,U,this),this.pos=L-1,this.writeVarint(U),this.pos+=U},writeFloat:function(D){this.realloc(4),ev.write(this.buf,D,this.pos,!0,23,4),this.pos+=4},writeDouble:function(D){this.realloc(8),ev.write(this.buf,D,this.pos,!0,52,8),this.pos+=8},writeBytes:function(D){var L=D.length;this.writeVarint(L),this.realloc(L);for(var U=0;U<L;U++)this.buf[this.pos++]=D[U]},writeRawMessage:function(D,L){this.pos++;var U=this.pos;D(L,this);var $=this.pos-U;$>=128&&Cd(U,$,this),this.pos=U-1,this.writeVarint($),this.pos+=$},writeMessage:function(D,L,U){this.writeTag(D,co.Bytes),this.writeRawMessage(L,U)},writePackedVarint:function(D,L){L.length&&this.writeMessage(D,jm,L)},writePackedSVarint:function(D,L){L.length&&this.writeMessage(D,Jm,L)},writePackedBoolean:function(D,L){L.length&&this.writeMessage(D,$m,L)},writePackedFloat:function(D,L){L.length&&this.writeMessage(D,Km,L)},writePackedDouble:function(D,L){L.length&&this.writeMessage(D,Qm,L)},writePackedFixed32:function(D,L){L.length&&this.writeMessage(D,qm,L)},writePackedSFixed32:function(D,L){L.length&&this.writeMessage(D,e1,L)},writePackedFixed64:function(D,L){L.length&&this.writeMessage(D,t1,L)},writePackedSFixed64:function(D,L){L.length&&this.writeMessage(D,r1,L)},writeBytesField:function(D,L){this.writeTag(D,co.Bytes),this.writeBytes(L)},writeFixed32Field:function(D,L){this.writeTag(D,co.Fixed32),this.writeFixed32(L)},writeSFixed32Field:function(D,L){this.writeTag(D,co.Fixed32),this.writeSFixed32(L)},writeFixed64Field:function(D,L){this.writeTag(D,co.Fixed64),this.writeFixed64(L)},writeSFixed64Field:function(D,L){this.writeTag(D,co.Fixed64),this.writeSFixed64(L)},writeVarintField:function(D,L){this.writeTag(D,co.Varint),this.writeVarint(L)},writeSVarintField:function(D,L){this.writeTag(D,co.Varint),this.writeSVarint(L)},writeStringField:function(D,L){this.writeTag(D,co.Bytes),this.writeString(L)},writeFloatField:function(D,L){this.writeTag(D,co.Fixed32),this.writeFloat(L)},writeDoubleField:function(D,L){this.writeTag(D,co.Fixed64),this.writeDouble(L)},writeBooleanField:function(D,L){this.writeVarintField(D,Boolean(L))}};function Ym(D,L,U){var $=U.buf,ve,we;if(we=$[U.pos++],ve=(we&112)>>4,we<128||(we=$[U.pos++],ve|=(we&127)<<3,we<128)||(we=$[U.pos++],ve|=(we&127)<<10,we<128)||(we=$[U.pos++],ve|=(we&127)<<17,we<128)||(we=$[U.pos++],ve|=(we&127)<<24,we<128)||(we=$[U.pos++],ve|=(we&1)<<31,we<128))return zc(D,ve,L);throw new Error("Expected varint not more than 10 bytes")}function Pf(D){return D.type===co.Bytes?D.readVarint()+D.pos:D.pos+1}function zc(D,L,U){return U?L*4294967296+(D>>>0):(L>>>0)*4294967296+(D>>>0)}function Wm(D,L){var U,$;if(D>=0?(U=D%4294967296|0,$=D/4294967296|0):(U=~(-D%4294967296),$=~(-D/4294967296),U^4294967295?U=U+1|0:(U=0,$=$+1|0)),D>=18446744073709552e3||D<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");L.realloc(10),Xm(U,$,L),Zm($,L)}function Xm(D,L,U){U.buf[U.pos++]=D&127|128,D>>>=7,U.buf[U.pos++]=D&127|128,D>>>=7,U.buf[U.pos++]=D&127|128,D>>>=7,U.buf[U.pos++]=D&127|128,D>>>=7,U.buf[U.pos]=D&127}function Zm(D,L){var U=(D&7)<<4;L.buf[L.pos++]|=U|((D>>>=3)?128:0),D&&(L.buf[L.pos++]=D&127|((D>>>=7)?128:0),D&&(L.buf[L.pos++]=D&127|((D>>>=7)?128:0),D&&(L.buf[L.pos++]=D&127|((D>>>=7)?128:0),D&&(L.buf[L.pos++]=D&127|((D>>>=7)?128:0),D&&(L.buf[L.pos++]=D&127)))))}function Cd(D,L,U){var $=L<=16383?1:L<=2097151?2:L<=268435455?3:Math.floor(Math.log(L)/(Math.LN2*7));U.realloc($);for(var ve=U.pos-1;ve>=D;ve--)U.buf[ve+$]=U.buf[ve]}function jm(D,L){for(var U=0;U<D.length;U++)L.writeVarint(D[U])}function Jm(D,L){for(var U=0;U<D.length;U++)L.writeSVarint(D[U])}function Km(D,L){for(var U=0;U<D.length;U++)L.writeFloat(D[U])}function Qm(D,L){for(var U=0;U<D.length;U++)L.writeDouble(D[U])}function $m(D,L){for(var U=0;U<D.length;U++)L.writeBoolean(D[U])}function qm(D,L){for(var U=0;U<D.length;U++)L.writeFixed32(D[U])}function e1(D,L){for(var U=0;U<D.length;U++)L.writeSFixed32(D[U])}function t1(D,L){for(var U=0;U<D.length;U++)L.writeFixed64(D[U])}function r1(D,L){for(var U=0;U<D.length;U++)L.writeSFixed64(D[U])}function rv(D,L){return(D[L]|D[L+1]<<8|D[L+2]<<16)+D[L+3]*16777216}function Bc(D,L,U){D[U]=L,D[U+1]=L>>>8,D[U+2]=L>>>16,D[U+3]=L>>>24}function kd(D,L){return(D[L]|D[L+1]<<8|D[L+2]<<16)+(D[L+3]<<24)}function n1(D,L,U){for(var $="",ve=L;ve<U;){var we=D[ve],Me=null,Oe=we>239?4:we>223?3:we>191?2:1;if(ve+Oe>U)break;var tt,pt,gt;Oe===1?we<128&&(Me=we):Oe===2?(tt=D[ve+1],(tt&192)===128&&(Me=(we&31)<<6|tt&63,Me<=127&&(Me=null))):Oe===3?(tt=D[ve+1],pt=D[ve+2],(tt&192)===128&&(pt&192)===128&&(Me=(we&15)<<12|(tt&63)<<6|pt&63,(Me<=2047||Me>=55296&&Me<=57343)&&(Me=null))):Oe===4&&(tt=D[ve+1],pt=D[ve+2],gt=D[ve+3],(tt&192)===128&&(pt&192)===128&&(gt&192)===128&&(Me=(we&15)<<18|(tt&63)<<12|(pt&63)<<6|gt&63,(Me<=65535||Me>=1114112)&&(Me=null))),Me===null?(Me=65533,Oe=1):Me>65535&&(Me-=65536,$+=String.fromCharCode(Me>>>10&1023|55296),Me=56320|Me&1023),$+=String.fromCharCode(Me),ve+=Oe}return $}function a1(D,L,U){return Ed.decode(D.subarray(L,U))}function i1(D,L,U){for(var $=0,ve,we;$<L.length;$++){if(ve=L.charCodeAt($),ve>55295&&ve<57344)if(we)if(ve<56320){D[U++]=239,D[U++]=191,D[U++]=189,we=ve;continue}else ve=we-55296<<10|ve-56320|65536,we=null;else{ve>56319||$+1===L.length?(D[U++]=239,D[U++]=191,D[U++]=189):we=ve;continue}else we&&(D[U++]=239,D[U++]=191,D[U++]=189,we=null);ve<128?D[U++]=ve:(ve<2048?D[U++]=ve>>6|192:(ve<65536?D[U++]=ve>>12|224:(D[U++]=ve>>18|240,D[U++]=ve>>12&63|128),D[U++]=ve>>6&63|128),D[U++]=ve&63|128)}return U}var vp=3;function o1(D,L,U){D===1&&U.readMessage(s1,L)}function s1(D,L,U){if(D===3){var $=U.readMessage(l1,{}),ve=$.id,we=$.bitmap,Me=$.width,Oe=$.height,tt=$.left,pt=$.top,gt=$.advance;L.push({id:ve,bitmap:new gc({width:Me+2*vp,height:Oe+2*vp},we),metrics:{width:Me,height:Oe,left:tt,top:pt,advance:gt}})}}function l1(D,L,U){D===1?L.id=U.readVarint():D===2?L.bitmap=U.readBytes():D===3?L.width=U.readVarint():D===4?L.height=U.readVarint():D===5?L.left=U.readSVarint():D===6?L.top=U.readSVarint():D===7&&(L.advance=U.readVarint())}function u1(D){return new tv(D).readFields(o1,[])}var Dd=vp;function Ld(D){for(var L=0,U=0,$=0,ve=D;$<ve.length;$+=1){var we=ve[$];L+=we.w*we.h,U=Math.max(U,we.w)}D.sort(function(ln,en){return en.h-ln.h});for(var Me=Math.max(Math.ceil(Math.sqrt(L/.95)),U),Oe=[{x:0,y:0,w:Me,h:1/0}],tt=0,pt=0,gt=0,Nt=D;gt<Nt.length;gt+=1)for(var nr=Nt[gt],qt=Oe.length-1;qt>=0;qt--){var yr=Oe[qt];if(!(nr.w>yr.w||nr.h>yr.h)){if(nr.x=yr.x,nr.y=yr.y,pt=Math.max(pt,nr.y+nr.h),tt=Math.max(tt,nr.x+nr.w),nr.w===yr.w&&nr.h===yr.h){var Nr=Oe.pop();qt<Oe.length&&(Oe[qt]=Nr)}else nr.h===yr.h?(yr.x+=nr.w,yr.w-=nr.w):nr.w===yr.w?(yr.y+=nr.h,yr.h-=nr.h):(Oe.push({x:yr.x+nr.w,y:yr.y,w:yr.w-nr.w,h:nr.h}),yr.y+=nr.h,yr.h-=nr.h);break}}return{w:tt,h:pt,fill:L/(tt*pt)||0}}var zl=1,nv=function(L,U){var $=U.pixelRatio,ve=U.version,we=U.stretchX,Me=U.stretchY,Oe=U.content;this.paddedRect=L,this.pixelRatio=$,this.stretchX=we,this.stretchY=Me,this.content=Oe,this.version=ve},Eh={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Eh.tl.get=function(){return[this.paddedRect.x+zl,this.paddedRect.y+zl]},Eh.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-zl,this.paddedRect.y+this.paddedRect.h-zl]},Eh.tlbr.get=function(){return this.tl.concat(this.br)},Eh.displaySize.get=function(){return[(this.paddedRect.w-zl*2)/this.pixelRatio,(this.paddedRect.h-zl*2)/this.pixelRatio]},Object.defineProperties(nv.prototype,Eh);var Ch=function(L,U){var $={},ve={};this.haveRenderCallbacks=[];var we=[];this.addImages(L,$,we),this.addImages(U,ve,we);var Me=Ld(we),Oe=Me.w,tt=Me.h,pt=new Al({width:Oe||1,height:tt||1});for(var gt in L){var Nt=L[gt],nr=$[gt].paddedRect;Al.copy(Nt.data,pt,{x:0,y:0},{x:nr.x+zl,y:nr.y+zl},Nt.data)}for(var qt in U){var yr=U[qt],Nr=ve[qt].paddedRect,ln=Nr.x+zl,en=Nr.y+zl,kn=yr.data.width,bn=yr.data.height;Al.copy(yr.data,pt,{x:0,y:0},{x:ln,y:en},yr.data),Al.copy(yr.data,pt,{x:0,y:bn-1},{x:ln,y:en-1},{width:kn,height:1}),Al.copy(yr.data,pt,{x:0,y:0},{x:ln,y:en+bn},{width:kn,height:1}),Al.copy(yr.data,pt,{x:kn-1,y:0},{x:ln-1,y:en},{width:1,height:bn}),Al.copy(yr.data,pt,{x:0,y:0},{x:ln+kn,y:en},{width:1,height:bn})}this.image=pt,this.iconPositions=$,this.patternPositions=ve};Ch.prototype.addImages=function(L,U,$){for(var ve in L){var we=L[ve],Me={x:0,y:0,w:we.data.width+2*zl,h:we.data.height+2*zl};$.push(Me),U[ve]=new nv(Me,we),we.hasRenderCallback&&this.haveRenderCallbacks.push(ve)}},Ch.prototype.patchUpdatedImages=function(L,U){L.dispatchRenderCallbacks(this.haveRenderCallbacks);for(var $ in L.updatedImages)this.patchUpdatedImage(this.iconPositions[$],L.getImage($),U),this.patchUpdatedImage(this.patternPositions[$],L.getImage($),U)},Ch.prototype.patchUpdatedImage=function(L,U,$){if(!(!L||!U)&&L.version!==U.version){L.version=U.version;var ve=L.tl,we=ve[0],Me=ve[1];$.update(U.data,void 0,{x:we,y:Me})}},Ue("ImagePosition",nv),Ue("ImageAtlas",Ch);var $l={horizontal:1,vertical:2,horizontalOnly:3},kh=-17;function f1(D){for(var L=0,U=D;L<U.length;L+=1){var $=U[L];if($.positionedGlyphs.length!==0)return!1}return!0}var Pd=57344,Fd=63743,Nc=function(){this.scale=1,this.fontStack="",this.imageName=null};Nc.forText=function(L,U){var $=new Nc;return $.scale=L||1,$.fontStack=U,$},Nc.forImage=function(L){var U=new Nc;return U.imageName=L,U};var Js=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};Js.fromFeature=function(L,U){for(var $=new Js,ve=0;ve<L.sections.length;ve++){var we=L.sections[ve];we.image?$.addImageSection(we):$.addTextSection(we,U)}return $},Js.prototype.length=function(){return this.text.length},Js.prototype.getSection=function(L){return this.sections[this.sectionIndex[L]]},Js.prototype.getSectionIndex=function(L){return this.sectionIndex[L]},Js.prototype.getCharCode=function(L){return this.text.charCodeAt(L)},Js.prototype.verticalizePunctuation=function(){this.text=Um(this.text)},Js.prototype.trim=function(){for(var L=0,U=0;U<this.text.length&&Sf[this.text.charCodeAt(U)];U++)L++;for(var $=this.text.length,ve=this.text.length-1;ve>=0&&ve>=L&&Sf[this.text.charCodeAt(ve)];ve--)$--;this.text=this.text.substring(L,$),this.sectionIndex=this.sectionIndex.slice(L,$)},Js.prototype.substring=function(L,U){var $=new Js;return $.text=this.text.substring(L,U),$.sectionIndex=this.sectionIndex.slice(L,U),$.sections=this.sections,$},Js.prototype.toString=function(){return this.text},Js.prototype.getMaxScale=function(){var L=this;return this.sectionIndex.reduce(function(U,$){return Math.max(U,L.sections[$].scale)},0)},Js.prototype.addTextSection=function(L,U){this.text+=L.text,this.sections.push(Nc.forText(L.scale,L.fontStack||U));for(var $=this.sections.length-1,ve=0;ve<L.text.length;++ve)this.sectionIndex.push($)},Js.prototype.addImageSection=function(L){var U=L.image?L.image.name:"";if(U.length===0){O("Can't add FormattedSection with an empty image.");return}var $=this.getNextImageSectionCharCode();if(!$){O("Reached maximum number of images "+(Fd-Pd+2));return}this.text+=String.fromCharCode($),this.sections.push(Nc.forImage(U)),this.sectionIndex.push(this.sections.length-1)},Js.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=Fd?null:++this.imageSectionID:(this.imageSectionID=Pd,this.imageSectionID)};function c1(D,L){for(var U=[],$=D.text,ve=0,we=0,Me=L;we<Me.length;we+=1){var Oe=Me[we];U.push(D.substring(ve,Oe)),ve=Oe}return ve<$.length&&U.push(D.substring(ve,$.length)),U}function av(D,L,U,$,ve,we,Me,Oe,tt,pt,gt,Nt,nr,qt,yr,Nr){var ln=Js.fromFeature(D,ve);Nt===$l.vertical&&ln.verticalizePunctuation();var en,kn=Ka.processBidirectionalText,bn=Ka.processStyledBidirectionalText;if(kn&&ln.sections.length===1){en=[];for(var Cn=kn(ln.toString(),pp(ln,pt,we,L,$,qt,yr)),zn=0,Wn=Cn;zn<Wn.length;zn+=1){var la=Wn[zn],ia=new Js;ia.text=la,ia.sections=ln.sections;for(var za=0;za<la.length;za++)ia.sectionIndex.push(0);en.push(ia)}}else if(bn){en=[];for(var Ma=bn(ln.text,ln.sectionIndex,pp(ln,pt,we,L,$,qt,yr)),ka=0,ii=Ma;ka<ii.length;ka+=1){var Fa=ii[ka],Ia=new Js;Ia.text=Fa[0],Ia.sectionIndex=Fa[1],Ia.sections=ln.sections,en.push(Ia)}}else en=c1(ln,pp(ln,pt,we,L,$,qt,yr));var di=[],ni={positionedLines:di,text:ln.toString(),top:gt[1],bottom:gt[1],left:gt[0],right:gt[0],writingMode:Nt,iconsInText:!1,verticalizable:!1};return p1(ni,L,U,$,en,Me,Oe,tt,Nt,pt,nr,Nr),f1(di)?!1:ni}var Sf={};Sf[9]=!0,Sf[10]=!0,Sf[11]=!0,Sf[12]=!0,Sf[13]=!0,Sf[32]=!0;var Bl={};Bl[10]=!0,Bl[32]=!0,Bl[38]=!0,Bl[40]=!0,Bl[41]=!0,Bl[43]=!0,Bl[45]=!0,Bl[47]=!0,Bl[173]=!0,Bl[183]=!0,Bl[8203]=!0,Bl[8208]=!0,Bl[8211]=!0,Bl[8231]=!0;function Rd(D,L,U,$,ve,we){if(L.imageName){var tt=$[L.imageName];return tt?tt.displaySize[0]*L.scale*Ls/we+ve:0}else{var Me=U[L.fontStack],Oe=Me&&Me[D];return Oe?Oe.metrics.advance*L.scale+ve:0}}function h1(D,L,U,$,ve,we){for(var Me=0,Oe=0;Oe<D.length();Oe++){var tt=D.getSection(Oe);Me+=Rd(D.getCharCode(Oe),tt,$,ve,L,we)}var pt=Math.max(1,Math.ceil(Me/U));return Me/pt}function Id(D,L,U,$){var ve=Math.pow(D-L,2);return $?D<L?ve/2:ve*2:ve+Math.abs(U)*U}function v1(D,L,U){var $=0;return D===10&&($-=1e4),U&&($+=150),(D===40||D===65288)&&($+=50),(L===41||L===65289)&&($+=50),$}function zd(D,L,U,$,ve,we){for(var Me=null,Oe=Id(L,U,ve,we),tt=0,pt=$;tt<pt.length;tt+=1){var gt=pt[tt],Nt=L-gt.x,nr=Id(Nt,U,ve,we)+gt.badness;nr<=Oe&&(Me=gt,Oe=nr)}return{index:D,x:L,priorBreak:Me,badness:Oe}}function Bd(D){return D?Bd(D.priorBreak).concat(D.index):[]}function pp(D,L,U,$,ve,we,Me){if(we!=="point")return[];if(!D)return[];for(var Oe=[],tt=h1(D,L,U,$,ve,Me),pt=D.text.indexOf("\u200B")>=0,gt=0,Nt=0;Nt<D.length();Nt++){var nr=D.getSection(Nt),qt=D.getCharCode(Nt);if(Sf[qt]||(gt+=Rd(qt,nr,$,ve,L,Me)),Nt<D.length()-1){var yr=Pr(qt);(Bl[qt]||yr||nr.imageName)&&Oe.push(zd(Nt+1,gt,tt,Oe,v1(qt,D.getCharCode(Nt+1),yr&&pt),!1))}}return Bd(zd(D.length(),gt,tt,Oe,0,!0))}function dp(D){var L=.5,U=.5;switch(D){case"right":case"top-right":case"bottom-right":L=1;break;case"left":case"top-left":case"bottom-left":L=0;break}switch(D){case"bottom":case"bottom-right":case"bottom-left":U=1;break;case"top":case"top-right":case"top-left":U=0;break}return{horizontalAlign:L,verticalAlign:U}}function p1(D,L,U,$,ve,we,Me,Oe,tt,pt,gt,Nt){for(var nr=0,qt=kh,yr=0,Nr=0,ln=Oe==="right"?1:Oe==="left"?0:.5,en=0,kn=0,bn=ve;kn<bn.length;kn+=1){var Cn=bn[kn];Cn.trim();var zn=Cn.getMaxScale(),Wn=(zn-1)*Ls,la={positionedGlyphs:[],lineOffset:0};D.positionedLines[en]=la;var ia=la.positionedGlyphs,za=0;if(!Cn.length()){qt+=we,++en;continue}for(var Ma=0;Ma<Cn.length();Ma++){var ka=Cn.getSection(Ma),ii=Cn.getSectionIndex(Ma),Fa=Cn.getCharCode(Ma),Ia=0,di=null,ni=null,zi=null,to=Ls,Bi=!(tt===$l.horizontal||!gt&&!Vr(Fa)||gt&&(Sf[Fa]||un(Fa)));if(ka.imageName){var zo=$[ka.imageName];if(!zo)continue;zi=ka.imageName,D.iconsInText=D.iconsInText||!0,ni=zo.paddedRect;var Go=zo.displaySize;ka.scale=ka.scale*Ls/Nt,di={width:Go[0],height:Go[1],left:zl,top:-Dd,advance:Bi?Go[1]:Go[0]};var ms=Ls-Go[1]*ka.scale;Ia=Wn+ms,to=di.advance;var rs=Bi?Go[0]*ka.scale-Ls*zn:Go[1]*ka.scale-Ls*zn;rs>0&&rs>za&&(za=rs)}else{var Ni=U[ka.fontStack],Li=Ni&&Ni[Fa];if(Li&&Li.rect)ni=Li.rect,di=Li.metrics;else{var lo=L[ka.fontStack],ho=lo&&lo[Fa];if(!ho)continue;di=ho.metrics}Ia=(zn-ka.scale)*Ls}Bi?(D.verticalizable=!0,ia.push({glyph:Fa,imageName:zi,x:nr,y:qt+Ia,vertical:Bi,scale:ka.scale,fontStack:ka.fontStack,sectionIndex:ii,metrics:di,rect:ni}),nr+=to*ka.scale+pt):(ia.push({glyph:Fa,imageName:zi,x:nr,y:qt+Ia,vertical:Bi,scale:ka.scale,fontStack:ka.fontStack,sectionIndex:ii,metrics:di,rect:ni}),nr+=di.advance*ka.scale+pt)}if(ia.length!==0){var Ks=nr-pt;yr=Math.max(Ks,yr),d1(ia,0,ia.length-1,ln,za)}nr=0;var Qs=we*zn+za;la.lineOffset=Math.max(za,Wn),qt+=Qs,Nr=Math.max(Qs,Nr),++en}var xs=qt-kh,il=dp(Me),ol=il.horizontalAlign,fs=il.verticalAlign;g1(D.positionedLines,ln,ol,fs,yr,Nr,we,xs,ve.length),D.top+=-fs*xs,D.bottom=D.top+xs,D.left+=-ol*yr,D.right=D.left+yr}function d1(D,L,U,$,ve){if(!(!$&&!ve))for(var we=D[U],Me=we.metrics.advance*we.scale,Oe=(D[U].x+Me)*$,tt=L;tt<=U;tt++)D[tt].x-=Oe,D[tt].y+=ve}function g1(D,L,U,$,ve,we,Me,Oe,tt){var pt=(L-U)*ve,gt=0;we!==Me?gt=-Oe*$-kh:gt=(-$*tt+.5)*Me;for(var Nt=0,nr=D;Nt<nr.length;Nt+=1)for(var qt=nr[Nt],yr=0,Nr=qt.positionedGlyphs;yr<Nr.length;yr+=1){var ln=Nr[yr];ln.x+=pt,ln.y+=gt}}function y1(D,L,U){var $=dp(U),ve=$.horizontalAlign,we=$.verticalAlign,Me=L[0],Oe=L[1],tt=Me-D.displaySize[0]*ve,pt=tt+D.displaySize[0],gt=Oe-D.displaySize[1]*we,Nt=gt+D.displaySize[1];return{image:D,top:gt,bottom:Nt,left:tt,right:pt}}function Nd(D,L,U,$,ve,we){var Me=D.image,Oe;if(Me.content){var tt=Me.content,pt=Me.pixelRatio||1;Oe=[tt[0]/pt,tt[1]/pt,Me.displaySize[0]-tt[2]/pt,Me.displaySize[1]-tt[3]/pt]}var gt=L.left*we,Nt=L.right*we,nr,qt,yr,Nr;U==="width"||U==="both"?(Nr=ve[0]+gt-$[3],qt=ve[0]+Nt+$[1]):(Nr=ve[0]+(gt+Nt-Me.displaySize[0])/2,qt=Nr+Me.displaySize[0]);var ln=L.top*we,en=L.bottom*we;return U==="height"||U==="both"?(nr=ve[1]+ln-$[0],yr=ve[1]+en+$[2]):(nr=ve[1]+(ln+en-Me.displaySize[1])/2,yr=nr+Me.displaySize[1]),{image:Me,top:nr,right:qt,bottom:yr,left:Nr,collisionPadding:Oe}}var Oc=function(D){function L(U,$,ve,we){D.call(this,U,$),this.angle=ve,we!==void 0&&(this.segment=we)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.clone=function(){return new L(this.x,this.y,this.angle,this.segment)},L}(f);Ue("Anchor",Oc);var ef=128;function gp(D,L){var U=L.expression;if(U.kind==="constant"){var $=U.evaluate(new ci(D+1));return{kind:"constant",layoutSize:$}}else{if(U.kind==="source")return{kind:"source"};for(var ve=U.zoomStops,we=U.interpolationType,Me=0;Me<ve.length&&ve[Me]<=D;)Me++;Me=Math.max(0,Me-1);for(var Oe=Me;Oe<ve.length&&ve[Oe]<D+1;)Oe++;Oe=Math.min(ve.length-1,Oe);var tt=ve[Me],pt=ve[Oe];if(U.kind==="composite")return{kind:"composite",minZoom:tt,maxZoom:pt,interpolationType:we};var gt=U.evaluate(new ci(tt)),Nt=U.evaluate(new ci(pt));return{kind:"camera",minZoom:tt,maxZoom:pt,minSize:gt,maxSize:Nt,interpolationType:we}}}function Od(D,L,U){var $=L.uSize,ve=L.uSizeT,we=U.lowerSize,Me=U.upperSize;return D.kind==="source"?we/ef:D.kind==="composite"?mo(we/ef,Me/ef,ve):$}function Ud(D,L){var U=0,$=0;if(D.kind==="constant")$=D.layoutSize;else if(D.kind!=="source"){var ve=D.interpolationType,we=D.minZoom,Me=D.maxZoom,Oe=ve?v(xo.interpolationFactor(ve,L,we,Me),0,1):0;D.kind==="camera"?$=mo(D.minSize,D.maxSize,Oe):U=Oe}return{uSizeT:U,uSize:$}}var m1=Object.freeze({__proto__:null,getSizeData:gp,evaluateSizeForFeature:Od,evaluateSizeForZoom:Ud,SIZE_PACK_FACTOR:ef});function Vd(D,L,U,$,ve){if(L.segment===void 0)return!0;for(var we=L,Me=L.segment+1,Oe=0;Oe>-U/2;){if(Me--,Me<0)return!1;Oe-=D[Me].dist(we),we=D[Me]}Oe+=D[Me].dist(D[Me+1]),Me++;for(var tt=[],pt=0;Oe<U/2;){var gt=D[Me-1],Nt=D[Me],nr=D[Me+1];if(!nr)return!1;var qt=gt.angleTo(Nt)-Nt.angleTo(nr);for(qt=Math.abs((qt+3*Math.PI)%(Math.PI*2)-Math.PI),tt.push({distance:Oe,angleDelta:qt}),pt+=qt;Oe-tt[0].distance>$;)pt-=tt.shift().angleDelta;if(pt>ve)return!1;Me++,Oe+=Nt.dist(nr)}return!0}function Hd(D){for(var L=0,U=0;U<D.length-1;U++)L+=D[U].dist(D[U+1]);return L}function Gd(D,L,U){return D?3/5*L*U:0}function Yd(D,L){return Math.max(D?D.right-D.left:0,L?L.right-L.left:0)}function x1(D,L,U,$,ve,we){for(var Me=Gd(U,ve,we),Oe=Yd(U,$)*we,tt=0,pt=Hd(D)/2,gt=0;gt<D.length-1;gt++){var Nt=D[gt],nr=D[gt+1],qt=Nt.dist(nr);if(tt+qt>pt){var yr=(pt-tt)/qt,Nr=mo(Nt.x,nr.x,yr),ln=mo(Nt.y,nr.y,yr),en=new Oc(Nr,ln,nr.angleTo(Nt),gt);return en._round(),!Me||Vd(D,en,Oe,Me,L)?en:void 0}tt+=qt}}function b1(D,L,U,$,ve,we,Me,Oe,tt){var pt=Gd($,we,Me),gt=Yd($,ve),Nt=gt*Me,nr=D[0].x===0||D[0].x===tt||D[0].y===0||D[0].y===tt;L-Nt<L/4&&(L=Nt+L/4);var qt=we*2,yr=nr?L/2*Oe%L:(gt/2+qt)*Me*Oe%L;return Wd(D,yr,L,pt,U,Nt,nr,!1,tt)}function Wd(D,L,U,$,ve,we,Me,Oe,tt){for(var pt=we/2,gt=Hd(D),Nt=0,nr=L-U,qt=[],yr=0;yr<D.length-1;yr++){for(var Nr=D[yr],ln=D[yr+1],en=Nr.dist(ln),kn=ln.angleTo(Nr);nr+U<Nt+en;){nr+=U;var bn=(nr-Nt)/en,Cn=mo(Nr.x,ln.x,bn),zn=mo(Nr.y,ln.y,bn);if(Cn>=0&&Cn<tt&&zn>=0&&zn<tt&&nr-pt>=0&&nr+pt<=gt){var Wn=new Oc(Cn,zn,kn,yr);Wn._round(),(!$||Vd(D,Wn,we,$,ve))&&qt.push(Wn)}}Nt+=en}return!Oe&&!qt.length&&!Me&&(qt=Wd(D,Nt/2,U,$,ve,we,Me,!0,tt)),qt}function Xd(D,L,U,$,ve){for(var we=[],Me=0;Me<D.length;Me++)for(var Oe=D[Me],tt=void 0,pt=0;pt<Oe.length-1;pt++){var gt=Oe[pt],Nt=Oe[pt+1];gt.x<L&&Nt.x<L||(gt.x<L?gt=new f(L,gt.y+(Nt.y-gt.y)*((L-gt.x)/(Nt.x-gt.x)))._round():Nt.x<L&&(Nt=new f(L,gt.y+(Nt.y-gt.y)*((L-gt.x)/(Nt.x-gt.x)))._round()),!(gt.y<U&&Nt.y<U)&&(gt.y<U?gt=new f(gt.x+(Nt.x-gt.x)*((U-gt.y)/(Nt.y-gt.y)),U)._round():Nt.y<U&&(Nt=new f(gt.x+(Nt.x-gt.x)*((U-gt.y)/(Nt.y-gt.y)),U)._round()),!(gt.x>=$&&Nt.x>=$)&&(gt.x>=$?gt=new f($,gt.y+(Nt.y-gt.y)*(($-gt.x)/(Nt.x-gt.x)))._round():Nt.x>=$&&(Nt=new f($,gt.y+(Nt.y-gt.y)*(($-gt.x)/(Nt.x-gt.x)))._round()),!(gt.y>=ve&&Nt.y>=ve)&&(gt.y>=ve?gt=new f(gt.x+(Nt.x-gt.x)*((ve-gt.y)/(Nt.y-gt.y)),ve)._round():Nt.y>=ve&&(Nt=new f(gt.x+(Nt.x-gt.x)*((ve-gt.y)/(Nt.y-gt.y)),ve)._round()),(!tt||!gt.equals(tt[tt.length-1]))&&(tt=[gt],we.push(tt)),tt.push(Nt)))))}return we}var Uc=zl;function Zd(D,L,U,$){var ve=[],we=D.image,Me=we.pixelRatio,Oe=we.paddedRect.w-2*Uc,tt=we.paddedRect.h-2*Uc,pt=D.right-D.left,gt=D.bottom-D.top,Nt=we.stretchX||[[0,Oe]],nr=we.stretchY||[[0,tt]],qt=function(Ni,Li){return Ni+Li[1]-Li[0]},yr=Nt.reduce(qt,0),Nr=nr.reduce(qt,0),ln=Oe-yr,en=tt-Nr,kn=0,bn=yr,Cn=0,zn=Nr,Wn=0,la=ln,ia=0,za=en;if(we.content&&$){var Ma=we.content;kn=iv(Nt,0,Ma[0]),Cn=iv(nr,0,Ma[1]),bn=iv(Nt,Ma[0],Ma[2]),zn=iv(nr,Ma[1],Ma[3]),Wn=Ma[0]-kn,ia=Ma[1]-Cn,la=Ma[2]-Ma[0]-bn,za=Ma[3]-Ma[1]-zn}var ka=function(Ni,Li,lo,ho){var zo=ov(Ni.stretch-kn,bn,pt,D.left),Go=sv(Ni.fixed-Wn,la,Ni.stretch,yr),ms=ov(Li.stretch-Cn,zn,gt,D.top),rs=sv(Li.fixed-ia,za,Li.stretch,Nr),Ks=ov(lo.stretch-kn,bn,pt,D.left),Qs=sv(lo.fixed-Wn,la,lo.stretch,yr),xs=ov(ho.stretch-Cn,zn,gt,D.top),il=sv(ho.fixed-ia,za,ho.stretch,Nr),ol=new f(zo,ms),fs=new f(Ks,ms),sl=new f(Ks,xs),ql=new f(zo,xs),If=new f(Go/Me,rs/Me),$f=new f(Qs/Me,il/Me),qf=L*Math.PI/180;if(qf){var ec=Math.sin(qf),jc=Math.cos(qf),Lu=[jc,-ec,ec,jc];ol._matMult(Lu),fs._matMult(Lu),ql._matMult(Lu),sl._matMult(Lu)}var vv=Ni.stretch+Ni.fixed,Ap=lo.stretch+lo.fixed,pv=Li.stretch+Li.fixed,Mp=ho.stretch+ho.fixed,gu={x:we.paddedRect.x+Uc+vv,y:we.paddedRect.y+Uc+pv,w:Ap-vv,h:Mp-pv},Jc=la/Me/pt,dv=za/Me/gt;return{tl:ol,tr:fs,bl:ql,br:sl,tex:gu,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:If,pixelOffsetBR:$f,minFontScaleX:Jc,minFontScaleY:dv,isSDF:U}};if(!$||!we.stretchX&&!we.stretchY)ve.push(ka({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Oe+1},{fixed:0,stretch:tt+1}));else for(var ii=jd(Nt,ln,yr),Fa=jd(nr,en,Nr),Ia=0;Ia<ii.length-1;Ia++)for(var di=ii[Ia],ni=ii[Ia+1],zi=0;zi<Fa.length-1;zi++){var to=Fa[zi],Bi=Fa[zi+1];ve.push(ka(di,to,ni,Bi))}return ve}function iv(D,L,U){for(var $=0,ve=0,we=D;ve<we.length;ve+=1){var Me=we[ve];$+=Math.max(L,Math.min(U,Me[1]))-Math.max(L,Math.min(U,Me[0]))}return $}function jd(D,L,U){for(var $=[{fixed:-Uc,stretch:0}],ve=0,we=D;ve<we.length;ve+=1){var Me=we[ve],Oe=Me[0],tt=Me[1],pt=$[$.length-1];$.push({fixed:Oe-pt.stretch,stretch:pt.stretch}),$.push({fixed:Oe-pt.stretch,stretch:pt.stretch+(tt-Oe)})}return $.push({fixed:L+Uc,stretch:U}),$}function ov(D,L,U,$){return D/L*U+$}function sv(D,L,U,$){return D-L*U/$}function _1(D,L,U,$,ve,we,Me,Oe){for(var tt=$.layout.get("text-rotate").evaluate(we,{})*Math.PI/180,pt=[],gt=0,Nt=L.positionedLines;gt<Nt.length;gt+=1)for(var nr=Nt[gt],qt=0,yr=nr.positionedGlyphs;qt<yr.length;qt+=1){var Nr=yr[qt];if(!!Nr.rect){var ln=Nr.rect||{},en=1,kn=Dd+en,bn=!0,Cn=1,zn=0,Wn=(ve||Oe)&&Nr.vertical,la=Nr.metrics.advance*Nr.scale/2;if(Oe&&L.verticalizable){var ia=(Nr.scale-1)*Ls,za=(Ls-Nr.metrics.width*Nr.scale)/2;zn=nr.lineOffset/2-(Nr.imageName?-za:ia)}if(Nr.imageName){var Ma=Me[Nr.imageName];bn=Ma.sdf,Cn=Ma.pixelRatio,kn=zl/Cn}var ka=ve?[Nr.x+la,Nr.y]:[0,0],ii=ve?[0,0]:[Nr.x+la+U[0],Nr.y+U[1]-zn],Fa=[0,0];Wn&&(Fa=ii,ii=[0,0]);var Ia=(Nr.metrics.left-kn)*Nr.scale-la+ii[0],di=(-Nr.metrics.top-kn)*Nr.scale+ii[1],ni=Ia+ln.w*Nr.scale/Cn,zi=di+ln.h*Nr.scale/Cn,to=new f(Ia,di),Bi=new f(ni,di),Ni=new f(Ia,zi),Li=new f(ni,zi);if(Wn){var lo=new f(-la,la-kh),ho=-Math.PI/2,zo=Ls/2-la,Go=Nr.imageName?zo:0,ms=new f(5-kh-zo,-Go),rs=new(Function.prototype.bind.apply(f,[null].concat(Fa)));to._rotateAround(ho,lo)._add(ms)._add(rs),Bi._rotateAround(ho,lo)._add(ms)._add(rs),Ni._rotateAround(ho,lo)._add(ms)._add(rs),Li._rotateAround(ho,lo)._add(ms)._add(rs)}if(tt){var Ks=Math.sin(tt),Qs=Math.cos(tt),xs=[Qs,-Ks,Ks,Qs];to._matMult(xs),Bi._matMult(xs),Ni._matMult(xs),Li._matMult(xs)}var il=new f(0,0),ol=new f(0,0),fs=0,sl=0;pt.push({tl:to,tr:Bi,bl:Ni,br:Li,tex:ln,writingMode:L.writingMode,glyphOffset:ka,sectionIndex:Nr.sectionIndex,isSDF:bn,pixelOffsetTL:il,pixelOffsetBR:ol,minFontScaleX:fs,minFontScaleY:sl})}}return pt}var lv=function(L,U,$,ve,we,Me,Oe,tt,pt,gt){if(this.boxStartIndex=L.length,pt){var Nt=Me.top,nr=Me.bottom,qt=Me.collisionPadding;qt&&(Nt-=qt[1],nr+=qt[3]);var yr=nr-Nt;yr>0&&(yr=Math.max(10,yr),this.circleDiameter=yr)}else{var Nr=Me.top*Oe-tt,ln=Me.bottom*Oe+tt,en=Me.left*Oe-tt,kn=Me.right*Oe+tt,bn=Me.collisionPadding;if(bn&&(en-=bn[0]*Oe,Nr-=bn[1]*Oe,kn+=bn[2]*Oe,ln+=bn[3]*Oe),gt){var Cn=new f(en,Nr),zn=new f(kn,Nr),Wn=new f(en,ln),la=new f(kn,ln),ia=gt*Math.PI/180;Cn._rotate(ia),zn._rotate(ia),Wn._rotate(ia),la._rotate(ia),en=Math.min(Cn.x,zn.x,Wn.x,la.x),kn=Math.max(Cn.x,zn.x,Wn.x,la.x),Nr=Math.min(Cn.y,zn.y,Wn.y,la.y),ln=Math.max(Cn.y,zn.y,Wn.y,la.y)}L.emplaceBack(U.x,U.y,en,Nr,kn,ln,$,ve,we)}this.boxEndIndex=L.length},Vc=function(L,U){if(L===void 0&&(L=[]),U===void 0&&(U=w1),this.data=L,this.length=this.data.length,this.compare=U,this.length>0)for(var $=(this.length>>1)-1;$>=0;$--)this._down($)};Vc.prototype.push=function(L){this.data.push(L),this.length++,this._up(this.length-1)},Vc.prototype.pop=function(){if(this.length!==0){var L=this.data[0],U=this.data.pop();return this.length--,this.length>0&&(this.data[0]=U,this._down(0)),L}},Vc.prototype.peek=function(){return this.data[0]},Vc.prototype._up=function(L){for(var U=this,$=U.data,ve=U.compare,we=$[L];L>0;){var Me=L-1>>1,Oe=$[Me];if(ve(we,Oe)>=0)break;$[L]=Oe,L=Me}$[L]=we},Vc.prototype._down=function(L){for(var U=this,$=U.data,ve=U.compare,we=this.length>>1,Me=$[L];L<we;){var Oe=(L<<1)+1,tt=$[Oe],pt=Oe+1;if(pt<this.length&&ve($[pt],tt)<0&&(Oe=pt,tt=$[pt]),ve(tt,Me)>=0)break;$[L]=tt,L=Oe}$[L]=Me};function w1(D,L){return D<L?-1:D>L?1:0}function T1(D,L,U){L===void 0&&(L=1),U===void 0&&(U=!1);for(var $=1/0,ve=1/0,we=-1/0,Me=-1/0,Oe=D[0],tt=0;tt<Oe.length;tt++){var pt=Oe[tt];(!tt||pt.x<$)&&($=pt.x),(!tt||pt.y<ve)&&(ve=pt.y),(!tt||pt.x>we)&&(we=pt.x),(!tt||pt.y>Me)&&(Me=pt.y)}var gt=we-$,Nt=Me-ve,nr=Math.min(gt,Nt),qt=nr/2,yr=new Vc([],A1);if(nr===0)return new f($,ve);for(var Nr=$;Nr<we;Nr+=nr)for(var ln=ve;ln<Me;ln+=nr)yr.push(new Hc(Nr+qt,ln+qt,qt,D));for(var en=S1(D),kn=yr.length;yr.length;){var bn=yr.pop();(bn.d>en.d||!en.d)&&(en=bn,U&&console.log("found best %d after %d probes",Math.round(1e4*bn.d)/1e4,kn)),!(bn.max-en.d<=L)&&(qt=bn.h/2,yr.push(new Hc(bn.p.x-qt,bn.p.y-qt,qt,D)),yr.push(new Hc(bn.p.x+qt,bn.p.y-qt,qt,D)),yr.push(new Hc(bn.p.x-qt,bn.p.y+qt,qt,D)),yr.push(new Hc(bn.p.x+qt,bn.p.y+qt,qt,D)),kn+=4)}return U&&(console.log("num probes: "+kn),console.log("best distance: "+en.d)),en.p}function A1(D,L){return L.max-D.max}function Hc(D,L,U,$){this.p=new f(D,L),this.h=U,this.d=M1(this.p,$),this.max=this.d+this.h*Math.SQRT2}function M1(D,L){for(var U=!1,$=1/0,ve=0;ve<L.length;ve++)for(var we=L[ve],Me=0,Oe=we.length,tt=Oe-1;Me<Oe;tt=Me++){var pt=we[Me],gt=we[tt];pt.y>D.y!=gt.y>D.y&&D.x<(gt.x-pt.x)*(D.y-pt.y)/(gt.y-pt.y)+pt.x&&(U=!U),$=Math.min($,Qu(D,pt,gt))}return(U?1:-1)*Math.sqrt($)}function S1(D){for(var L=0,U=0,$=0,ve=D[0],we=0,Me=ve.length,Oe=Me-1;we<Me;Oe=we++){var tt=ve[we],pt=ve[Oe],gt=tt.x*pt.y-pt.x*tt.y;U+=(tt.x+pt.x)*gt,$+=(tt.y+pt.y)*gt,L+=gt*3}return new Hc(U/L,$/L,0,D)}var Gc=7,yp=Number.POSITIVE_INFINITY;function Jd(D,L){function U(ve,we){var Me=0,Oe=0;we<0&&(we=0);var tt=we/Math.sqrt(2);switch(ve){case"top-right":case"top-left":Oe=tt-Gc;break;case"bottom-right":case"bottom-left":Oe=-tt+Gc;break;case"bottom":Oe=-we+Gc;break;case"top":Oe=we-Gc;break}switch(ve){case"top-right":case"bottom-right":Me=-tt;break;case"top-left":case"bottom-left":Me=tt;break;case"left":Me=we;break;case"right":Me=-we;break}return[Me,Oe]}function $(ve,we,Me){var Oe=0,tt=0;switch(we=Math.abs(we),Me=Math.abs(Me),ve){case"top-right":case"top-left":case"top":tt=Me-Gc;break;case"bottom-right":case"bottom-left":case"bottom":tt=-Me+Gc;break}switch(ve){case"top-right":case"bottom-right":case"right":Oe=-we;break;case"top-left":case"bottom-left":case"left":Oe=we;break}return[Oe,tt]}return L[1]!==yp?$(D,L[0],L[1]):U(D,L[0])}function E1(D,L,U,$,ve,we,Me){D.createArrays();var Oe=512*D.overscaling;D.tilePixelRatio=Va/Oe,D.compareText={},D.iconsNeedLinear=!1;var tt=D.layers[0].layout,pt=D.layers[0]._unevaluatedLayout._values,gt={};if(D.textSizeData.kind==="composite"){var Nt=D.textSizeData,nr=Nt.minZoom,qt=Nt.maxZoom;gt.compositeTextSizes=[pt["text-size"].possiblyEvaluate(new ci(nr),Me),pt["text-size"].possiblyEvaluate(new ci(qt),Me)]}if(D.iconSizeData.kind==="composite"){var yr=D.iconSizeData,Nr=yr.minZoom,ln=yr.maxZoom;gt.compositeIconSizes=[pt["icon-size"].possiblyEvaluate(new ci(Nr),Me),pt["icon-size"].possiblyEvaluate(new ci(ln),Me)]}gt.layoutTextSize=pt["text-size"].possiblyEvaluate(new ci(D.zoom+1),Me),gt.layoutIconSize=pt["icon-size"].possiblyEvaluate(new ci(D.zoom+1),Me),gt.textMaxSize=pt["text-size"].possiblyEvaluate(new ci(18));for(var en=tt.get("text-line-height")*Ls,kn=tt.get("text-rotation-alignment")==="map"&&tt.get("symbol-placement")!=="point",bn=tt.get("text-keep-upright"),Cn=tt.get("text-size"),zn=function(){var ia=la[Wn],za=tt.get("text-font").evaluate(ia,{},Me).join(","),Ma=Cn.evaluate(ia,{},Me),ka=gt.layoutTextSize.evaluate(ia,{},Me),ii=gt.layoutIconSize.evaluate(ia,{},Me),Fa={horizontal:{},vertical:void 0},Ia=ia.text,di=[0,0];if(Ia){var ni=Ia.toString(),zi=tt.get("text-letter-spacing").evaluate(ia,{},Me)*Ls,to=qr(ni)?zi:0,Bi=tt.get("text-anchor").evaluate(ia,{},Me),Ni=tt.get("text-variable-anchor");if(!Ni){var Li=tt.get("text-radial-offset").evaluate(ia,{},Me);Li?di=Jd(Bi,[Li*Ls,yp]):di=tt.get("text-offset").evaluate(ia,{},Me).map(function(If){return If*Ls})}var lo=kn?"center":tt.get("text-justify").evaluate(ia,{},Me),ho=tt.get("symbol-placement"),zo=ho==="point"?tt.get("text-max-width").evaluate(ia,{},Me)*Ls:0,Go=function(){D.allowVerticalPlacement&&Er(ni)&&(Fa.vertical=av(Ia,L,U,ve,za,zo,en,Bi,"left",to,di,$l.vertical,!0,ho,ka,Ma))};if(!kn&&Ni){for(var ms=lo==="auto"?Ni.map(function(If){return mp(If)}):[lo],rs=!1,Ks=0;Ks<ms.length;Ks++){var Qs=ms[Ks];if(!Fa.horizontal[Qs])if(rs)Fa.horizontal[Qs]=Fa.horizontal[0];else{var xs=av(Ia,L,U,ve,za,zo,en,"center",Qs,to,di,$l.horizontal,!1,ho,ka,Ma);xs&&(Fa.horizontal[Qs]=xs,rs=xs.positionedLines.length===1)}}Go()}else{lo==="auto"&&(lo=mp(Bi));var il=av(Ia,L,U,ve,za,zo,en,Bi,lo,to,di,$l.horizontal,!1,ho,ka,Ma);il&&(Fa.horizontal[lo]=il),Go(),Er(ni)&&kn&&bn&&(Fa.vertical=av(Ia,L,U,ve,za,zo,en,Bi,lo,to,di,$l.vertical,!1,ho,ka,Ma))}}var ol=void 0,fs=!1;if(ia.icon&&ia.icon.name){var sl=$[ia.icon.name];sl&&(ol=y1(ve[ia.icon.name],tt.get("icon-offset").evaluate(ia,{},Me),tt.get("icon-anchor").evaluate(ia,{},Me)),fs=sl.sdf,D.sdfIcons===void 0?D.sdfIcons=sl.sdf:D.sdfIcons!==sl.sdf&&O("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(sl.pixelRatio!==D.pixelRatio||tt.get("icon-rotate").constantOr(1)!==0)&&(D.iconsNeedLinear=!0))}var ql=Qd(Fa.horizontal)||Fa.vertical;D.iconsInText=ql?ql.iconsInText:!1,(ql||ol)&&C1(D,ia,Fa,ol,$,gt,ka,ii,di,fs,Me)},Wn=0,la=D.features;Wn<la.length;Wn+=1)zn();we&&D.generateCollisionDebugBuffers()}function mp(D){switch(D){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function C1(D,L,U,$,ve,we,Me,Oe,tt,pt,gt){var Nt=we.textMaxSize.evaluate(L,{});Nt===void 0&&(Nt=Me);var nr=D.layers[0].layout,qt=nr.get("icon-offset").evaluate(L,{},gt),yr=Qd(U.horizontal),Nr=24,ln=Me/Nr,en=D.tilePixelRatio*ln,kn=D.tilePixelRatio*Nt/Nr,bn=D.tilePixelRatio*Oe,Cn=D.tilePixelRatio*nr.get("symbol-spacing"),zn=nr.get("text-padding")*D.tilePixelRatio,Wn=nr.get("icon-padding")*D.tilePixelRatio,la=nr.get("text-max-angle")/180*Math.PI,ia=nr.get("text-rotation-alignment")==="map"&&nr.get("symbol-placement")!=="point",za=nr.get("icon-rotation-alignment")==="map"&&nr.get("symbol-placement")!=="point",Ma=nr.get("symbol-placement"),ka=Cn/2,ii=nr.get("icon-text-fit"),Fa;$&&ii!=="none"&&(D.allowVerticalPlacement&&U.vertical&&(Fa=Nd($,U.vertical,ii,nr.get("icon-text-fit-padding"),qt,ln)),yr&&($=Nd($,yr,ii,nr.get("icon-text-fit-padding"),qt,ln)));var Ia=function(jc,Lu){Lu.x<0||Lu.x>=Va||Lu.y<0||Lu.y>=Va||k1(D,Lu,jc,U,$,ve,Fa,D.layers[0],D.collisionBoxArray,L.index,L.sourceLayerIndex,D.index,en,zn,ia,tt,bn,Wn,za,qt,L,we,pt,gt,Me)};if(Ma==="line")for(var di=0,ni=Xd(L.geometry,0,0,Va,Va);di<ni.length;di+=1)for(var zi=ni[di],to=b1(zi,Cn,la,U.vertical||yr,$,Nr,kn,D.overscaling,Va),Bi=0,Ni=to;Bi<Ni.length;Bi+=1){var Li=Ni[Bi],lo=yr;(!lo||!D1(D,lo.text,ka,Li))&&Ia(zi,Li)}else if(Ma==="line-center")for(var ho=0,zo=L.geometry;ho<zo.length;ho+=1){var Go=zo[ho];if(Go.length>1){var ms=x1(Go,la,U.vertical||yr,$,Nr,kn);ms&&Ia(Go,ms)}}else if(L.type==="Polygon")for(var rs=0,Ks=sp(L.geometry,0);rs<Ks.length;rs+=1){var Qs=Ks[rs],xs=T1(Qs,16);Ia(Qs[0],new Oc(xs.x,xs.y,0))}else if(L.type==="LineString")for(var il=0,ol=L.geometry;il<ol.length;il+=1){var fs=ol[il];Ia(fs,new Oc(fs[0].x,fs[0].y,0))}else if(L.type==="Point")for(var sl=0,ql=L.geometry;sl<ql.length;sl+=1)for(var If=ql[sl],$f=0,qf=If;$f<qf.length;$f+=1){var ec=qf[$f];Ia([ec],new Oc(ec.x,ec.y,0))}}var Dh=255,Kf=Dh*ef;function Kd(D,L,U,$,ve,we,Me,Oe,tt,pt,gt,Nt,nr,qt,yr){var Nr=_1(L,U,Oe,ve,we,Me,$,D.allowVerticalPlacement),ln=D.textSizeData,en=null;ln.kind==="source"?(en=[ef*ve.layout.get("text-size").evaluate(Me,{})],en[0]>Kf&&O(D.layerIds[0]+': Value for "text-size" is >= '+Dh+'. Reduce your "text-size".')):ln.kind==="composite"&&(en=[ef*qt.compositeTextSizes[0].evaluate(Me,{},yr),ef*qt.compositeTextSizes[1].evaluate(Me,{},yr)],(en[0]>Kf||en[1]>Kf)&&O(D.layerIds[0]+': Value for "text-size" is >= '+Dh+'. Reduce your "text-size".')),D.addSymbols(D.text,Nr,en,Oe,we,Me,pt,L,tt.lineStartIndex,tt.lineLength,nr,yr);for(var kn=0,bn=gt;kn<bn.length;kn+=1){var Cn=bn[kn];Nt[Cn]=D.text.placedSymbolArray.length-1}return Nr.length*4}function Qd(D){for(var L in D)return D[L];return null}function k1(D,L,U,$,ve,we,Me,Oe,tt,pt,gt,Nt,nr,qt,yr,Nr,ln,en,kn,bn,Cn,zn,Wn,la,ia){var za,Ma=D.addToLineVertexArray(L,U),ka,ii,Fa,Ia,di=0,ni=0,zi=0,to=0,Bi=-1,Ni=-1,Li={},lo=ze(""),ho=0,zo=0;if(Oe._unevaluatedLayout.getValue("text-radial-offset")===void 0?(za=Oe.layout.get("text-offset").evaluate(Cn,{},la).map(function(Fh){return Fh*Ls}),ho=za[0],zo=za[1]):(ho=Oe.layout.get("text-radial-offset").evaluate(Cn,{},la)*Ls,zo=yp),D.allowVerticalPlacement&&$.vertical){var Go=Oe.layout.get("text-rotate").evaluate(Cn,{},la),ms=Go+90,rs=$.vertical;Fa=new lv(tt,L,pt,gt,Nt,rs,nr,qt,yr,ms),Me&&(Ia=new lv(tt,L,pt,gt,Nt,Me,ln,en,yr,ms))}if(ve){var Ks=Oe.layout.get("icon-rotate").evaluate(Cn,{}),Qs=Oe.layout.get("icon-text-fit")!=="none",xs=Zd(ve,Ks,Wn,Qs),il=Me?Zd(Me,Ks,Wn,Qs):void 0;ii=new lv(tt,L,pt,gt,Nt,ve,ln,en,!1,Ks),di=xs.length*4;var ol=D.iconSizeData,fs=null;ol.kind==="source"?(fs=[ef*Oe.layout.get("icon-size").evaluate(Cn,{})],fs[0]>Kf&&O(D.layerIds[0]+': Value for "icon-size" is >= '+Dh+'. Reduce your "icon-size".')):ol.kind==="composite"&&(fs=[ef*zn.compositeIconSizes[0].evaluate(Cn,{},la),ef*zn.compositeIconSizes[1].evaluate(Cn,{},la)],(fs[0]>Kf||fs[1]>Kf)&&O(D.layerIds[0]+': Value for "icon-size" is >= '+Dh+'. Reduce your "icon-size".')),D.addSymbols(D.icon,xs,fs,bn,kn,Cn,!1,L,Ma.lineStartIndex,Ma.lineLength,-1,la),Bi=D.icon.placedSymbolArray.length-1,il&&(ni=il.length*4,D.addSymbols(D.icon,il,fs,bn,kn,Cn,$l.vertical,L,Ma.lineStartIndex,Ma.lineLength,-1,la),Ni=D.icon.placedSymbolArray.length-1)}for(var sl in $.horizontal){var ql=$.horizontal[sl];if(!ka){lo=ze(ql.text);var If=Oe.layout.get("text-rotate").evaluate(Cn,{},la);ka=new lv(tt,L,pt,gt,Nt,ql,nr,qt,yr,If)}var $f=ql.positionedLines.length===1;if(zi+=Kd(D,L,ql,we,Oe,yr,Cn,Nr,Ma,$.vertical?$l.horizontal:$l.horizontalOnly,$f?Object.keys($.horizontal):[sl],Li,Bi,zn,la),$f)break}$.vertical&&(to+=Kd(D,L,$.vertical,we,Oe,yr,Cn,Nr,Ma,$l.vertical,["vertical"],Li,Ni,zn,la));var qf=ka?ka.boxStartIndex:D.collisionBoxArray.length,ec=ka?ka.boxEndIndex:D.collisionBoxArray.length,jc=Fa?Fa.boxStartIndex:D.collisionBoxArray.length,Lu=Fa?Fa.boxEndIndex:D.collisionBoxArray.length,vv=ii?ii.boxStartIndex:D.collisionBoxArray.length,Ap=ii?ii.boxEndIndex:D.collisionBoxArray.length,pv=Ia?Ia.boxStartIndex:D.collisionBoxArray.length,Mp=Ia?Ia.boxEndIndex:D.collisionBoxArray.length,gu=-1,Jc=function(Fh,v0){return Fh&&Fh.circleDiameter?Math.max(Fh.circleDiameter,v0):v0};gu=Jc(ka,gu),gu=Jc(Fa,gu),gu=Jc(ii,gu),gu=Jc(Ia,gu);var dv=gu>-1?1:0;dv&&(gu*=ia/Ls),D.glyphOffsetArray.length>=eo.MAX_GLYPHS&&O("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Cn.sortKey!==void 0&&D.addToSortKeyRanges(D.symbolInstances.length,Cn.sortKey),D.symbolInstances.emplaceBack(L.x,L.y,Li.right>=0?Li.right:-1,Li.center>=0?Li.center:-1,Li.left>=0?Li.left:-1,Li.vertical||-1,Bi,Ni,lo,qf,ec,jc,Lu,vv,Ap,pv,Mp,pt,zi,to,di,ni,dv,0,nr,ho,zo,gu)}function D1(D,L,U,$){var ve=D.compareText;if(!(L in ve))ve[L]=[];else for(var we=ve[L],Me=we.length-1;Me>=0;Me--)if($.dist(we[Me])<U)return!0;return ve[L].push($),!1}var L1=Ic.VectorTileFeature.types,P1=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function uv(D,L,U,$,ve,we,Me,Oe,tt,pt,gt,Nt,nr){var qt=Oe?Math.min(Kf,Math.round(Oe[0])):0,yr=Oe?Math.min(Kf,Math.round(Oe[1])):0;D.emplaceBack(L,U,Math.round($*32),Math.round(ve*32),we,Me,(qt<<1)+(tt?1:0),yr,pt*16,gt*16,Nt*256,nr*256)}function xp(D,L,U){D.emplaceBack(L.x,L.y,U),D.emplaceBack(L.x,L.y,U),D.emplaceBack(L.x,L.y,U),D.emplaceBack(L.x,L.y,U)}function F1(D){for(var L=0,U=D.sections;L<U.length;L+=1){var $=U[L];if(aa($.text))return!0}return!1}var Yc=function(L){this.layoutVertexArray=new _f,this.indexArray=new Ku,this.programConfigurations=L,this.segments=new W,this.dynamicLayoutVertexArray=new hh,this.opacityVertexArray=new vh,this.placedSymbolArray=new Xf};Yc.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Yc.prototype.upload=function(L,U,$,ve){this.isEmpty()||($&&(this.layoutVertexBuffer=L.createVertexBuffer(this.layoutVertexArray,cp.members),this.indexBuffer=L.createIndexBuffer(this.indexArray,U),this.dynamicLayoutVertexBuffer=L.createVertexBuffer(this.dynamicLayoutVertexArray,Rm.members,!0),this.opacityVertexBuffer=L.createVertexBuffer(this.opacityVertexArray,P1,!0),this.opacityVertexBuffer.itemSize=1),($||ve)&&this.programConfigurations.upload(L))},Yc.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Ue("SymbolBuffers",Yc);var Lh=function(L,U,$){this.layoutVertexArray=new L,this.layoutAttributes=U,this.indexArray=new $,this.segments=new W,this.collisionVertexArray=new _l};Lh.prototype.upload=function(L){this.layoutVertexBuffer=L.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=L.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=L.createVertexBuffer(this.collisionVertexArray,Im.members,!0)},Lh.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Ue("CollisionBuffers",Lh);var eo=function(L){this.collisionBoxArray=L.collisionBoxArray,this.zoom=L.zoom,this.overscaling=L.overscaling,this.layers=L.layers,this.layerIds=this.layers.map(function(tt){return tt.id}),this.index=L.index,this.pixelRatio=L.pixelRatio,this.sourceLayerIndex=L.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Dc([]),this.placementViewportMatrix=Dc([]);var U=this.layers[0],$=U._unevaluatedLayout._values;this.textSizeData=gp(this.zoom,$["text-size"]),this.iconSizeData=gp(this.zoom,$["icon-size"]);var ve=this.layers[0].layout,we=ve.get("symbol-sort-key"),Me=ve.get("symbol-z-order");this.sortFeaturesByKey=Me!=="viewport-y"&&we.constantOr(1)!==void 0;var Oe=Me==="viewport-y"||Me==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=Oe&&(ve.get("text-allow-overlap")||ve.get("icon-allow-overlap")||ve.get("text-ignore-placement")||ve.get("icon-ignore-placement")),ve.get("symbol-placement")==="point"&&(this.writingModes=ve.get("text-writing-mode").map(function(tt){return $l[tt]})),this.stateDependentLayerIds=this.layers.filter(function(tt){return tt.isStateDependent()}).map(function(tt){return tt.id}),this.sourceID=L.sourceID};eo.prototype.createArrays=function(){this.text=new Yc(new si(cp.members,this.layers,this.zoom,function(L){return/^text/.test(L)})),this.icon=new Yc(new si(cp.members,this.layers,this.zoom,function(L){return/^icon/.test(L)})),this.glyphOffsetArray=new pu,this.lineVertexArray=new Wh,this.symbolInstances=new Yh},eo.prototype.calculateGlyphDependencies=function(L,U,$,ve,we){for(var Me=0;Me<L.length;Me++)if(U[L.charCodeAt(Me)]=!0,($||ve)&&we){var Oe=Sh[L.charAt(Me)];Oe&&(U[Oe.charCodeAt(0)]=!0)}},eo.prototype.populate=function(L,U,$){var ve=this.layers[0],we=ve.layout,Me=we.get("text-font"),Oe=we.get("text-field"),tt=we.get("icon-image"),pt=(Oe.value.kind!=="constant"||Oe.value.value instanceof Ki&&!Oe.value.value.isEmpty()||Oe.value.value.toString().length>0)&&(Me.value.kind!=="constant"||Me.value.value.length>0),gt=tt.value.kind!=="constant"||!!tt.value.value||Object.keys(tt.parameters).length>0,Nt=we.get("symbol-sort-key");if(this.features=[],!(!pt&&!gt)){for(var nr=U.iconDependencies,qt=U.glyphDependencies,yr=U.availableImages,Nr=new ci(this.zoom),ln=0,en=L;ln<en.length;ln+=1){var kn=en[ln],bn=kn.feature,Cn=kn.id,zn=kn.index,Wn=kn.sourceLayerIndex,la=ve._featureFilter.needGeometry,ia={type:bn.type,id:Cn,properties:bn.properties,geometry:la?Ji(bn):[]};if(!!ve._featureFilter.filter(Nr,ia,$)){la||(ia.geometry=Ji(bn));var za=void 0;if(pt){var Ma=ve.getValueAndResolveTokens("text-field",ia,$,yr),ka=Ki.factory(Ma);F1(ka)&&(this.hasRTLText=!0),(!this.hasRTLText||wo()==="unavailable"||this.hasRTLText&&Ka.isParsed())&&(za=Nm(ka,ve,ia))}var ii=void 0;if(gt){var Fa=ve.getValueAndResolveTokens("icon-image",ia,$,yr);Fa instanceof No?ii=Fa:ii=No.fromString(Fa)}if(!(!za&&!ii)){var Ia=this.sortFeaturesByKey?Nt.evaluate(ia,{},$):void 0,di={id:Cn,text:za,icon:ii,index:zn,sourceLayerIndex:Wn,geometry:Ji(bn),properties:bn.properties,type:L1[bn.type],sortKey:Ia};if(this.features.push(di),ii&&(nr[ii.name]=!0),za){var ni=Me.evaluate(ia,{},$).join(","),zi=we.get("text-rotation-alignment")==="map"&&we.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf($l.vertical)>=0;for(var to=0,Bi=za.sections;to<Bi.length;to+=1){var Ni=Bi[to];if(Ni.image)nr[Ni.image.name]=!0;else{var Li=Er(za.toString()),lo=Ni.fontStack||ni,ho=qt[lo]=qt[lo]||{};this.calculateGlyphDependencies(Ni.text,ho,zi,this.allowVerticalPlacement,Li)}}}}}}we.get("symbol-placement")==="line"&&(this.features=Om(this.features)),this.sortFeaturesByKey&&this.features.sort(function(zo,Go){return zo.sortKey-Go.sortKey})}},eo.prototype.update=function(L,U,$){!this.stateDependentLayers.length||(this.text.programConfigurations.updatePaintArrays(L,U,this.layers,$),this.icon.programConfigurations.updatePaintArrays(L,U,this.layers,$))},eo.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},eo.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},eo.prototype.upload=function(L){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(L),this.iconCollisionBox.upload(L)),this.text.upload(L,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(L,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},eo.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},eo.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},eo.prototype.addToLineVertexArray=function(L,U){var $=this.lineVertexArray.length;if(L.segment!==void 0){for(var ve=L.dist(U[L.segment+1]),we=L.dist(U[L.segment]),Me={},Oe=L.segment+1;Oe<U.length;Oe++)Me[Oe]={x:U[Oe].x,y:U[Oe].y,tileUnitDistanceFromAnchor:ve},Oe<U.length-1&&(ve+=U[Oe+1].dist(U[Oe]));for(var tt=L.segment||0;tt>=0;tt--)Me[tt]={x:U[tt].x,y:U[tt].y,tileUnitDistanceFromAnchor:we},tt>0&&(we+=U[tt-1].dist(U[tt]));for(var pt=0;pt<U.length;pt++){var gt=Me[pt];this.lineVertexArray.emplaceBack(gt.x,gt.y,gt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:$,lineLength:this.lineVertexArray.length-$}},eo.prototype.addSymbols=function(L,U,$,ve,we,Me,Oe,tt,pt,gt,Nt,nr){for(var qt=L.indexArray,yr=L.layoutVertexArray,Nr=L.segments.prepareSegment(4*U.length,yr,qt,Me.sortKey),ln=this.glyphOffsetArray.length,en=Nr.vertexLength,kn=this.allowVerticalPlacement&&Oe===$l.vertical?Math.PI/2:0,bn=Me.text&&Me.text.sections,Cn=0;Cn<U.length;Cn++){var zn=U[Cn],Wn=zn.tl,la=zn.tr,ia=zn.bl,za=zn.br,Ma=zn.tex,ka=zn.pixelOffsetTL,ii=zn.pixelOffsetBR,Fa=zn.minFontScaleX,Ia=zn.minFontScaleY,di=zn.glyphOffset,ni=zn.isSDF,zi=zn.sectionIndex,to=Nr.vertexLength,Bi=di[1];uv(yr,tt.x,tt.y,Wn.x,Bi+Wn.y,Ma.x,Ma.y,$,ni,ka.x,ka.y,Fa,Ia),uv(yr,tt.x,tt.y,la.x,Bi+la.y,Ma.x+Ma.w,Ma.y,$,ni,ii.x,ka.y,Fa,Ia),uv(yr,tt.x,tt.y,ia.x,Bi+ia.y,Ma.x,Ma.y+Ma.h,$,ni,ka.x,ii.y,Fa,Ia),uv(yr,tt.x,tt.y,za.x,Bi+za.y,Ma.x+Ma.w,Ma.y+Ma.h,$,ni,ii.x,ii.y,Fa,Ia),xp(L.dynamicLayoutVertexArray,tt,kn),qt.emplaceBack(to,to+1,to+2),qt.emplaceBack(to+1,to+2,to+3),Nr.vertexLength+=4,Nr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(di[0]),(Cn===U.length-1||zi!==U[Cn+1].sectionIndex)&&L.programConfigurations.populatePaintArrays(yr.length,Me,Me.index,{},nr,bn&&bn[zi])}L.placedSymbolArray.emplaceBack(tt.x,tt.y,ln,this.glyphOffsetArray.length-ln,en,pt,gt,tt.segment,$?$[0]:0,$?$[1]:0,ve[0],ve[1],Oe,0,!1,0,Nt)},eo.prototype._addCollisionDebugVertex=function(L,U,$,ve,we,Me){return U.emplaceBack(0,0),L.emplaceBack($.x,$.y,ve,we,Math.round(Me.x),Math.round(Me.y))},eo.prototype.addCollisionDebugVertices=function(L,U,$,ve,we,Me,Oe){var tt=we.segments.prepareSegment(4,we.layoutVertexArray,we.indexArray),pt=tt.vertexLength,gt=we.layoutVertexArray,Nt=we.collisionVertexArray,nr=Oe.anchorX,qt=Oe.anchorY;this._addCollisionDebugVertex(gt,Nt,Me,nr,qt,new f(L,U)),this._addCollisionDebugVertex(gt,Nt,Me,nr,qt,new f($,U)),this._addCollisionDebugVertex(gt,Nt,Me,nr,qt,new f($,ve)),this._addCollisionDebugVertex(gt,Nt,Me,nr,qt,new f(L,ve)),tt.vertexLength+=4;var yr=we.indexArray;yr.emplaceBack(pt,pt+1),yr.emplaceBack(pt+1,pt+2),yr.emplaceBack(pt+2,pt+3),yr.emplaceBack(pt+3,pt),tt.primitiveLength+=4},eo.prototype.addDebugCollisionBoxes=function(L,U,$,ve){for(var we=L;we<U;we++){var Me=this.collisionBoxArray.get(we),Oe=Me.x1,tt=Me.y1,pt=Me.x2,gt=Me.y2;this.addCollisionDebugVertices(Oe,tt,pt,gt,ve?this.textCollisionBox:this.iconCollisionBox,Me.anchorPoint,$)}},eo.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Lh(Mc,Md.members,hc),this.iconCollisionBox=new Lh(Mc,Md.members,hc);for(var L=0;L<this.symbolInstances.length;L++){var U=this.symbolInstances.get(L);this.addDebugCollisionBoxes(U.textBoxStartIndex,U.textBoxEndIndex,U,!0),this.addDebugCollisionBoxes(U.verticalTextBoxStartIndex,U.verticalTextBoxEndIndex,U,!0),this.addDebugCollisionBoxes(U.iconBoxStartIndex,U.iconBoxEndIndex,U,!1),this.addDebugCollisionBoxes(U.verticalIconBoxStartIndex,U.verticalIconBoxEndIndex,U,!1)}},eo.prototype._deserializeCollisionBoxesForSymbol=function(L,U,$,ve,we,Me,Oe,tt,pt){for(var gt={},Nt=U;Nt<$;Nt++){var nr=L.get(Nt);gt.textBox={x1:nr.x1,y1:nr.y1,x2:nr.x2,y2:nr.y2,anchorPointX:nr.anchorPointX,anchorPointY:nr.anchorPointY},gt.textFeatureIndex=nr.featureIndex;break}for(var qt=ve;qt<we;qt++){var yr=L.get(qt);gt.verticalTextBox={x1:yr.x1,y1:yr.y1,x2:yr.x2,y2:yr.y2,anchorPointX:yr.anchorPointX,anchorPointY:yr.anchorPointY},gt.verticalTextFeatureIndex=yr.featureIndex;break}for(var Nr=Me;Nr<Oe;Nr++){var ln=L.get(Nr);gt.iconBox={x1:ln.x1,y1:ln.y1,x2:ln.x2,y2:ln.y2,anchorPointX:ln.anchorPointX,anchorPointY:ln.anchorPointY},gt.iconFeatureIndex=ln.featureIndex;break}for(var en=tt;en<pt;en++){var kn=L.get(en);gt.verticalIconBox={x1:kn.x1,y1:kn.y1,x2:kn.x2,y2:kn.y2,anchorPointX:kn.anchorPointX,anchorPointY:kn.anchorPointY},gt.verticalIconFeatureIndex=kn.featureIndex;break}return gt},eo.prototype.deserializeCollisionBoxes=function(L){this.collisionArrays=[];for(var U=0;U<this.symbolInstances.length;U++){var $=this.symbolInstances.get(U);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(L,$.textBoxStartIndex,$.textBoxEndIndex,$.verticalTextBoxStartIndex,$.verticalTextBoxEndIndex,$.iconBoxStartIndex,$.iconBoxEndIndex,$.verticalIconBoxStartIndex,$.verticalIconBoxEndIndex))}},eo.prototype.hasTextData=function(){return this.text.segments.get().length>0},eo.prototype.hasIconData=function(){return this.icon.segments.get().length>0},eo.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},eo.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},eo.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},eo.prototype.addIndicesForPlacedSymbol=function(L,U){for(var $=L.placedSymbolArray.get(U),ve=$.vertexStartIndex+$.numGlyphs*4,we=$.vertexStartIndex;we<ve;we+=4)L.indexArray.emplaceBack(we,we+1,we+2),L.indexArray.emplaceBack(we+1,we+2,we+3)},eo.prototype.getSortedSymbolIndexes=function(L){if(this.sortedAngle===L&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var U=Math.sin(L),$=Math.cos(L),ve=[],we=[],Me=[],Oe=0;Oe<this.symbolInstances.length;++Oe){Me.push(Oe);var tt=this.symbolInstances.get(Oe);ve.push(Math.round(U*tt.anchorX+$*tt.anchorY)|0),we.push(tt.featureIndex)}return Me.sort(function(pt,gt){return ve[pt]-ve[gt]||we[gt]-we[pt]}),Me},eo.prototype.addToSortKeyRanges=function(L,U){var $=this.sortKeyRanges[this.sortKeyRanges.length-1];$&&$.sortKey===U?$.symbolInstanceEnd=L+1:this.sortKeyRanges.push({sortKey:U,symbolInstanceStart:L,symbolInstanceEnd:L+1})},eo.prototype.sortFeatures=function(L){var U=this;if(!!this.sortFeaturesByY&&this.sortedAngle!==L&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(L),this.sortedAngle=L,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var $=0,ve=this.symbolInstanceIndexes;$<ve.length;$+=1){var we=ve[$],Me=this.symbolInstances.get(we);this.featureSortOrder.push(Me.featureIndex),[Me.rightJustifiedTextSymbolIndex,Me.centerJustifiedTextSymbolIndex,Me.leftJustifiedTextSymbolIndex].forEach(function(Oe,tt,pt){Oe>=0&&pt.indexOf(Oe)===tt&&U.addIndicesForPlacedSymbol(U.text,Oe)}),Me.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,Me.verticalPlacedTextSymbolIndex),Me.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,Me.placedIconSymbolIndex),Me.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,Me.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Ue("SymbolBucket",eo,{omit:["layers","collisionBoxArray","features","compareText"]}),eo.MAX_GLYPHS=65535,eo.addDynamicAttributes=xp;function R1(D,L){return L.replace(/{([^{}]+)}/g,function(U,$){return $ in D?String(D[$]):""})}var I1=new ro({"symbol-placement":new Ba(Gt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ba(Gt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ba(Gt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Qa(Gt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ba(Gt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ba(Gt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ba(Gt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ba(Gt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ba(Gt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Qa(Gt.layout_symbol["icon-size"]),"icon-text-fit":new Ba(Gt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ba(Gt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Qa(Gt.layout_symbol["icon-image"]),"icon-rotate":new Qa(Gt.layout_symbol["icon-rotate"]),"icon-padding":new Ba(Gt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ba(Gt.layout_symbol["icon-keep-upright"]),"icon-offset":new Qa(Gt.layout_symbol["icon-offset"]),"icon-anchor":new Qa(Gt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ba(Gt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ba(Gt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ba(Gt.layout_symbol["text-rotation-alignment"]),"text-field":new Qa(Gt.layout_symbol["text-field"]),"text-font":new Qa(Gt.layout_symbol["text-font"]),"text-size":new Qa(Gt.layout_symbol["text-size"]),"text-max-width":new Qa(Gt.layout_symbol["text-max-width"]),"text-line-height":new Ba(Gt.layout_symbol["text-line-height"]),"text-letter-spacing":new Qa(Gt.layout_symbol["text-letter-spacing"]),"text-justify":new Qa(Gt.layout_symbol["text-justify"]),"text-radial-offset":new Qa(Gt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ba(Gt.layout_symbol["text-variable-anchor"]),"text-anchor":new Qa(Gt.layout_symbol["text-anchor"]),"text-max-angle":new Ba(Gt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ba(Gt.layout_symbol["text-writing-mode"]),"text-rotate":new Qa(Gt.layout_symbol["text-rotate"]),"text-padding":new Ba(Gt.layout_symbol["text-padding"]),"text-keep-upright":new Ba(Gt.layout_symbol["text-keep-upright"]),"text-transform":new Qa(Gt.layout_symbol["text-transform"]),"text-offset":new Qa(Gt.layout_symbol["text-offset"]),"text-allow-overlap":new Ba(Gt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ba(Gt.layout_symbol["text-ignore-placement"]),"text-optional":new Ba(Gt.layout_symbol["text-optional"])}),z1=new ro({"icon-opacity":new Qa(Gt.paint_symbol["icon-opacity"]),"icon-color":new Qa(Gt.paint_symbol["icon-color"]),"icon-halo-color":new Qa(Gt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Qa(Gt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Qa(Gt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ba(Gt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ba(Gt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Qa(Gt.paint_symbol["text-opacity"]),"text-color":new Qa(Gt.paint_symbol["text-color"],{runtimeType:On,getOverride:function(D){return D.textColor},hasOverride:function(D){return!!D.textColor}}),"text-halo-color":new Qa(Gt.paint_symbol["text-halo-color"]),"text-halo-width":new Qa(Gt.paint_symbol["text-halo-width"]),"text-halo-blur":new Qa(Gt.paint_symbol["text-halo-blur"]),"text-translate":new Ba(Gt.paint_symbol["text-translate"]),"text-translate-anchor":new Ba(Gt.paint_symbol["text-translate-anchor"])}),bp={paint:z1,layout:I1},Wc=function(L){this.type=L.property.overrides?L.property.overrides.runtimeType:mr,this.defaultValue=L};Wc.prototype.evaluate=function(L){if(L.formattedSection){var U=this.defaultValue.property.overrides;if(U&&U.hasOverride(L.formattedSection))return U.getOverride(L.formattedSection)}return L.feature&&L.featureState?this.defaultValue.evaluate(L.feature,L.featureState):this.defaultValue.property.specification.default},Wc.prototype.eachChild=function(L){if(!this.defaultValue.isConstant()){var U=this.defaultValue.value;L(U._styleExpression.expression)}},Wc.prototype.outputDefined=function(){return!1},Wc.prototype.serialize=function(){return null},Ue("FormatSectionOverride",Wc,{omit:["defaultValue"]});var B1=function(D){function L(U){D.call(this,U,bp)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.recalculate=function($,ve){if(D.prototype.recalculate.call(this,$,ve),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var we=this.layout.get("text-writing-mode");if(we){for(var Me=[],Oe=0,tt=we;Oe<tt.length;Oe+=1){var pt=tt[Oe];Me.indexOf(pt)<0&&Me.push(pt)}this.layout._values["text-writing-mode"]=Me}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},L.prototype.getValueAndResolveTokens=function($,ve,we,Me){var Oe=this.layout.get($).evaluate(ve,{},we,Me),tt=this._unevaluatedLayout._values[$];return!tt.isDataDriven()&&!Do(tt.value)&&Oe?R1(ve.properties,Oe):Oe},L.prototype.createBucket=function($){return new eo($)},L.prototype.queryRadius=function(){return 0},L.prototype.queryIntersectsFeature=function(){return!1},L.prototype._setPaintOverrides=function(){for(var $=0,ve=bp.paint.overridableProperties;$<ve.length;$+=1){var we=ve[$];if(!!L.hasPaintOverride(this.layout,we)){var Me=this.paint.get(we),Oe=new Wc(Me),tt=new Es(Oe,Me.property.specification),pt=null;Me.value.kind==="constant"||Me.value.kind==="source"?pt=new Mu("source",tt):pt=new Cs("composite",tt,Me.value.zoomStops,Me.value._interpolationType),this.paint._values[we]=new qi(Me.property,pt,Me.parameters)}}},L.prototype._handleOverridablePaintPropertyUpdate=function($,ve,we){return!this.layout||ve.isDataDriven()||we.isDataDriven()?!1:L.hasPaintOverride(this.layout,$)},L.hasPaintOverride=function($,ve){var we=$.get("text-field"),Me=bp.paint.properties[ve],Oe=!1,tt=function(Nt){for(var nr=0,qt=Nt;nr<qt.length;nr+=1){var yr=qt[nr];if(Me.overrides&&Me.overrides.hasOverride(yr)){Oe=!0;return}}};if(we.value.kind==="constant"&&we.value.value instanceof Ki)tt(we.value.value.sections);else if(we.value.kind==="source"){var pt=function(Nt){if(!Oe)if(Nt instanceof io&&Vi(Nt.value)===ma){var nr=Nt.value;tt(nr.sections)}else Nt instanceof bs?tt(Nt.sections):Nt.eachChild(pt)},gt=we.value;gt._styleExpression&&pt(gt._styleExpression.expression)}return Oe},L}(Ns),N1=new ro({"background-color":new Ba(Gt.paint_background["background-color"]),"background-pattern":new fo(Gt.paint_background["background-pattern"]),"background-opacity":new Ba(Gt.paint_background["background-opacity"])}),O1={paint:N1},U1=function(D){function L(U){D.call(this,U,O1)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L}(Ns),V1=new ro({"raster-opacity":new Ba(Gt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ba(Gt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ba(Gt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ba(Gt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ba(Gt.paint_raster["raster-saturation"]),"raster-contrast":new Ba(Gt.paint_raster["raster-contrast"]),"raster-resampling":new Ba(Gt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ba(Gt.paint_raster["raster-fade-duration"])}),H1={paint:V1},G1=function(D){function L(U){D.call(this,U,H1)}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L}(Ns);function Y1(D){var L=[],U=D.id;return U===void 0&&L.push({message:"layers."+U+': missing required property "id"'}),D.render===void 0&&L.push({message:"layers."+U+': missing required method "render"'}),D.renderingMode&&D.renderingMode!=="2d"&&D.renderingMode!=="3d"&&L.push({message:"layers."+U+': property "renderingMode" must be either "2d" or "3d"'}),L}var W1=function(D){function L(U){D.call(this,U,{}),this.implementation=U}return D&&(L.__proto__=D),L.prototype=Object.create(D&&D.prototype),L.prototype.constructor=L,L.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},L.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},L.prototype.recalculate=function(){},L.prototype.updateTransitions=function(){},L.prototype.hasTransition=function(){},L.prototype.serialize=function(){},L.prototype.onAdd=function($){this.implementation.onAdd&&this.implementation.onAdd($,$.painter.context.gl)},L.prototype.onRemove=function($){this.implementation.onRemove&&this.implementation.onRemove($,$.painter.context.gl)},L}(Ns),X1={circle:_y,heatmap:My,hillshade:Cy,fill:qy,"fill-extrusion":xm,line:Pm,symbol:B1,background:U1,raster:G1};function Z1(D){return D.type==="custom"?new W1(D):new X1[D.type](D)}var $d=self.HTMLImageElement,qd=self.HTMLCanvasElement,e0=self.HTMLVideoElement,t0=self.ImageData,fv=self.ImageBitmap,yc=function(L,U,$,ve){this.context=L,this.format=$,this.texture=L.gl.createTexture(),this.update(U,ve)};yc.prototype.update=function(L,U,$){var ve=L.width,we=L.height,Me=(!this.size||this.size[0]!==ve||this.size[1]!==we)&&!$,Oe=this,tt=Oe.context,pt=tt.gl;if(this.useMipmap=Boolean(U&&U.useMipmap),pt.bindTexture(pt.TEXTURE_2D,this.texture),tt.pixelStoreUnpackFlipY.set(!1),tt.pixelStoreUnpack.set(1),tt.pixelStoreUnpackPremultiplyAlpha.set(this.format===pt.RGBA&&(!U||U.premultiply!==!1)),Me)this.size=[ve,we],L instanceof $d||L instanceof qd||L instanceof e0||L instanceof t0||fv&&L instanceof fv?pt.texImage2D(pt.TEXTURE_2D,0,this.format,this.format,pt.UNSIGNED_BYTE,L):pt.texImage2D(pt.TEXTURE_2D,0,this.format,ve,we,0,this.format,pt.UNSIGNED_BYTE,L.data);else{var gt=$||{x:0,y:0},Nt=gt.x,nr=gt.y;L instanceof $d||L instanceof qd||L instanceof e0||L instanceof t0||fv&&L instanceof fv?pt.texSubImage2D(pt.TEXTURE_2D,0,Nt,nr,pt.RGBA,pt.UNSIGNED_BYTE,L):pt.texSubImage2D(pt.TEXTURE_2D,0,Nt,nr,ve,we,pt.RGBA,pt.UNSIGNED_BYTE,L.data)}this.useMipmap&&this.isSizePowerOfTwo()&&pt.generateMipmap(pt.TEXTURE_2D)},yc.prototype.bind=function(L,U,$){var ve=this,we=ve.context,Me=we.gl;Me.bindTexture(Me.TEXTURE_2D,this.texture),$===Me.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()&&($=Me.LINEAR),L!==this.filter&&(Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_MAG_FILTER,L),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_MIN_FILTER,$||L),this.filter=L),U!==this.wrap&&(Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_WRAP_S,U),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_WRAP_T,U),this.wrap=U)},yc.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0},yc.prototype.destroy=function(){var L=this.context,U=L.gl;U.deleteTexture(this.texture),this.texture=null};var _p=function(L){var U=this;this._callback=L,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){U._triggered=!1,U._callback()})};_p.prototype.trigger=function(){var L=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){L._triggered=!1,L._callback()},0))},_p.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Xc=function(L,U,$){this.target=L,this.parent=U,this.mapId=$,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},S(["receive","process"],this),this.invoker=new _p(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=j()?L:self};Xc.prototype.send=function(L,U,$,ve,we){var Me=this;we===void 0&&(we=!1);var Oe=Math.round(Math.random()*1e18).toString(36).substring(0,10);$&&(this.callbacks[Oe]=$);var tt=re(this.globalScope)?void 0:[];return this.target.postMessage({id:Oe,type:L,hasCallback:!!$,targetMapId:ve,mustQueue:we,sourceMapId:this.mapId,data:It(U,tt)},tt),{cancel:function(){$&&delete Me.callbacks[Oe],Me.target.postMessage({id:Oe,type:"<cancel>",targetMapId:ve,sourceMapId:Me.mapId})}}},Xc.prototype.receive=function(L){var U=L.data,$=U.id;if(!!$&&!(U.targetMapId&&this.mapId!==U.targetMapId))if(U.type==="<cancel>"){delete this.tasks[$];var ve=this.cancelCallbacks[$];delete this.cancelCallbacks[$],ve&&ve()}else j()||U.mustQueue?(this.tasks[$]=U,this.taskQueue.push($),this.invoker.trigger()):this.processTask($,U)},Xc.prototype.process=function(){if(!!this.taskQueue.length){var L=this.taskQueue.shift(),U=this.tasks[L];delete this.tasks[L],this.taskQueue.length&&this.invoker.trigger(),U&&this.processTask(L,U)}},Xc.prototype.processTask=function(L,U){var $=this;if(U.type==="<response>"){var ve=this.callbacks[L];delete this.callbacks[L],ve&&(U.error?ve(Qt(U.error)):ve(null,Qt(U.data)))}else{var we=!1,Me=re(this.globalScope)?void 0:[],Oe=U.hasCallback?function(nr,qt){we=!0,delete $.cancelCallbacks[L],$.target.postMessage({id:L,type:"<response>",sourceMapId:$.mapId,error:nr?It(nr):null,data:It(qt,Me)},Me)}:function(nr){we=!0},tt=null,pt=Qt(U.data);if(this.parent[U.type])tt=this.parent[U.type](U.sourceMapId,pt,Oe);else if(this.parent.getWorkerSource){var gt=U.type.split("."),Nt=this.parent.getWorkerSource(U.sourceMapId,gt[0],pt.source);tt=Nt[gt[1]](pt,Oe)}else Oe(new Error("Could not find function "+U.type));!we&&tt&&tt.cancel&&(this.cancelCallbacks[L]=tt.cancel)}},Xc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};function j1(D,L,U){L=Math.pow(2,U)-L-1;var $=r0(D*256,L*256,U),ve=r0((D+1)*256,(L+1)*256,U);return $[0]+","+$[1]+","+ve[0]+","+ve[1]}function r0(D,L,U){var $=2*Math.PI*6378137/256/Math.pow(2,U),ve=D*$-2*Math.PI*6378137/2,we=L*$-2*Math.PI*6378137/2;return[ve,we]}var es=function(L,U){L&&(U?this.setSouthWest(L).setNorthEast(U):L.length===4?this.setSouthWest([L[0],L[1]]).setNorthEast([L[2],L[3]]):this.setSouthWest(L[0]).setNorthEast(L[1]))};es.prototype.setNorthEast=function(L){return this._ne=L instanceof To?new To(L.lng,L.lat):To.convert(L),this},es.prototype.setSouthWest=function(L){return this._sw=L instanceof To?new To(L.lng,L.lat):To.convert(L),this},es.prototype.extend=function(L){var U=this._sw,$=this._ne,ve,we;if(L instanceof To)ve=L,we=L;else if(L instanceof es){if(ve=L._sw,we=L._ne,!ve||!we)return this}else{if(Array.isArray(L))if(L.length===4||L.every(Array.isArray)){var Me=L;return this.extend(es.convert(Me))}else{var Oe=L;return this.extend(To.convert(Oe))}return this}return!U&&!$?(this._sw=new To(ve.lng,ve.lat),this._ne=new To(we.lng,we.lat)):(U.lng=Math.min(ve.lng,U.lng),U.lat=Math.min(ve.lat,U.lat),$.lng=Math.max(we.lng,$.lng),$.lat=Math.max(we.lat,$.lat)),this},es.prototype.getCenter=function(){return new To((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},es.prototype.getSouthWest=function(){return this._sw},es.prototype.getNorthEast=function(){return this._ne},es.prototype.getNorthWest=function(){return new To(this.getWest(),this.getNorth())},es.prototype.getSouthEast=function(){return new To(this.getEast(),this.getSouth())},es.prototype.getWest=function(){return this._sw.lng},es.prototype.getSouth=function(){return this._sw.lat},es.prototype.getEast=function(){return this._ne.lng},es.prototype.getNorth=function(){return this._ne.lat},es.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},es.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},es.prototype.isEmpty=function(){return!(this._sw&&this._ne)},es.prototype.contains=function(L){var U=To.convert(L),$=U.lng,ve=U.lat,we=this._sw.lat<=ve&&ve<=this._ne.lat,Me=this._sw.lng<=$&&$<=this._ne.lng;return this._sw.lng>this._ne.lng&&(Me=this._sw.lng>=$&&$>=this._ne.lng),we&&Me},es.convert=function(L){return!L||L instanceof es?L:new es(L)};var n0=63710088e-1,To=function(L,U){if(isNaN(L)||isNaN(U))throw new Error("Invalid LngLat object: ("+L+", "+U+")");if(this.lng=+L,this.lat=+U,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};To.prototype.wrap=function(){return new To(x(this.lng,-180,180),this.lat)},To.prototype.toArray=function(){return[this.lng,this.lat]},To.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},To.prototype.distanceTo=function(L){var U=Math.PI/180,$=this.lat*U,ve=L.lat*U,we=Math.sin($)*Math.sin(ve)+Math.cos($)*Math.cos(ve)*Math.cos((L.lng-this.lng)*U),Me=n0*Math.acos(Math.min(we,1));return Me},To.prototype.toBounds=function(L){L===void 0&&(L=0);var U=40075017,$=360*L/U,ve=$/Math.cos(Math.PI/180*this.lat);return new es(new To(this.lng-ve,this.lat-$),new To(this.lng+ve,this.lat+$))},To.convert=function(L){if(L instanceof To)return L;if(Array.isArray(L)&&(L.length===2||L.length===3))return new To(Number(L[0]),Number(L[1]));if(!Array.isArray(L)&&typeof L=="object"&&L!==null)return new To(Number("lng"in L?L.lng:L.lon),Number(L.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var a0=2*Math.PI*n0;function i0(D){return a0*Math.cos(D*Math.PI/180)}function o0(D){return(180+D)/360}function s0(D){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+D*Math.PI/360)))/360}function l0(D,L){return D/i0(L)}function J1(D){return D*360-180}function wp(D){var L=180-D*360;return 360/Math.PI*Math.atan(Math.exp(L*Math.PI/180))-90}function K1(D,L){return D*i0(wp(L))}function Q1(D){return 1/Math.cos(D*Math.PI/180)}var mc=function(L,U,$){$===void 0&&($=0),this.x=+L,this.y=+U,this.z=+$};mc.fromLngLat=function(L,U){U===void 0&&(U=0);var $=To.convert(L);return new mc(o0($.lng),s0($.lat),l0(U,$.lat))},mc.prototype.toLngLat=function(){return new To(J1(this.x),wp(this.y))},mc.prototype.toAltitude=function(){return K1(this.z,this.y)},mc.prototype.meterInMercatorCoordinateUnits=function(){return 1/a0*Q1(wp(this.y))};var xc=function(L,U,$){this.z=L,this.x=U,this.y=$,this.key=Ph(0,L,L,U,$)};xc.prototype.equals=function(L){return this.z===L.z&&this.x===L.x&&this.y===L.y},xc.prototype.url=function(L,U){var $=j1(this.x,this.y,this.z),ve=$1(this.z,this.x,this.y);return L[(this.x+this.y)%L.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(U==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",ve).replace("{bbox-epsg-3857}",$)},xc.prototype.getTilePoint=function(L){var U=Math.pow(2,this.z);return new f((L.x*U-this.x)*Va,(L.y*U-this.y)*Va)},xc.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var u0=function(L,U){this.wrap=L,this.canonical=U,this.key=Ph(L,U.z,U.z,U.x,U.y)},ts=function(L,U,$,ve,we){this.overscaledZ=L,this.wrap=U,this.canonical=new xc($,+ve,+we),this.key=Ph(U,L,$,ve,we)};ts.prototype.equals=function(L){return this.overscaledZ===L.overscaledZ&&this.wrap===L.wrap&&this.canonical.equals(L.canonical)},ts.prototype.scaledTo=function(L){var U=this.canonical.z-L;return L>this.canonical.z?new ts(L,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ts(L,this.wrap,L,this.canonical.x>>U,this.canonical.y>>U)},ts.prototype.calculateScaledKey=function(L,U){var $=this.canonical.z-L;return L>this.canonical.z?Ph(this.wrap*+U,L,this.canonical.z,this.canonical.x,this.canonical.y):Ph(this.wrap*+U,L,L,this.canonical.x>>$,this.canonical.y>>$)},ts.prototype.isChildOf=function(L){if(L.wrap!==this.wrap)return!1;var U=this.canonical.z-L.canonical.z;return L.overscaledZ===0||L.overscaledZ<this.overscaledZ&&L.canonical.x===this.canonical.x>>U&&L.canonical.y===this.canonical.y>>U},ts.prototype.children=function(L){if(this.overscaledZ>=L)return[new ts(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var U=this.canonical.z+1,$=this.canonical.x*2,ve=this.canonical.y*2;return[new ts(U,this.wrap,U,$,ve),new ts(U,this.wrap,U,$+1,ve),new ts(U,this.wrap,U,$,ve+1),new ts(U,this.wrap,U,$+1,ve+1)]},ts.prototype.isLessThan=function(L){return this.wrap<L.wrap?!0:this.wrap>L.wrap?!1:this.overscaledZ<L.overscaledZ?!0:this.overscaledZ>L.overscaledZ?!1:this.canonical.x<L.canonical.x?!0:this.canonical.x>L.canonical.x?!1:this.canonical.y<L.canonical.y},ts.prototype.wrapped=function(){return new ts(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},ts.prototype.unwrapTo=function(L){return new ts(this.overscaledZ,L,this.canonical.z,this.canonical.x,this.canonical.y)},ts.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},ts.prototype.toUnwrapped=function(){return new u0(this.wrap,this.canonical)},ts.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},ts.prototype.getTilePoint=function(L){return this.canonical.getTilePoint(new mc(L.x-this.wrap,L.y))};function Ph(D,L,U,$,ve){D*=2,D<0&&(D=D*-1-1);var we=1<<U;return(we*we*D+we*ve+$).toString(36)+U.toString(36)+L.toString(36)}function $1(D,L,U){for(var $="",ve,we=D;we>0;we--)ve=1<<we-1,$+=(L&ve?1:0)+(U&ve?2:0);return $}Ue("CanonicalTileID",xc),Ue("OverscaledTileID",ts,{omit:["posMatrix"]});var Ff=function(L,U,$){if(this.uid=L,U.height!==U.width)throw new RangeError("DEM tiles must be square");if($&&$!=="mapbox"&&$!=="terrarium")return O('"'+$+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=U.height;var ve=this.dim=U.height-2;this.data=new Uint32Array(U.data.buffer),this.encoding=$||"mapbox";for(var we=0;we<ve;we++)this.data[this._idx(-1,we)]=this.data[this._idx(0,we)],this.data[this._idx(ve,we)]=this.data[this._idx(ve-1,we)],this.data[this._idx(we,-1)]=this.data[this._idx(we,0)],this.data[this._idx(we,ve)]=this.data[this._idx(we,ve-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(ve,-1)]=this.data[this._idx(ve-1,0)],this.data[this._idx(-1,ve)]=this.data[this._idx(0,ve-1)],this.data[this._idx(ve,ve)]=this.data[this._idx(ve-1,ve-1)]};Ff.prototype.get=function(L,U){var $=new Uint8Array(this.data.buffer),ve=this._idx(L,U)*4,we=this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox;return we($[ve],$[ve+1],$[ve+2])},Ff.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ff.prototype._idx=function(L,U){if(L<-1||L>=this.dim+1||U<-1||U>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(U+1)*this.stride+(L+1)},Ff.prototype._unpackMapbox=function(L,U,$){return(L*256*256+U*256+$)/10-1e4},Ff.prototype._unpackTerrarium=function(L,U,$){return L*256+U+$/256-32768},Ff.prototype.getPixels=function(){return new Al({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ff.prototype.backfillBorder=function(L,U,$){if(this.dim!==L.dim)throw new Error("dem dimension mismatch");var ve=U*this.dim,we=U*this.dim+this.dim,Me=$*this.dim,Oe=$*this.dim+this.dim;switch(U){case-1:ve=we-1;break;case 1:we=ve+1;break}switch($){case-1:Me=Oe-1;break;case 1:Oe=Me+1;break}for(var tt=-U*this.dim,pt=-$*this.dim,gt=Me;gt<Oe;gt++)for(var Nt=ve;Nt<we;Nt++)this.data[this._idx(Nt,gt)]=L.data[this._idx(Nt+tt,gt+pt)]},Ue("DEMData",Ff);function q1(D,L){var U={};if(!L)return U;for(var $=function(){var Me=we[ve],Oe=Me.layerIds.map(function(Nt){return L.getLayer(Nt)}).filter(Boolean);if(Oe.length!==0){Me.layers=Oe,Me.stateDependentLayerIds&&(Me.stateDependentLayers=Me.stateDependentLayerIds.map(function(Nt){return Oe.filter(function(nr){return nr.id===Nt})[0]}));for(var tt=0,pt=Oe;tt<pt.length;tt+=1){var gt=pt[tt];U[gt.id]=Me}}},ve=0,we=D;ve<we.length;ve+=1)$();return U}var cv=function(L){this._stringToNumber={},this._numberToString=[];for(var U=0;U<L.length;U++){var $=L[U];this._stringToNumber[$]=U,this._numberToString[U]=$}};cv.prototype.encode=function(L){return this._stringToNumber[L]},cv.prototype.decode=function(L){return this._numberToString[L]};var hv=function(L,U,$,ve,we){this.type="Feature",this._vectorTileFeature=L,L._z=U,L._x=$,L._y=ve,this.properties=L.properties,this.id=we},Tp={geometry:{configurable:!0}};Tp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Tp.geometry.set=function(D){this._geometry=D},hv.prototype.toJSON=function(){var L={geometry:this.geometry};for(var U in this)U==="_geometry"||U==="_vectorTileFeature"||(L[U]=this[U]);return L},Object.defineProperties(hv.prototype,Tp);var Zc=function(){this.state={},this.stateChanges={},this.deletedStates={}};Zc.prototype.updateState=function(L,U,$){var ve=String(U);if(this.stateChanges[L]=this.stateChanges[L]||{},this.stateChanges[L][ve]=this.stateChanges[L][ve]||{},M(this.stateChanges[L][ve],$),this.deletedStates[L]===null){this.deletedStates[L]={};for(var we in this.state[L])we!==ve&&(this.deletedStates[L][we]=null)}else{var Me=this.deletedStates[L]&&this.deletedStates[L][ve]===null;if(Me){this.deletedStates[L][ve]={};for(var Oe in this.state[L][ve])$[Oe]||(this.deletedStates[L][ve][Oe]=null)}else for(var tt in $){var pt=this.deletedStates[L]&&this.deletedStates[L][ve]&&this.deletedStates[L][ve][tt]===null;pt&&delete this.deletedStates[L][ve][tt]}}},Zc.prototype.removeFeatureState=function(L,U,$){var ve=this.deletedStates[L]===null;if(!ve){var we=String(U);if(this.deletedStates[L]=this.deletedStates[L]||{},$&&U!==void 0)this.deletedStates[L][we]!==null&&(this.deletedStates[L][we]=this.deletedStates[L][we]||{},this.deletedStates[L][we][$]=null);else if(U!==void 0){var Me=this.stateChanges[L]&&this.stateChanges[L][we];if(Me){this.deletedStates[L][we]={};for($ in this.stateChanges[L][we])this.deletedStates[L][we][$]=null}else this.deletedStates[L][we]=null}else this.deletedStates[L]=null}},Zc.prototype.getState=function(L,U){var $=String(U),ve=this.state[L]||{},we=this.stateChanges[L]||{},Me=M({},ve[$],we[$]);if(this.deletedStates[L]===null)return{};if(this.deletedStates[L]){var Oe=this.deletedStates[L][U];if(Oe===null)return{};for(var tt in Oe)delete Me[tt]}return Me},Zc.prototype.initializeTileState=function(L,U){L.setFeatureState(this.state,U)},Zc.prototype.coalesceChanges=function(L,U){var $={};for(var ve in this.stateChanges){this.state[ve]=this.state[ve]||{};var we={};for(var Me in this.stateChanges[ve])this.state[ve][Me]||(this.state[ve][Me]={}),M(this.state[ve][Me],this.stateChanges[ve][Me]),we[Me]=this.state[ve][Me];$[ve]=we}for(var Oe in this.deletedStates){this.state[Oe]=this.state[Oe]||{};var tt={};if(this.deletedStates[Oe]===null)for(var pt in this.state[Oe])tt[pt]={},this.state[Oe][pt]={};else for(var gt in this.deletedStates[Oe]){var Nt=this.deletedStates[Oe][gt]===null;if(Nt)this.state[Oe][gt]={};else for(var nr=0,qt=Object.keys(this.deletedStates[Oe][gt]);nr<qt.length;nr+=1){var yr=qt[nr];delete this.state[Oe][gt][yr]}tt[gt]=this.state[Oe][gt]}$[Oe]=$[Oe]||{},M($[Oe],tt)}if(this.stateChanges={},this.deletedStates={},Object.keys($).length!==0)for(var Nr in L){var ln=L[Nr];ln.setFeatureState($,U)}};var Rf=function(L,U){this.tileID=L,this.x=L.canonical.x,this.y=L.canonical.y,this.z=L.canonical.z,this.grid=new Yo(Va,16,0),this.grid3D=new Yo(Va,16,0),this.featureIndexArray=new yh,this.promoteId=U};Rf.prototype.insert=function(L,U,$,ve,we,Me){var Oe=this.featureIndexArray.length;this.featureIndexArray.emplaceBack($,ve,we);for(var tt=Me?this.grid3D:this.grid,pt=0;pt<U.length;pt++){for(var gt=U[pt],Nt=[1/0,1/0,-1/0,-1/0],nr=0;nr<gt.length;nr++){var qt=gt[nr];Nt[0]=Math.min(Nt[0],qt.x),Nt[1]=Math.min(Nt[1],qt.y),Nt[2]=Math.max(Nt[2],qt.x),Nt[3]=Math.max(Nt[3],qt.y)}Nt[0]<Va&&Nt[1]<Va&&Nt[2]>=0&&Nt[3]>=0&&tt.insert(Oe,Nt[0],Nt[1],Nt[2],Nt[3])}},Rf.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Ic.VectorTile(new tv(this.rawTileData)).layers,this.sourceLayerCoder=new cv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Rf.prototype.query=function(L,U,$,ve){var we=this;this.loadVTLayers();for(var Me=L.params||{},Oe=Va/L.tileSize/L.scale,tt=xf(Me.filter),pt=L.queryGeometry,gt=L.queryPadding*Oe,Nt=c0(pt),nr=this.grid.query(Nt.minX-gt,Nt.minY-gt,Nt.maxX+gt,Nt.maxY+gt),qt=c0(L.cameraQueryGeometry),yr=this.grid3D.query(qt.minX-gt,qt.minY-gt,qt.maxX+gt,qt.maxY+gt,function(Wn,la,ia,za){return Mf(L.cameraQueryGeometry,Wn-gt,la-gt,ia+gt,za+gt)}),Nr=0,ln=yr;Nr<ln.length;Nr+=1){var en=ln[Nr];nr.push(en)}nr.sort(ex);for(var kn={},bn,Cn=function(Wn){var la=nr[Wn];if(la!==bn){bn=la;var ia=we.featureIndexArray.get(la),za=null;we.loadMatchingFeature(kn,ia.bucketIndex,ia.sourceLayerIndex,ia.featureIndex,tt,Me.layers,Me.availableImages,U,$,ve,function(Ma,ka,ii){return za||(za=Ji(Ma)),ka.queryIntersectsFeature(pt,Ma,ii,za,we.z,L.transform,Oe,L.pixelPosMatrix)})}},zn=0;zn<nr.length;zn++)Cn(zn);return kn},Rf.prototype.loadMatchingFeature=function(L,U,$,ve,we,Me,Oe,tt,pt,gt,Nt){var nr=this.bucketLayerIDs[U];if(!(Me&&!F(Me,nr))){var qt=this.sourceLayerCoder.decode($),yr=this.vtLayers[qt],Nr=yr.feature(ve);if(!!we.filter(new ci(this.tileID.overscaledZ),Nr))for(var ln=this.getId(Nr,qt),en=0;en<nr.length;en++){var kn=nr[en];if(!(Me&&Me.indexOf(kn)<0)){var bn=tt[kn];if(!!bn){var Cn={};ln!==void 0&&gt&&(Cn=gt.getState(bn.sourceLayer||"_geojsonTileLayer",ln));var zn=pt[kn];zn.paint=f0(zn.paint,bn.paint,Nr,Cn,Oe),zn.layout=f0(zn.layout,bn.layout,Nr,Cn,Oe);var Wn=!Nt||Nt(Nr,bn,Cn);if(!!Wn){var la=new hv(Nr,this.z,this.x,this.y,ln);la.layer=zn;var ia=L[kn];ia===void 0&&(ia=L[kn]=[]),ia.push({featureIndex:ve,feature:la,intersectionZ:Wn})}}}}}},Rf.prototype.lookupSymbolFeatures=function(L,U,$,ve,we,Me,Oe,tt){var pt={};this.loadVTLayers();for(var gt=xf(we),Nt=0,nr=L;Nt<nr.length;Nt+=1){var qt=nr[Nt];this.loadMatchingFeature(pt,$,ve,qt,gt,Me,Oe,tt,U)}return pt},Rf.prototype.hasLayer=function(L){for(var U=0,$=this.bucketLayerIDs;U<$.length;U+=1)for(var ve=$[U],we=0,Me=ve;we<Me.length;we+=1){var Oe=Me[we];if(L===Oe)return!0}return!1},Rf.prototype.getId=function(L,U){var $=L.id;if(this.promoteId){var ve=typeof this.promoteId=="string"?this.promoteId:this.promoteId[U];$=L.properties[ve],typeof $=="boolean"&&($=Number($))}return $},Ue("FeatureIndex",Rf,{omit:["rawTileData","sourceLayerCoder"]});function f0(D,L,U,$,ve){return k(D,function(we,Me){var Oe=L instanceof ji?L.get(Me):null;return Oe&&Oe.evaluate?Oe.evaluate(U,$,ve):Oe})}function c0(D){for(var L=1/0,U=1/0,$=-1/0,ve=-1/0,we=0,Me=D;we<Me.length;we+=1){var Oe=Me[we];L=Math.min(L,Oe.x),U=Math.min(U,Oe.y),$=Math.max($,Oe.x),ve=Math.max(ve,Oe.y)}return{minX:L,minY:U,maxX:$,maxY:ve}}function ex(D,L){return L-D}var tx=3e4,ys=function(L,U){this.tileID=L,this.uid=w(),this.uses=0,this.tileSize=U,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};ys.prototype.registerFadeDuration=function(L){var U=L+this.timeAdded;U<q.now()||this.fadeEndTime&&U<this.fadeEndTime||(this.fadeEndTime=U)},ys.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},ys.prototype.loadVectorData=function(L,U,$){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",!L){this.collisionBoxArray=new Af;return}L.featureIndex&&(this.latestFeatureIndex=L.featureIndex,L.rawTileData?(this.latestRawTileData=L.rawTileData,this.latestFeatureIndex.rawTileData=L.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=L.collisionBoxArray,this.buckets=q1(L.buckets,U.style),this.hasSymbolBuckets=!1;for(var ve in this.buckets){var we=this.buckets[ve];if(we instanceof eo)if(this.hasSymbolBuckets=!0,$)we.justReloaded=!0;else break}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var Me in this.buckets){var Oe=this.buckets[Me];if(Oe instanceof eo&&Oe.hasRTLText){this.hasRTLText=!0,Ii();break}}this.queryPadding=0;for(var tt in this.buckets){var pt=this.buckets[tt];this.queryPadding=Math.max(this.queryPadding,U.style.getLayer(tt).queryRadius(pt))}L.imageAtlas&&(this.imageAtlas=L.imageAtlas),L.glyphAtlasImage&&(this.glyphAtlasImage=L.glyphAtlasImage)},ys.prototype.unloadVectorData=function(){for(var L in this.buckets)this.buckets[L].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},ys.prototype.getBucket=function(L){return this.buckets[L.id]},ys.prototype.upload=function(L){for(var U in this.buckets){var $=this.buckets[U];$.uploadPending()&&$.upload(L)}var ve=L.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new yc(L,this.imageAtlas.image,ve.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new yc(L,this.glyphAtlasImage,ve.ALPHA),this.glyphAtlasImage=null)},ys.prototype.prepare=function(L){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(L,this.imageAtlasTexture)},ys.prototype.queryRenderedFeatures=function(L,U,$,ve,we,Me,Oe,tt,pt,gt){return!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData?{}:this.latestFeatureIndex.query({queryGeometry:ve,cameraQueryGeometry:we,scale:Me,tileSize:this.tileSize,pixelPosMatrix:gt,transform:tt,params:Oe,queryPadding:this.queryPadding*pt},L,U,$)},ys.prototype.querySourceFeatures=function(L,U){var $=this.latestFeatureIndex;if(!(!$||!$.rawTileData)){var ve=$.loadVTLayers(),we=U?U.sourceLayer:"",Me=ve._geojsonTileLayer||ve[we];if(!!Me)for(var Oe=xf(U&&U.filter),tt=this.tileID.canonical,pt=tt.z,gt=tt.x,Nt=tt.y,nr={z:pt,x:gt,y:Nt},qt=0;qt<Me.length;qt++){var yr=Me.feature(qt);if(Oe.filter(new ci(this.tileID.overscaledZ),yr)){var Nr=$.getId(yr,we),ln=new hv(yr,pt,gt,Nt,Nr);ln.tile=nr,L.push(ln)}}}},ys.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},ys.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},ys.prototype.setExpiryData=function(L){var U=this.expirationTime;if(L.cacheControl){var $=Z(L.cacheControl);$["max-age"]&&(this.expirationTime=Date.now()+$["max-age"]*1e3)}else L.expires&&(this.expirationTime=new Date(L.expires).getTime());if(this.expirationTime){var ve=Date.now(),we=!1;if(this.expirationTime>ve)we=!1;else if(!U)we=!0;else if(this.expirationTime<U)we=!0;else{var Me=this.expirationTime-U;Me?this.expirationTime=ve+Math.max(Me,tx):we=!0}we?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},ys.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},ys.prototype.setFeatureState=function(L,U){if(!(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(L).length===0)){var $=this.latestFeatureIndex.loadVTLayers();for(var ve in this.buckets)if(!!U.style.hasLayer(ve)){var we=this.buckets[ve],Me=we.layers[0].sourceLayer||"_geojsonTileLayer",Oe=$[Me],tt=L[Me];if(!(!Oe||!tt||Object.keys(tt).length===0)){we.update(tt,Oe,this.imageAtlas&&this.imageAtlas.patternPositions||{});var pt=U&&U.style&&U.style.getLayer(ve);pt&&(this.queryPadding=Math.max(this.queryPadding,pt.queryRadius(we)))}}}},ys.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},ys.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<q.now()},ys.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},ys.prototype.setHoldDuration=function(L){this.symbolFadeHoldUntil=q.now()+L},ys.prototype.setDependencies=function(L,U){for(var $={},ve=0,we=U;ve<we.length;ve+=1){var Me=we[ve];$[Me]=!0}this.dependencies[L]=$},ys.prototype.hasDependency=function(L,U){for(var $=0,ve=L;$<ve.length;$+=1){var we=ve[$],Me=this.dependencies[we];if(Me)for(var Oe=0,tt=U;Oe<tt.length;Oe+=1){var pt=tt[Oe];if(Me[pt])return!0}}return!1};var rx=["type","source","source-layer","minzoom","maxzoom","filter","layout"],Qf=self.performance,h0=function(L){this._marks={start:[L.url,"start"].join("#"),end:[L.url,"end"].join("#"),measure:L.url.toString()},Qf.mark(this._marks.start)};h0.prototype.finish=function(){Qf.mark(this._marks.end);var L=Qf.getEntriesByName(this._marks.measure);return L.length===0&&(Qf.measure(this._marks.measure,this._marks.start,this._marks.end),L=Qf.getEntriesByName(this._marks.measure),Qf.clearMarks(this._marks.start),Qf.clearMarks(this._marks.end),Qf.clearMeasures(this._marks.measure)),L},e.Actor=Xc,e.AlphaImage=gc,e.CanonicalTileID=xc,e.CollisionBoxArray=Af,e.Color=bi,e.DEMData=Ff,e.DataConstantProperty=Ba,e.DictionaryCoder=cv,e.EXTENT=Va,e.ErrorEvent=wr,e.EvaluationParameters=ci,e.Event=kr,e.Evented=Sr,e.FeatureIndex=Rf,e.FillBucket=$u,e.FillExtrusionBucket=qu,e.ImageAtlas=Ch,e.ImagePosition=nv,e.LineBucket=Ml,e.LngLat=To,e.LngLatBounds=es,e.MercatorCoordinate=mc,e.ONE_EM=Ls,e.OverscaledTileID=ts,e.Point=f,e.Point$1=f,e.Properties=ro,e.Protobuf=tv,e.RGBAImage=Al,e.RequestManager=Se,e.RequestPerformance=h0,e.ResourceType=ot,e.SegmentVector=W,e.SourceFeatureState=Zc,e.StructArrayLayout1ui2=Wf,e.StructArrayLayout2f1f2i16=Ju,e.StructArrayLayout2i4=uc,e.StructArrayLayout3ui6=Ku,e.StructArrayLayout4i8=bf,e.SymbolBucket=eo,e.Texture=yc,e.Tile=ys,e.Transitionable=Co,e.Uniform1f=Gr,e.Uniform1i=Xr,e.Uniform2f=$r,e.Uniform3f=pn,e.Uniform4f=Ln,e.UniformColor=Nn,e.UniformMatrix4f=ta,e.UnwrappedTileID=u0,e.ValidationError=pr,e.WritingMode=$l,e.ZoomHistory=tr,e.add=Pc,e.addDynamicAttributes=xp,e.asyncAll=l,e.bezier=g,e.bindAll=S,e.browser=q,e.cacheEntryPossiblyAdded=Jt,e.clamp=v,e.clearTileCache=or,e.clipLine=Xd,e.clone=jh,e.clone$1=z,e.clone$2=$v,e.collisionCircleLayout=zm,e.config=ae,e.create=kc,e.create$1=pc,e.create$2=vc,e.createCommonjsModule=i,e.createExpression=cu,e.createLayout=Xo,e.createStyleLayer=Z1,e.cross=hy,e.deepEqual=s,e.dot=cy,e.dot$1=yy,e.ease=p,e.emitValidationErrors=Eo,e.endsWith=E,e.enforceCacheSizeLimit=Yt,e.evaluateSizeForFeature=Od,e.evaluateSizeForZoom=Ud,e.evaluateVariableOffset=Jd,e.evented=Ai,e.extend=M,e.featureFilter=xf,e.filterObject=B,e.fromRotation=Cc,e.getAnchorAlignment=dp,e.getAnchorJustification=mp,e.getArrayBuffer=ft,e.getImage=yt,e.getJSON=st,e.getRTLTextPluginStatus=wo,e.getReferrer=Kt,e.getVideo=Dt,e.identity=Dc,e.invert=Zf,e.isChar=rr,e.isMapboxURL=De,e.keysDifference=c,e.makeRequest=$e,e.mapObject=k,e.mercatorXfromLng=o0,e.mercatorYfromLat=s0,e.mercatorZfromAltitude=l0,e.mul=Qv,e.multiply=jf,e.mvt=Ic,e.normalize=xh,e.number=mo,e.offscreenCanvasSupported=Kr,e.ortho=Kv,e.parseGlyphPBF=u1,e.pbf=tv,e.performSymbolLayout=E1,e.perspective=mh,e.pick=_,e.plugin=Ka,e.polygonIntersectsPolygon=ui,e.postMapLoadEvent=Ct,e.postTurnstileEvent=Wt,e.potpack=Ld,e.refProperties=rx,e.register=Ue,e.registerForPluginStateChange=Gi,e.rotate=js,e.rotateX=Tl,e.rotateZ=Lc,e.scale=wl,e.scale$1=gy,e.scale$2=ep,e.setCacheLimits=Hr,e.setRTLTextPlugin=va,e.sphericalToCartesian=H,e.sqrLen=by,e.styleSpec=Gt,e.sub=py,e.symbolSize=m1,e.transformMat3=vy,e.transformMat4=Jh,e.translate=Ho,e.triggerPluginCompletionEvent=Ra,e.uniqueId=w,e.validateCustomStyleLayer=Y1,e.validateLight=Ci,e.validateStyle=Ro,e.values=b,e.vectorTile=Ic,e.version=n,e.warnOnce=O,e.webpSupported=le,e.window=self,e.wrap=x}),T(["./shared"],function(e){function i(et){var $e=typeof et;if($e==="number"||$e==="boolean"||$e==="string"||et===void 0||et===null)return JSON.stringify(et);if(Array.isArray(et)){for(var st="[",ft=0,St=et;ft<St.length;ft+=1){var Ut=St[ft];st+=i(Ut)+","}return st+"]"}for(var Pe=Object.keys(et).sort(),ke="{",it=0;it<Pe.length;it++)ke+=JSON.stringify(Pe[it])+":"+i(et[Pe[it]])+",";return ke+"}"}function n(et){for(var $e="",st=0,ft=e.refProperties;st<ft.length;st+=1){var St=ft[st];$e+="/"+i(et[St])}return $e}function a(et,$e){for(var st={},ft=0;ft<et.length;ft++){var St=$e&&$e[et[ft].id]||n(et[ft]);$e&&($e[et[ft].id]=St);var Ut=st[St];Ut||(Ut=st[St]=[]),Ut.push(et[ft])}var Pe=[];for(var ke in st)Pe.push(st[ke]);return Pe}var r=function($e){this.keyCache={},$e&&this.replace($e)};r.prototype.replace=function($e){this._layerConfigs={},this._layers={},this.update($e,[])},r.prototype.update=function($e,st){for(var ft=this,St=0,Ut=$e;St<Ut.length;St+=1){var Pe=Ut[St];this._layerConfigs[Pe.id]=Pe;var ke=this._layers[Pe.id]=e.createStyleLayer(Pe);ke._featureFilter=e.featureFilter(ke.filter),this.keyCache[Pe.id]&&delete this.keyCache[Pe.id]}for(var it=0,ut=st;it<ut.length;it+=1){var ht=ut[it];delete this.keyCache[ht],delete this._layerConfigs[ht],delete this._layers[ht]}this.familiesBySource={};for(var Et=a(e.values(this._layerConfigs),this.keyCache),yt=0,Dt=Et;yt<Dt.length;yt+=1){var Xt=Dt[yt],ar=Xt.map(function(xr){return ft._layers[xr.id]}),kr=ar[0];if(kr.visibility!=="none"){var wr=kr.source||"",Sr=this.familiesBySource[wr];Sr||(Sr=this.familiesBySource[wr]={});var Zr=kr.sourceLayer||"_geojsonTileLayer",ir=Sr[Zr];ir||(ir=Sr[Zr]=[]),ir.push(ar)}}};var f=1,o=function($e){var st={},ft=[];for(var St in $e){var Ut=$e[St],Pe=st[St]={};for(var ke in Ut){var it=Ut[+ke];if(!(!it||it.bitmap.width===0||it.bitmap.height===0)){var ut={x:0,y:0,w:it.bitmap.width+2*f,h:it.bitmap.height+2*f};ft.push(ut),Pe[ke]={rect:ut,metrics:it.metrics}}}}var ht=e.potpack(ft),Et=ht.w,yt=ht.h,Dt=new e.AlphaImage({width:Et||1,height:yt||1});for(var Xt in $e){var ar=$e[Xt];for(var kr in ar){var wr=ar[+kr];if(!(!wr||wr.bitmap.width===0||wr.bitmap.height===0)){var Sr=st[Xt][kr].rect;e.AlphaImage.copy(wr.bitmap,Dt,{x:0,y:0},{x:Sr.x+f,y:Sr.y+f},wr.bitmap)}}}this.image=Dt,this.positions=st};e.register("GlyphAtlas",o);var s=function($e){this.tileID=new e.OverscaledTileID($e.tileID.overscaledZ,$e.tileID.wrap,$e.tileID.canonical.z,$e.tileID.canonical.x,$e.tileID.canonical.y),this.uid=$e.uid,this.zoom=$e.zoom,this.pixelRatio=$e.pixelRatio,this.tileSize=$e.tileSize,this.source=$e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=$e.showCollisionBoxes,this.collectResourceTiming=!!$e.collectResourceTiming,this.returnDependencies=!!$e.returnDependencies,this.promoteId=$e.promoteId};s.prototype.parse=function($e,st,ft,St,Ut){var Pe=this;this.status="parsing",this.data=$e,this.collisionBoxArray=new e.CollisionBoxArray;var ke=new e.DictionaryCoder(Object.keys($e.layers).sort()),it=new e.FeatureIndex(this.tileID,this.promoteId);it.bucketLayerIDs=[];var ut={},ht={featureIndex:it,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ft},Et=st.familiesBySource[this.source];for(var yt in Et){var Dt=$e.layers[yt];if(!!Dt){Dt.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+yt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Xt=ke.encode(yt),ar=[],kr=0;kr<Dt.length;kr++){var wr=Dt.feature(kr),Sr=it.getId(wr,yt);ar.push({feature:wr,id:Sr,index:kr,sourceLayerIndex:Xt})}for(var Zr=0,ir=Et[yt];Zr<ir.length;Zr+=1){var xr=ir[Zr],Fr=xr[0];if(!(Fr.minzoom&&this.zoom<Math.floor(Fr.minzoom))&&!(Fr.maxzoom&&this.zoom>=Fr.maxzoom)&&Fr.visibility!=="none"){m(xr,this.zoom,ft);var Or=ut[Fr.id]=Fr.createBucket({index:it.bucketLayerIDs.length,layers:xr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Xt,sourceID:this.source});Or.populate(ar,ht,this.tileID.canonical),it.bucketLayerIDs.push(xr.map(function(Tr){return Tr.id}))}}}}var Cr,at,Ft,jt,sr=e.mapObject(ht.glyphDependencies,function(Tr){return Object.keys(Tr).map(Number)});Object.keys(sr).length?St.send("getGlyphs",{uid:this.uid,stacks:sr},function(Tr,Wr){Cr||(Cr=Tr,at=Wr,Dr.call(Pe))}):at={};var zr=Object.keys(ht.iconDependencies);zr.length?St.send("getImages",{icons:zr,source:this.source,tileID:this.tileID,type:"icons"},function(Tr,Wr){Cr||(Cr=Tr,Ft=Wr,Dr.call(Pe))}):Ft={};var Ur=Object.keys(ht.patternDependencies);Ur.length?St.send("getImages",{icons:Ur,source:this.source,tileID:this.tileID,type:"patterns"},function(Tr,Wr){Cr||(Cr=Tr,jt=Wr,Dr.call(Pe))}):jt={},Dr.call(this);function Dr(){if(Cr)return Ut(Cr);if(at&&Ft&&jt){var Tr=new o(at),Wr=new e.ImageAtlas(Ft,jt);for(var An in ut){var vn=ut[An];vn instanceof e.SymbolBucket?(m(vn.layers,this.zoom,ft),e.performSymbolLayout(vn,at,Tr.positions,Ft,Wr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):vn.hasPattern&&(vn instanceof e.LineBucket||vn instanceof e.FillBucket||vn instanceof e.FillExtrusionBucket)&&(m(vn.layers,this.zoom,ft),vn.addFeatures(ht,this.tileID.canonical,Wr.patternPositions))}this.status="done",Ut(null,{buckets:e.values(ut).filter(function(Un){return!Un.isEmpty()}),featureIndex:it,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Tr.image,imageAtlas:Wr,glyphMap:this.returnDependencies?at:null,iconMap:this.returnDependencies?Ft:null,glyphPositions:this.returnDependencies?Tr.positions:null})}}};function m(et,$e,st){for(var ft=new e.EvaluationParameters($e),St=0,Ut=et;St<Ut.length;St+=1){var Pe=Ut[St];Pe.recalculate(ft,st)}}function g(et,$e){var st=e.getArrayBuffer(et.request,function(ft,St,Ut,Pe){ft?$e(ft):St&&$e(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(St)),rawData:St,cacheControl:Ut,expires:Pe})});return function(){st.cancel(),$e()}}var p=function($e,st,ft,St){this.actor=$e,this.layerIndex=st,this.availableImages=ft,this.loadVectorData=St||g,this.loading={},this.loaded={}};p.prototype.loadTile=function($e,st){var ft=this,St=$e.uid;this.loading||(this.loading={});var Ut=$e&&$e.request&&$e.request.collectResourceTiming?new e.RequestPerformance($e.request):!1,Pe=this.loading[St]=new s($e);Pe.abort=this.loadVectorData($e,function(ke,it){if(delete ft.loading[St],ke||!it)return Pe.status="done",ft.loaded[St]=Pe,st(ke);var ut=it.rawData,ht={};it.expires&&(ht.expires=it.expires),it.cacheControl&&(ht.cacheControl=it.cacheControl);var Et={};if(Ut){var yt=Ut.finish();yt&&(Et.resourceTiming=JSON.parse(JSON.stringify(yt)))}Pe.vectorTile=it.vectorTile,Pe.parse(it.vectorTile,ft.layerIndex,ft.availableImages,ft.actor,function(Dt,Xt){if(Dt||!Xt)return st(Dt);st(null,e.extend({rawTileData:ut.slice(0)},Xt,ht,Et))}),ft.loaded=ft.loaded||{},ft.loaded[St]=Pe})},p.prototype.reloadTile=function($e,st){var ft=this,St=this.loaded,Ut=$e.uid,Pe=this;if(St&&St[Ut]){var ke=St[Ut];ke.showCollisionBoxes=$e.showCollisionBoxes;var it=function(ut,ht){var Et=ke.reloadCallback;Et&&(delete ke.reloadCallback,ke.parse(ke.vectorTile,Pe.layerIndex,ft.availableImages,Pe.actor,Et)),st(ut,ht)};ke.status==="parsing"?ke.reloadCallback=it:ke.status==="done"&&(ke.vectorTile?ke.parse(ke.vectorTile,this.layerIndex,this.availableImages,this.actor,it):it())}},p.prototype.abortTile=function($e,st){var ft=this.loading,St=$e.uid;ft&&ft[St]&&ft[St].abort&&(ft[St].abort(),delete ft[St]),st()},p.prototype.removeTile=function($e,st){var ft=this.loaded,St=$e.uid;ft&&ft[St]&&delete ft[St],st()};var v=e.window.ImageBitmap,x=function(){this.loaded={}};x.prototype.loadTile=function($e,st){var ft=$e.uid,St=$e.encoding,Ut=$e.rawImageData,Pe=v&&Ut instanceof v?this.getImageData(Ut):Ut,ke=new e.DEMData(ft,Pe,St);this.loaded=this.loaded||{},this.loaded[ft]=ke,st(null,ke)},x.prototype.getImageData=function($e){(!this.offscreenCanvas||!this.offscreenCanvasContext)&&(this.offscreenCanvas=new OffscreenCanvas($e.width,$e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=$e.width,this.offscreenCanvas.height=$e.height,this.offscreenCanvasContext.drawImage($e,0,0,$e.width,$e.height);var st=this.offscreenCanvasContext.getImageData(-1,-1,$e.width+2,$e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:st.width,height:st.height},st.data)},x.prototype.removeTile=function($e){var st=this.loaded,ft=$e.uid;st&&st[ft]&&delete st[ft]};var l=b;function b(et,$e){var st=et&&et.type,ft;if(st==="FeatureCollection")for(ft=0;ft<et.features.length;ft++)b(et.features[ft],$e);else if(st==="GeometryCollection")for(ft=0;ft<et.geometries.length;ft++)b(et.geometries[ft],$e);else if(st==="Feature")b(et.geometry,$e);else if(st==="Polygon")c(et.coordinates,$e);else if(st==="MultiPolygon")for(ft=0;ft<et.coordinates.length;ft++)c(et.coordinates[ft],$e);return et}function c(et,$e){if(et.length!==0){M(et[0],$e);for(var st=1;st<et.length;st++)M(et[st],!$e)}}function M(et,$e){for(var st=0,ft=0,St=et.length,Ut=St-1;ft<St;Ut=ft++)st+=(et[ft][0]-et[Ut][0])*(et[Ut][1]+et[ft][1]);st>=0!=!!$e&&et.reverse()}var _=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,y=function($e){this._feature=$e,this.extent=e.EXTENT,this.type=$e.type,this.properties=$e.tags,"id"in $e&&!isNaN($e.id)&&(this.id=parseInt($e.id,10))};y.prototype.loadGeometry=function(){if(this._feature.type===1){for(var $e=[],st=0,ft=this._feature.geometry;st<ft.length;st+=1){var St=ft[st];$e.push([new e.Point$1(St[0],St[1])])}return $e}else{for(var Ut=[],Pe=0,ke=this._feature.geometry;Pe<ke.length;Pe+=1){for(var it=ke[Pe],ut=[],ht=0,Et=it;ht<Et.length;ht+=1){var yt=Et[ht];ut.push(new e.Point$1(yt[0],yt[1]))}Ut.push(ut)}return Ut}},y.prototype.toGeoJSON=function($e,st,ft){return _.call(this,$e,st,ft)};var w=function($e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=$e.length,this._features=$e};w.prototype.feature=function($e){return new y(this._features[$e])};var d=e.vectorTile.VectorTileFeature,C=S;function S(et,$e){this.options=$e||{},this.features=et,this.length=et.length}S.prototype.feature=function(et){return new E(this.features[et],this.options.extent)};function E(et,$e){this.id=typeof et.id=="number"?et.id:void 0,this.type=et.type,this.rawGeometry=et.type===1?[et.geometry]:et.geometry,this.properties=et.tags,this.extent=$e||4096}E.prototype.loadGeometry=function(){var et=this.rawGeometry;this.geometry=[];for(var $e=0;$e<et.length;$e++){for(var st=et[$e],ft=[],St=0;St<st.length;St++)ft.push(new e.Point$1(st[St][0],st[St][1]));this.geometry.push(ft)}return this.geometry},E.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var et=this.geometry,$e=1/0,st=-1/0,ft=1/0,St=-1/0,Ut=0;Ut<et.length;Ut++)for(var Pe=et[Ut],ke=0;ke<Pe.length;ke++){var it=Pe[ke];$e=Math.min($e,it.x),st=Math.max(st,it.x),ft=Math.min(ft,it.y),St=Math.max(St,it.y)}return[$e,ft,st,St]},E.prototype.toGeoJSON=d.prototype.toGeoJSON;var k=I,B=I,z=O,F=C;function I(et){var $e=new e.pbf;return N(et,$e),$e.finish()}function O(et,$e){$e=$e||{};var st={};for(var ft in et)st[ft]=new C(et[ft].features,$e),st[ft].name=ft,st[ft].version=$e.version,st[ft].extent=$e.extent;return I({layers:st})}function N(et,$e){for(var st in et.layers)$e.writeMessage(3,V,et.layers[st])}function V(et,$e){$e.writeVarintField(15,et.version||1),$e.writeStringField(1,et.name||""),$e.writeVarintField(5,et.extent||4096);var st,ft={keys:[],values:[],keycache:{},valuecache:{}};for(st=0;st<et.length;st++)ft.feature=et.feature(st),$e.writeMessage(2,H,ft);var St=ft.keys;for(st=0;st<St.length;st++)$e.writeStringField(3,St[st]);var Ut=ft.values;for(st=0;st<Ut.length;st++)$e.writeMessage(4,ue,Ut[st])}function H(et,$e){var st=et.feature;st.id!==void 0&&$e.writeVarintField(1,st.id),$e.writeMessage(2,j,et),$e.writeVarintField(3,st.type),$e.writeMessage(4,re,st)}function j(et,$e){var st=et.feature,ft=et.keys,St=et.values,Ut=et.keycache,Pe=et.valuecache;for(var ke in st.properties){var it=Ut[ke];typeof it>"u"&&(ft.push(ke),it=ft.length-1,Ut[ke]=it),$e.writeVarint(it);var ut=st.properties[ke],ht=typeof ut;ht!=="string"&&ht!=="boolean"&&ht!=="number"&&(ut=JSON.stringify(ut));var Et=ht+":"+ut,yt=Pe[Et];typeof yt>"u"&&(St.push(ut),yt=St.length-1,Pe[Et]=yt),$e.writeVarint(yt)}}function Z(et,$e){return($e<<3)+(et&7)}function X(et){return et<<1^et>>31}function re(et,$e){for(var st=et.loadGeometry(),ft=et.type,St=0,Ut=0,Pe=st.length,ke=0;ke<Pe;ke++){var it=st[ke],ut=1;ft===1&&(ut=it.length),$e.writeVarint(Z(1,ut));for(var ht=ft===3?it.length-1:it.length,Et=0;Et<ht;Et++){Et===1&&ft!==1&&$e.writeVarint(Z(2,ht-1));var yt=it[Et].x-St,Dt=it[Et].y-Ut;$e.writeVarint(X(yt)),$e.writeVarint(X(Dt)),St+=yt,Ut+=Dt}ft===3&&$e.writeVarint(Z(7,1))}}function ue(et,$e){var st=typeof et;st==="string"?$e.writeStringField(1,et):st==="boolean"?$e.writeBooleanField(7,et):st==="number"&&(et%1!==0?$e.writeDoubleField(3,et):et<0?$e.writeSVarintField(6,et):$e.writeVarintField(5,et))}k.fromVectorTileJs=B,k.fromGeojsonVt=z,k.GeoJSONWrapper=F;function K(et,$e,st,ft,St,Ut){if(!(St-ft<=st)){var Pe=ft+St>>1;te(et,$e,Pe,ft,St,Ut%2),K(et,$e,st,ft,Pe-1,Ut+1),K(et,$e,st,Pe+1,St,Ut+1)}}function te(et,$e,st,ft,St,Ut){for(;St>ft;){if(St-ft>600){var Pe=St-ft+1,ke=st-ft+1,it=Math.log(Pe),ut=.5*Math.exp(2*it/3),ht=.5*Math.sqrt(it*ut*(Pe-ut)/Pe)*(ke-Pe/2<0?-1:1),Et=Math.max(ft,Math.floor(st-ke*ut/Pe+ht)),yt=Math.min(St,Math.floor(st+(Pe-ke)*ut/Pe+ht));te(et,$e,st,Et,yt,Ut)}var Dt=$e[2*st+Ut],Xt=ft,ar=St;for(G(et,$e,ft,st),$e[2*St+Ut]>Dt&&G(et,$e,ft,St);Xt<ar;){for(G(et,$e,Xt,ar),Xt++,ar--;$e[2*Xt+Ut]<Dt;)Xt++;for(;$e[2*ar+Ut]>Dt;)ar--}$e[2*ft+Ut]===Dt?G(et,$e,ft,ar):(ar++,G(et,$e,ar,St)),ar<=st&&(ft=ar+1),st<=ar&&(St=ar-1)}}function G(et,$e,st,ft){Y(et,st,ft),Y($e,2*st,2*ft),Y($e,2*st+1,2*ft+1)}function Y(et,$e,st){var ft=et[$e];et[$e]=et[st],et[st]=ft}function ee(et,$e,st,ft,St,Ut,Pe){for(var ke=[0,et.length-1,0],it=[],ut,ht;ke.length;){var Et=ke.pop(),yt=ke.pop(),Dt=ke.pop();if(yt-Dt<=Pe){for(var Xt=Dt;Xt<=yt;Xt++)ut=$e[2*Xt],ht=$e[2*Xt+1],ut>=st&&ut<=St&&ht>=ft&&ht<=Ut&&it.push(et[Xt]);continue}var ar=Math.floor((Dt+yt)/2);ut=$e[2*ar],ht=$e[2*ar+1],ut>=st&&ut<=St&&ht>=ft&&ht<=Ut&&it.push(et[ar]);var kr=(Et+1)%2;(Et===0?st<=ut:ft<=ht)&&(ke.push(Dt),ke.push(ar-1),ke.push(kr)),(Et===0?St>=ut:Ut>=ht)&&(ke.push(ar+1),ke.push(yt),ke.push(kr))}return it}function ne(et,$e,st,ft,St,Ut){for(var Pe=[0,et.length-1,0],ke=[],it=St*St;Pe.length;){var ut=Pe.pop(),ht=Pe.pop(),Et=Pe.pop();if(ht-Et<=Ut){for(var yt=Et;yt<=ht;yt++)J($e[2*yt],$e[2*yt+1],st,ft)<=it&&ke.push(et[yt]);continue}var Dt=Math.floor((Et+ht)/2),Xt=$e[2*Dt],ar=$e[2*Dt+1];J(Xt,ar,st,ft)<=it&&ke.push(et[Dt]);var kr=(ut+1)%2;(ut===0?st-St<=Xt:ft-St<=ar)&&(Pe.push(Et),Pe.push(Dt-1),Pe.push(kr)),(ut===0?st+St>=Xt:ft+St>=ar)&&(Pe.push(Dt+1),Pe.push(ht),Pe.push(kr))}return ke}function J(et,$e,st,ft){var St=et-st,Ut=$e-ft;return St*St+Ut*Ut}var q=function(et){return et[0]},ae=function(et){return et[1]},le=function($e,st,ft,St,Ut){st===void 0&&(st=q),ft===void 0&&(ft=ae),St===void 0&&(St=64),Ut===void 0&&(Ut=Float64Array),this.nodeSize=St,this.points=$e;for(var Pe=$e.length<65536?Uint16Array:Uint32Array,ke=this.ids=new Pe($e.length),it=this.coords=new Ut($e.length*2),ut=0;ut<$e.length;ut++)ke[ut]=ut,it[2*ut]=st($e[ut]),it[2*ut+1]=ft($e[ut]);K(ke,it,St,0,ke.length-1,0)};le.prototype.range=function($e,st,ft,St){return ee(this.ids,this.coords,$e,st,ft,St,this.nodeSize)},le.prototype.within=function($e,st,ft){return ne(this.ids,this.coords,$e,st,ft,this.nodeSize)};var ie={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(et){return et}},se=function($e){this.options=Ie(Object.create(ie),$e),this.trees=new Array(this.options.maxZoom+1)};se.prototype.load=function($e){var st=this.options,ft=st.log,St=st.minZoom,Ut=st.maxZoom,Pe=st.nodeSize;ft&&console.time("total time");var ke="prepare "+$e.length+" points";ft&&console.time(ke),this.points=$e;for(var it=[],ut=0;ut<$e.length;ut++)!$e[ut].geometry||it.push(oe($e[ut],ut));this.trees[Ut+1]=new le(it,Te,Ce,Pe,Float32Array),ft&&console.timeEnd(ke);for(var ht=Ut;ht>=St;ht--){var Et=+Date.now();it=this._cluster(it,ht),this.trees[ht]=new le(it,Te,Ce,Pe,Float32Array),ft&&console.log("z%d: %d clusters in %dms",ht,it.length,+Date.now()-Et)}return ft&&console.timeEnd("total time"),this},se.prototype.getClusters=function($e,st){var ft=(($e[0]+180)%360+360)%360-180,St=Math.max(-90,Math.min(90,$e[1])),Ut=$e[2]===180?180:(($e[2]+180)%360+360)%360-180,Pe=Math.max(-90,Math.min(90,$e[3]));if($e[2]-$e[0]>=360)ft=-180,Ut=180;else if(ft>Ut){var ke=this.getClusters([ft,St,180,Pe],st),it=this.getClusters([-180,St,Ut,Pe],st);return ke.concat(it)}for(var ut=this.trees[this._limitZoom(st)],ht=ut.range(me(ft),_e(Pe),me(Ut),_e(St)),Et=[],yt=0,Dt=ht;yt<Dt.length;yt+=1){var Xt=Dt[yt],ar=ut.points[Xt];Et.push(ar.numPoints?he(ar):this.points[ar.index])}return Et},se.prototype.getChildren=function($e){var st=this._getOriginId($e),ft=this._getOriginZoom($e),St="No cluster with the specified id.",Ut=this.trees[ft];if(!Ut)throw new Error(St);var Pe=Ut.points[st];if(!Pe)throw new Error(St);for(var ke=this.options.radius/(this.options.extent*Math.pow(2,ft-1)),it=Ut.within(Pe.x,Pe.y,ke),ut=[],ht=0,Et=it;ht<Et.length;ht+=1){var yt=Et[ht],Dt=Ut.points[yt];Dt.parentId===$e&&ut.push(Dt.numPoints?he(Dt):this.points[Dt.index])}if(ut.length===0)throw new Error(St);return ut},se.prototype.getLeaves=function($e,st,ft){st=st||10,ft=ft||0;var St=[];return this._appendLeaves(St,$e,st,ft,0),St},se.prototype.getTile=function($e,st,ft){var St=this.trees[this._limitZoom($e)],Ut=Math.pow(2,$e),Pe=this.options,ke=Pe.extent,it=Pe.radius,ut=it/ke,ht=(ft-ut)/Ut,Et=(ft+1+ut)/Ut,yt={features:[]};return this._addTileFeatures(St.range((st-ut)/Ut,ht,(st+1+ut)/Ut,Et),St.points,st,ft,Ut,yt),st===0&&this._addTileFeatures(St.range(1-ut/Ut,ht,1,Et),St.points,Ut,ft,Ut,yt),st===Ut-1&&this._addTileFeatures(St.range(0,ht,ut/Ut,Et),St.points,-1,ft,Ut,yt),yt.features.length?yt:null},se.prototype.getClusterExpansionZoom=function($e){for(var st=this._getOriginZoom($e)-1;st<=this.options.maxZoom;){var ft=this.getChildren($e);if(st++,ft.length!==1)break;$e=ft[0].properties.cluster_id}return st},se.prototype._appendLeaves=function($e,st,ft,St,Ut){for(var Pe=this.getChildren(st),ke=0,it=Pe;ke<it.length;ke+=1){var ut=it[ke],ht=ut.properties;if(ht&&ht.cluster?Ut+ht.point_count<=St?Ut+=ht.point_count:Ut=this._appendLeaves($e,ht.cluster_id,ft,St,Ut):Ut<St?Ut++:$e.push(ut),$e.length===ft)break}return Ut},se.prototype._addTileFeatures=function($e,st,ft,St,Ut,Pe){for(var ke=0,it=$e;ke<it.length;ke+=1){var ut=it[ke],ht=st[ut],Et=ht.numPoints,yt={type:1,geometry:[[Math.round(this.options.extent*(ht.x*Ut-ft)),Math.round(this.options.extent*(ht.y*Ut-St))]],tags:Et?be(ht):this.points[ht.index].properties},Dt=void 0;Et?Dt=ht.id:this.options.generateId?Dt=ht.index:this.points[ht.index].id&&(Dt=this.points[ht.index].id),Dt!==void 0&&(yt.id=Dt),Pe.features.push(yt)}},se.prototype._limitZoom=function($e){return Math.max(this.options.minZoom,Math.min($e,this.options.maxZoom+1))},se.prototype._cluster=function($e,st){for(var ft=[],St=this.options,Ut=St.radius,Pe=St.extent,ke=St.reduce,it=Ut/(Pe*Math.pow(2,st)),ut=0;ut<$e.length;ut++){var ht=$e[ut];if(!(ht.zoom<=st)){ht.zoom=st;for(var Et=this.trees[st+1],yt=Et.within(ht.x,ht.y,it),Dt=ht.numPoints||1,Xt=ht.x*Dt,ar=ht.y*Dt,kr=ke&&Dt>1?this._map(ht,!0):null,wr=(ut<<5)+(st+1)+this.points.length,Sr=0,Zr=yt;Sr<Zr.length;Sr+=1){var ir=Zr[Sr],xr=Et.points[ir];if(!(xr.zoom<=st)){xr.zoom=st;var Fr=xr.numPoints||1;Xt+=xr.x*Fr,ar+=xr.y*Fr,Dt+=Fr,xr.parentId=wr,ke&&(kr||(kr=this._map(ht,!0)),ke(kr,this._map(xr)))}}Dt===1?ft.push(ht):(ht.parentId=wr,ft.push(xe(Xt/Dt,ar/Dt,wr,Dt,kr)))}}return ft},se.prototype._getOriginId=function($e){return $e-this.points.length>>5},se.prototype._getOriginZoom=function($e){return($e-this.points.length)%32},se.prototype._map=function($e,st){if($e.numPoints)return st?Ie({},$e.properties):$e.properties;var ft=this.points[$e.index].properties,St=this.options.map(ft);return st&&St===ft?Ie({},St):St};function xe(et,$e,st,ft,St){return{x:et,y:$e,zoom:1/0,id:st,parentId:-1,numPoints:ft,properties:St}}function oe(et,$e){var st=et.geometry.coordinates,ft=st[0],St=st[1];return{x:me(ft),y:_e(St),zoom:1/0,index:$e,parentId:-1}}function he(et){return{type:"Feature",id:et.id,properties:be(et),geometry:{type:"Point",coordinates:[Se(et.x),De(et.y)]}}}function be(et){var $e=et.numPoints,st=$e>=1e4?Math.round($e/1e3)+"k":$e>=1e3?Math.round($e/100)/10+"k":$e;return Ie(Ie({},et.properties),{cluster:!0,cluster_id:et.id,point_count:$e,point_count_abbreviated:st})}function me(et){return et/360+.5}function _e(et){var $e=Math.sin(et*Math.PI/180),st=.5-.25*Math.log((1+$e)/(1-$e))/Math.PI;return st<0?0:st>1?1:st}function Se(et){return(et-.5)*360}function De(et){var $e=(180-et*360)*Math.PI/180;return 360*Math.atan(Math.exp($e))/Math.PI-90}function Ie(et,$e){for(var st in $e)et[st]=$e[st];return et}function Te(et){return et.x}function Ce(et){return et.y}function He(et,$e,st,ft){for(var St=ft,Ut=st-$e>>1,Pe=st-$e,ke,it=et[$e],ut=et[$e+1],ht=et[st],Et=et[st+1],yt=$e+3;yt<st;yt+=3){var Dt=Xe(et[yt],et[yt+1],it,ut,ht,Et);if(Dt>St)ke=yt,St=Dt;else if(Dt===St){var Xt=Math.abs(yt-Ut);Xt<Pe&&(ke=yt,Pe=Xt)}}St>ft&&(ke-$e>3&&He(et,$e,ke,ft),et[ke+2]=St,st-ke>3&&He(et,ke,st,ft))}function Xe(et,$e,st,ft,St,Ut){var Pe=St-st,ke=Ut-ft;if(Pe!==0||ke!==0){var it=((et-st)*Pe+($e-ft)*ke)/(Pe*Pe+ke*ke);it>1?(st=St,ft=Ut):it>0&&(st+=Pe*it,ft+=ke*it)}return Pe=et-st,ke=$e-ft,Pe*Pe+ke*ke}function Be(et,$e,st,ft){var St={id:typeof et>"u"?null:et,type:$e,geometry:st,tags:ft,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return Re(St),St}function Re(et){var $e=et.geometry,st=et.type;if(st==="Point"||st==="MultiPoint"||st==="LineString")We(et,$e);else if(st==="Polygon"||st==="MultiLineString")for(var ft=0;ft<$e.length;ft++)We(et,$e[ft]);else if(st==="MultiPolygon")for(ft=0;ft<$e.length;ft++)for(var St=0;St<$e[ft].length;St++)We(et,$e[ft][St])}function We(et,$e){for(var st=0;st<$e.length;st+=3)et.minX=Math.min(et.minX,$e[st]),et.minY=Math.min(et.minY,$e[st+1]),et.maxX=Math.max(et.maxX,$e[st]),et.maxY=Math.max(et.maxY,$e[st+1])}function vt(et,$e){var st=[];if(et.type==="FeatureCollection")for(var ft=0;ft<et.features.length;ft++)Pt(st,et.features[ft],$e,ft);else et.type==="Feature"?Pt(st,et,$e):Pt(st,{geometry:et},$e);return st}function Pt(et,$e,st,ft){if(!!$e.geometry){var St=$e.geometry.coordinates,Ut=$e.geometry.type,Pe=Math.pow(st.tolerance/((1<<st.maxZoom)*st.extent),2),ke=[],it=$e.id;if(st.promoteId?it=$e.properties[st.promoteId]:st.generateId&&(it=ft||0),Ut==="Point")Zt(St,ke);else if(Ut==="MultiPoint")for(var ut=0;ut<St.length;ut++)Zt(St[ut],ke);else if(Ut==="LineString")zt(St,ke,Pe,!1);else if(Ut==="MultiLineString")if(st.lineMetrics){for(ut=0;ut<St.length;ut++)ke=[],zt(St[ut],ke,Pe,!1),et.push(Be(it,"LineString",ke,$e.properties));return}else At(St,ke,Pe,!1);else if(Ut==="Polygon")At(St,ke,Pe,!0);else if(Ut==="MultiPolygon")for(ut=0;ut<St.length;ut++){var ht=[];At(St[ut],ht,Pe,!0),ke.push(ht)}else if(Ut==="GeometryCollection"){for(ut=0;ut<$e.geometry.geometries.length;ut++)Pt(et,{id:it,geometry:$e.geometry.geometries[ut],properties:$e.properties},st,ft);return}else throw new Error("Input data is not a valid GeoJSON object.");et.push(Be(it,Ut,ke,$e.properties))}}function Zt(et,$e){$e.push(Wt(et[0])),$e.push(Bt(et[1])),$e.push(0)}function zt(et,$e,st,ft){for(var St,Ut,Pe=0,ke=0;ke<et.length;ke++){var it=Wt(et[ke][0]),ut=Bt(et[ke][1]);$e.push(it),$e.push(ut),$e.push(0),ke>0&&(ft?Pe+=(St*ut-it*Ut)/2:Pe+=Math.sqrt(Math.pow(it-St,2)+Math.pow(ut-Ut,2))),St=it,Ut=ut}var ht=$e.length-3;$e[2]=1,He($e,0,ht,st),$e[ht+2]=1,$e.size=Math.abs(Pe),$e.start=0,$e.end=$e.size}function At(et,$e,st,ft){for(var St=0;St<et.length;St++){var Ut=[];zt(et[St],Ut,st,ft),$e.push(Ut)}}function Wt(et){return et/360+.5}function Bt(et){var $e=Math.sin(et*Math.PI/180),st=.5-.25*Math.log((1+$e)/(1-$e))/Math.PI;return st<0?0:st>1?1:st}function Ct(et,$e,st,ft,St,Ut,Pe,ke){if(st/=$e,ft/=$e,Ut>=st&&Pe<ft)return et;if(Pe<st||Ut>=ft)return null;for(var it=[],ut=0;ut<et.length;ut++){var ht=et[ut],Et=ht.geometry,yt=ht.type,Dt=St===0?ht.minX:ht.minY,Xt=St===0?ht.maxX:ht.maxY;if(Dt>=st&&Xt<ft){it.push(ht);continue}else if(Xt<st||Dt>=ft)continue;var ar=[];if(yt==="Point"||yt==="MultiPoint")Ze(Et,ar,st,ft,St);else if(yt==="LineString")nt(Et,ar,st,ft,St,!1,ke.lineMetrics);else if(yt==="MultiLineString")Ee(Et,ar,st,ft,St,!1);else if(yt==="Polygon")Ee(Et,ar,st,ft,St,!0);else if(yt==="MultiPolygon")for(var kr=0;kr<Et.length;kr++){var wr=[];Ee(Et[kr],wr,st,ft,St,!0),wr.length&&ar.push(wr)}if(ar.length){if(ke.lineMetrics&&yt==="LineString"){for(kr=0;kr<ar.length;kr++)it.push(Be(ht.id,yt,ar[kr],ht.tags));continue}(yt==="LineString"||yt==="MultiLineString")&&(ar.length===1?(yt="LineString",ar=ar[0]):yt="MultiLineString"),(yt==="Point"||yt==="MultiPoint")&&(yt=ar.length===3?"Point":"MultiPoint"),it.push(Be(ht.id,yt,ar,ht.tags))}}return it.length?it:null}function Ze(et,$e,st,ft,St){for(var Ut=0;Ut<et.length;Ut+=3){var Pe=et[Ut+St];Pe>=st&&Pe<=ft&&($e.push(et[Ut]),$e.push(et[Ut+1]),$e.push(et[Ut+2]))}}function nt(et,$e,st,ft,St,Ut,Pe){for(var ke=Ye(et),it=St===0?Je:qe,ut=et.start,ht,Et,yt=0;yt<et.length-3;yt+=3){var Dt=et[yt],Xt=et[yt+1],ar=et[yt+2],kr=et[yt+3],wr=et[yt+4],Sr=St===0?Dt:Xt,Zr=St===0?kr:wr,ir=!1;Pe&&(ht=Math.sqrt(Math.pow(Dt-kr,2)+Math.pow(Xt-wr,2))),Sr<st?Zr>st&&(Et=it(ke,Dt,Xt,kr,wr,st),Pe&&(ke.start=ut+ht*Et)):Sr>ft?Zr<ft&&(Et=it(ke,Dt,Xt,kr,wr,ft),Pe&&(ke.start=ut+ht*Et)):Ge(ke,Dt,Xt,ar),Zr<st&&Sr>=st&&(Et=it(ke,Dt,Xt,kr,wr,st),ir=!0),Zr>ft&&Sr<=ft&&(Et=it(ke,Dt,Xt,kr,wr,ft),ir=!0),!Ut&&ir&&(Pe&&(ke.end=ut+ht*Et),$e.push(ke),ke=Ye(et)),Pe&&(ut+=ht)}var xr=et.length-3;Dt=et[xr],Xt=et[xr+1],ar=et[xr+2],Sr=St===0?Dt:Xt,Sr>=st&&Sr<=ft&&Ge(ke,Dt,Xt,ar),xr=ke.length-3,Ut&&xr>=3&&(ke[xr]!==ke[0]||ke[xr+1]!==ke[1])&&Ge(ke,ke[0],ke[1],ke[2]),ke.length&&$e.push(ke)}function Ye(et){var $e=[];return $e.size=et.size,$e.start=et.start,$e.end=et.end,$e}function Ee(et,$e,st,ft,St,Ut){for(var Pe=0;Pe<et.length;Pe++)nt(et[Pe],$e,st,ft,St,Ut,!1)}function Ge(et,$e,st,ft){et.push($e),et.push(st),et.push(ft)}function Je(et,$e,st,ft,St,Ut){var Pe=(Ut-$e)/(ft-$e);return et.push(Ut),et.push(st+(St-st)*Pe),et.push(1),Pe}function qe(et,$e,st,ft,St,Ut){var Pe=(Ut-st)/(St-st);return et.push($e+(ft-$e)*Pe),et.push(Ut),et.push(1),Pe}function Tt(et,$e){var st=$e.buffer/$e.extent,ft=et,St=Ct(et,1,-1-st,st,0,-1,2,$e),Ut=Ct(et,1,1-st,2+st,0,-1,2,$e);return(St||Ut)&&(ft=Ct(et,1,-st,1+st,0,-1,2,$e)||[],St&&(ft=mt(St,1).concat(ft)),Ut&&(ft=ft.concat(mt(Ut,-1)))),ft}function mt(et,$e){for(var st=[],ft=0;ft<et.length;ft++){var St=et[ft],Ut=St.type,Pe;if(Ut==="Point"||Ut==="MultiPoint"||Ut==="LineString")Pe=Mt(St.geometry,$e);else if(Ut==="MultiLineString"||Ut==="Polygon"){Pe=[];for(var ke=0;ke<St.geometry.length;ke++)Pe.push(Mt(St.geometry[ke],$e))}else if(Ut==="MultiPolygon")for(Pe=[],ke=0;ke<St.geometry.length;ke++){for(var it=[],ut=0;ut<St.geometry[ke].length;ut++)it.push(Mt(St.geometry[ke][ut],$e));Pe.push(it)}st.push(Be(St.id,Ut,Pe,St.tags))}return st}function Mt(et,$e){var st=[];st.size=et.size,et.start!==void 0&&(st.start=et.start,st.end=et.end);for(var ft=0;ft<et.length;ft+=3)st.push(et[ft]+$e,et[ft+1],et[ft+2]);return st}function Ht(et,$e){if(et.transformed)return et;var st=1<<et.z,ft=et.x,St=et.y,Ut,Pe,ke;for(Ut=0;Ut<et.features.length;Ut++){var it=et.features[Ut],ut=it.geometry,ht=it.type;if(it.geometry=[],ht===1)for(Pe=0;Pe<ut.length;Pe+=2)it.geometry.push(Rt(ut[Pe],ut[Pe+1],$e,st,ft,St));else for(Pe=0;Pe<ut.length;Pe++){var Et=[];for(ke=0;ke<ut[Pe].length;ke+=2)Et.push(Rt(ut[Pe][ke],ut[Pe][ke+1],$e,st,ft,St));it.geometry.push(Et)}}return et.transformed=!0,et}function Rt(et,$e,st,ft,St,Ut){return[Math.round(st*(et*ft-St)),Math.round(st*($e*ft-Ut))]}function Vt(et,$e,st,ft,St){for(var Ut=$e===St.maxZoom?0:St.tolerance/((1<<$e)*St.extent),Pe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:st,y:ft,z:$e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ke=0;ke<et.length;ke++){Pe.numFeatures++,Jt(Pe,et[ke],Ut,St);var it=et[ke].minX,ut=et[ke].minY,ht=et[ke].maxX,Et=et[ke].maxY;it<Pe.minX&&(Pe.minX=it),ut<Pe.minY&&(Pe.minY=ut),ht>Pe.maxX&&(Pe.maxX=ht),Et>Pe.maxY&&(Pe.maxY=Et)}return Pe}function Jt(et,$e,st,ft){var St=$e.geometry,Ut=$e.type,Pe=[];if(Ut==="Point"||Ut==="MultiPoint")for(var ke=0;ke<St.length;ke+=3)Pe.push(St[ke]),Pe.push(St[ke+1]),et.numPoints++,et.numSimplified++;else if(Ut==="LineString")Yt(Pe,St,et,st,!1,!1);else if(Ut==="MultiLineString"||Ut==="Polygon")for(ke=0;ke<St.length;ke++)Yt(Pe,St[ke],et,st,Ut==="Polygon",ke===0);else if(Ut==="MultiPolygon")for(var it=0;it<St.length;it++){var ut=St[it];for(ke=0;ke<ut.length;ke++)Yt(Pe,ut[ke],et,st,!0,ke===0)}if(Pe.length){var ht=$e.tags||null;if(Ut==="LineString"&&ft.lineMetrics){ht={};for(var Et in $e.tags)ht[Et]=$e.tags[Et];ht.mapbox_clip_start=St.start/St.size,ht.mapbox_clip_end=St.end/St.size}var yt={geometry:Pe,type:Ut==="Polygon"||Ut==="MultiPolygon"?3:Ut==="LineString"||Ut==="MultiLineString"?2:1,tags:ht};$e.id!==null&&(yt.id=$e.id),et.features.push(yt)}}function Yt(et,$e,st,ft,St,Ut){var Pe=ft*ft;if(ft>0&&$e.size<(St?Pe:ft)){st.numPoints+=$e.length/3;return}for(var ke=[],it=0;it<$e.length;it+=3)(ft===0||$e[it+2]>Pe)&&(st.numSimplified++,ke.push($e[it]),ke.push($e[it+1])),st.numPoints++;St&&or(ke,Ut),et.push(ke)}function or(et,$e){for(var st=0,ft=0,St=et.length,Ut=St-2;ft<St;Ut=ft,ft+=2)st+=(et[ft]-et[Ut])*(et[ft+1]+et[Ut+1]);if(st>0===$e)for(ft=0,St=et.length;ft<St/2;ft+=2){var Pe=et[ft],ke=et[ft+1];et[ft]=et[St-2-ft],et[ft+1]=et[St-1-ft],et[St-2-ft]=Pe,et[St-1-ft]=ke}}function Hr(et,$e){return new an(et,$e)}function an(et,$e){$e=this.options=ot(Object.create(this.options),$e);var st=$e.debug;if(st&&console.time("preprocess data"),$e.maxZoom<0||$e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if($e.promoteId&&$e.generateId)throw new Error("promoteId and generateId cannot be used together.");var ft=vt(et,$e);this.tiles={},this.tileCoords=[],st&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",$e.indexMaxZoom,$e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ft=Tt(ft,$e),ft.length&&this.splitTile(ft,0,0,0),st&&(ft.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}an.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},an.prototype.splitTile=function(et,$e,st,ft,St,Ut,Pe){for(var ke=[et,$e,st,ft],it=this.options,ut=it.debug;ke.length;){ft=ke.pop(),st=ke.pop(),$e=ke.pop(),et=ke.pop();var ht=1<<$e,Et=Kr($e,st,ft),yt=this.tiles[Et];if(!yt&&(ut>1&&console.time("creation"),yt=this.tiles[Et]=Vt(et,$e,st,ft,it),this.tileCoords.push({z:$e,x:st,y:ft}),ut)){ut>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",$e,st,ft,yt.numFeatures,yt.numPoints,yt.numSimplified),console.timeEnd("creation"));var Dt="z"+$e;this.stats[Dt]=(this.stats[Dt]||0)+1,this.total++}if(yt.source=et,St){if($e===it.maxZoom||$e===St)continue;var Xt=1<<St-$e;if(st!==Math.floor(Ut/Xt)||ft!==Math.floor(Pe/Xt))continue}else if($e===it.indexMaxZoom||yt.numPoints<=it.indexMaxPoints)continue;if(yt.source=null,et.length!==0){ut>1&&console.time("clipping");var ar=.5*it.buffer/it.extent,kr=.5-ar,wr=.5+ar,Sr=1+ar,Zr,ir,xr,Fr,Or,Cr;Zr=ir=xr=Fr=null,Or=Ct(et,ht,st-ar,st+wr,0,yt.minX,yt.maxX,it),Cr=Ct(et,ht,st+kr,st+Sr,0,yt.minX,yt.maxX,it),et=null,Or&&(Zr=Ct(Or,ht,ft-ar,ft+wr,1,yt.minY,yt.maxY,it),ir=Ct(Or,ht,ft+kr,ft+Sr,1,yt.minY,yt.maxY,it),Or=null),Cr&&(xr=Ct(Cr,ht,ft-ar,ft+wr,1,yt.minY,yt.maxY,it),Fr=Ct(Cr,ht,ft+kr,ft+Sr,1,yt.minY,yt.maxY,it),Cr=null),ut>1&&console.timeEnd("clipping"),ke.push(Zr||[],$e+1,st*2,ft*2),ke.push(ir||[],$e+1,st*2,ft*2+1),ke.push(xr||[],$e+1,st*2+1,ft*2),ke.push(Fr||[],$e+1,st*2+1,ft*2+1)}}},an.prototype.getTile=function(et,$e,st){var ft=this.options,St=ft.extent,Ut=ft.debug;if(et<0||et>24)return null;var Pe=1<<et;$e=($e%Pe+Pe)%Pe;var ke=Kr(et,$e,st);if(this.tiles[ke])return Ht(this.tiles[ke],St);Ut>1&&console.log("drilling down to z%d-%d-%d",et,$e,st);for(var it=et,ut=$e,ht=st,Et;!Et&&it>0;)it--,ut=Math.floor(ut/2),ht=Math.floor(ht/2),Et=this.tiles[Kr(it,ut,ht)];return!Et||!Et.source?null:(Ut>1&&console.log("found parent tile z%d-%d-%d",it,ut,ht),Ut>1&&console.time("drilling down"),this.splitTile(Et.source,it,ut,ht,et,$e,st),Ut>1&&console.timeEnd("drilling down"),this.tiles[ke]?Ht(this.tiles[ke],St):null)};function Kr(et,$e,st){return((1<<et)*st+$e)*32+et}function ot(et,$e){for(var st in $e)et[st]=$e[st];return et}function er(et,$e){var st=et.tileID.canonical;if(!this._geoJSONIndex)return $e(null,null);var ft=this._geoJSONIndex.getTile(st.z,st.x,st.y);if(!ft)return $e(null,null);var St=new w(ft.features),Ut=k(St);(Ut.byteOffset!==0||Ut.byteLength!==Ut.buffer.byteLength)&&(Ut=new Uint8Array(Ut)),$e(null,{vectorTile:St,rawData:Ut.buffer})}var Kt=function(et){function $e(st,ft,St,Ut){et.call(this,st,ft,St,er),Ut&&(this.loadGeoJSON=Ut)}return et&&($e.__proto__=et),$e.prototype=Object.create(et&&et.prototype),$e.prototype.constructor=$e,$e.prototype.loadData=function(ft,St){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=St,this._pendingLoadDataParams=ft,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},$e.prototype._loadData=function(){var ft=this;if(!(!this._pendingCallback||!this._pendingLoadDataParams)){var St=this._pendingCallback,Ut=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Pe=Ut&&Ut.request&&Ut.request.collectResourceTiming?new e.RequestPerformance(Ut.request):!1;this.loadGeoJSON(Ut,function(ke,it){if(ke||!it)return St(ke);if(typeof it!="object")return St(new Error("Input data given to '"+Ut.source+"' is not a valid GeoJSON object."));l(it,!0);try{ft._geoJSONIndex=Ut.cluster?new se(ur(Ut)).load(it.features):Hr(it,Ut.geojsonVtOptions)}catch(Et){return St(Et)}ft.loaded={};var ut={};if(Pe){var ht=Pe.finish();ht&&(ut.resourceTiming={},ut.resourceTiming[Ut.source]=JSON.parse(JSON.stringify(ht)))}St(null,ut)})}},$e.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},$e.prototype.reloadTile=function(ft,St){var Ut=this.loaded,Pe=ft.uid;return Ut&&Ut[Pe]?et.prototype.reloadTile.call(this,ft,St):this.loadTile(ft,St)},$e.prototype.loadGeoJSON=function(ft,St){if(ft.request)e.getJSON(ft.request,St);else if(typeof ft.data=="string")try{return St(null,JSON.parse(ft.data))}catch{return St(new Error("Input data given to '"+ft.source+"' is not a valid GeoJSON object."))}else return St(new Error("Input data given to '"+ft.source+"' is not a valid GeoJSON object."))},$e.prototype.removeSource=function(ft,St){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),St()},$e.prototype.getClusterExpansionZoom=function(ft,St){try{St(null,this._geoJSONIndex.getClusterExpansionZoom(ft.clusterId))}catch(Ut){St(Ut)}},$e.prototype.getClusterChildren=function(ft,St){try{St(null,this._geoJSONIndex.getChildren(ft.clusterId))}catch(Ut){St(Ut)}},$e.prototype.getClusterLeaves=function(ft,St){try{St(null,this._geoJSONIndex.getLeaves(ft.clusterId,ft.limit,ft.offset))}catch(Ut){St(Ut)}},$e}(p);function ur(et){var $e=et.superclusterOptions,st=et.clusterProperties;if(!st||!$e)return $e;for(var ft={},St={},Ut={accumulated:null,zoom:0},Pe={properties:null},ke=Object.keys(st),it=0,ut=ke;it<ut.length;it+=1){var ht=ut[it],Et=st[ht],yt=Et[0],Dt=Et[1],Xt=e.createExpression(Dt),ar=e.createExpression(typeof yt=="string"?[yt,["accumulated"],["get",ht]]:yt);ft[ht]=Xt.value,St[ht]=ar.value}return $e.map=function(kr){Pe.properties=kr;for(var wr={},Sr=0,Zr=ke;Sr<Zr.length;Sr+=1){var ir=Zr[Sr];wr[ir]=ft[ir].evaluate(Ut,Pe)}return wr},$e.reduce=function(kr,wr){Pe.properties=wr;for(var Sr=0,Zr=ke;Sr<Zr.length;Sr+=1){var ir=Zr[Sr];Ut.accumulated=kr[ir],kr[ir]=St[ir].evaluate(Ut,Pe)}},$e}var Ar=function($e){var st=this;this.self=$e,this.actor=new e.Actor($e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:p,geojson:Kt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(ft,St){if(st.workerSourceTypes[ft])throw new Error('Worker source with name "'+ft+'" already registered.');st.workerSourceTypes[ft]=St},this.self.registerRTLTextPlugin=function(ft){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=ft.applyArabicShaping,e.plugin.processBidirectionalText=ft.processBidirectionalText,e.plugin.processStyledBidirectionalText=ft.processStyledBidirectionalText}};return Ar.prototype.setReferrer=function($e,st){this.referrer=st},Ar.prototype.setImages=function($e,st,ft){this.availableImages[$e]=st;for(var St in this.workerSources[$e]){var Ut=this.workerSources[$e][St];for(var Pe in Ut)Ut[Pe].availableImages=st}ft()},Ar.prototype.setLayers=function($e,st,ft){this.getLayerIndex($e).replace(st),ft()},Ar.prototype.updateLayers=function($e,st,ft){this.getLayerIndex($e).update(st.layers,st.removedIds),ft()},Ar.prototype.loadTile=function($e,st,ft){this.getWorkerSource($e,st.type,st.source).loadTile(st,ft)},Ar.prototype.loadDEMTile=function($e,st,ft){this.getDEMWorkerSource($e,st.source).loadTile(st,ft)},Ar.prototype.reloadTile=function($e,st,ft){this.getWorkerSource($e,st.type,st.source).reloadTile(st,ft)},Ar.prototype.abortTile=function($e,st,ft){this.getWorkerSource($e,st.type,st.source).abortTile(st,ft)},Ar.prototype.removeTile=function($e,st,ft){this.getWorkerSource($e,st.type,st.source).removeTile(st,ft)},Ar.prototype.removeDEMTile=function($e,st){this.getDEMWorkerSource($e,st.source).removeTile(st)},Ar.prototype.removeSource=function($e,st,ft){if(!(!this.workerSources[$e]||!this.workerSources[$e][st.type]||!this.workerSources[$e][st.type][st.source])){var St=this.workerSources[$e][st.type][st.source];delete this.workerSources[$e][st.type][st.source],St.removeSource!==void 0?St.removeSource(st,ft):ft()}},Ar.prototype.loadWorkerSource=function($e,st,ft){try{this.self.importScripts(st.url),ft()}catch(St){ft(St.toString())}},Ar.prototype.syncRTLPluginState=function($e,st,ft){try{e.plugin.setState(st);var St=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&St!=null){this.self.importScripts(St);var Ut=e.plugin.isParsed(),Pe=Ut?void 0:new Error("RTL Text Plugin failed to import scripts from "+St);ft(Pe,Ut)}}catch(ke){ft(ke.toString())}},Ar.prototype.getAvailableImages=function($e){var st=this.availableImages[$e];return st||(st=[]),st},Ar.prototype.getLayerIndex=function($e){var st=this.layerIndexes[$e];return st||(st=this.layerIndexes[$e]=new r),st},Ar.prototype.getWorkerSource=function($e,st,ft){var St=this;if(this.workerSources[$e]||(this.workerSources[$e]={}),this.workerSources[$e][st]||(this.workerSources[$e][st]={}),!this.workerSources[$e][st][ft]){var Ut={send:function(Pe,ke,it){St.actor.send(Pe,ke,it,$e)}};this.workerSources[$e][st][ft]=new this.workerSourceTypes[st](Ut,this.getLayerIndex($e),this.getAvailableImages($e))}return this.workerSources[$e][st][ft]},Ar.prototype.getDEMWorkerSource=function($e,st){return this.demWorkerSources[$e]||(this.demWorkerSources[$e]={}),this.demWorkerSources[$e][st]||(this.demWorkerSources[$e][st]=new x),this.demWorkerSources[$e][st]},Ar.prototype.enforceCacheSizeLimit=function($e,st){e.enforceCacheSizeLimit(st)},typeof WorkerGlobalScope<"u"&&typeof e.window<"u"&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new Ar(e.window)),Ar}),T(["./shared"],function(e){var i=e.createCommonjsModule(function(ce){ce.exports?ce.exports=W:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=W,window.mapboxgl.notSupportedReason=pe);function W(Gr){return!pe(Gr)}function pe(Gr){if(!Q())return"not a browser";if(!de())return"insufficent Array support";if(!Le())return"insufficient Function support";if(!ze())return"insufficient Object support";if(!Ke())return"insufficient JSON support";if(!ct())return"insufficient worker support";if(!Lt())return"insufficient Uint8ClampedArray support";if(!$t())return"insufficient ArrayBuffer support";if(!cr())return"insufficient Canvas/getImageData support";if(!Lr(Gr&&Gr.failIfMajorPerformanceCaveat))return"insufficient WebGL support"}function Q(){return typeof window<"u"&&typeof document<"u"}function de(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}function Le(){return Function.prototype&&Function.prototype.bind}function ze(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}function Ke(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}function ct(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var Gr=new Blob([""],{type:"text/javascript"}),$r=URL.createObjectURL(Gr),pn,Ln;try{Ln=new Worker($r),pn=!0}catch{pn=!1}return Ln&&Ln.terminate(),URL.revokeObjectURL($r),pn}function Lt(){return"Uint8ClampedArray"in window}function $t(){return ArrayBuffer.isView}function cr(){var Gr=document.createElement("canvas");Gr.width=Gr.height=1;var $r=Gr.getContext("2d");if(!$r)return!1;var pn=$r.getImageData(0,0,1,1);return pn&&pn.width===Gr.width}var dr={};function Lr(Gr){return dr[Gr]===void 0&&(dr[Gr]=Xr(Gr)),dr[Gr]}W.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};function Yr(Gr){var $r=document.createElement("canvas"),pn=Object.create(W.webGLContextAttributes);return pn.failIfMajorPerformanceCaveat=Gr,$r.probablySupportsContext?$r.probablySupportsContext("webgl",pn)||$r.probablySupportsContext("experimental-webgl",pn):$r.supportsContext?$r.supportsContext("webgl",pn)||$r.supportsContext("experimental-webgl",pn):$r.getContext("webgl",pn)||$r.getContext("experimental-webgl",pn)}function Xr(Gr){var $r=Yr(Gr);if(!$r)return!1;var pn=$r.createShader($r.VERTEX_SHADER);return!pn||$r.isContextLost()?!1:($r.shaderSource(pn,"void main() {}"),$r.compileShader(pn),$r.getShaderParameter(pn,$r.COMPILE_STATUS)===!0)}}),n={};n.create=function(ce,W,pe){var Q=e.window.document.createElement(ce);return W!==void 0&&(Q.className=W),pe&&pe.appendChild(Q),Q},n.createNS=function(ce,W){var pe=e.window.document.createElementNS(ce,W);return pe};var a=e.window.document.documentElement.style;function r(ce){if(!a)return ce[0];for(var W=0;W<ce.length;W++)if(ce[W]in a)return ce[W];return ce[0]}var f=r(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),o;n.disableDrag=function(){a&&f&&(o=a[f],a[f]="none")},n.enableDrag=function(){a&&f&&(a[f]=o)};var s=r(["transform","WebkitTransform"]);n.setTransform=function(ce,W){ce.style[s]=W};var m=!1;try{var g=Object.defineProperty({},"passive",{get:function(){m=!0}});e.window.addEventListener("test",g,g),e.window.removeEventListener("test",g,g)}catch{m=!1}n.addEventListener=function(ce,W,pe,Q){Q===void 0&&(Q={}),"passive"in Q&&m?ce.addEventListener(W,pe,Q):ce.addEventListener(W,pe,Q.capture)},n.removeEventListener=function(ce,W,pe,Q){Q===void 0&&(Q={}),"passive"in Q&&m?ce.removeEventListener(W,pe,Q):ce.removeEventListener(W,pe,Q.capture)};var p=function(ce){ce.preventDefault(),ce.stopPropagation(),e.window.removeEventListener("click",p,!0)};n.suppressClick=function(){e.window.addEventListener("click",p,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",p,!0)},0)},n.mousePos=function(ce,W){var pe=ce.getBoundingClientRect();return new e.Point(W.clientX-pe.left-ce.clientLeft,W.clientY-pe.top-ce.clientTop)},n.touchPos=function(ce,W){for(var pe=ce.getBoundingClientRect(),Q=[],de=0;de<W.length;de++)Q.push(new e.Point(W[de].clientX-pe.left-ce.clientLeft,W[de].clientY-pe.top-ce.clientTop));return Q},n.mouseButton=function(ce){return typeof e.window.InstallTrigger<"u"&&ce.button===2&&ce.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:ce.button},n.remove=function(ce){ce.parentNode&&ce.parentNode.removeChild(ce)};function v(ce,W,pe){var Q,de,Le,ze=e.browser.devicePixelRatio>1?"@2x":"",Ke=e.getJSON(W.transformRequest(W.normalizeSpriteURL(ce,ze,".json"),e.ResourceType.SpriteJSON),function($t,cr){Ke=null,Le||(Le=$t,Q=cr,Lt())}),ct=e.getImage(W.transformRequest(W.normalizeSpriteURL(ce,ze,".png"),e.ResourceType.SpriteImage),function($t,cr){ct=null,Le||(Le=$t,de=cr,Lt())});function Lt(){if(Le)pe(Le);else if(Q&&de){var $t=e.browser.getImageData(de),cr={};for(var dr in Q){var Lr=Q[dr],Yr=Lr.width,Xr=Lr.height,Gr=Lr.x,$r=Lr.y,pn=Lr.sdf,Ln=Lr.pixelRatio,Nn=Lr.stretchX,Qn=Lr.stretchY,ta=Lr.content,qn=new e.RGBAImage({width:Yr,height:Xr});e.RGBAImage.copy($t,qn,{x:Gr,y:$r},{x:0,y:0},{width:Yr,height:Xr}),cr[dr]={data:qn,pixelRatio:Ln,sdf:pn,stretchX:Nn,stretchY:Qn,content:ta}}pe(null,cr)}}return{cancel:function(){Ke&&(Ke.cancel(),Ke=null),ct&&(ct.cancel(),ct=null)}}}function x(ce){var W=ce.userImage;if(W&&W.render){var pe=W.render();if(pe)return ce.data.replace(new Uint8Array(W.data.buffer)),!0}return!1}var l=1,b=function(ce){function W(){ce.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.isLoaded=function(){return this.loaded},W.prototype.setLoaded=function(Q){if(this.loaded!==Q&&(this.loaded=Q,Q)){for(var de=0,Le=this.requestors;de<Le.length;de+=1){var ze=Le[de],Ke=ze.ids,ct=ze.callback;this._notify(Ke,ct)}this.requestors=[]}},W.prototype.getImage=function(Q){return this.images[Q]},W.prototype.addImage=function(Q,de){this._validate(Q,de)&&(this.images[Q]=de)},W.prototype._validate=function(Q,de){var Le=!0;return this._validateStretch(de.stretchX,de.data&&de.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+Q+'" has invalid "stretchX" value'))),Le=!1),this._validateStretch(de.stretchY,de.data&&de.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+Q+'" has invalid "stretchY" value'))),Le=!1),this._validateContent(de.content,de)||(this.fire(new e.ErrorEvent(new Error('Image "'+Q+'" has invalid "content" value'))),Le=!1),Le},W.prototype._validateStretch=function(Q,de){if(!Q)return!0;for(var Le=0,ze=0,Ke=Q;ze<Ke.length;ze+=1){var ct=Ke[ze];if(ct[0]<Le||ct[1]<ct[0]||de<ct[1])return!1;Le=ct[1]}return!0},W.prototype._validateContent=function(Q,de){return Q?!(Q.length!==4||Q[0]<0||de.data.width<Q[0]||Q[1]<0||de.data.height<Q[1]||Q[2]<0||de.data.width<Q[2]||Q[3]<0||de.data.height<Q[3]||Q[2]<Q[0]||Q[3]<Q[1]):!0},W.prototype.updateImage=function(Q,de){var Le=this.images[Q];de.version=Le.version+1,this.images[Q]=de,this.updatedImages[Q]=!0},W.prototype.removeImage=function(Q){var de=this.images[Q];delete this.images[Q],delete this.patterns[Q],de.userImage&&de.userImage.onRemove&&de.userImage.onRemove()},W.prototype.listImages=function(){return Object.keys(this.images)},W.prototype.getImages=function(Q,de){var Le=!0;if(!this.isLoaded())for(var ze=0,Ke=Q;ze<Ke.length;ze+=1){var ct=Ke[ze];this.images[ct]||(Le=!1)}this.isLoaded()||Le?this._notify(Q,de):this.requestors.push({ids:Q,callback:de})},W.prototype._notify=function(Q,de){for(var Le={},ze=0,Ke=Q;ze<Ke.length;ze+=1){var ct=Ke[ze];this.images[ct]||this.fire(new e.Event("styleimagemissing",{id:ct}));var Lt=this.images[ct];Lt?Le[ct]={data:Lt.data.clone(),pixelRatio:Lt.pixelRatio,sdf:Lt.sdf,version:Lt.version,stretchX:Lt.stretchX,stretchY:Lt.stretchY,content:Lt.content,hasRenderCallback:Boolean(Lt.userImage&&Lt.userImage.render)}:e.warnOnce('Image "'+ct+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}de(null,Le)},W.prototype.getPixelSize=function(){var Q=this.atlasImage,de=Q.width,Le=Q.height;return{width:de,height:Le}},W.prototype.getPattern=function(Q){var de=this.patterns[Q],Le=this.getImage(Q);if(!Le)return null;if(de&&de.position.version===Le.version)return de.position;if(de)de.position.version=Le.version;else{var ze=Le.data.width+l*2,Ke=Le.data.height+l*2,ct={w:ze,h:Ke,x:0,y:0},Lt=new e.ImagePosition(ct,Le);this.patterns[Q]={bin:ct,position:Lt}}return this._updatePatternAtlas(),this.patterns[Q].position},W.prototype.bind=function(Q){var de=Q.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(Q,this.atlasImage,de.RGBA),this.atlasTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE)},W.prototype._updatePatternAtlas=function(){var Q=[];for(var de in this.patterns)Q.push(this.patterns[de].bin);var Le=e.potpack(Q),ze=Le.w,Ke=Le.h,ct=this.atlasImage;ct.resize({width:ze||1,height:Ke||1});for(var Lt in this.patterns){var $t=this.patterns[Lt],cr=$t.bin,dr=cr.x+l,Lr=cr.y+l,Yr=this.images[Lt].data,Xr=Yr.width,Gr=Yr.height;e.RGBAImage.copy(Yr,ct,{x:0,y:0},{x:dr,y:Lr},{width:Xr,height:Gr}),e.RGBAImage.copy(Yr,ct,{x:0,y:Gr-1},{x:dr,y:Lr-1},{width:Xr,height:1}),e.RGBAImage.copy(Yr,ct,{x:0,y:0},{x:dr,y:Lr+Gr},{width:Xr,height:1}),e.RGBAImage.copy(Yr,ct,{x:Xr-1,y:0},{x:dr-1,y:Lr},{width:1,height:Gr}),e.RGBAImage.copy(Yr,ct,{x:0,y:0},{x:dr+Xr,y:Lr},{width:1,height:Gr})}this.dirty=!0},W.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},W.prototype.dispatchRenderCallbacks=function(Q){for(var de=0,Le=Q;de<Le.length;de+=1){var ze=Le[de];if(!this.callbackDispatchedThisFrame[ze]){this.callbackDispatchedThisFrame[ze]=!0;var Ke=this.images[ze],ct=x(Ke);ct&&this.updateImage(ze,Ke)}}},W}(e.Evented);function c(ce,W,pe,Q,de){var Le=W*256,ze=Le+255,Ke=Q.transformRequest(Q.normalizeGlyphsURL(pe).replace("{fontstack}",ce).replace("{range}",Le+"-"+ze),e.ResourceType.Glyphs);e.getArrayBuffer(Ke,function(ct,Lt){if(ct)de(ct);else if(Lt){for(var $t={},cr=0,dr=e.parseGlyphPBF(Lt);cr<dr.length;cr+=1){var Lr=dr[cr];$t[Lr.id]=Lr}de(null,$t)}})}var M=w,_=w,y=1e20;function w(ce,W,pe,Q,de,Le){this.fontSize=ce||24,this.buffer=W===void 0?3:W,this.cutoff=Q||.25,this.fontFamily=de||"sans-serif",this.fontWeight=Le||"normal",this.radius=pe||8;var ze=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=ze,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(ze*ze),this.gridInner=new Float64Array(ze*ze),this.f=new Float64Array(ze),this.d=new Float64Array(ze),this.z=new Float64Array(ze+1),this.v=new Int16Array(ze),this.middle=Math.round(ze/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}w.prototype.draw=function(ce){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(ce,this.buffer,this.middle);for(var W=this.ctx.getImageData(0,0,this.size,this.size),pe=new Uint8ClampedArray(this.size*this.size),Q=0;Q<this.size*this.size;Q++){var de=W.data[Q*4+3]/255;this.gridOuter[Q]=de===1?0:de===0?y:Math.pow(Math.max(0,.5-de),2),this.gridInner[Q]=de===1?y:de===0?0:Math.pow(Math.max(0,de-.5),2)}for(d(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),d(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),Q=0;Q<this.size*this.size;Q++){var Le=this.gridOuter[Q]-this.gridInner[Q];pe[Q]=Math.max(0,Math.min(255,Math.round(255-255*(Le/this.radius+this.cutoff))))}return pe};function d(ce,W,pe,Q,de,Le,ze){for(var Ke=0;Ke<W;Ke++){for(var ct=0;ct<pe;ct++)Q[ct]=ce[ct*W+Ke];for(C(Q,de,Le,ze,pe),ct=0;ct<pe;ct++)ce[ct*W+Ke]=de[ct]}for(ct=0;ct<pe;ct++){for(Ke=0;Ke<W;Ke++)Q[Ke]=ce[ct*W+Ke];for(C(Q,de,Le,ze,W),Ke=0;Ke<W;Ke++)ce[ct*W+Ke]=Math.sqrt(de[Ke])}}function C(ce,W,pe,Q,de){pe[0]=0,Q[0]=-y,Q[1]=+y;for(var Le=1,ze=0;Le<de;Le++){for(var Ke=(ce[Le]+Le*Le-(ce[pe[ze]]+pe[ze]*pe[ze]))/(2*Le-2*pe[ze]);Ke<=Q[ze];)ze--,Ke=(ce[Le]+Le*Le-(ce[pe[ze]]+pe[ze]*pe[ze]))/(2*Le-2*pe[ze]);ze++,pe[ze]=Le,Q[ze]=Ke,Q[ze+1]=+y}for(Le=0,ze=0;Le<de;Le++){for(;Q[ze+1]<Le;)ze++;W[Le]=(Le-pe[ze])*(Le-pe[ze])+ce[pe[ze]]}}M.default=_;var S=function(W,pe){this.requestManager=W,this.localIdeographFontFamily=pe,this.entries={}};S.prototype.setURL=function(W){this.url=W},S.prototype.getGlyphs=function(W,pe){var Q=this,de=[];for(var Le in W)for(var ze=0,Ke=W[Le];ze<Ke.length;ze+=1){var ct=Ke[ze];de.push({stack:Le,id:ct})}e.asyncAll(de,function(Lt,$t){var cr=Lt.stack,dr=Lt.id,Lr=Q.entries[cr];Lr||(Lr=Q.entries[cr]={glyphs:{},requests:{},ranges:{}});var Yr=Lr.glyphs[dr];if(Yr!==void 0){$t(null,{stack:cr,id:dr,glyph:Yr});return}if(Yr=Q._tinySDF(Lr,cr,dr),Yr){Lr.glyphs[dr]=Yr,$t(null,{stack:cr,id:dr,glyph:Yr});return}var Xr=Math.floor(dr/256);if(Xr*256>65535){$t(new Error("glyphs > 65535 not supported"));return}if(Lr.ranges[Xr]){$t(null,{stack:cr,id:dr,glyph:Yr});return}var Gr=Lr.requests[Xr];Gr||(Gr=Lr.requests[Xr]=[],S.loadGlyphRange(cr,Xr,Q.url,Q.requestManager,function($r,pn){if(pn){for(var Ln in pn)Q._doesCharSupportLocalGlyph(+Ln)||(Lr.glyphs[+Ln]=pn[+Ln]);Lr.ranges[Xr]=!0}for(var Nn=0,Qn=Gr;Nn<Qn.length;Nn+=1){var ta=Qn[Nn];ta($r,pn)}delete Lr.requests[Xr]})),Gr.push(function($r,pn){$r?$t($r):pn&&$t(null,{stack:cr,id:dr,glyph:pn[dr]||null})})},function(Lt,$t){if(Lt)pe(Lt);else if($t){for(var cr={},dr=0,Lr=$t;dr<Lr.length;dr+=1){var Yr=Lr[dr],Xr=Yr.stack,Gr=Yr.id,$r=Yr.glyph;(cr[Xr]||(cr[Xr]={}))[Gr]=$r&&{id:$r.id,bitmap:$r.bitmap.clone(),metrics:$r.metrics}}pe(null,cr)}})},S.prototype._doesCharSupportLocalGlyph=function(W){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](W)||e.isChar["Hangul Syllables"](W)||e.isChar.Hiragana(W)||e.isChar.Katakana(W))},S.prototype._tinySDF=function(W,pe,Q){var de=this.localIdeographFontFamily;if(!!de&&!!this._doesCharSupportLocalGlyph(Q)){var Le=W.tinySDF;if(!Le){var ze="400";/bold/i.test(pe)?ze="900":/medium/i.test(pe)?ze="500":/light/i.test(pe)&&(ze="200"),Le=W.tinySDF=new S.TinySDF(24,3,8,.25,de,ze)}return{id:Q,bitmap:new e.AlphaImage({width:30,height:30},Le.draw(String.fromCharCode(Q))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},S.loadGlyphRange=c,S.TinySDF=M;var E=function(){this.specification=e.styleSpec.light.position};E.prototype.possiblyEvaluate=function(W,pe){return e.sphericalToCartesian(W.expression.evaluate(pe))},E.prototype.interpolate=function(W,pe,Q){return{x:e.number(W.x,pe.x,Q),y:e.number(W.y,pe.y,Q),z:e.number(W.z,pe.z,Q)}};var k=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new E,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),B="-transition",z=function(ce){function W(pe){ce.call(this),this._transitionable=new e.Transitionable(k),this.setLight(pe),this._transitioning=this._transitionable.untransitioned()}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getLight=function(){return this._transitionable.serialize()},W.prototype.setLight=function(Q,de){if(de===void 0&&(de={}),!this._validate(e.validateLight,Q,de))for(var Le in Q){var ze=Q[Le];e.endsWith(Le,B)?this._transitionable.setTransition(Le.slice(0,-B.length),ze):this._transitionable.setValue(Le,ze)}},W.prototype.updateTransitions=function(Q){this._transitioning=this._transitionable.transitioned(Q,this._transitioning)},W.prototype.hasTransition=function(){return this._transitioning.hasTransition()},W.prototype.recalculate=function(Q){this.properties=this._transitioning.possiblyEvaluate(Q)},W.prototype._validate=function(Q,de,Le){return Le&&Le.validate===!1?!1:e.emitValidationErrors(this,Q.call(e.validateStyle,e.extend({value:de,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},W}(e.Evented),F=function(W,pe){this.width=W,this.height=pe,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};F.prototype.getDash=function(W,pe){var Q=W.join(",")+String(pe);return this.dashEntry[Q]||(this.dashEntry[Q]=this.addDash(W,pe)),this.dashEntry[Q]},F.prototype.getDashRanges=function(W,pe,Q){var de=W.length%2===1,Le=[],ze=de?-W[W.length-1]*Q:0,Ke=W[0]*Q,ct=!0;Le.push({left:ze,right:Ke,isDash:ct,zeroLength:W[0]===0});for(var Lt=W[0],$t=1;$t<W.length;$t++){ct=!ct;var cr=W[$t];ze=Lt*Q,Lt+=cr,Ke=Lt*Q,Le.push({left:ze,right:Ke,isDash:ct,zeroLength:cr===0})}return Le},F.prototype.addRoundDash=function(W,pe,Q){for(var de=pe/2,Le=-Q;Le<=Q;Le++)for(var ze=this.nextRow+Q+Le,Ke=this.width*ze,ct=0,Lt=W[ct],$t=0;$t<this.width;$t++){$t/Lt.right>1&&(Lt=W[++ct]);var cr=Math.abs($t-Lt.left),dr=Math.abs($t-Lt.right),Lr=Math.min(cr,dr),Yr=void 0,Xr=Le/Q*(de+1);if(Lt.isDash){var Gr=de-Math.abs(Xr);Yr=Math.sqrt(Lr*Lr+Gr*Gr)}else Yr=de-Math.sqrt(Lr*Lr+Xr*Xr);this.data[Ke+$t]=Math.max(0,Math.min(255,Yr+128))}},F.prototype.addRegularDash=function(W){for(var pe=W.length-1;pe>=0;--pe){var Q=W[pe],de=W[pe+1];Q.zeroLength?W.splice(pe,1):de&&de.isDash===Q.isDash&&(de.left=Q.left,W.splice(pe,1))}var Le=W[0],ze=W[W.length-1];Le.isDash===ze.isDash&&(Le.left=ze.left-this.width,ze.right=Le.right+this.width);for(var Ke=this.width*this.nextRow,ct=0,Lt=W[ct],$t=0;$t<this.width;$t++){$t/Lt.right>1&&(Lt=W[++ct]);var cr=Math.abs($t-Lt.left),dr=Math.abs($t-Lt.right),Lr=Math.min(cr,dr),Yr=Lt.isDash?Lr:-Lr;this.data[Ke+$t]=Math.max(0,Math.min(255,Yr+128))}},F.prototype.addDash=function(W,pe){var Q=pe?7:0,de=2*Q+1;if(this.nextRow+de>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var Le=0,ze=0;ze<W.length;ze++)Le+=W[ze];if(Le!==0){var Ke=this.width/Le,ct=this.getDashRanges(W,this.width,Ke);pe?this.addRoundDash(ct,Ke,Q):this.addRegularDash(ct)}var Lt={y:(this.nextRow+Q+.5)/this.height,height:2*Q/this.height,width:Le};return this.nextRow+=de,this.dirty=!0,Lt},F.prototype.bind=function(W){var pe=W.gl;this.texture?(pe.bindTexture(pe.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,pe.texSubImage2D(pe.TEXTURE_2D,0,0,0,this.width,this.height,pe.ALPHA,pe.UNSIGNED_BYTE,this.data))):(this.texture=pe.createTexture(),pe.bindTexture(pe.TEXTURE_2D,this.texture),pe.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_WRAP_S,pe.REPEAT),pe.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_WRAP_T,pe.REPEAT),pe.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_MIN_FILTER,pe.LINEAR),pe.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_MAG_FILTER,pe.LINEAR),pe.texImage2D(pe.TEXTURE_2D,0,pe.ALPHA,this.width,this.height,0,pe.ALPHA,pe.UNSIGNED_BYTE,this.data))};var I=function ce(W,pe){this.workerPool=W,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var Q=this.workerPool.acquire(this.id),de=0;de<Q.length;de++){var Le=Q[de],ze=new ce.Actor(Le,pe,this.id);ze.name="Worker "+de,this.actors.push(ze)}};I.prototype.broadcast=function(W,pe,Q){Q=Q||function(){},e.asyncAll(this.actors,function(de,Le){de.send(W,pe,Le)},Q)},I.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},I.prototype.remove=function(){this.actors.forEach(function(W){W.remove()}),this.actors=[],this.workerPool.release(this.id)},I.Actor=e.Actor;function O(ce,W,pe){var Q=function(de,Le){if(de)return pe(de);if(Le){var ze=e.pick(e.extend(Le,ce),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);Le.vector_layers&&(ze.vectorLayers=Le.vector_layers,ze.vectorLayerIds=ze.vectorLayers.map(function(Ke){return Ke.id})),ze.tiles=W.canonicalizeTileset(ze,ce.url),pe(null,ze)}};return ce.url?e.getJSON(W.transformRequest(W.normalizeSourceURL(ce.url),e.ResourceType.Source),Q):e.browser.frame(function(){return Q(null,ce)})}var N=function(W,pe,Q){this.bounds=e.LngLatBounds.convert(this.validateBounds(W)),this.minzoom=pe||0,this.maxzoom=Q||24};N.prototype.validateBounds=function(W){return!Array.isArray(W)||W.length!==4?[-180,-90,180,90]:[Math.max(-180,W[0]),Math.max(-90,W[1]),Math.min(180,W[2]),Math.min(90,W[3])]},N.prototype.contains=function(W){var pe=Math.pow(2,W.z),Q={minX:Math.floor(e.mercatorXfromLng(this.bounds.getWest())*pe),minY:Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*pe),maxX:Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*pe),maxY:Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*pe)},de=W.x>=Q.minX&&W.x<Q.maxX&&W.y>=Q.minY&&W.y<Q.maxY;return de};var V=function(ce){function W(pe,Q,de,Le){if(ce.call(this),this.id=pe,this.dispatcher=de,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(Q,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},Q),this._collectResourceTiming=Q.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(Le)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.load=function(){var Q=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._requestManager,function(de,Le){Q._tileJSONRequest=null,Q._loaded=!0,de?Q.fire(new e.ErrorEvent(de)):Le&&(e.extend(Q,Le),Le.bounds&&(Q.tileBounds=new N(Le.bounds,Q.minzoom,Q.maxzoom)),e.postTurnstileEvent(Le.tiles,Q.map._requestManager._customAccessToken),e.postMapLoadEvent(Le.tiles,Q.map._getMapId(),Q.map._requestManager._skuToken,Q.map._requestManager._customAccessToken),Q.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),Q.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},W.prototype.loaded=function(){return this._loaded},W.prototype.hasTile=function(Q){return!this.tileBounds||this.tileBounds.contains(Q.canonical)},W.prototype.onAdd=function(Q){this.map=Q,this.load()},W.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},W.prototype.serialize=function(){return e.extend({},this._options)},W.prototype.loadTile=function(Q,de){var Le=this.map._requestManager.normalizeTileURL(Q.tileID.canonical.url(this.tiles,this.scheme)),ze={request:this.map._requestManager.transformRequest(Le,e.ResourceType.Tile),uid:Q.uid,tileID:Q.tileID,zoom:Q.tileID.overscaledZ,tileSize:this.tileSize*Q.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};ze.request.collectResourceTiming=this._collectResourceTiming,!Q.actor||Q.state==="expired"?(Q.actor=this.dispatcher.getActor(),Q.request=Q.actor.send("loadTile",ze,Ke.bind(this))):Q.state==="loading"?Q.reloadCallback=de:Q.request=Q.actor.send("reloadTile",ze,Ke.bind(this));function Ke(ct,Lt){if(delete Q.request,Q.aborted)return de(null);if(ct&&ct.status!==404)return de(ct);Lt&&Lt.resourceTiming&&(Q.resourceTiming=Lt.resourceTiming),this.map._refreshExpiredTiles&&Lt&&Q.setExpiryData(Lt),Q.loadVectorData(Lt,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),de(null),Q.reloadCallback&&(this.loadTile(Q,Q.reloadCallback),Q.reloadCallback=null)}},W.prototype.abortTile=function(Q){Q.request&&(Q.request.cancel(),delete Q.request),Q.actor&&Q.actor.send("abortTile",{uid:Q.uid,type:this.type,source:this.id},void 0)},W.prototype.unloadTile=function(Q){Q.unloadVectorData(),Q.actor&&Q.actor.send("removeTile",{uid:Q.uid,type:this.type,source:this.id},void 0)},W.prototype.hasTransition=function(){return!1},W}(e.Evented),H=function(ce){function W(pe,Q,de,Le){ce.call(this),this.id=pe,this.dispatcher=de,this.setEventedParent(Le),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},Q),e.extend(this,e.pick(Q,["url","scheme","tileSize"]))}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.load=function(){var Q=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._requestManager,function(de,Le){Q._tileJSONRequest=null,Q._loaded=!0,de?Q.fire(new e.ErrorEvent(de)):Le&&(e.extend(Q,Le),Le.bounds&&(Q.tileBounds=new N(Le.bounds,Q.minzoom,Q.maxzoom)),e.postTurnstileEvent(Le.tiles),e.postMapLoadEvent(Le.tiles,Q.map._getMapId(),Q.map._requestManager._skuToken),Q.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),Q.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},W.prototype.loaded=function(){return this._loaded},W.prototype.onAdd=function(Q){this.map=Q,this.load()},W.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},W.prototype.serialize=function(){return e.extend({},this._options)},W.prototype.hasTile=function(Q){return!this.tileBounds||this.tileBounds.contains(Q.canonical)},W.prototype.loadTile=function(Q,de){var Le=this,ze=this.map._requestManager.normalizeTileURL(Q.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);Q.request=e.getImage(this.map._requestManager.transformRequest(ze,e.ResourceType.Tile),function(Ke,ct){if(delete Q.request,Q.aborted)Q.state="unloaded",de(null);else if(Ke)Q.state="errored",de(Ke);else if(ct){Le.map._refreshExpiredTiles&&Q.setExpiryData(ct),delete ct.cacheControl,delete ct.expires;var Lt=Le.map.painter.context,$t=Lt.gl;Q.texture=Le.map.painter.getTileTexture(ct.width),Q.texture?Q.texture.update(ct,{useMipmap:!0}):(Q.texture=new e.Texture(Lt,ct,$t.RGBA,{useMipmap:!0}),Q.texture.bind($t.LINEAR,$t.CLAMP_TO_EDGE,$t.LINEAR_MIPMAP_NEAREST),Lt.extTextureFilterAnisotropic&&$t.texParameterf($t.TEXTURE_2D,Lt.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Lt.extTextureFilterAnisotropicMax)),Q.state="loaded",e.cacheEntryPossiblyAdded(Le.dispatcher),de(null)}})},W.prototype.abortTile=function(Q,de){Q.request&&(Q.request.cancel(),delete Q.request),de()},W.prototype.unloadTile=function(Q,de){Q.texture&&this.map.painter.saveTileTexture(Q.texture),de()},W.prototype.hasTransition=function(){return!1},W}(e.Evented),j=function(ce){function W(pe,Q,de,Le){ce.call(this,pe,Q,de,Le),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},Q),this.encoding=Q.encoding||"mapbox"}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},W.prototype.loadTile=function(Q,de){var Le=this.map._requestManager.normalizeTileURL(Q.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);Q.request=e.getImage(this.map._requestManager.transformRequest(Le,e.ResourceType.Tile),ze.bind(this)),Q.neighboringTiles=this._getNeighboringTiles(Q.tileID);function ze(ct,Lt){if(delete Q.request,Q.aborted)Q.state="unloaded",de(null);else if(ct)Q.state="errored",de(ct);else if(Lt){this.map._refreshExpiredTiles&&Q.setExpiryData(Lt),delete Lt.cacheControl,delete Lt.expires;var $t=e.window.ImageBitmap&&Lt instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported(),cr=$t?Lt:e.browser.getImageData(Lt,1),dr={uid:Q.uid,coord:Q.tileID,source:this.id,rawImageData:cr,encoding:this.encoding};(!Q.actor||Q.state==="expired")&&(Q.actor=this.dispatcher.getActor(),Q.actor.send("loadDEMTile",dr,Ke.bind(this)))}}function Ke(ct,Lt){ct&&(Q.state="errored",de(ct)),Lt&&(Q.dem=Lt,Q.needsHillshadePrepare=!0,Q.state="loaded",de(null))}},W.prototype._getNeighboringTiles=function(Q){var de=Q.canonical,Le=Math.pow(2,de.z),ze=(de.x-1+Le)%Le,Ke=de.x===0?Q.wrap-1:Q.wrap,ct=(de.x+1+Le)%Le,Lt=de.x+1===Le?Q.wrap+1:Q.wrap,$t={};return $t[new e.OverscaledTileID(Q.overscaledZ,Ke,de.z,ze,de.y).key]={backfilled:!1},$t[new e.OverscaledTileID(Q.overscaledZ,Lt,de.z,ct,de.y).key]={backfilled:!1},de.y>0&&($t[new e.OverscaledTileID(Q.overscaledZ,Ke,de.z,ze,de.y-1).key]={backfilled:!1},$t[new e.OverscaledTileID(Q.overscaledZ,Q.wrap,de.z,de.x,de.y-1).key]={backfilled:!1},$t[new e.OverscaledTileID(Q.overscaledZ,Lt,de.z,ct,de.y-1).key]={backfilled:!1}),de.y+1<Le&&($t[new e.OverscaledTileID(Q.overscaledZ,Ke,de.z,ze,de.y+1).key]={backfilled:!1},$t[new e.OverscaledTileID(Q.overscaledZ,Q.wrap,de.z,de.x,de.y+1).key]={backfilled:!1},$t[new e.OverscaledTileID(Q.overscaledZ,Lt,de.z,ct,de.y+1).key]={backfilled:!1}),$t},W.prototype.unloadTile=function(Q){Q.demTexture&&this.map.painter.saveTileTexture(Q.demTexture),Q.fbo&&(Q.fbo.destroy(),delete Q.fbo),Q.dem&&delete Q.dem,delete Q.neighboringTiles,Q.state="unloaded",Q.actor&&Q.actor.send("removeDEMTile",{uid:Q.uid,source:this.id})},W}(H),Z=function(ce){function W(pe,Q,de,Le){ce.call(this),this.id=pe,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=de.getActor(),this.setEventedParent(Le),this._data=Q.data,this._options=e.extend({},Q),this._collectResourceTiming=Q.collectResourceTiming,this._resourceTiming=[],Q.maxzoom!==void 0&&(this.maxzoom=Q.maxzoom),Q.type&&(this.type=Q.type),Q.attribution&&(this.attribution=Q.attribution),this.promoteId=Q.promoteId;var ze=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:Q.cluster||!1,geojsonVtOptions:{buffer:(Q.buffer!==void 0?Q.buffer:128)*ze,tolerance:(Q.tolerance!==void 0?Q.tolerance:.375)*ze,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:Q.lineMetrics||!1,generateId:Q.generateId||!1},superclusterOptions:{maxZoom:Q.clusterMaxZoom!==void 0?Math.min(Q.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(Q.clusterRadius||50)*ze,log:!1,generateId:Q.generateId||!1},clusterProperties:Q.clusterProperties},Q.workerOptions)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.load=function(){var Q=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(de){if(de){Q.fire(new e.ErrorEvent(de));return}var Le={dataType:"source",sourceDataType:"metadata"};Q._collectResourceTiming&&Q._resourceTiming&&Q._resourceTiming.length>0&&(Le.resourceTiming=Q._resourceTiming,Q._resourceTiming=[]),Q.fire(new e.Event("data",Le))})},W.prototype.onAdd=function(Q){this.map=Q,this.load()},W.prototype.setData=function(Q){var de=this;return this._data=Q,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(Le){if(Le){de.fire(new e.ErrorEvent(Le));return}var ze={dataType:"source",sourceDataType:"content"};de._collectResourceTiming&&de._resourceTiming&&de._resourceTiming.length>0&&(ze.resourceTiming=de._resourceTiming,de._resourceTiming=[]),de.fire(new e.Event("data",ze))}),this},W.prototype.getClusterExpansionZoom=function(Q,de){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:Q,source:this.id},de),this},W.prototype.getClusterChildren=function(Q,de){return this.actor.send("geojson.getClusterChildren",{clusterId:Q,source:this.id},de),this},W.prototype.getClusterLeaves=function(Q,de,Le,ze){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:Q,limit:de,offset:Le},ze),this},W.prototype._updateWorkerData=function(Q){var de=this;this._loaded=!1;var Le=e.extend({},this.workerOptions),ze=this._data;typeof ze=="string"?(Le.request=this.map._requestManager.transformRequest(e.browser.resolveURL(ze),e.ResourceType.Source),Le.request.collectResourceTiming=this._collectResourceTiming):Le.data=JSON.stringify(ze),this.actor.send(this.type+".loadData",Le,function(Ke,ct){de._removed||ct&&ct.abandoned||(de._loaded=!0,ct&&ct.resourceTiming&&ct.resourceTiming[de.id]&&(de._resourceTiming=ct.resourceTiming[de.id].slice(0)),de.actor.send(de.type+".coalesce",{source:Le.source},null),Q(Ke))})},W.prototype.loaded=function(){return this._loaded},W.prototype.loadTile=function(Q,de){var Le=this,ze=Q.actor?"reloadTile":"loadTile";Q.actor=this.actor;var Ke={type:this.type,uid:Q.uid,tileID:Q.tileID,zoom:Q.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};Q.request=this.actor.send(ze,Ke,function(ct,Lt){return delete Q.request,Q.unloadVectorData(),Q.aborted?de(null):ct?de(ct):(Q.loadVectorData(Lt,Le.map.painter,ze==="reloadTile"),de(null))})},W.prototype.abortTile=function(Q){Q.request&&(Q.request.cancel(),delete Q.request),Q.aborted=!0},W.prototype.unloadTile=function(Q){Q.unloadVectorData(),this.actor.send("removeTile",{uid:Q.uid,type:this.type,source:this.id})},W.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},W.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},W.prototype.hasTransition=function(){return!1},W}(e.Evented),X=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),re=function(ce){function W(pe,Q,de,Le){ce.call(this),this.id=pe,this.dispatcher=de,this.coordinates=Q.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(Le),this.options=Q}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.load=function(Q,de){var Le=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(ze,Ke){Le._loaded=!0,ze?Le.fire(new e.ErrorEvent(ze)):Ke&&(Le.image=Ke,Q&&(Le.coordinates=Q),de&&de(),Le._finishLoading())})},W.prototype.loaded=function(){return this._loaded},W.prototype.updateImage=function(Q){var de=this;return!this.image||!Q.url?this:(this.options.url=Q.url,this.load(Q.coordinates,function(){de.texture=null}),this)},W.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},W.prototype.onAdd=function(Q){this.map=Q,this.load()},W.prototype.setCoordinates=function(Q){var de=this;this.coordinates=Q;var Le=Q.map(e.MercatorCoordinate.fromLngLat);this.tileID=ue(Le),this.minzoom=this.maxzoom=this.tileID.z;var ze=Le.map(function(Ke){return de.tileID.getTilePoint(Ke)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(ze[0].x,ze[0].y,0,0),this._boundsArray.emplaceBack(ze[1].x,ze[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(ze[3].x,ze[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(ze[2].x,ze[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},W.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||!this.image)){var Q=this.map.painter.context,de=Q.gl;this.boundsBuffer||(this.boundsBuffer=Q.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(Q,this.image,de.RGBA),this.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE));for(var Le in this.tiles){var ze=this.tiles[Le];ze.state!=="loaded"&&(ze.state="loaded",ze.texture=this.texture)}}},W.prototype.loadTile=function(Q,de){this.tileID&&this.tileID.equals(Q.tileID.canonical)?(this.tiles[String(Q.tileID.wrap)]=Q,Q.buckets={},de(null)):(Q.state="errored",de(null))},W.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},W.prototype.hasTransition=function(){return!1},W}(e.Evented);function ue(ce){for(var W=1/0,pe=1/0,Q=-1/0,de=-1/0,Le=0,ze=ce;Le<ze.length;Le+=1){var Ke=ze[Le];W=Math.min(W,Ke.x),pe=Math.min(pe,Ke.y),Q=Math.max(Q,Ke.x),de=Math.max(de,Ke.y)}var ct=Q-W,Lt=de-pe,$t=Math.max(ct,Lt),cr=Math.max(0,Math.floor(-Math.log($t)/Math.LN2)),dr=Math.pow(2,cr);return new e.CanonicalTileID(cr,Math.floor((W+Q)/2*dr),Math.floor((pe+de)/2*dr))}var K=function(ce){function W(pe,Q,de,Le){ce.call(this,pe,Q,de,Le),this.roundZoom=!0,this.type="video",this.options=Q}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.load=function(){var Q=this;this._loaded=!1;var de=this.options;this.urls=[];for(var Le=0,ze=de.urls;Le<ze.length;Le+=1){var Ke=ze[Le];this.urls.push(this.map._requestManager.transformRequest(Ke,e.ResourceType.Source).url)}e.getVideo(this.urls,function(ct,Lt){Q._loaded=!0,ct?Q.fire(new e.ErrorEvent(ct)):Lt&&(Q.video=Lt,Q.video.loop=!0,Q.video.addEventListener("playing",function(){Q.map.triggerRepaint()}),Q.map&&Q.video.play(),Q._finishLoading())})},W.prototype.pause=function(){this.video&&this.video.pause()},W.prototype.play=function(){this.video&&this.video.play()},W.prototype.seek=function(Q){if(this.video){var de=this.video.seekable;Q<de.start(0)||Q>de.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+de.start(0)+" and "+de.end(0)+"-second mark."))):this.video.currentTime=Q}},W.prototype.getVideo=function(){return this.video},W.prototype.onAdd=function(Q){this.map||(this.map=Q,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},W.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var Q=this.map.painter.context,de=Q.gl;this.boundsBuffer||(this.boundsBuffer=Q.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE),de.texSubImage2D(de.TEXTURE_2D,0,0,0,de.RGBA,de.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(Q,this.video,de.RGBA),this.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE));for(var Le in this.tiles){var ze=this.tiles[Le];ze.state!=="loaded"&&(ze.state="loaded",ze.texture=this.texture)}}},W.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},W.prototype.hasTransition=function(){return this.video&&!this.video.paused},W}(re),te=function(ce){function W(pe,Q,de,Le){ce.call(this,pe,Q,de,Le),Q.coordinates?(!Array.isArray(Q.coordinates)||Q.coordinates.length!==4||Q.coordinates.some(function(ze){return!Array.isArray(ze)||ze.length!==2||ze.some(function(Ke){return typeof Ke!="number"})}))&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+pe,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+pe,null,'missing required property "coordinates"'))),Q.animate&&typeof Q.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+pe,null,'optional "animate" property must be a boolean value'))),Q.canvas?typeof Q.canvas!="string"&&!(Q.canvas instanceof e.window.HTMLCanvasElement)&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+pe,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+pe,null,'missing required property "canvas"'))),this.options=Q,this.animate=Q.animate!==void 0?Q.animate:!0}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.load=function(){if(this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()){this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading()},W.prototype.getCanvas=function(){return this.canvas},W.prototype.onAdd=function(Q){this.map=Q,this.load(),this.canvas&&this.animate&&this.play()},W.prototype.onRemove=function(){this.pause()},W.prototype.prepare=function(){var Q=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,Q=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,Q=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var de=this.map.painter.context,Le=de.gl;this.boundsBuffer||(this.boundsBuffer=de.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(Q||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(de,this.canvas,Le.RGBA,{premultiply:!0});for(var ze in this.tiles){var Ke=this.tiles[ze];Ke.state!=="loaded"&&(Ke.state="loaded",Ke.texture=this.texture)}}},W.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},W.prototype.hasTransition=function(){return this._playing},W.prototype._hasInvalidDimensions=function(){for(var Q=0,de=[this.canvas.width,this.canvas.height];Q<de.length;Q+=1){var Le=de[Q];if(isNaN(Le)||Le<=0)return!0}return!1},W}(re),G={vector:V,raster:H,"raster-dem":j,geojson:Z,video:K,image:re,canvas:te},Y=function(ce,W,pe,Q){var de=new G[W.type](ce,W,pe,Q);if(de.id!==ce)throw new Error("Expected Source id to be "+ce+" instead of "+de.id);return e.bindAll(["load","abort","unload","serialize","prepare"],de),de},ee=function(ce){return G[ce]},ne=function(ce,W){G[ce]=W};function J(ce,W){var pe=e.identity([]);return e.translate(pe,pe,[1,1,0]),e.scale(pe,pe,[ce.width*.5,ce.height*.5,1]),e.multiply(pe,pe,ce.calculatePosMatrix(W.toUnwrapped()))}function q(ce,W,pe){if(ce)for(var Q=0,de=ce;Q<de.length;Q+=1){var Le=de[Q],ze=W[Le];if(ze&&ze.source===pe&&ze.type==="fill-extrusion")return!0}else for(var Ke in W){var ct=W[Ke];if(ct.source===pe&&ct.type==="fill-extrusion")return!0}return!1}function ae(ce,W,pe,Q,de,Le){var ze=q(de&&de.layers,W,ce.id),Ke=Le.maxPitchScaleFactor(),ct=ce.tilesIn(Q,Ke,ze);ct.sort(se);for(var Lt=[],$t=0,cr=ct;$t<cr.length;$t+=1){var dr=cr[$t];Lt.push({wrappedTileID:dr.tileID.wrapped().key,queryResults:dr.tile.queryRenderedFeatures(W,pe,ce._state,dr.queryGeometry,dr.cameraQueryGeometry,dr.scale,de,Le,Ke,J(ce.transform,dr.tileID))})}var Lr=xe(Lt);for(var Yr in Lr)Lr[Yr].forEach(function(Xr){var Gr=Xr.feature,$r=ce.getFeatureState(Gr.layer["source-layer"],Gr.id);Gr.source=Gr.layer.source,Gr.layer["source-layer"]&&(Gr.sourceLayer=Gr.layer["source-layer"]),Gr.state=$r});return Lr}function le(ce,W,pe,Q,de,Le,ze){for(var Ke={},ct=Le.queryRenderedSymbols(Q),Lt=[],$t=0,cr=Object.keys(ct).map(Number);$t<cr.length;$t+=1){var dr=cr[$t];Lt.push(ze[dr])}Lt.sort(se);for(var Lr=function(){var pn=Xr[Yr],Ln=pn.featureIndex.lookupSymbolFeatures(ct[pn.bucketInstanceId],W,pn.bucketIndex,pn.sourceLayerIndex,de.filter,de.layers,de.availableImages,ce);for(var Nn in Ln){var Qn=Ke[Nn]=Ke[Nn]||[],ta=Ln[Nn];ta.sort(function(ba,Sa){var Pa=pn.featureSortOrder;if(Pa){var Ya=Pa.indexOf(ba.featureIndex),si=Pa.indexOf(Sa.featureIndex);return si-Ya}else return Sa.featureIndex-ba.featureIndex});for(var qn=0,pa=ta;qn<pa.length;qn+=1){var Ta=pa[qn];Qn.push(Ta)}}},Yr=0,Xr=Lt;Yr<Xr.length;Yr+=1)Lr();var Gr=function(pn){Ke[pn].forEach(function(Ln){var Nn=Ln.feature,Qn=ce[pn],ta=pe[Qn.source],qn=ta.getFeatureState(Nn.layer["source-layer"],Nn.id);Nn.source=Nn.layer.source,Nn.layer["source-layer"]&&(Nn.sourceLayer=Nn.layer["source-layer"]),Nn.state=qn})};for(var $r in Ke)Gr($r);return Ke}function ie(ce,W){for(var pe=ce.getRenderableIds().map(function(ct){return ce.getTileByID(ct)}),Q=[],de={},Le=0;Le<pe.length;Le++){var ze=pe[Le],Ke=ze.tileID.canonical.key;de[Ke]||(de[Ke]=!0,ze.querySourceFeatures(Q,W))}return Q}function se(ce,W){var pe=ce.tileID,Q=W.tileID;return pe.overscaledZ-Q.overscaledZ||pe.canonical.y-Q.canonical.y||pe.wrap-Q.wrap||pe.canonical.x-Q.canonical.x}function xe(ce){for(var W={},pe={},Q=0,de=ce;Q<de.length;Q+=1){var Le=de[Q],ze=Le.queryResults,Ke=Le.wrappedTileID,ct=pe[Ke]=pe[Ke]||{};for(var Lt in ze)for(var $t=ze[Lt],cr=ct[Lt]=ct[Lt]||{},dr=W[Lt]=W[Lt]||[],Lr=0,Yr=$t;Lr<Yr.length;Lr+=1){var Xr=Yr[Lr];cr[Xr.featureIndex]||(cr[Xr.featureIndex]=!0,dr.push(Xr))}}return W}var oe=function(W,pe){this.max=W,this.onRemove=pe,this.reset()};oe.prototype.reset=function(){for(var W in this.data)for(var pe=0,Q=this.data[W];pe<Q.length;pe+=1){var de=Q[pe];de.timeout&&clearTimeout(de.timeout),this.onRemove(de.value)}return this.data={},this.order=[],this},oe.prototype.add=function(W,pe,Q){var de=this,Le=W.wrapped().key;this.data[Le]===void 0&&(this.data[Le]=[]);var ze={value:pe,timeout:void 0};if(Q!==void 0&&(ze.timeout=setTimeout(function(){de.remove(W,ze)},Q)),this.data[Le].push(ze),this.order.push(Le),this.order.length>this.max){var Ke=this._getAndRemoveByKey(this.order[0]);Ke&&this.onRemove(Ke)}return this},oe.prototype.has=function(W){return W.wrapped().key in this.data},oe.prototype.getAndRemove=function(W){return this.has(W)?this._getAndRemoveByKey(W.wrapped().key):null},oe.prototype._getAndRemoveByKey=function(W){var pe=this.data[W].shift();return pe.timeout&&clearTimeout(pe.timeout),this.data[W].length===0&&delete this.data[W],this.order.splice(this.order.indexOf(W),1),pe.value},oe.prototype.getByKey=function(W){var pe=this.data[W];return pe?pe[0].value:null},oe.prototype.get=function(W){if(!this.has(W))return null;var pe=this.data[W.wrapped().key][0];return pe.value},oe.prototype.remove=function(W,pe){if(!this.has(W))return this;var Q=W.wrapped().key,de=pe===void 0?0:this.data[Q].indexOf(pe),Le=this.data[Q][de];return this.data[Q].splice(de,1),Le.timeout&&clearTimeout(Le.timeout),this.data[Q].length===0&&delete this.data[Q],this.onRemove(Le.value),this.order.splice(this.order.indexOf(Q),1),this},oe.prototype.setMaxSize=function(W){for(this.max=W;this.order.length>this.max;){var pe=this._getAndRemoveByKey(this.order[0]);pe&&this.onRemove(pe)}return this},oe.prototype.filter=function(W){var pe=[];for(var Q in this.data)for(var de=0,Le=this.data[Q];de<Le.length;de+=1){var ze=Le[de];W(ze.value)||pe.push(ze)}for(var Ke=0,ct=pe;Ke<ct.length;Ke+=1){var Lt=ct[Ke];this.remove(Lt.value.tileID,Lt)}};var he=function(W,pe,Q){this.context=W;var de=W.gl;this.buffer=de.createBuffer(),this.dynamicDraw=Boolean(Q),this.context.unbindVAO(),W.bindElementBuffer.set(this.buffer),de.bufferData(de.ELEMENT_ARRAY_BUFFER,pe.arrayBuffer,this.dynamicDraw?de.DYNAMIC_DRAW:de.STATIC_DRAW),this.dynamicDraw||delete pe.arrayBuffer};he.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},he.prototype.updateData=function(W){var pe=this.context.gl;this.context.unbindVAO(),this.bind(),pe.bufferSubData(pe.ELEMENT_ARRAY_BUFFER,0,W.arrayBuffer)},he.prototype.destroy=function(){var W=this.context.gl;this.buffer&&(W.deleteBuffer(this.buffer),delete this.buffer)};var be={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},me=function(W,pe,Q,de){this.length=pe.length,this.attributes=Q,this.itemSize=pe.bytesPerElement,this.dynamicDraw=de,this.context=W;var Le=W.gl;this.buffer=Le.createBuffer(),W.bindVertexBuffer.set(this.buffer),Le.bufferData(Le.ARRAY_BUFFER,pe.arrayBuffer,this.dynamicDraw?Le.DYNAMIC_DRAW:Le.STATIC_DRAW),this.dynamicDraw||delete pe.arrayBuffer};me.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},me.prototype.updateData=function(W){var pe=this.context.gl;this.bind(),pe.bufferSubData(pe.ARRAY_BUFFER,0,W.arrayBuffer)},me.prototype.enableAttributes=function(W,pe){for(var Q=0;Q<this.attributes.length;Q++){var de=this.attributes[Q],Le=pe.attributes[de.name];Le!==void 0&&W.enableVertexAttribArray(Le)}},me.prototype.setVertexAttribPointers=function(W,pe,Q){for(var de=0;de<this.attributes.length;de++){var Le=this.attributes[de],ze=pe.attributes[Le.name];ze!==void 0&&W.vertexAttribPointer(ze,Le.components,W[be[Le.type]],!1,this.itemSize,Le.offset+this.itemSize*(Q||0))}},me.prototype.destroy=function(){var W=this.context.gl;this.buffer&&(W.deleteBuffer(this.buffer),delete this.buffer)};var _e=function(W){this.gl=W.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};_e.prototype.get=function(){return this.current},_e.prototype.set=function(W){},_e.prototype.getDefault=function(){return this.default},_e.prototype.setDefault=function(){this.set(this.default)};var Se=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return e.Color.transparent},W.prototype.set=function(Q){var de=this.current;Q.r===de.r&&Q.g===de.g&&Q.b===de.b&&Q.a===de.a&&!this.dirty||(this.gl.clearColor(Q.r,Q.g,Q.b,Q.a),this.current=Q,this.dirty=!1)},W}(_e),De=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return 1},W.prototype.set=function(Q){Q===this.current&&!this.dirty||(this.gl.clearDepth(Q),this.current=Q,this.dirty=!1)},W}(_e),Ie=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return 0},W.prototype.set=function(Q){Q===this.current&&!this.dirty||(this.gl.clearStencil(Q),this.current=Q,this.dirty=!1)},W}(_e),Te=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return[!0,!0,!0,!0]},W.prototype.set=function(Q){var de=this.current;Q[0]===de[0]&&Q[1]===de[1]&&Q[2]===de[2]&&Q[3]===de[3]&&!this.dirty||(this.gl.colorMask(Q[0],Q[1],Q[2],Q[3]),this.current=Q,this.dirty=!1)},W}(_e),Ce=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return!0},W.prototype.set=function(Q){Q===this.current&&!this.dirty||(this.gl.depthMask(Q),this.current=Q,this.dirty=!1)},W}(_e),He=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return 255},W.prototype.set=function(Q){Q===this.current&&!this.dirty||(this.gl.stencilMask(Q),this.current=Q,this.dirty=!1)},W}(_e),Xe=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},W.prototype.set=function(Q){var de=this.current;Q.func===de.func&&Q.ref===de.ref&&Q.mask===de.mask&&!this.dirty||(this.gl.stencilFunc(Q.func,Q.ref,Q.mask),this.current=Q,this.dirty=!1)},W}(_e),Be=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){var Q=this.gl;return[Q.KEEP,Q.KEEP,Q.KEEP]},W.prototype.set=function(Q){var de=this.current;Q[0]===de[0]&&Q[1]===de[1]&&Q[2]===de[2]&&!this.dirty||(this.gl.stencilOp(Q[0],Q[1],Q[2]),this.current=Q,this.dirty=!1)},W}(_e),Re=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return!1},W.prototype.set=function(Q){if(!(Q===this.current&&!this.dirty)){var de=this.gl;Q?de.enable(de.STENCIL_TEST):de.disable(de.STENCIL_TEST),this.current=Q,this.dirty=!1}},W}(_e),We=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return[0,1]},W.prototype.set=function(Q){var de=this.current;Q[0]===de[0]&&Q[1]===de[1]&&!this.dirty||(this.gl.depthRange(Q[0],Q[1]),this.current=Q,this.dirty=!1)},W}(_e),vt=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return!1},W.prototype.set=function(Q){if(!(Q===this.current&&!this.dirty)){var de=this.gl;Q?de.enable(de.DEPTH_TEST):de.disable(de.DEPTH_TEST),this.current=Q,this.dirty=!1}},W}(_e),Pt=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return this.gl.LESS},W.prototype.set=function(Q){Q===this.current&&!this.dirty||(this.gl.depthFunc(Q),this.current=Q,this.dirty=!1)},W}(_e),Zt=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return!1},W.prototype.set=function(Q){if(!(Q===this.current&&!this.dirty)){var de=this.gl;Q?de.enable(de.BLEND):de.disable(de.BLEND),this.current=Q,this.dirty=!1}},W}(_e),zt=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){var Q=this.gl;return[Q.ONE,Q.ZERO]},W.prototype.set=function(Q){var de=this.current;Q[0]===de[0]&&Q[1]===de[1]&&!this.dirty||(this.gl.blendFunc(Q[0],Q[1]),this.current=Q,this.dirty=!1)},W}(_e),At=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return e.Color.transparent},W.prototype.set=function(Q){var de=this.current;Q.r===de.r&&Q.g===de.g&&Q.b===de.b&&Q.a===de.a&&!this.dirty||(this.gl.blendColor(Q.r,Q.g,Q.b,Q.a),this.current=Q,this.dirty=!1)},W}(_e),Wt=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return this.gl.FUNC_ADD},W.prototype.set=function(Q){Q===this.current&&!this.dirty||(this.gl.blendEquation(Q),this.current=Q,this.dirty=!1)},W}(_e),Bt=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return!1},W.prototype.set=function(Q){if(!(Q===this.current&&!this.dirty)){var de=this.gl;Q?de.enable(de.CULL_FACE):de.disable(de.CULL_FACE),this.current=Q,this.dirty=!1}},W}(_e),Ct=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return this.gl.BACK},W.prototype.set=function(Q){Q===this.current&&!this.dirty||(this.gl.cullFace(Q),this.current=Q,this.dirty=!1)},W}(_e),Ze=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return this.gl.CCW},W.prototype.set=function(Q){Q===this.current&&!this.dirty||(this.gl.frontFace(Q),this.current=Q,this.dirty=!1)},W}(_e),nt=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return null},W.prototype.set=function(Q){Q===this.current&&!this.dirty||(this.gl.useProgram(Q),this.current=Q,this.dirty=!1)},W}(_e),Ye=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return this.gl.TEXTURE0},W.prototype.set=function(Q){Q===this.current&&!this.dirty||(this.gl.activeTexture(Q),this.current=Q,this.dirty=!1)},W}(_e),Ee=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){var Q=this.gl;return[0,0,Q.drawingBufferWidth,Q.drawingBufferHeight]},W.prototype.set=function(Q){var de=this.current;Q[0]===de[0]&&Q[1]===de[1]&&Q[2]===de[2]&&Q[3]===de[3]&&!this.dirty||(this.gl.viewport(Q[0],Q[1],Q[2],Q[3]),this.current=Q,this.dirty=!1)},W}(_e),Ge=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return null},W.prototype.set=function(Q){if(!(Q===this.current&&!this.dirty)){var de=this.gl;de.bindFramebuffer(de.FRAMEBUFFER,Q),this.current=Q,this.dirty=!1}},W}(_e),Je=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return null},W.prototype.set=function(Q){if(!(Q===this.current&&!this.dirty)){var de=this.gl;de.bindRenderbuffer(de.RENDERBUFFER,Q),this.current=Q,this.dirty=!1}},W}(_e),qe=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return null},W.prototype.set=function(Q){if(!(Q===this.current&&!this.dirty)){var de=this.gl;de.bindTexture(de.TEXTURE_2D,Q),this.current=Q,this.dirty=!1}},W}(_e),Tt=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return null},W.prototype.set=function(Q){if(!(Q===this.current&&!this.dirty)){var de=this.gl;de.bindBuffer(de.ARRAY_BUFFER,Q),this.current=Q,this.dirty=!1}},W}(_e),mt=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return null},W.prototype.set=function(Q){var de=this.gl;de.bindBuffer(de.ELEMENT_ARRAY_BUFFER,Q),this.current=Q,this.dirty=!1},W}(_e),Mt=function(ce){function W(pe){ce.call(this,pe),this.vao=pe.extVertexArrayObject}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return null},W.prototype.set=function(Q){!this.vao||Q===this.current&&!this.dirty||(this.vao.bindVertexArrayOES(Q),this.current=Q,this.dirty=!1)},W}(_e),Ht=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return 4},W.prototype.set=function(Q){if(!(Q===this.current&&!this.dirty)){var de=this.gl;de.pixelStorei(de.UNPACK_ALIGNMENT,Q),this.current=Q,this.dirty=!1}},W}(_e),Rt=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return!1},W.prototype.set=function(Q){if(!(Q===this.current&&!this.dirty)){var de=this.gl;de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Q),this.current=Q,this.dirty=!1}},W}(_e),Vt=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return!1},W.prototype.set=function(Q){if(!(Q===this.current&&!this.dirty)){var de=this.gl;de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,Q),this.current=Q,this.dirty=!1}},W}(_e),Jt=function(ce){function W(pe,Q){ce.call(this,pe),this.context=pe,this.parent=Q}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getDefault=function(){return null},W}(_e),Yt=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.setDirty=function(){this.dirty=!0},W.prototype.set=function(Q){if(!(Q===this.current&&!this.dirty)){this.context.bindFramebuffer.set(this.parent);var de=this.gl;de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,Q,0),this.current=Q,this.dirty=!1}},W}(Jt),or=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.set=function(Q){if(!(Q===this.current&&!this.dirty)){this.context.bindFramebuffer.set(this.parent);var de=this.gl;de.framebufferRenderbuffer(de.FRAMEBUFFER,de.DEPTH_ATTACHMENT,de.RENDERBUFFER,Q),this.current=Q,this.dirty=!1}},W}(Jt),Hr=function(W,pe,Q,de){this.context=W,this.width=pe,this.height=Q;var Le=W.gl,ze=this.framebuffer=Le.createFramebuffer();this.colorAttachment=new Yt(W,ze),de&&(this.depthAttachment=new or(W,ze))};Hr.prototype.destroy=function(){var W=this.context.gl,pe=this.colorAttachment.get();if(pe&&W.deleteTexture(pe),this.depthAttachment){var Q=this.depthAttachment.get();Q&&W.deleteRenderbuffer(Q)}W.deleteFramebuffer(this.framebuffer)};var an=519,Kr=function(W,pe,Q){this.func=W,this.mask=pe,this.range=Q};Kr.ReadOnly=!1,Kr.ReadWrite=!0,Kr.disabled=new Kr(an,Kr.ReadOnly,[0,1]);var ot=519,er=7680,Kt=function(W,pe,Q,de,Le,ze){this.test=W,this.ref=pe,this.mask=Q,this.fail=de,this.depthFail=Le,this.pass=ze};Kt.disabled=new Kt({func:ot,mask:0},0,0,er,er,er);var ur=0,Ar=1,et=771,$e=function(W,pe,Q){this.blendFunction=W,this.blendColor=pe,this.mask=Q};$e.Replace=[Ar,ur],$e.disabled=new $e($e.Replace,e.Color.transparent,[!1,!1,!1,!1]),$e.unblended=new $e($e.Replace,e.Color.transparent,[!0,!0,!0,!0]),$e.alphaBlended=new $e([Ar,et],e.Color.transparent,[!0,!0,!0,!0]);var st=1029,ft=2305,St=function(W,pe,Q){this.enable=W,this.mode=pe,this.frontFace=Q};St.disabled=new St(!1,st,ft),St.backCCW=new St(!0,st,ft);var Ut=function(W){this.gl=W,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Se(this),this.clearDepth=new De(this),this.clearStencil=new Ie(this),this.colorMask=new Te(this),this.depthMask=new Ce(this),this.stencilMask=new He(this),this.stencilFunc=new Xe(this),this.stencilOp=new Be(this),this.stencilTest=new Re(this),this.depthRange=new We(this),this.depthTest=new vt(this),this.depthFunc=new Pt(this),this.blend=new Zt(this),this.blendFunc=new zt(this),this.blendColor=new At(this),this.blendEquation=new Wt(this),this.cullFace=new Bt(this),this.cullFaceSide=new Ct(this),this.frontFace=new Ze(this),this.program=new nt(this),this.activeTexture=new Ye(this),this.viewport=new Ee(this),this.bindFramebuffer=new Ge(this),this.bindRenderbuffer=new Je(this),this.bindTexture=new qe(this),this.bindVertexBuffer=new Tt(this),this.bindElementBuffer=new mt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Mt(this),this.pixelStoreUnpack=new Ht(this),this.pixelStoreUnpackPremultiplyAlpha=new Rt(this),this.pixelStoreUnpackFlipY=new Vt(this),this.extTextureFilterAnisotropic=W.getExtension("EXT_texture_filter_anisotropic")||W.getExtension("MOZ_EXT_texture_filter_anisotropic")||W.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=W.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=W.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(W.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=W.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=W.getExtension("EXT_disjoint_timer_query")};Ut.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ut.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ut.prototype.createIndexBuffer=function(W,pe){return new he(this,W,pe)},Ut.prototype.createVertexBuffer=function(W,pe,Q){return new me(this,W,pe,Q)},Ut.prototype.createRenderbuffer=function(W,pe,Q){var de=this.gl,Le=de.createRenderbuffer();return this.bindRenderbuffer.set(Le),de.renderbufferStorage(de.RENDERBUFFER,W,pe,Q),this.bindRenderbuffer.set(null),Le},Ut.prototype.createFramebuffer=function(W,pe,Q){return new Hr(this,W,pe,Q)},Ut.prototype.clear=function(W){var pe=W.color,Q=W.depth,de=this.gl,Le=0;pe&&(Le|=de.COLOR_BUFFER_BIT,this.clearColor.set(pe),this.colorMask.set([!0,!0,!0,!0])),typeof Q<"u"&&(Le|=de.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(Q),this.depthMask.set(!0)),de.clear(Le)},Ut.prototype.setCullFace=function(W){W.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(W.mode),this.frontFace.set(W.frontFace))},Ut.prototype.setDepthMode=function(W){W.func===this.gl.ALWAYS&&!W.mask?this.depthTest.set(!1):(this.depthTest.set(!0),this.depthFunc.set(W.func),this.depthMask.set(W.mask),this.depthRange.set(W.range))},Ut.prototype.setStencilMode=function(W){W.test.func===this.gl.ALWAYS&&!W.mask?this.stencilTest.set(!1):(this.stencilTest.set(!0),this.stencilMask.set(W.mask),this.stencilOp.set([W.fail,W.depthFail,W.pass]),this.stencilFunc.set({func:W.test.func,ref:W.ref,mask:W.test.mask}))},Ut.prototype.setColorMode=function(W){e.deepEqual(W.blendFunction,$e.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(W.blendFunction),this.blendColor.set(W.blendColor)),this.colorMask.set(W.mask)},Ut.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Pe=function(ce){function W(pe,Q,de){var Le=this;ce.call(this),this.id=pe,this.dispatcher=de,this.on("data",function(ze){ze.dataType==="source"&&ze.sourceDataType==="metadata"&&(Le._sourceLoaded=!0),Le._sourceLoaded&&!Le._paused&&ze.dataType==="source"&&ze.sourceDataType==="content"&&(Le.reload(),Le.transform&&Le.update(Le.transform))}),this.on("error",function(){Le._sourceErrored=!0}),this._source=Y(pe,Q,de,this),this._tiles={},this._cache=new oe(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.onAdd=function(Q){this.map=Q,this._maxTileCacheSize=Q?Q._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(Q)},W.prototype.onRemove=function(Q){this._source&&this._source.onRemove&&this._source.onRemove(Q)},W.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var Q in this._tiles){var de=this._tiles[Q];if(de.state!=="loaded"&&de.state!=="errored")return!1}return!0},W.prototype.getSource=function(){return this._source},W.prototype.pause=function(){this._paused=!0},W.prototype.resume=function(){if(!!this._paused){var Q=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,Q&&this.reload(),this.transform&&this.update(this.transform)}},W.prototype._loadTile=function(Q,de){return this._source.loadTile(Q,de)},W.prototype._unloadTile=function(Q){if(this._source.unloadTile)return this._source.unloadTile(Q,function(){})},W.prototype._abortTile=function(Q){if(this._source.abortTile)return this._source.abortTile(Q,function(){})},W.prototype.serialize=function(){return this._source.serialize()},W.prototype.prepare=function(Q){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(var de in this._tiles){var Le=this._tiles[de];Le.upload(Q),Le.prepare(this.map.style.imageManager)}},W.prototype.getIds=function(){return e.values(this._tiles).map(function(Q){return Q.tileID}).sort(ke).map(function(Q){return Q.key})},W.prototype.getRenderableIds=function(Q){var de=this,Le=[];for(var ze in this._tiles)this._isIdRenderable(ze,Q)&&Le.push(this._tiles[ze]);return Q?Le.sort(function(Ke,ct){var Lt=Ke.tileID,$t=ct.tileID,cr=new e.Point(Lt.canonical.x,Lt.canonical.y)._rotate(de.transform.angle),dr=new e.Point($t.canonical.x,$t.canonical.y)._rotate(de.transform.angle);return Lt.overscaledZ-$t.overscaledZ||dr.y-cr.y||dr.x-cr.x}).map(function(Ke){return Ke.tileID.key}):Le.map(function(Ke){return Ke.tileID}).sort(ke).map(function(Ke){return Ke.key})},W.prototype.hasRenderableParent=function(Q){var de=this.findLoadedParent(Q,0);return de?this._isIdRenderable(de.tileID.key):!1},W.prototype._isIdRenderable=function(Q,de){return this._tiles[Q]&&this._tiles[Q].hasData()&&!this._coveredTiles[Q]&&(de||!this._tiles[Q].holdingForFade())},W.prototype.reload=function(){if(this._paused){this._shouldReloadOnResume=!0;return}this._cache.reset();for(var Q in this._tiles)this._tiles[Q].state!=="errored"&&this._reloadTile(Q,"reloading")},W.prototype._reloadTile=function(Q,de){var Le=this._tiles[Q];!Le||(Le.state!=="loading"&&(Le.state=de),this._loadTile(Le,this._tileLoaded.bind(this,Le,Q,de)))},W.prototype._tileLoaded=function(Q,de,Le,ze){if(ze){Q.state="errored",ze.status!==404?this._source.fire(new e.ErrorEvent(ze,{tile:Q})):this.update(this.transform);return}Q.timeAdded=e.browser.now(),Le==="expired"&&(Q.refreshedUponExpiration=!0),this._setTileReloadTimer(de,Q),this.getSource().type==="raster-dem"&&Q.dem&&this._backfillDEM(Q),this._state.initializeTileState(Q,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:Q,coord:Q.tileID}))},W.prototype._backfillDEM=function(Q){for(var de=this.getRenderableIds(),Le=0;Le<de.length;Le++){var ze=de[Le];if(Q.neighboringTiles&&Q.neighboringTiles[ze]){var Ke=this.getTileByID(ze);ct(Q,Ke),ct(Ke,Q)}}function ct(Lt,$t){Lt.needsHillshadePrepare=!0;var cr=$t.tileID.canonical.x-Lt.tileID.canonical.x,dr=$t.tileID.canonical.y-Lt.tileID.canonical.y,Lr=Math.pow(2,Lt.tileID.canonical.z),Yr=$t.tileID.key;cr===0&&dr===0||Math.abs(dr)>1||(Math.abs(cr)>1&&(Math.abs(cr+Lr)===1?cr+=Lr:Math.abs(cr-Lr)===1&&(cr-=Lr)),!(!$t.dem||!Lt.dem)&&(Lt.dem.backfillBorder($t.dem,cr,dr),Lt.neighboringTiles&&Lt.neighboringTiles[Yr]&&(Lt.neighboringTiles[Yr].backfilled=!0)))}},W.prototype.getTile=function(Q){return this.getTileByID(Q.key)},W.prototype.getTileByID=function(Q){return this._tiles[Q]},W.prototype._retainLoadedChildren=function(Q,de,Le,ze){for(var Ke in this._tiles){var ct=this._tiles[Ke];if(!(ze[Ke]||!ct.hasData()||ct.tileID.overscaledZ<=de||ct.tileID.overscaledZ>Le)){for(var Lt=ct.tileID;ct&&ct.tileID.overscaledZ>de+1;){var $t=ct.tileID.scaledTo(ct.tileID.overscaledZ-1);ct=this._tiles[$t.key],ct&&ct.hasData()&&(Lt=$t)}for(var cr=Lt;cr.overscaledZ>de;)if(cr=cr.scaledTo(cr.overscaledZ-1),Q[cr.key]){ze[Lt.key]=Lt;break}}}},W.prototype.findLoadedParent=function(Q,de){if(Q.key in this._loadedParentTiles){var Le=this._loadedParentTiles[Q.key];return Le&&Le.tileID.overscaledZ>=de?Le:null}for(var ze=Q.overscaledZ-1;ze>=de;ze--){var Ke=Q.scaledTo(ze),ct=this._getLoadedTile(Ke);if(ct)return ct}},W.prototype._getLoadedTile=function(Q){var de=this._tiles[Q.key];if(de&&de.hasData())return de;var Le=this._cache.getByKey(Q.wrapped().key);return Le},W.prototype.updateCacheSize=function(Q){var de=Math.ceil(Q.width/this._source.tileSize)+1,Le=Math.ceil(Q.height/this._source.tileSize)+1,ze=de*Le,Ke=5,ct=Math.floor(ze*Ke),Lt=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,ct):ct;this._cache.setMaxSize(Lt)},W.prototype.handleWrapJump=function(Q){var de=this._prevLng===void 0?Q:this._prevLng,Le=Q-de,ze=Le/360,Ke=Math.round(ze);if(this._prevLng=Q,Ke){var ct={};for(var Lt in this._tiles){var $t=this._tiles[Lt];$t.tileID=$t.tileID.unwrapTo($t.tileID.wrap+Ke),ct[$t.tileID.key]=$t}this._tiles=ct;for(var cr in this._timers)clearTimeout(this._timers[cr]),delete this._timers[cr];for(var dr in this._tiles){var Lr=this._tiles[dr];this._setTileReloadTimer(dr,Lr)}}},W.prototype.update=function(Q){var de=this;if(this.transform=Q,!(!this._sourceLoaded||this._paused)){this.updateCacheSize(Q),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={};var Le;this.used?this._source.tileID?Le=Q.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(ba){return new e.OverscaledTileID(ba.canonical.z,ba.wrap,ba.canonical.z,ba.canonical.x,ba.canonical.y)}):(Le=Q.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(Le=Le.filter(function(ba){return de._source.hasTile(ba)}))):Le=[];var ze=Q.coveringZoomLevel(this._source),Ke=Math.max(ze-W.maxOverzooming,this._source.minzoom),ct=Math.max(ze+W.maxUnderzooming,this._source.minzoom),Lt=this._updateRetainedTiles(Le,ze);if(it(this._source.type)){for(var $t={},cr={},dr=Object.keys(Lt),Lr=0,Yr=dr;Lr<Yr.length;Lr+=1){var Xr=Yr[Lr],Gr=Lt[Xr],$r=this._tiles[Xr];if(!(!$r||$r.fadeEndTime&&$r.fadeEndTime<=e.browser.now())){var pn=this.findLoadedParent(Gr,Ke);pn&&(this._addTile(pn.tileID),$t[pn.tileID.key]=pn.tileID),cr[Xr]=Gr}}this._retainLoadedChildren(cr,ze,ct,Lt);for(var Ln in $t)Lt[Ln]||(this._coveredTiles[Ln]=!0,Lt[Ln]=$t[Ln])}for(var Nn in Lt)this._tiles[Nn].clearFadeHold();for(var Qn=e.keysDifference(this._tiles,Lt),ta=0,qn=Qn;ta<qn.length;ta+=1){var pa=qn[ta],Ta=this._tiles[pa];Ta.hasSymbolBuckets&&!Ta.holdingForFade()?Ta.setHoldDuration(this.map._fadeDuration):(!Ta.hasSymbolBuckets||Ta.symbolFadeFinished())&&this._removeTile(pa)}this._updateLoadedParentTileCache()}},W.prototype.releaseSymbolFadeTiles=function(){for(var Q in this._tiles)this._tiles[Q].holdingForFade()&&this._removeTile(Q)},W.prototype._updateRetainedTiles=function(Q,de){for(var Le={},ze={},Ke=Math.max(de-W.maxOverzooming,this._source.minzoom),ct=Math.max(de+W.maxUnderzooming,this._source.minzoom),Lt={},$t=0,cr=Q;$t<cr.length;$t+=1){var dr=cr[$t],Lr=this._addTile(dr);Le[dr.key]=dr,!Lr.hasData()&&de<this._source.maxzoom&&(Lt[dr.key]=dr)}this._retainLoadedChildren(Lt,de,ct,Le);for(var Yr=0,Xr=Q;Yr<Xr.length;Yr+=1){var Gr=Xr[Yr],$r=this._tiles[Gr.key];if(!$r.hasData()){if(de+1>this._source.maxzoom){var pn=Gr.children(this._source.maxzoom)[0],Ln=this.getTile(pn);if(!!Ln&&Ln.hasData()){Le[pn.key]=pn;continue}}else{var Nn=Gr.children(this._source.maxzoom);if(Le[Nn[0].key]&&Le[Nn[1].key]&&Le[Nn[2].key]&&Le[Nn[3].key])continue}for(var Qn=$r.wasRequested(),ta=Gr.overscaledZ-1;ta>=Ke;--ta){var qn=Gr.scaledTo(ta);if(ze[qn.key]||(ze[qn.key]=!0,$r=this.getTile(qn),!$r&&Qn&&($r=this._addTile(qn)),$r&&(Le[qn.key]=qn,Qn=$r.wasRequested(),$r.hasData())))break}}}return Le},W.prototype._updateLoadedParentTileCache=function(){this._loadedParentTiles={};for(var Q in this._tiles){for(var de=[],Le=void 0,ze=this._tiles[Q].tileID;ze.overscaledZ>0;){if(ze.key in this._loadedParentTiles){Le=this._loadedParentTiles[ze.key];break}de.push(ze.key);var Ke=ze.scaledTo(ze.overscaledZ-1);if(Le=this._getLoadedTile(Ke),Le)break;ze=Ke}for(var ct=0,Lt=de;ct<Lt.length;ct+=1){var $t=Lt[ct];this._loadedParentTiles[$t]=Le}}},W.prototype._addTile=function(Q){var de=this._tiles[Q.key];if(de)return de;de=this._cache.getAndRemove(Q),de&&(this._setTileReloadTimer(Q.key,de),de.tileID=Q,this._state.initializeTileState(de,this.map?this.map.painter:null),this._cacheTimers[Q.key]&&(clearTimeout(this._cacheTimers[Q.key]),delete this._cacheTimers[Q.key],this._setTileReloadTimer(Q.key,de)));var Le=Boolean(de);return Le||(de=new e.Tile(Q,this._source.tileSize*Q.overscaleFactor()),this._loadTile(de,this._tileLoaded.bind(this,de,Q.key,de.state))),de?(de.uses++,this._tiles[Q.key]=de,Le||this._source.fire(new e.Event("dataloading",{tile:de,coord:de.tileID,dataType:"source"})),de):null},W.prototype._setTileReloadTimer=function(Q,de){var Le=this;Q in this._timers&&(clearTimeout(this._timers[Q]),delete this._timers[Q]);var ze=de.getExpiryTimeout();ze&&(this._timers[Q]=setTimeout(function(){Le._reloadTile(Q,"expired"),delete Le._timers[Q]},ze))},W.prototype._removeTile=function(Q){var de=this._tiles[Q];!de||(de.uses--,delete this._tiles[Q],this._timers[Q]&&(clearTimeout(this._timers[Q]),delete this._timers[Q]),!(de.uses>0)&&(de.hasData()&&de.state!=="reloading"?this._cache.add(de.tileID,de,de.getExpiryTimeout()):(de.aborted=!0,this._abortTile(de),this._unloadTile(de))))},W.prototype.clearTiles=function(){this._shouldReloadOnResume=!1,this._paused=!1;for(var Q in this._tiles)this._removeTile(Q);this._cache.reset()},W.prototype.tilesIn=function(Q,de,Le){var ze=this,Ke=[],ct=this.transform;if(!ct)return Ke;for(var Lt=Le?ct.getCameraQueryGeometry(Q):Q,$t=Q.map(function(ta){return ct.pointCoordinate(ta)}),cr=Lt.map(function(ta){return ct.pointCoordinate(ta)}),dr=this.getIds(),Lr=1/0,Yr=1/0,Xr=-1/0,Gr=-1/0,$r=0,pn=cr;$r<pn.length;$r+=1){var Ln=pn[$r];Lr=Math.min(Lr,Ln.x),Yr=Math.min(Yr,Ln.y),Xr=Math.max(Xr,Ln.x),Gr=Math.max(Gr,Ln.y)}for(var Nn=function(ta){var qn=ze._tiles[dr[ta]];if(!qn.holdingForFade()){var pa=qn.tileID,Ta=Math.pow(2,ct.zoom-qn.tileID.overscaledZ),ba=de*qn.queryPadding*e.EXTENT/qn.tileSize/Ta,Sa=[pa.getTilePoint(new e.MercatorCoordinate(Lr,Yr)),pa.getTilePoint(new e.MercatorCoordinate(Xr,Gr))];if(Sa[0].x-ba<e.EXTENT&&Sa[0].y-ba<e.EXTENT&&Sa[1].x+ba>=0&&Sa[1].y+ba>=0){var Pa=$t.map(function(si){return pa.getTilePoint(si)}),Ya=cr.map(function(si){return pa.getTilePoint(si)});Ke.push({tile:qn,tileID:pa,queryGeometry:Pa,cameraQueryGeometry:Ya,scale:Ta})}}},Qn=0;Qn<dr.length;Qn++)Nn(Qn);return Ke},W.prototype.getVisibleCoordinates=function(Q){for(var de=this,Le=this.getRenderableIds(Q).map(function(Lt){return de._tiles[Lt].tileID}),ze=0,Ke=Le;ze<Ke.length;ze+=1){var ct=Ke[ze];ct.posMatrix=this.transform.calculatePosMatrix(ct.toUnwrapped())}return Le},W.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(it(this._source.type))for(var Q in this._tiles){var de=this._tiles[Q];if(de.fadeEndTime!==void 0&&de.fadeEndTime>=e.browser.now())return!0}return!1},W.prototype.setFeatureState=function(Q,de,Le){Q=Q||"_geojsonTileLayer",this._state.updateState(Q,de,Le)},W.prototype.removeFeatureState=function(Q,de,Le){Q=Q||"_geojsonTileLayer",this._state.removeFeatureState(Q,de,Le)},W.prototype.getFeatureState=function(Q,de){return Q=Q||"_geojsonTileLayer",this._state.getState(Q,de)},W.prototype.setDependencies=function(Q,de,Le){var ze=this._tiles[Q];ze&&ze.setDependencies(de,Le)},W.prototype.reloadTilesForDependencies=function(Q,de){for(var Le in this._tiles){var ze=this._tiles[Le];ze.hasDependency(Q,de)&&this._reloadTile(Le,"reloading")}this._cache.filter(function(Ke){return!Ke.hasDependency(Q,de)})},W}(e.Evented);Pe.maxOverzooming=10,Pe.maxUnderzooming=3;function ke(ce,W){var pe=Math.abs(ce.wrap*2)-+(ce.wrap<0),Q=Math.abs(W.wrap*2)-+(W.wrap<0);return ce.overscaledZ-W.overscaledZ||Q-pe||W.canonical.y-ce.canonical.y||W.canonical.x-ce.canonical.x}function it(ce){return ce==="raster"||ce==="image"||ce==="video"}function ut(){return new e.window.Worker(Zh.workerUrl)}var ht="mapboxgl_preloaded_worker_pool",Et=function(){this.active={}};Et.prototype.acquire=function(W){if(!this.workers)for(this.workers=[];this.workers.length<Et.workerCount;)this.workers.push(new ut);return this.active[W]=!0,this.workers.slice()},Et.prototype.release=function(W){delete this.active[W],this.numActive()===0&&(this.workers.forEach(function(pe){pe.terminate()}),this.workers=null)},Et.prototype.isPreloaded=function(){return!!this.active[ht]},Et.prototype.numActive=function(){return Object.keys(this.active).length};var yt=Math.floor(e.browser.hardwareConcurrency/2);Et.workerCount=Math.max(Math.min(yt,6),1);var Dt;function Xt(){return Dt||(Dt=new Et),Dt}function ar(){var ce=Xt();ce.acquire(ht)}function kr(){var ce=Dt;ce&&(ce.isPreloaded()&&ce.numActive()===1?(ce.release(ht),Dt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))}function wr(ce,W){var pe={};for(var Q in ce)Q!=="ref"&&(pe[Q]=ce[Q]);return e.refProperties.forEach(function(de){de in W&&(pe[de]=W[de])}),pe}function Sr(ce){ce=ce.slice();for(var W=Object.create(null),pe=0;pe<ce.length;pe++)W[ce[pe].id]=ce[pe];for(var Q=0;Q<ce.length;Q++)"ref"in ce[Q]&&(ce[Q]=wr(ce[Q],W[ce[Q].ref]));return ce}function Zr(){var ce={},W=e.styleSpec.$version;for(var pe in e.styleSpec.$root){var Q=e.styleSpec.$root[pe];if(Q.required){var de=null;pe==="version"?de=W:Q.type==="array"?de=[]:de={},de!=null&&(ce[pe]=de)}}return ce}var ir={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function xr(ce,W,pe){pe.push({command:ir.addSource,args:[ce,W[ce]]})}function Fr(ce,W,pe){W.push({command:ir.removeSource,args:[ce]}),pe[ce]=!0}function Or(ce,W,pe,Q){Fr(ce,pe,Q),xr(ce,W,pe)}function Cr(ce,W,pe){var Q;for(Q in ce[pe])if(!!ce[pe].hasOwnProperty(Q)&&Q!=="data"&&!e.deepEqual(ce[pe][Q],W[pe][Q]))return!1;for(Q in W[pe])if(!!W[pe].hasOwnProperty(Q)&&Q!=="data"&&!e.deepEqual(ce[pe][Q],W[pe][Q]))return!1;return!0}function at(ce,W,pe,Q){ce=ce||{},W=W||{};var de;for(de in ce)!ce.hasOwnProperty(de)||W.hasOwnProperty(de)||Fr(de,pe,Q);for(de in W)!W.hasOwnProperty(de)||(ce.hasOwnProperty(de)?e.deepEqual(ce[de],W[de])||(ce[de].type==="geojson"&&W[de].type==="geojson"&&Cr(ce,W,de)?pe.push({command:ir.setGeoJSONSourceData,args:[de,W[de].data]}):Or(de,W,pe,Q)):xr(de,W,pe))}function Ft(ce,W,pe,Q,de,Le){ce=ce||{},W=W||{};var ze;for(ze in ce)!ce.hasOwnProperty(ze)||e.deepEqual(ce[ze],W[ze])||pe.push({command:Le,args:[Q,ze,W[ze],de]});for(ze in W)!W.hasOwnProperty(ze)||ce.hasOwnProperty(ze)||e.deepEqual(ce[ze],W[ze])||pe.push({command:Le,args:[Q,ze,W[ze],de]})}function jt(ce){return ce.id}function sr(ce,W){return ce[W.id]=W,ce}function zr(ce,W,pe){ce=ce||[],W=W||[];var Q=ce.map(jt),de=W.map(jt),Le=ce.reduce(sr,{}),ze=W.reduce(sr,{}),Ke=Q.slice(),ct=Object.create(null),Lt,$t,cr,dr,Lr,Yr,Xr;for(Lt=0,$t=0;Lt<Q.length;Lt++)cr=Q[Lt],ze.hasOwnProperty(cr)?$t++:(pe.push({command:ir.removeLayer,args:[cr]}),Ke.splice(Ke.indexOf(cr,$t),1));for(Lt=0,$t=0;Lt<de.length;Lt++)cr=de[de.length-1-Lt],Ke[Ke.length-1-Lt]!==cr&&(Le.hasOwnProperty(cr)?(pe.push({command:ir.removeLayer,args:[cr]}),Ke.splice(Ke.lastIndexOf(cr,Ke.length-$t),1)):$t++,Yr=Ke[Ke.length-Lt],pe.push({command:ir.addLayer,args:[ze[cr],Yr]}),Ke.splice(Ke.length-Lt,0,cr),ct[cr]=!0);for(Lt=0;Lt<de.length;Lt++)if(cr=de[Lt],dr=Le[cr],Lr=ze[cr],!(ct[cr]||e.deepEqual(dr,Lr))){if(!e.deepEqual(dr.source,Lr.source)||!e.deepEqual(dr["source-layer"],Lr["source-layer"])||!e.deepEqual(dr.type,Lr.type)){pe.push({command:ir.removeLayer,args:[cr]}),Yr=Ke[Ke.lastIndexOf(cr)+1],pe.push({command:ir.addLayer,args:[Lr,Yr]});continue}Ft(dr.layout,Lr.layout,pe,cr,null,ir.setLayoutProperty),Ft(dr.paint,Lr.paint,pe,cr,null,ir.setPaintProperty),e.deepEqual(dr.filter,Lr.filter)||pe.push({command:ir.setFilter,args:[cr,Lr.filter]}),(!e.deepEqual(dr.minzoom,Lr.minzoom)||!e.deepEqual(dr.maxzoom,Lr.maxzoom))&&pe.push({command:ir.setLayerZoomRange,args:[cr,Lr.minzoom,Lr.maxzoom]});for(Xr in dr)!dr.hasOwnProperty(Xr)||Xr==="layout"||Xr==="paint"||Xr==="filter"||Xr==="metadata"||Xr==="minzoom"||Xr==="maxzoom"||(Xr.indexOf("paint.")===0?Ft(dr[Xr],Lr[Xr],pe,cr,Xr.slice(6),ir.setPaintProperty):e.deepEqual(dr[Xr],Lr[Xr])||pe.push({command:ir.setLayerProperty,args:[cr,Xr,Lr[Xr]]}));for(Xr in Lr)!Lr.hasOwnProperty(Xr)||dr.hasOwnProperty(Xr)||Xr==="layout"||Xr==="paint"||Xr==="filter"||Xr==="metadata"||Xr==="minzoom"||Xr==="maxzoom"||(Xr.indexOf("paint.")===0?Ft(dr[Xr],Lr[Xr],pe,cr,Xr.slice(6),ir.setPaintProperty):e.deepEqual(dr[Xr],Lr[Xr])||pe.push({command:ir.setLayerProperty,args:[cr,Xr,Lr[Xr]]}))}}function Ur(ce,W){if(!ce)return[{command:ir.setStyle,args:[W]}];var pe=[];try{if(!e.deepEqual(ce.version,W.version))return[{command:ir.setStyle,args:[W]}];e.deepEqual(ce.center,W.center)||pe.push({command:ir.setCenter,args:[W.center]}),e.deepEqual(ce.zoom,W.zoom)||pe.push({command:ir.setZoom,args:[W.zoom]}),e.deepEqual(ce.bearing,W.bearing)||pe.push({command:ir.setBearing,args:[W.bearing]}),e.deepEqual(ce.pitch,W.pitch)||pe.push({command:ir.setPitch,args:[W.pitch]}),e.deepEqual(ce.sprite,W.sprite)||pe.push({command:ir.setSprite,args:[W.sprite]}),e.deepEqual(ce.glyphs,W.glyphs)||pe.push({command:ir.setGlyphs,args:[W.glyphs]}),e.deepEqual(ce.transition,W.transition)||pe.push({command:ir.setTransition,args:[W.transition]}),e.deepEqual(ce.light,W.light)||pe.push({command:ir.setLight,args:[W.light]});var Q={},de=[];at(ce.sources,W.sources,de,Q);var Le=[];ce.layers&&ce.layers.forEach(function(ze){Q[ze.source]?pe.push({command:ir.removeLayer,args:[ze.id]}):Le.push(ze)}),pe=pe.concat(de),zr(Le,W.layers,pe)}catch(ze){console.warn("Unable to compute style diff:",ze),pe=[{command:ir.setStyle,args:[W]}]}return pe}var Dr=function(W,pe){this.reset(W,pe)};Dr.prototype.reset=function(W,pe){this.points=W||[],this._distances=[0];for(var Q=1;Q<this.points.length;Q++)this._distances[Q]=this._distances[Q-1]+this.points[Q].dist(this.points[Q-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(pe||0,this.length*.5),this.paddedLength=this.length-this.padding*2},Dr.prototype.lerp=function(W){if(this.points.length===1)return this.points[0];W=e.clamp(W,0,1);for(var pe=1,Q=this._distances[pe],de=W*this.paddedLength+this.padding;Q<de&&pe<this._distances.length;)Q=this._distances[++pe];var Le=pe-1,ze=this._distances[Le],Ke=Q-ze,ct=Ke>0?(de-ze)/Ke:0;return this.points[Le].mult(1-ct).add(this.points[pe].mult(ct))};var Tr=function(W,pe,Q){var de=this.boxCells=[],Le=this.circleCells=[];this.xCellCount=Math.ceil(W/Q),this.yCellCount=Math.ceil(pe/Q);for(var ze=0;ze<this.xCellCount*this.yCellCount;ze++)de.push([]),Le.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=W,this.height=pe,this.xScale=this.xCellCount/W,this.yScale=this.yCellCount/pe,this.boxUid=0,this.circleUid=0};Tr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Tr.prototype.insert=function(W,pe,Q,de,Le){this._forEachCell(pe,Q,de,Le,this._insertBoxCell,this.boxUid++),this.boxKeys.push(W),this.bboxes.push(pe),this.bboxes.push(Q),this.bboxes.push(de),this.bboxes.push(Le)},Tr.prototype.insertCircle=function(W,pe,Q,de){this._forEachCell(pe-de,Q-de,pe+de,Q+de,this._insertCircleCell,this.circleUid++),this.circleKeys.push(W),this.circles.push(pe),this.circles.push(Q),this.circles.push(de)},Tr.prototype._insertBoxCell=function(W,pe,Q,de,Le,ze){this.boxCells[Le].push(ze)},Tr.prototype._insertCircleCell=function(W,pe,Q,de,Le,ze){this.circleCells[Le].push(ze)},Tr.prototype._query=function(W,pe,Q,de,Le,ze){if(Q<0||W>this.width||de<0||pe>this.height)return Le?!1:[];var Ke=[];if(W<=0&&pe<=0&&this.width<=Q&&this.height<=de){if(Le)return!0;for(var ct=0;ct<this.boxKeys.length;ct++)Ke.push({key:this.boxKeys[ct],x1:this.bboxes[ct*4],y1:this.bboxes[ct*4+1],x2:this.bboxes[ct*4+2],y2:this.bboxes[ct*4+3]});for(var Lt=0;Lt<this.circleKeys.length;Lt++){var $t=this.circles[Lt*3],cr=this.circles[Lt*3+1],dr=this.circles[Lt*3+2];Ke.push({key:this.circleKeys[Lt],x1:$t-dr,y1:cr-dr,x2:$t+dr,y2:cr+dr})}return ze?Ke.filter(ze):Ke}else{var Lr={hitTest:Le,seenUids:{box:{},circle:{}}};return this._forEachCell(W,pe,Q,de,this._queryCell,Ke,Lr,ze),Le?Ke.length>0:Ke}},Tr.prototype._queryCircle=function(W,pe,Q,de,Le){var ze=W-Q,Ke=W+Q,ct=pe-Q,Lt=pe+Q;if(Ke<0||ze>this.width||Lt<0||ct>this.height)return de?!1:[];var $t=[],cr={hitTest:de,circle:{x:W,y:pe,radius:Q},seenUids:{box:{},circle:{}}};return this._forEachCell(ze,ct,Ke,Lt,this._queryCellCircle,$t,cr,Le),de?$t.length>0:$t},Tr.prototype.query=function(W,pe,Q,de,Le){return this._query(W,pe,Q,de,!1,Le)},Tr.prototype.hitTest=function(W,pe,Q,de,Le){return this._query(W,pe,Q,de,!0,Le)},Tr.prototype.hitTestCircle=function(W,pe,Q,de){return this._queryCircle(W,pe,Q,!0,de)},Tr.prototype._queryCell=function(W,pe,Q,de,Le,ze,Ke,ct){var Lt=Ke.seenUids,$t=this.boxCells[Le];if($t!==null)for(var cr=this.bboxes,dr=0,Lr=$t;dr<Lr.length;dr+=1){var Yr=Lr[dr];if(!Lt.box[Yr]){Lt.box[Yr]=!0;var Xr=Yr*4;if(W<=cr[Xr+2]&&pe<=cr[Xr+3]&&Q>=cr[Xr+0]&&de>=cr[Xr+1]&&(!ct||ct(this.boxKeys[Yr]))){if(Ke.hitTest)return ze.push(!0),!0;ze.push({key:this.boxKeys[Yr],x1:cr[Xr],y1:cr[Xr+1],x2:cr[Xr+2],y2:cr[Xr+3]})}}}var Gr=this.circleCells[Le];if(Gr!==null)for(var $r=this.circles,pn=0,Ln=Gr;pn<Ln.length;pn+=1){var Nn=Ln[pn];if(!Lt.circle[Nn]){Lt.circle[Nn]=!0;var Qn=Nn*3;if(this._circleAndRectCollide($r[Qn],$r[Qn+1],$r[Qn+2],W,pe,Q,de)&&(!ct||ct(this.circleKeys[Nn]))){if(Ke.hitTest)return ze.push(!0),!0;var ta=$r[Qn],qn=$r[Qn+1],pa=$r[Qn+2];ze.push({key:this.circleKeys[Nn],x1:ta-pa,y1:qn-pa,x2:ta+pa,y2:qn+pa})}}}},Tr.prototype._queryCellCircle=function(W,pe,Q,de,Le,ze,Ke,ct){var Lt=Ke.circle,$t=Ke.seenUids,cr=this.boxCells[Le];if(cr!==null)for(var dr=this.bboxes,Lr=0,Yr=cr;Lr<Yr.length;Lr+=1){var Xr=Yr[Lr];if(!$t.box[Xr]){$t.box[Xr]=!0;var Gr=Xr*4;if(this._circleAndRectCollide(Lt.x,Lt.y,Lt.radius,dr[Gr+0],dr[Gr+1],dr[Gr+2],dr[Gr+3])&&(!ct||ct(this.boxKeys[Xr])))return ze.push(!0),!0}}var $r=this.circleCells[Le];if($r!==null)for(var pn=this.circles,Ln=0,Nn=$r;Ln<Nn.length;Ln+=1){var Qn=Nn[Ln];if(!$t.circle[Qn]){$t.circle[Qn]=!0;var ta=Qn*3;if(this._circlesCollide(pn[ta],pn[ta+1],pn[ta+2],Lt.x,Lt.y,Lt.radius)&&(!ct||ct(this.circleKeys[Qn])))return ze.push(!0),!0}}},Tr.prototype._forEachCell=function(W,pe,Q,de,Le,ze,Ke,ct){for(var Lt=this._convertToXCellCoord(W),$t=this._convertToYCellCoord(pe),cr=this._convertToXCellCoord(Q),dr=this._convertToYCellCoord(de),Lr=Lt;Lr<=cr;Lr++)for(var Yr=$t;Yr<=dr;Yr++){var Xr=this.xCellCount*Yr+Lr;if(Le.call(this,W,pe,Q,de,Xr,ze,Ke,ct))return}},Tr.prototype._convertToXCellCoord=function(W){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(W*this.xScale)))},Tr.prototype._convertToYCellCoord=function(W){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(W*this.yScale)))},Tr.prototype._circlesCollide=function(W,pe,Q,de,Le,ze){var Ke=de-W,ct=Le-pe,Lt=Q+ze;return Lt*Lt>Ke*Ke+ct*ct},Tr.prototype._circleAndRectCollide=function(W,pe,Q,de,Le,ze,Ke){var ct=(ze-de)/2,Lt=Math.abs(W-(de+ct));if(Lt>ct+Q)return!1;var $t=(Ke-Le)/2,cr=Math.abs(pe-(Le+$t));if(cr>$t+Q)return!1;if(Lt<=ct||cr<=$t)return!0;var dr=Lt-ct,Lr=cr-$t;return dr*dr+Lr*Lr<=Q*Q};function Wr(ce,W,pe,Q,de){var Le=e.create();return W?(e.scale(Le,Le,[1/de,1/de,1]),pe||e.rotateZ(Le,Le,Q.angle)):e.multiply(Le,Q.labelPlaneMatrix,ce),Le}function An(ce,W,pe,Q,de){if(W){var Le=e.clone(ce);return e.scale(Le,Le,[de,de,1]),pe||e.rotateZ(Le,Le,-Q.angle),Le}else return Q.glCoordMatrix}function vn(ce,W){var pe=[ce.x,ce.y,0,1];Mr(pe,pe,W);var Q=pe[3];return{point:new e.Point(pe[0]/Q,pe[1]/Q),signedDistanceFromCamera:Q}}function Un(ce,W){return .5+.5*(ce/W)}function Dn(ce,W){var pe=ce[0]/ce[3],Q=ce[1]/ce[3],de=pe>=-W[0]&&pe<=W[0]&&Q>=-W[1]&&Q<=W[1];return de}function Xn(ce,W,pe,Q,de,Le,ze,Ke){var ct=Q?ce.textSizeData:ce.iconSizeData,Lt=e.evaluateSizeForZoom(ct,pe.transform.zoom),$t=[256/pe.width*2+1,256/pe.height*2+1],cr=Q?ce.text.dynamicLayoutVertexArray:ce.icon.dynamicLayoutVertexArray;cr.clear();for(var dr=ce.lineVertexArray,Lr=Q?ce.text.placedSymbolArray:ce.icon.placedSymbolArray,Yr=pe.transform.width/pe.transform.height,Xr=!1,Gr=0;Gr<Lr.length;Gr++){var $r=Lr.get(Gr);if($r.hidden||$r.writingMode===e.WritingMode.vertical&&!Xr){Ja($r.numGlyphs,cr);continue}Xr=!1;var pn=[$r.anchorX,$r.anchorY,0,1];if(e.transformMat4(pn,pn,W),!Dn(pn,$t)){Ja($r.numGlyphs,cr);continue}var Ln=pn[3],Nn=Un(pe.transform.cameraToCenterDistance,Ln),Qn=e.evaluateSizeForFeature(ct,Lt,$r),ta=ze?Qn/Nn:Qn*Nn,qn=new e.Point($r.anchorX,$r.anchorY),pa=vn(qn,de).point,Ta={},ba=Ca($r,ta,!1,Ke,W,de,Le,ce.glyphOffsetArray,dr,cr,pa,qn,Ta,Yr);Xr=ba.useVertical,(ba.notEnoughRoom||Xr||ba.needsFlipping&&Ca($r,ta,!0,Ke,W,de,Le,ce.glyphOffsetArray,dr,cr,pa,qn,Ta,Yr).notEnoughRoom)&&Ja($r.numGlyphs,cr)}Q?ce.text.dynamicLayoutVertexBuffer.updateData(cr):ce.icon.dynamicLayoutVertexBuffer.updateData(cr)}function Yn(ce,W,pe,Q,de,Le,ze,Ke,ct,Lt,$t){var cr=Ke.glyphStartIndex+Ke.numGlyphs,dr=Ke.lineStartIndex,Lr=Ke.lineStartIndex+Ke.lineLength,Yr=W.getoffsetX(Ke.glyphStartIndex),Xr=W.getoffsetX(cr-1),Gr=Xa(ce*Yr,pe,Q,de,Le,ze,Ke.segment,dr,Lr,ct,Lt,$t);if(!Gr)return null;var $r=Xa(ce*Xr,pe,Q,de,Le,ze,Ke.segment,dr,Lr,ct,Lt,$t);return $r?{first:Gr,last:$r}:null}function ya(ce,W,pe,Q){if(ce===e.WritingMode.horizontal){var de=Math.abs(pe.y-W.y),Le=Math.abs(pe.x-W.x)*Q;if(de>Le)return{useVertical:!0}}return(ce===e.WritingMode.vertical?W.y<pe.y:W.x>pe.x)?{needsFlipping:!0}:null}function Ca(ce,W,pe,Q,de,Le,ze,Ke,ct,Lt,$t,cr,dr,Lr){var Yr=W/24,Xr=ce.lineOffsetX*Yr,Gr=ce.lineOffsetY*Yr,$r;if(ce.numGlyphs>1){var pn=ce.glyphStartIndex+ce.numGlyphs,Ln=ce.lineStartIndex,Nn=ce.lineStartIndex+ce.lineLength,Qn=Yn(Yr,Ke,Xr,Gr,pe,$t,cr,ce,ct,Le,dr);if(!Qn)return{notEnoughRoom:!0};var ta=vn(Qn.first.point,ze).point,qn=vn(Qn.last.point,ze).point;if(Q&&!pe){var pa=ya(ce.writingMode,ta,qn,Lr);if(pa)return pa}$r=[Qn.first];for(var Ta=ce.glyphStartIndex+1;Ta<pn-1;Ta++)$r.push(Xa(Yr*Ke.getoffsetX(Ta),Xr,Gr,pe,$t,cr,ce.segment,Ln,Nn,ct,Le,dr));$r.push(Qn.last)}else{if(Q&&!pe){var ba=vn(cr,de).point,Sa=ce.lineStartIndex+ce.segment+1,Pa=new e.Point(ct.getx(Sa),ct.gety(Sa)),Ya=vn(Pa,de),si=Ya.signedDistanceFromCamera>0?Ya.point:gi(cr,Pa,ba,1,de),Oi=ya(ce.writingMode,ba,si,Lr);if(Oi)return Oi}var pi=Xa(Yr*Ke.getoffsetX(ce.glyphStartIndex),Xr,Gr,pe,$t,cr,ce.segment,ce.lineStartIndex,ce.lineStartIndex+ce.lineLength,ct,Le,dr);if(!pi)return{notEnoughRoom:!0};$r=[pi]}for(var _i=0,Va=$r;_i<Va.length;_i+=1){var Ui=Va[_i];e.addDynamicAttributes(Lt,Ui.point,Ui.angle)}return{}}function gi(ce,W,pe,Q,de){var Le=vn(ce.add(ce.sub(W)._unit()),de).point,ze=pe.sub(Le);return pe.add(ze._mult(Q/ze.mag()))}function Xa(ce,W,pe,Q,de,Le,ze,Ke,ct,Lt,$t,cr){var dr=Q?ce-W:ce+W,Lr=dr>0?1:-1,Yr=0;Q&&(Lr*=-1,Yr=Math.PI),Lr<0&&(Yr+=Math.PI);for(var Xr=Lr>0?Ke+ze:Ke+ze+1,Gr=de,$r=de,pn=0,Ln=0,Nn=Math.abs(dr),Qn=[];pn+Ln<=Nn;){if(Xr+=Lr,Xr<Ke||Xr>=ct)return null;if($r=Gr,Qn.push(Gr),Gr=cr[Xr],Gr===void 0){var ta=new e.Point(Lt.getx(Xr),Lt.gety(Xr)),qn=vn(ta,$t);if(qn.signedDistanceFromCamera>0)Gr=cr[Xr]=qn.point;else{var pa=Xr-Lr,Ta=pn===0?Le:new e.Point(Lt.getx(pa),Lt.gety(pa));Gr=gi(Ta,ta,$r,Nn-pn+1,$t)}}pn+=Ln,Ln=$r.dist(Gr)}var ba=(Nn-pn)/Ln,Sa=Gr.sub($r),Pa=Sa.mult(ba)._add($r);Pa._add(Sa._unit()._perp()._mult(pe*Lr));var Ya=Yr+Math.atan2(Gr.y-$r.y,Gr.x-$r.x);return Qn.push(Pa),{point:Pa,angle:Ya,path:Qn}}var $a=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ja(ce,W){for(var pe=0;pe<ce;pe++){var Q=W.length;W.resize(Q+4),W.float32.set($a,Q*3)}}function Mr(ce,W,pe){var Q=W[0],de=W[1];return ce[0]=pe[0]*Q+pe[4]*de+pe[12],ce[1]=pe[1]*Q+pe[5]*de+pe[13],ce[3]=pe[3]*Q+pe[7]*de+pe[15],ce}var gn=100,hn=function(W,pe,Q){pe===void 0&&(pe=new Tr(W.width+2*gn,W.height+2*gn,25)),Q===void 0&&(Q=new Tr(W.width+2*gn,W.height+2*gn,25)),this.transform=W,this.grid=pe,this.ignoredGrid=Q,this.pitchfactor=Math.cos(W._pitch)*W.cameraToCenterDistance,this.screenRightBoundary=W.width+gn,this.screenBottomBoundary=W.height+gn,this.gridRightBoundary=W.width+2*gn,this.gridBottomBoundary=W.height+2*gn};hn.prototype.placeCollisionBox=function(W,pe,Q,de,Le){var ze=this.projectAndGetPerspectiveRatio(de,W.anchorPointX,W.anchorPointY),Ke=Q*ze.perspectiveRatio,ct=W.x1*Ke+ze.point.x,Lt=W.y1*Ke+ze.point.y,$t=W.x2*Ke+ze.point.x,cr=W.y2*Ke+ze.point.y;return!this.isInsideGrid(ct,Lt,$t,cr)||!pe&&this.grid.hitTest(ct,Lt,$t,cr,Le)?{box:[],offscreen:!1}:{box:[ct,Lt,$t,cr],offscreen:this.isOffscreen(ct,Lt,$t,cr)}},hn.prototype.placeCollisionCircles=function(W,pe,Q,de,Le,ze,Ke,ct,Lt,$t,cr,dr,Lr){var Yr=[],Xr=new e.Point(pe.anchorX,pe.anchorY),Gr=vn(Xr,ze),$r=Un(this.transform.cameraToCenterDistance,Gr.signedDistanceFromCamera),pn=$t?Le/$r:Le*$r,Ln=pn/e.ONE_EM,Nn=vn(Xr,Ke).point,Qn={},ta=pe.lineOffsetX*Ln,qn=pe.lineOffsetY*Ln,pa=Yn(Ln,de,ta,qn,!1,Nn,Xr,pe,Q,Ke,Qn),Ta=!1,ba=!1,Sa=!0;if(pa){for(var Pa=dr*.5*$r+Lr,Ya=new e.Point(-gn,-gn),si=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),Oi=new Dr,pi=pa.first,_i=pa.last,Va=[],Ui=pi.path.length-1;Ui>=1;Ui--)Va.push(pi.path[Ui]);for(var Yi=1;Yi<_i.path.length;Yi++)Va.push(_i.path[Yi]);var Ji=Pa*2.5;if(ct){var ki=Va.map(function(Du){return vn(Du,ct)});ki.some(function(Du){return Du.signedDistanceFromCamera<=0})?Va=[]:Va=ki.map(function(Du){return Du.point})}var ao=[];if(Va.length>0){for(var ui=Va[0].clone(),Di=Va[0].clone(),Io=1;Io<Va.length;Io++)ui.x=Math.min(ui.x,Va[Io].x),ui.y=Math.min(ui.y,Va[Io].y),Di.x=Math.max(Di.x,Va[Io].x),Di.y=Math.max(Di.y,Va[Io].y);ui.x>=Ya.x&&Di.x<=si.x&&ui.y>=Ya.y&&Di.y<=si.y?ao=[Va]:Di.x<Ya.x||ui.x>si.x||Di.y<Ya.y||ui.y>si.y?ao=[]:ao=e.clipLine([Va],Ya.x,Ya.y,si.x,si.y)}for(var $o=0,Kl=ao;$o<Kl.length;$o+=1){var Ql=Kl[$o];Oi.reset(Ql,Pa*.25);var Su=0;Oi.length<=.5*Pa?Su=1:Su=Math.ceil(Oi.paddedLength/Ji)+1;for(var Eu=0;Eu<Su;Eu++){var Qu=Eu/Math.max(Su-1,1),Cu=Oi.lerp(Qu),al=Cu.x+gn,Mf=Cu.y+gn;Yr.push(al,Mf,Pa,0);var Os=al-Pa,Il=Mf-Pa,ku=al+Pa,du=Mf+Pa;if(Sa=Sa&&this.isOffscreen(Os,Il,ku,du),ba=ba||this.isInsideGrid(Os,Il,ku,du),!W&&this.grid.hitTestCircle(al,Mf,Pa,cr)&&(Ta=!0,!Lt))return{circles:[],offscreen:!1,collisionDetected:Ta}}}}return{circles:!Lt&&Ta||!ba?[]:Yr,offscreen:Sa,collisionDetected:Ta}},hn.prototype.queryRenderedSymbols=function(W){if(W.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var pe=[],Q=1/0,de=1/0,Le=-1/0,ze=-1/0,Ke=0,ct=W;Ke<ct.length;Ke+=1){var Lt=ct[Ke],$t=new e.Point(Lt.x+gn,Lt.y+gn);Q=Math.min(Q,$t.x),de=Math.min(de,$t.y),Le=Math.max(Le,$t.x),ze=Math.max(ze,$t.y),pe.push($t)}for(var cr=this.grid.query(Q,de,Le,ze).concat(this.ignoredGrid.query(Q,de,Le,ze)),dr={},Lr={},Yr=0,Xr=cr;Yr<Xr.length;Yr+=1){var Gr=Xr[Yr],$r=Gr.key;if(dr[$r.bucketInstanceId]===void 0&&(dr[$r.bucketInstanceId]={}),!dr[$r.bucketInstanceId][$r.featureIndex]){var pn=[new e.Point(Gr.x1,Gr.y1),new e.Point(Gr.x2,Gr.y1),new e.Point(Gr.x2,Gr.y2),new e.Point(Gr.x1,Gr.y2)];!e.polygonIntersectsPolygon(pe,pn)||(dr[$r.bucketInstanceId][$r.featureIndex]=!0,Lr[$r.bucketInstanceId]===void 0&&(Lr[$r.bucketInstanceId]=[]),Lr[$r.bucketInstanceId].push($r.featureIndex))}}return Lr},hn.prototype.insertCollisionBox=function(W,pe,Q,de,Le){var ze=pe?this.ignoredGrid:this.grid,Ke={bucketInstanceId:Q,featureIndex:de,collisionGroupID:Le};ze.insert(Ke,W[0],W[1],W[2],W[3])},hn.prototype.insertCollisionCircles=function(W,pe,Q,de,Le){for(var ze=pe?this.ignoredGrid:this.grid,Ke={bucketInstanceId:Q,featureIndex:de,collisionGroupID:Le},ct=0;ct<W.length;ct+=4)ze.insertCircle(Ke,W[ct],W[ct+1],W[ct+2])},hn.prototype.projectAndGetPerspectiveRatio=function(W,pe,Q){var de=[pe,Q,0,1];Mr(de,de,W);var Le=new e.Point((de[0]/de[3]+1)/2*this.transform.width+gn,(-de[1]/de[3]+1)/2*this.transform.height+gn);return{point:Le,perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/de[3])}},hn.prototype.isOffscreen=function(W,pe,Q,de){return Q<gn||W>=this.screenRightBoundary||de<gn||pe>this.screenBottomBoundary},hn.prototype.isInsideGrid=function(W,pe,Q,de){return Q>=0&&W<this.gridRightBoundary&&de>=0&&pe<this.gridBottomBoundary},hn.prototype.getViewportMatrix=function(){var W=e.identity([]);return e.translate(W,W,[-gn,-gn,0]),W};function Sn(ce,W,pe){return W*(e.EXTENT/(ce.tileSize*Math.pow(2,pe-ce.tileID.overscaledZ)))}var Jn=function(W,pe,Q,de){W?this.opacity=Math.max(0,Math.min(1,W.opacity+(W.placed?pe:-pe))):this.opacity=de&&Q?1:0,this.placed=Q};Jn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var ha=function(W,pe,Q,de,Le){this.text=new Jn(W?W.text:null,pe,Q,Le),this.icon=new Jn(W?W.icon:null,pe,de,Le)};ha.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ra=function(W,pe,Q){this.text=W,this.icon=pe,this.skipFade=Q},In=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},jn=function(W,pe,Q,de,Le){this.bucketInstanceId=W,this.featureIndex=pe,this.sourceLayerIndex=Q,this.bucketIndex=de,this.tileID=Le},Ga=function(W){this.crossSourceCollisions=W,this.maxGroupID=0,this.collisionGroups={}};Ga.prototype.get=function(W){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[W]){var pe=++this.maxGroupID;this.collisionGroups[W]={ID:pe,predicate:function(Q){return Q.collisionGroupID===pe}}}return this.collisionGroups[W]};function vi(ce,W,pe,Q,de){var Le=e.getAnchorAlignment(ce),ze=Le.horizontalAlign,Ke=Le.verticalAlign,ct=-(ze-.5)*W,Lt=-(Ke-.5)*pe,$t=e.evaluateVariableOffset(ce,Q);return new e.Point(ct+$t[0]*de,Lt+$t[1]*de)}function Gt(ce,W,pe,Q,de,Le){var ze=ce.x1,Ke=ce.x2,ct=ce.y1,Lt=ce.y2,$t=ce.anchorPointX,cr=ce.anchorPointY,dr=new e.Point(W,pe);return Q&&dr._rotate(de?Le:-Le),{x1:ze+dr.x,y1:ct+dr.y,x2:Ke+dr.x,y2:Lt+dr.y,anchorPointX:$t,anchorPointY:cr}}var pr=function(W,pe,Q,de){this.transform=W.clone(),this.collisionIndex=new hn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=pe,this.retainedQueryData={},this.collisionGroups=new Ga(Q),this.collisionCircleArrays={},this.prevPlacement=de,de&&(de.prevPlacement=void 0),this.placedOrientations={}};pr.prototype.getBucketParts=function(W,pe,Q,de){var Le=Q.getBucket(pe),ze=Q.latestFeatureIndex;if(!(!Le||!ze||pe.id!==Le.layerIds[0])){var Ke=Q.collisionBoxArray,ct=Le.layers[0].layout,Lt=Math.pow(2,this.transform.zoom-Q.tileID.overscaledZ),$t=Q.tileSize/e.EXTENT,cr=this.transform.calculatePosMatrix(Q.tileID.toUnwrapped()),dr=ct.get("text-pitch-alignment")==="map",Lr=ct.get("text-rotation-alignment")==="map",Yr=Sn(Q,1,this.transform.zoom),Xr=Wr(cr,dr,Lr,this.transform,Yr),Gr=null;if(dr){var $r=An(cr,dr,Lr,this.transform,Yr);Gr=e.multiply([],this.transform.labelPlaneMatrix,$r)}this.retainedQueryData[Le.bucketInstanceId]=new jn(Le.bucketInstanceId,ze,Le.sourceLayerIndex,Le.index,Q.tileID);var pn={bucket:Le,layout:ct,posMatrix:cr,textLabelPlaneMatrix:Xr,labelToScreenMatrix:Gr,scale:Lt,textPixelRatio:$t,holdingForFade:Q.holdingForFade(),collisionBoxArray:Ke,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(Le.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(Le.sourceID)};if(de)for(var Ln=0,Nn=Le.sortKeyRanges;Ln<Nn.length;Ln+=1){var Qn=Nn[Ln],ta=Qn.sortKey,qn=Qn.symbolInstanceStart,pa=Qn.symbolInstanceEnd;W.push({sortKey:ta,symbolInstanceStart:qn,symbolInstanceEnd:pa,parameters:pn})}else W.push({symbolInstanceStart:0,symbolInstanceEnd:Le.symbolInstances.length,parameters:pn})}},pr.prototype.attemptAnchorPlacement=function(W,pe,Q,de,Le,ze,Ke,ct,Lt,$t,cr,dr,Lr,Yr,Xr){var Gr=[dr.textOffset0,dr.textOffset1],$r=vi(W,Q,de,Gr,Le),pn=this.collisionIndex.placeCollisionBox(Gt(pe,$r.x,$r.y,ze,Ke,this.transform.angle),cr,ct,Lt,$t.predicate);if(Xr){var Ln=this.collisionIndex.placeCollisionBox(Gt(Xr,$r.x,$r.y,ze,Ke,this.transform.angle),cr,ct,Lt,$t.predicate);if(Ln.box.length===0)return}if(pn.box.length>0){var Nn;return this.prevPlacement&&this.prevPlacement.variableOffsets[dr.crossTileID]&&this.prevPlacement.placements[dr.crossTileID]&&this.prevPlacement.placements[dr.crossTileID].text&&(Nn=this.prevPlacement.variableOffsets[dr.crossTileID].anchor),this.variableOffsets[dr.crossTileID]={textOffset:Gr,width:Q,height:de,anchor:W,textBoxScale:Le,prevAnchor:Nn},this.markUsedJustification(Lr,W,dr,Yr),Lr.allowVerticalPlacement&&(this.markUsedOrientation(Lr,Yr,dr),this.placedOrientations[dr.crossTileID]=Yr),{shift:$r,placedGlyphBoxes:pn}}},pr.prototype.placeLayerBucketPart=function(W,pe,Q){var de=this,Le=W.parameters,ze=Le.bucket,Ke=Le.layout,ct=Le.posMatrix,Lt=Le.textLabelPlaneMatrix,$t=Le.labelToScreenMatrix,cr=Le.textPixelRatio,dr=Le.holdingForFade,Lr=Le.collisionBoxArray,Yr=Le.partiallyEvaluatedTextSize,Xr=Le.collisionGroup,Gr=Ke.get("text-optional"),$r=Ke.get("icon-optional"),pn=Ke.get("text-allow-overlap"),Ln=Ke.get("icon-allow-overlap"),Nn=Ke.get("text-rotation-alignment")==="map",Qn=Ke.get("text-pitch-alignment")==="map",ta=Ke.get("icon-text-fit")!=="none",qn=Ke.get("symbol-z-order")==="viewport-y",pa=pn&&(Ln||!ze.hasIconData()||$r),Ta=Ln&&(pn||!ze.hasTextData()||Gr);!ze.collisionArrays&&Lr&&ze.deserializeCollisionBoxes(Lr);var ba=function(pi,_i){if(!pe[pi.crossTileID]){if(dr){de.placements[pi.crossTileID]=new ra(!1,!1,!1);return}var Va=!1,Ui=!1,Yi=!0,Ji=null,ki={box:null,offscreen:null},ao={box:null,offscreen:null},ui=null,Di=null,Io=null,$o=0,Kl=0,Ql=0;_i.textFeatureIndex?$o=_i.textFeatureIndex:pi.useRuntimeCollisionCircles&&($o=pi.featureIndex),_i.verticalTextFeatureIndex&&(Kl=_i.verticalTextFeatureIndex);var Su=_i.textBox;if(Su){var Eu=function(Ho){var wl=e.WritingMode.horizontal;if(ze.allowVerticalPlacement&&!Ho&&de.prevPlacement){var Tl=de.prevPlacement.placedOrientations[pi.crossTileID];Tl&&(de.placedOrientations[pi.crossTileID]=Tl,wl=Tl,de.markUsedOrientation(ze,wl,pi))}return wl},Qu=function(Ho,wl){if(ze.allowVerticalPlacement&&pi.numVerticalGlyphVertices>0&&_i.verticalTextBox)for(var Tl=0,Lc=ze.writingModes;Tl<Lc.length;Tl+=1){var mh=Lc[Tl];if(mh===e.WritingMode.vertical?(ki=wl(),ao=ki):ki=Ho(),ki&&ki.box&&ki.box.length)break}else ki=Ho()};if(Ke.get("text-variable-anchor")){var Os=Ke.get("text-variable-anchor");if(de.prevPlacement&&de.prevPlacement.variableOffsets[pi.crossTileID]){var Il=de.prevPlacement.variableOffsets[pi.crossTileID];Os.indexOf(Il.anchor)>0&&(Os=Os.filter(function(Ho){return Ho!==Il.anchor}),Os.unshift(Il.anchor))}var ku=function(Ho,wl,Tl){for(var Lc=Ho.x2-Ho.x1,mh=Ho.y2-Ho.y1,Kv=pi.textBoxScale,Qv=ta&&!Ln?wl:null,dc={box:[],offscreen:!1},$v=pn?Os.length*2:Os.length,Pc=0;Pc<$v;++Pc){var qv=Os[Pc%Os.length],ep=Pc>=Os.length,xh=de.attemptAnchorPlacement(qv,Ho,Lc,mh,Kv,Nn,Qn,cr,ct,Xr,ep,pi,ze,Tl,Qv);if(xh&&(dc=xh.placedGlyphBoxes,dc&&dc.box&&dc.box.length)){Va=!0,Ji=xh.shift;break}}return dc},du=function(){return ku(Su,_i.iconBox,e.WritingMode.horizontal)},Du=function(){var Ho=_i.verticalTextBox,wl=ki&&ki.box&&ki.box.length;return ze.allowVerticalPlacement&&!wl&&pi.numVerticalGlyphVertices>0&&Ho?ku(Ho,_i.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}};Qu(du,Du),ki&&(Va=ki.box,Yi=ki.offscreen);var Ec=Eu(ki&&ki.box);if(!Va&&de.prevPlacement){var Lf=de.prevPlacement.variableOffsets[pi.crossTileID];Lf&&(de.variableOffsets[pi.crossTileID]=Lf,de.markUsedJustification(ze,Lf.anchor,pi,Ec))}}else{var Cu=function(Ho,wl){var Tl=de.collisionIndex.placeCollisionBox(Ho,pn,cr,ct,Xr.predicate);return Tl&&Tl.box&&Tl.box.length&&(de.markUsedOrientation(ze,wl,pi),de.placedOrientations[pi.crossTileID]=wl),Tl},al=function(){return Cu(Su,e.WritingMode.horizontal)},Mf=function(){var Ho=_i.verticalTextBox;return ze.allowVerticalPlacement&&pi.numVerticalGlyphVertices>0&&Ho?Cu(Ho,e.WritingMode.vertical):{box:null,offscreen:null}};Qu(al,Mf),Eu(ki&&ki.box&&ki.box.length)}}if(ui=ki,Va=ui&&ui.box&&ui.box.length>0,Yi=ui&&ui.offscreen,pi.useRuntimeCollisionCircles){var Ds=ze.text.placedSymbolArray.get(pi.centerJustifiedTextSymbolIndex),vc=e.evaluateSizeForFeature(ze.textSizeData,Yr,Ds),js=Ke.get("text-padding"),pc=pi.collisionCircleDiameter;Di=de.collisionIndex.placeCollisionCircles(pn,Ds,ze.lineVertexArray,ze.glyphOffsetArray,vc,ct,Lt,$t,Q,Qn,Xr.predicate,pc,js),Va=pn||Di.circles.length>0&&!Di.collisionDetected,Yi=Yi&&Di.offscreen}if(_i.iconFeatureIndex&&(Ql=_i.iconFeatureIndex),_i.iconBox){var Cc=function(Ho){var wl=ta&&Ji?Gt(Ho,Ji.x,Ji.y,Nn,Qn,de.transform.angle):Ho;return de.collisionIndex.placeCollisionBox(wl,Ln,cr,ct,Xr.predicate)};ao&&ao.box&&ao.box.length&&_i.verticalIconBox?(Io=Cc(_i.verticalIconBox),Ui=Io.box.length>0):(Io=Cc(_i.iconBox),Ui=Io.box.length>0),Yi=Yi&&Io.offscreen}var kc=Gr||pi.numHorizontalGlyphVertices===0&&pi.numVerticalGlyphVertices===0,jh=$r||pi.numIconVertices===0;if(!kc&&!jh?Ui=Va=Ui&&Va:jh?kc||(Ui=Ui&&Va):Va=Ui&&Va,Va&&ui&&ui.box&&(ao&&ao.box&&Kl?de.collisionIndex.insertCollisionBox(ui.box,Ke.get("text-ignore-placement"),ze.bucketInstanceId,Kl,Xr.ID):de.collisionIndex.insertCollisionBox(ui.box,Ke.get("text-ignore-placement"),ze.bucketInstanceId,$o,Xr.ID)),Ui&&Io&&de.collisionIndex.insertCollisionBox(Io.box,Ke.get("icon-ignore-placement"),ze.bucketInstanceId,Ql,Xr.ID),Di&&(Va&&de.collisionIndex.insertCollisionCircles(Di.circles,Ke.get("text-ignore-placement"),ze.bucketInstanceId,$o,Xr.ID),Q)){var Dc=ze.bucketInstanceId,Zf=de.collisionCircleArrays[Dc];Zf===void 0&&(Zf=de.collisionCircleArrays[Dc]=new In);for(var jf=0;jf<Di.circles.length;jf+=4)Zf.circles.push(Di.circles[jf+0]),Zf.circles.push(Di.circles[jf+1]),Zf.circles.push(Di.circles[jf+2]),Zf.circles.push(Di.collisionDetected?1:0)}de.placements[pi.crossTileID]=new ra(Va||pa,Ui||Ta,Yi||ze.justReloaded),pe[pi.crossTileID]=!0}};if(qn)for(var Sa=ze.getSortedSymbolIndexes(this.transform.angle),Pa=Sa.length-1;Pa>=0;--Pa){var Ya=Sa[Pa];ba(ze.symbolInstances.get(Ya),ze.collisionArrays[Ya])}else for(var si=W.symbolInstanceStart;si<W.symbolInstanceEnd;si++)ba(ze.symbolInstances.get(si),ze.collisionArrays[si]);if(Q&&ze.bucketInstanceId in this.collisionCircleArrays){var Oi=this.collisionCircleArrays[ze.bucketInstanceId];e.invert(Oi.invProjMatrix,ct),Oi.viewportMatrix=this.collisionIndex.getViewportMatrix()}ze.justReloaded=!1},pr.prototype.markUsedJustification=function(W,pe,Q,de){var Le={left:Q.leftJustifiedTextSymbolIndex,center:Q.centerJustifiedTextSymbolIndex,right:Q.rightJustifiedTextSymbolIndex},ze;de===e.WritingMode.vertical?ze=Q.verticalPlacedTextSymbolIndex:ze=Le[e.getAnchorJustification(pe)];for(var Ke=[Q.leftJustifiedTextSymbolIndex,Q.centerJustifiedTextSymbolIndex,Q.rightJustifiedTextSymbolIndex,Q.verticalPlacedTextSymbolIndex],ct=0,Lt=Ke;ct<Lt.length;ct+=1){var $t=Lt[ct];$t>=0&&(ze>=0&&$t!==ze?W.text.placedSymbolArray.get($t).crossTileID=0:W.text.placedSymbolArray.get($t).crossTileID=Q.crossTileID)}},pr.prototype.markUsedOrientation=function(W,pe,Q){for(var de=pe===e.WritingMode.horizontal||pe===e.WritingMode.horizontalOnly?pe:0,Le=pe===e.WritingMode.vertical?pe:0,ze=[Q.leftJustifiedTextSymbolIndex,Q.centerJustifiedTextSymbolIndex,Q.rightJustifiedTextSymbolIndex],Ke=0,ct=ze;Ke<ct.length;Ke+=1){var Lt=ct[Ke];W.text.placedSymbolArray.get(Lt).placedOrientation=de}Q.verticalPlacedTextSymbolIndex&&(W.text.placedSymbolArray.get(Q.verticalPlacedTextSymbolIndex).placedOrientation=Le)},pr.prototype.commit=function(W){this.commitTime=W,this.zoomAtLastRecencyCheck=this.transform.zoom;var pe=this.prevPlacement,Q=!1;this.prevZoomAdjustment=pe?pe.zoomAdjustment(this.transform.zoom):0;var de=pe?pe.symbolFadeChange(W):1,Le=pe?pe.opacities:{},ze=pe?pe.variableOffsets:{},Ke=pe?pe.placedOrientations:{};for(var ct in this.placements){var Lt=this.placements[ct],$t=Le[ct];$t?(this.opacities[ct]=new ha($t,de,Lt.text,Lt.icon),Q=Q||Lt.text!==$t.text.placed||Lt.icon!==$t.icon.placed):(this.opacities[ct]=new ha(null,de,Lt.text,Lt.icon,Lt.skipFade),Q=Q||Lt.text||Lt.icon)}for(var cr in Le){var dr=Le[cr];if(!this.opacities[cr]){var Lr=new ha(dr,de,!1,!1);Lr.isHidden()||(this.opacities[cr]=Lr,Q=Q||dr.text.placed||dr.icon.placed)}}for(var Yr in ze)!this.variableOffsets[Yr]&&this.opacities[Yr]&&!this.opacities[Yr].isHidden()&&(this.variableOffsets[Yr]=ze[Yr]);for(var Xr in Ke)!this.placedOrientations[Xr]&&this.opacities[Xr]&&!this.opacities[Xr].isHidden()&&(this.placedOrientations[Xr]=Ke[Xr]);Q?this.lastPlacementChangeTime=W:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=pe?pe.lastPlacementChangeTime:W)},pr.prototype.updateLayerOpacities=function(W,pe){for(var Q={},de=0,Le=pe;de<Le.length;de+=1){var ze=Le[de],Ke=ze.getBucket(W);Ke&&ze.latestFeatureIndex&&W.id===Ke.layerIds[0]&&this.updateBucketOpacities(Ke,Q,ze.collisionBoxArray)}},pr.prototype.updateBucketOpacities=function(W,pe,Q){var de=this;W.hasTextData()&&W.text.opacityVertexArray.clear(),W.hasIconData()&&W.icon.opacityVertexArray.clear(),W.hasIconCollisionBoxData()&&W.iconCollisionBox.collisionVertexArray.clear(),W.hasTextCollisionBoxData()&&W.textCollisionBox.collisionVertexArray.clear();var Le=W.layers[0].layout,ze=new ha(null,0,!1,!1,!0),Ke=Le.get("text-allow-overlap"),ct=Le.get("icon-allow-overlap"),Lt=Le.get("text-variable-anchor"),$t=Le.get("text-rotation-alignment")==="map",cr=Le.get("text-pitch-alignment")==="map",dr=Le.get("icon-text-fit")!=="none",Lr=new ha(null,0,Ke&&(ct||!W.hasIconData()||Le.get("icon-optional")),ct&&(Ke||!W.hasTextData()||Le.get("text-optional")),!0);!W.collisionArrays&&Q&&(W.hasIconCollisionBoxData()||W.hasTextCollisionBoxData())&&W.deserializeCollisionBoxes(Q);for(var Yr=function(pn,Ln,Nn){for(var Qn=0;Qn<Ln/4;Qn++)pn.opacityVertexArray.emplaceBack(Nn)},Xr=function(pn){var Ln=W.symbolInstances.get(pn),Nn=Ln.numHorizontalGlyphVertices,Qn=Ln.numVerticalGlyphVertices,ta=Ln.crossTileID,qn=pe[ta],pa=de.opacities[ta];qn?pa=ze:pa||(pa=Lr,de.opacities[ta]=pa),pe[ta]=!0;var Ta=Nn>0||Qn>0,ba=Ln.numIconVertices>0,Sa=de.placedOrientations[Ln.crossTileID],Pa=Sa===e.WritingMode.vertical,Ya=Sa===e.WritingMode.horizontal||Sa===e.WritingMode.horizontalOnly;if(Ta){var si=Br(pa.text),Oi=Pa?mn:si;Yr(W.text,Nn,Oi);var pi=Ya?mn:si;Yr(W.text,Qn,pi);var _i=pa.text.isHidden();[Ln.rightJustifiedTextSymbolIndex,Ln.centerJustifiedTextSymbolIndex,Ln.leftJustifiedTextSymbolIndex].forEach(function(Ql){Ql>=0&&(W.text.placedSymbolArray.get(Ql).hidden=_i||Pa?1:0)}),Ln.verticalPlacedTextSymbolIndex>=0&&(W.text.placedSymbolArray.get(Ln.verticalPlacedTextSymbolIndex).hidden=_i||Ya?1:0);var Va=de.variableOffsets[Ln.crossTileID];Va&&de.markUsedJustification(W,Va.anchor,Ln,Sa);var Ui=de.placedOrientations[Ln.crossTileID];Ui&&(de.markUsedJustification(W,"left",Ln,Ui),de.markUsedOrientation(W,Ui,Ln))}if(ba){var Yi=Br(pa.icon),Ji=!(dr&&Ln.verticalPlacedIconSymbolIndex&&Pa);if(Ln.placedIconSymbolIndex>=0){var ki=Ji?Yi:mn;Yr(W.icon,Ln.numIconVertices,ki),W.icon.placedSymbolArray.get(Ln.placedIconSymbolIndex).hidden=pa.icon.isHidden()}if(Ln.verticalPlacedIconSymbolIndex>=0){var ao=Ji?mn:Yi;Yr(W.icon,Ln.numVerticalIconVertices,ao),W.icon.placedSymbolArray.get(Ln.verticalPlacedIconSymbolIndex).hidden=pa.icon.isHidden()}}if(W.hasIconCollisionBoxData()||W.hasTextCollisionBoxData()){var ui=W.collisionArrays[pn];if(ui){var Di=new e.Point(0,0);if(ui.textBox||ui.verticalTextBox){var Io=!0;if(Lt){var $o=de.variableOffsets[ta];$o?(Di=vi($o.anchor,$o.width,$o.height,$o.textOffset,$o.textBoxScale),$t&&Di._rotate(cr?de.transform.angle:-de.transform.angle)):Io=!1}ui.textBox&&on(W.textCollisionBox.collisionVertexArray,pa.text.placed,!Io||Pa,Di.x,Di.y),ui.verticalTextBox&&on(W.textCollisionBox.collisionVertexArray,pa.text.placed,!Io||Ya,Di.x,Di.y)}var Kl=Boolean(!Ya&&ui.verticalIconBox);ui.iconBox&&on(W.iconCollisionBox.collisionVertexArray,pa.icon.placed,Kl,dr?Di.x:0,dr?Di.y:0),ui.verticalIconBox&&on(W.iconCollisionBox.collisionVertexArray,pa.icon.placed,!Kl,dr?Di.x:0,dr?Di.y:0)}}},Gr=0;Gr<W.symbolInstances.length;Gr++)Xr(Gr);if(W.sortFeatures(this.transform.angle),this.retainedQueryData[W.bucketInstanceId]&&(this.retainedQueryData[W.bucketInstanceId].featureSortOrder=W.featureSortOrder),W.hasTextData()&&W.text.opacityVertexBuffer&&W.text.opacityVertexBuffer.updateData(W.text.opacityVertexArray),W.hasIconData()&&W.icon.opacityVertexBuffer&&W.icon.opacityVertexBuffer.updateData(W.icon.opacityVertexArray),W.hasIconCollisionBoxData()&&W.iconCollisionBox.collisionVertexBuffer&&W.iconCollisionBox.collisionVertexBuffer.updateData(W.iconCollisionBox.collisionVertexArray),W.hasTextCollisionBoxData()&&W.textCollisionBox.collisionVertexBuffer&&W.textCollisionBox.collisionVertexBuffer.updateData(W.textCollisionBox.collisionVertexArray),W.bucketInstanceId in this.collisionCircleArrays){var $r=this.collisionCircleArrays[W.bucketInstanceId];W.placementInvProjMatrix=$r.invProjMatrix,W.placementViewportMatrix=$r.viewportMatrix,W.collisionCircleArray=$r.circles,delete this.collisionCircleArrays[W.bucketInstanceId]}},pr.prototype.symbolFadeChange=function(W){return this.fadeDuration===0?1:(W-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},pr.prototype.zoomAdjustment=function(W){return Math.max(0,(this.transform.zoom-W)/1.5)},pr.prototype.hasTransitions=function(W){return this.stale||W-this.lastPlacementChangeTime<this.fadeDuration},pr.prototype.stillRecent=function(W,pe){var Q=this.zoomAtLastRecencyCheck===pe?1-this.zoomAdjustment(pe):1;return this.zoomAtLastRecencyCheck=pe,this.commitTime+this.fadeDuration*Q>W},pr.prototype.setStale=function(){this.stale=!0};function on(ce,W,pe,Q,de){ce.emplaceBack(W?1:0,pe?1:0,Q||0,de||0),ce.emplaceBack(W?1:0,pe?1:0,Q||0,de||0),ce.emplaceBack(W?1:0,pe?1:0,Q||0,de||0),ce.emplaceBack(W?1:0,pe?1:0,Q||0,de||0)}var dn=Math.pow(2,25),rn=Math.pow(2,24),Mn=Math.pow(2,17),_n=Math.pow(2,16),cn=Math.pow(2,9),mr=Math.pow(2,8),br=Math.pow(2,1);function Br(ce){if(ce.opacity===0&&!ce.placed)return 0;if(ce.opacity===1&&ce.placed)return 4294967295;var W=ce.placed?1:0,pe=Math.floor(ce.opacity*127);return pe*dn+W*rn+pe*Mn+W*_n+pe*cn+W*mr+pe*br+W}var mn=0,On=function(W){this._sortAcrossTiles=W.layout.get("symbol-z-order")!=="viewport-y"&&W.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};On.prototype.continuePlacement=function(W,pe,Q,de,Le){for(var ze=this._bucketParts;this._currentTileIndex<W.length;){var Ke=W[this._currentTileIndex];if(pe.getBucketParts(ze,de,Ke,this._sortAcrossTiles),this._currentTileIndex++,Le())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,ze.sort(function(Lt,$t){return Lt.sortKey-$t.sortKey}));this._currentPartIndex<ze.length;){var ct=ze[this._currentPartIndex];if(pe.placeLayerBucketPart(ct,this._seenCrossTileIDs,Q),this._currentPartIndex++,Le())return!0}return!1};var na=function(W,pe,Q,de,Le,ze,Ke){this.placement=new pr(W,Le,ze,Ke),this._currentPlacementIndex=pe.length-1,this._forceFullPlacement=Q,this._showCollisionBoxes=de,this._done=!1};na.prototype.isDone=function(){return this._done},na.prototype.continuePlacement=function(W,pe,Q){for(var de=this,Le=e.browser.now(),ze=function(){var cr=e.browser.now()-Le;return de._forceFullPlacement?!1:cr>2};this._currentPlacementIndex>=0;){var Ke=W[this._currentPlacementIndex],ct=pe[Ke],Lt=this.placement.collisionIndex.transform.zoom;if(ct.type==="symbol"&&(!ct.minzoom||ct.minzoom<=Lt)&&(!ct.maxzoom||ct.maxzoom>Lt)){this._inProgressLayer||(this._inProgressLayer=new On(ct));var $t=this._inProgressLayer.continuePlacement(Q[ct.source],this.placement,this._showCollisionBoxes,ct,ze);if($t)return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},na.prototype.commit=function(W){return this.placement.commit(W),this.placement};var Tn=512/e.EXTENT/2,Kn=function(W,pe,Q){this.tileID=W,this.indexedSymbolInstances={},this.bucketInstanceId=Q;for(var de=0;de<pe.length;de++){var Le=pe.get(de),ze=Le.key;this.indexedSymbolInstances[ze]||(this.indexedSymbolInstances[ze]=[]),this.indexedSymbolInstances[ze].push({crossTileID:Le.crossTileID,coord:this.getScaledCoordinates(Le,W)})}};Kn.prototype.getScaledCoordinates=function(W,pe){var Q=pe.canonical.z-this.tileID.canonical.z,de=Tn/Math.pow(2,Q);return{x:Math.floor((pe.canonical.x*e.EXTENT+W.anchorX)*de),y:Math.floor((pe.canonical.y*e.EXTENT+W.anchorY)*de)}},Kn.prototype.findMatches=function(W,pe,Q){for(var de=this.tileID.canonical.z<pe.canonical.z?1:Math.pow(2,this.tileID.canonical.z-pe.canonical.z),Le=0;Le<W.length;Le++){var ze=W.get(Le);if(!ze.crossTileID){var Ke=this.indexedSymbolInstances[ze.key];if(!!Ke)for(var ct=this.getScaledCoordinates(ze,pe),Lt=0,$t=Ke;Lt<$t.length;Lt+=1){var cr=$t[Lt];if(Math.abs(cr.coord.x-ct.x)<=de&&Math.abs(cr.coord.y-ct.y)<=de&&!Q[cr.crossTileID]){Q[cr.crossTileID]=!0,ze.crossTileID=cr.crossTileID;break}}}}};var oa=function(){this.maxCrossTileID=0};oa.prototype.generate=function(){return++this.maxCrossTileID};var ma=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ma.prototype.handleWrapJump=function(W){var pe=Math.round((W-this.lng)/360);if(pe!==0)for(var Q in this.indexes){var de=this.indexes[Q],Le={};for(var ze in de){var Ke=de[ze];Ke.tileID=Ke.tileID.unwrapTo(Ke.tileID.wrap+pe),Le[Ke.tileID.key]=Ke}this.indexes[Q]=Le}this.lng=W},ma.prototype.addBucket=function(W,pe,Q){if(this.indexes[W.overscaledZ]&&this.indexes[W.overscaledZ][W.key]){if(this.indexes[W.overscaledZ][W.key].bucketInstanceId===pe.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(W.overscaledZ,this.indexes[W.overscaledZ][W.key])}for(var de=0;de<pe.symbolInstances.length;de++){var Le=pe.symbolInstances.get(de);Le.crossTileID=0}this.usedCrossTileIDs[W.overscaledZ]||(this.usedCrossTileIDs[W.overscaledZ]={});var ze=this.usedCrossTileIDs[W.overscaledZ];for(var Ke in this.indexes){var ct=this.indexes[Ke];if(Number(Ke)>W.overscaledZ)for(var Lt in ct){var $t=ct[Lt];$t.tileID.isChildOf(W)&&$t.findMatches(pe.symbolInstances,W,ze)}else{var cr=W.scaledTo(Number(Ke)),dr=ct[cr.key];dr&&dr.findMatches(pe.symbolInstances,W,ze)}}for(var Lr=0;Lr<pe.symbolInstances.length;Lr++){var Yr=pe.symbolInstances.get(Lr);Yr.crossTileID||(Yr.crossTileID=Q.generate(),ze[Yr.crossTileID]=!0)}return this.indexes[W.overscaledZ]===void 0&&(this.indexes[W.overscaledZ]={}),this.indexes[W.overscaledZ][W.key]=new Kn(W,pe.symbolInstances,pe.bucketInstanceId),!0},ma.prototype.removeBucketCrossTileIDs=function(W,pe){for(var Q in pe.indexedSymbolInstances)for(var de=0,Le=pe.indexedSymbolInstances[Q];de<Le.length;de+=1){var ze=Le[de];delete this.usedCrossTileIDs[W][ze.crossTileID]}},ma.prototype.removeStaleBuckets=function(W){var pe=!1;for(var Q in this.indexes){var de=this.indexes[Q];for(var Le in de)W[de[Le].bucketInstanceId]||(this.removeBucketCrossTileIDs(Q,de[Le]),delete de[Le],pe=!0)}return pe};var _a=function(){this.layerIndexes={},this.crossTileIDs=new oa,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};_a.prototype.addLayer=function(W,pe,Q){var de=this.layerIndexes[W.id];de===void 0&&(de=this.layerIndexes[W.id]=new ma);var Le=!1,ze={};de.handleWrapJump(Q);for(var Ke=0,ct=pe;Ke<ct.length;Ke+=1){var Lt=ct[Ke],$t=Lt.getBucket(W);!$t||W.id!==$t.layerIds[0]||($t.bucketInstanceId||($t.bucketInstanceId=++this.maxBucketInstanceId),de.addBucket(Lt.tileID,$t,this.crossTileIDs)&&(Le=!0),ze[$t.bucketInstanceId]=!0)}return de.removeStaleBuckets(ze)&&(Le=!0),Le},_a.prototype.pruneUnusedLayers=function(W){var pe={};W.forEach(function(de){pe[de]=!0});for(var Q in this.layerIndexes)pe[Q]||delete this.layerIndexes[Q]};var ua=function(ce,W){return e.emitValidationErrors(ce,W&&W.filter(function(pe){return pe.identifier!=="source.canvas"}))},Ea=e.pick(ir,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Mo=e.pick(ir,["setCenter","setZoom","setBearing","setPitch"]),jo=Zr(),vs=function(ce){function W(pe,Q){var de=this;Q===void 0&&(Q={}),ce.call(this),this.map=pe,this.dispatcher=new I(Xt(),this),this.imageManager=new b,this.imageManager.setEventedParent(this),this.glyphManager=new S(pe._requestManager,Q.localIdeographFontFamily),this.lineAtlas=new F(256,512),this.crossTileSymbolIndex=new _a,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var Le=this;this._rtlTextPluginCallback=W.registerForPluginStateChange(function(ze){var Ke={pluginStatus:ze.pluginStatus,pluginURL:ze.pluginURL};Le.dispatcher.broadcast("syncRTLPluginState",Ke,function(ct,Lt){if(e.triggerPluginCompletionEvent(ct),Lt){var $t=Lt.every(function(dr){return dr});if($t)for(var cr in Le.sourceCaches)Le.sourceCaches[cr].reload()}})}),this.on("data",function(ze){if(!(ze.dataType!=="source"||ze.sourceDataType!=="metadata")){var Ke=de.sourceCaches[ze.sourceId];if(!!Ke){var ct=Ke.getSource();if(!(!ct||!ct.vectorLayerIds))for(var Lt in de._layers){var $t=de._layers[Lt];$t.source===ct.id&&de._validateLayer($t)}}}})}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.loadURL=function(Q,de){var Le=this;de===void 0&&(de={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var ze=typeof de.validate=="boolean"?de.validate:!e.isMapboxURL(Q);Q=this.map._requestManager.normalizeStyleURL(Q,de.accessToken);var Ke=this.map._requestManager.transformRequest(Q,e.ResourceType.Style);this._request=e.getJSON(Ke,function(ct,Lt){Le._request=null,ct?Le.fire(new e.ErrorEvent(ct)):Lt&&Le._load(Lt,ze)})},W.prototype.loadJSON=function(Q,de){var Le=this;de===void 0&&(de={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){Le._request=null,Le._load(Q,de.validate!==!1)})},W.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(jo,!1)},W.prototype._load=function(Q,de){if(!(de&&ua(this,e.validateStyle(Q)))){this._loaded=!0,this.stylesheet=Q;for(var Le in Q.sources)this.addSource(Le,Q.sources[Le],{validate:!1});Q.sprite?this._loadSprite(Q.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(Q.glyphs);var ze=Sr(this.stylesheet.layers);this._order=ze.map(function($t){return $t.id}),this._layers={},this._serializedLayers={};for(var Ke=0,ct=ze;Ke<ct.length;Ke+=1){var Lt=ct[Ke];Lt=e.createStyleLayer(Lt),Lt.setEventedParent(this,{layer:{id:Lt.id}}),this._layers[Lt.id]=Lt,this._serializedLayers[Lt.id]=Lt.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new z(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},W.prototype._loadSprite=function(Q){var de=this;this._spriteRequest=v(Q,this.map._requestManager,function(Le,ze){if(de._spriteRequest=null,Le)de.fire(new e.ErrorEvent(Le));else if(ze)for(var Ke in ze)de.imageManager.addImage(Ke,ze[Ke]);de.imageManager.setLoaded(!0),de._availableImages=de.imageManager.listImages(),de.dispatcher.broadcast("setImages",de._availableImages),de.fire(new e.Event("data",{dataType:"style"}))})},W.prototype._validateLayer=function(Q){var de=this.sourceCaches[Q.source];if(!!de){var Le=Q.sourceLayer;if(!!Le){var ze=de.getSource();(ze.type==="geojson"||ze.vectorLayerIds&&ze.vectorLayerIds.indexOf(Le)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+Le+'" does not exist on source "'+ze.id+'" as specified by style layer "'+Q.id+'"')))}}},W.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var Q in this.sourceCaches)if(!this.sourceCaches[Q].loaded())return!1;return!!this.imageManager.isLoaded()},W.prototype._serializeLayers=function(Q){for(var de=[],Le=0,ze=Q;Le<ze.length;Le+=1){var Ke=ze[Le],ct=this._layers[Ke];ct.type!=="custom"&&de.push(ct.serialize())}return de},W.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var Q in this.sourceCaches)if(this.sourceCaches[Q].hasTransition())return!0;for(var de in this._layers)if(this._layers[de].hasTransition())return!0;return!1},W.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},W.prototype.update=function(Q){if(!!this._loaded){var de=this._changed;if(this._changed){var Le=Object.keys(this._updatedLayers),ze=Object.keys(this._removedLayers);(Le.length||ze.length)&&this._updateWorkerLayers(Le,ze);for(var Ke in this._updatedSources){var ct=this._updatedSources[Ke];ct==="reload"?this._reloadSource(Ke):ct==="clear"&&this._clearSource(Ke)}this._updateTilesForChangedImages();for(var Lt in this._updatedPaintProps)this._layers[Lt].updateTransitions(Q);this.light.updateTransitions(Q),this._resetUpdates()}for(var $t in this.sourceCaches)this.sourceCaches[$t].used=!1;for(var cr=0,dr=this._order;cr<dr.length;cr+=1){var Lr=dr[cr],Yr=this._layers[Lr];Yr.recalculate(Q,this._availableImages),!Yr.isHidden(Q.zoom)&&Yr.source&&(this.sourceCaches[Yr.source].used=!0)}this.light.recalculate(Q),this.z=Q.zoom,de&&this.fire(new e.Event("data",{dataType:"style"}))}},W.prototype._updateTilesForChangedImages=function(){var Q=Object.keys(this._changedImages);if(Q.length){for(var de in this.sourceCaches)this.sourceCaches[de].reloadTilesForDependencies(["icons","patterns"],Q);this._changedImages={}}},W.prototype._updateWorkerLayers=function(Q,de){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(Q),removedIds:de})},W.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},W.prototype.setState=function(Q){var de=this;if(this._checkLoaded(),ua(this,e.validateStyle(Q)))return!1;Q=e.clone$1(Q),Q.layers=Sr(Q.layers);var Le=Ur(this.serialize(),Q).filter(function(Ke){return!(Ke.command in Mo)});if(Le.length===0)return!1;var ze=Le.filter(function(Ke){return!(Ke.command in Ea)});if(ze.length>0)throw new Error("Unimplemented: "+ze.map(function(Ke){return Ke.command}).join(", ")+".");return Le.forEach(function(Ke){Ke.command!=="setTransition"&&de[Ke.command].apply(de,Ke.args)}),this.stylesheet=Q,!0},W.prototype.addImage=function(Q,de){if(this.getImage(Q))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(Q,de),this._availableImages=this.imageManager.listImages(),this._changedImages[Q]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},W.prototype.updateImage=function(Q,de){this.imageManager.updateImage(Q,de)},W.prototype.getImage=function(Q){return this.imageManager.getImage(Q)},W.prototype.removeImage=function(Q){if(!this.getImage(Q))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(Q),this._availableImages=this.imageManager.listImages(),this._changedImages[Q]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},W.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},W.prototype.addSource=function(Q,de,Le){var ze=this;if(Le===void 0&&(Le={}),this._checkLoaded(),this.sourceCaches[Q]!==void 0)throw new Error("There is already a source with this ID");if(!de.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(de).join(", ")+".");var Ke=["vector","raster","geojson","video","image"],ct=Ke.indexOf(de.type)>=0;if(!(ct&&this._validate(e.validateStyle.source,"sources."+Q,de,null,Le))){this.map&&this.map._collectResourceTiming&&(de.collectResourceTiming=!0);var Lt=this.sourceCaches[Q]=new Pe(Q,de,this.dispatcher);Lt.style=this,Lt.setEventedParent(this,function(){return{isSourceLoaded:ze.loaded(),source:Lt.serialize(),sourceId:Q}}),Lt.onAdd(this.map),this._changed=!0}},W.prototype.removeSource=function(Q){if(this._checkLoaded(),this.sourceCaches[Q]===void 0)throw new Error("There is no source with this ID");for(var de in this._layers)if(this._layers[de].source===Q)return this.fire(new e.ErrorEvent(new Error('Source "'+Q+'" cannot be removed while layer "'+de+'" is using it.')));var Le=this.sourceCaches[Q];delete this.sourceCaches[Q],delete this._updatedSources[Q],Le.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:Q})),Le.setEventedParent(null),Le.clearTiles(),Le.onRemove&&Le.onRemove(this.map),this._changed=!0},W.prototype.setGeoJSONSourceData=function(Q,de){this._checkLoaded();var Le=this.sourceCaches[Q].getSource();Le.setData(de),this._changed=!0},W.prototype.getSource=function(Q){return this.sourceCaches[Q]&&this.sourceCaches[Q].getSource()},W.prototype.addLayer=function(Q,de,Le){Le===void 0&&(Le={}),this._checkLoaded();var ze=Q.id;if(this.getLayer(ze)){this.fire(new e.ErrorEvent(new Error('Layer with id "'+ze+'" already exists on this map')));return}var Ke;if(Q.type==="custom"){if(ua(this,e.validateCustomStyleLayer(Q)))return;Ke=e.createStyleLayer(Q)}else{if(typeof Q.source=="object"&&(this.addSource(ze,Q.source),Q=e.clone$1(Q),Q=e.extend(Q,{source:ze})),this._validate(e.validateStyle.layer,"layers."+ze,Q,{arrayIndex:-1},Le))return;Ke=e.createStyleLayer(Q),this._validateLayer(Ke),Ke.setEventedParent(this,{layer:{id:ze}}),this._serializedLayers[Ke.id]=Ke.serialize()}var ct=de?this._order.indexOf(de):this._order.length;if(de&&ct===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+de+'" does not exist on this map.')));return}if(this._order.splice(ct,0,ze),this._layerOrderChanged=!0,this._layers[ze]=Ke,this._removedLayers[ze]&&Ke.source&&Ke.type!=="custom"){var Lt=this._removedLayers[ze];delete this._removedLayers[ze],Lt.type!==Ke.type?this._updatedSources[Ke.source]="clear":(this._updatedSources[Ke.source]="reload",this.sourceCaches[Ke.source].pause())}this._updateLayer(Ke),Ke.onAdd&&Ke.onAdd(this.map)},W.prototype.moveLayer=function(Q,de){this._checkLoaded(),this._changed=!0;var Le=this._layers[Q];if(!Le){this.fire(new e.ErrorEvent(new Error("The layer '"+Q+"' does not exist in the map's style and cannot be moved.")));return}if(Q!==de){var ze=this._order.indexOf(Q);this._order.splice(ze,1);var Ke=de?this._order.indexOf(de):this._order.length;if(de&&Ke===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+de+'" does not exist on this map.')));return}this._order.splice(Ke,0,Q),this._layerOrderChanged=!0}},W.prototype.removeLayer=function(Q){this._checkLoaded();var de=this._layers[Q];if(!de){this.fire(new e.ErrorEvent(new Error("The layer '"+Q+"' does not exist in the map's style and cannot be removed.")));return}de.setEventedParent(null);var Le=this._order.indexOf(Q);this._order.splice(Le,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[Q]=de,delete this._layers[Q],delete this._serializedLayers[Q],delete this._updatedLayers[Q],delete this._updatedPaintProps[Q],de.onRemove&&de.onRemove(this.map)},W.prototype.getLayer=function(Q){return this._layers[Q]},W.prototype.hasLayer=function(Q){return Q in this._layers},W.prototype.setLayerZoomRange=function(Q,de,Le){this._checkLoaded();var ze=this.getLayer(Q);if(!ze){this.fire(new e.ErrorEvent(new Error("The layer '"+Q+"' does not exist in the map's style and cannot have zoom extent.")));return}ze.minzoom===de&&ze.maxzoom===Le||(de!=null&&(ze.minzoom=de),Le!=null&&(ze.maxzoom=Le),this._updateLayer(ze))},W.prototype.setFilter=function(Q,de,Le){Le===void 0&&(Le={}),this._checkLoaded();var ze=this.getLayer(Q);if(!ze){this.fire(new e.ErrorEvent(new Error("The layer '"+Q+"' does not exist in the map's style and cannot be filtered.")));return}if(!e.deepEqual(ze.filter,de)){if(de==null){ze.filter=void 0,this._updateLayer(ze);return}this._validate(e.validateStyle.filter,"layers."+ze.id+".filter",de,null,Le)||(ze.filter=e.clone$1(de),this._updateLayer(ze))}},W.prototype.getFilter=function(Q){return e.clone$1(this.getLayer(Q).filter)},W.prototype.setLayoutProperty=function(Q,de,Le,ze){ze===void 0&&(ze={}),this._checkLoaded();var Ke=this.getLayer(Q);if(!Ke){this.fire(new e.ErrorEvent(new Error("The layer '"+Q+"' does not exist in the map's style and cannot be styled.")));return}e.deepEqual(Ke.getLayoutProperty(de),Le)||(Ke.setLayoutProperty(de,Le,ze),this._updateLayer(Ke))},W.prototype.getLayoutProperty=function(Q,de){var Le=this.getLayer(Q);if(!Le){this.fire(new e.ErrorEvent(new Error("The layer '"+Q+"' does not exist in the map's style.")));return}return Le.getLayoutProperty(de)},W.prototype.setPaintProperty=function(Q,de,Le,ze){ze===void 0&&(ze={}),this._checkLoaded();var Ke=this.getLayer(Q);if(!Ke){this.fire(new e.ErrorEvent(new Error("The layer '"+Q+"' does not exist in the map's style and cannot be styled.")));return}if(!e.deepEqual(Ke.getPaintProperty(de),Le)){var ct=Ke.setPaintProperty(de,Le,ze);ct&&this._updateLayer(Ke),this._changed=!0,this._updatedPaintProps[Q]=!0}},W.prototype.getPaintProperty=function(Q,de){return this.getLayer(Q).getPaintProperty(de)},W.prototype.setFeatureState=function(Q,de){this._checkLoaded();var Le=Q.source,ze=Q.sourceLayer,Ke=this.sourceCaches[Le];if(Ke===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+Le+"' does not exist in the map's style.")));return}var ct=Ke.getSource().type;if(ct==="geojson"&&ze){this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if(ct==="vector"&&!ze){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}Q.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),Ke.setFeatureState(ze,Q.id,de)},W.prototype.removeFeatureState=function(Q,de){this._checkLoaded();var Le=Q.source,ze=this.sourceCaches[Le];if(ze===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+Le+"' does not exist in the map's style.")));return}var Ke=ze.getSource().type,ct=Ke==="vector"?Q.sourceLayer:void 0;if(Ke==="vector"&&!ct){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(de&&typeof Q.id!="string"&&typeof Q.id!="number"){this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property.")));return}ze.removeFeatureState(ct,Q.id,de)},W.prototype.getFeatureState=function(Q){this._checkLoaded();var de=Q.source,Le=Q.sourceLayer,ze=this.sourceCaches[de];if(ze===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+de+"' does not exist in the map's style.")));return}var Ke=ze.getSource().type;if(Ke==="vector"&&!Le){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}return Q.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),ze.getFeatureState(Le,Q.id)},W.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},W.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(Q){return Q.serialize()}),layers:this._serializeLayers(this._order)},function(Q){return Q!==void 0})},W.prototype._updateLayer=function(Q){this._updatedLayers[Q.id]=!0,Q.source&&!this._updatedSources[Q.source]&&this.sourceCaches[Q.source].getSource().type!=="raster"&&(this._updatedSources[Q.source]="reload",this.sourceCaches[Q.source].pause()),this._changed=!0},W.prototype._flattenAndSortRenderedFeatures=function(Q){for(var de=this,Le=function(Ya){return de._layers[Ya].type==="fill-extrusion"},ze={},Ke=[],ct=this._order.length-1;ct>=0;ct--){var Lt=this._order[ct];if(Le(Lt)){ze[Lt]=ct;for(var $t=0,cr=Q;$t<cr.length;$t+=1){var dr=cr[$t],Lr=dr[Lt];if(Lr)for(var Yr=0,Xr=Lr;Yr<Xr.length;Yr+=1){var Gr=Xr[Yr];Ke.push(Gr)}}}}Ke.sort(function(Ya,si){return si.intersectionZ-Ya.intersectionZ});for(var $r=[],pn=this._order.length-1;pn>=0;pn--){var Ln=this._order[pn];if(Le(Ln))for(var Nn=Ke.length-1;Nn>=0;Nn--){var Qn=Ke[Nn].feature;if(ze[Qn.layer.id]<pn)break;$r.push(Qn),Ke.pop()}else for(var ta=0,qn=Q;ta<qn.length;ta+=1){var pa=qn[ta],Ta=pa[Ln];if(Ta)for(var ba=0,Sa=Ta;ba<Sa.length;ba+=1){var Pa=Sa[ba];$r.push(Pa.feature)}}}return $r},W.prototype.queryRenderedFeatures=function(Q,de,Le){de&&de.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",de.filter,null,de);var ze={};if(de&&de.layers){if(!Array.isArray(de.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var Ke=0,ct=de.layers;Ke<ct.length;Ke+=1){var Lt=ct[Ke],$t=this._layers[Lt];if(!$t)return this.fire(new e.ErrorEvent(new Error("The layer '"+Lt+"' does not exist in the map's style and cannot be queried for features."))),[];ze[$t.source]=!0}}var cr=[];de.availableImages=this._availableImages;for(var dr in this.sourceCaches)de.layers&&!ze[dr]||cr.push(ae(this.sourceCaches[dr],this._layers,this._serializedLayers,Q,de,Le));return this.placement&&cr.push(le(this._layers,this._serializedLayers,this.sourceCaches,Q,de,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(cr)},W.prototype.querySourceFeatures=function(Q,de){de&&de.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",de.filter,null,de);var Le=this.sourceCaches[Q];return Le?ie(Le,de):[]},W.prototype.addSourceType=function(Q,de,Le){if(W.getSourceType(Q))return Le(new Error('A source type called "'+Q+'" already exists.'));if(W.setSourceType(Q,de),!de.workerSourceURL)return Le(null,null);this.dispatcher.broadcast("loadWorkerSource",{name:Q,url:de.workerSourceURL},Le)},W.prototype.getLight=function(){return this.light.getLight()},W.prototype.setLight=function(Q,de){de===void 0&&(de={}),this._checkLoaded();var Le=this.light.getLight(),ze=!1;for(var Ke in Q)if(!e.deepEqual(Q[Ke],Le[Ke])){ze=!0;break}if(!!ze){var ct={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(Q,de),this.light.updateTransitions(ct)}},W.prototype._validate=function(Q,de,Le,ze,Ke){return Ke===void 0&&(Ke={}),Ke&&Ke.validate===!1?!1:ua(this,Q.call(e.validateStyle,e.extend({key:de,style:this.serialize(),value:Le,styleSpec:e.styleSpec},ze)))},W.prototype._remove=function(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(var Q in this._layers){var de=this._layers[Q];de.setEventedParent(null)}for(var Le in this.sourceCaches)this.sourceCaches[Le].clearTiles(),this.sourceCaches[Le].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},W.prototype._clearSource=function(Q){this.sourceCaches[Q].clearTiles()},W.prototype._reloadSource=function(Q){this.sourceCaches[Q].resume(),this.sourceCaches[Q].reload()},W.prototype._updateSources=function(Q){for(var de in this.sourceCaches)this.sourceCaches[de].update(Q)},W.prototype._generateCollisionBoxes=function(){for(var Q in this.sourceCaches)this._reloadSource(Q)},W.prototype._updatePlacement=function(Q,de,Le,ze,Ke){Ke===void 0&&(Ke=!1);for(var ct=!1,Lt=!1,$t={},cr=0,dr=this._order;cr<dr.length;cr+=1){var Lr=dr[cr],Yr=this._layers[Lr];if(Yr.type==="symbol"){if(!$t[Yr.source]){var Xr=this.sourceCaches[Yr.source];$t[Yr.source]=Xr.getRenderableIds(!0).map(function(ta){return Xr.getTileByID(ta)}).sort(function(ta,qn){return qn.tileID.overscaledZ-ta.tileID.overscaledZ||(ta.tileID.isLessThan(qn.tileID)?-1:1)})}var Gr=this.crossTileSymbolIndex.addLayer(Yr,$t[Yr.source],Q.center.lng);ct=ct||Gr}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),Ke=Ke||this._layerOrderChanged||Le===0,(Ke||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),Q.zoom))&&(this.pauseablePlacement=new na(Q,this._order,Ke,de,Le,ze,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,$t),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),Lt=!0),ct&&this.pauseablePlacement.placement.setStale()),Lt||ct)for(var $r=0,pn=this._order;$r<pn.length;$r+=1){var Ln=pn[$r],Nn=this._layers[Ln];Nn.type==="symbol"&&this.placement.updateLayerOpacities(Nn,$t[Nn.source])}var Qn=!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now());return Qn},W.prototype._releaseSymbolFadeTiles=function(){for(var Q in this.sourceCaches)this.sourceCaches[Q].releaseSymbolFadeTiles()},W.prototype.getImages=function(Q,de,Le){this.imageManager.getImages(de.icons,Le),this._updateTilesForChangedImages();var ze=this.sourceCaches[de.source];ze&&ze.setDependencies(de.tileID.key,de.type,de.icons)},W.prototype.getGlyphs=function(Q,de,Le){this.glyphManager.getGlyphs(de.stacks,Le)},W.prototype.getResource=function(Q,de,Le){return e.makeRequest(de,Le)},W}(e.Evented);vs.getSourceType=ee,vs.setSourceType=ne,vs.registerForPluginStateChange=e.registerForPluginStateChange;var El=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ol=`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,mu=`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`,bi=`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,cl="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}",$s=`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ki="uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}",No=`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ul=`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`,Ps="void main() {gl_FragColor=vec4(1.0);}",Vi="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}",Cl=`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,io=`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`,Wi=`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,vo="uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}",oo="varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}",bs="attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}",hl="varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",Ru="attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}",ps="uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",Iu="attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}",qs=`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Oo=`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`,lf=`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,el=`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`,Vs=`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,nu=`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`,uf=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ff=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`,vl=`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,au=`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`,Hs=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,xu=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`,kl=`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,bu="uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}",zu=`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,iu="uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}",cf=`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,pl=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`,_u=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ou=`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`,Fs=`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Vl=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`,wu=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Bu=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`,Nu=`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,su="uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}",hf=`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ou=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`,ds=`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Dl=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`,Ll=`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Tu=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`,Rs=Hi(Ol,mu),Uo=Hi(bi,cl),lu=Hi($s,Ki),Gs=Hi(No,Ul),Ys=Hi(Ps,Vi),mo=Hi(Cl,io),Hl=Hi(Wi,vo),Gl=Hi(oo,bs),dl=Hi(hl,Ru),Is=Hi(ps,Iu),Yl=Hi(qs,Oo),Pl=Hi(lf,el),uu=Hi(Vs,nu),Wl=Hi(uf,ff),yl=Hi(vl,au),vf=Hi(Hs,xu),_s=Hi(kl,bu),Cf=Hi(zu,iu),Au=Hi(cf,pl),Fl=Hi(_u,ou),Xl=Hi(Fs,Vl),ml=Hi(wu,Bu),Zl=Hi(Nu,su),Uu=Hi(hf,Ou),Vu=Hi(ds,Dl),kf=Hi(Ll,Tu);function Hi(ce,W){var pe=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,Q={};return ce=ce.replace(pe,function(de,Le,ze,Ke,ct){return Q[ct]=!0,Le==="define"?`
#ifndef HAS_UNIFORM_u_`+ct+`
varying `+ze+" "+Ke+" "+ct+`;
#else
uniform `+ze+" "+Ke+" u_"+ct+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+ct+`
    `+ze+" "+Ke+" "+ct+" = u_"+ct+`;
#endif
`}),W=W.replace(pe,function(de,Le,ze,Ke,ct){var Lt=Ke==="float"?"vec2":"vec4",$t=ct.match(/color/)?"color":Lt;return Q[ct]?Le==="define"?`
#ifndef HAS_UNIFORM_u_`+ct+`
uniform lowp float u_`+ct+`_t;
attribute `+ze+" "+Lt+" a_"+ct+`;
varying `+ze+" "+Ke+" "+ct+`;
#else
uniform `+ze+" "+Ke+" u_"+ct+`;
#endif
`:$t==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ct+`
    `+ct+" = a_"+ct+`;
#else
    `+ze+" "+Ke+" "+ct+" = u_"+ct+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ct+`
    `+ct+" = unpack_mix_"+$t+"(a_"+ct+", u_"+ct+`_t);
#else
    `+ze+" "+Ke+" "+ct+" = u_"+ct+`;
#endif
`:Le==="define"?`
#ifndef HAS_UNIFORM_u_`+ct+`
uniform lowp float u_`+ct+`_t;
attribute `+ze+" "+Lt+" a_"+ct+`;
#else
uniform `+ze+" "+Ke+" u_"+ct+`;
#endif
`:$t==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ct+`
    `+ze+" "+Ke+" "+ct+" = a_"+ct+`;
#else
    `+ze+" "+Ke+" "+ct+" = u_"+ct+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ct+`
    `+ze+" "+Ke+" "+ct+" = unpack_mix_"+$t+"(a_"+ct+", u_"+ct+`_t);
#else
    `+ze+" "+Ke+" "+ct+" = u_"+ct+`;
#endif
`}),{fragmentSource:ce,vertexSource:W}}var Rl=Object.freeze({__proto__:null,prelude:Rs,background:Uo,backgroundPattern:lu,circle:Gs,clippingMask:Ys,heatmap:mo,heatmapTexture:Hl,collisionBox:Gl,collisionCircle:dl,debug:Is,fill:Yl,fillOutline:Pl,fillOutlinePattern:uu,fillPattern:Wl,fillExtrusion:yl,fillExtrusionPattern:vf,hillshadePrepare:_s,hillshade:Cf,line:Au,lineGradient:Fl,linePattern:Xl,lineSDF:ml,raster:Zl,symbolIcon:Uu,symbolSDF:Vu,symbolTextAndIcon:kf}),xl=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};xl.prototype.bind=function(W,pe,Q,de,Le,ze,Ke,ct){this.context=W;for(var Lt=this.boundPaintVertexBuffers.length!==de.length,$t=0;!Lt&&$t<de.length;$t++)this.boundPaintVertexBuffers[$t]!==de[$t]&&(Lt=!0);var cr=!this.vao||this.boundProgram!==pe||this.boundLayoutVertexBuffer!==Q||Lt||this.boundIndexBuffer!==Le||this.boundVertexOffset!==ze||this.boundDynamicVertexBuffer!==Ke||this.boundDynamicVertexBuffer2!==ct;!W.extVertexArrayObject||cr?this.freshBind(pe,Q,de,Le,ze,Ke,ct):(W.bindVertexArrayOES.set(this.vao),Ke&&Ke.bind(),Le&&Le.dynamicDraw&&Le.bind(),ct&&ct.bind())},xl.prototype.freshBind=function(W,pe,Q,de,Le,ze,Ke){var ct,Lt=W.numAttributes,$t=this.context,cr=$t.gl;if($t.extVertexArrayObject)this.vao&&this.destroy(),this.vao=$t.extVertexArrayObject.createVertexArrayOES(),$t.bindVertexArrayOES.set(this.vao),ct=0,this.boundProgram=W,this.boundLayoutVertexBuffer=pe,this.boundPaintVertexBuffers=Q,this.boundIndexBuffer=de,this.boundVertexOffset=Le,this.boundDynamicVertexBuffer=ze,this.boundDynamicVertexBuffer2=Ke;else{ct=$t.currentNumAttributes||0;for(var dr=Lt;dr<ct;dr++)cr.disableVertexAttribArray(dr)}pe.enableAttributes(cr,W);for(var Lr=0,Yr=Q;Lr<Yr.length;Lr+=1){var Xr=Yr[Lr];Xr.enableAttributes(cr,W)}ze&&ze.enableAttributes(cr,W),Ke&&Ke.enableAttributes(cr,W),pe.bind(),pe.setVertexAttribPointers(cr,W,Le);for(var Gr=0,$r=Q;Gr<$r.length;Gr+=1){var pn=$r[Gr];pn.bind(),pn.setVertexAttribPointers(cr,W,Le)}ze&&(ze.bind(),ze.setVertexAttribPointers(cr,W,Le)),de&&de.bind(),Ke&&(Ke.bind(),Ke.setVertexAttribPointers(cr,W,Le)),$t.currentNumAttributes=Lt},xl.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var gs=function(W,pe,Q,de,Le){var ze=W.gl;this.program=ze.createProgram();var Ke=Q?Q.defines():[];Le&&Ke.push("#define OVERDRAW_INSPECTOR;");var ct=Ke.concat(Rs.fragmentSource,pe.fragmentSource).join(`
`),Lt=Ke.concat(Rs.vertexSource,pe.vertexSource).join(`
`),$t=ze.createShader(ze.FRAGMENT_SHADER);if(ze.isContextLost()){this.failedToCreate=!0;return}ze.shaderSource($t,ct),ze.compileShader($t),ze.attachShader(this.program,$t);var cr=ze.createShader(ze.VERTEX_SHADER);if(ze.isContextLost()){this.failedToCreate=!0;return}ze.shaderSource(cr,Lt),ze.compileShader(cr),ze.attachShader(this.program,cr);for(var dr=Q?Q.layoutAttributes:[],Lr=0;Lr<dr.length;Lr++)ze.bindAttribLocation(this.program,Lr,dr[Lr].name);ze.linkProgram(this.program),ze.deleteShader(cr),ze.deleteShader($t),this.numAttributes=ze.getProgramParameter(this.program,ze.ACTIVE_ATTRIBUTES),this.attributes={};for(var Yr={},Xr=0;Xr<this.numAttributes;Xr++){var Gr=ze.getActiveAttrib(this.program,Xr);Gr&&(this.attributes[Gr.name]=ze.getAttribLocation(this.program,Gr.name))}for(var $r=ze.getProgramParameter(this.program,ze.ACTIVE_UNIFORMS),pn=0;pn<$r;pn++){var Ln=ze.getActiveUniform(this.program,pn);Ln&&(Yr[Ln.name]=ze.getUniformLocation(this.program,Ln.name))}this.fixedUniforms=de(W,Yr),this.binderUniforms=Q?Q.getUniforms(W,Yr):[]};gs.prototype.draw=function(W,pe,Q,de,Le,ze,Ke,ct,Lt,$t,cr,dr,Lr,Yr,Xr,Gr){var $r,pn=W.gl;if(!this.failedToCreate){W.program.set(this.program),W.setDepthMode(Q),W.setStencilMode(de),W.setColorMode(Le),W.setCullFace(ze);for(var Ln in this.fixedUniforms)this.fixedUniforms[Ln].set(Ke[Ln]);Yr&&Yr.setUniforms(W,this.binderUniforms,dr,{zoom:Lr});for(var Nn=($r={},$r[pn.LINES]=2,$r[pn.TRIANGLES]=3,$r[pn.LINE_STRIP]=1,$r)[pe],Qn=0,ta=cr.get();Qn<ta.length;Qn+=1){var qn=ta[Qn],pa=qn.vaos||(qn.vaos={}),Ta=pa[ct]||(pa[ct]=new xl);Ta.bind(W,this,Lt,Yr?Yr.getPaintVertexBuffers():[],$t,qn.vertexOffset,Xr,Gr),pn.drawElements(pe,qn.primitiveLength*Nn,pn.UNSIGNED_SHORT,qn.primitiveOffset*Nn*2)}}};function ws(ce,W,pe){var Q=1/Sn(pe,1,W.transform.tileZoom),de=Math.pow(2,pe.tileID.overscaledZ),Le=pe.tileSize*Math.pow(2,W.transform.tileZoom)/de,ze=Le*(pe.tileID.canonical.x+pe.tileID.wrap*de),Ke=Le*pe.tileID.canonical.y;return{u_image:0,u_texsize:pe.imageAtlasTexture.size,u_scale:[Q,ce.fromScale,ce.toScale],u_fade:ce.t,u_pixel_coord_upper:[ze>>16,Ke>>16],u_pixel_coord_lower:[ze&65535,Ke&65535]}}function jl(ce,W,pe,Q){var de=pe.imageManager.getPattern(ce.from.toString()),Le=pe.imageManager.getPattern(ce.to.toString()),ze=pe.imageManager.getPixelSize(),Ke=ze.width,ct=ze.height,Lt=Math.pow(2,Q.tileID.overscaledZ),$t=Q.tileSize*Math.pow(2,pe.transform.tileZoom)/Lt,cr=$t*(Q.tileID.canonical.x+Q.tileID.wrap*Lt),dr=$t*Q.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:de.tl,u_pattern_br_a:de.br,u_pattern_tl_b:Le.tl,u_pattern_br_b:Le.br,u_texsize:[Ke,ct],u_mix:W.t,u_pattern_size_a:de.displaySize,u_pattern_size_b:Le.displaySize,u_scale_a:W.fromScale,u_scale_b:W.toScale,u_tile_units_to_pixels:1/Sn(Q,1,pe.transform.tileZoom),u_pixel_coord_upper:[cr>>16,dr>>16],u_pixel_coord_lower:[cr&65535,dr&65535]}}var xo=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_lightpos:new e.Uniform3f(ce,W.u_lightpos),u_lightintensity:new e.Uniform1f(ce,W.u_lightintensity),u_lightcolor:new e.Uniform3f(ce,W.u_lightcolor),u_vertical_gradient:new e.Uniform1f(ce,W.u_vertical_gradient),u_opacity:new e.Uniform1f(ce,W.u_opacity)}},Hu=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_lightpos:new e.Uniform3f(ce,W.u_lightpos),u_lightintensity:new e.Uniform1f(ce,W.u_lightintensity),u_lightcolor:new e.Uniform3f(ce,W.u_lightcolor),u_vertical_gradient:new e.Uniform1f(ce,W.u_vertical_gradient),u_height_factor:new e.Uniform1f(ce,W.u_height_factor),u_image:new e.Uniform1i(ce,W.u_image),u_texsize:new e.Uniform2f(ce,W.u_texsize),u_pixel_coord_upper:new e.Uniform2f(ce,W.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(ce,W.u_pixel_coord_lower),u_scale:new e.Uniform3f(ce,W.u_scale),u_fade:new e.Uniform1f(ce,W.u_fade),u_opacity:new e.Uniform1f(ce,W.u_opacity)}},Ts=function(ce,W,pe,Q){var de=W.style.light,Le=de.properties.get("position"),ze=[Le.x,Le.y,Le.z],Ke=e.create$1();de.properties.get("anchor")==="viewport"&&e.fromRotation(Ke,-W.transform.angle),e.transformMat3(ze,ze,Ke);var ct=de.properties.get("color");return{u_matrix:ce,u_lightpos:ze,u_lightintensity:de.properties.get("intensity"),u_lightcolor:[ct.r,ct.g,ct.b],u_vertical_gradient:+pe,u_opacity:Q}},tl=function(ce,W,pe,Q,de,Le,ze){return e.extend(Ts(ce,W,pe,Q),ws(Le,W,ze),{u_height_factor:-Math.pow(2,de.overscaledZ)/ze.tileSize/8})},rl=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix)}},Ws=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_image:new e.Uniform1i(ce,W.u_image),u_texsize:new e.Uniform2f(ce,W.u_texsize),u_pixel_coord_upper:new e.Uniform2f(ce,W.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(ce,W.u_pixel_coord_lower),u_scale:new e.Uniform3f(ce,W.u_scale),u_fade:new e.Uniform1f(ce,W.u_fade)}},As=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_world:new e.Uniform2f(ce,W.u_world)}},Qi=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_world:new e.Uniform2f(ce,W.u_world),u_image:new e.Uniform1i(ce,W.u_image),u_texsize:new e.Uniform2f(ce,W.u_texsize),u_pixel_coord_upper:new e.Uniform2f(ce,W.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(ce,W.u_pixel_coord_lower),u_scale:new e.Uniform3f(ce,W.u_scale),u_fade:new e.Uniform1f(ce,W.u_fade)}},Vo=function(ce){return{u_matrix:ce}},Ms=function(ce,W,pe,Q){return e.extend(Vo(ce),ws(pe,W,Q))},Gu=function(ce,W){return{u_matrix:ce,u_world:W}},fu=function(ce,W,pe,Q,de){return e.extend(Ms(ce,W,pe,Q),{u_world:de})},Yu=function(ce,W){return{u_camera_to_center_distance:new e.Uniform1f(ce,W.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(ce,W.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(ce,W.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(ce,W.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(ce,W.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(ce,W.u_matrix)}},xt=function(ce,W,pe,Q){var de=ce.transform,Le,ze;if(Q.paint.get("circle-pitch-alignment")==="map"){var Ke=Sn(pe,1,de.zoom);Le=!0,ze=[Ke,Ke]}else Le=!1,ze=de.pixelsToGLUnits;return{u_camera_to_center_distance:de.cameraToCenterDistance,u_scale_with_map:+(Q.paint.get("circle-pitch-scale")==="map"),u_matrix:ce.translatePosMatrix(W.posMatrix,pe,Q.paint.get("circle-translate"),Q.paint.get("circle-translate-anchor")),u_pitch_with_map:+Le,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:ze}},Ot=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_camera_to_center_distance:new e.Uniform1f(ce,W.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(ce,W.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(ce,W.u_extrude_scale),u_overscale_factor:new e.Uniform1f(ce,W.u_overscale_factor)}},vr=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_inv_matrix:new e.UniformMatrix4f(ce,W.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(ce,W.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(ce,W.u_viewport_size)}},lr=function(ce,W,pe){var Q=Sn(pe,1,W.zoom),de=Math.pow(2,W.zoom-pe.tileID.overscaledZ),Le=pe.tileID.overscaleFactor();return{u_matrix:ce,u_camera_to_center_distance:W.cameraToCenterDistance,u_pixels_to_tile_units:Q,u_extrude_scale:[W.pixelsToGLUnits[0]/(Q*de),W.pixelsToGLUnits[1]/(Q*de)],u_overscale_factor:Le}},Ir=function(ce,W,pe){return{u_matrix:ce,u_inv_matrix:W,u_camera_to_center_distance:pe.cameraToCenterDistance,u_viewport_size:[pe.width,pe.height]}},nn=function(ce,W){return{u_color:new e.UniformColor(ce,W.u_color),u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_overlay:new e.Uniform1i(ce,W.u_overlay),u_overlay_scale:new e.Uniform1f(ce,W.u_overlay_scale)}},yn=function(ce,W,pe){return pe===void 0&&(pe=1),{u_matrix:ce,u_color:W,u_overlay:0,u_overlay_scale:pe}},En=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix)}},Pn=function(ce){return{u_matrix:ce}},Vn=function(ce,W){return{u_extrude_scale:new e.Uniform1f(ce,W.u_extrude_scale),u_intensity:new e.Uniform1f(ce,W.u_intensity),u_matrix:new e.UniformMatrix4f(ce,W.u_matrix)}},xn=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_world:new e.Uniform2f(ce,W.u_world),u_image:new e.Uniform1i(ce,W.u_image),u_color_ramp:new e.Uniform1i(ce,W.u_color_ramp),u_opacity:new e.Uniform1f(ce,W.u_opacity)}},Bn=function(ce,W,pe,Q){return{u_matrix:ce,u_extrude_scale:Sn(W,1,pe),u_intensity:Q}},Fn=function(ce,W,pe,Q){var de=e.create();e.ortho(de,0,ce.width,ce.height,0,0,1);var Le=ce.context.gl;return{u_matrix:de,u_world:[Le.drawingBufferWidth,Le.drawingBufferHeight],u_image:pe,u_color_ramp:Q,u_opacity:W.paint.get("heatmap-opacity")}},Gn=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_image:new e.Uniform1i(ce,W.u_image),u_latrange:new e.Uniform2f(ce,W.u_latrange),u_light:new e.Uniform2f(ce,W.u_light),u_shadow:new e.UniformColor(ce,W.u_shadow),u_highlight:new e.UniformColor(ce,W.u_highlight),u_accent:new e.UniformColor(ce,W.u_accent)}},ea=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_image:new e.Uniform1i(ce,W.u_image),u_dimension:new e.Uniform2f(ce,W.u_dimension),u_zoom:new e.Uniform1f(ce,W.u_zoom),u_maxzoom:new e.Uniform1f(ce,W.u_maxzoom),u_unpack:new e.Uniform4f(ce,W.u_unpack)}},Na=function(ce,W,pe){var Q=pe.paint.get("hillshade-shadow-color"),de=pe.paint.get("hillshade-highlight-color"),Le=pe.paint.get("hillshade-accent-color"),ze=pe.paint.get("hillshade-illumination-direction")*(Math.PI/180);pe.paint.get("hillshade-illumination-anchor")==="viewport"&&(ze-=ce.transform.angle);var Ke=!ce.options.moving;return{u_matrix:ce.transform.calculatePosMatrix(W.tileID.toUnwrapped(),Ke),u_image:0,u_latrange:Oa(ce,W.tileID),u_light:[pe.paint.get("hillshade-exaggeration"),ze],u_shadow:Q,u_highlight:de,u_accent:Le}},La=function(ce,W,pe){var Q=W.stride,de=e.create();return e.ortho(de,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(de,de,[0,-e.EXTENT,0]),{u_matrix:de,u_image:1,u_dimension:[Q,Q],u_zoom:ce.overscaledZ,u_maxzoom:pe,u_unpack:W.getUnpackVector()}};function Oa(ce,W){var pe=Math.pow(2,W.canonical.z),Q=W.canonical.y;return[new e.MercatorCoordinate(0,Q/pe).toLngLat().lat,new e.MercatorCoordinate(0,(Q+1)/pe).toLngLat().lat]}var Ua=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_ratio:new e.Uniform1f(ce,W.u_ratio),u_device_pixel_ratio:new e.Uniform1f(ce,W.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(ce,W.u_units_to_pixels)}},$n=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_ratio:new e.Uniform1f(ce,W.u_ratio),u_device_pixel_ratio:new e.Uniform1f(ce,W.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(ce,W.u_units_to_pixels),u_image:new e.Uniform1i(ce,W.u_image)}},da=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_texsize:new e.Uniform2f(ce,W.u_texsize),u_ratio:new e.Uniform1f(ce,W.u_ratio),u_device_pixel_ratio:new e.Uniform1f(ce,W.u_device_pixel_ratio),u_image:new e.Uniform1i(ce,W.u_image),u_units_to_pixels:new e.Uniform2f(ce,W.u_units_to_pixels),u_scale:new e.Uniform3f(ce,W.u_scale),u_fade:new e.Uniform1f(ce,W.u_fade)}},Za=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_ratio:new e.Uniform1f(ce,W.u_ratio),u_device_pixel_ratio:new e.Uniform1f(ce,W.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(ce,W.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(ce,W.u_patternscale_a),u_patternscale_b:new e.Uniform2f(ce,W.u_patternscale_b),u_sdfgamma:new e.Uniform1f(ce,W.u_sdfgamma),u_image:new e.Uniform1i(ce,W.u_image),u_tex_y_a:new e.Uniform1f(ce,W.u_tex_y_a),u_tex_y_b:new e.Uniform1f(ce,W.u_tex_y_b),u_mix:new e.Uniform1f(ce,W.u_mix)}},ti=function(ce,W,pe){var Q=ce.transform;return{u_matrix:fi(ce,W,pe),u_ratio:1/Sn(W,1,Q.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/Q.pixelsToGLUnits[0],1/Q.pixelsToGLUnits[1]]}},wi=function(ce,W,pe){return e.extend(ti(ce,W,pe),{u_image:0})},Ti=function(ce,W,pe,Q){var de=ce.transform,Le=Fi(W,de);return{u_matrix:fi(ce,W,pe),u_texsize:W.imageAtlasTexture.size,u_ratio:1/Sn(W,1,de.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[Le,Q.fromScale,Q.toScale],u_fade:Q.t,u_units_to_pixels:[1/de.pixelsToGLUnits[0],1/de.pixelsToGLUnits[1]]}},Si=function(ce,W,pe,Q,de){var Le=ce.transform,ze=ce.lineAtlas,Ke=Fi(W,Le),ct=pe.layout.get("line-cap")==="round",Lt=ze.getDash(Q.from,ct),$t=ze.getDash(Q.to,ct),cr=Lt.width*de.fromScale,dr=$t.width*de.toScale;return e.extend(ti(ce,W,pe),{u_patternscale_a:[Ke/cr,-Lt.height/2],u_patternscale_b:[Ke/dr,-$t.height/2],u_sdfgamma:ze.width/(Math.min(cr,dr)*256*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Lt.y,u_tex_y_b:$t.y,u_mix:de.t})};function Fi(ce,W){return 1/Sn(ce,1,W.tileZoom)}function fi(ce,W,pe){return ce.translatePosMatrix(W.tileID.posMatrix,W,pe.paint.get("line-translate"),pe.paint.get("line-translate-anchor"))}var ko=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_tl_parent:new e.Uniform2f(ce,W.u_tl_parent),u_scale_parent:new e.Uniform1f(ce,W.u_scale_parent),u_buffer_scale:new e.Uniform1f(ce,W.u_buffer_scale),u_fade_t:new e.Uniform1f(ce,W.u_fade_t),u_opacity:new e.Uniform1f(ce,W.u_opacity),u_image0:new e.Uniform1i(ce,W.u_image0),u_image1:new e.Uniform1i(ce,W.u_image1),u_brightness_low:new e.Uniform1f(ce,W.u_brightness_low),u_brightness_high:new e.Uniform1f(ce,W.u_brightness_high),u_saturation_factor:new e.Uniform1f(ce,W.u_saturation_factor),u_contrast_factor:new e.Uniform1f(ce,W.u_contrast_factor),u_spin_weights:new e.Uniform3f(ce,W.u_spin_weights)}},uo=function(ce,W,pe,Q,de){return{u_matrix:ce,u_tl_parent:W,u_scale_parent:pe,u_buffer_scale:1,u_fade_t:Q.mix,u_opacity:Q.opacity*de.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:de.paint.get("raster-brightness-min"),u_brightness_high:de.paint.get("raster-brightness-max"),u_saturation_factor:Ei(de.paint.get("raster-saturation")),u_contrast_factor:ga(de.paint.get("raster-contrast")),u_spin_weights:ei(de.paint.get("raster-hue-rotate"))}};function ei(ce){ce*=Math.PI/180;var W=Math.sin(ce),pe=Math.cos(ce);return[(2*pe+1)/3,(-Math.sqrt(3)*W-pe+1)/3,(Math.sqrt(3)*W-pe+1)/3]}function ga(ce){return ce>0?1/(1-ce):1+ce}function Ei(ce){return ce>0?1-1/(1.001-ce):-ce}var bo=function(ce,W){return{u_is_size_zoom_constant:new e.Uniform1i(ce,W.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(ce,W.u_is_size_feature_constant),u_size_t:new e.Uniform1f(ce,W.u_size_t),u_size:new e.Uniform1f(ce,W.u_size),u_camera_to_center_distance:new e.Uniform1f(ce,W.u_camera_to_center_distance),u_pitch:new e.Uniform1f(ce,W.u_pitch),u_rotate_symbol:new e.Uniform1i(ce,W.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(ce,W.u_aspect_ratio),u_fade_change:new e.Uniform1f(ce,W.u_fade_change),u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(ce,W.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(ce,W.u_coord_matrix),u_is_text:new e.Uniform1i(ce,W.u_is_text),u_pitch_with_map:new e.Uniform1i(ce,W.u_pitch_with_map),u_texsize:new e.Uniform2f(ce,W.u_texsize),u_texture:new e.Uniform1i(ce,W.u_texture)}},So=function(ce,W){return{u_is_size_zoom_constant:new e.Uniform1i(ce,W.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(ce,W.u_is_size_feature_constant),u_size_t:new e.Uniform1f(ce,W.u_size_t),u_size:new e.Uniform1f(ce,W.u_size),u_camera_to_center_distance:new e.Uniform1f(ce,W.u_camera_to_center_distance),u_pitch:new e.Uniform1f(ce,W.u_pitch),u_rotate_symbol:new e.Uniform1i(ce,W.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(ce,W.u_aspect_ratio),u_fade_change:new e.Uniform1f(ce,W.u_fade_change),u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(ce,W.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(ce,W.u_coord_matrix),u_is_text:new e.Uniform1i(ce,W.u_is_text),u_pitch_with_map:new e.Uniform1i(ce,W.u_pitch_with_map),u_texsize:new e.Uniform2f(ce,W.u_texsize),u_texture:new e.Uniform1i(ce,W.u_texture),u_gamma_scale:new e.Uniform1f(ce,W.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(ce,W.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(ce,W.u_is_halo)}},Ss=function(ce,W){return{u_is_size_zoom_constant:new e.Uniform1i(ce,W.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(ce,W.u_is_size_feature_constant),u_size_t:new e.Uniform1f(ce,W.u_size_t),u_size:new e.Uniform1f(ce,W.u_size),u_camera_to_center_distance:new e.Uniform1f(ce,W.u_camera_to_center_distance),u_pitch:new e.Uniform1f(ce,W.u_pitch),u_rotate_symbol:new e.Uniform1i(ce,W.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(ce,W.u_aspect_ratio),u_fade_change:new e.Uniform1f(ce,W.u_fade_change),u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(ce,W.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(ce,W.u_coord_matrix),u_is_text:new e.Uniform1i(ce,W.u_is_text),u_pitch_with_map:new e.Uniform1i(ce,W.u_pitch_with_map),u_texsize:new e.Uniform2f(ce,W.u_texsize),u_texsize_icon:new e.Uniform2f(ce,W.u_texsize_icon),u_texture:new e.Uniform1i(ce,W.u_texture),u_texture_icon:new e.Uniform1i(ce,W.u_texture_icon),u_gamma_scale:new e.Uniform1f(ce,W.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(ce,W.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(ce,W.u_is_halo)}},Xs=function(ce,W,pe,Q,de,Le,ze,Ke,ct,Lt){var $t=de.transform;return{u_is_size_zoom_constant:+(ce==="constant"||ce==="source"),u_is_size_feature_constant:+(ce==="constant"||ce==="camera"),u_size_t:W?W.uSizeT:0,u_size:W?W.uSize:0,u_camera_to_center_distance:$t.cameraToCenterDistance,u_pitch:$t.pitch/360*2*Math.PI,u_rotate_symbol:+pe,u_aspect_ratio:$t.width/$t.height,u_fade_change:de.options.fadeDuration?de.symbolFadeChange:1,u_matrix:Le,u_label_plane_matrix:ze,u_coord_matrix:Ke,u_is_text:+ct,u_pitch_with_map:+Q,u_texsize:Lt,u_texture:0}},Jo=function(ce,W,pe,Q,de,Le,ze,Ke,ct,Lt,$t){var cr=de.transform;return e.extend(Xs(ce,W,pe,Q,de,Le,ze,Ke,ct,Lt),{u_gamma_scale:Q?Math.cos(cr._pitch)*cr.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+$t})},bl=function(ce,W,pe,Q,de,Le,ze,Ke,ct,Lt){return e.extend(Jo(ce,W,pe,Q,de,Le,ze,Ke,!0,ct,!0),{u_texsize_icon:Lt,u_texture_icon:1})},zs=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_opacity:new e.Uniform1f(ce,W.u_opacity),u_color:new e.UniformColor(ce,W.u_color)}},Es=function(ce,W){return{u_matrix:new e.UniformMatrix4f(ce,W.u_matrix),u_opacity:new e.Uniform1f(ce,W.u_opacity),u_image:new e.Uniform1i(ce,W.u_image),u_pattern_tl_a:new e.Uniform2f(ce,W.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(ce,W.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(ce,W.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(ce,W.u_pattern_br_b),u_texsize:new e.Uniform2f(ce,W.u_texsize),u_mix:new e.Uniform1f(ce,W.u_mix),u_pattern_size_a:new e.Uniform2f(ce,W.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(ce,W.u_pattern_size_b),u_scale_a:new e.Uniform1f(ce,W.u_scale_a),u_scale_b:new e.Uniform1f(ce,W.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(ce,W.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(ce,W.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(ce,W.u_tile_units_to_pixels)}},Do=function(ce,W,pe){return{u_matrix:ce,u_opacity:W,u_color:pe}},cu=function(ce,W,pe,Q,de,Le){return e.extend(jl(Q,Le,pe,de),{u_matrix:ce,u_opacity:W})},Mu={fillExtrusion:xo,fillExtrusionPattern:Hu,fill:rl,fillPattern:Ws,fillOutline:As,fillOutlinePattern:Qi,circle:Yu,collisionBox:Ot,collisionCircle:vr,debug:nn,clippingMask:En,heatmap:Vn,heatmapTexture:xn,hillshade:Gn,hillshadePrepare:ea,line:Ua,lineGradient:$n,linePattern:da,lineSDF:Za,raster:ko,symbolIcon:bo,symbolSDF:So,symbolTextAndIcon:Ss,background:zs,backgroundPattern:Es},Cs;function Wu(ce,W,pe,Q,de,Le,ze){for(var Ke=ce.context,ct=Ke.gl,Lt=ce.useProgram("collisionBox"),$t=[],cr=0,dr=0,Lr=0;Lr<Q.length;Lr++){var Yr=Q[Lr],Xr=W.getTile(Yr),Gr=Xr.getBucket(pe);if(!!Gr){var $r=Yr.posMatrix;(de[0]!==0||de[1]!==0)&&($r=ce.translatePosMatrix(Yr.posMatrix,Xr,de,Le));var pn=ze?Gr.textCollisionBox:Gr.iconCollisionBox,Ln=Gr.collisionCircleArray;if(Ln.length>0){var Nn=e.create(),Qn=$r;e.mul(Nn,Gr.placementInvProjMatrix,ce.transform.glCoordMatrix),e.mul(Nn,Nn,Gr.placementViewportMatrix),$t.push({circleArray:Ln,circleOffset:dr,transform:Qn,invTransform:Nn}),cr+=Ln.length/4,dr=cr}!pn||Lt.draw(Ke,ct.LINES,Kr.disabled,Kt.disabled,ce.colorModeForRenderPass(),St.disabled,lr($r,ce.transform,Xr),pe.id,pn.layoutVertexBuffer,pn.indexBuffer,pn.segments,null,ce.transform.zoom,null,null,pn.collisionVertexBuffer)}}if(!(!ze||!$t.length)){var ta=ce.useProgram("collisionCircle"),qn=new e.StructArrayLayout2f1f2i16;qn.resize(cr*4),qn._trim();for(var pa=0,Ta=0,ba=$t;Ta<ba.length;Ta+=1)for(var Sa=ba[Ta],Pa=0;Pa<Sa.circleArray.length/4;Pa++){var Ya=Pa*4,si=Sa.circleArray[Ya+0],Oi=Sa.circleArray[Ya+1],pi=Sa.circleArray[Ya+2],_i=Sa.circleArray[Ya+3];qn.emplace(pa++,si,Oi,pi,_i,0),qn.emplace(pa++,si,Oi,pi,_i,1),qn.emplace(pa++,si,Oi,pi,_i,2),qn.emplace(pa++,si,Oi,pi,_i,3)}(!Cs||Cs.length<cr*2)&&(Cs=hu(cr));for(var Va=Ke.createIndexBuffer(Cs,!0),Ui=Ke.createVertexBuffer(qn,e.collisionCircleLayout.members,!0),Yi=0,Ji=$t;Yi<Ji.length;Yi+=1){var ki=Ji[Yi],ao=Ir(ki.transform,ki.invTransform,ce.transform);ta.draw(Ke,ct.TRIANGLES,Kr.disabled,Kt.disabled,ce.colorModeForRenderPass(),St.disabled,ao,pe.id,Ui,Va,e.SegmentVector.simpleSegment(0,ki.circleOffset*2,ki.circleArray.length,ki.circleArray.length/2),null,ce.transform.zoom,null,null,null)}Ui.destroy(),Va.destroy()}}function hu(ce){var W=ce*2,pe=new e.StructArrayLayout3ui6;pe.resize(W),pe._trim();for(var Q=0;Q<W;Q++){var de=Q*6;pe.uint16[de+0]=Q*4+0,pe.uint16[de+1]=Q*4+1,pe.uint16[de+2]=Q*4+2,pe.uint16[de+3]=Q*4+2,pe.uint16[de+4]=Q*4+3,pe.uint16[de+5]=Q*4+0}return pe}var lc=e.identity(new Float32Array(16));function pf(ce,W,pe,Q,de){if(ce.renderPass==="translucent"){var Le=Kt.disabled,ze=ce.colorModeForRenderPass(),Ke=pe.layout.get("text-variable-anchor");Ke&&df(Q,ce,pe,W,pe.layout.get("text-rotation-alignment"),pe.layout.get("text-pitch-alignment"),de),pe.paint.get("icon-opacity").constantOr(1)!==0&&gf(ce,W,pe,Q,!1,pe.paint.get("icon-translate"),pe.paint.get("icon-translate-anchor"),pe.layout.get("icon-rotation-alignment"),pe.layout.get("icon-pitch-alignment"),pe.layout.get("icon-keep-upright"),Le,ze),pe.paint.get("text-opacity").constantOr(1)!==0&&gf(ce,W,pe,Q,!0,pe.paint.get("text-translate"),pe.paint.get("text-translate-anchor"),pe.layout.get("text-rotation-alignment"),pe.layout.get("text-pitch-alignment"),pe.layout.get("text-keep-upright"),Le,ze),W.map.showCollisionBoxes&&(Wu(ce,W,pe,Q,pe.paint.get("text-translate"),pe.paint.get("text-translate-anchor"),!0),Wu(ce,W,pe,Q,pe.paint.get("icon-translate"),pe.paint.get("icon-translate-anchor"),!1))}}function Xu(ce,W,pe,Q,de,Le){var ze=e.getAnchorAlignment(ce),Ke=ze.horizontalAlign,ct=ze.verticalAlign,Lt=-(Ke-.5)*W,$t=-(ct-.5)*pe,cr=e.evaluateVariableOffset(ce,Q);return new e.Point((Lt/de+cr[0])*Le,($t/de+cr[1])*Le)}function df(ce,W,pe,Q,de,Le,ze){for(var Ke=W.transform,ct=de==="map",Lt=Le==="map",$t=0,cr=ce;$t<cr.length;$t+=1){var dr=cr[$t],Lr=Q.getTile(dr),Yr=Lr.getBucket(pe);if(!(!Yr||!Yr.text||!Yr.text.segments.get().length)){var Xr=Yr.textSizeData,Gr=e.evaluateSizeForZoom(Xr,Ke.zoom),$r=Sn(Lr,1,W.transform.zoom),pn=Wr(dr.posMatrix,Lt,ct,W.transform,$r),Ln=pe.layout.get("icon-text-fit")!=="none"&&Yr.hasIconData();if(Gr){var Nn=Math.pow(2,Ke.zoom-Lr.tileID.overscaledZ);Zs(Yr,ct,Lt,ze,e.symbolSize,Ke,pn,dr.posMatrix,Nn,Gr,Ln)}}}}function Zs(ce,W,pe,Q,de,Le,ze,Ke,ct,Lt,$t){var cr=ce.text.placedSymbolArray,dr=ce.text.dynamicLayoutVertexArray,Lr=ce.icon.dynamicLayoutVertexArray,Yr={};dr.clear();for(var Xr=0;Xr<cr.length;Xr++){var Gr=cr.get(Xr),$r=ce.allowVerticalPlacement&&!Gr.placedOrientation,pn=!Gr.hidden&&Gr.crossTileID&&!$r?Q[Gr.crossTileID]:null;if(!pn)Ja(Gr.numGlyphs,dr);else{var Ln=new e.Point(Gr.anchorX,Gr.anchorY),Nn=vn(Ln,pe?Ke:ze),Qn=Un(Le.cameraToCenterDistance,Nn.signedDistanceFromCamera),ta=de.evaluateSizeForFeature(ce.textSizeData,Lt,Gr)*Qn/e.ONE_EM;pe&&(ta*=ce.tilePixelRatio/ct);for(var qn=pn.width,pa=pn.height,Ta=pn.anchor,ba=pn.textOffset,Sa=pn.textBoxScale,Pa=Xu(Ta,qn,pa,ba,Sa,ta),Ya=pe?vn(Ln.add(Pa),ze).point:Nn.point.add(W?Pa.rotate(-Le.angle):Pa),si=ce.allowVerticalPlacement&&Gr.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Oi=0;Oi<Gr.numGlyphs;Oi++)e.addDynamicAttributes(dr,Ya,si);$t&&Gr.associatedIconIndex>=0&&(Yr[Gr.associatedIconIndex]={shiftedAnchor:Ya,angle:si})}}if($t){Lr.clear();for(var pi=ce.icon.placedSymbolArray,_i=0;_i<pi.length;_i++){var Va=pi.get(_i);if(Va.hidden)Ja(Va.numGlyphs,Lr);else{var Ui=Yr[_i];if(!Ui)Ja(Va.numGlyphs,Lr);else for(var Yi=0;Yi<Va.numGlyphs;Yi++)e.addDynamicAttributes(Lr,Ui.shiftedAnchor,Ui.angle)}}ce.icon.dynamicLayoutVertexBuffer.updateData(Lr)}ce.text.dynamicLayoutVertexBuffer.updateData(dr)}function Df(ce,W,pe){return pe.iconsInText&&W?"symbolTextAndIcon":ce?"symbolSDF":"symbolIcon"}function gf(ce,W,pe,Q,de,Le,ze,Ke,ct,Lt,$t,cr){for(var dr=ce.context,Lr=dr.gl,Yr=ce.transform,Xr=Ke==="map",Gr=ct==="map",$r=Xr&&pe.layout.get("symbol-placement")!=="point",pn=Xr&&!Gr&&!$r,Ln=pe.layout.get("symbol-sort-key").constantOr(1)!==void 0,Nn=ce.depthModeForSublayer(0,Kr.ReadOnly),Qn=pe.layout.get("text-variable-anchor"),ta=[],qn=0,pa=Q;qn<pa.length;qn+=1){var Ta=pa[qn],ba=W.getTile(Ta),Sa=ba.getBucket(pe);if(!!Sa){var Pa=de?Sa.text:Sa.icon;if(!(!Pa||!Pa.segments.get().length)){var Ya=Pa.programConfigurations.get(pe.id),si=de||Sa.sdfIcons,Oi=de?Sa.textSizeData:Sa.iconSizeData,pi=Gr||Yr.pitch!==0,_i=ce.useProgram(Df(si,de,Sa),Ya),Va=e.evaluateSizeForZoom(Oi,Yr.zoom),Ui=void 0,Yi=[0,0],Ji=void 0,ki=void 0,ao=null,ui=void 0;if(de){if(Ji=ba.glyphAtlasTexture,ki=Lr.LINEAR,Ui=ba.glyphAtlasTexture.size,Sa.iconsInText){Yi=ba.imageAtlasTexture.size,ao=ba.imageAtlasTexture;var Di=Oi.kind==="composite"||Oi.kind==="camera";ui=pi||ce.options.rotating||ce.options.zooming||Di?Lr.LINEAR:Lr.NEAREST}}else{var Io=pe.layout.get("icon-size").constantOr(0)!==1||Sa.iconsNeedLinear;Ji=ba.imageAtlasTexture,ki=si||ce.options.rotating||ce.options.zooming||Io||pi?Lr.LINEAR:Lr.NEAREST,Ui=ba.imageAtlasTexture.size}var $o=Sn(ba,1,ce.transform.zoom),Kl=Wr(Ta.posMatrix,Gr,Xr,ce.transform,$o),Ql=An(Ta.posMatrix,Gr,Xr,ce.transform,$o),Su=Qn&&Sa.hasTextData(),Eu=pe.layout.get("icon-text-fit")!=="none"&&Su&&Sa.hasIconData();$r&&Xn(Sa,Ta.posMatrix,ce,de,Kl,Ql,Gr,Lt);var Qu=ce.translatePosMatrix(Ta.posMatrix,ba,Le,ze),Cu=$r||de&&Qn||Eu?lc:Kl,al=ce.translatePosMatrix(Ql,ba,Le,ze,!0),Mf=si&&pe.paint.get(de?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Os=void 0;si?Sa.iconsInText?Os=bl(Oi.kind,Va,pn,Gr,ce,Qu,Cu,al,Ui,Yi):Os=Jo(Oi.kind,Va,pn,Gr,ce,Qu,Cu,al,de,Ui,!0):Os=Xs(Oi.kind,Va,pn,Gr,ce,Qu,Cu,al,de,Ui);var Il={program:_i,buffers:Pa,uniformValues:Os,atlasTexture:Ji,atlasTextureIcon:ao,atlasInterpolation:ki,atlasInterpolationIcon:ui,isSDF:si,hasHalo:Mf};if(Ln)for(var ku=Pa.segments.get(),du=0,Du=ku;du<Du.length;du+=1){var Ec=Du[du];ta.push({segments:new e.SegmentVector([Ec]),sortKey:Ec.sortKey,state:Il})}else ta.push({segments:Pa.segments,sortKey:0,state:Il})}}}Ln&&ta.sort(function(Cc,kc){return Cc.sortKey-kc.sortKey});for(var Lf=0,Ds=ta;Lf<Ds.length;Lf+=1){var vc=Ds[Lf],js=vc.state;if(dr.activeTexture.set(Lr.TEXTURE0),js.atlasTexture.bind(js.atlasInterpolation,Lr.CLAMP_TO_EDGE),js.atlasTextureIcon&&(dr.activeTexture.set(Lr.TEXTURE1),js.atlasTextureIcon&&js.atlasTextureIcon.bind(js.atlasInterpolationIcon,Lr.CLAMP_TO_EDGE)),js.isSDF){var pc=js.uniformValues;js.hasHalo&&(pc.u_is_halo=1,yf(js.buffers,vc.segments,pe,ce,js.program,Nn,$t,cr,pc)),pc.u_is_halo=0}yf(js.buffers,vc.segments,pe,ce,js.program,Nn,$t,cr,js.uniformValues)}}function yf(ce,W,pe,Q,de,Le,ze,Ke,ct){var Lt=Q.context,$t=Lt.gl;de.draw(Lt,$t.TRIANGLES,Le,ze,Ke,St.disabled,ct,pe.id,ce.layoutVertexBuffer,ce.indexBuffer,W,pe.paint,Q.transform.zoom,ce.programConfigurations.get(pe.id),ce.dynamicLayoutVertexBuffer,ce.opacityVertexBuffer)}function Ko(ce,W,pe,Q){if(ce.renderPass==="translucent"){var de=pe.paint.get("circle-opacity"),Le=pe.paint.get("circle-stroke-width"),ze=pe.paint.get("circle-stroke-opacity"),Ke=pe.layout.get("circle-sort-key").constantOr(1)!==void 0;if(!(de.constantOr(1)===0&&(Le.constantOr(1)===0||ze.constantOr(1)===0))){for(var ct=ce.context,Lt=ct.gl,$t=ce.depthModeForSublayer(0,Kr.ReadOnly),cr=Kt.disabled,dr=ce.colorModeForRenderPass(),Lr=[],Yr=0;Yr<Q.length;Yr++){var Xr=Q[Yr],Gr=W.getTile(Xr),$r=Gr.getBucket(pe);if(!!$r){var pn=$r.programConfigurations.get(pe.id),Ln=ce.useProgram("circle",pn),Nn=$r.layoutVertexBuffer,Qn=$r.indexBuffer,ta=xt(ce,Xr,Gr,pe),qn={programConfiguration:pn,program:Ln,layoutVertexBuffer:Nn,indexBuffer:Qn,uniformValues:ta};if(Ke)for(var pa=$r.segments.get(),Ta=0,ba=pa;Ta<ba.length;Ta+=1){var Sa=ba[Ta];Lr.push({segments:new e.SegmentVector([Sa]),sortKey:Sa.sortKey,state:qn})}else Lr.push({segments:$r.segments,sortKey:0,state:qn})}}Ke&&Lr.sort(function(ki,ao){return ki.sortKey-ao.sortKey});for(var Pa=0,Ya=Lr;Pa<Ya.length;Pa+=1){var si=Ya[Pa],Oi=si.state,pi=Oi.programConfiguration,_i=Oi.program,Va=Oi.layoutVertexBuffer,Ui=Oi.indexBuffer,Yi=Oi.uniformValues,Ji=si.segments;_i.draw(ct,Lt.TRIANGLES,$t,cr,dr,St.disabled,Yi,pe.id,Va,Ui,Ji,pe.paint,ce.transform.zoom,pi)}}}}function mf(ce,W,pe,Q){if(pe.paint.get("heatmap-opacity")!==0)if(ce.renderPass==="offscreen"){var de=ce.context,Le=de.gl,ze=Kt.disabled,Ke=new $e([Le.ONE,Le.ONE],e.Color.transparent,[!0,!0,!0,!0]);Vf(de,ce,pe),de.clear({color:e.Color.transparent});for(var ct=0;ct<Q.length;ct++){var Lt=Q[ct];if(!W.hasRenderableParent(Lt)){var $t=W.getTile(Lt),cr=$t.getBucket(pe);if(!!cr){var dr=cr.programConfigurations.get(pe.id),Lr=ce.useProgram("heatmap",dr),Yr=ce.transform,Xr=Yr.zoom;Lr.draw(de,Le.TRIANGLES,Kr.disabled,ze,Ke,St.disabled,Bn(Lt.posMatrix,$t,Xr,pe.paint.get("heatmap-intensity")),pe.id,cr.layoutVertexBuffer,cr.indexBuffer,cr.segments,pe.paint,ce.transform.zoom,dr)}}}de.viewport.set([0,0,ce.width,ce.height])}else ce.renderPass==="translucent"&&(ce.context.setColorMode(ce.colorModeForRenderPass()),Zu(ce,pe))}function Vf(ce,W,pe){var Q=ce.gl;ce.activeTexture.set(Q.TEXTURE1),ce.viewport.set([0,0,W.width/4,W.height/4]);var de=pe.heatmapFbo;if(de)Q.bindTexture(Q.TEXTURE_2D,de.colorAttachment.get()),ce.bindFramebuffer.set(de.framebuffer);else{var Le=Q.createTexture();Q.bindTexture(Q.TEXTURE_2D,Le),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MAG_FILTER,Q.LINEAR),de=pe.heatmapFbo=ce.createFramebuffer(W.width/4,W.height/4,!1),Bs(ce,W,Le,de)}}function Bs(ce,W,pe,Q){var de=ce.gl,Le=ce.extRenderToTextureHalfFloat?ce.extTextureHalfFloat.HALF_FLOAT_OES:de.UNSIGNED_BYTE;de.texImage2D(de.TEXTURE_2D,0,de.RGBA,W.width/4,W.height/4,0,de.RGBA,Le,null),Q.colorAttachment.set(pe)}function Zu(ce,W){var pe=ce.context,Q=pe.gl,de=W.heatmapFbo;if(!!de){pe.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_2D,de.colorAttachment.get()),pe.activeTexture.set(Q.TEXTURE1);var Le=W.colorRampTexture;Le||(Le=W.colorRampTexture=new e.Texture(pe,W.colorRamp,Q.RGBA)),Le.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),ce.useProgram("heatmapTexture").draw(pe,Q.TRIANGLES,Kr.disabled,Kt.disabled,ce.colorModeForRenderPass(),St.disabled,Fn(ce,W,0,1),W.id,ce.viewportBuffer,ce.quadTriangleIndexBuffer,ce.viewportSegments,W.paint,ce.transform.zoom)}}function ju(ce,W,pe,Q){if(ce.renderPass==="translucent"){var de=pe.paint.get("line-opacity"),Le=pe.paint.get("line-width");if(!(de.constantOr(1)===0||Le.constantOr(1)===0)){var ze=ce.depthModeForSublayer(0,Kr.ReadOnly),Ke=ce.colorModeForRenderPass(),ct=pe.paint.get("line-dasharray"),Lt=pe.paint.get("line-pattern"),$t=Lt.constantOr(1),cr=pe.paint.get("line-gradient"),dr=pe.getCrossfadeParameters(),Lr=$t?"linePattern":ct?"lineSDF":cr?"lineGradient":"line",Yr=ce.context,Xr=Yr.gl,Gr=!0;if(cr){Yr.activeTexture.set(Xr.TEXTURE0);var $r=pe.gradientTexture;if(!pe.gradient)return;$r||($r=pe.gradientTexture=new e.Texture(Yr,pe.gradient,Xr.RGBA)),$r.bind(Xr.LINEAR,Xr.CLAMP_TO_EDGE)}for(var pn=0,Ln=Q;pn<Ln.length;pn+=1){var Nn=Ln[pn],Qn=W.getTile(Nn);if(!($t&&!Qn.patternsLoaded())){var ta=Qn.getBucket(pe);if(!!ta){var qn=ta.programConfigurations.get(pe.id),pa=ce.context.program.get(),Ta=ce.useProgram(Lr,qn),ba=Gr||Ta.program!==pa,Sa=Lt.constantOr(null);if(Sa&&Qn.imageAtlas){var Pa=Qn.imageAtlas,Ya=Pa.patternPositions[Sa.to.toString()],si=Pa.patternPositions[Sa.from.toString()];Ya&&si&&qn.setConstantPatternPositions(Ya,si)}var Oi=$t?Ti(ce,Qn,pe,dr):ct?Si(ce,Qn,pe,ct,dr):cr?wi(ce,Qn,pe):ti(ce,Qn,pe);$t?(Yr.activeTexture.set(Xr.TEXTURE0),Qn.imageAtlasTexture.bind(Xr.LINEAR,Xr.CLAMP_TO_EDGE),qn.updatePaintBuffers(dr)):ct&&(ba||ce.lineAtlas.dirty)&&(Yr.activeTexture.set(Xr.TEXTURE0),ce.lineAtlas.bind(Yr)),Ta.draw(Yr,Xr.TRIANGLES,ze,ce.stencilModeForClipping(Nn),Ke,St.disabled,Oi,pe.id,ta.layoutVertexBuffer,ta.indexBuffer,ta.segments,pe.paint,ce.transform.zoom,qn),Gr=!1}}}}}}function xf(ce,W,pe,Q){var de=pe.paint.get("fill-color"),Le=pe.paint.get("fill-opacity");if(Le.constantOr(1)!==0){var ze=ce.colorModeForRenderPass(),Ke=pe.paint.get("fill-pattern"),ct=ce.opaquePassEnabledForLayer()&&!Ke.constantOr(1)&&de.constantOr(e.Color.transparent).a===1&&Le.constantOr(0)===1?"opaque":"translucent";if(ce.renderPass===ct){var Lt=ce.depthModeForSublayer(1,ce.renderPass==="opaque"?Kr.ReadWrite:Kr.ReadOnly);Ne(ce,W,pe,Q,Lt,ze,!1)}if(ce.renderPass==="translucent"&&pe.paint.get("fill-antialias")){var $t=ce.depthModeForSublayer(pe.getPaintProperty("fill-outline-color")?2:0,Kr.ReadOnly);Ne(ce,W,pe,Q,$t,ze,!0)}}}function Ne(ce,W,pe,Q,de,Le,ze){var Ke=ce.context.gl,ct=pe.paint.get("fill-pattern"),Lt=ct&&ct.constantOr(1),$t=pe.getCrossfadeParameters(),cr,dr,Lr,Yr,Xr;ze?(dr=Lt&&!pe.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",cr=Ke.LINES):(dr=Lt?"fillPattern":"fill",cr=Ke.TRIANGLES);for(var Gr=0,$r=Q;Gr<$r.length;Gr+=1){var pn=$r[Gr],Ln=W.getTile(pn);if(!(Lt&&!Ln.patternsLoaded())){var Nn=Ln.getBucket(pe);if(!!Nn){var Qn=Nn.programConfigurations.get(pe.id),ta=ce.useProgram(dr,Qn);Lt&&(ce.context.activeTexture.set(Ke.TEXTURE0),Ln.imageAtlasTexture.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE),Qn.updatePaintBuffers($t));var qn=ct.constantOr(null);if(qn&&Ln.imageAtlas){var pa=Ln.imageAtlas,Ta=pa.patternPositions[qn.to.toString()],ba=pa.patternPositions[qn.from.toString()];Ta&&ba&&Qn.setConstantPatternPositions(Ta,ba)}var Sa=ce.translatePosMatrix(pn.posMatrix,Ln,pe.paint.get("fill-translate"),pe.paint.get("fill-translate-anchor"));if(!ze)Yr=Nn.indexBuffer,Xr=Nn.segments,Lr=Lt?Ms(Sa,ce,$t,Ln):Vo(Sa);else{Yr=Nn.indexBuffer2,Xr=Nn.segments2;var Pa=[Ke.drawingBufferWidth,Ke.drawingBufferHeight];Lr=dr==="fillOutlinePattern"&&Lt?fu(Sa,ce,$t,Ln,Pa):Gu(Sa,Pa)}ta.draw(ce.context,cr,de,ce.stencilModeForClipping(pn),Le,St.disabled,Lr,pe.id,Nn.layoutVertexBuffer,Yr,Xr,pe.paint,ce.transform.zoom,Qn)}}}}function je(ce,W,pe,Q){var de=pe.paint.get("fill-extrusion-opacity");if(de!==0&&ce.renderPass==="translucent"){var Le=new Kr(ce.context.gl.LEQUAL,Kr.ReadWrite,ce.depthRangeFor3D);if(de===1&&!pe.paint.get("fill-extrusion-pattern").constantOr(1)){var ze=ce.colorModeForRenderPass();rt(ce,W,pe,Q,Le,Kt.disabled,ze)}else rt(ce,W,pe,Q,Le,Kt.disabled,$e.disabled),rt(ce,W,pe,Q,Le,ce.stencilModeFor3D(),ce.colorModeForRenderPass())}}function rt(ce,W,pe,Q,de,Le,ze){for(var Ke=ce.context,ct=Ke.gl,Lt=pe.paint.get("fill-extrusion-pattern"),$t=Lt.constantOr(1),cr=pe.getCrossfadeParameters(),dr=pe.paint.get("fill-extrusion-opacity"),Lr=0,Yr=Q;Lr<Yr.length;Lr+=1){var Xr=Yr[Lr],Gr=W.getTile(Xr),$r=Gr.getBucket(pe);if(!!$r){var pn=$r.programConfigurations.get(pe.id),Ln=ce.useProgram($t?"fillExtrusionPattern":"fillExtrusion",pn);$t&&(ce.context.activeTexture.set(ct.TEXTURE0),Gr.imageAtlasTexture.bind(ct.LINEAR,ct.CLAMP_TO_EDGE),pn.updatePaintBuffers(cr));var Nn=Lt.constantOr(null);if(Nn&&Gr.imageAtlas){var Qn=Gr.imageAtlas,ta=Qn.patternPositions[Nn.to.toString()],qn=Qn.patternPositions[Nn.from.toString()];ta&&qn&&pn.setConstantPatternPositions(ta,qn)}var pa=ce.translatePosMatrix(Xr.posMatrix,Gr,pe.paint.get("fill-extrusion-translate"),pe.paint.get("fill-extrusion-translate-anchor")),Ta=pe.paint.get("fill-extrusion-vertical-gradient"),ba=$t?tl(pa,ce,Ta,dr,Xr,cr,Gr):Ts(pa,ce,Ta,dr);Ln.draw(Ke,Ke.gl.TRIANGLES,de,Le,ze,St.backCCW,ba,pe.id,$r.layoutVertexBuffer,$r.indexBuffer,$r.segments,pe.paint,ce.transform.zoom,pn)}}}function lt(ce,W,pe,Q){if(!(ce.renderPass!=="offscreen"&&ce.renderPass!=="translucent")){for(var de=ce.context,Le=W.getSource().maxzoom,ze=ce.depthModeForSublayer(0,Kr.ReadOnly),Ke=ce.colorModeForRenderPass(),ct=ce.renderPass==="translucent"?ce.stencilConfigForOverlap(Q):[{},Q],Lt=ct[0],$t=ct[1],cr=0,dr=$t;cr<dr.length;cr+=1){var Lr=dr[cr],Yr=W.getTile(Lr);Yr.needsHillshadePrepare&&ce.renderPass==="offscreen"?bt(ce,Yr,pe,Le,ze,Kt.disabled,Ke):ce.renderPass==="translucent"&&wt(ce,Yr,pe,ze,Lt[Lr.overscaledZ],Ke)}de.viewport.set([0,0,ce.width,ce.height])}}function wt(ce,W,pe,Q,de,Le){var ze=ce.context,Ke=ze.gl,ct=W.fbo;if(!!ct){var Lt=ce.useProgram("hillshade");ze.activeTexture.set(Ke.TEXTURE0),Ke.bindTexture(Ke.TEXTURE_2D,ct.colorAttachment.get());var $t=Na(ce,W,pe);Lt.draw(ze,Ke.TRIANGLES,Q,de,Le,St.disabled,$t,pe.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments)}}function bt(ce,W,pe,Q,de,Le,ze){var Ke=ce.context,ct=Ke.gl,Lt=W.dem;if(Lt&&Lt.data){var $t=Lt.dim,cr=Lt.stride,dr=Lt.getPixels();if(Ke.activeTexture.set(ct.TEXTURE1),Ke.pixelStoreUnpackPremultiplyAlpha.set(!1),W.demTexture=W.demTexture||ce.getTileTexture(cr),W.demTexture){var Lr=W.demTexture;Lr.update(dr,{premultiply:!1}),Lr.bind(ct.NEAREST,ct.CLAMP_TO_EDGE)}else W.demTexture=new e.Texture(Ke,dr,ct.RGBA,{premultiply:!1}),W.demTexture.bind(ct.NEAREST,ct.CLAMP_TO_EDGE);Ke.activeTexture.set(ct.TEXTURE0);var Yr=W.fbo;if(!Yr){var Xr=new e.Texture(Ke,{width:$t,height:$t,data:null},ct.RGBA);Xr.bind(ct.LINEAR,ct.CLAMP_TO_EDGE),Yr=W.fbo=Ke.createFramebuffer($t,$t,!0),Yr.colorAttachment.set(Xr.texture)}Ke.bindFramebuffer.set(Yr.framebuffer),Ke.viewport.set([0,0,$t,$t]),ce.useProgram("hillshadePrepare").draw(Ke,ct.TRIANGLES,de,Le,ze,St.disabled,La(W.tileID,Lt,Q),pe.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments),W.needsHillshadePrepare=!1}}function kt(ce,W,pe,Q){if(ce.renderPass==="translucent"&&pe.paint.get("raster-opacity")!==0&&!!Q.length)for(var de=ce.context,Le=de.gl,ze=W.getSource(),Ke=ce.useProgram("raster"),ct=ce.colorModeForRenderPass(),Lt=ze instanceof re?[{},Q]:ce.stencilConfigForOverlap(Q),$t=Lt[0],cr=Lt[1],dr=cr[cr.length-1].overscaledZ,Lr=!ce.options.moving,Yr=0,Xr=cr;Yr<Xr.length;Yr+=1){var Gr=Xr[Yr],$r=ce.depthModeForSublayer(Gr.overscaledZ-dr,pe.paint.get("raster-opacity")===1?Kr.ReadWrite:Kr.ReadOnly,Le.LESS),pn=W.getTile(Gr),Ln=ce.transform.calculatePosMatrix(Gr.toUnwrapped(),Lr);pn.registerFadeDuration(pe.paint.get("raster-fade-duration"));var Nn=W.findLoadedParent(Gr,0),Qn=hr(pn,Nn,W,pe,ce.transform),ta=void 0,qn=void 0,pa=pe.paint.get("raster-resampling")==="nearest"?Le.NEAREST:Le.LINEAR;de.activeTexture.set(Le.TEXTURE0),pn.texture.bind(pa,Le.CLAMP_TO_EDGE,Le.LINEAR_MIPMAP_NEAREST),de.activeTexture.set(Le.TEXTURE1),Nn?(Nn.texture.bind(pa,Le.CLAMP_TO_EDGE,Le.LINEAR_MIPMAP_NEAREST),ta=Math.pow(2,Nn.tileID.overscaledZ-pn.tileID.overscaledZ),qn=[pn.tileID.canonical.x*ta%1,pn.tileID.canonical.y*ta%1]):pn.texture.bind(pa,Le.CLAMP_TO_EDGE,Le.LINEAR_MIPMAP_NEAREST);var Ta=uo(Ln,qn||[0,0],ta||1,Qn,pe);ze instanceof re?Ke.draw(de,Le.TRIANGLES,$r,Kt.disabled,ct,St.disabled,Ta,pe.id,ze.boundsBuffer,ce.quadTriangleIndexBuffer,ze.boundsSegments):Ke.draw(de,Le.TRIANGLES,$r,$t[Gr.overscaledZ],ct,St.disabled,Ta,pe.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments)}}function hr(ce,W,pe,Q,de){var Le=Q.paint.get("raster-fade-duration");if(Le>0){var ze=e.browser.now(),Ke=(ze-ce.timeAdded)/Le,ct=W?(ze-W.timeAdded)/Le:-1,Lt=pe.getSource(),$t=de.coveringZoomLevel({tileSize:Lt.tileSize,roundZoom:Lt.roundZoom}),cr=!W||Math.abs(W.tileID.overscaledZ-$t)>Math.abs(ce.tileID.overscaledZ-$t),dr=cr&&ce.refreshedUponExpiration?1:e.clamp(cr?Ke:1-ct,0,1);return ce.refreshedUponExpiration&&Ke>=1&&(ce.refreshedUponExpiration=!1),W?{opacity:1,mix:1-dr}:{opacity:dr,mix:0}}else return{opacity:1,mix:0}}function gr(ce,W,pe){var Q=pe.paint.get("background-color"),de=pe.paint.get("background-opacity");if(de!==0){var Le=ce.context,ze=Le.gl,Ke=ce.transform,ct=Ke.tileSize,Lt=pe.paint.get("background-pattern");if(!ce.isPatternMissing(Lt)){var $t=!Lt&&Q.a===1&&de===1&&ce.opaquePassEnabledForLayer()?"opaque":"translucent";if(ce.renderPass===$t){var cr=Kt.disabled,dr=ce.depthModeForSublayer(0,$t==="opaque"?Kr.ReadWrite:Kr.ReadOnly),Lr=ce.colorModeForRenderPass(),Yr=ce.useProgram(Lt?"backgroundPattern":"background"),Xr=Ke.coveringTiles({tileSize:ct});Lt&&(Le.activeTexture.set(ze.TEXTURE0),ce.imageManager.bind(ce.context));for(var Gr=pe.getCrossfadeParameters(),$r=0,pn=Xr;$r<pn.length;$r+=1){var Ln=pn[$r],Nn=ce.transform.calculatePosMatrix(Ln.toUnwrapped()),Qn=Lt?cu(Nn,de,ce,Lt,{tileID:Ln,tileSize:ct},Gr):Do(Nn,de,Q);Yr.draw(Le,ze.TRIANGLES,dr,cr,Lr,St.disabled,Qn,pe.id,ce.tileExtentBuffer,ce.quadTriangleIndexBuffer,ce.tileExtentSegments)}}}}}var fr=new e.Color(1,0,0,1),_r=new e.Color(0,1,0,1),Rr=new e.Color(0,0,1,1),jr=new e.Color(1,0,1,1),tn=new e.Color(0,1,1,1);function wn(ce){var W=ce.transform.padding,pe=3;Zn(ce,ce.transform.height-(W.top||0),pe,fr),Zn(ce,W.bottom||0,pe,_r),xa(ce,W.left||0,pe,Rr),xa(ce,ce.transform.width-(W.right||0),pe,jr);var Q=ce.transform.centerPoint;Rn(ce,Q.x,ce.transform.height-Q.y,tn)}function Rn(ce,W,pe,Q){var de=20,Le=2;wa(ce,W-Le/2,pe-de/2,Le,de,Q),wa(ce,W-de/2,pe-Le/2,de,Le,Q)}function Zn(ce,W,pe,Q){wa(ce,0,W+pe/2,ce.transform.width,pe,Q)}function xa(ce,W,pe,Q){wa(ce,W-pe/2,0,pe,ce.transform.height,Q)}function wa(ce,W,pe,Q,de,Le){var ze=ce.context,Ke=ze.gl;Ke.enable(Ke.SCISSOR_TEST),Ke.scissor(W*e.browser.devicePixelRatio,pe*e.browser.devicePixelRatio,Q*e.browser.devicePixelRatio,de*e.browser.devicePixelRatio),ze.clear({color:Le}),Ke.disable(Ke.SCISSOR_TEST)}function qa(ce,W,pe){for(var Q=0;Q<pe.length;Q++)ja(ce,W,pe[Q])}function ja(ce,W,pe){var Q=ce.context,de=Q.gl,Le=pe.posMatrix,ze=ce.useProgram("debug"),Ke=Kr.disabled,ct=Kt.disabled,Lt=ce.colorModeForRenderPass(),$t="$debug";Q.activeTexture.set(de.TEXTURE0),ce.emptyTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE),ze.draw(Q,de.LINE_STRIP,Ke,ct,Lt,St.disabled,yn(Le,e.Color.red),$t,ce.debugBuffer,ce.tileBorderIndexBuffer,ce.debugSegments);var cr=W.getTileByID(pe.key).latestRawTileData,dr=cr&&cr.byteLength||0,Lr=Math.floor(dr/1024),Yr=W.getTile(pe).tileSize,Xr=512/Math.min(Yr,512)*(pe.overscaledZ/ce.transform.zoom)*.5,Gr=pe.canonical.toString();pe.overscaledZ!==pe.canonical.z&&(Gr+=" => "+pe.overscaledZ);var $r=Gr+" "+Lr+"kb";ai(ce,$r),ze.draw(Q,de.TRIANGLES,Ke,ct,$e.alphaBlended,St.disabled,yn(Le,e.Color.transparent,Xr),$t,ce.debugBuffer,ce.quadTriangleIndexBuffer,ce.debugSegments)}function ai(ce,W){ce.initDebugOverlayCanvas();var pe=ce.debugOverlayCanvas,Q=ce.context.gl,de=ce.debugOverlayCanvas.getContext("2d");de.clearRect(0,0,pe.width,pe.height),de.shadowColor="white",de.shadowBlur=2,de.lineWidth=1.5,de.strokeStyle="white",de.textBaseline="top",de.font="bold "+36+"px Open Sans, sans-serif",de.fillText(W,5,5),de.strokeText(W,5,5),ce.debugOverlayTexture.update(pe),ce.debugOverlayTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE)}function mi(ce,W,pe){var Q=ce.context,de=pe.implementation;if(ce.renderPass==="offscreen"){var Le=de.prerender;Le&&(ce.setCustomLayerDefaults(),Q.setColorMode(ce.colorModeForRenderPass()),Le.call(de,Q.gl,ce.transform.customLayerMatrix()),Q.setDirty(),ce.setBaseState())}else if(ce.renderPass==="translucent"){ce.setCustomLayerDefaults(),Q.setColorMode(ce.colorModeForRenderPass()),Q.setStencilMode(Kt.disabled);var ze=de.renderingMode==="3d"?new Kr(ce.context.gl.LEQUAL,Kr.ReadWrite,ce.depthRangeFor3D):ce.depthModeForSublayer(0,Kr.ReadOnly);Q.setDepthMode(ze),de.render(Q.gl,ce.transform.customLayerMatrix()),Q.setDirty(),ce.setBaseState(),Q.bindFramebuffer.set(null)}}var po={symbol:pf,circle:Ko,heatmap:mf,line:ju,fill:xf,"fill-extrusion":je,hillshade:lt,raster:kt,background:gr,debug:qa,custom:mi},oi=function(W,pe){this.context=new Ut(W),this.transform=pe,this._tileTextures={},this.setup(),this.numSublayers=Pe.maxUnderzooming+Pe.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new _a,this.gpuTimers={}};oi.prototype.resize=function(W,pe){if(this.width=W*e.browser.devicePixelRatio,this.height=pe*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var Q=0,de=this.style._order;Q<de.length;Q+=1){var Le=de[Q];this.style._layers[Le].resize()}},oi.prototype.setup=function(){var W=this.context,pe=new e.StructArrayLayout2i4;pe.emplaceBack(0,0),pe.emplaceBack(e.EXTENT,0),pe.emplaceBack(0,e.EXTENT),pe.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=W.createVertexBuffer(pe,El.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Q=new e.StructArrayLayout2i4;Q.emplaceBack(0,0),Q.emplaceBack(e.EXTENT,0),Q.emplaceBack(0,e.EXTENT),Q.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=W.createVertexBuffer(Q,El.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var de=new e.StructArrayLayout4i8;de.emplaceBack(0,0,0,0),de.emplaceBack(e.EXTENT,0,e.EXTENT,0),de.emplaceBack(0,e.EXTENT,0,e.EXTENT),de.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=W.createVertexBuffer(de,X.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Le=new e.StructArrayLayout2i4;Le.emplaceBack(0,0),Le.emplaceBack(1,0),Le.emplaceBack(0,1),Le.emplaceBack(1,1),this.viewportBuffer=W.createVertexBuffer(Le,El.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var ze=new e.StructArrayLayout1ui2;ze.emplaceBack(0),ze.emplaceBack(1),ze.emplaceBack(3),ze.emplaceBack(2),ze.emplaceBack(0),this.tileBorderIndexBuffer=W.createIndexBuffer(ze);var Ke=new e.StructArrayLayout3ui6;Ke.emplaceBack(0,1,2),Ke.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=W.createIndexBuffer(Ke),this.emptyTexture=new e.Texture(W,{width:1,height:1,data:new Uint8Array([0,0,0,0])},W.gl.RGBA);var ct=this.context.gl;this.stencilClearMode=new Kt({func:ct.ALWAYS,mask:0},0,255,ct.ZERO,ct.ZERO,ct.ZERO)},oi.prototype.clearStencil=function(){var W=this.context,pe=W.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var Q=e.create();e.ortho(Q,0,this.width,this.height,0,0,1),e.scale(Q,Q,[pe.drawingBufferWidth,pe.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(W,pe.TRIANGLES,Kr.disabled,this.stencilClearMode,$e.disabled,St.disabled,Pn(Q),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},oi.prototype._renderTileClippingMasks=function(W,pe){if(!(this.currentStencilSource===W.source||!W.isTileClipped()||!pe||!pe.length)){this.currentStencilSource=W.source;var Q=this.context,de=Q.gl;this.nextStencilID+pe.length>256&&this.clearStencil(),Q.setColorMode($e.disabled),Q.setDepthMode(Kr.disabled);var Le=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var ze=0,Ke=pe;ze<Ke.length;ze+=1){var ct=Ke[ze],Lt=this._tileClippingMaskIDs[ct.key]=this.nextStencilID++;Le.draw(Q,de.TRIANGLES,Kr.disabled,new Kt({func:de.ALWAYS,mask:0},Lt,255,de.KEEP,de.KEEP,de.REPLACE),$e.disabled,St.disabled,Pn(ct.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},oi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var W=this.nextStencilID++,pe=this.context.gl;return new Kt({func:pe.NOTEQUAL,mask:255},W,255,pe.KEEP,pe.KEEP,pe.REPLACE)},oi.prototype.stencilModeForClipping=function(W){var pe=this.context.gl;return new Kt({func:pe.EQUAL,mask:255},this._tileClippingMaskIDs[W.key],0,pe.KEEP,pe.KEEP,pe.REPLACE)},oi.prototype.stencilConfigForOverlap=function(W){var pe,Q=this.context.gl,de=W.sort(function(Lt,$t){return $t.overscaledZ-Lt.overscaledZ}),Le=de[de.length-1].overscaledZ,ze=de[0].overscaledZ-Le+1;if(ze>1){this.currentStencilSource=void 0,this.nextStencilID+ze>256&&this.clearStencil();for(var Ke={},ct=0;ct<ze;ct++)Ke[ct+Le]=new Kt({func:Q.GEQUAL,mask:255},ct+this.nextStencilID,255,Q.KEEP,Q.KEEP,Q.REPLACE);return this.nextStencilID+=ze,[Ke,de]}return[(pe={},pe[Le]=Kt.disabled,pe),de]},oi.prototype.colorModeForRenderPass=function(){var W=this.context.gl;if(this._showOverdrawInspector){var pe=8,Q=1/pe;return new $e([W.CONSTANT_COLOR,W.ONE],new e.Color(Q,Q,Q,0),[!0,!0,!0,!0])}else return this.renderPass==="opaque"?$e.unblended:$e.alphaBlended},oi.prototype.depthModeForSublayer=function(W,pe,Q){if(!this.opaquePassEnabledForLayer())return Kr.disabled;var de=1-((1+this.currentLayer)*this.numSublayers+W)*this.depthEpsilon;return new Kr(Q||this.context.gl.LEQUAL,pe,[de,de])},oi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},oi.prototype.render=function(W,pe){var Q=this;this.style=W,this.options=pe,this.lineAtlas=W.lineAtlas,this.imageManager=W.imageManager,this.glyphManager=W.glyphManager,this.symbolFadeChange=W.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var de=this.style._order,Le=this.style.sourceCaches;for(var ze in Le){var Ke=Le[ze];Ke.used&&Ke.prepare(this.context)}var ct={},Lt={},$t={};for(var cr in Le){var dr=Le[cr];ct[cr]=dr.getVisibleCoordinates(),Lt[cr]=ct[cr].slice().reverse(),$t[cr]=dr.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Lr=0;Lr<de.length;Lr++){var Yr=de[Lr];if(this.style._layers[Yr].is3D()){this.opaquePassCutoff=Lr;break}}this.renderPass="offscreen";for(var Xr=0,Gr=de;Xr<Gr.length;Xr+=1){var $r=Gr[Xr],pn=this.style._layers[$r];if(!(!pn.hasOffscreenPass()||pn.isHidden(this.transform.zoom))){var Ln=Lt[pn.source];pn.type!=="custom"&&!Ln.length||this.renderLayer(this,Le[pn.source],pn,Ln)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:pe.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=pe.showOverdrawInspector,this.depthRangeFor3D=[0,1-(W._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=de.length-1;this.currentLayer>=0;this.currentLayer--){var Nn=this.style._layers[de[this.currentLayer]],Qn=Le[Nn.source],ta=ct[Nn.source];this._renderTileClippingMasks(Nn,ta),this.renderLayer(this,Qn,Nn,ta)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<de.length;this.currentLayer++){var qn=this.style._layers[de[this.currentLayer]],pa=Le[qn.source],Ta=(qn.type==="symbol"?$t:Lt)[qn.source];this._renderTileClippingMasks(qn,ct[qn.source]),this.renderLayer(this,pa,qn,Ta)}if(this.options.showTileBoundaries){var ba,Sa,Pa=e.values(this.style._layers);Pa.forEach(function(Ya){Ya.source&&!Ya.isHidden(Q.transform.zoom)&&(Ya.source!==(Sa&&Sa.id)&&(Sa=Q.style.sourceCaches[Ya.source]),(!ba||ba.getSource().maxzoom<Sa.getSource().maxzoom)&&(ba=Sa))}),ba&&po.debug(this,ba,ba.getVisibleCoordinates())}this.options.showPadding&&wn(this),this.context.setDefault()},oi.prototype.renderLayer=function(W,pe,Q,de){Q.isHidden(this.transform.zoom)||Q.type!=="background"&&Q.type!=="custom"&&!de.length||(this.id=Q.id,this.gpuTimingStart(Q),po[Q.type](W,pe,Q,de,this.style.placement.variableOffsets),this.gpuTimingEnd())},oi.prototype.gpuTimingStart=function(W){if(!!this.options.gpuTiming){var pe=this.context.extTimerQuery,Q=this.gpuTimers[W.id];Q||(Q=this.gpuTimers[W.id]={calls:0,cpuTime:0,query:pe.createQueryEXT()}),Q.calls++,pe.beginQueryEXT(pe.TIME_ELAPSED_EXT,Q.query)}},oi.prototype.gpuTimingEnd=function(){if(!!this.options.gpuTiming){var W=this.context.extTimerQuery;W.endQueryEXT(W.TIME_ELAPSED_EXT)}},oi.prototype.collectGpuTimers=function(){var W=this.gpuTimers;return this.gpuTimers={},W},oi.prototype.queryGpuTimers=function(W){var pe={};for(var Q in W){var de=W[Q],Le=this.context.extTimerQuery,ze=Le.getQueryObjectEXT(de.query,Le.QUERY_RESULT_EXT)/(1e3*1e3);Le.deleteQueryEXT(de.query),pe[Q]=ze}return pe},oi.prototype.translatePosMatrix=function(W,pe,Q,de,Le){if(!Q[0]&&!Q[1])return W;var ze=Le?de==="map"?this.transform.angle:0:de==="viewport"?-this.transform.angle:0;if(ze){var Ke=Math.sin(ze),ct=Math.cos(ze);Q=[Q[0]*ct-Q[1]*Ke,Q[0]*Ke+Q[1]*ct]}var Lt=[Le?Q[0]:Sn(pe,Q[0],this.transform.zoom),Le?Q[1]:Sn(pe,Q[1],this.transform.zoom),0],$t=new Float32Array(16);return e.translate($t,W,Lt),$t},oi.prototype.saveTileTexture=function(W){var pe=this._tileTextures[W.size[0]];pe?pe.push(W):this._tileTextures[W.size[0]]=[W]},oi.prototype.getTileTexture=function(W){var pe=this._tileTextures[W];return pe&&pe.length>0?pe.pop():null},oi.prototype.isPatternMissing=function(W){if(!W)return!1;if(!W.from||!W.to)return!0;var pe=this.imageManager.getPattern(W.from.toString()),Q=this.imageManager.getPattern(W.to.toString());return!pe||!Q},oi.prototype.useProgram=function(W,pe){this.cache=this.cache||{};var Q=""+W+(pe?pe.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[Q]||(this.cache[Q]=new gs(this.context,Rl[W],pe,Mu[W],this._showOverdrawInspector)),this.cache[Q]},oi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},oi.prototype.setBaseState=function(){var W=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(W.FUNC_ADD)},oi.prototype.initDebugOverlayCanvas=function(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var W=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,W.RGBA)}},oi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var $i=function(W,pe){this.points=W,this.planes=pe};$i.fromInvProjectionMatrix=function(W,pe,Q){var de=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]],Le=Math.pow(2,Q),ze=de.map(function(Lt){return e.transformMat4([],Lt,W)}).map(function(Lt){return e.scale$1([],Lt,1/Lt[3]/pe*Le)}),Ke=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],ct=Ke.map(function(Lt){var $t=e.sub([],ze[Lt[0]],ze[Lt[1]]),cr=e.sub([],ze[Lt[2]],ze[Lt[1]]),dr=e.normalize([],e.cross([],$t,cr)),Lr=-e.dot(dr,ze[Lt[1]]);return dr.concat(Lr)});return new $i(ze,ct)};var _o=function(W,pe){this.min=W,this.max=pe,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};_o.prototype.quadrant=function(W){for(var pe=[W%2===0,W<2],Q=e.clone$2(this.min),de=e.clone$2(this.max),Le=0;Le<pe.length;Le++)Q[Le]=pe[Le]?this.min[Le]:this.center[Le],de[Le]=pe[Le]?this.center[Le]:this.max[Le];return de[2]=this.max[2],new _o(Q,de)},_o.prototype.distanceX=function(W){var pe=Math.max(Math.min(this.max[0],W[0]),this.min[0]);return pe-W[0]},_o.prototype.distanceY=function(W){var pe=Math.max(Math.min(this.max[1],W[1]),this.min[1]);return pe-W[1]},_o.prototype.intersects=function(W){for(var pe=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],Q=!0,de=0;de<W.planes.length;de++){for(var Le=W.planes[de],ze=0,Ke=0;Ke<pe.length;Ke++)ze+=e.dot$1(Le,pe[Ke])>=0;if(ze===0)return 0;ze!==pe.length&&(Q=!1)}if(Q)return 2;for(var ct=0;ct<3;ct++){for(var Lt=Number.MAX_VALUE,$t=-Number.MAX_VALUE,cr=0;cr<W.points.length;cr++){var dr=W.points[cr][ct]-this.min[ct];Lt=Math.min(Lt,dr),$t=Math.max($t,dr)}if($t<0||Lt>this.max[ct]-this.min[ct])return 0}return 1};var Ro=function(W,pe,Q,de){if(W===void 0&&(W=0),pe===void 0&&(pe=0),Q===void 0&&(Q=0),de===void 0&&(de=0),isNaN(W)||W<0||isNaN(pe)||pe<0||isNaN(Q)||Q<0||isNaN(de)||de<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=W,this.bottom=pe,this.left=Q,this.right=de};Ro.prototype.interpolate=function(W,pe,Q){return pe.top!=null&&W.top!=null&&(this.top=e.number(W.top,pe.top,Q)),pe.bottom!=null&&W.bottom!=null&&(this.bottom=e.number(W.bottom,pe.bottom,Q)),pe.left!=null&&W.left!=null&&(this.left=e.number(W.left,pe.left,Q)),pe.right!=null&&W.right!=null&&(this.right=e.number(W.right,pe.right,Q)),this},Ro.prototype.getCenter=function(W,pe){var Q=e.clamp((this.left+W-this.right)/2,0,W),de=e.clamp((this.top+pe-this.bottom)/2,0,pe);return new e.Point(Q,de)},Ro.prototype.equals=function(W){return this.top===W.top&&this.bottom===W.bottom&&this.left===W.left&&this.right===W.right},Ro.prototype.clone=function(){return new Ro(this.top,this.bottom,this.left,this.right)},Ro.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ci=function(W,pe,Q,de,Le){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=Le===void 0?!0:Le,this._minZoom=W||0,this._maxZoom=pe||22,this._minPitch=Q==null?0:Q,this._maxPitch=de==null?60:de,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ro,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ri={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ci.prototype.clone=function(){var W=new Ci(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return W.tileSize=this.tileSize,W.latRange=this.latRange,W.width=this.width,W.height=this.height,W._center=this._center,W.zoom=this.zoom,W.angle=this.angle,W._fov=this._fov,W._pitch=this._pitch,W._unmodified=this._unmodified,W._edgeInsets=this._edgeInsets.clone(),W._calcMatrices(),W},Ri.minZoom.get=function(){return this._minZoom},Ri.minZoom.set=function(ce){this._minZoom!==ce&&(this._minZoom=ce,this.zoom=Math.max(this.zoom,ce))},Ri.maxZoom.get=function(){return this._maxZoom},Ri.maxZoom.set=function(ce){this._maxZoom!==ce&&(this._maxZoom=ce,this.zoom=Math.min(this.zoom,ce))},Ri.minPitch.get=function(){return this._minPitch},Ri.minPitch.set=function(ce){this._minPitch!==ce&&(this._minPitch=ce,this.pitch=Math.max(this.pitch,ce))},Ri.maxPitch.get=function(){return this._maxPitch},Ri.maxPitch.set=function(ce){this._maxPitch!==ce&&(this._maxPitch=ce,this.pitch=Math.min(this.pitch,ce))},Ri.renderWorldCopies.get=function(){return this._renderWorldCopies},Ri.renderWorldCopies.set=function(ce){ce===void 0?ce=!0:ce===null&&(ce=!1),this._renderWorldCopies=ce},Ri.worldSize.get=function(){return this.tileSize*this.scale},Ri.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ri.size.get=function(){return new e.Point(this.width,this.height)},Ri.bearing.get=function(){return-this.angle/Math.PI*180},Ri.bearing.set=function(ce){var W=-e.wrap(ce,-180,180)*Math.PI/180;this.angle!==W&&(this._unmodified=!1,this.angle=W,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ri.pitch.get=function(){return this._pitch/Math.PI*180},Ri.pitch.set=function(ce){var W=e.clamp(ce,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==W&&(this._unmodified=!1,this._pitch=W,this._calcMatrices())},Ri.fov.get=function(){return this._fov/Math.PI*180},Ri.fov.set=function(ce){ce=Math.max(.01,Math.min(60,ce)),this._fov!==ce&&(this._unmodified=!1,this._fov=ce/180*Math.PI,this._calcMatrices())},Ri.zoom.get=function(){return this._zoom},Ri.zoom.set=function(ce){var W=Math.min(Math.max(ce,this.minZoom),this.maxZoom);this._zoom!==W&&(this._unmodified=!1,this._zoom=W,this.scale=this.zoomScale(W),this.tileZoom=Math.floor(W),this.zoomFraction=W-this.tileZoom,this._constrain(),this._calcMatrices())},Ri.center.get=function(){return this._center},Ri.center.set=function(ce){ce.lat===this._center.lat&&ce.lng===this._center.lng||(this._unmodified=!1,this._center=ce,this._constrain(),this._calcMatrices())},Ri.padding.get=function(){return this._edgeInsets.toJSON()},Ri.padding.set=function(ce){this._edgeInsets.equals(ce)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,ce,1),this._calcMatrices())},Ri.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ci.prototype.isPaddingEqual=function(W){return this._edgeInsets.equals(W)},Ci.prototype.interpolatePadding=function(W,pe,Q){this._unmodified=!1,this._edgeInsets.interpolate(W,pe,Q),this._constrain(),this._calcMatrices()},Ci.prototype.coveringZoomLevel=function(W){var pe=(W.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/W.tileSize));return Math.max(0,pe)},Ci.prototype.getVisibleUnwrappedCoordinates=function(W){var pe=[new e.UnwrappedTileID(0,W)];if(this._renderWorldCopies)for(var Q=this.pointCoordinate(new e.Point(0,0)),de=this.pointCoordinate(new e.Point(this.width,0)),Le=this.pointCoordinate(new e.Point(this.width,this.height)),ze=this.pointCoordinate(new e.Point(0,this.height)),Ke=Math.floor(Math.min(Q.x,de.x,Le.x,ze.x)),ct=Math.floor(Math.max(Q.x,de.x,Le.x,ze.x)),Lt=1,$t=Ke-Lt;$t<=ct+Lt;$t++)$t!==0&&pe.push(new e.UnwrappedTileID($t,W));return pe},Ci.prototype.coveringTiles=function(W){var pe=this.coveringZoomLevel(W),Q=pe;if(W.minzoom!==void 0&&pe<W.minzoom)return[];W.maxzoom!==void 0&&pe>W.maxzoom&&(pe=W.maxzoom);var de=e.MercatorCoordinate.fromLngLat(this.center),Le=Math.pow(2,pe),ze=[Le*de.x,Le*de.y,0],Ke=$i.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,pe),ct=W.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ct=pe);var Lt=3,$t=function(Pa){return{aabb:new _o([Pa*Le,0,0],[(Pa+1)*Le,Le,0]),zoom:0,x:0,y:0,wrap:Pa,fullyVisible:!1}},cr=[],dr=[],Lr=pe,Yr=W.reparseOverscaled?Q:pe;if(this._renderWorldCopies)for(var Xr=1;Xr<=3;Xr++)cr.push($t(-Xr)),cr.push($t(Xr));for(cr.push($t(0));cr.length>0;){var Gr=cr.pop(),$r=Gr.x,pn=Gr.y,Ln=Gr.fullyVisible;if(!Ln){var Nn=Gr.aabb.intersects(Ke);if(Nn===0)continue;Ln=Nn===2}var Qn=Gr.aabb.distanceX(ze),ta=Gr.aabb.distanceY(ze),qn=Math.max(Math.abs(Qn),Math.abs(ta)),pa=Lt+(1<<Lr-Gr.zoom)-2;if(Gr.zoom===Lr||qn>pa&&Gr.zoom>=ct){dr.push({tileID:new e.OverscaledTileID(Gr.zoom===Lr?Yr:Gr.zoom,Gr.wrap,Gr.zoom,$r,pn),distanceSq:e.sqrLen([ze[0]-.5-$r,ze[1]-.5-pn])});continue}for(var Ta=0;Ta<4;Ta++){var ba=($r<<1)+Ta%2,Sa=(pn<<1)+(Ta>>1);cr.push({aabb:Gr.aabb.quadrant(Ta),zoom:Gr.zoom+1,x:ba,y:Sa,wrap:Gr.wrap,fullyVisible:Ln})}}return dr.sort(function(Pa,Ya){return Pa.distanceSq-Ya.distanceSq}).map(function(Pa){return Pa.tileID})},Ci.prototype.resize=function(W,pe){this.width=W,this.height=pe,this.pixelsToGLUnits=[2/W,-2/pe],this._constrain(),this._calcMatrices()},Ri.unmodified.get=function(){return this._unmodified},Ci.prototype.zoomScale=function(W){return Math.pow(2,W)},Ci.prototype.scaleZoom=function(W){return Math.log(W)/Math.LN2},Ci.prototype.project=function(W){var pe=e.clamp(W.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(W.lng)*this.worldSize,e.mercatorYfromLat(pe)*this.worldSize)},Ci.prototype.unproject=function(W){return new e.MercatorCoordinate(W.x/this.worldSize,W.y/this.worldSize).toLngLat()},Ri.point.get=function(){return this.project(this.center)},Ci.prototype.setLocationAtPoint=function(W,pe){var Q=this.pointCoordinate(pe),de=this.pointCoordinate(this.centerPoint),Le=this.locationCoordinate(W),ze=new e.MercatorCoordinate(Le.x-(Q.x-de.x),Le.y-(Q.y-de.y));this.center=this.coordinateLocation(ze),this._renderWorldCopies&&(this.center=this.center.wrap())},Ci.prototype.locationPoint=function(W){return this.coordinatePoint(this.locationCoordinate(W))},Ci.prototype.pointLocation=function(W){return this.coordinateLocation(this.pointCoordinate(W))},Ci.prototype.locationCoordinate=function(W){return e.MercatorCoordinate.fromLngLat(W)},Ci.prototype.coordinateLocation=function(W){return W.toLngLat()},Ci.prototype.pointCoordinate=function(W){var pe=0,Q=[W.x,W.y,0,1],de=[W.x,W.y,1,1];e.transformMat4(Q,Q,this.pixelMatrixInverse),e.transformMat4(de,de,this.pixelMatrixInverse);var Le=Q[3],ze=de[3],Ke=Q[0]/Le,ct=de[0]/ze,Lt=Q[1]/Le,$t=de[1]/ze,cr=Q[2]/Le,dr=de[2]/ze,Lr=cr===dr?0:(pe-cr)/(dr-cr);return new e.MercatorCoordinate(e.number(Ke,ct,Lr)/this.worldSize,e.number(Lt,$t,Lr)/this.worldSize)},Ci.prototype.coordinatePoint=function(W){var pe=[W.x*this.worldSize,W.y*this.worldSize,0,1];return e.transformMat4(pe,pe,this.pixelMatrix),new e.Point(pe[0]/pe[3],pe[1]/pe[3])},Ci.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},Ci.prototype.getMaxBounds=function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])},Ci.prototype.setMaxBounds=function(W){W?(this.lngRange=[W.getWest(),W.getEast()],this.latRange=[W.getSouth(),W.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ci.prototype.calculatePosMatrix=function(W,pe){pe===void 0&&(pe=!1);var Q=W.key,de=pe?this._alignedPosMatrixCache:this._posMatrixCache;if(de[Q])return de[Q];var Le=W.canonical,ze=this.worldSize/this.zoomScale(Le.z),Ke=Le.x+Math.pow(2,Le.z)*W.wrap,ct=e.identity(new Float64Array(16));return e.translate(ct,ct,[Ke*ze,Le.y*ze,0]),e.scale(ct,ct,[ze/e.EXTENT,ze/e.EXTENT,1]),e.multiply(ct,pe?this.alignedProjMatrix:this.projMatrix,ct),de[Q]=new Float32Array(ct),de[Q]},Ci.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ci.prototype._constrain=function(){if(!(!this.center||!this.width||!this.height||this._constraining)){this._constraining=!0;var W=-90,pe=90,Q=-180,de=180,Le,ze,Ke,ct,Lt=this.size,$t=this._unmodified;if(this.latRange){var cr=this.latRange;W=e.mercatorYfromLat(cr[1])*this.worldSize,pe=e.mercatorYfromLat(cr[0])*this.worldSize,Le=pe-W<Lt.y?Lt.y/(pe-W):0}if(this.lngRange){var dr=this.lngRange;Q=e.mercatorXfromLng(dr[0])*this.worldSize,de=e.mercatorXfromLng(dr[1])*this.worldSize,ze=de-Q<Lt.x?Lt.x/(de-Q):0}var Lr=this.point,Yr=Math.max(ze||0,Le||0);if(Yr){this.center=this.unproject(new e.Point(ze?(de+Q)/2:Lr.x,Le?(pe+W)/2:Lr.y)),this.zoom+=this.scaleZoom(Yr),this._unmodified=$t,this._constraining=!1;return}if(this.latRange){var Xr=Lr.y,Gr=Lt.y/2;Xr-Gr<W&&(ct=W+Gr),Xr+Gr>pe&&(ct=pe-Gr)}if(this.lngRange){var $r=Lr.x,pn=Lt.x/2;$r-pn<Q&&(Ke=Q+pn),$r+pn>de&&(Ke=de-pn)}(Ke!==void 0||ct!==void 0)&&(this.center=this.unproject(new e.Point(Ke!==void 0?Ke:Lr.x,ct!==void 0?ct:Lr.y))),this._unmodified=$t,this._constraining=!1}},Ci.prototype._calcMatrices=function(){if(!!this.height){var W=this._fov/2,pe=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(W)*this.height;var Q=Math.PI/2+this._pitch,de=this._fov*(.5+pe.y/this.height),Le=Math.sin(de)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-Q-de,.01,Math.PI-.01)),ze=this.point,Ke=ze.x,ct=ze.y,Lt=Math.cos(Math.PI/2-this._pitch)*Le+this.cameraToCenterDistance,$t=Lt*1.01,cr=this.height/50,dr=new Float64Array(16);e.perspective(dr,this._fov,this.width/this.height,cr,$t),dr[8]=-pe.x*2/this.width,dr[9]=pe.y*2/this.height,e.scale(dr,dr,[1,-1,1]),e.translate(dr,dr,[0,0,-this.cameraToCenterDistance]),e.rotateX(dr,dr,this._pitch),e.rotateZ(dr,dr,this.angle),e.translate(dr,dr,[-Ke,-ct,0]),this.mercatorMatrix=e.scale([],dr,[this.worldSize,this.worldSize,this.worldSize]),e.scale(dr,dr,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=dr,this.invProjMatrix=e.invert([],this.projMatrix);var Lr=this.width%2/2,Yr=this.height%2/2,Xr=Math.cos(this.angle),Gr=Math.sin(this.angle),$r=Ke-Math.round(Ke)+Xr*Lr+Gr*Yr,pn=ct-Math.round(ct)+Xr*Yr+Gr*Lr,Ln=new Float64Array(dr);if(e.translate(Ln,Ln,[$r>.5?$r-1:$r,pn>.5?pn-1:pn,0]),this.alignedProjMatrix=Ln,dr=e.create(),e.scale(dr,dr,[this.width/2,-this.height/2,1]),e.translate(dr,dr,[1,-1,0]),this.labelPlaneMatrix=dr,dr=e.create(),e.scale(dr,dr,[1,-1,1]),e.translate(dr,dr,[-1,-1,0]),e.scale(dr,dr,[2/this.width,2/this.height,1]),this.glCoordMatrix=dr,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),dr=e.invert(new Float64Array(16),this.pixelMatrix),!dr)throw new Error("failed to invert matrix");this.pixelMatrixInverse=dr,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ci.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var W=this.pointCoordinate(new e.Point(0,0)),pe=[W.x*this.worldSize,W.y*this.worldSize,0,1],Q=e.transformMat4(pe,pe,this.pixelMatrix);return Q[3]/this.cameraToCenterDistance},Ci.prototype.getCameraPoint=function(){var W=this._pitch,pe=Math.tan(W)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,pe))},Ci.prototype.getCameraQueryGeometry=function(W){var pe=this.getCameraPoint();if(W.length===1)return[W[0],pe];for(var Q=pe.x,de=pe.y,Le=pe.x,ze=pe.y,Ke=0,ct=W;Ke<ct.length;Ke+=1){var Lt=ct[Ke];Q=Math.min(Q,Lt.x),de=Math.min(de,Lt.y),Le=Math.max(Le,Lt.x),ze=Math.max(ze,Lt.y)}return[new e.Point(Q,de),new e.Point(Le,de),new e.Point(Le,ze),new e.Point(Q,ze),new e.Point(Q,de)]},Object.defineProperties(Ci.prototype,Ri);function ks(ce,W){var pe=!1,Q=null,de=function(){Q=null,pe&&(ce(),Q=setTimeout(de,W),pe=!1)};return function(){return pe=!0,Q||de(),Q}}var Eo=function(W){this._hashName=W&&encodeURIComponent(W),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ks(this._updateHashUnthrottled.bind(this),30*1e3/100)};Eo.prototype.addTo=function(W){return this._map=W,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Eo.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Eo.prototype.getHashString=function(W){var pe=this._map.getCenter(),Q=Math.round(this._map.getZoom()*100)/100,de=Math.ceil((Q*Math.LN2+Math.log(512/360/.5))/Math.LN10),Le=Math.pow(10,de),ze=Math.round(pe.lng*Le)/Le,Ke=Math.round(pe.lat*Le)/Le,ct=this._map.getBearing(),Lt=this._map.getPitch(),$t="";if(W?$t+="/"+ze+"/"+Ke+"/"+Q:$t+=Q+"/"+Ke+"/"+ze,(ct||Lt)&&($t+="/"+Math.round(ct*10)/10),Lt&&($t+="/"+Math.round(Lt)),this._hashName){var cr=this._hashName,dr=!1,Lr=e.window.location.hash.slice(1).split("&").map(function(Yr){var Xr=Yr.split("=")[0];return Xr===cr?(dr=!0,Xr+"="+$t):Yr}).filter(function(Yr){return Yr});return dr||Lr.push(cr+"="+$t),"#"+Lr.join("&")}return"#"+$t},Eo.prototype._getCurrentHash=function(){var W=this,pe=e.window.location.hash.replace("#","");if(this._hashName){var Q;return pe.split("&").map(function(de){return de.split("=")}).forEach(function(de){de[0]===W._hashName&&(Q=de)}),(Q&&Q[1]||"").split("/")}return pe.split("/")},Eo.prototype._onHashChange=function(){var W=this._getCurrentHash();if(W.length>=3&&!W.some(function(Q){return isNaN(Q)})){var pe=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(W[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+W[2],+W[1]],zoom:+W[0],bearing:pe,pitch:+(W[4]||0)}),!0}return!1},Eo.prototype._updateHashUnthrottled=function(){var W=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",W)}catch{}};var Yo={linearity:.3,easing:e.bezier(0,0,.3,1)},os=e.extend({deceleration:2500,maxSpeed:1400},Yo),fe=e.extend({deceleration:20,maxSpeed:1400},Yo),Ae=e.extend({deceleration:1e3,maxSpeed:360},Yo),Fe=e.extend({deceleration:1e3,maxSpeed:90},Yo),Ve=function(W){this._map=W,this.clear()};Ve.prototype.clear=function(){this._inertiaBuffer=[]},Ve.prototype.record=function(W){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:W})},Ve.prototype._drainInertiaBuffer=function(){for(var W=this._inertiaBuffer,pe=e.browser.now(),Q=160;W.length>0&&pe-W[0].time>Q;)W.shift()},Ve.prototype._onMoveEnd=function(W){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var pe={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},Q=0,de=this._inertiaBuffer;Q<de.length;Q+=1){var Le=de[Q],ze=Le.settings;pe.zoom+=ze.zoomDelta||0,pe.bearing+=ze.bearingDelta||0,pe.pitch+=ze.pitchDelta||0,ze.panDelta&&pe.pan._add(ze.panDelta),ze.around&&(pe.around=ze.around),ze.pinchAround&&(pe.pinchAround=ze.pinchAround)}var Ke=this._inertiaBuffer[this._inertiaBuffer.length-1],ct=Ke.time-this._inertiaBuffer[0].time,Lt={};if(pe.pan.mag()){var $t=Qe(pe.pan.mag(),ct,e.extend({},os,W||{}));Lt.offset=pe.pan.mult($t.amount/pe.pan.mag()),Lt.center=this._map.transform.center,Ue(Lt,$t)}if(pe.zoom){var cr=Qe(pe.zoom,ct,fe);Lt.zoom=this._map.transform.zoom+cr.amount,Ue(Lt,cr)}if(pe.bearing){var dr=Qe(pe.bearing,ct,Ae);Lt.bearing=this._map.transform.bearing+e.clamp(dr.amount,-179,179),Ue(Lt,dr)}if(pe.pitch){var Lr=Qe(pe.pitch,ct,Fe);Lt.pitch=this._map.transform.pitch+Lr.amount,Ue(Lt,Lr)}if(Lt.zoom||Lt.bearing){var Yr=pe.pinchAround===void 0?pe.around:pe.pinchAround;Lt.around=Yr?this._map.unproject(Yr):this._map.getCenter()}return this.clear(),e.extend(Lt,{noMoveStart:!0})}};function Ue(ce,W){(!ce.duration||ce.duration<W.duration)&&(ce.duration=W.duration,ce.easing=W.easing)}function Qe(ce,W,pe){var Q=pe.maxSpeed,de=pe.linearity,Le=pe.deceleration,ze=e.clamp(ce*de/(W/1e3),-Q,Q),Ke=Math.abs(ze)/(Le*de);return{easing:pe.easing,duration:Ke*1e3,amount:ze*(Ke/2)}}var _t=function(ce){function W(Q,de,Le,ze){ze===void 0&&(ze={});var Ke=n.mousePos(de.getCanvasContainer(),Le),ct=de.unproject(Ke);ce.call(this,Q,e.extend({point:Ke,lngLat:ct,originalEvent:Le},ze)),this._defaultPrevented=!1,this.target=de}ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W;var pe={defaultPrevented:{configurable:!0}};return W.prototype.preventDefault=function(){this._defaultPrevented=!0},pe.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(W.prototype,pe),W}(e.Event),dt=function(ce){function W(Q,de,Le){var ze=Q==="touchend"?Le.changedTouches:Le.touches,Ke=n.touchPos(de.getCanvasContainer(),ze),ct=Ke.map(function(cr){return de.unproject(cr)}),Lt=Ke.reduce(function(cr,dr,Lr,Yr){return cr.add(dr.div(Yr.length))},new e.Point(0,0)),$t=de.unproject(Lt);ce.call(this,Q,{points:Ke,point:Lt,lngLats:ct,lngLat:$t,originalEvent:Le}),this._defaultPrevented=!1}ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W;var pe={defaultPrevented:{configurable:!0}};return W.prototype.preventDefault=function(){this._defaultPrevented=!0},pe.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(W.prototype,pe),W}(e.Event),It=function(ce){function W(Q,de,Le){ce.call(this,Q,{originalEvent:Le}),this._defaultPrevented=!1}ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W;var pe={defaultPrevented:{configurable:!0}};return W.prototype.preventDefault=function(){this._defaultPrevented=!0},pe.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(W.prototype,pe),W}(e.Event),Qt=function(W,pe){this._map=W,this._clickTolerance=pe.clickTolerance};Qt.prototype.reset=function(){delete this._mousedownPos},Qt.prototype.wheel=function(W){return this._firePreventable(new It(W.type,this._map,W))},Qt.prototype.mousedown=function(W,pe){return this._mousedownPos=pe,this._firePreventable(new _t(W.type,this._map,W))},Qt.prototype.mouseup=function(W){this._map.fire(new _t(W.type,this._map,W))},Qt.prototype.click=function(W,pe){this._mousedownPos&&this._mousedownPos.dist(pe)>=this._clickTolerance||this._map.fire(new _t(W.type,this._map,W))},Qt.prototype.dblclick=function(W){return this._firePreventable(new _t(W.type,this._map,W))},Qt.prototype.mouseover=function(W){this._map.fire(new _t(W.type,this._map,W))},Qt.prototype.mouseout=function(W){this._map.fire(new _t(W.type,this._map,W))},Qt.prototype.touchstart=function(W){return this._firePreventable(new dt(W.type,this._map,W))},Qt.prototype.touchmove=function(W){this._map.fire(new dt(W.type,this._map,W))},Qt.prototype.touchend=function(W){this._map.fire(new dt(W.type,this._map,W))},Qt.prototype.touchcancel=function(W){this._map.fire(new dt(W.type,this._map,W))},Qt.prototype._firePreventable=function(W){if(this._map.fire(W),W.defaultPrevented)return{}},Qt.prototype.isEnabled=function(){return!0},Qt.prototype.isActive=function(){return!1},Qt.prototype.enable=function(){},Qt.prototype.disable=function(){};var tr=function(W){this._map=W};tr.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},tr.prototype.mousemove=function(W){this._map.fire(new _t(W.type,this._map,W))},tr.prototype.mousedown=function(){this._delayContextMenu=!0},tr.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new _t("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},tr.prototype.contextmenu=function(W){this._delayContextMenu?this._contextMenuEvent=W:this._map.fire(new _t(W.type,this._map,W)),this._map.listens("contextmenu")&&W.preventDefault()},tr.prototype.isEnabled=function(){return!0},tr.prototype.isActive=function(){return!1},tr.prototype.enable=function(){},tr.prototype.disable=function(){};var rr=function(W,pe){this._map=W,this._el=W.getCanvasContainer(),this._container=W.getContainer(),this._clickTolerance=pe.clickTolerance||1};rr.prototype.isEnabled=function(){return!!this._enabled},rr.prototype.isActive=function(){return!!this._active},rr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},rr.prototype.disable=function(){!this.isEnabled()||(this._enabled=!1)},rr.prototype.mousedown=function(W,pe){!this.isEnabled()||!(W.shiftKey&&W.button===0)||(n.disableDrag(),this._startPos=this._lastPos=pe,this._active=!0)},rr.prototype.mousemoveWindow=function(W,pe){if(!!this._active){var Q=pe;if(!(this._lastPos.equals(Q)||!this._box&&Q.dist(this._startPos)<this._clickTolerance)){var de=this._startPos;this._lastPos=Q,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",W));var Le=Math.min(de.x,Q.x),ze=Math.max(de.x,Q.x),Ke=Math.min(de.y,Q.y),ct=Math.max(de.y,Q.y);n.setTransform(this._box,"translate("+Le+"px,"+Ke+"px)"),this._box.style.width=ze-Le+"px",this._box.style.height=ct-Ke+"px"}}},rr.prototype.mouseupWindow=function(W,pe){var Q=this;if(!!this._active&&W.button===0){var de=this._startPos,Le=pe;if(this.reset(),n.suppressClick(),de.x===Le.x&&de.y===Le.y)this._fireEvent("boxzoomcancel",W);else return this._map.fire(new e.Event("boxzoomend",{originalEvent:W})),{cameraAnimation:function(ze){return ze.fitScreenCoordinates(de,Le,Q._map.getBearing(),{linear:!0})}}}},rr.prototype.keydown=function(W){!this._active||W.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",W))},rr.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},rr.prototype._fireEvent=function(W,pe){return this._map.fire(new e.Event(W,{originalEvent:pe}))};function Er(ce,W){for(var pe={},Q=0;Q<ce.length;Q++)pe[ce[Q].identifier]=W[Q];return pe}function qr(ce){for(var W=new e.Point(0,0),pe=0,Q=ce;pe<Q.length;pe+=1){var de=Q[pe];W._add(de)}return W.div(ce.length)}var fn=500,Pr=500,Vr=30,Jr=function(W){this.reset(),this.numTouches=W.numTouches};Jr.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Jr.prototype.touchstart=function(W,pe,Q){(this.centroid||Q.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=W.timeStamp),Q.length===this.numTouches&&(this.centroid=qr(pe),this.touches=Er(Q,pe)))},Jr.prototype.touchmove=function(W,pe,Q){if(!(this.aborted||!this.centroid)){var de=Er(Q,pe);for(var Le in this.touches){var ze=this.touches[Le],Ke=de[Le];(!Ke||Ke.dist(ze)>Vr)&&(this.aborted=!0)}}},Jr.prototype.touchend=function(W,pe,Q){if((!this.centroid||W.timeStamp-this.startTime>Pr)&&(this.aborted=!0),Q.length===0){var de=!this.aborted&&this.centroid;if(this.reset(),de)return de}};var sn=function(W){this.singleTap=new Jr(W),this.numTaps=W.numTaps,this.reset()};sn.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},sn.prototype.touchstart=function(W,pe,Q){this.singleTap.touchstart(W,pe,Q)},sn.prototype.touchmove=function(W,pe,Q){this.singleTap.touchmove(W,pe,Q)},sn.prototype.touchend=function(W,pe,Q){var de=this.singleTap.touchend(W,pe,Q);if(de){var Le=W.timeStamp-this.lastTime<fn,ze=!this.lastTap||this.lastTap.dist(de)<Vr;if((!Le||!ze)&&this.reset(),this.count++,this.lastTime=W.timeStamp,this.lastTap=de,this.count===this.numTaps)return this.reset(),de}};var un=function(){this._zoomIn=new sn({numTouches:1,numTaps:2}),this._zoomOut=new sn({numTouches:2,numTaps:1}),this.reset()};un.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},un.prototype.touchstart=function(W,pe,Q){this._zoomIn.touchstart(W,pe,Q),this._zoomOut.touchstart(W,pe,Q)},un.prototype.touchmove=function(W,pe,Q){this._zoomIn.touchmove(W,pe,Q),this._zoomOut.touchmove(W,pe,Q)},un.prototype.touchend=function(W,pe,Q){var de=this,Le=this._zoomIn.touchend(W,pe,Q),ze=this._zoomOut.touchend(W,pe,Q);if(Le)return this._active=!0,W.preventDefault(),setTimeout(function(){return de.reset()},0),{cameraAnimation:function(Ke){return Ke.easeTo({duration:300,zoom:Ke.getZoom()+1,around:Ke.unproject(Le)},{originalEvent:W})}};if(ze)return this._active=!0,W.preventDefault(),setTimeout(function(){return de.reset()},0),{cameraAnimation:function(Ke){return Ke.easeTo({duration:300,zoom:Ke.getZoom()-1,around:Ke.unproject(ze)},{originalEvent:W})}}},un.prototype.touchcancel=function(){this.reset()},un.prototype.enable=function(){this._enabled=!0},un.prototype.disable=function(){this._enabled=!1,this.reset()},un.prototype.isEnabled=function(){return this._enabled},un.prototype.isActive=function(){return this._active};var Qr=0,Hn=2,aa=function(W){this.reset(),this._clickTolerance=W.clickTolerance||1};aa.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},aa.prototype._correctButton=function(W,pe){return!1},aa.prototype._move=function(W,pe){return{}},aa.prototype.mousedown=function(W,pe){if(!this._lastPoint){var Q=n.mouseButton(W);!this._correctButton(W,Q)||(this._lastPoint=pe,this._eventButton=Q)}},aa.prototype.mousemoveWindow=function(W,pe){var Q=this._lastPoint;if(!!Q&&(W.preventDefault(),!(!this._moved&&pe.dist(Q)<this._clickTolerance)))return this._moved=!0,this._lastPoint=pe,this._move(Q,pe)},aa.prototype.mouseupWindow=function(W){var pe=n.mouseButton(W);pe===this._eventButton&&(this._moved&&n.suppressClick(),this.reset())},aa.prototype.enable=function(){this._enabled=!0},aa.prototype.disable=function(){this._enabled=!1,this.reset()},aa.prototype.isEnabled=function(){return this._enabled},aa.prototype.isActive=function(){return this._active};var Aa=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.mousedown=function(Q,de){ce.prototype.mousedown.call(this,Q,de),this._lastPoint&&(this._active=!0)},W.prototype._correctButton=function(Q,de){return de===Qr&&!Q.ctrlKey},W.prototype._move=function(Q,de){return{around:de,panDelta:de.sub(Q)}},W}(aa),sa=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype._correctButton=function(Q,de){return de===Qr&&Q.ctrlKey||de===Hn},W.prototype._move=function(Q,de){var Le=.8,ze=(de.x-Q.x)*Le;if(ze)return this._active=!0,{bearingDelta:ze}},W.prototype.contextmenu=function(Q){Q.preventDefault()},W}(aa),Da=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype._correctButton=function(Q,de){return de===Qr&&Q.ctrlKey||de===Hn},W.prototype._move=function(Q,de){var Le=-.5,ze=(de.y-Q.y)*Le;if(ze)return this._active=!0,{pitchDelta:ze}},W.prototype.contextmenu=function(Q){Q.preventDefault()},W}(aa),fa=function(W){this._minTouches=1,this._clickTolerance=W.clickTolerance||1,this.reset()};fa.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},fa.prototype.touchstart=function(W,pe,Q){return this._calculateTransform(W,pe,Q)},fa.prototype.touchmove=function(W,pe,Q){if(!!this._active)return W.preventDefault(),this._calculateTransform(W,pe,Q)},fa.prototype.touchend=function(W,pe,Q){this._calculateTransform(W,pe,Q),this._active&&Q.length<this._minTouches&&this.reset()},fa.prototype.touchcancel=function(){this.reset()},fa.prototype._calculateTransform=function(W,pe,Q){Q.length>0&&(this._active=!0);var de=Er(Q,pe),Le=new e.Point(0,0),ze=new e.Point(0,0),Ke=0;for(var ct in de){var Lt=de[ct],$t=this._touches[ct];$t&&(Le._add(Lt),ze._add(Lt.sub($t)),Ke++,de[ct]=Lt)}if(this._touches=de,!(Ke<this._minTouches||!ze.mag())){var cr=ze.div(Ke);if(this._sum._add(cr),!(this._sum.mag()<this._clickTolerance)){var dr=Le.div(Ke);return{around:dr,panDelta:cr}}}},fa.prototype.enable=function(){this._enabled=!0},fa.prototype.disable=function(){this._enabled=!1,this.reset()},fa.prototype.isEnabled=function(){return this._enabled},fa.prototype.isActive=function(){return this._active};var Ha=function(){this.reset()};Ha.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ha.prototype._start=function(W){},Ha.prototype._move=function(W,pe,Q){return{}},Ha.prototype.touchstart=function(W,pe,Q){this._firstTwoTouches||Q.length<2||(this._firstTwoTouches=[Q[0].identifier,Q[1].identifier],this._start([pe[0],pe[1]]))},Ha.prototype.touchmove=function(W,pe,Q){if(!!this._firstTwoTouches){W.preventDefault();var de=this._firstTwoTouches,Le=de[0],ze=de[1],Ke=Ra(Q,pe,Le),ct=Ra(Q,pe,ze);if(!(!Ke||!ct)){var Lt=this._aroundCenter?null:Ke.add(ct).div(2);return this._move([Ke,ct],Lt,W)}}},Ha.prototype.touchend=function(W,pe,Q){if(!!this._firstTwoTouches){var de=this._firstTwoTouches,Le=de[0],ze=de[1],Ke=Ra(Q,pe,Le),ct=Ra(Q,pe,ze);Ke&&ct||(this._active&&n.suppressClick(),this.reset())}},Ha.prototype.touchcancel=function(){this.reset()},Ha.prototype.enable=function(W){this._enabled=!0,this._aroundCenter=!!W&&W.around==="center"},Ha.prototype.disable=function(){this._enabled=!1,this.reset()},Ha.prototype.isEnabled=function(){return this._enabled},Ha.prototype.isActive=function(){return this._active};function Ra(ce,W,pe){for(var Q=0;Q<ce.length;Q++)if(ce[Q].identifier===pe)return W[Q]}var ri=.1;function Ai(ce,W){return Math.log(ce/W)/Math.LN2}var wo=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.reset=function(){ce.prototype.reset.call(this),delete this._distance,delete this._startDistance},W.prototype._start=function(Q){this._startDistance=this._distance=Q[0].dist(Q[1])},W.prototype._move=function(Q,de){var Le=this._distance;if(this._distance=Q[0].dist(Q[1]),!(!this._active&&Math.abs(Ai(this._distance,this._startDistance))<ri))return this._active=!0,{zoomDelta:Ai(this._distance,Le),pinchAround:de}},W}(Ha),Gi=25;function va(ce,W){return ce.angleWith(W)*180/Math.PI}var li=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.reset=function(){ce.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},W.prototype._start=function(Q){this._startVector=this._vector=Q[0].sub(Q[1]),this._minDiameter=Q[0].dist(Q[1])},W.prototype._move=function(Q,de){var Le=this._vector;if(this._vector=Q[0].sub(Q[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:va(this._vector,Le),pinchAround:de}},W.prototype._isBelowThreshold=function(Q){this._minDiameter=Math.min(this._minDiameter,Q.mag());var de=Math.PI*this._minDiameter,Le=Gi/de*360,ze=va(Q,this._startVector);return Math.abs(ze)<Le},W}(Ha);function Ka(ce){return Math.abs(ce.y)>Math.abs(ce.x)}var Ii=100,ci=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.reset=function(){ce.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},W.prototype._start=function(Q){this._lastPoints=Q,Ka(Q[0].sub(Q[1]))&&(this._valid=!1)},W.prototype._move=function(Q,de,Le){var ze=Q[0].sub(this._lastPoints[0]),Ke=Q[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(ze,Ke,Le.timeStamp),!!this._valid){this._lastPoints=Q,this._active=!0;var ct=(ze.y+Ke.y)/2,Lt=-.5;return{pitchDelta:ct*Lt}}},W.prototype.gestureBeginsVertically=function(Q,de,Le){if(this._valid!==void 0)return this._valid;var ze=2,Ke=Q.mag()>=ze,ct=de.mag()>=ze;if(!(!Ke&&!ct)){if(!Ke||!ct)return this._firstMove===void 0&&(this._firstMove=Le),Le-this._firstMove<Ii?void 0:!1;var Lt=Q.y>0==de.y>0;return Ka(Q)&&Ka(de)&&Lt}},W}(Ha),go={panStep:100,bearingStep:15,pitchStep:10},so=function(){var W=go;this._panStep=W.panStep,this._bearingStep=W.bearingStep,this._pitchStep=W.pitchStep};so.prototype.reset=function(){this._active=!1},so.prototype.keydown=function(W){var pe=this;if(!(W.altKey||W.ctrlKey||W.metaKey)){var Q=0,de=0,Le=0,ze=0,Ke=0;switch(W.keyCode){case 61:case 107:case 171:case 187:Q=1;break;case 189:case 109:case 173:Q=-1;break;case 37:W.shiftKey?de=-1:(W.preventDefault(),ze=-1);break;case 39:W.shiftKey?de=1:(W.preventDefault(),ze=1);break;case 38:W.shiftKey?Le=1:(W.preventDefault(),Ke=-1);break;case 40:W.shiftKey?Le=-1:(W.preventDefault(),Ke=1);break;default:return}return{cameraAnimation:function(ct){var Lt=ct.getZoom();ct.easeTo({duration:300,easeId:"keyboardHandler",easing:Co,zoom:Q?Math.round(Lt)+Q*(W.shiftKey?2:1):Lt,bearing:ct.getBearing()+de*pe._bearingStep,pitch:ct.getPitch()+Le*pe._pitchStep,offset:[-ze*pe._panStep,-Ke*pe._panStep],center:ct.getCenter()},{originalEvent:W})}}}},so.prototype.enable=function(){this._enabled=!0},so.prototype.disable=function(){this._enabled=!1,this.reset()},so.prototype.isEnabled=function(){return this._enabled},so.prototype.isActive=function(){return this._active};function Co(ce){return ce*(2-ce)}var ss=4.000244140625,Qo=1/100,ls=1/450,qi=2,ji=function(W,pe){this._map=W,this._el=W.getCanvasContainer(),this._handler=pe,this._delta=0,this._defaultZoomRate=Qo,this._wheelZoomRate=ls,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};ji.prototype.setZoomRate=function(W){this._defaultZoomRate=W},ji.prototype.setWheelZoomRate=function(W){this._wheelZoomRate=W},ji.prototype.isEnabled=function(){return!!this._enabled},ji.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},ji.prototype.isZooming=function(){return!!this._zooming},ji.prototype.enable=function(W){this.isEnabled()||(this._enabled=!0,this._aroundCenter=W&&W.around==="center")},ji.prototype.disable=function(){!this.isEnabled()||(this._enabled=!1)},ji.prototype.wheel=function(W){if(!!this.isEnabled()){var pe=W.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?W.deltaY*40:W.deltaY,Q=e.browser.now(),de=Q-(this._lastWheelEventTime||0);this._lastWheelEventTime=Q,pe!==0&&pe%ss===0?this._type="wheel":pe!==0&&Math.abs(pe)<4?this._type="trackpad":de>400?(this._type=null,this._lastValue=pe,this._timeout=setTimeout(this._onTimeout,40,W)):this._type||(this._type=Math.abs(de*pe)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,pe+=this._lastValue)),W.shiftKey&&pe&&(pe=pe/4),this._type&&(this._lastWheelEvent=W,this._delta-=pe,this._active||this._start(W)),W.preventDefault()}},ji.prototype._onTimeout=function(W){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(W)},ji.prototype._start=function(W){if(!!this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var pe=n.mousePos(this._el,W);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(pe)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ji.prototype.renderFrame=function(){return this._onScrollFrame()},ji.prototype._onScrollFrame=function(){var W=this;if(!!this._frameId&&(this._frameId=null,!!this.isActive())){var pe=this._map.transform;if(this._delta!==0){var Q=this._type==="wheel"&&Math.abs(this._delta)>ss?this._wheelZoomRate:this._defaultZoomRate,de=qi/(1+Math.exp(-Math.abs(this._delta*Q)));this._delta<0&&de!==0&&(de=1/de);var Le=typeof this._targetZoom=="number"?pe.zoomScale(this._targetZoom):pe.scale;this._targetZoom=Math.min(pe.maxZoom,Math.max(pe.minZoom,pe.scaleZoom(Le*de))),this._type==="wheel"&&(this._startZoom=pe.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var ze=typeof this._targetZoom=="number"?this._targetZoom:pe.zoom,Ke=this._startZoom,ct=this._easing,Lt=!1,$t;if(this._type==="wheel"&&Ke&&ct){var cr=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),dr=ct(cr);$t=e.number(Ke,ze,dr),cr<1?this._frameId||(this._frameId=!0):Lt=!0}else $t=ze,Lt=!0;return this._active=!0,Lt&&(this._active=!1,this._finishTimeout=setTimeout(function(){W._zooming=!1,W._handler._triggerRenderFrame(),delete W._targetZoom,delete W._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Lt,zoomDelta:$t-pe.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ji.prototype._smoothOutEasing=function(W){var pe=e.ease;if(this._prevEase){var Q=this._prevEase,de=(e.browser.now()-Q.start)/Q.duration,Le=Q.easing(de+.01)-Q.easing(de),ze=.27/Math.sqrt(Le*Le+1e-4)*.01,Ke=Math.sqrt(.27*.27-ze*ze);pe=e.bezier(ze,Ke,.25,1)}return this._prevEase={start:e.browser.now(),duration:W,easing:pe},pe},ji.prototype.reset=function(){this._active=!1};var Ba=function(W,pe){this._clickZoom=W,this._tapZoom=pe};Ba.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ba.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ba.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ba.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Qa=function(){this.reset()};Qa.prototype.reset=function(){this._active=!1},Qa.prototype.dblclick=function(W,pe){return W.preventDefault(),{cameraAnimation:function(Q){Q.easeTo({duration:300,zoom:Q.getZoom()+(W.shiftKey?-1:1),around:Q.unproject(pe)},{originalEvent:W})}}},Qa.prototype.enable=function(){this._enabled=!0},Qa.prototype.disable=function(){this._enabled=!1,this.reset()},Qa.prototype.isEnabled=function(){return this._enabled},Qa.prototype.isActive=function(){return this._active};var Lo=function(){this._tap=new sn({numTouches:1,numTaps:1}),this.reset()};Lo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Lo.prototype.touchstart=function(W,pe,Q){this._swipePoint||(this._tapTime&&W.timeStamp-this._tapTime>fn&&this.reset(),this._tapTime?Q.length>0&&(this._swipePoint=pe[0],this._swipeTouch=Q[0].identifier):this._tap.touchstart(W,pe,Q))},Lo.prototype.touchmove=function(W,pe,Q){if(!this._tapTime)this._tap.touchmove(W,pe,Q);else if(this._swipePoint){if(Q[0].identifier!==this._swipeTouch)return;var de=pe[0],Le=de.y-this._swipePoint.y;return this._swipePoint=de,W.preventDefault(),this._active=!0,{zoomDelta:Le/128}}},Lo.prototype.touchend=function(W,pe,Q){if(this._tapTime)this._swipePoint&&Q.length===0&&this.reset();else{var de=this._tap.touchend(W,pe,Q);de&&(this._tapTime=W.timeStamp)}},Lo.prototype.touchcancel=function(){this.reset()},Lo.prototype.enable=function(){this._enabled=!0},Lo.prototype.disable=function(){this._enabled=!1,this.reset()},Lo.prototype.isEnabled=function(){return this._enabled},Lo.prototype.isActive=function(){return this._active};var fo=function(W,pe,Q){this._el=W,this._mousePan=pe,this._touchPan=Q};fo.prototype.enable=function(W){this._inertiaOptions=W||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},fo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},fo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},fo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Wo=function(W,pe,Q){this._pitchWithRotate=W.pitchWithRotate,this._mouseRotate=pe,this._mousePitch=Q};Wo.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Wo.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Wo.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Wo.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ro=function(W,pe,Q,de){this._el=W,this._touchZoom=pe,this._touchRotate=Q,this._tapDragZoom=de,this._rotationDisabled=!1,this._enabled=!0};ro.prototype.enable=function(W){this._touchZoom.enable(W),this._rotationDisabled||this._touchRotate.enable(W),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ro.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ro.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ro.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ro.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ro.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var us=function(ce){return ce.zoom||ce.drag||ce.pitch||ce.rotate},Ns=function(ce){function W(){ce.apply(this,arguments)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W}(e.Event);function vu(ce){return ce.panDelta&&ce.panDelta.mag()||ce.zoomDelta||ce.bearingDelta||ce.pitchDelta}var no=function(W,pe){this._map=W,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ve(W),this._bearingSnap=pe.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(pe),e.bindAll(["handleEvent","handleWindowEvent"],this);var Q=this._el;this._listeners=[[Q,"touchstart",{passive:!1}],[Q,"touchmove",{passive:!1}],[Q,"touchend",void 0],[Q,"touchcancel",void 0],[Q,"mousedown",void 0],[Q,"mousemove",void 0],[Q,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[Q,"mouseover",void 0],[Q,"mouseout",void 0],[Q,"dblclick",void 0],[Q,"click",void 0],[Q,"keydown",{capture:!1}],[Q,"keyup",void 0],[Q,"wheel",{passive:!1}],[Q,"contextmenu",void 0],[e.window,"blur",void 0]];for(var de=0,Le=this._listeners;de<Le.length;de+=1){var ze=Le[de],Ke=ze[0],ct=ze[1],Lt=ze[2];n.addEventListener(Ke,ct,Ke===e.window.document?this.handleWindowEvent:this.handleEvent,Lt)}};no.prototype.destroy=function(){for(var W=0,pe=this._listeners;W<pe.length;W+=1){var Q=pe[W],de=Q[0],Le=Q[1],ze=Q[2];n.removeEventListener(de,Le,de===e.window.document?this.handleWindowEvent:this.handleEvent,ze)}},no.prototype._addDefaultHandlers=function(W){var pe=this._map,Q=pe.getCanvasContainer();this._add("mapEvent",new Qt(pe,W));var de=pe.boxZoom=new rr(pe,W);this._add("boxZoom",de);var Le=new un,ze=new Qa;pe.doubleClickZoom=new Ba(ze,Le),this._add("tapZoom",Le),this._add("clickZoom",ze);var Ke=new Lo;this._add("tapDragZoom",Ke);var ct=pe.touchPitch=new ci;this._add("touchPitch",ct);var Lt=new sa(W),$t=new Da(W);pe.dragRotate=new Wo(W,Lt,$t),this._add("mouseRotate",Lt,["mousePitch"]),this._add("mousePitch",$t,["mouseRotate"]);var cr=new Aa(W),dr=new fa(W);pe.dragPan=new fo(Q,cr,dr),this._add("mousePan",cr),this._add("touchPan",dr,["touchZoom","touchRotate"]);var Lr=new li,Yr=new wo;pe.touchZoomRotate=new ro(Q,Yr,Lr,Ke),this._add("touchRotate",Lr,["touchPan","touchZoom"]),this._add("touchZoom",Yr,["touchPan","touchRotate"]);var Xr=pe.scrollZoom=new ji(pe,this);this._add("scrollZoom",Xr,["mousePan"]);var Gr=pe.keyboard=new so;this._add("keyboard",Gr),this._add("blockableMapEvent",new tr(pe));for(var $r=0,pn=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];$r<pn.length;$r+=1){var Ln=pn[$r];W.interactive&&W[Ln]&&pe[Ln].enable(W[Ln])}},no.prototype._add=function(W,pe,Q){this._handlers.push({handlerName:W,handler:pe,allowed:Q}),this._handlersById[W]=pe},no.prototype.stop=function(){if(!this._updatingCamera){for(var W=0,pe=this._handlers;W<pe.length;W+=1){var Q=pe[W],de=Q.handler;de.reset()}this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},no.prototype.isActive=function(){for(var W=0,pe=this._handlers;W<pe.length;W+=1){var Q=pe[W],de=Q.handler;if(de.isActive())return!0}return!1},no.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},no.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},no.prototype.isMoving=function(){return Boolean(us(this._eventsInProgress))||this.isZooming()},no.prototype._blockedByActive=function(W,pe,Q){for(var de in W)if(de!==Q&&(!pe||pe.indexOf(de)<0))return!0;return!1},no.prototype.handleWindowEvent=function(W){this.handleEvent(W,W.type+"Window")},no.prototype._getMapTouches=function(W){for(var pe=[],Q=0,de=W;Q<de.length;Q+=1){var Le=de[Q],ze=Le.target;this._el.contains(ze)&&pe.push(Le)}return pe},no.prototype.handleEvent=function(W,pe){if(W.type==="blur"){this.stop();return}this._updatingCamera=!0;for(var Q=W.type==="renderFrame"?void 0:W,de={needsRenderFrame:!1},Le={},ze={},Ke=W.touches?this._getMapTouches(W.touches):void 0,ct=Ke?n.touchPos(this._el,Ke):n.mousePos(this._el,W),Lt=0,$t=this._handlers;Lt<$t.length;Lt+=1){var cr=$t[Lt],dr=cr.handlerName,Lr=cr.handler,Yr=cr.allowed;if(!!Lr.isEnabled()){var Xr=void 0;this._blockedByActive(ze,Yr,dr)?Lr.reset():Lr[pe||W.type]&&(Xr=Lr[pe||W.type](W,ct,Ke),this.mergeHandlerResult(de,Le,Xr,dr,Q),Xr&&Xr.needsRenderFrame&&this._triggerRenderFrame()),(Xr||Lr.isActive())&&(ze[dr]=Lr)}}var Gr={};for(var $r in this._previousActiveHandlers)ze[$r]||(Gr[$r]=Q);this._previousActiveHandlers=ze,(Object.keys(Gr).length||vu(de))&&(this._changes.push([de,Le,Gr]),this._triggerRenderFrame()),(Object.keys(ze).length||vu(de))&&this._map._stop(!0),this._updatingCamera=!1;var pn=de.cameraAnimation;pn&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],pn(this._map))},no.prototype.mergeHandlerResult=function(W,pe,Q,de,Le){if(!!Q){e.extend(W,Q);var ze={handlerName:de,originalEvent:Q.originalEvent||Le};Q.zoomDelta!==void 0&&(pe.zoom=ze),Q.panDelta!==void 0&&(pe.drag=ze),Q.pitchDelta!==void 0&&(pe.pitch=ze),Q.bearingDelta!==void 0&&(pe.rotate=ze)}},no.prototype._applyChanges=function(){for(var W={},pe={},Q={},de=0,Le=this._changes;de<Le.length;de+=1){var ze=Le[de],Ke=ze[0],ct=ze[1],Lt=ze[2];Ke.panDelta&&(W.panDelta=(W.panDelta||new e.Point(0,0))._add(Ke.panDelta)),Ke.zoomDelta&&(W.zoomDelta=(W.zoomDelta||0)+Ke.zoomDelta),Ke.bearingDelta&&(W.bearingDelta=(W.bearingDelta||0)+Ke.bearingDelta),Ke.pitchDelta&&(W.pitchDelta=(W.pitchDelta||0)+Ke.pitchDelta),Ke.around!==void 0&&(W.around=Ke.around),Ke.pinchAround!==void 0&&(W.pinchAround=Ke.pinchAround),Ke.noInertia&&(W.noInertia=Ke.noInertia),e.extend(pe,ct),e.extend(Q,Lt)}this._updateMapTransform(W,pe,Q),this._changes=[]},no.prototype._updateMapTransform=function(W,pe,Q){var de=this._map,Le=de.transform;if(!vu(W))return this._fireEvents(pe,Q);var ze=W.panDelta,Ke=W.zoomDelta,ct=W.bearingDelta,Lt=W.pitchDelta,$t=W.around,cr=W.pinchAround;cr!==void 0&&($t=cr),de._stop(!0),$t=$t||de.transform.centerPoint;var dr=Le.pointLocation(ze?$t.sub(ze):$t);ct&&(Le.bearing+=ct),Lt&&(Le.pitch+=Lt),Ke&&(Le.zoom+=Ke),Le.setLocationAtPoint(dr,$t),this._map._update(),W.noInertia||this._inertia.record(W),this._fireEvents(pe,Q)},no.prototype._fireEvents=function(W,pe){var Q=this,de=us(this._eventsInProgress),Le=us(W),ze={};for(var Ke in W){var ct=W[Ke],Lt=ct.originalEvent;this._eventsInProgress[Ke]||(ze[Ke+"start"]=Lt),this._eventsInProgress[Ke]=W[Ke]}!de&&Le&&this._fireEvent("movestart",Le.originalEvent);for(var $t in ze)this._fireEvent($t,ze[$t]);W.rotate&&(this._bearingChanged=!0),Le&&this._fireEvent("move",Le.originalEvent);for(var cr in W){var dr=W[cr],Lr=dr.originalEvent;this._fireEvent(cr,Lr)}var Yr={},Xr;for(var Gr in this._eventsInProgress){var $r=this._eventsInProgress[Gr],pn=$r.handlerName,Ln=$r.originalEvent;this._handlersById[pn].isActive()||(delete this._eventsInProgress[Gr],Xr=pe[pn]||Ln,Yr[Gr+"end"]=Xr)}for(var Nn in Yr)this._fireEvent(Nn,Yr[Nn]);var Qn=us(this._eventsInProgress);if((de||Le)&&!Qn){this._updatingCamera=!0;var ta=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),qn=function(pa){return pa!==0&&-Q._bearingSnap<pa&&pa<Q._bearingSnap};ta?(qn(ta.bearing||this._map.getBearing())&&(ta.bearing=0),this._map.easeTo(ta,{originalEvent:Xr})):(this._map.fire(new e.Event("moveend",{originalEvent:Xr})),qn(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},no.prototype._fireEvent=function(W,pe){this._map.fire(new e.Event(W,pe?{originalEvent:pe}:{}))},no.prototype._triggerRenderFrame=function(){var W=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(pe){delete W._frameId,W.handleEvent(new Ns("renderFrame",{timeStamp:pe})),W._applyChanges()}))};var Hf=function(ce){function W(pe,Q){ce.call(this),this._moving=!1,this._zooming=!1,this.transform=pe,this._bearingSnap=Q.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},W.prototype.setCenter=function(Q,de){return this.jumpTo({center:Q},de)},W.prototype.panBy=function(Q,de,Le){return Q=e.Point.convert(Q).mult(-1),this.panTo(this.transform.center,e.extend({offset:Q},de),Le)},W.prototype.panTo=function(Q,de,Le){return this.easeTo(e.extend({center:Q},de),Le)},W.prototype.getZoom=function(){return this.transform.zoom},W.prototype.setZoom=function(Q,de){return this.jumpTo({zoom:Q},de),this},W.prototype.zoomTo=function(Q,de,Le){return this.easeTo(e.extend({zoom:Q},de),Le)},W.prototype.zoomIn=function(Q,de){return this.zoomTo(this.getZoom()+1,Q,de),this},W.prototype.zoomOut=function(Q,de){return this.zoomTo(this.getZoom()-1,Q,de),this},W.prototype.getBearing=function(){return this.transform.bearing},W.prototype.setBearing=function(Q,de){return this.jumpTo({bearing:Q},de),this},W.prototype.getPadding=function(){return this.transform.padding},W.prototype.setPadding=function(Q,de){return this.jumpTo({padding:Q},de),this},W.prototype.rotateTo=function(Q,de,Le){return this.easeTo(e.extend({bearing:Q},de),Le)},W.prototype.resetNorth=function(Q,de){return this.rotateTo(0,e.extend({duration:1e3},Q),de),this},W.prototype.resetNorthPitch=function(Q,de){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},Q),de),this},W.prototype.snapToNorth=function(Q,de){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(Q,de):this},W.prototype.getPitch=function(){return this.transform.pitch},W.prototype.setPitch=function(Q,de){return this.jumpTo({pitch:Q},de),this},W.prototype.cameraForBounds=function(Q,de){return Q=e.LngLatBounds.convert(Q),this._cameraForBoxAndBearing(Q.getNorthWest(),Q.getSouthEast(),0,de)},W.prototype._cameraForBoxAndBearing=function(Q,de,Le,ze){var Ke={top:0,bottom:0,right:0,left:0};if(ze=e.extend({padding:Ke,offset:[0,0],maxZoom:this.transform.maxZoom},ze),typeof ze.padding=="number"){var ct=ze.padding;ze.padding={top:ct,bottom:ct,right:ct,left:ct}}ze.padding=e.extend(Ke,ze.padding);var Lt=this.transform,$t=Lt.padding,cr=Lt.project(e.LngLat.convert(Q)),dr=Lt.project(e.LngLat.convert(de)),Lr=cr.rotate(-Le*Math.PI/180),Yr=dr.rotate(-Le*Math.PI/180),Xr=new e.Point(Math.max(Lr.x,Yr.x),Math.max(Lr.y,Yr.y)),Gr=new e.Point(Math.min(Lr.x,Yr.x),Math.min(Lr.y,Yr.y)),$r=Xr.sub(Gr),pn=(Lt.width-($t.left+$t.right+ze.padding.left+ze.padding.right))/$r.x,Ln=(Lt.height-($t.top+$t.bottom+ze.padding.top+ze.padding.bottom))/$r.y;if(Ln<0||pn<0){e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}var Nn=Math.min(Lt.scaleZoom(Lt.scale*Math.min(pn,Ln)),ze.maxZoom),Qn=e.Point.convert(ze.offset),ta=(ze.padding.left-ze.padding.right)/2,qn=(ze.padding.top-ze.padding.bottom)/2,pa=new e.Point(Qn.x+ta,Qn.y+qn),Ta=pa.mult(Lt.scale/Lt.zoomScale(Nn)),ba=Lt.unproject(cr.add(dr).div(2).sub(Ta));return{center:ba,zoom:Nn,bearing:Le}},W.prototype.fitBounds=function(Q,de,Le){return this._fitInternal(this.cameraForBounds(Q,de),de,Le)},W.prototype.fitScreenCoordinates=function(Q,de,Le,ze,Ke){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(Q)),this.transform.pointLocation(e.Point.convert(de)),Le,ze),ze,Ke)},W.prototype._fitInternal=function(Q,de,Le){return Q?(de=e.extend(Q,de),delete de.padding,de.linear?this.easeTo(de,Le):this.flyTo(de,Le)):this},W.prototype.jumpTo=function(Q,de){this.stop();var Le=this.transform,ze=!1,Ke=!1,ct=!1;return"zoom"in Q&&Le.zoom!==+Q.zoom&&(ze=!0,Le.zoom=+Q.zoom),Q.center!==void 0&&(Le.center=e.LngLat.convert(Q.center)),"bearing"in Q&&Le.bearing!==+Q.bearing&&(Ke=!0,Le.bearing=+Q.bearing),"pitch"in Q&&Le.pitch!==+Q.pitch&&(ct=!0,Le.pitch=+Q.pitch),Q.padding!=null&&!Le.isPaddingEqual(Q.padding)&&(Le.padding=Q.padding),this.fire(new e.Event("movestart",de)).fire(new e.Event("move",de)),ze&&this.fire(new e.Event("zoomstart",de)).fire(new e.Event("zoom",de)).fire(new e.Event("zoomend",de)),Ke&&this.fire(new e.Event("rotatestart",de)).fire(new e.Event("rotate",de)).fire(new e.Event("rotateend",de)),ct&&this.fire(new e.Event("pitchstart",de)).fire(new e.Event("pitch",de)).fire(new e.Event("pitchend",de)),this.fire(new e.Event("moveend",de))},W.prototype.easeTo=function(Q,de){var Le=this;this._stop(!1,Q.easeId),Q=e.extend({offset:[0,0],duration:500,easing:e.ease},Q),(Q.animate===!1||!Q.essential&&e.browser.prefersReducedMotion)&&(Q.duration=0);var ze=this.transform,Ke=this.getZoom(),ct=this.getBearing(),Lt=this.getPitch(),$t=this.getPadding(),cr="zoom"in Q?+Q.zoom:Ke,dr="bearing"in Q?this._normalizeBearing(Q.bearing,ct):ct,Lr="pitch"in Q?+Q.pitch:Lt,Yr="padding"in Q?Q.padding:ze.padding,Xr=e.Point.convert(Q.offset),Gr=ze.centerPoint.add(Xr),$r=ze.pointLocation(Gr),pn=e.LngLat.convert(Q.center||$r);this._normalizeCenter(pn);var Ln=ze.project($r),Nn=ze.project(pn).sub(Ln),Qn=ze.zoomScale(cr-Ke),ta,qn;Q.around&&(ta=e.LngLat.convert(Q.around),qn=ze.locationPoint(ta));var pa={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||cr!==Ke,this._rotating=this._rotating||ct!==dr,this._pitching=this._pitching||Lr!==Lt,this._padding=!ze.isPaddingEqual(Yr),this._easeId=Q.easeId,this._prepareEase(de,Q.noMoveStart,pa),clearTimeout(this._easeEndTimeoutID),this._ease(function(Ta){if(Le._zooming&&(ze.zoom=e.number(Ke,cr,Ta)),Le._rotating&&(ze.bearing=e.number(ct,dr,Ta)),Le._pitching&&(ze.pitch=e.number(Lt,Lr,Ta)),Le._padding&&(ze.interpolatePadding($t,Yr,Ta),Gr=ze.centerPoint.add(Xr)),ta)ze.setLocationAtPoint(ta,qn);else{var ba=ze.zoomScale(ze.zoom-Ke),Sa=cr>Ke?Math.min(2,Qn):Math.max(.5,Qn),Pa=Math.pow(Sa,1-Ta),Ya=ze.unproject(Ln.add(Nn.mult(Ta*Pa)).mult(ba));ze.setLocationAtPoint(ze.renderWorldCopies?Ya.wrap():Ya,Gr)}Le._fireMoveEvents(de)},function(Ta){Le._afterEase(de,Ta)},Q),this},W.prototype._prepareEase=function(Q,de,Le){Le===void 0&&(Le={}),this._moving=!0,!de&&!Le.moving&&this.fire(new e.Event("movestart",Q)),this._zooming&&!Le.zooming&&this.fire(new e.Event("zoomstart",Q)),this._rotating&&!Le.rotating&&this.fire(new e.Event("rotatestart",Q)),this._pitching&&!Le.pitching&&this.fire(new e.Event("pitchstart",Q))},W.prototype._fireMoveEvents=function(Q){this.fire(new e.Event("move",Q)),this._zooming&&this.fire(new e.Event("zoom",Q)),this._rotating&&this.fire(new e.Event("rotate",Q)),this._pitching&&this.fire(new e.Event("pitch",Q))},W.prototype._afterEase=function(Q,de){if(!(this._easeId&&de&&this._easeId===de)){delete this._easeId;var Le=this._zooming,ze=this._rotating,Ke=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,Le&&this.fire(new e.Event("zoomend",Q)),ze&&this.fire(new e.Event("rotateend",Q)),Ke&&this.fire(new e.Event("pitchend",Q)),this.fire(new e.Event("moveend",Q))}},W.prototype.flyTo=function(Q,de){var Le=this;if(!Q.essential&&e.browser.prefersReducedMotion){var ze=e.pick(Q,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ze,de)}this.stop(),Q=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},Q);var Ke=this.transform,ct=this.getZoom(),Lt=this.getBearing(),$t=this.getPitch(),cr=this.getPadding(),dr="zoom"in Q?e.clamp(+Q.zoom,Ke.minZoom,Ke.maxZoom):ct,Lr="bearing"in Q?this._normalizeBearing(Q.bearing,Lt):Lt,Yr="pitch"in Q?+Q.pitch:$t,Xr="padding"in Q?Q.padding:Ke.padding,Gr=Ke.zoomScale(dr-ct),$r=e.Point.convert(Q.offset),pn=Ke.centerPoint.add($r),Ln=Ke.pointLocation(pn),Nn=e.LngLat.convert(Q.center||Ln);this._normalizeCenter(Nn);var Qn=Ke.project(Ln),ta=Ke.project(Nn).sub(Qn),qn=Q.curve,pa=Math.max(Ke.width,Ke.height),Ta=pa/Gr,ba=ta.mag();if("minZoom"in Q){var Sa=e.clamp(Math.min(Q.minZoom,ct,dr),Ke.minZoom,Ke.maxZoom),Pa=pa/Ke.zoomScale(Sa-ct);qn=Math.sqrt(Pa/ba*2)}var Ya=qn*qn;function si(ui){var Di=(Ta*Ta-pa*pa+(ui?-1:1)*Ya*Ya*ba*ba)/(2*(ui?Ta:pa)*Ya*ba);return Math.log(Math.sqrt(Di*Di+1)-Di)}function Oi(ui){return(Math.exp(ui)-Math.exp(-ui))/2}function pi(ui){return(Math.exp(ui)+Math.exp(-ui))/2}function _i(ui){return Oi(ui)/pi(ui)}var Va=si(0),Ui=function(ui){return pi(Va)/pi(Va+qn*ui)},Yi=function(ui){return pa*((pi(Va)*_i(Va+qn*ui)-Oi(Va))/Ya)/ba},Ji=(si(1)-Va)/qn;if(Math.abs(ba)<1e-6||!isFinite(Ji)){if(Math.abs(pa-Ta)<1e-6)return this.easeTo(Q,de);var ki=Ta<pa?-1:1;Ji=Math.abs(Math.log(Ta/pa))/qn,Yi=function(){return 0},Ui=function(ui){return Math.exp(ki*qn*ui)}}if("duration"in Q)Q.duration=+Q.duration;else{var ao="screenSpeed"in Q?+Q.screenSpeed/qn:+Q.speed;Q.duration=1e3*Ji/ao}return Q.maxDuration&&Q.duration>Q.maxDuration&&(Q.duration=0),this._zooming=!0,this._rotating=Lt!==Lr,this._pitching=Yr!==$t,this._padding=!Ke.isPaddingEqual(Xr),this._prepareEase(de,!1),this._ease(function(ui){var Di=ui*Ji,Io=1/Ui(Di);Ke.zoom=ui===1?dr:ct+Ke.scaleZoom(Io),Le._rotating&&(Ke.bearing=e.number(Lt,Lr,ui)),Le._pitching&&(Ke.pitch=e.number($t,Yr,ui)),Le._padding&&(Ke.interpolatePadding(cr,Xr,ui),pn=Ke.centerPoint.add($r));var $o=ui===1?Nn:Ke.unproject(Qn.add(ta.mult(Yi(Di))).mult(Io));Ke.setLocationAtPoint(Ke.renderWorldCopies?$o.wrap():$o,pn),Le._fireMoveEvents(de)},function(){return Le._afterEase(de)},Q),this},W.prototype.isEasing=function(){return!!this._easeFrameId},W.prototype.stop=function(){return this._stop()},W.prototype._stop=function(Q,de){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var Le=this._onEaseEnd;delete this._onEaseEnd,Le.call(this,de)}if(!Q){var ze=this.handlers;ze&&ze.stop()}return this},W.prototype._ease=function(Q,de,Le){Le.animate===!1||Le.duration===0?(Q(1),de()):(this._easeStart=e.browser.now(),this._easeOptions=Le,this._onEaseFrame=Q,this._onEaseEnd=de,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},W.prototype._renderFrameCallback=function(){var Q=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(Q)),Q<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},W.prototype._normalizeBearing=function(Q,de){Q=e.wrap(Q,-180,180);var Le=Math.abs(Q-de);return Math.abs(Q-360-de)<Le&&(Q-=360),Math.abs(Q+360-de)<Le&&(Q+=360),Q},W.prototype._normalizeCenter=function(Q){var de=this.transform;if(!(!de.renderWorldCopies||de.lngRange)){var Le=Q.lng-de.center.lng;Q.lng+=Le>180?-360:Le<-180?360:0}},W}(e.Evented),Jl=function(W){W===void 0&&(W={}),this.options=W,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Jl.prototype.getDefaultPosition=function(){return"bottom-right"},Jl.prototype.onAdd=function(W){var pe=this.options&&this.options.compact;return this._map=W,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),pe&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),pe===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Jl.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Jl.prototype._updateEditLink=function(){var W=this._editLink;W||(W=this._editLink=this._container.querySelector(".mapbox-improve-map"));var pe=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(W){var Q=pe.reduce(function(de,Le,ze){return Le.value&&(de+=Le.key+"="+Le.value+(ze<pe.length-1?"&":"")),de},"?");W.href=e.config.FEEDBACK_URL+"/"+Q+(this._map._hash?this._map._hash.getHashString(!0):""),W.rel="noopener nofollow"}},Jl.prototype._updateData=function(W){W&&(W.sourceDataType==="metadata"||W.dataType==="style")&&(this._updateAttributions(),this._updateEditLink())},Jl.prototype._updateAttributions=function(){if(!!this._map.style){var W=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?W=W.concat(this.options.customAttribution.map(function(ct){return typeof ct!="string"?"":ct})):typeof this.options.customAttribution=="string"&&W.push(this.options.customAttribution)),this._map.style.stylesheet){var pe=this._map.style.stylesheet;this.styleOwner=pe.owner,this.styleId=pe.id}var Q=this._map.style.sourceCaches;for(var de in Q){var Le=Q[de];if(Le.used){var ze=Le.getSource();ze.attribution&&W.indexOf(ze.attribution)<0&&W.push(ze.attribution)}}W.sort(function(ct,Lt){return ct.length-Lt.length}),W=W.filter(function(ct,Lt){for(var $t=Lt+1;$t<W.length;$t++)if(W[$t].indexOf(ct)>=0)return!1;return!0});var Ke=W.join(" | ");Ke!==this._attribHTML&&(this._attribHTML=Ke,W.length?(this._innerContainer.innerHTML=Ke,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Jl.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Xi=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};Xi.prototype.onAdd=function(W){this._map=W,this._container=n.create("div","mapboxgl-ctrl");var pe=n.create("a","mapboxgl-ctrl-logo");return pe.target="_blank",pe.rel="noopener nofollow",pe.href="https://www.mapbox.com/",pe.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),pe.setAttribute("rel","noopener nofollow"),this._container.appendChild(pe),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Xi.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Xi.prototype.getDefaultPosition=function(){return"bottom-left"},Xi.prototype._updateLogo=function(W){(!W||W.sourceDataType==="metadata")&&(this._container.style.display=this._logoRequired()?"block":"none")},Xi.prototype._logoRequired=function(){if(!!this._map.style){var W=this._map.style.sourceCaches;for(var pe in W){var Q=W[pe].getSource();if(Q.mapbox_logo)return!0}return!1}},Xi.prototype._updateCompact=function(){var W=this._container.children;if(W.length){var pe=W[0];this._map.getCanvasContainer().offsetWidth<250?pe.classList.add("mapboxgl-compact"):pe.classList.remove("mapboxgl-compact")}};var Xo=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Xo.prototype.add=function(W){var pe=++this._id,Q=this._queue;return Q.push({callback:W,id:pe,cancelled:!1}),pe},Xo.prototype.remove=function(W){for(var pe=this._currentlyRunning,Q=pe?this._queue.concat(pe):this._queue,de=0,Le=Q;de<Le.length;de+=1){var ze=Le[de];if(ze.id===W){ze.cancelled=!0;return}}},Xo.prototype.run=function(W){W===void 0&&(W=0);var pe=this._currentlyRunning=this._queue;this._queue=[];for(var Q=0,de=pe;Q<de.length;Q+=1){var Le=de[Q];if(!Le.cancelled&&(Le.callback(W),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Xo.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Jv={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Tc=e.window.HTMLImageElement,uc=e.window.HTMLElement,bf=e.window.ImageBitmap,Gf=-2,Ac=22,nl=0,_f=60,hh={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:Gf,maxZoom:Ac,minPitch:nl,maxPitch:_f,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},vh=function(ce){function W(Q){var de=this;if(Q=e.extend({},hh,Q),Q.minZoom!=null&&Q.maxZoom!=null&&Q.minZoom>Q.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(Q.minPitch!=null&&Q.maxPitch!=null&&Q.minPitch>Q.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(Q.minPitch!=null&&Q.minPitch<nl)throw new Error("minPitch must be greater than or equal to "+nl);if(Q.maxPitch!=null&&Q.maxPitch>_f)throw new Error("maxPitch must be less than or equal to "+_f);var Le=new Ci(Q.minZoom,Q.maxZoom,Q.minPitch,Q.maxPitch,Q.renderWorldCopies);if(ce.call(this,Le,Q),this._interactive=Q.interactive,this._maxTileCacheSize=Q.maxTileCacheSize,this._failIfMajorPerformanceCaveat=Q.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=Q.preserveDrawingBuffer,this._antialias=Q.antialias,this._trackResize=Q.trackResize,this._bearingSnap=Q.bearingSnap,this._refreshExpiredTiles=Q.refreshExpiredTiles,this._fadeDuration=Q.fadeDuration,this._crossSourceCollisions=Q.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=Q.collectResourceTiming,this._renderTaskQueue=new Xo,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},Jv,Q.locale),this._requestManager=new e.RequestManager(Q.transformRequest,Q.accessToken),typeof Q.container=="string"){if(this._container=e.window.document.getElementById(Q.container),!this._container)throw new Error("Container '"+Q.container+"' not found.")}else if(Q.container instanceof uc)this._container=Q.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(Q.maxBounds&&this.setMaxBounds(Q.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return de._update(!1)}),this.on("moveend",function(){return de._update(!1)}),this.on("zoom",function(){return de._update(!0)}),typeof e.window<"u"&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new no(this,Q);var ze=typeof Q.hash=="string"&&Q.hash||void 0;this._hash=Q.hash&&new Eo(ze).addTo(this),(!this._hash||!this._hash._onHashChange())&&(this.jumpTo({center:Q.center,zoom:Q.zoom,bearing:Q.bearing,pitch:Q.pitch}),Q.bounds&&(this.resize(),this.fitBounds(Q.bounds,e.extend({},Q.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=Q.localIdeographFontFamily,Q.style&&this.setStyle(Q.style,{localIdeographFontFamily:Q.localIdeographFontFamily}),Q.attributionControl&&this.addControl(new Jl({customAttribution:Q.customAttribution})),this.addControl(new Xi,Q.logoPosition),this.on("style.load",function(){de.transform.unmodified&&de.jumpTo(de.style.stylesheet)}),this.on("data",function(Ke){de._update(Ke.dataType==="style"),de.fire(new e.Event(Ke.dataType+"data",Ke))}),this.on("dataloading",function(Ke){de.fire(new e.Event(Ke.dataType+"dataloading",Ke))})}ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W;var pe={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return W.prototype._getMapId=function(){return this._mapId},W.prototype.addControl=function(de,Le){if(Le===void 0&&de.getDefaultPosition&&(Le=de.getDefaultPosition()),Le===void 0&&(Le="top-right"),!de||!de.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var ze=de.onAdd(this);this._controls.push(de);var Ke=this._controlPositions[Le];return Le.indexOf("bottom")!==-1?Ke.insertBefore(ze,Ke.firstChild):Ke.appendChild(ze),this},W.prototype.removeControl=function(de){if(!de||!de.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var Le=this._controls.indexOf(de);return Le>-1&&this._controls.splice(Le,1),de.onRemove(this),this},W.prototype.resize=function(de){var Le=this._containerDimensions(),ze=Le[0],Ke=Le[1];this._resizeCanvas(ze,Ke),this.transform.resize(ze,Ke),this.painter.resize(ze,Ke);var ct=!this._moving;return ct&&(this.stop(),this.fire(new e.Event("movestart",de)).fire(new e.Event("move",de))),this.fire(new e.Event("resize",de)),ct&&this.fire(new e.Event("moveend",de)),this},W.prototype.getBounds=function(){return this.transform.getBounds()},W.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},W.prototype.setMaxBounds=function(de){return this.transform.setMaxBounds(e.LngLatBounds.convert(de)),this._update()},W.prototype.setMinZoom=function(de){if(de=de==null?Gf:de,de>=Gf&&de<=this.transform.maxZoom)return this.transform.minZoom=de,this._update(),this.getZoom()<de&&this.setZoom(de),this;throw new Error("minZoom must be between "+Gf+" and the current maxZoom, inclusive")},W.prototype.getMinZoom=function(){return this.transform.minZoom},W.prototype.setMaxZoom=function(de){if(de=de==null?Ac:de,de>=this.transform.minZoom)return this.transform.maxZoom=de,this._update(),this.getZoom()>de&&this.setZoom(de),this;throw new Error("maxZoom must be greater than the current minZoom")},W.prototype.getMaxZoom=function(){return this.transform.maxZoom},W.prototype.setMinPitch=function(de){if(de=de==null?nl:de,de<nl)throw new Error("minPitch must be greater than or equal to "+nl);if(de>=nl&&de<=this.transform.maxPitch)return this.transform.minPitch=de,this._update(),this.getPitch()<de&&this.setPitch(de),this;throw new Error("minPitch must be between "+nl+" and the current maxPitch, inclusive")},W.prototype.getMinPitch=function(){return this.transform.minPitch},W.prototype.setMaxPitch=function(de){if(de=de==null?_f:de,de>_f)throw new Error("maxPitch must be less than or equal to "+_f);if(de>=this.transform.minPitch)return this.transform.maxPitch=de,this._update(),this.getPitch()>de&&this.setPitch(de),this;throw new Error("maxPitch must be greater than the current minPitch")},W.prototype.getMaxPitch=function(){return this.transform.maxPitch},W.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},W.prototype.setRenderWorldCopies=function(de){return this.transform.renderWorldCopies=de,this._update()},W.prototype.project=function(de){return this.transform.locationPoint(e.LngLat.convert(de))},W.prototype.unproject=function(de){return this.transform.pointLocation(e.Point.convert(de))},W.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},W.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},W.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},W.prototype._createDelegatedListener=function(de,Le,ze){var Ke=this,ct;if(de==="mouseenter"||de==="mouseover"){var Lt=!1,$t=function(Gr){var $r=Ke.getLayer(Le)?Ke.queryRenderedFeatures(Gr.point,{layers:[Le]}):[];$r.length?Lt||(Lt=!0,ze.call(Ke,new _t(de,Ke,Gr.originalEvent,{features:$r}))):Lt=!1},cr=function(){Lt=!1};return{layer:Le,listener:ze,delegates:{mousemove:$t,mouseout:cr}}}else if(de==="mouseleave"||de==="mouseout"){var dr=!1,Lr=function(Gr){var $r=Ke.getLayer(Le)?Ke.queryRenderedFeatures(Gr.point,{layers:[Le]}):[];$r.length?dr=!0:dr&&(dr=!1,ze.call(Ke,new _t(de,Ke,Gr.originalEvent)))},Yr=function(Gr){dr&&(dr=!1,ze.call(Ke,new _t(de,Ke,Gr.originalEvent)))};return{layer:Le,listener:ze,delegates:{mousemove:Lr,mouseout:Yr}}}else{var Xr=function(Gr){var $r=Ke.getLayer(Le)?Ke.queryRenderedFeatures(Gr.point,{layers:[Le]}):[];$r.length&&(Gr.features=$r,ze.call(Ke,Gr),delete Gr.features)};return{layer:Le,listener:ze,delegates:(ct={},ct[de]=Xr,ct)}}},W.prototype.on=function(de,Le,ze){if(ze===void 0)return ce.prototype.on.call(this,de,Le);var Ke=this._createDelegatedListener(de,Le,ze);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[de]=this._delegatedListeners[de]||[],this._delegatedListeners[de].push(Ke);for(var ct in Ke.delegates)this.on(ct,Ke.delegates[ct]);return this},W.prototype.once=function(de,Le,ze){if(ze===void 0)return ce.prototype.once.call(this,de,Le);var Ke=this._createDelegatedListener(de,Le,ze);for(var ct in Ke.delegates)this.once(ct,Ke.delegates[ct]);return this},W.prototype.off=function(de,Le,ze){var Ke=this;if(ze===void 0)return ce.prototype.off.call(this,de,Le);var ct=function(Lt){for(var $t=Lt[de],cr=0;cr<$t.length;cr++){var dr=$t[cr];if(dr.layer===Le&&dr.listener===ze){for(var Lr in dr.delegates)Ke.off(Lr,dr.delegates[Lr]);return $t.splice(cr,1),Ke}}};return this._delegatedListeners&&this._delegatedListeners[de]&&ct(this._delegatedListeners),this},W.prototype.queryRenderedFeatures=function(de,Le){if(!this.style)return[];Le===void 0&&de!==void 0&&!(de instanceof e.Point)&&!Array.isArray(de)&&(Le=de,de=void 0),Le=Le||{},de=de||[[0,0],[this.transform.width,this.transform.height]];var ze;if(de instanceof e.Point||typeof de[0]=="number")ze=[e.Point.convert(de)];else{var Ke=e.Point.convert(de[0]),ct=e.Point.convert(de[1]);ze=[Ke,new e.Point(ct.x,Ke.y),ct,new e.Point(Ke.x,ct.y),Ke]}return this.style.queryRenderedFeatures(ze,Le,this.transform)},W.prototype.querySourceFeatures=function(de,Le){return this.style.querySourceFeatures(de,Le)},W.prototype.setStyle=function(de,Le){return Le=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},Le),Le.diff!==!1&&Le.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&de?(this._diffStyle(de,Le),this):(this._localIdeographFontFamily=Le.localIdeographFontFamily,this._updateStyle(de,Le))},W.prototype._getUIString=function(de){var Le=this._locale[de];if(Le==null)throw new Error("Missing UI string '"+de+"'");return Le},W.prototype._updateStyle=function(de,Le){if(this.style&&(this.style.setEventedParent(null),this.style._remove()),de)this.style=new vs(this,Le||{});else return delete this.style,this;return this.style.setEventedParent(this,{style:this.style}),typeof de=="string"?this.style.loadURL(de):this.style.loadJSON(de),this},W.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new vs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},W.prototype._diffStyle=function(de,Le){var ze=this;if(typeof de=="string"){var Ke=this._requestManager.normalizeStyleURL(de),ct=this._requestManager.transformRequest(Ke,e.ResourceType.Style);e.getJSON(ct,function(Lt,$t){Lt?ze.fire(new e.ErrorEvent(Lt)):$t&&ze._updateDiff($t,Le)})}else typeof de=="object"&&this._updateDiff(de,Le)},W.prototype._updateDiff=function(de,Le){try{this.style.setState(de)&&this._update(!0)}catch(ze){e.warnOnce("Unable to perform style diff: "+(ze.message||ze.error||ze)+".  Rebuilding the style from scratch."),this._updateStyle(de,Le)}},W.prototype.getStyle=function(){if(this.style)return this.style.serialize()},W.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},W.prototype.addSource=function(de,Le){return this._lazyInitEmptyStyle(),this.style.addSource(de,Le),this._update(!0)},W.prototype.isSourceLoaded=function(de){var Le=this.style&&this.style.sourceCaches[de];if(Le===void 0){this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+de+"'")));return}return Le.loaded()},W.prototype.areTilesLoaded=function(){var de=this.style&&this.style.sourceCaches;for(var Le in de){var ze=de[Le],Ke=ze._tiles;for(var ct in Ke){var Lt=Ke[ct];if(!(Lt.state==="loaded"||Lt.state==="errored"))return!1}}return!0},W.prototype.addSourceType=function(de,Le,ze){return this._lazyInitEmptyStyle(),this.style.addSourceType(de,Le,ze)},W.prototype.removeSource=function(de){return this.style.removeSource(de),this._update(!0)},W.prototype.getSource=function(de){return this.style.getSource(de)},W.prototype.addImage=function(de,Le,ze){ze===void 0&&(ze={});var Ke=ze.pixelRatio;Ke===void 0&&(Ke=1);var ct=ze.sdf;ct===void 0&&(ct=!1);var Lt=ze.stretchX,$t=ze.stretchY,cr=ze.content;this._lazyInitEmptyStyle();var dr=0;if(Le instanceof Tc||bf&&Le instanceof bf){var Lr=e.browser.getImageData(Le),Yr=Lr.width,Xr=Lr.height,Gr=Lr.data;this.style.addImage(de,{data:new e.RGBAImage({width:Yr,height:Xr},Gr),pixelRatio:Ke,stretchX:Lt,stretchY:$t,content:cr,sdf:ct,version:dr})}else{if(Le.width===void 0||Le.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var $r=Le.width,pn=Le.height,Ln=Le.data,Nn=Le;this.style.addImage(de,{data:new e.RGBAImage({width:$r,height:pn},new Uint8Array(Ln)),pixelRatio:Ke,stretchX:Lt,stretchY:$t,content:cr,sdf:ct,version:dr,userImage:Nn}),Nn.onAdd&&Nn.onAdd(this,de)}},W.prototype.updateImage=function(de,Le){var ze=this.style.getImage(de);if(!ze)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var Ke=Le instanceof Tc||bf&&Le instanceof bf?e.browser.getImageData(Le):Le,ct=Ke.width,Lt=Ke.height,$t=Ke.data;if(ct===void 0||Lt===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(ct!==ze.data.width||Lt!==ze.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var cr=!(Le instanceof Tc||bf&&Le instanceof bf);ze.data.replace($t,cr),this.style.updateImage(de,ze)},W.prototype.hasImage=function(de){return de?!!this.style.getImage(de):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},W.prototype.removeImage=function(de){this.style.removeImage(de)},W.prototype.loadImage=function(de,Le){e.getImage(this._requestManager.transformRequest(de,e.ResourceType.Image),Le)},W.prototype.listImages=function(){return this.style.listImages()},W.prototype.addLayer=function(de,Le){return this._lazyInitEmptyStyle(),this.style.addLayer(de,Le),this._update(!0)},W.prototype.moveLayer=function(de,Le){return this.style.moveLayer(de,Le),this._update(!0)},W.prototype.removeLayer=function(de){return this.style.removeLayer(de),this._update(!0)},W.prototype.getLayer=function(de){return this.style.getLayer(de)},W.prototype.setLayerZoomRange=function(de,Le,ze){return this.style.setLayerZoomRange(de,Le,ze),this._update(!0)},W.prototype.setFilter=function(de,Le,ze){return ze===void 0&&(ze={}),this.style.setFilter(de,Le,ze),this._update(!0)},W.prototype.getFilter=function(de){return this.style.getFilter(de)},W.prototype.setPaintProperty=function(de,Le,ze,Ke){return Ke===void 0&&(Ke={}),this.style.setPaintProperty(de,Le,ze,Ke),this._update(!0)},W.prototype.getPaintProperty=function(de,Le){return this.style.getPaintProperty(de,Le)},W.prototype.setLayoutProperty=function(de,Le,ze,Ke){return Ke===void 0&&(Ke={}),this.style.setLayoutProperty(de,Le,ze,Ke),this._update(!0)},W.prototype.getLayoutProperty=function(de,Le){return this.style.getLayoutProperty(de,Le)},W.prototype.setLight=function(de,Le){return Le===void 0&&(Le={}),this._lazyInitEmptyStyle(),this.style.setLight(de,Le),this._update(!0)},W.prototype.getLight=function(){return this.style.getLight()},W.prototype.setFeatureState=function(de,Le){return this.style.setFeatureState(de,Le),this._update()},W.prototype.removeFeatureState=function(de,Le){return this.style.removeFeatureState(de,Le),this._update()},W.prototype.getFeatureState=function(de){return this.style.getFeatureState(de)},W.prototype.getContainer=function(){return this._container},W.prototype.getCanvasContainer=function(){return this._canvasContainer},W.prototype.getCanvas=function(){return this._canvas},W.prototype._containerDimensions=function(){var de=0,Le=0;return this._container&&(de=this._container.clientWidth||400,Le=this._container.clientHeight||300),[de,Le]},W.prototype._detectMissingCSS=function(){var de=e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color");de!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},W.prototype._setupContainer=function(){var de=this._container;de.classList.add("mapboxgl-map");var Le=this._missingCSSCanary=n.create("div","mapboxgl-canary",de);Le.style.visibility="hidden",this._detectMissingCSS();var ze=this._canvasContainer=n.create("div","mapboxgl-canvas-container",de);this._interactive&&ze.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",ze),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var Ke=this._containerDimensions();this._resizeCanvas(Ke[0],Ke[1]);var ct=this._controlContainer=n.create("div","mapboxgl-control-container",de),Lt=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function($t){Lt[$t]=n.create("div","mapboxgl-ctrl-"+$t,ct)})},W.prototype._resizeCanvas=function(de,Le){var ze=e.browser.devicePixelRatio||1;this._canvas.width=ze*de,this._canvas.height=ze*Le,this._canvas.style.width=de+"px",this._canvas.style.height=Le+"px"},W.prototype._setupPainter=function(){var de=e.extend({},i.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),Le=this._canvas.getContext("webgl",de)||this._canvas.getContext("experimental-webgl",de);if(!Le){this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")));return}this.painter=new oi(Le,this.transform),e.webpSupported.testSupport(Le)},W.prototype._contextLost=function(de){de.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:de}))},W.prototype._contextRestored=function(de){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:de}))},W.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},W.prototype._update=function(de){return this.style?(this._styleDirty=this._styleDirty||de,this._sourcesDirty=!0,this.triggerRepaint(),this):this},W.prototype._requestRenderFrame=function(de){return this._update(),this._renderTaskQueue.add(de)},W.prototype._cancelRenderFrame=function(de){this._renderTaskQueue.remove(de)},W.prototype._render=function(de){var Le=this,ze,Ke=0,ct=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(ze=ct.createQueryEXT(),ct.beginQueryEXT(ct.TIME_ELAPSED_EXT,ze),Ke=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(de),!this._removed){var Lt=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var $t=this.transform.zoom,cr=e.browser.now();this.style.zoomHistory.update($t,cr);var dr=new e.EvaluationParameters($t,{now:cr,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Lr=dr.crossFadingFactor();(Lr!==1||Lr!==this._crossFadingFactor)&&(Lt=!0,this._crossFadingFactor=Lr),this.style.update(dr)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||Lt)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Yr=e.browser.now()-Ke;ct.endQueryEXT(ct.TIME_ELAPSED_EXT,ze),setTimeout(function(){var $r=ct.getQueryObjectEXT(ze,ct.QUERY_RESULT_EXT)/1e6;ct.deleteQueryEXT(ze),Le.fire(new e.Event("gpu-timing-frame",{cpuTime:Yr,gpuTime:$r}))},50)}if(this.listens("gpu-timing-layer")){var Xr=this.painter.collectGpuTimers();setTimeout(function(){var $r=Le.painter.queryGpuTimers(Xr);Le.fire(new e.Event("gpu-timing-layer",{layerTimes:$r}))},50)}var Gr=this._sourcesDirty||this._styleDirty||this._placementDirty;return Gr||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},W.prototype.remove=function(){this._hash&&this._hash.remove();for(var de=0,Le=this._controls;de<Le.length;de+=1){var ze=Le[de];ze.onRemove(this)}this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof e.window<"u"&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var Ke=this.painter.context.gl.getExtension("WEBGL_lose_context");Ke&&Ke.loseContext(),fc(this._canvasContainer),fc(this._controlContainer),fc(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},W.prototype.triggerRepaint=function(){var de=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(Le){de._frame=null,de._render(Le)}))},W.prototype._onWindowOnline=function(){this._update()},W.prototype._onWindowResize=function(de){this._trackResize&&this.resize({originalEvent:de})._update()},pe.showTileBoundaries.get=function(){return!!this._showTileBoundaries},pe.showTileBoundaries.set=function(Q){this._showTileBoundaries!==Q&&(this._showTileBoundaries=Q,this._update())},pe.showPadding.get=function(){return!!this._showPadding},pe.showPadding.set=function(Q){this._showPadding!==Q&&(this._showPadding=Q,this._update())},pe.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},pe.showCollisionBoxes.set=function(Q){this._showCollisionBoxes!==Q&&(this._showCollisionBoxes=Q,Q?this.style._generateCollisionBoxes():this._update())},pe.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},pe.showOverdrawInspector.set=function(Q){this._showOverdrawInspector!==Q&&(this._showOverdrawInspector=Q,this._update())},pe.repaint.get=function(){return!!this._repaint},pe.repaint.set=function(Q){this._repaint!==Q&&(this._repaint=Q,this.triggerRepaint())},pe.vertices.get=function(){return!!this._vertices},pe.vertices.set=function(Q){this._vertices=Q,this._update()},W.prototype._setCacheLimits=function(de,Le){e.setCacheLimits(de,Le)},pe.version.get=function(){return e.version},Object.defineProperties(W.prototype,pe),W}(Hf);function fc(ce){ce.parentNode&&ce.parentNode.removeChild(ce)}var Mc={showCompass:!0,showZoom:!0,visualizePitch:!1},Ju=function(W){var pe=this;this.options=e.extend({},Mc,W),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(Q){return Q.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(Q){return pe._map.zoomIn({},{originalEvent:Q})}),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(Q){return pe._map.zoomOut({},{originalEvent:Q})}),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(Q){pe.options.visualizePitch?pe._map.resetNorthPitch({},{originalEvent:Q}):pe._map.resetNorth({},{originalEvent:Q})}),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ju.prototype._updateZoomButtons=function(){var W=this._map.getZoom();this._zoomInButton.disabled=W===this._map.getMaxZoom(),this._zoomOutButton.disabled=W===this._map.getMinZoom()},Ju.prototype._rotateCompassArrow=function(){var W=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=W},Ju.prototype.onAdd=function(W){return this._map=W,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new _l(this._map,this._compass,this.options.visualizePitch)),this._container},Ju.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ju.prototype._createButton=function(W,pe){var Q=n.create("button",W,this._container);return Q.type="button",Q.addEventListener("click",pe),Q},Ju.prototype._setButtonTitle=function(W,pe){var Q=this._map._getUIString("NavigationControl."+pe);W.title=Q,W.setAttribute("aria-label",Q)};var _l=function(W,pe,Q){Q===void 0&&(Q=!1),this._clickTolerance=10,this.element=pe,this.mouseRotate=new sa({clickTolerance:W.dragRotate._mouseRotate._clickTolerance}),this.map=W,Q&&(this.mousePitch=new Da({clickTolerance:W.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener(pe,"mousedown",this.mousedown),n.addEventListener(pe,"touchstart",this.touchstart,{passive:!1}),n.addEventListener(pe,"touchmove",this.touchmove),n.addEventListener(pe,"touchend",this.touchend),n.addEventListener(pe,"touchcancel",this.reset)};_l.prototype.down=function(W,pe){this.mouseRotate.mousedown(W,pe),this.mousePitch&&this.mousePitch.mousedown(W,pe),n.disableDrag()},_l.prototype.move=function(W,pe){var Q=this.map,de=this.mouseRotate.mousemoveWindow(W,pe);if(de&&de.bearingDelta&&Q.setBearing(Q.getBearing()+de.bearingDelta),this.mousePitch){var Le=this.mousePitch.mousemoveWindow(W,pe);Le&&Le.pitchDelta&&Q.setPitch(Q.getPitch()+Le.pitchDelta)}},_l.prototype.off=function(){var W=this.element;n.removeEventListener(W,"mousedown",this.mousedown),n.removeEventListener(W,"touchstart",this.touchstart,{passive:!1}),n.removeEventListener(W,"touchmove",this.touchmove),n.removeEventListener(W,"touchend",this.touchend),n.removeEventListener(W,"touchcancel",this.reset),this.offTemp()},_l.prototype.offTemp=function(){n.enableDrag(),n.removeEventListener(e.window,"mousemove",this.mousemove),n.removeEventListener(e.window,"mouseup",this.mouseup)},_l.prototype.mousedown=function(W){this.down(e.extend({},W,{ctrlKey:!0,preventDefault:function(){return W.preventDefault()}}),n.mousePos(this.element,W)),n.addEventListener(e.window,"mousemove",this.mousemove),n.addEventListener(e.window,"mouseup",this.mouseup)},_l.prototype.mousemove=function(W){this.move(W,n.mousePos(this.element,W))},_l.prototype.mouseup=function(W){this.mouseRotate.mouseupWindow(W),this.mousePitch&&this.mousePitch.mouseupWindow(W),this.offTemp()},_l.prototype.touchstart=function(W){W.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=n.touchPos(this.element,W.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return W.preventDefault()}},this._startPos))},_l.prototype.touchmove=function(W){W.targetTouches.length!==1?this.reset():(this._lastPos=n.touchPos(this.element,W.targetTouches)[0],this.move({preventDefault:function(){return W.preventDefault()}},this._lastPos))},_l.prototype.touchend=function(W){W.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},_l.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};function Ku(ce,W,pe){if(ce=new e.LngLat(ce.lng,ce.lat),W){var Q=new e.LngLat(ce.lng-360,ce.lat),de=new e.LngLat(ce.lng+360,ce.lat),Le=pe.locationPoint(ce).distSqr(W);pe.locationPoint(Q).distSqr(W)<Le?ce=Q:pe.locationPoint(de).distSqr(W)<Le&&(ce=de)}for(;Math.abs(ce.lng-pe.center.lng)>180;){var ze=pe.locationPoint(ce);if(ze.x>=0&&ze.y>=0&&ze.x<=pe.width&&ze.y<=pe.height)break;ce.lng>pe.center.lng?ce.lng-=360:ce.lng+=360}return ce}var cc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Sc(ce,W,pe){var Q=ce.classList;for(var de in cc)Q.remove("mapboxgl-"+pe+"-anchor-"+de);Q.add("mapboxgl-"+pe+"-anchor-"+W)}var Yf=function(ce){function W(pe,Q){var de=this;if(ce.call(this),(pe instanceof e.window.HTMLElement||Q)&&(pe=e.extend({element:pe},Q)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=pe&&pe.anchor||"center",this._color=pe&&pe.color||"#3FB1CE",this._draggable=pe&&pe.draggable||!1,this._state="inactive",this._rotation=pe&&pe.rotation||0,this._rotationAlignment=pe&&pe.rotationAlignment||"auto",this._pitchAlignment=pe&&pe.pitchAlignment&&pe.pitchAlignment!=="auto"?pe.pitchAlignment:this._rotationAlignment,!pe||!pe.element){this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var Le=n.createNS("http://www.w3.org/2000/svg","svg");Le.setAttributeNS(null,"display","block"),Le.setAttributeNS(null,"height","41px"),Le.setAttributeNS(null,"width","27px"),Le.setAttributeNS(null,"viewBox","0 0 27 41");var ze=n.createNS("http://www.w3.org/2000/svg","g");ze.setAttributeNS(null,"stroke","none"),ze.setAttributeNS(null,"stroke-width","1"),ze.setAttributeNS(null,"fill","none"),ze.setAttributeNS(null,"fill-rule","evenodd");var Ke=n.createNS("http://www.w3.org/2000/svg","g");Ke.setAttributeNS(null,"fill-rule","nonzero");var ct=n.createNS("http://www.w3.org/2000/svg","g");ct.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ct.setAttributeNS(null,"fill","#000000");for(var Lt=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}],$t=0,cr=Lt;$t<cr.length;$t+=1){var dr=cr[$t],Lr=n.createNS("http://www.w3.org/2000/svg","ellipse");Lr.setAttributeNS(null,"opacity","0.04"),Lr.setAttributeNS(null,"cx","10.5"),Lr.setAttributeNS(null,"cy","5.80029008"),Lr.setAttributeNS(null,"rx",dr.rx),Lr.setAttributeNS(null,"ry",dr.ry),ct.appendChild(Lr)}var Yr=n.createNS("http://www.w3.org/2000/svg","g");Yr.setAttributeNS(null,"fill",this._color);var Xr=n.createNS("http://www.w3.org/2000/svg","path");Xr.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Yr.appendChild(Xr);var Gr=n.createNS("http://www.w3.org/2000/svg","g");Gr.setAttributeNS(null,"opacity","0.25"),Gr.setAttributeNS(null,"fill","#000000");var $r=n.createNS("http://www.w3.org/2000/svg","path");$r.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Gr.appendChild($r);var pn=n.createNS("http://www.w3.org/2000/svg","g");pn.setAttributeNS(null,"transform","translate(6.0, 7.0)"),pn.setAttributeNS(null,"fill","#FFFFFF");var Ln=n.createNS("http://www.w3.org/2000/svg","g");Ln.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Nn=n.createNS("http://www.w3.org/2000/svg","circle");Nn.setAttributeNS(null,"fill","#000000"),Nn.setAttributeNS(null,"opacity","0.25"),Nn.setAttributeNS(null,"cx","5.5"),Nn.setAttributeNS(null,"cy","5.5"),Nn.setAttributeNS(null,"r","5.4999962");var Qn=n.createNS("http://www.w3.org/2000/svg","circle");Qn.setAttributeNS(null,"fill","#FFFFFF"),Qn.setAttributeNS(null,"cx","5.5"),Qn.setAttributeNS(null,"cy","5.5"),Qn.setAttributeNS(null,"r","5.4999962"),Ln.appendChild(Nn),Ln.appendChild(Qn),Ke.appendChild(ct),Ke.appendChild(Yr),Ke.appendChild(Gr),Ke.appendChild(pn),Ke.appendChild(Ln),Le.appendChild(Ke),this._element.appendChild(Le),this._offset=e.Point.convert(pe&&pe.offset||[0,-14])}else this._element=pe.element,this._offset=e.Point.convert(pe&&pe.offset||[0,0]);this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(ta){ta.preventDefault()}),this._element.addEventListener("mousedown",function(ta){ta.preventDefault()}),this._element.addEventListener("focus",function(){var ta=de._map.getContainer();ta.scrollTop=0,ta.scrollLeft=0}),Sc(this._element,this._anchor,"marker"),this._popup=null}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.addTo=function(Q){return this.remove(),this._map=Q,Q.getCanvasContainer().appendChild(this._element),Q.on("move",this._update),Q.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},W.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},W.prototype.getLngLat=function(){return this._lngLat},W.prototype.setLngLat=function(Q){return this._lngLat=e.LngLat.convert(Q),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},W.prototype.getElement=function(){return this._element},W.prototype.setPopup=function(Q){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),Q){if(!("offset"in Q.options)){var de=38.1,Le=13.5,ze=Math.sqrt(Math.pow(Le,2)/2);Q.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-de],"bottom-left":[ze,(de-Le+ze)*-1],"bottom-right":[-ze,(de-Le+ze)*-1],left:[Le,(de-Le)*-1],right:[-Le,(de-Le)*-1]}:this._offset}this._popup=Q,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},W.prototype._onKeyPress=function(Q){var de=Q.code,Le=Q.charCode||Q.keyCode;(de==="Space"||de==="Enter"||Le===32||Le===13)&&this.togglePopup()},W.prototype._onMapClick=function(Q){var de=Q.originalEvent.target,Le=this._element;this._popup&&(de===Le||Le.contains(de))&&this.togglePopup()},W.prototype.getPopup=function(){return this._popup},W.prototype.togglePopup=function(){var Q=this._popup;if(Q)Q.isOpen()?Q.remove():Q.addTo(this._map);else return this;return this},W.prototype._update=function(Q){if(!!this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Ku(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var de="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?de="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(de="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var Le="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?Le="rotateX(0deg)":this._pitchAlignment==="map"&&(Le="rotateX("+this._map.getPitch()+"deg)"),(!Q||Q.type==="moveend")&&(this._pos=this._pos.round()),n.setTransform(this._element,cc[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+Le+" "+de)}},W.prototype.getOffset=function(){return this._offset},W.prototype.setOffset=function(Q){return this._offset=e.Point.convert(Q),this._update(),this},W.prototype._onMove=function(Q){this._pos=Q.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},W.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},W.prototype._addDragHandler=function(Q){this._element.contains(Q.originalEvent.target)&&(Q.preventDefault(),this._positionDelta=Q.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},W.prototype.setDraggable=function(Q){return this._draggable=!!Q,this._map&&(Q?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},W.prototype.isDraggable=function(){return this._draggable},W.prototype.setRotation=function(Q){return this._rotation=Q||0,this._update(),this},W.prototype.getRotation=function(){return this._rotation},W.prototype.setRotationAlignment=function(Q){return this._rotationAlignment=Q||"auto",this._update(),this},W.prototype.getRotationAlignment=function(){return this._rotationAlignment},W.prototype.setPitchAlignment=function(Q){return this._pitchAlignment=Q&&Q!=="auto"?Q:this._rotationAlignment,this._update(),this},W.prototype.getPitchAlignment=function(){return this._pitchAlignment},W}(e.Evented),ph={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},wf;function hc(ce){wf!==void 0?ce(wf):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(W){wf=W.state!=="denied",ce(wf)}):(wf=!!e.window.navigator.geolocation,ce(wf))}var Wf=0,Tf=!1,dh=function(ce){function W(pe){ce.call(this),this.options=e.extend({},ph,pe),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.onAdd=function(Q){return this._map=Q,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),hc(this._setupUI),this._container},W.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Wf=0,Tf=!1},W.prototype._isOutOfMapMaxBounds=function(Q){var de=this._map.getMaxBounds(),Le=Q.coords;return de&&(Le.longitude<de.getWest()||Le.longitude>de.getEast()||Le.latitude<de.getSouth()||Le.latitude>de.getNorth())},W.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break}},W.prototype._onSuccess=function(Q){if(!!this._map){if(this._isOutOfMapMaxBounds(Q)){this._setErrorState(),this.fire(new e.Event("outofmaxbounds",Q)),this._updateMarker(),this._finish();return}if(this.options.trackUserLocation)switch(this._lastKnownPosition=Q,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(Q),(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK")&&this._updateCamera(Q),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",Q)),this._finish()}},W.prototype._updateCamera=function(Q){var de=new e.LngLat(Q.coords.longitude,Q.coords.latitude),Le=Q.coords.accuracy,ze=this._map.getBearing(),Ke=e.extend({bearing:ze},this.options.fitBoundsOptions);this._map.fitBounds(de.toBounds(Le),Ke,{geolocateSource:!0})},W.prototype._updateMarker=function(Q){if(Q){var de=new e.LngLat(Q.coords.longitude,Q.coords.latitude);this._accuracyCircleMarker.setLngLat(de).addTo(this._map),this._userLocationDotMarker.setLngLat(de).addTo(this._map),this._accuracy=Q.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},W.prototype._updateCircleRadius=function(){var Q=this._map._container.clientHeight/2,de=this._map.unproject([0,Q]),Le=this._map.unproject([1,Q]),ze=de.distanceTo(Le),Ke=Math.ceil(2*this._accuracy/ze);this._circleElement.style.width=Ke+"px",this._circleElement.style.height=Ke+"px"},W.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},W.prototype._onError=function(Q){if(!!this._map){if(this.options.trackUserLocation)if(Q.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var de=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=de,this._geolocateButton.setAttribute("aria-label",de),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(Q.code===3&&Tf)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",Q)),this._finish()}},W.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},W.prototype._setupUI=function(Q){var de=this;if(this._container.addEventListener("contextmenu",function(Ke){return Ke.preventDefault()}),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",Q===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var Le=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=Le,this._geolocateButton.setAttribute("aria-label",Le)}else{var ze=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=ze,this._geolocateButton.setAttribute("aria-label",ze)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Yf(this._dotElement),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Yf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(Ke){var ct=Ke.originalEvent&&Ke.originalEvent.type==="resize";!Ke.geolocateSource&&de._watchState==="ACTIVE_LOCK"&&!ct&&(de._watchState="BACKGROUND",de._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),de._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),de.fire(new e.Event("trackuserlocationend")))})},W.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Wf--,Tf=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"));break}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");break}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Wf++;var Q;Wf>1?(Q={maximumAge:6e5,timeout:0},Tf=!0):(Q=this.options.positionOptions,Tf=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,Q)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},W.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},W}(e.Evented),Hh={maxWidth:100,unit:"metric"},Af=function(W){this.options=e.extend({},Hh,W),e.bindAll(["_onMove","setUnit"],this)};Af.prototype.getDefaultPosition=function(){return"bottom-left"},Af.prototype._onMove=function(){gh(this._map,this._container,this.options)},Af.prototype.onAdd=function(W){return this._map=W,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",W.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Af.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Af.prototype.setUnit=function(W){this.options.unit=W,gh(this._map,this._container,this.options)};function gh(ce,W,pe){var Q=pe&&pe.maxWidth||100,de=ce._container.clientHeight/2,Le=ce.unproject([0,de]),ze=ce.unproject([Q,de]),Ke=Le.distanceTo(ze);if(pe&&pe.unit==="imperial"){var ct=3.2808*Ke;if(ct>5280){var Lt=ct/5280;Xf(W,Q,Lt,ce._getUIString("ScaleControl.Miles"))}else Xf(W,Q,ct,ce._getUIString("ScaleControl.Feet"))}else if(pe&&pe.unit==="nautical"){var $t=Ke/1852;Xf(W,Q,$t,ce._getUIString("ScaleControl.NauticalMiles"))}else Ke>=1e3?Xf(W,Q,Ke/1e3,ce._getUIString("ScaleControl.Kilometers")):Xf(W,Q,Ke,ce._getUIString("ScaleControl.Meters"))}function Xf(ce,W,pe,Q){var de=Yh(pe),Le=de/pe;ce.style.width=W*Le+"px",ce.innerHTML=de+"&nbsp;"+Q}function Gh(ce){var W=Math.pow(10,Math.ceil(-Math.log(ce)/Math.LN10));return Math.round(ce*W)/W}function Yh(ce){var W=Math.pow(10,(""+Math.floor(ce)).length-1),pe=ce/W;return pe=pe>=10?10:pe>=5?5:pe>=3?3:pe>=2?2:pe>=1?1:Gh(pe),W*pe}var pu=function(W){this._fullscreen=!1,W&&W.container&&(W.container instanceof e.window.HTMLElement?this._container=W.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};pu.prototype.onAdd=function(W){return this._map=W,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},pu.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},pu.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},pu.prototype._setupUI=function(){var W=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",W).setAttribute("aria-hidden",!0),W.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},pu.prototype._updateTitle=function(){var W=this._getTitle();this._fullscreenButton.setAttribute("aria-label",W),this._fullscreenButton.title=W},pu.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},pu.prototype._isFullscreen=function(){return this._fullscreen},pu.prototype._changeIcon=function(){var W=e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement;W===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},pu.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Wh={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Xh=function(ce){function W(pe){ce.call(this),this.options=e.extend(Object.create(Wh),pe),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return ce&&(W.__proto__=ce),W.prototype=Object.create(ce&&ce.prototype),W.prototype.constructor=W,W.prototype.addTo=function(Q){return this._map&&this.remove(),this._map=Q,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},W.prototype.isOpen=function(){return!!this._map},W.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},W.prototype.getLngLat=function(){return this._lngLat},W.prototype.setLngLat=function(Q){return this._lngLat=e.LngLat.convert(Q),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},W.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},W.prototype.getElement=function(){return this._container},W.prototype.setText=function(Q){return this.setDOMContent(e.window.document.createTextNode(Q))},W.prototype.setHTML=function(Q){var de=e.window.document.createDocumentFragment(),Le=e.window.document.createElement("body"),ze;for(Le.innerHTML=Q;ze=Le.firstChild,!!ze;)de.appendChild(ze);return this.setDOMContent(de)},W.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},W.prototype.setMaxWidth=function(Q){return this.options.maxWidth=Q,this._update(),this},W.prototype.setDOMContent=function(Q){return this._createContent(),this._content.appendChild(Q),this._update(),this},W.prototype.addClassName=function(Q){this._container&&this._container.classList.add(Q)},W.prototype.removeClassName=function(Q){this._container&&this._container.classList.remove(Q)},W.prototype.toggleClassName=function(Q){if(this._container)return this._container.classList.toggle(Q)},W.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},W.prototype._onMouseUp=function(Q){this._update(Q.point)},W.prototype._onMouseMove=function(Q){this._update(Q.point)},W.prototype._onDrag=function(Q){this._update(Q.point)},W.prototype._update=function(Q){var de=this,Le=this._lngLat||this._trackPointer;if(!(!this._map||!Le||!this._content)&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Lr){return de._container.classList.add(Lr)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ku(this._lngLat,this._pos,this._map.transform)),!(this._trackPointer&&!Q))){var ze=this._pos=this._trackPointer&&Q?Q:this._map.project(this._lngLat),Ke=this.options.anchor,ct=yh(this.options.offset);if(!Ke){var Lt=this._container.offsetWidth,$t=this._container.offsetHeight,cr;ze.y+ct.bottom.y<$t?cr=["top"]:ze.y>this._map.transform.height-$t?cr=["bottom"]:cr=[],ze.x<Lt/2?cr.push("left"):ze.x>this._map.transform.width-Lt/2&&cr.push("right"),cr.length===0?Ke="bottom":Ke=cr.join("-")}var dr=ze.add(ct[Ke]).round();n.setTransform(this._container,cc[Ke]+" translate("+dr.x+"px,"+dr.y+"px)"),Sc(this._container,Ke,"popup")}},W.prototype._onClose=function(){this.remove()},W}(e.Evented);function yh(ce){if(ce)if(typeof ce=="number"){var W=Math.round(Math.sqrt(.5*Math.pow(ce,2)));return{center:new e.Point(0,0),top:new e.Point(0,ce),"top-left":new e.Point(W,W),"top-right":new e.Point(-W,W),bottom:new e.Point(0,-ce),"bottom-left":new e.Point(W,-W),"bottom-right":new e.Point(-W,-W),left:new e.Point(ce,0),right:new e.Point(-ce,0)}}else if(ce instanceof e.Point||Array.isArray(ce)){var pe=e.Point.convert(ce);return{center:pe,top:pe,"top-left":pe,"top-right":pe,bottom:pe,"bottom-left":pe,"bottom-right":pe,left:pe,right:pe}}else return{center:e.Point.convert(ce.center||[0,0]),top:e.Point.convert(ce.top||[0,0]),"top-left":e.Point.convert(ce["top-left"]||[0,0]),"top-right":e.Point.convert(ce["top-right"]||[0,0]),bottom:e.Point.convert(ce.bottom||[0,0]),"bottom-left":e.Point.convert(ce["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(ce["bottom-right"]||[0,0]),left:e.Point.convert(ce.left||[0,0]),right:e.Point.convert(ce.right||[0,0])};else return yh(new e.Point(0,0))}var Zh={version:e.version,supported:i,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:vh,NavigationControl:Ju,GeolocateControl:dh,AttributionControl:Jl,ScaleControl:Af,FullscreenControl:pu,Popup:Xh,Marker:Yf,Style:vs,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:ar,clearPrewarmedResources:kr,get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(ce){e.config.ACCESS_TOKEN=ce},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(ce){e.config.API_URL=ce},get workerCount(){return Et.workerCount},set workerCount(ce){Et.workerCount=ce},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(ce){e.config.MAX_PARALLEL_IMAGE_REQUESTS=ce},clearStorage:function(W){e.clearTileCache(W)},workerUrl:""};return Zh}),A})},{}],240:[function(t,P,R){P.exports=Math.log2||function(h){return Math.log(h)*Math.LOG2E}},{}],241:[function(t,P,R){P.exports=u;var h=t("mouse-event");function u(A,T){T||(T=A,A=window);var e=0,i=0,n=0,a={shift:!1,alt:!1,control:!1,meta:!1},r=!1;function f(M){var _=!1;return"altKey"in M&&(_=_||M.altKey!==a.alt,a.alt=!!M.altKey),"shiftKey"in M&&(_=_||M.shiftKey!==a.shift,a.shift=!!M.shiftKey),"ctrlKey"in M&&(_=_||M.ctrlKey!==a.control,a.control=!!M.ctrlKey),"metaKey"in M&&(_=_||M.metaKey!==a.meta,a.meta=!!M.metaKey),_}function o(M,_){var y=h.x(_),w=h.y(_);"buttons"in _&&(M=_.buttons|0),(M!==e||y!==i||w!==n||f(_))&&(e=M|0,i=y||0,n=w||0,T&&T(e,i,n,a))}function s(M){o(0,M)}function m(){(e||i||n||a.shift||a.alt||a.meta||a.control)&&(i=n=0,e=0,a.shift=a.alt=a.control=a.meta=!1,T&&T(0,0,0,a))}function g(M){f(M)&&T&&T(e,i,n,a)}function p(M){h.buttons(M)===0?o(0,M):o(e,M)}function v(M){o(e|h.buttons(M),M)}function x(M){o(e&~h.buttons(M),M)}function l(){r||(r=!0,A.addEventListener("mousemove",p),A.addEventListener("mousedown",v),A.addEventListener("mouseup",x),A.addEventListener("mouseleave",s),A.addEventListener("mouseenter",s),A.addEventListener("mouseout",s),A.addEventListener("mouseover",s),A.addEventListener("blur",m),A.addEventListener("keyup",g),A.addEventListener("keydown",g),A.addEventListener("keypress",g),A!==window&&(window.addEventListener("blur",m),window.addEventListener("keyup",g),window.addEventListener("keydown",g),window.addEventListener("keypress",g)))}function b(){!r||(r=!1,A.removeEventListener("mousemove",p),A.removeEventListener("mousedown",v),A.removeEventListener("mouseup",x),A.removeEventListener("mouseleave",s),A.removeEventListener("mouseenter",s),A.removeEventListener("mouseout",s),A.removeEventListener("mouseover",s),A.removeEventListener("blur",m),A.removeEventListener("keyup",g),A.removeEventListener("keydown",g),A.removeEventListener("keypress",g),A!==window&&(window.removeEventListener("blur",m),window.removeEventListener("keyup",g),window.removeEventListener("keydown",g),window.removeEventListener("keypress",g)))}l();var c={element:A};return Object.defineProperties(c,{enabled:{get:function(){return r},set:function(M){M?l():b()},enumerable:!0},buttons:{get:function(){return e},enumerable:!0},x:{get:function(){return i},enumerable:!0},y:{get:function(){return n},enumerable:!0},mods:{get:function(){return a},enumerable:!0}}),c}},{"mouse-event":243}],242:[function(t,P,R){var h={left:0,top:0};P.exports=u;function u(T,e,i){e=e||T.currentTarget||T.srcElement,Array.isArray(i)||(i=[0,0]);var n=T.clientX||0,a=T.clientY||0,r=A(e);return i[0]=n-r.left,i[1]=a-r.top,i}function A(T){return T===window||T===document||T===document.body?h:T.getBoundingClientRect()}},{}],243:[function(t,P,R){function h(e){if(typeof e=="object"){if("buttons"in e)return e.buttons;if("which"in e){var i=e.which;if(i===2)return 4;if(i===3)return 2;if(i>0)return 1<<i-1}else if("button"in e){var i=e.button;if(i===1)return 4;if(i===2)return 2;if(i>=0)return 1<<i}}return 0}R.buttons=h;function u(e){return e.target||e.srcElement||window}R.element=u;function A(e){if(typeof e=="object"){if("offsetX"in e)return e.offsetX;var i=u(e),n=i.getBoundingClientRect();return e.clientX-n.left}return 0}R.x=A;function T(e){if(typeof e=="object"){if("offsetY"in e)return e.offsetY;var i=u(e),n=i.getBoundingClientRect();return e.clientY-n.top}return 0}R.y=T},{}],244:[function(t,P,R){var h=t("to-px");P.exports=u;function u(A,T,e){typeof A=="function"&&(e=!!T,T=A,A=window);var i=h("ex",A),n=function(a){e&&a.preventDefault();var r=a.deltaX||0,f=a.deltaY||0,o=a.deltaZ||0,s=a.deltaMode,m=1;switch(s){case 1:m=i;break;case 2:m=window.innerHeight;break}if(r*=m,f*=m,o*=m,r||f||o)return T(r,f,o,a)};return A.addEventListener("wheel",n),n}},{"to-px":315}],245:[function(t,P,R){(function(h,u){(function(){/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/(function(T,e,i){e[T]=e[T]||i(),typeof P<"u"&&P.exports&&(P.exports=e[T])})("Promise",typeof h<"u"?h:this,function(){var T,e,i,n=Object.prototype.toString,a=typeof u<"u"?function(M){return u(M)}:setTimeout;try{Object.defineProperty({},"x",{}),T=function(M,_,y,w){return Object.defineProperty(M,_,{value:y,writable:!0,configurable:w!==!1})}}catch{T=function(_,y,w){return _[y]=w,_}}i=function(){var M,_,y;function w(d,C){this.fn=d,this.self=C,this.next=void 0}return{add:function(C,S){y=new w(C,S),_?_.next=y:M=y,_=y,y=void 0},drain:function(){var C=M;for(M=_=e=void 0;C;)C.fn.call(C.self),C=C.next}}}();function r(c,M){i.add(c,M),e||(e=a(i.drain))}function f(c){var M,_=typeof c;return c!=null&&(_=="object"||_=="function")&&(M=c.then),typeof M=="function"?M:!1}function o(){for(var c=0;c<this.chain.length;c++)s(this,this.state===1?this.chain[c].success:this.chain[c].failure,this.chain[c]);this.chain.length=0}function s(c,M,_){var y,w;try{M===!1?_.reject(c.msg):(M===!0?y=c.msg:y=M.call(void 0,c.msg),y===_.promise?_.reject(TypeError("Promise-chain cycle")):(w=f(y))?w.call(y,_.resolve,_.reject):_.resolve(y))}catch(d){_.reject(d)}}function m(c){var M,_=this;if(!_.triggered){_.triggered=!0,_.def&&(_=_.def);try{(M=f(c))?r(function(){var y=new v(_);try{M.call(c,function(){m.apply(y,arguments)},function(){g.apply(y,arguments)})}catch(w){g.call(y,w)}}):(_.msg=c,_.state=1,_.chain.length>0&&r(o,_))}catch(y){g.call(new v(_),y)}}}function g(c){var M=this;M.triggered||(M.triggered=!0,M.def&&(M=M.def),M.msg=c,M.state=2,M.chain.length>0&&r(o,M))}function p(c,M,_,y){for(var w=0;w<M.length;w++)(function(C){c.resolve(M[C]).then(function(E){_(C,E)},y)})(w)}function v(c){this.def=c,this.triggered=!1}function x(c){this.promise=c,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function l(c){if(typeof c!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var M=new x(this);this.then=function(y,w){var d={success:typeof y=="function"?y:!0,failure:typeof w=="function"?w:!1};return d.promise=new this.constructor(function(S,E){if(typeof S!="function"||typeof E!="function")throw TypeError("Not a function");d.resolve=S,d.reject=E}),M.chain.push(d),M.state!==0&&r(o,M),d.promise},this.catch=function(y){return this.then(void 0,y)};try{c.call(void 0,function(y){m.call(M,y)},function(y){g.call(M,y)})}catch(_){g.call(M,_)}}var b=T({},"constructor",l,!1);return l.prototype=b,T(b,"__NPO__",0,!1),T(l,"resolve",function(M){var _=this;return M&&typeof M=="object"&&M.__NPO__===1?M:new _(function(w,d){if(typeof w!="function"||typeof d!="function")throw TypeError("Not a function");w(M)})}),T(l,"reject",function(M){return new this(function(y,w){if(typeof y!="function"||typeof w!="function")throw TypeError("Not a function");w(M)})}),T(l,"all",function(M){var _=this;return n.call(M)!="[object Array]"?_.reject(TypeError("Not an array")):M.length===0?_.resolve([]):new _(function(w,d){if(typeof w!="function"||typeof d!="function")throw TypeError("Not a function");var C=M.length,S=Array(C),E=0;p(_,M,function(B,z){S[B]=z,++E===C&&w(S)},d)})}),T(l,"race",function(M){var _=this;return n.call(M)!="[object Array]"?_.reject(TypeError("Not an array")):new _(function(w,d){if(typeof w!="function"||typeof d!="function")throw TypeError("Not a function");p(_,M,function(S,E){w(E)},d)})}),l})}).call(this)}).call(this,typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{},t("timers").setImmediate)},{timers:312}],246:[function(t,P,R){var h=Math.PI,u=a(120);P.exports=A;function A(r){for(var f,o=[],s=0,m=0,g=0,p=0,v=null,x=null,l=0,b=0,c=0,M=r.length;c<M;c++){var _=r[c],y=_[0];switch(y){case"M":g=_[1],p=_[2];break;case"A":_=i(l,b,_[1],_[2],a(_[3]),_[4],_[5],_[6],_[7]),_.unshift("C"),_.length>7&&(o.push(_.splice(0,7)),_.unshift("C"));break;case"S":var w=l,d=b;(f=="C"||f=="S")&&(w+=w-s,d+=d-m),_=["C",w,d,_[1],_[2],_[3],_[4]];break;case"T":f=="Q"||f=="T"?(v=l*2-v,x=b*2-x):(v=l,x=b),_=e(l,b,v,x,_[1],_[2]);break;case"Q":v=_[1],x=_[2],_=e(l,b,_[1],_[2],_[3],_[4]);break;case"L":_=T(l,b,_[1],_[2]);break;case"H":_=T(l,b,_[1],b);break;case"V":_=T(l,b,l,_[1]);break;case"Z":_=T(l,b,g,p);break}f=y,l=_[_.length-2],b=_[_.length-1],_.length>4?(s=_[_.length-4],m=_[_.length-3]):(s=l,m=b),o.push(_)}return o}function T(r,f,o,s){return["C",r,f,o,s,o,s]}function e(r,f,o,s,m,g){return["C",r/3+2/3*o,f/3+2/3*s,m/3+2/3*o,g/3+2/3*s,m,g]}function i(r,f,o,s,m,g,p,v,x,l){if(l)E=l[0],k=l[1],C=l[2],S=l[3];else{var b=n(r,f,-m);r=b.x,f=b.y,b=n(v,x,-m),v=b.x,x=b.y;var c=(r-v)/2,M=(f-x)/2,_=c*c/(o*o)+M*M/(s*s);_>1&&(_=Math.sqrt(_),o=_*o,s=_*s);var y=o*o,w=s*s,d=(g==p?-1:1)*Math.sqrt(Math.abs((y*w-y*M*M-w*c*c)/(y*M*M+w*c*c)));d==1/0&&(d=1);var C=d*o*M/s+(r+v)/2,S=d*-s*c/o+(f+x)/2,E=Math.asin(((f-S)/s).toFixed(9)),k=Math.asin(((x-S)/s).toFixed(9));E=r<C?h-E:E,k=v<C?h-k:k,E<0&&(E=h*2+E),k<0&&(k=h*2+k),p&&E>k&&(E=E-h*2),!p&&k>E&&(k=k-h*2)}if(Math.abs(k-E)>u){var B=k,z=v,F=x;k=E+u*(p&&k>E?1:-1),v=C+o*Math.cos(k),x=S+s*Math.sin(k);var I=i(v,x,o,s,m,0,p,z,F,[k,B,C,S])}var O=Math.tan((k-E)/4),N=4/3*o*O,V=4/3*s*O,H=[2*r-(r+N*Math.sin(E)),2*f-(f-V*Math.cos(E)),v+N*Math.sin(k),x-V*Math.cos(k),v,x];if(l)return H;I&&(H=H.concat(I));for(var j=0;j<H.length;){var Z=n(H[j],H[j+1],m);H[j++]=Z.x,H[j++]=Z.y}return H}function n(r,f,o){return{x:r*Math.cos(o)-f*Math.sin(o),y:r*Math.sin(o)+f*Math.cos(o)}}function a(r){return r*(h/180)}},{}],247:[function(t,P,R){var h=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;function T(i){if(i==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(i)}function e(){try{if(!Object.assign)return!1;var i=new String("abc");if(i[5]="de",Object.getOwnPropertyNames(i)[0]==="5")return!1;for(var n={},a=0;a<10;a++)n["_"+String.fromCharCode(a)]=a;var r=Object.getOwnPropertyNames(n).map(function(o){return n[o]});if(r.join("")!=="0123456789")return!1;var f={};return"abcdefghijklmnopqrst".split("").forEach(function(o){f[o]=o}),Object.keys(Object.assign({},f)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}P.exports=e()?Object.assign:function(i,n){for(var a,r=T(i),f,o=1;o<arguments.length;o++){a=Object(arguments[o]);for(var s in a)u.call(a,s)&&(r[s]=a[s]);if(h){f=h(a);for(var m=0;m<f.length;m++)A.call(a,f[m])&&(r[f[m]]=a[f[m]])}}return r}},{}],248:[function(t,P,R){function h(T,e){if(typeof T!="string")return[T];var i=[T];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var n=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],a=e.escape||"___",r=!!e.flat;n.forEach(function(s){var m=new RegExp(["\\",s[0],"[^\\",s[0],"\\",s[1],"]*\\",s[1]].join("")),g=[];function p(v,x,l){var b=i.push(v.slice(s[0].length,-s[1].length))-1;return g.push(b),a+b+a}i.forEach(function(v,x){for(var l,b=0;v!=l;)if(l=v,v=v.replace(m,p),b++>1e4)throw Error("References have circular dependency. Please, check them.");i[x]=v}),g=g.reverse(),i=i.map(function(v){return g.forEach(function(x){v=v.replace(new RegExp("(\\"+a+x+"\\"+a+")","g"),s[0]+"$1"+s[1])}),v})});var f=new RegExp("\\"+a+"([0-9]+)\\"+a);function o(s,m,g){for(var p=[],v,x=0;v=f.exec(s);){if(x++>1e4)throw Error("Circular references in parenthesis");p.push(s.slice(0,v.index)),p.push(o(m[v[1]],m)),s=s.slice(v.index+v[0].length)}return p.push(s),p}return r?i:o(i[0],i)}function u(T,e){if(e&&e.flat){var i=e&&e.escape||"___",n=T[0],a;if(!n)return"";for(var r=new RegExp("\\"+i+"([0-9]+)\\"+i),f=0;n!=a;){if(f++>1e4)throw Error("Circular references in "+T);a=n,n=n.replace(r,o)}return n}return T.reduce(function s(m,g){return Array.isArray(g)&&(g=g.reduce(s,"")),m+g},"");function o(s,m){if(T[m]==null)throw Error("Reference "+m+"is undefined");return T[m]}}function A(T,e){return Array.isArray(T)?u(T,e):h(T,e)}A.parse=h,A.stringify=u,P.exports=A},{}],249:[function(t,P,R){var h=t("pick-by-alias");P.exports=u;function u(A){var T;return arguments.length>1&&(A=arguments),typeof A=="string"?A=A.split(/\s/).map(parseFloat):typeof A=="number"&&(A=[A]),A.length&&typeof A[0]=="number"?A.length===1?T={width:A[0],height:A[0],x:0,y:0}:A.length===2?T={width:A[0],height:A[1],x:0,y:0}:T={x:A[0],y:A[1],width:A[2]-A[0]||0,height:A[3]-A[1]||0}:A&&(A=h(A,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),T={x:A.left||0,y:A.top||0},A.width==null?A.right?T.width=A.right-T.x:T.width=0:T.width=A.width,A.height==null?A.bottom?T.height=A.bottom-T.y:T.height=0:T.height=A.height),T}},{"pick-by-alias":253}],250:[function(t,P,R){P.exports=A;var h={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},u=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function A(i){var n=[];return i.replace(u,function(a,r,f){var o=r.toLowerCase();for(f=e(f),o=="m"&&f.length>2&&(n.push([r].concat(f.splice(0,2))),o="l",r=r=="m"?"l":"L");;){if(f.length==h[o])return f.unshift(r),n.push(f);if(f.length<h[o])throw new Error("malformed path data");n.push([r].concat(f.splice(0,h[o])))}}),n}var T=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function e(i){var n=i.match(T);return n?n.map(Number):[]}},{}],251:[function(t,P,R){P.exports=function(u,A){A||(A=[0,""]),u=String(u);var T=parseFloat(u,10);return A[0]=T,A[1]=u.match(/[\d.\-\+]*\s*(.*)/)[1]||"",A}},{}],252:[function(t,P,R){(function(h){(function(){(function(){var u,A,T,e,i,n;typeof performance<"u"&&performance!==null&&performance.now?P.exports=function(){return performance.now()}:typeof h<"u"&&h!==null&&h.hrtime?(P.exports=function(){return(u()-i)/1e6},A=h.hrtime,u=function(){var a;return a=A(),a[0]*1e9+a[1]},e=u(),n=h.uptime()*1e9,i=e-n):Date.now?(P.exports=function(){return Date.now()-T},T=Date.now()):(P.exports=function(){return new Date().getTime()-T},T=new Date().getTime())}).call(this)}).call(this)}).call(this,t("_process"))},{_process:278}],253:[function(t,P,R){P.exports=function(T,e,i){var n={},a,r;if(typeof e=="string"&&(e=u(e)),Array.isArray(e)){var f={};for(r=0;r<e.length;r++)f[e[r]]=!0;e=f}for(a in e)e[a]=u(e[a]);var o={};for(a in e){var s=e[a];if(Array.isArray(s))for(r=0;r<s.length;r++){var m=s[r];if(i&&(o[m]=!0),m in T){if(n[a]=T[m],i)for(var g=r;g<s.length;g++)o[s[g]]=!0;break}}else a in T&&(e[a]&&(n[a]=T[a]),i&&(o[a]=!0))}if(i)for(a in T)o[a]||(n[a]=T[a]);return n};var h={};function u(A){return h[A]?h[A]:(typeof A=="string"&&(A=h[A]=A.split(/\s*,\s*|\s+/)),A)}},{}],254:[function(t,P,R){P.exports=function(u,A,T,e){var i=u[0],n=u[1],a=!1;T===void 0&&(T=0),e===void 0&&(e=A.length);for(var r=e-T,f=0,o=r-1;f<r;o=f++){var s=A[f+T][0],m=A[f+T][1],g=A[o+T][0],p=A[o+T][1],v=m>n!=p>n&&i<(g-s)*(n-m)/(p-m)+s;v&&(a=!a)}return a}},{}],255:[function(t,P,R){/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var h=t("./lib/build-log"),u=t("./lib/epsilon"),A=t("./lib/intersecter"),T=t("./lib/segment-chainer"),e=t("./lib/segment-selector"),i=t("./lib/geojson"),n=!1,a=u(),r;r={buildLog:function(o){return o===!0?n=h():o===!1&&(n=!1),n===!1?!1:n.list},epsilon:function(o){return a.epsilon(o)},segments:function(o){var s=A(!0,a,n);return o.regions.forEach(s.addRegion),{segments:s.calculate(o.inverted),inverted:o.inverted}},combine:function(o,s){var m=A(!1,a,n);return{combined:m.calculate(o.segments,o.inverted,s.segments,s.inverted),inverted1:o.inverted,inverted2:s.inverted}},selectUnion:function(o){return{segments:e.union(o.combined,n),inverted:o.inverted1||o.inverted2}},selectIntersect:function(o){return{segments:e.intersect(o.combined,n),inverted:o.inverted1&&o.inverted2}},selectDifference:function(o){return{segments:e.difference(o.combined,n),inverted:o.inverted1&&!o.inverted2}},selectDifferenceRev:function(o){return{segments:e.differenceRev(o.combined,n),inverted:!o.inverted1&&o.inverted2}},selectXor:function(o){return{segments:e.xor(o.combined,n),inverted:o.inverted1!==o.inverted2}},polygon:function(o){return{regions:T(o.segments,a,n),inverted:o.inverted}},polygonFromGeoJSON:function(o){return i.toPolygon(r,o)},polygonToGeoJSON:function(o){return i.fromPolygon(r,a,o)},union:function(o,s){return f(o,s,r.selectUnion)},intersect:function(o,s){return f(o,s,r.selectIntersect)},difference:function(o,s){return f(o,s,r.selectDifference)},differenceRev:function(o,s){return f(o,s,r.selectDifferenceRev)},xor:function(o,s){return f(o,s,r.selectXor)}};function f(o,s,m){var g=r.segments(o),p=r.segments(s),v=r.combine(g,p),x=m(v);return r.polygon(x)}typeof window=="object"&&(window.PolyBool=r),P.exports=r},{"./lib/build-log":256,"./lib/epsilon":257,"./lib/geojson":258,"./lib/intersecter":259,"./lib/segment-chainer":261,"./lib/segment-selector":262}],256:[function(t,P,R){function h(){var u,A=0,T=!1;function e(i,n){return u.list.push({type:i,data:n?JSON.parse(JSON.stringify(n)):void 0}),u}return u={list:[],segmentId:function(){return A++},checkIntersection:function(i,n){return e("check",{seg1:i,seg2:n})},segmentChop:function(i,n){return e("div_seg",{seg:i,pt:n}),e("chop",{seg:i,pt:n})},statusRemove:function(i){return e("pop_seg",{seg:i})},segmentUpdate:function(i){return e("seg_update",{seg:i})},segmentNew:function(i,n){return e("new_seg",{seg:i,primary:n})},segmentRemove:function(i){return e("rem_seg",{seg:i})},tempStatus:function(i,n,a){return e("temp_status",{seg:i,above:n,below:a})},rewind:function(i){return e("rewind",{seg:i})},status:function(i,n,a){return e("status",{seg:i,above:n,below:a})},vert:function(i){return i===T?u:(T=i,e("vert",{x:i}))},log:function(i){return typeof i!="string"&&(i=JSON.stringify(i,!1,"  ")),e("log",{txt:i})},reset:function(){return e("reset")},selected:function(i){return e("selected",{segs:i})},chainStart:function(i){return e("chain_start",{seg:i})},chainRemoveHead:function(i,n){return e("chain_rem_head",{index:i,pt:n})},chainRemoveTail:function(i,n){return e("chain_rem_tail",{index:i,pt:n})},chainNew:function(i,n){return e("chain_new",{pt1:i,pt2:n})},chainMatch:function(i){return e("chain_match",{index:i})},chainClose:function(i){return e("chain_close",{index:i})},chainAddHead:function(i,n){return e("chain_add_head",{index:i,pt:n})},chainAddTail:function(i,n){return e("chain_add_tail",{index:i,pt:n})},chainConnect:function(i,n){return e("chain_con",{index1:i,index2:n})},chainReverse:function(i){return e("chain_rev",{index:i})},chainJoin:function(i,n){return e("chain_join",{index1:i,index2:n})},done:function(){return e("done")}},u}P.exports=h},{}],257:[function(t,P,R){function h(u){typeof u!="number"&&(u=1e-10);var A={epsilon:function(T){return typeof T=="number"&&(u=T),u},pointAboveOrOnLine:function(T,e,i){var n=e[0],a=e[1],r=i[0],f=i[1],o=T[0],s=T[1];return(r-n)*(s-a)-(f-a)*(o-n)>=-u},pointBetween:function(T,e,i){var n=T[1]-e[1],a=i[0]-e[0],r=T[0]-e[0],f=i[1]-e[1],o=r*a+n*f;if(o<u)return!1;var s=a*a+f*f;return!(o-s>-u)},pointsSameX:function(T,e){return Math.abs(T[0]-e[0])<u},pointsSameY:function(T,e){return Math.abs(T[1]-e[1])<u},pointsSame:function(T,e){return A.pointsSameX(T,e)&&A.pointsSameY(T,e)},pointsCompare:function(T,e){return A.pointsSameX(T,e)?A.pointsSameY(T,e)?0:T[1]<e[1]?-1:1:T[0]<e[0]?-1:1},pointsCollinear:function(T,e,i){var n=T[0]-e[0],a=T[1]-e[1],r=e[0]-i[0],f=e[1]-i[1];return Math.abs(n*f-r*a)<u},linesIntersect:function(T,e,i,n){var a=e[0]-T[0],r=e[1]-T[1],f=n[0]-i[0],o=n[1]-i[1],s=a*o-r*f;if(Math.abs(s)<u)return!1;var m=T[0]-i[0],g=T[1]-i[1],p=(f*g-o*m)/s,v=(a*g-r*m)/s,x={alongA:0,alongB:0,pt:[T[0]+p*a,T[1]+p*r]};return p<=-u?x.alongA=-2:p<u?x.alongA=-1:p-1<=-u?x.alongA=0:p-1<u?x.alongA=1:x.alongA=2,v<=-u?x.alongB=-2:v<u?x.alongB=-1:v-1<=-u?x.alongB=0:v-1<u?x.alongB=1:x.alongB=2,x},pointInsideRegion:function(T,e){for(var i=T[0],n=T[1],a=e[e.length-1][0],r=e[e.length-1][1],f=!1,o=0;o<e.length;o++){var s=e[o][0],m=e[o][1];m-n>u!=r-n>u&&(a-s)*(n-m)/(r-m)+s-i>u&&(f=!f),a=s,r=m}return f}};return A}P.exports=h},{}],258:[function(t,P,R){var h={toPolygon:function(u,A){function T(n){if(n.length<=0)return u.segments({inverted:!1,regions:[]});function a(o){var s=o.slice(0,o.length-1);return u.segments({inverted:!1,regions:[s]})}for(var r=a(n[0]),f=1;f<n.length;f++)r=u.selectDifference(u.combine(r,a(n[f])));return r}if(A.type==="Polygon")return u.polygon(T(A.coordinates));if(A.type==="MultiPolygon"){for(var e=u.segments({inverted:!1,regions:[]}),i=0;i<A.coordinates.length;i++)e=u.selectUnion(u.combine(e,T(A.coordinates[i])));return u.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(u,A,T){T=u.polygon(u.segments(T));function e(p,v){return A.pointInsideRegion([(p[0][0]+p[1][0])*.5,(p[0][1]+p[1][1])*.5],v)}function i(p){return{region:p,children:[]}}var n=i(null);function a(p,v){for(var x=0;x<p.children.length;x++){var l=p.children[x];if(e(v,l.region)){a(l,v);return}}for(var b=i(v),x=0;x<p.children.length;x++){var l=p.children[x];e(l.region,v)&&(b.children.push(l),p.children.splice(x,1),x--)}p.children.push(b)}for(var r=0;r<T.regions.length;r++){var f=T.regions[r];f.length<3||a(n,f)}function o(p,v){for(var x=0,l=p[p.length-1][0],b=p[p.length-1][1],c=[],M=0;M<p.length;M++){var _=p[M][0],y=p[M][1];c.push([_,y]),x+=y*l-_*b,l=_,b=y}var w=x<0;return w!==v&&c.reverse(),c.push([c[0][0],c[0][1]]),c}var s=[];function m(p){var v=[o(p.region,!1)];s.push(v);for(var x=0;x<p.children.length;x++)v.push(g(p.children[x]))}function g(p){for(var v=0;v<p.children.length;v++)m(p.children[v]);return o(p.region,!0)}for(var r=0;r<n.children.length;r++)m(n.children[r]);return s.length<=0?{type:"Polygon",coordinates:[]}:s.length==1?{type:"Polygon",coordinates:s[0]}:{type:"MultiPolygon",coordinates:s}}};P.exports=h},{}],259:[function(t,P,R){var h=t("./linked-list");function u(A,T,e){function i(x,l){return{id:e?e.segmentId():-1,start:x,end:l,myFill:{above:null,below:null},otherFill:null}}function n(x,l,b){return{id:e?e.segmentId():-1,start:x,end:l,myFill:{above:b.myFill.above,below:b.myFill.below},otherFill:null}}var a=h.create();function r(x,l,b,c,M,_){var y=T.pointsCompare(l,M);return y!==0?y:T.pointsSame(b,_)?0:x!==c?x?1:-1:T.pointAboveOrOnLine(b,c?M:_,c?_:M)?1:-1}function f(x,l){a.insertBefore(x,function(b){var c=r(x.isStart,x.pt,l,b.isStart,b.pt,b.other.pt);return c<0})}function o(x,l){var b=h.node({isStart:!0,pt:x.start,seg:x,primary:l,other:null,status:null});return f(b,x.end),b}function s(x,l,b){var c=h.node({isStart:!1,pt:l.end,seg:l,primary:b,other:x,status:null});x.other=c,f(c,x.pt)}function m(x,l){var b=o(x,l);return s(b,x,l),b}function g(x,l){e&&e.segmentChop(x.seg,l),x.other.remove(),x.seg.end=l,x.other.pt=l,f(x.other,x.pt)}function p(x,l){var b=n(l,x.seg.end,x.seg);return g(x,l),m(b,x.primary)}function v(x,l){var b=h.create();function c(O,N){var V=O.seg.start,H=O.seg.end,j=N.seg.start,Z=N.seg.end;return T.pointsCollinear(V,j,Z)?T.pointsCollinear(H,j,Z)||T.pointAboveOrOnLine(H,j,Z)?1:-1:T.pointAboveOrOnLine(V,j,Z)?1:-1}function M(O){return b.findTransition(function(N){var V=c(O,N.ev);return V>0})}function _(O,N){var V=O.seg,H=N.seg,j=V.start,Z=V.end,X=H.start,re=H.end;e&&e.checkIntersection(V,H);var ue=T.linesIntersect(j,Z,X,re);if(ue===!1){if(!T.pointsCollinear(j,Z,X)||T.pointsSame(j,re)||T.pointsSame(Z,X))return!1;var K=T.pointsSame(j,X),te=T.pointsSame(Z,re);if(K&&te)return N;var G=!K&&T.pointBetween(j,X,re),Y=!te&&T.pointBetween(Z,X,re);if(K)return Y?p(N,Z):p(O,re),N;G&&(te||(Y?p(N,Z):p(O,re)),p(N,j))}else ue.alongA===0&&(ue.alongB===-1?p(O,X):ue.alongB===0?p(O,ue.pt):ue.alongB===1&&p(O,re)),ue.alongB===0&&(ue.alongA===-1?p(N,j):ue.alongA===0?p(N,ue.pt):ue.alongA===1&&p(N,Z));return!1}for(var y=[];!a.isEmpty();){var w=a.getHead();if(e&&e.vert(w.pt[0]),w.isStart){let O=function(){if(C){var N=_(w,C);if(N)return N}return S?_(w,S):!1};var I=O;e&&e.segmentNew(w.seg,w.primary);var d=M(w),C=d.before?d.before.ev:null,S=d.after?d.after.ev:null;e&&e.tempStatus(w.seg,C?C.seg:!1,S?S.seg:!1);var E=O();if(E){if(A){var k;w.seg.myFill.below===null?k=!0:k=w.seg.myFill.above!==w.seg.myFill.below,k&&(E.seg.myFill.above=!E.seg.myFill.above)}else E.seg.otherFill=w.seg.myFill;e&&e.segmentUpdate(E.seg),w.other.remove(),w.remove()}if(a.getHead()!==w){e&&e.rewind(w.seg);continue}if(A){var k;w.seg.myFill.below===null?k=!0:k=w.seg.myFill.above!==w.seg.myFill.below,S?w.seg.myFill.below=S.seg.myFill.above:w.seg.myFill.below=x,k?w.seg.myFill.above=!w.seg.myFill.below:w.seg.myFill.above=w.seg.myFill.below}else if(w.seg.otherFill===null){var B;S?w.primary===S.primary?B=S.seg.otherFill.above:B=S.seg.myFill.above:B=w.primary?l:x,w.seg.otherFill={above:B,below:B}}e&&e.status(w.seg,C?C.seg:!1,S?S.seg:!1),w.other.status=d.insert(h.node({ev:w}))}else{var z=w.status;if(z===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(b.exists(z.prev)&&b.exists(z.next)&&_(z.prev.ev,z.next.ev),e&&e.statusRemove(z.ev.seg),z.remove(),!w.primary){var F=w.seg.myFill;w.seg.myFill=w.seg.otherFill,w.seg.otherFill=F}y.push(w.seg)}a.getHead().remove()}return e&&e.done(),y}return A?{addRegion:function(x){for(var l,b=x[x.length-1],c=0;c<x.length;c++){l=b,b=x[c];var M=T.pointsCompare(l,b);M!==0&&m(i(M<0?l:b,M<0?b:l),!0)}},calculate:function(x){return v(x,!1)}}:{calculate:function(x,l,b,c){return x.forEach(function(M){m(n(M.start,M.end,M),!0)}),b.forEach(function(M){m(n(M.start,M.end,M),!1)}),v(l,c)}}}P.exports=u},{"./linked-list":260}],260:[function(t,P,R){var h={create:function(){var u={root:{root:!0,next:null},exists:function(A){return!(A===null||A===u.root)},isEmpty:function(){return u.root.next===null},getHead:function(){return u.root.next},insertBefore:function(A,T){for(var e=u.root,i=u.root.next;i!==null;){if(T(i)){A.prev=i.prev,A.next=i,i.prev.next=A,i.prev=A;return}e=i,i=i.next}e.next=A,A.prev=e,A.next=null},findTransition:function(A){for(var T=u.root,e=u.root.next;e!==null&&!A(e);)T=e,e=e.next;return{before:T===u.root?null:T,after:e,insert:function(i){return i.prev=T,i.next=e,T.next=i,e!==null&&(e.prev=i),i}}}};return u},node:function(u){return u.prev=null,u.next=null,u.remove=function(){u.prev.next=u.next,u.next&&(u.next.prev=u.prev),u.prev=null,u.next=null},u}};P.exports=h},{}],261:[function(t,P,R){function h(u,A,T){var e=[],i=[];return u.forEach(function(n){var a=n.start,r=n.end;if(A.pointsSame(a,r)){console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");return}T&&T.chainStart(n);var f={index:0,matches_head:!1,matches_pt1:!1},o={index:0,matches_head:!1,matches_pt1:!1},s=f;function m(B,z,F){return s.index=B,s.matches_head=z,s.matches_pt1=F,s===f?(s=o,!1):(s=null,!0)}for(var g=0;g<e.length;g++){var p=e[g],v=p[0];p[1];var x=p[p.length-1];if(p[p.length-2],A.pointsSame(v,a)){if(m(g,!0,!0))break}else if(A.pointsSame(v,r)){if(m(g,!0,!1))break}else if(A.pointsSame(x,a)){if(m(g,!1,!0))break}else if(A.pointsSame(x,r)&&m(g,!1,!1))break}if(s===f){e.push([a,r]),T&&T.chainNew(a,r);return}if(s===o){T&&T.chainMatch(f.index);var l=f.index,b=f.matches_pt1?r:a,c=f.matches_head,p=e[l],M=c?p[0]:p[p.length-1],_=c?p[1]:p[p.length-2],y=c?p[p.length-1]:p[0],w=c?p[p.length-2]:p[1];if(A.pointsCollinear(_,M,b)&&(c?(T&&T.chainRemoveHead(f.index,b),p.shift()):(T&&T.chainRemoveTail(f.index,b),p.pop()),M=_),A.pointsSame(y,b)){e.splice(l,1),A.pointsCollinear(w,y,M)&&(c?(T&&T.chainRemoveTail(f.index,M),p.pop()):(T&&T.chainRemoveHead(f.index,M),p.shift())),T&&T.chainClose(f.index),i.push(p);return}c?(T&&T.chainAddHead(f.index,b),p.unshift(b)):(T&&T.chainAddTail(f.index,b),p.push(b));return}function d(B){T&&T.chainReverse(B),e[B].reverse()}function C(B,z){var F=e[B],I=e[z],O=F[F.length-1],N=F[F.length-2],V=I[0],H=I[1];A.pointsCollinear(N,O,V)&&(T&&T.chainRemoveTail(B,O),F.pop(),O=N),A.pointsCollinear(O,V,H)&&(T&&T.chainRemoveHead(z,V),I.shift()),T&&T.chainJoin(B,z),e[B]=F.concat(I),e.splice(z,1)}var S=f.index,E=o.index;T&&T.chainConnect(S,E);var k=e[S].length<e[E].length;f.matches_head?o.matches_head?k?(d(S),C(S,E)):(d(E),C(E,S)):C(E,S):o.matches_head?C(S,E):k?(d(S),C(E,S)):(d(E),C(S,E))}),i}P.exports=h},{}],262:[function(t,P,R){function h(A,T,e){var i=[];return A.forEach(function(n){var a=(n.myFill.above?8:0)+(n.myFill.below?4:0)+(n.otherFill&&n.otherFill.above?2:0)+(n.otherFill&&n.otherFill.below?1:0);T[a]!==0&&i.push({id:e?e.segmentId():-1,start:n.start,end:n.end,myFill:{above:T[a]===1,below:T[a]===2},otherFill:null})}),e&&e.selected(i),i}var u={union:function(A,T){return h(A,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],T)},intersect:function(A,T){return h(A,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],T)},difference:function(A,T){return h(A,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],T)},differenceRev:function(A,T){return h(A,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],T)},xor:function(A,T){return h(A,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],T)}};P.exports=u},{}],263:[function(t,P,R){var h=t("stream").Transform,u=t("stream-parser");function A(){h.call(this,{readableObjectMode:!0})}A.prototype=Object.create(h.prototype),A.prototype.constructor=A,u(A.prototype),R.ParserStream=A,R.sliceEq=function(e,i,n){for(var a=i,r=0;r<n.length;)if(e[a++]!==n[r++])return!1;return!0},R.str2arr=function(e,i){var n=[],a=0;if(i&&i==="hex")for(;a<e.length;)n.push(parseInt(e.slice(a,a+2),16)),a+=2;else for(;a<e.length;a++)n.push(e.charCodeAt(a)&255);return n},R.readUInt16LE=function(e,i){return e[i]|e[i+1]<<8},R.readUInt16BE=function(e,i){return e[i+1]|e[i]<<8},R.readUInt32LE=function(e,i){return e[i]|e[i+1]<<8|e[i+2]<<16|e[i+3]*16777216},R.readUInt32BE=function(e,i){return e[i+3]|e[i+2]<<8|e[i+1]<<16|e[i]*16777216};function T(e,i,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||"",this.name=this.constructor.name,this.message=e,i&&(this.code=i),n&&(this.statusCode=n)}T.prototype=Object.create(Error.prototype),T.prototype.constructor=T,R.ProbeError=T},{stream:286,"stream-parser":302}],264:[function(t,P,R){function h(T,e){var i=new Error(T);return i.code=e,i}function u(T){try{return decodeURIComponent(escape(T))}catch{return T}}function A(T,e,i){this.input=T.subarray(e,i),this.start=e;var n=String.fromCharCode.apply(null,this.input.subarray(0,4));if(n!=="II*\0"&&n!=="MM\0*")throw h("invalid TIFF signature","EBADDATA");this.big_endian=n[0]==="M"}A.prototype.each=function(T){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var i=this.ifds_to_read.shift();!i.offset||this.scan_ifd(i.id,i.offset,T)}},A.prototype.read_uint16=function(T){var e=this.input;if(T+2>e.length)throw h("unexpected EOF","EBADDATA");return this.big_endian?e[T]*256+e[T+1]:e[T]+e[T+1]*256},A.prototype.read_uint32=function(T){var e=this.input;if(T+4>e.length)throw h("unexpected EOF","EBADDATA");return this.big_endian?e[T]*16777216+e[T+1]*65536+e[T+2]*256+e[T+3]:e[T]+e[T+1]*256+e[T+2]*65536+e[T+3]*16777216},A.prototype.is_subifd_link=function(T,e){return T===0&&e===34665||T===0&&e===34853||T===34665&&e===40965},A.prototype.exif_format_length=function(T){switch(T){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},A.prototype.exif_format_read=function(T,e){var i;switch(T){case 1:case 2:return i=this.input[e],i;case 6:return i=this.input[e],i|(i&128)*33554430;case 3:return i=this.read_uint16(e),i;case 8:return i=this.read_uint16(e),i|(i&32768)*131070;case 4:return i=this.read_uint32(e),i;case 9:return i=this.read_uint32(e),i|0;case 5:case 10:case 11:case 12:return null;case 7:return null;default:return null}},A.prototype.scan_ifd=function(T,e,i){var n=this.read_uint16(e);e+=2;for(var a=0;a<n;a++){var r=this.read_uint16(e),f=this.read_uint16(e+2),o=this.read_uint32(e+4),s=this.exif_format_length(f),m=o*s,g=m<=4?e+8:this.read_uint32(e+8),p=!1;if(g+m>this.input.length)throw h("unexpected EOF","EBADDATA");for(var v=[],x=g,l=0;l<o;l++,x+=s){var b=this.exif_format_read(f,x);if(b===null){v=null;break}v.push(b)}Array.isArray(v)&&f===2&&(v=u(String.fromCharCode.apply(null,v)),v&&v[v.length-1]==="\0"&&(v=v.slice(0,-1))),this.is_subifd_link(T,r)&&Array.isArray(v)&&Number.isInteger(v[0])&&v[0]>0&&(this.ifds_to_read.push({id:r,offset:v[0]}),p=!0);var c={is_big_endian:this.big_endian,ifd:T,tag:r,format:f,count:o,entry_offset:e+this.start,data_length:m,data_offset:g+this.start,value:v,is_subifd_link:p};if(i(c)===!1){this.aborted=!0;return}e+=12}T===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},P.exports.ExifParser=A,P.exports.get_orientation=function(T){var e=0;try{return new A(T,0,T.length).each(function(i){if(i.ifd===0&&i.tag===274&&Array.isArray(i.value))return e=i.value[0],!1}),e}catch{return-1}}},{}],265:[function(t,P,R){var h=t("./common").readUInt16BE,u=t("./common").readUInt32BE;function A(o,s){if(o.length<4+s)return null;var m=u(o,s);return o.length<m+s||m<8?null:{boxtype:String.fromCharCode.apply(null,o.slice(s+4,s+8)),data:o.slice(s+8,s+m),end:s+m}}P.exports.unbox=A;function T(o,s){for(var m=0;;){var g=A(o,m);if(!g)break;switch(g.boxtype){case"ispe":s.sizes.push({width:u(g.data,4),height:u(g.data,8)});break;case"irot":s.transforms.push({type:"irot",value:g.data[0]&3});break;case"imir":s.transforms.push({type:"imir",value:g.data[0]&1});break}m=g.end}}function e(o,s,m){for(var g=0,p=0;p<m;p++)g=g*256+(o[s+p]||0);return g}function i(o,s){for(var m=o[4]>>4&15,g=o[4]&15,p=o[5]>>4&15,v=h(o,6),x=8,l=0;l<v;l++){var b=h(o,x);x+=2;var c=h(o,x);x+=2;var M=e(o,x,p);x+=p;var _=h(o,x);if(x+=2,c===0&&_===1){var y=e(o,x,m),w=e(o,x+m,g);s.item_loc[b]={length:w,offset:y+M}}x+=_*(m+g)}}function n(o,s){for(var m=h(o,4),g=6,p=0;p<m;p++){var v=A(o,g);if(!v)break;if(v.boxtype==="infe"){for(var x=h(v.data,4),l="",b=8;b<v.data.length&&v.data[b];b++)l+=String.fromCharCode(v.data[b]);s.item_inf[l]=x}g=v.end}}function a(o,s){for(var m=0;;){var g=A(o,m);if(!g)break;g.boxtype==="ipco"&&T(g.data,s),m=g.end}}function r(o,s){for(var m=4;;){var g=A(o,m);if(!g)break;g.boxtype==="iprp"&&a(g.data,s),g.boxtype==="iloc"&&i(g.data,s),g.boxtype==="iinf"&&n(g.data,s),m=g.end}}function f(o){var s=o.reduce(function(p,v){return p.width>v.width||p.width===v.width&&p.height>v.height?p:v}),m=o.reduce(function(p,v){return p.height>v.height||p.height===v.height&&p.width>v.width?p:v}),g;return s.width>m.height||s.width===m.height&&s.height>m.width?g=s:g=m,g}P.exports.readSizeFromMeta=function(o){var s={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(r(o,s),!!s.sizes.length){var m=f(s.sizes),g=1;s.transforms.forEach(function(v){var x={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},l={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(v.type==="imir"&&(v.value===0?g=l[g]:(g=l[g],g=x[g],g=x[g])),v.type==="irot")for(var b=0;b<v.value;b++)g=x[g]});var p=null;return s.item_inf.Exif&&(p=s.item_loc[s.item_inf.Exif]),{width:m.width,height:m.height,orientation:s.transforms.length?g:null,variants:s.sizes,exif_location:p}}},P.exports.getMimeType=function(o){var s=String.fromCharCode.apply(null,o.slice(0,4)),m={};m[s]=!0;for(var g=8;g<o.length;g+=4)m[String.fromCharCode.apply(null,o.slice(g,g+4))]=!0;if(!(!m.mif1&&!m.msf1&&!m.miaf))return s==="avif"||s==="avis"||s==="avio"?{type:"avif",mime:"image/avif"}:s==="heic"||s==="heix"?{type:"heic",mime:"image/heic"}:s==="hevc"||s==="hevx"?{type:"heic",mime:"image/heic-sequence"}:m.avif||m.avis?{type:"avif",mime:"image/avif"}:m.heic||m.heix||m.hevc||m.hevx||m.heis?m.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":263}],266:[function(t,P,R){var h=t("../common").str2arr,u=t("../common").sliceEq,A=t("../common").readUInt32BE,T=t("../miaf_utils"),e=t("../exif_utils"),i=h("ftyp");P.exports=function(n){if(!!u(n,4,i)){var a=T.unbox(n,0);if(!!a){var r=T.getMimeType(a.data);if(!!r){for(var f,o=a.end;;){var s=T.unbox(n,o);if(!s)break;if(o=s.end,s.boxtype==="mdat")return;if(s.boxtype==="meta"){f=s.data;break}}if(!!f){var m=T.readSizeFromMeta(f);if(!!m){var g={width:m.width,height:m.height,type:r.type,mime:r.mime,wUnits:"px",hUnits:"px"};if(m.variants.length>1&&(g.variants=m.variants),m.orientation&&(g.orientation=m.orientation),m.exif_location&&m.exif_location.offset+m.exif_location.length<=n.length){var p=A(n,m.exif_location.offset),v=n.slice(m.exif_location.offset+p+4,m.exif_location.offset+m.exif_location.length),x=e.get_orientation(v);x>0&&(g.orientation=x)}return g}}}}}}},{"../common":263,"../exif_utils":264,"../miaf_utils":265}],267:[function(t,P,R){var h=t("../common").str2arr,u=t("../common").sliceEq,A=t("../common").readUInt16LE,T=h("BM");P.exports=function(e){if(!(e.length<26)&&!!u(e,0,T))return{width:A(e,18),height:A(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":263}],268:[function(t,P,R){var h=t("../common").str2arr,u=t("../common").sliceEq,A=t("../common").readUInt16LE,T=h("GIF87a"),e=h("GIF89a");P.exports=function(i){if(!(i.length<10)&&!(!u(i,0,T)&&!u(i,0,e)))return{width:A(i,6),height:A(i,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":263}],269:[function(t,P,R){var h=t("../common").readUInt16LE,u=0,A=1,T=16;P.exports=function(e){var i=h(e,0),n=h(e,2),a=h(e,4);if(!(i!==u||n!==A||!a)){for(var r=[],f={width:0,height:0},o=0;o<a;o++){var s=e[6+T*o]||256,m=e[6+T*o+1]||256,g={width:s,height:m};r.push(g),(s>f.width||m>f.height)&&(f=g)}return{width:f.width,height:f.height,variants:r,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":263}],270:[function(t,P,R){var h=t("../common").readUInt16BE,u=t("../common").str2arr,A=t("../common").sliceEq,T=t("../exif_utils"),e=u("Exif\0\0");P.exports=function(i){if(!(i.length<2)&&!(i[0]!==255||i[1]!==216||i[2]!==255))for(var n=2;;){for(;;){if(i.length-n<2)return;if(i[n++]===255)break}for(var a=i[n++],r;a===255;)a=i[n++];if(208<=a&&a<=217||a===1)r=0;else if(192<=a&&a<=254){if(i.length-n<2)return;r=h(i,n)-2,n+=2}else return;if(a===217||a===218)return;var f;if(a===225&&r>=10&&A(i,n,e)&&(f=T.get_orientation(i.slice(n+6,n+r))),r>=5&&192<=a&&a<=207&&a!==196&&a!==200&&a!==204){if(i.length-n<r)return;var o={width:h(i,n+3),height:h(i,n+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return f>0&&(o.orientation=f),o}n+=r}}},{"../common":263,"../exif_utils":264}],271:[function(t,P,R){var h=t("../common").str2arr,u=t("../common").sliceEq,A=t("../common").readUInt32BE,T=h(`\x89PNG\r

`),e=h("IHDR");P.exports=function(i){if(!(i.length<24)&&!!u(i,0,T)&&!!u(i,12,e))return{width:A(i,16),height:A(i,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":263}],272:[function(t,P,R){var h=t("../common").str2arr,u=t("../common").sliceEq,A=t("../common").readUInt32BE,T=h("8BPS\0");P.exports=function(e){if(!(e.length<6+16)&&!!u(e,0,T))return{width:A(e,6+12),height:A(e,6+8),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":263}],273:[function(t,P,R){function h(s){return s===32||s===9||s===13||s===10}function u(s){return typeof s=="number"&&isFinite(s)&&s>0}function A(s){var m=0,g=s.length;for(s[0]===239&&s[1]===187&&s[2]===191&&(m=3);m<g&&h(s[m]);)m++;return m===g?!1:s[m]===60}var T=/<[-_.:a-zA-Z0-9][^>]*>/,e=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,i=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,n=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,a=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,r=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function f(s){var m=s.match(i),g=s.match(n),p=s.match(a);return{width:m&&(m[1]||m[2]),height:g&&(g[1]||g[2]),viewbox:p&&(p[1]||p[2])}}function o(s){return r.test(s)?s.match(r)[0]:"px"}P.exports=function(s){if(!!A(s)){for(var m="",g=0;g<s.length;g++)m+=String.fromCharCode(s[g]);var p=(m.match(T)||[""])[0];if(!!e.test(p)){var v=f(p),x=parseFloat(v.width),l=parseFloat(v.height);if(v.width&&v.height)return!u(x)||!u(l)?void 0:{width:x,height:l,type:"svg",mime:"image/svg+xml",wUnits:o(v.width),hUnits:o(v.height)};var b=(v.viewbox||"").split(" "),c={width:b[2],height:b[3]},M=parseFloat(c.width),_=parseFloat(c.height);if(!(!u(M)||!u(_))&&o(c.width)===o(c.height)){var y=M/_;return v.width?u(x)?{width:x,height:x/y,type:"svg",mime:"image/svg+xml",wUnits:o(v.width),hUnits:o(v.width)}:void 0:v.height?u(l)?{width:l*y,height:l,type:"svg",mime:"image/svg+xml",wUnits:o(v.height),hUnits:o(v.height)}:void 0:{width:M,height:_,type:"svg",mime:"image/svg+xml",wUnits:o(c.width),hUnits:o(c.height)}}}}}},{}],274:[function(t,P,R){var h=t("../common").str2arr,u=t("../common").sliceEq,A=t("../common").readUInt16LE,T=t("../common").readUInt16BE,e=t("../common").readUInt32LE,i=t("../common").readUInt32BE,n=h("II*\0"),a=h("MM\0*");function r(s,m,g){return g?T(s,m):A(s,m)}function f(s,m,g){return g?i(s,m):e(s,m)}function o(s,m,g){var p=r(s,m+2,g),v=f(s,m+4,g);return v!==1||p!==3&&p!==4?null:p===3?r(s,m+8,g):f(s,m+8,g)}P.exports=function(s){if(!(s.length<8)&&!(!u(s,0,n)&&!u(s,0,a))){var m=s[0]===77,g=f(s,4,m)-8;if(!(g<0)){var p=g+8;if(!(s.length-p<2)){var v=r(s,p+0,m)*12;if(!(v<=0)&&(p+=2,!(s.length-p<v))){var x,l,b,c;for(x=0;x<v;x+=12)c=r(s,p+x,m),c===256?l=o(s,p+x,m):c===257&&(b=o(s,p+x,m));if(l&&b)return{width:l,height:b,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}}}}}}},{"../common":263}],275:[function(t,P,R){var h=t("../common").str2arr,u=t("../common").sliceEq,A=t("../common").readUInt16LE,T=t("../common").readUInt32LE,e=t("../exif_utils"),i=h("RIFF"),n=h("WEBP");function a(o,s){if(!(o[s+3]!==157||o[s+4]!==1||o[s+5]!==42))return{width:A(o,s+6)&16383,height:A(o,s+8)&16383,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function r(o,s){if(o[s]===47){var m=T(o,s+1);return{width:(m&16383)+1,height:(m>>14&16383)+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function f(o,s){return{width:(o[s+6]<<16|o[s+5]<<8|o[s+4])+1,height:(o[s+9]<<s|o[s+8]<<8|o[s+7])+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}P.exports=function(o){if(!(o.length<16)&&!(!u(o,0,i)&&!u(o,8,n))){var s=12,m=null,g=0,p=T(o,4)+8;if(!(p>o.length)){for(;s+8<p;){if(o[s]===0){s++;continue}var v=String.fromCharCode.apply(null,o.slice(s,s+4)),x=T(o,s+4);v==="VP8 "&&x>=10?m=m||a(o,s+8):v==="VP8L"&&x>=9?m=m||r(o,s+8):v==="VP8X"&&x>=10?m=m||f(o,s+8):v==="EXIF"&&(g=e.get_orientation(o.slice(s+8,s+8+x)),s=1/0),s+=8+x}if(!!m)return g>0&&(m.orientation=g),m}}}},{"../common":263,"../exif_utils":264}],276:[function(t,P,R){P.exports={avif:t("./parse_sync/avif"),bmp:t("./parse_sync/bmp"),gif:t("./parse_sync/gif"),ico:t("./parse_sync/ico"),jpeg:t("./parse_sync/jpeg"),png:t("./parse_sync/png"),psd:t("./parse_sync/psd"),svg:t("./parse_sync/svg"),tiff:t("./parse_sync/tiff"),webp:t("./parse_sync/webp")}},{"./parse_sync/avif":266,"./parse_sync/bmp":267,"./parse_sync/gif":268,"./parse_sync/ico":269,"./parse_sync/jpeg":270,"./parse_sync/png":271,"./parse_sync/psd":272,"./parse_sync/svg":273,"./parse_sync/tiff":274,"./parse_sync/webp":275}],277:[function(t,P,R){var h=t("./lib/parsers_sync");function u(A){for(var T=Object.keys(h),e=0;e<T.length;e++){var i=h[T[e]](A);if(i)return i}return null}P.exports=function(T){return u(T)},P.exports.parsers=h},{"./lib/parsers_sync":276}],278:[function(t,P,R){var h=P.exports={},u,A;function T(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?u=setTimeout:u=T}catch{u=T}try{typeof clearTimeout=="function"?A=clearTimeout:A=e}catch{A=e}})();function i(v){if(u===setTimeout)return setTimeout(v,0);if((u===T||!u)&&setTimeout)return u=setTimeout,setTimeout(v,0);try{return u(v,0)}catch{try{return u.call(null,v,0)}catch{return u.call(this,v,0)}}}function n(v){if(A===clearTimeout)return clearTimeout(v);if((A===e||!A)&&clearTimeout)return A=clearTimeout,clearTimeout(v);try{return A(v)}catch{try{return A.call(null,v)}catch{return A.call(this,v)}}}var a=[],r=!1,f,o=-1;function s(){!r||!f||(r=!1,f.length?a=f.concat(a):o=-1,a.length&&m())}function m(){if(!r){var v=i(s);r=!0;for(var x=a.length;x;){for(f=a,a=[];++o<x;)f&&f[o].run();o=-1,x=a.length}f=null,r=!1,n(v)}}h.nextTick=function(v){var x=new Array(arguments.length-1);if(arguments.length>1)for(var l=1;l<arguments.length;l++)x[l-1]=arguments[l];a.push(new g(v,x)),a.length===1&&!r&&i(m)};function g(v,x){this.fun=v,this.array=x}g.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={};function p(){}h.on=p,h.addListener=p,h.once=p,h.off=p,h.removeListener=p,h.removeAllListeners=p,h.emit=p,h.prependListener=p,h.prependOnceListener=p,h.listeners=function(v){return[]},h.binding=function(v){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(v){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],279:[function(t,P,R){(function(h){(function(){for(var u=t("performance-now"),A=typeof window>"u"?h:window,T=["moz","webkit"],e="AnimationFrame",i=A["request"+e],n=A["cancel"+e]||A["cancelRequest"+e],a=0;!i&&a<T.length;a++)i=A[T[a]+"Request"+e],n=A[T[a]+"Cancel"+e]||A[T[a]+"CancelRequest"+e];if(!i||!n){var r=0,f=0,o=[],s=1e3/60;i=function(m){if(o.length===0){var g=u(),p=Math.max(0,s-(g-r));r=p+g,setTimeout(function(){var v=o.slice(0);o.length=0;for(var x=0;x<v.length;x++)if(!v[x].cancelled)try{v[x].callback(r)}catch(l){setTimeout(function(){throw l},0)}},Math.round(p))}return o.push({handle:++f,callback:m,cancelled:!1}),f},n=function(m){for(var g=0;g<o.length;g++)o[g].handle===m&&(o[g].cancelled=!0)}}P.exports=function(m){return i.call(A,m)},P.exports.cancel=function(){n.apply(A,arguments)},P.exports.polyfill=function(m){m||(m=A),m.requestAnimationFrame=i,m.cancelAnimationFrame=n}}).call(this)}).call(this,typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{"performance-now":252}],280:[function(t,P,R){var h=t("array-bounds"),u=t("color-normalize"),A=t("update-diff"),T=t("pick-by-alias"),e=t("object-assign"),i=t("flatten-vertex-data"),n=t("to-float32"),a=n.float32,r=n.fract32;P.exports=o;var f=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]];function o(s,m){if(typeof s=="function"?(m||(m={}),m.regl=s):m=s,m.length&&(m.positions=m),s=m.regl,!s.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var g=s._gl,p,v,x,l,b,c,M={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},_=[];return l=s.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),v=s.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),x=s.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),b=s.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),c=s.buffer({usage:"static",type:"float",data:f}),C(m),p=s({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:s.prop("range"),lineWidth:s.prop("lineWidth"),capSize:s.prop("capSize"),opacity:s.prop("opacity"),scale:s.prop("scale"),translate:s.prop("translate"),scaleFract:s.prop("scaleFract"),translateFract:s.prop("translateFract"),viewport:function(E,k){return[k.viewport.x,k.viewport.y,E.viewportWidth,E.viewportHeight]}},attributes:{color:{buffer:l,offset:function(E,k){return k.offset*4},divisor:1},position:{buffer:v,offset:function(E,k){return k.offset*8},divisor:1},positionFract:{buffer:x,offset:function(E,k){return k.offset*8},divisor:1},error:{buffer:b,offset:function(E,k){return k.offset*16},divisor:1},direction:{buffer:c,stride:24,offset:0},lineOffset:{buffer:c,stride:24,offset:8},capOffset:{buffer:c,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:s.prop("viewport")},viewport:s.prop("viewport"),stencil:!1,instances:s.prop("count"),count:f.length}),e(y,{update:C,draw:w,destroy:S,regl:s,gl:g,canvas:g.canvas,groups:_}),y;function y(E){E?C(E):E===null&&S(),w()}function w(E){if(typeof E=="number")return d(E);E&&!Array.isArray(E)&&(E=[E]),s._refresh(),_.forEach(function(k,B){if(!!k){if(E&&(E[B]?k.draw=!0:k.draw=!1),!k.draw){k.draw=!0;return}d(B)}})}function d(E){typeof E=="number"&&(E=_[E]),E!=null&&(!(E&&E.count&&E.color&&E.opacity&&E.positions&&E.positions.length>1)||(E.scaleRatio=[E.scale[0]*E.viewport.width,E.scale[1]*E.viewport.height],p(E),E.after&&E.after(E)))}function C(E){if(!!E){E.length!=null?typeof E[0]=="number"&&(E=[{positions:E}]):Array.isArray(E)||(E=[E]);var k=0,B=0;if(y.groups=_=E.map(function(H,j){var Z=_[j];if(H)typeof H=="function"?H={after:H}:typeof H[0]=="number"&&(H={positions:H});else return Z;return H=T(H,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),Z||(_[j]=Z={id:j,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},H=e({},M,H)),A(Z,H,[{lineWidth:function(X){return+X*.5},capSize:function(X){return+X*.5},opacity:parseFloat,errors:function(X){return X=i(X),B+=X.length,X},positions:function(X,re){return X=i(X,"float64"),re.count=Math.floor(X.length/2),re.bounds=h(X,2),re.offset=k,k+=re.count,X}},{color:function(X,re){var ue=re.count;if(X||(X="transparent"),!Array.isArray(X)||typeof X[0]=="number"){var K=X;X=Array(ue);for(var te=0;te<ue;te++)X[te]=K}if(X.length<ue)throw Error("Not enough colors");for(var G=new Uint8Array(ue*4),Y=0;Y<ue;Y++){var ee=u(X[Y],"uint8");G.set(ee,Y*4)}return G},range:function(X,re,ue){var K=re.bounds;return X||(X=K),re.scale=[1/(X[2]-X[0]),1/(X[3]-X[1])],re.translate=[-X[0],-X[1]],re.scaleFract=r(re.scale),re.translateFract=r(re.translate),X},viewport:function(X){var re;return Array.isArray(X)?re={x:X[0],y:X[1],width:X[2]-X[0],height:X[3]-X[1]}:X?(re={x:X.x||X.left||0,y:X.y||X.top||0},X.right?re.width=X.right-re.x:re.width=X.w||X.width||0,X.bottom?re.height=X.bottom-re.y:re.height=X.h||X.height||0):re={x:0,y:0,width:g.drawingBufferWidth,height:g.drawingBufferHeight},re}}]),Z}),k||B){var z=_.reduce(function(H,j,Z){return H+(j?j.count:0)},0),F=new Float64Array(z*2),I=new Uint8Array(z*4),O=new Float32Array(z*4);_.forEach(function(H,j){if(!!H){var Z=H.positions,X=H.count,re=H.offset,ue=H.color,K=H.errors;!X||(I.set(ue,re*4),O.set(K,re*4),F.set(Z,re*2))}});var N=a(F);v(N);var V=r(F,N);x(V),l(I),b(O)}}}function S(){v.destroy(),x.destroy(),l.destroy(),b.destroy(),c.destroy()}}},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":314,"update-diff":330}],281:[function(t,P,R){var h=t("color-normalize"),u=t("array-bounds"),A=t("object-assign"),T=t("glslify"),e=t("pick-by-alias"),i=t("flatten-vertex-data"),n=t("earcut"),a=t("array-normalize"),r=t("to-float32"),f=r.float32,o=r.fract32,s=t("es6-weak-map"),m=t("parse-rect"),g=t("array-find-index");P.exports=p;function p(v,x){if(!(this instanceof p))return new p(v,x);if(typeof v=="function"?(x||(x={}),x.regl=v):x=v,x.length&&(x.positions=x),v=x.regl,!v.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=v._gl,this.regl=v,this.passes=[],this.shaders=p.shaders.has(v)?p.shaders.get(v):p.shaders.set(v,p.createShaders(v)).get(v),this.update(x)}p.dashMult=2,p.maxPatternLength=256,p.precisionThreshold=3e6,p.maxPoints=1e4,p.maxLines=2048,p.shaders=new s,p.createShaders=function(v){var x=v.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),l={primitive:"triangle strip",instances:v.prop("count"),count:4,offset:0,uniforms:{miterMode:function(_,y){return y.join==="round"?2:1},miterLimit:v.prop("miterLimit"),scale:v.prop("scale"),scaleFract:v.prop("scaleFract"),translateFract:v.prop("translateFract"),translate:v.prop("translate"),thickness:v.prop("thickness"),dashTexture:v.prop("dashTexture"),opacity:v.prop("opacity"),pixelRatio:v.context("pixelRatio"),id:v.prop("id"),dashLength:v.prop("dashLength"),viewport:function(_,y){return[y.viewport.x,y.viewport.y,_.viewportWidth,_.viewportHeight]},depth:v.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(_,y){return!y.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:v.prop("viewport")},viewport:v.prop("viewport")},b=v(A({vert:T([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:T([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:x,divisor:0,stride:8,offset:0},lineTop:{buffer:x,divisor:0,stride:8,offset:4},aCoord:{buffer:v.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:v.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:v.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:v.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:v.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},l)),c;try{c=v(A({cull:{enable:!0,face:"back"},vert:T([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:T([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:x,divisor:0,stride:8,offset:0},lineTop:{buffer:x,divisor:0,stride:8,offset:4},aColor:{buffer:v.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:v.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:v.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:v.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:v.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:v.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},l))}catch{c=b}var M=v({primitive:"triangle",elements:function(_,y){return y.triangles},offset:0,vert:T([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:T([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:v.prop("scale"),color:v.prop("fill"),scaleFract:v.prop("scaleFract"),translateFract:v.prop("translateFract"),translate:v.prop("translate"),opacity:v.prop("opacity"),pixelRatio:v.context("pixelRatio"),id:v.prop("id"),viewport:function(_,y){return[y.viewport.x,y.viewport.y,_.viewportWidth,_.viewportHeight]}},attributes:{position:{buffer:v.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:v.prop("positionFractBuffer"),stride:8,offset:8}},blend:l.blend,depth:{enable:!1},scissor:l.scissor,stencil:l.stencil,viewport:l.viewport});return{fill:M,rect:b,miter:c}},p.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},p.prototype.render=function(){for(var v,x=[],l=arguments.length;l--;)x[l]=arguments[l];x.length&&(v=this).update.apply(v,x),this.draw()},p.prototype.draw=function(){for(var v=this,x=[],l=arguments.length;l--;)x[l]=arguments[l];return(x.length?x:this.passes).forEach(function(b,c){var M;if(b&&Array.isArray(b))return(M=v).draw.apply(M,b);typeof b=="number"&&(b=v.passes[b]),b&&b.count>1&&b.opacity&&(v.regl._refresh(),b.fill&&b.triangles&&b.triangles.length>2&&v.shaders.fill(b),b.thickness&&(b.scale[0]*b.viewport.width>p.precisionThreshold||b.scale[1]*b.viewport.height>p.precisionThreshold||b.join==="rect"||!b.join&&(b.thickness<=2||b.count>=p.maxPoints)?v.shaders.rect(b):v.shaders.miter(b)))}),this},p.prototype.update=function(v){var x=this;if(!!v){v.length!=null?typeof v[0]=="number"&&(v=[{positions:v}]):Array.isArray(v)||(v=[v]);var l=this,b=l.regl,c=l.gl;if(v.forEach(function(d,C){var S=x.passes[C];if(d!==void 0){if(d===null){x.passes[C]=null;return}if(typeof d[0]=="number"&&(d={positions:d}),d=e(d,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),S||(x.passes[C]=S={id:C,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:b.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:b.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:b.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:b.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},d=A({},p.defaults,d)),d.thickness!=null&&(S.thickness=parseFloat(d.thickness)),d.opacity!=null&&(S.opacity=parseFloat(d.opacity)),d.miterLimit!=null&&(S.miterLimit=parseFloat(d.miterLimit)),d.overlay!=null&&(S.overlay=!!d.overlay,C<p.maxLines&&(S.depth=2*(p.maxLines-1-C%p.maxLines)/p.maxLines-1)),d.join!=null&&(S.join=d.join),d.hole!=null&&(S.hole=d.hole),d.fill!=null&&(S.fill=d.fill?h(d.fill,"uint8"):null),d.viewport!=null&&(S.viewport=m(d.viewport)),S.viewport||(S.viewport=m([c.drawingBufferWidth,c.drawingBufferHeight])),d.close!=null&&(S.close=d.close),d.positions===null&&(d.positions=[]),d.positions){var E,k;if(d.positions.x&&d.positions.y){var B=d.positions.x,z=d.positions.y;k=S.count=Math.max(B.length,z.length),E=new Float64Array(k*2);for(var F=0;F<k;F++)E[F*2]=B[F],E[F*2+1]=z[F]}else E=i(d.positions,"float64"),k=S.count=Math.floor(E.length/2);var I=S.bounds=u(E,2);if(S.fill){for(var O=[],N={},V=0,H=0,j=0,Z=S.count;H<Z;H++){var X=E[H*2],re=E[H*2+1];isNaN(X)||isNaN(re)||X==null||re==null?(X=E[V*2],re=E[V*2+1],N[H]=V):V=H,O[j++]=X,O[j++]=re}if(d.splitNull){S.count-1 in N||(N[S.count]=S.count-1);var ue=Object.keys(N).map(Number).sort(function(Ze,nt){return Ze-nt}),K=[],te=0,G=S.hole!=null?S.hole[0]:null;if(G!=null){var Y=g(ue,function(Ze){return Ze>=G});ue=ue.slice(0,Y),ue.push(G)}for(var ee=function(Ze){var nt=O.slice(te*2,ue[Ze]*2).concat(G?O.slice(G*2):[]),Ye=(S.hole||[]).map(function(Ge){return Ge-G+(ue[Ze]-te)}),Ee=n(nt,Ye);Ee=Ee.map(function(Ge){return Ge+te+(Ge+te<ue[Ze]?0:G-ue[Ze])}),K.push.apply(K,Ee),te=ue[Ze]+1},ne=0;ne<ue.length;ne++)ee(ne);for(var J=0,q=K.length;J<q;J++)N[K[J]]!=null&&(K[J]=N[K[J]]);S.triangles=K}else{for(var ae=n(O,S.hole||[]),le=0,ie=ae.length;le<ie;le++)N[ae[le]]!=null&&(ae[le]=N[ae[le]]);S.triangles=ae}}var se=new Float64Array(E);a(se,2,I);var xe=new Float64Array(k*2+6);S.close?E[0]===E[k*2-2]&&E[1]===E[k*2-1]?(xe[0]=se[k*2-4],xe[1]=se[k*2-3]):(xe[0]=se[k*2-2],xe[1]=se[k*2-1]):(xe[0]=se[0],xe[1]=se[1]),xe.set(se,2),S.close?E[0]===E[k*2-2]&&E[1]===E[k*2-1]?(xe[k*2+2]=se[2],xe[k*2+3]=se[3],S.count-=1):(xe[k*2+2]=se[0],xe[k*2+3]=se[1],xe[k*2+4]=se[2],xe[k*2+5]=se[3]):(xe[k*2+2]=se[k*2-2],xe[k*2+3]=se[k*2-1],xe[k*2+4]=se[k*2-2],xe[k*2+5]=se[k*2-1]);var oe=f(xe);S.positionBuffer(oe);var he=o(xe,oe);S.positionFractBuffer(he)}if(d.range?S.range=d.range:S.range||(S.range=S.bounds),(d.range||d.positions)&&S.count){var be=S.bounds,me=be[2]-be[0],_e=be[3]-be[1],Se=S.range[2]-S.range[0],De=S.range[3]-S.range[1];S.scale=[me/Se,_e/De],S.translate=[-S.range[0]/Se+be[0]/Se||0,-S.range[1]/De+be[1]/De||0],S.scaleFract=o(S.scale),S.translateFract=o(S.translate)}if(d.dashes){var Ie=0,Te;if(!d.dashes||d.dashes.length<2)Ie=1,Te=new Uint8Array([255,255,255,255,255,255,255,255]);else{Ie=0;for(var Ce=0;Ce<d.dashes.length;++Ce)Ie+=d.dashes[Ce];Te=new Uint8Array(Ie*p.dashMult);for(var He=0,Xe=255,Be=0;Be<2;Be++)for(var Re=0;Re<d.dashes.length;++Re){for(var We=0,vt=d.dashes[Re]*p.dashMult*.5;We<vt;++We)Te[He++]=Xe;Xe^=255}}S.dashLength=Ie,S.dashTexture({channels:1,data:Te,width:Te.length,height:1,mag:"linear",min:"linear"},0,0)}if(d.color){var Pt=S.count,Zt=d.color;Zt||(Zt="transparent");var zt=new Uint8Array(Pt*4+4);if(!Array.isArray(Zt)||typeof Zt[0]=="number")for(var At=h(Zt,"uint8"),Wt=0;Wt<Pt+1;Wt++)zt.set(At,Wt*4);else{for(var Bt=0;Bt<Pt;Bt++){var Ct=h(Zt[Bt],"uint8");zt.set(Ct,Bt*4)}zt.set(h(Zt[0],"uint8"),Pt*4)}S.colorBuffer({usage:"dynamic",type:"uint8",data:zt})}}}),v.length<this.passes.length){for(var M=v.length;M<this.passes.length;M++){var _=this.passes[M];!_||(_.colorBuffer.destroy(),_.positionBuffer.destroy(),_.dashTexture.destroy())}this.passes.length=v.length}for(var y=[],w=0;w<this.passes.length;w++)this.passes[w]!==null&&y.push(this.passes[w]);return this.passes=y,this}},p.prototype.destroy=function(){return this.passes.forEach(function(v){v.colorBuffer.destroy(),v.positionBuffer.destroy(),v.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314}],282:[function(t,P,R){function h(S,E){return T(S)||i(S,E)||n(S,E)||f()}function u(S){return A(S)||e(S)||n(S)||r()}function A(S){if(Array.isArray(S))return a(S)}function T(S){if(Array.isArray(S))return S}function e(S){if(typeof Symbol<"u"&&S[Symbol.iterator]!=null||S["@@iterator"]!=null)return Array.from(S)}function i(S,E){var k=S==null?null:typeof Symbol<"u"&&S[Symbol.iterator]||S["@@iterator"];if(k!=null){var B=[],z=!0,F=!1,I,O;try{for(k=k.call(S);!(z=(I=k.next()).done)&&(B.push(I.value),!(E&&B.length===E));z=!0);}catch(N){F=!0,O=N}finally{try{!z&&k.return!=null&&k.return()}finally{if(F)throw O}}return B}}function n(S,E){if(!!S){if(typeof S=="string")return a(S,E);var k=Object.prototype.toString.call(S).slice(8,-1);if(k==="Object"&&S.constructor&&(k=S.constructor.name),k==="Map"||k==="Set")return Array.from(S);if(k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return a(S,E)}}function a(S,E){(E==null||E>S.length)&&(E=S.length);for(var k=0,B=new Array(E);k<E;k++)B[k]=S[k];return B}function r(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=t("color-normalize"),s=t("array-bounds"),m=t("color-id"),g=t("@plotly/point-cluster"),p=t("object-assign"),v=t("glslify"),x=t("pick-by-alias"),l=t("update-diff"),b=t("flatten-vertex-data"),c=t("is-iexplorer"),M=t("to-float32"),_=t("parse-rect"),y=w;function w(S,E){var k=this;if(!(this instanceof w))return new w(S,E);typeof S=="function"?(E||(E={}),E.regl=S):(E=S,S=null),E&&E.length&&(E.positions=E),S=E.regl;var B=S._gl,z,F=[],I={},O=[],N=[null],V=[null],H=255,j=100;this.tooManyColors=c,z=S.texture({data:new Uint8Array(H*4),width:H,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),p(this,{regl:S,gl:B,groups:O,markerCache:V,markerTextures:N,palette:F,paletteIds:I,paletteTexture:z,maxColors:H,maxSize:j,canvas:B.canvas}),this.update(E);var Z={uniforms:{constPointSize:!!E.constPointSize,opacity:S.prop("opacity"),paletteSize:function(K,te){return[k.tooManyColors?0:H,z.height]},pixelRatio:S.context("pixelRatio"),scale:S.prop("scale"),scaleFract:S.prop("scaleFract"),translate:S.prop("translate"),translateFract:S.prop("translateFract"),markerTexture:S.prop("markerTexture"),paletteTexture:z},attributes:{x:function(K,te){return te.xAttr||{buffer:te.positionBuffer,stride:8,offset:0}},y:function(K,te){return te.yAttr||{buffer:te.positionBuffer,stride:8,offset:4}},xFract:function(K,te){return te.xAttr?{constant:[0,0]}:{buffer:te.positionFractBuffer,stride:8,offset:0}},yFract:function(K,te){return te.yAttr?{constant:[0,0]}:{buffer:te.positionFractBuffer,stride:8,offset:4}},size:function(K,te){return te.size.length?{buffer:te.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(te.size*255/k.maxSize)]}},borderSize:function(K,te){return te.borderSize.length?{buffer:te.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(te.borderSize*255/k.maxSize)]}},colorId:function(K,te){return te.color.length?{buffer:te.colorBuffer,stride:k.tooManyColors?8:4,offset:0}:{constant:k.tooManyColors?F.slice(te.color*4,te.color*4+4):[te.color]}},borderColorId:function(K,te){return te.borderColor.length?{buffer:te.colorBuffer,stride:k.tooManyColors?8:4,offset:k.tooManyColors?4:2}:{constant:k.tooManyColors?F.slice(te.borderColor*4,te.borderColor*4+4):[te.borderColor]}},isActive:function(K,te){return te.activation===!0?{constant:[1]}:te.activation?te.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:S.prop("viewport")},viewport:S.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:S.prop("elements"),count:S.prop("count"),offset:S.prop("offset"),primitive:"points"},X=p({},Z);X.frag=v([`precision highp float;
#define GLSLIFY 1

uniform float opacity;
uniform sampler2D markerTexture;

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),X.vert=v([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform sampler2D paletteTexture;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=S(X);var re=p({},Z);re.frag=v([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

uniform float opacity;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),re.vert=v([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 paletteSize, scale, scaleFract, translate, translateFract;
uniform sampler2D paletteTexture;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),c&&(re.frag=re.frag.replace("smoothstep","smoothStep"),X.frag=X.frag.replace("smoothstep","smoothStep")),this.drawCircle=S(re)}w.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},w.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},w.prototype.draw=function(){for(var S=this,E=arguments.length,k=new Array(E),B=0;B<E;B++)k[B]=arguments[B];var z=this.groups;if(k.length===1&&Array.isArray(k[0])&&(k[0][0]===null||Array.isArray(k[0][0]))&&(k=k[0]),this.regl._refresh(),k.length)for(var F=0;F<k.length;F++)this.drawItem(F,k[F]);else z.forEach(function(I,O){S.drawItem(O)});return this},w.prototype.drawItem=function(S,E){var k=this.groups,B=k[S];if(typeof E=="number"&&(S=E,B=k[E],E=null),!!(B&&B.count&&B.opacity)){B.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,B,E));for(var z=[],F=1;F<B.activation.length;F++)!B.activation[F]||B.activation[F]!==!0&&!B.activation[F].data.length||z.push.apply(z,u(this.getMarkerDrawOptions(F,B,E)));z.length&&this.drawMarker(z)}},w.prototype.getMarkerDrawOptions=function(S,E,k){var B=E.range,z=E.tree,F=E.viewport,I=E.activation,O=E.selectionBuffer,N=E.count;if(this.regl,!z)return k?[p({},E,{markerTexture:this.markerTextures[S],activation:I[S],count:k.length,elements:k,offset:0})]:[p({},E,{markerTexture:this.markerTextures[S],activation:I[S],offset:0})];var V=[],H=z.range(B,{lod:!0,px:[(B[2]-B[0])/F.width,(B[3]-B[1])/F.height]});if(k){for(var j=I[S],Z=j.data,X=new Uint8Array(N),re=0;re<k.length;re++){var ue=k[re];X[ue]=Z?Z[ue]:1}O.subdata(X)}for(var K=H.length;K--;){var te=h(H[K],2),G=te[0],Y=te[1];V.push(p({},E,{markerTexture:this.markerTextures[S],activation:k?O:I[S],offset:G,count:Y-G}))}return V},w.prototype.update=function(){for(var S=this,E=arguments.length,k=new Array(E),B=0;B<E;B++)k[B]=arguments[B];if(!!k.length){k.length===1&&Array.isArray(k[0])&&(k=k[0]);var z=this.groups,F=this.gl,I=this.regl,O=this.maxSize,N=this.maxColors,V=this.palette;this.groups=z=k.map(function(H,j){var Z=z[j];if(H===void 0)return Z;H===null?H={positions:null}:typeof H=="function"?H={ondraw:H}:typeof H[0]=="number"&&(H={positions:H}),H=x(H,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"}),H.positions===null&&(H.positions=[]),H.tooManyColors!=null&&(S.tooManyColors=H.tooManyColors),Z||(z[j]=Z={id:j,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:I.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:I.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:I.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:I.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:I.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},H=p({},w.defaults,H)),H.positions&&!("marker"in H)&&(H.marker=Z.marker,delete Z.marker),H.marker&&!("positions"in H)&&(H.positions=Z.positions,delete Z.positions);var X=0,re=0;if(l(Z,H,[{snap:!0,size:function(_e,Se){return _e==null&&(_e=w.defaults.size),X+=_e&&_e.length?1:0,_e},borderSize:function(_e,Se){return _e==null&&(_e=w.defaults.borderSize),X+=_e&&_e.length?1:0,_e},opacity:parseFloat,color:function(_e,Se){return _e==null&&(_e=w.defaults.color),_e=S.updateColor(_e),re++,_e},borderColor:function(_e,Se){return _e==null&&(_e=w.defaults.borderColor),_e=S.updateColor(_e),re++,_e},bounds:function(_e,Se,De){return"range"in De||(De.range=null),_e},positions:function(_e,Se,De){var Ie=Se.snap,Te=Se.positionBuffer,Ce=Se.positionFractBuffer,He=Se.selectionBuffer;if(_e.x||_e.y)return _e.x.length?Se.xAttr={buffer:I.buffer(_e.x),offset:0,stride:4,count:_e.x.length}:Se.xAttr={buffer:_e.x.buffer,offset:_e.x.offset*4||0,stride:(_e.x.stride||1)*4,count:_e.x.count},_e.y.length?Se.yAttr={buffer:I.buffer(_e.y),offset:0,stride:4,count:_e.y.length}:Se.yAttr={buffer:_e.y.buffer,offset:_e.y.offset*4||0,stride:(_e.y.stride||1)*4,count:_e.y.count},Se.count=Math.max(Se.xAttr.count,Se.yAttr.count),_e;_e=b(_e,"float64");var Xe=Se.count=Math.floor(_e.length/2),Be=Se.bounds=Xe?s(_e,2):null;if(!De.range&&!Se.range&&(delete Se.range,De.range=Be),!De.marker&&!Se.marker&&(delete Se.marker,De.marker=null),Ie&&(Ie===!0||Xe>Ie)?Se.tree=g(_e,{bounds:Be}):Ie&&Ie.length&&(Se.tree=Ie),Se.tree){var Re={primitive:"points",usage:"static",data:Se.tree,type:"uint32"};Se.elements?Se.elements(Re):Se.elements=I.elements(Re)}var We=M.float32(_e);Te({data:We,usage:"dynamic"});var vt=M.fract32(_e,We);return Ce({data:vt,usage:"dynamic"}),He({data:new Uint8Array(Xe),type:"uint8",usage:"stream"}),_e}},{marker:function(_e,Se,De){var Ie=Se.activation;if(Ie.forEach(function(vt){return vt&&vt.destroy&&vt.destroy()}),Ie.length=0,!_e||typeof _e[0]=="number"){var Te=S.addMarker(_e);Ie[Te]=!0}else{for(var Ce=[],He=0,Xe=Math.min(_e.length,Se.count);He<Xe;He++){var Be=S.addMarker(_e[He]);Ce[Be]||(Ce[Be]=new Uint8Array(Se.count)),Ce[Be][He]=1}for(var Re=0;Re<Ce.length;Re++)if(!!Ce[Re]){var We={data:Ce[Re],type:"uint8",usage:"static"};Ie[Re]?Ie[Re](We):Ie[Re]=I.buffer(We),Ie[Re].data=Ce[Re]}}return _e},range:function(_e,Se,De){var Ie=Se.bounds;if(!!Ie)return _e||(_e=Ie),Se.scale=[1/(_e[2]-_e[0]),1/(_e[3]-_e[1])],Se.translate=[-_e[0],-_e[1]],Se.scaleFract=M.fract(Se.scale),Se.translateFract=M.fract(Se.translate),_e},viewport:function(_e){var Se=_(_e||[F.drawingBufferWidth,F.drawingBufferHeight]);return Se}}]),X){var ue=Z,K=ue.count,te=ue.size,G=ue.borderSize,Y=ue.sizeBuffer,ee=new Uint8Array(K*2);if(te.length||G.length)for(var ne=0;ne<K;ne++)ee[ne*2]=Math.round((te[ne]==null?te:te[ne])*255/O),ee[ne*2+1]=Math.round((G[ne]==null?G:G[ne])*255/O);Y({data:ee,usage:"dynamic"})}if(re){var J=Z,q=J.count,ae=J.color,le=J.borderColor,ie=J.colorBuffer,se;if(S.tooManyColors){if(ae.length||le.length){se=new Uint8Array(q*8);for(var xe=0;xe<q;xe++){var oe=ae[xe];se[xe*8]=V[oe*4],se[xe*8+1]=V[oe*4+1],se[xe*8+2]=V[oe*4+2],se[xe*8+3]=V[oe*4+3];var he=le[xe];se[xe*8+4]=V[he*4],se[xe*8+5]=V[he*4+1],se[xe*8+6]=V[he*4+2],se[xe*8+7]=V[he*4+3]}}}else if(ae.length||le.length){se=new Uint8Array(q*4+2);for(var be=0;be<q;be++)ae[be]!=null&&(se[be*4]=ae[be]%N,se[be*4+1]=Math.floor(ae[be]/N)),le[be]!=null&&(se[be*4+2]=le[be]%N,se[be*4+3]=Math.floor(le[be]/N))}ie({data:se||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return Z})}},w.prototype.addMarker=function(S){var E=this.markerTextures,k=this.regl,B=this.markerCache,z=S==null?0:B.indexOf(S);if(z>=0)return z;var F;if(S instanceof Uint8Array||S instanceof Uint8ClampedArray)F=S;else{F=new Uint8Array(S.length);for(var I=0,O=S.length;I<O;I++)F[I]=S[I]*255}var N=Math.floor(Math.sqrt(F.length));return z=E.length,B.push(S),E.push(k.texture({channels:1,data:F,radius:N,mag:"linear",min:"linear"})),z},w.prototype.updateColor=function(S){var E=this.paletteIds,k=this.palette,B=this.maxColors;Array.isArray(S)||(S=[S]);var z=[];if(typeof S[0]=="number"){var F=[];if(Array.isArray(S))for(var I=0;I<S.length;I+=4)F.push(S.slice(I,I+4));else for(var O=0;O<S.length;O+=4)F.push(S.subarray(O,O+4));S=F}for(var N=0;N<S.length;N++){var V=S[N];V=o(V,"uint8");var H=m(V,!1);if(E[H]==null){var j=k.length;E[H]=Math.floor(j/4),k[j]=V[0],k[j+1]=V[1],k[j+2]=V[2],k[j+3]=V[3]}z[N]=E[H]}return!this.tooManyColors&&k.length>B*4&&(this.tooManyColors=!0),this.updatePalette(k),z.length===1?z[0]:z},w.prototype.updatePalette=function(S){if(!this.tooManyColors){var E=this.maxColors,k=this.paletteTexture,B=Math.ceil(S.length*.25/E);if(B>1){S=S.slice();for(var z=S.length*.25%E;z<B*E;z++)S.push(0,0,0,0)}k.height<B&&k.resize(E,B),k.subimage({width:Math.min(S.length*.25,E),height:B,data:S},0,0)}},w.prototype.destroy=function(){return this.groups.forEach(function(S){S.sizeBuffer.destroy(),S.positionBuffer.destroy(),S.positionFractBuffer.destroy(),S.colorBuffer.destroy(),S.activation.forEach(function(E){return E&&E.destroy&&E.destroy()}),S.selectionBuffer.destroy(),S.elements&&S.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(S){return S&&S.destroy&&S.destroy()}),this};var d=t("object-assign"),C=function(E,k){var B=new y(E,k),z=B.render.bind(B);return d(z,{render:z,update:B.update.bind(B),draw:B.draw.bind(B),destroy:B.destroy.bind(B),regl:B.regl,gl:B.gl,canvas:B.gl.canvas,groups:B.groups,markers:B.markerCache,palette:B.palette}),z};P.exports=C},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314,"update-diff":330}],283:[function(t,P,R){var h=t("regl-scatter2d"),u=t("pick-by-alias"),A=t("array-bounds"),T=t("raf"),e=t("array-range"),i=t("parse-rect"),n=t("flatten-vertex-data");P.exports=a;function a(s,m){if(!(this instanceof a))return new a(s);this.traces=[],this.passes={},this.regl=s,this.scatter=h(s),this.canvas=this.scatter.canvas}a.prototype.render=function(){for(var s=this,m,g=[],p=arguments.length;p--;)g[p]=arguments[p];return g.length&&(m=this).update.apply(m,g),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=T(function(){s.draw(),s.dirty=!0,s.planned=null})):(this.draw(),this.dirty=!0,T(function(){s.dirty=!1})),this)},a.prototype.update=function(){for(var s,m=[],g=arguments.length;g--;)m[g]=arguments[g];if(!!m.length){for(var p=0;p<m.length;p++)this.updateItem(p,m[p]);this.traces=this.traces.filter(Boolean);for(var v=[],x=0,l=0;l<this.traces.length;l++){for(var b=this.traces[l],c=this.traces[l].passes,M=0;M<c.length;M++)v.push(this.passes[c[M]]);b.passOffset=x,x+=b.passes.length}return(s=this.scatter).update.apply(s,v),this}},a.prototype.updateItem=function(s,m){var g=this,p=g.regl;if(m===null)return this.traces[s]=null,this;if(!m)return this;var v=u(m,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),x=this.traces[s]||(this.traces[s]={id:s,buffer:p.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:i([p._gl.drawingBufferWidth,p._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(v.color!=null&&(x.color=v.color),v.size!=null&&(x.size=v.size),v.marker!=null&&(x.marker=v.marker),v.borderColor!=null&&(x.borderColor=v.borderColor),v.borderSize!=null&&(x.borderSize=v.borderSize),v.opacity!=null&&(x.opacity=v.opacity),v.viewport&&(x.viewport=i(v.viewport)),v.diagonal!=null&&(x.diagonal=v.diagonal),v.upper!=null&&(x.upper=v.upper),v.lower!=null&&(x.lower=v.lower),v.data){x.buffer(n(v.data)),x.columns=v.data.length,x.count=v.data[0].length,x.bounds=[];for(var l=0;l<x.columns;l++)x.bounds[l]=A(v.data[l],1)}var b;v.range&&(x.range=v.range,b=x.range&&typeof x.range[0]!="number"),v.domain&&(x.domain=v.domain);var c=!1;v.padding!=null&&(Array.isArray(v.padding)&&v.padding.length===x.columns&&typeof v.padding[v.padding.length-1]=="number"?(x.padding=v.padding.map(o),c=!0):x.padding=o(v.padding));var M=x.columns,_=x.count,y=x.viewport.width,w=x.viewport.height,d=x.viewport.x,C=x.viewport.y,S=y/M,E=w/M;x.passes=[];for(var k=0;k<M;k++)for(var B=0;B<M;B++)if(!(!x.diagonal&&B===k)&&!(!x.upper&&k>B)&&!(!x.lower&&k<B)){var z=r(x.id,k,B),F=this.passes[z]||(this.passes[z]={});if(v.data&&(v.transpose?F.positions={x:{buffer:x.buffer,offset:B,count:_,stride:M},y:{buffer:x.buffer,offset:k,count:_,stride:M}}:F.positions={x:{buffer:x.buffer,offset:B*_,count:_},y:{buffer:x.buffer,offset:k*_,count:_}},F.bounds=f(x.bounds,k,B)),v.domain||v.viewport||v.data){var I=c?f(x.padding,k,B):x.padding;if(x.domain){var O=f(x.domain,k,B),N=O[0],V=O[1],H=O[2],j=O[3];F.viewport=[d+N*y+I[0],C+V*w+I[1],d+H*y-I[2],C+j*w-I[3]]}else F.viewport=[d+B*S+S*I[0],C+k*E+E*I[1],d+(B+1)*S-S*I[2],C+(k+1)*E-E*I[3]]}v.color&&(F.color=x.color),v.size&&(F.size=x.size),v.marker&&(F.marker=x.marker),v.borderSize&&(F.borderSize=x.borderSize),v.borderColor&&(F.borderColor=x.borderColor),v.opacity&&(F.opacity=x.opacity),v.range&&(F.range=b?f(x.range,k,B):x.range||F.bounds),x.passes.push(z)}return this},a.prototype.draw=function(){for(var s,m=[],g=arguments.length;g--;)m[g]=arguments[g];if(!m.length)this.scatter.draw();else{for(var p=[],v=0;v<m.length;v++)if(typeof m[v]=="number"){var x=this.traces[m[v]],l=x.passes,b=x.passOffset;p.push.apply(p,e(b,b+l.length))}else if(m[v].length){var c=m[v],M=this.traces[v],_=M.passes,y=M.passOffset;_=_.map(function(w,d){p[y+d]=c})}(s=this.scatter).draw.apply(s,p)}return this},a.prototype.destroy=function(){return this.traces.forEach(function(s){s.buffer&&s.buffer.destroy&&s.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this};function r(s,m,g){var p=s.id!=null?s.id:s,v=m,x=g,l=p<<16|(v&255)<<8|x&255;return l}function f(s,m,g){var p,v,x,l,b=s[m],c=s[g];return b.length>2?(b[0],b[2],p=b[1],v=b[3]):b.length?(p=b[0],v=b[1]):(b.x,p=b.y,b.x+b.width,v=b.y+b.height),c.length>2?(x=c[0],l=c[2],c[1],c[3]):c.length?(x=c[0],l=c[1]):(x=c.x,c.y,l=c.x+c.width,c.y+c.height),[x,p,l,v]}function o(s){if(typeof s=="number")return[s,s,s,s];if(s.length===2)return[s[0],s[1],s[0],s[1]];var m=i(s);return[m.x,m.y,m.x+m.width,m.y+m.height]}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:279,"regl-scatter2d":282}],284:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?P.exports=u():h.createREGL=u()})(this,function(){function h(ot,er){this.id=xe++,this.type=ot,this.data=er}function u(ot){if(ot.length===0)return[];var er=ot.charAt(0),Kt=ot.charAt(ot.length-1);if(1<ot.length&&er===Kt&&(er==='"'||er==="'"))return['"'+ot.substr(1,ot.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(er=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(ot))return u(ot.substr(0,er.index)).concat(u(er[1])).concat(u(ot.substr(er.index+er[0].length)));if(er=ot.split("."),er.length===1)return['"'+ot.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(ot=[],Kt=0;Kt<er.length;++Kt)ot=ot.concat(u(er[Kt]));return ot}function A(ot){return"["+u(ot).join("][")+"]"}function T(ot,er){if(typeof ot=="function")return new h(0,ot);if(typeof ot=="number"||typeof ot=="boolean")return new h(5,ot);if(Array.isArray(ot))return new h(6,ot.map(function(Kt,ur){return T(Kt)}));if(ot instanceof h)return ot}function e(){var ot={"":0},er=[""];return{id:function(Kt){var ur=ot[Kt];return ur||(ur=ot[Kt]=er.length,er.push(Kt),ur)},str:function(Kt){return er[Kt]}}}function i(ot,er,Kt){function ur(){var $e=window.innerWidth,st=window.innerHeight;ot!==document.body&&(st=Ar.getBoundingClientRect(),$e=st.right-st.left,st=st.bottom-st.top),Ar.width=Kt*$e,Ar.height=Kt*st}var Ar=document.createElement("canvas");se(Ar.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),ot.appendChild(Ar),ot===document.body&&(Ar.style.position="absolute",se(ot.style,{margin:0,padding:0}));var et;return ot!==document.body&&typeof ResizeObserver=="function"?(et=new ResizeObserver(function(){setTimeout(ur)}),et.observe(ot)):window.addEventListener("resize",ur,!1),ur(),{canvas:Ar,onDestroy:function(){et?et.disconnect():window.removeEventListener("resize",ur),ot.removeChild(Ar)}}}function n(ot,er){function Kt(ur){try{return ot.getContext(ur,er)}catch{return null}}return Kt("webgl")||Kt("experimental-webgl")||Kt("webgl-experimental")}function a(ot){return typeof ot=="string"?ot.split():ot}function r(ot){return typeof ot=="string"?document.querySelector(ot):ot}function f(ot){var er=ot||{},Kt,ur,Ar,et;ot={};var $e=[],st=[],ft=typeof window>"u"?1:window.devicePixelRatio,St=!1,Ut={},Pe=function(it){},ke=function(){};if(typeof er=="string"?Kt=document.querySelector(er):typeof er=="object"&&(typeof er.nodeName=="string"&&typeof er.appendChild=="function"&&typeof er.getBoundingClientRect=="function"?Kt=er:typeof er.drawArrays=="function"||typeof er.drawElements=="function"?(et=er,Ar=et.canvas):("gl"in er?et=er.gl:"canvas"in er?Ar=r(er.canvas):"container"in er&&(ur=r(er.container)),"attributes"in er&&(ot=er.attributes),"extensions"in er&&($e=a(er.extensions)),"optionalExtensions"in er&&(st=a(er.optionalExtensions)),"onDone"in er&&(Pe=er.onDone),"profile"in er&&(St=!!er.profile),"pixelRatio"in er&&(ft=+er.pixelRatio),"cachedCode"in er&&(Ut=er.cachedCode))),Kt&&(Kt.nodeName.toLowerCase()==="canvas"?Ar=Kt:ur=Kt),!et){if(!Ar){if(Kt=i(ur||document.body,Pe,ft),!Kt)return null;Ar=Kt.canvas,ke=Kt.onDestroy}ot.premultipliedAlpha===void 0&&(ot.premultipliedAlpha=!0),et=n(Ar,ot)}return et?{gl:et,canvas:Ar,container:ur,extensions:$e,optionalExtensions:st,pixelRatio:ft,profile:St,cachedCode:Ut,onDone:Pe,onDestroy:ke}:(ke(),Pe("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function o(ot,er){function Kt($e){$e=$e.toLowerCase();var st;try{st=ur[$e]=ot.getExtension($e)}catch{}return!!st}for(var ur={},Ar=0;Ar<er.extensions.length;++Ar){var et=er.extensions[Ar];if(!Kt(et))return er.onDestroy(),er.onDone('"'+et+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return er.optionalExtensions.forEach(Kt),{extensions:ur,restore:function(){Object.keys(ur).forEach(function($e){if(ur[$e]&&!Kt($e))throw Error("(regl): error restoring extension "+$e)})}}}function s(ot,er){for(var Kt=Array(ot),ur=0;ur<ot;++ur)Kt[ur]=er(ur);return Kt}function m(ot){var er,Kt;return er=(65535<ot)<<4,ot>>>=er,Kt=(255<ot)<<3,ot>>>=Kt,er|=Kt,Kt=(15<ot)<<2,ot>>>=Kt,er|=Kt,Kt=(3<ot)<<1,er|Kt|ot>>>Kt>>1}function g(){function ot(ur){e:{for(var Ar=16;268435456>=Ar;Ar*=16)if(ur<=Ar){ur=Ar;break e}ur=0}return Ar=Kt[m(ur)>>2],0<Ar.length?Ar.pop():new ArrayBuffer(ur)}function er(ur){Kt[m(ur.byteLength)>>2].push(ur)}var Kt=s(8,function(){return[]});return{alloc:ot,free:er,allocType:function(ur,Ar){var et=null;switch(ur){case 5120:et=new Int8Array(ot(Ar),0,Ar);break;case 5121:et=new Uint8Array(ot(Ar),0,Ar);break;case 5122:et=new Int16Array(ot(2*Ar),0,Ar);break;case 5123:et=new Uint16Array(ot(2*Ar),0,Ar);break;case 5124:et=new Int32Array(ot(4*Ar),0,Ar);break;case 5125:et=new Uint32Array(ot(4*Ar),0,Ar);break;case 5126:et=new Float32Array(ot(4*Ar),0,Ar);break;default:return null}return et.length!==Ar?et.subarray(0,Ar):et},freeType:function(ur){er(ur.buffer)}}}function p(ot){return!!ot&&typeof ot=="object"&&Array.isArray(ot.shape)&&Array.isArray(ot.stride)&&typeof ot.offset=="number"&&ot.shape.length===ot.stride.length&&(Array.isArray(ot.data)||Se(ot.data))}function v(ot,er,Kt,ur,Ar,et){for(var $e=0;$e<er;++$e)for(var st=ot[$e],ft=0;ft<Kt;++ft)for(var St=st[ft],Ut=0;Ut<ur;++Ut)Ar[et++]=St[Ut]}function x(ot,er,Kt,ur,Ar){for(var et=1,$e=Kt+1;$e<er.length;++$e)et*=er[$e];var st=er[Kt];if(er.length-Kt===4){var ft=er[Kt+1],St=er[Kt+2];for(er=er[Kt+3],$e=0;$e<st;++$e)v(ot[$e],ft,St,er,ur,Ar),Ar+=et}else for($e=0;$e<st;++$e)x(ot[$e],er,Kt+1,ur,Ar),Ar+=et}function l(ot){return Te[Object.prototype.toString.call(ot)]|0}function b(ot,er){for(var Kt=0;Kt<er.length;++Kt)ot[Kt]=er[Kt]}function c(ot,er,Kt,ur,Ar,et,$e){for(var st=0,ft=0;ft<Kt;++ft)for(var St=0;St<ur;++St)ot[st++]=er[Ar*ft+et*St+$e]}function M(ot,er,Kt,ur){function Ar(Pe){this.id=ft++,this.buffer=ot.createBuffer(),this.type=Pe,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,Kt.profile&&(this.stats={size:0})}function et(Pe,ke,it){Pe.byteLength=ke.byteLength,ot.bufferData(Pe.type,ke,it)}function $e(Pe,ke,it,ut,ht,Et){if(Pe.usage=it,Array.isArray(ke)){if(Pe.dtype=ut||5126,0<ke.length)if(Array.isArray(ke[0])){ht=Be(ke);for(var yt=ut=1;yt<ht.length;++yt)ut*=ht[yt];Pe.dimension=ut,ke=Xe(ke,ht,Pe.dtype),et(Pe,ke,it),Et?Pe.persistentData=ke:me.freeType(ke)}else typeof ke[0]=="number"?(Pe.dimension=ht,ht=me.allocType(Pe.dtype,ke.length),b(ht,ke),et(Pe,ht,it),Et?Pe.persistentData=ht:me.freeType(ht)):Se(ke[0])&&(Pe.dimension=ke[0].length,Pe.dtype=ut||l(ke[0])||5126,ke=Xe(ke,[ke.length,ke[0].length],Pe.dtype),et(Pe,ke,it),Et?Pe.persistentData=ke:me.freeType(ke))}else if(Se(ke))Pe.dtype=ut||l(ke),Pe.dimension=ht,et(Pe,ke,it),Et&&(Pe.persistentData=new Uint8Array(new Uint8Array(ke.buffer)));else if(p(ke)){ht=ke.shape;var Dt=ke.stride,yt=ke.offset,Xt=0,ar=0,kr=0,wr=0;ht.length===1?(Xt=ht[0],ar=1,kr=Dt[0],wr=0):ht.length===2&&(Xt=ht[0],ar=ht[1],kr=Dt[0],wr=Dt[1]),Pe.dtype=ut||l(ke.data)||5126,Pe.dimension=ar,ht=me.allocType(Pe.dtype,Xt*ar),c(ht,ke.data,Xt,ar,kr,wr,yt),et(Pe,ht,it),Et?Pe.persistentData=ht:me.freeType(ht)}else ke instanceof ArrayBuffer&&(Pe.dtype=5121,Pe.dimension=ht,et(Pe,ke,it),Et&&(Pe.persistentData=new Uint8Array(new Uint8Array(ke))))}function st(Pe){er.bufferCount--,ur(Pe),ot.deleteBuffer(Pe.buffer),Pe.buffer=null,delete St[Pe.id]}var ft=0,St={};Ar.prototype.bind=function(){ot.bindBuffer(this.type,this.buffer)},Ar.prototype.destroy=function(){st(this)};var Ut=[];return Kt.profile&&(er.getTotalBufferSize=function(){var Pe=0;return Object.keys(St).forEach(function(ke){Pe+=St[ke].stats.size}),Pe}),{create:function(Pe,ke,it,ut){function ht(yt){var Dt=35044,Xt=null,ar=0,kr=0,wr=1;return Array.isArray(yt)||Se(yt)||p(yt)||yt instanceof ArrayBuffer?Xt=yt:typeof yt=="number"?ar=yt|0:yt&&("data"in yt&&(Xt=yt.data),"usage"in yt&&(Dt=He[yt.usage]),"type"in yt&&(kr=Ce[yt.type]),"dimension"in yt&&(wr=yt.dimension|0),"length"in yt&&(ar=yt.length|0)),Et.bind(),Xt?$e(Et,Xt,Dt,kr,wr,ut):(ar&&ot.bufferData(Et.type,ar,Dt),Et.dtype=kr||5121,Et.usage=Dt,Et.dimension=wr,Et.byteLength=ar),Kt.profile&&(Et.stats.size=Et.byteLength*Re[Et.dtype]),ht}er.bufferCount++;var Et=new Ar(ke);return St[Et.id]=Et,it||ht(Pe),ht._reglType="buffer",ht._buffer=Et,ht.subdata=function(yt,Dt){var Xt=(Dt||0)|0,ar;if(Et.bind(),Se(yt)||yt instanceof ArrayBuffer)ot.bufferSubData(Et.type,Xt,yt);else if(Array.isArray(yt)){if(0<yt.length)if(typeof yt[0]=="number"){var kr=me.allocType(Et.dtype,yt.length);b(kr,yt),ot.bufferSubData(Et.type,Xt,kr),me.freeType(kr)}else(Array.isArray(yt[0])||Se(yt[0]))&&(ar=Be(yt),kr=Xe(yt,ar,Et.dtype),ot.bufferSubData(Et.type,Xt,kr),me.freeType(kr))}else if(p(yt)){ar=yt.shape;var wr=yt.stride,Sr=kr=0,Zr=0,ir=0;ar.length===1?(kr=ar[0],Sr=1,Zr=wr[0],ir=0):ar.length===2&&(kr=ar[0],Sr=ar[1],Zr=wr[0],ir=wr[1]),ar=Array.isArray(yt.data)?Et.dtype:l(yt.data),ar=me.allocType(ar,kr*Sr),c(ar,yt.data,kr,Sr,Zr,ir,yt.offset),ot.bufferSubData(Et.type,Xt,ar),me.freeType(ar)}return ht},Kt.profile&&(ht.stats=Et.stats),ht.destroy=function(){st(Et)},ht},createStream:function(Pe,ke){var it=Ut.pop();return it||(it=new Ar(Pe)),it.bind(),$e(it,ke,35040,0,1,!1),it},destroyStream:function(Pe){Ut.push(Pe)},clear:function(){De(St).forEach(st),Ut.forEach(st)},getBuffer:function(Pe){return Pe&&Pe._buffer instanceof Ar?Pe._buffer:null},restore:function(){De(St).forEach(function(Pe){Pe.buffer=ot.createBuffer(),ot.bindBuffer(Pe.type,Pe.buffer),ot.bufferData(Pe.type,Pe.persistentData||Pe.byteLength,Pe.usage)})},_initBuffer:$e}}function _(ot,er,Kt,ur){function Ar(Pe){this.id=ft++,st[this.id]=this,this.buffer=Pe,this.primType=4,this.type=this.vertCount=0}function et(Pe,ke,it,ut,ht,Et,yt){Pe.buffer.bind();var Dt;if(ke?((Dt=yt)||Se(ke)&&(!p(ke)||Se(ke.data))||(Dt=er.oes_element_index_uint?5125:5123),Kt._initBuffer(Pe.buffer,ke,it,Dt,3)):(ot.bufferData(34963,Et,it),Pe.buffer.dtype=Dt||5121,Pe.buffer.usage=it,Pe.buffer.dimension=3,Pe.buffer.byteLength=Et),Dt=yt,!yt){switch(Pe.buffer.dtype){case 5121:case 5120:Dt=5121;break;case 5123:case 5122:Dt=5123;break;case 5125:case 5124:Dt=5125}Pe.buffer.dtype=Dt}Pe.type=Dt,ke=ht,0>ke&&(ke=Pe.buffer.byteLength,Dt===5123?ke>>=1:Dt===5125&&(ke>>=2)),Pe.vertCount=ke,ke=ut,0>ut&&(ke=4,ut=Pe.buffer.dimension,ut===1&&(ke=0),ut===2&&(ke=1),ut===3&&(ke=4)),Pe.primType=ke}function $e(Pe){ur.elementsCount--,delete st[Pe.id],Pe.buffer.destroy(),Pe.buffer=null}var st={},ft=0,St={uint8:5121,uint16:5123};er.oes_element_index_uint&&(St.uint32=5125),Ar.prototype.bind=function(){this.buffer.bind()};var Ut=[];return{create:function(Pe,ke){function it(Et){if(Et)if(typeof Et=="number")ut(Et),ht.primType=4,ht.vertCount=Et|0,ht.type=5121;else{var yt=null,Dt=35044,Xt=-1,ar=-1,kr=0,wr=0;Array.isArray(Et)||Se(Et)||p(Et)?yt=Et:("data"in Et&&(yt=Et.data),"usage"in Et&&(Dt=He[Et.usage]),"primitive"in Et&&(Xt=We[Et.primitive]),"count"in Et&&(ar=Et.count|0),"type"in Et&&(wr=St[Et.type]),"length"in Et?kr=Et.length|0:(kr=ar,wr===5123||wr===5122?kr*=2:(wr===5125||wr===5124)&&(kr*=4))),et(ht,yt,Dt,Xt,ar,kr,wr)}else ut(),ht.primType=4,ht.vertCount=0,ht.type=5121;return it}var ut=Kt.create(null,34963,!0),ht=new Ar(ut._buffer);return ur.elementsCount++,it(Pe),it._reglType="elements",it._elements=ht,it.subdata=function(Et,yt){return ut.subdata(Et,yt),it},it.destroy=function(){$e(ht)},it},createStream:function(Pe){var ke=Ut.pop();return ke||(ke=new Ar(Kt.create(null,34963,!0,!1)._buffer)),et(ke,Pe,35040,-1,-1,0,0),ke},destroyStream:function(Pe){Ut.push(Pe)},getElements:function(Pe){return typeof Pe=="function"&&Pe._elements instanceof Ar?Pe._elements:null},clear:function(){De(st).forEach($e)}}}function y(ot){for(var er=me.allocType(5123,ot.length),Kt=0;Kt<ot.length;++Kt)if(isNaN(ot[Kt]))er[Kt]=65535;else if(ot[Kt]===1/0)er[Kt]=31744;else if(ot[Kt]===-1/0)er[Kt]=64512;else{vt[0]=ot[Kt];var et=Pt[0],ur=et>>>31<<15,Ar=(et<<1>>>24)-127,et=et>>13&1023;er[Kt]=-24>Ar?ur:-14>Ar?ur+(et+1024>>-14-Ar):15<Ar?ur+31744:ur+(Ar+15<<10)+et}return er}function w(ot){return Array.isArray(ot)||Se(ot)}function d(ot){return"[object "+ot+"]"}function C(ot){return Array.isArray(ot)&&(ot.length===0||typeof ot[0]=="number")}function S(ot){return!!(Array.isArray(ot)&&ot.length!==0&&w(ot[0]))}function E(ot){return Object.prototype.toString.call(ot)}function k(ot){if(!ot)return!1;var er=E(ot);return 0<=Ee.indexOf(er)?!0:C(ot)||S(ot)||p(ot)}function B(ot,er){ot.type===36193?(ot.data=y(er),me.freeType(er)):ot.data=er}function z(ot,er,Kt,ur,Ar,et){if(ot=typeof Je[ot]<"u"?Je[ot]:At[ot]*Ge[er],et&&(ot*=6),Ar){for(ur=0;1<=Kt;)ur+=ot*Kt*Kt,Kt/=2;return ur}return ot*Kt*ur}function F(ot,er,Kt,ur,Ar,et,$e){function st(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function ft(Mr,gn){Mr.internalformat=gn.internalformat,Mr.format=gn.format,Mr.type=gn.type,Mr.compressed=gn.compressed,Mr.premultiplyAlpha=gn.premultiplyAlpha,Mr.flipY=gn.flipY,Mr.unpackAlignment=gn.unpackAlignment,Mr.colorSpace=gn.colorSpace,Mr.width=gn.width,Mr.height=gn.height,Mr.channels=gn.channels}function St(Mr,gn){if(typeof gn=="object"&&gn){"premultiplyAlpha"in gn&&(Mr.premultiplyAlpha=gn.premultiplyAlpha),"flipY"in gn&&(Mr.flipY=gn.flipY),"alignment"in gn&&(Mr.unpackAlignment=gn.alignment),"colorSpace"in gn&&(Mr.colorSpace=sr[gn.colorSpace]),"type"in gn&&(Mr.type=zr[gn.type]);var hn=Mr.width,Sn=Mr.height,Jn=Mr.channels,ha=!1;"shape"in gn?(hn=gn.shape[0],Sn=gn.shape[1],gn.shape.length===3&&(Jn=gn.shape[2],ha=!0)):("radius"in gn&&(hn=Sn=gn.radius),"width"in gn&&(hn=gn.width),"height"in gn&&(Sn=gn.height),"channels"in gn&&(Jn=gn.channels,ha=!0)),Mr.width=hn|0,Mr.height=Sn|0,Mr.channels=Jn|0,hn=!1,"format"in gn&&(hn=gn.format,Sn=Mr.internalformat=Ur[hn],Mr.format=Yn[Sn],hn in zr&&!("type"in gn)&&(Mr.type=zr[hn]),hn in Dr&&(Mr.compressed=!0),hn=!0),!ha&&hn?Mr.channels=At[Mr.format]:ha&&!hn&&Mr.channels!==zt[Mr.format]&&(Mr.format=Mr.internalformat=zt[Mr.channels])}}function Ut(Mr){ot.pixelStorei(37440,Mr.flipY),ot.pixelStorei(37441,Mr.premultiplyAlpha),ot.pixelStorei(37443,Mr.colorSpace),ot.pixelStorei(3317,Mr.unpackAlignment)}function Pe(){st.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function ke(Mr,gn){var hn=null;if(k(gn)?hn=gn:gn&&(St(Mr,gn),"x"in gn&&(Mr.xOffset=gn.x|0),"y"in gn&&(Mr.yOffset=gn.y|0),k(gn.data)&&(hn=gn.data)),gn.copy){var Sn=Ar.viewportWidth,Jn=Ar.viewportHeight;Mr.width=Mr.width||Sn-Mr.xOffset,Mr.height=Mr.height||Jn-Mr.yOffset,Mr.needsCopy=!0}else if(!hn)Mr.width=Mr.width||1,Mr.height=Mr.height||1,Mr.channels=Mr.channels||4;else if(Se(hn))Mr.channels=Mr.channels||4,Mr.data=hn,"type"in gn||Mr.type!==5121||(Mr.type=Te[Object.prototype.toString.call(hn)]|0);else if(C(hn)){switch(Mr.channels=Mr.channels||4,Sn=hn,Jn=Sn.length,Mr.type){case 5121:case 5123:case 5125:case 5126:Jn=me.allocType(Mr.type,Jn),Jn.set(Sn),Mr.data=Jn;break;case 36193:Mr.data=y(Sn)}Mr.alignment=1,Mr.needsFree=!0}else if(p(hn)){Sn=hn.data,Array.isArray(Sn)||Mr.type!==5121||(Mr.type=Te[Object.prototype.toString.call(Sn)]|0);var Jn=hn.shape,ha=hn.stride,ra,In,jn,Ga;Jn.length===3?(jn=Jn[2],Ga=ha[2]):Ga=jn=1,ra=Jn[0],In=Jn[1],Jn=ha[0],ha=ha[1],Mr.alignment=1,Mr.width=ra,Mr.height=In,Mr.channels=jn,Mr.format=Mr.internalformat=zt[jn],Mr.needsFree=!0,ra=Ga,hn=hn.offset,jn=Mr.width,Ga=Mr.height,In=Mr.channels;for(var vi=me.allocType(Mr.type===36193?5126:Mr.type,jn*Ga*In),Gt=0,pr=0;pr<Ga;++pr)for(var on=0;on<jn;++on)for(var dn=0;dn<In;++dn)vi[Gt++]=Sn[Jn*on+ha*pr+ra*dn+hn];B(Mr,vi)}else if(E(hn)===Wt||E(hn)===Bt||E(hn)===Ct)E(hn)===Wt||E(hn)===Bt?Mr.element=hn:Mr.element=hn.canvas,Mr.width=Mr.element.width,Mr.height=Mr.element.height,Mr.channels=4;else if(E(hn)===Ze)Mr.element=hn,Mr.width=hn.width,Mr.height=hn.height,Mr.channels=4;else if(E(hn)===nt)Mr.element=hn,Mr.width=hn.naturalWidth,Mr.height=hn.naturalHeight,Mr.channels=4;else if(E(hn)===Ye)Mr.element=hn,Mr.width=hn.videoWidth,Mr.height=hn.videoHeight,Mr.channels=4;else if(S(hn)){for(Sn=Mr.width||hn[0].length,Jn=Mr.height||hn.length,ha=Mr.channels,ha=w(hn[0][0])?ha||hn[0][0].length:ha||1,ra=Ie.shape(hn),jn=1,Ga=0;Ga<ra.length;++Ga)jn*=ra[Ga];jn=me.allocType(Mr.type===36193?5126:Mr.type,jn),Ie.flatten(hn,ra,"",jn),B(Mr,jn),Mr.alignment=1,Mr.width=Sn,Mr.height=Jn,Mr.channels=ha,Mr.format=Mr.internalformat=zt[ha],Mr.needsFree=!0}}function it(Mr,gn,hn,Sn,Jn){var ha=Mr.element,ra=Mr.data,In=Mr.internalformat,jn=Mr.format,Ga=Mr.type,vi=Mr.width,Gt=Mr.height;Ut(Mr),ha?ot.texSubImage2D(gn,Jn,hn,Sn,jn,Ga,ha):Mr.compressed?ot.compressedTexSubImage2D(gn,Jn,hn,Sn,In,vi,Gt,ra):Mr.needsCopy?(ur(),ot.copyTexSubImage2D(gn,Jn,hn,Sn,Mr.xOffset,Mr.yOffset,vi,Gt)):ot.texSubImage2D(gn,Jn,hn,Sn,vi,Gt,jn,Ga,ra)}function ut(){return ya.pop()||new Pe}function ht(Mr){Mr.needsFree&&me.freeType(Mr.data),Pe.call(Mr),ya.push(Mr)}function Et(){st.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function yt(Mr,gn,hn){var Sn=Mr.images[0]=ut();Mr.mipmask=1,Sn.width=Mr.width=gn,Sn.height=Mr.height=hn,Sn.channels=Mr.channels=4}function Dt(Mr,gn){var hn=null;if(k(gn))hn=Mr.images[0]=ut(),ft(hn,Mr),ke(hn,gn),Mr.mipmask=1;else if(St(Mr,gn),Array.isArray(gn.mipmap))for(var Sn=gn.mipmap,Jn=0;Jn<Sn.length;++Jn)hn=Mr.images[Jn]=ut(),ft(hn,Mr),hn.width>>=Jn,hn.height>>=Jn,ke(hn,Sn[Jn]),Mr.mipmask|=1<<Jn;else hn=Mr.images[0]=ut(),ft(hn,Mr),ke(hn,gn),Mr.mipmask=1;ft(Mr,Mr.images[0])}function Xt(Mr,gn){for(var hn=Mr.images,Sn=0;Sn<hn.length&&hn[Sn];++Sn){var Jn=hn[Sn],ha=gn,ra=Sn,In=Jn.element,jn=Jn.data,Ga=Jn.internalformat,vi=Jn.format,Gt=Jn.type,pr=Jn.width,on=Jn.height;Ut(Jn),In?ot.texImage2D(ha,ra,vi,vi,Gt,In):Jn.compressed?ot.compressedTexImage2D(ha,ra,Ga,pr,on,0,jn):Jn.needsCopy?(ur(),ot.copyTexImage2D(ha,ra,vi,Jn.xOffset,Jn.yOffset,pr,on,0)):ot.texImage2D(ha,ra,vi,pr,on,0,vi,Gt,jn||null)}}function ar(){var Mr=Ca.pop()||new Et;st.call(Mr);for(var gn=Mr.mipmask=0;16>gn;++gn)Mr.images[gn]=null;return Mr}function kr(Mr){for(var gn=Mr.images,hn=0;hn<gn.length;++hn)gn[hn]&&ht(gn[hn]),gn[hn]=null;Ca.push(Mr)}function wr(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function Sr(Mr,gn){"min"in gn&&(Mr.minFilter=jt[gn.min],0<=Zt.indexOf(Mr.minFilter)&&!("faces"in gn)&&(Mr.genMipmaps=!0)),"mag"in gn&&(Mr.magFilter=Ft[gn.mag]);var hn=Mr.wrapS,Sn=Mr.wrapT;if("wrap"in gn){var Jn=gn.wrap;typeof Jn=="string"?hn=Sn=at[Jn]:Array.isArray(Jn)&&(hn=at[Jn[0]],Sn=at[Jn[1]])}else"wrapS"in gn&&(hn=at[gn.wrapS]),"wrapT"in gn&&(Sn=at[gn.wrapT]);if(Mr.wrapS=hn,Mr.wrapT=Sn,"anisotropic"in gn&&(Mr.anisotropic=gn.anisotropic),"mipmap"in gn){switch(hn=!1,typeof gn.mipmap){case"string":Mr.mipmapHint=Cr[gn.mipmap],hn=Mr.genMipmaps=!0;break;case"boolean":hn=Mr.genMipmaps=gn.mipmap;break;case"object":Mr.genMipmaps=!1,hn=!0}!hn||"min"in gn||(Mr.minFilter=9984)}}function Zr(Mr,gn){ot.texParameteri(gn,10241,Mr.minFilter),ot.texParameteri(gn,10240,Mr.magFilter),ot.texParameteri(gn,10242,Mr.wrapS),ot.texParameteri(gn,10243,Mr.wrapT),er.ext_texture_filter_anisotropic&&ot.texParameteri(gn,34046,Mr.anisotropic),Mr.genMipmaps&&(ot.hint(33170,Mr.mipmapHint),ot.generateMipmap(gn))}function ir(Mr){st.call(this),this.mipmask=0,this.internalformat=6408,this.id=gi++,this.refCount=1,this.target=Mr,this.texture=ot.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new wr,$e.profile&&(this.stats={size:0})}function xr(Mr){ot.activeTexture(33984),ot.bindTexture(Mr.target,Mr.texture)}function Fr(){var Mr=Ja[0];Mr?ot.bindTexture(Mr.target,Mr.texture):ot.bindTexture(3553,null)}function Or(Mr){var gn=Mr.texture,hn=Mr.unit,Sn=Mr.target;0<=hn&&(ot.activeTexture(33984+hn),ot.bindTexture(Sn,null),Ja[hn]=null),ot.deleteTexture(gn),Mr.texture=null,Mr.params=null,Mr.pixels=null,Mr.refCount=0,delete Xa[Mr.id],et.textureCount--}var Cr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},at={repeat:10497,clamp:33071,mirror:33648},Ft={nearest:9728,linear:9729},jt=se({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Ft),sr={none:0,browser:37444},zr={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Ur={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Dr={};er.ext_srgb&&(Ur.srgb=35904,Ur.srgba=35906),er.oes_texture_float&&(zr.float32=zr.float=5126),er.oes_texture_half_float&&(zr.float16=zr["half float"]=36193),er.webgl_depth_texture&&(se(Ur,{depth:6402,"depth stencil":34041}),se(zr,{uint16:5123,uint32:5125,"depth stencil":34042})),er.webgl_compressed_texture_s3tc&&se(Dr,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),er.webgl_compressed_texture_atc&&se(Dr,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),er.webgl_compressed_texture_pvrtc&&se(Dr,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),er.webgl_compressed_texture_etc1&&(Dr["rgb etc1"]=36196);var Tr=Array.prototype.slice.call(ot.getParameter(34467));Object.keys(Dr).forEach(function(Mr){var gn=Dr[Mr];0<=Tr.indexOf(gn)&&(Ur[Mr]=gn)});var Wr=Object.keys(Ur);Kt.textureFormats=Wr;var An=[];Object.keys(Ur).forEach(function(Mr){An[Ur[Mr]]=Mr});var vn=[];Object.keys(zr).forEach(function(Mr){vn[zr[Mr]]=Mr});var Un=[];Object.keys(Ft).forEach(function(Mr){Un[Ft[Mr]]=Mr});var Dn=[];Object.keys(jt).forEach(function(Mr){Dn[jt[Mr]]=Mr});var Xn=[];Object.keys(at).forEach(function(Mr){Xn[at[Mr]]=Mr});var Yn=Wr.reduce(function(Mr,gn){var hn=Ur[gn];return hn===6409||hn===6406||hn===6409||hn===6410||hn===6402||hn===34041||er.ext_srgb&&(hn===35904||hn===35906)?Mr[hn]=hn:hn===32855||0<=gn.indexOf("rgba")?Mr[hn]=6408:Mr[hn]=6407,Mr},{}),ya=[],Ca=[],gi=0,Xa={},$a=Kt.maxTextureUnits,Ja=Array($a).map(function(){return null});return se(ir.prototype,{bind:function(){this.bindCount+=1;var Mr=this.unit;if(0>Mr){for(var gn=0;gn<$a;++gn){var hn=Ja[gn];if(hn){if(0<hn.bindCount)continue;hn.unit=-1}Ja[gn]=this,Mr=gn;break}$e.profile&&et.maxTextureUnits<Mr+1&&(et.maxTextureUnits=Mr+1),this.unit=Mr,ot.activeTexture(33984+Mr),ot.bindTexture(this.target,this.texture)}return Mr},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&Or(this)}}),$e.profile&&(et.getTotalTextureSize=function(){var Mr=0;return Object.keys(Xa).forEach(function(gn){Mr+=Xa[gn].stats.size}),Mr}),{create2D:function(Mr,gn){function hn(Jn,ha){var ra=Sn.texInfo;wr.call(ra);var In=ar();return typeof Jn=="number"?typeof ha=="number"?yt(In,Jn|0,ha|0):yt(In,Jn|0,Jn|0):Jn?(Sr(ra,Jn),Dt(In,Jn)):yt(In,1,1),ra.genMipmaps&&(In.mipmask=(In.width<<1)-1),Sn.mipmask=In.mipmask,ft(Sn,In),Sn.internalformat=In.internalformat,hn.width=In.width,hn.height=In.height,xr(Sn),Xt(In,3553),Zr(ra,3553),Fr(),kr(In),$e.profile&&(Sn.stats.size=z(Sn.internalformat,Sn.type,In.width,In.height,ra.genMipmaps,!1)),hn.format=An[Sn.internalformat],hn.type=vn[Sn.type],hn.mag=Un[ra.magFilter],hn.min=Dn[ra.minFilter],hn.wrapS=Xn[ra.wrapS],hn.wrapT=Xn[ra.wrapT],hn}var Sn=new ir(3553);return Xa[Sn.id]=Sn,et.textureCount++,hn(Mr,gn),hn.subimage=function(Jn,ha,ra,In){ha|=0,ra|=0,In|=0;var jn=ut();return ft(jn,Sn),jn.width=0,jn.height=0,ke(jn,Jn),jn.width=jn.width||(Sn.width>>In)-ha,jn.height=jn.height||(Sn.height>>In)-ra,xr(Sn),it(jn,3553,ha,ra,In),Fr(),ht(jn),hn},hn.resize=function(Jn,ha){var ra=Jn|0,In=ha|0||ra;if(ra===Sn.width&&In===Sn.height)return hn;hn.width=Sn.width=ra,hn.height=Sn.height=In,xr(Sn);for(var jn=0;Sn.mipmask>>jn;++jn){var Ga=ra>>jn,vi=In>>jn;if(!Ga||!vi)break;ot.texImage2D(3553,jn,Sn.format,Ga,vi,0,Sn.format,Sn.type,null)}return Fr(),$e.profile&&(Sn.stats.size=z(Sn.internalformat,Sn.type,ra,In,!1,!1)),hn},hn._reglType="texture2d",hn._texture=Sn,$e.profile&&(hn.stats=Sn.stats),hn.destroy=function(){Sn.decRef()},hn},createCube:function(Mr,gn,hn,Sn,Jn,ha){function ra(Ga,vi,Gt,pr,on,dn){var rn,Mn=In.texInfo;for(wr.call(Mn),rn=0;6>rn;++rn)jn[rn]=ar();if(typeof Ga=="number"||!Ga)for(Ga=Ga|0||1,rn=0;6>rn;++rn)yt(jn[rn],Ga,Ga);else if(typeof Ga=="object")if(vi)Dt(jn[0],Ga),Dt(jn[1],vi),Dt(jn[2],Gt),Dt(jn[3],pr),Dt(jn[4],on),Dt(jn[5],dn);else if(Sr(Mn,Ga),St(In,Ga),"faces"in Ga)for(Ga=Ga.faces,rn=0;6>rn;++rn)ft(jn[rn],In),Dt(jn[rn],Ga[rn]);else for(rn=0;6>rn;++rn)Dt(jn[rn],Ga);for(ft(In,jn[0]),In.mipmask=Mn.genMipmaps?(jn[0].width<<1)-1:jn[0].mipmask,In.internalformat=jn[0].internalformat,ra.width=jn[0].width,ra.height=jn[0].height,xr(In),rn=0;6>rn;++rn)Xt(jn[rn],34069+rn);for(Zr(Mn,34067),Fr(),$e.profile&&(In.stats.size=z(In.internalformat,In.type,ra.width,ra.height,Mn.genMipmaps,!0)),ra.format=An[In.internalformat],ra.type=vn[In.type],ra.mag=Un[Mn.magFilter],ra.min=Dn[Mn.minFilter],ra.wrapS=Xn[Mn.wrapS],ra.wrapT=Xn[Mn.wrapT],rn=0;6>rn;++rn)kr(jn[rn]);return ra}var In=new ir(34067);Xa[In.id]=In,et.cubeCount++;var jn=Array(6);return ra(Mr,gn,hn,Sn,Jn,ha),ra.subimage=function(Ga,vi,Gt,pr,on){Gt|=0,pr|=0,on|=0;var dn=ut();return ft(dn,In),dn.width=0,dn.height=0,ke(dn,vi),dn.width=dn.width||(In.width>>on)-Gt,dn.height=dn.height||(In.height>>on)-pr,xr(In),it(dn,34069+Ga,Gt,pr,on),Fr(),ht(dn),ra},ra.resize=function(Ga){if(Ga|=0,Ga!==In.width){ra.width=In.width=Ga,ra.height=In.height=Ga,xr(In);for(var vi=0;6>vi;++vi)for(var Gt=0;In.mipmask>>Gt;++Gt)ot.texImage2D(34069+vi,Gt,In.format,Ga>>Gt,Ga>>Gt,0,In.format,In.type,null);return Fr(),$e.profile&&(In.stats.size=z(In.internalformat,In.type,ra.width,ra.height,!1,!0)),ra}},ra._reglType="textureCube",ra._texture=In,$e.profile&&(ra.stats=In.stats),ra.destroy=function(){In.decRef()},ra},clear:function(){for(var Mr=0;Mr<$a;++Mr)ot.activeTexture(33984+Mr),ot.bindTexture(3553,null),Ja[Mr]=null;De(Xa).forEach(Or),et.cubeCount=0,et.textureCount=0},getTexture:function(Mr){return null},restore:function(){for(var Mr=0;Mr<$a;++Mr){var gn=Ja[Mr];gn&&(gn.bindCount=0,gn.unit=-1,Ja[Mr]=null)}De(Xa).forEach(function(hn){hn.texture=ot.createTexture(),ot.bindTexture(hn.target,hn.texture);for(var Sn=0;32>Sn;++Sn)if((hn.mipmask&1<<Sn)!==0)if(hn.target===3553)ot.texImage2D(3553,Sn,hn.internalformat,hn.width>>Sn,hn.height>>Sn,0,hn.internalformat,hn.type,null);else for(var Jn=0;6>Jn;++Jn)ot.texImage2D(34069+Jn,Sn,hn.internalformat,hn.width>>Sn,hn.height>>Sn,0,hn.internalformat,hn.type,null);Zr(hn.texInfo,hn.target)})},refresh:function(){for(var Mr=0;Mr<$a;++Mr){var gn=Ja[Mr];gn&&(gn.bindCount=0,gn.unit=-1,Ja[Mr]=null),ot.activeTexture(33984+Mr),ot.bindTexture(3553,null),ot.bindTexture(34067,null)}}}}function I(ot,er,Kt,ur,Ar,et){function $e(ir,xr,Fr){this.target=ir,this.texture=xr,this.renderbuffer=Fr;var Or=ir=0;xr?(ir=xr.width,Or=xr.height):Fr&&(ir=Fr.width,Or=Fr.height),this.width=ir,this.height=Or}function st(ir){ir&&(ir.texture&&ir.texture._texture.decRef(),ir.renderbuffer&&ir.renderbuffer._renderbuffer.decRef())}function ft(ir,xr,Fr){ir&&(ir.texture?ir.texture._texture.refCount+=1:ir.renderbuffer._renderbuffer.refCount+=1)}function St(ir,xr){xr&&(xr.texture?ot.framebufferTexture2D(36160,ir,xr.target,xr.texture._texture.texture,0):ot.framebufferRenderbuffer(36160,ir,36161,xr.renderbuffer._renderbuffer.renderbuffer))}function Ut(ir){var xr=3553,Fr=null,Or=null,Cr=ir;return typeof ir=="object"&&(Cr=ir.data,"target"in ir&&(xr=ir.target|0)),ir=Cr._reglType,ir==="texture2d"||ir==="textureCube"?Fr=Cr:ir==="renderbuffer"&&(Or=Cr,xr=36161),new $e(xr,Fr,Or)}function Pe(ir,xr,Fr,Or,Cr){return Fr?(ir=ur.create2D({width:ir,height:xr,format:Or,type:Cr}),ir._texture.refCount=0,new $e(3553,ir,null)):(ir=Ar.create({width:ir,height:xr,format:Or}),ir._renderbuffer.refCount=0,new $e(36161,null,ir))}function ke(ir){return ir&&(ir.texture||ir.renderbuffer)}function it(ir,xr,Fr){ir&&(ir.texture?ir.texture.resize(xr,Fr):ir.renderbuffer&&ir.renderbuffer.resize(xr,Fr),ir.width=xr,ir.height=Fr)}function ut(){this.id=Sr++,Zr[this.id]=this,this.framebuffer=ot.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function ht(ir){ir.colorAttachments.forEach(st),st(ir.depthAttachment),st(ir.stencilAttachment),st(ir.depthStencilAttachment)}function Et(ir){ot.deleteFramebuffer(ir.framebuffer),ir.framebuffer=null,et.framebufferCount--,delete Zr[ir.id]}function yt(ir){var xr;ot.bindFramebuffer(36160,ir.framebuffer);var Fr=ir.colorAttachments;for(xr=0;xr<Fr.length;++xr)St(36064+xr,Fr[xr]);for(xr=Fr.length;xr<Kt.maxColorAttachments;++xr)ot.framebufferTexture2D(36160,36064+xr,3553,null,0);ot.framebufferTexture2D(36160,33306,3553,null,0),ot.framebufferTexture2D(36160,36096,3553,null,0),ot.framebufferTexture2D(36160,36128,3553,null,0),St(36096,ir.depthAttachment),St(36128,ir.stencilAttachment),St(33306,ir.depthStencilAttachment),ot.checkFramebufferStatus(36160),ot.isContextLost(),ot.bindFramebuffer(36160,Xt.next?Xt.next.framebuffer:null),Xt.cur=Xt.next,ot.getError()}function Dt(ir,xr){function Fr(Cr,at){var Ft,jt=0,sr=0,zr=!0,Ur=!0;Ft=null;var Dr=!0,Tr="rgba",Wr="uint8",An=1,vn=null,Un=null,Dn=null,Xn=!1;typeof Cr=="number"?(jt=Cr|0,sr=at|0||jt):Cr?("shape"in Cr?(sr=Cr.shape,jt=sr[0],sr=sr[1]):("radius"in Cr&&(jt=sr=Cr.radius),"width"in Cr&&(jt=Cr.width),"height"in Cr&&(sr=Cr.height)),("color"in Cr||"colors"in Cr)&&(Ft=Cr.color||Cr.colors),Ft||("colorCount"in Cr&&(An=Cr.colorCount|0),"colorTexture"in Cr&&(Dr=!!Cr.colorTexture,Tr="rgba4"),"colorType"in Cr&&(Wr=Cr.colorType,!Dr)&&(Wr==="half float"||Wr==="float16"?Tr="rgba16f":(Wr==="float"||Wr==="float32")&&(Tr="rgba32f")),"colorFormat"in Cr&&(Tr=Cr.colorFormat,0<=ar.indexOf(Tr)?Dr=!0:0<=kr.indexOf(Tr)&&(Dr=!1))),("depthTexture"in Cr||"depthStencilTexture"in Cr)&&(Xn=!(!Cr.depthTexture&&!Cr.depthStencilTexture)),"depth"in Cr&&(typeof Cr.depth=="boolean"?zr=Cr.depth:(vn=Cr.depth,Ur=!1)),"stencil"in Cr&&(typeof Cr.stencil=="boolean"?Ur=Cr.stencil:(Un=Cr.stencil,zr=!1)),"depthStencil"in Cr&&(typeof Cr.depthStencil=="boolean"?zr=Ur=Cr.depthStencil:(Dn=Cr.depthStencil,Ur=zr=!1))):jt=sr=1;var Yn=null,ya=null,Ca=null,gi=null;if(Array.isArray(Ft))Yn=Ft.map(Ut);else if(Ft)Yn=[Ut(Ft)];else for(Yn=Array(An),Ft=0;Ft<An;++Ft)Yn[Ft]=Pe(jt,sr,Dr,Tr,Wr);for(jt=jt||Yn[0].width,sr=sr||Yn[0].height,vn?ya=Ut(vn):zr&&!Ur&&(ya=Pe(jt,sr,Xn,"depth","uint32")),Un?Ca=Ut(Un):Ur&&!zr&&(Ca=Pe(jt,sr,!1,"stencil","uint8")),Dn?gi=Ut(Dn):!vn&&!Un&&Ur&&zr&&(gi=Pe(jt,sr,Xn,"depth stencil","depth stencil")),zr=null,Ft=0;Ft<Yn.length;++Ft)ft(Yn[Ft]),Yn[Ft]&&Yn[Ft].texture&&(Ur=mt[Yn[Ft].texture._texture.format]*Mt[Yn[Ft].texture._texture.type],zr===null&&(zr=Ur));return ft(ya),ft(Ca),ft(gi),ht(Or),Or.width=jt,Or.height=sr,Or.colorAttachments=Yn,Or.depthAttachment=ya,Or.stencilAttachment=Ca,Or.depthStencilAttachment=gi,Fr.color=Yn.map(ke),Fr.depth=ke(ya),Fr.stencil=ke(Ca),Fr.depthStencil=ke(gi),Fr.width=Or.width,Fr.height=Or.height,yt(Or),Fr}var Or=new ut;return et.framebufferCount++,Fr(ir,xr),se(Fr,{resize:function(Cr,at){var Ft=Math.max(Cr|0,1),jt=Math.max(at|0||Ft,1);if(Ft===Or.width&&jt===Or.height)return Fr;for(var sr=Or.colorAttachments,zr=0;zr<sr.length;++zr)it(sr[zr],Ft,jt);return it(Or.depthAttachment,Ft,jt),it(Or.stencilAttachment,Ft,jt),it(Or.depthStencilAttachment,Ft,jt),Or.width=Fr.width=Ft,Or.height=Fr.height=jt,yt(Or),Fr},_reglType:"framebuffer",_framebuffer:Or,destroy:function(){Et(Or),ht(Or)},use:function(Cr){Xt.setFBO({framebuffer:Fr},Cr)}})}var Xt={cur:null,next:null,dirty:!1,setFBO:null},ar=["rgba"],kr=["rgba4","rgb565","rgb5 a1"];er.ext_srgb&&kr.push("srgba"),er.ext_color_buffer_half_float&&kr.push("rgba16f","rgb16f"),er.webgl_color_buffer_float&&kr.push("rgba32f");var wr=["uint8"];er.oes_texture_half_float&&wr.push("half float","float16"),er.oes_texture_float&&wr.push("float","float32");var Sr=0,Zr={};return se(Xt,{getFramebuffer:function(ir){return typeof ir=="function"&&ir._reglType==="framebuffer"&&(ir=ir._framebuffer,ir instanceof ut)?ir:null},create:Dt,createCube:function(ir){function xr(Or){var Cr,at={color:null},Ft=0,jt=null;Cr="rgba";var sr="uint8",zr=1;if(typeof Or=="number"?Ft=Or|0:Or?("shape"in Or?Ft=Or.shape[0]:("radius"in Or&&(Ft=Or.radius|0),"width"in Or?Ft=Or.width|0:"height"in Or&&(Ft=Or.height|0)),("color"in Or||"colors"in Or)&&(jt=Or.color||Or.colors),jt||("colorCount"in Or&&(zr=Or.colorCount|0),"colorType"in Or&&(sr=Or.colorType),"colorFormat"in Or&&(Cr=Or.colorFormat)),"depth"in Or&&(at.depth=Or.depth),"stencil"in Or&&(at.stencil=Or.stencil),"depthStencil"in Or&&(at.depthStencil=Or.depthStencil)):Ft=1,jt)if(Array.isArray(jt))for(Or=[],Cr=0;Cr<jt.length;++Cr)Or[Cr]=jt[Cr];else Or=[jt];else for(Or=Array(zr),jt={radius:Ft,format:Cr,type:sr},Cr=0;Cr<zr;++Cr)Or[Cr]=ur.createCube(jt);for(at.color=Array(Or.length),Cr=0;Cr<Or.length;++Cr)zr=Or[Cr],Ft=Ft||zr.width,at.color[Cr]={target:34069,data:Or[Cr]};for(Cr=0;6>Cr;++Cr){for(zr=0;zr<Or.length;++zr)at.color[zr].target=34069+Cr;0<Cr&&(at.depth=Fr[0].depth,at.stencil=Fr[0].stencil,at.depthStencil=Fr[0].depthStencil),Fr[Cr]?Fr[Cr](at):Fr[Cr]=Dt(at)}return se(xr,{width:Ft,height:Ft,color:Or})}var Fr=Array(6);return xr(ir),se(xr,{faces:Fr,resize:function(Or){var Cr=Or|0;if(Cr===xr.width)return xr;var at=xr.color;for(Or=0;Or<at.length;++Or)at[Or].resize(Cr);for(Or=0;6>Or;++Or)Fr[Or].resize(Cr);return xr.width=xr.height=Cr,xr},_reglType:"framebufferCube",destroy:function(){Fr.forEach(function(Or){Or.destroy()})}})},clear:function(){De(Zr).forEach(Et)},restore:function(){Xt.cur=null,Xt.next=null,Xt.dirty=!0,De(Zr).forEach(function(ir){ir.framebuffer=ot.createFramebuffer(),yt(ir)})}})}function O(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function N(ot,er,Kt,ur,Ar,et,$e){function st(yt){if(yt!==Et.currentVAO){var Dt=er.oes_vertex_array_object;yt?Dt.bindVertexArrayOES(yt.vao):Dt.bindVertexArrayOES(null),Et.currentVAO=yt}}function ft(yt){if(yt!==Et.currentVAO){if(yt)yt.bindAttrs();else{for(var Dt=er.angle_instanced_arrays,Xt=0;Xt<it.length;++Xt){var ar=it[Xt];ar.buffer?(ot.enableVertexAttribArray(Xt),ar.buffer.bind(),ot.vertexAttribPointer(Xt,ar.size,ar.type,ar.normalized,ar.stride,ar.offfset),Dt&&ar.divisor&&Dt.vertexAttribDivisorANGLE(Xt,ar.divisor)):(ot.disableVertexAttribArray(Xt),ot.vertexAttrib4f(Xt,ar.x,ar.y,ar.z,ar.w))}$e.elements?ot.bindBuffer(34963,$e.elements.buffer.buffer):ot.bindBuffer(34963,null)}Et.currentVAO=yt}}function St(){De(ht).forEach(function(yt){yt.destroy()})}function Ut(){this.id=++ut,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var yt=er.oes_vertex_array_object;this.vao=yt?yt.createVertexArrayOES():null,ht[this.id]=this,this.buffers=[]}function Pe(){er.oes_vertex_array_object&&De(ht).forEach(function(yt){yt.refresh()})}var ke=Kt.maxAttributes,it=Array(ke);for(Kt=0;Kt<ke;++Kt)it[Kt]=new O;var ut=0,ht={},Et={Record:O,scope:{},state:it,currentVAO:null,targetVAO:null,restore:er.oes_vertex_array_object?Pe:function(){},createVAO:function(yt){function Dt(ar){var kr;Array.isArray(ar)?(kr=ar,Xt.elements&&Xt.ownsElements&&Xt.elements.destroy(),Xt.elements=null,Xt.ownsElements=!1,Xt.offset=0,Xt.count=0,Xt.instances=-1,Xt.primitive=4):(ar.elements?(kr=ar.elements,Xt.ownsElements?(typeof kr=="function"&&kr._reglType==="elements"?Xt.elements.destroy():Xt.elements(kr),Xt.ownsElements=!1):et.getElements(ar.elements)?(Xt.elements=ar.elements,Xt.ownsElements=!1):(Xt.elements=et.create(ar.elements),Xt.ownsElements=!0)):(Xt.elements=null,Xt.ownsElements=!1),kr=ar.attributes,Xt.offset=0,Xt.count=-1,Xt.instances=-1,Xt.primitive=4,Xt.elements&&(Xt.count=Xt.elements._elements.vertCount,Xt.primitive=Xt.elements._elements.primType),"offset"in ar&&(Xt.offset=ar.offset|0),"count"in ar&&(Xt.count=ar.count|0),"instances"in ar&&(Xt.instances=ar.instances|0),"primitive"in ar&&(Xt.primitive=We[ar.primitive])),ar={};var wr=Xt.attributes;wr.length=kr.length;for(var Sr=0;Sr<kr.length;++Sr){var Zr=kr[Sr],ir=wr[Sr]=new O,xr=Zr.data||Zr;if(Array.isArray(xr)||Se(xr)||p(xr)){var Fr;Xt.buffers[Sr]&&(Fr=Xt.buffers[Sr],Se(xr)&&Fr._buffer.byteLength>=xr.byteLength?Fr.subdata(xr):(Fr.destroy(),Xt.buffers[Sr]=null)),Xt.buffers[Sr]||(Fr=Xt.buffers[Sr]=Ar.create(Zr,34962,!1,!0)),ir.buffer=Ar.getBuffer(Fr),ir.size=ir.buffer.dimension|0,ir.normalized=!1,ir.type=ir.buffer.dtype,ir.offset=0,ir.stride=0,ir.divisor=0,ir.state=1,ar[Sr]=1}else Ar.getBuffer(Zr)?(ir.buffer=Ar.getBuffer(Zr),ir.size=ir.buffer.dimension|0,ir.normalized=!1,ir.type=ir.buffer.dtype,ir.offset=0,ir.stride=0,ir.divisor=0,ir.state=1):Ar.getBuffer(Zr.buffer)?(ir.buffer=Ar.getBuffer(Zr.buffer),ir.size=(+Zr.size||ir.buffer.dimension)|0,ir.normalized=!!Zr.normalized||!1,ir.type="type"in Zr?Ce[Zr.type]:ir.buffer.dtype,ir.offset=(Zr.offset||0)|0,ir.stride=(Zr.stride||0)|0,ir.divisor=(Zr.divisor||0)|0,ir.state=1):"x"in Zr&&(ir.x=+Zr.x||0,ir.y=+Zr.y||0,ir.z=+Zr.z||0,ir.w=+Zr.w||0,ir.state=2)}for(Fr=0;Fr<Xt.buffers.length;++Fr)!ar[Fr]&&Xt.buffers[Fr]&&(Xt.buffers[Fr].destroy(),Xt.buffers[Fr]=null);return Xt.refresh(),Dt}var Xt=new Ut;return ur.vaoCount+=1,Dt.destroy=function(){for(var ar=0;ar<Xt.buffers.length;++ar)Xt.buffers[ar]&&Xt.buffers[ar].destroy();Xt.buffers.length=0,Xt.ownsElements&&(Xt.elements.destroy(),Xt.elements=null,Xt.ownsElements=!1),Xt.destroy()},Dt._vao=Xt,Dt._reglType="vao",Dt(yt)},getVAO:function(yt){return typeof yt=="function"&&yt._vao?yt._vao:null},destroyBuffer:function(yt){for(var Dt=0;Dt<it.length;++Dt){var Xt=it[Dt];Xt.buffer===yt&&(ot.disableVertexAttribArray(Dt),Xt.buffer=null)}},setVAO:er.oes_vertex_array_object?st:ft,clear:er.oes_vertex_array_object?St:function(){}};return Ut.prototype.bindAttrs=function(){for(var yt=er.angle_instanced_arrays,Dt=this.attributes,Xt=0;Xt<Dt.length;++Xt){var ar=Dt[Xt];ar.buffer?(ot.enableVertexAttribArray(Xt),ot.bindBuffer(34962,ar.buffer.buffer),ot.vertexAttribPointer(Xt,ar.size,ar.type,ar.normalized,ar.stride,ar.offset),yt&&ar.divisor&&yt.vertexAttribDivisorANGLE(Xt,ar.divisor)):(ot.disableVertexAttribArray(Xt),ot.vertexAttrib4f(Xt,ar.x,ar.y,ar.z,ar.w))}for(yt=Dt.length;yt<ke;++yt)ot.disableVertexAttribArray(yt);(yt=et.getElements(this.elements))?ot.bindBuffer(34963,yt.buffer.buffer):ot.bindBuffer(34963,null)},Ut.prototype.refresh=function(){var yt=er.oes_vertex_array_object;yt&&(yt.bindVertexArrayOES(this.vao),this.bindAttrs(),Et.currentVAO=null,yt.bindVertexArrayOES(null))},Ut.prototype.destroy=function(){if(this.vao){var yt=er.oes_vertex_array_object;this===Et.currentVAO&&(Et.currentVAO=null,yt.bindVertexArrayOES(null)),yt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),ht[this.id]&&(delete ht[this.id],--ur.vaoCount)},Et}function V(ot,er,Kt,ur){function Ar(ut,ht,Et,yt){this.name=ut,this.id=ht,this.location=Et,this.info=yt}function et(ut,ht){for(var Et=0;Et<ut.length;++Et)if(ut[Et].id===ht.id){ut[Et].location=ht.location;return}ut.push(ht)}function $e(ut,ht,Et){Et=ut===35632?St:Ut;var yt=Et[ht];if(!yt){var Dt=er.str(ht),yt=ot.createShader(ut);ot.shaderSource(yt,Dt),ot.compileShader(yt),Et[ht]=yt}return yt}function st(ut,ht){this.id=it++,this.fragId=ut,this.vertId=ht,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,ur.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function ft(ut,ht,Et){var yt;yt=$e(35632,ut.fragId);var Dt=$e(35633,ut.vertId);if(ht=ut.program=ot.createProgram(),ot.attachShader(ht,yt),ot.attachShader(ht,Dt),Et)for(yt=0;yt<Et.length;++yt)Dt=Et[yt],ot.bindAttribLocation(ht,Dt[0],Dt[1]);ot.linkProgram(ht),Dt=ot.getProgramParameter(ht,35718),ur.profile&&(ut.stats.uniformsCount=Dt);var Xt=ut.uniforms;for(yt=0;yt<Dt;++yt)if(Et=ot.getActiveUniform(ht,yt))if(1<Et.size)for(var ar=0;ar<Et.size;++ar){var kr=Et.name.replace("[0]","["+ar+"]");et(Xt,new Ar(kr,er.id(kr),ot.getUniformLocation(ht,kr),Et))}else et(Xt,new Ar(Et.name,er.id(Et.name),ot.getUniformLocation(ht,Et.name),Et));for(Dt=ot.getProgramParameter(ht,35721),ur.profile&&(ut.stats.attributesCount=Dt),ut=ut.attributes,yt=0;yt<Dt;++yt)(Et=ot.getActiveAttrib(ht,yt))&&et(ut,new Ar(Et.name,er.id(Et.name),ot.getAttribLocation(ht,Et.name),Et))}var St={},Ut={},Pe={},ke=[],it=0;return ur.profile&&(Kt.getMaxUniformsCount=function(){var ut=0;return ke.forEach(function(ht){ht.stats.uniformsCount>ut&&(ut=ht.stats.uniformsCount)}),ut},Kt.getMaxAttributesCount=function(){var ut=0;return ke.forEach(function(ht){ht.stats.attributesCount>ut&&(ut=ht.stats.attributesCount)}),ut}),{clear:function(){var ut=ot.deleteShader.bind(ot);De(St).forEach(ut),St={},De(Ut).forEach(ut),Ut={},ke.forEach(function(ht){ot.deleteProgram(ht.program)}),ke.length=0,Pe={},Kt.shaderCount=0},program:function(ut,ht,Et,yt){var Dt=Pe[ht];Dt||(Dt=Pe[ht]={});var Xt=Dt[ut];if(Xt&&(Xt.refCount++,!yt))return Xt;var ar=new st(ht,ut);return Kt.shaderCount++,ft(ar,Et,yt),Xt||(Dt[ut]=ar),ke.push(ar),se(ar,{destroy:function(){if(ar.refCount--,0>=ar.refCount){ot.deleteProgram(ar.program);var kr=ke.indexOf(ar);ke.splice(kr,1),Kt.shaderCount--}0>=Dt[ar.vertId].refCount&&(ot.deleteShader(Ut[ar.vertId]),delete Ut[ar.vertId],delete Pe[ar.fragId][ar.vertId]),Object.keys(Pe[ar.fragId]).length||(ot.deleteShader(St[ar.fragId]),delete St[ar.fragId],delete Pe[ar.fragId])}})},restore:function(){St={},Ut={};for(var ut=0;ut<ke.length;++ut)ft(ke[ut],null,ke[ut].attributes.map(function(ht){return[ht.location,ht.name]}))},shader:$e,frag:-1,vert:-1}}function H(ot,er,Kt,ur,Ar,et,$e){function st(St){var Ut;Ut=er.next===null?5121:er.next.colorAttachments[0].texture._texture.type;var Pe=0,ke=0,it=ur.framebufferWidth,ut=ur.framebufferHeight,ht=null;return Se(St)?ht=St:St&&(Pe=St.x|0,ke=St.y|0,it=(St.width||ur.framebufferWidth-Pe)|0,ut=(St.height||ur.framebufferHeight-ke)|0,ht=St.data||null),Kt(),St=it*ut*4,ht||(Ut===5121?ht=new Uint8Array(St):Ut===5126&&(ht=ht||new Float32Array(St))),ot.pixelStorei(3333,4),ot.readPixels(Pe,ke,it,ut,6408,Ut,ht),ht}function ft(St){var Ut;return er.setFBO({framebuffer:St.framebuffer},function(){Ut=st(St)}),Ut}return function(St){return St&&"framebuffer"in St?ft(St):st(St)}}function j(ot){for(var er=Array(ot.length>>2),ur=0;ur<er.length;ur++)er[ur]=0;for(ur=0;ur<8*ot.length;ur+=8)er[ur>>5]|=(ot.charCodeAt(ur/8)&255)<<24-ur%32;var Kt=8*ot.length;ot=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225];var ur=Array(64),Ar,et,$e,st,ft,St,Ut,Pe,ke,it,ut;for(er[Kt>>5]|=128<<24-Kt%32,er[(Kt+64>>9<<4)+15]=Kt,Pe=0;Pe<er.length;Pe+=16){for(Kt=ot[0],Ar=ot[1],et=ot[2],$e=ot[3],st=ot[4],ft=ot[5],St=ot[6],Ut=ot[7],ke=0;64>ke;ke++){if(16>ke)ur[ke]=er[ke+Pe];else{it=ke,ut=ur[ke-2],ut=re(ut,17)^re(ut,19)^ut>>>10,ut=ue(ut,ur[ke-7]);var ht;ht=ur[ke-15],ht=re(ht,7)^re(ht,18)^ht>>>3,ur[it]=ue(ue(ut,ht),ur[ke-16])}it=st,it=re(it,6)^re(it,11)^re(it,25),it=ue(ue(ue(ue(Ut,it),st&ft^~st&St),Ht[ke]),ur[ke]),Ut=Kt,Ut=re(Ut,2)^re(Ut,13)^re(Ut,22),ut=ue(Ut,Kt&Ar^Kt&et^Ar&et),Ut=St,St=ft,ft=st,st=ue($e,it),$e=et,et=Ar,Ar=Kt,Kt=ue(it,ut)}ot[0]=ue(Kt,ot[0]),ot[1]=ue(Ar,ot[1]),ot[2]=ue(et,ot[2]),ot[3]=ue($e,ot[3]),ot[4]=ue(st,ot[4]),ot[5]=ue(ft,ot[5]),ot[6]=ue(St,ot[6]),ot[7]=ue(Ut,ot[7])}for(er="",ur=0;ur<32*ot.length;ur+=8)er+=String.fromCharCode(ot[ur>>5]>>>24-ur%32&255);return er}function Z(ot){for(var er="",Kt,ur=0;ur<ot.length;ur++)Kt=ot.charCodeAt(ur),er+="0123456789abcdef".charAt(Kt>>>4&15)+"0123456789abcdef".charAt(Kt&15);return er}function X(ot){for(var er="",Kt=-1,ur,Ar;++Kt<ot.length;)ur=ot.charCodeAt(Kt),Ar=Kt+1<ot.length?ot.charCodeAt(Kt+1):0,55296<=ur&&56319>=ur&&56320<=Ar&&57343>=Ar&&(ur=65536+((ur&1023)<<10)+(Ar&1023),Kt++),127>=ur?er+=String.fromCharCode(ur):2047>=ur?er+=String.fromCharCode(192|ur>>>6&31,128|ur&63):65535>=ur?er+=String.fromCharCode(224|ur>>>12&15,128|ur>>>6&63,128|ur&63):2097151>=ur&&(er+=String.fromCharCode(240|ur>>>18&7,128|ur>>>12&63,128|ur>>>6&63,128|ur&63));return er}function re(ot,er){return ot>>>er|ot<<32-er}function ue(ot,er){var Kt=(ot&65535)+(er&65535);return(ot>>16)+(er>>16)+(Kt>>16)<<16|Kt&65535}function K(ot){return Array.prototype.slice.call(ot)}function te(ot){return K(ot).join("")}function G(ot){function er(){var Ut=[],Pe=[];return se(function(){Ut.push.apply(Ut,K(arguments))},{def:function(){var ke="v"+Ar++;return Pe.push(ke),0<arguments.length&&(Ut.push(ke,"="),Ut.push.apply(Ut,K(arguments)),Ut.push(";")),ke},toString:function(){return te([0<Pe.length?"var "+Pe.join(",")+";":"",te(Ut)])}})}function Kt(){function Ut(ht,Et){ke(ht,Et,"=",Pe.def(ht,Et),";")}var Pe=er(),ke=er(),it=Pe.toString,ut=ke.toString;return se(function(){Pe.apply(Pe,K(arguments))},{def:Pe.def,entry:Pe,exit:ke,save:Ut,set:function(ht,Et,yt){Ut(ht,Et),Pe(ht,Et,"=",yt,";")},toString:function(){return it()+ut()}})}var ur=ot&&ot.cache,Ar=0,et=[],$e=[],st=[],ft=er(),St={};return{global:ft,link:function(Ut,Pe){var ke=Pe&&Pe.stable;if(!ke){for(var it=0;it<$e.length;++it)if($e[it]===Ut&&!st[it])return et[it]}return it="g"+Ar++,et.push(it),$e.push(Ut),st.push(ke),it},block:er,proc:function(Ut,Pe){function ke(){var Et="a"+it.length;return it.push(Et),Et}var it=[];Pe=Pe||0;for(var ut=0;ut<Pe;++ut)ke();var ut=Kt(),ht=ut.toString;return St[Ut]=se(ut,{arg:ke,toString:function(){return te(["function(",it.join(),"){",ht(),"}"])}})},scope:Kt,cond:function(){var Ut=te(arguments),Pe=Kt(),ke=Kt(),it=Pe.toString,ut=ke.toString;return se(Pe,{then:function(){return Pe.apply(Pe,K(arguments)),this},else:function(){return ke.apply(ke,K(arguments)),this},toString:function(){var ht=ut();return ht&&(ht="else{"+ht+"}"),te(["if(",Ut,"){",it(),"}",ht])}})},compile:function(){var Ut=['"use strict";',ft,"return {"];Object.keys(St).forEach(function(it){Ut.push('"',it,'":',St[it].toString(),",")}),Ut.push("}");var Pe=te(Ut).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),ke;return ur&&(ke=Z(j(X(Pe))),ur[ke])?ur[ke].apply(null,$e):(Pe=Function.apply(null,et.concat(Pe)),ur&&(ur[ke]=Pe),Pe.apply(null,$e))}}}function Y(ot){return Array.isArray(ot)||Se(ot)||p(ot)}function ee(ot){return ot.sort(function(er,Kt){return er==="viewport"?-1:Kt==="viewport"?1:er<Kt?-1:1})}function ne(ot,er,Kt,ur){this.thisDep=ot,this.contextDep=er,this.propDep=Kt,this.append=ur}function J(ot){return ot&&!(ot.thisDep||ot.contextDep||ot.propDep)}function q(ot){return new ne(!1,!1,!1,ot)}function ae(ot,er){var Kt=ot.type;if(Kt===0)return Kt=ot.data.length,new ne(!0,1<=Kt,2<=Kt,er);if(Kt===4)return Kt=ot.data,new ne(Kt.thisDep,Kt.contextDep,Kt.propDep,er);if(Kt===5)return new ne(!1,!1,!1,er);if(Kt===6){for(var ur=Kt=!1,Ar=!1,et=0;et<ot.data.length;++et){var $e=ot.data[et];$e.type===1?Ar=!0:$e.type===2?ur=!0:$e.type===3?Kt=!0:$e.type===0?(Kt=!0,$e=$e.data,1<=$e&&(ur=!0),2<=$e&&(Ar=!0)):$e.type===4&&(Kt=Kt||$e.data.thisDep,ur=ur||$e.data.contextDep,Ar=Ar||$e.data.propDep)}return new ne(Kt,ur,Ar,er)}return new ne(Kt===3,Kt===2,Kt===1,er)}function le(ot,er,Kt,ur,Ar,et,$e,st,ft,St,Ut,Pe,ke,it,ut,ht){function Et(Gt){return Gt.replace(".","_")}function yt(Gt,pr,on){var dn=Et(Gt);ha.push(Gt),Jn[dn]=Sn[dn]=!!on,ra[dn]=pr}function Dt(Gt,pr,on){var dn=Et(Gt);ha.push(Gt),Array.isArray(on)?(Sn[dn]=on.slice(),Jn[dn]=on.slice()):Sn[dn]=Jn[dn]=on,In[dn]=pr}function Xt(){var Gt=G({cache:ut}),pr=Gt.link,on=Gt.global;Gt.id=vi++,Gt.batchId="0";var dn=pr(jn),rn=Gt.shared={props:"a0"};Object.keys(jn).forEach(function(br){rn[br]=on.def(dn,".",br)});var Mn=Gt.next={},_n=Gt.current={};Object.keys(In).forEach(function(br){Array.isArray(Sn[br])&&(Mn[br]=on.def(rn.next,".",br),_n[br]=on.def(rn.current,".",br))});var cn=Gt.constants={};Object.keys(Ga).forEach(function(br){cn[br]=on.def(JSON.stringify(Ga[br]))}),Gt.invoke=function(br,Br){switch(Br.type){case 0:var mn=["this",rn.context,rn.props,Gt.batchId];return br.def(pr(Br.data),".call(",mn.slice(0,Math.max(Br.data.length+1,4)),")");case 1:return br.def(rn.props,Br.data);case 2:return br.def(rn.context,Br.data);case 3:return br.def("this",Br.data);case 4:return Br.data.append(Gt,br),Br.data.ref;case 5:return Br.data.toString();case 6:return Br.data.map(function(On){return Gt.invoke(br,On)})}},Gt.attribCache={};var mr={};return Gt.scopeAttrib=function(br){if(br=er.id(br),br in mr)return mr[br];var Br=St.scope[br];return Br||(Br=St.scope[br]=new $a),mr[br]=pr(Br)},Gt}function ar(Gt){var pr=Gt.static;Gt=Gt.dynamic;var on;if("profile"in pr){var dn=!!pr.profile;on=q(function(Mn,_n){return dn}),on.enable=dn}else if("profile"in Gt){var rn=Gt.profile;on=ae(rn,function(Mn,_n){return Mn.invoke(_n,rn)})}return on}function kr(Gt,pr){var on=Gt.static,dn=Gt.dynamic;if("framebuffer"in on){var rn=on.framebuffer;return rn?(rn=st.getFramebuffer(rn),q(function(_n,cn){var mr=_n.link(rn),br=_n.shared;return cn.set(br.framebuffer,".next",mr),br=br.context,cn.set(br,".framebufferWidth",mr+".width"),cn.set(br,".framebufferHeight",mr+".height"),mr})):q(function(_n,cn){var mr=_n.shared;return cn.set(mr.framebuffer,".next","null"),mr=mr.context,cn.set(mr,".framebufferWidth",mr+".drawingBufferWidth"),cn.set(mr,".framebufferHeight",mr+".drawingBufferHeight"),"null"})}if("framebuffer"in dn){var Mn=dn.framebuffer;return ae(Mn,function(_n,cn){var Br=_n.invoke(cn,Mn),mr=_n.shared,br=mr.framebuffer,Br=cn.def(br,".getFramebuffer(",Br,")");return cn.set(br,".next",Br),mr=mr.context,cn.set(mr,".framebufferWidth",Br+"?"+Br+".width:"+mr+".drawingBufferWidth"),cn.set(mr,".framebufferHeight",Br+"?"+Br+".height:"+mr+".drawingBufferHeight"),Br})}return null}function wr(Gt,pr,on){function dn(cn){if(cn in rn){var mr=rn[cn];cn=!0;var br=mr.x|0,Br=mr.y|0,mn,On;return"width"in mr?mn=mr.width|0:cn=!1,"height"in mr?On=mr.height|0:cn=!1,new ne(!cn&&pr&&pr.thisDep,!cn&&pr&&pr.contextDep,!cn&&pr&&pr.propDep,function(Tn,Kn){var oa=Tn.shared.context,ma=mn;"width"in mr||(ma=Kn.def(oa,".","framebufferWidth","-",br));var _a=On;return"height"in mr||(_a=Kn.def(oa,".","framebufferHeight","-",Br)),[br,Br,ma,_a]})}if(cn in Mn){var na=Mn[cn];return cn=ae(na,function(Tn,Kn){var Ea=Tn.invoke(Kn,na),oa=Tn.shared.context,ma=Kn.def(Ea,".x|0"),_a=Kn.def(Ea,".y|0"),ua=Kn.def('"width" in ',Ea,"?",Ea,".width|0:","(",oa,".","framebufferWidth","-",ma,")"),Ea=Kn.def('"height" in ',Ea,"?",Ea,".height|0:","(",oa,".","framebufferHeight","-",_a,")");return[ma,_a,ua,Ea]}),pr&&(cn.thisDep=cn.thisDep||pr.thisDep,cn.contextDep=cn.contextDep||pr.contextDep,cn.propDep=cn.propDep||pr.propDep),cn}return pr?new ne(pr.thisDep,pr.contextDep,pr.propDep,function(Tn,Kn){var oa=Tn.shared.context;return[0,0,Kn.def(oa,".","framebufferWidth"),Kn.def(oa,".","framebufferHeight")]}):null}var rn=Gt.static,Mn=Gt.dynamic;if(Gt=dn("viewport")){var _n=Gt;Gt=new ne(Gt.thisDep,Gt.contextDep,Gt.propDep,function(cn,mr){var br=_n.append(cn,mr),Br=cn.shared.context;return mr.set(Br,".viewportWidth",br[2]),mr.set(Br,".viewportHeight",br[3]),br})}return{viewport:Gt,scissor_box:dn("scissor.box")}}function Sr(Gt,pr){var on=Gt.static;if(typeof on.frag=="string"&&typeof on.vert=="string"){if(0<Object.keys(pr.dynamic).length)return null;var on=pr.static,dn=Object.keys(on);if(0<dn.length&&typeof on[dn[0]]=="number"){for(var rn=[],Mn=0;Mn<dn.length;++Mn)rn.push([on[dn[Mn]]|0,dn[Mn]]);return rn}}return null}function Zr(Gt,pr,on){function dn(br){if(br in rn){var Br=er.id(rn[br]);return br=q(function(){return Br}),br.id=Br,br}if(br in Mn){var mn=Mn[br];return ae(mn,function(On,na){var Tn=On.invoke(na,mn);return na.def(On.shared.strings,".id(",Tn,")")})}return null}var rn=Gt.static,Mn=Gt.dynamic,_n=dn("frag"),cn=dn("vert"),mr=null;return J(_n)&&J(cn)?(mr=Ut.program(cn.id,_n.id,null,on),Gt=q(function(br,Br){return br.link(mr)})):Gt=new ne(_n&&_n.thisDep||cn&&cn.thisDep,_n&&_n.contextDep||cn&&cn.contextDep,_n&&_n.propDep||cn&&cn.propDep,function(br,Br){var mn=br.shared.shader,On;On=_n?_n.append(br,Br):Br.def(mn,".","frag");var na;return na=cn?cn.append(br,Br):Br.def(mn,".","vert"),Br.def(mn+".program("+na+","+On+")")}),{frag:_n,vert:cn,progVar:Gt,program:mr}}function ir(Gt,pr){function on(Tn,Kn){if(Tn in dn){var oa=dn[Tn]|0;return Kn?Mn.offset=oa:Mn.instances=oa,q(function(_a,ua){return Kn&&(_a.OFFSET=oa),oa})}if(Tn in rn){var ma=rn[Tn];return ae(ma,function(_a,ua){var Ea=_a.invoke(ua,ma);return Kn&&(_a.OFFSET=Ea),Ea})}if(Kn){if(mr)return q(function(_a,ua){return _a.OFFSET=0});if(_n)return new ne(cn.thisDep,cn.contextDep,cn.propDep,function(_a,ua){return ua.def(_a.shared.vao+".currentVAO?"+_a.shared.vao+".currentVAO.offset:0")})}else if(_n)return new ne(cn.thisDep,cn.contextDep,cn.propDep,function(_a,ua){return ua.def(_a.shared.vao+".currentVAO?"+_a.shared.vao+".currentVAO.instances:-1")});return null}var dn=Gt.static,rn=Gt.dynamic,Mn={},_n=!1,cn=function(){if("vao"in dn){var Tn=dn.vao;return Tn!==null&&St.getVAO(Tn)===null&&(Tn=St.createVAO(Tn)),_n=!0,Mn.vao=Tn,q(function(oa){var ma=St.getVAO(Tn);return ma?oa.link(ma):"null"})}if("vao"in rn){_n=!0;var Kn=rn.vao;return ae(Kn,function(oa,ma){var _a=oa.invoke(ma,Kn);return ma.def(oa.shared.vao+".getVAO("+_a+")")})}return null}(),mr=!1,br=function(){if("elements"in dn){var Tn=dn.elements;if(Mn.elements=Tn,Y(Tn)){var Kn=Mn.elements=et.create(Tn,!0),Tn=et.getElements(Kn);mr=!0}else Tn&&(Tn=et.getElements(Tn),mr=!0);return Kn=q(function(ma,_a){if(Tn){var ua=ma.link(Tn);return ma.ELEMENTS=ua}return ma.ELEMENTS=null}),Kn.value=Tn,Kn}if("elements"in rn){mr=!0;var oa=rn.elements;return ae(oa,function(ma,_a){var ua=ma.shared,Mo=ua.isBufferArgs,ua=ua.elements,jo=ma.invoke(_a,oa),Ea=_a.def("null"),Mo=_a.def(Mo,"(",jo,")"),jo=ma.cond(Mo).then(Ea,"=",ua,".createStream(",jo,");").else(Ea,"=",ua,".getElements(",jo,");");return _a.entry(jo),_a.exit(ma.cond(Mo).then(ua,".destroyStream(",Ea,");")),ma.ELEMENTS=Ea})}return _n?new ne(cn.thisDep,cn.contextDep,cn.propDep,function(ma,_a){return _a.def(ma.shared.vao+".currentVAO?"+ma.shared.elements+".getElements("+ma.shared.vao+".currentVAO.elements):null")}):null}(),Br=on("offset",!0),mn=function(){if("primitive"in dn){var Tn=dn.primitive;return Mn.primitive=Tn,q(function(oa,ma){return We[Tn]})}if("primitive"in rn){var Kn=rn.primitive;return ae(Kn,function(oa,ma){var _a=oa.constants.primTypes,ua=oa.invoke(ma,Kn);return ma.def(_a,"[",ua,"]")})}return mr?J(br)?br.value?q(function(oa,ma){return ma.def(oa.ELEMENTS,".primType")}):q(function(){return 4}):new ne(br.thisDep,br.contextDep,br.propDep,function(oa,ma){var _a=oa.ELEMENTS;return ma.def(_a,"?",_a,".primType:",4)}):_n?new ne(cn.thisDep,cn.contextDep,cn.propDep,function(oa,ma){return ma.def(oa.shared.vao+".currentVAO?"+oa.shared.vao+".currentVAO.primitive:4")}):null}(),On=function(){if("count"in dn){var Tn=dn.count|0;return Mn.count=Tn,q(function(){return Tn})}if("count"in rn){var Kn=rn.count;return ae(Kn,function(oa,ma){return oa.invoke(ma,Kn)})}return mr?J(br)?br?Br?new ne(Br.thisDep,Br.contextDep,Br.propDep,function(oa,ma){return ma.def(oa.ELEMENTS,".vertCount-",oa.OFFSET)}):q(function(oa,ma){return ma.def(oa.ELEMENTS,".vertCount")}):q(function(){return-1}):new ne(br.thisDep||Br.thisDep,br.contextDep||Br.contextDep,br.propDep||Br.propDep,function(oa,ma){var _a=oa.ELEMENTS;return oa.OFFSET?ma.def(_a,"?",_a,".vertCount-",oa.OFFSET,":-1"):ma.def(_a,"?",_a,".vertCount:-1")}):_n?new ne(cn.thisDep,cn.contextDep,cn.propDep,function(oa,ma){return ma.def(oa.shared.vao,".currentVAO?",oa.shared.vao,".currentVAO.count:-1")}):null}(),na=on("instances",!1);return{elements:br,primitive:mn,count:On,instances:na,offset:Br,vao:cn,vaoActive:_n,elementsActive:mr,static:Mn}}function xr(Gt,pr){var on=Gt.static,dn=Gt.dynamic,rn={};return ha.forEach(function(Mn){function _n(mr,br){if(Mn in on){var Br=mr(on[Mn]);rn[cn]=q(function(){return Br})}else if(Mn in dn){var mn=dn[Mn];rn[cn]=ae(mn,function(On,na){return br(On,na,On.invoke(na,mn))})}}var cn=Et(Mn);switch(Mn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return _n(function(mr){return mr},function(mr,br,Br){return Br});case"depth.func":return _n(function(mr){return Yt[mr]},function(mr,br,Br){return br.def(mr.constants.compareFuncs,"[",Br,"]")});case"depth.range":return _n(function(mr){return mr},function(mr,br,Br){return mr=br.def("+",Br,"[0]"),br=br.def("+",Br,"[1]"),[mr,br]});case"blend.func":return _n(function(mr){return[Jt["srcRGB"in mr?mr.srcRGB:mr.src],Jt["dstRGB"in mr?mr.dstRGB:mr.dst],Jt["srcAlpha"in mr?mr.srcAlpha:mr.src],Jt["dstAlpha"in mr?mr.dstAlpha:mr.dst]]},function(mr,br,Br){function mn(Kn,oa){return br.def('"',Kn,oa,'" in ',Br,"?",Br,".",Kn,oa,":",Br,".",Kn)}mr=mr.constants.blendFuncs;var On=mn("src","RGB"),Tn=mn("dst","RGB"),On=br.def(mr,"[",On,"]"),na=br.def(mr,"[",mn("src","Alpha"),"]"),Tn=br.def(mr,"[",Tn,"]");return mr=br.def(mr,"[",mn("dst","Alpha"),"]"),[On,Tn,na,mr]});case"blend.equation":return _n(function(mr){if(typeof mr=="string")return[Ja[mr],Ja[mr]];if(typeof mr=="object")return[Ja[mr.rgb],Ja[mr.alpha]]},function(mr,br,Br){var mn=mr.constants.blendEquations,On=br.def(),na=br.def();return mr=mr.cond("typeof ",Br,'==="string"'),mr.then(On,"=",na,"=",mn,"[",Br,"];"),mr.else(On,"=",mn,"[",Br,".rgb];",na,"=",mn,"[",Br,".alpha];"),br(mr),[On,na]});case"blend.color":return _n(function(mr){return s(4,function(br){return+mr[br]})},function(mr,br,Br){return s(4,function(mn){return br.def("+",Br,"[",mn,"]")})});case"stencil.mask":return _n(function(mr){return mr|0},function(mr,br,Br){return br.def(Br,"|0")});case"stencil.func":return _n(function(mr){return[Yt[mr.cmp||"keep"],mr.ref||0,"mask"in mr?mr.mask:-1]},function(mr,br,Br){mr=br.def('"cmp" in ',Br,"?",mr.constants.compareFuncs,"[",Br,".cmp]",":",7680);var mn=br.def(Br,".ref|0");return br=br.def('"mask" in ',Br,"?",Br,".mask|0:-1"),[mr,mn,br]});case"stencil.opFront":case"stencil.opBack":return _n(function(mr){return[Mn==="stencil.opBack"?1029:1028,or[mr.fail||"keep"],or[mr.zfail||"keep"],or[mr.zpass||"keep"]]},function(mr,br,Br){function mn(na){return br.def('"',na,'" in ',Br,"?",On,"[",Br,".",na,"]:",7680)}var On=mr.constants.stencilOps;return[Mn==="stencil.opBack"?1029:1028,mn("fail"),mn("zfail"),mn("zpass")]});case"polygonOffset.offset":return _n(function(mr){return[mr.factor|0,mr.units|0]},function(mr,br,Br){return mr=br.def(Br,".factor|0"),br=br.def(Br,".units|0"),[mr,br]});case"cull.face":return _n(function(mr){var br=0;return mr==="front"?br=1028:mr==="back"&&(br=1029),br},function(mr,br,Br){return br.def(Br,'==="front"?',1028,":",1029)});case"lineWidth":return _n(function(mr){return mr},function(mr,br,Br){return Br});case"frontFace":return _n(function(mr){return Hr[mr]},function(mr,br,Br){return br.def(Br+'==="cw"?2304:2305')});case"colorMask":return _n(function(mr){return mr.map(function(br){return!!br})},function(mr,br,Br){return s(4,function(mn){return"!!"+Br+"["+mn+"]"})});case"sample.coverage":return _n(function(mr){return["value"in mr?mr.value:1,!!mr.invert]},function(mr,br,Br){return mr=br.def('"value" in ',Br,"?+",Br,".value:1"),br=br.def("!!",Br,".invert"),[mr,br]})}}),rn}function Fr(Gt,pr){var on=Gt.static,dn=Gt.dynamic,rn={};return Object.keys(on).forEach(function(Mn){var _n=on[Mn],cn;if(typeof _n=="number"||typeof _n=="boolean")cn=q(function(){return _n});else if(typeof _n=="function"){var mr=_n._reglType;mr==="texture2d"||mr==="textureCube"?cn=q(function(br){return br.link(_n)}):(mr==="framebuffer"||mr==="framebufferCube")&&(cn=q(function(br){return br.link(_n.color[0])}))}else w(_n)&&(cn=q(function(br){return br.global.def("[",s(_n.length,function(Br){return _n[Br]}),"]")}));cn.value=_n,rn[Mn]=cn}),Object.keys(dn).forEach(function(Mn){var _n=dn[Mn];rn[Mn]=ae(_n,function(cn,mr){return cn.invoke(mr,_n)})}),rn}function Or(Gt,pr){var on=Gt.static,dn=Gt.dynamic,rn={};return Object.keys(on).forEach(function(Mn){var _n=on[Mn],cn=er.id(Mn),mr=new $a;if(Y(_n))mr.state=1,mr.buffer=Ar.getBuffer(Ar.create(_n,34962,!1,!0)),mr.type=0;else{var br=Ar.getBuffer(_n);if(br)mr.state=1,mr.buffer=br,mr.type=0;else if("constant"in _n){var Br=_n.constant;mr.buffer="null",mr.state=2,typeof Br=="number"?mr.x=Br:Rt.forEach(function(oa,ma){ma<Br.length&&(mr[oa]=Br[ma])})}else{var br=Y(_n.buffer)?Ar.getBuffer(Ar.create(_n.buffer,34962,!1,!0)):Ar.getBuffer(_n.buffer),mn=_n.offset|0,On=_n.stride|0,na=_n.size|0,Tn=!!_n.normalized,Kn=0;"type"in _n&&(Kn=Ce[_n.type]),_n=_n.divisor|0,mr.buffer=br,mr.state=1,mr.size=na,mr.normalized=Tn,mr.type=Kn||br.dtype,mr.offset=mn,mr.stride=On,mr.divisor=_n}}rn[Mn]=q(function(oa,ma){var _a=oa.attribCache;if(cn in _a)return _a[cn];var ua={isStream:!1};return Object.keys(mr).forEach(function(Ea){ua[Ea]=mr[Ea]}),mr.buffer&&(ua.buffer=oa.link(mr.buffer),ua.type=ua.type||ua.buffer+".dtype"),_a[cn]=ua})}),Object.keys(dn).forEach(function(Mn){var _n=dn[Mn];rn[Mn]=ae(_n,function(cn,mr){function br(_a){mr(Tn[_a],"=",Br,".",_a,"|0;")}var Br=cn.invoke(mr,_n),na=cn.shared,mn=cn.constants,On=na.isBufferArgs,na=na.buffer,Tn={isStream:mr.def(!1)},Kn=new $a;Kn.state=1,Object.keys(Kn).forEach(function(_a){Tn[_a]=mr.def(""+Kn[_a])});var oa=Tn.buffer,ma=Tn.type;return mr("if(",On,"(",Br,")){",Tn.isStream,"=true;",oa,"=",na,".createStream(",34962,",",Br,");",ma,"=",oa,".dtype;","}else{",oa,"=",na,".getBuffer(",Br,");","if(",oa,"){",ma,"=",oa,".dtype;",'}else if("constant" in ',Br,"){",Tn.state,"=",2,";","if(typeof "+Br+'.constant === "number"){',Tn[Rt[0]],"=",Br,".constant;",Rt.slice(1).map(function(_a){return Tn[_a]}).join("="),"=0;","}else{",Rt.map(function(_a,ua){return Tn[_a]+"="+Br+".constant.length>"+ua+"?"+Br+".constant["+ua+"]:0;"}).join(""),"}}else{","if(",On,"(",Br,".buffer)){",oa,"=",na,".createStream(",34962,",",Br,".buffer);","}else{",oa,"=",na,".getBuffer(",Br,".buffer);","}",ma,'="type" in ',Br,"?",mn.glTypes,"[",Br,".type]:",oa,".dtype;",Tn.normalized,"=!!",Br,".normalized;"),br("size"),br("offset"),br("stride"),br("divisor"),mr("}}"),mr.exit("if(",Tn.isStream,"){",na,".destroyStream(",oa,");","}"),Tn})}),rn}function Cr(Gt){var pr=Gt.static,on=Gt.dynamic,dn={};return Object.keys(pr).forEach(function(rn){var Mn=pr[rn];dn[rn]=q(function(_n,cn){return typeof Mn=="number"||typeof Mn=="boolean"?""+Mn:_n.link(Mn)})}),Object.keys(on).forEach(function(rn){var Mn=on[rn];dn[rn]=ae(Mn,function(_n,cn){return _n.invoke(cn,Mn)})}),dn}function at(Gt,pr,on,dn,rn){function Mn(Kn){var oa=cn[Kn];oa&&(br[Kn]=oa)}var _n=Sr(Gt,pr),On=kr(Gt),cn=wr(Gt,On),mr=ir(Gt),br=xr(Gt),Br=Zr(Gt,rn,_n);Mn("viewport"),Mn(Et("scissor.box"));var mn=0<Object.keys(br).length,On={framebuffer:On,draw:mr,shader:Br,state:br,dirty:mn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(On.profile=ar(Gt),On.uniforms=Fr(on),On.drawVAO=On.scopeVAO=mr.vao,!On.drawVAO&&Br.program&&!_n&&Kt.angle_instanced_arrays&&mr.static.elements){var na=!0;if(Gt=Br.program.attributes.map(function(Kn){return Kn=pr.static[Kn],na=na&&!!Kn,Kn}),na&&0<Gt.length){var Tn=St.getVAO(St.createVAO({attributes:Gt,elements:mr.static.elements}));On.drawVAO=new ne(null,null,null,function(Kn,oa){return Kn.link(Tn)}),On.useVAO=!0}}return _n?On.useVAO=!0:On.attributes=Or(pr),On.context=Cr(dn),On}function Ft(Gt,pr,on){var dn=Gt.shared.context,rn=Gt.scope();Object.keys(on).forEach(function(Mn){pr.save(dn,"."+Mn);var _n=on[Mn].append(Gt,pr);Array.isArray(_n)?rn(dn,".",Mn,"=[",_n.join(),"];"):rn(dn,".",Mn,"=",_n,";")}),pr(rn)}function jt(Gt,pr,on,dn){var cn=Gt.shared,rn=cn.gl,Mn=cn.framebuffer,_n;gn&&(_n=pr.def(cn.extensions,".webgl_draw_buffers"));var mr=Gt.constants,cn=mr.drawBuffer,mr=mr.backBuffer;Gt=on?on.append(Gt,pr):pr.def(Mn,".next"),dn||pr("if(",Gt,"!==",Mn,".cur){"),pr("if(",Gt,"){",rn,".bindFramebuffer(",36160,",",Gt,".framebuffer);"),gn&&pr(_n,".drawBuffersWEBGL(",cn,"[",Gt,".colorAttachments.length]);"),pr("}else{",rn,".bindFramebuffer(",36160,",null);"),gn&&pr(_n,".drawBuffersWEBGL(",mr,");"),pr("}",Mn,".cur=",Gt,";"),dn||pr("}")}function sr(Gt,pr,on){var dn=Gt.shared,rn=dn.gl,Mn=Gt.current,_n=Gt.next,cn=dn.current,mr=dn.next,br=Gt.cond(cn,".dirty");ha.forEach(function(Br){if(Br=Et(Br),!(Br in on.state)){var mn,On;if(Br in _n){mn=_n[Br],On=Mn[Br];var na=s(Sn[Br].length,function(Tn){return br.def(mn,"[",Tn,"]")});br(Gt.cond(na.map(function(Tn,Kn){return Tn+"!=="+On+"["+Kn+"]"}).join("||")).then(rn,".",In[Br],"(",na,");",na.map(function(Tn,Kn){return On+"["+Kn+"]="+Tn}).join(";"),";"))}else mn=br.def(mr,".",Br),na=Gt.cond(mn,"!==",cn,".",Br),br(na),Br in ra?na(Gt.cond(mn).then(rn,".enable(",ra[Br],");").else(rn,".disable(",ra[Br],");"),cn,".",Br,"=",mn,";"):na(rn,".",In[Br],"(",mn,");",cn,".",Br,"=",mn,";")}}),Object.keys(on.state).length===0&&br(cn,".dirty=false;"),pr(br)}function zr(Gt,pr,on,dn){var rn=Gt.shared,Mn=Gt.current,_n=rn.current,cn=rn.gl,mr;ee(Object.keys(on)).forEach(function(br){var Br=on[br];if(!dn||dn(Br)){var mn=Br.append(Gt,pr);if(ra[br]){var On=ra[br];J(Br)?(mr=Gt.link(mn,{stable:!0}),pr(Gt.cond(mr).then(cn,".enable(",On,");").else(cn,".disable(",On,");")),pr(_n,".",br,"=",mr,";")):(pr(Gt.cond(mn).then(cn,".enable(",On,");").else(cn,".disable(",On,");")),pr(_n,".",br,"=",mn,";"))}else if(w(mn)){var na=Mn[br];pr(cn,".",In[br],"(",mn,");",mn.map(function(Tn,Kn){return na+"["+Kn+"]="+Tn}).join(";"),";")}else J(Br)?(mr=Gt.link(mn,{stable:!0}),pr(cn,".",In[br],"(",mr,");",_n,".",br,"=",mr,";")):pr(cn,".",In[br],"(",mn,");",_n,".",br,"=",mn,";")}})}function Ur(Gt,pr){Mr&&(Gt.instancing=pr.def(Gt.shared.extensions,".angle_instanced_arrays"))}function Dr(Gt,pr,on,dn,rn){function Mn(){return typeof performance>"u"?"Date.now()":"performance.now()"}function _n(Kn){na=pr.def(),Kn(na,"=",Mn(),";"),typeof rn=="string"?Kn(Br,".count+=",rn,";"):Kn(Br,".count++;"),it&&(dn?(Tn=pr.def(),Kn(Tn,"=",On,".getNumPendingQueries();")):Kn(On,".beginQuery(",Br,");"))}function cn(Kn){Kn(Br,".cpuTime+=",Mn(),"-",na,";"),it&&(dn?Kn(On,".pushScopeStats(",Tn,",",On,".getNumPendingQueries(),",Br,");"):Kn(On,".endQuery();"))}function mr(Kn){var oa=pr.def(mn,".profile");pr(mn,".profile=",Kn,";"),pr.exit(mn,".profile=",oa,";")}var br=Gt.shared,Br=Gt.stats,mn=br.current,On=br.timer;on=on.profile;var na,Tn;if(on){if(J(on)){on.enable?(_n(pr),cn(pr.exit),mr("true")):mr("false");return}on=on.append(Gt,pr),mr(on)}else on=pr.def(mn,".profile");br=Gt.block(),_n(br),pr("if(",on,"){",br,"}"),Gt=Gt.block(),cn(Gt),pr.exit("if(",on,"){",Gt,"}")}function Tr(Gt,pr,on,dn,rn){function Mn(mr){switch(mr){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function _n(mr,br,Br){function mn(){pr("if(!",Kn,".buffer){",na,".enableVertexAttribArray(",Tn,");}");var ua=Br.type,Ea;Ea=Br.size?pr.def(Br.size,"||",br):br,pr("if(",Kn,".type!==",ua,"||",Kn,".size!==",Ea,"||",_a.map(function(Mo){return Kn+"."+Mo+"!=="+Br[Mo]}).join("||"),"){",na,".bindBuffer(",34962,",",oa,".buffer);",na,".vertexAttribPointer(",[Tn,Ea,ua,Br.normalized,Br.stride,Br.offset],");",Kn,".type=",ua,";",Kn,".size=",Ea,";",_a.map(function(Mo){return Kn+"."+Mo+"="+Br[Mo]+";"}).join(""),"}"),Mr&&(ua=Br.divisor,pr("if(",Kn,".divisor!==",ua,"){",Gt.instancing,".vertexAttribDivisorANGLE(",[Tn,ua],");",Kn,".divisor=",ua,";}"))}function On(){pr("if(",Kn,".buffer){",na,".disableVertexAttribArray(",Tn,");",Kn,".buffer=null;","}if(",Rt.map(function(ua,Ea){return Kn+"."+ua+"!=="+ma[Ea]}).join("||"),"){",na,".vertexAttrib4f(",Tn,",",ma,");",Rt.map(function(ua,Ea){return Kn+"."+ua+"="+ma[Ea]+";"}).join(""),"}")}var na=cn.gl,Tn=pr.def(mr,".location"),Kn=pr.def(cn.attributes,"[",Tn,"]");mr=Br.state;var oa=Br.buffer,ma=[Br.x,Br.y,Br.z,Br.w],_a=["buffer","normalized","offset","stride"];mr===1?mn():mr===2?On():(pr("if(",mr,"===",1,"){"),mn(),pr("}else{"),On(),pr("}"))}var cn=Gt.shared;dn.forEach(function(mr){var br=mr.name,Br=on.attributes[br],mn;if(Br){if(!rn(Br))return;mn=Br.append(Gt,pr)}else{if(!rn(an))return;var On=Gt.scopeAttrib(br);mn={},Object.keys(new $a).forEach(function(na){mn[na]=pr.def(On,".",na)})}_n(Gt.link(mr),Mn(mr.info.type),mn)})}function Wr(Gt,pr,on,dn,rn,Mn){for(var _n=Gt.shared,cn=_n.gl,mr,br=0;br<dn.length;++br){var na=dn[br],Br=na.name,mn=na.info.type,On=on.uniforms[Br],na=Gt.link(na)+".location",Tn;if(On){if(!rn(On))continue;if(J(On)){if(Br=On.value,mn===35678||mn===35680)mn=Gt.link(Br._texture||Br.color[0]._texture),pr(cn,".uniform1i(",na,",",mn+".bind());"),pr.exit(mn,".unbind();");else if(mn===35674||mn===35675||mn===35676)Br=Gt.global.def("new Float32Array(["+Array.prototype.slice.call(Br)+"])"),On=2,mn===35675?On=3:mn===35676&&(On=4),pr(cn,".uniformMatrix",On,"fv(",na,",false,",Br,");");else{switch(mn){case 5126:mr="1f";break;case 35664:mr="2f";break;case 35665:mr="3f";break;case 35666:mr="4f";break;case 35670:mr="1i";break;case 5124:mr="1i";break;case 35671:mr="2i";break;case 35667:mr="2i";break;case 35672:mr="3i";break;case 35668:mr="3i";break;case 35673:mr="4i";break;case 35669:mr="4i"}pr(cn,".uniform",mr,"(",na,",",w(Br)?Array.prototype.slice.call(Br):Br,");")}continue}else Tn=On.append(Gt,pr)}else{if(!rn(an))continue;Tn=pr.def(_n.uniforms,"[",er.id(Br),"]")}switch(mn===35678?pr("if(",Tn,"&&",Tn,'._reglType==="framebuffer"){',Tn,"=",Tn,".color[0];","}"):mn===35680&&pr("if(",Tn,"&&",Tn,'._reglType==="framebufferCube"){',Tn,"=",Tn,".color[0];","}"),Br=1,mn){case 35678:case 35680:mn=pr.def(Tn,"._texture"),pr(cn,".uniform1i(",na,",",mn,".bind());"),pr.exit(mn,".unbind();");continue;case 5124:case 35670:mr="1i";break;case 35667:case 35671:mr="2i",Br=2;break;case 35668:case 35672:mr="3i",Br=3;break;case 35669:case 35673:mr="4i",Br=4;break;case 5126:mr="1f";break;case 35664:mr="2f",Br=2;break;case 35665:mr="3f",Br=3;break;case 35666:mr="4f",Br=4;break;case 35674:mr="Matrix2fv";break;case 35675:mr="Matrix3fv";break;case 35676:mr="Matrix4fv"}if(mr.charAt(0)==="M"){pr(cn,".uniform",mr,"(",na,",");var na=Math.pow(mn-35674+2,2),Kn=Gt.global.def("new Float32Array(",na,")");Array.isArray(Tn)?pr("false,(",s(na,function(_a){return Kn+"["+_a+"]="+Tn[_a]}),",",Kn,")"):pr("false,(Array.isArray(",Tn,")||",Tn," instanceof Float32Array)?",Tn,":(",s(na,function(_a){return Kn+"["+_a+"]="+Tn+"["+_a+"]"}),",",Kn,")"),pr(");")}else{if(1<Br){for(var mn=[],oa=[],On=0;On<Br;++On)Array.isArray(Tn)?oa.push(Tn[On]):oa.push(pr.def(Tn+"["+On+"]")),Mn&&mn.push(pr.def());Mn&&pr("if(!",Gt.batchId,"||",mn.map(function(ma,_a){return ma+"!=="+oa[_a]}).join("||"),"){",mn.map(function(ma,_a){return ma+"="+oa[_a]+";"}).join("")),pr(cn,".uniform",mr,"(",na,",",oa.join(","),");")}else Mn&&(mn=pr.def(),pr("if(!",Gt.batchId,"||",mn,"!==",Tn,"){",mn,"=",Tn,";")),pr(cn,".uniform",mr,"(",na,",",Tn,");");Mn&&pr("}")}}}function An(Gt,pr,on,dn){function rn(ua){var Ea=Br[ua];return Ea?Ea.contextDep&&dn.contextDynamic||Ea.propDep?Ea.append(Gt,on):Ea.append(Gt,pr):pr.def(br,".",ua)}function Mn(){function ua(){on(oa,".drawElementsInstancedANGLE(",[On,Tn,ma,na+"<<(("+ma+"-5121)>>1)",Kn],");")}function Ea(){on(oa,".drawArraysInstancedANGLE(",[On,na,Tn,Kn],");")}mn&&mn!=="null"?_a?ua():(on("if(",mn,"){"),ua(),on("}else{"),Ea(),on("}")):Ea()}function _n(){function ua(){on(mr+".drawElements("+[On,Tn,ma,na+"<<(("+ma+"-5121)>>1)"]+");")}function Ea(){on(mr+".drawArrays("+[On,na,Tn]+");")}mn&&mn!=="null"?_a?ua():(on("if(",mn,"){"),ua(),on("}else{"),Ea(),on("}")):Ea()}var cn=Gt.shared,mr=cn.gl,br=cn.draw,Br=dn.draw,mn=function(){var ua=Br.elements,Ea=pr;return ua?((ua.contextDep&&dn.contextDynamic||ua.propDep)&&(Ea=on),ua=ua.append(Gt,Ea),Br.elementsActive&&Ea("if("+ua+")"+mr+".bindBuffer(34963,"+ua+".buffer.buffer);")):(ua=Ea.def(),Ea(ua,"=",br,".","elements",";","if(",ua,"){",mr,".bindBuffer(",34963,",",ua,".buffer.buffer);}","else if(",cn.vao,".currentVAO){",ua,"=",Gt.shared.elements+".getElements("+cn.vao,".currentVAO.elements);",hn?"":"if("+ua+")"+mr+".bindBuffer(34963,"+ua+".buffer.buffer);","}")),ua}(),On=rn("primitive"),na=rn("offset"),Tn=function(){var ua=Br.count,Ea=pr;return ua?((ua.contextDep&&dn.contextDynamic||ua.propDep)&&(Ea=on),ua=ua.append(Gt,Ea)):ua=Ea.def(br,".","count"),ua}();if(typeof Tn=="number"){if(Tn===0)return}else on("if(",Tn,"){"),on.exit("}");var Kn,oa;Mr&&(Kn=rn("instances"),oa=Gt.instancing);var ma=mn+".type",_a=Br.elements&&J(Br.elements)&&!Br.vaoActive;Mr&&(typeof Kn!="number"||0<=Kn)?typeof Kn=="string"?(on("if(",Kn,">0){"),Mn(),on("}else if(",Kn,"<0){"),_n(),on("}")):Mn():_n()}function vn(Gt,pr,on,dn,rn){return pr=Xt(),rn=pr.proc("body",rn),Mr&&(pr.instancing=rn.def(pr.shared.extensions,".angle_instanced_arrays")),Gt(pr,rn,on,dn),pr.compile().body}function Un(Gt,pr,on,dn){Ur(Gt,pr),on.useVAO?on.drawVAO?pr(Gt.shared.vao,".setVAO(",on.drawVAO.append(Gt,pr),");"):pr(Gt.shared.vao,".setVAO(",Gt.shared.vao,".targetVAO);"):(pr(Gt.shared.vao,".setVAO(null);"),Tr(Gt,pr,on,dn.attributes,function(){return!0})),Wr(Gt,pr,on,dn.uniforms,function(){return!0},!1),An(Gt,pr,pr,on)}function Dn(Gt,pr){var on=Gt.proc("draw",1);Ur(Gt,on),Ft(Gt,on,pr.context),jt(Gt,on,pr.framebuffer),sr(Gt,on,pr),zr(Gt,on,pr.state),Dr(Gt,on,pr,!1,!0);var dn=pr.shader.progVar.append(Gt,on);if(on(Gt.shared.gl,".useProgram(",dn,".program);"),pr.shader.program)Un(Gt,on,pr,pr.shader.program);else{on(Gt.shared.vao,".setVAO(null);");var rn=Gt.global.def("{}"),Mn=on.def(dn,".id"),_n=on.def(rn,"[",Mn,"]");on(Gt.cond(_n).then(_n,".call(this,a0);").else(_n,"=",rn,"[",Mn,"]=",Gt.link(function(cn){return vn(Un,Gt,pr,cn,1)}),"(",dn,");",_n,".call(this,a0);"))}0<Object.keys(pr.state).length&&on(Gt.shared.current,".dirty=true;"),Gt.shared.vao&&on(Gt.shared.vao,".setVAO(null);")}function Xn(Gt,pr,on,dn){function rn(){return!0}Gt.batchId="a1",Ur(Gt,pr),Tr(Gt,pr,on,dn.attributes,rn),Wr(Gt,pr,on,dn.uniforms,rn,!1),An(Gt,pr,pr,on)}function Yn(Gt,pr,on,dn){function rn(mn){return mn.contextDep&&_n||mn.propDep}function Mn(mn){return!rn(mn)}Ur(Gt,pr);var _n=on.contextDep,cn=pr.def(),mr=pr.def();Gt.shared.props=mr,Gt.batchId=cn;var br=Gt.scope(),Br=Gt.scope();pr(br.entry,"for(",cn,"=0;",cn,"<","a1",";++",cn,"){",mr,"=","a0","[",cn,"];",Br,"}",br.exit),on.needsContext&&Ft(Gt,Br,on.context),on.needsFramebuffer&&jt(Gt,Br,on.framebuffer),zr(Gt,Br,on.state,rn),on.profile&&rn(on.profile)&&Dr(Gt,Br,on,!1,!0),dn?(on.useVAO?on.drawVAO?rn(on.drawVAO)?Br(Gt.shared.vao,".setVAO(",on.drawVAO.append(Gt,Br),");"):br(Gt.shared.vao,".setVAO(",on.drawVAO.append(Gt,br),");"):br(Gt.shared.vao,".setVAO(",Gt.shared.vao,".targetVAO);"):(br(Gt.shared.vao,".setVAO(null);"),Tr(Gt,br,on,dn.attributes,Mn),Tr(Gt,Br,on,dn.attributes,rn)),Wr(Gt,br,on,dn.uniforms,Mn,!1),Wr(Gt,Br,on,dn.uniforms,rn,!0),An(Gt,br,Br,on)):(pr=Gt.global.def("{}"),dn=on.shader.progVar.append(Gt,Br),mr=Br.def(dn,".id"),br=Br.def(pr,"[",mr,"]"),Br(Gt.shared.gl,".useProgram(",dn,".program);","if(!",br,"){",br,"=",pr,"[",mr,"]=",Gt.link(function(mn){return vn(Xn,Gt,on,mn,2)}),"(",dn,");}",br,".call(this,a0[",cn,"],",cn,");"))}function ya(Gt,pr){function on(br){return br.contextDep&&rn||br.propDep}var dn=Gt.proc("batch",2);Gt.batchId="0",Ur(Gt,dn);var rn=!1,Mn=!0;Object.keys(pr.context).forEach(function(br){rn=rn||pr.context[br].propDep}),rn||(Ft(Gt,dn,pr.context),Mn=!1);var _n=pr.framebuffer,cn=!1;if(_n?(_n.propDep?rn=cn=!0:_n.contextDep&&rn&&(cn=!0),cn||jt(Gt,dn,_n)):jt(Gt,dn,null),pr.state.viewport&&pr.state.viewport.propDep&&(rn=!0),sr(Gt,dn,pr),zr(Gt,dn,pr.state,function(br){return!on(br)}),pr.profile&&on(pr.profile)||Dr(Gt,dn,pr,!1,"a1"),pr.contextDep=rn,pr.needsContext=Mn,pr.needsFramebuffer=cn,Mn=pr.shader.progVar,Mn.contextDep&&rn||Mn.propDep)Yn(Gt,dn,pr,null);else if(Mn=Mn.append(Gt,dn),dn(Gt.shared.gl,".useProgram(",Mn,".program);"),pr.shader.program)Yn(Gt,dn,pr,pr.shader.program);else{dn(Gt.shared.vao,".setVAO(null);");var _n=Gt.global.def("{}"),cn=dn.def(Mn,".id"),mr=dn.def(_n,"[",cn,"]");dn(Gt.cond(mr).then(mr,".call(this,a0,a1);").else(mr,"=",_n,"[",cn,"]=",Gt.link(function(mn){return vn(Yn,Gt,pr,mn,2)}),"(",Mn,");",mr,".call(this,a0,a1);"))}0<Object.keys(pr.state).length&&dn(Gt.shared.current,".dirty=true;"),Gt.shared.vao&&dn(Gt.shared.vao,".setVAO(null);")}function Ca(Gt,pr){function on(cn){var mr=pr.shader[cn];mr&&(mr=mr.append(Gt,dn),isNaN(mr)?dn.set(rn.shader,"."+cn,mr):dn.set(rn.shader,"."+cn,Gt.link(mr,{stable:!0})))}var dn=Gt.proc("scope",3);Gt.batchId="a2";var rn=Gt.shared,Mn=rn.current;if(Ft(Gt,dn,pr.context),pr.framebuffer&&pr.framebuffer.append(Gt,dn),ee(Object.keys(pr.state)).forEach(function(cn){var mr=pr.state[cn],br=mr.append(Gt,dn);w(br)?br.forEach(function(Br,mn){isNaN(Br)?dn.set(Gt.next[cn],"["+mn+"]",Br):dn.set(Gt.next[cn],"["+mn+"]",Gt.link(Br,{stable:!0}))}):J(mr)?dn.set(rn.next,"."+cn,Gt.link(br,{stable:!0})):dn.set(rn.next,"."+cn,br)}),Dr(Gt,dn,pr,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(cn){var mr=pr.draw[cn];mr&&(mr=mr.append(Gt,dn),isNaN(mr)?dn.set(rn.draw,"."+cn,mr):dn.set(rn.draw,"."+cn,Gt.link(mr),{stable:!0}))}),Object.keys(pr.uniforms).forEach(function(cn){var mr=pr.uniforms[cn].append(Gt,dn);Array.isArray(mr)&&(mr="["+mr.map(function(br){return isNaN(br)?br:Gt.link(br,{stable:!0})})+"]"),dn.set(rn.uniforms,"["+Gt.link(er.id(cn),{stable:!0})+"]",mr)}),Object.keys(pr.attributes).forEach(function(cn){var mr=pr.attributes[cn].append(Gt,dn),br=Gt.scopeAttrib(cn);Object.keys(new $a).forEach(function(Br){dn.set(br,"."+Br,mr[Br])})}),pr.scopeVAO){var _n=pr.scopeVAO.append(Gt,dn);isNaN(_n)?dn.set(rn.vao,".targetVAO",_n):dn.set(rn.vao,".targetVAO",Gt.link(_n,{stable:!0}))}on("vert"),on("frag"),0<Object.keys(pr.state).length&&(dn(Mn,".dirty=true;"),dn.exit(Mn,".dirty=true;")),dn("a1(",Gt.shared.context,",a0,",Gt.batchId,");")}function gi(Gt){if(typeof Gt=="object"&&!w(Gt)){for(var pr=Object.keys(Gt),on=0;on<pr.length;++on)if(oe.isDynamic(Gt[pr[on]]))return!0;return!1}}function Xa(Gt,pr,on){function dn(mn,On){_n.forEach(function(na){var Tn=rn[na];oe.isDynamic(Tn)&&(Tn=mn.invoke(On,Tn),On(Br,".",na,"=",Tn,";"))})}var rn=pr.static[on];if(rn&&gi(rn)){var Mn=Gt.global,_n=Object.keys(rn),cn=!1,mr=!1,br=!1,Br=Gt.global.def("{}");_n.forEach(function(mn){var On=rn[mn];if(oe.isDynamic(On))typeof On=="function"&&(On=rn[mn]=oe.unbox(On)),mn=ae(On,null),cn=cn||mn.thisDep,br=br||mn.propDep,mr=mr||mn.contextDep;else{switch(Mn(Br,".",mn,"="),typeof On){case"number":Mn(On);break;case"string":Mn('"',On,'"');break;case"object":Array.isArray(On)&&Mn("[",On.join(),"]");break;default:Mn(Gt.link(On))}Mn(";")}}),pr.dynamic[on]=new oe.DynamicVariable(4,{thisDep:cn,contextDep:mr,propDep:br,ref:Br,append:dn}),delete pr.static[on]}}var $a=St.Record,Ja={add:32774,subtract:32778,"reverse subtract":32779};Kt.ext_blend_minmax&&(Ja.min=32775,Ja.max=32776);var Mr=Kt.angle_instanced_arrays,gn=Kt.webgl_draw_buffers,hn=Kt.oes_vertex_array_object,Sn={dirty:!0,profile:ht.profile},Jn={},ha=[],ra={},In={};yt("dither",3024),yt("blend.enable",3042),Dt("blend.color","blendColor",[0,0,0,0]),Dt("blend.equation","blendEquationSeparate",[32774,32774]),Dt("blend.func","blendFuncSeparate",[1,0,1,0]),yt("depth.enable",2929,!0),Dt("depth.func","depthFunc",513),Dt("depth.range","depthRange",[0,1]),Dt("depth.mask","depthMask",!0),Dt("colorMask","colorMask",[!0,!0,!0,!0]),yt("cull.enable",2884),Dt("cull.face","cullFace",1029),Dt("frontFace","frontFace",2305),Dt("lineWidth","lineWidth",1),yt("polygonOffset.enable",32823),Dt("polygonOffset.offset","polygonOffset",[0,0]),yt("sample.alpha",32926),yt("sample.enable",32928),Dt("sample.coverage","sampleCoverage",[1,!1]),yt("stencil.enable",2960),Dt("stencil.mask","stencilMask",-1),Dt("stencil.func","stencilFunc",[519,0,-1]),Dt("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),Dt("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),yt("scissor.enable",3089),Dt("scissor.box","scissor",[0,0,ot.drawingBufferWidth,ot.drawingBufferHeight]),Dt("viewport","viewport",[0,0,ot.drawingBufferWidth,ot.drawingBufferHeight]);var jn={gl:ot,context:ke,strings:er,next:Jn,current:Sn,draw:Pe,elements:et,buffer:Ar,shader:Ut,attributes:St.state,vao:St,uniforms:ft,framebuffer:st,extensions:Kt,timer:it,isBufferArgs:Y},Ga={primTypes:We,compareFuncs:Yt,blendFuncs:Jt,blendEquations:Ja,stencilOps:or,glTypes:Ce,orientationType:Hr};gn&&(Ga.backBuffer=[1029],Ga.drawBuffer=s(ur.maxDrawbuffers,function(Gt){return Gt===0?[0]:s(Gt,function(pr){return 36064+pr})}));var vi=0;return{next:Jn,current:Sn,procs:function(){var Gt=Xt(),pr=Gt.proc("poll"),on=Gt.proc("refresh"),dn=Gt.block();pr(dn),on(dn);var mr=Gt.shared,rn=mr.gl,Mn=mr.next,_n=mr.current;dn(_n,".dirty=false;"),jt(Gt,pr),jt(Gt,on,null,!0);var cn;Mr&&(cn=Gt.link(Mr)),Kt.oes_vertex_array_object&&on(Gt.link(Kt.oes_vertex_array_object),".bindVertexArrayOES(null);");var mr=on.def(mr.attributes),br=on.def(0),Br=Gt.cond(br,".buffer");Br.then(rn,".enableVertexAttribArray(i);",rn,".bindBuffer(",34962,",",br,".buffer.buffer);",rn,".vertexAttribPointer(i,",br,".size,",br,".type,",br,".normalized,",br,".stride,",br,".offset);").else(rn,".disableVertexAttribArray(i);",rn,".vertexAttrib4f(i,",br,".x,",br,".y,",br,".z,",br,".w);",br,".buffer=null;");var mn=Gt.link(ur.maxAttributes,{stable:!0});return on("for(var i=0;i<",mn,";++i){",br,"=",mr,"[i];",Br,"}"),Mr&&on("for(var i=0;i<",mn,";++i){",cn,".vertexAttribDivisorANGLE(i,",mr,"[i].divisor);","}"),on(Gt.shared.vao,".currentVAO=null;",Gt.shared.vao,".setVAO(",Gt.shared.vao,".targetVAO);"),Object.keys(ra).forEach(function(On){var na=ra[On],Tn=dn.def(Mn,".",On),Kn=Gt.block();Kn("if(",Tn,"){",rn,".enable(",na,")}else{",rn,".disable(",na,")}",_n,".",On,"=",Tn,";"),on(Kn),pr("if(",Tn,"!==",_n,".",On,"){",Kn,"}")}),Object.keys(In).forEach(function(On){var na=In[On],Tn=Sn[On],Kn,oa,ma=Gt.block();ma(rn,".",na,"("),w(Tn)?(na=Tn.length,Kn=Gt.global.def(Mn,".",On),oa=Gt.global.def(_n,".",On),ma(s(na,function(_a){return Kn+"["+_a+"]"}),");",s(na,function(_a){return oa+"["+_a+"]="+Kn+"["+_a+"];"}).join("")),pr("if(",s(na,function(_a){return Kn+"["+_a+"]!=="+oa+"["+_a+"]"}).join("||"),"){",ma,"}")):(Kn=dn.def(Mn,".",On),oa=dn.def(_n,".",On),ma(Kn,");",_n,".",On,"=",Kn,";"),pr("if(",Kn,"!==",oa,"){",ma,"}")),on(ma)}),Gt.compile()}(),compile:function(Gt,pr,on,dn,rn){var Mn=Xt();Mn.stats=Mn.link(rn),Object.keys(pr.static).forEach(function(cn){Xa(Mn,pr,cn)}),Vt.forEach(function(cn){Xa(Mn,Gt,cn)});var _n=at(Gt,pr,on,dn,Mn);return _n.shader.program&&(_n.shader.program.attributes.sort(function(cn,mr){return cn.name<mr.name?-1:1}),_n.shader.program.uniforms.sort(function(cn,mr){return cn.name<mr.name?-1:1})),Dn(Mn,_n),Ca(Mn,_n),ya(Mn,_n),se(Mn.compile(),{destroy:function(){_n.shader.program.destroy()}})}}}function ie(ot,er){for(var Kt=0;Kt<ot.length;++Kt)if(ot[Kt]===er)return Kt;return-1}var se=function(ot,er){for(var Kt=Object.keys(er),ur=0;ur<Kt.length;++ur)ot[Kt[ur]]=er[Kt[ur]];return ot},xe=0,oe={DynamicVariable:h,define:function(ot,er){return new h(ot,A(er+""))},isDynamic:function(ot){return typeof ot=="function"&&!ot._reglType||ot instanceof h},unbox:T,accessor:A},he={next:typeof requestAnimationFrame=="function"?function(ot){return requestAnimationFrame(ot)}:function(ot){return setTimeout(ot,16)},cancel:typeof cancelAnimationFrame=="function"?function(ot){return cancelAnimationFrame(ot)}:clearTimeout},be=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date},me=g();me.zero=g();var _e=function(ot,er){var Kt=1;er.ext_texture_filter_anisotropic&&(Kt=ot.getParameter(34047));var ur=1,Ar=1;er.webgl_draw_buffers&&(ur=ot.getParameter(34852),Ar=ot.getParameter(36063));var et=!!er.oes_texture_float;if(et){et=ot.createTexture(),ot.bindTexture(3553,et),ot.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var $e=ot.createFramebuffer();if(ot.bindFramebuffer(36160,$e),ot.framebufferTexture2D(36160,36064,3553,et,0),ot.bindTexture(3553,null),ot.checkFramebufferStatus(36160)!==36053)et=!1;else{ot.viewport(0,0,1,1),ot.clearColor(1,0,0,1),ot.clear(16384);var st=me.allocType(5126,4);ot.readPixels(0,0,1,1,6408,5126,st),ot.getError()?et=!1:(ot.deleteFramebuffer($e),ot.deleteTexture(et),et=st[0]===1),me.freeType(st)}}return st=!0,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(st=ot.createTexture(),$e=me.allocType(5121,36),ot.activeTexture(33984),ot.bindTexture(34067,st),ot.texImage2D(34069,0,6408,3,3,0,6408,5121,$e),me.freeType($e),ot.bindTexture(34067,null),ot.deleteTexture(st),st=!ot.getError()),{colorBits:[ot.getParameter(3410),ot.getParameter(3411),ot.getParameter(3412),ot.getParameter(3413)],depthBits:ot.getParameter(3414),stencilBits:ot.getParameter(3415),subpixelBits:ot.getParameter(3408),extensions:Object.keys(er).filter(function(ft){return!!er[ft]}),maxAnisotropic:Kt,maxDrawbuffers:ur,maxColorAttachments:Ar,pointSizeDims:ot.getParameter(33901),lineWidthDims:ot.getParameter(33902),maxViewportDims:ot.getParameter(3386),maxCombinedTextureUnits:ot.getParameter(35661),maxCubeMapSize:ot.getParameter(34076),maxRenderbufferSize:ot.getParameter(34024),maxTextureUnits:ot.getParameter(34930),maxTextureSize:ot.getParameter(3379),maxAttributes:ot.getParameter(34921),maxVertexUniforms:ot.getParameter(36347),maxVertexTextureUnits:ot.getParameter(35660),maxVaryingVectors:ot.getParameter(36348),maxFragmentUniforms:ot.getParameter(36349),glsl:ot.getParameter(35724),renderer:ot.getParameter(7937),vendor:ot.getParameter(7936),version:ot.getParameter(7938),readFloat:et,npotTextureCube:st}},Se=function(ot){return ot instanceof Uint8Array||ot instanceof Uint16Array||ot instanceof Uint32Array||ot instanceof Int8Array||ot instanceof Int16Array||ot instanceof Int32Array||ot instanceof Float32Array||ot instanceof Float64Array||ot instanceof Uint8ClampedArray},De=function(ot){return Object.keys(ot).map(function(er){return ot[er]})},Ie={shape:function(ot){for(var er=[];ot.length;ot=ot[0])er.push(ot.length);return er},flatten:function(ot,er,Kt,ur){var Ar=1;if(er.length)for(var et=0;et<er.length;++et)Ar*=er[et];else Ar=0;switch(Kt=ur||me.allocType(Kt,Ar),er.length){case 0:break;case 1:for(ur=er[0],er=0;er<ur;++er)Kt[er]=ot[er];break;case 2:for(ur=er[0],er=er[1],et=Ar=0;et<ur;++et)for(var $e=ot[et],st=0;st<er;++st)Kt[Ar++]=$e[st];break;case 3:v(ot,er[0],er[1],er[2],Kt,0);break;default:x(ot,er,0,Kt,0)}return Kt}},Te={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Ce={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},He={dynamic:35048,stream:35040,static:35044},Xe=Ie.flatten,Be=Ie.shape,Re=[];Re[5120]=1,Re[5122]=2,Re[5124]=4,Re[5121]=1,Re[5123]=2,Re[5125]=4,Re[5126]=4;var We={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},vt=new Float32Array(1),Pt=new Uint32Array(vt.buffer),Zt=[9984,9986,9985,9987],zt=[0,6409,6410,6407,6408],At={};At[6409]=At[6406]=At[6402]=1,At[34041]=At[6410]=2,At[6407]=At[35904]=3,At[6408]=At[35906]=4;var Wt=d("HTMLCanvasElement"),Bt=d("OffscreenCanvas"),Ct=d("CanvasRenderingContext2D"),Ze=d("ImageBitmap"),nt=d("HTMLImageElement"),Ye=d("HTMLVideoElement"),Ee=Object.keys(Te).concat([Wt,Bt,Ct,Ze,nt,Ye]),Ge=[];Ge[5121]=1,Ge[5126]=4,Ge[36193]=2,Ge[5123]=2,Ge[5125]=4;var Je=[];Je[32854]=2,Je[32855]=2,Je[36194]=2,Je[34041]=4,Je[33776]=.5,Je[33777]=.5,Je[33778]=1,Je[33779]=1,Je[35986]=.5,Je[35987]=1,Je[34798]=1,Je[35840]=.5,Je[35841]=.25,Je[35842]=.5,Je[35843]=.25,Je[36196]=.5;var qe=[];qe[32854]=2,qe[32855]=2,qe[36194]=2,qe[33189]=2,qe[36168]=1,qe[34041]=4,qe[35907]=4,qe[34836]=16,qe[34842]=8,qe[34843]=6;var Tt=function(ot,er,Kt,ur,Ar){function et(Pe){this.id=St++,this.refCount=1,this.renderbuffer=Pe,this.format=32854,this.height=this.width=0,Ar.profile&&(this.stats={size:0})}function $e(Pe){var ke=Pe.renderbuffer;ot.bindRenderbuffer(36161,null),ot.deleteRenderbuffer(ke),Pe.renderbuffer=null,Pe.refCount=0,delete Ut[Pe.id],ur.renderbufferCount--}var st={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};er.ext_srgb&&(st.srgba=35907),er.ext_color_buffer_half_float&&(st.rgba16f=34842,st.rgb16f=34843),er.webgl_color_buffer_float&&(st.rgba32f=34836);var ft=[];Object.keys(st).forEach(function(Pe){ft[st[Pe]]=Pe});var St=0,Ut={};return et.prototype.decRef=function(){0>=--this.refCount&&$e(this)},Ar.profile&&(ur.getTotalRenderbufferSize=function(){var Pe=0;return Object.keys(Ut).forEach(function(ke){Pe+=Ut[ke].stats.size}),Pe}),{create:function(Pe,ke){function it(ht,Et){var yt=0,Dt=0,Xt=32854;if(typeof ht=="object"&&ht?("shape"in ht?(Dt=ht.shape,yt=Dt[0]|0,Dt=Dt[1]|0):("radius"in ht&&(yt=Dt=ht.radius|0),"width"in ht&&(yt=ht.width|0),"height"in ht&&(Dt=ht.height|0)),"format"in ht&&(Xt=st[ht.format])):typeof ht=="number"?(yt=ht|0,Dt=typeof Et=="number"?Et|0:yt):ht||(yt=Dt=1),yt!==ut.width||Dt!==ut.height||Xt!==ut.format)return it.width=ut.width=yt,it.height=ut.height=Dt,ut.format=Xt,ot.bindRenderbuffer(36161,ut.renderbuffer),ot.renderbufferStorage(36161,Xt,yt,Dt),Ar.profile&&(ut.stats.size=qe[ut.format]*ut.width*ut.height),it.format=ft[ut.format],it}var ut=new et(ot.createRenderbuffer());return Ut[ut.id]=ut,ur.renderbufferCount++,it(Pe,ke),it.resize=function(ht,Et){var yt=ht|0,Dt=Et|0||yt;return yt===ut.width&&Dt===ut.height||(it.width=ut.width=yt,it.height=ut.height=Dt,ot.bindRenderbuffer(36161,ut.renderbuffer),ot.renderbufferStorage(36161,ut.format,yt,Dt),Ar.profile&&(ut.stats.size=qe[ut.format]*ut.width*ut.height)),it},it._reglType="renderbuffer",it._renderbuffer=ut,Ar.profile&&(it.stats=ut.stats),it.destroy=function(){ut.decRef()},it},clear:function(){De(Ut).forEach($e)},restore:function(){De(Ut).forEach(function(Pe){Pe.renderbuffer=ot.createRenderbuffer(),ot.bindRenderbuffer(36161,Pe.renderbuffer),ot.renderbufferStorage(36161,Pe.format,Pe.width,Pe.height)}),ot.bindRenderbuffer(36161,null)}}},mt=[];mt[6408]=4,mt[6407]=3;var Mt=[];Mt[5121]=1,Mt[5126]=4,Mt[36193]=2;var Ht=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Rt=["x","y","z","w"],Vt="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Jt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Yt={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},or={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Hr={cw:2304,ccw:2305},an=new ne(!1,!1,!1,function(){}),Kr=function(ot,er){function Kt(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function ur(Ut,Pe,ke){var it=$e.pop()||new Kt;it.startQueryIndex=Ut,it.endQueryIndex=Pe,it.sum=0,it.stats=ke,st.push(it)}if(!er.ext_disjoint_timer_query)return null;var Ar=[],et=[],$e=[],st=[],ft=[],St=[];return{beginQuery:function(Ut){var Pe=Ar.pop()||er.ext_disjoint_timer_query.createQueryEXT();er.ext_disjoint_timer_query.beginQueryEXT(35007,Pe),et.push(Pe),ur(et.length-1,et.length,Ut)},endQuery:function(){er.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:ur,update:function(){var Ut,Pe;if(Ut=et.length,Ut!==0){St.length=Math.max(St.length,Ut+1),ft.length=Math.max(ft.length,Ut+1),ft[0]=0;var ke=St[0]=0;for(Pe=Ut=0;Pe<et.length;++Pe){var it=et[Pe];er.ext_disjoint_timer_query.getQueryObjectEXT(it,34919)?(ke+=er.ext_disjoint_timer_query.getQueryObjectEXT(it,34918),Ar.push(it)):et[Ut++]=it,ft[Pe+1]=ke,St[Pe+1]=Ut}for(et.length=Ut,Pe=Ut=0;Pe<st.length;++Pe){var ke=st[Pe],ut=ke.startQueryIndex,it=ke.endQueryIndex;ke.sum+=ft[it]-ft[ut],ut=St[ut],it=St[it],it===ut?(ke.stats.gpuTime+=ke.sum/1e6,$e.push(ke)):(ke.startQueryIndex=ut,ke.endQueryIndex=it,st[Ut++]=ke)}st.length=Ut}},getNumPendingQueries:function(){return et.length},clear:function(){Ar.push.apply(Ar,et);for(var Ut=0;Ut<Ar.length;Ut++)er.ext_disjoint_timer_query.deleteQueryEXT(Ar[Ut]);et.length=0,Ar.length=0},restore:function(){et.length=0,Ar.length=0}}};return function(ot){function er(){if(Dr.length===0)Xt&&Xt.update(),vn=null;else{vn=he.next(er),Ut();for(var Dn=Dr.length-1;0<=Dn;--Dn){var Xn=Dr[Dn];Xn&&Xn(wr,null,0)}it.flush(),Xt&&Xt.update()}}function Kt(){!vn&&0<Dr.length&&(vn=he.next(er))}function ur(){vn&&(he.cancel(er),vn=null)}function Ar(Dn){Dn.preventDefault(),ur(),Tr.forEach(function(Xn){Xn()})}function et(Dn){it.getError(),ht.restore(),Or.restore(),ir.restore(),Cr.restore(),at.restore(),Ft.restore(),Fr.restore(),Xt&&Xt.restore(),jt.procs.refresh(),Kt(),Wr.forEach(function(Xn){Xn()})}function $e(Dn){function Xn(Sn,Jn){var ha={},ra={};return Object.keys(Sn).forEach(function(In){var jn=Sn[In];if(oe.isDynamic(jn))ra[In]=oe.unbox(jn,In);else{if(Jn&&Array.isArray(jn)){for(var Ga=0;Ga<jn.length;++Ga)if(oe.isDynamic(jn[Ga])){ra[In]=oe.unbox(jn,In);return}}ha[In]=jn}}),{dynamic:ra,static:ha}}function Yn(Sn){for(;hn.length<Sn;)hn.push(null);return hn}var ya=Xn(Dn.context||{},!0),Ca=Xn(Dn.uniforms||{},!0),gi=Xn(Dn.attributes||{},!1);Dn=Xn(function(Sn){function Jn(ra){if(ra in ha){var In=ha[ra];delete ha[ra],Object.keys(In).forEach(function(jn){ha[ra+"."+jn]=In[jn]})}}var ha=se({},Sn);return delete ha.uniforms,delete ha.attributes,delete ha.context,delete ha.vao,"stencil"in ha&&ha.stencil.op&&(ha.stencil.opBack=ha.stencil.opFront=ha.stencil.op,delete ha.stencil.op),Jn("blend"),Jn("depth"),Jn("cull"),Jn("stencil"),Jn("polygonOffset"),Jn("scissor"),Jn("sample"),"vao"in Sn&&(ha.vao=Sn.vao),ha}(Dn),!1);var Xa={gpuTime:0,cpuTime:0,count:0},$a=jt.compile(Dn,gi,Ca,ya,Xa),Ja=$a.draw,Mr=$a.batch,gn=$a.scope,hn=[];return se(function(Sn,Jn){var ha;if(typeof Sn=="function")return gn.call(this,null,Sn,0);if(typeof Jn=="function")if(typeof Sn=="number")for(ha=0;ha<Sn;++ha)gn.call(this,null,Jn,ha);else if(Array.isArray(Sn))for(ha=0;ha<Sn.length;++ha)gn.call(this,Sn[ha],Jn,ha);else return gn.call(this,Sn,Jn,0);else if(typeof Sn=="number"){if(0<Sn)return Mr.call(this,Yn(Sn|0),Sn|0)}else if(Array.isArray(Sn)){if(Sn.length)return Mr.call(this,Sn,Sn.length)}else return Ja.call(this,Sn)},{stats:Xa,destroy:function(){$a.destroy()}})}function st(Dn,Xn){var Yn=0;jt.procs.poll();var ya=Xn.color;ya&&(it.clearColor(+ya[0]||0,+ya[1]||0,+ya[2]||0,+ya[3]||0),Yn|=16384),"depth"in Xn&&(it.clearDepth(+Xn.depth),Yn|=256),"stencil"in Xn&&(it.clearStencil(Xn.stencil|0),Yn|=1024),it.clear(Yn)}function ft(Dn){return Dr.push(Dn),Kt(),{cancel:function(){function Xn(){var ya=ie(Dr,Xn);Dr[ya]=Dr[Dr.length-1],--Dr.length,0>=Dr.length&&ur()}var Yn=ie(Dr,Dn);Dr[Yn]=Xn}}}function St(){var Dn=zr.viewport,Xn=zr.scissor_box;Dn[0]=Dn[1]=Xn[0]=Xn[1]=0,wr.viewportWidth=wr.framebufferWidth=wr.drawingBufferWidth=Dn[2]=Xn[2]=it.drawingBufferWidth,wr.viewportHeight=wr.framebufferHeight=wr.drawingBufferHeight=Dn[3]=Xn[3]=it.drawingBufferHeight}function Ut(){wr.tick+=1,wr.time=ke(),St(),jt.procs.poll()}function Pe(){Cr.refresh(),St(),jt.procs.refresh(),Xt&&Xt.update()}function ke(){return(be()-ar)/1e3}if(ot=f(ot),!ot)return null;var it=ot.gl,ut=it.getContextAttributes();it.isContextLost();var ht=o(it,ot);if(!ht)return null;var sr=e(),Et={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},yt=ot.cachedCode||{},Dt=ht.extensions,Xt=Kr(it,Dt),ar=be(),Sr=it.drawingBufferWidth,kr=it.drawingBufferHeight,wr={tick:0,time:0,viewportWidth:Sr,viewportHeight:kr,framebufferWidth:Sr,framebufferHeight:kr,drawingBufferWidth:Sr,drawingBufferHeight:kr,pixelRatio:ot.pixelRatio},Sr={elements:null,primitive:4,count:-1,offset:0,instances:-1},Zr=_e(it,Dt),ir=M(it,Et,ot,function(Dn){return Fr.destroyBuffer(Dn)}),xr=_(it,Dt,ir,Et),Fr=N(it,Dt,Zr,Et,ir,xr,Sr),Or=V(it,sr,Et,ot),Cr=F(it,Dt,Zr,function(){jt.procs.poll()},wr,Et,ot),at=Tt(it,Dt,Zr,Et,ot),Ft=I(it,Dt,Zr,Cr,at,Et),jt=le(it,sr,Dt,Zr,ir,xr,Cr,Ft,{},Fr,Or,Sr,wr,Xt,yt,ot),sr=H(it,Ft,jt.procs.poll,wr),zr=jt.next,Ur=it.canvas,Dr=[],Tr=[],Wr=[],An=[ot.onDestroy],vn=null;Ur&&(Ur.addEventListener("webglcontextlost",Ar,!1),Ur.addEventListener("webglcontextrestored",et,!1));var Un=Ft.setFBO=$e({framebuffer:oe.define.call(null,1,"framebuffer")});return Pe(),ut=se($e,{clear:function(Dn){if("framebuffer"in Dn)if(Dn.framebuffer&&Dn.framebuffer_reglType==="framebufferCube")for(var Xn=0;6>Xn;++Xn)Un(se({framebuffer:Dn.framebuffer.faces[Xn]},Dn),st);else Un(Dn,st);else st(null,Dn)},prop:oe.define.bind(null,1),context:oe.define.bind(null,2),this:oe.define.bind(null,3),draw:$e({}),buffer:function(Dn){return ir.create(Dn,34962,!1,!1)},elements:function(Dn){return xr.create(Dn,!1)},texture:Cr.create2D,cube:Cr.createCube,renderbuffer:at.create,framebuffer:Ft.create,framebufferCube:Ft.createCube,vao:Fr.createVAO,attributes:ut,frame:ft,on:function(Dn,Xn){var Yn;switch(Dn){case"frame":return ft(Xn);case"lost":Yn=Tr;break;case"restore":Yn=Wr;break;case"destroy":Yn=An}return Yn.push(Xn),{cancel:function(){for(var ya=0;ya<Yn.length;++ya)if(Yn[ya]===Xn){Yn[ya]=Yn[Yn.length-1],Yn.pop();break}}}},limits:Zr,hasExtension:function(Dn){return 0<=Zr.extensions.indexOf(Dn.toLowerCase())},read:sr,destroy:function(){Dr.length=0,ur(),Ur&&(Ur.removeEventListener("webglcontextlost",Ar),Ur.removeEventListener("webglcontextrestored",et)),Or.clear(),Ft.clear(),at.clear(),Fr.clear(),Cr.clear(),xr.clear(),ir.clear(),Xt&&Xt.clear(),An.forEach(function(Dn){Dn()})},_gl:it,_refresh:Pe,poll:function(){Ut(),Xt&&Xt.update()},now:ke,stats:Et,getCachedCode:function(){return yt},preloadCachedCode:function(Dn){Object.entries(Dn).forEach(function(Xn){yt[Xn[0]]=Xn[1]})}}),ot.onDone(null,ut),ut}})},{}],285:[function(t,P,R){var h=t("buffer"),u=h.Buffer;function A(e,i){for(var n in e)i[n]=e[n]}u.from&&u.alloc&&u.allocUnsafe&&u.allocUnsafeSlow?P.exports=h:(A(h,R),R.Buffer=T);function T(e,i,n){return u(e,i,n)}T.prototype=Object.create(u.prototype),A(u,T),T.from=function(e,i,n){if(typeof e=="number")throw new TypeError("Argument must not be a number");return u(e,i,n)},T.alloc=function(e,i,n){if(typeof e!="number")throw new TypeError("Argument must be a number");var a=u(e);return i!==void 0?typeof n=="string"?a.fill(i,n):a.fill(i):a.fill(0),a},T.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return u(e)},T.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return h.SlowBuffer(e)}},{buffer:85}],286:[function(t,P,R){P.exports=A;var h=t("events").EventEmitter,u=t("inherits");u(A,h),A.Readable=t("readable-stream/lib/_stream_readable.js"),A.Writable=t("readable-stream/lib/_stream_writable.js"),A.Duplex=t("readable-stream/lib/_stream_duplex.js"),A.Transform=t("readable-stream/lib/_stream_transform.js"),A.PassThrough=t("readable-stream/lib/_stream_passthrough.js"),A.finished=t("readable-stream/lib/internal/streams/end-of-stream.js"),A.pipeline=t("readable-stream/lib/internal/streams/pipeline.js"),A.Stream=A;function A(){h.call(this)}A.prototype.pipe=function(T,e){var i=this;function n(g){T.writable&&T.write(g)===!1&&i.pause&&i.pause()}i.on("data",n);function a(){i.readable&&i.resume&&i.resume()}T.on("drain",a),!T._isStdio&&(!e||e.end!==!1)&&(i.on("end",f),i.on("close",o));var r=!1;function f(){r||(r=!0,T.end())}function o(){r||(r=!0,typeof T.destroy=="function"&&T.destroy())}function s(g){if(m(),h.listenerCount(this,"error")===0)throw g}i.on("error",s),T.on("error",s);function m(){i.removeListener("data",n),T.removeListener("drain",a),i.removeListener("end",f),i.removeListener("close",o),i.removeListener("error",s),T.removeListener("error",s),i.removeListener("end",m),i.removeListener("close",m),T.removeListener("close",m)}return i.on("end",m),i.on("close",m),T.on("close",m),T.emit("pipe",i),T}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":288,"readable-stream/lib/_stream_passthrough.js":289,"readable-stream/lib/_stream_readable.js":290,"readable-stream/lib/_stream_transform.js":291,"readable-stream/lib/_stream_writable.js":292,"readable-stream/lib/internal/streams/end-of-stream.js":296,"readable-stream/lib/internal/streams/pipeline.js":298}],287:[function(t,P,R){function h(a,r){a.prototype=Object.create(r.prototype),a.prototype.constructor=a,a.__proto__=r}var u={};function A(a,r,f){f||(f=Error);function o(m,g,p){return typeof r=="string"?r:r(m,g,p)}var s=function(m){h(g,m);function g(p,v,x){return m.call(this,o(p,v,x))||this}return g}(f);s.prototype.name=f.name,s.prototype.code=a,u[a]=s}function T(a,r){if(Array.isArray(a)){var f=a.length;return a=a.map(function(o){return String(o)}),f>2?"one of ".concat(r," ").concat(a.slice(0,f-1).join(", "),", or ")+a[f-1]:f===2?"one of ".concat(r," ").concat(a[0]," or ").concat(a[1]):"of ".concat(r," ").concat(a[0])}else return"of ".concat(r," ").concat(String(a))}function e(a,r,f){return a.substr(!f||f<0?0:+f,r.length)===r}function i(a,r,f){return(f===void 0||f>a.length)&&(f=a.length),a.substring(f-r.length,f)===r}function n(a,r,f){return typeof f!="number"&&(f=0),f+r.length>a.length?!1:a.indexOf(r,f)!==-1}A("ERR_INVALID_OPT_VALUE",function(a,r){return'The value "'+r+'" is invalid for option "'+a+'"'},TypeError),A("ERR_INVALID_ARG_TYPE",function(a,r,f){var o;typeof r=="string"&&e(r,"not ")?(o="must not be",r=r.replace(/^not /,"")):o="must be";var s;if(i(a," argument"))s="The ".concat(a," ").concat(o," ").concat(T(r,"type"));else{var m=n(a,".")?"property":"argument";s='The "'.concat(a,'" ').concat(m," ").concat(o," ").concat(T(r,"type"))}return s+=". Received type ".concat(typeof f),s},TypeError),A("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),A("ERR_METHOD_NOT_IMPLEMENTED",function(a){return"The "+a+" method is not implemented"}),A("ERR_STREAM_PREMATURE_CLOSE","Premature close"),A("ERR_STREAM_DESTROYED",function(a){return"Cannot call "+a+" after a stream was destroyed"}),A("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),A("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),A("ERR_STREAM_WRITE_AFTER_END","write after end"),A("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),A("ERR_UNKNOWN_ENCODING",function(a){return"Unknown encoding: "+a},TypeError),A("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),P.exports.codes=u},{}],288:[function(t,P,R){(function(h){(function(){var u=Object.keys||function(o){var s=[];for(var m in o)s.push(m);return s};P.exports=a;var A=t("./_stream_readable"),T=t("./_stream_writable");t("inherits")(a,A);for(var e=u(T.prototype),i=0;i<e.length;i++){var n=e[i];a.prototype[n]||(a.prototype[n]=T.prototype[n])}function a(o){if(!(this instanceof a))return new a(o);A.call(this,o),T.call(this,o),this.allowHalfOpen=!0,o&&(o.readable===!1&&(this.readable=!1),o.writable===!1&&(this.writable=!1),o.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",r)))}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function r(){this._writableState.ended||h.nextTick(f,this)}function f(o){o.end()}Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(s){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=s,this._writableState.destroyed=s)}})}).call(this)}).call(this,t("_process"))},{"./_stream_readable":290,"./_stream_writable":292,_process:278,inherits:231}],289:[function(t,P,R){P.exports=u;var h=t("./_stream_transform");t("inherits")(u,h);function u(A){if(!(this instanceof u))return new u(A);h.call(this,A)}u.prototype._transform=function(A,T,e){e(null,A)}},{"./_stream_transform":291,inherits:231}],290:[function(t,P,R){(function(h,u){(function(){P.exports=E;var A;E.ReadableState=S,t("events").EventEmitter;var T=function(ae,le){return ae.listeners(le).length},e=t("./internal/streams/stream"),i=t("buffer").Buffer,n=u.Uint8Array||function(){};function a(q){return i.from(q)}function r(q){return i.isBuffer(q)||q instanceof n}var f=t("util"),o;f&&f.debuglog?o=f.debuglog("stream"):o=function(){};var s=t("./internal/streams/buffer_list"),m=t("./internal/streams/destroy"),g=t("./internal/streams/state"),p=g.getHighWaterMark,v=t("../errors").codes,x=v.ERR_INVALID_ARG_TYPE,l=v.ERR_STREAM_PUSH_AFTER_EOF,b=v.ERR_METHOD_NOT_IMPLEMENTED,c=v.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,M,_,y;t("inherits")(E,e);var w=m.errorOrDestroy,d=["error","close","destroy","pause","resume"];function C(q,ae,le){if(typeof q.prependListener=="function")return q.prependListener(ae,le);!q._events||!q._events[ae]?q.on(ae,le):Array.isArray(q._events[ae])?q._events[ae].unshift(le):q._events[ae]=[le,q._events[ae]]}function S(q,ae,le){A=A||t("./_stream_duplex"),q=q||{},typeof le!="boolean"&&(le=ae instanceof A),this.objectMode=!!q.objectMode,le&&(this.objectMode=this.objectMode||!!q.readableObjectMode),this.highWaterMark=p(this,q,"readableHighWaterMark",le),this.buffer=new s,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=q.emitClose!==!1,this.autoDestroy=!!q.autoDestroy,this.destroyed=!1,this.defaultEncoding=q.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,q.encoding&&(M||(M=t("string_decoder/").StringDecoder),this.decoder=new M(q.encoding),this.encoding=q.encoding)}function E(q){if(A=A||t("./_stream_duplex"),!(this instanceof E))return new E(q);var ae=this instanceof A;this._readableState=new S(q,this,ae),this.readable=!0,q&&(typeof q.read=="function"&&(this._read=q.read),typeof q.destroy=="function"&&(this._destroy=q.destroy)),e.call(this)}Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(ae){!this._readableState||(this._readableState.destroyed=ae)}}),E.prototype.destroy=m.destroy,E.prototype._undestroy=m.undestroy,E.prototype._destroy=function(q,ae){ae(q)},E.prototype.push=function(q,ae){var le=this._readableState,ie;return le.objectMode?ie=!0:typeof q=="string"&&(ae=ae||le.defaultEncoding,ae!==le.encoding&&(q=i.from(q,ae),ae=""),ie=!0),k(this,q,ae,!1,ie)},E.prototype.unshift=function(q){return k(this,q,null,!0,!1)};function k(q,ae,le,ie,se){o("readableAddChunk",ae);var xe=q._readableState;if(ae===null)xe.reading=!1,N(q,xe);else{var oe;if(se||(oe=z(xe,ae)),oe)w(q,oe);else if(xe.objectMode||ae&&ae.length>0)if(typeof ae!="string"&&!xe.objectMode&&Object.getPrototypeOf(ae)!==i.prototype&&(ae=a(ae)),ie)xe.endEmitted?w(q,new c):B(q,xe,ae,!0);else if(xe.ended)w(q,new l);else{if(xe.destroyed)return!1;xe.reading=!1,xe.decoder&&!le?(ae=xe.decoder.write(ae),xe.objectMode||ae.length!==0?B(q,xe,ae,!1):j(q,xe)):B(q,xe,ae,!1)}else ie||(xe.reading=!1,j(q,xe))}return!xe.ended&&(xe.length<xe.highWaterMark||xe.length===0)}function B(q,ae,le,ie){ae.flowing&&ae.length===0&&!ae.sync?(ae.awaitDrain=0,q.emit("data",le)):(ae.length+=ae.objectMode?1:le.length,ie?ae.buffer.unshift(le):ae.buffer.push(le),ae.needReadable&&V(q)),j(q,ae)}function z(q,ae){var le;return!r(ae)&&typeof ae!="string"&&ae!==void 0&&!q.objectMode&&(le=new x("chunk",["string","Buffer","Uint8Array"],ae)),le}E.prototype.isPaused=function(){return this._readableState.flowing===!1},E.prototype.setEncoding=function(q){M||(M=t("string_decoder/").StringDecoder);var ae=new M(q);this._readableState.decoder=ae,this._readableState.encoding=this._readableState.decoder.encoding;for(var le=this._readableState.buffer.head,ie="";le!==null;)ie+=ae.write(le.data),le=le.next;return this._readableState.buffer.clear(),ie!==""&&this._readableState.buffer.push(ie),this._readableState.length=ie.length,this};var F=1073741824;function I(q){return q>=F?q=F:(q--,q|=q>>>1,q|=q>>>2,q|=q>>>4,q|=q>>>8,q|=q>>>16,q++),q}function O(q,ae){return q<=0||ae.length===0&&ae.ended?0:ae.objectMode?1:q!==q?ae.flowing&&ae.length?ae.buffer.head.data.length:ae.length:(q>ae.highWaterMark&&(ae.highWaterMark=I(q)),q<=ae.length?q:ae.ended?ae.length:(ae.needReadable=!0,0))}E.prototype.read=function(q){o("read",q),q=parseInt(q,10);var ae=this._readableState,le=q;if(q!==0&&(ae.emittedReadable=!1),q===0&&ae.needReadable&&((ae.highWaterMark!==0?ae.length>=ae.highWaterMark:ae.length>0)||ae.ended))return o("read: emitReadable",ae.length,ae.ended),ae.length===0&&ae.ended?ee(this):V(this),null;if(q=O(q,ae),q===0&&ae.ended)return ae.length===0&&ee(this),null;var ie=ae.needReadable;o("need readable",ie),(ae.length===0||ae.length-q<ae.highWaterMark)&&(ie=!0,o("length less than watermark",ie)),ae.ended||ae.reading?(ie=!1,o("reading or ended",ie)):ie&&(o("do read"),ae.reading=!0,ae.sync=!0,ae.length===0&&(ae.needReadable=!0),this._read(ae.highWaterMark),ae.sync=!1,ae.reading||(q=O(le,ae)));var se;return q>0?se=Y(q,ae):se=null,se===null?(ae.needReadable=ae.length<=ae.highWaterMark,q=0):(ae.length-=q,ae.awaitDrain=0),ae.length===0&&(ae.ended||(ae.needReadable=!0),le!==q&&ae.ended&&ee(this)),se!==null&&this.emit("data",se),se};function N(q,ae){if(o("onEofChunk"),!ae.ended){if(ae.decoder){var le=ae.decoder.end();le&&le.length&&(ae.buffer.push(le),ae.length+=ae.objectMode?1:le.length)}ae.ended=!0,ae.sync?V(q):(ae.needReadable=!1,ae.emittedReadable||(ae.emittedReadable=!0,H(q)))}}function V(q){var ae=q._readableState;o("emitReadable",ae.needReadable,ae.emittedReadable),ae.needReadable=!1,ae.emittedReadable||(o("emitReadable",ae.flowing),ae.emittedReadable=!0,h.nextTick(H,q))}function H(q){var ae=q._readableState;o("emitReadable_",ae.destroyed,ae.length,ae.ended),!ae.destroyed&&(ae.length||ae.ended)&&(q.emit("readable"),ae.emittedReadable=!1),ae.needReadable=!ae.flowing&&!ae.ended&&ae.length<=ae.highWaterMark,G(q)}function j(q,ae){ae.readingMore||(ae.readingMore=!0,h.nextTick(Z,q,ae))}function Z(q,ae){for(;!ae.reading&&!ae.ended&&(ae.length<ae.highWaterMark||ae.flowing&&ae.length===0);){var le=ae.length;if(o("maybeReadMore read 0"),q.read(0),le===ae.length)break}ae.readingMore=!1}E.prototype._read=function(q){w(this,new b("_read()"))},E.prototype.pipe=function(q,ae){var le=this,ie=this._readableState;switch(ie.pipesCount){case 0:ie.pipes=q;break;case 1:ie.pipes=[ie.pipes,q];break;default:ie.pipes.push(q);break}ie.pipesCount+=1,o("pipe count=%d opts=%j",ie.pipesCount,ae);var se=(!ae||ae.end!==!1)&&q!==h.stdout&&q!==h.stderr,xe=se?he:Ce;ie.endEmitted?h.nextTick(xe):le.once("end",xe),q.on("unpipe",oe);function oe(He,Xe){o("onunpipe"),He===le&&Xe&&Xe.hasUnpiped===!1&&(Xe.hasUnpiped=!0,_e())}function he(){o("onend"),q.end()}var be=X(le);q.on("drain",be);var me=!1;function _e(){o("cleanup"),q.removeListener("close",Ie),q.removeListener("finish",Te),q.removeListener("drain",be),q.removeListener("error",De),q.removeListener("unpipe",oe),le.removeListener("end",he),le.removeListener("end",Ce),le.removeListener("data",Se),me=!0,ie.awaitDrain&&(!q._writableState||q._writableState.needDrain)&&be()}le.on("data",Se);function Se(He){o("ondata");var Xe=q.write(He);o("dest.write",Xe),Xe===!1&&((ie.pipesCount===1&&ie.pipes===q||ie.pipesCount>1&&J(ie.pipes,q)!==-1)&&!me&&(o("false write response, pause",ie.awaitDrain),ie.awaitDrain++),le.pause())}function De(He){o("onerror",He),Ce(),q.removeListener("error",De),T(q,"error")===0&&w(q,He)}C(q,"error",De);function Ie(){q.removeListener("finish",Te),Ce()}q.once("close",Ie);function Te(){o("onfinish"),q.removeListener("close",Ie),Ce()}q.once("finish",Te);function Ce(){o("unpipe"),le.unpipe(q)}return q.emit("pipe",le),ie.flowing||(o("pipe resume"),le.resume()),q};function X(q){return function(){var le=q._readableState;o("pipeOnDrain",le.awaitDrain),le.awaitDrain&&le.awaitDrain--,le.awaitDrain===0&&T(q,"data")&&(le.flowing=!0,G(q))}}E.prototype.unpipe=function(q){var ae=this._readableState,le={hasUnpiped:!1};if(ae.pipesCount===0)return this;if(ae.pipesCount===1)return q&&q!==ae.pipes?this:(q||(q=ae.pipes),ae.pipes=null,ae.pipesCount=0,ae.flowing=!1,q&&q.emit("unpipe",this,le),this);if(!q){var ie=ae.pipes,se=ae.pipesCount;ae.pipes=null,ae.pipesCount=0,ae.flowing=!1;for(var xe=0;xe<se;xe++)ie[xe].emit("unpipe",this,{hasUnpiped:!1});return this}var oe=J(ae.pipes,q);return oe===-1?this:(ae.pipes.splice(oe,1),ae.pipesCount-=1,ae.pipesCount===1&&(ae.pipes=ae.pipes[0]),q.emit("unpipe",this,le),this)},E.prototype.on=function(q,ae){var le=e.prototype.on.call(this,q,ae),ie=this._readableState;return q==="data"?(ie.readableListening=this.listenerCount("readable")>0,ie.flowing!==!1&&this.resume()):q==="readable"&&!ie.endEmitted&&!ie.readableListening&&(ie.readableListening=ie.needReadable=!0,ie.flowing=!1,ie.emittedReadable=!1,o("on readable",ie.length,ie.reading),ie.length?V(this):ie.reading||h.nextTick(ue,this)),le},E.prototype.addListener=E.prototype.on,E.prototype.removeListener=function(q,ae){var le=e.prototype.removeListener.call(this,q,ae);return q==="readable"&&h.nextTick(re,this),le},E.prototype.removeAllListeners=function(q){var ae=e.prototype.removeAllListeners.apply(this,arguments);return(q==="readable"||q===void 0)&&h.nextTick(re,this),ae};function re(q){var ae=q._readableState;ae.readableListening=q.listenerCount("readable")>0,ae.resumeScheduled&&!ae.paused?ae.flowing=!0:q.listenerCount("data")>0&&q.resume()}function ue(q){o("readable nexttick read 0"),q.read(0)}E.prototype.resume=function(){var q=this._readableState;return q.flowing||(o("resume"),q.flowing=!q.readableListening,K(this,q)),q.paused=!1,this};function K(q,ae){ae.resumeScheduled||(ae.resumeScheduled=!0,h.nextTick(te,q,ae))}function te(q,ae){o("resume",ae.reading),ae.reading||q.read(0),ae.resumeScheduled=!1,q.emit("resume"),G(q),ae.flowing&&!ae.reading&&q.read(0)}E.prototype.pause=function(){return o("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(o("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function G(q){var ae=q._readableState;for(o("flow",ae.flowing);ae.flowing&&q.read()!==null;);}E.prototype.wrap=function(q){var ae=this,le=this._readableState,ie=!1;q.on("end",function(){if(o("wrapped end"),le.decoder&&!le.ended){var oe=le.decoder.end();oe&&oe.length&&ae.push(oe)}ae.push(null)}),q.on("data",function(oe){if(o("wrapped data"),le.decoder&&(oe=le.decoder.write(oe)),!(le.objectMode&&oe==null)&&!(!le.objectMode&&(!oe||!oe.length))){var he=ae.push(oe);he||(ie=!0,q.pause())}});for(var se in q)this[se]===void 0&&typeof q[se]=="function"&&(this[se]=function(he){return function(){return q[he].apply(q,arguments)}}(se));for(var xe=0;xe<d.length;xe++)q.on(d[xe],this.emit.bind(this,d[xe]));return this._read=function(oe){o("wrapped _read",oe),ie&&(ie=!1,q.resume())},this},typeof Symbol=="function"&&(E.prototype[Symbol.asyncIterator]=function(){return _===void 0&&(_=t("./internal/streams/async_iterator")),_(this)}),Object.defineProperty(E.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(E.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(E.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(ae){this._readableState&&(this._readableState.flowing=ae)}}),E._fromList=Y,Object.defineProperty(E.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Y(q,ae){if(ae.length===0)return null;var le;return ae.objectMode?le=ae.buffer.shift():!q||q>=ae.length?(ae.decoder?le=ae.buffer.join(""):ae.buffer.length===1?le=ae.buffer.first():le=ae.buffer.concat(ae.length),ae.buffer.clear()):le=ae.buffer.consume(q,ae.decoder),le}function ee(q){var ae=q._readableState;o("endReadable",ae.endEmitted),ae.endEmitted||(ae.ended=!0,h.nextTick(ne,ae,q))}function ne(q,ae){if(o("endReadableNT",q.endEmitted,q.length),!q.endEmitted&&q.length===0&&(q.endEmitted=!0,ae.readable=!1,ae.emit("end"),q.autoDestroy)){var le=ae._writableState;(!le||le.autoDestroy&&le.finished)&&ae.destroy()}}typeof Symbol=="function"&&(E.from=function(q,ae){return y===void 0&&(y=t("./internal/streams/from")),y(E,q,ae)});function J(q,ae){for(var le=0,ie=q.length;le<ie;le++)if(q[le]===ae)return le;return-1}}).call(this)}).call(this,t("_process"),typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/async_iterator":293,"./internal/streams/buffer_list":294,"./internal/streams/destroy":295,"./internal/streams/from":297,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,events:84,inherits:231,"string_decoder/":301,util:83}],291:[function(t,P,R){P.exports=a;var h=t("../errors").codes,u=h.ERR_METHOD_NOT_IMPLEMENTED,A=h.ERR_MULTIPLE_CALLBACK,T=h.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=h.ERR_TRANSFORM_WITH_LENGTH_0,i=t("./_stream_duplex");t("inherits")(a,i);function n(o,s){var m=this._transformState;m.transforming=!1;var g=m.writecb;if(g===null)return this.emit("error",new A);m.writechunk=null,m.writecb=null,s!=null&&this.push(s),g(o);var p=this._readableState;p.reading=!1,(p.needReadable||p.length<p.highWaterMark)&&this._read(p.highWaterMark)}function a(o){if(!(this instanceof a))return new a(o);i.call(this,o),this._transformState={afterTransform:n.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,o&&(typeof o.transform=="function"&&(this._transform=o.transform),typeof o.flush=="function"&&(this._flush=o.flush)),this.on("prefinish",r)}function r(){var o=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(s,m){f(o,s,m)}):f(this,null,null)}a.prototype.push=function(o,s){return this._transformState.needTransform=!1,i.prototype.push.call(this,o,s)},a.prototype._transform=function(o,s,m){m(new u("_transform()"))},a.prototype._write=function(o,s,m){var g=this._transformState;if(g.writecb=m,g.writechunk=o,g.writeencoding=s,!g.transforming){var p=this._readableState;(g.needTransform||p.needReadable||p.length<p.highWaterMark)&&this._read(p.highWaterMark)}},a.prototype._read=function(o){var s=this._transformState;s.writechunk!==null&&!s.transforming?(s.transforming=!0,this._transform(s.writechunk,s.writeencoding,s.afterTransform)):s.needTransform=!0},a.prototype._destroy=function(o,s){i.prototype._destroy.call(this,o,function(m){s(m)})};function f(o,s,m){if(s)return o.emit("error",s);if(m!=null&&o.push(m),o._writableState.length)throw new e;if(o._transformState.transforming)throw new T;return o.push(null)}},{"../errors":287,"./_stream_duplex":288,inherits:231}],292:[function(t,P,R){(function(h,u){(function(){P.exports=S;function A(G){var Y=this;this.next=null,this.entry=null,this.finish=function(){te(Y,G)}}var T;S.WritableState=d;var e={deprecate:t("util-deprecate")},i=t("./internal/streams/stream"),n=t("buffer").Buffer,a=u.Uint8Array||function(){};function r(G){return n.from(G)}function f(G){return n.isBuffer(G)||G instanceof a}var o=t("./internal/streams/destroy"),s=t("./internal/streams/state"),m=s.getHighWaterMark,g=t("../errors").codes,p=g.ERR_INVALID_ARG_TYPE,v=g.ERR_METHOD_NOT_IMPLEMENTED,x=g.ERR_MULTIPLE_CALLBACK,l=g.ERR_STREAM_CANNOT_PIPE,b=g.ERR_STREAM_DESTROYED,c=g.ERR_STREAM_NULL_VALUES,M=g.ERR_STREAM_WRITE_AFTER_END,_=g.ERR_UNKNOWN_ENCODING,y=o.errorOrDestroy;t("inherits")(S,i);function w(){}function d(G,Y,ee){T=T||t("./_stream_duplex"),G=G||{},typeof ee!="boolean"&&(ee=Y instanceof T),this.objectMode=!!G.objectMode,ee&&(this.objectMode=this.objectMode||!!G.writableObjectMode),this.highWaterMark=m(this,G,"writableHighWaterMark",ee),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var ne=G.decodeStrings===!1;this.decodeStrings=!ne,this.defaultEncoding=G.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(J){N(Y,J)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=G.emitClose!==!1,this.autoDestroy=!!G.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new A(this)}d.prototype.getBuffer=function(){for(var Y=this.bufferedRequest,ee=[];Y;)ee.push(Y),Y=Y.next;return ee},function(){try{Object.defineProperty(d.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var C;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(C=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(Y){return C.call(this,Y)?!0:this!==S?!1:Y&&Y._writableState instanceof d}})):C=function(Y){return Y instanceof this};function S(G){T=T||t("./_stream_duplex");var Y=this instanceof T;if(!Y&&!C.call(S,this))return new S(G);this._writableState=new d(G,this,Y),this.writable=!0,G&&(typeof G.write=="function"&&(this._write=G.write),typeof G.writev=="function"&&(this._writev=G.writev),typeof G.destroy=="function"&&(this._destroy=G.destroy),typeof G.final=="function"&&(this._final=G.final)),i.call(this)}S.prototype.pipe=function(){y(this,new l)};function E(G,Y){var ee=new M;y(G,ee),h.nextTick(Y,ee)}function k(G,Y,ee,ne){var J;return ee===null?J=new c:typeof ee!="string"&&!Y.objectMode&&(J=new p("chunk",["string","Buffer"],ee)),J?(y(G,J),h.nextTick(ne,J),!1):!0}S.prototype.write=function(G,Y,ee){var ne=this._writableState,J=!1,q=!ne.objectMode&&f(G);return q&&!n.isBuffer(G)&&(G=r(G)),typeof Y=="function"&&(ee=Y,Y=null),q?Y="buffer":Y||(Y=ne.defaultEncoding),typeof ee!="function"&&(ee=w),ne.ending?E(this,ee):(q||k(this,ne,G,ee))&&(ne.pendingcb++,J=z(this,ne,q,G,Y,ee)),J},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var G=this._writableState;G.corked&&(G.corked--,!G.writing&&!G.corked&&!G.bufferProcessing&&G.bufferedRequest&&j(this,G))},S.prototype.setDefaultEncoding=function(Y){if(typeof Y=="string"&&(Y=Y.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Y+"").toLowerCase())>-1))throw new _(Y);return this._writableState.defaultEncoding=Y,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function B(G,Y,ee){return!G.objectMode&&G.decodeStrings!==!1&&typeof Y=="string"&&(Y=n.from(Y,ee)),Y}Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function z(G,Y,ee,ne,J,q){if(!ee){var ae=B(Y,ne,J);ne!==ae&&(ee=!0,J="buffer",ne=ae)}var le=Y.objectMode?1:ne.length;Y.length+=le;var ie=Y.length<Y.highWaterMark;if(ie||(Y.needDrain=!0),Y.writing||Y.corked){var se=Y.lastBufferedRequest;Y.lastBufferedRequest={chunk:ne,encoding:J,isBuf:ee,callback:q,next:null},se?se.next=Y.lastBufferedRequest:Y.bufferedRequest=Y.lastBufferedRequest,Y.bufferedRequestCount+=1}else F(G,Y,!1,le,ne,J,q);return ie}function F(G,Y,ee,ne,J,q,ae){Y.writelen=ne,Y.writecb=ae,Y.writing=!0,Y.sync=!0,Y.destroyed?Y.onwrite(new b("write")):ee?G._writev(J,Y.onwrite):G._write(J,q,Y.onwrite),Y.sync=!1}function I(G,Y,ee,ne,J){--Y.pendingcb,ee?(h.nextTick(J,ne),h.nextTick(ue,G,Y),G._writableState.errorEmitted=!0,y(G,ne)):(J(ne),G._writableState.errorEmitted=!0,y(G,ne),ue(G,Y))}function O(G){G.writing=!1,G.writecb=null,G.length-=G.writelen,G.writelen=0}function N(G,Y){var ee=G._writableState,ne=ee.sync,J=ee.writecb;if(typeof J!="function")throw new x;if(O(ee),Y)I(G,ee,ne,Y,J);else{var q=Z(ee)||G.destroyed;!q&&!ee.corked&&!ee.bufferProcessing&&ee.bufferedRequest&&j(G,ee),ne?h.nextTick(V,G,ee,q,J):V(G,ee,q,J)}}function V(G,Y,ee,ne){ee||H(G,Y),Y.pendingcb--,ne(),ue(G,Y)}function H(G,Y){Y.length===0&&Y.needDrain&&(Y.needDrain=!1,G.emit("drain"))}function j(G,Y){Y.bufferProcessing=!0;var ee=Y.bufferedRequest;if(G._writev&&ee&&ee.next){var ne=Y.bufferedRequestCount,J=new Array(ne),q=Y.corkedRequestsFree;q.entry=ee;for(var ae=0,le=!0;ee;)J[ae]=ee,ee.isBuf||(le=!1),ee=ee.next,ae+=1;J.allBuffers=le,F(G,Y,!0,Y.length,J,"",q.finish),Y.pendingcb++,Y.lastBufferedRequest=null,q.next?(Y.corkedRequestsFree=q.next,q.next=null):Y.corkedRequestsFree=new A(Y),Y.bufferedRequestCount=0}else{for(;ee;){var ie=ee.chunk,se=ee.encoding,xe=ee.callback,oe=Y.objectMode?1:ie.length;if(F(G,Y,!1,oe,ie,se,xe),ee=ee.next,Y.bufferedRequestCount--,Y.writing)break}ee===null&&(Y.lastBufferedRequest=null)}Y.bufferedRequest=ee,Y.bufferProcessing=!1}S.prototype._write=function(G,Y,ee){ee(new v("_write()"))},S.prototype._writev=null,S.prototype.end=function(G,Y,ee){var ne=this._writableState;return typeof G=="function"?(ee=G,G=null,Y=null):typeof Y=="function"&&(ee=Y,Y=null),G!=null&&this.write(G,Y),ne.corked&&(ne.corked=1,this.uncork()),ne.ending||K(this,ne,ee),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Z(G){return G.ending&&G.length===0&&G.bufferedRequest===null&&!G.finished&&!G.writing}function X(G,Y){G._final(function(ee){Y.pendingcb--,ee&&y(G,ee),Y.prefinished=!0,G.emit("prefinish"),ue(G,Y)})}function re(G,Y){!Y.prefinished&&!Y.finalCalled&&(typeof G._final=="function"&&!Y.destroyed?(Y.pendingcb++,Y.finalCalled=!0,h.nextTick(X,G,Y)):(Y.prefinished=!0,G.emit("prefinish")))}function ue(G,Y){var ee=Z(Y);if(ee&&(re(G,Y),Y.pendingcb===0&&(Y.finished=!0,G.emit("finish"),Y.autoDestroy))){var ne=G._readableState;(!ne||ne.autoDestroy&&ne.endEmitted)&&G.destroy()}return ee}function K(G,Y,ee){Y.ending=!0,ue(G,Y),ee&&(Y.finished?h.nextTick(ee):G.once("finish",ee)),Y.ended=!0,G.writable=!1}function te(G,Y,ee){var ne=G.entry;for(G.entry=null;ne;){var J=ne.callback;Y.pendingcb--,J(ee),ne=ne.next}Y.corkedRequestsFree.next=G}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(Y){!this._writableState||(this._writableState.destroyed=Y)}}),S.prototype.destroy=o.destroy,S.prototype._undestroy=o.undestroy,S.prototype._destroy=function(G,Y){Y(G)}}).call(this)}).call(this,t("_process"),typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/destroy":295,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,inherits:231,"util-deprecate":331}],293:[function(t,P,R){(function(h){(function(){var u;function A(b,c,M){return c in b?Object.defineProperty(b,c,{value:M,enumerable:!0,configurable:!0,writable:!0}):b[c]=M,b}var T=t("./end-of-stream"),e=Symbol("lastResolve"),i=Symbol("lastReject"),n=Symbol("error"),a=Symbol("ended"),r=Symbol("lastPromise"),f=Symbol("handlePromise"),o=Symbol("stream");function s(b,c){return{value:b,done:c}}function m(b){var c=b[e];if(c!==null){var M=b[o].read();M!==null&&(b[r]=null,b[e]=null,b[i]=null,c(s(M,!1)))}}function g(b){h.nextTick(m,b)}function p(b,c){return function(M,_){b.then(function(){if(c[a]){M(s(void 0,!0));return}c[f](M,_)},_)}}var v=Object.getPrototypeOf(function(){}),x=Object.setPrototypeOf((u={get stream(){return this[o]},next:function(){var c=this,M=this[n];if(M!==null)return Promise.reject(M);if(this[a])return Promise.resolve(s(void 0,!0));if(this[o].destroyed)return new Promise(function(d,C){h.nextTick(function(){c[n]?C(c[n]):d(s(void 0,!0))})});var _=this[r],y;if(_)y=new Promise(p(_,this));else{var w=this[o].read();if(w!==null)return Promise.resolve(s(w,!1));y=new Promise(this[f])}return this[r]=y,y}},A(u,Symbol.asyncIterator,function(){return this}),A(u,"return",function(){var c=this;return new Promise(function(M,_){c[o].destroy(null,function(y){if(y){_(y);return}M(s(void 0,!0))})})}),u),v),l=function(c){var M,_=Object.create(x,(M={},A(M,o,{value:c,writable:!0}),A(M,e,{value:null,writable:!0}),A(M,i,{value:null,writable:!0}),A(M,n,{value:null,writable:!0}),A(M,a,{value:c._readableState.endEmitted,writable:!0}),A(M,f,{value:function(w,d){var C=_[o].read();C?(_[r]=null,_[e]=null,_[i]=null,w(s(C,!1))):(_[e]=w,_[i]=d)},writable:!0}),M));return _[r]=null,T(c,function(y){if(y&&y.code!=="ERR_STREAM_PREMATURE_CLOSE"){var w=_[i];w!==null&&(_[r]=null,_[e]=null,_[i]=null,w(y)),_[n]=y;return}var d=_[e];d!==null&&(_[r]=null,_[e]=null,_[i]=null,d(s(void 0,!0))),_[a]=!0}),c.on("readable",g.bind(null,_)),_};P.exports=l}).call(this)}).call(this,t("_process"))},{"./end-of-stream":296,_process:278}],294:[function(t,P,R){function h(m,g){var p=Object.keys(m);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(m);g&&(v=v.filter(function(x){return Object.getOwnPropertyDescriptor(m,x).enumerable})),p.push.apply(p,v)}return p}function u(m){for(var g=1;g<arguments.length;g++){var p=arguments[g]!=null?arguments[g]:{};g%2?h(Object(p),!0).forEach(function(v){A(m,v,p[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(p)):h(Object(p)).forEach(function(v){Object.defineProperty(m,v,Object.getOwnPropertyDescriptor(p,v))})}return m}function A(m,g,p){return g in m?Object.defineProperty(m,g,{value:p,enumerable:!0,configurable:!0,writable:!0}):m[g]=p,m}function T(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function e(m,g){for(var p=0;p<g.length;p++){var v=g[p];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}function i(m,g,p){return g&&e(m.prototype,g),p&&e(m,p),m}var n=t("buffer"),a=n.Buffer,r=t("util"),f=r.inspect,o=f&&f.custom||"inspect";function s(m,g,p){a.prototype.copy.call(m,g,p)}P.exports=function(){function m(){T(this,m),this.head=null,this.tail=null,this.length=0}return i(m,[{key:"push",value:function(p){var v={data:p,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(p){var v={data:p,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var p=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,p}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(p){if(this.length===0)return"";for(var v=this.head,x=""+v.data;v=v.next;)x+=p+v.data;return x}},{key:"concat",value:function(p){if(this.length===0)return a.alloc(0);for(var v=a.allocUnsafe(p>>>0),x=this.head,l=0;x;)s(x.data,v,l),l+=x.data.length,x=x.next;return v}},{key:"consume",value:function(p,v){var x;return p<this.head.data.length?(x=this.head.data.slice(0,p),this.head.data=this.head.data.slice(p)):p===this.head.data.length?x=this.shift():x=v?this._getString(p):this._getBuffer(p),x}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(p){var v=this.head,x=1,l=v.data;for(p-=l.length;v=v.next;){var b=v.data,c=p>b.length?b.length:p;if(c===b.length?l+=b:l+=b.slice(0,p),p-=c,p===0){c===b.length?(++x,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=b.slice(c));break}++x}return this.length-=x,l}},{key:"_getBuffer",value:function(p){var v=a.allocUnsafe(p),x=this.head,l=1;for(x.data.copy(v),p-=x.data.length;x=x.next;){var b=x.data,c=p>b.length?b.length:p;if(b.copy(v,v.length-p,0,c),p-=c,p===0){c===b.length?(++l,x.next?this.head=x.next:this.head=this.tail=null):(this.head=x,x.data=b.slice(c));break}++l}return this.length-=l,v}},{key:o,value:function(p,v){return f(this,u({},v,{depth:0,customInspect:!1}))}}]),m}()},{buffer:85,util:83}],295:[function(t,P,R){(function(h){(function(){function u(a,r){var f=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(r?r(a):a&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,h.nextTick(i,this,a)):h.nextTick(i,this,a)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(a||null,function(m){!r&&m?f._writableState?f._writableState.errorEmitted?h.nextTick(T,f):(f._writableState.errorEmitted=!0,h.nextTick(A,f,m)):h.nextTick(A,f,m):r?(h.nextTick(T,f),r(m)):h.nextTick(T,f)}),this)}function A(a,r){i(a,r),T(a)}function T(a){a._writableState&&!a._writableState.emitClose||a._readableState&&!a._readableState.emitClose||a.emit("close")}function e(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function i(a,r){a.emit("error",r)}function n(a,r){var f=a._readableState,o=a._writableState;f&&f.autoDestroy||o&&o.autoDestroy?a.destroy(r):a.emit("error",r)}P.exports={destroy:u,undestroy:e,errorOrDestroy:n}}).call(this)}).call(this,t("_process"))},{_process:278}],296:[function(t,P,R){var h=t("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function u(i){var n=!1;return function(){if(!n){n=!0;for(var a=arguments.length,r=new Array(a),f=0;f<a;f++)r[f]=arguments[f];i.apply(this,r)}}}function A(){}function T(i){return i.setHeader&&typeof i.abort=="function"}function e(i,n,a){if(typeof n=="function")return e(i,null,n);n||(n={}),a=u(a||A);var r=n.readable||n.readable!==!1&&i.readable,f=n.writable||n.writable!==!1&&i.writable,o=function(){i.writable||m()},s=i._writableState&&i._writableState.finished,m=function(){f=!1,s=!0,r||a.call(i)},g=i._readableState&&i._readableState.endEmitted,p=function(){r=!1,g=!0,f||a.call(i)},v=function(c){a.call(i,c)},x=function(){var c;if(r&&!g)return(!i._readableState||!i._readableState.ended)&&(c=new h),a.call(i,c);if(f&&!s)return(!i._writableState||!i._writableState.ended)&&(c=new h),a.call(i,c)},l=function(){i.req.on("finish",m)};return T(i)?(i.on("complete",m),i.on("abort",x),i.req?l():i.on("request",l)):f&&!i._writableState&&(i.on("end",o),i.on("close",o)),i.on("end",p),i.on("finish",m),n.error!==!1&&i.on("error",v),i.on("close",x),function(){i.removeListener("complete",m),i.removeListener("abort",x),i.removeListener("request",l),i.req&&i.req.removeListener("finish",m),i.removeListener("end",o),i.removeListener("close",o),i.removeListener("finish",m),i.removeListener("end",p),i.removeListener("error",v),i.removeListener("close",x)}}P.exports=e},{"../../../errors":287}],297:[function(t,P,R){P.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],298:[function(t,P,R){var h;function u(m){var g=!1;return function(){g||(g=!0,m.apply(void 0,arguments))}}var A=t("../../../errors").codes,T=A.ERR_MISSING_ARGS,e=A.ERR_STREAM_DESTROYED;function i(m){if(m)throw m}function n(m){return m.setHeader&&typeof m.abort=="function"}function a(m,g,p,v){v=u(v);var x=!1;m.on("close",function(){x=!0}),h===void 0&&(h=t("./end-of-stream")),h(m,{readable:g,writable:p},function(b){if(b)return v(b);x=!0,v()});var l=!1;return function(b){if(!x&&!l){if(l=!0,n(m))return m.abort();if(typeof m.destroy=="function")return m.destroy();v(b||new e("pipe"))}}}function r(m){m()}function f(m,g){return m.pipe(g)}function o(m){return!m.length||typeof m[m.length-1]!="function"?i:m.pop()}function s(){for(var m=arguments.length,g=new Array(m),p=0;p<m;p++)g[p]=arguments[p];var v=o(g);if(Array.isArray(g[0])&&(g=g[0]),g.length<2)throw new T("streams");var x,l=g.map(function(b,c){var M=c<g.length-1,_=c>0;return a(b,M,_,function(y){x||(x=y),y&&l.forEach(r),!M&&(l.forEach(r),v(x))})});return g.reduce(f)}P.exports=s},{"../../../errors":287,"./end-of-stream":296}],299:[function(t,P,R){var h=t("../../../errors").codes.ERR_INVALID_OPT_VALUE;function u(T,e,i){return T.highWaterMark!=null?T.highWaterMark:e?T[i]:null}function A(T,e,i,n){var a=u(e,n,i);if(a!=null){if(!(isFinite(a)&&Math.floor(a)===a)||a<0){var r=n?i:"highWaterMark";throw new h(r,a)}return Math.floor(a)}return T.objectMode?16:16*1024}P.exports={getHighWaterMark:A}},{"../../../errors":287}],300:[function(t,P,R){P.exports=t("events").EventEmitter},{events:84}],301:[function(t,P,R){var h=t("safe-buffer").Buffer,u=h.isEncoding||function(l){switch(l=""+l,l&&l.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function A(l){if(!l)return"utf8";for(var b;;)switch(l){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return l;default:if(b)return;l=(""+l).toLowerCase(),b=!0}}function T(l){var b=A(l);if(typeof b!="string"&&(h.isEncoding===u||!u(l)))throw new Error("Unknown encoding: "+l);return b||l}R.StringDecoder=e;function e(l){this.encoding=T(l);var b;switch(this.encoding){case"utf16le":this.text=s,this.end=m,b=4;break;case"utf8":this.fillLast=r,b=4;break;case"base64":this.text=g,this.end=p,b=3;break;default:this.write=v,this.end=x;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=h.allocUnsafe(b)}e.prototype.write=function(l){if(l.length===0)return"";var b,c;if(this.lastNeed){if(b=this.fillLast(l),b===void 0)return"";c=this.lastNeed,this.lastNeed=0}else c=0;return c<l.length?b?b+this.text(l,c):this.text(l,c):b||""},e.prototype.end=o,e.prototype.text=f,e.prototype.fillLast=function(l){if(this.lastNeed<=l.length)return l.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);l.copy(this.lastChar,this.lastTotal-this.lastNeed,0,l.length),this.lastNeed-=l.length};function i(l){return l<=127?0:l>>5===6?2:l>>4===14?3:l>>3===30?4:l>>6===2?-1:-2}function n(l,b,c){var M=b.length-1;if(M<c)return 0;var _=i(b[M]);return _>=0?(_>0&&(l.lastNeed=_-1),_):--M<c||_===-2?0:(_=i(b[M]),_>=0?(_>0&&(l.lastNeed=_-2),_):--M<c||_===-2?0:(_=i(b[M]),_>=0?(_>0&&(_===2?_=0:l.lastNeed=_-3),_):0))}function a(l,b,c){if((b[0]&192)!==128)return l.lastNeed=0,"\uFFFD";if(l.lastNeed>1&&b.length>1){if((b[1]&192)!==128)return l.lastNeed=1,"\uFFFD";if(l.lastNeed>2&&b.length>2&&(b[2]&192)!==128)return l.lastNeed=2,"\uFFFD"}}function r(l){var b=this.lastTotal-this.lastNeed,c=a(this,l);if(c!==void 0)return c;if(this.lastNeed<=l.length)return l.copy(this.lastChar,b,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);l.copy(this.lastChar,b,0,l.length),this.lastNeed-=l.length}function f(l,b){var c=n(this,l,b);if(!this.lastNeed)return l.toString("utf8",b);this.lastTotal=c;var M=l.length-(c-this.lastNeed);return l.copy(this.lastChar,0,M),l.toString("utf8",b,M)}function o(l){var b=l&&l.length?this.write(l):"";return this.lastNeed?b+"\uFFFD":b}function s(l,b){if((l.length-b)%2===0){var c=l.toString("utf16le",b);if(c){var M=c.charCodeAt(c.length-1);if(M>=55296&&M<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=l[l.length-2],this.lastChar[1]=l[l.length-1],c.slice(0,-1)}return c}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=l[l.length-1],l.toString("utf16le",b,l.length-1)}function m(l){var b=l&&l.length?this.write(l):"";if(this.lastNeed){var c=this.lastTotal-this.lastNeed;return b+this.lastChar.toString("utf16le",0,c)}return b}function g(l,b){var c=(l.length-b)%3;return c===0?l.toString("base64",b):(this.lastNeed=3-c,this.lastTotal=3,c===1?this.lastChar[0]=l[l.length-1]:(this.lastChar[0]=l[l.length-2],this.lastChar[1]=l[l.length-1]),l.toString("base64",b,l.length-c))}function p(l){var b=l&&l.length?this.write(l):"";return this.lastNeed?b+this.lastChar.toString("base64",0,3-this.lastNeed):b}function v(l){return l.toString(this.encoding)}function x(l){return l&&l.length?this.write(l):""}},{"safe-buffer":285}],302:[function(t,P,R){(function(h,u){(function(){var A=t("assert"),T=t("debug")("stream-parser");P.exports=r;var e=-1,i=0,n=1,a=2;function r(c){var M=c&&typeof c._transform=="function",_=c&&typeof c._write=="function";if(!M&&!_)throw new Error("must pass a Writable or Transform stream in");T("extending Parser into stream"),c._bytes=o,c._skipBytes=s,M&&(c._passthrough=m),M?c._transform=p:c._write=g}function f(c){T("initializing parser stream"),c._parserBytesLeft=0,c._parserBuffers=[],c._parserBuffered=0,c._parserState=e,c._parserCallback=null,typeof c.push=="function"&&(c._parserOutput=c.push.bind(c)),c._parserInit=!0}function o(c,M){A(!this._parserCallback,'there is already a "callback" set!'),A(isFinite(c)&&c>0,'can only buffer a finite number of bytes > 0, got "'+c+'"'),this._parserInit||f(this),T("buffering %o bytes",c),this._parserBytesLeft=c,this._parserCallback=M,this._parserState=i}function s(c,M){A(!this._parserCallback,'there is already a "callback" set!'),A(c>0,'can only skip > 0 bytes, got "'+c+'"'),this._parserInit||f(this),T("skipping %o bytes",c),this._parserBytesLeft=c,this._parserCallback=M,this._parserState=n}function m(c,M){A(!this._parserCallback,'There is already a "callback" set!'),A(c>0,'can only pass through > 0 bytes, got "'+c+'"'),this._parserInit||f(this),T("passing through %o bytes",c),this._parserBytesLeft=c,this._parserCallback=M,this._parserState=a}function g(c,M,_){this._parserInit||f(this),T("write(%o bytes)",c.length),typeof M=="function"&&(_=M),l(this,c,null,_)}function p(c,M,_){this._parserInit||f(this),T("transform(%o bytes)",c.length),typeof M!="function"&&(M=this._parserOutput),l(this,c,M,_)}function v(c,M,_,y){return c._parserBytesLeft<=0?y(new Error("got data but not currently parsing anything")):M.length<=c._parserBytesLeft?function(){return x(c,M,_,y)}:function(){var w=M.slice(0,c._parserBytesLeft);return x(c,w,_,function(d){if(d)return y(d);if(M.length>w.length)return function(){return v(c,M.slice(w.length),_,y)}})}}function x(c,M,_,y){if(c._parserBytesLeft-=M.length,T("%o bytes left for stream piece",c._parserBytesLeft),c._parserState===i?(c._parserBuffers.push(M),c._parserBuffered+=M.length):c._parserState===a&&_(M),c._parserBytesLeft===0){var w=c._parserCallback;if(w&&c._parserState===i&&c._parserBuffers.length>1&&(M=u.concat(c._parserBuffers,c._parserBuffered)),c._parserState!==i&&(M=null),c._parserCallback=null,c._parserBuffered=0,c._parserState=e,c._parserBuffers.splice(0),w){var d=[];M&&d.push(M),_&&d.push(_);var C=w.length>d.length;C&&d.push(b(y));var S=w.apply(c,d);if(!C||y===S)return y}}else return y}var l=b(v);function b(c){return function(){for(var M=c.apply(this,arguments);typeof M=="function";)M=M();return M}}}).call(this)}).call(this,t("_process"),t("buffer").Buffer)},{_process:278,assert:75,buffer:85,debug:303}],303:[function(t,P,R){(function(h){(function(){R=P.exports=t("./debug"),R.log=T,R.formatArgs=A,R.save=e,R.load=i,R.useColors=u,R.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:n(),R.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function u(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}R.formatters.j=function(a){try{return JSON.stringify(a)}catch(r){return"[UnexpectedJSONParseError]: "+r.message}};function A(a){var r=this.useColors;if(a[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+a[0]+(r?"%c ":" ")+"+"+R.humanize(this.diff),!!r){var f="color: "+this.color;a.splice(1,0,f,"color: inherit");var o=0,s=0;a[0].replace(/%[a-zA-Z%]/g,function(m){m!=="%%"&&(o++,m==="%c"&&(s=o))}),a.splice(s,0,f)}}function T(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function e(a){try{a==null?R.storage.removeItem("debug"):R.storage.debug=a}catch{}}function i(){var a;try{a=R.storage.debug}catch{}return!a&&typeof h<"u"&&"env"in h&&(a=h.env.DEBUG),a}R.enable(i());function n(){try{return window.localStorage}catch{}}}).call(this)}).call(this,t("_process"))},{"./debug":304,_process:278}],304:[function(t,P,R){R=P.exports=A.debug=A.default=A,R.coerce=n,R.disable=e,R.enable=T,R.enabled=i,R.humanize=t("ms"),R.names=[],R.skips=[],R.formatters={};var h;function u(a){var r=0,f;for(f in a)r=(r<<5)-r+a.charCodeAt(f),r|=0;return R.colors[Math.abs(r)%R.colors.length]}function A(a){function r(){if(!!r.enabled){var f=r,o=+new Date,s=o-(h||o);f.diff=s,f.prev=h,f.curr=o,h=o;for(var m=new Array(arguments.length),g=0;g<m.length;g++)m[g]=arguments[g];m[0]=R.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");var p=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,function(x,l){if(x==="%%")return x;p++;var b=R.formatters[l];if(typeof b=="function"){var c=m[p];x=b.call(f,c),m.splice(p,1),p--}return x}),R.formatArgs.call(f,m);var v=r.log||R.log||console.log.bind(console);v.apply(f,m)}}return r.namespace=a,r.enabled=R.enabled(a),r.useColors=R.useColors(),r.color=u(a),typeof R.init=="function"&&R.init(r),r}function T(a){R.save(a),R.names=[],R.skips=[];for(var r=(typeof a=="string"?a:"").split(/[\s,]+/),f=r.length,o=0;o<f;o++)!r[o]||(a=r[o].replace(/\*/g,".*?"),a[0]==="-"?R.skips.push(new RegExp("^"+a.substr(1)+"$")):R.names.push(new RegExp("^"+a+"$")))}function e(){R.enable("")}function i(a){var r,f;for(r=0,f=R.skips.length;r<f;r++)if(R.skips[r].test(a))return!1;for(r=0,f=R.names.length;r<f;r++)if(R.names[r].test(a))return!0;return!1}function n(a){return a instanceof Error?a.stack||a.message:a}},{ms:305}],305:[function(t,P,R){var h=1e3,u=h*60,A=u*60,T=A*24,e=T*365.25;P.exports=function(f,o){o=o||{};var s=typeof f;if(s==="string"&&f.length>0)return i(f);if(s==="number"&&isNaN(f)===!1)return o.long?a(f):n(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))};function i(f){if(f=String(f),!(f.length>100)){var o=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(f);if(!!o){var s=parseFloat(o[1]),m=(o[2]||"ms").toLowerCase();switch(m){case"years":case"year":case"yrs":case"yr":case"y":return s*e;case"days":case"day":case"d":return s*T;case"hours":case"hour":case"hrs":case"hr":case"h":return s*A;case"minutes":case"minute":case"mins":case"min":case"m":return s*u;case"seconds":case"second":case"secs":case"sec":case"s":return s*h;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}function n(f){return f>=T?Math.round(f/T)+"d":f>=A?Math.round(f/A)+"h":f>=u?Math.round(f/u)+"m":f>=h?Math.round(f/h)+"s":f+"ms"}function a(f){return r(f,T,"day")||r(f,A,"hour")||r(f,u,"minute")||r(f,h,"second")||f+" ms"}function r(f,o,s){if(!(f<o))return f<o*1.5?Math.floor(f/o)+" "+s:Math.ceil(f/o)+" "+s+"s"}},{}],306:[function(t,P,R){var h=t("parenthesis");P.exports=function(A,T,e){if(A==null)throw Error("First argument should be a string");if(T==null)throw Error("Separator should be a string or a RegExp");e?(typeof e=="string"||Array.isArray(e))&&(e={ignore:e}):e={},e.escape==null&&(e.escape=!0),e.ignore==null?e.ignore=["[]","()","{}","<>",'""',"''","``","\u201C\u201D","\xAB\xBB"]:(typeof e.ignore=="string"&&(e.ignore=[e.ignore]),e.ignore=e.ignore.map(function(m){return m.length===1&&(m=m+m),m}));var i=h.parse(A,{flat:!0,brackets:e.ignore}),n=i[0],a=n.split(T);if(e.escape){for(var r=[],f=0;f<a.length;f++){var o=a[f],s=a[f+1];o[o.length-1]==="\\"&&o[o.length-2]!=="\\"?(r.push(o+T+s),f++):r.push(o)}a=r}for(var f=0;f<a.length;f++)i[0]=a[f],a[f]=h.stringify(i,{flat:!0});return a}},{parenthesis:248}],307:[function(t,P,R){P.exports=h;function h(u){for(var A=u.length,T=new Array(A),e=new Array(A),i=new Array(A),n=new Array(A),a=new Array(A),r=new Array(A),f=0;f<A;++f)T[f]=-1,e[f]=0,i[f]=!1,n[f]=0,a[f]=-1,r[f]=[];var o=0,s=[],m=[];function g(l){var b=[l],c=[l];for(T[l]=e[l]=o,i[l]=!0,o+=1;c.length>0;){l=c[c.length-1];var M=u[l];if(n[l]<M.length){for(var _=n[l];_<M.length;++_){var y=M[_];if(T[y]<0){T[y]=e[y]=o,i[y]=!0,o+=1,b.push(y),c.push(y);break}else i[y]&&(e[l]=Math.min(e[l],e[y])|0);a[y]>=0&&r[l].push(a[y])}n[l]=_}else{if(e[l]===T[l]){for(var w=[],d=[],C=0,_=b.length-1;_>=0;--_){var S=b[_];if(i[S]=!1,w.push(S),d.push(r[S]),C+=r[S].length,a[S]=s.length,S===l){b.length=_;break}}s.push(w);for(var E=new Array(C),_=0;_<d.length;_++)for(var k=0;k<d[_].length;k++)E[--C]=d[_][k];m.push(E)}c.pop()}}}for(var f=0;f<A;++f)T[f]<0&&g(f);for(var p,f=0;f<m.length;f++){var v=m[f];if(v.length!==0){v.sort(function(b,c){return b-c}),p=[v[0]];for(var x=1;x<v.length;x++)v[x]!==v[x-1]&&p.push(v[x]);m[f]=p}}return{components:s,adjacencyList:m}}},{}],308:[function(t,P,R){Object.defineProperty(R,"__esModule",{value:!0});var h=function(){function a(r,f){var o=[],s=!0,m=!1,g=void 0;try{for(var p=r[Symbol.iterator](),v;!(s=(v=p.next()).done)&&(o.push(v.value),!(f&&o.length===f));s=!0);}catch(x){m=!0,g=x}finally{try{!s&&p.return&&p.return()}finally{if(m)throw g}}return o}return function(r,f){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return a(r,f);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=Math.PI*2,A=function(r,f,o,s,m,g,p){var v=r.x,x=r.y;v*=f,x*=o;var l=s*v-m*x,b=m*v+s*x;return{x:l+g,y:b+p}},T=function(r,f){var o=f===1.5707963267948966?.551915024494:f===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(f/4),s=Math.cos(r),m=Math.sin(r),g=Math.cos(r+f),p=Math.sin(r+f);return[{x:s-m*o,y:m+s*o},{x:g+p*o,y:p-g*o},{x:g,y:p}]},e=function(r,f,o,s){var m=r*s-f*o<0?-1:1,g=r*o+f*s;return g>1&&(g=1),g<-1&&(g=-1),m*Math.acos(g)},i=function(r,f,o,s,m,g,p,v,x,l,b,c){var M=Math.pow(m,2),_=Math.pow(g,2),y=Math.pow(b,2),w=Math.pow(c,2),d=M*_-M*w-_*y;d<0&&(d=0),d/=M*w+_*y,d=Math.sqrt(d)*(p===v?-1:1);var C=d*m/g*c,S=d*-g/m*b,E=l*C-x*S+(r+o)/2,k=x*C+l*S+(f+s)/2,B=(b-C)/m,z=(c-S)/g,F=(-b-C)/m,I=(-c-S)/g,O=e(1,0,B,z),N=e(B,z,F,I);return v===0&&N>0&&(N-=u),v===1&&N<0&&(N+=u),[E,k,O,N]},n=function(r){var f=r.px,o=r.py,s=r.cx,m=r.cy,g=r.rx,p=r.ry,v=r.xAxisRotation,x=v===void 0?0:v,l=r.largeArcFlag,b=l===void 0?0:l,c=r.sweepFlag,M=c===void 0?0:c,_=[];if(g===0||p===0)return[];var y=Math.sin(x*u/360),w=Math.cos(x*u/360),d=w*(f-s)/2+y*(o-m)/2,C=-y*(f-s)/2+w*(o-m)/2;if(d===0&&C===0)return[];g=Math.abs(g),p=Math.abs(p);var S=Math.pow(d,2)/Math.pow(g,2)+Math.pow(C,2)/Math.pow(p,2);S>1&&(g*=Math.sqrt(S),p*=Math.sqrt(S));var E=i(f,o,s,m,g,p,b,M,y,w,d,C),k=h(E,4),B=k[0],z=k[1],F=k[2],I=k[3],O=Math.abs(I)/(u/4);Math.abs(1-O)<1e-7&&(O=1);var N=Math.max(Math.ceil(O),1);I/=N;for(var V=0;V<N;V++)_.push(T(F,I)),F+=I;return _.map(function(H){var j=A(H[0],g,p,w,y,B,z),Z=j.x,X=j.y,re=A(H[1],g,p,w,y,B,z),ue=re.x,K=re.y,te=A(H[2],g,p,w,y,B,z),G=te.x,Y=te.y;return{x1:Z,y1:X,x2:ue,y2:K,x:G,y:Y}})};R.default=n,P.exports=R.default},{}],309:[function(t,P,R){var h=t("parse-svg-path"),u=t("abs-svg-path"),A=t("normalize-svg-path"),T=t("is-svg-path"),e=t("assert");P.exports=i;function i(n){if(Array.isArray(n)&&n.length===1&&typeof n[0]=="string"&&(n=n[0]),typeof n=="string"&&(e(T(n),"String is not an SVG path."),n=h(n)),e(Array.isArray(n),"Argument should be a string or an array of path segments."),n=u(n),n=A(n),!n.length)return[0,0,0,0];for(var a=[1/0,1/0,-1/0,-1/0],r=0,f=n.length;r<f;r++)for(var o=n[r].slice(1),s=0;s<o.length;s+=2)o[s+0]<a[0]&&(a[0]=o[s+0]),o[s+1]<a[1]&&(a[1]=o[s+1]),o[s+0]>a[2]&&(a[2]=o[s+0]),o[s+1]>a[3]&&(a[3]=o[s+1]);return a}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":310,"parse-svg-path":250}],310:[function(t,P,R){P.exports=u;var h=t("svg-arc-to-cubic-bezier");function u(e){for(var i,n=[],a=0,r=0,f=0,o=0,s=null,m=null,g=0,p=0,v=0,x=e.length;v<x;v++){var l=e[v],b=l[0];switch(b){case"M":f=l[1],o=l[2];break;case"A":var c=h({px:g,py:p,cx:l[6],cy:l[7],rx:l[1],ry:l[2],xAxisRotation:l[3],largeArcFlag:l[4],sweepFlag:l[5]});if(!c.length)continue;for(var M=0,_;M<c.length;M++)_=c[M],l=["C",_.x1,_.y1,_.x2,_.y2,_.x,_.y],M<c.length-1&&n.push(l);break;case"S":var y=g,w=p;(i=="C"||i=="S")&&(y+=y-a,w+=w-r),l=["C",y,w,l[1],l[2],l[3],l[4]];break;case"T":i=="Q"||i=="T"?(s=g*2-s,m=p*2-m):(s=g,m=p),l=T(g,p,s,m,l[1],l[2]);break;case"Q":s=l[1],m=l[2],l=T(g,p,l[1],l[2],l[3],l[4]);break;case"L":l=A(g,p,l[1],l[2]);break;case"H":l=A(g,p,l[1],p);break;case"V":l=A(g,p,g,l[1]);break;case"Z":l=A(g,p,f,o);break}i=b,g=l[l.length-2],p=l[l.length-1],l.length>4?(a=l[l.length-4],r=l[l.length-3]):(a=g,r=p),n.push(l)}return n}function A(e,i,n,a){return["C",e,i,n,a,n,a]}function T(e,i,n,a,r,f){return["C",e/3+2/3*n,i/3+2/3*a,r/3+2/3*n,f/3+2/3*a,r,f]}},{"svg-arc-to-cubic-bezier":308}],311:[function(t,P,R){var h=t("svg-path-bounds"),u=t("parse-svg-path"),A=t("draw-svg-path"),T=t("is-svg-path"),e=t("bitmap-sdf"),i=document.createElement("canvas"),n=i.getContext("2d");P.exports=a;function a(o,s){if(!T(o))throw Error("Argument should be valid svg path string");s||(s={});var m,g;s.shape?(m=s.shape[0],g=s.shape[1]):(m=i.width=s.w||s.width||200,g=i.height=s.h||s.height||200);var p=Math.min(m,g),v=s.stroke||0,x=s.viewbox||s.viewBox||h(o),l=[m/(x[2]-x[0]),g/(x[3]-x[1])],b=Math.min(l[0]||0,l[1]||0)/2;if(n.fillStyle="black",n.fillRect(0,0,m,g),n.fillStyle="white",v&&(typeof v!="number"&&(v=1),v>0?n.strokeStyle="white":n.strokeStyle="black",n.lineWidth=Math.abs(v)),n.translate(m*.5,g*.5),n.scale(b,b),f()){var c=new Path2D(o);n.fill(c),v&&n.stroke(c)}else{var M=u(o);A(n,M),n.fill(),v&&n.stroke()}n.setTransform(1,0,0,1,0,0);var _=e(n,{cutoff:s.cutoff!=null?s.cutoff:.5,radius:s.radius!=null?s.radius:p*.5});return _}var r;function f(){if(r!=null)return r;var o=document.createElement("canvas").getContext("2d");if(o.canvas.width=o.canvas.height=1,!window.Path2D)return r=!1;var s=new Path2D("M0,0h1v1h-1v-1Z");o.fillStyle="black",o.fill(s);var m=o.getImageData(0,0,1,1);return r=m&&m.data&&m.data[3]===255}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":309}],312:[function(t,P,R){(function(h,u){(function(){var A=t("process/browser.js").nextTick,T=Function.prototype.apply,e=Array.prototype.slice,i={},n=0;R.setTimeout=function(){return new a(T.call(setTimeout,window,arguments),clearTimeout)},R.setInterval=function(){return new a(T.call(setInterval,window,arguments),clearInterval)},R.clearTimeout=R.clearInterval=function(r){r.close()};function a(r,f){this._id=r,this._clearFn=f}a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},R.enroll=function(r,f){clearTimeout(r._idleTimeoutId),r._idleTimeout=f},R.unenroll=function(r){clearTimeout(r._idleTimeoutId),r._idleTimeout=-1},R._unrefActive=R.active=function(r){clearTimeout(r._idleTimeoutId);var f=r._idleTimeout;f>=0&&(r._idleTimeoutId=setTimeout(function(){r._onTimeout&&r._onTimeout()},f))},R.setImmediate=typeof h=="function"?h:function(r){var f=n++,o=arguments.length<2?!1:e.call(arguments,1);return i[f]=!0,A(function(){i[f]&&(o?r.apply(null,o):r.call(null),R.clearImmediate(f))}),f},R.clearImmediate=typeof u=="function"?u:function(r){delete i[r]}}).call(this)}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":278,timers:312}],313:[function(t,P,R){(function(h){var u=/^\s+/,A=/\s+$/,T=0,e=h.round,i=h.min,n=h.max,a=h.random;function r(J,q){if(J=J||"",q=q||{},J instanceof r)return J;if(!(this instanceof r))return new r(J,q);var ae=f(J);this._originalInput=J,this._r=ae.r,this._g=ae.g,this._b=ae.b,this._a=ae.a,this._roundA=e(100*this._a)/100,this._format=q.format||ae.format,this._gradientType=q.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=ae.ok,this._tc_id=T++}r.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var J=this.toRgb();return(J.r*299+J.g*587+J.b*114)/1e3},getLuminance:function(){var J=this.toRgb(),q,ae,le,ie,se,xe;return q=J.r/255,ae=J.g/255,le=J.b/255,q<=.03928?ie=q/12.92:ie=h.pow((q+.055)/1.055,2.4),ae<=.03928?se=ae/12.92:se=h.pow((ae+.055)/1.055,2.4),le<=.03928?xe=le/12.92:xe=h.pow((le+.055)/1.055,2.4),.2126*ie+.7152*se+.0722*xe},setAlpha:function(J){return this._a=N(J),this._roundA=e(100*this._a)/100,this},toHsv:function(){var J=g(this._r,this._g,this._b);return{h:J.h*360,s:J.s,v:J.v,a:this._a}},toHsvString:function(){var J=g(this._r,this._g,this._b),q=e(J.h*360),ae=e(J.s*100),le=e(J.v*100);return this._a==1?"hsv("+q+", "+ae+"%, "+le+"%)":"hsva("+q+", "+ae+"%, "+le+"%, "+this._roundA+")"},toHsl:function(){var J=s(this._r,this._g,this._b);return{h:J.h*360,s:J.s,l:J.l,a:this._a}},toHslString:function(){var J=s(this._r,this._g,this._b),q=e(J.h*360),ae=e(J.s*100),le=e(J.l*100);return this._a==1?"hsl("+q+", "+ae+"%, "+le+"%)":"hsla("+q+", "+ae+"%, "+le+"%, "+this._roundA+")"},toHex:function(J){return v(this._r,this._g,this._b,J)},toHexString:function(J){return"#"+this.toHex(J)},toHex8:function(J){return x(this._r,this._g,this._b,this._a,J)},toHex8String:function(J){return"#"+this.toHex8(J)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(V(this._r,255)*100)+"%",g:e(V(this._g,255)*100)+"%",b:e(V(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(V(this._r,255)*100)+"%, "+e(V(this._g,255)*100)+"%, "+e(V(this._b,255)*100)+"%)":"rgba("+e(V(this._r,255)*100)+"%, "+e(V(this._g,255)*100)+"%, "+e(V(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:I[v(this._r,this._g,this._b,!0)]||!1},toFilter:function(J){var q="#"+l(this._r,this._g,this._b,this._a),ae=q,le=this._gradientType?"GradientType = 1, ":"";if(J){var ie=r(J);ae="#"+l(ie._r,ie._g,ie._b,ie._a)}return"progid:DXImageTransform.Microsoft.gradient("+le+"startColorstr="+q+",endColorstr="+ae+")"},toString:function(J){var q=!!J;J=J||this._format;var ae=!1,le=this._a<1&&this._a>=0,ie=!q&&le&&(J==="hex"||J==="hex6"||J==="hex3"||J==="hex4"||J==="hex8"||J==="name");return ie?J==="name"&&this._a===0?this.toName():this.toRgbString():(J==="rgb"&&(ae=this.toRgbString()),J==="prgb"&&(ae=this.toPercentageRgbString()),(J==="hex"||J==="hex6")&&(ae=this.toHexString()),J==="hex3"&&(ae=this.toHexString(!0)),J==="hex4"&&(ae=this.toHex8String(!0)),J==="hex8"&&(ae=this.toHex8String()),J==="name"&&(ae=this.toName()),J==="hsl"&&(ae=this.toHslString()),J==="hsv"&&(ae=this.toHsvString()),ae||this.toHexString())},clone:function(){return r(this.toString())},_applyModification:function(J,q){var ae=J.apply(null,[this].concat([].slice.call(q)));return this._r=ae._r,this._g=ae._g,this._b=ae._b,this.setAlpha(ae._a),this},lighten:function(){return this._applyModification(_,arguments)},brighten:function(){return this._applyModification(y,arguments)},darken:function(){return this._applyModification(w,arguments)},desaturate:function(){return this._applyModification(b,arguments)},saturate:function(){return this._applyModification(c,arguments)},greyscale:function(){return this._applyModification(M,arguments)},spin:function(){return this._applyModification(d,arguments)},_applyCombination:function(J,q){return J.apply(null,[this].concat([].slice.call(q)))},analogous:function(){return this._applyCombination(B,arguments)},complement:function(){return this._applyCombination(C,arguments)},monochromatic:function(){return this._applyCombination(z,arguments)},splitcomplement:function(){return this._applyCombination(k,arguments)},triad:function(){return this._applyCombination(S,arguments)},tetrad:function(){return this._applyCombination(E,arguments)}},r.fromRatio=function(J,q){if(typeof J=="object"){var ae={};for(var le in J)J.hasOwnProperty(le)&&(le==="a"?ae[le]=J[le]:ae[le]=ue(J[le]));J=ae}return r(J,q)};function f(J){var q={r:0,g:0,b:0},ae=1,le=null,ie=null,se=null,xe=!1,oe=!1;return typeof J=="string"&&(J=ee(J)),typeof J=="object"&&(Y(J.r)&&Y(J.g)&&Y(J.b)?(q=o(J.r,J.g,J.b),xe=!0,oe=String(J.r).substr(-1)==="%"?"prgb":"rgb"):Y(J.h)&&Y(J.s)&&Y(J.v)?(le=ue(J.s),ie=ue(J.v),q=p(J.h,le,ie),xe=!0,oe="hsv"):Y(J.h)&&Y(J.s)&&Y(J.l)&&(le=ue(J.s),se=ue(J.l),q=m(J.h,le,se),xe=!0,oe="hsl"),J.hasOwnProperty("a")&&(ae=J.a)),ae=N(ae),{ok:xe,format:J.format||oe,r:i(255,n(q.r,0)),g:i(255,n(q.g,0)),b:i(255,n(q.b,0)),a:ae}}function o(J,q,ae){return{r:V(J,255)*255,g:V(q,255)*255,b:V(ae,255)*255}}function s(J,q,ae){J=V(J,255),q=V(q,255),ae=V(ae,255);var le=n(J,q,ae),ie=i(J,q,ae),se,xe,oe=(le+ie)/2;if(le==ie)se=xe=0;else{var he=le-ie;switch(xe=oe>.5?he/(2-le-ie):he/(le+ie),le){case J:se=(q-ae)/he+(q<ae?6:0);break;case q:se=(ae-J)/he+2;break;case ae:se=(J-q)/he+4;break}se/=6}return{h:se,s:xe,l:oe}}function m(J,q,ae){var le,ie,se;J=V(J,360),q=V(q,100),ae=V(ae,100);function xe(be,me,_e){return _e<0&&(_e+=1),_e>1&&(_e-=1),_e<1/6?be+(me-be)*6*_e:_e<1/2?me:_e<2/3?be+(me-be)*(2/3-_e)*6:be}if(q===0)le=ie=se=ae;else{var oe=ae<.5?ae*(1+q):ae+q-ae*q,he=2*ae-oe;le=xe(he,oe,J+1/3),ie=xe(he,oe,J),se=xe(he,oe,J-1/3)}return{r:le*255,g:ie*255,b:se*255}}function g(J,q,ae){J=V(J,255),q=V(q,255),ae=V(ae,255);var le=n(J,q,ae),ie=i(J,q,ae),se,xe,oe=le,he=le-ie;if(xe=le===0?0:he/le,le==ie)se=0;else{switch(le){case J:se=(q-ae)/he+(q<ae?6:0);break;case q:se=(ae-J)/he+2;break;case ae:se=(J-q)/he+4;break}se/=6}return{h:se,s:xe,v:oe}}function p(J,q,ae){J=V(J,360)*6,q=V(q,100),ae=V(ae,100);var le=h.floor(J),ie=J-le,se=ae*(1-q),xe=ae*(1-ie*q),oe=ae*(1-(1-ie)*q),he=le%6,be=[ae,xe,se,se,oe,ae][he],me=[oe,ae,ae,xe,se,se][he],_e=[se,se,oe,ae,ae,xe][he];return{r:be*255,g:me*255,b:_e*255}}function v(J,q,ae,le){var ie=[re(e(J).toString(16)),re(e(q).toString(16)),re(e(ae).toString(16))];return le&&ie[0].charAt(0)==ie[0].charAt(1)&&ie[1].charAt(0)==ie[1].charAt(1)&&ie[2].charAt(0)==ie[2].charAt(1)?ie[0].charAt(0)+ie[1].charAt(0)+ie[2].charAt(0):ie.join("")}function x(J,q,ae,le,ie){var se=[re(e(J).toString(16)),re(e(q).toString(16)),re(e(ae).toString(16)),re(K(le))];return ie&&se[0].charAt(0)==se[0].charAt(1)&&se[1].charAt(0)==se[1].charAt(1)&&se[2].charAt(0)==se[2].charAt(1)&&se[3].charAt(0)==se[3].charAt(1)?se[0].charAt(0)+se[1].charAt(0)+se[2].charAt(0)+se[3].charAt(0):se.join("")}function l(J,q,ae,le){var ie=[re(K(le)),re(e(J).toString(16)),re(e(q).toString(16)),re(e(ae).toString(16))];return ie.join("")}r.equals=function(J,q){return!J||!q?!1:r(J).toRgbString()==r(q).toRgbString()},r.random=function(){return r.fromRatio({r:a(),g:a(),b:a()})};function b(J,q){q=q===0?0:q||10;var ae=r(J).toHsl();return ae.s-=q/100,ae.s=H(ae.s),r(ae)}function c(J,q){q=q===0?0:q||10;var ae=r(J).toHsl();return ae.s+=q/100,ae.s=H(ae.s),r(ae)}function M(J){return r(J).desaturate(100)}function _(J,q){q=q===0?0:q||10;var ae=r(J).toHsl();return ae.l+=q/100,ae.l=H(ae.l),r(ae)}function y(J,q){q=q===0?0:q||10;var ae=r(J).toRgb();return ae.r=n(0,i(255,ae.r-e(255*-(q/100)))),ae.g=n(0,i(255,ae.g-e(255*-(q/100)))),ae.b=n(0,i(255,ae.b-e(255*-(q/100)))),r(ae)}function w(J,q){q=q===0?0:q||10;var ae=r(J).toHsl();return ae.l-=q/100,ae.l=H(ae.l),r(ae)}function d(J,q){var ae=r(J).toHsl(),le=(ae.h+q)%360;return ae.h=le<0?360+le:le,r(ae)}function C(J){var q=r(J).toHsl();return q.h=(q.h+180)%360,r(q)}function S(J){var q=r(J).toHsl(),ae=q.h;return[r(J),r({h:(ae+120)%360,s:q.s,l:q.l}),r({h:(ae+240)%360,s:q.s,l:q.l})]}function E(J){var q=r(J).toHsl(),ae=q.h;return[r(J),r({h:(ae+90)%360,s:q.s,l:q.l}),r({h:(ae+180)%360,s:q.s,l:q.l}),r({h:(ae+270)%360,s:q.s,l:q.l})]}function k(J){var q=r(J).toHsl(),ae=q.h;return[r(J),r({h:(ae+72)%360,s:q.s,l:q.l}),r({h:(ae+216)%360,s:q.s,l:q.l})]}function B(J,q,ae){q=q||6,ae=ae||30;var le=r(J).toHsl(),ie=360/ae,se=[r(J)];for(le.h=(le.h-(ie*q>>1)+720)%360;--q;)le.h=(le.h+ie)%360,se.push(r(le));return se}function z(J,q){q=q||6;for(var ae=r(J).toHsv(),le=ae.h,ie=ae.s,se=ae.v,xe=[],oe=1/q;q--;)xe.push(r({h:le,s:ie,v:se})),se=(se+oe)%1;return xe}r.mix=function(J,q,ae){ae=ae===0?0:ae||50;var le=r(J).toRgb(),ie=r(q).toRgb(),se=ae/100,xe={r:(ie.r-le.r)*se+le.r,g:(ie.g-le.g)*se+le.g,b:(ie.b-le.b)*se+le.b,a:(ie.a-le.a)*se+le.a};return r(xe)},r.readability=function(J,q){var ae=r(J),le=r(q);return(h.max(ae.getLuminance(),le.getLuminance())+.05)/(h.min(ae.getLuminance(),le.getLuminance())+.05)},r.isReadable=function(J,q,ae){var le=r.readability(J,q),ie,se;switch(se=!1,ie=ne(ae),ie.level+ie.size){case"AAsmall":case"AAAlarge":se=le>=4.5;break;case"AAlarge":se=le>=3;break;case"AAAsmall":se=le>=7;break}return se},r.mostReadable=function(J,q,ae){var le=null,ie=0,se,xe,oe,he;ae=ae||{},xe=ae.includeFallbackColors,oe=ae.level,he=ae.size;for(var be=0;be<q.length;be++)se=r.readability(J,q[be]),se>ie&&(ie=se,le=r(q[be]));return r.isReadable(J,le,{level:oe,size:he})||!xe?le:(ae.includeFallbackColors=!1,r.mostReadable(J,["#fff","#000"],ae))};var F=r.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},I=r.hexNames=O(F);function O(J){var q={};for(var ae in J)J.hasOwnProperty(ae)&&(q[J[ae]]=ae);return q}function N(J){return J=parseFloat(J),(isNaN(J)||J<0||J>1)&&(J=1),J}function V(J,q){Z(J)&&(J="100%");var ae=X(J);return J=i(q,n(0,parseFloat(J))),ae&&(J=parseInt(J*q,10)/100),h.abs(J-q)<1e-6?1:J%q/parseFloat(q)}function H(J){return i(1,n(0,J))}function j(J){return parseInt(J,16)}function Z(J){return typeof J=="string"&&J.indexOf(".")!=-1&&parseFloat(J)===1}function X(J){return typeof J=="string"&&J.indexOf("%")!=-1}function re(J){return J.length==1?"0"+J:""+J}function ue(J){return J<=1&&(J=J*100+"%"),J}function K(J){return h.round(parseFloat(J)*255).toString(16)}function te(J){return j(J)/255}var G=function(){var J="[-\\+]?\\d+%?",q="[-\\+]?\\d*\\.\\d+%?",ae="(?:"+q+")|(?:"+J+")",le="[\\s|\\(]+("+ae+")[,|\\s]+("+ae+")[,|\\s]+("+ae+")\\s*\\)?",ie="[\\s|\\(]+("+ae+")[,|\\s]+("+ae+")[,|\\s]+("+ae+")[,|\\s]+("+ae+")\\s*\\)?";return{CSS_UNIT:new RegExp(ae),rgb:new RegExp("rgb"+le),rgba:new RegExp("rgba"+ie),hsl:new RegExp("hsl"+le),hsla:new RegExp("hsla"+ie),hsv:new RegExp("hsv"+le),hsva:new RegExp("hsva"+ie),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Y(J){return!!G.CSS_UNIT.exec(J)}function ee(J){J=J.replace(u,"").replace(A,"").toLowerCase();var q=!1;if(F[J])J=F[J],q=!0;else if(J=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var ae;return(ae=G.rgb.exec(J))?{r:ae[1],g:ae[2],b:ae[3]}:(ae=G.rgba.exec(J))?{r:ae[1],g:ae[2],b:ae[3],a:ae[4]}:(ae=G.hsl.exec(J))?{h:ae[1],s:ae[2],l:ae[3]}:(ae=G.hsla.exec(J))?{h:ae[1],s:ae[2],l:ae[3],a:ae[4]}:(ae=G.hsv.exec(J))?{h:ae[1],s:ae[2],v:ae[3]}:(ae=G.hsva.exec(J))?{h:ae[1],s:ae[2],v:ae[3],a:ae[4]}:(ae=G.hex8.exec(J))?{r:j(ae[1]),g:j(ae[2]),b:j(ae[3]),a:te(ae[4]),format:q?"name":"hex8"}:(ae=G.hex6.exec(J))?{r:j(ae[1]),g:j(ae[2]),b:j(ae[3]),format:q?"name":"hex"}:(ae=G.hex4.exec(J))?{r:j(ae[1]+""+ae[1]),g:j(ae[2]+""+ae[2]),b:j(ae[3]+""+ae[3]),a:te(ae[4]+""+ae[4]),format:q?"name":"hex8"}:(ae=G.hex3.exec(J))?{r:j(ae[1]+""+ae[1]),g:j(ae[2]+""+ae[2]),b:j(ae[3]+""+ae[3]),format:q?"name":"hex"}:!1}function ne(J){var q,ae;return J=J||{level:"AA",size:"small"},q=(J.level||"AA").toUpperCase(),ae=(J.size||"small").toLowerCase(),q!=="AA"&&q!=="AAA"&&(q="AA"),ae!=="small"&&ae!=="large"&&(ae="small"),{level:q,size:ae}}typeof P<"u"&&P.exports?P.exports=r:window.tinycolor=r})(Math)},{}],314:[function(t,P,R){P.exports=A,P.exports.float32=P.exports.float=A,P.exports.fract32=P.exports.fract=u;var h=new Float32Array(1);function u(T,e){if(T.length){if(T instanceof Float32Array)return new Float32Array(T.length);e instanceof Float32Array||(e=A(T));for(var i=0,n=e.length;i<n;i++)e[i]=T[i]-e[i];return e}return A(T-A(T))}function A(T){return T.length?T instanceof Float32Array?T:new Float32Array(T):(h[0]=T,h[0])}},{}],315:[function(t,P,R){var h=t("parse-unit");P.exports=e;var u=96;function A(i,n){var a=h(getComputedStyle(i).getPropertyValue(n));return a[0]*e(a[1],i)}function T(i,n){var a=document.createElement("div");a.style["font-size"]="128"+i,n.appendChild(a);var r=A(a,"font-size")/128;return n.removeChild(a),r}function e(i,n){switch(n=n||document.body,i=(i||"px").trim().toLowerCase(),(n===window||n===document)&&(n=document.body),i){case"%":return n.clientHeight/100;case"ch":case"ex":return T(i,n);case"em":return A(n,"font-size");case"rem":return A(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return u;case"cm":return u/2.54;case"mm":return u/25.4;case"pt":return u/72;case"pc":return u/6}return 1}},{"parse-unit":251}],316:[function(t,P,R){(function(h,u){typeof R=="object"&&typeof P<"u"?u(R):(h=h||self,u(h.topojson=h.topojson||{}))})(this,function(h){function u(c){return c}function A(c){if(c==null)return u;var M,_,y=c.scale[0],w=c.scale[1],d=c.translate[0],C=c.translate[1];return function(S,E){E||(M=_=0);var k=2,B=S.length,z=new Array(B);for(z[0]=(M+=S[0])*y+d,z[1]=(_+=S[1])*w+C;k<B;)z[k]=S[k],++k;return z}}function T(c){var M=A(c.transform),_,y=1/0,w=y,d=-y,C=-y;function S(k){k=M(k),k[0]<y&&(y=k[0]),k[0]>d&&(d=k[0]),k[1]<w&&(w=k[1]),k[1]>C&&(C=k[1])}function E(k){switch(k.type){case"GeometryCollection":k.geometries.forEach(E);break;case"Point":S(k.coordinates);break;case"MultiPoint":k.coordinates.forEach(S);break}}c.arcs.forEach(function(k){for(var B=-1,z=k.length,F;++B<z;)F=M(k[B],B),F[0]<y&&(y=F[0]),F[0]>d&&(d=F[0]),F[1]<w&&(w=F[1]),F[1]>C&&(C=F[1])});for(_ in c.objects)E(c.objects[_]);return[y,w,d,C]}function e(c,M){for(var _,y=c.length,w=y-M;w<--y;)_=c[w],c[w++]=c[y],c[y]=_}function i(c,M){return typeof M=="string"&&(M=c.objects[M]),M.type==="GeometryCollection"?{type:"FeatureCollection",features:M.geometries.map(function(_){return n(c,_)})}:n(c,M)}function n(c,M){var _=M.id,y=M.bbox,w=M.properties==null?{}:M.properties,d=a(c,M);return _==null&&y==null?{type:"Feature",properties:w,geometry:d}:y==null?{type:"Feature",id:_,properties:w,geometry:d}:{type:"Feature",id:_,bbox:y,properties:w,geometry:d}}function a(c,M){var _=A(c.transform),y=c.arcs;function w(B,z){z.length&&z.pop();for(var F=y[B<0?~B:B],I=0,O=F.length;I<O;++I)z.push(_(F[I],I));B<0&&e(z,O)}function d(B){return _(B)}function C(B){for(var z=[],F=0,I=B.length;F<I;++F)w(B[F],z);return z.length<2&&z.push(z[0]),z}function S(B){for(var z=C(B);z.length<4;)z.push(z[0]);return z}function E(B){return B.map(S)}function k(B){var z=B.type,F;switch(z){case"GeometryCollection":return{type:z,geometries:B.geometries.map(k)};case"Point":F=d(B.coordinates);break;case"MultiPoint":F=B.coordinates.map(d);break;case"LineString":F=C(B.arcs);break;case"MultiLineString":F=B.arcs.map(C);break;case"Polygon":F=E(B.arcs);break;case"MultiPolygon":F=B.arcs.map(E);break;default:return null}return{type:z,coordinates:F}}return k(M)}function r(c,M){var _={},y={},w={},d=[],C=-1;M.forEach(function(k,B){var z=c.arcs[k<0?~k:k],F;z.length<3&&!z[1][0]&&!z[1][1]&&(F=M[++C],M[C]=k,M[B]=F)}),M.forEach(function(k){var B=S(k),z=B[0],F=B[1],I,O;if(I=w[z])if(delete w[I.end],I.push(k),I.end=F,O=y[F]){delete y[O.start];var N=O===I?I:I.concat(O);y[N.start=I.start]=w[N.end=O.end]=N}else y[I.start]=w[I.end]=I;else if(I=y[F])if(delete y[I.start],I.unshift(k),I.start=z,O=w[z]){delete w[O.end];var V=O===I?I:O.concat(I);y[V.start=O.start]=w[V.end=I.end]=V}else y[I.start]=w[I.end]=I;else I=[k],y[I.start=z]=w[I.end=F]=I});function S(k){var B=c.arcs[k<0?~k:k],z=B[0],F;return c.transform?(F=[0,0],B.forEach(function(I){F[0]+=I[0],F[1]+=I[1]})):F=B[B.length-1],k<0?[F,z]:[z,F]}function E(k,B){for(var z in k){var F=k[z];delete B[F.start],delete F.start,delete F.end,F.forEach(function(I){_[I<0?~I:I]=1}),d.push(F)}}return E(w,y),E(y,w),M.forEach(function(k){_[k<0?~k:k]||d.push([k])}),d}function f(c){return a(c,o.apply(this,arguments))}function o(c,M,_){var y,w,d;if(arguments.length>1)y=s(c,M,_);else for(w=0,y=new Array(d=c.arcs.length);w<d;++w)y[w]=w;return{type:"MultiLineString",arcs:r(c,y)}}function s(c,M,_){var y=[],w=[],d;function C(z){var F=z<0?~z:z;(w[F]||(w[F]=[])).push({i:z,g:d})}function S(z){z.forEach(C)}function E(z){z.forEach(S)}function k(z){z.forEach(E)}function B(z){switch(d=z,z.type){case"GeometryCollection":z.geometries.forEach(B);break;case"LineString":S(z.arcs);break;case"MultiLineString":case"Polygon":E(z.arcs);break;case"MultiPolygon":k(z.arcs);break}}return B(M),w.forEach(_==null?function(z){y.push(z[0].i)}:function(z){_(z[0].g,z[z.length-1].g)&&y.push(z[0].i)}),y}function m(c){for(var M=-1,_=c.length,y,w=c[_-1],d=0;++M<_;)y=w,w=c[M],d+=y[0]*w[1]-y[1]*w[0];return Math.abs(d)}function g(c){return a(c,p.apply(this,arguments))}function p(c,M){var _={},y=[],w=[];M.forEach(d);function d(E){switch(E.type){case"GeometryCollection":E.geometries.forEach(d);break;case"Polygon":C(E.arcs);break;case"MultiPolygon":E.arcs.forEach(C);break}}function C(E){E.forEach(function(k){k.forEach(function(B){(_[B=B<0?~B:B]||(_[B]=[])).push(E)})}),y.push(E)}function S(E){return m(a(c,{type:"Polygon",arcs:[E]}).coordinates[0])}return y.forEach(function(E){if(!E._){var k=[],B=[E];for(E._=1,w.push(k);E=B.pop();)k.push(E),E.forEach(function(z){z.forEach(function(F){_[F<0?~F:F].forEach(function(I){I._||(I._=1,B.push(I))})})})}}),y.forEach(function(E){delete E._}),{type:"MultiPolygon",arcs:w.map(function(E){var k=[],B;if(E.forEach(function(N){N.forEach(function(V){V.forEach(function(H){_[H<0?~H:H].length<2&&k.push(H)})})}),k=r(c,k),(B=k.length)>1)for(var z=1,F=S(k[0]),I,O;z<B;++z)(I=S(k[z]))>F&&(O=k[0],k[0]=k[z],k[z]=O,F=I);return k}).filter(function(E){return E.length>0})}}function v(c,M){for(var _=0,y=c.length;_<y;){var w=_+y>>>1;c[w]<M?_=w+1:y=w}return _}function x(c){var M={},_=c.map(function(){return[]});function y(N,V){N.forEach(function(H){H<0&&(H=~H);var j=M[H];j?j.push(V):M[H]=[V]})}function w(N,V){N.forEach(function(H){y(H,V)})}function d(N,V){N.type==="GeometryCollection"?N.geometries.forEach(function(H){d(H,V)}):N.type in C&&C[N.type](N.arcs,V)}var C={LineString:y,MultiLineString:w,Polygon:w,MultiPolygon:function(N,V){N.forEach(function(H){w(H,V)})}};c.forEach(d);for(var S in M)for(var E=M[S],k=E.length,B=0;B<k;++B)for(var z=B+1;z<k;++z){var F=E[B],I=E[z],O;(O=_[F])[S=v(O,I)]!==I&&O.splice(S,0,I),(O=_[I])[S=v(O,F)]!==F&&O.splice(S,0,F)}return _}function l(c){if(c==null)return u;var M,_,y=c.scale[0],w=c.scale[1],d=c.translate[0],C=c.translate[1];return function(S,E){E||(M=_=0);var k=2,B=S.length,z=new Array(B),F=Math.round((S[0]-d)/y),I=Math.round((S[1]-C)/w);for(z[0]=F-M,M=F,z[1]=I-_,_=I;k<B;)z[k]=S[k],++k;return z}}function b(c,M){if(c.transform)throw new Error("already quantized");if(!M||!M.scale){if(!((C=Math.floor(M))>=2))throw new Error("n must be \u22652");E=c.bbox||T(c);var _=E[0],y=E[1],w=E[2],d=E[3],C;M={scale:[w-_?(w-_)/(C-1):1,d-y?(d-y)/(C-1):1],translate:[_,y]}}else E=c.bbox;var S=l(M),E,k,B=c.objects,z={};function F(N){return S(N)}function I(N){var V;switch(N.type){case"GeometryCollection":V={type:"GeometryCollection",geometries:N.geometries.map(I)};break;case"Point":V={type:"Point",coordinates:F(N.coordinates)};break;case"MultiPoint":V={type:"MultiPoint",coordinates:N.coordinates.map(F)};break;default:return N}return N.id!=null&&(V.id=N.id),N.bbox!=null&&(V.bbox=N.bbox),N.properties!=null&&(V.properties=N.properties),V}function O(N){var V=0,H=1,j=N.length,Z,X=new Array(j);for(X[0]=S(N[0],0);++V<j;)((Z=S(N[V],V))[0]||Z[1])&&(X[H++]=Z);return H===1&&(X[H++]=[0,0]),X.length=H,X}for(k in B)z[k]=I(B[k]);return{type:"Topology",bbox:E,transform:M,objects:z,arcs:c.arcs.map(O)}}h.bbox=T,h.feature=i,h.merge=g,h.mergeArcs=p,h.mesh=f,h.meshArcs=o,h.neighbors=x,h.quantize=b,h.transform=A,h.untransform=l,Object.defineProperty(h,"__esModule",{value:!0})})},{}],317:[function(t,P,R){var h=t("../prototype/is");P.exports=function(u){if(typeof u!="function"||!hasOwnProperty.call(u,"length"))return!1;try{if(typeof u.length!="number"||typeof u.call!="function"||typeof u.apply!="function")return!1}catch{return!1}return!h(u)}},{"../prototype/is":324}],318:[function(t,P,R){var h=t("../value/is"),u=t("../object/is"),A=t("../string/coerce"),T=t("./to-short-string"),e=function(i,n){return i.replace("%v",T(n))};P.exports=function(i,n,a){if(!u(a))throw new TypeError(e(n,i));if(!h(i)){if("default"in a)return a.default;if(a.isOptional)return null}var r=A(a.errorMessage);throw h(r)||(r=n),new TypeError(e(r,i))}},{"../object/is":321,"../string/coerce":325,"../value/is":327,"./to-short-string":320}],319:[function(t,P,R){P.exports=function(h){try{return h.toString()}catch{try{return String(h)}catch{return null}}}},{}],320:[function(t,P,R){var h=t("./safe-to-string"),u=/[\n\r\u2028\u2029]/g;P.exports=function(A){var T=h(A);return T===null?"<Non-coercible to string value>":(T.length>100&&(T=T.slice(0,99)+"\u2026"),T=T.replace(u,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}),T)}},{"./safe-to-string":319}],321:[function(t,P,R){var h=t("../value/is"),u={object:!0,function:!0,undefined:!0};P.exports=function(A){return h(A)?hasOwnProperty.call(u,typeof A):!1}},{"../value/is":327}],322:[function(t,P,R){var h=t("../lib/resolve-exception"),u=t("./is");P.exports=function(A){return u(A)?A:h(A,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":318,"./is":323}],323:[function(t,P,R){var h=t("../function/is"),u=/^\s*class[\s{/}]/,A=Function.prototype.toString;P.exports=function(T){return!(!h(T)||u.test(A.call(T)))}},{"../function/is":317}],324:[function(t,P,R){var h=t("../object/is");P.exports=function(u){if(!h(u))return!1;try{return u.constructor?u.constructor.prototype===u:!1}catch{return!1}}},{"../object/is":321}],325:[function(t,P,R){var h=t("../value/is"),u=t("../object/is"),A=Object.prototype.toString;P.exports=function(T){if(!h(T))return null;if(u(T)){var e=T.toString;if(typeof e!="function"||e===A)return null}try{return""+T}catch{return null}}},{"../object/is":321,"../value/is":327}],326:[function(t,P,R){var h=t("../lib/resolve-exception"),u=t("./is");P.exports=function(A){return u(A)?A:h(A,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":318,"./is":327}],327:[function(t,P,R){var h=void 0;P.exports=function(u){return u!==h&&u!==null}},{}],328:[function(t,P,R){(function(h){(function(){var u=t("bit-twiddle"),A=t("dup"),T=t("buffer").Buffer;h.__TYPEDARRAY_POOL||(h.__TYPEDARRAY_POOL={UINT8:A([32,0]),UINT16:A([32,0]),UINT32:A([32,0]),BIGUINT64:A([32,0]),INT8:A([32,0]),INT16:A([32,0]),INT32:A([32,0]),BIGINT64:A([32,0]),FLOAT:A([32,0]),DOUBLE:A([32,0]),DATA:A([32,0]),UINT8C:A([32,0]),BUFFER:A([32,0])});var e=typeof Uint8ClampedArray<"u",i=typeof BigUint64Array<"u",n=typeof BigInt64Array<"u",a=h.__TYPEDARRAY_POOL;a.UINT8C||(a.UINT8C=A([32,0])),a.BIGUINT64||(a.BIGUINT64=A([32,0])),a.BIGINT64||(a.BIGINT64=A([32,0])),a.BUFFER||(a.BUFFER=A([32,0]));var r=a.DATA,f=a.BUFFER;R.free=function(E){if(T.isBuffer(E))f[u.log2(E.length)].push(E);else{if(Object.prototype.toString.call(E)!=="[object ArrayBuffer]"&&(E=E.buffer),!E)return;var k=E.length||E.byteLength,B=u.log2(k)|0;r[B].push(E)}};function o(S){if(!!S){var E=S.length||S.byteLength,k=u.log2(E);r[k].push(S)}}function s(S){o(S.buffer)}R.freeUint8=R.freeUint16=R.freeUint32=R.freeBigUint64=R.freeInt8=R.freeInt16=R.freeInt32=R.freeBigInt64=R.freeFloat32=R.freeFloat=R.freeFloat64=R.freeDouble=R.freeUint8Clamped=R.freeDataView=s,R.freeArrayBuffer=o,R.freeBuffer=function(E){f[u.log2(E.length)].push(E)},R.malloc=function(E,k){if(k===void 0||k==="arraybuffer")return m(E);switch(k){case"uint8":return g(E);case"uint16":return p(E);case"uint32":return v(E);case"int8":return x(E);case"int16":return l(E);case"int32":return b(E);case"float":case"float32":return c(E);case"double":case"float64":return M(E);case"uint8_clamped":return _(E);case"bigint64":return w(E);case"biguint64":return y(E);case"buffer":return C(E);case"data":case"dataview":return d(E);default:return null}return null};function m(E){var E=u.nextPow2(E),k=u.log2(E),B=r[k];return B.length>0?B.pop():new ArrayBuffer(E)}R.mallocArrayBuffer=m;function g(S){return new Uint8Array(m(S),0,S)}R.mallocUint8=g;function p(S){return new Uint16Array(m(2*S),0,S)}R.mallocUint16=p;function v(S){return new Uint32Array(m(4*S),0,S)}R.mallocUint32=v;function x(S){return new Int8Array(m(S),0,S)}R.mallocInt8=x;function l(S){return new Int16Array(m(2*S),0,S)}R.mallocInt16=l;function b(S){return new Int32Array(m(4*S),0,S)}R.mallocInt32=b;function c(S){return new Float32Array(m(4*S),0,S)}R.mallocFloat32=R.mallocFloat=c;function M(S){return new Float64Array(m(8*S),0,S)}R.mallocFloat64=R.mallocDouble=M;function _(S){return e?new Uint8ClampedArray(m(S),0,S):g(S)}R.mallocUint8Clamped=_;function y(S){return i?new BigUint64Array(m(8*S),0,S):null}R.mallocBigUint64=y;function w(S){return n?new BigInt64Array(m(8*S),0,S):null}R.mallocBigInt64=w;function d(S){return new DataView(m(S),0,S)}R.mallocDataView=d;function C(S){S=u.nextPow2(S);var E=u.log2(S),k=f[E];return k.length>0?k.pop():new T(S)}R.mallocBuffer=C,R.clearCache=function(){for(var E=0;E<32;++E)a.UINT8[E].length=0,a.UINT16[E].length=0,a.UINT32[E].length=0,a.INT8[E].length=0,a.INT16[E].length=0,a.INT32[E].length=0,a.FLOAT[E].length=0,a.DOUBLE[E].length=0,a.BIGUINT64[E].length=0,a.BIGINT64[E].length=0,a.UINT8C[E].length=0,r[E].length=0,f[E].length=0}}).call(this)}).call(this,typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],329:[function(t,P,R){var h=/[\'\"]/;P.exports=function(A){return A?(h.test(A.charAt(0))&&(A=A.substr(1)),h.test(A.charAt(A.length-1))&&(A=A.substr(0,A.length-1)),A):""}},{}],330:[function(t,P,R){P.exports=function(u,A,T){Array.isArray(T)||(T=[].slice.call(arguments,2));for(var e=0,i=T.length;e<i;e++){var n=T[e];for(var a in n)if(!(A[a]!==void 0&&!Array.isArray(A[a])&&u[a]===A[a])&&a in A){var r;if(n[a]===!0)r=A[a];else{if(n[a]===!1)continue;if(typeof n[a]=="function"&&(r=n[a](A[a],u,A),r===void 0))continue}u[a]=r}}return u}},{}],331:[function(t,P,R){(function(h){(function(){P.exports=u;function u(T,e){if(A("noDeprecation"))return T;var i=!1;function n(){if(!i){if(A("throwDeprecation"))throw new Error(e);A("traceDeprecation")?console.trace(e):console.warn(e),i=!0}return T.apply(this,arguments)}return n}function A(T){try{if(!h.localStorage)return!1}catch{return!1}var e=h.localStorage[T];return e==null?!1:String(e).toLowerCase()==="true"}}).call(this)}).call(this,typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{}],332:[function(t,P,R){var h=t("get-canvas-context");P.exports=function(A){return h("webgl",A)}},{"get-canvas-context":194}],333:[function(t,P,R){var h=t("../main"),u=t("object-assign"),A=h.instance();function T(m){this.local=this.regionalOptions[m||""]||this.regionalOptions[""]}T.prototype=new h.baseCalendar,u(T.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(m,g){if(typeof m=="string"){var p=m.match(i);return p?p[0]:""}var v=this._validateYear(m),x=m.month(),l=""+this.toChineseMonth(v,x);return g&&l.length<2&&(l="0"+l),this.isIntercalaryMonth(v,x)&&(l+="i"),l},monthNames:function(m){if(typeof m=="string"){var g=m.match(n);return g?g[0]:""}var p=this._validateYear(m),v=m.month(),x=this.toChineseMonth(p,v),l=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][x-1];return this.isIntercalaryMonth(p,v)&&(l="\u95F0"+l),l},monthNamesShort:function(m){if(typeof m=="string"){var g=m.match(a);return g?g[0]:""}var p=this._validateYear(m),v=m.month(),x=this.toChineseMonth(p,v),l=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][x-1];return this.isIntercalaryMonth(p,v)&&(l="\u95F0"+l),l},parseMonth:function(m,g){m=this._validateYear(m);var p=parseInt(g),v;if(isNaN(p))g[0]==="\u95F0"&&(v=!0,g=g.substring(1)),g[g.length-1]==="\u6708"&&(g=g.substring(0,g.length-1)),p=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(g);else{var x=g[g.length-1];v=x==="i"||x==="I"}var l=this.toMonthIndex(m,p,v);return l},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(m,g){if(m.year&&(m=m.year()),typeof m!="number"||m<1888||m>2111)throw g.replace(/\{0\}/,this.local.name);return m},toMonthIndex:function(m,g,p){var v=this.intercalaryMonth(m),x=p&&g!==v;if(x||g<1||g>12)throw h.local.invalidMonth.replace(/\{0\}/,this.local.name);var l;return v?!p&&g<=v?l=g-1:l=g:l=g-1,l},toChineseMonth:function(m,g){m.year&&(m=m.year(),g=m.month());var p=this.intercalaryMonth(m),v=p?12:11;if(g<0||g>v)throw h.local.invalidMonth.replace(/\{0\}/,this.local.name);var x;return p?g<p?x=g+1:x=g:x=g+1,x},intercalaryMonth:function(m){m=this._validateYear(m);var g=r[m-r[0]],p=g>>13;return p},isIntercalaryMonth:function(m,g){m.year&&(m=m.year(),g=m.month());var p=this.intercalaryMonth(m);return!!p&&p===g},leapYear:function(m){return this.intercalaryMonth(m)!==0},weekOfYear:function(m,g,p){var v=this._validateYear(m,h.local.invalidyear),x=f[v-f[0]],l=x>>9&4095,b=x>>5&15,c=x&31,M;M=A.newDate(l,b,c),M.add(4-(M.dayOfWeek()||7),"d");var _=this.toJD(m,g,p)-M.toJD();return 1+Math.floor(_/7)},monthsInYear:function(m){return this.leapYear(m)?13:12},daysInMonth:function(m,g){m.year&&(g=m.month(),m=m.year()),m=this._validateYear(m);var p=r[m-r[0]],v=p>>13,x=v?12:11;if(g>x)throw h.local.invalidMonth.replace(/\{0\}/,this.local.name);var l=p&1<<12-g?30:29;return l},weekDay:function(m,g,p){return(this.dayOfWeek(m,g,p)||7)<6},toJD:function(m,g,p){var v=this._validate(m,l,p,h.local.invalidDate);m=this._validateYear(v.year()),g=v.month(),p=v.day();var x=this.isIntercalaryMonth(m,g),l=this.toChineseMonth(m,g),b=s(m,l,p,x);return A.toJD(b.year,b.month,b.day)},fromJD:function(m){var g=A.fromJD(m),p=o(g.year(),g.month(),g.day()),v=this.toMonthIndex(p.year,p.month,p.isIntercalary);return this.newDate(p.year,v,p.day)},fromString:function(m){var g=m.match(e),p=this._validateYear(+g[1]),v=+g[2],x=!!g[3],l=this.toMonthIndex(p,v,x),b=+g[4];return this.newDate(p,l,b)},add:function(m,g,p){var v=m.year(),x=m.month(),l=this.isIntercalaryMonth(v,x),b=this.toChineseMonth(v,x),c=Object.getPrototypeOf(T.prototype).add.call(this,m,g,p);if(p==="y"){var M=c.year(),_=c.month(),y=this.isIntercalaryMonth(M,b),w=l&&y?this.toMonthIndex(M,b,!0):this.toMonthIndex(M,b,!1);w!==_&&c.month(w)}return c}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,i=/^\d?\d[iI]?/m,n=/^闰?十?[一二三四五六七八九]?月/m,a=/^闰?十?[一二三四五六七八九]?/m;h.calendars.chinese=T;var r=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],f=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904];function o(m,g,p,v){var x,l;if(typeof m=="object")x=m,l=g||{};else{var b=typeof m=="number"&&m>=1888&&m<=2111;if(!b)throw new Error("Solar year outside range 1888-2111");var c=typeof g=="number"&&g>=1&&g<=12;if(!c)throw new Error("Solar month outside range 1 - 12");var M=typeof p=="number"&&p>=1&&p<=31;if(!M)throw new Error("Solar day outside range 1 - 31");x={year:m,month:g,day:p},l=v||{}}var _=f[x.year-f[0]],y=x.year<<9|x.month<<5|x.day;l.year=y>=_?x.year:x.year-1,_=f[l.year-f[0]];var w=_>>9&4095,d=_>>5&15,C=_&31,S,E=new Date(w,d-1,C),k=new Date(x.year,x.month-1,x.day);S=Math.round((k-E)/(24*3600*1e3));var B=r[l.year-r[0]],z;for(z=0;z<13;z++){var F=B&1<<12-z?30:29;if(S<F)break;S-=F}var I=B>>13;return!I||z<I?(l.isIntercalary=!1,l.month=1+z):z===I?(l.isIntercalary=!0,l.month=z):(l.isIntercalary=!1,l.month=z),l.day=1+S,l}function s(m,g,p,v,x){var l,b;if(typeof m=="object")b=m,l=g||{};else{var c=typeof m=="number"&&m>=1888&&m<=2111;if(!c)throw new Error("Lunar year outside range 1888-2111");var M=typeof g=="number"&&g>=1&&g<=12;if(!M)throw new Error("Lunar month outside range 1 - 12");var _=typeof p=="number"&&p>=1&&p<=30;if(!_)throw new Error("Lunar day outside range 1 - 30");var y;typeof v=="object"?(y=!1,l=v):(y=!!v,l=x||{}),b={year:m,month:g,day:p,isIntercalary:y}}var w;w=b.day-1;var d=r[b.year-r[0]],C=d>>13,S;C&&(b.month>C||b.isIntercalary)?S=b.month:S=b.month-1;for(var E=0;E<S;E++){var k=d&1<<12-E?30:29;w+=k}var B=f[b.year-f[0]],z=B>>9&4095,F=B>>5&15,I=B&31,O=new Date(z,F-1,I+w);return l.year=O.getFullYear(),l.month=1+O.getMonth(),l.day=O.getDate(),l}},{"../main":347,"object-assign":247}],334:[function(t,P,R){var h=t("../main"),u=t("object-assign");function A(T){this.local=this.regionalOptions[T||""]||this.regionalOptions[""]}A.prototype=new h.baseCalendar,u(A.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(i){var e=this._validate(i,this.minMonth,this.minDay,h.local.invalidYear),i=e.year()+(e.year()<0?1:0);return i%4===3||i%4===-1},monthsInYear:function(T){return this._validate(T,this.minMonth,this.minDay,h.local.invalidYear||h.regionalOptions[""].invalidYear),13},weekOfYear:function(T,e,i){var n=this.newDate(T,e,i);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(T,e){var i=this._validate(T,e,this.minDay,h.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(i.month()===13&&this.leapYear(i.year())?1:0)},weekDay:function(T,e,i){return(this.dayOfWeek(T,e,i)||7)<6},toJD:function(T,e,i){var n=this._validate(T,e,i,h.local.invalidDate);return T=n.year(),T<0&&T++,n.day()+(n.month()-1)*30+(T-1)*365+Math.floor(T/4)+this.jdEpoch-1},fromJD:function(T){var e=Math.floor(T)+.5-this.jdEpoch,i=Math.floor((e-Math.floor((e+366)/1461))/365)+1;i<=0&&i--,e=Math.floor(T)+.5-this.newDate(i,1,1).toJD();var n=Math.floor(e/30)+1,a=e-(n-1)*30+1;return this.newDate(i,n,a)}}),h.calendars.coptic=A},{"../main":347,"object-assign":247}],335:[function(t,P,R){var h=t("../main"),u=t("object-assign");function A(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}A.prototype=new h.baseCalendar,u(A.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,h.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,h.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,h.local.invalidYear),400},weekOfYear:function(e,i,n){var a=this.newDate(e,i,n);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/8)+1},daysInMonth:function(e,i){var n=this._validate(e,i,this.minDay,h.local.invalidMonth);return this.daysPerMonth[n.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,i,n){var a=this._validate(e,i,n,h.local.invalidDate);return(a.day()+1)%8},weekDay:function(e,i,n){var a=this.dayOfWeek(e,i,n);return a>=2&&a<=6},extraInfo:function(e,i,n){var a=this._validate(e,i,n,h.local.invalidDate);return{century:T[Math.floor((a.year()-1)/100)+1]||""}},toJD:function(e,i,n){var a=this._validate(e,i,n,h.local.invalidDate);return e=a.year()+(a.year()<0?1:0),i=a.month(),n=a.day(),n+(i>1?16:0)+(i>2?(i-2)*32:0)+(e-1)*400+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var i=Math.floor(e/400)+1;e-=(i-1)*400,e+=e>15?16:0;var n=Math.floor(e/32)+1,a=e-(n-1)*32+1;return this.newDate(i<=0?i-1:i,n,a)}});var T={20:"Fruitbat",21:"Anchovy"};h.calendars.discworld=A},{"../main":347,"object-assign":247}],336:[function(t,P,R){var h=t("../main"),u=t("object-assign");function A(T){this.local=this.regionalOptions[T||""]||this.regionalOptions[""]}A.prototype=new h.baseCalendar,u(A.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(i){var e=this._validate(i,this.minMonth,this.minDay,h.local.invalidYear),i=e.year()+(e.year()<0?1:0);return i%4===3||i%4===-1},monthsInYear:function(T){return this._validate(T,this.minMonth,this.minDay,h.local.invalidYear||h.regionalOptions[""].invalidYear),13},weekOfYear:function(T,e,i){var n=this.newDate(T,e,i);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(T,e){var i=this._validate(T,e,this.minDay,h.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(i.month()===13&&this.leapYear(i.year())?1:0)},weekDay:function(T,e,i){return(this.dayOfWeek(T,e,i)||7)<6},toJD:function(T,e,i){var n=this._validate(T,e,i,h.local.invalidDate);return T=n.year(),T<0&&T++,n.day()+(n.month()-1)*30+(T-1)*365+Math.floor(T/4)+this.jdEpoch-1},fromJD:function(T){var e=Math.floor(T)+.5-this.jdEpoch,i=Math.floor((e-Math.floor((e+366)/1461))/365)+1;i<=0&&i--,e=Math.floor(T)+.5-this.newDate(i,1,1).toJD();var n=Math.floor(e/30)+1,a=e-(n-1)*30+1;return this.newDate(i,n,a)}}),h.calendars.ethiopian=A},{"../main":347,"object-assign":247}],337:[function(t,P,R){var h=t("../main"),u=t("object-assign");function A(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}A.prototype=new h.baseCalendar,u(A.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var i=this._validate(e,this.minMonth,this.minDay,h.local.invalidYear);return this._leapYear(i.year())},_leapYear:function(e){return e=e<0?e+1:e,T(e*7+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,h.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,i,n){var a=this.newDate(e,i,n);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){var i=this._validate(e,this.minMonth,this.minDay,h.local.invalidYear);return e=i.year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,i){return e.year&&(i=e.month(),e=e.year()),this._validate(e,i,this.minDay,h.local.invalidMonth),i===12&&this.leapYear(e)||i===8&&T(this.daysInYear(e),10)===5?30:i===9&&T(this.daysInYear(e),10)===3?29:this.daysPerMonth[i-1]},weekDay:function(e,i,n){return this.dayOfWeek(e,i,n)!==6},extraInfo:function(e,i,n){var a=this._validate(e,i,n,h.local.invalidDate);return{yearType:(this.leapYear(a)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(a)%10-3]}},toJD:function(e,i,n){var a=this._validate(e,i,n,h.local.invalidDate);e=a.year(),i=a.month(),n=a.day();var r=e<=0?e+1:e,f=this.jdEpoch+this._delay1(r)+this._delay2(r)+n+1;if(i<7){for(var o=7;o<=this.monthsInYear(e);o++)f+=this.daysInMonth(e,o);for(var o=1;o<i;o++)f+=this.daysInMonth(e,o)}else for(var o=7;o<i;o++)f+=this.daysInMonth(e,o);return f},_delay1:function(e){var i=Math.floor((235*e-234)/19),n=12084+13753*i,a=i*29+Math.floor(n/25920);return T(3*(a+1),7)<3&&a++,a},_delay2:function(e){var i=this._delay1(e-1),n=this._delay1(e),a=this._delay1(e+1);return a-n===356?2:n-i===382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var i=Math.floor((e-this.jdEpoch)*98496/35975351)-1;e>=this.toJD(i===-1?1:i+1,7,1);)i++;for(var n=e<this.toJD(i,1,1)?7:1;e>this.toJD(i,n,this.daysInMonth(i,n));)n++;var a=e-this.toJD(i,n,1)+1;return this.newDate(i,n,a)}});function T(e,i){return e-i*Math.floor(e/i)}h.calendars.hebrew=A},{"../main":347,"object-assign":247}],338:[function(t,P,R){var h=t("../main"),u=t("object-assign");function A(T){this.local=this.regionalOptions[T||""]||this.regionalOptions[""]}A.prototype=new h.baseCalendar,u(A.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(T){var e=this._validate(T,this.minMonth,this.minDay,h.local.invalidYear);return(e.year()*11+14)%30<11},weekOfYear:function(T,e,i){var n=this.newDate(T,e,i);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(T){return this.leapYear(T)?355:354},daysInMonth:function(T,e){var i=this._validate(T,e,this.minDay,h.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(i.month()===12&&this.leapYear(i.year())?1:0)},weekDay:function(T,e,i){return this.dayOfWeek(T,e,i)!==5},toJD:function(T,e,i){var n=this._validate(T,e,i,h.local.invalidDate);return T=n.year(),e=n.month(),i=n.day(),T=T<=0?T+1:T,i+Math.ceil(29.5*(e-1))+(T-1)*354+Math.floor((3+11*T)/30)+this.jdEpoch-1},fromJD:function(T){T=Math.floor(T)+.5;var e=Math.floor((30*(T-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var i=Math.min(12,Math.ceil((T-29-this.toJD(e,1,1))/29.5)+1),n=T-this.toJD(e,i,1)+1;return this.newDate(e,i,n)}}),h.calendars.islamic=A},{"../main":347,"object-assign":247}],339:[function(t,P,R){var h=t("../main"),u=t("object-assign");function A(T){this.local=this.regionalOptions[T||""]||this.regionalOptions[""]}A.prototype=new h.baseCalendar,u(A.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(i){var e=this._validate(i,this.minMonth,this.minDay,h.local.invalidYear),i=e.year()<0?e.year()+1:e.year();return i%4===0},weekOfYear:function(T,e,i){var n=this.newDate(T,e,i);return n.add(4-(n.dayOfWeek()||7),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(T,e){var i=this._validate(T,e,this.minDay,h.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(i.month()===2&&this.leapYear(i.year())?1:0)},weekDay:function(T,e,i){return(this.dayOfWeek(T,e,i)||7)<6},toJD:function(T,e,i){var n=this._validate(T,e,i,h.local.invalidDate);return T=n.year(),e=n.month(),i=n.day(),T<0&&T++,e<=2&&(T--,e+=12),Math.floor(365.25*(T+4716))+Math.floor(30.6001*(e+1))+i-1524.5},fromJD:function(T){var e=Math.floor(T+.5),i=e+1524,n=Math.floor((i-122.1)/365.25),a=Math.floor(365.25*n),r=Math.floor((i-a)/30.6001),f=r-Math.floor(r<14?1:13),o=n-Math.floor(f>2?4716:4715),s=i-a-Math.floor(30.6001*r);return o<=0&&o--,this.newDate(o,f,s)}}),h.calendars.julian=A},{"../main":347,"object-assign":247}],340:[function(t,P,R){var h=t("../main"),u=t("object-assign");function A(i){this.local=this.regionalOptions[i||""]||this.regionalOptions[""]}A.prototype=new h.baseCalendar,u(A.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(i){return this._validate(i,this.minMonth,this.minDay,h.local.invalidYear),!1},formatYear:function(i){var n=this._validate(i,this.minMonth,this.minDay,h.local.invalidYear);i=n.year();var a=Math.floor(i/400);i=i%400,i+=i<0?400:0;var r=Math.floor(i/20);return a+"."+r+"."+i%20},forYear:function(i){if(i=i.split("."),i.length<3)throw"Invalid Mayan year";for(var n=0,a=0;a<i.length;a++){var r=parseInt(i[a],10);if(Math.abs(r)>19||a>0&&r<0)throw"Invalid Mayan year";n=n*20+r}return n},monthsInYear:function(i){return this._validate(i,this.minMonth,this.minDay,h.local.invalidYear),18},weekOfYear:function(i,n,a){return this._validate(i,n,a,h.local.invalidDate),0},daysInYear:function(i){return this._validate(i,this.minMonth,this.minDay,h.local.invalidYear),360},daysInMonth:function(i,n){return this._validate(i,n,this.minDay,h.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(i,n,a){var r=this._validate(i,n,a,h.local.invalidDate);return r.day()},weekDay:function(i,n,a){return this._validate(i,n,a,h.local.invalidDate),!0},extraInfo:function(i,n,a){var r=this._validate(i,n,a,h.local.invalidDate),f=r.toJD(),o=this._toHaab(f),s=this._toTzolkin(f);return{haabMonthName:this.local.haabMonths[o[0]-1],haabMonth:o[0],haabDay:o[1],tzolkinDayName:this.local.tzolkinMonths[s[0]-1],tzolkinDay:s[0],tzolkinTrecena:s[1]}},_toHaab:function(i){i-=this.jdEpoch;var n=T(i+8+(18-1)*20,365);return[Math.floor(n/20)+1,T(n,20)]},_toTzolkin:function(i){return i-=this.jdEpoch,[e(i+20,20),e(i+4,13)]},toJD:function(i,n,a){var r=this._validate(i,n,a,h.local.invalidDate);return r.day()+r.month()*20+r.year()*360+this.jdEpoch},fromJD:function(i){i=Math.floor(i)+.5-this.jdEpoch;var n=Math.floor(i/360);i=i%360,i+=i<0?360:0;var a=Math.floor(i/20),r=i%20;return this.newDate(n,a,r)}});function T(i,n){return i-n*Math.floor(i/n)}function e(i,n){return T(i-1,n)+1}h.calendars.mayan=A},{"../main":347,"object-assign":247}],341:[function(t,P,R){var h=t("../main"),u=t("object-assign");function A(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}A.prototype=new h.baseCalendar;var T=h.instance("gregorian");u(A.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var i=this._validate(e,this.minMonth,this.minDay,h.local.invalidYear||h.regionalOptions[""].invalidYear);return T.leapYear(i.year()+(i.year()<1?1:0)+1469)},weekOfYear:function(e,i,n){var a=this.newDate(e,i,n);return a.add(1-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,i){var n=this._validate(e,i,this.minDay,h.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,i,n){return(this.dayOfWeek(e,i,n)||7)<6},toJD:function(r,i,n){var a=this._validate(r,i,n,h.local.invalidMonth),r=a.year();r<0&&r++;for(var f=a.day(),o=1;o<a.month();o++)f+=this.daysPerMonth[o-1];return f+T.toJD(r+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var i=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(i+1,1,1);)i++;for(var n=e-Math.floor(this.toJD(i,1,1)+.5)+1,a=1;n>this.daysInMonth(i,a);)n-=this.daysInMonth(i,a),a++;return this.newDate(i,a,n)}}),h.calendars.nanakshahi=A},{"../main":347,"object-assign":247}],342:[function(t,P,R){var h=t("../main"),u=t("object-assign");function A(T){this.local=this.regionalOptions[T||""]||this.regionalOptions[""]}A.prototype=new h.baseCalendar,u(A.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(T){return this.daysInYear(T)!==this.daysPerYear},weekOfYear:function(T,e,i){var n=this.newDate(T,e,i);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(T){var e=this._validate(T,this.minMonth,this.minDay,h.local.invalidYear);if(T=e.year(),typeof this.NEPALI_CALENDAR_DATA[T]>"u")return this.daysPerYear;for(var i=0,n=this.minMonth;n<=12;n++)i+=this.NEPALI_CALENDAR_DATA[T][n];return i},daysInMonth:function(T,e){return T.year&&(e=T.month(),T=T.year()),this._validate(T,e,this.minDay,h.local.invalidMonth),typeof this.NEPALI_CALENDAR_DATA[T]>"u"?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[T][e]},weekDay:function(T,e,i){return this.dayOfWeek(T,e,i)!==6},toJD:function(T,e,i){var n=this._validate(T,e,i,h.local.invalidDate);T=n.year(),e=n.month(),i=n.day();var a=h.instance(),r=0,f=e,o=T;this._createMissingCalendarData(T);var s=T-(f>9||f===9&&i>=this.NEPALI_CALENDAR_DATA[o][0]?56:57);for(e!==9&&(r=i,f--);f!==9;)f<=0&&(f=12,o--),r+=this.NEPALI_CALENDAR_DATA[o][f],f--;return e===9?(r+=i-this.NEPALI_CALENDAR_DATA[o][0],r<0&&(r+=a.daysInYear(s))):r+=this.NEPALI_CALENDAR_DATA[o][9]-this.NEPALI_CALENDAR_DATA[o][0],a.newDate(s,1,1).add(r,"d").toJD()},fromJD:function(T){var e=h.instance(),i=e.fromJD(T),n=i.year(),a=i.dayOfYear(),r=n+56;this._createMissingCalendarData(r);for(var f=9,o=this.NEPALI_CALENDAR_DATA[r][0],s=this.NEPALI_CALENDAR_DATA[r][f]-o+1;a>s;)f++,f>12&&(f=1,r++),s+=this.NEPALI_CALENDAR_DATA[r][f];var m=this.NEPALI_CALENDAR_DATA[r][f]-(s-a);return this.newDate(r,f,m)},_createMissingCalendarData:function(T){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var i=T-1;i<T+2;i++)typeof this.NEPALI_CALENDAR_DATA[i]>"u"&&(this.NEPALI_CALENDAR_DATA[i]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),h.calendars.nepali=A},{"../main":347,"object-assign":247}],343:[function(t,P,R){var h=t("../main"),u=t("object-assign");function A(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}A.prototype=new h.baseCalendar,u(A.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var i=this._validate(e,this.minMonth,this.minDay,h.local.invalidYear);return((i.year()-(i.year()>0?474:473))%2820+474+38)*682%2816<682},weekOfYear:function(e,i,n){var a=this.newDate(e,i,n);return a.add(-((a.dayOfWeek()+1)%7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,i){var n=this._validate(e,i,this.minDay,h.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,i,n){return this.dayOfWeek(e,i,n)!==5},toJD:function(e,i,n){var a=this._validate(e,i,n,h.local.invalidDate);e=a.year(),i=a.month(),n=a.day();var r=e-(e>=0?474:473),f=474+T(r,2820);return n+(i<=7?(i-1)*31:(i-1)*30+6)+Math.floor((f*682-110)/2816)+(f-1)*365+Math.floor(r/2820)*1029983+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e)+.5;var i=e-this.toJD(475,1,1),n=Math.floor(i/1029983),a=T(i,1029983),r=2820;if(a!==1029982){var f=Math.floor(a/366),o=T(a,366);r=Math.floor((2134*f+2816*o+2815)/1028522)+f+1}var s=r+2820*n+474;s=s<=0?s-1:s;var m=e-this.toJD(s,1,1)+1,g=m<=186?Math.ceil(m/31):Math.ceil((m-6)/30),p=e-this.toJD(s,g,1)+1;return this.newDate(s,g,p)}});function T(e,i){return e-i*Math.floor(e/i)}h.calendars.persian=A,h.calendars.jalali=A},{"../main":347,"object-assign":247}],344:[function(t,P,R){var h=t("../main"),u=t("object-assign"),A=h.instance();function T(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}T.prototype=new h.baseCalendar,u(T.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(n){var i=this._validate(n,this.minMonth,this.minDay,h.local.invalidYear),n=this._t2gYear(i.year());return A.leapYear(n)},weekOfYear:function(r,i,n){var a=this._validate(r,this.minMonth,this.minDay,h.local.invalidYear),r=this._t2gYear(a.year());return A.weekOfYear(r,a.month(),a.day())},daysInMonth:function(e,i){var n=this._validate(e,i,this.minDay,h.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,i,n){return(this.dayOfWeek(e,i,n)||7)<6},toJD:function(r,i,n){var a=this._validate(r,i,n,h.local.invalidDate),r=this._t2gYear(a.year());return A.toJD(r,a.month(),a.day())},fromJD:function(e){var i=A.fromJD(e),n=this._g2tYear(i.year());return this.newDate(n,i.month(),i.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),h.calendars.taiwan=T},{"../main":347,"object-assign":247}],345:[function(t,P,R){var h=t("../main"),u=t("object-assign"),A=h.instance();function T(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}T.prototype=new h.baseCalendar,u(T.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(n){var i=this._validate(n,this.minMonth,this.minDay,h.local.invalidYear),n=this._t2gYear(i.year());return A.leapYear(n)},weekOfYear:function(r,i,n){var a=this._validate(r,this.minMonth,this.minDay,h.local.invalidYear),r=this._t2gYear(a.year());return A.weekOfYear(r,a.month(),a.day())},daysInMonth:function(e,i){var n=this._validate(e,i,this.minDay,h.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,i,n){return(this.dayOfWeek(e,i,n)||7)<6},toJD:function(r,i,n){var a=this._validate(r,i,n,h.local.invalidDate),r=this._t2gYear(a.year());return A.toJD(r,a.month(),a.day())},fromJD:function(e){var i=A.fromJD(e),n=this._g2tYear(i.year());return this.newDate(n,i.month(),i.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),h.calendars.thai=T},{"../main":347,"object-assign":247}],346:[function(t,P,R){var h=t("../main"),u=t("object-assign");function A(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}A.prototype=new h.baseCalendar,u(A.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var i=this._validate(e,this.minMonth,this.minDay,h.local.invalidYear);return this.daysInYear(i.year())===355},weekOfYear:function(e,i,n){var a=this.newDate(e,i,n);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var i=0,n=1;n<=12;n++)i+=this.daysInMonth(e,n);return i},daysInMonth:function(e,i){for(var n=this._validate(e,i,this.minDay,h.local.invalidMonth),a=n.toJD()-24e5+.5,r=0,f=0;f<T.length;f++){if(T[f]>a)return T[r]-T[r-1];r++}return 30},weekDay:function(e,i,n){return this.dayOfWeek(e,i,n)!==5},toJD:function(e,i,n){var a=this._validate(e,i,n,h.local.invalidDate),r=12*(a.year()-1)+a.month()-15292,f=a.day()+T[r-1]-1;return f+24e5-.5},fromJD:function(e){for(var i=e-24e5+.5,n=0,a=0;a<T.length&&!(T[a]>i);a++)n++;var r=n+15292,f=Math.floor((r-1)/12),o=f+1,s=r-12*f,m=i-T[n-1]+1;return this.newDate(o,s,m)},isValid:function(e,i,n){var a=h.baseCalendar.prototype.isValid.apply(this,arguments);return a&&(e=e.year!=null?e.year:e,a=e>=1276&&e<=1500),a},_validate:function(e,i,n,a){var r=h.baseCalendar.prototype._validate.apply(this,arguments);if(r.year<1276||r.year>1500)throw a.replace(/\{0\}/,this.local.name);return r}}),h.calendars.ummalqura=A;var T=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":347,"object-assign":247}],347:[function(t,P,R){var h=t("object-assign");function u(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}h(u.prototype,{instance:function(a,r){a=(a||"gregorian").toLowerCase(),r=r||"";var f=this._localCals[a+"-"+r];if(!f&&this.calendars[a]&&(f=new this.calendars[a](r),this._localCals[a+"-"+r]=f),!f)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,a);return f},newDate:function(a,r,f,o,s){return o=(a!=null&&a.year?a.calendar():typeof o=="string"?this.instance(o,s):o)||this.instance(),o.newDate(a,r,f)},substituteDigits:function(a){return function(r){return(r+"").replace(/[0-9]/g,function(f){return a[f]})}},substituteChineseDigits:function(a,r){return function(f){for(var o="",s=0;f>0;){var m=f%10;o=(m===0?"":a[m]+r[s])+o,s++,f=Math.floor(f/10)}return o.indexOf(a[1]+r[1])===0&&(o=o.substr(1)),o||a[0]}}});function A(a,r,f,o){if(this._calendar=a,this._year=r,this._month=f,this._day=o,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function T(a,r){return a=""+a,"000000".substring(0,r-a.length)+a}h(A.prototype,{newDate:function(a,r,f){return this._calendar.newDate(a==null?this:a,r,f)},year:function(a){return arguments.length===0?this._year:this.set(a,"y")},month:function(a){return arguments.length===0?this._month:this.set(a,"m")},day:function(a){return arguments.length===0?this._day:this.set(a,"d")},date:function(a,r,f){if(!this._calendar.isValid(a,r,f))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=a,this._month=r,this._day=f,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(a,r){return this._calendar.add(this,a,r)},set:function(a,r){return this._calendar.set(this,a,r)},compareTo:function(a){if(this._calendar.name!==a._calendar.name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,a._calendar.local.name);var r=this._year!==a._year?this._year-a._year:this._month!==a._month?this.monthOfYear()-a.monthOfYear():this._day-a._day;return r===0?0:r<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(a){return this._calendar.fromJD(a)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(a){return this._calendar.fromJSDate(a)},toString:function(){return(this.year()<0?"-":"")+T(Math.abs(this.year()),4)+"-"+T(this.month(),2)+"-"+T(this.day(),2)}});function e(){this.shortYearCutoff="+10"}h(e.prototype,{_validateLevel:0,newDate:function(a,r,f){return a==null?this.today():(a.year&&(this._validate(a,r,f,n.local.invalidDate||n.regionalOptions[""].invalidDate),f=a.day(),r=a.month(),a=a.year()),new A(this,a,r,f))},today:function(){return this.fromJSDate(new Date)},epoch:function(a){var r=this._validate(a,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return r.year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(a){var r=this._validate(a,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return(r.year()<0?"-":"")+T(Math.abs(r.year()),4)},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear),12},monthOfYear:function(a,r){var f=this._validate(a,r,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return(f.month()+this.monthsInYear(f)-this.firstMonth)%this.monthsInYear(f)+this.minMonth},fromMonthOfYear:function(a,r){var f=(r+this.firstMonth-2*this.minMonth)%this.monthsInYear(a)+this.minMonth;return this._validate(a,f,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth),f},daysInYear:function(a){var r=this._validate(a,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return this.leapYear(r)?366:365},dayOfYear:function(a,r,f){var o=this._validate(a,r,f,n.local.invalidDate||n.regionalOptions[""].invalidDate);return o.toJD()-this.newDate(o.year(),this.fromMonthOfYear(o.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(a,r,f){var o=this._validate(a,r,f,n.local.invalidDate||n.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(o))+2)%this.daysInWeek()},extraInfo:function(a,r,f){return this._validate(a,r,f,n.local.invalidDate||n.regionalOptions[""].invalidDate),{}},add:function(a,r,f){return this._validate(a,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate),this._correctAdd(a,this._add(a,r,f),r,f)},_add:function(a,r,f){if(this._validateLevel++,f==="d"||f==="w"){var o=a.toJD()+r*(f==="w"?this.daysInWeek():1),s=a.calendar().fromJD(o);return this._validateLevel--,[s.year(),s.month(),s.day()]}try{var m=a.year()+(f==="y"?r:0),g=a.monthOfYear()+(f==="m"?r:0),s=a.day(),p=function(l){for(;g<l.minMonth;)m--,g+=l.monthsInYear(m);for(var b=l.monthsInYear(m);g>b-1+l.minMonth;)m++,g-=b,b=l.monthsInYear(m)};f==="y"?(a.month()!==this.fromMonthOfYear(m,g)&&(g=this.newDate(m,a.month(),this.minDay).monthOfYear()),g=Math.min(g,this.monthsInYear(m)),s=Math.min(s,this.daysInMonth(m,this.fromMonthOfYear(m,g)))):f==="m"&&(p(this),s=Math.min(s,this.daysInMonth(m,this.fromMonthOfYear(m,g))));var v=[m,this.fromMonthOfYear(m,g),s];return this._validateLevel--,v}catch(x){throw this._validateLevel--,x}},_correctAdd:function(a,r,f,o){if(!this.hasYearZero&&(o==="y"||o==="m")&&(r[0]===0||a.year()>0!=r[0]>0)){var s={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[o],m=f<0?-1:1;r=this._add(a,f*s[0]+m*s[1],s[2])}return a.date(r[0],r[1],r[2])},set:function(a,r,f){this._validate(a,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate);var o=f==="y"?r:a.year(),s=f==="m"?r:a.month(),m=f==="d"?r:a.day();return(f==="y"||f==="m")&&(m=Math.min(m,this.daysInMonth(o,s))),a.date(o,s,m)},isValid:function(a,r,f){this._validateLevel++;var o=this.hasYearZero||a!==0;if(o){var s=this.newDate(a,r,this.minDay);o=r>=this.minMonth&&r-this.minMonth<this.monthsInYear(s)&&f>=this.minDay&&f-this.minDay<this.daysInMonth(s)}return this._validateLevel--,o},toJSDate:function(a,r,f){var o=this._validate(a,r,f,n.local.invalidDate||n.regionalOptions[""].invalidDate);return n.instance().fromJD(this.toJD(o)).toJSDate()},fromJSDate:function(a){return this.fromJD(n.instance().fromJSDate(a).toJD())},_validate:function(a,r,f,o){if(a.year){if(this._validateLevel===0&&this.name!==a.calendar().name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,a.calendar().local.name);return a}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(a,r,f))throw o.replace(/\{0\}/,this.local.name);var s=this.newDate(a,r,f);return this._validateLevel--,s}catch(m){throw this._validateLevel--,m}}});function i(a){this.local=this.regionalOptions[a]||this.regionalOptions[""]}i.prototype=new e,h(i.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(f){var r=this._validate(f,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear),f=r.year()+(r.year()<0?1:0);return f%4===0&&(f%100!==0||f%400===0)},weekOfYear:function(a,r,f){var o=this.newDate(a,r,f);return o.add(4-(o.dayOfWeek()||7),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInMonth:function(a,r){var f=this._validate(a,r,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===2&&this.leapYear(f.year())?1:0)},weekDay:function(a,r,f){return(this.dayOfWeek(a,r,f)||7)<6},toJD:function(a,r,f){var o=this._validate(a,r,f,n.local.invalidDate||n.regionalOptions[""].invalidDate);a=o.year(),r=o.month(),f=o.day(),a<0&&a++,r<3&&(r+=12,a--);var s=Math.floor(a/100),m=2-s+Math.floor(s/4);return Math.floor(365.25*(a+4716))+Math.floor(30.6001*(r+1))+f+m-1524.5},fromJD:function(a){var r=Math.floor(a+.5),f=Math.floor((r-186721625e-2)/36524.25);f=r+1+f-Math.floor(f/4);var o=f+1524,s=Math.floor((o-122.1)/365.25),m=Math.floor(365.25*s),g=Math.floor((o-m)/30.6001),p=o-m-Math.floor(g*30.6001),v=g-(g>13.5?13:1),x=s-(v>2.5?4716:4715);return x<=0&&x--,this.newDate(x,v,p)},toJSDate:function(a,r,f){var o=this._validate(a,r,f,n.local.invalidDate||n.regionalOptions[""].invalidDate),s=new Date(o.year(),o.month()-1,o.day());return s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0),s.setHours(s.getHours()>12?s.getHours()+2:0),s},fromJSDate:function(a){return this.newDate(a.getFullYear(),a.getMonth()+1,a.getDate())}});var n=P.exports=new u;n.cdate=A,n.baseCalendar=e,n.calendars.gregorian=i},{"object-assign":247}],348:[function(t,P,R){var h=t("object-assign"),u=t("./main");h(u.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),u.local=u.regionalOptions[""],h(u.cdate.prototype,{formatDate:function(A,T){return typeof A!="string"&&(T=A,A=""),this._calendar.formatDate(A||"",this,T)}}),h(u.baseCalendar.prototype,{UNIX_EPOCH:u.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:24*60*60,TICKS_EPOCH:u.instance().jdEpoch,TICKS_PER_DAY:24*60*60*1e7,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(A,T,e){if(typeof A!="string"&&(e=T,T=A,A=""),!T)return"";if(T.calendar()!==this)throw u.local.invalidFormat||u.regionalOptions[""].invalidFormat;A=A||this.local.dateFormat,e=e||{};var i=e.dayNamesShort||this.local.dayNamesShort,n=e.dayNames||this.local.dayNames,a=e.monthNumbers||this.local.monthNumbers,r=e.monthNamesShort||this.local.monthNamesShort,f=e.monthNames||this.local.monthNames;e.calculateWeek||this.local.calculateWeek;for(var o=function(_,y){for(var w=1;M+w<A.length&&A.charAt(M+w)===_;)w++;return M+=w-1,Math.floor(w/(y||1))>1},s=function(_,y,w,d){var C=""+y;if(o(_,d))for(;C.length<w;)C="0"+C;return C},m=function(_,y,w,d){return o(_)?d[y]:w[y]},g=this,p=function(_){return typeof a=="function"?a.call(g,_,o("m")):l(s("m",_.month(),2))},v=function(_,y){return y?typeof f=="function"?f.call(g,_):f[_.month()-g.minMonth]:typeof r=="function"?r.call(g,_):r[_.month()-g.minMonth]},x=this.local.digits,l=function(_){return e.localNumbers&&x?x(_):_},b="",c=!1,M=0;M<A.length;M++)if(c)A.charAt(M)==="'"&&!o("'")?c=!1:b+=A.charAt(M);else switch(A.charAt(M)){case"d":b+=l(s("d",T.day(),2));break;case"D":b+=m("D",T.dayOfWeek(),i,n);break;case"o":b+=s("o",T.dayOfYear(),3);break;case"w":b+=s("w",T.weekOfYear(),2);break;case"m":b+=p(T);break;case"M":b+=v(T,o("M"));break;case"y":b+=o("y",2)?T.year():(T.year()%100<10?"0":"")+T.year()%100;break;case"Y":o("Y",2),b+=T.formatYear();break;case"J":b+=T.toJD();break;case"@":b+=(T.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":b+=(T.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":o("'")?b+="'":c=!0;break;default:b+=A.charAt(M)}return b},parseDate:function(A,T,e){if(T==null)throw u.local.invalidArguments||u.regionalOptions[""].invalidArguments;if(T=typeof T=="object"?T.toString():T+"",T==="")return null;A=A||this.local.dateFormat,e=e||{};var i=e.shortYearCutoff||this.shortYearCutoff;i=typeof i!="string"?i:this.today().year()%100+parseInt(i,10);for(var n=e.dayNamesShort||this.local.dayNamesShort,a=e.dayNames||this.local.dayNames,r=e.parseMonth||this.local.parseMonth,f=e.monthNumbers||this.local.monthNumbers,o=e.monthNamesShort||this.local.monthNamesShort,s=e.monthNames||this.local.monthNames,m=-1,g=-1,p=-1,v=-1,x=-1,l=!1,b=!1,c=function(z,F){for(var I=1;E+I<A.length&&A.charAt(E+I)===z;)I++;return E+=I-1,Math.floor(I/(F||1))>1},M=function(z,F){var I=c(z,F),O=[2,3,I?4:2,I?4:2,10,11,20]["oyYJ@!".indexOf(z)+1],N=new RegExp("^-?\\d{1,"+O+"}"),V=T.substring(S).match(N);if(!V)throw(u.local.missingNumberAt||u.regionalOptions[""].missingNumberAt).replace(/\{0\}/,S);return S+=V[0].length,parseInt(V[0],10)},_=this,y=function(){if(typeof f=="function"){c("m");var z=f.call(_,T.substring(S));return S+=z.length,z}return M("m")},w=function(z,F,I,O){for(var N=c(z,O)?I:F,V=0;V<N.length;V++)if(T.substr(S,N[V].length).toLowerCase()===N[V].toLowerCase())return S+=N[V].length,V+_.minMonth;throw(u.local.unknownNameAt||u.regionalOptions[""].unknownNameAt).replace(/\{0\}/,S)},d=function(){if(typeof s=="function"){var z=c("M")?s.call(_,T.substring(S)):o.call(_,T.substring(S));return S+=z.length,z}return w("M",o,s)},C=function(){if(T.charAt(S)!==A.charAt(E))throw(u.local.unexpectedLiteralAt||u.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,S);S++},S=0,E=0;E<A.length;E++)if(b)A.charAt(E)==="'"&&!c("'")?b=!1:C();else switch(A.charAt(E)){case"d":v=M("d");break;case"D":w("D",n,a);break;case"o":x=M("o");break;case"w":M("w");break;case"m":p=y();break;case"M":p=d();break;case"y":var k=E;l=!c("y",2),E=k,g=M("y",2);break;case"Y":g=M("Y",2);break;case"J":m=M("J")+.5,T.charAt(S)==="."&&(S++,M("J"));break;case"@":m=M("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":m=M("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":S=T.length;break;case"'":c("'")?C():b=!0;break;default:C()}if(S<T.length)throw u.local.unexpectedText||u.regionalOptions[""].unexpectedText;if(g===-1?g=this.today().year():g<100&&l&&(g+=i===-1?1900:this.today().year()-this.today().year()%100-(g<=i?0:100)),typeof p=="string"&&(p=r.call(this,g,p)),x>-1){p=1,v=x;for(var B=this.daysInMonth(g,p);v>B;B=this.daysInMonth(g,p))p++,v-=B}return m>-1?this.fromJD(m):this.newDate(g,p,v)},determineDate:function(A,T,e,i,n){e&&typeof e!="object"&&(n=i,i=e,e=null),typeof i!="string"&&(n=i,i="");var a=this,r=function(f){try{return a.parseDate(i,f,n)}catch{}f=f.toLowerCase();for(var o=(f.match(/^c/)&&e?e.newDate():null)||a.today(),s=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,m=s.exec(f);m;)o.add(parseInt(m[1],10),m[2]||"d"),m=s.exec(f);return o};return T=T?T.newDate():null,A=A==null?T:typeof A=="string"?r(A):typeof A=="number"?isNaN(A)||A===1/0||A===-1/0?T:a.today().add(A,"d"):a.newDate(A),A}})},{"./main":347,"object-assign":247}],349:[function(t,P,R){P.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],350:[function(t,P,R){var h=t("./arrow_paths"),u=t("../../plots/font_attributes"),A=t("../../plots/cartesian/constants"),T=t("../../plot_api/plot_template").templatedArray;t("../../constants/axis_placeable_objects"),P.exports=T("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:u({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:h.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:h.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",A.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",A.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",A.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",A.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:u({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/font_attributes":594,"./arrow_paths":349}],351:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axes"),A=t("./draw").draw;P.exports=function(n){var a=n._fullLayout,r=h.filterVisible(a.annotations);if(r.length&&n._fullData.length)return h.syncOrAsync([A,T],n)};function T(i){var n=i._fullLayout;h.filterVisible(n.annotations).forEach(function(a){var r=u.getFromId(i,a.xref),f=u.getFromId(i,a.yref),o=u.getRefType(a.xref),s=u.getRefType(a.yref);a._extremes={},o==="range"&&e(a,r),s==="range"&&e(a,f)})}function e(i,n){var a=n._id,r=a.charAt(0),f=i[r],o=i["a"+r],s=i[r+"ref"],m=i["a"+r+"ref"],g=i["_"+r+"padplus"],p=i["_"+r+"padminus"],v={x:1,y:-1}[r]*i[r+"shift"],x=3*i.arrowsize*i.arrowwidth||0,l=x+v,b=x-v,c=3*i.startarrowsize*i.arrowwidth||0,M=c+v,_=c-v,y;if(m===s){var w=u.findExtremes(n,[n.r2c(f)],{ppadplus:l,ppadminus:b}),d=u.findExtremes(n,[n.r2c(o)],{ppadplus:Math.max(g,M),ppadminus:Math.max(p,_)});y={min:[w.min[0],d.min[0]],max:[w.max[0],d.max[0]]}}else M=o?M+o:M,_=o?_-o:_,y=u.findExtremes(n,[n.r2c(f)],{ppadplus:Math.max(g,l,M),ppadminus:Math.max(p,b,_)});i._extremes[a]=y}},{"../../lib":515,"../../plots/cartesian/axes":566,"./draw":356}],352:[function(t,P,R){var h=t("../../lib"),u=t("../../registry"),A=t("../../plot_api/plot_template").arrayEditor;P.exports={hasClickToShow:T,onClick:e};function T(a,r){var f=i(a,r);return f.on.length>0||f.explicitOff.length>0}function e(a,r){var f=i(a,r),o=f.on,s=f.off.concat(f.explicitOff),m={},g=a._fullLayout.annotations,p,v;if(!!(o.length||s.length)){for(p=0;p<o.length;p++)v=A(a.layout,"annotations",g[o[p]]),v.modifyItem("visible",!0),h.extendFlat(m,v.getUpdateObj());for(p=0;p<s.length;p++)v=A(a.layout,"annotations",g[s[p]]),v.modifyItem("visible",!1),h.extendFlat(m,v.getUpdateObj());return u.call("update",a,{},m)}}function i(a,r){var f=a._fullLayout.annotations,o=[],s=[],m=[],g=(r||[]).length,p,v,x,l,b,c,M,_;for(p=0;p<f.length;p++)if(x=f[p],l=x.clicktoshow,l){for(v=0;v<g;v++)if(b=r[v],c=b.xaxis,M=b.yaxis,c._id===x.xref&&M._id===x.yref&&c.d2r(b.x)===n(x._xclick,c)&&M.d2r(b.y)===n(x._yclick,M)){x.visible?l==="onout"?_=s:_=m:_=o,_.push(p);break}v===g&&x.visible&&l==="onout"&&s.push(p)}return{on:o,off:s,explicitOff:m}}function n(a,r){return r.type==="log"?r.l2r(a):r.d2r(a)}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647}],353:[function(t,P,R){var h=t("../../lib"),u=t("../color");P.exports=function(T,e,i,n){n("opacity");var a=n("bgcolor"),r=n("bordercolor"),f=u.opacity(r);n("borderpad");var o=n("borderwidth"),s=n("showarrow");n("text",s?" ":i._dfltTitle.annotation),n("textangle"),h.coerceFont(n,"font",i.font),n("width"),n("align");var m=n("height");if(m&&n("valign"),s){var g=n("arrowside"),p,v;g.indexOf("end")!==-1&&(p=n("arrowhead"),v=n("arrowsize")),g.indexOf("start")!==-1&&(n("startarrowhead",p),n("startarrowsize",v)),n("arrowcolor",f?e.bordercolor:u.defaultLine),n("arrowwidth",(f&&o||1)*2),n("standoff"),n("startstandoff")}var x=n("hovertext"),l=i.hoverlabel||{};if(x){var b=n("hoverlabel.bgcolor",l.bgcolor||(u.opacity(a)?u.rgb(a):u.defaultLine)),c=n("hoverlabel.bordercolor",l.bordercolor||u.contrast(b));h.coerceFont(n,"hoverlabel.font",{family:l.font.family,size:l.font.size,color:l.font.color||c})}n("captureevents",!!x)}},{"../../lib":515,"../color":367}],354:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib/to_log_range");P.exports=function(T,e,i,n){e=e||{};var a=i==="log"&&e.type==="linear",r=i==="linear"&&e.type==="log";if(!(a||r))return;var f=T._fullLayout.annotations,o=e._id.charAt(0),s,m;function g(v){var x=s[v],l=null;a?l=u(x,e.range):l=Math.pow(10,x),h(l)||(l=null),n(m+v,l)}for(var p=0;p<f.length;p++)s=f[p],m="annotations["+p+"].",s[o+"ref"]===e._id&&g(o),s["a"+o+"ref"]===e._id&&g("a"+o)}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],355:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axes"),A=t("../../plots/array_container_defaults"),T=t("./common_defaults"),e=t("./attributes");P.exports=function(a,r){A(a,r,{name:"annotations",handleItemDefaults:i})};function i(n,a,r){function f(C,S){return h.coerce(n,a,e,C,S)}var o=f("visible"),s=f("clicktoshow");if(!!(o||s)){T(n,a,r,f);for(var m=a.showarrow,g=["x","y"],p=[-10,-30],v={_fullLayout:r},x=0;x<2;x++){var l=g[x],b=u.coerceRef(n,a,v,l,"","paper");if(b!=="paper"){var c=u.getFromId(v,b);c._annIndices.push(a._index)}if(u.coercePosition(a,v,f,b,l,.5),m){var M="a"+l,_=u.coerceRef(n,a,v,M,"pixel",["pixel","paper"]);_!=="pixel"&&_!==b&&(_=a[M]="pixel");var y=_==="pixel"?p[x]:.4;u.coercePosition(a,v,f,_,M,y)}f(l+"anchor"),f(l+"shift")}if(h.noneOrAll(n,a,["x","y"]),m&&h.noneOrAll(n,a,["ax","ay"]),s){var w=f("xclick"),d=f("yclick");a._xclick=w===void 0?a.x:u.cleanPosition(w,v,a.xref),a._yclick=d===void 0?a.y:u.cleanPosition(d,v,a.yref)}}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":350,"./common_defaults":353}],356:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../registry"),A=t("../../plots/plots"),T=t("../../lib"),e=T.strTranslate,i=t("../../plots/cartesian/axes"),n=t("../color"),a=t("../drawing"),r=t("../fx"),f=t("../../lib/svg_text_utils"),o=t("../../lib/setcursor"),s=t("../dragelement"),m=t("../../plot_api/plot_template").arrayEditor,g=t("./draw_arrow_head");P.exports={draw:p,drawOne:v,drawRaw:l};function p(b){var c=b._fullLayout;c._infolayer.selectAll(".annotation").remove();for(var M=0;M<c.annotations.length;M++)c.annotations[M].visible&&v(b,M);return A.previousPromises(b)}function v(b,c){var M=b._fullLayout,_=M.annotations[c]||{},y=i.getFromId(b,_.xref),w=i.getFromId(b,_.yref);y&&y.setScale(),w&&w.setScale(),l(b,_,c,!1,y,w)}function x(b,c,M,_,y){var w=y[M],d=y[M+"ref"],C=M.indexOf("y")!==-1,S=i.getRefType(d)==="domain",E=C?_.h:_.w;return b?S?w+(C?-c:c)/b._length:b.p2r(b.r2p(w)+c):w+(C?-c:c)/E}function l(b,c,M,_,y,w){var d=b._fullLayout,C=b._fullLayout._size,S=b._context.edits,E,k;_?(E="annotation-"+_,k=_+".annotations"):(E="annotation",k="annotations");var B=m(b.layout,k,c),z=B.modifyBase,F=B.modifyItem,I=B.getUpdateObj;d._infolayer.selectAll("."+E+'[data-index="'+M+'"]').remove();var O="clip"+d._uid+"_ann"+M;if(!c._input||c.visible===!1){h.selectAll("#"+O).remove();return}var N={x:{},y:{}},V=+c.textangle||0,H=d._infolayer.append("g").classed(E,!0).attr("data-index",String(M)).style("opacity",c.opacity),j=H.append("g").classed("annotation-text-g",!0),Z=S[c.showarrow?"annotationTail":"annotationPosition"],X=c.captureevents||S.annotationText||Z;function re(se){var xe={index:M,annotation:c._input,fullAnnotation:c,event:se};return _&&(xe.subplotId=_),xe}var ue=j.append("g").style("pointer-events",X?"all":null).call(o,"pointer").on("click",function(){b._dragging=!1,b.emit("plotly_clickannotation",re(h.event))});c.hovertext&&ue.on("mouseover",function(){var se=c.hoverlabel,xe=se.font,oe=this.getBoundingClientRect(),he=b.getBoundingClientRect();r.loneHover({x0:oe.left-he.left,x1:oe.right-he.left,y:(oe.top+oe.bottom)/2-he.top,text:c.hovertext,color:se.bgcolor,borderColor:se.bordercolor,fontFamily:xe.family,fontSize:xe.size,fontColor:xe.color},{container:d._hoverlayer.node(),outerContainer:d._paper.node(),gd:b})}).on("mouseout",function(){r.loneUnhover(d._hoverlayer.node())});var K=c.borderwidth,te=c.borderpad,G=K+te,Y=ue.append("rect").attr("class","bg").style("stroke-width",K+"px").call(n.stroke,c.bordercolor).call(n.fill,c.bgcolor),ee=c.width||c.height,ne=d._topclips.selectAll("#"+O).data(ee?[0]:[]);ne.enter().append("clipPath").classed("annclip",!0).attr("id",O).append("rect"),ne.exit().remove();var J=c.font,q=d._meta?T.templateString(c.text,d._meta):c.text,ae=ue.append("text").classed("annotation-text",!0).text(q);function le(se){return se.call(a.font,J).attr({"text-anchor":{left:"start",right:"end"}[c.align]||"middle"}),f.convertToTspans(se,b,ie),se}function ie(){var se=ae.selectAll("a");if(se.size()===1&&se.text()===ae.text()){var xe=ue.insert("a",":first-child").attr({"xlink:xlink:href":se.attr("xlink:href"),"xlink:xlink:show":se.attr("xlink:show")}).style({cursor:"pointer"});xe.node().appendChild(Y.node())}var oe=ue.select(".annotation-text-math-group"),he=!oe.empty(),be=a.bBox((he?oe:ae).node()),me=be.width,_e=be.height,Se=c.width||me,De=c.height||_e,Ie=Math.round(Se+2*G),Te=Math.round(De+2*G);function Ce(er,Kt){return Kt==="auto"&&(er<1/3?Kt="left":er>2/3?Kt="right":Kt="center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[Kt]}for(var He=!1,Xe=["x","y"],Be=0;Be<Xe.length;Be++){var Re=Xe[Be],We=c[Re+"ref"]||Re,vt=c["a"+Re+"ref"],Pt={x:y,y:w}[Re],Zt=(V+(Re==="x"?0:-90))*Math.PI/180,zt=Ie*Math.cos(Zt),At=Te*Math.sin(Zt),Wt=Math.abs(zt)+Math.abs(At),Bt=c[Re+"anchor"],Ct=c[Re+"shift"]*(Re==="x"?1:-1),Ze=N[Re],nt,Ye,Ee,Ge,Je,qe=i.getRefType(We);if(Pt&&qe!=="domain"){var Tt=Pt.r2fraction(c[Re]);(Tt<0||Tt>1)&&(vt===We?(Tt=Pt.r2fraction(c["a"+Re]),(Tt<0||Tt>1)&&(He=!0)):He=!0),nt=Pt._offset+Pt.r2p(c[Re]),Ge=.5}else{var mt=qe==="domain";Re==="x"?(Ee=c[Re],nt=mt?Pt._offset+Pt._length*Ee:nt=C.l+C.w*Ee):(Ee=1-c[Re],nt=mt?Pt._offset+Pt._length*Ee:nt=C.t+C.h*Ee),Ge=c.showarrow?.5:Ee}if(c.showarrow){Ze.head=nt;var Mt=c["a"+Re];if(Je=zt*Ce(.5,c.xanchor)-At*Ce(.5,c.yanchor),vt===We){var Ht=i.getRefType(vt);Ht==="domain"?(Re==="y"&&(Mt=1-Mt),Ze.tail=Pt._offset+Pt._length*Mt):Ht==="paper"?Re==="y"?(Mt=1-Mt,Ze.tail=C.t+C.h*Mt):Ze.tail=C.l+C.w*Mt:Ze.tail=Pt._offset+Pt.r2p(Mt),Ye=Je}else Ze.tail=nt+Mt,Ye=Je+Mt;Ze.text=Ze.tail+Je;var Rt=d[Re==="x"?"width":"height"];if(We==="paper"&&(Ze.head=T.constrain(Ze.head,1,Rt-1)),vt==="pixel"){var Vt=-Math.max(Ze.tail-3,Ze.text),Jt=Math.min(Ze.tail+3,Ze.text)-Rt;Vt>0?(Ze.tail+=Vt,Ze.text+=Vt):Jt>0&&(Ze.tail-=Jt,Ze.text-=Jt)}Ze.tail+=Ct,Ze.head+=Ct}else Je=Wt*Ce(Ge,Bt),Ye=Je,Ze.text=nt+Je;Ze.text+=Ct,Je+=Ct,Ye+=Ct,c["_"+Re+"padplus"]=Wt/2+Ye,c["_"+Re+"padminus"]=Wt/2-Ye,c["_"+Re+"size"]=Wt,c["_"+Re+"shift"]=Je}if(He){ue.remove();return}var Yt=0,or=0;if(c.align!=="left"&&(Yt=(Se-me)*(c.align==="center"?.5:1)),c.valign!=="top"&&(or=(De-_e)*(c.valign==="middle"?.5:1)),he)oe.select("svg").attr({x:G+Yt-1,y:G+or}).call(a.setClipUrl,ee?O:null,b);else{var Hr=G+or-be.top,an=G+Yt-be.left;ae.call(f.positionText,an,Hr).call(a.setClipUrl,ee?O:null,b)}ne.select("rect").call(a.setRect,G,G,Se,De),Y.call(a.setRect,K/2,K/2,Ie-K,Te-K),ue.call(a.setTranslate,Math.round(N.x.text-Ie/2),Math.round(N.y.text-Te/2)),j.attr({transform:"rotate("+V+","+N.x.text+","+N.y.text+")"});var Kr=function(er,Kt){H.selectAll(".annotation-arrow-g").remove();var ur=N.x.head,Ar=N.y.head,et=N.x.tail+er,$e=N.y.tail+Kt,st=N.x.text+er,ft=N.y.text+Kt,St=T.rotationXYMatrix(V,st,ft),Ut=T.apply2DTransform(St),Pe=T.apply2DTransform2(St),ke=+Y.attr("width"),it=+Y.attr("height"),ut=st-.5*ke,ht=ut+ke,Et=ft-.5*it,yt=Et+it,Dt=[[ut,Et,ut,yt],[ut,yt,ht,yt],[ht,yt,ht,Et],[ht,Et,ut,Et]].map(Pe);if(!Dt.reduce(function(at,Ft){return at^!!T.segmentsIntersect(ur,Ar,ur+1e6,Ar+1e6,Ft[0],Ft[1],Ft[2],Ft[3])},!1)){Dt.forEach(function(at){var Ft=T.segmentsIntersect(et,$e,ur,Ar,at[0],at[1],at[2],at[3]);Ft&&(et=Ft.x,$e=Ft.y)});var Xt=c.arrowwidth,ar=c.arrowcolor,kr=c.arrowside,wr=H.append("g").style({opacity:n.opacity(ar)}).classed("annotation-arrow-g",!0),Sr=wr.append("path").attr("d","M"+et+","+$e+"L"+ur+","+Ar).style("stroke-width",Xt+"px").call(n.stroke,n.rgb(ar));if(g(Sr,kr,c),S.annotationPosition&&Sr.node().parentNode&&!_){var Zr=ur,ir=Ar;if(c.standoff){var xr=Math.sqrt(Math.pow(ur-et,2)+Math.pow(Ar-$e,2));Zr+=c.standoff*(et-ur)/xr,ir+=c.standoff*($e-Ar)/xr}var Fr=wr.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(et-Zr)+","+($e-ir),transform:e(Zr,ir)}).style("stroke-width",Xt+6+"px").call(n.stroke,"rgba(0,0,0,0)").call(n.fill,"rgba(0,0,0,0)"),Or,Cr;s.init({element:Fr.node(),gd:b,prepFn:function(){var at=a.getTranslate(ue);Or=at.x,Cr=at.y,y&&y.autorange&&z(y._name+".autorange",!0),w&&w.autorange&&z(w._name+".autorange",!0)},moveFn:function(at,Ft){var jt=Ut(Or,Cr),sr=jt[0]+at,zr=jt[1]+Ft;ue.call(a.setTranslate,sr,zr),F("x",x(y,at,"x",C,c)),F("y",x(w,Ft,"y",C,c)),c.axref===c.xref&&F("ax",x(y,at,"ax",C,c)),c.ayref===c.yref&&F("ay",x(w,Ft,"ay",C,c)),wr.attr("transform",e(at,Ft)),j.attr({transform:"rotate("+V+","+sr+","+zr+")"})},doneFn:function(){u.call("_guiRelayout",b,I());var at=document.querySelector(".js-notes-box-panel");at&&at.redraw(at.selectedObj)}})}}};if(c.showarrow&&Kr(0,0),Z){var ot;s.init({element:ue.node(),gd:b,prepFn:function(){ot=j.attr("transform")},moveFn:function(er,Kt){var ur="pointer";if(c.showarrow)c.axref===c.xref?F("ax",x(y,er,"ax",C,c)):F("ax",c.ax+er),c.ayref===c.yref?F("ay",x(w,Kt,"ay",C.w,c)):F("ay",c.ay+Kt),Kr(er,Kt);else{if(_)return;var Ar,et;if(y)Ar=x(y,er,"x",C,c);else{var $e=c._xsize/C.w,st=c.x+(c._xshift-c.xshift)/C.w-$e/2;Ar=s.align(st+er/C.w,$e,0,1,c.xanchor)}if(w)et=x(w,Kt,"y",C,c);else{var ft=c._ysize/C.h,St=c.y-(c._yshift+c.yshift)/C.h-ft/2;et=s.align(St-Kt/C.h,ft,0,1,c.yanchor)}F("x",Ar),F("y",et),(!y||!w)&&(ur=s.getCursor(y?.5:Ar,w?.5:et,c.xanchor,c.yanchor))}j.attr({transform:e(er,Kt)+ot}),o(ue,ur)},clickFn:function(er,Kt){c.captureevents&&b.emit("plotly_clickannotation",re(Kt))},doneFn:function(){o(ue),u.call("_guiRelayout",b,I());var er=document.querySelector(".js-notes-box-panel");er&&er.redraw(er.selectedObj)}})}}S.annotationText?ae.call(f.makeEditable,{delegate:ue,gd:b}).call(le).on("edit",function(se){c.text=se,this.call(le),F("text",se),y&&y.autorange&&z(y._name+".autorange",!0),w&&w.autorange&&z(w._name+".autorange",!0),u.call("_guiRelayout",b,I())}):ae.call(le)}},{"../../lib":515,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../fx":407,"./draw_arrow_head":357,"@plotly/d3":58}],357:[function(t,P,R){var h=t("@plotly/d3"),u=t("../color"),A=t("./arrow_paths"),T=t("../../lib"),e=T.strScale,i=T.strRotate,n=T.strTranslate;P.exports=function(r,f,o){var s=r.node(),m=A[o.arrowhead||0],g=A[o.startarrowhead||0],p=(o.arrowwidth||1)*(o.arrowsize||1),v=(o.arrowwidth||1)*(o.startarrowsize||1),x=f.indexOf("start")>=0,l=f.indexOf("end")>=0,b=m.backoff*p+o.standoff,c=g.backoff*v+o.startstandoff,M,_,y,w;if(s.nodeName==="line"){M={x:+r.attr("x1"),y:+r.attr("y1")},_={x:+r.attr("x2"),y:+r.attr("y2")};var d=M.x-_.x,C=M.y-_.y;if(y=Math.atan2(C,d),w=y+Math.PI,b&&c&&b+c>Math.sqrt(d*d+C*C)){j();return}if(b){if(b*b>d*d+C*C){j();return}var S=b*Math.cos(y),E=b*Math.sin(y);_.x+=S,_.y+=E,r.attr({x2:_.x,y2:_.y})}if(c){if(c*c>d*d+C*C){j();return}var k=c*Math.cos(y),B=c*Math.sin(y);M.x-=k,M.y-=B,r.attr({x1:M.x,y1:M.y})}}else if(s.nodeName==="path"){var z=s.getTotalLength(),F="";if(z<b+c){j();return}var I=s.getPointAtLength(0),O=s.getPointAtLength(.1);y=Math.atan2(I.y-O.y,I.x-O.x),M=s.getPointAtLength(Math.min(c,z)),F="0px,"+c+"px,";var N=s.getPointAtLength(z),V=s.getPointAtLength(z-.1);w=Math.atan2(N.y-V.y,N.x-V.x),_=s.getPointAtLength(Math.max(0,z-b));var H=F?c+b:b;F+=z-H+"px,"+z+"px",r.style("stroke-dasharray",F)}function j(){r.style("stroke-dasharray","0px,100px")}function Z(X,re,ue,K){!X.path||(X.noRotate&&(ue=0),h.select(s.parentNode).append("path").attr({class:r.attr("class"),d:X.path,transform:n(re.x,re.y)+i(ue*180/Math.PI)+e(K)}).style({fill:u.rgb(o.arrowcolor),"stroke-width":0}))}x&&Z(g,M,y,v),l&&Z(m,_,w,p)}},{"../../lib":515,"../color":367,"./arrow_paths":349,"@plotly/d3":58}],358:[function(t,P,R){var h=t("./draw"),u=t("./click");P.exports={moduleType:"component",name:"annotations",layoutAttributes:t("./attributes"),supplyLayoutDefaults:t("./defaults"),includeBasePlot:t("../../plots/cartesian/include_components")("annotations"),calcAutorange:t("./calc_autorange"),draw:h.draw,drawOne:h.drawOne,drawRaw:h.drawRaw,hasClickToShow:u.hasClickToShow,onClick:u.onClick,convertCoords:t("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":350,"./calc_autorange":351,"./click":352,"./convert_coords":354,"./defaults":355,"./draw":356}],359:[function(t,P,R){var h=t("../annotations/attributes"),u=t("../../plot_api/edit_types").overrideAll,A=t("../../plot_api/plot_template").templatedArray;P.exports=u(A("annotation",{visible:h.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:h.xanchor,xshift:h.xshift,yanchor:h.yanchor,yshift:h.yshift,text:h.text,textangle:h.textangle,font:h.font,width:h.width,height:h.height,opacity:h.opacity,align:h.align,valign:h.valign,bgcolor:h.bgcolor,bordercolor:h.bordercolor,borderpad:h.borderpad,borderwidth:h.borderwidth,showarrow:h.showarrow,arrowcolor:h.arrowcolor,arrowhead:h.arrowhead,startarrowhead:h.startarrowhead,arrowside:h.arrowside,arrowsize:h.arrowsize,startarrowsize:h.startarrowsize,arrowwidth:h.arrowwidth,standoff:h.standoff,startstandoff:h.startstandoff,hovertext:h.hovertext,hoverlabel:h.hoverlabel,captureevents:h.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../annotations/attributes":350}],360:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axes");P.exports=function(e){for(var i=e.fullSceneLayout,n=i.annotations,a=0;a<n.length;a++)A(n[a],e);e.fullLayout._infolayer.selectAll(".annotation-"+e.id).remove()};function A(T,e){var i=e.fullSceneLayout,n=i.domain,a=e.fullLayout._size,r={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};T._xa={},h.extendFlat(T._xa,r),u.setConvert(T._xa),T._xa._offset=a.l+n.x[0]*a.w,T._xa.l2p=function(){return .5*(1+T._pdata[0]/T._pdata[3])*a.w*(n.x[1]-n.x[0])},T._ya={},h.extendFlat(T._ya,r),u.setConvert(T._ya),T._ya._offset=a.t+(1-n.y[1])*a.h,T._ya.l2p=function(){return .5*(1-T._pdata[1]/T._pdata[3])*a.h*(n.y[1]-n.y[0])}}},{"../../lib":515,"../../plots/cartesian/axes":566}],361:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axes"),A=t("../../plots/array_container_defaults"),T=t("../annotations/common_defaults"),e=t("./attributes");P.exports=function(a,r,f){A(a,r,{name:"annotations",handleItemDefaults:i,fullLayout:f.fullLayout})};function i(n,a,r,f){function o(g,p){return h.coerce(n,a,e,g,p)}function s(g){var p=g+"axis",v={_fullLayout:{}};return v._fullLayout[p]=r[p],u.coercePosition(a,v,o,g,g,.5)}var m=o("visible");!m||(T(n,a,f.fullLayout,o),s("x"),s("y"),s("z"),h.noneOrAll(n,a,["x","y","z"]),a.xref="x",a.yref="y",a.zref="z",o("xanchor"),o("yanchor"),o("xshift"),o("yshift"),a.showarrow&&(a.axref="pixel",a.ayref="pixel",o("ax",-10),o("ay",-30),h.noneOrAll(n,a,["ax","ay"])))}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../annotations/common_defaults":353,"./attributes":359}],362:[function(t,P,R){var h=t("../annotations/draw").drawRaw,u=t("../../plots/gl3d/project"),A=["x","y","z"];P.exports=function(e){for(var i=e.fullSceneLayout,n=e.dataScale,a=i.annotations,r=0;r<a.length;r++){for(var f=a[r],o=!1,s=0;s<3;s++){var m=A[s],g=f[m],p=i[m+"axis"],v=p.r2fraction(g);if(v<0||v>1){o=!0;break}}o?e.fullLayout._infolayer.select(".annotation-"+e.id+'[data-index="'+r+'"]').remove():(f._pdata=u(e.glplot.cameraParams,[i.xaxis.r2l(f.x)*n[0],i.yaxis.r2l(f.y)*n[1],i.zaxis.r2l(f.z)*n[2]]),h(e.graphDiv,f,r,e.id,f._xa,f._ya))}}},{"../../plots/gl3d/project":616,"../annotations/draw":356}],363:[function(t,P,R){var h=t("../../registry"),u=t("../../lib");P.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:t("./attributes")}}},layoutAttributes:t("./attributes"),handleDefaults:t("./defaults"),includeBasePlot:A,convert:t("./convert"),draw:t("./draw")};function A(T,e){var i=h.subplotsRegistry.gl3d;if(!!i)for(var n=i.attrRegex,a=Object.keys(T),r=0;r<a.length;r++){var f=a[r];n.test(f)&&(T[f].annotations||[]).length&&(u.pushUnique(e._basePlotModules,i),u.pushUnique(e._subplots.gl3d,f))}}},{"../../lib":515,"../../registry":647,"./attributes":359,"./convert":360,"./defaults":361,"./draw":362}],364:[function(t,P,R){P.exports=t("world-calendars/dist/main"),t("world-calendars/dist/plus"),t("world-calendars/dist/calendars/chinese"),t("world-calendars/dist/calendars/coptic"),t("world-calendars/dist/calendars/discworld"),t("world-calendars/dist/calendars/ethiopian"),t("world-calendars/dist/calendars/hebrew"),t("world-calendars/dist/calendars/islamic"),t("world-calendars/dist/calendars/julian"),t("world-calendars/dist/calendars/mayan"),t("world-calendars/dist/calendars/nanakshahi"),t("world-calendars/dist/calendars/nepali"),t("world-calendars/dist/calendars/persian"),t("world-calendars/dist/calendars/taiwan"),t("world-calendars/dist/calendars/thai"),t("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":333,"world-calendars/dist/calendars/coptic":334,"world-calendars/dist/calendars/discworld":335,"world-calendars/dist/calendars/ethiopian":336,"world-calendars/dist/calendars/hebrew":337,"world-calendars/dist/calendars/islamic":338,"world-calendars/dist/calendars/julian":339,"world-calendars/dist/calendars/mayan":340,"world-calendars/dist/calendars/nanakshahi":341,"world-calendars/dist/calendars/nepali":342,"world-calendars/dist/calendars/persian":343,"world-calendars/dist/calendars/taiwan":344,"world-calendars/dist/calendars/thai":345,"world-calendars/dist/calendars/ummalqura":346,"world-calendars/dist/main":347,"world-calendars/dist/plus":348}],365:[function(t,P,R){var h=t("./calendars"),u=t("../../lib"),A=t("../../constants/numerical"),T=A.EPOCHJD,e=A.ONEDAY,i={valType:"enumerated",values:u.sortObjectKeys(h.calendars),editType:"calc",dflt:"gregorian"},n=function(y,w,d,C){var S={};return S[d]=i,u.coerce(y,w,S,d,C)},a=function(y,w,d,C){for(var S=0;S<d.length;S++)n(y,w,d[S]+"calendar",C.calendar)},r={chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},f={chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},o={chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},s="##",m={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:s,w:s,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}};function g(y,w,d){for(var C=Math.floor((w+.05)/e)+T,S=v(d).fromJD(C),E=0,k,B,z,F,I;(E=y.indexOf("%",E))!==-1;)k=y.charAt(E+1),k==="0"||k==="-"||k==="_"?(z=3,B=y.charAt(E+2),k==="_"&&(k="-")):(B=k,k="0",z=2),F=m[B],F?(F===s?I=s:I=S.formatDate(F[k]),y=y.substr(0,E)+I+y.substr(E+z),E+=I.length):E+=z;return y}var p={};function v(y){var w=p[y];return w||(w=p[y]=h.instance(y),w)}function x(y){return u.extendFlat({},i,{description:y})}function l(y){return"Sets the calendar system to use with `"+y+"` date data."}var b={xcalendar:x(l("x"))},c=u.extendFlat({},b,{ycalendar:x(l("y"))}),M=u.extendFlat({},c,{zcalendar:x(l("z"))}),_=x(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));P.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:c,bar:c,box:c,heatmap:c,contour:c,histogram:c,histogram2d:c,histogram2dcontour:c,scatter3d:M,surface:M,mesh3d:M,scattergl:c,ohlc:b,candlestick:b},layout:{calendar:x(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:_},yaxis:{calendar:_},scene:{xaxis:{calendar:_},yaxis:{calendar:_},zaxis:{calendar:_}},polar:{radialaxis:{calendar:_}}},transforms:{filter:{valuecalendar:x(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:x(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:i,handleDefaults:n,handleTraceDefaults:a,CANONICAL_SUNDAY:f,CANONICAL_TICK:r,DFLTRANGE:o,getCal:v,worldCalFmt:g}},{"../../constants/numerical":491,"../../lib":515,"./calendars":364}],366:[function(t,P,R){R.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],R.defaultLine="#444",R.lightLine="#eee",R.background="#fff",R.borderLine="#BEC8D9",R.lightFraction=100*(14-4)/(15-4)},{}],367:[function(t,P,R){var h=t("tinycolor2"),u=t("fast-isnumeric"),A=t("../../lib/array").isTypedArray,T=P.exports={},e=t("./attributes");T.defaults=e.defaults;var i=T.defaultLine=e.defaultLine;T.lightLine=e.lightLine;var n=T.background=e.background;T.tinyRGB=function(r){var f=r.toRgb();return"rgb("+Math.round(f.r)+", "+Math.round(f.g)+", "+Math.round(f.b)+")"},T.rgb=function(r){return T.tinyRGB(h(r))},T.opacity=function(r){return r?h(r).getAlpha():0},T.addOpacity=function(r,f){var o=h(r).toRgb();return"rgba("+Math.round(o.r)+", "+Math.round(o.g)+", "+Math.round(o.b)+", "+f+")"},T.combine=function(r,f){var o=h(r).toRgb();if(o.a===1)return h(r).toRgbString();var s=h(f||n).toRgb(),m=s.a===1?s:{r:255*(1-s.a)+s.r*s.a,g:255*(1-s.a)+s.g*s.a,b:255*(1-s.a)+s.b*s.a},g={r:m.r*(1-o.a)+o.r*o.a,g:m.g*(1-o.a)+o.g*o.a,b:m.b*(1-o.a)+o.b*o.a};return h(g).toRgbString()},T.contrast=function(r,f,o){var s=h(r);s.getAlpha()!==1&&(s=h(T.combine(r,n)));var m=s.isDark()?f?s.lighten(f):n:o?s.darken(o):i;return m.toString()},T.stroke=function(r,f){var o=h(f);r.style({stroke:T.tinyRGB(o),"stroke-opacity":o.getAlpha()})},T.fill=function(r,f){var o=h(f);r.style({fill:T.tinyRGB(o),"fill-opacity":o.getAlpha()})},T.clean=function(r){if(!(!r||typeof r!="object")){var f=Object.keys(r),o,s,m,g;for(o=0;o<f.length;o++)if(m=f[o],g=r[m],m.substr(m.length-5)==="color")if(Array.isArray(g))for(s=0;s<g.length;s++)g[s]=a(g[s]);else r[m]=a(g);else if(m.substr(m.length-10)==="colorscale"&&Array.isArray(g))for(s=0;s<g.length;s++)Array.isArray(g[s])&&(g[s][1]=a(g[s][1]));else if(Array.isArray(g)){var p=g[0];if(!Array.isArray(p)&&p&&typeof p=="object")for(s=0;s<g.length;s++)T.clean(g[s])}else g&&typeof g=="object"&&!A(g)&&T.clean(g)}};function a(r){if(u(r)||typeof r!="string")return r;var f=r.trim();if(f.substr(0,3)!=="rgb")return r;var o=f.match(/^rgba?\s*\(([^()]*)\)$/);if(!o)return r;var s=o[1].trim().split(/\s*[\s,]\s*/),m=f.charAt(3)==="a"&&s.length===4;if(!m&&s.length!==3)return r;for(var g=0;g<s.length;g++){if(!s[g].length||(s[g]=Number(s[g]),!(s[g]>=0)))return r;if(g===3)s[g]>1&&(s[g]=1);else if(s[g]>=1)return r}var p=Math.round(s[0]*255)+", "+Math.round(s[1]*255)+", "+Math.round(s[2]*255);return m?"rgba("+p+", "+s[3]+")":"rgb("+p+")"}},{"../../lib/array":497,"./attributes":366,"fast-isnumeric":190,tinycolor2:313}],368:[function(t,P,R){var h=t("../../plots/cartesian/layout_attributes"),u=t("../../plots/font_attributes"),A=t("../../lib/extend").extendFlat,T=t("../../plot_api/edit_types").overrideAll;P.exports=T({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:h.linecolor,outlinewidth:h.linewidth,bordercolor:h.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:h.tickmode,nticks:h.nticks,tick0:h.tick0,dtick:h.dtick,tickvals:h.tickvals,ticktext:h.ticktext,ticks:A({},h.ticks,{dflt:""}),ticklabeloverflow:A({},h.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:h.ticklen,tickwidth:h.tickwidth,tickcolor:h.tickcolor,ticklabelstep:h.ticklabelstep,showticklabels:h.showticklabels,tickfont:u({}),tickangle:h.tickangle,tickformat:h.tickformat,tickformatstops:h.tickformatstops,tickprefix:h.tickprefix,showtickprefix:h.showtickprefix,ticksuffix:h.ticksuffix,showticksuffix:h.showticksuffix,separatethousands:h.separatethousands,exponentformat:h.exponentformat,minexponent:h.minexponent,showexponent:h.showexponent,title:{text:{valType:"string"},font:u({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:u({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],369:[function(t,P,R){P.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],370:[function(t,P,R){var h=t("../../lib"),u=t("../../plot_api/plot_template"),A=t("../../plots/cartesian/tick_value_defaults"),T=t("../../plots/cartesian/tick_mark_defaults"),e=t("../../plots/cartesian/tick_label_defaults"),i=t("../../plots/cartesian/prefix_suffix_defaults"),n=t("./attributes");P.exports=function(r,f,o){var s=u.newContainer(f,"colorbar"),m=r.colorbar||{};function g(S,E){return h.coerce(m,s,n,S,E)}var p=o.margin||{t:0,b:0,l:0,r:0},v=o.width-p.l-p.r,x=o.height-p.t-p.b,l=g("orientation"),b=l==="v",c=g("thicknessmode");g("thickness",c==="fraction"?30/(b?v:x):30);var M=g("lenmode");g("len",M==="fraction"?1:b?x:v),g("x",b?1.02:.5),g("xanchor",b?"left":"center"),g("xpad"),g("y",b?.5:1.02),g("yanchor",b?"middle":"bottom"),g("ypad"),h.noneOrAll(m,s,["x","y"]),g("outlinecolor"),g("outlinewidth"),g("bordercolor"),g("borderwidth"),g("bgcolor");var _=h.coerce(m,s,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:b?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");g("ticklabeloverflow",_.indexOf("inside")!==-1?"hide past domain":"hide past div"),A(m,s,g,"linear");var y=o.font,w={outerTicks:!1,font:y};_.indexOf("inside")!==-1&&(w.bgColor="black"),i(m,s,g,"linear",w),e(m,s,g,"linear",w),T(m,s,g,"linear",w),g("title.text",o._dfltTitle.colorbar);var d=s.tickfont,C=h.extendFlat({},d,{color:y.color,size:h.bigFont(d.size)});h.coerceFont(g,"title.font",C),g("title.side",b?"top":"right")}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"./attributes":368}],371:[function(t,P,R){var h=t("@plotly/d3"),u=t("tinycolor2"),A=t("../../plots/plots"),T=t("../../registry"),e=t("../../plots/cartesian/axes"),i=t("../dragelement"),n=t("../../lib"),a=n.strTranslate,r=t("../../lib/extend").extendFlat,f=t("../../lib/setcursor"),o=t("../drawing"),s=t("../color"),m=t("../titles"),g=t("../../lib/svg_text_utils"),p=t("../colorscale/helpers").flipScale,v=t("../../plots/cartesian/axis_defaults"),x=t("../../plots/cartesian/position_defaults"),l=t("../../plots/cartesian/layout_attributes"),b=t("../../constants/alignment"),c=b.LINE_SPACING,M=b.FROM_TL,_=b.FROM_BR,y=t("./constants").cn;function w(B){var z=B._fullLayout,F=z._infolayer.selectAll("g."+y.colorbar).data(d(B),function(I){return I._id});F.enter().append("g").attr("class",function(I){return I._id}).classed(y.colorbar,!0),F.each(function(I){var O=h.select(this);n.ensureSingle(O,"rect",y.cbbg),n.ensureSingle(O,"g",y.cbfills),n.ensureSingle(O,"g",y.cblines),n.ensureSingle(O,"g",y.cbaxis,function(V){V.classed(y.crisp,!0)}),n.ensureSingle(O,"g",y.cbtitleunshift,function(V){V.append("g").classed(y.cbtitle,!0)}),n.ensureSingle(O,"rect",y.cboutline);var N=C(O,I,B);N&&N.then&&(B._promises||[]).push(N),B._context.edits.colorbarPosition&&S(O,I,B)}),F.exit().each(function(I){A.autoMargin(B,I._id)}).remove(),F.order()}function d(B){var z=B._fullLayout,F=B.calcdata,I=[],O,N,V,H;function j(J){return r(J,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function Z(){typeof H.calc=="function"?H.calc(B,V,O):(O._fillgradient=N.reversescale?p(N.colorscale):N.colorscale,O._zrange=[N[H.min],N[H.max]])}for(var X=0;X<F.length;X++){var re=F[X];V=re[0].trace;var ue=V._module.colorbar;if(V.visible===!0&&ue)for(var K=Array.isArray(ue),te=K?ue:[ue],G=0;G<te.length;G++){H=te[G];var Y=H.container;N=Y?V[Y]:V,N&&N.showscale&&(O=j(N.colorbar),O._id="cb"+V.uid+(K&&Y?"-"+Y:""),O._traceIndex=V.index,O._propPrefix=(Y?Y+".":"")+"colorbar.",O._meta=V._meta,Z(),I.push(O))}}for(var ee in z._colorAxes)if(N=z[ee],N.showscale){var ne=z._colorAxes[ee];O=j(N.colorbar),O._id="cb"+ee,O._propPrefix=ee+".colorbar.",O._meta=z._meta,H={min:"cmin",max:"cmax"},ne[0]!=="heatmap"&&(V=ne[1],H.calc=V._module.colorbar.calc),Z(),I.push(O)}return I}function C(B,z,F){var I=z.orientation==="v",O=z.len,N=z.lenmode,V=z.thickness,H=z.thicknessmode,j=z.outlinewidth,Z=z.borderwidth,X=z.bgcolor,re=z.xanchor,ue=z.yanchor,K=z.xpad,te=z.ypad,G=z.x,Y=I?z.y:1-z.y,ee=F._fullLayout,ne=ee._size,J=z._fillcolor,q=z._line,ae=z.title,le=ae.side,ie=z._zrange||h.extent((typeof J=="function"?J:q.color).domain()),se=typeof q.color=="function"?q.color:function(){return q.color},xe=typeof J=="function"?J:function(){return J},oe=z._levels,he=E(F,z,ie),be=he.fill,me=he.line,_e=Math.round(V*(H==="fraction"?I?ne.w:ne.h:1)),Se=_e/(I?ne.w:ne.h),De=Math.round(O*(N==="fraction"?I?ne.h:ne.w:1)),Ie=De/(I?ne.h:ne.w),Te=Math.round(I?G*ne.w+K:Y*ne.h+te),Ce={center:.5,right:1}[re]||0,He={top:1,middle:.5}[ue]||0,Xe=I?G-Ce*Se:Y-He*Se,Be=I?Y-He*Ie:G-Ce*Ie,Re=Math.round(I?ne.h*(1-Be):ne.w*Be);z._lenFrac=Ie,z._thickFrac=Se,z._uFrac=Xe,z._vFrac=Be;var We=z._axis=k(F,z,ie);We.position=Se+(I?G+K/ne.w:Y+te/ne.h);var vt=["top","bottom"].indexOf(le)!==-1;if(I&&vt&&(We.title.side=le,We.titlex=G+K/ne.w,We.titley=Be+(ae.side==="top"?Ie-te/ne.h:te/ne.h)),!I&&!vt&&(We.title.side=le,We.titley=Y+te/ne.h,We.titlex=Be+K/ne.w),q.color&&z.tickmode==="auto"){We.tickmode="linear",We.tick0=oe.start;var Pt=oe.size,Zt=n.constrain(De/50,4,15)+1,zt=(ie[1]-ie[0])/((z.nticks||Zt)*Pt);if(zt>1){var At=Math.pow(10,Math.floor(Math.log(zt)/Math.LN10));Pt*=At*n.roundUp(zt/At,[2,5,10]),(Math.abs(oe.start)/oe.size+1e-6)%1<2e-6&&(We.tick0=0)}We.dtick=Pt}We.domain=I?[Be+te/ne.h,Be+Ie-te/ne.h]:[Be+K/ne.w,Be+Ie-K/ne.w],We.setScale(),B.attr("transform",a(Math.round(ne.l),Math.round(ne.t)));var Wt=B.select("."+y.cbtitleunshift).attr("transform",a(-Math.round(ne.l),-Math.round(ne.t))),Bt=We.ticklabelposition,Ct=We.title.font.size,Ze=B.select("."+y.cbaxis),nt,Ye=0,Ee=0;function Ge(Mt,Ht){var Rt={propContainer:We,propName:z._propPrefix+"title",traceIndex:z._traceIndex,_meta:z._meta,placeholder:ee._dfltTitle.colorbar,containerGroup:B.select("."+y.cbtitle)},Vt=Mt.charAt(0)==="h"?Mt.substr(1):"h"+Mt;B.selectAll("."+Vt+",."+Vt+"-math-group").remove(),m.draw(F,Mt,r(Rt,Ht||{}))}function Je(){if(I&&vt||!I&&!vt){var Mt,Ht;le==="top"&&(Mt=K+ne.l+ne.w*G,Ht=te+ne.t+ne.h*(1-Be-Ie)+3+Ct*.75),le==="bottom"&&(Mt=K+ne.l+ne.w*G,Ht=te+ne.t+ne.h*(1-Be)-3-Ct*.25),le==="right"&&(Ht=te+ne.t+ne.h*Y+3+Ct*.75,Mt=K+ne.l+ne.w*Be),Ge(We._id+"title",{attributes:{x:Mt,y:Ht,"text-anchor":I?"start":"middle"}})}}function qe(){if(I&&!vt||!I&&vt){var Mt=We.position||0,Ht=We._offset+We._length/2,Rt,Vt;if(le==="right")Vt=Ht,Rt=ne.l+ne.w*Mt+10+Ct*(We.showticklabels?1:.5);else if(Rt=Ht,le==="bottom"&&(Vt=ne.t+ne.h*Mt+10+(Bt.indexOf("inside")===-1?We.tickfont.size:0)+(We.ticks!=="intside"&&z.ticklen||0)),le==="top"){var Jt=ae.text.split("<br>").length;Vt=ne.t+ne.h*Mt+10-_e-c*Ct*Jt}Ge((I?"h":"v")+We._id+"title",{avoid:{selection:h.select(F).selectAll("g."+We._id+"tick"),side:le,offsetTop:I?0:ne.t,offsetLeft:I?ne.l:0,maxShift:I?ee.width:ee.height},attributes:{x:Rt,y:Vt,"text-anchor":"middle"},transform:{rotate:I?-90:0,offset:0}})}}function Tt(){if(!I&&!vt||I&&vt){var Mt=B.select("."+y.cbtitle),Ht=Mt.select("text"),Rt=[-j/2,j/2],Vt=Mt.select(".h"+We._id+"title-math-group").node(),Jt=15.6;Ht.node()&&(Jt=parseInt(Ht.node().style.fontSize,10)*c);var Yt;if(Vt?(Yt=o.bBox(Vt),Ee=Yt.width,Ye=Yt.height,Ye>Jt&&(Rt[1]-=(Ye-Jt)/2)):Ht.node()&&!Ht.classed(y.jsPlaceholder)&&(Yt=o.bBox(Ht.node()),Ee=Yt.width,Ye=Yt.height),I){if(Ye){if(Ye+=5,le==="top")We.domain[1]-=Ye/ne.h,Rt[1]*=-1;else{We.domain[0]+=Ye/ne.h;var or=g.lineCount(Ht);Rt[1]+=(1-or)*Jt}Mt.attr("transform",a(Rt[0],Rt[1])),We.setScale()}}else Ee&&(le==="right"&&(We.domain[0]+=(Ee+Ct/2)/ne.w),Mt.attr("transform",a(Rt[0],Rt[1])),We.setScale())}B.selectAll("."+y.cbfills+",."+y.cblines).attr("transform",I?a(0,Math.round(ne.h*(1-We.domain[1]))):a(Math.round(ne.w*We.domain[0]),0)),Ze.attr("transform",I?a(0,Math.round(-ne.t)):a(Math.round(-ne.l),0));var Hr=B.select("."+y.cbfills).selectAll("rect."+y.cbfill).attr("style","").data(be);Hr.enter().append("rect").classed(y.cbfill,!0).style("stroke","none"),Hr.exit().remove();var an=ie.map(We.c2p).map(Math.round).sort(function(ur,Ar){return ur-Ar});Hr.each(function(ur,Ar){var et=[Ar===0?ie[0]:(be[Ar]+be[Ar-1])/2,Ar===be.length-1?ie[1]:(be[Ar]+be[Ar+1])/2].map(We.c2p).map(Math.round);I&&(et[1]=n.constrain(et[1]+(et[1]>et[0])?1:-1,an[0],an[1]));var $e=h.select(this).attr(I?"x":"y",Te).attr(I?"y":"x",h.min(et)).attr(I?"width":"height",Math.max(_e,2)).attr(I?"height":"width",Math.max(h.max(et)-h.min(et),2));if(z._fillgradient)o.gradient($e,F,z._id,I?"vertical":"horizontalreversed",z._fillgradient,"fill");else{var st=xe(ur).replace("e-","");$e.attr("fill",u(st).toHexString())}});var Kr=B.select("."+y.cblines).selectAll("path."+y.cbline).data(q.color&&q.width?me:[]);Kr.enter().append("path").classed(y.cbline,!0),Kr.exit().remove(),Kr.each(function(ur){var Ar=Te,et=Math.round(We.c2p(ur))+q.width/2%1;h.select(this).attr("d","M"+(I?Ar+","+et:et+","+Ar)+(I?"h":"v")+_e).call(o.lineGroupStyle,q.width,se(ur),q.dash)}),Ze.selectAll("g."+We._id+"tick,path").remove();var ot=Te+_e+(j||0)/2-(z.ticks==="outside"?1:0),er=e.calcTicks(We),Kt=e.getTickSigns(We)[2];return e.drawTicks(F,We,{vals:We.ticks==="inside"?e.clipEnds(We,er):er,layer:Ze,path:e.makeTickPath(We,ot,Kt),transFn:e.makeTransTickFn(We)}),e.drawLabels(F,We,{vals:er,layer:Ze,transFn:e.makeTransTickLabelFn(We),labelFns:e.makeLabelFns(We,ot)})}function mt(){var Mt,Ht=_e+j/2;Bt.indexOf("inside")===-1&&(Mt=o.bBox(Ze.node()),Ht+=I?Mt.width:Mt.height),nt=Wt.select("text");var Rt=0,Vt=I&&le==="top",Jt=!I&&le==="right",Yt=0;if(nt.node()&&!nt.classed(y.jsPlaceholder)){var or,Hr=Wt.select(".h"+We._id+"title-math-group").node();Hr&&(I&&vt||!I&&!vt)?(Mt=o.bBox(Hr),Rt=Mt.width,or=Mt.height):(Mt=o.bBox(Wt.node()),Rt=Mt.right-ne.l-(I?Te:Re),or=Mt.bottom-ne.t-(I?Re:Te),!I&&le==="top"&&(Ht+=Mt.height,Yt=Mt.height)),Jt&&(nt.attr("transform",a(Rt/2+Ct/2,0)),Rt*=2),Ht=Math.max(Ht,I?Rt:or)}var an=(I?K:te)*2+Ht+Z+j/2,Kr=0;!I&&ae.text&&ue==="bottom"&&Y<=0&&(Kr=an/2,an+=Kr,Yt+=Kr),ee._hColorbarMoveTitle=Kr,ee._hColorbarMoveCBTitle=Yt;var ot=Z+j;B.select("."+y.cbbg).attr("x",(I?Te:Re)-ot/2-(I?K:0)).attr("y",(I?Re:Te)-(I?De:te+Yt-Kr)).attr(I?"width":"height",Math.max(an-Kr,2)).attr(I?"height":"width",Math.max(De+ot,2)).call(s.fill,X).call(s.stroke,z.bordercolor).style("stroke-width",Z);var er=Jt?Math.max(Rt-10,0):0;if(B.selectAll("."+y.cboutline).attr("x",(I?Te:Re+K)+er).attr("y",(I?Re+te-De:Te)+(Vt?Ye:0)).attr(I?"width":"height",Math.max(_e,2)).attr(I?"height":"width",Math.max(De-(I?2*te+Ye:2*K+er),2)).call(s.stroke,z.outlinecolor).style({fill:"none","stroke-width":j}),B.attr("transform",a(ne.l-(I?Ce*an:0),ne.t-(I?0:(1-He)*an-Yt))),!I&&(Z||u(X).getAlpha()&&!u.equals(ee.paper_bgcolor,X))){var Kt=Ze.selectAll("text"),ur=Kt[0].length,Ar=B.select("."+y.cbbg).node(),et=o.bBox(Ar),$e=o.getTranslate(B),st=2;Kt.each(function(ut,ht){var Et=0,yt=ur-1;if(ht===Et||ht===yt){var Dt=o.bBox(this),Xt=o.getTranslate(this),ar;if(ht===yt){var kr=Dt.right+Xt.x,wr=et.right+$e.x+Re-Z-st+G;ar=wr-kr,ar>0&&(ar=0)}else if(ht===Et){var Sr=Dt.left+Xt.x,Zr=et.left+$e.x+Re+Z+st;ar=Zr-Sr,ar<0&&(ar=0)}ar&&(ur<3?this.setAttribute("transform","translate("+ar+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var ft={},St=M[re],Ut=_[re],Pe=M[ue],ke=_[ue],it=an-_e;I?(N==="pixels"?(ft.y=Y,ft.t=De*Pe,ft.b=De*ke):(ft.t=ft.b=0,ft.yt=Y+O*Pe,ft.yb=Y-O*ke),H==="pixels"?(ft.x=G,ft.l=an*St,ft.r=an*Ut):(ft.l=it*St,ft.r=it*Ut,ft.xl=G-V*St,ft.xr=G+V*Ut)):(N==="pixels"?(ft.x=G,ft.l=De*St,ft.r=De*Ut):(ft.l=ft.r=0,ft.xl=G+O*St,ft.xr=G-O*Ut),H==="pixels"?(ft.y=1-Y,ft.t=an*Pe,ft.b=an*ke):(ft.t=it*Pe,ft.b=it*ke,ft.yt=Y-V*Pe,ft.yb=Y+V*ke)),A.autoMargin(F,z._id,ft)}return n.syncOrAsync([A.previousPromises,Je,Tt,qe,A.previousPromises,mt],F)}function S(B,z,F){var I=z.orientation==="v",O=F._fullLayout,N=O._size,V,H,j;i.init({element:B.node(),gd:F,prepFn:function(){V=B.attr("transform"),f(B)},moveFn:function(Z,X){B.attr("transform",V+a(Z,X)),H=i.align((I?z._uFrac:z._vFrac)+Z/N.w,I?z._thickFrac:z._lenFrac,0,1,z.xanchor),j=i.align((I?z._vFrac:1-z._uFrac)-X/N.h,I?z._lenFrac:z._thickFrac,0,1,z.yanchor);var re=i.getCursor(H,j,z.xanchor,z.yanchor);f(B,re)},doneFn:function(){if(f(B),H!==void 0&&j!==void 0){var Z={};Z[z._propPrefix+"x"]=H,Z[z._propPrefix+"y"]=j,z._traceIndex!==void 0?T.call("_guiRestyle",F,Z,z._traceIndex):T.call("_guiRelayout",F,Z)}}})}function E(B,z,F){var I=z._levels,O=[],N=[],V,H,j=I.end+I.size/100,Z=I.size,X=1.001*F[0]-.001*F[1],re=1.001*F[1]-.001*F[0];for(H=0;H<1e5&&(V=I.start+H*Z,!(Z>0?V>=j:V<=j));H++)V>X&&V<re&&O.push(V);if(z._fillgradient)N=[0];else if(typeof z._fillcolor=="function"){var ue=z._filllevels;if(ue)for(j=ue.end+ue.size/100,Z=ue.size,H=0;H<1e5&&(V=ue.start+H*Z,!(Z>0?V>=j:V<=j));H++)V>F[0]&&V<F[1]&&N.push(V);else N=O.map(function(K){return K-I.size/2}),N.push(N[N.length-1]+I.size)}else z._fillcolor&&typeof z._fillcolor=="string"&&(N=[0]);return I.size<0&&(O.reverse(),N.reverse()),{line:O,fill:N}}function k(B,z,F){var I=B._fullLayout,O=z.orientation==="v",N={type:"linear",range:F,tickmode:z.tickmode,nticks:z.nticks,tick0:z.tick0,dtick:z.dtick,tickvals:z.tickvals,ticktext:z.ticktext,ticks:z.ticks,ticklen:z.ticklen,tickwidth:z.tickwidth,tickcolor:z.tickcolor,showticklabels:z.showticklabels,ticklabelposition:z.ticklabelposition,ticklabeloverflow:z.ticklabeloverflow,ticklabelstep:z.ticklabelstep,tickfont:z.tickfont,tickangle:z.tickangle,tickformat:z.tickformat,exponentformat:z.exponentformat,minexponent:z.minexponent,separatethousands:z.separatethousands,showexponent:z.showexponent,showtickprefix:z.showtickprefix,tickprefix:z.tickprefix,showticksuffix:z.showticksuffix,ticksuffix:z.ticksuffix,title:z.title,showline:!0,anchor:"free",side:O?"right":"bottom",position:1},V=O?"y":"x",H={type:"linear",_id:V+z._id},j={letter:V,font:I.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:I.calendar};function Z(X,re){return n.coerce(N,H,l,X,re)}return v(N,H,Z,j,I),x(N,H,Z,j),H}P.exports={draw:w}},{"../../constants/alignment":483,"../../lib":515,"../../lib/extend":505,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"../../plots/plots":628,"../../registry":647,"../color":367,"../colorscale/helpers":378,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":369,"@plotly/d3":58,tinycolor2:313}],372:[function(t,P,R){var h=t("../../lib");P.exports=function(A){return h.isPlainObject(A.colorbar)}},{"../../lib":515}],373:[function(t,P,R){P.exports={moduleType:"component",name:"colorbar",attributes:t("./attributes"),supplyDefaults:t("./defaults"),draw:t("./draw").draw,hasColorbar:t("./has_colorbar")}},{"./attributes":368,"./defaults":370,"./draw":371,"./has_colorbar":372}],374:[function(t,P,R){var h=t("../colorbar/attributes"),u=t("../../lib/regex").counter,A=t("../../lib/sort_object_keys"),T=t("./scales.js").scales;A(T),P.exports=function(i,n){i=i||"",n=n||{};var a=n.cLetter||"c";"onlyIfNumerical"in n?n.onlyIfNumerical:Boolean(i);var r="noScale"in n?n.noScale:i==="marker.line",f="showScaleDflt"in n?n.showScaleDflt:a==="z",o=typeof n.colorscaleDflt=="string"?T[n.colorscaleDflt]:null,s=n.editTypeOverride||"",m;"colorAttr"in n?(m=n.colorAttr,n.colorAttr):m={z:"z",c:"color"}[a];var g=a+"auto",p=a+"min",v=a+"max",x=a+"mid",l={};l[p]=l[v]=void 0;var b={};b[g]=!1;var c={};return m==="color"&&(c.color={valType:"color",arrayOk:!0,editType:s||"style"},n.anim&&(c.color.anim=!0)),c[g]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:l},c[p]={valType:"number",dflt:null,editType:s||"plot",impliedEdits:b},c[v]={valType:"number",dflt:null,editType:s||"plot",impliedEdits:b},c[x]={valType:"number",dflt:null,editType:"calc",impliedEdits:l},c.colorscale={valType:"colorscale",editType:"calc",dflt:o,impliedEdits:{autocolorscale:!1}},c.autocolorscale={valType:"boolean",dflt:n.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},c.reversescale={valType:"boolean",dflt:!1,editType:"plot"},r||(c.showscale={valType:"boolean",dflt:f,editType:"calc"},c.colorbar=h),n.noColorAxis||(c.coloraxis={valType:"subplotid",regex:u("coloraxis"),dflt:null,editType:"calc"}),c}},{"../../lib/regex":532,"../../lib/sort_object_keys":538,"../colorbar/attributes":368,"./scales.js":382}],375:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib"),A=t("./helpers").extractOpts;P.exports=function(e,i,n){var a=e._fullLayout,r=n.vals,f=n.containerStr,o=f?u.nestedProperty(i,f).get():i,s=A(o),m=s.auto!==!1,g=s.min,p=s.max,v=s.mid,x=function(){return u.aggNums(Math.min,null,r)},l=function(){return u.aggNums(Math.max,null,r)};if(g===void 0?g=x():m&&(o._colorAx&&h(g)?g=Math.min(g,x()):g=x()),p===void 0?p=l():m&&(o._colorAx&&h(p)?p=Math.max(p,l()):p=l()),m&&v!==void 0&&(p-v>v-g?g=v-(p-v):p-v<v-g&&(p=v+(v-g))),g===p&&(g-=.5,p+=.5),s._sync("min",g),s._sync("max",p),s.autocolorscale){var b;g*p<0?b=a.colorscale.diverging:g>=0?b=a.colorscale.sequential:b=a.colorscale.sequentialminus,s._sync("colorscale",b)}}},{"../../lib":515,"./helpers":378,"fast-isnumeric":190}],376:[function(t,P,R){var h=t("../../lib"),u=t("./helpers").hasColorscale,A=t("./helpers").extractOpts;P.exports=function(e,i){function n(g,p){var v=g["_"+p];v!==void 0&&(g[p]=v)}function a(g,p){var v=p.container?h.nestedProperty(g,p.container).get():g;if(v)if(v.coloraxis)v._colorAx=i[v.coloraxis];else{var x=A(v),l=x.auto;(l||x.min===void 0)&&n(v,p.min),(l||x.max===void 0)&&n(v,p.max),x.autocolorscale&&n(v,"colorscale")}}for(var r=0;r<e.length;r++){var f=e[r],o=f._module.colorbar;if(o)if(Array.isArray(o))for(var s=0;s<o.length;s++)a(f,o[s]);else a(f,o);u(f,"marker.line")&&a(f,{container:"marker.line",min:"cmin",max:"cmax"})}for(var m in i._colorAxes)a(i[m],{min:"cmin",max:"cmax"})}},{"../../lib":515,"./helpers":378}],377:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib"),A=t("../colorbar/has_colorbar"),T=t("../colorbar/defaults"),e=t("./scales").isValid,i=t("../../registry").traceIs;function n(a,r){var f=r.slice(0,r.length-1);return r?u.nestedProperty(a,f).get()||{}:a}P.exports=function a(r,f,o,s,m){var g=m.prefix,p=m.cLetter,v="_module"in f,x=n(r,g),l=n(f,g),b=n(f._template||{},g)||{},c=function(){return delete r.coloraxis,delete f.coloraxis,a(r,f,o,s,m)};if(v){var M=o._colorAxes||{},_=s(g+"coloraxis");if(_){var y=i(f,"contour")&&u.nestedProperty(f,"contours.coloring").get()||"heatmap",w=M[_];w?(w[2].push(c),w[0]!==y&&(w[0]=!1,u.warn(["Ignoring coloraxis:",_,"setting","as it is linked to incompatible colorscales."].join(" ")))):M[_]=[y,f,[c]];return}}var d=x[p+"min"],C=x[p+"max"],S=h(d)&&h(C)&&d<C,E=s(g+p+"auto",!S);E?s(g+p+"mid"):(s(g+p+"min"),s(g+p+"max"));var k=x.colorscale,B=b.colorscale,z;if(k!==void 0&&(z=!e(k)),B!==void 0&&(z=!e(B)),s(g+"autocolorscale",z),s(g+"colorscale"),s(g+"reversescale"),g!=="marker.line."){var F;g&&v&&(F=A(x));var I=s(g+"showscale",F);I&&(g&&b&&(l._template=b),T(x,l,o))}}},{"../../lib":515,"../../registry":647,"../colorbar/defaults":370,"../colorbar/has_colorbar":372,"./scales":382,"fast-isnumeric":190}],378:[function(t,P,R){var h=t("@plotly/d3"),u=t("tinycolor2"),A=t("fast-isnumeric"),T=t("../../lib"),e=t("../color"),i=t("./scales").isValid;function n(v,x,l){var b=x?T.nestedProperty(v,x).get()||{}:v,c=b[l||"color"],M=!1;if(T.isArrayOrTypedArray(c)){for(var _=0;_<c.length;_++)if(A(c[_])){M=!0;break}}return T.isPlainObject(b)&&(M||b.showscale===!0||A(b.cmin)&&A(b.cmax)||i(b.colorscale)||T.isPlainObject(b.colorbar))}var a=["showscale","autocolorscale","colorscale","reversescale","colorbar"],r=["min","max","mid","auto"];function f(v){var x=v._colorAx,l=x||v,b={},c,M,_;for(M=0;M<a.length;M++)_=a[M],b[_]=l[_];if(x)for(c="c",M=0;M<r.length;M++)_=r[M],b[_]=l["c"+_];else{var y;for(M=0;M<r.length;M++){if(_=r[M],y="c"+_,y in l){b[_]=l[y];continue}y="z"+_,y in l&&(b[_]=l[y])}c=y.charAt(0)}return b._sync=function(w,d){var C=r.indexOf(w)!==-1?c+w:w;l[C]=l["_"+C]=d},b}function o(v){for(var x=f(v),l=x.min,b=x.max,c=x.reversescale?s(x.colorscale):x.colorscale,M=c.length,_=new Array(M),y=new Array(M),w=0;w<M;w++){var d=c[w];_[w]=l+d[0]*(b-l),y[w]=d[1]}return{domain:_,range:y}}function s(v){for(var x=v.length,l=new Array(x),b=x-1,c=0;b>=0;b--,c++){var M=v[b];l[c]=[1-M[0],M[1]]}return l}function m(v,x){x=x||{};for(var l=v.domain,b=v.range,c=b.length,M=new Array(c),_=0;_<c;_++){var y=u(b[_]).toRgb();M[_]=[y.r,y.g,y.b,y.a]}var w=h.scale.linear().domain(l).range(M).clamp(!0),d=x.noNumericCheck,C=x.returnArray,S;return d&&C?S=w:d?S=function(E){return p(w(E))}:C?S=function(E){return A(E)?w(E):u(E).isValid()?E:e.defaultLine}:S=function(E){return A(E)?p(w(E)):u(E).isValid()?E:e.defaultLine},S.domain=w.domain,S.range=function(){return b},S}function g(v,x){return m(o(v),x)}function p(v){var x={r:v[0],g:v[1],b:v[2],a:v[3]};return u(x).toRgbString()}P.exports={hasColorscale:n,extractOpts:f,extractScale:o,flipScale:s,makeColorScaleFunc:m,makeColorScaleFuncFromTrace:g}},{"../../lib":515,"../color":367,"./scales":382,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],379:[function(t,P,R){var h=t("./scales"),u=t("./helpers");P.exports={moduleType:"component",name:"colorscale",attributes:t("./attributes"),layoutAttributes:t("./layout_attributes"),supplyLayoutDefaults:t("./layout_defaults"),handleDefaults:t("./defaults"),crossTraceDefaults:t("./cross_trace_defaults"),calc:t("./calc"),scales:h.scales,defaultScale:h.defaultScale,getScale:h.get,isValidScale:h.isValid,hasColorscale:u.hasColorscale,extractOpts:u.extractOpts,extractScale:u.extractScale,flipScale:u.flipScale,makeColorScaleFunc:u.makeColorScaleFunc,makeColorScaleFuncFromTrace:u.makeColorScaleFuncFromTrace}},{"./attributes":374,"./calc":375,"./cross_trace_defaults":376,"./defaults":377,"./helpers":378,"./layout_attributes":380,"./layout_defaults":381,"./scales":382}],380:[function(t,P,R){var h=t("../../lib/extend").extendFlat,u=t("./attributes"),A=t("./scales").scales;P.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:A.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:A.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:A.RdBu,editType:"calc"}},coloraxis:h({_isSubplotObj:!0,editType:"calc"},u("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":505,"./attributes":374,"./scales":382}],381:[function(t,P,R){var h=t("../../lib"),u=t("../../plot_api/plot_template"),A=t("./layout_attributes"),T=t("./defaults");P.exports=function(i,n){function a(v,x){return h.coerce(i,n,A,v,x)}a("colorscale.sequential"),a("colorscale.sequentialminus"),a("colorscale.diverging");var r=n._colorAxes,f,o;function s(v,x){return h.coerce(f,o,A.coloraxis,v,x)}for(var m in r){var g=r[m];if(g[0])f=i[m]||{},o=u.newContainer(n,m,"coloraxis"),o._name=m,T(f,o,n,s,{prefix:"",cLetter:"c"});else{for(var p=0;p<g[2].length;p++)g[2][p]();delete n._colorAxes[m]}}}},{"../../lib":515,"../../plot_api/plot_template":555,"./defaults":377,"./layout_attributes":380}],382:[function(t,P,R){var h=t("tinycolor2"),u={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},A=u.RdBu;function T(n,a){if(a||(a=A),!n)return a;function r(){try{n=u[n]||JSON.parse(n)}catch{n=a}}return typeof n=="string"&&(r(),typeof n=="string"&&r()),e(n)?n:a}function e(n){var a=0;if(!Array.isArray(n)||n.length<2||!n[0]||!n[n.length-1]||+n[0][0]!=0||+n[n.length-1][0]!=1)return!1;for(var r=0;r<n.length;r++){var f=n[r];if(f.length!==2||+f[0]<a||!h(f[1]).isValid())return!1;a=+f[0]}return!0}function i(n){return u[n]!==void 0?!0:e(n)}P.exports={scales:u,defaultScale:A,get:T,isValid:i}},{tinycolor2:313}],383:[function(t,P,R){P.exports=function(u,A,T,e,i){var n=(u-T)/(e-T),a=n+A/(e-T),r=(n+a)/2;return i==="left"||i==="bottom"?n:i==="center"||i==="middle"?r:i==="right"||i==="top"?a:n<2/3-r?n:a>4/3-r?a:r}},{}],384:[function(t,P,R){var h=t("../../lib"),u=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];P.exports=function(T,e,i,n){return i==="left"?T=0:i==="center"?T=1:i==="right"?T=2:T=h.constrain(Math.floor(T*3),0,2),n==="bottom"?e=0:n==="middle"?e=1:n==="top"?e=2:e=h.constrain(Math.floor(e*3),0,2),u[e][T]}},{"../../lib":515}],385:[function(t,P,R){R.selectMode=function(h){return h==="lasso"||h==="select"},R.drawMode=function(h){return h==="drawclosedpath"||h==="drawopenpath"||h==="drawline"||h==="drawrect"||h==="drawcircle"},R.openMode=function(h){return h==="drawline"||h==="drawopenpath"},R.rectMode=function(h){return h==="select"||h==="drawline"||h==="drawrect"||h==="drawcircle"},R.freeMode=function(h){return h==="lasso"||h==="drawclosedpath"||h==="drawopenpath"},R.selectingOrDrawing=function(h){return R.freeMode(h)||R.rectMode(h)}},{}],386:[function(t,P,R){var h=t("mouse-event-offset"),u=t("has-hover"),A=t("has-passive-events"),T=t("../../lib").removeElement,e=t("../../plots/cartesian/constants"),i=P.exports={};i.align=t("./align"),i.getCursor=t("./cursor");var n=t("./unhover");i.unhover=n.wrapped,i.unhoverRaw=n.raw,i.init=function(o){var s=o.gd,m=1,g=s._context.doubleClickDelay,p=o.element,v,x,l,b,c,M,_,y;s._mouseDownTime||(s._mouseDownTime=0),p.style.pointerEvents="all",p.onmousedown=C,A?(p._ontouchstart&&p.removeEventListener("touchstart",p._ontouchstart),p._ontouchstart=C,p.addEventListener("touchstart",C,{passive:!1})):p.ontouchstart=C;function w(k,B,z){return Math.abs(k)<z&&(k=0),Math.abs(B)<z&&(B=0),[k,B]}var d=o.clampFn||w;function C(k){s._dragged=!1,s._dragging=!0;var B=r(k);v=B[0],x=B[1],_=k.target,M=k,y=k.buttons===2||k.ctrlKey,typeof k.clientX>"u"&&typeof k.clientY>"u"&&(k.clientX=v,k.clientY=x),l=new Date().getTime(),l-s._mouseDownTime<g?m+=1:(m=1,s._mouseDownTime=l),o.prepFn&&o.prepFn(k,v,x),u&&!y?(c=a(),c.style.cursor=window.getComputedStyle(p).cursor):u||(c=document,b=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(p).cursor),document.addEventListener("mouseup",E),document.addEventListener("touchend",E),o.dragmode!==!1&&(k.preventDefault(),document.addEventListener("mousemove",S),document.addEventListener("touchmove",S,{passive:!1}))}function S(k){k.preventDefault();var B=r(k),z=o.minDrag||e.MINDRAG,F=d(B[0]-v,B[1]-x,z),I=F[0],O=F[1];(I||O)&&(s._dragged=!0,i.unhover(s,k)),s._dragged&&o.moveFn&&!y&&(s._dragdata={element:p,dx:I,dy:O},o.moveFn(I,O))}function E(k){if(delete s._dragdata,o.dragmode!==!1&&(k.preventDefault(),document.removeEventListener("mousemove",S),document.removeEventListener("touchmove",S)),document.removeEventListener("mouseup",E),document.removeEventListener("touchend",E),u?T(c):b&&(c.documentElement.style.cursor=b,b=null),!s._dragging){s._dragged=!1;return}if(s._dragging=!1,new Date().getTime()-s._mouseDownTime>g&&(m=Math.max(m-1,1)),s._dragged)o.doneFn&&o.doneFn();else if(o.clickFn&&o.clickFn(m,M),!y){var B;try{B=new MouseEvent("click",k)}catch{var z=r(k);B=document.createEvent("MouseEvents"),B.initMouseEvent("click",k.bubbles,k.cancelable,k.view,k.detail,k.screenX,k.screenY,z[0],z[1],k.ctrlKey,k.altKey,k.shiftKey,k.metaKey,k.button,k.relatedTarget)}_.dispatchEvent(B)}s._dragging=!1,s._dragged=!1}};function a(){var f=document.createElement("div");f.className="dragcover";var o=f.style;return o.position="fixed",o.left=0,o.right=0,o.top=0,o.bottom=0,o.zIndex=999999999,o.background="none",document.body.appendChild(f),f}i.coverSlip=a;function r(f){return h(f.changedTouches?f.changedTouches[0]:f,document.body)}},{"../../lib":515,"../../plots/cartesian/constants":573,"./align":383,"./cursor":384,"./unhover":387,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],387:[function(t,P,R){var h=t("../../lib/events"),u=t("../../lib/throttle"),A=t("../../lib/dom").getGraphDiv,T=t("../fx/constants"),e=P.exports={};e.wrapped=function(i,n,a){i=A(i),i._fullLayout&&u.clear(i._fullLayout._uid+T.HOVERID),e.raw(i,n,a)},e.raw=function(n,a){var r=n._fullLayout,f=n._hoverdata;a||(a={}),!(a.target&&!n._dragged&&h.triggerHandler(n,"plotly_beforehover",a)===!1)&&(r._hoverlayer.selectAll("g").remove(),r._hoverlayer.selectAll("line").remove(),r._hoverlayer.selectAll("circle").remove(),n._hoverdata=void 0,a.target&&f&&n.emit("plotly_unhover",{event:a,points:f}))}},{"../../lib/dom":503,"../../lib/events":504,"../../lib/throttle":542,"../fx/constants":401}],388:[function(t,P,R){R.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},R.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],389:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=u.numberFormat,T=t("fast-isnumeric"),e=t("tinycolor2"),i=t("../../registry"),n=t("../color"),a=t("../colorscale"),r=u.strTranslate,f=t("../../lib/svg_text_utils"),o=t("../../constants/xmlns_namespaces"),s=t("../../constants/alignment"),m=s.LINE_SPACING,g=t("../../constants/interactions").DESELECTDIM,p=t("../../traces/scatter/subtypes"),v=t("../../traces/scatter/make_bubble_size_func"),x=t("../../components/fx/helpers").appendArrayPointValue,l=P.exports={};l.font=function(me,_e,Se,De){u.isPlainObject(_e)&&(De=_e.color,Se=_e.size,_e=_e.family),_e&&me.style("font-family",_e),Se+1&&me.style("font-size",Se+"px"),De&&me.call(n.fill,De)},l.setPosition=function(me,_e,Se){me.attr("x",_e).attr("y",Se)},l.setSize=function(me,_e,Se){me.attr("width",_e).attr("height",Se)},l.setRect=function(me,_e,Se,De,Ie){me.call(l.setPosition,_e,Se).call(l.setSize,De,Ie)},l.translatePoint=function(me,_e,Se,De){var Ie=Se.c2p(me.x),Te=De.c2p(me.y);if(T(Ie)&&T(Te)&&_e.node())_e.node().nodeName==="text"?_e.attr("x",Ie).attr("y",Te):_e.attr("transform",r(Ie,Te));else return!1;return!0},l.translatePoints=function(me,_e,Se){me.each(function(De){var Ie=h.select(this);l.translatePoint(De,Ie,_e,Se)})},l.hideOutsideRangePoint=function(me,_e,Se,De,Ie,Te){_e.attr("display",Se.isPtWithinRange(me,Ie)&&De.isPtWithinRange(me,Te)?null:"none")},l.hideOutsideRangePoints=function(me,_e){if(!!_e._hasClipOnAxisFalse){var Se=_e.xaxis,De=_e.yaxis;me.each(function(Ie){var Te=Ie[0].trace,Ce=Te.xcalendar,He=Te.ycalendar,Xe=i.traceIs(Te,"bar-like")?".bartext":".point,.textpoint";me.selectAll(Xe).each(function(Be){l.hideOutsideRangePoint(Be,h.select(this),Se,De,Ce,He)})})}},l.crispRound=function(me,_e,Se){return!_e||!T(_e)?Se||0:me._context.staticPlot?_e:_e<1?1:Math.round(_e)},l.singleLineStyle=function(me,_e,Se,De,Ie){_e.style("fill","none");var Te=(((me||[])[0]||{}).trace||{}).line||{},Ce=Se||Te.width||0,He=Ie||Te.dash||"";n.stroke(_e,De||Te.color),l.dashLine(_e,He,Ce)},l.lineGroupStyle=function(me,_e,Se,De){me.style("fill","none").each(function(Ie){var Te=(((Ie||[])[0]||{}).trace||{}).line||{},Ce=_e||Te.width||0,He=De||Te.dash||"";h.select(this).call(n.stroke,Se||Te.color).call(l.dashLine,He,Ce)})},l.dashLine=function(me,_e,Se){Se=+Se||0,_e=l.dashStyle(_e,Se),me.style({"stroke-dasharray":_e,"stroke-width":Se+"px"})},l.dashStyle=function(me,_e){_e=+_e||1;var Se=Math.max(_e,3);return me==="solid"?me="":me==="dot"?me=Se+"px,"+Se+"px":me==="dash"?me=3*Se+"px,"+3*Se+"px":me==="longdash"?me=5*Se+"px,"+5*Se+"px":me==="dashdot"?me=3*Se+"px,"+Se+"px,"+Se+"px,"+Se+"px":me==="longdashdot"&&(me=5*Se+"px,"+2*Se+"px,"+Se+"px,"+2*Se+"px"),me};function b(me,_e,Se){var De=_e.fillpattern,Ie=De&&l.getPatternAttr(De.shape,0,"");if(Ie){var Te=l.getPatternAttr(De.bgcolor,0,null),Ce=l.getPatternAttr(De.fgcolor,0,null),He=De.fgopacity,Xe=l.getPatternAttr(De.size,0,8),Be=l.getPatternAttr(De.solidity,0,.3),Re=_e.uid;l.pattern(me,"point",Se,Re,Ie,Xe,Be,void 0,De.fillmode,Te,Ce,He)}else _e.fillcolor&&me.call(n.fill,_e.fillcolor)}l.singleFillStyle=function(me,_e){var Se=h.select(me.node()),De=Se.data(),Ie=((De[0]||[])[0]||{}).trace||{};b(me,Ie,_e)},l.fillGroupStyle=function(me,_e){me.style("stroke-width",0).each(function(Se){var De=h.select(this);Se[0].trace&&b(De,Se[0].trace,_e)})};var c=t("./symbol_defs");l.symbolNames=[],l.symbolFuncs=[],l.symbolBackOffs=[],l.symbolNeedLines={},l.symbolNoDot={},l.symbolNoFill={},l.symbolList=[],Object.keys(c).forEach(function(me){var _e=c[me],Se=_e.n;l.symbolList.push(Se,String(Se),me,Se+100,String(Se+100),me+"-open"),l.symbolNames[Se]=me,l.symbolFuncs[Se]=_e.f,l.symbolBackOffs[Se]=_e.backoff||0,_e.needLine&&(l.symbolNeedLines[Se]=!0),_e.noDot?l.symbolNoDot[Se]=!0:l.symbolList.push(Se+200,String(Se+200),me+"-dot",Se+300,String(Se+300),me+"-open-dot"),_e.noFill&&(l.symbolNoFill[Se]=!0)});var M=l.symbolNames.length,_="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";l.symbolNumber=function(me){if(T(me))me=+me;else if(typeof me=="string"){var _e=0;me.indexOf("-open")>0&&(_e=100,me=me.replace("-open","")),me.indexOf("-dot")>0&&(_e+=200,me=me.replace("-dot","")),me=l.symbolNames.indexOf(me),me>=0&&(me+=_e)}return me%100>=M||me>=400?0:Math.floor(Math.max(me,0))};function y(me,_e,Se,De){var Ie=me%100;return l.symbolFuncs[Ie](_e,Se,De)+(me>=200?_:"")}var w={x1:1,x2:0,y1:0,y2:0},d={x1:0,x2:0,y1:1,y2:0},C=A("~f"),S={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:w},horizontalreversed:{node:"linearGradient",attrs:w,reversed:!0},vertical:{node:"linearGradient",attrs:d},verticalreversed:{node:"linearGradient",attrs:d,reversed:!0}};l.gradient=function(me,_e,Se,De,Ie,Te){for(var Ce=Ie.length,He=S[De],Xe=new Array(Ce),Be=0;Be<Ce;Be++)He.reversed?Xe[Ce-1-Be]=[C((1-Ie[Be][0])*100),Ie[Be][1]]:Xe[Be]=[C(Ie[Be][0]*100),Ie[Be][1]];var Re=_e._fullLayout,We="g"+Re._uid+"-"+Se,vt=Re._defs.select(".gradients").selectAll("#"+We).data([De+Xe.join(";")],u.identity);vt.exit().remove(),vt.enter().append(He.node).each(function(){var Pt=h.select(this);He.attrs&&Pt.attr(He.attrs),Pt.attr("id",We);var Zt=Pt.selectAll("stop").data(Xe);Zt.exit().remove(),Zt.enter().append("stop"),Zt.each(function(zt){var At=e(zt[1]);h.select(this).attr({offset:zt[0]+"%","stop-color":n.tinyRGB(At),"stop-opacity":At.getAlpha()})})}),me.style(Te,te(We,_e)).style(Te+"-opacity",null),me.classed("gradient_filled",!0)},l.pattern=function(me,_e,Se,De,Ie,Te,Ce,He,Xe,Be,Re,We){var vt=_e==="legend";He&&(Xe==="overlay"?(Be=He,Re=n.contrast(Be)):(Be=void 0,Re=He));var Pt=Se._fullLayout,Zt="p"+Pt._uid+"-"+De,zt,At,Wt=function(Mt,Ht,Rt,Vt,Jt){return Vt+(Jt-Vt)*(Mt-Ht)/(Rt-Ht)},Bt,Ct,Ze,nt,Ye={},Ee=e(Re),Ge=n.tinyRGB(Ee),Je=Ee.getAlpha(),qe=We*Je;switch(Ie){case"/":zt=Te*Math.sqrt(2),At=Te*Math.sqrt(2),Bt="M-"+zt/4+","+At/4+"l"+zt/2+",-"+At/2+"M0,"+At+"L"+zt+",0M"+zt/4*3+","+At/4*5+"l"+zt/2+",-"+At/2,Ct=Ce*Te,nt="path",Ye={d:Bt,opacity:qe,stroke:Ge,"stroke-width":Ct+"px"};break;case"\\":zt=Te*Math.sqrt(2),At=Te*Math.sqrt(2),Bt="M"+zt/4*3+",-"+At/4+"l"+zt/2+","+At/2+"M0,0L"+zt+","+At+"M-"+zt/4+","+At/4*3+"l"+zt/2+","+At/2,Ct=Ce*Te,nt="path",Ye={d:Bt,opacity:qe,stroke:Ge,"stroke-width":Ct+"px"};break;case"x":zt=Te*Math.sqrt(2),At=Te*Math.sqrt(2),Bt="M-"+zt/4+","+At/4+"l"+zt/2+",-"+At/2+"M0,"+At+"L"+zt+",0M"+zt/4*3+","+At/4*5+"l"+zt/2+",-"+At/2+"M"+zt/4*3+",-"+At/4+"l"+zt/2+","+At/2+"M0,0L"+zt+","+At+"M-"+zt/4+","+At/4*3+"l"+zt/2+","+At/2,Ct=Te-Te*Math.sqrt(1-Ce),nt="path",Ye={d:Bt,opacity:qe,stroke:Ge,"stroke-width":Ct+"px"};break;case"|":zt=Te,At=Te,nt="path",Bt="M"+zt/2+",0L"+zt/2+","+At,Ct=Ce*Te,nt="path",Ye={d:Bt,opacity:qe,stroke:Ge,"stroke-width":Ct+"px"};break;case"-":zt=Te,At=Te,nt="path",Bt="M0,"+At/2+"L"+zt+","+At/2,Ct=Ce*Te,nt="path",Ye={d:Bt,opacity:qe,stroke:Ge,"stroke-width":Ct+"px"};break;case"+":zt=Te,At=Te,nt="path",Bt="M"+zt/2+",0L"+zt/2+","+At+"M0,"+At/2+"L"+zt+","+At/2,Ct=Te-Te*Math.sqrt(1-Ce),nt="path",Ye={d:Bt,opacity:qe,stroke:Ge,"stroke-width":Ct+"px"};break;case".":zt=Te,At=Te,Ce<Math.PI/4?Ze=Math.sqrt(Ce*Te*Te/Math.PI):Ze=Wt(Ce,Math.PI/4,1,Te/2,Te/Math.sqrt(2)),nt="circle",Ye={cx:zt/2,cy:At/2,r:Ze,opacity:qe,fill:Ge};break}var Tt=[Ie||"noSh",Be||"noBg",Re||"noFg",Te,Ce].join(";"),mt=Pt._defs.select(".patterns").selectAll("#"+Zt).data([Tt],u.identity);mt.exit().remove(),mt.enter().append("pattern").each(function(){var Mt=h.select(this);if(Mt.attr({id:Zt,width:zt+"px",height:At+"px",patternUnits:"userSpaceOnUse",patternTransform:vt?"scale(0.8)":""}),Be){var Ht=e(Be),Rt=n.tinyRGB(Ht),Vt=Ht.getAlpha(),Jt=Mt.selectAll("rect").data([0]);Jt.exit().remove(),Jt.enter().append("rect").attr({width:zt+"px",height:At+"px",fill:Rt,"fill-opacity":Vt})}var Yt=Mt.selectAll(nt).data([0]);Yt.exit().remove(),Yt.enter().append(nt).attr(Ye)}),me.style("fill",te(Zt,Se)).style("fill-opacity",null),me.classed("pattern_filled",!0)},l.initGradients=function(me){var _e=me._fullLayout,Se=u.ensureSingle(_e._defs,"g","gradients");Se.selectAll("linearGradient,radialGradient").remove(),h.select(me).selectAll(".gradient_filled").classed("gradient_filled",!1)},l.initPatterns=function(me){var _e=me._fullLayout,Se=u.ensureSingle(_e._defs,"g","patterns");Se.selectAll("pattern").remove(),h.select(me).selectAll(".pattern_filled").classed("pattern_filled",!1)},l.getPatternAttr=function(me,_e,Se){return me&&u.isArrayOrTypedArray(me)?_e<me.length?me[_e]:Se:me},l.pointStyle=function(me,_e,Se){if(!!me.size()){var De=l.makePointStyleFns(_e);me.each(function(Ie){l.singlePointStyle(Ie,h.select(this),_e,De,Se)})}},l.singlePointStyle=function(me,_e,Se,De,Ie){var Te=Se.marker,Ce=Te.line;if(_e.style("opacity",De.selectedOpacityFn?De.selectedOpacityFn(me):me.mo===void 0?Te.opacity:me.mo),De.ms2mrc){var He;me.ms==="various"||Te.size==="various"?He=3:He=De.ms2mrc(me.ms),me.mrc=He,De.selectedSizeFn&&(He=me.mrc=De.selectedSizeFn(me));var Xe=l.symbolNumber(me.mx||Te.symbol)||0;me.om=Xe%200>=100;var Be=be(me,Se),Re=ee(me,Se);_e.attr("d",y(Xe,He,Be,Re))}var We=!1,vt,Pt,Zt;if(me.so)Zt=Ce.outlierwidth,Pt=Ce.outliercolor,vt=Te.outliercolor;else{var zt=(Ce||{}).width;Zt=(me.mlw+1||zt+1||(me.trace?(me.trace.marker.line||{}).width:0)+1)-1||0,"mlc"in me?Pt=me.mlcc=De.lineScale(me.mlc):u.isArrayOrTypedArray(Ce.color)?Pt=n.defaultLine:Pt=Ce.color,u.isArrayOrTypedArray(Te.color)&&(vt=n.defaultLine,We=!0),"mc"in me?vt=me.mcc=De.markerScale(me.mc):vt=Te.color||"rgba(0,0,0,0)",De.selectedColorFn&&(vt=De.selectedColorFn(me))}if(me.om)_e.call(n.stroke,vt).style({"stroke-width":(Zt||1)+"px",fill:"none"});else{_e.style("stroke-width",(me.isBlank?0:Zt)+"px");var At=Te.gradient,Wt=me.mgt;Wt?We=!0:Wt=At&&At.type,u.isArrayOrTypedArray(Wt)&&(Wt=Wt[0],S[Wt]||(Wt=0));var Bt=Te.pattern,Ct=Bt&&l.getPatternAttr(Bt.shape,me.i,"");if(Wt&&Wt!=="none"){var Ze=me.mgc;Ze?We=!0:Ze=At.color;var nt=Se.uid;We&&(nt+="-"+me.i),l.gradient(_e,Ie,nt,Wt,[[0,Ze],[1,vt]],"fill")}else if(Ct){var Ye=l.getPatternAttr(Bt.bgcolor,me.i,null),Ee=l.getPatternAttr(Bt.fgcolor,me.i,null),Ge=Bt.fgopacity,Je=l.getPatternAttr(Bt.size,me.i,8),qe=l.getPatternAttr(Bt.solidity,me.i,.3),Tt=me.mcc||u.isArrayOrTypedArray(Bt.shape)||u.isArrayOrTypedArray(Bt.bgcolor)||u.isArrayOrTypedArray(Bt.size)||u.isArrayOrTypedArray(Bt.solidity),mt=Se.uid;Tt&&(mt+="-"+me.i),l.pattern(_e,"point",Ie,mt,Ct,Je,qe,me.mcc,Bt.fillmode,Ye,Ee,Ge)}else n.fill(_e,vt);Zt&&n.stroke(_e,Pt)}},l.makePointStyleFns=function(me){var _e={},Se=me.marker;return _e.markerScale=l.tryColorscale(Se,""),_e.lineScale=l.tryColorscale(Se,"line"),i.traceIs(me,"symbols")&&(_e.ms2mrc=p.isBubble(me)?v(me):function(){return(Se.size||6)/2}),me.selectedpoints&&u.extendFlat(_e,l.makeSelectedPointStyleFns(me)),_e},l.makeSelectedPointStyleFns=function(me){var _e={},Se=me.selected||{},De=me.unselected||{},Ie=me.marker||{},Te=Se.marker||{},Ce=De.marker||{},He=Ie.opacity,Xe=Te.opacity,Be=Ce.opacity,Re=Xe!==void 0,We=Be!==void 0;(u.isArrayOrTypedArray(He)||Re||We)&&(_e.selectedOpacityFn=function(Ze){var nt=Ze.mo===void 0?Ie.opacity:Ze.mo;return Ze.selected?Re?Xe:nt:We?Be:g*nt});var vt=Ie.color,Pt=Te.color,Zt=Ce.color;(Pt||Zt)&&(_e.selectedColorFn=function(Ze){var nt=Ze.mcc||vt;return Ze.selected?Pt||nt:Zt||nt});var zt=Ie.size,At=Te.size,Wt=Ce.size,Bt=At!==void 0,Ct=Wt!==void 0;return i.traceIs(me,"symbols")&&(Bt||Ct)&&(_e.selectedSizeFn=function(Ze){var nt=Ze.mrc||zt/2;return Ze.selected?Bt?At/2:nt:Ct?Wt/2:nt}),_e},l.makeSelectedTextStyleFns=function(me){var _e={},Se=me.selected||{},De=me.unselected||{},Ie=me.textfont||{},Te=Se.textfont||{},Ce=De.textfont||{},He=Ie.color,Xe=Te.color,Be=Ce.color;return _e.selectedTextColorFn=function(Re){var We=Re.tc||He;return Re.selected?Xe||We:Be||(Xe?We:n.addOpacity(We,g))},_e},l.selectedPointStyle=function(me,_e){if(!(!me.size()||!_e.selectedpoints)){var Se=l.makeSelectedPointStyleFns(_e),De=_e.marker||{},Ie=[];Se.selectedOpacityFn&&Ie.push(function(Te,Ce){Te.style("opacity",Se.selectedOpacityFn(Ce))}),Se.selectedColorFn&&Ie.push(function(Te,Ce){n.fill(Te,Se.selectedColorFn(Ce))}),Se.selectedSizeFn&&Ie.push(function(Te,Ce){var He=Ce.mx||De.symbol||0,Xe=Se.selectedSizeFn(Ce);Te.attr("d",y(l.symbolNumber(He),Xe,be(Ce,_e),ee(Ce,_e))),Ce.mrc2=Xe}),Ie.length&&me.each(function(Te){for(var Ce=h.select(this),He=0;He<Ie.length;He++)Ie[He](Ce,Te)})}},l.tryColorscale=function(me,_e){var Se=_e?u.nestedProperty(me,_e).get():me;if(Se){var De=Se.color;if((Se.colorscale||Se._colorAx)&&u.isArrayOrTypedArray(De))return a.makeColorScaleFuncFromTrace(Se)}return u.identity};var E={start:1,end:-1,middle:0,bottom:1,top:-1};function k(me,_e,Se,De,Ie){var Te=h.select(me.node().parentNode),Ce=_e.indexOf("top")!==-1?"top":_e.indexOf("bottom")!==-1?"bottom":"middle",He=_e.indexOf("left")!==-1?"end":_e.indexOf("right")!==-1?"start":"middle",Xe=De?De/.8+1:0,Be=(f.lineCount(me)-1)*m+1,Re=E[He]*Xe,We=Se*.75+E[Ce]*Xe+(E[Ce]-1)*Be*Se/2;me.attr("text-anchor",He),Ie||Te.attr("transform",r(Re,We))}function B(me,_e){var Se=me.ts||_e.textfont.size;return T(Se)&&Se>0?Se:0}l.textPointStyle=function(me,_e,Se){if(!!me.size()){var De;if(_e.selectedpoints){var Ie=l.makeSelectedTextStyleFns(_e);De=Ie.selectedTextColorFn}var Te=_e.texttemplate,Ce=Se._fullLayout;me.each(function(He){var Xe=h.select(this),Be=Te?u.extractOption(He,_e,"txt","texttemplate"):u.extractOption(He,_e,"tx","text");if(!Be&&Be!==0){Xe.remove();return}if(Te){var Re=_e._module.formatLabels,We=Re?Re(He,_e,Ce):{},vt={};x(vt,_e,He.i);var Pt=_e._meta||{};Be=u.texttemplateString(Be,We,Ce._d3locale,vt,He,Pt)}var Zt=He.tp||_e.textposition,zt=B(He,_e),At=De?De(He):He.tc||_e.textfont.color;Xe.call(l.font,He.tf||_e.textfont.family,zt,At).text(Be).call(f.convertToTspans,Se).call(k,Zt,zt,He.mrc)})}},l.selectedTextStyle=function(me,_e){if(!(!me.size()||!_e.selectedpoints)){var Se=l.makeSelectedTextStyleFns(_e);me.each(function(De){var Ie=h.select(this),Te=Se.selectedTextColorFn(De),Ce=De.tp||_e.textposition,He=B(De,_e);n.fill(Ie,Te);var Xe=i.traceIs(_e,"bar-like");k(Ie,Ce,He,De.mrc2||De.mrc,Xe)})}};var z=.5;l.smoothopen=function(me,_e){if(me.length<3)return"M"+me.join("L");var Se="M"+me[0],De=[],Ie;for(Ie=1;Ie<me.length-1;Ie++)De.push(H(me[Ie-1],me[Ie],me[Ie+1],_e));for(Se+="Q"+De[0][0]+" "+me[1],Ie=2;Ie<me.length-1;Ie++)Se+="C"+De[Ie-2][1]+" "+De[Ie-1][0]+" "+me[Ie];return Se+="Q"+De[me.length-3][1]+" "+me[me.length-1],Se},l.smoothclosed=function(me,_e){if(me.length<3)return"M"+me.join("L")+"Z";var Se="M"+me[0],De=me.length-1,Ie=[H(me[De],me[0],me[1],_e)],Te;for(Te=1;Te<De;Te++)Ie.push(H(me[Te-1],me[Te],me[Te+1],_e));for(Ie.push(H(me[De-1],me[De],me[0],_e)),Te=1;Te<=De;Te++)Se+="C"+Ie[Te-1][1]+" "+Ie[Te][0]+" "+me[Te];return Se+="C"+Ie[De][1]+" "+Ie[0][0]+" "+me[0]+"Z",Se};var F,I;function O(me,_e,Se){return Se&&(me=X(me)),_e?V(me[1]):N(me[0])}function N(me){var _e=h.round(me,2);return F=_e,_e}function V(me){var _e=h.round(me,2);return I=_e,_e}function H(me,_e,Se,De){var Ie=me[0]-_e[0],Te=me[1]-_e[1],Ce=Se[0]-_e[0],He=Se[1]-_e[1],Xe=Math.pow(Ie*Ie+Te*Te,z/2),Be=Math.pow(Ce*Ce+He*He,z/2),Re=(Be*Be*Ie-Xe*Xe*Ce)*De,We=(Be*Be*Te-Xe*Xe*He)*De,vt=3*Be*(Xe+Be),Pt=3*Xe*(Xe+Be);return[[N(_e[0]+(vt&&Re/vt)),V(_e[1]+(vt&&We/vt))],[N(_e[0]-(Pt&&Re/Pt)),V(_e[1]-(Pt&&We/Pt))]]}var j={hv:function(me,_e,Se){return"H"+N(_e[0])+"V"+O(_e,1,Se)},vh:function(me,_e,Se){return"V"+V(_e[1])+"H"+O(_e,0,Se)},hvh:function(me,_e,Se){return"H"+N((me[0]+_e[0])/2)+"V"+V(_e[1])+"H"+O(_e,0,Se)},vhv:function(me,_e,Se){return"V"+V((me[1]+_e[1])/2)+"H"+N(_e[0])+"V"+O(_e,1,Se)}},Z=function(me,_e,Se){return"L"+O(_e,0,Se)+","+O(_e,1,Se)};l.steps=function(me){var _e=j[me]||Z;return function(Se){for(var De="M"+N(Se[0][0])+","+V(Se[0][1]),Ie=Se.length,Te=1;Te<Ie;Te++)De+=_e(Se[Te-1],Se[Te],Te===Ie-1);return De}};function X(me,_e){var Se=me.backoff,De=me.trace,Ie=me.d,Te=me.i;if(Se&&De&&De.marker&&De.marker.angle%360===0&&De.line&&De.line.shape!=="spline"){var Ce=u.isArrayOrTypedArray(Se),He=me,Xe=_e?_e[0]:F||0,Be=_e?_e[1]:I||0,Re=He[0],We=He[1],vt=Re-Xe,Pt=We-Be,Zt=Math.atan2(Pt,vt),zt=Ce?Se[Te]:Se;if(zt==="auto"){var At=He.i;De.type==="scatter"&&At--;var Wt=He.marker;zt=Wt?l.symbolBackOffs[l.symbolNumber(Wt.symbol)]*Wt.size:0,zt+=l.getMarkerStandoff(Ie[At],De)||0}var Bt=Re-zt*Math.cos(Zt),Ct=We-zt*Math.sin(Zt);(Bt<=Re&&Bt>=Xe||Bt>=Re&&Bt<=Xe)&&(Ct<=We&&Ct>=Be||Ct>=We&&Ct<=Be)&&(me=[Bt,Ct])}return me}l.applyBackoff=X,l.makeTester=function(){var me=u.ensureSingleById(h.select("body"),"svg","js-plotly-tester",function(Se){Se.attr(o.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),_e=u.ensureSingle(me,"path","js-reference-point",function(Se){Se.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});l.tester=me,l.testref=_e},l.savedBBoxes={};var re=0,ue=1e4;l.bBox=function(me,_e,Se){Se||(Se=K(me));var De;if(Se){if(De=l.savedBBoxes[Se],De)return u.extendFlat({},De)}else if(me.childNodes.length===1){var Ie=me.childNodes[0];if(Se=K(Ie),Se){var Te=+Ie.getAttribute("x")||0,Ce=+Ie.getAttribute("y")||0,He=Ie.getAttribute("transform");if(!He){var Xe=l.bBox(Ie,!1,Se);return Te&&(Xe.left+=Te,Xe.right+=Te),Ce&&(Xe.top+=Ce,Xe.bottom+=Ce),Xe}if(Se+="~"+Te+"~"+Ce+"~"+He,De=l.savedBBoxes[Se],De)return u.extendFlat({},De)}}var Be,Re;_e?Be=me:(Re=l.tester.node(),Be=me.cloneNode(!0),Re.appendChild(Be)),h.select(Be).attr("transform",null).call(f.positionText,0,0);var We=Be.getBoundingClientRect(),vt=l.testref.node().getBoundingClientRect();_e||Re.removeChild(Be);var Pt={height:We.height,width:We.width,left:We.left-vt.left,top:We.top-vt.top,right:We.right-vt.left,bottom:We.bottom-vt.top};return re>=ue&&(l.savedBBoxes={},re=0),Se&&(l.savedBBoxes[Se]=Pt),re++,u.extendFlat({},Pt)};function K(me){var _e=me.getAttribute("data-unformatted");if(_e!==null)return _e+me.getAttribute("data-math")+me.getAttribute("text-anchor")+me.getAttribute("style")}l.setClipUrl=function(me,_e,Se){me.attr("clip-path",te(_e,Se))};function te(me,_e){if(!me)return null;var Se=_e._context,De=Se._exportedPlot?"":Se._baseUrl||"";return De?"url('"+De+"#"+me+"')":"url(#"+me+")"}l.getTranslate=function(me){var _e=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,Se=me.attr?"attr":"getAttribute",De=me[Se]("transform")||"",Ie=De.replace(_e,function(Te,Ce,He){return[Ce,He].join(" ")}).split(" ");return{x:+Ie[0]||0,y:+Ie[1]||0}},l.setTranslate=function(me,_e,Se){var De=/(\btranslate\(.*?\);?)/,Ie=me.attr?"attr":"getAttribute",Te=me.attr?"attr":"setAttribute",Ce=me[Ie]("transform")||"";return _e=_e||0,Se=Se||0,Ce=Ce.replace(De,"").trim(),Ce+=r(_e,Se),Ce=Ce.trim(),me[Te]("transform",Ce),Ce},l.getScale=function(me){var _e=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,Se=me.attr?"attr":"getAttribute",De=me[Se]("transform")||"",Ie=De.replace(_e,function(Te,Ce,He){return[Ce,He].join(" ")}).split(" ");return{x:+Ie[0]||1,y:+Ie[1]||1}},l.setScale=function(me,_e,Se){var De=/(\bscale\(.*?\);?)/,Ie=me.attr?"attr":"getAttribute",Te=me.attr?"attr":"setAttribute",Ce=me[Ie]("transform")||"";return _e=_e||1,Se=Se||1,Ce=Ce.replace(De,"").trim(),Ce+="scale("+_e+","+Se+")",Ce=Ce.trim(),me[Te]("transform",Ce),Ce};var G=/\s*sc.*/;l.setPointGroupScale=function(me,_e,Se){if(_e=_e||1,Se=Se||1,!!me){var De=_e===1&&Se===1?"":"scale("+_e+","+Se+")";me.each(function(){var Ie=(this.getAttribute("transform")||"").replace(G,"");Ie+=De,Ie=Ie.trim(),this.setAttribute("transform",Ie)})}};var Y=/translate\([^)]*\)\s*$/;l.setTextPointsScale=function(me,_e,Se){!me||me.each(function(){var De,Ie=h.select(this),Te=Ie.select("text");if(!!Te.node()){var Ce=parseFloat(Te.attr("x")||0),He=parseFloat(Te.attr("y")||0),Xe=(Ie.attr("transform")||"").match(Y);_e===1&&Se===1?De=[]:De=[r(Ce,He),"scale("+_e+","+Se+")",r(-Ce,-He)],Xe&&De.push(Xe),Ie.attr("transform",De.join(""))}})};function ee(me,_e){var Se;return me&&(Se=me.mf),Se===void 0&&(Se=_e.marker&&_e.marker.standoff||0),!_e._geo&&!_e._xA?-Se:Se}l.getMarkerStandoff=ee;var ne=Math.atan2,J=Math.cos,q=Math.sin;function ae(me,_e){var Se=_e[0],De=_e[1];return[Se*J(me)-De*q(me),Se*q(me)+De*J(me)]}var le,ie,se,xe,oe,he;function be(me,_e){var Se=me.ma;Se===void 0&&(Se=_e.marker.angle||0);var De,Ie,Te=_e.marker.angleref;if(Te==="previous"||Te==="north"){if(_e._geo){var Ce=_e._geo.project(me.lonlat);De=Ce[0],Ie=Ce[1]}else{var He=_e._xA,Xe=_e._yA;if(He&&Xe)De=He.c2p(me.x),Ie=Xe.c2p(me.y);else return 90}if(_e._geo){var Be=me.lonlat[0],Re=me.lonlat[1],We=_e._geo.project([Be,Re+1e-5]),vt=_e._geo.project([Be+1e-5,Re]),Pt=ne(vt[1]-Ie,vt[0]-De),Zt=ne(We[1]-Ie,We[0]-De),zt;if(Te==="north")zt=Se/180*Math.PI;else if(Te==="previous"){var At=Be/180*Math.PI,Wt=Re/180*Math.PI,Bt=le/180*Math.PI,Ct=ie/180*Math.PI,Ze=Bt-At,nt=J(Ct)*q(Ze),Ye=q(Ct)*J(Wt)-J(Ct)*q(Wt)*J(Ze);zt=-ne(nt,Ye)-Math.PI,le=Be,ie=Re}var Ee=ae(Pt,[J(zt),0]),Ge=ae(Zt,[q(zt),0]);Se=ne(Ee[1]+Ge[1],Ee[0]+Ge[0])/Math.PI*180,Te==="previous"&&!(he===_e.uid&&me.i===oe+1)&&(Se=null)}if(Te==="previous"&&!_e._geo)if(he===_e.uid&&me.i===oe+1&&T(De)&&T(Ie)){var Je=De-se,qe=Ie-xe,Tt=_e.line&&_e.line.shape||"",mt=Tt.slice(Tt.length-1);mt==="h"&&(qe=0),mt==="v"&&(Je=0),Se+=ne(qe,Je)/Math.PI*180+90}else Se=null}return se=De,xe=Ie,oe=me.i,he=_e.uid,Se}l.getMarkerAngle=be},{"../../components/fx/helpers":403,"../../constants/alignment":483,"../../constants/interactions":490,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../registry":647,"../../traces/scatter/make_bubble_size_func":953,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale":379,"./symbol_defs":390,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],390:[function(t,P,R){var h=t("parse-svg-path"),u=t("@plotly/d3").round,A="M0,0Z",T=Math.sqrt(2),e=Math.sqrt(3),i=Math.PI,n=Math.cos,a=Math.sin;P.exports={circle:{n:0,f:function(p,v,x){if(r(v))return A;var l=u(p,2),b="M"+l+",0A"+l+","+l+" 0 1,1 0,-"+l+"A"+l+","+l+" 0 0,1 "+l+",0Z";return x?g(v,x,b):b}},square:{n:1,f:function(p,v,x){if(r(v))return A;var l=u(p,2);return g(v,x,"M"+l+","+l+"H-"+l+"V-"+l+"H"+l+"Z")}},diamond:{n:2,f:function(p,v,x){if(r(v))return A;var l=u(p*1.3,2);return g(v,x,"M"+l+",0L0,"+l+"L-"+l+",0L0,-"+l+"Z")}},cross:{n:3,f:function(p,v,x){if(r(v))return A;var l=u(p*.4,2),b=u(p*1.2,2);return g(v,x,"M"+b+","+l+"H"+l+"V"+b+"H-"+l+"V"+l+"H-"+b+"V-"+l+"H-"+l+"V-"+b+"H"+l+"V-"+l+"H"+b+"Z")}},x:{n:4,f:function(p,v,x){if(r(v))return A;var l=u(p*.8/T,2),b="l"+l+","+l,c="l"+l+",-"+l,M="l-"+l+",-"+l,_="l-"+l+","+l;return g(v,x,"M0,"+l+b+c+M+c+M+_+M+_+b+_+b+"Z")}},"triangle-up":{n:5,f:function(p,v,x){if(r(v))return A;var l=u(p*2/e,2),b=u(p/2,2),c=u(p,2);return g(v,x,"M-"+l+","+b+"H"+l+"L0,-"+c+"Z")}},"triangle-down":{n:6,f:function(p,v,x){if(r(v))return A;var l=u(p*2/e,2),b=u(p/2,2),c=u(p,2);return g(v,x,"M-"+l+",-"+b+"H"+l+"L0,"+c+"Z")}},"triangle-left":{n:7,f:function(p,v,x){if(r(v))return A;var l=u(p*2/e,2),b=u(p/2,2),c=u(p,2);return g(v,x,"M"+b+",-"+l+"V"+l+"L-"+c+",0Z")}},"triangle-right":{n:8,f:function(p,v,x){if(r(v))return A;var l=u(p*2/e,2),b=u(p/2,2),c=u(p,2);return g(v,x,"M-"+b+",-"+l+"V"+l+"L"+c+",0Z")}},"triangle-ne":{n:9,f:function(p,v,x){if(r(v))return A;var l=u(p*.6,2),b=u(p*1.2,2);return g(v,x,"M-"+b+",-"+l+"H"+l+"V"+b+"Z")}},"triangle-se":{n:10,f:function(p,v,x){if(r(v))return A;var l=u(p*.6,2),b=u(p*1.2,2);return g(v,x,"M"+l+",-"+b+"V"+l+"H-"+b+"Z")}},"triangle-sw":{n:11,f:function(p,v,x){if(r(v))return A;var l=u(p*.6,2),b=u(p*1.2,2);return g(v,x,"M"+b+","+l+"H-"+l+"V-"+b+"Z")}},"triangle-nw":{n:12,f:function(p,v,x){if(r(v))return A;var l=u(p*.6,2),b=u(p*1.2,2);return g(v,x,"M-"+l+","+b+"V-"+l+"H"+b+"Z")}},pentagon:{n:13,f:function(p,v,x){if(r(v))return A;var l=u(p*.951,2),b=u(p*.588,2),c=u(-p,2),M=u(p*-.309,2),_=u(p*.809,2);return g(v,x,"M"+l+","+M+"L"+b+","+_+"H-"+b+"L-"+l+","+M+"L0,"+c+"Z")}},hexagon:{n:14,f:function(p,v,x){if(r(v))return A;var l=u(p,2),b=u(p/2,2),c=u(p*e/2,2);return g(v,x,"M"+c+",-"+b+"V"+b+"L0,"+l+"L-"+c+","+b+"V-"+b+"L0,-"+l+"Z")}},hexagon2:{n:15,f:function(p,v,x){if(r(v))return A;var l=u(p,2),b=u(p/2,2),c=u(p*e/2,2);return g(v,x,"M-"+b+","+c+"H"+b+"L"+l+",0L"+b+",-"+c+"H-"+b+"L-"+l+",0Z")}},octagon:{n:16,f:function(p,v,x){if(r(v))return A;var l=u(p*.924,2),b=u(p*.383,2);return g(v,x,"M-"+b+",-"+l+"H"+b+"L"+l+",-"+b+"V"+b+"L"+b+","+l+"H-"+b+"L-"+l+","+b+"V-"+b+"Z")}},star:{n:17,f:function(p,v,x){if(r(v))return A;var l=p*1.4,b=u(l*.225,2),c=u(l*.951,2),M=u(l*.363,2),_=u(l*.588,2),y=u(-l,2),w=u(l*-.309,2),d=u(l*.118,2),C=u(l*.809,2),S=u(l*.382,2);return g(v,x,"M"+b+","+w+"H"+c+"L"+M+","+d+"L"+_+","+C+"L0,"+S+"L-"+_+","+C+"L-"+M+","+d+"L-"+c+","+w+"H-"+b+"L0,"+y+"Z")}},hexagram:{n:18,f:function(p,v,x){if(r(v))return A;var l=u(p*.66,2),b=u(p*.38,2),c=u(p*.76,2);return g(v,x,"M-"+c+",0l-"+b+",-"+l+"h"+c+"l"+b+",-"+l+"l"+b+","+l+"h"+c+"l-"+b+","+l+"l"+b+","+l+"h-"+c+"l-"+b+","+l+"l-"+b+",-"+l+"h-"+c+"Z")}},"star-triangle-up":{n:19,f:function(p,v,x){if(r(v))return A;var l=u(p*e*.8,2),b=u(p*.8,2),c=u(p*1.6,2),M=u(p*4,2),_="A "+M+","+M+" 0 0 1 ";return g(v,x,"M-"+l+","+b+_+l+","+b+_+"0,-"+c+_+"-"+l+","+b+"Z")}},"star-triangle-down":{n:20,f:function(p,v,x){if(r(v))return A;var l=u(p*e*.8,2),b=u(p*.8,2),c=u(p*1.6,2),M=u(p*4,2),_="A "+M+","+M+" 0 0 1 ";return g(v,x,"M"+l+",-"+b+_+"-"+l+",-"+b+_+"0,"+c+_+l+",-"+b+"Z")}},"star-square":{n:21,f:function(p,v,x){if(r(v))return A;var l=u(p*1.1,2),b=u(p*2,2),c="A "+b+","+b+" 0 0 1 ";return g(v,x,"M-"+l+",-"+l+c+"-"+l+","+l+c+l+","+l+c+l+",-"+l+c+"-"+l+",-"+l+"Z")}},"star-diamond":{n:22,f:function(p,v,x){if(r(v))return A;var l=u(p*1.4,2),b=u(p*1.9,2),c="A "+b+","+b+" 0 0 1 ";return g(v,x,"M-"+l+",0"+c+"0,"+l+c+l+",0"+c+"0,-"+l+c+"-"+l+",0Z")}},"diamond-tall":{n:23,f:function(p,v,x){if(r(v))return A;var l=u(p*.7,2),b=u(p*1.4,2);return g(v,x,"M0,"+b+"L"+l+",0L0,-"+b+"L-"+l+",0Z")}},"diamond-wide":{n:24,f:function(p,v,x){if(r(v))return A;var l=u(p*1.4,2),b=u(p*.7,2);return g(v,x,"M0,"+b+"L"+l+",0L0,-"+b+"L-"+l+",0Z")}},hourglass:{n:25,f:function(p,v,x){if(r(v))return A;var l=u(p,2);return g(v,x,"M"+l+","+l+"H-"+l+"L"+l+",-"+l+"H-"+l+"Z")},noDot:!0},bowtie:{n:26,f:function(p,v,x){if(r(v))return A;var l=u(p,2);return g(v,x,"M"+l+","+l+"V-"+l+"L-"+l+","+l+"V-"+l+"Z")},noDot:!0},"circle-cross":{n:27,f:function(p,v,x){if(r(v))return A;var l=u(p,2);return g(v,x,"M0,"+l+"V-"+l+"M"+l+",0H-"+l+"M"+l+",0A"+l+","+l+" 0 1,1 0,-"+l+"A"+l+","+l+" 0 0,1 "+l+",0Z")},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(p,v,x){if(r(v))return A;var l=u(p,2),b=u(p/T,2);return g(v,x,"M"+b+","+b+"L-"+b+",-"+b+"M"+b+",-"+b+"L-"+b+","+b+"M"+l+",0A"+l+","+l+" 0 1,1 0,-"+l+"A"+l+","+l+" 0 0,1 "+l+",0Z")},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(p,v,x){if(r(v))return A;var l=u(p,2);return g(v,x,"M0,"+l+"V-"+l+"M"+l+",0H-"+l+"M"+l+","+l+"H-"+l+"V-"+l+"H"+l+"Z")},needLine:!0,noDot:!0},"square-x":{n:30,f:function(p,v,x){if(r(v))return A;var l=u(p,2);return g(v,x,"M"+l+","+l+"L-"+l+",-"+l+"M"+l+",-"+l+"L-"+l+","+l+"M"+l+","+l+"H-"+l+"V-"+l+"H"+l+"Z")},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(p,v,x){if(r(v))return A;var l=u(p*1.3,2);return g(v,x,"M"+l+",0L0,"+l+"L-"+l+",0L0,-"+l+"ZM0,-"+l+"V"+l+"M-"+l+",0H"+l)},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(p,v,x){if(r(v))return A;var l=u(p*1.3,2),b=u(p*.65,2);return g(v,x,"M"+l+",0L0,"+l+"L-"+l+",0L0,-"+l+"ZM-"+b+",-"+b+"L"+b+","+b+"M-"+b+","+b+"L"+b+",-"+b)},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(p,v,x){if(r(v))return A;var l=u(p*1.4,2);return g(v,x,"M0,"+l+"V-"+l+"M"+l+",0H-"+l)},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(p,v,x){if(r(v))return A;var l=u(p,2);return g(v,x,"M"+l+","+l+"L-"+l+",-"+l+"M"+l+",-"+l+"L-"+l+","+l)},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(p,v,x){if(r(v))return A;var l=u(p*1.2,2),b=u(p*.85,2);return g(v,x,"M0,"+l+"V-"+l+"M"+l+",0H-"+l+"M"+b+","+b+"L-"+b+",-"+b+"M"+b+",-"+b+"L-"+b+","+b)},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(p,v,x){if(r(v))return A;var l=u(p/2,2),b=u(p,2);return g(v,x,"M"+l+","+b+"V-"+b+"M"+(l-b)+",-"+b+"V"+b+"M"+b+","+l+"H-"+b+"M-"+b+","+(l-b)+"H"+b)},needLine:!0,noFill:!0},"y-up":{n:37,f:function(p,v,x){if(r(v))return A;var l=u(p*1.2,2),b=u(p*1.6,2),c=u(p*.8,2);return g(v,x,"M-"+l+","+c+"L0,0M"+l+","+c+"L0,0M0,-"+b+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(p,v,x){if(r(v))return A;var l=u(p*1.2,2),b=u(p*1.6,2),c=u(p*.8,2);return g(v,x,"M-"+l+",-"+c+"L0,0M"+l+",-"+c+"L0,0M0,"+b+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(p,v,x){if(r(v))return A;var l=u(p*1.2,2),b=u(p*1.6,2),c=u(p*.8,2);return g(v,x,"M"+c+","+l+"L0,0M"+c+",-"+l+"L0,0M-"+b+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(p,v,x){if(r(v))return A;var l=u(p*1.2,2),b=u(p*1.6,2),c=u(p*.8,2);return g(v,x,"M-"+c+","+l+"L0,0M-"+c+",-"+l+"L0,0M"+b+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(p,v,x){if(r(v))return A;var l=u(p*1.4,2);return g(v,x,"M"+l+",0H-"+l)},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(p,v,x){if(r(v))return A;var l=u(p*1.4,2);return g(v,x,"M0,"+l+"V-"+l)},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(p,v,x){if(r(v))return A;var l=u(p,2);return g(v,x,"M"+l+",-"+l+"L-"+l+","+l)},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(p,v,x){if(r(v))return A;var l=u(p,2);return g(v,x,"M"+l+","+l+"L-"+l+",-"+l)},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(p,v,x){if(r(v))return A;var l=u(p,2),b=u(p*2,2);return g(v,x,"M0,0L-"+l+","+b+"H"+l+"Z")},backoff:1,noDot:!0},"arrow-down":{n:46,f:function(p,v,x){if(r(v))return A;var l=u(p,2),b=u(p*2,2);return g(v,x,"M0,0L-"+l+",-"+b+"H"+l+"Z")},noDot:!0},"arrow-left":{n:47,f:function(p,v,x){if(r(v))return A;var l=u(p*2,2),b=u(p,2);return g(v,x,"M0,0L"+l+",-"+b+"V"+b+"Z")},noDot:!0},"arrow-right":{n:48,f:function(p,v,x){if(r(v))return A;var l=u(p*2,2),b=u(p,2);return g(v,x,"M0,0L-"+l+",-"+b+"V"+b+"Z")},noDot:!0},"arrow-bar-up":{n:49,f:function(p,v,x){if(r(v))return A;var l=u(p,2),b=u(p*2,2);return g(v,x,"M-"+l+",0H"+l+"M0,0L-"+l+","+b+"H"+l+"Z")},backoff:1,needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(p,v,x){if(r(v))return A;var l=u(p,2),b=u(p*2,2);return g(v,x,"M-"+l+",0H"+l+"M0,0L-"+l+",-"+b+"H"+l+"Z")},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(p,v,x){if(r(v))return A;var l=u(p*2,2),b=u(p,2);return g(v,x,"M0,-"+b+"V"+b+"M0,0L"+l+",-"+b+"V"+b+"Z")},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(p,v,x){if(r(v))return A;var l=u(p*2,2),b=u(p,2);return g(v,x,"M0,-"+b+"V"+b+"M0,0L-"+l+",-"+b+"V"+b+"Z")},needLine:!0,noDot:!0},arrow:{n:53,f:function(p,v,x){if(r(v))return A;var l=i/2.5,b=2*p*n(l),c=2*p*a(l);return g(v,x,"M0,0L"+-b+","+c+"L"+b+","+c+"Z")},backoff:.9,noDot:!0},"arrow-wide":{n:54,f:function(p,v,x){if(r(v))return A;var l=i/4,b=2*p*n(l),c=2*p*a(l);return g(v,x,"M0,0L"+-b+","+c+"A "+2*p+","+2*p+" 0 0 1 "+b+","+c+"Z")},backoff:.4,noDot:!0}};function r(p){return p===null}var f,o,s,m;function g(p,v,x){if((!p||p%360===0)&&!v)return x;if(s===p&&m===v&&f===x)return o;s=p,m=v,f=x;function l(z,F){var I=n(z),O=a(z),N=F[0],V=F[1]+(v||0);return[N*I-V*O,N*O+V*I]}for(var b=p/180*i,c=0,M=0,_=h(x),y="",w=0;w<_.length;w++){var d=_[w],C=d[0],S=c,E=M;if(C==="M"||C==="L")c=+d[1],M=+d[2];else if(C==="m"||C==="l")c+=+d[1],M+=+d[2];else if(C==="H")c=+d[1];else if(C==="h")c+=+d[1];else if(C==="V")M=+d[1];else if(C==="v")M+=+d[1];else if(C==="A"){c=+d[1],M=+d[2];var k=l(b,[+d[6],+d[7]]);d[6]=k[0],d[7]=k[1],d[3]=+d[3]+p}(C==="H"||C==="V")&&(C="L"),(C==="h"||C==="v")&&(C="l"),(C==="m"||C==="l")&&(c-=S,M-=E);var B=l(b,[c,M]);(C==="H"||C==="V")&&(C="L"),(C==="M"||C==="L"||C==="m"||C==="l")&&(d[1]=B[0],d[2]=B[1]),d[0]=C,y+=d[0]+d.slice(1).join(",")}return o=y,y}},{"@plotly/d3":58,"parse-svg-path":250}],391:[function(t,P,R){P.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],392:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../registry"),A=t("../../plots/cartesian/axes"),T=t("../../lib"),e=t("./compute_error");P.exports=function(a){for(var r=a.calcdata,f=0;f<r.length;f++){var o=r[f],s=o[0].trace;if(s.visible===!0&&u.traceIs(s,"errorBarsOK")){var m=A.getFromId(a,s.xaxis),g=A.getFromId(a,s.yaxis);i(o,s,m,"x"),i(o,s,g,"y")}}};function i(n,a,r,f){var o=a["error_"+f]||{},s=o.visible&&["linear","log"].indexOf(r.type)!==-1,m=[];if(!!s){for(var g=e(o),p=0;p<n.length;p++){var v=n[p],x=v.i;if(x===void 0)x=p;else if(x===null)continue;var l=v[f];if(!!h(r.c2l(l))){var b=g(l,x);if(h(b[0])&&h(b[1])){var c=v[f+"s"]=l-b[0],M=v[f+"h"]=l+b[1];m.push(c,M)}}}var _=r._id,y=a._extremes[_],w=A.findExtremes(r,m,T.extendFlat({tozero:y.opts.tozero},{padded:!0}));y.min=y.min.concat(w.min),y.max=y.max.concat(w.max)}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./compute_error":393,"fast-isnumeric":190}],393:[function(t,P,R){P.exports=function(A){var T=A.type,e=A.symmetric;if(T==="data"){var i=A.array||[];if(e)return function(o,s){var m=+i[s];return[m,m]};var n=A.arrayminus||[];return function(o,s){var m=+i[s],g=+n[s];return!isNaN(m)||!isNaN(g)?[g||0,m||0]:[NaN,NaN]}}else{var a=h(T,A.value),r=h(T,A.valueminus);return e||A.valueminus===void 0?function(o){var s=a(o);return[s,s]}:function(o){return[r(o),a(o)]}}};function h(u,A){if(u==="percent")return function(T){return Math.abs(T*A/100)};if(u==="constant")return function(){return Math.abs(A)};if(u==="sqrt")return function(T){return Math.sqrt(Math.abs(T))}}},{}],394:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../registry"),A=t("../../lib"),T=t("../../plot_api/plot_template"),e=t("./attributes");P.exports=function(i,n,a,r){var f="error_"+r.axis,o=T.newContainer(n,f),s=i[f]||{};function m(c,M){return A.coerce(s,o,e,c,M)}var g=s.array!==void 0||s.value!==void 0||s.type==="sqrt",p=m("visible",g);if(p!==!1){var v=m("type","array"in s?"data":"percent"),x=!0;v!=="sqrt"&&(x=m("symmetric",!((v==="data"?"arrayminus":"valueminus")in s))),v==="data"?(m("array"),m("traceref"),x||(m("arrayminus"),m("tracerefminus"))):(v==="percent"||v==="constant")&&(m("value"),x||m("valueminus"));var l="copy_"+r.inherit+"style";if(r.inherit){var b=n["error_"+r.inherit];(b||{}).visible&&m(l,!(s.color||h(s.thickness)||h(s.width)))}(!r.inherit||!o[l])&&(m("color",a),m("thickness"),m("width",u.traceIs(n,"gl3d")?0:4))}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"./attributes":391,"fast-isnumeric":190}],395:[function(t,P,R){var h=t("../../lib"),u=t("../../plot_api/edit_types").overrideAll,A=t("./attributes"),T={error_x:h.extendFlat({},A),error_y:h.extendFlat({},A)};delete T.error_x.copy_zstyle,delete T.error_y.copy_zstyle,delete T.error_y.copy_ystyle;var e={error_x:h.extendFlat({},A),error_y:h.extendFlat({},A),error_z:h.extendFlat({},A)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,P.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:T,bar:T,histogram:T,scatter3d:u(e,"calc","nested"),scattergl:u(T,"calc","nested")}},supplyDefaults:t("./defaults"),calc:t("./calc"),makeComputeError:t("./compute_error"),plot:t("./plot"),style:t("./style"),hoverInfo:i};function i(n,a,r){(a.error_y||{}).visible&&(r.yerr=n.yh-n.y,a.error_y.symmetric||(r.yerrneg=n.y-n.ys)),(a.error_x||{}).visible&&(r.xerr=n.xh-n.x,a.error_x.symmetric||(r.xerrneg=n.x-n.xs))}},{"../../lib":515,"../../plot_api/edit_types":548,"./attributes":391,"./calc":392,"./compute_error":393,"./defaults":394,"./plot":396,"./style":397}],396:[function(t,P,R){var h=t("@plotly/d3"),u=t("fast-isnumeric"),A=t("../drawing"),T=t("../../traces/scatter/subtypes");P.exports=function(n,a,r,f){var o,s=r.xaxis,m=r.yaxis,g=f&&f.duration>0;a.each(function(p){var v=p[0].trace,x=v.error_x||{},l=v.error_y||{},b;v.ids&&(b=function(y){return y.id});var c=T.hasMarkers(v)&&v.marker.maxdisplayed>0;!l.visible&&!x.visible&&(p=[]);var M=h.select(this).selectAll("g.errorbar").data(p,b);if(M.exit().remove(),!!p.length){x.visible||M.selectAll("path.xerror").remove(),l.visible||M.selectAll("path.yerror").remove(),M.style("opacity",1);var _=M.enter().append("g").classed("errorbar",!0);g&&_.style("opacity",0).transition().duration(f.duration).style("opacity",1),A.setClipUrl(M,r.layerClipId,n),M.each(function(y){var w=h.select(this),d=e(y,s,m);if(!(c&&!y.vis)){var C,S=w.select("path.yerror");if(l.visible&&u(d.x)&&u(d.yh)&&u(d.ys)){var E=l.width;C="M"+(d.x-E)+","+d.yh+"h"+2*E+"m-"+E+",0V"+d.ys,d.noYS||(C+="m-"+E+",0h"+2*E),o=!S.size(),o?S=w.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0):g&&(S=S.transition().duration(f.duration).ease(f.easing)),S.attr("d",C)}else S.remove();var k=w.select("path.xerror");if(x.visible&&u(d.y)&&u(d.xh)&&u(d.xs)){var B=(x.copy_ystyle?l:x).width;C="M"+d.xh+","+(d.y-B)+"v"+2*B+"m0,-"+B+"H"+d.xs,d.noXS||(C+="m0,-"+B+"v"+2*B),o=!k.size(),o?k=w.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0):g&&(k=k.transition().duration(f.duration).ease(f.easing)),k.attr("d",C)}else k.remove()}})}})};function e(i,n,a){var r={x:n.c2p(i.x),y:a.c2p(i.y)};return i.yh!==void 0&&(r.yh=a.c2p(i.yh),r.ys=a.c2p(i.ys),u(r.ys)||(r.noYS=!0,r.ys=a.c2p(i.ys,!0))),i.xh!==void 0&&(r.xh=n.c2p(i.xh),r.xs=n.c2p(i.xs),u(r.xs)||(r.noXS=!0,r.xs=n.c2p(i.xs,!0))),r}},{"../../traces/scatter/subtypes":961,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],397:[function(t,P,R){var h=t("@plotly/d3"),u=t("../color");P.exports=function(T){T.each(function(e){var i=e[0].trace,n=i.error_y||{},a=i.error_x||{},r=h.select(this);r.selectAll("path.yerror").style("stroke-width",n.thickness+"px").call(u.stroke,n.color),a.copy_ystyle&&(a=n),r.selectAll("path.xerror").style("stroke-width",a.thickness+"px").call(u.stroke,a.color)})}},{"../color":367,"@plotly/d3":58}],398:[function(t,P,R){var h=t("../../plots/font_attributes"),u=t("./layout_attributes").hoverlabel,A=t("../../lib/extend").extendFlat;P.exports={hoverlabel:{bgcolor:A({},u.bgcolor,{arrayOk:!0}),bordercolor:A({},u.bordercolor,{arrayOk:!0}),font:h({arrayOk:!0,editType:"none"}),align:A({},u.align,{arrayOk:!0}),namelength:A({},u.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":505,"../../plots/font_attributes":594,"./layout_attributes":408}],399:[function(t,P,R){var h=t("../../lib"),u=t("../../registry");P.exports=function(e){var i=e.calcdata,n=e._fullLayout;function a(m){return function(g){return h.coerceHoverinfo({hoverinfo:g},{_module:m._module},n)}}for(var r=0;r<i.length;r++){var f=i[r],o=f[0].trace;if(!u.traceIs(o,"pie-like")){var s=u.traceIs(o,"2dMap")?A:h.fillArray;s(o.hoverinfo,f,"hi",a(o)),o.hovertemplate&&s(o.hovertemplate,f,"ht"),o.hoverlabel&&(s(o.hoverlabel.bgcolor,f,"hbg"),s(o.hoverlabel.bordercolor,f,"hbc"),s(o.hoverlabel.font.size,f,"hts"),s(o.hoverlabel.font.color,f,"htc"),s(o.hoverlabel.font.family,f,"htf"),s(o.hoverlabel.namelength,f,"hnl"),s(o.hoverlabel.align,f,"hta"))}}};function A(T,e,i,n){n=n||h.identity,Array.isArray(T)&&(e[0][i]=n(T))}},{"../../lib":515,"../../registry":647}],400:[function(t,P,R){var h=t("../../registry"),u=t("./hover").hover;P.exports=function(T,e,i){var n=h.getComponentMethod("annotations","onClick")(T,T._hoverdata);i!==void 0&&u(T,e,i,!0);function a(){T.emit("plotly_click",{points:T._hoverdata,event:e})}T._hoverdata&&e&&e.target&&(n&&n.then?n.then(a):a(),e.stopImmediatePropagation&&e.stopImmediatePropagation())}},{"../../registry":647,"./hover":404}],401:[function(t,P,R){P.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],402:[function(t,P,R){var h=t("../../lib"),u=t("./attributes"),A=t("./hoverlabel_defaults");P.exports=function(e,i,n,a){function r(o,s){return h.coerce(e,i,u,o,s)}var f=h.extendFlat({},a.hoverlabel);i.hovertemplate&&(f.namelength=-1),A(e,i,r,f)}},{"../../lib":515,"./attributes":398,"./hoverlabel_defaults":405}],403:[function(t,P,R){var h=t("../../lib");R.getSubplot=function(n){return n.subplot||n.xaxis+n.yaxis||n.geo},R.isTraceInSubplots=function(n,a){if(n.type==="splom"){for(var r=n.xaxes||[],f=n.yaxes||[],o=0;o<r.length;o++)for(var s=0;s<f.length;s++)if(a.indexOf(r[o]+f[s])!==-1)return!0;return!1}return a.indexOf(R.getSubplot(n))!==-1},R.flat=function(n,a){for(var r=new Array(n.length),f=0;f<n.length;f++)r[f]=a;return r},R.p2c=function(n,a){for(var r=new Array(n.length),f=0;f<n.length;f++)r[f]=n[f].p2c(a);return r},R.getDistanceFunction=function(n,a,r,f){return n==="closest"?f||R.quadrature(a,r):n.charAt(0)==="x"?a:r},R.getClosest=function(n,a,r){if(r.index!==!1)r.index>=0&&r.index<n.length?r.distance=0:r.index=!1;else for(var f=0;f<n.length;f++){var o=a(n[f]);o<=r.distance&&(r.index=f,r.distance=o)}return r},R.inbox=function(n,a,r){return n*a<0||n===0?r:1/0},R.quadrature=function(n,a){return function(r){var f=n(r),o=a(r);return Math.sqrt(f*f+o*o)}},R.makeEventData=function(n,a,r){var f="index"in n?n.index:n.pointNumber,o={data:a._input,fullData:a,curveNumber:a.index,pointNumber:f};if(a._indexToPoints){var s=a._indexToPoints[f];s.length===1?o.pointIndex=s[0]:o.pointIndices=s}else o.pointIndex=f;return a._module.eventData?o=a._module.eventData(o,n,a,r,f):("xVal"in n?o.x=n.xVal:"x"in n&&(o.x=n.x),"yVal"in n?o.y=n.yVal:"y"in n&&(o.y=n.y),n.xa&&(o.xaxis=n.xa),n.ya&&(o.yaxis=n.ya),n.zLabelVal!==void 0&&(o.z=n.zLabelVal)),R.appendArrayPointValue(o,a,f),o},R.appendArrayPointValue=function(n,a,r){var f=a._arrayAttrs;if(!!f)for(var o=0;o<f.length;o++){var s=f[o],m=A(s);if(n[m]===void 0){var g=h.nestedProperty(a,s).get(),p=T(g,r);p!==void 0&&(n[m]=p)}}},R.appendArrayMultiPointValues=function(n,a,r){var f=a._arrayAttrs;if(!!f)for(var o=0;o<f.length;o++){var s=f[o],m=A(s);if(n[m]===void 0){for(var g=h.nestedProperty(a,s).get(),p=new Array(r.length),v=0;v<r.length;v++)p[v]=T(g,r[v]);n[m]=p}}};var u={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function A(n){return u[n]||n}function T(n,a){if(Array.isArray(a)){if(Array.isArray(n)&&Array.isArray(n[a[0]]))return n[a[0]][a[1]]}else return n[a]}var e={x:!0,y:!0},i={"x unified":!0,"y unified":!0};R.isUnifiedHover=function(n){return typeof n!="string"?!1:!!i[n]},R.isXYhover=function(n){return typeof n!="string"?!1:!!e[n]}},{"../../lib":515}],404:[function(t,P,R){var h=t("@plotly/d3"),u=t("fast-isnumeric"),A=t("tinycolor2"),T=t("../../lib"),e=T.strTranslate,i=T.strRotate,n=t("../../lib/events"),a=t("../../lib/svg_text_utils"),r=t("../../lib/override_cursor"),f=t("../drawing"),o=t("../color"),s=t("../dragelement"),m=t("../../plots/cartesian/axes"),g=t("../../registry"),p=t("./helpers"),v=t("./constants"),x=t("../legend/defaults"),l=t("../legend/draw"),b=v.YANGLE,c=Math.PI*b/180,M=1/Math.sin(c),_=Math.cos(c),y=Math.sin(c),w=v.HOVERARROWSIZE,d=v.HOVERTEXTPAD,C={box:!0,ohlc:!0,violin:!0,candlestick:!0},S={scatter:!0,scattergl:!0,splom:!0};R.hover=function(Y,ee,ne,J){Y=T.getGraphDiv(Y);var q=ee.target;T.throttle(Y._fullLayout._uid+v.HOVERID,v.HOVERMINTIME,function(){E(Y,ee,ne,J,q)})},R.loneHover=function(Y,ee){var ne=!0;Array.isArray(Y)||(ne=!1,Y=[Y]);var J=ee.gd,q=ue(J),ae=K(J),le=Y.map(function(_e){var Se=_e._x0||_e.x0||_e.x||0,De=_e._x1||_e.x1||_e.x||0,Ie=_e._y0||_e.y0||_e.y||0,Te=_e._y1||_e.y1||_e.y||0,Ce=_e.eventData;if(Ce){var He=Math.min(Se,De),Xe=Math.max(Se,De),Be=Math.min(Ie,Te),Re=Math.max(Ie,Te),We=_e.trace;if(g.traceIs(We,"gl3d")){var vt=J._fullLayout[We.scene]._scene.container,Pt=vt.offsetLeft,Zt=vt.offsetTop;He+=Pt,Xe+=Pt,Be+=Zt,Re+=Zt}Ce.bbox={x0:He+ae,x1:Xe+ae,y0:Be+q,y1:Re+q},ee.inOut_bbox&&ee.inOut_bbox.push(Ce.bbox)}else Ce=!1;return{color:_e.color||o.defaultLine,x0:_e.x0||_e.x||0,x1:_e.x1||_e.x||0,y0:_e.y0||_e.y||0,y1:_e.y1||_e.y||0,xLabel:_e.xLabel,yLabel:_e.yLabel,zLabel:_e.zLabel,text:_e.text,name:_e.name,idealAlign:_e.idealAlign,borderColor:_e.borderColor,fontFamily:_e.fontFamily,fontSize:_e.fontSize,fontColor:_e.fontColor,nameLength:_e.nameLength,textAlign:_e.textAlign,trace:_e.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:_e.hovertemplate||!1,hovertemplateLabels:_e.hovertemplateLabels||!1,eventData:Ce}}),ie=!1,se=z(le,{gd:J,hovermode:"closest",rotateLabels:ie,bgColor:ee.bgColor||o.background,container:h.select(ee.container),outerContainer:ee.outerContainer||ee.container}),xe=5,oe=0,he=0;se.sort(function(_e,Se){return _e.y0-Se.y0}).each(function(_e,Se){var De=_e.y0-_e.by/2;De-xe<oe?_e.offset=oe-De+xe:_e.offset=0,oe=De+_e.by+_e.offset,Se===ee.anchorIndex&&(he=_e.offset)}).each(function(_e){_e.offset-=he});var be=J._fullLayout._invScaleX,me=J._fullLayout._invScaleY;return O(se,ie,be,me),ne?se:se.node()};function E(G,Y,ee,ne,J){ee||(ee="xy");var q=Array.isArray(ee)?ee:[ee],ae=G._fullLayout,le=ae._plots||[],ie=le[ee],se=ae._has("cartesian");if(ie){var xe=ie.overlays.map(function(sr){return sr.id});q=q.concat(xe)}for(var oe=q.length,he=new Array(oe),be=new Array(oe),me=!1,_e=0;_e<oe;_e++){var Se=q[_e];if(le[Se])me=!0,he[_e]=le[Se].xaxis,be[_e]=le[Se].yaxis;else if(ae[Se]&&ae[Se]._subplot){var De=ae[Se]._subplot;he[_e]=De.xaxis,be[_e]=De.yaxis}else{T.warn("Unrecognized subplot: "+Se);return}}var Ie=Y.hovermode||ae.hovermode;if(Ie&&!me&&(Ie="closest"),["x","y","closest","x unified","y unified"].indexOf(Ie)===-1||!G.calcdata||G.querySelector(".zoombox")||G._dragging)return s.unhoverRaw(G,Y);var Te=ae.hoverdistance;Te===-1&&(Te=1/0);var Ce=ae.spikedistance;Ce===-1&&(Ce=1/0);var He=[],Xe=[],Be,Re,We,vt,Pt,Zt,zt,At,Wt,Bt,Ct,Ze,nt,Ye={hLinePoint:null,vLinePoint:null},Ee=!1;if(Array.isArray(Y))for(Ie="array",We=0;We<Y.length;We++)Pt=G.calcdata[Y[We].curveNumber||0],Pt&&(Zt=Pt[0].trace,Pt[0].trace.hoverinfo!=="skip"&&(Xe.push(Pt),Zt.orientation==="h"&&(Ee=!0)));else{for(vt=0;vt<G.calcdata.length;vt++)Pt=G.calcdata[vt],Zt=Pt[0].trace,Zt.hoverinfo!=="skip"&&p.isTraceInSubplots(Zt,q)&&(Xe.push(Pt),Zt.orientation==="h"&&(Ee=!0));var Ge=!J,Je,qe;if(Ge)"xpx"in Y?Je=Y.xpx:Je=he[0]._length/2,"ypx"in Y?qe=Y.ypx:qe=be[0]._length/2;else{if(n.triggerHandler(G,"plotly_beforehover",Y)===!1)return;var Tt=J.getBoundingClientRect();Je=Y.clientX-Tt.left,qe=Y.clientY-Tt.top,ae._calcInverseTransform(G);var mt=T.apply3DTransform(ae._invTransform)(Je,qe);if(Je=mt[0],qe=mt[1],Je<0||Je>he[0]._length||qe<0||qe>be[0]._length)return s.unhoverRaw(G,Y)}if(Y.pointerX=Je+he[0]._offset,Y.pointerY=qe+be[0]._offset,"xval"in Y?Be=p.flat(q,Y.xval):Be=p.p2c(he,Je),"yval"in Y?Re=p.flat(q,Y.yval):Re=p.p2c(be,qe),!u(Be[0])||!u(Re[0]))return T.warn("Fx.hover failed",Y,G),s.unhoverRaw(G,Y)}var Mt=1/0;function Ht(sr,zr){for(vt=0;vt<Xe.length;vt++)if(Pt=Xe[vt],!(!Pt||!Pt[0]||!Pt[0].trace)&&(Zt=Pt[0].trace,!(Zt.visible!==!0||Zt._length===0)&&["carpet","contourcarpet"].indexOf(Zt._module.name)===-1)){if(Zt.type==="splom"?(At=0,zt=q[At]):(zt=p.getSubplot(Zt),At=q.indexOf(zt)),Wt=Ie,p.isUnifiedHover(Wt)&&(Wt=Wt.charAt(0)),Ze={cd:Pt,trace:Zt,xa:he[At],ya:be[At],maxHoverDistance:Te,maxSpikeDistance:Ce,index:!1,distance:Math.min(Mt,Te),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:o.defaultLine,name:Zt.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},ae[zt]&&(Ze.subplot=ae[zt]._subplot),ae._splomScenes&&ae._splomScenes[Zt.uid]&&(Ze.scene=ae._splomScenes[Zt.uid]),nt=He.length,Wt==="array"){var Ur=Y[vt];"pointNumber"in Ur?(Ze.index=Ur.pointNumber,Wt="closest"):(Wt="","xval"in Ur&&(Bt=Ur.xval,Wt="x"),"yval"in Ur&&(Ct=Ur.yval,Wt=Wt?"closest":"y"))}else sr!==void 0&&zr!==void 0?(Bt=sr,Ct=zr):(Bt=Be[At],Ct=Re[At]);if(Te!==0)if(Zt._module&&Zt._module.hoverPoints){var Dr=Zt._module.hoverPoints(Ze,Bt,Ct,Wt,{finiteRange:!0,hoverLayer:ae._hoverlayer});if(Dr)for(var Tr,Wr=0;Wr<Dr.length;Wr++)Tr=Dr[Wr],u(Tr.x0)&&u(Tr.y0)&&He.push(N(Tr,Ie))}else T.log("Unrecognized trace type in hover:",Zt);if(Ie==="closest"&&He.length>nt&&(He.splice(0,nt),Mt=He[0].distance),se&&Ce!==0&&He.length===0){Ze.distance=Ce,Ze.index=!1;var An=Zt._module.hoverPoints(Ze,Bt,Ct,"closest",{hoverLayer:ae._hoverlayer});if(An&&(An=An.filter(function(ya){return ya.spikeDistance<=Ce})),An&&An.length){var vn,Un=An.filter(function(ya){return ya.xa.showspikes&&ya.xa.spikesnap!=="hovered data"});if(Un.length){var Dn=Un[0];u(Dn.x0)&&u(Dn.y0)&&(vn=Vt(Dn),(!Ye.vLinePoint||Ye.vLinePoint.spikeDistance>vn.spikeDistance)&&(Ye.vLinePoint=vn))}var Xn=An.filter(function(ya){return ya.ya.showspikes&&ya.ya.spikesnap!=="hovered data"});if(Xn.length){var Yn=Xn[0];u(Yn.x0)&&u(Yn.y0)&&(vn=Vt(Yn),(!Ye.hLinePoint||Ye.hLinePoint.spikeDistance>vn.spikeDistance)&&(Ye.hLinePoint=vn))}}}}}Ht();function Rt(sr,zr,Ur){for(var Dr=null,Tr=1/0,Wr,An=0;An<sr.length;An++)Wr=sr[An].spikeDistance,Ur&&An===0&&(Wr=-1/0),Wr<=Tr&&Wr<=zr&&(Dr=sr[An],Tr=Wr);return Dr}function Vt(sr){return sr?{xa:sr.xa,ya:sr.ya,x:sr.xSpike!==void 0?sr.xSpike:(sr.x0+sr.x1)/2,y:sr.ySpike!==void 0?sr.ySpike:(sr.y0+sr.y1)/2,distance:sr.distance,spikeDistance:sr.spikeDistance,curveNumber:sr.trace.index,color:sr.color,pointNumber:sr.index}:null}var Jt={fullLayout:ae,container:ae._hoverlayer,event:Y},Yt=G._spikepoints,or={vLinePoint:Ye.vLinePoint,hLinePoint:Ye.hLinePoint};G._spikepoints=or;var Hr=function(){He.sort(function(sr,zr){return sr.distance-zr.distance}),He=X(He,Ie)};Hr();var an=Ie.charAt(0),Kr=(an==="x"||an==="y")&&He[0]&&S[He[0].trace.type];if(se&&Ce!==0&&He.length!==0){var ot=He.filter(function(sr){return sr.ya.showspikes}),er=Rt(ot,Ce,Kr);Ye.hLinePoint=Vt(er);var Kt=He.filter(function(sr){return sr.xa.showspikes}),ur=Rt(Kt,Ce,Kr);Ye.vLinePoint=Vt(ur)}if(He.length===0){var Ar=s.unhoverRaw(G,Y);return se&&(Ye.hLinePoint!==null||Ye.vLinePoint!==null)&&j(Yt)&&V(G,Ye,Jt),Ar}if(se&&j(Yt)&&V(G,Ye,Jt),p.isXYhover(Wt)&&He[0].length!==0&&He[0].trace.type!=="splom"){var et=He[0];C[et.trace.type]?He=He.filter(function(sr){return sr.trace.index===et.trace.index}):He=[et];var $e=He.length,st=re("x",et,ae),ft=re("y",et,ae);Ht(st,ft);var St=[],Ut={},Pe=0,ke=function(sr){var zr=C[sr.trace.type]?k(sr):sr.trace.index;if(!Ut[zr])Pe++,Ut[zr]=Pe,St.push(sr);else{var Ur=Ut[zr]-1,Dr=St[Ur];Ur>0&&Math.abs(sr.distance)<Math.abs(Dr.distance)&&(St[Ur]=sr)}},it;for(it=0;it<$e;it++)ke(He[it]);for(it=He.length-1;it>$e-1;it--)ke(He[it]);He=St,Hr()}var ut=G._hoverdata,ht=[],Et=ue(G),yt=K(G);for(We=0;We<He.length;We++){var Dt=He[We],Xt=p.makeEventData(Dt,Dt.trace,Dt.cd);if(Dt.hovertemplate!==!1){var ar=!1;Dt.cd[Dt.index]&&Dt.cd[Dt.index].ht&&(ar=Dt.cd[Dt.index].ht),Dt.hovertemplate=ar||Dt.trace.hovertemplate||!1}if(Dt.xa&&Dt.ya){var kr=Dt.x0+Dt.xa._offset,wr=Dt.x1+Dt.xa._offset,Sr=Dt.y0+Dt.ya._offset,Zr=Dt.y1+Dt.ya._offset,ir=Math.min(kr,wr),xr=Math.max(kr,wr),Fr=Math.min(Sr,Zr),Or=Math.max(Sr,Zr);Xt.bbox={x0:ir+yt,x1:xr+yt,y0:Fr+Et,y1:Or+Et}}Dt.eventData=[Xt],ht.push(Xt)}G._hoverdata=ht;var Cr=Ie==="y"&&(Xe.length>1||He.length>1)||Ie==="closest"&&Ee&&He.length>1,at=o.combine(ae.plot_bgcolor||o.background,ae.paper_bgcolor),Ft=z(He,{gd:G,hovermode:Ie,rotateLabels:Cr,bgColor:at,container:ae._hoverlayer,outerContainer:ae._paper.node(),commonLabelOpts:ae.hoverlabel,hoverdistance:ae.hoverdistance});if(p.isUnifiedHover(Ie)||(I(Ft,Cr?"xa":"ya",ae),O(Ft,Cr,ae._invScaleX,ae._invScaleY)),J&&J.tagName){var jt=g.getComponentMethod("annotations","hasClickToShow")(G,ht);r(h.select(J),jt?"pointer":"")}!J||ne||!H(G,Y,ut)||(ut&&G.emit("plotly_unhover",{event:Y,points:ut}),G.emit("plotly_hover",{event:Y,points:G._hoverdata,xaxes:he,yaxes:be,xvals:Be,yvals:Re}))}function k(G){return[G.trace.index,G.index,G.x0,G.y0,G.name,G.attr,G.xa?G.xa._id:"",G.ya?G.ya._id:""].join(",")}var B=/<extra>([\s\S]*)<\/extra>/;function z(G,Y){var ee=Y.gd,ne=ee._fullLayout,J=Y.hovermode,q=Y.rotateLabels,ae=Y.bgColor,le=Y.container,ie=Y.outerContainer,se=Y.commonLabelOpts||{};if(G.length===0)return[[]];var xe=Y.fontFamily||v.HOVERFONT,oe=Y.fontSize||v.HOVERFONTSIZE,he=G[0],be=he.xa,me=he.ya,_e=J.charAt(0),Se=_e+"Label",De=he[Se];if(De===void 0&&be.type==="multicategory")for(var Ie=0;Ie<G.length&&(De=G[Ie][Se],De===void 0);Ie++);var Te=te(ee,ie),Ce=Te.top,He=Te.width,Xe=Te.height,Be=De!==void 0&&he.distance<=Y.hoverdistance&&(J==="x"||J==="y");if(Be){var Re=!0,We,vt;for(We=0;We<G.length;We++)if(Re&&G[We].zLabel===void 0&&(Re=!1),vt=G[We].hoverinfo||G[We].trace.hoverinfo,vt){var Pt=Array.isArray(vt)?vt:vt.split("+");if(Pt.indexOf("all")===-1&&Pt.indexOf(J)===-1){Be=!1;break}}Re&&(Be=!1)}var Zt=le.selectAll("g.axistext").data(Be?[0]:[]);if(Zt.enter().append("g").classed("axistext",!0),Zt.exit().remove(),Zt.each(function(){var et=h.select(this),$e=T.ensureSingle(et,"path","",function(xr){xr.style({"stroke-width":"1px"})}),st=T.ensureSingle(et,"text","",function(xr){xr.attr("data-notex",1)}),ft=se.bgcolor||o.defaultLine,St=se.bordercolor||o.contrast(ft),Ut=o.contrast(ft),Pe={family:se.font.family||xe,size:se.font.size||oe,color:se.font.color||Ut};$e.style({fill:ft,stroke:St}),st.text(De).call(f.font,Pe).call(a.positionText,0,0).call(a.convertToTspans,ee),et.attr("transform","");var ke=te(ee,st.node()),it,ut;if(J==="x"){var ht=be.side==="top"?"-":"";st.attr("text-anchor","middle").call(a.positionText,0,be.side==="top"?Ce-ke.bottom-w-d:Ce-ke.top+w+d),it=be._offset+(he.x0+he.x1)/2,ut=me._offset+(be.side==="top"?0:me._length);var Et=ke.width/2+d;it<Et?(it=Et,$e.attr("d","M-"+(Et-w)+",0L-"+(Et-w*2)+","+ht+w+"H"+(d+ke.width/2)+"v"+ht+(d*2+ke.height)+"H-"+Et+"V"+ht+w+"Z")):it>ne.width-Et?(it=ne.width-Et,$e.attr("d","M"+(Et-w)+",0L"+Et+","+ht+w+"v"+ht+(d*2+ke.height)+"H-"+Et+"V"+ht+w+"H"+(Et-w*2)+"Z")):$e.attr("d","M0,0L"+w+","+ht+w+"H"+(d+ke.width/2)+"v"+ht+(d*2+ke.height)+"H-"+(d+ke.width/2)+"V"+ht+w+"H-"+w+"Z")}else{var yt,Dt,Xt;me.side==="right"?(yt="start",Dt=1,Xt="",it=be._offset+be._length):(yt="end",Dt=-1,Xt="-",it=be._offset),ut=me._offset+(he.y0+he.y1)/2,st.attr("text-anchor",yt),$e.attr("d","M0,0L"+Xt+w+","+w+"V"+(d+ke.height/2)+"h"+Xt+(d*2+ke.width)+"V-"+(d+ke.height/2)+"H"+Xt+w+"V-"+w+"Z");var ar=ke.height/2,kr=Ce-ke.top-ar,wr="clip"+ne._uid+"commonlabel"+me._id,Sr;if(it<ke.width+2*d+w){Sr="M-"+(w+d)+"-"+ar+"h-"+(ke.width-d)+"V"+ar+"h"+(ke.width-d)+"Z";var Zr=ke.width-it+d;a.positionText(st,Zr,kr),yt==="end"&&st.selectAll("tspan").each(function(){var xr=h.select(this),Fr=f.tester.append("text").text(xr.text()).call(f.font,Pe),Or=te(ee,Fr.node());Math.round(Or.width)<Math.round(ke.width)&&xr.attr("x",Zr-Or.width),Fr.remove()})}else a.positionText(st,Dt*(d+w),kr),Sr=null;var ir=ne._topclips.selectAll("#"+wr).data(Sr?[0]:[]);ir.enter().append("clipPath").attr("id",wr).append("path"),ir.exit().remove(),ir.select("path").attr("d",Sr),f.setClipUrl(st,Sr?wr:null,ee)}et.attr("transform",e(it,ut))}),p.isUnifiedHover(J)){le.selectAll("g.hovertext").remove();var zt=G.filter(function(et){return et.hoverinfo!=="none"});if(zt.length===0)return;var At=ne.hoverlabel,Wt=At.font,Bt={showlegend:!0,legend:{title:{text:De,font:Wt},font:Wt,bgcolor:At.bgcolor,bordercolor:At.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:ne.legend?ne.legend.traceorder:void 0,orientation:"v"}},Ct={font:Wt};x(Bt,Ct,ee._fullData);var Ze=Ct.legend;Ze.entries=[];for(var nt=0;nt<zt.length;nt++){var Ye=zt[nt];if(Ye.hoverinfo!=="none"){var Ee=F(Ye,!0,J,ne,De),Ge=Ee[0],Je=Ee[1];Ye.name=Je,Je!==""?Ye.text=Je+" : "+Ge:Ye.text=Ge;var qe=Ye.cd[Ye.index];qe&&(qe.mc&&(Ye.mc=qe.mc),qe.mcc&&(Ye.mc=qe.mcc),qe.mlc&&(Ye.mlc=qe.mlc),qe.mlcc&&(Ye.mlc=qe.mlcc),qe.mlw&&(Ye.mlw=qe.mlw),qe.mrc&&(Ye.mrc=qe.mrc),qe.dir&&(Ye.dir=qe.dir)),Ye._distinct=!0,Ze.entries.push([Ye])}}Ze.entries.sort(function(et,$e){return et[0].trace.index-$e[0].trace.index}),Ze.layer=le,Ze._inHover=!0,Ze._groupTitleFont=At.grouptitlefont,l(ee,Ze);var Tt=le.select("g.legend"),mt=te(ee,Tt.node()),Mt=mt.width+2*d,Ht=mt.height+2*d,Rt=zt[0],Vt=(Rt.x0+Rt.x1)/2,Jt=(Rt.y0+Rt.y1)/2,Yt=!(g.traceIs(Rt.trace,"bar-like")||g.traceIs(Rt.trace,"box-violin")),or,Hr;_e==="y"?Yt?(Hr=Jt-d,or=Jt+d):(Hr=Math.min.apply(null,zt.map(function(et){return Math.min(et.y0,et.y1)})),or=Math.max.apply(null,zt.map(function(et){return Math.max(et.y0,et.y1)}))):Hr=or=T.mean(zt.map(function(et){return(et.y0+et.y1)/2}))-Ht/2;var an,Kr;_e==="x"?Yt?(an=Vt+d,Kr=Vt-d):(an=Math.max.apply(null,zt.map(function(et){return Math.max(et.x0,et.x1)})),Kr=Math.min.apply(null,zt.map(function(et){return Math.min(et.x0,et.x1)}))):an=Kr=T.mean(zt.map(function(et){return(et.x0+et.x1)/2}))-Mt/2;var ot=be._offset,er=me._offset;or+=er,an+=ot,Kr+=ot-Mt,Hr+=er-Ht;var Kt,ur;return an+Mt<He&&an>=0?Kt=an:Kr+Mt<He&&Kr>=0?Kt=Kr:ot+Mt<He?Kt=ot:an-Vt<Vt-Kr+Mt?Kt=He-Mt:Kt=0,Kt+=d,or+Ht<Xe&&or>=0?ur=or:Hr+Ht<Xe&&Hr>=0?ur=Hr:er+Ht<Xe?ur=er:or-Jt<Jt-Hr+Ht?ur=Xe-Ht:ur=0,ur+=d,Tt.attr("transform",e(Kt-1,ur-1)),Tt}var Ar=le.selectAll("g.hovertext").data(G,function(et){return k(et)});return Ar.enter().append("g").classed("hovertext",!0).each(function(){var et=h.select(this);et.append("rect").call(o.fill,o.addOpacity(ae,.8)),et.append("text").classed("name",!0),et.append("path").style("stroke-width","1px"),et.append("text").classed("nums",!0).call(f.font,xe,oe)}),Ar.exit().remove(),Ar.each(function(et){var $e=h.select(this).attr("transform",""),st=et.color;Array.isArray(st)&&(st=st[et.eventData[0].pointNumber]);var ft=et.bgcolor||st,St=o.combine(o.opacity(ft)?ft:o.defaultLine,ae),Ut=o.combine(o.opacity(st)?st:o.defaultLine,ae),Pe=et.borderColor||o.contrast(St),ke=F(et,Be,J,ne,De,$e),it=ke[0],ut=ke[1],ht=$e.select("text.nums").call(f.font,et.fontFamily||xe,et.fontSize||oe,et.fontColor||Pe).text(it).attr("data-notex",1).call(a.positionText,0,0).call(a.convertToTspans,ee),Et=$e.select("text.name"),yt=0,Dt=0;if(ut&&ut!==it){Et.call(f.font,et.fontFamily||xe,et.fontSize||oe,Ut).text(ut).attr("data-notex",1).call(a.positionText,0,0).call(a.convertToTspans,ee);var Xt=te(ee,Et.node());yt=Xt.width+2*d,Dt=Xt.height+2*d}else Et.remove(),$e.select("rect").remove();$e.select("path").style({fill:St,stroke:Pe});var ar=et.xa._offset+(et.x0+et.x1)/2,kr=et.ya._offset+(et.y0+et.y1)/2,wr=Math.abs(et.x1-et.x0),Sr=Math.abs(et.y1-et.y0),Zr=te(ee,ht.node()),ir=Zr.width/ne._invScaleX,xr=Zr.height/ne._invScaleY;et.ty0=(Ce-Zr.top)/ne._invScaleY,et.bx=ir+2*d,et.by=Math.max(xr+2*d,Dt),et.anchor="start",et.txwidth=ir,et.tx2width=yt,et.offset=0;var Fr=(ir+w+d+yt)*ne._invScaleX,Or,Cr;if(q)et.pos=ar,Or=kr+Sr/2+Fr<=Xe,Cr=kr-Sr/2-Fr>=0,(et.idealAlign==="top"||!Or)&&Cr?(kr-=Sr/2,et.anchor="end"):Or?(kr+=Sr/2,et.anchor="start"):et.anchor="middle";else if(et.pos=kr,Or=ar+wr/2+Fr<=He,Cr=ar-wr/2-Fr>=0,(et.idealAlign==="left"||!Or)&&Cr)ar-=wr/2,et.anchor="end";else if(Or)ar+=wr/2,et.anchor="start";else{et.anchor="middle";var at=Fr/2,Ft=ar+at-He,jt=ar-at;Ft>0&&(ar-=Ft),jt<0&&(ar+=-jt)}ht.attr("text-anchor",et.anchor),yt&&Et.attr("text-anchor",et.anchor),$e.attr("transform",e(ar,kr)+(q?i(b):""))}),Ar}function F(G,Y,ee,ne,J,q){var ae="",le="";G.nameOverride!==void 0&&(G.name=G.nameOverride),G.name&&(G.trace._meta&&(G.name=T.templateString(G.name,G.trace._meta)),ae=Z(G.name,G.nameLength));var ie=ee.charAt(0),se=ie==="x"?"y":"x";G.zLabel!==void 0?(G.xLabel!==void 0&&(le+="x: "+G.xLabel+"<br>"),G.yLabel!==void 0&&(le+="y: "+G.yLabel+"<br>"),G.trace.type!=="choropleth"&&G.trace.type!=="choroplethmapbox"&&(le+=(le?"z: ":"")+G.zLabel)):Y&&G[ie+"Label"]===J?le=G[se+"Label"]||"":G.xLabel===void 0?G.yLabel!==void 0&&G.trace.type!=="scattercarpet"&&(le=G.yLabel):G.yLabel===void 0?le=G.xLabel:le="("+G.xLabel+", "+G.yLabel+")",(G.text||G.text===0)&&!Array.isArray(G.text)&&(le+=(le?"<br>":"")+G.text),G.extraText!==void 0&&(le+=(le?"<br>":"")+G.extraText),q&&le===""&&!G.hovertemplate&&(ae===""&&q.remove(),le=ae);var xe=G.hovertemplate||!1;if(xe){var oe=G.hovertemplateLabels||G;G[ie+"Label"]!==J&&(oe[ie+"other"]=oe[ie+"Val"],oe[ie+"otherLabel"]=oe[ie+"Label"]),le=T.hovertemplateString(xe,oe,ne._d3locale,G.eventData[0]||{},G.trace._meta),le=le.replace(B,function(he,be){return ae=Z(be,G.nameLength),""})}return[le,ae]}function I(G,Y,ee){var ne=0,J=1,q=G.size(),ae=new Array(q),le=0;G.each(function(Be){var Re=Be[Y],We=Re._id.charAt(0)==="x",vt=Re.range;le===0&&vt&&vt[0]>vt[1]!==We&&(J=-1),ae[le++]=[{datum:Be,traceIndex:Be.trace.index,dp:0,pos:Be.pos,posref:Be.posref,size:Be.by*(We?M:1)/2,pmin:0,pmax:We?ee.width:ee.height}]}),ae.sort(function(Be,Re){return Be[0].posref-Re[0].posref||J*(Re[0].traceIndex-Be[0].traceIndex)});var ie,se,xe,oe,he,be,me;function _e(Be){var Re=Be[0],We=Be[Be.length-1];if(se=Re.pmin-Re.pos-Re.dp+Re.size,xe=We.pos+We.dp+We.size-Re.pmax,se>.01){for(he=Be.length-1;he>=0;he--)Be[he].dp+=se;ie=!1}if(!(xe<.01)){if(se<-.01){for(he=Be.length-1;he>=0;he--)Be[he].dp-=xe;ie=!1}if(!!ie){var vt=0;for(oe=0;oe<Be.length;oe++)be=Be[oe],be.pos+be.dp+be.size>Re.pmax&&vt++;for(oe=Be.length-1;oe>=0&&!(vt<=0);oe--)be=Be[oe],be.pos>Re.pmax-1&&(be.del=!0,vt--);for(oe=0;oe<Be.length&&!(vt<=0);oe++)if(be=Be[oe],be.pos<Re.pmin+1)for(be.del=!0,vt--,xe=be.size*2,he=Be.length-1;he>=0;he--)Be[he].dp-=xe;for(oe=Be.length-1;oe>=0&&!(vt<=0);oe--)be=Be[oe],be.pos+be.dp+be.size>Re.pmax&&(be.del=!0,vt--)}}}for(;!ie&&ne<=q;){for(ne++,ie=!0,oe=0;oe<ae.length-1;){var Se=ae[oe],De=ae[oe+1],Ie=Se[Se.length-1],Te=De[0];if(se=Ie.pos+Ie.dp+Ie.size-Te.pos-Te.dp+Te.size,se>.01&&Ie.pmin===Te.pmin&&Ie.pmax===Te.pmax){for(he=De.length-1;he>=0;he--)De[he].dp+=se;for(Se.push.apply(Se,De),ae.splice(oe+1,1),me=0,he=Se.length-1;he>=0;he--)me+=Se[he].dp;for(xe=me/Se.length,he=Se.length-1;he>=0;he--)Se[he].dp-=xe;ie=!1}else oe++}ae.forEach(_e)}for(oe=ae.length-1;oe>=0;oe--){var Ce=ae[oe];for(he=Ce.length-1;he>=0;he--){var He=Ce[he],Xe=He.datum;Xe.offset=He.dp,Xe.del=He.del}}}function O(G,Y,ee,ne){var J=function(ae){return ae*ee},q=function(ae){return ae*ne};G.each(function(ae){var le=h.select(this);if(ae.del)return le.remove();var ie=le.select("text.nums"),se=ae.anchor,xe=se==="end"?-1:1,oe={start:1,end:-1,middle:0}[se],he=oe*(w+d),be=he+oe*(ae.txwidth+d),me=0,_e=ae.offset,Se=se==="middle";Se&&(he-=ae.tx2width/2,be+=ae.txwidth/2+d),Y&&(_e*=-y,me=ae.offset*_),le.select("path").attr("d",Se?"M-"+J(ae.bx/2+ae.tx2width/2)+","+q(_e-ae.by/2)+"h"+J(ae.bx)+"v"+q(ae.by)+"h-"+J(ae.bx)+"Z":"M0,0L"+J(xe*w+me)+","+q(w+_e)+"v"+q(ae.by/2-w)+"h"+J(xe*ae.bx)+"v-"+q(ae.by)+"H"+J(xe*w+me)+"V"+q(_e-w)+"Z");var De=me+he,Ie=_e+ae.ty0-ae.by/2+d,Te=ae.textAlign||"auto";Te!=="auto"&&(Te==="left"&&se!=="start"?(ie.attr("text-anchor","start"),De=Se?-ae.bx/2-ae.tx2width/2+d:-ae.bx-d):Te==="right"&&se!=="end"&&(ie.attr("text-anchor","end"),De=Se?ae.bx/2-ae.tx2width/2-d:ae.bx+d)),ie.call(a.positionText,J(De),q(Ie)),ae.tx2width&&(le.select("text.name").call(a.positionText,J(be+oe*d+me),q(_e+ae.ty0-ae.by/2+d)),le.select("rect").call(f.setRect,J(be+(oe-1)*ae.tx2width/2+me),q(_e-ae.by/2-1),J(ae.tx2width),q(ae.by+2)))})}function N(G,Y){var ee=G.index,ne=G.trace||{},J=G.cd[0],q=G.cd[ee]||{};function ae(he){return he||u(he)&&he===0}var le=Array.isArray(ee)?function(he,be){var me=T.castOption(J,ee,he);return ae(me)?me:T.extractOption({},ne,"",be)}:function(he,be){return T.extractOption(q,ne,he,be)};function ie(he,be,me){var _e=le(be,me);ae(_e)&&(G[he]=_e)}if(ie("hoverinfo","hi","hoverinfo"),ie("bgcolor","hbg","hoverlabel.bgcolor"),ie("borderColor","hbc","hoverlabel.bordercolor"),ie("fontFamily","htf","hoverlabel.font.family"),ie("fontSize","hts","hoverlabel.font.size"),ie("fontColor","htc","hoverlabel.font.color"),ie("nameLength","hnl","hoverlabel.namelength"),ie("textAlign","hta","hoverlabel.align"),G.posref=Y==="y"||Y==="closest"&&ne.orientation==="h"?G.xa._offset+(G.x0+G.x1)/2:G.ya._offset+(G.y0+G.y1)/2,G.x0=T.constrain(G.x0,0,G.xa._length),G.x1=T.constrain(G.x1,0,G.xa._length),G.y0=T.constrain(G.y0,0,G.ya._length),G.y1=T.constrain(G.y1,0,G.ya._length),G.xLabelVal!==void 0&&(G.xLabel="xLabel"in G?G.xLabel:m.hoverLabelText(G.xa,G.xLabelVal,ne.xhoverformat),G.xVal=G.xa.c2d(G.xLabelVal)),G.yLabelVal!==void 0&&(G.yLabel="yLabel"in G?G.yLabel:m.hoverLabelText(G.ya,G.yLabelVal,ne.yhoverformat),G.yVal=G.ya.c2d(G.yLabelVal)),G.zLabelVal!==void 0&&G.zLabel===void 0&&(G.zLabel=String(G.zLabelVal)),!isNaN(G.xerr)&&!(G.xa.type==="log"&&G.xerr<=0)){var se=m.tickText(G.xa,G.xa.c2l(G.xerr),"hover").text;G.xerrneg!==void 0?G.xLabel+=" +"+se+" / -"+m.tickText(G.xa,G.xa.c2l(G.xerrneg),"hover").text:G.xLabel+=" \xB1 "+se,Y==="x"&&(G.distance+=1)}if(!isNaN(G.yerr)&&!(G.ya.type==="log"&&G.yerr<=0)){var xe=m.tickText(G.ya,G.ya.c2l(G.yerr),"hover").text;G.yerrneg!==void 0?G.yLabel+=" +"+xe+" / -"+m.tickText(G.ya,G.ya.c2l(G.yerrneg),"hover").text:G.yLabel+=" \xB1 "+xe,Y==="y"&&(G.distance+=1)}var oe=G.hoverinfo||G.trace.hoverinfo;return oe&&oe!=="all"&&(oe=Array.isArray(oe)?oe:oe.split("+"),oe.indexOf("x")===-1&&(G.xLabel=void 0),oe.indexOf("y")===-1&&(G.yLabel=void 0),oe.indexOf("z")===-1&&(G.zLabel=void 0),oe.indexOf("text")===-1&&(G.text=void 0),oe.indexOf("name")===-1&&(G.name=void 0)),G}function V(G,Y,ee){var ne=ee.container,J=ee.fullLayout,q=J._size,ae=ee.event,le=!!Y.hLinePoint,ie=!!Y.vLinePoint,se,xe;if(ne.selectAll(".spikeline").remove(),!!(ie||le)){var oe=o.combine(J.plot_bgcolor,J.paper_bgcolor);if(le){var he=Y.hLinePoint,be,me;se=he&&he.xa,xe=he&&he.ya;var _e=xe.spikesnap;_e==="cursor"?(be=ae.pointerX,me=ae.pointerY):(be=se._offset+he.x,me=xe._offset+he.y);var Se=A.readability(he.color,oe)<1.5?o.contrast(oe):he.color,De=xe.spikemode,Ie=xe.spikethickness,Te=xe.spikecolor||Se,Ce=m.getPxPosition(G,xe),He,Xe;if(De.indexOf("toaxis")!==-1||De.indexOf("across")!==-1){if(De.indexOf("toaxis")!==-1&&(He=Ce,Xe=be),De.indexOf("across")!==-1){var Be=xe._counterDomainMin,Re=xe._counterDomainMax;xe.anchor==="free"&&(Be=Math.min(Be,xe.position),Re=Math.max(Re,xe.position)),He=q.l+Be*q.w,Xe=q.l+Re*q.w}ne.insert("line",":first-child").attr({x1:He,x2:Xe,y1:me,y2:me,"stroke-width":Ie,stroke:Te,"stroke-dasharray":f.dashStyle(xe.spikedash,Ie)}).classed("spikeline",!0).classed("crisp",!0),ne.insert("line",":first-child").attr({x1:He,x2:Xe,y1:me,y2:me,"stroke-width":Ie+2,stroke:oe}).classed("spikeline",!0).classed("crisp",!0)}De.indexOf("marker")!==-1&&ne.insert("circle",":first-child").attr({cx:Ce+(xe.side!=="right"?Ie:-Ie),cy:me,r:Ie,fill:Te}).classed("spikeline",!0)}if(ie){var We=Y.vLinePoint,vt,Pt;se=We&&We.xa,xe=We&&We.ya;var Zt=se.spikesnap;Zt==="cursor"?(vt=ae.pointerX,Pt=ae.pointerY):(vt=se._offset+We.x,Pt=xe._offset+We.y);var zt=A.readability(We.color,oe)<1.5?o.contrast(oe):We.color,At=se.spikemode,Wt=se.spikethickness,Bt=se.spikecolor||zt,Ct=m.getPxPosition(G,se),Ze,nt;if(At.indexOf("toaxis")!==-1||At.indexOf("across")!==-1){if(At.indexOf("toaxis")!==-1&&(Ze=Ct,nt=Pt),At.indexOf("across")!==-1){var Ye=se._counterDomainMin,Ee=se._counterDomainMax;se.anchor==="free"&&(Ye=Math.min(Ye,se.position),Ee=Math.max(Ee,se.position)),Ze=q.t+(1-Ee)*q.h,nt=q.t+(1-Ye)*q.h}ne.insert("line",":first-child").attr({x1:vt,x2:vt,y1:Ze,y2:nt,"stroke-width":Wt,stroke:Bt,"stroke-dasharray":f.dashStyle(se.spikedash,Wt)}).classed("spikeline",!0).classed("crisp",!0),ne.insert("line",":first-child").attr({x1:vt,x2:vt,y1:Ze,y2:nt,"stroke-width":Wt+2,stroke:oe}).classed("spikeline",!0).classed("crisp",!0)}At.indexOf("marker")!==-1&&ne.insert("circle",":first-child").attr({cx:vt,cy:Ct-(se.side!=="top"?Wt:-Wt),r:Wt,fill:Bt}).classed("spikeline",!0)}}}function H(G,Y,ee){if(!ee||ee.length!==G._hoverdata.length)return!0;for(var ne=ee.length-1;ne>=0;ne--){var J=ee[ne],q=G._hoverdata[ne];if(J.curveNumber!==q.curveNumber||String(J.pointNumber)!==String(q.pointNumber)||String(J.pointNumbers)!==String(q.pointNumbers))return!0}return!1}function j(G,Y){return!Y||Y.vLinePoint!==G._spikepoints.vLinePoint||Y.hLinePoint!==G._spikepoints.hLinePoint}function Z(G,Y){return a.plainText(G||"",{len:Y,allowedTags:["br","sub","sup","b","i","em"]})}function X(G,Y){for(var ee=Y.charAt(0),ne=[],J=[],q=[],ae=0;ae<G.length;ae++){var le=G[ae];g.traceIs(le.trace,"bar-like")||g.traceIs(le.trace,"box-violin")?q.push(le):le.trace[ee+"period"]?J.push(le):ne.push(le)}return ne.concat(J).concat(q)}function re(G,Y,ee){var ne=Y[G+"a"],J=Y[G+"Val"],q=Y.cd[0];if(ne.type==="category"||ne.type==="multicategory")J=ne._categoriesMap[J];else if(ne.type==="date"){var ae=Y.trace[G+"periodalignment"];if(ae){var le=Y.cd[Y.index],ie=le[G+"Start"];ie===void 0&&(ie=le[G]);var se=le[G+"End"];se===void 0&&(se=le[G]);var xe=se-ie;ae==="end"?J+=xe:ae==="middle"&&(J+=xe/2)}J=ne.d2c(J)}return q&&q.t&&q.t.posLetter===ne._id&&(ee.boxmode==="group"||ee.violinmode==="group")&&(J+=q.t.dPos),J}function ue(G){return G.offsetTop+G.clientTop}function K(G){return G.offsetLeft+G.clientLeft}function te(G,Y){var ee=G._fullLayout,ne=Y.getBoundingClientRect(),J=ne.x,q=ne.y,ae=J+ne.width,le=q+ne.height,ie=T.apply3DTransform(ee._invTransform)(J,q),se=T.apply3DTransform(ee._invTransform)(ae,le),xe=ie[0],oe=ie[1],he=se[0],be=se[1];return{x:xe,y:oe,width:he-xe,height:be-oe,top:Math.min(oe,be),left:Math.min(xe,he),right:Math.max(xe,he),bottom:Math.max(oe,be)}}},{"../../lib":515,"../../lib/events":504,"../../lib/override_cursor":526,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../legend/defaults":419,"../legend/draw":420,"./constants":401,"./helpers":403,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],405:[function(t,P,R){var h=t("../../lib"),u=t("../color"),A=t("./helpers").isUnifiedHover;P.exports=function(e,i,n,a){a=a||{};var r=i.legend;function f(o){a.font[o]||(a.font[o]=r?i.legend.font[o]:i.font[o])}i&&A(i.hovermode)&&(a.font||(a.font={}),f("size"),f("family"),f("color"),r?(a.bgcolor||(a.bgcolor=u.combine(i.legend.bgcolor,i.paper_bgcolor)),a.bordercolor||(a.bordercolor=i.legend.bordercolor)):a.bgcolor||(a.bgcolor=i.paper_bgcolor)),n("hoverlabel.bgcolor",a.bgcolor),n("hoverlabel.bordercolor",a.bordercolor),n("hoverlabel.namelength",a.namelength),h.coerceFont(n,"hoverlabel.font",a.font),n("hoverlabel.align",a.align)}},{"../../lib":515,"../color":367,"./helpers":403}],406:[function(t,P,R){var h=t("../../lib"),u=t("./layout_attributes");P.exports=function(T,e){function i(n,a){return e[n]!==void 0?e[n]:h.coerce(T,e,u,n,a)}return i("clickmode"),i("hovermode")}},{"../../lib":515,"./layout_attributes":408}],407:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=t("../dragelement"),T=t("./helpers"),e=t("./layout_attributes"),i=t("./hover");P.exports={moduleType:"component",name:"fx",constants:t("./constants"),schema:{layout:e},attributes:t("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:t("./layout_global_defaults"),supplyDefaults:t("./defaults"),supplyLayoutDefaults:t("./layout_defaults"),calc:t("./calc"),getDistanceFunction:T.getDistanceFunction,getClosest:T.getClosest,inbox:T.inbox,quadrature:T.quadrature,appendArrayPointValue:T.appendArrayPointValue,castHoverOption:a,castHoverinfo:r,hover:i.hover,unhover:A.unhover,loneHover:i.loneHover,loneUnhover:n,click:t("./click")};function n(f){var o=u.isD3Selection(f)?f:h.select(f);o.selectAll("g.hovertext").remove(),o.selectAll(".spikeline").remove()}function a(f,o,s){return u.castOption(f,o,"hoverlabel."+s)}function r(f,o,s){function m(g){return u.coerceHoverinfo({hoverinfo:g},{_module:f._module},o)}return u.castOption(f,s,"hoverinfo",m)}},{"../../lib":515,"../dragelement":386,"./attributes":398,"./calc":399,"./click":400,"./constants":401,"./defaults":402,"./helpers":403,"./hover":404,"./layout_attributes":408,"./layout_defaults":409,"./layout_global_defaults":410,"@plotly/d3":58}],408:[function(t,P,R){var h=t("./constants"),u=t("../../plots/font_attributes"),A=u({editType:"none"});A.family.dflt=h.HOVERFONT,A.size.dflt=h.HOVERFONTSIZE,P.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:A,grouptitlefont:u({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":594,"./constants":401}],409:[function(t,P,R){var h=t("../../lib"),u=t("./layout_attributes"),A=t("./hovermode_defaults"),T=t("./hoverlabel_defaults");P.exports=function(i,n){function a(g,p){return h.coerce(i,n,u,g,p)}var r=A(i,n);r&&(a("hoverdistance"),a("spikedistance"));var f=a("dragmode");f==="select"&&a("selectdirection");var o=n._has("mapbox"),s=n._has("geo"),m=n._basePlotModules.length;n.dragmode==="zoom"&&((o||s)&&m===1||o&&s&&m===2)&&(n.dragmode="pan"),T(i,n,a),h.coerceFont(a,"hoverlabel.grouptitlefont",n.hoverlabel.font)}},{"../../lib":515,"./hoverlabel_defaults":405,"./hovermode_defaults":406,"./layout_attributes":408}],410:[function(t,P,R){var h=t("../../lib"),u=t("./hoverlabel_defaults"),A=t("./layout_attributes");P.exports=function(e,i){function n(a,r){return h.coerce(e,i,A,a,r)}u(e,i,n)}},{"../../lib":515,"./hoverlabel_defaults":405,"./layout_attributes":408}],411:[function(t,P,R){var h=t("../../lib"),u=t("../../lib/regex").counter,A=t("../../plots/domain").attributes,T=t("../../plots/cartesian/constants").idRegex,e=t("../../plot_api/plot_template"),i={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[u("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[T.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[T.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:A({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function n(s,m,g){var p=m[g+"axes"],v=Object.keys((s._splomAxes||{})[g]||{});if(Array.isArray(p))return p;if(v.length)return v}function a(s,m){var g=s.grid||{},p=n(m,g,"x"),v=n(m,g,"y");if(!s.grid&&!p&&!v)return;var x=Array.isArray(g.subplots)&&Array.isArray(g.subplots[0]),l=Array.isArray(p),b=Array.isArray(v),c=l&&p!==g.xaxes&&b&&v!==g.yaxes,M,_;x?(M=g.subplots.length,_=g.subplots[0].length):(b&&(M=v.length),l&&(_=p.length));var y=e.newContainer(m,"grid");function w(O,N){return h.coerce(g,y,i,O,N)}var d=w("rows",M),C=w("columns",_);if(!(d*C>1)){delete m.grid;return}if(!x&&!l&&!b){var S=w("pattern")==="independent";S&&(x=!0)}y._hasSubplotGrid=x;var E=w("roworder"),k=E==="top to bottom",B=x?.2:.1,z=x?.3:.1,F,I;c&&m._splomGridDflt&&(F=m._splomGridDflt.xside,I=m._splomGridDflt.yside),y._domains={x:r("x",w,B,F,C),y:r("y",w,z,I,d,k)}}function r(s,m,g,p,v,x){var l=m(s+"gap",g),b=m("domain."+s);m(s+"side",p);for(var c=new Array(v),M=b[0],_=(b[1]-M)/(v-l),y=_*(1-l),w=0;w<v;w++){var d=M+_*w;c[x?v-1-w:w]=[d,d+y]}return c}function f(s,m){var g=m.grid;if(!(!g||!g._domains)){var p=s.grid||{},v=m._subplots,x=g._hasSubplotGrid,l=g.rows,b=g.columns,c=g.pattern==="independent",M,_,y,w,d,C,S,E=g._axisMap={};if(x){var k=p.subplots||[];C=g.subplots=new Array(l);var B=1;for(M=0;M<l;M++){var z=C[M]=new Array(b),F=k[M]||[];for(_=0;_<b;_++)if(c?(d=B===1?"xy":"x"+B+"y"+B,B++):d=F[_],z[_]="",v.cartesian.indexOf(d)!==-1){if(S=d.indexOf("y"),y=d.slice(0,S),w=d.slice(S),E[y]!==void 0&&E[y]!==_||E[w]!==void 0&&E[w]!==M)continue;z[_]=d,E[y]=_,E[w]=M}}}else{var I=n(m,p,"x"),O=n(m,p,"y");g.xaxes=o(I,v.xaxis,b,E,"x"),g.yaxes=o(O,v.yaxis,l,E,"y")}var N=g._anchors={},V=g.roworder==="top to bottom";for(var H in E){var j=H.charAt(0),Z=g[j+"side"],X,re,ue;if(Z.length<8)N[H]="free";else if(j==="x"){if(Z.charAt(0)==="t"===V?(X=0,re=1,ue=l):(X=l-1,re=-1,ue=-1),x){var K=E[H];for(M=X;M!==ue;M+=re)if(d=C[M][K],!!d&&(S=d.indexOf("y"),d.slice(0,S)===H)){N[H]=d.slice(S);break}}else for(M=X;M!==ue;M+=re)if(w=g.yaxes[M],v.cartesian.indexOf(H+w)!==-1){N[H]=w;break}}else if(Z.charAt(0)==="l"?(X=0,re=1,ue=b):(X=b-1,re=-1,ue=-1),x){var te=E[H];for(M=X;M!==ue;M+=re)if(d=C[te][M],!!d&&(S=d.indexOf("y"),d.slice(S)===H)){N[H]=d.slice(0,S);break}}else for(M=X;M!==ue;M+=re)if(y=g.xaxes[M],v.cartesian.indexOf(y+H)!==-1){N[H]=y;break}}}}function o(s,m,g,p,v){var x=new Array(g),l;function b(c,M){m.indexOf(M)!==-1&&p[M]===void 0?(x[c]=M,p[M]=c):x[c]=""}if(Array.isArray(s))for(l=0;l<g;l++)b(l,s[l]);else for(b(0,v),l=1;l<g;l++)b(l,v+(l+1));return x}P.exports={moduleType:"component",name:"grid",schema:{layout:{grid:i}},layoutAttributes:i,sizeDefaults:a,contentDefaults:f}},{"../../lib":515,"../../lib/regex":532,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/domain":593}],412:[function(t,P,R){var h=t("../../plots/cartesian/constants"),u=t("../../plot_api/plot_template").templatedArray;t("../../constants/axis_placeable_objects"),P.exports=u("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",h.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",h.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573}],413:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib/to_log_range");P.exports=function(T,e,i,n){e=e||{};var a=i==="log"&&e.type==="linear",r=i==="linear"&&e.type==="log";if(!!(a||r)){for(var f=T._fullLayout.images,o=e._id.charAt(0),s,m,g=0;g<f.length;g++)if(s=f[g],m="images["+g+"].",s[o+"ref"]===e._id){var p=s[o],v=s["size"+o],x=null,l=null;if(a){x=u(p,e.range);var b=v/Math.pow(10,x)/2;l=2*Math.log(b+Math.sqrt(1+b*b))/Math.LN10}else x=Math.pow(10,p),l=x*(Math.pow(10,v/2)-Math.pow(10,-v/2));h(x)?h(l)||(l=null):(x=null,l=null),n(m+o,x),n(m+"size"+o,l)}}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],414:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axes"),A=t("../../plots/array_container_defaults"),T=t("./attributes"),e="images";P.exports=function(a,r){var f={name:e,handleItemDefaults:i};A(a,r,f)};function i(n,a,r){function f(b,c){return h.coerce(n,a,T,b,c)}var o=f("source"),s=f("visible",!!o);if(!s)return a;f("layer"),f("xanchor"),f("yanchor"),f("sizex"),f("sizey"),f("sizing"),f("opacity");for(var m={_fullLayout:r},g=["x","y"],p=0;p<2;p++){var v=g[p],x=u.coerceRef(n,a,m,v,"paper",void 0);if(x!=="paper"){var l=u.getFromId(m,x);l._imgIndices.push(a._index)}u.coercePosition(a,m,f,x,v,0)}return a}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":412}],415:[function(t,P,R){var h=t("@plotly/d3"),u=t("../drawing"),A=t("../../plots/cartesian/axes"),T=t("../../plots/cartesian/axis_ids"),e=t("../../constants/xmlns_namespaces");P.exports=function(n){var a=n._fullLayout,r=[],f={},o=[],s,m;for(m=0;m<a.images.length;m++){var g=a.images[m];if(g.visible)if(g.layer==="below"&&g.xref!=="paper"&&g.yref!=="paper"){s=T.ref2id(g.xref)+T.ref2id(g.yref);var p=a._plots[s];if(!p){o.push(g);continue}p.mainplot&&(s=p.mainplot.id),f[s]||(f[s]=[]),f[s].push(g)}else g.layer==="above"?r.push(g):o.push(g)}var v={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}};function x(w){var d=h.select(this);if(this._imgSrc!==w.source)if(d.attr("xmlns",e.svg),w.source&&w.source.slice(0,5)==="data:")d.attr("xlink:href",w.source),this._imgSrc=w.source;else{var C=new Promise(function(S){var E=new Image;this.img=E,E.setAttribute("crossOrigin","anonymous"),E.onerror=k,E.onload=function(){var B=document.createElement("canvas");B.width=this.width,B.height=this.height;var z=B.getContext("2d",{willReadFrequently:!0});z.drawImage(this,0,0);var F=B.toDataURL("image/png");d.attr("xlink:href",F),S()},d.on("error",k),E.src=w.source,this._imgSrc=w.source;function k(){d.remove(),S()}}.bind(this));n._promises.push(C)}}function l(w){var d=h.select(this),C=A.getFromId(n,w.xref),S=A.getFromId(n,w.yref),E=A.getRefType(w.xref)==="domain",k=A.getRefType(w.yref)==="domain",B=a._size,z,F;C!==void 0?z=typeof w.xref=="string"&&E?C._length*w.sizex:Math.abs(C.l2p(w.sizex)-C.l2p(0)):z=w.sizex*B.w,S!==void 0?F=typeof w.yref=="string"&&k?S._length*w.sizey:Math.abs(S.l2p(w.sizey)-S.l2p(0)):F=w.sizey*B.h;var I=z*v.x[w.xanchor].offset,O=F*v.y[w.yanchor].offset,N=v.x[w.xanchor].sizing+v.y[w.yanchor].sizing,V,H;switch(C!==void 0?V=typeof w.xref=="string"&&E?C._length*w.x+C._offset:C.r2p(w.x)+C._offset:V=w.x*B.w+B.l,V+=I,S!==void 0?H=typeof w.yref=="string"&&k?S._length*(1-w.y)+S._offset:S.r2p(w.y)+S._offset:H=B.h-w.y*B.h+B.t,H+=O,w.sizing){case"fill":N+=" slice";break;case"stretch":N="none";break}d.attr({x:V,y:H,width:z,height:F,preserveAspectRatio:N,opacity:w.opacity});var j=C&&A.getRefType(w.xref)!=="domain"?C._id:"",Z=S&&A.getRefType(w.yref)!=="domain"?S._id:"",X=j+Z;u.setClipUrl(d,X?"clip"+a._uid+X:null,n)}var b=a._imageLowerLayer.selectAll("image").data(o),c=a._imageUpperLayer.selectAll("image").data(r);b.enter().append("image"),c.enter().append("image"),b.exit().remove(),c.exit().remove(),b.each(function(w){x.bind(this)(w),l.bind(this)(w)}),c.each(function(w){x.bind(this)(w),l.bind(this)(w)});var M=Object.keys(a._plots);for(m=0;m<M.length;m++){s=M[m];var _=a._plots[s];if(!!_.imagelayer){var y=_.imagelayer.selectAll("image").data(f[s]||[]);y.enter().append("image"),y.exit().remove(),y.each(function(w){x.bind(this)(w),l.bind(this)(w)})}}}},{"../../constants/xmlns_namespaces":492,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../drawing":389,"@plotly/d3":58}],416:[function(t,P,R){P.exports={moduleType:"component",name:"images",layoutAttributes:t("./attributes"),supplyLayoutDefaults:t("./defaults"),includeBasePlot:t("../../plots/cartesian/include_components")("images"),draw:t("./draw"),convertCoords:t("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":412,"./convert_coords":413,"./defaults":414,"./draw":415}],417:[function(t,P,R){var h=t("../../plots/font_attributes"),u=t("../color/attributes");P.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:u.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:h({editType:"legend"}),grouptitlefont:h({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},entrywidth:{valType:"number",min:0,editType:"legend"},entrywidthmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels",editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:h({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":594,"../color/attributes":366}],418:[function(t,P,R){P.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],419:[function(t,P,R){var h=t("../../registry"),u=t("../../lib"),A=t("../../plot_api/plot_template"),T=t("../../plots/attributes"),e=t("./attributes"),i=t("../../plots/layout_attributes"),n=t("./helpers");P.exports=function(r,f,o){var s=r.legend||{},m=A.newContainer(f,"legend");function g(F,I){return u.coerce(s,m,e,F,I)}for(var p,v=function(F,I){var O=p._input,N=p;return u.coerce(O,N,T,F,I)},x=f.font||{},l=u.coerceFont(g,"grouptitlefont",u.extendFlat({},x,{size:Math.round(x.size*1.1)})),b=0,c=!1,M="normal",_=0;_<o.length;_++)p=o[_],p.visible&&((p.showlegend||p._dfltShowLegend&&!(p._module&&p._module.attributes&&p._module.attributes.showlegend&&p._module.attributes.showlegend.dflt===!1))&&(b++,p.showlegend&&(c=!0,(h.traceIs(p,"pie-like")||p._input.showlegend===!0)&&b++),u.coerceFont(v,"legendgrouptitle.font",l)),(h.traceIs(p,"bar")&&f.barmode==="stack"||["tonextx","tonexty"].indexOf(p.fill)!==-1)&&(M=n.isGrouped({traceorder:M})?"grouped+reversed":"reversed"),p.legendgroup!==void 0&&p.legendgroup!==""&&(M=n.isReversed({traceorder:M})?"reversed+grouped":"grouped"));var y=u.coerce(r,f,i,"showlegend",c&&b>1);if(y===!1&&(f.legend=void 0),!(y===!1&&!s.uirevision)&&(g("uirevision",f.uirevision),y!==!1)){g("bgcolor",f.paper_bgcolor),g("bordercolor"),g("borderwidth");var w=u.coerceFont(g,"font",f.font),d=g("orientation"),C=d==="h",S,E,k;C?(S=0,h.getComponentMethod("rangeslider","isVisible")(r.xaxis)?(E=1.1,k="bottom"):(E=-.1,k="top")):(S=1.02,E=1,k="auto"),g("traceorder",M),n.isGrouped(f.legend)&&g("tracegroupgap"),g("entrywidth"),g("entrywidthmode"),g("itemsizing"),g("itemwidth"),g("itemclick"),g("itemdoubleclick"),g("groupclick"),g("x",S),g("xanchor"),g("y",E),g("yanchor",k),g("valign"),u.noneOrAll(s,m,["x","y"]);var B=g("title.text");if(B){g("title.side",C?"left":"top");var z=u.extendFlat({},w,{size:u.bigFont(w.size)});u.coerceFont(g,"title.font",z)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/layout_attributes":619,"../../registry":647,"./attributes":417,"./helpers":423}],420:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=t("../../plots/plots"),T=t("../../registry"),e=t("../../lib/events"),i=t("../dragelement"),n=t("../drawing"),a=t("../color"),r=t("../../lib/svg_text_utils"),f=t("./handle_click"),o=t("./constants"),s=t("../../constants/alignment"),m=s.LINE_SPACING,g=s.FROM_TL,p=s.FROM_BR,v=t("./get_legend_data"),x=t("./style"),l=t("./helpers"),b=1;P.exports=function(O,N){return N||(N=O._fullLayout.legend||{}),c(O,N)};function c(I,O){var N=I._fullLayout,V="legend"+N._uid,H,j=O._inHover;if(j?(H=O.layer,V+="-hover"):H=N._infolayer,!!H){I._legendMouseDownTime||(I._legendMouseDownTime=0);var Z;if(j){if(!O.entries)return;Z=v(O.entries,O)}else{if(!I.calcdata)return;Z=N.showlegend&&v(I.calcdata,O)}var X=N.hiddenlabels||[];if(!j&&(!N.showlegend||!Z.length))return H.selectAll(".legend").remove(),N._topdefs.select("#"+V).remove(),A.autoMargin(I,"legend");var re=u.ensureSingle(H,"g","legend",function(q){j||q.attr("pointer-events","all")}),ue=u.ensureSingleById(N._topdefs,"clipPath",V,function(q){q.append("rect")}),K=u.ensureSingle(re,"rect","bg",function(q){q.attr("shape-rendering","crispEdges")});K.call(a.stroke,O.bordercolor).call(a.fill,O.bgcolor).style("stroke-width",O.borderwidth+"px");var te=u.ensureSingle(re,"g","scrollbox"),G=O.title;if(O._titleWidth=0,O._titleHeight=0,G.text){var Y=u.ensureSingle(te,"text","legendtitletext");Y.attr("text-anchor","start").call(n.font,G.font).text(G.text),C(Y,te,I,O,b)}else te.selectAll(".legendtitletext").remove();var ee=u.ensureSingle(re,"rect","scrollbar",function(q){q.attr(o.scrollBarEnterAttrs).call(a.fill,o.scrollBarColor)}),ne=te.selectAll("g.groups").data(Z);ne.enter().append("g").attr("class","groups"),ne.exit().remove();var J=ne.selectAll("g.traces").data(u.identity);J.enter().append("g").attr("class","traces"),J.exit().remove(),J.style("opacity",function(q){var ae=q[0].trace;return T.traceIs(ae,"pie-like")?X.indexOf(q[0].label)!==-1?.5:1:ae.visible==="legendonly"?.5:1}).each(function(){h.select(this).call(y,I,O)}).call(x,I,O).each(function(){j||h.select(this).call(d,I)}),u.syncOrAsync([A.previousPromises,function(){return k(I,ne,J,O)},function(){var q=N._size,ae=O.borderwidth;if(!j){var le=B(I);if(le)return;var ie=q.l+q.w*O.x-g[z(O)]*O._width,se=q.t+q.h*(1-O.y)-g[F(O)]*O._effHeight;if(N.margin.autoexpand){var xe=ie,oe=se;ie=u.constrain(ie,0,N.width-O._width),se=u.constrain(se,0,N.height-O._effHeight),ie!==xe&&u.log("Constrain legend.x to make legend fit inside graph"),se!==oe&&u.log("Constrain legend.y to make legend fit inside graph")}n.setTranslate(re,ie,se)}if(ee.on(".drag",null),re.on("wheel",null),j||O._height<=O._maxHeight||I._context.staticPlot){var he=O._effHeight;j&&(he=O._height),K.attr({width:O._width-ae,height:he-ae,x:ae/2,y:ae/2}),n.setTranslate(te,0,0),ue.select("rect").attr({width:O._width-2*ae,height:he-2*ae,x:ae,y:ae}),n.setClipUrl(te,V,I),n.setRect(ee,0,0,0,0),delete O._scrollY}else{var be=Math.max(o.scrollBarMinHeight,O._effHeight*O._effHeight/O._height),me=O._effHeight-be-2*o.scrollBarMargin,_e=O._height-O._effHeight,Se=me/_e,De=Math.min(O._scrollY||0,_e);K.attr({width:O._width-2*ae+o.scrollBarWidth+o.scrollBarMargin,height:O._effHeight-ae,x:ae/2,y:ae/2}),ue.select("rect").attr({width:O._width-2*ae+o.scrollBarWidth+o.scrollBarMargin,height:O._effHeight-2*ae,x:ae,y:ae+De}),n.setClipUrl(te,V,I),We(De,be,Se),re.on("wheel",function(){De=u.constrain(O._scrollY+h.event.deltaY/me*_e,0,_e),We(De,be,Se),De!==0&&De!==_e&&h.event.preventDefault()});var Ie,Te,Ce,He=function(At,Wt,Bt){var Ct=(Bt-Wt)/Se+At;return u.constrain(Ct,0,_e)},Xe=function(At,Wt,Bt){var Ct=(Wt-Bt)/Se+At;return u.constrain(Ct,0,_e)},Be=h.behavior.drag().on("dragstart",function(){var At=h.event.sourceEvent;At.type==="touchstart"?Ie=At.changedTouches[0].clientY:Ie=At.clientY,Ce=De}).on("drag",function(){var At=h.event.sourceEvent;At.buttons===2||At.ctrlKey||(At.type==="touchmove"?Te=At.changedTouches[0].clientY:Te=At.clientY,De=He(Ce,Ie,Te),We(De,be,Se))});ee.call(Be);var Re=h.behavior.drag().on("dragstart",function(){var At=h.event.sourceEvent;At.type==="touchstart"&&(Ie=At.changedTouches[0].clientY,Ce=De)}).on("drag",function(){var At=h.event.sourceEvent;At.type==="touchmove"&&(Te=At.changedTouches[0].clientY,De=Xe(Ce,Ie,Te),We(De,be,Se))});te.call(Re)}function We(At,Wt,Bt){O._scrollY=I._fullLayout.legend._scrollY=At,n.setTranslate(te,0,-At),n.setRect(ee,O._width,o.scrollBarMargin+At*Bt,o.scrollBarWidth,Wt),ue.select("rect").attr("y",ae+At)}if(I._context.edits.legendPosition){var vt,Pt,Zt,zt;re.classed("cursor-move",!0),i.init({element:re.node(),gd:I,prepFn:function(){var At=n.getTranslate(re);Zt=At.x,zt=At.y},moveFn:function(At,Wt){var Bt=Zt+At,Ct=zt+Wt;n.setTranslate(re,Bt,Ct),vt=i.align(Bt,0,q.l,q.l+q.w,O.xanchor),Pt=i.align(Ct,0,q.t+q.h,q.t,O.yanchor)},doneFn:function(){vt!==void 0&&Pt!==void 0&&T.call("_guiRelayout",I,{"legend.x":vt,"legend.y":Pt})},clickFn:function(At,Wt){var Bt=H.selectAll("g.traces").filter(function(){var Ct=this.getBoundingClientRect();return Wt.clientX>=Ct.left&&Wt.clientX<=Ct.right&&Wt.clientY>=Ct.top&&Wt.clientY<=Ct.bottom});Bt.size()>0&&_(I,re,Bt,At,Wt)}})}}],I)}}function M(I,O,N){var V=I[0],H=V.width,j=O.entrywidthmode,Z=V.trace.legendwidth||O.entrywidth;return j==="fraction"?O._maxWidth*Z:N+(Z||H)}function _(I,O,N,V,H){var j=N.data()[0][0].trace,Z={event:H,node:N.node(),curveNumber:j.index,expandedIndex:j._expandedIndex,data:I.data,layout:I.layout,frames:I._transitionData._frames,config:I._context,fullData:I._fullData,fullLayout:I._fullLayout};j._group&&(Z.group=j._group),T.traceIs(j,"pie-like")&&(Z.label=N.datum()[0].label);var X=e.triggerHandler(I,"plotly_legendclick",Z);if(X!==!1){if(V===1)O._clickTimeout=setTimeout(function(){!I._fullLayout||f(N,I,V)},I._context.doubleClickDelay);else if(V===2){O._clickTimeout&&clearTimeout(O._clickTimeout),I._legendMouseDownTime=0;var re=e.triggerHandler(I,"plotly_legenddoubleclick",Z);re!==!1&&f(N,I,V)}}}function y(I,O,N){var V=I.data()[0][0],H=V.trace,j=T.traceIs(H,"pie-like"),Z=!N._inHover&&O._context.edits.legendText&&!j,X=N._maxNameLength,re,ue;V.groupTitle?(re=V.groupTitle.text,ue=V.groupTitle.font):(ue=N.font,N.entries?re=V.text:(re=j?V.label:H.name,H._meta&&(re=u.templateString(re,H._meta))));var K=u.ensureSingle(I,"text","legendtext");K.attr("text-anchor","start").call(n.font,ue).text(Z?w(re,X):re);var te=N.itemwidth+o.itemGap*2;r.positionText(K,te,0),Z?K.call(r.makeEditable,{gd:O,text:re}).call(C,I,O,N).on("edit",function(G){this.text(w(G,X)).call(C,I,O,N);var Y=V.trace._fullInput||{},ee={};if(T.hasTransform(Y,"groupby")){var ne=T.getTransformIndices(Y,"groupby"),J=ne[ne.length-1],q=u.keyedContainer(Y,"transforms["+J+"].styles","target","value.name");q.set(V.trace._group,G),ee=q.constructUpdate()}else ee.name=G;return T.call("_guiRestyle",O,ee,H.index)}):C(K,I,O,N)}function w(I,O){var N=Math.max(4,O);if(I&&I.trim().length>=N/2)return I;I=I||"";for(var V=N-I.length;V>0;V--)I+=" ";return I}function d(I,O){var N=O._context.doubleClickDelay,V,H=1,j=u.ensureSingle(I,"rect","legendtoggle",function(Z){O._context.staticPlot||Z.style("cursor","pointer").attr("pointer-events","all"),Z.call(a.fill,"rgba(0,0,0,0)")});O._context.staticPlot||(j.on("mousedown",function(){V=new Date().getTime(),V-O._legendMouseDownTime<N?H+=1:(H=1,O._legendMouseDownTime=V)}),j.on("mouseup",function(){if(!(O._dragged||O._editing)){var Z=O._fullLayout.legend;new Date().getTime()-O._legendMouseDownTime>N&&(H=Math.max(H-1,1)),_(O,Z,I,H,h.event)}}))}function C(I,O,N,V,H){V._inHover&&I.attr("data-notex",!0),r.convertToTspans(I,N,function(){S(O,N,V,H)})}function S(I,O,N,V){var H=I.data()[0][0];if(!N._inHover&&H&&!H.trace.showlegend){I.remove();return}var j=I.select("g[class*=math-group]"),Z=j.node();N||(N=O._fullLayout.legend);var X=N.borderwidth,re;V===b?re=N.title.font:H.groupTitle?re=H.groupTitle.font:re=N.font;var ue=re.size*m,K,te;if(Z){var G=n.bBox(Z);K=G.height,te=G.width,V===b?n.setTranslate(j,X,X+K*.75):n.setTranslate(j,0,K*.25)}else{var Y=I.select(V===b?".legendtitletext":".legendtext"),ee=r.lineCount(Y),ne=Y.node();if(K=ue*ee,te=ne?n.bBox(ne).width:0,V===b)N.title.side==="left"&&(te+=o.itemGap*2),r.positionText(Y,X+o.titlePad,X+ue);else{var J=o.itemGap*2+N.itemwidth;H.groupTitle&&(J=o.itemGap,te-=N.itemwidth),r.positionText(Y,J,-ue*((ee-1)/2-.3))}}V===b?(N._titleWidth=te,N._titleHeight=K):(H.lineHeight=ue,H.height=Math.max(K,16)+3,H.width=te)}function E(I){var O=0,N=0,V=I.title.side;return V&&(V.indexOf("left")!==-1&&(O=I._titleWidth),V.indexOf("top")!==-1&&(N=I._titleHeight)),[O,N]}function k(I,O,N,V){var H=I._fullLayout;V||(V=H.legend);var j=H._size,Z=l.isVertical(V),X=l.isGrouped(V),re=V.entrywidthmode==="fraction",ue=V.borderwidth,K=2*ue,te=o.itemGap,G=V.itemwidth+te*2,Y=2*(ue+te),ee=F(V),ne=V.y<0||V.y===0&&ee==="top",J=V.y>1||V.y===1&&ee==="bottom",q=V.tracegroupgap,ae={};V._maxHeight=Math.max(ne||J?H.height/2:j.h,30);var le=0;V._width=0,V._height=0;var ie=E(V);if(Z)N.each(function(Zt){var zt=Zt[0].height;n.setTranslate(this,ue+ie[0],ue+ie[1]+V._height+zt/2+te),V._height+=zt,V._width=Math.max(V._width,Zt[0].width)}),le=G+V._width,V._width+=te+G+K,V._height+=Y,X&&(O.each(function(Zt,zt){n.setTranslate(this,0,zt*V.tracegroupgap)}),V._height+=(V._lgroupsLength-1)*V.tracegroupgap);else{var se=z(V),xe=V.x<0||V.x===0&&se==="right",oe=V.x>1||V.x===1&&se==="left",he=J||ne,be=H.width/2;V._maxWidth=Math.max(xe?he&&se==="left"?j.l+j.w:be:oe?he&&se==="right"?j.r+j.w:be:j.w,2*G);var me=0,_e=0;N.each(function(Zt){var zt=M(Zt,V,G);me=Math.max(me,zt),_e+=zt}),le=null;var Se=0;if(X){var De=0,Ie=0,Te=0;O.each(function(){var Zt=0,zt=0;h.select(this).selectAll("g.traces").each(function(Wt){var Bt=M(Wt,V,G),Ct=Wt[0].height;n.setTranslate(this,ie[0],ie[1]+ue+te+Ct/2+zt),zt+=Ct,Zt=Math.max(Zt,Bt),ae[Wt[0].trace.legendgroup]=Zt});var At=Zt+te;Ie>0&&At+ue+Ie>V._maxWidth?(Se=Math.max(Se,Ie),Ie=0,Te+=De+q,De=zt):De=Math.max(De,zt),n.setTranslate(this,Ie,Te),Ie+=At}),V._width=Math.max(Se,Ie)+ue,V._height=Te+De+Y}else{var Ce=N.size(),He=_e+K+(Ce-1)*te<V._maxWidth,Xe=0,Be=0,Re=0,We=0;N.each(function(Zt){var zt=Zt[0].height,At=M(Zt,V,G),Wt=He?At:me;re||(Wt+=te),Wt+ue+Be-te>=V._maxWidth&&(Se=Math.max(Se,We),Be=0,Re+=Xe,V._height+=Xe,Xe=0),n.setTranslate(this,ie[0]+ue+Be,ie[1]+ue+Re+zt/2+te),We=Be+At+te,Be+=Wt,Xe=Math.max(Xe,zt)}),He?(V._width=Be+K,V._height=Xe+Y):(V._width=Math.max(Se,We)+K,V._height+=Xe+Y)}}V._width=Math.ceil(Math.max(V._width+ie[0],V._titleWidth+2*(ue+o.titlePad))),V._height=Math.ceil(Math.max(V._height+ie[1],V._titleHeight+2*(ue+o.itemGap))),V._effHeight=Math.min(V._height,V._maxHeight);var vt=I._context.edits,Pt=vt.legendText||vt.legendPosition;N.each(function(Zt){var zt=h.select(this).select(".legendtoggle"),At=Zt[0].height,Wt=Zt[0].trace.legendgroup,Bt=M(Zt,V,G);X&&Wt!==""&&(Bt=ae[Wt]);var Ct=Pt?G:le||Bt;!Z&&!re&&(Ct+=te/2),n.setRect(zt,0,-At/2,Ct,At)})}function B(I){var O=I._fullLayout,N=O.legend,V=z(N),H=F(N);return A.autoMargin(I,"legend",{x:N.x,y:N.y,l:N._width*g[V],r:N._width*p[V],b:N._effHeight*p[H],t:N._effHeight*g[H]})}function z(I){return u.isRightAnchor(I)?"right":u.isCenterAnchor(I)?"center":"left"}function F(I){return u.isBottomAnchor(I)?"bottom":u.isMiddleAnchor(I)?"middle":"top"}},{"../../constants/alignment":483,"../../lib":515,"../../lib/events":504,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":418,"./get_legend_data":421,"./handle_click":422,"./helpers":423,"./style":425,"@plotly/d3":58}],421:[function(t,P,R){var h=t("../../registry"),u=t("./helpers");P.exports=function(T,e){var i=e._inHover,n=u.isGrouped(e),a=u.isReversed(e),r={},f=[],o=!1,s={},m=0,g=0,p,v;function x(O,N){if(O===""||!u.isGrouped(e)){var V="~~i"+m;f.push(V),r[V]=[N],m++}else f.indexOf(O)===-1?(f.push(O),o=!0,r[O]=[N]):r[O].push(N)}for(p=0;p<T.length;p++){var l=T[p],b=l[0],c=b.trace,M=c.legendgroup;if(!(!i&&(!c.visible||!c.showlegend)))if(h.traceIs(c,"pie-like"))for(s[M]||(s[M]={}),v=0;v<l.length;v++){var _=l[v].label;s[M][_]||(x(M,{label:_,color:l[v].color,i:l[v].i,trace:c,pts:l[v].pts}),s[M][_]=!0,g=Math.max(g,(_||"").length))}else x(M,b),g=Math.max(g,(c.name||"").length)}if(!f.length)return[];var y=!o||!n,w=[];for(p=0;p<f.length;p++){var d=r[f[p]];y?w.push(d[0]):w.push(d)}for(y&&(w=[w]),p=0;p<w.length;p++){var C=1/0;for(v=0;v<w[p].length;v++){var S=w[p][v].trace.legendrank;C>S&&(C=S)}w[p][0]._groupMinRank=C,w[p][0]._preGroupSort=p}var E=function(O,N){return O[0]._groupMinRank-N[0]._groupMinRank||O[0]._preGroupSort-N[0]._preGroupSort},k=function(O,N){return O.trace.legendrank-N.trace.legendrank||O._preSort-N._preSort};for(w.forEach(function(O,N){O[0]._preGroupSort=N}),w.sort(E),p=0;p<w.length;p++){w[p].forEach(function(O,N){O._preSort=N}),w[p].sort(k);var B=w[p][0].trace,z=null;for(v=0;v<w[p].length;v++){var F=w[p][v].trace.legendgrouptitle;if(F&&F.text){z=F,i&&(F.font=e._groupTitleFont);break}}if(a&&w[p].reverse(),z){var I=!1;for(v=0;v<w[p].length;v++)if(h.traceIs(w[p][v].trace,"pie-like")){I=!0;break}w[p].unshift({i:-1,groupTitle:z,noClick:I,trace:{showlegend:B.showlegend,legendgroup:B.legendgroup,visible:e.groupclick==="toggleitem"?!0:B.visible}})}for(v=0;v<w[p].length;v++)w[p][v]=[w[p][v]]}return e._lgroupsLength=w.length,e._maxNameLength=g,w}},{"../../registry":647,"./helpers":423}],422:[function(t,P,R){var h=t("../../lib"),u=t("../../registry"),A=!0;P.exports=function(e,i,n){var a=i._fullLayout;if(i._dragged||i._editing)return;var r=a.legend.itemclick,f=a.legend.itemdoubleclick,o=a.legend.groupclick;n===1&&r==="toggle"&&f==="toggleothers"&&A&&i.data&&i._context.showTips&&h.notifier(h._(i,"Double-click on legend to isolate one trace"),"long"),A=!1;var s;if(n===1?s=r:n===2&&(s=f),!s)return;var m=o==="togglegroup",g=a.hiddenlabels?a.hiddenlabels.slice():[],p=e.data()[0][0];if(p.groupTitle&&p.noClick)return;var v=i._fullData,x=p.trace,l=x.legendgroup,b,c,M,_,y,w,d={},C=[],S=[],E=[];function k(te,G,Y){var ee=C.indexOf(te),ne=d[G];return ne||(ne=d[G]=[]),C.indexOf(te)===-1&&(C.push(te),ee=C.length-1),ne[ee]=Y,ee}function B(te,G){if(!(p.groupTitle&&!m)){var Y=te._fullInput;if(u.hasTransform(Y,"groupby")){var ee=S[Y.index];if(!ee){var ne=u.getTransformIndices(Y,"groupby"),J=ne[ne.length-1];ee=h.keyedContainer(Y,"transforms["+J+"].styles","target","value.visible"),S[Y.index]=ee}var q=ee.get(te._group);q===void 0&&(q=!0),q!==!1&&ee.set(te._group,G),E[Y.index]=k(Y.index,"visible",Y.visible!==!1)}else{var ae=Y.visible===!1?!1:G;k(Y.index,"visible",ae)}}}if(u.traceIs(x,"pie-like")){var z=p.label,F=g.indexOf(z);s==="toggle"?F===-1?g.push(z):g.splice(F,1):s==="toggleothers"&&(g=[],i.calcdata[0].forEach(function(te){z!==te.label&&g.push(te.label)}),i._fullLayout.hiddenlabels&&i._fullLayout.hiddenlabels.length===g.length&&F===-1&&(g=[])),u.call("_guiRelayout",i,"hiddenlabels",g)}else{var I=l&&l.length,O=[],N;if(I)for(b=0;b<v.length;b++)N=v[b],!!N.visible&&N.legendgroup===l&&O.push(b);if(s==="toggle"){var V;switch(x.visible){case!0:V="legendonly";break;case!1:V=!1;break;case"legendonly":V=!0;break}if(I)if(m)for(b=0;b<v.length;b++)v[b].visible!==!1&&v[b].legendgroup===l&&B(v[b],V);else B(x,V);else B(x,V)}else if(s==="toggleothers"){var H,j,Z,X,re=!0;for(b=0;b<v.length;b++)if(H=v[b]===x,Z=v[b].showlegend!==!0,!(H||Z)&&(j=I&&v[b].legendgroup===l,!j&&v[b].visible===!0&&!u.traceIs(v[b],"notLegendIsolatable"))){re=!1;break}for(b=0;b<v.length;b++)if(v[b].visible!==!1&&!u.traceIs(v[b],"notLegendIsolatable"))switch(x.visible){case"legendonly":B(v[b],!0);break;case!0:X=re?!0:"legendonly",H=v[b]===x,Z=v[b].showlegend!==!0&&!v[b].legendgroup,j=H||I&&v[b].legendgroup===l,B(v[b],j||Z?!0:X);break}}for(b=0;b<S.length;b++)if(M=S[b],!!M){var ue=M.constructUpdate(),K=Object.keys(ue);for(c=0;c<K.length;c++)_=K[c],w=d[_]=d[_]||[],w[E[b]]=ue[_]}for(y=Object.keys(d),b=0;b<y.length;b++)for(_=y[b],c=0;c<C.length;c++)d[_].hasOwnProperty(c)||(d[_][c]=void 0);u.call("_guiRestyle",i,d,C)}}},{"../../lib":515,"../../registry":647}],423:[function(t,P,R){R.isGrouped=function(u){return(u.traceorder||"").indexOf("grouped")!==-1},R.isVertical=function(u){return u.orientation!=="h"},R.isReversed=function(u){return(u.traceorder||"").indexOf("reversed")!==-1}},{}],424:[function(t,P,R){P.exports={moduleType:"component",name:"legend",layoutAttributes:t("./attributes"),supplyLayoutDefaults:t("./defaults"),draw:t("./draw"),style:t("./style")}},{"./attributes":417,"./defaults":419,"./draw":420,"./style":425}],425:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../registry"),A=t("../../lib"),T=A.strTranslate,e=t("../drawing"),i=t("../color"),n=t("../colorscale/helpers").extractOpts,a=t("../../traces/scatter/subtypes"),r=t("../../traces/pie/style_one"),f=t("../../traces/pie/helpers").castOption,o=t("./constants"),s=12,m=5,g=2,p=10,v=5;P.exports=function(M,_,y){var w=_._fullLayout;y||(y=w.legend);var d=y.itemsizing==="constant",C=y.itemwidth,S=(C+o.itemGap*2)/2,E=T(S,0),k=function(K,te,G,Y){var ee;if(K+1)ee=K;else if(te&&te.width>0)ee=te.width;else return 0;return d?Y:Math.min(ee,G)};M.each(function(K){var te=h.select(this),G=A.ensureSingle(te,"g","layers");G.style("opacity",K[0].trace.opacity);var Y=y.valign,ee=K[0].lineHeight,ne=K[0].height;if(Y==="middle"||!ee||!ne)G.attr("transform",null);else{var J={top:1,bottom:-1}[Y],q=J*(.5*(ee-ne+3));G.attr("transform",T(0,q))}var ae=G.selectAll("g.legendfill").data([K]);ae.enter().append("g").classed("legendfill",!0);var le=G.selectAll("g.legendlines").data([K]);le.enter().append("g").classed("legendlines",!0);var ie=G.selectAll("g.legendsymbols").data([K]);ie.enter().append("g").classed("legendsymbols",!0),ie.selectAll("g.legendpoints").data([K]).enter().append("g").classed("legendpoints",!0)}).each(ue).each(F).each(O).each(I).each(V).each(X).each(Z).each(B).each(z).each(H).each(j);function B(K){var te=l(K),G=te.showFill,Y=te.showLine,ee=te.showGradientLine,ne=te.showGradientFill,J=te.anyFill,q=te.anyLine,ae=K[0],le=ae.trace,ie,se,xe=n(le),oe=xe.colorscale,he=xe.reversescale,be=function(Ce){if(Ce.size())if(G)e.fillGroupStyle(Ce,_);else{var He="legendfill-"+le.uid;e.gradient(Ce,_,He,x(he),oe,"fill")}},me=function(Ce){if(Ce.size()){var He="legendline-"+le.uid;e.lineGroupStyle(Ce),e.gradient(Ce,_,He,x(he),oe,"stroke")}},_e=a.hasMarkers(le)||!J?"M5,0":q?"M5,-2":"M5,-3",Se=h.select(this),De=Se.select(".legendfill").selectAll("path").data(G||ne?[K]:[]);if(De.enter().append("path").classed("js-fill",!0),De.exit().remove(),De.attr("d",_e+"h"+C+"v6h-"+C+"z").call(be),Y||ee){var Ie=k(void 0,le.line,p,m);se=A.minExtend(le,{line:{width:Ie}}),ie=[A.minExtend(ae,{trace:se})]}var Te=Se.select(".legendlines").selectAll("path").data(Y||ee?[ie]:[]);Te.enter().append("path").classed("js-line",!0),Te.exit().remove(),Te.attr("d",_e+(ee?"l"+C+",0.0001":"h"+C)).call(Y?e.lineGroupStyle:me)}function z(K){var te=l(K),G=te.anyFill,Y=te.anyLine,ee=te.showLine,ne=te.showMarker,J=K[0],q=J.trace,ae=!ne&&!Y&&!G&&a.hasText(q),le,ie;function se(De,Ie,Te,Ce){var He=A.nestedProperty(q,De).get(),Xe=A.isArrayOrTypedArray(He)&&Ie?Ie(He):He;if(d&&Xe&&Ce!==void 0&&(Xe=Ce),Te){if(Xe<Te[0])return Te[0];if(Xe>Te[1])return Te[1]}return Xe}function xe(De){return J._distinct&&J.index&&De[J.index]?De[J.index]:De[0]}if(ne||ae||ee){var oe={},he={};if(ne){oe.mc=se("marker.color",xe),oe.mx=se("marker.symbol",xe),oe.mo=se("marker.opacity",A.mean,[.2,1]),oe.mlc=se("marker.line.color",xe),oe.mlw=se("marker.line.width",A.mean,[0,5],g),he.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var be=se("marker.size",A.mean,[2,16],s);oe.ms=be,he.marker.size=be}ee&&(he.line={width:se("line.width",xe,[0,10],m)}),ae&&(oe.tx="Aa",oe.tp=se("textposition",xe),oe.ts=10,oe.tc=se("textfont.color",xe),oe.tf=se("textfont.family",xe)),le=[A.minExtend(J,oe)],ie=A.minExtend(q,he),ie.selectedpoints=null,ie.texttemplate=null}var me=h.select(this).select("g.legendpoints"),_e=me.selectAll("path.scatterpts").data(ne?le:[]);_e.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",E),_e.exit().remove(),_e.call(e.pointStyle,ie,_),ne&&(le[0].mrc=3);var Se=me.selectAll("g.pointtext").data(ae?le:[]);Se.enter().append("g").classed("pointtext",!0).append("text").attr("transform",E),Se.exit().remove(),Se.selectAll("text").call(e.textPointStyle,ie,_)}function F(K){var te=K[0].trace,G=te.type==="waterfall";if(K[0]._distinct&&G){var Y=K[0].trace[K[0].dir].marker;return K[0].mc=Y.color,K[0].mlw=Y.line.width,K[0].mlc=Y.line.color,N(K,this,"waterfall")}var ee=[];te.visible&&G&&(ee=K[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var ne=h.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(ee);ne.enter().append("path").classed("legendwaterfall",!0).attr("transform",E).style("stroke-miterlimit",1),ne.exit().remove(),ne.each(function(J){var q=h.select(this),ae=te[J[0]].marker,le=k(void 0,ae.line,v,g);q.attr("d",J[1]).style("stroke-width",le+"px").call(i.fill,ae.color),le&&q.call(i.stroke,ae.line.color)})}function I(K){N(K,this)}function O(K){N(K,this,"funnel")}function N(K,te,G){var Y=K[0].trace,ee=Y.marker||{},ne=ee.line||{},J=G?Y.visible&&Y.type===G:u.traceIs(Y,"bar"),q=h.select(te).select("g.legendpoints").selectAll("path.legend"+G).data(J?[K]:[]);q.enter().append("path").classed("legend"+G,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",E),q.exit().remove(),q.each(function(ae){var le=h.select(this),ie=ae[0],se=k(ie.mlw,ee.line,v,g);le.style("stroke-width",se+"px");var xe=ie.mcc;if(!y._inHover&&"mc"in ie){var oe=n(ee),he=oe.mid;he===void 0&&(he=(oe.max+oe.min)/2),xe=e.tryColorscale(ee,"")(he)}var be=xe||ie.mc||ee.color,me=ee.pattern,_e=me&&e.getPatternAttr(me.shape,0,"");if(_e){var Se=e.getPatternAttr(me.bgcolor,0,null),De=e.getPatternAttr(me.fgcolor,0,null),Ie=me.fgopacity,Te=b(me.size,8,10),Ce=b(me.solidity,.5,1),He="legend-"+Y.uid;le.call(e.pattern,"legend",_,He,_e,Te,Ce,xe,me.fillmode,Se,De,Ie)}else le.call(i.fill,be);se&&i.stroke(le,ie.mlc||ne.color)})}function V(K){var te=K[0].trace,G=h.select(this).select("g.legendpoints").selectAll("path.legendbox").data(te.visible&&u.traceIs(te,"box-violin")?[K]:[]);G.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",E),G.exit().remove(),G.each(function(){var Y=h.select(this);if((te.boxpoints==="all"||te.points==="all")&&i.opacity(te.fillcolor)===0&&i.opacity((te.line||{}).color)===0){var ee=A.minExtend(te,{marker:{size:d?s:A.constrain(te.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});G.call(e.pointStyle,ee,_)}else{var ne=k(void 0,te.line,v,g);Y.style("stroke-width",ne+"px").call(i.fill,te.fillcolor),ne&&i.stroke(Y,te.line.color)}})}function H(K){var te=K[0].trace,G=h.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(te.visible&&te.type==="candlestick"?[K,K]:[]);G.enter().append("path").classed("legendcandle",!0).attr("d",function(Y,ee){return ee?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",E).style("stroke-miterlimit",1),G.exit().remove(),G.each(function(Y,ee){var ne=h.select(this),J=te[ee?"increasing":"decreasing"],q=k(void 0,J.line,v,g);ne.style("stroke-width",q+"px").call(i.fill,J.fillcolor),q&&i.stroke(ne,J.line.color)})}function j(K){var te=K[0].trace,G=h.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(te.visible&&te.type==="ohlc"?[K,K]:[]);G.enter().append("path").classed("legendohlc",!0).attr("d",function(Y,ee){return ee?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",E).style("stroke-miterlimit",1),G.exit().remove(),G.each(function(Y,ee){var ne=h.select(this),J=te[ee?"increasing":"decreasing"],q=k(void 0,J.line,v,g);ne.style("fill","none").call(e.dashLine,J.line.dash,q),q&&i.stroke(ne,J.line.color)})}function Z(K){re(K,this,"pie")}function X(K){re(K,this,"funnelarea")}function re(K,te,G){var Y=K[0],ee=Y.trace,ne=G?ee.visible&&ee.type===G:u.traceIs(ee,G),J=h.select(te).select("g.legendpoints").selectAll("path.legend"+G).data(ne?[K]:[]);if(J.enter().append("path").classed("legend"+G,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",E),J.exit().remove(),J.size()){var q=(ee.marker||{}).line,ae=k(f(q.width,Y.pts),q,v,g),le=A.minExtend(ee,{marker:{line:{width:ae}}});le.marker.line.color=q.color;var ie=A.minExtend(Y,{trace:le});r(J,ie,le)}}function ue(K){var te=K[0].trace,G,Y=[];if(te.visible)switch(te.type){case"histogram2d":case"heatmap":Y=[["M-15,-2V4H15V-2Z"]],G=!0;break;case"choropleth":case"choroplethmapbox":Y=[["M-6,-6V6H6V-6Z"]],G=!0;break;case"densitymapbox":Y=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],G="radial";break;case"cone":Y=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],G=!1;break;case"streamtube":Y=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],G=!1;break;case"surface":Y=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],G=!0;break;case"mesh3d":Y=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],G=!1;break;case"volume":Y=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],G=!0;break;case"isosurface":Y=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],G=!1;break}var ee=h.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(Y);ee.enter().append("path").classed("legend3dandfriends",!0).attr("transform",E).style("stroke-miterlimit",1),ee.exit().remove(),ee.each(function(ne,J){var q=h.select(this),ae=n(te),le=ae.colorscale,ie=ae.reversescale,se=function(be){if(be.size()){var me="legendfill-"+te.uid;e.gradient(be,_,me,x(ie,G==="radial"),le,"fill")}},xe;if(le){if(!G){var he=le.length;xe=J===0?le[ie?he-1:0][1]:J===1?le[ie?0:he-1][1]:le[Math.floor((he-1)/2)][1]}}else{var oe=te.vertexcolor||te.facecolor||te.color;xe=A.isArrayOrTypedArray(oe)?oe[J]||oe[0]:oe}q.attr("d",ne[0]),xe?q.call(i.fill,xe):q.call(se)})}};function x(c,M){var _=M?"radial":"horizontal";return _+(c?"":"reversed")}function l(c){var M=c[0].trace,_=M.contours,y=a.hasLines(M),w=a.hasMarkers(M),d=M.visible&&M.fill&&M.fill!=="none",C=!1,S=!1;if(_){var E=_.coloring;E==="lines"?C=!0:y=E==="none"||E==="heatmap"||_.showlines,_.type==="constraint"?d=_._operation!=="=":(E==="fill"||E==="heatmap")&&(S=!0)}return{showMarker:w,showLine:y,showFill:d,showGradientLine:C,showGradientFill:S,anyLine:y||C,anyFill:d||S}}function b(c,M,_){return c&&A.isArrayOrTypedArray(c)?M:c>_?_:c}},{"../../lib":515,"../../registry":647,"../../traces/pie/helpers":915,"../../traces/pie/style_one":921,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale/helpers":378,"../drawing":389,"./constants":418,"@plotly/d3":58}],426:[function(t,P,R){t("./constants"),P.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":428}],427:[function(t,P,R){var h=t("../../registry"),u=t("../../plots/plots"),A=t("../../plots/cartesian/axis_ids"),T=t("../../fonts/ploticon"),e=t("../shapes/draw").eraseActiveShape,i=t("../../lib"),n=i._,a=P.exports={};a.toImage={name:"toImage",title:function(c){var M=c._context.toImageButtonOptions||{},_=M.format||"png";return _==="png"?n(c,"Download plot as a png"):n(c,"Download plot")},icon:T.camera,click:function(c){var M=c._context.toImageButtonOptions,_={format:M.format||"png"};i.notifier(n(c,"Taking snapshot - this may take a few seconds"),"long"),_.format!=="svg"&&i.isIE()&&(i.notifier(n(c,"IE only supports svg.  Changing format to svg."),"long"),_.format="svg"),["filename","width","height","scale"].forEach(function(y){y in M&&(_[y]=M[y])}),h.call("downloadImage",c,_).then(function(y){i.notifier(n(c,"Snapshot succeeded")+" - "+y,"long")}).catch(function(){i.notifier(n(c,"Sorry, there was a problem downloading your snapshot!"),"long")})}},a.sendDataToCloud={name:"sendDataToCloud",title:function(c){return n(c,"Edit in Chart Studio")},icon:T.disk,click:function(c){u.sendDataToCloud(c)}},a.editInChartStudio={name:"editInChartStudio",title:function(c){return n(c,"Edit in Chart Studio")},icon:T.pencil,click:function(c){u.sendDataToCloud(c)}},a.zoom2d={name:"zoom2d",_cat:"zoom",title:function(c){return n(c,"Zoom")},attr:"dragmode",val:"zoom",icon:T.zoombox,click:r},a.pan2d={name:"pan2d",_cat:"pan",title:function(c){return n(c,"Pan")},attr:"dragmode",val:"pan",icon:T.pan,click:r},a.select2d={name:"select2d",_cat:"select",title:function(c){return n(c,"Box Select")},attr:"dragmode",val:"select",icon:T.selectbox,click:r},a.lasso2d={name:"lasso2d",_cat:"lasso",title:function(c){return n(c,"Lasso Select")},attr:"dragmode",val:"lasso",icon:T.lasso,click:r},a.drawclosedpath={name:"drawclosedpath",title:function(c){return n(c,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:T.drawclosedpath,click:r},a.drawopenpath={name:"drawopenpath",title:function(c){return n(c,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:T.drawopenpath,click:r},a.drawline={name:"drawline",title:function(c){return n(c,"Draw line")},attr:"dragmode",val:"drawline",icon:T.drawline,click:r},a.drawrect={name:"drawrect",title:function(c){return n(c,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:T.drawrect,click:r},a.drawcircle={name:"drawcircle",title:function(c){return n(c,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:T.drawcircle,click:r},a.eraseshape={name:"eraseshape",title:function(c){return n(c,"Erase active shape")},icon:T.eraseshape,click:e},a.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(c){return n(c,"Zoom in")},attr:"zoom",val:"in",icon:T.zoom_plus,click:r},a.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(c){return n(c,"Zoom out")},attr:"zoom",val:"out",icon:T.zoom_minus,click:r},a.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(c){return n(c,"Autoscale")},attr:"zoom",val:"auto",icon:T.autoscale,click:r},a.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(c){return n(c,"Reset axes")},attr:"zoom",val:"reset",icon:T.home,click:r},a.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(c){return n(c,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:T.tooltip_basic,gravity:"ne",click:r},a.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(c){return n(c,"Compare data on hover")},attr:"hovermode",val:function(c){return c._fullLayout._isHoriz?"y":"x"},icon:T.tooltip_compare,gravity:"ne",click:r};function r(c,M){var _=M.currentTarget,y=_.getAttribute("data-attr"),w=_.getAttribute("data-val")||!0,d=c._fullLayout,C={},S=A.list(c,null,!0),E=d._cartesianSpikesEnabled,k,B;if(y==="zoom"){var z=w==="in"?.5:2,F=(1+z)/2,I=(1-z)/2,O;for(B=0;B<S.length;B++)if(k=S[B],!k.fixedrange)if(O=k._name,w==="auto")C[O+".autorange"]=!0;else if(w==="reset"){if(k._rangeInitial===void 0)C[O+".autorange"]=!0;else{var N=k._rangeInitial.slice();C[O+".range[0]"]=N[0],C[O+".range[1]"]=N[1]}k._showSpikeInitial!==void 0&&(C[O+".showspikes"]=k._showSpikeInitial,E==="on"&&!k._showSpikeInitial&&(E="off"))}else{var V=[k.r2l(k.range[0]),k.r2l(k.range[1])],H=[F*V[0]+I*V[1],F*V[1]+I*V[0]];C[O+".range[0]"]=k.l2r(H[0]),C[O+".range[1]"]=k.l2r(H[1])}}else y==="hovermode"&&(w==="x"||w==="y")&&(w=d._isHoriz?"y":"x",_.setAttribute("data-val",w)),C[y]=w;d._cartesianSpikesEnabled=E,h.call("_guiRelayout",c,C)}a.zoom3d={name:"zoom3d",_cat:"zoom",title:function(c){return n(c,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:T.zoombox,click:f},a.pan3d={name:"pan3d",_cat:"pan",title:function(c){return n(c,"Pan")},attr:"scene.dragmode",val:"pan",icon:T.pan,click:f},a.orbitRotation={name:"orbitRotation",title:function(c){return n(c,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:T["3d_rotate"],click:f},a.tableRotation={name:"tableRotation",title:function(c){return n(c,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:T["z-axis"],click:f};function f(c,M){for(var _=M.currentTarget,y=_.getAttribute("data-attr"),w=_.getAttribute("data-val")||!0,d=c._fullLayout._subplots.gl3d||[],C={},S=y.split("."),E=0;E<d.length;E++)C[d[E]+"."+S[1]]=w;var k=w==="pan"?w:"zoom";C.dragmode=k,h.call("_guiRelayout",c,C)}a.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(c){return n(c,"Reset camera to default")},attr:"resetDefault",icon:T.home,click:o},a.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(c){return n(c,"Reset camera to last save")},attr:"resetLastSave",icon:T.movie,click:o};function o(c,M){for(var _=M.currentTarget,y=_.getAttribute("data-attr"),w=y==="resetLastSave",d=y==="resetDefault",C=c._fullLayout,S=C._subplots.gl3d||[],E={},k=0;k<S.length;k++){var B=S[k],z=B+".camera",F=B+".aspectratio",I=B+".aspectmode",O=C[B]._scene,N;w?(E[z+".up"]=O.viewInitial.up,E[z+".eye"]=O.viewInitial.eye,E[z+".center"]=O.viewInitial.center,N=!0):d&&(E[z+".up"]=null,E[z+".eye"]=null,E[z+".center"]=null,N=!0),N&&(E[F+".x"]=O.viewInitial.aspectratio.x,E[F+".y"]=O.viewInitial.aspectratio.y,E[F+".z"]=O.viewInitial.aspectratio.z,E[I]=O.viewInitial.aspectmode)}h.call("_guiRelayout",c,E)}a.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(c){return n(c,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:T.tooltip_basic,gravity:"ne",click:m};function s(c,M){var _=M.currentTarget,y=_._previousVal,w=c._fullLayout,d=w._subplots.gl3d||[],C=["xaxis","yaxis","zaxis"],S={},E={};if(y)E=y,_._previousVal=null;else{for(var k=0;k<d.length;k++){var B=d[k],z=w[B],F=B+".hovermode";S[F]=z.hovermode,E[F]=!1;for(var I=0;I<3;I++){var O=C[I],N=B+"."+O+".showspikes";E[N]=!1,S[N]=z[O].showspikes}}_._previousVal=S}return E}function m(c,M){var _=s(c,M);h.call("_guiRelayout",c,_)}a.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(c){return n(c,"Zoom in")},attr:"zoom",val:"in",icon:T.zoom_plus,click:g},a.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(c){return n(c,"Zoom out")},attr:"zoom",val:"out",icon:T.zoom_minus,click:g},a.resetGeo={name:"resetGeo",_cat:"reset",title:function(c){return n(c,"Reset")},attr:"reset",val:null,icon:T.autoscale,click:g},a.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(c){return n(c,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:T.tooltip_basic,gravity:"ne",click:v};function g(c,M){for(var _=M.currentTarget,y=_.getAttribute("data-attr"),w=_.getAttribute("data-val")||!0,d=c._fullLayout,C=d._subplots.geo||[],S=0;S<C.length;S++){var E=C[S],k=d[E];if(y==="zoom"){var B=k.projection.scale,z=w==="in"?2*B:.5*B;h.call("_guiRelayout",c,E+".projection.scale",z)}}y==="reset"&&b(c,"geo")}a.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(c){return n(c,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:T.tooltip_basic,gravity:"ne",click:v},a.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(c){return n(c,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:T.tooltip_basic,gravity:"ne",click:v};function p(c){var M=c._fullLayout;return M.hovermode?!1:M._has("cartesian")?M._isHoriz?"y":"x":"closest"}function v(c){var M=p(c);h.call("_guiRelayout",c,"hovermode",M)}a.resetViewSankey={name:"resetSankeyGroup",title:function(c){return n(c,"Reset view")},icon:T.home,click:function(c){for(var M={"node.groups":[],"node.x":[],"node.y":[]},_=0;_<c._fullData.length;_++){var y=c._fullData[_]._viewInitial;M["node.groups"].push(y.node.groups.slice()),M["node.x"].push(y.node.x.slice()),M["node.y"].push(y.node.y.slice())}h.call("restyle",c,M)}},a.toggleHover={name:"toggleHover",title:function(c){return n(c,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:T.tooltip_basic,gravity:"ne",click:function(c,M){var _=s(c,M);_.hovermode=p(c),h.call("_guiRelayout",c,_)}},a.resetViews={name:"resetViews",title:function(c){return n(c,"Reset views")},icon:T.home,click:function(c,M){var _=M.currentTarget;_.setAttribute("data-attr","zoom"),_.setAttribute("data-val","reset"),r(c,M),_.setAttribute("data-attr","resetLastSave"),o(c,M),b(c,"geo"),b(c,"mapbox")}},a.toggleSpikelines={name:"toggleSpikelines",title:function(c){return n(c,"Toggle Spike Lines")},icon:T.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(c){var M=c._fullLayout,_=M._cartesianSpikesEnabled;M._cartesianSpikesEnabled=_==="on"?"off":"on",h.call("_guiRelayout",c,x(c))}};function x(c){for(var M=c._fullLayout,_=M._cartesianSpikesEnabled==="on",y=A.list(c,null,!0),w={},d=0;d<y.length;d++){var C=y[d];w[C._name+".showspikes"]=_?!0:C._showSpikeInitial}return w}a.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(c){return n(c,"Reset view")},attr:"reset",icon:T.home,click:function(c){b(c,"mapbox")}},a.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(c){return n(c,"Zoom in")},attr:"zoom",val:"in",icon:T.zoom_plus,click:l},a.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(c){return n(c,"Zoom out")},attr:"zoom",val:"out",icon:T.zoom_minus,click:l};function l(c,M){for(var _=M.currentTarget,y=_.getAttribute("data-val"),w=c._fullLayout,d=w._subplots.mapbox||[],C=1.05,S={},E=0;E<d.length;E++){var k=d[E],B=w[k].zoom,z=y==="in"?C*B:B/C;S[k+".zoom"]=z}h.call("_guiRelayout",c,S)}function b(c,M){for(var _=c._fullLayout,y=_._subplots[M]||[],w={},d=0;d<y.length;d++)for(var C=y[d],S=_[C]._subplot,E=S.viewInitial,k=Object.keys(E),B=0;B<k.length;B++){var z=k[B];w[C+"."+z]=E[z]}h.call("_guiRelayout",c,w)}},{"../../fonts/ploticon":494,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../shapes/draw":462}],428:[function(t,P,R){var h=t("./buttons"),u=Object.keys(h),A=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],T=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(A),e=[],i=function(n){if(T.indexOf(n._cat||n.name)===-1){var a=n.name,r=(n._cat||n.name).toLowerCase();e.indexOf(a)===-1&&e.push(a),e.indexOf(r)===-1&&e.push(r)}};u.forEach(function(n){i(h[n])}),e.sort(),P.exports={DRAW_MODES:A,backButtons:T,foreButtons:e}},{"./buttons":427}],429:[function(t,P,R){var h=t("../../lib"),u=t("../color"),A=t("../../plot_api/plot_template"),T=t("./attributes");P.exports=function(i,n){var a=i.modebar||{},r=A.newContainer(n,"modebar");function f(s,m){return h.coerce(a,r,T,s,m)}f("orientation"),f("bgcolor",u.addOpacity(n.paper_bgcolor,.5));var o=u.contrast(u.rgb(n.modebar.bgcolor));f("color",u.addOpacity(o,.3)),f("activecolor",u.addOpacity(o,.7)),f("uirevision",n.uirevision),f("add"),f("remove")}},{"../../lib":515,"../../plot_api/plot_template":555,"../color":367,"./attributes":426}],430:[function(t,P,R){P.exports={moduleType:"component",name:"modebar",layoutAttributes:t("./attributes"),supplyLayoutDefaults:t("./defaults"),manage:t("./manage")}},{"./attributes":426,"./defaults":429,"./manage":431}],431:[function(t,P,R){var h=t("../../plots/cartesian/axis_ids"),u=t("../../traces/scatter/subtypes"),A=t("../../registry"),T=t("../fx/helpers").isUnifiedHover,e=t("./modebar"),i=t("./buttons"),n=t("./constants").DRAW_MODES,a=t("../../lib").extendDeep;P.exports=function(v){var x=v._fullLayout,l=v._context,b=x._modeBar;if(!l.displayModeBar&&!l.watermark){b&&(b.destroy(),delete x._modeBar);return}if(!Array.isArray(l.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(l.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var c=l.modeBarButtons,M;Array.isArray(c)&&c.length?M=g(c):!l.displayModeBar&&l.watermark?M=[]:M=r(v),b?b.update(v,M):x._modeBar=e(v,M)};function r(p){var v=p._fullLayout,x=p._fullData,l=p._context;function b(J,q){if(typeof q=="string"){if(q.toLowerCase()===J.toLowerCase())return!0}else{var ae=q.name,le=q._cat||q.name;if(ae===J||le===J.toLowerCase())return!0}return!1}var c=v.modebar.add;typeof c=="string"&&(c=[c]);var M=v.modebar.remove;typeof M=="string"&&(M=[M]);var _=l.modeBarButtonsToAdd.concat(c.filter(function(J){for(var q=0;q<l.modeBarButtonsToRemove.length;q++)if(b(J,l.modeBarButtonsToRemove[q]))return!1;return!0})),y=l.modeBarButtonsToRemove.concat(M.filter(function(J){for(var q=0;q<l.modeBarButtonsToAdd.length;q++)if(b(J,l.modeBarButtonsToAdd[q]))return!1;return!0})),w=v._has("cartesian"),d=v._has("gl3d"),C=v._has("geo"),S=v._has("pie"),E=v._has("funnelarea"),k=v._has("gl2d"),B=v._has("ternary"),z=v._has("mapbox"),F=v._has("polar"),I=v._has("smith"),O=v._has("sankey"),N=f(v),V=T(v.hovermode),H=[];function j(J){if(!!J.length){for(var q=[],ae=0;ae<J.length;ae++){for(var le=J[ae],ie=i[le],se=ie.name.toLowerCase(),xe=(ie._cat||ie.name).toLowerCase(),oe=!1,he=0;he<y.length;he++){var be=y[he].toLowerCase();if(be===se||be===xe){oe=!0;break}}oe||q.push(i[le])}H.push(q)}}var Z=["toImage"];l.showEditInChartStudio?Z.push("editInChartStudio"):l.showSendToCloud&&Z.push("sendDataToCloud"),j(Z);var X=[],re=[],ue=[],K=[];(w||k||S||E||B)+C+d+z+F+I>1?(re=["toggleHover"],ue=["resetViews"]):C?(X=["zoomInGeo","zoomOutGeo"],re=["hoverClosestGeo"],ue=["resetGeo"]):d?(re=["hoverClosest3d"],ue=["resetCameraDefault3d","resetCameraLastSave3d"]):z?(X=["zoomInMapbox","zoomOutMapbox"],re=["toggleHover"],ue=["resetViewMapbox"]):k?re=["hoverClosestGl2d"]:S?re=["hoverClosestPie"]:O?(re=["hoverClosestCartesian","hoverCompareCartesian"],ue=["resetViewSankey"]):re=["toggleHover"],w&&(re=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(s(x)||V)&&(re=[]),(w||k)&&!N&&(X=["zoomIn2d","zoomOut2d","autoScale2d"],ue[0]!=="resetViews"&&(ue=["resetScale2d"])),d?K=["zoom3d","pan3d","orbitRotation","tableRotation"]:(w||k)&&!N||B?K=["zoom2d","pan2d"]:z||C?K=["pan2d"]:F&&(K=["zoom2d"]),o(x)&&K.push("select2d","lasso2d");var te=[],G=function(J){te.indexOf(J)===-1&&re.indexOf(J)!==-1&&te.push(J)};if(Array.isArray(_)){for(var Y=[],ee=0;ee<_.length;ee++){var ne=_[ee];typeof ne=="string"?(ne=ne.toLowerCase(),n.indexOf(ne)!==-1?(v._has("mapbox")||v._has("cartesian"))&&K.push(ne):ne==="togglespikelines"?G("toggleSpikelines"):ne==="togglehover"?G("toggleHover"):ne==="hovercompare"?G("hoverCompareCartesian"):ne==="hoverclosest"?(G("hoverClosestCartesian"),G("hoverClosestGeo"),G("hoverClosest3d"),G("hoverClosestGl2d"),G("hoverClosestPie")):ne==="v1hovermode"&&(G("toggleHover"),G("hoverClosestCartesian"),G("hoverCompareCartesian"),G("hoverClosestGeo"),G("hoverClosest3d"),G("hoverClosestGl2d"),G("hoverClosestPie"))):Y.push(ne)}_=Y}return j(K),j(X.concat(ue)),j(te),m(H,_)}function f(p){for(var v=h.list({_fullLayout:p},null,!0),x=0;x<v.length;x++)if(!v[x].fixedrange)return!1;return!0}function o(p){for(var v=!1,x=0;x<p.length&&!v;x++){var l=p[x];!l._module||!l._module.selectPoints||(A.traceIs(l,"scatter-like")?(u.hasMarkers(l)||u.hasText(l))&&(v=!0):A.traceIs(l,"box-violin")?(l.boxpoints==="all"||l.points==="all")&&(v=!0):v=!0)}return v}function s(p){for(var v=0;v<p.length;v++)if(!A.traceIs(p[v],"noHover"))return!1;return!0}function m(p,v){if(v.length)if(Array.isArray(v[0]))for(var x=0;x<v.length;x++)p.push(v[x]);else p.push(v);return p}function g(p){for(var v=a([],p),x=0;x<v.length;x++)for(var l=v[x],b=0;b<l.length;b++){var c=l[b];if(typeof c=="string")if(i[c]!==void 0)v[x][b]=i[c];else throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "))}return v}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../../traces/scatter/subtypes":961,"../fx/helpers":403,"./buttons":427,"./constants":428,"./modebar":432}],432:[function(t,P,R){var h=t("@plotly/d3"),u=t("fast-isnumeric"),A=t("../../lib"),T=t("../../fonts/ploticon"),e=t("../../version").version,i=new DOMParser;function n(o){this.container=o.container,this.element=document.createElement("div"),this.update(o.graphInfo,o.buttons),this.container.appendChild(this.element)}var a=n.prototype;a.update=function(o,s){this.graphInfo=o;var m=this.graphInfo._context,g=this.graphInfo._fullLayout,p="modebar-"+g._uid;this.element.setAttribute("id",p),this._uid=p,this.element.className="modebar",m.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),g.modebar.orientation==="v"&&(this.element.className+=" vertical",s=s.reverse());var v=g.modebar,x=m.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";A.deleteRelatedStyleRule(p),A.addRelatedStyleRule(p,x+"#"+p+" .modebar-group","background-color: "+v.bgcolor),A.addRelatedStyleRule(p,"#"+p+" .modebar-btn .icon path","fill: "+v.color),A.addRelatedStyleRule(p,"#"+p+" .modebar-btn:hover .icon path","fill: "+v.activecolor),A.addRelatedStyleRule(p,"#"+p+" .modebar-btn.active .icon path","fill: "+v.activecolor);var l=!this.hasButtons(s),b=this.hasLogo!==m.displaylogo,c=this.locale!==m.locale;if(this.locale=m.locale,(l||b||c)&&(this.removeAllButtons(),this.updateButtons(s),m.watermark||m.displaylogo)){var M=this.getLogo();m.watermark&&(M.className=M.className+" watermark"),g.modebar.orientation==="v"?this.element.insertBefore(M,this.element.childNodes[0]):this.element.appendChild(M),this.hasLogo=!0}this.updateActiveButton()},a.updateButtons=function(o){var s=this;this.buttons=o,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(m){var g=s.createGroup();m.forEach(function(p){var v=p.name;if(!v)throw new Error("must provide button 'name' in button config");if(s.buttonsNames.indexOf(v)!==-1)throw new Error("button name '"+v+"' is taken");s.buttonsNames.push(v);var x=s.createButton(p);s.buttonElements.push(x),g.appendChild(x)}),s.element.appendChild(g)})},a.createGroup=function(){var o=document.createElement("div");return o.className="modebar-group",o},a.createButton=function(o){var s=this,m=document.createElement("a");m.setAttribute("rel","tooltip"),m.className="modebar-btn";var g=o.title;g===void 0?g=o.name:typeof g=="function"&&(g=g(this.graphInfo)),(g||g===0)&&m.setAttribute("data-title",g),o.attr!==void 0&&m.setAttribute("data-attr",o.attr);var p=o.val;p!==void 0&&(typeof p=="function"&&(p=p(this.graphInfo)),m.setAttribute("data-val",p));var v=o.click;if(typeof v!="function")throw new Error("must provide button 'click' function in button config");m.addEventListener("click",function(l){o.click(s.graphInfo,l),s.updateActiveButton(l.currentTarget)}),m.setAttribute("data-toggle",o.toggle||!1),o.toggle&&h.select(m).classed("active",!0);var x=o.icon;return typeof x=="function"?m.appendChild(x()):m.appendChild(this.createIcon(x||T.question)),m.setAttribute("data-gravity",o.gravity||"n"),m},a.createIcon=function(o){var s=u(o.height)?Number(o.height):o.ascent-o.descent,m="http://www.w3.org/2000/svg",g;if(o.path){g=document.createElementNS(m,"svg"),g.setAttribute("viewBox",[0,0,o.width,s].join(" ")),g.setAttribute("class","icon");var p=document.createElementNS(m,"path");p.setAttribute("d",o.path),o.transform?p.setAttribute("transform",o.transform):o.ascent!==void 0&&p.setAttribute("transform","matrix(1 0 0 -1 0 "+o.ascent+")"),g.appendChild(p)}if(o.svg){var v=i.parseFromString(o.svg,"application/xml");g=v.childNodes[0]}return g.setAttribute("height","1em"),g.setAttribute("width","1em"),g},a.updateActiveButton=function(o){var s=this.graphInfo._fullLayout,m=o!==void 0?o.getAttribute("data-attr"):null;this.buttonElements.forEach(function(g){var p=g.getAttribute("data-val")||!0,v=g.getAttribute("data-attr"),x=g.getAttribute("data-toggle")==="true",l=h.select(g);if(x)v===m&&l.classed("active",!l.classed("active"));else{var b=v===null?v:A.nestedProperty(s,v).get();l.classed("active",b===p)}})},a.hasButtons=function(o){var s=this.buttons;if(!s||o.length!==s.length)return!1;for(var m=0;m<o.length;++m){if(o[m].length!==s[m].length)return!1;for(var g=0;g<o[m].length;g++)if(o[m][g].name!==s[m][g].name)return!1}return!0};function r(o){return o+" (v"+e+")"}a.getLogo=function(){var o=this.createGroup(),s=document.createElement("a");return s.href="https://plotly.com/",s.target="_blank",s.setAttribute("data-title",r(A._(this.graphInfo,"Produced with Plotly.js"))),s.className="modebar-btn plotlyjsicon modebar-btn--logo",s.appendChild(this.createIcon(T.newplotlylogo)),o.appendChild(s),o},a.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},a.destroy=function(){A.removeElement(this.container.querySelector(".modebar")),A.deleteRelatedStyleRule(this._uid)};function f(o,s){var m=o._fullLayout,g=new n({graphInfo:o,container:m._modebardiv.node(),buttons:s});return m._privateplot&&h.select(g.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),g}P.exports=f},{"../../fonts/ploticon":494,"../../lib":515,"../../version":1132,"@plotly/d3":58,"fast-isnumeric":190}],433:[function(t,P,R){var h=t("../../plots/font_attributes"),u=t("../color/attributes"),A=t("../../plot_api/plot_template").templatedArray,T=A("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});P.exports={visible:{valType:"boolean",editType:"plot"},buttons:T,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:h({editType:"plot"}),bgcolor:{valType:"color",dflt:u.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:u.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../color/attributes":366}],434:[function(t,P,R){P.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],435:[function(t,P,R){var h=t("../../lib"),u=t("../color"),A=t("../../plot_api/plot_template"),T=t("../../plots/array_container_defaults"),e=t("./attributes"),i=t("./constants");P.exports=function(f,o,s,m,g){var p=f.rangeselector||{},v=A.newContainer(o,"rangeselector");function x(_,y){return h.coerce(p,v,e,_,y)}var l=T(p,v,{name:"buttons",handleItemDefaults:n,calendar:g}),b=x("visible",l.length>0);if(b){var c=a(o,s,m);x("x",c[0]),x("y",c[1]),h.noneOrAll(f,o,["x","y"]),x("xanchor"),x("yanchor"),h.coerceFont(x,"font",s.font);var M=x("bgcolor");x("activecolor",u.contrast(M,i.lightAmount,i.darkAmount)),x("bordercolor"),x("borderwidth")}};function n(r,f,o,s){var m=s.calendar;function g(x,l){return h.coerce(r,f,e.buttons,x,l)}var p=g("visible");if(p){var v=g("step");v!=="all"&&(m&&m!=="gregorian"&&(v==="month"||v==="year")?f.stepmode="backward":g("stepmode"),g("count")),g("label")}}function a(r,f,o){for(var s=o.filter(function(v){return f[v].anchor===r._id}),m=0,g=0;g<s.length;g++){var p=f[s[g]].domain;p&&(m=Math.max(p[1],m))}return[r.domain[0],m+i.yPad]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../color":367,"./attributes":433,"./constants":434}],436:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../registry"),A=t("../../plots/plots"),T=t("../color"),e=t("../drawing"),i=t("../../lib"),n=i.strTranslate,a=t("../../lib/svg_text_utils"),r=t("../../plots/cartesian/axis_ids"),f=t("../../constants/alignment"),o=f.LINE_SPACING,s=f.FROM_TL,m=f.FROM_BR,g=t("./constants"),p=t("./get_update_object");P.exports=function(d){var C=d._fullLayout,S=C._infolayer.selectAll(".rangeselector").data(v(d),x);S.enter().append("g").classed("rangeselector",!0),S.exit().remove(),S.style({cursor:"pointer","pointer-events":"all"}),S.each(function(E){var k=h.select(this),B=E,z=B.rangeselector,F=k.selectAll("g.button").data(i.filterVisible(z.buttons));F.enter().append("g").classed("button",!0),F.exit().remove(),F.each(function(I){var O=h.select(this),N=p(B,I);I._isActive=l(B,I,N),O.call(b,z,I),O.call(M,z,I,d),O.on("click",function(){d._dragged||u.call("_guiRelayout",d,N)}),O.on("mouseover",function(){I._isHovered=!0,O.call(b,z,I)}),O.on("mouseout",function(){I._isHovered=!1,O.call(b,z,I)})}),y(d,F,z,B._name,k)})};function v(w){for(var d=r.list(w,"x",!0),C=[],S=0;S<d.length;S++){var E=d[S];E.rangeselector&&E.rangeselector.visible&&C.push(E)}return C}function x(w){return w._id}function l(w,d,C){if(d.step==="all")return w.autorange===!0;var S=Object.keys(C);return w.range[0]===C[S[0]]&&w.range[1]===C[S[1]]}function b(w,d,C){var S=i.ensureSingle(w,"rect","selector-rect",function(E){E.attr("shape-rendering","crispEdges")});S.attr({rx:g.rx,ry:g.ry}),S.call(T.stroke,d.bordercolor).call(T.fill,c(d,C)).style("stroke-width",d.borderwidth+"px")}function c(w,d){return d._isActive||d._isHovered?w.activecolor:w.bgcolor}function M(w,d,C,S){function E(B){a.convertToTspans(B,S)}var k=i.ensureSingle(w,"text","selector-text",function(B){B.attr("text-anchor","middle")});k.call(e.font,d.font).text(_(C,S._fullLayout._meta)).call(E)}function _(w,d){return w.label?d?i.templateString(w.label,d):w.label:w.step==="all"?"all":w.count+w.step.charAt(0)}function y(w,d,C,S,E){var k=0,B=0,z=C.borderwidth;d.each(function(){var H=h.select(this),j=H.select(".selector-text"),Z=C.font.size*o,X=Math.max(Z*a.lineCount(j),16)+3;B=Math.max(B,X)}),d.each(function(){var H=h.select(this),j=H.select(".selector-rect"),Z=H.select(".selector-text"),X=Z.node()&&e.bBox(Z.node()).width,re=C.font.size*o,ue=a.lineCount(Z),K=Math.max(X+10,g.minButtonWidth);H.attr("transform",n(z+k,z)),j.attr({x:0,y:0,width:K,height:B}),a.positionText(Z,K/2,B/2-(ue-1)*re/2+3),k+=K+5});var F=w._fullLayout._size,I=F.l+F.w*C.x,O=F.t+F.h*(1-C.y),N="left";i.isRightAnchor(C)&&(I-=k,N="right"),i.isCenterAnchor(C)&&(I-=k/2,N="center");var V="top";i.isBottomAnchor(C)&&(O-=B,V="bottom"),i.isMiddleAnchor(C)&&(O-=B/2,V="middle"),k=Math.ceil(k),B=Math.ceil(B),I=Math.round(I),O=Math.round(O),A.autoMargin(w,S+"-range-selector",{x:C.x,y:C.y,l:k*s[N],r:k*m[N],b:B*m[V],t:B*s[V]}),E.attr("transform",n(I,O))}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"./constants":434,"./get_update_object":437,"@plotly/d3":58}],437:[function(t,P,R){var h=t("d3-time"),u=t("../../lib").titleCase;P.exports=function(e,i){var n=e._name,a={};if(i.step==="all")a[n+".autorange"]=!0;else{var r=A(e,i);a[n+".range[0]"]=r[0],a[n+".range[1]"]=r[1]}return a};function A(T,e){var i=T.range,n=new Date(T.r2l(i[1])),a=e.step,r=h["utc"+u(a)],f=e.count,o;switch(e.stepmode){case"backward":o=T.l2r(+r.offset(n,-f));break;case"todate":var s=r.offset(n,-f);o=T.l2r(+r.ceil(s));break}var m=i[1];return[o,m]}},{"../../lib":515,"d3-time":122}],438:[function(t,P,R){P.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:t("./attributes")}}},layoutAttributes:t("./attributes"),handleDefaults:t("./defaults"),draw:t("./draw")}},{"./attributes":433,"./defaults":435,"./draw":436}],439:[function(t,P,R){var h=t("../color/attributes");P.exports={bgcolor:{valType:"color",dflt:h.background,editType:"plot"},bordercolor:{valType:"color",dflt:h.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":366}],440:[function(t,P,R){var h=t("../../plots/cartesian/axis_ids").list,u=t("../../plots/cartesian/autorange").getAutoRange,A=t("./constants");P.exports=function(e){for(var i=h(e,"x",!0),n=0;n<i.length;n++){var a=i[n],r=a[A.name];r&&r.visible&&r.autorange&&(r._input.autorange=!0,r._input.range=r.range=u(e,a))}}},{"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"./constants":441}],441:[function(t,P,R){P.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],442:[function(t,P,R){var h=t("../../lib"),u=t("../../plot_api/plot_template"),A=t("../../plots/cartesian/axis_ids"),T=t("./attributes"),e=t("./oppaxis_attributes");P.exports=function(n,a,r){var f=n[r],o=a[r];if(!(f.rangeslider||a._requestRangeslider[o._id]))return;h.isPlainObject(f.rangeslider)||(f.rangeslider={});var s=f.rangeslider,m=u.newContainer(o,"rangeslider");function g(S,E){return h.coerce(s,m,T,S,E)}var p,v;function x(S,E){return h.coerce(p,v,e,S,E)}var l=g("visible");if(!!l){g("bgcolor",a.plot_bgcolor),g("bordercolor"),g("borderwidth"),g("thickness"),g("autorange",!o.isValidRange(s.range)),g("range");var b=a._subplots;if(b)for(var c=b.cartesian.filter(function(S){return S.substr(0,S.indexOf("y"))===A.name2id(r)}).map(function(S){return S.substr(S.indexOf("y"),S.length)}),M=h.simpleMap(c,A.id2name),_=0;_<M.length;_++){var y=M[_];p=s[y]||{},v=u.newContainer(m,y,"yaxis");var w=a[y],d;p.range&&w.isValidRange(p.range)&&(d="fixed");var C=x("rangemode",d);C!=="match"&&x("range",w.range.slice())}m._input=s}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_ids":570,"./attributes":439,"./oppaxis_attributes":446}],443:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../registry"),A=t("../../plots/plots"),T=t("../../lib"),e=T.strTranslate,i=t("../drawing"),n=t("../color"),a=t("../titles"),r=t("../../plots/cartesian"),f=t("../../plots/cartesian/axis_ids"),o=t("../dragelement"),s=t("../../lib/setcursor"),m=t("./constants");P.exports=function(w){for(var d=w._fullLayout,C=d._rangeSliderData,S=0;S<C.length;S++){var E=C[S][m.name];E._clipId=E._id+"-"+d._uid}function k(z){return z._name}var B=d._infolayer.selectAll("g."+m.containerClassName).data(C,k);B.exit().each(function(z){var F=z[m.name];d._topdefs.select("#"+F._clipId).remove()}).remove(),C.length!==0&&(B.enter().append("g").classed(m.containerClassName,!0).attr("pointer-events","all"),B.each(function(z){var F=h.select(this),I=z[m.name],O=d[f.id2name(z.anchor)],N=I[f.id2name(z.anchor)];if(I.range){var V=T.simpleMap(I.range,z.r2l),H=T.simpleMap(z.range,z.r2l),j;H[0]<H[1]?j=[Math.min(V[0],H[0]),Math.max(V[1],H[1])]:j=[Math.max(V[0],H[0]),Math.min(V[1],H[1])],I.range=I._input.range=T.simpleMap(j,z.l2r)}z.cleanRange("rangeslider.range");var Z=d._size,X=z.domain;I._width=Z.w*(X[1]-X[0]);var re=Math.round(Z.l+Z.w*X[0]),ue=Math.round(Z.t+Z.h*(1-z._counterDomainMin)+(z.side==="bottom"?z._depth:0)+I._offsetShift+m.extraPad);F.attr("transform",e(re,ue)),I._rl=T.simpleMap(I.range,z.r2l);var K=I._rl[0],te=I._rl[1],G=te-K;if(I.p2d=function(xe){return xe/I._width*G+K},I.d2p=function(xe){return(xe-K)/G*I._width},z.rangebreaks){var Y=z.locateBreaks(K,te);if(Y.length){var ee,ne,J=0;for(ee=0;ee<Y.length;ee++)ne=Y[ee],J+=ne.max-ne.min;var q=I._width/(te-K-J),ae=[-q*K];for(ee=0;ee<Y.length;ee++)ne=Y[ee],ae.push(ae[ae.length-1]-q*(ne.max-ne.min));for(I.d2p=function(xe){for(var oe=ae[0],he=0;he<Y.length;he++){var be=Y[he];if(xe>=be.max)oe=ae[he+1];else if(xe<be.min)break}return oe+q*xe},ee=0;ee<Y.length;ee++)ne=Y[ee],ne.pmin=I.d2p(ne.min),ne.pmax=I.d2p(ne.max);I.p2d=function(xe){for(var oe=ae[0],he=0;he<Y.length;he++){var be=Y[he];if(xe>=be.pmax)oe=ae[he+1];else if(xe<be.pmin)break}return(xe-oe)/q}}}if(N.rangemode!=="match"){var le=O.r2l(N.range[0]),ie=O.r2l(N.range[1]),se=ie-le;I.d2pOppAxis=function(xe){return(xe-le)/se*I._height}}F.call(x,w,z,I).call(l,w,z,I).call(b,w,z,I).call(M,w,z,I,N).call(_,w,z,I).call(y,w,z,I),g(F,w,z,I),v(F,w,z,I,O,N),z.side==="bottom"&&a.draw(w,z._id+"title",{propContainer:z,propName:z._name+".title",placeholder:d._dfltTitle.x,attributes:{x:z._offset+z._length/2,y:ue+I._height+I._offsetShift+10+1.5*z.title.font.size,"text-anchor":"middle"}})}))};function g(w,d,C,S){if(d._context.staticPlot)return;var E=w.select("rect."+m.slideBoxClassName).node(),k=w.select("rect."+m.grabAreaMinClassName).node(),B=w.select("rect."+m.grabAreaMaxClassName).node();function z(){var F=h.event,I=F.target,O=F.clientX||F.touches[0].clientX,N=O-w.node().getBoundingClientRect().left,V=S.d2p(C._rl[0]),H=S.d2p(C._rl[1]),j=o.coverSlip();this.addEventListener("touchmove",Z),this.addEventListener("touchend",X),j.addEventListener("mousemove",Z),j.addEventListener("mouseup",X);function Z(re){var ue=re.clientX||re.touches[0].clientX,K=+ue-O,te,G,Y;switch(I){case E:Y="ew-resize",te=V+K,G=H+K;break;case k:Y="col-resize",te=V+K,G=H;break;case B:Y="col-resize",te=V,G=H+K;break;default:Y="ew-resize",te=N,G=N+K;break}if(G<te){var ee=G;G=te,te=ee}S._pixelMin=te,S._pixelMax=G,s(h.select(j),Y),p(w,d,C,S)}function X(){j.removeEventListener("mousemove",Z),j.removeEventListener("mouseup",X),this.removeEventListener("touchmove",Z),this.removeEventListener("touchend",X),T.removeElement(j)}}w.on("mousedown",z),w.on("touchstart",z)}function p(w,d,C,S){function E(z){return C.l2r(T.constrain(z,S._rl[0],S._rl[1]))}var k=E(S.p2d(S._pixelMin)),B=E(S.p2d(S._pixelMax));window.requestAnimationFrame(function(){u.call("_guiRelayout",d,C._name+".range",[k,B])})}function v(w,d,C,S,E,k){var B=m.handleWidth/2;function z(re){return T.constrain(re,0,S._width)}function F(re){return T.constrain(re,0,S._height)}function I(re){return T.constrain(re,-B,S._width+B)}var O=z(S.d2p(C._rl[0])),N=z(S.d2p(C._rl[1]));if(w.select("rect."+m.slideBoxClassName).attr("x",O).attr("width",N-O),w.select("rect."+m.maskMinClassName).attr("width",O),w.select("rect."+m.maskMaxClassName).attr("x",N).attr("width",S._width-N),k.rangemode!=="match"){var V=S._height-F(S.d2pOppAxis(E._rl[1])),H=S._height-F(S.d2pOppAxis(E._rl[0]));w.select("rect."+m.maskMinOppAxisClassName).attr("x",O).attr("height",V).attr("width",N-O),w.select("rect."+m.maskMaxOppAxisClassName).attr("x",O).attr("y",H).attr("height",S._height-H).attr("width",N-O),w.select("rect."+m.slideBoxClassName).attr("y",V).attr("height",H-V)}var j=.5,Z=Math.round(I(O-B))-j,X=Math.round(I(N-B))+j;w.select("g."+m.grabberMinClassName).attr("transform",e(Z,j)),w.select("g."+m.grabberMaxClassName).attr("transform",e(X,j))}function x(w,d,C,S){var E=T.ensureSingle(w,"rect",m.bgClassName,function(F){F.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),k=S.borderwidth%2===0?S.borderwidth:S.borderwidth-1,B=-S._offsetShift,z=i.crispRound(d,S.borderwidth);E.attr({width:S._width+k,height:S._height+k,transform:e(B,B),"stroke-width":z}).call(n.stroke,S.bordercolor).call(n.fill,S.bgcolor)}function l(w,d,C,S){var E=d._fullLayout,k=T.ensureSingleById(E._topdefs,"clipPath",S._clipId,function(B){B.append("rect").attr({x:0,y:0})});k.select("rect").attr({width:S._width,height:S._height})}function b(w,d,C,S){var E=d.calcdata,k=w.selectAll("g."+m.rangePlotClassName).data(C._subplotsWith,T.identity);k.enter().append("g").attr("class",function(z){return m.rangePlotClassName+" "+z}).call(i.setClipUrl,S._clipId,d),k.order(),k.exit().remove();var B;k.each(function(z,F){var I=h.select(this),O=F===0,N=f.getFromId(d,z,"y"),V=N._name,H=S[V],j={data:[],layout:{xaxis:{type:C.type,domain:[0,1],range:S.range.slice(),calendar:C.calendar},width:S._width,height:S._height,margin:{t:0,b:0,l:0,r:0}},_context:d._context};C.rangebreaks&&(j.layout.xaxis.rangebreaks=C.rangebreaks),j.layout[V]={type:N.type,domain:[0,1],range:H.rangemode!=="match"?H.range.slice():N.range.slice(),calendar:N.calendar},N.rangebreaks&&(j.layout[V].rangebreaks=N.rangebreaks),A.supplyDefaults(j);var Z=j._fullLayout.xaxis,X=j._fullLayout[V];Z.clearCalc(),Z.setScale(),X.clearCalc(),X.setScale();var re={id:z,plotgroup:I,xaxis:Z,yaxis:X,isRangePlot:!0};O?B=re:(re.mainplot="xy",re.mainplotinfo=B),r.rangePlot(d,re,c(E,z))})}function c(w,d){for(var C=[],S=0;S<w.length;S++){var E=w[S],k=E[0].trace;k.xaxis+k.yaxis===d&&C.push(E)}return C}function M(w,d,C,S,E){var k=T.ensureSingle(w,"rect",m.maskMinClassName,function(I){I.attr({x:0,y:0,"shape-rendering":"crispEdges"})});k.attr("height",S._height).call(n.fill,m.maskColor);var B=T.ensureSingle(w,"rect",m.maskMaxClassName,function(I){I.attr({y:0,"shape-rendering":"crispEdges"})});if(B.attr("height",S._height).call(n.fill,m.maskColor),E.rangemode!=="match"){var z=T.ensureSingle(w,"rect",m.maskMinOppAxisClassName,function(I){I.attr({y:0,"shape-rendering":"crispEdges"})});z.attr("width",S._width).call(n.fill,m.maskOppAxisColor);var F=T.ensureSingle(w,"rect",m.maskMaxOppAxisClassName,function(I){I.attr({y:0,"shape-rendering":"crispEdges"})});F.attr("width",S._width).style("border-top",m.maskOppBorder).call(n.fill,m.maskOppAxisColor)}}function _(w,d,C,S){if(!d._context.staticPlot){var E=T.ensureSingle(w,"rect",m.slideBoxClassName,function(k){k.attr({y:0,cursor:m.slideBoxCursor,"shape-rendering":"crispEdges"})});E.attr({height:S._height,fill:m.slideBoxFill})}}function y(w,d,C,S){var E=T.ensureSingle(w,"g",m.grabberMinClassName),k=T.ensureSingle(w,"g",m.grabberMaxClassName),B={x:0,width:m.handleWidth,rx:m.handleRadius,fill:n.background,stroke:n.defaultLine,"stroke-width":m.handleStrokeWidth,"shape-rendering":"crispEdges"},z={y:Math.round(S._height/4),height:Math.round(S._height/2)},F=T.ensureSingle(E,"rect",m.handleMinClassName,function(H){H.attr(B)});F.attr(z);var I=T.ensureSingle(k,"rect",m.handleMaxClassName,function(H){H.attr(B)});I.attr(z);var O={width:m.grabAreaWidth,x:0,y:0,fill:m.grabAreaFill,cursor:d._context.staticPlot?void 0:m.grabAreaCursor},N=T.ensureSingle(E,"rect",m.grabAreaMinClassName,function(H){H.attr(O)});N.attr("height",S._height);var V=T.ensureSingle(k,"rect",m.grabAreaMaxClassName,function(H){H.attr(O)});V.attr("height",S._height)}},{"../../lib":515,"../../lib/setcursor":536,"../../plots/cartesian":578,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":441,"@plotly/d3":58}],444:[function(t,P,R){var h=t("../../plots/cartesian/axis_ids"),u=t("../../lib/svg_text_utils"),A=t("./constants"),T=t("../../constants/alignment").LINE_SPACING,e=A.name;function i(n){var a=n&&n[e];return a&&a.visible}R.isVisible=i,R.makeData=function(n){var a=h.list({_fullLayout:n},"x",!0),r=n.margin,f=[];if(!n._has("gl2d"))for(var o=0;o<a.length;o++){var s=a[o];if(i(s)){f.push(s);var m=s[e];m._id=e+s._id,m._height=(n.height-r.b-r.t)*m.thickness,m._offsetShift=Math.floor(m.borderwidth/2)}}n._rangeSliderData=f},R.autoMarginOpts=function(n,a){var r=n._fullLayout,f=a[e],o=a._id.charAt(0),s=0,m=0;if(a.side==="bottom"&&(s=a._depth,a.title.text!==r._dfltTitle[o])){m=1.5*a.title.font.size+10+f._offsetShift;var g=(a.title.text.match(u.BR_TAG_ALL)||[]).length;m+=g*a.title.font.size*T}return{x:0,y:a._counterDomainMin,l:0,r:0,t:0,b:f._height+s+Math.max(r.margin.b,m),pad:A.extraPad+f._offsetShift*2}}},{"../../constants/alignment":483,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"./constants":441}],445:[function(t,P,R){var h=t("../../lib"),u=t("./attributes"),A=t("./oppaxis_attributes"),T=t("./helpers");P.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:h.extendFlat({},u,{yaxis:A})}}},layoutAttributes:t("./attributes"),handleDefaults:t("./defaults"),calcAutorange:t("./calc_autorange"),draw:t("./draw"),isVisible:T.isVisible,makeData:T.makeData,autoMarginOpts:T.autoMarginOpts}},{"../../lib":515,"./attributes":439,"./calc_autorange":440,"./defaults":442,"./draw":443,"./helpers":444,"./oppaxis_attributes":446}],446:[function(t,P,R){P.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],447:[function(t,P,R){var h=t("../annotations/attributes"),u=t("../../traces/scatter/attributes").line,A=t("../drawing/attributes").dash,T=t("../../lib/extend").extendFlat,e=t("../../plot_api/edit_types").overrideAll,i=t("../../plot_api/plot_template").templatedArray;t("../../constants/axis_placeable_objects"),P.exports=e(i("selection",{type:{valType:"enumerated",values:["rect","path"]},xref:T({},h.xref,{}),yref:T({},h.yref,{}),x0:{valType:"any"},x1:{valType:"any"},y0:{valType:"any"},y1:{valType:"any"},path:{valType:"string",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:.7,editType:"arraydraw"},line:{color:u.color,width:T({},u.width,{min:1,dflt:1}),dash:T({},A,{dflt:"dot"})}}),"arraydraw","from-root")},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],448:[function(t,P,R){P.exports={BENDPX:1.5,MINSELECT:12,SELECTDELAY:100,SELECTID:"-select"}},{}],449:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axes"),A=t("../../plots/array_container_defaults"),T=t("./attributes"),e=t("../shapes/helpers");P.exports=function(a,r){A(a,r,{name:"selections",handleItemDefaults:i});for(var f=r.selections,o=0;o<f.length;o++){var s=f[o];!s||s.path===void 0&&(s.x0===void 0||s.x1===void 0||s.y0===void 0||s.y1===void 0)&&(r.selections[o]=null)}};function i(n,a,r){function f(k,B){return h.coerce(n,a,T,k,B)}var o=f("path"),s=o?"path":"rect",m=f("type",s),g=m!=="path";g&&delete a.path,f("opacity"),f("line.color"),f("line.width"),f("line.dash");for(var p=["x","y"],v=0;v<2;v++){var x=p[v],l={_fullLayout:r},b,c,M,_=u.coerceRef(n,a,l,x);if(b=u.getFromId(l,_),b._selectionIndices.push(a._index),M=e.rangeToShapePosition(b),c=e.shapePositionToRange(b),g){var y=x+"0",w=x+"1",d=n[y],C=n[w];n[y]=c(n[y],!0),n[w]=c(n[w],!0),u.coercePosition(a,l,f,_,y),u.coercePosition(a,l,f,_,w);var S=a[y],E=a[w];S!==void 0&&E!==void 0&&(a[y]=M(S),a[w]=M(E),n[y]=d,n[w]=C)}}g&&h.noneOrAll(n,a,["x0","x1","y0","y1"])}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../shapes/helpers":469,"./attributes":447}],450:[function(t,P,R){var h=t("../shapes/draw_newshape/helpers").readPaths,u=t("../shapes/display_outlines"),A=t("../shapes/handle_outline").clearOutlineControllers,T=t("../color"),e=t("../drawing"),i=t("../../plot_api/plot_template").arrayEditor,n=t("../shapes/helpers"),a=n.getPathString;P.exports={draw:r,drawOne:o,activateLastSelection:g};function r(v){var x=v._fullLayout;A(v),x._selectionLayer.selectAll("path").remove();for(var l in x._plots){var b=x._plots[l].selectionLayer;b&&b.selectAll("path").remove()}for(var c=0;c<x.selections.length;c++)o(v,c)}function f(v){return v._context.editSelection}function o(v,x){v._fullLayout._paperdiv.selectAll('.selectionlayer [data-index="'+x+'"]').remove();var l=n.makeSelectionsOptionsAndPlotinfo(v,x),b=l.options,c=l.plotinfo;if(!b._input)return;M(v._fullLayout._selectionLayer);function M(_){var y=a(v,b),w={"data-index":x,"fill-rule":"evenodd",d:y},d=b.opacity,C="rgba(0,0,0,0)",S=b.line.color||T.contrast(v._fullLayout.plot_bgcolor),E=b.line.width,k=b.line.dash;E||(E=5,k="solid");var B=f(v)&&v._fullLayout._activeSelectionIndex===x;B&&(C=v._fullLayout.activeselection.fillcolor,d=v._fullLayout.activeselection.opacity);for(var z=[],F=1;F>=0;F--){var I=_.append("path").attr(w).style("opacity",F?.1:d).call(T.stroke,S).call(T.fill,C).call(e.dashLine,F?"solid":k,F?4+E:E);if(s(I,v,b),B){var O=i(v.layout,"selections",b);I.style({cursor:"move"});var N={element:I.node(),plotinfo:c,gd:v,editHelpers:O,isActiveSelection:!0},V=h(y,v);u(V,I,N)}else I.style("pointer-events",F?"all":"none");z[F]=I}var H=z[0],j=z[1];j.node().addEventListener("click",function(){return m(v,H)})}}function s(v,x,l){var b=l.xref+l.yref;e.setClipUrl(v,"clip"+x._fullLayout._uid+b,x)}function m(v,x){if(!!f(v)){var l=x.node(),b=+l.getAttribute("data-index");if(b>=0){if(b===v._fullLayout._activeSelectionIndex){p(v);return}v._fullLayout._activeSelectionIndex=b,v._fullLayout._deactivateSelection=p,r(v)}}}function g(v){if(!!f(v)){var x=v._fullLayout.selections.length-1;v._fullLayout._activeSelectionIndex=x,v._fullLayout._deactivateSelection=p,r(v)}}function p(v){if(!!f(v)){var x=v._fullLayout._activeSelectionIndex;x>=0&&(A(v),delete v._fullLayout._activeSelectionIndex,r(v))}}},{"../../plot_api/plot_template":555,"../color":367,"../drawing":389,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/handle_outline":468,"../shapes/helpers":469}],451:[function(t,P,R){var h=t("../../drawing/attributes").dash,u=t("../../../lib/extend").extendFlat;P.exports={newselection:{mode:{valType:"enumerated",values:["immediate","gradual"],dflt:"immediate",editType:"none"},line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:1,dflt:1,editType:"none"},dash:u({},h,{dflt:"dot",editType:"none"}),editType:"none"},editType:"none"},activeselection:{fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],452:[function(t,P,R){P.exports=function(u,A,T){T("newselection.mode");var e=T("newselection.line.width");e&&(T("newselection.line.color"),T("newselection.line.dash")),T("activeselection.fillcolor"),T("activeselection.opacity")}},{}],453:[function(t,P,R){var h=t("../../dragelement/helpers"),u=h.selectMode,A=t("../../shapes/handle_outline"),T=A.clearOutline,e=t("../../shapes/draw_newshape/helpers"),i=e.readPaths,n=e.writePaths,a=e.fixDatesForPaths;P.exports=function(f,o){if(!!f.length){var s=f[0][0];if(!!s){var m=s.getAttribute("d"),g=o.gd,p=g._fullLayout.newselection,v=o.plotinfo,x=v.xaxis,l=v.yaxis,b=o.isActiveSelection,c=o.dragmode,M=(g.layout||{}).selections||[];if(!u(c)&&b!==void 0){var _=g._fullLayout._activeSelectionIndex;if(_<M.length)switch(g._fullLayout.selections[_].type){case"rect":c="select";break;case"path":c="lasso";break}}var y=i(m,g,v,b),w={xref:x._id,yref:l._id,opacity:p.opacity,line:{color:p.line.color,width:p.line.width,dash:p.line.dash}},d;y.length===1&&(d=y[0]),d&&d.length===5&&c==="select"?(w.type="rect",w.x0=d[0][1],w.y0=d[0][2],w.x1=d[2][1],w.y1=d[2][2]):(w.type="path",x&&l&&a(y,x,l),w.path=n(y),d=null),T(g);for(var C=o.editHelpers,S=(C||{}).modifyItem,E=[],k=0;k<M.length;k++){var B=g._fullLayout.selections[k];if(!B){E[k]=B;continue}if(E[k]=B._input,b!==void 0&&k===g._fullLayout._activeSelectionIndex){var z=w;switch(B.type){case"rect":S("x0",z.x0),S("x1",z.x1),S("y0",z.y0),S("y1",z.y1);break;case"path":S("path",z.path);break}}}return b===void 0?(E.push(w),E):C?C.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../shapes/draw_newshape/helpers":466,"../../shapes/handle_outline":468}],454:[function(t,P,R){var h=t("../../lib").strTranslate;function u(i,n){switch(i.type){case"log":return i.p2d(n);case"date":return i.p2r(n,0,i.calendar);default:return i.p2r(n)}}function A(i,n){switch(i.type){case"log":return i.d2p(n);case"date":return i.r2p(n,0,i.calendar);default:return i.r2p(n)}}function T(i){var n=i._id.charAt(0)==="y"?1:0;return function(a){return u(i,a[n])}}function e(i){return h(i.xaxis._offset,i.yaxis._offset)}P.exports={p2r:u,r2p:A,axValue:T,getTransform:e}},{"../../lib":515}],455:[function(t,P,R){var h=t("./draw"),u=t("./select");P.exports={moduleType:"component",name:"selections",layoutAttributes:t("./attributes"),supplyLayoutDefaults:t("./defaults"),supplyDrawNewSelectionDefaults:t("./draw_newselection/defaults"),includeBasePlot:t("../../plots/cartesian/include_components")("selections"),draw:h.draw,drawOne:h.drawOne,reselect:u.reselect,prepSelect:u.prepSelect,clearOutline:u.clearOutline,clearSelectionsCache:u.clearSelectionsCache,selectOnClick:u.selectOnClick}},{"../../plots/cartesian/include_components":577,"./attributes":447,"./defaults":449,"./draw":450,"./draw_newselection/defaults":452,"./select":456}],456:[function(t,P,R){var h=t("polybooljs"),u=t("point-in-polygon/nested"),A=t("../../registry"),T=t("../drawing").dashStyle,e=t("../color"),i=t("../fx"),n=t("../fx/helpers").makeEventData,a=t("../dragelement/helpers"),r=a.freeMode,f=a.rectMode,o=a.drawMode,s=a.openMode,m=a.selectMode,g=t("../shapes/helpers"),p=t("../shapes/constants"),v=t("../shapes/display_outlines"),x=t("../shapes/handle_outline").clearOutline,l=t("../shapes/draw_newshape/helpers"),b=l.handleEllipse,c=l.readPaths,M=t("../shapes/draw_newshape/newshapes"),_=t("./draw_newselection/newselections"),y=t("./draw").activateLastSelection,w=t("../../lib"),d=w.sorterAsc,C=t("../../lib/polygon"),S=t("../../lib/throttle"),E=t("../../plots/cartesian/axis_ids").getFromId,k=t("../../lib/clear_gl_canvases"),B=t("../../plot_api/subroutines").redrawReglTraces,z=t("./constants"),F=z.MINSELECT,I=C.filter,O=C.tester,N=t("./helpers"),V=N.p2r,H=N.axValue,j=N.getTransform;function Z(Ze){return Ze.subplot!==void 0}function X(Ze,nt,Ye,Ee,Ge){var Je=!Z(Ee),qe=r(Ge),Tt=f(Ge),mt=s(Ge),Mt=o(Ge),Ht=m(Ge),Rt=Ge==="drawline",Vt=Ge==="drawcircle",Jt=Rt||Vt,Yt=Ee.gd,or=Yt._fullLayout,Hr=Ht&&or.newselection.mode==="immediate"&&Je,an=or._zoomlayer,Kr=Ee.element.getBoundingClientRect(),ot=Ee.plotinfo,er=j(ot),Kt=nt-Kr.left,ur=Ye-Kr.top;or._calcInverseTransform(Yt);var Ar=w.apply3DTransform(or._invTransform)(Kt,ur);Kt=Ar[0],ur=Ar[1];var et=or._invScaleX,$e=or._invScaleY,st=Kt,ft=ur,St="M"+Kt+","+ur,Ut=Ee.xaxes[0],Pe=Ee.yaxes[0],ke=Ut._length,it=Pe._length,ut=Ze.altKey&&!(o(Ge)&&mt),ht,Et,yt,Dt,Xt,ar,kr;Y(Ze,Yt,Ee),qe&&(ht=I([[Kt,ur]],z.BENDPX));var wr=an.selectAll("path.select-outline-"+ot.id).data([1]),Sr=Mt?or.newshape:or.newselection,Zr=Mt&&!mt?Sr.fillcolor:"rgba(0,0,0,0)",ir=Sr.line.color||(Je?e.contrast(Yt._fullLayout.plot_bgcolor):"#7f7f7f");wr.enter().append("path").attr("class","select-outline select-outline-"+ot.id).style({opacity:Mt?Sr.opacity/2:1,"stroke-dasharray":T(Sr.line.dash,Sr.line.width),"stroke-width":Sr.line.width+"px","shape-rendering":"crispEdges"}).call(e.stroke,ir).call(e.fill,Zr).attr("fill-rule","evenodd").classed("cursor-move",!!Mt).attr("transform",er).attr("d",St+"Z");var xr=an.append("path").attr("class","zoombox-corners").style({fill:e.background,stroke:e.defaultLine,"stroke-width":1}).attr("transform",er).attr("d","M0,0Z"),Fr=or._uid+z.SELECTID,Or=[],Cr=ae(Yt,Ee.xaxes,Ee.yaxes,Ee.subplot);Hr&&!Ze.shiftKey&&(Ee._clearSubplotSelections=function(){if(!!Je){var Ft=Ut._id,jt=Pe._id;Xe(Yt,Ft,jt,Cr);for(var sr=(Yt.layout||{}).selections||[],zr=[],Ur=!1,Dr=0;Dr<sr.length;Dr++){var Tr=or.selections[Dr];Tr.xref!==Ft||Tr.yref!==jt?zr.push(sr[Dr]):Ur=!0}Ur&&(Yt._fullLayout._noEmitSelectedAtStart=!0,A.call("_guiRelayout",Yt,{selections:zr}))}});var at=At(Ee);Ee.moveFn=function(Ft,jt){Ee._clearSubplotSelections&&(Ee._clearSubplotSelections(),Ee._clearSubplotSelections=void 0),st=Math.max(0,Math.min(ke,et*Ft+Kt)),ft=Math.max(0,Math.min(it,$e*jt+ur));var sr=Math.abs(st-Kt),zr=Math.abs(ft-ur);if(Tt){var Ur,Dr,Tr;if(Ht){var Wr=or.selectdirection;switch(Wr==="any"?zr<Math.min(sr*.6,F)?Ur="h":sr<Math.min(zr*.6,F)?Ur="v":Ur="d":Ur=Wr,Ur){case"h":Dr=Vt?it/2:0,Tr=it;break;case"v":Dr=Vt?ke/2:0,Tr=ke;break}}if(Mt)switch(or.newshape.drawdirection){case"vertical":Ur="h",Dr=Vt?it/2:0,Tr=it;break;case"horizontal":Ur="v",Dr=Vt?ke/2:0,Tr=ke;break;case"ortho":sr<zr?(Ur="h",Dr=ur,Tr=ft):(Ur="v",Dr=Kt,Tr=st);break;default:Ur="d"}Ur==="h"?(Dt=Jt?b(Vt,[st,Dr],[st,Tr]):[[Kt,Dr],[Kt,Tr],[st,Tr],[st,Dr]],Dt.xmin=Jt?st:Math.min(Kt,st),Dt.xmax=Jt?st:Math.max(Kt,st),Dt.ymin=Math.min(Dr,Tr),Dt.ymax=Math.max(Dr,Tr),xr.attr("d","M"+Dt.xmin+","+(ur-F)+"h-4v"+2*F+"h4ZM"+(Dt.xmax-1)+","+(ur-F)+"h4v"+2*F+"h-4Z")):Ur==="v"?(Dt=Jt?b(Vt,[Dr,ft],[Tr,ft]):[[Dr,ur],[Dr,ft],[Tr,ft],[Tr,ur]],Dt.xmin=Math.min(Dr,Tr),Dt.xmax=Math.max(Dr,Tr),Dt.ymin=Jt?ft:Math.min(ur,ft),Dt.ymax=Jt?ft:Math.max(ur,ft),xr.attr("d","M"+(Kt-F)+","+Dt.ymin+"v-4h"+2*F+"v4ZM"+(Kt-F)+","+(Dt.ymax-1)+"v4h"+2*F+"v-4Z")):Ur==="d"&&(Dt=Jt?b(Vt,[Kt,ur],[st,ft]):[[Kt,ur],[Kt,ft],[st,ft],[st,ur]],Dt.xmin=Math.min(Kt,st),Dt.xmax=Math.max(Kt,st),Dt.ymin=Math.min(ur,ft),Dt.ymax=Math.max(ur,ft),xr.attr("d","M0,0Z"))}else qe&&(ht.addPt([st,ft]),Dt=ht.filtered);if(Ee.selectionDefs&&Ee.selectionDefs.length?(yt=_e(Ee.mergedPolygons,Dt,ut),Dt.subtract=ut,Et=G(Ee.selectionDefs.concat([Dt]))):(yt=[Dt],Et=O(Dt)),v(De(yt,mt),wr,Ee),Ht){var An=Te(Yt,!1),vn=An.eventData?An.eventData.points.slice():[];An=Te(Yt,!1,Et,Cr,Ee),Et=An.selectionTesters,kr=An.eventData;var Un;ht?Un=ht.filtered:Un=Pt(yt),S.throttle(Fr,z.SELECTDELAY,function(){Or=Ie(Et,Cr);for(var Dn=Or.slice(),Xn=0;Xn<vn.length;Xn++){for(var Yn=vn[Xn],ya=!1,Ca=0;Ca<Dn.length;Ca++)if(Dn[Ca].curveNumber===Yn.curveNumber&&Dn[Ca].pointNumber===Yn.pointNumber){ya=!0;break}ya||Dn.push(Yn)}Dn.length&&(kr||(kr={}),kr.points=Dn),at(kr,Un),Wt(Yt,kr)})}},Ee.clickFn=function(Ft,jt){if(xr.remove(),Yt._fullLayout._activeShapeIndex>=0){Yt._fullLayout._deactivateShape(Yt);return}if(!Mt){var sr=or.clickmode;S.done(Fr).then(function(){if(S.clear(Fr),Ft===2){for(wr.remove(),Xt=0;Xt<Cr.length;Xt++)ar=Cr[Xt],ar._module.selectPoints(ar,!1);if(be(Yt,Cr),J(Ee),Ct(Yt),Cr.length){var zr=Cr[0].xaxis,Ur=Cr[0].yaxis;if(zr&&Ur){for(var Dr=[],Tr=Yt._fullLayout.selections,Wr=0;Wr<Tr.length;Wr++){var An=Tr[Wr];!An||(An.xref!==zr._id||An.yref!==Ur._id)&&Dr.push(An)}Dr.length<Tr.length&&(Yt._fullLayout._noEmitSelectedAtStart=!0,A.call("_guiRelayout",Yt,{selections:Dr}))}}}else sr.indexOf("select")>-1&&re(jt,Yt,Ee.xaxes,Ee.yaxes,Ee.subplot,Ee,wr),sr==="event"&&Bt(Yt,void 0);i.click(Yt,jt)}).catch(w.error)}},Ee.doneFn=function(){xr.remove(),S.done(Fr).then(function(){S.clear(Fr),!Hr&&Dt&&Ee.selectionDefs&&(Dt.subtract=ut,Ee.selectionDefs.push(Dt),Ee.mergedPolygons.length=0,[].push.apply(Ee.mergedPolygons,yt)),(Hr||Mt)&&J(Ee,Hr),Ee.doneFnCompleted&&Ee.doneFnCompleted(Or),Ht&&Bt(Yt,kr)}).catch(w.error)}}function re(Ze,nt,Ye,Ee,Ge,Je,qe){var Tt=nt._hoverdata,mt=nt._fullLayout,Mt=mt.clickmode,Ht=Mt.indexOf("event")>-1,Rt=[],Vt,Jt,Yt,or,Hr,an,Kr,ot,er,Kt;if(ie(Tt)){Y(Ze,nt,Je),Vt=ae(nt,Ye,Ee,Ge);var ur=se(Tt,Vt),Ar=ur.pointNumbers.length>0;if(Ar?oe(Vt,ur):he(Vt)&&(Kr=xe(ur))){for(qe&&qe.remove(),Kt=0;Kt<Vt.length;Kt++)Jt=Vt[Kt],Jt._module.selectPoints(Jt,!1);be(nt,Vt),J(Je),Ht&&Ct(nt)}else{ot=Ze.shiftKey&&(Kr!==void 0?Kr:xe(ur)),Yt=ue(ur.pointNumber,ur.searchInfo,ot);var et=Je.selectionDefs.concat([Yt]);for(or=G(et),Kt=0;Kt<Vt.length;Kt++)if(Hr=Vt[Kt]._module.selectPoints(Vt[Kt],or),an=Se(Hr,Vt[Kt]),Rt.length)for(var $e=0;$e<an.length;$e++)Rt.push(an[$e]);else Rt=an;if(er={points:Rt},be(nt,Vt,er),Yt&&Je&&Je.selectionDefs.push(Yt),qe){var st=Je.mergedPolygons,ft=s(Je.dragmode);v(De(st,ft),qe,Je)}Ht&&Bt(nt,er)}}}function ue(Ze,nt,Ye){return{pointNumber:Ze,searchInfo:nt,subtract:!!Ye}}function K(Ze){return"pointNumber"in Ze&&"searchInfo"in Ze}function te(Ze){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(nt,Ye,Ee,Ge){var Je=Ze.searchInfo.cd[0].trace._expandedIndex,qe=Ge.cd[0].trace._expandedIndex;return qe===Je&&Ee===Ze.pointNumber},isRect:!1,degenerate:!1,subtract:!!Ze.subtract}}function G(Ze){if(!Ze.length)return;for(var nt=[],Ye=K(Ze[0])?0:Ze[0][0][0],Ee=Ye,Ge=K(Ze[0])?0:Ze[0][0][1],Je=Ge,qe=0;qe<Ze.length;qe++)if(K(Ze[qe]))nt.push(te(Ze[qe]));else{var Tt=O(Ze[qe]);Tt.subtract=!!Ze[qe].subtract,nt.push(Tt),Ye=Math.min(Ye,Tt.xmin),Ee=Math.max(Ee,Tt.xmax),Ge=Math.min(Ge,Tt.ymin),Je=Math.max(Je,Tt.ymax)}function mt(Mt,Ht,Rt,Vt){for(var Jt=!1,Yt=0;Yt<nt.length;Yt++)nt[Yt].contains(Mt,Ht,Rt,Vt)&&(Jt=!nt[Yt].subtract);return Jt}return{xmin:Ye,xmax:Ee,ymin:Ge,ymax:Je,pts:[],contains:mt,isRect:!1,degenerate:!1}}function Y(Ze,nt,Ye){var Ee=nt._fullLayout,Ge=Ye.plotinfo,Je=Ye.dragmode,qe=Ee._lastSelectedSubplot&&Ee._lastSelectedSubplot===Ge.id,Tt=(Ze.shiftKey||Ze.altKey)&&!(o(Je)&&s(Je));qe&&Tt&&Ge.selection&&Ge.selection.selectionDefs&&!Ye.selectionDefs?(Ye.selectionDefs=Ge.selection.selectionDefs,Ye.mergedPolygons=Ge.selection.mergedPolygons):(!Tt||!Ge.selection)&&J(Ye),qe||(x(nt),Ee._lastSelectedSubplot=Ge.id)}function ee(Ze){return Ze._fullLayout._activeShapeIndex>=0}function ne(Ze){return Ze._fullLayout._activeSelectionIndex>=0}function J(Ze,nt){var Ye=Ze.dragmode,Ee=Ze.plotinfo,Ge=Ze.gd;ee(Ge)&&Ge._fullLayout._deactivateShape(Ge),ne(Ge)&&Ge._fullLayout._deactivateSelection(Ge);var Je=Ge._fullLayout,qe=Je._zoomlayer,Tt=o(Ye),mt=m(Ye);if(Tt||mt){var Mt=qe.selectAll(".select-outline-"+Ee.id);if(Mt&&Ge._fullLayout._outlining){var Ht;Tt&&(Ht=M(Mt,Ze)),Ht&&A.call("_guiRelayout",Ge,{shapes:Ht});var Rt;mt&&!Z(Ze)&&(Rt=_(Mt,Ze)),Rt&&(Ge._fullLayout._noEmitSelectedAtStart=!0,A.call("_guiRelayout",Ge,{selections:Rt}).then(function(){nt&&y(Ge)})),Ge._fullLayout._outlining=!1}}Ee.selection={},Ee.selection.selectionDefs=Ze.selectionDefs=[],Ee.selection.mergedPolygons=Ze.mergedPolygons=[]}function q(Ze){return Ze._id}function ae(Ze,nt,Ye,Ee){if(!Ze.calcdata)return[];var Ge=[],Je=nt.map(q),qe=Ye.map(q),Tt,mt,Mt;for(Mt=0;Mt<Ze.calcdata.length;Mt++)if(Tt=Ze.calcdata[Mt],mt=Tt[0].trace,!(mt.visible!==!0||!mt._module||!mt._module.selectPoints))if(Z({subplot:Ee})&&(mt.subplot===Ee||mt.geo===Ee))Ge.push(le(mt._module,Tt,nt[0],Ye[0]));else if(mt.type==="splom"){if(mt._xaxes[Je[0]]&&mt._yaxes[qe[0]]){var Ht=le(mt._module,Tt,nt[0],Ye[0]);Ht.scene=Ze._fullLayout._splomScenes[mt.uid],Ge.push(Ht)}}else if(mt.type==="sankey"){var Rt=le(mt._module,Tt,nt[0],Ye[0]);Ge.push(Rt)}else{if(Je.indexOf(mt.xaxis)===-1||qe.indexOf(mt.yaxis)===-1)continue;Ge.push(le(mt._module,Tt,E(Ze,mt.xaxis),E(Ze,mt.yaxis)))}return Ge}function le(Ze,nt,Ye,Ee){return{_module:Ze,cd:nt,xaxis:Ye,yaxis:Ee}}function ie(Ze){return Ze&&Array.isArray(Ze)&&Ze[0].hoverOnBox!==!0}function se(Ze,nt){var Ye=Ze[0],Ee=-1,Ge=[],Je,qe;for(qe=0;qe<nt.length;qe++)if(Je=nt[qe],Ye.fullData._expandedIndex===Je.cd[0].trace._expandedIndex){if(Ye.hoverOnBox===!0)break;Ye.pointNumber!==void 0?Ee=Ye.pointNumber:Ye.binNumber!==void 0&&(Ee=Ye.binNumber,Ge=Ye.pointNumbers);break}return{pointNumber:Ee,pointNumbers:Ge,searchInfo:Je}}function xe(Ze){var nt=Ze.searchInfo.cd[0].trace,Ye=Ze.pointNumber,Ee=Ze.pointNumbers,Ge=Ee.length>0,Je=Ge?Ee[0]:Ye;return nt.selectedpoints?nt.selectedpoints.indexOf(Je)>-1:!1}function oe(Ze,nt){var Ye=[],Ee,Ge,Je,qe;for(qe=0;qe<Ze.length;qe++)Ee=Ze[qe],Ee.cd[0].trace.selectedpoints&&Ee.cd[0].trace.selectedpoints.length>0&&Ye.push(Ee);if(Ye.length===1&&(Je=Ye[0]===nt.searchInfo,Je&&(Ge=nt.searchInfo.cd[0].trace,Ge.selectedpoints.length===nt.pointNumbers.length))){for(qe=0;qe<nt.pointNumbers.length;qe++)if(Ge.selectedpoints.indexOf(nt.pointNumbers[qe])<0)return!1;return!0}return!1}function he(Ze){var nt=0,Ye,Ee,Ge;for(Ge=0;Ge<Ze.length;Ge++)if(Ye=Ze[Ge],Ee=Ye.cd[0].trace,Ee.selectedpoints&&(Ee.selectedpoints.length>1||(nt+=Ee.selectedpoints.length,nt>1)))return!1;return nt===1}function be(Ze,nt,Ye){var Ee;for(Ee=0;Ee<nt.length;Ee++){var Ge=nt[Ee].cd[0].trace._fullInput,Je=Ze._fullLayout._tracePreGUI[Ge.uid]||{};Je.selectedpoints===void 0&&(Je.selectedpoints=Ge._input.selectedpoints||null)}var qe;if(Ye){var Tt=Ye.points||[];for(Ee=0;Ee<nt.length;Ee++)qe=nt[Ee].cd[0].trace,qe._input.selectedpoints=qe._fullInput.selectedpoints=[],qe._fullInput!==qe&&(qe.selectedpoints=[]);for(var mt=0;mt<Tt.length;mt++){var Mt=Tt[mt],Ht=Mt.data,Rt=Mt.fullData,Vt=Mt.pointIndex,Jt=Mt.pointIndices;Jt?([].push.apply(Ht.selectedpoints,Jt),qe._fullInput!==qe&&[].push.apply(Rt.selectedpoints,Jt)):(Ht.selectedpoints.push(Vt),qe._fullInput!==qe&&Rt.selectedpoints.push(Vt))}}else for(Ee=0;Ee<nt.length;Ee++)qe=nt[Ee].cd[0].trace,delete qe.selectedpoints,delete qe._input.selectedpoints,qe._fullInput!==qe&&delete qe._fullInput.selectedpoints;me(Ze,nt)}function me(Ze,nt){for(var Ye=!1,Ee=0;Ee<nt.length;Ee++){var Ge=nt[Ee],Je=Ge.cd;A.traceIs(Je[0].trace,"regl")&&(Ye=!0);var qe=Ge._module,Tt=qe.styleOnSelect||qe.style;Tt&&(Tt(Ze,Je,Je[0].node3),Je[0].nodeRangePlot3&&Tt(Ze,Je,Je[0].nodeRangePlot3))}Ye&&(k(Ze),B(Ze))}function _e(Ze,nt,Ye){for(var Ee=Ye?h.difference:h.union,Ge=Ee({regions:Ze},{regions:[nt]}),Je=Ge.regions.reverse(),qe=0;qe<Je.length;qe++){var Tt=Je[qe];Tt.subtract=We(Tt,Je.slice(0,qe))}return Je}function Se(Ze,nt){if(Array.isArray(Ze))for(var Ye=nt.cd,Ee=nt.cd[0].trace,Ge=0;Ge<Ze.length;Ge++)Ze[Ge]=n(Ze[Ge],Ee,Ye);return Ze}function De(Ze,nt){for(var Ye=[],Ee=0;Ee<Ze.length;Ee++){Ye[Ee]=[];for(var Ge=0;Ge<Ze[Ee].length;Ge++){Ye[Ee][Ge]=[],Ye[Ee][Ge][0]=Ge?"L":"M";for(var Je=0;Je<Ze[Ee][Ge].length;Je++)Ye[Ee][Ge].push(Ze[Ee][Ge][Je])}nt||Ye[Ee].push(["Z",Ye[Ee][0][1],Ye[Ee][0][2]])}return Ye}function Ie(Ze,nt){for(var Ye=[],Ee,Ge,Je=0;Je<nt.length;Je++){var qe=nt[Je];Ge=qe._module.selectPoints(qe,Ze),Ee=Se(Ge,qe),Ye=Ye.concat(Ee)}return Ye}function Te(Ze,nt,Ye,Ee,Ge){var Je=!!Ee,qe,Tt,mt;Ge&&(qe=Ge.plotinfo,Tt=Ge.xaxes[0]._id,mt=Ge.yaxes[0]._id);var Mt=[],Ht=[],Rt=Re(Ze),Vt=Ze._fullLayout;if(qe){var Jt=Vt._zoomlayer,Yt=Vt.dragmode,or=o(Yt),Hr=m(Yt);if(or||Hr){var an=E(Ze,Tt,"x"),Kr=E(Ze,mt,"y");if(an&&Kr){var ot=Jt.selectAll(".select-outline-"+qe.id);if(ot&&Ze._fullLayout._outlining&&ot.length){for(var er=ot[0][0],Kt=er.getAttribute("d"),ur=c(Kt,Ze,qe),Ar=[],et=0;et<ur.length;et++){for(var $e=ur[et],st=[],ft=0;ft<$e.length;ft++)st.push([vt(an,$e[ft][1]),vt(Kr,$e[ft][2])]);st.xref=Tt,st.yref=mt,st.subtract=We(st,Ar),Ar.push(st)}Rt=Rt.concat(Ar)}}}}var St=Tt&&mt?[Tt+mt]:Vt._subplots.cartesian;Ce(Ze);for(var Ut={},Pe=0;Pe<St.length;Pe++){var ke=St[Pe],it=ke.indexOf("y"),ut=ke.slice(0,it),ht=ke.slice(it),Et=Tt&&mt?Ye:void 0;if(Et=Be(Rt,ut,ht,Et),Et){var yt=Ee;if(!Je){var Dt=E(Ze,ut,"x"),Xt=E(Ze,ht,"y");yt=ae(Ze,[Dt],[Xt],ke);for(var ar=0;ar<yt.length;ar++){var kr=yt[ar],wr=kr.cd[0],Sr=wr.trace;if(kr._module.name==="scattergl"&&!wr.t.xpx){var Zr=Sr.x,ir=Sr.y,xr=Sr._length;wr.t.xpx=[],wr.t.ypx=[];for(var Fr=0;Fr<xr;Fr++)wr.t.xpx[Fr]=Dt.c2p(Zr[Fr]),wr.t.ypx[Fr]=Xt.c2p(ir[Fr])}kr._module.name==="splom"&&(Ut[Sr.uid]||(Ut[Sr.uid]=!0))}}var Or=Ie(Et,yt);Mt=Mt.concat(Or),Ht=Ht.concat(yt)}}var Cr={points:Mt};be(Ze,Ht,Cr);var at=Vt.clickmode,Ft=at.indexOf("event")>-1&&nt;if(!qe&&nt){var jt=Re(Ze,!0);if(jt.length){var sr=jt[0].xref,zr=jt[0].yref;if(sr&&zr){var Ur=Pt(jt),Dr=zt([E(Ze,sr,"x"),E(Ze,zr,"y")]);Dr(Cr,Ur)}}Ze._fullLayout._noEmitSelectedAtStart?Ze._fullLayout._noEmitSelectedAtStart=!1:Ft&&Bt(Ze,Cr),Vt._reselect=!1}if(!qe&&Vt._deselect){var Tr=Vt._deselect;Tt=Tr.xref,mt=Tr.yref,He(Tt,mt,Ht)||Xe(Ze,Tt,mt,Ee),Ft&&(Cr.points.length?Bt(Ze,Cr):Ct(Ze)),Vt._deselect=!1}return{eventData:Cr,selectionTesters:Ye}}function Ce(Ze){var nt=Ze.calcdata;if(!!nt)for(var Ye=0;Ye<nt.length;Ye++){var Ee=nt[Ye][0],Ge=Ee.trace,Je=Ze._fullLayout._splomScenes;if(Je){var qe=Je[Ge.uid];qe&&(qe.selectBatch=[])}}}function He(Ze,nt,Ye){for(var Ee=0;Ee<Ye.length;Ee++){var Ge=Ye[Ee];if(Ge.xaxis&&Ge.xaxis._id===Ze&&Ge.yaxis&&Ge.yaxis._id===nt)return!0}return!1}function Xe(Ze,nt,Ye,Ee){Ee=ae(Ze,[E(Ze,nt,"x")],[E(Ze,Ye,"y")],nt+Ye);for(var Ge=0;Ge<Ee.length;Ge++){var Je=Ee[Ge];Je._module.selectPoints(Je,!1)}be(Ze,Ee)}function Be(Ze,nt,Ye,Ee){for(var Ge,Je=0;Je<Ze.length;Je++){var qe=Ze[Je];if(!(nt!==qe.xref||Ye!==qe.yref))if(Ge){var Tt=!!qe.subtract;Ge=_e(Ge,qe,Tt),Ee=G(Ge)}else Ge=[qe],Ee=O(qe)}return Ee}function Re(Ze,nt){for(var Ye=[],Ee=Ze._fullLayout,Ge=Ee.selections,Je=Ge.length,qe=0;qe<Je;qe++)if(!(nt&&qe!==Ee._activeSelectionIndex)){var Tt=Ge[qe];if(!!Tt){var mt=Tt.xref,Mt=Tt.yref,Ht=E(Ze,mt,"x"),Rt=E(Ze,Mt,"y"),Vt,Jt,Yt,or,Hr;if(Tt.type==="rect"){Hr=[];var an=vt(Ht,Tt.x0),Kr=vt(Ht,Tt.x1),ot=vt(Rt,Tt.y0),er=vt(Rt,Tt.y1);Hr=[[an,ot],[an,er],[Kr,er],[Kr,ot]],Vt=Math.min(an,Kr),Jt=Math.max(an,Kr),Yt=Math.min(ot,er),or=Math.max(ot,er),Hr.xmin=Vt,Hr.xmax=Jt,Hr.ymin=Yt,Hr.ymax=or,Hr.xref=mt,Hr.yref=Mt,Hr.subtract=!1,Hr.isRect=!0,Ye.push(Hr)}else if(Tt.type==="path")for(var Kt=Tt.path.split("Z"),ur=[],Ar=0;Ar<Kt.length;Ar++){var et=Kt[Ar];if(!!et){et+="Z";var $e=g.extractPathCoords(et,p.paramIsX,"raw"),st=g.extractPathCoords(et,p.paramIsY,"raw");Vt=1/0,Jt=-1/0,Yt=1/0,or=-1/0,Hr=[];for(var ft=0;ft<$e.length;ft++){var St=vt(Ht,$e[ft]),Ut=vt(Rt,st[ft]);Hr.push([St,Ut]),Vt=Math.min(St,Vt),Jt=Math.max(St,Jt),Yt=Math.min(Ut,Yt),or=Math.max(Ut,or)}Hr.xmin=Vt,Hr.xmax=Jt,Hr.ymin=Yt,Hr.ymax=or,Hr.xref=mt,Hr.yref=Mt,Hr.subtract=We(Hr,ur),ur.push(Hr),Ye.push(Hr)}}}}return Ye}function We(Ze,nt){for(var Ye=!1,Ee=0;Ee<nt.length;Ee++)for(var Ge=nt[Ee],Je=0;Je<Ze.length;Je++)if(u(Ze[Je],Ge)){Ye=!Ye;break}return Ye}function vt(Ze,nt){return Ze.type==="date"&&(nt=nt.replace("_"," ")),Ze.type==="log"?Ze.c2p(nt):Ze.r2p(nt,null,Ze.calendar)}function Pt(Ze){for(var nt=Ze.length,Ye=[],Ee=0;Ee<nt;Ee++){var Ge=Ze[Ee];Ye=Ye.concat(Ge),Ye=Ye.concat([Ge[0]])}return Zt(Ye)}function Zt(Ze){return Ze.isRect=Ze.length===5&&Ze[0][0]===Ze[4][0]&&Ze[0][1]===Ze[4][1]&&Ze[0][0]===Ze[1][0]&&Ze[2][0]===Ze[3][0]&&Ze[0][1]===Ze[3][1]&&Ze[1][1]===Ze[2][1]||Ze[0][1]===Ze[1][1]&&Ze[2][1]===Ze[3][1]&&Ze[0][0]===Ze[3][0]&&Ze[1][0]===Ze[2][0],Ze.isRect&&(Ze.xmin=Math.min(Ze[0][0],Ze[2][0]),Ze.xmax=Math.max(Ze[0][0],Ze[2][0]),Ze.ymin=Math.min(Ze[0][1],Ze[2][1]),Ze.ymax=Math.max(Ze[0][1],Ze[2][1])),Ze}function zt(Ze){return function(nt,Ye){for(var Ee,Ge,Je=0;Je<Ze.length;Je++){var qe=Ze[Je],Tt=qe._id,mt=Tt.charAt(0);if(Ye.isRect){Ee||(Ee={});var Mt=Ye[mt+"min"],Ht=Ye[mt+"max"];Mt!==void 0&&Ht!==void 0&&(Ee[Tt]=[V(qe,Mt),V(qe,Ht)].sort(d))}else Ge||(Ge={}),Ge[Tt]=Ye.map(H(qe))}Ee&&(nt.range=Ee),Ge&&(nt.lassoPoints=Ge)}}function At(Ze){var nt=Ze.plotinfo;return nt.fillRangeItems||zt(Ze.xaxes.concat(Ze.yaxes))}function Wt(Ze,nt){Ze.emit("plotly_selecting",nt)}function Bt(Ze,nt){nt&&(nt.selections=(Ze.layout||{}).selections||[]),Ze.emit("plotly_selected",nt)}function Ct(Ze){Ze.emit("plotly_deselect",null)}P.exports={reselect:Te,prepSelect:X,clearOutline:x,clearSelectionsCache:J,selectOnClick:re}},{"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/polygon":527,"../../lib/throttle":542,"../../plot_api/subroutines":556,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../color":367,"../dragelement/helpers":385,"../drawing":389,"../fx":407,"../fx/helpers":403,"../shapes/constants":459,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/draw_newshape/newshapes":467,"../shapes/handle_outline":468,"../shapes/helpers":469,"./constants":448,"./draw":450,"./draw_newselection/newselections":453,"./helpers":454,"point-in-polygon/nested":254,polybooljs:255}],457:[function(t,P,R){var h=t("../annotations/attributes"),u=t("../../traces/scatter/attributes").line,A=t("../drawing/attributes").dash,T=t("../../lib/extend").extendFlat,e=t("../../plot_api/plot_template").templatedArray;t("../../constants/axis_placeable_objects"),P.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:T({},h.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:T({},h.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:T({},u.color,{editType:"arraydraw"}),width:T({},u.width,{editType:"calc+arraydraw"}),dash:T({},A,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],458:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axes"),A=t("./constants"),T=t("./helpers");P.exports=function(f){var o=f._fullLayout,s=h.filterVisible(o.shapes);if(!(!s.length||!f._fullData.length))for(var m=0;m<s.length;m++){var g=s[m];g._extremes={};var p,v,x=u.getRefType(g.xref),l=u.getRefType(g.yref);if(g.xref!=="paper"&&x!=="domain"){var b=g.xsizemode==="pixel"?g.xanchor:g.x0,c=g.xsizemode==="pixel"?g.xanchor:g.x1;p=u.getFromId(f,g.xref),v=a(p,b,c,g.path,A.paramIsX),v&&(g._extremes[p._id]=u.findExtremes(p,v,e(g)))}if(g.yref!=="paper"&&l!=="domain"){var M=g.ysizemode==="pixel"?g.yanchor:g.y0,_=g.ysizemode==="pixel"?g.yanchor:g.y1;p=u.getFromId(f,g.yref),v=a(p,M,_,g.path,A.paramIsY),v&&(g._extremes[p._id]=u.findExtremes(p,v,i(g)))}}};function e(r){return n(r.line.width,r.xsizemode,r.x0,r.x1,r.path,!1)}function i(r){return n(r.line.width,r.ysizemode,r.y0,r.y1,r.path,!0)}function n(r,f,o,s,m,g){var p=r/2,v=g;if(f==="pixel"){var x=m?T.extractPathCoords(m,g?A.paramIsY:A.paramIsX):[o,s],l=h.aggNums(Math.max,null,x),b=h.aggNums(Math.min,null,x),c=b<0?Math.abs(b)+p:p,M=l>0?l+p:p;return{ppad:p,ppadplus:v?c:M,ppadminus:v?M:c}}else return{ppad:p}}function a(r,f,o,s,m){var g=r.type==="category"||r.type==="multicategory"?r.r2c:r.d2c;if(f!==void 0)return[g(f),g(o)];if(!!s){var p=1/0,v=-1/0,x=s.match(A.segmentRE),l,b,c,M,_;for(r.type==="date"&&(g=T.decodeDate(g)),l=0;l<x.length;l++)b=x[l],c=m[b.charAt(0)].drawn,c!==void 0&&(M=x[l].substr(1).match(A.paramRE),!(!M||M.length<c)&&(_=g(M[c]),_<p&&(p=_),_>v&&(v=_)));if(v>=p)return[p,v]}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459,"./helpers":469}],459:[function(t,P,R){P.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],460:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axes"),A=t("../../plots/array_container_defaults"),T=t("./attributes"),e=t("./helpers");P.exports=function(a,r){A(a,r,{name:"shapes",handleItemDefaults:i})};function i(n,a,r){function f(H,j){return h.coerce(n,a,T,H,j)}var o=f("visible");if(!!o){var s=f("path"),m=s?"path":"rect",g=f("type",m),p=g!=="path";p&&delete a.path,f("editable"),f("layer"),f("opacity"),f("fillcolor"),f("fillrule");var v=f("line.width");v&&(f("line.color"),f("line.dash"));for(var x=f("xsizemode"),l=f("ysizemode"),b=["x","y"],c=0;c<2;c++){var M=b[c],_=M+"anchor",y=M==="x"?x:l,w={_fullLayout:r},d,C,S,E=u.coerceRef(n,a,w,M,void 0,"paper"),k=u.getRefType(E);if(k==="range"?(d=u.getFromId(w,E),d._shapeIndices.push(a._index),S=e.rangeToShapePosition(d),C=e.shapePositionToRange(d)):C=S=h.identity,p){var B=.25,z=.75,F=M+"0",I=M+"1",O=n[F],N=n[I];n[F]=C(n[F],!0),n[I]=C(n[I],!0),y==="pixel"?(f(F,0),f(I,10)):(u.coercePosition(a,w,f,E,F,B),u.coercePosition(a,w,f,E,I,z)),a[F]=S(a[F]),a[I]=S(a[I]),n[F]=O,n[I]=N}if(y==="pixel"){var V=n[_];n[_]=C(n[_],!0),u.coercePosition(a,w,f,E,_,.25),a[_]=S(a[_]),n[_]=V}}p&&h.noneOrAll(n,a,["x0","x1","y0","y1"])}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":457,"./helpers":469}],461:[function(t,P,R){var h=t("../../lib"),u=h.strTranslate,A=t("../dragelement"),T=t("../dragelement/helpers"),e=T.drawMode,i=T.selectMode,n=t("../../registry"),a=t("../color"),r=t("./draw_newshape/constants"),f=r.i000,o=r.i090,s=r.i180,m=r.i270,g=t("./handle_outline"),p=g.clearOutlineControllers,v=t("./draw_newshape/helpers"),x=v.pointsOnRectangle,l=v.pointsOnEllipse,b=v.writePaths,c=t("./draw_newshape/newshapes"),M=t("../selections/draw_newselection/newselections");P.exports=function d(C,S,E,k){k||(k=0);var B=E.gd;function z(){d(C,S,E,k++),l(C[0])&&F({redrawing:!0})}function F(oe){var he={};E.isActiveShape!==void 0&&(E.isActiveShape=!1,he=c(S,E)),E.isActiveSelection!==void 0&&(E.isActiveSelection=!1,he=M(S,E),B._fullLayout._reselect=!0),Object.keys(he).length&&n.call((oe||{}).redrawing?"relayout":"_guiRelayout",B,he)}var I=B._fullLayout,O=I._zoomlayer,N=E.dragmode,V=e(N),H=i(N);(V||H)&&(B._fullLayout._outlining=!0),p(B),S.attr("d",b(C));var j,Z,X,re,ue;if(!k&&(E.isActiveShape||E.isActiveSelection)){ue=_([],C);var K=O.append("g").attr("class","outline-controllers");J(K),xe()}function te(oe){X=+oe.srcElement.getAttribute("data-i"),re=+oe.srcElement.getAttribute("data-j"),j[X][re].moveFn=G}function G(oe,he){if(!!C.length){var be=ue[X][re][1],me=ue[X][re][2],_e=C[X],Se=_e.length;if(x(_e)){var De=oe,Ie=he;if(E.isActiveSelection){var Te=y(_e,re);Te[1]===_e[re][1]?Ie=0:De=0}for(var Ce=0;Ce<Se;Ce++)if(Ce!==re){var He=_e[Ce];He[1]===_e[re][1]&&(He[1]=be+De),He[2]===_e[re][2]&&(He[2]=me+Ie)}if(_e[re][1]=be+De,_e[re][2]=me+Ie,!x(_e))for(var Xe=0;Xe<Se;Xe++)for(var Be=0;Be<_e[Xe].length;Be++)_e[Xe][Be]=ue[X][Xe][Be]}else _e[re][1]=be+oe,_e[re][2]=me+he;z()}}function Y(){F()}function ee(){if(!!C.length&&!!C[X]&&!!C[X].length){for(var oe=[],he=0;he<C[X].length;he++)he!==re&&oe.push(C[X][he]);oe.length>1&&!(oe.length===2&&oe[1][0]==="Z")&&(re===0&&(oe[0][0]="M"),C[X]=oe,z(),F())}}function ne(oe,he){if(oe===2){X=+he.srcElement.getAttribute("data-i"),re=+he.srcElement.getAttribute("data-j");var be=C[X];!x(be)&&!l(be)&&ee()}}function J(oe){j=[];for(var he=0;he<C.length;he++){var be=C[he],me=x(be),_e=!me&&l(be);j[he]=[];for(var Se=be.length,De=0;De<Se;De++)if(be[De][0]!=="Z"&&!(_e&&De!==f&&De!==o&&De!==s&&De!==m)){var Ie=me&&E.isActiveSelection,Te;Ie&&(Te=y(be,De));var Ce=be[De][1],He=be[De][2],Xe=oe.append(Ie?"rect":"circle").attr("data-i",he).attr("data-j",De).style({fill:a.background,stroke:a.defaultLine,"stroke-width":1,"shape-rendering":"crispEdges"});if(Ie){var Be=Te[1]-Ce,Re=Te[2]-He,We=Re?5:Math.max(Math.min(25,Math.abs(Be)-5),5),vt=Be?5:Math.max(Math.min(25,Math.abs(Re)-5),5);Xe.classed(Re?"cursor-ew-resize":"cursor-ns-resize",!0).attr("width",We).attr("height",vt).attr("x",Ce-We/2).attr("y",He-vt/2).attr("transform",u(Be/2,Re/2))}else Xe.classed("cursor-grab",!0).attr("r",5).attr("cx",Ce).attr("cy",He);j[he][De]={element:Xe.node(),gd:B,prepFn:te,doneFn:Y,clickFn:ne},A.init(j[he][De])}}}function q(oe,he){if(!!C.length)for(var be=0;be<C.length;be++)for(var me=0;me<C[be].length;me++)for(var _e=0;_e+2<C[be][me].length;_e+=2)C[be][me][_e+1]=ue[be][me][_e+1]+oe,C[be][me][_e+2]=ue[be][me][_e+2]+he}function ae(oe,he){q(oe,he),z()}function le(oe){X=+oe.srcElement.getAttribute("data-i"),X||(X=0),Z[X].moveFn=ae}function ie(){F()}function se(oe){oe===2&&w(B)}function xe(){if(Z=[],!!C.length){var oe=0;Z[oe]={element:S[0][0],gd:B,prepFn:le,doneFn:ie,clickFn:se},A.init(Z[oe])}}};function _(d,C){for(var S=0;S<C.length;S++){var E=C[S];d[S]=[];for(var k=0;k<E.length;k++){d[S][k]=[];for(var B=0;B<E[k].length;B++)d[S][k][B]=E[k][B]}}return d}function y(d,C){var S=d[C][1],E=d[C][2],k=d.length,B,z,F;return B=(C+1)%k,z=d[B][1],F=d[B][2],z===S&&F===E&&(B=(C+2)%k,z=d[B][1],F=d[B][2]),[B,z,F]}function w(d){if(!!i(d._fullLayout.dragmode)){p(d);var C=d._fullLayout._activeSelectionIndex,S=(d.layout||{}).selections||[];if(C<S.length){for(var E=[],k=0;k<S.length;k++)k!==C&&E.push(S[k]);delete d._fullLayout._activeSelectionIndex;var B=d._fullLayout.selections[C];d._fullLayout._deselect={xref:B.xref,yref:B.yref},n.call("_guiRelayout",d,{selections:E})}}}},{"../../lib":515,"../../registry":647,"../color":367,"../dragelement":386,"../dragelement/helpers":385,"../selections/draw_newselection/newselections":453,"./draw_newshape/constants":464,"./draw_newshape/helpers":466,"./draw_newshape/newshapes":467,"./handle_outline":468}],462:[function(t,P,R){var h=t("../../registry"),u=t("../../lib"),A=t("../../plots/cartesian/axes"),T=t("./draw_newshape/helpers").readPaths,e=t("./display_outlines"),i=t("./handle_outline").clearOutlineControllers,n=t("../color"),a=t("../drawing"),r=t("../../plot_api/plot_template").arrayEditor,f=t("../dragelement"),o=t("../../lib/setcursor"),s=t("./constants"),m=t("./helpers"),g=m.getPathString;P.exports={draw:p,drawOne:l,eraseActiveShape:w};function p(d){var C=d._fullLayout;C._shapeUpperLayer.selectAll("path").remove(),C._shapeLowerLayer.selectAll("path").remove();for(var S in C._plots){var E=C._plots[S].shapelayer;E&&E.selectAll("path").remove()}for(var k=0;k<C.shapes.length;k++)C.shapes[k].visible&&l(d,k)}function v(d){return!!d._fullLayout._outlining}function x(d){return!d._context.edits.shapePosition}function l(d,C){d._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+C+'"]').remove();var S=m.makeShapesOptionsAndPlotinfo(d,C),E=S.options,k=S.plotinfo;if(!E._input||E.visible===!1)return;if(E.layer!=="below")z(d._fullLayout._shapeUpperLayer);else if(E.xref==="paper"||E.yref==="paper")z(d._fullLayout._shapeLowerLayer);else if(k._hadPlotinfo){var B=k.mainplotinfo||k;z(B.shapelayer)}else z(d._fullLayout._shapeLowerLayer);function z(F){var I=g(d,E),O={"data-index":C,"fill-rule":E.fillrule,d:I},N=E.opacity,V=E.fillcolor,H=E.line.width?E.line.color:"rgba(0,0,0,0)",j=E.line.width,Z=E.line.dash;!j&&E.editable===!0&&(j=5,Z="solid");var X=I[I.length-1]!=="Z",re=x(d)&&E.editable&&d._fullLayout._activeShapeIndex===C;re&&(V=X?"rgba(0,0,0,0)":d._fullLayout.activeshape.fillcolor,N=d._fullLayout.activeshape.opacity);var ue=F.append("path").attr(O).style("opacity",N).call(n.stroke,H).call(n.fill,V).call(a.dashLine,Z,j);b(ue,d,E);var K;if((re||d._context.edits.shapePosition)&&(K=r(d.layout,"shapes",E)),re){ue.style({cursor:"move"});var te={element:ue.node(),plotinfo:k,gd:d,editHelpers:K,isActiveShape:!0},G=T(I,d);e(G,ue,te)}else d._context.edits.shapePosition?c(d,ue,E,C,F,K):E.editable===!0&&ue.style("pointer-events",X||n.opacity(V)*N<=.5?"stroke":"all");ue.node().addEventListener("click",function(){return _(d,ue)})}}function b(d,C,S){var E=(S.xref+S.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");a.setClipUrl(d,E?"clip"+C._fullLayout._uid+E:null,C)}function c(d,C,S,E,k,B){var z=10,F=10,I=S.xsizemode==="pixel",O=S.ysizemode==="pixel",N=S.type==="line",V=S.type==="path",H=B.modifyItem,j,Z,X,re,ue,K,te,G,Y,ee,ne,J,q,ae,le,ie=A.getFromId(d,S.xref),se=A.getRefType(S.xref),xe=A.getFromId(d,S.yref),oe=A.getRefType(S.yref),he=m.getDataToPixel(d,ie,!1,se),be=m.getDataToPixel(d,xe,!0,oe),me=m.getPixelToData(d,ie,!1,se),_e=m.getPixelToData(d,xe,!0,oe),Se=Te(),De={element:Se.node(),gd:d,prepFn:Xe,doneFn:Be,clickFn:Re},Ie;f.init(De),Se.node().onmousemove=He;function Te(){return N?Ce():C}function Ce(){var At=10,Wt=Math.max(S.line.width,At),Bt=k.append("g").attr("data-index",E);Bt.append("path").attr("d",C.attr("d")).style({cursor:"move","stroke-width":Wt,"stroke-opacity":"0"});var Ct={"fill-opacity":"0"},Ze=Math.max(Wt/2,At);return Bt.append("circle").attr({"data-line-point":"start-point",cx:I?he(S.xanchor)+S.x0:he(S.x0),cy:O?be(S.yanchor)-S.y0:be(S.y0),r:Ze}).style(Ct).classed("cursor-grab",!0),Bt.append("circle").attr({"data-line-point":"end-point",cx:I?he(S.xanchor)+S.x1:he(S.x1),cy:O?be(S.yanchor)-S.y1:be(S.y1),r:Ze}).style(Ct).classed("cursor-grab",!0),Bt}function He(At){if(v(d)){Ie=null;return}if(N)At.target.tagName==="path"?Ie="move":Ie=At.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var Wt=De.element.getBoundingClientRect(),Bt=Wt.right-Wt.left,Ct=Wt.bottom-Wt.top,Ze=At.clientX-Wt.left,nt=At.clientY-Wt.top,Ye=!V&&Bt>z&&Ct>F&&!At.shiftKey?f.getCursor(Ze/Bt,1-nt/Ct):"move";o(C,Ye),Ie=Ye.split("-")[0]}}function Xe(At){v(d)||(I&&(ue=he(S.xanchor)),O&&(K=be(S.yanchor)),S.type==="path"?le=S.path:(j=I?S.x0:he(S.x0),Z=O?S.y0:be(S.y0),X=I?S.x1:he(S.x1),re=O?S.y1:be(S.y1)),j<X?(Y=j,q="x0",ee=X,ae="x1"):(Y=X,q="x1",ee=j,ae="x0"),!O&&Z<re||O&&Z>re?(te=Z,ne="y0",G=re,J="y1"):(te=re,ne="y1",G=Z,J="y0"),He(At),Pt(k,S),zt(C,S,d),De.moveFn=Ie==="move"?We:vt,De.altKey=At.altKey)}function Be(){v(d)||(o(C),Zt(k),b(C,d,S),h.call("_guiRelayout",d,B.getUpdateObj()))}function Re(){v(d)||Zt(k)}function We(At,Wt){if(S.type==="path"){var Bt=function(nt){return nt},Ct=Bt,Ze=Bt;I?H("xanchor",S.xanchor=me(ue+At)):(Ct=function(Ye){return me(he(Ye)+At)},ie&&ie.type==="date"&&(Ct=m.encodeDate(Ct))),O?H("yanchor",S.yanchor=_e(K+Wt)):(Ze=function(Ye){return _e(be(Ye)+Wt)},xe&&xe.type==="date"&&(Ze=m.encodeDate(Ze))),H("path",S.path=M(le,Ct,Ze))}else I?H("xanchor",S.xanchor=me(ue+At)):(H("x0",S.x0=me(j+At)),H("x1",S.x1=me(X+At))),O?H("yanchor",S.yanchor=_e(K+Wt)):(H("y0",S.y0=_e(Z+Wt)),H("y1",S.y1=_e(re+Wt)));C.attr("d",g(d,S)),Pt(k,S)}function vt(At,Wt){if(V){var Bt=function(Yt){return Yt},Ct=Bt,Ze=Bt;I?H("xanchor",S.xanchor=me(ue+At)):(Ct=function(or){return me(he(or)+At)},ie&&ie.type==="date"&&(Ct=m.encodeDate(Ct))),O?H("yanchor",S.yanchor=_e(K+Wt)):(Ze=function(or){return _e(be(or)+Wt)},xe&&xe.type==="date"&&(Ze=m.encodeDate(Ze))),H("path",S.path=M(le,Ct,Ze))}else if(N){if(Ie==="resize-over-start-point"){var nt=j+At,Ye=O?Z-Wt:Z+Wt;H("x0",S.x0=I?nt:me(nt)),H("y0",S.y0=O?Ye:_e(Ye))}else if(Ie==="resize-over-end-point"){var Ee=X+At,Ge=O?re-Wt:re+Wt;H("x1",S.x1=I?Ee:me(Ee)),H("y1",S.y1=O?Ge:_e(Ge))}}else{var Je=function(Yt){return Ie.indexOf(Yt)!==-1},qe=Je("n"),Tt=Je("s"),mt=Je("w"),Mt=Je("e"),Ht=qe?te+Wt:te,Rt=Tt?G+Wt:G,Vt=mt?Y+At:Y,Jt=Mt?ee+At:ee;O&&(qe&&(Ht=te-Wt),Tt&&(Rt=G-Wt)),(!O&&Rt-Ht>F||O&&Ht-Rt>F)&&(H(ne,S[ne]=O?Ht:_e(Ht)),H(J,S[J]=O?Rt:_e(Rt))),Jt-Vt>z&&(H(q,S[q]=I?Vt:me(Vt)),H(ae,S[ae]=I?Jt:me(Jt)))}C.attr("d",g(d,S)),Pt(k,S)}function Pt(At,Wt){(I||O)&&Bt();function Bt(){var Ct=Wt.type!=="path",Ze=At.selectAll(".visual-cue").data([0]),nt=1;Ze.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":nt}).classed("visual-cue",!0);var Ye=he(I?Wt.xanchor:u.midRange(Ct?[Wt.x0,Wt.x1]:m.extractPathCoords(Wt.path,s.paramIsX))),Ee=be(O?Wt.yanchor:u.midRange(Ct?[Wt.y0,Wt.y1]:m.extractPathCoords(Wt.path,s.paramIsY)));if(Ye=m.roundPositionForSharpStrokeRendering(Ye,nt),Ee=m.roundPositionForSharpStrokeRendering(Ee,nt),I&&O){var Ge="M"+(Ye-1-nt)+","+(Ee-1-nt)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";Ze.attr("d",Ge)}else if(I){var Je="M"+(Ye-1-nt)+","+(Ee-9-nt)+"v18 h2 v-18 Z";Ze.attr("d",Je)}else{var qe="M"+(Ye-9-nt)+","+(Ee-1-nt)+"h18 v2 h-18 Z";Ze.attr("d",qe)}}}function Zt(At){At.selectAll(".visual-cue").remove()}function zt(At,Wt,Bt){var Ct=Wt.xref,Ze=Wt.yref,nt=A.getFromId(Bt,Ct),Ye=A.getFromId(Bt,Ze),Ee="";Ct!=="paper"&&!nt.autorange&&(Ee+=Ct),Ze!=="paper"&&!Ye.autorange&&(Ee+=Ze),a.setClipUrl(At,Ee?"clip"+Bt._fullLayout._uid+Ee:null,Bt)}}function M(d,C,S){return d.replace(s.segmentRE,function(E){var k=0,B=E.charAt(0),z=s.paramIsX[B],F=s.paramIsY[B],I=s.numParams[B],O=E.substr(1).replace(s.paramRE,function(N){return k>=I||(z[k]?N=C(N):F[k]&&(N=S(N)),k++),N});return B+O})}function _(d,C){if(!!x(d)){var S=C.node(),E=+S.getAttribute("data-index");if(E>=0){if(E===d._fullLayout._activeShapeIndex){y(d);return}d._fullLayout._activeShapeIndex=E,d._fullLayout._deactivateShape=y,p(d)}}}function y(d){if(!!x(d)){var C=d._fullLayout._activeShapeIndex;C>=0&&(i(d),delete d._fullLayout._activeShapeIndex,p(d))}}function w(d){if(!!x(d)){i(d);var C=d._fullLayout._activeShapeIndex,S=(d.layout||{}).shapes||[];if(C<S.length){for(var E=[],k=0;k<S.length;k++)k!==C&&E.push(S[k]);delete d._fullLayout._activeShapeIndex,h.call("_guiRelayout",d,{shapes:E})}}}},{"../../lib":515,"../../lib/setcursor":536,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":459,"./display_outlines":461,"./draw_newshape/helpers":466,"./handle_outline":468,"./helpers":469}],463:[function(t,P,R){var h=t("../../drawing/attributes").dash,u=t("../../../lib/extend").extendFlat;P.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:u({},h,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],464:[function(t,P,R){var h=32;P.exports={CIRCLE_SIDES:h,i000:0,i090:h/4,i180:h/2,i270:h/4*3,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],465:[function(t,P,R){var h=t("../../color");P.exports=function(A,T,e){e("newshape.drawdirection"),e("newshape.layer"),e("newshape.fillcolor"),e("newshape.fillrule"),e("newshape.opacity");var i=e("newshape.line.width");if(i){var n=(A||{}).plot_bgcolor||"#FFF";e("newshape.line.color",h.contrast(n)),e("newshape.line.dash")}e("activeshape.fillcolor"),e("activeshape.opacity")}},{"../../color":367}],466:[function(t,P,R){var h=t("parse-svg-path"),u=t("./constants"),A=u.CIRCLE_SIDES,T=u.SQRT2,e=t("../../selections/helpers"),i=e.p2r,n=e.r2p,a=[0,3,4,5,6,1,2],r=[0,3,4,1,2];R.writePaths=function(s){var m=s.length;if(!m)return"M0,0Z";for(var g="",p=0;p<m;p++)for(var v=s[p].length,x=0;x<v;x++){var l=s[p][x][0];if(l==="Z")g+="Z";else for(var b=s[p][x].length,c=0;c<b;c++){var M=c;l==="Q"||l==="S"?M=r[c]:l==="C"&&(M=a[c]),g+=s[p][x][M],c>0&&c<b-1&&(g+=",")}}return g},R.readPaths=function(s,m,g,p){var v=h(s),x=[],l=-1,b=function(){l++,x[l]=[]},c,M=0,_=0,y,w,d=function(){y=M,w=_};d();for(var C=0;C<v.length;C++){var S=[],E,k,B,z,F=v[C][0],I=F;switch(F){case"M":b(),M=+v[C][1],_=+v[C][2],S.push([I,M,_]),d();break;case"Q":case"S":E=+v[C][1],B=+v[C][2],M=+v[C][3],_=+v[C][4],S.push([I,M,_,E,B]);break;case"C":E=+v[C][1],B=+v[C][2],k=+v[C][3],z=+v[C][4],M=+v[C][5],_=+v[C][6],S.push([I,M,_,E,B,k,z]);break;case"T":case"L":M=+v[C][1],_=+v[C][2],S.push([I,M,_]);break;case"H":I="L",M=+v[C][1],S.push([I,M,_]);break;case"V":I="L",_=+v[C][1],S.push([I,M,_]);break;case"A":I="L";var O=+v[C][1],N=+v[C][2];+v[C][4]||(O=-O,N=-N);var V=M-O,H=_;for(c=1;c<=A/2;c++){var j=2*Math.PI*c/A;S.push([I,V+O*Math.cos(j),H+N*Math.sin(j)])}break;case"Z":(M!==y||_!==w)&&(M=y,_=w,S.push([I,M,_]));break}for(var Z=(g||{}).domain,X=m._fullLayout._size,re=g&&g.xsizemode==="pixel",ue=g&&g.ysizemode==="pixel",K=p===!1,te=0;te<S.length;te++){for(c=0;c+2<7;c+=2){var G=S[te][c+1],Y=S[te][c+2];G===void 0||Y===void 0||(M=G,_=Y,g&&(g.xaxis&&g.xaxis.p2r?(K&&(G-=g.xaxis._offset),re?G=n(g.xaxis,g.xanchor)+G:G=i(g.xaxis,G)):(K&&(G-=X.l),Z?G=Z.x[0]+G/X.w:G=G/X.w),g.yaxis&&g.yaxis.p2r?(K&&(Y-=g.yaxis._offset),ue?Y=n(g.yaxis,g.yanchor)-Y:Y=i(g.yaxis,Y)):(K&&(Y-=X.t),Z?Y=Z.y[1]-Y/X.h:Y=1-Y/X.h)),S[te][c+1]=G,S[te][c+2]=Y)}x[l].push(S[te].slice())}}return x};function f(s,m){return Math.abs(s-m)<=1e-6}function o(s,m){var g=m[1]-s[1],p=m[2]-s[2];return Math.sqrt(g*g+p*p)}R.pointsOnRectangle=function(s){var m=s.length;if(m!==5)return!1;for(var g=1;g<3;g++){var p=s[0][g]-s[1][g],v=s[3][g]-s[2][g];if(!f(p,v))return!1;var x=s[0][g]-s[3][g],l=s[1][g]-s[2][g];if(!f(x,l))return!1}return!f(s[0][1],s[1][1])&&!f(s[0][1],s[3][1])?!1:!!(o(s[0],s[1])*o(s[0],s[3]))},R.pointsOnEllipse=function(s){var m=s.length;if(m!==A+1)return!1;m=A;for(var g=0;g<m;g++){var p=(m*2-g)%m,v=(m/2+p)%m,x=(m/2+g)%m;if(!f(o(s[g],s[x]),o(s[p],s[v])))return!1}return!0},R.handleEllipse=function(s,m,g){if(!s)return[m,g];var p=R.ellipseOver({x0:m[0],y0:m[1],x1:g[0],y1:g[1]}),v=(p.x1+p.x0)/2,x=(p.y1+p.y0)/2,l=(p.x1-p.x0)/2,b=(p.y1-p.y0)/2;l||(l=b=b/T),b||(b=l=l/T);for(var c=[],M=0;M<A;M++){var _=M*2*Math.PI/A;c.push([v+l*Math.cos(_),x+b*Math.sin(_)])}return c},R.ellipseOver=function(s){var m=s.x0,g=s.y0,p=s.x1,v=s.y1,x=p-m,l=v-g;m-=x,g-=l;var b=(m+p)/2,c=(g+v)/2,M=T;return x*=M,l*=M,{x0:b-x,y0:c-l,x1:b+x,y1:c+l}},R.fixDatesForPaths=function(s,m,g){var p=m.type==="date",v=g.type==="date";if(!p&&!v)return s;for(var x=0;x<s.length;x++)for(var l=0;l<s[x].length;l++)for(var b=0;b+2<s[x][l].length;b+=2)p&&(s[x][l][b+1]=s[x][l][b+1].replace(" ","_")),v&&(s[x][l][b+2]=s[x][l][b+2].replace(" ","_"));return s}},{"../../selections/helpers":454,"./constants":464,"parse-svg-path":250}],467:[function(t,P,R){var h=t("../../dragelement/helpers"),u=h.drawMode,A=h.openMode,T=t("./constants"),e=T.i000,i=T.i090,n=T.i180,a=T.i270,r=T.cos45,f=T.sin45,o=t("../../selections/helpers"),s=o.p2r,m=o.r2p,g=t(".././handle_outline"),p=g.clearOutline,v=t("./helpers"),x=v.readPaths,l=v.writePaths,b=v.ellipseOver,c=v.fixDatesForPaths;P.exports=function(_,y){if(!!_.length){var w=_[0][0];if(!!w){var d=w.getAttribute("d"),C=y.gd,S=C._fullLayout.newshape,E=y.plotinfo,k=E.xaxis,B=E.yaxis,z=!!E.domain||!E.xaxis,F=!!E.domain||!E.yaxis,I=y.isActiveShape,O=y.dragmode,N=(C.layout||{}).shapes||[];if(!u(O)&&I!==void 0){var V=C._fullLayout._activeShapeIndex;if(V<N.length)switch(C._fullLayout.shapes[V].type){case"rect":O="drawrect";break;case"circle":O="drawcircle";break;case"line":O="drawline";break;case"path":var H=N[V].path||"";H[H.length-1]==="Z"?O="drawclosedpath":O="drawopenpath";break}}var j=A(O),Z=x(d,C,E,I),X={editable:!0,xref:z?"paper":k._id,yref:F?"paper":B._id,layer:S.layer,opacity:S.opacity,line:{color:S.line.color,width:S.line.width,dash:S.line.dash}};j||(X.fillcolor=S.fillcolor,X.fillrule=S.fillrule);var re;if(Z.length===1&&(re=Z[0]),re&&re.length===5&&O==="drawrect")X.type="rect",X.x0=re[0][1],X.y0=re[0][2],X.x1=re[2][1],X.y1=re[2][2];else if(re&&O==="drawline")X.type="line",X.x0=re[0][1],X.y0=re[0][2],X.x1=re[1][1],X.y1=re[1][2];else if(re&&O==="drawcircle"){X.type="circle";var ue=re[e][1],K=re[i][1],te=re[n][1],G=re[a][1],Y=re[e][2],ee=re[i][2],ne=re[n][2],J=re[a][2],q=E.xaxis&&(E.xaxis.type==="date"||E.xaxis.type==="log"),ae=E.yaxis&&(E.yaxis.type==="date"||E.yaxis.type==="log");q&&(ue=m(E.xaxis,ue),K=m(E.xaxis,K),te=m(E.xaxis,te),G=m(E.xaxis,G)),ae&&(Y=m(E.yaxis,Y),ee=m(E.yaxis,ee),ne=m(E.yaxis,ne),J=m(E.yaxis,J));var le=(K+G)/2,ie=(Y+ne)/2,se=(G-K+te-ue)/2,xe=(J-ee+ne-Y)/2,oe=b({x0:le,y0:ie,x1:le+se*r,y1:ie+xe*f});q&&(oe.x0=s(E.xaxis,oe.x0),oe.x1=s(E.xaxis,oe.x1)),ae&&(oe.y0=s(E.yaxis,oe.y0),oe.y1=s(E.yaxis,oe.y1)),X.x0=oe.x0,X.y0=oe.y0,X.x1=oe.x1,X.y1=oe.y1}else X.type="path",k&&B&&c(Z,k,B),X.path=l(Z),re=null;p(C);for(var he=y.editHelpers,be=(he||{}).modifyItem,me=[],_e=0;_e<N.length;_e++){var Se=C._fullLayout.shapes[_e];if(me[_e]=Se._input,I!==void 0&&_e===C._fullLayout._activeShapeIndex){var De=X;switch(Se.type){case"line":case"rect":case"circle":be("x0",De.x0),be("x1",De.x1),be("y0",De.y0),be("y1",De.y1);break;case"path":be("path",De.path);break}}}return I===void 0?(me.push(X),me):he?he.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../selections/helpers":454,".././handle_outline":468,"./constants":464,"./helpers":466}],468:[function(t,P,R){function h(A){var T=A._fullLayout._zoomlayer;T&&T.selectAll(".outline-controllers").remove()}function u(A){var T=A._fullLayout._zoomlayer;T&&T.selectAll(".select-outline").remove(),A._fullLayout._outlining=!1}P.exports={clearOutlineControllers:h,clearOutline:u}},{}],469:[function(t,P,R){var h=t("./constants"),u=t("../../lib"),A=t("../../plots/cartesian/axes");R.rangeToShapePosition=function(e){return e.type==="log"?e.r2d:function(i){return i}},R.shapePositionToRange=function(e){return e.type==="log"?e.d2r:function(i){return i}},R.decodeDate=function(e){return function(i){return i.replace&&(i=i.replace("_"," ")),e(i)}},R.encodeDate=function(e){return function(i){return e(i).replace(" ","_")}},R.extractPathCoords=function(e,i,n){var a=[],r=e.match(h.segmentRE);return r.forEach(function(f){var o=i[f.charAt(0)].drawn;if(o!==void 0){var s=f.substr(1).match(h.paramRE);if(!(!s||s.length<o)){var m=s[o],g=n?m:u.cleanNumber(m);a.push(g)}}}),a},R.getDataToPixel=function(e,i,n,a){var r=e._fullLayout._size,f;if(i)if(a==="domain")f=function(s){return i._length*(n?1-s:s)+i._offset};else{var o=R.shapePositionToRange(i);f=function(s){return i._offset+i.r2p(o(s,!0))},i.type==="date"&&(f=R.decodeDate(f))}else n?f=function(s){return r.t+r.h*(1-s)}:f=function(s){return r.l+r.w*s};return f},R.getPixelToData=function(e,i,n,a){var r=e._fullLayout._size,f;if(i)if(a==="domain")f=function(s){var m=(s-i._offset)/i._length;return n?1-m:m};else{var o=R.rangeToShapePosition(i);f=function(s){return o(i.p2r(s-i._offset))}}else n?f=function(s){return 1-(s-r.t)/r.h}:f=function(s){return(s-r.l)/r.w};return f},R.roundPositionForSharpStrokeRendering=function(e,i){var n=Math.round(i%2)===1,a=Math.round(e);return n?a+.5:a},R.makeShapesOptionsAndPlotinfo=function(e,i){var n=e._fullLayout.shapes[i]||{},a=e._fullLayout._plots[n.xref+n.yref],r=!!a;return r?a._hadPlotinfo=!0:(a={},n.xref&&n.xref!=="paper"&&(a.xaxis=e._fullLayout[n.xref+"axis"]),n.yref&&n.yref!=="paper"&&(a.yaxis=e._fullLayout[n.yref+"axis"])),a.xsizemode=n.xsizemode,a.ysizemode=n.ysizemode,a.xanchor=n.xanchor,a.yanchor=n.yanchor,{options:n,plotinfo:a}},R.makeSelectionsOptionsAndPlotinfo=function(e,i){var n=e._fullLayout.selections[i]||{},a=e._fullLayout._plots[n.xref+n.yref],r=!!a;return r?a._hadPlotinfo=!0:(a={},n.xref&&(a.xaxis=e._fullLayout[n.xref+"axis"]),n.yref&&(a.yaxis=e._fullLayout[n.yref+"axis"])),{options:n,plotinfo:a}},R.getPathString=function(e,i){var n=i.type,a=A.getRefType(i.xref),r=A.getRefType(i.yref),f=A.getFromId(e,i.xref),o=A.getFromId(e,i.yref),s=e._fullLayout._size,m,g,p,v,x,l,b,c;if(f?a==="domain"?g=function(B){return f._offset+f._length*B}:(m=R.shapePositionToRange(f),g=function(B){return f._offset+f.r2p(m(B,!0))}):g=function(B){return s.l+s.w*B},o?r==="domain"?v=function(B){return o._offset+o._length*(1-B)}:(p=R.shapePositionToRange(o),v=function(B){return o._offset+o.r2p(p(B,!0))}):v=function(B){return s.t+s.h*(1-B)},n==="path")return f&&f.type==="date"&&(g=R.decodeDate(g)),o&&o.type==="date"&&(v=R.decodeDate(v)),T(i,g,v);if(i.xsizemode==="pixel"){var M=g(i.xanchor);x=M+i.x0,l=M+i.x1}else x=g(i.x0),l=g(i.x1);if(i.ysizemode==="pixel"){var _=v(i.yanchor);b=_-i.y0,c=_-i.y1}else b=v(i.y0),c=v(i.y1);if(n==="line")return"M"+x+","+b+"L"+l+","+c;if(n==="rect")return"M"+x+","+b+"H"+l+"V"+c+"H"+x+"Z";var y=(x+l)/2,w=(b+c)/2,d=Math.abs(y-x),C=Math.abs(w-b),S="A"+d+","+C,E=y+d+","+w,k=y+","+(w-C);return"M"+E+S+" 0 1,1 "+k+S+" 0 0,1 "+E+"Z"};function T(e,i,n){var a=e.path,r=e.xsizemode,f=e.ysizemode,o=e.xanchor,s=e.yanchor;return a.replace(h.segmentRE,function(m){var g=0,p=m.charAt(0),v=h.paramIsX[p],x=h.paramIsY[p],l=h.numParams[p],b=m.substr(1).replace(h.paramRE,function(c){return v[g]?r==="pixel"?c=i(o)+Number(c):c=i(c):x[g]&&(f==="pixel"?c=n(s)-Number(c):c=n(c)),g++,g>l&&(c="X"),c});return g>l&&(b=b.replace(/[\s,]*X.*/,""),u.log("Ignoring extra params in segment "+m)),p+b})}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459}],470:[function(t,P,R){var h=t("./draw");P.exports={moduleType:"component",name:"shapes",layoutAttributes:t("./attributes"),supplyLayoutDefaults:t("./defaults"),supplyDrawNewShapeDefaults:t("./draw_newshape/defaults"),includeBasePlot:t("../../plots/cartesian/include_components")("shapes"),calcAutorange:t("./calc_autorange"),draw:h.draw,drawOne:h.drawOne}},{"../../plots/cartesian/include_components":577,"./attributes":457,"./calc_autorange":458,"./defaults":460,"./draw":462,"./draw_newshape/defaults":465}],471:[function(t,P,R){var h=t("../../plots/font_attributes"),u=t("../../plots/pad_attributes"),A=t("../../lib/extend").extendDeepAll,T=t("../../plot_api/edit_types").overrideAll,e=t("../../plots/animation_attributes"),i=t("../../plot_api/plot_template").templatedArray,n=t("./constants"),a=i("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});P.exports=T(i("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:a,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:A(u({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:h({})},font:h({}),activebgcolor:{valType:"color",dflt:n.gripBgActiveColor},bgcolor:{valType:"color",dflt:n.railBgColor},bordercolor:{valType:"color",dflt:n.railBorderColor},borderwidth:{valType:"number",min:0,dflt:n.railBorderWidth},ticklen:{valType:"number",min:0,dflt:n.tickLength},tickcolor:{valType:"color",dflt:n.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:n.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/animation_attributes":560,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"./constants":472}],472:[function(t,P,R){P.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],473:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/array_container_defaults"),A=t("./attributes"),T=t("./constants"),e=T.name,i=A.steps;P.exports=function(f,o){u(f,o,{name:e,handleItemDefaults:n})};function n(r,f,o){function s(c,M){return h.coerce(r,f,A,c,M)}for(var m=u(r,f,{name:"steps",handleItemDefaults:a}),g=0,p=0;p<m.length;p++)m[p].visible&&g++;var v;if(g<2?v=f.visible=!1:v=s("visible"),!!v){f._stepCount=g;var x=f._visibleSteps=h.filterVisible(m),l=s("active");(m[l]||{}).visible||(f.active=x[0]._index),s("x"),s("y"),h.noneOrAll(r,f,["x","y"]),s("xanchor"),s("yanchor"),s("len"),s("lenmode"),s("pad.t"),s("pad.r"),s("pad.b"),s("pad.l"),h.coerceFont(s,"font",o.font);var b=s("currentvalue.visible");b&&(s("currentvalue.xanchor"),s("currentvalue.prefix"),s("currentvalue.suffix"),s("currentvalue.offset"),h.coerceFont(s,"currentvalue.font",f.font)),s("transition.duration"),s("transition.easing"),s("bgcolor"),s("activebgcolor"),s("bordercolor"),s("borderwidth"),s("ticklen"),s("tickwidth"),s("tickcolor"),s("minorticklen")}}function a(r,f){function o(g,p){return h.coerce(r,f,i,g,p)}var s;if(r.method!=="skip"&&!Array.isArray(r.args)?s=f.visible=!1:s=o("visible"),s){o("method"),o("args");var m=o("label","step-"+f._index);o("value",m),o("execute")}}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":471,"./constants":472}],474:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../plots/plots"),A=t("../color"),T=t("../drawing"),e=t("../../lib"),i=e.strTranslate,n=t("../../lib/svg_text_utils"),a=t("../../plot_api/plot_template").arrayEditor,r=t("./constants"),f=t("../../constants/alignment"),o=f.LINE_SPACING,s=f.FROM_TL,m=f.FROM_BR;P.exports=function(O){var N=O._fullLayout,V=p(N,O),H=N._infolayer.selectAll("g."+r.containerClassName).data(V.length>0?[0]:[]);H.enter().append("g").classed(r.containerClassName,!0).style("cursor","ew-resize");function j(ue){ue._commandObserver&&(ue._commandObserver.remove(),delete ue._commandObserver),u.autoMargin(O,g(ue))}if(H.exit().each(function(){h.select(this).selectAll("g."+r.groupClassName).each(j)}).remove(),V.length!==0){var Z=H.selectAll("g."+r.groupClassName).data(V,v);Z.enter().append("g").classed(r.groupClassName,!0),Z.exit().each(j).remove();for(var X=0;X<V.length;X++){var re=V[X];x(O,re)}Z.each(function(ue){var K=h.select(this);S(ue),u.manageCommandObserver(O,ue,ue._visibleSteps,function(te){var G=K.data()[0];G.active!==te.index&&(G._dragging||w(O,K,G,te.index,!1,!0))}),l(O,h.select(this),ue)})}};function g(I){return r.autoMarginIdRoot+I._index}function p(I,O){for(var N=I[r.name],V=[],H=0;H<N.length;H++){var j=N[H];!j.visible||(j._gd=O,V.push(j))}return V}function v(I){return I._index}function x(I,O){var N=T.tester.selectAll("g."+r.labelGroupClass).data(O._visibleSteps);N.enter().append("g").classed(r.labelGroupClass,!0);var V=0,H=0;N.each(function(ee){var ne=h.select(this),J=M(ne,{step:ee},O),q=J.node();if(q){var ae=T.bBox(q);H=Math.max(H,ae.height),V=Math.max(V,ae.width)}}),N.remove();var j=O._dims={};j.inputAreaWidth=Math.max(r.railWidth,r.gripHeight);var Z=I._fullLayout._size;j.lx=Z.l+Z.w*O.x,j.ly=Z.t+Z.h*(1-O.y),O.lenmode==="fraction"?j.outerLength=Math.round(Z.w*O.len):j.outerLength=O.len,j.inputAreaStart=0,j.inputAreaLength=Math.round(j.outerLength-O.pad.l-O.pad.r);var X=j.inputAreaLength-2*r.stepInset,re=X/(O._stepCount-1),ue=V+r.labelPadding;if(j.labelStride=Math.max(1,Math.ceil(ue/re)),j.labelHeight=H,j.currentValueMaxWidth=0,j.currentValueHeight=0,j.currentValueTotalHeight=0,j.currentValueMaxLines=1,O.currentvalue.visible){var K=T.tester.append("g");N.each(function(ee){var ne=b(K,O,ee.label),J=ne.node()&&T.bBox(ne.node())||{width:0,height:0},q=n.lineCount(ne);j.currentValueMaxWidth=Math.max(j.currentValueMaxWidth,Math.ceil(J.width)),j.currentValueHeight=Math.max(j.currentValueHeight,Math.ceil(J.height)),j.currentValueMaxLines=Math.max(j.currentValueMaxLines,q)}),j.currentValueTotalHeight=j.currentValueHeight+O.currentvalue.offset,K.remove()}j.height=j.currentValueTotalHeight+r.tickOffset+O.ticklen+r.labelOffset+j.labelHeight+O.pad.t+O.pad.b;var te="left";e.isRightAnchor(O)&&(j.lx-=j.outerLength,te="right"),e.isCenterAnchor(O)&&(j.lx-=j.outerLength/2,te="center");var G="top";e.isBottomAnchor(O)&&(j.ly-=j.height,G="bottom"),e.isMiddleAnchor(O)&&(j.ly-=j.height/2,G="middle"),j.outerLength=Math.ceil(j.outerLength),j.height=Math.ceil(j.height),j.lx=Math.round(j.lx),j.ly=Math.round(j.ly);var Y={y:O.y,b:j.height*m[G],t:j.height*s[G]};O.lenmode==="fraction"?(Y.l=0,Y.xl=O.x-O.len*s[te],Y.r=0,Y.xr=O.x+O.len*m[te]):(Y.x=O.x,Y.l=j.outerLength*s[te],Y.r=j.outerLength*m[te]),u.autoMargin(I,g(O),Y)}function l(I,O,N){(N.steps[N.active]||{}).visible||(N.active=N._visibleSteps[0]._index),O.call(b,N).call(F,N).call(_,N).call(C,N).call(z,I,N).call(c,I,N);var V=N._dims;T.setTranslate(O,V.lx+N.pad.l,V.ly+N.pad.t),O.call(E,N,!1),O.call(b,N)}function b(I,O,N){if(!!O.currentvalue.visible){var V=O._dims,H,j;switch(O.currentvalue.xanchor){case"right":H=V.inputAreaLength-r.currentValueInset-V.currentValueMaxWidth,j="left";break;case"center":H=V.inputAreaLength*.5,j="middle";break;default:H=r.currentValueInset,j="left"}var Z=e.ensureSingle(I,"text",r.labelClass,function(G){G.attr({"text-anchor":j,"data-notex":1})}),X=O.currentvalue.prefix?O.currentvalue.prefix:"";if(typeof N=="string")X+=N;else{var re=O.steps[O.active].label,ue=O._gd._fullLayout._meta;ue&&(re=e.templateString(re,ue)),X+=re}O.currentvalue.suffix&&(X+=O.currentvalue.suffix),Z.call(T.font,O.currentvalue.font).text(X).call(n.convertToTspans,O._gd);var K=n.lineCount(Z),te=(V.currentValueMaxLines+1-K)*O.currentvalue.font.size*o;return n.positionText(Z,H,te),Z}}function c(I,O,N){var V=e.ensureSingle(I,"rect",r.gripRectClass,function(H){H.call(d,O,I,N).style("pointer-events","all")});V.attr({width:r.gripWidth,height:r.gripHeight,rx:r.gripRadius,ry:r.gripRadius}).call(A.stroke,N.bordercolor).call(A.fill,N.bgcolor).style("stroke-width",N.borderwidth+"px")}function M(I,O,N){var V=e.ensureSingle(I,"text",r.labelClass,function(Z){Z.attr({"text-anchor":"middle","data-notex":1})}),H=O.step.label,j=N._gd._fullLayout._meta;return j&&(H=e.templateString(H,j)),V.call(T.font,N.font).text(H).call(n.convertToTspans,N._gd),V}function _(I,O){var N=e.ensureSingle(I,"g",r.labelsClass),V=O._dims,H=N.selectAll("g."+r.labelGroupClass).data(V.labelSteps);H.enter().append("g").classed(r.labelGroupClass,!0),H.exit().remove(),H.each(function(j){var Z=h.select(this);Z.call(M,j,O),T.setTranslate(Z,k(O,j.fraction),r.tickOffset+O.ticklen+O.font.size*o+r.labelOffset+V.currentValueTotalHeight)})}function y(I,O,N,V,H){var j=Math.round(V*(N._stepCount-1)),Z=N._visibleSteps[j]._index;Z!==N.active&&w(I,O,N,Z,!0,H)}function w(I,O,N,V,H,j){var Z=N.active;N.active=V,a(I.layout,r.name,N).applyUpdate("active",V);var X=N.steps[N.active];O.call(E,N,j),O.call(b,N),I.emit("plotly_sliderchange",{slider:N,step:N.steps[N.active],interaction:H,previousActive:Z}),X&&X.method&&H&&(O._nextMethod?(O._nextMethod.step=X,O._nextMethod.doCallback=H,O._nextMethod.doTransition=j):(O._nextMethod={step:X,doCallback:H,doTransition:j},O._nextMethodRaf=window.requestAnimationFrame(function(){var re=O._nextMethod.step;!re.method||(re.execute&&u.executeAPICommand(I,re.method,re.args),O._nextMethod=null,O._nextMethodRaf=null)})))}function d(I,O,N){var V=N.node(),H=h.select(O);function j(){return N.data()[0]}function Z(){var X=j();O.emit("plotly_sliderstart",{slider:X});var re=N.select("."+r.gripRectClass);h.event.stopPropagation(),h.event.preventDefault(),re.call(A.fill,X.activebgcolor);var ue=B(X,h.mouse(V)[0]);y(O,N,X,ue,!0),X._dragging=!0;function K(){var G=j(),Y=B(G,h.mouse(V)[0]);y(O,N,G,Y,!1)}H.on("mousemove",K),H.on("touchmove",K);function te(){var G=j();G._dragging=!1,re.call(A.fill,G.bgcolor),H.on("mouseup",null),H.on("mousemove",null),H.on("touchend",null),H.on("touchmove",null),O.emit("plotly_sliderend",{slider:G,step:G.steps[G.active]})}H.on("mouseup",te),H.on("touchend",te)}I.on("mousedown",Z),I.on("touchstart",Z)}function C(I,O){var N=I.selectAll("rect."+r.tickRectClass).data(O._visibleSteps),V=O._dims;N.enter().append("rect").classed(r.tickRectClass,!0),N.exit().remove(),N.attr({width:O.tickwidth+"px","shape-rendering":"crispEdges"}),N.each(function(H,j){var Z=j%V.labelStride===0,X=h.select(this);X.attr({height:Z?O.ticklen:O.minorticklen}).call(A.fill,O.tickcolor),T.setTranslate(X,k(O,j/(O._stepCount-1))-.5*O.tickwidth,(Z?r.tickOffset:r.minorTickOffset)+V.currentValueTotalHeight)})}function S(I){var O=I._dims;O.labelSteps=[];for(var N=I._stepCount,V=0;V<N;V+=O.labelStride)O.labelSteps.push({fraction:V/(N-1),step:I._visibleSteps[V]})}function E(I,O,N){for(var V=I.select("rect."+r.gripRectClass),H=0,j=0;j<O._stepCount;j++)if(O._visibleSteps[j]._index===O.active){H=j;break}var Z=k(O,H/(O._stepCount-1));if(!O._invokingCommand){var X=V;N&&O.transition.duration>0&&(X=X.transition().duration(O.transition.duration).ease(O.transition.easing)),X.attr("transform",i(Z-r.gripWidth*.5,O._dims.currentValueTotalHeight))}}function k(I,O){var N=I._dims;return N.inputAreaStart+r.stepInset+(N.inputAreaLength-2*r.stepInset)*Math.min(1,Math.max(0,O))}function B(I,O){var N=I._dims;return Math.min(1,Math.max(0,(O-r.stepInset-N.inputAreaStart)/(N.inputAreaLength-2*r.stepInset-2*N.inputAreaStart)))}function z(I,O,N){var V=N._dims,H=e.ensureSingle(I,"rect",r.railTouchRectClass,function(j){j.call(d,O,I,N).style("pointer-events","all")});H.attr({width:V.inputAreaLength,height:Math.max(V.inputAreaWidth,r.tickOffset+N.ticklen+V.labelHeight)}).call(A.fill,N.bgcolor).attr("opacity",0),T.setTranslate(H,0,V.currentValueTotalHeight)}function F(I,O){var N=O._dims,V=N.inputAreaLength-r.railInset*2,H=e.ensureSingle(I,"rect",r.railRectClass);H.attr({width:V,height:r.railWidth,rx:r.railRadius,ry:r.railRadius,"shape-rendering":"crispEdges"}).call(A.stroke,O.bordercolor).call(A.fill,O.bgcolor).style("stroke-width",O.borderwidth+"px"),T.setTranslate(H,r.railInset,(N.inputAreaWidth-r.railWidth)*.5+N.currentValueTotalHeight)}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":472,"@plotly/d3":58}],475:[function(t,P,R){var h=t("./constants");P.exports={moduleType:"component",name:h.name,layoutAttributes:t("./attributes"),supplyLayoutDefaults:t("./defaults"),draw:t("./draw")}},{"./attributes":471,"./constants":472,"./defaults":473,"./draw":474}],476:[function(t,P,R){var h=t("@plotly/d3"),u=t("fast-isnumeric"),A=t("../../plots/plots"),T=t("../../registry"),e=t("../../lib"),i=e.strTranslate,n=t("../drawing"),a=t("../color"),r=t("../../lib/svg_text_utils"),f=t("../../constants/interactions"),o=t("../../constants/alignment").OPPOSITE_SIDE,s=/ [XY][0-9]* /;function m(g,p,v){var x=v.propContainer,l=v.propName,b=v.placeholder,c=v.traceIndex,M=v.avoid||{},_=v.attributes,y=v.transform,w=v.containerGroup,d=g._fullLayout,C=1,S=!1,E=x.title,k=(E&&E.text?E.text:"").trim(),B=E&&E.font?E.font:{},z=B.family,F=B.size,I=B.color,O;l==="title.text"?O="titleText":l.indexOf("axis")!==-1?O="axisTitleText":l.indexOf("colorbar"!==-1)&&(O="colorbarTitleText");var N=g._context.edits[O];k===""?C=0:k.replace(s," % ")===b.replace(s," % ")&&(C=.2,S=!0,N||(k="")),v._meta?k=e.templateString(k,v._meta):d._meta&&(k=e.templateString(k,d._meta));var V=k||N,H;w||(w=e.ensureSingle(d._infolayer,"g","g-"+p),H=d._hColorbarMoveTitle);var j=w.selectAll("text").data(V?[0]:[]);if(j.enter().append("text"),j.text(k).attr("class",p),j.exit().remove(),!V)return w;function Z(K){e.syncOrAsync([X,re],K)}function X(K){var te;return!y&&H&&(y={}),y?(te="",y.rotate&&(te+="rotate("+[y.rotate,_.x,_.y]+")"),(y.offset||H)&&(te+=i(0,(y.offset||0)-(H||0)))):te=null,K.attr("transform",te),K.style({"font-family":z,"font-size":h.round(F,2)+"px",fill:a.rgb(I),opacity:C*a.opacity(I),"font-weight":A.fontWeight}).attr(_).call(r.convertToTspans,g),A.previousPromises(g)}function re(K){var te=h.select(K.node().parentNode);if(M&&M.selection&&M.side&&k){te.attr("transform",null);var G=o[M.side],Y=M.side==="left"||M.side==="top"?-1:1,ee=u(M.pad)?M.pad:2,ne=n.bBox(te.node()),J={left:0,top:0,right:d.width,bottom:d.height},q=M.maxShift||Y*(J[M.side]-ne[M.side]),ae=0;if(q<0)ae=q;else{var le=M.offsetLeft||0,ie=M.offsetTop||0;ne.left-=le,ne.right-=le,ne.top-=ie,ne.bottom-=ie,M.selection.each(function(){var xe=n.bBox(this);e.bBoxIntersect(ne,xe,ee)&&(ae=Math.max(ae,Y*(xe[M.side]-ne[G])+ee))}),ae=Math.min(q,ae)}if(ae>0||q<0){var se={left:[-ae,0],right:[ae,0],top:[0,-ae],bottom:[0,ae]}[M.side];te.attr("transform",i(se[0],se[1]))}}}j.call(Z);function ue(){C=0,S=!0,j.text(b).on("mouseover.opacity",function(){h.select(this).transition().duration(f.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){h.select(this).transition().duration(f.HIDE_PLACEHOLDER).style("opacity",0)})}return N&&(k?j.on(".opacity",null):ue(),j.call(r.makeEditable,{gd:g}).on("edit",function(K){c!==void 0?T.call("_guiRestyle",g,l,K,c):T.call("_guiRelayout",g,l,K)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(Z)}).on("input",function(K){this.text(K||" ").call(r.positionText,_.x,_.y)})),j.classed("js-placeholder",S),w}P.exports={draw:m}},{"../../constants/alignment":483,"../../constants/interactions":490,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],477:[function(t,P,R){var h=t("../../plots/font_attributes"),u=t("../color/attributes"),A=t("../../lib/extend").extendFlat,T=t("../../plot_api/edit_types").overrideAll,e=t("../../plots/pad_attributes"),i=t("../../plot_api/plot_template").templatedArray,n=i("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});P.exports=T(i("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:n,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:A(e({editType:"arraydraw"}),{}),font:h({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:u.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"../color/attributes":366}],478:[function(t,P,R){P.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],479:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/array_container_defaults"),A=t("./attributes"),T=t("./constants"),e=T.name,i=A.buttons;P.exports=function(f,o){var s={name:e,handleItemDefaults:n};u(f,o,s)};function n(r,f,o){function s(p,v){return h.coerce(r,f,A,p,v)}var m=u(r,f,{name:"buttons",handleItemDefaults:a}),g=s("visible",m.length>0);!g||(s("active"),s("direction"),s("type"),s("showactive"),s("x"),s("y"),h.noneOrAll(r,f,["x","y"]),s("xanchor"),s("yanchor"),s("pad.t"),s("pad.r"),s("pad.b"),s("pad.l"),h.coerceFont(s,"font",o.font),s("bgcolor",o.paper_bgcolor),s("bordercolor"),s("borderwidth"))}function a(r,f){function o(m,g){return h.coerce(r,f,i,m,g)}var s=o("visible",r.method==="skip"||Array.isArray(r.args));s&&(o("method"),o("args"),o("args2"),o("label"),o("execute"))}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":477,"./constants":478}],480:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../plots/plots"),A=t("../color"),T=t("../drawing"),e=t("../../lib"),i=t("../../lib/svg_text_utils"),n=t("../../plot_api/plot_template").arrayEditor,a=t("../../constants/alignment").LINE_SPACING,r=t("./constants"),f=t("./scrollbox");P.exports=function(B){var z=B._fullLayout,F=e.filterVisible(z[r.name]);function I(re){u.autoMargin(B,C(re))}var O=z._menulayer.selectAll("g."+r.containerClassName).data(F.length>0?[0]:[]);if(O.enter().append("g").classed(r.containerClassName,!0).style("cursor","pointer"),O.exit().each(function(){h.select(this).selectAll("g."+r.headerGroupClassName).each(I)}).remove(),F.length!==0){var N=O.selectAll("g."+r.headerGroupClassName).data(F,o);N.enter().append("g").classed(r.headerGroupClassName,!0);for(var V=e.ensureSingle(O,"g",r.dropdownButtonGroupClassName,function(re){re.style("pointer-events","all")}),H=0;H<F.length;H++){var j=F[H];d(B,j)}var Z="updatemenus"+z._uid,X=new f(B,V,Z);N.enter().size()&&(V.node().parentNode.appendChild(V.node()),V.call(E)),N.exit().each(function(re){V.call(E),I(re)}).remove(),N.each(function(re){var ue=h.select(this),K=re.type==="dropdown"?V:null;u.manageCommandObserver(B,re,re.buttons,function(te){g(B,re,re.buttons[te.index],ue,K,X,te.index,!0)}),re.type==="dropdown"?(p(B,ue,V,X,re),m(V,re)&&v(B,ue,V,X,re)):v(B,ue,null,null,re)})}};function o(k){return k._index}function s(k){return+k.attr(r.menuIndexAttrName)==-1}function m(k,B){return+k.attr(r.menuIndexAttrName)===B._index}function g(k,B,z,F,I,O,N,V){B.active=N,n(k.layout,r.name,B).applyUpdate("active",N),B.type==="buttons"?v(k,F,null,null,B):B.type==="dropdown"&&(I.attr(r.menuIndexAttrName,"-1"),p(k,F,I,O,B),V||v(k,F,I,O,B))}function p(k,B,z,F,I){var O=e.ensureSingle(B,"g",r.headerClassName,function(re){re.style("pointer-events","all")}),N=I._dims,V=I.active,H=I.buttons[V]||r.blankHeaderOpts,j={y:I.pad.t,yPad:0,x:I.pad.l,xPad:0,index:0},Z={width:N.headerWidth,height:N.headerHeight};O.call(b,I,H,k).call(S,I,j,Z);var X=e.ensureSingle(B,"text",r.headerArrowClassName,function(re){re.attr("text-anchor","end").call(T.font,I.font).text(r.arrowSymbol[I.direction])});X.attr({x:N.headerWidth-r.arrowOffsetX+I.pad.l,y:N.headerHeight/2+r.textOffsetY+I.pad.t}),O.on("click",function(){z.call(E,String(m(z,I)?-1:I._index)),v(k,B,z,F,I)}),O.on("mouseover",function(){O.call(y)}),O.on("mouseout",function(){O.call(w,I)}),T.setTranslate(B,N.lx,N.ly)}function v(k,B,z,F,I){z||(z=B,z.attr("pointer-events","all"));var O=!s(z)||I.type==="buttons"?I.buttons:[],N=I.type==="dropdown"?r.dropdownButtonClassName:r.buttonClassName,V=z.selectAll("g."+N).data(e.filterVisible(O)),H=V.enter().append("g").classed(N,!0),j=V.exit();I.type==="dropdown"?(H.attr("opacity","0").transition().attr("opacity","1"),j.transition().attr("opacity","0").remove()):j.remove();var Z=0,X=0,re=I._dims,ue=["up","down"].indexOf(I.direction)!==-1;I.type==="dropdown"&&(ue?X=re.headerHeight+r.gapButtonHeader:Z=re.headerWidth+r.gapButtonHeader),I.type==="dropdown"&&I.direction==="up"&&(X=-r.gapButtonHeader+r.gapButton-re.openHeight),I.type==="dropdown"&&I.direction==="left"&&(Z=-r.gapButtonHeader+r.gapButton-re.openWidth);var K={x:re.lx+Z+I.pad.l,y:re.ly+X+I.pad.t,yPad:r.gapButton,xPad:r.gapButton,index:0},te={l:K.x+I.borderwidth,t:K.y+I.borderwidth};V.each(function(G,Y){var ee=h.select(this);ee.call(b,I,G,k).call(S,I,K),ee.on("click",function(){h.event.defaultPrevented||(G.execute&&(G.args2&&I.active===Y?(g(k,I,G,B,z,F,-1),u.executeAPICommand(k,G.method,G.args2)):(g(k,I,G,B,z,F,Y),u.executeAPICommand(k,G.method,G.args))),k.emit("plotly_buttonclicked",{menu:I,button:G,active:I.active}))}),ee.on("mouseover",function(){ee.call(y)}),ee.on("mouseout",function(){ee.call(w,I),V.call(_,I)})}),V.call(_,I),ue?(te.w=Math.max(re.openWidth,re.headerWidth),te.h=K.y-te.t):(te.w=K.x-te.l,te.h=Math.max(re.openHeight,re.headerHeight)),te.direction=I.direction,F&&(V.size()?x(k,B,z,F,I,te):l(F))}function x(k,B,z,F,I,O){var N=I.direction,V=N==="up"||N==="down",H=I._dims,j=I.active,Z,X,re;if(V)for(X=0,re=0;re<j;re++)X+=H.heights[re]+r.gapButton;else for(Z=0,re=0;re<j;re++)Z+=H.widths[re]+r.gapButton;F.enable(O,Z,X),F.hbar&&F.hbar.attr("opacity","0").transition().attr("opacity","1"),F.vbar&&F.vbar.attr("opacity","0").transition().attr("opacity","1")}function l(k){var B=!!k.hbar,z=!!k.vbar;B&&k.hbar.transition().attr("opacity","0").each("end",function(){B=!1,z||k.disable()}),z&&k.vbar.transition().attr("opacity","0").each("end",function(){z=!1,B||k.disable()})}function b(k,B,z,F){k.call(c,B).call(M,B,z,F)}function c(k,B){var z=e.ensureSingle(k,"rect",r.itemRectClassName,function(F){F.attr({rx:r.rx,ry:r.ry,"shape-rendering":"crispEdges"})});z.call(A.stroke,B.bordercolor).call(A.fill,B.bgcolor).style("stroke-width",B.borderwidth+"px")}function M(k,B,z,F){var I=e.ensureSingle(k,"text",r.itemTextClassName,function(V){V.attr({"text-anchor":"start","data-notex":1})}),O=z.label,N=F._fullLayout._meta;N&&(O=e.templateString(O,N)),I.call(T.font,B.font).text(O).call(i.convertToTspans,F)}function _(k,B){var z=B.active;k.each(function(F,I){var O=h.select(this);I===z&&B.showactive&&O.select("rect."+r.itemRectClassName).call(A.fill,r.activeColor)})}function y(k){k.select("rect."+r.itemRectClassName).call(A.fill,r.hoverColor)}function w(k,B){k.select("rect."+r.itemRectClassName).call(A.fill,B.bgcolor)}function d(k,B){var z=B._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},F=T.tester.selectAll("g."+r.dropdownButtonClassName).data(e.filterVisible(B.buttons));F.enter().append("g").classed(r.dropdownButtonClassName,!0);var I=["up","down"].indexOf(B.direction)!==-1;F.each(function(Z,X){var re=h.select(this);re.call(b,B,Z,k);var ue=re.select("."+r.itemTextClassName),K=ue.node()&&T.bBox(ue.node()).width,te=Math.max(K+r.textPadX,r.minWidth),G=B.font.size*a,Y=i.lineCount(ue),ee=Math.max(G*Y,r.minHeight)+r.textOffsetY;ee=Math.ceil(ee),te=Math.ceil(te),z.widths[X]=te,z.heights[X]=ee,z.height1=Math.max(z.height1,ee),z.width1=Math.max(z.width1,te),I?(z.totalWidth=Math.max(z.totalWidth,te),z.openWidth=z.totalWidth,z.totalHeight+=ee+r.gapButton,z.openHeight+=ee+r.gapButton):(z.totalWidth+=te+r.gapButton,z.openWidth+=te+r.gapButton,z.totalHeight=Math.max(z.totalHeight,ee),z.openHeight=z.totalHeight)}),I?z.totalHeight-=r.gapButton:z.totalWidth-=r.gapButton,z.headerWidth=z.width1+r.arrowPadX,z.headerHeight=z.height1,B.type==="dropdown"&&(I?(z.width1+=r.arrowPadX,z.totalHeight=z.height1):z.totalWidth=z.width1,z.totalWidth+=r.arrowPadX),F.remove();var O=z.totalWidth+B.pad.l+B.pad.r,N=z.totalHeight+B.pad.t+B.pad.b,V=k._fullLayout._size;z.lx=V.l+V.w*B.x,z.ly=V.t+V.h*(1-B.y);var H="left";e.isRightAnchor(B)&&(z.lx-=O,H="right"),e.isCenterAnchor(B)&&(z.lx-=O/2,H="center");var j="top";e.isBottomAnchor(B)&&(z.ly-=N,j="bottom"),e.isMiddleAnchor(B)&&(z.ly-=N/2,j="middle"),z.totalWidth=Math.ceil(z.totalWidth),z.totalHeight=Math.ceil(z.totalHeight),z.lx=Math.round(z.lx),z.ly=Math.round(z.ly),u.autoMargin(k,C(B),{x:B.x,y:B.y,l:O*({right:1,center:.5}[H]||0),r:O*({left:1,center:.5}[H]||0),b:N*({top:1,middle:.5}[j]||0),t:N*({bottom:1,middle:.5}[j]||0)})}function C(k){return r.autoMarginIdRoot+k._index}function S(k,B,z,F){F=F||{};var I=k.select("."+r.itemRectClassName),O=k.select("."+r.itemTextClassName),N=B.borderwidth,V=z.index,H=B._dims;T.setTranslate(k,N+z.x,N+z.y);var j=["up","down"].indexOf(B.direction)!==-1,Z=F.height||(j?H.heights[V]:H.height1);I.attr({x:0,y:0,width:F.width||(j?H.width1:H.widths[V]),height:Z});var X=B.font.size*a,re=i.lineCount(O),ue=(re-1)*X/2;i.positionText(O,r.textOffsetX,Z/2-ue+r.textOffsetY),j?z.y+=H.heights[V]+z.yPad:z.x+=H.widths[V]+z.xPad,z.index++}function E(k,B){k.attr(r.menuIndexAttrName,B||"-1").selectAll("g."+r.dropdownButtonClassName).remove()}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":478,"./scrollbox":482,"@plotly/d3":58}],481:[function(t,P,R){arguments[4][475][0].apply(R,arguments)},{"./attributes":477,"./constants":478,"./defaults":479,"./draw":480,dup:475}],482:[function(t,P,R){P.exports=e;var h=t("@plotly/d3"),u=t("../color"),A=t("../drawing"),T=t("../../lib");function e(i,n,a){this.gd=i,this.container=n,this.id=a,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(n,a,r){var f=this.gd._fullLayout,o=f.width,s=f.height;this.position=n;var m=this.position.l,g=this.position.w,p=this.position.t,v=this.position.h,x=this.position.direction,l=x==="down",b=x==="left",c=x==="right",M=x==="up",_=g,y=v,w,d,C,S;!l&&!b&&!c&&!M&&(this.position.direction="down",l=!0);var E=l||M;E?(w=m,d=w+_,l?(C=p,S=Math.min(C+y,s),y=S-C):(S=p+y,C=Math.max(S-y,0),y=S-C)):(C=p,S=C+y,b?(d=m+_,w=Math.max(d-_,0),_=d-w):(w=m,d=Math.min(w+_,o),_=d-w)),this._box={l:w,t:C,w:_,h:y};var k=g>_,B=e.barLength+2*e.barPad,z=e.barWidth+2*e.barPad,F=m,I=p+v;I+z>s&&(I=s-z);var O=this.container.selectAll("rect.scrollbar-horizontal").data(k?[0]:[]);O.exit().on(".drag",null).remove(),O.enter().append("rect").classed("scrollbar-horizontal",!0).call(u.fill,e.barColor),k?(this.hbar=O.attr({rx:e.barRadius,ry:e.barRadius,x:F,y:I,width:B,height:z}),this._hbarXMin=F+B/2,this._hbarTranslateMax=_-B):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var N=v>y,V=e.barWidth+2*e.barPad,H=e.barLength+2*e.barPad,j=m+g,Z=p;j+V>o&&(j=o-V);var X=this.container.selectAll("rect.scrollbar-vertical").data(N?[0]:[]);X.exit().on(".drag",null).remove(),X.enter().append("rect").classed("scrollbar-vertical",!0).call(u.fill,e.barColor),N?(this.vbar=X.attr({rx:e.barRadius,ry:e.barRadius,x:j,y:Z,width:V,height:H}),this._vbarYMin=Z+H/2,this._vbarTranslateMax=y-H):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var re=this.id,ue=w-.5,K=N?d+V+.5:d+.5,te=C-.5,G=k?S+z+.5:S+.5,Y=f._topdefs.selectAll("#"+re).data(k||N?[0]:[]);if(Y.exit().remove(),Y.enter().append("clipPath").attr("id",re).append("rect"),k||N?(this._clipRect=Y.select("rect").attr({x:Math.floor(ue),y:Math.floor(te),width:Math.ceil(K)-Math.floor(ue),height:Math.ceil(G)-Math.floor(te)}),this.container.call(A.setClipUrl,re,this.gd),this.bg.attr({x:m,y:p,width:g,height:v})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(A.setClipUrl,null),delete this._clipRect),k||N){var ee=h.behavior.drag().on("dragstart",function(){h.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(ee);var ne=h.behavior.drag().on("dragstart",function(){h.event.sourceEvent.preventDefault(),h.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));k&&this.hbar.on(".drag",null).call(ne),N&&this.vbar.on(".drag",null).call(ne)}this.setTranslate(a,r)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(A.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var n=this.translateX,a=this.translateY;this.hbar&&(n-=h.event.dx),this.vbar&&(a-=h.event.dy),this.setTranslate(n,a)},e.prototype._onBoxWheel=function(){var n=this.translateX,a=this.translateY;this.hbar&&(n+=h.event.deltaY),this.vbar&&(a+=h.event.deltaY),this.setTranslate(n,a)},e.prototype._onBarDrag=function(){var n=this.translateX,a=this.translateY;if(this.hbar){var r=n+this._hbarXMin,f=r+this._hbarTranslateMax,o=T.constrain(h.event.x,r,f),s=(o-r)/(f-r),m=this.position.w-this._box.w;n=s*m}if(this.vbar){var g=a+this._vbarYMin,p=g+this._vbarTranslateMax,v=T.constrain(h.event.y,g,p),x=(v-g)/(p-g),l=this.position.h-this._box.h;a=x*l}this.setTranslate(n,a)},e.prototype.setTranslate=function(n,a){var r=this.position.w-this._box.w,f=this.position.h-this._box.h;if(n=T.constrain(n||0,0,r),a=T.constrain(a||0,0,f),this.translateX=n,this.translateY=a,this.container.call(A.setTranslate,this._box.l-this.position.l-n,this._box.t-this.position.t-a),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+n-.5),y:Math.floor(this.position.t+a-.5)}),this.hbar){var o=n/r;this.hbar.call(A.setTranslate,n+o*this._hbarTranslateMax,a)}if(this.vbar){var s=a/f;this.vbar.call(A.setTranslate,n,a+s*this._vbarTranslateMax)}}},{"../../lib":515,"../color":367,"../drawing":389,"@plotly/d3":58}],483:[function(t,P,R){P.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],484:[function(t,P,R){P.exports={axisRefDescription:function(h,u,A){return["If set to a",h,"axis id (e.g. *"+h+"* or","*"+h+"2*), the `"+h+"` position refers to a",h,"coordinate. If set to *paper*, the `"+h+"`","position refers to the distance from the",u,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",u,"("+A+"). If set to a",h,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",u,"of the domain of that axis: e.g.,","*"+h+"2 domain* refers to the domain of the second",h," axis and a",h,"position of 0.5 refers to the","point between the",u,"and the",A,"of the domain of the","second",h,"axis."].join(" ")}}},{}],485:[function(t,P,R){P.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],486:[function(t,P,R){P.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],487:[function(t,P,R){P.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],488:[function(t,P,R){P.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],489:[function(t,P,R){P.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],490:[function(t,P,R){P.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],491:[function(t,P,R){P.exports={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE*1e-4,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:1-1e-6,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],492:[function(t,P,R){R.xmlns="http://www.w3.org/2000/xmlns/",R.svg="http://www.w3.org/2000/svg",R.xlink="http://www.w3.org/1999/xlink",R.svgAttrs={xmlns:R.svg,"xmlns:xlink":R.xlink}},{}],493:[function(t,P,R){R.version=t("./version").version,t("native-promise-only"),t("../build/plotcss");for(var h=t("./registry"),u=R.register=h.register,A=t("./plot_api"),T=Object.keys(A),e=0;e<T.length;e++){var i=T[e];i.charAt(0)!=="_"&&(R[i]=A[i]),u({moduleType:"apiMethod",name:i,fn:A[i]})}u(t("./traces/scatter")),u([t("./components/legend"),t("./components/fx"),t("./components/annotations"),t("./components/annotations3d"),t("./components/selections"),t("./components/shapes"),t("./components/images"),t("./components/updatemenus"),t("./components/sliders"),t("./components/rangeslider"),t("./components/rangeselector"),t("./components/grid"),t("./components/errorbars"),t("./components/colorscale"),t("./components/colorbar"),t("./components/modebar")]),u([t("./locale-en"),t("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(u(window.PlotlyLocales),delete window.PlotlyLocales),R.Icons=t("./fonts/ploticon");var n=t("./components/fx"),a=t("./plots/plots");R.Plots={resize:a.resize,graphJson:a.graphJson,sendDataToCloud:a.sendDataToCloud},R.Fx={hover:n.hover,unhover:n.unhover,loneHover:n.loneHover,loneUnhover:n.loneUnhover},R.Snapshot=t("./snapshot"),R.PlotSchema=t("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":358,"./components/annotations3d":363,"./components/colorbar":373,"./components/colorscale":379,"./components/errorbars":395,"./components/fx":407,"./components/grid":411,"./components/images":416,"./components/legend":424,"./components/modebar":430,"./components/rangeselector":438,"./components/rangeslider":445,"./components/selections":455,"./components/shapes":470,"./components/sliders":475,"./components/updatemenus":481,"./fonts/ploticon":494,"./locale-en":546,"./locale-en-us":545,"./plot_api":550,"./plot_api/plot_schema":554,"./plots/plots":628,"./registry":647,"./snapshot":652,"./traces/scatter":948,"./version":1132,"native-promise-only":245}],494:[function(t,P,R){P.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:["<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'>","<defs>"," <style>","  .cls-0{fill:#000;}","  .cls-1{fill:#FFF;}","  .cls-2{fill:#F26;}","  .cls-3{fill:#D69;}","  .cls-4{fill:#BAC;}","  .cls-5{fill:#9EF;}"," </style>","</defs>"," <title>plotly-logomark</title>"," <g id='symbol'>","  <rect class='cls-0' x='0' y='0' width='132' height='132' rx='18' ry='18'/>","  <circle class='cls-5' cx='102' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='54' r='6'/>","  <circle class='cls-3' cx='54' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='54' r='6'/>","  <path class='cls-1' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/>","  <path class='cls-1' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/>","  <path class='cls-1' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/>","  <path class='cls-1' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/>"," </g>","</svg>"].join("")}}},{}],495:[function(t,P,R){R.isLeftAnchor=function(u){return u.xanchor==="left"||u.xanchor==="auto"&&u.x<=1/3},R.isCenterAnchor=function(u){return u.xanchor==="center"||u.xanchor==="auto"&&u.x>1/3&&u.x<2/3},R.isRightAnchor=function(u){return u.xanchor==="right"||u.xanchor==="auto"&&u.x>=2/3},R.isTopAnchor=function(u){return u.yanchor==="top"||u.yanchor==="auto"&&u.y>=2/3},R.isMiddleAnchor=function(u){return u.yanchor==="middle"||u.yanchor==="auto"&&u.y>1/3&&u.y<2/3},R.isBottomAnchor=function(u){return u.yanchor==="bottom"||u.yanchor==="auto"&&u.y<=1/3}},{}],496:[function(t,P,R){var h=t("./mod"),u=h.mod,A=h.modHalf,T=Math.PI,e=2*T;function i(x){return x/180*T}function n(x){return x/T*180}function a(x){return Math.abs(x[1]-x[0])>e-1e-14}function r(x,l){return A(l-x,e)}function f(x,l){return Math.abs(r(x,l))}function o(x,l){if(a(l))return!0;var b,c;l[0]<l[1]?(b=l[0],c=l[1]):(b=l[1],c=l[0]),b=u(b,e),c=u(c,e),b>c&&(c+=e);var M=u(x,e),_=M+e;return M>=b&&M<=c||_>=b&&_<=c}function s(x,l,b,c){if(!o(l,c))return!1;var M,_;return b[0]<b[1]?(M=b[0],_=b[1]):(M=b[1],_=b[0]),x>=M&&x<=_}function m(x,l,b,c,M,_,y){M=M||0,_=_||0;var w=a([b,c]),d,C,S,E,k;w?(d=0,C=T,S=e):b<c?(d=b,S=c):(d=c,S=b),x<l?(E=x,k=l):(E=l,k=x);function B(O,N){return[O*Math.cos(N)+M,_-O*Math.sin(N)]}var z=Math.abs(S-d)<=T?0:1;function F(O,N,V){return"A"+[O,O]+" "+[0,z,V]+" "+B(O,N)}var I;return w?E===null?I="M"+B(k,d)+F(k,C,0)+F(k,S,0)+"Z":I="M"+B(E,d)+F(E,C,0)+F(E,S,0)+"ZM"+B(k,d)+F(k,C,1)+F(k,S,1)+"Z":E===null?(I="M"+B(k,d)+F(k,S,0),y&&(I+="L0,0Z")):I="M"+B(E,d)+"L"+B(k,d)+F(k,S,0)+"L"+B(E,S)+F(E,d,1)+"Z",I}function g(x,l,b,c,M){return m(null,x,l,b,c,M,0)}function p(x,l,b,c,M){return m(null,x,l,b,c,M,1)}function v(x,l,b,c,M,_){return m(x,l,b,c,M,_,1)}P.exports={deg2rad:i,rad2deg:n,angleDelta:r,angleDist:f,isFullCircle:a,isAngleInsideSector:o,isPtInsideSector:s,pathArc:g,pathSector:p,pathAnnulus:v}},{"./mod":522}],497:[function(t,P,R){var h=Array.isArray,u=ArrayBuffer,A=DataView;function T(a){return u.isView(a)&&!(a instanceof A)}R.isTypedArray=T;function e(a){return h(a)||T(a)}R.isArrayOrTypedArray=e;function i(a){return!e(a[0])}R.isArray1D=i,R.ensureArray=function(a,r){return h(a)||(a=[]),a.length=r,a},R.concat=function(){var a=[],r=!0,f=0,o,s,m,g,p,v,x,l;for(m=0;m<arguments.length;m++)g=arguments[m],v=g.length,v&&(s?a.push(g):(s=g,p=v),h(g)?o=!1:(r=!1,f?o!==g.constructor&&(o=!1):o=g.constructor),f+=v);if(!f)return[];if(!a.length)return s;if(r)return s.concat.apply(s,a);if(o){for(x=new o(f),x.set(s),m=0;m<a.length;m++)g=a[m],x.set(g,p),p+=g.length;return x}for(x=new Array(f),l=0;l<s.length;l++)x[l]=s[l];for(m=0;m<a.length;m++){for(g=a[m],l=0;l<g.length;l++)x[p+l]=g[l];p+=l}return x},R.maxRowLength=function(a){return n(a,Math.max,0)},R.minRowLength=function(a){return n(a,Math.min,1/0)};function n(a,r,f){if(e(a))if(e(a[0])){for(var o=f,s=0;s<a.length;s++)o=r(o,a[s].length);return o}else return a.length;return 0}},{}],498:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../constants/numerical").BADNUM,A=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;P.exports=function(e){return typeof e=="string"&&(e=e.replace(A,"")),h(e)?Number(e):u}},{"../constants/numerical":491,"fast-isnumeric":190}],499:[function(t,P,R){P.exports=function(u){var A=u._fullLayout;A._glcanvas&&A._glcanvas.size()&&A._glcanvas.each(function(T){T.regl&&T.regl.clear({color:!0,depth:!0})})}},{}],500:[function(t,P,R){P.exports=function(u){u._responsiveChartHandler&&(window.removeEventListener("resize",u._responsiveChartHandler),delete u._responsiveChartHandler)}},{}],501:[function(t,P,R){var h=t("fast-isnumeric"),u=t("tinycolor2"),A=t("../plots/attributes"),T=t("../components/colorscale/scales"),e=t("../components/color"),i=t("../constants/interactions").DESELECTDIM,n=t("./nested_property"),a=t("./regex").counter,r=t("./mod").modHalf,f=t("./array").isArrayOrTypedArray;R.valObjectMeta={data_array:{coerceFunction:function(s,m,g){f(s)?m.set(s):g!==void 0&&m.set(g)}},enumerated:{coerceFunction:function(s,m,g,p){p.coerceNumber&&(s=+s),p.values.indexOf(s)===-1?m.set(g):m.set(s)},validateFunction:function(s,m){m.coerceNumber&&(s=+s);for(var g=m.values,p=0;p<g.length;p++){var v=String(g[p]);if(v.charAt(0)==="/"&&v.charAt(v.length-1)==="/"){var x=new RegExp(v.substr(1,v.length-2));if(x.test(s))return!0}else if(s===g[p])return!0}return!1}},boolean:{coerceFunction:function(s,m,g){s===!0||s===!1?m.set(s):m.set(g)}},number:{coerceFunction:function(s,m,g,p){!h(s)||p.min!==void 0&&s<p.min||p.max!==void 0&&s>p.max?m.set(g):m.set(+s)}},integer:{coerceFunction:function(s,m,g,p){s%1||!h(s)||p.min!==void 0&&s<p.min||p.max!==void 0&&s>p.max?m.set(g):m.set(+s)}},string:{coerceFunction:function(s,m,g,p){if(typeof s!="string"){var v=typeof s=="number";p.strict===!0||!v?m.set(g):m.set(String(s))}else p.noBlank&&!s?m.set(g):m.set(s)}},color:{coerceFunction:function(s,m,g){u(s).isValid()?m.set(s):m.set(g)}},colorlist:{coerceFunction:function(s,m,g){function p(v){return u(v).isValid()}!Array.isArray(s)||!s.length?m.set(g):s.every(p)?m.set(s):m.set(g)}},colorscale:{coerceFunction:function(s,m,g){m.set(T.get(s,g))}},angle:{coerceFunction:function(s,m,g){s==="auto"?m.set("auto"):h(s)?m.set(r(+s,360)):m.set(g)}},subplotid:{coerceFunction:function(s,m,g,p){var v=p.regex||a(g);if(typeof s=="string"&&v.test(s)){m.set(s);return}m.set(g)},validateFunction:function(s,m){var g=m.dflt;return s===g?!0:typeof s!="string"?!1:!!a(g).test(s)}},flaglist:{coerceFunction:function(s,m,g,p){if((p.extras||[]).indexOf(s)!==-1){m.set(s);return}if(typeof s!="string"){m.set(g);return}for(var v=s.split("+"),x=0;x<v.length;){var l=v[x];p.flags.indexOf(l)===-1||v.indexOf(l)<x?v.splice(x,1):x++}v.length?m.set(v.join("+")):m.set(g)}},any:{coerceFunction:function(s,m,g){s===void 0?m.set(g):m.set(s)}},info_array:{coerceFunction:function(s,m,g,p){function v(B,z,F){var I,O={set:function(N){I=N}};return F===void 0&&(F=z.dflt),R.valObjectMeta[z.valType].coerceFunction(B,O,F,z),I}var x=p.dimensions===2||p.dimensions==="1-2"&&Array.isArray(s)&&Array.isArray(s[0]);if(!Array.isArray(s)){m.set(g);return}var l=p.items,b=[],c=Array.isArray(l),M=c&&x&&Array.isArray(l[0]),_=x&&c&&!M,y=c&&!_?l.length:s.length,w,d,C,S,E,k;if(g=Array.isArray(g)?g:[],x)for(w=0;w<y;w++)for(b[w]=[],C=Array.isArray(s[w])?s[w]:[],_?E=l.length:c?E=l[w].length:E=C.length,d=0;d<E;d++)_?S=l[d]:c?S=l[w][d]:S=l,k=v(C[d],S,(g[w]||[])[d]),k!==void 0&&(b[w][d]=k);else for(w=0;w<y;w++)k=v(s[w],c?l[w]:l,g[w]),k!==void 0&&(b[w]=k);m.set(b)},validateFunction:function(s,m){if(!Array.isArray(s))return!1;var g=m.items,p=Array.isArray(g),v=m.dimensions===2;if(!m.freeLength&&s.length!==g.length)return!1;for(var x=0;x<s.length;x++)if(v){if(!Array.isArray(s[x])||!m.freeLength&&s[x].length!==g[x].length)return!1;for(var l=0;l<s[x].length;l++)if(!o(s[x][l],p?g[x][l]:g))return!1}else if(!o(s[x],p?g[x]:g))return!1;return!0}}},R.coerce=function(s,m,g,p,v){var x=n(g,p).get(),l=n(s,p),b=n(m,p),c=l.get(),M=m._template;if(c===void 0&&M&&(c=n(M,p).get(),M=0),v===void 0&&(v=x.dflt),x.arrayOk&&f(c))return b.set(c),c;var _=R.valObjectMeta[x.valType].coerceFunction;_(c,b,v,x);var y=b.get();return M&&y===v&&!o(c,x)&&(c=n(M,p).get(),_(c,b,v,x),y=b.get()),y},R.coerce2=function(s,m,g,p,v){var x=n(s,p),l=R.coerce(s,m,g,p,v),b=x.get();return b!=null?l:!1},R.coerceFont=function(s,m,g){var p={};return g=g||{},p.family=s(m+".family",g.family),p.size=s(m+".size",g.size),p.color=s(m+".color",g.color),p},R.coercePattern=function(s,m,g,p){var v=s(m+".shape");if(v){s(m+".solidity"),s(m+".size");var x=s(m+".fillmode"),l=x==="overlay";if(!p){var b=s(m+".bgcolor",l?g:void 0);s(m+".fgcolor",l?e.contrast(b):g)}s(m+".fgopacity",l?.5:1)}},R.coerceHoverinfo=function(s,m,g){var p=m._module.attributes,v=p.hoverinfo?p:A,x=v.hoverinfo,l;if(g._dataLength===1){var b=x.dflt==="all"?x.flags.slice():x.dflt.split("+");b.splice(b.indexOf("name"),1),l=b.join("+")}return R.coerce(s,m,v,"hoverinfo",l)},R.coerceSelectionMarkerOpacity=function(s,m){if(!!s.marker){var g=s.marker.opacity;if(g!==void 0){var p,v;!f(g)&&!s.selected&&!s.unselected&&(p=g,v=i*g),m("selected.marker.opacity",p),m("unselected.marker.opacity",v)}}};function o(s,m){var g=R.valObjectMeta[m.valType];if(m.arrayOk&&f(s))return!0;if(g.validateFunction)return g.validateFunction(s,m);var p={},v=p,x={set:function(l){v=l}};return g.coerceFunction(s,x,p,m),v!==p}R.validate=o},{"../components/color":367,"../components/colorscale/scales":382,"../constants/interactions":490,"../plots/attributes":562,"./array":497,"./mod":522,"./nested_property":523,"./regex":532,"fast-isnumeric":190,tinycolor2:313}],502:[function(t,P,R){var h=t("d3-time-format").timeFormat,u=t("fast-isnumeric"),A=t("./loggers"),T=t("./mod").mod,e=t("../constants/numerical"),i=e.BADNUM,n=e.ONEDAY,a=e.ONEHOUR,r=e.ONEMIN,f=e.ONESEC,o=e.EPOCHJD,s=t("../registry"),m=t("d3-time-format").utcFormat,g=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,p=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,v=new Date().getFullYear()-70;function x(I){return I&&s.componentsRegistry.calendars&&typeof I=="string"&&I!=="gregorian"}R.dateTick0=function(I,O){var N=l(I,!!O);if(O<2)return N;var V=R.dateTime2ms(N,I);return V+=n*(O-1),R.ms2DateTime(V,0,I)};function l(I,O){return x(I)?O?s.getComponentMethod("calendars","CANONICAL_SUNDAY")[I]:s.getComponentMethod("calendars","CANONICAL_TICK")[I]:O?"2000-01-02":"2000-01-01"}R.dfltRange=function(I){return x(I)?s.getComponentMethod("calendars","DFLTRANGE")[I]:["2000-01-01","2001-01-01"]},R.isJSDate=function(I){return typeof I=="object"&&I!==null&&typeof I.getTime=="function"};var b,c;R.dateTime2ms=function(I,O){if(R.isJSDate(I)){var N=I.getTimezoneOffset()*r,V=(I.getUTCMinutes()-I.getMinutes())*r+(I.getUTCSeconds()-I.getSeconds())*f+(I.getUTCMilliseconds()-I.getMilliseconds());if(V){var H=3*r;N=N-H/2+T(V-N+H/2,H)}return I=Number(I)-N,I>=b&&I<=c?I:i}if(typeof I!="string"&&typeof I!="number")return i;I=String(I);var j=x(O),Z=I.charAt(0);j&&(Z==="G"||Z==="g")&&(I=I.substr(1),O="");var X=j&&O.substr(0,7)==="chinese",re=I.match(X?p:g);if(!re)return i;var ue=re[1],K=re[3]||"1",te=Number(re[5]||1),G=Number(re[7]||0),Y=Number(re[9]||0),ee=Number(re[11]||0);if(j){if(ue.length===2)return i;ue=Number(ue);var ne;try{var J=s.getComponentMethod("calendars","getCal")(O);if(X){var q=K.charAt(K.length-1)==="i";K=parseInt(K,10),ne=J.newDate(ue,J.toMonthIndex(ue,K,q),te)}else ne=J.newDate(ue,Number(K),te)}catch{return i}return ne?(ne.toJD()-o)*n+G*a+Y*r+ee*f:i}ue.length===2?ue=(Number(ue)+2e3-v)%100+v:ue=Number(ue),K-=1;var ae=new Date(Date.UTC(2e3,K,te,G,Y));return ae.setUTCFullYear(ue),ae.getUTCMonth()!==K||ae.getUTCDate()!==te?i:ae.getTime()+ee*f},b=R.MIN_MS=R.dateTime2ms("-9999"),c=R.MAX_MS=R.dateTime2ms("9999-12-31 23:59:59.9999"),R.isDateTime=function(I,O){return R.dateTime2ms(I,O)!==i};function M(I,O){return String(I+Math.pow(10,O)).substr(1)}var _=90*n,y=3*a,w=5*r;R.ms2DateTime=function(I,O,N){if(typeof I!="number"||!(I>=b&&I<=c))return i;O||(O=0);var V=Math.floor(T(I+.05,1)*10),H=Math.round(I-V/10),j,Z,X,re,ue,K;if(x(N)){var te=Math.floor(H/n)+o,G=Math.floor(T(I,n));try{j=s.getComponentMethod("calendars","getCal")(N).fromJD(te).formatDate("yyyy-mm-dd")}catch{j=m("G%Y-%m-%d")(new Date(H))}if(j.charAt(0)==="-")for(;j.length<11;)j="-0"+j.substr(1);else for(;j.length<10;)j="0"+j;Z=O<_?Math.floor(G/a):0,X=O<_?Math.floor(G%a/r):0,re=O<y?Math.floor(G%r/f):0,ue=O<w?G%f*10+V:0}else K=new Date(H),j=m("%Y-%m-%d")(K),Z=O<_?K.getUTCHours():0,X=O<_?K.getUTCMinutes():0,re=O<y?K.getUTCSeconds():0,ue=O<w?K.getUTCMilliseconds()*10+V:0;return d(j,Z,X,re,ue)},R.ms2DateTimeLocal=function(I){if(!(I>=b+n&&I<=c-n))return i;var O=Math.floor(T(I+.05,1)*10),N=new Date(Math.round(I-O/10)),V=h("%Y-%m-%d")(N),H=N.getHours(),j=N.getMinutes(),Z=N.getSeconds(),X=N.getUTCMilliseconds()*10+O;return d(V,H,j,Z,X)};function d(I,O,N,V,H){if((O||N||V||H)&&(I+=" "+M(O,2)+":"+M(N,2),(V||H)&&(I+=":"+M(V,2),H))){for(var j=4;H%10===0;)j-=1,H/=10;I+="."+M(H,j)}return I}R.cleanDate=function(I,O,N){if(I===i)return O;if(R.isJSDate(I)||typeof I=="number"&&isFinite(I)){if(x(N))return A.error("JS Dates and milliseconds are incompatible with world calendars",I),O;if(I=R.ms2DateTimeLocal(+I),!I&&O!==void 0)return O}else if(!R.isDateTime(I,N))return A.error("unrecognized date",I),O;return I};var C=/%\d?f/g,S=/%h/g,E={1:"1",2:"1",3:"2",4:"2"};function k(I,O,N,V){I=I.replace(C,function(j){var Z=Math.min(+j.charAt(1)||6,6),X=(O/1e3%1+2).toFixed(Z).substr(2).replace(/0+$/,"")||"0";return X});var H=new Date(Math.floor(O+.05));if(I=I.replace(S,function(){return E[N("%q")(H)]}),x(V))try{I=s.getComponentMethod("calendars","worldCalFmt")(I,O,V)}catch{return"Invalid"}return N(I)(H)}var B=[59,59.9,59.99,59.999,59.9999];function z(I,O){var N=T(I+.05,n),V=M(Math.floor(N/a),2)+":"+M(T(Math.floor(N/r),60),2);if(O!=="M"){u(O)||(O=0);var H=Math.min(T(I/f,60),B[O]),j=(100+H).toFixed(O).substr(1);O>0&&(j=j.replace(/0+$/,"").replace(/[\.]$/,"")),V+=":"+j}return V}R.formatDate=function(I,O,N,V,H,j){if(H=x(H)&&H,!O)if(N==="y")O=j.year;else if(N==="m")O=j.month;else if(N==="d")O=j.dayMonth+`
`+j.year;else return z(I,N)+`
`+k(j.dayMonthYear,I,V,H);return k(O,I,V,H)};var F=3*n;R.incrementMonth=function(I,O,N){N=x(N)&&N;var V=T(I,n);if(I=Math.round(I-V),N)try{var H=Math.round(I/n)+o,j=s.getComponentMethod("calendars","getCal")(N),Z=j.fromJD(H);return O%12?j.add(Z,O,"m"):j.add(Z,O/12,"y"),(Z.toJD()-o)*n+V}catch{A.error("invalid ms "+I+" in calendar "+N)}var X=new Date(I+F);return X.setUTCMonth(X.getUTCMonth()+O)+V-F},R.findExactDates=function(I,O){for(var N=0,V=0,H=0,j=0,Z,X,re=x(O)&&s.getComponentMethod("calendars","getCal")(O),ue=0;ue<I.length;ue++){if(X=I[ue],!u(X)){j++;continue}if(!(X%n))if(re)try{Z=re.fromJD(X/n+o),Z.day()===1?Z.month()===1?N++:V++:H++}catch{}else Z=new Date(X),Z.getUTCDate()===1?Z.getUTCMonth()===0?N++:V++:H++}V+=N,H+=V;var K=I.length-j;return{exactYears:N/K,exactMonths:V/K,exactDays:H/K}}},{"../constants/numerical":491,"../registry":647,"./loggers":519,"./mod":522,"d3-time-format":120,"fast-isnumeric":190}],503:[function(t,P,R){var h=t("@plotly/d3"),u=t("./loggers"),A=t("./matrix"),T=t("gl-mat4");function e(v){var x;if(typeof v=="string"){if(x=document.getElementById(v),x===null)throw new Error("No DOM element with id '"+v+"' exists on the page.");return x}else if(v==null)throw new Error("DOM element provided is null or undefined");return v}function i(v){var x=h.select(v);return x.node()instanceof HTMLElement&&x.size()&&x.classed("js-plotly-plot")}function n(v){var x=v&&v.parentNode;x&&x.removeChild(v)}function a(v,x){r("global",v,x)}function r(v,x,l){var b="plotly.js-style-"+v,c=document.getElementById(b);c||(c=document.createElement("style"),c.setAttribute("id",b),c.appendChild(document.createTextNode("")),document.head.appendChild(c));var M=c.sheet;M.insertRule?M.insertRule(x+"{"+l+"}",0):M.addRule?M.addRule(x,l,0):u.warn("addStyleRule failed")}function f(v){var x="plotly.js-style-"+v,l=document.getElementById(x);l&&n(l)}function o(v){var x=m(v),l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return x.forEach(function(b){var c=s(b);if(c){var M=A.convertCssMatrix(c);l=T.multiply(l,l,M)}}),l}function s(v){var x=window.getComputedStyle(v,null),l=x.getPropertyValue("-webkit-transform")||x.getPropertyValue("-moz-transform")||x.getPropertyValue("-ms-transform")||x.getPropertyValue("-o-transform")||x.getPropertyValue("transform");return l==="none"?null:l.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(b){return+b})}function m(v){for(var x=[];g(v);)x.push(v),v=v.parentNode;return x}function g(v){return v&&(v instanceof Element||v instanceof HTMLElement)}function p(v,x){return v&&x&&v.x===x.x&&v.y===x.y&&v.top===x.top&&v.left===x.left&&v.right===x.right&&v.bottom===x.bottom}P.exports={getGraphDiv:e,isPlotDiv:i,removeElement:n,addStyleRule:a,addRelatedStyleRule:r,deleteRelatedStyleRule:f,getFullTransformMatrix:o,getElementTransformMatrix:s,getElementAndAncestors:m,equalDomRects:p}},{"./loggers":519,"./matrix":521,"@plotly/d3":58,"gl-mat4":210}],504:[function(t,P,R){var h=t("events").EventEmitter,u={init:function(A){if(A._ev instanceof h)return A;var T=new h,e=new h;return A._ev=T,A._internalEv=e,A.on=T.on.bind(T),A.once=T.once.bind(T),A.removeListener=T.removeListener.bind(T),A.removeAllListeners=T.removeAllListeners.bind(T),A._internalOn=e.on.bind(e),A._internalOnce=e.once.bind(e),A._removeInternalListener=e.removeListener.bind(e),A._removeAllInternalListeners=e.removeAllListeners.bind(e),A.emit=function(i,n){typeof jQuery<"u"&&jQuery(A).trigger(i,n),T.emit(i,n),e.emit(i,n)},A},triggerHandler:function(A,T,e){var i,n;typeof jQuery<"u"&&(i=jQuery(A).triggerHandler(T,e));var a=A._ev;if(!a)return i;var r=a._events[T];if(!r)return i;function f(s){if(s.listener){if(a.removeListener(T,s.listener),!s.fired)return s.fired=!0,s.listener.apply(a,[e])}else return s.apply(a,[e])}r=Array.isArray(r)?r:[r];var o;for(o=0;o<r.length-1;o++)f(r[o]);return n=f(r[o]),i!==void 0?i:n},purge:function(A){return delete A._ev,delete A.on,delete A.once,delete A.removeListener,delete A.removeAllListeners,delete A.emit,delete A._ev,delete A._internalEv,delete A._internalOn,delete A._internalOnce,delete A._removeInternalListener,delete A._removeAllInternalListeners,A}};P.exports=u},{events:84}],505:[function(t,P,R){var h=t("./is_plain_object.js"),u=Array.isArray;function A(e,i){var n,a;for(n=0;n<e.length;n++){if(a=e[n],a!==null&&typeof a=="object")return!1;a!==void 0&&(i[n]=a)}return!0}R.extendFlat=function(){return T(arguments,!1,!1,!1)},R.extendDeep=function(){return T(arguments,!0,!1,!1)},R.extendDeepAll=function(){return T(arguments,!0,!0,!1)},R.extendDeepNoArrays=function(){return T(arguments,!0,!1,!0)};function T(e,i,n,a){var r=e[0],f=e.length,o,s,m,g,p,v,x;if(f===2&&u(r)&&u(e[1])&&r.length===0){if(x=A(e[1],r),x)return r;r.splice(0,r.length)}for(var l=1;l<f;l++){o=e[l];for(s in o)m=r[s],g=o[s],a&&u(g)?r[s]=g:i&&g&&(h(g)||(p=u(g)))?(p?(p=!1,v=m&&u(m)?m:[]):v=m&&h(m)?m:{},r[s]=T([v,g],i,n,a)):(typeof g<"u"||n)&&(r[s]=g)}return r}},{"./is_plain_object.js":516}],506:[function(t,P,R){P.exports=function(u){for(var A={},T=[],e=0,i=0;i<u.length;i++){var n=u[i];A[n]!==1&&(A[n]=1,T[e++]=n)}return T}},{}],507:[function(t,P,R){P.exports=function(e){for(var i=A(e)?u:h,n=[],a=0;a<e.length;a++){var r=e[a];i(r)&&n.push(r)}return n};function h(T){return T.visible===!0}function u(T){var e=T[0].trace;return e.visible===!0&&e._length!==0}function A(T){return Array.isArray(T)&&Array.isArray(T[0])&&T[0][0]&&T[0][0].trace}},{}],508:[function(t,P,R){var h=t("@plotly/d3"),u=t("country-regex"),A=t("@turf/area"),T=t("@turf/centroid"),e=t("@turf/bbox"),i=t("./identity"),n=t("./loggers"),a=t("./is_plain_object"),r=t("./nested_property"),f=t("./polygon"),o=Object.keys(u),s={"ISO-3":i,"USA-states":i,"country names":m};function m(M){for(var _=0;_<o.length;_++){var y=o[_],w=new RegExp(u[y]);if(w.test(M.trim().toLowerCase()))return y}return n.log("Unrecognized country name: "+M+"."),!1}function g(M,_,y){if(!_||typeof _!="string")return!1;var w=s[M](_),d,C,S;if(w){if(M==="USA-states")for(d=[],S=0;S<y.length;S++)C=y[S],C.properties&&C.properties.gu&&C.properties.gu==="USA"&&d.push(C);else d=y;for(S=0;S<d.length;S++)if(C=d[S],C.id===w)return C;n.log(["Location with id",w,"does not have a matching topojson feature at this resolution."].join(" "))}return!1}function p(M){var _=M.geometry,y=_.coordinates,w=M.id,d=[],C,S,E,k;function B(z){for(var F=0;F<z.length-1;F++)if(z[F][0]>0&&z[F+1][0]<0)return F;return null}switch(w==="RUS"||w==="FJI"?C=function(z){var F;if(B(z)===null)F=z;else for(F=new Array(z.length),k=0;k<z.length;k++)F[k]=[z[k][0]<0?z[k][0]+360:z[k][0],z[k][1]];d.push(f.tester(F))}:w==="ATA"?C=function(z){var F=B(z);if(F===null)return d.push(f.tester(z));var I=new Array(z.length+1),O=0;for(k=0;k<z.length;k++)k>F?I[O++]=[z[k][0]+360,z[k][1]]:k===F?(I[O++]=z[k],I[O++]=[z[k][0],-90]):I[O++]=z[k];var N=f.tester(I);N.pts.pop(),d.push(N)}:C=function(z){d.push(f.tester(z))},_.type){case"MultiPolygon":for(S=0;S<y.length;S++)for(E=0;E<y[S].length;E++)C(y[S][E]);break;case"Polygon":for(S=0;S<y.length;S++)C(y[S]);break}return d}function v(M){var _=M.geojson,y=window.PlotlyGeoAssets||{},w=typeof _=="string"?y[_]:_;return a(w)?w:(n.error("Oops ... something went wrong when fetching "+_),!1)}function x(M){var _=M[0].trace,y=v(_);if(!y)return!1;var w={},d=[],C;for(C=0;C<_._length;C++){var S=M[C];(S.loc||S.loc===0)&&(w[S.loc]=S)}function E(z){var F=r(z,_.featureidkey||"id").get(),I=w[F];if(I){var O=z.geometry;if(O.type==="Polygon"||O.type==="MultiPolygon"){var N={type:"Feature",id:F,geometry:O,properties:{}};N.properties.ct=l(N),I.fIn=z,I.fOut=N,d.push(N)}else n.log(["Location",I.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete w[F]}switch(y.type){case"FeatureCollection":var k=y.features;for(C=0;C<k.length;C++)E(k[C]);break;case"Feature":E(y);break;default:return n.warn(["Invalid GeoJSON type",(y.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var B in w)n.log(["Location *"+B+"*","does not have a matching feature with id-key","*"+_.featureidkey+"*."].join(" "));return d}function l(M){var _=M.geometry,y;if(_.type==="MultiPolygon")for(var w=_.coordinates,d=0,C=0;C<w.length;C++){var S={type:"Polygon",coordinates:w[C]},E=A.default(S);E>d&&(d=E,y=S)}else y=_;return T.default(y).geometry.coordinates}function b(M){var _=window.PlotlyGeoAssets||{},y=[];function w(k){return new Promise(function(B,z){h.json(k,function(F,I){if(F){delete _[k];var O=F.status===404?'GeoJSON at URL "'+k+'" does not exist.':"Unexpected error while fetching from "+k;return z(new Error(O))}return _[k]=I,B(I)})})}function d(k){return new Promise(function(B,z){var F=0,I=setInterval(function(){if(_[k]&&_[k]!=="pending")return clearInterval(I),B(_[k]);if(F>100)return clearInterval(I),z("Unexpected error while fetching from "+k);F++},50)})}for(var C=0;C<M.length;C++){var S=M[C][0].trace,E=S.geojson;typeof E=="string"&&(_[E]?_[E]==="pending"&&y.push(d(E)):(_[E]="pending",y.push(w(E))))}return y}function c(M){return e.default(M)}P.exports={locationToFeature:g,feature2polygons:p,getTraceGeojson:v,extractTraceFeature:x,fetchTraceGeoData:b,computeBbox:c}},{"./identity":513,"./is_plain_object":516,"./loggers":519,"./nested_property":523,"./polygon":527,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],509:[function(t,P,R){var h=t("../constants/numerical").BADNUM;R.calcTraceToLineCoords=function(u){for(var A=u[0].trace,T=A.connectgaps,e=[],i=[],n=0;n<u.length;n++){var a=u[n],r=a.lonlat;r[0]!==h?i.push(r):!T&&i.length>0&&(e.push(i),i=[])}return i.length>0&&e.push(i),e},R.makeLine=function(u){return u.length===1?{type:"LineString",coordinates:u[0]}:{type:"MultiLineString",coordinates:u}},R.makePolygon=function(u){if(u.length===1)return{type:"Polygon",coordinates:u};for(var A=new Array(u.length),T=0;T<u.length;T++)A[T]=[u[T]];return{type:"MultiPolygon",coordinates:A}},R.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":491}],510:[function(t,P,R){var h=t("./mod").mod;R.segmentsIntersect=u;function u(n,a,r,f,o,s,m,g){var p=r-n,v=o-n,x=m-o,l=f-a,b=s-a,c=g-s,M=p*c-x*l;if(M===0)return null;var _=(v*c-x*b)/M,y=(v*l-p*b)/M;return y<0||y>1||_<0||_>1?null:{x:n+p*_,y:a+l*_}}R.segmentDistance=function(a,r,f,o,s,m,g,p){if(u(a,r,f,o,s,m,g,p))return 0;var v=f-a,x=o-r,l=g-s,b=p-m,c=v*v+x*x,M=l*l+b*b,_=Math.min(A(v,x,c,s-a,m-r),A(v,x,c,g-a,p-r),A(l,b,M,a-s,r-m),A(l,b,M,f-s,o-m));return Math.sqrt(_)};function A(n,a,r,f,o){var s=f*n+o*a;if(s<0)return f*f+o*o;if(s>r){var m=f-n,g=o-a;return m*m+g*g}else{var p=f*a-o*n;return p*p/r}}var T,e,i;R.getTextLocation=function(a,r,f,o){if((a!==e||o!==i)&&(T={},e=a,i=o),T[f])return T[f];var s=a.getPointAtLength(h(f-o/2,r)),m=a.getPointAtLength(h(f+o/2,r)),g=Math.atan((m.y-s.y)/(m.x-s.x)),p=a.getPointAtLength(h(f,r)),v=(p.x*4+s.x+m.x)/6,x=(p.y*4+s.y+m.y)/6,l={x:v,y:x,theta:g};return T[f]=l,l},R.clearLocationCache=function(){e=null},R.getVisibleSegment=function(a,r,f){var o=r.left,s=r.right,m=r.top,g=r.bottom,p=0,v=a.getTotalLength(),x=v,l,b;function c(_){var y=a.getPointAtLength(_);_===0?l=y:_===v&&(b=y);var w=y.x<o?o-y.x:y.x>s?y.x-s:0,d=y.y<m?m-y.y:y.y>g?y.y-g:0;return Math.sqrt(w*w+d*d)}for(var M=c(p);M;){if(p+=M+f,p>x)return;M=c(p)}for(M=c(x);M;){if(x-=M+f,p>x)return;M=c(x)}return{min:p,max:x,len:x-p,total:v,isClosed:p===0&&x===v&&Math.abs(l.x-b.x)<.1&&Math.abs(l.y-b.y)<.1}},R.findPointOnPath=function(a,r,f,o){o=o||{};for(var s=o.pathLength||a.getTotalLength(),m=o.tolerance||.001,g=o.iterationLimit||30,p=a.getPointAtLength(0)[f]>a.getPointAtLength(s)[f]?-1:1,v=0,x=0,l=s,b,c,M;v<g;){if(b=(x+l)/2,c=a.getPointAtLength(b),M=c[f]-r,Math.abs(M)<m)return c;p*M>0?l=b:x=b,v++}return c}},{"./mod":522}],511:[function(t,P,R){var h=t("fast-isnumeric"),u=t("tinycolor2"),A=t("color-normalize"),T=t("../components/colorscale"),e=t("../components/color/attributes").defaultLine,i=t("./array").isArrayOrTypedArray,n=A(e),a=1;function r(g,p){var v=g;return v[3]*=p,v}function f(g){if(h(g))return n;var p=A(g);return p.length?p:n}function o(g){return h(g)?g:a}function s(g,p,v){var x=g.color,l=i(x),b=i(p),c=T.extractOpts(g),M=[],_,y,w,d,C;if(c.colorscale!==void 0?_=T.makeColorScaleFuncFromTrace(g):_=f,l?y=function(E,k){return E[k]===void 0?n:A(_(E[k]))}:y=f,b?w=function(E,k){return E[k]===void 0?a:o(E[k])}:w=o,l||b)for(var S=0;S<v;S++)d=y(x,S),C=w(p,S),M[S]=r(d,C);else M=r(A(x),p);return M}function m(g){var p=T.extractOpts(g),v=p.colorscale;return p.reversescale&&(v=T.flipScale(p.colorscale)),v.map(function(x){var l=x[0],b=u(x[1]),c=b.toRgb();return{index:l,rgb:[c.r,c.g,c.b,c.a]}})}P.exports={formatColor:s,parseColorScale:m}},{"../components/color/attributes":366,"../components/colorscale":379,"./array":497,"color-normalize":89,"fast-isnumeric":190,tinycolor2:313}],512:[function(t,P,R){var h=t("./identity");function u(A){return[A]}P.exports={keyFun:function(A){return A.key},repeat:u,descend:h,wrap:u,unwrap:function(A){return A[0]}}},{"./identity":513}],513:[function(t,P,R){P.exports=function(u){return u}},{}],514:[function(t,P,R){P.exports=function(u,A){if(!A)return u;var T=1/Math.abs(A),e=T>1?(T*u+T*A)/T:u+A,i=String(e).length;if(i>16){var n=String(A).length,a=String(u).length;if(i>=a+n){var r=parseFloat(e).toPrecision(12);r.indexOf("e+")===-1&&(e=+r)}}return e}},{}],515:[function(t,P,R){var h=t("@plotly/d3"),u=t("d3-time-format").utcFormat,A=t("d3-format").format,T=t("fast-isnumeric"),e=t("../constants/numerical"),i=e.FP_SAFE,n=-i,a=e.BADNUM,r=P.exports={};r.adjustFormat=function(K){return!K||/^\d[.]\df/.test(K)||/[.]\d%/.test(K)?K:K==="0.f"?"~f":/^\d%/.test(K)?"~%":/^\ds/.test(K)?"~s":!/^[~,.0$]/.test(K)&&/[&fps]/.test(K)?"~"+K:K};var f={};r.warnBadFormat=function(ue){var K=String(ue);f[K]||(f[K]=1,r.warn('encountered bad format: "'+K+'"'))},r.noFormat=function(ue){return String(ue)},r.numberFormat=function(ue){var K;try{K=A(r.adjustFormat(ue))}catch{return r.warnBadFormat(ue),r.noFormat}return K},r.nestedProperty=t("./nested_property"),r.keyedContainer=t("./keyed_container"),r.relativeAttr=t("./relative_attr"),r.isPlainObject=t("./is_plain_object"),r.toLogRange=t("./to_log_range"),r.relinkPrivateKeys=t("./relink_private");var o=t("./array");r.isTypedArray=o.isTypedArray,r.isArrayOrTypedArray=o.isArrayOrTypedArray,r.isArray1D=o.isArray1D,r.ensureArray=o.ensureArray,r.concat=o.concat,r.maxRowLength=o.maxRowLength,r.minRowLength=o.minRowLength;var s=t("./mod");r.mod=s.mod,r.modHalf=s.modHalf;var m=t("./coerce");r.valObjectMeta=m.valObjectMeta,r.coerce=m.coerce,r.coerce2=m.coerce2,r.coerceFont=m.coerceFont,r.coercePattern=m.coercePattern,r.coerceHoverinfo=m.coerceHoverinfo,r.coerceSelectionMarkerOpacity=m.coerceSelectionMarkerOpacity,r.validate=m.validate;var g=t("./dates");r.dateTime2ms=g.dateTime2ms,r.isDateTime=g.isDateTime,r.ms2DateTime=g.ms2DateTime,r.ms2DateTimeLocal=g.ms2DateTimeLocal,r.cleanDate=g.cleanDate,r.isJSDate=g.isJSDate,r.formatDate=g.formatDate,r.incrementMonth=g.incrementMonth,r.dateTick0=g.dateTick0,r.dfltRange=g.dfltRange,r.findExactDates=g.findExactDates,r.MIN_MS=g.MIN_MS,r.MAX_MS=g.MAX_MS;var p=t("./search");r.findBin=p.findBin,r.sorterAsc=p.sorterAsc,r.sorterDes=p.sorterDes,r.distinctVals=p.distinctVals,r.roundUp=p.roundUp,r.sort=p.sort,r.findIndexOfMin=p.findIndexOfMin,r.sortObjectKeys=t("./sort_object_keys");var v=t("./stats");r.aggNums=v.aggNums,r.len=v.len,r.mean=v.mean,r.median=v.median,r.midRange=v.midRange,r.variance=v.variance,r.stdev=v.stdev,r.interp=v.interp;var x=t("./matrix");r.init2dArray=x.init2dArray,r.transposeRagged=x.transposeRagged,r.dot=x.dot,r.translationMatrix=x.translationMatrix,r.rotationMatrix=x.rotationMatrix,r.rotationXYMatrix=x.rotationXYMatrix,r.apply3DTransform=x.apply3DTransform,r.apply2DTransform=x.apply2DTransform,r.apply2DTransform2=x.apply2DTransform2,r.convertCssMatrix=x.convertCssMatrix,r.inverseTransformMatrix=x.inverseTransformMatrix;var l=t("./angles");r.deg2rad=l.deg2rad,r.rad2deg=l.rad2deg,r.angleDelta=l.angleDelta,r.angleDist=l.angleDist,r.isFullCircle=l.isFullCircle,r.isAngleInsideSector=l.isAngleInsideSector,r.isPtInsideSector=l.isPtInsideSector,r.pathArc=l.pathArc,r.pathSector=l.pathSector,r.pathAnnulus=l.pathAnnulus;var b=t("./anchor_utils");r.isLeftAnchor=b.isLeftAnchor,r.isCenterAnchor=b.isCenterAnchor,r.isRightAnchor=b.isRightAnchor,r.isTopAnchor=b.isTopAnchor,r.isMiddleAnchor=b.isMiddleAnchor,r.isBottomAnchor=b.isBottomAnchor;var c=t("./geometry2d");r.segmentsIntersect=c.segmentsIntersect,r.segmentDistance=c.segmentDistance,r.getTextLocation=c.getTextLocation,r.clearLocationCache=c.clearLocationCache,r.getVisibleSegment=c.getVisibleSegment,r.findPointOnPath=c.findPointOnPath;var M=t("./extend");r.extendFlat=M.extendFlat,r.extendDeep=M.extendDeep,r.extendDeepAll=M.extendDeepAll,r.extendDeepNoArrays=M.extendDeepNoArrays;var _=t("./loggers");r.log=_.log,r.warn=_.warn,r.error=_.error;var y=t("./regex");r.counterRegex=y.counter;var w=t("./throttle");r.throttle=w.throttle,r.throttleDone=w.done,r.clearThrottle=w.clear;var d=t("./dom");r.getGraphDiv=d.getGraphDiv,r.isPlotDiv=d.isPlotDiv,r.removeElement=d.removeElement,r.addStyleRule=d.addStyleRule,r.addRelatedStyleRule=d.addRelatedStyleRule,r.deleteRelatedStyleRule=d.deleteRelatedStyleRule,r.getFullTransformMatrix=d.getFullTransformMatrix,r.getElementTransformMatrix=d.getElementTransformMatrix,r.getElementAndAncestors=d.getElementAndAncestors,r.equalDomRects=d.equalDomRects,r.clearResponsive=t("./clear_responsive"),r.preserveDrawingBuffer=t("./preserve_drawing_buffer"),r.makeTraceGroups=t("./make_trace_groups"),r._=t("./localize"),r.notifier=t("./notifier"),r.filterUnique=t("./filter_unique"),r.filterVisible=t("./filter_visible"),r.pushUnique=t("./push_unique"),r.increment=t("./increment"),r.cleanNumber=t("./clean_number"),r.ensureNumber=function(K){return T(K)?(K=Number(K),K>i||K<n?a:K):a},r.isIndex=function(ue,K){return K!==void 0&&ue>=K?!1:T(ue)&&ue>=0&&ue%1===0},r.noop=t("./noop"),r.identity=t("./identity"),r.repeat=function(ue,K){for(var te=new Array(K),G=0;G<K;G++)te[G]=ue;return te},r.swapAttrs=function(ue,K,te,G){te||(te="x"),G||(G="y");for(var Y=0;Y<K.length;Y++){var ee=K[Y],ne=r.nestedProperty(ue,ee.replace("?",te)),J=r.nestedProperty(ue,ee.replace("?",G)),q=ne.get();ne.set(J.get()),J.set(q)}},r.raiseToTop=function(K){K.parentNode.appendChild(K)},r.cancelTransition=function(ue){return ue.transition().duration(0)},r.constrain=function(ue,K,te){return K>te?Math.max(te,Math.min(K,ue)):Math.max(K,Math.min(te,ue))},r.bBoxIntersect=function(ue,K,te){return te=te||0,ue.left<=K.right+te&&K.left<=ue.right+te&&ue.top<=K.bottom+te&&K.top<=ue.bottom+te},r.simpleMap=function(ue,K,te,G,Y){for(var ee=ue.length,ne=new Array(ee),J=0;J<ee;J++)ne[J]=K(ue[J],te,G,Y);return ne},r.randstr=function ue(K,te,G,Y){if(G||(G=16),te===void 0&&(te=24),te<=0)return"0";var ee=Math.log(Math.pow(2,te))/Math.log(G),ne="",J,q,ae;for(J=2;ee===1/0;J*=2)ee=Math.log(Math.pow(2,te/J))/Math.log(G)*J;var le=ee-Math.floor(ee);for(J=0;J<Math.floor(ee);J++)ae=Math.floor(Math.random()*G).toString(G),ne=ae+ne;le&&(q=Math.pow(G,le),ae=Math.floor(Math.random()*q).toString(G),ne=ae+ne);var ie=parseInt(ne,G);return K&&K[ne]||ie!==1/0&&ie>=Math.pow(2,te)?Y>10?(r.warn("randstr failed uniqueness"),ne):ue(K,te,G,(Y||0)+1):ne},r.OptionControl=function(ue,K){ue||(ue={}),K||(K="opt");var te={};return te.optionList=[],te._newoption=function(G){G[K]=ue,te[G.name]=G,te.optionList.push(G)},te["_"+K]=ue,te},r.smooth=function(ue,K){if(K=Math.round(K)||0,K<2)return ue;var te=ue.length,G=2*te,Y=2*K-1,ee=new Array(Y),ne=new Array(te),J,q,ae,le;for(J=0;J<Y;J++)ee[J]=(1-Math.cos(Math.PI*(J+1)/K))/(2*K);for(J=0;J<te;J++){for(le=0,q=0;q<Y;q++)ae=J+q+1-K,ae<-te?ae-=G*Math.round(ae/G):ae>=G&&(ae-=G*Math.floor(ae/G)),ae<0?ae=-1-ae:ae>=te&&(ae=G-1-ae),le+=ue[ae]*ee[q];ne[J]=le}return ne},r.syncOrAsync=function(ue,K,te){var G,Y;function ee(){return r.syncOrAsync(ue,K,te)}for(;ue.length;)if(Y=ue.splice(0,1)[0],G=Y(K),G&&G.then)return G.then(ee);return te&&te(K)},r.stripTrailingSlash=function(ue){return ue.substr(-1)==="/"?ue.substr(0,ue.length-1):ue},r.noneOrAll=function(ue,K,te){if(!!ue){var G=!1,Y=!0,ee,ne;for(ee=0;ee<te.length;ee++)ne=ue[te[ee]],ne!=null?G=!0:Y=!1;if(G&&!Y)for(ee=0;ee<te.length;ee++)ue[te[ee]]=K[te[ee]]}},r.mergeArray=function(ue,K,te,G){var Y=typeof G=="function";if(r.isArrayOrTypedArray(ue))for(var ee=Math.min(ue.length,K.length),ne=0;ne<ee;ne++){var J=ue[ne];K[ne][te]=Y?G(J):J}},r.mergeArrayCastPositive=function(ue,K,te){return r.mergeArray(ue,K,te,function(G){var Y=+G;return isFinite(Y)&&Y>0?Y:0})},r.fillArray=function(ue,K,te,G){if(G=G||r.identity,r.isArrayOrTypedArray(ue))for(var Y=0;Y<K.length;Y++)K[Y][te]=G(ue[Y])},r.castOption=function(ue,K,te,G){G=G||r.identity;var Y=r.nestedProperty(ue,te).get();return r.isArrayOrTypedArray(Y)?Array.isArray(K)&&r.isArrayOrTypedArray(Y[K[0]])?G(Y[K[0]][K[1]]):G(Y[K]):Y},r.extractOption=function(ue,K,te,G){if(te in ue)return ue[te];var Y=r.nestedProperty(K,G).get();if(!Array.isArray(Y))return Y};function C(ue){var K={};for(var te in ue)for(var G=ue[te],Y=0;Y<G.length;Y++)K[G[Y]]=+te;return K}r.tagSelected=function(ue,K,te){var G=K.selectedpoints,Y=K._indexToPoints,ee;Y&&(ee=C(Y));function ne(ie){return ie!==void 0&&ie<ue.length}for(var J=0;J<G.length;J++){var q=G[J];if(r.isIndex(q)||r.isArrayOrTypedArray(q)&&r.isIndex(q[0])&&r.isIndex(q[1])){var ae=ee?ee[q]:q,le=te?te[ae]:ae;ne(le)&&(ue[le].selected=1)}}},r.selIndices2selPoints=function(ue){var K=ue.selectedpoints,te=ue._indexToPoints;if(te){for(var G=C(te),Y=[],ee=0;ee<K.length;ee++){var ne=K[ee];if(r.isIndex(ne)){var J=G[ne];r.isIndex(J)&&Y.push(J)}}return Y}else return K},r.getTargetArray=function(ue,K){var te=K.target;if(typeof te=="string"&&te){var G=r.nestedProperty(ue,te).get();return Array.isArray(G)?G:!1}else if(Array.isArray(te))return te;return!1},r.minExtend=function(ue,K){var te={};typeof K!="object"&&(K={});var G=3,Y=Object.keys(ue),ee,ne,J;for(ee=0;ee<Y.length;ee++)ne=Y[ee],J=ue[ne],!(ne.charAt(0)==="_"||typeof J=="function")&&(ne==="module"?te[ne]=J:Array.isArray(J)?ne==="colorscale"?te[ne]=J.slice():te[ne]=J.slice(0,G):r.isTypedArray(J)?te[ne]=J.subarray(0,G):J&&typeof J=="object"?te[ne]=r.minExtend(ue[ne],K[ne]):te[ne]=J);for(Y=Object.keys(K),ee=0;ee<Y.length;ee++)ne=Y[ee],J=K[ne],(typeof J!="object"||!(ne in te)||typeof te[ne]!="object")&&(te[ne]=J);return te},r.titleCase=function(ue){return ue.charAt(0).toUpperCase()+ue.substr(1)},r.containsAny=function(ue,K){for(var te=0;te<K.length;te++)if(ue.indexOf(K[te])!==-1)return!0;return!1},r.isIE=function(){return typeof window.navigator.msSaveBlob<"u"};var S=/Version\/[\d\.]+.*Safari/;r.isSafari=function(){return S.test(window.navigator.userAgent)};var E=/iPad|iPhone|iPod/;r.isIOS=function(){return E.test(window.navigator.userAgent)};var k=/Firefox\/(\d+)\.\d+/;r.getFirefoxVersion=function(){var ue=k.exec(window.navigator.userAgent);if(ue&&ue.length===2){var K=parseInt(ue[1]);if(!isNaN(K))return K}return null},r.isD3Selection=function(ue){return ue instanceof h.selection},r.ensureSingle=function(ue,K,te,G){var Y=ue.select(K+(te?"."+te:""));if(Y.size())return Y;var ee=ue.append(K);return te&&ee.classed(te,!0),G&&ee.call(G),ee},r.ensureSingleById=function(ue,K,te,G){var Y=ue.select(K+"#"+te);if(Y.size())return Y;var ee=ue.append(K).attr("id",te);return G&&ee.call(G),ee},r.objectFromPath=function(ue,K){for(var te=ue.split("."),G,Y=G={},ee=0;ee<te.length;ee++){var ne=te[ee],J=null,q=te[ee].match(/(.*)\[([0-9]+)\]/);q?(ne=q[1],J=q[2],G=G[ne]=[],ee===te.length-1?G[J]=K:G[J]={},G=G[J]):(ee===te.length-1?G[ne]=K:G[ne]={},G=G[ne])}return Y};var B=/^([^\[\.]+)\.(.+)?/,z=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;r.expandObjectPaths=function(ue){var K,te,G,Y,ee,ne,J;if(typeof ue=="object"&&!Array.isArray(ue))for(te in ue)ue.hasOwnProperty(te)&&((K=te.match(B))?(Y=ue[te],G=K[1],delete ue[te],ue[G]=r.extendDeepNoArrays(ue[G]||{},r.objectFromPath(te,r.expandObjectPaths(Y))[G])):(K=te.match(z))?(Y=ue[te],G=K[1],ee=parseInt(K[2]),delete ue[te],ue[G]=ue[G]||[],K[3]==="."?(J=K[4],ne=ue[G][ee]=ue[G][ee]||{},r.extendDeepNoArrays(ne,r.objectFromPath(J,r.expandObjectPaths(Y)))):ue[G][ee]=r.expandObjectPaths(Y)):ue[te]=r.expandObjectPaths(ue[te]));return ue},r.numSeparate=function(ue,K,te){if(te||(te=!1),typeof K!="string"||K.length===0)throw new Error("Separator string required for formatting!");typeof ue=="number"&&(ue=String(ue));var G=/(\d+)(\d{3})/,Y=K.charAt(0),ee=K.charAt(1),ne=ue.split("."),J=ne[0],q=ne.length>1?Y+ne[1]:"";if(ee&&(ne.length>1||J.length>4||te))for(;G.test(J);)J=J.replace(G,"$1"+ee+"$2");return J+q},r.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var F=/^\w*$/;r.templateString=function(ue,K){var te={};return ue.replace(r.TEMPLATE_STRING_REGEX,function(G,Y){var ee;return F.test(Y)?ee=K[Y]:(te[Y]=te[Y]||r.nestedProperty(K,Y).get,ee=te[Y]()),r.isValidTextValue(ee)?ee:""})};var I={max:10,count:0,name:"hovertemplate"};r.hovertemplateString=function(){return V.apply(I,arguments)};var O={max:10,count:0,name:"texttemplate"};r.texttemplateString=function(){return V.apply(O,arguments)};var N=/^[:|\|]/;function V(ue,K,te){var G=this,Y=arguments;K||(K={});var ee={};return ue.replace(r.TEMPLATE_STRING_REGEX,function(ne,J,q){var ae=J==="xother"||J==="yother",le=J==="_xother"||J==="_yother",ie=J==="_xother_"||J==="_yother_",se=J==="xother_"||J==="yother_",xe=ae||le||se||ie,oe=J;(le||ie)&&(oe=oe.substring(1)),(se||ie)&&(oe=oe.substring(0,oe.length-1));var he;if(xe){if(he=K[oe],he===void 0)return""}else{var be,me;for(me=3;me<Y.length;me++)if(be=Y[me],!!be){if(be.hasOwnProperty(oe)){he=be[oe];break}if(F.test(oe)||(he=r.nestedProperty(be,oe).get(),he=ee[oe]||r.nestedProperty(be,oe).get(),he&&(ee[oe]=he)),he!==void 0)break}}if(he===void 0&&G)return G.count<G.max&&(r.warn("Variable '"+oe+"' in "+G.name+" could not be found!"),he=ne),G.count===G.max&&r.warn("Too many "+G.name+" warnings - additional warnings will be suppressed"),G.count++,ne;if(q){var _e;if(q[0]===":"&&(_e=te?te.numberFormat:r.numberFormat,he=_e(q.replace(N,""))(he)),q[0]==="|"){_e=te?te.timeFormat:u;var Se=r.dateTime2ms(he);he=r.formatDate(Se,q.replace(N,""),!1,_e)}}else{var De=oe+"Label";K.hasOwnProperty(De)&&(he=K[De])}return xe&&(he="("+he+")",(le||ie)&&(he=" "+he),(se||ie)&&(he=he+" ")),he})}var H=48,j=57;r.subplotSort=function(ue,K){for(var te=Math.min(ue.length,K.length)+1,G=0,Y=0,ee=0;ee<te;ee++){var ne=ue.charCodeAt(ee)||0,J=K.charCodeAt(ee)||0,q=ne>=H&&ne<=j,ae=J>=H&&J<=j;if(q&&(G=10*G+ne-H),ae&&(Y=10*Y+J-H),!q||!ae){if(G!==Y)return G-Y;if(ne!==J)return ne-J}}return Y-G};var Z=2e9;r.seedPseudoRandom=function(){Z=2e9},r.pseudoRandom=function(){var ue=Z;return Z=(69069*Z+1)%4294967296,Math.abs(Z-ue)<429496729?r.pseudoRandom():Z/4294967296},r.fillText=function(ue,K,te){var G=Array.isArray(te)?function(ne){te.push(ne)}:function(ne){te.text=ne},Y=r.extractOption(ue,K,"htx","hovertext");if(r.isValidTextValue(Y))return G(Y);var ee=r.extractOption(ue,K,"tx","text");if(r.isValidTextValue(ee))return G(ee)},r.isValidTextValue=function(ue){return ue||ue===0},r.formatPercent=function(ue,K){K=K||0;for(var te=(Math.round(100*ue*Math.pow(10,K))*Math.pow(.1,K)).toFixed(K)+"%",G=0;G<K;G++)te.indexOf(".")!==-1&&(te=te.replace("0%","%"),te=te.replace(".%","%"));return te},r.isHidden=function(ue){var K=window.getComputedStyle(ue).display;return!K||K==="none"},r.strTranslate=function(ue,K){return ue||K?"translate("+ue+","+K+")":""},r.strRotate=function(ue){return ue?"rotate("+ue+")":""},r.strScale=function(ue){return ue!==1?"scale("+ue+")":""},r.getTextTransform=function(ue){var K=ue.noCenter,te=ue.textX,G=ue.textY,Y=ue.targetX,ee=ue.targetY,ne=ue.anchorX||0,J=ue.anchorY||0,q=ue.rotate,ae=ue.scale;return ae?ae>1&&(ae=1):ae=0,r.strTranslate(Y-ae*(te+ne),ee-ae*(G+J))+r.strScale(ae)+(q?"rotate("+q+(K?"":" "+te+" "+G)+")":"")},r.setTransormAndDisplay=function(ue,K){ue.attr("transform",r.getTextTransform(K)),ue.style("display",K.scale?null:"none")},r.ensureUniformFontSize=function(ue,K){var te=r.extendFlat({},K);return te.size=Math.max(K.size,ue._fullLayout.uniformtext.minsize||0),te},r.join2=function(ue,K,te){var G=ue.length;return G>1?ue.slice(0,-1).join(K)+te+ue[G-1]:ue.join(K)},r.bigFont=function(ue){return Math.round(1.2*ue)};var X=r.getFirefoxVersion(),re=X!==null&&X<86;r.getPositionFromD3Event=function(){return re?[h.event.layerX,h.event.layerY]:[h.event.offsetX,h.event.offsetY]}},{"../constants/numerical":491,"./anchor_utils":495,"./angles":496,"./array":497,"./clean_number":498,"./clear_responsive":500,"./coerce":501,"./dates":502,"./dom":503,"./extend":505,"./filter_unique":506,"./filter_visible":507,"./geometry2d":510,"./identity":513,"./increment":514,"./is_plain_object":516,"./keyed_container":517,"./localize":518,"./loggers":519,"./make_trace_groups":520,"./matrix":521,"./mod":522,"./nested_property":523,"./noop":524,"./notifier":525,"./preserve_drawing_buffer":529,"./push_unique":530,"./regex":532,"./relative_attr":533,"./relink_private":534,"./search":535,"./sort_object_keys":538,"./stats":539,"./throttle":542,"./to_log_range":543,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],516:[function(t,P,R){P.exports=function(u){return window&&window.process&&window.process.versions?Object.prototype.toString.call(u)==="[object Object]":Object.prototype.toString.call(u)==="[object Object]"&&Object.getPrototypeOf(u).hasOwnProperty("hasOwnProperty")}},{}],517:[function(t,P,R){var h=t("./nested_property"),u=/^\w*$/,A=0,T=1,e=2,i=3,n=4;P.exports=function(r,f,o,s){o=o||"name",s=s||"value";var m,g,p,v={};f&&f.length?(p=h(r,f),g=p.get()):g=r,f=f||"";var x={};if(g)for(m=0;m<g.length;m++)x[g[m][o]]=m;var l=u.test(s),b={set:function(c,M){var _=M===null?n:A;if(!g){if(!p||_===n)return;g=[],p.set(g)}var y=x[c];if(y===void 0){if(_===n)return;_=_|i,y=g.length,x[c]=y}else M!==(l?g[y][s]:h(g[y],s).get())&&(_=_|e);var w=g[y]=g[y]||{};return w[o]=c,l?w[s]=M:h(w,s).set(M),M!==null&&(_=_&~n),v[y]=v[y]|_,b},get:function(c){if(!!g){var M=x[c];if(M!==void 0)return l?g[M][s]:h(g[M],s).get()}},rename:function(c,M){var _=x[c];return _===void 0||(v[_]=v[_]|T,x[M]=_,delete x[c],g[_][o]=M),b},remove:function(c){var M=x[c];if(M===void 0)return b;var _=g[M];if(Object.keys(_).length>2)return v[M]=v[M]|e,b.set(c,null);if(l){for(m=M;m<g.length;m++)v[m]=v[m]|i;for(m=M;m<g.length;m++)x[g[m][o]]--;g.splice(M,1),delete x[c]}else h(_,s).set(null),v[M]=v[M]|e|n;return b},constructUpdate:function(){for(var c,M,_={},y=Object.keys(v),w=0;w<y.length;w++)M=y[w],c=f+"["+M+"]",g[M]?(v[M]&T&&(_[c+"."+o]=g[M][o]),v[M]&e&&(l?_[c+"."+s]=v[M]&n?null:g[M][s]:_[c+"."+s]=v[M]&n?null:h(g[M],s).get())):_[c]=null;return _}};return b}},{"./nested_property":523}],518:[function(t,P,R){var h=t("../registry");P.exports=function(A,T){for(var e=A._context.locale,i=0;i<2;i++){for(var n=A._context.locales,a=0;a<2;a++){var r=(n[e]||{}).dictionary;if(r){var f=r[T];if(f)return f}n=h.localeRegistry}var o=e.split("-")[0];if(o===e)break;e=o}return T}},{"../registry":647}],519:[function(t,P,R){var h=t("../plot_api/plot_config").dfltConfig,u=t("./notifier"),A=P.exports={};A.log=function(){var T;if(h.logging>1){var e=["LOG:"];for(T=0;T<arguments.length;T++)e.push(arguments[T]);console.trace.apply(console,e)}if(h.notifyOnLogging>1){var i=[];for(T=0;T<arguments.length;T++)i.push(arguments[T]);u(i.join("<br>"),"long")}},A.warn=function(){var T;if(h.logging>0){var e=["WARN:"];for(T=0;T<arguments.length;T++)e.push(arguments[T]);console.trace.apply(console,e)}if(h.notifyOnLogging>0){var i=[];for(T=0;T<arguments.length;T++)i.push(arguments[T]);u(i.join("<br>"),"stick")}},A.error=function(){var T;if(h.logging>0){var e=["ERROR:"];for(T=0;T<arguments.length;T++)e.push(arguments[T]);console.error.apply(console,e)}if(h.notifyOnLogging>0){var i=[];for(T=0;T<arguments.length;T++)i.push(arguments[T]);u(i.join("<br>"),"stick")}}},{"../plot_api/plot_config":553,"./notifier":525}],520:[function(t,P,R){var h=t("@plotly/d3");P.exports=function(A,T,e){var i=A.selectAll("g."+e.replace(/\s/g,".")).data(T,function(a){return a[0].trace.uid});i.exit().remove(),i.enter().append("g").attr("class",e),i.order();var n=A.classed("rangeplot")?"nodeRangePlot3":"node3";return i.each(function(a){a[0][n]=h.select(this)}),i}},{"@plotly/d3":58}],521:[function(t,P,R){var h=t("gl-mat4");R.init2dArray=function(u,A){for(var T=new Array(u),e=0;e<u;e++)T[e]=new Array(A);return T},R.transposeRagged=function(u){var A=0,T=u.length,e,i;for(e=0;e<T;e++)A=Math.max(A,u[e].length);var n=new Array(A);for(e=0;e<A;e++)for(n[e]=new Array(T),i=0;i<T;i++)n[e][i]=u[i][e];return n},R.dot=function(u,A){if(!(u.length&&A.length)||u.length!==A.length)return null;var T=u.length,e,i;if(u[0].length)for(e=new Array(T),i=0;i<T;i++)e[i]=R.dot(u[i],A);else if(A[0].length){var n=R.transposeRagged(A);for(e=new Array(n.length),i=0;i<n.length;i++)e[i]=R.dot(u,n[i])}else for(e=0,i=0;i<T;i++)e+=u[i]*A[i];return e},R.translationMatrix=function(u,A){return[[1,0,u],[0,1,A],[0,0,1]]},R.rotationMatrix=function(u){var A=u*Math.PI/180;return[[Math.cos(A),-Math.sin(A),0],[Math.sin(A),Math.cos(A),0],[0,0,1]]},R.rotationXYMatrix=function(u,A,T){return R.dot(R.dot(R.translationMatrix(A,T),R.rotationMatrix(u)),R.translationMatrix(-A,-T))},R.apply3DTransform=function(u){return function(){var A=arguments,T=arguments.length===1?A[0]:[A[0],A[1],A[2]||0];return R.dot(u,[T[0],T[1],T[2],1]).slice(0,3)}},R.apply2DTransform=function(u){return function(){var A=arguments;A.length===3&&(A=A[0]);var T=arguments.length===1?A[0]:[A[0],A[1]];return R.dot(u,[T[0],T[1],1]).slice(0,2)}},R.apply2DTransform2=function(u){var A=R.apply2DTransform(u);return function(T){return A(T.slice(0,2)).concat(A(T.slice(2,4)))}},R.convertCssMatrix=function(u){if(u){var A=u.length;if(A===16)return u;if(A===6)return[u[0],u[1],0,0,u[2],u[3],0,0,0,0,1,0,u[4],u[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},R.inverseTransformMatrix=function(u){var A=[];return h.invert(A,u),[[A[0],A[1],A[2],A[3]],[A[4],A[5],A[6],A[7]],[A[8],A[9],A[10],A[11]],[A[12],A[13],A[14],A[15]]]}},{"gl-mat4":210}],522:[function(t,P,R){function h(A,T){var e=A%T;return e<0?e+T:e}function u(A,T){return Math.abs(A)>T/2?A-Math.round(A/T)*T:A}P.exports={mod:h,modHalf:u}},{}],523:[function(t,P,R){var h=t("fast-isnumeric"),u=t("./array").isArrayOrTypedArray;P.exports=function(s,m){if(h(m))m=String(m);else if(typeof m!="string"||m.substr(m.length-4)==="[-1]")throw"bad property string";for(var g=0,p=m.split("."),v,x,l;g<p.length;){if(v=String(p[g]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/),v){if(v[1])p[g]=v[1];else if(g===0)p.splice(0,1);else throw"bad property string";for(x=v[2].substr(1,v[2].length-2).split("]["),l=0;l<x.length;l++)g++,p.splice(g,0,Number(x[l]))}g++}return typeof s!="object"?f(s,m,p):{set:i(s,p,m),get:A(s,p),astr:m,parts:p,obj:s}};function A(o,s){return function(){var m=o,g,p,v,x,l;for(x=0;x<s.length-1;x++){if(g=s[x],g===-1){for(p=!0,v=[],l=0;l<m.length;l++)v[l]=A(m[l],s.slice(x+1))(),v[l]!==v[0]&&(p=!1);return p?v[0]:v}if(typeof g=="number"&&!u(m)||(m=m[g],typeof m!="object"||m===null))return}if(!(typeof m!="object"||m===null)&&(v=m[s[x]],v!==null))return v}}var T=/(^|\.)args\[/;function e(o,s){return o===void 0||o===null&&!s.match(T)}function i(o,s,m){return function(g){var p=o,v="",x=e(g,m),l,b;for(b=0;b<s.length-1;b++){if(l=s[b],typeof l=="number"&&!u(p))throw"array index but container is not an array";if(l===-1){if(x=!a(p,s.slice(b+1),g,m),x)break;return}if(!r(p,l,s[b+1],x))break;if(p=p[l],typeof p!="object"||p===null)throw"container is not an object";v=n(v,l)}if(x){if(b===s.length-1&&(delete p[s[b]],Array.isArray(p)&&+s[b]===p.length-1))for(;p.length&&p[p.length-1]===void 0;)p.pop()}else p[s[b]]=g}}function n(o,s){var m=s;return h(s)?m="["+s+"]":o&&(m="."+s),o+m}function a(o,s,m,g){var p=u(m),v=!0,x=m,l=g.replace("-1",0),b=p?!1:e(m,l),c=s[0],M;for(M=0;M<o.length;M++)l=g.replace("-1",M),p&&(x=m[M%m.length],b=e(x,l)),b&&(v=!1),r(o,M,c,b)&&i(o[M],s,g.replace("-1",M))(x);return v}function r(o,s,m,g){if(o[s]===void 0){if(g)return!1;typeof m=="number"?o[s]=[]:o[s]={}}return!0}function f(o,s,m){return{set:function(){throw"bad container"},get:function(){},astr:s,parts:m,obj:o}}},{"./array":497,"fast-isnumeric":190}],524:[function(t,P,R){P.exports=function(){}},{}],525:[function(t,P,R){var h=t("@plotly/d3"),u=t("fast-isnumeric"),A=[];P.exports=function(T,e){if(A.indexOf(T)!==-1)return;A.push(T);var i=1e3;u(e)?i=e:e==="long"&&(i=3e3);var n=h.select("body").selectAll(".plotly-notifier").data([0]);n.enter().append("div").classed("plotly-notifier",!0);var a=n.selectAll(".notifier-note").data(A);function r(f){f.duration(700).style("opacity",0).each("end",function(o){var s=A.indexOf(o);s!==-1&&A.splice(s,1),h.select(this).remove()})}a.enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(f){var o=h.select(this);o.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){o.transition().call(r)});for(var s=o.append("p"),m=f.split(/<br\s*\/?>/g),g=0;g<m.length;g++)g&&s.append("br"),s.append("span").text(m[g]);e==="stick"?o.transition().duration(350).style("opacity",1):o.transition().duration(700).style("opacity",1).transition().delay(i).call(r)})}},{"@plotly/d3":58,"fast-isnumeric":190}],526:[function(t,P,R){var h=t("./setcursor"),u="data-savedcursor",A="!!";P.exports=function(e,i){var n=e.attr(u);if(i){if(!n){for(var a=(e.attr("class")||"").split(" "),r=0;r<a.length;r++){var f=a[r];f.indexOf("cursor-")===0&&e.attr(u,f.substr(7)).classed(f,!1)}e.attr(u)||e.attr(u,A)}h(e,i)}else n&&(e.attr(u,null),n===A?h(e):h(e,n))}},{"./setcursor":536}],527:[function(t,P,R){var h=t("./matrix").dot,u=t("../constants/numerical").BADNUM,A=P.exports={};A.tester=function(e){var i=e.slice(),n=i[0][0],a=n,r=i[0][1],f=r,o;for((i[i.length-1][0]!==i[0][0]||i[i.length-1][1]!==i[0][1])&&i.push(i[0]),o=1;o<i.length;o++)n=Math.min(n,i[o][0]),a=Math.max(a,i[o][0]),r=Math.min(r,i[o][1]),f=Math.max(f,i[o][1]);var s=!1,m;i.length===5&&(i[0][0]===i[1][0]?i[2][0]===i[3][0]&&i[0][1]===i[3][1]&&i[1][1]===i[2][1]&&(s=!0,m=function(l){return l[0]===i[0][0]}):i[0][1]===i[1][1]&&i[2][1]===i[3][1]&&i[0][0]===i[3][0]&&i[1][0]===i[2][0]&&(s=!0,m=function(l){return l[1]===i[0][1]}));function g(l,b){var c=l[0],M=l[1];return!(c===u||c<n||c>a||M===u||M<r||M>f||b&&m(l))}function p(l,b){var c=l[0],M=l[1];if(c===u||c<n||c>a||M===u||M<r||M>f)return!1;var _=i.length,y=i[0][0],w=i[0][1],d=0,C,S,E,k,B;for(C=1;C<_;C++)if(S=y,E=w,y=i[C][0],w=i[C][1],k=Math.min(S,y),!(c<k||c>Math.max(S,y)||M>Math.max(E,w)))if(M<Math.min(E,w))c!==k&&d++;else{if(y===S?B=M:B=E+(c-S)*(w-E)/(y-S),M===B)return!(C===1&&b);M<=B&&c!==k&&d++}return d%2===1}var v=!0,x=i[0];for(o=1;o<i.length;o++)if(x[0]!==i[o][0]||x[1]!==i[o][1]){v=!1;break}return{xmin:n,xmax:a,ymin:r,ymax:f,pts:i,contains:s?g:p,isRect:s,degenerate:v}},A.isSegmentBent=function(e,i,n,a){var r=e[i],f=[e[n][0]-r[0],e[n][1]-r[1]],o=h(f,f),s=Math.sqrt(o),m=[-f[1]/s,f[0]/s],g,p,v;for(g=i+1;g<n;g++)if(p=[e[g][0]-r[0],e[g][1]-r[1]],v=h(p,f),v<0||v>o||Math.abs(h(p,m))>a)return!0;return!1},A.filter=function(e,i){var n=[e[0]],a=0,r=0;function f(s){e.push(s);var m=n.length,g=a;n.splice(r+1);for(var p=g+1;p<e.length;p++)(p===e.length-1||A.isSegmentBent(e,g,p+1,i))&&(n.push(e[p]),n.length<m-2&&(a=p,r=n.length-1),g=p)}if(e.length>1){var o=e.pop();f(o)}return{addPt:f,raw:e,filtered:n}}},{"../constants/numerical":491,"./matrix":521}],528:[function(t,P,R){(function(h){(function(){var u=t("./show_no_webgl_msg"),A=t("regl");P.exports=function(e,i,n){var a=e._fullLayout,r=!0;return a._glcanvas.each(function(f){if(f.regl){f.regl.preloadCachedCode(n);return}if(!(f.pick&&!a._has("parcoords"))){try{f.regl=A({canvas:this,attributes:{antialias:!f.pick,preserveDrawingBuffer:!0},pixelRatio:e._context.plotGlPixelRatio||h.devicePixelRatio,extensions:i||[],cachedCode:n||{}})}catch{r=!1}f.regl||(r=!1),r&&this.addEventListener("webglcontextlost",function(o){e&&e.emit&&e.emit("plotly_webglcontextlost",{event:o,layer:f.key})},!1)}}),r||u({container:a._glcontainer.node()}),r}}).call(this)}).call(this,typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{"./show_no_webgl_msg":537,regl:284}],529:[function(t,P,R){var h=t("fast-isnumeric"),u=t("is-mobile");P.exports=function(e){var i;if(e&&e.hasOwnProperty("userAgent")?i=e.userAgent:i=A(),typeof i!="string")return!0;var n=u({ua:{headers:{"user-agent":i}},tablet:!0,featureDetect:!1});if(!n)for(var a=i.split(" "),r=1;r<a.length;r++){var f=a[r];if(f.indexOf("Safari")!==-1)for(var o=r-1;o>-1;o--){var s=a[o];if(s.substr(0,8)==="Version/"){var m=s.substr(8).split(".")[0];if(h(m)&&(m=+m),m>=13)return!0}}}return n};function A(){var T;return typeof navigator<"u"&&(T=navigator.userAgent),T&&T.headers&&typeof T.headers["user-agent"]=="string"&&(T=T.headers["user-agent"]),T}},{"fast-isnumeric":190,"is-mobile":234}],530:[function(t,P,R){P.exports=function(u,A){if(A instanceof RegExp){for(var T=A.toString(),e=0;e<u.length;e++)if(u[e]instanceof RegExp&&u[e].toString()===T)return u;u.push(A)}else(A||A===0)&&u.indexOf(A)===-1&&u.push(A);return u}},{}],531:[function(t,P,R){var h=t("../lib"),u=t("../plot_api/plot_config").dfltConfig;function A(e,i){for(var n=[],a,r=0;r<i.length;r++)a=i[r],a===e?n[r]=a:typeof a=="object"?n[r]=Array.isArray(a)?h.extendDeep([],a):h.extendDeepAll({},a):n[r]=a;return n}var T={};T.add=function(e,i,n,a,r){var f,o;if(e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},o=e.undoQueue.index,e.autoplay){e.undoQueue.inSequence||(e.autoplay=!1);return}!e.undoQueue.sequence||e.undoQueue.beginSequence?(f={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},e.undoQueue.queue.splice(o,e.undoQueue.queue.length-o,f),e.undoQueue.index+=1):f=e.undoQueue.queue[o-1],e.undoQueue.beginSequence=!1,f&&(f.undo.calls.unshift(i),f.undo.args.unshift(n),f.redo.calls.push(a),f.redo.args.push(r)),e.undoQueue.queue.length>u.queueLength&&(e.undoQueue.queue.shift(),e.undoQueue.index--)},T.startSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!0,e.undoQueue.beginSequence=!0},T.stopSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!1,e.undoQueue.beginSequence=!1},T.undo=function(i){var n,a;if(!(i.undoQueue===void 0||isNaN(i.undoQueue.index)||i.undoQueue.index<=0)){for(i.undoQueue.index--,n=i.undoQueue.queue[i.undoQueue.index],i.undoQueue.inSequence=!0,a=0;a<n.undo.calls.length;a++)T.plotDo(i,n.undo.calls[a],n.undo.args[a]);i.undoQueue.inSequence=!1,i.autoplay=!1}},T.redo=function(i){var n,a;if(!(i.undoQueue===void 0||isNaN(i.undoQueue.index)||i.undoQueue.index>=i.undoQueue.queue.length)){for(n=i.undoQueue.queue[i.undoQueue.index],i.undoQueue.inSequence=!0,a=0;a<n.redo.calls.length;a++)T.plotDo(i,n.redo.calls[a],n.redo.args[a]);i.undoQueue.inSequence=!1,i.autoplay=!1,i.undoQueue.index++}},T.plotDo=function(e,i,n){e.autoplay=!0,n=A(e,n),i.apply(null,n)},P.exports=T},{"../lib":515,"../plot_api/plot_config":553}],532:[function(t,P,R){R.counter=function(h,u,A,T){var e=(u||"")+(A?"":"$"),i=T===!1?"":"^";return h==="xy"?new RegExp(i+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(i+h+"([2-9]|[1-9][0-9]+)?"+e)}},{}],533:[function(t,P,R){var h=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,u=/^[^\.\[\]]+$/;P.exports=function(A,T){for(;T;){var e=A.match(h);if(e)A=e[1];else if(A.match(u))A="";else throw new Error("bad relativeAttr call:"+[A,T]);if(T.charAt(0)==="^")T=T.slice(1);else break}return A&&T.charAt(0)!=="["?A+"."+T:A+T}},{}],534:[function(t,P,R){var h=t("./array").isArrayOrTypedArray,u=t("./is_plain_object");P.exports=function A(T,e){for(var i in e){var n=e[i],a=T[i];if(a!==n)if(i.charAt(0)==="_"||typeof n=="function"){if(i in T)continue;T[i]=n}else if(h(n)&&h(a)&&u(n[0])){if(i==="customdata"||i==="ids")continue;for(var r=Math.min(n.length,a.length),f=0;f<r;f++)a[f]!==n[f]&&u(n[f])&&u(a[f])&&A(a[f],n[f])}else u(n)&&u(a)&&(A(a,n),Object.keys(a).length||delete T[i])}}},{"./array":497,"./is_plain_object":516}],535:[function(t,P,R){var h=t("fast-isnumeric"),u=t("./loggers"),A=t("./identity"),T=t("../constants/numerical").BADNUM,e=1e-9;R.findBin=function(f,o,s){if(h(o.start))return s?Math.ceil((f-o.start)/o.size-e)-1:Math.floor((f-o.start)/o.size+e);var m=0,g=o.length,p=0,v=g>1?(o[g-1]-o[0])/(g-1):1,x,l;for(v>=0?l=s?i:n:l=s?r:a,f+=v*e*(s?-1:1)*(v>=0?1:-1);m<g&&p++<100;)x=Math.floor((m+g)/2),l(o[x],f)?m=x+1:g=x;return p>90&&u.log("Long binary search..."),m-1};function i(f,o){return f<o}function n(f,o){return f<=o}function a(f,o){return f>o}function r(f,o){return f>=o}R.sorterAsc=function(f,o){return f-o},R.sorterDes=function(f,o){return o-f},R.distinctVals=function(f){var o=f.slice();o.sort(R.sorterAsc);var s;for(s=o.length-1;s>-1&&o[s]===T;s--);for(var m=o[s]-o[0]||1,g=m/(s||1)/1e4,p=[],v,x=0;x<=s;x++){var l=o[x],b=l-v;v===void 0?(p.push(l),v=l):b>g&&(m=Math.min(m,b),p.push(l),v=l)}return{vals:p,minDiff:m}},R.roundUp=function(f,o,s){for(var m=0,g=o.length-1,p,v=0,x=s?0:1,l=s?1:0,b=s?Math.ceil:Math.floor;m<g&&v++<100;)p=b((m+g)/2),o[p]<=f?m=p+x:g=p-l;return o[m]},R.sort=function(f,o){for(var s=0,m=0,g=1;g<f.length;g++){var p=o(f[g],f[g-1]);if(p<0?s=1:p>0&&(m=1),s&&m)return f.sort(o)}return m?f:f.reverse()},R.findIndexOfMin=function(f,o){o=o||A;for(var s=1/0,m,g=0;g<f.length;g++){var p=o(f[g]);p<s&&(s=p,m=g)}return m}},{"../constants/numerical":491,"./identity":513,"./loggers":519,"fast-isnumeric":190}],536:[function(t,P,R){P.exports=function(u,A){(u.attr("class")||"").split(" ").forEach(function(T){T.indexOf("cursor-")===0&&u.classed(T,!1)}),A&&u.classed("cursor-"+A,!0)}},{}],537:[function(t,P,R){var h=t("../components/color"),u=function(){};P.exports=function(T){for(var e in T)typeof T[e]=="function"&&(T[e]=u);T.destroy=function(){T.container.parentNode.removeChild(T.container)};var i=document.createElement("div");i.className="no-webgl",i.style.cursor="pointer",i.style.fontSize="24px",i.style.color=h.defaults[0],i.style.position="absolute",i.style.left=i.style.top="0px",i.style.width=i.style.height="100%",i.style["background-color"]=h.lightLine,i.style["z-index"]=30;var n=document.createElement("p");return n.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",n.style.position="relative",n.style.top="50%",n.style.left="50%",n.style.height="30%",n.style.width="50%",n.style.margin="-15% 0 0 -25%",i.appendChild(n),T.container.appendChild(i),T.container.style.background="#FFFFFF",T.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":367}],538:[function(t,P,R){P.exports=function(u){return Object.keys(u).sort()}},{}],539:[function(t,P,R){var h=t("fast-isnumeric"),u=t("./array").isArrayOrTypedArray;R.aggNums=function(A,T,e,i){var n,a;if((!i||i>e.length)&&(i=e.length),h(T)||(T=!1),u(e[0])){for(a=new Array(i),n=0;n<i;n++)a[n]=R.aggNums(A,T,e[n]);e=a}for(n=0;n<i;n++)h(T)?h(e[n])&&(T=A(+T,+e[n])):T=e[n];return T},R.len=function(A){return R.aggNums(function(T){return T+1},0,A)},R.mean=function(A,T){return T||(T=R.len(A)),R.aggNums(function(e,i){return e+i},0,A)/T},R.midRange=function(A){if(!(A===void 0||A.length===0))return(R.aggNums(Math.max,null,A)+R.aggNums(Math.min,null,A))/2},R.variance=function(A,T,e){return T||(T=R.len(A)),h(e)||(e=R.mean(A,T)),R.aggNums(function(i,n){return i+Math.pow(n-e,2)},0,A)/T},R.stdev=function(A,T,e){return Math.sqrt(R.variance(A,T,e))},R.median=function(A){var T=A.slice().sort();return R.interp(T,.5)},R.interp=function(A,T){if(!h(T))throw"n should be a finite number";if(T=T*A.length-.5,T<0)return A[0];if(T>A.length-1)return A[A.length-1];var e=T%1;return e*A[Math.ceil(T)]+(1-e)*A[Math.floor(T)]}},{"./array":497,"fast-isnumeric":190}],540:[function(t,P,R){var h=t("color-normalize");function u(A){return A?h(A):[0,0,0,1]}P.exports=u},{"color-normalize":89}],541:[function(t,P,R){var h=t("@plotly/d3"),u=t("../lib"),A=u.strTranslate,T=t("../constants/xmlns_namespaces"),e=t("../constants/alignment").LINE_SPACING,i=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;R.convertToTspans=function(N,V,H){var j=N.text(),Z=!N.attr("data-notex")&&V&&V._context.typesetMath&&typeof MathJax<"u"&&j.match(i),X=h.select(N.node().parentNode);if(X.empty())return;var re=N.attr("class")?N.attr("class").split(" ")[0]:"text";re+="-math",X.selectAll("svg."+re).remove(),X.selectAll("g."+re+"-group").remove(),N.style("display",null).attr({"data-unformatted":j,"data-math":"N"});function ue(){X.empty()||(re=N.attr("class")+"-math",X.select("svg."+re).remove()),N.text("").style("white-space","pre");var K=z(N.node(),j);K&&N.style("pointer-events","all"),R.positionText(N),H&&H.call(N)}return Z?(V&&V._promises||[]).push(new Promise(function(K){N.style("display","none");var te=parseInt(N.node().style.fontSize,10),G={fontSize:te};o(Z[2],G,function(Y,ee,ne){X.selectAll("svg."+re).remove(),X.selectAll("g."+re+"-group").remove();var J=Y&&Y.select("svg");if(!J||!J.node()){ue(),K();return}var q=X.append("g").classed(re+"-group",!0).attr({"pointer-events":"none","data-unformatted":j,"data-math":"Y"});q.node().appendChild(J.node()),ee&&ee.node()&&J.node().insertBefore(ee.node().cloneNode(!0),J.node().firstChild);var ae=ne.width,le=ne.height;J.attr({class:re,height:le,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var ie=N.node().style.fill||"black",se=J.select("g");se.attr({fill:ie,stroke:ie});var xe=se.node().getBoundingClientRect(),oe=xe.width,he=xe.height;(oe>ae||he>le)&&(J.style("overflow","hidden"),xe=J.node().getBoundingClientRect(),oe=xe.width,he=xe.height);var be=+N.attr("x"),me=+N.attr("y"),_e=te||N.node().getBoundingClientRect().height,Se=-_e/4;if(re[0]==="y")q.attr({transform:"rotate("+[-90,be,me]+")"+A(-oe/2,Se-he/2)});else if(re[0]==="l")me=Se-he/2;else if(re[0]==="a"&&re.indexOf("atitle")!==0)be=0,me=Se;else{var De=N.attr("text-anchor");be=be-oe*(De==="middle"?.5:De==="end"?1:0),me=me+Se-he/2}J.attr({x:be,y:me}),H&&H.call(N,q),K(q)})})):ue(),N};var n=/(<|&lt;|&#60;)/g,a=/(>|&gt;|&#62;)/g;function r(N){return N.replace(n,"\\lt ").replace(a,"\\gt ")}var f=[["$","$"],["\\(","\\)"]];function o(N,V,H){var j=parseInt((MathJax.version||"").split(".")[0]);if(j!==2&&j!==3){u.warn("No MathJax version:",MathJax.version);return}var Z,X,re,ue,K=function(){return X=u.extendDeepAll({},MathJax.Hub.config),re=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:f},displayAlign:"left"})},te=function(){X=u.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=f},G=function(){if(Z=MathJax.Hub.config.menuSettings.renderer,Z!=="SVG")return MathJax.Hub.setRenderer("SVG")},Y=function(){Z=MathJax.config.startup.output,Z!=="svg"&&(MathJax.config.startup.output="svg")},ee=function(){var ie="math-output-"+u.randstr({},64);ue=h.select("body").append("div").attr({id:ie}).style({visibility:"hidden",position:"absolute","font-size":V.fontSize+"px"}).text(r(N));var se=ue.node();return j===2?MathJax.Hub.Typeset(se):MathJax.typeset([se])},ne=function(){var ie=ue.select(j===2?".MathJax_SVG":".MathJax"),se=!ie.empty()&&ue.select("svg").node();if(!se)u.log("There was an error in the tex syntax.",N),H();else{var xe=se.getBoundingClientRect(),oe;j===2?oe=h.select("body").select("#MathJax_SVG_glyphs"):oe=ie.select("defs"),H(ie,oe,xe)}ue.remove()},J=function(){if(Z!=="SVG")return MathJax.Hub.setRenderer(Z)},q=function(){Z!=="svg"&&(MathJax.config.startup.output=Z)},ae=function(){return re!==void 0&&(MathJax.Hub.processSectionDelay=re),MathJax.Hub.Config(X)},le=function(){MathJax.config=X};j===2?MathJax.Hub.Queue(K,G,ee,ne,J,ae):j===3&&(te(),Y(),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){ee(),ne(),q(),le()}))}var s={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},m={sub:"0.3em",sup:"-0.6em"},g={sub:"-0.21em",sup:"0.42em"},p="\u200B",v=["http:","https:","mailto:","",void 0,":"],x=R.NEWLINES=/(\r\n?|\n)/g,l=/(<[^<>]*>)/,b=/<(\/?)([^ >]*)(\s+(.*))?>/i,c=/<br(\s+.*)?>/i;R.BR_TAG_ALL=/<br(\s+.*)?>/gi;var M=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,_=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,y=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,w=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function d(N,V){if(!N)return null;var H=N.match(V),j=H&&(H[3]||H[4]);return j&&k(j)}var C=/(^|;)\s*color:/;R.plainText=function(N,V){V=V||{};for(var H=V.len!==void 0&&V.len!==-1?V.len:1/0,j=V.allowedTags!==void 0?V.allowedTags:["br"],Z="...",X=Z.length,re=N.split(l),ue=[],K="",te=0,G=0;G<re.length;G++){var Y=re[G],ee=Y.match(b),ne=ee&&ee[2].toLowerCase();if(ne)j.indexOf(ne)!==-1&&(ue.push(Y),K=ne);else{var J=Y.length;if(te+J<H)ue.push(Y),te+=J;else if(te<H){var q=H-te;K&&(K!=="br"||q<=X||J<=X)&&ue.pop(),H>X?ue.push(Y.substr(0,q-X)+Z):ue.push(Y.substr(0,q));break}K=""}}return ue.join("")};var S={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},E=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function k(N){return N.replace(E,function(V,H){var j;return H.charAt(0)==="#"?j=B(H.charAt(1)==="x"?parseInt(H.substr(2),16):parseInt(H.substr(1),10)):j=S[H],j||V})}R.convertEntities=k;function B(N){if(!(N>1114111)){var V=String.fromCodePoint;if(V)return V(N);var H=String.fromCharCode;return N<=65535?H(N):H((N>>10)+55232,N%1024+56320)}}function z(N,V){V=V.replace(x," ");var H=!1,j=[],Z,X=-1;function re(){X++;var he=document.createElementNS(T.svg,"tspan");h.select(he).attr({class:"line",dy:X*e+"em"}),N.appendChild(he),Z=he;var be=j;if(j=[{node:he}],be.length>1)for(var me=1;me<be.length;me++)ue(be[me])}function ue(he){var be=he.type,me={},_e;if(be==="a"){_e="a";var Se=he.target,De=he.href,Ie=he.popup;De&&(me={"xlink:xlink:show":Se==="_blank"||Se.charAt(0)!=="_"?"new":"replace",target:Se,"xlink:xlink:href":De},Ie&&(me.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Ie+'");return false;'))}else _e="tspan";he.style&&(me.style=he.style);var Te=document.createElementNS(T.svg,_e);if(be==="sup"||be==="sub"){K(Z,p),Z.appendChild(Te);var Ce=document.createElementNS(T.svg,"tspan");K(Ce,p),h.select(Ce).attr("dy",g[be]),me.dy=m[be],Z.appendChild(Te),Z.appendChild(Ce)}else Z.appendChild(Te);h.select(Te).attr(me),Z=he.node=Te,j.push(he)}function K(he,be){he.appendChild(document.createTextNode(be))}function te(he){if(j.length===1){u.log("Ignoring unexpected end tag </"+he+">.",V);return}var be=j.pop();he!==be.type&&u.log("Start tag <"+be.type+"> doesnt match end tag <"+he+">. Pretending it did match.",V),Z=j[j.length-1].node}var G=c.test(V);G?re():(Z=N,j=[{node:N}]);for(var Y=V.split(l),ee=0;ee<Y.length;ee++){var ne=Y[ee],J=ne.match(b),q=J&&J[2].toLowerCase(),ae=s[q];if(q==="br")re();else if(ae===void 0)K(Z,k(ne));else if(J[1])te(q);else{var le=J[4],ie={type:q},se=d(le,M);if(se?(se=se.replace(C,"$1 fill:"),ae&&(se+=";"+ae)):ae&&(se=ae),se&&(ie.style=se),q==="a"){H=!0;var xe=d(le,_);if(xe){var oe=F(xe);oe&&(ie.href=oe,ie.target=d(le,y)||"_blank",ie.popup=d(le,w))}}ue(ie)}}return H}function F(N){var V=encodeURI(decodeURI(N)),H=document.createElement("a"),j=document.createElement("a");H.href=N,j.href=V;var Z=H.protocol,X=j.protocol;return v.indexOf(Z)!==-1&&v.indexOf(X)!==-1?V:""}R.sanitizeHTML=function(V){V=V.replace(x," ");for(var H=document.createElement("p"),j=H,Z=[],X=V.split(l),re=0;re<X.length;re++){var ue=X[re],K=ue.match(b),te=K&&K[2].toLowerCase();if(te in s)if(K[1])Z.length&&(j=Z.pop());else{var G=K[4],Y=d(G,M),ee=Y?{style:Y}:{};if(te==="a"){var ne=d(G,_);if(ne){var J=F(ne);if(J){ee.href=J;var q=d(G,y);q&&(ee.target=q)}}}var ae=document.createElement(te);j.appendChild(ae),h.select(ae).attr(ee),j=ae,Z.push(ae)}else j.appendChild(document.createTextNode(k(ue)))}var le="innerHTML";return H[le]},R.lineCount=function(V){return V.selectAll("tspan.line").size()||1},R.positionText=function(V,H,j){return V.each(function(){var Z=h.select(this);function X(K,te){return te===void 0?(te=Z.attr(K),te===null&&(Z.attr(K,0),te=0)):Z.attr(K,te),te}var re=X("x",H),ue=X("y",j);this.nodeName==="text"&&Z.selectAll("tspan.line").attr({x:re,y:ue})})};function I(N,V,H){var j=H.horizontalAlign,Z=H.verticalAlign||"top",X=N.node().getBoundingClientRect(),re=V.node().getBoundingClientRect(),ue,K,te;return Z==="bottom"?K=function(){return X.bottom-ue.height}:Z==="middle"?K=function(){return X.top+(X.height-ue.height)/2}:K=function(){return X.top},j==="right"?te=function(){return X.right-ue.width}:j==="center"?te=function(){return X.left+(X.width-ue.width)/2}:te=function(){return X.left},function(){ue=this.node().getBoundingClientRect();var G=te()-re.left,Y=K()-re.top,ee=H.gd||{};if(H.gd){ee._fullLayout._calcInverseTransform(ee);var ne=u.apply3DTransform(ee._fullLayout._invTransform)(G,Y);G=ne[0],Y=ne[1]}return this.style({top:Y+"px",left:G+"px","z-index":1e3}),this}}var O="1px ";R.makeTextShadow=function(N){var V=O,H=O,j=O;return V+H+j+N+", -"+V+"-"+H+j+N+", "+V+"-"+H+j+N+", -"+V+H+j+N},R.makeEditable=function(N,V){var H=V.gd,j=V.delegate,Z=h.dispatch("edit","input","cancel"),X=j||N;if(N.style({"pointer-events":j?"none":"all"}),N.size()!==1)throw new Error("boo");function re(){K(),N.style({opacity:0});var te=X.attr("class"),G;te?G="."+te.split(" ")[0]+"-math-group":G="[class*=-math-group]",G&&h.select(N.node().parentNode).select(G).style({opacity:0})}function ue(te){var G=te.node(),Y=document.createRange();Y.selectNodeContents(G);var ee=window.getSelection();ee.removeAllRanges(),ee.addRange(Y),G.focus()}function K(){var te=h.select(H),G=te.select(".svg-container"),Y=G.append("div"),ee=N.node().style,ne=parseFloat(ee.fontSize||12),J=V.text;J===void 0&&(J=N.attr("data-unformatted")),Y.classed("plugin-editable editable",!0).style({position:"absolute","font-family":ee.fontFamily||"Arial","font-size":ne,color:V.fill||ee.fill||"black",opacity:1,"background-color":V.background||"transparent",outline:"#ffffff33 1px solid",margin:[-ne/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(J).call(I(N,G,V)).on("blur",function(){H._editing=!1,N.text(this.textContent).style({opacity:1});var q=h.select(this).attr("class"),ae;q?ae="."+q.split(" ")[0]+"-math-group":ae="[class*=-math-group]",ae&&h.select(N.node().parentNode).select(ae).style({opacity:0});var le=this.textContent;h.select(this).transition().duration(0).remove(),h.select(document).on("mouseup",null),Z.edit.call(N,le)}).on("focus",function(){var q=this;H._editing=!0,h.select(document).on("mouseup",function(){if(h.event.target===q)return!1;document.activeElement===Y.node()&&Y.node().blur()})}).on("keyup",function(){h.event.which===27?(H._editing=!1,N.style({opacity:1}),h.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),Z.cancel.call(N,this.textContent)):(Z.input.call(N,this.textContent),h.select(this).call(I(N,G,V)))}).on("keydown",function(){h.event.which===13&&this.blur()}).call(ue)}return V.immediate?re():X.on("click",re),h.rebind(N,Z,"on")}},{"../constants/alignment":483,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],542:[function(t,P,R){var h={};R.throttle=function(T,e,i){var n=h[T],a=Date.now();if(!n){for(var r in h)h[r].ts<a-6e4&&delete h[r];n=h[T]={ts:0,timer:null}}u(n);function f(){i(),n.ts=Date.now(),n.onDone&&(n.onDone(),n.onDone=null)}if(a>n.ts+e){f();return}n.timer=setTimeout(function(){f(),n.timer=null},e)},R.done=function(A){var T=h[A];return!T||!T.timer?Promise.resolve():new Promise(function(e){var i=T.onDone;T.onDone=function(){i&&i(),e(),T.onDone=null}})},R.clear=function(A){if(A)u(h[A]),delete h[A];else for(var T in h)R.clear(T)};function u(A){A&&A.timer!==null&&(clearTimeout(A.timer),A.timer=null)}},{}],543:[function(t,P,R){var h=t("fast-isnumeric");P.exports=function(A,T){if(A>0)return Math.log(A)/Math.LN10;var e=Math.log(Math.min(T[0],T[1]))/Math.LN10;return h(e)||(e=Math.log(Math.max(T[0],T[1]))/Math.LN10-6),e}},{"fast-isnumeric":190}],544:[function(t,P,R){var h=P.exports={},u=t("../plots/geo/constants").locationmodeToLayer,A=t("topojson-client").feature;h.getTopojsonName=function(T){return[T.scope.replace(/ /g,"-"),"_",T.resolution.toString(),"m"].join("")},h.getTopojsonPath=function(T,e){return T+e+".json"},h.getTopojsonFeatures=function(T,e){var i=u[T.locationmode],n=e.objects[i];return A(e,n).features}},{"../plots/geo/constants":596,"topojson-client":316}],545:[function(t,P,R){P.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],546:[function(t,P,R){P.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],547:[function(t,P,R){var h=t("../registry");P.exports=function(A){for(var T=h.layoutArrayContainers,e=h.layoutArrayRegexes,i=A.split("[")[0],n,a,r=0;r<e.length;r++)if(a=A.match(e[r]),a&&a.index===0){n=a[0];break}if(n||(n=T[T.indexOf(i)]),!n)return!1;var f=A.substr(n.length);return f?(a=f.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/),a?{array:n,index:Number(a[1]),property:a[3]||""}:!1):{array:n,index:"",property:""}}},{"../registry":647}],548:[function(t,P,R){var h=t("../lib"),u=h.extendFlat,A=h.isPlainObject,T={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},i=T.flags.slice().concat(["fullReplot"]),n=e.flags.slice().concat("layoutReplot");P.exports={traces:T,layout:e,traceFlags:function(){return a(i)},layoutFlags:function(){return a(n)},update:function(o,s){var m=s.editType;if(m&&m!=="none")for(var g=m.split("+"),p=0;p<g.length;p++)o[g[p]]=!0},overrideAll:r};function a(o){for(var s={},m=0;m<o.length;m++)s[o[m]]=!1;return s}function r(o,s,m){var g=u({},o);for(var p in g){var v=g[p];A(v)&&(g[p]=f(v,s,m,p))}return m==="from-root"&&(g.editType=s),g}function f(o,s,m,g){if(o.valType){var p=u({},o);if(p.editType=s,Array.isArray(o.items)){p.items=new Array(o.items.length);for(var v=0;v<o.items.length;v++)p.items[v]=f(o.items[v],s)}return p}else return r(o,s,g.charAt(0)==="_"?"nested":"from-root")}},{"../lib":515}],549:[function(t,P,R){var h=t("fast-isnumeric"),u=t("gl-mat4/fromQuat"),A=t("../registry"),T=t("../lib"),e=t("../plots/plots"),i=t("../plots/cartesian/axis_ids"),n=t("../components/color"),a=i.cleanId,r=i.getFromTrace,f=A.traceIs;R.clearPromiseQueue=function(c){Array.isArray(c._promises)&&c._promises.length>0&&T.log("Clearing previous rejected promises from queue."),c._promises=[]},R.cleanLayout=function(c){var M,_;c||(c={}),c.xaxis1&&(c.xaxis||(c.xaxis=c.xaxis1),delete c.xaxis1),c.yaxis1&&(c.yaxis||(c.yaxis=c.yaxis1),delete c.yaxis1),c.scene1&&(c.scene||(c.scene=c.scene1),delete c.scene1);var y=(e.subplotsRegistry.cartesian||{}).attrRegex,w=(e.subplotsRegistry.polar||{}).attrRegex,d=(e.subplotsRegistry.ternary||{}).attrRegex,C=(e.subplotsRegistry.gl3d||{}).attrRegex,S=Object.keys(c);for(M=0;M<S.length;M++){var E=S[M];if(y&&y.test(E)){var k=c[E];k.anchor&&k.anchor!=="free"&&(k.anchor=a(k.anchor)),k.overlaying&&(k.overlaying=a(k.overlaying)),k.type||(k.isdate?k.type="date":k.islog?k.type="log":k.isdate===!1&&k.islog===!1&&(k.type="linear")),(k.autorange==="withzero"||k.autorange==="tozero")&&(k.autorange=!0,k.rangemode="tozero"),delete k.islog,delete k.isdate,delete k.categories,v(k,"domain")&&delete k.domain,k.autotick!==void 0&&(k.tickmode===void 0&&(k.tickmode=k.autotick?"auto":"linear"),delete k.autotick),s(k)}else if(w&&w.test(E)){var B=c[E];s(B.radialaxis)}else if(d&&d.test(E)){var z=c[E];s(z.aaxis),s(z.baxis),s(z.caxis)}else if(C&&C.test(E)){var F=c[E],I=F.cameraposition;if(Array.isArray(I)&&I[0].length===4){var O=I[0],N=I[1],V=I[2],H=u([],O),j=[];for(_=0;_<3;++_)j[_]=N[_]+V*H[2+4*_];F.camera={eye:{x:j[0],y:j[1],z:j[2]},center:{x:N[0],y:N[1],z:N[2]},up:{x:0,y:0,z:1}},delete F.cameraposition}s(F.xaxis),s(F.yaxis),s(F.zaxis)}}var Z=Array.isArray(c.annotations)?c.annotations.length:0;for(M=0;M<Z;M++){var X=c.annotations[M];!T.isPlainObject(X)||(X.ref&&(X.ref==="paper"?(X.xref="paper",X.yref="paper"):X.ref==="data"&&(X.xref="x",X.yref="y"),delete X.ref),o(X,"xref"),o(X,"yref"))}var re=Array.isArray(c.shapes)?c.shapes.length:0;for(M=0;M<re;M++){var ue=c.shapes[M];!T.isPlainObject(ue)||(o(ue,"xref"),o(ue,"yref"))}var K=Array.isArray(c.images)?c.images.length:0;for(M=0;M<K;M++){var te=c.images[M];!T.isPlainObject(te)||(o(te,"xref"),o(te,"yref"))}var G=c.legend;return G&&(G.x>3?(G.x=1.02,G.xanchor="left"):G.x<-2&&(G.x=-.02,G.xanchor="right"),G.y>3?(G.y=1.02,G.yanchor="bottom"):G.y<-2&&(G.y=-.02,G.yanchor="top")),s(c),c.dragmode==="rotate"&&(c.dragmode="orbit"),n.clean(c),c.template&&c.template.layout&&R.cleanLayout(c.template.layout),c};function o(c,M){var _=c[M],y=M.charAt(0);_&&_!=="paper"&&(c[M]=a(_,y,!0))}function s(c){c&&((typeof c.title=="string"||typeof c.title=="number")&&(c.title={text:c.title}),M("titlefont","font"),M("titleposition","position"),M("titleside","side"),M("titleoffset","offset"));function M(_,y){var w=c[_],d=c.title&&c.title[y];w&&!d&&(c.title||(c.title={}),c.title[y]=c[_],delete c[_])}}R.cleanData=function(c){for(var M=0;M<c.length;M++){var _=c[M],y;if(_.type==="histogramy"&&"xbins"in _&&!("ybins"in _)&&(_.ybins=_.xbins,delete _.xbins),_.error_y&&"opacity"in _.error_y){var w=n.defaults,d=_.error_y.color||(f(_,"bar")?n.defaultLine:w[M%w.length]);_.error_y.color=n.addOpacity(n.rgb(d),n.opacity(d)*_.error_y.opacity),delete _.error_y.opacity}if("bardir"in _&&(_.bardir==="h"&&(f(_,"bar")||_.type.substr(0,9)==="histogram")&&(_.orientation="h",R.swapXYData(_)),delete _.bardir),_.type==="histogramy"&&R.swapXYData(_),(_.type==="histogramx"||_.type==="histogramy")&&(_.type="histogram"),"scl"in _&&!("colorscale"in _)&&(_.colorscale=_.scl,delete _.scl),"reversescl"in _&&!("reversescale"in _)&&(_.reversescale=_.reversescl,delete _.reversescl),_.xaxis&&(_.xaxis=a(_.xaxis,"x")),_.yaxis&&(_.yaxis=a(_.yaxis,"y")),f(_,"gl3d")&&_.scene&&(_.scene=e.subplotsRegistry.gl3d.cleanId(_.scene)),!f(_,"pie-like")&&!f(_,"bar-like"))if(Array.isArray(_.textposition))for(y=0;y<_.textposition.length;y++)_.textposition[y]=p(_.textposition[y]);else _.textposition&&(_.textposition=p(_.textposition));var C=A.getModule(_);if(C&&C.colorbar){var S=C.colorbar.container,E=S?_[S]:_;E&&E.colorscale&&(E.colorscale==="YIGnBu"&&(E.colorscale="YlGnBu"),E.colorscale==="YIOrRd"&&(E.colorscale="YlOrRd"))}if(_.type==="surface"&&T.isPlainObject(_.contours)){var k=["x","y","z"];for(y=0;y<k.length;y++){var B=_.contours[k[y]];!T.isPlainObject(B)||(B.highlightColor&&(B.highlightcolor=B.highlightColor,delete B.highlightColor),B.highlightWidth&&(B.highlightwidth=B.highlightWidth,delete B.highlightWidth))}}if(_.type==="candlestick"||_.type==="ohlc"){var z=(_.increasing||{}).showlegend!==!1,F=(_.decreasing||{}).showlegend!==!1,I=m(_.increasing),O=m(_.decreasing);if(I!==!1&&O!==!1){var N=g(I,O,z,F);N&&(_.name=N)}else(I||O)&&!_.name&&(_.name=I||O)}if(Array.isArray(_.transforms)){var V=_.transforms;for(y=0;y<V.length;y++){var H=V[y];if(!!T.isPlainObject(H))switch(H.type){case"filter":H.filtersrc&&(H.target=H.filtersrc,delete H.filtersrc),H.calendar&&(H.valuecalendar||(H.valuecalendar=H.calendar),delete H.calendar);break;case"groupby":if(H.styles=H.styles||H.style,H.styles&&!Array.isArray(H.styles)){var j=H.styles,Z=Object.keys(j);H.styles=[];for(var X=0;X<Z.length;X++)H.styles.push({target:Z[X],value:j[Z[X]]})}break}}}v(_,"line")&&delete _.line,"marker"in _&&(v(_.marker,"line")&&delete _.marker.line,v(_,"marker")&&delete _.marker),n.clean(_),_.autobinx&&(delete _.autobinx,delete _.xbins),_.autobiny&&(delete _.autobiny,delete _.ybins),s(_),_.colorbar&&s(_.colorbar),_.marker&&_.marker.colorbar&&s(_.marker.colorbar),_.line&&_.line.colorbar&&s(_.line.colorbar),_.aaxis&&s(_.aaxis),_.baxis&&s(_.baxis)}};function m(c){if(!T.isPlainObject(c))return!1;var M=c.name;return delete c.name,delete c.showlegend,(typeof M=="string"||typeof M=="number")&&String(M)}function g(c,M,_,y){if(_&&!y)return c;if(y&&!_||!c.trim())return M;if(!M.trim())return c;var w=Math.min(c.length,M.length),d;for(d=0;d<w&&c.charAt(d)===M.charAt(d);d++);var C=c.substr(0,d);return C.trim()}function p(c){var M="middle",_="center";return typeof c=="string"&&(c.indexOf("top")!==-1?M="top":c.indexOf("bottom")!==-1&&(M="bottom"),c.indexOf("left")!==-1?_="left":c.indexOf("right")!==-1&&(_="right")),M+" "+_}function v(c,M){return M in c&&typeof c[M]=="object"&&Object.keys(c[M]).length===0}R.swapXYData=function(c){var M;if(T.swapAttrs(c,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(c.z)&&Array.isArray(c.z[0])&&(c.transpose?delete c.transpose:c.transpose=!0),c.error_x&&c.error_y){var _=c.error_y,y="copy_ystyle"in _?_.copy_ystyle:!(_.color||_.thickness||_.width);T.swapAttrs(c,["error_?.copy_ystyle"]),y&&T.swapAttrs(c,["error_?.color","error_?.thickness","error_?.width"])}if(typeof c.hoverinfo=="string"){var w=c.hoverinfo.split("+");for(M=0;M<w.length;M++)w[M]==="x"?w[M]="y":w[M]==="y"&&(w[M]="x");c.hoverinfo=w.join("+")}},R.coerceTraceIndices=function(c,M){if(h(M))return[M];if(!Array.isArray(M)||!M.length)return c.data.map(function(w,d){return d});if(Array.isArray(M)){for(var _=[],y=0;y<M.length;y++)T.isIndex(M[y],c.data.length)?_.push(M[y]):T.warn("trace index (",M[y],") is not a number or is out of bounds");return _}return M},R.manageArrayContainers=function(c,M,_){var y=c.obj,w=c.parts,d=w.length,C=w[d-1],S=h(C);if(S&&M===null){var E=w.slice(0,d-1).join("."),k=T.nestedProperty(y,E).get();k.splice(C,1)}else S&&c.get()===void 0&&c.get()===void 0&&(_[c.astr]=null),c.set(M)};var x=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function l(c){var M=c.search(x);if(M>0)return c.substr(0,M)}R.hasParent=function(c,M){for(var _=l(M);_;){if(_ in c)return!0;_=l(_)}return!1};var b=["x","y","z"];R.clearAxisTypes=function(c,M,_){for(var y=0;y<M.length;y++)for(var w=c._fullData[y],d=0;d<3;d++){var C=r(c,w,b[d]);if(C&&C.type!=="log"){var S=C._name,E=C._id.substr(1);if(E.substr(0,5)==="scene"){if(_[E]!==void 0)continue;S=E+"."+S}var k=S+".type";_[S]===void 0&&_[k]===void 0&&T.nestedProperty(c.layout,k).set(null)}}}},{"../components/color":367,"../lib":515,"../plots/cartesian/axis_ids":570,"../plots/plots":628,"../registry":647,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],550:[function(t,P,R){var h=t("./plot_api");R._doPlot=h._doPlot,R.newPlot=h.newPlot,R.restyle=h.restyle,R.relayout=h.relayout,R.redraw=h.redraw,R.update=h.update,R._guiRestyle=h._guiRestyle,R._guiRelayout=h._guiRelayout,R._guiUpdate=h._guiUpdate,R._storeDirectGUIEdit=h._storeDirectGUIEdit,R.react=h.react,R.extendTraces=h.extendTraces,R.prependTraces=h.prependTraces,R.addTraces=h.addTraces,R.deleteTraces=h.deleteTraces,R.moveTraces=h.moveTraces,R.purge=h.purge,R.addFrames=h.addFrames,R.deleteFrames=h.deleteFrames,R.animate=h.animate,R.setPlotConfig=h.setPlotConfig,R.toImage=t("./to_image"),R.validate=t("./validate"),R.downloadImage=t("../snapshot/download");var u=t("./template_api");R.makeTemplate=u.makeTemplate,R.validateTemplate=u.validateTemplate},{"../snapshot/download":649,"./plot_api":552,"./template_api":557,"./to_image":558,"./validate":559}],551:[function(t,P,R){var h=t("../lib/is_plain_object"),u=t("../lib/noop"),A=t("../lib/loggers"),T=t("../lib/search").sorterAsc,e=t("../registry");R.containerArrayMatch=t("./container_array_match");var i=R.isAddVal=function(r){return r==="add"||h(r)},n=R.isRemoveVal=function(r){return r===null||r==="remove"};R.applyContainerArrayChanges=function(r,f,o,s,m){var g=f.astr,p=e.getComponentMethod(g,"supplyLayoutDefaults"),v=e.getComponentMethod(g,"draw"),x=e.getComponentMethod(g,"drawOne"),l=s.replot||s.recalc||p===u||v===u,b=r.layout,c=r._fullLayout;if(o[""]){Object.keys(o).length>1&&A.warn("Full array edits are incompatible with other edits",g);var M=o[""][""];if(n(M))f.set(null);else if(Array.isArray(M))f.set(M);else return A.warn("Unrecognized full array edit value",g,M),!0;return l?!1:(p(b,c),v(r),!0)}var _=Object.keys(o).map(Number).sort(T),y=f.get(),w=y||[],d=m(c,g).get(),C=[],S=-1,E=w.length,k,B,z,F,I,O,N,V;for(k=0;k<_.length;k++){if(z=_[k],F=o[z],I=Object.keys(F),O=F[""],N=i(O),z<0||z>w.length-(N?0:1)){A.warn("index out of range",g,z);continue}if(O!==void 0)I.length>1&&A.warn("Insertion & removal are incompatible with edits to the same index.",g,z),n(O)?C.push(z):N?(O==="add"&&(O={}),w.splice(z,0,O),d&&d.splice(z,0,{})):A.warn("Unrecognized full object edit value",g,z,O),S===-1&&(S=z);else for(B=0;B<I.length;B++)V=g+"["+z+"].",m(w[z],I[B],V).set(F[I[B]])}for(k=C.length-1;k>=0;k--)w.splice(C[k],1),d&&d.splice(C[k],1);if(w.length?y||f.set(w):f.set(null),l)return!1;if(p(b,c),x!==u){var H;if(S===-1)H=_;else{for(E=Math.max(w.length,E),H=[],k=0;k<_.length&&(z=_[k],!(z>=S));k++)H.push(z);for(k=S;k<E;k++)H.push(k)}for(k=0;k<H.length;k++)x(r,H[k])}else v(r);return!0}},{"../lib/is_plain_object":516,"../lib/loggers":519,"../lib/noop":524,"../lib/search":535,"../registry":647,"./container_array_match":547}],552:[function(t,P,R){var h=t("@plotly/d3"),u=t("fast-isnumeric"),A=t("has-hover"),T=t("../lib"),e=T.nestedProperty,i=t("../lib/events"),n=t("../lib/queue"),a=t("../registry"),r=t("./plot_schema"),f=t("../plots/plots"),o=t("../plots/cartesian/axes"),s=t("../components/drawing"),m=t("../components/color"),g=t("../plots/cartesian/graph_interact").initInteractions,p=t("../constants/xmlns_namespaces"),v=t("../components/selections").clearOutline,x=t("./plot_config").dfltConfig,l=t("./manage_arrays"),b=t("./helpers"),c=t("./subroutines"),M=t("./edit_types"),_=t("../plots/cartesian/constants").AX_NAME_PATTERN,y=0,w=5;function d(Ee,Ge,Je,qe){var Tt;if(Ee=T.getGraphDiv(Ee),i.init(Ee),T.isPlainObject(Ge)){var mt=Ge;Ge=mt.data,Je=mt.layout,qe=mt.config,Tt=mt.frames}var Mt=i.triggerHandler(Ee,"plotly_beforeplot",[Ge,Je,qe]);if(Mt===!1)return Promise.reject();!Ge&&!Je&&!T.isPlotDiv(Ee)&&T.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",Ee);function Ht(){if(Tt)return R.addFrames(Ee,Tt)}B(Ee,qe),Je||(Je={}),h.select(Ee).classed("js-plotly-plot",!0),s.makeTester(),Array.isArray(Ee._promises)||(Ee._promises=[]);var Rt=(Ee.data||[]).length===0&&Array.isArray(Ge);Array.isArray(Ge)&&(b.cleanData(Ge),Rt?Ee.data=Ge:Ee.data.push.apply(Ee.data,Ge),Ee.empty=!1),(!Ee.layout||Rt)&&(Ee.layout=b.cleanLayout(Je)),f.supplyDefaults(Ee);var Vt=Ee._fullLayout,Jt=Vt._has("cartesian");Vt._replotting=!0,(Rt||Vt._shouldCreateBgLayer)&&(Ye(Ee),Vt._shouldCreateBgLayer&&delete Vt._shouldCreateBgLayer),s.initGradients(Ee),s.initPatterns(Ee),Rt&&o.saveShowSpikeInitial(Ee);var Yt=!Ee.calcdata||Ee.calcdata.length!==(Ee._fullData||[]).length;Yt&&f.doCalcdata(Ee);for(var or=0;or<Ee.calcdata.length;or++)Ee.calcdata[or][0].trace=Ee._fullData[or];Ee._context.responsive?Ee._responsiveChartHandler||(Ee._responsiveChartHandler=function(){T.isHidden(Ee)||f.resize(Ee)},window.addEventListener("resize",Ee._responsiveChartHandler)):T.clearResponsive(Ee);var Hr=T.extendFlat({},Vt._size),an=0;function Kr(){for(var ft=Vt._basePlotModules,St=0;St<ft.length;St++)ft[St].drawFramework&&ft[St].drawFramework(Ee);!Vt._glcanvas&&Vt._has("gl")&&(Vt._glcanvas=Vt._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(it){return it.key}),Vt._glcanvas.enter().append("canvas").attr("class",function(it){return"gl-canvas gl-canvas-"+it.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var Ut=Ee._context.plotGlPixelRatio;if(Vt._glcanvas){Vt._glcanvas.attr("width",Vt.width*Ut).attr("height",Vt.height*Ut).style("width",Vt.width+"px").style("height",Vt.height+"px");var Pe=Vt._glcanvas.data()[0].regl;if(Pe&&(Math.floor(Vt.width*Ut)!==Pe._gl.drawingBufferWidth||Math.floor(Vt.height*Ut)!==Pe._gl.drawingBufferHeight)){var ke="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(an)T.error(ke);else return T.log(ke+" Clearing graph and plotting again."),f.cleanPlot([],{},Ee._fullData,Vt),f.supplyDefaults(Ee),Vt=Ee._fullLayout,f.doCalcdata(Ee),an++,Kr()}}return Vt.modebar.orientation==="h"?Vt._modebardiv.style("height",null).style("width","100%"):Vt._modebardiv.style("width",null).style("height",Vt.height+"px"),f.previousPromises(Ee)}function ot(){if(f.clearAutoMarginIds(Ee),c.drawMarginPushers(Ee),o.allowAutoMargin(Ee),Vt._has("pie"))for(var ft=Ee._fullData,St=0;St<ft.length;St++){var Ut=ft[St];Ut.type==="pie"&&Ut.automargin&&f.allowAutoMargin(Ee,"pie."+Ut.uid+".automargin")}return f.doAutoMargin(Ee),f.previousPromises(Ee)}function er(){if(!!f.didMarginChange(Hr,Vt._size))return T.syncOrAsync([ot,c.layoutStyles],Ee)}function Kt(){if(!Yt){ur();return}return T.syncOrAsync([a.getComponentMethod("shapes","calcAutorange"),a.getComponentMethod("annotations","calcAutorange"),ur],Ee)}function ur(){Ee._transitioning||(c.doAutoRangeAndConstraints(Ee),Rt&&o.saveRangeInitial(Ee),a.getComponentMethod("rangeslider","calcAutorange")(Ee))}function Ar(){return o.draw(Ee,Rt?"":"redraw")}var et=[f.previousPromises,Ht,Kr,ot,er];Jt&&et.push(Kt),et.push(c.layoutStyles),Jt&&et.push(Ar,function(St){St._fullLayout._insideTickLabelsAutorange&&ie(St,St._fullLayout._insideTickLabelsAutorange).then(function(){St._fullLayout._insideTickLabelsAutorange=void 0})}),et.push(c.drawData,c.finalDraw,g,f.addLinks,f.rehover,f.redrag,f.reselect,f.doAutoMargin,$e,f.previousPromises);function $e(ft){ft._fullLayout._insideTickLabelsAutorange&&Rt&&o.saveRangeInitial(ft,!0)}var st=T.syncOrAsync(et,Ee);return(!st||!st.then)&&(st=Promise.resolve()),st.then(function(){return C(Ee),Ee})}function C(Ee){var Ge=Ee._fullLayout;Ge._redrawFromAutoMarginCount?Ge._redrawFromAutoMarginCount--:Ee.emit("plotly_afterplot")}function S(Ee){return T.extendFlat(x,Ee)}function E(Ee,Ge){try{Ee._fullLayout._paper.style("background",Ge)}catch(Je){T.error(Je)}}function k(Ee,Ge){var Je=m.combine(Ge,"white");E(Ee,Je)}function B(Ee,Ge){if(!Ee._context){Ee._context=T.extendDeep({},x);var Je=h.select("base");Ee._context._baseUrl=Je.size()&&Je.attr("href")?window.location.href.split("#")[0]:""}var qe=Ee._context,Tt,mt,Mt;if(Ge){for(mt=Object.keys(Ge),Tt=0;Tt<mt.length;Tt++)Mt=mt[Tt],!(Mt==="editable"||Mt==="edits")&&Mt in qe&&(Mt==="setBackground"&&Ge[Mt]==="opaque"?qe[Mt]=k:qe[Mt]=Ge[Mt]);Ge.plot3dPixelRatio&&!qe.plotGlPixelRatio&&(qe.plotGlPixelRatio=qe.plot3dPixelRatio);var Ht=Ge.editable;if(Ht!==void 0)for(qe.editable=Ht,mt=Object.keys(qe.edits),Tt=0;Tt<mt.length;Tt++)qe.edits[mt[Tt]]=Ht;if(Ge.edits)for(mt=Object.keys(Ge.edits),Tt=0;Tt<mt.length;Tt++)Mt=mt[Tt],Mt in qe.edits&&(qe.edits[Mt]=Ge.edits[Mt]);qe._exportedPlot=Ge._exportedPlot}qe.staticPlot&&(qe.editable=!1,qe.edits={},qe.autosizable=!1,qe.scrollZoom=!1,qe.doubleClick=!1,qe.showTips=!1,qe.showLink=!1,qe.displayModeBar=!1),qe.displayModeBar==="hover"&&!A&&(qe.displayModeBar=!0),(qe.setBackground==="transparent"||typeof qe.setBackground!="function")&&(qe.setBackground=E),qe._hasZeroHeight=qe._hasZeroHeight||Ee.clientHeight===0,qe._hasZeroWidth=qe._hasZeroWidth||Ee.clientWidth===0;var Rt=qe.scrollZoom,Vt=qe._scrollZoom={};if(Rt===!0)Vt.cartesian=1,Vt.gl3d=1,Vt.geo=1,Vt.mapbox=1;else if(typeof Rt=="string"){var Jt=Rt.split("+");for(Tt=0;Tt<Jt.length;Tt++)Vt[Jt[Tt]]=1}else Rt!==!1&&(Vt.gl3d=1,Vt.geo=1,Vt.mapbox=1)}function z(Ee){if(Ee=T.getGraphDiv(Ee),!T.isPlotDiv(Ee))throw new Error("This element is not a Plotly plot: "+Ee);return b.cleanData(Ee.data),b.cleanLayout(Ee.layout),Ee.calcdata=void 0,R._doPlot(Ee).then(function(){return Ee.emit("plotly_redraw"),Ee})}function F(Ee,Ge,Je,qe){return Ee=T.getGraphDiv(Ee),f.cleanPlot([],{},Ee._fullData||[],Ee._fullLayout||{}),f.purge(Ee),R._doPlot(Ee,Ge,Je,qe)}function I(Ee,Ge){var Je=Ge+1,qe=[],Tt,mt;for(Tt=0;Tt<Ee.length;Tt++)mt=Ee[Tt],mt<0?qe.push(Je+mt):qe.push(mt);return qe}function O(Ee,Ge,Je){var qe,Tt;for(qe=0;qe<Ge.length;qe++){if(Tt=Ge[qe],Tt!==parseInt(Tt,10))throw new Error("all values in "+Je+" must be integers");if(Tt>=Ee.data.length||Tt<-Ee.data.length)throw new Error(Je+" must be valid indices for gd.data.");if(Ge.indexOf(Tt,qe+1)>-1||Tt>=0&&Ge.indexOf(-Ee.data.length+Tt)>-1||Tt<0&&Ge.indexOf(Ee.data.length+Tt)>-1)throw new Error("each index in "+Je+" must be unique.")}}function N(Ee,Ge,Je){if(!Array.isArray(Ee.data))throw new Error("gd.data must be an array.");if(typeof Ge>"u")throw new Error("currentIndices is a required argument.");if(Array.isArray(Ge)||(Ge=[Ge]),O(Ee,Ge,"currentIndices"),typeof Je<"u"&&!Array.isArray(Je)&&(Je=[Je]),typeof Je<"u"&&O(Ee,Je,"newIndices"),typeof Je<"u"&&Ge.length!==Je.length)throw new Error("current and new indices must be of equal length.")}function V(Ee,Ge,Je){var qe,Tt;if(!Array.isArray(Ee.data))throw new Error("gd.data must be an array.");if(typeof Ge>"u")throw new Error("traces must be defined.");for(Array.isArray(Ge)||(Ge=[Ge]),qe=0;qe<Ge.length;qe++)if(Tt=Ge[qe],typeof Tt!="object"||Array.isArray(Tt)||Tt===null)throw new Error("all values in traces array must be non-array objects");if(typeof Je<"u"&&!Array.isArray(Je)&&(Je=[Je]),typeof Je<"u"&&Je.length!==Ge.length)throw new Error("if indices is specified, traces.length must equal indices.length")}function H(Ee,Ge,Je,qe){var Tt=T.isPlainObject(qe);if(!Array.isArray(Ee.data))throw new Error("gd.data must be an array");if(!T.isPlainObject(Ge))throw new Error("update must be a key:value object");if(typeof Je>"u")throw new Error("indices must be an integer or array of integers");O(Ee,Je,"indices");for(var mt in Ge){if(!Array.isArray(Ge[mt])||Ge[mt].length!==Je.length)throw new Error("attribute "+mt+" must be an array of length equal to indices array length");if(Tt&&(!(mt in qe)||!Array.isArray(qe[mt])||qe[mt].length!==Ge[mt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}function j(Ee,Ge,Je,qe){var Tt=T.isPlainObject(qe),mt=[],Mt,Ht,Rt,Vt,Jt;Array.isArray(Je)||(Je=[Je]),Je=I(Je,Ee.data.length-1);for(var Yt in Ge)for(var or=0;or<Je.length;or++){if(Mt=Ee.data[Je[or]],Rt=e(Mt,Yt),Ht=Rt.get(),Vt=Ge[Yt][or],!T.isArrayOrTypedArray(Vt))throw new Error("attribute: "+Yt+" index: "+or+" must be an array");if(!T.isArrayOrTypedArray(Ht))throw new Error("cannot extend missing or non-array attribute: "+Yt);if(Ht.constructor!==Vt.constructor)throw new Error("cannot extend array with an array of a different type: "+Yt);Jt=Tt?qe[Yt][or]:qe,u(Jt)||(Jt=-1),mt.push({prop:Rt,target:Ht,insert:Vt,maxp:Math.floor(Jt)})}return mt}function Z(Ee,Ge,Je,qe,Tt){H(Ee,Ge,Je,qe);for(var mt=j(Ee,Ge,Je,qe),Mt={},Ht={},Rt=0;Rt<mt.length;Rt++){var Vt=mt[Rt].prop,Jt=mt[Rt].maxp,Yt=Tt(mt[Rt].target,mt[Rt].insert,Jt);Vt.set(Yt[0]),Array.isArray(Mt[Vt.astr])||(Mt[Vt.astr]=[]),Mt[Vt.astr].push(Yt[1]),Array.isArray(Ht[Vt.astr])||(Ht[Vt.astr]=[]),Ht[Vt.astr].push(mt[Rt].target.length)}return{update:Mt,maxPoints:Ht}}function X(Ee,Ge){var Je=new Ee.constructor(Ee.length+Ge.length);return Je.set(Ee),Je.set(Ge,Ee.length),Je}function re(Ee,Ge,Je,qe){Ee=T.getGraphDiv(Ee);function Tt(Rt,Vt,Jt){var Yt,or;if(T.isTypedArray(Rt))if(Jt<0){var Hr=new Rt.constructor(0),an=X(Rt,Vt);Jt<0?(Yt=an,or=Hr):(Yt=Hr,or=an)}else if(Yt=new Rt.constructor(Jt),or=new Rt.constructor(Rt.length+Vt.length-Jt),Jt===Vt.length)Yt.set(Vt),or.set(Rt);else if(Jt<Vt.length){var Kr=Vt.length-Jt;Yt.set(Vt.subarray(Kr)),or.set(Rt),or.set(Vt.subarray(0,Kr),Rt.length)}else{var ot=Jt-Vt.length,er=Rt.length-ot;Yt.set(Rt.subarray(er)),Yt.set(Vt,ot),or.set(Rt.subarray(0,er))}else Yt=Rt.concat(Vt),or=Jt>=0&&Jt<Yt.length?Yt.splice(0,Yt.length-Jt):[];return[Yt,or]}var mt=Z(Ee,Ge,Je,qe,Tt),Mt=R.redraw(Ee),Ht=[Ee,mt.update,Je,mt.maxPoints];return n.add(Ee,R.prependTraces,Ht,re,arguments),Mt}function ue(Ee,Ge,Je,qe){Ee=T.getGraphDiv(Ee);function Tt(Rt,Vt,Jt){var Yt,or;if(T.isTypedArray(Rt))if(Jt<=0){var Hr=new Rt.constructor(0),an=X(Vt,Rt);Jt<0?(Yt=an,or=Hr):(Yt=Hr,or=an)}else if(Yt=new Rt.constructor(Jt),or=new Rt.constructor(Rt.length+Vt.length-Jt),Jt===Vt.length)Yt.set(Vt),or.set(Rt);else if(Jt<Vt.length){var Kr=Vt.length-Jt;Yt.set(Vt.subarray(0,Kr)),or.set(Vt.subarray(Kr)),or.set(Rt,Kr)}else{var ot=Jt-Vt.length;Yt.set(Vt),Yt.set(Rt.subarray(0,ot),Vt.length),or.set(Rt.subarray(ot))}else Yt=Vt.concat(Rt),or=Jt>=0&&Jt<Yt.length?Yt.splice(Jt,Yt.length):[];return[Yt,or]}var mt=Z(Ee,Ge,Je,qe,Tt),Mt=R.redraw(Ee),Ht=[Ee,mt.update,Je,mt.maxPoints];return n.add(Ee,R.extendTraces,Ht,ue,arguments),Mt}function K(Ee,Ge,Je){Ee=T.getGraphDiv(Ee);var qe=[],Tt=R.deleteTraces,mt=K,Mt=[Ee,qe],Ht=[Ee,Ge],Rt,Vt;for(V(Ee,Ge,Je),Array.isArray(Ge)||(Ge=[Ge]),Ge=Ge.map(function(Jt){return T.extendFlat({},Jt)}),b.cleanData(Ge),Rt=0;Rt<Ge.length;Rt++)Ee.data.push(Ge[Rt]);for(Rt=0;Rt<Ge.length;Rt++)qe.push(-Ge.length+Rt);if(typeof Je>"u")return Vt=R.redraw(Ee),n.add(Ee,Tt,Mt,mt,Ht),Vt;Array.isArray(Je)||(Je=[Je]);try{N(Ee,qe,Je)}catch(Jt){throw Ee.data.splice(Ee.data.length-Ge.length,Ge.length),Jt}return n.startSequence(Ee),n.add(Ee,Tt,Mt,mt,Ht),Vt=R.moveTraces(Ee,qe,Je),n.stopSequence(Ee),Vt}function te(Ee,Ge){Ee=T.getGraphDiv(Ee);var Je=[],qe=R.addTraces,Tt=te,mt=[Ee,Je,Ge],Mt=[Ee,Ge],Ht,Rt;if(typeof Ge>"u")throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Ge)||(Ge=[Ge]),O(Ee,Ge,"indices"),Ge=I(Ge,Ee.data.length-1),Ge.sort(T.sorterDes),Ht=0;Ht<Ge.length;Ht+=1)Rt=Ee.data.splice(Ge[Ht],1)[0],Je.push(Rt);var Vt=R.redraw(Ee);return n.add(Ee,qe,mt,Tt,Mt),Vt}function G(Ee,Ge,Je){Ee=T.getGraphDiv(Ee);var qe=[],Tt=[],mt=G,Mt=G,Ht=[Ee,Je,Ge],Rt=[Ee,Ge,Je],Vt;if(N(Ee,Ge,Je),Ge=Array.isArray(Ge)?Ge:[Ge],typeof Je>"u")for(Je=[],Vt=0;Vt<Ge.length;Vt++)Je.push(-Ge.length+Vt);for(Je=Array.isArray(Je)?Je:[Je],Ge=I(Ge,Ee.data.length-1),Je=I(Je,Ee.data.length-1),Vt=0;Vt<Ee.data.length;Vt++)Ge.indexOf(Vt)===-1&&qe.push(Ee.data[Vt]);for(Vt=0;Vt<Ge.length;Vt++)Tt.push({newIndex:Je[Vt],trace:Ee.data[Ge[Vt]]});for(Tt.sort(function(Yt,or){return Yt.newIndex-or.newIndex}),Vt=0;Vt<Tt.length;Vt+=1)qe.splice(Tt[Vt].newIndex,0,Tt[Vt].trace);Ee.data=qe;var Jt=R.redraw(Ee);return n.add(Ee,mt,Ht,Mt,Rt),Jt}function Y(Ee,Ge,Je,qe){Ee=T.getGraphDiv(Ee),b.clearPromiseQueue(Ee);var Tt={};if(typeof Ge=="string")Tt[Ge]=Je;else if(T.isPlainObject(Ge))Tt=T.extendFlat({},Ge),qe===void 0&&(qe=Je);else return T.warn("Restyle fail.",Ge,Je,qe),Promise.reject();Object.keys(Tt).length&&(Ee.changed=!0);var mt=b.coerceTraceIndices(Ee,qe),Mt=ae(Ee,Tt,mt),Ht=Mt.flags;Ht.calc&&(Ee.calcdata=void 0),Ht.clearAxisTypes&&b.clearAxisTypes(Ee,mt,{});var Rt=[];Ht.fullReplot?Rt.push(R._doPlot):(Rt.push(f.previousPromises),f.supplyDefaults(Ee),Ht.markerSize&&(f.doCalcdata(Ee),xe(Rt)),Ht.style&&Rt.push(c.doTraceStyle),Ht.colorbars&&Rt.push(c.doColorBars),Rt.push(C)),Rt.push(f.rehover,f.redrag,f.reselect),n.add(Ee,Y,[Ee,Mt.undoit,Mt.traces],Y,[Ee,Mt.redoit,Mt.traces]);var Vt=T.syncOrAsync(Rt,Ee);return(!Vt||!Vt.then)&&(Vt=Promise.resolve()),Vt.then(function(){return Ee.emit("plotly_restyle",Mt.eventData),Ee})}function ee(Ee){return Ee===void 0?null:Ee}function ne(Ee,Ge){return Ge?function(Je,qe,Tt){var mt=e(Je,qe),Mt=mt.set;return mt.set=function(Ht){var Rt=(Tt||"")+qe;J(Rt,mt.get(),Ht,Ee),Mt(Ht)},mt}:e}function J(Ee,Ge,Je,qe){if(Array.isArray(Ge)||Array.isArray(Je))for(var Tt=Array.isArray(Ge)?Ge:[],mt=Array.isArray(Je)?Je:[],Mt=Math.max(Tt.length,mt.length),Ht=0;Ht<Mt;Ht++)J(Ee+"["+Ht+"]",Tt[Ht],mt[Ht],qe);else if(T.isPlainObject(Ge)||T.isPlainObject(Je)){var Rt=T.isPlainObject(Ge)?Ge:{},Vt=T.isPlainObject(Je)?Je:{},Jt=T.extendFlat({},Rt,Vt);for(var Yt in Jt)J(Ee+"."+Yt,Rt[Yt],Vt[Yt],qe)}else qe[Ee]===void 0&&(qe[Ee]=ee(Ge))}function q(Ee,Ge,Je){for(var qe in Je){var Tt=e(Ee,qe);J(qe,Tt.get(),Je[qe],Ge)}}function ae(Ee,Ge,Je){var qe=Ee._fullLayout,Tt=Ee._fullData,mt=Ee.data,Mt=qe._guiEditing,Ht=ne(qe._preGUI,Mt),Rt=T.extendDeepAll({},Ge),Vt;le(Ge);var Jt=M.traceFlags(),Yt={},or={},Hr;function an(){return Je.map(function(){})}function Kr(jt){var sr=o.id2name(jt);Hr.indexOf(sr)===-1&&Hr.push(sr)}function ot(jt){return"LAYOUT"+jt+".autorange"}function er(jt){return"LAYOUT"+jt+".range"}function Kt(jt){for(var sr=jt;sr<Tt.length;sr++)if(Tt[sr]._input===mt[jt])return Tt[sr]}function ur(jt,sr,zr){if(Array.isArray(jt)){jt.forEach(function(Wr){ur(Wr,sr,zr)});return}if(!(jt in Ge||b.hasParent(Ge,jt))){var Ur;if(jt.substr(0,6)==="LAYOUT")Ur=Ht(Ee.layout,jt.replace("LAYOUT",""));else{var Dr=Je[zr],Tr=qe._tracePreGUI[Kt(Dr)._fullInput.uid];Ur=ne(Tr,Mt)(mt[Dr],jt)}jt in or||(or[jt]=an()),or[jt][zr]===void 0&&(or[jt][zr]=ee(Ur.get())),sr!==void 0&&Ur.set(sr)}}function Ar(jt){return function(sr){return Tt[sr][jt]}}function et(jt){return function(sr,zr){return sr===!1?Tt[Je[zr]][jt]:null}}for(var $e in Ge){if(b.hasParent(Ge,$e))throw new Error("cannot set "+$e+" and a parent attribute simultaneously");var st=Ge[$e],ft,St,Ut,Pe,ke,it;if(($e==="autobinx"||$e==="autobiny")&&($e=$e.charAt($e.length-1)+"bins",Array.isArray(st)?st=st.map(et($e)):st===!1?st=Je.map(Ar($e)):st=null),Yt[$e]=st,$e.substr(0,6)==="LAYOUT"){Ut=Ht(Ee.layout,$e.replace("LAYOUT","")),or[$e]=[ee(Ut.get())],Ut.set(Array.isArray(st)?st[0]:st),Jt.calc=!0;continue}for(or[$e]=an(),Vt=0;Vt<Je.length;Vt++){ft=mt[Je[Vt]],St=Kt(Je[Vt]);var ut=qe._tracePreGUI[St._fullInput.uid];if(Ut=ne(ut,Mt)(ft,$e),Pe=Ut.get(),ke=Array.isArray(st)?st[Vt%st.length]:st,ke!==void 0){var ht=Ut.parts[Ut.parts.length-1],Et=$e.substr(0,$e.length-ht.length-1),yt=Et?Et+".":"",Dt=Et?e(St,Et).get():St;if(it=r.getTraceValObject(St,Ut.parts),it&&it.impliedEdits&&ke!==null)for(var Xt in it.impliedEdits)ur(T.relativeAttr($e,Xt),it.impliedEdits[Xt],Vt);else if((ht==="thicknessmode"||ht==="lenmode")&&Pe!==ke&&(ke==="fraction"||ke==="pixels")&&Dt){var ar=qe._size,kr=Dt.orient,wr=kr==="top"||kr==="bottom";if(ht==="thicknessmode"){var Sr=wr?ar.h:ar.w;ur(yt+"thickness",Dt.thickness*(ke==="fraction"?1/Sr:Sr),Vt)}else{var Zr=wr?ar.w:ar.h;ur(yt+"len",Dt.len*(ke==="fraction"?1/Zr:Zr),Vt)}}else if($e==="type"&&(ke==="pie"!=(Pe==="pie")||ke==="funnelarea"!=(Pe==="funnelarea"))){var ir="x",xr="y";(ke==="bar"||Pe==="bar")&&ft.orientation==="h"&&(ir="y",xr="x"),T.swapAttrs(ft,["?","?src"],"labels",ir),T.swapAttrs(ft,["d?","?0"],"label",ir),T.swapAttrs(ft,["?","?src"],"values",xr),Pe==="pie"||Pe==="funnelarea"?(e(ft,"marker.color").set(e(ft,"marker.colors").get()),qe._pielayer.selectAll("g.trace").remove()):a.traceIs(ft,"cartesian")&&e(ft,"marker.colors").set(e(ft,"marker.color").get())}or[$e][Vt]=ee(Pe);var Fr=["swapxy","swapxyaxes","orientation","orientationaxes"];if(Fr.indexOf($e)!==-1){if($e==="orientation"){Ut.set(ke);var Or=ft.x&&!ft.y?"h":"v";if((Ut.get()||Or)===St.orientation)continue}else $e==="orientationaxes"&&(ft.orientation={v:"h",h:"v"}[St.orientation]);b.swapXYData(ft),Jt.calc=Jt.clearAxisTypes=!0}else f.dataArrayContainers.indexOf(Ut.parts[0])!==-1?(b.manageArrayContainers(Ut,ke,or),Jt.calc=!0):(it?it.arrayOk&&!a.traceIs(St,"regl")&&(T.isArrayOrTypedArray(ke)||T.isArrayOrTypedArray(Pe))?Jt.calc=!0:M.update(Jt,it):Jt.calc=!0,Ut.set(ke))}}if(["swapxyaxes","orientationaxes"].indexOf($e)!==-1&&o.swap(Ee,Je),$e==="orientationaxes"){var Cr=e(Ee.layout,"hovermode"),at=Cr.get();at==="x"?Cr.set("y"):at==="y"?Cr.set("x"):at==="x unified"?Cr.set("y unified"):at==="y unified"&&Cr.set("x unified")}if(["orientation","type"].indexOf($e)!==-1){for(Hr=[],Vt=0;Vt<Je.length;Vt++){var Ft=mt[Je[Vt]];a.traceIs(Ft,"cartesian")&&(Kr(Ft.xaxis||"x"),Kr(Ft.yaxis||"y"))}ur(Hr.map(ot),!0,0),ur(Hr.map(er),[0,1],0)}}return(Jt.calc||Jt.plot)&&(Jt.fullReplot=!0),{flags:Jt,undoit:or,redoit:Yt,traces:Je,eventData:T.extendDeepNoArrays([],[Rt,Je])}}function le(Ee){var Ge=T.counterRegex("axis",".title",!1,!1),Je=/colorbar\.title$/,qe=Object.keys(Ee),Tt,mt,Mt;for(Tt=0;Tt<qe.length;Tt++)mt=qe[Tt],Mt=Ee[mt],(mt==="title"||Ge.test(mt)||Je.test(mt))&&(typeof Mt=="string"||typeof Mt=="number")?Ht(mt,mt.replace("title","title.text")):mt.indexOf("titlefont")>-1&&mt.indexOf("grouptitlefont")===-1?Ht(mt,mt.replace("titlefont","title.font")):mt.indexOf("titleposition")>-1?Ht(mt,mt.replace("titleposition","title.position")):mt.indexOf("titleside")>-1?Ht(mt,mt.replace("titleside","title.side")):mt.indexOf("titleoffset")>-1&&Ht(mt,mt.replace("titleoffset","title.offset"));function Ht(Rt,Vt){Ee[Vt]=Ee[Rt],delete Ee[Rt]}}function ie(Ee,Ge,Je){Ee=T.getGraphDiv(Ee),b.clearPromiseQueue(Ee);var qe={};if(typeof Ge=="string")qe[Ge]=Je;else if(T.isPlainObject(Ge))qe=T.extendFlat({},Ge);else return T.warn("Relayout fail.",Ge,Je),Promise.reject();Object.keys(qe).length&&(Ee.changed=!0);var Tt=me(Ee,qe),mt=Tt.flags;mt.calc&&(Ee.calcdata=void 0);var Mt=[f.previousPromises];mt.layoutReplot?Mt.push(c.layoutReplot):Object.keys(qe).length&&(se(Ee,mt,Tt)||f.supplyDefaults(Ee),mt.legend&&Mt.push(c.doLegend),mt.layoutstyle&&Mt.push(c.layoutStyles),mt.axrange&&xe(Mt,Tt.rangesAltered),mt.ticks&&Mt.push(c.doTicksRelayout),mt.modebar&&Mt.push(c.doModeBar),mt.camera&&Mt.push(c.doCamera),mt.colorbars&&Mt.push(c.doColorBars),Mt.push(C)),Mt.push(f.rehover,f.redrag,f.reselect),n.add(Ee,ie,[Ee,Tt.undoit],ie,[Ee,Tt.redoit]);var Ht=T.syncOrAsync(Mt,Ee);return(!Ht||!Ht.then)&&(Ht=Promise.resolve(Ee)),Ht.then(function(){return Ee.emit("plotly_relayout",Tt.eventData),Ee})}function se(Ee,Ge,Je){var qe=Ee._fullLayout;if(!Ge.axrange)return!1;for(var Tt in Ge)if(Tt!=="axrange"&&Ge[Tt])return!1;for(var mt in Je.rangesAltered){var Mt=o.id2name(mt),Ht=Ee.layout[Mt],Rt=qe[Mt];if(Rt.autorange=Ht.autorange,Ht.range&&(Rt.range=Ht.range.slice()),Rt.cleanRange(),Rt._matchGroup){for(var Vt in Rt._matchGroup)if(Vt!==mt){var Jt=qe[o.id2name(Vt)];Jt.autorange=Rt.autorange,Jt.range=Rt.range.slice(),Jt._input.range=Rt.range.slice()}}}return!0}function xe(Ee,Ge){var Je=Ge?function(qe){var Tt=[],mt=!0;for(var Mt in Ge){var Ht=o.getFromId(qe,Mt);if(Tt.push(Mt),(Ht.ticklabelposition||"").indexOf("inside")!==-1&&Ht._anchorAxis&&Tt.push(Ht._anchorAxis._id),Ht._matchGroup)for(var Rt in Ht._matchGroup)Ge[Rt]||Tt.push(Rt)}return o.draw(qe,Tt,{skipTitle:mt})}:function(qe){return o.draw(qe,"redraw")};Ee.push(v,c.doAutoRangeAndConstraints,Je,c.drawData,c.finalDraw)}var oe=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,he=/^[xyz]axis[0-9]*\.autorange$/,be=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function me(Ee,Ge){var Je=Ee.layout,qe=Ee._fullLayout,Tt=qe._guiEditing,mt=ne(qe._preGUI,Tt),Mt=Object.keys(Ge),Ht=o.list(Ee),Rt=T.extendDeepAll({},Ge),Vt={},Jt,Yt,or;for(le(Ge),Mt=Object.keys(Ge),Yt=0;Yt<Mt.length;Yt++)if(Mt[Yt].indexOf("allaxes")===0){for(or=0;or<Ht.length;or++){var Hr=Ht[or]._id.substr(1),an=Hr.indexOf("scene")!==-1?Hr+".":"",Kr=Mt[Yt].replace("allaxes",an+Ht[or]._name);Ge[Kr]||(Ge[Kr]=Ge[Mt[Yt]])}delete Ge[Mt[Yt]]}var ot=M.layoutFlags(),er={},Kt={};function ur(Dr,Tr){if(Array.isArray(Dr)){Dr.forEach(function(An){ur(An,Tr)});return}if(!(Dr in Ge||b.hasParent(Ge,Dr))){var Wr=mt(Je,Dr);Dr in Kt||(Kt[Dr]=ee(Wr.get())),Tr!==void 0&&Wr.set(Tr)}}var Ar={},et;function $e(Dr){var Tr=o.name2id(Dr.split(".")[0]);return Ar[Tr]=1,Tr}for(var st in Ge){if(b.hasParent(Ge,st))throw new Error("cannot set "+st+" and a parent attribute simultaneously");for(var ft=mt(Je,st),St=Ge[st],Ut=ft.parts.length,Pe=Ut-1;Pe>0&&typeof ft.parts[Pe]!="string";)Pe--;var ke=ft.parts[Pe],it=ft.parts[Pe-1]+"."+ke,ut=ft.parts.slice(0,Pe).join("."),ht=e(Ee.layout,ut).get(),Et=e(qe,ut).get(),yt=ft.get();if(St!==void 0){er[st]=St,Kt[st]=ke==="reverse"?St:ee(yt);var Dt=r.getLayoutValObject(qe,ft.parts);if(Dt&&Dt.impliedEdits&&St!==null)for(var Xt in Dt.impliedEdits)ur(T.relativeAttr(st,Xt),Dt.impliedEdits[Xt]);if(["width","height"].indexOf(st)!==-1)if(St){ur("autosize",null);var ar=st==="height"?"width":"height";ur(ar,qe[ar])}else qe[st]=Ee._initialAutoSize[st];else if(st==="autosize")ur("width",St?null:qe.width),ur("height",St?null:qe.height);else if(it.match(oe))$e(it),e(qe,ut+"._inputRange").set(null);else if(it.match(he)){$e(it),e(qe,ut+"._inputRange").set(null);var kr=e(qe,ut).get();kr._inputDomain&&(kr._input.domain=kr._inputDomain.slice())}else it.match(be)&&e(qe,ut+"._inputDomain").set(null);if(ke==="type"){et=ht;var wr=Et.type==="linear"&&St==="log",Sr=Et.type==="log"&&St==="linear";if(wr||Sr){if(!et||!et.range)ur(ut+".autorange",!0);else if(Et.autorange)wr&&(et.range=et.range[1]>et.range[0]?[1,2]:[2,1]);else{var Zr=et.range[0],ir=et.range[1];wr?(Zr<=0&&ir<=0&&ur(ut+".autorange",!0),Zr<=0?Zr=ir/1e6:ir<=0&&(ir=Zr/1e6),ur(ut+".range[0]",Math.log(Zr)/Math.LN10),ur(ut+".range[1]",Math.log(ir)/Math.LN10)):(ur(ut+".range[0]",Math.pow(10,Zr)),ur(ut+".range[1]",Math.pow(10,ir)))}Array.isArray(qe._subplots.polar)&&qe._subplots.polar.length&&qe[ft.parts[0]]&&ft.parts[1]==="radialaxis"&&delete qe[ft.parts[0]]._subplot.viewInitial["radialaxis.range"],a.getComponentMethod("annotations","convertCoords")(Ee,Et,St,ur),a.getComponentMethod("images","convertCoords")(Ee,Et,St,ur)}else ur(ut+".autorange",!0),ur(ut+".range",null);e(qe,ut+"._inputRange").set(null)}else if(ke.match(_)){var xr=e(qe,st).get(),Fr=(St||{}).type;(!Fr||Fr==="-")&&(Fr="linear"),a.getComponentMethod("annotations","convertCoords")(Ee,xr,Fr,ur),a.getComponentMethod("images","convertCoords")(Ee,xr,Fr,ur)}var Or=l.containerArrayMatch(st);if(Or){Jt=Or.array,Yt=Or.index;var Cr=Or.property,at=Dt||{editType:"calc"};Yt!==""&&Cr===""&&(l.isAddVal(St)?Kt[st]=null:l.isRemoveVal(St)?Kt[st]=(e(Je,Jt).get()||[])[Yt]:T.warn("unrecognized full object value",Ge)),M.update(ot,at),Vt[Jt]||(Vt[Jt]={});var Ft=Vt[Jt][Yt];Ft||(Ft=Vt[Jt][Yt]={}),Ft[Cr]=St,delete Ge[st]}else ke==="reverse"?(ht.range?ht.range.reverse():(ur(ut+".autorange",!0),ht.range=[1,0]),Et.autorange?ot.calc=!0:ot.plot=!0):(st==="dragmode"&&(St===!1&&yt!==!1||St!==!1&&yt===!1)||qe._has("scatter-like")&&qe._has("regl")&&st==="dragmode"&&(St==="lasso"||St==="select")&&!(yt==="lasso"||yt==="select")||qe._has("gl2d")?ot.plot=!0:Dt?M.update(ot,Dt):ot.calc=!0,ft.set(St))}}for(Jt in Vt){var jt=l.applyContainerArrayChanges(Ee,mt(Je,Jt),Vt[Jt],ot,mt);jt||(ot.plot=!0)}for(var sr in Ar){et=o.getFromId(Ee,sr);var zr=et&&et._constraintGroup;if(zr){ot.calc=!0;for(var Ur in zr)Ar[Ur]||(o.getFromId(Ee,Ur)._constraintShrinkable=!0)}}return(_e(Ee)||Ge.height||Ge.width)&&(ot.plot=!0),(ot.plot||ot.calc)&&(ot.layoutReplot=!0),{flags:ot,rangesAltered:Ar,undoit:Kt,redoit:er,eventData:Rt}}function _e(Ee){var Ge=Ee._fullLayout,Je=Ge.width,qe=Ge.height;return Ee.layout.autosize&&f.plotAutoSize(Ee,Ee.layout,Ge),Ge.width!==Je||Ge.height!==qe}function Se(Ee,Ge,Je,qe){Ee=T.getGraphDiv(Ee),b.clearPromiseQueue(Ee),T.isPlainObject(Ge)||(Ge={}),T.isPlainObject(Je)||(Je={}),Object.keys(Ge).length&&(Ee.changed=!0),Object.keys(Je).length&&(Ee.changed=!0);var Tt=b.coerceTraceIndices(Ee,qe),mt=ae(Ee,T.extendFlat({},Ge),Tt),Mt=mt.flags,Ht=me(Ee,T.extendFlat({},Je)),Rt=Ht.flags;(Mt.calc||Rt.calc)&&(Ee.calcdata=void 0),Mt.clearAxisTypes&&b.clearAxisTypes(Ee,Tt,Je);var Vt=[];Rt.layoutReplot?Vt.push(c.layoutReplot):Mt.fullReplot?Vt.push(R._doPlot):(Vt.push(f.previousPromises),se(Ee,Rt,Ht)||f.supplyDefaults(Ee),Mt.style&&Vt.push(c.doTraceStyle),(Mt.colorbars||Rt.colorbars)&&Vt.push(c.doColorBars),Rt.legend&&Vt.push(c.doLegend),Rt.layoutstyle&&Vt.push(c.layoutStyles),Rt.axrange&&xe(Vt,Ht.rangesAltered),Rt.ticks&&Vt.push(c.doTicksRelayout),Rt.modebar&&Vt.push(c.doModeBar),Rt.camera&&Vt.push(c.doCamera),Vt.push(C)),Vt.push(f.rehover,f.redrag,f.reselect),n.add(Ee,Se,[Ee,mt.undoit,Ht.undoit,mt.traces],Se,[Ee,mt.redoit,Ht.redoit,mt.traces]);var Jt=T.syncOrAsync(Vt,Ee);return(!Jt||!Jt.then)&&(Jt=Promise.resolve(Ee)),Jt.then(function(){return Ee.emit("plotly_update",{data:mt.eventData,layout:Ht.eventData}),Ee})}function De(Ee){return function(Je){Je._fullLayout._guiEditing=!0;var qe=Ee.apply(null,arguments);return Je._fullLayout._guiEditing=!1,qe}}var Ie=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],Te=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function Ce(Ee,Ge){for(var Je=0;Je<Ge.length;Je++){var qe=Ge[Je],Tt=Ee.match(qe.pattern);if(Tt){var mt=Tt[1]||"";return{head:mt,tail:Ee.substr(mt.length+1),attr:qe.attr}}}}function He(Ee,Ge){var Je=e(Ge,Ee).get();if(Je!==void 0)return Je;var qe=Ee.split(".");for(qe.pop();qe.length>1;)if(qe.pop(),Je=e(Ge,qe.join(".")+".uirevision").get(),Je!==void 0)return Je;return Ge.uirevision}function Xe(Ee,Ge){for(var Je=0;Je<Ge.length;Je++)if(Ge[Je]._fullInput.uid===Ee)return Je;return-1}function Be(Ee,Ge,Je){for(var qe=0;qe<Ge.length;qe++)if(Ge[qe].uid===Ee)return qe;return!Ge[Je]||Ge[Je].uid?-1:Je}function Re(Ee,Ge){var Je=T.isPlainObject(Ee),qe=Array.isArray(Ee);return Je||qe?(Je&&T.isPlainObject(Ge)||qe&&Array.isArray(Ge))&&JSON.stringify(Ee)===JSON.stringify(Ge):Ee===Ge}function We(Ee,Ge,Je,qe){var Tt=qe._preGUI,mt,Mt,Ht,Rt,Vt,Jt,Yt,or,Hr,an,Kr=[],ot={},er={};for(mt in Tt){if(Vt=Ce(mt,Ie),Vt){if(Hr=Vt.head,an=Vt.tail,Mt=Vt.attr||Hr+".uirevision",Ht=e(qe,Mt).get(),Rt=Ht&&He(Mt,Ge),Rt&&Rt===Ht){if(Jt=Tt[mt],Jt===null&&(Jt=void 0),Yt=e(Ge,mt),or=Yt.get(),Re(or,Jt)){or===void 0&&an==="autorange"&&Kr.push(Hr),Yt.set(ee(e(qe,mt).get()));continue}else if(an==="autorange"||an.substr(0,6)==="range["){var Kt=Tt[Hr+".range[0]"],ur=Tt[Hr+".range[1]"],Ar=Tt[Hr+".autorange"];if(Ar||Ar===null&&Kt===null&&ur===null){if(!(Hr in ot)){var et=e(Ge,Hr).get();ot[Hr]=et&&(et.autorange||et.autorange!==!1&&(!et.range||et.range.length!==2))}if(ot[Hr]){Yt.set(ee(e(qe,mt).get()));continue}}}}}else T.warn("unrecognized GUI edit: "+mt);delete Tt[mt],Vt&&Vt.tail.substr(0,6)==="range["&&(er[Vt.head]=1)}for(var $e=0;$e<Kr.length;$e++){var st=Kr[$e];if(er[st]){var ft=e(Ge,st).get();ft&&delete ft.autorange}}var St=qe._tracePreGUI;for(var Ut in St){var Pe=St[Ut],ke=null,it;for(mt in Pe){if(!ke){var ut=Xe(Ut,Je);if(ut<0){delete St[Ut];break}var ht=Je[ut];it=ht._fullInput;var Et=Be(Ut,Ee,it.index);if(Et<0){delete St[Ut];break}ke=Ee[Et]}if(Vt=Ce(mt,Te),Vt){if(Vt.attr?(Ht=e(qe,Vt.attr).get(),Rt=Ht&&He(Vt.attr,Ge)):(Ht=it.uirevision,Rt=ke.uirevision,Rt===void 0&&(Rt=Ge.uirevision)),Rt&&Rt===Ht&&(Jt=Pe[mt],Jt===null&&(Jt=void 0),Yt=e(ke,mt),or=Yt.get(),Re(or,Jt))){Yt.set(ee(e(it,mt).get()));continue}}else T.warn("unrecognized GUI edit: "+mt+" in trace uid "+Ut);delete Pe[mt]}}}function vt(Ee,Ge,Je,qe){var Tt,mt;function Mt(){return R.addFrames(Ee,Tt)}Ee=T.getGraphDiv(Ee),b.clearPromiseQueue(Ee);var Ht=Ee._fullData,Rt=Ee._fullLayout;if(!T.isPlotDiv(Ee)||!Ht||!Rt)mt=R.newPlot(Ee,Ge,Je,qe);else{if(T.isPlainObject(Ge)){var Vt=Ge;Ge=Vt.data,Je=Vt.layout,qe=Vt.config,Tt=Vt.frames}var Jt=!1;if(qe){var Yt=T.extendDeep({},Ee._context);Ee._context=void 0,B(Ee,qe),Jt=At(Yt,Ee._context)}Ee.data=Ge||[],b.cleanData(Ee.data),Ee.layout=Je||{},b.cleanLayout(Ee.layout),We(Ee.data,Ee.layout,Ht,Rt),f.supplyDefaults(Ee,{skipUpdateCalc:!0});var or=Ee._fullData,Hr=Ee._fullLayout,an=Hr.datarevision===void 0,Kr=Hr.transition,ot=Zt(Ee,Rt,Hr,an,Kr),er=ot.newDataRevision,Kt=Pt(Ee,Ht,or,an,Kr,er);if(_e(Ee)&&(ot.layoutReplot=!0),Kt.calc||ot.calc){Ee.calcdata=void 0;for(var ur=Object.getOwnPropertyNames(Hr),Ar=0;Ar<ur.length;Ar++){var et=ur[Ar],$e=et.substring(0,5);if($e==="xaxis"||$e==="yaxis"){var st=Hr[et]._emptyCategories;st&&st()}}}else f.supplyDefaultsUpdateCalc(Ee.calcdata,or);var ft=[];if(Tt&&(Ee._transitionData={},f.createTransitionData(Ee),ft.push(Mt)),Hr.transition&&!Jt&&(Kt.anim||ot.anim))ot.ticks&&ft.push(c.doTicksRelayout),f.doCalcdata(Ee),c.doAutoRangeAndConstraints(Ee),ft.push(function(){return f.transitionFromReact(Ee,Kt,ot,Rt)});else if(Kt.fullReplot||ot.layoutReplot||Jt)Ee._fullLayout._skipDefaults=!0,ft.push(R._doPlot);else{for(var St in ot.arrays){var Ut=ot.arrays[St];if(Ut.length){var Pe=a.getComponentMethod(St,"drawOne");if(Pe!==T.noop)for(var ke=0;ke<Ut.length;ke++)Pe(Ee,Ut[ke]);else{var it=a.getComponentMethod(St,"draw");if(it===T.noop)throw new Error("cannot draw components: "+St);it(Ee)}}}ft.push(f.previousPromises),Kt.style&&ft.push(c.doTraceStyle),(Kt.colorbars||ot.colorbars)&&ft.push(c.doColorBars),ot.legend&&ft.push(c.doLegend),ot.layoutstyle&&ft.push(c.layoutStyles),ot.axrange&&xe(ft),ot.ticks&&ft.push(c.doTicksRelayout),ot.modebar&&ft.push(c.doModeBar),ot.camera&&ft.push(c.doCamera),ft.push(C)}ft.push(f.rehover,f.redrag,f.reselect),mt=T.syncOrAsync(ft,Ee),(!mt||!mt.then)&&(mt=Promise.resolve(Ee))}return mt.then(function(){return Ee.emit("plotly_react",{data:Ge,layout:Je}),Ee})}function Pt(Ee,Ge,Je,qe,Tt,mt){var Mt=Ge.length===Je.length;if(!Tt&&!Mt)return{fullReplot:!0,calc:!0};var Ht=M.traceFlags();Ht.arrays={},Ht.nChanges=0,Ht.nChangesAnim=0;var Rt,Vt;function Jt(Hr){var an=r.getTraceValObject(Vt,Hr);return!Vt._module.animatable&&an.anim&&(an.anim=!1),an}var Yt={getValObject:Jt,flags:Ht,immutable:qe,transition:Tt,newDataRevision:mt,gd:Ee},or={};for(Rt=0;Rt<Ge.length;Rt++)if(Je[Rt]){if(Vt=Je[Rt]._fullInput,f.hasMakesDataTransform(Vt)&&(Vt=Je[Rt]),or[Vt.uid])continue;or[Vt.uid]=1,zt(Ge[Rt]._fullInput,Vt,[],Yt)}return(Ht.calc||Ht.plot)&&(Ht.fullReplot=!0),Tt&&Ht.nChanges&&Ht.nChangesAnim&&(Ht.anim=Ht.nChanges===Ht.nChangesAnim&&Mt?"all":"some"),Ht}function Zt(Ee,Ge,Je,qe,Tt){var mt=M.layoutFlags();mt.arrays={},mt.rangesAltered={},mt.nChanges=0,mt.nChangesAnim=0;function Mt(Rt){return r.getLayoutValObject(Je,Rt)}var Ht={getValObject:Mt,flags:mt,immutable:qe,transition:Tt,gd:Ee};return zt(Ge,Je,[],Ht),(mt.plot||mt.calc)&&(mt.layoutReplot=!0),Tt&&mt.nChanges&&mt.nChangesAnim&&(mt.anim=mt.nChanges===mt.nChangesAnim?"all":"some"),mt}function zt(Ee,Ge,Je,qe){var Tt,mt,Mt,Ht=qe.getValObject,Rt=qe.flags,Vt=qe.immutable,Jt=qe.inArray,Yt=qe.arrayIndex;function or(){var ut=Tt.editType;if(Jt&&ut.indexOf("arraydraw")!==-1){T.pushUnique(Rt.arrays[Jt],Yt);return}M.update(Rt,Tt),ut!=="none"&&Rt.nChanges++,qe.transition&&Tt.anim&&Rt.nChangesAnim++,(oe.test(Mt)||he.test(Mt))&&(Rt.rangesAltered[Je[0]]=1),be.test(Mt)&&e(Ge,"_inputDomain").set(null),mt==="datarevision"&&(Rt.newDataRevision=1)}function Hr(ut){return ut.valType==="data_array"||ut.arrayOk}for(mt in Ee){if(Rt.calc&&!qe.transition)return;var an=Ee[mt],Kr=Ge[mt],ot=Je.concat(mt);if(Mt=ot.join("."),!(mt.charAt(0)==="_"||typeof an=="function"||an===Kr)){if((mt==="tick0"||mt==="dtick")&&Je[0]!=="geo"){var er=Ge.tickmode;if(er==="auto"||er==="array"||!er)continue}if(!(mt==="range"&&Ge.autorange)&&!((mt==="zmin"||mt==="zmax")&&Ge.type==="contourcarpet")&&(Tt=Ht(ot),!!Tt&&!(Tt._compareAsJSON&&JSON.stringify(an)===JSON.stringify(Kr)))){var Kt=Tt.valType,ur,Ar=Hr(Tt),et=Array.isArray(an),$e=Array.isArray(Kr);if(et&&$e){var st="_input_"+mt,ft=Ee[st],St=Ge[st];if(Array.isArray(ft)&&ft===St)continue}if(Kr===void 0)Ar&&et?Rt.calc=!0:or();else if(Tt._isLinkedToArray){var Ut=[],Pe=!1;Jt||(Rt.arrays[mt]=Ut);var ke=Math.min(an.length,Kr.length),it=Math.max(an.length,Kr.length);if(ke!==it)if(Tt.editType==="arraydraw")Pe=!0;else{or();continue}for(ur=0;ur<ke;ur++)zt(an[ur],Kr[ur],ot.concat(ur),T.extendFlat({inArray:mt,arrayIndex:ur},qe));if(Pe)for(ur=ke;ur<it;ur++)Ut.push(ur)}else!Kt&&T.isPlainObject(an)?zt(an,Kr,ot,qe):Ar?et&&$e?(Vt&&(Rt.calc=!0),(Vt||qe.newDataRevision)&&or()):et!==$e?Rt.calc=!0:or():et&&$e?(an.length!==Kr.length||String(an)!==String(Kr))&&or():or()}}}for(mt in Ge)if(!(mt in Ee||mt.charAt(0)==="_"||typeof Ge[mt]=="function"))if(Tt=Ht(Je.concat(mt)),Hr(Tt)&&Array.isArray(Ge[mt])){Rt.calc=!0;return}else or()}function At(Ee,Ge){var Je;for(Je in Ee)if(Je.charAt(0)!=="_"){var qe=Ee[Je],Tt=Ge[Je];if(qe!==Tt)if(T.isPlainObject(qe)&&T.isPlainObject(Tt)){if(At(qe,Tt))return!0}else if(Array.isArray(qe)&&Array.isArray(Tt)){if(qe.length!==Tt.length)return!0;for(var mt=0;mt<qe.length;mt++)if(qe[mt]!==Tt[mt])if(T.isPlainObject(qe[mt])&&T.isPlainObject(Tt[mt])){if(At(qe[mt],Tt[mt]))return!0}else return!0}else return!0}}function Wt(Ee,Ge,Je){if(Ee=T.getGraphDiv(Ee),!T.isPlotDiv(Ee))throw new Error("This element is not a Plotly plot: "+Ee+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var qe=Ee._transitionData;qe._frameQueue||(qe._frameQueue=[]),Je=f.supplyAnimationDefaults(Je);var Tt=Je.transition,mt=Je.frame;qe._frameWaitingCnt===void 0&&(qe._frameWaitingCnt=0);function Mt(Vt){return Array.isArray(Tt)?Vt>=Tt.length?Tt[0]:Tt[Vt]:Tt}function Ht(Vt){return Array.isArray(mt)?Vt>=mt.length?mt[0]:mt[Vt]:mt}function Rt(Vt,Jt){var Yt=0;return function(){if(Vt&&++Yt===Jt)return Vt()}}return new Promise(function(Vt,Jt){function Yt(){if(qe._frameQueue.length!==0){for(;qe._frameQueue.length;){var ke=qe._frameQueue.pop();ke.onInterrupt&&ke.onInterrupt()}Ee.emit("plotly_animationinterrupted",[])}}function or(ke){if(ke.length!==0){for(var it=0;it<ke.length;it++){var ut;ke[it].type==="byname"?ut=f.computeFrame(Ee,ke[it].name):ut=ke[it].data;var ht=Ht(it),Et=Mt(it);Et.duration=Math.min(Et.duration,ht.duration);var yt={frame:ut,name:ke[it].name,frameOpts:ht,transitionOpts:Et};it===ke.length-1&&(yt.onComplete=Rt(Vt,2),yt.onInterrupt=Jt),qe._frameQueue.push(yt)}Je.mode==="immediate"&&(qe._lastFrameAt=-1/0),qe._animationRaf||Kr()}}function Hr(){Ee.emit("plotly_animated"),window.cancelAnimationFrame(qe._animationRaf),qe._animationRaf=null}function an(){qe._currentFrame&&qe._currentFrame.onComplete&&qe._currentFrame.onComplete();var ke=qe._currentFrame=qe._frameQueue.shift();if(ke){var it=ke.name?ke.name.toString():null;Ee._fullLayout._currentFrame=it,qe._lastFrameAt=Date.now(),qe._timeToNext=ke.frameOpts.duration,f.transition(Ee,ke.frame.data,ke.frame.layout,b.coerceTraceIndices(Ee,ke.frame.traces),ke.frameOpts,ke.transitionOpts).then(function(){ke.onComplete&&ke.onComplete()}),Ee.emit("plotly_animatingframe",{name:it,frame:ke.frame,animation:{frame:ke.frameOpts,transition:ke.transitionOpts}})}else Hr()}function Kr(){Ee.emit("plotly_animating"),qe._lastFrameAt=-1/0,qe._timeToNext=0,qe._runningTransitions=0,qe._currentFrame=null;var ke=function(){qe._animationRaf=window.requestAnimationFrame(ke),Date.now()-qe._lastFrameAt>qe._timeToNext&&an()};ke()}var ot=0;function er(ke){return Array.isArray(Tt)?ot>=Tt.length?ke.transitionOpts=Tt[ot]:ke.transitionOpts=Tt[0]:ke.transitionOpts=Tt,ot++,ke}var Kt,ur,Ar=[],et=Ge==null,$e=Array.isArray(Ge),st=!et&&!$e&&T.isPlainObject(Ge);if(st)Ar.push({type:"object",data:er(T.extendFlat({},Ge))});else if(et||["string","number"].indexOf(typeof Ge)!==-1)for(Kt=0;Kt<qe._frames.length;Kt++)ur=qe._frames[Kt],!!ur&&(et||String(ur.group)===String(Ge))&&Ar.push({type:"byname",name:String(ur.name),data:er({name:ur.name})});else if($e)for(Kt=0;Kt<Ge.length;Kt++){var ft=Ge[Kt];["number","string"].indexOf(typeof ft)!==-1?(ft=String(ft),Ar.push({type:"byname",name:ft,data:er({name:ft})})):T.isPlainObject(ft)&&Ar.push({type:"object",data:er(T.extendFlat({},ft))})}for(Kt=0;Kt<Ar.length;Kt++)if(ur=Ar[Kt],ur.type==="byname"&&!qe._frameHash[ur.data.name]){T.warn('animate failure: frame not found: "'+ur.data.name+'"'),Jt();return}["next","immediate"].indexOf(Je.mode)!==-1&&Yt(),Je.direction==="reverse"&&Ar.reverse();var St=Ee._fullLayout._currentFrame;if(St&&Je.fromcurrent){var Ut=-1;for(Kt=0;Kt<Ar.length;Kt++)if(ur=Ar[Kt],ur.type==="byname"&&ur.name===St){Ut=Kt;break}if(Ut>0&&Ut<Ar.length-1){var Pe=[];for(Kt=0;Kt<Ar.length;Kt++)ur=Ar[Kt],(Ar[Kt].type!=="byname"||Kt>Ut)&&Pe.push(ur);Ar=Pe}}Ar.length>0?or(Ar):(Ee.emit("plotly_animated"),Vt())})}function Bt(Ee,Ge,Je){if(Ee=T.getGraphDiv(Ee),Ge==null)return Promise.resolve();if(!T.isPlotDiv(Ee))throw new Error("This element is not a Plotly plot: "+Ee+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var qe,Tt,mt,Mt,Ht=Ee._transitionData._frames,Rt=Ee._transitionData._frameHash;if(!Array.isArray(Ge))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+Ge);var Vt=Ht.length+Ge.length*2,Jt=[],Yt={};for(qe=Ge.length-1;qe>=0;qe--)if(!!T.isPlainObject(Ge[qe])){var or=Ge[qe].name,Hr=(Rt[or]||Yt[or]||{}).name,an=Ge[qe].name,Kr=Rt[Hr]||Yt[Hr];Hr&&an&&typeof an=="number"&&Kr&&y<w&&(y++,T.warn('addFrames: overwriting frame "'+(Rt[Hr]||Yt[Hr]).name+'" with a frame whose name of type "number" also equates to "'+Hr+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),y===w&&T.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),Yt[or]={name:or},Jt.push({frame:f.supplyFrameDefaults(Ge[qe]),index:Je&&Je[qe]!==void 0&&Je[qe]!==null?Je[qe]:Vt+qe})}Jt.sort(function(st,ft){return st.index>ft.index?-1:st.index<ft.index?1:0});var ot=[],er=[],Kt=Ht.length;for(qe=Jt.length-1;qe>=0;qe--){if(Tt=Jt[qe].frame,typeof Tt.name=="number"&&T.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!Tt.name)for(;Rt[Tt.name="frame "+Ee._transitionData._counter++];);if(Rt[Tt.name]){for(mt=0;mt<Ht.length&&(Ht[mt]||{}).name!==Tt.name;mt++);ot.push({type:"replace",index:mt,value:Tt}),er.unshift({type:"replace",index:mt,value:Ht[mt]})}else Mt=Math.max(0,Math.min(Jt[qe].index,Kt)),ot.push({type:"insert",index:Mt,value:Tt}),er.unshift({type:"delete",index:Mt}),Kt++}var ur=f.modifyFrames,Ar=f.modifyFrames,et=[Ee,er],$e=[Ee,ot];return n&&n.add(Ee,ur,et,Ar,$e),f.modifyFrames(Ee,ot)}function Ct(Ee,Ge){if(Ee=T.getGraphDiv(Ee),!T.isPlotDiv(Ee))throw new Error("This element is not a Plotly plot: "+Ee);var Je,qe,Tt=Ee._transitionData._frames,mt=[],Mt=[];if(!Ge)for(Ge=[],Je=0;Je<Tt.length;Je++)Ge.push(Je);for(Ge=Ge.slice(),Ge.sort(),Je=Ge.length-1;Je>=0;Je--)qe=Ge[Je],mt.push({type:"delete",index:qe}),Mt.unshift({type:"insert",index:qe,value:Tt[qe]});var Ht=f.modifyFrames,Rt=f.modifyFrames,Vt=[Ee,Mt],Jt=[Ee,mt];return n&&n.add(Ee,Ht,Vt,Rt,Jt),f.modifyFrames(Ee,mt)}function Ze(Ee){Ee=T.getGraphDiv(Ee);var Ge=Ee._fullLayout||{},Je=Ee._fullData||[];return f.cleanPlot([],{},Je,Ge),f.purge(Ee),i.purge(Ee),Ge._container&&Ge._container.remove(),delete Ee._context,Ee}function nt(Ee){var Ge=Ee._fullLayout,Je=Ee.getBoundingClientRect();if(!T.equalDomRects(Je,Ge._lastBBox)){var qe=Ge._invTransform=T.inverseTransformMatrix(T.getFullTransformMatrix(Ee));Ge._invScaleX=Math.sqrt(qe[0][0]*qe[0][0]+qe[0][1]*qe[0][1]+qe[0][2]*qe[0][2]),Ge._invScaleY=Math.sqrt(qe[1][0]*qe[1][0]+qe[1][1]*qe[1][1]+qe[1][2]*qe[1][2]),Ge._lastBBox=Je}}function Ye(Ee){var Ge=h.select(Ee),Je=Ee._fullLayout;if(Je._calcInverseTransform=nt,Je._calcInverseTransform(Ee),Je._container=Ge.selectAll(".plot-container").data([0]),Je._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),Je._paperdiv=Je._container.selectAll(".svg-container").data([0]),Je._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),Je._glcontainer=Je._paperdiv.selectAll(".gl-container").data([{}]),Je._glcontainer.enter().append("div").classed("gl-container",!0),Je._paperdiv.selectAll(".main-svg").remove(),Je._paperdiv.select(".modebar-container").remove(),Je._paper=Je._paperdiv.insert("svg",":first-child").classed("main-svg",!0),Je._toppaper=Je._paperdiv.append("svg").classed("main-svg",!0),Je._modebardiv=Je._paperdiv.append("div"),delete Je._modeBar,Je._hoverpaper=Je._paperdiv.append("svg").classed("main-svg",!0),!Je._uid){var qe={};h.selectAll("defs").each(function(){this.id&&(qe[this.id.split("-")[1]]=1)}),Je._uid=T.randstr(qe)}Je._paperdiv.selectAll(".main-svg").attr(p.svgAttrs),Je._defs=Je._paper.append("defs").attr("id","defs-"+Je._uid),Je._clips=Je._defs.append("g").classed("clips",!0),Je._topdefs=Je._toppaper.append("defs").attr("id","topdefs-"+Je._uid),Je._topclips=Je._topdefs.append("g").classed("clips",!0),Je._bgLayer=Je._paper.append("g").classed("bglayer",!0),Je._draggers=Je._paper.append("g").classed("draglayer",!0);var Tt=Je._paper.append("g").classed("layer-below",!0);Je._imageLowerLayer=Tt.append("g").classed("imagelayer",!0),Je._shapeLowerLayer=Tt.append("g").classed("shapelayer",!0),Je._cartesianlayer=Je._paper.append("g").classed("cartesianlayer",!0),Je._polarlayer=Je._paper.append("g").classed("polarlayer",!0),Je._smithlayer=Je._paper.append("g").classed("smithlayer",!0),Je._ternarylayer=Je._paper.append("g").classed("ternarylayer",!0),Je._geolayer=Je._paper.append("g").classed("geolayer",!0),Je._funnelarealayer=Je._paper.append("g").classed("funnelarealayer",!0),Je._pielayer=Je._paper.append("g").classed("pielayer",!0),Je._iciclelayer=Je._paper.append("g").classed("iciclelayer",!0),Je._treemaplayer=Je._paper.append("g").classed("treemaplayer",!0),Je._sunburstlayer=Je._paper.append("g").classed("sunburstlayer",!0),Je._indicatorlayer=Je._toppaper.append("g").classed("indicatorlayer",!0),Je._glimages=Je._paper.append("g").classed("glimages",!0);var mt=Je._toppaper.append("g").classed("layer-above",!0);Je._imageUpperLayer=mt.append("g").classed("imagelayer",!0),Je._shapeUpperLayer=mt.append("g").classed("shapelayer",!0),Je._selectionLayer=Je._toppaper.append("g").classed("selectionlayer",!0),Je._infolayer=Je._toppaper.append("g").classed("infolayer",!0),Je._menulayer=Je._toppaper.append("g").classed("menulayer",!0),Je._zoomlayer=Je._toppaper.append("g").classed("zoomlayer",!0),Je._hoverlayer=Je._hoverpaper.append("g").classed("hoverlayer",!0),Je._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),Ee.emit("plotly_framework")}R.animate=Wt,R.addFrames=Bt,R.deleteFrames=Ct,R.addTraces=K,R.deleteTraces=te,R.extendTraces=re,R.moveTraces=G,R.prependTraces=ue,R.newPlot=F,R._doPlot=d,R.purge=Ze,R.react=vt,R.redraw=z,R.relayout=ie,R.restyle=Y,R.setPlotConfig=S,R.update=Se,R._guiRelayout=De(ie),R._guiRestyle=De(Y),R._guiUpdate=De(Se),R._storeDirectGUIEdit=q},{"../components/color":367,"../components/drawing":389,"../components/selections":455,"../constants/xmlns_namespaces":492,"../lib":515,"../lib/events":504,"../lib/queue":531,"../plots/cartesian/axes":566,"../plots/cartesian/constants":573,"../plots/cartesian/graph_interact":576,"../plots/plots":628,"../registry":647,"./edit_types":548,"./helpers":549,"./manage_arrays":551,"./plot_config":553,"./plot_schema":554,"./subroutines":556,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],553:[function(t,P,R){var h={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},editSelection:{valType:"boolean",dflt:!0},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},u={};function A(T,e){for(var i in T){var n=T[i];n.valType?e[i]=n.dflt:(e[i]||(e[i]={}),A(n,e[i]))}}A(h,u),P.exports={configAttributes:h,dfltConfig:u}},{}],554:[function(t,P,R){var h=t("../registry"),u=t("../lib"),A=t("../plots/attributes"),T=t("../plots/layout_attributes"),e=t("../plots/frame_attributes"),i=t("../plots/animation_attributes"),n=t("./plot_config").configAttributes,a=t("./edit_types"),r=u.extendDeepAll,f=u.isPlainObject,o=u.isArrayOrTypedArray,s=u.nestedProperty,m=u.valObjectMeta,g="_isSubplotObj",p="_isLinkedToArray",v="_arrayAttrRegexps",x="_deprecated",l=[g,p,v,x];R.IS_SUBPLOT_OBJ=g,R.IS_LINKED_TO_ARRAY=p,R.DEPRECATED=x,R.UNDERSCORE_ATTRS=l,R.get=function(){var F={};h.allTypes.forEach(function(O){F[O]=_(O)});var I={};return Object.keys(h.transformsRegistry).forEach(function(O){I[O]=w(O)}),{defs:{valObjects:m,metaKeys:l.concat(["description","role","editType","impliedEdits"]),editType:{traces:a.traces,layout:a.layout},impliedEdits:{}},traces:F,layout:y(),transforms:I,frames:d(),animation:C(i),config:C(n)}},R.crawl=function(F,I,O,N){var V=O||0;N=N||"",Object.keys(F).forEach(function(H){var j=F[H];if(l.indexOf(H)===-1){var Z=(N?N+".":"")+H;I(j,H,F,V,Z),!R.isValObject(j)&&f(j)&&H!=="impliedEdits"&&R.crawl(j,I,V+1,Z)}})},R.isValObject=function(F){return F&&F.valType!==void 0},R.findArrayAttributes=function(F){var I=[],O=[],N=[],V,H;function j(te,G,Y,ee){O=O.slice(0,ee).concat([G]),N=N.slice(0,ee).concat([te&&te._isLinkedToArray]);var ne=te&&(te.valType==="data_array"||te.arrayOk===!0)&&!(O[ee-1]==="colorbar"&&(G==="ticktext"||G==="tickvals"));!ne||Z(V,0,"")}function Z(te,G,Y){var ee=te[O[G]],ne=Y+O[G];if(G===O.length-1)o(ee)&&I.push(H+ne);else if(N[G]){if(Array.isArray(ee))for(var J=0;J<ee.length;J++)f(ee[J])&&Z(ee[J],G+1,ne+"["+J+"].")}else f(ee)&&Z(ee,G+1,ne+".")}V=F,H="",R.crawl(A,j),F._module&&F._module.attributes&&R.crawl(F._module.attributes,j);var X=F.transforms;if(X)for(var re=0;re<X.length;re++){var ue=X[re],K=ue._module;K&&(H="transforms["+re+"].",V=ue,R.crawl(K.attributes,j))}return I},R.getTraceValObject=function(F,I){var O=I[0],N=1,V,H;if(O==="transforms"){if(I.length===1)return A.transforms;var j=F.transforms;if(!Array.isArray(j)||!j.length)return!1;var Z=I[1];if(!M(Z)||Z>=j.length)return!1;V=(h.transformsRegistry[j[Z].type]||{}).attributes,H=V&&V[I[2]],N=3}else{var X=F._module;if(X||(X=(h.modules[F.type||A.type.dflt]||{})._module),!X)return!1;if(V=X.attributes,H=V&&V[O],!H){var re=X.basePlotModule;re&&re.attributes&&(H=re.attributes[O])}H||(H=A[O])}return c(H,I,N)},R.getLayoutValObject=function(F,I){var O=b(F,I[0]);return c(O,I,1)};function b(F,I){var O,N,V,H,j=F._basePlotModules;if(j){var Z;for(O=0;O<j.length;O++){if(V=j[O],V.attrRegex&&V.attrRegex.test(I)){if(V.layoutAttrOverrides)return V.layoutAttrOverrides;!Z&&V.layoutAttributes&&(Z=V.layoutAttributes)}var X=V.baseLayoutAttrOverrides;if(X&&I in X)return X[I]}if(Z)return Z}var re=F._modules;if(re){for(O=0;O<re.length;O++)if(H=re[O].layoutAttributes,H&&I in H)return H[I]}for(N in h.componentsRegistry){if(V=h.componentsRegistry[N],V.name==="colorscale"&&I.indexOf("coloraxis")===0)return V.layoutAttributes[I];if(!V.schema&&I===V.name)return V.layoutAttributes}return I in T?T[I]:!1}function c(F,I,O){if(!F)return!1;if(F._isLinkedToArray){if(M(I[O]))O++;else if(O<I.length)return!1}for(;O<I.length;O++){var N=F[I[O]];if(f(N))F=N;else break;if(O===I.length-1)break;if(F._isLinkedToArray){if(O++,!M(I[O]))return!1}else if(F.valType==="info_array"){O++;var V=I[O];if(!M(V))return!1;var H=F.items;if(Array.isArray(H)){if(V>=H.length)return!1;if(F.dimensions===2){if(O++,I.length===O)return F;var j=I[O];if(!M(j))return!1;F=H[V][j]}else F=H[V]}else F=H}}return F}function M(F){return F===Math.round(F)&&F>=0}function _(F){var I,O;I=h.modules[F]._module,O=I.basePlotModule;var N={};N.type=null;var V=r({},A),H=r({},I.attributes);R.crawl(H,function(X,re,ue,K,te){s(V,te).set(void 0),X===void 0&&s(H,te).set(void 0)}),r(N,V),h.traceIs(F,"noOpacity")&&delete N.opacity,h.traceIs(F,"showLegend")||(delete N.showlegend,delete N.legendgroup),h.traceIs(F,"noHover")&&(delete N.hoverinfo,delete N.hoverlabel),I.selectPoints||delete N.selectedpoints,r(N,H),O.attributes&&r(N,O.attributes),N.type=F;var j={meta:I.meta||{},categories:I.categories||{},animatable:Boolean(I.animatable),type:F,attributes:C(N)};if(I.layoutAttributes){var Z={};r(Z,I.layoutAttributes),j.layoutAttributes=C(Z)}return I.animatable||R.crawl(j,function(X){R.isValObject(X)&&"anim"in X&&delete X.anim}),j}function y(){var F={},I,O;r(F,T);for(I in h.subplotsRegistry)if(O=h.subplotsRegistry[I],!!O.layoutAttributes)if(Array.isArray(O.attr))for(var N=0;N<O.attr.length;N++)B(F,O,O.attr[N]);else{var V=O.attr==="subplot"?O.name:O.attr;B(F,O,V)}for(I in h.componentsRegistry){O=h.componentsRegistry[I];var H=O.schema;if(H&&(H.subplots||H.layout)){var j=H.subplots;if(j&&j.xaxis&&!j.yaxis)for(var Z in j.xaxis)delete F.yaxis[Z]}else O.name==="colorscale"?r(F,O.layoutAttributes):O.layoutAttributes&&z(F,O.layoutAttributes,O.name)}return{layoutAttributes:C(F)}}function w(F){var I=h.transformsRegistry[F],O=r({},I.attributes);return Object.keys(h.componentsRegistry).forEach(function(N){var V=h.componentsRegistry[N];V.schema&&V.schema.transforms&&V.schema.transforms[F]&&Object.keys(V.schema.transforms[F]).forEach(function(H){z(O,V.schema.transforms[F][H],H)})}),{attributes:C(O)}}function d(){var F={frames:r({},e)};return C(F),F.frames}function C(F){return S(F),E(F),k(F),F}function S(F){function I(N){return{valType:"string",editType:"none"}}function O(N,V,H){R.isValObject(N)?(N.arrayOk===!0||N.valType==="data_array")&&(H[V+"src"]=I()):f(N)&&(N.role="object")}R.crawl(F,O)}function E(F){function I(O,N,V){if(!!O){var H=O[p];!H||(delete O[p],V[N]={items:{}},V[N].items[H]=O,V[N].role="object")}}R.crawl(F,I)}function k(F){function I(O){for(var N in O)if(f(O[N]))I(O[N]);else if(Array.isArray(O[N]))for(var V=0;V<O[N].length;V++)I(O[N][V]);else O[N]instanceof RegExp&&(O[N]=O[N].toString())}I(F)}function B(F,I,O){var N=s(F,O),V=r({},I.layoutAttributes);V[g]=!0,N.set(V)}function z(F,I,O){var N=s(F,O);N.set(r(N.get()||{},I))}},{"../lib":515,"../plots/animation_attributes":560,"../plots/attributes":562,"../plots/frame_attributes":595,"../plots/layout_attributes":619,"../registry":647,"./edit_types":548,"./plot_config":553}],555:[function(t,P,R){var h=t("../lib"),u=t("../plots/attributes"),A="templateitemname",T={name:{valType:"string",editType:"none"}};T[A]={valType:"string",editType:"calc"},R.templatedArray=function(n,a){return a._isLinkedToArray=n,a.name=T.name,a[A]=T[A],a},R.traceTemplater=function(n){var a={},r,f;for(r in n)f=n[r],Array.isArray(f)&&f.length&&(a[r]=0);function o(s){r=h.coerce(s,{},u,"type");var m={type:r,_template:null};if(r in a){f=n[r];var g=a[r]%f.length;a[r]++,m._template=f[g]}return m}return{newTrace:o}},R.newContainer=function(n,a,r){var f=n._template,o=f&&(f[a]||r&&f[r]);h.isPlainObject(o)||(o=null);var s=n[a]={_template:o};return s},R.arrayTemplater=function(n,a,r){var f=n._template,o=f&&f[i(a)],s=f&&f[a];(!Array.isArray(s)||!s.length)&&(s=[]);var m={};function g(v){var x={name:v.name,_input:v},l=x[A]=v[A];if(!e(l))return x._template=o,x;for(var b=0;b<s.length;b++){var c=s[b];if(c.name===l)return m[l]=1,x._template=c,x}return x[r]=v[r]||!1,x._template=!1,x}function p(){for(var v=[],x=0;x<s.length;x++){var l=s[x],b=l.name;if(e(b)&&!m[b]){var c={_template:l,name:b,_input:{_templateitemname:b}};c[A]=l[A],v.push(c),m[b]=1}}return v}return{newItem:g,defaultItems:p}};function e(n){return n&&typeof n=="string"}function i(n){var a=n.length-1;return n.charAt(a)!=="s"&&h.warn("bad argument to arrayDefaultKey: "+n),n.substr(0,n.length-1)+"defaults"}R.arrayDefaultKey=i,R.arrayEditor=function(n,a,r){var f=(h.nestedProperty(n,a).get()||[]).length,o=r._index,s=o>=f&&(r._input||{})._templateitemname;s&&(o=f);var m=a+"["+o+"]",g;function p(){g={},s&&(g[m]={},g[m][A]=s)}p();function v(c,M){g[c]=M}function x(c,M){s?h.nestedProperty(g[m],c).set(M):g[m+"."+c]=M}function l(){var c=g;return p(),c}function b(c,M){c&&x(c,M);var _=l();for(var y in _)h.nestedProperty(n,y).set(_[y])}return{modifyBase:v,modifyItem:x,getUpdateObj:l,applyUpdate:b}}},{"../lib":515,"../plots/attributes":562}],556:[function(t,P,R){var h=t("@plotly/d3"),u=t("../registry"),A=t("../plots/plots"),T=t("../lib"),e=t("../lib/clear_gl_canvases"),i=t("../components/color"),n=t("../components/drawing"),a=t("../components/titles"),r=t("../components/modebar"),f=t("../plots/cartesian/axes"),o=t("../constants/alignment"),s=t("../plots/cartesian/constraints"),m=s.enforce,g=s.clean,p=t("../plots/cartesian/autorange").doAutoRange,v="start",x="middle",l="end";R.layoutStyles=function(E){return T.syncOrAsync([A.doAutoMargin,c],E)};function b(E,k,B){for(var z=0;z<B.length;z++){var F=B[z][0],I=B[z][1];if(!(F[0]>=E[1]||F[1]<=E[0])&&I[0]<k[1]&&I[1]>k[0])return!0}return!1}function c(E){var k=E._fullLayout,B=k._size,z=B.p,F=f.list(E,"",!0),I,O,N,V,H,j;if(k._paperdiv.style({width:E._context.responsive&&k.autosize&&!E._context._hasZeroWidth&&!E.layout.width?"100%":k.width+"px",height:E._context.responsive&&k.autosize&&!E._context._hasZeroHeight&&!E.layout.height?"100%":k.height+"px"}).selectAll(".main-svg").call(n.setSize,k.width,k.height),E._context.setBackground(E,k.paper_bgcolor),R.drawMainTitle(E),r.manage(E),!k._has("cartesian"))return A.previousPromises(E);function Z(At,Wt,Bt){var Ct=At._lw/2;if(At._id.charAt(0)==="x"){if(Wt){if(Bt==="top")return Wt._offset-z-Ct}else return B.t+B.h*(1-(At.position||0))+Ct%1;return Wt._offset+Wt._length+z+Ct}if(Wt){if(Bt==="right")return Wt._offset+Wt._length+z+Ct}else return B.l+B.w*(At.position||0)+Ct%1;return Wt._offset-z-Ct}for(I=0;I<F.length;I++){V=F[I];var X=V._anchorAxis;V._linepositions={},V._lw=n.crispRound(E,V.linewidth,1),V._mainLinePosition=Z(V,X,V.side),V._mainMirrorPosition=V.mirror&&X?Z(V,X,o.OPPOSITE_SIDE[V.side]):null}var re=[],ue=[],K=[],te=i.opacity(k.paper_bgcolor)===1&&i.opacity(k.plot_bgcolor)===1&&k.paper_bgcolor===k.plot_bgcolor;for(O in k._plots)if(N=k._plots[O],N.mainplot)N.bg&&N.bg.remove(),N.bg=void 0;else{var G=N.xaxis.domain,Y=N.yaxis.domain,ee=N.plotgroup;if(b(G,Y,K)){var ne=ee.node(),J=N.bg=T.ensureSingle(ee,"rect","bg");ne.insertBefore(J.node(),ne.childNodes[0]),ue.push(O)}else ee.select("rect.bg").remove(),K.push([G,Y]),te||(re.push(O),ue.push(O))}var q=k._bgLayer.selectAll(".bg").data(re);for(q.enter().append("rect").classed("bg",!0),q.exit().remove(),q.each(function(At){k._plots[At].bg=h.select(this)}),I=0;I<ue.length;I++)N=k._plots[ue[I]],H=N.xaxis,j=N.yaxis,N.bg&&H._offset!==void 0&&j._offset!==void 0&&N.bg.call(n.setRect,H._offset-z,j._offset-z,H._length+2*z,j._length+2*z).call(i.fill,k.plot_bgcolor).style("stroke-width",0);if(!k._hasOnlyLargeSploms)for(O in k._plots){N=k._plots[O],H=N.xaxis,j=N.yaxis;var ae=N.clipId="clip"+k._uid+O+"plot",le=T.ensureSingleById(k._clips,"clipPath",ae,function(At){At.classed("plotclip",!0).append("rect")});N.clipRect=le.select("rect").attr({width:H._length,height:j._length}),n.setTranslate(N.plot,H._offset,j._offset);var ie,se;N._hasClipOnAxisFalse?(ie=null,se=ae):(ie=ae,se=null),n.setClipUrl(N.plot,ie,E),N.layerClipId=se}var xe,oe,he,be,me,_e,Se,De,Ie,Te,Ce,He,Xe;function Be(At){return"M"+xe+","+At+"H"+oe}function Re(At){return"M"+H._offset+","+At+"h"+H._length}function We(At){return"M"+At+","+De+"V"+Se}function vt(At){return"M"+At+","+j._offset+"v"+j._length}function Pt(At,Wt,Bt){if(!At.showline||O!==At._mainSubplot)return"";if(!At._anchorAxis)return Bt(At._mainLinePosition);var Ct=Wt(At._mainLinePosition);return At.mirror&&(Ct+=Wt(At._mainMirrorPosition)),Ct}for(O in k._plots){N=k._plots[O],H=N.xaxis,j=N.yaxis;var Zt="M0,0";M(H,O)&&(me=y(H,"left",j,F),xe=H._offset-(me?z+me:0),_e=y(H,"right",j,F),oe=H._offset+H._length+(_e?z+_e:0),he=Z(H,j,"bottom"),be=Z(H,j,"top"),Xe=!H._anchorAxis||O!==H._mainSubplot,Xe&&(H.mirror==="allticks"||H.mirror==="all")&&(H._linepositions[O]=[he,be]),Zt=Pt(H,Be,Re),Xe&&H.showline&&(H.mirror==="all"||H.mirror==="allticks")&&(Zt+=Be(he)+Be(be)),N.xlines.style("stroke-width",H._lw+"px").call(i.stroke,H.showline?H.linecolor:"rgba(0,0,0,0)")),N.xlines.attr("d",Zt);var zt="M0,0";M(j,O)&&(Ce=y(j,"bottom",H,F),Se=j._offset+j._length+(Ce?z:0),He=y(j,"top",H,F),De=j._offset-(He?z:0),Ie=Z(j,H,"left"),Te=Z(j,H,"right"),Xe=!j._anchorAxis||O!==j._mainSubplot,Xe&&(j.mirror==="allticks"||j.mirror==="all")&&(j._linepositions[O]=[Ie,Te]),zt=Pt(j,We,vt),Xe&&j.showline&&(j.mirror==="all"||j.mirror==="allticks")&&(zt+=We(Ie)+We(Te)),N.ylines.style("stroke-width",j._lw+"px").call(i.stroke,j.showline?j.linecolor:"rgba(0,0,0,0)")),N.ylines.attr("d",zt)}return f.makeClipPaths(E),A.previousPromises(E)}function M(E,k){return(E.ticks||E.showline)&&(k===E._mainSubplot||E.mirror==="all"||E.mirror==="allticks")}function _(E,k,B){if(!B.showline||!B._lw)return!1;if(B.mirror==="all"||B.mirror==="allticks")return!0;var z=B._anchorAxis;if(!z)return!1;var F=o.FROM_BL[k];return B.side===k?z.domain[F]===E.domain[F]:B.mirror&&z.domain[1-F]===E.domain[1-F]}function y(E,k,B,z){if(_(E,k,B))return B._lw;for(var F=0;F<z.length;F++){var I=z[F];if(I._mainAxis===B._mainAxis&&_(E,k,I))return I._lw}return 0}R.drawMainTitle=function(E){var k=E._fullLayout,B=C(k),z=S(k);a.draw(E,"gtitle",{propContainer:k,propName:"title.text",placeholder:k._dfltTitle.plot,attributes:{x:w(k,B),y:d(k,z),"text-anchor":B,dy:z}})};function w(E,k){var B=E.title,z=E._size,F=0;switch(k===v?F=B.pad.l:k===l&&(F=-B.pad.r),B.xref){case"paper":return z.l+z.w*B.x+F;case"container":default:return E.width*B.x+F}}function d(E,k){var B=E.title,z=E._size,F=0;if(k==="0em"||!k?F=-B.pad.b:k===o.CAP_SHIFT+"em"&&(F=B.pad.t),B.y==="auto")return z.t/2;switch(B.yref){case"paper":return z.t+z.h-z.h*B.y+F;case"container":default:return E.height-E.height*B.y+F}}function C(E){var k=E.title,B=x;return T.isRightAnchor(k)?B=l:T.isLeftAnchor(k)&&(B=v),B}function S(E){var k=E.title,B="0em";return T.isTopAnchor(k)?B=o.CAP_SHIFT+"em":T.isMiddleAnchor(k)&&(B=o.MID_SHIFT+"em"),B}R.doTraceStyle=function(E){var k=E.calcdata,B=[],z;for(z=0;z<k.length;z++){var F=k[z],I=F[0]||{},O=I.trace||{},N=O._module||{},V=N.arraysToCalcdata;V&&V(F,O);var H=N.editStyle;H&&B.push({fn:H,cd0:I})}if(B.length){for(z=0;z<B.length;z++){var j=B[z];j.fn(E,j.cd0)}e(E),R.redrawReglTraces(E)}return A.style(E),u.getComponentMethod("legend","draw")(E),A.previousPromises(E)},R.doColorBars=function(E){return u.getComponentMethod("colorbar","draw")(E),A.previousPromises(E)},R.layoutReplot=function(E){var k=E.layout;return E.layout=void 0,u.call("_doPlot",E,"",k)},R.doLegend=function(E){return u.getComponentMethod("legend","draw")(E),A.previousPromises(E)},R.doTicksRelayout=function(E){return f.draw(E,"redraw"),E._fullLayout._hasOnlyLargeSploms&&(u.subplotsRegistry.splom.updateGrid(E),e(E),R.redrawReglTraces(E)),R.drawMainTitle(E),A.previousPromises(E)},R.doModeBar=function(E){var k=E._fullLayout;r.manage(E);for(var B=0;B<k._basePlotModules.length;B++){var z=k._basePlotModules[B].updateFx;z&&z(E)}return A.previousPromises(E)},R.doCamera=function(E){for(var k=E._fullLayout,B=k._subplots.gl3d,z=0;z<B.length;z++){var F=k[B[z]],I=F._scene;I.setViewport(F)}},R.drawData=function(E){var k=E._fullLayout;e(E);for(var B=k._basePlotModules,z=0;z<B.length;z++)B[z].plot(E);return R.redrawReglTraces(E),A.style(E),u.getComponentMethod("selections","draw")(E),u.getComponentMethod("shapes","draw")(E),u.getComponentMethod("annotations","draw")(E),u.getComponentMethod("images","draw")(E),k._replotting=!1,A.previousPromises(E)},R.redrawReglTraces=function(E){var k=E._fullLayout;if(k._has("regl")){var B=E._fullData,z=[],F=[],I,O;for(k._hasOnlyLargeSploms&&k._splomGrid.draw(),I=0;I<B.length;I++){var N=B[I];N.visible===!0&&N._length!==0&&(N.type==="splom"?k._splomScenes[N.uid].draw():N.type==="scattergl"?T.pushUnique(z,N.xaxis+N.yaxis):N.type==="scatterpolargl"&&T.pushUnique(F,N.subplot))}for(I=0;I<z.length;I++)O=k._plots[z[I]],O._scene&&O._scene.draw();for(I=0;I<F.length;I++)O=k[F[I]]._subplot,O._scene&&O._scene.draw()}},R.doAutoRangeAndConstraints=function(E){for(var k=f.list(E,"",!0),B,z={},F=0;F<k.length;F++)if(B=k[F],!z[B._id]){z[B._id]=1,g(E,B),p(E,B);var I=B._matchGroup;if(I)for(var O in I){var N=f.getFromId(E,O);p(E,N,B.range),z[O]=1}}m(E)},R.finalDraw=function(E){u.getComponentMethod("rangeslider","draw")(E),u.getComponentMethod("rangeselector","draw")(E)},R.drawMarginPushers=function(E){u.getComponentMethod("legend","draw")(E),u.getComponentMethod("rangeselector","draw")(E),u.getComponentMethod("sliders","draw")(E),u.getComponentMethod("updatemenus","draw")(E),u.getComponentMethod("colorbar","draw")(E)}},{"../components/color":367,"../components/drawing":389,"../components/modebar":430,"../components/titles":476,"../constants/alignment":483,"../lib":515,"../lib/clear_gl_canvases":499,"../plots/cartesian/autorange":565,"../plots/cartesian/axes":566,"../plots/cartesian/constraints":574,"../plots/plots":628,"../registry":647,"@plotly/d3":58}],557:[function(t,P,R){var h=t("../lib"),u=h.isPlainObject,A=t("./plot_schema"),T=t("../plots/plots"),e=t("../plots/attributes"),i=t("./plot_template"),n=t("./plot_config").dfltConfig;R.makeTemplate=function(v){v=h.isPlainObject(v)?v:h.getGraphDiv(v),v=h.extendDeep({_context:n},{data:v.data,layout:v.layout}),T.supplyDefaults(v);var x=v.data||[],l=v.layout||{};l._basePlotModules=v._fullLayout._basePlotModules,l._modules=v._fullLayout._modules;var b={data:{},layout:{}};x.forEach(function(k){var B={};f(k,B,s.bind(null,k));var z=h.coerce(k,{},e,"type"),F=b.data[z];F||(F=b.data[z]=[]),F.push(B)}),f(l,b.layout,o.bind(null,l)),delete b.layout.template;var c=l.template;if(u(c)){var M=c.layout,_,y,w,d,C,S;u(M)&&a(M,b.layout);var E=c.data;if(u(E)){for(y in b.data)if(w=E[y],Array.isArray(w)){for(C=b.data[y],S=C.length,d=w.length,_=0;_<S;_++)a(w[_%d],C[_]);for(_=S;_<d;_++)C.push(h.extendDeep({},w[_]))}for(y in E)y in b.data||(b.data[y]=h.extendDeep([],E[y]))}}return b};function a(v,x){v=h.extendDeep({},v);var l=Object.keys(v).sort(),b,c;function M(C,S,E){if(u(S)&&u(C))a(C,S);else if(Array.isArray(S)&&Array.isArray(C)){var k=i.arrayTemplater({_template:v},E);for(c=0;c<S.length;c++){var B=S[c],z=k.newItem(B)._template;z&&a(z,B)}var F=k.defaultItems();for(c=0;c<F.length;c++)S.push(F[c]._template);for(c=0;c<S.length;c++)delete S[c].templateitemname}}for(b=0;b<l.length;b++){var _=l[b],y=v[_];if(_ in x?M(y,x[_],_):x[_]=y,r(_)===_)for(var w in x){var d=r(w);w!==d&&d===_&&!(w in v)&&M(y,x[w],_)}}}function r(v){return v.replace(/[0-9]+$/,"")}function f(v,x,l,b,c){var M=c&&l(c);for(var _ in v){var y=v[_],w=m(v,_,b),d=m(v,_,c),C=l(d);if(!C){var S=r(_);S!==_&&(d=m(v,S,c),C=l(d))}if(!(M&&M===C)&&!(!C||C._noTemplating||C.valType==="data_array"||C.arrayOk&&Array.isArray(y)))if(!C.valType&&u(y))f(y,x,l,w,d);else if(C._isLinkedToArray&&Array.isArray(y))for(var E=!1,k=0,B={},z=0;z<y.length;z++){var F=y[z];if(u(F)){var I=F.name;if(I)B[I]||(f(F,x,l,m(y,k,w),m(y,k,d)),k++,B[I]=1);else if(!E){var O=i.arrayDefaultKey(_),N=m(v,O,b),V=m(y,k,w);f(F,x,l,V,m(y,k,d));var H=h.nestedProperty(x,V),j=h.nestedProperty(x,N);j.set(H.get()),H.set(null),E=!0}}}else{var Z=h.nestedProperty(x,w);Z.set(y)}}}function o(v,x){return A.getLayoutValObject(v,h.nestedProperty({},x).parts)}function s(v,x){return A.getTraceValObject(v,h.nestedProperty({},x).parts)}function m(v,x,l){var b;return l?Array.isArray(v)?b=l+"["+x+"]":b=l+"."+x:b=x,b}R.validateTemplate=function(v,x){var l=h.extendDeep({},{_context:n,data:v.data,layout:v.layout}),b=l.layout||{};u(x)||(x=b.template||{});var c=x.layout,M=x.data,_=[];l.layout=b,l.layout.template=x,T.supplyDefaults(l);var y=l._fullLayout,w=l._fullData,d={};function C(N,V){for(var H in N)if(H.charAt(0)!=="_"&&u(N[H])){var j=r(H),Z=[],X;for(X=0;X<V.length;X++)Z.push(m(N,H,V[X])),j!==H&&Z.push(m(N,j,V[X]));for(X=0;X<Z.length;X++)d[Z[X]]=1;C(N[H],Z)}}function S(N,V){for(var H in N)if(H.indexOf("defaults")===-1&&u(N[H])){var j=m(N,H,V);d[j]?S(N[H],j):_.push({code:"unused",path:j})}}if(u(c)?(C(y,["layout"]),S(c,"layout")):_.push({code:"layout"}),!u(M))_.push({code:"data"});else{for(var E={},k,B=0;B<w.length;B++){var z=w[B];k=z.type,E[k]=(E[k]||0)+1,z._fullInput._template||_.push({code:"missing",index:z._fullInput.index,traceType:k})}for(k in M){var F=M[k].length,I=E[k]||0;F>I?_.push({code:"unused",traceType:k,templateCount:F,dataCount:I}):I>F&&_.push({code:"reused",traceType:k,templateCount:F,dataCount:I})}}function O(N,V){for(var H in N)if(H.charAt(0)!=="_"){var j=N[H],Z=m(N,H,V);u(j)?(Array.isArray(N)&&j._template===!1&&j.templateitemname&&_.push({code:"missing",path:Z,templateitemname:j.templateitemname}),O(j,Z)):Array.isArray(j)&&g(j)&&O(j,Z)}}if(O({data:w,layout:y},""),_.length)return _.map(p)};function g(v){for(var x=0;x<v.length;x++)if(u(v[x]))return!0}function p(v){var x;switch(v.code){case"data":x="The template has no key data.";break;case"layout":x="The template has no key layout.";break;case"missing":v.path?x="There are no templates for item "+v.path+" with name "+v.templateitemname:x="There are no templates for trace "+v.index+", of type "+v.traceType+".";break;case"unused":v.path?x="The template item at "+v.path+" was not used in constructing the plot.":v.dataCount?x="Some of the templates of type "+v.traceType+" were not used. The template has "+v.templateCount+" traces, the data only has "+v.dataCount+" of this type.":x="The template has "+v.templateCount+" traces of type "+v.traceType+" but there are none in the data.";break;case"reused":x="Some of the templates of type "+v.traceType+" were used more than once. The template has "+v.templateCount+" traces, the data has "+v.dataCount+" of this type.";break}return v.msg=x,v}},{"../lib":515,"../plots/attributes":562,"../plots/plots":628,"./plot_config":553,"./plot_schema":554,"./plot_template":555}],558:[function(t,P,R){var h=t("fast-isnumeric"),u=t("./plot_api"),A=t("../plots/plots"),T=t("../lib"),e=t("../snapshot/helpers"),i=t("../snapshot/tosvg"),n=t("../snapshot/svgtoimg"),a=t("../version").version,r={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};function f(o,s){s=s||{};var m,g,p,v;T.isPlainObject(o)?(m=o.data||[],g=o.layout||{},p=o.config||{},v={}):(o=T.getGraphDiv(o),m=T.extendDeep([],o.data),g=T.extendDeep({},o.layout),p=o._context,v=o._fullLayout||{});function x(I){return!(I in s)||T.validate(s[I],r[I])}if(!x("width")&&s.width!==null||!x("height")&&s.height!==null)throw new Error("Height and width should be pixel values.");if(!x("format"))throw new Error("Export format is not "+T.join2(r.format.values,", "," or ")+".");var l={};function b(I,O){return T.coerce(s,l,r,I,O)}var c=b("format"),M=b("width"),_=b("height"),y=b("scale"),w=b("setBackground"),d=b("imageDataOnly"),C=document.createElement("div");C.style.position="absolute",C.style.left="-5000px",document.body.appendChild(C);var S=T.extendFlat({},g);M?S.width=M:s.width===null&&h(v.width)&&(S.width=v.width),_?S.height=_:s.height===null&&h(v.height)&&(S.height=v.height);var E=T.extendFlat({},p,{_exportedPlot:!0,staticPlot:!0,setBackground:w}),k=e.getRedrawFunc(C);function B(){return new Promise(function(I){setTimeout(I,e.getDelay(C._fullLayout))})}function z(){return new Promise(function(I,O){var N=i(C,c,y),V=C._fullLayout.width,H=C._fullLayout.height;function j(){u.purge(C),document.body.removeChild(C)}if(c==="full-json"){var Z=A.graphJson(C,!1,"keepdata","object",!0,!0);return Z.version=a,Z=JSON.stringify(Z),j(),I(d?Z:e.encodeJSON(Z))}if(j(),c==="svg")return I(d?N:e.encodeSVG(N));var X=document.createElement("canvas");X.id=T.randstr(),n({format:c,width:V,height:H,scale:y,canvas:X,svg:N,promise:!0}).then(I).catch(O)})}function F(I){return d?I.replace(e.IMAGE_URL_PREFIX,""):I}return new Promise(function(I,O){u.newPlot(C,m,S,E).then(k).then(B).then(z).then(function(N){I(F(N))}).catch(function(N){O(N)})})}P.exports=f},{"../lib":515,"../plots/plots":628,"../snapshot/helpers":651,"../snapshot/svgtoimg":653,"../snapshot/tosvg":655,"../version":1132,"./plot_api":552,"fast-isnumeric":190}],559:[function(t,P,R){var h=t("../lib"),u=t("../plots/plots"),A=t("./plot_schema"),T=t("./plot_config").dfltConfig,e=h.isPlainObject,i=Array.isArray,n=h.isArrayOrTypedArray;P.exports=function(b,c){b===void 0&&(b=[]),c===void 0&&(c={});var M=A.get(),_=[],y={_context:h.extendFlat({},T)},w,d;i(b)?(y.data=h.extendDeep([],b),w=b):(y.data=[],w=[],_.push(s("array","data"))),e(c)?(y.layout=h.extendDeep({},c),d=c):(y.layout={},d={},arguments.length>1&&_.push(s("object","layout"))),u.supplyDefaults(y);for(var C=y._fullData,S=w.length,E=0;E<S;E++){var k=w[E],B=["data",E];if(!e(k)){_.push(s("object",B));continue}var z=C[E],F=z.type,I=M.traces[F].attributes;I.type={valType:"enumerated",values:[F]},z.visible===!1&&k.visible!==!1&&_.push(s("invisible",B)),a(k,z,I,_,B);var O=k.transforms,N=z.transforms;if(O){i(O)||_.push(s("array",B,["transforms"])),B.push("transforms");for(var V=0;V<O.length;V++){var H=["transforms",V],j=O[V].type;if(!e(O[V])){_.push(s("object",B,H));continue}var Z=M.transforms[j]?M.transforms[j].attributes:{};Z.type={valType:"enumerated",values:Object.keys(M.transforms)},a(O[V],N[V],Z,_,B,H)}}}var X=y._fullLayout,re=r(M,C);return a(d,X,re,_,"layout"),_.length===0?void 0:_};function a(l,b,c,M,_,y){y=y||[];for(var w=Object.keys(l),d=0;d<w.length;d++){var C=w[d];if(C!=="transforms"){var S=y.slice();S.push(C);var E=l[C],k=b[C],B=g(c,C),z=(B||{}).valType,F=z==="info_array",I=z==="colorscale",O=(B||{}).items;if(!m(c,C))M.push(s("schema",_,S));else if(e(E)&&e(k)&&z!=="any")a(E,k,B,M,_,S);else if(F&&i(E)){E.length>k.length&&M.push(s("unused",_,S.concat(k.length)));var N=k.length,V=Array.isArray(O);V&&(N=Math.min(N,O.length));var H,j,Z,X,re;if(B.dimensions===2)for(j=0;j<N;j++)if(i(E[j])){E[j].length>k[j].length&&M.push(s("unused",_,S.concat(j,k[j].length)));var ue=k[j].length;for(H=0;H<(V?Math.min(ue,O[j].length):ue);H++)Z=V?O[j][H]:O,X=E[j][H],re=k[j][H],h.validate(X,Z)?re!==X&&re!==+X&&M.push(s("dynamic",_,S.concat(j,H),X,re)):M.push(s("value",_,S.concat(j,H),X))}else M.push(s("array",_,S.concat(j),E[j]));else for(j=0;j<N;j++)Z=V?O[j]:O,X=E[j],re=k[j],h.validate(X,Z)?re!==X&&re!==+X&&M.push(s("dynamic",_,S.concat(j),X,re)):M.push(s("value",_,S.concat(j),X))}else if(B.items&&!F&&i(E)){var K=O[Object.keys(O)[0]],te=[],G,Y;for(G=0;G<k.length;G++){var ee=k[G]._index||G;if(Y=S.slice(),Y.push(ee),e(E[ee])&&e(k[G])){te.push(ee);var ne=E[ee],J=k[G];e(ne)&&ne.visible!==!1&&J.visible===!1?M.push(s("invisible",_,Y)):a(ne,J,K,M,_,Y)}}for(G=0;G<E.length;G++)Y=S.slice(),Y.push(G),e(E[G])?te.indexOf(G)===-1&&M.push(s("unused",_,Y)):M.push(s("object",_,Y,E[G]))}else!e(E)&&e(k)?M.push(s("object",_,S,E)):!n(E)&&n(k)&&!F&&!I?M.push(s("array",_,S,E)):C in b?h.validate(E,B)?B.valType==="enumerated"&&(B.coerceNumber&&E!==+k||E!==k)&&M.push(s("dynamic",_,S,E,k)):M.push(s("value",_,S,E)):M.push(s("unused",_,S,E))}}return M}function r(l,b){for(var c=l.layout.layoutAttributes,M=0;M<b.length;M++){var _=b[M],y=l.traces[_.type],w=y.layoutAttributes;w&&(_.subplot?h.extendFlat(c[y.attributes.subplot.dflt],w):h.extendFlat(c,w))}return c}var f={object:function(l,b){var c;return l==="layout"&&b===""?c="The layout argument":l[0]==="data"&&b===""?c="Trace "+l[1]+" in the data argument":c=o(l)+"key "+b,c+" must be linked to an object container"},array:function(l,b){var c;return l==="data"?c="The data argument":c=o(l)+"key "+b,c+" must be linked to an array container"},schema:function(l,b){return o(l)+"key "+b+" is not part of the schema"},unused:function(l,b,c){var M=e(c)?"container":"key";return o(l)+M+" "+b+" did not get coerced"},dynamic:function(l,b,c,M){return[o(l)+"key",b,"(set to '"+c+"')","got reset to","'"+M+"'","during defaults."].join(" ")},invisible:function(l,b){return(b?o(l)+"item "+b:"Trace "+l[1])+" got defaulted to be not visible"},value:function(l,b,c){return[o(l)+"key "+b,"is set to an invalid value ("+c+")"].join(" ")}};function o(l){return i(l)?"In data trace "+l[1]+", ":"In "+l+", "}function s(l,b,c,M,_){c=c||"";var y,w;i(b)?(y=b[0],w=b[1]):(y=b,w=null);var d=x(c),C=f[l](b,d,M,_);return h.log(C),{code:l,container:y,trace:w,path:c,astr:d,msg:C}}function m(l,b){var c=v(b),M=c.keyMinusId,_=c.id;return M in l&&l[M]._isSubplotObj&&_?!0:b in l}function g(l,b){if(b in l)return l[b];var c=v(b);return l[c.keyMinusId]}var p=h.counterRegex("([a-z]+)");function v(l){var b=l.match(p);return{keyMinusId:b&&b[1],id:b&&b[2]}}function x(l){if(!i(l))return String(l);for(var b="",c=0;c<l.length;c++){var M=l[c];typeof M=="number"?b=b.substr(0,b.length-1)+"["+M+"]":b+=M,c<l.length-1&&(b+=".")}return b}},{"../lib":515,"../plots/plots":628,"./plot_config":553,"./plot_schema":554}],560:[function(t,P,R){P.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],561:[function(t,P,R){var h=t("../lib"),u=t("../plot_api/plot_template");P.exports=function(T,e,i){var n=i.name,a=i.inclusionAttr||"visible",r=e[n],f=h.isArrayOrTypedArray(T[n])?T[n]:[],o=e[n]=[],s=u.arrayTemplater(e,n,a),m,g;for(m=0;m<f.length;m++){var p=f[m];h.isPlainObject(p)?g=s.newItem(p):(g=s.newItem({}),g[a]=!1),g._index=m,g[a]!==!1&&i.handleItemDefaults(p,g,e,i),o.push(g)}var v=s.defaultItems();for(m=0;m<v.length;m++)g=v[m],g._index=o.length,i.handleItemDefaults({},g,e,i,{}),o.push(g);if(h.isArrayOrTypedArray(r)){var x=Math.min(r.length,o.length);for(m=0;m<x;m++)h.relinkPrivateKeys(o[m],r[m])}return o}},{"../lib":515,"../plot_api/plot_template":555}],562:[function(t,P,R){var h=t("./font_attributes"),u=t("../components/fx/attributes");P.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:h({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},legendwidth:{valType:"number",min:0,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:u.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":398,"./font_attributes":594}],563:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib"),A=u.dateTime2ms,T=u.incrementMonth,e=t("../../constants/numerical"),i=e.ONEAVGMONTH;P.exports=function(a,r,f,o){if(r.type!=="date")return{vals:o};var s=a[f+"periodalignment"];if(!s)return{vals:o};var m=a[f+"period"],g;if(h(m)){if(m=+m,m<=0)return{vals:o}}else if(typeof m=="string"&&m.charAt(0)==="M"){var p=+m.substring(1);if(p>0&&Math.round(p)===p)g=p;else return{vals:o}}for(var v=r.calendar,x=s==="start",l=s==="end",b=a[f+"period0"],c=A(b,v)||0,M=[],_=[],y=[],w=o.length,d=0;d<w;d++){var C=o[d],S,E,k;if(g){for(S=Math.round((C-c)/(g*i)),k=T(c,g*S,v);k>C;)k=T(k,-g,v);for(;k<=C;)k=T(k,g,v);E=T(k,-g,v)}else{for(S=Math.round((C-c)/m),k=c+S*m;k>C;)k-=m;for(;k<=C;)k+=m;E=k-m}M[d]=x?E:l?k:(E+k)/2,_[d]=E,y[d]=k}return{vals:M,starts:_,ends:y}}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],564:[function(t,P,R){P.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],565:[function(t,P,R){var h=t("@plotly/d3"),u=t("fast-isnumeric"),A=t("../../lib"),T=t("../../constants/numerical").FP_SAFE,e=t("../../registry"),i=t("../../components/drawing"),n=t("./axis_ids"),a=n.getFromId,r=n.isLinked;P.exports={getAutoRange:f,makePadFn:s,doAutoRange:v,findExtremes:x,concatExtremes:p};function f(w,d){var C,S,E=[],k=w._fullLayout,B=s(k,d,0),z=s(k,d,1),F=p(w,d),I=F.min,O=F.max;if(I.length===0||O.length===0)return A.simpleMap(d.range,d.r2l);var N=I[0].val,V=O[0].val;for(C=1;C<I.length&&N===V;C++)N=Math.min(N,I[C].val);for(C=1;C<O.length&&N===V;C++)V=Math.max(V,O[C].val);var H=!1;if(d.range){var j=A.simpleMap(d.range,d.r2l);H=j[1]<j[0]}d.autorange==="reversed"&&(H=!0,d.autorange=!0);var Z=d.rangemode,X=Z==="tozero",re=Z==="nonnegative",ue=d._length,K=ue/10,te=0,G,Y,ee,ne,J,q;for(C=0;C<I.length;C++)for(G=I[C],S=0;S<O.length;S++)Y=O[S],q=Y.val-G.val-o(d,G.val,Y.val),q>0&&(J=ue-B(G)-z(Y),J>K?q/J>te&&(ee=G,ne=Y,te=q/J):q/ue>te&&(ee={val:G.val,nopad:1},ne={val:Y.val,nopad:1},te=q/ue));function ae(oe,he){return Math.max(oe,z(he))}if(N===V){var le=N-1,ie=N+1;if(X)if(N===0)E=[0,1];else{var se=(N>0?O:I).reduce(ae,0),xe=N/(1-Math.min(.5,se/ue));E=N>0?[0,xe]:[xe,0]}else re?E=[Math.max(0,le),Math.max(1,ie)]:E=[le,ie]}else X?(ee.val>=0&&(ee={val:0,nopad:1}),ne.val<=0&&(ne={val:0,nopad:1})):re&&(ee.val-te*B(ee)<0&&(ee={val:0,nopad:1}),ne.val<=0&&(ne={val:1,nopad:1})),te=(ne.val-ee.val-o(d,G.val,Y.val))/(ue-B(ee)-z(ne)),E=[ee.val-te*B(ee),ne.val+te*z(ne)];return H&&E.reverse(),A.simpleMap(E,d.l2r||Number)}function o(w,d,C){var S=0;if(w.rangebreaks)for(var E=w.locateBreaks(d,C),k=0;k<E.length;k++){var B=E[k];S+=B.max-B.min}return S}function s(w,d,C){var S=.05*d._length,E=d._anchorAxis||{};if((d.ticklabelposition||"").indexOf("inside")!==-1||(E.ticklabelposition||"").indexOf("inside")!==-1){var k=d.autorange==="reversed";if(!k){var B=A.simpleMap(d.range,d.r2l);k=B[1]<B[0]}k&&(C=!C)}var z=0;return r(w,d._id)||(z=g(w,d,C)),S=Math.max(z,S),d.constrain==="domain"&&d._inputDomain&&(S*=(d._inputDomain[1]-d._inputDomain[0])/(d.domain[1]-d.domain[0])),function(I){return I.nopad?0:I.pad+(I.extrapad?S:z)}}var m=3;function g(w,d,C){var S=0,E=d._id.charAt(0)==="x";for(var k in w._plots){var B=w._plots[k];if(!(d._id!==B.xaxis._id&&d._id!==B.yaxis._id)){var z=(E?B.yaxis:B.xaxis)||{};if((z.ticklabelposition||"").indexOf("inside")!==-1&&(!C&&(z.side==="left"||z.side==="bottom")||C&&(z.side==="top"||z.side==="right"))){if(z._vals){var F=A.deg2rad(z._tickAngles[z._id+"tick"]||0),I=Math.abs(Math.cos(F)),O=Math.abs(Math.sin(F));if(!z._vals[0].bb){var N=z._id+"tick",V=z._selections[N];V.each(function(ue){var K=h.select(this),te=K.select(".text-math-group");te.empty()&&(ue.bb=i.bBox(K.node()))})}for(var H=0;H<z._vals.length;H++){var j=z._vals[H],Z=j.bb;if(Z){var X=2*m+Z.width,re=2*m+Z.height;S=Math.max(S,E?Math.max(X*I,re*O):Math.max(re*I,X*O))}}}z.ticks==="inside"&&z.ticklabelposition==="inside"&&(S+=z.ticklen||0)}}}return S}function p(w,d,C){var S=d._id,E=w._fullData,k=w._fullLayout,B=[],z=[],F,I,O;function N(X,re){for(F=0;F<re.length;F++){var ue=X[re[F]],K=(ue._extremes||{})[S];if(ue.visible===!0&&K){for(I=0;I<K.min.length;I++)O=K.min[I],l(B,O.val,O.pad,{extrapad:O.extrapad});for(I=0;I<K.max.length;I++)O=K.max[I],b(z,O.val,O.pad,{extrapad:O.extrapad})}}}if(N(E,d._traceIndices),N(k.annotations||[],d._annIndices||[]),N(k.shapes||[],d._shapeIndices||[]),d._matchGroup&&!C){for(var V in d._matchGroup)if(V!==d._id){var H=a(w,V),j=p(w,H,!0),Z=d._length/H._length;for(I=0;I<j.min.length;I++)O=j.min[I],l(B,O.val,O.pad*Z,{extrapad:O.extrapad});for(I=0;I<j.max.length;I++)O=j.max[I],b(z,O.val,O.pad*Z,{extrapad:O.extrapad})}}return{min:B,max:z}}function v(w,d,C){if(d.setScale(),d.autorange){d.range=C?C.slice():f(w,d),d._r=d.range.slice(),d._rl=A.simpleMap(d._r,d.r2l);var S=d._input,E={};E[d._attr+".range"]=d.range,E[d._attr+".autorange"]=d.autorange,e.call("_storeDirectGUIEdit",w.layout,w._fullLayout._preGUI,E),S.range=d.range.slice(),S.autorange=d.autorange}var k=d._anchorAxis;if(k&&k.rangeslider){var B=k.rangeslider[d._name];B&&B.rangemode==="auto"&&(B.range=f(w,d)),k._input.rangeslider[d._name]=A.extendFlat({},B)}}function x(w,d,C){C||(C={}),w._m||w.setScale();var S=[],E=[],k=d.length,B=C.padded||!1,z=C.tozero&&(w.type==="linear"||w.type==="-"),F=w.type==="log",I=!1,O=C.vpadLinearized||!1,N,V,H,j,Z,X,re,ue,K;function te(le){if(Array.isArray(le))return I=!0,function(se){return Math.max(Number(le[se]||0),0)};var ie=Math.max(Number(le||0),0);return function(){return ie}}var G=te((w._m>0?C.ppadplus:C.ppadminus)||C.ppad||0),Y=te((w._m>0?C.ppadminus:C.ppadplus)||C.ppad||0),ee=te(C.vpadplus||C.vpad),ne=te(C.vpadminus||C.vpad);if(!I){if(ue=1/0,K=-1/0,F)for(N=0;N<k;N++)V=d[N],V<ue&&V>0&&(ue=V),V>K&&V<T&&(K=V);else for(N=0;N<k;N++)V=d[N],V<ue&&V>-T&&(ue=V),V>K&&V<T&&(K=V);d=[ue,K],k=2}var J={tozero:z,extrapad:B};function q(le){H=d[le],u(H)&&(X=G(le),re=Y(le),O?(j=w.c2l(H)-ne(le),Z=w.c2l(H)+ee(le)):(ue=H-ne(le),K=H+ee(le),F&&ue<K/10&&(ue=K/10),j=w.c2l(ue),Z=w.c2l(K)),z&&(j=Math.min(0,j),Z=Math.max(0,Z)),M(j)&&l(S,j,re,J),M(Z)&&b(E,Z,X,J))}var ae=Math.min(6,k);for(N=0;N<ae;N++)q(N);for(N=k-1;N>=ae;N--)q(N);return{min:S,max:E,opts:C}}function l(w,d,C,S){c(w,d,C,S,_)}function b(w,d,C,S){c(w,d,C,S,y)}function c(w,d,C,S,E){for(var k=S.tozero,B=S.extrapad,z=!0,F=0;F<w.length&&z;F++){var I=w[F];if(E(I.val,d)&&I.pad>=C&&(I.extrapad||!B)){z=!1;break}else E(d,I.val)&&I.pad<=C&&(B||!I.extrapad)&&(w.splice(F,1),F--)}if(z){var O=k&&d===0;w.push({val:d,pad:O?0:C,extrapad:O?!1:B})}}function M(w){return u(w)&&Math.abs(w)<T}function _(w,d){return w<=d}function y(w,d){return w>=d}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../../registry":647,"./axis_ids":570,"@plotly/d3":58,"fast-isnumeric":190}],566:[function(t,P,R){var h=t("@plotly/d3"),u=t("fast-isnumeric"),A=t("../../plots/plots"),T=t("../../registry"),e=t("../../lib"),i=e.strTranslate,n=t("../../lib/svg_text_utils"),a=t("../../components/titles"),r=t("../../components/color"),f=t("../../components/drawing"),o=t("./layout_attributes"),s=t("./clean_ticks"),m=t("../../constants/numerical"),g=m.ONEMAXYEAR,p=m.ONEAVGYEAR,v=m.ONEMINYEAR,x=m.ONEMAXQUARTER,l=m.ONEAVGQUARTER,b=m.ONEMINQUARTER,c=m.ONEMAXMONTH,M=m.ONEAVGMONTH,_=m.ONEMINMONTH,y=m.ONEWEEK,w=m.ONEDAY,d=w/2,C=m.ONEHOUR,S=m.ONEMIN,E=m.ONESEC,k=m.MINUS_SIGN,B=m.BADNUM,z={K:"zeroline"},F={K:"gridline",L:"path"},I={K:"minor-gridline",L:"path"},O={K:"tick",L:"path"},N={K:"tick",L:"text"},V={width:["x","r","l","xl","xr"],height:["y","t","b","yt","yb"],right:["r","xr"],left:["l","xl"],top:["t","yt"],bottom:["b","yb"]},H=t("../../constants/alignment"),j=H.MID_SHIFT,Z=H.CAP_SHIFT,X=H.LINE_SPACING,re=H.OPPOSITE_SIDE,ue=3,K=P.exports={};K.setConvert=t("./set_convert");var te=t("./axis_autotype"),G=t("./axis_ids"),Y=G.idSort,ee=G.isLinked;K.id2name=G.id2name,K.name2id=G.name2id,K.cleanId=G.cleanId,K.list=G.list,K.listIds=G.listIds,K.getFromId=G.getFromId,K.getFromTrace=G.getFromTrace;var ne=t("./autorange");K.getAutoRange=ne.getAutoRange,K.findExtremes=ne.findExtremes;var J=1e-4;function q(Pe){var ke=(Pe[1]-Pe[0])*J;return[Pe[0]-ke,Pe[1]+ke]}K.coerceRef=function(Pe,ke,it,ut,ht,Et){var yt=ut.charAt(ut.length-1),Dt=it._fullLayout._subplots[yt+"axis"],Xt=ut+"ref",ar={};return ht||(ht=Dt[0]||(typeof Et=="string"?Et:Et[0])),Et||(Et=ht),Dt=Dt.concat(Dt.map(function(kr){return kr+" domain"})),ar[Xt]={valType:"enumerated",values:Dt.concat(Et?typeof Et=="string"?[Et]:Et:[]),dflt:ht},e.coerce(Pe,ke,ar,Xt)},K.getRefType=function(Pe){return Pe===void 0?Pe:Pe==="paper"?"paper":Pe==="pixel"?"pixel":/( domain)$/.test(Pe)?"domain":"range"},K.coercePosition=function(Pe,ke,it,ut,ht,Et){var yt,Dt,Xt=K.getRefType(ut);if(Xt!=="range")yt=e.ensureNumber,Dt=it(ht,Et);else{var ar=K.getFromId(ke,ut);Et=ar.fraction2r(Et),Dt=it(ht,Et),yt=ar.cleanPos}Pe[ht]=yt(Dt)},K.cleanPosition=function(Pe,ke,it){var ut=it==="paper"||it==="pixel"?e.ensureNumber:K.getFromId(ke,it).cleanPos;return ut(Pe)},K.redrawComponents=function(Pe,ke){ke=ke||K.listIds(Pe);var it=Pe._fullLayout;function ut(ht,Et,yt,Dt){for(var Xt=T.getComponentMethod(ht,Et),ar={},kr=0;kr<ke.length;kr++)for(var wr=it[K.id2name(ke[kr])],Sr=wr[yt],Zr=0;Zr<Sr.length;Zr++){var ir=Sr[Zr];if(!ar[ir]&&(Xt(Pe,ir),ar[ir]=1,Dt))return}}ut("annotations","drawOne","_annIndices"),ut("shapes","drawOne","_shapeIndices"),ut("images","draw","_imgIndices",!0),ut("selections","drawOne","_selectionIndices")};var ae=K.getDataConversions=function(Pe,ke,it,ut){var ht,Et=it==="x"||it==="y"||it==="z"?it:ut;if(Array.isArray(Et)){if(ht={type:te(ut,void 0,{autotypenumbers:Pe._fullLayout.autotypenumbers}),_categories:[]},K.setConvert(ht),ht.type==="category")for(var yt=0;yt<ut.length;yt++)ht.d2c(ut[yt])}else ht=K.getFromTrace(Pe,ke,Et);return ht?{d2c:ht.d2c,c2d:ht.c2d}:Et==="ids"?{d2c:ie,c2d:ie}:{d2c:le,c2d:le}};function le(Pe){return+Pe}function ie(Pe){return String(Pe)}K.getDataToCoordFunc=function(Pe,ke,it,ut){return ae(Pe,ke,it,ut).d2c},K.counterLetter=function(Pe){var ke=Pe.charAt(0);if(ke==="x")return"y";if(ke==="y")return"x"},K.minDtick=function(Pe,ke,it,ut){["log","category","multicategory"].indexOf(Pe.type)!==-1||!ut?Pe._minDtick=0:Pe._minDtick===void 0?(Pe._minDtick=ke,Pe._forceTick0=it):Pe._minDtick&&((Pe._minDtick/ke+1e-6)%1<2e-6&&((it-Pe._forceTick0)/ke%1+1.000001)%1<2e-6?(Pe._minDtick=ke,Pe._forceTick0=it):((ke/Pe._minDtick+1e-6)%1>2e-6||((it-Pe._forceTick0)/Pe._minDtick%1+1.000001)%1>2e-6)&&(Pe._minDtick=0))},K.saveRangeInitial=function(Pe,ke){for(var it=K.list(Pe,"",!0),ut=!1,ht=0;ht<it.length;ht++){var Et=it[ht],yt=Et._rangeInitial===void 0,Dt=yt||!(Et.range[0]===Et._rangeInitial[0]&&Et.range[1]===Et._rangeInitial[1]);(yt&&Et.autorange===!1||ke&&Dt)&&(Et._rangeInitial=Et.range.slice(),ut=!0)}return ut},K.saveShowSpikeInitial=function(Pe,ke){for(var it=K.list(Pe,"",!0),ut=!1,ht="on",Et=0;Et<it.length;Et++){var yt=it[Et],Dt=yt._showSpikeInitial===void 0,Xt=Dt||yt.showspikes!==yt._showspikes;(Dt||ke&&Xt)&&(yt._showSpikeInitial=yt.showspikes,ut=!0),ht==="on"&&!yt.showspikes&&(ht="off")}return Pe._fullLayout._cartesianSpikesEnabled=ht,ut},K.autoBin=function(Pe,ke,it,ut,ht,Et){var yt=e.aggNums(Math.min,null,Pe),Dt=e.aggNums(Math.max,null,Pe);if(ke.type==="category"||ke.type==="multicategory")return{start:yt-.5,end:Dt+.5,size:Math.max(1,Math.round(Et)||1),_dataSpan:Dt-yt};ht||(ht=ke.calendar);var Xt;if(ke.type==="log"?Xt={type:"linear",range:[yt,Dt]}:Xt={type:ke.type,range:e.simpleMap([yt,Dt],ke.c2r,0,ht),calendar:ht},K.setConvert(Xt),Et=Et&&s.dtick(Et,Xt.type),Et)Xt.dtick=Et,Xt.tick0=s.tick0(void 0,Xt.type,ht);else{var ar;if(it)ar=(Dt-yt)/it;else{var kr=e.distinctVals(Pe),wr=Math.pow(10,Math.floor(Math.log(kr.minDiff)/Math.LN10)),Sr=wr*e.roundUp(kr.minDiff/wr,[.9,1.9,4.9,9.9],!0);ar=Math.max(Sr,2*e.stdev(Pe)/Math.pow(Pe.length,ut?.25:.4)),u(ar)||(ar=1)}K.autoTicks(Xt,ar)}var Zr=Xt.dtick,ir=K.tickIncrement(K.tickFirst(Xt),Zr,"reverse",ht),xr,Fr;if(typeof Zr=="number")ir=se(ir,Pe,Xt,yt,Dt),Fr=1+Math.floor((Dt-ir)/Zr),xr=ir+Fr*Zr;else for(Xt.dtick.charAt(0)==="M"&&(ir=xe(ir,Pe,Zr,yt,ht)),xr=ir,Fr=0;xr<=Dt;)xr=K.tickIncrement(xr,Zr,!1,ht),Fr++;return{start:ke.c2r(ir,0,ht),end:ke.c2r(xr,0,ht),size:Zr,_dataSpan:Dt-yt}};function se(Pe,ke,it,ut,ht){var Et=0,yt=0,Dt=0,Xt=0;function ar(Zr){return(1+(Zr-Pe)*100/it.dtick)%100<2}for(var kr=0;kr<ke.length;kr++)ke[kr]%1===0?Dt++:u(ke[kr])||Xt++,ar(ke[kr])&&Et++,ar(ke[kr]+it.dtick/2)&&yt++;var wr=ke.length-Xt;if(Dt===wr&&it.type!=="date")it.dtick<1?Pe=ut-.5*it.dtick:(Pe-=.5,Pe+it.dtick<ut&&(Pe+=it.dtick));else if(yt<wr*.1&&(Et>wr*.3||ar(ut)||ar(ht))){var Sr=it.dtick/2;Pe+=Pe+Sr<ut?Sr:-Sr}return Pe}function xe(Pe,ke,it,ut,ht){var Et=e.findExactDates(ke,ht),yt=.8;if(Et.exactDays>yt){var Dt=Number(it.substr(1));Et.exactYears>yt&&Dt%12===0?Pe=K.tickIncrement(Pe,"M6","reverse")+w*1.5:Et.exactMonths>yt?Pe=K.tickIncrement(Pe,"M1","reverse")+w*15.5:Pe-=d;var Xt=K.tickIncrement(Pe,it);if(Xt<=ut)return Xt}return Pe}K.prepMinorTicks=function(Pe,ke,it){if(!ke.minor.dtick){delete Pe.dtick;var ut=ke.dtick&&u(ke._tmin),ht;if(ut){var Et=K.tickIncrement(ke._tmin,ke.dtick,!0);ht=[ke._tmin,Et*.99+ke._tmin*.01]}else{var yt=e.simpleMap(ke.range,ke.r2l);ht=[yt[0],.8*yt[0]+.2*yt[1]]}if(Pe.range=e.simpleMap(ht,ke.l2r),Pe._isMinor=!0,K.prepTicks(Pe,it),ut){var Dt=u(ke.dtick),Xt=u(Pe.dtick),ar=Dt?ke.dtick:+ke.dtick.substring(1),kr=Xt?Pe.dtick:+Pe.dtick.substring(1);Dt&&Xt?oe(ar,kr)?ar===2*y&&kr===2*w&&(Pe.dtick=y):ar===2*y&&kr===3*w?Pe.dtick=y:ar===y&&!(ke._input.minor||{}).nticks?Pe.dtick=w:he(ar/kr,2.5)?Pe.dtick=ar/2:Pe.dtick=ar:String(ke.dtick).charAt(0)==="M"?Xt?Pe.dtick="M1":oe(ar,kr)?ar>=12&&kr===2&&(Pe.dtick="M3"):Pe.dtick=ke.dtick:String(Pe.dtick).charAt(0)==="L"?String(ke.dtick).charAt(0)==="L"?oe(ar,kr)||(Pe.dtick=he(ar/kr,2.5)?ke.dtick/2:ke.dtick):Pe.dtick="D1":Pe.dtick==="D2"&&+ke.dtick>1&&(Pe.dtick=1)}Pe.range=ke.range}ke.minor._tick0Init===void 0&&(Pe.tick0=ke.tick0)};function oe(Pe,ke){return Math.abs((Pe/ke+.5)%1-.5)<.001}function he(Pe,ke){return Math.abs(Pe/ke-1)<.001}K.prepTicks=function(Pe,ke){var it=e.simpleMap(Pe.range,Pe.r2l,void 0,void 0,ke);if(Pe.tickmode==="auto"||!Pe.dtick){var ut=Pe.nticks,ht;ut||(Pe.type==="category"||Pe.type==="multicategory"?(ht=Pe.tickfont?e.bigFont(Pe.tickfont.size||12):15,ut=Pe._length/ht):(ht=Pe._id.charAt(0)==="y"?40:80,ut=e.constrain(Pe._length/ht,4,9)+1),Pe._name==="radialaxis"&&(ut*=2)),Pe.minor&&Pe.minor.tickmode!=="array"||Pe.tickmode==="array"&&(ut*=100),Pe._roughDTick=Math.abs(it[1]-it[0])/ut,K.autoTicks(Pe,Pe._roughDTick),Pe._minDtick>0&&Pe.dtick<Pe._minDtick*2&&(Pe.dtick=Pe._minDtick,Pe.tick0=Pe.l2r(Pe._forceTick0))}Pe.ticklabelmode==="period"&&me(Pe),Pe.tick0||(Pe.tick0=Pe.type==="date"?"2000-01-01":0),Pe.type==="date"&&Pe.dtick<.1&&(Pe.dtick=.1),We(Pe)};function be(Pe){return+Pe.substring(1)}function me(Pe){var ke;function it(){return!(u(Pe.dtick)||Pe.dtick.charAt(0)!=="M")}var ut=it(),ht=K.getTickFormat(Pe);if(ht){var Et=Pe._dtickInit!==Pe.dtick;/%[fLQsSMX]/.test(ht)||(/%[HI]/.test(ht)?(ke=C,Et&&!ut&&Pe.dtick<C&&(Pe.dtick=C)):/%p/.test(ht)?(ke=d,Et&&!ut&&Pe.dtick<d&&(Pe.dtick=d)):/%[Aadejuwx]/.test(ht)?(ke=w,Et&&!ut&&Pe.dtick<w&&(Pe.dtick=w)):/%[UVW]/.test(ht)?(ke=y,Et&&!ut&&Pe.dtick<y&&(Pe.dtick=y)):/%[Bbm]/.test(ht)?(ke=M,Et&&(ut?be(Pe.dtick)<1:Pe.dtick<_)&&(Pe.dtick="M1")):/%[q]/.test(ht)?(ke=l,Et&&(ut?be(Pe.dtick)<3:Pe.dtick<b)&&(Pe.dtick="M3")):/%[Yy]/.test(ht)&&(ke=p,Et&&(ut?be(Pe.dtick)<12:Pe.dtick<v)&&(Pe.dtick="M12")))}ut=it(),ut&&Pe.tick0===Pe._dowTick0&&(Pe.tick0=Pe._rawTick0),Pe._definedDelta=ke}function _e(Pe,ke,it){for(var ut=0;ut<Pe.length;ut++){var ht=Pe[ut].value,Et=ut,yt=ut+1;ut<Pe.length-1?(Et=ut,yt=ut+1):ut>0?(Et=ut-1,yt=ut):(Et=ut,yt=ut);var Dt=Pe[Et].value,Xt=Pe[yt].value,ar=Math.abs(Xt-Dt),kr=it||ar,wr=0;kr>=v?ar>=v&&ar<=g?wr=ar:wr=p:it===l&&kr>=b?ar>=b&&ar<=x?wr=ar:wr=l:kr>=_?ar>=_&&ar<=c?wr=ar:wr=M:it===y&&kr>=y?wr=y:kr>=w?wr=w:it===d&&kr>=d?wr=d:it===C&&kr>=C&&(wr=C);var Sr;wr>=ar&&(wr=ar,Sr=!0);var Zr=ht+wr;if(ke.rangebreaks&&wr>0){for(var ir=84,xr=0,Fr=0;Fr<ir;Fr++){var Or=(Fr+.5)/ir;ke.maskBreaks(ht*(1-Or)+Or*Zr)!==B&&xr++}wr*=xr/ir,wr||(Pe[ut].drop=!0),Sr&&ar>y&&(wr=ar)}(wr>0||ut===0)&&(Pe[ut].periodX=ht+wr/2)}}K.calcTicks=function(ke,it){for(var ut=ke.type,ht=ke.calendar,Et=ke.ticklabelstep,yt=ke.ticklabelmode==="period",Dt=e.simpleMap(ke.range,ke.r2l,void 0,void 0,it),Xt=Dt[1]<Dt[0],ar=Math.min(Dt[0],Dt[1]),kr=Math.max(Dt[0],Dt[1]),wr=Math.max(1e3,ke._length||0),Sr=[],Zr=[],ir=[],xr=[],Fr=ke.minor&&(ke.minor.ticks||ke.minor.showgrid),Or=1;Or>=(Fr?0:1);Or--){var Cr=!Or;Or?(ke._dtickInit=ke.dtick,ke._tick0Init=ke.tick0):(ke.minor._dtickInit=ke.minor.dtick,ke.minor._tick0Init=ke.minor.tick0);var at=Or?ke:e.extendFlat({},ke,ke.minor);if(Cr?K.prepMinorTicks(at,ke,it):K.prepTicks(at,it),at.tickmode==="array"){Or?(ir=[],Sr=Se(ke)):(xr=[],Zr=Se(ke));continue}var Ft=q(Dt),jt=Ft[0],sr=Ft[1],zr=u(at.dtick),Ur=ut==="log"&&!(zr||at.dtick.charAt(0)==="L"),Dr=K.tickFirst(at,it);if(Or){if(ke._tmin=Dr,Dr<jt!==Xt)break;(ut==="category"||ut==="multicategory")&&(sr=Xt?Math.max(-.5,sr):Math.min(ke._categories.length-.5,sr))}var Tr=null,Wr=Dr,An;if(Or){var vn;zr?vn=ke.dtick:ut==="date"?typeof ke.dtick=="string"&&ke.dtick.charAt(0)==="M"&&(vn=M*ke.dtick.substring(1)):vn=ke._roughDTick,An=Math.round((ke.r2l(Wr)-ke.r2l(ke.tick0))/vn)-1}var Un=at.dtick;for(at.rangebreaks&&at._tick0Init!==at.tick0&&(Wr=ft(Wr,ke),Xt||(Wr=K.tickIncrement(Wr,Un,!Xt,ht))),Or&&yt&&(Wr=K.tickIncrement(Wr,Un,!Xt,ht),An--);Xt?Wr>=sr:Wr<=sr;Wr=K.tickIncrement(Wr,Un,Xt,ht)){if(Or&&An++,at.rangebreaks&&!Xt){if(Wr<jt)continue;if(at.maskBreaks(Wr)===B&&ft(Wr,at)>=kr)break}if(ir.length>wr||Wr===Tr)break;Tr=Wr;var Dn={value:Wr};Or?(Ur&&Wr!==(Wr|0)&&(Dn.simpleLabel=!0),Et>1&&An%Et&&(Dn.skipLabel=!0),ir.push(Dn)):(Dn.minor=!0,xr.push(Dn))}}if(Fr){var Xn=ke.minor.ticks==="inside"&&ke.ticks==="outside"||ke.minor.ticks==="outside"&&ke.ticks==="inside";if(!Xn){for(var Yn=ir.map(function(Gt){return Gt.value}),ya=[],Ca=0;Ca<xr.length;Ca++){var gi=xr[Ca],Xa=gi.value;if(Yn.indexOf(Xa)===-1){for(var $a=!1,Ja=0;!$a&&Ja<ir.length;Ja++)1e7+ir[Ja].value===1e7+Xa&&($a=!0);$a||ya.push(gi)}}xr=ya}}yt&&_e(ir,ke,ke._definedDelta);var Mr;if(ke.rangebreaks){var gn=ke._id.charAt(0)==="y",hn=1;ke.tickmode==="auto"&&(hn=ke.tickfont?ke.tickfont.size:12);var Sn=NaN;for(Mr=ir.length-1;Mr>-1;Mr--){if(ir[Mr].drop){ir.splice(Mr,1);continue}ir[Mr].value=ft(ir[Mr].value,ke);var Jn=ke.c2p(ir[Mr].value);(gn?Sn>Jn-hn:Sn<Jn+hn)?ir.splice(Xt?Mr+1:Mr,1):Sn=Jn}}st(ke)&&Math.abs(Dt[1]-Dt[0])===360&&ir.pop(),ke._tmax=(ir[ir.length-1]||{}).value,ke._prevDateHead="",ke._inCalcTicks=!0;var ha,ra=function(Gt){Gt.text="",ke._prevDateHead=ha};ir=ir.concat(xr);var In,jn;for(Mr=0;Mr<ir.length;Mr++){var Ga=ir[Mr].minor,vi=ir[Mr].value;Ga?Zr.push({x:vi,minor:!0}):(ha=ke._prevDateHead,In=K.tickText(ke,vi,!1,ir[Mr].simpleLabel),jn=ir[Mr].periodX,jn!==void 0&&(In.periodX=jn,(jn>kr||jn<ar)&&(jn>kr&&(In.periodX=kr),jn<ar&&(In.periodX=ar),ra(In))),ir[Mr].skipLabel&&ra(In),Sr.push(In))}return Sr=Sr.concat(Zr),ke._inCalcTicks=!1,yt&&Sr.length&&(Sr[0].noTick=!0),Sr};function Se(Pe){var ke=e.simpleMap(Pe.range,Pe.r2l),it=q(ke),ut=Math.min(it[0],it[1]),ht=Math.max(it[0],it[1]),Et=Pe.type==="category"?Pe.d2l_noadd:Pe.d2l;Pe.type==="log"&&String(Pe.dtick).charAt(0)!=="L"&&(Pe.dtick="L"+Math.pow(10,Math.floor(Math.min(Pe.range[0],Pe.range[1]))-1));for(var yt=[],Dt=0;Dt<=1;Dt++)if(!(Dt&&!Pe.minor)){var Xt=Dt?Pe.minor.tickvals:Pe.tickvals,ar=Dt?[]:Pe.ticktext;if(!!Xt){Array.isArray(ar)||(ar=[]);for(var kr=0;kr<Xt.length;kr++){var wr=Et(Xt[kr]);if(wr>ut&&wr<ht){var Sr=ar[kr]===void 0?K.tickText(Pe,wr):vt(Pe,wr,String(ar[kr]));Dt&&(Sr.minor=!0,Sr.text=""),yt.push(Sr)}}}}return Pe.rangebreaks&&(yt=yt.filter(function(Zr){return Pe.maskBreaks(Zr.x)!==B})),yt}var De=[2,5,10],Ie=[1,2,3,6,12],Te=[1,2,5,10,15,30],Ce=[1,2,3,7,14],He=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],Xe=[-.301,0,.301,.699,1],Be=[15,30,45,90,180];function Re(Pe,ke,it){return ke*e.roundUp(Pe/ke,it)}K.autoTicks=function(Pe,ke,it){var ut;function ht(wr){return Math.pow(wr,Math.floor(Math.log(ke)/Math.LN10))}if(Pe.type==="date"){Pe.tick0=e.dateTick0(Pe.calendar,0);var Et=2*ke;if(Et>p)ke/=p,ut=ht(10),Pe.dtick="M"+12*Re(ke,ut,De);else if(Et>M)ke/=M,Pe.dtick="M"+Re(ke,1,Ie);else if(Et>w){if(Pe.dtick=Re(ke,w,Pe._hasDayOfWeekBreaks?[1,2,7,14]:Ce),!it){var yt=K.getTickFormat(Pe),Dt=Pe.ticklabelmode==="period";Dt&&(Pe._rawTick0=Pe.tick0),/%[uVW]/.test(yt)?Pe.tick0=e.dateTick0(Pe.calendar,2):Pe.tick0=e.dateTick0(Pe.calendar,1),Dt&&(Pe._dowTick0=Pe.tick0)}}else Et>C?Pe.dtick=Re(ke,C,Ie):Et>S?Pe.dtick=Re(ke,S,Te):Et>E?Pe.dtick=Re(ke,E,Te):(ut=ht(10),Pe.dtick=Re(ke,ut,De))}else if(Pe.type==="log"){Pe.tick0=0;var Xt=e.simpleMap(Pe.range,Pe.r2l);if(Pe._isMinor&&(ke*=1.5),ke>.7)Pe.dtick=Math.ceil(ke);else if(Math.abs(Xt[1]-Xt[0])<1){var ar=1.5*Math.abs((Xt[1]-Xt[0])/ke);ke=Math.abs(Math.pow(10,Xt[1])-Math.pow(10,Xt[0]))/ar,ut=ht(10),Pe.dtick="L"+Re(ke,ut,De)}else Pe.dtick=ke>.3?"D2":"D1"}else Pe.type==="category"||Pe.type==="multicategory"?(Pe.tick0=0,Pe.dtick=Math.ceil(Math.max(ke,1))):st(Pe)?(Pe.tick0=0,ut=1,Pe.dtick=Re(ke,ut,Be)):(Pe.tick0=0,ut=ht(10),Pe.dtick=Re(ke,ut,De));if(Pe.dtick===0&&(Pe.dtick=1),!u(Pe.dtick)&&typeof Pe.dtick!="string"){var kr=Pe.dtick;throw Pe.dtick=1,"ax.dtick error: "+String(kr)}};function We(Pe){var ke=Pe.dtick;if(Pe._tickexponent=0,!u(ke)&&typeof ke!="string"&&(ke=1),(Pe.type==="category"||Pe.type==="multicategory")&&(Pe._tickround=null),Pe.type==="date"){var it=Pe.r2l(Pe.tick0),ut=Pe.l2r(it).replace(/(^-|i)/g,""),ht=ut.length;if(String(ke).charAt(0)==="M")ht>10||ut.substr(5)!=="01-01"?Pe._tickround="d":Pe._tickround=+ke.substr(1)%12===0?"y":"m";else if(ke>=w&&ht<=10||ke>=w*15)Pe._tickround="d";else if(ke>=S&&ht<=16||ke>=C)Pe._tickround="M";else if(ke>=E&&ht<=19||ke>=S)Pe._tickround="S";else{var Et=Pe.l2r(it+ke).replace(/^-/,"").length;Pe._tickround=Math.max(ht,Et)-20,Pe._tickround<0&&(Pe._tickround=4)}}else if(u(ke)||ke.charAt(0)==="L"){var yt=Pe.range.map(Pe.r2d||Number);u(ke)||(ke=Number(ke.substr(1))),Pe._tickround=2-Math.floor(Math.log(ke)/Math.LN10+.01);var Dt=Math.max(Math.abs(yt[0]),Math.abs(yt[1])),Xt=Math.floor(Math.log(Dt)/Math.LN10+.01),ar=Pe.minexponent===void 0?3:Pe.minexponent;Math.abs(Xt)>ar&&(nt(Pe.exponentformat)&&!Ye(Xt)?Pe._tickexponent=3*Math.round((Xt-1)/3):Pe._tickexponent=Xt)}else Pe._tickround=null}K.tickIncrement=function(Pe,ke,it,ut){var ht=it?-1:1;if(u(ke))return e.increment(Pe,ht*ke);var Et=ke.charAt(0),yt=ht*Number(ke.substr(1));if(Et==="M")return e.incrementMonth(Pe,yt,ut);if(Et==="L")return Math.log(Math.pow(10,Pe)+yt)/Math.LN10;if(Et==="D"){var Dt=ke==="D2"?Xe:He,Xt=Pe+ht*.01,ar=e.roundUp(e.mod(Xt,1),Dt,it);return Math.floor(Xt)+Math.log(h.round(Math.pow(10,ar),1))/Math.LN10}throw"unrecognized dtick "+String(ke)},K.tickFirst=function(Pe,ke){var it=Pe.r2l||Number,ut=e.simpleMap(Pe.range,it,void 0,void 0,ke),ht=ut[1]<ut[0],Et=ht?Math.floor:Math.ceil,yt=q(ut)[0],Dt=Pe.dtick,Xt=it(Pe.tick0);if(u(Dt)){var ar=Et((yt-Xt)/Dt)*Dt+Xt;return(Pe.type==="category"||Pe.type==="multicategory")&&(ar=e.constrain(ar,0,Pe._categories.length-1)),ar}var kr=Dt.charAt(0),wr=Number(Dt.substr(1));if(kr==="M"){for(var Sr=0,Zr=Xt,ir,xr,Fr;Sr<10;){if(ir=K.tickIncrement(Zr,Dt,ht,Pe.calendar),(ir-yt)*(Zr-yt)<=0)return ht?Math.min(Zr,ir):Math.max(Zr,ir);xr=(yt-(Zr+ir)/2)/(ir-Zr),Fr=kr+(Math.abs(Math.round(xr))||1)*wr,Zr=K.tickIncrement(Zr,Fr,xr<0?!ht:ht,Pe.calendar),Sr++}return e.error("tickFirst did not converge",Pe),Zr}else{if(kr==="L")return Math.log(Et((Math.pow(10,yt)-Xt)/wr)*wr+Xt)/Math.LN10;if(kr==="D"){var Or=Dt==="D2"?Xe:He,Cr=e.roundUp(e.mod(yt,1),Or,ht);return Math.floor(yt)+Math.log(h.round(Math.pow(10,Cr),1))/Math.LN10}else throw"unrecognized dtick "+String(Dt)}},K.tickText=function(Pe,ke,it,ut){var ht=vt(Pe,ke),Et=Pe.tickmode==="array",yt=it||Et,Dt=Pe.type,Xt=Dt==="category"?Pe.d2l_noadd:Pe.d2l,ar;if(Et&&Array.isArray(Pe.ticktext)){var kr=e.simpleMap(Pe.range,Pe.r2l),wr=(Math.abs(kr[1]-kr[0])-(Pe._lBreaks||0))/1e4;for(ar=0;ar<Pe.ticktext.length&&!(Math.abs(ke-Xt(Pe.tickvals[ar]))<wr);ar++);if(ar<Pe.ticktext.length)return ht.text=String(Pe.ticktext[ar]),ht}function Sr(xr){if(xr===void 0)return!0;if(it)return xr==="none";var Fr={first:Pe._tmin,last:Pe._tmax}[xr];return xr!=="all"&&ke!==Fr}var Zr=it?"never":Pe.exponentformat!=="none"&&Sr(Pe.showexponent)?"hide":"";if(Dt==="date"?Pt(Pe,ht,it,yt):Dt==="log"?Zt(Pe,ht,it,yt,Zr):Dt==="category"?zt(Pe,ht):Dt==="multicategory"?At(Pe,ht,it):st(Pe)?Bt(Pe,ht,it,yt,Zr):Wt(Pe,ht,it,yt,Zr),ut||(Pe.tickprefix&&!Sr(Pe.showtickprefix)&&(ht.text=Pe.tickprefix+ht.text),Pe.ticksuffix&&!Sr(Pe.showticksuffix)&&(ht.text+=Pe.ticksuffix)),Pe.tickson==="boundaries"||Pe.showdividers){var ir=function(xr){var Fr=Pe.l2p(xr);return Fr>=0&&Fr<=Pe._length?xr:null};ht.xbnd=[ir(ht.x-.5),ir(ht.x+Pe.dtick-.5)]}return ht},K.hoverLabelText=function(Pe,ke,it){it&&(Pe=e.extendFlat({},Pe,{hoverformat:it}));var ut=Array.isArray(ke)?ke[0]:ke,ht=Array.isArray(ke)?ke[1]:void 0;if(ht!==void 0&&ht!==ut)return K.hoverLabelText(Pe,ut,it)+" - "+K.hoverLabelText(Pe,ht,it);var Et=Pe.type==="log"&&ut<=0,yt=K.tickText(Pe,Pe.c2l(Et?-ut:ut),"hover").text;return Et?ut===0?"0":k+yt:yt};function vt(Pe,ke,it){var ut=Pe.tickfont||{};return{x:ke,dx:0,dy:0,text:it||"",fontSize:ut.size,font:ut.family,fontColor:ut.color}}function Pt(Pe,ke,it,ut){var ht=Pe._tickround,Et=it&&Pe.hoverformat||K.getTickFormat(Pe);ut&&(u(ht)?ht=4:ht={y:"m",m:"d",d:"M",M:"S",S:4}[ht]);var yt=e.formatDate(ke.x,Et,ht,Pe._dateFormat,Pe.calendar,Pe._extraFormat),Dt,Xt=yt.indexOf(`
`);if(Xt!==-1&&(Dt=yt.substr(Xt+1),yt=yt.substr(0,Xt)),ut&&(yt==="00:00:00"||yt==="00:00"?(yt=Dt,Dt=""):yt.length===8&&(yt=yt.replace(/:00$/,""))),Dt)if(it)ht==="d"?yt+=", "+Dt:yt=Dt+(yt?", "+yt:"");else if(!Pe._inCalcTicks||Pe._prevDateHead!==Dt)Pe._prevDateHead=Dt,yt+="<br>"+Dt;else{var ar=St(Pe),kr=Pe._trueSide||Pe.side;(!ar&&kr==="top"||ar&&kr==="bottom")&&(yt+="<br> ")}ke.text=yt}function Zt(Pe,ke,it,ut,ht){var Et=Pe.dtick,yt=ke.x,Dt=Pe.tickformat,Xt=typeof Et=="string"&&Et.charAt(0);if(ht==="never"&&(ht=""),ut&&Xt!=="L"&&(Et="L3",Xt="L"),Dt||Xt==="L")ke.text=Ee(Math.pow(10,yt),Pe,ht,ut);else if(u(Et)||Xt==="D"&&e.mod(yt+.01,1)<.1){var ar=Math.round(yt),kr=Math.abs(ar),wr=Pe.exponentformat;wr==="power"||nt(wr)&&Ye(ar)?(ar===0?ke.text=1:ar===1?ke.text="10":ke.text="10<sup>"+(ar>1?"":k)+kr+"</sup>",ke.fontSize*=1.25):(wr==="e"||wr==="E")&&kr>2?ke.text="1"+wr+(ar>0?"+":k)+kr:(ke.text=Ee(Math.pow(10,yt),Pe,"","fakehover"),Et==="D1"&&Pe._id.charAt(0)==="y"&&(ke.dy-=ke.fontSize/6))}else if(Xt==="D")ke.text=String(Math.round(Math.pow(10,e.mod(yt,1)))),ke.fontSize*=.75;else throw"unrecognized dtick "+String(Et);if(Pe.dtick==="D1"){var Sr=String(ke.text).charAt(0);(Sr==="0"||Sr==="1")&&(Pe._id.charAt(0)==="y"?ke.dx-=ke.fontSize/4:(ke.dy+=ke.fontSize/2,ke.dx+=(Pe.range[1]>Pe.range[0]?1:-1)*ke.fontSize*(yt<0?.5:.25)))}}function zt(Pe,ke){var it=Pe._categories[Math.round(ke.x)];it===void 0&&(it=""),ke.text=String(it)}function At(Pe,ke,it){var ut=Math.round(ke.x),ht=Pe._categories[ut]||[],Et=ht[1]===void 0?"":String(ht[1]),yt=ht[0]===void 0?"":String(ht[0]);it?ke.text=yt+" - "+Et:(ke.text=Et,ke.text2=yt)}function Wt(Pe,ke,it,ut,ht){ht==="never"?ht="":Pe.showexponent==="all"&&Math.abs(ke.x/Pe.dtick)<1e-6&&(ht="hide"),ke.text=Ee(ke.x,Pe,ht,ut)}function Bt(Pe,ke,it,ut,ht){if(Pe.thetaunit==="radians"&&!it){var Et=ke.x/180;if(Et===0)ke.text="0";else{var yt=Ct(Et);if(yt[1]>=100)ke.text=Ee(e.deg2rad(ke.x),Pe,ht,ut);else{var Dt=ke.x<0;yt[1]===1?yt[0]===1?ke.text="\u03C0":ke.text=yt[0]+"\u03C0":ke.text=["<sup>",yt[0],"</sup>","\u2044","<sub>",yt[1],"</sub>","\u03C0"].join(""),Dt&&(ke.text=k+ke.text)}}}else ke.text=Ee(ke.x,Pe,ht,ut)}function Ct(Pe){function ke(Dt,Xt){return Math.abs(Dt-Xt)<=1e-6}function it(Dt,Xt){return ke(Xt,0)?Dt:it(Xt,Dt%Xt)}function ut(Dt){for(var Xt=1;!ke(Math.round(Dt*Xt)/Xt,Dt);)Xt*=10;return Xt}var ht=ut(Pe),Et=Pe*ht,yt=Math.abs(it(Et,ht));return[Math.round(Et/yt),Math.round(ht/yt)]}var Ze=["f","p","n","\u03BC","m","","k","M","G","T"];function nt(Pe){return Pe==="SI"||Pe==="B"}function Ye(Pe){return Pe>14||Pe<-15}function Ee(Pe,ke,it,ut){var ht=Pe<0,Et=ke._tickround,yt=it||ke.exponentformat||"B",Dt=ke._tickexponent,Xt=K.getTickFormat(ke),ar=ke.separatethousands;if(ut){var kr={exponentformat:yt,minexponent:ke.minexponent,dtick:ke.showexponent==="none"?ke.dtick:u(Pe)&&Math.abs(Pe)||1,range:ke.showexponent==="none"?ke.range.map(ke.r2d):[0,Pe||1]};We(kr),Et=(Number(kr._tickround)||0)+4,Dt=kr._tickexponent,ke.hoverformat&&(Xt=ke.hoverformat)}if(Xt)return ke._numFormat(Xt)(Pe).replace(/-/g,k);var wr=Math.pow(10,-Et)/2;if(yt==="none"&&(Dt=0),Pe=Math.abs(Pe),Pe<wr)Pe="0",ht=!1;else{if(Pe+=wr,Dt&&(Pe*=Math.pow(10,-Dt),Et+=Dt),Et===0)Pe=String(Math.floor(Pe));else if(Et<0){Pe=String(Math.round(Pe)),Pe=Pe.substr(0,Pe.length+Et);for(var Sr=Et;Sr<0;Sr++)Pe+="0"}else{Pe=String(Pe);var Zr=Pe.indexOf(".")+1;Zr&&(Pe=Pe.substr(0,Zr+Et).replace(/\.?0+$/,""))}Pe=e.numSeparate(Pe,ke._separators,ar)}if(Dt&&yt!=="hide"){nt(yt)&&Ye(Dt)&&(yt="power");var ir;Dt<0?ir=k+-Dt:yt!=="power"?ir="+"+Dt:ir=String(Dt),yt==="e"||yt==="E"?Pe+=yt+ir:yt==="power"?Pe+="\xD710<sup>"+ir+"</sup>":yt==="B"&&Dt===9?Pe+="B":nt(yt)&&(Pe+=Ze[Dt/3+5])}return ht?k+Pe:Pe}K.getTickFormat=function(Pe){var ke;function it(Xt){return typeof Xt!="string"?Xt:Number(Xt.replace("M",""))*M}function ut(Xt,ar){var kr=["L","D"];if(typeof Xt==typeof ar){if(typeof Xt=="number")return Xt-ar;var wr=kr.indexOf(Xt.charAt(0)),Sr=kr.indexOf(ar.charAt(0));return wr===Sr?Number(Xt.replace(/(L|D)/g,""))-Number(ar.replace(/(L|D)/g,"")):wr-Sr}else return typeof Xt=="number"?1:-1}function ht(Xt,ar,kr){var wr=kr||function(ir){return ir},Sr=ar[0],Zr=ar[1];return(!Sr&&typeof Sr!="number"||wr(Sr)<=wr(Xt))&&(!Zr&&typeof Zr!="number"||wr(Zr)>=wr(Xt))}function Et(Xt,ar){var kr=ar[0]===null,wr=ar[1]===null,Sr=ut(Xt,ar[0])>=0,Zr=ut(Xt,ar[1])<=0;return(kr||Sr)&&(wr||Zr)}var yt,Dt;if(Pe.tickformatstops&&Pe.tickformatstops.length>0)switch(Pe.type){case"date":case"linear":{for(ke=0;ke<Pe.tickformatstops.length;ke++)if(Dt=Pe.tickformatstops[ke],Dt.enabled&&ht(Pe.dtick,Dt.dtickrange,it)){yt=Dt;break}break}case"log":{for(ke=0;ke<Pe.tickformatstops.length;ke++)if(Dt=Pe.tickformatstops[ke],Dt.enabled&&Et(Pe.dtick,Dt.dtickrange)){yt=Dt;break}break}}return yt?yt.value:Pe.tickformat},K.getSubplots=function(Pe,ke){var it=Pe._fullLayout._subplots,ut=it.cartesian.concat(it.gl2d||[]),ht=ke?K.findSubplotsWithAxis(ut,ke):ut;return ht.sort(function(Et,yt){var Dt=Et.substr(1).split("y"),Xt=yt.substr(1).split("y");return Dt[0]===Xt[0]?+Dt[1]-+Xt[1]:+Dt[0]-+Xt[0]}),ht},K.findSubplotsWithAxis=function(Pe,ke){for(var it=new RegExp(ke._id.charAt(0)==="x"?"^"+ke._id+"y":ke._id+"$"),ut=[],ht=0;ht<Pe.length;ht++){var Et=Pe[ht];it.test(Et)&&ut.push(Et)}return ut},K.makeClipPaths=function(Pe){var ke=Pe._fullLayout;if(!ke._hasOnlyLargeSploms){var it={_offset:0,_length:ke.width,_id:""},ut={_offset:0,_length:ke.height,_id:""},ht=K.list(Pe,"x",!0),Et=K.list(Pe,"y",!0),yt=[],Dt,Xt;for(Dt=0;Dt<ht.length;Dt++)for(yt.push({x:ht[Dt],y:ut}),Xt=0;Xt<Et.length;Xt++)Dt===0&&yt.push({x:it,y:Et[Xt]}),yt.push({x:ht[Dt],y:Et[Xt]});var ar=ke._clips.selectAll(".axesclip").data(yt,function(kr){return kr.x._id+kr.y._id});ar.enter().append("clipPath").classed("axesclip",!0).attr("id",function(kr){return"clip"+ke._uid+kr.x._id+kr.y._id}).append("rect"),ar.exit().remove(),ar.each(function(kr){h.select(this).select("rect").attr({x:kr.x._offset||0,y:kr.y._offset||0,width:kr.x._length||1,height:kr.y._length||1})})}},K.draw=function(Pe,ke,it){var ut=Pe._fullLayout;ke==="redraw"&&ut._paper.selectAll("g.subplot").each(function(Et){var yt=Et[0],Dt=ut._plots[yt];if(Dt){var Xt=Dt.xaxis,ar=Dt.yaxis;Dt.xaxislayer.selectAll("."+Xt._id+"tick").remove(),Dt.yaxislayer.selectAll("."+ar._id+"tick").remove(),Dt.xaxislayer.selectAll("."+Xt._id+"tick2").remove(),Dt.yaxislayer.selectAll("."+ar._id+"tick2").remove(),Dt.xaxislayer.selectAll("."+Xt._id+"divider").remove(),Dt.yaxislayer.selectAll("."+ar._id+"divider").remove(),Dt.minorGridlayer&&Dt.minorGridlayer.selectAll("path").remove(),Dt.gridlayer&&Dt.gridlayer.selectAll("path").remove(),Dt.zerolinelayer&&Dt.zerolinelayer.selectAll("path").remove(),ut._infolayer.select(".g-"+Xt._id+"title").remove(),ut._infolayer.select(".g-"+ar._id+"title").remove()}});var ht=!ke||ke==="redraw"?K.listIds(Pe):ke;return e.syncOrAsync(ht.map(function(Et){return function(){if(!!Et){var yt=K.getFromId(Pe,Et),Dt=K.drawOne(Pe,yt,it);return yt._r=yt.range.slice(),yt._rl=e.simpleMap(yt._r,yt.r2l),Dt}}}))},K.drawOne=function(Pe,ke,it){it=it||{};var ut,ht,Et;ke.setScale();var yt=Pe._fullLayout,Dt=ke._id,Xt=Dt.charAt(0),ar=K.counterLetter(Dt),kr=yt._plots[ke._mainSubplot];if(!kr)return;var wr=kr[Xt+"axislayer"],Sr=ke._mainLinePosition,Zr=ke._mainMirrorPosition,ir=ke._vals=K.calcTicks(ke),xr=[ke.mirror,Sr,Zr].join("_");for(ut=0;ut<ir.length;ut++)ir[ut].axInfo=xr;ke._selections={},ke._tickAngles&&(ke._prevTickAngles=ke._tickAngles),ke._tickAngles={},ke._depth=null;var Fr={};function Or(Gt){var pr=Dt+(Gt||"tick");return Fr[pr]||(Fr[pr]=mt(ke,pr)),Fr[pr]}if(!!ke.visible){var Cr=K.makeTransTickFn(ke),at=K.makeTransTickLabelFn(ke),Ft,jt,sr=ke.ticks==="inside",zr=ke.ticks==="outside";if(ke.tickson==="boundaries"){var Ur=Je(ke,ir);jt=K.clipEnds(ke,Ur),Ft=sr?jt:Ur}else jt=K.clipEnds(ke,ir),Ft=sr&&ke.ticklabelmode!=="period"?jt:ir;var Dr=ke._gridVals=jt,Tr=Tt(ke,ir);if(!yt._hasOnlyLargeSploms){var Wr=ke._subplotsWith,An={};for(ut=0;ut<Wr.length;ut++){ht=Wr[ut],Et=yt._plots[ht];var vn=Et[ar+"axis"],Un=vn._mainAxis._id;if(!An[Un]){An[Un]=1;var Dn=Xt==="x"?"M0,"+vn._offset+"v"+vn._length:"M"+vn._offset+",0h"+vn._length;K.drawGrid(Pe,ke,{vals:Dr,counterAxis:vn,layer:Et.gridlayer.select("."+Dt),minorLayer:Et.minorGridlayer.select("."+Dt),path:Dn,transFn:Cr}),K.drawZeroLine(Pe,ke,{counterAxis:vn,layer:Et.zerolinelayer,path:Dn,transFn:Cr})}}}var Xn,Yn=K.getTickSigns(ke),ya=K.getTickSigns(ke,"minor");if(ke.ticks||ke.minor&&ke.minor.ticks){var Ca=K.makeTickPath(ke,Sr,Yn[2]),gi=K.makeTickPath(ke,Sr,ya[2],{minor:!0}),Xa,$a,Ja,Mr;if(ke._anchorAxis&&ke.mirror&&ke.mirror!==!0?(Xa=K.makeTickPath(ke,Zr,Yn[3]),$a=K.makeTickPath(ke,Zr,ya[3],{minor:!0}),Ja=Ca+Xa,Mr=gi+$a):(Xa="",$a="",Ja=Ca,Mr=gi),ke.showdividers&&zr&&ke.tickson==="boundaries"){var gn={};for(ut=0;ut<Tr.length;ut++)gn[Tr[ut].x]=1;Xn=function(Gt){return gn[Gt.x]?Xa:Ja}}else Xn=function(Gt){return Gt.minor?Mr:Ja}}if(K.drawTicks(Pe,ke,{vals:Ft,layer:wr,path:Xn,transFn:Cr}),ke.mirror==="allticks"){var hn=Object.keys(ke._linepositions||{});for(ut=0;ut<hn.length;ut++){ht=hn[ut],Et=yt._plots[ht];var Sn=ke._linepositions[ht]||[],Jn=Sn[0],ha=Sn[1],ra=Sn[2],In=K.makeTickPath(ke,Jn,ra?Yn[0]:ya[0],{minor:ra})+K.makeTickPath(ke,ha,ra?Yn[1]:ya[1],{minor:ra});K.drawTicks(Pe,ke,{vals:Ft,layer:Et[Xt+"axislayer"],path:In,transFn:Cr})}}var jn=[];if(jn.push(function(){return K.drawLabels(Pe,ke,{vals:ir,layer:wr,plotinfo:Et,transFn:at,labelFns:K.makeLabelFns(ke,Sr)})}),ke.type==="multicategory"){var Ga={x:2,y:10}[Xt];jn.push(function(){var Gt={x:"height",y:"width"}[Xt],pr=Or()[Gt]+Ga+(ke._tickAngles[Dt+"tick"]?ke.tickfont.size*X:0);return K.drawLabels(Pe,ke,{vals:qe(ke,ir),layer:wr,cls:Dt+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:Cr,labelFns:K.makeLabelFns(ke,Sr+pr*Yn[4])})}),jn.push(function(){return ke._depth=Yn[4]*(Or("tick2")[ke.side]-Sr),Vt(Pe,ke,{vals:Tr,layer:wr,path:K.makeTickPath(ke,Sr,Yn[4],{len:ke._depth}),transFn:Cr})})}else ke.title.hasOwnProperty("standoff")&&jn.push(function(){ke._depth=Yn[4]*(Or()[ke.side]-Sr)});var vi=T.getComponentMethod("rangeslider","isVisible")(ke);return jn.push(function(){var Gt=ke.side.charAt(0),pr=re[ke.side].charAt(0),on=K.getPxPosition(Pe,ke),dn=zr?ke.ticklen:0,rn,Mn,_n,cn;if((ke.automargin||vi)&&(ke.type==="multicategory"?rn=Or("tick2"):(rn=Or(),Xt==="x"&&Gt==="b"&&(ke._depth=Math.max(rn.width>0?rn.bottom-on:0,dn)))),ke.automargin){Mn={x:0,y:0,r:0,l:0,t:0,b:0};var mr=[0,1];if(Xt==="x"){if(Gt==="b"?Mn[Gt]=ke._depth:(Mn[Gt]=ke._depth=Math.max(rn.width>0?on-rn.top:0,dn),mr.reverse()),rn.width>0){var br=rn.right-(ke._offset+ke._length);br>0&&(Mn.xr=1,Mn.r=br);var Br=ke._offset-rn.left;Br>0&&(Mn.xl=0,Mn.l=Br)}}else if(Gt==="l"?Mn[Gt]=ke._depth=Math.max(rn.height>0?on-rn.left:0,dn):(Mn[Gt]=ke._depth=Math.max(rn.height>0?rn.right-on:0,dn),mr.reverse()),rn.height>0){var mn=rn.bottom-(ke._offset+ke._length);mn>0&&(Mn.yb=0,Mn.b=mn);var On=ke._offset-rn.top;On>0&&(Mn.yt=1,Mn.t=On)}Mn[ar]=ke.anchor==="free"?ke.position:ke._anchorAxis.domain[mr[0]],ke.title.text!==yt._dfltTitle[Xt]&&(Mn[Gt]+=Jt(ke)+(ke.title.standoff||0)),ke.mirror&&ke.anchor!=="free"&&(_n={x:0,y:0,r:0,l:0,t:0,b:0},_n[pr]=ke.linewidth,ke.mirror&&ke.mirror!==!0&&(_n[pr]+=dn),ke.mirror===!0||ke.mirror==="ticks"?_n[ar]=ke._anchorAxis.domain[mr[1]]:(ke.mirror==="all"||ke.mirror==="allticks")&&(_n[ar]=[ke._counterDomainMin,ke._counterDomainMax][mr[1]]))}vi&&(cn=T.getComponentMethod("rangeslider","autoMarginOpts")(Pe,ke)),typeof ke.automargin=="string"&&(Ge(Mn,ke.automargin),Ge(_n,ke.automargin)),A.autoMargin(Pe,ot(ke),Mn),A.autoMargin(Pe,er(ke),_n),A.autoMargin(Pe,Kt(ke),cn)}),!it.skipTitle&&!(vi&&ke.side==="bottom")&&jn.push(function(){return Yt(Pe,ke)}),e.syncOrAsync(jn)}};function Ge(Pe,ke){if(!!Pe){var it=Object.keys(V).reduce(function(ut,ht){return ke.indexOf(ht)!==-1&&V[ht].forEach(function(Et){ut[Et]=1}),ut},{});Object.keys(Pe).forEach(function(ut){it[ut]||(ut.length===1?Pe[ut]=0:delete Pe[ut])})}}function Je(Pe,ke){var it=[],ut,ht=function(Et,yt){var Dt=Et.xbnd[yt];Dt!==null&&it.push(e.extendFlat({},Et,{x:Dt}))};if(ke.length){for(ut=0;ut<ke.length;ut++)ht(ke[ut],0);ht(ke[ut-1],1)}return it}function qe(Pe,ke){for(var it=[],ut={},ht=0;ht<ke.length;ht++){var Et=ke[ht];ut[Et.text2]?ut[Et.text2].push(Et.x):ut[Et.text2]=[Et.x]}for(var yt in ut)it.push(vt(Pe,e.interp(ut[yt],.5),yt));return it}function Tt(Pe,ke){var it=[],ut,ht,Et=ke.length&&ke[ke.length-1].x<ke[0].x,yt=function(Xt,ar){var kr=Xt.xbnd[ar];kr!==null&&it.push(e.extendFlat({},Xt,{x:kr}))};if(Pe.showdividers&&ke.length){for(ut=0;ut<ke.length;ut++){var Dt=ke[ut];Dt.text2!==ht&&yt(Dt,Et?1:0),ht=Dt.text2}yt(ke[ut-1],Et?0:1)}return it}function mt(Pe,ke){var it,ut,ht,Et;return Pe._selections[ke].size()?(it=1/0,ut=-1/0,ht=1/0,Et=-1/0,Pe._selections[ke].each(function(){var yt=Kr(this),Dt=f.bBox(yt.node().parentNode);it=Math.min(it,Dt.top),ut=Math.max(ut,Dt.bottom),ht=Math.min(ht,Dt.left),Et=Math.max(Et,Dt.right)})):(it=0,ut=0,ht=0,Et=0),{top:it,bottom:ut,left:ht,right:Et,height:ut-it,width:Et-ht}}K.getTickSigns=function(Pe,ke){var it=Pe._id.charAt(0),ut={x:"top",y:"right"}[it],ht=Pe.side===ut?1:-1,Et=[-1,1,ht,-ht],yt=ke?(Pe.minor||{}).ticks:Pe.ticks;return yt!=="inside"==(it==="x")&&(Et=Et.map(function(Dt){return-Dt})),Pe.side&&Et.push({l:-1,t:-1,r:1,b:1}[Pe.side.charAt(0)]),Et},K.makeTransTickFn=function(Pe){return Pe._id.charAt(0)==="x"?function(ke){return i(Pe._offset+Pe.l2p(ke.x),0)}:function(ke){return i(0,Pe._offset+Pe.l2p(ke.x))}},K.makeTransTickLabelFn=function(Pe){var ke=Ht(Pe),it=ke[0],ut=ke[1];return Pe._id.charAt(0)==="x"?function(ht){return i(it+Pe._offset+Pe.l2p(Mt(ht)),ut)}:function(ht){return i(ut,it+Pe._offset+Pe.l2p(Mt(ht)))}};function Mt(Pe){return Pe.periodX!==void 0?Pe.periodX:Pe.x}function Ht(Pe){var ke=Pe.ticklabelposition||"",it=function(Zr){return ke.indexOf(Zr)!==-1},ut=it("top"),ht=it("left"),Et=it("right"),yt=it("bottom"),Dt=it("inside"),Xt=yt||ht||ut||Et;if(!Xt&&!Dt)return[0,0];var ar=Pe.side,kr=Xt?(Pe.tickwidth||0)/2:0,wr=ue,Sr=Pe.tickfont?Pe.tickfont.size:12;return(yt||ut)&&(kr+=Sr*Z,wr+=(Pe.linewidth||0)/2),(ht||Et)&&(kr+=(Pe.linewidth||0)/2,wr+=ue),Dt&&ar==="top"&&(wr-=Sr*(1-Z)),(ht||ut)&&(kr=-kr),(ar==="bottom"||ar==="right")&&(wr=-wr),[Xt?kr:0,Dt?wr:0]}K.makeTickPath=function(Pe,ke,it,ut){ut||(ut={});var ht=ut.minor;if(ht&&!Pe.minor)return"";var Et=ut.len!==void 0?ut.len:ht?Pe.minor.ticklen:Pe.ticklen,yt=Pe._id.charAt(0),Dt=(Pe.linewidth||1)/2;return yt==="x"?"M0,"+(ke+Dt*it)+"v"+Et*it:"M"+(ke+Dt*it)+",0h"+Et*it},K.makeLabelFns=function(Pe,ke,it){var ut=Pe.ticklabelposition||"",ht=function(An){return ut.indexOf(An)!==-1},Et=ht("top"),yt=ht("left"),Dt=ht("right"),Xt=ht("bottom"),ar=Xt||yt||Et||Dt,kr=ht("inside"),wr=ut==="inside"&&Pe.ticks==="inside"||!kr&&Pe.ticks==="outside"&&Pe.tickson!=="boundaries",Sr=0,Zr=0,ir=wr?Pe.ticklen:0;if(kr?ir*=-1:ar&&(ir=0),wr&&(Sr+=ir,it)){var xr=e.deg2rad(it);Sr=ir*Math.cos(xr)+1,Zr=ir*Math.sin(xr)}Pe.showticklabels&&(wr||Pe.showline)&&(Sr+=.2*Pe.tickfont.size),Sr+=(Pe.linewidth||1)/2*(kr?-1:1);var Fr={labelStandoff:Sr,labelShift:Zr},Or,Cr,at,Ft,jt=0,sr=Pe.side,zr=Pe._id.charAt(0),Ur=Pe.tickangle,Dr;if(zr==="x")Dr=!kr&&sr==="bottom"||kr&&sr==="top",Ft=Dr?1:-1,kr&&(Ft*=-1),Or=Zr*Ft,Cr=ke+Sr*Ft,at=Dr?1:-.2,Math.abs(Ur)===90&&(kr?at+=j:Ur===-90&&sr==="bottom"?at=Z:Ur===90&&sr==="top"?at=j:at=.5,jt=j/2*(Ur/90)),Fr.xFn=function(An){return An.dx+Or+jt*An.fontSize},Fr.yFn=function(An){return An.dy+Cr+An.fontSize*at},Fr.anchorFn=function(An,vn){if(ar){if(yt)return"end";if(Dt)return"start"}return!u(vn)||vn===0||vn===180?"middle":vn*Ft<0!==kr?"end":"start"},Fr.heightFn=function(An,vn,Un){return vn<-60||vn>60?-.5*Un:Pe.side==="top"!==kr?-Un:0};else if(zr==="y"){if(Dr=!kr&&sr==="left"||kr&&sr==="right",Ft=Dr?1:-1,kr&&(Ft*=-1),Or=Sr,Cr=Zr*Ft,at=0,!kr&&Math.abs(Ur)===90&&(Ur===-90&&sr==="left"||Ur===90&&sr==="right"?at=Z:at=.5),kr){var Tr=u(Ur)?+Ur:0;if(Tr!==0){var Wr=e.deg2rad(Tr);jt=Math.abs(Math.sin(Wr))*Z*Ft,at=0}}Fr.xFn=function(An){return An.dx+ke-(Or+An.fontSize*at)*Ft+jt*An.fontSize},Fr.yFn=function(An){return An.dy+Cr+An.fontSize*j},Fr.anchorFn=function(An,vn){return u(vn)&&Math.abs(vn)===90?"middle":Dr?"end":"start"},Fr.heightFn=function(An,vn,Un){return Pe.side==="right"&&(vn*=-1),vn<-30?-Un:vn<30?-.5*Un:0}}return Fr};function Rt(Pe){return[Pe.text,Pe.x,Pe.axInfo,Pe.font,Pe.fontSize,Pe.fontColor].join("_")}K.drawTicks=function(Pe,ke,it){it=it||{};var ut=ke._id+"tick",ht=[].concat(ke.minor&&ke.minor.ticks?it.vals.filter(function(yt){return yt.minor&&!yt.noTick}):[]).concat(ke.ticks?it.vals.filter(function(yt){return!yt.minor&&!yt.noTick}):[]),Et=it.layer.selectAll("path."+ut).data(ht,Rt);Et.exit().remove(),Et.enter().append("path").classed(ut,1).classed("ticks",1).classed("crisp",it.crisp!==!1).each(function(yt){return r.stroke(h.select(this),yt.minor?ke.minor.tickcolor:ke.tickcolor)}).style("stroke-width",function(yt){return f.crispRound(Pe,yt.minor?ke.minor.tickwidth:ke.tickwidth,1)+"px"}).attr("d",it.path).style("display",null),Ut(ke,[O]),Et.attr("transform",it.transFn)},K.drawGrid=function(Pe,ke,it){it=it||{};var ut=ke._id+"grid",ht=ke.minor&&ke.minor.showgrid,Et=ht?it.vals.filter(function(Or){return Or.minor}):[],yt=ke.showgrid?it.vals.filter(function(Or){return!Or.minor}):[],Dt=it.counterAxis;if(Dt&&K.shouldShowZeroLine(Pe,ke,Dt))for(var Xt=ke.tickmode==="array",ar=0;ar<yt.length;ar++){var kr=yt[ar].x;if(Xt?!kr:Math.abs(kr)<ke.dtick/100)if(yt=yt.slice(0,ar).concat(yt.slice(ar+1)),Xt)ar--;else break}ke._gw=f.crispRound(Pe,ke.gridwidth,1);for(var wr=ht?f.crispRound(Pe,ke.minor.gridwidth,1):0,Sr=it.layer,Zr=it.minorLayer,ir=1;ir>=0;ir--){var xr=ir?Sr:Zr;if(!!xr){var Fr=xr.selectAll("path."+ut).data(ir?yt:Et,Rt);Fr.exit().remove(),Fr.enter().append("path").classed(ut,1).classed("crisp",it.crisp!==!1),Fr.attr("transform",it.transFn).attr("d",it.path).each(function(Or){return r.stroke(h.select(this),Or.minor?ke.minor.gridcolor:ke.gridcolor||"#ddd")}).style("stroke-dasharray",function(Or){return f.dashStyle(Or.minor?ke.minor.griddash:ke.griddash,Or.minor?ke.minor.gridwidth:ke.gridwidth)}).style("stroke-width",function(Or){return(Or.minor?wr:ke._gw)+"px"}).style("display",null),typeof it.path=="function"&&Fr.attr("d",it.path)}}Ut(ke,[F,I])},K.drawZeroLine=function(Pe,ke,it){it=it||it;var ut=ke._id+"zl",ht=K.shouldShowZeroLine(Pe,ke,it.counterAxis),Et=it.layer.selectAll("path."+ut).data(ht?[{x:0,id:ke._id}]:[]);Et.exit().remove(),Et.enter().append("path").classed(ut,1).classed("zl",1).classed("crisp",it.crisp!==!1).each(function(){it.layer.selectAll("path").sort(function(yt,Dt){return Y(yt.id,Dt.id)})}),Et.attr("transform",it.transFn).attr("d",it.path).call(r.stroke,ke.zerolinecolor||r.defaultLine).style("stroke-width",f.crispRound(Pe,ke.zerolinewidth,ke._gw||1)+"px").style("display",null),Ut(ke,[z])},K.drawLabels=function(Pe,ke,it){it=it||{};var ut=Pe._fullLayout,ht=ke._id,Et=ht.charAt(0),yt=it.cls||ht+"tick",Dt=it.vals.filter(function(Ft){return Ft.text}),Xt=it.labelFns,ar=it.secondary?0:ke.tickangle,kr=(ke._prevTickAngles||{})[yt],wr=it.layer.selectAll("g."+yt).data(ke.showticklabels?Dt:[],Rt),Sr=[];wr.enter().append("g").classed(yt,1).append("text").attr("text-anchor","middle").each(function(Ft){var jt=h.select(this),sr=Pe._promises.length;jt.call(n.positionText,Xt.xFn(Ft),Xt.yFn(Ft)).call(f.font,Ft.font,Ft.fontSize,Ft.fontColor).text(Ft.text).call(n.convertToTspans,Pe),Pe._promises[sr]?Sr.push(Pe._promises.pop().then(function(){Zr(jt,ar)})):Zr(jt,ar)}),Ut(ke,[N]),wr.exit().remove(),it.repositionOnUpdate&&wr.each(function(Ft){h.select(this).select("text").call(n.positionText,Xt.xFn(Ft),Xt.yFn(Ft))});function Zr(Ft,jt){Ft.each(function(sr){var zr=h.select(this),Ur=zr.select(".text-math-group"),Dr=Xt.anchorFn(sr,jt),Tr=it.transFn.call(zr.node(),sr)+(u(jt)&&+jt!=0?" rotate("+jt+","+Xt.xFn(sr)+","+(Xt.yFn(sr)-sr.fontSize/2)+")":""),Wr=n.lineCount(zr),An=X*sr.fontSize,vn=Xt.heightFn(sr,u(jt)?+jt:0,(Wr-1)*An);if(vn&&(Tr+=i(0,vn)),Ur.empty()){var Un=zr.select("text");Un.attr({transform:Tr,"text-anchor":Dr}),Un.style("opacity",1),ke._adjustTickLabelsOverflow&&ke._adjustTickLabelsOverflow()}else{var Dn=f.bBox(Ur.node()).width,Xn=Dn*{end:-.5,start:.5}[Dr];Ur.attr("transform",Tr+i(Xn,0))}})}ke._adjustTickLabelsOverflow=function(){var Ft=ke.ticklabeloverflow;if(!(!Ft||Ft==="allow")){var jt=Ft.indexOf("hide")!==-1,sr=ke._id.charAt(0)==="x",zr=0,Ur=sr?Pe._fullLayout.width:Pe._fullLayout.height;if(Ft.indexOf("domain")!==-1){var Dr=e.simpleMap(ke.range,ke.r2l);zr=ke.l2p(Dr[0])+ke._offset,Ur=ke.l2p(Dr[1])+ke._offset}var Tr=Math.min(zr,Ur),Wr=Math.max(zr,Ur),An=ke.side,vn=1/0,Un=-1/0;wr.each(function(ya){var Ca=h.select(this),gi=Ca.select(".text-math-group");if(gi.empty()){var Xa=f.bBox(Ca.node()),$a=0;sr?(Xa.right>Wr||Xa.left<Tr)&&($a=1):(Xa.bottom>Wr||Xa.top+(ke.tickangle?0:ya.fontSize/4)<Tr)&&($a=1);var Ja=Ca.select("text");$a?jt&&Ja.style("opacity",0):(Ja.style("opacity",1),An==="bottom"||An==="right"?vn=Math.min(vn,sr?Xa.top:Xa.left):vn=-1/0,An==="top"||An==="left"?Un=Math.max(Un,sr?Xa.bottom:Xa.right):Un=1/0)}});for(var Dn in ut._plots){var Xn=ut._plots[Dn];if(!(ke._id!==Xn.xaxis._id&&ke._id!==Xn.yaxis._id)){var Yn=sr?Xn.yaxis:Xn.xaxis;Yn&&(Yn["_visibleLabelMin_"+ke._id]=vn,Yn["_visibleLabelMax_"+ke._id]=Un)}}}},ke._hideCounterAxisInsideTickLabels=function(Ft){var jt=ke._id.charAt(0)==="x",sr=[];for(var zr in ut._plots){var Ur=ut._plots[zr];ke._id!==Ur.xaxis._id&&ke._id!==Ur.yaxis._id||sr.push(jt?Ur.yaxis:Ur.xaxis)}sr.forEach(function(Dr,Tr){Dr&&St(Dr)&&(Ft||[z,I,F,O,N]).forEach(function(Wr){var An=Wr.K==="tick"&&Wr.L==="text"&&ke.ticklabelmode==="period",vn=ut._plots[ke._mainSubplot],Un;Wr.K===z.K?Un=vn.zerolinelayer.selectAll("."+ke._id+"zl"):Wr.K===I.K?Un=vn.minorGridlayer.selectAll("."+ke._id):Wr.K===F.K?Un=vn.gridlayer.selectAll("."+ke._id):Un=vn[ke._id.charAt(0)+"axislayer"],Un.each(function(){var Dn=h.select(this);Wr.L&&(Dn=Dn.selectAll(Wr.L)),Dn.each(function(Xn){var Yn=ke.l2p(An?Mt(Xn):Xn.x)+ke._offset,ya=h.select(this);Yn<ke["_visibleLabelMax_"+Dr._id]&&Yn>ke["_visibleLabelMin_"+Dr._id]?ya.style("display","none"):Wr.K==="tick"&&!Tr&&ya.style("display",null)})})})})},Zr(wr,kr+1?kr:ar);function ir(){return Sr.length&&Promise.all(Sr)}var xr=null;function Fr(){if(Zr(wr,ar),Dt.length&&Et==="x"&&!u(ar)&&(ke.type!=="log"||String(ke.dtick).charAt(0)!=="D")){xr=0;var Ft=0,jt=[],sr;if(wr.each(function(Xa){Ft=Math.max(Ft,Xa.fontSize);var $a=ke.l2p(Xa.x),Ja=Kr(this),Mr=f.bBox(Ja.node());jt.push({top:0,bottom:10,height:10,left:$a-Mr.width/2,right:$a+Mr.width/2+2,width:Mr.width+2})}),(ke.tickson==="boundaries"||ke.showdividers)&&!it.secondary){var zr=2;for(ke.ticks&&(zr+=ke.tickwidth/2),sr=0;sr<jt.length;sr++){var Ur=Dt[sr].xbnd,Dr=jt[sr];if(Ur[0]!==null&&Dr.left-ke.l2p(Ur[0])<zr||Ur[1]!==null&&ke.l2p(Ur[1])-Dr.right<zr){xr=90;break}}}else{var Tr=Dt.length,Wr=Math.abs((Dt[Tr-1].x-Dt[0].x)*ke._m)/(Tr-1),An=ke.ticklabelposition||"",vn=function(Xa){return An.indexOf(Xa)!==-1},Un=vn("top"),Dn=vn("left"),Xn=vn("right"),Yn=vn("bottom"),ya=Yn||Dn||Un||Xn,Ca=ya?(ke.tickwidth||0)+2*ue:0,gi=Wr<Ft*2.5||ke.type==="multicategory"||ke._name==="realaxis";for(sr=0;sr<jt.length-1;sr++)if(e.bBoxIntersect(jt[sr],jt[sr+1],Ca)){xr=gi?90:30;break}}xr&&Zr(wr,xr)}}ke._selections&&(ke._selections[yt]=wr);var Or=[ir];ke.automargin&&ut._redrawFromAutoMarginCount&&kr===90?(xr=90,Or.push(function(){Zr(wr,kr)})):Or.push(Fr),ke._tickAngles&&Or.push(function(){ke._tickAngles[yt]=xr===null?u(ar)?ar:0:xr});var Cr=ke._anchorAxis;Cr&&Cr.autorange&&St(ke)&&!ee(ut,ke._id)&&(ut._insideTickLabelsAutorange||(ut._insideTickLabelsAutorange={}),ut._insideTickLabelsAutorange[Cr._name+".autorange"]=Cr.autorange,Or.push(function(){wr.each(function(jt,sr){var zr=Kr(this),Ur=zr.select(".text-math-group");Ur.empty()&&(ke._vals[sr].bb=f.bBox(zr.node()))})}));var at=e.syncOrAsync(Or);return at&&at.then&&Pe._promises.push(at),at};function Vt(Pe,ke,it){var ut=ke._id+"divider",ht=it.vals,Et=it.layer.selectAll("path."+ut).data(ht,Rt);Et.exit().remove(),Et.enter().insert("path",":first-child").classed(ut,1).classed("crisp",1).call(r.stroke,ke.dividercolor).style("stroke-width",f.crispRound(Pe,ke.dividerwidth,1)+"px"),Et.attr("transform",it.transFn).attr("d",it.path)}K.getPxPosition=function(Pe,ke){var it=Pe._fullLayout._size,ut=ke._id.charAt(0),ht=ke.side,Et;if(ke.anchor!=="free"?Et=ke._anchorAxis:ut==="x"?Et={_offset:it.t+(1-(ke.position||0))*it.h,_length:0}:ut==="y"&&(Et={_offset:it.l+(ke.position||0)*it.w,_length:0}),ht==="top"||ht==="left")return Et._offset;if(ht==="bottom"||ht==="right")return Et._offset+Et._length};function Jt(Pe){var ke=Pe.title.font.size,it=(Pe.title.text.match(n.BR_TAG_ALL)||[]).length;return Pe.title.hasOwnProperty("standoff")?it?ke*(Z+it*X):ke*Z:it?ke*(it+1)*X:ke}function Yt(Pe,ke){var it=Pe._fullLayout,ut=ke._id,ht=ut.charAt(0),Et=ke.title.font.size,yt;if(ke.title.hasOwnProperty("standoff"))yt=ke._depth+ke.title.standoff+Jt(ke);else{var Dt=St(ke);if(ke.type==="multicategory")yt=ke._depth;else{var Xt=1.5*Et;Dt&&(Xt=.5*Et,ke.ticks==="outside"&&(Xt+=ke.ticklen)),yt=10+Xt+(ke.linewidth?ke.linewidth-1:0)}Dt||(ht==="x"?yt+=ke.side==="top"?Et*(ke.showticklabels?1:0):Et*(ke.showticklabels?1.5:.5):yt+=ke.side==="right"?Et*(ke.showticklabels?1:.5):Et*(ke.showticklabels?.5:0))}var ar=K.getPxPosition(Pe,ke),kr,wr,Sr;ht==="x"?(wr=ke._offset+ke._length/2,Sr=ke.side==="top"?ar-yt:ar+yt):(Sr=ke._offset+ke._length/2,wr=ke.side==="right"?ar+yt:ar-yt,kr={rotate:"-90",offset:0});var Zr;if(ke.type!=="multicategory"){var ir=ke._selections[ke._id+"tick"];if(Zr={selection:ir,side:ke.side},ir&&ir.node()&&ir.node().parentNode){var xr=f.getTranslate(ir.node().parentNode);Zr.offsetLeft=xr.x,Zr.offsetTop=xr.y}ke.title.hasOwnProperty("standoff")&&(Zr.pad=0)}return a.draw(Pe,ut+"title",{propContainer:ke,propName:ke._name+".title.text",placeholder:it._dfltTitle[ht],avoid:Zr,transform:kr,attributes:{x:wr,y:Sr,"text-anchor":"middle"}})}K.shouldShowZeroLine=function(Pe,ke,it){var ut=e.simpleMap(ke.range,ke.r2l);return ut[0]*ut[1]<=0&&ke.zeroline&&(ke.type==="linear"||ke.type==="-")&&!(ke.rangebreaks&&ke.maskBreaks(0)===B)&&(or(ke,0)||!Hr(Pe,ke,it,ut)||an(Pe,ke))},K.clipEnds=function(Pe,ke){return ke.filter(function(it){return or(Pe,it.x)})};function or(Pe,ke){var it=Pe.l2p(ke);return it>1&&it<Pe._length-1}function Hr(Pe,ke,it,ut){var ht=it._mainAxis;if(!ht)return;var Et=Pe._fullLayout,yt=ke._id.charAt(0),Dt=K.counterLetter(ke._id),Xt=ke._offset+(Math.abs(ut[0])<Math.abs(ut[1])==(yt==="x")?0:ke._length);function ar(ir){if(!ir.showline||!ir.linewidth)return!1;var xr=Math.max((ir.linewidth+ke.zerolinewidth)/2,1);function Fr(at){return typeof at=="number"&&Math.abs(at-Xt)<xr}if(Fr(ir._mainLinePosition)||Fr(ir._mainMirrorPosition))return!0;var Or=ir._linepositions||{};for(var Cr in Or)if(Fr(Or[Cr][0])||Fr(Or[Cr][1]))return!0}var kr=Et._plots[it._mainSubplot];if(!(kr.mainplotinfo||kr).overlays.length)return ar(it);for(var wr=K.list(Pe,Dt),Sr=0;Sr<wr.length;Sr++){var Zr=wr[Sr];if(Zr._mainAxis===ht&&ar(Zr))return!0}}function an(Pe,ke){for(var it=Pe._fullData,ut=ke._mainSubplot,ht=ke._id.charAt(0),Et=0;Et<it.length;Et++){var yt=it[Et];if(yt.visible===!0&&yt.xaxis+yt.yaxis===ut&&(T.traceIs(yt,"bar-like")&&yt.orientation==={x:"h",y:"v"}[ht]||yt.fill&&yt.fill.charAt(yt.fill.length-1)===ht))return!0}return!1}function Kr(Pe){var ke=h.select(Pe),it=ke.select(".text-math-group");return it.empty()?ke.select("text"):it}K.allowAutoMargin=function(Pe){for(var ke=K.list(Pe,"",!0),it=0;it<ke.length;it++){var ut=ke[it];ut.automargin&&(A.allowAutoMargin(Pe,ot(ut)),ut.mirror&&A.allowAutoMargin(Pe,er(ut))),T.getComponentMethod("rangeslider","isVisible")(ut)&&A.allowAutoMargin(Pe,Kt(ut))}};function ot(Pe){return Pe._id+".automargin"}function er(Pe){return ot(Pe)+".mirror"}function Kt(Pe){return Pe._id+".rangeslider"}K.swap=function(Pe,ke){for(var it=ur(Pe,ke),ut=0;ut<it.length;ut++)et(Pe,it[ut].x,it[ut].y)};function ur(Pe,ke){var it=[],ut,ht;for(ut=0;ut<ke.length;ut++){var Et=[],yt=Pe._fullData[ke[ut]].xaxis,Dt=Pe._fullData[ke[ut]].yaxis;if(!(!yt||!Dt)){for(ht=0;ht<it.length;ht++)(it[ht].x.indexOf(yt)!==-1||it[ht].y.indexOf(Dt)!==-1)&&Et.push(ht);if(!Et.length){it.push({x:[yt],y:[Dt]});continue}var Xt=it[Et[0]],ar;if(Et.length>1)for(ht=1;ht<Et.length;ht++)ar=it[Et[ht]],Ar(Xt.x,ar.x),Ar(Xt.y,ar.y);Ar(Xt.x,[yt]),Ar(Xt.y,[Dt])}}return it}function Ar(Pe,ke){for(var it=0;it<ke.length;it++)Pe.indexOf(ke[it])===-1&&Pe.push(ke[it])}function et(Pe,ke,it){var ut=[],ht=[],Et=Pe.layout,yt,Dt;for(yt=0;yt<ke.length;yt++)ut.push(K.getFromId(Pe,ke[yt]));for(yt=0;yt<it.length;yt++)ht.push(K.getFromId(Pe,it[yt]));var Xt=Object.keys(o),ar=["anchor","domain","overlaying","position","side","tickangle","editType"],kr=["linear","log"];for(yt=0;yt<Xt.length;yt++){var wr=Xt[yt],Sr=ut[0][wr],Zr=ht[0][wr],ir=!0,xr=!1,Fr=!1;if(!(wr.charAt(0)==="_"||typeof Sr=="function"||ar.indexOf(wr)!==-1)){for(Dt=1;Dt<ut.length&&ir;Dt++){var Or=ut[Dt][wr];wr==="type"&&kr.indexOf(Sr)!==-1&&kr.indexOf(Or)!==-1&&Sr!==Or?xr=!0:Or!==Sr&&(ir=!1)}for(Dt=1;Dt<ht.length&&ir;Dt++){var Cr=ht[Dt][wr];wr==="type"&&kr.indexOf(Zr)!==-1&&kr.indexOf(Cr)!==-1&&Zr!==Cr?Fr=!0:ht[Dt][wr]!==Zr&&(ir=!1)}ir&&(xr&&(Et[ut[0]._name].type="linear"),Fr&&(Et[ht[0]._name].type="linear"),$e(Et,wr,ut,ht,Pe._fullLayout._dfltTitle))}}for(yt=0;yt<Pe._fullLayout.annotations.length;yt++){var at=Pe._fullLayout.annotations[yt];ke.indexOf(at.xref)!==-1&&it.indexOf(at.yref)!==-1&&e.swapAttrs(Et.annotations[yt],["?"])}}function $e(Pe,ke,it,ut,ht){var Et=e.nestedProperty,yt=Et(Pe[it[0]._name],ke).get(),Dt=Et(Pe[ut[0]._name],ke).get(),Xt;for(ke==="title"&&(yt&&yt.text===ht.x&&(yt.text=ht.y),Dt&&Dt.text===ht.y&&(Dt.text=ht.x)),Xt=0;Xt<it.length;Xt++)Et(Pe,it[Xt]._name+"."+ke).set(Dt);for(Xt=0;Xt<ut.length;Xt++)Et(Pe,ut[Xt]._name+"."+ke).set(yt)}function st(Pe){return Pe._id==="angularaxis"}function ft(Pe,ke){for(var it=ke._rangebreaks.length,ut=0;ut<it;ut++){var ht=ke._rangebreaks[ut];if(Pe>=ht.min&&Pe<ht.max)return ht.max}return Pe}function St(Pe){return(Pe.ticklabelposition||"").indexOf("inside")!==-1}function Ut(Pe,ke){St(Pe._anchorAxis||{})&&Pe._hideCounterAxisInsideTickLabels&&Pe._hideCounterAxisInsideTickLabels(ke)}},{"../../components/color":367,"../../components/drawing":389,"../../components/titles":476,"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"./autorange":565,"./axis_autotype":567,"./axis_ids":570,"./clean_ticks":572,"./layout_attributes":579,"./set_convert":585,"@plotly/d3":58,"fast-isnumeric":190}],567:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib"),A=t("../../constants/numerical").BADNUM,T=u.isArrayOrTypedArray,e=u.isDateTime,i=u.cleanNumber,n=Math.round;P.exports=function(p,v,x){var l=p,b=x.noMultiCategory;if(T(l)&&!l.length)return"-";if(!b&&m(l))return"multicategory";if(b&&Array.isArray(l[0])){for(var c=[],M=0;M<l.length;M++)if(T(l[M]))for(var _=0;_<l[M].length;_++)c.push(l[M][_]);l=c}if(f(l,v))return"date";var y=x.autotypenumbers!=="strict";return s(l,y)?"category":r(l,y)?"linear":"-"};function a(g,p){return p?h(g):typeof g=="number"}function r(g,p){for(var v=g.length,x=0;x<v;x++)if(a(g[x],p))return!0;return!1}function f(g,p){for(var v=g.length,x=o(v),l=0,b=0,c={},M=0;M<v;M+=x){var _=n(M),y=g[_],w=String(y);c[w]||(c[w]=1,e(y,p)&&l++,h(y)&&b++)}return l>b*2}function o(g){return Math.max(1,(g-1)/1e3)}function s(g,p){for(var v=g.length,x=o(v),l=0,b=0,c={},M=0;M<v;M+=x){var _=n(M),y=g[_],w=String(y);if(!c[w]){c[w]=1;var d=typeof y;d==="boolean"?b++:(p?i(y)!==A:d==="number")?l++:d==="string"&&b++}}return b>l*2}function m(g){return T(g[0])&&T(g[1])}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],568:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../registry"),A=t("../../lib"),T=t("../../plot_api/plot_template"),e=t("../array_container_defaults"),i=t("./layout_attributes"),n=t("./tick_value_defaults"),a=t("./tick_mark_defaults"),r=t("./tick_label_defaults"),f=t("./prefix_suffix_defaults"),o=t("./category_order_defaults"),s=t("./line_grid_defaults"),m=t("./set_convert"),g=t("./constants").WEEKDAY_PATTERN,p=t("./constants").HOUR_PATTERN;P.exports=function(c,M,_,y,w){var d=y.letter,C=y.font||{},S=y.splomStash||{},E=_("visible",!y.visibleDflt),k=M._template||{},B=M.type||k.type||"-",z;if(B==="date"){var F=u.getComponentMethod("calendars","handleDefaults");F(c,M,"calendar",y.calendar),y.noTicklabelmode||(z=_("ticklabelmode"))}var I="";(!y.noTicklabelposition||B==="multicategory")&&(I=A.coerce(c,M,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:z==="period"?["outside","inside"]:d==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),y.noTicklabeloverflow||_("ticklabeloverflow",I.indexOf("inside")!==-1?"hide past domain":B==="category"||B==="multicategory"?"allow":"hide past div"),m(M,w);var O=!M.isValidRange(c.range);O&&y.reverseDflt&&(O="reversed");var N=_("autorange",O);N&&(B==="linear"||B==="-")&&_("rangemode"),_("range"),M.cleanRange(),o(c,M,_,y),B!=="category"&&!y.noHover&&_("hoverformat");var V=_("color"),H=V!==i.color.dflt?V:C.color,j=S.label||w._dfltTitle[d];if(f(c,M,_,B,y),!E)return M;_("title.text",j),A.coerceFont(_,"title.font",{family:C.family,size:A.bigFont(C.size),color:H}),n(c,M,_,B);var Z=y.hasMinor;if(Z&&(T.newContainer(M,"minor"),n(c,M,_,B,{isMinor:!0})),r(c,M,_,B,y),a(c,M,_,y),Z){var X=y.isMinor;y.isMinor=!0,a(c,M,_,y),y.isMinor=X}s(c,M,_,{dfltColor:V,bgColor:y.bgColor,showGrid:y.showGrid,hasMinor:Z,attributes:i}),Z&&!M.minor.ticks&&!M.minor.showgrid&&delete M.minor,(M.showline||M.ticks)&&_("mirror"),y.automargin&&_("automargin");var re=B==="multicategory";if(!y.noTickson&&(B==="category"||re)&&(M.ticks||M.showgrid)){var ue;re&&(ue="boundaries");var K=_("tickson",ue);K==="boundaries"&&delete M.ticklabelposition}if(re){var te=_("showdividers");te&&(_("dividercolor"),_("dividerwidth"))}if(B==="date")if(e(c,M,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:v}),!M.rangebreaks.length)delete M.rangebreaks;else{for(var G=0;G<M.rangebreaks.length;G++)if(M.rangebreaks[G].pattern===g){M._hasDayOfWeekBreaks=!0;break}if(m(M,w),w._has("scattergl")||w._has("splom"))for(var Y=0;Y<y.data.length;Y++){var ee=y.data[Y];(ee.type==="scattergl"||ee.type==="splom")&&(ee.visible=!1,A.warn(ee.type+" traces do not work on axes with rangebreaks. Setting trace "+ee.index+" to `visible: false`."))}}return M};function v(b,c,M){function _(z,F){return A.coerce(b,c,i.rangebreaks,z,F)}var y=_("enabled");if(y){var w=_("bounds");if(w&&w.length>=2){var d="",C,S;if(w.length===2){for(C=0;C<2;C++)if(S=l(w[C]),S){d=g;break}}var E=_("pattern",d);if(E===g)for(C=0;C<2;C++)S=l(w[C]),S&&(c.bounds[C]=w[C]=S-1);if(E)for(C=0;C<2;C++)switch(S=w[C],E){case g:if(!h(S)){c.enabled=!1;return}if(S=+S,S!==Math.floor(S)||S<0||S>=7){c.enabled=!1;return}c.bounds[C]=w[C]=S;break;case p:if(!h(S)){c.enabled=!1;return}if(S=+S,S<0||S>24){c.enabled=!1;return}c.bounds[C]=w[C]=S;break}if(M.autorange===!1){var k=M.range;if(k[0]<k[1]){if(w[0]<k[0]&&w[1]>k[1]){c.enabled=!1;return}}else if(w[0]>k[0]&&w[1]<k[1]){c.enabled=!1;return}}}else{var B=_("values");if(B&&B.length)_("dvalue");else{c.enabled=!1;return}}}}var x={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function l(b){if(typeof b=="string")return x[b.substr(0,3).toLowerCase()]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../array_container_defaults":561,"./category_order_defaults":571,"./constants":573,"./layout_attributes":579,"./line_grid_defaults":581,"./prefix_suffix_defaults":583,"./set_convert":585,"./tick_label_defaults":587,"./tick_mark_defaults":588,"./tick_value_defaults":589,"fast-isnumeric":190}],569:[function(t,P,R){var h=t("../../constants/docs"),u=h.FORMAT_LINK,A=h.DATE_FORMAT_LINK;function T(n,a){return{valType:"string",dflt:"",editType:"none",description:(a?e:i)("hover text",n)+["By default the values are formatted using "+(a?"generic number format":"`"+n+"axis.hoverformat`")+"."].join(" ")}}function e(n,a){return["Sets the "+n+" formatting rule"+(a?"for `"+a+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+u+"."].join(" ")}function i(n,a){return e(n,a)+[" And for dates see: "+A+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}P.exports={axisHoverFormat:T,descriptionOnlyNumbers:e,descriptionWithDates:i}},{"../../constants/docs":486}],570:[function(t,P,R){var h=t("../../registry"),u=t("./constants");R.id2name=function(e){if(!(typeof e!="string"||!e.match(u.AX_ID_PATTERN))){var i=e.split(" ")[0].substr(1);return i==="1"&&(i=""),e.charAt(0)+"axis"+i}},R.name2id=function(e){if(!!e.match(u.AX_NAME_PATTERN)){var i=e.substr(5);return i==="1"&&(i=""),e.charAt(0)+i}},R.cleanId=function(e,i,n){var a=/( domain)$/.test(e);if(!(typeof e!="string"||!e.match(u.AX_ID_PATTERN))&&!(i&&e.charAt(0)!==i)&&!(a&&!n)){var r=e.split(" ")[0].substr(1).replace(/^0+/,"");return r==="1"&&(r=""),e.charAt(0)+r+(a&&n?" domain":"")}},R.list=function(T,e,i){var n=T._fullLayout;if(!n)return[];var a=R.listIds(T,e),r=new Array(a.length),f;for(f=0;f<a.length;f++){var o=a[f];r[f]=n[o.charAt(0)+"axis"+o.substr(1)]}if(!i){var s=n._subplots.gl3d||[];for(f=0;f<s.length;f++){var m=n[s[f]];e?r.push(m[e+"axis"]):r.push(m.xaxis,m.yaxis,m.zaxis)}}return r},R.listIds=function(T,e){var i=T._fullLayout;if(!i)return[];var n=i._subplots;return e?n[e+"axis"]:n.xaxis.concat(n.yaxis)},R.getFromId=function(T,e,i){var n=T._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),i==="x"?e=e.replace(/y[0-9]*/,""):i==="y"&&(e=e.replace(/x[0-9]*/,"")),n[R.id2name(e)]},R.getFromTrace=function(T,e,i){var n=T._fullLayout,a=null;if(h.traceIs(e,"gl3d")){var r=e.scene;r.substr(0,5)==="scene"&&(a=n[r][i+"axis"])}else a=R.getFromId(T,e[i+"axis"]||i);return a},R.idSort=function(T,e){var i=T.charAt(0),n=e.charAt(0);return i!==n?i>n?1:-1:+(T.substr(1)||1)-+(e.substr(1)||1)},R.ref2id=function(T){return/^[xyz]/.test(T)?T.split(" ")[0]:!1};function A(T,e){if(e&&e.length){for(var i=0;i<e.length;i++)if(e[i][T])return!0}return!1}R.isLinked=function(T,e){return A(e,T._axisMatchGroups)||A(e,T._axisConstraintGroups)}},{"../../registry":647,"./constants":573}],571:[function(t,P,R){function h(u,A){var T=A.dataAttr||u._id.charAt(0),e={},i,n,a;if(A.axData)i=A.axData;else for(i=[],n=0;n<A.data.length;n++){var r=A.data[n];r[T+"axis"]===u._id&&i.push(r)}for(n=0;n<i.length;n++){var f=i[n][T];for(a=0;a<f.length;a++){var o=f[a];o!=null&&(e[o]=1)}}return Object.keys(e)}P.exports=function(A,T,e,i){if(T.type==="category"){var n=A.categoryarray,a=Array.isArray(n)&&n.length>0,r;a&&(r="array");var f=e("categoryorder",r),o;f==="array"&&(o=e("categoryarray")),!a&&f==="array"&&(f=T.categoryorder="trace"),f==="trace"?T._initialCategories=[]:f==="array"?T._initialCategories=o.slice():(o=h(T,i).sort(),f==="category ascending"?T._initialCategories=o:f==="category descending"&&(T._initialCategories=o.reverse()))}}},{}],572:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib"),A=t("../../constants/numerical"),T=A.ONEDAY,e=A.ONEWEEK;R.dtick=function(i,n){var a=n==="log",r=n==="date",f=n==="category",o=r?T:1;if(!i)return o;if(h(i))return i=Number(i),i<=0?o:f?Math.max(1,Math.round(i)):r?Math.max(.1,i):i;if(typeof i!="string"||!(r||a))return o;var s=i.charAt(0),m=i.substr(1);return m=h(m)?Number(m):0,m<=0||!(r&&s==="M"&&m===Math.round(m)||a&&s==="L"||a&&s==="D"&&(m===1||m===2))?o:i},R.tick0=function(i,n,a,r){if(n==="date")return u.cleanDate(i,u.dateTick0(a,r%e===0?1:0));if(!(r==="D1"||r==="D2"))return h(i)?Number(i):0}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],573:[function(t,P,R){var h=t("../../lib/regex").counter;P.exports={idRegex:{x:h("x","( domain)?"),y:h("y","( domain)?")},attrRegex:h("[xy]axis"),xAxisMatch:h("xaxis"),yAxisMatch:h("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINZOOM:20,DRAGGERSIZE:20,REDRAWDELAY:50,DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":532}],574:[function(t,P,R){var h=t("../../lib"),u=t("./autorange"),A=t("./axis_ids").id2name,T=t("./layout_attributes"),e=t("./scale_zoom"),i=t("./set_convert"),n=t("../../constants/numerical").ALMOST_EQUAL,a=t("../../constants/alignment").FROM_BL;R.handleDefaults=function(v,x,l){var b=l.axIds,c=l.axHasImage,M=x._axisConstraintGroups=[],_=x._axisMatchGroups=[],y,w,d,C,S,E,k,B;for(y=0;y<b.length;y++)C=A(b[y]),S=v[C],E=x[C],r(S,E,{axIds:b,layoutOut:x,hasImage:c[C]});function z(X,re){for(y=0;y<X.length;y++){w=X[y];for(d in w)x[A(d)][re]=w}}for(z(_,"_matchGroup"),y=0;y<M.length;y++){w=M[y];for(d in w)if(E=x[A(d)],E.fixedrange){for(var F in w){var I=A(F);(v[I]||{}).fixedrange===!1&&h.warn("fixedrange was specified as false for axis "+I+" but was overridden because another axis in its constraint group has fixedrange true"),x[I].fixedrange=!0}break}}for(y=0;y<M.length;){w=M[y];for(d in w){E=x[A(d)],E._matchGroup&&Object.keys(E._matchGroup).length===Object.keys(w).length&&(M.splice(y,1),y--);break}y++}z(M,"_constraintGroup");var O=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],N=!1,V=!1;function H(){B=E[k],k==="rangebreaks"&&(V=E._hasDayOfWeekBreaks)}for(y=0;y<_.length;y++){w=_[y];for(var j=0;j<O.length;j++){k=O[j],B=null;var Z;for(d in w)if(C=A(d),S=v[C],E=x[C],k in E){if(!E.matches&&(Z=E,k in S)){H();break}B===null&&k in S&&H()}if(k==="range"&&B&&(N=!0),k==="autorange"&&B===null&&N&&(B=!1),B===null&&k in Z&&(B=Z[k]),B!==null)for(d in w)E=x[A(d)],E[k]=k==="range"?B.slice():B,k==="rangebreaks"&&(E._hasDayOfWeekBreaks=V,i(E,x))}}};function r(v,x,l){var b=l.axIds,c=l.layoutOut,M=l.hasImage,_=c._axisConstraintGroups,y=c._axisMatchGroups,w=x._id,d=w.charAt(0),C=((c._splomAxes||{})[d]||{})[w]||{},S=x._id,E=S.charAt(0)==="x";x._matchGroup=null,x._constraintGroup=null;function k(te,G){return h.coerce(v,x,T,te,G)}k("constrain",M?"domain":"range"),h.coerce(v,x,{constraintoward:{valType:"enumerated",values:E?["left","center","right"]:["bottom","middle","top"],dflt:E?"center":"middle"}},"constraintoward");var B=x.type,z,F,I=[];for(z=0;z<b.length;z++)if(F=b[z],F!==S){var O=c[A(F)];O.type===B&&I.push(F)}var N=o(_,S);if(N){var V=[];for(z=0;z<I.length;z++)F=I[z],N[F]||V.push(F);I=V}var H=I.length,j,Z;H&&(v.matches||C.matches)&&(j=h.coerce(v,x,{matches:{valType:"enumerated",values:I,dflt:I.indexOf(C.matches)!==-1?C.matches:void 0}},"matches"));var X=M&&!E?x.anchor:void 0;if(H&&!j&&(v.scaleanchor||X)&&(Z=h.coerce(v,x,{scaleanchor:{valType:"enumerated",values:I}},"scaleanchor",X)),j){x._matchGroup=s(y,S,j,1);var re=c[A(j)],ue=f(c,x)/f(c,re);E!==(j.charAt(0)==="x")&&(ue=(E?"x":"y")+ue),s(_,S,j,ue)}else v.matches&&b.indexOf(v.matches)!==-1&&h.warn("ignored "+x._name+'.matches: "'+v.matches+'" to avoid an infinite loop');if(Z){var K=k("scaleratio");K||(K=x.scaleratio=1),s(_,S,Z,K)}else v.scaleanchor&&b.indexOf(v.scaleanchor)!==-1&&h.warn("ignored "+x._name+'.scaleanchor: "'+v.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function f(v,x){var l=x.domain;return l||(l=v[A(x.overlaying)].domain),l[1]-l[0]}function o(v,x){for(var l=0;l<v.length;l++)if(v[l][x])return v[l];return null}function s(v,x,l,b){var c,M,_,y,w,d=o(v,x);d===null?(d={},d[x]=1,w=v.length,v.push(d)):w=v.indexOf(d);var C=Object.keys(d);for(c=0;c<v.length;c++)if(_=v[c],c!==w&&_[l]){var S=_[l];for(M=0;M<C.length;M++)y=C[M],_[y]=m(S,m(b,d[y]));v.splice(w,1);return}if(b!==1)for(M=0;M<C.length;M++){var E=C[M];d[E]=m(b,d[E])}d[l]=1}function m(v,x){var l="",b="",c,M;typeof v=="string"&&(l=v.match(/^[xy]*/)[0],c=l.length,v=+v.substr(c)),typeof x=="string"&&(b=x.match(/^[xy]*/)[0],M=b.length,x=+x.substr(M));var _=v*x;return!c&&!M?_:!c||!M||l.charAt(0)===b.charAt(0)?l+b+v*x:c===M?_:(c>M?l.substr(M):b.substr(c))+_}function g(v,x){for(var l=x._size,b=l.h/l.w,c={},M=Object.keys(v),_=0;_<M.length;_++){var y=M[_],w=v[y];if(typeof w=="string"){var d=w.match(/^[xy]*/)[0],C=d.length;w=+w.substr(C);for(var S=d.charAt(0)==="y"?b:1/b,E=0;E<C;E++)w*=S}c[y]=w}return c}R.enforce=function(x){var l=x._fullLayout,b=l._axisConstraintGroups||[],c,M,_,y,w,d,C,S;for(c=0;c<b.length;c++){_=g(b[c],l);var E=Object.keys(_),k=1/0,B=0,z=1/0,F={},I={},O=!1;for(M=0;M<E.length;M++)y=E[M],I[y]=w=l[A(y)],w._inputDomain?w.domain=w._inputDomain.slice():w._inputDomain=w.domain.slice(),w._inputRange||(w._inputRange=w.range.slice()),w.setScale(),F[y]=d=Math.abs(w._m)/_[y],k=Math.min(k,d),(w.constrain==="domain"||!w._constraintShrinkable)&&(z=Math.min(z,d)),delete w._constraintShrinkable,B=Math.max(B,d),w.constrain==="domain"&&(O=!0);if(!(k>n*B&&!O)){for(M=0;M<E.length;M++)if(y=E[M],d=F[y],w=I[y],C=w.constrain,d!==z||C==="domain")if(S=d/z,C==="range")e(w,S);else{var N=w._inputDomain,V=(w.domain[1]-w.domain[0])/(N[1]-N[0]),H=(w.r2l(w.range[1])-w.r2l(w.range[0]))/(w.r2l(w._inputRange[1])-w.r2l(w._inputRange[0]));if(S/=V,S*H<1){w.domain=w._input.domain=N.slice(),e(w,S);continue}if(H<1&&(w.range=w._input.range=w._inputRange.slice(),S*=H),w.autorange){var j=w.r2l(w.range[0]),Z=w.r2l(w.range[1]),X=(j+Z)/2,re=X,ue=X,K=Math.abs(Z-X),te=X-K*S*1.0001,G=X+K*S*1.0001,Y=u.makePadFn(l,w,0),ee=u.makePadFn(l,w,1);p(w,S);var ne=Math.abs(w._m),J=u.concatExtremes(x,w),q=J.min,ae=J.max,le,ie;for(ie=0;ie<q.length;ie++)le=q[ie].val-Y(q[ie])/ne,le>te&&le<re&&(re=le);for(ie=0;ie<ae.length;ie++)le=ae[ie].val+ee(ae[ie])/ne,le<G&&le>ue&&(ue=le);var se=(ue-re)/(2*K);S/=se,re=w.l2r(re),ue=w.l2r(ue),w.range=w._input.range=j<Z?[re,ue]:[ue,re]}p(w,S)}}}},R.getAxisGroup=function(x,l){for(var b=x._axisMatchGroups,c=0;c<b.length;c++){var M=b[c];if(M[l])return"g"+c}return l},R.clean=function(x,l){if(l._inputDomain){for(var b=!1,c=l._id,M=x._fullLayout._axisConstraintGroups,_=0;_<M.length;_++)if(M[_][c]){b=!0;break}(!b||l.constrain!=="domain")&&(l._input.domain=l.domain=l._inputDomain,delete l._inputDomain)}};function p(v,x){var l=v._inputDomain,b=a[v.constraintoward],c=l[0]+(l[1]-l[0])*b;v.domain=v._input.domain=[c+(l[0]-c)/x,c+(l[1]-c)/x],v.setScale()}},{"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"./autorange":565,"./axis_ids":570,"./layout_attributes":579,"./scale_zoom":584,"./set_convert":585}],575:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=u.numberFormat,T=t("tinycolor2"),e=t("has-passive-events"),i=t("../../registry"),n=u.strTranslate,a=t("../../lib/svg_text_utils"),r=t("../../components/color"),f=t("../../components/drawing"),o=t("../../components/fx"),s=t("./axes"),m=t("../../lib/setcursor"),g=t("../../components/dragelement"),p=t("../../components/dragelement/helpers"),v=p.selectingOrDrawing,x=p.freeMode,l=t("../../constants/alignment").FROM_TL,b=t("../../lib/clear_gl_canvases"),c=t("../../plot_api/subroutines").redrawReglTraces,M=t("../plots"),_=t("./axis_ids").getFromId,y=t("../../components/selections").prepSelect,w=t("../../components/selections").clearOutline,d=t("../../components/selections").selectOnClick,C=t("./scale_zoom"),S=t("./constants"),E=S.MINDRAG,k=S.MINZOOM,B=!0;function z(le,ie,se,xe,oe,he,be,me){var _e=le._fullLayout._zoomlayer,Se=be+me==="nsew",De=(be+me).length===1,Ie,Te,Ce,He,Xe,Be,Re,We,vt,Pt,Zt,zt,At,Wt,Bt,Ct,Ze,nt,Ye,Ee,Ge,Je,qe;function Tt(){if(Ie=ie.xaxis,Te=ie.yaxis,vt=Ie._length,Pt=Te._length,Re=Ie._offset,We=Te._offset,Ce={},Ce[Ie._id]=Ie,He={},He[Te._id]=Te,be&&me)for(var wr=ie.overlays,Sr=0;Sr<wr.length;Sr++){var Zr=wr[Sr].xaxis;Ce[Zr._id]=Zr;var ir=wr[Sr].yaxis;He[ir._id]=ir}Xe=ae(Ce),Be=ae(He),At=O(Xe,me),Wt=O(Be,be),Bt=!Wt&&!At,zt=J(le,le._fullLayout._axisMatchGroups,Ce,He),Zt=J(le,le._fullLayout._axisConstraintGroups,Ce,He,zt);var xr=Zt.isSubplotConstrained||zt.isSubplotConstrained;Ct=me||xr,Ze=be||xr;var Fr=le._fullLayout;nt=Fr._has("scattergl"),Ye=Fr._has("splom"),Ee=Fr._has("svg")}Tt();var mt=Z(Wt+At,le._fullLayout.dragmode,Se),Mt=I(ie,be+me+"drag",mt,se,xe,oe,he);if(Bt&&!Se)return Mt.onmousedown=null,Mt.style.pointerEvents="none",Mt;var Ht={element:Mt,gd:le,plotinfo:ie};Ht.prepFn=function(wr,Sr,Zr){var ir=Ht.dragmode,xr=le._fullLayout.dragmode;xr!==ir&&(Ht.dragmode=xr),Tt(),Je=le._fullLayout._invScaleX,qe=le._fullLayout._invScaleY,Bt||(Se?wr.shiftKey?xr==="pan"?xr="zoom":v(xr)||(xr="pan"):wr.ctrlKey&&(xr="pan"):xr="pan"),x(xr)?Ht.minDrag=1:Ht.minDrag=void 0,v(xr)?(Ht.xaxes=Xe,Ht.yaxes=Be,y(wr,Sr,Zr,Ht,xr)):(Ht.clickFn=Vt,v(ir)&&Rt(),Bt||(xr==="zoom"?(Ht.moveFn=et,Ht.doneFn=st,Ht.minDrag=1,Ar(wr,Sr,Zr)):xr==="pan"&&(Ht.moveFn=it,Ht.doneFn=yt))),le._fullLayout._redrag=function(){var Fr=le._dragdata;if(Fr&&Fr.element===Mt){var Or=le._fullLayout.dragmode;v(Or)||(Tt(),Dt([0,0,vt,Pt]),Ht.moveFn(Fr.dx,Fr.dy))}}};function Rt(){Ht.plotinfo.selection=!1,w(le)}function Vt(wr,Sr){var Zr=Ht.gd;if(Zr._fullLayout._activeShapeIndex>=0){Zr._fullLayout._deactivateShape(Zr);return}var ir=Zr._fullLayout.clickmode;if(te(Zr),wr===2&&!De&&Et(),Se)ir.indexOf("select")>-1&&d(Sr,Zr,Xe,Be,ie.id,Ht),ir.indexOf("event")>-1&&o.click(Zr,Sr,ie.id);else if(wr===1&&De){var xr=be?Te:Ie,Fr=be==="s"||me==="w"?0:1,Or=xr._name+".range["+Fr+"]",Cr=N(xr,Fr),at="left",Ft="middle";if(xr.fixedrange)return;be?(Ft=be==="n"?"top":"bottom",xr.side==="right"&&(at="right")):me==="e"&&(at="right"),Zr._context.showAxisRangeEntryBoxes&&h.select(Mt).call(a.makeEditable,{gd:Zr,immediate:!0,background:Zr._fullLayout.paper_bgcolor,text:String(Cr),fill:xr.tickfont?xr.tickfont.color:"#444",horizontalAlign:at,verticalAlign:Ft}).on("edit",function(jt){var sr=xr.d2r(jt);sr!==void 0&&i.call("_guiRelayout",Zr,Or,sr)})}}g.init(Ht);var Jt,Yt,or,Hr,an,Kr,ot,er,Kt,ur;function Ar(wr,Sr,Zr){var ir=Mt.getBoundingClientRect();Jt=Sr-ir.left,Yt=Zr-ir.top,le._fullLayout._calcInverseTransform(le);var xr=u.apply3DTransform(le._fullLayout._invTransform)(Jt,Yt);Jt=xr[0],Yt=xr[1],or={l:Jt,r:Jt,w:0,t:Yt,b:Yt,h:0},Hr=le._hmpixcount?le._hmlumcount/le._hmpixcount:T(le._fullLayout.plot_bgcolor).getLuminance(),an="M0,0H"+vt+"V"+Pt+"H0V0",Kr=!1,ot="xy",ur=!1,er=X(_e,Hr,Re,We,an),Kt=re(_e,Re,We)}function et(wr,Sr){if(le._transitioningWithDuration)return!1;var Zr=Math.max(0,Math.min(vt,Je*wr+Jt)),ir=Math.max(0,Math.min(Pt,qe*Sr+Yt)),xr=Math.abs(Zr-Jt),Fr=Math.abs(ir-Yt);or.l=Math.min(Jt,Zr),or.r=Math.max(Jt,Zr),or.t=Math.min(Yt,ir),or.b=Math.max(Yt,ir);function Or(){ot="",or.r=or.l,or.t=or.b,Kt.attr("d","M0,0Z")}if(Zt.isSubplotConstrained)xr>k||Fr>k?(ot="xy",xr/vt>Fr/Pt?(Fr=xr*Pt/vt,Yt>ir?or.t=Yt-Fr:or.b=Yt+Fr):(xr=Fr*vt/Pt,Jt>Zr?or.l=Jt-xr:or.r=Jt+xr),Kt.attr("d",ne(or))):Or();else if(zt.isSubplotConstrained)if(xr>k||Fr>k){ot="xy";var Cr=Math.min(or.l/vt,(Pt-or.b)/Pt),at=Math.max(or.r/vt,(Pt-or.t)/Pt);or.l=Cr*vt,or.r=at*vt,or.b=(1-Cr)*Pt,or.t=(1-at)*Pt,Kt.attr("d",ne(or))}else Or();else!Wt||Fr<Math.min(Math.max(xr*.6,E),k)?xr<E||!At?Or():(or.t=0,or.b=Pt,ot="x",Kt.attr("d",Y(or,Yt))):!At||xr<Math.min(Fr*.6,k)?(or.l=0,or.r=vt,ot="y",Kt.attr("d",ee(or,Jt))):(ot="xy",Kt.attr("d",ne(or)));or.w=or.r-or.l,or.h=or.b-or.t,ot&&(ur=!0),le._dragged=ur,ue(er,Kt,or,an,Kr,Hr),$e(),le.emit("plotly_relayouting",Ge),Kr=!0}function $e(){Ge={},(ot==="xy"||ot==="x")&&(V(Xe,or.l/vt,or.r/vt,Ge,Zt.xaxes),ut("x",Ge)),(ot==="xy"||ot==="y")&&(V(Be,(Pt-or.b)/Pt,(Pt-or.t)/Pt,Ge,Zt.yaxes),ut("y",Ge))}function st(){$e(),te(le),yt(),G(le)}var ft=[0,0,vt,Pt],St=null,Ut=S.REDRAWDELAY,Pe=ie.mainplot?le._fullLayout._plots[ie.mainplot]:ie;function ke(wr){if(!le._context._scrollZoom.cartesian&&!le._fullLayout._enablescrollzoom)return;if(Rt(),le._transitioningWithDuration){wr.preventDefault(),wr.stopPropagation();return}Tt(),clearTimeout(St);var Sr=-wr.deltaY;if(isFinite(Sr)||(Sr=wr.wheelDelta/10),!isFinite(Sr)){u.log("Did not find wheel motion attributes: ",wr);return}var Zr=Math.exp(-Math.min(Math.max(Sr,-20),20)/200),ir=Pe.draglayer.select(".nsewdrag").node().getBoundingClientRect(),xr=(wr.clientX-ir.left)/ir.width,Fr=(ir.bottom-wr.clientY)/ir.height,Or;function Cr(at,Ft,jt){if(at.fixedrange)return;var sr=u.simpleMap(at.range,at.r2l),zr=sr[0]+(sr[1]-sr[0])*Ft;function Ur(Dr){return at.l2r(zr+(Dr-zr)*jt)}at.range=sr.map(Ur)}if(Ct){for(me||(xr=.5),Or=0;Or<Xe.length;Or++)Cr(Xe[Or],xr,Zr);ut("x"),ft[2]*=Zr,ft[0]+=ft[2]*xr*(1/Zr-1)}if(Ze){for(be||(Fr=.5),Or=0;Or<Be.length;Or++)Cr(Be[Or],Fr,Zr);ut("y"),ft[3]*=Zr,ft[1]+=ft[3]*(1-Fr)*(1/Zr-1)}Dt(ft),ht(),le.emit("plotly_relayouting",Ge),St=setTimeout(function(){!le._fullLayout||(ft=[0,0,vt,Pt],yt())},Ut),wr.preventDefault()}be.length*me.length!==1&&q(Mt,ke);function it(wr,Sr){if(wr=wr*Je,Sr=Sr*qe,le._transitioningWithDuration)return;if(le._fullLayout._replotting=!0,At==="ew"||Wt==="ns"){var Zr=At?-wr:0,ir=Wt?-Sr:0;if(zt.isSubplotConstrained){if(At&&Wt){var xr=(wr/vt-Sr/Pt)/2;wr=xr*vt,Sr=-xr*Pt,Zr=-wr,ir=-Sr}Wt?Zr=-ir*vt/Pt:ir=-Zr*Pt/vt}At&&(H(Xe,wr),ut("x")),Wt&&(H(Be,Sr),ut("y")),Dt([Zr,ir,vt,Pt]),ht(),le.emit("plotly_relayouting",Ge);return}function Fr(Ur,Dr,Tr){for(var Wr=1-Dr,An,vn,Un=0;Un<Ur.length;Un++){var Dn=Ur[Un];if(!Dn.fixedrange){An=Dn,vn=Dn._rl[Wr]+(Dn._rl[Dr]-Dn._rl[Wr])/j(Tr/Dn._length);var Xn=Dn.l2r(vn);Xn!==!1&&Xn!==void 0&&(Dn.range[Dr]=Xn)}}return An._length*(An._rl[Dr]-vn)/(An._rl[Dr]-An._rl[Wr])}var Or=At==="w"==(Wt==="n")?1:-1;if(At&&Wt&&(Zt.isSubplotConstrained||zt.isSubplotConstrained)){var Cr=(wr/vt+Or*Sr/Pt)/2;wr=Cr*vt,Sr=Or*Cr*Pt}var at,Ft;if(At==="w"?wr=Fr(Xe,0,wr):At==="e"?wr=Fr(Xe,1,-wr):At||(wr=0),Wt==="n"?Sr=Fr(Be,1,Sr):Wt==="s"?Sr=Fr(Be,0,-Sr):Wt||(Sr=0),at=At==="w"?wr:0,Ft=Wt==="n"?Sr:0,Zt.isSubplotConstrained&&!zt.isSubplotConstrained||zt.isSubplotConstrained&&At&&Wt&&Or>0){var jt;if(zt.isSubplotConstrained||!At&&Wt.length===1){for(jt=0;jt<Xe.length;jt++)Xe[jt].range=Xe[jt]._r.slice(),C(Xe[jt],1-Sr/Pt);wr=Sr*vt/Pt,at=wr/2}if(zt.isSubplotConstrained||!Wt&&At.length===1){for(jt=0;jt<Be.length;jt++)Be[jt].range=Be[jt]._r.slice(),C(Be[jt],1-wr/vt);Sr=wr*Pt/vt,Ft=Sr/2}}(!zt.isSubplotConstrained||!Wt)&&ut("x"),(!zt.isSubplotConstrained||!At)&&ut("y");var sr=vt-wr,zr=Pt-Sr;zt.isSubplotConstrained&&!(At&&Wt)&&(At?(Ft=at?0:wr*Pt/vt,zr=sr*Pt/vt):(at=Ft?0:Sr*vt/Pt,sr=zr*vt/Pt)),Dt([at,Ft,sr,zr]),ht(),le.emit("plotly_relayouting",Ge)}function ut(wr,Sr){for(var Zr=zt.isSubplotConstrained?{x:Be,y:Xe}[wr]:zt[wr+"axes"],ir=zt.isSubplotConstrained?{x:Xe,y:Be}[wr]:[],xr=0;xr<Zr.length;xr++){var Fr=Zr[xr],Or=Fr._id,Cr=zt.xLinks[Or]||zt.yLinks[Or],at=ir[0]||Ce[Cr]||He[Cr];at&&(Sr?(Sr[Fr._name+".range[0]"]=Sr[at._name+".range[0]"],Sr[Fr._name+".range[1]"]=Sr[at._name+".range[1]"]):Fr.range=at.range.slice())}}function ht(){var wr=[],Sr;function Zr(Fr){for(Sr=0;Sr<Fr.length;Sr++)Fr[Sr].fixedrange||wr.push(Fr[Sr]._id)}for(Ct&&(Zr(Xe),Zr(Zt.xaxes),Zr(zt.xaxes)),Ze&&(Zr(Be),Zr(Zt.yaxes),Zr(zt.yaxes)),Ge={},Sr=0;Sr<wr.length;Sr++){var ir=wr[Sr],xr=_(le,ir);s.drawOne(le,xr,{skipTitle:!0}),Ge[xr._name+".range[0]"]=xr.range[0],Ge[xr._name+".range[1]"]=xr.range[1]}s.redrawComponents(le,wr)}function Et(){if(!le._transitioningWithDuration){var wr=le._context.doubleClick,Sr=[];At&&(Sr=Sr.concat(Xe)),Wt&&(Sr=Sr.concat(Be)),zt.xaxes&&(Sr=Sr.concat(zt.xaxes)),zt.yaxes&&(Sr=Sr.concat(zt.yaxes));var Zr={},ir,xr,Fr;if(wr==="reset+autosize"){for(wr="autosize",xr=0;xr<Sr.length;xr++)if(ir=Sr[xr],ir._rangeInitial&&(ir.range[0]!==ir._rangeInitial[0]||ir.range[1]!==ir._rangeInitial[1])||!ir._rangeInitial&&!ir.autorange){wr="reset";break}}if(wr==="autosize")for(xr=0;xr<Sr.length;xr++)ir=Sr[xr],ir.fixedrange||(Zr[ir._name+".autorange"]=!0);else if(wr==="reset")for((At||Zt.isSubplotConstrained)&&(Sr=Sr.concat(Zt.xaxes)),Wt&&!Zt.isSubplotConstrained&&(Sr=Sr.concat(Zt.yaxes)),Zt.isSubplotConstrained&&(At?Wt||(Sr=Sr.concat(Be)):Sr=Sr.concat(Xe)),xr=0;xr<Sr.length;xr++)ir=Sr[xr],ir.fixedrange||(ir._rangeInitial?(Fr=ir._rangeInitial,Zr[ir._name+".range[0]"]=Fr[0],Zr[ir._name+".range[1]"]=Fr[1]):Zr[ir._name+".autorange"]=!0);le.emit("plotly_doubleclick",null),i.call("_guiRelayout",le,Zr)}}function yt(){Dt([0,0,vt,Pt]),u.syncOrAsync([M.previousPromises,function(){le._fullLayout._replotting=!1,i.call("_guiRelayout",le,Ge)}],le)}function Dt(wr){var Sr=le._fullLayout,Zr=Sr._plots,ir=Sr._subplots.cartesian,xr,Fr,Or,Cr;if(Ye&&i.subplotsRegistry.splom.drag(le),nt){for(xr=0;xr<ir.length;xr++)if(Fr=Zr[ir[xr]],Or=Fr.xaxis,Cr=Fr.yaxis,Fr._scene){var at=u.simpleMap(Or.range,Or.r2l),Ft=u.simpleMap(Cr.range,Cr.r2l);Fr._scene.update({range:[at[0],Ft[0],at[1],Ft[1]]})}}if((Ye||nt)&&(b(le),c(le)),Ee){var jt=wr[2]/Ie._length,sr=wr[3]/Te._length;for(xr=0;xr<ir.length;xr++){Fr=Zr[ir[xr]],Or=Fr.xaxis,Cr=Fr.yaxis;var zr=(Ct||zt.isSubplotConstrained)&&!Or.fixedrange&&Ce[Or._id],Ur=(Ze||zt.isSubplotConstrained)&&!Cr.fixedrange&&He[Cr._id],Dr,Tr,Wr,An;if(zr?(Dr=jt,Wr=me||zt.isSubplotConstrained?wr[0]:kr(Or,Dr)):zt.xaHash[Or._id]?(Dr=jt,Wr=wr[0]*Or._length/Ie._length):zt.yaHash[Or._id]?(Dr=sr,Wr=Wt==="ns"?-wr[1]*Or._length/Te._length:kr(Or,Dr,{n:"top",s:"bottom"}[Wt])):(Dr=Xt(Or,jt,sr),Wr=ar(Or,Dr)),Ur?(Tr=sr,An=be||zt.isSubplotConstrained?wr[1]:kr(Cr,Tr)):zt.yaHash[Cr._id]?(Tr=sr,An=wr[1]*Cr._length/Te._length):zt.xaHash[Cr._id]?(Tr=jt,An=At==="ew"?-wr[0]*Cr._length/Ie._length:kr(Cr,Tr,{e:"right",w:"left"}[At])):(Tr=Xt(Cr,jt,sr),An=ar(Cr,Tr)),!(!Dr&&!Tr)){Dr||(Dr=1),Tr||(Tr=1);var vn=Or._offset-Wr/Dr,Un=Cr._offset-An/Tr;Fr.clipRect.call(f.setTranslate,Wr,An).call(f.setScale,Dr,Tr),Fr.plot.call(f.setTranslate,vn,Un).call(f.setScale,1/Dr,1/Tr),(Dr!==Fr.xScaleFactor||Tr!==Fr.yScaleFactor)&&(f.setPointGroupScale(Fr.zoomScalePts,Dr,Tr),f.setTextPointsScale(Fr.zoomScaleTxt,Dr,Tr)),f.hideOutsideRangePoints(Fr.clipOnAxisFalseTraces,Fr),Fr.xScaleFactor=Dr,Fr.yScaleFactor=Tr}}}}function Xt(wr,Sr,Zr){return wr.fixedrange?0:Ct&&Zt.xaHash[wr._id]?Sr:Ze&&(Zt.isSubplotConstrained?Zt.xaHash:Zt.yaHash)[wr._id]?Zr:0}function ar(wr,Sr){return Sr?(wr.range=wr._r.slice(),C(wr,Sr),kr(wr,Sr)):0}function kr(wr,Sr,Zr){return wr._length*(1-Sr)*l[Zr||wr.constraintoward||"middle"]}return Mt}function F(le,ie,se,xe){var oe=u.ensureSingle(le.draglayer,ie,se,function(he){he.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",le.id)});return oe.call(m,xe),oe.node()}function I(le,ie,se,xe,oe,he,be){var me=F(le,"rect",ie,se);return h.select(me).call(f.setRect,xe,oe,he,be),me}function O(le,ie){for(var se=0;se<le.length;se++)if(!le[se].fixedrange)return ie;return""}function N(le,ie){var se=le.range[ie],xe=Math.abs(se-le.range[1-ie]),oe;return le.type==="date"?se:le.type==="log"?(oe=Math.ceil(Math.max(0,-Math.log(xe)/Math.LN10))+3,A("."+oe+"g")(Math.pow(10,se))):(oe=Math.floor(Math.log(Math.abs(se))/Math.LN10)-Math.floor(Math.log(xe)/Math.LN10)+4,A("."+String(oe)+"g")(se))}function V(le,ie,se,xe,oe){for(var he=0;he<le.length;he++){var be=le[he];if(!be.fixedrange)if(be.rangebreaks){var me=be._id.charAt(0)==="y",_e=me?1-ie:ie,Se=me?1-se:se;xe[be._name+".range[0]"]=be.l2r(be.p2l(_e*be._length)),xe[be._name+".range[1]"]=be.l2r(be.p2l(Se*be._length))}else{var De=be._rl[0],Ie=be._rl[1]-De;xe[be._name+".range[0]"]=be.l2r(De+Ie*ie),xe[be._name+".range[1]"]=be.l2r(De+Ie*se)}}if(oe&&oe.length){var Te=(ie+(1-se))/2;V(oe,Te,1-Te,xe,[])}}function H(le,ie){for(var se=0;se<le.length;se++){var xe=le[se];if(!xe.fixedrange)if(xe.rangebreaks){var oe=0,he=xe._length,be=xe.p2l(oe+ie)-xe.p2l(oe),me=xe.p2l(he+ie)-xe.p2l(he),_e=(be+me)/2;xe.range=[xe.l2r(xe._rl[0]-_e),xe.l2r(xe._rl[1]-_e)]}else xe.range=[xe.l2r(xe._rl[0]-ie/xe._m),xe.l2r(xe._rl[1]-ie/xe._m)]}}function j(le){return 1-(le>=0?Math.min(le,.9):1/(1/Math.max(le,-.3)+3.222))}function Z(le,ie,se){return le?le==="nsew"?se?"":ie==="pan"?"move":"crosshair":le.toLowerCase()+"-resize":"pointer"}function X(le,ie,se,xe,oe){return le.append("path").attr("class","zoombox").style({fill:ie>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",n(se,xe)).attr("d",oe+"Z")}function re(le,ie,se){return le.append("path").attr("class","zoombox-corners").style({fill:r.background,stroke:r.defaultLine,"stroke-width":1,opacity:0}).attr("transform",n(ie,se)).attr("d","M0,0Z")}function ue(le,ie,se,xe,oe,he){le.attr("d",xe+"M"+se.l+","+se.t+"v"+se.h+"h"+se.w+"v-"+se.h+"h-"+se.w+"Z"),K(le,ie,oe,he)}function K(le,ie,se,xe){se||(le.transition().style("fill",xe>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ie.transition().style("opacity",1).duration(200))}function te(le){h.select(le).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function G(le){B&&le.data&&le._context.showTips&&(u.notifier(u._(le,"Double-click to zoom back out"),"long"),B=!1)}function Y(le,ie){return"M"+(le.l-.5)+","+(ie-k-.5)+"h-3v"+(2*k+1)+"h3ZM"+(le.r+.5)+","+(ie-k-.5)+"h3v"+(2*k+1)+"h-3Z"}function ee(le,ie){return"M"+(ie-k-.5)+","+(le.t-.5)+"v-3h"+(2*k+1)+"v3ZM"+(ie-k-.5)+","+(le.b+.5)+"v3h"+(2*k+1)+"v-3Z"}function ne(le){var ie=Math.floor(Math.min(le.b-le.t,le.r-le.l,k)/2);return"M"+(le.l-3.5)+","+(le.t-.5+ie)+"h3v"+-ie+"h"+ie+"v-3h-"+(ie+3)+"ZM"+(le.r+3.5)+","+(le.t-.5+ie)+"h-3v"+-ie+"h"+-ie+"v-3h"+(ie+3)+"ZM"+(le.r+3.5)+","+(le.b+.5-ie)+"h-3v"+ie+"h"+-ie+"v3h"+(ie+3)+"ZM"+(le.l-3.5)+","+(le.b+.5-ie)+"h3v"+ie+"h"+ie+"v3h-"+(ie+3)+"Z"}function J(le,ie,se,xe,oe){for(var he=!1,be={},me={},_e,Se,De,Ie,Te=(oe||{}).xaHash,Ce=(oe||{}).yaHash,He=0;He<ie.length;He++){var Xe=ie[He];for(_e in se)if(Xe[_e]){for(De in Xe)!(oe&&(Te[De]||Ce[De]))&&!(De.charAt(0)==="x"?se:xe)[De]&&(be[De]=_e);for(Se in xe)!(oe&&(Te[Se]||Ce[Se]))&&Xe[Se]&&(he=!0)}for(Se in xe)if(Xe[Se])for(Ie in Xe)!(oe&&(Te[Ie]||Ce[Ie]))&&!(Ie.charAt(0)==="x"?se:xe)[Ie]&&(me[Ie]=Se)}he&&(u.extendFlat(be,me),me={});var Be={},Re=[];for(De in be){var We=_(le,De);Re.push(We),Be[We._id]=We}var vt={},Pt=[];for(Ie in me){var Zt=_(le,Ie);Pt.push(Zt),vt[Zt._id]=Zt}return{xaHash:Be,yaHash:vt,xaxes:Re,yaxes:Pt,xLinks:be,yLinks:me,isSubplotConstrained:he}}function q(le,ie){if(!e)le.onwheel!==void 0?le.onwheel=ie:le.onmousewheel!==void 0?le.onmousewheel=ie:le.isAddedWheelEvent||(le.isAddedWheelEvent=!0,le.addEventListener("wheel",ie,{passive:!1}));else{var se=le.onwheel!==void 0?"wheel":"mousewheel";le._onwheel&&le.removeEventListener(se,le._onwheel),le._onwheel=ie,le.addEventListener(se,ie,{passive:!1})}}function ae(le){var ie=[];for(var se in le)ie.push(le[se]);return ie}P.exports={makeDragBox:z,makeDragger:F,makeRectDragger:I,makeZoombox:X,makeCorners:re,updateZoombox:ue,xyCorners:ne,transitionZoombox:K,removeZoombox:te,showDoubleClickNotifier:G,attachWheelEventHandler:q}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/subroutines":556,"../../registry":647,"../plots":628,"./axes":566,"./axis_ids":570,"./constants":573,"./scale_zoom":584,"@plotly/d3":58,"has-passive-events":229,tinycolor2:313}],576:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/fx"),A=t("../../components/dragelement"),T=t("../../lib/setcursor"),e=t("./dragbox").makeDragBox,i=t("./constants").DRAGGERSIZE;R.initInteractions=function(a){var r=a._fullLayout;if(a._context.staticPlot){h.select(a).selectAll(".drag").remove();return}if(!(!r._has("cartesian")&&!r._has("splom"))){var f=Object.keys(r._plots||{}).sort(function(s,m){if((r._plots[s].mainplot&&!0)===(r._plots[m].mainplot&&!0)){var g=s.split("y"),p=m.split("y");return g[0]===p[0]?Number(g[1]||1)-Number(p[1]||1):Number(g[0]||1)-Number(p[0]||1)}return r._plots[s].mainplot?1:-1});f.forEach(function(s){var m=r._plots[s],g=m.xaxis,p=m.yaxis;if(!m.mainplot){var v=e(a,m,g._offset,p._offset,g._length,p._length,"ns","ew");v.onmousemove=function(b){a._fullLayout._rehover=function(){a._fullLayout._hoversubplot===s&&a._fullLayout._plots[s]&&u.hover(a,b,s)},u.hover(a,b,s),a._fullLayout._lasthover=v,a._fullLayout._hoversubplot=s},v.onmouseout=function(b){a._dragging||(a._fullLayout._hoversubplot=null,A.unhover(a,b))},a._context.showAxisDragHandles&&(e(a,m,g._offset-i,p._offset-i,i,i,"n","w"),e(a,m,g._offset+g._length,p._offset-i,i,i,"n","e"),e(a,m,g._offset-i,p._offset+p._length,i,i,"s","w"),e(a,m,g._offset+g._length,p._offset+p._length,i,i,"s","e"))}if(a._context.showAxisDragHandles){if(s===g._mainSubplot){var x=g._mainLinePosition;g.side==="top"&&(x-=i),e(a,m,g._offset+g._length*.1,x,g._length*.8,i,"","ew"),e(a,m,g._offset,x,g._length*.1,i,"","w"),e(a,m,g._offset+g._length*.9,x,g._length*.1,i,"","e")}if(s===p._mainSubplot){var l=p._mainLinePosition;p.side!=="right"&&(l-=i),e(a,m,l,p._offset+p._length*.1,i,p._length*.8,"ns",""),e(a,m,l,p._offset+p._length*.9,i,p._length*.1,"s",""),e(a,m,l,p._offset,i,p._length*.1,"n","")}}});var o=r._hoverlayer.node();o.onmousemove=function(s){s.target=a._fullLayout._lasthover,u.hover(a,s,r._hoversubplot)},o.onclick=function(s){s.target=a._fullLayout._lasthover,u.click(a,s)},o.onmousedown=function(s){a._fullLayout._lasthover.onmousedown(s)},R.updateFx(a)}},R.updateFx=function(n){var a=n._fullLayout,r=a.dragmode==="pan"?"move":"crosshair";T(a._draggers,r)}},{"../../components/dragelement":386,"../../components/fx":407,"../../lib/setcursor":536,"./constants":573,"./dragbox":575,"@plotly/d3":58}],577:[function(t,P,R){var h=t("../../registry"),u=t("../../lib"),A=t("./axis_ids");P.exports=function(e){return function(n,a){var r=n[e];if(!!Array.isArray(r))for(var f=h.subplotsRegistry.cartesian,o=f.idRegex,s=a._subplots,m=s.xaxis,g=s.yaxis,p=s.cartesian,v=a._has("cartesian")||a._has("gl2d"),x=0;x<r.length;x++){var l=r[x];if(!!u.isPlainObject(l)){var b=A.cleanId(l.xref,"x",!1),c=A.cleanId(l.yref,"y",!1),M=o.x.test(b),_=o.y.test(c);if(M||_){v||u.pushUnique(a._basePlotModules,f);var y=!1;M&&m.indexOf(b)===-1&&(m.push(b),y=!0),_&&g.indexOf(c)===-1&&(g.push(c),y=!0),y&&M&&_&&p.push(b+c)}}}}}},{"../../lib":515,"../../registry":647,"./axis_ids":570}],578:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../registry"),A=t("../../lib"),T=t("../plots"),e=t("../../components/drawing"),i=t("../get_data").getModuleCalcData,n=t("./axis_ids"),a=t("./constants"),r=t("../../constants/xmlns_namespaces"),f=A.ensureSingle;function o(x,l,b){return A.ensureSingle(x,l,b,function(c){c.datum(b)})}R.name="cartesian",R.attr=["xaxis","yaxis"],R.idRoot=["x","y"],R.idRegex=a.idRegex,R.attrRegex=a.attrRegex,R.attributes=t("./attributes"),R.layoutAttributes=t("./layout_attributes"),R.supplyLayoutDefaults=t("./layout_defaults"),R.transitionAxes=t("./transition_axes"),R.finalizeSubplots=function(x,l){var b=l._subplots,c=b.xaxis,M=b.yaxis,_=b.cartesian,y=_.concat(b.gl2d||[]),w={},d={},C,S,E;for(C=0;C<y.length;C++){var k=y[C].split("y");w[k[0]]=1,d["y"+k[1]]=1}for(C=0;C<c.length;C++)S=c[C],w[S]||(E=(x[n.id2name(S)]||{}).anchor,a.idRegex.y.test(E)||(E="y"),_.push(S+E),y.push(S+E),d[E]||(d[E]=1,A.pushUnique(M,E)));for(C=0;C<M.length;C++)E=M[C],d[E]||(S=(x[n.id2name(E)]||{}).anchor,a.idRegex.x.test(S)||(S="x"),_.push(S+E),y.push(S+E),w[S]||(w[S]=1,A.pushUnique(c,S)));if(!y.length){S="",E="";for(var B in x)if(a.attrRegex.test(B)){var z=B.charAt(0);z==="x"?(!S||+B.substr(5)<+S.substr(5))&&(S=B):(!E||+B.substr(5)<+E.substr(5))&&(E=B)}S=S?n.name2id(S):"x",E=E?n.name2id(E):"y",c.push(S),M.push(E),_.push(S+E)}},R.plot=function(x,l,b,c){var M=x._fullLayout,_=M._subplots.cartesian,y=x.calcdata,w;if(!Array.isArray(l))for(l=[],w=0;w<y.length;w++)l.push(w);for(w=0;w<_.length;w++){for(var d=_[w],C=M._plots[d],S=[],E,k=0;k<y.length;k++){var B=y[k],z=B[0].trace;z.xaxis+z.yaxis===d&&((l.indexOf(z.index)!==-1||z.carpet)&&(E&&E[0].trace.xaxis+E[0].trace.yaxis===d&&["tonextx","tonexty","tonext"].indexOf(z.fill)!==-1&&S.indexOf(E)===-1&&S.push(E),S.push(B)),E=B)}s(x,C,S,b,c)}};function s(x,l,b,c,M){for(var _=a.traceLayerClasses,y=x._fullLayout,w=y._modules,d,C,S,E=[],k=[],B=0;B<w.length;B++){d=w[B];var z=d.name,F=u.modules[z].categories;if(F.svg){var I=d.layerName||z+"layer",O=d.plot;C=i(b,O),S=C[0],b=C[1],S.length&&E.push({i:_.indexOf(I),className:I,plotMethod:O,cdModule:S}),F.zoomScale&&k.push("."+I)}}E.sort(function(H,j){return H.i-j.i});var N=l.plot.selectAll("g.mlayer").data(E,function(H){return H.className});if(N.enter().append("g").attr("class",function(H){return H.className}).classed("mlayer",!0).classed("rangeplot",l.isRangePlot),N.exit().remove(),N.order(),N.each(function(H){var j=h.select(this),Z=H.className;H.plotMethod(x,l,H.cdModule,j,c,M),a.clipOnAxisFalseQuery.indexOf("."+Z)===-1&&e.setClipUrl(j,l.layerClipId,x)}),y._has("scattergl")&&(d=u.getModule("scattergl"),S=i(b,d)[0],d.plot(x,l,S)),!x._context.staticPlot&&(l._hasClipOnAxisFalse&&(l.clipOnAxisFalseTraces=l.plot.selectAll(a.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),k.length)){var V=l.plot.selectAll(k.join(",")).selectAll(".trace");l.zoomScalePts=V.selectAll("path.point"),l.zoomScaleTxt=V.selectAll(".textpoint")}}R.clean=function(x,l,b,c){var M=c._plots||{},_=l._plots||{},y=c._subplots||{},w,d,C;if(c._hasOnlyLargeSploms&&!l._hasOnlyLargeSploms)for(C in M)w=M[C],w.plotgroup&&w.plotgroup.remove();var S=c._has&&c._has("gl"),E=l._has&&l._has("gl");if(S&&!E)for(C in M)w=M[C],w._scene&&w._scene.destroy();if(y.xaxis&&y.yaxis){var k=n.listIds({_fullLayout:c});for(d=0;d<k.length;d++){var B=k[d];l[n.id2name(B)]||c._infolayer.selectAll(".g-"+B+"title").remove()}}var z=c._has&&c._has("cartesian"),F=l._has&&l._has("cartesian");if(z&&!F)p(c._cartesianlayer.selectAll(".subplot"),c),c._defs.selectAll(".axesclip").remove(),delete c._axisConstraintGroups,delete c._axisMatchGroups;else if(y.cartesian)for(d=0;d<y.cartesian.length;d++){var I=y.cartesian[d];if(!_[I]){var O="."+I+",."+I+"-x,."+I+"-y";c._cartesianlayer.selectAll(O).remove(),v(I,c)}}},R.drawFramework=function(x){var l=x._fullLayout,b=m(x),c=l._cartesianlayer.selectAll(".subplot").data(b,String);c.enter().append("g").attr("class",function(M){return"subplot "+M[0]}),c.order(),c.exit().call(p,l),c.each(function(M){var _=M[0],y=l._plots[_];y.plotgroup=h.select(this),g(x,y),y.draglayer=f(l._draggers,"g",_)})},R.rangePlot=function(x,l,b){g(x,l),s(x,l,b),T.style(x)};function m(x){var l=x._fullLayout,b=l._subplots.cartesian,c=b.length,M,_,y,w,d,C,S=[],E=[];for(M=0;M<c;M++){y=b[M],w=l._plots[y],d=w.xaxis,C=w.yaxis;var k=d._mainAxis,B=C._mainAxis,z=k._id+B._id,F=l._plots[z];w.overlays=[],z!==y&&F?(w.mainplot=z,w.mainplotinfo=F,E.push(y)):(w.mainplot=void 0,w.mainplotinfo=void 0,S.push(y))}for(M=0;M<E.length;M++)y=E[M],w=l._plots[y],w.mainplotinfo.overlays.push(w);var I=S.concat(E),O=new Array(c);for(M=0;M<c;M++){y=I[M],w=l._plots[y],d=w.xaxis,C=w.yaxis;var N=[y,d.layer,C.layer,d.overlaying||"",C.overlaying||""];for(_=0;_<w.overlays.length;_++)N.push(w.overlays[_].id);O[M]=N}return O}function g(x,l){var b=l.plotgroup,c=l.id,M=a.layerValue2layerClass[l.xaxis.layer],_=a.layerValue2layerClass[l.yaxis.layer],y=x._fullLayout._hasOnlyLargeSploms;if(l.mainplot){var d=l.mainplotinfo,C=d.plotgroup,S=c+"-x",E=c+"-y";l.minorGridlayer=d.minorGridlayer,l.gridlayer=d.gridlayer,l.zerolinelayer=d.zerolinelayer,f(d.overlinesBelow,"path",S),f(d.overlinesBelow,"path",E),f(d.overaxesBelow,"g",S),f(d.overaxesBelow,"g",E),l.plot=f(d.overplot,"g",c),f(d.overlinesAbove,"path",S),f(d.overlinesAbove,"path",E),f(d.overaxesAbove,"g",S),f(d.overaxesAbove,"g",E),l.xlines=C.select(".overlines-"+M).select("."+S),l.ylines=C.select(".overlines-"+_).select("."+E),l.xaxislayer=C.select(".overaxes-"+M).select("."+S),l.yaxislayer=C.select(".overaxes-"+_).select("."+E)}else if(y)l.xlines=f(b,"path","xlines-above"),l.ylines=f(b,"path","ylines-above"),l.xaxislayer=f(b,"g","xaxislayer-above"),l.yaxislayer=f(b,"g","yaxislayer-above");else{var w=f(b,"g","layer-subplot");l.shapelayer=f(w,"g","shapelayer"),l.imagelayer=f(w,"g","imagelayer"),l.minorGridlayer=f(b,"g","minor-gridlayer"),l.gridlayer=f(b,"g","gridlayer"),l.zerolinelayer=f(b,"g","zerolinelayer"),f(b,"path","xlines-below"),f(b,"path","ylines-below"),l.overlinesBelow=f(b,"g","overlines-below"),f(b,"g","xaxislayer-below"),f(b,"g","yaxislayer-below"),l.overaxesBelow=f(b,"g","overaxes-below"),l.plot=f(b,"g","plot"),l.overplot=f(b,"g","overplot"),l.xlines=f(b,"path","xlines-above"),l.ylines=f(b,"path","ylines-above"),l.overlinesAbove=f(b,"g","overlines-above"),f(b,"g","xaxislayer-above"),f(b,"g","yaxislayer-above"),l.overaxesAbove=f(b,"g","overaxes-above"),l.xlines=b.select(".xlines-"+M),l.ylines=b.select(".ylines-"+_),l.xaxislayer=b.select(".xaxislayer-"+M),l.yaxislayer=b.select(".yaxislayer-"+_)}y||(o(l.minorGridlayer,"g",l.xaxis._id),o(l.minorGridlayer,"g",l.yaxis._id),l.minorGridlayer.selectAll("g").map(function(k){return k[0]}).sort(n.idSort),o(l.gridlayer,"g",l.xaxis._id),o(l.gridlayer,"g",l.yaxis._id),l.gridlayer.selectAll("g").map(function(k){return k[0]}).sort(n.idSort)),l.xlines.style("fill","none").classed("crisp",!0),l.ylines.style("fill","none").classed("crisp",!0)}function p(x,l){if(!!x){var b={};x.each(function(d){var C=d[0],S=h.select(this);S.remove(),v(C,l),b[C]=!0});for(var c in l._plots)for(var M=l._plots[c],_=M.overlays||[],y=0;y<_.length;y++){var w=_[y];b[w.id]&&w.plot.selectAll(".trace").remove()}}}function v(x,l){l._draggers.selectAll("g."+x).remove(),l._defs.select("#clip"+l._uid+x+"plot").remove()}R.toSVG=function(x){var l=x._fullLayout._glimages,b=h.select(x).selectAll(".svg-container"),c=b.filter(function(_,y){return y===b.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function M(){var _=this,y=_.toDataURL("image/png"),w=l.append("svg:image");w.attr({xmlns:r.svg,"xlink:href":y,preserveAspectRatio:"none",x:0,y:0,width:_.style.width,height:_.style.height})}c.each(M)},R.updateFx=t("./graph_interact").updateFx},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../registry":647,"../get_data":602,"../plots":628,"./attributes":564,"./axis_ids":570,"./constants":573,"./graph_interact":576,"./layout_attributes":579,"./layout_defaults":580,"./transition_axes":590,"@plotly/d3":58}],579:[function(t,P,R){var h=t("../font_attributes"),u=t("../../components/color/attributes"),A=t("../../components/drawing/attributes").dash,T=t("../../lib/extend").extendFlat,e=t("../../plot_api/plot_template").templatedArray,i=t("../../plots/cartesian/axis_format_attributes").descriptionWithDates,n=t("../../constants/numerical").ONEDAY,a=t("./constants"),r=a.HOUR_PATTERN,f=a.WEEKDAY_PATTERN,o={valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}};function s(w){return{valType:"integer",min:0,dflt:w?5:0,editType:"ticks"}}var m={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},g={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},p={valType:"data_array",editType:"ticks"},v={valType:"enumerated",values:["outside","inside",""],editType:"ticks"};function x(w){var d={valType:"number",min:0,editType:"ticks"};return w||(d.dflt=5),d}function l(w){var d={valType:"number",min:0,editType:"ticks"};return w||(d.dflt=1),d}var b={valType:"color",dflt:u.defaultLine,editType:"ticks"},c={valType:"color",dflt:u.lightLine,editType:"ticks"};function M(w){var d={valType:"number",min:0,editType:"ticks"};return w||(d.dflt=1),d}var _=T({},A,{editType:"ticks"}),y={valType:"boolean",editType:"ticks"};P.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:u.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:h({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[f,r,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:n},editType:"calc"}),tickmode:o,nticks:s(),tick0:m,dtick:g,ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:p,ticktext:{valType:"data_array",editType:"ticks"},ticks:v,tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:x(),tickwidth:l(),tickcolor:b,showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"flaglist",flags:["height","width","left","right","top","bottom"],extras:[!0,!1],dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:T({},A,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:h({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:i("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:i("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:u.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:y,gridcolor:c,gridwidth:M(),griddash:_,zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:u.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:u.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},minor:{tickmode:o,nticks:s("minor"),tick0:m,dtick:g,tickvals:p,ticks:v,ticklen:x("minor"),tickwidth:l("minor"),tickcolor:b,gridcolor:c,gridwidth:M("minor"),griddash:_,showgrid:y,editType:"ticks"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:h({editType:"ticks"})}}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../constants/numerical":491,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../font_attributes":594,"./constants":573}],580:[function(t,P,R){var h=t("../../lib"),u=t("../../components/color"),A=t("../../components/fx/helpers").isUnifiedHover,T=t("../../components/fx/hovermode_defaults"),e=t("../../plot_api/plot_template"),i=t("../layout_attributes"),n=t("./layout_attributes"),a=t("./type_defaults"),r=t("./axis_defaults"),f=t("./constraints"),o=t("./position_defaults"),s=t("./axis_ids"),m=s.id2name,g=s.name2id,p=t("./constants").AX_ID_PATTERN,v=t("../../registry"),x=v.traceIs,l=v.getComponentMethod;function b(c,M,_){Array.isArray(c[M])?c[M].push(_):c[M]=[_]}P.exports=function(M,_,y){var w=_.autotypenumbers,d={},C={},S={},E={},k={},B={},z={},F={},I={},O={},N,V;for(N=0;N<y.length;N++){var H=y[N];if(!(!x(H,"cartesian")&&!x(H,"gl2d"))){var j;if(H.xaxis)j=m(H.xaxis),b(d,j,H);else if(H.xaxes)for(V=0;V<H.xaxes.length;V++)b(d,m(H.xaxes[V]),H);var Z;if(H.yaxis)Z=m(H.yaxis),b(d,Z,H);else if(H.yaxes)for(V=0;V<H.yaxes.length;V++)b(d,m(H.yaxes[V]),H);if(H.type==="funnel"?H.orientation==="h"?(j&&(C[j]=!0),Z&&(z[Z]=!0)):Z&&(S[Z]=!0):H.type==="image"?(Z&&(F[Z]=!0),j&&(F[j]=!0)):(Z&&(k[Z]=!0,B[Z]=!0),(!x(H,"carpet")||H.type==="carpet"&&!H._cheater)&&j&&(E[j]=!0)),H.type==="carpet"&&H._cheater&&j&&(C[j]=!0),x(H,"2dMap")&&(I[j]=!0,I[Z]=!0),x(H,"oriented")){var X=H.orientation==="h"?Z:j;O[X]=!0}}}var re=_._subplots,ue=re.xaxis,K=re.yaxis,te=h.simpleMap(ue,m),G=h.simpleMap(K,m),Y=te.concat(G),ee=u.background;ue.length&&K.length&&(ee=h.coerce(M,_,i,"plot_bgcolor"));var ne=u.combine(ee,_.paper_bgcolor),J,q,ae,le,ie;function se(){var Ye=d[J]||[];ie._traceIndices=Ye.map(function(Ee){return Ee._expandedIndex}),ie._annIndices=[],ie._shapeIndices=[],ie._selectionIndices=[],ie._imgIndices=[],ie._subplotsWith=[],ie._counterAxes=[],ie._name=ie._attr=J,ie._id=q}function xe(Ye,Ee){return h.coerce(le,ie,n,Ye,Ee)}function oe(Ye,Ee){return h.coerce2(le,ie,n,Ye,Ee)}function he(Ye){return Ye==="x"?K:ue}function be(Ye,Ee){for(var Ge=Ye==="x"?te:G,Je=[],qe=0;qe<Ge.length;qe++){var Tt=Ge[qe];Tt!==Ee&&!(M[Tt]||{}).overlaying&&Je.push(g(Tt))}return Je}var me={x:he("x"),y:he("y")},_e=me.x.concat(me.y),Se={},De=[];function Ie(){var Ye=le.matches;p.test(Ye)&&_e.indexOf(Ye)===-1&&(Se[Ye]=le.type,De=Object.keys(Se))}var Te=T(M,_),Ce=A(Te);for(N=0;N<Y.length;N++){J=Y[N],q=g(J),ae=J.charAt(0),h.isPlainObject(M[J])||(M[J]={}),le=M[J],ie=e.newContainer(_,J,ae+"axis"),se();var He=ae==="x"&&!E[J]&&C[J]||ae==="y"&&!k[J]&&S[J],Xe=ae==="y"&&(!B[J]&&z[J]||F[J]),Be={hasMinor:!0,letter:ae,font:_.font,outerTicks:I[J],showGrid:!O[J],data:d[J]||[],bgColor:ne,calendar:_.calendar,automargin:!0,visibleDflt:He,reverseDflt:Xe,autotypenumbersDflt:w,splomStash:((_._splomAxes||{})[ae]||{})[q]};xe("uirevision",_.uirevision),a(le,ie,xe,Be),r(le,ie,xe,Be,_);var Re=Ce&&ae===Te.charAt(0),We=oe("spikecolor",Ce?ie.color:void 0),vt=oe("spikethickness",Ce?1.5:void 0),Pt=oe("spikedash",Ce?"dot":void 0),Zt=oe("spikemode",Ce?"across":void 0),zt=oe("spikesnap"),At=xe("showspikes",!!Re||!!We||!!vt||!!Pt||!!Zt||!!zt);At||(delete ie.spikecolor,delete ie.spikethickness,delete ie.spikedash,delete ie.spikemode,delete ie.spikesnap),o(le,ie,xe,{letter:ae,counterAxes:me[ae],overlayableAxes:be(ae,J),grid:_.grid}),xe("title.standoff"),Ie(),ie._input=le}for(N=0;N<De.length;){q=De[N++],J=m(q),ae=J.charAt(0),h.isPlainObject(M[J])||(M[J]={}),le=M[J],ie=e.newContainer(_,J,ae+"axis"),se();var Wt={letter:ae,font:_.font,outerTicks:I[J],showGrid:!O[J],data:[],bgColor:ne,calendar:_.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:w,splomStash:((_._splomAxes||{})[ae]||{})[q]};xe("uirevision",_.uirevision),ie.type=Se[q]||"linear",r(le,ie,xe,Wt,_),o(le,ie,xe,{letter:ae,counterAxes:me[ae],overlayableAxes:be(ae,J),grid:_.grid}),xe("fixedrange"),Ie(),ie._input=le}var Bt=l("rangeslider","handleDefaults"),Ct=l("rangeselector","handleDefaults");for(N=0;N<te.length;N++)J=te[N],le=M[J],ie=_[J],Bt(M,_,J),ie.type==="date"&&Ct(le,ie,_,G,ie.calendar),xe("fixedrange");for(N=0;N<G.length;N++){J=G[N],le=M[J],ie=_[J];var Ze=_[m(ie.anchor)],nt=l("rangeslider","isVisible")(Ze);xe("fixedrange",nt)}f.handleDefaults(M,_,{axIds:_e.concat(De).sort(s.idSort),axHasImage:F})}},{"../../components/color":367,"../../components/fx/helpers":403,"../../components/fx/hovermode_defaults":406,"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../layout_attributes":619,"./axis_defaults":568,"./axis_ids":570,"./constants":573,"./constraints":574,"./layout_attributes":579,"./position_defaults":582,"./type_defaults":591}],581:[function(t,P,R){var h=t("tinycolor2").mix,u=t("../../components/color/attributes"),A=t("../../lib");P.exports=function(e,i,n,a){a=a||{};var r=a.dfltColor;function f(S,E){return A.coerce2(e,i,a.attributes,S,E)}var o=f("linecolor",r),s=f("linewidth"),m=n("showline",a.showLine||!!o||!!s);m||(delete i.linecolor,delete i.linewidth);var g=h(r,a.bgColor,a.blend||u.lightFraction).toRgbString(),p=f("gridcolor",g),v=f("gridwidth"),x=f("griddash"),l=n("showgrid",a.showGrid||!!p||!!v||!!x);if(l||(delete i.gridcolor,delete i.gridwidth,delete i.griddash),a.hasMinor){var b=h(i.gridcolor,a.bgColor,67).toRgbString(),c=f("minor.gridcolor",b),M=f("minor.gridwidth",i.gridwidth||1),_=f("minor.griddash",i.griddash||"solid"),y=n("minor.showgrid",!!c||!!M||!!_);y||(delete i.minor.gridcolor,delete i.minor.gridwidth,delete i.minor.griddash)}if(!a.noZeroLine){var w=f("zerolinecolor",r),d=f("zerolinewidth"),C=n("zeroline",a.showGrid||!!w||!!d);C||(delete i.zerolinecolor,delete i.zerolinewidth)}}},{"../../components/color/attributes":366,"../../lib":515,tinycolor2:313}],582:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib");P.exports=function(T,e,i,n){var a=n.counterAxes||[],r=n.overlayableAxes||[],f=n.letter,o=n.grid,s,m,g,p;o&&(m=o._domains[f][o._axisMap[e._id]],s=o._anchors[e._id],m&&(g=o[f+"side"].split(" ")[0],p=o.domain[f][g==="right"||g==="top"?1:0])),m=m||[0,1],s=s||(h(T.position)?"free":a[0]||"free"),g=g||(f==="x"?"bottom":"left"),p=p||0;var v=u.coerce(T,e,{anchor:{valType:"enumerated",values:["free"].concat(a),dflt:s}},"anchor");v==="free"&&i("position",p),u.coerce(T,e,{side:{valType:"enumerated",values:f==="x"?["bottom","top"]:["left","right"],dflt:g}},"side");var x=!1;if(r.length&&(x=u.coerce(T,e,{overlaying:{valType:"enumerated",values:[!1].concat(r),dflt:!1}},"overlaying")),!x){var l=i("domain",m);l[0]>l[1]-1/4096&&(e.domain=m),u.noneOrAll(T.domain,e.domain,m)}return i("layer"),e}},{"../../lib":515,"fast-isnumeric":190}],583:[function(t,P,R){var h=t("./show_dflt");P.exports=function(A,T,e,i,n){n||(n={});var a=n.tickSuffixDflt,r=h(A),f=e("tickprefix");f&&e("showtickprefix",r);var o=e("ticksuffix",a);o&&e("showticksuffix",r)}},{"./show_dflt":586}],584:[function(t,P,R){var h=t("../../constants/alignment").FROM_BL;P.exports=function(A,T,e){e===void 0&&(e=h[A.constraintoward||"center"]);var i=[A.r2l(A.range[0]),A.r2l(A.range[1])],n=i[0]+(i[1]-i[0])*e;A.range=A._input.range=[A.l2r(n+(i[0]-n)*T),A.l2r(n+(i[1]-n)*T)],A.setScale()}},{"../../constants/alignment":483}],585:[function(t,P,R){var h=t("@plotly/d3"),u=t("d3-time-format").utcFormat,A=t("../../lib"),T=A.numberFormat,e=t("fast-isnumeric"),i=A.cleanNumber,n=A.ms2DateTime,a=A.dateTime2ms,r=A.ensureNumber,f=A.isArrayOrTypedArray,o=t("../../constants/numerical"),s=o.FP_SAFE,m=o.BADNUM,g=o.LOG_CLIP,p=o.ONEWEEK,v=o.ONEDAY,x=o.ONEHOUR,l=o.ONEMIN,b=o.ONESEC,c=t("./axis_ids"),M=t("./constants"),_=M.HOUR_PATTERN,y=M.WEEKDAY_PATTERN;function w(C){return Math.pow(10,C)}function d(C){return C!=null}P.exports=function(S,E){E=E||{};var k=S._id||"x",B=k.charAt(0);function z(Y,ee){if(Y>0)return Math.log(Y)/Math.LN10;if(Y<=0&&ee&&S.range&&S.range.length===2){var ne=S.range[0],J=S.range[1];return .5*(ne+J-2*g*Math.abs(ne-J))}else return m}function F(Y,ee,ne,J){if((J||{}).msUTC&&e(Y))return+Y;var q=a(Y,ne||S.calendar);if(q===m)if(e(Y)){Y=+Y;var ae=Math.floor(A.mod(Y+.05,1)*10),le=Math.round(Y-ae/10);q=a(new Date(le))+ae/10}else return m;return q}function I(Y,ee,ne){return n(Y,ee,ne||S.calendar)}function O(Y){return S._categories[Math.round(Y)]}function N(Y){if(d(Y)){if(S._categoriesMap===void 0&&(S._categoriesMap={}),S._categoriesMap[Y]!==void 0)return S._categoriesMap[Y];S._categories.push(typeof Y=="number"?String(Y):Y);var ee=S._categories.length-1;return S._categoriesMap[Y]=ee,ee}return m}function V(Y,ee){for(var ne=new Array(ee),J=0;J<ee;J++){var q=(Y[0]||[])[J],ae=(Y[1]||[])[J];ne[J]=H([q,ae])}return ne}function H(Y){if(S._categoriesMap)return S._categoriesMap[Y]}function j(Y){var ee=H(Y);if(ee!==void 0)return ee;if(e(Y))return+Y}function Z(Y){return e(Y)?+Y:H(Y)}function X(Y,ee,ne){return h.round(ne+ee*Y,2)}function re(Y,ee,ne){return(Y-ne)/ee}var ue=function(ee){return e(ee)?X(ee,S._m,S._b):m},K=function(Y){return re(Y,S._m,S._b)};if(S.rangebreaks){var te=B==="y";ue=function(Y){if(!e(Y))return m;var ee=S._rangebreaks.length;if(!ee)return X(Y,S._m,S._b);var ne=te;S.range[0]>S.range[1]&&(ne=!ne);for(var J=ne?-1:1,q=J*Y,ae=0,le=0;le<ee;le++){var ie=J*S._rangebreaks[le].min,se=J*S._rangebreaks[le].max;if(q<ie)break;if(q>se)ae=le+1;else{ae=q<(ie+se)/2?le:le+1;break}}var xe=S._B[ae]||0;return isFinite(xe)?X(Y,S._m2,xe):0},K=function(Y){var ee=S._rangebreaks.length;if(!ee)return re(Y,S._m,S._b);for(var ne=0,J=0;J<ee&&!(Y<S._rangebreaks[J].pmin);J++)Y>S._rangebreaks[J].pmax&&(ne=J+1);return re(Y,S._m2,S._B[ne])}}S.c2l=S.type==="log"?z:r,S.l2c=S.type==="log"?w:r,S.l2p=ue,S.p2l=K,S.c2p=S.type==="log"?function(Y,ee){return ue(z(Y,ee))}:ue,S.p2c=S.type==="log"?function(Y){return w(K(Y))}:K,["linear","-"].indexOf(S.type)!==-1?(S.d2r=S.r2d=S.d2c=S.r2c=S.d2l=S.r2l=i,S.c2d=S.c2r=S.l2d=S.l2r=r,S.d2p=S.r2p=function(Y){return S.l2p(i(Y))},S.p2d=S.p2r=K,S.cleanPos=r):S.type==="log"?(S.d2r=S.d2l=function(Y,ee){return z(i(Y),ee)},S.r2d=S.r2c=function(Y){return w(i(Y))},S.d2c=S.r2l=i,S.c2d=S.l2r=r,S.c2r=z,S.l2d=w,S.d2p=function(Y,ee){return S.l2p(S.d2r(Y,ee))},S.p2d=function(Y){return w(K(Y))},S.r2p=function(Y){return S.l2p(i(Y))},S.p2r=K,S.cleanPos=r):S.type==="date"?(S.d2r=S.r2d=A.identity,S.d2c=S.r2c=S.d2l=S.r2l=F,S.c2d=S.c2r=S.l2d=S.l2r=I,S.d2p=S.r2p=function(Y,ee,ne){return S.l2p(F(Y,0,ne))},S.p2d=S.p2r=function(Y,ee,ne){return I(K(Y),ee,ne)},S.cleanPos=function(Y){return A.cleanDate(Y,m,S.calendar)}):S.type==="category"?(S.d2c=S.d2l=N,S.r2d=S.c2d=S.l2d=O,S.d2r=S.d2l_noadd=j,S.r2c=function(Y){var ee=Z(Y);return ee!==void 0?ee:S.fraction2r(.5)},S.l2r=S.c2r=r,S.r2l=Z,S.d2p=function(Y){return S.l2p(S.r2c(Y))},S.p2d=function(Y){return O(K(Y))},S.r2p=S.d2p,S.p2r=K,S.cleanPos=function(Y){return typeof Y=="string"&&Y!==""?Y:r(Y)}):S.type==="multicategory"&&(S.r2d=S.c2d=S.l2d=O,S.d2r=S.d2l_noadd=j,S.r2c=function(Y){var ee=j(Y);return ee!==void 0?ee:S.fraction2r(.5)},S.r2c_just_indices=H,S.l2r=S.c2r=r,S.r2l=j,S.d2p=function(Y){return S.l2p(S.r2c(Y))},S.p2d=function(Y){return O(K(Y))},S.r2p=S.d2p,S.p2r=K,S.cleanPos=function(Y){return Array.isArray(Y)||typeof Y=="string"&&Y!==""?Y:r(Y)},S.setupMultiCategory=function(Y){var ee=S._traceIndices,ne,J,q=S._matchGroup;if(q&&S._categories.length===0){for(var ae in q)if(ae!==k){var le=E[c.id2name(ae)];ee=ee.concat(le._traceIndices)}}var ie=[[0,{}],[0,{}]],se=[];for(ne=0;ne<ee.length;ne++){var xe=Y[ee[ne]];if(B in xe){var oe=xe[B],he=xe._length||A.minRowLength(oe);if(f(oe[0])&&f(oe[1]))for(J=0;J<he;J++){var be=oe[0][J],me=oe[1][J];d(be)&&d(me)&&(se.push([be,me]),be in ie[0][1]||(ie[0][1][be]=ie[0][0]++),me in ie[1][1]||(ie[1][1][me]=ie[1][0]++))}}}for(se.sort(function(_e,Se){var De=ie[0][1],Ie=De[_e[0]]-De[Se[0]];if(Ie)return Ie;var Te=ie[1][1];return Te[_e[1]]-Te[Se[1]]}),ne=0;ne<se.length;ne++)N(se[ne])}),S.fraction2r=function(Y){var ee=S.r2l(S.range[0]),ne=S.r2l(S.range[1]);return S.l2r(ee+Y*(ne-ee))},S.r2fraction=function(Y){var ee=S.r2l(S.range[0]),ne=S.r2l(S.range[1]);return(S.r2l(Y)-ee)/(ne-ee)},S.cleanRange=function(Y,ee){ee||(ee={}),Y||(Y="range");var ne=A.nestedProperty(S,Y).get(),J,q;if(S.type==="date"?q=A.dfltRange(S.calendar):B==="y"?q=M.DFLTRANGEY:S._name==="realaxis"?q=[0,1]:q=ee.dfltRange||M.DFLTRANGEX,q=q.slice(),(S.rangemode==="tozero"||S.rangemode==="nonnegative")&&(q[0]=0),!ne||ne.length!==2){A.nestedProperty(S,Y).set(q);return}for(S.type==="date"&&!S.autorange&&(ne[0]=A.cleanDate(ne[0],m,S.calendar),ne[1]=A.cleanDate(ne[1],m,S.calendar)),J=0;J<2;J++)if(S.type==="date"){if(!A.isDateTime(ne[J],S.calendar)){S[Y]=q;break}if(S.r2l(ne[0])===S.r2l(ne[1])){var ae=A.constrain(S.r2l(ne[0]),A.MIN_MS+1e3,A.MAX_MS-1e3);ne[0]=S.l2r(ae-1e3),ne[1]=S.l2r(ae+1e3);break}}else{if(!e(ne[J]))if(e(ne[1-J]))ne[J]=ne[1-J]*(J?10:.1);else{S[Y]=q;break}if(ne[J]<-s?ne[J]=-s:ne[J]>s&&(ne[J]=s),ne[0]===ne[1]){var le=Math.max(1,Math.abs(ne[0]*1e-6));ne[0]-=le,ne[1]+=le}}},S.setScale=function(Y){var ee=E._size;if(S.overlaying){var ne=c.getFromId({_fullLayout:E},S.overlaying);S.domain=ne.domain}var J=Y&&S._r?"_r":"range",q=S.calendar;S.cleanRange(J);var ae=S.r2l(S[J][0],q),le=S.r2l(S[J][1],q),ie=B==="y";if(ie?(S._offset=ee.t+(1-S.domain[1])*ee.h,S._length=ee.h*(S.domain[1]-S.domain[0]),S._m=S._length/(ae-le),S._b=-S._m*le):(S._offset=ee.l+S.domain[0]*ee.w,S._length=ee.w*(S.domain[1]-S.domain[0]),S._m=S._length/(le-ae),S._b=-S._m*ae),S._rangebreaks=[],S._lBreaks=0,S._m2=0,S._B=[],S.rangebreaks){var se,xe;if(S._rangebreaks=S.locateBreaks(Math.min(ae,le),Math.max(ae,le)),S._rangebreaks.length){for(se=0;se<S._rangebreaks.length;se++)xe=S._rangebreaks[se],S._lBreaks+=Math.abs(xe.max-xe.min);var oe=ie;ae>le&&(oe=!oe),oe&&S._rangebreaks.reverse();var he=oe?-1:1;for(S._m2=he*S._length/(Math.abs(le-ae)-S._lBreaks),S._B.push(-S._m2*(ie?le:ae)),se=0;se<S._rangebreaks.length;se++)xe=S._rangebreaks[se],S._B.push(S._B[S._B.length-1]-he*S._m2*(xe.max-xe.min));for(se=0;se<S._rangebreaks.length;se++)xe=S._rangebreaks[se],xe.pmin=ue(xe.min),xe.pmax=ue(xe.max)}}if(!isFinite(S._m)||!isFinite(S._b)||S._length<0)throw E._replotting=!1,new Error("Something went wrong with axis scaling")},S.maskBreaks=function(Y){var ee=S.rangebreaks||[],ne,J,q,ae,le;ee._cachedPatterns||(ee._cachedPatterns=ee.map(function(De){return De.enabled&&De.bounds?A.simpleMap(De.bounds,De.pattern?i:S.d2c):null})),ee._cachedValues||(ee._cachedValues=ee.map(function(De){return De.enabled&&De.values?A.simpleMap(De.values,S.d2c).sort(A.sorterAsc):null}));for(var ie=0;ie<ee.length;ie++){var se=ee[ie];if(se.enabled){if(se.bounds){var xe=se.pattern;switch(ne=ee._cachedPatterns[ie],J=ne[0],q=ne[1],xe){case y:le=new Date(Y),ae=le.getUTCDay(),J>q&&(q+=7,ae<J&&(ae+=7));break;case _:le=new Date(Y);var oe=le.getUTCHours(),he=le.getUTCMinutes(),be=le.getUTCSeconds(),me=le.getUTCMilliseconds();ae=oe+(he/60+be/3600+me/36e5),J>q&&(q+=24,ae<J&&(ae+=24));break;case"":ae=Y;break}if(ae>=J&&ae<q)return m}else for(var _e=ee._cachedValues[ie],Se=0;Se<_e.length;Se++)if(J=_e[Se],q=J+se.dvalue,Y>=J&&Y<q)return m}}return Y},S.locateBreaks=function(Y,ee){var ne,J,q,ae,le=[];if(!S.rangebreaks)return le;var ie=S.rangebreaks.slice().sort(function(Te,Ce){return Te.pattern===y&&Ce.pattern===_?-1:Ce.pattern===y&&Te.pattern===_?1:0}),se=function(Te,Ce){if(Te=A.constrain(Te,Y,ee),Ce=A.constrain(Ce,Y,ee),Te!==Ce){for(var He=!0,Xe=0;Xe<le.length;Xe++){var Be=le[Xe];Te<Be.max&&Ce>=Be.min&&(Te<Be.min&&(Be.min=Te),Ce>Be.max&&(Be.max=Ce),He=!1)}He&&le.push({min:Te,max:Ce})}};for(ne=0;ne<ie.length;ne++){var xe=ie[ne];if(xe.enabled)if(xe.bounds){var oe=Y,he=ee;xe.pattern&&(oe=Math.floor(oe)),J=A.simpleMap(xe.bounds,xe.pattern?i:S.r2l),q=J[0],ae=J[1];var be=new Date(oe),me,_e;switch(xe.pattern){case y:_e=p,me=((ae<q?7:0)+(ae-q))*v,oe+=q*v-(be.getUTCDay()*v+be.getUTCHours()*x+be.getUTCMinutes()*l+be.getUTCSeconds()*b+be.getUTCMilliseconds());break;case _:_e=v,me=((ae<q?24:0)+(ae-q))*x,oe+=q*x-(be.getUTCHours()*x+be.getUTCMinutes()*l+be.getUTCSeconds()*b+be.getUTCMilliseconds());break;default:oe=Math.min(J[0],J[1]),he=Math.max(J[0],J[1]),_e=he-oe,me=_e}for(var Se=oe;Se<he;Se+=_e)se(Se,Se+me)}else for(var De=A.simpleMap(xe.values,S.d2c),Ie=0;Ie<De.length;Ie++)q=De[Ie],ae=q+xe.dvalue,se(q,ae)}return le.sort(function(Te,Ce){return Te.min-Ce.min}),le},S.makeCalcdata=function(Y,ee,ne){var J,q,ae,le,ie=S.type,se=ie==="date"&&Y[ee+"calendar"];if(ee in Y){if(J=Y[ee],le=Y._length||A.minRowLength(J),A.isTypedArray(J)&&(ie==="linear"||ie==="log")){if(le===J.length)return J;if(J.subarray)return J.subarray(0,le)}if(ie==="multicategory")return V(J,le);for(q=new Array(le),ae=0;ae<le;ae++)q[ae]=S.d2c(J[ae],0,se,ne)}else{var xe=ee+"0"in Y?S.d2c(Y[ee+"0"],0,se):0,oe=Y["d"+ee]?Number(Y["d"+ee]):1;for(J=Y[{x:"y",y:"x"}[ee]],le=Y._length||J.length,q=new Array(le),ae=0;ae<le;ae++)q[ae]=xe+ae*oe}if(S.rangebreaks)for(ae=0;ae<le;ae++)q[ae]=S.maskBreaks(q[ae]);return q},S.isValidRange=function(Y){return Array.isArray(Y)&&Y.length===2&&e(S.r2l(Y[0]))&&e(S.r2l(Y[1]))},S.isPtWithinRange=function(Y,ee){var ne=S.c2l(Y[B],null,ee),J=S.r2l(S.range[0]),q=S.r2l(S.range[1]);return J<q?J<=ne&&ne<=q:q<=ne&&ne<=J},S._emptyCategories=function(){S._categories=[],S._categoriesMap={}},S.clearCalc=function(){var Y=S._matchGroup;if(Y){var ee=null,ne=null;for(var J in Y){var q=E[c.id2name(J)];if(q._categories){ee=q._categories,ne=q._categoriesMap;break}}ee&&ne?(S._categories=ee,S._categoriesMap=ne):S._emptyCategories()}else S._emptyCategories();if(S._initialCategories)for(var ae=0;ae<S._initialCategories.length;ae++)N(S._initialCategories[ae])},S.sortByInitialCategories=function(){var Y=[];if(S._emptyCategories(),S._initialCategories)for(var ee=0;ee<S._initialCategories.length;ee++)N(S._initialCategories[ee]);Y=Y.concat(S._traceIndices);var ne=S._matchGroup;for(var J in ne)if(k!==J){var q=E[c.id2name(J)];q._categories=S._categories,q._categoriesMap=S._categoriesMap,Y=Y.concat(q._traceIndices)}return Y};var G=E._d3locale;S.type==="date"&&(S._dateFormat=G?G.timeFormat:u,S._extraFormat=E._extraFormat),S._separators=E.separators,S._numFormat=G?G.numberFormat:T,delete S._minDtick,delete S._forceTick0}},{"../../constants/numerical":491,"../../lib":515,"./axis_ids":570,"./constants":573,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],586:[function(t,P,R){P.exports=function(u){var A=["showexponent","showtickprefix","showticksuffix"],T=A.filter(function(i){return u[i]!==void 0}),e=function(i){return u[i]===u[T[0]]};if(T.every(e)||T.length===1)return u[T[0]]}},{}],587:[function(t,P,R){var h=t("../../lib"),u=t("../../components/color").contrast,A=t("./layout_attributes"),T=t("./show_dflt"),e=t("../array_container_defaults");P.exports=function(a,r,f,o,s){s||(s={});var m=T(a),g=f("showticklabels");if(g){var p=s.font||{},v=r.color,x=r.ticklabelposition||"",l=x.indexOf("inside")!==-1?u(s.bgColor):v&&v!==A.color.dflt?v:p.color;if(h.coerceFont(f,"tickfont",{family:p.family,size:p.size,color:l}),!s.noTicklabelstep&&o!=="multicategory"&&o!=="log"&&f("ticklabelstep"),s.noAng||f("tickangle"),o!=="category"){var b=f("tickformat");e(a,r,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:i}),r.tickformatstops.length||delete r.tickformatstops,!s.noExp&&!b&&o!=="date"&&(f("showexponent",m),f("exponentformat"),f("minexponent"),f("separatethousands"))}}};function i(n,a){function r(o,s){return h.coerce(n,a,A.tickformatstops,o,s)}var f=r("enabled");f&&(r("dtickrange"),r("value"))}},{"../../components/color":367,"../../lib":515,"../array_container_defaults":561,"./layout_attributes":579,"./show_dflt":586}],588:[function(t,P,R){var h=t("../../lib"),u=t("./layout_attributes");P.exports=function(T,e,i,n){var a=n.isMinor,r=a?T.minor||{}:T,f=a?e.minor:e,o=a?u.minor:u,s=a?"minor.":"",m=h.coerce2(r,f,o,"ticklen",a?(e.ticklen||5)*.6:void 0),g=h.coerce2(r,f,o,"tickwidth",a?e.tickwidth||1:void 0),p=h.coerce2(r,f,o,"tickcolor",(a?e.tickcolor:void 0)||f.color),v=i(s+"ticks",!a&&n.outerTicks||m||g||p?"outside":"");v||(delete f.ticklen,delete f.tickwidth,delete f.tickcolor)}},{"../../lib":515,"./layout_attributes":579}],589:[function(t,P,R){var h=t("./clean_ticks"),u=t("../../lib").isArrayOrTypedArray;P.exports=function(T,e,i,n,a){a||(a={});var r=a.isMinor,f=r?T.minor||{}:T,o=r?e.minor:e,s=r?"minor.":"";function m(M){var _=f[M];return _!==void 0?_:(o._template||{})[M]}var g=m("tick0"),p=m("dtick"),v=m("tickvals"),x=u(v)?"array":p?"linear":"auto",l=i(s+"tickmode",x);if(l==="auto")i(s+"nticks");else if(l==="linear"){var b=o.dtick=h.dtick(p,n);o.tick0=h.tick0(g,n,e.calendar,b)}else if(n!=="multicategory"){var c=i(s+"tickvals");c===void 0?o.tickmode="auto":r||i("ticktext")}}},{"../../lib":515,"./clean_ticks":572}],590:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../registry"),A=t("../../lib"),T=t("../../components/drawing"),e=t("./axes");P.exports=function(n,a,r,f){var o=n._fullLayout;if(a.length===0){e.redrawComponents(n);return}function s(_){var y=_.xaxis,w=_.yaxis;o._defs.select("#"+_.clipId+"> rect").call(T.setTranslate,0,0).call(T.setScale,1,1),_.plot.call(T.setTranslate,y._offset,w._offset).call(T.setScale,1,1);var d=_.plot.selectAll(".scatterlayer .trace");d.selectAll(".point").call(T.setPointGroupScale,1,1),d.selectAll(".textpoint").call(T.setTextPointsScale,1,1),d.call(T.hideOutsideRangePoints,_)}function m(_,y){var w=_.plotinfo,d=w.xaxis,C=w.yaxis,S=d._length,E=C._length,k=!!_.xr1,B=!!_.yr1,z=[];if(k){var F=A.simpleMap(_.xr0,d.r2l),I=A.simpleMap(_.xr1,d.r2l),O=F[1]-F[0],N=I[1]-I[0];z[0]=(F[0]*(1-y)+y*I[0]-F[0])/(F[1]-F[0])*S,z[2]=S*(1-y+y*N/O),d.range[0]=d.l2r(F[0]*(1-y)+y*I[0]),d.range[1]=d.l2r(F[1]*(1-y)+y*I[1])}else z[0]=0,z[2]=S;if(B){var V=A.simpleMap(_.yr0,C.r2l),H=A.simpleMap(_.yr1,C.r2l),j=V[1]-V[0],Z=H[1]-H[0];z[1]=(V[1]*(1-y)+y*H[1]-V[1])/(V[0]-V[1])*E,z[3]=E*(1-y+y*Z/j),C.range[0]=d.l2r(V[0]*(1-y)+y*H[0]),C.range[1]=C.l2r(V[1]*(1-y)+y*H[1])}else z[1]=0,z[3]=E;e.drawOne(n,d,{skipTitle:!0}),e.drawOne(n,C,{skipTitle:!0}),e.redrawComponents(n,[d._id,C._id]);var X=k?S/z[2]:1,re=B?E/z[3]:1,ue=k?z[0]:0,K=B?z[1]:0,te=k?z[0]/z[2]*S:0,G=B?z[1]/z[3]*E:0,Y=d._offset-te,ee=C._offset-G;w.clipRect.call(T.setTranslate,ue,K).call(T.setScale,1/X,1/re),w.plot.call(T.setTranslate,Y,ee).call(T.setScale,X,re),T.setPointGroupScale(w.zoomScalePts,1/X,1/re),T.setTextPointsScale(w.zoomScaleTxt,1/X,1/re)}var g;f&&(g=f());function p(){for(var _={},y=0;y<a.length;y++){var w=a[y],d=w.plotinfo.xaxis,C=w.plotinfo.yaxis;w.xr1&&(_[d._name+".range"]=w.xr1.slice()),w.yr1&&(_[C._name+".range"]=w.yr1.slice())}return g&&g(),u.call("relayout",n,_).then(function(){for(var S=0;S<a.length;S++)s(a[S].plotinfo)})}function v(){for(var _={},y=0;y<a.length;y++){var w=a[y],d=w.plotinfo.xaxis,C=w.plotinfo.yaxis;w.xr0&&(_[d._name+".range"]=w.xr0.slice()),w.yr0&&(_[C._name+".range"]=w.yr0.slice())}return u.call("relayout",n,_).then(function(){for(var S=0;S<a.length;S++)s(a[S].plotinfo)})}var x,l,b,c=h.ease(r.easing);n._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(b),b=null,v()});function M(){l=Date.now();for(var _=Math.min(1,(l-x)/r.duration),y=c(_),w=0;w<a.length;w++)m(a[w],y);l-x>r.duration?(p(),b=window.cancelAnimationFrame(M)):b=window.requestAnimationFrame(M)}return x=Date.now(),b=window.requestAnimationFrame(M),Promise.resolve()}},{"../../components/drawing":389,"../../lib":515,"../../registry":647,"./axes":566,"@plotly/d3":58}],591:[function(t,P,R){var h=t("../../registry").traceIs,u=t("./axis_autotype");P.exports=function(a,r,f,o){f("autotypenumbers",o.autotypenumbersDflt);var s=f("type",(o.splomStash||{}).type);s==="-"&&(A(r,o.data),r.type==="-"?r.type="linear":a.type=r.type)};function A(n,a){if(n.type==="-"){var r=n._id,f=r.charAt(0),o;r.indexOf("scene")!==-1&&(r=f);var s=T(a,r,f);if(!!s){if(s.type==="histogram"&&f==={v:"y",h:"x"}[s.orientation||"v"]){n.type="linear";return}var m=f+"calendar",g=s[m],p={noMultiCategory:!h(s,"cartesian")||h(s,"noMultiCategory")};if(s.type==="box"&&s._hasPreCompStats&&f==={h:"x",v:"y"}[s.orientation||"v"]&&(p.noMultiCategory=!0),p.autotypenumbers=n.autotypenumbers,i(s,f)){var v=e(s),x=[];for(o=0;o<a.length;o++){var l=a[o];!h(l,"box-violin")||(l[f+"axis"]||f)!==r||(l[v]!==void 0?x.push(l[v][0]):l.name!==void 0?x.push(l.name):x.push("text"),l[m]!==g&&(g=void 0))}n.type=u(x,g,p)}else if(s.type==="splom"){var b=s.dimensions,c=b[s._axesDim[r]];c.visible&&(n.type=u(c.values,g,p))}else n.type=u(s[f]||[s[f+"0"]],g,p)}}}function T(n,a,r){for(var f=0;f<n.length;f++){var o=n[f];if(o.type==="splom"&&o._length>0&&(o["_"+r+"axes"]||{})[a])return o;if((o[r+"axis"]||r)===a){if(i(o,r))return o;if((o[r]||[]).length||o[r+"0"])return o}}}function e(n){return{v:"x",h:"y"}[n.orientation||"v"]}function i(n,a){var r=e(n),f=h(n,"box-violin"),o=h(n._fullInput||{},"candlestick");return f&&!o&&a===r&&n[r]===void 0&&n[r+"0"]===void 0}},{"../../registry":647,"./axis_autotype":567}],592:[function(t,P,R){var h=t("../registry"),u=t("../lib");R.manageCommandObserver=function(a,r,f,o){var s={},m=!0;r&&r._commandObserver&&(s=r._commandObserver),s.cache||(s.cache={}),s.lookupTable={};var g=R.hasSimpleAPICommandBindings(a,f,s.lookupTable);if(r&&r._commandObserver){if(g)return s;if(r._commandObserver.remove)return r._commandObserver.remove(),r._commandObserver=null,s}if(g){A(a,g,s.cache),s.check=function(){if(!!m){var l=A(a,g,s.cache);return l.changed&&o&&s.lookupTable[l.value]!==void 0&&(s.disable(),Promise.resolve(o({value:l.value,type:g.type,prop:g.prop,traces:g.traces,index:s.lookupTable[l.value]})).then(s.enable,s.enable)),l.changed}};for(var p=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],v=0;v<p.length;v++)a._internalOn(p[v],s.check);s.remove=function(){for(var x=0;x<p.length;x++)a._removeInternalListener(p[x],s.check)}}else u.log("Unable to automatically bind plot updates to API command"),s.lookupTable={},s.remove=function(){};return s.disable=function(){m=!1},s.enable=function(){m=!0},r&&(r._commandObserver=s),s},R.hasSimpleAPICommandBindings=function(a,r,f){var o,s=r.length,m;for(o=0;o<s;o++){var g,p=r[o],v=p.method,x=p.args;if(Array.isArray(x)||(x=[]),!v)return!1;var l=R.computeAPICommandBindings(a,v,x);if(l.length!==1)return!1;if(!m)m=l[0],Array.isArray(m.traces)&&m.traces.sort();else{if(g=l[0],g.type!==m.type||g.prop!==m.prop)return!1;if(Array.isArray(m.traces))if(Array.isArray(g.traces)){g.traces.sort();for(var b=0;b<m.traces.length;b++)if(m.traces[b]!==g.traces[b])return!1}else return!1;else if(g.prop!==m.prop)return!1}g=l[0];var c=g.value;if(Array.isArray(c))if(c.length===1)c=c[0];else return!1;f&&(f[c]=o)}return m};function A(a,r,f){var o,s,m,g=!1;if(r.type==="data")o=a._fullData[r.traces!==null?r.traces[0]:0];else if(r.type==="layout")o=a._fullLayout;else return!1;return s=u.nestedProperty(o,r.prop).get(),m=f[r.type]=f[r.type]||{},m.hasOwnProperty(r.prop)&&m[r.prop]!==s&&(g=!0),m[r.prop]=s,{changed:g,value:s}}R.executeAPICommand=function(a,r,f){if(r==="skip")return Promise.resolve();var o=h.apiMethodRegistry[r],s=[a];Array.isArray(f)||(f=[]);for(var m=0;m<f.length;m++)s.push(f[m]);return o.apply(null,s).catch(function(g){return u.warn("API call to Plotly."+r+" rejected.",g),Promise.reject(g)})},R.computeAPICommandBindings=function(a,r,f){var o;switch(Array.isArray(f)||(f=[]),r){case"restyle":o=i(a,f);break;case"relayout":o=e(a,f);break;case"update":o=i(a,[f[0],f[2]]).concat(e(a,[f[1]]));break;case"animate":o=T(a,f);break;default:o=[]}return o};function T(a,r){return Array.isArray(r[0])&&r[0].length===1&&["string","number"].indexOf(typeof r[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:r[0][0].toString()}]:[]}function e(a,r){var f=[],o=r[0],s={};if(typeof o=="string")s[o]=r[1];else if(u.isPlainObject(o))s=o;else return f;return n(s,function(m,g,p){f.push({type:"layout",prop:m,value:p})},"",0),f}function i(a,r){var f,o,s,m,g=[];if(o=r[0],s=r[1],f=r[2],m={},typeof o=="string")m[o]=s;else if(u.isPlainObject(o))m=o,f===void 0&&(f=s);else return g;return f===void 0&&(f=null),n(m,function(p,v,x){var l,b;if(Array.isArray(x)){b=x.slice();var c=Math.min(b.length,a.data.length);f&&(c=Math.min(c,f.length)),l=[];for(var M=0;M<c;M++)l[M]=f?f[M]:M}else b=x,l=f?f.slice():null;if(l===null)Array.isArray(b)&&(b=b[0]);else if(Array.isArray(l)){if(!Array.isArray(b)){var _=b;b=[];for(var y=0;y<l.length;y++)b[y]=_}b.length=Math.min(l.length,b.length)}g.push({type:"data",prop:p,traces:l,value:b})},"",0),g}function n(a,r,f,o){Object.keys(a).forEach(function(s){var m=a[s];if(s[0]!=="_"){var g=f+(o>0?".":"")+s;u.isPlainObject(m)?n(m,r,g,o+1):r(g,s,m)}})}},{"../lib":515,"../registry":647}],593:[function(t,P,R){var h=t("../lib/extend").extendFlat;R.attributes=function(u,A){u=u||{},A=A||{};var T={valType:"info_array",editType:u.editType,items:[{valType:"number",min:0,max:1,editType:u.editType},{valType:"number",min:0,max:1,editType:u.editType}],dflt:[0,1]};u.name&&u.name+"",u.trace,A.description&&""+A.description;var e={x:h({},T,{}),y:h({},T,{}),editType:u.editType};return u.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:u.editType},e.column={valType:"integer",min:0,dflt:0,editType:u.editType}),e},R.defaults=function(u,A,T,e){var i=e&&e.x||[0,1],n=e&&e.y||[0,1],a=A.grid;if(a){var r=T("domain.column");r!==void 0&&(r<a.columns?i=a._domains.x[r]:delete u.domain.column);var f=T("domain.row");f!==void 0&&(f<a.rows?n=a._domains.y[f]:delete u.domain.row)}var o=T("domain.x",i),s=T("domain.y",n);o[0]<o[1]||(u.domain.x=i.slice()),s[0]<s[1]||(u.domain.y=n.slice())}},{"../lib/extend":505}],594:[function(t,P,R){P.exports=function(h){var u=h.editType,A=h.colorEditType;A===void 0&&(A=u);var T={family:{valType:"string",noBlank:!0,strict:!0,editType:u},size:{valType:"number",min:1,editType:u},color:{valType:"color",editType:A},editType:u};return h.autoSize&&(T.size.dflt="auto"),h.autoColor&&(T.color.dflt="auto"),h.arrayOk&&(T.family.arrayOk=!0,T.size.arrayOk=!0,T.color.arrayOk=!0),T}},{}],595:[function(t,P,R){P.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],596:[function(t,P,R){R.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},R.axesNames=["lonaxis","lataxis"],R.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},R.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},R.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},R.clipPad=.001,R.precision=.1,R.landColor="#F0DC82",R.waterColor="#3399FF",R.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},R.sphereSVG={type:"Sphere"},R.fillLayers={ocean:1,land:1,lakes:1},R.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},R.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],R.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],R.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],597:[function(t,P,R){var h=t("@plotly/d3"),u=t("d3-geo"),A=u.geoPath,T=u.geoDistance,e=t("d3-geo-projection"),i=t("../../registry"),n=t("../../lib"),a=n.strTranslate,r=t("../../components/color"),f=t("../../components/drawing"),o=t("../../components/fx"),s=t("../plots"),m=t("../cartesian/axes"),g=t("../cartesian/autorange").getAutoRange,p=t("../../components/dragelement"),v=t("../../components/selections").prepSelect,x=t("../../components/selections").clearOutline,l=t("../../components/selections").selectOnClick,b=t("./zoom"),c=t("./constants"),M=t("../../lib/geo_location_utils"),_=t("../../lib/topojson_utils"),y=t("topojson-client").feature;function w(k){this.id=k.id,this.graphDiv=k.graphDiv,this.container=k.container,this.topojsonURL=k.topojsonURL,this.isStatic=k.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var d=w.prototype;P.exports=function(B){return new w(B)},d.plot=function(k,B,z,F){var I=this;if(F)return I.update(k,B,!0);I._geoCalcData=k,I._fullLayout=B;var O=B[this.id],N=[],V=!1;for(var H in c.layerNameToAdjective)if(H!=="frame"&&O["show"+H]){V=!0;break}for(var j=!1,Z=0;Z<k.length;Z++){var X=k[0][0].trace;X._geo=I,X.locationmode&&(V=!0);var re=X.marker;if(re){var ue=re.angle,K=re.angleref;(ue||K==="north"||K==="previous")&&(j=!0)}}if(this._hasMarkerAngles=j,V){var te=_.getTopojsonName(O);(I.topojson===null||te!==I.topojsonName)&&(I.topojsonName=te,PlotlyGeoAssets.topojson[I.topojsonName]===void 0&&N.push(I.fetchTopojson()))}N=N.concat(M.fetchTraceGeoData(k)),z.push(new Promise(function(G,Y){Promise.all(N).then(function(){I.topojson=PlotlyGeoAssets.topojson[I.topojsonName],I.update(k,B),G()}).catch(Y)}))},d.fetchTopojson=function(){var k=this,B=_.getTopojsonPath(k.topojsonURL,k.topojsonName);return new Promise(function(z,F){h.json(B,function(I,O){if(I)return I.status===404?F(new Error(["plotly.js could not find topojson file at",B+".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):F(new Error(["unexpected error while fetching topojson file at",B].join(" ")));PlotlyGeoAssets.topojson[k.topojsonName]=O,z()})})},d.update=function(k,B,z){var F=B[this.id];this.hasChoropleth=!1;for(var I=0;I<k.length;I++){var O=k[I],N=O[0].trace;N.type==="choropleth"&&(this.hasChoropleth=!0),N.visible===!0&&N._length>0&&N._module.calcGeoJSON(O,B)}if(!z){var V=this.updateProjection(k,B);if(V)return;(!this.viewInitial||this.scope!==F.scope)&&this.saveViewInitial(F)}this.scope=F.scope,this.updateBaseLayers(B,F),this.updateDims(B,F),this.updateFx(B,F),s.generalUpdatePerTraceModule(this.graphDiv,this,k,F);var H=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=H.selectAll(".point"),this.dataPoints.text=H.selectAll("text"),this.dataPaths.line=H.selectAll(".js-line");var j=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=j.selectAll("path"),this._render()},d.updateProjection=function(k,B){var z=this.graphDiv,F=B[this.id],I=B._size,O=F.domain,N=F.projection,V=F.lonaxis,H=F.lataxis,j=V._ax,Z=H._ax,X=this.projection=C(F),re=[[I.l+I.w*O.x[0],I.t+I.h*(1-O.y[1])],[I.l+I.w*O.x[1],I.t+I.h*(1-O.y[0])]],ue=F.center||{},K=N.rotation||{},te=V.range||[],G=H.range||[];if(F.fitbounds){j._length=re[1][0]-re[0][0],Z._length=re[1][1]-re[0][1],j.range=g(z,j),Z.range=g(z,Z);var Y=(j.range[0]+j.range[1])/2,ee=(Z.range[0]+Z.range[1])/2;if(F._isScoped)ue={lon:Y,lat:ee};else if(F._isClipped){ue={lon:Y,lat:ee},K={lon:Y,lat:ee,roll:K.roll};var ne=N.type,J=c.lonaxisSpan[ne]/2||180,q=c.lataxisSpan[ne]/2||90;te=[Y-J,Y+J],G=[ee-q,ee+q]}else ue={lon:Y,lat:ee},K={lon:Y,lat:K.lat,roll:K.roll}}X.center([ue.lon-K.lon,ue.lat-K.lat]).rotate([-K.lon,-K.lat,K.roll]).parallels(N.parallels);var ae=E(te,G);X.fitExtent(re,ae);var le=this.bounds=X.getBounds(ae),ie=this.fitScale=X.scale(),se=X.translate();if(F.fitbounds){var xe=X.getBounds(E(j.range,Z.range)),oe=Math.min((le[1][0]-le[0][0])/(xe[1][0]-xe[0][0]),(le[1][1]-le[0][1])/(xe[1][1]-xe[0][1]));isFinite(oe)?X.scale(oe*ie):n.warn("Something went wrong during"+this.id+"fitbounds computations.")}else X.scale(N.scale*ie);var he=this.midPt=[(le[0][0]+le[1][0])/2,(le[0][1]+le[1][1])/2];if(X.translate([se[0]+(he[0]-se[0]),se[1]+(he[1]-se[1])]).clipExtent(le),F._isAlbersUsa){var be=X([ue.lon,ue.lat]),me=X.translate();X.translate([me[0]-(be[0]-me[0]),me[1]-(be[1]-me[1])])}},d.updateBaseLayers=function(k,B){var z=this,F=z.topojson,I=z.layers,O=z.basePaths;function N(re){return re==="lonaxis"||re==="lataxis"}function V(re){return Boolean(c.lineLayers[re])}function H(re){return Boolean(c.fillLayers[re])}var j=this.hasChoropleth?c.layersForChoropleth:c.layers,Z=j.filter(function(re){return V(re)||H(re)?B["show"+re]:N(re)?B[re].showgrid:!0}),X=z.framework.selectAll(".layer").data(Z,String);X.exit().each(function(re){delete I[re],delete O[re],h.select(this).remove()}),X.enter().append("g").attr("class",function(re){return"layer "+re}).each(function(re){var ue=I[re]=h.select(this);re==="bg"?z.bgRect=ue.append("rect").style("pointer-events","all"):N(re)?O[re]=ue.append("path").style("fill","none"):re==="backplot"?ue.append("g").classed("choroplethlayer",!0):re==="frontplot"?ue.append("g").classed("scatterlayer",!0):V(re)?O[re]=ue.append("path").style("fill","none").style("stroke-miterlimit",2):H(re)&&(O[re]=ue.append("path").style("stroke","none"))}),X.order(),X.each(function(re){var ue=O[re],K=c.layerNameToAdjective[re];re==="frame"?ue.datum(c.sphereSVG):V(re)||H(re)?ue.datum(y(F,F.objects[re])):N(re)&&ue.datum(S(re,B,k)).call(r.stroke,B[re].gridcolor).call(f.dashLine,B[re].griddash,B[re].gridwidth),V(re)?ue.call(r.stroke,B[K+"color"]).call(f.dashLine,"",B[K+"width"]):H(re)&&ue.call(r.fill,B[K+"color"])})},d.updateDims=function(k,B){var z=this.bounds,F=(B.framewidth||0)/2,I=z[0][0]-F,O=z[0][1]-F,N=z[1][0]-I+F,V=z[1][1]-O+F;f.setRect(this.clipRect,I,O,N,V),this.bgRect.call(f.setRect,I,O,N,V).call(r.fill,B.bgcolor),this.xaxis._offset=I,this.xaxis._length=N,this.yaxis._offset=O,this.yaxis._length=V},d.updateFx=function(k,B){var z=this,F=z.graphDiv,I=z.bgRect,O=k.dragmode,N=k.clickmode;if(z.isStatic)return;function V(){var X=z.viewInitial,re={};for(var ue in X)re[z.id+"."+ue]=X[ue];i.call("_guiRelayout",F,re),F.emit("plotly_doubleclick",null)}function H(X){return z.projection.invert([X[0]+z.xaxis._offset,X[1]+z.yaxis._offset])}var j=function(X,re){if(re.isRect){var ue=X.range={};ue[z.id]=[H([re.xmin,re.ymin]),H([re.xmax,re.ymax])]}else{var K=X.lassoPoints={};K[z.id]=re.map(H)}},Z={element:z.bgRect.node(),gd:F,plotinfo:{id:z.id,xaxis:z.xaxis,yaxis:z.yaxis,fillRangeItems:j},xaxes:[z.xaxis],yaxes:[z.yaxis],subplot:z.id,clickFn:function(X){X===2&&x(F)}};O==="pan"?(I.node().onmousedown=null,I.call(b(z,B)),I.on("dblclick.zoom",V),F._context._scrollZoom.geo||I.on("wheel.zoom",null)):(O==="select"||O==="lasso")&&(I.on(".zoom",null),Z.prepFn=function(X,re,ue){v(X,re,ue,Z,O)},p.init(Z)),I.on("mousemove",function(){var X=z.projection.invert(n.getPositionFromD3Event());if(!X)return p.unhover(F,h.event);z.xaxis.p2c=function(){return X[0]},z.yaxis.p2c=function(){return X[1]},o.hover(F,h.event,z.id)}),I.on("mouseout",function(){F._dragging||p.unhover(F,h.event)}),I.on("click",function(){O!=="select"&&O!=="lasso"&&(N.indexOf("select")>-1&&l(h.event,F,[z.xaxis],[z.yaxis],z.id,Z),N.indexOf("event")>-1&&o.click(F,h.event))})},d.makeFramework=function(){var k=this,B=k.graphDiv,z=B._fullLayout,F="clip"+z._uid+k.id;k.clipDef=z._clips.append("clipPath").attr("id",F),k.clipRect=k.clipDef.append("rect"),k.framework=h.select(k.container).append("g").attr("class","geo "+k.id).call(f.setClipUrl,F,B),k.project=function(I){var O=k.projection(I);return O?[O[0]-k.xaxis._offset,O[1]-k.yaxis._offset]:[null,null]},k.xaxis={_id:"x",c2p:function(I){return k.project(I)[0]}},k.yaxis={_id:"y",c2p:function(I){return k.project(I)[1]}},k.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},m.setConvert(k.mockAxis,z)},d.saveViewInitial=function(k){var B=k.center||{},z=k.projection,F=z.rotation||{};this.viewInitial={fitbounds:k.fitbounds,"projection.scale":z.scale};var I;k._isScoped?I={"center.lon":B.lon,"center.lat":B.lat}:k._isClipped?I={"projection.rotation.lon":F.lon,"projection.rotation.lat":F.lat}:I={"center.lon":B.lon,"center.lat":B.lat,"projection.rotation.lon":F.lon},n.extendFlat(this.viewInitial,I)},d.render=function(k){this._hasMarkerAngles&&k?this.plot(this._geoCalcData,this._fullLayout,[],!0):this._render()},d._render=function(){var k=this.projection,B=k.getPath(),z;function F(O){var N=k(O.lonlat);return N?a(N[0],N[1]):null}function I(O){return k.isLonLatOverEdges(O.lonlat)?"none":null}for(z in this.basePaths)this.basePaths[z].attr("d",B);for(z in this.dataPaths)this.dataPaths[z].attr("d",function(O){return B(O.geojson)});for(z in this.dataPoints)this.dataPoints[z].attr("display",I).attr("transform",F)};function C(k){var B=k.projection,z=B.type,F=c.projNames[z];F="geo"+n.titleCase(F);for(var I=u[F]||e[F],O=I(),N=k._isSatellite?Math.acos(1/B.distance)*180/Math.PI:k._isClipped?c.lonaxisSpan[z]/2:null,V=["center","rotate","parallels","clipExtent"],H=function(X){return X?O:[]},j=0;j<V.length;j++){var Z=V[j];typeof O[Z]!="function"&&(O[Z]=H)}return O.isLonLatOverEdges=function(X){if(O(X)===null)return!0;if(N){var re=O.rotate(),ue=T(X,[-re[0],-re[1]]),K=N*Math.PI/180;return ue>K}else return!1},O.getPath=function(){return A().projection(O)},O.getBounds=function(X){return O.getPath().bounds(X)},O.precision(c.precision),k._isSatellite&&O.tilt(B.tilt).distance(B.distance),N&&O.clipAngle(N-c.clipPad),O}function S(k,B,z){var F=1e-6,I=2.5,O=B[k],N=c.scopeDefaults[B.scope],V,H,j;k==="lonaxis"?(V=N.lonaxisRange,H=N.lataxisRange,j=function(ee,ne){return[ee,ne]}):k==="lataxis"&&(V=N.lataxisRange,H=N.lonaxisRange,j=function(ee,ne){return[ne,ee]});var Z={type:"linear",range:[V[0],V[1]-F],tick0:O.tick0,dtick:O.dtick};m.setConvert(Z,z);var X=m.calcTicks(Z);!B.isScoped&&k==="lonaxis"&&X.pop();for(var re=X.length,ue=new Array(re),K=0;K<re;K++)for(var te=X[K].x,G=ue[K]=[],Y=H[0];Y<H[1]+I;Y+=I)G.push(j(te,Y));return{type:"MultiLineString",coordinates:ue}}function E(k,B){var z=c.clipPad,F=k[0]+z,I=k[1]-z,O=B[0]+z,N=B[1]-z;F>0&&I<0&&(I+=360);var V=(I-F)/4;return{type:"Polygon",coordinates:[[[F,O],[F,N],[F+V,N],[F+2*V,N],[F+3*V,N],[I,N],[I,O],[I-V,O],[I-2*V,O],[I-3*V,O],[F,O]]]}}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../registry":647,"../cartesian/autorange":565,"../cartesian/axes":566,"../plots":628,"./constants":596,"./zoom":601,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":316}],598:[function(t,P,R){var h=t("../../plots/get_data").getSubplotCalcData,u=t("../../lib").counterRegex,A=t("./geo"),T="geo",e=u(T),i={};i[T]={valType:"subplotid",dflt:T,editType:"calc"};function n(f){for(var o=f._fullLayout,s=f.calcdata,m=o._subplots[T],g=0;g<m.length;g++){var p=m[g],v=h(s,T,p),x=o[p],l=x._subplot;l||(l=A({id:p,graphDiv:f,container:o._geolayer.node(),topojsonURL:f._context.topojsonURL,staticPlot:f._context.staticPlot}),o[p]._subplot=l),l.plot(v,o,f._promises)}}function a(f,o,s,m){for(var g=m._subplots[T]||[],p=0;p<g.length;p++){var v=g[p],x=m[v]._subplot;!o[v]&&!!x&&(x.framework.remove(),x.clipDef.remove())}}function r(f){for(var o=f._fullLayout,s=o._subplots[T],m=0;m<s.length;m++){var g=o[s[m]],p=g._subplot;p.updateFx(o,g)}}P.exports={attr:T,name:T,idRoot:T,idRegex:e,attrRegex:e,attributes:i,layoutAttributes:t("./layout_attributes"),supplyLayoutDefaults:t("./layout_defaults"),plot:n,updateFx:r,clean:a}},{"../../lib":515,"../../plots/get_data":602,"./geo":597,"./layout_attributes":599,"./layout_defaults":600}],599:[function(t,P,R){var h=t("../../components/color/attributes"),u=t("../domain").attributes,A=t("../../components/drawing/attributes").dash,T=t("./constants"),e=t("../../plot_api/edit_types").overrideAll,i=t("../../lib/sort_object_keys"),n={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:h.lightLine},gridwidth:{valType:"number",min:0,dflt:1},griddash:A},a=P.exports=e({domain:u({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:i(T.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:i(T.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:h.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:T.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:T.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:T.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:T.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:h.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:h.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:h.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:h.background},lonaxis:n,lataxis:n},"plot","from-root");a.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../domain":593,"./constants":596}],600:[function(t,P,R){var h=t("../../lib"),u=t("../subplot_defaults"),A=t("../get_data").getSubplotData,T=t("./constants"),e=t("./layout_attributes"),i=T.axesNames;P.exports=function(r,f,o){u(r,f,o,{type:"geo",attributes:e,handleDefaults:n,fullData:o,partition:"y"})};function n(a,r,f,o){var s=A(o.fullData,"geo",o.id),m=s.map(function(G){return G._expandedIndex}),g=f("resolution"),p=f("scope"),v=T.scopeDefaults[p],x=f("projection.type",v.projType),l=r._isAlbersUsa=x==="albers usa";l&&(p=r.scope="usa");var b=r._isScoped=p!=="world",c=r._isSatellite=x==="satellite",M=r._isConic=x.indexOf("conic")!==-1||x==="albers",_=r._isClipped=!!T.lonaxisSpan[x];if(a.visible===!1){var y=h.extendDeep({},r._template);y.showcoastlines=!1,y.showcountries=!1,y.showframe=!1,y.showlakes=!1,y.showland=!1,y.showocean=!1,y.showrivers=!1,y.showsubunits=!1,y.lonaxis&&(y.lonaxis.showgrid=!1),y.lataxis&&(y.lataxis.showgrid=!1),r._template=y}for(var w=f("visible"),d,C=0;C<i.length;C++){var S=i[C],E=[30,10][C],k;if(b)k=v[S+"Range"];else{var B=T[S+"Span"],z=(B[x]||B["*"])/2,F=f("projection.rotation."+S.substr(0,3),v.projRotate[C]);k=[F-z,F+z]}var I=f(S+".range",k);f(S+".tick0"),f(S+".dtick",E),d=f(S+".showgrid",w?void 0:!1),d&&(f(S+".gridcolor"),f(S+".gridwidth"),f(S+".griddash")),r[S]._ax={type:"linear",_id:S.slice(0,3),_traceIndices:m,setScale:h.identity,c2l:h.identity,r2l:h.identity,autorange:!0,range:I.slice(),_m:1,_input:{}}}var O=r.lonaxis.range,N=r.lataxis.range,V=O[0],H=O[1];V>0&&H<0&&(H+=360);var j=(V+H)/2,Z;if(!l){var X=b?v.projRotate:[j,0,0];Z=f("projection.rotation.lon",X[0]),f("projection.rotation.lat",X[1]),f("projection.rotation.roll",X[2]),d=f("showcoastlines",!b&&w),d&&(f("coastlinecolor"),f("coastlinewidth")),d=f("showocean",w?void 0:!1),d&&f("oceancolor")}var re,ue;if(l?(re=-96.6,ue=38.7):(re=b?j:Z,ue=(N[0]+N[1])/2),f("center.lon",re),f("center.lat",ue),c&&(f("projection.tilt"),f("projection.distance")),M){var K=v.projParallels||[0,60];f("projection.parallels",K)}f("projection.scale"),d=f("showland",w?void 0:!1),d&&f("landcolor"),d=f("showlakes",w?void 0:!1),d&&f("lakecolor"),d=f("showrivers",w?void 0:!1),d&&(f("rivercolor"),f("riverwidth")),d=f("showcountries",b&&p!=="usa"&&w),d&&(f("countrycolor"),f("countrywidth")),(p==="usa"||p==="north america"&&g===50)&&(f("showsubunits",w),f("subunitcolor"),f("subunitwidth")),b||(d=f("showframe",w),d&&(f("framecolor"),f("framewidth"))),f("bgcolor");var te=f("fitbounds");te&&(delete r.projection.scale,b?(delete r.center.lon,delete r.center.lat):_?(delete r.center.lon,delete r.center.lat,delete r.projection.rotation.lon,delete r.projection.rotation.lat,delete r.lonaxis.range,delete r.lataxis.range):(delete r.center.lon,delete r.center.lat,delete r.projection.rotation.lon))}},{"../../lib":515,"../get_data":602,"../subplot_defaults":641,"./constants":596,"./layout_attributes":599}],601:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=t("../../registry"),T=Math.PI/180,e=180/Math.PI,i={cursor:"pointer"},n={cursor:"auto"};function a(S,E){var k=S.projection,B;return E._isScoped?B=o:E._isClipped?B=m:B=s,B(S,k)}P.exports=a;function r(S,E){return h.behavior.zoom().translate(E.translate()).scale(E.scale())}function f(S,E,k){var B=S.id,z=S.graphDiv,F=z.layout,I=F[B],O=z._fullLayout,N=O[B],V={},H={};function j(Z,X){V[B+"."+Z]=u.nestedProperty(I,Z).get(),A.call("_storeDirectGUIEdit",F,O._preGUI,V);var re=u.nestedProperty(N,Z);re.get()!==X&&(re.set(X),u.nestedProperty(I,Z).set(X),H[B+"."+Z]=X)}k(j),j("projection.scale",E.scale()/S.fitScale),j("fitbounds",!1),z.emit("plotly_relayout",H)}function o(S,E){var k=r(S,E);function B(){h.select(this).style(i)}function z(){E.scale(h.event.scale).translate(h.event.translate),S.render(!0);var O=E.invert(S.midPt);S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":E.scale()/S.fitScale,"geo.center.lon":O[0],"geo.center.lat":O[1]})}function F(O){var N=E.invert(S.midPt);O("center.lon",N[0]),O("center.lat",N[1])}function I(){h.select(this).style(n),f(S,E,F)}return k.on("zoomstart",B).on("zoom",z).on("zoomend",I),k}function s(S,E){var k=r(S,E),B=2,z,F,I,O,N,V,H,j,Z;function X(Y){return E.invert(Y)}function re(Y){var ee=X(Y);if(!ee)return!0;var ne=E(ee);return Math.abs(ne[0]-Y[0])>B||Math.abs(ne[1]-Y[1])>B}function ue(){h.select(this).style(i),z=h.mouse(this),F=E.rotate(),I=E.translate(),O=F,N=X(z)}function K(){if(V=h.mouse(this),re(z)){k.scale(E.scale()),k.translate(E.translate());return}E.scale(h.event.scale),E.translate([I[0],h.event.translate[1]]),N?X(V)&&(j=X(V),H=[O[0]+(j[0]-N[0]),F[1],F[2]],E.rotate(H),O=H):(z=V,N=X(z)),Z=!0,S.render(!0);var Y=E.rotate(),ee=E.invert(S.midPt);S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":E.scale()/S.fitScale,"geo.center.lon":ee[0],"geo.center.lat":ee[1],"geo.projection.rotation.lon":-Y[0]})}function te(){h.select(this).style(n),Z&&f(S,E,G)}function G(Y){var ee=E.rotate(),ne=E.invert(S.midPt);Y("projection.rotation.lon",-ee[0]),Y("center.lon",ne[0]),Y("center.lat",ne[1])}return k.on("zoomstart",ue).on("zoom",K).on("zoomend",te),k}function m(S,E){E.rotate(),E.scale();var k=r(S,E),B=C(k,"zoomstart","zoom","zoomend"),z=0,F=k.on,I;k.on("zoomstart",function(){h.select(this).style(i);var j=h.mouse(this),Z=E.rotate(),X=Z,re=E.translate(),ue=p(Z);I=g(E,j),F.call(k,"zoom",function(){var K=h.mouse(this);if(E.scale(h.event.scale),!I)j=K,I=g(E,j);else if(g(E,K)){E.rotate(Z).translate(re);var te=g(E,K),G=x(I,te),Y=_(v(ue,G)),ee=l(Y,I,X);(!isFinite(ee[0])||!isFinite(ee[1])||!isFinite(ee[2]))&&(ee=X),E.rotate(ee),X=ee}N(B.of(this,arguments))}),O(B.of(this,arguments))}).on("zoomend",function(){h.select(this).style(n),F.call(k,"zoom",null),V(B.of(this,arguments)),f(S,E,H)}).on("zoom.redraw",function(){S.render(!0);var j=E.rotate();S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":E.scale()/S.fitScale,"geo.projection.rotation.lon":-j[0],"geo.projection.rotation.lat":-j[1]})});function O(j){z++||j({type:"zoomstart"})}function N(j){j({type:"zoom"})}function V(j){--z||j({type:"zoomend"})}function H(j){var Z=E.rotate();j("projection.rotation.lon",-Z[0]),j("projection.rotation.lat",-Z[1])}return h.rebind(k,B,"on")}function g(S,E){var k=S.invert(E);return k&&isFinite(k[0])&&isFinite(k[1])&&y(k)}function p(S){var E=.5*S[0]*T,k=.5*S[1]*T,B=.5*S[2]*T,z=Math.sin(E),F=Math.cos(E),I=Math.sin(k),O=Math.cos(k),N=Math.sin(B),V=Math.cos(B);return[F*O*V+z*I*N,z*O*V-F*I*N,F*I*V+z*O*N,F*O*N-z*I*V]}function v(S,E){var k=S[0],B=S[1],z=S[2],F=S[3],I=E[0],O=E[1],N=E[2],V=E[3];return[k*I-B*O-z*N-F*V,k*O+B*I+z*V-F*N,k*N-B*V+z*I+F*O,k*V+B*N-z*O+F*I]}function x(S,E){if(!(!S||!E)){var k=d(S,E),B=Math.sqrt(w(k,k)),z=.5*Math.acos(Math.max(-1,Math.min(1,w(S,E)))),F=Math.sin(z)/B;return B&&[Math.cos(z),k[2]*F,-k[1]*F,k[0]*F]}}function l(S,E,k){var B=M(E,2,S[0]);B=M(B,1,S[1]),B=M(B,0,S[2]-k[2]);var z=E[0],F=E[1],I=E[2],O=B[0],N=B[1],V=B[2],H=Math.atan2(F,z)*e,j=Math.sqrt(z*z+F*F),Z,X;Math.abs(N)>j?(X=(N>0?90:-90)-H,Z=0):(X=Math.asin(N/j)*e-H,Z=Math.sqrt(j*j-N*N));var re=180-X-2*H,ue=(Math.atan2(V,O)-Math.atan2(I,Z))*e,K=(Math.atan2(V,O)-Math.atan2(I,-Z))*e,te=b(k[0],k[1],X,ue),G=b(k[0],k[1],re,K);return te<=G?[X,ue,k[2]]:[re,K,k[2]]}function b(S,E,k,B){var z=c(k-S),F=c(B-E);return Math.sqrt(z*z+F*F)}function c(S){return(S%360+540)%360-180}function M(S,E,k){var B=k*T,z=S.slice(),F=E===0?1:0,I=E===2?1:2,O=Math.cos(B),N=Math.sin(B);return z[F]=S[F]*O-S[I]*N,z[I]=S[I]*O+S[F]*N,z}function _(S){return[Math.atan2(2*(S[0]*S[1]+S[2]*S[3]),1-2*(S[1]*S[1]+S[2]*S[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(S[0]*S[2]-S[3]*S[1]))))*e,Math.atan2(2*(S[0]*S[3]+S[1]*S[2]),1-2*(S[2]*S[2]+S[3]*S[3]))*e]}function y(S){var E=S[0]*T,k=S[1]*T,B=Math.cos(k);return[B*Math.cos(E),B*Math.sin(E),Math.sin(k)]}function w(S,E){for(var k=0,B=0,z=S.length;B<z;++B)k+=S[B]*E[B];return k}function d(S,E){return[S[1]*E[2]-S[2]*E[1],S[2]*E[0]-S[0]*E[2],S[0]*E[1]-S[1]*E[0]]}function C(S){for(var E=0,k=arguments.length,B=[];++E<k;)B.push(arguments[E]);var z=h.dispatch.apply(null,B);return z.of=function(F,I){return function(O){var N;try{N=O.sourceEvent=h.event,O.target=S,h.event=O,z[O.type].apply(F,I)}finally{h.event=N}}},z}},{"../../lib":515,"../../registry":647,"@plotly/d3":58}],602:[function(t,P,R){var h=t("../registry"),u=t("./cartesian/constants").SUBPLOT_PATTERN;R.getSubplotCalcData=function(A,T,e){var i=h.subplotsRegistry[T];if(!i)return[];for(var n=i.attr,a=[],r=0;r<A.length;r++){var f=A[r],o=f[0].trace;o[n]===e&&a.push(f)}return a},R.getModuleCalcData=function(A,T){var e=[],i=[],n;if(typeof T=="string"?n=h.getModule(T).plot:typeof T=="function"?n=T:n=T.plot,!n)return[e,A];for(var a=0;a<A.length;a++){var r=A[a],f=r[0].trace;f.visible!==!0||f._length===0||(f._module.plot===n?e.push(r):i.push(r))}return[e,i]},R.getSubplotData=function(T,e,i){if(!h.subplotsRegistry[e])return[];var n=h.subplotsRegistry[e].attr,a=[],r,f,o;if(e==="gl2d"){var s=i.match(u);f="x"+s[1],o="y"+s[2]}for(var m=0;m<T.length;m++)r=T[m],e==="gl2d"&&h.traceIs(r,"gl2d")?r[n[0]]===f&&r[n[1]]===o&&a.push(r):r[n]===i&&a.push(r);return a}},{"../registry":647,"./cartesian/constants":573}],603:[function(t,P,R){var h=t("mouse-change"),u=t("mouse-wheel"),A=t("mouse-event-offset"),T=t("../cartesian/constants"),e=t("has-passive-events");P.exports=n;function i(a,r){this.element=a,this.plot=r,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}function n(a){var r=a.mouseContainer,f=a.glplot,o=new i(r,f);function s(){a.xaxis.autorange=!1,a.yaxis.autorange=!1}function m(){for(var p=a.graphDiv._fullLayout._axisConstraintGroups,v=a.xaxis._id,x=a.yaxis._id,l=0;l<p.length;l++)if(p[l][v]!==-1){if(p[l][x]!==-1)return!0;break}return!1}o.mouseListener=h(r,g),r.addEventListener("touchstart",function(p){var v=A(p.changedTouches[0],r);g(0,v[0],v[1]),g(1,v[0],v[1]),p.preventDefault()},e?{passive:!1}:!1),r.addEventListener("touchmove",function(p){p.preventDefault();var v=A(p.changedTouches[0],r);g(1,v[0],v[1]),p.preventDefault()},e?{passive:!1}:!1),r.addEventListener("touchend",function(p){g(0,o.lastPos[0],o.lastPos[1]),p.preventDefault()},e?{passive:!1}:!1);function g(p,v,x){var l=a.calcDataBox(),b=f.viewBox,c=o.lastPos[0],M=o.lastPos[1],_=T.MINDRAG*f.pixelRatio,y=T.MINZOOM*f.pixelRatio,w,d;v*=f.pixelRatio,x*=f.pixelRatio,x=b[3]-b[1]-x;function C(F,I,O){var N=Math.min(I,O),V=Math.max(I,O);N!==V?(l[F]=N,l[F+2]=V,o.dataBox=l,a.setRanges(l)):(a.selectBox.selectBox=[0,0,1,1],a.glplot.setDirty())}switch(a.fullLayout.dragmode){case"zoom":if(p){var S=v/(b[2]-b[0])*(l[2]-l[0])+l[0],E=x/(b[3]-b[1])*(l[3]-l[1])+l[1];o.boxInited||(o.boxStart[0]=S,o.boxStart[1]=E,o.dragStart[0]=v,o.dragStart[1]=x),o.boxEnd[0]=S,o.boxEnd[1]=E,o.boxInited=!0,!o.boxEnabled&&(o.boxStart[0]!==o.boxEnd[0]||o.boxStart[1]!==o.boxEnd[1])&&(o.boxEnabled=!0);var k=Math.abs(o.dragStart[0]-v)<y,B=Math.abs(o.dragStart[1]-x)<y;if(m()&&!(k&&B)){w=o.boxEnd[0]-o.boxStart[0],d=o.boxEnd[1]-o.boxStart[1];var z=(l[3]-l[1])/(l[2]-l[0]);Math.abs(w*z)>Math.abs(d)?(o.boxEnd[1]=o.boxStart[1]+Math.abs(w)*z*(d>=0?1:-1),o.boxEnd[1]<l[1]?(o.boxEnd[1]=l[1],o.boxEnd[0]=o.boxStart[0]+(l[1]-o.boxStart[1])/Math.abs(z)):o.boxEnd[1]>l[3]&&(o.boxEnd[1]=l[3],o.boxEnd[0]=o.boxStart[0]+(l[3]-o.boxStart[1])/Math.abs(z))):(o.boxEnd[0]=o.boxStart[0]+Math.abs(d)/z*(w>=0?1:-1),o.boxEnd[0]<l[0]?(o.boxEnd[0]=l[0],o.boxEnd[1]=o.boxStart[1]+(l[0]-o.boxStart[0])*Math.abs(z)):o.boxEnd[0]>l[2]&&(o.boxEnd[0]=l[2],o.boxEnd[1]=o.boxStart[1]+(l[2]-o.boxStart[0])*Math.abs(z)))}else k&&(o.boxEnd[0]=o.boxStart[0]),B&&(o.boxEnd[1]=o.boxStart[1])}else o.boxEnabled?(w=o.boxStart[0]!==o.boxEnd[0],d=o.boxStart[1]!==o.boxEnd[1],w||d?(w&&(C(0,o.boxStart[0],o.boxEnd[0]),a.xaxis.autorange=!1),d&&(C(1,o.boxStart[1],o.boxEnd[1]),a.yaxis.autorange=!1),a.relayoutCallback()):a.glplot.setDirty(),o.boxEnabled=!1,o.boxInited=!1):o.boxInited&&(o.boxInited=!1);break;case"pan":o.boxEnabled=!1,o.boxInited=!1,p?(o.panning||(o.dragStart[0]=v,o.dragStart[1]=x),Math.abs(o.dragStart[0]-v)<_&&(v=o.dragStart[0]),Math.abs(o.dragStart[1]-x)<_&&(x=o.dragStart[1]),w=(c-v)*(l[2]-l[0])/(f.viewBox[2]-f.viewBox[0]),d=(M-x)*(l[3]-l[1])/(f.viewBox[3]-f.viewBox[1]),l[0]+=w,l[2]+=w,l[1]+=d,l[3]+=d,a.setRanges(l),o.panning=!0,o.lastInputTime=Date.now(),s(),a.cameraChanged(),a.handleAnnotations()):o.panning&&(o.panning=!1,a.relayoutCallback());break}o.lastPos[0]=v,o.lastPos[1]=x}return o.wheelListener=u(r,function(p,v){if(!a.scrollZoom)return!1;var x=a.calcDataBox(),l=f.viewBox,b=o.lastPos[0],c=o.lastPos[1],M=Math.exp(5*v/(l[3]-l[1])),_=b/(l[2]-l[0])*(x[2]-x[0])+x[0],y=c/(l[3]-l[1])*(x[3]-x[1])+x[1];return x[0]=(x[0]-_)*M+_,x[2]=(x[2]-_)*M+_,x[1]=(x[1]-y)*M+y,x[3]=(x[3]-y)*M+y,a.setRanges(x),o.lastInputTime=Date.now(),s(),a.cameraChanged(),a.handleAnnotations(),a.relayoutCallback(),!0},!0),o}},{"../cartesian/constants":573,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],604:[function(t,P,R){var h=t("../cartesian/axes"),u=t("../../lib/str2rgbarray");function A(n){this.scene=n,this.gl=n.gl,this.pixelRatio=n.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var T=A.prototype,e=["xaxis","yaxis"];T.merge=function(n){this.titleEnable=!1,this.backgroundColor=u(n.plot_bgcolor);var a,r,f,o,s,m,g,p,v,x,l;for(x=0;x<2;++x){a=e[x];var b=a.charAt(0);for(r=n[this.scene[a]._name],f=r.title.text===this.scene.fullLayout._dfltTitle[b]?"":r.title.text,l=0;l<=2;l+=2)this.labelEnable[x+l]=!1,this.labels[x+l]=f,this.labelColor[x+l]=u(r.title.font.color),this.labelFont[x+l]=r.title.font.family,this.labelSize[x+l]=r.title.font.size,this.labelPad[x+l]=this.getLabelPad(a,r),this.tickEnable[x+l]=!1,this.tickColor[x+l]=u((r.tickfont||{}).color),this.tickAngle[x+l]=r.tickangle==="auto"?0:Math.PI*-r.tickangle/180,this.tickPad[x+l]=this.getTickPad(r),this.tickMarkLength[x+l]=0,this.tickMarkWidth[x+l]=r.tickwidth||0,this.tickMarkColor[x+l]=u(r.tickcolor),this.borderLineEnable[x+l]=!1,this.borderLineColor[x+l]=u(r.linecolor),this.borderLineWidth[x+l]=r.linewidth||0;g=this.hasSharedAxis(r),s=this.hasAxisInDfltPos(a,r)&&!g,m=this.hasAxisInAltrPos(a,r)&&!g,o=r.mirror||!1,p=g?String(o).indexOf("all")!==-1:!!o,v=g?o==="allticks":String(o).indexOf("ticks")!==-1,s?this.labelEnable[x]=!0:m&&(this.labelEnable[x+2]=!0),s?this.tickEnable[x]=r.showticklabels:m&&(this.tickEnable[x+2]=r.showticklabels),(s||p)&&(this.borderLineEnable[x]=r.showline),(m||p)&&(this.borderLineEnable[x+2]=r.showline),(s||v)&&(this.tickMarkLength[x]=this.getTickMarkLength(r)),(m||v)&&(this.tickMarkLength[x+2]=this.getTickMarkLength(r)),this.gridLineEnable[x]=r.showgrid,this.gridLineColor[x]=u(r.gridcolor),this.gridLineWidth[x]=r.gridwidth,this.zeroLineEnable[x]=r.zeroline,this.zeroLineColor[x]=u(r.zerolinecolor),this.zeroLineWidth[x]=r.zerolinewidth}},T.hasSharedAxis=function(n){var a=this.scene,r=a.fullLayout._subplots.gl2d,f=h.findSubplotsWithAxis(r,n);return f.indexOf(a.id)!==0},T.hasAxisInDfltPos=function(n,a){var r=a.side;if(n==="xaxis")return r==="bottom";if(n==="yaxis")return r==="left"},T.hasAxisInAltrPos=function(n,a){var r=a.side;if(n==="xaxis")return r==="top";if(n==="yaxis")return r==="right"},T.getLabelPad=function(n,a){var r=1.5,f=a.title.font.size,o=a.showticklabels;if(n==="xaxis")return a.side==="top"?-10+f*(r+(o?1:0)):-10+f*(r+(o?.5:0));if(n==="yaxis")return a.side==="right"?10+f*(r+(o?1:.5)):10+f*(r+(o?.5:0))},T.getTickPad=function(n){return n.ticks==="outside"?10+n.ticklen:15},T.getTickMarkLength=function(n){if(!n.ticks)return 0;var a=n.ticklen;return n.ticks==="inside"?-a:a};function i(n){return new A(n)}P.exports=i},{"../../lib/str2rgbarray":540,"../cartesian/axes":566}],605:[function(t,P,R){var h=t("../../plot_api/edit_types").overrideAll,u=t("./scene2d"),A=t("../layout_attributes"),T=t("../../constants/xmlns_namespaces"),e=t("../cartesian/constants"),i=t("../cartesian"),n=t("../../components/fx/layout_attributes"),a=t("../get_data").getSubplotData;R.name="gl2d",R.attr=["xaxis","yaxis"],R.idRoot=["x","y"],R.idRegex=e.idRegex,R.attrRegex=e.attrRegex,R.attributes=t("../cartesian/attributes"),R.supplyLayoutDefaults=function(r,f,o){f._has("cartesian")||i.supplyLayoutDefaults(r,f,o)},R.layoutAttrOverrides=h(i.layoutAttributes,"plot","from-root"),R.baseLayoutAttrOverrides=h({plot_bgcolor:A.plot_bgcolor,hoverlabel:n.hoverlabel},"plot","nested"),R.plot=function(f){for(var o=f._fullLayout,s=f._fullData,m=o._subplots.gl2d,g=0;g<m.length;g++){var p=m[g],v=o._plots[p],x=a(s,"gl2d",p),l=v._scene2d;l===void 0&&(l=new u({id:p,graphDiv:f,container:f.querySelector(".gl-container"),staticPlot:f._context.staticPlot,plotGlPixelRatio:f._context.plotGlPixelRatio},o),v._scene2d=l),l.plot(x,f.calcdata,o,f.layout)}},R.clean=function(r,f,o,s){for(var m=s._subplots.gl2d||[],g=0;g<m.length;g++){var p=m[g],v=s._plots[p];if(!!v._scene2d){var x=a(r,"gl2d",p);x.length===0&&(v._scene2d.destroy(),delete s._plots[p])}}i.clean.apply(this,arguments)},R.drawFramework=function(r){r._context.staticPlot||i.drawFramework(r)},R.toSVG=function(r){for(var f=r._fullLayout,o=f._subplots.gl2d,s=0;s<o.length;s++){var m=f._plots[o[s]],g=m._scene2d,p=g.toImage("png"),v=f._glimages.append("svg:image");v.attr({xmlns:T.svg,"xlink:href":p,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),g.destroy()}},R.updateFx=function(r){for(var f=r._fullLayout,o=f._subplots.gl2d,s=0;s<o.length;s++){var m=f._plots[o[s]]._scene2d;m.updateFx(f.dragmode)}}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../plot_api/edit_types":548,"../cartesian":578,"../cartesian/attributes":564,"../cartesian/constants":573,"../get_data":602,"../layout_attributes":619,"./scene2d":606}],606:[function(t,P,R){var h=t("../../registry"),u=t("../../plots/cartesian/axes"),A=t("../../components/fx"),T=t("../../../stackgl_modules").gl_plot2d,e=t("../../../stackgl_modules").gl_spikes2d,i=t("../../../stackgl_modules").gl_select_box,n=t("webgl-context"),a=t("./convert"),r=t("./camera"),f=t("../../lib/show_no_webgl_msg"),o=t("../cartesian/constraints"),s=o.enforce,m=o.clean,g=t("../cartesian/autorange").doAutoRange,p=t("../../components/dragelement/helpers"),v=p.drawMode,x=p.selectMode,l=["xaxis","yaxis"],b,c,M=t("../cartesian/constants").SUBPLOT_PATTERN;function _(d,C){this.container=d.container,this.graphDiv=d.graphDiv,this.pixelRatio=d.plotGlPixelRatio||window.devicePixelRatio,this.id=d.id,this.staticPlot=!!d.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(C),this.makeFramework(),!this.stopped&&(this.glplotOptions=a(this),this.glplotOptions.merge(C),this.glplot=T(this.glplotOptions),this.camera=r(this),this.traces={},this.spikes=e(this.glplot),this.selectBox=i(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}P.exports=_;var y=_.prototype;y.makeFramework=function(){if(this.staticPlot){if(!c&&(b=document.createElement("canvas"),c=n({canvas:b,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}),!c))throw new Error("Error creating static canvas/context for image server");this.canvas=b,this.gl=c}else{var d=this.container.querySelector(".gl-canvas-focus"),C=n({canvas:d,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!C){f(this),this.stopped=!0;return}this.canvas=d,this.gl=C}var S=this.canvas;S.style.width="100%",S.style.height="100%",S.style.position="absolute",S.style.top="0px",S.style.left="0px",S.style["pointer-events"]="none",this.updateSize(S);var E=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");E.style.position="absolute",E.style.top=E.style.left="0px",E.style.width=E.style.height="100%",E.style["z-index"]=20,E.style["pointer-events"]="none";var k=this.mouseContainer=document.createElement("div");k.style.position="absolute",k.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var B=this.container;B.appendChild(E),B.appendChild(k);var z=this;k.addEventListener("mouseout",function(){z.isMouseOver=!1,z.unhover()}),k.addEventListener("mouseover",function(){z.isMouseOver=!0})},y.toImage=function(d){d||(d="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(b),this.updateSize(this.canvas);var C=this.glplot.gl,S=C.drawingBufferWidth,E=C.drawingBufferHeight;C.clearColor(1,1,1,0),C.clear(C.COLOR_BUFFER_BIT|C.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),C.bindFramebuffer(C.FRAMEBUFFER,null);var k=new Uint8Array(S*E*4);C.readPixels(0,0,S,E,C.RGBA,C.UNSIGNED_BYTE,k);for(var B=0,z=E-1;B<z;++B,--z)for(var F=0;F<S;++F)for(var I=0;I<4;++I){var O=k[4*(S*B+F)+I];k[4*(S*B+F)+I]=k[4*(S*z+F)+I],k[4*(S*z+F)+I]=O}var N=document.createElement("canvas");N.width=S,N.height=E;var V=N.getContext("2d",{willReadFrequently:!0}),H=V.createImageData(S,E);H.data.set(k),V.putImageData(H,0,0);var j;switch(d){case"jpeg":j=N.toDataURL("image/jpeg");break;case"webp":j=N.toDataURL("image/webp");break;default:j=N.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(b),j},y.updateSize=function(d){d||(d=this.canvas);var C=this.pixelRatio,S=this.fullLayout,E=S.width,k=S.height,B=Math.ceil(C*E)|0,z=Math.ceil(C*k)|0;return(d.width!==B||d.height!==z)&&(d.width=B,d.height=z),d},y.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var d=[u.calcTicks(this.xaxis),u.calcTicks(this.yaxis)],C=0;C<2;++C)for(var S=0;S<d[C].length;++S)d[C][S].text=d[C][S].text+"";return d};function w(d,C){for(var S=0;S<2;++S){var E=d[S],k=C[S];if(E.length!==k.length)return!0;for(var B=0;B<E.length;++B)if(E[B].x!==k[B].x)return!0}return!1}y.updateRefs=function(d){this.fullLayout=d;var C=this.id.match(M),S="xaxis"+C[1],E="yaxis"+C[2];this.xaxis=this.fullLayout[S],this.yaxis=this.fullLayout[E]},y.relayoutCallback=function(){var d=this.graphDiv,C=this.xaxis,S=this.yaxis,E=d.layout,k={},B=k[C._name+".range"]=C.range.slice(),z=k[S._name+".range"]=S.range.slice();k[C._name+".autorange"]=C.autorange,k[S._name+".autorange"]=S.autorange,h.call("_storeDirectGUIEdit",d.layout,d._fullLayout._preGUI,k);var F=E[C._name];F.range=B,F.autorange=C.autorange;var I=E[S._name];I.range=z,I.autorange=S.autorange,k.lastInputTime=this.camera.lastInputTime,d.emit("plotly_relayout",k)},y.cameraChanged=function(){var d=this.camera;this.glplot.setDataBox(this.calcDataBox());var C=this.computeTickMarks(),S=this.glplotOptions.ticks;w(C,S)&&(this.glplotOptions.ticks=C,this.glplotOptions.dataBox=d.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},y.handleAnnotations=function(){for(var d=this.graphDiv,C=this.fullLayout.annotations,S=0;S<C.length;S++){var E=C[S];E.xref===this.xaxis._id&&E.yref===this.yaxis._id&&h.getComponentMethod("annotations","drawOne")(d,S)}},y.destroy=function(){if(!!this.glplot){var d=this.traces;d&&Object.keys(d).map(function(C){d[C].dispose(),delete d[C]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},y.plot=function(d,C,S){var E=this.glplot;this.updateRefs(S),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(d,C),this.updateFx(S.dragmode);var k=S.width,B=S.height;this.updateSize(this.canvas);var z=this.glplotOptions;z.merge(S),z.screenBox=[0,0,k,B];var F={_fullLayout:{_axisConstraintGroups:S._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:S._size}};m(F,this.xaxis),m(F,this.yaxis);var I=S._size,O=this.xaxis.domain,N=this.yaxis.domain;z.viewBox=[I.l+O[0]*I.w,I.b+N[0]*I.h,k-I.r-(1-O[1])*I.w,B-I.t-(1-N[1])*I.h],this.mouseContainer.style.width=I.w*(O[1]-O[0])+"px",this.mouseContainer.style.height=I.h*(N[1]-N[0])+"px",this.mouseContainer.height=I.h*(N[1]-N[0]),this.mouseContainer.style.left=I.l+O[0]*I.w+"px",this.mouseContainer.style.top=I.t+(1-N[1])*I.h+"px";var V,H;for(H=0;H<2;++H)V=this[l[H]],V._length=z.viewBox[H+2]-z.viewBox[H],g(this.graphDiv,V),V.setScale();s(F),z.ticks=this.computeTickMarks(),z.dataBox=this.calcDataBox(),z.merge(S),E.update(z),this.glplot.draw()},y.calcDataBox=function(){var d=this.xaxis,C=this.yaxis,S=d.range,E=C.range,k=d.r2l,B=C.r2l;return[k(S[0]),B(E[0]),k(S[1]),B(E[1])]},y.setRanges=function(d){var C=this.xaxis,S=this.yaxis,E=C.l2r,k=S.l2r;C.range=[E(d[0]),E(d[2])],S.range=[k(d[1]),k(d[3])]},y.updateTraces=function(d,C){var S=Object.keys(this.traces),E,k,B;this.fullData=d;e:for(E=0;E<S.length;E++){var z=S[E],F=this.traces[z];for(k=0;k<d.length;k++)if(B=d[k],B.uid===z&&B.type===F.type)continue e;F.dispose(),delete this.traces[z]}for(E=0;E<d.length;E++){B=d[E];var I=C[E],O=this.traces[B.uid];O?O.update(B,I):(O=B._module.plot(this,B,I),this.traces[B.uid]=O)}this.glplot.objects.sort(function(N,V){return N._trace.index-V._trace.index})},y.updateFx=function(d){x(d)||v(d)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),d==="pan"?this.mouseContainer.style.cursor="move":d==="zoom"?this.mouseContainer.style.cursor="crosshair":this.mouseContainer.style.cursor=null},y.emitPointAction=function(d,C){for(var S=d.trace.uid,E=d.pointIndex,k,B=0;B<this.fullData.length;B++)this.fullData[B].uid===S&&(k=this.fullData[B]);var z={x:d.traceCoord[0],y:d.traceCoord[1],curveNumber:k.index,pointNumber:E,data:k._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};A.appendArrayPointValue(z,k,E),this.graphDiv.emit(C,{points:[z]})},y.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var d=this.glplot,C=this.camera,S=C.mouseListener,E=this.lastButtonState===1&&S.buttons===0,k=this.fullLayout;this.lastButtonState=S.buttons,this.cameraChanged();var B=S.x*d.pixelRatio,z=this.canvas.height-d.pixelRatio*S.y,F;if(C.boxEnabled&&k.dragmode==="zoom"){this.selectBox.enabled=!0;for(var I=this.selectBox.selectBox=[Math.min(C.boxStart[0],C.boxEnd[0]),Math.min(C.boxStart[1],C.boxEnd[1]),Math.max(C.boxStart[0],C.boxEnd[0]),Math.max(C.boxStart[1],C.boxEnd[1])],O=0;O<2;O++)C.boxStart[O]===C.boxEnd[O]&&(I[O]=d.dataBox[O],I[O+2]=d.dataBox[O+2]);d.setDirty()}else if(!C.panning&&this.isMouseOver){this.selectBox.enabled=!1;var N=k._size,V=this.xaxis.domain,H=this.yaxis.domain;F=d.pick(B/d.pixelRatio+N.l+V[0]*N.w,z/d.pixelRatio-(N.t+(1-H[1])*N.h));var j=F&&F.object._trace.handlePick(F);if(j&&E&&this.emitPointAction(j,"plotly_click"),F&&F.object._trace.hoverinfo!=="skip"&&k.hovermode&&j&&(!this.lastPickResult||this.lastPickResult.traceUid!==j.trace.uid||this.lastPickResult.dataCoord[0]!==j.dataCoord[0]||this.lastPickResult.dataCoord[1]!==j.dataCoord[1])){var Z=j;this.lastPickResult={traceUid:j.trace?j.trace.uid:null,dataCoord:j.dataCoord.slice()},this.spikes.update({center:F.dataCoord}),Z.screenCoord=[((d.viewBox[2]-d.viewBox[0])*(F.dataCoord[0]-d.dataBox[0])/(d.dataBox[2]-d.dataBox[0])+d.viewBox[0])/d.pixelRatio,(this.canvas.height-(d.viewBox[3]-d.viewBox[1])*(F.dataCoord[1]-d.dataBox[1])/(d.dataBox[3]-d.dataBox[1])-d.viewBox[1])/d.pixelRatio],this.emitPointAction(j,"plotly_hover");var X=this.fullData[Z.trace.index]||{},re=Z.pointIndex,ue=A.castHoverinfo(X,k,re);if(ue&&ue!=="all"){var K=ue.split("+");K.indexOf("x")===-1&&(Z.traceCoord[0]=void 0),K.indexOf("y")===-1&&(Z.traceCoord[1]=void 0),K.indexOf("z")===-1&&(Z.traceCoord[2]=void 0),K.indexOf("text")===-1&&(Z.textLabel=void 0),K.indexOf("name")===-1&&(Z.name=void 0)}A.loneHover({x:Z.screenCoord[0],y:Z.screenCoord[1],xLabel:this.hoverFormatter("xaxis",Z.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",Z.traceCoord[1]),zLabel:Z.traceCoord[2],text:Z.textLabel,name:Z.name,color:A.castHoverOption(X,re,"bgcolor")||Z.color,borderColor:A.castHoverOption(X,re,"bordercolor"),fontFamily:A.castHoverOption(X,re,"font.family"),fontSize:A.castHoverOption(X,re,"font.size"),fontColor:A.castHoverOption(X,re,"font.color"),nameLength:A.castHoverOption(X,re,"namelength"),textAlign:A.castHoverOption(X,re,"align")},{container:this.svgContainer,gd:this.graphDiv})}}F||this.unhover(),d.draw()}},y.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),A.loneUnhover(this.svgContainer))},y.hoverFormatter=function(d,C){if(C!==void 0){var S=this[d];return u.tickText(S,S.c2l(C),"hover").text}}},{"../../../stackgl_modules":1133,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../lib/show_no_webgl_msg":537,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/constants":573,"../cartesian/constraints":574,"./camera":603,"./convert":604,"webgl-context":332}],607:[function(t,P,R){var h=t("../../plot_api/edit_types").overrideAll,u=t("../../components/fx/layout_attributes"),A=t("./scene"),T=t("../get_data").getSubplotData,e=t("../../lib"),i=t("../../constants/xmlns_namespaces"),n="gl3d",a="scene";R.name=n,R.attr=a,R.idRoot=a,R.idRegex=R.attrRegex=e.counterRegex("scene"),R.attributes=t("./layout/attributes"),R.layoutAttributes=t("./layout/layout_attributes"),R.baseLayoutAttrOverrides=h({hoverlabel:u.hoverlabel},"plot","nested"),R.supplyLayoutDefaults=t("./layout/defaults"),R.plot=function(f){for(var o=f._fullLayout,s=f._fullData,m=o._subplots[n],g=0;g<m.length;g++){var p=m[g],v=T(s,n,p),x=o[p],l=x.camera,b=x._scene;b||(b=new A({id:p,graphDiv:f,container:f.querySelector(".gl-container"),staticPlot:f._context.staticPlot,plotGlPixelRatio:f._context.plotGlPixelRatio,camera:l},o),x._scene=b),b.viewInitial||(b.viewInitial={up:{x:l.up.x,y:l.up.y,z:l.up.z},eye:{x:l.eye.x,y:l.eye.y,z:l.eye.z},center:{x:l.center.x,y:l.center.y,z:l.center.z}}),b.plot(v,o,f.layout)}},R.clean=function(r,f,o,s){for(var m=s._subplots[n]||[],g=0;g<m.length;g++){var p=m[g];!f[p]&&!!s[p]._scene&&(s[p]._scene.destroy(),s._infolayer&&s._infolayer.selectAll(".annotation-"+p).remove())}},R.toSVG=function(r){for(var f=r._fullLayout,o=f._subplots[n],s=f._size,m=0;m<o.length;m++){var g=f[o[m]],p=g.domain,v=g._scene,x=v.toImage("png"),l=f._glimages.append("svg:image");l.attr({xmlns:i.svg,"xlink:href":x,x:s.l+s.w*p.x[0],y:s.t+s.h*(1-p.y[1]),width:s.w*(p.x[1]-p.x[0]),height:s.h*(p.y[1]-p.y[0]),preserveAspectRatio:"none"}),v.destroy()}},R.cleanId=function(f){if(!!f.match(/^scene[0-9]*$/)){var o=f.substr(5);return o==="1"&&(o=""),a+o}},R.updateFx=function(r){for(var f=r._fullLayout,o=f._subplots[n],s=0;s<o.length;s++){var m=f[o[s]]._scene;m.updateFx(f.dragmode,f.hovermode)}}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../plot_api/edit_types":548,"../get_data":602,"./layout/attributes":608,"./layout/defaults":612,"./layout/layout_attributes":613,"./scene":617}],608:[function(t,P,R){P.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],609:[function(t,P,R){var h=t("../../../components/color"),u=t("../../cartesian/layout_attributes"),A=t("../../../lib/extend").extendFlat,T=t("../../../plot_api/edit_types").overrideAll;P.exports=T({visible:u.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:h.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:u.color,categoryorder:u.categoryorder,categoryarray:u.categoryarray,title:{text:u.title.text,font:u.title.font},type:A({},u.type,{values:["-","linear","log","date","category"]}),autotypenumbers:u.autotypenumbers,autorange:u.autorange,rangemode:u.rangemode,range:A({},u.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:u.tickmode,nticks:u.nticks,tick0:u.tick0,dtick:u.dtick,tickvals:u.tickvals,ticktext:u.ticktext,ticks:u.ticks,mirror:u.mirror,ticklen:u.ticklen,tickwidth:u.tickwidth,tickcolor:u.tickcolor,showticklabels:u.showticklabels,tickfont:u.tickfont,tickangle:u.tickangle,tickprefix:u.tickprefix,showtickprefix:u.showtickprefix,ticksuffix:u.ticksuffix,showticksuffix:u.showticksuffix,showexponent:u.showexponent,exponentformat:u.exponentformat,minexponent:u.minexponent,separatethousands:u.separatethousands,tickformat:u.tickformat,tickformatstops:u.tickformatstops,hoverformat:u.hoverformat,showline:u.showline,linecolor:u.linecolor,linewidth:u.linewidth,showgrid:u.showgrid,gridcolor:A({},u.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:u.gridwidth,zeroline:u.zeroline,zerolinecolor:u.zerolinecolor,zerolinewidth:u.zerolinewidth,_deprecated:{title:u._deprecated.title,titlefont:u._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":367,"../../../lib/extend":505,"../../../plot_api/edit_types":548,"../../cartesian/layout_attributes":579}],610:[function(t,P,R){var h=t("tinycolor2").mix,u=t("../../../lib"),A=t("../../../plot_api/plot_template"),T=t("./axis_attributes"),e=t("../../cartesian/type_defaults"),i=t("../../cartesian/axis_defaults"),n=["xaxis","yaxis","zaxis"],a=100*(204-68)/(255-68);P.exports=function(f,o,s){var m,g;function p(l,b){return u.coerce(m,g,T,l,b)}for(var v=0;v<n.length;v++){var x=n[v];m=f[x]||{},g=A.newContainer(o,x),g._id=x[0]+s.scene,g._name=x,e(m,g,p,s),i(m,g,p,{font:s.font,letter:x[0],data:s.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelstep:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:s.bgColor,calendar:s.calendar},s.fullLayout),p("gridcolor",h(g.color,s.bgColor,a).toRgbString()),p("title.text",x[0]),g.setScale=u.noop,p("showspikes")&&(p("spikesides"),p("spikethickness"),p("spikecolor",g.color)),p("showaxeslabels"),p("showbackground")&&p("backgroundcolor")}}},{"../../../lib":515,"../../../plot_api/plot_template":555,"../../cartesian/axis_defaults":568,"../../cartesian/type_defaults":591,"./axis_attributes":609,tinycolor2:313}],611:[function(t,P,R){var h=t("../../../lib/str2rgbarray"),u=t("../../../lib"),A=["xaxis","yaxis","zaxis"];function T(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}var e=T.prototype;e.merge=function(n,a){for(var r=this,f=0;f<3;++f){var o=a[A[f]];if(!o.visible){r.tickEnable[f]=!1,r.labelEnable[f]=!1,r.lineEnable[f]=!1,r.lineTickEnable[f]=!1,r.gridEnable[f]=!1,r.zeroEnable[f]=!1,r.backgroundEnable[f]=!1;continue}r.labels[f]=n._meta?u.templateString(o.title.text,n._meta):o.title.text,"font"in o.title&&(o.title.font.color&&(r.labelColor[f]=h(o.title.font.color)),o.title.font.family&&(r.labelFont[f]=o.title.font.family),o.title.font.size&&(r.labelSize[f]=o.title.font.size)),"showline"in o&&(r.lineEnable[f]=o.showline),"linecolor"in o&&(r.lineColor[f]=h(o.linecolor)),"linewidth"in o&&(r.lineWidth[f]=o.linewidth),"showgrid"in o&&(r.gridEnable[f]=o.showgrid),"gridcolor"in o&&(r.gridColor[f]=h(o.gridcolor)),"gridwidth"in o&&(r.gridWidth[f]=o.gridwidth),o.type==="log"?r.zeroEnable[f]=!1:"zeroline"in o&&(r.zeroEnable[f]=o.zeroline),"zerolinecolor"in o&&(r.zeroLineColor[f]=h(o.zerolinecolor)),"zerolinewidth"in o&&(r.zeroLineWidth[f]=o.zerolinewidth),"ticks"in o&&!!o.ticks?r.lineTickEnable[f]=!0:r.lineTickEnable[f]=!1,"ticklen"in o&&(r.lineTickLength[f]=r._defaultLineTickLength[f]=o.ticklen),"tickcolor"in o&&(r.lineTickColor[f]=h(o.tickcolor)),"tickwidth"in o&&(r.lineTickWidth[f]=o.tickwidth),"tickangle"in o&&(r.tickAngle[f]=o.tickangle==="auto"?-3600:Math.PI*-o.tickangle/180),"showticklabels"in o&&(r.tickEnable[f]=o.showticklabels),"tickfont"in o&&(o.tickfont.color&&(r.tickColor[f]=h(o.tickfont.color)),o.tickfont.family&&(r.tickFont[f]=o.tickfont.family),o.tickfont.size&&(r.tickSize[f]=o.tickfont.size)),"mirror"in o?["ticks","all","allticks"].indexOf(o.mirror)!==-1?(r.lineTickMirror[f]=!0,r.lineMirror[f]=!0):o.mirror===!0?(r.lineTickMirror[f]=!1,r.lineMirror[f]=!0):(r.lineTickMirror[f]=!1,r.lineMirror[f]=!1):r.lineMirror[f]=!1,"showbackground"in o&&o.showbackground!==!1?(r.backgroundEnable[f]=!0,r.backgroundColor[f]=h(o.backgroundcolor)):r.backgroundEnable[f]=!1}};function i(n,a){var r=new T;return r.merge(n,a),r}P.exports=i},{"../../../lib":515,"../../../lib/str2rgbarray":540}],612:[function(t,P,R){var h=t("../../../lib"),u=t("../../../components/color"),A=t("../../../registry"),T=t("../../subplot_defaults"),e=t("./axis_defaults"),i=t("./layout_attributes"),n=t("../../get_data").getSubplotData,a="gl3d";P.exports=function(o,s,m){var g=s._basePlotModules.length>1;function p(v){if(!g){var x=h.validate(o[v],i[v]);if(x)return o[v]}}T(o,s,m,{type:a,attributes:i,handleDefaults:r,fullLayout:s,font:s.font,fullData:m,getDfltFromLayout:p,autotypenumbersDflt:s.autotypenumbers,paper_bgcolor:s.paper_bgcolor,calendar:s.calendar})};function r(f,o,s,m){for(var g=s("bgcolor"),p=u.combine(g,m.paper_bgcolor),v=["up","center","eye"],x=0;x<v.length;x++)s("camera."+v[x]+".x"),s("camera."+v[x]+".y"),s("camera."+v[x]+".z");s("camera.projection.type");var l=!!s("aspectratio.x")&&!!s("aspectratio.y")&&!!s("aspectratio.z"),b=l?"manual":"auto",c=s("aspectmode",b);l||(f.aspectratio=o.aspectratio={x:1,y:1,z:1},c==="manual"&&(o.aspectmode="auto"),f.aspectmode=o.aspectmode);var M=n(m.fullData,a,m.id);e(f,o,{font:m.font,scene:m.id,data:M,bgColor:p,calendar:m.calendar,autotypenumbersDflt:m.autotypenumbersDflt,fullLayout:m.fullLayout}),A.getComponentMethod("annotations3d","handleDefaults")(f,o,m);var _=m.getDfltFromLayout("dragmode");if(_!==!1&&!_)if(_="orbit",f.camera&&f.camera.up){var y=f.camera.up.x,w=f.camera.up.y,d=f.camera.up.z;d!==0&&(!y||!w||!d||d/Math.sqrt(y*y+w*w+d*d)>.999)&&(_="turntable")}else _="turntable";s("dragmode",_),s("hovermode",m.getDfltFromLayout("hovermode"))}},{"../../../components/color":367,"../../../lib":515,"../../../registry":647,"../../get_data":602,"../../subplot_defaults":641,"./axis_defaults":610,"./layout_attributes":613}],613:[function(t,P,R){var h=t("./axis_attributes"),u=t("../../domain").attributes,A=t("../../../lib/extend").extendFlat,T=t("../../../lib").counterRegex;function e(i,n,a){return{x:{valType:"number",dflt:i,editType:"camera"},y:{valType:"number",dflt:n,editType:"camera"},z:{valType:"number",dflt:a,editType:"camera"},editType:"camera"}}P.exports={_arrayAttrRegexps:[T("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:A(e(0,0,1),{}),center:A(e(0,0,0),{}),eye:A(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:u({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:h,yaxis:h,zaxis:h,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":515,"../../../lib/extend":505,"../../domain":593,"./axis_attributes":609}],614:[function(t,P,R){var h=t("../../../lib/str2rgbarray"),u=["xaxis","yaxis","zaxis"];function A(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}var T=A.prototype;T.merge=function(i){for(var n=0;n<3;++n){var a=i[u[n]];if(!a.visible){this.enabled[n]=!1,this.drawSides[n]=!1;continue}this.enabled[n]=a.showspikes,this.colors[n]=h(a.spikecolor),this.drawSides[n]=a.spikesides,this.lineWidth[n]=a.spikethickness}};function e(i){var n=new A;return n.merge(i),n}P.exports=e},{"../../../lib/str2rgbarray":540}],615:[function(t,P,R){P.exports=e;var h=t("../../cartesian/axes"),u=t("../../../lib"),A=["xaxis","yaxis","zaxis"];function T(i){for(var n=new Array(3),a=0;a<3;++a){for(var r=i[a],f=new Array(r.length),o=0;o<r.length;++o)f[o]=r[o].x;n[a]=f}return n}function e(i){for(var n=i.axesOptions,a=i.glplot.axesPixels,r=i.fullSceneLayout,f=[[],[],[]],o=0;o<3;++o){var s=r[A[o]];if(s._length=(a[o].hi-a[o].lo)*a[o].pixelsPerDataUnit/i.dataScale[o],Math.abs(s._length)===1/0||isNaN(s._length))f[o]=[];else{s._input_range=s.range.slice(),s.range[0]=a[o].lo/i.dataScale[o],s.range[1]=a[o].hi/i.dataScale[o],s._m=1/(i.dataScale[o]*a[o].pixelsPerDataUnit),s.range[0]===s.range[1]&&(s.range[0]-=1,s.range[1]+=1);var m=s.tickmode;if(s.tickmode==="auto"){s.tickmode="linear";var g=s.nticks||u.constrain(s._length/40,4,9);h.autoTicks(s,Math.abs(s.range[1]-s.range[0])/g)}for(var p=h.calcTicks(s,{msUTC:!0}),v=0;v<p.length;++v)p[v].x=p[v].x*i.dataScale[o],s.type==="date"&&(p[v].text=p[v].text.replace(/\<br\>/g," "));f[o]=p,s.tickmode=m}}n.ticks=f;for(var o=0;o<3;++o){.5*(i.glplot.bounds[0][o]+i.glplot.bounds[1][o]);for(var v=0;v<2;++v)n.bounds[v][o]=i.glplot.bounds[v][o]}i.contourLevels=T(f)}},{"../../../lib":515,"../../cartesian/axes":566}],616:[function(t,P,R){function h(A,T){var e=[0,0,0,0],i,n;for(i=0;i<4;++i)for(n=0;n<4;++n)e[n]+=A[4*i+n]*T[i];return e}function u(A,T){var e=h(A.projection,h(A.view,h(A.model,[T[0],T[1],T[2],1])));return e}P.exports=u},{}],617:[function(t,P,R){var h=t("../../../stackgl_modules").gl_plot3d,u=h.createCamera,A=h.createScene,T=t("webgl-context"),e=t("has-passive-events"),i=t("../../registry"),n=t("../../lib"),a=n.preserveDrawingBuffer(),r=t("../../plots/cartesian/axes"),f=t("../../components/fx"),o=t("../../lib/str2rgbarray"),s=t("../../lib/show_no_webgl_msg"),m=t("./project"),g=t("./layout/convert"),p=t("./layout/spikes"),v=t("./layout/tick_marks"),x,l;function b(k,B){var z=document.createElement("div"),F=k.container;this.graphDiv=k.graphDiv;var I=document.createElementNS("http://www.w3.org/2000/svg","svg");I.style.position="absolute",I.style.top=I.style.left="0px",I.style.width=I.style.height="100%",I.style["z-index"]=20,I.style["pointer-events"]="none",z.appendChild(I),this.svgContainer=I,z.id=k.id,z.style.position="absolute",z.style.top=z.style.left="0px",z.style.width=z.style.height="100%",F.appendChild(z),this.fullLayout=B,this.id=k.id||"scene",this.fullSceneLayout=B[this.id],this.plotArgs=[[],{},{}],this.axesOptions=g(B,B[this.id]),this.spikeOptions=p(B[this.id]),this.container=z,this.staticMode=!!k.staticPlot,this.pixelRatio=this.pixelRatio||k.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=i.getComponentMethod("annotations3d","convert"),this.drawAnnotations=i.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var c=b.prototype;c.prepareOptions=function(){var k=this,B={canvas:k.canvas,gl:k.gl,glOptions:{preserveDrawingBuffer:a,premultipliedAlpha:!0,antialias:!0},container:k.container,axes:k.axesOptions,spikes:k.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:k.camera,pixelRatio:k.pixelRatio};if(k.staticMode){if(!l&&(x=document.createElement("canvas"),l=T({canvas:x,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}),!l))throw new Error("error creating static canvas/context for image server");B.gl=l,B.canvas=x}return B};var M=!0;c.tryCreatePlot=function(){var k=this,B=k.prepareOptions(),z=!0;try{k.glplot=A(B)}catch{if(k.staticMode||!M||a)z=!1;else{n.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{a=B.glOptions.preserveDrawingBuffer=!0,k.glplot=A(B)}catch{a=B.glOptions.preserveDrawingBuffer=!1,z=!1}}}return M=!1,z},c.initializeGLCamera=function(){var k=this,B=k.fullSceneLayout.camera,z=B.projection.type==="orthographic";k.camera=u(k.container,{center:[B.center.x,B.center.y,B.center.z],eye:[B.eye.x,B.eye.y,B.eye.z],up:[B.up.x,B.up.y,B.up.z],_ortho:z,zoomMin:.01,zoomMax:100,mode:"orbit"})},c.initializeGLPlot=function(){var k=this;k.initializeGLCamera();var B=k.tryCreatePlot();if(!B)return s(k);k.traces={},k.make4thDimension();var z=k.graphDiv,F=z.layout,I=function(){var N={};return k.isCameraChanged(F)&&(N[k.id+".camera"]=k.getCamera()),k.isAspectChanged(F)&&(N[k.id+".aspectratio"]=k.glplot.getAspectratio(),F[k.id].aspectmode!=="manual"&&(k.fullSceneLayout.aspectmode=F[k.id].aspectmode=N[k.id+".aspectmode"]="manual")),N},O=function(N){if(N.fullSceneLayout.dragmode!==!1){var V=I();N.saveLayout(F),N.graphDiv.emit("plotly_relayout",V)}};return k.glplot.canvas&&(k.glplot.canvas.addEventListener("mouseup",function(){O(k)}),k.glplot.canvas.addEventListener("wheel",function(N){if(z._context._scrollZoom.gl3d){if(k.camera._ortho){var V=N.deltaX>N.deltaY?1.1:.9090909090909091,H=k.glplot.getAspectratio();k.glplot.setAspectratio({x:V*H.x,y:V*H.y,z:V*H.z})}O(k)}},e?{passive:!1}:!1),k.glplot.canvas.addEventListener("mousemove",function(){if(k.fullSceneLayout.dragmode!==!1&&k.camera.mouseListener.buttons!==0){var N=I();k.graphDiv.emit("plotly_relayouting",N)}}),k.staticMode||k.glplot.canvas.addEventListener("webglcontextlost",function(N){z&&z.emit&&z.emit("plotly_webglcontextlost",{event:N,layer:k.id})},!1)),k.glplot.oncontextloss=function(){k.recoverContext()},k.glplot.onrender=function(){k.render()},!0},c.render=function(){var k=this,B=k.graphDiv,z,F=k.svgContainer,I=k.container.getBoundingClientRect();B._fullLayout._calcInverseTransform(B);var O=B._fullLayout._invScaleX,N=B._fullLayout._invScaleY,V=I.width*O,H=I.height*N;F.setAttributeNS(null,"viewBox","0 0 "+V+" "+H),F.setAttributeNS(null,"width",V),F.setAttributeNS(null,"height",H),v(k),k.glplot.axes.update(k.axesOptions);for(var j=Object.keys(k.traces),Z=null,X=k.glplot.selection,re=0;re<j.length;++re)z=k.traces[j[re]],z.data.hoverinfo!=="skip"&&z.handlePick(X)&&(Z=z),z.setContourLevels&&z.setContourLevels();function ue(xe,oe,he){var be=k.fullSceneLayout[xe+"axis"];return be.type!=="log"&&(oe=be.d2l(oe)),r.hoverLabelText(be,oe,he)}if(Z!==null){var K=m(k.glplot.cameraParams,X.dataCoordinate);z=Z.data;var te=B._fullData[z.index],G=X.index,Y={xLabel:ue("x",X.traceCoordinate[0],z.xhoverformat),yLabel:ue("y",X.traceCoordinate[1],z.yhoverformat),zLabel:ue("z",X.traceCoordinate[2],z.zhoverformat)},ee=f.castHoverinfo(te,k.fullLayout,G),ne=(ee||"").split("+"),J=ee&&ee==="all";!te.hovertemplate&&!J&&(ne.indexOf("x")===-1&&(Y.xLabel=void 0),ne.indexOf("y")===-1&&(Y.yLabel=void 0),ne.indexOf("z")===-1&&(Y.zLabel=void 0),ne.indexOf("text")===-1&&(X.textLabel=void 0),ne.indexOf("name")===-1&&(Z.name=void 0));var q,ae=[];z.type==="cone"||z.type==="streamtube"?(Y.uLabel=ue("x",X.traceCoordinate[3],z.uhoverformat),(J||ne.indexOf("u")!==-1)&&ae.push("u: "+Y.uLabel),Y.vLabel=ue("y",X.traceCoordinate[4],z.vhoverformat),(J||ne.indexOf("v")!==-1)&&ae.push("v: "+Y.vLabel),Y.wLabel=ue("z",X.traceCoordinate[5],z.whoverformat),(J||ne.indexOf("w")!==-1)&&ae.push("w: "+Y.wLabel),Y.normLabel=X.traceCoordinate[6].toPrecision(3),(J||ne.indexOf("norm")!==-1)&&ae.push("norm: "+Y.normLabel),z.type==="streamtube"&&(Y.divergenceLabel=X.traceCoordinate[7].toPrecision(3),(J||ne.indexOf("divergence")!==-1)&&ae.push("divergence: "+Y.divergenceLabel)),X.textLabel&&ae.push(X.textLabel),q=ae.join("<br>")):z.type==="isosurface"||z.type==="volume"?(Y.valueLabel=r.hoverLabelText(k._mockAxis,k._mockAxis.d2l(X.traceCoordinate[3]),z.valuehoverformat),ae.push("value: "+Y.valueLabel),X.textLabel&&ae.push(X.textLabel),q=ae.join("<br>")):q=X.textLabel;var le={x:X.traceCoordinate[0],y:X.traceCoordinate[1],z:X.traceCoordinate[2],data:te._input,fullData:te,curveNumber:te.index,pointNumber:G};f.appendArrayPointValue(le,te,G),z._module.eventData&&(le=te._module.eventData(le,X,te,{},G));var ie={points:[le]};if(k.fullSceneLayout.hovermode){var se=[];f.loneHover({trace:te,x:(.5+.5*K[0]/K[3])*V,y:(.5-.5*K[1]/K[3])*H,xLabel:Y.xLabel,yLabel:Y.yLabel,zLabel:Y.zLabel,text:q,name:Z.name,color:f.castHoverOption(te,G,"bgcolor")||Z.color,borderColor:f.castHoverOption(te,G,"bordercolor"),fontFamily:f.castHoverOption(te,G,"font.family"),fontSize:f.castHoverOption(te,G,"font.size"),fontColor:f.castHoverOption(te,G,"font.color"),nameLength:f.castHoverOption(te,G,"namelength"),textAlign:f.castHoverOption(te,G,"align"),hovertemplate:n.castOption(te,G,"hovertemplate"),hovertemplateLabels:n.extendFlat({},le,Y),eventData:[le]},{container:F,gd:B,inOut_bbox:se}),le.bbox=se[0]}X.buttons&&X.distance<5?B.emit("plotly_click",ie):B.emit("plotly_hover",ie),this.oldEventData=ie}else f.loneUnhover(F),this.oldEventData&&B.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;k.drawAnnotations(k)},c.recoverContext=function(){var k=this;k.glplot.dispose();var B=function(){if(k.glplot.gl.isContextLost()){requestAnimationFrame(B);return}if(!k.initializeGLPlot()){n.error("Catastrophic and unrecoverable WebGL error. Context lost.");return}k.plot.apply(k,k.plotArgs)};requestAnimationFrame(B)};var _=["xaxis","yaxis","zaxis"];function y(k,B,z){for(var F=k.fullSceneLayout,I=0;I<3;I++){var O=_[I],N=O.charAt(0),V=F[O],H=B[N],j=B[N+"calendar"],Z=B["_"+N+"length"];if(!n.isArrayOrTypedArray(H))z[0][I]=Math.min(z[0][I],0),z[1][I]=Math.max(z[1][I],Z-1);else for(var X,re=0;re<(Z||H.length);re++)if(n.isArrayOrTypedArray(H[re]))for(var ue=0;ue<H[re].length;++ue)X=V.d2l(H[re][ue],0,j),!isNaN(X)&&isFinite(X)&&(z[0][I]=Math.min(z[0][I],X),z[1][I]=Math.max(z[1][I],X));else X=V.d2l(H[re],0,j),!isNaN(X)&&isFinite(X)&&(z[0][I]=Math.min(z[0][I],X),z[1][I]=Math.max(z[1][I],X))}}function w(k,B){for(var z=k.fullSceneLayout,F=z.annotations||[],I=0;I<3;I++)for(var O=_[I],N=O.charAt(0),V=z[O],H=0;H<F.length;H++){var j=F[H];if(j.visible){var Z=V.r2l(j[N]);!isNaN(Z)&&isFinite(Z)&&(B[0][I]=Math.min(B[0][I],Z),B[1][I]=Math.max(B[1][I],Z))}}}c.plot=function(k,B,z){var F=this;if(F.plotArgs=[k,B,z],F.glplot.contextLost)return;var I,O,N,V,H,j,Z=B[F.id],X=z[F.id];F.fullLayout=B,F.fullSceneLayout=Z,F.axesOptions.merge(B,Z),F.spikeOptions.merge(Z),F.setViewport(Z),F.updateFx(Z.dragmode,Z.hovermode),F.camera.enableWheel=F.graphDiv._context._scrollZoom.gl3d,F.glplot.setClearColor(o(Z.bgcolor)),F.setConvert(H),k?Array.isArray(k)||(k=[k]):k=[];var re=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(N=0;N<k.length;++N)I=k[N],!(I.visible!==!0||I._length===0)&&y(this,I,re);w(this,re);var ue=[1,1,1];for(V=0;V<3;++V)re[1][V]===re[0][V]?ue[V]=1:ue[V]=1/(re[1][V]-re[0][V]);for(F.dataScale=ue,F.convertAnnotations(this),N=0;N<k.length;++N)I=k[N],!(I.visible!==!0||I._length===0)&&(O=F.traces[I.uid],O?O.data.type===I.type?O.update(I):(O.dispose(),O=I._module.plot(this,I),F.traces[I.uid]=O):(O=I._module.plot(this,I),F.traces[I.uid]=O),O.name=I.name);var K=Object.keys(F.traces);e:for(N=0;N<K.length;++N){for(V=0;V<k.length;++V)if(k[V].uid===K[N]&&k[V].visible===!0&&k[V]._length!==0)continue e;O=F.traces[K[N]],O.dispose(),delete F.traces[K[N]]}F.glplot.objects.sort(function(Ce,He){return Ce._trace.data.index-He._trace.data.index});var te=[[0,0,0],[0,0,0]],G={};for(N=0;N<3;++N){if(H=Z[_[N]],j=H.type,j in G?(G[j].acc*=ue[N],G[j].count+=1):G[j]={acc:ue[N],count:1},H.autorange){te[0][N]=1/0,te[1][N]=-1/0;var Y=F.glplot.objects,ee=F.fullSceneLayout.annotations||[],ne=H._name.charAt(0);for(V=0;V<Y.length;V++){var J=Y[V],q=J.bounds,ae=J._trace.data._pad||0;J.constructor.name==="ErrorBars"&&H._lowerLogErrorBound?te[0][N]=Math.min(te[0][N],H._lowerLogErrorBound):te[0][N]=Math.min(te[0][N],q[0][N]/ue[N]-ae),te[1][N]=Math.max(te[1][N],q[1][N]/ue[N]+ae)}for(V=0;V<ee.length;V++){var le=ee[V];if(le.visible){var ie=H.r2l(le[ne]);te[0][N]=Math.min(te[0][N],ie),te[1][N]=Math.max(te[1][N],ie)}}if("rangemode"in H&&H.rangemode==="tozero"&&(te[0][N]=Math.min(te[0][N],0),te[1][N]=Math.max(te[1][N],0)),te[0][N]>te[1][N])te[0][N]=-1,te[1][N]=1;else{var se=te[1][N]-te[0][N];te[0][N]-=se/32,te[1][N]+=se/32}if(H.autorange==="reversed"){var xe=te[0][N];te[0][N]=te[1][N],te[1][N]=xe}}else{var oe=H.range;te[0][N]=H.r2l(oe[0]),te[1][N]=H.r2l(oe[1])}te[0][N]===te[1][N]&&(te[0][N]-=1,te[1][N]+=1),F.glplot.setBounds(N,{min:te[0][N]*ue[N],max:te[1][N]*ue[N]})}var he,be=Z.aspectmode;if(be==="cube")he=[1,1,1];else if(be==="manual"){var me=Z.aspectratio;he=[me.x,me.y,me.z]}else if(be==="auto"||be==="data"){var _e=[1,1,1];for(N=0;N<3;++N){H=Z[_[N]],j=H.type;var Se=G[j];_e[N]=Math.pow(Se.acc,1/Se.count)/ue[N]}be==="data"||Math.max.apply(null,_e)/Math.min.apply(null,_e)<=4?he=_e:he=[1,1,1]}else throw new Error("scene.js aspectRatio was not one of the enumerated types");Z.aspectratio.x=X.aspectratio.x=he[0],Z.aspectratio.y=X.aspectratio.y=he[1],Z.aspectratio.z=X.aspectratio.z=he[2],F.glplot.setAspectratio(Z.aspectratio),F.viewInitial.aspectratio||(F.viewInitial.aspectratio={x:Z.aspectratio.x,y:Z.aspectratio.y,z:Z.aspectratio.z}),F.viewInitial.aspectmode||(F.viewInitial.aspectmode=Z.aspectmode);var De=Z.domain||null,Ie=B._size||null;if(De&&Ie){var Te=F.container.style;Te.position="absolute",Te.left=Ie.l+De.x[0]*Ie.w+"px",Te.top=Ie.t+(1-De.y[1])*Ie.h+"px",Te.width=Ie.w*(De.x[1]-De.x[0])+"px",Te.height=Ie.h*(De.y[1]-De.y[0])+"px"}F.glplot.redraw()},c.destroy=function(){var k=this;!k.glplot||(k.camera.mouseListener.enabled=!1,k.container.removeEventListener("wheel",k.camera.wheelListener),k.camera=null,k.glplot.dispose(),k.container.parentNode.removeChild(k.container),k.glplot=null)};function d(k){return[[k.eye.x,k.eye.y,k.eye.z],[k.center.x,k.center.y,k.center.z],[k.up.x,k.up.y,k.up.z]]}function C(k){return{up:{x:k.up[0],y:k.up[1],z:k.up[2]},center:{x:k.center[0],y:k.center[1],z:k.center[2]},eye:{x:k.eye[0],y:k.eye[1],z:k.eye[2]},projection:{type:k._ortho===!0?"orthographic":"perspective"}}}c.getCamera=function(){var k=this;return k.camera.view.recalcMatrix(k.camera.view.lastT()),C(k.camera)},c.setViewport=function(k){var B=this,z=k.camera;B.camera.lookAt.apply(this,d(z)),B.glplot.setAspectratio(k.aspectratio);var F=z.projection.type==="orthographic",I=B.camera._ortho;F!==I&&(B.glplot.redraw(),B.glplot.clearRGBA(),B.glplot.dispose(),B.initializeGLPlot())},c.isCameraChanged=function(k){var B=this,z=B.getCamera(),F=n.nestedProperty(k,B.id+".camera"),I=F.get();function O(j,Z,X,re){var ue=["up","center","eye"],K=["x","y","z"];return Z[ue[X]]&&j[ue[X]][K[re]]===Z[ue[X]][K[re]]}var N=!1;if(I===void 0)N=!0;else{for(var V=0;V<3;V++)for(var H=0;H<3;H++)if(!O(z,I,V,H)){N=!0;break}(!I.projection||z.projection&&z.projection.type!==I.projection.type)&&(N=!0)}return N},c.isAspectChanged=function(k){var B=this,z=B.glplot.getAspectratio(),F=n.nestedProperty(k,B.id+".aspectratio"),I=F.get();return I===void 0||I.x!==z.x||I.y!==z.y||I.z!==z.z},c.saveLayout=function(k){var B=this,z=B.fullLayout,F,I,O,N,V,H,j=B.isCameraChanged(k),Z=B.isAspectChanged(k),X=j||Z;if(X){var re={};if(j&&(F=B.getCamera(),I=n.nestedProperty(k,B.id+".camera"),O=I.get(),re[B.id+".camera"]=O),Z&&(N=B.glplot.getAspectratio(),V=n.nestedProperty(k,B.id+".aspectratio"),H=V.get(),re[B.id+".aspectratio"]=H),i.call("_storeDirectGUIEdit",k,z._preGUI,re),j){I.set(F);var ue=n.nestedProperty(z,B.id+".camera");ue.set(F)}if(Z){V.set(N);var K=n.nestedProperty(z,B.id+".aspectratio");K.set(N),B.glplot.redraw()}}return X},c.updateFx=function(k,B){var z=this,F=z.camera;if(F)if(k==="orbit")F.mode="orbit",F.keyBindingMode="rotate";else if(k==="turntable"){F.up=[0,0,1],F.mode="turntable",F.keyBindingMode="rotate";var I=z.graphDiv,O=I._fullLayout,N=z.fullSceneLayout.camera,V=N.up.x,H=N.up.y,j=N.up.z;if(j/Math.sqrt(V*V+H*H+j*j)<.999){var Z=z.id+".camera.up",X={x:0,y:0,z:1},re={};re[Z]=X;var ue=I.layout;i.call("_storeDirectGUIEdit",ue,O._preGUI,re),N.up=X,n.nestedProperty(ue,Z).set(X)}}else F.keyBindingMode=k;z.fullSceneLayout.hovermode=B};function S(k,B,z){for(var F=0,I=z-1;F<I;++F,--I)for(var O=0;O<B;++O)for(var N=0;N<4;++N){var V=4*(B*F+O)+N,H=4*(B*I+O)+N,j=k[V];k[V]=k[H],k[H]=j}}function E(k,B,z){for(var F=0;F<z;++F)for(var I=0;I<B;++I){var O=4*(B*F+I),N=k[O+3];if(N>0)for(var V=255/N,H=0;H<3;++H)k[O+H]=Math.min(V*k[O+H],255)}}c.toImage=function(k){var B=this;k||(k="png"),B.staticMode&&B.container.appendChild(x),B.glplot.redraw();var z=B.glplot.gl,F=z.drawingBufferWidth,I=z.drawingBufferHeight;z.bindFramebuffer(z.FRAMEBUFFER,null);var O=new Uint8Array(F*I*4);z.readPixels(0,0,F,I,z.RGBA,z.UNSIGNED_BYTE,O),S(O,F,I),E(O,F,I);var N=document.createElement("canvas");N.width=F,N.height=I;var V=N.getContext("2d",{willReadFrequently:!0}),H=V.createImageData(F,I);H.data.set(O),V.putImageData(H,0,0);var j;switch(k){case"jpeg":j=N.toDataURL("image/jpeg");break;case"webp":j=N.toDataURL("image/webp");break;default:j=N.toDataURL("image/png")}return B.staticMode&&B.container.removeChild(x),j},c.setConvert=function(){for(var k=this,B=0;B<3;B++){var z=k.fullSceneLayout[_[B]];r.setConvert(z,k.fullLayout),z.setScale=n.noop}},c.make4thDimension=function(){var k=this,B=k.graphDiv,z=B._fullLayout;k._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},r.setConvert(k._mockAxis,z)},P.exports=b},{"../../../stackgl_modules":1133,"../../components/fx":407,"../../lib":515,"../../lib/show_no_webgl_msg":537,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../../registry":647,"./layout/convert":611,"./layout/spikes":614,"./layout/tick_marks":615,"./project":616,"has-passive-events":229,"webgl-context":332}],618:[function(t,P,R){P.exports=function(u,A,T,e){e=e||u.length;for(var i=new Array(e),n=0;n<e;n++)i[n]=[u[n],A[n],T[n]];return i}},{}],619:[function(t,P,R){var h=t("./font_attributes"),u=t("./animation_attributes"),A=t("../components/color/attributes"),T=t("../components/shapes/draw_newshape/attributes"),e=t("../components/selections/draw_newselection/attributes"),i=t("./pad_attributes"),n=t("../lib/extend").extendFlat,a=h({editType:"calc"});a.family.dflt='"Open Sans", verdana, arial, sans-serif',a.size.dflt=12,a.color.dflt=A.defaultLine,P.exports={font:a,title:{text:{valType:"string",editType:"layoutstyle"},font:h({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:n(i({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},minreducedwidth:{valType:"number",min:2,dflt:64,editType:"plot"},minreducedheight:{valType:"number",min:2,dflt:64,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:A.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:A.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:A.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:T.newshape,activeshape:T.activeshape,newselection:e.newselection,activeselection:e.activeselection,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:n({},u.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:h({editType:"layoutstyle"})}}},{"../components/color/attributes":366,"../components/selections/draw_newselection/attributes":451,"../components/shapes/draw_newshape/attributes":463,"../lib/extend":505,"./animation_attributes":560,"./font_attributes":594,"./pad_attributes":627}],620:[function(t,P,R){var h=t("../../lib/sort_object_keys"),u="1.10.1",A='\xA9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',T=['\xA9 <a target="_blank" href="https://carto.com/">Carto</a>',A].join(" "),e=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),i=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),n={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:A,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:T,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:T,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:e,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:e,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:i,tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},a=h(n);P.exports={requiredVersion:u,styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:n,styleValuesNonMapbox:a,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@"+u+"."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",a.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{"../../lib/sort_object_keys":538}],621:[function(t,P,R){var h=t("../../lib");P.exports=function(A,T){var e=A.split(" "),i=e[0],n=e[1],a=h.isArrayOrTypedArray(T)?h.mean(T):T,r=.5+a/100,f=1.5+a/100,o=["",""],s=[0,0];switch(i){case"top":o[0]="top",s[1]=-f;break;case"bottom":o[0]="bottom",s[1]=f;break}switch(n){case"left":o[1]="right",s[0]=-r;break;case"right":o[1]="left",s[0]=r;break}var m;return o[0]&&o[1]?m=o.join("-"):o[0]?m=o[0]:o[1]?m=o[1]:m="center",{anchor:m,offset:s}}},{"../../lib":515}],622:[function(t,P,R){var h=t("mapbox-gl/dist/mapbox-gl-unminified"),u=t("../../lib"),A=u.strTranslate,T=u.strScale,e=t("../../plots/get_data").getSubplotCalcData,i=t("../../constants/xmlns_namespaces"),n=t("@plotly/d3"),a=t("../../components/drawing"),r=t("../../lib/svg_text_utils"),f=t("./mapbox"),o="mapbox",s=R.constants=t("./constants");R.name=o,R.attr="subplot",R.idRoot=o,R.idRegex=R.attrRegex=u.counterRegex(o),R.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},R.layoutAttributes=t("./layout_attributes"),R.supplyLayoutDefaults=t("./layout_defaults"),R.plot=function(v){var x=v._fullLayout,l=v.calcdata,b=x._subplots[o];if(h.version!==s.requiredVersion)throw new Error(s.wrongVersionErrorMsg);var c=m(v,b);h.accessToken=c;for(var M=0;M<b.length;M++){var _=b[M],y=e(l,o,_),w=x[_],d=w._subplot;d||(d=new f(v,_),x[_]._subplot=d),d.viewInitial||(d.viewInitial={center:u.extendFlat({},w.center),zoom:w.zoom,bearing:w.bearing,pitch:w.pitch}),d.plot(y,x,v._promises)}},R.clean=function(p,v,x,l){for(var b=l._subplots[o]||[],c=0;c<b.length;c++){var M=b[c];!v[M]&&!!l[M]._subplot&&l[M]._subplot.destroy()}},R.toSVG=function(p){for(var v=p._fullLayout,x=v._subplots[o],l=v._size,b=0;b<x.length;b++){var c=v[x[b]],M=c.domain,_=c._subplot,y=_.toImage("png"),w=v._glimages.append("svg:image");w.attr({xmlns:i.svg,"xlink:href":y,x:l.l+l.w*M.x[0],y:l.t+l.h*(1-M.y[1]),width:l.w*(M.x[1]-M.x[0]),height:l.h*(M.y[1]-M.y[0]),preserveAspectRatio:"none"});var d=n.select(c._subplot.div),C=d.select(".mapboxgl-ctrl-logo").node().offsetParent===null;if(!C){var S=v._glimages.append("g");S.attr("transform",A(l.l+l.w*M.x[0]+10,l.t+l.h*(1-M.y[0])-31)),S.append("path").attr("d",s.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),S.append("path").attr("d",s.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),S.append("path").attr("d",s.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),S.append("polygon").attr("points",s.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var E=d.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),k=v._glimages.append("g"),B=k.append("text");B.text(E).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":E});var z=a.bBox(B.node()),F=l.w*(M.x[1]-M.x[0]);if(z.width>F/2){var I=E.split("|").join("<br>");B.text(I).attr("data-unformatted",I).call(r.convertToTspans,p),z=a.bBox(B.node())}B.attr("transform",A(-3,-z.height+8)),k.insert("rect",".static-attribution").attr({x:-z.width-6,y:-z.height-3,width:z.width+6,height:z.height+3,fill:"rgba(255, 255, 255, 0.75)"});var O=1;z.width+6>F&&(O=F/(z.width+6));var N=[l.l+l.w*M.x[1],l.t+l.h*(1-M.y[0])];k.attr("transform",A(N[0],N[1])+T(O))}};function m(p,v){var x=p._fullLayout,l=p._context;if(l.mapboxAccessToken==="")return"";for(var b=[],c=[],M=!1,_=!1,y=0;y<v.length;y++){var w=x[v[y]],d=w.accesstoken;g(w.style)&&(d?u.pushUnique(b,d):(g(w._input.style)&&(u.error("Uses Mapbox map style, but did not set an access token."),M=!0),_=!0)),d&&u.pushUnique(c,d)}if(_){var C=M?s.noAccessTokenErrorMsg:s.missingStyleErrorMsg;throw u.error(C),new Error(C)}return b.length?(b.length>1&&u.warn(s.multipleTokensErrorMsg),b[0]):(c.length&&u.log(["Listed mapbox access token(s)",c.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}function g(p){return typeof p=="string"&&(s.styleValuesMapbox.indexOf(p)!==-1||p.indexOf("mapbox://")===0)}R.updateFx=function(p){for(var v=p._fullLayout,x=v._subplots[o],l=0;l<x.length;l++){var b=v[x[l]]._subplot;b.updateFx(v)}}},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/get_data":602,"./constants":620,"./layout_attributes":624,"./layout_defaults":625,"./mapbox":626,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],623:[function(t,P,R){var h=t("../../lib"),u=t("../../lib/svg_text_utils").sanitizeHTML,A=t("./convert_text_opts"),T=t("./constants");function e(f,o){this.subplot=f,this.uid=f.uid+"-"+o,this.index=o,this.idSource="source-"+this.uid,this.idLayer=T.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var i=e.prototype;i.update=function(o){this.visible?this.needsNewImage(o)?this.updateImage(o):this.needsNewSource(o)?(this.removeLayer(),this.updateSource(o),this.updateLayer(o)):this.needsNewLayer(o)?this.updateLayer(o):this.updateStyle(o):(this.updateSource(o),this.updateLayer(o)),this.visible=n(o)},i.needsNewImage=function(f){var o=this.subplot.map;return o.getSource(this.idSource)&&this.sourceType==="image"&&f.sourcetype==="image"&&(this.source!==f.source||JSON.stringify(this.coordinates)!==JSON.stringify(f.coordinates))},i.needsNewSource=function(f){return this.sourceType!==f.sourcetype||JSON.stringify(this.source)!==JSON.stringify(f.source)||this.layerType!==f.type},i.needsNewLayer=function(f){return this.layerType!==f.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},i.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},i.updateImage=function(f){var o=this.subplot.map;o.getSource(this.idSource).updateImage({url:f.source,coordinates:f.coordinates});var s=this.findFollowingMapboxLayerId(this.lookupBelow());s!==null&&this.subplot.map.moveLayer(this.idLayer,s)},i.updateSource=function(f){var o=this.subplot.map;if(o.getSource(this.idSource)&&o.removeSource(this.idSource),this.sourceType=f.sourcetype,this.source=f.source,!!n(f)){var s=r(f);o.addSource(this.idSource,s)}},i.findFollowingMapboxLayerId=function(f){if(f==="traces")for(var o=this.subplot.getMapLayers(),s=0;s<o.length;s++){var m=o[s].id;if(typeof m=="string"&&m.indexOf(T.traceLayerPrefix)===0){f=m;break}}return f},i.updateLayer=function(f){var o=this.subplot,s=a(f),m=this.lookupBelow(),g=this.findFollowingMapboxLayerId(m);this.removeLayer(),n(f)&&o.addLayer({id:this.idLayer,source:this.idSource,"source-layer":f.sourcelayer||"",type:f.type,minzoom:f.minzoom,maxzoom:f.maxzoom,layout:s.layout,paint:s.paint},g),this.layerType=f.type,this.below=m},i.updateStyle=function(f){if(n(f)){var o=a(f);this.subplot.setOptions(this.idLayer,"setLayoutProperty",o.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",o.paint)}},i.removeLayer=function(){var f=this.subplot.map;f.getLayer(this.idLayer)&&f.removeLayer(this.idLayer)},i.dispose=function(){var f=this.subplot.map;f.getLayer(this.idLayer)&&f.removeLayer(this.idLayer),f.getSource(this.idSource)&&f.removeSource(this.idSource)};function n(f){if(!f.visible)return!1;var o=f.source;if(Array.isArray(o)&&o.length>0){for(var s=0;s<o.length;s++)if(typeof o[s]!="string"||o[s].length===0)return!1;return!0}return h.isPlainObject(o)||typeof o=="string"&&o.length>0}function a(f){var o={},s={};switch(f.type){case"circle":h.extendFlat(s,{"circle-radius":f.circle.radius,"circle-color":f.color,"circle-opacity":f.opacity});break;case"line":h.extendFlat(s,{"line-width":f.line.width,"line-color":f.color,"line-opacity":f.opacity,"line-dasharray":f.line.dash});break;case"fill":h.extendFlat(s,{"fill-color":f.color,"fill-outline-color":f.fill.outlinecolor,"fill-opacity":f.opacity});break;case"symbol":var m=f.symbol,g=A(m.textposition,m.iconsize);h.extendFlat(o,{"icon-image":m.icon+"-15","icon-size":m.iconsize/10,"text-field":m.text,"text-size":m.textfont.size,"text-anchor":g.anchor,"text-offset":g.offset,"symbol-placement":m.placement}),h.extendFlat(s,{"icon-color":f.color,"text-color":m.textfont.color,"text-opacity":f.opacity});break;case"raster":h.extendFlat(s,{"raster-fade-duration":0,"raster-opacity":f.opacity});break}return{layout:o,paint:s}}function r(f){var o=f.sourcetype,s=f.source,m={type:o},g;return o==="geojson"?g="data":o==="vector"?g=typeof s=="string"?"url":"tiles":o==="raster"?(g="tiles",m.tileSize=256):o==="image"&&(g="url",m.coordinates=f.coordinates),m[g]=s,f.sourceattribution&&(m.attribution=u(f.sourceattribution)),m}P.exports=function(o,s,m){var g=new e(o,s);return g.update(m),g}},{"../../lib":515,"../../lib/svg_text_utils":541,"./constants":620,"./convert_text_opts":621}],624:[function(t,P,R){var h=t("../../lib"),u=t("../../components/color").defaultLine,A=t("../domain").attributes,T=t("../font_attributes"),e=t("../../traces/scatter/attributes").textposition,i=t("../../plot_api/edit_types").overrideAll,n=t("../../plot_api/plot_template").templatedArray,a=t("./constants"),r=T({});r.family.dflt="Open Sans Regular, Arial Unicode MS Regular";var f=P.exports=i({_arrayAttrRegexps:[h.counterRegex("mapbox",".layers",!0)],domain:A({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:a.styleValuesMapbox.concat(a.styleValuesNonMapbox),dflt:a.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},bounds:{west:{valType:"number"},east:{valType:"number"},south:{valType:"number"},north:{valType:"number"}},layers:n("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:u},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:u}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:r,textposition:h.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root");f.uirevision={valType:"any",editType:"none"}},{"../../components/color":367,"../../lib":515,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../domain":593,"../font_attributes":594,"./constants":620}],625:[function(t,P,R){var h=t("../../lib"),u=t("../subplot_defaults"),A=t("../array_container_defaults"),T=t("./layout_attributes");P.exports=function(a,r,f){u(a,r,f,{type:"mapbox",attributes:T,handleDefaults:e,partition:"y",accessToken:r._mapboxAccessToken})};function e(n,a,r,f){r("accesstoken",f.accessToken),r("style"),r("center.lon"),r("center.lat"),r("zoom"),r("bearing"),r("pitch");var o=r("bounds.west"),s=r("bounds.east"),m=r("bounds.south"),g=r("bounds.north");(o===void 0||s===void 0||m===void 0||g===void 0)&&delete a.bounds,A(n,a,{name:"layers",handleItemDefaults:i}),a._input=n}function i(n,a){function r(p,v){return h.coerce(n,a,T.layers,p,v)}var f=r("visible");if(f){var o=r("sourcetype"),s=o==="raster"||o==="image";r("source"),r("sourceattribution"),o==="vector"&&r("sourcelayer"),o==="image"&&r("coordinates");var m;s&&(m="raster");var g=r("type",m);s&&g!=="raster"&&(g=a.type="raster",h.log("Source types *raster* and *image* must drawn *raster* layer type.")),r("below"),r("color"),r("opacity"),r("minzoom"),r("maxzoom"),g==="circle"&&r("circle.radius"),g==="line"&&(r("line.width"),r("line.dash")),g==="fill"&&r("fill.outlinecolor"),g==="symbol"&&(r("symbol.icon"),r("symbol.iconsize"),r("symbol.text"),h.coerceFont(r,"symbol.textfont"),r("symbol.textposition"),r("symbol.placement"))}}},{"../../lib":515,"../array_container_defaults":561,"../subplot_defaults":641,"./layout_attributes":624}],626:[function(t,P,R){var h=t("mapbox-gl/dist/mapbox-gl-unminified"),u=t("../../lib"),A=t("../../lib/geo_location_utils"),T=t("../../registry"),e=t("../cartesian/axes"),i=t("../../components/dragelement"),n=t("../../components/fx"),a=t("../../components/dragelement/helpers"),r=a.drawMode,f=a.selectMode,o=t("../../components/selections").prepSelect,s=t("../../components/selections").clearOutline,m=t("../../components/selections").clearSelectionsCache,g=t("../../components/selections").selectOnClick,p=t("./constants"),v=t("./layers");function x(y,w){this.id=w,this.gd=y;var d=y._fullLayout,C=y._context;this.container=d._glcontainer.node(),this.isStatic=C.staticPlot,this.uid=d._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(d),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var l=x.prototype;l.plot=function(y,w,d){var C=this,S=w[C.id];C.map&&S.accesstoken!==C.accessToken&&(C.map.remove(),C.map=null,C.styleObj=null,C.traceHash={},C.layerList=[]);var E;C.map?E=new Promise(function(k,B){C.updateMap(y,w,k,B)}):E=new Promise(function(k,B){C.createMap(y,w,k,B)}),d.push(E)},l.createMap=function(y,w,d,C){var S=this,E=w[S.id],k=S.styleObj=c(E.style);S.accessToken=E.accesstoken;var B=E.bounds,z=B?[[B.west,B.south],[B.east,B.north]]:null,F=S.map=new h.Map({container:S.div,style:k.style,center:_(E.center),zoom:E.zoom,bearing:E.bearing,pitch:E.pitch,maxBounds:z,interactive:!S.isStatic,preserveDrawingBuffer:S.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new h.AttributionControl({compact:!0}));F._canvas.style.left="0px",F._canvas.style.top="0px",S.rejectOnError(C),S.isStatic||S.initFx(y,w);var I=[];I.push(new Promise(function(O){F.once("load",O)})),I=I.concat(A.fetchTraceGeoData(y)),Promise.all(I).then(function(){S.fillBelowLookup(y,w),S.updateData(y),S.updateLayout(w),S.resolveOnRender(d)}).catch(C)},l.updateMap=function(y,w,d,C){var S=this,E=S.map,k=w[this.id];S.rejectOnError(C);var B=[],z=c(k.style);JSON.stringify(S.styleObj)!==JSON.stringify(z)&&(S.styleObj=z,E.setStyle(z.style),S.traceHash={},B.push(new Promise(function(F){E.once("styledata",F)}))),B=B.concat(A.fetchTraceGeoData(y)),Promise.all(B).then(function(){S.fillBelowLookup(y,w),S.updateData(y),S.updateLayout(w),S.resolveOnRender(d)}).catch(C)},l.fillBelowLookup=function(y,w){var d=w[this.id],C=d.layers,S,E,k=this.belowLookup={},B=!1;for(S=0;S<y.length;S++){var z=y[S][0].trace,F=z._module;typeof z.below=="string"?E=z.below:F.getBelow&&(E=F.getBelow(z,this)),E===""&&(B=!0),k["trace-"+z.uid]=E||""}for(S=0;S<C.length;S++){var I=C[S];typeof I.below=="string"?E=I.below:B?E="traces":E="",k["layout-"+S]=E}var O={},N,V;for(N in k)E=k[N],O[E]?O[E].push(N):O[E]=[N];for(E in O){var H=O[E];if(H.length>1)for(S=0;S<H.length;S++)N=H[S],N.indexOf("trace-")===0?(V=N.split("trace-")[1],this.traceHash[V]&&(this.traceHash[V].below=null)):N.indexOf("layout-")===0&&(V=N.split("layout-")[1],this.layerList[V]&&(this.layerList[V].below=null))}};var b={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};l.updateData=function(y){var w=this.traceHash,d,C,S,E,k=y.slice().sort(function(O,N){return b[O[0].trace.type]-b[N[0].trace.type]});for(S=0;S<k.length;S++){var B=k[S];C=B[0].trace,d=w[C.uid];var z=!1;d&&(d.type===C.type?(d.update(B),z=!0):d.dispose()),!z&&C._module&&(w[C.uid]=C._module.plot(this,B))}var F=Object.keys(w);e:for(S=0;S<F.length;S++){var I=F[S];for(E=0;E<y.length;E++)if(C=y[E][0].trace,I===C.uid)continue e;d=w[I],d.dispose(),delete w[I]}},l.updateLayout=function(y){var w=this.map,d=y[this.id];!this.dragging&&!this.wheeling&&(w.setCenter(_(d.center)),w.setZoom(d.zoom),w.setBearing(d.bearing),w.setPitch(d.pitch)),this.updateLayers(y),this.updateFramework(y),this.updateFx(y),this.map.resize(),this.gd._context._scrollZoom.mapbox?w.scrollZoom.enable():w.scrollZoom.disable()},l.resolveOnRender=function(y){var w=this.map;w.on("render",function d(){w.loaded()&&(w.off("render",d),setTimeout(y,10))})},l.rejectOnError=function(y){var w=this.map;function d(){y(new Error(p.mapOnErrorMsg))}w.once("error",d),w.once("style.error",d),w.once("source.error",d),w.once("tile.error",d),w.once("layer.error",d)},l.createFramework=function(y){var w=this,d=w.div=document.createElement("div");d.id=w.uid,d.style.position="absolute",w.container.appendChild(d),w.xaxis={_id:"x",c2p:function(C){return w.project(C).x}},w.yaxis={_id:"y",c2p:function(C){return w.project(C).y}},w.updateFramework(y),w.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(w.mockAxis,y)},l.initFx=function(y,w){var d=this,C=d.gd,S=d.map;S.on("moveend",function(B){if(!!d.map){var z=C._fullLayout;if(B.originalEvent||d.wheeling){var F=z[d.id];T.call("_storeDirectGUIEdit",C.layout,z._preGUI,d.getViewEdits(F));var I=d.getView();F._input.center=F.center=I.center,F._input.zoom=F.zoom=I.zoom,F._input.bearing=F.bearing=I.bearing,F._input.pitch=F.pitch=I.pitch,C.emit("plotly_relayout",d.getViewEditsWithDerived(I))}B.originalEvent&&B.originalEvent.type==="mouseup"?d.dragging=!1:d.wheeling&&(d.wheeling=!1),z._rehover&&z._rehover()}}),S.on("wheel",function(){d.wheeling=!0}),S.on("mousemove",function(B){var z=d.div.getBoundingClientRect(),F=[B.originalEvent.offsetX,B.originalEvent.offsetY];B.target.getBoundingClientRect=function(){return z},d.xaxis.p2c=function(){return S.unproject(F).lng},d.yaxis.p2c=function(){return S.unproject(F).lat},C._fullLayout._rehover=function(){C._fullLayout._hoversubplot===d.id&&C._fullLayout[d.id]&&n.hover(C,B,d.id)},n.hover(C,B,d.id),C._fullLayout._hoversubplot=d.id});function E(){n.loneUnhover(w._hoverlayer)}S.on("dragstart",function(){d.dragging=!0,E()}),S.on("zoomstart",E),S.on("mouseout",function(){C._fullLayout._hoversubplot=null});function k(){var B=d.getView();C.emit("plotly_relayouting",d.getViewEditsWithDerived(B))}S.on("drag",k),S.on("zoom",k),S.on("dblclick",function(){var B=C._fullLayout[d.id];T.call("_storeDirectGUIEdit",C.layout,C._fullLayout._preGUI,d.getViewEdits(B));var z=d.viewInitial;S.setCenter(_(z.center)),S.setZoom(z.zoom),S.setBearing(z.bearing),S.setPitch(z.pitch);var F=d.getView();B._input.center=B.center=F.center,B._input.zoom=B.zoom=F.zoom,B._input.bearing=B.bearing=F.bearing,B._input.pitch=B.pitch=F.pitch,C.emit("plotly_doubleclick",null),C.emit("plotly_relayout",d.getViewEditsWithDerived(F))}),d.clearOutline=function(){m(d.dragOptions),s(d.dragOptions.gd)},d.onClickInPanFn=function(B){return function(z){var F=C._fullLayout.clickmode;F.indexOf("select")>-1&&g(z.originalEvent,C,[d.xaxis],[d.yaxis],d.id,B),F.indexOf("event")>-1&&n.click(C,z.originalEvent)}}},l.updateFx=function(y){var w=this,d=w.map,C=w.gd;if(w.isStatic)return;function S(z){var F=w.map.unproject(z);return[F.lng,F.lat]}var E=y.dragmode,k;k=function(z,F){if(F.isRect){var I=z.range={};I[w.id]=[S([F.xmin,F.ymin]),S([F.xmax,F.ymax])]}else{var O=z.lassoPoints={};O[w.id]=F.map(S)}};var B=w.dragOptions;w.dragOptions=u.extendDeep(B||{},{dragmode:y.dragmode,element:w.div,gd:C,plotinfo:{id:w.id,domain:y[w.id].domain,xaxis:w.xaxis,yaxis:w.yaxis,fillRangeItems:k},xaxes:[w.xaxis],yaxes:[w.yaxis],subplot:w.id}),d.off("click",w.onClickInPanHandler),f(E)||r(E)?(d.dragPan.disable(),d.on("zoomstart",w.clearOutline),w.dragOptions.prepFn=function(z,F,I){o(z,F,I,w.dragOptions,E)},i.init(w.dragOptions)):(d.dragPan.enable(),d.off("zoomstart",w.clearOutline),w.div.onmousedown=null,w.div.ontouchstart=null,w.div.removeEventListener("touchstart",w.div._ontouchstart),w.onClickInPanHandler=w.onClickInPanFn(w.dragOptions),d.on("click",w.onClickInPanHandler))},l.updateFramework=function(y){var w=y[this.id].domain,d=y._size,C=this.div.style;C.width=d.w*(w.x[1]-w.x[0])+"px",C.height=d.h*(w.y[1]-w.y[0])+"px",C.left=d.l+w.x[0]*d.w+"px",C.top=d.t+(1-w.y[1])*d.h+"px",this.xaxis._offset=d.l+w.x[0]*d.w,this.xaxis._length=d.w*(w.x[1]-w.x[0]),this.yaxis._offset=d.t+(1-w.y[1])*d.h,this.yaxis._length=d.h*(w.y[1]-w.y[0])},l.updateLayers=function(y){var w=y[this.id],d=w.layers,C=this.layerList,S;if(d.length!==C.length){for(S=0;S<C.length;S++)C[S].dispose();for(C=this.layerList=[],S=0;S<d.length;S++)C.push(v(this,S,d[S]))}else for(S=0;S<d.length;S++)C[S].update(d[S])},l.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},l.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},l.setOptions=function(y,w,d){for(var C in d)this.map[w](y,C,d[C])},l.getMapLayers=function(){return this.map.getStyle().layers},l.addLayer=function(y,w){var d=this.map;if(typeof w=="string"){if(w===""){d.addLayer(y,w);return}for(var C=this.getMapLayers(),S=0;S<C.length;S++)if(w===C[S].id){d.addLayer(y,w);return}u.warn(["Trying to add layer with *below* value",w,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}d.addLayer(y)},l.project=function(y){return this.map.project(new h.LngLat(y[0],y[1]))},l.getView=function(){var y=this.map,w=y.getCenter(),d=w.lng,C=w.lat,S={lon:d,lat:C},E=y.getCanvas(),k=parseInt(E.style.width),B=parseInt(E.style.height);return{center:S,zoom:y.getZoom(),bearing:y.getBearing(),pitch:y.getPitch(),_derived:{coordinates:[y.unproject([0,0]).toArray(),y.unproject([k,0]).toArray(),y.unproject([k,B]).toArray(),y.unproject([0,B]).toArray()]}}},l.getViewEdits=function(y){for(var w=this.id,d=["center","zoom","bearing","pitch"],C={},S=0;S<d.length;S++){var E=d[S];C[w+"."+E]=y[E]}return C},l.getViewEditsWithDerived=function(y){var w=this.id,d=this.getViewEdits(y);return d[w+"._derived"]=y._derived,d};function c(y){var w={};return u.isPlainObject(y)?(w.id=y.id,w.style=y):typeof y=="string"?(w.id=y,p.styleValuesMapbox.indexOf(y)!==-1?w.style=M(y):p.stylesNonMapbox[y]?w.style=p.stylesNonMapbox[y]:w.style=y):(w.id=p.styleValueDflt,w.style=M(p.styleValueDflt)),w.transition={duration:0,delay:0},w}function M(y){return p.styleUrlPrefix+y+"-"+p.styleUrlSuffix}function _(y){return[y.lon,y.lat]}P.exports=x},{"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../registry":647,"../cartesian/axes":566,"./constants":620,"./layers":623,"mapbox-gl/dist/mapbox-gl-unminified":239}],627:[function(t,P,R){P.exports=function(h){var u=h.editType;return{t:{valType:"number",dflt:0,editType:u},r:{valType:"number",dflt:0,editType:u},b:{valType:"number",dflt:0,editType:u},l:{valType:"number",dflt:0,editType:u},editType:u}}},{}],628:[function(t,P,R){var h=t("@plotly/d3"),u=t("d3-time-format").timeFormatLocale,A=t("d3-format").formatLocale,T=t("fast-isnumeric"),e=t("../registry"),i=t("../plot_api/plot_schema"),n=t("../plot_api/plot_template"),a=t("../lib"),r=t("../components/color"),f=t("../constants/numerical").BADNUM,o=t("./cartesian/axis_ids"),s=t("../components/shapes/handle_outline").clearOutline,m=t("./animation_attributes"),g=t("./frame_attributes"),p=t("../plots/get_data").getModuleCalcData,v=a.relinkPrivateKeys,x=a._,l=P.exports={};a.extendFlat(l,e),l.attributes=t("./attributes"),l.attributes.type.values=l.allTypes,l.fontAttrs=t("./font_attributes"),l.layoutAttributes=t("./layout_attributes"),l.fontWeight="normal";var b=l.transformsRegistry,c=t("./command");l.executeAPICommand=c.executeAPICommand,l.computeAPICommandBindings=c.computeAPICommandBindings,l.manageCommandObserver=c.manageCommandObserver,l.hasSimpleAPICommandBindings=c.hasSimpleAPICommandBindings,l.redrawText=function(K){return K=a.getGraphDiv(K),new Promise(function(te){setTimeout(function(){!K._fullLayout||(e.getComponentMethod("annotations","draw")(K),e.getComponentMethod("legend","draw")(K),e.getComponentMethod("colorbar","draw")(K),te(l.previousPromises(K)))},300)})},l.resize=function(K){K=a.getGraphDiv(K);var te,G=new Promise(function(Y,ee){(!K||a.isHidden(K))&&ee(new Error("Resize must be passed a displayed plot div element.")),K._redrawTimer&&clearTimeout(K._redrawTimer),K._resolveResize&&(te=K._resolveResize),K._resolveResize=Y,K._redrawTimer=setTimeout(function(){if(!K.layout||K.layout.width&&K.layout.height||a.isHidden(K)){Y(K);return}delete K.layout.width,delete K.layout.height;var ne=K.changed;K.autoplay=!0,e.call("relayout",K,{autosize:!0}).then(function(){K.changed=ne,K._resolveResize===Y&&(delete K._resolveResize,Y(K))})},100)});return te&&te(G),G},l.previousPromises=function(K){if((K._promises||[]).length)return Promise.all(K._promises).then(function(){K._promises=[]})},l.addLinks=function(K){if(!(!K._context.showLink&&!K._context.showSources)){var te=K._fullLayout,G=a.ensureSingle(te._paper,"text","js-plot-link-container",function(ae){ae.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:r.defaultLine,"pointer-events":"all"}).each(function(){var le=h.select(this);le.append("tspan").classed("js-link-to-tool",!0),le.append("tspan").classed("js-link-spacer",!0),le.append("tspan").classed("js-sourcelinks",!0)})}),Y=G.node(),ee={y:te._paper.attr("height")-9};document.body.contains(Y)&&Y.getComputedTextLength()>=te.width-20?(ee["text-anchor"]="start",ee.x=5):(ee["text-anchor"]="end",ee.x=te._paper.attr("width")-7),G.attr(ee);var ne=G.select(".js-link-to-tool"),J=G.select(".js-link-spacer"),q=G.select(".js-sourcelinks");K._context.showSources&&K._context.showSources(K),K._context.showLink&&M(K,ne),J.text(ne.text()&&q.text()?" - ":"")}};function M(K,te){te.text("");var G=te.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(K._context.linkText+" "+String.fromCharCode(187));if(K._context.sendData)G.on("click",function(){l.sendDataToCloud(K)});else{var Y=window.location.pathname.split("/"),ee=window.location.search;G.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+Y[2].split(".")[0]+"/"+Y[1]+ee})}}l.sendDataToCloud=function(K){var te=(window.PLOTLYENV||{}).BASE_URL||K._context.plotlyServerURL;if(!!te){K.emit("plotly_beforeexport");var G=h.select(K).append("div").attr("id","hiddenform").style("display","none"),Y=G.append("form").attr({action:te+"/external",method:"post",target:"_blank"}),ee=Y.append("input").attr({type:"text",name:"data"});return ee.node().value=l.graphJson(K,!1,"keepdata"),Y.node().submit(),G.remove(),K.emit("plotly_afterexport"),!1}};var _=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],y=["year","month","dayMonth","dayMonthYear"];l.supplyDefaults=function(K,te){var G=te&&te.skipUpdateCalc,Y=K._fullLayout||{};if(Y._skipDefaults){delete Y._skipDefaults;return}var ee=K._fullLayout={},ne=K.layout||{},J=K._fullData||[],q=K._fullData=[],ae=K.data||[],le=K.calcdata||[],ie=K._context||{},se;K._transitionData||l.createTransitionData(K),ee._dfltTitle={plot:x(K,"Click to enter Plot title"),x:x(K,"Click to enter X axis title"),y:x(K,"Click to enter Y axis title"),colorbar:x(K,"Click to enter Colorscale title"),annotation:x(K,"new text")},ee._traceWord=x(K,"trace");var xe=C(K,_);if(ee._mapboxAccessToken=ie.mapboxAccessToken,Y._initialAutoSizeIsDone){var oe=Y.width,he=Y.height;l.supplyLayoutGlobalDefaults(ne,ee,xe),ne.width||(ee.width=oe),ne.height||(ee.height=he),l.sanitizeMargins(ee)}else{l.supplyLayoutGlobalDefaults(ne,ee,xe);var be=!ne.width||!ne.height,me=ee.autosize,_e=ie.autosizable,Se=be&&(me||_e);Se?l.plotAutoSize(K,ne,ee):be&&l.sanitizeMargins(ee),!me&&be&&(ne.width=ee.width,ne.height=ee.height)}ee._d3locale=S(xe,ee.separators),ee._extraFormat=C(K,y),ee._initialAutoSizeIsDone=!0,ee._dataLength=ae.length,ee._modules=[],ee._visibleModules=[],ee._basePlotModules=[];var De=ee._subplots=d(),Ie=ee._splomAxes={x:{},y:{}},Te=ee._splomSubplots={};ee._splomGridDflt={},ee._scatterStackOpts={},ee._firstScatter={},ee._alignmentOpts={},ee._colorAxes={},ee._requestRangeslider={},ee._traceUids=w(J,ae),ee._globalTransforms=(K._context||{}).globalTransforms,l.supplyDataDefaults(ae,q,ne,ee);var Ce=Object.keys(Ie.x),He=Object.keys(Ie.y);if(Ce.length>1&&He.length>1){for(e.getComponentMethod("grid","sizeDefaults")(ne,ee),se=0;se<Ce.length;se++)a.pushUnique(De.xaxis,Ce[se]);for(se=0;se<He.length;se++)a.pushUnique(De.yaxis,He[se]);for(var Xe in Te)a.pushUnique(De.cartesian,Xe)}if(ee._has=l._hasPlotType.bind(ee),J.length===q.length)for(se=0;se<q.length;se++)v(q[se],J[se]);l.supplyLayoutModuleDefaults(ne,ee,q,K._transitionData);var Be=ee._visibleModules,Re=[];for(se=0;se<Be.length;se++){var We=Be[se].crossTraceDefaults;We&&a.pushUnique(Re,We)}for(se=0;se<Re.length;se++)Re[se](q,ee);ee._hasOnlyLargeSploms=ee._basePlotModules.length===1&&ee._basePlotModules[0].name==="splom"&&Ce.length>15&&He.length>15&&ee.shapes.length===0&&ee.images.length===0,l.linkSubplots(q,ee,J,Y),l.cleanPlot(q,ee,J,Y);var vt=!!(Y._has&&Y._has("gl2d")),Pt=!!(ee._has&&ee._has("gl2d")),Zt=!!(Y._has&&Y._has("cartesian")),zt=!!(ee._has&&ee._has("cartesian")),At=Zt||vt,Wt=zt||Pt;At&&!Wt?Y._bgLayer.remove():Wt&&!At&&(ee._shouldCreateBgLayer=!0),Y._zoomlayer&&!K._dragging&&s({_fullLayout:Y}),E(q,ee),v(ee,Y),e.getComponentMethod("colorscale","crossTraceDefaults")(q,ee),ee._preGUI||(ee._preGUI={}),ee._tracePreGUI||(ee._tracePreGUI={});var Bt=ee._tracePreGUI,Ct={},Ze;for(Ze in Bt)Ct[Ze]="old";for(se=0;se<q.length;se++)Ze=q[se]._fullInput.uid,Ct[Ze]||(Bt[Ze]={}),Ct[Ze]="new";for(Ze in Ct)Ct[Ze]==="old"&&delete Bt[Ze];I(ee),e.getComponentMethod("rangeslider","makeData")(ee),!G&&le.length===q.length&&l.supplyDefaultsUpdateCalc(le,q)},l.supplyDefaultsUpdateCalc=function(K,te){for(var G=0;G<te.length;G++){var Y=te[G],ee=(K[G]||[])[0];if(ee&&ee.trace){var ne=ee.trace;if(ne._hasCalcTransform){var J=ne._arrayAttrs,q,ae,le;for(q=0;q<J.length;q++)ae=J[q],le=a.nestedProperty(ne,ae).get().slice(),a.nestedProperty(Y,ae).set(le)}ee.trace=Y}}};function w(K,te){var G=te.length,Y=[],ee,ne;for(ee=0;ee<K.length;ee++){var J=K[ee]._fullInput;J!==ne&&Y.push(J),ne=J}var q=Y.length,ae=new Array(G),le={};function ie(oe,he){ae[he]=oe,le[oe]=1}function se(oe,he){if(oe&&typeof oe=="string"&&!le[oe])return ie(oe,he),!0}for(ee=0;ee<G;ee++){var xe=te[ee].uid;typeof xe=="number"&&(xe=String(xe)),!se(xe,ee)&&(ee<q&&se(Y[ee].uid,ee)||ie(a.randstr(le),ee))}return ae}function d(){var K=e.collectableSubplotTypes,te={},G,Y;if(!K){K=[];var ee=e.subplotsRegistry;for(var ne in ee){var J=ee[ne],q=J.attr;if(q&&(K.push(ne),Array.isArray(q)))for(Y=0;Y<q.length;Y++)a.pushUnique(K,q[Y])}}for(G=0;G<K.length;G++)te[K[G]]=[];return te}function C(K,te){var G=K._context.locale;G||(G="en-US");var Y=!1,ee={};function ne(se){for(var xe=!0,oe=0;oe<te.length;oe++){var he=te[oe];ee[he]||(se[he]?ee[he]=se[he]:xe=!1)}xe&&(Y=!0)}for(var J=0;J<2;J++){for(var q=K._context.locales,ae=0;ae<2;ae++){var le=(q[G]||{}).format;if(le&&(ne(le),Y))break;q=e.localeRegistry}var ie=G.split("-")[0];if(Y||ie===G)break;G=ie}return Y||ne(e.localeRegistry.en.format),ee}function S(K,te){return K.decimal=te.charAt(0),K.thousands=te.charAt(1),{numberFormat:function(G){try{G=A(K).format(a.adjustFormat(G))}catch{return a.warnBadFormat(G),a.noFormat}return G},timeFormat:u(K).utcFormat}}function E(K,te){var G,Y=[];te.meta&&(G=te._meta={meta:te.meta,layout:{meta:te.meta}});for(var ee=0;ee<K.length;ee++){var ne=K[ee];ne.meta?Y[ne.index]=ne._meta={meta:ne.meta}:te.meta&&(ne._meta={meta:te.meta}),te.meta&&(ne._meta.layout={meta:te.meta})}Y.length&&(G||(G=te._meta={}),G.data=Y)}l.createTransitionData=function(K){K._transitionData||(K._transitionData={}),K._transitionData._frames||(K._transitionData._frames=[]),K._transitionData._frameHash||(K._transitionData._frameHash={}),K._transitionData._counter||(K._transitionData._counter=0),K._transitionData._interruptCallbacks||(K._transitionData._interruptCallbacks=[])},l._hasPlotType=function(K){var te,G=this._basePlotModules||[];for(te=0;te<G.length;te++)if(G[te].name===K)return!0;var Y=this._modules||[];for(te=0;te<Y.length;te++){var ee=Y[te].name;if(ee===K)return!0;var ne=e.modules[ee];if(ne&&ne.categories[K])return!0}return!1},l.cleanPlot=function(K,te,G,Y){var ee,ne,J=Y._basePlotModules||[];for(ee=0;ee<J.length;ee++){var q=J[ee];q.clean&&q.clean(K,te,G,Y)}var ae=Y._has&&Y._has("gl"),le=te._has&&te._has("gl");ae&&!le&&Y._glcontainer!==void 0&&(Y._glcontainer.selectAll(".gl-canvas").remove(),Y._glcontainer.selectAll(".no-webgl").remove(),Y._glcanvas=null);var ie=!!Y._infolayer;e:for(ee=0;ee<G.length;ee++){var se=G[ee],xe=se.uid;for(ne=0;ne<K.length;ne++){var oe=K[ne];if(xe===oe.uid)continue e}ie&&Y._infolayer.select(".cb"+xe).remove()}},l.linkSubplots=function(K,te,G,Y){var ee,ne,J=Y._plots||{},q=te._plots={},ae=te._subplots,le={_fullData:K,_fullLayout:te},ie=ae.cartesian.concat(ae.gl2d||[]);for(ee=0;ee<ie.length;ee++){var se=ie[ee],xe=J[se],oe=o.getFromId(le,se,"x"),he=o.getFromId(le,se,"y"),be;for(xe?be=q[se]=xe:(be=q[se]={},be.id=se),oe._counterAxes.push(he._id),he._counterAxes.push(oe._id),oe._subplotsWith.push(se),he._subplotsWith.push(se),be.xaxis=oe,be.yaxis=he,be._hasClipOnAxisFalse=!1,ne=0;ne<K.length;ne++){var me=K[ne];if(me.xaxis===be.xaxis._id&&me.yaxis===be.yaxis._id&&me.cliponaxis===!1){be._hasClipOnAxisFalse=!0;break}}}var _e=o.list(le,null,!0),Se;for(ee=0;ee<_e.length;ee++){Se=_e[ee];var De=null;Se.overlaying&&(De=o.getFromId(le,Se.overlaying),De&&De.overlaying&&(Se.overlaying=!1,De=null)),Se._mainAxis=De||Se,De&&(Se.domain=De.domain.slice()),Se._anchorAxis=Se.anchor==="free"?null:o.getFromId(le,Se.anchor)}for(ee=0;ee<_e.length;ee++)if(Se=_e[ee],Se._counterAxes.sort(o.idSort),Se._subplotsWith.sort(a.subplotSort),Se._mainSubplot=k(Se,te),Se._counterAxes.length&&(Se.spikemode&&Se.spikemode.indexOf("across")!==-1||Se.automargin&&Se.mirror&&Se.anchor!=="free"||e.getComponentMethod("rangeslider","isVisible")(Se))){var Ie=1,Te=0;for(ne=0;ne<Se._counterAxes.length;ne++){var Ce=o.getFromId(le,Se._counterAxes[ne]);Ie=Math.min(Ie,Ce.domain[0]),Te=Math.max(Te,Ce.domain[1])}Ie<Te&&(Se._counterDomainMin=Ie,Se._counterDomainMax=Te)}};function k(K,te){var G={_fullLayout:te},Y=K._id.charAt(0)==="x",ee=K._mainAxis._anchorAxis,ne="",J="",q="";if(ee&&(q=ee._mainAxis._id,ne=Y?K._id+q:q+K._id),!ne||!te._plots[ne]){ne="";for(var ae=K._counterAxes,le=0;le<ae.length;le++){var ie=ae[le],se=Y?K._id+ie:ie+K._id;J||(J=se);var xe=o.getFromId(G,ie);if(q&&xe.overlaying===q){ne=se;break}}}return ne||J}l.clearExpandedTraceDefaultColors=function(K){var te,G,Y;function ee(J,q,ae,le){G[le]=q,G.length=le+1,J.valType==="color"&&J.dflt===void 0&&te.push(G.join("."))}for(G=[],te=K._module._colorAttrs,te||(K._module._colorAttrs=te=[],i.crawl(K._module.attributes,ee)),Y=0;Y<te.length;Y++){var ne=a.nestedProperty(K,"_input."+te[Y]);ne.get()||a.nestedProperty(K,te[Y]).set(null)}},l.supplyDataDefaults=function(K,te,G,Y){var ee=Y._modules,ne=Y._visibleModules,J=Y._basePlotModules,q=0,ae=0,le,ie,se;Y._transformModules=[];function xe(He){te.push(He);var Xe=He._module;!Xe||(a.pushUnique(ee,Xe),He.visible===!0&&a.pushUnique(ne,Xe),a.pushUnique(J,He._module.basePlotModule),q++,He._input.visible!==!1&&ae++)}var oe={},he=[],be=(G.template||{}).data||{},me=n.traceTemplater(be);for(le=0;le<K.length;le++){if(se=K[le],ie=me.newTrace(se),ie.uid=Y._traceUids[le],l.supplyTraceDefaults(se,ie,ae,Y,le),ie.index=le,ie._input=se,ie._expandedIndex=q,ie.transforms&&ie.transforms.length)for(var _e=se.visible!==!1&&ie.visible===!1,Se=z(ie,te,G,Y),De=0;De<Se.length;De++){var Ie=Se[De],Te={_template:ie._template,type:ie.type,uid:ie.uid+De};_e&&Ie.visible===!1&&delete Ie.visible,l.supplyTraceDefaults(Ie,Te,q,Y,le),v(Te,Ie),Te.index=le,Te._input=se,Te._fullInput=ie,Te._expandedIndex=q,Te._expandedInput=Ie,xe(Te)}else ie._fullInput=ie,ie._expandedInput=ie,xe(ie);e.traceIs(ie,"carpetAxis")&&(oe[ie.carpet]=ie),e.traceIs(ie,"carpetDependent")&&he.push(le)}for(le=0;le<he.length;le++)if(ie=te[he[le]],!!ie.visible){var Ce=oe[ie.carpet];if(ie._carpet=Ce,!Ce||!Ce.visible){ie.visible=!1;continue}ie.xaxis=Ce.xaxis,ie.yaxis=Ce.yaxis}},l.supplyAnimationDefaults=function(K){K=K||{};var te,G={};function Y(ee,ne){return a.coerce(K||{},G,m,ee,ne)}if(Y("mode"),Y("direction"),Y("fromcurrent"),Array.isArray(K.frame))for(G.frame=[],te=0;te<K.frame.length;te++)G.frame[te]=l.supplyAnimationFrameDefaults(K.frame[te]||{});else G.frame=l.supplyAnimationFrameDefaults(K.frame||{});if(Array.isArray(K.transition))for(G.transition=[],te=0;te<K.transition.length;te++)G.transition[te]=l.supplyAnimationTransitionDefaults(K.transition[te]||{});else G.transition=l.supplyAnimationTransitionDefaults(K.transition||{});return G},l.supplyAnimationFrameDefaults=function(K){var te={};function G(Y,ee){return a.coerce(K||{},te,m.frame,Y,ee)}return G("duration"),G("redraw"),te},l.supplyAnimationTransitionDefaults=function(K){var te={};function G(Y,ee){return a.coerce(K||{},te,m.transition,Y,ee)}return G("duration"),G("easing"),te},l.supplyFrameDefaults=function(K){var te={};function G(Y,ee){return a.coerce(K,te,g,Y,ee)}return G("group"),G("name"),G("traces"),G("baseframe"),G("data"),G("layout"),te},l.supplyTraceDefaults=function(K,te,G,Y,ee){var ne=Y.colorway||r.defaults,J=ne[G%ne.length],q;function ae(Se,De){return a.coerce(K,te,l.attributes,Se,De)}var le=ae("visible");ae("type"),ae("name",Y._traceWord+" "+ee),ae("uirevision",Y.uirevision);var ie=l.getModule(te);if(te._module=ie,ie){var se=ie.basePlotModule,xe=se.attr,oe=se.attributes;if(xe&&oe){var he=Y._subplots,be="";if(le||se.name!=="gl2d"){if(Array.isArray(xe))for(q=0;q<xe.length;q++){var me=xe[q],_e=a.coerce(K,te,oe,me);he[me]&&a.pushUnique(he[me],_e),be+=_e}else be=a.coerce(K,te,oe,xe);he[se.name]&&a.pushUnique(he[se.name],be)}}}return le&&(ae("customdata"),ae("ids"),ae("meta"),e.traceIs(te,"showLegend")?(a.coerce(K,te,ie.attributes.showlegend?ie.attributes:l.attributes,"showlegend"),ae("legendwidth"),ae("legendgroup"),ae("legendgrouptitle.text"),ae("legendrank"),te._dfltShowLegend=!0):te._dfltShowLegend=!1,ie&&ie.supplyDefaults(K,te,J,Y),e.traceIs(te,"noOpacity")||ae("opacity"),e.traceIs(te,"notLegendIsolatable")&&(te.visible=!!te.visible),e.traceIs(te,"noHover")||(te.hovertemplate||a.coerceHoverinfo(K,te,Y),te.type!=="parcats"&&e.getComponentMethod("fx","supplyDefaults")(K,te,J,Y)),ie&&ie.selectPoints&&ae("selectedpoints"),l.supplyTransformDefaults(K,te,Y)),te};function B(K){var te=K.transforms;if(Array.isArray(te)&&te.length)for(var G=0;G<te.length;G++){var Y=te[G],ee=Y._module||b[Y.type];if(ee&&ee.makesData)return!0}return!1}l.hasMakesDataTransform=B,l.supplyTransformDefaults=function(K,te,G){if(!!(te._length||B(K))){var Y=G._globalTransforms||[],ee=G._transformModules||[];if(!(!Array.isArray(K.transforms)&&Y.length===0))for(var ne=K.transforms||[],J=Y.concat(ne),q=te.transforms=[],ae=0;ae<J.length;ae++){var le=J[ae],ie=le.type,se=b[ie],xe,oe=!(le._module&&le._module===se),he=se&&typeof se.transform=="function";se||a.warn("Unrecognized transform type "+ie+"."),se&&se.supplyDefaults&&(oe||he)?(xe=se.supplyDefaults(le,te,G,K),xe.type=ie,xe._module=se,a.pushUnique(ee,se)):xe=a.extendFlat({},le),q.push(xe)}}};function z(K,te,G,Y){for(var ee=K.transforms,ne=[K],J=0;J<ee.length;J++){var q=ee[J],ae=b[q.type];ae&&ae.transform&&(ne=ae.transform(ne,{transform:q,fullTrace:K,fullData:te,layout:G,fullLayout:Y,transformIndex:J}))}return ne}l.supplyLayoutGlobalDefaults=function(K,te,G){function Y(le,ie){return a.coerce(K,te,l.layoutAttributes,le,ie)}var ee=K.template;a.isPlainObject(ee)&&(te.template=ee,te._template=ee.layout,te._dataTemplate=ee.data),Y("autotypenumbers");var ne=a.coerceFont(Y,"font"),J=ne.size;a.coerceFont(Y,"title.font",a.extendFlat({},ne,{size:Math.round(J*1.4)})),Y("title.text",te._dfltTitle.plot),Y("title.xref"),Y("title.yref"),Y("title.x"),Y("title.y"),Y("title.xanchor"),Y("title.yanchor"),Y("title.pad.t"),Y("title.pad.r"),Y("title.pad.b"),Y("title.pad.l");var q=Y("uniformtext.mode");q&&Y("uniformtext.minsize"),Y("autosize",!(K.width&&K.height)),Y("width"),Y("height"),Y("minreducedwidth"),Y("minreducedheight"),Y("margin.l"),Y("margin.r"),Y("margin.t"),Y("margin.b"),Y("margin.pad"),Y("margin.autoexpand"),K.width&&K.height&&l.sanitizeMargins(te),e.getComponentMethod("grid","sizeDefaults")(K,te),Y("paper_bgcolor"),Y("separators",G.decimal+G.thousands),Y("hidesources"),Y("colorway"),Y("datarevision");var ae=Y("uirevision");Y("editrevision",ae),Y("selectionrevision",ae),e.getComponentMethod("modebar","supplyLayoutDefaults")(K,te),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(K,te,Y),e.getComponentMethod("selections","supplyDrawNewSelectionDefaults")(K,te,Y),Y("meta"),a.isPlainObject(K.transition)&&(Y("transition.duration"),Y("transition.easing"),Y("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(K,te,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(K,te,Y)};function F(K){return typeof K=="string"&&K.substr(K.length-2)==="px"&&parseFloat(K)}l.plotAutoSize=function(te,G,Y){var ee=te._context||{},ne=ee.frameMargins,J,q,ae=a.isPlotDiv(te);if(ae&&te.emit("plotly_autosize"),ee.fillFrame)J=window.innerWidth,q=window.innerHeight,document.body.style.overflow="hidden";else{var le=ae?window.getComputedStyle(te):{};if(J=F(le.width)||F(le.maxWidth)||Y.width,q=F(le.height)||F(le.maxHeight)||Y.height,T(ne)&&ne>0){var ie=1-2*ne;J=Math.round(ie*J),q=Math.round(ie*q)}}var se=l.layoutAttributes.width.min,xe=l.layoutAttributes.height.min;J<se&&(J=se),q<xe&&(q=xe);var oe=!G.width&&Math.abs(Y.width-J)>1,he=!G.height&&Math.abs(Y.height-q)>1;(he||oe)&&(oe&&(Y.width=J),he&&(Y.height=q)),te._initialAutoSize||(te._initialAutoSize={width:J,height:q}),l.sanitizeMargins(Y)},l.supplyLayoutModuleDefaults=function(K,te,G,Y){var ee=e.componentsRegistry,ne=te._basePlotModules,J,q,ae,le=e.subplotsRegistry.cartesian;for(J in ee)ae=ee[J],ae.includeBasePlot&&ae.includeBasePlot(K,te);ne.length||ne.push(le),te._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(K,te),le.finalizeSubplots(K,te));for(var ie in te._subplots)te._subplots[ie].sort(a.subplotSort);for(q=0;q<ne.length;q++)ae=ne[q],ae.supplyLayoutDefaults&&ae.supplyLayoutDefaults(K,te,G);var se=te._modules;for(q=0;q<se.length;q++)ae=se[q],ae.supplyLayoutDefaults&&ae.supplyLayoutDefaults(K,te,G);var xe=te._transformModules;for(q=0;q<xe.length;q++)ae=xe[q],ae.supplyLayoutDefaults&&ae.supplyLayoutDefaults(K,te,G,Y);for(J in ee)ae=ee[J],ae.supplyLayoutDefaults&&ae.supplyLayoutDefaults(K,te,G)},l.purge=function(K){var te=K._fullLayout||{};te._glcontainer!==void 0&&(te._glcontainer.selectAll(".gl-canvas").remove(),te._glcontainer.remove(),te._glcanvas=null),te._modeBar&&te._modeBar.destroy(),K._transitionData&&(K._transitionData._interruptCallbacks&&(K._transitionData._interruptCallbacks.length=0),K._transitionData._animationRaf&&window.cancelAnimationFrame(K._transitionData._animationRaf)),a.clearThrottle(),a.clearResponsive(K),delete K.data,delete K.layout,delete K._fullData,delete K._fullLayout,delete K.calcdata,delete K.empty,delete K.fid,delete K.undoqueue,delete K.undonum,delete K.autoplay,delete K.changed,delete K._promises,delete K._redrawTimer,delete K._hmlumcount,delete K._hmpixcount,delete K._transitionData,delete K._transitioning,delete K._initialAutoSize,delete K._transitioningWithDuration,delete K._dragging,delete K._dragged,delete K._dragdata,delete K._hoverdata,delete K._snapshotInProgress,delete K._editing,delete K._mouseDownTime,delete K._legendMouseDownTime,K.removeAllListeners&&K.removeAllListeners()},l.style=function(K){var te=K._fullLayout._visibleModules,G=[],Y;for(Y=0;Y<te.length;Y++){var ee=te[Y];ee.style&&a.pushUnique(G,ee.style)}for(Y=0;Y<G.length;Y++)G[Y](K)},l.sanitizeMargins=function(K){if(!(!K||!K.margin)){var te=K.width,G=K.height,Y=K.margin,ee=te-(Y.l+Y.r),ne=G-(Y.t+Y.b),J;ee<0&&(J=(te-1)/(Y.l+Y.r),Y.l=Math.floor(J*Y.l),Y.r=Math.floor(J*Y.r)),ne<0&&(J=(G-1)/(Y.t+Y.b),Y.t=Math.floor(J*Y.t),Y.b=Math.floor(J*Y.b))}},l.clearAutoMarginIds=function(K){K._fullLayout._pushmarginIds={}},l.allowAutoMargin=function(K,te){K._fullLayout._pushmarginIds[te]=1};function I(K){var te=K.margin;if(!K._size){var G=K._size={l:Math.round(te.l),r:Math.round(te.r),t:Math.round(te.t),b:Math.round(te.b),p:Math.round(te.pad)};G.w=Math.round(K.width)-G.l-G.r,G.h=Math.round(K.height)-G.t-G.b}K._pushmargin||(K._pushmargin={}),K._pushmarginIds||(K._pushmarginIds={})}var O=2,N=2;l.autoMargin=function(K,te,G){var Y=K._fullLayout,ee=Y.width,ne=Y.height,J=Y.margin,q=Y.minreducedwidth,ae=Y.minreducedheight,le=a.constrain(ee-J.l-J.r,O,q),ie=a.constrain(ne-J.t-J.b,N,ae),se=Math.max(0,ee-le),xe=Math.max(0,ne-ie),oe=Y._pushmargin,he=Y._pushmarginIds;if(J.autoexpand!==!1){if(!G)delete oe[te],delete he[te];else{var be=G.pad;if(be===void 0&&(be=Math.min(12,J.l,J.r,J.t,J.b)),se){var me=(G.l+G.r)/se;me>1&&(G.l/=me,G.r/=me)}if(xe){var _e=(G.t+G.b)/xe;_e>1&&(G.t/=_e,G.b/=_e)}var Se=G.xl!==void 0?G.xl:G.x,De=G.xr!==void 0?G.xr:G.x,Ie=G.yt!==void 0?G.yt:G.y,Te=G.yb!==void 0?G.yb:G.y;oe[te]={l:{val:Se,size:G.l+be},r:{val:De,size:G.r+be},b:{val:Te,size:G.b+be},t:{val:Ie,size:G.t+be}},he[te]=1}if(!Y._replotting)return l.doAutoMargin(K)}},l.doAutoMargin=function(K){var te=K._fullLayout,G=te.width,Y=te.height;te._size||(te._size={}),I(te);var ee=te._size,ne=te.margin,J=a.extendFlat({},ee),q=ne.l,ae=ne.r,le=ne.t,ie=ne.b,se=te._pushmargin,xe=te._pushmarginIds,oe=te.minreducedwidth,he=te.minreducedheight;if(te.margin.autoexpand!==!1){for(var be in se)xe[be]||delete se[be];se.base={l:{val:0,size:q},r:{val:1,size:ae},t:{val:1,size:le},b:{val:0,size:ie}};for(var me in se){var _e=se[me].l||{},Se=se[me].b||{},De=_e.val,Ie=_e.size,Te=Se.val,Ce=Se.size;for(var He in se){if(T(Ie)&&se[He].r){var Xe=se[He].r.val,Be=se[He].r.size;if(Xe>De){var Re=(Ie*Xe+(Be-G)*De)/(Xe-De),We=(Be*(1-De)+(Ie-G)*(1-Xe))/(Xe-De);Re+We>q+ae&&(q=Re,ae=We)}}if(T(Ce)&&se[He].t){var vt=se[He].t.val,Pt=se[He].t.size;if(vt>Te){var Zt=(Ce*vt+(Pt-Y)*Te)/(vt-Te),zt=(Pt*(1-Te)+(Ce-Y)*(1-vt))/(vt-Te);Zt+zt>ie+le&&(ie=Zt,le=zt)}}}}}var At=a.constrain(G-ne.l-ne.r,O,oe),Wt=a.constrain(Y-ne.t-ne.b,N,he),Bt=Math.max(0,G-At),Ct=Math.max(0,Y-Wt);if(Bt){var Ze=(q+ae)/Bt;Ze>1&&(q/=Ze,ae/=Ze)}if(Ct){var nt=(ie+le)/Ct;nt>1&&(ie/=nt,le/=nt)}if(ee.l=Math.round(q),ee.r=Math.round(ae),ee.t=Math.round(le),ee.b=Math.round(ie),ee.p=Math.round(ne.pad),ee.w=Math.round(G)-ee.l-ee.r,ee.h=Math.round(Y)-ee.t-ee.b,!te._replotting&&l.didMarginChange(J,ee)){"_redrawFromAutoMarginCount"in te?te._redrawFromAutoMarginCount++:te._redrawFromAutoMarginCount=1;var Ye=3*(1+Object.keys(xe).length);if(te._redrawFromAutoMarginCount<Ye)return e.call("_doPlot",K);te._size=J,a.warn("Too many auto-margin redraws.")}V(K)};function V(K){var te=o.list(K,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(G){for(var Y=0;Y<te.length;Y++){var ee=te[Y][G];ee&&ee()}})}var H=["l","r","t","b","p","w","h"];l.didMarginChange=function(K,te){for(var G=0;G<H.length;G++){var Y=H[G],ee=K[Y],ne=te[Y];if(!T(ee)||Math.abs(ne-ee)>1)return!0}return!1},l.graphJson=function(K,te,G,Y,ee,ne){(ee&&te&&!K._fullData||ee&&!te&&!K._fullLayout)&&l.supplyDefaults(K);var J=ee?K._fullData:K.data,q=ee?K._fullLayout:K.layout,ae=(K._transitionData||{})._frames;function le(xe,oe){if(typeof xe=="function")return oe?"_function_":null;if(a.isPlainObject(xe)){var he={},be;return Object.keys(xe).sort().forEach(function(me){if(["_","["].indexOf(me.charAt(0))===-1){if(typeof xe[me]=="function"){oe&&(he[me]="_function");return}if(G==="keepdata"){if(me.substr(me.length-3)==="src")return}else if(G==="keepstream"){if(be=xe[me+"src"],typeof be=="string"&&be.indexOf(":")>0&&!a.isPlainObject(xe.stream))return}else if(G!=="keepall"&&(be=xe[me+"src"],typeof be=="string"&&be.indexOf(":")>0))return;he[me]=le(xe[me],oe)}}),he}return Array.isArray(xe)?xe.map(function(me){return le(me,oe)}):a.isTypedArray(xe)?a.simpleMap(xe,a.identity):a.isJSDate(xe)?a.ms2DateTimeLocal(+xe):xe}var ie={data:(J||[]).map(function(xe){var oe=le(xe);return te&&delete oe.fit,oe})};if(!te&&(ie.layout=le(q),ee)){var se=q._size;ie.layout.computed={margin:{b:se.b,l:se.l,r:se.r,t:se.t}}}return ae&&(ie.frames=le(ae)),ne&&(ie.config=le(K._context,!0)),Y==="object"?ie:JSON.stringify(ie)},l.modifyFrames=function(K,te){var G,Y,ee,ne=K._transitionData._frames,J=K._transitionData._frameHash;for(G=0;G<te.length;G++)switch(Y=te[G],Y.type){case"replace":ee=Y.value;var q=(ne[Y.index]||{}).name,ae=ee.name;ne[Y.index]=J[ae]=ee,ae!==q&&(delete J[q],J[ae]=ee);break;case"insert":ee=Y.value,J[ee.name]=ee,ne.splice(Y.index,0,ee);break;case"delete":ee=ne[Y.index],delete J[ee.name],ne.splice(Y.index,1);break}return Promise.resolve()},l.computeFrame=function(K,te){var G=K._transitionData._frameHash,Y,ee,ne,J;if(!te)throw new Error("computeFrame must be given a string frame name");var q=G[te.toString()];if(!q)return!1;for(var ae=[q],le=[q.name];q.baseframe&&(q=G[q.baseframe.toString()])&&le.indexOf(q.name)===-1;)ae.push(q),le.push(q.name);for(var ie={};q=ae.pop();)if(q.layout&&(ie.layout=l.extendLayout(ie.layout,q.layout)),q.data){if(ie.data||(ie.data=[]),ee=q.traces,!ee)for(ee=[],Y=0;Y<q.data.length;Y++)ee[Y]=Y;for(ie.traces||(ie.traces=[]),Y=0;Y<q.data.length;Y++)ne=ee[Y],ne!=null&&(J=ie.traces.indexOf(ne),J===-1&&(J=ie.data.length,ie.traces[J]=ne),ie.data[J]=l.extendTrace(ie.data[J],q.data[Y]))}return ie},l.recomputeFrameHash=function(K){for(var te=K._transitionData._frameHash={},G=K._transitionData._frames,Y=0;Y<G.length;Y++){var ee=G[Y];ee&&ee.name&&(te[ee.name]=ee)}},l.extendObjectWithContainers=function(K,te,G){var Y,ee,ne,J,q,ae,le,ie,se=a.extendDeepNoArrays({},te||{}),xe=a.expandObjectPaths(se),oe={};if(G&&G.length)for(ne=0;ne<G.length;ne++)Y=a.nestedProperty(xe,G[ne]),ee=Y.get(),ee===void 0?a.nestedProperty(oe,G[ne]).set(null):(Y.set(null),a.nestedProperty(oe,G[ne]).set(ee));if(K=a.extendDeepNoArrays(K||{},xe),G&&G.length){for(ne=0;ne<G.length;ne++)if(q=a.nestedProperty(oe,G[ne]),le=q.get(),!!le){for(ae=a.nestedProperty(K,G[ne]),ie=ae.get(),Array.isArray(ie)||(ie=[],ae.set(ie)),J=0;J<le.length;J++){var he=le[J];he===null?ie[J]=null:ie[J]=l.extendObjectWithContainers(ie[J],he)}ae.set(ie)}}return K},l.dataArrayContainers=["transforms","dimensions"],l.layoutArrayContainers=e.layoutArrayContainers,l.extendTrace=function(K,te){return l.extendObjectWithContainers(K,te,l.dataArrayContainers)},l.extendLayout=function(K,te){return l.extendObjectWithContainers(K,te,l.layoutArrayContainers)},l.transition=function(K,te,G,Y,ee,ne){var J={redraw:ee.redraw},q={},ae=[];return J.prepareFn=function(){for(var le=Array.isArray(te)?te.length:0,ie=Y.slice(0,le),se=0;se<ie.length;se++){var xe=ie[se],oe=K._fullData[xe],he=oe._module;if(!!he){if(he.animatable){var be=he.basePlotModule.name;q[be]||(q[be]=[]),q[be].push(xe)}K.data[ie[se]]=l.extendTrace(K.data[ie[se]],te[se])}}var me=a.expandObjectPaths(a.extendDeepNoArrays({},G)),_e=/^[xy]axis[0-9]*$/;for(var Se in me)!_e.test(Se)||delete me[Se].range;l.extendLayout(K.layout,me),delete K.calcdata,l.supplyDefaults(K),l.doCalcdata(K);var De=a.expandObjectPaths(G);if(De){var Ie=K._fullLayout._plots;for(var Te in Ie){var Ce=Ie[Te],He=Ce.xaxis,Xe=Ce.yaxis,Be=He.range.slice(),Re=Xe.range.slice(),We=null,vt=null,Pt=null,Zt=null;Array.isArray(De[He._name+".range"])?We=De[He._name+".range"].slice():Array.isArray((De[He._name]||{}).range)&&(We=De[He._name].range.slice()),Array.isArray(De[Xe._name+".range"])?vt=De[Xe._name+".range"].slice():Array.isArray((De[Xe._name]||{}).range)&&(vt=De[Xe._name].range.slice()),Be&&We&&(He.r2l(Be[0])!==He.r2l(We[0])||He.r2l(Be[1])!==He.r2l(We[1]))&&(Pt={xr0:Be,xr1:We}),Re&&vt&&(Xe.r2l(Re[0])!==Xe.r2l(vt[0])||Xe.r2l(Re[1])!==Xe.r2l(vt[1]))&&(Zt={yr0:Re,yr1:vt}),(Pt||Zt)&&ae.push(a.extendFlat({plotinfo:Ce},Pt,Zt))}}return Promise.resolve()},J.runFn=function(le){var ie,se=K._fullLayout._basePlotModules,xe=ae.length,oe;if(G)for(oe=0;oe<se.length;oe++)se[oe].transitionAxes&&se[oe].transitionAxes(K,ae,ne,le);xe?(ie=a.extendFlat({},ne),ie.duration=0,delete q.cartesian):ie=ne;for(var he in q){var be=q[he],me=K._fullData[be[0]]._module;me.basePlotModule.plot(K,be,ie,le)}},j(K,ne,J)},l.transitionFromReact=function(K,te,G,Y){var ee=K._fullLayout,ne=ee.transition,J={},q=[];return J.prepareFn=function(){var ae=ee._plots;J.redraw=!1,te.anim==="some"&&(J.redraw=!0),G.anim==="some"&&(J.redraw=!0);for(var le in ae){var ie=ae[le],se=ie.xaxis,xe=ie.yaxis,oe=Y[se._name].range.slice(),he=Y[xe._name].range.slice(),be=se.range.slice(),me=xe.range.slice();se.setScale(),xe.setScale();var _e=null,Se=null;(se.r2l(oe[0])!==se.r2l(be[0])||se.r2l(oe[1])!==se.r2l(be[1]))&&(_e={xr0:oe,xr1:be}),(xe.r2l(he[0])!==xe.r2l(me[0])||xe.r2l(he[1])!==xe.r2l(me[1]))&&(Se={yr0:he,yr1:me}),(_e||Se)&&q.push(a.extendFlat({plotinfo:ie},_e,Se))}return Promise.resolve()},J.runFn=function(ae){for(var le=K._fullData,ie=K._fullLayout,se=ie._basePlotModules,xe,oe,he,be=[],me=0;me<le.length;me++)be.push(me);function _e(){if(!!K._fullLayout)for(var De=0;De<se.length;De++)se[De].transitionAxes&&se[De].transitionAxes(K,q,xe,ae)}function Se(){if(!!K._fullLayout)for(var De=0;De<se.length;De++)se[De].plot(K,he,oe,ae)}q.length&&te.anim?ne.ordering==="traces first"?(xe=a.extendFlat({},ne,{duration:0}),he=be,oe=ne,setTimeout(_e,ne.duration),Se()):(xe=ne,he=null,oe=a.extendFlat({},ne,{duration:0}),setTimeout(Se,xe.duration),_e()):q.length?(xe=ne,_e()):te.anim&&(he=be,oe=ne,Se())},j(K,ne,J)};function j(K,te,G){var Y=!1;function ee(se){var xe=Promise.resolve();if(!se)return xe;for(;se.length;)xe=xe.then(se.shift());return xe}function ne(se){if(!!se)for(;se.length;)se.shift()}function J(){return K.emit("plotly_transitioning",[]),new Promise(function(se){K._transitioning=!0,te.duration>0&&(K._transitioningWithDuration=!0),K._transitionData._interruptCallbacks.push(function(){Y=!0}),G.redraw&&K._transitionData._interruptCallbacks.push(function(){return e.call("redraw",K)}),K._transitionData._interruptCallbacks.push(function(){K.emit("plotly_transitioninterrupted",[])});var xe=0,oe=0;function he(){return xe++,function(){oe++,!Y&&oe===xe&&q(se)}}G.runFn(he),setTimeout(he())})}function q(se){if(!!K._transitionData)return ne(K._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(G.redraw)return e.call("redraw",K)}).then(function(){K._transitioning=!1,K._transitioningWithDuration=!1,K.emit("plotly_transitioned",[])}).then(se)}function ae(){if(!!K._transitionData)return K._transitioning=!1,ee(K._transitionData._interruptCallbacks)}var le=[l.previousPromises,ae,G.prepareFn,l.rehover,l.reselect,J],ie=a.syncOrAsync(le,K);return(!ie||!ie.then)&&(ie=Promise.resolve()),ie.then(function(){return K})}l.doCalcdata=function(K,te){var G=o.list(K),Y=K._fullData,ee=K._fullLayout,ne,J,q,ae,le=new Array(Y.length),ie=(K.calcdata||[]).slice();for(K.calcdata=le,ee._numBoxes=0,ee._numViolins=0,ee._violinScaleGroupStats={},K._hmpixcount=0,K._hmlumcount=0,ee._piecolormap={},ee._sunburstcolormap={},ee._treemapcolormap={},ee._iciclecolormap={},ee._funnelareacolormap={},q=0;q<Y.length;q++)if(Array.isArray(te)&&te.indexOf(q)===-1){le[q]=ie[q];continue}for(q=0;q<Y.length;q++)ne=Y[q],ne._arrayAttrs=i.findArrayAttributes(ne),ne._extremes={};var se=ee._subplots.polar||[];for(q=0;q<se.length;q++)G.push(ee[se[q]].radialaxis,ee[se[q]].angularaxis);for(var xe in ee._colorAxes){var oe=ee[xe];oe.cauto!==!1&&(delete oe.cmin,delete oe.cmax)}var he=!1;function be(Se){if(ne=Y[Se],J=ne._module,ne.visible===!0&&ne.transforms){if(J&&J.calc){var De=J.calc(K,ne);De[0]&&De[0].t&&De[0].t._scene&&delete De[0].t._scene.dirty}for(ae=0;ae<ne.transforms.length;ae++){var Ie=ne.transforms[ae];J=b[Ie.type],J&&J.calcTransform&&(ne._hasCalcTransform=!0,he=!0,J.calcTransform(K,ne,Ie))}}}function me(Se,De){if(ne=Y[Se],J=ne._module,!!J.isContainer===De){var Ie=[];if(ne.visible===!0&&ne._length!==0){delete ne._indexToPoints;var Te=ne.transforms||[];for(ae=Te.length-1;ae>=0;ae--)if(Te[ae].enabled){ne._indexToPoints=Te[ae]._indexToPoints;break}J&&J.calc&&(Ie=J.calc(K,ne))}(!Array.isArray(Ie)||!Ie[0])&&(Ie=[{x:f,y:f}]),Ie[0].t||(Ie[0].t={}),Ie[0].trace=ne,le[Se]=Ie}}for(re(G,Y,ee),q=0;q<Y.length;q++)me(q,!0);for(q=0;q<Y.length;q++)be(q);for(he&&re(G,Y,ee),q=0;q<Y.length;q++)me(q,!0);for(q=0;q<Y.length;q++)me(q,!1);ue(K);var _e=X(G,K);if(_e.length){for(ee._numBoxes=0,ee._numViolins=0,q=0;q<_e.length;q++)me(_e[q],!0);for(q=0;q<_e.length;q++)me(_e[q],!1);ue(K)}e.getComponentMethod("fx","calc")(K),e.getComponentMethod("errorbars","calc")(K)};var Z=/(total|sum|min|max|mean|median) (ascending|descending)/;function X(K,te){var G=[],Y,ee,ne,J,q;function ae(At,Wt,Bt){var Ct=Wt._id.charAt(0);if(At==="histogram2dcontour"){var Ze=Wt._counterAxes[0],nt=o.getFromId(te,Ze),Ye=Ct==="x"||Ze==="x"&&nt.type==="category",Ee=Ct==="y"||Ze==="y"&&nt.type==="category";return function(Ge,Je){return Ge===0||Je===0||Ye&&Ge===Bt[Je].length-1||Ee&&Je===Bt.length-1?-1:(Ct==="y"?Je:Ge)-1}}else return function(Ge,Je){return Ct==="y"?Je:Ge}}var le={min:function(At){return a.aggNums(Math.min,null,At)},max:function(At){return a.aggNums(Math.max,null,At)},sum:function(At){return a.aggNums(function(Wt,Bt){return Wt+Bt},null,At)},total:function(At){return a.aggNums(function(Wt,Bt){return Wt+Bt},null,At)},mean:function(At){return a.mean(At)},median:function(At){return a.median(At)}};for(Y=0;Y<K.length;Y++){var ie=K[Y];if(ie.type==="category"){var se=ie.categoryorder.match(Z);if(se){var xe=se[1],oe=se[2],he=ie._id.charAt(0),be=he==="x",me=[];for(ee=0;ee<ie._categories.length;ee++)me.push([ie._categories[ee],[]]);for(ee=0;ee<ie._traceIndices.length;ee++){var _e=ie._traceIndices[ee],Se=te._fullData[_e];if(Se.visible===!0){var De=Se.type;e.traceIs(Se,"histogram")&&(delete Se._xautoBinFinished,delete Se._yautoBinFinished);var Ie=De==="splom",Te=De==="scattergl",Ce=te.calcdata[_e];for(ne=0;ne<Ce.length;ne++){var He=Ce[ne],Xe,Be;if(Ie){var Re=Se._axesDim[ie._id];if(!be){var We=Se._diag[Re][0];We&&(ie=te._fullLayout[o.id2name(We)])}var vt=He.trace.dimensions[Re].values;for(J=0;J<vt.length;J++)for(Xe=ie._categoriesMap[vt[J]],q=0;q<He.trace.dimensions.length;q++)if(q!==Re){var Pt=He.trace.dimensions[q];me[Xe][1].push(Pt.values[J])}}else if(Te){for(J=0;J<He.t.x.length;J++)be?(Xe=He.t.x[J],Be=He.t.y[J]):(Xe=He.t.y[J],Be=He.t.x[J]),me[Xe][1].push(Be);He.t&&He.t._scene&&delete He.t._scene.dirty}else if(He.hasOwnProperty("z")){Be=He.z;var Zt=ae(Se.type,ie,Be);for(J=0;J<Be.length;J++)for(q=0;q<Be[J].length;q++)Xe=Zt(q,J),Xe+1&&me[Xe][1].push(Be[J][q])}else for(Xe=He.p,Xe===void 0&&(Xe=He[he]),Be=He.s,Be===void 0&&(Be=He.v),Be===void 0&&(Be=be?He.y:He.x),Array.isArray(Be)||(Be===void 0?Be=[]:Be=[Be]),J=0;J<Be.length;J++)me[Xe][1].push(Be[J])}}}ie._categoriesValue=me;var zt=[];for(ee=0;ee<me.length;ee++)zt.push([me[ee][0],le[xe](me[ee][1])]);zt.sort(function(At,Wt){return At[1]-Wt[1]}),ie._categoriesAggregatedValue=zt,ie._initialCategories=zt.map(function(At){return At[0]}),oe==="descending"&&ie._initialCategories.reverse(),G=G.concat(ie.sortByInitialCategories())}}}return G}function re(K,te,G){var Y={};function ee(ae){ae.clearCalc(),ae.type==="multicategory"&&ae.setupMultiCategory(te),Y[ae._id]=1}a.simpleMap(K,ee);for(var ne=G._axisMatchGroups||[],J=0;J<ne.length;J++)for(var q in ne[J])Y[q]||ee(G[o.id2name(q)])}function ue(K){var te=K._fullLayout,G=te._visibleModules,Y={},ee,ne,J;for(ne=0;ne<G.length;ne++){var q=G[ne],ae=q.crossTraceCalc;if(ae){var le=q.basePlotModule.name;Y[le]?a.pushUnique(Y[le],ae):Y[le]=[ae]}}for(J in Y){var ie=Y[J],se=te._subplots[J];if(Array.isArray(se))for(ee=0;ee<se.length;ee++){var xe=se[ee],oe=J==="cartesian"?te._plots[xe]:te[xe];for(ne=0;ne<ie.length;ne++)ie[ne](K,oe,xe)}else for(ne=0;ne<ie.length;ne++)ie[ne](K)}}l.rehover=function(K){K._fullLayout._rehover&&K._fullLayout._rehover()},l.redrag=function(K){K._fullLayout._redrag&&K._fullLayout._redrag()},l.reselect=function(K){var te=K._fullLayout,G=(K.layout||{}).selections,Y=te._previousSelections;te._previousSelections=G;var ee=te._reselect||JSON.stringify(G)!==JSON.stringify(Y);e.getComponentMethod("selections","reselect")(K,ee)},l.generalUpdatePerTraceModule=function(K,te,G,Y){var ee=te.traceHash,ne={},J;for(J=0;J<G.length;J++){var q=G[J],ae=q[0].trace;ae.visible&&(ne[ae.type]=ne[ae.type]||[],ne[ae.type].push(q))}for(var le in ee)if(!ne[le]){var ie=ee[le][0],se=ie[0].trace;se.visible=!1,ne[le]=[ie]}for(var xe in ne){var oe=ne[xe],he=oe[0][0].trace._module;he.plot(K,te,a.filterVisible(oe),Y)}te.traceHash=ne},l.plotBasePlot=function(K,te,G,Y,ee){var ne=e.getModule(K),J=p(te.calcdata,ne)[0];ne.plot(te,J,Y,ee)},l.cleanBasePlot=function(K,te,G,Y,ee){var ne=ee._has&&ee._has(K),J=G._has&&G._has(K);ne&&!J&&ee["_"+K+"layer"].selectAll("g.trace").remove()}},{"../components/color":367,"../components/shapes/handle_outline":468,"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plot_api/plot_template":555,"../plots/get_data":602,"../registry":647,"./animation_attributes":560,"./attributes":562,"./cartesian/axis_ids":570,"./command":592,"./font_attributes":594,"./frame_attributes":595,"./layout_attributes":619,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],629:[function(t,P,R){P.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],630:[function(t,P,R){var h=t("../../lib"),u=t("../../lib/polygon").tester,A=h.findIndexOfMin,T=h.isAngleInsideSector,e=h.angleDelta,i=h.angleDist;function n(b,c,M,_,y){if(!T(c,_))return!1;var w,d;M[0]<M[1]?(w=M[0],d=M[1]):(w=M[1],d=M[0]);var C=u(s(w,_[0],_[1],y)),S=u(s(d,_[0],_[1],y)),E=[b*Math.cos(c),b*Math.sin(c)];return S.contains(E)&&!C.contains(E)}function a(b,c,M,_){var y,w,d=_[0],C=_[1],S=p(Math.sin(c)-Math.sin(b)),E=p(Math.cos(c)-Math.cos(b)),k=Math.tan(M),B=p(1/k),z=S/E,F=C-z*d;return B?S&&E?(y=F/(k-z),w=k*y):E?(y=C*B,w=C):(y=d,w=d*k):S&&E?(y=0,w=F):E?(y=0,w=C):y=w=NaN,[y,w]}function r(b,c,M,_){var y=-c*M,w=c*c+1,d=2*(c*y-M),C=y*y+M*M-b*b,S=Math.sqrt(d*d-4*w*C),E=(-d+S)/(2*w),k=(-d-S)/(2*w);return[[E,c*E+y+_],[k,c*k+y+_]]}function f(b,c){var M=c.length,_=new Array(M+1),y;for(y=0;y<M;y++){var w=c[y];_[y]=[b*Math.cos(w),b*Math.sin(w)]}return _[y]=_[0].slice(),_}function o(b,c,M,_){var y=_.length,w=[],d,C;function S(V){return[b*Math.cos(V),b*Math.sin(V)]}function E(V,H,j){return a(V,H,j,S(V))}function k(V){return h.mod(V,y)}function B(V){return T(V,[c,M])}var z=A(_,function(V){return B(V)?i(V,c):1/0}),F=E(_[z],_[k(z-1)],c);for(w.push(F),d=z,C=0;C<y;d++,C++){var I=_[k(d)];if(!B(I))break;w.push(S(I))}var O=A(_,function(V){return B(V)?i(V,M):1/0}),N=E(_[O],_[k(O+1)],M);return w.push(N),w.push([0,0]),w.push(w[0].slice()),w}function s(b,c,M,_){return h.isFullCircle([c,M])?f(b,_):o(b,c,M,_)}function m(b,c,M,_){for(var y=1/0,w=1/0,d=s(b,c,M,_),C=0;C<d.length;C++){var S=d[C];y=Math.min(y,S[0]),w=Math.min(w,-S[1])}return[y,w]}function g(b,c){var M=function(w){var d=e(w,b);return d>0?d:1/0},_=A(c,M),y=h.mod(_+1,c.length);return[c[_],c[y]]}function p(b){return Math.abs(b)>1e-10?b:0}function v(b,c,M){c=c||0,M=M||0;for(var _=b.length,y=new Array(_),w=0;w<_;w++){var d=b[w];y[w]=[c+d[0],M-d[1]]}return y}function x(b,c,M,_,y,w){var d=s(b,c,M,_);return"M"+v(d,y,w).join("L")}function l(b,c,M,_,y,w,d){var C,S;b<c?(C=b,S=c):(C=c,S=b);var E=v(s(C,M,_,y),w,d),k=v(s(S,M,_,y),w,d);return"M"+k.reverse().join("L")+"M"+E.join("L")}P.exports={isPtInsidePolygon:n,findPolygonOffset:m,findEnclosingVertexAngles:g,findIntersectionXY:a,findXYatLength:r,clampTiny:p,pathPolygon:x,pathPolygonAnnulus:l}},{"../../lib":515,"../../lib/polygon":527}],631:[function(t,P,R){var h=t("../get_data").getSubplotCalcData,u=t("../../lib").counterRegex,A=t("./polar"),T=t("./constants"),e=T.attr,i=T.name,n=u(i),a={};a[e]={valType:"subplotid",dflt:i,editType:"calc"};function r(o){for(var s=o._fullLayout,m=o.calcdata,g=s._subplots[i],p=0;p<g.length;p++){var v=g[p],x=h(m,i,v),l=s[v]._subplot;l||(l=A(o,v),s[v]._subplot=l),l.plot(x,s,o._promises)}}function f(o,s,m,g){for(var p=g._subplots[i]||[],v=g._has&&g._has("gl"),x=s._has&&s._has("gl"),l=v&&!x,b=0;b<p.length;b++){var c=p[b],M=g[c]._subplot;if(!s[c]&&!!M){M.framework.remove(),M.layers["radial-axis-title"].remove();for(var _ in M.clipPaths)M.clipPaths[_].remove()}l&&M._scene&&(M._scene.destroy(),M._scene=null)}}P.exports={attr:e,name:i,idRoot:i,idRegex:n,attrRegex:n,attributes:a,layoutAttributes:t("./layout_attributes"),supplyLayoutDefaults:t("./layout_defaults"),plot:r,clean:f,toSVG:t("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"./constants":629,"./layout_attributes":632,"./layout_defaults":633,"./polar":634}],632:[function(t,P,R){var h=t("../../components/color/attributes"),u=t("../cartesian/layout_attributes"),A=t("../domain").attributes,T=t("../../lib").extendFlat,e=t("../../plot_api/edit_types").overrideAll,i=e({color:u.color,showline:T({},u.showline,{dflt:!0}),linecolor:u.linecolor,linewidth:u.linewidth,showgrid:T({},u.showgrid,{dflt:!0}),gridcolor:u.gridcolor,gridwidth:u.gridwidth,griddash:u.griddash},"plot","from-root"),n=e({tickmode:u.tickmode,nticks:u.nticks,tick0:u.tick0,dtick:u.dtick,tickvals:u.tickvals,ticktext:u.ticktext,ticks:u.ticks,ticklen:u.ticklen,tickwidth:u.tickwidth,tickcolor:u.tickcolor,ticklabelstep:u.ticklabelstep,showticklabels:u.showticklabels,showtickprefix:u.showtickprefix,tickprefix:u.tickprefix,showticksuffix:u.showticksuffix,ticksuffix:u.ticksuffix,showexponent:u.showexponent,exponentformat:u.exponentformat,minexponent:u.minexponent,separatethousands:u.separatethousands,tickfont:u.tickfont,tickangle:u.tickangle,tickformat:u.tickformat,tickformatstops:u.tickformatstops,layer:u.layer},"plot","from-root"),a={visible:T({},u.visible,{dflt:!0}),type:T({},u.type,{values:["-","linear","log","date","category"]}),autotypenumbers:u.autotypenumbers,autorange:T({},u.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:T({},u.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:u.categoryorder,categoryarray:u.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:T({},u.title.text,{editType:"plot",dflt:""}),font:T({},u.title.font,{editType:"plot"}),editType:"plot"},hoverformat:u.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:u._deprecated.title,titlefont:u._deprecated.titlefont}};T(a,i,n);var r={visible:T({},u.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:u.autotypenumbers,categoryorder:u.categoryorder,categoryarray:u.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:u.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};T(r,i,n),P.exports={domain:A({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:h.background},radialaxis:a,angularaxis:r,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],633:[function(t,P,R){var h=t("../../lib"),u=t("../../components/color"),A=t("../../plot_api/plot_template"),T=t("../subplot_defaults"),e=t("../get_data").getSubplotData,i=t("../cartesian/tick_value_defaults"),n=t("../cartesian/tick_mark_defaults"),a=t("../cartesian/tick_label_defaults"),r=t("../cartesian/prefix_suffix_defaults"),f=t("../cartesian/category_order_defaults"),o=t("../cartesian/line_grid_defaults"),s=t("../cartesian/axis_autotype"),m=t("./layout_attributes"),g=t("./set_convert"),p=t("./constants"),v=p.axisNames;function x(b,c,M,_){var y=M("bgcolor");_.bgColor=u.combine(y,_.paper_bgcolor);var w=M("sector");M("hole");var d=e(_.fullData,p.name,_.id),C=_.layoutOut,S;function E(K,te){return M(S+"."+K,te)}for(var k=0;k<v.length;k++){S=v[k],h.isPlainObject(b[S])||(b[S]={});var B=b[S],z=A.newContainer(c,S);z._id=z._name=S,z._attr=_.id+"."+S,z._traceIndices=d.map(function(K){return K._expandedIndex});var F=p.axisName2dataArray[S],I=l(B,z,E,d,F,_);f(B,z,E,{axData:d,dataAttr:F});var O=E("visible");switch(g(z,c,C),E("uirevision",c.uirevision),z._m=1,S){case"radialaxis":var N=E("autorange",!z.isValidRange(B.range));B.autorange=N,N&&(I==="linear"||I==="-")&&E("rangemode"),N==="reversed"&&(z._m=-1),E("range"),z.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if(I==="date"){h.log("Polar plots do not support date angular axes yet.");for(var V=0;V<d.length;V++)d[V].visible=!1;I=B.type=z.type="linear"}E(I==="linear"?"thetaunit":"period");var H=E("direction");E("rotation",{counterclockwise:0,clockwise:90}[H]);break}if(r(B,z,E,z.type,{tickSuffixDflt:z.thetaunit==="degrees"?"\xB0":void 0}),O){var j,Z,X,re,ue=_.font||{};j=E("color"),Z=j===B.color?j:ue.color,X=ue.size,re=ue.family,i(B,z,E,z.type),a(B,z,E,z.type,{font:{color:Z,size:X,family:re}}),n(B,z,E,{outerTicks:!0}),o(B,z,E,{dfltColor:j,bgColor:_.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:m[S]}),E("layer"),S==="radialaxis"&&(E("side"),E("angle",w[0]),E("title.text"),h.coerceFont(E,"title.font",{color:Z,size:h.bigFont(X),family:re}))}I!=="category"&&E("hoverformat"),z._input=B}c.angularaxis.type==="category"&&M("gridshape")}function l(b,c,M,_,y,w){var d=M("autotypenumbers",w.autotypenumbersDflt),C=M("type");if(C==="-"){for(var S,E=0;E<_.length;E++)if(_[E].visible){S=_[E];break}S&&S[y]&&(c.type=s(S[y],"gregorian",{noMultiCategory:!0,autotypenumbers:d})),c.type==="-"?c.type="linear":b.type=c.type}return c.type}P.exports=function(c,M,_){T(c,M,_,{type:p.name,attributes:m,handleDefaults:x,font:M.font,autotypenumbersDflt:M.autotypenumbers,paper_bgcolor:M.paper_bgcolor,fullData:_,layoutOut:M})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/axis_autotype":567,"../cartesian/category_order_defaults":571,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../get_data":602,"../subplot_defaults":641,"./constants":629,"./layout_attributes":632,"./set_convert":635}],634:[function(t,P,R){var h=t("@plotly/d3"),u=t("tinycolor2"),A=t("../../registry"),T=t("../../lib"),e=T.strRotate,i=T.strTranslate,n=t("../../components/color"),a=t("../../components/drawing"),r=t("../plots"),f=t("../../plots/cartesian/axes"),o=t("../cartesian/set_convert"),s=t("./set_convert"),m=t("../cartesian/autorange").doAutoRange,g=t("../cartesian/dragbox"),p=t("../../components/dragelement"),v=t("../../components/fx"),x=t("../../components/titles"),l=t("../../components/selections").prepSelect,b=t("../../components/selections").selectOnClick,c=t("../../components/selections").clearOutline,M=t("../../lib/setcursor"),_=t("../../lib/clear_gl_canvases"),y=t("../../plot_api/subroutines").redrawReglTraces,w=t("../../constants/alignment").MID_SHIFT,d=t("./constants"),C=t("./helpers"),S=t("../smith/helpers"),E=S.smith,k=S.reactanceArc,B=S.resistanceArc,z=S.smithTransform,F=T._,I=T.mod,O=T.deg2rad,N=T.rad2deg;function V(ue,K,te){this.isSmith=te||!1,this.id=K,this.gd=ue,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var G=ue._fullLayout,Y="clip"+G._uid+K;this.clipIds.forTraces=Y+"-for-traces",this.clipPaths.forTraces=G._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=G["_"+(te?"smith":"polar")+"layer"].append("g").attr("class",K),this.getHole=function(ee){return this.isSmith?0:ee.hole},this.getSector=function(ee){return this.isSmith?[0,360]:ee.sector},this.getRadial=function(ee){return this.isSmith?ee.realaxis:ee.radialaxis},this.getAngular=function(ee){return this.isSmith?ee.imaginaryaxis:ee.angularaxis},te||(this.radialTickLayout=null,this.angularTickLayout=null)}var H=V.prototype;P.exports=function(K,te,G){return new V(K,te,G)},H.plot=function(ue,K){for(var te=this,G=K[te.id],Y=!1,ee=0;ee<ue.length;ee++){var ne=ue[ee][0].trace;if(ne.cliponaxis===!1){Y=!0;break}}te._hasClipOnAxisFalse=Y,te.updateLayers(K,G),te.updateLayout(K,G),r.generalUpdatePerTraceModule(te.gd,te,ue,G),te.updateFx(K,G),te.isSmith&&(delete G.realaxis.range,delete G.imaginaryaxis.range)},H.updateLayers=function(ue,K){var te=this,G=te.isSmith,Y=te.layers,ee=te.getRadial(K),ne=te.getAngular(K),J=d.layerNames,q=J.indexOf("frontplot"),ae=J.slice(0,q),le=ne.layer==="below traces",ie=ee.layer==="below traces";le&&ae.push("angular-line"),ie&&ae.push("radial-line"),le&&ae.push("angular-axis"),ie&&ae.push("radial-axis"),ae.push("frontplot"),le||ae.push("angular-line"),ie||ae.push("radial-line"),le||ae.push("angular-axis"),ie||ae.push("radial-axis");var se=(G?"smith":"polar")+"sublayer",xe=te.framework.selectAll("."+se).data(ae,String);xe.enter().append("g").attr("class",function(oe){return se+" "+oe}).each(function(oe){var he=Y[oe]=h.select(this);switch(oe){case"frontplot":G||he.append("g").classed("barlayer",!0),he.append("g").classed("scatterlayer",!0);break;case"backplot":he.append("g").classed("maplayer",!0);break;case"plotbg":Y.bg=he.append("path");break;case"radial-grid":he.style("fill","none");break;case"angular-grid":he.style("fill","none");break;case"radial-line":he.append("line").style("fill","none");break;case"angular-line":he.append("path").style("fill","none");break}}),xe.order()},H.updateLayout=function(ue,K){var te=this,G=te.layers,Y=ue._size,ee=te.getRadial(K),ne=te.getAngular(K),J=K.domain.x,q=K.domain.y;te.xOffset=Y.l+Y.w*J[0],te.yOffset=Y.t+Y.h*(1-q[1]);var ae=te.xLength=Y.w*(J[1]-J[0]),le=te.yLength=Y.h*(q[1]-q[0]),ie=te.getSector(K);te.sectorInRad=ie.map(O);var se=te.sectorBBox=Z(ie),xe=se[2]-se[0],oe=se[3]-se[1],he=le/ae,be=Math.abs(oe/xe),me,_e,Se,De,Ie;he>be?(me=ae,_e=ae*be,Ie=(le-_e)/Y.h/2,Se=[J[0],J[1]],De=[q[0]+Ie,q[1]-Ie]):(me=le/be,_e=le,Ie=(ae-me)/Y.w/2,Se=[J[0]+Ie,J[1]-Ie],De=[q[0],q[1]]),te.xLength2=me,te.yLength2=_e,te.xDomain2=Se,te.yDomain2=De;var Te=te.xOffset2=Y.l+Y.w*Se[0],Ce=te.yOffset2=Y.t+Y.h*(1-De[1]),He=te.radius=me/xe,Xe=te.innerRadius=te.getHole(K)*He,Be=te.cx=Te-He*se[0],Re=te.cy=Ce+He*se[3],We=te.cxx=Be-Te,vt=te.cyy=Re-Ce,Pt=ee.side,Zt;Pt==="counterclockwise"?(Zt=Pt,Pt="top"):Pt==="clockwise"&&(Zt=Pt,Pt="bottom"),te.radialAxis=te.mockAxis(ue,K,ee,{_id:"x",side:Pt,_trueSide:Zt,domain:[Xe/Y.w,He/Y.w]}),te.angularAxis=te.mockAxis(ue,K,ne,{side:"right",domain:[0,Math.PI],autorange:!1}),te.doAutoRange(ue,K),te.updateAngularAxis(ue,K),te.updateRadialAxis(ue,K),te.updateRadialAxisTitle(ue,K),te.xaxis=te.mockCartesianAxis(ue,K,{_id:"x",domain:Se}),te.yaxis=te.mockCartesianAxis(ue,K,{_id:"y",domain:De});var zt=te.pathSubplot();te.clipPaths.forTraces.select("path").attr("d",zt).attr("transform",i(We,vt)),G.frontplot.attr("transform",i(Te,Ce)).call(a.setClipUrl,te._hasClipOnAxisFalse?null:te.clipIds.forTraces,te.gd),G.bg.attr("d",zt).attr("transform",i(Be,Re)).call(n.fill,K.bgcolor)},H.mockAxis=function(ue,K,te,G){var Y=T.extendFlat({},te,G);return s(Y,K,ue),Y},H.mockCartesianAxis=function(ue,K,te){var G=this,Y=G.isSmith,ee=te._id,ne=T.extendFlat({type:"linear"},te);o(ne,ue);var J={x:[0,2],y:[1,3]};return ne.setRange=function(){var q=G.sectorBBox,ae=J[ee],le=G.radialAxis._rl,ie=(le[1]-le[0])/(1-G.getHole(K));ne.range=[q[ae[0]]*ie,q[ae[1]]*ie]},ne.isPtWithinRange=ee==="x"&&!Y?function(q){return G.isPtInside(q)}:function(){return!0},ne.setRange(),ne.setScale(),ne},H.doAutoRange=function(ue,K){var te=this,G=te.gd,Y=te.radialAxis,ee=te.getRadial(K);m(G,Y);var ne=Y.range;ee.range=ne.slice(),ee._input.range=ne.slice(),Y._rl=[Y.r2l(ne[0],null,"gregorian"),Y.r2l(ne[1],null,"gregorian")]},H.updateRadialAxis=function(ue,K){var te=this,G=te.gd,Y=te.layers,ee=te.radius,ne=te.innerRadius,J=te.cx,q=te.cy,ae=te.getRadial(K),le=I(te.getSector(K)[0],360),ie=te.radialAxis,se=ne<ee,xe=te.isSmith;xe||(te.fillViewInitialKey("radialaxis.angle",ae.angle),te.fillViewInitialKey("radialaxis.range",ie.range.slice()),ie.setGeometry()),ie.tickangle==="auto"&&le>90&&le<=270&&(ie.tickangle=180);var oe=xe?function(He){var Xe=z(te,E([He.x,0]));return i(Xe[0]-J,Xe[1]-q)}:function(He){return i(ie.l2p(He.x)+ne,0)},he=xe?function(He){return B(te,He.x,-1/0,1/0)}:function(He){return te.pathArc(ie.r2p(He.x)+ne)},be=j(ae);if(te.radialTickLayout!==be&&(Y["radial-axis"].selectAll(".xtick").remove(),te.radialTickLayout=be),se){ie.setScale();var me=0,_e=xe?(ie.tickvals||[]).filter(function(He){return He>=0}).map(function(He){return f.tickText(ie,He,!0,!1)}):f.calcTicks(ie),Se=xe?_e:f.clipEnds(ie,_e),De=f.getTickSigns(ie)[2];xe&&((ie.ticks==="top"&&ie.side==="bottom"||ie.ticks==="bottom"&&ie.side==="top")&&(De=-De),ie.ticks==="top"&&ie.side==="top"&&(me=-ie.ticklen),ie.ticks==="bottom"&&ie.side==="bottom"&&(me=ie.ticklen)),f.drawTicks(G,ie,{vals:_e,layer:Y["radial-axis"],path:f.makeTickPath(ie,0,De),transFn:oe,crisp:!1}),f.drawGrid(G,ie,{vals:Se,layer:Y["radial-grid"],path:he,transFn:T.noop,crisp:!1}),f.drawLabels(G,ie,{vals:_e,layer:Y["radial-axis"],transFn:oe,labelFns:f.makeLabelFns(ie,me)})}var Ie=te.radialAxisAngle=te.vangles?N(X(O(ae.angle),te.vangles)):ae.angle,Te=i(J,q),Ce=Te+e(-Ie);re(Y["radial-axis"],se&&(ae.showticklabels||ae.ticks),{transform:Ce}),re(Y["radial-grid"],se&&ae.showgrid,{transform:xe?"":Te}),re(Y["radial-line"].select("line"),se&&ae.showline,{x1:xe?-ee:ne,y1:0,x2:ee,y2:0,transform:Ce}).attr("stroke-width",ae.linewidth).call(n.stroke,ae.linecolor)},H.updateRadialAxisTitle=function(ue,K,te){if(!this.isSmith){var G=this,Y=G.gd,ee=G.radius,ne=G.cx,J=G.cy,q=G.getRadial(K),ae=G.id+"title",le=0;if(q.title){var ie=a.bBox(G.layers["radial-axis"].node()).height,se=q.title.font.size,xe=q.side;le=xe==="top"?se:xe==="counterclockwise"?-(ie+se*.4):ie+se*.8}var oe=te!==void 0?te:G.radialAxisAngle,he=O(oe),be=Math.cos(he),me=Math.sin(he),_e=ne+ee/2*be+le*me,Se=J-ee/2*me+le*be;G.layers["radial-axis-title"]=x.draw(Y,ae,{propContainer:q,propName:G.id+".radialaxis.title",placeholder:F(Y,"Click to enter radial axis title"),attributes:{x:_e,y:Se,"text-anchor":"middle"},transform:{rotate:-oe}})}},H.updateAngularAxis=function(ue,K){var te=this,G=te.gd,Y=te.layers,ee=te.radius,ne=te.innerRadius,J=te.cx,q=te.cy,ae=te.getAngular(K),le=te.angularAxis,ie=te.isSmith;ie||(te.fillViewInitialKey("angularaxis.rotation",ae.rotation),le.setGeometry(),le.setScale());var se=ie?function(Xe){var Be=z(te,E([0,Xe.x]));return Math.atan2(Be[0]-J,Be[1]-q)-Math.PI/2}:function(Xe){return le.t2g(Xe.x)};le.type==="linear"&&le.thetaunit==="radians"&&(le.tick0=N(le.tick0),le.dtick=N(le.dtick));var xe=function(Xe){return i(J+ee*Math.cos(Xe),q-ee*Math.sin(Xe))},oe=ie?function(Xe){var Be=z(te,E([0,Xe.x]));return i(Be[0],Be[1])}:function(Xe){return xe(se(Xe))},he=ie?function(Xe){var Be=z(te,E([0,Xe.x])),Re=Math.atan2(Be[0]-J,Be[1]-q)-Math.PI/2;return i(Be[0],Be[1])+e(-N(Re))}:function(Xe){var Be=se(Xe);return xe(Be)+e(-N(Be))},be=ie?function(Xe){return k(te,Xe.x,0,1/0)}:function(Xe){var Be=se(Xe),Re=Math.cos(Be),We=Math.sin(Be);return"M"+[J+ne*Re,q-ne*We]+"L"+[J+ee*Re,q-ee*We]},me=f.makeLabelFns(le,0),_e=me.labelStandoff,Se={};Se.xFn=function(Xe){var Be=se(Xe);return Math.cos(Be)*_e},Se.yFn=function(Xe){var Be=se(Xe),Re=Math.sin(Be)>0?.2:1;return-Math.sin(Be)*(_e+Xe.fontSize*Re)+Math.abs(Math.cos(Be))*(Xe.fontSize*w)},Se.anchorFn=function(Xe){var Be=se(Xe),Re=Math.cos(Be);return Math.abs(Re)<.1?"middle":Re>0?"start":"end"},Se.heightFn=function(Xe,Be,Re){var We=se(Xe);return-.5*(1+Math.sin(We))*Re};var De=j(ae);te.angularTickLayout!==De&&(Y["angular-axis"].selectAll("."+le._id+"tick").remove(),te.angularTickLayout=De);var Ie=ie?[1/0].concat(le.tickvals||[]).map(function(Xe){return f.tickText(le,Xe,!0,!1)}):f.calcTicks(le);ie&&(Ie[0].text="\u221E",Ie[0].fontSize*=1.75);var Te;if(K.gridshape==="linear"?(Te=Ie.map(se),T.angleDelta(Te[0],Te[1])<0&&(Te=Te.slice().reverse())):Te=null,te.vangles=Te,le.type==="category"&&(Ie=Ie.filter(function(Xe){return T.isAngleInsideSector(se(Xe),te.sectorInRad)})),le.visible){var Ce=le.ticks==="inside"?-1:1,He=(le.linewidth||1)/2;f.drawTicks(G,le,{vals:Ie,layer:Y["angular-axis"],path:"M"+Ce*He+",0h"+Ce*le.ticklen,transFn:he,crisp:!1}),f.drawGrid(G,le,{vals:Ie,layer:Y["angular-grid"],path:be,transFn:T.noop,crisp:!1}),f.drawLabels(G,le,{vals:Ie,layer:Y["angular-axis"],repositionOnUpdate:!0,transFn:oe,labelFns:Se})}re(Y["angular-line"].select("path"),ae.showline,{d:te.pathSubplot(),transform:i(J,q)}).attr("stroke-width",ae.linewidth).call(n.stroke,ae.linecolor)},H.updateFx=function(ue,K){if(!this.gd._context.staticPlot){var te=!this.isSmith;te&&(this.updateAngularDrag(ue),this.updateRadialDrag(ue,K,0),this.updateRadialDrag(ue,K,1)),this.updateHoverAndMainDrag(ue)}},H.updateHoverAndMainDrag=function(ue){var K=this,te=K.isSmith,G=K.gd,Y=K.layers,ee=ue._zoomlayer,ne=d.MINZOOM,J=d.OFFEDGE,q=K.radius,ae=K.innerRadius,le=K.cx,ie=K.cy,se=K.cxx,xe=K.cyy,oe=K.sectorInRad,he=K.vangles,be=K.radialAxis,me=C.clampTiny,_e=C.findXYatLength,Se=C.findEnclosingVertexAngles,De=d.cornerHalfWidth,Ie=d.cornerLen/2,Te,Ce,He=g.makeDragger(Y,"path","maindrag",ue.dragmode===!1?"none":"crosshair");h.select(He).attr("d",K.pathSubplot()).attr("transform",i(le,ie)),He.onmousemove=function(Jt){v.hover(G,Jt,K.id),G._fullLayout._lasthover=He,G._fullLayout._hoversubplot=K.id},He.onmouseout=function(Jt){G._dragging||p.unhover(G,Jt)};var Xe={element:He,gd:G,subplot:K.id,plotinfo:{id:K.id,xaxis:K.xaxis,yaxis:K.yaxis},xaxes:[K.xaxis],yaxes:[K.yaxis]},Be,Re,We,vt,Pt,Zt,zt,At,Wt;function Bt(Jt,Yt){return Math.sqrt(Jt*Jt+Yt*Yt)}function Ct(Jt,Yt){return Bt(Jt-se,Yt-xe)}function Ze(Jt,Yt){return Math.atan2(xe-Yt,Jt-se)}function nt(Jt,Yt){return[Jt*Math.cos(Yt),Jt*Math.sin(-Yt)]}function Ye(Jt,Yt){if(Jt===0)return K.pathSector(2*De);var or=Ie/Jt,Hr=Yt-or,an=Yt+or,Kr=Math.max(0,Math.min(Jt,q)),ot=Kr-De,er=Kr+De;return"M"+nt(ot,Hr)+"A"+[ot,ot]+" 0,0,0 "+nt(ot,an)+"L"+nt(er,an)+"A"+[er,er]+" 0,0,1 "+nt(er,Hr)+"Z"}function Ee(Jt,Yt,or){if(Jt===0)return K.pathSector(2*De);var Hr=nt(Jt,Yt),an=nt(Jt,or),Kr=me((Hr[0]+an[0])/2),ot=me((Hr[1]+an[1])/2),er,Kt;if(Kr&&ot){var ur=ot/Kr,Ar=-1/ur,et=_e(De,ur,Kr,ot);er=_e(Ie,Ar,et[0][0],et[0][1]),Kt=_e(Ie,Ar,et[1][0],et[1][1])}else{var $e,st;ot?($e=Ie,st=De):($e=De,st=Ie),er=[[Kr-$e,ot-st],[Kr+$e,ot-st]],Kt=[[Kr-$e,ot+st],[Kr+$e,ot+st]]}return"M"+er.join("L")+"L"+Kt.reverse().join("L")+"Z"}function Ge(){We=null,vt=null,Pt=K.pathSubplot(),Zt=!1;var Jt=G._fullLayout[K.id];zt=u(Jt.bgcolor).getLuminance(),At=g.makeZoombox(ee,zt,le,ie,Pt),At.attr("fill-rule","evenodd"),Wt=g.makeCorners(ee,le,ie),c(G)}function Je(Jt,Yt){return Yt=Math.max(Math.min(Yt,q),ae),Jt<J?Jt=0:q-Jt<J?Jt=q:Yt<J?Yt=0:q-Yt<J&&(Yt=q),Math.abs(Yt-Jt)>ne?(Jt<Yt?(We=Jt,vt=Yt):(We=Yt,vt=Jt),!0):(We=null,vt=null,!1)}function qe(Jt,Yt){Jt=Jt||Pt,Yt=Yt||"M0,0Z",At.attr("d",Jt),Wt.attr("d",Yt),g.transitionZoombox(At,Wt,Zt,zt),Zt=!0;var or={};Rt(or),G.emit("plotly_relayouting",or)}function Tt(Jt,Yt){Jt=Jt*Te,Yt=Yt*Ce;var or=Be+Jt,Hr=Re+Yt,an=Ct(Be,Re),Kr=Math.min(Ct(or,Hr),q),ot=Ze(Be,Re),er,Kt;Je(an,Kr)&&(er=Pt+K.pathSector(vt),We&&(er+=K.pathSector(We)),Kt=Ye(We,ot)+Ye(vt,ot)),qe(er,Kt)}function mt(Jt,Yt,or,Hr){var an=C.findIntersectionXY(or,Hr,or,[Jt-se,xe-Yt]);return Bt(an[0],an[1])}function Mt(Jt,Yt){var or=Be+Jt,Hr=Re+Yt,an=Ze(Be,Re),Kr=Ze(or,Hr),ot=Se(an,he),er=Se(Kr,he),Kt=mt(Be,Re,ot[0],ot[1]),ur=Math.min(mt(or,Hr,er[0],er[1]),q),Ar,et;Je(Kt,ur)&&(Ar=Pt+K.pathSector(vt),We&&(Ar+=K.pathSector(We)),et=[Ee(We,ot[0],ot[1]),Ee(vt,ot[0],ot[1])].join(" ")),qe(Ar,et)}function Ht(){if(g.removeZoombox(G),!(We===null||vt===null)){var Jt={};Rt(Jt),g.showDoubleClickNotifier(G),A.call("_guiRelayout",G,Jt)}}function Rt(Jt){var Yt=be._rl,or=(Yt[1]-Yt[0])/(1-ae/q)/q,Hr=[Yt[0]+(We-ae)*or,Yt[0]+(vt-ae)*or];Jt[K.id+".radialaxis.range"]=Hr}function Vt(Jt,Yt){var or=G._fullLayout.clickmode;if(g.removeZoombox(G),Jt===2){var Hr={};for(var an in K.viewInitial)Hr[K.id+"."+an]=K.viewInitial[an];G.emit("plotly_doubleclick",null),A.call("_guiRelayout",G,Hr)}or.indexOf("select")>-1&&Jt===1&&b(Yt,G,[K.xaxis],[K.yaxis],K.id,Xe),or.indexOf("event")>-1&&v.click(G,Yt,K.id)}Xe.prepFn=function(Jt,Yt,or){var Hr=G._fullLayout.dragmode,an=He.getBoundingClientRect();G._fullLayout._calcInverseTransform(G);var Kr=G._fullLayout._invTransform;Te=G._fullLayout._invScaleX,Ce=G._fullLayout._invScaleY;var ot=T.apply3DTransform(Kr)(Yt-an.left,or-an.top);if(Be=ot[0],Re=ot[1],he){var er=C.findPolygonOffset(q,oe[0],oe[1],he);Be+=se+er[0],Re+=xe+er[1]}switch(Hr){case"zoom":Xe.clickFn=Vt,te||(he?Xe.moveFn=Mt:Xe.moveFn=Tt,Xe.doneFn=Ht,Ge());break;case"select":case"lasso":l(Jt,Yt,or,Xe,Hr);break}},p.init(Xe)},H.updateRadialDrag=function(ue,K,te){var G=this,Y=G.gd,ee=G.layers,ne=G.radius,J=G.innerRadius,q=G.cx,ae=G.cy,le=G.radialAxis,ie=d.radialDragBoxSize,se=ie/2;if(!le.visible)return;var xe=O(G.radialAxisAngle),oe=le._rl,he=oe[0],be=oe[1],me=oe[te],_e=.75*(oe[1]-oe[0])/(1-G.getHole(K))/ne,Se,De,Ie;te?(Se=q+(ne+se)*Math.cos(xe),De=ae-(ne+se)*Math.sin(xe),Ie="radialdrag"):(Se=q+(J-se)*Math.cos(xe),De=ae-(J-se)*Math.sin(xe),Ie="radialdrag-inner");var Te=g.makeRectDragger(ee,Ie,"crosshair",-se,-se,ie,ie),Ce={element:Te,gd:Y};ue.dragmode===!1&&(Ce.dragmode=!1),re(h.select(Te),le.visible&&J<ne,{transform:i(Se,De)});var He,Xe,Be;function Re(zt,At){if(He)He(zt,At);else{var Wt=[zt,-At],Bt=[Math.cos(xe),Math.sin(xe)],Ct=Math.abs(T.dot(Wt,Bt)/Math.sqrt(T.dot(Wt,Wt)));isNaN(Ct)||(He=Ct<.5?Pt:Zt)}var Ze={};We(Ze),Y.emit("plotly_relayouting",Ze)}function We(zt){Xe!==null?zt[G.id+".radialaxis.angle"]=Xe:Be!==null&&(zt[G.id+".radialaxis.range["+te+"]"]=Be)}function vt(){Xe!==null?A.call("_guiRelayout",Y,G.id+".radialaxis.angle",Xe):Be!==null&&A.call("_guiRelayout",Y,G.id+".radialaxis.range["+te+"]",Be)}function Pt(zt,At){if(te!==0){var Wt=Se+zt,Bt=De+At;Xe=Math.atan2(ae-Bt,Wt-q),G.vangles&&(Xe=X(Xe,G.vangles)),Xe=N(Xe);var Ct=i(q,ae)+e(-Xe);ee["radial-axis"].attr("transform",Ct),ee["radial-line"].select("line").attr("transform",Ct);var Ze=G.gd._fullLayout,nt=Ze[G.id];G.updateRadialAxisTitle(Ze,nt,Xe)}}function Zt(zt,At){var Wt=T.dot([zt,-At],[Math.cos(xe),Math.sin(xe)]);if(Be=me-_e*Wt,_e>0!=(te?Be>he:Be<be)){Be=null;return}var Bt=Y._fullLayout,Ct=Bt[G.id];le.range[te]=Be,le._rl[te]=Be,G.updateRadialAxis(Bt,Ct),G.xaxis.setRange(),G.xaxis.setScale(),G.yaxis.setRange(),G.yaxis.setScale();var Ze=!1;for(var nt in G.traceHash){var Ye=G.traceHash[nt],Ee=T.filterVisible(Ye),Ge=Ye[0][0].trace._module;Ge.plot(Y,G,Ee,Ct),A.traceIs(nt,"gl")&&Ee.length&&(Ze=!0)}Ze&&(_(Y),y(Y))}Ce.prepFn=function(){He=null,Xe=null,Be=null,Ce.moveFn=Re,Ce.doneFn=vt,c(Y)},Ce.clampFn=function(zt,At){return Math.sqrt(zt*zt+At*At)<d.MINDRAG&&(zt=0,At=0),[zt,At]},p.init(Ce)},H.updateAngularDrag=function(ue){var K=this,te=K.gd,G=K.layers,Y=K.radius,ee=K.angularAxis,ne=K.cx,J=K.cy,q=K.cxx,ae=K.cyy,le=d.angularDragBoxSize,ie=g.makeDragger(G,"path","angulardrag",ue.dragmode===!1?"none":"move"),se={element:ie,gd:te};ue.dragmode===!1?se.dragmode=!1:h.select(ie).attr("d",K.pathAnnulus(Y,Y+le)).attr("transform",i(ne,J)).call(M,"move");function xe(Be,Re){return Math.atan2(ae+le-Re,Be-q-le)}var oe=G.frontplot.select(".scatterlayer").selectAll(".trace"),he=oe.selectAll(".point"),be=oe.selectAll(".textpoint"),me,_e,Se,De,Ie,Te;function Ce(Be,Re){var We=K.gd._fullLayout,vt=We[K.id],Pt=me+Be*ue._invScaleX,Zt=_e+Re*ue._invScaleY,zt=xe(Pt,Zt),At=N(zt-Te);if(De=Se+At,G.frontplot.attr("transform",i(K.xOffset2,K.yOffset2)+e([-At,q,ae])),K.vangles){Ie=K.radialAxisAngle+At;var Wt=i(ne,J)+e(-At),Bt=i(ne,J)+e(-Ie);G.bg.attr("transform",Wt),G["radial-grid"].attr("transform",Wt),G["radial-axis"].attr("transform",Bt),G["radial-line"].select("line").attr("transform",Bt),K.updateRadialAxisTitle(We,vt,Ie)}else K.clipPaths.forTraces.select("path").attr("transform",i(q,ae)+e(At));he.each(function(){var Je=h.select(this),qe=a.getTranslate(Je);Je.attr("transform",i(qe.x,qe.y)+e([At]))}),be.each(function(){var Je=h.select(this),qe=Je.select("text"),Tt=a.getTranslate(Je);Je.attr("transform",e([At,qe.attr("x"),qe.attr("y")])+i(Tt.x,Tt.y))}),ee.rotation=T.modHalf(De,360),K.updateAngularAxis(We,vt),K._hasClipOnAxisFalse&&!T.isFullCircle(K.sectorInRad)&&oe.call(a.hideOutsideRangePoints,K);var Ct=!1;for(var Ze in K.traceHash)if(A.traceIs(Ze,"gl")){var nt=K.traceHash[Ze],Ye=T.filterVisible(nt),Ee=nt[0][0].trace._module;Ee.plot(te,K,Ye,vt),Ye.length&&(Ct=!0)}Ct&&(_(te),y(te));var Ge={};He(Ge),te.emit("plotly_relayouting",Ge)}function He(Be){Be[K.id+".angularaxis.rotation"]=De,K.vangles&&(Be[K.id+".radialaxis.angle"]=Ie)}function Xe(){be.select("text").attr("transform",null);var Be={};He(Be),A.call("_guiRelayout",te,Be)}se.prepFn=function(Be,Re,We){var vt=ue[K.id];Se=vt.angularaxis.rotation;var Pt=ie.getBoundingClientRect();me=Re-Pt.left,_e=We-Pt.top,te._fullLayout._calcInverseTransform(te);var Zt=T.apply3DTransform(ue._invTransform)(me,_e);me=Zt[0],_e=Zt[1],Te=xe(me,_e),se.moveFn=Ce,se.doneFn=Xe,c(te)},K.vangles&&!T.isFullCircle(K.sectorInRad)&&(se.prepFn=T.noop,M(h.select(ie),null)),p.init(se)},H.isPtInside=function(ue){if(this.isSmith)return!0;var K=this.sectorInRad,te=this.vangles,G=this.angularAxis.c2g(ue.theta),Y=this.radialAxis,ee=Y.c2l(ue.r),ne=Y._rl,J=te?C.isPtInsidePolygon:T.isPtInsideSector;return J(ee,G,ne,K,te)},H.pathArc=function(ue){var K=this.sectorInRad,te=this.vangles,G=te?C.pathPolygon:T.pathArc;return G(ue,K[0],K[1],te)},H.pathSector=function(ue){var K=this.sectorInRad,te=this.vangles,G=te?C.pathPolygon:T.pathSector;return G(ue,K[0],K[1],te)},H.pathAnnulus=function(ue,K){var te=this.sectorInRad,G=this.vangles,Y=G?C.pathPolygonAnnulus:T.pathAnnulus;return Y(ue,K,te[0],te[1],G)},H.pathSubplot=function(){var ue=this.innerRadius,K=this.radius;return ue?this.pathAnnulus(ue,K):this.pathSector(K)},H.fillViewInitialKey=function(ue,K){ue in this.viewInitial||(this.viewInitial[ue]=K)};function j(ue){var K=ue.ticks+String(ue.ticklen)+String(ue.showticklabels);return"side"in ue&&(K+=ue.side),K}function Z(ue){var K=ue[0],te=ue[1],G=te-K,Y=I(K,360),ee=Y+G,ne=Math.cos(O(Y)),J=Math.sin(O(Y)),q=Math.cos(O(ee)),ae=Math.sin(O(ee)),le,ie,se,xe;return Y<=90&&ee>=90||Y>90&&ee>=450?xe=1:J<=0&&ae<=0?xe=0:xe=Math.max(J,ae),Y<=180&&ee>=180||Y>180&&ee>=540?le=-1:ne>=0&&q>=0?le=0:le=Math.min(ne,q),Y<=270&&ee>=270||Y>270&&ee>=630?ie=-1:J>=0&&ae>=0?ie=0:ie=Math.min(J,ae),ee>=360?se=1:ne<=0&&q<=0?se=0:se=Math.max(ne,q),[le,ie,se,xe]}function X(ue,K){var te=function(Y){return T.angleDist(ue,Y)},G=T.findIndexOfMin(K,te);return K[G]}function re(ue,K,te){return K?(ue.attr("display",null),ue.attr(te)):ue&&ue.attr("display","none"),ue}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../plot_api/subroutines":556,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/dragbox":575,"../cartesian/set_convert":585,"../plots":628,"../smith/helpers":637,"./constants":629,"./helpers":630,"./set_convert":635,"@plotly/d3":58,tinycolor2:313}],635:[function(t,P,R){var h=t("../../lib"),u=t("../cartesian/set_convert"),A=h.deg2rad,T=h.rad2deg;P.exports=function(f,o,s){switch(u(f,s),f._id){case"x":case"radialaxis":e(f,o);break;case"angularaxis":a(f,o);break}};function e(r,f){var o=f._subplot;r.setGeometry=function(){var s=r._rl[0],m=r._rl[1],g=o.innerRadius,p=(o.radius-g)/(m-s),v=g/p,x=s>m?function(l){return l<=0}:function(l){return l>=0};r.c2g=function(l){var b=r.c2l(l)-s;return(x(b)?b:0)+v},r.g2c=function(l){return r.l2c(l+s-v)},r.g2p=function(l){return l*p},r.c2p=function(l){return r.g2p(r.c2g(l))}}}function i(r,f){return f==="degrees"?A(r):r}function n(r,f){return f==="degrees"?T(r):r}function a(r,f){var o=r.type;if(o==="linear"){var s=r.d2c,m=r.c2d;r.d2c=function(g,p){return i(s(g),p)},r.c2d=function(g,p){return m(n(g,p))}}r.makeCalcdata=function(g,p){var v=g[p],x=g._length,l,b,c=function(d){return r.d2c(d,g.thetaunit)};if(v){if(h.isTypedArray(v)&&o==="linear"){if(x===v.length)return v;if(v.subarray)return v.subarray(0,x)}for(l=new Array(x),b=0;b<x;b++)l[b]=c(v[b])}else{var M=p+"0",_="d"+p,y=M in g?c(g[M]):0,w=g[_]?c(g[_]):(r.period||2*Math.PI)/x;for(l=new Array(x),b=0;b<x;b++)l[b]=y+b*w}return l},r.setGeometry=function(){var g=f.sector,p=g.map(A),v={clockwise:-1,counterclockwise:1}[r.direction],x=A(r.rotation),l=function(C){return v*C+x},b=function(C){return(C-x)/v},c,M,_,y;switch(o){case"linear":M=c=h.identity,y=A,_=T,r.range=h.isFullCircle(p)?[g[0],g[0]+360]:p.map(b).map(T);break;case"category":var w=r._categories.length,d=r.period?Math.max(r.period,w):w;d===0&&(d=1),M=y=function(C){return C*2*Math.PI/d},c=_=function(C){return C*d/Math.PI/2},r.range=[0,d];break}r.c2g=function(C){return l(M(C))},r.g2c=function(C){return c(b(C))},r.t2g=function(C){return l(y(C))},r.g2t=function(C){return _(b(C))}}}},{"../../lib":515,"../cartesian/set_convert":585}],636:[function(t,P,R){P.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],637:[function(t,P,R){function h(n){return n<0?-1:n>0?1:0}function u(n){var a=n[0],r=n[1];if(!isFinite(a)||!isFinite(r))return[1,0];var f=(a+1)*(a+1)+r*r;return[(a*a+r*r-1)/f,2*r/f]}function A(n,a){var r=a[0],f=a[1];return[r*n.radius+n.cx,-f*n.radius+n.cy]}function T(n,a){return a*n.radius}function e(n,a,r,f){var o=A(n,u([r,a])),s=o[0],m=o[1],g=A(n,u([f,a])),p=g[0],v=g[1];if(a===0)return["M"+s+","+m,"L"+p+","+v].join(" ");var x=T(n,1/Math.abs(a));return["M"+s+","+m,"A"+x+","+x+" 0 0,"+(a<0?1:0)+" "+p+","+v].join(" ")}function i(n,a,r,f){var o=T(n,1/(a+1)),s=A(n,u([a,r])),m=s[0],g=s[1],p=A(n,u([a,f])),v=p[0],x=p[1];if(h(r)!==h(f)){var l=A(n,u([a,0])),b=l[0],c=l[1];return["M"+m+","+g,"A"+o+","+o+" 0 0,"+(0<r?0:1)+" "+b+","+c,"A"+o+","+o+" 0 0,"+(f<0?0:1)+v+","+x].join(" ")}return["M"+m+","+g,"A"+o+","+o+" 0 0,"+(f<r?0:1)+" "+v+","+x].join(" ")}P.exports={smith:u,reactanceArc:e,resistanceArc:i,smithTransform:A}},{}],638:[function(t,P,R){var h=t("../get_data").getSubplotCalcData,u=t("../../lib").counterRegex,A=t("../polar/polar"),T=t("./constants"),e=T.attr,i=T.name,n=u(i),a={};a[e]={valType:"subplotid",dflt:i,editType:"calc"};function r(o){for(var s=o._fullLayout,m=o.calcdata,g=s._subplots[i],p=0;p<g.length;p++){var v=g[p],x=h(m,i,v),l=s[v]._subplot;l||(l=A(o,v,!0),s[v]._subplot=l),l.plot(x,s,o._promises)}}function f(o,s,m,g){for(var p=g._subplots[i]||[],v=0;v<p.length;v++){var x=p[v],l=g[x]._subplot;if(!s[x]&&!!l){l.framework.remove();for(var b in l.clipPaths)l.clipPaths[b].remove()}}}P.exports={attr:e,name:i,idRoot:i,idRegex:n,attrRegex:n,attributes:a,layoutAttributes:t("./layout_attributes"),supplyLayoutDefaults:t("./layout_defaults"),plot:r,clean:f,toSVG:t("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"../polar/polar":634,"./constants":636,"./layout_attributes":639,"./layout_defaults":640}],639:[function(t,P,R){var h=t("../../components/color/attributes"),u=t("../cartesian/layout_attributes"),A=t("../domain").attributes,T=t("../../lib").extendFlat,e=t("../../plot_api/edit_types").overrideAll,i=e({color:u.color,showline:T({},u.showline,{dflt:!0}),linecolor:u.linecolor,linewidth:u.linewidth,showgrid:T({},u.showgrid,{dflt:!0}),gridcolor:u.gridcolor,gridwidth:u.gridwidth,griddash:u.griddash},"plot","from-root"),n=e({ticklen:u.ticklen,tickwidth:T({},u.tickwidth,{dflt:2}),tickcolor:u.tickcolor,showticklabels:u.showticklabels,showtickprefix:u.showtickprefix,tickprefix:u.tickprefix,showticksuffix:u.showticksuffix,ticksuffix:u.ticksuffix,tickfont:u.tickfont,tickformat:u.tickformat,hoverformat:u.hoverformat,layer:u.layer},"plot","from-root"),a=T({visible:T({},u.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:T({},u.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},i,n),r=T({visible:T({},u.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:u.ticks,editType:"calc"},i,n);P.exports={domain:A({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:h.background},realaxis:a,imaginaryaxis:r,editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],640:[function(t,P,R){var h=t("../../lib"),u=t("../../components/color"),A=t("../../plot_api/plot_template"),T=t("../subplot_defaults"),e=t("../get_data").getSubplotData,i=t("../cartesian/prefix_suffix_defaults"),n=t("../cartesian/tick_label_defaults"),a=t("../cartesian/line_grid_defaults"),r=t("../cartesian/set_convert"),f=t("./layout_attributes"),o=t("./constants"),s=o.axisNames,m=p(function(v){return v.slice().reverse().map(function(x){return-x}).concat([0]).concat(v)},String);function g(v,x,l,b){var c=l("bgcolor");b.bgColor=u.combine(c,b.paper_bgcolor);var M=e(b.fullData,o.name,b.id),_=b.layoutOut,y;function w(H,j){return l(y+"."+H,j)}for(var d=0;d<s.length;d++){y=s[d],h.isPlainObject(v[y])||(v[y]={});var C=v[y],S=A.newContainer(x,y);S._id=S._name=y,S._attr=b.id+"."+y,S._traceIndices=M.map(function(H){return H._expandedIndex});var E=w("visible");if(S.type="linear",r(S,_),i(C,S,w,S.type),E){var k=y==="realaxis";if(k&&w("side"),k)w("tickvals");else{var B=m(x.realaxis.tickvals||f.realaxis.tickvals.dflt);w("tickvals",B)}var z,F,I,O,N=b.font||{};E&&(z=w("color"),F=z===C.color?z:N.color,I=N.size,O=N.family),n(C,S,w,S.type,{noTicklabelstep:!0,noAng:!k,noExp:!0,font:{color:F,size:I,family:O}}),h.coerce2(v,x,f,y+".ticklen"),h.coerce2(v,x,f,y+".tickwidth"),h.coerce2(v,x,f,y+".tickcolor",x.color);var V=w("ticks");V||(delete x[y].ticklen,delete x[y].tickwidth,delete x[y].tickcolor),a(C,S,w,{dfltColor:z,bgColor:b.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:f[y]}),w("layer")}w("hoverformat"),delete S.type,S._input=C}}P.exports=function(x,l,b){T(x,l,b,{noUirevision:!0,type:o.name,attributes:f,handleDefaults:g,font:l.font,paper_bgcolor:l.paper_bgcolor,fullData:b,layoutOut:l})};function p(v,x){var l={};return function(b){var c=x?x(b):b;if(c in l)return l[c];var M=v(b);return l[c]=M,M}}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/set_convert":585,"../cartesian/tick_label_defaults":587,"../get_data":602,"../subplot_defaults":641,"./constants":636,"./layout_attributes":639}],641:[function(t,P,R){var h=t("../lib"),u=t("../plot_api/plot_template"),A=t("./domain").defaults;P.exports=function(e,i,n,a){var r=a.type,f=a.attributes,o=a.handleDefaults,s=a.partition||"x",m=i._subplots[r],g=m.length,p=g&&m[0].replace(/\d+$/,""),v,x;function l(_,y){return h.coerce(v,x,f,_,y)}for(var b=0;b<g;b++){var c=m[b];e[c]?v=e[c]:v=e[c]={},x=u.newContainer(i,c,p),a.noUirevision||l("uirevision",i.uirevision);var M={};M[s]=[b/g,(b+1)/g],A(x,i,l,M),a.id=c,o(v,x,l,a)}}},{"../lib":515,"../plot_api/plot_template":555,"./domain":593}],642:[function(t,P,R){var h=t("../constants/docs");h.FORMAT_LINK,h.DATE_FORMAT_LINK;function u(A){var T=A.description?" "+A.description:"",e=A.keys||[];if(e.length>0){for(var i=[],n=0;n<e.length;n++)i[n]="`"+e[n]+"`";T=T+"Finally, the template string has access to ",e.length===1?T="variable "+i[0]:T="variables "+i.slice(0,-1).join(", ")+" and "+i.slice(-1)+"."}return T}R.hovertemplateAttrs=function(A,T){A=A||{},T=T||{},u(T);var e={valType:"string",dflt:"",editType:A.editType||"none"};return A.arrayOk!==!1&&(e.arrayOk=!0),e},R.texttemplateAttrs=function(A,T){A=A||{},T=T||{},u(T);var e={valType:"string",dflt:"",editType:A.editType||"calc"};return A.arrayOk!==!1&&(e.arrayOk=!0),e}},{"../constants/docs":486}],643:[function(t,P,R){var h=t("./ternary"),u=t("../../plots/get_data").getSubplotCalcData,A=t("../../lib").counterRegex,T="ternary";R.name=T;var e=R.attr="subplot";R.idRoot=T,R.idRegex=R.attrRegex=A(T);var i=R.attributes={};i[e]={valType:"subplotid",dflt:"ternary",editType:"calc"},R.layoutAttributes=t("./layout_attributes"),R.supplyLayoutDefaults=t("./layout_defaults"),R.plot=function(a){for(var r=a._fullLayout,f=a.calcdata,o=r._subplots[T],s=0;s<o.length;s++){var m=o[s],g=u(f,T,m),p=r[m]._subplot;p||(p=new h({id:m,graphDiv:a,container:r._ternarylayer.node()},r),r[m]._subplot=p),p.plot(g,r,a._promises)}},R.clean=function(n,a,r,f){for(var o=f._subplots[T]||[],s=0;s<o.length;s++){var m=o[s],g=f[m]._subplot;!a[m]&&!!g&&(g.plotContainer.remove(),g.clipDef.remove(),g.clipDefRelative.remove(),g.layers["a-title"].remove(),g.layers["b-title"].remove(),g.layers["c-title"].remove())}}},{"../../lib":515,"../../plots/get_data":602,"./layout_attributes":644,"./layout_defaults":645,"./ternary":646}],644:[function(t,P,R){var h=t("../../components/color/attributes"),u=t("../domain").attributes,A=t("../cartesian/layout_attributes"),T=t("../../plot_api/edit_types").overrideAll,e=t("../../lib/extend").extendFlat,i={title:{text:A.title.text,font:A.title.font},color:A.color,tickmode:A.tickmode,nticks:e({},A.nticks,{dflt:6,min:1}),tick0:A.tick0,dtick:A.dtick,tickvals:A.tickvals,ticktext:A.ticktext,ticks:A.ticks,ticklen:A.ticklen,tickwidth:A.tickwidth,tickcolor:A.tickcolor,ticklabelstep:A.ticklabelstep,showticklabels:A.showticklabels,showtickprefix:A.showtickprefix,tickprefix:A.tickprefix,showticksuffix:A.showticksuffix,ticksuffix:A.ticksuffix,showexponent:A.showexponent,exponentformat:A.exponentformat,minexponent:A.minexponent,separatethousands:A.separatethousands,tickfont:A.tickfont,tickangle:A.tickangle,tickformat:A.tickformat,tickformatstops:A.tickformatstops,hoverformat:A.hoverformat,showline:e({},A.showline,{dflt:!0}),linecolor:A.linecolor,linewidth:A.linewidth,showgrid:e({},A.showgrid,{dflt:!0}),gridcolor:A.gridcolor,gridwidth:A.gridwidth,griddash:A.griddash,layer:A.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:A._deprecated.title,titlefont:A._deprecated.titlefont}},n=P.exports=T({domain:u({name:"ternary"}),bgcolor:{valType:"color",dflt:h.background},sum:{valType:"number",dflt:1,min:0},aaxis:i,baxis:i,caxis:i},"plot","from-root");n.uirevision={valType:"any",editType:"none"},n.aaxis.uirevision=n.baxis.uirevision=n.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],645:[function(t,P,R){var h=t("../../components/color"),u=t("../../plot_api/plot_template"),A=t("../../lib"),T=t("../subplot_defaults"),e=t("../cartesian/tick_label_defaults"),i=t("../cartesian/prefix_suffix_defaults"),n=t("../cartesian/tick_mark_defaults"),a=t("../cartesian/tick_value_defaults"),r=t("../cartesian/line_grid_defaults"),f=t("./layout_attributes"),o=["aaxis","baxis","caxis"];P.exports=function(p,v,x){T(p,v,x,{type:"ternary",attributes:f,handleDefaults:s,font:v.font,paper_bgcolor:v.paper_bgcolor})};function s(g,p,v,x){var l=v("bgcolor"),b=v("sum");x.bgColor=h.combine(l,x.paper_bgcolor);for(var c,M,_,y=0;y<o.length;y++)c=o[y],M=g[c]||{},_=u.newContainer(p,c),_._name=c,m(M,_,x,p);var w=p.aaxis,d=p.baxis,C=p.caxis;w.min+d.min+C.min>=b&&(w.min=0,d.min=0,C.min=0,g.aaxis&&delete g.aaxis.min,g.baxis&&delete g.baxis.min,g.caxis&&delete g.caxis.min)}function m(g,p,v,x){var l=f[p._name];function b(S,E){return A.coerce(g,p,l,S,E)}b("uirevision",x.uirevision),p.type="linear";var c=b("color"),M=c!==l.color.dflt?c:v.font.color,_=p._name,y=_.charAt(0).toUpperCase(),w="Component "+y,d=b("title.text",w);p._hovertitle=d===w?d:y,A.coerceFont(b,"title.font",{family:v.font.family,size:A.bigFont(v.font.size),color:M}),b("min"),a(g,p,b,"linear"),i(g,p,b,"linear"),e(g,p,b,"linear"),n(g,p,b,{outerTicks:!0});var C=b("showticklabels");C&&(A.coerceFont(b,"tickfont",{family:v.font.family,size:v.font.size,color:M}),b("tickangle"),b("tickformat")),r(g,p,b,{dfltColor:c,bgColor:v.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:l}),b("hoverformat"),b("layer")}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../subplot_defaults":641,"./layout_attributes":644}],646:[function(t,P,R){var h=t("@plotly/d3"),u=t("tinycolor2"),A=t("../../registry"),T=t("../../lib"),e=T.strTranslate,i=T._,n=t("../../components/color"),a=t("../../components/drawing"),r=t("../cartesian/set_convert"),f=t("../../lib/extend").extendFlat,o=t("../plots"),s=t("../cartesian/axes"),m=t("../../components/dragelement"),g=t("../../components/fx"),p=t("../../components/dragelement/helpers"),v=p.freeMode,x=p.rectMode,l=t("../../components/titles"),b=t("../../components/selections").prepSelect,c=t("../../components/selections").selectOnClick,M=t("../../components/selections").clearOutline,_=t("../../components/selections").clearSelectionsCache,y=t("../cartesian/constants");function w(N,V){this.id=N.id,this.graphDiv=N.graphDiv,this.init(V),this.makeFramework(V),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}P.exports=w;var d=w.prototype;d.init=function(N){this.container=N._ternarylayer,this.defs=N._defs,this.layoutId=N._uid,this.traceHash={},this.layers={}},d.plot=function(N,V){var H=this,j=V[H.id],Z=V._size;H._hasClipOnAxisFalse=!1;for(var X=0;X<N.length;X++){var re=N[X][0].trace;if(re.cliponaxis===!1){H._hasClipOnAxisFalse=!0;break}}H.updateLayers(j),H.adjustLayout(j,Z),o.generalUpdatePerTraceModule(H.graphDiv,H,N,j),H.layers.plotbg.select("path").call(n.fill,j.bgcolor)},d.makeFramework=function(N){var V=this,H=V.graphDiv,j=N[V.id],Z=V.clipId="clip"+V.layoutId+V.id,X=V.clipIdRelative="clip-relative"+V.layoutId+V.id;V.clipDef=T.ensureSingleById(N._clips,"clipPath",Z,function(re){re.append("path").attr("d","M0,0Z")}),V.clipDefRelative=T.ensureSingleById(N._clips,"clipPath",X,function(re){re.append("path").attr("d","M0,0Z")}),V.plotContainer=T.ensureSingle(V.container,"g",V.id),V.updateLayers(j),a.setClipUrl(V.layers.backplot,Z,H),a.setClipUrl(V.layers.grids,Z,H)},d.updateLayers=function(N){var V=this,H=V.layers,j=["draglayer","plotbg","backplot","grids"];N.aaxis.layer==="below traces"&&j.push("aaxis","aline"),N.baxis.layer==="below traces"&&j.push("baxis","bline"),N.caxis.layer==="below traces"&&j.push("caxis","cline"),j.push("frontplot"),N.aaxis.layer==="above traces"&&j.push("aaxis","aline"),N.baxis.layer==="above traces"&&j.push("baxis","bline"),N.caxis.layer==="above traces"&&j.push("caxis","cline");var Z=V.plotContainer.selectAll("g.toplevel").data(j,String),X=["agrid","bgrid","cgrid"];Z.enter().append("g").attr("class",function(re){return"toplevel "+re}).each(function(re){var ue=h.select(this);H[re]=ue,re==="frontplot"?ue.append("g").classed("scatterlayer",!0):re==="backplot"?ue.append("g").classed("maplayer",!0):re==="plotbg"?ue.append("path").attr("d","M0,0Z"):re==="aline"||re==="bline"||re==="cline"?ue.append("path"):re==="grids"&&X.forEach(function(K){H[K]=ue.append("g").classed("grid "+K,!0)})}),Z.order()};var C=Math.sqrt(4/3);d.adjustLayout=function(N,V){var H=this,j=N.domain,Z=(j.x[0]+j.x[1])/2,X=(j.y[0]+j.y[1])/2,re=j.x[1]-j.x[0],ue=j.y[1]-j.y[0],K=re*V.w,te=ue*V.h,G=N.sum,Y=N.aaxis.min,ee=N.baxis.min,ne=N.caxis.min,J,q,ae,le,ie,se;K>C*te?(le=te,ae=le*C):(ae=K,le=ae/C),ie=re*ae/K,se=ue*le/te,J=V.l+V.w*Z-ae/2,q=V.t+V.h*(1-X)-le/2,H.x0=J,H.y0=q,H.w=ae,H.h=le,H.sum=G,H.xaxis={type:"linear",range:[Y+2*ne-G,G-Y-2*ee],domain:[Z-ie/2,Z+ie/2],_id:"x"},r(H.xaxis,H.graphDiv._fullLayout),H.xaxis.setScale(),H.xaxis.isPtWithinRange=function(Ce){return Ce.a>=H.aaxis.range[0]&&Ce.a<=H.aaxis.range[1]&&Ce.b>=H.baxis.range[1]&&Ce.b<=H.baxis.range[0]&&Ce.c>=H.caxis.range[1]&&Ce.c<=H.caxis.range[0]},H.yaxis={type:"linear",range:[Y,G-ee-ne],domain:[X-se/2,X+se/2],_id:"y"},r(H.yaxis,H.graphDiv._fullLayout),H.yaxis.setScale(),H.yaxis.isPtWithinRange=function(){return!0};var xe=H.yaxis.domain[0],oe=H.aaxis=f({},N.aaxis,{range:[Y,G-ee-ne],side:"left",tickangle:(+N.aaxis.tickangle||0)-30,domain:[xe,xe+se*C],anchor:"free",position:0,_id:"y",_length:ae});r(oe,H.graphDiv._fullLayout),oe.setScale();var he=H.baxis=f({},N.baxis,{range:[G-Y-ne,ee],side:"bottom",domain:H.xaxis.domain,anchor:"free",position:0,_id:"x",_length:ae});r(he,H.graphDiv._fullLayout),he.setScale();var be=H.caxis=f({},N.caxis,{range:[G-Y-ee,ne],side:"right",tickangle:(+N.caxis.tickangle||0)+30,domain:[xe,xe+se*C],anchor:"free",position:0,_id:"y",_length:ae});r(be,H.graphDiv._fullLayout),be.setScale();var me="M"+J+","+(q+le)+"h"+ae+"l-"+ae/2+",-"+le+"Z";H.clipDef.select("path").attr("d",me),H.layers.plotbg.select("path").attr("d",me);var _e="M0,"+le+"h"+ae+"l-"+ae/2+",-"+le+"Z";H.clipDefRelative.select("path").attr("d",_e);var Se=e(J,q);H.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Se),H.clipDefRelative.select("path").attr("transform",null);var De=e(J-he._offset,q+le);H.layers.baxis.attr("transform",De),H.layers.bgrid.attr("transform",De);var Ie=e(J+ae/2,q)+"rotate(30)"+e(0,-oe._offset);H.layers.aaxis.attr("transform",Ie),H.layers.agrid.attr("transform",Ie);var Te=e(J+ae/2,q)+"rotate(-30)"+e(0,-be._offset);H.layers.caxis.attr("transform",Te),H.layers.cgrid.attr("transform",Te),H.drawAxes(!0),H.layers.aline.select("path").attr("d",oe.showline?"M"+J+","+(q+le)+"l"+ae/2+",-"+le:"M0,0").call(n.stroke,oe.linecolor||"#000").style("stroke-width",(oe.linewidth||0)+"px"),H.layers.bline.select("path").attr("d",he.showline?"M"+J+","+(q+le)+"h"+ae:"M0,0").call(n.stroke,he.linecolor||"#000").style("stroke-width",(he.linewidth||0)+"px"),H.layers.cline.select("path").attr("d",be.showline?"M"+(J+ae/2)+","+q+"l"+ae/2+","+le:"M0,0").call(n.stroke,be.linecolor||"#000").style("stroke-width",(be.linewidth||0)+"px"),H.graphDiv._context.staticPlot||H.initInteractions(),a.setClipUrl(H.layers.frontplot,H._hasClipOnAxisFalse?null:H.clipId,H.graphDiv)},d.drawAxes=function(N){var V=this,H=V.graphDiv,j=V.id.substr(7)+"title",Z=V.layers,X=V.aaxis,re=V.baxis,ue=V.caxis;if(V.drawAx(X),V.drawAx(re),V.drawAx(ue),N){var K=Math.max(X.showticklabels?X.tickfont.size/2:0,(ue.showticklabels?ue.tickfont.size*.75:0)+(ue.ticks==="outside"?ue.ticklen*.87:0)),te=(re.showticklabels?re.tickfont.size:0)+(re.ticks==="outside"?re.ticklen:0)+3;Z["a-title"]=l.draw(H,"a"+j,{propContainer:X,propName:V.id+".aaxis.title",placeholder:i(H,"Click to enter Component A title"),attributes:{x:V.x0+V.w/2,y:V.y0-X.title.font.size/3-K,"text-anchor":"middle"}}),Z["b-title"]=l.draw(H,"b"+j,{propContainer:re,propName:V.id+".baxis.title",placeholder:i(H,"Click to enter Component B title"),attributes:{x:V.x0-te,y:V.y0+V.h+re.title.font.size*.83+te,"text-anchor":"middle"}}),Z["c-title"]=l.draw(H,"c"+j,{propContainer:ue,propName:V.id+".caxis.title",placeholder:i(H,"Click to enter Component C title"),attributes:{x:V.x0+V.w+te,y:V.y0+V.h+ue.title.font.size*.83+te,"text-anchor":"middle"}})}},d.drawAx=function(N){var V=this,H=V.graphDiv,j=N._name,Z=j.charAt(0),X=N._id,re=V.layers[j],ue=30,K=Z+"tickLayout",te=S(N);V[K]!==te&&(re.selectAll("."+X+"tick").remove(),V[K]=te),N.setScale();var G=s.calcTicks(N),Y=s.clipEnds(N,G),ee=s.makeTransTickFn(N),ne=s.getTickSigns(N)[2],J=T.deg2rad(ue),q=ne*(N.linewidth||1)/2,ae=ne*N.ticklen,le=V.w,ie=V.h,se=Z==="b"?"M0,"+q+"l"+Math.sin(J)*ae+","+Math.cos(J)*ae:"M"+q+",0l"+Math.cos(J)*ae+","+-Math.sin(J)*ae,xe={a:"M0,0l"+ie+",-"+le/2,b:"M0,0l-"+le/2+",-"+ie,c:"M0,0l-"+ie+","+le/2}[Z];s.drawTicks(H,N,{vals:N.ticks==="inside"?Y:G,layer:re,path:se,transFn:ee,crisp:!1}),s.drawGrid(H,N,{vals:Y,layer:V.layers[Z+"grid"],path:xe,transFn:ee,crisp:!1}),s.drawLabels(H,N,{vals:G,layer:re,transFn:ee,labelFns:s.makeLabelFns(N,0,ue)})};function S(N){return N.ticks+String(N.ticklen)+String(N.showticklabels)}var E=y.MINZOOM/2+.87,k="m-0.87,.5h"+E+"v3h-"+(E+5.2)+"l"+(E/2+2.6)+",-"+(E*.87+4.5)+"l2.6,1.5l-"+E/2+","+E*.87+"Z",B="m0.87,.5h-"+E+"v3h"+(E+5.2)+"l-"+(E/2+2.6)+",-"+(E*.87+4.5)+"l-2.6,1.5l"+E/2+","+E*.87+"Z",z="m0,1l"+E/2+","+E*.87+"l2.6,-1.5l-"+(E/2+2.6)+",-"+(E*.87+4.5)+"l-"+(E/2+2.6)+","+(E*.87+4.5)+"l2.6,1.5l"+E/2+",-"+E*.87+"Z",F="m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z",I=!0;d.clearOutline=function(){_(this.dragOptions),M(this.dragOptions.gd)},d.initInteractions=function(){var N=this,V=N.layers.plotbg.select("path").node(),H=N.graphDiv,j=H._fullLayout._zoomlayer,Z,X;this.dragOptions={element:V,gd:H,plotinfo:{id:N.id,domain:H._fullLayout[N.id].domain,xaxis:N.xaxis,yaxis:N.yaxis},subplot:N.id,prepFn:function(De,Ie,Te){N.dragOptions.xaxes=[N.xaxis],N.dragOptions.yaxes=[N.yaxis],Z=H._fullLayout._invScaleX,X=H._fullLayout._invScaleY;var Ce=N.dragOptions.dragmode=H._fullLayout.dragmode;v(Ce)?N.dragOptions.minDrag=1:N.dragOptions.minDrag=void 0,Ce==="zoom"?(N.dragOptions.moveFn=he,N.dragOptions.clickFn=le,N.dragOptions.doneFn=be,ie(De,Ie,Te)):Ce==="pan"?(N.dragOptions.moveFn=_e,N.dragOptions.clickFn=le,N.dragOptions.doneFn=Se,me(),N.clearOutline(H)):(x(Ce)||v(Ce))&&b(De,Ie,Te,N.dragOptions,Ce)}};var re,ue,K,te,G,Y,ee,ne,J,q;function ae(De){var Ie={};return Ie[N.id+".aaxis.min"]=De.a,Ie[N.id+".baxis.min"]=De.b,Ie[N.id+".caxis.min"]=De.c,Ie}function le(De,Ie){var Te=H._fullLayout.clickmode;O(H),De===2&&(H.emit("plotly_doubleclick",null),A.call("_guiRelayout",H,ae({a:0,b:0,c:0}))),Te.indexOf("select")>-1&&De===1&&c(Ie,H,[N.xaxis],[N.yaxis],N.id,N.dragOptions),Te.indexOf("event")>-1&&g.click(H,Ie,N.id)}function ie(De,Ie,Te){var Ce=V.getBoundingClientRect();re=Ie-Ce.left,ue=Te-Ce.top,H._fullLayout._calcInverseTransform(H);var He=H._fullLayout._invTransform,Xe=T.apply3DTransform(He)(re,ue);re=Xe[0],ue=Xe[1],K={a:N.aaxis.range[0],b:N.baxis.range[1],c:N.caxis.range[1]},G=K,te=N.aaxis.range[1]-K.a,Y=u(N.graphDiv._fullLayout[N.id].bgcolor).getLuminance(),ee="M0,"+N.h+"L"+N.w/2+", 0L"+N.w+","+N.h+"Z",ne=!1,J=j.append("path").attr("class","zoombox").attr("transform",e(N.x0,N.y0)).style({fill:Y>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",ee),q=j.append("path").attr("class","zoombox-corners").attr("transform",e(N.x0,N.y0)).style({fill:n.background,stroke:n.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),N.clearOutline(H)}function se(De,Ie){return 1-Ie/N.h}function xe(De,Ie){return 1-(De+(N.h-Ie)/Math.sqrt(3))/N.w}function oe(De,Ie){return(De-(N.h-Ie)/Math.sqrt(3))/N.w}function he(De,Ie){var Te=re+De*Z,Ce=ue+Ie*X,He=Math.max(0,Math.min(1,se(re,ue),se(Te,Ce))),Xe=Math.max(0,Math.min(1,xe(re,ue),xe(Te,Ce))),Be=Math.max(0,Math.min(1,oe(re,ue),oe(Te,Ce))),Re=(He/2+Be)*N.w,We=(1-He/2-Xe)*N.w,vt=(Re+We)/2,Pt=We-Re,Zt=(1-He)*N.h,zt=Zt-Pt/C;Pt<y.MINZOOM?(G=K,J.attr("d",ee),q.attr("d","M0,0Z")):(G={a:K.a+He*te,b:K.b+Xe*te,c:K.c+Be*te},J.attr("d",ee+"M"+Re+","+Zt+"H"+We+"L"+vt+","+zt+"L"+Re+","+Zt+"Z"),q.attr("d","M"+re+","+ue+F+"M"+Re+","+Zt+k+"M"+We+","+Zt+B+"M"+vt+","+zt+z)),ne||(J.transition().style("fill",Y>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),q.transition().style("opacity",1).duration(200),ne=!0),H.emit("plotly_relayouting",ae(G))}function be(){O(H),G!==K&&(A.call("_guiRelayout",H,ae(G)),I&&H.data&&H._context.showTips&&(T.notifier(i(H,"Double-click to zoom back out"),"long"),I=!1))}function me(){K={a:N.aaxis.range[0],b:N.baxis.range[1],c:N.caxis.range[1]},G=K}function _e(De,Ie){var Te=De/N.xaxis._m,Ce=Ie/N.yaxis._m;G={a:K.a-Ce,b:K.b+(Te+Ce)/2,c:K.c-(Te-Ce)/2};var He=[G.a,G.b,G.c].sort(T.sorterAsc),Xe={a:He.indexOf(G.a),b:He.indexOf(G.b),c:He.indexOf(G.c)};He[0]<0&&(He[1]+He[0]/2<0?(He[2]+=He[0]+He[1],He[0]=He[1]=0):(He[2]+=He[0]/2,He[1]+=He[0]/2,He[0]=0),G={a:He[Xe.a],b:He[Xe.b],c:He[Xe.c]},Ie=(K.a-G.a)*N.yaxis._m,De=(K.c-G.c-K.b+G.b)*N.xaxis._m);var Be=e(N.x0+De,N.y0+Ie);N.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Be);var Re=e(-De,-Ie);N.clipDefRelative.select("path").attr("transform",Re),N.aaxis.range=[G.a,N.sum-G.b-G.c],N.baxis.range=[N.sum-G.a-G.c,G.b],N.caxis.range=[N.sum-G.a-G.b,G.c],N.drawAxes(!1),N._hasClipOnAxisFalse&&N.plotContainer.select(".scatterlayer").selectAll(".trace").call(a.hideOutsideRangePoints,N),H.emit("plotly_relayouting",ae(G))}function Se(){A.call("_guiRelayout",H,ae(G))}V.onmousemove=function(De){g.hover(H,De,N.id),H._fullLayout._lasthover=V,H._fullLayout._hoversubplot=N.id},V.onmouseout=function(De){H._dragging||m.unhover(H,De)},m.init(this.dragOptions)};function O(N){h.select(N).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../lib":515,"../../lib/extend":505,"../../registry":647,"../cartesian/axes":566,"../cartesian/constants":573,"../cartesian/set_convert":585,"../plots":628,"@plotly/d3":58,tinycolor2:313}],647:[function(t,P,R){var h=t("./lib/loggers"),u=t("./lib/noop"),A=t("./lib/push_unique"),T=t("./lib/is_plain_object"),e=t("./lib/dom").addStyleRule,i=t("./lib/extend"),n=t("./plots/attributes"),a=t("./plots/layout_attributes"),r=i.extendFlat,f=i.extendDeepAll;R.modules={},R.allCategories={},R.allTypes=[],R.subplotsRegistry={},R.transformsRegistry={},R.componentsRegistry={},R.layoutArrayContainers=[],R.layoutArrayRegexes=[],R.traceLayoutAttributes={},R.localeRegistry={},R.apiMethodRegistry={},R.collectableSubplotTypes=null,R.register=function(_){if(R.collectableSubplotTypes=null,_)_&&!Array.isArray(_)&&(_=[_]);else throw new Error("No argument passed to Plotly.register.");for(var y=0;y<_.length;y++){var w=_[y];if(!w)throw new Error("Invalid module was attempted to be registered!");switch(w.moduleType){case"trace":o(w);break;case"transform":g(w);break;case"component":m(w);break;case"locale":p(w);break;case"apiMethod":var d=w.name;R.apiMethodRegistry[d]=w.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},R.getModule=function(M){var _=R.modules[c(M)];return _?_._module:!1},R.traceIs=function(M,_){if(M=c(M),M==="various")return!1;var y=R.modules[M];return y||(M&&h.log("Unrecognized trace type "+M+"."),y=R.modules[n.type.dflt]),!!y.categories[_]},R.getTransformIndices=function(M,_){for(var y=[],w=M.transforms||[],d=0;d<w.length;d++)w[d].type===_&&y.push(d);return y},R.hasTransform=function(M,_){for(var y=M.transforms||[],w=0;w<y.length;w++)if(y[w].type===_)return!0;return!1},R.getComponentMethod=function(M,_){var y=R.componentsRegistry[M];return y&&y[_]||u},R.call=function(){var M=arguments[0],_=[].slice.call(arguments,1);return R.apiMethodRegistry[M].apply(null,_)};function o(M){var _=M.name,y=M.categories,w=M.meta;if(R.modules[_]){h.log("Type "+_+" already registered");return}R.subplotsRegistry[M.basePlotModule.name]||s(M.basePlotModule);for(var d={},C=0;C<y.length;C++)d[y[C]]=!0,R.allCategories[y[C]]=!0;R.modules[_]={_module:M,categories:d},w&&Object.keys(w).length&&(R.modules[_].meta=w),R.allTypes.push(_);for(var S in R.componentsRegistry)x(S,_);M.layoutAttributes&&r(R.traceLayoutAttributes,M.layoutAttributes);var E=M.basePlotModule,k=E.name;if(k==="mapbox"){var B=E.constants.styleRules;for(var z in B)e(".js-plotly-plot .plotly .mapboxgl-"+z,B[z])}(k==="geo"||k==="mapbox")&&window.PlotlyGeoAssets===void 0&&(window.PlotlyGeoAssets={topojson:{}})}function s(M){var _=M.name;if(R.subplotsRegistry[_]){h.log("Plot type "+_+" already registered.");return}v(M),R.subplotsRegistry[_]=M;for(var y in R.componentsRegistry)b(y,M.name)}function m(M){if(typeof M.name!="string")throw new Error("Component module *name* must be a string.");var _=M.name;R.componentsRegistry[_]=M,M.layoutAttributes&&(M.layoutAttributes._isLinkedToArray&&A(R.layoutArrayContainers,_),v(M));for(var y in R.modules)x(_,y);for(var w in R.subplotsRegistry)b(_,w);for(var d in R.transformsRegistry)l(_,d);M.schema&&M.schema.layout&&f(a,M.schema.layout)}function g(M){if(typeof M.name!="string")throw new Error("Transform module *name* must be a string.");var _="Transform module "+M.name,y=typeof M.transform=="function",w=typeof M.calcTransform=="function";if(!y&&!w)throw new Error(_+" is missing a *transform* or *calcTransform* method.");y&&w&&h.log([_+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),T(M.attributes)||h.log(_+" registered without an *attributes* object."),typeof M.supplyDefaults!="function"&&h.log(_+" registered without a *supplyDefaults* method."),R.transformsRegistry[M.name]=M;for(var d in R.componentsRegistry)l(d,M.name)}function p(M){var _=M.name,y=_.split("-")[0],w=M.dictionary,d=M.format,C=w&&Object.keys(w).length,S=d&&Object.keys(d).length,E=R.localeRegistry,k=E[_];if(k||(E[_]=k={}),y!==_){var B=E[y];B||(E[y]=B={}),C&&B.dictionary===k.dictionary&&(B.dictionary=w),S&&B.format===k.format&&(B.format=d)}C&&(k.dictionary=w),S&&(k.format=d)}function v(M){if(M.layoutAttributes){var _=M.layoutAttributes._arrayAttrRegexps;if(_)for(var y=0;y<_.length;y++)A(R.layoutArrayRegexes,_[y])}}function x(M,_){var y=R.componentsRegistry[M].schema;if(!(!y||!y.traces)){var w=y.traces[_];w&&f(R.modules[_]._module.attributes,w)}}function l(M,_){var y=R.componentsRegistry[M].schema;if(!(!y||!y.transforms)){var w=y.transforms[_];w&&f(R.transformsRegistry[_].attributes,w)}}function b(M,_){var y=R.componentsRegistry[M].schema;if(!(!y||!y.subplots)){var w=R.subplotsRegistry[_],d=w.layoutAttributes,C=w.attr==="subplot"?w.name:w.attr;Array.isArray(C)&&(C=C[0]);var S=y.subplots[C];d&&S&&f(d,S)}}function c(M){return typeof M=="object"&&(M=M.type),M}},{"./lib/dom":503,"./lib/extend":505,"./lib/is_plain_object":516,"./lib/loggers":519,"./lib/noop":524,"./lib/push_unique":530,"./plots/attributes":562,"./plots/layout_attributes":619}],648:[function(t,P,R){var h=t("../registry"),u=t("../lib"),A=u.extendFlat,T=u.extendDeep;function e(n){var a;switch(n){case"themes__thumb":a={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":a={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:a={}}return a}function i(n){var a=["xaxis","yaxis","zaxis"];return a.indexOf(n.slice(0,5))>-1}P.exports=function(a,r){var f,o=a.data,s=a.layout,m=T([],o),g=T({},s,e(r.tileClass)),p=a._context||{};if(r.width&&(g.width=r.width),r.height&&(g.height=r.height),r.tileClass==="thumbnail"||r.tileClass==="themes__thumb"){g.annotations=[];var v=Object.keys(g);for(f=0;f<v.length;f++)i(v[f])&&(g[v[f]].title={text:""});for(f=0;f<m.length;f++){var x=m[f];x.showscale=!1,x.marker&&(x.marker.showscale=!1),h.traceIs(x,"pie-like")&&(x.textposition="none")}}if(Array.isArray(r.annotations))for(f=0;f<r.annotations.length;f++)g.annotations.push(r.annotations[f]);var l=Object.keys(g).filter(function(y){return y.match(/^scene\d*$/)});if(l.length){var b={};for(r.tileClass==="thumbnail"&&(b={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),f=0;f<l.length;f++){var c=g[l[f]];c.xaxis||(c.xaxis={}),c.yaxis||(c.yaxis={}),c.zaxis||(c.zaxis={}),A(c.xaxis,b),A(c.yaxis,b),A(c.zaxis,b),c._scene=null}}var M=document.createElement("div");r.tileClass&&(M.className=r.tileClass);var _={gd:M,td:M,layout:g,data:m,config:{staticPlot:r.staticPlot===void 0?!0:r.staticPlot,plotGlPixelRatio:r.plotGlPixelRatio===void 0?2:r.plotGlPixelRatio,displaylogo:r.displaylogo||!1,showLink:r.showLink||!1,showTips:r.showTips||!1,mapboxAccessToken:p.mapboxAccessToken}};return r.setBackground!=="transparent"&&(_.config.setBackground=r.setBackground||"opaque"),_.gd.defaultLayout=e(r.tileClass),_}},{"../lib":515,"../registry":647}],649:[function(t,P,R){var h=t("../lib"),u=t("../plot_api/to_image"),A=t("./filesaver"),T=t("./helpers");function e(i,n){var a;return h.isPlainObject(i)||(a=h.getGraphDiv(i)),n=n||{},n.format=n.format||"png",n.width=n.width||null,n.height=n.height||null,n.imageDataOnly=!0,new Promise(function(r,f){a&&a._snapshotInProgress&&f(new Error("Snapshotting already in progress.")),h.isIE()&&n.format!=="svg"&&f(new Error(T.MSG_IE_BAD_FORMAT)),a&&(a._snapshotInProgress=!0);var o=u(i,n),s=n.filename||i.fn||"newplot";s+="."+n.format.replace("-","."),o.then(function(m){return a&&(a._snapshotInProgress=!1),A(m,s,n.format)}).then(function(m){r(m)}).catch(function(m){a&&(a._snapshotInProgress=!1),f(m)})})}P.exports=e},{"../lib":515,"../plot_api/to_image":558,"./filesaver":650,"./helpers":651}],650:[function(t,P,R){var h=t("../lib"),u=t("./helpers");function A(T,e,i){var n=document.createElement("a"),a="download"in n,r=new Promise(function(f,o){var s,m;if(h.isIE())return s=u.createBlob(T,"svg"),window.navigator.msSaveBlob(s,e),s=null,f(e);if(a)return s=u.createBlob(T,i),m=u.createObjectURL(s),n.href=m,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),u.revokeObjectURL(m),s=null,f(e);if(h.isSafari()){var g=i==="svg"?",":";base64,";return u.octetStream(g+encodeURIComponent(T)),f(e)}o(new Error("download error"))});return r}P.exports=A},{"../lib":515,"./helpers":651}],651:[function(t,P,R){var h=t("../registry");R.getDelay=function(T){return T._has&&(T._has("gl3d")||T._has("gl2d")||T._has("mapbox"))?500:0},R.getRedrawFunc=function(T){return function(){h.getComponentMethod("colorbar","draw")(T)}},R.encodeSVG=function(T){return"data:image/svg+xml,"+encodeURIComponent(T)},R.encodeJSON=function(T){return"data:application/json,"+encodeURIComponent(T)};var u=window.URL||window.webkitURL;R.createObjectURL=function(T){return u.createObjectURL(T)},R.revokeObjectURL=function(T){return u.revokeObjectURL(T)},R.createBlob=function(T,e){if(e==="svg")return new window.Blob([T],{type:"image/svg+xml;charset=utf-8"});if(e==="full-json")return new window.Blob([T],{type:"application/json;charset=utf-8"});var i=A(window.atob(T));return new window.Blob([i],{type:"image/"+e})},R.octetStream=function(T){document.location.href="data:application/octet-stream"+T};function A(T){for(var e=T.length,i=new ArrayBuffer(e),n=new Uint8Array(i),a=0;a<e;a++)n[a]=T.charCodeAt(a);return i}R.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,R.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":647}],652:[function(t,P,R){var h=t("./helpers"),u={getDelay:h.getDelay,getRedrawFunc:h.getRedrawFunc,clone:t("./cloneplot"),toSVG:t("./tosvg"),svgToImg:t("./svgtoimg"),toImage:t("./toimage"),downloadImage:t("./download")};P.exports=u},{"./cloneplot":648,"./download":649,"./helpers":651,"./svgtoimg":653,"./toimage":654,"./tosvg":655}],653:[function(t,P,R){var h=t("../lib"),u=t("events").EventEmitter,A=t("./helpers");function T(e){var i=e.emitter||new u,n=new Promise(function(a,r){var f=window.Image,o=e.svg,s=e.format||"png";if(h.isIE()&&s!=="svg"){var m=new Error(A.MSG_IE_BAD_FORMAT);return r(m),e.promise?n:i.emit("error",m)}var g=e.canvas,p=e.scale||1,v=e.width||300,x=e.height||150,l=p*v,b=p*x,c=g.getContext("2d",{willReadFrequently:!0}),M=new f,_,y;s==="svg"||h.isSafari()?y=A.encodeSVG(o):(_=A.createBlob(o,"svg"),y=A.createObjectURL(_)),g.width=l,g.height=b,M.onload=function(){var w;switch(_=null,A.revokeObjectURL(y),s!=="svg"&&c.drawImage(M,0,0,l,b),s){case"jpeg":w=g.toDataURL("image/jpeg");break;case"png":w=g.toDataURL("image/png");break;case"webp":w=g.toDataURL("image/webp");break;case"svg":w=y;break;default:var d="Image format is not jpeg, png, svg or webp.";if(r(new Error(d)),!e.promise)return i.emit("error",d)}a(w),e.promise||i.emit("success",w)},M.onerror=function(w){if(_=null,A.revokeObjectURL(y),r(w),!e.promise)return i.emit("error",w)},M.src=y});return e.promise?n:i}P.exports=T},{"../lib":515,"./helpers":651,events:84}],654:[function(t,P,R){var h=t("events").EventEmitter,u=t("../registry"),A=t("../lib"),T=t("./helpers"),e=t("./cloneplot"),i=t("./tosvg"),n=t("./svgtoimg");function a(r,f){var o=new h,s=e(r,{format:"png"}),m=s.gd;m.style.position="absolute",m.style.left="-5000px",document.body.appendChild(m);function g(){var v=T.getDelay(m._fullLayout);setTimeout(function(){var x=i(m),l=document.createElement("canvas");l.id=A.randstr(),o=n({format:f.format,width:m._fullLayout.width,height:m._fullLayout.height,canvas:l,emitter:o,svg:x}),o.clean=function(){m&&document.body.removeChild(m)}},v)}var p=T.getRedrawFunc(m);return u.call("_doPlot",m,s.data,s.layout,s.config).then(p).then(g).catch(function(v){o.emit("error",v)}),o}P.exports=a},{"../lib":515,"../registry":647,"./cloneplot":648,"./helpers":651,"./svgtoimg":653,"./tosvg":655,events:84}],655:[function(t,P,R){var h=t("@plotly/d3"),u=t("../lib"),A=t("../components/drawing"),T=t("../components/color"),e=t("../constants/xmlns_namespaces"),i=/"/g,n="TOBESTRIPPED",a=new RegExp('("'+n+")|("+n+'")',"g");function r(o){var s=h.select("body").append("div").style({display:"none"}).html(""),m=o.replace(/(&[^;]*;)/gi,function(g){return g==="&lt;"?"&#60;":g==="&rt;"?"&#62;":g.indexOf("<")!==-1||g.indexOf(">")!==-1?"":s.html(g).text()});return s.remove(),m}function f(o){return o.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}P.exports=function(s,m,g){var p=s._fullLayout,v=p._paper,x=p._toppaper,l=p.width,b=p.height,c;v.insert("rect",":first-child").call(A.setRect,0,0,l,b).call(T.fill,p.paper_bgcolor);var M=p._basePlotModules||[];for(c=0;c<M.length;c++){var _=M[c];_.toSVG&&_.toSVG(s)}if(x){var y=x.node().childNodes,w=Array.prototype.slice.call(y);for(c=0;c<w.length;c++){var d=w[c];d.childNodes.length&&v.node().appendChild(d)}}p._draggers&&p._draggers.remove(),v.node().style.background="",v.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var S=h.select(this);if(this.style.visibility==="hidden"||this.style.display==="none"){S.remove();return}else S.style({visibility:null,display:null});var E=this.style.fontFamily;E&&E.indexOf('"')!==-1&&S.style("font-family",E.replace(i,n))}),v.selectAll(".gradient_filled,.pattern_filled").each(function(){var S=h.select(this),E=this.style.fill;E&&E.indexOf("url(")!==-1&&S.style("fill",E.replace(i,n));var k=this.style.stroke;k&&k.indexOf("url(")!==-1&&S.style("stroke",k.replace(i,n))}),(m==="pdf"||m==="eps")&&v.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),v.node().setAttributeNS(e.xmlns,"xmlns",e.svg),v.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),m==="svg"&&g&&(v.attr("width",g*l),v.attr("height",g*b),v.attr("viewBox","0 0 "+l+" "+b));var C=new window.XMLSerializer().serializeToString(v.node());return C=r(C),C=f(C),C=C.replace(a,"'"),u.isIE()&&(C=C.replace(/"/gi,"'"),C=C.replace(/(\('#)([^']*)('\))/gi,'("#$2")'),C=C.replace(/(\\')/gi,'"')),C}},{"../components/color":367,"../components/drawing":389,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],656:[function(t,P,R){var h=t("../../lib");P.exports=function(A,T){for(var e=0;e<A.length;e++)A[e].i=e;h.mergeArray(T.text,A,"tx"),h.mergeArray(T.hovertext,A,"htx");var i=T.marker;if(i){h.mergeArray(i.opacity,A,"mo",!0),h.mergeArray(i.color,A,"mc");var n=i.line;n&&(h.mergeArray(n.color,A,"mlc"),h.mergeArrayCastPositive(n.width,A,"mlw"))}}},{"../../lib":515}],657:[function(t,P,R){var h=t("../scatter/attributes"),u=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,A=t("../../plots/template_attributes").hovertemplateAttrs,T=t("../../plots/template_attributes").texttemplateAttrs,e=t("../../components/colorscale/attributes"),i=t("../../plots/font_attributes"),n=t("./constants"),a=t("../../components/drawing/attributes").pattern,r=t("../../lib/extend").extendFlat,f=i({editType:"calc",arrayOk:!0,colorEditType:"style"}),o=h.marker,s=o.line,m=r({},s.width,{dflt:0}),g=r({width:m,editType:"calc"},e("marker.line")),p=r({line:g,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:a});P.exports={x:h.x,x0:h.x0,dx:h.dx,y:h.y,y0:h.y0,dy:h.dy,xperiod:h.xperiod,yperiod:h.yperiod,xperiod0:h.xperiod0,yperiod0:h.yperiod0,xperiodalignment:h.xperiodalignment,yperiodalignment:h.yperiodalignment,xhoverformat:u("x"),yhoverformat:u("y"),text:h.text,texttemplate:T({editType:"plot"},{keys:n.eventDataKeys}),hovertext:h.hovertext,hovertemplate:A({},{keys:n.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:r({},f,{}),insidetextfont:r({},f,{}),outsidetextfont:r({},f,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:r({},h.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:p,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:h.selected.marker.opacity,color:h.selected.marker.color,editType:"style"},textfont:h.selected.textfont,editType:"style"},unselected:{marker:{opacity:h.unselected.marker.opacity,color:h.unselected.marker.color,editType:"style"},textfont:h.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936,"./constants":659}],658:[function(t,P,R){var h=t("../../plots/cartesian/axes"),u=t("../../plots/cartesian/align_period"),A=t("../../components/colorscale/helpers").hasColorscale,T=t("../../components/colorscale/calc"),e=t("./arrays_to_calcdata"),i=t("../scatter/calc_selection");P.exports=function(a,r){var f=h.getFromId(a,r.xaxis||"x"),o=h.getFromId(a,r.yaxis||"y"),s,m,g,p,v,x,l={msUTC:!!(r.base||r.base===0)};r.orientation==="h"?(s=f.makeCalcdata(r,"x",l),g=o.makeCalcdata(r,"y"),p=u(r,o,"y",g),v=!!r.yperiodalignment,x="y"):(s=o.makeCalcdata(r,"y",l),g=f.makeCalcdata(r,"x"),p=u(r,f,"x",g),v=!!r.xperiodalignment,x="x"),m=p.vals;for(var b=Math.min(m.length,s.length),c=new Array(b),M=0;M<b;M++)c[M]={p:m[M],s:s[M]},v&&(c[M].orig_p=g[M],c[M][x+"End"]=p.ends[M],c[M][x+"Start"]=p.starts[M]),r.ids&&(c[M].id=String(r.ids[M]));return A(r,"marker")&&T(a,r,{vals:r.marker.color,containerStr:"marker",cLetter:"c"}),A(r,"marker.line")&&T(a,r,{vals:r.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(c,r),i(c,r),c}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":656}],659:[function(t,P,R){P.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],660:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib").isArrayOrTypedArray,A=t("../../constants/numerical").BADNUM,T=t("../../registry"),e=t("../../plots/cartesian/axes"),i=t("../../plots/cartesian/constraints").getAxisGroup,n=t("./sieve.js");function a(C,S){for(var E=S.xaxis,k=S.yaxis,B=C._fullLayout,z=C._fullData,F=C.calcdata,I=[],O=[],N=0;N<z.length;N++){var V=z[N];if(V.visible===!0&&T.traceIs(V,"bar")&&V.xaxis===E._id&&V.yaxis===k._id&&(V.orientation==="h"?I.push(F[N]):O.push(F[N]),V._computePh))for(var H=C.calcdata[N],j=0;j<H.length;j++)typeof H[j].ph0=="function"&&(H[j].ph0=H[j].ph0()),typeof H[j].ph1=="function"&&(H[j].ph1=H[j].ph1())}var Z={xCat:E.type==="category"||E.type==="multicategory",yCat:k.type==="category"||k.type==="multicategory",mode:B.barmode,norm:B.barnorm,gap:B.bargap,groupgap:B.bargroupgap};r(C,E,k,O,Z),r(C,k,E,I,Z)}function r(C,S,E,k,B){if(!!k.length){var z,F,I,O,N;switch(f(E,k),B.mode){case"overlay":o(S,E,k,B);break;case"group":for(z=[],F=[],I=0;I<k.length;I++)O=k[I],N=O[0].trace,N.offset===void 0?F.push(O):z.push(O);F.length&&s(C,S,E,F,B),z.length&&o(S,E,z,B);break;case"stack":case"relative":for(z=[],F=[],I=0;I<k.length;I++)O=k[I],N=O[0].trace,N.base===void 0?F.push(O):z.push(O);F.length&&m(C,S,E,F,B),z.length&&o(S,E,z,B);break}w(k,S)}}function f(C,S){var E,k;for(E=0;E<S.length;E++){var B=S[E],z=B[0].trace,F=z.type==="funnel"?z._base:z.base,I,O=z.orientation==="h"?z.xcalendar:z.ycalendar,N=C.type==="category"||C.type==="multicategory"?function(){return null}:C.d2c;if(u(F)){for(k=0;k<Math.min(F.length,B.length);k++)I=N(F[k],0,O),h(I)?(B[k].b=+I,B[k].hasB=1):B[k].b=0;for(;k<B.length;k++)B[k].b=0}else{I=N(F,0,O);var V=h(I);for(I=V?I:0,k=0;k<B.length;k++)B[k].b=I,V&&(B[k].hasB=1)}}}function o(C,S,E,k){for(var B=0;B<E.length;B++){var z=E[B],F=new n([z],{posAxis:C,sepNegVal:!1,overlapNoMerge:!k.norm});g(C,F,k),k.norm?(M(F),y(S,F,k)):b(S,F)}}function s(C,S,E,k,B){var z=new n(k,{posAxis:S,sepNegVal:!1,overlapNoMerge:!B.norm});p(C,S,z,B),_(z,S),B.norm?(M(z),y(E,z,B)):b(E,z)}function m(C,S,E,k,B){var z=new n(k,{posAxis:S,sepNegVal:B.mode==="relative",overlapNoMerge:!(B.norm||B.mode==="stack"||B.mode==="relative")});g(S,z,B),c(E,z,B);for(var F=0;F<k.length;F++)for(var I=k[F],O=0;O<I.length;O++){var N=I[O];if(N.s!==A){var V=N.b+N.s===z.get(N.p,N.s);V&&(N._outmost=!0)}}B.norm&&y(E,z,B)}function g(C,S,E){for(var k=S.minDiff,B=S.traces,z=k*(1-E.gap),F=z,I=F*(1-(E.groupgap||0)),O=-I/2,N=0;N<B.length;N++){var V=B[N],H=V[0].t;H.barwidth=I,H.poffset=O,H.bargroupwidth=z,H.bardelta=k}S.binWidth=B[0][0].t.barwidth/100,v(S),x(C,S),l(C,S)}function p(C,S,E,k){for(var B=C._fullLayout,z=E.positions,F=E.distinctPositions,I=E.minDiff,O=E.traces,N=O.length,V=z.length!==F.length,H=I*(1-k.gap),j=i(B,S._id)+O[0][0].trace.orientation,Z=B._alignmentOpts[j]||{},X=0;X<N;X++){var re=O[X],ue=re[0].trace,K=Z[ue.alignmentgroup]||{},te=Object.keys(K.offsetGroups||{}).length,G;te?G=H/te:G=V?H/N:H;var Y=G*(1-(k.groupgap||0)),ee;te?ee=((2*ue._offsetIndex+1-te)*G-Y)/2:ee=V?((2*X+1-N)*G-Y)/2:-Y/2;var ne=re[0].t;ne.barwidth=Y,ne.poffset=ee,ne.bargroupwidth=H,ne.bardelta=I}E.binWidth=O[0][0].t.barwidth/100,v(E),x(S,E),l(S,E,V)}function v(C){var S=C.traces,E,k;for(E=0;E<S.length;E++){var B=S[E],z=B[0],F=z.trace,I=z.t,O=F._offset||F.offset,N=I.poffset,V;if(u(O)){for(V=Array.prototype.slice.call(O,0,B.length),k=0;k<V.length;k++)h(V[k])||(V[k]=N);for(k=V.length;k<B.length;k++)V.push(N);I.poffset=V}else O!==void 0&&(I.poffset=O);var H=F._width||F.width,j=I.barwidth;if(u(H)){var Z=Array.prototype.slice.call(H,0,B.length);for(k=0;k<Z.length;k++)h(Z[k])||(Z[k]=j);for(k=Z.length;k<B.length;k++)Z.push(j);if(I.barwidth=Z,O===void 0){for(V=[],k=0;k<B.length;k++)V.push(N+(j-Z[k])/2);I.poffset=V}}else H!==void 0&&(I.barwidth=H,O===void 0&&(I.poffset=N+(j-H)/2))}}function x(C,S){for(var E=S.traces,k=d(C),B=0;B<E.length;B++)for(var z=E[B],F=z[0].t,I=F.poffset,O=Array.isArray(I),N=F.barwidth,V=Array.isArray(N),H=0;H<z.length;H++){var j=z[H],Z=j.w=V?N[H]:N;j[k]=j.p+(O?I[H]:I)+Z/2}}function l(C,S,E){var k=S.traces,B=S.minDiff,z=B/2;e.minDtick(C,S.minDiff,S.distinctPositions[0],E);for(var F=0;F<k.length;F++){var I=k[F],O=I[0],N=O.trace,V=[],H,j,Z,X;for(X=0;X<I.length;X++)H=I[X],j=H.p-z,Z=H.p+z,V.push(j,Z);if(N.width||N.offset){var re=O.t,ue=re.poffset,K=re.barwidth,te=Array.isArray(ue),G=Array.isArray(K);for(X=0;X<I.length;X++){H=I[X];var Y=te?ue[X]:ue,ee=G?K[X]:K;j=H.p+Y,Z=j+ee,V.push(j,Z)}}N._extremes[C._id]=e.findExtremes(C,V,{padded:!1})}}function b(C,S){for(var E=S.traces,k=d(C),B=0;B<E.length;B++){for(var z=E[B],F=z[0].trace,I=[],O=!1,N=0;N<z.length;N++){var V=z[N],H=V.b,j=H+V.s;V[k]=j,I.push(j),V.hasB&&I.push(H),(!V.hasB||!V.b)&&(O=!0)}F._extremes[C._id]=e.findExtremes(C,I,{tozero:O,padded:!0})}}function c(C,S,E){var k=d(C),B=S.traces,z,F,I,O,N,V;for(O=0;O<B.length;O++)if(z=B[O],F=z[0].trace,F.type==="funnel")for(N=0;N<z.length;N++)V=z[N],V.s!==A&&S.put(V.p,-.5*V.s);for(O=0;O<B.length;O++){z=B[O],F=z[0].trace,I=F.type==="funnel";var H=[];for(N=0;N<z.length;N++)if(V=z[N],V.s!==A){var j;I?j=V.s:j=V.s+V.b;var Z=S.put(V.p,j),X=Z+j;V.b=Z,V[k]=X,E.norm||(H.push(X),V.hasB&&H.push(Z))}E.norm||(F._extremes[C._id]=e.findExtremes(C,H,{tozero:!0,padded:!0}))}}function M(C){for(var S=C.traces,E=0;E<S.length;E++)for(var k=S[E],B=0;B<k.length;B++){var z=k[B];z.s!==A&&C.put(z.p,z.b+z.s)}}function _(C,S){for(var E=C.traces,k=0;k<E.length;k++){var B=E[k],z=B[0].trace;if(z.base===void 0)for(var F=new n([B],{posAxis:S,sepNegVal:!0,overlapNoMerge:!0}),I=0;I<B.length;I++){var O=B[I];if(O.p!==A){var N=F.put(O.p,O.b+O.s);N&&(O.b=N)}}}}function y(C,S,E){var k=S.traces,B=d(C),z=E.norm==="fraction"?1:100,F=z/1e9,I=C.l2c(C.c2l(0)),O=E.mode==="stack"?z:I;function N(ee){return h(C.c2l(ee))&&(ee<I-F||ee>O+F||!h(I))}for(var V=0;V<k.length;V++){for(var H=k[V],j=H[0].trace,Z=[],X=!1,re=!1,ue=0;ue<H.length;ue++){var K=H[ue];if(K.s!==A){var te=Math.abs(z/S.get(K.p,K.s));K.b*=te,K.s*=te;var G=K.b,Y=G+K.s;K[B]=Y,Z.push(Y),re=re||N(Y),K.hasB&&(Z.push(G),re=re||N(G)),(!K.hasB||!K.b)&&(X=!0)}}j._extremes[C._id]=e.findExtremes(C,Z,{tozero:X,padded:re})}}function w(C,S){var E=d(S),k={},B,z,F,I=1/0,O=-1/0;for(B=0;B<C.length;B++)for(F=C[B],z=0;z<F.length;z++){var N=F[z].p;h(N)&&(I=Math.min(I,N),O=Math.max(O,N))}var V=1e4/(O-I),H=k.round=function(te){return String(Math.round(V*(te-I)))};for(B=0;B<C.length;B++){F=C[B],F[0].t.extents=k;var j=F[0].t.poffset,Z=Array.isArray(j);for(z=0;z<F.length;z++){var X=F[z],re=X[E]-X.w/2;if(h(re)){var ue=X[E]+X.w/2,K=H(X.p);k[K]?k[K]=[Math.min(re,k[K][0]),Math.max(ue,k[K][1])]:k[K]=[re,ue]}X.p0=X.p+(Z?j[z]:j),X.p1=X.p0+X.w,X.s0=X.b,X.s1=X.s0+X.s}}}function d(C){return C._id.charAt(0)}P.exports={crossTraceCalc:a,setGroupPositions:r}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574,"../../registry":647,"./sieve.js":670,"fast-isnumeric":190}],661:[function(t,P,R){var h=t("../../lib"),u=t("../../components/color"),A=t("../../registry"),T=t("../scatter/xy_defaults"),e=t("../scatter/period_defaults"),i=t("./style_defaults"),n=t("../../plots/cartesian/constraints").getAxisGroup,a=t("./attributes"),r=h.coerceFont;function f(g,p,v,x){function l(y,w){return h.coerce(g,p,a,y,w)}var b=T(g,p,x,l);if(!b){p.visible=!1;return}e(g,p,x,l),l("xhoverformat"),l("yhoverformat"),l("orientation",p.x&&!p.y?"h":"v"),l("base"),l("offset"),l("width"),l("text"),l("hovertext"),l("hovertemplate");var c=l("textposition");m(g,p,x,l,c,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),i(g,p,l,v,x);var M=(p.marker.line||{}).color,_=A.getComponentMethod("errorbars","supplyDefaults");_(g,p,M||u.defaultLine,{axis:"y"}),_(g,p,M||u.defaultLine,{axis:"x",inherit:"y"}),h.coerceSelectionMarkerOpacity(p,l)}function o(g,p,v,x){var l=p.orientation,b=p[{v:"x",h:"y"}[l]+"axis"],c=n(v,b)+l,M=v._alignmentOpts||{},_=x("alignmentgroup"),y=M[c];y||(y=M[c]={});var w=y[_];w?w.traces.push(p):w=y[_]={traces:[p],alignmentIndex:Object.keys(y).length,offsetGroups:{}};var d=x("offsetgroup"),C=w.offsetGroups,S=C[d];d&&(S||(S=C[d]={offsetIndex:Object.keys(C).length}),p._offsetIndex=S.offsetIndex)}function s(g,p){var v,x;function l(c){return h.coerce(x._input,x,a,c)}if(p.barmode==="group")for(var b=0;b<g.length;b++)x=g[b],x.type==="bar"&&(v=x._input,o(v,x,p,l))}function m(g,p,v,x,l,b){b=b||{};var c=b.moduleHasSelected!==!1,M=b.moduleHasUnselected!==!1,_=b.moduleHasConstrain!==!1,y=b.moduleHasCliponaxis!==!1,w=b.moduleHasTextangle!==!1,d=b.moduleHasInsideanchor!==!1,C=!!b.hasPathbar,S=Array.isArray(l)||l==="auto",E=S||l==="inside",k=S||l==="outside";if(E||k){var B=r(x,"textfont",v.font),z=h.extendFlat({},B),F=g.textfont&&g.textfont.color,I=!F;if(I&&delete z.color,r(x,"insidetextfont",z),C){var O=h.extendFlat({},B);I&&delete O.color,r(x,"pathbar.textfont",O)}k&&r(x,"outsidetextfont",B),c&&x("selected.textfont.color"),M&&x("unselected.textfont.color"),_&&x("constraintext"),y&&x("cliponaxis"),w&&x("textangle"),x("texttemplate")}E&&d&&x("insidetextanchor")}P.exports={supplyDefaults:f,crossTraceDefaults:s,handleGroupingDefaults:o,handleText:m}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/constraints":574,"../../registry":647,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":657,"./style_defaults":672}],662:[function(t,P,R){P.exports=function(u,A,T){return u.x="xVal"in A?A.xVal:A.x,u.y="yVal"in A?A.yVal:A.y,A.xa&&(u.xaxis=A.xa),A.ya&&(u.yaxis=A.ya),T.orientation==="h"?(u.label=u.y,u.value=u.x):(u.label=u.x,u.value=u.y),u}},{}],663:[function(t,P,R){var h=t("fast-isnumeric"),u=t("tinycolor2"),A=t("../../lib").isArrayOrTypedArray;R.coerceString=function(T,e,i){if(typeof e=="string"){if(e||!T.noBlank)return e}else if((typeof e=="number"||e===!0)&&!T.strict)return String(e);return i!==void 0?i:T.dflt},R.coerceNumber=function(T,e,i){if(h(e)){e=+e;var n=T.min,a=T.max,r=n!==void 0&&e<n||a!==void 0&&e>a;if(!r)return e}return i!==void 0?i:T.dflt},R.coerceColor=function(T,e,i){return u(e).isValid()?e:i!==void 0?i:T.dflt},R.coerceEnumerated=function(T,e,i){return T.coerceNumber&&(e=+e),T.values.indexOf(e)!==-1?e:i!==void 0?i:T.dflt},R.getValue=function(T,e){var i;return Array.isArray(T)?e<T.length&&(i=T[e]):i=T,i},R.getLineWidth=function(T,e){var i=0<e.mlw?e.mlw:A(T.marker.line.width)?0:T.marker.line.width;return i}},{"../../lib":515,"fast-isnumeric":190,tinycolor2:313}],664:[function(t,P,R){var h=t("../../components/fx"),u=t("../../registry"),A=t("../../components/color"),T=t("../../lib").fillText,e=t("./helpers").getLineWidth,i=t("../../plots/cartesian/axes").hoverLabelText,n=t("../../constants/numerical").BADNUM;function a(o,s,m,g,p){var v=r(o,s,m,g,p);if(v){var x=v.cd,l=x[0].trace,b=x[v.index];return v.color=f(l,b),u.getComponentMethod("errorbars","hoverInfo")(b,l,v),[v]}}function r(o,s,m,g,p){var v=o.cd,x=v[0].trace,l=v[0].t,b=g==="closest",c=x.type==="waterfall",M=o.maxHoverDistance,_=o.maxSpikeDistance,y,w,d,C,S,E,k;x.orientation==="h"?(y=m,w=s,d="y",C="x",S=ue,E=Z):(y=s,w=m,d="x",C="y",E=ue,S=Z);var B=x[d+"period"],z=b||B;function F(ie){return O(ie,-1)}function I(ie){return O(ie,1)}function O(ie,se){var xe=ie.w;return ie[d]+se*xe/2}function N(ie){return ie[d+"End"]-ie[d+"Start"]}var V=b?F:B?function(ie){return ie.p-N(ie)/2}:function(ie){return Math.min(F(ie),ie.p-l.bardelta/2)},H=b?I:B?function(ie){return ie.p+N(ie)/2}:function(ie){return Math.max(I(ie),ie.p+l.bardelta/2)};function j(ie,se,xe){return p.finiteRange&&(xe=0),h.inbox(ie-y,se-y,xe+Math.min(1,Math.abs(se-ie)/k)-1)}function Z(ie){return j(V(ie),H(ie),M)}function X(ie){return j(F(ie),I(ie),_)}function re(ie){var se=ie[C];if(c){var xe=Math.abs(ie.rawS)||0;w>0?se+=xe:w<0&&(se-=xe)}return se}function ue(ie){var se=w,xe=ie.b,oe=re(ie);return h.inbox(xe-se,oe-se,M+(oe-se)/(oe-xe)-1)}function K(ie){var se=w,xe=ie.b,oe=re(ie);return h.inbox(xe-se,oe-se,_+(oe-se)/(oe-xe)-1)}var te=o[d+"a"],G=o[C+"a"];k=Math.abs(te.r2c(te.range[1])-te.r2c(te.range[0]));function Y(ie){return(S(ie)+E(ie))/2}var ee=h.getDistanceFunction(g,S,E,Y);if(h.getClosest(v,ee,o),o.index!==!1&&v[o.index].p!==n){z||(V=function(ie){return Math.min(F(ie),ie.p-l.bargroupwidth/2)},H=function(ie){return Math.max(I(ie),ie.p+l.bargroupwidth/2)});var ne=o.index,J=v[ne],q=x.base?J.b+J.s:J.s;o[C+"0"]=o[C+"1"]=G.c2p(J[C],!0),o[C+"LabelVal"]=q;var ae=l.extents[l.extents.round(J.p)];o[d+"0"]=te.c2p(b?V(J):ae[0],!0),o[d+"1"]=te.c2p(b?H(J):ae[1],!0);var le=J.orig_p!==void 0;return o[d+"LabelVal"]=le?J.orig_p:J.p,o.labelLabel=i(te,o[d+"LabelVal"],x[d+"hoverformat"]),o.valueLabel=i(G,o[C+"LabelVal"],x[C+"hoverformat"]),o.baseLabel=i(G,J.b,x[C+"hoverformat"]),o.spikeDistance=(K(J)+X(J))/2,o[d+"Spike"]=te.c2p(J.p,!0),T(J,x,o),o.hovertemplate=x.hovertemplate,o}}function f(o,s){var m=s.mcc||o.marker.color,g=s.mlcc||o.marker.line.color,p=e(o,s);if(A.opacity(m))return m;if(A.opacity(g)&&p)return g}P.exports={hoverPoints:a,hoverOnBars:r,getTraceColor:f}},{"../../components/color":367,"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./helpers":663}],665:[function(t,P,R){P.exports={attributes:t("./attributes"),layoutAttributes:t("./layout_attributes"),supplyDefaults:t("./defaults").supplyDefaults,crossTraceDefaults:t("./defaults").crossTraceDefaults,supplyLayoutDefaults:t("./layout_defaults"),calc:t("./calc"),crossTraceCalc:t("./cross_trace_calc").crossTraceCalc,colorbar:t("../scatter/marker_colorbar"),arraysToCalcdata:t("./arrays_to_calcdata"),plot:t("./plot").plot,style:t("./style").style,styleOnSelect:t("./style").styleOnSelect,hoverPoints:t("./hover").hoverPoints,eventData:t("./event_data"),selectPoints:t("./select"),moduleType:"trace",name:"bar",basePlotModule:t("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"./arrays_to_calcdata":656,"./attributes":657,"./calc":658,"./cross_trace_calc":660,"./defaults":661,"./event_data":662,"./hover":664,"./layout_attributes":666,"./layout_defaults":667,"./plot":668,"./select":669,"./style":671}],666:[function(t,P,R){P.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],667:[function(t,P,R){var h=t("../../registry"),u=t("../../plots/cartesian/axes"),A=t("../../lib"),T=t("./layout_attributes");P.exports=function(e,i,n){function a(l,b){return A.coerce(e,i,T,l,b)}for(var r=!1,f=!1,o=!1,s={},m=a("barmode"),g=0;g<n.length;g++){var p=n[g];if(h.traceIs(p,"bar")&&p.visible)r=!0;else continue;if(m==="group"){var v=p.xaxis+p.yaxis;s[v]&&(o=!0),s[v]=!0}if(p.visible&&p.type==="histogram"){var x=u.getFromId({_fullLayout:i},p[p.orientation==="v"?"xaxis":"yaxis"]);x.type!=="category"&&(f=!0)}}if(!r){delete i.barmode;return}m!=="overlay"&&a("barnorm"),a("bargap",f&&!o?0:.2),a("bargroupgap")}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./layout_attributes":666}],668:[function(t,P,R){var h=t("@plotly/d3"),u=t("fast-isnumeric"),A=t("../../lib"),T=t("../../lib/svg_text_utils"),e=t("../../components/color"),i=t("../../components/drawing"),n=t("../../registry"),a=t("../../plots/cartesian/axes").tickText,r=t("./uniform_text"),f=r.recordMinTextSize,o=r.clearMinTextSize,s=t("./style"),m=t("./helpers"),g=t("./constants"),p=t("./attributes"),v=p.text,x=p.textposition,l=t("../../components/fx/helpers").appendArrayPointValue,b=g.TEXTPAD;function c(V){return V.id}function M(V){if(V.ids)return c}function _(V,H){return V<H?1:-1}function y(V,H,j,Z){var X=[],re=[],ue=Z?H:j,K=Z?j:H;return X[0]=ue.c2p(V.s0,!0),re[0]=K.c2p(V.p0,!0),X[1]=ue.c2p(V.s1,!0),re[1]=K.c2p(V.p1,!0),Z?[X,re]:[re,X]}function w(V,H,j,Z){if(!H.uniformtext.mode&&d(j)){var X;return Z&&(X=Z()),V.transition().duration(j.duration).ease(j.easing).each("end",function(){X&&X()}).each("interrupt",function(){X&&X()})}else return V}function d(V){return V&&V.duration>0}function C(V,H,j,Z,X,re){var ue=H.xaxis,K=H.yaxis,te=V._fullLayout;X||(X={mode:te.barmode,norm:te.barmode,gap:te.bargap,groupgap:te.bargroupgap},o("bar",te));var G=A.makeTraceGroups(Z,j,"trace bars").each(function(Y){var ee=h.select(this),ne=Y[0].trace,J=ne.type==="waterfall",q=ne.type==="funnel",ae=ne.type==="bar",le=ae||q,ie=0;J&&ne.connector.visible&&ne.connector.mode==="between"&&(ie=ne.connector.line.width/2);var se=ne.orientation==="h",xe=d(X),oe=A.ensureSingle(ee,"g","points"),he=M(ne),be=oe.selectAll("g.point").data(A.identity,he);be.enter().append("g").classed("point",!0),be.exit().remove(),be.each(function(_e,Se){var De=h.select(this),Ie=y(_e,ue,K,se),Te=Ie[0][0],Ce=Ie[0][1],He=Ie[1][0],Xe=Ie[1][1],Be=(se?Ce-Te:Xe-He)===0;Be&&le&&m.getLineWidth(ne,_e)&&(Be=!1),Be||(Be=!u(Te)||!u(Ce)||!u(He)||!u(Xe)),_e.isBlank=Be,Be&&(se?Ce=Te:Xe=He),ie&&!Be&&(se?(Te-=_(Te,Ce)*ie,Ce+=_(Te,Ce)*ie):(He-=_(He,Xe)*ie,Xe+=_(He,Xe)*ie));var Re,We;if(ne.type==="waterfall"){if(!Be){var vt=ne[_e.dir].marker;Re=vt.line.width,We=vt.color}}else Re=m.getLineWidth(ne,_e),We=_e.mc||ne.marker.color;function Pt(Ct){var Ze=h.round(Re/2%1,2);return X.gap===0&&X.groupgap===0?h.round(Math.round(Ct)-Ze,2):Ct}function Zt(Ct,Ze,nt){return nt&&Ct===Ze?Ct:Math.abs(Ct-Ze)>=2?Pt(Ct):Ct>Ze?Math.ceil(Ct):Math.floor(Ct)}if(!V._context.staticPlot){var zt=e.opacity(We),At=zt<1||Re>.01?Pt:Zt;Te=At(Te,Ce,se),Ce=At(Ce,Te,se),He=At(He,Xe,!se),Xe=At(Xe,He,!se)}var Wt=w(A.ensureSingle(De,"path"),te,X,re);if(Wt.style("vector-effect","non-scaling-stroke").attr("d",isNaN((Ce-Te)*(Xe-He))||Be&&V._context.staticPlot?"M0,0Z":"M"+Te+","+He+"V"+Xe+"H"+Ce+"V"+He+"Z").call(i.setClipUrl,H.layerClipId,V),!te.uniformtext.mode&&xe){var Bt=i.makePointStyleFns(ne);i.singlePointStyle(_e,Wt,ne,Bt,V)}S(V,H,De,Y,Se,Te,Ce,He,Xe,X,re),H.layerClipId&&i.hideOutsideRangePoint(_e,De.select("text"),ue,K,ne.xcalendar,ne.ycalendar)});var me=ne.cliponaxis===!1;i.setClipUrl(ee,me?null:H.layerClipId,V)});n.getComponentMethod("errorbars","plot")(V,G,H,X)}function S(V,H,j,Z,X,re,ue,K,te,G,Y){var ee=H.xaxis,ne=H.yaxis,J=V._fullLayout,q;function ae(Ze,nt,Ye){var Ee=A.ensureSingle(Ze,"text").text(nt).attr({class:"bartext bartext-"+q,"text-anchor":"middle","data-notex":1}).call(i.font,Ye).call(T.convertToTspans,V);return Ee}var le=Z[0].trace,ie=le.orientation==="h",se=F(J,Z,X,ee,ne);q=I(le,X);var xe=G.mode==="stack"||G.mode==="relative",oe=Z[X],he=!xe||oe._outmost;if(!se||q==="none"||(oe.isBlank||re===ue||K===te)&&(q==="auto"||q==="inside")){j.select("text").remove();return}var be=J.font,me=s.getBarColor(Z[X],le),_e=s.getInsideTextFont(le,X,be,me),Se=s.getOutsideTextFont(le,X,be),De=j.datum();ie?ee.type==="log"&&De.s0<=0&&(ee.range[0]<ee.range[1]?re=0:re=ee._length):ne.type==="log"&&De.s0<=0&&(ne.range[0]<ne.range[1]?K=ne._length:K=0);var Ie=Math.abs(ue-re)-2*b,Te=Math.abs(te-K)-2*b,Ce,He,Xe,Be,Re;if(q==="outside"&&!he&&!oe.hasB&&(q="inside"),q==="auto")if(he){q="inside",Re=A.ensureUniformFontSize(V,_e),Ce=ae(j,se,Re),He=i.bBox(Ce.node()),Xe=He.width,Be=He.height;var We=Xe>0&&Be>0,vt=Xe<=Ie&&Be<=Te,Pt=Xe<=Te&&Be<=Ie,Zt=ie?Ie>=Xe*(Te/Be):Te>=Be*(Ie/Xe);We&&(vt||Pt||Zt)?q="inside":(q="outside",Ce.remove(),Ce=null)}else q="inside";if(!Ce){Re=A.ensureUniformFontSize(V,q==="outside"?Se:_e),Ce=ae(j,se,Re);var zt=Ce.attr("transform");if(Ce.attr("transform",""),He=i.bBox(Ce.node()),Xe=He.width,Be=He.height,Ce.attr("transform",zt),Xe<=0||Be<=0){Ce.remove();return}}var At=le.textangle,Wt,Bt;q==="outside"?(Bt=le.constraintext==="both"||le.constraintext==="outside",Wt=z(re,ue,K,te,He,{isHorizontal:ie,constrained:Bt,angle:At})):(Bt=le.constraintext==="both"||le.constraintext==="inside",Wt=B(re,ue,K,te,He,{isHorizontal:ie,constrained:Bt,angle:At,anchor:le.insidetextanchor})),Wt.fontSize=Re.size,f(le.type==="histogram"?"bar":le.type,Wt,J),oe.transform=Wt;var Ct=w(Ce,J,G,Y);A.setTransormAndDisplay(Ct,Wt)}function E(V){return V==="auto"?0:V}function k(V,H){var j=Math.PI/180*H,Z=Math.abs(Math.sin(j)),X=Math.abs(Math.cos(j));return{x:V.width*X+V.height*Z,y:V.width*Z+V.height*X}}function B(V,H,j,Z,X,re){var ue=!!re.isHorizontal,K=!!re.constrained,te=re.angle||0,G=re.anchor||"end",Y=G==="end",ee=G==="start",ne=re.leftToRight||0,J=(ne+1)/2,q=1-J,ae=X.width,le=X.height,ie=Math.abs(H-V),se=Math.abs(Z-j),xe=ie>2*b&&se>2*b?b:0;ie-=2*xe,se-=2*xe;var oe=E(te);te==="auto"&&!(ae<=ie&&le<=se)&&(ae>ie||le>se)&&(!(ae>se||le>ie)||ae<le!=ie<se)&&(oe+=90);var he=k(X,oe),be=1;K&&(be=Math.min(1,ie/he.x,se/he.y));var me=X.left*q+X.right*J,_e=(X.top+X.bottom)/2,Se=(V+b)*q+(H-b)*J,De=(j+Z)/2,Ie=0,Te=0;if(ee||Y){var Ce=(ue?he.x:he.y)/2,He=ue?_(V,H):_(j,Z);ue?ee?(Se=V+He*xe,Ie=-He*Ce):(Se=H-He*xe,Ie=He*Ce):ee?(De=j+He*xe,Te=-He*Ce):(De=Z-He*xe,Te=He*Ce)}return{textX:me,textY:_e,targetX:Se,targetY:De,anchorX:Ie,anchorY:Te,scale:be,rotate:oe}}function z(V,H,j,Z,X,re){var ue=!!re.isHorizontal,K=!!re.constrained,te=re.angle||0,G=X.width,Y=X.height,ee=Math.abs(H-V),ne=Math.abs(Z-j),J;ue?J=ne>2*b?b:0:J=ee>2*b?b:0;var q=1;K&&(q=ue?Math.min(1,ne/Y):Math.min(1,ee/G));var ae=E(te),le=k(X,ae),ie=(ue?le.x:le.y)/2,se=(X.left+X.right)/2,xe=(X.top+X.bottom)/2,oe=(V+H)/2,he=(j+Z)/2,be=0,me=0,_e=ue?_(H,V):_(j,Z);return ue?(oe=H-_e*J,be=_e*ie):(he=Z+_e*J,me=-_e*ie),{textX:se,textY:xe,targetX:oe,targetY:he,anchorX:be,anchorY:me,scale:q,rotate:ae}}function F(V,H,j,Z,X){var re=H[0].trace,ue=re.texttemplate,K;return ue?K=O(V,H,j,Z,X):re.textinfo?K=N(H,j,Z,X):K=m.getValue(re.text,j),m.coerceString(v,K)}function I(V,H){var j=m.getValue(V.textposition,H);return m.coerceEnumerated(x,j)}function O(V,H,j,Z,X){var re=H[0].trace,ue=A.castOption(re,j,"texttemplate");if(!ue)return"";var K=re.type==="histogram",te=re.type==="waterfall",G=re.type==="funnel",Y=re.orientation==="h",ee,ne,J,q;Y?(ee="y",ne=X,J="x",q=Z):(ee="x",ne=Z,J="y",q=X);function ae(be){return a(ne,ne.c2l(be),!0).text}function le(be){return a(q,q.c2l(be),!0).text}var ie=H[j],se={};se.label=ie.p,se.labelLabel=se[ee+"Label"]=ae(ie.p);var xe=A.castOption(re,ie.i,"text");(xe===0||xe)&&(se.text=xe),se.value=ie.s,se.valueLabel=se[J+"Label"]=le(ie.s);var oe={};l(oe,re,ie.i),(K||oe.x===void 0)&&(oe.x=Y?se.value:se.label),(K||oe.y===void 0)&&(oe.y=Y?se.label:se.value),(K||oe.xLabel===void 0)&&(oe.xLabel=Y?se.valueLabel:se.labelLabel),(K||oe.yLabel===void 0)&&(oe.yLabel=Y?se.labelLabel:se.valueLabel),te&&(se.delta=+ie.rawS||ie.s,se.deltaLabel=le(se.delta),se.final=ie.v,se.finalLabel=le(se.final),se.initial=se.final-se.delta,se.initialLabel=le(se.initial)),G&&(se.value=ie.s,se.valueLabel=le(se.value),se.percentInitial=ie.begR,se.percentInitialLabel=A.formatPercent(ie.begR),se.percentPrevious=ie.difR,se.percentPreviousLabel=A.formatPercent(ie.difR),se.percentTotal=ie.sumR,se.percenTotalLabel=A.formatPercent(ie.sumR));var he=A.castOption(re,ie.i,"customdata");return he&&(se.customdata=he),A.texttemplateString(ue,se,V._d3locale,oe,se,re._meta||{})}function N(V,H,j,Z){var X=V[0].trace,re=X.orientation==="h",ue=X.type==="waterfall",K=X.type==="funnel";function te(he){var be=re?Z:j;return a(be,he,!0).text}function G(he){var be=re?j:Z;return a(be,+he,!0).text}var Y=X.textinfo,ee=V[H],ne=Y.split("+"),J=[],q,ae=function(he){return ne.indexOf(he)!==-1};if(ae("label")&&J.push(te(V[H].p)),ae("text")&&(q=A.castOption(X,ee.i,"text"),(q===0||q)&&J.push(q)),ue){var le=+ee.rawS||ee.s,ie=ee.v,se=ie-le;ae("initial")&&J.push(G(se)),ae("delta")&&J.push(G(le)),ae("final")&&J.push(G(ie))}if(K){ae("value")&&J.push(G(ee.s));var xe=0;ae("percent initial")&&xe++,ae("percent previous")&&xe++,ae("percent total")&&xe++;var oe=xe>1;ae("percent initial")&&(q=A.formatPercent(ee.begR),oe&&(q+=" of initial"),J.push(q)),ae("percent previous")&&(q=A.formatPercent(ee.difR),oe&&(q+=" of previous"),J.push(q)),ae("percent total")&&(q=A.formatPercent(ee.sumR),oe&&(q+=" of total"),J.push(q))}return J.join("<br>")}P.exports={plot:C,toMoveInsideBar:B}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx/helpers":403,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"./attributes":657,"./constants":659,"./helpers":663,"./style":671,"./uniform_text":673,"@plotly/d3":58,"fast-isnumeric":190}],669:[function(t,P,R){P.exports=function(A,T){var e=A.cd,i=A.xaxis,n=A.yaxis,a=e[0].trace,r=a.type==="funnel",f=a.orientation==="h",o=[],s;if(T===!1)for(s=0;s<e.length;s++)e[s].selected=0;else for(s=0;s<e.length;s++){var m=e[s],g="ct"in m?m.ct:h(m,i,n,f,r);T.contains(g,!1,s,A)?(o.push({pointNumber:s,x:i.c2d(m.x),y:n.c2d(m.y)}),m.selected=1):m.selected=0}return o};function h(u,A,T,e,i){var n=A.c2p(e?u.s0:u.p0,!0),a=A.c2p(e?u.s1:u.p1,!0),r=T.c2p(e?u.p0:u.s0,!0),f=T.c2p(e?u.p1:u.s1,!0);return i?[(n+a)/2,(r+f)/2]:e?[a,(r+f)/2]:[(n+a)/2,f]}},{}],670:[function(t,P,R){P.exports=A;var h=t("../../lib").distinctVals,u=t("../../constants/numerical").BADNUM;function A(T,e){this.traces=T,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var i=1/0,n=[],a=0;a<T.length;a++){for(var r=T[a],f=0;f<r.length;f++){var o=r[f];o.p!==u&&n.push(o.p)}r[0]&&r[0].width1&&(i=Math.min(r[0].width1,i))}this.positions=n;var s=h(n);this.distinctPositions=s.vals,s.vals.length===1&&i!==1/0?this.minDiff=i:this.minDiff=Math.min(s.minDiff,i);var m=(e.posAxis||{}).type;(m==="category"||m==="multicategory")&&(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}A.prototype.put=function(e,i){var n=this.getLabel(e,i),a=this.bins[n]||0;return this.bins[n]=a+i,a},A.prototype.get=function(e,i){var n=this.getLabel(e,i);return this.bins[n]||0},A.prototype.getLabel=function(e,i){var n=i<0&&this.sepNegVal?"v":"^",a=this.overlapNoMerge?e:Math.round(e/this.binWidth);return n+a}},{"../../constants/numerical":491,"../../lib":515}],671:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/color"),A=t("../../components/drawing"),T=t("../../lib"),e=t("../../registry"),i=t("./uniform_text").resizeText,n=t("./attributes"),a=n.textfont,r=n.insidetextfont,f=n.outsidetextfont,o=t("./helpers");function s(w){var d=h.select(w).selectAll("g.barlayer").selectAll("g.trace");i(w,d,"bar");var C=d.size(),S=w._fullLayout;d.style("opacity",function(E){return E[0].trace.opacity}).each(function(E){(S.barmode==="stack"&&C>1||S.bargap===0&&S.bargroupgap===0&&!E[0].trace.marker.line.width)&&h.select(this).attr("shape-rendering","crispEdges")}),d.selectAll("g.points").each(function(E){var k=h.select(this),B=E[0].trace;m(k,B,w)}),e.getComponentMethod("errorbars","style")(d)}function m(w,d,C){A.pointStyle(w.selectAll("path"),d,C),g(w,d,C)}function g(w,d,C){w.selectAll("text").each(function(S){var E=h.select(this),k=T.ensureUniformFontSize(C,l(E,S,d,C));A.font(E,k)})}function p(w,d,C){var S=d[0].trace;S.selectedpoints?v(C,S,w):(m(C,S,w),e.getComponentMethod("errorbars","style")(C))}function v(w,d,C){A.selectedPointStyle(w.selectAll("path"),d),x(w.selectAll("text"),d,C)}function x(w,d,C){w.each(function(S){var E=h.select(this),k;if(S.selected){k=T.ensureUniformFontSize(C,l(E,S,d,C));var B=d.selected.textfont&&d.selected.textfont.color;B&&(k.color=B),A.font(E,k)}else A.selectedTextStyle(E,d)})}function l(w,d,C,S){var E=S._fullLayout.font,k=C.textfont;if(w.classed("bartext-inside")){var B=y(d,C);k=c(C,d.i,E,B)}else w.classed("bartext-outside")&&(k=M(C,d.i,E));return k}function b(w,d,C){return _(a,w.textfont,d,C)}function c(w,d,C,S){var E=b(w,d,C),k=w._input.textfont===void 0||w._input.textfont.color===void 0||Array.isArray(w.textfont.color)&&w.textfont.color[d]===void 0;return k&&(E={color:u.contrast(S),family:E.family,size:E.size}),_(r,w.insidetextfont,d,E)}function M(w,d,C){var S=b(w,d,C);return _(f,w.outsidetextfont,d,S)}function _(w,d,C,S){d=d||{};var E=o.getValue(d.family,C),k=o.getValue(d.size,C),B=o.getValue(d.color,C);return{family:o.coerceString(w.family,E,S.family),size:o.coerceNumber(w.size,k,S.size),color:o.coerceColor(w.color,B,S.color)}}function y(w,d){return d.type==="waterfall"?d[w.dir].marker.color:w.mcc||w.mc||d.marker.color}P.exports={style:s,styleTextPoints:g,styleOnSelect:p,getInsideTextFont:c,getOutsideTextFont:M,getBarColor:y,resizeText:i}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../registry":647,"./attributes":657,"./helpers":663,"./uniform_text":673,"@plotly/d3":58}],672:[function(t,P,R){var h=t("../../components/color"),u=t("../../components/colorscale/helpers").hasColorscale,A=t("../../components/colorscale/defaults"),T=t("../../lib").coercePattern;P.exports=function(i,n,a,r,f){var o=a("marker.color",r),s=u(i,"marker");s&&A(i,n,f,a,{prefix:"marker.",cLetter:"c"}),a("marker.line.color",h.defaultLine),u(i,"marker.line")&&A(i,n,f,a,{prefix:"marker.line.",cLetter:"c"}),a("marker.line.width"),a("marker.opacity"),T(a,"marker.pattern",o,s),a("selected.marker.color"),a("unselected.marker.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],673:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib");function A(n,a,r){var f=n._fullLayout,o=f["_"+r+"Text_minsize"];if(o){var s=f.uniformtext.mode==="hide",m;switch(r){case"funnelarea":case"pie":case"sunburst":m="g.slice";break;case"treemap":case"icicle":m="g.slice, g.pathbar";break;default:m="g.points > g.point"}a.selectAll(m).each(function(g){var p=g.transform;if(p){p.scale=s&&p.hide?0:o/p.fontSize;var v=h.select(this).select("text");u.setTransormAndDisplay(v,p)}})}}function T(n,a,r){if(r.uniformtext.mode){var f=i(n),o=r.uniformtext.minsize,s=a.scale*a.fontSize;a.hide=s<o,r[f]=r[f]||1/0,a.hide||(r[f]=Math.min(r[f],Math.max(s,o)))}}function e(n,a){var r=i(n);a[r]=void 0}function i(n){return"_"+n+"Text_minsize"}P.exports={recordMinTextSize:T,clearMinTextSize:e,resizeText:A}},{"../../lib":515,"@plotly/d3":58}],674:[function(t,P,R){var h=t("../../plots/template_attributes").hovertemplateAttrs,u=t("../../lib/extend").extendFlat,A=t("../scatterpolar/attributes"),T=t("../bar/attributes");P.exports={r:A.r,theta:A.theta,r0:A.r0,dr:A.dr,theta0:A.theta0,dtheta:A.dtheta,thetaunit:A.thetaunit,base:u({},T.base,{}),offset:u({},T.offset,{}),width:u({},T.width,{}),text:u({},T.text,{}),hovertext:u({},T.hovertext,{}),marker:T.marker,hoverinfo:A.hoverinfo,hovertemplate:h(),selected:T.selected,unselected:T.unselected}},{"../../lib/extend":505,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatterpolar/attributes":1011}],675:[function(t,P,R){var h=t("../../components/colorscale/helpers").hasColorscale,u=t("../../components/colorscale/calc"),A=t("../bar/arrays_to_calcdata"),T=t("../bar/cross_trace_calc").setGroupPositions,e=t("../scatter/calc_selection"),i=t("../../registry").traceIs,n=t("../../lib").extendFlat;function a(f,o){for(var s=f._fullLayout,m=o.subplot,g=s[m].radialaxis,p=s[m].angularaxis,v=g.makeCalcdata(o,"r"),x=p.makeCalcdata(o,"theta"),l=o._length,b=new Array(l),c=v,M=x,_=0;_<l;_++)b[_]={p:M[_],s:c[_]};function y(w){var d=o[w];d!==void 0&&(o["_"+w]=Array.isArray(d)?p.makeCalcdata(o,w):p.d2c(d,o.thetaunit))}return p.type==="linear"&&(y("width"),y("offset")),h(o,"marker")&&u(f,o,{vals:o.marker.color,containerStr:"marker",cLetter:"c"}),h(o,"marker.line")&&u(f,o,{vals:o.marker.line.color,containerStr:"marker.line",cLetter:"c"}),A(b,o),e(b,o),b}function r(f,o,s){for(var m=f.calcdata,g=[],p=0;p<m.length;p++){var v=m[p],x=v[0].trace;x.visible===!0&&i(x,"bar")&&x.subplot===s&&g.push(v)}var l=n({},o.radialaxis,{_id:"x"}),b=o.angularaxis;T(f,b,l,g,{mode:o.barmode,norm:o.barnorm,gap:o.bargap,groupgap:o.bargroupgap})}P.exports={calc:a,crossTraceCalc:r}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../lib":515,"../../registry":647,"../bar/arrays_to_calcdata":656,"../bar/cross_trace_calc":660,"../scatter/calc_selection":938}],676:[function(t,P,R){var h=t("../../lib"),u=t("../scatterpolar/defaults").handleRThetaDefaults,A=t("../bar/style_defaults"),T=t("./attributes");P.exports=function(i,n,a,r){function f(s,m){return h.coerce(i,n,T,s,m)}var o=u(i,n,r,f);if(!o){n.visible=!1;return}f("thetaunit"),f("base"),f("offset"),f("width"),f("text"),f("hovertext"),f("hovertemplate"),A(i,n,f,a,r),h.coerceSelectionMarkerOpacity(n,f)}},{"../../lib":515,"../bar/style_defaults":672,"../scatterpolar/defaults":1013,"./attributes":674}],677:[function(t,P,R){var h=t("../../components/fx"),u=t("../../lib"),A=t("../bar/hover").getTraceColor,T=u.fillText,e=t("../scatterpolar/hover").makeHoverPointText,i=t("../../plots/polar/helpers").isPtInsidePolygon;P.exports=function(a,r,f){var o=a.cd,s=o[0].trace,m=a.subplot,g=m.radialAxis,p=m.angularAxis,v=m.vangles,x=v?i:u.isPtInsideSector,l=a.maxHoverDistance,b=p._period||2*Math.PI,c=Math.abs(g.g2p(Math.sqrt(r*r+f*f))),M=Math.atan2(f,r);g.range[0]>g.range[1]&&(M+=Math.PI);var _=function(C){return x(c,M,[C.rp0,C.rp1],[C.thetag0,C.thetag1],v)?l+Math.min(1,Math.abs(C.thetag1-C.thetag0)/b)-1+(C.rp1-c)/(C.rp1-C.rp0)-1:1/0};if(h.getClosest(o,_,a),a.index!==!1){var y=a.index,w=o[y];a.x0=a.x1=w.ct[0],a.y0=a.y1=w.ct[1];var d=u.extendFlat({},w,{r:w.s,theta:w.p});return T(w,s,a),e(d,s,m,a),a.hovertemplate=s.hovertemplate,a.color=A(s,w),a.xLabelVal=a.yLabelVal=void 0,w.s<0&&(a.idealAlign="left"),[a]}}},{"../../components/fx":407,"../../lib":515,"../../plots/polar/helpers":630,"../bar/hover":664,"../scatterpolar/hover":1015}],678:[function(t,P,R){P.exports={moduleType:"trace",name:"barpolar",basePlotModule:t("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:t("./attributes"),layoutAttributes:t("./layout_attributes"),supplyDefaults:t("./defaults"),supplyLayoutDefaults:t("./layout_defaults"),calc:t("./calc").calc,crossTraceCalc:t("./calc").crossTraceCalc,plot:t("./plot"),colorbar:t("../scatter/marker_colorbar"),formatLabels:t("../scatterpolar/format_labels"),style:t("../bar/style").style,styleOnSelect:t("../bar/style").styleOnSelect,hoverPoints:t("./hover"),selectPoints:t("../bar/select"),meta:{}}},{"../../plots/polar":631,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"../scatterpolar/format_labels":1014,"./attributes":674,"./calc":675,"./defaults":676,"./hover":677,"./layout_attributes":679,"./layout_defaults":680,"./plot":681}],679:[function(t,P,R){P.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],680:[function(t,P,R){var h=t("../../lib"),u=t("./layout_attributes");P.exports=function(A,T,e){var i={},n;function a(o,s){return h.coerce(A[n]||{},T[n],u,o,s)}for(var r=0;r<e.length;r++){var f=e[r];f.type==="barpolar"&&f.visible===!0&&(n=f.subplot,i[n]||(a("barmode"),a("bargap"),i[n]=1))}}},{"../../lib":515,"./layout_attributes":679}],681:[function(t,P,R){var h=t("@plotly/d3"),u=t("fast-isnumeric"),A=t("../../lib"),T=t("../../components/drawing"),e=t("../../plots/polar/helpers");P.exports=function(a,r,f){var o=r.xaxis,s=r.yaxis,m=r.radialAxis,g=r.angularAxis,p=i(r),v=r.layers.frontplot.select("g.barlayer");A.makeTraceGroups(v,f,"trace bars").each(function(){var x=h.select(this),l=A.ensureSingle(x,"g","points"),b=l.selectAll("g.point").data(A.identity);b.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),b.exit().remove(),b.each(function(c){var M=h.select(this),_=c.rp0=m.c2p(c.s0),y=c.rp1=m.c2p(c.s1),w=c.thetag0=g.c2g(c.p0),d=c.thetag1=g.c2g(c.p1),C;if(!u(_)||!u(y)||!u(w)||!u(d)||_===y||w===d)C="M0,0Z";else{var S=m.c2g(c.s1),E=(w+d)/2;c.ct=[o.c2p(S*Math.cos(E)),s.c2p(S*Math.sin(E))],C=p(_,y,w,d)}A.ensureSingle(M,"path").attr("d",C)}),T.setClipUrl(x,r._hasClipOnAxisFalse?r.clipIds.forTraces:null,a)})};function i(n){var a=n.cxx,r=n.cyy;return n.vangles?function(f,o,s,m){var g,p;A.angleDelta(s,m)>0?(g=s,p=m):(g=m,p=s);var v=e.findEnclosingVertexAngles(g,n.vangles)[0],x=e.findEnclosingVertexAngles(p,n.vangles)[1],l=[v,(g+p)/2,x];return e.pathPolygonAnnulus(f,o,g,p,l,a,r)}:function(f,o,s,m){return A.pathAnnulus(f,o,s,m,a,r)}}},{"../../components/drawing":389,"../../lib":515,"../../plots/polar/helpers":630,"@plotly/d3":58,"fast-isnumeric":190}],682:[function(t,P,R){var h=t("../scatter/attributes"),u=t("../bar/attributes"),A=t("../../components/color/attributes"),T=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=t("../../plots/template_attributes").hovertemplateAttrs,i=t("../../lib/extend").extendFlat,n=h.marker,a=n.line;P.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:h.xperiod,yperiod:h.yperiod,xperiod0:h.xperiod0,yperiod0:h.yperiod0,xperiodalignment:h.xperiodalignment,yperiodalignment:h.yperiodalignment,xhoverformat:T("x"),yhoverformat:T("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:i({},n.symbol,{arrayOk:!1,editType:"plot"}),opacity:i({},n.opacity,{arrayOk:!1,dflt:1,editType:"style"}),angle:i({},n.angle,{arrayOk:!1,editType:"calc"}),size:i({},n.size,{arrayOk:!1,editType:"calc"}),color:i({},n.color,{arrayOk:!1,editType:"style"}),line:{color:i({},a.color,{arrayOk:!1,dflt:A.defaultLine,editType:"style"}),width:i({},a.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:h.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:u.offsetgroup,alignmentgroup:u.alignmentgroup,selected:{marker:h.selected.marker,editType:"style"},unselected:{marker:h.unselected.marker,editType:"style"},text:i({},h.text,{}),hovertext:i({},h.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936}],683:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../plots/cartesian/axes"),A=t("../../plots/cartesian/align_period"),T=t("../../lib"),e=t("../../constants/numerical").BADNUM,i=T._;P.exports=function(M,_){var y=M._fullLayout,w=u.getFromId(M,_.xaxis||"x"),d=u.getFromId(M,_.yaxis||"y"),C=[],S=_.type==="violin"?"_numViolins":"_numBoxes",E,k,B,z,F,I,O;_.orientation==="h"?(B=w,z="x",F=d,I="y",O=!!_.yperiodalignment):(B=d,z="y",F=w,I="x",O=!!_.xperiodalignment);var N=n(_,I,F,y[S]),V=N[0],H=N[1],j=T.distinctVals(V,F),Z=j.vals,X=j.minDiff/2,re,ue,K,te,G,Y,ee=(_.boxpoints||_.points)==="all"?T.identity:function(zt){return zt.v<re.lf||zt.v>re.uf};if(_._hasPreCompStats){var ne=_[z],J=function(zt){return B.d2c((_[zt]||[])[E])},q=1/0,ae=-1/0;for(E=0;E<_._length;E++){var le=V[E];if(!!h(le)){if(re={},re.pos=re[I]=le,O&&H&&(re.orig_p=H[E]),re.q1=J("q1"),re.med=J("median"),re.q3=J("q3"),ue=[],ne&&T.isArrayOrTypedArray(ne[E]))for(k=0;k<ne[E].length;k++)Y=B.d2c(ne[E][k]),Y!==e&&(G={v:Y,i:[E,k]},o(G,_,[E,k]),ue.push(G));if(re.pts=ue.sort(m),K=re[z]=ue.map(g),te=K.length,re.med!==e&&re.q1!==e&&re.q3!==e&&re.med>=re.q1&&re.q3>=re.med){var ie=J("lowerfence");re.lf=ie!==e&&ie<=re.q1?ie:p(re,K,te);var se=J("upperfence");re.uf=se!==e&&se>=re.q3?se:v(re,K,te);var xe=J("mean");re.mean=xe!==e?xe:te?T.mean(K,te):(re.q1+re.q3)/2;var oe=J("sd");re.sd=xe!==e&&oe>=0?oe:te?T.stdev(K,te,re.mean):re.q3-re.q1,re.lo=x(re),re.uo=l(re);var he=J("notchspan");he=he!==e&&he>0?he:b(re,te),re.ln=re.med-he,re.un=re.med+he;var be=re.lf,me=re.uf;_.boxpoints&&K.length&&(be=Math.min(be,K[0]),me=Math.max(me,K[te-1])),_.notched&&(be=Math.min(be,re.ln),me=Math.max(me,re.un)),re.min=be,re.max=me}else{T.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+re.q1,"median = "+re.med,"q3 = "+re.q3].join(`
`));var _e;re.med!==e?_e=re.med:re.q1!==e?re.q3!==e?_e=(re.q1+re.q3)/2:_e=re.q1:re.q3!==e?_e=re.q3:_e=0,re.med=_e,re.q1=re.q3=_e,re.lf=re.uf=_e,re.mean=re.sd=_e,re.ln=re.un=_e,re.min=re.max=_e}q=Math.min(q,re.min),ae=Math.max(ae,re.max),re.pts2=ue.filter(ee),C.push(re)}}_._extremes[B._id]=u.findExtremes(B,[q,ae],{padded:!0})}else{var Se=B.makeCalcdata(_,z),De=a(Z,X),Ie=Z.length,Te=r(Ie);for(E=0;E<_._length;E++)if(Y=Se[E],!!h(Y)){var Ce=T.findBin(V[E],De);Ce>=0&&Ce<Ie&&(G={v:Y,i:E},o(G,_,E),Te[Ce].push(G))}var He=1/0,Xe=-1/0,Be=_.quartilemethod,Re=Be==="exclusive",We=Be==="inclusive";for(E=0;E<Ie;E++)if(Te[E].length>0){if(re={},re.pos=re[I]=Z[E],ue=re.pts=Te[E].sort(m),K=re[z]=ue.map(g),te=K.length,re.min=K[0],re.max=K[te-1],re.mean=T.mean(K,te),re.sd=T.stdev(K,te,re.mean),re.med=T.interp(K,.5),te%2&&(Re||We)){var vt,Pt;Re?(vt=K.slice(0,te/2),Pt=K.slice(te/2+1)):We&&(vt=K.slice(0,te/2+1),Pt=K.slice(te/2)),re.q1=T.interp(vt,.5),re.q3=T.interp(Pt,.5)}else re.q1=T.interp(K,.25),re.q3=T.interp(K,.75);re.lf=p(re,K,te),re.uf=v(re,K,te),re.lo=x(re),re.uo=l(re);var Zt=b(re,te);re.ln=re.med-Zt,re.un=re.med+Zt,He=Math.min(He,re.ln),Xe=Math.max(Xe,re.un),re.pts2=ue.filter(ee),C.push(re)}_._extremes[B._id]=u.findExtremes(B,_.notched?Se.concat([He,Xe]):Se,{padded:!0})}return s(C,_),C.length>0?(C[0].t={num:y[S],dPos:X,posLetter:I,valLetter:z,labels:{med:i(M,"median:"),min:i(M,"min:"),q1:i(M,"q1:"),q3:i(M,"q3:"),max:i(M,"max:"),mean:_.boxmean==="sd"?i(M,"mean \xB1 \u03C3:"):i(M,"mean:"),lf:i(M,"lower fence:"),uf:i(M,"upper fence:")}},y[S]++,C):[{t:{empty:!0}}]};function n(c,M,_,y){var w=M in c,d=M+"0"in c,C="d"+M in c;if(w||d&&C){var S=_.makeCalcdata(c,M),E=A(c,_,M,S).vals;return[E,S]}var k;d?k=c[M+"0"]:"name"in c&&(_.type==="category"||h(c.name)&&["linear","log"].indexOf(_.type)!==-1||T.isDateTime(c.name)&&_.type==="date")?k=c.name:k=y;for(var B=_.type==="multicategory"?_.r2c_just_indices(k):_.d2c(k,0,c[M+"calendar"]),z=c._length,F=new Array(z),I=0;I<z;I++)F[I]=B;return[F]}function a(c,M){for(var _=c.length,y=new Array(_+1),w=0;w<_;w++)y[w]=c[w]-M;return y[_]=c[_-1]+M,y}function r(c){for(var M=new Array(c),_=0;_<c;_++)M[_]=[];return M}var f={text:"tx",hovertext:"htx"};function o(c,M,_){for(var y in f)T.isArrayOrTypedArray(M[y])&&(Array.isArray(_)?T.isArrayOrTypedArray(M[y][_[0]])&&(c[f[y]]=M[y][_[0]][_[1]]):c[f[y]]=M[y][_])}function s(c,M){if(T.isArrayOrTypedArray(M.selectedpoints))for(var _=0;_<c.length;_++){for(var y=c[_].pts||[],w={},d=0;d<y.length;d++)w[y[d].i]=d;T.tagSelected(y,M,w)}}function m(c,M){return c.v-M.v}function g(c){return c.v}function p(c,M,_){return _===0?c.q1:Math.min(c.q1,M[Math.min(T.findBin(2.5*c.q1-1.5*c.q3,M,!0)+1,_-1)])}function v(c,M,_){return _===0?c.q3:Math.max(c.q3,M[Math.max(T.findBin(2.5*c.q3-1.5*c.q1,M),0)])}function x(c){return 4*c.q1-3*c.q3}function l(c){return 4*c.q3-3*c.q1}function b(c,M){return M===0?0:1.57*(c.q3-c.q1)/Math.sqrt(M)}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"fast-isnumeric":190}],684:[function(t,P,R){var h=t("../../plots/cartesian/axes"),u=t("../../lib"),A=t("../../plots/cartesian/constraints").getAxisGroup,T=["v","h"];function e(n,a){for(var r=n.calcdata,f=a.xaxis,o=a.yaxis,s=0;s<T.length;s++){for(var m=T[s],g=m==="h"?o:f,p=[],v=0;v<r.length;v++){var x=r[v],l=x[0].t,b=x[0].trace;b.visible===!0&&(b.type==="box"||b.type==="candlestick")&&!l.empty&&(b.orientation||"v")===m&&b.xaxis===f._id&&b.yaxis===o._id&&p.push(v)}i("box",n,p,g)}}function i(n,a,r,f){var o=a.calcdata,s=a._fullLayout,m=f._id,g=m.charAt(0),p,v,x,l=[],b=0;for(p=0;p<r.length;p++)for(x=o[r[p]],v=0;v<x.length;v++)l.push(f.c2l(x[v].pos,!0)),b+=(x[v].pts2||[]).length;if(!!l.length){var c=u.distinctVals(l);(f.type==="category"||f.type==="multicategory")&&(c.minDiff=1);var M=c.minDiff/2;h.minDtick(f,c.minDiff,c.vals[0],!0);var _=n==="violin"?"_numViolins":"_numBoxes",y=s[_],w=s[n+"mode"]==="group"&&y>1,d=1-s[n+"gap"],C=1-s[n+"groupgap"];for(p=0;p<r.length;p++){x=o[r[p]];var S=x[0].trace,E=x[0].t,k=S.width,B=S.side,z,F,I,O;if(k)z=F=O=k/2,I=0;else if(z=M,w){var N=A(s,f._id)+S.orientation,V=s._alignmentOpts[N]||{},H=V[S.alignmentgroup]||{},j=Object.keys(H.offsetGroups||{}).length,Z=j||y,X=j?S._offsetIndex:E.num;F=z*d*C/Z,I=2*z*(-.5+(X+.5)/Z)*d,O=z*d/Z}else F=z*d*C,I=0,O=z;E.dPos=z,E.bPos=I,E.bdPos=F,E.wHover=O;var re,ue,K=I+F,te,G,Y,ee,ne,J,q=Boolean(k),ae=(S.boxpoints||S.points)&&b>0;if(B==="positive"?(re=z*(k?1:.5),te=K,ue=te=I):B==="negative"?(re=te=I,ue=z*(k?1:.5),G=K):(re=ue=z,te=G=K),ae){var le=S.pointpos,ie=S.jitter,se=S.marker.size/2,xe=0;le+ie>=0&&(xe=K*(le+ie),xe>re?(q=!0,ne=se,Y=xe):xe>te&&(ne=se,Y=re)),xe<=re&&(Y=re);var oe=0;le-ie<=0&&(oe=-K*(le-ie),oe>ue?(q=!0,J=se,ee=oe):oe>G&&(J=se,ee=ue)),oe<=ue&&(ee=ue)}else Y=re,ee=ue;var he=new Array(x.length);for(v=0;v<x.length;v++)he[v]=x[v].pos;S._extremes[m]=h.findExtremes(f,he,{padded:q,vpadminus:ee,vpadplus:Y,vpadLinearized:!0,ppadminus:{x:J,y:ne}[g],ppadplus:{x:ne,y:J}[g]})}}}P.exports={crossTraceCalc:e,setPositionOffset:i}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574}],685:[function(t,P,R){var h=t("../../lib"),u=t("../../registry"),A=t("../../components/color"),T=t("../scatter/period_defaults"),e=t("../bar/defaults").handleGroupingDefaults,i=t("../../plots/cartesian/axis_autotype"),n=t("./attributes");function a(s,m,g,p){function v(w,d){return h.coerce(s,m,n,w,d)}if(r(s,m,v,p),m.visible!==!1){T(s,m,p,v),v("xhoverformat"),v("yhoverformat");var x=m._hasPreCompStats;x&&(v("lowerfence"),v("upperfence")),v("line.color",(s.marker||{}).color||g),v("line.width"),v("fillcolor",A.addOpacity(m.line.color,.5));var l=!1;if(x){var b=v("mean"),c=v("sd");b&&b.length&&(l=!0,c&&c.length&&(l="sd"))}v("boxmean",l),v("whiskerwidth"),v("width"),v("quartilemethod");var M=!1;if(x){var _=v("notchspan");_&&_.length&&(M=!0)}else h.validate(s.notchwidth,n.notchwidth)&&(M=!0);var y=v("notched",M);y&&v("notchwidth"),f(s,m,v,{prefix:"box"})}}function r(s,m,g,p){function v(j){var Z=0;return j&&j.length&&(Z+=1,h.isArrayOrTypedArray(j[0])&&j[0].length&&(Z+=1)),Z}function x(j){return h.validate(s[j],n[j])}var l=g("y"),b=g("x"),c;if(m.type==="box"){var M=g("q1"),_=g("median"),y=g("q3");m._hasPreCompStats=M&&M.length&&_&&_.length&&y&&y.length,c=Math.min(h.minRowLength(M),h.minRowLength(_),h.minRowLength(y))}var w=v(l),d=v(b),C=w&&h.minRowLength(l),S=d&&h.minRowLength(b),E=p.calendar,k={autotypenumbers:p.autotypenumbers},B,z;if(m._hasPreCompStats)switch(String(d)+String(w)){case"00":var F=x("x0")||x("dx"),I=x("y0")||x("dy");I&&!F?B="h":B="v",z=c;break;case"10":B="v",z=Math.min(c,S);break;case"20":B="h",z=Math.min(c,b.length);break;case"01":B="h",z=Math.min(c,C);break;case"02":B="v",z=Math.min(c,l.length);break;case"12":B="v",z=Math.min(c,S,l.length);break;case"21":B="h",z=Math.min(c,b.length,C);break;case"11":z=0;break;case"22":var O=!1,N;for(N=0;N<b.length;N++)if(i(b[N],E,k)==="category"){O=!0;break}if(O)B="v",z=Math.min(c,S,l.length);else{for(N=0;N<l.length;N++)if(i(l[N],E,k)==="category"){O=!0;break}O?(B="h",z=Math.min(c,b.length,C)):(B="v",z=Math.min(c,S,l.length))}break}else w>0?(B="v",d>0?z=Math.min(S,C):z=Math.min(C)):d>0?(B="h",z=Math.min(S)):z=0;if(!z){m.visible=!1;return}m._length=z;var V=g("orientation",B);m._hasPreCompStats?V==="v"&&d===0?(g("x0",0),g("dx",1)):V==="h"&&w===0&&(g("y0",0),g("dy",1)):V==="v"&&d===0?g("x0"):V==="h"&&w===0&&g("y0");var H=u.getComponentMethod("calendars","handleTraceDefaults");H(s,m,["x","y"],p)}function f(s,m,g,p){var v=p.prefix,x=h.coerce2(s,m,n,"marker.outliercolor"),l=g("marker.line.outliercolor"),b="outliers";m._hasPreCompStats?b="all":(x||l)&&(b="suspectedoutliers");var c=g(v+"points",b);c?(g("jitter",c==="all"?.3:0),g("pointpos",c==="all"?-1.5:0),g("marker.symbol"),g("marker.opacity"),g("marker.size"),g("marker.angle"),g("marker.color",m.line.color),g("marker.line.color"),g("marker.line.width"),c==="suspectedoutliers"&&(g("marker.line.outliercolor",m.marker.color),g("marker.line.outlierwidth")),g("selected.marker.color"),g("unselected.marker.color"),g("selected.marker.size"),g("unselected.marker.size"),g("text"),g("hovertext")):delete m.marker;var M=g("hoveron");(M==="all"||M.indexOf("points")!==-1)&&g("hovertemplate"),h.coerceSelectionMarkerOpacity(m,g)}function o(s,m){var g,p;function v(b){return h.coerce(p._input,p,n,b)}for(var x=0;x<s.length;x++){p=s[x];var l=p.type;(l==="box"||l==="violin")&&(g=p._input,m[l+"mode"]==="group"&&e(g,p,m,v))}}P.exports={supplyDefaults:a,crossTraceDefaults:o,handleSampleDefaults:r,handlePointsDefaults:f}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../registry":647,"../bar/defaults":661,"../scatter/period_defaults":956,"./attributes":682}],686:[function(t,P,R){P.exports=function(u,A){return A.hoverOnBox&&(u.hoverOnBox=A.hoverOnBox),"xVal"in A&&(u.x=A.xVal),"yVal"in A&&(u.y=A.yVal),A.xa&&(u.xaxis=A.xa),A.ya&&(u.yaxis=A.ya),u}},{}],687:[function(t,P,R){var h=t("../../plots/cartesian/axes"),u=t("../../lib"),A=t("../../components/fx"),T=t("../../components/color"),e=u.fillText;function i(r,f,o,s){var m=r.cd,g=m[0].trace,p=g.hoveron,v=[],x;return p.indexOf("boxes")!==-1&&(v=v.concat(n(r,f,o,s))),p.indexOf("points")!==-1&&(x=a(r,f,o)),s==="closest"?x?[x]:v:(x&&v.push(x),v)}function n(r,f,o,s){var m=r.cd,g=r.xa,p=r.ya,v=m[0].trace,x=m[0].t,l=v.type==="violin",b,c,M,_,y,w,d,C,S,E,k,B=x.bdPos,z,F,I=x.wHover,O=function(oe){return M.c2l(oe.pos)+x.bPos-M.c2l(w)};l&&v.side!=="both"?(v.side==="positive"&&(S=function(oe){var he=O(oe);return A.inbox(he,he+I,E)},z=B,F=0),v.side==="negative"&&(S=function(oe){var he=O(oe);return A.inbox(he-I,he,E)},z=0,F=B)):(S=function(oe){var he=O(oe);return A.inbox(he-I,he+I,E)},z=F=B);var N;l?N=function(oe){return A.inbox(oe.span[0]-y,oe.span[1]-y,E)}:N=function(oe){return A.inbox(oe.min-y,oe.max-y,E)},v.orientation==="h"?(y=f,w=o,d=N,C=S,b="y",M=p,c="x",_=g):(y=o,w=f,d=S,C=N,b="x",M=g,c="y",_=p);var V=Math.min(1,B/Math.abs(M.r2c(M.range[1])-M.r2c(M.range[0])));E=r.maxHoverDistance-V,k=r.maxSpikeDistance-V;function H(oe){return(d(oe)+C(oe))/2}var j=A.getDistanceFunction(s,d,C,H);if(A.getClosest(m,j,r),r.index===!1)return[];var Z=m[r.index],X=v.line.color,re=(v.marker||{}).color;T.opacity(X)&&v.line.width?r.color=X:T.opacity(re)&&v.boxpoints?r.color=re:r.color=v.fillcolor,r[b+"0"]=M.c2p(Z.pos+x.bPos-F,!0),r[b+"1"]=M.c2p(Z.pos+x.bPos+z,!0),r[b+"LabelVal"]=Z.orig_p!==void 0?Z.orig_p:Z.pos;var ue=b+"Spike";r.spikeDistance=H(Z)*k/E,r[ue]=M.c2p(Z.pos,!0);var K=v.boxmean||(v.meanline||{}).visible,te=v.boxpoints||v.points,G=te&&K?["max","uf","q3","med","mean","q1","lf","min"]:te&&!K?["max","uf","q3","med","q1","lf","min"]:!te&&K?["max","q3","med","mean","q1","min"]:["max","q3","med","q1","min"],Y=_.range[1]<_.range[0];v.orientation===(Y?"v":"h")&&G.reverse();for(var ee=r.spikeDistance,ne=r[ue],J=[],q=0;q<G.length;q++){var ae=G[q];if(ae in Z){var le=Z[ae],ie=_.c2p(le,!0),se=u.extendFlat({},r);se.attr=ae,se[c+"0"]=se[c+"1"]=ie,se[c+"LabelVal"]=le,se[c+"Label"]=(x.labels?x.labels[ae]+" ":"")+h.hoverLabelText(_,le,v[c+"hoverformat"]),se.hoverOnBox=!0,ae==="mean"&&"sd"in Z&&v.boxmean==="sd"&&(se[c+"err"]=Z.sd),se.hovertemplate=!1,J.push(se)}}r.name="",r.spikeDistance=void 0,r[ue]=void 0;for(var xe=0;xe<J.length;xe++)J[xe].attr!=="med"?(J[xe].name="",J[xe].spikeDistance=void 0,J[xe][ue]=void 0):(J[xe].spikeDistance=ee,J[xe][ue]=ne);return J}function a(r,f,o){for(var s=r.cd,m=r.xa,g=r.ya,p=s[0].trace,v=m.c2p(f),x=g.c2p(o),l,b=function(N){var V=Math.max(3,N.mrc||0);return Math.max(Math.abs(m.c2p(N.x)-v)-V,1-3/V)},c=function(N){var V=Math.max(3,N.mrc||0);return Math.max(Math.abs(g.c2p(N.y)-x)-V,1-3/V)},M=A.quadrature(b,c),_=!1,y,w,d=0;d<s.length;d++){y=s[d];for(var C=0;C<(y.pts||[]).length;C++){w=y.pts[C];var S=M(w);S<=r.distance&&(r.distance=S,_=[d,C])}}if(!_)return!1;y=s[_[0]],w=y.pts[_[1]];var E=m.c2p(w.x,!0),k=g.c2p(w.y,!0),B=w.mrc||1;l=u.extendFlat({},r,{index:w.i,color:(p.marker||{}).color,name:p.name,x0:E-B,x1:E+B,y0:k-B,y1:k+B,spikeDistance:r.distance,hovertemplate:p.hovertemplate});var z=y.orig_p,F=z!==void 0?z:y.pos,I;p.orientation==="h"?(I=g,l.xLabelVal=w.x,l.yLabelVal=F):(I=m,l.xLabelVal=F,l.yLabelVal=w.y);var O=I._id.charAt(0);return l[O+"Spike"]=I.c2p(y.pos,!0),e(w,p,l),l}P.exports={hoverPoints:i,hoverOnBoxes:n,hoverOnPoints:a}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],688:[function(t,P,R){P.exports={attributes:t("./attributes"),layoutAttributes:t("./layout_attributes"),supplyDefaults:t("./defaults").supplyDefaults,crossTraceDefaults:t("./defaults").crossTraceDefaults,supplyLayoutDefaults:t("./layout_defaults").supplyLayoutDefaults,calc:t("./calc"),crossTraceCalc:t("./cross_trace_calc").crossTraceCalc,plot:t("./plot").plot,style:t("./style").style,styleOnSelect:t("./style").styleOnSelect,hoverPoints:t("./hover").hoverPoints,eventData:t("./event_data"),selectPoints:t("./select"),moduleType:"trace",name:"box",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./attributes":682,"./calc":683,"./cross_trace_calc":684,"./defaults":685,"./event_data":686,"./hover":687,"./layout_attributes":689,"./layout_defaults":690,"./plot":691,"./select":692,"./style":693}],689:[function(t,P,R){P.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],690:[function(t,P,R){var h=t("../../registry"),u=t("../../lib"),A=t("./layout_attributes");function T(i,n,a,r,f){for(var o=f+"Layout",s=!1,m=0;m<a.length;m++){var g=a[m];if(h.traceIs(g,o)){s=!0;break}}!s||(r(f+"mode"),r(f+"gap"),r(f+"groupgap"))}function e(i,n,a){function r(f,o){return u.coerce(i,n,A,f,o)}T(i,n,a,r,"box")}P.exports={supplyLayoutDefaults:e,_supply:T}},{"../../lib":515,"../../registry":647,"./layout_attributes":689}],691:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=t("../../components/drawing"),T=5,e=.01;function i(f,o,s,m){var g=o.xaxis,p=o.yaxis;u.makeTraceGroups(m,s,"trace boxes").each(function(v){var x=h.select(this),l=v[0],b=l.t,c=l.trace;if(b.wdPos=b.bdPos*c.whiskerwidth,c.visible!==!0||b.empty){x.remove();return}var M,_;c.orientation==="h"?(M=p,_=g):(M=g,_=p),n(x,{pos:M,val:_},c,b),a(x,{x:g,y:p},c,b),r(x,{pos:M,val:_},c,b)})}function n(f,o,s,m){var g=s.orientation==="h",p=o.val,v=o.pos,x=!!v.rangebreaks,l=m.bPos,b=m.wdPos||0,c=m.bPosPxOffset||0,M=s.whiskerwidth||0,_=s.notched||!1,y=_?1-2*s.notchwidth:1,w,d;Array.isArray(m.bdPos)?(w=m.bdPos[0],d=m.bdPos[1]):(w=m.bdPos,d=m.bdPos);var C=f.selectAll("path.box").data(s.type!=="violin"||s.box.visible?u.identity:[]);C.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),C.exit().remove(),C.each(function(S){if(S.empty)return"M0,0Z";var E=v.c2l(S.pos+l,!0),k=v.l2p(E-w)+c,B=v.l2p(E+d)+c,z=x?(k+B)/2:v.l2p(E)+c,F=s.whiskerwidth,I=x?k*F+(1-F)*z:v.l2p(E-b)+c,O=x?B*F+(1-F)*z:v.l2p(E+b)+c,N=v.l2p(E-w*y)+c,V=v.l2p(E+d*y)+c,H=p.c2p(S.q1,!0),j=p.c2p(S.q3,!0),Z=u.constrain(p.c2p(S.med,!0),Math.min(H,j)+1,Math.max(H,j)-1),X=S.lf===void 0||s.boxpoints===!1,re=p.c2p(X?S.min:S.lf,!0),ue=p.c2p(X?S.max:S.uf,!0),K=p.c2p(S.ln,!0),te=p.c2p(S.un,!0);g?h.select(this).attr("d","M"+Z+","+N+"V"+V+"M"+H+","+k+"V"+B+(_?"H"+K+"L"+Z+","+V+"L"+te+","+B:"")+"H"+j+"V"+k+(_?"H"+te+"L"+Z+","+N+"L"+K+","+k:"")+"ZM"+H+","+z+"H"+re+"M"+j+","+z+"H"+ue+(M===0?"":"M"+re+","+I+"V"+O+"M"+ue+","+I+"V"+O)):h.select(this).attr("d","M"+N+","+Z+"H"+V+"M"+k+","+H+"H"+B+(_?"V"+K+"L"+V+","+Z+"L"+B+","+te:"")+"V"+j+"H"+k+(_?"V"+te+"L"+N+","+Z+"L"+k+","+K:"")+"ZM"+z+","+H+"V"+re+"M"+z+","+j+"V"+ue+(M===0?"":"M"+I+","+re+"H"+O+"M"+I+","+ue+"H"+O))})}function a(f,o,s,m){var g=o.x,p=o.y,v=m.bdPos,x=m.bPos,l=s.boxpoints||s.points;u.seedPseudoRandom();var b=function(_){return _.forEach(function(y){y.t=m,y.trace=s}),_},c=f.selectAll("g.points").data(l?b:[]);c.enter().append("g").attr("class","points"),c.exit().remove();var M=c.selectAll("path").data(function(_){var y,w=_.pts2,d=Math.max((_.max-_.min)/10,_.q3-_.q1),C=d*1e-9,S=d*e,E=[],k=0,B;if(s.jitter){if(d===0)for(k=1,E=new Array(w.length),y=0;y<w.length;y++)E[y]=1;else for(y=0;y<w.length;y++){var z=Math.max(0,y-T),F=w[z].v,I=Math.min(w.length-1,y+T),O=w[I].v;l!=="all"&&(w[y].v<_.lf?O=Math.min(O,_.lf):F=Math.max(F,_.uf));var N=Math.sqrt(S*(I-z)/(O-F+C))||0;N=u.constrain(Math.abs(N),0,1),E.push(N),k=Math.max(N,k)}B=s.jitter*2/(k||1)}for(y=0;y<w.length;y++){var V=w[y],H=V.v,j=s.jitter?B*E[y]*(u.pseudoRandom()-.5):0,Z=_.pos+x+v*(s.pointpos+j);s.orientation==="h"?(V.y=Z,V.x=H):(V.x=Z,V.y=H),l==="suspectedoutliers"&&H<_.uo&&H>_.lo&&(V.so=!0)}return w});M.enter().append("path").classed("point",!0),M.exit().remove(),M.call(A.translatePoints,g,p)}function r(f,o,s,m){var g=o.val,p=o.pos,v=!!p.rangebreaks,x=m.bPos,l=m.bPosPxOffset||0,b=s.boxmean||(s.meanline||{}).visible,c,M;Array.isArray(m.bdPos)?(c=m.bdPos[0],M=m.bdPos[1]):(c=m.bdPos,M=m.bdPos);var _=f.selectAll("path.mean").data(s.type==="box"&&s.boxmean||s.type==="violin"&&s.box.visible&&s.meanline.visible?u.identity:[]);_.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),_.exit().remove(),_.each(function(y){var w=p.c2l(y.pos+x,!0),d=p.l2p(w-c)+l,C=p.l2p(w+M)+l,S=v?(d+C)/2:p.l2p(w)+l,E=g.c2p(y.mean,!0),k=g.c2p(y.mean-y.sd,!0),B=g.c2p(y.mean+y.sd,!0);s.orientation==="h"?h.select(this).attr("d","M"+E+","+d+"V"+C+(b==="sd"?"m0,0L"+k+","+S+"L"+E+","+d+"L"+B+","+S+"Z":"")):h.select(this).attr("d","M"+d+","+E+"H"+C+(b==="sd"?"m0,0L"+S+","+k+"L"+d+","+E+"L"+S+","+B+"Z":""))})}P.exports={plot:i,plotBoxAndWhiskers:n,plotPoints:a,plotBoxMean:r}},{"../../components/drawing":389,"../../lib":515,"@plotly/d3":58}],692:[function(t,P,R){P.exports=function(u,A){var T=u.cd,e=u.xaxis,i=u.yaxis,n=[],a,r;if(A===!1)for(a=0;a<T.length;a++)for(r=0;r<(T[a].pts||[]).length;r++)T[a].pts[r].selected=0;else for(a=0;a<T.length;a++)for(r=0;r<(T[a].pts||[]).length;r++){var f=T[a].pts[r],o=e.c2p(f.x),s=i.c2p(f.y);A.contains([o,s],null,f.i,u)?(n.push({pointNumber:f.i,x:e.c2d(f.x),y:i.c2d(f.y)}),f.selected=1):f.selected=0}return n}},{}],693:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/color"),A=t("../../components/drawing");function T(i,n,a){var r=a||h.select(i).selectAll("g.trace.boxes");r.style("opacity",function(f){return f[0].trace.opacity}),r.each(function(f){var o=h.select(this),s=f[0].trace,m=s.line.width;function g(x,l,b,c){x.style("stroke-width",l+"px").call(u.stroke,b).call(u.fill,c)}var p=o.selectAll("path.box");if(s.type==="candlestick")p.each(function(x){if(!x.empty){var l=h.select(this),b=s[x.dir];g(l,b.line.width,b.line.color,b.fillcolor),l.style("opacity",s.selectedpoints&&!x.selected?.3:1)}});else{g(p,m,s.line.color,s.fillcolor),o.selectAll("path.mean").style({"stroke-width":m,"stroke-dasharray":2*m+"px,"+m+"px"}).call(u.stroke,s.line.color);var v=o.selectAll("path.point");A.pointStyle(v,s,i)}})}function e(i,n,a){var r=n[0].trace,f=a.selectAll("path.point");r.selectedpoints?A.selectedPointStyle(f,r):A.pointStyle(f,r,i)}P.exports={style:T,styleOnSelect:e}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],694:[function(t,P,R){var h=t("../../lib").extendFlat,u=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,A=t("../ohlc/attributes"),T=t("../box/attributes");function e(i){return{line:{color:h({},T.line.color,{dflt:i}),width:T.line.width,editType:"style"},fillcolor:T.fillcolor,editType:"style"}}P.exports={xperiod:A.xperiod,xperiod0:A.xperiod0,xperiodalignment:A.xperiodalignment,xhoverformat:u("x"),yhoverformat:u("y"),x:A.x,open:A.open,high:A.high,low:A.low,close:A.close,line:{width:h({},T.line.width,{}),editType:"style"},increasing:e(A.increasing.line.color.dflt),decreasing:e(A.decreasing.line.color.dflt),text:A.text,hovertext:A.hovertext,whiskerwidth:h({},T.whiskerwidth,{dflt:0}),hoverlabel:A.hoverlabel}},{"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682,"../ohlc/attributes":881}],695:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axes"),A=t("../../plots/cartesian/align_period"),T=t("../ohlc/calc").calcCommon;P.exports=function(i,n){var a=i._fullLayout,r=u.getFromId(i,n.xaxis),f=u.getFromId(i,n.yaxis),o=r.makeCalcdata(n,"x"),s=A(n,r,"x",o).vals,m=T(i,n,o,s,f,e);return m.length?(h.extendFlat(m[0].t,{num:a._numBoxes,dPos:h.distinctVals(s).minDiff/2,posLetter:"x",valLetter:"y"}),a._numBoxes++,m):[{t:{empty:!0}}]};function e(i,n,a,r){return{min:a,q1:Math.min(i,r),med:r,q3:Math.max(i,r),max:n}}},{"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../ohlc/calc":882}],696:[function(t,P,R){var h=t("../../lib"),u=t("../../components/color"),A=t("../ohlc/ohlc_defaults"),T=t("../scatter/period_defaults"),e=t("./attributes");P.exports=function(a,r,f,o){function s(g,p){return h.coerce(a,r,e,g,p)}var m=A(a,r,s,o);if(!m){r.visible=!1;return}T(a,r,o,s,{x:!0}),s("xhoverformat"),s("yhoverformat"),s("line.width"),i(a,r,s,"increasing"),i(a,r,s,"decreasing"),s("text"),s("hovertext"),s("whiskerwidth"),o._requestRangeslider[r.xaxis]=!0};function i(n,a,r,f){var o=r(f+".line.color");r(f+".line.width",a.line.width),r(f+".fillcolor",u.addOpacity(o,.5))}},{"../../components/color":367,"../../lib":515,"../ohlc/ohlc_defaults":886,"../scatter/period_defaults":956,"./attributes":694}],697:[function(t,P,R){P.exports={moduleType:"trace",name:"candlestick",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:t("./attributes"),layoutAttributes:t("../box/layout_attributes"),supplyLayoutDefaults:t("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:t("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:t("./defaults"),calc:t("./calc"),plot:t("../box/plot").plot,layerName:"boxlayer",style:t("../box/style").style,hoverPoints:t("../ohlc/hover").hoverPoints,selectPoints:t("../ohlc/select")}},{"../../plots/cartesian":578,"../box/cross_trace_calc":684,"../box/layout_attributes":689,"../box/layout_defaults":690,"../box/plot":691,"../box/style":693,"../ohlc/hover":884,"../ohlc/select":888,"./attributes":694,"./calc":695,"./defaults":696}],698:[function(t,P,R){var h=t("./axis_defaults"),u=t("../../plot_api/plot_template");P.exports=function(e,i,n,a,r){var f=a("a");f||(a("da"),a("a0"));var o=a("b");o||(a("db"),a("b0")),A(e,i,n,r)};function A(T,e,i,n){var a=["aaxis","baxis"];a.forEach(function(r){var f=r.charAt(0),o=T[r]||{},s=u.newContainer(e,r),m={noTicklabelstep:!0,tickfont:"x",id:f+"axis",letter:f,font:e.font,name:r,data:T[f],calendar:e.calendar,dfltColor:n,bgColor:i.paper_bgcolor,autotypenumbersDflt:i.autotypenumbers,fullLayout:i};h(o,s,m),s._categories=s._categories||[],!T[r]&&o.type!=="-"&&(T[r]={type:o.type})})}},{"../../plot_api/plot_template":555,"./axis_defaults":703}],699:[function(t,P,R){var h=t("../../lib").isArrayOrTypedArray;P.exports=function(A){return u(A,0)};function u(A,T){if(!h(A)||T>=10)return null;for(var e=1/0,i=-1/0,n=A.length,a=0;a<n;a++){var r=A[a];if(h(r)){var f=u(r,T+1);f&&(e=Math.min(f[0],e),i=Math.max(f[1],i))}else e=Math.min(r,e),i=Math.max(r,i)}return[e,i]}},{"../../lib":515}],700:[function(t,P,R){var h=t("../../plots/font_attributes"),u=t("./axis_attributes"),A=t("../../components/color/attributes"),T=h({editType:"calc"});T.family.dflt='"Open Sans", verdana, arial, sans-serif',T.size.dflt=12,T.color.dflt=A.defaultLine,P.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:u,baxis:u,font:T,color:{valType:"color",dflt:A.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":366,"../../plots/font_attributes":594,"./axis_attributes":702}],701:[function(t,P,R){var h=t("../../lib").isArrayOrTypedArray;P.exports=function(u,A,T,e){var i,n,a,r,f,o,s,m,g,p,v,x,l,b=h(T)?"a":"b",c=b==="a"?u.aaxis:u.baxis,M=c.smoothing,_=b==="a"?u.a2i:u.b2j,y=b==="a"?T:e,w=b==="a"?e:T,d=b==="a"?A.a.length:A.b.length,C=b==="a"?A.b.length:A.a.length,S=Math.floor(b==="a"?u.b2j(w):u.a2i(w)),E=b==="a"?function(X){return u.evalxy([],X,S)}:function(X){return u.evalxy([],S,X)};M&&(a=Math.max(0,Math.min(C-2,S)),r=S-a,n=b==="a"?function(X,re){return u.dxydi([],X,a,re,r)}:function(X,re){return u.dxydj([],a,X,r,re)});var k=_(y[0]),B=_(y[1]),z=k<B?1:-1,F=(B-k)*1e-8,I=z>0?Math.floor:Math.ceil,O=z>0?Math.ceil:Math.floor,N=z>0?Math.min:Math.max,V=z>0?Math.max:Math.min,H=I(k+F),j=O(B-F);s=E(k);var Z=[[s]];for(i=H;i*z<j*z;i+=z)f=[],v=V(k,i),x=N(B,i+z),l=x-v,o=Math.max(0,Math.min(d-2,Math.floor(.5*(v+x)))),m=E(x),M&&(g=n(o,v-o),p=n(o,x-o),f.push([s[0]+g[0]/3*l,s[1]+g[1]/3*l]),f.push([m[0]-p[0]/3*l,m[1]-p[1]/3*l])),f.push(m),Z.push(f),s=m;return Z}},{"../../lib":515}],702:[function(t,P,R){var h=t("../../plots/font_attributes"),u=t("../../components/color/attributes"),A=t("../../plots/cartesian/layout_attributes"),T=t("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=t("../../plot_api/edit_types").overrideAll,i=t("../../components/drawing/attributes").dash,n=t("../../lib/extend").extendFlat;P.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:h({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:A.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:h({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:T("tick label")},tickformatstops:e(A.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:u.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},griddash:n({},i,{editType:"calc"}),showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgriddash:n({},i,{editType:"calc"}),minorgridcolor:{valType:"color",dflt:u.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:h({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],703:[function(t,P,R){var h=t("./attributes"),u=t("../../components/color").addOpacity,A=t("../../registry"),T=t("../../lib"),e=t("../../plots/cartesian/tick_value_defaults"),i=t("../../plots/cartesian/tick_label_defaults"),n=t("../../plots/cartesian/prefix_suffix_defaults"),a=t("../../plots/cartesian/category_order_defaults"),r=t("../../plots/cartesian/set_convert"),f=t("../../plots/cartesian/axis_autotype");P.exports=function(m,g,p){var v=p.letter,x=p.font||{},l=h[v+"axis"];function b(H,j){return T.coerce(m,g,l,H,j)}function c(H,j){return T.coerce2(m,g,l,H,j)}p.name&&(g._name=p.name,g._id=p.name),b("autotypenumbers",p.autotypenumbersDflt);var M=b("type");if(M==="-"&&(p.data&&o(g,p.data),g.type==="-"?g.type="linear":M=m.type=g.type),b("smoothing"),b("cheatertype"),b("showticklabels"),b("labelprefix",v+" = "),b("labelsuffix"),b("showtickprefix"),b("showticksuffix"),b("separatethousands"),b("tickformat"),b("exponentformat"),b("minexponent"),b("showexponent"),b("categoryorder"),b("tickmode"),b("tickvals"),b("ticktext"),b("tick0"),b("dtick"),g.tickmode==="array"&&(b("arraytick0"),b("arraydtick")),b("labelpadding"),g._hovertitle=v,M==="date"){var _=A.getComponentMethod("calendars","handleDefaults");_(m,g,"calendar",p.calendar)}r(g,p.fullLayout),g.c2p=T.identity;var y=b("color",p.dfltColor),w=y===m.color?y:x.color,d=b("title.text");d&&(T.coerceFont(b,"title.font",{family:x.family,size:T.bigFont(x.size),color:w}),b("title.offset")),b("tickangle");var C=b("autorange",!g.isValidRange(m.range));C&&b("rangemode"),b("range"),g.cleanRange(),b("fixedrange"),e(m,g,b,M),n(m,g,b,M,p),i(m,g,b,M,p),a(m,g,b,{data:p.data,dataAttr:v});var S=c("gridcolor",u(y,.3)),E=c("gridwidth"),k=c("griddash"),B=b("showgrid");B||(delete g.gridcolor,delete g.gridwidth,delete g.griddash);var z=c("startlinecolor",y),F=c("startlinewidth",E),I=b("startline",g.showgrid||!!z||!!F);I||(delete g.startlinecolor,delete g.startlinewidth);var O=c("endlinecolor",y),N=c("endlinewidth",E),V=b("endline",g.showgrid||!!O||!!N);return V||(delete g.endlinecolor,delete g.endlinewidth),B?(b("minorgridcount"),b("minorgridwidth",E),b("minorgriddash",k),b("minorgridcolor",u(S,.06)),g.minorgridcount||(delete g.minorgridwidth,delete g.minorgriddash,delete g.minorgridcolor)):(delete g.gridcolor,delete g.gridwidth,delete g.griddash),g.showticklabels==="none"&&(delete g.tickfont,delete g.tickangle,delete g.showexponent,delete g.exponentformat,delete g.minexponent,delete g.tickformat,delete g.showticksuffix,delete g.showtickprefix),g.showticksuffix||delete g.ticksuffix,g.showtickprefix||delete g.tickprefix,b("tickmode"),g};function o(s,m){if(s.type==="-"){var g=s._id,p=g.charAt(0),v=p+"calendar",x=s[v];s.type=f(m,x,{autotypenumbers:s.autotypenumbers})}}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../plots/cartesian/category_order_defaults":571,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/set_convert":585,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_value_defaults":589,"../../registry":647,"./attributes":700}],704:[function(t,P,R){var h=t("../../plots/cartesian/axes"),u=t("../../lib").isArray1D,A=t("./cheater_basis"),T=t("./array_minmax"),e=t("./calc_gridlines"),i=t("./calc_labels"),n=t("./calc_clippath"),a=t("../heatmap/clean_2d_array"),r=t("./smooth_fill_2d_array"),f=t("../heatmap/convert_column_xyz"),o=t("./set_convert");P.exports=function(m,g){var p=h.getFromId(m,g.xaxis),v=h.getFromId(m,g.yaxis),x=g.aaxis,l=g.baxis,b=g.x,c=g.y,M=[];b&&u(b)&&M.push("x"),c&&u(c)&&M.push("y"),M.length&&f(g,x,l,"a","b",M);var _=g._a=g._a||g.a,y=g._b=g._b||g.b;b=g._x||g.x,c=g._y||g.y;var w={};if(g._cheater){var d=x.cheatertype==="index"?_.length:_,C=l.cheatertype==="index"?y.length:y;b=A(d,C,g.cheaterslope)}g._x=b=a(b),g._y=c=a(c),r(b,_,y),r(c,_,y),o(g),g.setScale();var S=T(b),E=T(c),k=.5*(S[1]-S[0]),B=.5*(S[1]+S[0]),z=.5*(E[1]-E[0]),F=.5*(E[1]+E[0]),I=1.3;return S=[B-k*I,B+k*I],E=[F-z*I,F+z*I],g._extremes[p._id]=h.findExtremes(p,S,{padded:!0}),g._extremes[v._id]=h.findExtremes(v,E,{padded:!0}),e(g,"a","b"),e(g,"b","a"),i(g,x),i(g,l),w.clipsegments=n(g._xctrl,g._yctrl,x,l),w.x=b,w.y=c,w.a=_,w.b=y,[w]}},{"../../lib":515,"../../plots/cartesian/axes":566,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"./array_minmax":699,"./calc_clippath":705,"./calc_gridlines":706,"./calc_labels":707,"./cheater_basis":709,"./set_convert":722,"./smooth_fill_2d_array":723}],705:[function(t,P,R){P.exports=function(u,A,T,e){var i,n,a,r=[],f=!!T.smoothing,o=!!e.smoothing,s=u[0].length-1,m=u.length-1;for(i=0,n=[],a=[];i<=s;i++)n[i]=u[0][i],a[i]=A[0][i];for(r.push({x:n,y:a,bicubic:f}),i=0,n=[],a=[];i<=m;i++)n[i]=u[i][s],a[i]=A[i][s];for(r.push({x:n,y:a,bicubic:o}),i=s,n=[],a=[];i>=0;i--)n[s-i]=u[m][i],a[s-i]=A[m][i];for(r.push({x:n,y:a,bicubic:f}),i=m,n=[],a=[];i>=0;i--)n[m-i]=u[i][0],a[m-i]=A[i][0];return r.push({x:n,y:a,bicubic:o}),r}},{}],706:[function(t,P,R){var h=t("../../plots/cartesian/axes"),u=t("../../lib/extend").extendFlat;P.exports=function(T,e,i){var n,a,r,f,o,s,m,g,p,v,x,l,b,c,M=T["_"+e],_=T[e+"axis"],y=_._gridlines=[],w=_._minorgridlines=[],d=_._boundarylines=[],C=T["_"+i],S=T[i+"axis"];_.tickmode==="array"&&(_.tickvals=M.slice());var E=T._xctrl,k=T._yctrl,B=E[0].length,z=E.length,F=T._a.length,I=T._b.length;h.prepTicks(_),_.tickmode==="array"&&delete _.tickvals;var O=_.smoothing?3:1;function N(H){var j,Z,X,re,ue,K,te,G,Y,ee,ne,J,q=[],ae=[],le={};if(e==="b")for(Z=T.b2j(H),X=Math.floor(Math.max(0,Math.min(I-2,Z))),re=Z-X,le.length=I,le.crossLength=F,le.xy=function(ie){return T.evalxy([],ie,Z)},le.dxy=function(ie,se){return T.dxydi([],ie,X,se,re)},j=0;j<F;j++)K=Math.min(F-2,j),te=j-K,G=T.evalxy([],j,Z),S.smoothing&&j>0&&(Y=T.dxydi([],j-1,X,0,re),q.push(ue[0]+Y[0]/3),ae.push(ue[1]+Y[1]/3),ee=T.dxydi([],j-1,X,1,re),q.push(G[0]-ee[0]/3),ae.push(G[1]-ee[1]/3)),q.push(G[0]),ae.push(G[1]),ue=G;else for(j=T.a2i(H),K=Math.floor(Math.max(0,Math.min(F-2,j))),te=j-K,le.length=F,le.crossLength=I,le.xy=function(ie){return T.evalxy([],j,ie)},le.dxy=function(ie,se){return T.dxydj([],K,ie,te,se)},Z=0;Z<I;Z++)X=Math.min(I-2,Z),re=Z-X,G=T.evalxy([],j,Z),S.smoothing&&Z>0&&(ne=T.dxydj([],K,Z-1,te,0),q.push(ue[0]+ne[0]/3),ae.push(ue[1]+ne[1]/3),J=T.dxydj([],K,Z-1,te,1),q.push(G[0]-J[0]/3),ae.push(G[1]-J[1]/3)),q.push(G[0]),ae.push(G[1]),ue=G;return le.axisLetter=e,le.axis=_,le.crossAxis=S,le.value=H,le.constvar=i,le.index=g,le.x=q,le.y=ae,le.smoothing=S.smoothing,le}function V(H){var j,Z,X,re,ue,K=[],te=[],G={};if(G.length=M.length,G.crossLength=C.length,e==="b")for(X=Math.max(0,Math.min(I-2,H)),ue=Math.min(1,Math.max(0,H-X)),G.xy=function(Y){return T.evalxy([],Y,H)},G.dxy=function(Y,ee){return T.dxydi([],Y,X,ee,ue)},j=0;j<B;j++)K[j]=E[H*O][j],te[j]=k[H*O][j];else for(Z=Math.max(0,Math.min(F-2,H)),re=Math.min(1,Math.max(0,H-Z)),G.xy=function(Y){return T.evalxy([],H,Y)},G.dxy=function(Y,ee){return T.dxydj([],Z,Y,re,ee)},j=0;j<z;j++)K[j]=E[j][H*O],te[j]=k[j][H*O];return G.axisLetter=e,G.axis=_,G.crossAxis=S,G.value=M[H],G.constvar=i,G.index=H,G.x=K,G.y=te,G.smoothing=S.smoothing,G}if(_.tickmode==="array"){for(f=5e-15,o=[Math.floor((M.length-1-_.arraytick0)/_.arraydtick*(1+f)),Math.ceil(-_.arraytick0/_.arraydtick/(1+f))].sort(function(H,j){return H-j}),s=o[0]-1,m=o[1]+1,g=s;g<m;g++)a=_.arraytick0+_.arraydtick*g,!(a<0||a>M.length-1)&&y.push(u(V(a),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(g=s;g<m;g++)if(r=_.arraytick0+_.arraydtick*g,x=Math.min(r+_.arraydtick,M.length-1),!(r<0||r>M.length-1)&&!(x<0||x>M.length-1))for(l=M[r],b=M[x],n=0;n<_.minorgridcount;n++)c=x-r,!(c<=0)&&(v=l+(b-l)*(n+1)/(_.minorgridcount+1)*(_.arraydtick/c),!(v<M[0]||v>M[M.length-1])&&w.push(u(N(v),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash})));_.startline&&d.push(u(V(0),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&d.push(u(V(M.length-1),{color:_.endlinecolor,width:_.endlinewidth}))}else{for(f=5e-15,o=[Math.floor((M[M.length-1]-_.tick0)/_.dtick*(1+f)),Math.ceil((M[0]-_.tick0)/_.dtick/(1+f))].sort(function(H,j){return H-j}),s=o[0],m=o[1],g=s;g<=m;g++)p=_.tick0+_.dtick*g,y.push(u(N(p),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(g=s-1;g<m+1;g++)for(p=_.tick0+_.dtick*g,n=0;n<_.minorgridcount;n++)v=p+_.dtick*(n+1)/(_.minorgridcount+1),!(v<M[0]||v>M[M.length-1])&&w.push(u(N(v),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash}));_.startline&&d.push(u(N(M[0]),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&d.push(u(N(M[M.length-1]),{color:_.endlinecolor,width:_.endlinewidth}))}}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],707:[function(t,P,R){var h=t("../../plots/cartesian/axes"),u=t("../../lib/extend").extendFlat;P.exports=function(T,e){var i,n,a,r,f,o=e._labels=[],s=e._gridlines;for(i=0;i<s.length;i++)f=s[i],["start","both"].indexOf(e.showticklabels)!==-1&&(n=h.tickText(e,f.value),u(n,{prefix:a,suffix:r,endAnchor:!0,xy:f.xy(0),dxy:f.dxy(0,0),axis:f.axis,length:f.crossAxis.length,font:f.axis.tickfont,isFirst:i===0,isLast:i===s.length-1}),o.push(n)),["end","both"].indexOf(e.showticklabels)!==-1&&(n=h.tickText(e,f.value),u(n,{endAnchor:!1,xy:f.xy(f.crossLength-1),dxy:f.dxy(f.crossLength-2,1),axis:f.axis,length:f.crossAxis.length,font:f.axis.tickfont,isFirst:i===0,isLast:i===s.length-1}),o.push(n))}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],708:[function(t,P,R){var h=.5;P.exports=function(A,T,e,i){var n=A[0]-T[0],a=A[1]-T[1],r=e[0]-T[0],f=e[1]-T[1],o=Math.pow(n*n+a*a,h/2),s=Math.pow(r*r+f*f,h/2),m=(s*s*n-o*o*r)*i,g=(s*s*a-o*o*f)*i,p=s*(o+s)*3,v=o*(o+s)*3;return[[T[0]+(p&&m/p),T[1]+(p&&g/p)],[T[0]-(v&&m/v),T[1]-(v&&g/v)]]}},{}],709:[function(t,P,R){var h=t("../../lib").isArrayOrTypedArray;P.exports=function(u,A,T){var e,i,n,a,r,f,o=[],s=h(u)?u.length:u,m=h(A)?A.length:A,g=h(u)?u:null,p=h(A)?A:null;g&&(n=(g.length-1)/(g[g.length-1]-g[0])/(s-1)),p&&(a=(p.length-1)/(p[p.length-1]-p[0])/(m-1));var v,x=1/0,l=-1/0;for(i=0;i<m;i++)for(o[i]=[],f=p?(p[i]-p[0])*a:i/(m-1),e=0;e<s;e++)r=g?(g[e]-g[0])*n:e/(s-1),v=r-f*T,x=Math.min(v,x),l=Math.max(v,l),o[i][e]=v;var b=1/(l-x),c=-x*b;for(i=0;i<m;i++)for(e=0;e<s;e++)o[i][e]=b*o[i][e]+c;return o}},{"../../lib":515}],710:[function(t,P,R){var h=t("./catmull_rom"),u=t("../../lib").ensureArray;function A(T,e,i){var n=-.5*i[0]+1.5*e[0],a=-.5*i[1]+1.5*e[1];return[(2*n+T[0])/3,(2*a+T[1])/3]}P.exports=function(e,i,n,a,r,f){var o,s,m,g,p,v,x,l,b,c,M=n[0].length,_=n.length,y=r?3*M-2:M,w=f?3*_-2:_;for(e=u(e,w),i=u(i,w),m=0;m<w;m++)e[m]=u(e[m],y),i[m]=u(i[m],y);for(s=0,g=0;s<_;s++,g+=f?3:1)for(p=e[g],v=i[g],x=n[s],l=a[s],o=0,m=0;o<M;o++,m+=r?3:1)p[m]=x[o],v[m]=l[o];if(r)for(s=0,g=0;s<_;s++,g+=f?3:1){for(o=1,m=3;o<M-1;o++,m+=3)b=h([n[s][o-1],a[s][o-1]],[n[s][o],a[s][o]],[n[s][o+1],a[s][o+1]],r),e[g][m-1]=b[0][0],i[g][m-1]=b[0][1],e[g][m+1]=b[1][0],i[g][m+1]=b[1][1];c=A([e[g][0],i[g][0]],[e[g][2],i[g][2]],[e[g][3],i[g][3]]),e[g][1]=c[0],i[g][1]=c[1],c=A([e[g][y-1],i[g][y-1]],[e[g][y-3],i[g][y-3]],[e[g][y-4],i[g][y-4]]),e[g][y-2]=c[0],i[g][y-2]=c[1]}if(f)for(m=0;m<y;m++){for(g=3;g<w-3;g+=3)b=h([e[g-3][m],i[g-3][m]],[e[g][m],i[g][m]],[e[g+3][m],i[g+3][m]],f),e[g-1][m]=b[0][0],i[g-1][m]=b[0][1],e[g+1][m]=b[1][0],i[g+1][m]=b[1][1];c=A([e[0][m],i[0][m]],[e[2][m],i[2][m]],[e[3][m],i[3][m]]),e[1][m]=c[0],i[1][m]=c[1],c=A([e[w-1][m],i[w-1][m]],[e[w-3][m],i[w-3][m]],[e[w-4][m],i[w-4][m]]),e[w-2][m]=c[0],i[w-2][m]=c[1]}if(r&&f)for(g=1;g<w;g+=(g+1)%3===0?2:1){for(m=3;m<y-3;m+=3)b=h([e[g][m-3],i[g][m-3]],[e[g][m],i[g][m]],[e[g][m+3],i[g][m+3]],r),e[g][m-1]=.5*(e[g][m-1]+b[0][0]),i[g][m-1]=.5*(i[g][m-1]+b[0][1]),e[g][m+1]=.5*(e[g][m+1]+b[1][0]),i[g][m+1]=.5*(i[g][m+1]+b[1][1]);c=A([e[g][0],i[g][0]],[e[g][2],i[g][2]],[e[g][3],i[g][3]]),e[g][1]=.5*(e[g][1]+c[0]),i[g][1]=.5*(i[g][1]+c[1]),c=A([e[g][y-1],i[g][y-1]],[e[g][y-3],i[g][y-3]],[e[g][y-4],i[g][y-4]]),e[g][y-2]=.5*(e[g][y-2]+c[0]),i[g][y-2]=.5*(i[g][y-2]+c[1])}return[e,i]}},{"../../lib":515,"./catmull_rom":708}],711:[function(t,P,R){P.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],712:[function(t,P,R){P.exports=function(h,u,A){return u&&A?function(T,e,i,n,a){T||(T=[]);var r,f,o,s,m,g;e*=3,i*=3;var p=n*n,v=1-n,x=v*v,l=v*n*2,b=-3*x,c=3*(x-l),M=3*(l-p),_=3*p,y=a*a,w=y*a,d=1-a,C=d*d,S=C*d;for(g=0;g<h.length;g++)m=h[g],r=b*m[i][e]+c*m[i][e+1]+M*m[i][e+2]+_*m[i][e+3],f=b*m[i+1][e]+c*m[i+1][e+1]+M*m[i+1][e+2]+_*m[i+1][e+3],o=b*m[i+2][e]+c*m[i+2][e+1]+M*m[i+2][e+2]+_*m[i+2][e+3],s=b*m[i+3][e]+c*m[i+3][e+1]+M*m[i+3][e+2]+_*m[i+3][e+3],T[g]=S*r+3*(C*a*f+d*y*o)+w*s;return T}:u?function(T,e,i,n,a){T||(T=[]);var r,f,o,s;e*=3;var m=n*n,g=1-n,p=g*g,v=g*n*2,x=-3*p,l=3*(p-v),b=3*(v-m),c=3*m,M=1-a;for(o=0;o<h.length;o++)s=h[o],r=x*s[i][e]+l*s[i][e+1]+b*s[i][e+2]+c*s[i][e+3],f=x*s[i+1][e]+l*s[i+1][e+1]+b*s[i+1][e+2]+c*s[i+1][e+3],T[o]=M*r+a*f;return T}:A?function(T,e,i,n,a){T||(T=[]);var r,f,o,s,m,g;i*=3;var p=a*a,v=p*a,x=1-a,l=x*x,b=l*x;for(m=0;m<h.length;m++)g=h[m],r=g[i][e+1]-g[i][e],f=g[i+1][e+1]-g[i+1][e],o=g[i+2][e+1]-g[i+2][e],s=g[i+3][e+1]-g[i+3][e],T[m]=b*r+3*(l*a*f+x*p*o)+v*s;return T}:function(T,e,i,n,a){T||(T=[]);var r,f,o,s,m=1-a;for(o=0;o<h.length;o++)s=h[o],r=s[i][e+1]-s[i][e],f=s[i+1][e+1]-s[i+1][e],T[o]=m*r+a*f;return T}}},{}],713:[function(t,P,R){P.exports=function(h,u,A){return u&&A?function(T,e,i,n,a){T||(T=[]);var r,f,o,s,m,g;e*=3,i*=3;var p=n*n,v=p*n,x=1-n,l=x*x,b=l*x,c=a*a,M=1-a,_=M*M,y=M*a*2,w=-3*_,d=3*(_-y),C=3*(y-c),S=3*c;for(g=0;g<h.length;g++)m=h[g],r=w*m[i][e]+d*m[i+1][e]+C*m[i+2][e]+S*m[i+3][e],f=w*m[i][e+1]+d*m[i+1][e+1]+C*m[i+2][e+1]+S*m[i+3][e+1],o=w*m[i][e+2]+d*m[i+1][e+2]+C*m[i+2][e+2]+S*m[i+3][e+2],s=w*m[i][e+3]+d*m[i+1][e+3]+C*m[i+2][e+3]+S*m[i+3][e+3],T[g]=b*r+3*(l*n*f+x*p*o)+v*s;return T}:u?function(T,e,i,n,a){T||(T=[]);var r,f,o,s,m,g;e*=3;var p=a*a,v=p*a,x=1-a,l=x*x,b=l*x;for(m=0;m<h.length;m++)g=h[m],r=g[i+1][e]-g[i][e],f=g[i+1][e+1]-g[i][e+1],o=g[i+1][e+2]-g[i][e+2],s=g[i+1][e+3]-g[i][e+3],T[m]=b*r+3*(l*a*f+x*p*o)+v*s;return T}:A?function(T,e,i,n,a){T||(T=[]);var r,f,o,s;i*=3;var m=1-n,g=a*a,p=1-a,v=p*p,x=p*a*2,l=-3*v,b=3*(v-x),c=3*(x-g),M=3*g;for(o=0;o<h.length;o++)s=h[o],r=l*s[i][e]+b*s[i+1][e]+c*s[i+2][e]+M*s[i+3][e],f=l*s[i][e+1]+b*s[i+1][e+1]+c*s[i+2][e+1]+M*s[i+3][e+1],T[o]=m*r+n*f;return T}:function(T,e,i,n,a){T||(T=[]);var r,f,o,s,m=1-n;for(o=0;o<h.length;o++)s=h[o],r=s[i+1][e]-s[i][e],f=s[i+1][e+1]-s[i][e+1],T[o]=m*r+n*f;return T}}},{}],714:[function(t,P,R){P.exports=function(h,u,A,T,e){var i=u-2,n=A-2;return T&&e?function(a,r,f){a||(a=[]);var o,s,m,g,p,v,x=Math.max(0,Math.min(Math.floor(r),i)),l=Math.max(0,Math.min(Math.floor(f),n)),b=Math.max(0,Math.min(1,r-x)),c=Math.max(0,Math.min(1,f-l));x*=3,l*=3;var M=b*b,_=M*b,y=1-b,w=y*y,d=w*y,C=c*c,S=C*c,E=1-c,k=E*E,B=k*E;for(v=0;v<h.length;v++)p=h[v],o=d*p[l][x]+3*(w*b*p[l][x+1]+y*M*p[l][x+2])+_*p[l][x+3],s=d*p[l+1][x]+3*(w*b*p[l+1][x+1]+y*M*p[l+1][x+2])+_*p[l+1][x+3],m=d*p[l+2][x]+3*(w*b*p[l+2][x+1]+y*M*p[l+2][x+2])+_*p[l+2][x+3],g=d*p[l+3][x]+3*(w*b*p[l+3][x+1]+y*M*p[l+3][x+2])+_*p[l+3][x+3],a[v]=B*o+3*(k*c*s+E*C*m)+S*g;return a}:T?function(a,r,f){a||(a=[]);var o=Math.max(0,Math.min(Math.floor(r),i)),s=Math.max(0,Math.min(Math.floor(f),n)),m=Math.max(0,Math.min(1,r-o)),g=Math.max(0,Math.min(1,f-s)),p,v,x,l,b,c;o*=3;var M=m*m,_=M*m,y=1-m,w=y*y,d=w*y,C=1-g;for(b=0;b<h.length;b++)c=h[b],p=C*c[s][o]+g*c[s+1][o],v=C*c[s][o+1]+g*c[s+1][o+1],x=C*c[s][o+2]+g*c[s+1][o+1],l=C*c[s][o+3]+g*c[s+1][o+1],a[b]=d*p+3*(w*m*v+y*M*x)+_*l;return a}:e?function(a,r,f){a||(a=[]);var o=Math.max(0,Math.min(Math.floor(r),i)),s=Math.max(0,Math.min(Math.floor(f),n)),m=Math.max(0,Math.min(1,r-o)),g=Math.max(0,Math.min(1,f-s)),p,v,x,l,b,c;s*=3;var M=g*g,_=M*g,y=1-g,w=y*y,d=w*y,C=1-m;for(b=0;b<h.length;b++)c=h[b],p=C*c[s][o]+m*c[s][o+1],v=C*c[s+1][o]+m*c[s+1][o+1],x=C*c[s+2][o]+m*c[s+2][o+1],l=C*c[s+3][o]+m*c[s+3][o+1],a[b]=d*p+3*(w*g*v+y*M*x)+_*l;return a}:function(a,r,f){a||(a=[]);var o=Math.max(0,Math.min(Math.floor(r),i)),s=Math.max(0,Math.min(Math.floor(f),n)),m=Math.max(0,Math.min(1,r-o)),g=Math.max(0,Math.min(1,f-s)),p,v,x,l,b=1-g,c=1-m;for(x=0;x<h.length;x++)l=h[x],p=c*l[s][o]+m*l[s][o+1],v=c*l[s+1][o]+m*l[s+1][o+1],a[x]=b*p+g*v;return a}}},{}],715:[function(t,P,R){var h=t("../../lib"),u=t("./xy_defaults"),A=t("./ab_defaults"),T=t("./attributes"),e=t("../../components/color/attributes");P.exports=function(n,a,r,f){function o(g,p){return h.coerce(n,a,T,g,p)}a._clipPathId="clip"+a.uid+"carpet";var s=o("color",e.defaultLine);if(h.coerceFont(o,"font"),o("carpet"),A(n,a,f,o,s),!a.a||!a.b){a.visible=!1;return}a.a.length<3&&(a.aaxis.smoothing=0),a.b.length<3&&(a.baxis.smoothing=0);var m=u(n,a,o);m||(a.visible=!1),a._cheater&&o("cheaterslope")}},{"../../components/color/attributes":366,"../../lib":515,"./ab_defaults":698,"./attributes":700,"./xy_defaults":724}],716:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),plot:t("./plot"),calc:t("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"./attributes":700,"./calc":704,"./defaults":715,"./plot":721}],717:[function(t,P,R){P.exports=function(h,u){for(var A=h._fullData.length,T,e=0;e<A;e++){var i=h._fullData[e];if(i.index!==u.index&&i.type==="carpet"&&(T||(T=i),i.carpet===u.carpet))return i}return T}},{}],718:[function(t,P,R){P.exports=function(u,A,T){if(u.length===0)return"";var e,i=[],n=T?3:1;for(e=0;e<u.length;e+=n)i.push(u[e]+","+A[e]),T&&e<u.length-n&&(i.push("C"),i.push([u[e+1]+","+A[e+1],u[e+2]+","+A[e+2]+" "].join(" ")));return i.join(T?"":"L")}},{}],719:[function(t,P,R){var h=t("../../lib").isArrayOrTypedArray;P.exports=function(A,T,e){var i;for(h(A)?A.length>T.length&&(A=A.slice(0,T.length)):A=[],i=0;i<T.length;i++)A[i]=e(T[i]);return A}},{"../../lib":515}],720:[function(t,P,R){P.exports=function(u,A,T,e,i,n){var a=i[0]*u.dpdx(A),r=i[1]*u.dpdy(T),f=1,o=1;if(n){var s=Math.sqrt(i[0]*i[0]+i[1]*i[1]),m=Math.sqrt(n[0]*n[0]+n[1]*n[1]),g=(i[0]*n[0]+i[1]*n[1])/s/m;o=Math.max(0,g)}var p=Math.atan2(r,a)*180/Math.PI;return p<-90?(p+=180,f=-f):p>90&&(p-=180,f=-f),{angle:p,flip:f,p:u.c2p(e,A,T),offsetMultplier:o}}},{}],721:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/drawing"),A=t("./map_1d_array"),T=t("./makepath"),e=t("./orient_text"),i=t("../../lib/svg_text_utils"),n=t("../../lib"),a=n.strRotate,r=n.strTranslate,f=t("../../constants/alignment");P.exports=function(b,c,M,_){var y=c.xaxis,w=c.yaxis,d=b._fullLayout,C=d._clips;n.makeTraceGroups(_,M,"trace").each(function(S){var E=h.select(this),k=S[0],B=k.trace,z=B.aaxis,F=B.baxis,I=n.ensureSingle(E,"g","minorlayer"),O=n.ensureSingle(E,"g","majorlayer"),N=n.ensureSingle(E,"g","boundarylayer"),V=n.ensureSingle(E,"g","labellayer");E.style("opacity",B.opacity),s(y,w,O,z,"a",z._gridlines),s(y,w,O,F,"b",F._gridlines),s(y,w,I,z,"a",z._minorgridlines),s(y,w,I,F,"b",F._minorgridlines),s(y,w,N,z,"a-boundary",z._boundarylines),s(y,w,N,F,"b-boundary",F._boundarylines);var H=m(b,y,w,B,k,V,z._labels,"a-label"),j=m(b,y,w,B,k,V,F._labels,"b-label");g(b,V,B,k,y,w,H,j),o(B,k,C,y,w)})};function o(l,b,c,M,_){var y,w,d,C,S=c.select("#"+l._clipPathId);S.size()||(S=c.append("clipPath").classed("carpetclip",!0));var E=n.ensureSingle(S,"path","carpetboundary"),k=b.clipsegments,B=[];for(C=0;C<k.length;C++)y=k[C],w=A([],y.x,M.c2p),d=A([],y.y,_.c2p),B.push(T(w,d,y.bicubic));var z="M"+B.join("L")+"Z";S.attr("id",l._clipPathId),E.attr("d",z)}function s(l,b,c,M,_,y){var w="const-"+_+"-lines",d=c.selectAll("."+w).data(y);d.enter().append("path").classed(w,!0).style("vector-effect","non-scaling-stroke"),d.each(function(C){var S=C,E=S.x,k=S.y,B=A([],E,l.c2p),z=A([],k,b.c2p),F="M"+T(B,z,S.smoothing),I=h.select(this);I.attr("d",F).style("stroke-width",S.width).style("stroke",S.color).style("stroke-dasharray",u.dashStyle(S.dash,S.width)).style("fill","none")}),d.exit().remove()}function m(l,b,c,M,_,y,w,d){var C=y.selectAll("text."+d).data(w);C.enter().append("text").classed(d,!0);var S=0,E={};return C.each(function(k,B){var z;if(k.axis.tickangle==="auto")z=e(M,b,c,k.xy,k.dxy);else{var F=(k.axis.tickangle+180)*Math.PI/180;z=e(M,b,c,k.xy,[Math.cos(F),Math.sin(F)])}B||(E={angle:z.angle,flip:z.flip});var I=(k.endAnchor?-1:1)*z.flip,O=h.select(this).attr({"text-anchor":I>0?"start":"end","data-notex":1}).call(u.font,k.font).text(k.text).call(i.convertToTspans,l),N=u.bBox(this);O.attr("transform",r(z.p[0],z.p[1])+a(z.angle)+r(k.axis.labelpadding*I,N.height*.3)),S=Math.max(S,N.width+k.axis.labelpadding)}),C.exit().remove(),E.maxExtent=S,E}function g(l,b,c,M,_,y,w,d){var C,S,E,k,B=n.aggNums(Math.min,null,c.a),z=n.aggNums(Math.max,null,c.a),F=n.aggNums(Math.min,null,c.b),I=n.aggNums(Math.max,null,c.b);C=.5*(B+z),S=F,E=c.ab2xy(C,S,!0),k=c.dxyda_rough(C,S),w.angle===void 0&&n.extendFlat(w,e(c,_,y,E,c.dxydb_rough(C,S))),x(l,b,c,M,E,k,c.aaxis,_,y,w,"a-title"),C=B,S=.5*(F+I),E=c.ab2xy(C,S,!0),k=c.dxydb_rough(C,S),d.angle===void 0&&n.extendFlat(d,e(c,_,y,E,c.dxyda_rough(C,S))),x(l,b,c,M,E,k,c.baxis,_,y,d,"b-title")}var p=f.LINE_SPACING,v=(1-f.MID_SHIFT)/p+1;function x(l,b,c,M,_,y,w,d,C,S,E){var k=[];w.title.text&&k.push(w.title.text);var B=b.selectAll("text."+E).data(k),z=S.maxExtent;B.enter().append("text").classed(E,!0),B.each(function(){var F=e(c,d,C,_,y);["start","both"].indexOf(w.showticklabels)===-1&&(z=0);var I=w.title.font.size;z+=I+w.title.offset;var O=S.angle+(S.flip<0?180:0),N=(O-F.angle+450)%360,V=N>90&&N<270,H=h.select(this);H.text(w.title.text).call(i.convertToTspans,l),V&&(z=(-i.lineCount(H)+v)*p*I-z),H.attr("transform",r(F.p[0],F.p[1])+a(F.angle)+r(0,z)).attr("text-anchor","middle").call(u.font,w.title.font)}),B.exit().remove()}},{"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"./makepath":718,"./map_1d_array":719,"./orient_text":720,"@plotly/d3":58}],722:[function(t,P,R){var h=t("./constants"),u=t("../../lib/search").findBin,A=t("./compute_control_points"),T=t("./create_spline_evaluator"),e=t("./create_i_derivative_evaluator"),i=t("./create_j_derivative_evaluator");P.exports=function(a){var r=a._a,f=a._b,o=r.length,s=f.length,m=a.aaxis,g=a.baxis,p=r[0],v=r[o-1],x=f[0],l=f[s-1],b=r[r.length-1]-r[0],c=f[f.length-1]-f[0],M=b*h.RELATIVE_CULL_TOLERANCE,_=c*h.RELATIVE_CULL_TOLERANCE;p-=M,v+=M,x-=_,l+=_,a.isVisible=function(y,w){return y>p&&y<v&&w>x&&w<l},a.isOccluded=function(y,w){return y<p||y>v||w<x||w>l},a.setScale=function(){var y=a._x,w=a._y,d=A(a._xctrl,a._yctrl,y,w,m.smoothing,g.smoothing);a._xctrl=d[0],a._yctrl=d[1],a.evalxy=T([a._xctrl,a._yctrl],o,s,m.smoothing,g.smoothing),a.dxydi=e([a._xctrl,a._yctrl],m.smoothing,g.smoothing),a.dxydj=i([a._xctrl,a._yctrl],m.smoothing,g.smoothing)},a.i2a=function(y){var w=Math.max(0,Math.floor(y[0]),o-2),d=y[0]-w;return(1-d)*r[w]+d*r[w+1]},a.j2b=function(y){var w=Math.max(0,Math.floor(y[1]),o-2),d=y[1]-w;return(1-d)*f[w]+d*f[w+1]},a.ij2ab=function(y){return[a.i2a(y[0]),a.j2b(y[1])]},a.a2i=function(y){var w=Math.max(0,Math.min(u(y,r),o-2)),d=r[w],C=r[w+1];return Math.max(0,Math.min(o-1,w+(y-d)/(C-d)))},a.b2j=function(y){var w=Math.max(0,Math.min(u(y,f),s-2)),d=f[w],C=f[w+1];return Math.max(0,Math.min(s-1,w+(y-d)/(C-d)))},a.ab2ij=function(y){return[a.a2i(y[0]),a.b2j(y[1])]},a.i2c=function(y,w){return a.evalxy([],y,w)},a.ab2xy=function(y,w,d){if(!d&&(y<r[0]||y>r[o-1]|w<f[0]||w>f[s-1]))return[!1,!1];var C=a.a2i(y),S=a.b2j(w),E=a.evalxy([],C,S);if(d){var k=0,B=0,z=[],F,I,O,N;y<r[0]?(F=0,I=0,k=(y-r[0])/(r[1]-r[0])):y>r[o-1]?(F=o-2,I=1,k=(y-r[o-1])/(r[o-1]-r[o-2])):(F=Math.max(0,Math.min(o-2,Math.floor(C))),I=C-F),w<f[0]?(O=0,N=0,B=(w-f[0])/(f[1]-f[0])):w>f[s-1]?(O=s-2,N=1,B=(w-f[s-1])/(f[s-1]-f[s-2])):(O=Math.max(0,Math.min(s-2,Math.floor(S))),N=S-O),k&&(a.dxydi(z,F,O,I,N),E[0]+=z[0]*k,E[1]+=z[1]*k),B&&(a.dxydj(z,F,O,I,N),E[0]+=z[0]*B,E[1]+=z[1]*B)}return E},a.c2p=function(y,w,d){return[w.c2p(y[0]),d.c2p(y[1])]},a.p2x=function(y,w,d){return[w.p2c(y[0]),d.p2c(y[1])]},a.dadi=function(y){var w=Math.max(0,Math.min(r.length-2,y));return r[w+1]-r[w]},a.dbdj=function(y){var w=Math.max(0,Math.min(f.length-2,y));return f[w+1]-f[w]},a.dxyda=function(y,w,d,C){var S=a.dxydi(null,y,w,d,C),E=a.dadi(y,d);return[S[0]/E,S[1]/E]},a.dxydb=function(y,w,d,C){var S=a.dxydj(null,y,w,d,C),E=a.dbdj(w,C);return[S[0]/E,S[1]/E]},a.dxyda_rough=function(y,w,d){var C=b*(d||.1),S=a.ab2xy(y+C,w,!0),E=a.ab2xy(y-C,w,!0);return[(S[0]-E[0])*.5/C,(S[1]-E[1])*.5/C]},a.dxydb_rough=function(y,w,d){var C=c*(d||.1),S=a.ab2xy(y,w+C,!0),E=a.ab2xy(y,w-C,!0);return[(S[0]-E[0])*.5/C,(S[1]-E[1])*.5/C]},a.dpdx=function(y){return y._m},a.dpdy=function(y){return y._m}}},{"../../lib/search":535,"./compute_control_points":710,"./constants":711,"./create_i_derivative_evaluator":712,"./create_j_derivative_evaluator":713,"./create_spline_evaluator":714}],723:[function(t,P,R){var h=t("../../lib");P.exports=function(A,T,e){var i,n,a,r=[],f=[],o=A[0].length,s=A.length;function m(Z,X){var re=0,ue,K=0;return Z>0&&(ue=A[X][Z-1])!==void 0&&(K++,re+=ue),Z<o-1&&(ue=A[X][Z+1])!==void 0&&(K++,re+=ue),X>0&&(ue=A[X-1][Z])!==void 0&&(K++,re+=ue),X<s-1&&(ue=A[X+1][Z])!==void 0&&(K++,re+=ue),re/Math.max(1,K)}var g=0;for(i=0;i<o;i++)for(n=0;n<s;n++)A[n][i]===void 0&&(r.push(i),f.push(n),A[n][i]=m(i,n)),g=Math.max(g,Math.abs(A[n][i]));if(!r.length)return A;var p,v,x,l,b,c,M,_,y,w,d,C=1e-5,S=0,E=100,k=0,B=r.length;do{for(S=0,a=0;a<B;a++){i=r[a],n=f[a];var z=0,F=0,I,O,N,V,H,j;i===0?(H=Math.min(o-1,2),N=T[H],V=T[1],I=A[n][H],O=A[n][1],F+=O+(O-I)*(T[0]-V)/(V-N),z++):i===o-1&&(H=Math.max(0,o-3),N=T[H],V=T[o-2],I=A[n][H],O=A[n][o-2],F+=O+(O-I)*(T[o-1]-V)/(V-N),z++),(i===0||i===o-1)&&n>0&&n<s-1&&(p=e[n+1]-e[n],v=e[n]-e[n-1],F+=(v*A[n+1][i]+p*A[n-1][i])/(v+p),z++),n===0?(j=Math.min(s-1,2),N=e[j],V=e[1],I=A[j][i],O=A[1][i],F+=O+(O-I)*(e[0]-V)/(V-N),z++):n===s-1&&(j=Math.max(0,s-3),N=e[j],V=e[s-2],I=A[j][i],O=A[s-2][i],F+=O+(O-I)*(e[s-1]-V)/(V-N),z++),(n===0||n===s-1)&&i>0&&i<o-1&&(p=T[i+1]-T[i],v=T[i]-T[i-1],F+=(v*A[n][i+1]+p*A[n][i-1])/(v+p),z++),z?F/=z:(x=T[i+1]-T[i],l=T[i]-T[i-1],b=e[n+1]-e[n],c=e[n]-e[n-1],M=x*l*(x+l),_=b*c*(b+c),F=(M*(c*A[n+1][i]+b*A[n-1][i])+_*(l*A[n][i+1]+x*A[n][i-1]))/(_*(l+x)+M*(c+b))),y=F-A[n][i],w=y/g,S+=w*w,d=z?0:.85,A[n][i]+=y*(1+d)}S=Math.sqrt(S)}while(k++<E&&S>C);return h.log("Smoother converged to",S,"after",k,"iterations"),A}},{"../../lib":515}],724:[function(t,P,R){var h=t("../../lib").isArray1D;P.exports=function(A,T,e){var i=e("x"),n=i&&i.length,a=e("y"),r=a&&a.length;if(!n&&!r)return!1;if(T._cheater=!i,(!n||h(i))&&(!r||h(a))){var f=n?i.length:1/0;r&&(f=Math.min(f,a.length)),T.a&&T.a.length&&(f=Math.min(f,T.a.length)),T.b&&T.b.length&&(f=Math.min(f,T.b.length)),T._length=f}else T._length=null;return!0}},{"../../lib":515}],725:[function(t,P,R){var h=t("../../plots/template_attributes").hovertemplateAttrs,u=t("../scattergeo/attributes"),A=t("../../components/colorscale/attributes"),T=t("../../plots/attributes"),e=t("../../components/color/attributes").defaultLine,i=t("../../lib/extend").extendFlat,n=u.marker.line;P.exports=i({locations:{valType:"data_array",editType:"calc"},locationmode:u.locationmode,z:{valType:"data_array",editType:"calc"},geojson:i({},u.geojson,{}),featureidkey:u.featureidkey,text:i({},u.text,{}),hovertext:i({},u.hovertext,{}),marker:{line:{color:i({},n.color,{dflt:e}),width:i({},n.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:u.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:u.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:i({},T.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:h(),showlegend:i({},T.showlegend,{dflt:!1})},A("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattergeo/attributes":978}],726:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../constants/numerical").BADNUM,A=t("../../components/colorscale/calc"),T=t("../scatter/arrays_to_calcdata"),e=t("../scatter/calc_selection");function i(n){return n&&typeof n=="string"}P.exports=function(a,r){var f=r._length,o=new Array(f),s;r.geojson?s=function(x){return i(x)||h(x)}:s=i;for(var m=0;m<f;m++){var g=o[m]={},p=r.locations[m],v=r.z[m];s(p)&&h(v)?(g.loc=p,g.z=v):(g.loc=null,g.z=u),g.index=m}return T(o,r),A(a,r,{vals:r.z,containerStr:"",cLetter:"z"}),e(o,r),o}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"fast-isnumeric":190}],727:[function(t,P,R){var h=t("../../lib"),u=t("../../components/colorscale/defaults"),A=t("./attributes");P.exports=function(e,i,n,a){function r(v,x){return h.coerce(e,i,A,v,x)}var f=r("locations"),o=r("z");if(!(f&&f.length&&h.isArrayOrTypedArray(o)&&o.length)){i.visible=!1;return}i._length=Math.min(f.length,o.length);var s=r("geojson"),m;(typeof s=="string"&&s!==""||h.isPlainObject(s))&&(m="geojson-id");var g=r("locationmode",m);g==="geojson-id"&&r("featureidkey"),r("text"),r("hovertext"),r("hovertemplate");var p=r("marker.line.width");p&&r("marker.line.color"),r("marker.opacity"),u(e,i,a,r,{prefix:"",cLetter:"z"}),h.coerceSelectionMarkerOpacity(i,r)}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":725}],728:[function(t,P,R){P.exports=function(u,A,T,e,i){u.location=A.location,u.z=A.z;var n=e[i];return n.fIn&&n.fIn.properties&&(u.properties=n.fIn.properties),u.ct=n.ct,u}},{}],729:[function(t,P,R){var h=t("../../plots/cartesian/axes"),u=t("./attributes"),A=t("../../lib").fillText;P.exports=function(i,n,a){var r=i.cd,f=r[0].trace,o=i.subplot,s,m,g,p,v=[n,a],x=[n+360,a];for(m=0;m<r.length;m++)if(s=r[m],p=!1,s._polygons){for(g=0;g<s._polygons.length;g++)s._polygons[g].contains(v)&&(p=!p),s._polygons[g].contains(x)&&(p=!p);if(p)break}if(!(!p||!s))return i.x0=i.x1=i.xa.c2p(s.ct),i.y0=i.y1=i.ya.c2p(s.ct),i.index=s.index,i.location=s.loc,i.z=s.z,i.zLabel=h.tickText(o.mockAxis,o.mockAxis.c2l(s.z),"hover").text,i.hovertemplate=s.hovertemplate,T(i,f,s),[i]};function T(e,i,n){if(!i.hovertemplate){var a=n.hi||i.hoverinfo,r=String(n.loc),f=a==="all"?u.hoverinfo.flags:a.split("+"),o=f.indexOf("name")!==-1,s=f.indexOf("location")!==-1,m=f.indexOf("z")!==-1,g=f.indexOf("text")!==-1,p=!o&&s,v=[];p?e.nameOverride=r:(o&&(e.nameOverride=i.name),s&&v.push(r)),m&&v.push(e.zLabel),g&&A(n,i,v),e.extraText=v.join("<br>")}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./attributes":725}],730:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../heatmap/colorbar"),calc:t("./calc"),calcGeoJSON:t("./plot").calcGeoJSON,plot:t("./plot").plot,style:t("./style").style,styleOnSelect:t("./style").styleOnSelect,hoverPoints:t("./hover"),eventData:t("./event_data"),selectPoints:t("./select"),moduleType:"trace",name:"choropleth",basePlotModule:t("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":598,"../heatmap/colorbar":804,"./attributes":725,"./calc":726,"./defaults":727,"./event_data":728,"./hover":729,"./plot":731,"./select":732,"./style":733}],731:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=t("../../lib/geo_location_utils"),T=t("../../lib/topojson_utils").getTopojsonFeatures,e=t("../../plots/cartesian/autorange").findExtremes,i=t("./style").style;function n(r,f,o){var s=f.layers.backplot.select(".choroplethlayer");u.makeTraceGroups(s,o,"trace choropleth").each(function(m){var g=h.select(this),p=g.selectAll("path.choroplethlocation").data(u.identity);p.enter().append("path").classed("choroplethlocation",!0),p.exit().remove(),i(r,m)})}function a(r,f){for(var o=r[0].trace,s=f[o.geo],m=s._subplot,g=o.locationmode,p=o._length,v=g==="geojson-id"?A.extractTraceFeature(r):T(o,m.topojson),x=[],l=[],b=0;b<p;b++){var c=r[b],M=g==="geojson-id"?c.fOut:A.locationToFeature(g,c.loc,v);if(M){c.geojson=M,c.ct=M.properties.ct,c._polygons=A.feature2polygons(M);var _=A.computeBbox(M);x.push(_[0],_[2]),l.push(_[1],_[3])}else c.geojson=null}if(s.fitbounds==="geojson"&&g==="geojson-id"){var y=A.computeBbox(A.getTraceGeojson(o));x=[y[0],y[2]],l=[y[1],y[3]]}var w={padded:!0};o._extremes.lon=e(s.lonaxis._ax,x,w),o._extremes.lat=e(s.lataxis._ax,l,w)}P.exports={calcGeoJSON:a,plot:n}},{"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"./style":733,"@plotly/d3":58}],732:[function(t,P,R){P.exports=function(u,A){var T=u.cd,e=u.xaxis,i=u.yaxis,n=[],a,r,f,o,s;if(A===!1)for(a=0;a<T.length;a++)T[a].selected=0;else for(a=0;a<T.length;a++)r=T[a],f=r.ct,f&&(o=e.c2p(f),s=i.c2p(f),A.contains([o,s],null,a,u)?(n.push({pointNumber:a,lon:f[0],lat:f[1]}),r.selected=1):r.selected=0);return n}},{}],733:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/color"),A=t("../../components/drawing"),T=t("../../components/colorscale");function e(a,r){r&&i(a,r)}function i(a,r){var f=r[0].trace,o=r[0].node3,s=o.selectAll(".choroplethlocation"),m=f.marker||{},g=m.line||{},p=T.makeColorScaleFuncFromTrace(f);s.each(function(v){h.select(this).attr("fill",p(v.z)).call(u.stroke,v.mlc||g.color).call(A.dashLine,"",v.mlw||g.width||0).style("opacity",m.opacity)}),A.selectedPointStyle(s,f)}function n(a,r){var f=r[0].node3,o=r[0].trace;o.selectedpoints?A.selectedPointStyle(f.selectAll(".choroplethlocation"),o):i(a,r)}P.exports={style:e,styleOnSelect:n}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"@plotly/d3":58}],734:[function(t,P,R){var h=t("../choropleth/attributes"),u=t("../../components/colorscale/attributes"),A=t("../../plots/template_attributes").hovertemplateAttrs,T=t("../../plots/attributes"),e=t("../../lib/extend").extendFlat;P.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},h.featureidkey,{}),below:{valType:"string",editType:"plot"},text:h.text,hovertext:h.hovertext,marker:{line:{color:e({},h.marker.line.color,{editType:"plot"}),width:e({},h.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},h.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},h.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},h.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:h.hoverinfo,hovertemplate:A({},{keys:["properties"]}),showlegend:e({},T.showlegend,{dflt:!1})},u("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../choropleth/attributes":725}],735:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib"),A=t("../../components/colorscale"),T=t("../../components/drawing"),e=t("../../lib/geojson_utils").makeBlank,i=t("../../lib/geo_location_utils");function n(r){var f=r[0].trace,o=f.visible===!0&&f._length!==0,s={layout:{visibility:"none"},paint:{}},m={layout:{visibility:"none"},paint:{}},g=f._opts={fill:s,line:m,geojson:e()};if(!o)return g;var p=i.extractTraceFeature(r);if(!p)return g;var v=A.makeColorScaleFuncFromTrace(f),x=f.marker,l=x.line||{},b;u.isArrayOrTypedArray(x.opacity)&&(b=function(S){var E=S.mo;return h(E)?+u.constrain(E,0,1):0});var c;u.isArrayOrTypedArray(l.color)&&(c=function(S){return S.mlc});var M;u.isArrayOrTypedArray(l.width)&&(M=function(S){return S.mlw});for(var _=0;_<r.length;_++){var y=r[_],w=y.fOut;if(w){var d=w.properties;d.fc=v(y.z),b&&(d.mo=b(y)),c&&(d.mlc=c(y)),M&&(d.mlw=M(y)),y.ct=d.ct,y._polygons=i.feature2polygons(w)}}var C=b?{type:"identity",property:"mo"}:x.opacity;return u.extendFlat(s.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":C}),u.extendFlat(m.paint,{"line-color":c?{type:"identity",property:"mlc"}:l.color,"line-width":M?{type:"identity",property:"mlw"}:l.width,"line-opacity":C}),s.layout.visibility="visible",m.layout.visibility="visible",g.geojson={type:"FeatureCollection",features:p},a(r),g}function a(r){var f=r[0].trace,o=f._opts,s;if(f.selectedpoints){for(var m=T.makeSelectedPointStyleFns(f),g=0;g<r.length;g++){var p=r[g];p.fOut&&(p.fOut.properties.mo2=m.selectedOpacityFn(p))}s={type:"identity",property:"mo2"}}else s=u.isArrayOrTypedArray(f.marker.opacity)?{type:"identity",property:"mo"}:f.marker.opacity;return u.extendFlat(o.fill.paint,{"fill-opacity":s}),u.extendFlat(o.line.paint,{"line-opacity":s}),o}P.exports={convert:n,convertOnSelect:a}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"fast-isnumeric":190}],736:[function(t,P,R){var h=t("../../lib"),u=t("../../components/colorscale/defaults"),A=t("./attributes");P.exports=function(e,i,n,a){function r(g,p){return h.coerce(e,i,A,g,p)}var f=r("locations"),o=r("z"),s=r("geojson");if(!h.isArrayOrTypedArray(f)||!f.length||!h.isArrayOrTypedArray(o)||!o.length||!(typeof s=="string"&&s!==""||h.isPlainObject(s))){i.visible=!1;return}r("featureidkey"),i._length=Math.min(f.length,o.length),r("below"),r("text"),r("hovertext"),r("hovertemplate");var m=r("marker.line.width");m&&r("marker.line.color"),r("marker.opacity"),u(e,i,a,r,{prefix:"",cLetter:"z"}),h.coerceSelectionMarkerOpacity(i,r)}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":734}],737:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../heatmap/colorbar"),calc:t("../choropleth/calc"),plot:t("./plot"),hoverPoints:t("../choropleth/hover"),eventData:t("../choropleth/event_data"),selectPoints:t("../choropleth/select"),styleOnSelect:function(h,u){if(u){var A=u[0].trace;A._glTrace.updateOnSelect(u)}},getBelow:function(h,u){for(var A=u.getMapLayers(),T=A.length-2;T>=0;T--){var e=A[T].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var i=T+1;i<A.length;i++)if(e=A[i].id,typeof e=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:t("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":622,"../choropleth/calc":726,"../choropleth/event_data":728,"../choropleth/hover":729,"../choropleth/select":732,"../heatmap/colorbar":804,"./attributes":734,"./defaults":736,"./plot":738}],738:[function(t,P,R){var h=t("./convert").convert,u=t("./convert").convertOnSelect,A=t("../../plots/mapbox/constants").traceLayerPrefix;function T(i,n){this.type="choroplethmapbox",this.subplot=i,this.uid=n,this.sourceId="source-"+n,this.layerList=[["fill",A+n+"-fill"],["line",A+n+"-line"]],this.below=null}var e=T.prototype;e.update=function(i){this._update(h(i)),i[0].trace._glTrace=this},e.updateOnSelect=function(i){this._update(u(i))},e._update=function(i){var n=this.subplot,a=this.layerList,r=n.belowLookup["trace-"+this.uid];n.map.getSource(this.sourceId).setData(i.geojson),r!==this.below&&(this._removeLayers(),this._addLayers(i,r),this.below=r);for(var f=0;f<a.length;f++){var o=a[f],s=o[0],m=o[1],g=i[s];n.setOptions(m,"setLayoutProperty",g.layout),g.layout.visibility==="visible"&&n.setOptions(m,"setPaintProperty",g.paint)}},e._addLayers=function(i,n){for(var a=this.subplot,r=this.layerList,f=this.sourceId,o=0;o<r.length;o++){var s=r[o],m=s[0],g=i[m];a.addLayer({type:m,id:s[1],source:f,layout:g.layout,paint:g.paint},n)}},e._removeLayers=function(){for(var i=this.subplot.map,n=this.layerList,a=n.length-1;a>=0;a--)i.removeLayer(n[a][1])},e.dispose=function(){var i=this.subplot.map;this._removeLayers(),i.removeSource(this.sourceId)},P.exports=function(n,a){var r=a[0].trace,f=new T(n,r.uid),o=f.sourceId,s=h(a),m=f.below=n.belowLookup["trace-"+r.uid];return n.map.addSource(o,{type:"geojson",data:s.geojson}),f._addLayers(s,m),a[0].trace._glTrace=f,f}},{"../../plots/mapbox/constants":620,"./convert":735}],739:[function(t,P,R){var h=t("../../components/colorscale/attributes"),u=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,A=t("../../plots/template_attributes").hovertemplateAttrs,T=t("../mesh3d/attributes"),e=t("../../plots/attributes"),i=t("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:A({editType:"calc"},{keys:["norm"]}),uhoverformat:u("u",1),vhoverformat:u("v",1),whoverformat:u("w",1),xhoverformat:u("x"),yhoverformat:u("y"),zhoverformat:u("z"),showlegend:i({},e.showlegend,{dflt:!1})};i(n,h("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));var a=["opacity","lightposition","lighting"];a.forEach(function(r){n[r]=T[r]}),n.hoverinfo=i({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,P.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],740:[function(t,P,R){var h=t("../../components/colorscale/calc");P.exports=function(A,T){for(var e=T.u,i=T.v,n=T.w,a=Math.min(T.x.length,T.y.length,T.z.length,e.length,i.length,n.length),r=-1/0,f=1/0,o=0;o<a;o++){var s=e[o],m=i[o],g=n[o],p=Math.sqrt(s*s+m*m+g*g);r=Math.max(r,p),f=Math.min(f,p)}T._len=a,T._normMax=r,h(A,T,{vals:[f,r],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],741:[function(t,P,R){var h=t("../../../stackgl_modules").gl_cone3d,u=t("../../../stackgl_modules").gl_cone3d.createConeMesh,A=t("../../lib").simpleMap,T=t("../../lib/gl_format_color").parseColorScale,e=t("../../components/colorscale").extractOpts,i=t("../../plots/gl3d/zip3");function n(g,p){this.scene=g,this.uid=p,this.mesh=null,this.data=null}var a=n.prototype;a.handlePick=function(g){if(g.object===this.mesh){var p=g.index=g.data.index,v=this.data.x[p],x=this.data.y[p],l=this.data.z[p],b=this.data.u[p],c=this.data.v[p],M=this.data.w[p];g.traceCoordinate=[v,x,l,b,c,M,Math.sqrt(b*b+c*c+M*M)];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[p]!==void 0?g.textLabel=_[p]:_&&(g.textLabel=_),!0}};var r={xaxis:0,yaxis:1,zaxis:2},f={tip:1,tail:0,cm:.25,center:.5},o={tip:1,tail:1,cm:.75,center:.5};function s(g,p){var v=g.fullSceneLayout,x=g.dataScale,l={};function b(y,w){var d=v[w],C=x[r[w]];return A(y,function(S){return d.d2l(S)*C})}l.vectors=i(b(p.u,"xaxis"),b(p.v,"yaxis"),b(p.w,"zaxis"),p._len),l.positions=i(b(p.x,"xaxis"),b(p.y,"yaxis"),b(p.z,"zaxis"),p._len);var c=e(p);l.colormap=T(p),l.vertexIntensityBounds=[c.min/p._normMax,c.max/p._normMax],l.coneOffset=f[p.anchor],p.sizemode==="scaled"?l.coneSize=p.sizeref||.5:l.coneSize=p.sizeref&&p._normMax?p.sizeref/p._normMax:.5;var M=h(l),_=p.lightposition;return M.lightPosition=[_.x,_.y,_.z],M.ambient=p.lighting.ambient,M.diffuse=p.lighting.diffuse,M.specular=p.lighting.specular,M.roughness=p.lighting.roughness,M.fresnel=p.lighting.fresnel,M.opacity=p.opacity,p._pad=o[p.anchor]*M.vectorScale*M.coneScale*p._normMax,M}a.update=function(g){this.data=g;var p=s(this.scene,g);this.mesh.update(p)},a.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function m(g,p){var v=g.glplot.gl,x=s(g,p),l=u(v,x),b=new n(g,p.uid);return b.mesh=l,b.data=p,l._trace=b,g.glplot.add(l),b}P.exports=m},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],742:[function(t,P,R){var h=t("../../lib"),u=t("../../components/colorscale/defaults"),A=t("./attributes");P.exports=function(e,i,n,a){function r(v,x){return h.coerce(e,i,A,v,x)}var f=r("u"),o=r("v"),s=r("w"),m=r("x"),g=r("y"),p=r("z");if(!f||!f.length||!o||!o.length||!s||!s.length||!m||!m.length||!g||!g.length||!p||!p.length){i.visible=!1;return}r("sizeref"),r("sizemode"),r("anchor"),r("lighting.ambient"),r("lighting.diffuse"),r("lighting.specular"),r("lighting.roughness"),r("lighting.fresnel"),r("lightposition.x"),r("lightposition.y"),r("lightposition.z"),u(e,i,a,r,{prefix:"",cLetter:"c"}),r("text"),r("hovertext"),r("hovertemplate"),r("uhoverformat"),r("vhoverformat"),r("whoverformat"),r("xhoverformat"),r("yhoverformat"),r("zhoverformat"),i._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":739}],743:[function(t,P,R){P.exports={moduleType:"trace",name:"cone",basePlotModule:t("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:t("./calc"),plot:t("./convert"),eventData:function(h,u){return h.norm=u.traceCoordinate[6],h},meta:{}}},{"../../plots/gl3d":607,"./attributes":739,"./calc":740,"./convert":741,"./defaults":742}],744:[function(t,P,R){var h=t("../heatmap/attributes"),u=t("../scatter/attributes"),A=t("../../plots/cartesian/axis_format_attributes"),T=A.axisHoverFormat,e=A.descriptionOnlyNumbers,i=t("../../components/colorscale/attributes"),n=t("../../components/drawing/attributes").dash,a=t("../../plots/font_attributes"),r=t("../../lib/extend").extendFlat,f=t("../../constants/filter_ops"),o=f.COMPARISON_OPS2,s=f.INTERVAL_OPS,m=u.line;P.exports=r({z:h.z,x:h.x,x0:h.x0,dx:h.dx,y:h.y,y0:h.y0,dy:h.dy,xperiod:h.xperiod,yperiod:h.yperiod,xperiod0:u.xperiod0,yperiod0:u.yperiod0,xperiodalignment:h.xperiodalignment,yperiodalignment:h.yperiodalignment,text:h.text,hovertext:h.hovertext,transpose:h.transpose,xtype:h.xtype,ytype:h.ytype,xhoverformat:T("x"),yhoverformat:T("y"),zhoverformat:T("z",1),hovertemplate:h.hovertemplate,texttemplate:r({},h.texttemplate,{}),textfont:r({},h.textfont,{}),hoverongaps:h.hoverongaps,connectgaps:r({},h.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:a({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(o).concat(s),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:r({},m.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:n,smoothing:r({},m.smoothing,{}),editType:"plot"}},i("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../constants/filter_ops":487,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../heatmap/attributes":801,"../scatter/attributes":936}],745:[function(t,P,R){var h=t("../../components/colorscale"),u=t("../heatmap/calc"),A=t("./set_contours"),T=t("./end_plus");P.exports=function(i,n){var a=u(i,n),r=a[0].z;A(n,r);var f=n.contours,o=h.extractOpts(n),s;if(f.coloring==="heatmap"&&o.auto&&n.autocontour===!1){var m=f.start,g=T(f),p=f.size||1,v=Math.floor((g-m)/p)+1;isFinite(p)||(p=1,v=1);var x=m-p/2,l=x+v*p;s=[x,l]}else s=r;return h.calc(i,n,{vals:s,cLetter:"z"}),a}},{"../../components/colorscale":379,"../heatmap/calc":802,"./end_plus":755,"./set_contours":763}],746:[function(t,P,R){P.exports=function(h,u){var A=h[0],T=A.z,e;switch(u.type){case"levels":var i=Math.min(T[0][0],T[0][1]);for(e=0;e<h.length;e++){var n=h[e];n.prefixBoundary=!n.edgepaths.length&&(i>n.level||n.starts.length&&i===n.level)}break;case"constraint":if(A.prefixBoundary=!1,A.edgepaths.length)return;var a=A.x.length,r=A.y.length,f=-1/0,o=1/0;for(e=0;e<r;e++)o=Math.min(o,T[e][0]),o=Math.min(o,T[e][a-1]),f=Math.max(f,T[e][0]),f=Math.max(f,T[e][a-1]);for(e=1;e<a-1;e++)o=Math.min(o,T[0][e]),o=Math.min(o,T[r-1][e]),f=Math.max(f,T[0][e]),f=Math.max(f,T[r-1][e]);var s=u.value,m,g;switch(u._operation){case">":s>f&&(A.prefixBoundary=!0);break;case"<":(s<o||A.starts.length&&s===o)&&(A.prefixBoundary=!0);break;case"[]":m=Math.min(s[0],s[1]),g=Math.max(s[0],s[1]),(g<o||m>f||A.starts.length&&g===o)&&(A.prefixBoundary=!0);break;case"][":m=Math.min(s[0],s[1]),g=Math.max(s[0],s[1]),m<o&&g>f&&(A.prefixBoundary=!0);break}break}}},{}],747:[function(t,P,R){var h=t("../../components/colorscale"),u=t("./make_color_map"),A=t("./end_plus");function T(e,i,n){var a=i.contours,r=i.line,f=a.size||1,o=a.coloring,s=u(i,{isColorbar:!0});if(o==="heatmap"){var m=h.extractOpts(i);n._fillgradient=m.reversescale?h.flipScale(m.colorscale):m.colorscale,n._zrange=[m.min,m.max]}else o==="fill"&&(n._fillcolor=s);n._line={color:o==="lines"?s:r.color,width:a.showlines!==!1?r.width:0,dash:r.dash},n._levels={start:a.start,end:A(a),size:f}}P.exports={min:"zmin",max:"zmax",calc:T}},{"../../components/colorscale":379,"./end_plus":755,"./make_color_map":760}],748:[function(t,P,R){P.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],749:[function(t,P,R){var h=t("fast-isnumeric"),u=t("./label_defaults"),A=t("../../components/color"),T=A.addOpacity,e=A.opacity,i=t("../../constants/filter_ops"),n=i.CONSTRAINT_REDUCTION,a=i.COMPARISON_OPS2;P.exports=function(o,s,m,g,p,v){var x=s.contours,l,b,c,M=m("contours.operation");if(x._operation=n[M],r(m,x),M==="="?l=x.showlines=!0:(l=m("contours.showlines"),c=m("fillcolor",T((o.line||{}).color||p,.5))),l){var _=c&&e(c)?T(s.fillcolor,1):p;b=m("line.color",_),m("line.width",2),m("line.dash")}m("line.smoothing"),u(m,g,b,v)};function r(f,o){var s;a.indexOf(o.operation)===-1?(f("contours.value",[0,1]),Array.isArray(o.value)?o.value.length>2?o.value=o.value.slice(2):o.length===0?o.value=[0,1]:o.length<2?(s=parseFloat(o.value[0]),o.value=[s,s+1]):o.value=[parseFloat(o.value[0]),parseFloat(o.value[1])]:h(o.value)&&(s=parseFloat(o.value),o.value=[s,s+1])):(f("contours.value",0),h(o.value)||(Array.isArray(o.value)?o.value=parseFloat(o.value[0]):o.value=0))}},{"../../components/color":367,"../../constants/filter_ops":487,"./label_defaults":759,"fast-isnumeric":190}],750:[function(t,P,R){var h=t("../../constants/filter_ops"),u=t("fast-isnumeric");P.exports={"[]":T("[]"),"][":T("]["),">":e(">"),"<":e("<"),"=":e("=")};function A(i,n){var a=Array.isArray(n),r;function f(o){return u(o)?+o:null}return h.COMPARISON_OPS2.indexOf(i)!==-1?r=f(a?n[0]:n):h.INTERVAL_OPS.indexOf(i)!==-1?r=a?[f(n[0]),f(n[1])]:[f(n),f(n)]:h.SET_OPS.indexOf(i)!==-1&&(r=a?n.map(f):[f(n)]),r}function T(i){return function(n){n=A(i,n);var a=Math.min(n[0],n[1]),r=Math.max(n[0],n[1]);return{start:a,end:r,size:r-a}}}function e(i){return function(n){return n=A(i,n),{start:n,end:1/0,size:1/0}}}},{"../../constants/filter_ops":487,"fast-isnumeric":190}],751:[function(t,P,R){P.exports=function(u,A,T,e){var i=e("contours.start"),n=e("contours.end"),a=i===!1||n===!1,r=T("contours.size"),f;a?f=A.autocontour=!0:f=T("autocontour",!1),(f||!r)&&T("ncontours")}},{}],752:[function(t,P,R){var h=t("../../lib");P.exports=function(A,T){var e,i,n,a=function(o){return o.reverse()},r=function(o){return o};switch(T){case"=":case"<":return A;case">":for(A.length!==1&&h.warn("Contour data invalid for the specified inequality operation."),i=A[0],e=0;e<i.edgepaths.length;e++)i.edgepaths[e]=a(i.edgepaths[e]);for(e=0;e<i.paths.length;e++)i.paths[e]=a(i.paths[e]);for(e=0;e<i.starts.length;e++)i.starts[e]=a(i.starts[e]);return A;case"][":var f=a;a=r,r=f;case"[]":for(A.length!==2&&h.warn("Contour data invalid for the specified inequality range operation."),i=u(A[0]),n=u(A[1]),e=0;e<i.edgepaths.length;e++)i.edgepaths[e]=a(i.edgepaths[e]);for(e=0;e<i.paths.length;e++)i.paths[e]=a(i.paths[e]);for(e=0;e<i.starts.length;e++)i.starts[e]=a(i.starts[e]);for(;n.edgepaths.length;)i.edgepaths.push(r(n.edgepaths.shift()));for(;n.paths.length;)i.paths.push(r(n.paths.shift()));for(;n.starts.length;)i.starts.push(r(n.starts.shift()));return[i]}};function u(A){return h.extendFlat({},A,{edgepaths:h.extendDeep([],A.edgepaths),paths:h.extendDeep([],A.paths),starts:h.extendDeep([],A.starts)})}},{"../../lib":515}],753:[function(t,P,R){var h=t("../../lib"),u=t("../heatmap/xyz_defaults"),A=t("../scatter/period_defaults"),T=t("./constraint_defaults"),e=t("./contours_defaults"),i=t("./style_defaults"),n=t("../heatmap/label_defaults"),a=t("./attributes");P.exports=function(f,o,s,m){function g(l,b){return h.coerce(f,o,a,l,b)}function p(l){return h.coerce2(f,o,a,l)}var v=u(f,o,g,m);if(!v){o.visible=!1;return}A(f,o,m,g),g("xhoverformat"),g("yhoverformat"),g("text"),g("hovertext"),g("hoverongaps"),g("hovertemplate");var x=g("contours.type")==="constraint";g("connectgaps",h.isArray1D(o.z)),x?T(f,o,g,m,s):(e(f,o,g,p),i(f,o,g,m)),o.contours&&o.contours.coloring==="heatmap"&&n(g,m)}},{"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/xyz_defaults":816,"../scatter/period_defaults":956,"./attributes":744,"./constraint_defaults":749,"./contours_defaults":751,"./style_defaults":765}],754:[function(t,P,R){var h=t("../../lib"),u=t("./constraint_mapping"),A=t("./end_plus");P.exports=function(e,i,n){for(var a=e.type==="constraint"?u[e._operation](e.value):e,r=a.size,f=[],o=A(a),s=n.trace._carpetTrace,m=s?{xaxis:s.aaxis,yaxis:s.baxis,x:n.a,y:n.b}:{xaxis:i.xaxis,yaxis:i.yaxis,x:n.x,y:n.y},g=a.start;g<o;g+=r)if(f.push(h.extendFlat({level:g,crossings:{},starts:[],edgepaths:[],paths:[],z:n.z,smoothing:n.trace.line.smoothing},m)),f.length>1e3){h.warn("Too many contours, clipping at 1000",e);break}return f}},{"../../lib":515,"./constraint_mapping":750,"./end_plus":755}],755:[function(t,P,R){P.exports=function(u){return u.end+u.size/1e6}},{}],756:[function(t,P,R){var h=t("../../lib"),u=t("./constants");P.exports=function(r,f,o){var s,m,g,p,v;for(f=f||.01,o=o||.01,g=0;g<r.length;g++){for(p=r[g],v=0;v<p.starts.length;v++)m=p.starts[v],e(p,m,"edge",f,o);for(s=0;Object.keys(p.crossings).length&&s<1e4;)s++,m=Object.keys(p.crossings)[0].split(",").map(Number),e(p,m,void 0,f,o);s===1e4&&h.log("Infinite loop in contour?")}};function A(a,r,f,o){return Math.abs(a[0]-r[0])<f&&Math.abs(a[1]-r[1])<o}function T(a,r){var f=a[2]-r[2],o=a[3]-r[3];return Math.sqrt(f*f+o*o)}function e(a,r,f,o,s){var m=r.join(","),g=a.crossings[m],p=i(g,f,r),v=[n(a,r,[-p[0],-p[1]])],x=a.z.length,l=a.z[0].length,b=r.slice(),c=p.slice(),M;for(M=0;M<1e4;M++){if(g>20?(g=u.CHOOSESADDLE[g][(p[0]||p[1])<0?0:1],a.crossings[m]=u.SADDLEREMAINDER[g]):delete a.crossings[m],p=u.NEWDELTA[g],!p){h.log("Found bad marching index:",g,r,a.level);break}v.push(n(a,r,p)),r[0]+=p[0],r[1]+=p[1],m=r.join(","),A(v[v.length-1],v[v.length-2],o,s)&&v.pop();var _=p[0]&&(r[0]<0||r[0]>l-2)||p[1]&&(r[1]<0||r[1]>x-2),y=r[0]===b[0]&&r[1]===b[1]&&p[0]===c[0]&&p[1]===c[1];if(y||f&&_)break;g=a.crossings[m]}M===1e4&&h.log("Infinite loop in contour?");var w=A(v[0],v[v.length-1],o,s),d=0,C=.2*a.smoothing,S=[],E=0,k,B,z,F,I,O,N,V,H,j,Z;for(M=1;M<v.length;M++)N=T(v[M],v[M-1]),d+=N,S.push(N);var X=d/S.length*C;function re(te){return v[te%v.length]}for(M=v.length-2;M>=E;M--)if(k=S[M],k<X){for(z=0,B=M-1;B>=E&&k+S[B]<X;B--)k+=S[B];if(w&&M===v.length-2)for(z=0;z<B&&k+S[z]<X;z++)k+=S[z];I=M-B+z+1,O=Math.floor((M+B+z+2)/2),!w&&M===v.length-2?F=v[v.length-1]:!w&&B===-1?F=v[0]:I%2?F=re(O):F=[(re(O)[0]+re(O+1)[0])/2,(re(O)[1]+re(O+1)[1])/2],v.splice(B+1,M-B+1,F),M=B+1,z&&(E=z),w&&(M===v.length-2?v[z]=v[v.length-1]:M===0&&(v[v.length-1]=v[0]))}for(v.splice(0,E),M=0;M<v.length;M++)v[M].length=2;if(!(v.length<2))if(w)v.pop(),a.paths.push(v);else{f||h.log("Unclosed interior contour?",a.level,b.join(","),v.join("L"));var ue=!1;for(V=0;V<a.edgepaths.length;V++)if(j=a.edgepaths[V],!ue&&A(j[0],v[v.length-1],o,s)){v.pop(),ue=!0;var K=!1;for(H=0;H<a.edgepaths.length;H++)if(Z=a.edgepaths[H],A(Z[Z.length-1],v[0],o,s)){K=!0,v.shift(),a.edgepaths.splice(V,1),H===V?a.paths.push(v.concat(Z)):(H>V&&H--,a.edgepaths[H]=Z.concat(v,j));break}K||(a.edgepaths[V]=v.concat(j))}for(V=0;V<a.edgepaths.length&&!ue;V++)j=a.edgepaths[V],A(j[j.length-1],v[0],o,s)&&(v.shift(),a.edgepaths[V]=j.concat(v),ue=!0);ue||a.edgepaths.push(v)}}function i(a,r,f){var o=0,s=0;return a>20&&r?a===208||a===1114?o=f[0]===0?1:-1:s=f[1]===0?1:-1:u.BOTTOMSTART.indexOf(a)!==-1?s=1:u.LEFTSTART.indexOf(a)!==-1?o=1:u.TOPSTART.indexOf(a)!==-1?s=-1:o=-1,[o,s]}function n(a,r,f){var o=r[0]+Math.max(f[0],0),s=r[1]+Math.max(f[1],0),m=a.z[s][o],g=a.xaxis,p=a.yaxis;if(f[1]){var v=(a.level-m)/(a.z[s][o+1]-m),x=(v!==1?(1-v)*g.c2l(a.x[o]):0)+(v!==0?v*g.c2l(a.x[o+1]):0);return[g.c2p(g.l2c(x),!0),p.c2p(a.y[s],!0),o+v,s]}else{var l=(a.level-m)/(a.z[s+1][o]-m),b=(l!==1?(1-l)*p.c2l(a.y[s]):0)+(l!==0?l*p.c2l(a.y[s+1]):0);return[g.c2p(a.x[o],!0),p.c2p(p.l2c(b),!0),o,s+l]}}},{"../../lib":515,"./constants":748}],757:[function(t,P,R){var h=t("../../components/color"),u=t("../heatmap/hover");P.exports=function(T,e,i,n,a){a||(a={}),a.isContour=!0;var r=u(T,e,i,n,a);return r&&r.forEach(function(f){var o=f.trace;o.contours.type==="constraint"&&(o.fillcolor&&h.opacity(o.fillcolor)?f.color=h.addOpacity(o.fillcolor,1):o.contours.showlines&&h.opacity(o.line.color)&&(f.color=h.addOpacity(o.line.color,1)))}),r}},{"../../components/color":367,"../heatmap/hover":808}],758:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),calc:t("./calc"),plot:t("./plot").plot,style:t("./style"),colorbar:t("./colorbar"),hoverPoints:t("./hover"),moduleType:"trace",name:"contour",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":744,"./calc":745,"./colorbar":747,"./defaults":753,"./hover":757,"./plot":762,"./style":764}],759:[function(t,P,R){var h=t("../../lib");P.exports=function(A,T,e,i){i||(i={});var n=A("contours.showlabels");if(n){var a=T.font;h.coerceFont(A,"contours.labelfont",{family:a.family,size:a.size,color:e}),A("contours.labelformat")}i.hasHover!==!1&&A("zhoverformat")}},{"../../lib":515}],760:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/colorscale"),A=t("./end_plus");P.exports=function(e){var i=e.contours,n=i.start,a=A(i),r=i.size||1,f=Math.floor((a-n)/r)+1,o=i.coloring==="lines"?0:1,s=u.extractOpts(e);isFinite(r)||(r=1,f=1);var m=s.reversescale?u.flipScale(s.colorscale):s.colorscale,g=m.length,p=new Array(g),v=new Array(g),x,l;if(i.coloring==="heatmap"){var b=s.min,c=s.max;for(l=0;l<g;l++)x=m[l],p[l]=x[0]*(c-b)+b,v[l]=x[1];var M=h.extent([b,c,i.start,i.start+r*(f-1)]),_=M[b<c?0:1],y=M[b<c?1:0];_!==b&&(p.splice(0,0,_),v.splice(0,0,v[0])),y!==c&&(p.push(y),v.push(v[v.length-1]))}else for(l=0;l<g;l++)x=m[l],p[l]=(x[0]*(f+o-1)-o/2)*r+n,v[l]=x[1];return u.makeColorScaleFunc({domain:p,range:v},{noNumericCheck:!0})}},{"../../components/colorscale":379,"./end_plus":755,"@plotly/d3":58}],761:[function(t,P,R){var h=t("./constants");P.exports=function(T){var e=T[0].z,i=e.length,n=e[0].length,a=i===2||n===2,r,f,o,s,m,g,p,v,x;for(f=0;f<i-1;f++)for(s=[],f===0&&(s=s.concat(h.BOTTOMSTART)),f===i-2&&(s=s.concat(h.TOPSTART)),r=0;r<n-1;r++)for(o=s.slice(),r===0&&(o=o.concat(h.LEFTSTART)),r===n-2&&(o=o.concat(h.RIGHTSTART)),m=r+","+f,g=[[e[f][r],e[f][r+1]],[e[f+1][r],e[f+1][r+1]]],x=0;x<T.length;x++)v=T[x],p=u(v.level,g),p&&(v.crossings[m]=p,o.indexOf(p)!==-1&&(v.starts.push([r,f]),a&&o.indexOf(p,o.indexOf(p)+1)!==-1&&v.starts.push([r,f])))};function u(A,T){var e=(T[0][0]>A?0:1)+(T[0][1]>A?0:2)+(T[1][1]>A?0:4)+(T[1][0]>A?0:8);if(e===5||e===10){var i=(T[0][0]+T[0][1]+T[1][0]+T[1][1])/4;return A>i?e===5?713:1114:e===5?104:208}return e===15?0:e}},{"./constants":748}],762:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=t("../../components/drawing"),T=t("../../components/colorscale"),e=t("../../lib/svg_text_utils"),i=t("../../plots/cartesian/axes"),n=t("../../plots/cartesian/set_convert"),a=t("../heatmap/plot"),r=t("./make_crossings"),f=t("./find_all_paths"),o=t("./empty_pathinfo"),s=t("./convert_to_constraints"),m=t("./close_boundaries"),g=t("./constants"),p=g.LABELOPTIMIZER;R.plot=function(w,d,C,S){var E=d.xaxis,k=d.yaxis;u.makeTraceGroups(S,C,"contour").each(function(B){var z=h.select(this),F=B[0],I=F.trace,O=F.x,N=F.y,V=I.contours,H=o(V,d,F),j=u.ensureSingle(z,"g","heatmapcoloring"),Z=[];V.coloring==="heatmap"&&(Z=[B]),a(w,d,Z,j),r(H),f(H);var X=E.c2p(O[0],!0),re=E.c2p(O[O.length-1],!0),ue=k.c2p(N[0],!0),K=k.c2p(N[N.length-1],!0),te=[[X,K],[re,K],[re,ue],[X,ue]],G=H;V.type==="constraint"&&(G=s(H,V._operation)),v(z,te,V),x(z,G,te,V),b(z,H,w,F,V),M(z,d,w,F,te)})};function v(y,w,d){var C=u.ensureSingle(y,"g","contourbg"),S=C.selectAll("path").data(d.coloring==="fill"?[0]:[]);S.enter().append("path"),S.exit().remove(),S.attr("d","M"+w.join("L")+"Z").style("stroke","none")}function x(y,w,d,C){var S=C.coloring==="fill"||C.type==="constraint"&&C._operation!=="=",E="M"+d.join("L")+"Z";S&&m(w,C);var k=u.ensureSingle(y,"g","contourfill"),B=k.selectAll("path").data(S?w:[]);B.enter().append("path"),B.exit().remove(),B.each(function(z){var F=(z.prefixBoundary?E:"")+l(z,d);F?h.select(this).attr("d",F).style("stroke","none"):h.select(this).remove()})}function l(y,w){var d="",C=0,S=y.edgepaths.map(function(X,re){return re}),E=!0,k,B,z,F,I,O;function N(X){return Math.abs(X[1]-w[0][1])<.01}function V(X){return Math.abs(X[1]-w[2][1])<.01}function H(X){return Math.abs(X[0]-w[0][0])<.01}function j(X){return Math.abs(X[0]-w[2][0])<.01}for(;S.length;){for(O=A.smoothopen(y.edgepaths[C],y.smoothing),d+=E?O:O.replace(/^M/,"L"),S.splice(S.indexOf(C),1),k=y.edgepaths[C][y.edgepaths[C].length-1],F=-1,z=0;z<4;z++){if(!k){u.log("Missing end?",C,y);break}for(N(k)&&!j(k)?B=w[1]:H(k)?B=w[0]:V(k)?B=w[3]:j(k)&&(B=w[2]),I=0;I<y.edgepaths.length;I++){var Z=y.edgepaths[I][0];Math.abs(k[0]-B[0])<.01?Math.abs(k[0]-Z[0])<.01&&(Z[1]-k[1])*(B[1]-Z[1])>=0&&(B=Z,F=I):Math.abs(k[1]-B[1])<.01?Math.abs(k[1]-Z[1])<.01&&(Z[0]-k[0])*(B[0]-Z[0])>=0&&(B=Z,F=I):u.log("endpt to newendpt is not vert. or horz.",k,B,Z)}if(k=B,F>=0)break;d+="L"+B}if(F===y.edgepaths.length){u.log("unclosed perimeter path");break}C=F,E=S.indexOf(C)===-1,E&&(C=S[0],d+="Z")}for(C=0;C<y.paths.length;C++)d+=A.smoothclosed(y.paths[C],y.smoothing);return d}function b(y,w,d,C,S){var E=u.ensureSingle(y,"g","contourlines"),k=S.showlines!==!1,B=S.showlabels,z=k&&B,F=R.createLines(E,k||B,w),I=R.createLineClip(E,z,d,C.trace.uid),O=y.selectAll("g.contourlabels").data(B?[0]:[]);if(O.exit().remove(),O.enter().append("g").classed("contourlabels",!0),B){var N=[],V=[];u.clearLocationCache();var H=R.labelFormatter(d,C),j=A.tester.append("text").attr("data-notex",1).call(A.font,S.labelfont),Z=w[0].xaxis,X=w[0].yaxis,re=Z._length,ue=X._length,K=Z.range,te=X.range,G=u.aggNums(Math.min,null,C.x),Y=u.aggNums(Math.max,null,C.x),ee=u.aggNums(Math.min,null,C.y),ne=u.aggNums(Math.max,null,C.y),J=Math.max(Z.c2p(G,!0),0),q=Math.min(Z.c2p(Y,!0),re),ae=Math.max(X.c2p(ne,!0),0),le=Math.min(X.c2p(ee,!0),ue),ie={};K[0]<K[1]?(ie.left=J,ie.right=q):(ie.left=q,ie.right=J),te[0]<te[1]?(ie.top=ae,ie.bottom=le):(ie.top=le,ie.bottom=ae),ie.middle=(ie.top+ie.bottom)/2,ie.center=(ie.left+ie.right)/2,N.push([[ie.left,ie.top],[ie.right,ie.top],[ie.right,ie.bottom],[ie.left,ie.bottom]]);var se=Math.sqrt(re*re+ue*ue),xe=g.LABELDISTANCE*se/Math.max(1,w.length/g.LABELINCREASE);F.each(function(oe){var he=R.calcTextOpts(oe.level,H,j,d);h.select(this).selectAll("path").each(function(){var be=this,me=u.getVisibleSegment(be,ie,he.height/2);if(!!me&&!(me.len<(he.width+he.height)*g.LABELMIN))for(var _e=Math.min(Math.ceil(me.len/xe),g.LABELMAX),Se=0;Se<_e;Se++){var De=R.findBestTextLocation(be,me,he,V,ie);if(!De)break;R.addLabelData(De,he,V,N)}})}),j.remove(),R.drawLabels(O,V,d,I,z?N:null)}B&&!k&&F.remove()}R.createLines=function(y,w,d){var C=d[0].smoothing,S=y.selectAll("g.contourlevel").data(w?d:[]);if(S.exit().remove(),S.enter().append("g").classed("contourlevel",!0),w){var E=S.selectAll("path.openline").data(function(B){return B.pedgepaths||B.edgepaths});E.exit().remove(),E.enter().append("path").classed("openline",!0),E.attr("d",function(B){return A.smoothopen(B,C)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var k=S.selectAll("path.closedline").data(function(B){return B.ppaths||B.paths});k.exit().remove(),k.enter().append("path").classed("closedline",!0),k.attr("d",function(B){return A.smoothclosed(B,C)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return S},R.createLineClip=function(y,w,d,C){var S=d._fullLayout._clips,E=w?"clipline"+C:null,k=S.selectAll("#"+E).data(w?[0]:[]);return k.exit().remove(),k.enter().append("clipPath").classed("contourlineclip",!0).attr("id",E),A.setClipUrl(y,E,d),k},R.labelFormatter=function(y,w){var d=y._fullLayout,C=w.trace,S=C.contours,E={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(S.labelformat)E.tickformat=S.labelformat,n(E,d);else{var k=T.extractOpts(C);if(k&&k.colorbar&&k.colorbar._axis)E=k.colorbar._axis;else{if(S.type==="constraint"){var B=S.value;Array.isArray(B)?E.range=[B[0],B[B.length-1]]:E.range=[B,B]}else E.range=[S.start,S.end],E.nticks=(S.end-S.start)/S.size;E.range[0]===E.range[1]&&(E.range[1]+=E.range[0]||1),E.nticks||(E.nticks=1e3),n(E,d),i.prepTicks(E),E._tmin=null,E._tmax=null}}return function(z){return i.tickText(E,z).text}},R.calcTextOpts=function(y,w,d,C){var S=w(y);d.text(S).call(e.convertToTspans,C);var E=d.node(),k=A.bBox(E,!0);return{text:S,width:k.width,height:k.height,fontSize:+E.style["font-size"].replace("px",""),level:y,dy:(k.top+k.bottom)/2}},R.findBestTextLocation=function(y,w,d,C,S){var E=d.width,k,B,z,F,I;w.isClosed?(B=w.len/p.INITIALSEARCHPOINTS,k=w.min+B/2,z=w.max):(B=(w.len-E)/(p.INITIALSEARCHPOINTS+1),k=w.min+B+E/2,z=w.max-(B+E)/2);for(var O=1/0,N=0;N<p.ITERATIONS;N++){for(var V=k;V<z;V+=B){var H=u.getTextLocation(y,w.total,V,E),j=c(H,d,C,S);j<O&&(O=j,I=H,F=V)}if(O>p.MAXCOST*2)break;N&&(B/=2),k=F-B/2,z=k+B*1.5}if(O<=p.MAXCOST)return I};function c(y,w,d,C){var S=w.width/2,E=w.height/2,k=y.x,B=y.y,z=y.theta,F=Math.cos(z)*S,I=Math.sin(z)*S,O=(k>C.center?C.right-k:k-C.left)/(F+Math.abs(Math.sin(z)*E)),N=(B>C.middle?C.bottom-B:B-C.top)/(Math.abs(I)+Math.cos(z)*E);if(O<1||N<1)return 1/0;var V=p.EDGECOST*(1/(O-1)+1/(N-1));V+=p.ANGLECOST*z*z;for(var H=k-F,j=B-I,Z=k+F,X=B+I,re=0;re<d.length;re++){var ue=d[re],K=Math.cos(ue.theta)*ue.width/2,te=Math.sin(ue.theta)*ue.width/2,G=u.segmentDistance(H,j,Z,X,ue.x-K,ue.y-te,ue.x+K,ue.y+te)*2/(w.height+ue.height),Y=ue.level===w.level,ee=Y?p.SAMELEVELDISTANCE:1;if(G<=ee)return 1/0;var ne=p.NEIGHBORCOST*(Y?p.SAMELEVELFACTOR:1);V+=ne/(G-ee)}return V}R.addLabelData=function(y,w,d,C){var S=w.fontSize,E=w.width+S/3,k=Math.max(0,w.height-S/3),B=y.x,z=y.y,F=y.theta,I=Math.sin(F),O=Math.cos(F),N=function(H,j){return[B+H*O-j*I,z+H*I+j*O]},V=[N(-E/2,-k/2),N(-E/2,k/2),N(E/2,k/2),N(E/2,-k/2)];d.push({text:w.text,x:B,y:z,dy:w.dy,theta:F,level:w.level,width:E,height:k}),C.push(V)},R.drawLabels=function(y,w,d,C,S){var E=y.selectAll("text").data(w,function(F){return F.text+","+F.x+","+F.y+","+F.theta});if(E.exit().remove(),E.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(F){var I=F.x+Math.sin(F.theta)*F.dy,O=F.y-Math.cos(F.theta)*F.dy;h.select(this).text(F.text).attr({x:I,y:O,transform:"rotate("+180*F.theta/Math.PI+" "+I+" "+O+")"}).call(e.convertToTspans,d)}),S){for(var k="",B=0;B<S.length;B++)k+="M"+S[B].join("L")+"Z";var z=u.ensureSingle(C,"path","");z.attr("d",k)}};function M(y,w,d,C,S){var E=C.trace,k=d._fullLayout._clips,B="clip"+E.uid,z=k.selectAll("#"+B).data(E.connectgaps?[]:[0]);if(z.enter().append("clipPath").classed("contourclip",!0).attr("id",B),z.exit().remove(),E.connectgaps===!1){var F={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:w.xaxis,yaxis:w.yaxis,x:C.x,y:C.y,z:_(C),smoothing:0};r([F]),f([F]),m([F],{type:"levels"});var I=u.ensureSingle(z,"path","");I.attr("d",(F.prefixBoundary?"M"+S.join("L")+"Z":"")+l(F,S))}else B=null;A.setClipUrl(y,B,d)}function _(y){var w=y.trace._emptypoints,d=[],C=y.z.length,S=y.z[0].length,E,k=[],B;for(E=0;E<S;E++)k.push(1);for(E=0;E<C;E++)d.push(k.slice());for(E=0;E<w.length;E++)B=w[E],d[B[0]][B[1]]=0;return y.zmask=d,d}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/set_convert":585,"../heatmap/plot":813,"./close_boundaries":746,"./constants":748,"./convert_to_constraints":752,"./empty_pathinfo":754,"./find_all_paths":756,"./make_crossings":761,"@plotly/d3":58}],763:[function(t,P,R){var h=t("../../plots/cartesian/axes"),u=t("../../lib");P.exports=function(e,i){var n=e.contours;if(e.autocontour){var a=e.zmin,r=e.zmax;(e.zauto||a===void 0)&&(a=u.aggNums(Math.min,null,i)),(e.zauto||r===void 0)&&(r=u.aggNums(Math.max,null,i));var f=A(a,r,e.ncontours);n.size=f.dtick,n.start=h.tickFirst(f),f.range.reverse(),n.end=h.tickFirst(f),n.start===a&&(n.start+=n.size),n.end===r&&(n.end-=n.size),n.start>n.end&&(n.start=n.end=(n.start+n.end)/2),e._input.contours||(e._input.contours={}),u.extendFlat(e._input.contours,{start:n.start,end:n.end,size:n.size}),e._input.autocontour=!0}else if(n.type!=="constraint"){var o=n.start,s=n.end,m=e._input.contours;if(o>s&&(n.start=m.start=s,s=n.end=m.end=o,o=n.start),!(n.size>0)){var g;o===s?g=1:g=A(o,s,e.ncontours).dtick,m.size=n.size=g}}};function A(T,e,i){var n={type:"linear",range:[T,e]};return h.autoTicks(n,(e-T)/(i||15)),n}},{"../../lib":515,"../../plots/cartesian/axes":566}],764:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/drawing"),A=t("../heatmap/style"),T=t("./make_color_map");P.exports=function(i){var n=h.select(i).selectAll("g.contour");n.style("opacity",function(a){return a[0].trace.opacity}),n.each(function(a){var r=h.select(this),f=a[0].trace,o=f.contours,s=f.line,m=o.size||1,g=o.start,p=o.type==="constraint",v=!p&&o.coloring==="lines",x=!p&&o.coloring==="fill",l=v||x?T(f):null;r.selectAll("g.contourlevel").each(function(M){h.select(this).selectAll("path").call(u.lineGroupStyle,s.width,v?l(M.level):s.color,s.dash)});var b=o.labelfont;if(r.selectAll("g.contourlabels text").each(function(M){u.font(h.select(this),{family:b.family,size:b.size,color:b.color||(v?l(M.level):s.color)})}),p)r.selectAll("g.contourfill path").style("fill",f.fillcolor);else if(x){var c;r.selectAll("g.contourfill path").style("fill",function(M){return c===void 0&&(c=M.level),l(M.level+.5*m)}),c===void 0&&(c=g),r.selectAll("g.contourbg path").style("fill",l(c-.5*m))}}),A(i)}},{"../../components/drawing":389,"../heatmap/style":814,"./make_color_map":760,"@plotly/d3":58}],765:[function(t,P,R){var h=t("../../components/colorscale/defaults"),u=t("./label_defaults");P.exports=function(T,e,i,n,a){var r=i("contours.coloring"),f,o="";r==="fill"&&(f=i("contours.showlines")),f!==!1&&(r!=="lines"&&(o=i("line.color","#000")),i("line.width",.5),i("line.dash")),r!=="none"&&(T.showlegend!==!0&&(e.showlegend=!1),e._dfltShowLegend=!1,h(T,e,n,i,{prefix:"",cLetter:"z"})),i("line.smoothing"),u(i,n,o,a)}},{"../../components/colorscale/defaults":377,"./label_defaults":759}],766:[function(t,P,R){var h=t("../heatmap/attributes"),u=t("../contour/attributes"),A=t("../../components/colorscale/attributes"),T=t("../../lib/extend").extendFlat,e=u.contours;P.exports=T({carpet:{valType:"string",editType:"calc"},z:h.z,a:h.x,a0:h.x0,da:h.dx,b:h.y,b0:h.y0,db:h.dy,text:h.text,hovertext:h.hovertext,transpose:h.transpose,atype:h.xtype,btype:h.ytype,fillcolor:u.fillcolor,autocontour:u.autocontour,ncontours:u.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:u.line.color,width:u.line.width,dash:u.line.dash,smoothing:u.line.smoothing,editType:"plot"},transforms:void 0},A("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../contour/attributes":744,"../heatmap/attributes":801}],767:[function(t,P,R){var h=t("../../components/colorscale/calc"),u=t("../../lib"),A=t("../heatmap/convert_column_xyz"),T=t("../heatmap/clean_2d_array"),e=t("../heatmap/interp2d"),i=t("../heatmap/find_empties"),n=t("../heatmap/make_bound_array"),a=t("./defaults"),r=t("../carpet/lookup_carpetid"),f=t("../contour/set_contours");P.exports=function(m,g){var p=g._carpetTrace=r(m,g);if(!(!p||!p.visible||p.visible==="legendonly")){if(!g.a||!g.b){var v=m.data[p.index],x=m.data[g.index];x.a||(x.a=v.a),x.b||(x.b=v.b),a(x,g,g._defaultColor,m._fullLayout)}var l=o(m,g);return f(g,g._z),l}};function o(s,m){var g=m._carpetTrace,p=g.aaxis,v=g.baxis,x,l,b,c,M,_,y;p._minDtick=0,v._minDtick=0,u.isArray1D(m.z)&&A(m,p,v,"a","b",["z"]),x=m._a=m._a||m.a,c=m._b=m._b||m.b,x=x?p.makeCalcdata(m,"_a"):[],c=c?v.makeCalcdata(m,"_b"):[],l=m.a0||0,b=m.da||1,M=m.b0||0,_=m.db||1,y=m._z=T(m._z||m.z,m.transpose),m._emptypoints=i(y),e(y,m._emptypoints);var w=u.maxRowLength(y),d=m.xtype==="scaled"?"":x,C=n(m,d,l,b,w,p),S=m.ytype==="scaled"?"":c,E=n(m,S,M,_,y.length,v),k={a:C,b:E,z:y};return m.contours.type==="levels"&&m.contours.coloring!=="none"&&h(s,m,{vals:y,containerStr:"",cLetter:"z"}),[k]}},{"../../components/colorscale/calc":375,"../../lib":515,"../carpet/lookup_carpetid":717,"../contour/set_contours":763,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"../heatmap/find_empties":807,"../heatmap/interp2d":810,"../heatmap/make_bound_array":812,"./defaults":768}],768:[function(t,P,R){var h=t("../../lib"),u=t("../heatmap/xyz_defaults"),A=t("./attributes"),T=t("../contour/constraint_defaults"),e=t("../contour/contours_defaults"),i=t("../contour/style_defaults");P.exports=function(a,r,f,o){function s(v,x){return h.coerce(a,r,A,v,x)}function m(v){return h.coerce2(a,r,A,v)}if(s("carpet"),a.a&&a.b){var g=u(a,r,s,o,"a","b");if(!g){r.visible=!1;return}s("text");var p=s("contours.type")==="constraint";p?T(a,r,s,o,f,{hasHover:!1}):(e(a,r,s,m),i(a,r,s,o,{hasHover:!1}))}else r._defaultColor=f,r._length=null}},{"../../lib":515,"../contour/constraint_defaults":749,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/xyz_defaults":816,"./attributes":766}],769:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../contour/colorbar"),calc:t("./calc"),plot:t("./plot"),style:t("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"../contour/colorbar":747,"../contour/style":764,"./attributes":766,"./calc":767,"./defaults":768,"./plot":770}],770:[function(t,P,R){var h=t("@plotly/d3"),u=t("../carpet/map_1d_array"),A=t("../carpet/makepath"),T=t("../../components/drawing"),e=t("../../lib"),i=t("../contour/make_crossings"),n=t("../contour/find_all_paths"),a=t("../contour/plot"),r=t("../contour/constants"),f=t("../contour/convert_to_constraints"),o=t("../contour/empty_pathinfo"),s=t("../contour/close_boundaries"),m=t("../carpet/lookup_carpetid"),g=t("../carpet/axis_aligned_line");P.exports=function(d,C,S,E){var k=C.xaxis,B=C.yaxis;e.makeTraceGroups(E,S,"contour").each(function(z){var F=h.select(this),I=z[0],O=I.trace,N=O._carpetTrace=m(d,O),V=d.calcdata[N.index][0];if(!N.visible||N.visible==="legendonly")return;var H=I.a,j=I.b,Z=O.contours,X=o(Z,C,I),re=Z.type==="constraint",ue=Z._operation,K=re?ue==="="?"lines":"fill":Z.coloring;function te(xe){var oe=N.ab2xy(xe[0],xe[1],!0);return[k.c2p(oe[0]),B.c2p(oe[1])]}var G=[[H[0],j[j.length-1]],[H[H.length-1],j[j.length-1]],[H[H.length-1],j[0]],[H[0],j[0]]];i(X);var Y=(H[H.length-1]-H[0])*1e-8,ee=(j[j.length-1]-j[0])*1e-8;n(X,Y,ee);var ne=X;Z.type==="constraint"&&(ne=f(X,ue)),p(X,te);var J,q,ae,le,ie=[];for(le=V.clipsegments.length-1;le>=0;le--)J=V.clipsegments[le],q=u([],J.x,k.c2p),ae=u([],J.y,B.c2p),q.reverse(),ae.reverse(),ie.push(A(q,ae,J.bicubic));var se="M"+ie.join("L")+"Z";M(F,V.clipsegments,k,B,re,K),_(O,F,k,B,ne,G,te,N,V,K,se),v(F,X,d,I,Z,C,N),T.setClipUrl(F,N._clipPathId,d)})};function p(w,d){var C,S,E,k,B,z,F,I,O;for(C=0;C<w.length;C++){for(k=w[C],B=k.pedgepaths=[],z=k.ppaths=[],S=0;S<k.edgepaths.length;S++){for(O=k.edgepaths[S],F=[],E=0;E<O.length;E++)F[E]=d(O[E]);B.push(F)}for(S=0;S<k.paths.length;S++){for(O=k.paths[S],I=[],E=0;E<O.length;E++)I[E]=d(O[E]);z.push(I)}}}function v(w,d,C,S,E,k,B){var z=e.ensureSingle(w,"g","contourlines"),F=E.showlines!==!1,I=E.showlabels,O=F&&I,N=a.createLines(z,F||I,d),V=a.createLineClip(z,O,C,S.trace.uid),H=w.selectAll("g.contourlabels").data(I?[0]:[]);if(H.exit().remove(),H.enter().append("g").classed("contourlabels",!0),I){var j=k.xaxis,Z=k.yaxis,X=j._length,re=Z._length,ue=[[[0,0],[X,0],[X,re],[0,re]]],K=[];e.clearLocationCache();var te=a.labelFormatter(C,S),G=T.tester.append("text").attr("data-notex",1).call(T.font,E.labelfont),Y={left:0,right:X,center:X/2,top:0,bottom:re,middle:re/2},ee=Math.sqrt(X*X+re*re),ne=r.LABELDISTANCE*ee/Math.max(1,d.length/r.LABELINCREASE);N.each(function(J){var q=a.calcTextOpts(J.level,te,G,C);h.select(this).selectAll("path").each(function(ae){var le=this,ie=e.getVisibleSegment(le,Y,q.height/2);if(!!ie&&(x(le,ae,J,ie,B,q.height),!(ie.len<(q.width+q.height)*r.LABELMIN)))for(var se=Math.min(Math.ceil(ie.len/ne),r.LABELMAX),xe=0;xe<se;xe++){var oe=a.findBestTextLocation(le,ie,q,K,Y);if(!oe)break;a.addLabelData(oe,q,K,ue)}})}),G.remove(),a.drawLabels(H,K,C,V,O?ue:null)}I&&!F&&N.remove()}function x(w,d,C,S,E,k){for(var B,z=0;z<C.pedgepaths.length;z++)d===C.pedgepaths[z]&&(B=C.edgepaths[z]);if(!B)return;var F=E.a[0],I=E.a[E.a.length-1],O=E.b[0],N=E.b[E.b.length-1];function V(re,ue){var K=0,te,G=.1;return(Math.abs(re[0]-F)<G||Math.abs(re[0]-I)<G)&&(te=b(E.dxydb_rough(re[0],re[1],G)),K=Math.max(K,k*c(ue,te)/2)),(Math.abs(re[1]-O)<G||Math.abs(re[1]-N)<G)&&(te=b(E.dxyda_rough(re[0],re[1],G)),K=Math.max(K,k*c(ue,te)/2)),K}var H=l(w,0,1),j=l(w,S.total,S.total-1),Z=V(B[0],H),X=S.total-V(B[B.length-1],j);S.min<Z&&(S.min=Z),S.max>X&&(S.max=X),S.len=S.max-S.min}function l(w,d,C){var S=w.getPointAtLength(d),E=w.getPointAtLength(C),k=E.x-S.x,B=E.y-S.y,z=Math.sqrt(k*k+B*B);return[k/z,B/z]}function b(w){var d=Math.sqrt(w[0]*w[0]+w[1]*w[1]);return[w[0]/d,w[1]/d]}function c(w,d){var C=Math.abs(w[0]*d[0]+w[1]*d[1]),S=Math.sqrt(1-C*C);return S/C}function M(w,d,C,S,E,k){var B,z,F,I,O=e.ensureSingle(w,"g","contourbg"),N=O.selectAll("path").data(k==="fill"&&!E?[0]:[]);N.enter().append("path"),N.exit().remove();var V=[];for(I=0;I<d.length;I++)B=d[I],z=u([],B.x,C.c2p),F=u([],B.y,S.c2p),V.push(A(z,F,B.bicubic));N.attr("d","M"+V.join("L")+"Z").style("stroke","none")}function _(w,d,C,S,E,k,B,z,F,I,O){var N=I==="fill";N&&s(E,w.contours);var V=e.ensureSingle(d,"g","contourfill"),H=V.selectAll("path").data(N?E:[]);H.enter().append("path"),H.exit().remove(),H.each(function(j){var Z=(j.prefixBoundary?O:"")+y(w,j,k,B,z,F,C,S);Z?h.select(this).attr("d",Z).style("stroke","none"):h.select(this).remove()})}function y(w,d,C,S,E,k,B,z){var F,I="",O=d.edgepaths.map(function(ae,le){return le}),N=!0,V,H,j,Z,X,re,ue=Math.abs(C[0][0]-C[2][0])*1e-4,K=Math.abs(C[0][1]-C[2][1])*1e-4;function te(ae){return Math.abs(ae[1]-C[0][1])<K}function G(ae){return Math.abs(ae[1]-C[2][1])<K}function Y(ae){return Math.abs(ae[0]-C[0][0])<ue}function ee(ae){return Math.abs(ae[0]-C[2][0])<ue}function ne(ae,le){var ie,se,xe,oe,he="";for(te(ae)&&!ee(ae)||G(ae)&&!Y(ae)?(oe=E.aaxis,xe=g(E,k,[ae[0],le[0]],.5*(ae[1]+le[1]))):(oe=E.baxis,xe=g(E,k,.5*(ae[0]+le[0]),[ae[1],le[1]])),ie=1;ie<xe.length;ie++)for(he+=oe.smoothing?"C":"L",se=0;se<xe[ie].length;se++){var be=xe[ie][se];he+=[B.c2p(be[0]),z.c2p(be[1])]+" "}return he}for(F=0,V=null;O.length;){var J=d.edgepaths[F][0];for(V&&(I+=ne(V,J)),re=T.smoothopen(d.edgepaths[F].map(S),d.smoothing),I+=N?re:re.replace(/^M/,"L"),O.splice(O.indexOf(F),1),V=d.edgepaths[F][d.edgepaths[F].length-1],Z=-1,j=0;j<4;j++){if(!V){e.log("Missing end?",F,d);break}for(te(V)&&!ee(V)?H=C[1]:Y(V)?H=C[0]:G(V)?H=C[3]:ee(V)&&(H=C[2]),X=0;X<d.edgepaths.length;X++){var q=d.edgepaths[X][0];Math.abs(V[0]-H[0])<ue?Math.abs(V[0]-q[0])<ue&&(q[1]-V[1])*(H[1]-q[1])>=0&&(H=q,Z=X):Math.abs(V[1]-H[1])<K?Math.abs(V[1]-q[1])<K&&(q[0]-V[0])*(H[0]-q[0])>=0&&(H=q,Z=X):e.log("endpt to newendpt is not vert. or horz.",V,H,q)}if(Z>=0)break;I+=ne(V,H),V=H}if(Z===d.edgepaths.length){e.log("unclosed perimeter path");break}F=Z,N=O.indexOf(F)===-1,N&&(F=O[0],I+=ne(V,H)+"Z",V=null)}for(F=0;F<d.paths.length;F++)I+=T.smoothclosed(d.paths[F].map(S),d.smoothing);return I}},{"../../components/drawing":389,"../../lib":515,"../carpet/axis_aligned_line":701,"../carpet/lookup_carpetid":717,"../carpet/makepath":718,"../carpet/map_1d_array":719,"../contour/close_boundaries":746,"../contour/constants":748,"../contour/convert_to_constraints":752,"../contour/empty_pathinfo":754,"../contour/find_all_paths":756,"../contour/make_crossings":761,"../contour/plot":762,"@plotly/d3":58}],771:[function(t,P,R){var h=t("../../components/colorscale/attributes"),u=t("../../plots/template_attributes").hovertemplateAttrs,A=t("../../plots/attributes"),T=t("../scattermapbox/attributes"),e=t("../../lib/extend").extendFlat;P.exports=e({lon:T.lon,lat:T.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:T.text,hovertext:T.hovertext,hoverinfo:e({},A.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:u(),showlegend:e({},A.showlegend,{dflt:!1})},h("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattermapbox/attributes":1002}],772:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib").isArrayOrTypedArray,A=t("../../constants/numerical").BADNUM,T=t("../../components/colorscale/calc"),e=t("../../lib")._;P.exports=function(n,a){for(var r=a._length,f=new Array(r),o=a.z,s=u(o)&&o.length,m=0;m<r;m++){var g=f[m]={},p=a.lon[m],v=a.lat[m];if(g.lonlat=h(p)&&h(v)?[+p,+v]:[A,A],s){var x=o[m];g.z=h(x)?x:A}}return T(n,a,{vals:s?o:[0,1],containerStr:"",cLetter:"z"}),r&&(f[0].t={labels:{lat:e(n,"lat:")+" ",lon:e(n,"lon:")+" "}}),f}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],773:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib"),A=t("../../components/color"),T=t("../../components/colorscale"),e=t("../../constants/numerical").BADNUM,i=t("../../lib/geojson_utils").makeBlank;P.exports=function(a){var r=a[0].trace,f=r.visible===!0&&r._length!==0,o={layout:{visibility:"none"},paint:{}},s=r._opts={heatmap:o,geojson:i()};if(!f)return s;var m=[],g,p=r.z,v=r.radius,x=u.isArrayOrTypedArray(p)&&p.length,l=u.isArrayOrTypedArray(v);for(g=0;g<a.length;g++){var b=a[g],c=b.lonlat;if(c[0]!==e){var M={};if(x){var _=b.z;M.z=_!==e?_:0}l&&(M.r=h(v[g])&&v[g]>0?+v[g]:0),m.push({type:"Feature",geometry:{type:"Point",coordinates:c},properties:M})}}var y=T.extractOpts(r),w=y.reversescale?T.flipScale(y.colorscale):y.colorscale,d=w[0][1],C=A.opacity(d)<1?d:A.addOpacity(d,0),S=["interpolate",["linear"],["heatmap-density"],0,C];for(g=1;g<w.length;g++)S.push(w[g][0],w[g][1]);var E=["interpolate",["linear"],["get","z"],y.min,0,y.max,1];return u.extendFlat(s.heatmap.paint,{"heatmap-weight":x?E:1/(y.max-y.min),"heatmap-color":S,"heatmap-radius":l?{type:"identity",property:"r"}:r.radius,"heatmap-opacity":r.opacity}),s.geojson={type:"FeatureCollection",features:m},s.heatmap.layout.visibility="visible",s}},{"../../components/color":367,"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"fast-isnumeric":190}],774:[function(t,P,R){var h=t("../../lib"),u=t("../../components/colorscale/defaults"),A=t("./attributes");P.exports=function(e,i,n,a){function r(m,g){return h.coerce(e,i,A,m,g)}var f=r("lon")||[],o=r("lat")||[],s=Math.min(f.length,o.length);if(!s){i.visible=!1;return}i._length=s,r("z"),r("radius"),r("below"),r("text"),r("hovertext"),r("hovertemplate"),u(e,i,a,r,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":771}],775:[function(t,P,R){P.exports=function(u,A){return u.lon=A.lon,u.lat=A.lat,u.z=A.z,u}},{}],776:[function(t,P,R){var h=t("../../plots/cartesian/axes"),u=t("../scattermapbox/hover").hoverPoints,A=t("../scattermapbox/hover").getExtraText;P.exports=function(e,i,n){var a=u(e,i,n);if(!!a){var r=a[0],f=r.cd,o=f[0].trace,s=f[r.index];if(delete r.color,"z"in s){var m=r.subplot.mockAxis;r.z=s.z,r.zLabel=h.tickText(m,m.c2l(s.z),"hover").text}return r.extraText=A(o,s,f[0].t.labels),[r]}}},{"../../plots/cartesian/axes":566,"../scattermapbox/hover":1007}],777:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../heatmap/colorbar"),formatLabels:t("../scattermapbox/format_labels"),calc:t("./calc"),plot:t("./plot"),hoverPoints:t("./hover"),eventData:t("./event_data"),getBelow:function(h,u){for(var A=u.getMapLayers(),T=0;T<A.length;T++){var e=A[T],i=e.id;if(e.type==="symbol"&&typeof i=="string"&&i.indexOf("plotly-")===-1)return i}},moduleType:"trace",name:"densitymapbox",basePlotModule:t("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":622,"../heatmap/colorbar":804,"../scattermapbox/format_labels":1006,"./attributes":771,"./calc":772,"./defaults":774,"./event_data":775,"./hover":776,"./plot":778}],778:[function(t,P,R){var h=t("./convert"),u=t("../../plots/mapbox/constants").traceLayerPrefix;function A(e,i){this.type="densitymapbox",this.subplot=e,this.uid=i,this.sourceId="source-"+i,this.layerList=[["heatmap",u+i+"-heatmap"]],this.below=null}var T=A.prototype;T.update=function(e){var i=this.subplot,n=this.layerList,a=h(e),r=i.belowLookup["trace-"+this.uid];i.map.getSource(this.sourceId).setData(a.geojson),r!==this.below&&(this._removeLayers(),this._addLayers(a,r),this.below=r);for(var f=0;f<n.length;f++){var o=n[f],s=o[0],m=o[1],g=a[s];i.setOptions(m,"setLayoutProperty",g.layout),g.layout.visibility==="visible"&&i.setOptions(m,"setPaintProperty",g.paint)}},T._addLayers=function(e,i){for(var n=this.subplot,a=this.layerList,r=this.sourceId,f=0;f<a.length;f++){var o=a[f],s=o[0],m=e[s];n.addLayer({type:s,id:o[1],source:r,layout:m.layout,paint:m.paint},i)}},T._removeLayers=function(){for(var e=this.subplot.map,i=this.layerList,n=i.length-1;n>=0;n--)e.removeLayer(i[n][1])},T.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},P.exports=function(i,n){var a=n[0].trace,r=new A(i,a.uid),f=r.sourceId,o=h(n),s=r.below=i.belowLookup["trace-"+a.uid];return i.map.addSource(f,{type:"geojson",data:o.geojson}),r._addLayers(o,s),r}},{"../../plots/mapbox/constants":620,"./convert":773}],779:[function(t,P,R){var h=t("../../lib");P.exports=function(A,T){for(var e=0;e<A.length;e++)A[e].i=e;h.mergeArray(T.text,A,"tx"),h.mergeArray(T.hovertext,A,"htx");var i=T.marker;if(i){h.mergeArray(i.opacity,A,"mo"),h.mergeArray(i.color,A,"mc");var n=i.line;n&&(h.mergeArray(n.color,A,"mlc"),h.mergeArrayCastPositive(n.width,A,"mlw"))}}},{"../../lib":515}],780:[function(t,P,R){var h=t("../bar/attributes"),u=t("../scatter/attributes").line,A=t("../../plots/attributes"),T=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=t("../../plots/template_attributes").hovertemplateAttrs,i=t("../../plots/template_attributes").texttemplateAttrs,n=t("./constants"),a=t("../../lib/extend").extendFlat,r=t("../../components/color");P.exports={x:h.x,x0:h.x0,dx:h.dx,y:h.y,y0:h.y0,dy:h.dy,xperiod:h.xperiod,yperiod:h.yperiod,xperiod0:h.xperiod0,yperiod0:h.yperiod0,xperiodalignment:h.xperiodalignment,yperiodalignment:h.yperiodalignment,xhoverformat:T("x"),yhoverformat:T("y"),hovertext:h.hovertext,hovertemplate:e({},{keys:n.eventDataKeys}),hoverinfo:a({},A.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:i({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),text:h.text,textposition:h.textposition,insidetextanchor:a({},h.insidetextanchor,{dflt:"middle"}),textangle:a({},h.textangle,{dflt:0}),textfont:h.textfont,insidetextfont:h.insidetextfont,outsidetextfont:h.outsidetextfont,constraintext:h.constraintext,cliponaxis:h.cliponaxis,orientation:a({},h.orientation,{}),offset:a({},h.offset,{arrayOk:!1}),width:a({},h.width,{arrayOk:!1}),marker:f(),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:a({},u.color,{dflt:r.defaultLine}),width:a({},u.width,{dflt:0,editType:"plot"}),dash:u.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:h.offsetgroup,alignmentgroup:h.alignmentgroup};function f(){var o=a({},h.marker);return delete o.pattern,o}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":782}],781:[function(t,P,R){var h=t("../../plots/cartesian/axes"),u=t("../../plots/cartesian/align_period"),A=t("./arrays_to_calcdata"),T=t("../scatter/calc_selection"),e=t("../../constants/numerical").BADNUM;P.exports=function(a,r){var f=h.getFromId(a,r.xaxis||"x"),o=h.getFromId(a,r.yaxis||"y"),s,m,g,p,v,x,l,b;r.orientation==="h"?(s=f.makeCalcdata(r,"x"),g=o.makeCalcdata(r,"y"),p=u(r,o,"y",g),v=!!r.yperiodalignment,x="y"):(s=o.makeCalcdata(r,"y"),g=f.makeCalcdata(r,"x"),p=u(r,f,"x",g),v=!!r.xperiodalignment,x="x"),m=p.vals;var c=Math.min(m.length,s.length),M=new Array(c);for(r._base=[],l=0;l<c;l++){s[l]<0&&(s[l]=e);var _=!1;s[l]!==e&&l+1<c&&s[l+1]!==e&&(_=!0),b=M[l]={p:m[l],s:s[l],cNext:_},r._base[l]=-.5*b.s,v&&(M[l].orig_p=g[l],M[l][x+"End"]=p.ends[l],M[l][x+"Start"]=p.starts[l]),r.ids&&(b.id=String(r.ids[l])),l===0&&(M[0].vTotal=0),M[0].vTotal+=i(b.s),b.begR=i(b.s)/i(M[0].s)}var y;for(l=0;l<c;l++)b=M[l],b.s!==e&&(b.sumR=b.s/M[0].vTotal,b.difR=y!==void 0?b.s/y:1,y=b.s);return A(M,r),T(M,r),M};function i(n){return n===e?0:n}},{"../../constants/numerical":491,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":779}],782:[function(t,P,R){P.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],783:[function(t,P,R){var h=t("../bar/cross_trace_calc").setGroupPositions;P.exports=function(A,T){var e=A._fullLayout,i=A._fullData,n=A.calcdata,a=T.xaxis,r=T.yaxis,f=[],o=[],s=[],m,g;for(g=0;g<i.length;g++){var p=i[g],v=p.orientation==="h";p.visible===!0&&p.xaxis===a._id&&p.yaxis===r._id&&p.type==="funnel"&&(m=n[g],v?s.push(m):o.push(m),f.push(m))}var x={mode:e.funnelmode,norm:e.funnelnorm,gap:e.funnelgap,groupgap:e.funnelgroupgap};for(h(A,a,r,o,x),h(A,r,a,s,x),g=0;g<f.length;g++){m=f[g];for(var l=0;l<m.length;l++)l+1<m.length&&(m[l].nextP0=m[l+1].p0,m[l].nextS0=m[l+1].s0,m[l].nextP1=m[l+1].p1,m[l].nextS1=m[l+1].s1)}}},{"../bar/cross_trace_calc":660}],784:[function(t,P,R){var h=t("../../lib"),u=t("../bar/defaults").handleGroupingDefaults,A=t("../bar/defaults").handleText,T=t("../scatter/xy_defaults"),e=t("../scatter/period_defaults"),i=t("./attributes"),n=t("../../components/color");function a(o,s,m,g){function p(_,y){return h.coerce(o,s,i,_,y)}var v=T(o,s,g,p);if(!v){s.visible=!1;return}e(o,s,g,p),p("xhoverformat"),p("yhoverformat"),p("orientation",s.y&&!s.x?"v":"h"),p("offset"),p("width");var x=p("text");p("hovertext"),p("hovertemplate");var l=p("textposition");A(o,s,g,p,l,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),s.textposition!=="none"&&!s.texttemplate&&p("textinfo",Array.isArray(x)?"text+value":"value");var b=p("marker.color",m);p("marker.line.color",n.defaultLine),p("marker.line.width");var c=p("connector.visible");if(c){p("connector.fillcolor",r(b));var M=p("connector.line.width");M&&(p("connector.line.color"),p("connector.line.dash"))}}function r(o){var s=h.isArrayOrTypedArray(o)?"#000":o;return n.addOpacity(s,.5*n.opacity(s))}function f(o,s){var m,g;function p(x){return h.coerce(g._input,g,i,x)}if(s.funnelmode==="group")for(var v=0;v<o.length;v++)g=o[v],m=g._input,u(m,g,s,p)}P.exports={supplyDefaults:a,crossTraceDefaults:f}},{"../../components/color":367,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":780}],785:[function(t,P,R){P.exports=function(u,A){return u.x="xVal"in A?A.xVal:A.x,u.y="yVal"in A?A.yVal:A.y,"percentInitial"in A&&(u.percentInitial=A.percentInitial),"percentPrevious"in A&&(u.percentPrevious=A.percentPrevious),"percentTotal"in A&&(u.percentTotal=A.percentTotal),A.xa&&(u.xaxis=A.xa),A.ya&&(u.yaxis=A.ya),u}},{}],786:[function(t,P,R){var h=t("../../components/color").opacity,u=t("../bar/hover").hoverOnBars,A=t("../../lib").formatPercent;P.exports=function(i,n,a,r,f){var o=u(i,n,a,r,f);if(!!o){var s=o.cd,m=s[0].trace,g=m.orientation==="h",p=o.index,v=s[p],x=g?"x":"y";o[x+"LabelVal"]=v.s,o.percentInitial=v.begR,o.percentInitialLabel=A(v.begR,1),o.percentPrevious=v.difR,o.percentPreviousLabel=A(v.difR,1),o.percentTotal=v.sumR,o.percentTotalLabel=A(v.sumR,1);var l=v.hi||m.hoverinfo,b=[];if(l&&l!=="none"&&l!=="skip"){var c=l==="all",M=l.split("+"),_=function(y){return c||M.indexOf(y)!==-1};_("percent initial")&&b.push(o.percentInitialLabel+" of initial"),_("percent previous")&&b.push(o.percentPreviousLabel+" of previous"),_("percent total")&&b.push(o.percentTotalLabel+" of total")}return o.extraText=b.join("<br>"),o.color=T(m,v),[o]}};function T(e,i){var n=e.marker,a=i.mc||n.color,r=i.mlc||n.line.color,f=i.mlw||n.line.width;if(h(a))return a;if(h(r)&&f)return r}},{"../../components/color":367,"../../lib":515,"../bar/hover":664}],787:[function(t,P,R){P.exports={attributes:t("./attributes"),layoutAttributes:t("./layout_attributes"),supplyDefaults:t("./defaults").supplyDefaults,crossTraceDefaults:t("./defaults").crossTraceDefaults,supplyLayoutDefaults:t("./layout_defaults"),calc:t("./calc"),crossTraceCalc:t("./cross_trace_calc"),plot:t("./plot"),style:t("./style").style,hoverPoints:t("./hover"),eventData:t("./event_data"),selectPoints:t("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:t("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":780,"./calc":781,"./cross_trace_calc":783,"./defaults":784,"./event_data":785,"./hover":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(t,P,R){P.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],789:[function(t,P,R){var h=t("../../lib"),u=t("./layout_attributes");P.exports=function(A,T,e){var i=!1;function n(f,o){return h.coerce(A,T,u,f,o)}for(var a=0;a<e.length;a++){var r=e[a];if(r.visible&&r.type==="funnel"){i=!0;break}}i&&(n("funnelmode"),n("funnelgap",.2),n("funnelgroupgap"))}},{"../../lib":515,"./layout_attributes":788}],790:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=t("../../components/drawing"),T=t("../../constants/numerical").BADNUM,e=t("../bar/plot"),i=t("../bar/uniform_text").clearMinTextSize;P.exports=function(o,s,m,g){var p=o._fullLayout;i("funnel",p),n(o,s,m,g),a(o,s,m,g),e.plot(o,s,m,g,{mode:p.funnelmode,norm:p.funnelmode,gap:p.funnelgap,groupgap:p.funnelgroupgap})};function n(f,o,s,m){var g=o.xaxis,p=o.yaxis;u.makeTraceGroups(m,s,"trace bars").each(function(v){var x=h.select(this),l=v[0].trace,b=u.ensureSingle(x,"g","regions");if(!l.connector||!l.connector.visible){b.remove();return}var c=l.orientation==="h",M=b.selectAll("g.region").data(u.identity);M.enter().append("g").classed("region",!0),M.exit().remove();var _=M.size();M.each(function(y,w){if(!(w!==_-1&&!y.cNext)){var d=r(y,g,p,c),C=d[0],S=d[1],E="";C[0]!==T&&S[0]!==T&&C[1]!==T&&S[1]!==T&&C[2]!==T&&S[2]!==T&&C[3]!==T&&S[3]!==T&&(c?E+="M"+C[0]+","+S[1]+"L"+C[2]+","+S[2]+"H"+C[3]+"L"+C[1]+","+S[1]+"Z":E+="M"+C[1]+","+S[1]+"L"+C[2]+","+S[3]+"V"+S[2]+"L"+C[1]+","+S[0]+"Z"),E===""&&(E="M0,0Z"),u.ensureSingle(h.select(this),"path").attr("d",E).call(A.setClipUrl,o.layerClipId,f)}})})}function a(f,o,s,m){var g=o.xaxis,p=o.yaxis;u.makeTraceGroups(m,s,"trace bars").each(function(v){var x=h.select(this),l=v[0].trace,b=u.ensureSingle(x,"g","lines");if(!l.connector||!l.connector.visible||!l.connector.line.width){b.remove();return}var c=l.orientation==="h",M=b.selectAll("g.line").data(u.identity);M.enter().append("g").classed("line",!0),M.exit().remove();var _=M.size();M.each(function(y,w){if(!(w!==_-1&&!y.cNext)){var d=r(y,g,p,c),C=d[0],S=d[1],E="";C[3]!==void 0&&S[3]!==void 0&&(c?(E+="M"+C[0]+","+S[1]+"L"+C[2]+","+S[2],E+="M"+C[1]+","+S[1]+"L"+C[3]+","+S[2]):(E+="M"+C[1]+","+S[1]+"L"+C[2]+","+S[3],E+="M"+C[1]+","+S[0]+"L"+C[2]+","+S[2])),E===""&&(E="M0,0Z"),u.ensureSingle(h.select(this),"path").attr("d",E).call(A.setClipUrl,o.layerClipId,f)}})})}function r(f,o,s,m){var g=[],p=[],v=m?o:s,x=m?s:o;return g[0]=v.c2p(f.s0,!0),p[0]=x.c2p(f.p0,!0),g[1]=v.c2p(f.s1,!0),p[1]=x.c2p(f.p1,!0),g[2]=v.c2p(f.nextS0,!0),p[2]=x.c2p(f.nextP0,!0),g[3]=v.c2p(f.nextS1,!0),p[3]=x.c2p(f.nextP1,!0),m?[g,p]:[p,g]}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],791:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/drawing"),A=t("../../components/color"),T=t("../../constants/interactions").DESELECTDIM,e=t("../bar/style"),i=t("../bar/uniform_text").resizeText,n=e.styleTextPoints;function a(r,f,o){var s=o||h.select(r).selectAll("g.funnellayer").selectAll("g.trace");i(r,s,"funnel"),s.style("opacity",function(m){return m[0].trace.opacity}),s.each(function(m){var g=h.select(this),p=m[0].trace;g.selectAll(".point > path").each(function(v){if(!v.isBlank){var x=p.marker;h.select(this).call(A.fill,v.mc||x.color).call(A.stroke,v.mlc||x.line.color).call(u.dashLine,x.line.dash,v.mlw||x.line.width).style("opacity",p.selectedpoints&&!v.selected?T:1)}}),n(g,p,r),g.selectAll(".regions").each(function(){h.select(this).selectAll("path").style("stroke-width",0).call(A.fill,p.connector.fillcolor)}),g.selectAll(".lines").each(function(){var v=p.connector.line;u.lineGroupStyle(h.select(this).selectAll("path"),v.width,v.color,v.dash)})})}P.exports={style:a}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],792:[function(t,P,R){var h=t("../pie/attributes"),u=t("../../plots/attributes"),A=t("../../plots/domain").attributes,T=t("../../plots/template_attributes").hovertemplateAttrs,e=t("../../plots/template_attributes").texttemplateAttrs,i=t("../../lib/extend").extendFlat;P.exports={labels:h.labels,label0:h.label0,dlabel:h.dlabel,values:h.values,marker:{colors:h.marker.colors,line:{color:i({},h.marker.line.color,{dflt:null}),width:i({},h.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:h.text,hovertext:h.hovertext,scalegroup:i({},h.scalegroup,{}),textinfo:i({},h.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:i({},u.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:T({},{keys:["label","color","value","text","percent"]}),textposition:i({},h.textposition,{values:["inside","none"],dflt:"inside"}),textfont:h.textfont,insidetextfont:h.insidetextfont,title:{text:h.title.text,font:h.title.font,position:i({},h.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:A({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910}],793:[function(t,P,R){var h=t("../../plots/plots");R.name="funnelarea",R.plot=function(u,A,T,e){h.plotBasePlot(R.name,u,A,T,e)},R.clean=function(u,A,T,e){h.cleanBasePlot(R.name,u,A,T,e)}},{"../../plots/plots":628}],794:[function(t,P,R){var h=t("../pie/calc");function u(T,e){return h.calc(T,e)}function A(T){h.crossTraceCalc(T,{type:"funnelarea"})}P.exports={calc:u,crossTraceCalc:A}},{"../pie/calc":912}],795:[function(t,P,R){var h=t("../../lib"),u=t("./attributes"),A=t("../../plots/domain").defaults,T=t("../bar/defaults").handleText,e=t("../pie/defaults").handleLabelsAndValues;P.exports=function(n,a,r,f){function o(_,y){return h.coerce(n,a,u,_,y)}var s=o("labels"),m=o("values"),g=e(s,m),p=g.len;if(a._hasLabels=g.hasLabels,a._hasValues=g.hasValues,!a._hasLabels&&a._hasValues&&(o("label0"),o("dlabel")),!p){a.visible=!1;return}a._length=p;var v=o("marker.line.width");v&&o("marker.line.color",f.paper_bgcolor),o("marker.colors"),o("scalegroup");var x=o("text"),l=o("texttemplate"),b;if(l||(b=o("textinfo",Array.isArray(x)?"text+percent":"percent")),o("hovertext"),o("hovertemplate"),l||b&&b!=="none"){var c=o("textposition");T(n,a,f,o,c,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}A(a,f,o);var M=o("title.text");M&&(o("title.position"),h.coerceFont(o,"title.font",f.font)),o("aspectratio"),o("baseratio")}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"../pie/defaults":913,"./attributes":792}],796:[function(t,P,R){P.exports={moduleType:"trace",name:"funnelarea",basePlotModule:t("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:t("./attributes"),layoutAttributes:t("./layout_attributes"),supplyDefaults:t("./defaults"),supplyLayoutDefaults:t("./layout_defaults"),calc:t("./calc").calc,crossTraceCalc:t("./calc").crossTraceCalc,plot:t("./plot"),style:t("./style"),styleOne:t("../pie/style_one"),meta:{}}},{"../pie/style_one":921,"./attributes":792,"./base_plot":793,"./calc":794,"./defaults":795,"./layout_attributes":797,"./layout_defaults":798,"./plot":799,"./style":800}],797:[function(t,P,R){var h=t("../pie/layout_attributes").hiddenlabels;P.exports={hiddenlabels:h,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":917}],798:[function(t,P,R){var h=t("../../lib"),u=t("./layout_attributes");P.exports=function(T,e){function i(n,a){return h.coerce(T,e,u,n,a)}i("hiddenlabels"),i("funnelareacolorway",e.colorway),i("extendfunnelareacolors")}},{"../../lib":515,"./layout_attributes":797}],799:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/drawing"),A=t("../../lib"),T=A.strScale,e=A.strTranslate,i=t("../../lib/svg_text_utils"),n=t("../bar/plot"),a=n.toMoveInsideBar,r=t("../bar/uniform_text"),f=r.recordMinTextSize,o=r.clearMinTextSize,s=t("../pie/helpers"),m=t("../pie/plot"),g=m.attachFxHandlers,p=m.determineInsideTextFont,v=m.layoutAreas,x=m.prerenderTitles,l=m.positionTitleOutside,b=m.formatSliceLabel;P.exports=function(w,d){var C=w._context.staticPlot,S=w._fullLayout;o("funnelarea",S),x(d,w),v(d,S._size),A.makeTraceGroups(S._funnelarealayer,d,"trace").each(function(E){var k=h.select(this),B=E[0],z=B.trace;_(E),k.each(function(){var F=h.select(this).selectAll("g.slice").data(E);F.enter().append("g").classed("slice",!0),F.exit().remove(),F.each(function(O,N){if(O.hidden){h.select(this).selectAll("path,g").remove();return}O.pointNumber=O.i,O.curveNumber=z.index;var V=B.cx,H=B.cy,j=h.select(this),Z=j.selectAll("path.surface").data([O]);Z.enter().append("path").classed("surface",!0).style({"pointer-events":C?"none":"all"}),j.call(g,w,E);var X="M"+(V+O.TR[0])+","+(H+O.TR[1])+c(O.TR,O.BR)+c(O.BR,O.BL)+c(O.BL,O.TL)+"Z";Z.attr("d",X),b(w,O,B);var re=s.castOption(z.textposition,O.pts),ue=j.selectAll("g.slicetext").data(O.text&&re!=="none"?[0]:[]);ue.enter().append("g").classed("slicetext",!0),ue.exit().remove(),ue.each(function(){var K=A.ensureSingle(h.select(this),"text","",function(ae){ae.attr("data-notex",1)}),te=A.ensureUniformFontSize(w,p(z,O,S.font));K.text(O.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(u.font,te).call(i.convertToTspans,w);var G=u.bBox(K.node()),Y,ee,ne,J=Math.min(O.BL[1],O.BR[1])+H,q=Math.max(O.TL[1],O.TR[1])+H;ee=Math.max(O.TL[0],O.BL[0])+V,ne=Math.min(O.TR[0],O.BR[0])+V,Y=a(ee,ne,J,q,G,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"}),Y.fontSize=te.size,f(z.type,Y,S),E[N].transform=Y,A.setTransormAndDisplay(K,Y)})});var I=h.select(this).selectAll("g.titletext").data(z.title.text?[0]:[]);I.enter().append("g").classed("titletext",!0),I.exit().remove(),I.each(function(){var O=A.ensureSingle(h.select(this),"text","",function(H){H.attr("data-notex",1)}),N=z.title.text;z._meta&&(N=A.templateString(N,z._meta)),O.text(N).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(u.font,z.title.font).call(i.convertToTspans,w);var V=l(B,S._size);O.attr("transform",e(V.x,V.y)+T(Math.min(1,V.scale))+e(V.tx,V.ty))})})})};function c(y,w){var d=w[0]-y[0],C=w[1]-y[1];return"l"+d+","+C}function M(y,w){return[.5*(y[0]+w[0]),.5*(y[1]+w[1])]}function _(y){if(!y.length)return;var w=y[0],d=w.trace,C=d.aspectratio,S=d.baseratio;S>.999&&(S=.999);var E=Math.pow(S,2),k=w.vTotal,B=k*E/(1-E),z=k,F=B/k;function I(){var le=Math.sqrt(F);return{x:le,y:-le}}function O(){var le=I();return[le.x,le.y]}var N,V=[];V.push(O());var H,j;for(H=y.length-1;H>-1;H--)if(j=y[H],!j.hidden){var Z=j.v/z;F+=Z,V.push(O())}var X=1/0,re=-1/0;for(H=0;H<V.length;H++)N=V[H],X=Math.min(X,N[1]),re=Math.max(re,N[1]);for(H=0;H<V.length;H++)V[H][1]-=(re+X)/2;var ue=V[V.length-1][0],K=w.r,te=(re-X)/2,G=K/ue,Y=K/te*C;for(w.r=Y*te,H=0;H<V.length;H++)V[H][0]*=G,V[H][1]*=Y;N=V[0];var ee=[-N[0],N[1]],ne=[N[0],N[1]],J=0;for(H=y.length-1;H>-1;H--)if(j=y[H],!j.hidden){J+=1;var q=V[J][0],ae=V[J][1];j.TL=[-q,ae],j.TR=[q,ae],j.BL=ee,j.BR=ne,j.pxmid=M(j.TR,j.BR),ee=j.TL,ne=j.TR}}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/plot":668,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"@plotly/d3":58}],800:[function(t,P,R){var h=t("@plotly/d3"),u=t("../pie/style_one"),A=t("../bar/uniform_text").resizeText;P.exports=function(e){var i=e._fullLayout._funnelarealayer.selectAll(".trace");A(e,i,"funnelarea"),i.each(function(n){var a=n[0],r=a.trace,f=h.select(this);f.style({opacity:r.opacity}),f.selectAll("path.surface").each(function(o){h.select(this).call(u,o,r)})})}},{"../bar/uniform_text":673,"../pie/style_one":921,"@plotly/d3":58}],801:[function(t,P,R){var h=t("../scatter/attributes"),u=t("../../plots/attributes"),A=t("../../plots/font_attributes"),T=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=t("../../plots/template_attributes").hovertemplateAttrs,i=t("../../plots/template_attributes").texttemplateAttrs,n=t("../../components/colorscale/attributes"),a=t("../../lib/extend").extendFlat;P.exports=a({z:{valType:"data_array",editType:"calc"},x:a({},h.x,{impliedEdits:{xtype:"array"}}),x0:a({},h.x0,{impliedEdits:{xtype:"scaled"}}),dx:a({},h.dx,{impliedEdits:{xtype:"scaled"}}),y:a({},h.y,{impliedEdits:{ytype:"array"}}),y0:a({},h.y0,{impliedEdits:{ytype:"scaled"}}),dy:a({},h.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:a({},h.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:a({},h.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:a({},h.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:a({},h.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:a({},h.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:a({},h.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:T("x"),yhoverformat:T("y"),zhoverformat:T("z",1),hovertemplate:e(),texttemplate:i({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:A({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:a({},u.showlegend,{dflt:!1})},{transforms:void 0},n("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936}],802:[function(t,P,R){var h=t("../../registry"),u=t("../../lib"),A=t("../../plots/cartesian/axes"),T=t("../../plots/cartesian/align_period"),e=t("../histogram2d/calc"),i=t("../../components/colorscale/calc"),n=t("./convert_column_xyz"),a=t("./clean_2d_array"),r=t("./interp2d"),f=t("./find_empties"),o=t("./make_bound_array"),s=t("../../constants/numerical").BADNUM;P.exports=function(v,x){var l=A.getFromId(v,x.xaxis||"x"),b=A.getFromId(v,x.yaxis||"y"),c=h.traceIs(x,"contour"),M=h.traceIs(x,"histogram"),_=h.traceIs(x,"gl2d"),y=c?"best":x.zsmooth,w,d,C,S,E,k,B,z,F,I,O;if(l._minDtick=0,b._minDtick=0,M)O=e(v,x),S=O.orig_x,w=O.x,d=O.x0,C=O.dx,z=O.orig_y,E=O.y,k=O.y0,B=O.dy,F=O.z;else{var N=x.z;u.isArray1D(N)?(n(x,l,b,"x","y",["z"]),w=x._x,E=x._y,N=x._z):(S=x.x?l.makeCalcdata(x,"x"):[],z=x.y?b.makeCalcdata(x,"y"):[],w=T(x,l,"x",S).vals,E=T(x,b,"y",z).vals,x._x=w,x._y=E),d=x.x0,C=x.dx,k=x.y0,B=x.dy,F=a(N,x,l,b)}(l.rangebreaks||b.rangebreaks)&&(F=g(w,E,F),M||(w=m(w),E=m(E),x._x=w,x._y=E)),!M&&(c||x.connectgaps)&&(x._emptypoints=f(F),r(F,x._emptypoints));function V(ne){y=x._input.zsmooth=x.zsmooth=!1,u.warn('cannot use zsmooth: "fast": '+ne)}if(y==="fast"){if(l.type==="log"||b.type==="log")V("log axis found");else if(!M){if(w.length){var H=(w[w.length-1]-w[0])/(w.length-1),j=Math.abs(H/100);for(I=0;I<w.length-1;I++)if(Math.abs(w[I+1]-w[I]-H)>j){V("x scale is not linear");break}}if(E.length&&y==="fast"){var Z=(E[E.length-1]-E[0])/(E.length-1),X=Math.abs(Z/100);for(I=0;I<E.length-1;I++)if(Math.abs(E[I+1]-E[I]-Z)>X){V("y scale is not linear");break}}}}var re=u.maxRowLength(F),ue=x.xtype==="scaled"?"":w,K=o(x,ue,d,C,re,l),te=x.ytype==="scaled"?"":E,G=o(x,te,k,B,F.length,b);_||(x._extremes[l._id]=A.findExtremes(l,K),x._extremes[b._id]=A.findExtremes(b,G));var Y={x:K,y:G,z:F,text:x._text||x.text,hovertext:x._hovertext||x.hovertext};if(x.xperiodalignment&&S&&(Y.orig_x=S),x.yperiodalignment&&z&&(Y.orig_y=z),ue&&ue.length===K.length-1&&(Y.xCenter=ue),te&&te.length===G.length-1&&(Y.yCenter=te),M&&(Y.xRanges=O.xRanges,Y.yRanges=O.yRanges,Y.pts=O.pts),c||i(v,x,{vals:F,cLetter:"z"}),c&&x.contours&&x.contours.coloring==="heatmap"){var ee={type:x.type==="contour"?"heatmap":"histogram2d",xcalendar:x.xcalendar,ycalendar:x.ycalendar};Y.xfill=o(ee,ue,d,C,re,l),Y.yfill=o(ee,te,k,B,F.length,b)}return[Y]};function m(p){for(var v=[],x=p.length,l=0;l<x;l++){var b=p[l];b!==s&&v.push(b)}return v}function g(p,v,x){for(var l=[],b=-1,c=0;c<x.length;c++)if(v[c]!==s){b++,l[b]=[];for(var M=0;M<x[c].length;M++)p[M]!==s&&l[b].push(x[c][M])}return l}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../../registry":647,"../histogram2d/calc":835,"./clean_2d_array":803,"./convert_column_xyz":805,"./find_empties":807,"./interp2d":810,"./make_bound_array":812}],803:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib"),A=t("../../constants/numerical").BADNUM;P.exports=function(e,i,n,a){var r,f,o,s,m,g;function p(M){if(!!h(M))return+M}if(i&&i.transpose){for(r=0,m=0;m<e.length;m++)r=Math.max(r,e[m].length);if(r===0)return!1;o=function(M){return M.length},s=function(M,_,y){return(M[y]||[])[_]}}else r=e.length,o=function(M,_){return M[_].length},s=function(M,_,y){return(M[_]||[])[y]};var v=function(M,_,y){return _===A||y===A?A:s(M,_,y)};function x(M){if(i&&i.type!=="carpet"&&i.type!=="contourcarpet"&&M&&M.type==="category"&&i["_"+M._id.charAt(0)].length){var _=M._id.charAt(0),y={},w=i["_"+_+"CategoryMap"]||i[_];for(m=0;m<w.length;m++)y[w[m]]=m;return function(d){var C=y[M._categories[d]];return C+1?C:A}}else return u.identity}var l=x(n),b=x(a);a&&a.type==="category"&&(r=a._categories.length);var c=new Array(r);for(m=0;m<r;m++)for(n&&n.type==="category"?f=n._categories.length:f=o(e,m),c[m]=new Array(f),g=0;g<f;g++)c[m][g]=p(v(e,b(m),l(g)));return c}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],804:[function(t,P,R){P.exports={min:"zmin",max:"zmax"}},{}],805:[function(t,P,R){var h=t("../../lib"),u=t("../../constants/numerical").BADNUM,A=t("../../plots/cartesian/align_period");P.exports=function(e,i,n,a,r,f){var o=e._length,s=i.makeCalcdata(e,a),m=n.makeCalcdata(e,r);s=A(e,i,a,s).vals,m=A(e,n,r,m).vals;var g=e.text,p=g!==void 0&&h.isArray1D(g),v=e.hovertext,x=v!==void 0&&h.isArray1D(v),l,b,c=h.distinctVals(s),M=c.vals,_=h.distinctVals(m),y=_.vals,w=[],d,C,S=y.length,E=M.length;for(l=0;l<f.length;l++)w[l]=h.init2dArray(S,E);p&&(d=h.init2dArray(S,E)),x&&(C=h.init2dArray(S,E));var k=h.init2dArray(S,E);for(l=0;l<o;l++)if(s[l]!==u&&m[l]!==u){var B=h.findBin(s[l]+c.minDiff/2,M),z=h.findBin(m[l]+_.minDiff/2,y);for(b=0;b<f.length;b++){var F=f[b],I=e[F],O=w[b];O[z][B]=I[l],k[z][B]=l}p&&(d[z][B]=g[l]),x&&(C[z][B]=v[l])}for(e["_"+a]=M,e["_"+r]=y,b=0;b<f.length;b++)e["_"+f[b]]=w[b];p&&(e._text=d),x&&(e._hovertext=C),i&&i.type==="category"&&(e["_"+a+"CategoryMap"]=M.map(function(N){return i._categories[N]})),n&&n.type==="category"&&(e["_"+r+"CategoryMap"]=y.map(function(N){return n._categories[N]})),e._after2before=k}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563}],806:[function(t,P,R){var h=t("../../lib"),u=t("./xyz_defaults"),A=t("./label_defaults"),T=t("../scatter/period_defaults"),e=t("./style_defaults"),i=t("../../components/colorscale/defaults"),n=t("./attributes");P.exports=function(r,f,o,s){function m(p,v){return h.coerce(r,f,n,p,v)}var g=u(r,f,m,s);if(!g){f.visible=!1;return}T(r,f,s,m),m("xhoverformat"),m("yhoverformat"),m("text"),m("hovertext"),m("hovertemplate"),A(m,s),e(r,f,m,s),m("hoverongaps"),m("connectgaps",h.isArray1D(f.z)&&f.zsmooth!==!1),i(r,f,s,m,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"../scatter/period_defaults":956,"./attributes":801,"./label_defaults":811,"./style_defaults":815,"./xyz_defaults":816}],807:[function(t,P,R){var h=t("../../lib").maxRowLength;P.exports=function(A){var T=[],e={},i=[],n=A[0],a=[],r=[0,0,0],f=h(A),o,s,m,g,p,v,x,l;for(s=0;s<A.length;s++)for(o=a,a=n,n=A[s+1]||[],m=0;m<f;m++)a[m]===void 0&&(v=(a[m-1]!==void 0?1:0)+(a[m+1]!==void 0?1:0)+(o[m]!==void 0?1:0)+(n[m]!==void 0?1:0),v?(s===0&&v++,m===0&&v++,s===A.length-1&&v++,m===a.length-1&&v++,v<4&&(e[[s,m]]=[s,m,v]),T.push([s,m,v])):i.push([s,m]));for(;i.length;){for(x={},l=!1,p=i.length-1;p>=0;p--)g=i[p],s=g[0],m=g[1],v=((e[[s-1,m]]||r)[2]+(e[[s+1,m]]||r)[2]+(e[[s,m-1]]||r)[2]+(e[[s,m+1]]||r)[2])/20,v&&(x[g]=[s,m,v],i.splice(p,1),l=!0);if(!l)throw"findEmpties iterated with no new neighbors";for(g in x)e[g]=x[g],T.push(x[g])}return T.sort(function(b,c){return c[2]-b[2]})}},{"../../lib":515}],808:[function(t,P,R){var h=t("../../components/fx"),u=t("../../lib"),A=t("../../plots/cartesian/axes"),T=t("../../components/colorscale").extractOpts;P.exports=function(i,n,a,r,f){f||(f={});var o=f.isContour,s=i.cd[0],m=s.trace,g=i.xa,p=i.ya,v=s.x,x=s.y,l=s.z,b=s.xCenter,c=s.yCenter,M=s.zmask,_=m.zhoverformat,y=v,w=x,d,C,S,E;if(i.index!==!1){try{S=Math.round(i.index[1]),E=Math.round(i.index[0])}catch{u.error("Error hovering on heatmap, pointNumber must be [row,col], found:",i.index);return}if(S<0||S>=l[0].length||E<0||E>l.length)return}else{if(h.inbox(n-v[0],n-v[v.length-1],0)>0||h.inbox(a-x[0],a-x[x.length-1],0)>0)return;if(o){var k;for(y=[2*v[0]-v[1]],k=1;k<v.length;k++)y.push((v[k]+v[k-1])/2);for(y.push([2*v[v.length-1]-v[v.length-2]]),w=[2*x[0]-x[1]],k=1;k<x.length;k++)w.push((x[k]+x[k-1])/2);w.push([2*x[x.length-1]-x[x.length-2]])}S=Math.max(0,Math.min(y.length-2,u.findBin(n,y))),E=Math.max(0,Math.min(w.length-2,u.findBin(a,w)))}var B=g.c2p(v[S]),z=g.c2p(v[S+1]),F=p.c2p(x[E]),I=p.c2p(x[E+1]),O,N;o?(O=s.orig_x||v,N=s.orig_y||x,z=B,d=O[S],I=F,C=N[E]):(O=s.orig_x||b||v,N=s.orig_y||c||x,d=b?O[S]:(O[S]+O[S+1])/2,C=c?N[E]:(N[E]+N[E+1])/2,g&&g.type==="category"&&(d=v[S]),p&&p.type==="category"&&(C=x[E]),m.zsmooth&&(B=z=g.c2p(d),F=I=p.c2p(C)));var V=l[E][S];if(M&&!M[E][S]&&(V=void 0),!(V===void 0&&!m.hoverongaps)){var H;Array.isArray(s.hovertext)&&Array.isArray(s.hovertext[E])?H=s.hovertext[E][S]:Array.isArray(s.text)&&Array.isArray(s.text[E])&&(H=s.text[E][S]);var j=T(m),Z={type:"linear",range:[j.min,j.max],hoverformat:_,_separators:g._separators,_numFormat:g._numFormat},X=A.tickText(Z,V,"hover").text;return[u.extendFlat(i,{index:m._after2before?m._after2before[E][S]:[E,S],distance:i.maxHoverDistance,spikeDistance:i.maxSpikeDistance,x0:B,x1:z,y0:F,y1:I,xLabelVal:d,yLabelVal:C,zLabelVal:V,zLabel:X,text:H})]}}},{"../../components/colorscale":379,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],809:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),calc:t("./calc"),plot:t("./plot"),colorbar:t("./colorbar"),style:t("./style"),hoverPoints:t("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":801,"./calc":802,"./colorbar":804,"./defaults":806,"./hover":808,"./plot":813,"./style":814}],810:[function(t,P,R){var h=t("../../lib"),u=.01,A=[[-1,0],[1,0],[0,-1],[0,1]];function T(i){return .5-.25*Math.min(1,i*.5)}P.exports=function(n,a){var r=1,f;for(e(n,a),f=0;f<a.length&&!(a[f][2]<4);f++);for(a=a.slice(f),f=0;f<100&&r>u;f++)r=e(n,a,T(r));return r>u&&h.log("interp2d didn't converge quickly",r),n};function e(i,n,a){var r=0,f,o,s,m,g,p,v,x,l,b,c,M,_;for(m=0;m<n.length;m++){for(f=n[m],o=f[0],s=f[1],c=i[o][s],b=0,l=0,g=0;g<4;g++)p=A[g],v=i[o+p[0]],v&&(x=v[s+p[1]],x!==void 0&&(b===0?M=_=x:(M=Math.min(M,x),_=Math.max(_,x)),l++,b+=x));if(l===0)throw"iterateInterp2d order is wrong: no defined neighbors";i[o][s]=b/l,c===void 0?l<4&&(r=1):(i[o][s]=(1+a)*i[o][s]-a*c,_>M&&(r=Math.max(r,Math.abs(i[o][s]-c)/(_-M))))}return r}},{"../../lib":515}],811:[function(t,P,R){var h=t("../../lib");P.exports=function(A,T){A("texttemplate");var e=h.extendFlat({},T.font,{color:"auto",size:"auto"});h.coerceFont(A,"textfont",e)}},{"../../lib":515}],812:[function(t,P,R){var h=t("../../registry"),u=t("../../lib").isArrayOrTypedArray;P.exports=function(T,e,i,n,a,r){var f=[],o=h.traceIs(T,"contour"),s=h.traceIs(T,"histogram"),m=h.traceIs(T,"gl2d"),g,p,v,x=u(e)&&e.length>1;if(x&&!s&&r.type!=="category"){var l=e.length;if(l<=a){if(o||m)f=e.slice(0,a);else if(a===1)f=[e[0]-.5,e[0]+.5];else{for(f=[1.5*e[0]-.5*e[1]],v=1;v<l;v++)f.push((e[v-1]+e[v])*.5);f.push(1.5*e[l-1]-.5*e[l-2])}if(l<a){var b=f[f.length-1],c=b-f[f.length-2];for(v=l;v<a;v++)b+=c,f.push(b)}}else return o?e.slice(0,a):e.slice(0,a+1)}else{var M=T[r._id.charAt(0)+"calendar"];if(s)g=r.r2c(i,0,M);else if(u(e)&&e.length===1)g=e[0];else if(i===void 0)g=0;else{var _=r.type==="log"?r.d2c:r.r2c;g=_(i,0,M)}for(p=n||1,v=o||m?0:-.5;v<a;v++)f.push(g+p*v)}return f}},{"../../lib":515,"../../registry":647}],813:[function(t,P,R){var h=t("@plotly/d3"),u=t("tinycolor2"),A=t("../../registry"),T=t("../../components/drawing"),e=t("../../plots/cartesian/axes"),i=t("../../lib"),n=t("../../lib/svg_text_utils"),a=t("../scatter/format_labels"),r=t("../../components/color"),f=t("../../components/colorscale").extractOpts,o=t("../../components/colorscale").makeColorScaleFuncFromTrace,s=t("../../constants/xmlns_namespaces"),m=t("../../constants/alignment"),g=m.LINE_SPACING,p="heatmap-label";function v(M){return M.selectAll("g."+p)}function x(M){v(M).remove()}P.exports=function(M,_,y,w){var d=_.xaxis,C=_.yaxis;i.makeTraceGroups(w,y,"hm").each(function(S){var E=h.select(this),k=S[0],B=k.trace,z=B.xgap||0,F=B.ygap||0,I=k.z,O=k.x,N=k.y,V=k.xCenter,H=k.yCenter,j=A.traceIs(B,"contour"),Z=j?"best":B.zsmooth,X=I.length,re=i.maxRowLength(I),ue=!1,K=!1,te,G,Y,ee,ne,J,q,ae;for(J=0;te===void 0&&J<O.length-1;)te=d.c2p(O[J]),J++;for(J=O.length-1;G===void 0&&J>0;)G=d.c2p(O[J]),J--;for(G<te&&(Y=G,G=te,te=Y,ue=!0),J=0;ee===void 0&&J<N.length-1;)ee=C.c2p(N[J]),J++;for(J=N.length-1;ne===void 0&&J>0;)ne=C.c2p(N[J]),J--;if(ne<ee&&(Y=ee,ee=ne,ne=Y,K=!0),j&&(V=O,H=N,O=k.xfill,N=k.yfill),Z!=="fast"){var le=Z==="best"?0:.5;te=Math.max(-le*d._length,te),G=Math.min((1+le)*d._length,G),ee=Math.max(-le*C._length,ee),ne=Math.min((1+le)*C._length,ne)}var ie=Math.round(G-te),se=Math.round(ne-ee),xe=ie<=0||se<=0;if(xe){var oe=E.selectAll("image").data([]);oe.exit().remove(),x(E);return}var he,be;Z==="fast"?(he=re,be=X):(he=ie,be=se);var me=document.createElement("canvas");me.width=he,me.height=be;var _e=me.getContext("2d"),Se=o(B,{noNumericCheck:!0,returnArray:!0}),De,Ie;Z==="fast"?(De=ue?function(Dr){return re-1-Dr}:i.identity,Ie=K?function(Dr){return X-1-Dr}:i.identity):(De=function(Dr){return i.constrain(Math.round(d.c2p(O[Dr])-te),0,ie)},Ie=function(Dr){return i.constrain(Math.round(C.c2p(N[Dr])-ee),0,se)});var Te=Ie(0),Ce=[Te,Te],He=ue?0:1,Xe=K?0:1,Be=0,Re=0,We=0,vt=0,Pt,Zt,zt,At,Wt;function Bt(Dr,Tr){if(Dr!==void 0){var Wr=Se(Dr);return Wr[0]=Math.round(Wr[0]),Wr[1]=Math.round(Wr[1]),Wr[2]=Math.round(Wr[2]),Be+=Tr,Re+=Wr[0]*Tr,We+=Wr[1]*Tr,vt+=Wr[2]*Tr,Wr}return[0,0,0,0]}function Ct(Dr,Tr,Wr,An){var vn=Dr[Wr.bin0];if(vn===void 0)return Bt(void 0,1);var Un=Dr[Wr.bin1],Dn=Tr[Wr.bin0],Xn=Tr[Wr.bin1],Yn=Un-vn||0,ya=Dn-vn||0,Ca;return Un===void 0?Xn===void 0?Ca=0:Dn===void 0?Ca=2*(Xn-vn):Ca=(2*Xn-Dn-vn)*2/3:Xn===void 0?Dn===void 0?Ca=0:Ca=(2*vn-Un-Dn)*2/3:Dn===void 0?Ca=(2*Xn-Un-vn)*2/3:Ca=Xn+vn-Un-Dn,Bt(vn+Wr.frac*Yn+An.frac*(ya+Wr.frac*Ca))}if(Z){var Ze=0,nt;try{nt=new Uint8Array(ie*se*4)}catch{nt=new Array(ie*se*4)}if(Z==="best"){var Ye=V||O,Ee=H||N,Ge=new Array(Ye.length),Je=new Array(Ee.length),qe=new Array(ie),Tt=V?b:l,mt=H?b:l,Mt,Ht,Rt;for(J=0;J<Ye.length;J++)Ge[J]=Math.round(d.c2p(Ye[J])-te);for(J=0;J<Ee.length;J++)Je[J]=Math.round(C.c2p(Ee[J])-ee);for(J=0;J<ie;J++)qe[J]=Tt(J,Ge);for(q=0;q<se;q++)for(Mt=mt(q,Je),Ht=I[Mt.bin0],Rt=I[Mt.bin1],J=0;J<ie;J++,Ze+=4)Wt=Ct(Ht,Rt,qe[J],Mt),c(nt,Ze,Wt)}else for(q=0;q<X;q++)for(At=I[q],Ce=Ie(q),J=0;J<ie;J++)Wt=Bt(At[J],1),Ze=(Ce*ie+De(J))*4,c(nt,Ze,Wt);var Vt=_e.createImageData(ie,se);try{Vt.data.set(nt)}catch{var Jt=Vt.data,Yt=Jt.length;for(q=0;q<Yt;q++)Jt[q]=nt[q]}_e.putImageData(Vt,0,0)}else{var or=Math.floor(z/2),Hr=Math.floor(F/2);for(q=0;q<X;q++)if(At=I[q],Ce.reverse(),Ce[Xe]=Ie(q+1),!(Ce[0]===Ce[1]||Ce[0]===void 0||Ce[1]===void 0))for(Zt=De(0),Pt=[Zt,Zt],J=0;J<re;J++)Pt.reverse(),Pt[He]=De(J+1),!(Pt[0]===Pt[1]||Pt[0]===void 0||Pt[1]===void 0)&&(zt=At[J],Wt=Bt(zt,(Pt[1]-Pt[0])*(Ce[1]-Ce[0])),_e.fillStyle="rgba("+Wt.join(",")+")",_e.fillRect(Pt[0]+or,Ce[0]+Hr,Pt[1]-Pt[0]-z,Ce[1]-Ce[0]-F))}Re=Math.round(Re/Be),We=Math.round(We/Be),vt=Math.round(vt/Be);var an=u("rgb("+Re+","+We+","+vt+")");M._hmpixcount=(M._hmpixcount||0)+Be,M._hmlumcount=(M._hmlumcount||0)+Be*an.getLuminance();var Kr=E.selectAll("image").data(S);Kr.enter().append("svg:image").attr({xmlns:s.svg,preserveAspectRatio:"none"}),Kr.attr({height:se,width:ie,x:te,y:ee,"xlink:href":me.toDataURL("image/png")}),x(E);var ot=B.texttemplate;if(ot){var er=f(B),Kt={type:"linear",range:[er.min,er.max],_separators:d._separators,_numFormat:d._numFormat},ur=B.type==="histogram2dcontour",Ar=B.type==="contour",et=Ar?1:0,$e=Ar?X-1:X,st=Ar?1:0,ft=Ar?re-1:re,St=[];for(J=et;J<$e;J++){var Ut;if(Ar)Ut=k.y[J];else if(ur){if(J===0||J===X-1)continue;Ut=k.y[J]}else if(k.yCenter)Ut=k.yCenter[J];else{if(J+1===X&&k.y[J+1]===void 0)continue;Ut=(k.y[J]+k.y[J+1])/2}var Pe=Math.round(C.c2p(Ut));if(!(0>Pe||Pe>C._length))for(q=st;q<ft;q++){var ke;if(Ar)ke=k.x[q];else if(ur){if(q===0||q===re-1)continue;ke=k.x[q]}else if(k.xCenter)ke=k.xCenter[q];else{if(q+1===re&&k.x[q+1]===void 0)continue;ke=(k.x[q]+k.x[q+1])/2}var it=Math.round(d.c2p(ke));if(!(0>it||it>d._length)){var ut=a({x:ke,y:Ut},B,M._fullLayout);ut.x=ke,ut.y=Ut;var ht=k.z[J][q];ht===void 0?(ut.z="",ut.zLabel=""):(ut.z=ht,ut.zLabel=e.tickText(Kt,ht,"hover").text);var Et=k.text&&k.text[J]&&k.text[J][q];(Et===void 0||Et===!1)&&(Et=""),ut.text=Et;var yt=i.texttemplateString(ot,ut,M._fullLayout._d3locale,ut,B._meta||{});if(!!yt){var Dt=yt.split("<br>"),Xt=Dt.length,ar=0;for(ae=0;ae<Xt;ae++)ar=Math.max(ar,Dt[ae].length);St.push({l:Xt,c:ar,t:yt,x:it,y:Pe,z:ht})}}}}var kr=B.textfont,wr=kr.family,Sr=kr.size,Zr=M._fullLayout.font.size;if(!Sr||Sr==="auto"){var ir=1/0,xr=1/0,Fr=0,Or=0;for(ae=0;ae<St.length;ae++){var Cr=St[ae];if(Fr=Math.max(Fr,Cr.l),Or=Math.max(Or,Cr.c),ae<St.length-1){var at=St[ae+1],Ft=Math.abs(at.x-Cr.x),jt=Math.abs(at.y-Cr.y);Ft&&(ir=Math.min(ir,Ft)),jt&&(xr=Math.min(xr,jt))}}!isFinite(ir)||!isFinite(xr)?Sr=Zr:(ir-=z,xr-=F,ir/=Or,xr/=Fr,ir/=g/2,xr/=g,Sr=Math.min(Math.floor(ir),Math.floor(xr),Zr))}if(Sr<=0||!isFinite(Sr))return;var sr=function(Dr){return Dr.x},zr=function(Dr){return Dr.y-Sr*(Dr.l*g/2-1)},Ur=v(E).data(St);Ur.enter().append("g").classed(p,1).append("text").attr("text-anchor","middle").each(function(Dr){var Tr=h.select(this),Wr=kr.color;(!Wr||Wr==="auto")&&(Wr=r.contrast("rgba("+Se(Dr.z).join()+")")),Tr.attr("data-notex",1).call(n.positionText,sr(Dr),zr(Dr)).call(T.font,wr,Sr,Wr).text(Dr.t).call(n.convertToTspans,M)})}})};function l(M,_){var y=_.length-2,w=i.constrain(i.findBin(M,_),0,y),d=_[w],C=_[w+1],S=i.constrain(w+(M-d)/(C-d)-.5,0,y),E=Math.round(S),k=Math.abs(S-E);return!S||S===y||!k?{bin0:E,bin1:E,frac:0}:{bin0:E,frac:k,bin1:Math.round(E+k/(S-E))}}function b(M,_){var y=_.length-1,w=i.constrain(i.findBin(M,_),0,y),d=_[w],C=_[w+1],S=(M-d)/(C-d)||0;return S<=0?{bin0:w,bin1:w,frac:0}:S<.5?{bin0:w,bin1:w+1,frac:S}:{bin0:w+1,bin1:w,frac:1-S}}function c(M,_,y){M[_]=y[0],M[_+1]=y[1],M[_+2]=y[2],M[_+3]=Math.round(y[3]*255)}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"../../constants/alignment":483,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../scatter/format_labels":945,"@plotly/d3":58,tinycolor2:313}],814:[function(t,P,R){var h=t("@plotly/d3");P.exports=function(A){h.select(A).selectAll(".hm image").style("opacity",function(T){return T.trace.opacity})}},{"@plotly/d3":58}],815:[function(t,P,R){P.exports=function(u,A,T){var e=T("zsmooth");e===!1&&(T("xgap"),T("ygap")),T("zhoverformat")}},{}],816:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib"),A=t("../../registry");P.exports=function(n,a,r,f,o,s){var m=r("z");o=o||"x",s=s||"y";var g,p;if(m===void 0||!m.length)return 0;if(u.isArray1D(n.z)){g=r(o),p=r(s);var v=u.minRowLength(g),x=u.minRowLength(p);if(v===0||x===0)return 0;a._length=Math.min(v,x,m.length)}else{if(g=T(o,r),p=T(s,r),!e(m))return 0;r("transpose"),a._length=null}if(n.type==="heatmapgl")return!0;var l=A.getComponentMethod("calendars","handleTraceDefaults");return l(n,a,[o,s],f),!0};function T(i,n){var a=n(i),r=a?n(i+"type","array"):"scaled";return r==="scaled"&&(n(i+"0"),n("d"+i)),a}function e(i){for(var n=!0,a=!1,r=!1,f,o=0;o<i.length;o++){if(f=i[o],!u.isArrayOrTypedArray(f)){n=!1;break}f.length>0&&(a=!0);for(var s=0;s<f.length;s++)if(h(f[s])){r=!0;break}}return n&&a&&r}},{"../../lib":515,"../../registry":647,"fast-isnumeric":190}],817:[function(t,P,R){for(var h=t("../heatmap/attributes"),u=t("../../components/colorscale/attributes"),A=t("../../lib/extend").extendFlat,T=t("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],i={},n=0;n<e.length;n++){var a=e[n];i[a]=h[a]}i.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},A(i,u("",{cLetter:"z",autoColorDflt:!1})),P.exports=T(i,"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../heatmap/attributes":801}],818:[function(t,P,R){var h=t("../../../stackgl_modules").gl_heatmap2d,u=t("../../plots/cartesian/axes"),A=t("../../lib/str2rgbarray");function T(a,r){this.scene=a,this.uid=r,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=h(a.glplot,this.options),this.heatmap._trace=this}var e=T.prototype;e.handlePick=function(a){var r=this.options,f=r.shape,o=a.pointId,s=o%f[0],m=Math.floor(o/f[0]),g=o;return{trace:this,dataCoord:a.dataCoord,traceCoord:[r.x[s],r.y[m],r.z[g]],textLabel:this.textLabels[o],name:this.name,pointIndex:[m,s],hoverinfo:this.hoverinfo}},e.update=function(a,r){var f=r[0];this.index=a.index,this.name=a.name,this.hoverinfo=a.hoverinfo;var o=f.z;this.options.z=[].concat.apply([],o);var s=o[0].length,m=o.length;this.options.shape=[s,m],this.options.x=f.x,this.options.y=f.y,this.options.zsmooth=a.zsmooth;var g=i(a);this.options.colorLevels=g.colorLevels,this.options.colorValues=g.colorValues,this.textLabels=[].concat.apply([],a.text),this.heatmap.update(this.options);var p=this.scene.xaxis,v=this.scene.yaxis,x,l;a.zsmooth===!1&&(x={ppad:f.x[1]-f.x[0]},l={ppad:f.y[1]-f.y[0]}),a._extremes[p._id]=u.findExtremes(p,f.x,x),a._extremes[v._id]=u.findExtremes(v,f.y,l)},e.dispose=function(){this.heatmap.dispose()};function i(a){for(var r=a.colorscale,f=a.zmin,o=a.zmax,s=r.length,m=new Array(s),g=new Array(4*s),p=0;p<s;p++){var v=r[p],x=A(v[1]);m[p]=f+v[0]*(o-f);for(var l=0;l<4;l++)g[4*p+l]=x[l]}return{colorLevels:m,colorValues:g}}function n(a,r,f){var o=new T(a,r.uid);return o.update(r,f),o}P.exports=n},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566}],819:[function(t,P,R){var h=t("../../lib"),u=t("../heatmap/xyz_defaults"),A=t("../../components/colorscale/defaults"),T=t("./attributes");P.exports=function(i,n,a,r){function f(s,m){return h.coerce(i,n,T,s,m)}var o=u(i,n,f,r);if(!o){n.visible=!1;return}f("text"),f("zsmooth"),A(i,n,r,f,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/xyz_defaults":816,"./attributes":817}],820:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../heatmap/colorbar"),calc:t("../heatmap/calc"),plot:t("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:t("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":605,"../heatmap/calc":802,"../heatmap/colorbar":804,"./attributes":817,"./convert":818,"./defaults":819}],821:[function(t,P,R){var h=t("../bar/attributes"),u=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,A=t("../../plots/template_attributes").hovertemplateAttrs,T=t("../../plots/template_attributes").texttemplateAttrs,e=t("../../plots/font_attributes"),i=t("./bin_attributes"),n=t("./constants"),a=t("../../lib/extend").extendFlat;P.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:u("x"),yhoverformat:u("y"),text:a({},h.text,{}),hovertext:a({},h.hovertext,{}),orientation:h.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:i("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:i("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:A({},{keys:n.eventDataKeys}),texttemplate:T({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:a({},h.textposition,{arrayOk:!1}),textfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:h.insidetextanchor,textangle:h.textangle,cliponaxis:h.cliponaxis,constraintext:h.constraintext,marker:h.marker,offsetgroup:h.offsetgroup,alignmentgroup:h.alignmentgroup,selected:h.selected,unselected:h.unselected,_deprecated:{bardir:h._deprecated.bardir}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../bar/attributes":657,"./bin_attributes":823,"./constants":827}],822:[function(t,P,R){P.exports=function(u,A){for(var T=u.length,e=0,i=0;i<T;i++)A[i]?(u[i]/=A[i],e+=u[i]):u[i]=null;return e}},{}],823:[function(t,P,R){P.exports=function(u,A){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],824:[function(t,P,R){var h=t("fast-isnumeric");P.exports={count:function(u,A,T){return T[u]++,1},sum:function(u,A,T,e){var i=e[A];return h(i)?(i=Number(i),T[u]+=i,i):0},avg:function(u,A,T,e,i){var n=e[A];return h(n)&&(n=Number(n),T[u]+=n,i[u]++),0},min:function(u,A,T,e){var i=e[A];if(h(i))if(i=Number(i),h(T[u])){if(T[u]>i){var n=i-T[u];return T[u]=i,n}}else return T[u]=i,i;return 0},max:function(u,A,T,e){var i=e[A];if(h(i))if(i=Number(i),h(T[u])){if(T[u]<i){var n=i-T[u];return T[u]=i,n}}else return T[u]=i,i;return 0}}},{"fast-isnumeric":190}],825:[function(t,P,R){var h=t("../../constants/numerical"),u=h.ONEAVGYEAR,A=h.ONEAVGMONTH,T=h.ONEDAY,e=h.ONEHOUR,i=h.ONEMIN,n=h.ONESEC,a=t("../../plots/cartesian/axes").tickIncrement;P.exports=function(g,p,v,x,l){var b=-1.1*p,c=-.1*p,M=g-c,_=v[0],y=v[1],w=Math.min(r(_+c,_+M,x,l),r(y+c,y+M,x,l)),d=Math.min(r(_+b,_+c,x,l),r(y+b,y+c,x,l)),C,S;if(w>d&&d<Math.abs(y-_)/4e3?(C=w,S=!1):(C=Math.min(w,d),S=!0),x.type==="date"&&C>T){var E=C===u?1:6,k=C===u?"M12":"M1";return function(B,z){var F=x.c2d(B,u,l),I=F.indexOf("-",E);I>0&&(F=F.substr(0,I));var O=x.d2c(F,0,l);if(O<B){var N=a(O,k,!1,l);(O+N)/2<B+g&&(O=N)}return z&&S?a(O,k,!0,l):O}}return function(B,z){var F=C*Math.round(B/C);return F+C/10<B&&F+C*.9<B+g&&(F+=C),z&&S&&(F-=C),F}};function r(m,g,p,v){if(m*g<=0)return 1/0;for(var x=Math.abs(g-m),l=p.type==="date",b=f(x,l),c=0;c<10;c++){var M=f(b*80,l);if(b===M)break;if(o(M,m,g,l,p,v))b=M;else break}return b}function f(m,g){return g&&m>n?m>T?m>u*1.1?u:m>A*1.1?A:T:m>e?e:m>i?i:n:Math.pow(10,Math.floor(Math.log(m)/Math.LN10))}function o(m,g,p,v,x,l){if(v&&m>T){var b=s(g,x,l),c=s(p,x,l),M=m===u?0:1;return b[M]!==c[M]}return Math.floor(p/m)-Math.floor(g/m)>.1}function s(m,g,p){var v=g.c2d(m,u,p).split("-");return v[0]===""&&(v.unshift(),v[0]="-"+v[0]),v}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566}],826:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib"),A=t("../../registry"),T=t("../../plots/cartesian/axes"),e=t("../bar/arrays_to_calcdata"),i=t("./bin_functions"),n=t("./norm_functions"),a=t("./average"),r=t("./bin_label_vals");function f(p,v){var x=[],l=[],b=v.orientation==="h",c=T.getFromId(p,b?v.yaxis:v.xaxis),M=b?"y":"x",_={x:"y",y:"x"}[M],y=v[M+"calendar"],w=v.cumulative,d,C=o(p,v,c,M),S=C[0],E=C[1],k=typeof S.size=="string",B=[],z=k?B:S,F=[],I=[],O=[],N=0,V=v.histnorm,H=v.histfunc,j=V.indexOf("density")!==-1,Z,X,re;w.enabled&&j&&(V=V.replace(/ ?density$/,""),j=!1);var ue=H==="max"||H==="min",K=ue?null:0,te=i.count,G=n[V],Y=!1,ee=function(Ie){return c.r2c(Ie,0,y)},ne;for(u.isArrayOrTypedArray(v[_])&&H!=="count"&&(ne=v[_],Y=H==="avg",te=i[H]),d=ee(S.start),X=ee(S.end)+(d-T.tickIncrement(d,S.size,!1,y))/1e6;d<X&&x.length<1e6&&(Z=T.tickIncrement(d,S.size,!1,y),x.push((d+Z)/2),l.push(K),O.push([]),B.push(d),j&&F.push(1/(Z-d)),Y&&I.push(0),!(Z<=d));)d=Z;B.push(d),!k&&c.type==="date"&&(z={start:ee(z.start),end:ee(z.end),size:z.size}),p._fullLayout._roundFnOpts||(p._fullLayout._roundFnOpts={});var J=v["_"+M+"bingroup"],q={leftGap:1/0,rightGap:1/0};J&&(p._fullLayout._roundFnOpts[J]||(p._fullLayout._roundFnOpts[J]=q),q=p._fullLayout._roundFnOpts[J]);var ae=l.length,le=!0,ie=q.leftGap,se=q.rightGap,xe={};for(d=0;d<E.length;d++){var oe=E[d];re=u.findBin(oe,z),re>=0&&re<ae&&(N+=te(re,d,l,ne,I),le&&O[re].length&&oe!==E[O[re][0]]&&(le=!1),O[re].push(d),xe[d]=re,ie=Math.min(ie,oe-B[re]),se=Math.min(se,B[re+1]-oe))}q.leftGap=ie,q.rightGap=se;var he;le||(he=function(Ie,Te){return function(){var Ce=p._fullLayout._roundFnOpts[J];return r(Ce.leftGap,Ce.rightGap,B,c,y)(Ie,Te)}}),Y&&(N=a(l,I)),G&&G(l,N,F),w.enabled&&g(l,w.direction,w.currentbin);var be=Math.min(x.length,l.length),me=[],_e=0,Se=be-1;for(d=0;d<be;d++)if(l[d]){_e=d;break}for(d=be-1;d>=_e;d--)if(l[d]){Se=d;break}for(d=_e;d<=Se;d++)if(h(x[d])&&h(l[d])){var De={p:x[d],s:l[d],b:0};w.enabled||(De.pts=O[d],le?De.ph0=De.ph1=O[d].length?E[O[d][0]]:x[d]:(v._computePh=!0,De.ph0=he(B[d]),De.ph1=he(B[d+1],!0))),me.push(De)}return me.length===1&&(me[0].width1=T.tickIncrement(me[0].p,S.size,!1,y)-me[0].p),e(me,v),u.isArrayOrTypedArray(v.selectedpoints)&&u.tagSelected(me,v,xe),me}function o(p,v,x,l,b){var c=l+"bins",M=p._fullLayout,_=v["_"+l+"bingroup"],y=M._histogramBinOpts[_],w=M.barmode==="overlay",d,C,S,E,k,B,z,F=function(oe){return x.r2c(oe,0,E)},I=function(oe){return x.c2r(oe,0,E)},O=x.type==="date"?function(oe){return oe||oe===0?u.cleanDate(oe,null,E):null}:function(oe){return h(oe)?Number(oe):null};function N(oe,he,be){he[oe+"Found"]?(he[oe]=O(he[oe]),he[oe]===null&&(he[oe]=be[oe])):(B[oe]=he[oe]=be[oe],u.nestedProperty(C[0],c+"."+oe).set(be[oe]))}if(v["_"+l+"autoBinFinished"])delete v["_"+l+"autoBinFinished"];else{C=y.traces;var V=[],H=!0,j=!1,Z=!1;for(d=0;d<C.length;d++)if(S=C[d],S.visible){var X=y.dirs[d];k=S["_"+X+"pos0"]=x.makeCalcdata(S,X),V=u.concat(V,k),delete S["_"+l+"autoBinFinished"],v.visible===!0&&(H?H=!1:(delete S._autoBin,S["_"+l+"autoBinFinished"]=1),A.traceIs(S,"2dMap")&&(j=!0),S.type==="histogram2dcontour"&&(Z=!0))}E=C[0][l+"calendar"];var re=T.autoBin(V,x,y.nbins,j,E,y.sizeFound&&y.size),ue=C[0]._autoBin={};if(B=ue[y.dirs[0]]={},Z&&(y.size||(re.start=I(T.tickIncrement(F(re.start),re.size,!0,E))),y.end===void 0&&(re.end=I(T.tickIncrement(F(re.end),re.size,!1,E)))),w&&!A.traceIs(v,"2dMap")&&re._dataSpan===0&&x.type!=="category"&&x.type!=="multicategory"){if(b)return[re,k,!0];re=s(p,v,x,l,c)}z=S.cumulative||{},z.enabled&&z.currentbin!=="include"&&(z.direction==="decreasing"?re.start=I(T.tickIncrement(F(re.start),re.size,!0,E)):re.end=I(T.tickIncrement(F(re.end),re.size,!1,E))),y.size=re.size,y.sizeFound||(B.size=re.size,u.nestedProperty(C[0],c+".size").set(re.size)),N("start",y,re),N("end",y,re)}k=v["_"+l+"pos0"],delete v["_"+l+"pos0"];var K=v._input[c]||{},te=u.extendFlat({},y),G=y.start,Y=x.r2l(K.start),ee=Y!==void 0;if((y.startFound||ee)&&Y!==x.r2l(G)){var ne=ee?Y:u.aggNums(Math.min,null,k),J={type:x.type==="category"||x.type==="multicategory"?"linear":x.type,r2l:x.r2l,dtick:y.size,tick0:G,calendar:E,range:[ne,T.tickIncrement(ne,y.size,!1,E)].map(x.l2r)},q=T.tickFirst(J);q>x.r2l(ne)&&(q=T.tickIncrement(q,y.size,!0,E)),te.start=x.l2r(q),ee||u.nestedProperty(v,c+".start").set(te.start)}var ae=y.end,le=x.r2l(K.end),ie=le!==void 0;if((y.endFound||ie)&&le!==x.r2l(ae)){var se=ie?le:u.aggNums(Math.max,null,k);te.end=x.l2r(se),ie||u.nestedProperty(v,c+".start").set(te.end)}var xe="autobin"+l;return v._input[xe]===!1&&(v._input[c]=u.extendFlat({},v[c]||{}),delete v._input[xe],delete v[xe]),[te,k]}function s(p,v,x,l,b){var c=p._fullLayout,M=m(p,v),_=!1,y=1/0,w=[v],d,C,S;for(d=0;d<M.length;d++)if(C=M[d],C===v)_=!0;else if(!_)S=c._histogramBinOpts[C["_"+l+"bingroup"]],y=Math.min(y,S.size||C[b].size);else{var E=o(p,C,x,l,!0),k=E[0],B=E[2];C["_"+l+"autoBinFinished"]=1,C["_"+l+"pos0"]=E[1],B?w.push(C):y=Math.min(y,k.size)}var z=new Array(w.length);for(d=0;d<w.length;d++)for(var F=w[d]["_"+l+"pos0"],I=0;I<F.length;I++)if(F[I]!==void 0){z[d]=F[I];break}for(isFinite(y)||(y=u.distinctVals(z).minDiff),d=0;d<w.length;d++){C=w[d];var O=C[l+"calendar"],N={start:x.c2r(z[d]-y/2,0,O),end:x.c2r(z[d]+y/2,0,O),size:y};C._input[b]=C[b]=N,S=c._histogramBinOpts[C["_"+l+"bingroup"]],S&&u.extendFlat(S,N)}return v[b]}function m(p,v){for(var x=v.xaxis,l=v.yaxis,b=v.orientation,c=[],M=p._fullData,_=0;_<M.length;_++){var y=M[_];y.type==="histogram"&&y.visible===!0&&y.orientation===b&&y.xaxis===x&&y.yaxis===l&&c.push(y)}return c}function g(p,v,x){var l,b,c;function M(y){c=p[y],p[y]/=2}function _(y){b=p[y],p[y]=c+b/2,c+=b}if(x==="half")if(v==="increasing")for(M(0),l=1;l<p.length;l++)_(l);else for(M(p.length-1),l=p.length-2;l>=0;l--)_(l);else if(v==="increasing"){for(l=1;l<p.length;l++)p[l]+=p[l-1];x==="exclude"&&(p.unshift(0),p.pop())}else{for(l=p.length-2;l>=0;l--)p[l]+=p[l+1];x==="exclude"&&(p.push(0),p.shift())}}P.exports={calc:f,calcAllAutoBins:o}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"../bar/arrays_to_calcdata":656,"./average":822,"./bin_functions":824,"./bin_label_vals":825,"./norm_functions":833,"fast-isnumeric":190}],827:[function(t,P,R){P.exports={eventDataKeys:["binNumber"]}},{}],828:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axis_ids"),A=t("../../registry").traceIs,T=t("../bar/defaults").handleGroupingDefaults,e=h.nestedProperty,i=t("../../plots/cartesian/constraints").getAxisGroup,n=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],a=["x","y"];P.exports=function(f,o){var s=o._histogramBinOpts={},m=[],g={},p=[],v,x,l,b,c,M,_;function y(Z,X){return h.coerce(v._input,v,v._module.attributes,Z,X)}function w(Z){return Z.orientation==="v"?"x":"y"}function d(Z,X){var re=u.getFromTrace({_fullLayout:o},Z,X);return re.type}function C(Z,X,re){var ue=Z.uid+"__"+re;X||(X=ue);var K=d(Z,re),te=Z[re+"calendar"]||"",G=s[X],Y=!0;G&&(K===G.axType&&te===G.calendar?(Y=!1,G.traces.push(Z),G.dirs.push(re)):(X=ue,K!==G.axType&&h.warn(["Attempted to group the bins of trace",Z.index,"set on a","type:"+K,"axis","with bins on","type:"+G.axType,"axis."].join(" ")),te!==G.calendar&&h.warn(["Attempted to group the bins of trace",Z.index,"set with a",te,"calendar","with bins",G.calendar?"on a "+G.calendar+" calendar":"w/o a set calendar"].join(" ")))),Y&&(s[X]={traces:[Z],dirs:[re],axType:K,calendar:Z[re+"calendar"]||""}),Z["_"+re+"bingroup"]=X}for(c=0;c<f.length;c++)v=f[c],A(v,"histogram")&&(m.push(v),delete v._xautoBinFinished,delete v._yautoBinFinished,A(v,"2dMap")||T(v._input,v,o,y));var S=o._alignmentOpts||{};for(c=0;c<m.length;c++){if(v=m[c],l="",!A(v,"2dMap")){if(b=w(v),o.barmode==="group"&&v.alignmentgroup){var E=v[b+"axis"],k=i(o,E)+v.orientation;(S[k]||{})[v.alignmentgroup]&&(l=k)}!l&&o.barmode!=="overlay"&&(l=i(o,v.xaxis)+i(o,v.yaxis)+w(v))}l?(g[l]||(g[l]=[]),g[l].push(v)):p.push(v)}for(l in g){if(x=g[l],x.length===1){p.push(x[0]);continue}var B=!1;for(x.length&&(v=x[0],B=y("bingroup")),l=B||l,c=0;c<x.length;c++){v=x[c];var z=v._input.bingroup;z&&z!==l&&h.warn(["Trace",v.index,"must match","within bingroup",l+".","Ignoring its bingroup:",z,"setting."].join(" ")),v.bingroup=l,C(v,l,w(v))}}for(c=0;c<p.length;c++){v=p[c];var F=y("bingroup");if(A(v,"2dMap"))for(_=0;_<2;_++){b=a[_];var I=y(b+"bingroup",F?F+"__"+b:null);C(v,I,b)}else C(v,F,w(v))}for(l in s){var O=s[l];for(x=O.traces,M=0;M<n.length;M++){var N=n[M],V=N.name,H,j;if(!(V==="nbins"&&O.sizeFound)){for(c=0;c<x.length;c++){if(v=x[c],b=O.dirs[c],H=N.aStr[b],e(v._input,H).get()!==void 0){O[V]=y(H),O[V+"Found"]=!0;break}j=(v._autoBin||{})[b]||{},j[V]&&e(v,H).set(j[V])}if(V==="start"||V==="end")for(;c<x.length;c++)v=x[c],v["_"+b+"bingroup"]&&(j=(v._autoBin||{})[b]||{},y(H,j[V]));V==="nbins"&&!O.sizeFound&&!O.nbinsFound&&(v=x[0],O[V]=y(H))}}}}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/cartesian/constraints":574,"../../registry":647,"../bar/defaults":661}],829:[function(t,P,R){var h=t("../../registry"),u=t("../../lib"),A=t("../../components/color"),T=t("../bar/defaults").handleText,e=t("../bar/style_defaults"),i=t("./attributes");P.exports=function(a,r,f,o){function s(d,C){return u.coerce(a,r,i,d,C)}var m=s("x"),g=s("y"),p=s("cumulative.enabled");p&&(s("cumulative.direction"),s("cumulative.currentbin")),s("text");var v=s("textposition");T(a,r,o,s,v,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),s("hovertext"),s("hovertemplate"),s("xhoverformat"),s("yhoverformat");var x=s("orientation",g&&!m?"h":"v"),l=x==="v"?"x":"y",b=x==="v"?"y":"x",c=m&&g?Math.min(u.minRowLength(m)&&u.minRowLength(g)):u.minRowLength(r[l]||[]);if(!c){r.visible=!1;return}r._length=c;var M=h.getComponentMethod("calendars","handleTraceDefaults");M(a,r,["x","y"],o);var _=r[b];_&&s("histfunc"),s("histnorm"),s("autobin"+l),e(a,r,s,f,o),u.coerceSelectionMarkerOpacity(r,s);var y=(r.marker.line||{}).color,w=h.getComponentMethod("errorbars","supplyDefaults");w(a,r,y||A.defaultLine,{axis:"y"}),w(a,r,y||A.defaultLine,{axis:"x",inherit:"y"})}},{"../../components/color":367,"../../lib":515,"../../registry":647,"../bar/defaults":661,"../bar/style_defaults":672,"./attributes":821}],830:[function(t,P,R){P.exports=function(u,A,T,e,i){if(u.x="xVal"in A?A.xVal:A.x,u.y="yVal"in A?A.yVal:A.y,"zLabelVal"in A&&(u.z=A.zLabelVal),A.xa&&(u.xaxis=A.xa),A.ya&&(u.yaxis=A.ya),!(T.cumulative||{}).enabled){var n=Array.isArray(i)?e[0].pts[i[0]][i[1]]:e[i].pts;u.pointNumbers=n,u.binNumber=u.pointNumber,delete u.pointNumber,delete u.pointIndex;var a;if(T._indexToPoints){a=[];for(var r=0;r<n.length;r++)a=a.concat(T._indexToPoints[n[r]])}else a=n;u.pointIndices=a}return u}},{}],831:[function(t,P,R){var h=t("../bar/hover").hoverPoints,u=t("../../plots/cartesian/axes").hoverLabelText;P.exports=function(T,e,i,n,a){var r=h(T,e,i,n,a);if(!!r){T=r[0];var f=T.cd[T.index],o=T.cd[0].trace;if(!o.cumulative.enabled){var s=o.orientation==="h"?"y":"x";T[s+"Label"]=u(T[s+"a"],[f.ph0,f.ph1],o[s+"hoverformat"])}return r}}},{"../../plots/cartesian/axes":566,"../bar/hover":664}],832:[function(t,P,R){P.exports={attributes:t("./attributes"),layoutAttributes:t("../bar/layout_attributes"),supplyDefaults:t("./defaults"),crossTraceDefaults:t("./cross_trace_defaults"),supplyLayoutDefaults:t("../bar/layout_defaults"),calc:t("./calc").calc,crossTraceCalc:t("../bar/cross_trace_calc").crossTraceCalc,plot:t("../bar/plot").plot,layerName:"barlayer",style:t("../bar/style").style,styleOnSelect:t("../bar/style").styleOnSelect,colorbar:t("../scatter/marker_colorbar"),hoverPoints:t("./hover"),selectPoints:t("../bar/select"),eventData:t("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:t("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../bar/cross_trace_calc":660,"../bar/layout_attributes":666,"../bar/layout_defaults":667,"../bar/plot":668,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"./attributes":821,"./calc":826,"./cross_trace_defaults":828,"./defaults":829,"./event_data":830,"./hover":831}],833:[function(t,P,R){P.exports={percent:function(h,u){for(var A=h.length,T=100/u,e=0;e<A;e++)h[e]*=T},probability:function(h,u){for(var A=h.length,T=0;T<A;T++)h[T]/=u},density:function(h,u,A,T){var e=h.length;T=T||1;for(var i=0;i<e;i++)h[i]*=A[i]*T},"probability density":function(h,u,A,T){var e=h.length;T&&(u/=T);for(var i=0;i<e;i++)h[i]*=A[i]/u}}},{}],834:[function(t,P,R){var h=t("../histogram/attributes"),u=t("../histogram/bin_attributes"),A=t("../heatmap/attributes"),T=t("../../plots/attributes"),e=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,i=t("../../plots/template_attributes").hovertemplateAttrs,n=t("../../plots/template_attributes").texttemplateAttrs,a=t("../../components/colorscale/attributes"),r=t("../../lib/extend").extendFlat;P.exports=r({x:h.x,y:h.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:h.histnorm,histfunc:h.histfunc,nbinsx:h.nbinsx,xbins:u("x"),nbinsy:h.nbinsy,ybins:u("y"),autobinx:h.autobinx,autobiny:h.autobiny,bingroup:r({},h.bingroup,{}),xbingroup:r({},h.bingroup,{}),ybingroup:r({},h.bingroup,{}),xgap:A.xgap,ygap:A.ygap,zsmooth:A.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:i({},{keys:"z"}),texttemplate:n({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:A.textfont,showlegend:r({},T.showlegend,{dflt:!1})},a("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../heatmap/attributes":801,"../histogram/attributes":821,"../histogram/bin_attributes":823}],835:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axes"),A=t("../histogram/bin_functions"),T=t("../histogram/norm_functions"),e=t("../histogram/average"),i=t("../histogram/bin_label_vals"),n=t("../histogram/calc").calcAllAutoBins;P.exports=function(s,m){var g=u.getFromId(s,m.xaxis),p=u.getFromId(s,m.yaxis),v=m.xcalendar,x=m.ycalendar,l=function(Ze){return g.r2c(Ze,0,v)},b=function(Ze){return p.r2c(Ze,0,x)},c=function(Ze){return g.c2r(Ze,0,v)},M=function(Ze){return p.c2r(Ze,0,x)},_,y,w,d,C=n(s,m,g,"x"),S=C[0],E=C[1],k=n(s,m,p,"y"),B=k[0],z=k[1],F=m._length;E.length>F&&E.splice(F,E.length-F),z.length>F&&z.splice(F,z.length-F);var I=[],O=[],N=[],V=typeof S.size=="string",H=typeof B.size=="string",j=[],Z=[],X=V?j:S,re=H?Z:B,ue=0,K=[],te=[],G=m.histnorm,Y=m.histfunc,ee=G.indexOf("density")!==-1,ne=Y==="max"||Y==="min",J=ne?null:0,q=A.count,ae=T[G],le=!1,ie=[],se=[],xe="z"in m?m.z:"marker"in m&&Array.isArray(m.marker.color)?m.marker.color:"";xe&&Y!=="count"&&(le=Y==="avg",q=A[Y]);var oe=S.size,he=l(S.start),be=l(S.end)+(he-u.tickIncrement(he,oe,!1,v))/1e6;for(_=he;_<be;_=u.tickIncrement(_,oe,!1,v))O.push(J),j.push(_),le&&N.push(0);j.push(_);var me=O.length,_e=(_-he)/me,Se=c(he+_e/2),De=B.size,Ie=b(B.start),Te=b(B.end)+(Ie-u.tickIncrement(Ie,De,!1,x))/1e6;for(_=Ie;_<Te;_=u.tickIncrement(_,De,!1,x)){I.push(O.slice()),Z.push(_);var Ce=new Array(me);for(y=0;y<me;y++)Ce[y]=[];te.push(Ce),le&&K.push(N.slice())}Z.push(_);var He=I.length,Xe=(_-Ie)/He,Be=M(Ie+Xe/2);ee&&(ie=a(O.length,X,_e,V),se=a(I.length,re,Xe,H)),!V&&g.type==="date"&&(X=r(l,X)),!H&&p.type==="date"&&(re=r(b,re));var Re=!0,We=!0,vt=new Array(me),Pt=new Array(He),Zt=1/0,zt=1/0,At=1/0,Wt=1/0;for(_=0;_<F;_++){var Bt=E[_],Ct=z[_];w=h.findBin(Bt,X),d=h.findBin(Ct,re),w>=0&&w<me&&d>=0&&d<He&&(ue+=q(w,_,I[d],xe,K[d]),te[d][w].push(_),Re&&(vt[w]===void 0?vt[w]=Bt:vt[w]!==Bt&&(Re=!1)),We&&(Pt[d]===void 0?Pt[d]=Ct:Pt[d]!==Ct&&(We=!1)),Zt=Math.min(Zt,Bt-j[w]),zt=Math.min(zt,j[w+1]-Bt),At=Math.min(At,Ct-Z[d]),Wt=Math.min(Wt,Z[d+1]-Ct))}if(le)for(d=0;d<He;d++)ue+=e(I[d],K[d]);if(ae)for(d=0;d<He;d++)ae(I[d],ue,ie,se[d]);return{x:E,xRanges:f(j,Re&&vt,Zt,zt,g,v),x0:Se,dx:_e,y:z,yRanges:f(Z,We&&Pt,At,Wt,p,x),y0:Be,dy:Xe,z:I,pts:te}};function a(o,s,m,g){var p=new Array(o),v;if(g)for(v=0;v<o;v++)p[v]=1/(s[v+1]-s[v]);else{var x=1/m;for(v=0;v<o;v++)p[v]=x}return p}function r(o,s){return{start:o(s.start),end:o(s.end),size:s.size}}function f(o,s,m,g,p,v){var x,l=o.length-1,b=new Array(l),c=i(m,g,o,p,v);for(x=0;x<l;x++){var M=(s||[])[x];b[x]=M===void 0?[c(o[x]),c(o[x+1],!0)]:[M,M]}return b}},{"../../lib":515,"../../plots/cartesian/axes":566,"../histogram/average":822,"../histogram/bin_functions":824,"../histogram/bin_label_vals":825,"../histogram/calc":826,"../histogram/norm_functions":833}],836:[function(t,P,R){var h=t("../../lib"),u=t("./sample_defaults"),A=t("../heatmap/style_defaults"),T=t("../../components/colorscale/defaults"),e=t("../heatmap/label_defaults"),i=t("./attributes");P.exports=function(a,r,f,o){function s(m,g){return h.coerce(a,r,i,m,g)}u(a,r,s,o),r.visible!==!1&&(A(a,r,s,o),T(a,r,o,s,{prefix:"",cLetter:"z"}),s("hovertemplate"),e(s,o),s("xhoverformat"),s("yhoverformat"))}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/style_defaults":815,"./attributes":834,"./sample_defaults":839}],837:[function(t,P,R){var h=t("../heatmap/hover"),u=t("../../plots/cartesian/axes").hoverLabelText;P.exports=function(T,e,i,n,a){var r=h(T,e,i,n,a);if(!!r){T=r[0];var f=T.index,o=f[0],s=f[1],m=T.cd[0],g=m.trace,p=m.xRanges[s],v=m.yRanges[o];return T.xLabel=u(T.xa,[p[0],p[1]],g.xhoverformat),T.yLabel=u(T.ya,[v[0],v[1]],g.yhoverformat),r}}},{"../../plots/cartesian/axes":566,"../heatmap/hover":808}],838:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),crossTraceDefaults:t("../histogram/cross_trace_defaults"),calc:t("../heatmap/calc"),plot:t("../heatmap/plot"),layerName:"heatmaplayer",colorbar:t("../heatmap/colorbar"),style:t("../heatmap/style"),hoverPoints:t("./hover"),eventData:t("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../heatmap/calc":802,"../heatmap/colorbar":804,"../heatmap/plot":813,"../heatmap/style":814,"../histogram/cross_trace_defaults":828,"../histogram/event_data":830,"./attributes":834,"./defaults":836,"./hover":837}],839:[function(t,P,R){var h=t("../../registry"),u=t("../../lib");P.exports=function(T,e,i,n){var a=i("x"),r=i("y"),f=u.minRowLength(a),o=u.minRowLength(r);if(!f||!o){e.visible=!1;return}e._length=Math.min(f,o);var s=h.getComponentMethod("calendars","handleTraceDefaults");s(T,e,["x","y"],n);var m=i("z")||i("marker.color");m&&i("histfunc"),i("histnorm"),i("autobinx"),i("autobiny")}},{"../../lib":515,"../../registry":647}],840:[function(t,P,R){var h=t("../histogram2d/attributes"),u=t("../contour/attributes"),A=t("../../components/colorscale/attributes"),T=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=t("../../lib/extend").extendFlat;P.exports=e({x:h.x,y:h.y,z:h.z,marker:h.marker,histnorm:h.histnorm,histfunc:h.histfunc,nbinsx:h.nbinsx,xbins:h.xbins,nbinsy:h.nbinsy,ybins:h.ybins,autobinx:h.autobinx,autobiny:h.autobiny,bingroup:h.bingroup,xbingroup:h.xbingroup,ybingroup:h.ybingroup,autocontour:u.autocontour,ncontours:u.ncontours,contours:u.contours,line:{color:u.line.color,width:e({},u.line.width,{dflt:.5}),dash:u.line.dash,smoothing:u.line.smoothing,editType:"plot"},xhoverformat:T("x"),yhoverformat:T("y"),zhoverformat:T("z",1),hovertemplate:h.hovertemplate,texttemplate:u.texttemplate,textfont:u.textfont},A("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../contour/attributes":744,"../histogram2d/attributes":834}],841:[function(t,P,R){var h=t("../../lib"),u=t("../histogram2d/sample_defaults"),A=t("../contour/contours_defaults"),T=t("../contour/style_defaults"),e=t("../heatmap/label_defaults"),i=t("./attributes");P.exports=function(a,r,f,o){function s(g,p){return h.coerce(a,r,i,g,p)}function m(g){return h.coerce2(a,r,i,g)}u(a,r,s,o),r.visible!==!1&&(A(a,r,s,m),T(a,r,s,o),s("xhoverformat"),s("yhoverformat"),s("hovertemplate"),r.contours&&r.contours.coloring==="heatmap"&&e(s,o))}},{"../../lib":515,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/label_defaults":811,"../histogram2d/sample_defaults":839,"./attributes":840}],842:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),crossTraceDefaults:t("../histogram/cross_trace_defaults"),calc:t("../contour/calc"),plot:t("../contour/plot").plot,layerName:"contourlayer",style:t("../contour/style"),colorbar:t("../contour/colorbar"),hoverPoints:t("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../contour/calc":745,"../contour/colorbar":747,"../contour/hover":757,"../contour/plot":762,"../contour/style":764,"../histogram/cross_trace_defaults":828,"./attributes":840,"./defaults":841}],843:[function(t,P,R){var h=t("../../plots/template_attributes").hovertemplateAttrs,u=t("../../plots/template_attributes").texttemplateAttrs,A=t("../../components/colorscale/attributes"),T=t("../../plots/domain").attributes,e=t("../pie/attributes"),i=t("../sunburst/attributes"),n=t("../treemap/attributes"),a=t("../treemap/constants"),r=t("../../lib/extend").extendFlat;P.exports={labels:i.labels,parents:i.parents,values:i.values,branchvalues:i.branchvalues,count:i.count,level:i.level,maxdepth:i.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:n.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:r({colors:i.marker.colors,line:i.marker.line,editType:"calc"},A("marker",{colorAttr:"colors",anim:!1})),leaf:i.leaf,pathbar:n.pathbar,text:e.text,textinfo:i.textinfo,texttemplate:u({editType:"plot"},{keys:a.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:i.hoverinfo,hovertemplate:h({},{keys:a.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:n.outsidetextfont,textposition:n.textposition,sort:e.sort,root:i.root,domain:T({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"../treemap/attributes":1084,"../treemap/constants":1087}],844:[function(t,P,R){var h=t("../../plots/plots");R.name="icicle",R.plot=function(u,A,T,e){h.plotBasePlot(R.name,u,A,T,e)},R.clean=function(u,A,T,e){h.cleanBasePlot(R.name,u,A,T,e)}},{"../../plots/plots":628}],845:[function(t,P,R){var h=t("../sunburst/calc");R.calc=function(u,A){return h.calc(u,A)},R.crossTraceCalc=function(u){return h._runCrossTraceCalc("icicle",u)}},{"../sunburst/calc":1060}],846:[function(t,P,R){var h=t("../../lib"),u=t("./attributes"),A=t("../../components/color"),T=t("../../plots/domain").defaults,e=t("../bar/defaults").handleText,i=t("../bar/constants").TEXTPAD,n=t("../../components/colorscale"),a=n.hasColorscale,r=n.handleDefaults;P.exports=function(o,s,m,g){function p(w,d){return h.coerce(o,s,u,w,d)}var v=p("labels"),x=p("parents");if(!v||!v.length||!x||!x.length){s.visible=!1;return}var l=p("values");l&&l.length?p("branchvalues"):p("count"),p("level"),p("maxdepth"),p("tiling.orientation"),p("tiling.flip"),p("tiling.pad");var b=p("text");p("texttemplate"),s.texttemplate||p("textinfo",Array.isArray(b)?"text+label":"label"),p("hovertext"),p("hovertemplate");var c=p("pathbar.visible"),M="auto";e(o,s,g,p,M,{hasPathbar:c,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),p("textposition");var _=p("marker.line.width");_&&p("marker.line.color",g.paper_bgcolor),p("marker.colors");var y=s._hasColorscale=a(o,"marker","colors")||(o.marker||{}).coloraxis;y&&r(o,s,g,p,{prefix:"marker.",cLetter:"c"}),p("leaf.opacity",y?1:.7),s._hovered={marker:{line:{width:2,color:A.contrast(g.paper_bgcolor)}}},c&&(p("pathbar.thickness",s.pathbar.textfont.size+2*i),p("pathbar.side"),p("pathbar.edgeshape")),p("sort"),p("root.color"),T(s,g,p),s._length=null}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":843}],847:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=t("../../components/drawing"),T=t("../../lib/svg_text_utils"),e=t("./partition"),i=t("./style").styleOne,n=t("../treemap/constants"),a=t("../sunburst/helpers"),r=t("../sunburst/fx"),f=t("../sunburst/plot").formatSliceLabel,o=!1;P.exports=function(m,g,p,v,x){var l=x.width,b=x.height,c=x.viewX,M=x.viewY,_=x.pathSlice,y=x.toMoveInsideSlice,w=x.strTransform,d=x.hasTransition,C=x.handleSlicesExit,S=x.makeUpdateSliceInterpolator,E=x.makeUpdateTextInterpolator,k=x.prevEntry,B={},z=m._context.staticPlot,F=m._fullLayout,I=g[0],O=I.trace,N=O.textposition.indexOf("left")!==-1,V=O.textposition.indexOf("right")!==-1,H=O.textposition.indexOf("bottom")!==-1,j=e(p,[l,b],{flipX:O.tiling.flip.indexOf("x")>-1,flipY:O.tiling.flip.indexOf("y")>-1,orientation:O.tiling.orientation,pad:{inner:O.tiling.pad},maxDepth:O._maxDepth}),Z=j.descendants(),X=1/0,re=-1/0;Z.forEach(function(Y){var ee=Y.depth;ee>=O._maxDepth?(Y.x0=Y.x1=(Y.x0+Y.x1)/2,Y.y0=Y.y1=(Y.y0+Y.y1)/2):(X=Math.min(X,ee),re=Math.max(re,ee))}),v=v.data(Z,a.getPtId),O._maxVisibleLayers=isFinite(re)?re-X+1:0,v.enter().append("g").classed("slice",!0),C(v,o,B,[l,b],_),v.order();var ue=null;if(d&&k){var K=a.getPtId(k);v.each(function(Y){ue===null&&a.getPtId(Y)===K&&(ue={x0:Y.x0,x1:Y.x1,y0:Y.y0,y1:Y.y1})})}var te=function(){return ue||{x0:0,x1:l,y0:0,y1:b}},G=v;return d&&(G=G.transition().each("end",function(){var Y=h.select(this);a.setSliceCursor(Y,m,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),G.each(function(Y){Y._x0=c(Y.x0),Y._x1=c(Y.x1),Y._y0=M(Y.y0),Y._y1=M(Y.y1),Y._hoverX=c(Y.x1-O.tiling.pad),Y._hoverY=M(H?Y.y1-O.tiling.pad/2:Y.y0+O.tiling.pad/2);var ee=h.select(this),ne=u.ensureSingle(ee,"path","surface",function(le){le.style("pointer-events",z?"none":"all")});d?ne.transition().attrTween("d",function(le){var ie=S(le,o,te(),[l,b],{orientation:O.tiling.orientation,flipX:O.tiling.flip.indexOf("x")>-1,flipY:O.tiling.flip.indexOf("y")>-1});return function(se){return _(ie(se))}}):ne.attr("d",_),ee.call(r,p,m,g,{styleOne:i,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,m,{isTransitioning:m._transitioning}),ne.call(i,Y,O,{hovered:!1}),Y.x0===Y.x1||Y.y0===Y.y1?Y._text="":Y._text=f(Y,p,O,g,F)||"";var J=u.ensureSingle(ee,"g","slicetext"),q=u.ensureSingle(J,"text","",function(le){le.attr("data-notex",1)}),ae=u.ensureUniformFontSize(m,a.determineTextFont(O,Y,F.font));q.text(Y._text||" ").classed("slicetext",!0).attr("text-anchor",V?"end":N?"start":"middle").call(A.font,ae).call(T.convertToTspans,m),Y.textBB=A.bBox(q.node()),Y.transform=y(Y,{fontSize:ae.size}),Y.transform.fontSize=ae.size,d?q.transition().attrTween("transform",function(le){var ie=E(le,o,te(),[l,b]);return function(se){return w(ie(se))}}):q.attr("transform",w(Y))}),ue}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"../treemap/constants":1087,"./partition":851,"./style":853,"@plotly/d3":58}],848:[function(t,P,R){P.exports={moduleType:"trace",name:"icicle",basePlotModule:t("./base_plot"),categories:[],animatable:!0,attributes:t("./attributes"),layoutAttributes:t("./layout_attributes"),supplyDefaults:t("./defaults"),supplyLayoutDefaults:t("./layout_defaults"),calc:t("./calc").calc,crossTraceCalc:t("./calc").crossTraceCalc,plot:t("./plot"),style:t("./style").style,colorbar:t("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":843,"./base_plot":844,"./calc":845,"./defaults":846,"./layout_attributes":849,"./layout_defaults":850,"./plot":852,"./style":853}],849:[function(t,P,R){P.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],850:[function(t,P,R){var h=t("../../lib"),u=t("./layout_attributes");P.exports=function(T,e){function i(n,a){return h.coerce(T,e,u,n,a)}i("iciclecolorway",e.colorway),i("extendiciclecolors")}},{"../../lib":515,"./layout_attributes":849}],851:[function(t,P,R){var h=t("d3-hierarchy"),u=t("../treemap/flip_tree");P.exports=function(T,e,i){var n=i.flipX,a=i.flipY,r=i.orientation==="h",f=i.maxDepth,o=e[0],s=e[1];f&&(o=(T.height+1)*e[0]/Math.min(T.height+1,f),s=(T.height+1)*e[1]/Math.min(T.height+1,f));var m=h.partition().padding(i.pad.inner).size(r?[e[1],o]:[e[0],s])(T);return(r||n||a)&&u(m,e,{swapXY:r,flipX:n,flipY:a}),m}},{"../treemap/flip_tree":1092,"d3-hierarchy":115}],852:[function(t,P,R){var h=t("../treemap/draw"),u=t("./draw_descendants");P.exports=function(T,e,i,n){return h(T,e,i,n,{type:"icicle",drawDescendants:u})}},{"../treemap/draw":1089,"./draw_descendants":847}],853:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/color"),A=t("../../lib"),T=t("../bar/uniform_text").resizeText;function e(n){var a=n._fullLayout._iciclelayer.selectAll(".trace");T(n,a,"icicle"),a.each(function(r){var f=h.select(this),o=r[0],s=o.trace;f.style("opacity",s.opacity),f.selectAll("path.surface").each(function(m){h.select(this).call(i,m,s)})})}function i(n,a,r){var f=a.data.data,o=!a.children,s=f.i,m=A.castOption(r,s,"marker.line.color")||u.defaultLine,g=A.castOption(r,s,"marker.line.width")||0;n.style("stroke-width",g).call(u.fill,f.color).call(u.stroke,m).style("opacity",o?r.leaf.opacity:null)}P.exports={style:e,styleOne:i}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],854:[function(t,P,R){for(var h=t("../../plots/attributes"),u=t("../../plots/template_attributes").hovertemplateAttrs,A=t("../../lib/extend").extendFlat,T=t("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],i=[],n=[],a=0;a<e.length;a++){var r=T[e[a]];i.push("For the `"+e[a]+"` colormodel, it is ["+(r.zminDflt||r.min).join(", ")+"]."),n.push("For the `"+e[a]+"` colormodel, it is ["+(r.zmaxDflt||r.max).join(", ")+"].")}P.exports=A({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:A({},h.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:u({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"./constants":856}],855:[function(t,P,R){var h=t("../../lib"),u=t("./constants"),A=t("fast-isnumeric"),T=t("../../plots/cartesian/axes"),e=t("../../lib").maxRowLength,i=t("./helpers").getImageSize;P.exports=function(o,s){var m,g;if(s._hasZ)m=s.z.length,g=e(s.z);else if(s._hasSource){var p=i(s.source);m=p.height,g=p.width}var v=T.getFromId(o,s.xaxis||"x"),x=T.getFromId(o,s.yaxis||"y"),l=v.d2c(s.x0)-s.dx/2,b=x.d2c(s.y0)-s.dy/2,c,M=[l,l+g*s.dx],_=[b,b+m*s.dy];if(v&&v.type==="log")for(c=0;c<g;c++)M.push(l+c*s.dx);if(x&&x.type==="log")for(c=0;c<m;c++)_.push(b+c*s.dy);s._extremes[v._id]=T.findExtremes(v,M),s._extremes[x._id]=T.findExtremes(x,_),s._scaler=r(s);var y={x0:l,y0:b,z:s.z,w:g,h:m};return[y]};function n(f,o,s,m){return function(g){return h.constrain((g-f)*o,s,m)}}function a(f,o){return function(s){return h.constrain(s,f,o)}}function r(f){var o=u.colormodel[f.colormodel],s=o.colormodel||f.colormodel,m=s.length;f._sArray=[];for(var g=0;g<m;g++)o.min[g]!==f.zmin[g]||o.max[g]!==f.zmax[g]?f._sArray.push(n(f.zmin[g],(o.max[g]-o.min[g])/(f.zmax[g]-f.zmin[g]),o.min[g],o.max[g])):f._sArray.push(a(o.min[g],o.max[g]));return function(p){for(var v=p.slice(0,m),x=0;x<m;x++){var l=v[x];if(!A(l))return!1;v[x]=f._sArray[x](l)}return v}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":856,"./helpers":859,"fast-isnumeric":190}],856:[function(t,P,R){P.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(h){return h.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(h){return h.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(h){return h.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(h){var u=h.slice(0,3);return u[1]=u[1]+"%",u[2]=u[2]+"%",u},suffix:["\xB0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(h){var u=h.slice(0,4);return u[1]=u[1]+"%",u[2]=u[2]+"%",u},suffix:["\xB0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],857:[function(t,P,R){var h=t("../../lib"),u=t("./attributes"),A=t("./constants"),T=t("../../snapshot/helpers").IMAGE_URL_PREFIX;P.exports=function(i,n){function a(o,s){return h.coerce(i,n,u,o,s)}a("source"),n.source&&!n.source.match(T)&&delete n.source,n._hasSource=!!n.source;var r=a("z");if(n._hasZ=!(r===void 0||!r.length||!r[0]||!r[0].length),!n._hasZ&&!n._hasSource){n.visible=!1;return}a("x0"),a("y0"),a("dx"),a("dy");var f;n._hasZ?(a("colormodel","rgb"),f=A.colormodel[n.colormodel],a("zmin",f.zminDflt||f.min),a("zmax",f.zmaxDflt||f.max)):n._hasSource&&(n.colormodel="rgba256",f=A.colormodel[n.colormodel],n.zmin=f.zminDflt,n.zmax=f.zmaxDflt),a("zsmooth"),a("text"),a("hovertext"),a("hovertemplate"),n._length=null}},{"../../lib":515,"../../snapshot/helpers":651,"./attributes":854,"./constants":856}],858:[function(t,P,R){P.exports=function(u,A){return"xVal"in A&&(u.x=A.xVal),"yVal"in A&&(u.y=A.yVal),A.xa&&(u.xaxis=A.xa),A.ya&&(u.yaxis=A.ya),u.color=A.color,u.colormodel=A.trace.colormodel,u.z||(u.z=A.color),u}},{}],859:[function(t,P,R){var h=t("probe-image-size/sync"),u=t("../../snapshot/helpers").IMAGE_URL_PREFIX,A=t("buffer/").Buffer;R.getImageSize=function(T){var e=T.replace(u,""),i=new A(e,"base64");return h(i)}},{"../../snapshot/helpers":651,"buffer/":85,"probe-image-size/sync":277}],860:[function(t,P,R){var h=t("../../components/fx"),u=t("../../lib"),A=t("./constants");P.exports=function(e,i,n){var a=e.cd[0],r=a.trace,f=e.xa,o=e.ya;if(!(h.inbox(i-a.x0,i-(a.x0+a.w*r.dx),0)>0||h.inbox(n-a.y0,n-(a.y0+a.h*r.dy),0)>0)){var s=Math.floor((i-a.x0)/r.dx),m=Math.floor(Math.abs(n-a.y0)/r.dy),g;if(r._hasZ?g=a.z[m][s]:r._hasSource&&(g=r._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(s,m,1,1).data),!!g){var p=a.hi||r.hoverinfo,v;if(p){var x=p.split("+");x.indexOf("all")!==-1&&(x=["color"]),x.indexOf("color")!==-1&&(v=!0)}var l=A.colormodel[r.colormodel],b=l.colormodel||r.colormodel,c=b.length,M=r._scaler(g),_=l.suffix,y=[];(r.hovertemplate||v)&&(y.push("["+[M[0]+_[0],M[1]+_[1],M[2]+_[2]].join(", ")),c===4&&y.push(", "+M[3]+_[3]),y.push("]"),y=y.join(""),e.extraText=b.toUpperCase()+": "+y);var w;Array.isArray(r.hovertext)&&Array.isArray(r.hovertext[m])?w=r.hovertext[m][s]:Array.isArray(r.text)&&Array.isArray(r.text[m])&&(w=r.text[m][s]);var d=o.c2p(a.y0+(m+.5)*r.dy),C=a.x0+(s+.5)*r.dx,S=a.y0+(m+.5)*r.dy,E="["+g.slice(0,r.colormodel.length).join(", ")+"]";return[u.extendFlat(e,{index:[m,s],x0:f.c2p(a.x0+s*r.dx),x1:f.c2p(a.x0+(s+1)*r.dx),y0:d,y1:d,color:M,xVal:C,xLabelVal:C,yVal:S,yLabelVal:S,zLabelVal:E,text:w,hovertemplateLabels:{zLabel:E,colorLabel:y,"color[0]Label":M[0]+_[0],"color[1]Label":M[1]+_[1],"color[2]Label":M[2]+_[2],"color[3]Label":M[3]+_[3]}})]}}}},{"../../components/fx":407,"../../lib":515,"./constants":856}],861:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),calc:t("./calc"),plot:t("./plot"),style:t("./style"),hoverPoints:t("./hover"),eventData:t("./event_data"),moduleType:"trace",name:"image",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":578,"./attributes":854,"./calc":855,"./defaults":857,"./event_data":858,"./hover":860,"./plot":862,"./style":863}],862:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=u.strTranslate,T=t("../../constants/xmlns_namespaces"),e=t("./constants"),i=u.isIOS()||u.isSafari()||u.isIE();P.exports=function(a,r,f,o){var s=r.xaxis,m=r.yaxis,g=!(i||a._context._exportedPlot);u.makeTraceGroups(o,f,"im").each(function(p){var v=h.select(this),x=p[0],l=x.trace,b=(l.zsmooth==="fast"||l.zsmooth===!1&&g)&&!l._hasZ&&l._hasSource&&s.type==="linear"&&m.type==="linear";l._realImage=b;var c=x.z,M=x.x0,_=x.y0,y=x.w,w=x.h,d=l.dx,C=l.dy,S,E,k,B,z,F;for(F=0;S===void 0&&F<y;)S=s.c2p(M+F*d),F++;for(F=y;E===void 0&&F>0;)E=s.c2p(M+F*d),F--;for(F=0;B===void 0&&F<w;)B=m.c2p(_+F*C),F++;for(F=w;z===void 0&&F>0;)z=m.c2p(_+F*C),F--;if(E<S&&(k=E,E=S,S=k),z<B&&(k=B,B=z,z=k),!b){var I=.5;S=Math.max(-I*s._length,S),E=Math.min((1+I)*s._length,E),B=Math.max(-I*m._length,B),z=Math.min((1+I)*m._length,z)}var O=Math.round(E-S),N=Math.round(z-B),V=O<=0||N<=0;if(V){var H=v.selectAll("image").data([]);H.exit().remove();return}function j(ne){var J=document.createElement("canvas");J.width=O,J.height=N;var q=J.getContext("2d",{willReadFrequently:!0}),ae=function(De){return u.constrain(Math.round(s.c2p(M+De*d)-S),0,O)},le=function(De){return u.constrain(Math.round(m.c2p(_+De*C)-B),0,N)},ie=e.colormodel[l.colormodel],se=ie.colormodel||l.colormodel,xe=ie.fmt,oe;for(F=0;F<x.w;F++){var he=ae(F),be=ae(F+1);if(!(be===he||isNaN(be)||isNaN(he)))for(var me=0;me<x.h;me++){var _e=le(me),Se=le(me+1);Se===_e||isNaN(Se)||isNaN(_e)||!ne(F,me)||(oe=l._scaler(ne(F,me)),oe?q.fillStyle=se+"("+xe(oe).join(",")+")":q.fillStyle="rgba(0,0,0,0)",q.fillRect(he,_e,be-he,Se-_e))}}return J}var Z=v.selectAll("image").data([p]);Z.enter().append("svg:image").attr({xmlns:T.svg,preserveAspectRatio:"none"}),Z.exit().remove();var X=l.zsmooth===!1?e.pixelatedStyle:"";if(b){var re=u.simpleMap(s.range,s.r2l),ue=u.simpleMap(m.range,m.r2l),K=re[1]<re[0],te=ue[1]>ue[0];if(K||te){var G=S+O/2,Y=B+N/2;X+="transform:"+A(G+"px",Y+"px")+"scale("+(K?-1:1)+","+(te?-1:1)+")"+A(-G+"px",-Y+"px")+";"}}Z.attr("style",X);var ee=new Promise(function(ne){if(l._hasZ)ne();else if(l._hasSource)if(l._canvas&&l._canvas.el.width===y&&l._canvas.el.height===w&&l._canvas.source===l.source)ne();else{var J=document.createElement("canvas");J.width=y,J.height=w;var q=J.getContext("2d",{willReadFrequently:!0});l._image=l._image||new Image;var ae=l._image;ae.onload=function(){q.drawImage(ae,0,0),l._canvas={el:J,source:l.source},ne()},ae.setAttribute("src",l.source)}}).then(function(){var ne,J;if(l._hasZ)J=j(function(le,ie){return c[ie][le]}),ne=J.toDataURL("image/png");else if(l._hasSource)if(b)ne=l.source;else{var q=l._canvas.el.getContext("2d",{willReadFrequently:!0}),ae=q.getImageData(0,0,y,w).data;J=j(function(le,ie){var se=4*(ie*y+le);return[ae[se],ae[se+1],ae[se+2],ae[se+3]]}),ne=J.toDataURL("image/png")}Z.attr({"xlink:href":ne,height:N,width:O,x:S,y:B})});a._promises.push(ee)})}},{"../../constants/xmlns_namespaces":492,"../../lib":515,"./constants":856,"@plotly/d3":58}],863:[function(t,P,R){var h=t("@plotly/d3");P.exports=function(A){h.select(A).selectAll(".im image").style("opacity",function(T){return T[0].trace.opacity})}},{"@plotly/d3":58}],864:[function(t,P,R){var h=t("../../lib/extend").extendFlat,u=t("../../lib/extend").extendDeep,A=t("../../plot_api/edit_types").overrideAll,T=t("../../plots/font_attributes"),e=t("../../components/color/attributes"),i=t("../../plots/domain").attributes,n=t("../../plots/cartesian/layout_attributes"),a=t("../../plot_api/plot_template").templatedArray,r=t("../../constants/delta.js"),f=t("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,o=T({editType:"plot",colorEditType:"plot"}),s={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},m={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},g=a("step",u({},s,{range:m}));P.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:i({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:h({},o,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:f("value")},font:h({},o,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:f("value")},increasing:{symbol:{valType:"string",dflt:r.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:r.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:r.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:r.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:h({},o,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:u({},s,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:A({range:m,visible:h({},n.visible,{dflt:!0}),tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:h({},n.ticks,{dflt:"outside"}),ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,ticklabelstep:n.ticklabelstep,showticklabels:n.showticklabels,tickfont:T({}),tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,tickprefix:n.tickprefix,showtickprefix:n.showtickprefix,ticksuffix:n.ticksuffix,showticksuffix:n.showticksuffix,separatethousands:n.separatethousands,exponentformat:n.exponentformat,minexponent:n.minexponent,showexponent:n.showexponent,editType:"plot"},"plot"),steps:g,threshold:{line:{color:h({},s.line.color,{}),width:h({},s.line.width,{dflt:1}),editType:"plot"},thickness:h({},s.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":366,"../../constants/delta.js":485,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],865:[function(t,P,R){var h=t("../../plots/plots");R.name="indicator",R.plot=function(u,A,T,e){h.plotBasePlot(R.name,u,A,T,e)},R.clean=function(u,A,T,e){h.cleanBasePlot(R.name,u,A,T,e)}},{"../../plots/plots":628}],866:[function(t,P,R){function h(u,A){var T=[],e=A.value;typeof A._lastValue!="number"&&(A._lastValue=A.value);var i=A._lastValue,n=i;return A._hasDelta&&typeof A.delta.reference=="number"&&(n=A.delta.reference),T[0]={y:e,lastY:i,delta:e-n,relativeDelta:(e-n)/n},T}P.exports={calc:h}},{}],867:[function(t,P,R){P.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],868:[function(t,P,R){var h=t("../../lib"),u=t("./attributes"),A=t("../../plots/domain").defaults,T=t("../../plot_api/plot_template"),e=t("../../plots/array_container_defaults"),i=t("./constants.js"),n=t("../../plots/cartesian/tick_value_defaults"),a=t("../../plots/cartesian/tick_mark_defaults"),r=t("../../plots/cartesian/tick_label_defaults"),f=t("../../plots/cartesian/prefix_suffix_defaults");function o(m,g,p,v){function x(F,I){return h.coerce(m,g,u,F,I)}A(g,v,x),x("mode"),g._hasNumber=g.mode.indexOf("number")!==-1,g._hasDelta=g.mode.indexOf("delta")!==-1,g._hasGauge=g.mode.indexOf("gauge")!==-1;var l=x("value");g._range=[0,typeof l=="number"?1.5*l:1];var b=new Array(2),c;g._hasNumber&&(x("number.valueformat"),x("number.font.color",v.font.color),x("number.font.family",v.font.family),x("number.font.size"),g.number.font.size===void 0&&(g.number.font.size=i.defaultNumberFontSize,b[0]=!0),x("number.prefix"),x("number.suffix"),c=g.number.font.size);var M;g._hasDelta&&(x("delta.font.color",v.font.color),x("delta.font.family",v.font.family),x("delta.font.size"),g.delta.font.size===void 0&&(g.delta.font.size=(g._hasNumber?.5:1)*(c||i.defaultNumberFontSize),b[1]=!0),x("delta.reference",g.value),x("delta.relative"),x("delta.valueformat",g.delta.relative?"2%":""),x("delta.increasing.symbol"),x("delta.increasing.color"),x("delta.decreasing.symbol"),x("delta.decreasing.color"),x("delta.position"),x("delta.prefix"),x("delta.suffix"),M=g.delta.font.size),g._scaleNumbers=(!g._hasNumber||b[0])&&(!g._hasDelta||b[1])||!1,x("title.font.color",v.font.color),x("title.font.family",v.font.family),x("title.font.size",.25*(c||M||i.defaultNumberFontSize)),x("title.text");var _,y,w,d;function C(F,I){return h.coerce(_,y,u.gauge,F,I)}function S(F,I){return h.coerce(w,d,u.gauge.axis,F,I)}if(g._hasGauge){_=m.gauge,_||(_={}),y=T.newContainer(g,"gauge"),C("shape");var E=g._isBullet=g.gauge.shape==="bullet";E||x("title.align","center");var k=g._isAngular=g.gauge.shape==="angular";k||x("align","center"),C("bgcolor",v.paper_bgcolor),C("borderwidth"),C("bordercolor"),C("bar.color"),C("bar.line.color"),C("bar.line.width");var B=i.valueThickness*(g.gauge.shape==="bullet"?.5:1);C("bar.thickness",B),e(_,y,{name:"steps",handleItemDefaults:s}),C("threshold.value"),C("threshold.thickness"),C("threshold.line.width"),C("threshold.line.color"),w={},_&&(w=_.axis||{}),d=T.newContainer(y,"axis"),S("visible"),g._range=S("range",g._range);var z={outerTicks:!0};n(w,d,S,"linear"),f(w,d,S,"linear",z),r(w,d,S,"linear",z),a(w,d,S,z)}else x("title.align","center"),x("align","center"),g._isAngular=g._isBullet=!1;g._length=null}function s(m,g){function p(v,x){return h.coerce(m,g,u.gauge.steps,v,x)}p("color"),p("line.color"),p("line.width"),p("range"),p("thickness")}P.exports={supplyDefaults:o}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"../../plots/domain":593,"./attributes":864,"./constants.js":867}],869:[function(t,P,R){P.exports={moduleType:"trace",name:"indicator",basePlotModule:t("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:t("./attributes"),supplyDefaults:t("./defaults").supplyDefaults,calc:t("./calc").calc,plot:t("./plot"),meta:{}}},{"./attributes":864,"./base_plot":865,"./calc":866,"./defaults":868,"./plot":870}],870:[function(t,P,R){var h=t("@plotly/d3"),u=t("d3-interpolate").interpolate,A=t("d3-interpolate").interpolateNumber,T=t("../../lib"),e=T.strScale,i=T.strTranslate,n=T.rad2deg,a=t("../../constants/alignment").MID_SHIFT,r=t("../../components/drawing"),f=t("./constants"),o=t("../../lib/svg_text_utils"),s=t("../../plots/cartesian/axes"),m=t("../../plots/cartesian/axis_defaults"),g=t("../../plots/cartesian/position_defaults"),p=t("../../plots/cartesian/layout_attributes"),v=t("../../components/color"),x={left:"start",center:"middle",right:"end"},l={left:0,center:.5,right:1},b=/[yzafpnµmkMGTPEZY]/;function c(z){return z&&z.duration>0}P.exports=function(F,I,O,N){var V=F._fullLayout,H;c(O)&&N&&(H=N()),T.makeTraceGroups(V._indicatorlayer,I,"trace").each(function(j){var Z=j[0],X=Z.trace,re=h.select(this),ue=X._hasGauge,K=X._isAngular,te=X._isBullet,G=X.domain,Y={w:V._size.w*(G.x[1]-G.x[0]),h:V._size.h*(G.y[1]-G.y[0]),l:V._size.l+V._size.w*G.x[0],r:V._size.r+V._size.w*(1-G.x[1]),t:V._size.t+V._size.h*(1-G.y[1]),b:V._size.b+V._size.h*G.y[0]},ee=Y.l+Y.w/2,ne=Y.t+Y.h/2,J=Math.min(Y.w/2,Y.h),q=f.innerRadius*J,ae,le,ie,se=X.align||"center";if(le=ne,!ue)ae=Y.l+l[se]*Y.w,ie=function(Te){return S(Te,Y.w,Y.h)};else if(K&&(ae=ee,le=ne+J/2,ie=function(Te){return E(Te,.9*q)}),te){var xe=f.bulletPadding,oe=1-f.bulletNumberDomainSize+xe;ae=Y.l+(oe+(1-oe)*l[se])*Y.w,ie=function(Te){return S(Te,(f.bulletNumberDomainSize-xe)*Y.w,Y.h)}}y(F,re,j,{numbersX:ae,numbersY:le,numbersScaler:ie,transitionOpts:O,onComplete:H});var he,be;ue&&(he={range:X.gauge.axis.range,color:X.gauge.bgcolor,line:{color:X.gauge.bordercolor,width:0},thickness:1},be={range:X.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:X.gauge.bordercolor,width:X.gauge.borderwidth},thickness:1});var me=re.selectAll("g.angular").data(K?j:[]);me.exit().remove();var _e=re.selectAll("g.angularaxis").data(K?j:[]);_e.exit().remove(),K&&_(F,re,j,{radius:J,innerRadius:q,gauge:me,layer:_e,size:Y,gaugeBg:he,gaugeOutline:be,transitionOpts:O,onComplete:H});var Se=re.selectAll("g.bullet").data(te?j:[]);Se.exit().remove();var De=re.selectAll("g.bulletaxis").data(te?j:[]);De.exit().remove(),te&&M(F,re,j,{gauge:Se,layer:De,size:Y,gaugeBg:he,gaugeOutline:be,transitionOpts:O,onComplete:H});var Ie=re.selectAll("text.title").data(j);Ie.exit().remove(),Ie.enter().append("text").classed("title",!0),Ie.attr("text-anchor",function(){return te?x.right:x[X.title.align]}).text(X.title.text).call(r.font,X.title.font).call(o.convertToTspans,F),Ie.attr("transform",function(){var Te=Y.l+Y.w*l[X.title.align],Ce,He=f.titlePadding,Xe=r.bBox(Ie.node());if(ue){if(K)if(X.gauge.axis.visible){var Be=r.bBox(_e.node());Ce=Be.top-He-Xe.bottom}else Ce=Y.t+Y.h/2-J/2-Xe.bottom-He;te&&(Ce=le-(Xe.top+Xe.bottom)/2,Te=Y.l-f.bulletPadding*Y.w)}else Ce=X._numbersTop-He-Xe.bottom;return i(Te,Ce)})})};function M(z,F,I,O){var N=I[0].trace,V=O.gauge,H=O.layer,j=O.gaugeBg,Z=O.gaugeOutline,X=O.size,re=N.domain,ue=O.transitionOpts,K=O.onComplete,te,G,Y,ee,ne;V.enter().append("g").classed("bullet",!0),V.attr("transform",i(X.l,X.t)),H.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),H.selectAll("g.xbulletaxistick,path,text").remove();var J=X.h,q=N.gauge.bar.thickness*J,ae=re.x[0],le=re.x[0]+(re.x[1]-re.x[0])*(N._hasNumber||N._hasDelta?1-f.bulletNumberDomainSize:1);te=C(z,N.gauge.axis),te._id="xbulletaxis",te.domain=[ae,le],te.setScale(),G=s.calcTicks(te),Y=s.makeTransTickFn(te),ee=s.getTickSigns(te)[2],ne=X.t+X.h,te.visible&&(s.drawTicks(z,te,{vals:te.ticks==="inside"?s.clipEnds(te,G):G,layer:H,path:s.makeTickPath(te,ne,ee),transFn:Y}),s.drawLabels(z,te,{vals:G,layer:H,transFn:Y,labelFns:s.makeLabelFns(te,ne)}));function ie(_e){_e.attr("width",function(Se){return Math.max(0,te.c2p(Se.range[1])-te.c2p(Se.range[0]))}).attr("x",function(Se){return te.c2p(Se.range[0])}).attr("y",function(Se){return .5*(1-Se.thickness)*J}).attr("height",function(Se){return Se.thickness*J})}var se=[j].concat(N.gauge.steps),xe=V.selectAll("g.bg-bullet").data(se);xe.enter().append("g").classed("bg-bullet",!0).append("rect"),xe.select("rect").call(ie).call(w),xe.exit().remove();var oe=V.selectAll("g.value-bullet").data([N.gauge.bar]);oe.enter().append("g").classed("value-bullet",!0).append("rect"),oe.select("rect").attr("height",q).attr("y",(J-q)/2).call(w),c(ue)?oe.select("rect").transition().duration(ue.duration).ease(ue.easing).each("end",function(){K&&K()}).each("interrupt",function(){K&&K()}).attr("width",Math.max(0,te.c2p(Math.min(N.gauge.axis.range[1],I[0].y)))):oe.select("rect").attr("width",typeof I[0].y=="number"?Math.max(0,te.c2p(Math.min(N.gauge.axis.range[1],I[0].y))):0),oe.exit().remove();var he=I.filter(function(){return N.gauge.threshold.value||N.gauge.threshold.value===0}),be=V.selectAll("g.threshold-bullet").data(he);be.enter().append("g").classed("threshold-bullet",!0).append("line"),be.select("line").attr("x1",te.c2p(N.gauge.threshold.value)).attr("x2",te.c2p(N.gauge.threshold.value)).attr("y1",(1-N.gauge.threshold.thickness)/2*J).attr("y2",(1-(1-N.gauge.threshold.thickness)/2)*J).call(v.stroke,N.gauge.threshold.line.color).style("stroke-width",N.gauge.threshold.line.width),be.exit().remove();var me=V.selectAll("g.gauge-outline").data([Z]);me.enter().append("g").classed("gauge-outline",!0).append("rect"),me.select("rect").call(ie).call(w),me.exit().remove()}function _(z,F,I,O){var N=I[0].trace,V=O.size,H=O.radius,j=O.innerRadius,Z=O.gaugeBg,X=O.gaugeOutline,re=[V.l+V.w/2,V.t+V.h/2+H/2],ue=O.gauge,K=O.layer,te=O.transitionOpts,G=O.onComplete,Y=Math.PI/2;function ee(Re){var We=N.gauge.axis.range[0],vt=N.gauge.axis.range[1],Pt=(Re-We)/(vt-We)*Math.PI-Y;return Pt<-Y?-Y:Pt>Y?Y:Pt}function ne(Re){return h.svg.arc().innerRadius((j+H)/2-Re/2*(H-j)).outerRadius((j+H)/2+Re/2*(H-j)).startAngle(-Y)}function J(Re){Re.attr("d",function(We){return ne(We.thickness).startAngle(ee(We.range[0])).endAngle(ee(We.range[1]))()})}var q,ae,le,ie;ue.enter().append("g").classed("angular",!0),ue.attr("transform",i(re[0],re[1])),K.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),K.selectAll("g.xangularaxistick,path,text").remove(),q=C(z,N.gauge.axis),q.type="linear",q.range=N.gauge.axis.range,q._id="xangularaxis",q.ticklabeloverflow="allow",q.setScale();var se=function(Re){return(q.range[0]-Re.x)/(q.range[1]-q.range[0])*Math.PI+Math.PI},xe={},oe=s.makeLabelFns(q,0),he=oe.labelStandoff;xe.xFn=function(Re){var We=se(Re);return Math.cos(We)*he},xe.yFn=function(Re){var We=se(Re),vt=Math.sin(We)>0?.2:1;return-Math.sin(We)*(he+Re.fontSize*vt)+Math.abs(Math.cos(We))*(Re.fontSize*a)},xe.anchorFn=function(Re){var We=se(Re),vt=Math.cos(We);return Math.abs(vt)<.1?"middle":vt>0?"start":"end"},xe.heightFn=function(Re,We,vt){var Pt=se(Re);return-.5*(1+Math.sin(Pt))*vt};var be=function(Re){return i(re[0]+H*Math.cos(Re),re[1]-H*Math.sin(Re))};le=function(Re){return be(se(Re))};var me=function(Re){var We=se(Re);return be(We)+"rotate("+-n(We)+")"};if(ae=s.calcTicks(q),ie=s.getTickSigns(q)[2],q.visible){ie=q.ticks==="inside"?-1:1;var _e=(q.linewidth||1)/2;s.drawTicks(z,q,{vals:ae,layer:K,path:"M"+ie*_e+",0h"+ie*q.ticklen,transFn:me}),s.drawLabels(z,q,{vals:ae,layer:K,transFn:le,labelFns:xe})}var Se=[Z].concat(N.gauge.steps),De=ue.selectAll("g.bg-arc").data(Se);De.enter().append("g").classed("bg-arc",!0).append("path"),De.select("path").call(J).call(w),De.exit().remove();var Ie=ne(N.gauge.bar.thickness),Te=ue.selectAll("g.value-arc").data([N.gauge.bar]);Te.enter().append("g").classed("value-arc",!0).append("path");var Ce=Te.select("path");c(te)?(Ce.transition().duration(te.duration).ease(te.easing).each("end",function(){G&&G()}).each("interrupt",function(){G&&G()}).attrTween("d",d(Ie,ee(I[0].lastY),ee(I[0].y))),N._lastValue=I[0].y):Ce.attr("d",typeof I[0].y=="number"?Ie.endAngle(ee(I[0].y)):"M0,0Z"),Ce.call(w),Te.exit().remove(),Se=[];var He=N.gauge.threshold.value;(He||He===0)&&Se.push({range:[He,He],color:N.gauge.threshold.color,line:{color:N.gauge.threshold.line.color,width:N.gauge.threshold.line.width},thickness:N.gauge.threshold.thickness});var Xe=ue.selectAll("g.threshold-arc").data(Se);Xe.enter().append("g").classed("threshold-arc",!0).append("path"),Xe.select("path").call(J).call(w),Xe.exit().remove();var Be=ue.selectAll("g.gauge-outline").data([X]);Be.enter().append("g").classed("gauge-outline",!0).append("path"),Be.select("path").call(J).call(w),Be.exit().remove()}function y(z,F,I,O){var N=I[0].trace,V=O.numbersX,H=O.numbersY,j=N.align||"center",Z=x[j],X=O.transitionOpts,re=O.onComplete,ue=T.ensureSingle(F,"g","numbers"),K,te,G,Y=[];N._hasNumber&&Y.push("number"),N._hasDelta&&(Y.push("delta"),N.delta.position==="left"&&Y.reverse());var ee=ue.selectAll("text").data(Y);ee.enter().append("text"),ee.attr("text-anchor",function(){return Z}).attr("class",function(be){return be}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),ee.exit().remove();function ne(be,me,_e,Se){if(be.match("s")&&_e>=0!=Se>=0&&!me(_e).slice(-1).match(b)&&!me(Se).slice(-1).match(b)){var De=be.slice().replace("s","f").replace(/\d+/,function(Te){return parseInt(Te)-1}),Ie=C(z,{tickformat:De});return function(Te){return Math.abs(Te)<1?s.tickText(Ie,Te).text:me(Te)}}else return me}function J(){var be=C(z,{tickformat:N.number.valueformat},N._range);be.setScale(),s.prepTicks(be);var me=function(Te){return s.tickText(be,Te).text},_e=N.number.suffix,Se=N.number.prefix,De=ue.select("text.number");function Ie(){var Te=typeof I[0].y=="number"?Se+me(I[0].y)+_e:"-";De.text(Te).call(r.font,N.number.font).call(o.convertToTspans,z)}return c(X)?De.transition().duration(X.duration).ease(X.easing).each("end",function(){Ie(),re&&re()}).each("interrupt",function(){Ie(),re&&re()}).attrTween("text",function(){var Te=h.select(this),Ce=A(I[0].lastY,I[0].y);N._lastValue=I[0].y;var He=ne(N.number.valueformat,me,I[0].lastY,I[0].y);return function(Xe){Te.text(Se+He(Ce(Xe))+_e)}}):Ie(),K=k(Se+me(I[0].y)+_e,N.number.font,Z,z),De}function q(){var be=C(z,{tickformat:N.delta.valueformat},N._range);be.setScale(),s.prepTicks(be);var me=function(Xe){return s.tickText(be,Xe).text},_e=N.delta.suffix,Se=N.delta.prefix,De=function(Xe){var Be=N.delta.relative?Xe.relativeDelta:Xe.delta;return Be},Ie=function(Xe,Be){return Xe===0||typeof Xe!="number"||isNaN(Xe)?"-":(Xe>0?N.delta.increasing.symbol:N.delta.decreasing.symbol)+Se+Be(Xe)+_e},Te=function(Xe){return Xe.delta>=0?N.delta.increasing.color:N.delta.decreasing.color};N._deltaLastValue===void 0&&(N._deltaLastValue=De(I[0]));var Ce=ue.select("text.delta");Ce.call(r.font,N.delta.font).call(v.fill,Te({delta:N._deltaLastValue}));function He(){Ce.text(Ie(De(I[0]),me)).call(v.fill,Te(I[0])).call(o.convertToTspans,z)}return c(X)?Ce.transition().duration(X.duration).ease(X.easing).tween("text",function(){var Xe=h.select(this),Be=De(I[0]),Re=N._deltaLastValue,We=ne(N.delta.valueformat,me,Re,Be),vt=A(Re,Be);return N._deltaLastValue=Be,function(Pt){Xe.text(Ie(vt(Pt),We)),Xe.call(v.fill,Te({delta:vt(Pt)}))}}).each("end",function(){He(),re&&re()}).each("interrupt",function(){He(),re&&re()}):He(),te=k(Ie(De(I[0]),me),N.delta.font,Z,z),Ce}var ae=N.mode+N.align,le;if(N._hasDelta&&(le=q(),ae+=N.delta.position+N.delta.font.size+N.delta.font.family+N.delta.valueformat,ae+=N.delta.increasing.symbol+N.delta.decreasing.symbol,G=te),N._hasNumber&&(J(),ae+=N.number.font.size+N.number.font.family+N.number.valueformat+N.number.suffix+N.number.prefix,G=K),N._hasDelta&&N._hasNumber){var ie=[(K.left+K.right)/2,(K.top+K.bottom)/2],se=[(te.left+te.right)/2,(te.top+te.bottom)/2],xe,oe,he=.75*N.delta.font.size;N.delta.position==="left"&&(xe=B(N,"deltaPos",0,-1*(K.width*l[N.align]+te.width*(1-l[N.align])+he),ae,Math.min),oe=ie[1]-se[1],G={width:K.width+te.width+he,height:Math.max(K.height,te.height),left:te.left+xe,right:K.right,top:Math.min(K.top,te.top+oe),bottom:Math.max(K.bottom,te.bottom+oe)}),N.delta.position==="right"&&(xe=B(N,"deltaPos",0,K.width*(1-l[N.align])+te.width*l[N.align]+he,ae,Math.max),oe=ie[1]-se[1],G={width:K.width+te.width+he,height:Math.max(K.height,te.height),left:K.left,right:te.right+xe,top:Math.min(K.top,te.top+oe),bottom:Math.max(K.bottom,te.bottom+oe)}),N.delta.position==="bottom"&&(xe=null,oe=te.height,G={width:Math.max(K.width,te.width),height:K.height+te.height,left:Math.min(K.left,te.left),right:Math.max(K.right,te.right),top:K.bottom-K.height,bottom:K.bottom+te.height}),N.delta.position==="top"&&(xe=null,oe=K.top,G={width:Math.max(K.width,te.width),height:K.height+te.height,left:Math.min(K.left,te.left),right:Math.max(K.right,te.right),top:K.bottom-K.height-te.height,bottom:K.bottom}),le.attr({dx:xe,dy:oe})}(N._hasNumber||N._hasDelta)&&ue.attr("transform",function(){var be=O.numbersScaler(G);ae+=be[2];var me=B(N,"numbersScale",1,be[0],ae,Math.min),_e;N._scaleNumbers||(me=1),N._isAngular?_e=H-me*G.bottom:_e=H-me*(G.top+G.bottom)/2,N._numbersTop=me*G.top+_e;var Se=G[j];j==="center"&&(Se=(G.left+G.right)/2);var De=V-me*Se;return De=B(N,"numbersTranslate",0,De,ae,Math.max),i(De,_e)+e(me)})}function w(z){z.each(function(F){v.stroke(h.select(this),F.line.color)}).each(function(F){v.fill(h.select(this),F.color)}).style("stroke-width",function(F){return F.line.width})}function d(z,F,I){return function(){var O=u(F,I);return function(N){return z.endAngle(O(N))()}}}function C(z,F,I){var O=z._fullLayout,N=T.extendFlat({type:"linear",ticks:"outside",range:I,showline:!0},F),V={type:"linear",_id:"x"+F._id},H={letter:"x",font:O.font,noHover:!0,noTickson:!0};function j(Z,X){return T.coerce(N,V,p,Z,X)}return m(N,V,j,H,O),g(N,V,j,H),V}function S(z,F,I){var O=Math.min(F/z.width,I/z.height);return[O,z,F+"x"+I]}function E(z,F){var I=Math.sqrt(z.width/2*(z.width/2)+z.height*z.height),O=F/I;return[O,z,F]}function k(z,F,I,O){var N=document.createElementNS("http://www.w3.org/2000/svg","text"),V=h.select(N);return V.text(z).attr("x",0).attr("y",0).attr("text-anchor",I).attr("data-unformatted",z).call(o.convertToTspans,O).call(r.font,F),r.bBox(V.node())}function B(z,F,I,O,N,V){var H="_cache"+F;z[H]&&z[H].key===N||(z[H]={key:N,value:I});var j=T.aggNums(V,null,[z[H].value,O],2);return z[H].value=j,j}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"./constants":867,"@plotly/d3":58,"d3-interpolate":116}],871:[function(t,P,R){var h=t("../../components/colorscale/attributes"),u=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,A=t("../../plots/template_attributes").hovertemplateAttrs,T=t("../mesh3d/attributes"),e=t("../../plots/attributes"),i=t("../../lib/extend").extendFlat,n=t("../../plot_api/edit_types").overrideAll;function a(o){return{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}}function r(o){return{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}}var f=P.exports=n(i({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:a(),y:a(),z:a()},caps:{x:r(),y:r(),z:r()},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:A(),xhoverformat:u("x"),yhoverformat:u("y"),zhoverformat:u("z"),valuehoverformat:u("value",1),showlegend:i({},e.showlegend,{dflt:!1})},h("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:T.opacity,lightposition:T.lightposition,lighting:T.lighting,flatshading:T.flatshading,contour:T.contour,hoverinfo:i({},e.hoverinfo)}),"calc","nested");f.flatshading.dflt=!0,f.lighting.facenormalsepsilon.dflt=0,f.x.editType=f.y.editType=f.z.editType=f.value.editType="calc+clearAxisTypes",f.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],872:[function(t,P,R){var h=t("../../components/colorscale/calc"),u=t("../streamtube/calc").processGrid,A=t("../streamtube/calc").filter;P.exports=function(e,i){i._len=Math.min(i.x.length,i.y.length,i.z.length,i.value.length),i._x=A(i.x,i._len),i._y=A(i.y,i._len),i._z=A(i.z,i._len),i._value=A(i.value,i._len);var n=u(i);i._gridFill=n.fill,i._Xs=n.Xs,i._Ys=n.Ys,i._Zs=n.Zs,i._len=n.len;for(var a=1/0,r=-1/0,f=0;f<i._len;f++){var o=i._value[f];a=Math.min(a,o),r=Math.max(r,o)}i._minValues=a,i._maxValues=r,i._vMin=i.isomin===void 0||i.isomin===null?a:i.isomin,i._vMax=i.isomax===void 0||i.isomin===null?r:i.isomax,h(e,i,{vals:[i._vMin,i._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375,"../streamtube/calc":1054}],873:[function(t,P,R){var h=t("../../../stackgl_modules").gl_mesh3d,u=t("../../lib/gl_format_color").parseColorScale,A=t("../../lib/str2rgbarray"),T=t("../../components/colorscale").extractOpts,e=t("../../plots/gl3d/zip3"),i=function(s,m){for(var g=m.length-1;g>0;g--){var p=Math.min(m[g],m[g-1]),v=Math.max(m[g],m[g-1]);if(v>p&&p<s&&s<=v)return{id:g,distRatio:(v-s)/(v-p)}}return{id:0,distRatio:0}};function n(s,m,g){this.scene=s,this.uid=g,this.mesh=m,this.name="",this.data=null,this.showContour=!1}var a=n.prototype;a.handlePick=function(s){if(s.object===this.mesh){var m=s.data.index,g=this.data._meshX[m],p=this.data._meshY[m],v=this.data._meshZ[m],x=this.data._Ys.length,l=this.data._Zs.length,b=i(g,this.data._Xs).id,c=i(p,this.data._Ys).id,M=i(v,this.data._Zs).id,_=s.index=M+l*c+l*x*b;s.traceCoordinate=[this.data._meshX[_],this.data._meshY[_],this.data._meshZ[_],this.data._value[_]];var y=this.data.hovertext||this.data.text;return Array.isArray(y)&&y[_]!==void 0?s.textLabel=y[_]:y&&(s.textLabel=y),!0}},a.update=function(s){var m=this.scene,g=m.fullSceneLayout;this.data=f(s);function p(c,M,_,y){return M.map(function(w){return c.d2l(w,0,y)*_})}var v=e(p(g.xaxis,s._meshX,m.dataScale[0],s.xcalendar),p(g.yaxis,s._meshY,m.dataScale[1],s.ycalendar),p(g.zaxis,s._meshZ,m.dataScale[2],s.zcalendar)),x=e(s._meshI,s._meshJ,s._meshK),l={positions:v,cells:x,lightPosition:[s.lightposition.x,s.lightposition.y,s.lightposition.z],ambient:s.lighting.ambient,diffuse:s.lighting.diffuse,specular:s.lighting.specular,roughness:s.lighting.roughness,fresnel:s.lighting.fresnel,vertexNormalsEpsilon:s.lighting.vertexnormalsepsilon,faceNormalsEpsilon:s.lighting.facenormalsepsilon,opacity:s.opacity,contourEnable:s.contour.show,contourColor:A(s.contour.color).slice(0,3),contourWidth:s.contour.width,useFacetNormals:s.flatshading},b=T(s);l.vertexIntensity=s._meshIntensity,l.vertexIntensityBounds=[b.min,b.max],l.colormap=u(s),this.mesh.update(l)},a.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var r=["xyz","xzy","yxz","yzx","zxy","zyx"];function f(s){s._meshI=[],s._meshJ=[],s._meshK=[];var m=s.surface.show,g=s.spaceframe.show,p=s.surface.fill,v=s.spaceframe.fill,x=!1,l=!1,b=0,c,M,_=s._Xs,y=s._Ys,w=s._Zs,d=_.length,C=y.length,S=w.length,E=r.indexOf(s._gridFill.replace(/-/g,"").replace(/\+/g,"")),k=function(Bt,Ct,Ze){switch(E){case 5:return Ze+S*Ct+S*C*Bt;case 4:return Ze+S*Bt+S*d*Ct;case 3:return Ct+C*Ze+C*S*Bt;case 2:return Ct+C*Bt+C*d*Ze;case 1:return Bt+d*Ze+d*S*Ct;default:return Bt+d*Ct+d*C*Ze}},B=s._minValues,z=s._maxValues,F=s._vMin,I=s._vMax,O,N,V,H;function j(Bt,Ct,Ze){for(var nt=H.length,Ye=M;Ye<nt;Ye++)if(Bt===O[Ye]&&Ct===N[Ye]&&Ze===V[Ye])return Ye;return-1}function Z(){M=c}function X(){O=[],N=[],V=[],H=[],c=0,Z()}function re(Bt,Ct,Ze,nt){return O.push(Bt),N.push(Ct),V.push(Ze),H.push(nt),c++,c-1}function ue(Bt,Ct,Ze){return s._meshI.push(Bt),s._meshJ.push(Ct),s._meshK.push(Ze),b++,b-1}function K(Bt,Ct,Ze){for(var nt=[],Ye=0;Ye<Bt.length;Ye++)nt[Ye]=(Bt[Ye]+Ct[Ye]+Ze[Ye])/3;return nt}function te(Bt,Ct,Ze){for(var nt=[],Ye=0;Ye<Bt.length;Ye++)nt[Ye]=Bt[Ye]*(1-Ze)+Ze*Ct[Ye];return nt}var G;function Y(Bt){G=Bt}function ee(Bt,Ct){var Ze=Bt[0],nt=Bt[1],Ye=Bt[2],Ee=K(Ze,nt,Ye),Ge=Math.sqrt(1-G),Je=te(Ee,Ze,Ge),qe=te(Ee,nt,Ge),Tt=te(Ee,Ye,Ge),mt=Ct[0],Mt=Ct[1],Ht=Ct[2];return{xyzv:[[Ze,nt,qe],[qe,Je,Ze],[nt,Ye,Tt],[Tt,qe,nt],[Ye,Ze,Je],[Je,Tt,Ye]],abc:[[mt,Mt,-1],[-1,-1,mt],[Mt,Ht,-1],[-1,-1,Mt],[Ht,mt,-1],[-1,-1,Ht]]}}function ne(Bt,Ct){return Bt==="all"||Bt===null?!0:Bt.indexOf(Ct)>-1}function J(Bt,Ct){return Bt===null?Ct:Bt}function q(Bt,Ct,Ze){Z();var nt=[Ct],Ye=[Ze];if(G>=1)nt=[Ct],Ye=[Ze];else if(G>0){var Ee=ee(Ct,Ze);nt=Ee.xyzv,Ye=Ee.abc}for(var Ge=0;Ge<nt.length;Ge++){Ct=nt[Ge],Ze=Ye[Ge];for(var Je=[],qe=0;qe<3;qe++){var Tt=Ct[qe][0],mt=Ct[qe][1],Mt=Ct[qe][2],Ht=Ct[qe][3],Rt=Ze[qe]>-1?Ze[qe]:j(Tt,mt,Mt);Rt>-1?Je[qe]=Rt:Je[qe]=re(Tt,mt,Mt,J(Bt,Ht))}ue(Je[0],Je[1],Je[2])}}function ae(Bt,Ct,Ze){var nt=function(Ye,Ee,Ge){q(Bt,[Ct[Ye],Ct[Ee],Ct[Ge]],[Ze[Ye],Ze[Ee],Ze[Ge]])};nt(0,1,2),nt(2,3,0)}function le(Bt,Ct,Ze){var nt=function(Ye,Ee,Ge){q(Bt,[Ct[Ye],Ct[Ee],Ct[Ge]],[Ze[Ye],Ze[Ee],Ze[Ge]])};nt(0,1,2),nt(3,0,1),nt(2,3,0),nt(1,2,3)}function ie(Bt,Ct,Ze,nt){var Ye=Bt[3];Ye<Ze&&(Ye=Ze),Ye>nt&&(Ye=nt);for(var Ee=(Bt[3]-Ye)/(Bt[3]-Ct[3]+1e-9),Ge=[],Je=0;Je<4;Je++)Ge[Je]=(1-Ee)*Bt[Je]+Ee*Ct[Je];return Ge}function se(Bt,Ct,Ze){return Bt>=Ct&&Bt<=Ze}function xe(Bt){var Ct=.001*(I-F);return Bt>=F-Ct&&Bt<=I+Ct}function oe(Bt){for(var Ct=[],Ze=0;Ze<4;Ze++){var nt=Bt[Ze];Ct.push([s._x[nt],s._y[nt],s._z[nt],s._value[nt]])}return Ct}var he=3;function be(Bt,Ct,Ze,nt,Ye,Ee){Ee||(Ee=1),Ze=[-1,-1,-1];var Ge=!1,Je=[se(Ct[0][3],nt,Ye),se(Ct[1][3],nt,Ye),se(Ct[2][3],nt,Ye)];if(!Je[0]&&!Je[1]&&!Je[2])return!1;var qe=function(mt,Mt,Ht){return xe(Mt[0][3])&&xe(Mt[1][3])&&xe(Mt[2][3])?(q(mt,Mt,Ht),!0):Ee<he?be(mt,Mt,Ht,F,I,++Ee):!1};if(Je[0]&&Je[1]&&Je[2])return qe(Bt,Ct,Ze)||Ge;var Tt=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(mt){if(Je[mt[0]]&&Je[mt[1]]&&!Je[mt[2]]){var Mt=Ct[mt[0]],Ht=Ct[mt[1]],Rt=Ct[mt[2]],Vt=ie(Rt,Mt,nt,Ye),Jt=ie(Rt,Ht,nt,Ye);Ge=qe(Bt,[Jt,Vt,Mt],[-1,-1,Ze[mt[0]]])||Ge,Ge=qe(Bt,[Mt,Ht,Jt],[Ze[mt[0]],Ze[mt[1]],-1])||Ge,Tt=!0}}),Tt||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(mt){if(Je[mt[0]]&&!Je[mt[1]]&&!Je[mt[2]]){var Mt=Ct[mt[0]],Ht=Ct[mt[1]],Rt=Ct[mt[2]],Vt=ie(Ht,Mt,nt,Ye),Jt=ie(Rt,Mt,nt,Ye);Ge=qe(Bt,[Jt,Vt,Mt],[-1,-1,Ze[mt[0]]])||Ge,Tt=!0}}),Ge}function me(Bt,Ct,Ze,nt){var Ye=!1,Ee=oe(Ct),Ge=[se(Ee[0][3],Ze,nt),se(Ee[1][3],Ze,nt),se(Ee[2][3],Ze,nt),se(Ee[3][3],Ze,nt)];if(!Ge[0]&&!Ge[1]&&!Ge[2]&&!Ge[3])return Ye;if(Ge[0]&&Ge[1]&&Ge[2]&&Ge[3])return l&&(Ye=le(Bt,Ee,Ct)||Ye),Ye;var Je=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(qe){if(Ge[qe[0]]&&Ge[qe[1]]&&Ge[qe[2]]&&!Ge[qe[3]]){var Tt=Ee[qe[0]],mt=Ee[qe[1]],Mt=Ee[qe[2]],Ht=Ee[qe[3]];if(l)Ye=q(Bt,[Tt,mt,Mt],[Ct[qe[0]],Ct[qe[1]],Ct[qe[2]]])||Ye;else{var Rt=ie(Ht,Tt,Ze,nt),Vt=ie(Ht,mt,Ze,nt),Jt=ie(Ht,Mt,Ze,nt);Ye=q(null,[Rt,Vt,Jt],[-1,-1,-1])||Ye}Je=!0}}),Je||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(qe){if(Ge[qe[0]]&&Ge[qe[1]]&&!Ge[qe[2]]&&!Ge[qe[3]]){var Tt=Ee[qe[0]],mt=Ee[qe[1]],Mt=Ee[qe[2]],Ht=Ee[qe[3]],Rt=ie(Mt,Tt,Ze,nt),Vt=ie(Mt,mt,Ze,nt),Jt=ie(Ht,mt,Ze,nt),Yt=ie(Ht,Tt,Ze,nt);l?(Ye=q(Bt,[Tt,Yt,Rt],[Ct[qe[0]],-1,-1])||Ye,Ye=q(Bt,[mt,Vt,Jt],[Ct[qe[1]],-1,-1])||Ye):Ye=ae(null,[Rt,Vt,Jt,Yt],[-1,-1,-1,-1])||Ye,Je=!0}}),Je)||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(qe){if(Ge[qe[0]]&&!Ge[qe[1]]&&!Ge[qe[2]]&&!Ge[qe[3]]){var Tt=Ee[qe[0]],mt=Ee[qe[1]],Mt=Ee[qe[2]],Ht=Ee[qe[3]],Rt=ie(mt,Tt,Ze,nt),Vt=ie(Mt,Tt,Ze,nt),Jt=ie(Ht,Tt,Ze,nt);l?(Ye=q(Bt,[Tt,Rt,Vt],[Ct[qe[0]],-1,-1])||Ye,Ye=q(Bt,[Tt,Vt,Jt],[Ct[qe[0]],-1,-1])||Ye,Ye=q(Bt,[Tt,Jt,Rt],[Ct[qe[0]],-1,-1])||Ye):Ye=q(null,[Rt,Vt,Jt],[-1,-1,-1])||Ye,Je=!0}}),Ye}function _e(Bt,Ct,Ze,nt,Ye,Ee,Ge,Je,qe,Tt,mt){var Mt=!1;return x&&(ne(Bt,"A")&&(Mt=me(null,[Ct,Ze,nt,Ee],Tt,mt)||Mt),ne(Bt,"B")&&(Mt=me(null,[Ze,nt,Ye,qe],Tt,mt)||Mt),ne(Bt,"C")&&(Mt=me(null,[Ze,Ee,Ge,qe],Tt,mt)||Mt),ne(Bt,"D")&&(Mt=me(null,[nt,Ee,Je,qe],Tt,mt)||Mt),ne(Bt,"E")&&(Mt=me(null,[Ze,nt,Ee,qe],Tt,mt)||Mt)),l&&(Mt=me(Bt,[Ze,nt,Ee,qe],Tt,mt)||Mt),Mt}function Se(Bt,Ct,Ze,nt,Ye,Ee,Ge,Je){return[Je[0]===!0?!0:be(Bt,oe([Ct,Ze,nt]),[Ct,Ze,nt],Ee,Ge),Je[1]===!0?!0:be(Bt,oe([nt,Ye,Ct]),[nt,Ye,Ct],Ee,Ge)]}function De(Bt,Ct,Ze,nt,Ye,Ee,Ge,Je,qe){return Je?Se(Bt,Ct,Ze,Ye,nt,Ee,Ge,qe):Se(Bt,Ze,Ye,nt,Ct,Ee,Ge,qe)}function Ie(Bt,Ct,Ze,nt,Ye,Ee,Ge){var Je=!1,qe,Tt,mt,Mt,Ht=function(){Je=be(Bt,[qe,Tt,mt],[-1,-1,-1],Ye,Ee)||Je,Je=be(Bt,[mt,Mt,qe],[-1,-1,-1],Ye,Ee)||Je},Rt=Ge[0],Vt=Ge[1],Jt=Ge[2];return Rt&&(qe=te(oe([k(Ct,Ze-0,nt-0)])[0],oe([k(Ct-1,Ze-0,nt-0)])[0],Rt),Tt=te(oe([k(Ct,Ze-0,nt-1)])[0],oe([k(Ct-1,Ze-0,nt-1)])[0],Rt),mt=te(oe([k(Ct,Ze-1,nt-1)])[0],oe([k(Ct-1,Ze-1,nt-1)])[0],Rt),Mt=te(oe([k(Ct,Ze-1,nt-0)])[0],oe([k(Ct-1,Ze-1,nt-0)])[0],Rt),Ht()),Vt&&(qe=te(oe([k(Ct-0,Ze,nt-0)])[0],oe([k(Ct-0,Ze-1,nt-0)])[0],Vt),Tt=te(oe([k(Ct-0,Ze,nt-1)])[0],oe([k(Ct-0,Ze-1,nt-1)])[0],Vt),mt=te(oe([k(Ct-1,Ze,nt-1)])[0],oe([k(Ct-1,Ze-1,nt-1)])[0],Vt),Mt=te(oe([k(Ct-1,Ze,nt-0)])[0],oe([k(Ct-1,Ze-1,nt-0)])[0],Vt),Ht()),Jt&&(qe=te(oe([k(Ct-0,Ze-0,nt)])[0],oe([k(Ct-0,Ze-0,nt-1)])[0],Jt),Tt=te(oe([k(Ct-0,Ze-1,nt)])[0],oe([k(Ct-0,Ze-1,nt-1)])[0],Jt),mt=te(oe([k(Ct-1,Ze-1,nt)])[0],oe([k(Ct-1,Ze-1,nt-1)])[0],Jt),Mt=te(oe([k(Ct-1,Ze-0,nt)])[0],oe([k(Ct-1,Ze-0,nt-1)])[0],Jt),Ht()),Je}function Te(Bt,Ct,Ze,nt,Ye,Ee,Ge,Je,qe,Tt,mt,Mt){var Ht=Bt;return Mt?(x&&Bt==="even"&&(Ht=null),_e(Ht,Ct,Ze,nt,Ye,Ee,Ge,Je,qe,Tt,mt)):(x&&Bt==="odd"&&(Ht=null),_e(Ht,qe,Je,Ge,Ee,Ye,nt,Ze,Ct,Tt,mt))}function Ce(Bt,Ct,Ze,nt,Ye){for(var Ee=[],Ge=0,Je=0;Je<Ct.length;Je++)for(var qe=Ct[Je],Tt=1;Tt<S;Tt++)for(var mt=1;mt<C;mt++)Ee.push(De(Bt,k(qe,mt-1,Tt-1),k(qe,mt-1,Tt),k(qe,mt,Tt-1),k(qe,mt,Tt),Ze,nt,(qe+mt+Tt)%2,Ye&&Ye[Ge]?Ye[Ge]:[])),Ge++;return Ee}function He(Bt,Ct,Ze,nt,Ye){for(var Ee=[],Ge=0,Je=0;Je<Ct.length;Je++)for(var qe=Ct[Je],Tt=1;Tt<d;Tt++)for(var mt=1;mt<S;mt++)Ee.push(De(Bt,k(Tt-1,qe,mt-1),k(Tt,qe,mt-1),k(Tt-1,qe,mt),k(Tt,qe,mt),Ze,nt,(Tt+qe+mt)%2,Ye&&Ye[Ge]?Ye[Ge]:[])),Ge++;return Ee}function Xe(Bt,Ct,Ze,nt,Ye){for(var Ee=[],Ge=0,Je=0;Je<Ct.length;Je++)for(var qe=Ct[Je],Tt=1;Tt<C;Tt++)for(var mt=1;mt<d;mt++)Ee.push(De(Bt,k(mt-1,Tt-1,qe),k(mt-1,Tt,qe),k(mt,Tt-1,qe),k(mt,Tt,qe),Ze,nt,(mt+Tt+qe)%2,Ye&&Ye[Ge]?Ye[Ge]:[])),Ge++;return Ee}function Be(Bt,Ct,Ze){for(var nt=1;nt<S;nt++)for(var Ye=1;Ye<C;Ye++)for(var Ee=1;Ee<d;Ee++)Te(Bt,k(Ee-1,Ye-1,nt-1),k(Ee-1,Ye-1,nt),k(Ee-1,Ye,nt-1),k(Ee-1,Ye,nt),k(Ee,Ye-1,nt-1),k(Ee,Ye-1,nt),k(Ee,Ye,nt-1),k(Ee,Ye,nt),Ct,Ze,(Ee+Ye+nt)%2)}function Re(Bt,Ct,Ze){l=!0,Be(Bt,Ct,Ze),l=!1}function We(Bt,Ct,Ze){x=!0,Be(Bt,Ct,Ze),x=!1}function vt(Bt,Ct,Ze,nt,Ye,Ee){for(var Ge=[],Je=0,qe=0;qe<Ct.length;qe++)for(var Tt=Ct[qe],mt=1;mt<S;mt++)for(var Mt=1;Mt<C;Mt++)Ge.push(Ie(Bt,Tt,Mt,mt,Ze,nt,Ye[qe],Ee&&Ee[Je]?Ee[Je]:[])),Je++;return Ge}function Pt(Bt,Ct,Ze,nt,Ye,Ee){for(var Ge=[],Je=0,qe=0;qe<Ct.length;qe++)for(var Tt=Ct[qe],mt=1;mt<d;mt++)for(var Mt=1;Mt<S;Mt++)Ge.push(Ie(Bt,mt,Tt,Mt,Ze,nt,Ye[qe],Ee&&Ee[Je]?Ee[Je]:[])),Je++;return Ge}function Zt(Bt,Ct,Ze,nt,Ye,Ee){for(var Ge=[],Je=0,qe=0;qe<Ct.length;qe++)for(var Tt=Ct[qe],mt=1;mt<C;mt++)for(var Mt=1;Mt<d;Mt++)Ge.push(Ie(Bt,Mt,mt,Tt,Ze,nt,Ye[qe],Ee&&Ee[Je]?Ee[Je]:[])),Je++;return Ge}function zt(Bt,Ct){for(var Ze=[],nt=Bt;nt<Ct;nt++)Ze.push(nt);return Ze}function At(){for(var Bt=0;Bt<d;Bt++)for(var Ct=0;Ct<C;Ct++)for(var Ze=0;Ze<S;Ze++){var nt=k(Bt,Ct,Ze);re(s._x[nt],s._y[nt],s._z[nt],s._value[nt])}}function Wt(){X(),At();var Bt=null;if(g&&v&&(Y(v),Re(Bt,F,I)),m&&p){Y(p);for(var Ct=s.surface.pattern,Ze=s.surface.count,nt=0;nt<Ze;nt++){var Ye=Ze===1?.5:nt/(Ze-1),Ee=(1-Ye)*F+Ye*I,Ge=Math.abs(Ee-B),Je=Math.abs(Ee-z),qe=Ge>Je?[B,Ee]:[Ee,z];We(Ct,qe[0],qe[1])}}var Tt=[[Math.min(F,z),Math.max(F,z)],[Math.min(B,I),Math.max(B,I)]];["x","y","z"].forEach(function(mt){for(var Mt=[],Ht=0;Ht<Tt.length;Ht++){var Rt=0,Vt=Tt[Ht][0],Jt=Tt[Ht][1],Yt=s.slices[mt];if(Yt.show&&Yt.fill){Y(Yt.fill);var or=[],Hr=[],an=[];if(Yt.locations.length)for(var Kr=0;Kr<Yt.locations.length;Kr++){var ot=i(Yt.locations[Kr],mt==="x"?_:mt==="y"?y:w);ot.distRatio===0?or.push(ot.id):ot.id>0&&(Hr.push(ot.id),mt==="x"?an.push([ot.distRatio,0,0]):mt==="y"?an.push([0,ot.distRatio,0]):an.push([0,0,ot.distRatio]))}else mt==="x"?or=zt(1,d-1):mt==="y"?or=zt(1,C-1):or=zt(1,S-1);Hr.length>0&&(mt==="x"?Mt[Rt]=vt(Bt,Hr,Vt,Jt,an,Mt[Rt]):mt==="y"?Mt[Rt]=Pt(Bt,Hr,Vt,Jt,an,Mt[Rt]):Mt[Rt]=Zt(Bt,Hr,Vt,Jt,an,Mt[Rt]),Rt++),or.length>0&&(mt==="x"?Mt[Rt]=Ce(Bt,or,Vt,Jt,Mt[Rt]):mt==="y"?Mt[Rt]=He(Bt,or,Vt,Jt,Mt[Rt]):Mt[Rt]=Xe(Bt,or,Vt,Jt,Mt[Rt]),Rt++)}var er=s.caps[mt];er.show&&er.fill&&(Y(er.fill),mt==="x"?Mt[Rt]=Ce(Bt,[0,d-1],Vt,Jt,Mt[Rt]):mt==="y"?Mt[Rt]=He(Bt,[0,C-1],Vt,Jt,Mt[Rt]):Mt[Rt]=Xe(Bt,[0,S-1],Vt,Jt,Mt[Rt]),Rt++)}}),b===0&&X(),s._meshX=O,s._meshY=N,s._meshZ=V,s._meshIntensity=H,s._Xs=_,s._Ys=y,s._Zs=w}return Wt(),s}function o(s,m){var g=s.glplot.gl,p=h({gl:g}),v=new n(s,p,m.uid);return p._trace=v,v.update(m),s.glplot.add(p),v}P.exports={findNearestOnAxis:i,generateIsoMeshes:f,createIsosurfaceTrace:o}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],874:[function(t,P,R){var h=t("../../lib"),u=t("../../registry"),A=t("./attributes"),T=t("../../components/colorscale/defaults");function e(n,a,r,f){function o(s,m){return h.coerce(n,a,A,s,m)}i(n,a,r,f,o)}function i(n,a,r,f,o){var s=o("isomin"),m=o("isomax");m!=null&&s!==void 0&&s!==null&&s>m&&(a.isomin=null,a.isomax=null);var g=o("x"),p=o("y"),v=o("z"),x=o("value");if(!g||!g.length||!p||!p.length||!v||!v.length||!x||!x.length){a.visible=!1;return}var l=u.getComponentMethod("calendars","handleTraceDefaults");l(n,a,["x","y","z"],f),o("valuehoverformat"),["x","y","z"].forEach(function(_){o(_+"hoverformat");var y="caps."+_,w=o(y+".show");w&&o(y+".fill");var d="slices."+_,C=o(d+".show");C&&(o(d+".fill"),o(d+".locations"))});var b=o("spaceframe.show");b&&o("spaceframe.fill");var c=o("surface.show");c&&(o("surface.count"),o("surface.fill"),o("surface.pattern"));var M=o("contour.show");M&&(o("contour.color"),o("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(_){o(_)}),T(n,a,f,o,{prefix:"",cLetter:"c"}),a._length=null}P.exports={supplyDefaults:e,supplyIsoDefaults:i}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":871}],875:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults").supplyDefaults,calc:t("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:t("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:t("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":871,"./calc":872,"./convert":873,"./defaults":874}],876:[function(t,P,R){var h=t("../../components/colorscale/attributes"),u=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,A=t("../../plots/template_attributes").hovertemplateAttrs,T=t("../surface/attributes"),e=t("../../plots/attributes"),i=t("../../lib/extend").extendFlat;P.exports=i({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:A({editType:"calc"}),xhoverformat:u("x"),yhoverformat:u("y"),zhoverformat:u("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},h("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:T.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:i({},T.contours.x.show,{}),color:T.contours.x.color,width:T.contours.x.width,editType:"calc"},lightposition:{x:i({},T.lightposition.x,{dflt:1e5}),y:i({},T.lightposition.y,{dflt:1e5}),z:i({},T.lightposition.z,{dflt:0}),editType:"calc"},lighting:i({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},T.lighting),hoverinfo:i({},e.hoverinfo,{editType:"calc"}),showlegend:i({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../surface/attributes":1070}],877:[function(t,P,R){var h=t("../../components/colorscale/calc");P.exports=function(A,T){T.intensity&&h(A,T,{vals:T.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],878:[function(t,P,R){var h=t("../../../stackgl_modules").gl_mesh3d,u=t("../../../stackgl_modules").delaunay_triangulate,A=t("../../../stackgl_modules").alpha_shape,T=t("../../../stackgl_modules").convex_hull,e=t("../../lib/gl_format_color").parseColorScale,i=t("../../lib/str2rgbarray"),n=t("../../components/colorscale").extractOpts,a=t("../../plots/gl3d/zip3");function r(x,l,b){this.scene=x,this.uid=b,this.mesh=l,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var f=r.prototype;f.handlePick=function(x){if(x.object===this.mesh){var l=x.index=x.data.index;x.data._cellCenter?x.traceCoordinate=x.data.dataCoordinate:x.traceCoordinate=[this.data.x[l],this.data.y[l],this.data.z[l]];var b=this.data.hovertext||this.data.text;return Array.isArray(b)&&b[l]!==void 0?x.textLabel=b[l]:b&&(x.textLabel=b),!0}};function o(x){for(var l=[],b=x.length,c=0;c<b;c++)l[c]=i(x[c]);return l}function s(x,l,b,c){for(var M=[],_=l.length,y=0;y<_;y++)M[y]=x.d2l(l[y],0,c)*b;return M}function m(x){for(var l=[],b=x.length,c=0;c<b;c++)l[c]=Math.round(x[c]);return l}function g(x,l){for(var b=["x","y","z"].indexOf(x),c=[],M=l.length,_=0;_<M;_++)c[_]=[l[_][(b+1)%3],l[_][(b+2)%3]];return u(c)}function p(x,l){for(var b=x.length,c=0;c<b;c++)if(x[c]<=-.5||x[c]>=l-.5)return!1;return!0}f.update=function(x){var l=this.scene,b=l.fullSceneLayout;this.data=x;var c=x.x.length,M=a(s(b.xaxis,x.x,l.dataScale[0],x.xcalendar),s(b.yaxis,x.y,l.dataScale[1],x.ycalendar),s(b.zaxis,x.z,l.dataScale[2],x.zcalendar)),_;if(x.i&&x.j&&x.k){if(x.i.length!==x.j.length||x.j.length!==x.k.length||!p(x.i,c)||!p(x.j,c)||!p(x.k,c))return;_=a(m(x.i),m(x.j),m(x.k))}else x.alphahull===0?_=T(M):x.alphahull>0?_=A(x.alphahull,M):_=g(x.delaunayaxis,M);var y={positions:M,cells:_,lightPosition:[x.lightposition.x,x.lightposition.y,x.lightposition.z],ambient:x.lighting.ambient,diffuse:x.lighting.diffuse,specular:x.lighting.specular,roughness:x.lighting.roughness,fresnel:x.lighting.fresnel,vertexNormalsEpsilon:x.lighting.vertexnormalsepsilon,faceNormalsEpsilon:x.lighting.facenormalsepsilon,opacity:x.opacity,contourEnable:x.contour.show,contourColor:i(x.contour.color).slice(0,3),contourWidth:x.contour.width,useFacetNormals:x.flatshading};if(x.intensity){var w=n(x);this.color="#fff";var d=x.intensitymode;y[d+"Intensity"]=x.intensity,y[d+"IntensityBounds"]=[w.min,w.max],y.colormap=e(x)}else x.vertexcolor?(this.color=x.vertexcolor[0],y.vertexColors=o(x.vertexcolor)):x.facecolor?(this.color=x.facecolor[0],y.cellColors=o(x.facecolor)):(this.color=x.color,y.meshColor=i(x.color));this.mesh.update(y)},f.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function v(x,l){var b=x.glplot.gl,c=h({gl:b}),M=new r(x,c,l.uid);return c._trace=M,M.update(l),x.glplot.add(c),M}P.exports=v},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],879:[function(t,P,R){var h=t("../../registry"),u=t("../../lib"),A=t("../../components/colorscale/defaults"),T=t("./attributes");P.exports=function(i,n,a,r){function f(p,v){return u.coerce(i,n,T,p,v)}function o(p){var v=p.map(function(x){var l=f(x);return l&&u.isArrayOrTypedArray(l)?l:null});return v.every(function(x){return x&&x.length===v[0].length})&&v}var s=o(["x","y","z"]);if(!s){n.visible=!1;return}if(o(["i","j","k"]),n.i&&(!n.j||!n.k)||n.j&&(!n.k||!n.i)||n.k&&(!n.i||!n.j)){n.visible=!1;return}var m=h.getComponentMethod("calendars","handleTraceDefaults");m(i,n,["x","y","z"],r),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(p){f(p)});var g=f("contour.show");g&&(f("contour.color"),f("contour.width")),"intensity"in i?(f("intensity"),f("intensitymode"),A(i,n,r,f,{prefix:"",cLetter:"c"})):(n.showscale=!1,"facecolor"in i?f("facecolor"):"vertexcolor"in i?f("vertexcolor"):f("color",a)),f("text"),f("hovertext"),f("hovertemplate"),f("xhoverformat"),f("yhoverformat"),f("zhoverformat"),n._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":876}],880:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),calc:t("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:t("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:t("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":876,"./calc":877,"./convert":878,"./defaults":879}],881:[function(t,P,R){var h=t("../../lib").extendFlat,u=t("../scatter/attributes"),A=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,T=t("../../components/drawing/attributes").dash,e=t("../../components/fx/attributes"),i=t("../../constants/delta.js"),n=i.INCREASING.COLOR,a=i.DECREASING.COLOR,r=u.line;function f(o){return{line:{color:h({},r.color,{dflt:o}),width:r.width,dash:T,editType:"style"},editType:"style"}}P.exports={xperiod:u.xperiod,xperiod0:u.xperiod0,xperiodalignment:u.xperiodalignment,xhoverformat:A("x"),yhoverformat:A("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:h({},r.width,{}),dash:h({},T,{}),editType:"style"},increasing:f(n),decreasing:f(a),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:h({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":388,"../../components/fx/attributes":398,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936}],882:[function(t,P,R){var h=t("../../lib"),u=h._,A=t("../../plots/cartesian/axes"),T=t("../../plots/cartesian/align_period"),e=t("../../constants/numerical").BADNUM;function i(f,o){var s=A.getFromId(f,o.xaxis),m=A.getFromId(f,o.yaxis),g=r(f,s,o),p=o._minDiff;o._minDiff=null;var v=o._origX;o._origX=null;var x=o._xcalc;o._xcalc=null;var l=a(f,o,v,x,m,n);return o._extremes[s._id]=A.findExtremes(s,x,{vpad:p/2}),l.length?(h.extendFlat(l[0].t,{wHover:p/2,tickLen:g}),l):[{t:{empty:!0}}]}function n(f,o,s,m){return{o:f,h:o,l:s,c:m}}function a(f,o,s,m,g,p){for(var v=g.makeCalcdata(o,"open"),x=g.makeCalcdata(o,"high"),l=g.makeCalcdata(o,"low"),b=g.makeCalcdata(o,"close"),c=Array.isArray(o.text),M=Array.isArray(o.hovertext),_=!0,y=null,w=!!o.xperiodalignment,d=[],C=0;C<m.length;C++){var S=m[C],E=v[C],k=x[C],B=l[C],z=b[C];if(S!==e&&E!==e&&k!==e&&B!==e&&z!==e){z===E?y!==null&&z!==y&&(_=z>y):_=z>E,y=z;var F=p(E,k,B,z);F.pos=S,F.yc=(E+z)/2,F.i=C,F.dir=_?"increasing":"decreasing",F.x=F.pos,F.y=[B,k],w&&(F.orig_p=s[C]),c&&(F.tx=o.text[C]),M&&(F.htx=o.hovertext[C]),d.push(F)}else d.push({pos:S,empty:!0})}return o._extremes[g._id]=A.findExtremes(g,h.concat(l,x),{padded:!0}),d.length&&(d[0].t={labels:{open:u(f,"open:")+" ",high:u(f,"high:")+" ",low:u(f,"low:")+" ",close:u(f,"close:")+" "}}),d}function r(f,o,s){var m=s._minDiff;if(!m){var g=f._fullData,p=[];m=1/0;var v;for(v=0;v<g.length;v++){var x=g[v];if(x.type==="ohlc"&&x.visible===!0&&x.xaxis===o._id){p.push(x);var l=o.makeCalcdata(x,"x");x._origX=l;var b=T(s,o,"x",l).vals;x._xcalc=b;var c=h.distinctVals(b).minDiff;c&&isFinite(c)&&(m=Math.min(m,c))}}for(m===1/0&&(m=1),v=0;v<p.length;v++)p[v]._minDiff=m}return m*s.tickwidth}P.exports={calc:i,calcCommon:a}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566}],883:[function(t,P,R){var h=t("../../lib"),u=t("./ohlc_defaults"),A=t("../scatter/period_defaults"),T=t("./attributes");P.exports=function(n,a,r,f){function o(m,g){return h.coerce(n,a,T,m,g)}var s=u(n,a,o,f);if(!s){a.visible=!1;return}A(n,a,f,o,{x:!0}),o("xhoverformat"),o("yhoverformat"),o("line.width"),o("line.dash"),e(n,a,o,"increasing"),e(n,a,o,"decreasing"),o("text"),o("hovertext"),o("tickwidth"),f._requestRangeslider[a.xaxis]=!0};function e(i,n,a,r){a(r+".line.color"),a(r+".line.width",n.line.width),a(r+".line.dash",n.line.dash)}},{"../../lib":515,"../scatter/period_defaults":956,"./attributes":881,"./ohlc_defaults":886}],884:[function(t,P,R){var h=t("../../plots/cartesian/axes"),u=t("../../lib"),A=t("../../components/fx"),T=t("../../components/color"),e=t("../../lib").fillText,i=t("../../constants/delta.js"),n={increasing:i.INCREASING.SYMBOL,decreasing:i.DECREASING.SYMBOL};function a(s,m,g,p){var v=s.cd,x=v[0].trace;return x.hoverlabel.split?f(s,m,g,p):o(s,m,g,p)}function r(s,m,g,p){var v=s.cd,x=s.xa,l=v[0].trace,b=v[0].t,c=l.type,M=c==="ohlc"?"l":"min",_=c==="ohlc"?"h":"max",y,w,d=b.bPos||0,C=function(j){return j.pos+d-m},S=b.bdPos||b.tickLen,E=b.wHover,k=Math.min(1,S/Math.abs(x.r2c(x.range[1])-x.r2c(x.range[0])));y=s.maxHoverDistance-k,w=s.maxSpikeDistance-k;function B(j){var Z=C(j);return A.inbox(Z-E,Z+E,y)}function z(j){var Z=j[M],X=j[_];return Z===X||A.inbox(Z-g,X-g,y)}function F(j){return(B(j)+z(j))/2}var I=A.getDistanceFunction(p,B,z,F);if(A.getClosest(v,I,s),s.index===!1)return null;var O=v[s.index];if(O.empty)return null;var N=O.dir,V=l[N],H=V.line.color;return T.opacity(H)&&V.line.width?s.color=H:s.color=V.fillcolor,s.x0=x.c2p(O.pos+d-S,!0),s.x1=x.c2p(O.pos+d+S,!0),s.xLabelVal=O.orig_p!==void 0?O.orig_p:O.pos,s.spikeDistance=F(O)*w/y,s.xSpike=x.c2p(O.pos,!0),s}function f(s,m,g,p){var v=s.cd,x=s.ya,l=v[0].trace,b=v[0].t,c=[],M=r(s,m,g,p);if(!M)return[];var _=M.index,y=v[_],w=y.hi||l.hoverinfo,d=w.split("+"),C=w==="all",S=C||d.indexOf("y")!==-1;if(!S)return[];for(var E=["high","open","close","low"],k={},B=0;B<E.length;B++){var z=E[B],F=l[z][M.index],I=x.c2p(F,!0),O;F in k?(O=k[F],O.yLabel+="<br>"+b.labels[z]+h.hoverLabelText(x,F,l.yhoverformat)):(O=u.extendFlat({},M),O.y0=O.y1=I,O.yLabelVal=F,O.yLabel=b.labels[z]+h.hoverLabelText(x,F,l.yhoverformat),O.name="",c.push(O),k[F]=O)}return c}function o(s,m,g,p){var v=s.cd,x=s.ya,l=v[0].trace,b=v[0].t,c=r(s,m,g,p);if(!c)return[];var M=c.index,_=v[M],y=c.index=_.i,w=_.dir;function d(F){return b.labels[F]+h.hoverLabelText(x,l[F][y],l.yhoverformat)}var C=_.hi||l.hoverinfo,S=C.split("+"),E=C==="all",k=E||S.indexOf("y")!==-1,B=E||S.indexOf("text")!==-1,z=k?[d("open"),d("high"),d("low"),d("close")+"  "+n[w]]:[];return B&&e(_,l,z),c.extraText=z.join("<br>"),c.y0=c.y1=x.c2p(_.yc,!0),[c]}P.exports={hoverPoints:a,hoverSplit:f,hoverOnPoints:o}},{"../../components/color":367,"../../components/fx":407,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axes":566}],885:[function(t,P,R){P.exports={moduleType:"trace",name:"ohlc",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:t("./attributes"),supplyDefaults:t("./defaults"),calc:t("./calc").calc,plot:t("./plot"),style:t("./style"),hoverPoints:t("./hover").hoverPoints,selectPoints:t("./select")}},{"../../plots/cartesian":578,"./attributes":881,"./calc":882,"./defaults":883,"./hover":884,"./plot":887,"./select":888,"./style":889}],886:[function(t,P,R){var h=t("../../registry"),u=t("../../lib");P.exports=function(T,e,i,n){var a=i("x"),r=i("open"),f=i("high"),o=i("low"),s=i("close");i("hoverlabel.split");var m=h.getComponentMethod("calendars","handleTraceDefaults");if(m(T,e,["x"],n),!!(r&&f&&o&&s)){var g=Math.min(r.length,f.length,o.length,s.length);return a&&(g=Math.min(g,u.minRowLength(a))),e._length=g,g}}},{"../../lib":515,"../../registry":647}],887:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib");P.exports=function(T,e,i,n){var a=e.yaxis,r=e.xaxis,f=!!r.rangebreaks;u.makeTraceGroups(n,i,"trace ohlc").each(function(o){var s=h.select(this),m=o[0],g=m.t,p=m.trace;if(p.visible!==!0||g.empty){s.remove();return}var v=g.tickLen,x=s.selectAll("path").data(u.identity);x.enter().append("path"),x.exit().remove(),x.attr("d",function(l){if(l.empty)return"M0,0Z";var b=r.c2p(l.pos-v,!0),c=r.c2p(l.pos+v,!0),M=f?(b+c)/2:r.c2p(l.pos,!0),_=a.c2p(l.o,!0),y=a.c2p(l.h,!0),w=a.c2p(l.l,!0),d=a.c2p(l.c,!0);return"M"+b+","+_+"H"+M+"M"+M+","+y+"V"+w+"M"+c+","+d+"H"+M})})}},{"../../lib":515,"@plotly/d3":58}],888:[function(t,P,R){P.exports=function(u,A){var T=u.cd,e=u.xaxis,i=u.yaxis,n=[],a,r=T[0].t.bPos||0;if(A===!1)for(a=0;a<T.length;a++)T[a].selected=0;else for(a=0;a<T.length;a++){var f=T[a];A.contains([e.c2p(f.pos+r),i.c2p(f.yc)],null,f.i,u)?(n.push({pointNumber:f.i,x:e.c2d(f.pos),y:i.c2d(f.yc)}),f.selected=1):f.selected=0}return n}},{}],889:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/drawing"),A=t("../../components/color");P.exports=function(e,i,n){var a=n||h.select(e).selectAll("g.ohlclayer").selectAll("g.trace");a.style("opacity",function(r){return r[0].trace.opacity}),a.each(function(r){var f=r[0].trace;h.select(this).selectAll("path").each(function(o){if(!o.empty){var s=f[o.dir].line;h.select(this).style("fill","none").call(A.stroke,s.color).call(u.dashLine,s.dash,s.width).style("opacity",f.selectedpoints&&!o.selected?.3:1)}})})}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],890:[function(t,P,R){var h=t("../../lib/extend").extendFlat,u=t("../../plots/attributes"),A=t("../../plots/font_attributes"),T=t("../../components/colorscale/attributes"),e=t("../../plots/template_attributes").hovertemplateAttrs,i=t("../../plots/domain").attributes,n=h({editType:"calc"},T("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});P.exports={domain:i({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:h({},u.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:A({editType:"calc"}),tickfont:A({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:n,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],891:[function(t,P,R){var h=t("../../plots/get_data").getModuleCalcData,u=t("./plot"),A="parcats";R.name=A,R.plot=function(T,e,i,n){var a=h(T.calcdata,A);if(a.length){var r=a[0];u(T,r,i,n)}},R.clean=function(T,e,i,n){var a=n._has&&n._has("parcats"),r=e._has&&e._has("parcats");a&&!r&&n._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":602,"./plot":896}],892:[function(t,P,R){var h=t("../../lib/gup").wrap,u=t("../../components/colorscale/helpers").hasColorscale,A=t("../../components/colorscale/calc"),T=t("../../lib/filter_unique.js"),e=t("../../components/drawing"),i=t("../../lib"),n=t("fast-isnumeric");P.exports=function(b,c){var M=i.filterVisible(c.dimensions);if(M.length===0)return[];var _=M.map(function(K){var te;if(K.categoryorder==="trace")te=null;else if(K.categoryorder==="array")te=K.categoryarray;else{te=T(K.values);for(var G=!0,Y=0;Y<te.length;Y++)if(!n(te[Y])){G=!1;break}te.sort(G?i.sorterAsc:void 0),K.categoryorder==="category descending"&&(te=te.reverse())}return g(K.values,te)}),y,w,d;i.isArrayOrTypedArray(c.counts)?y=c.counts:y=[c.counts],p(M),M.forEach(function(K,te){v(K,_[te])});var C=c.line,S;C?(u(c,"line")&&A(b,c,{vals:c.line.color,containerStr:"line",cLetter:"c"}),S=e.tryColorscale(C)):S=i.identity;function E(K){var te,G;return i.isArrayOrTypedArray(C.color)?(te=C.color[K%C.color.length],G=te):te=C.color,{color:S(te),rawColor:G}}var k=M[0].values.length,B={},z=_.map(function(K){return K.inds});d=0;var F,I;for(F=0;F<k;F++){var O=[];for(I=0;I<z.length;I++)O.push(z[I][F]);w=y[F%y.length],d+=w;var N=E(F),V=O+"-"+N.rawColor;B[V]===void 0&&(B[V]=s(O,N.color,N.rawColor)),m(B[V],F,w)}var H=M.map(function(K,te){return r(te,K._index,K._displayindex,K.label,d)});for(F=0;F<k;F++)for(w=y[F%y.length],I=0;I<H.length;I++){var j=H[I].containerInd,Z=_[I].inds[F],X=H[I].categories;if(X[Z]===void 0){var re=c.dimensions[j]._categoryarray[Z],ue=c.dimensions[j]._ticktext[Z];X[Z]=f(I,Z,re,ue)}o(X[Z],F,w)}return h(a(H,B,d))};function a(l,b,c){var M=l.map(function(_){return _.categories.length}).reduce(function(_,y){return Math.max(_,y)});return{dimensions:l,paths:b,trace:void 0,maxCats:M,count:c}}function r(l,b,c,M,_){return{dimensionInd:l,containerInd:b,displayInd:c,dimensionLabel:M,count:_,categories:[],dragX:null}}function f(l,b,c,M){return{dimensionInd:l,categoryInd:b,categoryValue:c,displayInd:b,categoryLabel:M,valueInds:[],count:0,dragY:null}}function o(l,b,c){l.valueInds.push(b),l.count+=c}function s(l,b,c){return{categoryInds:l,color:b,rawColor:c,valueInds:[],count:0}}function m(l,b,c){l.valueInds.push(b),l.count+=c}function g(l,b){b==null?b=[]:b=b.map(function(S){return S});var c={},M={},_=[];b.forEach(function(S,E){c[S]=0,M[S]=E});for(var y=0;y<l.length;y++){var w=l[y],d;c[w]===void 0?(c[w]=1,d=b.push(w)-1,M[w]=d):(c[w]++,d=M[w]),_.push(d)}var C=b.map(function(S){return c[S]});return{uniqueValues:b,uniqueCounts:C,inds:_}}function p(l){var b=l.map(function(M){return M.displayindex}),c;if(x(b))for(c=0;c<l.length;c++)l[c]._displayindex=l[c].displayindex;else for(c=0;c<l.length;c++)l[c]._displayindex=c}function v(l,b){l._categoryarray=b.uniqueValues,l.ticktext===null||l.ticktext===void 0?l._ticktext=[]:l._ticktext=l.ticktext.slice();for(var c=l._ticktext.length;c<b.uniqueValues.length;c++)l._ticktext.push(b.uniqueValues[c])}function x(l){for(var b=new Array(l.length),c=0;c<l.length;c++){if(l[c]<0||l[c]>=l.length||b[l[c]]!==void 0)return!1;b[l[c]]=!0}return!0}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../components/drawing":389,"../../lib":515,"../../lib/filter_unique.js":506,"../../lib/gup":512,"fast-isnumeric":190}],893:[function(t,P,R){var h=t("../../lib"),u=t("../../components/colorscale/helpers").hasColorscale,A=t("../../components/colorscale/defaults"),T=t("../../plots/domain").defaults,e=t("../../plots/array_container_defaults"),i=t("./attributes"),n=t("../parcoords/merge_length");function a(f,o,s,m,g){g("line.shape"),g("line.hovertemplate");var p=g("line.color",m.colorway[0]);if(u(f,"line")&&h.isArrayOrTypedArray(p)){if(p.length)return g("line.colorscale"),A(f,o,m,g,{prefix:"line.",cLetter:"c"}),p.length;o.line.color=s}return 1/0}function r(f,o){function s(b,c){return h.coerce(f,o,i.dimensions,b,c)}var m=s("values"),g=s("visible");if(m&&m.length||(g=o.visible=!1),g){s("label"),s("displayindex",o._index);var p=f.categoryarray,v=Array.isArray(p)&&p.length>0,x;v&&(x="array");var l=s("categoryorder",x);l==="array"?(s("categoryarray"),s("ticktext")):(delete f.categoryarray,delete f.ticktext),!v&&l==="array"&&(o.categoryorder="trace")}}P.exports=function(o,s,m,g){function p(c,M){return h.coerce(o,s,i,c,M)}var v=e(o,s,{name:"dimensions",handleItemDefaults:r}),x=a(o,s,m,g,p);T(s,g,p),(!Array.isArray(v)||!v.length)&&(s.visible=!1),n(s,v,"values",x),p("hoveron"),p("hovertemplate"),p("arrangement"),p("bundlecolors"),p("sortpaths"),p("counts");var l={family:g.font.family,size:Math.round(g.font.size),color:g.font.color};h.coerceFont(p,"labelfont",l);var b={family:g.font.family,size:Math.round(g.font.size/1.2),color:g.font.color};h.coerceFont(p,"tickfont",b)}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/domain":593,"../parcoords/merge_length":907,"./attributes":890}],894:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),calc:t("./calc"),plot:t("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:t("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":890,"./base_plot":891,"./calc":892,"./defaults":893,"./plot":896}],895:[function(t,P,R){var h=t("@plotly/d3"),u=t("d3-interpolate").interpolateNumber,A=t("../../plot_api/plot_api"),T=t("../../components/fx"),e=t("../../lib"),i=e.strTranslate,n=t("../../components/drawing"),a=t("tinycolor2"),r=t("../../lib/svg_text_utils");function f(Y,ee,ne,J){var q=ee._context.staticPlot,ae=Y.map(re.bind(0,ee,ne)),le=J.selectAll("g.parcatslayer").data([null]);le.enter().append("g").attr("class","parcatslayer").style("pointer-events",q?"none":"all");var ie=le.selectAll("g.trace.parcats").data(ae,o),se=ie.enter().append("g").attr("class","trace parcats");ie.attr("transform",function(Ce){return i(Ce.x,Ce.y)}),se.append("g").attr("class","paths");var xe=ie.select("g.paths"),oe=xe.selectAll("path.path").data(function(Ce){return Ce.paths},o);oe.attr("fill",function(Ce){return Ce.model.color});var he=oe.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(Ce){return Ce.model.color}).attr("fill-opacity",0);b(he),oe.attr("d",function(Ce){return Ce.svgD}),he.empty()||oe.sort(m),oe.exit().remove(),oe.on("mouseover",g).on("mouseout",p).on("click",l),se.append("g").attr("class","dimensions");var be=ie.select("g.dimensions"),me=be.selectAll("g.dimension").data(function(Ce){return Ce.dimensions},o);me.enter().append("g").attr("class","dimension"),me.attr("transform",function(Ce){return i(Ce.x,0)}),me.exit().remove();var _e=me.selectAll("g.category").data(function(Ce){return Ce.categories},o),Se=_e.enter().append("g").attr("class","category");_e.attr("transform",function(Ce){return i(0,Ce.y)}),Se.append("rect").attr("class","catrect").attr("pointer-events","none"),_e.select("rect.catrect").attr("fill","none").attr("width",function(Ce){return Ce.width}).attr("height",function(Ce){return Ce.height}),_(Se);var De=_e.selectAll("rect.bandrect").data(function(Ce){return Ce.bands},o);De.each(function(){e.raiseToTop(this)}),De.attr("fill",function(Ce){return Ce.color});var Ie=De.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(Ce){return Ce.color}).attr("fill-opacity",0);De.attr("fill",function(Ce){return Ce.color}).attr("width",function(Ce){return Ce.width}).attr("height",function(Ce){return Ce.height}).attr("y",function(Ce){return Ce.y}).attr("cursor",function(Ce){return Ce.parcatsViewModel.arrangement==="fixed"?"default":Ce.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),w(Ie),De.exit().remove(),Se.append("text").attr("class","catlabel").attr("pointer-events","none");var Te=ee._fullLayout.paper_bgcolor;_e.select("text.catlabel").attr("text-anchor",function(Ce){return s(Ce)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",r.makeTextShadow(Te)).style("fill","rgb(0, 0, 0)").attr("x",function(Ce){return s(Ce)?Ce.width+5:-5}).attr("y",function(Ce){return Ce.height/2}).text(function(Ce){return Ce.model.categoryLabel}).each(function(Ce){n.font(h.select(this),Ce.parcatsViewModel.categorylabelfont),r.convertToTspans(h.select(this),ee)}),Se.append("text").attr("class","dimlabel"),_e.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(Ce){return Ce.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(Ce){return Ce.width/2}).attr("y",-5).text(function(Ce,He){return He===0?Ce.parcatsViewModel.model.dimensions[Ce.model.dimensionInd].dimensionLabel:null}).each(function(Ce){n.font(h.select(this),Ce.parcatsViewModel.labelfont)}),_e.selectAll("rect.bandrect").on("mouseover",I).on("mouseout",O),_e.exit().remove(),me.call(h.behavior.drag().origin(function(Ce){return{x:Ce.x,y:0}}).on("dragstart",N).on("drag",V).on("dragend",H)),ie.each(function(Ce){Ce.traceSelection=h.select(this),Ce.pathSelection=h.select(this).selectAll("g.paths").selectAll("path.path"),Ce.dimensionSelection=h.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),ie.exit().remove()}P.exports=function(Y,ee,ne,J){f(ne,Y,J,ee)};function o(Y){return Y.key}function s(Y){var ee=Y.parcatsViewModel.dimensions.length,ne=Y.parcatsViewModel.dimensions[ee-1].model.dimensionInd;return Y.model.dimensionInd===ne}function m(Y,ee){return Y.model.rawColor>ee.model.rawColor?1:Y.model.rawColor<ee.model.rawColor?-1:0}function g(Y){if(!Y.parcatsViewModel.dragDimension&&Y.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){e.raiseToTop(this),c(h.select(this));var ee=v(Y),ne=x(Y);if(Y.parcatsViewModel.graphDiv.emit("plotly_hover",{points:ee,event:h.event,constraints:ne}),Y.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var J=h.mouse(this)[0],q=Y.parcatsViewModel.graphDiv,ae=Y.parcatsViewModel.trace,le=q._fullLayout,ie=le._paperdiv.node().getBoundingClientRect(),se=Y.parcatsViewModel.graphDiv.getBoundingClientRect(),xe,oe,he;for(he=0;he<Y.leftXs.length-1;he++)if(Y.leftXs[he]+Y.dimWidths[he]-2<=J&&J<=Y.leftXs[he+1]+2){var be=Y.parcatsViewModel.dimensions[he],me=Y.parcatsViewModel.dimensions[he+1];xe=(be.x+be.width+me.x)/2,oe=(Y.topYs[he]+Y.topYs[he+1]+Y.height)/2;break}var _e=Y.parcatsViewModel.x+xe,Se=Y.parcatsViewModel.y+oe,De=a.mostReadable(Y.model.color,["black","white"]),Ie=Y.model.count,Te=Ie/Y.parcatsViewModel.model.count,Ce={countLabel:Ie,probabilityLabel:Te.toFixed(3)},He=[];Y.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&He.push(["Count:",Ce.countLabel].join(" ")),Y.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&He.push(["P:",Ce.probabilityLabel].join(" "));var Xe=He.join("<br>"),Be=h.mouse(q)[0];T.loneHover({trace:ae,x:_e-ie.left+se.left,y:Se-ie.top+se.top,text:Xe,color:Y.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:De,idealAlign:Be<_e?"right":"left",hovertemplate:(ae.line||{}).hovertemplate,hovertemplateLabels:Ce,eventData:[{data:ae._input,fullData:ae,count:Ie,probability:Te}]},{container:le._hoverlayer.node(),outerContainer:le._paper.node(),gd:q})}}}function p(Y){if(!Y.parcatsViewModel.dragDimension&&(b(h.select(this)),T.loneUnhover(Y.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),Y.parcatsViewModel.pathSelection.sort(m),Y.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var ee=v(Y),ne=x(Y);Y.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:ee,event:h.event,constraints:ne})}}function v(Y){for(var ee=[],ne=j(Y.parcatsViewModel),J=0;J<Y.model.valueInds.length;J++){var q=Y.model.valueInds[J];ee.push({curveNumber:ne,pointNumber:q})}return ee}function x(Y){for(var ee={},ne=Y.parcatsViewModel.model.dimensions,J=0;J<ne.length;J++){var q=ne[J],ae=q.categories[Y.model.categoryInds[J]];ee[q.containerInd]=ae.categoryValue}return Y.model.rawColor!==void 0&&(ee.color=Y.model.rawColor),ee}function l(Y){if(Y.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var ee=v(Y),ne=x(Y);Y.parcatsViewModel.graphDiv.emit("plotly_click",{points:ee,event:h.event,constraints:ne})}}function b(Y){Y.attr("fill",function(ee){return ee.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function c(Y){Y.attr("fill-opacity",.8).attr("stroke",function(ee){return a.mostReadable(ee.model.color,["black","white"])}).attr("stroke-width",.3)}function M(Y){Y.select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}function _(Y){Y.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function y(Y){Y.attr("stroke","black").attr("stroke-width",1.5)}function w(Y){Y.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function d(Y){var ee=Y.parcatsViewModel.pathSelection,ne=Y.categoryViewModel.model.dimensionInd,J=Y.categoryViewModel.model.categoryInd;return ee.filter(function(q){return q.model.categoryInds[ne]===J&&q.model.color===Y.color})}function C(Y){var ee=h.select(Y.parentNode).selectAll("rect.bandrect");ee.each(function(ne){var J=d(ne);c(J),J.each(function(){e.raiseToTop(this)})}),M(h.select(Y.parentNode))}function S(Y){var ee=h.select(Y).datum(),ne=d(ee);c(ne),ne.each(function(){e.raiseToTop(this)}),h.select(Y.parentNode).selectAll("rect.bandrect").filter(function(J){return J.color===ee.color}).each(function(){e.raiseToTop(this),y(h.select(this))})}function E(Y,ee,ne){var J=h.select(Y).datum(),q=J.categoryViewModel.model,ae=J.parcatsViewModel.graphDiv,le=h.select(Y.parentNode).selectAll("rect.bandrect"),ie=[];le.each(function(xe){var oe=d(xe);oe.each(function(he){Array.prototype.push.apply(ie,v(he))})});var se={};se[q.dimensionInd]=q.categoryValue,ae.emit(ee,{points:ie,event:ne,constraints:se})}function k(Y,ee,ne){var J=h.select(Y).datum(),q=J.categoryViewModel.model,ae=J.parcatsViewModel.graphDiv,le=d(J),ie=[];le.each(function(xe){Array.prototype.push.apply(ie,v(xe))});var se={};se[q.dimensionInd]=q.categoryValue,J.rawColor!==void 0&&(se.color=J.rawColor),ae.emit(ee,{points:ie,event:ne,constraints:se})}function B(Y,ee,ne){Y._fullLayout._calcInverseTransform(Y);var J=Y._fullLayout._invScaleX,q=Y._fullLayout._invScaleY,ae=h.select(ne.parentNode).select("rect.catrect"),le=ae.node().getBoundingClientRect(),ie=ae.datum(),se=ie.parcatsViewModel,xe=se.model.dimensions[ie.model.dimensionInd],oe=se.trace,he=le.top+le.height/2,be,me;se.dimensions.length>1&&xe.displayInd===se.dimensions.length-1?(be=le.left,me="left"):(be=le.left+le.width,me="right");var _e=ie.model.count,Se=ie.model.categoryLabel,De=_e/ie.parcatsViewModel.model.count,Ie={countLabel:_e,categoryLabel:Se,probabilityLabel:De.toFixed(3)},Te=[];ie.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Te.push(["Count:",Ie.countLabel].join(" ")),ie.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&Te.push(["P("+Ie.categoryLabel+"):",Ie.probabilityLabel].join(" "));var Ce=Te.join("<br>");return{trace:oe,x:J*(be-ee.left),y:q*(he-ee.top),text:Ce,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:me,hovertemplate:oe.hovertemplate,hovertemplateLabels:Ie,eventData:[{data:oe._input,fullData:oe,count:_e,category:Se,probability:De}]}}function z(Y,ee,ne){var J=[];return h.select(ne.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){var q=this;J.push(B(Y,ee,q))}),J}function F(Y,ee,ne){Y._fullLayout._calcInverseTransform(Y);var J=Y._fullLayout._invScaleX,q=Y._fullLayout._invScaleY,ae=ne.getBoundingClientRect(),le=h.select(ne).datum(),ie=le.categoryViewModel,se=ie.parcatsViewModel,xe=se.model.dimensions[ie.model.dimensionInd],oe=se.trace,he=ae.y+ae.height/2,be,me;se.dimensions.length>1&&xe.displayInd===se.dimensions.length-1?(be=ae.left,me="left"):(be=ae.left+ae.width,me="right");var _e=ie.model.categoryLabel,Se=le.parcatsViewModel.model.count,De=0;le.categoryViewModel.bands.forEach(function(Pt){Pt.color===le.color&&(De+=Pt.count)});var Ie=ie.model.count,Te=0;se.pathSelection.each(function(Pt){Pt.model.color===le.color&&(Te+=Pt.model.count)});var Ce=De/Se,He=De/Te,Xe=De/Ie,Be={countLabel:Se,categoryLabel:_e,probabilityLabel:Ce.toFixed(3)},Re=[];ie.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Re.push(["Count:",Be.countLabel].join(" ")),ie.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(Re.push("P(color \u2229 "+_e+"): "+Be.probabilityLabel),Re.push("P("+_e+" | color): "+He.toFixed(3)),Re.push("P(color | "+_e+"): "+Xe.toFixed(3)));var We=Re.join("<br>"),vt=a.mostReadable(le.color,["black","white"]);return{trace:oe,x:J*(be-ee.left),y:q*(he-ee.top),text:We,color:le.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:vt,fontSize:10,idealAlign:me,hovertemplate:oe.hovertemplate,hovertemplateLabels:Be,eventData:[{data:oe._input,fullData:oe,category:_e,count:Se,probability:Ce,categorycount:Ie,colorcount:Te,bandcolorcount:De}]}}function I(Y){if(!Y.parcatsViewModel.dragDimension&&Y.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var ee=h.mouse(this)[1];if(ee<-1)return;var ne=Y.parcatsViewModel.graphDiv,J=ne._fullLayout,q=J._paperdiv.node().getBoundingClientRect(),ae=Y.parcatsViewModel.hoveron,le=this;if(ae==="color"?(S(le),k(le,"plotly_hover",h.event)):(C(le),E(le,"plotly_hover",h.event)),Y.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var ie;ae==="category"?ie=B(ne,q,le):ae==="color"?ie=F(ne,q,le):ae==="dimension"&&(ie=z(ne,q,le)),ie&&T.loneHover(ie,{container:J._hoverlayer.node(),outerContainer:J._paper.node(),gd:ne})}}}function O(Y){var ee=Y.parcatsViewModel;if(!ee.dragDimension&&(b(ee.pathSelection),_(ee.dimensionSelection.selectAll("g.category")),w(ee.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),T.loneUnhover(ee.graphDiv._fullLayout._hoverlayer.node()),ee.pathSelection.sort(m),ee.hoverinfoItems.indexOf("skip")===-1)){var ne=Y.parcatsViewModel.hoveron,J=this;ne==="color"?k(J,"plotly_unhover",h.event):E(J,"plotly_unhover",h.event)}}function N(Y){Y.parcatsViewModel.arrangement!=="fixed"&&(Y.dragDimensionDisplayInd=Y.model.displayInd,Y.initialDragDimensionDisplayInds=Y.parcatsViewModel.model.dimensions.map(function(ee){return ee.displayInd}),Y.dragHasMoved=!1,Y.dragCategoryDisplayInd=null,h.select(this).selectAll("g.category").select("rect.catrect").each(function(ee){var ne=h.mouse(this)[0],J=h.mouse(this)[1];-2<=ne&&ne<=ee.width+2&&-2<=J&&J<=ee.height+2&&(Y.dragCategoryDisplayInd=ee.model.displayInd,Y.initialDragCategoryDisplayInds=Y.model.categories.map(function(q){return q.displayInd}),ee.model.dragY=ee.y,e.raiseToTop(this.parentNode),h.select(this.parentNode).selectAll("rect.bandrect").each(function(q){q.y<J&&J<=q.y+q.height&&(Y.potentialClickBand=this)}))}),Y.parcatsViewModel.dragDimension=Y,T.loneUnhover(Y.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function V(Y){if(Y.parcatsViewModel.arrangement!=="fixed"&&(Y.dragHasMoved=!0,Y.dragDimensionDisplayInd!==null)){var ee=Y.dragDimensionDisplayInd,ne=ee-1,J=ee+1,q=Y.parcatsViewModel.dimensions[ee];if(Y.dragCategoryDisplayInd!==null){var ae=q.categories[Y.dragCategoryDisplayInd];ae.model.dragY+=h.event.dy;var le=ae.model.dragY,ie=ae.model.displayInd,se=q.categories,xe=se[ie-1],oe=se[ie+1];xe!==void 0&&le<xe.y+xe.height/2&&(ae.model.displayInd=xe.model.displayInd,xe.model.displayInd=ie),oe!==void 0&&le+ae.height>oe.y+oe.height/2&&(ae.model.displayInd=oe.model.displayInd,oe.model.displayInd=ie),Y.dragCategoryDisplayInd=ae.model.displayInd}if(Y.dragCategoryDisplayInd===null||Y.parcatsViewModel.arrangement==="freeform"){q.model.dragX=h.event.x;var he=Y.parcatsViewModel.dimensions[ne],be=Y.parcatsViewModel.dimensions[J];he!==void 0&&q.model.dragX<he.x+he.width&&(q.model.displayInd=he.model.displayInd,he.model.displayInd=ee),be!==void 0&&q.model.dragX+q.width>be.x&&(q.model.displayInd=be.model.displayInd,be.model.displayInd=Y.dragDimensionDisplayInd),Y.dragDimensionDisplayInd=q.model.displayInd}te(Y.parcatsViewModel),K(Y.parcatsViewModel),X(Y.parcatsViewModel),Z(Y.parcatsViewModel)}}function H(Y){if(Y.parcatsViewModel.arrangement!=="fixed"&&Y.dragDimensionDisplayInd!==null){h.select(this).selectAll("text").attr("font-weight","normal");var ee={},ne=j(Y.parcatsViewModel),J=Y.parcatsViewModel.model.dimensions.map(function(be){return be.displayInd}),q=Y.initialDragDimensionDisplayInds.some(function(be,me){return be!==J[me]});q&&J.forEach(function(be,me){var _e=Y.parcatsViewModel.model.dimensions[me].containerInd;ee["dimensions["+_e+"].displayindex"]=be});var ae=!1;if(Y.dragCategoryDisplayInd!==null){var le=Y.model.categories.map(function(be){return be.displayInd});if(ae=Y.initialDragCategoryDisplayInds.some(function(be,me){return be!==le[me]}),ae){var ie=Y.model.categories.slice().sort(function(be,me){return be.displayInd-me.displayInd}),se=ie.map(function(be){return be.categoryValue}),xe=ie.map(function(be){return be.categoryLabel});ee["dimensions["+Y.model.containerInd+"].categoryarray"]=[se],ee["dimensions["+Y.model.containerInd+"].ticktext"]=[xe],ee["dimensions["+Y.model.containerInd+"].categoryorder"]="array"}}if(Y.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!Y.dragHasMoved&&Y.potentialClickBand&&(Y.parcatsViewModel.hoveron==="color"?k(Y.potentialClickBand,"plotly_click",h.event.sourceEvent):E(Y.potentialClickBand,"plotly_click",h.event.sourceEvent)),Y.model.dragX=null,Y.dragCategoryDisplayInd!==null){var oe=Y.parcatsViewModel.dimensions[Y.dragDimensionDisplayInd].categories[Y.dragCategoryDisplayInd];oe.model.dragY=null,Y.dragCategoryDisplayInd=null}Y.dragDimensionDisplayInd=null,Y.parcatsViewModel.dragDimension=null,Y.dragHasMoved=null,Y.potentialClickBand=null,te(Y.parcatsViewModel),K(Y.parcatsViewModel);var he=h.transition().duration(300).ease("cubic-in-out");he.each(function(){X(Y.parcatsViewModel,!0),Z(Y.parcatsViewModel,!0)}).each("end",function(){(q||ae)&&A.restyle(Y.parcatsViewModel.graphDiv,ee,[ne])})}}function j(Y){for(var ee,ne=Y.graphDiv._fullData,J=0;J<ne.length;J++)if(Y.key===ne[J].uid){ee=J;break}return ee}function Z(Y,ee){ee===void 0&&(ee=!1);function ne(J){return ee?J.transition():J}Y.pathSelection.data(function(J){return J.paths},o),ne(Y.pathSelection).attr("d",function(J){return J.svgD})}function X(Y,ee){ee===void 0&&(ee=!1);function ne(se){return ee?se.transition():se}Y.dimensionSelection.data(function(se){return se.dimensions},o);var J=Y.dimensionSelection.selectAll("g.category").data(function(se){return se.categories},o);ne(Y.dimensionSelection).attr("transform",function(se){return i(se.x,0)}),ne(J).attr("transform",function(se){return i(0,se.y)});var q=J.select(".dimlabel");q.text(function(se,xe){return xe===0?se.parcatsViewModel.model.dimensions[se.model.dimensionInd].dimensionLabel:null});var ae=J.select(".catlabel");ae.attr("text-anchor",function(se){return s(se)?"start":"end"}).attr("x",function(se){return s(se)?se.width+5:-5}).each(function(se){var xe,oe;s(se)?(xe=se.width+5,oe="start"):(xe=-5,oe="end"),h.select(this).selectAll("tspan").attr("x",xe).attr("text-anchor",oe)});var le=J.selectAll("rect.bandrect").data(function(se){return se.bands},o),ie=le.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(se){return se.color}).attr("fill-opacity",0);le.attr("fill",function(se){return se.color}).attr("width",function(se){return se.width}).attr("height",function(se){return se.height}).attr("y",function(se){return se.y}),w(ie),le.each(function(){e.raiseToTop(this)}),le.exit().remove()}function re(Y,ee,ne){var J=ne[0],q=ee.margin||{l:80,r:80,t:100,b:80},ae=J.trace,le=ae.domain,ie=ee.width,se=ee.height,xe=Math.floor(ie*(le.x[1]-le.x[0])),oe=Math.floor(se*(le.y[1]-le.y[0])),he=le.x[0]*ie+q.l,be=ee.height-le.y[1]*ee.height+q.t,me=ae.line.shape,_e;ae.hoverinfo==="all"?_e=["count","probability"]:_e=(ae.hoverinfo||"").split("+");var Se={trace:ae,key:ae.uid,model:J,x:he,y:be,width:xe,height:oe,hoveron:ae.hoveron,hoverinfoItems:_e,arrangement:ae.arrangement,bundlecolors:ae.bundlecolors,sortpaths:ae.sortpaths,labelfont:ae.labelfont,categorylabelfont:ae.tickfont,pathShape:me,dragDimension:null,margin:q,paths:[],dimensions:[],graphDiv:Y,traceSelection:null,pathSelection:null,dimensionSelection:null};return J.dimensions&&(te(Se),K(Se)),Se}function ue(Y,ee,ne,J,q){var ae=[],le=[],ie,se;for(se=0;se<ne.length-1;se++)ie=u(ne[se]+Y[se],Y[se+1]),ae.push(ie(q)),le.push(ie(1-q));var xe="M "+Y[0]+","+ee[0];for(xe+="l"+ne[0]+",0 ",se=1;se<ne.length;se++)xe+="C"+ae[se-1]+","+ee[se-1]+" "+le[se-1]+","+ee[se]+" "+Y[se]+","+ee[se],xe+="l"+ne[se]+",0 ";for(xe+="l0,"+J+" ",xe+="l -"+ne[ne.length-1]+",0 ",se=ne.length-2;se>=0;se--)xe+="C"+le[se]+","+(ee[se+1]+J)+" "+ae[se]+","+(ee[se]+J)+" "+(Y[se]+ne[se])+","+(ee[se]+J),xe+="l-"+ne[se]+",0 ";return xe+="Z",xe}function K(Y){var ee=Y.dimensions,ne=Y.model,J=ee.map(function(At){return At.categories.map(function(Wt){return Wt.y})}),q=Y.model.dimensions.map(function(At){return At.categories.map(function(Wt){return Wt.displayInd})}),ae=Y.model.dimensions.map(function(At){return At.displayInd}),le=Y.dimensions.map(function(At){return At.model.dimensionInd}),ie=ee.map(function(At){return At.x}),se=ee.map(function(At){return At.width}),xe=[];for(var oe in ne.paths)ne.paths.hasOwnProperty(oe)&&xe.push(ne.paths[oe]);function he(At){var Wt=At.categoryInds.map(function(Ct,Ze){return q[Ze][Ct]}),Bt=le.map(function(Ct){return Wt[Ct]});return Bt}xe.sort(function(At,Wt){var Bt=he(At),Ct=he(Wt);return Y.sortpaths==="backward"&&(Bt.reverse(),Ct.reverse()),Bt.push(At.valueInds[0]),Ct.push(Wt.valueInds[0]),Y.bundlecolors&&(Bt.unshift(At.rawColor),Ct.unshift(Wt.rawColor)),Bt<Ct?-1:Bt>Ct?1:0});for(var be=new Array(xe.length),me=ee[0].model.count,_e=ee[0].categories.map(function(At){return At.height}).reduce(function(At,Wt){return At+Wt}),Se=0;Se<xe.length;Se++){var De=xe[Se],Ie;me>0?Ie=_e*(De.count/me):Ie=0;for(var Te=new Array(J.length),Ce=0;Ce<De.categoryInds.length;Ce++){var He=De.categoryInds[Ce],Xe=q[Ce][He],Be=ae[Ce];Te[Be]=J[Be][Xe],J[Be][Xe]+=Ie;var Re=Y.dimensions[Be].categories[Xe],We=Re.bands.length,vt=Re.bands[We-1];if(vt===void 0||De.rawColor!==vt.rawColor){var Pt=vt===void 0?0:vt.y+vt.height;Re.bands.push({key:Pt,color:De.color,rawColor:De.rawColor,height:Ie,width:Re.width,count:De.count,y:Pt,categoryViewModel:Re,parcatsViewModel:Y})}else{var Zt=Re.bands[We-1];Zt.height+=Ie,Zt.count+=De.count}}var zt;Y.pathShape==="hspline"?zt=ue(ie,Te,se,Ie,.5):zt=ue(ie,Te,se,Ie,0),be[Se]={key:De.valueInds[0],model:De,height:Ie,leftXs:ie,topYs:Te,dimWidths:se,svgD:zt,parcatsViewModel:Y}}Y.paths=be}function te(Y){var ee=Y.model.dimensions.map(function(le){return{displayInd:le.displayInd,dimensionInd:le.dimensionInd}});ee.sort(function(le,ie){return le.displayInd-ie.displayInd});var ne=[];for(var J in ee){var q=ee[J].dimensionInd,ae=Y.model.dimensions[q];ne.push(G(Y,ae))}Y.dimensions=ne}function G(Y,ee){var ne=40,J=16,q=Y.model.dimensions.length,ae=ee.displayInd,le,ie,se;q>1?le=(Y.width-2*ne-J)/(q-1):le=0,ie=ne,se=ie+le*ae;var xe=[],oe=Y.model.maxCats,he=ee.categories.length,be=8,me=ee.count,_e=Y.height-be*(oe-1),Se,De,Ie,Te,Ce,He=(oe-he)*be/2,Xe=ee.categories.map(function(Be){return{displayInd:Be.displayInd,categoryInd:Be.categoryInd}});for(Xe.sort(function(Be,Re){return Be.displayInd-Re.displayInd}),Ce=0;Ce<he;Ce++)Te=Xe[Ce].categoryInd,De=ee.categories[Te],me>0?Se=De.count/me*_e:Se=0,Ie={key:De.valueInds[0],model:De,width:J,height:Se,y:De.dragY!==null?De.dragY:He,bands:[],parcatsViewModel:Y},He=He+Se+be,xe.push(Ie);return{key:ee.dimensionInd,x:ee.dragX!==null?ee.dragX:se,y:0,width:J,model:ee,categories:xe,parcatsViewModel:Y,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}},{"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_api":552,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:313}],896:[function(t,P,R){var h=t("./parcats");P.exports=function(A,T,e,i){var n=A._fullLayout,a=n._paper,r=n._size;h(A,a,T,{width:r.w,height:r.h,margin:{t:r.t,r:r.r,b:r.b,l:r.l}},e,i)}},{"./parcats":895}],897:[function(t,P,R){var h=t("../../components/colorscale/attributes"),u=t("../../plots/cartesian/layout_attributes"),A=t("../../plots/font_attributes"),T=t("../../plots/domain").attributes,e=t("../../lib/extend").extendFlat,i=t("../../plot_api/plot_template").templatedArray;P.exports={domain:T({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:A({editType:"plot"}),tickfont:A({editType:"plot"}),rangefont:A({editType:"plot"}),dimensions:i("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},u.tickvals,{editType:"plot"}),ticktext:e({},u.ticktext,{editType:"plot"}),tickformat:e({},u.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},h("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"})),unselected:{line:{color:{valType:"color",dflt:"#7f7f7f",editType:"plot"},opacity:{valType:"number",min:0,max:1,dflt:"auto",editType:"plot"},editType:"plot"},editType:"plot"}}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],898:[function(t,P,R){var h=t("./constants"),u=t("@plotly/d3"),A=t("../../lib/gup").keyFun,T=t("../../lib/gup").repeat,e=t("../../lib").sorterAsc,i=t("../../lib").strTranslate,n=h.bar.snapRatio;function a(H,j){return H*(1-n)+j*n}var r=h.bar.snapClose;function f(H,j){return H*(1-r)+j*r}function o(H,j,Z,X){if(s(Z,X))return Z;var re=H?-1:1,ue=0,K=j.length-1;if(re<0){var te=ue;ue=K,K=te}for(var G=j[ue],Y=G,ee=ue;re*ee<re*K;ee+=re){var ne=ee+re,J=j[ne];if(re*Z<re*f(G,J))return a(G,Y);if(re*Z<re*J||ne===K)return a(J,G);Y=G,G=J}}function s(H,j){for(var Z=0;Z<j.length;Z++)if(H>=j[Z][0]&&H<=j[Z][1])return!0;return!1}function m(H){H.attr("x",-h.bar.captureWidth/2).attr("width",h.bar.captureWidth)}function g(H){H.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function p(H){if(!H.brush.filterSpecified)return"0,"+H.height;for(var j=v(H.brush.filter.getConsolidated(),H.height),Z=[0],X,re,ue,K=j.length?j[0][0]:null,te=0;te<j.length;te++)X=j[te],re=X[1]-X[0],Z.push(K),Z.push(re),ue=te+1,ue<j.length&&(K=j[ue][0]-X[1]);return Z.push(H.height),Z}function v(H,j){return H.map(function(Z){return Z.map(function(X){return Math.max(0,X*j)}).sort(e)})}function x(H,j){var Z=h.bar.handleHeight;if(!(j>H[1]+Z||j<H[0]-Z))return j>=.9*H[1]+.1*H[0]?"n":j<=.9*H[0]+.1*H[1]?"s":"ns"}function l(){u.select(document.body).style("cursor",null)}function b(H){H.attr("stroke-dasharray",p)}function c(H,j){var Z=u.select(H).selectAll(".highlight, .highlight-shadow"),X=j?Z.transition().duration(h.bar.snapDuration).each("end",j):Z;b(X)}function M(H,j){var Z=H.brush,X=Z.filterSpecified,re=NaN,ue={},K;if(X){var te=H.height,G=Z.filter.getConsolidated(),Y=v(G,te),ee=NaN,ne=NaN,J=NaN;for(K=0;K<=Y.length;K++){var q=Y[K];if(q&&q[0]<=j&&j<=q[1]){ee=K;break}else if(ne=K?K-1:NaN,q&&q[0]>j){J=K;break}}if(re=ee,isNaN(re)&&(isNaN(ne)||isNaN(J)?re=isNaN(ne)?J:ne:re=j-Y[ne][1]<Y[J][0]-j?ne:J),!isNaN(re)){var ae=Y[re],le=x(ae,j);le&&(ue.interval=G[re],ue.intervalPix=ae,ue.region=le)}}if(H.ordinal&&!ue.region){var ie=H.unitTickvals,se=H.unitToPaddedPx.invert(j);for(K=0;K<ie.length;K++){var xe=[ie[Math.max(K-1,0)]*.25+ie[K]*.75,ie[Math.min(K+1,ie.length-1)]*.25+ie[K]*.75];if(se>=xe[0]&&se<=xe[1]){ue.clickableOrdinalRange=xe;break}}}return ue}function _(H,j){u.event.sourceEvent.stopPropagation();var Z=j.height-u.mouse(H)[1]-2*h.verticalPadding,X=j.unitToPaddedPx.invert(Z),re=j.brush,ue=M(j,Z),K=ue.interval,te=re.svgBrush;if(te.wasDragged=!1,te.grabbingBar=ue.region==="ns",te.grabbingBar){var G=K.map(j.unitToPaddedPx);te.grabPoint=Z-G[0]-h.verticalPadding,te.barLength=G[1]-G[0]}te.clickableOrdinalRange=ue.clickableOrdinalRange,te.stayingIntervals=j.multiselect&&re.filterSpecified?re.filter.getConsolidated():[],K&&(te.stayingIntervals=te.stayingIntervals.filter(function(Y){return Y[0]!==K[0]&&Y[1]!==K[1]})),te.startExtent=ue.region?K[ue.region==="s"?1:0]:X,j.parent.inBrushDrag=!0,te.brushStartCallback()}function y(H,j){u.event.sourceEvent.stopPropagation();var Z=j.height-u.mouse(H)[1]-2*h.verticalPadding,X=j.brush.svgBrush;X.wasDragged=!0,X._dragging=!0,X.grabbingBar?X.newExtent=[Z-X.grabPoint,Z+X.barLength-X.grabPoint].map(j.unitToPaddedPx.invert):X.newExtent=[X.startExtent,j.unitToPaddedPx.invert(Z)].sort(e),j.brush.filterSpecified=!0,X.extent=X.stayingIntervals.concat([X.newExtent]),X.brushCallback(j),c(H.parentNode)}function w(H,j){var Z=j.brush,X=Z.filter,re=Z.svgBrush;re._dragging||(d(H,j),y(H,j),j.brush.svgBrush.wasDragged=!1),re._dragging=!1;var ue=u.event;ue.sourceEvent.stopPropagation();var K=re.grabbingBar;if(re.grabbingBar=!1,re.grabLocation=void 0,j.parent.inBrushDrag=!1,l(),!re.wasDragged){re.wasDragged=void 0,re.clickableOrdinalRange?Z.filterSpecified&&j.multiselect?re.extent.push(re.clickableOrdinalRange):(re.extent=[re.clickableOrdinalRange],Z.filterSpecified=!0):K?(re.extent=re.stayingIntervals,re.extent.length===0&&z(Z)):z(Z),re.brushCallback(j),c(H.parentNode),re.brushEndCallback(Z.filterSpecified?X.getConsolidated():[]);return}var te=function(){X.set(X.getConsolidated())};if(j.ordinal){var G=j.unitTickvals;G[G.length-1]<G[0]&&G.reverse(),re.newExtent=[o(0,G,re.newExtent[0],re.stayingIntervals),o(1,G,re.newExtent[1],re.stayingIntervals)];var Y=re.newExtent[1]>re.newExtent[0];re.extent=re.stayingIntervals.concat(Y?[re.newExtent]:[]),re.extent.length||z(Z),re.brushCallback(j),Y?c(H.parentNode,te):(te(),c(H.parentNode))}else te();re.brushEndCallback(Z.filterSpecified?X.getConsolidated():[])}function d(H,j){var Z=j.height-u.mouse(H)[1]-2*h.verticalPadding,X=M(j,Z),re="crosshair";X.clickableOrdinalRange?re="pointer":X.region&&(re=X.region+"-resize"),u.select(document.body).style("cursor",re)}function C(H){H.on("mousemove",function(j){u.event.preventDefault(),j.parent.inBrushDrag||d(this,j)}).on("mouseleave",function(j){j.parent.inBrushDrag||l()}).call(u.behavior.drag().on("dragstart",function(j){_(this,j)}).on("drag",function(j){y(this,j)}).on("dragend",function(j){w(this,j)}))}function S(H,j){return H[0]-j[0]}function E(H,j,Z){var X=Z._context.staticPlot,re=H.selectAll(".background").data(T);re.enter().append("rect").classed("background",!0).call(m).call(g).style("pointer-events",X?"none":"auto").attr("transform",i(0,h.verticalPadding)),re.call(C).attr("height",function(te){return te.height-h.verticalPadding});var ue=H.selectAll(".highlight-shadow").data(T);ue.enter().append("line").classed("highlight-shadow",!0).attr("x",-h.bar.width/2).attr("stroke-width",h.bar.width+h.bar.strokeWidth).attr("stroke",j).attr("opacity",h.bar.strokeOpacity).attr("stroke-linecap","butt"),ue.attr("y1",function(te){return te.height}).call(b);var K=H.selectAll(".highlight").data(T);K.enter().append("line").classed("highlight",!0).attr("x",-h.bar.width/2).attr("stroke-width",h.bar.width-h.bar.strokeWidth).attr("stroke",h.bar.fillColor).attr("opacity",h.bar.fillOpacity).attr("stroke-linecap","butt"),K.attr("y1",function(te){return te.height}).call(b)}function k(H,j,Z){var X=H.selectAll("."+h.cn.axisBrush).data(T,A);X.enter().append("g").classed(h.cn.axisBrush,!0),E(X,j,Z)}function B(H){return H.svgBrush.extent.map(function(j){return j.slice()})}function z(H){H.filterSpecified=!1,H.svgBrush.extent=[[-1/0,1/0]]}function F(H){return function(Z){var X=Z.brush,re=B(X),ue=re.slice();X.filter.set(ue),H()}}function I(H){for(var j=H.slice(),Z=[],X,re=j.shift();re;){for(X=re.slice();(re=j.shift())&&re[0]<=X[1];)X[1]=Math.max(X[1],re[1]);Z.push(X)}return Z.length===1&&Z[0][0]>Z[0][1]&&(Z=[]),Z}function O(){var H=[],j,Z;return{set:function(X){H=X.map(function(re){return re.slice().sort(e)}).sort(S),H.length===1&&H[0][0]===-1/0&&H[0][1]===1/0&&(H=[[0,-1]]),j=I(H),Z=H.reduce(function(re,ue){return[Math.min(re[0],ue[0]),Math.max(re[1],ue[1])]},[1/0,-1/0])},get:function(){return H.slice()},getConsolidated:function(){return j},getBounds:function(){return Z}}}function N(H,j,Z,X,re,ue){var K=O();return K.set(Z),{filter:K,filterSpecified:j,svgBrush:{extent:[],brushStartCallback:X,brushCallback:F(re),brushEndCallback:ue}}}function V(H,j){if(Array.isArray(H[0])?(H=H.map(function(X){return X.sort(e)}),j.multiselect?H=I(H.sort(S)):H=[H[0]]):H=[H.sort(e)],j.tickvals){var Z=j.tickvals.slice().sort(e);if(H=H.map(function(X){var re=[o(0,Z,X[0],[]),o(1,Z,X[1],[])];if(re[1]>re[0])return re}).filter(function(X){return X}),!H.length)return}return H.length>1?H:H[0]}P.exports={makeBrush:N,ensureAxisBrush:k,cleanRanges:V}},{"../../lib":515,"../../lib/gup":512,"./constants":902,"@plotly/d3":58}],899:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),calc:t("./calc"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:t("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":897,"./base_plot":900,"./calc":901,"./defaults":903}],900:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../plots/get_data").getModuleCalcData,A=t("./plot"),T=t("../../constants/xmlns_namespaces");R.name="parcoords",R.plot=function(e){var i=u(e.calcdata,"parcoords")[0];i.length&&A(e,i)},R.clean=function(e,i,n,a){var r=a._has&&a._has("parcoords"),f=i._has&&i._has("parcoords");r&&!f&&(a._paperdiv.selectAll(".parcoords").remove(),a._glimages.selectAll("*").remove())},R.toSVG=function(e){var i=e._fullLayout._glimages,n=h.select(e).selectAll(".svg-container"),a=n.filter(function(f,o){return o===n.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function r(){var f=this,o=f.toDataURL("image/png"),s=i.append("svg:image");s.attr({xmlns:T.svg,"xlink:href":o,preserveAspectRatio:"none",x:0,y:0,width:f.style.width,height:f.style.height})}a.each(r),window.setTimeout(function(){h.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":492,"../../plots/get_data":602,"./plot":909,"@plotly/d3":58}],901:[function(t,P,R){var h=t("../../lib").isArrayOrTypedArray,u=t("../../components/colorscale"),A=t("../../lib/gup").wrap;P.exports=function(i,n){var a,r;return u.hasColorscale(n,"line")&&h(n.line.color)?(a=n.line.color,r=u.extractOpts(n.line).colorscale,u.calc(i,n,{vals:a,containerStr:"line",cLetter:"c"})):(a=T(n._length),r=[[0,n.line.color],[1,n.line.color]]),A({lineColor:a,cscale:r})};function T(e){for(var i=new Array(e),n=0;n<e;n++)i[n]=.5;return i}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512}],902:[function(t,P,R){P.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],903:[function(t,P,R){var h=t("../../lib"),u=t("../../components/colorscale/helpers").hasColorscale,A=t("../../components/colorscale/defaults"),T=t("../../plots/domain").defaults,e=t("../../plots/array_container_defaults"),i=t("../../plots/cartesian/axes"),n=t("./attributes"),a=t("./axisbrush"),r=t("./constants").maxDimensionCount,f=t("./merge_length");function o(m,g,p,v,x){var l=x("line.color",p);if(u(m,"line")&&h.isArrayOrTypedArray(l)){if(l.length)return x("line.colorscale"),A(m,g,v,x,{prefix:"line.",cLetter:"c"}),l.length;g.line.color=p}return 1/0}function s(m,g,p,v){function x(_,y){return h.coerce(m,g,n.dimensions,_,y)}var l=x("values"),b=x("visible");if(l&&l.length||(b=g.visible=!1),b){x("label"),x("tickvals"),x("ticktext"),x("tickformat");var c=x("range");g._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:c},i.setConvert(g._ax,v.layout),x("multiselect");var M=x("constraintrange");M&&(g.constraintrange=a.cleanRanges(M,g))}}P.exports=function(g,p,v,x){function l(y,w){return h.coerce(g,p,n,y,w)}var b=g.dimensions;Array.isArray(b)&&b.length>r&&(h.log("parcoords traces support up to "+r+" dimensions at the moment"),b.splice(r));var c=e(g,p,{name:"dimensions",layout:x,handleItemDefaults:s}),M=o(g,p,v,x,l);T(p,x,l),(!Array.isArray(c)||!c.length)&&(p.visible=!1),f(p,c,"values",M);var _={family:x.font.family,size:Math.round(x.font.size/1.2),color:x.font.color};h.coerceFont(l,"labelfont",_),h.coerceFont(l,"tickfont",_),h.coerceFont(l,"rangefont",_),l("labelangle"),l("labelside"),l("unselected.line.color"),l("unselected.line.opacity")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../../plots/domain":593,"./attributes":897,"./axisbrush":898,"./constants":902,"./merge_length":907}],904:[function(t,P,R){var h=t("../../lib").isTypedArray;R.convertTypedArray=function(u){return h(u)?Array.prototype.slice.call(u):u},R.isOrdinal=function(u){return!!u.tickvals},R.isVisible=function(u){return u.visible||!("visible"in u)}},{"../../lib":515}],905:[function(t,P,R){var h=t("./base_index");h.plot=t("./plot"),P.exports=h},{"./base_index":899,"./plot":909}],906:[function(t,P,R){var h=t("glslify"),u=h([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;
uniform sampler2D maskTexture, palette;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(maskTexture,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),A=h([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),T=t("./constants").maxDimensionCount,e=t("../../lib"),i=1e-6,n=2048,a=new Uint8Array(4),r=new Uint8Array(4),f={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function o(d){d.read({x:0,y:0,width:1,height:1,data:a})}function s(d,C,S,E,k){var B=d._gl;B.enable(B.SCISSOR_TEST),B.scissor(C,S,E,k),d.clear({color:[0,0,0,0],depth:1})}function m(d,C,S,E,k,B){var z=B.key;function F(I){var O=Math.min(E,k-I*E);I===0&&(window.cancelAnimationFrame(S.currentRafs[z]),delete S.currentRafs[z],s(d,B.scissorX,B.scissorY,B.scissorWidth,B.viewBoxSize[1])),!S.clearOnly&&(B.count=2*O,B.offset=2*I*E,C(B),I*E+O<k&&(S.currentRafs[z]=window.requestAnimationFrame(function(){F(I+1)})),S.drawCompleted=!1)}S.drawCompleted||(o(d),S.drawCompleted=!0),F(0)}function g(d){return Math.max(i,Math.min(1-i,d))}function p(d,C){for(var S=new Array(256),E=0;E<256;E++)S[E]=d(E/255).concat(C);return S}function v(d,C){return(d>>>8*C)%256/255}function x(d,C,S){for(var E=new Array(d*(T+4)),k=0,B=0;B<d;B++){for(var z=0;z<T;z++)E[k++]=z<C.length?C[z].paddedUnitValues[B]:.5;E[k++]=v(B,2),E[k++]=v(B,1),E[k++]=v(B,0),E[k++]=g(S[B])}return E}function l(d,C,S){for(var E=new Array(C*8),k=0,B=0;B<C;B++)for(var z=0;z<2;z++)for(var F=0;F<4;F++){var I=d*4+F,O=S[B*64+I];I===63&&z===0&&(O*=-1),E[k++]=O}return E}function b(d){var C="0"+d;return C.substr(C.length-2)}function c(d){return d<T?"p"+b(d+1)+"_"+b(d+4):"colors"}function M(d,C,S){for(var E=0;E<=T;E+=4)d[c(E)](l(E/4,C,S))}function _(d){for(var C={},S=0;S<=T;S+=4)C[c(S)]=d.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return C}function y(d,C,S,E,k,B,z,F,I,O,N,V,H,j){for(var Z=[[],[]],X=0;X<64;X++)Z[0][X]=X===k?1:0,Z[1][X]=X===B?1:0;z*=j,F*=j,I*=j,O*=j;var re=d.lines.canvasOverdrag*j,ue=d.domain,K=d.canvasWidth*j,te=d.canvasHeight*j,G=d.pad.l*j,Y=d.pad.b*j,ee=d.layoutHeight*j,ne=d.layoutWidth*j,J=d.deselectedLines.color,q=d.deselectedLines.opacity,ae=e.extendFlat({key:N,resolution:[K,te],viewBoxPos:[z+re,F],viewBoxSize:[I,O],i0:k,i1:B,dim0A:Z[0].slice(0,16),dim0B:Z[0].slice(16,32),dim0C:Z[0].slice(32,48),dim0D:Z[0].slice(48,64),dim1A:Z[1].slice(0,16),dim1B:Z[1].slice(16,32),dim1C:Z[1].slice(32,48),dim1D:Z[1].slice(48,64),drwLayer:V,contextColor:[J[0]/255,J[1]/255,J[2]/255,q!=="auto"?J[3]*q:Math.max(1/255,Math.pow(1/d.lines.color.length,1/3))],scissorX:(E===C?0:z+re)+(G-re)+ne*ue.x[0],scissorWidth:(E===S?K-z+re:I+.5)+(E===C?z+re:0),scissorY:F+Y+ee*ue.y[0],scissorHeight:O,viewportX:G-re+ne*ue.x[0],viewportY:Y+ee*ue.y[0],viewportWidth:K,viewportHeight:te},H);return ae}function w(d){var C=n-1,S=Math.max(0,Math.floor(d[0]*C),0),E=Math.min(C,Math.ceil(d[1]*C),C);return[Math.min(S,E),Math.max(S,E)]}P.exports=function(d,C){var S=C.context,E=C.pick,k=C.regl,B=k._gl,z=B.getParameter(B.ALIASED_LINE_WIDTH_RANGE),F=Math.max(z[0],Math.min(z[1],C.viewModel.plotGlPixelRatio)),I={currentRafs:{},drawCompleted:!0,clearOnly:!1},O,N,V,H,j=_(k),Z,X=k.texture(f),re=[];K(C);var ue=k({profile:!1,blend:{enable:S,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!S,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:k.prop("scissorX"),y:k.prop("scissorY"),width:k.prop("scissorWidth"),height:k.prop("scissorHeight")}},viewport:{x:k.prop("viewportX"),y:k.prop("viewportY"),width:k.prop("viewportWidth"),height:k.prop("viewportHeight")},dither:!1,vert:u,frag:A,primitive:"lines",lineWidth:F,attributes:j,uniforms:{resolution:k.prop("resolution"),viewBoxPos:k.prop("viewBoxPos"),viewBoxSize:k.prop("viewBoxSize"),dim0A:k.prop("dim0A"),dim1A:k.prop("dim1A"),dim0B:k.prop("dim0B"),dim1B:k.prop("dim1B"),dim0C:k.prop("dim0C"),dim1C:k.prop("dim1C"),dim0D:k.prop("dim0D"),dim1D:k.prop("dim1D"),loA:k.prop("loA"),hiA:k.prop("hiA"),loB:k.prop("loB"),hiB:k.prop("hiB"),loC:k.prop("loC"),hiC:k.prop("hiC"),loD:k.prop("loD"),hiD:k.prop("hiD"),palette:X,contextColor:k.prop("contextColor"),maskTexture:k.prop("maskTexture"),drwLayer:k.prop("drwLayer"),maskHeight:k.prop("maskHeight")},offset:k.prop("offset"),count:k.prop("count")});function K(J){O=J.model,N=J.viewModel,V=N.dimensions.slice(),H=V[0]?V[0].values.length:0;var q=O.lines,ae=E?q.color.map(function(ie,se){return se/q.color.length}):q.color,le=x(H,V,ae);M(j,H,le),!S&&!E&&(X=k.texture(e.extendFlat({data:p(O.unitToColor,255)},f)))}function te(J){var q,ae,le,ie=[[],[]];for(le=0;le<64;le++){var se=!J&&le<V.length?V[le].brush.filter.getBounds():[-1/0,1/0];ie[0][le]=se[0],ie[1][le]=se[1]}var xe=n*8,oe=new Array(xe);for(q=0;q<xe;q++)oe[q]=255;if(!J)for(q=0;q<V.length;q++){var he=q%8,be=(q-he)/8,me=Math.pow(2,he),_e=V[q],Se=_e.brush.filter.get();if(!(Se.length<2)){var De=w(Se[0])[1];for(ae=1;ae<Se.length;ae++){var Ie=w(Se[ae]);for(le=De+1;le<Ie[0];le++)oe[le*8+be]&=~me;De=Math.max(De,Ie[1])}}}var Te={shape:[8,n],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:oe};return Z?Z(Te):Z=k.texture(Te),{maskTexture:Z,maskHeight:n,loA:ie[0].slice(0,16),loB:ie[0].slice(16,32),loC:ie[0].slice(32,48),loD:ie[0].slice(48,64),hiA:ie[1].slice(0,16),hiB:ie[1].slice(16,32),hiC:ie[1].slice(32,48),hiD:ie[1].slice(48,64)}}function G(J,q,ae){var le=J.length,ie,se,xe,oe=1/0,he=-1/0;for(ie=0;ie<le;ie++)J[ie].dim0.canvasX<oe&&(oe=J[ie].dim0.canvasX,se=ie),J[ie].dim1.canvasX>he&&(he=J[ie].dim1.canvasX,xe=ie);le===0&&s(k,0,0,O.canvasWidth,O.canvasHeight);var be=te(S);for(ie=0;ie<le;ie++){var me=J[ie],_e=me.dim0.crossfilterDimensionIndex,Se=me.dim1.crossfilterDimensionIndex,De=me.canvasX,Ie=me.canvasY,Te=De+me.panelSizeX,Ce=me.plotGlPixelRatio;if(q||!re[_e]||re[_e][0]!==De||re[_e][1]!==Te){re[_e]=[De,Te];var He=y(O,se,xe,ie,_e,Se,De,Ie,me.panelSizeX,me.panelSizeY,me.dim0.crossfilterDimensionIndex,S?0:E?2:1,be,Ce);I.clearOnly=ae;var Xe=q?O.lines.blockLineCount:H;m(k,ue,I,Xe,H,He)}}}function Y(J,q){return k.read({x:J,y:q,width:1,height:1,data:r}),r}function ee(J,q,ae,le){var ie=new Uint8Array(4*ae*le);return k.read({x:J,y:q,width:ae,height:le,data:ie}),ie}function ne(){d.style["pointer-events"]="none",X.destroy(),Z&&Z.destroy();for(var J in j)j[J].destroy()}return{render:G,readPixel:Y,readPixels:ee,destroy:ne,update:K}}},{"../../lib":515,"./constants":902,glslify:227}],907:[function(t,P,R){P.exports=function(h,u,A,T){T||(T=1/0);var e,i;for(e=0;e<u.length;e++)i=u[e],i.visible&&(T=Math.min(T,i[A].length));for(T===1/0&&(T=0),h._length=T,e=0;e<u.length;e++)i=u[e],i.visible&&(i._length=T);return T}},{}],908:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=u.numberFormat,T=t("color-rgba"),e=t("../../plots/cartesian/axes"),i=u.strRotate,n=u.strTranslate,a=t("../../lib/svg_text_utils"),r=t("../../components/drawing"),f=t("../../components/colorscale"),o=t("../../lib/gup"),s=o.keyFun,m=o.repeat,g=o.unwrap,p=t("./helpers"),v=t("./constants"),x=t("./axisbrush"),l=t("./lines");function b(Z,X,re){return u.aggNums(Z,null,X,re)}function c(Z,X){return _(b(Math.min,Z,X),b(Math.max,Z,X))}function M(Z){var X=Z.range;return X?_(X[0],X[1]):c(Z.values,Z._length)}function _(Z,X){return(isNaN(Z)||!isFinite(Z))&&(Z=0),(isNaN(X)||!isFinite(X))&&(X=0),Z===X&&(Z===0?(Z-=1,X+=1):(Z*=.9,X*=1.1)),[Z,X]}function y(Z,X){return X?function(re,ue){var K=X[ue];return K==null?Z(re):K}:Z}function w(Z,X,re,ue,K){var te=M(re);return ue?h.scale.ordinal().domain(ue.map(y(A(re.tickformat),K))).range(ue.map(function(G){var Y=(G-te[0])/(te[1]-te[0]);return Z-X+Y*(2*X-Z)})):h.scale.linear().domain(te).range([Z-X,X])}function d(Z,X){return h.scale.linear().range([X,Z-X])}function C(Z,X){return h.scale.linear().domain(M(Z)).range([X,1-X])}function S(Z){if(!!Z.tickvals){var X=M(Z);return h.scale.ordinal().domain(Z.tickvals).range(Z.tickvals.map(function(re){return(re-X[0])/(X[1]-X[0])}))}}function E(Z){var X=Z.map(function(te){return te[0]}),re=Z.map(function(te){var G=T(te[1]);return h.rgb("rgb("+G[0]+","+G[1]+","+G[2]+")")}),ue=function(te){return function(G){return G[te]}},K="rgb".split("").map(function(te){return h.scale.linear().clamp(!0).domain(X).range(re.map(ue(te)))});return function(te){return K.map(function(G){return G(te)})}}function k(Z){return Z.dimensions.some(function(X){return X.brush.filterSpecified})}function B(Z,X,re){var ue=g(X),K=ue.trace,te=p.convertTypedArray(ue.lineColor),G=K.line,Y={color:T(K.unselected.line.color),opacity:K.unselected.line.opacity},ee=f.extractOpts(G),ne=ee.reversescale?f.flipScale(ue.cscale):ue.cscale,J=K.domain,q=K.dimensions,ae=Z.width,le=K.labelangle,ie=K.labelside,se=K.labelfont,xe=K.tickfont,oe=K.rangefont,he=u.extendDeepNoArrays({},G,{color:te.map(h.scale.linear().domain(M({values:te,range:[ee.min,ee.max],_length:K._length}))),blockLineCount:v.blockLineCount,canvasOverdrag:v.overdrag*v.canvasPixelRatio}),be=Math.floor(ae*(J.x[1]-J.x[0])),me=Math.floor(Z.height*(J.y[1]-J.y[0])),_e=Z.margin||{l:80,r:80,t:100,b:80},Se=be,De=me;return{key:re,colCount:q.filter(p.isVisible).length,dimensions:q,tickDistance:v.tickDistance,unitToColor:E(ne),lines:he,deselectedLines:Y,labelAngle:le,labelSide:ie,labelFont:se,tickFont:xe,rangeFont:oe,layoutWidth:ae,layoutHeight:Z.height,domain:J,translateX:J.x[0]*ae,translateY:Z.height-J.y[1]*Z.height,pad:_e,canvasWidth:Se*v.canvasPixelRatio+2*he.canvasOverdrag,canvasHeight:De*v.canvasPixelRatio,width:Se,height:De,canvasPixelRatio:v.canvasPixelRatio}}function z(Z,X,re){var ue=re.width,K=re.height,te=re.dimensions,G=re.canvasPixelRatio,Y=function(ae){return ue*ae/Math.max(1,re.colCount-1)},ee=v.verticalPadding/K,ne=d(K,v.verticalPadding),J={key:re.key,xScale:Y,model:re,inBrushDrag:!1},q={};return J.dimensions=te.filter(p.isVisible).map(function(ae,le){var ie=C(ae,ee),se=q[ae.label];q[ae.label]=(se||0)+1;var xe=ae.label+(se?"__"+se:""),oe=ae.constraintrange,he=oe&&oe.length;he&&!Array.isArray(oe[0])&&(oe=[oe]);var be=he?oe.map(function(Be){return Be.map(ie)}):[[-1/0,1/0]],me=function(){var Be=J;Be.focusLayer&&Be.focusLayer.render(Be.panels,!0);var Re=k(Be);!Z.contextShown()&&Re?(Be.contextLayer&&Be.contextLayer.render(Be.panels,!0),Z.contextShown(!0)):Z.contextShown()&&!Re&&(Be.contextLayer&&Be.contextLayer.render(Be.panels,!0,!0),Z.contextShown(!1))},_e=ae.values;_e.length>ae._length&&(_e=_e.slice(0,ae._length));var Se=ae.tickvals,De;function Ie(Be,Re){return{val:Be,text:De[Re]}}function Te(Be,Re){return Be.val-Re.val}if(Array.isArray(Se)&&Se.length){De=ae.ticktext,!Array.isArray(De)||!De.length?De=Se.map(A(ae.tickformat)):De.length>Se.length?De=De.slice(0,Se.length):Se.length>De.length&&(Se=Se.slice(0,De.length));for(var Ce=1;Ce<Se.length;Ce++)if(Se[Ce]<Se[Ce-1]){for(var He=Se.map(Ie).sort(Te),Xe=0;Xe<Se.length;Xe++)Se[Xe]=He[Xe].val,De[Xe]=He[Xe].text;break}}else Se=void 0;return _e=p.convertTypedArray(_e),{key:xe,label:ae.label,tickFormat:ae.tickformat,tickvals:Se,ticktext:De,ordinal:p.isOrdinal(ae),multiselect:ae.multiselect,xIndex:le,crossfilterDimensionIndex:le,visibleIndex:ae._index,height:K,values:_e,paddedUnitValues:_e.map(ie),unitTickvals:Se&&Se.map(ie),xScale:Y,x:Y(le),canvasX:Y(le)*G,unitToPaddedPx:ne,domainScale:w(K,v.verticalPadding,ae,Se,De),ordinalScale:S(ae),parent:J,model:re,brush:x.makeBrush(Z,he,be,function(){Z.linePickActive(!1)},me,function(Be){if(J.focusLayer.render(J.panels,!0),J.pickLayer&&J.pickLayer.render(J.panels,!0),Z.linePickActive(!0),X&&X.filterChanged){var Re=ie.invert,We=Be.map(function(vt){return vt.map(Re).sort(u.sorterAsc)}).sort(function(vt,Pt){return vt[0]-Pt[0]});X.filterChanged(J.key,ae._index,We)}})}}),J}function F(Z){Z.classed(v.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function I(){var Z=!0,X=!1;return{linePickActive:function(re){return arguments.length?Z=!!re:Z},contextShown:function(re){return arguments.length?X=!!re:X}}}function O(Z,X){var re=X==="top"?1:-1,ue=Z*Math.PI/180,K=Math.sin(ue),te=Math.cos(ue);return{dir:re,dx:K,dy:te,degrees:Z}}function N(Z,X,re){for(var ue=X.panels||(X.panels=[]),K=Z.data(),te=0;te<K.length-1;te++){var G=ue[te]||(ue[te]={}),Y=K[te],ee=K[te+1];G.dim0=Y,G.dim1=ee,G.canvasX=Y.canvasX,G.panelSizeX=ee.canvasX-Y.canvasX,G.panelSizeY=X.model.canvasHeight,G.y=0,G.canvasY=0,G.plotGlPixelRatio=re}}function V(Z){for(var X=0;X<Z.length;X++)for(var re=0;re<Z[X].length;re++)for(var ue=Z[X][re].trace,K=ue.dimensions,te=0;te<K.length;te++){var G=K[te].values,Y=K[te]._ax;Y&&(Y.range?Y.range=_(Y.range[0],Y.range[1]):Y.range=c(G,ue._length),Y.dtick||(Y.dtick=.01*(Math.abs(Y.range[1]-Y.range[0])||1)),Y.tickformat=K[te].tickformat,e.calcTicks(Y),Y.cleanRange())}}function H(Z,X){return e.tickText(Z._ax,X,!1).text}function j(Z,X){if(Z.ordinal)return"";var re=Z.domainScale.domain(),ue=re[X?re.length-1:0];return H(Z.model.dimensions[Z.visibleIndex],ue)}P.exports=function(X,re,ue,K){var te=X._context.staticPlot,G=X._fullLayout,Y=G._toppaper,ee=G._glcontainer,ne=X._context.plotGlPixelRatio,J=X._fullLayout.paper_bgcolor;V(re);var q=I(),ae=re.filter(function(Xe){return g(Xe).trace.visible}).map(B.bind(0,ue)).map(z.bind(0,q,K));ee.each(function(Xe,Be){return u.extendFlat(Xe,ae[Be])});var le=ee.selectAll(".gl-canvas").each(function(Xe){Xe.viewModel=ae[0],Xe.viewModel.plotGlPixelRatio=ne,Xe.viewModel.paperColor=J,Xe.model=Xe.viewModel?Xe.viewModel.model:null}),ie=null,se=le.filter(function(Xe){return Xe.pick});se.style("pointer-events",te?"none":"auto").on("mousemove",function(Xe){if(q.linePickActive()&&Xe.lineLayer&&K&&K.hover){var Be=h.event,Re=this.width,We=this.height,vt=h.mouse(this),Pt=vt[0],Zt=vt[1];if(Pt<0||Zt<0||Pt>=Re||Zt>=We)return;var zt=Xe.lineLayer.readPixel(Pt,We-1-Zt),At=zt[3]!==0,Wt=At?zt[2]+256*(zt[1]+256*zt[0]):null,Bt={x:Pt,y:Zt,clientX:Be.clientX,clientY:Be.clientY,dataIndex:Xe.model.key,curveNumber:Wt};Wt!==ie&&(At?K.hover(Bt):K.unhover&&K.unhover(Bt),ie=Wt)}}),le.style("opacity",function(Xe){return Xe.pick?0:1}),Y.style("background","rgba(255, 255, 255, 0)");var xe=Y.selectAll("."+v.cn.parcoords).data(ae,s);xe.exit().remove(),xe.enter().append("g").classed(v.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),xe.attr("transform",function(Xe){return n(Xe.model.translateX,Xe.model.translateY)});var oe=xe.selectAll("."+v.cn.parcoordsControlView).data(m,s);oe.enter().append("g").classed(v.cn.parcoordsControlView,!0),oe.attr("transform",function(Xe){return n(Xe.model.pad.l,Xe.model.pad.t)});var he=oe.selectAll("."+v.cn.yAxis).data(function(Xe){return Xe.dimensions},s);he.enter().append("g").classed(v.cn.yAxis,!0),oe.each(function(Xe){N(he,Xe,ne)}),le.each(function(Xe){if(Xe.viewModel){!Xe.lineLayer||K?Xe.lineLayer=l(this,Xe):Xe.lineLayer.update(Xe),(Xe.key||Xe.key===0)&&(Xe.viewModel[Xe.key]=Xe.lineLayer);var Be=!Xe.context||K;Xe.lineLayer.render(Xe.viewModel.panels,Be)}}),he.attr("transform",function(Xe){return n(Xe.xScale(Xe.xIndex),0)}),he.call(h.behavior.drag().origin(function(Xe){return Xe}).on("drag",function(Xe){var Be=Xe.parent;q.linePickActive(!1),Xe.x=Math.max(-v.overdrag,Math.min(Xe.model.width+v.overdrag,h.event.x)),Xe.canvasX=Xe.x*Xe.model.canvasPixelRatio,he.sort(function(Re,We){return Re.x-We.x}).each(function(Re,We){Re.xIndex=We,Re.x=Xe===Re?Re.x:Re.xScale(Re.xIndex),Re.canvasX=Re.x*Re.model.canvasPixelRatio}),N(he,Be,ne),he.filter(function(Re){return Math.abs(Xe.xIndex-Re.xIndex)!==0}).attr("transform",function(Re){return n(Re.xScale(Re.xIndex),0)}),h.select(this).attr("transform",n(Xe.x,0)),he.each(function(Re,We,vt){vt===Xe.parent.key&&(Be.dimensions[We]=Re)}),Be.contextLayer&&Be.contextLayer.render(Be.panels,!1,!k(Be)),Be.focusLayer.render&&Be.focusLayer.render(Be.panels)}).on("dragend",function(Xe){var Be=Xe.parent;Xe.x=Xe.xScale(Xe.xIndex),Xe.canvasX=Xe.x*Xe.model.canvasPixelRatio,N(he,Be,ne),h.select(this).attr("transform",function(Re){return n(Re.x,0)}),Be.contextLayer&&Be.contextLayer.render(Be.panels,!1,!k(Be)),Be.focusLayer&&Be.focusLayer.render(Be.panels),Be.pickLayer&&Be.pickLayer.render(Be.panels,!0),q.linePickActive(!0),K&&K.axesMoved&&K.axesMoved(Be.key,Be.dimensions.map(function(Re){return Re.crossfilterDimensionIndex}))})),he.exit().remove();var be=he.selectAll("."+v.cn.axisOverlays).data(m,s);be.enter().append("g").classed(v.cn.axisOverlays,!0),be.selectAll("."+v.cn.axis).remove();var me=be.selectAll("."+v.cn.axis).data(m,s);me.enter().append("g").classed(v.cn.axis,!0),me.each(function(Xe){var Be=Xe.model.height/Xe.model.tickDistance,Re=Xe.domainScale,We=Re.domain();h.select(this).call(h.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Be,Xe.tickFormat).tickValues(Xe.ordinal?We:null).tickFormat(function(vt){return p.isOrdinal(Xe)?vt:H(Xe.model.dimensions[Xe.visibleIndex],vt)}).scale(Re)),r.font(me.selectAll("text"),Xe.model.tickFont)}),me.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),me.selectAll("text").style("text-shadow",a.makeTextShadow(J)).style("cursor","default");var _e=be.selectAll("."+v.cn.axisHeading).data(m,s);_e.enter().append("g").classed(v.cn.axisHeading,!0);var Se=_e.selectAll("."+v.cn.axisTitle).data(m,s);Se.enter().append("text").classed(v.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events",te?"none":"auto"),Se.text(function(Xe){return Xe.label}).each(function(Xe){var Be=h.select(this);r.font(Be,Xe.model.labelFont),a.convertToTspans(Be,X)}).attr("transform",function(Xe){var Be=O(Xe.model.labelAngle,Xe.model.labelSide),Re=v.axisTitleOffset;return(Be.dir>0?"":n(0,2*Re+Xe.model.height))+i(Be.degrees)+n(-Re*Be.dx,-Re*Be.dy)}).attr("text-anchor",function(Xe){var Be=O(Xe.model.labelAngle,Xe.model.labelSide),Re=Math.abs(Be.dx),We=Math.abs(Be.dy);return 2*Re>We?Be.dir*Be.dx<0?"start":"end":"middle"});var De=be.selectAll("."+v.cn.axisExtent).data(m,s);De.enter().append("g").classed(v.cn.axisExtent,!0);var Ie=De.selectAll("."+v.cn.axisExtentTop).data(m,s);Ie.enter().append("g").classed(v.cn.axisExtentTop,!0),Ie.attr("transform",n(0,-v.axisExtentOffset));var Te=Ie.selectAll("."+v.cn.axisExtentTopText).data(m,s);Te.enter().append("text").classed(v.cn.axisExtentTopText,!0).call(F),Te.text(function(Xe){return j(Xe,!0)}).each(function(Xe){r.font(h.select(this),Xe.model.rangeFont)});var Ce=De.selectAll("."+v.cn.axisExtentBottom).data(m,s);Ce.enter().append("g").classed(v.cn.axisExtentBottom,!0),Ce.attr("transform",function(Xe){return n(0,Xe.model.height+v.axisExtentOffset)});var He=Ce.selectAll("."+v.cn.axisExtentBottomText).data(m,s);He.enter().append("text").classed(v.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(F),He.text(function(Xe){return j(Xe,!1)}).each(function(Xe){r.font(h.select(this),Xe.model.rangeFont)}),x.ensureAxisBrush(be,J,X)}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"./axisbrush":898,"./constants":902,"./helpers":904,"./lines":906,"@plotly/d3":58,"color-rgba":91}],909:[function(t,P,n){var h=t("./parcoords"),u=t("../../lib/prepare_regl"),A=t("./helpers").isVisible,T={};function e(a,r,f){var o=r.indexOf(f),s=a.indexOf(o);return s===-1&&(s+=r.length),s}function i(a,r){return function(o,s){return e(a,r,o)-e(a,r,s)}}var n=P.exports=function(r,f){var o=r._fullLayout,s=u(r,[],T);if(!!s){var m={},g={},p={},v={},x=o._size;f.forEach(function(_,y){var w=_[0].trace;p[y]=w.index;var d=v[y]=w._fullInput.index;m[y]=r.data[d].dimensions,g[y]=r.data[d].dimensions.slice()});var l=function(_,y,w){var d=g[_][y],C=w.map(function(F){return F.slice()}),S="dimensions["+y+"].constraintrange",E=o._tracePreGUI[r._fullData[p[_]]._fullInput.uid];if(E[S]===void 0){var k=d.constraintrange;E[S]=k||null}var B=r._fullData[p[_]].dimensions[y];C.length?(C.length===1&&(C=C[0]),d.constraintrange=C,B.constraintrange=C.slice(),C=[C]):(delete d.constraintrange,delete B.constraintrange,C=null);var z={};z[S]=C,r.emit("plotly_restyle",[z,[v[_]]])},b=function(_){r.emit("plotly_hover",_)},c=function(_){r.emit("plotly_unhover",_)},M=function(_,y){var w=i(y,g[_].filter(A));m[_].sort(w),g[_].filter(function(d){return!A(d)}).sort(function(d){return g[_].indexOf(d)}).forEach(function(d){m[_].splice(m[_].indexOf(d),1),m[_].splice(g[_].indexOf(d),0,d)}),r.emit("plotly_restyle",[{dimensions:[m[_]]},[v[_]]])};h(r,f,{width:x.w,height:x.h,margin:{t:x.t,r:x.r,b:x.b,l:x.l}},{filterChanged:l,hover:b,unhover:c,axesMoved:M})}};n.reglPrecompiled=T},{"../../lib/prepare_regl":528,"./helpers":904,"./parcoords":908}],910:[function(t,P,R){var h=t("../../plots/attributes"),u=t("../../plots/domain").attributes,A=t("../../plots/font_attributes"),T=t("../../components/color/attributes"),e=t("../../plots/template_attributes").hovertemplateAttrs,i=t("../../plots/template_attributes").texttemplateAttrs,n=t("../../lib/extend").extendFlat,a=A({editType:"plot",arrayOk:!0,colorEditType:"plot"});P.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:T.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:n({},h.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:i({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:n({},a,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:n({},a,{}),outsidetextfont:n({},a,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:n({},a,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:u({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:n({},a,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],911:[function(t,P,R){var h=t("../../plots/plots");R.name="pie",R.plot=function(u,A,T,e){h.plotBasePlot(R.name,u,A,T,e)},R.clean=function(u,A,T,e){h.cleanBasePlot(R.name,u,A,T,e)}},{"../../plots/plots":628}],912:[function(t,P,R){var h=t("fast-isnumeric"),u=t("tinycolor2"),A=t("../../components/color"),T={};function e(r,f){var o=[],s=r._fullLayout,m=s.hiddenlabels||[],g=f.labels,p=f.marker.colors||[],v=f.values,x=f._length,l=f._hasValues&&x,b,c;if(f.dlabel)for(g=new Array(x),b=0;b<x;b++)g[b]=String(f.label0+b*f.dlabel);var M={},_=i(s["_"+f.type+"colormap"]),y=0,w=!1;for(b=0;b<x;b++){var d,C,S;if(l){if(d=v[b],!h(d))continue;d=+d}else d=1;C=g[b],(C===void 0||C==="")&&(C=b),C=String(C);var E=M[C];E===void 0?(M[C]=o.length,S=m.indexOf(C)!==-1,S||(y+=d),o.push({v:d,label:C,color:_(p[b],C),i:b,pts:[b],hidden:S})):(w=!0,c=o[E],c.v+=d,c.pts.push(b),c.hidden||(y+=d),c.color===!1&&p[b]&&(c.color=_(p[b],C)))}o=o.filter(function(B){return B.v>=0});var k=f.type==="funnelarea"?w:f.sort;return k&&o.sort(function(B,z){return z.v-B.v}),o[0]&&(o[0].vTotal=y),o}function i(r){return function(o,s){return!o||(o=u(o),!o.isValid())?!1:(o=A.addOpacity(o,o.getAlpha()),r[s]||(r[s]=o),o)}}function n(r,f){var o=(f||{}).type;o||(o="pie");var s=r._fullLayout,m=r.calcdata,g=s[o+"colorway"],p=s["_"+o+"colormap"];s["extend"+o+"colors"]&&(g=a(g,T));for(var v=0,x=0;x<m.length;x++){var l=m[x],b=l[0].trace.type;if(b===o)for(var c=0;c<l.length;c++){var M=l[c];M.color===!1&&(p[M.label]?M.color=p[M.label]:(p[M.label]=M.color=g[v%g.length],v++))}}}function a(r,f){var o,s=JSON.stringify(r),m=f[s];if(!m){for(m=r.slice(),o=0;o<r.length;o++)m.push(u(r[o]).lighten(20).toHexString());for(o=0;o<r.length;o++)m.push(u(r[o]).darken(20).toHexString());f[s]=m}return m}P.exports={calc:e,crossTraceCalc:n,makePullColorFn:i,generateExtendedColors:a}},{"../../components/color":367,"fast-isnumeric":190,tinycolor2:313}],913:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib"),A=t("./attributes"),T=t("../../plots/domain").defaults,e=t("../bar/defaults").handleText;function i(a,r){var f=Array.isArray(a),o=u.isArrayOrTypedArray(r),s=Math.min(f?a.length:1/0,o?r.length:1/0);if(isFinite(s)||(s=0),s&&o){for(var m,g=0;g<s;g++){var p=r[g];if(h(p)&&p>0){m=!0;break}}m||(s=0)}return{hasLabels:f,hasValues:o,len:s}}function n(a,r,f,o){function s(S,E){return u.coerce(a,r,A,S,E)}var m=s("labels"),g=s("values"),p=i(m,g),v=p.len;if(r._hasLabels=p.hasLabels,r._hasValues=p.hasValues,!r._hasLabels&&r._hasValues&&(s("label0"),s("dlabel")),!v){r.visible=!1;return}r._length=v;var x=s("marker.line.width");x&&s("marker.line.color"),s("marker.colors"),s("scalegroup");var l=s("text"),b=s("texttemplate"),c;if(b||(c=s("textinfo",Array.isArray(l)?"text+percent":"percent")),s("hovertext"),s("hovertemplate"),b||c&&c!=="none"){var M=s("textposition");e(a,r,o,s,M,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1});var _=Array.isArray(M)||M==="auto",y=_||M==="outside";y&&s("automargin"),(M==="inside"||M==="auto"||Array.isArray(M))&&s("insidetextorientation")}T(r,o,s);var w=s("hole"),d=s("title.text");if(d){var C=s("title.position",w?"middle center":"top center");!w&&C==="middle center"&&(r.title.position="top center"),u.coerceFont(s,"title.font",o.font)}s("sort"),s("direction"),s("rotation"),s("pull")}P.exports={handleLabelsAndValues:i,supplyDefaults:n}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":910,"fast-isnumeric":190}],914:[function(t,P,R){var h=t("../../components/fx/helpers").appendArrayMultiPointValues;P.exports=function(A,T){var e={curveNumber:T.index,pointNumbers:A.pts,data:T._input,fullData:T,label:A.label,color:A.color,value:A.v,percent:A.percent,text:A.text,bbox:A.bbox,v:A.v};return A.pts.length===1&&(e.pointNumber=e.i=A.pts[0]),h(e,T,A.pts),T.type==="funnelarea"&&(delete e.v,delete e.i),e}},{"../../components/fx/helpers":403}],915:[function(t,P,R){var h=t("../../lib");function u(A){return A.indexOf("e")!==-1?A.replace(/[.]?0+e/,"e"):A.indexOf(".")!==-1?A.replace(/[.]?0+$/,""):A}R.formatPiePercent=function(T,e){var i=u((T*100).toPrecision(3));return h.numSeparate(i,e)+"%"},R.formatPieValue=function(T,e){var i=u(T.toPrecision(10));return h.numSeparate(i,e)},R.getFirstFilled=function(T,e){if(!!Array.isArray(T))for(var i=0;i<e.length;i++){var n=T[e[i]];if(n||n===0||n==="")return n}},R.castOption=function(T,e){if(Array.isArray(T))return R.getFirstFilled(T,e);if(T)return T},R.getRotationAngle=function(A){return(A==="auto"?0:A)*Math.PI/180}},{"../../lib":515}],916:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults").supplyDefaults,supplyLayoutDefaults:t("./layout_defaults"),layoutAttributes:t("./layout_attributes"),calc:t("./calc").calc,crossTraceCalc:t("./calc").crossTraceCalc,plot:t("./plot").plot,style:t("./style"),styleOne:t("./style_one"),moduleType:"trace",name:"pie",basePlotModule:t("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":910,"./base_plot":911,"./calc":912,"./defaults":913,"./layout_attributes":917,"./layout_defaults":918,"./plot":919,"./style":920,"./style_one":921}],917:[function(t,P,R){P.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],918:[function(t,P,R){var h=t("../../lib"),u=t("./layout_attributes");P.exports=function(T,e){function i(n,a){return h.coerce(T,e,u,n,a)}i("hiddenlabels"),i("piecolorway",e.colorway),i("extendpiecolors")}},{"../../lib":515,"./layout_attributes":917}],919:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../plots/plots"),A=t("../../components/fx"),T=t("../../components/color"),e=t("../../components/drawing"),i=t("../../lib"),n=i.strScale,a=i.strTranslate,r=t("../../lib/svg_text_utils"),f=t("../bar/uniform_text"),o=f.recordMinTextSize,s=f.clearMinTextSize,m=t("../bar/constants").TEXTPAD,g=t("./helpers"),p=t("./event_data"),v=t("../../lib").isValidTextValue;function x(te,G){var Y=te._context.staticPlot,ee=te._fullLayout,ne=ee._size;s("pie",ee),_(G,te),j(G,ne);var J=i.makeTraceGroups(ee._pielayer,G,"trace").each(function(q){var ae=h.select(this),le=q[0],ie=le.trace;X(q),ae.attr("stroke-linejoin","round"),ae.each(function(){var se=h.select(this).selectAll("g.slice").data(q);se.enter().append("g").classed("slice",!0),se.exit().remove();var xe=[[[],[]],[[],[]]],oe=!1;se.each(function(Te,Ce){if(Te.hidden){h.select(this).selectAll("path,g").remove();return}Te.pointNumber=Te.i,Te.curveNumber=ie.index,xe[Te.pxmid[1]<0?0:1][Te.pxmid[0]<0?0:1].push(Te);var He=le.cx,Xe=le.cy,Be=h.select(this),Re=Be.selectAll("path.surface").data([Te]);if(Re.enter().append("path").classed("surface",!0).style({"pointer-events":Y?"none":"all"}),Be.call(b,te,q),ie.pull){var We=+g.castOption(ie.pull,Te.pts)||0;We>0&&(He+=We*Te.pxmid[0],Xe+=We*Te.pxmid[1])}Te.cxFinal=He,Te.cyFinal=Xe;function vt(Ct,Ze,nt,Ye){var Ee=Ye*(Ze[0]-Ct[0]),Ge=Ye*(Ze[1]-Ct[1]);return"a"+Ye*le.r+","+Ye*le.r+" 0 "+Te.largeArc+(nt?" 1 ":" 0 ")+Ee+","+Ge}var Pt=ie.hole;if(Te.v===le.vTotal){var Zt="M"+(He+Te.px0[0])+","+(Xe+Te.px0[1])+vt(Te.px0,Te.pxmid,!0,1)+vt(Te.pxmid,Te.px0,!0,1)+"Z";Pt?Re.attr("d","M"+(He+Pt*Te.px0[0])+","+(Xe+Pt*Te.px0[1])+vt(Te.px0,Te.pxmid,!1,Pt)+vt(Te.pxmid,Te.px0,!1,Pt)+"Z"+Zt):Re.attr("d",Zt)}else{var zt=vt(Te.px0,Te.px1,!0,1);if(Pt){var At=1-Pt;Re.attr("d","M"+(He+Pt*Te.px1[0])+","+(Xe+Pt*Te.px1[1])+vt(Te.px1,Te.px0,!1,Pt)+"l"+At*Te.px0[0]+","+At*Te.px0[1]+zt+"Z")}else Re.attr("d","M"+He+","+Xe+"l"+Te.px0[0]+","+Te.px0[1]+zt+"Z")}ue(te,Te,le);var Wt=g.castOption(ie.textposition,Te.pts),Bt=Be.selectAll("g.slicetext").data(Te.text&&Wt!=="none"?[0]:[]);Bt.enter().append("g").classed("slicetext",!0),Bt.exit().remove(),Bt.each(function(){var Ct=i.ensureSingle(h.select(this),"text","",function(Tt){Tt.attr("data-notex",1)}),Ze=i.ensureUniformFontSize(te,Wt==="outside"?c(ie,Te,ee.font):M(ie,Te,ee.font));Ct.text(Te.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,Ze).call(r.convertToTspans,te);var nt=e.bBox(Ct.node()),Ye;if(Wt==="outside")Ye=z(nt,Te);else if(Ye=y(nt,Te,le),Wt==="auto"&&Ye.scale<1){var Ee=i.ensureUniformFontSize(te,ie.outsidetextfont);Ct.call(e.font,Ee),nt=e.bBox(Ct.node()),Ye=z(nt,Te)}var Ge=Ye.textPosAngle,Je=Ge===void 0?Te.pxmid:re(le.r,Ge);if(Ye.targetX=He+Je[0]*Ye.rCenter+(Ye.x||0),Ye.targetY=Xe+Je[1]*Ye.rCenter+(Ye.y||0),K(Ye,nt),Ye.outside){var qe=Ye.targetY;Te.yLabelMin=qe-nt.height/2,Te.yLabelMid=qe,Te.yLabelMax=qe+nt.height/2,Te.labelExtraX=0,Te.labelExtraY=0,oe=!0}Ye.fontSize=Ze.size,o(ie.type,Ye,ee),q[Ce].transform=Ye,i.setTransormAndDisplay(Ct,Ye)})});var he=h.select(this).selectAll("g.titletext").data(ie.title.text?[0]:[]);if(he.enter().append("g").classed("titletext",!0),he.exit().remove(),he.each(function(){var Te=i.ensureSingle(h.select(this),"text","",function(Xe){Xe.attr("data-notex",1)}),Ce=ie.title.text;ie._meta&&(Ce=i.templateString(Ce,ie._meta)),Te.text(Ce).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,ie.title.font).call(r.convertToTspans,te);var He;ie.title.position==="middle center"?He=F(le):He=I(le,ne),Te.attr("transform",a(He.x,He.y)+n(Math.min(1,He.scale))+a(He.tx,He.ty))}),oe&&H(xe,ie),l(se,ie),oe&&ie.automargin){var be=e.bBox(ae.node()),me=ie.domain,_e=ne.w*(me.x[1]-me.x[0]),Se=ne.h*(me.y[1]-me.y[0]),De=(.5*_e-le.r)/ne.w,Ie=(.5*Se-le.r)/ne.h;u.autoMargin(te,"pie."+ie.uid+".automargin",{xl:me.x[0]-De,xr:me.x[1]+De,yb:me.y[0]-Ie,yt:me.y[1]+Ie,l:Math.max(le.cx-le.r-be.left,0),r:Math.max(be.right-(le.cx+le.r),0),b:Math.max(be.bottom-(le.cy+le.r),0),t:Math.max(le.cy-le.r-be.top,0),pad:5})}})});setTimeout(function(){J.selectAll("tspan").each(function(){var q=h.select(this);q.attr("dy")&&q.attr("dy",q.attr("dy"))})},0)}function l(te,G){te.each(function(Y){var ee=h.select(this);if(!Y.labelExtraX&&!Y.labelExtraY){ee.select("path.textline").remove();return}var ne=ee.select("g.slicetext text");Y.transform.targetX+=Y.labelExtraX,Y.transform.targetY+=Y.labelExtraY,i.setTransormAndDisplay(ne,Y.transform);var J=Y.cxFinal+Y.pxmid[0],q=Y.cyFinal+Y.pxmid[1],ae="M"+J+","+q,le=(Y.yLabelMax-Y.yLabelMin)*(Y.pxmid[0]<0?-1:1)/4;if(Y.labelExtraX){var ie=Y.labelExtraX*Y.pxmid[1]/Y.pxmid[0],se=Y.yLabelMid+Y.labelExtraY-(Y.cyFinal+Y.pxmid[1]);Math.abs(ie)>Math.abs(se)?ae+="l"+se*Y.pxmid[0]/Y.pxmid[1]+","+se+"H"+(J+Y.labelExtraX+le):ae+="l"+Y.labelExtraX+","+ie+"v"+(se-ie)+"h"+le}else ae+="V"+(Y.yLabelMid+Y.labelExtraY)+"h"+le;i.ensureSingle(ee,"path","textline").call(T.stroke,G.outsidetextfont.color).attr({"stroke-width":Math.min(2,G.outsidetextfont.size/8),d:ae,fill:"none"})})}function b(te,G,Y){var ee=Y[0],ne=ee.cx,J=ee.cy,q=ee.trace,ae=q.type==="funnelarea";"_hasHoverLabel"in q||(q._hasHoverLabel=!1),"_hasHoverEvent"in q||(q._hasHoverEvent=!1),te.on("mouseover",function(le){var ie=G._fullLayout,se=G._fullData[q.index];if(!(G._dragging||ie.hovermode===!1)){var xe=se.hoverinfo;if(Array.isArray(xe)&&(xe=A.castHoverinfo({hoverinfo:[g.castOption(xe,le.pts)],_module:q._module},ie,0)),xe==="all"&&(xe="label+text+value+percent+name"),se.hovertemplate||xe!=="none"&&xe!=="skip"&&xe){var oe=le.rInscribed||0,he=ne+le.pxmid[0]*(1-oe),be=J+le.pxmid[1]*(1-oe),me=ie.separators,_e=[];if(xe&&xe.indexOf("label")!==-1&&_e.push(le.label),le.text=g.castOption(se.hovertext||se.text,le.pts),xe&&xe.indexOf("text")!==-1){var Se=le.text;i.isValidTextValue(Se)&&_e.push(Se)}le.value=le.v,le.valueLabel=g.formatPieValue(le.v,me),xe&&xe.indexOf("value")!==-1&&_e.push(le.valueLabel),le.percent=le.v/ee.vTotal,le.percentLabel=g.formatPiePercent(le.percent,me),xe&&xe.indexOf("percent")!==-1&&_e.push(le.percentLabel);var De=se.hoverlabel,Ie=De.font,Te=[];A.loneHover({trace:q,x0:he-oe*ee.r,x1:he+oe*ee.r,y:be,_x0:ae?ne+le.TL[0]:he-oe*ee.r,_x1:ae?ne+le.TR[0]:he+oe*ee.r,_y0:ae?J+le.TL[1]:be-oe*ee.r,_y1:ae?J+le.BL[1]:be+oe*ee.r,text:_e.join("<br>"),name:se.hovertemplate||xe.indexOf("name")!==-1?se.name:void 0,idealAlign:le.pxmid[0]<0?"left":"right",color:g.castOption(De.bgcolor,le.pts)||le.color,borderColor:g.castOption(De.bordercolor,le.pts),fontFamily:g.castOption(Ie.family,le.pts),fontSize:g.castOption(Ie.size,le.pts),fontColor:g.castOption(Ie.color,le.pts),nameLength:g.castOption(De.namelength,le.pts),textAlign:g.castOption(De.align,le.pts),hovertemplate:g.castOption(se.hovertemplate,le.pts),hovertemplateLabels:le,eventData:[p(le,se)]},{container:ie._hoverlayer.node(),outerContainer:ie._paper.node(),gd:G,inOut_bbox:Te}),le.bbox=Te[0],q._hasHoverLabel=!0}q._hasHoverEvent=!0,G.emit("plotly_hover",{points:[p(le,se)],event:h.event})}}),te.on("mouseout",function(le){var ie=G._fullLayout,se=G._fullData[q.index],xe=h.select(this).datum();q._hasHoverEvent&&(le.originalEvent=h.event,G.emit("plotly_unhover",{points:[p(xe,se)],event:h.event}),q._hasHoverEvent=!1),q._hasHoverLabel&&(A.loneUnhover(ie._hoverlayer.node()),q._hasHoverLabel=!1)}),te.on("click",function(le){var ie=G._fullLayout,se=G._fullData[q.index];G._dragging||ie.hovermode===!1||(G._hoverdata=[p(le,se)],A.click(G,h.event))})}function c(te,G,Y){var ee=g.castOption(te.outsidetextfont.color,G.pts)||g.castOption(te.textfont.color,G.pts)||Y.color,ne=g.castOption(te.outsidetextfont.family,G.pts)||g.castOption(te.textfont.family,G.pts)||Y.family,J=g.castOption(te.outsidetextfont.size,G.pts)||g.castOption(te.textfont.size,G.pts)||Y.size;return{color:ee,family:ne,size:J}}function M(te,G,Y){var ee=g.castOption(te.insidetextfont.color,G.pts);!ee&&te._input.textfont&&(ee=g.castOption(te._input.textfont.color,G.pts));var ne=g.castOption(te.insidetextfont.family,G.pts)||g.castOption(te.textfont.family,G.pts)||Y.family,J=g.castOption(te.insidetextfont.size,G.pts)||g.castOption(te.textfont.size,G.pts)||Y.size;return{color:ee||T.contrast(G.color),family:ne,size:J}}function _(te,G){for(var Y,ee,ne=0;ne<te.length;ne++)if(Y=te[ne][0],ee=Y.trace,ee.title.text){var J=ee.title.text;ee._meta&&(J=i.templateString(J,ee._meta));var q=e.tester.append("text").attr("data-notex",1).text(J).call(e.font,ee.title.font).call(r.convertToTspans,G),ae=e.bBox(q.node(),!0);Y.titleBox={width:ae.width,height:ae.height},q.remove()}}function y(te,G,Y){var ee=Y.r||G.rpx1,ne=G.rInscribed,J=G.startangle===G.stopangle;if(J)return{rCenter:1-ne,scale:0,rotate:0,textPosAngle:0};var q=G.ring,ae=q===1&&Math.abs(G.startangle-G.stopangle)===Math.PI*2,le=G.halfangle,ie=G.midangle,se=Y.trace.insidetextorientation,xe=se==="horizontal",oe=se==="tangential",he=se==="radial",be=se==="auto",me=[],_e;if(!be){var Se=function(Be,Re){if(w(G,Be)){var We=Math.abs(Be-G.startangle),vt=Math.abs(Be-G.stopangle),Pt=We<vt?We:vt;Re==="tan"?_e=C(te,ee,q,Pt,0):_e=d(te,ee,q,Pt,Math.PI/2),_e.textPosAngle=Be,me.push(_e)}},De;if(xe||oe){for(De=4;De>=-4;De-=2)Se(Math.PI*De,"tan");for(De=4;De>=-4;De-=2)Se(Math.PI*(De+1),"tan")}if(xe||he){for(De=4;De>=-4;De-=2)Se(Math.PI*(De+1.5),"rad");for(De=4;De>=-4;De-=2)Se(Math.PI*(De+.5),"rad")}}if(ae||be||xe){var Ie=Math.sqrt(te.width*te.width+te.height*te.height);if(_e={scale:ne*ee*2/Ie,rCenter:1-ne,rotate:0},_e.textPosAngle=(G.startangle+G.stopangle)/2,_e.scale>=1)return _e;me.push(_e)}(be||he)&&(_e=d(te,ee,q,le,ie),_e.textPosAngle=(G.startangle+G.stopangle)/2,me.push(_e)),(be||oe)&&(_e=C(te,ee,q,le,ie),_e.textPosAngle=(G.startangle+G.stopangle)/2,me.push(_e));for(var Te=0,Ce=0,He=0;He<me.length;He++){var Xe=me[He].scale;if(Ce<Xe&&(Ce=Xe,Te=He),!be&&Ce>=1)break}return me[Te]}function w(te,G){var Y=te.startangle,ee=te.stopangle;return Y>G&&G>ee||Y<G&&G<ee}function d(te,G,Y,ee,ne){G=Math.max(0,G-2*m);var J=te.width/te.height,q=k(J,ee,G,Y);return{scale:q*2/te.height,rCenter:S(J,q/G),rotate:E(ne)}}function C(te,G,Y,ee,ne){G=Math.max(0,G-2*m);var J=te.height/te.width,q=k(J,ee,G,Y);return{scale:q*2/te.width,rCenter:S(J,q/G),rotate:E(ne+Math.PI/2)}}function S(te,G){return Math.cos(G)-te*G}function E(te){return(180/Math.PI*te+720)%180-90}function k(te,G,Y,ee){var ne=te+1/(2*Math.tan(G));return Y*Math.min(1/(Math.sqrt(ne*ne+.5)+ne),ee/(Math.sqrt(te*te+ee/2)+te))}function B(te,G){return te.v===G.vTotal&&!G.trace.hole?1:Math.min(1/(1+1/Math.sin(te.halfangle)),te.ring/2)}function z(te,G){var Y=G.pxmid[0],ee=G.pxmid[1],ne=te.width/2,J=te.height/2;return Y<0&&(ne*=-1),ee<0&&(J*=-1),{scale:1,rCenter:1,rotate:0,x:ne+Math.abs(J)*(ne>0?1:-1)/2,y:J/(1+Y*Y/(ee*ee)),outside:!0}}function F(te){var G=Math.sqrt(te.titleBox.width*te.titleBox.width+te.titleBox.height*te.titleBox.height);return{x:te.cx,y:te.cy,scale:te.trace.hole*te.r*2/G,tx:0,ty:-te.titleBox.height/2+te.trace.title.font.size}}function I(te,G){var Y=1,ee=1,ne,J=te.trace,q={x:te.cx,y:te.cy},ae={tx:0,ty:0};ae.ty+=J.title.font.size,ne=V(J),J.title.position.indexOf("top")!==-1?(q.y-=(1+ne)*te.r,ae.ty-=te.titleBox.height):J.title.position.indexOf("bottom")!==-1&&(q.y+=(1+ne)*te.r);var le=O(te.r,te.trace.aspectratio),ie=G.w*(J.domain.x[1]-J.domain.x[0])/2;return J.title.position.indexOf("left")!==-1?(ie=ie+le,q.x-=(1+ne)*le,ae.tx+=te.titleBox.width/2):J.title.position.indexOf("center")!==-1?ie*=2:J.title.position.indexOf("right")!==-1&&(ie=ie+le,q.x+=(1+ne)*le,ae.tx-=te.titleBox.width/2),Y=ie/te.titleBox.width,ee=N(te,G)/te.titleBox.height,{x:q.x,y:q.y,scale:Math.min(Y,ee),tx:ae.tx,ty:ae.ty}}function O(te,G){return te/(G===void 0?1:G)}function N(te,G){var Y=te.trace,ee=G.h*(Y.domain.y[1]-Y.domain.y[0]);return Math.min(te.titleBox.height,ee/2)}function V(te){var G=te.pull;if(!G)return 0;var Y;if(Array.isArray(G))for(G=0,Y=0;Y<te.pull.length;Y++)te.pull[Y]>G&&(G=te.pull[Y]);return G}function H(te,G){var Y,ee,ne,J,q,ae,le,ie,se,xe,oe,he,be;function me(Ie,Te){return Ie.pxmid[1]-Te.pxmid[1]}function _e(Ie,Te){return Te.pxmid[1]-Ie.pxmid[1]}function Se(Ie,Te){Te||(Te={});var Ce=Te.labelExtraY+(ee?Te.yLabelMax:Te.yLabelMin),He=ee?Ie.yLabelMin:Ie.yLabelMax,Xe=ee?Ie.yLabelMax:Ie.yLabelMin,Be=Ie.cyFinal+q(Ie.px0[1],Ie.px1[1]),Re=Ce-He,We,vt,Pt,Zt,zt,At;if(Re*le>0&&(Ie.labelExtraY=Re),!!Array.isArray(G.pull))for(vt=0;vt<xe.length;vt++)Pt=xe[vt],!(Pt===Ie||(g.castOption(G.pull,Ie.pts)||0)>=(g.castOption(G.pull,Pt.pts)||0))&&((Ie.pxmid[1]-Pt.pxmid[1])*le>0?(Zt=Pt.cyFinal+q(Pt.px0[1],Pt.px1[1]),Re=Zt-He-Ie.labelExtraY,Re*le>0&&(Ie.labelExtraY+=Re)):(Xe+Ie.labelExtraY-Be)*le>0&&(We=3*ae*Math.abs(vt-xe.indexOf(Ie)),zt=Pt.cxFinal+J(Pt.px0[0],Pt.px1[0]),At=zt+We-(Ie.cxFinal+Ie.pxmid[0])-Ie.labelExtraX,At*ae>0&&(Ie.labelExtraX+=At)))}for(ee=0;ee<2;ee++)for(ne=ee?me:_e,q=ee?Math.max:Math.min,le=ee?1:-1,Y=0;Y<2;Y++){for(J=Y?Math.max:Math.min,ae=Y?1:-1,ie=te[ee][Y],ie.sort(ne),se=te[1-ee][Y],xe=se.concat(ie),he=[],oe=0;oe<ie.length;oe++)ie[oe].yLabelMid!==void 0&&he.push(ie[oe]);for(be=!1,oe=0;ee&&oe<se.length;oe++)if(se[oe].yLabelMid!==void 0){be=se[oe];break}for(oe=0;oe<he.length;oe++){var De=oe&&he[oe-1];be&&!oe&&(De=be),Se(he[oe],De)}}}function j(te,G){for(var Y=[],ee=0;ee<te.length;ee++){var ne=te[ee][0],J=ne.trace,q=J.domain,ae=G.w*(q.x[1]-q.x[0]),le=G.h*(q.y[1]-q.y[0]);J.title.text&&J.title.position!=="middle center"&&(le-=N(ne,G));var ie=ae/2,se=le/2;J.type==="funnelarea"&&!J.scalegroup&&(se/=J.aspectratio),ne.r=Math.min(ie,se)/(1+V(J)),ne.cx=G.l+G.w*(J.domain.x[1]+J.domain.x[0])/2,ne.cy=G.t+G.h*(1-J.domain.y[0])-le/2,J.title.text&&J.title.position.indexOf("bottom")!==-1&&(ne.cy-=N(ne,G)),J.scalegroup&&Y.indexOf(J.scalegroup)===-1&&Y.push(J.scalegroup)}Z(te,Y)}function Z(te,G){for(var Y,ee,ne,J=0;J<G.length;J++){var q=1/0,ae=G[J];for(ee=0;ee<te.length;ee++)if(Y=te[ee][0],ne=Y.trace,ne.scalegroup===ae){var le;if(ne.type==="pie")le=Y.r*Y.r;else if(ne.type==="funnelarea"){var ie,se;ne.aspectratio>1?(ie=Y.r,se=ie/ne.aspectratio):(se=Y.r,ie=se*ne.aspectratio),ie*=(1+ne.baseratio)/2,le=ie*se}q=Math.min(q,le/Y.vTotal)}for(ee=0;ee<te.length;ee++)if(Y=te[ee][0],ne=Y.trace,ne.scalegroup===ae){var xe=q*Y.vTotal;ne.type==="funnelarea"&&(xe/=(1+ne.baseratio)/2,xe/=ne.aspectratio),Y.r=Math.sqrt(xe)}}}function X(te){var G=te[0],Y=G.r,ee=G.trace,ne=g.getRotationAngle(ee.rotation),J=2*Math.PI/G.vTotal,q="px0",ae="px1",le,ie,se;if(ee.direction==="counterclockwise"){for(le=0;le<te.length&&te[le].hidden;le++);if(le===te.length)return;ne+=J*te[le].v,J*=-1,q="px1",ae="px0"}for(se=re(Y,ne),le=0;le<te.length;le++)ie=te[le],!ie.hidden&&(ie[q]=se,ie.startangle=ne,ne+=J*ie.v/2,ie.pxmid=re(Y,ne),ie.midangle=ne,ne+=J*ie.v/2,se=re(Y,ne),ie.stopangle=ne,ie[ae]=se,ie.largeArc=ie.v>G.vTotal/2?1:0,ie.halfangle=Math.PI*Math.min(ie.v/G.vTotal,.5),ie.ring=1-ee.hole,ie.rInscribed=B(ie,G))}function re(te,G){return[te*Math.sin(G),-te*Math.cos(G)]}function ue(te,G,Y){var ee=te._fullLayout,ne=Y.trace,J=ne.texttemplate,q=ne.textinfo;if(!J&&q&&q!=="none"){var ae=q.split("+"),le=function(Te){return ae.indexOf(Te)!==-1},ie=le("label"),se=le("text"),xe=le("value"),oe=le("percent"),he=ee.separators,be;if(be=ie?[G.label]:[],se){var me=g.getFirstFilled(ne.text,G.pts);v(me)&&be.push(me)}xe&&be.push(g.formatPieValue(G.v,he)),oe&&be.push(g.formatPiePercent(G.v/Y.vTotal,he)),G.text=be.join("<br>")}function _e(Te){return{label:Te.label,value:Te.v,valueLabel:g.formatPieValue(Te.v,ee.separators),percent:Te.v/Y.vTotal,percentLabel:g.formatPiePercent(Te.v/Y.vTotal,ee.separators),color:Te.color,text:Te.text,customdata:i.castOption(ne,Te.i,"customdata")}}if(J){var Se=i.castOption(ne,G.i,"texttemplate");if(!Se)G.text="";else{var De=_e(G),Ie=g.getFirstFilled(ne.text,G.pts);(v(Ie)||Ie==="")&&(De.text=Ie),G.text=i.texttemplateString(Se,De,te._fullLayout._d3locale,De,ne._meta||{})}}}function K(te,G){var Y=te.rotate*Math.PI/180,ee=Math.cos(Y),ne=Math.sin(Y),J=(G.left+G.right)/2,q=(G.top+G.bottom)/2;te.textX=J*ee-q*ne,te.textY=J*ne+q*ee,te.noCenter=!0}P.exports={plot:x,formatSliceLabel:ue,transformInsideText:y,determineInsideTextFont:M,positionTitleOutside:I,prerenderTitles:_,layoutAreas:j,attachFxHandlers:b,computeTransform:K}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../bar/constants":659,"../bar/uniform_text":673,"./event_data":914,"./helpers":915,"@plotly/d3":58}],920:[function(t,P,R){var h=t("@plotly/d3"),u=t("./style_one"),A=t("../bar/uniform_text").resizeText;P.exports=function(e){var i=e._fullLayout._pielayer.selectAll(".trace");A(e,i,"pie"),i.each(function(n){var a=n[0],r=a.trace,f=h.select(this);f.style({opacity:r.opacity}),f.selectAll("path.surface").each(function(o){h.select(this).call(u,o,r)})})}},{"../bar/uniform_text":673,"./style_one":921,"@plotly/d3":58}],921:[function(t,P,R){var h=t("../../components/color"),u=t("./helpers").castOption;P.exports=function(T,e,i){var n=i.marker.line,a=u(n.color,e.pts)||h.defaultLine,r=u(n.width,e.pts)||0;T.style("stroke-width",r).call(h.fill,e.color).call(h.stroke,a)}},{"../../components/color":367,"./helpers":915}],922:[function(t,P,R){var h=t("../scatter/attributes");P.exports={x:h.x,y:h.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:h.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":936}],923:[function(t,P,R){var h=t("../../../stackgl_modules").gl_pointcloud2d,u=t("../../lib/str2rgbarray"),A=t("../../plots/cartesian/autorange").findExtremes,T=t("../scatter/get_trace_color");function e(a,r){this.scene=a,this.uid=r,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=h(a.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var i=e.prototype;i.handlePick=function(a){var r=this.idToIndex[a.pointId];return{trace:this,dataCoord:a.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[r*2],this.pickXYData[r*2+1]]:[this.pickXData[r],this.pickYData[r]],textLabel:Array.isArray(this.textLabels)?this.textLabels[r]:this.textLabels,color:this.color,name:this.name,pointIndex:r,hoverinfo:this.hoverinfo}},i.update=function(a){this.index=a.index,this.textLabels=a.text,this.name=a.name,this.hoverinfo=a.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(a),this.color=T(a,{})},i.updateFast=function(a){var r=this.xData=this.pickXData=a.x,f=this.yData=this.pickYData=a.y,o=this.pickXYData=a.xy,s=a.xbounds&&a.ybounds,m=a.indices,g,p,v,x=this.bounds,l,b,c;if(o){if(v=o,g=o.length>>>1,s)x[0]=a.xbounds[0],x[2]=a.xbounds[1],x[1]=a.ybounds[0],x[3]=a.ybounds[1];else for(c=0;c<g;c++)l=v[c*2],b=v[c*2+1],l<x[0]&&(x[0]=l),l>x[2]&&(x[2]=l),b<x[1]&&(x[1]=b),b>x[3]&&(x[3]=b);if(m)p=m;else for(p=new Int32Array(g),c=0;c<g;c++)p[c]=c}else for(g=r.length,v=new Float32Array(2*g),p=new Int32Array(g),c=0;c<g;c++)l=r[c],b=f[c],p[c]=c,v[c*2]=l,v[c*2+1]=b,l<x[0]&&(x[0]=l),l>x[2]&&(x[2]=l),b<x[1]&&(x[1]=b),b>x[3]&&(x[3]=b);this.idToIndex=p,this.pointcloudOptions.idToIndex=p,this.pointcloudOptions.positions=v;var M=u(a.marker.color),_=u(a.marker.border.color),y=a.opacity*a.marker.opacity;M[3]*=y,this.pointcloudOptions.color=M;var w=a.marker.blend;if(w===null){var d=100;w=r.length<d||f.length<d}this.pointcloudOptions.blend=w,_[3]*=y,this.pointcloudOptions.borderColor=_;var C=a.marker.sizemin,S=Math.max(a.marker.sizemax,a.marker.sizemin);this.pointcloudOptions.sizeMin=C,this.pointcloudOptions.sizeMax=S,this.pointcloudOptions.areaRatio=a.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var E=this.scene.xaxis,k=this.scene.yaxis,B=S/2||.5;a._extremes[E._id]=A(E,[x[0],x[2]],{ppad:B}),a._extremes[k._id]=A(k,[x[1],x[3]],{ppad:B})},i.dispose=function(){this.pointcloud.dispose()};function n(a,r){var f=new e(a,r.uid);return f.update(r),f}P.exports=n},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/autorange":565,"../scatter/get_trace_color":946}],924:[function(t,P,R){var h=t("../../lib"),u=t("./attributes");P.exports=function(T,e,i){function n(a,r){return h.coerce(T,e,u,a,r)}n("x"),n("y"),n("xbounds"),n("ybounds"),T.xy&&T.xy instanceof Float32Array&&(e.xy=T.xy),T.indices&&T.indices instanceof Int32Array&&(e.indices=T.indices),n("text"),n("marker.color",i),n("marker.opacity"),n("marker.blend"),n("marker.sizemin"),n("marker.sizemax"),n("marker.border.color",i),n("marker.border.arearatio"),e._length=null}},{"../../lib":515,"./attributes":922}],925:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),calc:t("../scatter3d/calc"),plot:t("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:t("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":605,"../scatter3d/calc":965,"./attributes":922,"./convert":923,"./defaults":924}],926:[function(t,P,R){var h=t("../../plots/font_attributes"),u=t("../../plots/attributes"),A=t("../../components/color/attributes"),T=t("../../components/fx/attributes"),e=t("../../plots/domain").attributes,i=t("../../plots/template_attributes").hovertemplateAttrs,n=t("../../components/colorscale/attributes"),a=t("../../plot_api/plot_template").templatedArray,r=t("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,f=t("../../lib/extend").extendFlat,o=t("../../plot_api/edit_types").overrideAll,s=P.exports=o({hoverinfo:f({},u.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:T.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:r("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:h({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:A.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:T.hoverlabel,hovertemplate:i({},{keys:["value","label"]})},link:{arrowlen:{valType:"number",min:0,dflt:0},label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:A.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:T.hoverlabel,hovertemplate:i({},{keys:["value","label"]}),colorscales:a("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:f(n().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested");s.transforms=void 0},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../components/fx/attributes":398,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],927:[function(t,P,R){var h=t("../../plot_api/edit_types").overrideAll,u=t("../../plots/get_data").getModuleCalcData,A=t("./plot"),T=t("../../components/fx/layout_attributes"),e=t("../../lib/setcursor"),i=t("../../components/dragelement"),n=t("../../components/selections").prepSelect,a=t("../../lib"),r=t("../../registry"),f="sankey";R.name=f,R.baseLayoutAttrOverrides=h({hoverlabel:T.hoverlabel},"plot","nested"),R.plot=function(s){var m=u(s.calcdata,f)[0];A(s,m),R.updateFx(s)},R.clean=function(s,m,g,p){var v=p._has&&p._has(f),x=m._has&&m._has(f);v&&!x&&(p._paperdiv.selectAll(".sankey").remove(),p._paperdiv.selectAll(".bgsankey").remove())},R.updateFx=function(s){for(var m=0;m<s._fullData.length;m++)o(s,m)};function o(s,m){var g=s._fullData[m],p=s._fullLayout,v=p.dragmode,x=p.dragmode==="pan"?"move":"crosshair",l=g._bgRect;if(!!l&&!(v==="pan"||v==="zoom")){e(l,x);var b={_id:"x",c2p:a.identity,_offset:g._sankey.translateX,_length:g._sankey.width},c={_id:"y",c2p:a.identity,_offset:g._sankey.translateY,_length:g._sankey.height},M={gd:s,element:l.node(),plotinfo:{id:m,xaxis:b,yaxis:c,fillRangeItems:a.noop},subplot:m,xaxes:[b],yaxes:[c],doneFnCompleted:function(_){var y=s._fullData[m],w,d=y.node.groups.slice(),C=[];function S(z){for(var F=y._sankey.graph.nodes,I=0;I<F.length;I++)if(F[I].pointNumber===z)return F[I]}for(var E=0;E<_.length;E++){var k=S(_[E].pointNumber);if(!!k)if(k.group){for(var B=0;B<k.childrenNodes.length;B++)C.push(k.childrenNodes[B].pointNumber);d[k.pointNumber-y.node._count]=!1}else C.push(k.pointNumber)}w=d.filter(Boolean).concat([C]),r.call("_guiRestyle",s,{"node.groups":[w]},m)}};M.prepFn=function(_,y,w){n(_,y,w,M,v)},i.init(M)}}},{"../../components/dragelement":386,"../../components/fx/layout_attributes":408,"../../components/selections":455,"../../lib":515,"../../lib/setcursor":536,"../../plot_api/edit_types":548,"../../plots/get_data":602,"../../registry":647,"./plot":932}],928:[function(t,P,R){var h=t("strongly-connected-components"),u=t("../../lib"),A=t("../../lib/gup").wrap,T=u.isArrayOrTypedArray,e=u.isIndex,i=t("../../components/colorscale");function n(r){var f=r.node,o=r.link,s=[],m=T(o.color),g=T(o.customdata),p={},v={},x=o.colorscales.length,l;for(l=0;l<x;l++){var b=o.colorscales[l],c=i.extractScale(b,{cLetter:"c"}),M=i.makeColorScaleFunc(c);v[b.label]=M}var _=0;for(l=0;l<o.value.length;l++)o.source[l]>_&&(_=o.source[l]),o.target[l]>_&&(_=o.target[l]);var y=_+1;r.node._count=y;var w,d=r.node.groups,C={};for(l=0;l<d.length;l++){var S=d[l];for(w=0;w<S.length;w++){var E=S[w],k=y+l;C.hasOwnProperty(E)?u.warn("Node "+E+" is already part of a group."):C[E]=k}}var B={source:[],target:[]};for(l=0;l<o.value.length;l++){var z=o.value[l],F=o.source[l],I=o.target[l];if(!!(z>0&&e(F,y)&&e(I,y))&&!(C.hasOwnProperty(F)&&C.hasOwnProperty(I)&&C[F]===C[I])){C.hasOwnProperty(I)&&(I=C[I]),C.hasOwnProperty(F)&&(F=C[F]),F=+F,I=+I,p[F]=p[I]=!0;var O="";o.label&&o.label[l]&&(O=o.label[l]);var N=null;O&&v.hasOwnProperty(O)&&(N=v[O]),s.push({pointNumber:l,label:O,color:m?o.color[l]:o.color,customdata:g?o.customdata[l]:o.customdata,concentrationscale:N,source:F,target:I,value:+z}),B.source.push(F),B.target.push(I)}}var V=y+d.length,H=T(f.color),j=T(f.customdata),Z=[];for(l=0;l<V;l++)if(!!p[l]){var X=f.label[l];Z.push({group:l>y-1,childrenNodes:[],pointNumber:l,label:X,color:H?f.color[l]:f.color,customdata:j?f.customdata[l]:f.customdata})}var re=!1;return a(V,B.source,B.target)&&(re=!0),{circular:re,links:s,nodes:Z,groups:d,groupLookup:C}}function a(r,f,o){for(var s=u.init2dArray(r,0),m=0;m<Math.min(f.length,o.length);m++)if(u.isIndex(f[m],r)&&u.isIndex(o[m],r)){if(f[m]===o[m])return!0;s[f[m]].push(o[m])}var g=h(s);return g.components.some(function(p){return p.length>1})}P.exports=function(f,o){var s=n(o);return A({circular:s.circular,_nodes:s.nodes,_links:s.links,_groups:s.groups,_groupLookup:s.groupLookup})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512,"strongly-connected-components":307}],929:[function(t,P,R){P.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],930:[function(t,P,R){var h=t("../../lib"),u=t("./attributes"),A=t("../../components/color"),T=t("tinycolor2"),e=t("../../plots/domain").defaults,i=t("../../components/fx/hoverlabel_defaults"),n=t("../../plot_api/plot_template"),a=t("../../plots/array_container_defaults");P.exports=function(o,s,m,g){function p(S,E){return h.coerce(o,s,u,S,E)}var v=h.extendDeep(g.hoverlabel,o.hoverlabel),x=o.node,l=n.newContainer(s,"node");function b(S,E){return h.coerce(x,l,u.node,S,E)}b("label"),b("groups"),b("x"),b("y"),b("pad"),b("thickness"),b("line.color"),b("line.width"),b("hoverinfo",o.hoverinfo),i(x,l,b,v),b("hovertemplate");var c=g.colorway,M=function(S){return c[S%c.length]};b("color",l.label.map(function(S,E){return A.addOpacity(M(E),.8)})),b("customdata");var _=o.link||{},y=n.newContainer(s,"link");function w(S,E){return h.coerce(_,y,u.link,S,E)}w("label"),w("arrowlen"),w("source"),w("target"),w("value"),w("line.color"),w("line.width"),w("hoverinfo",o.hoverinfo),i(_,y,w,v),w("hovertemplate");var d=T(g.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";w("color",h.repeat(d,y.value.length)),w("customdata"),a(_,y,{name:"colorscales",handleItemDefaults:r}),e(s,g,p),p("orientation"),p("valueformat"),p("valuesuffix");var C;l.x.length&&l.y.length&&(C="freeform"),p("arrangement",C),h.coerceFont(p,"textfont",h.extendFlat({},g.font)),s._length=null};function r(f,o){function s(m,g){return h.coerce(f,o,u.link.colorscales,m,g)}s("label"),s("cmin"),s("cmax"),s("colorscale")}},{"../../components/color":367,"../../components/fx/hoverlabel_defaults":405,"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/domain":593,"./attributes":926,tinycolor2:313}],931:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),calc:t("./calc"),plot:t("./plot"),moduleType:"trace",name:"sankey",basePlotModule:t("./base_plot"),selectPoints:t("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":926,"./base_plot":927,"./calc":928,"./defaults":930,"./plot":932,"./select.js":934}],932:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=u.numberFormat,T=t("./render"),e=t("../../components/fx"),i=t("../../components/color"),n=t("./constants").cn,a=u._;function r(c){return c!==""}function f(c,M){return c.filter(function(_){return _.key===M.traceId})}function o(c,M){h.select(c).select("path").style("fill-opacity",M),h.select(c).select("rect").style("fill-opacity",M)}function s(c){h.select(c).select("text.name").style("fill","black")}function m(c){return function(M){return c.node.sourceLinks.indexOf(M.link)!==-1||c.node.targetLinks.indexOf(M.link)!==-1}}function g(c){return function(M){return M.node.sourceLinks.indexOf(c.link)!==-1||M.node.targetLinks.indexOf(c.link)!==-1}}function p(c,M,_){M&&_&&f(_,M).selectAll("."+n.sankeyLink).filter(m(M)).call(x.bind(0,M,_,!1))}function v(c,M,_){M&&_&&f(_,M).selectAll("."+n.sankeyLink).filter(m(M)).call(l.bind(0,M,_,!1))}function x(c,M,_,y){var w=y.datum().link.label;y.style("fill-opacity",function(d){if(!d.link.concentrationscale)return .4}),w&&f(M,c).selectAll("."+n.sankeyLink).filter(function(d){return d.link.label===w}).style("fill-opacity",function(d){if(!d.link.concentrationscale)return .4}),_&&f(M,c).selectAll("."+n.sankeyNode).filter(g(c)).call(p)}function l(c,M,_,y){var w=y.datum().link.label;y.style("fill-opacity",function(d){return d.tinyColorAlpha}),w&&f(M,c).selectAll("."+n.sankeyLink).filter(function(d){return d.link.label===w}).style("fill-opacity",function(d){return d.tinyColorAlpha}),_&&f(M,c).selectAll(n.sankeyNode).filter(g(c)).call(v)}function b(c,M){var _=c.hoverlabel||{},y=u.nestedProperty(_,M).get();return Array.isArray(y)?!1:y}P.exports=function(M,_){for(var y=M._fullLayout,w=y._paper,d=y._size,C=0;C<M._fullData.length;C++)if(!!M._fullData[C].visible&&M._fullData[C].type===n.sankey&&!M._fullData[C]._viewInitial){var S=M._fullData[C].node;M._fullData[C]._viewInitial={node:{groups:S.groups.slice(),x:S.x.slice(),y:S.y.slice()}}}var E=function(re,ue){var K=ue.link;K.originalEvent=h.event,M._hoverdata=[K],e.click(M,{target:!0})},k=function(re,ue,K){M._fullLayout.hovermode!==!1&&(h.select(re).call(x.bind(0,ue,K,!0)),ue.link.trace.link.hoverinfo!=="skip"&&(ue.link.fullData=ue.link.trace,M.emit("plotly_hover",{event:h.event,points:[ue.link]})))},B=a(M,"source:")+" ",z=a(M,"target:")+" ",F=a(M,"concentration:")+" ",I=a(M,"incoming flow count:")+" ",O=a(M,"outgoing flow count:")+" ",N=function(re,ue){if(M._fullLayout.hovermode===!1)return;var K=ue.link.trace.link;if(K.hoverinfo==="none"||K.hoverinfo==="skip")return;var te=[];function G(le){var ie,se;le.circular?(ie=(le.circularPathData.leftInnerExtent+le.circularPathData.rightInnerExtent)/2,se=le.circularPathData.verticalFullExtent):(ie=(le.source.x1+le.target.x0)/2,se=(le.y0+le.y1)/2);var xe=[ie,se];return le.trace.orientation==="v"&&xe.reverse(),xe[0]+=ue.parent.translateX,xe[1]+=ue.parent.translateY,xe}for(var Y=0,ee=0;ee<ue.flow.links.length;ee++){var ne=ue.flow.links[ee];if(!(M._fullLayout.hovermode==="closest"&&ue.link.pointNumber!==ne.pointNumber)){ue.link.pointNumber===ne.pointNumber&&(Y=ee),ne.fullData=ne.trace,K=ue.link.trace.link;var J=G(ne),q={valueLabel:A(ue.valueFormat)(ne.value)+ue.valueSuffix};te.push({x:J[0],y:J[1],name:q.valueLabel,text:[ne.label||"",B+ne.source.label,z+ne.target.label,ne.concentrationscale?F+A("%0.2f")(ne.flow.labelConcentration):""].filter(r).join("<br>"),color:b(K,"bgcolor")||i.addOpacity(ne.color,1),borderColor:b(K,"bordercolor"),fontFamily:b(K,"font.family"),fontSize:b(K,"font.size"),fontColor:b(K,"font.color"),nameLength:b(K,"namelength"),textAlign:b(K,"align"),idealAlign:h.event.x<J[0]?"right":"left",hovertemplate:K.hovertemplate,hovertemplateLabels:q,eventData:[ne]})}}var ae=e.loneHover(te,{container:y._hoverlayer.node(),outerContainer:y._paper.node(),gd:M,anchorIndex:Y});ae.each(function(){var le=this;ue.link.concentrationscale||o(le,.65),s(le)})},V=function(re,ue,K){M._fullLayout.hovermode!==!1&&(h.select(re).call(l.bind(0,ue,K,!0)),ue.link.trace.link.hoverinfo!=="skip"&&(ue.link.fullData=ue.link.trace,M.emit("plotly_unhover",{event:h.event,points:[ue.link]})),e.loneUnhover(y._hoverlayer.node()))},H=function(re,ue,K){var te=ue.node;te.originalEvent=h.event,M._hoverdata=[te],h.select(re).call(v,ue,K),e.click(M,{target:!0})},j=function(re,ue,K){M._fullLayout.hovermode!==!1&&(h.select(re).call(p,ue,K),ue.node.trace.node.hoverinfo!=="skip"&&(ue.node.fullData=ue.node.trace,M.emit("plotly_hover",{event:h.event,points:[ue.node]})))},Z=function(re,ue){if(M._fullLayout.hovermode!==!1){var K=ue.node.trace.node;if(!(K.hoverinfo==="none"||K.hoverinfo==="skip")){var te=h.select(re).select("."+n.nodeRect),G=M._fullLayout._paperdiv.node().getBoundingClientRect(),Y=te.node().getBoundingClientRect(),ee=Y.left-2-G.left,ne=Y.right+2-G.left,J=Y.top+Y.height/4-G.top,q={valueLabel:A(ue.valueFormat)(ue.node.value)+ue.valueSuffix};ue.node.fullData=ue.node.trace,M._fullLayout._calcInverseTransform(M);var ae=M._fullLayout._invScaleX,le=M._fullLayout._invScaleY,ie=e.loneHover({x0:ae*ee,x1:ae*ne,y:le*J,name:A(ue.valueFormat)(ue.node.value)+ue.valueSuffix,text:[ue.node.label,I+ue.node.targetLinks.length,O+ue.node.sourceLinks.length].filter(r).join("<br>"),color:b(K,"bgcolor")||ue.tinyColorHue,borderColor:b(K,"bordercolor"),fontFamily:b(K,"font.family"),fontSize:b(K,"font.size"),fontColor:b(K,"font.color"),nameLength:b(K,"namelength"),textAlign:b(K,"align"),idealAlign:"left",hovertemplate:K.hovertemplate,hovertemplateLabels:q,eventData:[ue.node]},{container:y._hoverlayer.node(),outerContainer:y._paper.node(),gd:M});o(ie,.85),s(ie)}}},X=function(re,ue,K){M._fullLayout.hovermode!==!1&&(h.select(re).call(v,ue,K),ue.node.trace.node.hoverinfo!=="skip"&&(ue.node.fullData=ue.node.trace,M.emit("plotly_unhover",{event:h.event,points:[ue.node]})),e.loneUnhover(y._hoverlayer.node()))};T(M,w,_,{width:d.w,height:d.h,margin:{t:d.t,r:d.r,b:d.b,l:d.l}},{linkEvents:{hover:k,follow:N,unhover:V,select:E},nodeEvents:{hover:j,follow:Z,unhover:X,select:H}})}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"./constants":929,"./render":933,"@plotly/d3":58}],933:[function(t,P,R){var h=t("d3-force"),u=t("d3-interpolate").interpolateNumber,A=t("@plotly/d3"),T=t("@plotly/d3-sankey"),e=t("@plotly/d3-sankey-circular"),i=t("./constants"),n=t("tinycolor2"),a=t("../../components/color"),r=t("../../components/drawing"),f=t("../../lib"),o=f.strTranslate,s=f.strRotate,m=t("../../lib/gup"),g=m.keyFun,p=m.repeat,v=m.unwrap,x=t("../../lib/svg_text_utils"),l=t("../../registry"),b=t("../../constants/alignment"),c=b.CAP_SHIFT,M=b.LINE_SPACING,_=3;function y(G,Y,ee){var ne=v(Y),J=ne.trace,q=J.domain,ae=J.orientation==="h",le=J.node.pad,ie=J.node.thickness,se=G.width*(q.x[1]-q.x[0]),xe=G.height*(q.y[1]-q.y[0]),oe=ne._nodes,he=ne._links,be=ne.circular,me;be?me=e.sankeyCircular().circularLinkGap(0):me=T.sankey(),me.iterations(i.sankeyIterations).size(ae?[se,xe]:[xe,se]).nodeWidth(ie).nodePadding(le).nodeId(function(zt){return zt.pointNumber}).nodes(oe).links(he);var _e=me();me.nodePadding()<le&&f.warn("node.pad was reduced to ",me.nodePadding()," to fit within the figure.");var Se,De,Ie;for(var Te in ne._groupLookup){var Ce=parseInt(ne._groupLookup[Te]),He;for(Se=0;Se<_e.nodes.length;Se++)if(_e.nodes[Se].pointNumber===Ce){He=_e.nodes[Se];break}if(!!He){var Xe={pointNumber:parseInt(Te),x0:He.x0,x1:He.x1,y0:He.y0,y1:He.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};_e.nodes.unshift(Xe),He.childrenNodes.unshift(Xe)}}function Be(){for(Se=0;Se<_e.nodes.length;Se++){var zt=_e.nodes[Se],At={},Wt,Bt;for(De=0;De<zt.targetLinks.length;De++)Bt=zt.targetLinks[De],Wt=Bt.source.pointNumber+":"+Bt.target.pointNumber,At.hasOwnProperty(Wt)||(At[Wt]=[]),At[Wt].push(Bt);var Ct=Object.keys(At);for(De=0;De<Ct.length;De++){Wt=Ct[De];var Ze=At[Wt],nt=0,Ye={};for(Ie=0;Ie<Ze.length;Ie++)Bt=Ze[Ie],Ye[Bt.label]||(Ye[Bt.label]=0),Ye[Bt.label]+=Bt.value,nt+=Bt.value;for(Ie=0;Ie<Ze.length;Ie++)Bt=Ze[Ie],Bt.flow={value:nt,labelConcentration:Ye[Bt.label]/nt,concentration:Bt.value/nt,links:Ze},Bt.concentrationscale&&(Bt.color=n(Bt.concentrationscale(Bt.flow.labelConcentration)))}var Ee=0;for(De=0;De<zt.sourceLinks.length;De++)Ee+=zt.sourceLinks[De].value;for(De=0;De<zt.sourceLinks.length;De++)Bt=zt.sourceLinks[De],Bt.concentrationOut=Bt.value/Ee;var Ge=0;for(De=0;De<zt.targetLinks.length;De++)Ge+=zt.targetLinks[De].value;for(De=0;De<zt.targetLinks.length;De++)Bt=zt.targetLinks[De],Bt.concenrationIn=Bt.value/Ge}}Be();function Re(zt){zt.forEach(function(At){var Wt,Bt,Ct=0,Ze=At.length,nt;for(At.sort(function(Ye,Ee){return Ye.y0-Ee.y0}),nt=0;nt<Ze;++nt)Wt=At[nt],Wt.y0>=Ct||(Bt=Ct-Wt.y0,Bt>1e-6&&(Wt.y0+=Bt,Wt.y1+=Bt)),Ct=Wt.y1+le})}function We(zt){var At=zt.map(function(Ee,Ge){return{x0:Ee.x0,index:Ge}}).sort(function(Ee,Ge){return Ee.x0-Ge.x0}),Wt=[],Bt=-1,Ct,Ze=-1/0,nt;for(Se=0;Se<At.length;Se++){var Ye=zt[At[Se].index];Ye.x0>Ze+ie&&(Bt+=1,Ct=Ye.x0),Ze=Ye.x0,Wt[Bt]||(Wt[Bt]=[]),Wt[Bt].push(Ye),nt=Ct-Ye.x0,Ye.x0+=nt,Ye.x1+=nt}return Wt}if(J.node.x.length&&J.node.y.length){for(Se=0;Se<Math.min(J.node.x.length,J.node.y.length,_e.nodes.length);Se++)if(J.node.x[Se]&&J.node.y[Se]){var vt=[J.node.x[Se]*se,J.node.y[Se]*xe];_e.nodes[Se].x0=vt[0]-ie/2,_e.nodes[Se].x1=vt[0]+ie/2;var Pt=_e.nodes[Se].y1-_e.nodes[Se].y0;_e.nodes[Se].y0=vt[1]-Pt/2,_e.nodes[Se].y1=vt[1]+Pt/2}if(J.arrangement==="snap"){oe=_e.nodes;var Zt=We(oe);Re(Zt)}me.update(_e)}return{circular:be,key:ee,trace:J,guid:f.randstr(),horizontal:ae,width:se,height:xe,nodePad:J.node.pad,nodeLineColor:J.node.line.color,nodeLineWidth:J.node.line.width,linkLineColor:J.link.line.color,linkLineWidth:J.link.line.width,linkArrowLength:J.link.arrowlen,valueFormat:J.valueformat,valueSuffix:J.valuesuffix,textFont:J.textfont,translateX:q.x[0]*G.width+G.margin.l,translateY:G.height-q.y[1]*G.height+G.margin.t,dragParallel:ae?xe:se,dragPerpendicular:ae?se:xe,arrangement:J.arrangement,sankey:me,graph:_e,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function w(G,Y,ee){var ne=n(Y.color),J=Y.source.label+"|"+Y.target.label,q=J+"__"+ee;return Y.trace=G.trace,Y.curveNumber=G.trace.index,{circular:G.circular,key:q,traceId:G.key,pointNumber:Y.pointNumber,link:Y,tinyColorHue:a.tinyRGB(ne),tinyColorAlpha:ne.getAlpha(),linkPath:C,linkLineColor:G.linkLineColor,linkLineWidth:G.linkLineWidth,linkArrowLength:G.linkArrowLength,valueFormat:G.valueFormat,valueSuffix:G.valueSuffix,sankey:G.sankey,parent:G,interactionState:G.interactionState,flow:Y.flow}}function d(G,Y){var ee="",ne=G.width/2,J=G.circularPathData;return G.circularLinkType==="top"?ee="M "+(J.targetX-Y)+" "+(J.targetY+ne)+" L"+(J.rightInnerExtent-Y)+" "+(J.targetY+ne)+"A"+(J.rightLargeArcRadius+ne)+" "+(J.rightSmallArcRadius+ne)+" 0 0 1 "+(J.rightFullExtent-ne-Y)+" "+(J.targetY-J.rightSmallArcRadius)+"L"+(J.rightFullExtent-ne-Y)+" "+J.verticalRightInnerExtent+"A"+(J.rightLargeArcRadius+ne)+" "+(J.rightLargeArcRadius+ne)+" 0 0 1 "+(J.rightInnerExtent-Y)+" "+(J.verticalFullExtent-ne)+"L"+J.leftInnerExtent+" "+(J.verticalFullExtent-ne)+"A"+(J.leftLargeArcRadius+ne)+" "+(J.leftLargeArcRadius+ne)+" 0 0 1 "+(J.leftFullExtent+ne)+" "+J.verticalLeftInnerExtent+"L"+(J.leftFullExtent+ne)+" "+(J.sourceY-J.leftSmallArcRadius)+"A"+(J.leftLargeArcRadius+ne)+" "+(J.leftSmallArcRadius+ne)+" 0 0 1 "+J.leftInnerExtent+" "+(J.sourceY+ne)+"L"+J.sourceX+" "+(J.sourceY+ne)+"L"+J.sourceX+" "+(J.sourceY-ne)+"L"+J.leftInnerExtent+" "+(J.sourceY-ne)+"A"+(J.leftLargeArcRadius-ne)+" "+(J.leftSmallArcRadius-ne)+" 0 0 0 "+(J.leftFullExtent-ne)+" "+(J.sourceY-J.leftSmallArcRadius)+"L"+(J.leftFullExtent-ne)+" "+J.verticalLeftInnerExtent+"A"+(J.leftLargeArcRadius-ne)+" "+(J.leftLargeArcRadius-ne)+" 0 0 0 "+J.leftInnerExtent+" "+(J.verticalFullExtent+ne)+"L"+(J.rightInnerExtent-Y)+" "+(J.verticalFullExtent+ne)+"A"+(J.rightLargeArcRadius-ne)+" "+(J.rightLargeArcRadius-ne)+" 0 0 0 "+(J.rightFullExtent+ne-Y)+" "+J.verticalRightInnerExtent+"L"+(J.rightFullExtent+ne-Y)+" "+(J.targetY-J.rightSmallArcRadius)+"A"+(J.rightLargeArcRadius-ne)+" "+(J.rightSmallArcRadius-ne)+" 0 0 0 "+(J.rightInnerExtent-Y)+" "+(J.targetY-ne)+"L"+(J.targetX-Y)+" "+(J.targetY-ne)+(Y>0?"L"+J.targetX+" "+J.targetY:"")+"Z":ee="M "+(J.targetX-Y)+" "+(J.targetY-ne)+" L"+(J.rightInnerExtent-Y)+" "+(J.targetY-ne)+"A"+(J.rightLargeArcRadius+ne)+" "+(J.rightSmallArcRadius+ne)+" 0 0 0 "+(J.rightFullExtent-ne-Y)+" "+(J.targetY+J.rightSmallArcRadius)+"L"+(J.rightFullExtent-ne-Y)+" "+J.verticalRightInnerExtent+"A"+(J.rightLargeArcRadius+ne)+" "+(J.rightLargeArcRadius+ne)+" 0 0 0 "+(J.rightInnerExtent-Y)+" "+(J.verticalFullExtent+ne)+"L"+J.leftInnerExtent+" "+(J.verticalFullExtent+ne)+"A"+(J.leftLargeArcRadius+ne)+" "+(J.leftLargeArcRadius+ne)+" 0 0 0 "+(J.leftFullExtent+ne)+" "+J.verticalLeftInnerExtent+"L"+(J.leftFullExtent+ne)+" "+(J.sourceY+J.leftSmallArcRadius)+"A"+(J.leftLargeArcRadius+ne)+" "+(J.leftSmallArcRadius+ne)+" 0 0 0 "+J.leftInnerExtent+" "+(J.sourceY-ne)+"L"+J.sourceX+" "+(J.sourceY-ne)+"L"+J.sourceX+" "+(J.sourceY+ne)+"L"+J.leftInnerExtent+" "+(J.sourceY+ne)+"A"+(J.leftLargeArcRadius-ne)+" "+(J.leftSmallArcRadius-ne)+" 0 0 1 "+(J.leftFullExtent-ne)+" "+(J.sourceY+J.leftSmallArcRadius)+"L"+(J.leftFullExtent-ne)+" "+J.verticalLeftInnerExtent+"A"+(J.leftLargeArcRadius-ne)+" "+(J.leftLargeArcRadius-ne)+" 0 0 1 "+J.leftInnerExtent+" "+(J.verticalFullExtent-ne)+"L"+(J.rightInnerExtent-Y)+" "+(J.verticalFullExtent-ne)+"A"+(J.rightLargeArcRadius-ne)+" "+(J.rightLargeArcRadius-ne)+" 0 0 1 "+(J.rightFullExtent+ne-Y)+" "+J.verticalRightInnerExtent+"L"+(J.rightFullExtent+ne-Y)+" "+(J.targetY+J.rightSmallArcRadius)+"A"+(J.rightLargeArcRadius-ne)+" "+(J.rightSmallArcRadius-ne)+" 0 0 1 "+(J.rightInnerExtent-Y)+" "+(J.targetY+ne)+"L"+(J.targetX-Y)+" "+(J.targetY+ne)+(Y>0?"L"+J.targetX+" "+J.targetY:"")+"Z",ee}function C(){var G=.5;function Y(ee){var ne=ee.linkArrowLength;if(ee.link.circular)return d(ee.link,ne);var J=Math.abs((ee.link.target.x0-ee.link.source.x1)/2);ne>J&&(ne=J);var q=ee.link.source.x1,ae=ee.link.target.x0-ne,le=u(q,ae),ie=le(G),se=le(1-G),xe=ee.link.y0-ee.link.width/2,oe=ee.link.y0+ee.link.width/2,he=ee.link.y1-ee.link.width/2,be=ee.link.y1+ee.link.width/2,me="M"+q+","+xe,_e="C"+ie+","+xe+" "+se+","+he+" "+ae+","+he,Se="C"+se+","+be+" "+ie+","+oe+" "+q+","+oe,De=ne>0?"L"+(ae+ne)+","+(he+ee.link.width/2):"";return De+="L"+ae+","+be,me+_e+De+Se+"Z"}return Y}function S(G,Y){var ee=n(Y.color),ne=i.nodePadAcross,J=G.nodePad/2;Y.dx=Y.x1-Y.x0,Y.dy=Y.y1-Y.y0;var q=Y.dx,ae=Math.max(.5,Y.dy),le="node_"+Y.pointNumber;return Y.group&&(le=f.randstr()),Y.trace=G.trace,Y.curveNumber=G.trace.index,{index:Y.pointNumber,key:le,partOfGroup:Y.partOfGroup||!1,group:Y.group,traceId:G.key,trace:G.trace,node:Y,nodePad:G.nodePad,nodeLineColor:G.nodeLineColor,nodeLineWidth:G.nodeLineWidth,textFont:G.textFont,size:G.horizontal?G.height:G.width,visibleWidth:Math.ceil(q),visibleHeight:ae,zoneX:-ne,zoneY:-J,zoneWidth:q+2*ne,zoneHeight:ae+2*J,labelY:G.horizontal?Y.dy/2+1:Y.dx/2+1,left:Y.originalLayer===1,sizeAcross:G.width,forceLayouts:G.forceLayouts,horizontal:G.horizontal,darkBackground:ee.getBrightness()<=128,tinyColorHue:a.tinyRGB(ee),tinyColorAlpha:ee.getAlpha(),valueFormat:G.valueFormat,valueSuffix:G.valueSuffix,sankey:G.sankey,graph:G.graph,arrangement:G.arrangement,uniqueNodeLabelPathId:[G.guid,G.key,le].join("_"),interactionState:G.interactionState,figure:G}}function E(G){G.attr("transform",function(Y){return o(Y.node.x0.toFixed(3),Y.node.y0.toFixed(3))})}function k(G){G.call(E)}function B(G,Y){G.call(k),Y.attr("d",C())}function z(G){G.attr("width",function(Y){return Y.node.x1-Y.node.x0}).attr("height",function(Y){return Y.visibleHeight})}function F(G){return G.link.width>1||G.linkLineWidth>0}function I(G){var Y=o(G.translateX,G.translateY);return Y+(G.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function O(G,Y,ee){G.on(".basic",null).on("mouseover.basic",function(ne){!ne.interactionState.dragInProgress&&!ne.partOfGroup&&(ee.hover(this,ne,Y),ne.interactionState.hovered=[this,ne])}).on("mousemove.basic",function(ne){!ne.interactionState.dragInProgress&&!ne.partOfGroup&&(ee.follow(this,ne),ne.interactionState.hovered=[this,ne])}).on("mouseout.basic",function(ne){!ne.interactionState.dragInProgress&&!ne.partOfGroup&&(ee.unhover(this,ne,Y),ne.interactionState.hovered=!1)}).on("click.basic",function(ne){ne.interactionState.hovered&&(ee.unhover(this,ne,Y),ne.interactionState.hovered=!1),!ne.interactionState.dragInProgress&&!ne.partOfGroup&&ee.select(this,ne,Y)})}function N(G,Y,ee,ne){var J=A.behavior.drag().origin(function(q){return{x:q.node.x0+q.visibleWidth/2,y:q.node.y0+q.visibleHeight/2}}).on("dragstart",function(q){if(q.arrangement!=="fixed"&&(f.ensureSingle(ne._fullLayout._infolayer,"g","dragcover",function(le){ne._fullLayout._dragCover=le}),f.raiseToTop(this),q.interactionState.dragInProgress=q.node,re(q.node),q.interactionState.hovered&&(ee.nodeEvents.unhover.apply(0,q.interactionState.hovered),q.interactionState.hovered=!1),q.arrangement==="snap")){var ae=q.traceId+"|"+q.key;q.forceLayouts[ae]?q.forceLayouts[ae].alpha(1):V(G,ae,q),H(G,Y,q,ae,ne)}}).on("drag",function(q){if(q.arrangement!=="fixed"){var ae=A.event.x,le=A.event.y;q.arrangement==="snap"?(q.node.x0=ae-q.visibleWidth/2,q.node.x1=ae+q.visibleWidth/2,q.node.y0=le-q.visibleHeight/2,q.node.y1=le+q.visibleHeight/2):(q.arrangement==="freeform"&&(q.node.x0=ae-q.visibleWidth/2,q.node.x1=ae+q.visibleWidth/2),le=Math.max(0,Math.min(q.size-q.visibleHeight/2,le)),q.node.y0=le-q.visibleHeight/2,q.node.y1=le+q.visibleHeight/2),re(q.node),q.arrangement!=="snap"&&(q.sankey.update(q.graph),B(G.filter(ue(q)),Y))}}).on("dragend",function(q){if(q.arrangement!=="fixed"){q.interactionState.dragInProgress=!1;for(var ae=0;ae<q.node.childrenNodes.length;ae++)q.node.childrenNodes[ae].x=q.node.x,q.node.childrenNodes[ae].y=q.node.y;q.arrangement!=="snap"&&Z(q,ne)}});G.on(".drag",null).call(J)}function V(G,Y,ee,ne){K(ee.graph.nodes);var J=ee.graph.nodes.filter(function(q){return q.originalX===ee.node.originalX}).filter(function(q){return!q.partOfGroup});ee.forceLayouts[Y]=h.forceSimulation(J).alphaDecay(0).force("collide",h.forceCollide().radius(function(q){return q.dy/2+ee.nodePad/2}).strength(1).iterations(i.forceIterations)).force("constrain",j(G,Y,J,ee)).stop()}function H(G,Y,ee,ne,J){window.requestAnimationFrame(function q(){var ae;for(ae=0;ae<i.forceTicksPerFrame;ae++)ee.forceLayouts[ne].tick();var le=ee.graph.nodes;if(te(le),ee.sankey.update(ee.graph),B(G.filter(ue(ee)),Y),ee.forceLayouts[ne].alpha()>0)window.requestAnimationFrame(q);else{var ie=ee.node.originalX;ee.node.x0=ie-ee.visibleWidth/2,ee.node.x1=ie+ee.visibleWidth/2,Z(ee,J)}})}function j(G,Y,ee,ne){return function(){for(var q=0,ae=0;ae<ee.length;ae++){var le=ee[ae];le===ne.interactionState.dragInProgress?(le.x=le.lastDraggedX,le.y=le.lastDraggedY):(le.vx=(le.originalX-le.x)/i.forceTicksPerFrame,le.y=Math.min(ne.size-le.dy/2,Math.max(le.dy/2,le.y))),q=Math.max(q,Math.abs(le.vx),Math.abs(le.vy))}!ne.interactionState.dragInProgress&&q<.1&&ne.forceLayouts[Y].alpha()>0&&ne.forceLayouts[Y].alpha(0)}}function Z(G,Y){for(var ee=[],ne=[],J=0;J<G.graph.nodes.length;J++){var q=(G.graph.nodes[J].x0+G.graph.nodes[J].x1)/2,ae=(G.graph.nodes[J].y0+G.graph.nodes[J].y1)/2;ee.push(q/G.figure.width),ne.push(ae/G.figure.height)}l.call("_guiRestyle",Y,{"node.x":[ee],"node.y":[ne]},G.trace.index).then(function(){Y._fullLayout._dragCover&&Y._fullLayout._dragCover.remove()})}function X(G){var Y=[],ee;for(ee=0;ee<G.length;ee++)G[ee].originalX=(G[ee].x0+G[ee].x1)/2,G[ee].originalY=(G[ee].y0+G[ee].y1)/2,Y.indexOf(G[ee].originalX)===-1&&Y.push(G[ee].originalX);for(Y.sort(function(ne,J){return ne-J}),ee=0;ee<G.length;ee++)G[ee].originalLayerIndex=Y.indexOf(G[ee].originalX),G[ee].originalLayer=G[ee].originalLayerIndex/(Y.length-1)}function re(G){G.lastDraggedX=G.x0+G.dx/2,G.lastDraggedY=G.y0+G.dy/2}function ue(G){return function(Y){return Y.node.originalX===G.node.originalX}}function K(G){for(var Y=0;Y<G.length;Y++)G[Y].y=(G[Y].y0+G[Y].y1)/2,G[Y].x=(G[Y].x0+G[Y].x1)/2}function te(G){for(var Y=0;Y<G.length;Y++)G[Y].y0=G[Y].y-G[Y].dy/2,G[Y].y1=G[Y].y0+G[Y].dy,G[Y].x0=G[Y].x-G[Y].dx/2,G[Y].x1=G[Y].x0+G[Y].dx}P.exports=function(G,Y,ee,ne,J){var q=G._context.staticPlot,ae=!1;f.ensureSingle(G._fullLayout._infolayer,"g","first-render",function(){ae=!0});var le=G._fullLayout._dragCover,ie=ee.filter(function(Se){return v(Se).trace.visible}).map(y.bind(null,ne)),se=Y.selectAll("."+i.cn.sankey).data(ie,g);se.exit().remove(),se.enter().append("g").classed(i.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events",q?"none":"auto").attr("transform",I),se.each(function(Se,De){G._fullData[De]._sankey=Se;var Ie="bgsankey-"+Se.trace.uid+"-"+De;f.ensureSingle(G._fullLayout._draggers,"rect",Ie),G._fullData[De]._bgRect=A.select("."+Ie),G._fullData[De]._bgRect.style("pointer-events",q?"none":"all").attr("width",Se.width).attr("height",Se.height).attr("x",Se.translateX).attr("y",Se.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),se.transition().ease(i.ease).duration(i.duration).attr("transform",I);var xe=se.selectAll("."+i.cn.sankeyLinks).data(p,g);xe.enter().append("g").classed(i.cn.sankeyLinks,!0).style("fill","none");var oe=xe.selectAll("."+i.cn.sankeyLink).data(function(Se){var De=Se.graph.links;return De.filter(function(Ie){return Ie.value}).map(w.bind(null,Se))},g);oe.enter().append("path").classed(i.cn.sankeyLink,!0).call(O,se,J.linkEvents),oe.style("stroke",function(Se){return F(Se)?a.tinyRGB(n(Se.linkLineColor)):Se.tinyColorHue}).style("stroke-opacity",function(Se){return F(Se)?a.opacity(Se.linkLineColor):Se.tinyColorAlpha}).style("fill",function(Se){return Se.tinyColorHue}).style("fill-opacity",function(Se){return Se.tinyColorAlpha}).style("stroke-width",function(Se){return F(Se)?Se.linkLineWidth:1}).attr("d",C()),oe.style("opacity",function(){return G._context.staticPlot||ae||le?1:0}).transition().ease(i.ease).duration(i.duration).style("opacity",1),oe.exit().transition().ease(i.ease).duration(i.duration).style("opacity",0).remove();var he=se.selectAll("."+i.cn.sankeyNodeSet).data(p,g);he.enter().append("g").classed(i.cn.sankeyNodeSet,!0),he.style("cursor",function(Se){switch(Se.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var be=he.selectAll("."+i.cn.sankeyNode).data(function(Se){var De=Se.graph.nodes;return X(De),De.map(S.bind(null,Se))},g);be.enter().append("g").classed(i.cn.sankeyNode,!0).call(E).style("opacity",function(Se){return(G._context.staticPlot||ae)&&!Se.partOfGroup?1:0}),be.call(O,se,J.nodeEvents).call(N,oe,J,G),be.transition().ease(i.ease).duration(i.duration).call(E).style("opacity",function(Se){return Se.partOfGroup?0:1}),be.exit().transition().ease(i.ease).duration(i.duration).style("opacity",0).remove();var me=be.selectAll("."+i.cn.nodeRect).data(p);me.enter().append("rect").classed(i.cn.nodeRect,!0).call(z),me.style("stroke-width",function(Se){return Se.nodeLineWidth}).style("stroke",function(Se){return a.tinyRGB(n(Se.nodeLineColor))}).style("stroke-opacity",function(Se){return a.opacity(Se.nodeLineColor)}).style("fill",function(Se){return Se.tinyColorHue}).style("fill-opacity",function(Se){return Se.tinyColorAlpha}),me.transition().ease(i.ease).duration(i.duration).call(z);var _e=be.selectAll("."+i.cn.nodeLabel).data(p);_e.enter().append("text").classed(i.cn.nodeLabel,!0).style("cursor","default"),_e.attr("data-notex",1).text(function(Se){return Se.node.label}).each(function(Se){var De=A.select(this);r.font(De,Se.textFont),x.convertToTspans(De,G)}).style("text-shadow",x.makeTextShadow(G._fullLayout.paper_bgcolor)).attr("text-anchor",function(Se){return Se.horizontal&&Se.left?"end":"start"}).attr("transform",function(Se){var De=A.select(this),Ie=x.lineCount(De),Te=Se.textFont.size*((Ie-1)*M-c),Ce=Se.nodeLineWidth/2+_,He=((Se.horizontal?Se.visibleHeight:Se.visibleWidth)-Te)/2;Se.horizontal&&(Se.left?Ce=-Ce:Ce+=Se.visibleWidth);var Xe=Se.horizontal?"":"scale(-1,1)"+s(90);return o(Se.horizontal?Ce:He,Se.horizontal?He:Ce)+Xe}),_e.transition().ease(i.ease).duration(i.duration)}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../registry":647,"./constants":929,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:313}],934:[function(t,P,R){P.exports=function(u,A){for(var T=u.cd,e=[],i=T[0].trace,n=i._sankey.graph.nodes,a=0;a<n.length;a++){var r=n[a];if(!r.partOfGroup){var f=[(r.x0+r.x1)/2,(r.y0+r.y1)/2];i.orientation==="v"&&f.reverse(),A&&A.contains(f,!1,a,u)&&e.push({pointNumber:r.pointNumber})}}return e}},{}],935:[function(t,P,R){var h=t("../../lib");P.exports=function(A,T){for(var e=0;e<A.length;e++)A[e].i=e;h.mergeArray(T.text,A,"tx"),h.mergeArray(T.texttemplate,A,"txt"),h.mergeArray(T.hovertext,A,"htx"),h.mergeArray(T.customdata,A,"data"),h.mergeArray(T.textposition,A,"tp"),T.textfont&&(h.mergeArrayCastPositive(T.textfont.size,A,"ts"),h.mergeArray(T.textfont.color,A,"tc"),h.mergeArray(T.textfont.family,A,"tf"));var i=T.marker;if(i){h.mergeArrayCastPositive(i.size,A,"ms"),h.mergeArrayCastPositive(i.opacity,A,"mo"),h.mergeArray(i.symbol,A,"mx"),h.mergeArray(i.angle,A,"ma"),h.mergeArray(i.standoff,A,"mf"),h.mergeArray(i.color,A,"mc");var n=i.line;i.line&&(h.mergeArray(n.color,A,"mlc"),h.mergeArrayCastPositive(n.width,A,"mlw"));var a=i.gradient;a&&a.type!=="none"&&(h.mergeArray(a.type,A,"mgt"),h.mergeArray(a.color,A,"mgc"))}}},{"../../lib":515}],936:[function(t,P,R){var h=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,u=t("../../plots/template_attributes").texttemplateAttrs,A=t("../../plots/template_attributes").hovertemplateAttrs,T=t("../../components/colorscale/attributes"),e=t("../../plots/font_attributes"),i=t("../../components/drawing/attributes").dash,n=t("../../components/drawing/attributes").pattern,a=t("../../components/drawing"),r=t("./constants"),f=t("../../lib/extend").extendFlat;function o(g){return{valType:"any",dflt:0,editType:"calc"}}function s(g){return{valType:"any",editType:"calc"}}function m(g){return{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"}}P.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:o(),yperiod:o(),xperiod0:s(),yperiod0:s(),xperiodalignment:m(),yperiodalignment:m(),xhoverformat:h("x"),yhoverformat:h("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:u({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:A({},{keys:r.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:f({},i,{editType:"style"}),backoff:{valType:"number",min:0,dflt:"auto",arrayOk:!0,editType:"plot"},simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},fillpattern:n,marker:f({symbol:{valType:"enumerated",values:a.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},angle:{valType:"angle",dflt:0,arrayOk:!0,editType:"plot",anim:!1},angleref:{valType:"enumerated",values:["previous","up"],dflt:"up",editType:"plot",anim:!1},standoff:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"plot",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:f({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},T("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},T("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":374,"../../components/drawing":389,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"./constants":940}],937:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib"),A=t("../../plots/cartesian/axes"),T=t("../../plots/cartesian/align_period"),e=t("../../constants/numerical").BADNUM,i=t("./subtypes"),n=t("./colorscale_calc"),a=t("./arrays_to_calcdata"),r=t("./calc_selection");function f(v,x){var l=v._fullLayout,b=x._xA=A.getFromId(v,x.xaxis||"x","x"),c=x._yA=A.getFromId(v,x.yaxis||"y","y"),M=b.makeCalcdata(x,"x"),_=c.makeCalcdata(x,"y"),y=T(x,b,"x",M),w=T(x,c,"y",_),d=y.vals,C=w.vals,S=x._length,E=new Array(S),k=x.ids,B=p(x,l,b,c),z=!1,F,I,O,N,V,H;m(l,x);var j="x",Z="y",X;if(B)u.pushUnique(B.traceIndices,x._expandedIndex),F=B.orientation==="v",F?(Z="s",X="x"):(j="s",X="y"),V=B.stackgaps==="interpolate";else{var re=s(x,S);o(v,x,b,c,d,C,re)}var ue=!!x.xperiodalignment,K=!!x.yperiodalignment;for(I=0;I<S;I++){var te=E[I]={},G=h(d[I]),Y=h(C[I]);G&&Y?(te[j]=d[I],te[Z]=C[I],ue&&(te.orig_x=M[I],te.xEnd=y.ends[I],te.xStart=y.starts[I]),K&&(te.orig_y=_[I],te.yEnd=w.ends[I],te.yStart=w.starts[I])):B&&(F?G:Y)?(te[X]=F?d[I]:C[I],te.gap=!0,V?(te.s=e,z=!0):te.s=0):te[j]=te[Z]=e,k&&(te.id=String(k[I]))}if(a(E,x),n(v,x),r(E,x),B){for(I=0;I<E.length;)E[I][X]===e?E.splice(I,1):I++;if(u.sort(E,function(q,ae){return q[X]-ae[X]||q.i-ae.i}),z){for(I=0;I<E.length-1&&E[I].gap;)I++;for(H=E[I].s,H||(H=E[I].s=0),O=0;O<I;O++)E[O].s=H;for(N=E.length-1;N>I&&E[N].gap;)N--;for(H=E[N].s,O=E.length-1;O>N;O--)E[O].s=H;for(;I<N;)if(I++,E[I].gap){for(O=I+1;E[O].gap;)O++;for(var ee=E[I-1][X],ne=E[I-1].s,J=(E[O].s-ne)/(E[O][X]-ee);I<O;)E[I].s=ne+(E[I][X]-ee)*J,I++}}}return E}function o(v,x,l,b,c,M,_){var y=x._length,w=v._fullLayout,d=l._id,C=b._id,S=w._firstScatter[g(x)]===x.uid,E=(p(x,w,l,b)||{}).orientation,k=x.fill;l._minDtick=0,b._minDtick=0;var B={padded:!0},z={padded:!0};_&&(B.ppad=z.ppad=_);var F=y<2||c[0]!==c[y-1]||M[0]!==M[y-1];F&&(k==="tozerox"||k==="tonextx"&&(S||E==="h"))?B.tozero=!0:!(x.error_y||{}).visible&&(k==="tonexty"||k==="tozeroy"||!i.hasMarkers(x)&&!i.hasText(x))&&(B.padded=!1,B.ppad=0),F&&(k==="tozeroy"||k==="tonexty"&&(S||E==="v"))?z.tozero=!0:(k==="tonextx"||k==="tozerox")&&(z.padded=!1),d&&(x._extremes[d]=A.findExtremes(l,c,B)),C&&(x._extremes[C]=A.findExtremes(b,M,z))}function s(v,x){if(!!i.hasMarkers(v)){var l=v.marker,b=1.6*(v.marker.sizeref||1),c;if(v.marker.sizemode==="area"?c=function(d){return Math.max(Math.sqrt((d||0)/b),3)}:c=function(d){return Math.max((d||0)/b,3)},u.isArrayOrTypedArray(l.size)){var M={type:"linear"};A.setConvert(M);for(var _=M.makeCalcdata(v.marker,"size"),y=new Array(x),w=0;w<x;w++)y[w]=c(_[w]);return y}else return c(l.size)}}function m(v,x){var l=g(x),b=v._firstScatter;b[l]||(b[l]=x.uid)}function g(v){var x=v.stackgroup;return v.xaxis+v.yaxis+v.type+(x?"-"+x:"")}function p(v,x,l,b){var c=v.stackgroup;if(!!c){var M=x._scatterStackOpts[l._id+b._id][c],_=M.orientation==="v"?b:l;if(_.type==="linear"||_.type==="log")return M}}P.exports={calc:f,calcMarkerSize:s,calcAxisExpansion:o,setFirstScatter:m,getStackOpts:p}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"./arrays_to_calcdata":935,"./calc_selection":938,"./colorscale_calc":939,"./subtypes":961,"fast-isnumeric":190}],938:[function(t,P,R){var h=t("../../lib");P.exports=function(A,T){h.isArrayOrTypedArray(T.selectedpoints)&&h.tagSelected(A,T)}},{"../../lib":515}],939:[function(t,P,R){var h=t("../../components/colorscale/helpers").hasColorscale,u=t("../../components/colorscale/calc"),A=t("./subtypes");P.exports=function(e,i){A.hasLines(i)&&h(i,"line")&&u(e,i,{vals:i.line.color,containerStr:"line",cLetter:"c"}),A.hasMarkers(i)&&(h(i,"marker")&&u(e,i,{vals:i.marker.color,containerStr:"marker",cLetter:"c"}),h(i,"marker.line")&&u(e,i,{vals:i.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"./subtypes":961}],940:[function(t,P,R){P.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],941:[function(t,P,R){var h=t("./calc");P.exports=function(e,i){var n=i.xaxis,a=i.yaxis,r=n._id+a._id,f=e._fullLayout._scatterStackOpts[r];if(!!f){var o=e.calcdata,s,m,g,p,v,x,l,b,c,M,_,y,w,d,C;for(var S in f){M=f[S];var E=M.traceIndices;if(!!E.length){for(_=M.stackgaps==="interpolate",y=M.groupnorm,M.orientation==="v"?(w="x",d="y"):(w="y",d="x"),C=new Array(E.length),s=0;s<C.length;s++)C[s]=!1;x=o[E[0]];var k=new Array(x.length);for(s=0;s<x.length;s++)k[s]=x[s][w];for(s=1;s<E.length;s++){for(v=o[E[s]],m=g=0;m<v.length;m++){for(l=v[m][w];l>k[g]&&g<k.length;g++)u(v,m,k[g],s,C,_,w),m++;if(l!==k[g]){for(p=0;p<s;p++)u(o[E[p]],g,l,p,C,_,w);k.splice(g,0,l)}g++}for(;g<k.length;g++)u(v,m,k[g],s,C,_,w),m++}var B=k.length;for(m=0;m<x.length;m++){for(b=x[m][d]=x[m].s,s=1;s<E.length;s++)v=o[E[s]],v[0].trace._rawLength=v[0].trace._length,v[0].trace._length=B,b+=v[m].s,v[m][d]=b;if(y)for(c=(y==="fraction"?b:b/100)||1,s=0;s<E.length;s++){var z=o[E[s]][m];z[d]/=c,z.sNorm=z.s/c}}for(s=0;s<E.length;s++){v=o[E[s]];var F=v[0].trace,I=h.calcMarkerSize(F,F._rawLength),O=Array.isArray(I);if(I&&C[s]||O){var N=I;for(I=new Array(B),m=0;m<B;m++)I[m]=v[m].gap?0:O?N[v[m].i]:N}var V=new Array(B),H=new Array(B);for(m=0;m<B;m++)V[m]=v[m].x,H[m]=v[m].y;h.calcAxisExpansion(e,F,n,a,V,H,I),v[0].t.orientation=M.orientation}}}}};function u(T,e,i,n,a,r,f){a[n]=!0;var o={i:null,gap:!0,s:0};if(o[f]=i,T.splice(e,0,o),e&&i===T[e-1][f]){var s=T[e-1];o.s=s.s,o.i=s.i,o.gap=s.gap}else r&&(o.s=A(T,e,i,f));e||(T[0].t=T[1].t,T[0].trace=T[1].trace,delete T[1].t,delete T[1].trace)}function A(T,e,i,n){var a=T[e-1],r=T[e+1];return r?a?a.s+(r.s-a.s)*(i-a[n])/(r[n]-a[n]):r.s:a.s}},{"./calc":937}],942:[function(t,P,R){P.exports=function(u){for(var A=0;A<u.length;A++){var T=u[A];if(T.type==="scatter"){var e=T.fill;if(!(e==="none"||e==="toself")&&(T.opacity=void 0,e==="tonexty"||e==="tonextx"))for(var i=A-1;i>=0;i--){var n=u[i];if(n.type==="scatter"&&n.xaxis===T.xaxis&&n.yaxis===T.yaxis){n.opacity=void 0;break}}}}}},{}],943:[function(t,P,R){var h=t("../../lib"),u=t("../../registry"),A=t("./attributes"),T=t("./constants"),e=t("./subtypes"),i=t("./xy_defaults"),n=t("./period_defaults"),a=t("./stack_defaults"),r=t("./marker_defaults"),f=t("./line_defaults"),o=t("./line_shape_defaults"),s=t("./text_defaults"),m=t("./fillcolor_defaults"),g=t("../../lib").coercePattern;P.exports=function(v,x,l,b){function c(E,k){return h.coerce(v,x,A,E,k)}var M=i(v,x,b,c);if(M||(x.visible=!1),!!x.visible){n(v,x,b,c),c("xhoverformat"),c("yhoverformat");var _=a(v,x,b,c),y=!_&&M<T.PTS_LINESONLY?"lines+markers":"lines";c("text"),c("hovertext"),c("mode",y),e.hasLines(x)&&(f(v,x,l,b,c,{backoff:!0}),o(v,x,c),c("connectgaps"),c("line.simplify")),e.hasMarkers(x)&&r(v,x,l,b,c,{gradient:!0}),e.hasText(x)&&(c("texttemplate"),s(v,x,b,c));var w=[];(e.hasMarkers(x)||e.hasText(x))&&(c("cliponaxis"),c("marker.maxdisplayed"),w.push("points")),c("fill",_?_.fillDflt:"none"),x.fill!=="none"&&(m(v,x,l,c),e.hasLines(x)||o(v,x,c),g(c,"fillpattern",x.fillcolor,!1));var d=(x.line||{}).color,C=(x.marker||{}).color;(x.fill==="tonext"||x.fill==="toself")&&w.push("fills"),c("hoveron",w.join("+")||"points"),x.hoveron!=="fills"&&c("hovertemplate");var S=u.getComponentMethod("errorbars","supplyDefaults");S(v,x,d||C||l,{axis:"y"}),S(v,x,d||C||l,{axis:"x",inherit:"y"}),h.coerceSelectionMarkerOpacity(x,c)}}},{"../../lib":515,"../../registry":647,"./attributes":936,"./constants":940,"./fillcolor_defaults":944,"./line_defaults":949,"./line_shape_defaults":951,"./marker_defaults":955,"./period_defaults":956,"./stack_defaults":959,"./subtypes":961,"./text_defaults":962,"./xy_defaults":963}],944:[function(t,P,R){var h=t("../../components/color"),u=t("../../lib").isArrayOrTypedArray;P.exports=function(T,e,i,n){var a=!1;if(e.marker){var r=e.marker.color,f=(e.marker.line||{}).color;r&&!u(r)?a=r:f&&!u(f)&&(a=f)}n("fillcolor",h.addOpacity((e.line||{}).color||a||i,.5))}},{"../../components/color":367,"../../lib":515}],945:[function(t,P,R){var h=t("../../plots/cartesian/axes");P.exports=function(A,T,e){var i={},n={_fullLayout:e},a=h.getFromTrace(n,T,"x"),r=h.getFromTrace(n,T,"y");return i.xLabel=h.tickText(a,a.c2l(A.x),!0).text,i.yLabel=h.tickText(r,r.c2l(A.y),!0).text,i}},{"../../plots/cartesian/axes":566}],946:[function(t,P,R){var h=t("../../components/color"),u=t("./subtypes");P.exports=function(T,e){var i,n;if(T.mode==="lines")return i=T.line.color,i&&h.opacity(i)?i:T.fillcolor;if(T.mode==="none")return T.fill?T.fillcolor:"";var a=e.mcc||(T.marker||{}).color,r=e.mlcc||((T.marker||{}).line||{}).color;return n=a&&h.opacity(a)?a:r&&h.opacity(r)&&(e.mlw||((T.marker||{}).line||{}).width)?r:"",n?h.opacity(n)<.3?h.addOpacity(n,.3):n:(i=(T.line||{}).color,i&&h.opacity(i)&&u.hasLines(T)&&T.line.width?i:T.fillcolor)}},{"../../components/color":367,"./subtypes":961}],947:[function(t,P,R){var h=t("../../lib"),u=t("../../components/fx"),A=t("../../registry"),T=t("./get_trace_color"),e=t("../../components/color"),i=h.fillText;P.exports=function(a,r,f,o){var s=a.cd,m=s[0].trace,g=a.xa,p=a.ya,v=g.c2p(r),x=p.c2p(f),l=[v,x],b=m.hoveron||"",c=m.mode.indexOf("markers")!==-1?3:.5,M=!!m.xperiodalignment,_=!!m.yperiodalignment;if(b.indexOf("points")!==-1){var y=function(ie){if(M){var se=g.c2p(ie.xStart),xe=g.c2p(ie.xEnd);return v>=Math.min(se,xe)&&v<=Math.max(se,xe)?0:1/0}var oe=Math.max(3,ie.mrc||0),he=1-1/oe,be=Math.abs(g.c2p(ie.x)-v);return be<oe?he*be/oe:be-oe+he},w=function(ie){if(_){var se=p.c2p(ie.yStart),xe=p.c2p(ie.yEnd);return x>=Math.min(se,xe)&&x<=Math.max(se,xe)?0:1/0}var oe=Math.max(3,ie.mrc||0),he=1-1/oe,be=Math.abs(p.c2p(ie.y)-x);return be<oe?he*be/oe:be-oe+he},d=function(ie){var se=Math.max(c,ie.mrc||0),xe=g.c2p(ie.x)-v,oe=p.c2p(ie.y)-x;return Math.max(Math.sqrt(xe*xe+oe*oe)-se,1-c/se)},C=u.getDistanceFunction(o,y,w,d);if(u.getClosest(s,C,a),a.index!==!1){var S=s[a.index],E=g.c2p(S.x,!0),k=p.c2p(S.y,!0),B=S.mrc||1;a.index=S.i;var z=s[0].t.orientation,F=z&&(S.sNorm||S.s),I=z==="h"?F:S.orig_x!==void 0?S.orig_x:S.x,O=z==="v"?F:S.orig_y!==void 0?S.orig_y:S.y;return h.extendFlat(a,{color:T(m,S),x0:E-B,x1:E+B,xLabelVal:I,y0:k-B,y1:k+B,yLabelVal:O,spikeDistance:d(S),hovertemplate:m.hovertemplate}),i(S,m,a),A.getComponentMethod("errorbars","hoverInfo")(S,m,a),[a]}}if(b.indexOf("fills")!==-1&&m._polygons){var N=m._polygons,V=[],H=!1,j=1/0,Z=-1/0,X=1/0,re=-1/0,ue,K,te,G,Y,ee,ne,J,q;for(ue=0;ue<N.length;ue++)te=N[ue],te.contains(l)&&(H=!H,V.push(te),X=Math.min(X,te.ymin),re=Math.max(re,te.ymax));if(H){X=Math.max(X,0),re=Math.min(re,p._length);var ae=(X+re)/2;for(ue=0;ue<V.length;ue++)for(G=V[ue].pts,K=1;K<G.length;K++)J=G[K-1][1],q=G[K][1],J>ae!=q>=ae&&(ee=G[K-1][0],ne=G[K][0],q-J&&(Y=ee+(ne-ee)*(ae-J)/(q-J),j=Math.min(j,Y),Z=Math.max(Z,Y)));j=Math.max(j,0),Z=Math.min(Z,g._length);var le=e.defaultLine;return e.opacity(m.fillcolor)?le=m.fillcolor:e.opacity((m.line||{}).color)&&(le=m.line.color),h.extendFlat(a,{distance:a.maxHoverDistance,x0:j,x1:Z,y0:ae,y1:ae,color:le,hovertemplate:!1}),delete a.index,m.text&&!Array.isArray(m.text)?a.text=String(m.text):a.text=m.name,[a]}}}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../registry":647,"./get_trace_color":946}],948:[function(t,P,R){var h=t("./subtypes");P.exports={hasLines:h.hasLines,hasMarkers:h.hasMarkers,hasText:h.hasText,isBubble:h.isBubble,attributes:t("./attributes"),supplyDefaults:t("./defaults"),crossTraceDefaults:t("./cross_trace_defaults"),calc:t("./calc").calc,crossTraceCalc:t("./cross_trace_calc"),arraysToCalcdata:t("./arrays_to_calcdata"),plot:t("./plot"),colorbar:t("./marker_colorbar"),formatLabels:t("./format_labels"),style:t("./style").style,styleOnSelect:t("./style").styleOnSelect,hoverPoints:t("./hover"),selectPoints:t("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./arrays_to_calcdata":935,"./attributes":936,"./calc":937,"./cross_trace_calc":941,"./cross_trace_defaults":942,"./defaults":943,"./format_labels":945,"./hover":947,"./marker_colorbar":954,"./plot":957,"./select":958,"./style":960,"./subtypes":961}],949:[function(t,P,R){var h=t("../../lib").isArrayOrTypedArray,u=t("../../components/colorscale/helpers").hasColorscale,A=t("../../components/colorscale/defaults");P.exports=function(e,i,n,a,r,f){f||(f={});var o=(e.marker||{}).color;if(r("line.color",n),u(e,"line"))A(e,i,a,r,{prefix:"line.",cLetter:"c"});else{var s=(h(o)?!1:o)||n;r("line.color",s)}r("line.width"),f.noDash||r("line.dash"),f.backoff&&r("line.backoff")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],950:[function(t,P,R){var h=t("../../components/drawing"),u=t("../../constants/numerical"),A=u.BADNUM,T=u.LOG_CLIP,e=T+.5,i=T-.5,n=t("../../lib"),a=n.segmentsIntersect,r=n.constrain,f=t("./constants");P.exports=function(s,m){var g=m.trace||{},p=m.xaxis,v=m.yaxis,x=p.type==="log",l=v.type==="log",b=p._length,c=v._length,M=m.backoff,_=g.marker,y=m.connectGaps,w=m.baseTolerance,d=m.shape,C=d==="linear",S=g.fill&&g.fill!=="none",E=[],k=f.minTolerance,B=s.length,z=new Array(B),F=0,I,O,N,V,H,j,Z,X,re,ue,K,te,G,Y,ee,ne;function J(Mt){var Ht=s[Mt];if(!Ht)return!1;var Rt=m.linearized?p.l2p(Ht.x):p.c2p(Ht.x),Vt=m.linearized?v.l2p(Ht.y):v.c2p(Ht.y);if(Rt===A){if(x&&(Rt=p.c2p(Ht.x,!0)),Rt===A)return!1;l&&Vt===A&&(Rt*=Math.abs(p._m*c*(p._m>0?e:i)/(v._m*b*(v._m>0?e:i)))),Rt*=1e3}if(Vt===A){if(l&&(Vt=v.c2p(Ht.y,!0)),Vt===A)return!1;Vt*=1e3}return[Rt,Vt]}function q(Mt,Ht,Rt,Vt){var Jt=Rt-Mt,Yt=Vt-Ht,or=.5-Mt,Hr=.5-Ht,an=Jt*Jt+Yt*Yt,Kr=Jt*or+Yt*Hr;if(Kr>0&&Kr<an){var ot=or*Yt-Hr*Jt;if(ot*ot<an)return!0}}var ae,le;function ie(Mt,Ht){var Rt=Mt[0]/b,Vt=Mt[1]/c,Jt=Math.max(0,-Rt,Rt-1,-Vt,Vt-1);return Jt&&ae!==void 0&&q(Rt,Vt,ae,le)&&(Jt=0),Jt&&Ht&&q(Rt,Vt,Ht[0]/b,Ht[1]/c)&&(Jt=0),(1+f.toleranceGrowth*Jt)*w}function se(Mt,Ht){var Rt=Mt[0]-Ht[0],Vt=Mt[1]-Ht[1];return Math.sqrt(Rt*Rt+Vt*Vt)}var xe=f.maxScreensAway,oe=-b*xe,he=b*(1+xe),be=-c*xe,me=c*(1+xe),_e=[[oe,be,he,be],[he,be,he,me],[he,me,oe,me],[oe,me,oe,be]],Se,De,Ie,Te,Ce,He;function Xe(Mt,Ht){for(var Rt=[],Vt=0,Jt=0;Jt<4;Jt++){var Yt=_e[Jt],or=a(Mt[0],Mt[1],Ht[0],Ht[1],Yt[0],Yt[1],Yt[2],Yt[3]);or&&(!Vt||Math.abs(or.x-Rt[0][0])>1||Math.abs(or.y-Rt[0][1])>1)&&(or=[or.x,or.y],Vt&&se(or,Mt)<se(Rt[0],Mt)?Rt.unshift(or):Rt.push(or),Vt++)}return Rt}function Be(Mt){if(Mt[0]<oe||Mt[0]>he||Mt[1]<be||Mt[1]>me)return[r(Mt[0],oe,he),r(Mt[1],be,me)]}function Re(Mt,Ht){if(Mt[0]===Ht[0]&&(Mt[0]===oe||Mt[0]===he)||Mt[1]===Ht[1]&&(Mt[1]===be||Mt[1]===me))return!0}function We(Mt,Ht){var Rt=[],Vt=Be(Mt),Jt=Be(Ht);return Vt&&Jt&&Re(Vt,Jt)||(Vt&&Rt.push(Vt),Jt&&Rt.push(Jt)),Rt}function vt(Mt,Ht,Rt){return function(Vt,Jt){var Yt=Be(Vt),or=Be(Jt),Hr=[];if(Yt&&or&&Re(Yt,or))return Hr;Yt&&Hr.push(Yt),or&&Hr.push(or);var an=2*n.constrain((Vt[Mt]+Jt[Mt])/2,Ht,Rt)-((Yt||Vt)[Mt]+(or||Jt)[Mt]);if(an){var Kr;Yt&&or?Kr=an>0==Yt[Mt]>or[Mt]?Yt:or:Kr=Yt||or,Kr[Mt]+=an}return Hr}}var Pt;d==="linear"||d==="spline"?Pt=Xe:d==="hv"||d==="vh"?Pt=We:d==="hvh"?Pt=vt(0,oe,he):d==="vhv"&&(Pt=vt(1,be,me));function Zt(Mt,Ht){var Rt=Ht[0]-Mt[0],Vt=(Ht[1]-Mt[1])/Rt,Jt=(Mt[1]*Ht[0]-Ht[1]*Mt[0])/Rt;return Jt>0?[Vt>0?oe:he,me]:[Vt>0?he:oe,be]}function zt(Mt){var Ht=Mt[0],Rt=Mt[1],Vt=Ht===z[F-1][0],Jt=Rt===z[F-1][1];if(!(Vt&&Jt))if(F>1){var Yt=Ht===z[F-2][0],or=Rt===z[F-2][1];Vt&&(Ht===oe||Ht===he)&&Yt?or?F--:z[F-1]=Mt:Jt&&(Rt===be||Rt===me)&&or?Yt?F--:z[F-1]=Mt:z[F++]=Mt}else z[F++]=Mt}function At(Mt){z[F-1][0]!==Mt[0]&&z[F-1][1]!==Mt[1]&&zt([Ie,Te]),zt(Mt),Ce=null,Ie=Te=0}var Wt=n.isArrayOrTypedArray(_);function Bt(Mt){if(Mt&&M&&(Mt.i=I,Mt.d=s,Mt.trace=g,Mt.marker=Wt?_[Mt.i]:_,Mt.backoff=M),ae=Mt[0]/b,le=Mt[1]/c,Se=Mt[0]<oe?oe:Mt[0]>he?he:0,De=Mt[1]<be?be:Mt[1]>me?me:0,Se||De){if(!F)z[F++]=[Se||Mt[0],De||Mt[1]];else if(Ce){var Ht=Pt(Ce,Mt);Ht.length>1&&(At(Ht[0]),z[F++]=Ht[1])}else He=Pt(z[F-1],Mt)[0],z[F++]=He;var Rt=z[F-1];Se&&De&&(Rt[0]!==Se||Rt[1]!==De)?(Ce&&(Ie!==Se&&Te!==De?zt(Ie&&Te?Zt(Ce,Mt):[Ie||Se,Te||De]):Ie&&Te&&zt([Ie,Te])),zt([Se,De])):Ie-Se&&Te-De&&zt([Se||Ie,De||Te]),Ce=Mt,Ie=Se,Te=De}else Ce&&At(Pt(Ce,Mt)[0]),z[F++]=Mt}for(I=0;I<B;I++)if(O=J(I),!!O){for(F=0,Ce=null,Bt(O),I++;I<B;I++){if(V=J(I),!V){if(y)continue;break}if(!C||!m.simplify){Bt(V);continue}var Ct=J(I+1);if(ue=se(V,O),!(!(S&&(F===0||F===B-1))&&ue<ie(V,Ct)*k)){for(X=[(V[0]-O[0])/ue,(V[1]-O[1])/ue],H=O,K=ue,te=Y=ee=0,Z=!1,N=V,I++;I<s.length;I++){if(j=Ct,Ct=J(I+1),!j){if(y)continue;break}if(re=[j[0]-O[0],j[1]-O[1]],ne=re[0]*X[1]-re[1]*X[0],Y=Math.min(Y,ne),ee=Math.max(ee,ne),ee-Y>ie(j,Ct))break;N=j,G=re[0]*X[0]+re[1]*X[1],G>K?(K=G,V=j,Z=!1):G<te&&(te=G,H=j,Z=!0)}if(Z?(Bt(V),N!==H&&Bt(H)):(H!==O&&Bt(H),N!==V&&Bt(V)),Bt(N),I>=s.length||!j)break;Bt(j),O=j}}Ce&&zt([Ie||Ce[0],Te||Ce[1]]),E.push(z.slice(0,F))}var Ze=d.slice(d.length-1);if(M&&Ze!=="h"&&Ze!=="v"){for(var nt=!1,Ye=-1,Ee=[],Ge=0;Ge<E.length;Ge++)for(var Je=0;Je<E[Ge].length-1;Je++){var qe=E[Ge][Je],Tt=E[Ge][Je+1],mt=h.applyBackoff(Tt,qe);(mt[0]!==Tt[0]||mt[1]!==Tt[1])&&(nt=!0),Ee[Ye+1]||(Ye++,Ee[Ye]=[qe,[mt[0],mt[1]]])}return nt?Ee:E}return E}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"./constants":940}],951:[function(t,P,R){P.exports=function(u,A,T){var e=T("line.shape");e==="spline"&&T("line.smoothing")}},{}],952:[function(t,P,R){var h={tonextx:1,tonexty:1,tonext:1};P.exports=function(A,T,e){var i,n,a,r,f,o={},s=!1,m=-1,g=0,p=-1;for(n=0;n<e.length;n++)i=e[n][0].trace,a=i.stackgroup||"",a?a in o?f=o[a]:(f=o[a]=g,g++):i.fill in h&&p>=0?f=p:(f=p=g,g++),f<m&&(s=!0),i._groupIndex=m=f;var v=e.slice();s&&v.sort(function(l,b){var c=l[0].trace,M=b[0].trace;return c._groupIndex-M._groupIndex||c.index-M.index});var x={};for(n=0;n<v.length;n++)i=v[n][0].trace,a=i.stackgroup||"",i.visible===!0?(i._nexttrace=null,i.fill in h&&(r=x[a],i._prevtrace=r||null,r&&(r._nexttrace=i)),i._ownfill=i.fill&&(i.fill.substr(0,6)==="tozero"||i.fill==="toself"||i.fill.substr(0,2)==="to"&&!i._prevtrace),x[a]=i):i._prevtrace=i._nexttrace=i._ownfill=null;return v}},{}],953:[function(t,P,R){var h=t("fast-isnumeric");P.exports=function(A,T){T||(T=2);var e=A.marker,i=e.sizeref||1,n=e.sizemin||0,a=e.sizemode==="area"?function(r){return Math.sqrt(r/i)}:function(r){return r/i};return function(r){var f=a(r/T);return h(f)&&f>0?Math.max(f,n):0}}},{"fast-isnumeric":190}],954:[function(t,P,R){P.exports={container:"marker",min:"cmin",max:"cmax"}},{}],955:[function(t,P,R){var h=t("../../components/color"),u=t("../../components/colorscale/helpers").hasColorscale,A=t("../../components/colorscale/defaults"),T=t("./subtypes");P.exports=function(i,n,a,r,f,o){var s=T.isBubble(i),m=(i.line||{}).color,g;if(o=o||{},m&&(a=m),f("marker.symbol"),f("marker.opacity",s?.7:1),f("marker.size"),o.noAngle||(f("marker.angle"),o.noAngleRef||f("marker.angleref"),o.noStandOff||f("marker.standoff")),f("marker.color",a),u(i,"marker")&&A(i,n,r,f,{prefix:"marker.",cLetter:"c"}),o.noSelect||(f("selected.marker.color"),f("unselected.marker.color"),f("selected.marker.size"),f("unselected.marker.size")),o.noLine||(m&&!Array.isArray(m)&&n.marker.color!==m?g=m:s?g=h.background:g=h.defaultLine,f("marker.line.color",g),u(i,"marker.line")&&A(i,n,r,f,{prefix:"marker.line.",cLetter:"c"}),f("marker.line.width",s?1:0)),s&&(f("marker.sizeref"),f("marker.sizemin"),f("marker.sizemode")),o.gradient){var p=f("marker.gradient.type");p!=="none"&&f("marker.gradient.color")}}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"./subtypes":961}],956:[function(t,P,R){var h=t("../../lib").dateTick0,u=t("../../constants/numerical"),A=u.ONEWEEK;function T(e,i){return e%A===0?h(i,1):h(i,0)}P.exports=function(i,n,a,r,f){if(f||(f={x:!0,y:!0}),f.x){var o=r("xperiod");o&&(r("xperiod0",T(o,n.xcalendar)),r("xperiodalignment"))}if(f.y){var s=r("yperiod");s&&(r("yperiod0",T(s,n.ycalendar)),r("yperiodalignment"))}}},{"../../constants/numerical":491,"../../lib":515}],957:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../registry"),A=t("../../lib"),T=A.ensureSingle,e=A.identity,i=t("../../components/drawing"),n=t("./subtypes"),a=t("./line_points"),r=t("./link_traces"),f=t("../../lib/polygon").tester;P.exports=function(p,v,x,l,b,c){var M,_,y=!b,w=!!b&&b.duration>0,d=r(p,v,x);if(M=l.selectAll("g.trace").data(d,function(S){return S[0].trace.uid}),M.enter().append("g").attr("class",function(S){return"trace scatter trace"+S[0].trace.uid}).style("stroke-miterlimit",2),M.order(),o(p,M,v),w){c&&(_=c());var C=h.transition().duration(b.duration).ease(b.easing).each("end",function(){_&&_()}).each("interrupt",function(){_&&_()});C.each(function(){l.selectAll("g.trace").each(function(S,E){s(p,E,v,S,d,this,b)})})}else M.each(function(S,E){s(p,E,v,S,d,this,b)});y&&M.exit().remove(),l.selectAll("path:not([d])").remove()};function o(g,p,v){p.each(function(x){var l=T(h.select(this),"g","fills");i.setClipUrl(l,v.layerClipId,g);var b=x[0].trace,c=[];b._ownfill&&c.push("_ownFill"),b._nexttrace&&c.push("_nextFill");var M=l.selectAll("g").data(c,e);M.enter().append("g"),M.exit().each(function(_){b[_]=null}).remove(),M.order().each(function(_){b[_]=T(h.select(this),"path","js-fill")})})}function s(g,p,v,x,l,b,c){var M;m(g,p,v,x,l);var _=!!c&&c.duration>0;function y(Ie){return _?Ie.transition():Ie}var w=v.xaxis,d=v.yaxis,C=x[0].trace,S=C.line,E=h.select(b),k=T(E,"g","errorbars"),B=T(E,"g","lines"),z=T(E,"g","points"),F=T(E,"g","text");if(u.getComponentMethod("errorbars","plot")(g,k,v,c),C.visible!==!0)return;y(E).style("opacity",C.opacity);var I,O,N=C.fill.charAt(C.fill.length-1);N!=="x"&&N!=="y"&&(N=""),x[0][v.isRangePlot?"nodeRangePlot3":"node3"]=E;var V="",H=[],j=C._prevtrace;j&&(V=j._prevRevpath||"",O=j._nextFill,H=j._polygons);var Z,X,re="",ue="",K,te,G,Y,ee,ne,J,q=[],ae=A.noop;if(I=C._ownFill,n.hasLines(C)||C.fill!=="none"){for(O&&O.datum(x),["hv","vh","hvh","vhv"].indexOf(S.shape)!==-1?(K=i.steps(S.shape),te=i.steps(S.shape.split("").reverse().join(""))):S.shape==="spline"?K=te=function(Ie){var Te=Ie[Ie.length-1];return Ie.length>1&&Ie[0][0]===Te[0]&&Ie[0][1]===Te[1]?i.smoothclosed(Ie.slice(1),S.smoothing):i.smoothopen(Ie,S.smoothing)}:K=te=function(Ie){return"M"+Ie.join("L")},G=function(Ie){return te(Ie.reverse())},q=a(x,{xaxis:w,yaxis:d,trace:C,connectGaps:C.connectgaps,baseTolerance:Math.max(S.width||1,3)/4,shape:S.shape,backoff:S.backoff,simplify:S.simplify,fill:C.fill}),J=C._polygons=new Array(q.length),M=0;M<q.length;M++)C._polygons[M]=f(q[M]);q.length&&(Y=q[0][0],ee=q[q.length-1],ne=ee[ee.length-1]),ae=function(Ie){return function(Te){if(Z=K(Te),X=G(Te),re?N?(re+="L"+Z.substr(1),ue=X+("L"+ue.substr(1))):(re+="Z"+Z,ue=X+"Z"+ue):(re=Z,ue=X),n.hasLines(C)&&Te.length>1){var Ce=h.select(this);if(Ce.datum(x),Ie)y(Ce.style("opacity",0).attr("d",Z).call(i.lineGroupStyle)).style("opacity",1);else{var He=y(Ce);He.attr("d",Z),i.singleLineStyle(x,He)}}}}}var le=B.selectAll(".js-line").data(q);y(le.exit()).style("opacity",0).remove(),le.each(ae(!1)),le.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(i.lineGroupStyle).each(ae(!0)),i.setClipUrl(le,v.layerClipId,g);function ie(Ie){y(Ie).attr("d","M0,0Z")}q.length?(I?(I.datum(x),Y&&ne&&(N?(N==="y"?Y[1]=ne[1]=d.c2p(0,!0):N==="x"&&(Y[0]=ne[0]=w.c2p(0,!0)),y(I).attr("d","M"+ne+"L"+Y+"L"+re.substr(1)).call(i.singleFillStyle,g)):y(I).attr("d",re+"Z").call(i.singleFillStyle,g))):O&&(C.fill.substr(0,6)==="tonext"&&re&&V?(C.fill==="tonext"?y(O).attr("d",re+"Z"+V+"Z").call(i.singleFillStyle,g):y(O).attr("d",re+"L"+V.substr(1)+"Z").call(i.singleFillStyle,g),C._polygons=C._polygons.concat(H)):(ie(O),C._polygons=null)),C._prevRevpath=ue,C._prevPolygons=J):(I?ie(I):O&&ie(O),C._polygons=C._prevRevpath=C._prevPolygons=null);function se(Ie){return Ie.filter(function(Te){return!Te.gap&&Te.vis})}function xe(Ie){return Ie.filter(function(Te){return Te.vis})}function oe(Ie){return Ie.filter(function(Te){return!Te.gap})}function he(Ie){return Ie.id}function be(Ie){if(Ie.ids)return he}function me(){return!1}function _e(Ie,Te,Ce){var He,Xe,Be,Re=Ce[0].trace,We=n.hasMarkers(Re),vt=n.hasText(Re),Pt=be(Re),Zt=me,zt=me;if(We||vt){var At=e,Wt=Re.stackgroup,Bt=Wt&&g._fullLayout._scatterStackOpts[w._id+d._id][Wt].stackgaps==="infer zero";Re.marker.maxdisplayed||Re._needsCull?At=Bt?xe:se:Wt&&!Bt&&(At=oe),We&&(Zt=At),vt&&(zt=At)}Xe=Ie.selectAll("path.point"),He=Xe.data(Zt,Pt);var Ct=He.enter().append("path").classed("point",!0);_&&Ct.call(i.pointStyle,Re,g).call(i.translatePoints,w,d).style("opacity",0).transition().style("opacity",1),He.order();var Ze;We&&(Ze=i.makePointStyleFns(Re)),He.each(function(nt){var Ye=h.select(this),Ee=y(Ye);Be=i.translatePoint(nt,Ee,w,d),Be?(i.singlePointStyle(nt,Ee,Re,Ze,g),v.layerClipId&&i.hideOutsideRangePoint(nt,Ee,w,d,Re.xcalendar,Re.ycalendar),Re.customdata&&Ye.classed("plotly-customdata",nt.data!==null&&nt.data!==void 0)):Ee.remove()}),_?He.exit().transition().style("opacity",0).remove():He.exit().remove(),Xe=Te.selectAll("g"),He=Xe.data(zt,Pt),He.enter().append("g").classed("textpoint",!0).append("text"),He.order(),He.each(function(nt){var Ye=h.select(this),Ee=y(Ye.select("text"));Be=i.translatePoint(nt,Ee,w,d),Be?v.layerClipId&&i.hideOutsideRangePoint(nt,Ye,w,d,Re.xcalendar,Re.ycalendar):Ye.remove()}),He.selectAll("text").call(i.textPointStyle,Re,g).each(function(nt){var Ye=w.c2p(nt.x),Ee=d.c2p(nt.y);h.select(this).selectAll("tspan.line").each(function(){y(h.select(this)).attr({x:Ye,y:Ee})})}),He.exit().remove()}z.datum(x),F.datum(x),_e(z,F,x);var Se=C.cliponaxis===!1,De=Se?null:v.layerClipId;i.setClipUrl(z,De,g),i.setClipUrl(F,De,g)}function m(g,p,v,x,l){var b=v.xaxis,c=v.yaxis,M=h.extent(A.simpleMap(b.range,b.r2c)),_=h.extent(A.simpleMap(c.range,c.r2c)),y=x[0].trace;if(!!n.hasMarkers(y)){var w=y.marker.maxdisplayed;if(w!==0){var d=x.filter(function(k){return k.x>=M[0]&&k.x<=M[1]&&k.y>=_[0]&&k.y<=_[1]}),C=Math.ceil(d.length/w),S=0;l.forEach(function(k,B){var z=k[0].trace;n.hasMarkers(z)&&z.marker.maxdisplayed>0&&B<p&&S++});var E=Math.round(S*C/3+Math.floor(S/3)*C/7.1);x.forEach(function(k){delete k.vis}),d.forEach(function(k,B){Math.round((B+E)%C)===0&&(k.vis=!0)})}}}},{"../../components/drawing":389,"../../lib":515,"../../lib/polygon":527,"../../registry":647,"./line_points":950,"./link_traces":952,"./subtypes":961,"@plotly/d3":58}],958:[function(t,P,R){var h=t("./subtypes");P.exports=function(A,T){var e=A.cd,i=A.xaxis,n=A.yaxis,a=[],r=e[0].trace,f,o,s,m,g=!h.hasMarkers(r)&&!h.hasText(r);if(g)return[];if(T===!1)for(f=0;f<e.length;f++)e[f].selected=0;else for(f=0;f<e.length;f++)o=e[f],s=i.c2p(o.x),m=n.c2p(o.y),o.i!==null&&T.contains([s,m],!1,f,A)?(a.push({pointNumber:o.i,x:i.c2d(o.x),y:n.c2d(o.y)}),o.selected=1):o.selected=0;return a}},{"./subtypes":961}],959:[function(t,P,R){var h=["orientation","groupnorm","stackgaps"];P.exports=function(A,T,e,i){var n=e._scatterStackOpts,a=i("stackgroup");if(a){var r=T.xaxis+T.yaxis,f=n[r];f||(f=n[r]={});var o=f[a],s=!1;o?o.traces.push(T):(o=f[a]={traceIndices:[],traces:[T]},s=!0);for(var m={orientation:T.x&&!T.y?"h":"v"},g=0;g<h.length;g++){var p=h[g],v=p+"Found";if(!o[v]){var x=A[p]!==void 0,l=p==="orientation";if((x||s)&&(o[p]=i(p,m[p]),l&&(o.fillDflt=o[p]==="h"?"tonextx":"tonexty"),x&&(o[v]=!0,!s&&(delete o.traces[0][p],l))))for(var b=0;b<o.traces.length-1;b++){var c=o.traces[b];c._input.fill!==c.fill&&(c.fill=o.fillDflt)}}}return o}}},{}],960:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/drawing"),A=t("../../registry");function T(a){var r=h.select(a).selectAll("g.trace.scatter");r.style("opacity",function(f){return f[0].trace.opacity}),r.selectAll("g.points").each(function(f){var o=h.select(this),s=f.trace||f[0].trace;e(o,s,a)}),r.selectAll("g.text").each(function(f){var o=h.select(this),s=f.trace||f[0].trace;i(o,s,a)}),r.selectAll("g.trace path.js-line").call(u.lineGroupStyle),r.selectAll("g.trace path.js-fill").call(u.fillGroupStyle,a),A.getComponentMethod("errorbars","style")(r)}function e(a,r,f){u.pointStyle(a.selectAll("path.point"),r,f)}function i(a,r,f){u.textPointStyle(a.selectAll("text"),r,f)}function n(a,r,f){var o=r[0].trace;o.selectedpoints?(u.selectedPointStyle(f.selectAll("path.point"),o),u.selectedTextStyle(f.selectAll("text"),o)):(e(f,o,a),i(f,o,a))}P.exports={style:T,stylePoints:e,styleText:i,styleOnSelect:n}},{"../../components/drawing":389,"../../registry":647,"@plotly/d3":58}],961:[function(t,P,R){var h=t("../../lib");P.exports={hasLines:function(u){return u.visible&&u.mode&&u.mode.indexOf("lines")!==-1},hasMarkers:function(u){return u.visible&&(u.mode&&u.mode.indexOf("markers")!==-1||u.type==="splom")},hasText:function(u){return u.visible&&u.mode&&u.mode.indexOf("text")!==-1},isBubble:function(u){return h.isPlainObject(u.marker)&&h.isArrayOrTypedArray(u.marker.size)}}},{"../../lib":515}],962:[function(t,P,R){var h=t("../../lib");P.exports=function(u,A,T,e,i){i=i||{},e("textposition"),h.coerceFont(e,"textfont",T.font),i.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":515}],963:[function(t,P,R){var h=t("../../lib"),u=t("../../registry");P.exports=function(T,e,i,n){var a=n("x"),r=n("y"),f,o=u.getComponentMethod("calendars","handleTraceDefaults");if(o(T,e,["x","y"],i),a){var s=h.minRowLength(a);r?f=Math.min(s,h.minRowLength(r)):(f=s,n("y0"),n("dy"))}else{if(!r)return 0;f=h.minRowLength(r),n("x0"),n("dx")}return e._length=f,f}},{"../../lib":515,"../../registry":647}],964:[function(t,P,R){var h=t("../scatter/attributes"),u=t("../../components/colorscale/attributes"),A=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,T=t("../../plots/template_attributes").hovertemplateAttrs,e=t("../../plots/template_attributes").texttemplateAttrs,i=t("../../plots/attributes"),n=t("../../constants/gl3d_dashes"),a=t("../../constants/gl3d_markers"),r=t("../../lib/extend").extendFlat,f=t("../../plot_api/edit_types").overrideAll,o=t("../../lib/sort_object_keys"),s=h.line,m=h.marker,g=m.line,p=r({width:s.width,dash:{valType:"enumerated",values:o(n),dflt:"solid"}},u("line"));function v(l){return{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var x=P.exports=f({x:h.x,y:h.y,z:{valType:"data_array"},text:r({},h.text,{}),texttemplate:e({},{}),hovertext:r({},h.hovertext,{}),hovertemplate:T(),xhoverformat:A("x"),yhoverformat:A("y"),zhoverformat:A("z"),mode:r({},h.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:v(),y:v(),z:v()},connectgaps:h.connectgaps,line:p,marker:r({symbol:{valType:"enumerated",values:o(a),dflt:"circle",arrayOk:!0},size:r({},m.size,{dflt:8}),sizeref:m.sizeref,sizemin:m.sizemin,sizemode:m.sizemode,opacity:r({},m.opacity,{arrayOk:!1}),colorbar:m.colorbar,line:r({width:r({},g.width,{arrayOk:!1})},u("marker.line"))},u("marker")),textposition:r({},h.textposition,{dflt:"top center"}),textfont:{color:h.textfont.color,size:h.textfont.size,family:r({},h.textfont.family,{arrayOk:!1})},opacity:i.opacity,hoverinfo:r({},i.hoverinfo)},"calc","nested");x.x.editType=x.y.editType=x.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":374,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../scatter/attributes":936}],965:[function(t,P,R){var h=t("../scatter/arrays_to_calcdata"),u=t("../scatter/colorscale_calc");P.exports=function(T,e){var i=[{x:!1,y:!1,trace:e,t:{}}];return h(i,e),u(T,e),i}},{"../scatter/arrays_to_calcdata":935,"../scatter/colorscale_calc":939}],966:[function(t,P,R){var h=t("../../registry");function u(e,i,n,a){if(!i||!i.visible)return null;for(var r=h.getComponentMethod("errorbars","makeComputeError")(i),f=new Array(e.length),o=0;o<e.length;o++){var s=r(+e[o],o);if(a.type==="log"){var m=a.c2l(e[o]),g=e[o]-s[0],p=e[o]+s[1];if(f[o]=[(a.c2l(g,!0)-m)*n,(a.c2l(p,!0)-m)*n],g>0){var v=a.c2l(g);a._lowerLogErrorBound||(a._lowerLogErrorBound=v),a._lowerErrorBound=Math.min(a._lowerLogErrorBound,v)}}else f[o]=[-s[0]*n,s[1]*n]}return f}function A(e){for(var i=0;i<e.length;i++)if(e[i])return e[i].length;return 0}function T(e,i,n){var a=[u(e.x,e.error_x,i[0],n.xaxis),u(e.y,e.error_y,i[1],n.yaxis),u(e.z,e.error_z,i[2],n.zaxis)],r=A(a);if(r===0)return null;for(var f=new Array(r),o=0;o<r;o++){for(var s=[[0,0,0],[0,0,0]],m=0;m<3;m++)if(a[m])for(var g=0;g<2;g++)s[g][m]=a[m][o][g];f[o]=s}return f}P.exports=T},{"../../registry":647}],967:[function(t,P,R){var h=t("../../../stackgl_modules").gl_line3d,u=t("../../../stackgl_modules").gl_scatter3d,A=t("../../../stackgl_modules").gl_error3d,T=t("../../../stackgl_modules").gl_mesh3d,e=t("../../../stackgl_modules").delaunay_triangulate,i=t("../../lib"),n=t("../../lib/str2rgbarray"),a=t("../../lib/gl_format_color").formatColor,r=t("../scatter/make_bubble_size_func"),f=t("../../constants/gl3d_dashes"),o=t("../../constants/gl3d_markers"),s=t("../../plots/cartesian/axes"),m=t("../../components/fx/helpers").appendArrayPointValue,g=t("./calc_errors");function p(k,B){this.scene=k,this.uid=B,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var v=p.prototype;v.handlePick=function(k){if(k.object&&(k.object===this.linePlot||k.object===this.delaunayMesh||k.object===this.textMarkers||k.object===this.scatterPlot)){var B=k.index=k.data.index;return k.object.highlight&&k.object.highlight(null),this.scatterPlot&&(k.object=this.scatterPlot,this.scatterPlot.highlight(k.data)),k.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[B]||this.textLabels[B]===0)&&(k.textLabel=this.textLabels[B]):k.textLabel=this.textLabels),k.traceCoordinate=[this.data.x[B],this.data.y[B],this.data.z[B]],!0}};function x(k,B,z){var F=(z+1)%3,I=(z+2)%3,O=[],N=[],V;for(V=0;V<k.length;++V){var H=k[V];isNaN(H[F])||!isFinite(H[F])||isNaN(H[I])||!isFinite(H[I])||(O.push([H[F],H[I]]),N.push(V))}var j=e(O);for(V=0;V<j.length;++V)for(var Z=j[V],X=0;X<Z.length;++X)Z[X]=N[Z[X]];return{positions:k,cells:j,meshColor:B}}function l(k){for(var B=[0,0,0],z=[[0,0,0],[0,0,0],[0,0,0]],F=[1,1,1],I=0;I<3;I++){var O=k[I];O&&O.copy_zstyle!==!1&&k[2].visible!==!1&&(O=k[2]),!(!O||!O.visible)&&(B[I]=O.width/2,z[I]=n(O.color),F[I]=O.thickness)}return{capSize:B,color:z,lineWidth:F}}function b(k){return k==null?0:k.indexOf("left")>-1?-1:k.indexOf("right")>-1?1:0}function c(k){return k==null?0:k.indexOf("top")>-1?-1:k.indexOf("bottom")>-1?1:0}function M(k){var B=0,z=0,F=[B,z];if(Array.isArray(k))for(var I=0;I<k.length;I++)F[I]=[B,z],k[I]&&(F[I][0]=b(k[I]),F[I][1]=c(k[I]));else F[0]=b(k),F[1]=c(k);return F}function _(k,B){return B(k*4)}function y(k){return o[k]}function w(k,B,z,F,I){var O=null;if(i.isArrayOrTypedArray(k)){O=[];for(var N=0;N<B;N++)k[N]===void 0?O[N]=F:O[N]=z(k[N],I)}else O=z(k,i.identity);return O}function d(k,B){var z=[],F=k.fullSceneLayout,I=k.dataScale,O=F.xaxis,N=F.yaxis,V=F.zaxis,H=B.marker,j=B.line,Z=B.x||[],X=B.y||[],re=B.z||[],ue=Z.length,K=B.xcalendar,te=B.ycalendar,G=B.zcalendar,Y,ee,ne,J,q,ae;for(q=0;q<ue;q++)Y=O.d2l(Z[q],0,K)*I[0],ee=N.d2l(X[q],0,te)*I[1],ne=V.d2l(re[q],0,G)*I[2],z[q]=[Y,ee,ne];if(Array.isArray(B.text))ae=B.text;else if(B.text!==void 0)for(ae=new Array(ue),q=0;q<ue;q++)ae[q]=B.text;function le(Xe,Be){var Re=F[Xe];return s.tickText(Re,Re.d2l(Be),!0).text}var ie=B.texttemplate;if(ie){var se=k.fullLayout,xe=se._d3locale,oe=Array.isArray(ie),he=oe?Math.min(ie.length,ue):ue,be=oe?function(Xe){return ie[Xe]}:function(){return ie};for(ae=new Array(he),q=0;q<he;q++){var me={x:Z[q],y:X[q],z:re[q]},_e={xLabel:le("xaxis",Z[q]),yLabel:le("yaxis",X[q]),zLabel:le("zaxis",re[q])},Se={};m(Se,B,q);var De=B._meta||{};ae[q]=i.texttemplateString(be(q),_e,xe,Se,me,De)}}if(J={position:z,mode:B.mode,text:ae},"line"in B&&(J.lineColor=a(j,1,ue),J.lineWidth=j.width,J.lineDashes=j.dash),"marker"in B){var Ie=r(B);J.scatterColor=a(H,1,ue),J.scatterSize=w(H.size,ue,_,20,Ie),J.scatterMarker=w(H.symbol,ue,y,"\u25CF"),J.scatterLineWidth=H.line.width,J.scatterLineColor=a(H.line,1,ue),J.scatterAngle=0}"textposition"in B&&(J.textOffset=M(B.textposition),J.textColor=a(B.textfont,1,ue),J.textSize=w(B.textfont.size,ue,i.identity,12),J.textFont=B.textfont.family,J.textAngle=0);var Te=["x","y","z"];for(J.project=[!1,!1,!1],J.projectScale=[1,1,1],J.projectOpacity=[1,1,1],q=0;q<3;++q){var Ce=B.projection[Te[q]];(J.project[q]=Ce.show)&&(J.projectOpacity[q]=Ce.opacity,J.projectScale[q]=Ce.scale)}J.errorBounds=g(B,I,F);var He=l([B.error_x,B.error_y,B.error_z]);return J.errorColor=He.color,J.errorLineWidth=He.lineWidth,J.errorCapSize=He.capSize,J.delaunayAxis=B.surfaceaxis,J.delaunayColor=n(B.surfacecolor),J}function C(k){if(i.isArrayOrTypedArray(k)){var B=k[0];return i.isArrayOrTypedArray(B)&&(k=B),"rgb("+k.slice(0,3).map(function(z){return Math.round(z*255)})+")"}return null}function S(k){return i.isArrayOrTypedArray(k)?k.length===4&&typeof k[0]=="number"?C(k):k.map(C):null}v.update=function(k){var B=this.scene.glplot.gl,z,F,I,O,N=f.solid;this.data=k;var V=d(this.scene,k);"mode"in V&&(this.mode=V.mode),"lineDashes"in V&&V.lineDashes in f&&(N=f[V.lineDashes]),this.color=S(V.scatterColor)||S(V.lineColor),this.dataPoints=V.position,z={gl:this.scene.glplot.gl,position:V.position,color:V.lineColor,lineWidth:V.lineWidth||1,dashes:N[0],dashScale:N[1],opacity:k.opacity,connectGaps:k.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(z):(this.linePlot=h(z),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var H=k.opacity;if(k.marker&&k.marker.opacity&&(H*=k.marker.opacity),F={gl:this.scene.glplot.gl,position:V.position,color:V.scatterColor,size:V.scatterSize,glyph:V.scatterMarker,opacity:H,orthographic:!0,lineWidth:V.scatterLineWidth,lineColor:V.scatterLineColor,project:V.project,projectScale:V.projectScale,projectOpacity:V.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(F):(this.scatterPlot=u(F),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),O={gl:this.scene.glplot.gl,position:V.position,glyph:V.text,color:V.textColor,size:V.textSize,angle:V.textAngle,alignment:V.textOffset,font:V.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:k.opacity},this.textLabels=k.hovertext||k.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(O):(this.textMarkers=u(O),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),I={gl:this.scene.glplot.gl,position:V.position,color:V.errorColor,error:V.errorBounds,lineWidth:V.errorLineWidth,capSize:V.errorCapSize,opacity:k.opacity},this.errorBars?V.errorBounds?this.errorBars.update(I):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):V.errorBounds&&(this.errorBars=A(I),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),V.delaunayAxis>=0){var j=x(V.position,V.delaunayColor,V.delaunayAxis);j.opacity=k.opacity,this.delaunayMesh?this.delaunayMesh.update(j):(j.gl=B,this.delaunayMesh=T(j),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},v.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())};function E(k,B){var z=new p(k,B.uid);return z.update(B),z}P.exports=E},{"../../../stackgl_modules":1133,"../../components/fx/helpers":403,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../scatter/make_bubble_size_func":953,"./calc_errors":966}],968:[function(t,P,R){var h=t("../../registry"),u=t("../../lib"),A=t("../scatter/subtypes"),T=t("../scatter/marker_defaults"),e=t("../scatter/line_defaults"),i=t("../scatter/text_defaults"),n=t("./attributes");P.exports=function(f,o,s,m){function g(_,y){return u.coerce(f,o,n,_,y)}var p=a(f,o,g,m);if(!p){o.visible=!1;return}g("text"),g("hovertext"),g("hovertemplate"),g("xhoverformat"),g("yhoverformat"),g("zhoverformat"),g("mode"),A.hasLines(o)&&(g("connectgaps"),e(f,o,s,m,g)),A.hasMarkers(o)&&T(f,o,s,m,g,{noSelect:!0,noAngle:!0}),A.hasText(o)&&(g("texttemplate"),i(f,o,m,g,{noSelect:!0}));var v=(o.line||{}).color,x=(o.marker||{}).color;g("surfaceaxis")>=0&&g("surfacecolor",v||x);for(var l=["x","y","z"],b=0;b<3;++b){var c="projection."+l[b];g(c+".show")&&(g(c+".opacity"),g(c+".scale"))}var M=h.getComponentMethod("errorbars","supplyDefaults");M(f,o,v||x||s,{axis:"z"}),M(f,o,v||x||s,{axis:"y",inherit:"z"}),M(f,o,v||x||s,{axis:"x",inherit:"z"})};function a(r,f,o,s){var m=0,g=o("x"),p=o("y"),v=o("z"),x=h.getComponentMethod("calendars","handleTraceDefaults");return x(r,f,["x","y","z"],s),g&&p&&v&&(m=Math.min(g.length,p.length,v.length),f._length=f._xlength=f._ylength=f._zlength=m),m}},{"../../lib":515,"../../registry":647,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":964}],969:[function(t,P,R){P.exports={plot:t("./convert"),attributes:t("./attributes"),markerSymbols:t("../../constants/gl3d_markers"),supplyDefaults:t("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:t("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:t("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":489,"../../plots/gl3d":607,"./attributes":964,"./calc":965,"./convert":967,"./defaults":968}],970:[function(t,P,R){var h=t("../scatter/attributes"),u=t("../../plots/attributes"),A=t("../../plots/template_attributes").hovertemplateAttrs,T=t("../../plots/template_attributes").texttemplateAttrs,e=t("../../components/colorscale/attributes"),i=t("../../lib/extend").extendFlat,n=h.marker,a=h.line,r=n.line;P.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:i({},h.mode,{dflt:"markers"}),text:i({},h.text,{}),texttemplate:T({editType:"plot"},{keys:["a","b","text"]}),hovertext:i({},h.hovertext,{}),line:{color:a.color,width:a.width,dash:a.dash,backoff:a.backoff,shape:i({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:h.connectgaps,fill:i({},h.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:h.fillcolor,marker:i({symbol:n.symbol,opacity:n.opacity,maxdisplayed:n.maxdisplayed,angle:n.angle,angleref:n.angleref,standoff:n.standoff,size:n.size,sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,line:i({width:r.width,editType:"calc"},e("marker.line")),gradient:n.gradient,editType:"calc"},e("marker")),textfont:h.textfont,textposition:h.textposition,selected:h.selected,unselected:h.unselected,hoverinfo:i({},u.hoverinfo,{flags:["a","b","text","name"]}),hoveron:h.hoveron,hovertemplate:A()}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],971:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../scatter/colorscale_calc"),A=t("../scatter/arrays_to_calcdata"),T=t("../scatter/calc_selection"),e=t("../scatter/calc").calcMarkerSize,i=t("../carpet/lookup_carpetid");P.exports=function(a,r){var f=r._carpetTrace=i(a,r);if(!(!f||!f.visible||f.visible==="legendonly")){var o;r.xaxis=f.xaxis,r.yaxis=f.yaxis;var s=r._length,m=new Array(s),g,p,v=!1;for(o=0;o<s;o++)if(g=r.a[o],p=r.b[o],h(g)&&h(p)){var x=f.ab2xy(+g,+p,!0),l=f.isVisible(+g,+p);l||(v=!0),m[o]={x:x[0],y:x[1],a:g,b:p,vis:l}}else m[o]={x:!1,y:!1};return r._needsCull=v,m[0].carpet=f,m[0].trace=r,e(r,s),u(a,r),A(m,r),T(m,r),m}}},{"../carpet/lookup_carpetid":717,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],972:[function(t,P,R){var h=t("../../lib"),u=t("../scatter/constants"),A=t("../scatter/subtypes"),T=t("../scatter/marker_defaults"),e=t("../scatter/line_defaults"),i=t("../scatter/line_shape_defaults"),n=t("../scatter/text_defaults"),a=t("../scatter/fillcolor_defaults"),r=t("./attributes");P.exports=function(o,s,m,g){function p(_,y){return h.coerce(o,s,r,_,y)}p("carpet"),s.xaxis="x",s.yaxis="y";var v=p("a"),x=p("b"),l=Math.min(v.length,x.length);if(!l){s.visible=!1;return}s._length=l,p("text"),p("texttemplate"),p("hovertext");var b=l<u.PTS_LINESONLY?"lines+markers":"lines";p("mode",b),A.hasLines(s)&&(e(o,s,m,g,p,{backoff:!0}),i(o,s,p),p("connectgaps")),A.hasMarkers(s)&&T(o,s,m,g,p,{gradient:!0}),A.hasText(s)&&n(o,s,g,p);var c=[];(A.hasMarkers(s)||A.hasText(s))&&(p("marker.maxdisplayed"),c.push("points")),p("fill"),s.fill!=="none"&&(a(o,s,m,p),A.hasLines(s)||i(o,s,p)),(s.fill==="tonext"||s.fill==="toself")&&c.push("fills");var M=p("hoveron",c.join("+")||"points");M!=="fills"&&p("hovertemplate"),h.coerceSelectionMarkerOpacity(s,p)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":970}],973:[function(t,P,R){P.exports=function(u,A,T,e,i){var n=e[i];return u.a=n.a,u.b=n.b,u.y=n.y,u}},{}],974:[function(t,P,R){P.exports=function(u,A){var T={},e=A._carpet,i=e.ab2ij([u.a,u.b]),n=Math.floor(i[0]),a=i[0]-n,r=Math.floor(i[1]),f=i[1]-r,o=e.evalxy([],n,r,a,f);return T.yLabel=o[1].toFixed(3),T}},{}],975:[function(t,P,R){var h=t("../scatter/hover"),u=t("../../lib").fillText;P.exports=function(T,e,i,n){var a=h(T,e,i,n);if(!a||a[0].index===!1)return;var r=a[0];if(r.index===void 0){var f=1-r.y0/T.ya._length,o=T.xa._length,s=o*f/2,m=o-s;return r.x0=Math.max(Math.min(r.x0,m),s),r.x1=Math.max(Math.min(r.x1,m),s),a}var g=r.cd[r.index];r.a=g.a,r.b=g.b,r.xLabelVal=void 0,r.yLabelVal=void 0;var p=r.trace,v=p._carpet,x=p._module.formatLabels(g,p);r.yLabel=x.yLabel,delete r.text;var l=[];function b(_,y){var w;_.labelprefix&&_.labelprefix.length>0?w=_.labelprefix.replace(/ = $/,""):w=_._hovertitle,l.push(w+": "+y.toFixed(3)+_.labelsuffix)}if(!p.hovertemplate){var c=g.hi||p.hoverinfo,M=c.split("+");M.indexOf("all")!==-1&&(M=["a","b","text"]),M.indexOf("a")!==-1&&b(v.aaxis,g.a),M.indexOf("b")!==-1&&b(v.baxis,g.b),l.push("y: "+r.yLabel),M.indexOf("text")!==-1&&u(g,p,l),r.extraText=l.join("<br>")}return a}},{"../../lib":515,"../scatter/hover":947}],976:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../scatter/marker_colorbar"),formatLabels:t("./format_labels"),calc:t("./calc"),plot:t("./plot"),style:t("../scatter/style").style,styleOnSelect:t("../scatter/style").styleOnSelect,hoverPoints:t("./hover"),selectPoints:t("../scatter/select"),eventData:t("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:t("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":970,"./calc":971,"./defaults":972,"./event_data":973,"./format_labels":974,"./hover":975,"./plot":977}],977:[function(t,P,R){var h=t("../scatter/plot"),u=t("../../plots/cartesian/axes"),A=t("../../components/drawing");P.exports=function(e,i,n,a){var r,f,o,s=n[0][0].carpet,m=u.getFromId(e,s.xaxis||"x"),g=u.getFromId(e,s.yaxis||"y"),p={xaxis:m,yaxis:g,plot:i.plot};for(r=0;r<n.length;r++)f=n[r][0].trace,f._xA=m,f._yA=g;for(h(e,p,n,a),r=0;r<n.length;r++)f=n[r][0].trace,o=a.selectAll("g.trace"+f.uid+" .js-line"),A.setClipUrl(o,n[r][0].carpet._clipPathId,e)}},{"../../components/drawing":389,"../../plots/cartesian/axes":566,"../scatter/plot":957}],978:[function(t,P,R){var h=t("../../plots/template_attributes").hovertemplateAttrs,u=t("../../plots/template_attributes").texttemplateAttrs,A=t("../scatter/attributes"),T=t("../../plots/attributes"),e=t("../../components/colorscale/attributes"),i=t("../../components/drawing/attributes").dash,n=t("../../lib/extend").extendFlat,a=t("../../plot_api/edit_types").overrideAll,r=A.marker,f=A.line,o=r.line;P.exports=a({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:n({},A.mode,{dflt:"markers"}),text:n({},A.text,{}),texttemplate:u({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:n({},A.hovertext,{}),textfont:A.textfont,textposition:A.textposition,line:{color:f.color,width:f.width,dash:i},connectgaps:A.connectgaps,marker:n({symbol:r.symbol,opacity:r.opacity,angle:r.angle,angleref:n({},r.angleref,{values:["previous","up","north"]}),standoff:r.standoff,size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,colorbar:r.colorbar,line:n({width:o.width},e("marker.line")),gradient:r.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:A.fillcolor,selected:A.selected,unselected:A.unselected,hoverinfo:n({},T.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:h()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],979:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../constants/numerical").BADNUM,A=t("../scatter/colorscale_calc"),T=t("../scatter/arrays_to_calcdata"),e=t("../scatter/calc_selection"),i=t("../../lib")._;function n(a){return a&&typeof a=="string"}P.exports=function(r,f){var o=Array.isArray(f.locations),s=o?f.locations.length:f._length,m=new Array(s),g;f.geojson?g=function(c){return n(c)||h(c)}:g=n;for(var p=0;p<s;p++){var v=m[p]={};if(o){var x=f.locations[p];v.loc=g(x)?x:null}else{var l=f.lon[p],b=f.lat[p];h(l)&&h(b)?v.lonlat=[+l,+b]:v.lonlat=[u,u]}}return T(m,f),A(r,f),e(m,f),s&&(m[0].t={labels:{lat:i(r,"lat:")+" ",lon:i(r,"lon:")+" "}}),m}},{"../../constants/numerical":491,"../../lib":515,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],980:[function(t,P,R){var h=t("../../lib"),u=t("../scatter/subtypes"),A=t("../scatter/marker_defaults"),T=t("../scatter/line_defaults"),e=t("../scatter/text_defaults"),i=t("../scatter/fillcolor_defaults"),n=t("./attributes");P.exports=function(r,f,o,s){function m(M,_){return h.coerce(r,f,n,M,_)}var g=m("locations"),p;if(g&&g.length){var v=m("geojson"),x;(typeof v=="string"&&v!==""||h.isPlainObject(v))&&(x="geojson-id");var l=m("locationmode",x);l==="geojson-id"&&m("featureidkey"),p=g.length}else{var b=m("lon")||[],c=m("lat")||[];p=Math.min(b.length,c.length)}if(!p){f.visible=!1;return}f._length=p,m("text"),m("hovertext"),m("hovertemplate"),m("mode"),u.hasLines(f)&&(T(r,f,o,s,m),m("connectgaps")),u.hasMarkers(f)&&A(r,f,o,s,m,{gradient:!0}),u.hasText(f)&&(m("texttemplate"),e(r,f,s,m)),m("fill"),f.fill!=="none"&&i(r,f,o,m),h.coerceSelectionMarkerOpacity(f,m)}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":978}],981:[function(t,P,R){P.exports=function(u,A,T,e,i){u.lon=A.lon,u.lat=A.lat,u.location=A.loc?A.loc:null;var n=e[i];return n.fIn&&n.fIn.properties&&(u.properties=n.fIn.properties),u}},{}],982:[function(t,P,R){var h=t("../../plots/cartesian/axes");P.exports=function(A,T,e){var i={},n=e[T.geo]._subplot,a=n.mockAxis,r=A.lonlat;return i.lonLabel=h.tickText(a,a.c2l(r[0]),!0).text,i.latLabel=h.tickText(a,a.c2l(r[1]),!0).text,i}},{"../../plots/cartesian/axes":566}],983:[function(t,P,R){var h=t("../../components/fx"),u=t("../../constants/numerical").BADNUM,A=t("../scatter/get_trace_color"),T=t("../../lib").fillText,e=t("./attributes");P.exports=function(a,r,f){var o=a.cd,s=o[0].trace,m=a.xa,g=a.ya,p=a.subplot,v=p.projection.isLonLatOverEdges,x=p.project;function l(d){var C=d.lonlat;if(C[0]===u||v(C))return 1/0;var S=x(C),E=x([r,f]),k=Math.abs(S[0]-E[0]),B=Math.abs(S[1]-E[1]),z=Math.max(3,d.mrc||0);return Math.max(Math.sqrt(k*k+B*B)-z,1-3/z)}if(h.getClosest(o,l,a),a.index!==!1){var b=o[a.index],c=b.lonlat,M=[m.c2p(c),g.c2p(c)],_=b.mrc||1;a.x0=M[0]-_,a.x1=M[0]+_,a.y0=M[1]-_,a.y1=M[1]+_,a.loc=b.loc,a.lon=c[0],a.lat=c[1];var y={};y[s.geo]={_subplot:p};var w=s._module.formatLabels(b,s,y);return a.lonLabel=w.lonLabel,a.latLabel=w.latLabel,a.color=A(s,b),a.extraText=i(s,b,a,o[0].t.labels),a.hovertemplate=s.hovertemplate,[a]}};function i(n,a,r,f){if(n.hovertemplate)return;var o=a.hi||n.hoverinfo,s=o==="all"?e.hoverinfo.flags:o.split("+"),m=s.indexOf("location")!==-1&&Array.isArray(n.locations),g=s.indexOf("lon")!==-1,p=s.indexOf("lat")!==-1,v=s.indexOf("text")!==-1,x=[];function l(b){return b+"\xB0"}return m?x.push(a.loc):g&&p?x.push("("+l(r.latLabel)+", "+l(r.lonLabel)+")"):g?x.push(f.lon+l(r.lonLabel)):p&&x.push(f.lat+l(r.latLabel)),v&&T(a,n,x),x.join("<br>")}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946,"./attributes":978}],984:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../scatter/marker_colorbar"),formatLabels:t("./format_labels"),calc:t("./calc"),calcGeoJSON:t("./plot").calcGeoJSON,plot:t("./plot").plot,style:t("./style"),styleOnSelect:t("../scatter/style").styleOnSelect,hoverPoints:t("./hover"),eventData:t("./event_data"),selectPoints:t("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:t("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":598,"../scatter/marker_colorbar":954,"../scatter/style":960,"./attributes":978,"./calc":979,"./defaults":980,"./event_data":981,"./format_labels":982,"./hover":983,"./plot":985,"./select":986,"./style":987}],985:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=t("../../lib/topojson_utils").getTopojsonFeatures,T=t("../../lib/geojson_utils"),e=t("../../lib/geo_location_utils"),i=t("../../plots/cartesian/autorange").findExtremes,n=t("../../constants/numerical").BADNUM,a=t("../scatter/calc").calcMarkerSize,r=t("../scatter/subtypes"),f=t("./style");function o(m,g,p){var v=g.layers.frontplot.select(".scatterlayer"),x=u.makeTraceGroups(v,p,"trace scattergeo");function l(b,c){b.lonlat[0]===n&&h.select(c).remove()}x.selectAll("*").remove(),x.each(function(b){var c=h.select(this),M=b[0].trace;if(r.hasLines(M)||M.fill!=="none"){var _=T.calcTraceToLineCoords(b),y=M.fill!=="none"?T.makePolygon(_):T.makeLine(_);c.selectAll("path.js-line").data([{geojson:y,trace:M}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}r.hasMarkers(M)&&c.selectAll("path.point").data(u.identity).enter().append("path").classed("point",!0).each(function(w){l(w,this)}),r.hasText(M)&&c.selectAll("g").data(u.identity).enter().append("g").append("text").each(function(w){l(w,this)}),f(m,b)})}function s(m,g){var p=m[0].trace,v=g[p.geo],x=v._subplot,l=p._length,b,c;if(Array.isArray(p.locations)){var M=p.locationmode,_=M==="geojson-id"?e.extractTraceFeature(m):A(p,x.topojson);for(b=0;b<l;b++){c=m[b];var y=M==="geojson-id"?c.fOut:e.locationToFeature(M,c.loc,_);c.lonlat=y?y.properties.ct:[n,n]}}var w={padded:!0},d,C;if(v.fitbounds==="geojson"&&p.locationmode==="geojson-id"){var S=e.computeBbox(e.getTraceGeojson(p));d=[S[0],S[2]],C=[S[1],S[3]]}else{for(d=new Array(l),C=new Array(l),b=0;b<l;b++)c=m[b],d[b]=c.lonlat[0],C[b]=c.lonlat[1];w.ppad=a(p,l)}p._extremes.lon=i(v.lonaxis._ax,d,w),p._extremes.lat=i(v.lataxis._ax,C,w)}P.exports={calcGeoJSON:s,plot:o}},{"../../constants/numerical":491,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"../scatter/calc":937,"../scatter/subtypes":961,"./style":987,"@plotly/d3":58}],986:[function(t,P,R){var h=t("../scatter/subtypes"),u=t("../../constants/numerical").BADNUM;P.exports=function(T,e){var i=T.cd,n=T.xaxis,a=T.yaxis,r=[],f=i[0].trace,o,s,m,g,p,v=!h.hasMarkers(f)&&!h.hasText(f);if(v)return[];if(e===!1)for(p=0;p<i.length;p++)i[p].selected=0;else for(p=0;p<i.length;p++)o=i[p],s=o.lonlat,s[0]!==u&&(m=n.c2p(s),g=a.c2p(s),e.contains([m,g],null,p,T)?(r.push({pointNumber:p,lon:s[0],lat:s[1]}),o.selected=1):o.selected=0);return r}},{"../../constants/numerical":491,"../scatter/subtypes":961}],987:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/drawing"),A=t("../../components/color"),T=t("../scatter/style"),e=T.stylePoints,i=T.styleText;P.exports=function(r,f){f&&n(r,f)};function n(a,r){var f=r[0].trace,o=r[0].node3;o.style("opacity",r[0].trace.opacity),e(o,f,a),i(o,f,a),o.selectAll("path.js-line").style("fill","none").each(function(s){var m=h.select(this),g=s.trace,p=g.line||{};m.call(A.stroke,p.color).call(u.dashLine,p.dash||"",p.width||0),g.fill!=="none"&&m.call(A.fill,g.fillcolor)})}},{"../../components/color":367,"../../components/drawing":389,"../scatter/style":960,"@plotly/d3":58}],988:[function(t,P,R){var h=t("../../plots/attributes"),u=t("../scatter/attributes"),A=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,T=t("../../components/colorscale/attributes"),e=t("../../lib/sort_object_keys"),i=t("../../lib/extend").extendFlat,n=t("../../plot_api/edit_types").overrideAll,a=t("./constants").DASHES,r=u.line,f=u.marker,o=f.line,s=P.exports=n({x:u.x,x0:u.x0,dx:u.dx,y:u.y,y0:u.y0,dy:u.dy,xperiod:u.xperiod,yperiod:u.yperiod,xperiod0:u.xperiod0,yperiod0:u.yperiod0,xperiodalignment:u.xperiodalignment,yperiodalignment:u.yperiodalignment,xhoverformat:A("x"),yhoverformat:A("y"),text:u.text,hovertext:u.hovertext,textposition:u.textposition,textfont:u.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:r.color,width:r.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(a),dflt:"solid"}},marker:i({},T("marker"),{symbol:f.symbol,angle:f.angle,size:f.size,sizeref:f.sizeref,sizemin:f.sizemin,sizemode:f.sizemode,opacity:f.opacity,colorbar:f.colorbar,line:i({},T("marker.line"),{width:o.width})}),connectgaps:u.connectgaps,fill:i({},u.fill,{dflt:"none"}),fillcolor:u.fillcolor,selected:{marker:u.selected.marker,textfont:u.selected.textfont},unselected:{marker:u.unselected.marker,textfont:u.unselected.textfont},opacity:h.opacity},"calc","nested");s.x.editType=s.y.editType=s.x0.editType=s.y0.editType="calc+clearAxisTypes",s.hovertemplate=u.hovertemplate,s.texttemplate=u.texttemplate},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936,"./constants":991}],989:[function(t,P,R){var h=t("./hover");P.exports={moduleType:"trace",name:"scattergl",basePlotModule:t("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:t("./attributes"),supplyDefaults:t("./defaults"),crossTraceDefaults:t("../scatter/cross_trace_defaults"),colorbar:t("../scatter/marker_colorbar"),formatLabels:t("./format_labels"),calc:t("./calc"),hoverPoints:h.hoverPoints,selectPoints:t("./select"),meta:{}}},{"../../plots/cartesian":578,"../scatter/cross_trace_defaults":942,"../scatter/marker_colorbar":954,"./attributes":988,"./calc":990,"./defaults":993,"./format_labels":995,"./hover":997,"./select":1001}],990:[function(t,P,R){var h=t("@plotly/point-cluster"),u=t("../../lib"),A=t("../../plots/cartesian/axis_ids"),T=t("../../plots/cartesian/autorange").findExtremes,e=t("../../plots/cartesian/align_period"),i=t("../scatter/calc"),n=i.calcMarkerSize,a=i.calcAxisExpansion,r=i.setFirstScatter,f=t("../scatter/colorscale_calc"),o=t("./convert"),s=t("./scene_update"),m=t("../../constants/numerical").BADNUM,g=t("./constants").TOO_MANY_POINTS;P.exports=function(l,b){var c=l._fullLayout,M=b._xA=A.getFromId(l,b.xaxis,"x"),_=b._yA=A.getFromId(l,b.yaxis,"y"),y=c._plots[b.xaxis+b.yaxis],w=b._length,d=w>=g,C=w*2,S={},E,k=M.makeCalcdata(b,"x"),B=_.makeCalcdata(b,"y"),z=e(b,M,"x",k),F=e(b,_,"y",B),I=z.vals,O=F.vals;b._x=I,b._y=O,b.xperiodalignment&&(b._origX=k,b._xStarts=z.starts,b._xEnds=z.ends),b.yperiodalignment&&(b._origY=B,b._yStarts=F.starts,b._yEnds=F.ends);var N=new Array(C),V=new Array(w);for(E=0;E<w;E++)N[E*2]=I[E]===m?NaN:I[E],N[E*2+1]=O[E]===m?NaN:O[E],V[E]=E;if(M.type==="log")for(E=0;E<C;E+=2)N[E]=M.c2l(N[E]);if(_.type==="log")for(E=1;E<C;E+=2)N[E]=_.c2l(N[E]);d&&M.type!=="log"&&_.type!=="log"?S.tree=h(N):S.ids=V,f(l,b);var H=v(l,y,b,N,I,O),j=s(l,y);r(c,b);var Z;return d?H.marker&&(Z=H.marker.sizeAvg||Math.max(H.marker.size,3)):Z=n(b,w),a(l,b,M,_,I,O,Z),H.errorX&&p(b,M,H.errorX),H.errorY&&p(b,_,H.errorY),H.fill&&!j.fill2d&&(j.fill2d=!0),H.marker&&!j.scatter2d&&(j.scatter2d=!0),H.line&&!j.line2d&&(j.line2d=!0),(H.errorX||H.errorY)&&!j.error2d&&(j.error2d=!0),H.text&&!j.glText&&(j.glText=!0),H.marker&&(H.marker.snap=w),j.lineOptions.push(H.line),j.errorXOptions.push(H.errorX),j.errorYOptions.push(H.errorY),j.fillOptions.push(H.fill),j.markerOptions.push(H.marker),j.markerSelectedOptions.push(H.markerSel),j.markerUnselectedOptions.push(H.markerUnsel),j.textOptions.push(H.text),j.textSelectedOptions.push(H.textSel),j.textUnselectedOptions.push(H.textUnsel),j.selectBatch.push([]),j.unselectBatch.push([]),S._scene=j,S.index=j.count,S.x=I,S.y=O,S.positions=N,j.count++,[{x:!1,y:!1,t:S,trace:b}]};function p(x,l,b){var c=x._extremes[l._id],M=T(l,b._bnds,{padded:!0});c.min=c.min.concat(M.min),c.max=c.max.concat(M.max)}function v(x,l,b,c,M,_){var y=o.style(x,b);if(y.marker&&(y.marker.positions=c),y.line&&c.length>1&&u.extendFlat(y.line,o.linePositions(x,b,c)),y.errorX||y.errorY){var w=o.errorBarPositions(x,b,c,M,_);y.errorX&&u.extendFlat(y.errorX,w.x),y.errorY&&u.extendFlat(y.errorY,w.y)}return y.text&&(u.extendFlat(y.text,{positions:c},o.textPosition(x,b,y.text,y.marker)),u.extendFlat(y.textSel,{positions:c},o.textPosition(x,b,y.text,y.markerSel)),u.extendFlat(y.textUnsel,{positions:c},o.textPosition(x,b,y.text,y.markerUnsel))),y}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"./constants":991,"./convert":992,"./scene_update":1e3,"@plotly/point-cluster":59}],991:[function(t,P,R){var h=20;P.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:h,SYMBOL_STROKE:h/20,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],992:[function(t,P,R){var h=t("fast-isnumeric"),u=t("svg-path-sdf"),A=t("color-normalize"),T=t("../../registry"),e=t("../../lib"),i=t("../../components/drawing"),n=t("../../plots/cartesian/axis_ids"),a=t("../../lib/gl_format_color").formatColor,r=t("../scatter/subtypes"),f=t("../scatter/make_bubble_size_func"),o=t("./helpers"),s=t("./constants"),m=t("../../constants/interactions").DESELECTDIM,g={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},p=t("../../components/fx/helpers").appendArrayPointValue;function v(z,F){var I,O={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},N=z._context.plotGlPixelRatio;if(F.visible!==!0)return O;if(r.hasText(F)&&(O.text=x(z,F),O.textSel=c(z,F,F.selected),O.textUnsel=c(z,F,F.unselected)),r.hasMarkers(F)&&(O.marker=l(z,F),O.markerSel=b(z,F,F.selected),O.markerUnsel=b(z,F,F.unselected),!F.unselected&&e.isArrayOrTypedArray(F.marker.opacity))){var V=F.marker.opacity;for(O.markerUnsel.opacity=new Array(V.length),I=0;I<V.length;I++)O.markerUnsel.opacity[I]=m*V[I]}if(r.hasLines(F)){O.line={overlay:!0,thickness:F.line.width*N,color:F.line.color,opacity:F.opacity};var H=(s.DASHES[F.line.dash]||[1]).slice();for(I=0;I<H.length;++I)H[I]*=F.line.width*N;O.line.dashes=H}return F.error_x&&F.error_x.visible&&(O.errorX=M(F,F.error_x,N)),F.error_y&&F.error_y.visible&&(O.errorY=M(F,F.error_y,N)),!!F.fill&&F.fill!=="none"&&(O.fill={closed:!0,fill:F.fillcolor,thickness:0}),O}function x(z,F){var I=z._fullLayout,O=F._length,N=F.textfont,V=F.textposition,H=Array.isArray(V)?V:[V],j=N.color,Z=N.size,X=N.family,re={},ue,K=z._context.plotGlPixelRatio,te=F.texttemplate;if(te){re.text=[];var G=I._d3locale,Y=Array.isArray(te),ee=Y?Math.min(te.length,O):O,ne=Y?function(xe){return te[xe]}:function(){return te};for(ue=0;ue<ee;ue++){var J={i:ue},q=F._module.formatLabels(J,F,I),ae={};p(ae,F,ue);var le=F._meta||{};re.text.push(e.texttemplateString(ne(ue),q,G,ae,J,le))}}else Array.isArray(F.text)&&F.text.length<O?re.text=F.text.slice():re.text=F.text;if(Array.isArray(re.text))for(ue=re.text.length;ue<O;ue++)re.text[ue]="";for(re.opacity=F.opacity,re.font={},re.align=[],re.baseline=[],ue=0;ue<H.length;ue++){var ie=H[ue].split(/\s+/);switch(ie[1]){case"left":re.align.push("right");break;case"right":re.align.push("left");break;default:re.align.push(ie[1])}switch(ie[0]){case"top":re.baseline.push("bottom");break;case"bottom":re.baseline.push("top");break;default:re.baseline.push(ie[0])}}if(Array.isArray(j))for(re.color=new Array(O),ue=0;ue<O;ue++)re.color[ue]=j[ue];else re.color=j;if(e.isArrayOrTypedArray(Z)||Array.isArray(X))for(re.font=new Array(O),ue=0;ue<O;ue++){var se=re.font[ue]={};se.size=(e.isTypedArray(Z)?Z[ue]:Array.isArray(Z)?h(Z[ue])?Z[ue]:0:Z)*K,se.family=Array.isArray(X)?X[ue]:X}else re.font={size:Z*K,family:X};return re}function l(z,F){var I=F._length,O=F.marker,N={},V,H=e.isArrayOrTypedArray(O.symbol),j=e.isArrayOrTypedArray(O.angle),Z=e.isArrayOrTypedArray(O.color),X=e.isArrayOrTypedArray(O.line.color),re=e.isArrayOrTypedArray(O.opacity),ue=e.isArrayOrTypedArray(O.size),K=e.isArrayOrTypedArray(O.line.width),te;if(H||(te=o.isOpenSymbol(O.symbol)),H||Z||X||re||j){N.symbols=new Array(I),N.angles=new Array(I),N.colors=new Array(I),N.borderColors=new Array(I);var G=O.symbol,Y=O.angle,ee=a(O,O.opacity,I),ne=a(O.line,O.opacity,I);if(!Array.isArray(ne[0])){var J=ne;for(ne=Array(I),V=0;V<I;V++)ne[V]=J}if(!Array.isArray(ee[0])){var q=ee;for(ee=Array(I),V=0;V<I;V++)ee[V]=q}if(!Array.isArray(G)){var ae=G;for(G=Array(I),V=0;V<I;V++)G[V]=ae}if(!Array.isArray(Y)){var le=Y;for(Y=Array(I),V=0;V<I;V++)Y[V]=le}for(N.symbols=G,N.angles=Y,N.colors=ee,N.borderColors=ne,V=0;V<I;V++)H&&(te=o.isOpenSymbol(O.symbol[V])),te&&(ne[V]=ee[V].slice(),ee[V]=ee[V].slice(),ee[V][3]=0);for(N.opacity=F.opacity,N.markers=new Array(I),V=0;V<I;V++)N.markers[V]=S({mx:N.symbols[V],ma:N.angles[V]},F)}else te?(N.color=A(O.color,"uint8"),N.color[3]=0,N.borderColor=A(O.color,"uint8")):(N.color=A(O.color,"uint8"),N.borderColor=A(O.line.color,"uint8")),N.opacity=F.opacity*O.opacity,N.marker=S({mx:O.symbol,ma:O.angle},F);var ie=1,se=f(F,ie),xe;if(ue||K){var oe=N.sizes=new Array(I),he=N.borderSizes=new Array(I),be=0,me;if(ue){for(V=0;V<I;V++)oe[V]=se(O.size[V]),be+=oe[V];me=be/I}else for(xe=se(O.size),V=0;V<I;V++)oe[V]=xe;if(K)for(V=0;V<I;V++)he[V]=O.line.width[V];else for(xe=O.line.width,V=0;V<I;V++)he[V]=xe;N.sizeAvg=me}else N.size=se(O&&O.size||10),N.borderSizes=se(O.line.width);return N}function b(z,F,I){var O=F.marker,N={};return I&&(I.marker&&I.marker.symbol?N=l(z,e.extendFlat({},O,I.marker)):I.marker&&(I.marker.size&&(N.size=I.marker.size),I.marker.color&&(N.colors=I.marker.color),I.marker.opacity!==void 0&&(N.opacity=I.marker.opacity))),N}function c(z,F,I){var O={};if(!I)return O;if(I.textfont){var N={opacity:1,text:F.text,texttemplate:F.texttemplate,textposition:F.textposition,textfont:e.extendFlat({},F.textfont)};I.textfont&&e.extendFlat(N.textfont,I.textfont),O=x(z,N)}return O}function M(z,F,I){var O={capSize:F.width*2*I,lineWidth:F.thickness*I,color:F.color};return F.copy_ystyle&&(O=z.error_y),O}var _=s.SYMBOL_SDF_SIZE,y=s.SYMBOL_SIZE,w=s.SYMBOL_STROKE,d={},C=i.symbolFuncs[0](y*.05);function S(z,F){var I=z.mx;if(I==="circle")return null;var O,N,V=i.symbolNumber(I),H=i.symbolFuncs[V%100],j=!!i.symbolNoDot[V%100],Z=!!i.symbolNoFill[V%100],X=o.isDotSymbol(I);if(z.ma&&(I+="_"+z.ma),d[I])return d[I];var re=i.getMarkerAngle(z,F);return X&&!j?O=H(y*1.1,re)+C:O=H(y,re),N=u(O,{w:_,h:_,viewBox:[-y,-y,y,y],stroke:Z?w:-w}),d[I]=N,N||null}function E(z,F,I){var O=I.length,N=O/2,V,H;if(r.hasLines(F)&&N)if(F.line.shape==="hv"){for(V=[],H=0;H<N-1;H++)isNaN(I[H*2])||isNaN(I[H*2+1])?V.push(NaN,NaN,NaN,NaN):(V.push(I[H*2],I[H*2+1]),!isNaN(I[H*2+2])&&!isNaN(I[H*2+3])?V.push(I[H*2+2],I[H*2+1]):V.push(NaN,NaN));V.push(I[O-2],I[O-1])}else if(F.line.shape==="hvh"){for(V=[],H=0;H<N-1;H++)if(isNaN(I[H*2])||isNaN(I[H*2+1])||isNaN(I[H*2+2])||isNaN(I[H*2+3]))!isNaN(I[H*2])&&!isNaN(I[H*2+1])?V.push(I[H*2],I[H*2+1]):V.push(NaN,NaN),V.push(NaN,NaN);else{var j=(I[H*2]+I[H*2+2])/2;V.push(I[H*2],I[H*2+1],j,I[H*2+1],j,I[H*2+3])}V.push(I[O-2],I[O-1])}else if(F.line.shape==="vhv"){for(V=[],H=0;H<N-1;H++)if(isNaN(I[H*2])||isNaN(I[H*2+1])||isNaN(I[H*2+2])||isNaN(I[H*2+3]))!isNaN(I[H*2])&&!isNaN(I[H*2+1])?V.push(I[H*2],I[H*2+1]):V.push(NaN,NaN),V.push(NaN,NaN);else{var Z=(I[H*2+1]+I[H*2+3])/2;V.push(I[H*2],I[H*2+1],I[H*2],Z,I[H*2+2],Z)}V.push(I[O-2],I[O-1])}else if(F.line.shape==="vh"){for(V=[],H=0;H<N-1;H++)isNaN(I[H*2])||isNaN(I[H*2+1])?V.push(NaN,NaN,NaN,NaN):(V.push(I[H*2],I[H*2+1]),!isNaN(I[H*2+2])&&!isNaN(I[H*2+3])?V.push(I[H*2],I[H*2+3]):V.push(NaN,NaN));V.push(I[O-2],I[O-1])}else V=I;var X=!1;for(H=0;H<V.length;H++)if(isNaN(V[H])){X=!0;break}var re=X||V.length>s.TOO_MANY_POINTS||r.hasMarkers(F)?"rect":"round";if(X&&F.connectgaps){var ue=V[0],K=V[1];for(H=0;H<V.length;H+=2)isNaN(V[H])||isNaN(V[H+1])?(V[H]=ue,V[H+1]=K):(ue=V[H],K=V[H+1])}return{join:re,positions:V}}function k(z,F,I,O,N){var V=T.getComponentMethod("errorbars","makeComputeError"),H=n.getFromId(z,F.xaxis,"x"),j=n.getFromId(z,F.yaxis,"y"),Z=I.length/2,X={};function re(ue,K){var te=K._id.charAt(0),G=F["error_"+te];if(G&&G.visible&&(K.type==="linear"||K.type==="log")){for(var Y=V(G),ee={x:0,y:1}[te],ne={x:[0,1,2,3],y:[2,3,0,1]}[te],J=new Float64Array(4*Z),q=1/0,ae=-1/0,le=0,ie=0;le<Z;le++,ie+=4){var se=ue[le];if(h(se)){var xe=I[le*2+ee],oe=Y(se,le),he=oe[0],be=oe[1];if(h(he)&&h(be)){var me=se-he,_e=se+be;J[ie+ne[0]]=xe-K.c2l(me),J[ie+ne[1]]=K.c2l(_e)-xe,J[ie+ne[2]]=0,J[ie+ne[3]]=0,q=Math.min(q,se-he),ae=Math.max(ae,se+be)}}}X[te]={positions:I,errors:J,_bnds:[q,ae]}}}return re(O,H),re(N,j),X}function B(z,F,I,O){var N=F._length,V={},H;if(r.hasMarkers(F)){var j=I.font,Z=I.align,X=I.baseline;for(V.offset=new Array(N),H=0;H<N;H++){var re=O.sizes?O.sizes[H]:O.size,ue=Array.isArray(j)?j[H].size:j.size,K=Array.isArray(Z)?Z.length>1?Z[H]:Z[0]:Z,te=Array.isArray(X)?X.length>1?X[H]:X[0]:X,G=g[K],Y=g[te],ee=re?re/.8+1:0,ne=-Y*ee-Y*.5;V.offset[H]=[G*ee/ue,ne/ue]}}return V}P.exports={style:v,markerStyle:l,markerSelection:b,linePositions:E,errorBarPositions:k,textPosition:B}},{"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/interactions":490,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"./constants":991,"./helpers":996,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":311}],993:[function(t,P,R){var h=t("../../lib"),u=t("../../registry"),A=t("./helpers"),T=t("./attributes"),e=t("../scatter/constants"),i=t("../scatter/subtypes"),n=t("../scatter/xy_defaults"),a=t("../scatter/period_defaults"),r=t("../scatter/marker_defaults"),f=t("../scatter/line_defaults"),o=t("../scatter/fillcolor_defaults"),s=t("../scatter/text_defaults");P.exports=function(g,p,v,x){function l(C,S){return h.coerce(g,p,T,C,S)}var b=g.marker?A.isOpenSymbol(g.marker.symbol):!1,c=i.isBubble(g),M=n(g,p,x,l);if(!M){p.visible=!1;return}a(g,p,x,l),l("xhoverformat"),l("yhoverformat");var _=M<e.PTS_LINESONLY?"lines+markers":"lines";l("text"),l("hovertext"),l("hovertemplate"),l("mode",_),i.hasLines(p)&&(l("connectgaps"),f(g,p,v,x,l),l("line.shape")),i.hasMarkers(p)&&(r(g,p,v,x,l,{noAngleRef:!0,noStandOff:!0}),l("marker.line.width",b||c?1:0)),i.hasText(p)&&(l("texttemplate"),s(g,p,x,l));var y=(p.line||{}).color,w=(p.marker||{}).color;l("fill"),p.fill!=="none"&&o(g,p,v,l);var d=u.getComponentMethod("errorbars","supplyDefaults");d(g,p,y||w||v,{axis:"y"}),d(g,p,y||w||v,{axis:"x",inherit:"y"}),h.coerceSelectionMarkerOpacity(p,l)}},{"../../lib":515,"../../registry":647,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/period_defaults":956,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatter/xy_defaults":963,"./attributes":988,"./helpers":996}],994:[function(t,P,R){var h=t("../../lib"),u=t("../../components/color"),A=t("../../constants/interactions").DESELECTDIM;function T(e){var i=e[0],n=i.trace,a=i.t,r=a._scene,f=a.index,o=r.selectBatch[f],s=r.unselectBatch[f],m=r.textOptions[f],g=r.textSelectedOptions[f]||{},p=r.textUnselectedOptions[f]||{},v=h.extendFlat({},m),x,l;if(o.length||s.length){var b=g.color,c=p.color,M=m.color,_=Array.isArray(M);for(v.color=new Array(n._length),x=0;x<o.length;x++)l=o[x],v.color[l]=b||(_?M[l]:M);for(x=0;x<s.length;x++){l=s[x];var y=_?M[l]:M;v.color[l]=c||(b?y:u.addOpacity(y,A))}}r.glText[f].update(v)}P.exports={styleTextSelection:T}},{"../../components/color":367,"../../constants/interactions":490,"../../lib":515}],995:[function(t,P,R){var h=t("../scatter/format_labels");P.exports=function(A,T,e){var i=A.i;return"x"in A||(A.x=T._x[i]),"y"in A||(A.y=T._y[i]),h(A,T,e)}},{"../scatter/format_labels":945}],996:[function(t,P,R){var h=t("./constants");R.isOpenSymbol=function(u){return typeof u=="string"?h.OPEN_RE.test(u):u%200>100},R.isDotSymbol=function(u){return typeof u=="string"?h.DOT_RE.test(u):u>200}},{"./constants":991}],997:[function(t,P,R){var h=t("../../registry"),u=t("../../lib"),A=t("../scatter/get_trace_color");function T(i,n,a,r){var f=i.cd,o=f[0].t,s=f[0].trace,m=i.xa,g=i.ya,p=o.x,v=o.y,x=m.c2p(n),l=g.c2p(a),b=i.distance,c;if(o.tree){var M=m.p2c(x-b),_=m.p2c(x+b),y=g.p2c(l-b),w=g.p2c(l+b);r==="x"?c=o.tree.range(Math.min(M,_),Math.min(g._rl[0],g._rl[1]),Math.max(M,_),Math.max(g._rl[0],g._rl[1])):c=o.tree.range(Math.min(M,_),Math.min(y,w),Math.max(M,_),Math.max(y,w))}else c=o.ids;var d,C,S,E,k,B,z,F,I,O=b;if(r==="x"){var N=!!s.xperiodalignment,V=!!s.yperiodalignment;for(k=0;k<c.length;k++){if(d=c[k],S=p[d],B=Math.abs(m.c2p(S)-x),N){var H=m.c2p(s._xStarts[d]),j=m.c2p(s._xEnds[d]);B=x>=Math.min(H,j)&&x<=Math.max(H,j)?0:1/0}if(B<O){if(O=B,E=v[d],z=g.c2p(E)-l,V){var Z=g.c2p(s._yStarts[d]),X=g.c2p(s._yEnds[d]);z=l>=Math.min(Z,X)&&l<=Math.max(Z,X)?0:1/0}I=Math.sqrt(B*B+z*z),C=c[k]}}}else for(k=c.length-1;k>-1;k--)d=c[k],S=p[d],E=v[d],B=m.c2p(S)-x,z=g.c2p(E)-l,F=Math.sqrt(B*B+z*z),F<O&&(O=I=F,C=d);return i.index=C,i.distance=O,i.dxy=I,C===void 0?[i]:[e(i,p,v,s)]}function e(i,n,a,r){var f=i.xa,o=i.ya,s=i.distance,m=i.dxy,g=i.index,p={pointNumber:g,x:n[g],y:a[g]};p.tx=Array.isArray(r.text)?r.text[g]:r.text,p.htx=Array.isArray(r.hovertext)?r.hovertext[g]:r.hovertext,p.data=Array.isArray(r.customdata)?r.customdata[g]:r.customdata,p.tp=Array.isArray(r.textposition)?r.textposition[g]:r.textposition;var v=r.textfont;v&&(p.ts=u.isArrayOrTypedArray(v.size)?v.size[g]:v.size,p.tc=Array.isArray(v.color)?v.color[g]:v.color,p.tf=Array.isArray(v.family)?v.family[g]:v.family);var x=r.marker;x&&(p.ms=u.isArrayOrTypedArray(x.size)?x.size[g]:x.size,p.mo=u.isArrayOrTypedArray(x.opacity)?x.opacity[g]:x.opacity,p.mx=u.isArrayOrTypedArray(x.symbol)?x.symbol[g]:x.symbol,p.ma=u.isArrayOrTypedArray(x.angle)?x.angle[g]:x.angle,p.mc=u.isArrayOrTypedArray(x.color)?x.color[g]:x.color);var l=x&&x.line;l&&(p.mlc=Array.isArray(l.color)?l.color[g]:l.color,p.mlw=u.isArrayOrTypedArray(l.width)?l.width[g]:l.width);var b=x&&x.gradient;b&&b.type!=="none"&&(p.mgt=Array.isArray(b.type)?b.type[g]:b.type,p.mgc=Array.isArray(b.color)?b.color[g]:b.color);var c=f.c2p(p.x,!0),M=o.c2p(p.y,!0),_=p.mrc||1,y=r.hoverlabel;y&&(p.hbg=Array.isArray(y.bgcolor)?y.bgcolor[g]:y.bgcolor,p.hbc=Array.isArray(y.bordercolor)?y.bordercolor[g]:y.bordercolor,p.hts=u.isArrayOrTypedArray(y.font.size)?y.font.size[g]:y.font.size,p.htc=Array.isArray(y.font.color)?y.font.color[g]:y.font.color,p.htf=Array.isArray(y.font.family)?y.font.family[g]:y.font.family,p.hnl=u.isArrayOrTypedArray(y.namelength)?y.namelength[g]:y.namelength);var w=r.hoverinfo;w&&(p.hi=Array.isArray(w)?w[g]:w);var d=r.hovertemplate;d&&(p.ht=Array.isArray(d)?d[g]:d);var C={};C[i.index]=p;var S=r._origX,E=r._origY,k=u.extendFlat({},i,{color:A(r,p),x0:c-_,x1:c+_,xLabelVal:S?S[g]:p.x,y0:M-_,y1:M+_,yLabelVal:E?E[g]:p.y,cd:C,distance:s,spikeDistance:m,hovertemplate:p.ht});return p.htx?k.text=p.htx:p.tx?k.text=p.tx:r.text&&(k.text=r.text),u.fillText(p,r,k),h.getComponentMethod("errorbars","hoverInfo")(p,r,k),k}P.exports={hoverPoints:T,calcHover:e}},{"../../lib":515,"../../registry":647,"../scatter/get_trace_color":946}],998:[function(t,P,R){arguments[4][905][0].apply(R,arguments)},{"./base_index":989,"./plot":999,dup:905}],999:[function(t,P,m){var h=t("regl-scatter2d"),u=t("regl-line2d"),A=t("regl-error2d"),T=t("gl-text"),e=t("../../lib"),i=t("../../components/dragelement/helpers").selectMode,n=t("../../lib/prepare_regl"),a=t("../scatter/subtypes"),r=t("../scatter/link_traces"),f=t("./edit_style").styleTextSelection,o={};function s(g,p,v,x){var l=g._size,b=g.width*x,c=g.height*x,M=l.l*x,_=l.b*x,y=l.r*x,w=l.t*x,d=l.w*x,C=l.h*x;return[M+p.domain[0]*d,_+v.domain[0]*C,b-y-(1-p.domain[1])*d,c-w-(1-v.domain[1])*C]}var m=P.exports=function(p,v,x){if(!!x.length){var l=p._fullLayout,b=v._scene,c=v.xaxis,M=v.yaxis,_,y;if(!!b){var w=n(p,["ANGLE_instanced_arrays","OES_element_index_uint"],o);if(!w){b.init();return}var d=b.count,C=l._glcanvas.data()[0].regl;if(r(p,v,x),b.dirty){if(b.error2d===!0&&(b.error2d=A(C)),b.line2d===!0&&(b.line2d=u(C)),b.scatter2d===!0&&(b.scatter2d=h(C)),b.fill2d===!0&&(b.fill2d=u(C)),b.glText===!0)for(b.glText=new Array(d),_=0;_<d;_++)b.glText[_]=new T(C);if(b.glText){if(d>b.glText.length){var S=d-b.glText.length;for(_=0;_<S;_++)b.glText.push(new T(C))}else if(d<b.glText.length){var E=b.glText.length-d,k=b.glText.splice(d,E);k.forEach(function(J){J.destroy()})}for(_=0;_<d;_++)b.glText[_].update(b.textOptions[_])}if(b.line2d&&(b.line2d.update(b.lineOptions),b.lineOptions=b.lineOptions.map(function(J){if(J&&J.positions){for(var q=J.positions,ae=0;ae<q.length&&(isNaN(q[ae])||isNaN(q[ae+1]));)ae+=2;for(var le=q.length-2;le>ae&&(isNaN(q[le])||isNaN(q[le+1]));)le-=2;J.positions=q.slice(ae,le+2)}return J}),b.line2d.update(b.lineOptions)),b.error2d){var B=(b.errorXOptions||[]).concat(b.errorYOptions||[]);b.error2d.update(B)}b.scatter2d&&b.scatter2d.update(b.markerOptions),b.fillOrder=e.repeat(null,d),b.fill2d&&(b.fillOptions=b.fillOptions.map(function(J,q){var ae=x[q];if(!(!J||!ae||!ae[0]||!ae[0].trace)){var le=ae[0],ie=le.trace,se=le.t,xe=b.lineOptions[q],oe,he,be=[];ie._ownfill&&be.push(q),ie._nexttrace&&be.push(q+1),be.length&&(b.fillOrder[q]=be);var me=[],_e=xe&&xe.positions||se.positions,Se,De;if(ie.fill==="tozeroy"){for(Se=0;Se<_e.length&&isNaN(_e[Se+1]);)Se+=2;for(De=_e.length-2;De>Se&&isNaN(_e[De+1]);)De-=2;_e[Se+1]!==0&&(me=[_e[Se],0]),me=me.concat(_e.slice(Se,De+2)),_e[De+1]!==0&&(me=me.concat([_e[De],0]))}else if(ie.fill==="tozerox"){for(Se=0;Se<_e.length&&isNaN(_e[Se]);)Se+=2;for(De=_e.length-2;De>Se&&isNaN(_e[De]);)De-=2;_e[Se]!==0&&(me=[0,_e[Se+1]]),me=me.concat(_e.slice(Se,De+2)),_e[De]!==0&&(me=me.concat([0,_e[De+1]]))}else if(ie.fill==="toself"||ie.fill==="tonext"){for(me=[],oe=0,J.splitNull=!0,he=0;he<_e.length;he+=2)(isNaN(_e[he])||isNaN(_e[he+1]))&&(me=me.concat(_e.slice(oe,he)),me.push(_e[oe],_e[oe+1]),me.push(null,null),oe=he+2);me=me.concat(_e.slice(oe)),oe&&me.push(_e[oe],_e[oe+1])}else{var Ie=ie._nexttrace;if(Ie){var Te=b.lineOptions[q+1];if(Te){var Ce=Te.positions;if(ie.fill==="tonexty"){for(me=_e.slice(),q=Math.floor(Ce.length/2);q--;){var He=Ce[q*2],Xe=Ce[q*2+1];isNaN(He)||isNaN(Xe)||me.push(He,Xe)}J.fill=Ie.fillcolor}}}}if(ie._prevtrace&&ie._prevtrace.fill==="tonext"){var Be=b.lineOptions[q-1].positions,Re=me.length/2;oe=Re;var We=[oe];for(he=0;he<Be.length;he+=2)(isNaN(Be[he])||isNaN(Be[he+1]))&&(We.push(he/2+Re+1),oe=he+2);me=me.concat(Be),J.hole=We}return J.fillmode=ie.fill,J.opacity=ie.opacity,J.positions=me,J}}),b.fill2d.update(b.fillOptions))}var z=l.dragmode,F=i(z),I=l.clickmode.indexOf("select")>-1;for(_=0;_<d;_++){var O=x[_][0],N=O.trace,V=O.t,H=V.index,j=N._length,Z=V.x,X=V.y;if(N.selectedpoints||F||I){if(F||(F=!0),N.selectedpoints){var re=b.selectBatch[H]=e.selIndices2selPoints(N),ue={};for(y=0;y<re.length;y++)ue[re[y]]=1;var K=[];for(y=0;y<j;y++)ue[y]||K.push(y);b.unselectBatch[H]=K}var te=V.xpx=new Array(j),G=V.ypx=new Array(j);for(y=0;y<j;y++)te[y]=c.c2p(Z[y]),G[y]=M.c2p(X[y])}else V.xpx=V.ypx=null}if(F){if(b.select2d||(b.select2d=h(l._glcanvas.data()[1].regl)),b.scatter2d){var Y=new Array(d);for(_=0;_<d;_++)Y[_]=b.selectBatch[_].length||b.unselectBatch[_].length?b.markerUnselectedOptions[_]:{};b.scatter2d.update(Y)}b.select2d&&(b.select2d.update(b.markerOptions),b.select2d.update(b.markerSelectedOptions)),b.glText&&x.forEach(function(J){var q=((J||[])[0]||{}).trace||{};a.hasText(q)&&f(J)})}else b.scatter2d&&b.scatter2d.update(b.markerOptions);var ee={viewport:s(l,c,M,p._context.plotGlPixelRatio),range:[(c._rl||c.range)[0],(M._rl||M.range)[0],(c._rl||c.range)[1],(M._rl||M.range)[1]]},ne=e.repeat(ee,b.count);b.fill2d&&b.fill2d.update(ne),b.line2d&&b.line2d.update(ne),b.error2d&&b.error2d.update(ne.concat(ne)),b.scatter2d&&b.scatter2d.update(ne),b.select2d&&b.select2d.update(ne),b.glText&&b.glText.forEach(function(J){J.update(ee)})}}};m.reglPrecompiled=o},{"../../components/dragelement/helpers":385,"../../lib":515,"../../lib/prepare_regl":528,"../scatter/link_traces":952,"../scatter/subtypes":961,"./edit_style":994,"gl-text":225,"regl-error2d":280,"regl-line2d":281,"regl-scatter2d":282}],1e3:[function(t,P,R){var h=t("../../lib");P.exports=function(A,T){var e=T._scene,i={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},n={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return T._scene||(e=T._scene={},e.init=function(){h.extendFlat(e,n,i)},e.init(),e.update=function(r){var f=h.repeat(r,e.count);if(e.fill2d&&e.fill2d.update(f),e.scatter2d&&e.scatter2d.update(f),e.line2d&&e.line2d.update(f),e.error2d&&e.error2d.update(f.concat(f)),e.select2d&&e.select2d.update(f),e.glText)for(var o=0;o<e.count;o++)e.glText[o].update(r)},e.draw=function(){for(var r=e.count,f=e.fill2d,o=e.error2d,s=e.line2d,m=e.scatter2d,g=e.glText,p=e.select2d,v=e.selectBatch,x=e.unselectBatch,l=0;l<r;l++){if(f&&e.fillOrder[l]&&f.draw(e.fillOrder[l]),s&&e.lineOptions[l]&&s.draw(l),o&&(e.errorXOptions[l]&&o.draw(l),e.errorYOptions[l]&&o.draw(l+r)),m&&e.markerOptions[l])if(x[l].length){var b=h.repeat([],e.count);b[l]=x[l],m.draw(b)}else v[l].length||m.draw(l);g[l]&&e.textOptions[l]&&g[l].render()}p&&p.draw(v),e.dirty=!1},e.destroy=function(){e.fill2d&&e.fill2d.destroy&&e.fill2d.destroy(),e.scatter2d&&e.scatter2d.destroy&&e.scatter2d.destroy(),e.error2d&&e.error2d.destroy&&e.error2d.destroy(),e.line2d&&e.line2d.destroy&&e.line2d.destroy(),e.select2d&&e.select2d.destroy&&e.select2d.destroy(),e.glText&&e.glText.forEach(function(r){r.destroy&&r.destroy()}),e.lineOptions=null,e.fillOptions=null,e.markerOptions=null,e.markerSelectedOptions=null,e.markerUnselectedOptions=null,e.errorXOptions=null,e.errorYOptions=null,e.textOptions=null,e.textSelectedOptions=null,e.textUnselectedOptions=null,e.selectBatch=null,e.unselectBatch=null,T._scene=null}),e.dirty||h.extendFlat(e,i),e}},{"../../lib":515}],1001:[function(t,P,R){var h=t("../scatter/subtypes"),u=t("./edit_style").styleTextSelection;P.exports=function(T,e){var i=T.cd,n=T.xaxis,a=T.yaxis,r=[],f=i[0].trace,o=i[0].t,s=f._length,m=o.x,g=o.y,p=o._scene,v=o.index;if(!p)return r;var x=h.hasText(f),l=h.hasMarkers(f),b=!l&&!x;if(f.visible!==!0||b)return r;var c=[],M=[];if(e!==!1&&!e.degenerate)for(var _=0;_<s;_++)e.contains([o.xpx[_],o.ypx[_]],!1,_,T)?(c.push(_),r.push({pointNumber:_,x:n.c2d(m[_]),y:a.c2d(g[_])})):M.push(_);if(l){var y=p.scatter2d;if(!c.length&&!M.length){var w=new Array(p.count);w[v]=p.markerOptions[v],y.update.apply(y,w)}else if(!p.selectBatch[v].length&&!p.unselectBatch[v].length){var d=new Array(p.count);d[v]=p.markerUnselectedOptions[v],y.update.apply(y,d)}}return p.selectBatch[v]=c,p.unselectBatch[v]=M,x&&u(i),r}},{"../scatter/subtypes":961,"./edit_style":994}],1002:[function(t,P,R){var h=t("../../plots/template_attributes").hovertemplateAttrs,u=t("../../plots/template_attributes").texttemplateAttrs,A=t("../scattergeo/attributes"),T=t("../scatter/attributes"),e=t("../../plots/mapbox/layout_attributes"),i=t("../../plots/attributes"),n=t("../../components/colorscale/attributes"),a=t("../../lib/extend").extendFlat,r=t("../../plot_api/edit_types").overrideAll,f=t("../../plots/mapbox/layout_attributes"),o=A.line,s=A.marker;P.exports=r({lon:A.lon,lat:A.lat,cluster:{enabled:{valType:"boolean"},maxzoom:a({},f.layers.maxzoom,{}),step:{valType:"number",arrayOk:!0,dflt:-1,min:-1},size:{valType:"number",arrayOk:!0,dflt:20,min:0},color:{valType:"color",arrayOk:!0},opacity:a({},s.opacity,{dflt:1})},mode:a({},T.mode,{dflt:"markers"}),text:a({},T.text,{}),texttemplate:u({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:a({},T.hovertext,{}),line:{color:o.color,width:o.width},connectgaps:T.connectgaps,marker:a({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:s.opacity,size:s.size,sizeref:s.sizeref,sizemin:s.sizemin,sizemode:s.sizemode},n("marker")),fill:A.fill,fillcolor:T.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:T.selected.marker},unselected:{marker:T.unselected.marker},hoverinfo:a({},i.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:h()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/mapbox/layout_attributes":624,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergeo/attributes":978}],1003:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../lib"),A=t("../../constants/numerical").BADNUM,T=t("../../lib/geojson_utils"),e=t("../../components/colorscale"),i=t("../../components/drawing"),n=t("../scatter/make_bubble_size_func"),a=t("../scatter/subtypes"),r=t("../../plots/mapbox/convert_text_opts"),f=t("../../components/fx/helpers").appendArrayPointValue,o=t("../../lib/svg_text_utils").NEWLINES,s=t("../../lib/svg_text_utils").BR_TAG_ALL;P.exports=function(M,_){var y=_[0].trace,w=y.visible===!0&&y._length!==0,d=y.fill!=="none",C=a.hasLines(y),S=a.hasMarkers(y),E=a.hasText(y),k=S&&y.marker.symbol==="circle",B=S&&y.marker.symbol!=="circle",z=y.cluster&&y.cluster.enabled,F=m("fill"),I=m("line"),O=m("circle"),N=m("symbol"),V={fill:F,line:I,circle:O,symbol:N};if(!w)return V;var H;if((d||C)&&(H=T.calcTraceToLineCoords(_)),d&&(F.geojson=T.makePolygon(H),F.layout.visibility="visible",u.extendFlat(F.paint,{"fill-color":y.fillcolor})),C&&(I.geojson=T.makeLine(H),I.layout.visibility="visible",u.extendFlat(I.paint,{"line-width":y.line.width,"line-color":y.line.color,"line-opacity":y.opacity})),k){var j=g(_);O.geojson=j.geojson,O.layout.visibility="visible",z&&(O.filter=["!",["has","point_count"]],V.cluster={type:"circle",filter:["has","point_count"],layout:{visibility:"visible"},paint:{"circle-color":b(y.cluster.color,y.cluster.step),"circle-radius":b(y.cluster.size,y.cluster.step),"circle-opacity":b(y.cluster.opacity,y.cluster.step)}},V.clusterCount={type:"symbol",filter:["has","point_count"],paint:{},layout:{"text-field":"{point_count_abbreviated}","text-font":["Open Sans Regular","Arial Unicode MS Regular"],"text-size":12}}),u.extendFlat(O.paint,{"circle-color":j.mcc,"circle-radius":j.mrc,"circle-opacity":j.mo})}if(k&&z&&(O.filter=["!",["has","point_count"]]),(B||E)&&(N.geojson=p(_,M),u.extendFlat(N.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),B&&(u.extendFlat(N.layout,{"icon-size":y.marker.size/10}),"angle"in y.marker&&y.marker.angle!=="auto"&&u.extendFlat(N.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),N.layout["icon-allow-overlap"]=y.marker.allowoverlap,u.extendFlat(N.paint,{"icon-opacity":y.opacity*y.marker.opacity,"icon-color":y.marker.color})),E)){var Z=(y.marker||{}).size,X=r(y.textposition,Z);u.extendFlat(N.layout,{"text-size":y.textfont.size,"text-anchor":X.anchor,"text-offset":X.offset}),u.extendFlat(N.paint,{"text-color":y.textfont.color,"text-opacity":y.opacity})}return V};function m(c){return{type:c,geojson:T.makeBlank(),layout:{visibility:"none"},filter:null,paint:{}}}function g(c){var M=c[0].trace,_=M.marker,y=M.selectedpoints,w=u.isArrayOrTypedArray(_.color),d=u.isArrayOrTypedArray(_.size),C=u.isArrayOrTypedArray(_.opacity),S;function E(Z){return M.opacity*Z}function k(Z){return Z/2}var B;w&&(e.hasColorscale(M,"marker")?B=e.makeColorScaleFuncFromTrace(_):B=u.identity);var z;d&&(z=n(M));var F;C&&(F=function(Z){var X=h(Z)?+u.constrain(Z,0,1):0;return E(X)});var I=[];for(S=0;S<c.length;S++){var O=c[S],N=O.lonlat;if(!l(N)){var V={};B&&(V.mcc=O.mcc=B(O.mc)),z&&(V.mrc=O.mrc=z(O.ms)),F&&(V.mo=F(O.mo)),y&&(V.selected=O.selected||0),I.push({type:"Feature",id:S+1,geometry:{type:"Point",coordinates:N},properties:V})}}var H;if(y)for(H=i.makeSelectedPointStyleFns(M),S=0;S<I.length;S++){var j=I[S].properties;H.selectedOpacityFn&&(j.mo=E(H.selectedOpacityFn(j))),H.selectedColorFn&&(j.mcc=H.selectedColorFn(j)),H.selectedSizeFn&&(j.mrc=H.selectedSizeFn(j))}return{geojson:{type:"FeatureCollection",features:I},mcc:w||H&&H.selectedColorFn?{type:"identity",property:"mcc"}:_.color,mrc:d||H&&H.selectedSizeFn?{type:"identity",property:"mrc"}:k(_.size),mo:C||H&&H.selectedOpacityFn?{type:"identity",property:"mo"}:E(_.opacity)}}function p(c,M){for(var _=M._fullLayout,y=c[0].trace,w=y.marker||{},d=w.symbol,C=w.angle,S=d!=="circle"?v(d):x,E=C!=="auto"?v(C,!0):x,k=a.hasText(y)?v(y.text):x,B=[],z=0;z<c.length;z++){var F=c[z];if(!l(F.lonlat)){var I=y.texttemplate,O;if(I){var N=Array.isArray(I)?I[z]||"":I,V=y._module.formatLabels(F,y,_),H={};f(H,y,F.i);var j=y._meta||{};O=u.texttemplateString(N,V,_._d3locale,H,F,j)}else O=k(z);O&&(O=O.replace(o,"").replace(s,`
`)),B.push({type:"Feature",geometry:{type:"Point",coordinates:F.lonlat},properties:{symbol:S(z),angle:E(z),text:O}})}}return{type:"FeatureCollection",features:B}}function v(c,M){return u.isArrayOrTypedArray(c)?M?function(_){return h(c[_])?+c[_]:0}:function(_){return c[_]}:c?function(){return c}:x}function x(){return""}function l(c){return c[0]===A}function b(c,M){var _;if(u.isArrayOrTypedArray(c)&&u.isArrayOrTypedArray(M)){_=["step",["get","point_count"],c[0]];for(var y=1;y<c.length;y++)_.push(M[y-1],c[y])}else _=c;return _}},{"../../components/colorscale":379,"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"../../lib/svg_text_utils":541,"../../plots/mapbox/convert_text_opts":621,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"fast-isnumeric":190}],1004:[function(t,P,R){var h=t("../../lib"),u=t("../scatter/subtypes"),A=t("../scatter/marker_defaults"),T=t("../scatter/line_defaults"),e=t("../scatter/text_defaults"),i=t("../scatter/fillcolor_defaults"),n=t("./attributes");P.exports=function(f,o,s,m){function g(w,d){return h.coerce(f,o,n,w,d)}function p(w,d){return h.coerce2(f,o,n,w,d)}var v=a(f,o,g);if(!v){o.visible=!1;return}if(g("text"),g("texttemplate"),g("hovertext"),g("hovertemplate"),g("mode"),g("below"),u.hasLines(o)&&(T(f,o,s,m,g,{noDash:!0}),g("connectgaps")),u.hasMarkers(o)){A(f,o,s,m,g,{noLine:!0,noAngle:!0}),g("marker.allowoverlap"),g("marker.angle");var x=o.marker;x.symbol!=="circle"&&(h.isArrayOrTypedArray(x.size)&&(x.size=x.size[0]),h.isArrayOrTypedArray(x.color)&&(x.color=x.color[0]))}var l=p("cluster.maxzoom"),b=p("cluster.step"),c=p("cluster.color",o.marker&&o.marker.color||s),M=p("cluster.size"),_=p("cluster.opacity"),y=l!==!1||b!==!1||c!==!1||M!==!1||_!==!1;g("cluster.enabled",y),u.hasText(o)&&e(f,o,m,g,{noSelect:!0}),g("fill"),o.fill!=="none"&&i(f,o,s,g),h.coerceSelectionMarkerOpacity(o,g)};function a(r,f,o){var s=o("lon")||[],m=o("lat")||[],g=Math.min(s.length,m.length);return f._length=g,g}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1002}],1005:[function(t,P,R){P.exports=function(u,A){return u.lon=A.lon,u.lat=A.lat,u}},{}],1006:[function(t,P,R){var h=t("../../plots/cartesian/axes");P.exports=function(A,T,e){var i={},n=e[T.subplot]._subplot,a=n.mockAxis,r=A.lonlat;return i.lonLabel=h.tickText(a,a.c2l(r[0]),!0).text,i.latLabel=h.tickText(a,a.c2l(r[1]),!0).text,i}},{"../../plots/cartesian/axes":566}],1007:[function(t,P,R){var h=t("../../components/fx"),u=t("../../lib"),A=t("../scatter/get_trace_color"),T=u.fillText,e=t("../../constants/numerical").BADNUM,i=t("../../plots/mapbox/constants").traceLayerPrefix;function n(r,f,o){var s=r.cd,m=s[0].trace,g=r.xa,p=r.ya,v=r.subplot,x=[],l=i+m.uid+"-circle",b=m.cluster&&m.cluster.enabled;if(b){var c=v.map.queryRenderedFeatures(null,{layers:[l]});x=c.map(function(I){return I.id})}var M=f>=0?Math.floor((f+180)/360):Math.ceil((f-180)/360),_=M*360,y=f-_;function w(I){var O=I.lonlat;if(O[0]===e||b&&x.indexOf(I.i+1)===-1)return 1/0;var N=u.modHalf(O[0],360),V=O[1],H=v.project([N,V]),j=H.x-g.c2p([y,V]),Z=H.y-p.c2p([N,o]),X=Math.max(3,I.mrc||0);return Math.max(Math.sqrt(j*j+Z*Z)-X,1-3/X)}if(h.getClosest(s,w,r),r.index!==!1){var d=s[r.index],C=d.lonlat,S=[u.modHalf(C[0],360)+_,C[1]],E=g.c2p(S),k=p.c2p(S),B=d.mrc||1;r.x0=E-B,r.x1=E+B,r.y0=k-B,r.y1=k+B;var z={};z[m.subplot]={_subplot:v};var F=m._module.formatLabels(d,m,z);return r.lonLabel=F.lonLabel,r.latLabel=F.latLabel,r.color=A(m,d),r.extraText=a(m,d,s[0].t.labels),r.hovertemplate=m.hovertemplate,[r]}}function a(r,f,o){if(r.hovertemplate)return;var s=f.hi||r.hoverinfo,m=s.split("+"),g=m.indexOf("all")!==-1,p=m.indexOf("lon")!==-1,v=m.indexOf("lat")!==-1,x=f.lonlat,l=[];function b(c){return c+"\xB0"}return g||p&&v?l.push("("+b(x[1])+", "+b(x[0])+")"):p?l.push(o.lon+b(x[0])):v&&l.push(o.lat+b(x[1])),(g||m.indexOf("text")!==-1)&&T(f,r,l),l.join("<br>")}P.exports={hoverPoints:n,getExtraText:a}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/mapbox/constants":620,"../scatter/get_trace_color":946}],1008:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../scatter/marker_colorbar"),formatLabels:t("./format_labels"),calc:t("../scattergeo/calc"),plot:t("./plot"),hoverPoints:t("./hover").hoverPoints,eventData:t("./event_data"),selectPoints:t("./select"),styleOnSelect:function(h,u){if(u){var A=u[0].trace;A._glTrace.update(u)}},moduleType:"trace",name:"scattermapbox",basePlotModule:t("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":622,"../scatter/marker_colorbar":954,"../scattergeo/calc":979,"./attributes":1002,"./defaults":1004,"./event_data":1005,"./format_labels":1006,"./hover":1007,"./plot":1009,"./select":1010}],1009:[function(t,P,R){var h=t("../../lib"),u=t("./convert"),A=t("../../plots/mapbox/constants").traceLayerPrefix,T={cluster:["cluster","clusterCount","circle"],nonCluster:["fill","line","circle","symbol"]};function e(n,a,r){this.type="scattermapbox",this.subplot=n,this.uid=a,this.clusterEnabled=r,this.sourceIds={fill:"source-"+a+"-fill",line:"source-"+a+"-line",circle:"source-"+a+"-circle",symbol:"source-"+a+"-symbol",cluster:"source-"+a+"-circle",clusterCount:"source-"+a+"-circle"},this.layerIds={fill:A+a+"-fill",line:A+a+"-line",circle:A+a+"-circle",symbol:A+a+"-symbol",cluster:A+a+"-cluster",clusterCount:A+a+"-cluster-count"},this.below=null}var i=e.prototype;i.addSource=function(n,a,r){var f={type:"geojson",data:a.geojson};r&&r.enabled&&h.extendFlat(f,{cluster:!0,clusterMaxZoom:r.maxzoom}),this.subplot.map.addSource(this.sourceIds[n],f)},i.setSourceData=function(n,a){this.subplot.map.getSource(this.sourceIds[n]).setData(a.geojson)},i.addLayer=function(n,a,r){var f={type:a.type,id:this.layerIds[n],source:this.sourceIds[n],layout:a.layout,paint:a.paint};a.filter&&(f.filter=a.filter),this.subplot.addLayer(f,r)},i.update=function(a){var r=a[0].trace,f=this.subplot,o=f.map,s=u(f.gd,a),m=f.belowLookup["trace-"+this.uid],g,p,v,x=!!(r.cluster&&r.cluster.enabled),l=!!this.clusterEnabled;if(m!==this.below){var b=T.nonCluster;for(g=b.length-1;g>=0;g--)p=b[g],o.removeLayer(this.layerIds[p]);for(g=0;g<b.length;g++)p=b[g],v=s[p],this.addLayer(p,v,m);this.below=m}else if(x&&!l){for(g=T.nonCluster.length-1;g>=0;g--)p=T.nonCluster[g],o.removeLayer(this.layerIds[p]),o.removeSource(this.sourceIds[p]);for(this.addSource("circle",s.circle,r.cluster),g=0;g<T.cluster.length;g++)p=T.cluster[g],v=s[p],this.addLayer(p,v,m);this.clusterEnabled=x}else if(!x&&l){for(g=0;g<T.cluster.length;g++)p=T.cluster[g],o.removeLayer(this.layerIds[p]);for(o.removeSource(this.sourceIds.circle),g=0;g<T.nonCluster.length;g++)p=T.nonCluster[g],v=s[p],this.addSource(p,v,r.cluster),this.addLayer(p,v,m);this.clusterEnabled=x}a[0].trace._glTrace=this},i.dispose=function(){for(var a=this.subplot.map,r=this.clusterEnabled?T.cluster:T.nonCluster,f=r.length-1;f>=0;f--){var o=r[f];a.removeLayer(this.layerIds[o]),a.removeSource(this.sourceIds[o])}},P.exports=function(a,r){var f=r[0].trace,o=f.cluster&&f.cluster.enabled,s=new e(a,f.uid,o),m=u(a.gd,r),g=s.below=a.belowLookup["trace-"+f.uid],p,v,x;if(o)for(s.addSource("circle",m.circle,f.cluster),p=0;p<T.cluster.length;p++)v=T.cluster[p],x=m[v],s.addLayer(v,x,g);else for(p=0;p<T.nonCluster.length;p++)v=T.nonCluster[p],x=m[v],s.addSource(v,x,f.cluster),s.addLayer(v,x,g);return r[0].trace._glTrace=s,s}},{"../../lib":515,"../../plots/mapbox/constants":620,"./convert":1003}],1010:[function(t,P,R){var h=t("../../lib"),u=t("../scatter/subtypes"),A=t("../../constants/numerical").BADNUM;P.exports=function(e,i){var n=e.cd,a=e.xaxis,r=e.yaxis,f=[],o=n[0].trace,s;if(!u.hasMarkers(o))return[];if(i===!1)for(s=0;s<n.length;s++)n[s].selected=0;else for(s=0;s<n.length;s++){var m=n[s],g=m.lonlat;if(g[0]!==A){var p=[h.modHalf(g[0],360),g[1]],v=[a.c2p(p),r.c2p(p)];i.contains(v,null,s,e)?(f.push({pointNumber:s,lon:g[0],lat:g[1]}),m.selected=1):m.selected=0}}return f}},{"../../constants/numerical":491,"../../lib":515,"../scatter/subtypes":961}],1011:[function(t,P,R){var h=t("../../plots/template_attributes").hovertemplateAttrs,u=t("../../plots/template_attributes").texttemplateAttrs,A=t("../../lib/extend").extendFlat,T=t("../scatter/attributes"),e=t("../../plots/attributes"),i=T.line;P.exports={mode:T.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:T.text,texttemplate:u({editType:"plot"},{keys:["r","theta","text"]}),hovertext:T.hovertext,line:{color:i.color,width:i.width,dash:i.dash,backoff:i.backoff,shape:A({},i.shape,{values:["linear","spline"]}),smoothing:i.smoothing,editType:"calc"},connectgaps:T.connectgaps,marker:T.marker,cliponaxis:A({},T.cliponaxis,{dflt:!1}),textposition:T.textposition,textfont:T.textfont,fill:A({},T.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:T.fillcolor,hoverinfo:A({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:T.hoveron,hovertemplate:h(),selected:T.selected,unselected:T.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1012:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../constants/numerical").BADNUM,A=t("../../plots/cartesian/axes"),T=t("../scatter/colorscale_calc"),e=t("../scatter/arrays_to_calcdata"),i=t("../scatter/calc_selection"),n=t("../scatter/calc").calcMarkerSize;P.exports=function(r,f){for(var o=r._fullLayout,s=f.subplot,m=o[s].radialaxis,g=o[s].angularaxis,p=m.makeCalcdata(f,"r"),v=g.makeCalcdata(f,"theta"),x=f._length,l=new Array(x),b=0;b<x;b++){var c=p[b],M=v[b],_=l[b]={};h(c)&&h(M)?(_.r=c,_.theta=M):_.r=u}var y=n(f,x);return f._extremes.x=A.findExtremes(m,p,{ppad:y}),T(r,f),e(l,f),i(l,f),l}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1013:[function(t,P,R){var h=t("../../lib"),u=t("../scatter/subtypes"),A=t("../scatter/marker_defaults"),T=t("../scatter/line_defaults"),e=t("../scatter/line_shape_defaults"),i=t("../scatter/text_defaults"),n=t("../scatter/fillcolor_defaults"),a=t("../scatter/constants").PTS_LINESONLY,r=t("./attributes");function f(s,m,g,p){function v(b,c){return h.coerce(s,m,r,b,c)}var x=o(s,m,p,v);if(!x){m.visible=!1;return}v("thetaunit"),v("mode",x<a?"lines+markers":"lines"),v("text"),v("hovertext"),m.hoveron!=="fills"&&v("hovertemplate"),u.hasLines(m)&&(T(s,m,g,p,v,{backoff:!0}),e(s,m,v),v("connectgaps")),u.hasMarkers(m)&&A(s,m,g,p,v,{gradient:!0}),u.hasText(m)&&(v("texttemplate"),i(s,m,p,v));var l=[];(u.hasMarkers(m)||u.hasText(m))&&(v("cliponaxis"),v("marker.maxdisplayed"),l.push("points")),v("fill"),m.fill!=="none"&&(n(s,m,g,v),u.hasLines(m)||e(s,m,v)),(m.fill==="tonext"||m.fill==="toself")&&l.push("fills"),v("hoveron",l.join("+")||"points"),h.coerceSelectionMarkerOpacity(m,v)}function o(s,m,g,p){var v=p("r"),x=p("theta"),l;if(v)x?l=Math.min(v.length,x.length):(l=v.length,p("theta0"),p("dtheta"));else{if(!x)return 0;l=m.theta.length,p("r0"),p("dr")}return m._length=l,l}P.exports={handleRThetaDefaults:o,supplyDefaults:f}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1011}],1014:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axes");P.exports=function(T,e,i){var n={},a=i[e.subplot]._subplot,r,f;a?(r=a.radialAxis,f=a.angularAxis):(a=i[e.subplot],r=a.radialaxis,f=a.angularaxis);var o=r.c2l(T.r);n.rLabel=u.tickText(r,o,!0).text;var s=f.thetaunit==="degrees"?h.rad2deg(T.theta):T.theta;return n.thetaLabel=u.tickText(f,s,!0).text,n}},{"../../lib":515,"../../plots/cartesian/axes":566}],1015:[function(t,P,R){var h=t("../scatter/hover");function u(T,e,i,n){var a=h(T,e,i,n);if(!(!a||a[0].index===!1)){var r=a[0];if(r.index===void 0)return a;var f=T.subplot,o=r.cd[r.index],s=r.trace;if(!!f.isPtInside(o))return r.xLabelVal=void 0,r.yLabelVal=void 0,A(o,s,f,r),r.hovertemplate=s.hovertemplate,a}}function A(T,e,i,n){var a=i.radialAxis,r=i.angularAxis;a._hovertitle="r",r._hovertitle="\u03B8";var f={};f[e.subplot]={_subplot:i};var o=e._module.formatLabels(T,e,f);n.rLabel=o.rLabel,n.thetaLabel=o.thetaLabel;var s=T.hi||e.hoverinfo,m=[];function g(v,x){m.push(v._hovertitle+": "+x)}if(!e.hovertemplate){var p=s.split("+");p.indexOf("all")!==-1&&(p=["r","theta","text"]),p.indexOf("r")!==-1&&g(a,n.rLabel),p.indexOf("theta")!==-1&&g(r,n.thetaLabel),p.indexOf("text")!==-1&&n.text&&(m.push(n.text),delete n.text),n.extraText=m.join("<br>")}}P.exports={hoverPoints:u,makeHoverPointText:A}},{"../scatter/hover":947}],1016:[function(t,P,R){P.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:t("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:t("./attributes"),supplyDefaults:t("./defaults").supplyDefaults,colorbar:t("../scatter/marker_colorbar"),formatLabels:t("./format_labels"),calc:t("./calc"),plot:t("./plot"),style:t("../scatter/style").style,styleOnSelect:t("../scatter/style").styleOnSelect,hoverPoints:t("./hover").hoverPoints,selectPoints:t("../scatter/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1011,"./calc":1012,"./defaults":1013,"./format_labels":1014,"./hover":1015,"./plot":1017}],1017:[function(t,P,R){var h=t("../scatter/plot"),u=t("../../constants/numerical").BADNUM;P.exports=function(T,e,i){for(var n=e.layers.frontplot.select("g.scatterlayer"),a=e.xaxis,r=e.yaxis,f={xaxis:a,yaxis:r,plot:e.framework,layerClipId:e._hasClipOnAxisFalse?e.clipIds.forTraces:null},o=e.radialAxis,s=e.angularAxis,m=0;m<i.length;m++)for(var g=i[m],p=0;p<g.length;p++){p===0&&(g[0].trace._xA=a,g[0].trace._yA=r);var v=g[p],x=v.r;if(x===u)v.x=v.y=u;else{var l=o.c2g(x),b=s.c2g(v.theta);v.x=l*Math.cos(b),v.y=l*Math.sin(b)}}h(T,f,i,n)}},{"../../constants/numerical":491,"../scatter/plot":957}],1018:[function(t,P,R){var h=t("../scatterpolar/attributes"),u=t("../scattergl/attributes"),A=t("../../plots/template_attributes").texttemplateAttrs;P.exports={mode:h.mode,r:h.r,theta:h.theta,r0:h.r0,dr:h.dr,theta0:h.theta0,dtheta:h.dtheta,thetaunit:h.thetaunit,text:h.text,texttemplate:A({editType:"plot"},{keys:["r","theta","text"]}),hovertext:h.hovertext,hovertemplate:h.hovertemplate,line:u.line,connectgaps:u.connectgaps,marker:u.marker,fill:u.fill,fillcolor:u.fillcolor,textposition:u.textposition,textfont:u.textfont,hoverinfo:h.hoverinfo,selected:h.selected,unselected:h.unselected}},{"../../plots/template_attributes":642,"../scattergl/attributes":988,"../scatterpolar/attributes":1011}],1019:[function(t,P,R){P.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:t("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../scatter/marker_colorbar"),formatLabels:t("./format_labels"),calc:t("./calc"),hoverPoints:t("./hover").hoverPoints,selectPoints:t("../scattergl/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scattergl/select":1001,"./attributes":1018,"./calc":1020,"./defaults":1021,"./format_labels":1022,"./hover":1023}],1020:[function(t,P,R){var h=t("../scatter/colorscale_calc"),u=t("../scatter/calc").calcMarkerSize,A=t("../scattergl/convert"),T=t("../../plots/cartesian/axes"),e=t("../scattergl/constants").TOO_MANY_POINTS;P.exports=function(n,a){var r=n._fullLayout,f=a.subplot,o=r[f].radialaxis,s=r[f].angularaxis,m=a._r=o.makeCalcdata(a,"r"),g=a._theta=s.makeCalcdata(a,"theta"),p=a._length,v={};p<m.length&&(m=m.slice(0,p)),p<g.length&&(g=g.slice(0,p)),v.r=m,v.theta=g,h(n,a);var x=v.opts=A.style(n,a),l;return p<e?l=u(a,p):x.marker&&(l=2*(x.marker.sizeAvg||Math.max(x.marker.size,3))),a._extremes.x=T.findExtremes(o,m,{ppad:l}),[{x:!1,y:!1,t:v,trace:a}]}},{"../../plots/cartesian/axes":566,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992}],1021:[function(t,P,R){var h=t("../../lib"),u=t("../scatter/subtypes"),A=t("../scatterpolar/defaults").handleRThetaDefaults,T=t("../scatter/marker_defaults"),e=t("../scatter/line_defaults"),i=t("../scatter/text_defaults"),n=t("../scatter/fillcolor_defaults"),a=t("../scatter/constants").PTS_LINESONLY,r=t("./attributes");P.exports=function(o,s,m,g){function p(x,l){return h.coerce(o,s,r,x,l)}var v=A(o,s,g,p);if(!v){s.visible=!1;return}p("thetaunit"),p("mode",v<a?"lines+markers":"lines"),p("text"),p("hovertext"),s.hoveron!=="fills"&&p("hovertemplate"),u.hasLines(s)&&(e(o,s,m,g,p),p("connectgaps")),u.hasMarkers(s)&&T(o,s,m,g,p,{noAngleRef:!0,noStandOff:!0}),u.hasText(s)&&(p("texttemplate"),i(o,s,g,p)),p("fill"),s.fill!=="none"&&n(o,s,m,p),h.coerceSelectionMarkerOpacity(s,p)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatterpolar/defaults":1013,"./attributes":1018}],1022:[function(t,P,R){var h=t("../scatterpolar/format_labels");P.exports=function(A,T,e){var i=A.i;return"r"in A||(A.r=T._r[i]),"theta"in A||(A.theta=T._theta[i]),h(A,T,e)}},{"../scatterpolar/format_labels":1014}],1023:[function(t,P,R){var h=t("../scattergl/hover"),u=t("../scatterpolar/hover").makeHoverPointText;function A(T,e,i,n){var a=T.cd,r=a[0].t,f=r.r,o=r.theta,s=h.hoverPoints(T,e,i,n);if(!(!s||s[0].index===!1)){var m=s[0];if(m.index===void 0)return s;var g=T.subplot,p=m.cd[m.index],v=m.trace;if(p.r=f[m.index],p.theta=o[m.index],!!g.isPtInside(p))return m.xLabelVal=void 0,m.yLabelVal=void 0,u(p,v,g,m),s}}P.exports={hoverPoints:A}},{"../scattergl/hover":997,"../scatterpolar/hover":1015}],1024:[function(t,P,R){arguments[4][905][0].apply(R,arguments)},{"./base_index":1019,"./plot":1025,dup:905}],1025:[function(t,P,R){var h=t("@plotly/point-cluster"),u=t("fast-isnumeric"),A=t("../scattergl/plot"),T=t("../scattergl/scene_update"),e=t("../scattergl/convert"),i=t("../../lib"),n=t("../scattergl/constants").TOO_MANY_POINTS,a={};P.exports=function(f,o,s){if(!!s.length){var m=o.radialAxis,g=o.angularAxis,p=T(f,o);return s.forEach(function(v){if(!(!v||!v[0]||!v[0].trace)){var x=v[0],l=x.trace,b=x.t,c=l._length,M=b.r,_=b.theta,y=b.opts,w,d=M.slice(),C=_.slice();for(w=0;w<M.length;w++)o.isPtInside({r:M[w],theta:_[w]})||(d[w]=NaN,C[w]=NaN);var S=new Array(c*2),E=Array(c),k=Array(c);for(w=0;w<c;w++){var B=d[w],z,F;if(u(B)){var I=m.c2g(B),O=g.c2g(C[w],l.thetaunit);z=I*Math.cos(O),F=I*Math.sin(O)}else z=F=NaN;E[w]=S[w*2]=z,k[w]=S[w*2+1]=F}b.tree=h(S),y.marker&&c>=n&&(y.marker.cluster=b.tree),y.marker&&(y.markerSel.positions=y.markerUnsel.positions=y.marker.positions=S),y.line&&S.length>1&&i.extendFlat(y.line,e.linePositions(f,l,S)),y.text&&(i.extendFlat(y.text,{positions:S},e.textPosition(f,l,y.text,y.marker)),i.extendFlat(y.textSel,{positions:S},e.textPosition(f,l,y.text,y.markerSel)),i.extendFlat(y.textUnsel,{positions:S},e.textPosition(f,l,y.text,y.markerUnsel))),y.fill&&!p.fill2d&&(p.fill2d=!0),y.marker&&!p.scatter2d&&(p.scatter2d=!0),y.line&&!p.line2d&&(p.line2d=!0),y.text&&!p.glText&&(p.glText=!0),p.lineOptions.push(y.line),p.fillOptions.push(y.fill),p.markerOptions.push(y.marker),p.markerSelectedOptions.push(y.markerSel),p.markerUnselectedOptions.push(y.markerUnsel),p.textOptions.push(y.text),p.textSelectedOptions.push(y.textSel),p.textUnselectedOptions.push(y.textUnsel),p.selectBatch.push([]),p.unselectBatch.push([]),b.x=E,b.y=k,b.rawx=E,b.rawy=k,b.r=M,b.theta=_,b.positions=S,b._scene=p,b.index=p.count,p.count++}}),A(f,o,s)}},P.exports.reglPrecompiled=a},{"../../lib":515,"../scattergl/constants":991,"../scattergl/convert":992,"../scattergl/plot":999,"../scattergl/scene_update":1e3,"@plotly/point-cluster":59,"fast-isnumeric":190}],1026:[function(t,P,R){var h=t("../../plots/template_attributes").hovertemplateAttrs,u=t("../../plots/template_attributes").texttemplateAttrs,A=t("../../lib/extend").extendFlat,T=t("../scatter/attributes"),e=t("../../plots/attributes"),i=T.line;P.exports={mode:T.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:T.text,texttemplate:u({editType:"plot"},{keys:["real","imag","text"]}),hovertext:T.hovertext,line:{color:i.color,width:i.width,dash:i.dash,backoff:i.backoff,shape:A({},i.shape,{values:["linear","spline"]}),smoothing:i.smoothing,editType:"calc"},connectgaps:T.connectgaps,marker:T.marker,cliponaxis:A({},T.cliponaxis,{dflt:!1}),textposition:T.textposition,textfont:T.textfont,fill:A({},T.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:T.fillcolor,hoverinfo:A({},e.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:T.hoveron,hovertemplate:h(),selected:T.selected,unselected:T.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1027:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../../constants/numerical").BADNUM,A=t("../scatter/colorscale_calc"),T=t("../scatter/arrays_to_calcdata"),e=t("../scatter/calc_selection"),i=t("../scatter/calc").calcMarkerSize;P.exports=function(a,r){for(var f=a._fullLayout,o=r.subplot,s=f[o].realaxis,m=f[o].imaginaryaxis,g=s.makeCalcdata(r,"real"),p=m.makeCalcdata(r,"imag"),v=r._length,x=new Array(v),l=0;l<v;l++){var b=g[l],c=p[l],M=x[l]={};h(b)&&h(c)?(M.real=b,M.imag=c):M.real=u}return i(r,v),A(a,r),T(x,r),e(x,r),x}},{"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1028:[function(t,P,R){var h=t("../../lib"),u=t("../scatter/subtypes"),A=t("../scatter/marker_defaults"),T=t("../scatter/line_defaults"),e=t("../scatter/line_shape_defaults"),i=t("../scatter/text_defaults"),n=t("../scatter/fillcolor_defaults"),a=t("../scatter/constants").PTS_LINESONLY,r=t("./attributes");P.exports=function(s,m,g,p){function v(b,c){return h.coerce(s,m,r,b,c)}var x=f(s,m,p,v);if(!x){m.visible=!1;return}v("mode",x<a?"lines+markers":"lines"),v("text"),v("hovertext"),m.hoveron!=="fills"&&v("hovertemplate"),u.hasLines(m)&&(T(s,m,g,p,v,{backoff:!0}),e(s,m,v),v("connectgaps")),u.hasMarkers(m)&&A(s,m,g,p,v,{gradient:!0}),u.hasText(m)&&(v("texttemplate"),i(s,m,p,v));var l=[];(u.hasMarkers(m)||u.hasText(m))&&(v("cliponaxis"),v("marker.maxdisplayed"),l.push("points")),v("fill"),m.fill!=="none"&&(n(s,m,g,v),u.hasLines(m)||e(s,m,v)),(m.fill==="tonext"||m.fill==="toself")&&l.push("fills"),v("hoveron",l.join("+")||"points"),h.coerceSelectionMarkerOpacity(m,v)};function f(o,s,m,g){var p=g("real"),v=g("imag"),x;return p&&v&&(x=Math.min(p.length,v.length)),s._length=x,x}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1026}],1029:[function(t,P,R){var h=t("../../plots/cartesian/axes");P.exports=function(A,T,e){var i={},n=e[T.subplot]._subplot;return i.realLabel=h.tickText(n.radialAxis,A.real,!0).text,i.imagLabel=h.tickText(n.angularAxis,A.imag,!0).text,i}},{"../../plots/cartesian/axes":566}],1030:[function(t,P,R){var h=t("../scatter/hover");function u(T,e,i,n){var a=h(T,e,i,n);if(!(!a||a[0].index===!1)){var r=a[0];if(r.index===void 0)return a;var f=T.subplot,o=r.cd[r.index],s=r.trace;if(!!f.isPtInside(o))return r.xLabelVal=void 0,r.yLabelVal=void 0,A(o,s,f,r),r.hovertemplate=s.hovertemplate,a}}function A(T,e,i,n){var a=i.radialAxis,r=i.angularAxis;a._hovertitle="real",r._hovertitle="imag";var f={};f[e.subplot]={_subplot:i};var o=e._module.formatLabels(T,e,f);n.realLabel=o.realLabel,n.imagLabel=o.imagLabel;var s=T.hi||e.hoverinfo,m=[];function g(v,x){m.push(v._hovertitle+": "+x)}if(!e.hovertemplate){var p=s.split("+");p.indexOf("all")!==-1&&(p=["real","imag","text"]),p.indexOf("real")!==-1&&g(a,n.realLabel),p.indexOf("imag")!==-1&&g(r,n.imagLabel),p.indexOf("text")!==-1&&n.text&&(m.push(n.text),delete n.text),n.extraText=m.join("<br>")}}P.exports={hoverPoints:u,makeHoverPointText:A}},{"../scatter/hover":947}],1031:[function(t,P,R){P.exports={moduleType:"trace",name:"scattersmith",basePlotModule:t("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../scatter/marker_colorbar"),formatLabels:t("./format_labels"),calc:t("./calc"),plot:t("./plot"),style:t("../scatter/style").style,styleOnSelect:t("../scatter/style").styleOnSelect,hoverPoints:t("./hover").hoverPoints,selectPoints:t("../scatter/select"),meta:{}}},{"../../plots/smith":638,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1026,"./calc":1027,"./defaults":1028,"./format_labels":1029,"./hover":1030,"./plot":1032}],1032:[function(t,P,R){var h=t("../scatter/plot"),u=t("../../constants/numerical").BADNUM,A=t("../../plots/smith/helpers"),T=A.smith;P.exports=function(i,n,a){for(var r=n.layers.frontplot.select("g.scatterlayer"),f=n.xaxis,o=n.yaxis,s={xaxis:f,yaxis:o,plot:n.framework,layerClipId:n._hasClipOnAxisFalse?n.clipIds.forTraces:null},m=0;m<a.length;m++)for(var g=a[m],p=0;p<g.length;p++){p===0&&(g[0].trace._xA=f,g[0].trace._yA=o);var v=g[p],x=v.real;if(x===u)v.x=v.y=u;else{var l=T([x,v.imag]);v.x=l[0],v.y=l[1]}}h(i,s,a,r)}},{"../../constants/numerical":491,"../../plots/smith/helpers":637,"../scatter/plot":957}],1033:[function(t,P,R){var h=t("../../plots/template_attributes").hovertemplateAttrs,u=t("../../plots/template_attributes").texttemplateAttrs,A=t("../scatter/attributes"),T=t("../../plots/attributes"),e=t("../../components/colorscale/attributes"),i=t("../../components/drawing/attributes").dash,n=t("../../lib/extend").extendFlat,a=A.marker,r=A.line,f=a.line;P.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:n({},A.mode,{dflt:"markers"}),text:n({},A.text,{}),texttemplate:u({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:n({},A.hovertext,{}),line:{color:r.color,width:r.width,dash:i,backoff:r.backoff,shape:n({},r.shape,{values:["linear","spline"]}),smoothing:r.smoothing,editType:"calc"},connectgaps:A.connectgaps,cliponaxis:A.cliponaxis,fill:n({},A.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:A.fillcolor,marker:n({symbol:a.symbol,opacity:a.opacity,angle:a.angle,angleref:a.angleref,standoff:a.standoff,maxdisplayed:a.maxdisplayed,size:a.size,sizeref:a.sizeref,sizemin:a.sizemin,sizemode:a.sizemode,line:n({width:f.width,editType:"calc"},e("marker.line")),gradient:a.gradient,editType:"calc"},e("marker")),textfont:A.textfont,textposition:A.textposition,selected:A.selected,unselected:A.unselected,hoverinfo:n({},T.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:A.hoveron,hovertemplate:h()}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1034:[function(t,P,R){var h=t("fast-isnumeric"),u=t("../scatter/colorscale_calc"),A=t("../scatter/arrays_to_calcdata"),T=t("../scatter/calc_selection"),e=t("../scatter/calc").calcMarkerSize,i=["a","b","c"],n={a:["b","c"],b:["a","c"],c:["a","b"]};P.exports=function(r,f){var o=r._fullLayout[f.subplot],s=o.sum,m=f.sum||s,g={a:f.a,b:f.b,c:f.c},p,v,x,l,b,c;for(p=0;p<i.length;p++)if(x=i[p],!g[x]){for(b=g[n[x][0]],c=g[n[x][1]],l=new Array(b.length),v=0;v<b.length;v++)l[v]=m-b[v]-c[v];g[x]=l}var M=f._length,_=new Array(M),y,w,d,C,S,E;for(p=0;p<M;p++)y=g.a[p],w=g.b[p],d=g.c[p],h(y)&&h(w)&&h(d)?(y=+y,w=+w,d=+d,C=s/(y+w+d),C!==1&&(y*=C,w*=C,d*=C),E=y,S=d-w,_[p]={x:S,y:E,a:y,b:w,c:d}):_[p]={x:!1,y:!1};return e(f,M),u(r,f),A(_,f),T(_,f),_}},{"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1035:[function(t,P,R){var h=t("../../lib"),u=t("../scatter/constants"),A=t("../scatter/subtypes"),T=t("../scatter/marker_defaults"),e=t("../scatter/line_defaults"),i=t("../scatter/line_shape_defaults"),n=t("../scatter/text_defaults"),a=t("../scatter/fillcolor_defaults"),r=t("./attributes");P.exports=function(o,s,m,g){function p(_,y){return h.coerce(o,s,r,_,y)}var v=p("a"),x=p("b"),l=p("c"),b;if(v?(b=v.length,x?(b=Math.min(b,x.length),l&&(b=Math.min(b,l.length))):l?b=Math.min(b,l.length):b=0):x&&l&&(b=Math.min(x.length,l.length)),!b){s.visible=!1;return}s._length=b,p("sum"),p("text"),p("hovertext"),s.hoveron!=="fills"&&p("hovertemplate");var c=b<u.PTS_LINESONLY?"lines+markers":"lines";p("mode",c),A.hasLines(s)&&(e(o,s,m,g,p,{backoff:!0}),i(o,s,p),p("connectgaps")),A.hasMarkers(s)&&T(o,s,m,g,p,{gradient:!0}),A.hasText(s)&&(p("texttemplate"),n(o,s,g,p));var M=[];(A.hasMarkers(s)||A.hasText(s))&&(p("cliponaxis"),p("marker.maxdisplayed"),M.push("points")),p("fill"),s.fill!=="none"&&(a(o,s,m,p),A.hasLines(s)||i(o,s,p)),(s.fill==="tonext"||s.fill==="toself")&&M.push("fills"),p("hoveron",M.join("+")||"points"),h.coerceSelectionMarkerOpacity(s,p)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1033}],1036:[function(t,P,R){P.exports=function(u,A,T,e,i){if(A.xa&&(u.xaxis=A.xa),A.ya&&(u.yaxis=A.ya),e[i]){var n=e[i];u.a=n.a,u.b=n.b,u.c=n.c}else u.a=A.a,u.b=A.b,u.c=A.c;return u}},{}],1037:[function(t,P,R){var h=t("../../plots/cartesian/axes");P.exports=function(A,T,e){var i={},n=e[T.subplot]._subplot;return i.aLabel=h.tickText(n.aaxis,A.a,!0).text,i.bLabel=h.tickText(n.baxis,A.b,!0).text,i.cLabel=h.tickText(n.caxis,A.c,!0).text,i}},{"../../plots/cartesian/axes":566}],1038:[function(t,P,R){var h=t("../scatter/hover");P.exports=function(A,T,e,i){var n=h(A,T,e,i);if(!n||n[0].index===!1)return;var a=n[0];if(a.index===void 0){var r=1-a.y0/A.ya._length,f=A.xa._length,o=f*r/2,s=f-o;return a.x0=Math.max(Math.min(a.x0,s),o),a.x1=Math.max(Math.min(a.x1,s),o),n}var m=a.cd[a.index],g=a.trace,p=a.subplot;a.a=m.a,a.b=m.b,a.c=m.c,a.xLabelVal=void 0,a.yLabelVal=void 0;var v={};v[g.subplot]={_subplot:p};var x=g._module.formatLabels(m,g,v);a.aLabel=x.aLabel,a.bLabel=x.bLabel,a.cLabel=x.cLabel;var l=m.hi||g.hoverinfo,b=[];function c(_,y){b.push(_._hovertitle+": "+y)}if(!g.hovertemplate){var M=l.split("+");M.indexOf("all")!==-1&&(M=["a","b","c"]),M.indexOf("a")!==-1&&c(p.aaxis,a.aLabel),M.indexOf("b")!==-1&&c(p.baxis,a.bLabel),M.indexOf("c")!==-1&&c(p.caxis,a.cLabel)}return a.extraText=b.join("<br>"),a.hovertemplate=g.hovertemplate,n}},{"../scatter/hover":947}],1039:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../scatter/marker_colorbar"),formatLabels:t("./format_labels"),calc:t("./calc"),plot:t("./plot"),style:t("../scatter/style").style,styleOnSelect:t("../scatter/style").styleOnSelect,hoverPoints:t("./hover"),selectPoints:t("../scatter/select"),eventData:t("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:t("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":643,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1033,"./calc":1034,"./defaults":1035,"./event_data":1036,"./format_labels":1037,"./hover":1038,"./plot":1040}],1040:[function(t,P,R){var h=t("../scatter/plot");P.exports=function(A,T,e){var i=T.plotContainer;i.select(".scatterlayer").selectAll("*").remove();for(var n=T.xaxis,a=T.yaxis,r={xaxis:n,yaxis:a,plot:i,layerClipId:T._hasClipOnAxisFalse?T.clipIdRelative:null},f=T.layers.frontplot.select("g.scatterlayer"),o=0;o<e.length;o++){var s=e[o];s.length&&(s[0].trace._xA=n,s[0].trace._yA=a)}h(A,r,e,f)}},{"../scatter/plot":957}],1041:[function(t,P,R){var h=t("../scatter/attributes"),u=t("../../components/colorscale/attributes"),A=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,T=t("../../plots/template_attributes").hovertemplateAttrs,e=t("../scattergl/attributes"),i=t("../../plots/cartesian/constants").idRegex,n=t("../../plot_api/plot_template").templatedArray,a=t("../../lib/extend").extendFlat,r=h.marker,f=r.line,o=a(u("marker.line",{editTypeOverride:"calc"}),{width:a({},f.width,{editType:"calc"}),editType:"calc"}),s=a(u("marker"),{symbol:r.symbol,angle:r.angle,size:a({},r.size,{editType:"markerSize"}),sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,opacity:r.opacity,colorbar:r.colorbar,line:o,editType:"calc"});s.color.editType=s.cmin.editType=s.cmax.editType="style";function m(g){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:i[g],editType:"plot"}}}P.exports={dimensions:n("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:a({},e.text,{}),hovertext:a({},e.hovertext,{}),hovertemplate:T(),xhoverformat:A("x"),yhoverformat:A("y"),marker:s,xaxes:m("x"),yaxes:m("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/constants":573,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergl/attributes":988}],1042:[function(t,P,R){var h=t("../../registry"),u=t("../../components/grid");P.exports={moduleType:"trace",name:"splom",categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../scatter/marker_colorbar"),calc:t("./calc"),plot:t("./plot"),hoverPoints:t("./hover").hoverPoints,selectPoints:t("./select"),editStyle:t("./edit_style"),meta:{}},h.register(u)},{"../../components/grid":411,"../../registry":647,"../scatter/marker_colorbar":954,"./attributes":1041,"./calc":1044,"./defaults":1045,"./edit_style":1046,"./hover":1048,"./plot":1050,"./select":1052}],1043:[function(t,P,R){var h=t("regl-line2d"),u=t("../../registry"),A=t("../../lib/prepare_regl"),T=t("../../plots/get_data").getModuleCalcData,e=t("../../plots/cartesian"),i=t("../../plots/cartesian/axis_ids").getFromId,n=t("../../plots/cartesian/axes").shouldShowZeroLine,a="splom",r={};function f(v){var x=v._fullLayout,l=u.getModule(a),b=T(v.calcdata,l)[0],c=A(v,["ANGLE_instanced_arrays","OES_element_index_uint"],r);!c||(x._hasOnlyLargeSploms&&m(v),l.plot(v,{},b))}function o(v){var x=v.calcdata,l=v._fullLayout;l._hasOnlyLargeSploms&&m(v);for(var b=0;b<x.length;b++){var c=x[b][0],M=c.trace,_=l._splomScenes[M.uid];M.type==="splom"&&_&&_.matrix&&s(v,M,_)}}function s(v,x,l){for(var b=l.matrixOptions.data.length,c=x._visibleDims,M=l.viewOpts.ranges=new Array(b),_=0;_<c.length;_++){var y=c[_],w=M[_]=new Array(4),d=i(v,x._diag[y][0]);d&&(w[0]=d.r2l(d.range[0]),w[2]=d.r2l(d.range[1]));var C=i(v,x._diag[y][1]);C&&(w[1]=C.r2l(C.range[0]),w[3]=C.r2l(C.range[1]))}l.selectBatch.length||l.unselectBatch.length?l.matrix.update({ranges:M},{ranges:M}):l.matrix.update({ranges:M})}function m(v){var x=v._fullLayout,l=x._glcanvas.data()[0].regl,b=x._splomGrid;b||(b=x._splomGrid=h(l)),b.update(g(v))}function g(v){var x=v._context.plotGlPixelRatio,l=v._fullLayout,b=l._size,c=[0,0,l.width*x,l.height*x],M={},_;function y(j,Z,X,re,ue,K){X*=x,re*=x,ue*=x,K*=x;var te=Z[j+"color"],G=Z[j+"width"],Y=String(te+G);Y in M?M[Y].data.push(NaN,NaN,X,re,ue,K):M[Y]={data:[X,re,ue,K],join:"rect",thickness:G*x,color:te,viewport:c,range:c,overlay:!1}}for(_ in l._splomSubplots){var w=l._plots[_],d=w.xaxis,C=w.yaxis,S=d._gridVals,E=C._gridVals,k=d._offset,B=d._length,z=C._length,F=b.b+C.domain[0]*b.h,I=-C._m,O=-I*C.r2l(C.range[0],C.calendar),N,V;if(d.showgrid)for(_=0;_<S.length;_++)N=k+d.l2p(S[_].x),y("grid",d,N,F,N,F+z);if(C.showgrid)for(_=0;_<E.length;_++)V=F+O+I*E[_].x,y("grid",C,k,V,k+B,V);n(v,d,C)&&(N=k+d.l2p(0),y("zeroline",d,N,F,N,F+z)),n(v,C,d)&&(V=F+O+0,y("zeroline",C,k,V,k+B,V))}var H=[];for(_ in M)H.push(M[_]);return H}function p(v,x,l,b){var c={},M;if(b._splomScenes){for(M=0;M<v.length;M++){var _=v[M];_.type==="splom"&&(c[_.uid]=1)}for(M=0;M<l.length;M++){var y=l[M];if(!c[y.uid]){var w=b._splomScenes[y.uid];w&&w.destroy&&w.destroy(),b._splomScenes[y.uid]=null,delete b._splomScenes[y.uid]}}}Object.keys(b._splomScenes||{}).length===0&&delete b._splomScenes,b._splomGrid&&!x._hasOnlyLargeSploms&&b._hasOnlyLargeSploms&&(b._splomGrid.destroy(),b._splomGrid=null,delete b._splomGrid),e.clean(v,x,l,b)}P.exports={name:a,attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:f,drag:o,updateGrid:m,clean:p,updateFx:e.updateFx,toSVG:e.toSVG,reglPrecompiled:r}},{"../../lib/prepare_regl":528,"../../plots/cartesian":578,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../../plots/get_data":602,"../../registry":647,"regl-line2d":281}],1044:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axis_ids"),A=t("../scatter/calc").calcMarkerSize,T=t("../scatter/calc").calcAxisExpansion,e=t("../scatter/colorscale_calc"),i=t("../scattergl/convert").markerSelection,n=t("../scattergl/convert").markerStyle,a=t("./scene_update"),r=t("../../constants/numerical").BADNUM,f=t("../scattergl/constants").TOO_MANY_POINTS;P.exports=function(s,m){var g=m.dimensions,p=m._length,v={},x=v.cdata=[],l=v.data=[],b=m._visibleDims=[],c,M,_,y,w;function d(B,z){for(var F=B.makeCalcdata({v:z.values,vcalendar:m.calendar},"v"),I=0;I<F.length;I++)F[I]=F[I]===r?NaN:F[I];x.push(F),l.push(B.type==="log"?h.simpleMap(F,B.c2l):F)}for(c=0;c<g.length;c++)if(_=g[c],_.visible){if(y=u.getFromId(s,m._diag[c][0]),w=u.getFromId(s,m._diag[c][1]),y&&w&&y.type!==w.type){h.log("Skipping splom dimension "+c+" with conflicting axis types");continue}y?(d(y,_),w&&w.type==="category"&&(w._categories=y._categories.slice())):d(w,_),b.push(c)}e(s,m),h.extendFlat(v,n(s,m));var C=x.length,S=C*p>f,E;for(S?E=v.sizeAvg||Math.max(v.size,3):E=A(m,p),M=0;M<b.length;M++)c=b[M],_=g[c],y=u.getFromId(s,m._diag[c][0])||{},w=u.getFromId(s,m._diag[c][1])||{},T(s,m,y,w,x[M],x[M],E);var k=a(s,m);return k.matrix||(k.matrix=!0),k.matrixOptions=v,k.selectedOptions=i(s,m,m.selected),k.unselectedOptions=i(s,m,m.unselected),[{x:!1,y:!1,t:{},trace:m}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992,"./scene_update":1051}],1045:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/array_container_defaults"),A=t("./attributes"),T=t("../scatter/subtypes"),e=t("../scatter/marker_defaults"),i=t("../parcoords/merge_length"),n=t("../scattergl/helpers").isOpenSymbol;P.exports=function(o,s,m,g){function p(y,w){return h.coerce(o,s,A,y,w)}var v=u(o,s,{name:"dimensions",handleItemDefaults:a}),x=p("diagonal.visible"),l=p("showupperhalf"),b=p("showlowerhalf"),c=i(s,v,"values");if(!c||!x&&!l&&!b){s.visible=!1;return}p("text"),p("hovertext"),p("hovertemplate"),p("xhoverformat"),p("yhoverformat"),e(o,s,m,g,p,{noAngleRef:!0,noStandOff:!0});var M=n(s.marker.symbol),_=T.isBubble(s);p("marker.line.width",M||_?1:0),r(o,s,g,p),h.coerceSelectionMarkerOpacity(s,p)};function a(f,o){function s(g,p){return h.coerce(f,o,A.dimensions,g,p)}s("label");var m=s("values");m&&m.length?s("visible"):o.visible=!1,s("axis.type"),s("axis.matches")}function r(f,o,s,m){var g=o.dimensions,p=g.length,v=o.showupperhalf,x=o.showlowerhalf,l=o.diagonal.visible,b,c,M=new Array(p),_=new Array(p);for(b=0;b<p;b++){var y=b?b+1:"";M[b]="x"+y,_[b]="y"+y}var w=m("xaxes",M),d=m("yaxes",_),C=o._diag=new Array(p);o._xaxes={},o._yaxes={};var S=[],E=[];function k(j,Z,X,re){if(!!j){var ue=j.charAt(0),K=s._splomAxes[ue];if(o["_"+ue+"axes"][j]=1,re.push(j),!(j in K)){var te=K[j]={};X&&(te.label=X.label||"",X.visible&&X.axis&&(X.axis.type&&(te.type=X.axis.type),X.axis.matches&&(te.matches=Z)))}}}var B=!l&&!x,z=!l&&!v;for(o._axesDim={},b=0;b<p;b++){var F=g[b],I=b===0,O=b===p-1,N=I&&B||O&&z?void 0:w[b],V=I&&z||O&&B?void 0:d[b];k(N,V,F,S),k(V,N,F,E),C[b]=[N,V],o._axesDim[N]=b,o._axesDim[V]=b}for(b=0;b<S.length;b++)for(c=0;c<E.length;c++){var H=S[b]+E[c];(b>c&&v||b<c&&x||b===c&&(l||!x||!v))&&(s._splomSubplots[H]=1)}(!x||!l&&v&&x)&&(s._splomGridDflt.xside="bottom",s._splomGridDflt.yside="left")}},{"../../lib":515,"../../plots/array_container_defaults":561,"../parcoords/merge_length":907,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scattergl/helpers":996,"./attributes":1041}],1046:[function(t,P,R){var h=t("../../lib"),u=t("../scatter/colorscale_calc"),A=t("../scattergl/convert").markerStyle;P.exports=function(e,i){var n=i.trace,a=e._fullLayout._splomScenes[n.uid];if(a){u(e,n),h.extendFlat(a.matrixOptions,A(e,n));var r=h.extendFlat({},a.matrixOptions,a.viewOpts);a.matrix.update(r,null)}}},{"../../lib":515,"../scatter/colorscale_calc":939,"../scattergl/convert":992}],1047:[function(t,P,R){R.getDimIndex=function(u,A){for(var T=A._id,e=T.charAt(0),i={x:0,y:1}[e],n=u._visibleDims,a=0;a<n.length;a++){var r=n[a];if(u._diag[r][i]===T)return a}return!1}},{}],1048:[function(t,P,R){var h=t("./helpers"),u=t("../scattergl/hover").calcHover;function A(T,e,i){var n=T.cd,a=n[0].trace,r=T.scene,f=r.matrixOptions.cdata,o=T.xa,s=T.ya,m=o.c2p(e),g=s.c2p(i),p=T.distance,v=h.getDimIndex(a,o),x=h.getDimIndex(a,s);if(v===!1||x===!1)return[T];for(var l=f[v],b=f[x],c,M,_=p,y=0;y<l.length;y++){var w=l[y],d=b[y],C=o.c2p(w)-m,S=s.c2p(d)-g,E=Math.sqrt(C*C+S*S);E<_&&(_=M=E,c=y)}return T.index=c,T.distance=_,T.dxy=M,c===void 0?[T]:[u(T,l,b,a)]}P.exports={hoverPoints:A}},{"../scattergl/hover":997,"./helpers":1047}],1049:[function(t,P,R){var h=t("./base_index");h.basePlotModule=t("./base_plot"),P.exports=h},{"./base_index":1042,"./base_plot":1043}],1050:[function(t,P,R){var h=t("regl-splom"),u=t("../../lib"),A=t("../../plots/cartesian/axis_ids"),T=t("../../components/dragelement/helpers").selectMode;P.exports=function(n,a,r){if(!!r.length)for(var f=0;f<r.length;f++)e(n,r[f][0])};function e(i,n){var a=i._fullLayout,r=a._size,f=n.trace,o=n.t,s=a._splomScenes[f.uid],m=s.matrixOptions,g=m.cdata,p=a._glcanvas.data()[0].regl,v=a.dragmode,x,l,b,c,M;if(g.length!==0){m.lower=f.showupperhalf,m.upper=f.showlowerhalf,m.diagonal=f.diagonal.visible;var _=f._visibleDims,y=g.length,w=s.viewOpts={};for(w.ranges=new Array(y),w.domains=new Array(y),M=0;M<_.length;M++){b=_[M];var d=w.ranges[M]=new Array(4),C=w.domains[M]=new Array(4);x=A.getFromId(i,f._diag[b][0]),x&&(d[0]=x._rl[0],d[2]=x._rl[1],C[0]=x.domain[0],C[2]=x.domain[1]),l=A.getFromId(i,f._diag[b][1]),l&&(d[1]=l._rl[0],d[3]=l._rl[1],C[1]=l.domain[0],C[3]=l.domain[1])}var S=i._context.plotGlPixelRatio,E=r.l*S,k=r.b*S,B=r.w*S,z=r.h*S;w.viewport=[E,k,B+E,z+k],s.matrix===!0&&(s.matrix=h(p));var F=a.clickmode.indexOf("select")>-1,I=T(v)||!!f.selectedpoints||F,O=!0;if(I){var N=f._length;if(f.selectedpoints){s.selectBatch=f.selectedpoints;var V=f.selectedpoints,H={};for(b=0;b<V.length;b++)H[V[b]]=!0;var j=[];for(b=0;b<N;b++)H[b]||j.push(b);s.unselectBatch=j}var Z=o.xpx=new Array(y),X=o.ypx=new Array(y);for(M=0;M<_.length;M++){if(b=_[M],x=A.getFromId(i,f._diag[b][0]),x)for(Z[M]=new Array(N),c=0;c<N;c++)Z[M][c]=x.c2p(g[M][c]);if(l=A.getFromId(i,f._diag[b][1]),l)for(X[M]=new Array(N),c=0;c<N;c++)X[M][c]=l.c2p(g[M][c])}if(s.selectBatch.length||s.unselectBatch.length){var re=u.extendFlat({},m,s.unselectedOptions,w),ue=u.extendFlat({},m,s.selectedOptions,w);s.matrix.update(re,ue),O=!1}}else o.xpx=o.ypx=null;if(O){var K=u.extendFlat({},m,w);s.matrix.update(K,null)}}}},{"../../components/dragelement/helpers":385,"../../lib":515,"../../plots/cartesian/axis_ids":570,"regl-splom":283}],1051:[function(t,P,R){var h=t("../../lib");P.exports=function(A,T){var e=A._fullLayout,i=T.uid,n=e._splomScenes;n||(n=e._splomScenes={});var a={dirty:!0,selectBatch:[],unselectBatch:[]},r={matrix:!1,selectBatch:[],unselectBatch:[]},f=n[T.uid];return f||(f=n[i]=h.extendFlat({},a,r),f.draw=function(){f.matrix&&f.matrix.draw&&(f.selectBatch.length||f.unselectBatch.length?f.matrix.draw(f.unselectBatch,f.selectBatch):f.matrix.draw()),f.dirty=!1},f.destroy=function(){f.matrix&&f.matrix.destroy&&f.matrix.destroy(),f.matrixOptions=null,f.selectBatch=null,f.unselectBatch=null,f=null}),f.dirty||h.extendFlat(f,a),f}},{"../../lib":515}],1052:[function(t,P,R){var h=t("../../lib"),u=h.pushUnique,A=t("../scatter/subtypes"),T=t("./helpers");P.exports=function(i,n){var a=i.cd,r=a[0].trace,f=a[0].t,o=i.scene,s=o.matrixOptions.cdata,m=i.xaxis,g=i.yaxis,p=[];if(!o)return p;var v=!A.hasMarkers(r)&&!A.hasText(r);if(r.visible!==!0||v)return p;var x=T.getDimIndex(r,m),l=T.getDimIndex(r,g);if(x===!1||l===!1)return p;var b=f.xpx[x],c=f.ypx[l],M=s[x],_=s[l],y=(i.scene.selectBatch||[]).slice(),w=[];if(n!==!1&&!n.degenerate)for(var d=0;d<M.length;d++)n.contains([b[d],c[d]],null,d,i)?(p.push({pointNumber:d,x:M[d],y:_[d]}),u(y,d)):y.indexOf(d)!==-1?u(y,d):w.push(d);var C=o.matrixOptions;return!y.length&&!w.length?o.matrix.update(C,null):!o.selectBatch.length&&!o.unselectBatch.length&&o.matrix.update(o.unselectedOptions,h.extendFlat({},C,o.selectedOptions,o.viewOpts)),o.selectBatch=y,o.unselectBatch=w,p}},{"../../lib":515,"../scatter/subtypes":961,"./helpers":1047}],1053:[function(t,P,R){var h=t("../../components/colorscale/attributes"),u=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,A=t("../../plots/template_attributes").hovertemplateAttrs,T=t("../mesh3d/attributes"),e=t("../../plots/attributes"),i=t("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:A({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:u("u",1),vhoverformat:u("v",1),whoverformat:u("w",1),xhoverformat:u("x"),yhoverformat:u("y"),zhoverformat:u("z"),showlegend:i({},e.showlegend,{dflt:!1})};i(n,h("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));var a=["opacity","lightposition","lighting"];a.forEach(function(r){n[r]=T[r]}),n.hoverinfo=i({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,P.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],1054:[function(t,P,R){var h=t("../../lib"),u=t("../../components/colorscale/calc");function A(n,a){a._len=Math.min(a.u.length,a.v.length,a.w.length,a.x.length,a.y.length,a.z.length),a._u=i(a.u,a._len),a._v=i(a.v,a._len),a._w=i(a.w,a._len),a._x=i(a.x,a._len),a._y=i(a.y,a._len),a._z=i(a.z,a._len);var r=T(a);a._gridFill=r.fill,a._Xs=r.Xs,a._Ys=r.Ys,a._Zs=r.Zs,a._len=r.len;var f=0,o,s,m;a.starts&&(o=i(a.starts.x||[]),s=i(a.starts.y||[]),m=i(a.starts.z||[]),f=Math.min(o.length,s.length,m.length)),a._startsX=o||[],a._startsY=s||[],a._startsZ=m||[];var g=0,p=1/0,v;for(v=0;v<a._len;v++){var x=a._u[v],l=a._v[v],b=a._w[v],c=Math.sqrt(x*x+l*l+b*b);g=Math.max(g,c),p=Math.min(p,c)}for(u(n,a,{vals:[p,g],containerStr:"",cLetter:"c"}),v=0;v<f;v++){var M=o[v];r.xMax=Math.max(r.xMax,M),r.xMin=Math.min(r.xMin,M);var _=s[v];r.yMax=Math.max(r.yMax,_),r.yMin=Math.min(r.yMin,_);var y=m[v];r.zMax=Math.max(r.zMax,y),r.zMin=Math.min(r.zMin,y)}a._slen=f,a._normMax=g,a._xbnds=[r.xMin,r.xMax],a._ybnds=[r.yMin,r.yMax],a._zbnds=[r.zMin,r.zMax]}function T(n){var a=n._x,r=n._y,f=n._z,o=n._len,s,m,g,p=-1/0,v=1/0,x=-1/0,l=1/0,b=-1/0,c=1/0,M="",_,y,w,d,C,S,E,k,B;for(o&&(d=a[0],S=r[0],k=f[0]),o>1&&(C=a[o-1],E=r[o-1],B=f[o-1]),s=0;s<o;s++)p=Math.max(p,a[s]),v=Math.min(v,a[s]),x=Math.max(x,r[s]),l=Math.min(l,r[s]),b=Math.max(b,f[s]),c=Math.min(c,f[s]),!_&&a[s]!==d&&(_=!0,M+="x"),!y&&r[s]!==S&&(y=!0,M+="y"),!w&&f[s]!==k&&(w=!0,M+="z");_||(M+="x"),y||(M+="y"),w||(M+="z");var z=e(n._x),F=e(n._y),I=e(n._z);M=M.replace("x",(d>C?"-":"+")+"x"),M=M.replace("y",(S>E?"-":"+")+"y"),M=M.replace("z",(k>B?"-":"+")+"z");var O=function(){o=0,z=[],F=[],I=[]};(!o||o<z.length*F.length*I.length)&&O();var N=function(ie){return ie==="x"?a:ie==="y"?r:f},V=function(ie){return ie==="x"?z:ie==="y"?F:I},H=function(ie){return ie[o-1]<ie[0]?-1:1},j=N(M[1]),Z=N(M[3]),X=N(M[5]),re=V(M[1]).length,ue=V(M[3]).length,K=V(M[5]).length,te=!1,G=function(ie,se,xe){return re*(ue*ie+se)+xe},Y=H(N(M[1])),ee=H(N(M[3])),ne=H(N(M[5]));for(s=0;s<K-1;s++){for(m=0;m<ue-1;m++){for(g=0;g<re-1;g++){var J=G(s,m,g),q=G(s,m,g+1),ae=G(s,m+1,g),le=G(s+1,m,g);if((!(j[J]*Y<j[q]*Y)||!(Z[J]*ee<Z[ae]*ee)||!(X[J]*ne<X[le]*ne))&&(te=!0),te)break}if(te)break}if(te)break}return te&&(h.warn("Encountered arbitrary coordinates! Unable to input data grid."),O()),{xMin:v,yMin:l,zMin:c,xMax:p,yMax:x,zMax:b,Xs:z,Ys:F,Zs:I,len:o,fill:M}}function e(n){return h.distinctVals(n).vals}function i(n,a){if(a===void 0&&(a=n.length),h.isTypedArray(n))return n.subarray(0,a);for(var r=[],f=0;f<a;f++)r[f]=+n[f];return r}P.exports={calc:A,filter:i,processGrid:T}},{"../../components/colorscale/calc":375,"../../lib":515}],1055:[function(t,P,R){var h=t("../../../stackgl_modules").gl_streamtube3d,u=h.createTubeMesh,A=t("../../lib"),T=t("../../lib/gl_format_color").parseColorScale,e=t("../../components/colorscale").extractOpts,i=t("../../plots/gl3d/zip3"),n={xaxis:0,yaxis:1,zaxis:2};function a(g,p){this.scene=g,this.uid=p,this.mesh=null,this.data=null}var r=a.prototype;r.handlePick=function(g){var p=this.scene.fullSceneLayout,v=this.scene.dataScale;function x(c,M){var _=p[M],y=v[n[M]];return _.l2c(c)/y}if(g.object===this.mesh){var l=g.data.position,b=g.data.velocity;return g.traceCoordinate=[x(l[0],"xaxis"),x(l[1],"yaxis"),x(l[2],"zaxis"),x(b[0],"xaxis"),x(b[1],"yaxis"),x(b[2],"zaxis"),g.data.intensity*this.data._normMax,g.data.divergence],g.textLabel=this.data.hovertext||this.data.text,!0}};function f(g){var p=g.length,v;return p>2?v=g.slice(1,p-1):p===2?v=[(g[0]+g[1])/2]:v=g,v}function o(g){var p=g.length;return p===1?[.5,.5]:[g[1]-g[0],g[p-1]-g[p-2]]}function s(g,p){var v=g.fullSceneLayout,x=g.dataScale,l=p._len,b={};function c(ue,K){var te=v[K],G=x[n[K]];return A.simpleMap(ue,function(Y){return te.d2l(Y)*G})}if(b.vectors=i(c(p._u,"xaxis"),c(p._v,"yaxis"),c(p._w,"zaxis"),l),!l)return{positions:[],cells:[]};var M=c(p._Xs,"xaxis"),_=c(p._Ys,"yaxis"),y=c(p._Zs,"zaxis");b.meshgrid=[M,_,y],b.gridFill=p._gridFill;var w=p._slen;if(w)b.startingPositions=i(c(p._startsX,"xaxis"),c(p._startsY,"yaxis"),c(p._startsZ,"zaxis"));else{for(var d=_[0],C=f(M),S=f(y),E=new Array(C.length*S.length),k=0,B=0;B<C.length;B++)for(var z=0;z<S.length;z++)E[k++]=[C[B],d,S[z]];b.startingPositions=E}b.colormap=T(p),b.tubeSize=p.sizeref,b.maxLength=p.maxdisplayed;var F=c(p._xbnds,"xaxis"),I=c(p._ybnds,"yaxis"),O=c(p._zbnds,"zaxis"),N=o(M),V=o(_),H=o(y),j=[[F[0]-N[0],I[0]-V[0],O[0]-H[0]],[F[1]+N[1],I[1]+V[1],O[1]+H[1]]],Z=h(b,j),X=e(p);Z.vertexIntensityBounds=[X.min/p._normMax,X.max/p._normMax];var re=p.lightposition;return Z.lightPosition=[re.x,re.y,re.z],Z.ambient=p.lighting.ambient,Z.diffuse=p.lighting.diffuse,Z.specular=p.lighting.specular,Z.roughness=p.lighting.roughness,Z.fresnel=p.lighting.fresnel,Z.opacity=p.opacity,p._pad=Z.tubeScale*p.sizeref*2,Z}r.update=function(g){this.data=g;var p=s(this.scene,g);this.mesh.update(p)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function m(g,p){var v=g.glplot.gl,x=s(g,p),l=u(v,x),b=new a(g,p.uid);return b.mesh=l,b.data=p,l._trace=b,g.glplot.add(l),b}P.exports=m},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],1056:[function(t,P,R){var h=t("../../lib"),u=t("../../components/colorscale/defaults"),A=t("./attributes");P.exports=function(e,i,n,a){function r(v,x){return h.coerce(e,i,A,v,x)}var f=r("u"),o=r("v"),s=r("w"),m=r("x"),g=r("y"),p=r("z");if(!f||!f.length||!o||!o.length||!s||!s.length||!m||!m.length||!g||!g.length||!p||!p.length){i.visible=!1;return}r("starts.x"),r("starts.y"),r("starts.z"),r("maxdisplayed"),r("sizeref"),r("lighting.ambient"),r("lighting.diffuse"),r("lighting.specular"),r("lighting.roughness"),r("lighting.fresnel"),r("lightposition.x"),r("lightposition.y"),r("lightposition.z"),u(e,i,a,r,{prefix:"",cLetter:"c"}),r("text"),r("hovertext"),r("hovertemplate"),r("uhoverformat"),r("vhoverformat"),r("whoverformat"),r("xhoverformat"),r("yhoverformat"),r("zhoverformat"),i._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":1053}],1057:[function(t,P,R){P.exports={moduleType:"trace",name:"streamtube",basePlotModule:t("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:t("./calc").calc,plot:t("./convert"),eventData:function(h,u){return h.tubex=h.x,h.tubey=h.y,h.tubez=h.z,h.tubeu=u.traceCoordinate[3],h.tubev=u.traceCoordinate[4],h.tubew=u.traceCoordinate[5],h.norm=u.traceCoordinate[6],h.divergence=u.traceCoordinate[7],delete h.x,delete h.y,delete h.z,h},meta:{}}},{"../../plots/gl3d":607,"./attributes":1053,"./calc":1054,"./convert":1055,"./defaults":1056}],1058:[function(t,P,R){var h=t("../../plots/attributes"),u=t("../../plots/template_attributes").hovertemplateAttrs,A=t("../../plots/template_attributes").texttemplateAttrs,T=t("../../components/colorscale/attributes"),e=t("../../plots/domain").attributes,i=t("../pie/attributes"),n=t("./constants"),a=t("../../lib/extend").extendFlat;P.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:a({colors:{valType:"data_array",editType:"calc"},line:{color:a({},i.marker.line.color,{dflt:null}),width:a({},i.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},T("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:i.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:A({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:i.hovertext,hoverinfo:a({},h.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:u({},{keys:n.eventDataKeys}),textfont:i.textfont,insidetextorientation:i.insidetextorientation,insidetextfont:i.insidetextfont,outsidetextfont:a({},i.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:i.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"./constants":1061}],1059:[function(t,P,R){var h=t("../../plots/plots");R.name="sunburst",R.plot=function(u,A,T,e){h.plotBasePlot(R.name,u,A,T,e)},R.clean=function(u,A,T,e){h.cleanBasePlot(R.name,u,A,T,e)}},{"../../plots/plots":628}],1060:[function(t,P,R){var h=t("d3-hierarchy"),u=t("fast-isnumeric"),A=t("../../lib"),T=t("../../components/colorscale").makeColorScaleFuncFromTrace,e=t("../pie/calc").makePullColorFn,i=t("../pie/calc").generateExtendedColors,n=t("../../components/colorscale").calc,a=t("../../constants/numerical").ALMOST_EQUAL,r={},f={},o={};R.calc=function(m,g){var p=m._fullLayout,v=g.ids,x=A.isArrayOrTypedArray(v),l=g.labels,b=g.parents,c=g.values,M=A.isArrayOrTypedArray(c),_=[],y={},w={},d=function(Y,ee){y[Y]?y[Y].push(ee):y[Y]=[ee],w[ee]=1},C=function(Y){return Y||typeof Y=="number"},S=function(Y){return!M||u(c[Y])&&c[Y]>=0},E,k,B;x?(E=Math.min(v.length,b.length),k=function(Y){return C(v[Y])&&S(Y)},B=function(Y){return String(v[Y])}):(E=Math.min(l.length,b.length),k=function(Y){return C(l[Y])&&S(Y)},B=function(Y){return String(l[Y])}),M&&(E=Math.min(E,c.length));for(var z=0;z<E;z++)if(k(z)){var F=B(z),I=C(b[z])?String(b[z]):"",O={i:z,id:F,pid:I,label:C(l[z])?String(l[z]):""};M&&(O.v=+c[z]),_.push(O),d(I,F)}if(y[""]){if(y[""].length>1){for(var H=A.randstr(),j=0;j<_.length;j++)_[j].pid===""&&(_[j].pid=H);_.unshift({hasMultipleRoots:!0,id:H,pid:"",label:""})}}else{var N=[],V;for(V in y)w[V]||N.push(V);if(N.length===1)V=N[0],_.unshift({hasImpliedRoot:!0,id:V,pid:"",label:V});else return A.warn(["Multiple implied roots, cannot build",g.type,"hierarchy of",g.name+".","These roots include:",N.join(", ")].join(" "))}var Z;try{Z=h.stratify().id(function(Y){return Y.id}).parentId(function(Y){return Y.pid})(_)}catch(Y){return A.warn(["Failed to build",g.type,"hierarchy of",g.name+".","Error:",Y.message].join(" "))}var X=h.hierarchy(Z),re=!1;if(M)switch(g.branchvalues){case"remainder":X.sum(function(Y){return Y.data.v});break;case"total":X.each(function(Y){var ee=Y.data.data,ne=ee.v;if(Y.children){var J=Y.children.reduce(function(q,ae){return q+ae.data.data.v},0);if((ee.hasImpliedRoot||ee.hasMultipleRoots)&&(ne=J),ne<J*a)return re=!0,A.warn(["Total value for node",Y.data.data.id,"of",g.name,"is smaller than the sum of its children.",`
parent value =`,ne,`
children sum =`,J].join(" "))}Y.value=ne});break}else s(X,g,{branches:g.count.indexOf("branches")!==-1,leaves:g.count.indexOf("leaves")!==-1});if(!re){g.sort&&X.sort(function(Y,ee){return ee.value-Y.value});var ue,K,te=g.marker.colors||[],G=!!te.length;return g._hasColorscale?(G||(te=M?g.values:g._values),n(m,g,{vals:te,containerStr:"marker",cLetter:"c"}),K=T(g.marker)):ue=e(p["_"+g.type+"colormap"]),X.each(function(Y){var ee=Y.data.data;ee.color=g._hasColorscale?K(te[ee.i]):ue(te[ee.i],ee.id)}),_[0].hierarchy=X,_}},R._runCrossTraceCalc=function(m,g){var p=g._fullLayout,v=g.calcdata,x=p[m+"colorway"],l=p["_"+m+"colormap"];p["extend"+m+"colors"]&&(x=i(x,m==="icicle"?o:m==="treemap"?f:r));var b=0,c;function M(d){var C=d.data.data,S=C.id;C.color===!1&&(l[S]?C.color=l[S]:d.parent?d.parent.parent?C.color=d.parent.data.data.color:(l[S]=C.color=x[b%x.length],b++):C.color=c)}for(var _=0;_<v.length;_++){var y=v[_],w=y[0];w.trace.type===m&&w.hierarchy&&(c=w.trace.root.color,w.hierarchy.each(M))}},R.crossTraceCalc=function(m){return R._runCrossTraceCalc("sunburst",m)};function s(m,g,p){var v=0,x=m.children;if(x){for(var l=x.length,b=0;b<l;b++)v+=s(x[b],g,p);p.branches&&v++}else p.leaves&&v++;return m.value=m.data.data.value=v,g._values||(g._values=[]),g._values[m.data.data.i]=v,v}},{"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../pie/calc":912,"d3-hierarchy":115,"fast-isnumeric":190}],1061:[function(t,P,R){P.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1062:[function(t,P,R){var h=t("../../lib"),u=t("./attributes"),A=t("../../plots/domain").defaults,T=t("../bar/defaults").handleText,e=t("../../components/colorscale"),i=e.hasColorscale,n=e.handleDefaults;P.exports=function(r,f,o,s){function m(M,_){return h.coerce(r,f,u,M,_)}var g=m("labels"),p=m("parents");if(!g||!g.length||!p||!p.length){f.visible=!1;return}var v=m("values");v&&v.length?m("branchvalues"):m("count"),m("level"),m("maxdepth");var x=m("marker.line.width");x&&m("marker.line.color",s.paper_bgcolor),m("marker.colors");var l=f._hasColorscale=i(r,"marker","colors")||(r.marker||{}).coloraxis;l&&n(r,f,s,m,{prefix:"marker.",cLetter:"c"}),m("leaf.opacity",l?1:.7);var b=m("text");m("texttemplate"),f.texttemplate||m("textinfo",Array.isArray(b)?"text+label":"label"),m("hovertext"),m("hovertemplate");var c="auto";T(r,f,s,m,c,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),m("insidetextorientation"),m("sort"),m("rotation"),m("root.color"),A(f,s,m),f._length=null}},{"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":1058}],1063:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../registry"),A=t("../../components/fx/helpers").appendArrayPointValue,T=t("../../components/fx"),e=t("../../lib"),i=t("../../lib/events"),n=t("./helpers"),a=t("../pie/helpers"),r=a.formatPieValue;P.exports=function(s,m,g,p,v){var x=p[0],l=x.trace,b=x.hierarchy,c=l.type==="sunburst",M=l.type==="treemap"||l.type==="icicle";"_hasHoverLabel"in l||(l._hasHoverLabel=!1),"_hasHoverEvent"in l||(l._hasHoverEvent=!1);var _=function(d){var C=g._fullLayout;if(!(g._dragging||C.hovermode===!1)){var S=g._fullData[l.index],E=d.data.data,k=E.i,B=n.isHierarchyRoot(d),z=n.getParent(b,d),F=n.getValue(d),I=function(q){return e.castOption(S,k,q)},O=I("hovertemplate"),N=T.castHoverinfo(S,C,k),V=C.separators,H;if(O||N&&N!=="none"&&N!=="skip"){var j,Z;c&&(j=x.cx+d.pxmid[0]*(1-d.rInscribed),Z=x.cy+d.pxmid[1]*(1-d.rInscribed)),M&&(j=d._hoverX,Z=d._hoverY);var X={},re=[],ue=[],K=function(q){return re.indexOf(q)!==-1};N&&(re=N==="all"?S._module.attributes.hoverinfo.flags:N.split("+")),X.label=E.label,K("label")&&X.label&&ue.push(X.label),E.hasOwnProperty("v")&&(X.value=E.v,X.valueLabel=r(X.value,V),K("value")&&ue.push(X.valueLabel)),X.currentPath=d.currentPath=n.getPath(d.data),K("current path")&&!B&&ue.push(X.currentPath);var te,G=[],Y=function(){G.indexOf(te)===-1&&(ue.push(te),G.push(te))};X.percentParent=d.percentParent=F/n.getValue(z),X.parent=d.parentString=n.getPtLabel(z),K("percent parent")&&(te=n.formatPercent(X.percentParent,V)+" of "+X.parent,Y()),X.percentEntry=d.percentEntry=F/n.getValue(m),X.entry=d.entry=n.getPtLabel(m),K("percent entry")&&!B&&!d.onPathbar&&(te=n.formatPercent(X.percentEntry,V)+" of "+X.entry,Y()),X.percentRoot=d.percentRoot=F/n.getValue(b),X.root=d.root=n.getPtLabel(b),K("percent root")&&!B&&(te=n.formatPercent(X.percentRoot,V)+" of "+X.root,Y()),X.text=I("hovertext")||I("text"),K("text")&&(te=X.text,e.isValidTextValue(te)&&ue.push(te)),H=[f(d,S,v.eventDataKeys)];var ee={trace:S,y:Z,_x0:d._x0,_x1:d._x1,_y0:d._y0,_y1:d._y1,text:ue.join("<br>"),name:O||K("name")?S.name:void 0,color:I("hoverlabel.bgcolor")||E.color,borderColor:I("hoverlabel.bordercolor"),fontFamily:I("hoverlabel.font.family"),fontSize:I("hoverlabel.font.size"),fontColor:I("hoverlabel.font.color"),nameLength:I("hoverlabel.namelength"),textAlign:I("hoverlabel.align"),hovertemplate:O,hovertemplateLabels:X,eventData:H};c&&(ee.x0=j-d.rInscribed*d.rpx1,ee.x1=j+d.rInscribed*d.rpx1,ee.idealAlign=d.pxmid[0]<0?"left":"right"),M&&(ee.x=j,ee.idealAlign=j<0?"left":"right");var ne=[];T.loneHover(ee,{container:C._hoverlayer.node(),outerContainer:C._paper.node(),gd:g,inOut_bbox:ne}),H[0].bbox=ne[0],l._hasHoverLabel=!0}if(M){var J=s.select("path.surface");v.styleOne(J,d,S,{hovered:!0})}l._hasHoverEvent=!0,g.emit("plotly_hover",{points:H||[f(d,S,v.eventDataKeys)],event:h.event})}},y=function(d){var C=g._fullLayout,S=g._fullData[l.index],E=h.select(this).datum();if(l._hasHoverEvent&&(d.originalEvent=h.event,g.emit("plotly_unhover",{points:[f(E,S,v.eventDataKeys)],event:h.event}),l._hasHoverEvent=!1),l._hasHoverLabel&&(T.loneUnhover(C._hoverlayer.node()),l._hasHoverLabel=!1),M){var k=s.select("path.surface");v.styleOne(k,E,S,{hovered:!1})}},w=function(d){var C=g._fullLayout,S=g._fullData[l.index],E=c&&(n.isHierarchyRoot(d)||n.isLeaf(d)),k=n.getPtId(d),B=n.isEntry(d)?n.findEntryWithChild(b,k):n.findEntryWithLevel(b,k),z=n.getPtId(B),F={points:[f(d,S,v.eventDataKeys)],event:h.event};E||(F.nextLevel=z);var I=i.triggerHandler(g,"plotly_"+l.type+"click",F);if(I!==!1&&C.hovermode&&(g._hoverdata=[f(d,S,v.eventDataKeys)],T.click(g,h.event)),!E&&I!==!1&&!g._dragging&&!g._transitioning){u.call("_storeDirectGUIEdit",S,C._tracePreGUI[S.uid],{level:S.level});var O={data:[{level:z}],traces:[l.index]},N={frame:{redraw:!1,duration:v.transitionTime},transition:{duration:v.transitionTime,easing:v.transitionEasing},mode:"immediate",fromcurrent:!0};T.loneUnhover(C._hoverlayer.node()),u.call("animate",g,O,N)}};s.on("mouseover",_),s.on("mouseout",y),s.on("click",w)};function f(o,s,m){for(var g=o.data.data,p={curveNumber:s.index,pointNumber:g.i,data:s._input,fullData:s},v=0;v<m.length;v++){var x=m[v];x in o&&(p[x]=o[x])}return"parentString"in o&&!n.isHierarchyRoot(o)&&(p.parent=o.parentString),A(p,s,g.i),p}},{"../../components/fx":407,"../../components/fx/helpers":403,"../../lib":515,"../../lib/events":504,"../../registry":647,"../pie/helpers":915,"./helpers":1064,"@plotly/d3":58}],1064:[function(t,P,R){var h=t("../../lib"),u=t("../../components/color"),A=t("../../lib/setcursor"),T=t("../pie/helpers");R.findEntryWithLevel=function(a,r){var f;return r&&a.eachAfter(function(o){if(R.getPtId(o)===r)return f=o.copy()}),f||a},R.findEntryWithChild=function(a,r){var f;return a.eachAfter(function(o){for(var s=o.children||[],m=0;m<s.length;m++){var g=s[m];if(R.getPtId(g)===r)return f=o.copy()}}),f||a},R.isEntry=function(a){return!a.parent},R.isLeaf=function(a){return!a.children},R.getPtId=function(a){return a.data.data.id},R.getPtLabel=function(a){return a.data.data.label},R.getValue=function(a){return a.value},R.isHierarchyRoot=function(a){return n(a)===""},R.setSliceCursor=function(a,r,f){var o=f.isTransitioning;if(!o){var s=a.datum();o=f.hideOnRoot&&R.isHierarchyRoot(s)||f.hideOnLeaves&&R.isLeaf(s)}A(a,o?null:"pointer")};function e(a,r,f){return{color:R.getOutsideTextFontKey("color",a,r,f),family:R.getOutsideTextFontKey("family",a,r,f),size:R.getOutsideTextFontKey("size",a,r,f)}}function i(a,r,f,o){var s=(o||{}).onPathbar,m=r.data.data,g=m.i,p=h.castOption(a,g,(s?"pathbar.textfont":"insidetextfont")+".color");return!p&&a._input.textfont&&(p=h.castOption(a._input,g,"textfont.color")),{color:p||u.contrast(m.color),family:R.getInsideTextFontKey("family",a,r,f,o),size:R.getInsideTextFontKey("size",a,r,f,o)}}R.getInsideTextFontKey=function(a,r,f,o,s){var m=(s||{}).onPathbar,g=m?"pathbar.textfont":"insidetextfont",p=f.data.data.i;return h.castOption(r,p,g+"."+a)||h.castOption(r,p,"textfont."+a)||o.size},R.getOutsideTextFontKey=function(a,r,f,o){var s=f.data.data.i;return h.castOption(r,s,"outsidetextfont."+a)||h.castOption(r,s,"textfont."+a)||o.size},R.isOutsideText=function(a,r){return!a._hasColorscale&&R.isHierarchyRoot(r)},R.determineTextFont=function(a,r,f,o){return R.isOutsideText(a,r)?e(a,r,f):i(a,r,f,o)},R.hasTransition=function(a){return!!(a&&a.duration>0)},R.getMaxDepth=function(a){return a.maxdepth>=0?a.maxdepth:1/0},R.isHeader=function(a,r){return!(R.isLeaf(a)||a.depth===r._maxDepth-1)};function n(a){return a.data.data.pid}R.getParent=function(a,r){return R.findEntryWithLevel(a,n(r))},R.listPath=function(a,r){var f=a.parent;if(!f)return[];var o=r?[f.data[r]]:[f];return R.listPath(f,r).concat(o)},R.getPath=function(a){return R.listPath(a,"label").join("/")+"/"},R.formatValue=T.formatPieValue,R.formatPercent=function(a,r){var f=h.formatPercent(a,0);return f==="0%"&&(f=T.formatPiePercent(a,r)),f}},{"../../components/color":367,"../../lib":515,"../../lib/setcursor":536,"../pie/helpers":915}],1065:[function(t,P,R){P.exports={moduleType:"trace",name:"sunburst",basePlotModule:t("./base_plot"),categories:[],animatable:!0,attributes:t("./attributes"),layoutAttributes:t("./layout_attributes"),supplyDefaults:t("./defaults"),supplyLayoutDefaults:t("./layout_defaults"),calc:t("./calc").calc,crossTraceCalc:t("./calc").crossTraceCalc,plot:t("./plot").plot,style:t("./style").style,colorbar:t("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1058,"./base_plot":1059,"./calc":1060,"./defaults":1062,"./layout_attributes":1066,"./layout_defaults":1067,"./plot":1068,"./style":1069}],1066:[function(t,P,R){P.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1067:[function(t,P,R){var h=t("../../lib"),u=t("./layout_attributes");P.exports=function(T,e){function i(n,a){return h.coerce(T,e,u,n,a)}i("sunburstcolorway",e.colorway),i("extendsunburstcolors")}},{"../../lib":515,"./layout_attributes":1066}],1068:[function(t,P,R){var h=t("@plotly/d3"),u=t("d3-hierarchy"),A=t("d3-interpolate").interpolate,T=t("../../components/drawing"),e=t("../../lib"),i=t("../../lib/svg_text_utils"),n=t("../bar/uniform_text"),a=n.recordMinTextSize,r=n.clearMinTextSize,f=t("../pie/plot"),o=t("../pie/helpers").getRotationAngle,s=f.computeTransform,m=f.transformInsideText,g=t("./style").styleOne,p=t("../bar/style").resizeText,v=t("./fx"),x=t("./constants"),l=t("./helpers");R.plot=function(w,d,C,S){var E=w._fullLayout,k=E._sunburstlayer,B,z,F=!C,I=!E.uniformtext.mode&&l.hasTransition(C);if(r("sunburst",E),B=k.selectAll("g.trace.sunburst").data(d,function(N){return N[0].trace.uid}),B.enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),B.order(),I){S&&(z=S());var O=h.transition().duration(C.duration).ease(C.easing).each("end",function(){z&&z()}).each("interrupt",function(){z&&z()});O.each(function(){k.selectAll("g.trace").each(function(N){b(w,N,this,C)})})}else B.each(function(N){b(w,N,this,C)}),E.uniformtext.mode&&p(w,E._sunburstlayer.selectAll(".trace"),"sunburst");F&&B.exit().remove()};function b(w,d,C,S){var E=w._context.staticPlot,k=w._fullLayout,B=!k.uniformtext.mode&&l.hasTransition(S),z=h.select(C),F=z.selectAll("g.slice"),I=d[0],O=I.trace,N=I.hierarchy,V=l.findEntryWithLevel(N,O.level),H=l.getMaxDepth(O),j=k._size,Z=O.domain,X=j.w*(Z.x[1]-Z.x[0]),re=j.h*(Z.y[1]-Z.y[0]),ue=.5*Math.min(X,re),K=I.cx=j.l+j.w*(Z.x[1]+Z.x[0])/2,te=I.cy=j.t+j.h*(1-Z.y[0])-re/2;if(!V)return F.remove();var G=null,Y={};B&&F.each(function(Ce){Y[l.getPtId(Ce)]={rpx0:Ce.rpx0,rpx1:Ce.rpx1,x0:Ce.x0,x1:Ce.x1,transform:Ce.transform},!G&&l.isEntry(Ce)&&(G=Ce)});var ee=c(V).descendants(),ne=V.height+1,J=0,q=H;I.hasMultipleRoots&&l.isHierarchyRoot(V)&&(ee=ee.slice(1),ne-=1,J=1,q+=1),ee=ee.filter(function(Ce){return Ce.y1<=q});var ae=o(O.rotation);ae&&ee.forEach(function(Ce){Ce.x0+=ae,Ce.x1+=ae});var le=Math.min(ne,H),ie=function(Ce){return(Ce-J)/le*ue},se=function(Ce,He){return[Ce*Math.cos(He),-Ce*Math.sin(He)]},xe=function(Ce){return e.pathAnnulus(Ce.rpx0,Ce.rpx1,Ce.x0,Ce.x1,K,te)},oe=function(Ce){return K+_(Ce)[0]*(Ce.transform.rCenter||0)+(Ce.transform.x||0)},he=function(Ce){return te+_(Ce)[1]*(Ce.transform.rCenter||0)+(Ce.transform.y||0)};F=F.data(ee,l.getPtId),F.enter().append("g").classed("slice",!0),B?F.exit().transition().each(function(){var Ce=h.select(this),He=Ce.select("path.surface");He.transition().attrTween("d",function(Be){var Re=Se(Be);return function(We){return xe(Re(We))}});var Xe=Ce.select("g.slicetext");Xe.attr("opacity",0)}).remove():F.exit().remove(),F.order();var be=null;if(B&&G){var me=l.getPtId(G);F.each(function(Ce){be===null&&l.getPtId(Ce)===me&&(be=Ce.x1)})}var _e=F;B&&(_e=_e.transition().each("end",function(){var Ce=h.select(this);l.setSliceCursor(Ce,w,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),_e.each(function(Ce){var He=h.select(this),Xe=e.ensureSingle(He,"path","surface",function(Zt){Zt.style("pointer-events",E?"none":"all")});Ce.rpx0=ie(Ce.y0),Ce.rpx1=ie(Ce.y1),Ce.xmid=(Ce.x0+Ce.x1)/2,Ce.pxmid=se(Ce.rpx1,Ce.xmid),Ce.midangle=-(Ce.xmid-Math.PI/2),Ce.startangle=-(Ce.x0-Math.PI/2),Ce.stopangle=-(Ce.x1-Math.PI/2),Ce.halfangle=.5*Math.min(e.angleDelta(Ce.x0,Ce.x1)||Math.PI,Math.PI),Ce.ring=1-Ce.rpx0/Ce.rpx1,Ce.rInscribed=M(Ce),B?Xe.transition().attrTween("d",function(Zt){var zt=De(Zt);return function(At){return xe(zt(At))}}):Xe.attr("d",xe),He.call(v,V,w,d,{eventDataKeys:x.eventDataKeys,transitionTime:x.CLICK_TRANSITION_TIME,transitionEasing:x.CLICK_TRANSITION_EASING}).call(l.setSliceCursor,w,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:w._transitioning}),Xe.call(g,Ce,O);var Be=e.ensureSingle(He,"g","slicetext"),Re=e.ensureSingle(Be,"text","",function(Zt){Zt.attr("data-notex",1)}),We=e.ensureUniformFontSize(w,l.determineTextFont(O,Ce,k.font));Re.text(R.formatSliceLabel(Ce,V,O,d,k)).classed("slicetext",!0).attr("text-anchor","middle").call(T.font,We).call(i.convertToTspans,w);var vt=T.bBox(Re.node());Ce.transform=m(vt,Ce,I),Ce.transform.targetX=oe(Ce),Ce.transform.targetY=he(Ce);var Pt=function(Zt,zt){var At=Zt.transform;return s(At,zt),At.fontSize=We.size,a(O.type,At,k),e.getTextTransform(At)};B?Re.transition().attrTween("transform",function(Zt){var zt=Ie(Zt);return function(At){return Pt(zt(At),vt)}}):Re.attr("transform",Pt(Ce,vt))});function Se(Ce){var He=l.getPtId(Ce),Xe=Y[He],Be=Y[l.getPtId(V)],Re;if(Be){var We=(Ce.x1>Be.x1?2*Math.PI:0)+ae;Re=Ce.rpx1<Be.rpx1?{x0:Ce.x0,x1:Ce.x1,rpx0:0,rpx1:0}:{x0:We,x1:We,rpx0:Ce.rpx0,rpx1:Ce.rpx1}}else{var vt,Pt=l.getPtId(Ce.parent);F.each(function(Bt){if(l.getPtId(Bt)===Pt)return vt=Bt});var Zt=vt.children,zt;Zt.forEach(function(Bt,Ct){if(l.getPtId(Bt)===He)return zt=Ct});var At=Zt.length,Wt=A(vt.x0,vt.x1);Re={rpx0:ue,rpx1:ue,x0:Wt(zt/At),x1:Wt((zt+1)/At)}}return A(Xe,Re)}function De(Ce){var He=Y[l.getPtId(Ce)],Xe,Be={x0:Ce.x0,x1:Ce.x1,rpx0:Ce.rpx0,rpx1:Ce.rpx1};if(He)Xe=He;else if(G)if(Ce.parent)if(be){var Re=(Ce.x1>be?2*Math.PI:0)+ae;Xe={x0:Re,x1:Re}}else Xe={rpx0:ue,rpx1:ue},e.extendFlat(Xe,Te(Ce));else Xe={rpx0:0,rpx1:0};else Xe={x0:ae,x1:ae};return A(Xe,Be)}function Ie(Ce){var He=Y[l.getPtId(Ce)],Xe,Be=Ce.transform;if(He)Xe=He;else if(Xe={rpx1:Ce.rpx1,transform:{textPosAngle:Be.textPosAngle,scale:0,rotate:Be.rotate,rCenter:Be.rCenter,x:Be.x,y:Be.y}},G)if(Ce.parent)if(be){var Re=Ce.x1>be?2*Math.PI:0;Xe.x0=Xe.x1=Re}else e.extendFlat(Xe,Te(Ce));else Xe.x0=Xe.x1=ae;else Xe.x0=Xe.x1=ae;var We=A(Xe.transform.textPosAngle,Ce.transform.textPosAngle),vt=A(Xe.rpx1,Ce.rpx1),Pt=A(Xe.x0,Ce.x0),Zt=A(Xe.x1,Ce.x1),zt=A(Xe.transform.scale,Be.scale),At=A(Xe.transform.rotate,Be.rotate),Wt=Be.rCenter===0?3:Xe.transform.rCenter===0?1/3:1,Bt=A(Xe.transform.rCenter,Be.rCenter),Ct=function(Ze){return Bt(Math.pow(Ze,Wt))};return function(Ze){var nt=vt(Ze),Ye=Pt(Ze),Ee=Zt(Ze),Ge=Ct(Ze),Je=se(nt,(Ye+Ee)/2),qe=We(Ze),Tt={pxmid:Je,rpx1:nt,transform:{textPosAngle:qe,rCenter:Ge,x:Be.x,y:Be.y}};return a(O.type,Be,k),{transform:{targetX:oe(Tt),targetY:he(Tt),scale:zt(Ze),rotate:At(Ze),rCenter:Ge}}}}function Te(Ce){var He=Ce.parent,Xe=Y[l.getPtId(He)],Be={};if(Xe){var Re=He.children,We=Re.indexOf(Ce),vt=Re.length,Pt=A(Xe.x0,Xe.x1);Be.x0=Pt(We/vt),Be.x1=Pt(We/vt)}else Be.x0=Be.x1=0;return Be}}function c(w){return u.partition().size([2*Math.PI,w.height+1])(w)}R.formatSliceLabel=function(w,d,C,S,E){var k=C.texttemplate,B=C.textinfo;if(!k&&(!B||B==="none"))return"";var z=E.separators,F=S[0],I=w.data.data,O=F.hierarchy,N=l.isHierarchyRoot(w),V=l.getParent(O,w),H=l.getValue(w);if(!k){var j=B.split("+"),Z=function(J){return j.indexOf(J)!==-1},X=[],re;if(Z("label")&&I.label&&X.push(I.label),I.hasOwnProperty("v")&&Z("value")&&X.push(l.formatValue(I.v,z)),!N){Z("current path")&&X.push(l.getPath(w.data));var ue=0;Z("percent parent")&&ue++,Z("percent entry")&&ue++,Z("percent root")&&ue++;var K=ue>1;if(ue){var te,G=function(J){re=l.formatPercent(te,z),K&&(re+=" of "+J),X.push(re)};Z("percent parent")&&!N&&(te=H/l.getValue(V),G("parent")),Z("percent entry")&&(te=H/l.getValue(d),G("entry")),Z("percent root")&&(te=H/l.getValue(O),G("root"))}}return Z("text")&&(re=e.castOption(C,I.i,"text"),e.isValidTextValue(re)&&X.push(re)),X.join("<br>")}var Y=e.castOption(C,I.i,"texttemplate");if(!Y)return"";var ee={};I.label&&(ee.label=I.label),I.hasOwnProperty("v")&&(ee.value=I.v,ee.valueLabel=l.formatValue(I.v,z)),ee.currentPath=l.getPath(w.data),N||(ee.percentParent=H/l.getValue(V),ee.percentParentLabel=l.formatPercent(ee.percentParent,z),ee.parent=l.getPtLabel(V)),ee.percentEntry=H/l.getValue(d),ee.percentEntryLabel=l.formatPercent(ee.percentEntry,z),ee.entry=l.getPtLabel(d),ee.percentRoot=H/l.getValue(O),ee.percentRootLabel=l.formatPercent(ee.percentRoot,z),ee.root=l.getPtLabel(O),I.hasOwnProperty("color")&&(ee.color=I.color);var ne=e.castOption(C,I.i,"text");return(e.isValidTextValue(ne)||ne==="")&&(ee.text=ne),ee.customdata=e.castOption(C,I.i,"customdata"),e.texttemplateString(Y,ee,E._d3locale,ee,C._meta||{})};function M(w){return w.rpx0===0&&e.isFullCircle([w.x0,w.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(w.halfangle)),w.ring/2))}function _(w){return y(w.rpx1,w.transform.textPosAngle)}function y(w,d){return[w*Math.sin(d),-w*Math.cos(d)]}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/style":671,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"./constants":1061,"./fx":1063,"./helpers":1064,"./style":1069,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1069:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/color"),A=t("../../lib"),T=t("../bar/uniform_text").resizeText;function e(n){var a=n._fullLayout._sunburstlayer.selectAll(".trace");T(n,a,"sunburst"),a.each(function(r){var f=h.select(this),o=r[0],s=o.trace;f.style("opacity",s.opacity),f.selectAll("path.surface").each(function(m){h.select(this).call(i,m,s)})})}function i(n,a,r){var f=a.data.data,o=!a.children,s=f.i,m=A.castOption(r,s,"marker.line.color")||u.defaultLine,g=A.castOption(r,s,"marker.line.width")||0;n.style("stroke-width",g).call(u.fill,f.color).call(u.stroke,m).style("opacity",o?r.leaf.opacity:null)}P.exports={style:e,styleOne:i}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],1070:[function(t,P,R){var h=t("../../components/color"),u=t("../../components/colorscale/attributes"),A=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,T=t("../../plots/template_attributes").hovertemplateAttrs,e=t("../../plots/attributes"),i=t("../../lib/extend").extendFlat,n=t("../../plot_api/edit_types").overrideAll;function a(o){return{valType:"boolean",dflt:!1}}function r(o){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:a(),y:a(),z:a()},color:{valType:"color",dflt:h.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:h.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var f=P.exports=n(i({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:T(),xhoverformat:A("x"),yhoverformat:A("y"),zhoverformat:A("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},u("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:r(),y:r(),z:r()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:i({},u.zauto,{}),zmin:i({},u.zmin,{}),zmax:i({},u.zmax,{})},hoverinfo:i({},e.hoverinfo),showlegend:i({},e.showlegend,{dflt:!1})}),"calc","nested");f.x.editType=f.y.editType=f.z.editType="calc+clearAxisTypes",f.transforms=void 0},{"../../components/color":367,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642}],1071:[function(t,P,R){var h=t("../../components/colorscale/calc");P.exports=function(A,T){T.surfacecolor?h(A,T,{vals:T.surfacecolor,containerStr:"",cLetter:"c"}):h(A,T,{vals:T.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],1072:[function(t,P,R){var h=t("../../../stackgl_modules").gl_surface3d,u=t("../../../stackgl_modules").ndarray,A=t("../../../stackgl_modules").ndarray_linear_interpolate.d2,T=t("../heatmap/interp2d"),e=t("../heatmap/find_empties"),i=t("../../lib").isArrayOrTypedArray,n=t("../../lib/gl_format_color").parseColorScale,a=t("../../lib/str2rgbarray"),r=t("../../components/colorscale").extractOpts;function f(S,E,k){this.scene=S,this.uid=k,this.surface=E,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var o=f.prototype;o.getXat=function(S,E,k,B){var z=i(this.data.x)?i(this.data.x[0])?this.data.x[E][S]:this.data.x[S]:S;return k===void 0?z:B.d2l(z,0,k)},o.getYat=function(S,E,k,B){var z=i(this.data.y)?i(this.data.y[0])?this.data.y[E][S]:this.data.y[E]:E;return k===void 0?z:B.d2l(z,0,k)},o.getZat=function(S,E,k,B){var z=this.data.z[E][S];return z===null&&this.data.connectgaps&&this.data._interpolatedZ&&(z=this.data._interpolatedZ[E][S]),k===void 0?z:B.d2l(z,0,k)},o.handlePick=function(S){if(S.object===this.surface){var E=(S.data.index[0]-1)/this.dataScaleX-1,k=(S.data.index[1]-1)/this.dataScaleY-1,B=Math.max(Math.min(Math.round(E),this.data.z[0].length-1),0),z=Math.max(Math.min(Math.round(k),this.data._ylength-1),0);S.index=[B,z],S.traceCoordinate=[this.getXat(B,z),this.getYat(B,z),this.getZat(B,z)],S.dataCoordinate=[this.getXat(B,z,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(B,z,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(B,z,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var F=0;F<3;F++){var I=S.dataCoordinate[F];I!=null&&(S.dataCoordinate[F]*=this.scene.dataScale[F])}var O=this.data.hovertext||this.data.text;return Array.isArray(O)&&O[z]&&O[z][B]!==void 0?S.textLabel=O[z][B]:O?S.textLabel=O:S.textLabel="",S.data.dataCoordinate=S.dataCoordinate.slice(),this.surface.highlight(S.data),this.scene.glplot.spikes.position=S.dataCoordinate,!0}};function s(S){var E=S[0].rgb,k=S[S.length-1].rgb;return E[0]===k[0]&&E[1]===k[1]&&E[2]===k[2]&&E[3]===k[3]}var m=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function g(S,E){if(S<E)return 0;for(var k=0;Math.floor(S%E)===0;)S/=E,k++;return k}function p(S){for(var E=[],k=0;k<m.length;k++){var B=m[k];E.push(g(S,B))}return E}function v(S){for(var E=p(S),k=S,B=0;B<m.length;B++)if(E[B]>0){k=m[B];break}return k}function x(S,E){if(!(S<1||E<1)){for(var k=p(S),B=p(E),z=1,F=0;F<m.length;F++)z*=Math.pow(m[F],Math.max(k[F],B[F]));return z}}function l(S){if(S.length!==0){for(var E=1,k=0;k<S.length;k++)E=x(E,S[k]);return E}}o.calcXnums=function(S){var E,k=[];for(E=1;E<S;E++){var B=this.getXat(E-1,0),z=this.getXat(E,0);z!==B&&B!==void 0&&B!==null&&z!==void 0&&z!==null?k[E-1]=Math.abs(z-B):k[E-1]=0}var F=0;for(E=1;E<S;E++)F+=k[E-1];for(E=1;E<S;E++)k[E-1]===0?k[E-1]=1:k[E-1]=Math.round(F/k[E-1]);return k},o.calcYnums=function(S){var E,k=[];for(E=1;E<S;E++){var B=this.getYat(0,E-1),z=this.getYat(0,E);z!==B&&B!==void 0&&B!==null&&z!==void 0&&z!==null?k[E-1]=Math.abs(z-B):k[E-1]=0}var F=0;for(E=1;E<S;E++)F+=k[E-1];for(E=1;E<S;E++)k[E-1]===0?k[E-1]=1:k[E-1]=Math.round(F/k[E-1]);return k};var b=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],c=b[9],M=b[13];o.estimateScale=function(S,E){for(var k=E===0?this.calcXnums(S):this.calcYnums(S),B=1+l(k);B<c;)B*=2;for(;B>M;)B--,B/=v(B),B++,B<c&&(B=M);var z=Math.round(B/S);return z>1?z:1};function _(S,E,k){var B=k[8]+k[2]*E[0]+k[5]*E[1];return S[0]=(k[6]+k[0]*E[0]+k[3]*E[1])/B,S[1]=(k[7]+k[1]*E[0]+k[4]*E[1])/B,S}function y(S,E,k){return w(S,E,_,k),S}function w(S,E,k,B){for(var z=[0,0],F=S.shape[0],I=S.shape[1],O=0;O<F;O++)for(var N=0;N<I;N++)k(z,[O,N],B),S.set(O,N,A(E,z[0],z[1]));return S}o.refineCoords=function(S){for(var E=this.dataScaleX,k=this.dataScaleY,B=S[0].shape[0],z=S[0].shape[1],F=Math.floor(S[0].shape[0]*E+1)|0,I=Math.floor(S[0].shape[1]*k+1)|0,O=1+B+1,N=1+z+1,V=u(new Float32Array(O*N),[O,N]),H=[1/E,0,0,0,1/k,0,0,0,1],j=0;j<S.length;++j){this.surface.padField(V,S[j]);var Z=u(new Float32Array(F*I),[F,I]);y(Z,V,H),S[j]=Z}};function d(S,E){for(var k=!1,B=0;B<S.length;B++)if(E===S[B]){k=!0;break}k===!1&&S.push(E)}o.setContourLevels=function(){var S=[[],[],[]],E=[!1,!1,!1],k=!1,B,z,F;for(B=0;B<3;++B)if(this.showContour[B]&&(k=!0,this.contourSize[B]>0&&this.contourStart[B]!==null&&this.contourEnd[B]!==null&&this.contourEnd[B]>this.contourStart[B]))for(E[B]=!0,z=this.contourStart[B];z<this.contourEnd[B];z+=this.contourSize[B])F=z*this.scene.dataScale[B],d(S[B],F);if(k){var I=[[],[],[]];for(B=0;B<3;++B)this.showContour[B]&&(I[B]=E[B]?S[B]:this.scene.contourLevels[B]);this.surface.update({levels:I})}},o.update=function(S){var E=this.scene,k=E.fullSceneLayout,B=this.surface,z=n(S),F=E.dataScale,I=S.z[0].length,O=S._ylength,N=E.contourLevels;this.data=S;var V,H,j,Z,X=[];for(V=0;V<3;V++)for(X[V]=[],H=0;H<I;H++)X[V][H]=[];for(H=0;H<I;H++)for(j=0;j<O;j++)X[0][H][j]=this.getXat(H,j,S.xcalendar,k.xaxis),X[1][H][j]=this.getYat(H,j,S.ycalendar,k.yaxis),X[2][H][j]=this.getZat(H,j,S.zcalendar,k.zaxis);if(S.connectgaps)for(S._emptypoints=e(X[2]),T(X[2],S._emptypoints),S._interpolatedZ=[],H=0;H<I;H++)for(S._interpolatedZ[H]=[],j=0;j<O;j++)S._interpolatedZ[H][j]=X[2][H][j];for(V=0;V<3;V++)for(H=0;H<I;H++)for(j=0;j<O;j++)Z=X[V][H][j],Z==null?X[V][H][j]=NaN:Z=X[V][H][j]*=F[V];for(V=0;V<3;V++)for(H=0;H<I;H++)for(j=0;j<O;j++)Z=X[V][H][j],Z!=null&&(this.minValues[V]>Z&&(this.minValues[V]=Z),this.maxValues[V]<Z&&(this.maxValues[V]=Z));for(V=0;V<3;V++)this.objectOffset[V]=.5*(this.minValues[V]+this.maxValues[V]);for(V=0;V<3;V++)for(H=0;H<I;H++)for(j=0;j<O;j++)Z=X[V][H][j],Z!=null&&(X[V][H][j]-=this.objectOffset[V]);var re=[u(new Float32Array(I*O),[I,O]),u(new Float32Array(I*O),[I,O]),u(new Float32Array(I*O),[I,O])];for(V=0;V<3;V++)for(H=0;H<I;H++)for(j=0;j<O;j++)re[V].set(H,j,X[V][H][j]);X=[];var ue={colormap:z,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!S.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:S.opacityscale,opacity:S.opacity},K=r(S);if(ue.intensityBounds=[K.min,K.max],S.surfacecolor){var te=u(new Float32Array(I*O),[I,O]);for(H=0;H<I;H++)for(j=0;j<O;j++)te.set(H,j,S.surfacecolor[j][H]);re.push(te)}else ue.intensityBounds[0]*=F[2],ue.intensityBounds[1]*=F[2];(M<re[0].shape[0]||M<re[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(re[0].shape[0],0),this.dataScaleY=this.estimateScale(re[0].shape[1],1),(this.dataScaleX!==1||this.dataScaleY!==1)&&this.refineCoords(re)),S.surfacecolor&&(ue.intensity=re.pop());var G=[!0,!0,!0],Y=["x","y","z"];for(V=0;V<3;++V){var ee=S.contours[Y[V]];G[V]=ee.highlight,ue.showContour[V]=ee.show||ee.highlight,ue.showContour[V]&&(ue.contourProject[V]=[ee.project.x,ee.project.y,ee.project.z],ee.show?(this.showContour[V]=!0,ue.levels[V]=N[V],B.highlightColor[V]=ue.contourColor[V]=a(ee.color),ee.usecolormap?B.highlightTint[V]=ue.contourTint[V]=0:B.highlightTint[V]=ue.contourTint[V]=1,ue.contourWidth[V]=ee.width,this.contourStart[V]=ee.start,this.contourEnd[V]=ee.end,this.contourSize[V]=ee.size):(this.showContour[V]=!1,this.contourStart[V]=null,this.contourEnd[V]=null,this.contourSize[V]=0),ee.highlight&&(ue.dynamicColor[V]=a(ee.highlightcolor),ue.dynamicWidth[V]=ee.highlightwidth))}s(z)&&(ue.vertexColor=!0),ue.objectOffset=this.objectOffset,ue.coords=re,B.update(ue),B.visible=S.visible,B.enableDynamic=G,B.enableHighlight=G,B.snapToData=!0,"lighting"in S&&(B.ambientLight=S.lighting.ambient,B.diffuseLight=S.lighting.diffuse,B.specularLight=S.lighting.specular,B.roughness=S.lighting.roughness,B.fresnel=S.lighting.fresnel),"lightposition"in S&&(B.lightPosition=[S.lightposition.x,S.lightposition.y,S.lightposition.z])},o.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()};function C(S,E){var k=S.glplot.gl,B=h({gl:k}),z=new f(S,B,E.uid);return B._trace=z,z.update(E),S.glplot.add(B),z}P.exports=C},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../heatmap/find_empties":807,"../heatmap/interp2d":810}],1073:[function(t,P,R){var h=t("../../registry"),u=t("../../lib"),A=t("../../components/colorscale/defaults"),T=t("./attributes"),e=.1;function i(o,s){for(var m=[],g=32,p=0;p<g;p++){var v=p/(g-1),x=s+(1-s)*(1-Math.pow(Math.sin(o*v*Math.PI),2));m.push([v,Math.max(0,Math.min(1,x))])}return m}function n(o){var s=0;if(!Array.isArray(o)||o.length<2||!o[0]||!o[o.length-1]||+o[0][0]!=0||+o[o.length-1][0]!=1)return!1;for(var m=0;m<o.length;m++){var g=o[m];if(g.length!==2||+g[0]<s)return!1;s=+g[0]}return!0}function a(o,s,m,g){var p,v;function x(S,E){return u.coerce(o,s,T,S,E)}var l=x("x"),b=x("y"),c=x("z");if(!c||!c.length||(l?l.length<1:!1)||(b?b.length<1:!1)){s.visible=!1;return}s._xlength=Array.isArray(l)&&u.isArrayOrTypedArray(l[0])?c.length:c[0].length,s._ylength=c.length;var M=h.getComponentMethod("calendars","handleTraceDefaults");M(o,s,["x","y","z"],g),x("text"),x("hovertext"),x("hovertemplate"),x("xhoverformat"),x("yhoverformat"),x("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(S){x(S)});var _=x("surfacecolor"),y=["x","y","z"];for(p=0;p<3;++p){var w="contours."+y[p],d=x(w+".show"),C=x(w+".highlight");if(d||C)for(v=0;v<3;++v)x(w+".project."+y[v]);d&&(x(w+".color"),x(w+".width"),x(w+".usecolormap")),C&&(x(w+".highlightcolor"),x(w+".highlightwidth")),x(w+".start"),x(w+".end"),x(w+".size")}_||(f(o,"zmin","cmin"),f(o,"zmax","cmax"),f(o,"zauto","cauto")),A(o,s,g,x,{prefix:"",cLetter:"c"}),r(o,s,g,x),s._length=null}function r(o,s,m,g){var p=g("opacityscale");p==="max"?s.opacityscale=[[0,e],[1,1]]:p==="min"?s.opacityscale=[[0,1],[1,e]]:p==="extremes"?s.opacityscale=i(1,e):n(p)||(s.opacityscale=void 0)}function f(o,s,m){s in o&&!(m in o)&&(o[m]=o[s])}P.exports={supplyDefaults:a,opacityscaleDefaults:r}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":1070}],1074:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:t("./calc"),plot:t("./convert"),moduleType:"trace",name:"surface",basePlotModule:t("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":1070,"./calc":1071,"./convert":1072,"./defaults":1073}],1075:[function(t,P,R){var h=t("../../components/annotations/attributes"),u=t("../../lib/extend").extendFlat,A=t("../../plot_api/edit_types").overrideAll,T=t("../../plots/font_attributes"),e=t("../../plots/domain").attributes,i=t("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,n=P.exports=A({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:i("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:u({},h.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:u({},T({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:i("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:u({},h.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:u({},T({arrayOk:!0}))}},"calc","from-root");n.transforms=void 0},{"../../components/annotations/attributes":350,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594}],1076:[function(t,P,R){var h=t("../../plots/get_data").getModuleCalcData,u=t("./plot"),A="table";R.name=A,R.plot=function(T){var e=h(T.calcdata,A)[0];e.length&&u(T,e)},R.clean=function(T,e,i,n){var a=n._has&&n._has(A),r=e._has&&e._has(A);a&&!r&&n._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":602,"./plot":1083}],1077:[function(t,P,R){var h=t("../../lib/gup").wrap;P.exports=function(){return h({})}},{"../../lib/gup":512}],1078:[function(t,P,R){P.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1079:[function(t,P,R){var h=t("./constants"),u=t("../../lib/extend").extendFlat,A=t("fast-isnumeric");P.exports=function(m,g){var p=i(g.cells.values),v=function(H){return H.slice(g.header.values.length,H.length)},x=i(g.header.values);x.length&&!x[0].length&&(x[0]=[""],x=i(x));var l=x.concat(v(p).map(function(){return n((x[0]||[""]).length)})),b=g.domain,c=Math.floor(m._fullLayout._size.w*(b.x[1]-b.x[0])),M=Math.floor(m._fullLayout._size.h*(b.y[1]-b.y[0])),_=g.header.values.length?l[0].map(function(){return g.header.height}):[h.emptyHeaderHeight],y=p.length?p[0].map(function(){return g.cells.height}):[],w=_.reduce(e,0),d=M-w,C=d+h.uplift,S=f(y,C),E=f(_,w),k=r(E,[]),B=r(S,k),z={},F=g._fullInput.columnorder.concat(v(p.map(function(H,j){return j}))),I=l.map(function(H,j){var Z=Array.isArray(g.columnwidth)?g.columnwidth[Math.min(j,g.columnwidth.length-1)]:g.columnwidth;return A(Z)?Number(Z):1}),O=I.reduce(e,0);I=I.map(function(H){return H/O*c});var N=Math.max(T(g.header.line.width),T(g.cells.line.width)),V={key:g.uid+m._context.staticPlot,translateX:b.x[0]*m._fullLayout._size.w,translateY:m._fullLayout._size.h*(1-b.y[1]),size:m._fullLayout._size,width:c,maxLineWidth:N,height:M,columnOrder:F,groupHeight:M,rowBlocks:B,headerRowBlocks:k,scrollY:0,cells:u({},g.cells,{values:p}),headerCells:u({},g.header,{values:l}),gdColumns:l.map(function(H){return H[0]}),gdColumnsOriginalOrder:l.map(function(H){return H[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:l.map(function(H,j){var Z=z[H];z[H]=(Z||0)+1;var X=H+"__"+z[H];return{key:X,label:H,specIndex:j,xIndex:F[j],xScale:a,x:void 0,calcdata:void 0,columnWidth:I[j]}})};return V.columns.forEach(function(H){H.calcdata=V,H.x=a(H)}),V};function T(s){if(Array.isArray(s)){for(var m=0,g=0;g<s.length;g++)m=Math.max(m,T(s[g]));return m}return s}function e(s,m){return s+m}function i(s){var m=s.slice(),g=1/0,p=0,v;for(v=0;v<m.length;v++)Array.isArray(m[v])||(m[v]=[m[v]]),g=Math.min(g,m[v].length),p=Math.max(p,m[v].length);if(g!==p)for(v=0;v<m.length;v++){var x=p-m[v].length;x&&(m[v]=m[v].concat(n(x)))}return m}function n(s){for(var m=new Array(s),g=0;g<s;g++)m[g]="";return m}function a(s){return s.calcdata.columns.reduce(function(m,g){return g.xIndex<s.xIndex?m+g.columnWidth:m},0)}function r(s,m){var g=Object.keys(s);return g.map(function(p){return u({},s[p],{auxiliaryBlocks:m})})}function f(s,m){for(var g={},p,v=0,x=0,l=o(),b=0,c=0,M=0;M<s.length;M++)p=s[M],l.rows.push({rowIndex:M,rowHeight:p}),x+=p,(x>=m||M===s.length-1)&&(g[v]=l,l.key=c++,l.firstRowIndex=b,l.lastRowIndex=M,l=o(),v+=x,b=M+1,x=0);return g}function o(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}},{"../../lib/extend":505,"./constants":1078,"fast-isnumeric":190}],1080:[function(t,P,R){var h=t("../../lib/extend").extendFlat;R.splitToPanels=function(A){var T=[0,0],e=h({},A,{key:"header",type:"header",page:0,prevPages:T,currentRepaint:[null,null],dragHandle:!0,values:A.calcdata.headerCells.values[A.specIndex],rowBlocks:A.calcdata.headerRowBlocks,calcdata:h({},A.calcdata,{cells:A.calcdata.headerCells})}),i=h({},A,{key:"cells1",type:"cells",page:0,prevPages:T,currentRepaint:[null,null],dragHandle:!1,values:A.calcdata.cells.values[A.specIndex],rowBlocks:A.calcdata.rowBlocks}),n=h({},A,{key:"cells2",type:"cells",page:1,prevPages:T,currentRepaint:[null,null],dragHandle:!1,values:A.calcdata.cells.values[A.specIndex],rowBlocks:A.calcdata.rowBlocks});return[i,n,e]},R.splitToCells=function(A){var T=u(A);return(A.values||[]).slice(T[0],T[1]).map(function(e,i){var n=typeof e=="string"&&e.match(/[<$&> ]/)?"_keybuster_"+Math.random():"";return{keyWithinBlock:i+n,key:T[0]+i,column:A,calcdata:A.calcdata,page:A.page,rowBlocks:A.rowBlocks,value:e}})};function u(A){var T=A.rowBlocks[A.page],e=T?T.rows[0].rowIndex:0,i=T?e+T.rows.length:0;return[e,i]}},{"../../lib/extend":505}],1081:[function(t,P,R){var h=t("../../lib"),u=t("./attributes"),A=t("../../plots/domain").defaults;function T(e,i){for(var n=e.columnorder||[],a=e.header.values.length,r=n.slice(0,a),f=r.slice().sort(function(m,g){return m-g}),o=r.map(function(m){return f.indexOf(m)}),s=o.length;s<a;s++)o.push(s);i("columnorder",o)}P.exports=function(i,n,a,r){function f(o,s){return h.coerce(i,n,u,o,s)}A(n,r,f),f("columnwidth"),f("header.values"),f("header.format"),f("header.align"),f("header.prefix"),f("header.suffix"),f("header.height"),f("header.line.width"),f("header.line.color"),f("header.fill.color"),h.coerceFont(f,"header.font",h.extendFlat({},r.font)),T(n,f),f("cells.values"),f("cells.format"),f("cells.align"),f("cells.prefix"),f("cells.suffix"),f("cells.height"),f("cells.line.width"),f("cells.line.color"),f("cells.fill.color"),h.coerceFont(f,"cells.font",h.extendFlat({},r.font)),n._length=null}},{"../../lib":515,"../../plots/domain":593,"./attributes":1075}],1082:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),calc:t("./calc"),plot:t("./plot"),moduleType:"trace",name:"table",basePlotModule:t("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1075,"./base_plot":1076,"./calc":1077,"./defaults":1081,"./plot":1083}],1083:[function(t,P,R){var h=t("./constants"),u=t("@plotly/d3"),A=t("../../lib"),T=A.numberFormat,e=t("../../lib/gup"),i=t("../../components/drawing"),n=t("../../lib/svg_text_utils"),a=t("../../lib").raiseToTop,r=t("../../lib").strTranslate,f=t("../../lib").cancelTransition,o=t("./data_preparation_helper"),s=t("./data_split_helpers"),m=t("../../components/color");P.exports=function(ae,le){var ie=!ae._context.staticPlot,se=ae._fullLayout._paper.selectAll("."+h.cn.table).data(le.map(function(Be){var Re=e.unwrap(Be),We=Re.trace;return o(ae,We)}),e.keyFun);se.exit().remove(),se.enter().append("g").classed(h.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),se.attr("width",function(Be){return Be.width+Be.size.l+Be.size.r}).attr("height",function(Be){return Be.height+Be.size.t+Be.size.b}).attr("transform",function(Be){return r(Be.translateX,Be.translateY)});var xe=se.selectAll("."+h.cn.tableControlView).data(e.repeat,e.keyFun),oe=xe.enter().append("g").classed(h.cn.tableControlView,!0).style("box-sizing","content-box");if(ie){var he="onwheel"in document?"wheel":"mousewheel";oe.on("mousemove",function(Be){xe.filter(function(Re){return Be===Re}).call(l,ae)}).on(he,function(Be){if(!Be.scrollbarState.wheeling){Be.scrollbarState.wheeling=!0;var Re=Be.scrollY+u.event.deltaY,We=Z(ae,xe,null,Re)(Be);We||(u.event.stopPropagation(),u.event.preventDefault()),Be.scrollbarState.wheeling=!1}}).call(l,ae,!0)}xe.attr("transform",function(Be){return r(Be.size.l,Be.size.t)});var be=xe.selectAll("."+h.cn.scrollBackground).data(e.repeat,e.keyFun);be.enter().append("rect").classed(h.cn.scrollBackground,!0).attr("fill","none"),be.attr("width",function(Be){return Be.width}).attr("height",function(Be){return Be.height}),xe.each(function(Be){i.setClipUrl(u.select(this),p(ae,Be),ae)});var me=xe.selectAll("."+h.cn.yColumn).data(function(Be){return Be.columns},e.keyFun);me.enter().append("g").classed(h.cn.yColumn,!0),me.exit().remove(),me.attr("transform",function(Be){return r(Be.x,0)}),ie&&me.call(u.behavior.drag().origin(function(Be){var Re=u.select(this);return I(Re,Be,-h.uplift),a(this),Be.calcdata.columnDragInProgress=!0,l(xe.filter(function(We){return Be.calcdata.key===We.key}),ae),Be}).on("drag",function(Be){var Re=u.select(this),We=function(Zt){return(Be===Zt?u.event.x:Zt.x)+Zt.columnWidth/2};Be.x=Math.max(-h.overdrag,Math.min(Be.calcdata.width+h.overdrag-Be.columnWidth,u.event.x));var vt=x(me).filter(function(Zt){return Zt.calcdata.key===Be.calcdata.key}),Pt=vt.sort(function(Zt,zt){return We(Zt)-We(zt)});Pt.forEach(function(Zt,zt){Zt.xIndex=zt,Zt.x=Be===Zt?Zt.x:Zt.xScale(Zt)}),me.filter(function(Zt){return Be!==Zt}).transition().ease(h.transitionEase).duration(h.transitionDuration).attr("transform",function(Zt){return r(Zt.x,0)}),Re.call(f).attr("transform",r(Be.x,-h.uplift))}).on("dragend",function(Be){var Re=u.select(this),We=Be.calcdata;Be.x=Be.xScale(Be),Be.calcdata.columnDragInProgress=!1,I(Re,Be,0),z(ae,We,We.columns.map(function(vt){return vt.xIndex}))})),me.each(function(Be){i.setClipUrl(u.select(this),v(ae,Be),ae)});var _e=me.selectAll("."+h.cn.columnBlock).data(s.splitToPanels,e.keyFun);_e.enter().append("g").classed(h.cn.columnBlock,!0).attr("id",function(Be){return Be.key}),_e.style("cursor",function(Be){return Be.dragHandle?"ew-resize":Be.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var Se=_e.filter(N),De=_e.filter(O);ie&&De.call(u.behavior.drag().origin(function(Be){return u.event.stopPropagation(),Be}).on("drag",Z(ae,xe,-1)).on("dragend",function(){})),b(ae,xe,Se,_e),b(ae,xe,De,_e);var Ie=xe.selectAll("."+h.cn.scrollAreaClip).data(e.repeat,e.keyFun);Ie.enter().append("clipPath").classed(h.cn.scrollAreaClip,!0).attr("id",function(Be){return p(ae,Be)});var Te=Ie.selectAll("."+h.cn.scrollAreaClipRect).data(e.repeat,e.keyFun);Te.enter().append("rect").classed(h.cn.scrollAreaClipRect,!0).attr("x",-h.overdrag).attr("y",-h.uplift).attr("fill","none"),Te.attr("width",function(Be){return Be.width+2*h.overdrag}).attr("height",function(Be){return Be.height+h.uplift});var Ce=me.selectAll("."+h.cn.columnBoundary).data(e.repeat,e.keyFun);Ce.enter().append("g").classed(h.cn.columnBoundary,!0);var He=me.selectAll("."+h.cn.columnBoundaryClippath).data(e.repeat,e.keyFun);He.enter().append("clipPath").classed(h.cn.columnBoundaryClippath,!0),He.attr("id",function(Be){return v(ae,Be)});var Xe=He.selectAll("."+h.cn.columnBoundaryRect).data(e.repeat,e.keyFun);Xe.enter().append("rect").classed(h.cn.columnBoundaryRect,!0).attr("fill","none"),Xe.attr("width",function(Be){return Be.columnWidth+2*g(Be)}).attr("height",function(Be){return Be.calcdata.height+2*g(Be)+h.uplift}).attr("x",function(Be){return-g(Be)}).attr("y",function(Be){return-g(Be)}),j(null,De,xe)};function g(q){return Math.ceil(q.calcdata.maxLineWidth/2)}function p(q,ae){return"clip"+q._fullLayout._uid+"_scrollAreaBottomClip_"+ae.key}function v(q,ae){return"clip"+q._fullLayout._uid+"_columnBoundaryClippath_"+ae.calcdata.key+"_"+ae.specIndex}function x(q){return[].concat.apply([],q.map(function(ae){return ae})).map(function(ae){return ae.__data__})}function l(q,ae,le){function ie(me){var _e=me.rowBlocks;return G(_e,_e.length-1)+(_e.length?Y(_e[_e.length-1],1/0):1)}var se=q.selectAll("."+h.cn.scrollbarKit).data(e.repeat,e.keyFun);se.enter().append("g").classed(h.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),se.each(function(me){var _e=me.scrollbarState;_e.totalHeight=ie(me),_e.scrollableAreaHeight=me.groupHeight-V(me),_e.currentlyVisibleHeight=Math.min(_e.totalHeight,_e.scrollableAreaHeight),_e.ratio=_e.currentlyVisibleHeight/_e.totalHeight,_e.barLength=Math.max(_e.ratio*_e.currentlyVisibleHeight,h.goldenRatio*h.scrollbarWidth),_e.barWiggleRoom=_e.currentlyVisibleHeight-_e.barLength,_e.wiggleRoom=Math.max(0,_e.totalHeight-_e.scrollableAreaHeight),_e.topY=_e.barWiggleRoom===0?0:me.scrollY/_e.wiggleRoom*_e.barWiggleRoom,_e.bottomY=_e.topY+_e.barLength,_e.dragMultiplier=_e.wiggleRoom/_e.barWiggleRoom}).attr("transform",function(me){var _e=me.width+h.scrollbarWidth/2+h.scrollbarOffset;return r(_e,V(me))});var xe=se.selectAll("."+h.cn.scrollbar).data(e.repeat,e.keyFun);xe.enter().append("g").classed(h.cn.scrollbar,!0);var oe=xe.selectAll("."+h.cn.scrollbarSlider).data(e.repeat,e.keyFun);oe.enter().append("g").classed(h.cn.scrollbarSlider,!0),oe.attr("transform",function(me){return r(0,me.scrollbarState.topY||0)});var he=oe.selectAll("."+h.cn.scrollbarGlyph).data(e.repeat,e.keyFun);he.enter().append("line").classed(h.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",h.scrollbarWidth).attr("stroke-linecap","round").attr("y1",h.scrollbarWidth/2),he.attr("y2",function(me){return me.scrollbarState.barLength-h.scrollbarWidth/2}).attr("stroke-opacity",function(me){return me.columnDragInProgress||!me.scrollbarState.barWiggleRoom||le?0:.4}),he.transition().delay(0).duration(0),he.transition().delay(h.scrollbarHideDelay).duration(h.scrollbarHideDuration).attr("stroke-opacity",0);var be=xe.selectAll("."+h.cn.scrollbarCaptureZone).data(e.repeat,e.keyFun);be.enter().append("line").classed(h.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",h.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(me){var _e=u.event.y,Se=this.getBoundingClientRect(),De=me.scrollbarState,Ie=_e-Se.top,Te=u.scale.linear().domain([0,De.scrollableAreaHeight]).range([0,De.totalHeight]).clamp(!0);De.topY<=Ie&&Ie<=De.bottomY||Z(ae,q,null,Te(Ie-De.barLength/2))(me)}).call(u.behavior.drag().origin(function(me){return u.event.stopPropagation(),me.scrollbarState.scrollbarScrollInProgress=!0,me}).on("drag",Z(ae,q)).on("dragend",function(){})),be.attr("y2",function(me){return me.scrollbarState.scrollableAreaHeight}),ae._context.staticPlot&&(he.remove(),be.remove())}function b(q,ae,le,ie){var se=c(le),xe=M(se);d(xe);var oe=_(xe);S(oe);var he=w(xe),be=y(he);C(be),E(be,ae,ie,q),te(xe)}function c(q){var ae=q.selectAll("."+h.cn.columnCells).data(e.repeat,e.keyFun);return ae.enter().append("g").classed(h.cn.columnCells,!0),ae.exit().remove(),ae}function M(q){var ae=q.selectAll("."+h.cn.columnCell).data(s.splitToCells,function(le){return le.keyWithinBlock});return ae.enter().append("g").classed(h.cn.columnCell,!0),ae.exit().remove(),ae}function _(q){var ae=q.selectAll("."+h.cn.cellRect).data(e.repeat,function(le){return le.keyWithinBlock});return ae.enter().append("rect").classed(h.cn.cellRect,!0),ae}function y(q){var ae=q.selectAll("."+h.cn.cellText).data(e.repeat,function(le){return le.keyWithinBlock});return ae.enter().append("text").classed(h.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){u.event.stopPropagation()}),ae}function w(q){var ae=q.selectAll("."+h.cn.cellTextHolder).data(e.repeat,function(le){return le.keyWithinBlock});return ae.enter().append("g").classed(h.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),ae}function d(q){q.each(function(ae,le){var ie=ae.calcdata.cells.font,se=ae.column.specIndex,xe={size:F(ie.size,se,le),color:F(ie.color,se,le),family:F(ie.family,se,le)};ae.rowNumber=ae.key,ae.align=F(ae.calcdata.cells.align,se,le),ae.cellBorderWidth=F(ae.calcdata.cells.line.width,se,le),ae.font=xe})}function C(q){q.each(function(ae){i.font(u.select(this),ae.font)})}function S(q){q.attr("width",function(ae){return ae.column.columnWidth}).attr("stroke-width",function(ae){return ae.cellBorderWidth}).each(function(ae){var le=u.select(this);m.stroke(le,F(ae.calcdata.cells.line.color,ae.column.specIndex,ae.rowNumber)),m.fill(le,F(ae.calcdata.cells.fill.color,ae.column.specIndex,ae.rowNumber))})}function E(q,ae,le,ie){q.text(function(se){var xe=se.column.specIndex,oe=se.rowNumber,he=se.value,be=typeof he=="string",me=be&&he.match(/<br>/i),_e=!be||me;se.mayHaveMarkup=be&&he.match(/[<&>]/);var Se=k(he);se.latex=Se;var De=Se?"":F(se.calcdata.cells.prefix,xe,oe)||"",Ie=Se?"":F(se.calcdata.cells.suffix,xe,oe)||"",Te=Se?null:F(se.calcdata.cells.format,xe,oe)||null,Ce=De+(Te?T(Te)(se.value):se.value)+Ie,He;se.wrappingNeeded=!se.wrapped&&!_e&&!Se&&(He=B(Ce)),se.cellHeightMayIncrease=me||Se||se.mayHaveMarkup||(He===void 0?B(Ce):He),se.needsConvertToTspans=se.mayHaveMarkup||se.wrappingNeeded||se.latex;var Xe;if(se.wrappingNeeded){var Be=h.wrapSplitCharacter===" "?Ce.replace(/<a href=/ig,"<a_href="):Ce,Re=Be.split(h.wrapSplitCharacter),We=h.wrapSplitCharacter===" "?Re.map(function(vt){return vt.replace(/<a_href=/ig,"<a href=")}):Re;se.fragments=We.map(function(vt){return{text:vt,width:null}}),se.fragments.push({fragment:h.wrapSpacer,width:null}),Xe=We.join(h.lineBreaker)+h.lineBreaker+h.wrapSpacer}else delete se.fragments,Xe=Ce;return Xe}).attr("dy",function(se){return se.needsConvertToTspans?0:"0.75em"}).each(function(se){var xe=this,oe=u.select(xe),he=se.wrappingNeeded?re:ue;se.needsConvertToTspans?n.convertToTspans(oe,ie,he(le,xe,ae,ie,se)):u.select(xe.parentNode).attr("transform",function(be){return r(K(be),h.cellPad)}).attr("text-anchor",function(be){return{left:"start",center:"middle",right:"end"}[be.align]})})}function k(q){return typeof q=="string"&&q.match(h.latexCheck)}function B(q){return q.indexOf(h.wrapSplitCharacter)!==-1}function z(q,ae,le){var ie=ae.gdColumnsOriginalOrder;ae.gdColumns.sort(function(se,xe){return le[ie.indexOf(se)]-le[ie.indexOf(xe)]}),ae.columnorder=le,q.emit("plotly_restyle")}function F(q,ae,le){if(Array.isArray(q)){var ie=q[Math.min(ae,q.length-1)];return Array.isArray(ie)?ie[Math.min(le,ie.length-1)]:ie}else return q}function I(q,ae,le){q.transition().ease(h.releaseTransitionEase).duration(h.releaseTransitionDuration).attr("transform",r(ae.x,le))}function O(q){return q.type==="cells"}function N(q){return q.type==="header"}function V(q){var ae=q.rowBlocks.length?q.rowBlocks[0].auxiliaryBlocks:[];return ae.reduce(function(le,ie){return le+Y(ie,1/0)},0)}function H(q,ae,le){for(var ie=[],se=0,xe=0;xe<q.length;xe++){for(var oe=q[xe],he=oe.rows,be=0,me=0;me<he.length;me++)be+=he[me].rowHeight;oe.allRowsHeight=be;var _e=se+be,Se=ae,De=Se+le;Se<_e&&De>se&&ie.push(xe),se+=be}return ie}function j(q,ae,le){var ie=x(ae)[0];if(ie!==void 0){var se=ie.rowBlocks,xe=ie.calcdata,oe=G(se,se.length),he=ie.calcdata.groupHeight-V(ie),be=xe.scrollY=Math.max(0,Math.min(oe-he,xe.scrollY)),me=H(se,be,he);me.length===1&&(me[0]===se.length-1?me.unshift(me[0]-1):me.push(me[0]+1)),me[0]%2&&me.reverse(),ae.each(function(_e,Se){_e.page=me[Se],_e.scrollY=be}),ae.attr("transform",function(_e){var Se=G(_e.rowBlocks,_e.page)-_e.scrollY;return r(0,Se)}),q&&(X(q,le,ae,me,ie.prevPages,ie,0),X(q,le,ae,me,ie.prevPages,ie,1),l(le,q))}}function Z(q,ae,le,ie){return function(xe){var oe=xe.calcdata?xe.calcdata:xe,he=ae.filter(function(Se){return oe.key===Se.key}),be=le||oe.scrollbarState.dragMultiplier,me=oe.scrollY;oe.scrollY=ie===void 0?oe.scrollY+be*u.event.dy:ie;var _e=he.selectAll("."+h.cn.yColumn).selectAll("."+h.cn.columnBlock).filter(O);return j(q,_e,he),oe.scrollY===me}}function X(q,ae,le,ie,se,xe,oe){var he=ie[oe]!==se[oe];he&&(clearTimeout(xe.currentRepaint[oe]),xe.currentRepaint[oe]=setTimeout(function(){var be=le.filter(function(me,_e){return _e===oe&&ie[_e]!==se[_e]});b(q,ae,be,le),se[oe]=ie[oe]}))}function re(q,ae,le,ie){return function(){var xe=u.select(ae.parentNode);xe.each(function(oe){var he=oe.fragments;xe.selectAll("tspan.line").each(function(Ce,He){he[He].width=this.getComputedTextLength()});var be=he[he.length-1].width,me=he.slice(0,-1),_e=[],Se,De,Ie=0,Te=oe.column.columnWidth-2*h.cellPad;for(oe.value="";me.length;)Se=me.shift(),De=Se.width+be,Ie+De>Te&&(oe.value+=_e.join(h.wrapSpacer)+h.lineBreaker,_e=[],Ie=0),_e.push(Se.text),Ie+=De;Ie&&(oe.value+=_e.join(h.wrapSpacer)),oe.wrapped=!0}),xe.selectAll("tspan.line").remove(),E(xe.select("."+h.cn.cellText),le,q,ie),u.select(ae.parentNode.parentNode).call(te)}}function ue(q,ae,le,ie,se){return function(){if(!se.settledY){var oe=u.select(ae.parentNode),he=ne(se),be=se.key-he.firstRowIndex,me=he.rows[be].rowHeight,_e=se.cellHeightMayIncrease?ae.parentNode.getBoundingClientRect().height+2*h.cellPad:me,Se=Math.max(_e,me),De=Se-he.rows[be].rowHeight;De&&(he.rows[be].rowHeight=Se,q.selectAll("."+h.cn.columnCell).call(te),j(null,q.filter(O),0),l(le,ie,!0)),oe.attr("transform",function(){var Ie=this,Te=Ie.parentNode,Ce=Te.getBoundingClientRect(),He=u.select(Ie.parentNode).select("."+h.cn.cellRect).node().getBoundingClientRect(),Xe=Ie.transform.baseVal.consolidate(),Be=He.top-Ce.top+(Xe?Xe.matrix.f:h.cellPad);return r(K(se,u.select(Ie.parentNode).select("."+h.cn.cellTextHolder).node().getBoundingClientRect().width),Be)}),se.settledY=!0}}}function K(q,ae){switch(q.align){case"left":return h.cellPad;case"right":return q.column.columnWidth-(ae||0)-h.cellPad;case"center":return(q.column.columnWidth-(ae||0))/2;default:return h.cellPad}}function te(q){q.attr("transform",function(ae){var le=ae.rowBlocks[0].auxiliaryBlocks.reduce(function(oe,he){return oe+Y(he,1/0)},0),ie=ne(ae),se=Y(ie,ae.key),xe=se+le;return r(0,xe)}).selectAll("."+h.cn.cellRect).attr("height",function(ae){return J(ne(ae),ae.key).rowHeight})}function G(q,ae){for(var le=0,ie=ae-1;ie>=0;ie--)le+=ee(q[ie]);return le}function Y(q,ae){for(var le=0,ie=0;ie<q.rows.length&&q.rows[ie].rowIndex<ae;ie++)le+=q.rows[ie].rowHeight;return le}function ee(q){var ae=q.allRowsHeight;if(ae!==void 0)return ae;for(var le=0,ie=0;ie<q.rows.length;ie++)le+=q.rows[ie].rowHeight;return q.allRowsHeight=le,le}function ne(q){return q.rowBlocks[q.page]}function J(q,ae){return q.rows[ae-q.firstRowIndex]}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"./constants":1078,"./data_preparation_helper":1079,"./data_split_helpers":1080,"@plotly/d3":58}],1084:[function(t,P,R){var h=t("../../plots/template_attributes").hovertemplateAttrs,u=t("../../plots/template_attributes").texttemplateAttrs,A=t("../../components/colorscale/attributes"),T=t("../../plots/domain").attributes,e=t("../pie/attributes"),i=t("../sunburst/attributes"),n=t("./constants"),a=t("../../lib/extend").extendFlat;P.exports={labels:i.labels,parents:i.parents,values:i.values,branchvalues:i.branchvalues,count:i.count,level:i.level,maxdepth:i.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:a({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:i.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:i.marker.line,editType:"calc"},A("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:a({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:i.textinfo,texttemplate:u({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:i.hoverinfo,hovertemplate:h({},{keys:n.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:a({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:i.root,domain:T({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"./constants":1087}],1085:[function(t,P,R){var h=t("../../plots/plots");R.name="treemap",R.plot=function(u,A,T,e){h.plotBasePlot(R.name,u,A,T,e)},R.clean=function(u,A,T,e){h.cleanBasePlot(R.name,u,A,T,e)}},{"../../plots/plots":628}],1086:[function(t,P,R){var h=t("../sunburst/calc");R.calc=function(u,A){return h.calc(u,A)},R.crossTraceCalc=function(u){return h._runCrossTraceCalc("treemap",u)}},{"../sunburst/calc":1060}],1087:[function(t,P,R){P.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1088:[function(t,P,R){var h=t("../../lib"),u=t("./attributes"),A=t("../../components/color"),T=t("../../plots/domain").defaults,e=t("../bar/defaults").handleText,i=t("../bar/constants").TEXTPAD,n=t("../../components/colorscale"),a=n.hasColorscale,r=n.handleDefaults;P.exports=function(o,s,m,g){function p(E,k){return h.coerce(o,s,u,E,k)}var v=p("labels"),x=p("parents");if(!v||!v.length||!x||!x.length){s.visible=!1;return}var l=p("values");l&&l.length?p("branchvalues"):p("count"),p("level"),p("maxdepth");var b=p("tiling.packing");b==="squarify"&&p("tiling.squarifyratio"),p("tiling.flip"),p("tiling.pad");var c=p("text");p("texttemplate"),s.texttemplate||p("textinfo",Array.isArray(c)?"text+label":"label"),p("hovertext"),p("hovertemplate");var M=p("pathbar.visible"),_="auto";e(o,s,g,p,_,{hasPathbar:M,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),p("textposition");var y=s.textposition.indexOf("bottom")!==-1,w=p("marker.line.width");w&&p("marker.line.color",g.paper_bgcolor);var d=p("marker.colors"),C=s._hasColorscale=a(o,"marker","colors")||(o.marker||{}).coloraxis;C?r(o,s,g,p,{prefix:"marker.",cLetter:"c"}):p("marker.depthfade",!(d||[]).length);var S=s.textfont.size*2;p("marker.pad.t",y?S/4:S),p("marker.pad.l",S/4),p("marker.pad.r",S/4),p("marker.pad.b",y?S:S/4),s._hovered={marker:{line:{width:2,color:A.contrast(g.paper_bgcolor)}}},M&&(p("pathbar.thickness",s.pathbar.textfont.size+2*i),p("pathbar.side"),p("pathbar.edgeshape")),p("sort"),p("root.color"),T(s,g,p),s._length=null}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":1084}],1089:[function(t,P,R){var h=t("@plotly/d3"),u=t("../sunburst/helpers"),A=t("../bar/uniform_text"),T=A.clearMinTextSize,e=t("../bar/style").resizeText,i=t("./plot_one");P.exports=function(a,r,f,o,s){var m=s.type,g=s.drawDescendants,p=a._fullLayout,v=p["_"+m+"layer"],x,l,b=!f;if(T(m,p),x=v.selectAll("g.trace."+m).data(r,function(M){return M[0].trace.uid}),x.enter().append("g").classed("trace",!0).classed(m,!0),x.order(),!p.uniformtext.mode&&u.hasTransition(f)){o&&(l=o());var c=h.transition().duration(f.duration).ease(f.easing).each("end",function(){l&&l()}).each("interrupt",function(){l&&l()});c.each(function(){v.selectAll("g.trace").each(function(M){i(a,M,this,f,g)})})}else x.each(function(M){i(a,M,this,f,g)}),p.uniformtext.mode&&e(a,v.selectAll(".trace"),m);b&&x.exit().remove()}},{"../bar/style":671,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./plot_one":1098,"@plotly/d3":58}],1090:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=t("../../components/drawing"),T=t("../../lib/svg_text_utils"),e=t("./partition"),i=t("./style").styleOne,n=t("./constants"),a=t("../sunburst/helpers"),r=t("../sunburst/fx"),f=!0;P.exports=function(s,m,g,p,v){var x=v.barDifY,l=v.width,b=v.height,c=v.viewX,M=v.viewY,_=v.pathSlice,y=v.toMoveInsideSlice,w=v.strTransform,d=v.hasTransition,C=v.handleSlicesExit,S=v.makeUpdateSliceInterpolator,E=v.makeUpdateTextInterpolator,k={},B=s._context.staticPlot,z=s._fullLayout,F=m[0],I=F.trace,O=F.hierarchy,N=l/I._entryDepth,V=a.listPath(g.data,"id"),H=e(O.copy(),[l,b],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();H=H.filter(function(Z){var X=V.indexOf(Z.data.id);return X===-1?!1:(Z.x0=N*X,Z.x1=N*(X+1),Z.y0=x,Z.y1=x+b,Z.onPathbar=!0,!0)}),H.reverse(),p=p.data(H,a.getPtId),p.enter().append("g").classed("pathbar",!0),C(p,f,k,[l,b],_),p.order();var j=p;d&&(j=j.transition().each("end",function(){var Z=h.select(this);a.setSliceCursor(Z,s,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),j.each(function(Z){Z._x0=c(Z.x0),Z._x1=c(Z.x1),Z._y0=M(Z.y0),Z._y1=M(Z.y1),Z._hoverX=c(Z.x1-Math.min(l,b)/2),Z._hoverY=M(Z.y1-b/2);var X=h.select(this),re=u.ensureSingle(X,"path","surface",function(G){G.style("pointer-events",B?"none":"all")});d?re.transition().attrTween("d",function(G){var Y=S(G,f,k,[l,b]);return function(ee){return _(Y(ee))}}):re.attr("d",_),X.call(r,g,s,m,{styleOne:i,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,s,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:s._transitioning}),re.call(i,Z,I,{hovered:!1}),Z._text=(a.getPtLabel(Z)||"").split("<br>").join(" ")||"";var ue=u.ensureSingle(X,"g","slicetext"),K=u.ensureSingle(ue,"text","",function(G){G.attr("data-notex",1)}),te=u.ensureUniformFontSize(s,a.determineTextFont(I,Z,z.font,{onPathbar:!0}));K.text(Z._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(A.font,te).call(T.convertToTspans,s),Z.textBB=A.bBox(K.node()),Z.transform=y(Z,{fontSize:te.size,onPathbar:!0}),Z.transform.fontSize=te.size,d?K.transition().attrTween("transform",function(G){var Y=E(G,f,k,[l,b]);return function(ee){return w(Y(ee))}}):K.attr("transform",w(Z))})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1091:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=t("../../components/drawing"),T=t("../../lib/svg_text_utils"),e=t("./partition"),i=t("./style").styleOne,n=t("./constants"),a=t("../sunburst/helpers"),r=t("../sunburst/fx"),f=t("../sunburst/plot").formatSliceLabel,o=!1;P.exports=function(m,g,p,v,x){var l=x.width,b=x.height,c=x.viewX,M=x.viewY,_=x.pathSlice,y=x.toMoveInsideSlice,w=x.strTransform,d=x.hasTransition,C=x.handleSlicesExit,S=x.makeUpdateSliceInterpolator,E=x.makeUpdateTextInterpolator,k=x.prevEntry,B={},z=m._context.staticPlot,F=m._fullLayout,I=g[0],O=I.trace,N=O.textposition.indexOf("left")!==-1,V=O.textposition.indexOf("right")!==-1,H=O.textposition.indexOf("bottom")!==-1,j=!H&&!O.marker.pad.t||H&&!O.marker.pad.b,Z=e(p,[l,b],{packing:O.tiling.packing,squarifyratio:O.tiling.squarifyratio,flipX:O.tiling.flip.indexOf("x")>-1,flipY:O.tiling.flip.indexOf("y")>-1,pad:{inner:O.tiling.pad,top:O.marker.pad.t,left:O.marker.pad.l,right:O.marker.pad.r,bottom:O.marker.pad.b}}),X=Z.descendants(),re=1/0,ue=-1/0;X.forEach(function(ee){var ne=ee.depth;ne>=O._maxDepth?(ee.x0=ee.x1=(ee.x0+ee.x1)/2,ee.y0=ee.y1=(ee.y0+ee.y1)/2):(re=Math.min(re,ne),ue=Math.max(ue,ne))}),v=v.data(X,a.getPtId),O._maxVisibleLayers=isFinite(ue)?ue-re+1:0,v.enter().append("g").classed("slice",!0),C(v,o,B,[l,b],_),v.order();var K=null;if(d&&k){var te=a.getPtId(k);v.each(function(ee){K===null&&a.getPtId(ee)===te&&(K={x0:ee.x0,x1:ee.x1,y0:ee.y0,y1:ee.y1})})}var G=function(){return K||{x0:0,x1:l,y0:0,y1:b}},Y=v;return d&&(Y=Y.transition().each("end",function(){var ee=h.select(this);a.setSliceCursor(ee,m,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),Y.each(function(ee){var ne=a.isHeader(ee,O);ee._x0=c(ee.x0),ee._x1=c(ee.x1),ee._y0=M(ee.y0),ee._y1=M(ee.y1),ee._hoverX=c(ee.x1-O.marker.pad.r),ee._hoverY=M(H?ee.y1-O.marker.pad.b/2:ee.y0+O.marker.pad.t/2);var J=h.select(this),q=u.ensureSingle(J,"path","surface",function(se){se.style("pointer-events",z?"none":"all")});d?q.transition().attrTween("d",function(se){var xe=S(se,o,G(),[l,b]);return function(oe){return _(xe(oe))}}):q.attr("d",_),J.call(r,p,m,g,{styleOne:i,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,m,{isTransitioning:m._transitioning}),q.call(i,ee,O,{hovered:!1}),ee.x0===ee.x1||ee.y0===ee.y1?ee._text="":ne?ee._text=j?"":a.getPtLabel(ee)||"":ee._text=f(ee,p,O,g,F)||"";var ae=u.ensureSingle(J,"g","slicetext"),le=u.ensureSingle(ae,"text","",function(se){se.attr("data-notex",1)}),ie=u.ensureUniformFontSize(m,a.determineTextFont(O,ee,F.font));le.text(ee._text||" ").classed("slicetext",!0).attr("text-anchor",V?"end":N||ne?"start":"middle").call(A.font,ie).call(T.convertToTspans,m),ee.textBB=A.bBox(le.node()),ee.transform=y(ee,{fontSize:ie.size,isHeader:ne}),ee.transform.fontSize=ie.size,d?le.transition().attrTween("transform",function(se){var xe=E(se,o,G(),[l,b]);return function(oe){return w(xe(oe))}}):le.attr("transform",w(ee))}),K}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1092:[function(t,P,R){P.exports=function h(u,A,T){var e;T.swapXY&&(e=u.x0,u.x0=u.y0,u.y0=e,e=u.x1,u.x1=u.y1,u.y1=e),T.flipX&&(e=u.x0,u.x0=A[0]-u.x1,u.x1=A[0]-e),T.flipY&&(e=u.y0,u.y0=A[1]-u.y1,u.y1=A[1]-e);var i=u.children;if(i)for(var n=0;n<i.length;n++)h(i[n],A,T)}},{}],1093:[function(t,P,R){P.exports={moduleType:"trace",name:"treemap",basePlotModule:t("./base_plot"),categories:[],animatable:!0,attributes:t("./attributes"),layoutAttributes:t("./layout_attributes"),supplyDefaults:t("./defaults"),supplyLayoutDefaults:t("./layout_defaults"),calc:t("./calc").calc,crossTraceCalc:t("./calc").crossTraceCalc,plot:t("./plot"),style:t("./style").style,colorbar:t("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1084,"./base_plot":1085,"./calc":1086,"./defaults":1088,"./layout_attributes":1094,"./layout_defaults":1095,"./plot":1097,"./style":1099}],1094:[function(t,P,R){P.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1095:[function(t,P,R){var h=t("../../lib"),u=t("./layout_attributes");P.exports=function(T,e){function i(n,a){return h.coerce(T,e,u,n,a)}i("treemapcolorway",e.colorway),i("extendtreemapcolors")}},{"../../lib":515,"./layout_attributes":1094}],1096:[function(t,P,R){var h=t("d3-hierarchy"),u=t("./flip_tree");P.exports=function(e,i,n){var a=n.flipX,r=n.flipY,f=n.packing==="dice-slice",o=n.pad[r?"bottom":"top"],s=n.pad[a?"right":"left"],m=n.pad[a?"left":"right"],g=n.pad[r?"top":"bottom"],p;f&&(p=s,s=o,o=p,p=m,m=g,g=p);var v=h.treemap().tile(A(n.packing,n.squarifyratio)).paddingInner(n.pad.inner).paddingLeft(s).paddingRight(m).paddingTop(o).paddingBottom(g).size(f?[i[1],i[0]]:i)(e);return(f||a||r)&&u(v,i,{swapXY:f,flipX:a,flipY:r}),v};function A(T,e){switch(T){case"squarify":return h.treemapSquarify.ratio(e);case"binary":return h.treemapBinary;case"dice":return h.treemapDice;case"slice":return h.treemapSlice;default:return h.treemapSliceDice}}},{"./flip_tree":1092,"d3-hierarchy":115}],1097:[function(t,P,R){var h=t("./draw"),u=t("./draw_descendants");P.exports=function(T,e,i,n){return h(T,e,i,n,{type:"treemap",drawDescendants:u})}},{"./draw":1089,"./draw_descendants":1091}],1098:[function(t,P,R){var h=t("@plotly/d3"),u=t("d3-interpolate").interpolate,A=t("../sunburst/helpers"),T=t("../../lib"),e=t("../bar/constants").TEXTPAD,i=t("../bar/plot"),n=i.toMoveInsideBar,a=t("../bar/uniform_text"),r=a.recordMinTextSize,f=t("./constants"),o=t("./draw_ancestors");function s(m){return A.isHierarchyRoot(m)?"":A.getPtId(m)}P.exports=function(g,p,v,x,l){var b=g._fullLayout,c=p[0],M=c.trace,_=M.type,y=_==="icicle",w=c.hierarchy,d=A.findEntryWithLevel(w,M.level),C=h.select(v),S=C.selectAll("g.pathbar"),E=C.selectAll("g.slice");if(!d){S.remove(),E.remove();return}var k=A.isHierarchyRoot(d),B=!b.uniformtext.mode&&A.hasTransition(x),z=A.getMaxDepth(M),F=function(We){return We.data.depth-d.data.depth<z},I=b._size,O=M.domain,N=I.w*(O.x[1]-O.x[0]),V=I.h*(O.y[1]-O.y[0]),H=N,j=M.pathbar.thickness,Z=M.marker.line.width+f.gapWithPathbar,X=M.pathbar.visible?M.pathbar.side.indexOf("bottom")>-1?V+Z:-(j+Z):0,re={x0:H,x1:H,y0:X,y1:X+j},ue=function(We,vt,Pt){var Zt=M.tiling.pad,zt=function(Ct){return Ct-Zt<=vt.x0},At=function(Ct){return Ct+Zt>=vt.x1},Wt=function(Ct){return Ct-Zt<=vt.y0},Bt=function(Ct){return Ct+Zt>=vt.y1};return We.x0===vt.x0&&We.x1===vt.x1&&We.y0===vt.y0&&We.y1===vt.y1?{x0:We.x0,x1:We.x1,y0:We.y0,y1:We.y1}:{x0:zt(We.x0-Zt)?0:At(We.x0-Zt)?Pt[0]:We.x0,x1:zt(We.x1+Zt)?0:At(We.x1+Zt)?Pt[0]:We.x1,y0:Wt(We.y0-Zt)?0:Bt(We.y0-Zt)?Pt[1]:We.y0,y1:Wt(We.y1+Zt)?0:Bt(We.y1+Zt)?Pt[1]:We.y1}},K=null,te={},G={},Y=null,ee=function(We,vt){return vt?te[s(We)]:G[s(We)]},ne=function(We,vt,Pt,Zt){if(vt)return te[s(w)]||re;var zt=G[M.level]||Pt;return F(We)?ue(We,zt,Zt):{}};c.hasMultipleRoots&&k&&z++,M._maxDepth=z,M._backgroundColor=b.paper_bgcolor,M._entryDepth=d.data.depth,M._atRootLevel=k;var J=-N/2+I.l+I.w*(O.x[1]+O.x[0])/2,q=-V/2+I.t+I.h*(1-(O.y[1]+O.y[0])/2),ae=function(We){return J+We},le=function(We){return q+We},ie=le(0),se=ae(0),xe=function(We){return se+We},oe=function(We){return ie+We};function he(We,vt){return We+","+vt}var be=xe(0),me=function(We){We.x=Math.max(be,We.x)},_e=M.pathbar.edgeshape,Se=function(We){var vt=xe(Math.max(Math.min(We.x0,We.x0),0)),Pt=xe(Math.min(Math.max(We.x1,We.x1),H)),Zt=oe(We.y0),zt=oe(We.y1),At=j/2,Wt={},Bt={};Wt.x=vt,Bt.x=Pt,Wt.y=Bt.y=(Zt+zt)/2;var Ct={x:vt,y:Zt},Ze={x:Pt,y:Zt},nt={x:Pt,y:zt},Ye={x:vt,y:zt};return _e===">"?(Ct.x-=At,Ze.x-=At,nt.x-=At,Ye.x-=At):_e==="/"?(nt.x-=At,Ye.x-=At,Wt.x-=At/2,Bt.x-=At/2):_e==="\\"?(Ct.x-=At,Ze.x-=At,Wt.x-=At/2,Bt.x-=At/2):_e==="<"&&(Wt.x-=At,Bt.x-=At),me(Ct),me(Ye),me(Wt),me(Ze),me(nt),me(Bt),"M"+he(Ct.x,Ct.y)+"L"+he(Ze.x,Ze.y)+"L"+he(Bt.x,Bt.y)+"L"+he(nt.x,nt.y)+"L"+he(Ye.x,Ye.y)+"L"+he(Wt.x,Wt.y)+"Z"},De=function(We){var vt=ae(We.x0),Pt=ae(We.x1),Zt=le(We.y0),zt=le(We.y1),At=Pt-vt,Wt=zt-Zt;if(!At||!Wt)return"";var Bt=0,Ct=At>2*Bt&&Wt>2*Bt?Bt:0,Ze=function(nt,Ye){return Ct?"a"+he(Ct,Ct)+" 0 0 1 "+he(nt,Ye):""};return"M"+he(vt,Zt+Ct)+Ze(Ct,-Ct)+"L"+he(Pt-Ct,Zt)+Ze(Ct,Ct)+"L"+he(Pt,zt-Ct)+Ze(-Ct,Ct)+"L"+he(vt+Ct,zt)+Ze(-Ct,-Ct)+"Z"},Ie=function(We,vt){var Pt=We.x0,Zt=We.x1,zt=We.y0,At=We.y1,Wt=We.textBB,Bt=function(Mt){return M.textposition.indexOf(Mt)!==-1},Ct=Bt("bottom"),Ze=Bt("top")||vt.isHeader&&!Ct,nt=Ze?"start":Ct?"end":"middle",Ye=Bt("right"),Ee=Bt("left")||vt.onPathbar,Ge=Ee?-1:Ye?1:0,Je=M[y?"tiling":"marker"].pad;if(vt.isHeader){if(Pt+=(y?Je:Je.l)-e,Zt-=(y?Je:Je.r)-e,Pt>=Zt){var qe=(Pt+Zt)/2;Pt=qe,Zt=qe}var Tt;Ct?(Tt=At-(y?Je:Je.b),zt<Tt&&Tt<At&&(zt=Tt)):(Tt=zt+(y?Je:Je.t),zt<Tt&&Tt<At&&(At=Tt))}var mt=n(Pt,Zt,zt,At,Wt,{isHorizontal:!1,constrained:!0,angle:0,anchor:nt,leftToRight:Ge});return mt.fontSize=vt.fontSize,mt.targetX=ae(mt.targetX),mt.targetY=le(mt.targetY),isNaN(mt.targetX)||isNaN(mt.targetY)?{}:(Pt!==Zt&&zt!==At&&r(M.type,mt,b),{scale:mt.scale,rotate:mt.rotate,textX:mt.textX,textY:mt.textY,anchorX:mt.anchorX,anchorY:mt.anchorY,targetX:mt.targetX,targetY:mt.targetY})},Te=function(We,vt){for(var Pt,Zt=0,zt=We;!Pt&&Zt<z;)Zt++,zt=zt.parent,zt?Pt=ee(zt,vt):Zt=z;return Pt||{}},Ce=function(We,vt,Pt,Zt){var zt=ee(We,vt),At;if(vt)At=re;else{var Wt=ee(d,vt);Wt?At=ue(We,Wt,Zt):At={}}return u(zt,At)},He=function(We,vt,Pt,Zt,zt){var At=ee(We,vt),Wt;if(At)Wt=At;else if(vt)Wt=re;else if(K)if(We.parent){var Bt=Y||Pt;Bt&&!vt?Wt=ue(We,Bt,Zt):(Wt={},T.extendFlat(Wt,Te(We,vt)))}else Wt=T.extendFlat({},We),y&&(zt.orientation==="h"?zt.flipX?Wt.x0=We.x1:Wt.x1=0:zt.flipY?Wt.y0=We.y1:Wt.y1=0);else Wt={};return u(Wt,{x0:We.x0,x1:We.x1,y0:We.y0,y1:We.y1})},Xe=function(We,vt,Pt,Zt){var zt=ee(We,vt),At={},Wt=ne(We,vt,Pt,Zt);T.extendFlat(At,{transform:Ie({x0:Wt.x0,x1:Wt.x1,y0:Wt.y0,y1:Wt.y1,textBB:We.textBB,_text:We._text},{isHeader:A.isHeader(We,M)})}),zt?At=zt:We.parent&&T.extendFlat(At,Te(We,vt));var Bt=We.transform;return We.x0!==We.x1&&We.y0!==We.y1&&r(M.type,Bt,b),u(At,{transform:{scale:Bt.scale,rotate:Bt.rotate,textX:Bt.textX,textY:Bt.textY,anchorX:Bt.anchorX,anchorY:Bt.anchorY,targetX:Bt.targetX,targetY:Bt.targetY}})},Be=function(We,vt,Pt,Zt,zt){var At=Zt[0],Wt=Zt[1];B?We.exit().transition().each(function(){var Bt=h.select(this),Ct=Bt.select("path.surface");Ct.transition().attrTween("d",function(nt){var Ye=Ce(nt,vt,Pt,[At,Wt]);return function(Ee){return zt(Ye(Ee))}});var Ze=Bt.select("g.slicetext");Ze.attr("opacity",0)}).remove():We.exit().remove()},Re=function(We){var vt=We.transform;return We.x0!==We.x1&&We.y0!==We.y1&&r(M.type,vt,b),T.getTextTransform({textX:vt.textX,textY:vt.textY,anchorX:vt.anchorX,anchorY:vt.anchorY,targetX:vt.targetX,targetY:vt.targetY,scale:vt.scale,rotate:vt.rotate})};B&&(S.each(function(We){te[s(We)]={x0:We.x0,x1:We.x1,y0:We.y0,y1:We.y1},We.transform&&(te[s(We)].transform={textX:We.transform.textX,textY:We.transform.textY,anchorX:We.transform.anchorX,anchorY:We.transform.anchorY,targetX:We.transform.targetX,targetY:We.transform.targetY,scale:We.transform.scale,rotate:We.transform.rotate})}),E.each(function(We){G[s(We)]={x0:We.x0,x1:We.x1,y0:We.y0,y1:We.y1},We.transform&&(G[s(We)].transform={textX:We.transform.textX,textY:We.transform.textY,anchorX:We.transform.anchorX,anchorY:We.transform.anchorY,targetX:We.transform.targetX,targetY:We.transform.targetY,scale:We.transform.scale,rotate:We.transform.rotate}),!K&&A.isEntry(We)&&(K=We)})),Y=l(g,p,d,E,{width:N,height:V,viewX:ae,viewY:le,pathSlice:De,toMoveInsideSlice:Ie,prevEntry:K,makeUpdateSliceInterpolator:He,makeUpdateTextInterpolator:Xe,handleSlicesExit:Be,hasTransition:B,strTransform:Re}),M.pathbar.visible?o(g,p,d,S,{barDifY:X,width:H,height:j,viewX:xe,viewY:oe,pathSlice:Se,toMoveInsideSlice:Ie,makeUpdateSliceInterpolator:He,makeUpdateTextInterpolator:Xe,handleSlicesExit:Be,hasTransition:B,strTransform:Re}):S.remove()}},{"../../lib":515,"../bar/constants":659,"../bar/plot":668,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./constants":1087,"./draw_ancestors":1090,"@plotly/d3":58,"d3-interpolate":116}],1099:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/color"),A=t("../../lib"),T=t("../sunburst/helpers"),e=t("../bar/uniform_text").resizeText;function i(a){var r=a._fullLayout._treemaplayer.selectAll(".trace");e(a,r,"treemap"),r.each(function(f){var o=h.select(this),s=f[0],m=s.trace;o.style("opacity",m.opacity),o.selectAll("path.surface").each(function(g){h.select(this).call(n,g,m,{hovered:!1})})})}function n(a,r,f,o){var s=(o||{}).hovered,m=r.data.data,g=m.i,p,v,x=m.color,l=T.isHierarchyRoot(r),b=1;if(s)p=f._hovered.marker.line.color,v=f._hovered.marker.line.width;else if(l&&x===f.root.color)b=100,p="rgba(0,0,0,0)",v=0;else if(p=A.castOption(f,g,"marker.line.color")||u.defaultLine,v=A.castOption(f,g,"marker.line.width")||0,!f._hasColorscale&&!r.onPathbar){var c=f.marker.depthfade;if(c){var M=u.combine(u.addOpacity(f._backgroundColor,.75),x),_;if(c===!0){var y=T.getMaxDepth(f);isFinite(y)?T.isLeaf(r)?_=0:_=f._maxVisibleLayers-(r.data.depth-f._entryDepth):_=r.data.height+1}else _=r.data.depth-f._entryDepth,f._atRootLevel||_++;if(_>0)for(var w=0;w<_;w++){var d=.5*w/_;x=u.combine(u.addOpacity(M,d),x)}}}a.style("stroke-width",v).call(u.fill,x).call(u.stroke,p).style("opacity",b)}P.exports={style:i,styleOne:n}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"../sunburst/helpers":1064,"@plotly/d3":58}],1100:[function(t,P,R){var h=t("../box/attributes"),u=t("../../lib/extend").extendFlat,A=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat;P.exports={y:h.y,x:h.x,x0:h.x0,y0:h.y0,xhoverformat:A("x"),yhoverformat:A("y"),name:u({},h.name,{}),orientation:u({},h.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:h.fillcolor,points:u({},h.boxpoints,{}),jitter:u({},h.jitter,{}),pointpos:u({},h.pointpos,{}),width:u({},h.width,{}),marker:h.marker,text:h.text,hovertext:h.hovertext,hovertemplate:h.hovertemplate,quartilemethod:h.quartilemethod,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:h.offsetgroup,alignmentgroup:h.alignmentgroup,selected:h.selected,unselected:h.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682}],1101:[function(t,P,R){var h=t("../../lib"),u=t("../../plots/cartesian/axes"),A=t("../box/calc"),T=t("./helpers"),e=t("../../constants/numerical").BADNUM;P.exports=function(f,o){var s=A(f,o);if(s[0].t.empty)return s;for(var m=f._fullLayout,g=u.getFromId(f,o[o.orientation==="h"?"xaxis":"yaxis"]),p=1/0,v=-1/0,x=0,l=0,b=0;b<s.length;b++){var c=s[b],M=c.pts.map(T.extractVal),_=c.bandwidth=n(o,c,M),y=c.span=a(o,c,g,_);if(c.min===c.max&&_===0)y=c.span=[c.min,c.max],c.density=[{v:1,t:y[0]}],c.bandwidth=_,x=Math.max(x,1);else{var w=y[1]-y[0],d=Math.ceil(w/(_/3)),C=w/d;if(!isFinite(C)||!isFinite(d))return h.error("Something went wrong with computing the violin span"),s[0].t.empty=!0,s;var S=T.makeKDE(c,o,M);c.density=new Array(d);for(var E=0,k=y[0];k<y[1]+C/2;E++,k+=C){var B=S(k);c.density[E]={v:B,t:k},x=Math.max(x,B)}}l=Math.max(l,M.length),p=Math.min(p,y[0]),v=Math.max(v,y[1])}var z=u.findExtremes(g,[p,v],{padded:!0});if(o._extremes[g._id]=z,o.width)s[0].t.maxKDE=x;else{var F=m._violinScaleGroupStats,I=o.scalegroup,O=F[I];O?(O.maxKDE=Math.max(O.maxKDE,x),O.maxCount=Math.max(O.maxCount,l)):F[I]={maxKDE:x,maxCount:l}}return s[0].t.labels.kde=h._(f,"kde:"),s};function i(r,f,o){var s=Math.min(f,o/1.349);return 1.059*s*Math.pow(r,-.2)}function n(r,f,o){var s=f.max-f.min;if(!s)return r.bandwidth?r.bandwidth:0;if(r.bandwidth)return Math.max(r.bandwidth,s/1e4);var m=o.length,g=h.stdev(o,m-1,f.mean);return Math.max(i(m,g,f.q3-f.q1),s/100)}function a(r,f,o,s){var m=r.spanmode,g=r.span||[],p=[f.min,f.max],v=[f.min-2*s,f.max+2*s],x;function l(c){var M=g[c],_=o.type==="multicategory"?o.r2c(M):o.d2c(M,0,r[f.valLetter+"calendar"]);return _===e?v[c]:_}m==="soft"?x=v:m==="hard"?x=p:x=[l(0),l(1)];var b={type:"linear",range:x};return u.setConvert(b),b.cleanRange(),x}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../box/calc":683,"./helpers":1104}],1102:[function(t,P,R){var h=t("../box/cross_trace_calc").setPositionOffset,u=["v","h"];P.exports=function(T,e){for(var i=T.calcdata,n=e.xaxis,a=e.yaxis,r=0;r<u.length;r++){for(var f=u[r],o=f==="h"?a:n,s=[],m=0;m<i.length;m++){var g=i[m],p=g[0].t,v=g[0].trace;v.visible===!0&&v.type==="violin"&&!p.empty&&v.orientation===f&&v.xaxis===n._id&&v.yaxis===a._id&&s.push(m)}h("violin",T,s,o)}}},{"../box/cross_trace_calc":684}],1103:[function(t,P,R){var h=t("../../lib"),u=t("../../components/color"),A=t("../box/defaults"),T=t("./attributes");P.exports=function(i,n,a,r){function f(C,S){return h.coerce(i,n,T,C,S)}function o(C,S){return h.coerce2(i,n,T,C,S)}if(A.handleSampleDefaults(i,n,f,r),n.visible!==!1){f("bandwidth"),f("side");var s=f("width");s||(f("scalegroup",n.name),f("scalemode"));var m=f("span"),g;Array.isArray(m)&&(g="manual"),f("spanmode",g);var p=f("line.color",(i.marker||{}).color||a),v=f("line.width"),x=f("fillcolor",u.addOpacity(n.line.color,.5));A.handlePointsDefaults(i,n,f,{prefix:""});var l=o("box.width"),b=o("box.fillcolor",x),c=o("box.line.color",p),M=o("box.line.width",v),_=f("box.visible",Boolean(l||b||c||M));_||(n.box={visible:!1});var y=o("meanline.color",p),w=o("meanline.width",v),d=f("meanline.visible",Boolean(y||w));d||(n.meanline={visible:!1}),f("quartilemethod")}}},{"../../components/color":367,"../../lib":515,"../box/defaults":685,"./attributes":1100}],1104:[function(t,P,R){var h=t("../../lib"),u={gaussian:function(A){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*A*A)}};R.makeKDE=function(A,T,e){var i=e.length,n=u.gaussian,a=A.bandwidth,r=1/(i*a);return function(f){for(var o=0,s=0;s<i;s++)o+=n((f-e[s])/a);return r*o}},R.getPositionOnKdePath=function(A,T,e){var i,n;T.orientation==="h"?(i="y",n="x"):(i="x",n="y");var a=h.findPointOnPath(A.path,e,n,{pathLength:A.pathLength}),r=A.posCenterPx,f=a[i],o=T.side==="both"?2*r-f:r;return[f,o]},R.getKdeValue=function(A,T,e){var i=A.pts.map(R.extractVal),n=R.makeKDE(A,T,i);return n(e)/A.posDensityScale},R.extractVal=function(A){return A.v}},{"../../lib":515}],1105:[function(t,P,R){var h=t("../../components/color"),u=t("../../lib"),A=t("../../plots/cartesian/axes"),T=t("../box/hover"),e=t("./helpers");P.exports=function(n,a,r,f,o){o||(o={});var s=o.hoverLayer,m=n.cd,g=m[0].trace,p=g.hoveron,v=p.indexOf("violins")!==-1,x=p.indexOf("kde")!==-1,l=[],b,c;if(v||x){var M=T.hoverOnBoxes(n,a,r,f);if(x&&M.length>0){var _=n.xa,y=n.ya,w,d,C,S,E;g.orientation==="h"?(E=a,w="y",C=y,d="x",S=_):(E=r,w="x",C=_,d="y",S=y);var k=m[n.index];if(E>=k.span[0]&&E<=k.span[1]){var B=u.extendFlat({},n),z=S.c2p(E,!0),F=e.getKdeValue(k,g,E),I=e.getPositionOnKdePath(k,g,z),O=C._offset,N=C._length;B[w+"0"]=I[0],B[w+"1"]=I[1],B[d+"0"]=B[d+"1"]=z,B[d+"Label"]=d+": "+A.hoverLabelText(S,E,g[d+"hoverformat"])+", "+m[0].t.labels.kde+" "+F.toFixed(3);for(var V=0,H=0;H<M.length;H++)if(M[H].attr==="med"){V=H;break}B.spikeDistance=M[V].spikeDistance;var j=w+"Spike";B[j]=M[V][j],M[V].spikeDistance=void 0,M[V][j]=void 0,B.hovertemplate=!1,l.push(B),c={},c[w+"1"]=u.constrain(O+I[0],O,O+N),c[w+"2"]=u.constrain(O+I[1],O,O+N),c[d+"1"]=c[d+"2"]=S._offset+z}}v&&(l=l.concat(M))}p.indexOf("points")!==-1&&(b=T.hoverOnPoints(n,a,r));var Z=s.selectAll(".violinline-"+g.uid).data(c?[0]:[]);return Z.enter().append("line").classed("violinline-"+g.uid,!0).attr("stroke-width",1.5),Z.exit().remove(),Z.attr(c).call(h.stroke,n.color),f==="closest"?b?[b]:l:(b&&l.push(b),l)}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axes":566,"../box/hover":687,"./helpers":1104}],1106:[function(t,P,R){P.exports={attributes:t("./attributes"),layoutAttributes:t("./layout_attributes"),supplyDefaults:t("./defaults"),crossTraceDefaults:t("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:t("./layout_defaults"),calc:t("./calc"),crossTraceCalc:t("./cross_trace_calc"),plot:t("./plot"),style:t("./style"),styleOnSelect:t("../scatter/style").styleOnSelect,hoverPoints:t("./hover"),selectPoints:t("../box/select"),moduleType:"trace",name:"violin",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../box/defaults":685,"../box/select":692,"../scatter/style":960,"./attributes":1100,"./calc":1101,"./cross_trace_calc":1102,"./defaults":1103,"./hover":1105,"./layout_attributes":1107,"./layout_defaults":1108,"./plot":1109,"./style":1110}],1107:[function(t,P,R){var h=t("../box/layout_attributes"),u=t("../../lib").extendFlat;P.exports={violinmode:u({},h.boxmode,{}),violingap:u({},h.boxgap,{}),violingroupgap:u({},h.boxgroupgap,{})}},{"../../lib":515,"../box/layout_attributes":689}],1108:[function(t,P,R){var h=t("../../lib"),u=t("./layout_attributes"),A=t("../box/layout_defaults");P.exports=function(e,i,n){function a(r,f){return h.coerce(e,i,u,r,f)}A._supply(e,i,n,a,"violin")}},{"../../lib":515,"../box/layout_defaults":690,"./layout_attributes":1107}],1109:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=t("../../components/drawing"),T=t("../box/plot"),e=t("../scatter/line_points"),i=t("./helpers");P.exports=function(a,r,f,o){var s=a._fullLayout,m=r.xaxis,g=r.yaxis;function p(v,x){var l=e(v,{xaxis:m,yaxis:g,trace:x,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return A.smoothopen(l[0],1)}u.makeTraceGroups(o,f,"trace violins").each(function(v){var x=h.select(this),l=v[0],b=l.t,c=l.trace;if(c.visible!==!0||b.empty){x.remove();return}var M=b.bPos,_=b.bdPos,y=r[b.valLetter+"axis"],w=r[b.posLetter+"axis"],d=c.side==="both",C=d||c.side==="positive",S=d||c.side==="negative",E=x.selectAll("path.violin").data(u.identity);E.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),E.exit().remove(),E.each(function(V){var H=h.select(this),j=V.density,Z=j.length,X=w.c2l(V.pos+M,!0),re=w.l2p(X),ue;if(c.width)ue=b.maxKDE/_;else{var K=s._violinScaleGroupStats[c.scalegroup];ue=c.scalemode==="count"?K.maxKDE/_*(K.maxCount/V.pts.length):K.maxKDE/_}var te,G,Y,ee,ne,J,q;if(C){for(J=new Array(Z),ee=0;ee<Z;ee++)q=J[ee]={},q[b.posLetter]=X+j[ee].v/ue,q[b.valLetter]=y.c2l(j[ee].t,!0);te=p(J,c)}if(S){for(J=new Array(Z),ne=0,ee=Z-1;ne<Z;ne++,ee--)q=J[ne]={},q[b.posLetter]=X-j[ee].v/ue,q[b.valLetter]=y.c2l(j[ee].t,!0);G=p(J,c)}if(d)Y=te+"L"+G.substr(1)+"Z";else{var ae=[re,y.c2p(j[0].t)],le=[re,y.c2p(j[Z-1].t)];c.orientation==="h"&&(ae.reverse(),le.reverse()),C?Y="M"+ae+"L"+te.substr(1)+"L"+le:Y="M"+le+"L"+G.substr(1)+"L"+ae}H.attr("d",Y),V.posCenterPx=re,V.posDensityScale=ue*_,V.path=H.node(),V.pathLength=V.path.getTotalLength()/(d?2:1)});var k=c.box,B=k.width,z=(k.line||{}).width,F,I;d?(F=_*B,I=0):C?(F=[0,_*B/2],I=z*{x:1,y:-1}[b.posLetter]):(F=[_*B/2,0],I=z*{x:-1,y:1}[b.posLetter]),T.plotBoxAndWhiskers(x,{pos:w,val:y},c,{bPos:M,bdPos:F,bPosPxOffset:I}),T.plotBoxMean(x,{pos:w,val:y},c,{bPos:M,bdPos:F,bPosPxOffset:I});var O;!c.box.visible&&c.meanline.visible&&(O=u.identity);var N=x.selectAll("path.meanline").data(O||[]);N.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),N.exit().remove(),N.each(function(V){var H=y.c2p(V.mean,!0),j=i.getPositionOnKdePath(V,c,H);h.select(this).attr("d",c.orientation==="h"?"M"+H+","+j[0]+"V"+j[1]:"M"+j[0]+","+H+"H"+j[1])}),T.plotPoints(x,{x:m,y:g},c,b)})}},{"../../components/drawing":389,"../../lib":515,"../box/plot":691,"../scatter/line_points":950,"./helpers":1104,"@plotly/d3":58}],1110:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/color"),A=t("../scatter/style").stylePoints;P.exports=function(e){var i=h.select(e).selectAll("g.trace.violins");i.style("opacity",function(n){return n[0].trace.opacity}),i.each(function(n){var a=n[0].trace,r=h.select(this),f=a.box||{},o=f.line||{},s=a.meanline||{},m=s.width;r.selectAll("path.violin").style("stroke-width",a.line.width+"px").call(u.stroke,a.line.color).call(u.fill,a.fillcolor),r.selectAll("path.box").style("stroke-width",o.width+"px").call(u.stroke,o.color).call(u.fill,f.fillcolor);var g={"stroke-width":m+"px","stroke-dasharray":2*m+"px,"+m+"px"};r.selectAll("path.mean").style(g).call(u.stroke,s.color),r.selectAll("path.meanline").style(g).call(u.stroke,s.color),A(r,a,e)})}},{"../../components/color":367,"../scatter/style":960,"@plotly/d3":58}],1111:[function(t,P,R){var h=t("../../components/colorscale/attributes"),u=t("../isosurface/attributes"),A=t("../surface/attributes"),T=t("../../plots/attributes"),e=t("../../lib/extend").extendFlat,i=t("../../plot_api/edit_types").overrideAll,n=P.exports=i(e({x:u.x,y:u.y,z:u.z,value:u.value,isomin:u.isomin,isomax:u.isomax,surface:u.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:u.slices,caps:u.caps,text:u.text,hovertext:u.hovertext,xhoverformat:u.xhoverformat,yhoverformat:u.yhoverformat,zhoverformat:u.zhoverformat,valuehoverformat:u.valuehoverformat,hovertemplate:u.hovertemplate},h("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:u.colorbar,opacity:u.opacity,opacityscale:A.opacityscale,lightposition:u.lightposition,lighting:u.lighting,flatshading:u.flatshading,contour:u.contour,hoverinfo:e({},T.hoverinfo),showlegend:e({},T.showlegend,{dflt:!1})}),"calc","nested");n.x.editType=n.y.editType=n.z.editType=n.value.editType="calc+clearAxisTypes",n.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../isosurface/attributes":871,"../surface/attributes":1070}],1112:[function(t,P,R){var h=t("../../../stackgl_modules").gl_mesh3d,u=t("../../lib/gl_format_color").parseColorScale,A=t("../../lib/str2rgbarray"),T=t("../../components/colorscale").extractOpts,e=t("../../plots/gl3d/zip3"),i=t("../isosurface/convert").findNearestOnAxis,n=t("../isosurface/convert").generateIsoMeshes;function a(o,s,m){this.scene=o,this.uid=m,this.mesh=s,this.name="",this.data=null,this.showContour=!1}var r=a.prototype;r.handlePick=function(o){if(o.object===this.mesh){var s=o.data.index,m=this.data._meshX[s],g=this.data._meshY[s],p=this.data._meshZ[s],v=this.data._Ys.length,x=this.data._Zs.length,l=i(m,this.data._Xs).id,b=i(g,this.data._Ys).id,c=i(p,this.data._Zs).id,M=o.index=c+x*b+x*v*l;o.traceCoordinate=[this.data._meshX[M],this.data._meshY[M],this.data._meshZ[M],this.data._value[M]];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[M]!==void 0?o.textLabel=_[M]:_&&(o.textLabel=_),!0}},r.update=function(o){var s=this.scene,m=s.fullSceneLayout;this.data=n(o);function g(b,c,M,_){return c.map(function(y){return b.d2l(y,0,_)*M})}var p=e(g(m.xaxis,o._meshX,s.dataScale[0],o.xcalendar),g(m.yaxis,o._meshY,s.dataScale[1],o.ycalendar),g(m.zaxis,o._meshZ,s.dataScale[2],o.zcalendar)),v=e(o._meshI,o._meshJ,o._meshK),x={positions:p,cells:v,lightPosition:[o.lightposition.x,o.lightposition.y,o.lightposition.z],ambient:o.lighting.ambient,diffuse:o.lighting.diffuse,specular:o.lighting.specular,roughness:o.lighting.roughness,fresnel:o.lighting.fresnel,vertexNormalsEpsilon:o.lighting.vertexnormalsepsilon,faceNormalsEpsilon:o.lighting.facenormalsepsilon,opacity:o.opacity,opacityscale:o.opacityscale,contourEnable:o.contour.show,contourColor:A(o.contour.color).slice(0,3),contourWidth:o.contour.width,useFacetNormals:o.flatshading},l=T(o);x.vertexIntensity=o._meshIntensity,x.vertexIntensityBounds=[l.min,l.max],x.colormap=u(o),this.mesh.update(x)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function f(o,s){var m=o.glplot.gl,g=h({gl:m}),p=new a(o,g,s.uid);return g._trace=p,p.update(s),o.glplot.add(g),p}P.exports=f},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618,"../isosurface/convert":873}],1113:[function(t,P,R){var h=t("../../lib"),u=t("./attributes"),A=t("../isosurface/defaults").supplyIsoDefaults,T=t("../surface/defaults").opacityscaleDefaults;P.exports=function(i,n,a,r){function f(o,s){return h.coerce(i,n,u,o,s)}A(i,n,a,r,f),T(i,n,r,f)}},{"../../lib":515,"../isosurface/defaults":874,"../surface/defaults":1073,"./attributes":1111}],1114:[function(t,P,R){P.exports={attributes:t("./attributes"),supplyDefaults:t("./defaults"),calc:t("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:t("./convert"),moduleType:"trace",name:"volume",basePlotModule:t("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"../isosurface/calc":872,"./attributes":1111,"./convert":1112,"./defaults":1113}],1115:[function(t,P,R){var h=t("../bar/attributes"),u=t("../scatter/attributes").line,A=t("../../plots/attributes"),T=t("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=t("../../plots/template_attributes").hovertemplateAttrs,i=t("../../plots/template_attributes").texttemplateAttrs,n=t("./constants"),a=t("../../lib/extend").extendFlat,r=t("../../components/color");function f(o){return{marker:{color:a({},h.marker.color,{arrayOk:!1,editType:"style"}),line:{color:a({},h.marker.line.color,{arrayOk:!1,editType:"style"}),width:a({},h.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}P.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:h.x,x0:h.x0,dx:h.dx,y:h.y,y0:h.y0,dy:h.dy,xperiod:h.xperiod,yperiod:h.yperiod,xperiod0:h.xperiod0,yperiod0:h.yperiod0,xperiodalignment:h.xperiodalignment,yperiodalignment:h.yperiodalignment,xhoverformat:T("x"),yhoverformat:T("y"),hovertext:h.hovertext,hovertemplate:e({},{keys:n.eventDataKeys}),hoverinfo:a({},A.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:i({editType:"plot"},{keys:n.eventDataKeys.concat(["label"])}),text:h.text,textposition:h.textposition,insidetextanchor:h.insidetextanchor,textangle:h.textangle,textfont:h.textfont,insidetextfont:h.insidetextfont,outsidetextfont:h.outsidetextfont,constraintext:h.constraintext,cliponaxis:h.cliponaxis,orientation:h.orientation,offset:h.offset,width:h.width,increasing:f(),decreasing:f(),totals:f(),connector:{line:{color:a({},u.color,{dflt:r.defaultLine}),width:a({},u.width,{editType:"plot"}),dash:u.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:h.offsetgroup,alignmentgroup:h.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":1117}],1116:[function(t,P,R){var h=t("../../plots/cartesian/axes"),u=t("../../plots/cartesian/align_period"),A=t("../../lib").mergeArray,T=t("../scatter/calc_selection"),e=t("../../constants/numerical").BADNUM;function i(a){return a==="a"||a==="absolute"}function n(a){return a==="t"||a==="total"}P.exports=function(r,f){var o=h.getFromId(r,f.xaxis||"x"),s=h.getFromId(r,f.yaxis||"y"),m,g,p,v,x,l;f.orientation==="h"?(m=o.makeCalcdata(f,"x"),p=s.makeCalcdata(f,"y"),v=u(f,s,"y",p),x=!!f.yperiodalignment,l="y"):(m=s.makeCalcdata(f,"y"),p=o.makeCalcdata(f,"x"),v=u(f,o,"x",p),x=!!f.xperiodalignment,l="x"),g=v.vals;for(var b=Math.min(g.length,m.length),c=new Array(b),M=0,_,y=!1,w=0;w<b;w++){var d=m[w]||0,C=!1;(m[w]!==e||n(f.measure[w])||i(f.measure[w]))&&w+1<b&&(m[w+1]!==e||n(f.measure[w+1])||i(f.measure[w+1]))&&(C=!0);var S=c[w]={i:w,p:g[w],s:d,rawS:d,cNext:C};i(f.measure[w])?(M=S.s,S.isSum=!0,S.dir="totals",S.s=M):n(f.measure[w])?(S.isSum=!0,S.dir="totals",S.s=M):(S.isSum=!1,S.dir=S.rawS<0?"decreasing":"increasing",_=S.s,S.s=M+_,M+=_),S.dir==="totals"&&(y=!0),x&&(c[w].orig_p=p[w],c[w][l+"End"]=v.ends[w],c[w][l+"Start"]=v.starts[w]),f.ids&&(S.id=String(f.ids[w])),S.v=(f.base||0)+M}return c.length&&(c[0].hasTotals=y),A(f.text,c,"tx"),A(f.hovertext,c,"htx"),T(c,f),c}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938}],1117:[function(t,P,R){P.exports={eventDataKeys:["initial","delta","final"]}},{}],1118:[function(t,P,R){var h=t("../bar/cross_trace_calc").setGroupPositions;P.exports=function(A,T){var e=A._fullLayout,i=A._fullData,n=A.calcdata,a=T.xaxis,r=T.yaxis,f=[],o=[],s=[],m,g;for(g=0;g<i.length;g++){var p=i[g];p.visible===!0&&p.xaxis===a._id&&p.yaxis===r._id&&p.type==="waterfall"&&(m=n[g],p.orientation==="h"?s.push(m):o.push(m),f.push(m))}var v={mode:e.waterfallmode,norm:e.waterfallnorm,gap:e.waterfallgap,groupgap:e.waterfallgroupgap};for(h(A,a,r,o,v),h(A,r,a,s,v),g=0;g<f.length;g++){m=f[g];for(var x=0;x<m.length;x++){var l=m[x];l.isSum===!1&&(l.s0+=x===0?0:m[x-1].s),x+1<m.length&&(m[x].nextP0=m[x+1].p0,m[x].nextS0=m[x+1].s0)}}}},{"../bar/cross_trace_calc":660}],1119:[function(t,P,R){var h=t("../../lib"),u=t("../bar/defaults").handleGroupingDefaults,A=t("../bar/defaults").handleText,T=t("../scatter/xy_defaults"),e=t("../scatter/period_defaults"),i=t("./attributes"),n=t("../../components/color"),a=t("../../constants/delta.js"),r=a.INCREASING.COLOR,f=a.DECREASING.COLOR,o="#4499FF";function s(p,v,x){p(v+".marker.color",x),p(v+".marker.line.color",n.defaultLine),p(v+".marker.line.width")}function m(p,v,x,l){function b(w,d){return h.coerce(p,v,i,w,d)}var c=T(p,v,l,b);if(!c){v.visible=!1;return}e(p,v,l,b),b("xhoverformat"),b("yhoverformat"),b("measure"),b("orientation",v.x&&!v.y?"h":"v"),b("base"),b("offset"),b("width"),b("text"),b("hovertext"),b("hovertemplate");var M=b("textposition");A(p,v,l,b,M,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),v.textposition!=="none"&&(b("texttemplate"),v.texttemplate||b("textinfo")),s(b,"increasing",r),s(b,"decreasing",f),s(b,"totals",o);var _=b("connector.visible");if(_){b("connector.mode");var y=b("connector.line.width");y&&(b("connector.line.color"),b("connector.line.dash"))}}function g(p,v){var x,l;function b(M){return h.coerce(l._input,l,i,M)}if(v.waterfallmode==="group")for(var c=0;c<p.length;c++)l=p[c],x=l._input,u(x,l,v,b)}P.exports={supplyDefaults:m,crossTraceDefaults:g}},{"../../components/color":367,"../../constants/delta.js":485,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":1115}],1120:[function(t,P,R){P.exports=function(u,A){return u.x="xVal"in A?A.xVal:A.x,u.y="yVal"in A?A.yVal:A.y,"initial"in A&&(u.initial=A.initial),"delta"in A&&(u.delta=A.delta),"final"in A&&(u.final=A.final),A.xa&&(u.xaxis=A.xa),A.ya&&(u.yaxis=A.ya),u}},{}],1121:[function(t,P,R){var h=t("../../plots/cartesian/axes").hoverLabelText,u=t("../../components/color").opacity,A=t("../bar/hover").hoverOnBars,T=t("../../constants/delta.js"),e={increasing:T.INCREASING.SYMBOL,decreasing:T.DECREASING.SYMBOL};P.exports=function(a,r,f,o,s){var m=A(a,r,f,o,s);if(!m)return;var g=m.cd,p=g[0].trace,v=p.orientation==="h",x=v?"x":"y",l=v?a.xa:a.ya;function b(k){return h(l,k,p[x+"hoverformat"])}var c=m.index,M=g[c],_=M.isSum?M.b+M.s:M.rawS;if(!M.isSum){m.initial=M.b+M.s-_,m.delta=_,m.final=m.initial+m.delta;var y=b(Math.abs(m.delta));m.deltaLabel=_<0?"("+y+")":y,m.finalLabel=b(m.final),m.initialLabel=b(m.initial)}var w=M.hi||p.hoverinfo,d=[];if(w&&w!=="none"&&w!=="skip"){var C=w==="all",S=w.split("+"),E=function(k){return C||S.indexOf(k)!==-1};M.isSum||(E("final")&&(v?!E("x"):!E("y"))&&d.push(m.finalLabel),E("delta")&&(_<0?d.push(m.deltaLabel+" "+e.decreasing):d.push(m.deltaLabel+" "+e.increasing)),E("initial")&&d.push("Initial: "+m.initialLabel))}return d.length&&(m.extraText=d.join("<br>")),m.color=i(p,M),[m]};function i(n,a){var r=n[a.dir].marker,f=r.color,o=r.line.color,s=r.line.width;if(u(f))return f;if(u(o)&&s)return o}},{"../../components/color":367,"../../constants/delta.js":485,"../../plots/cartesian/axes":566,"../bar/hover":664}],1122:[function(t,P,R){P.exports={attributes:t("./attributes"),layoutAttributes:t("./layout_attributes"),supplyDefaults:t("./defaults").supplyDefaults,crossTraceDefaults:t("./defaults").crossTraceDefaults,supplyLayoutDefaults:t("./layout_defaults"),calc:t("./calc"),crossTraceCalc:t("./cross_trace_calc"),plot:t("./plot"),style:t("./style").style,hoverPoints:t("./hover"),eventData:t("./event_data"),selectPoints:t("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:t("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":1115,"./calc":1116,"./cross_trace_calc":1118,"./defaults":1119,"./event_data":1120,"./hover":1121,"./layout_attributes":1123,"./layout_defaults":1124,"./plot":1125,"./style":1126}],1123:[function(t,P,R){P.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1124:[function(t,P,R){var h=t("../../lib"),u=t("./layout_attributes");P.exports=function(A,T,e){var i=!1;function n(f,o){return h.coerce(A,T,u,f,o)}for(var a=0;a<e.length;a++){var r=e[a];if(r.visible&&r.type==="waterfall"){i=!0;break}}i&&(n("waterfallmode"),n("waterfallgap",.2),n("waterfallgroupgap"))}},{"../../lib":515,"./layout_attributes":1123}],1125:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../lib"),A=t("../../components/drawing"),T=t("../../constants/numerical").BADNUM,e=t("../bar/plot"),i=t("../bar/uniform_text").clearMinTextSize;P.exports=function(f,o,s,m){var g=f._fullLayout;i("waterfall",g),e.plot(f,o,s,m,{mode:g.waterfallmode,norm:g.waterfallmode,gap:g.waterfallgap,groupgap:g.waterfallgroupgap}),n(f,o,s,m)};function n(r,f,o,s){var m=f.xaxis,g=f.yaxis;u.makeTraceGroups(s,o,"trace bars").each(function(p){var v=h.select(this),x=p[0].trace,l=u.ensureSingle(v,"g","lines");if(!x.connector||!x.connector.visible){l.remove();return}var b=x.orientation==="h",c=x.connector.mode,M=l.selectAll("g.line").data(u.identity);M.enter().append("g").classed("line",!0),M.exit().remove();var _=M.size();M.each(function(y,w){if(!(w!==_-1&&!y.cNext)){var d=a(y,m,g,b),C=d[0],S=d[1],E="";C[0]!==T&&S[0]!==T&&C[1]!==T&&S[1]!==T&&(c==="spanning"&&!y.isSum&&w>0&&(b?E+="M"+C[0]+","+S[1]+"V"+S[0]:E+="M"+C[1]+","+S[0]+"H"+C[0]),c!=="between"&&(y.isSum||w<_-1)&&(b?E+="M"+C[1]+","+S[0]+"V"+S[1]:E+="M"+C[0]+","+S[1]+"H"+C[1]),C[2]!==T&&S[2]!==T&&(b?E+="M"+C[1]+","+S[1]+"V"+S[2]:E+="M"+C[1]+","+S[1]+"H"+C[2])),E===""&&(E="M0,0Z"),u.ensureSingle(h.select(this),"path").attr("d",E).call(A.setClipUrl,f.layerClipId,r)}})})}function a(r,f,o,s){var m=[],g=[],p=s?f:o,v=s?o:f;return m[0]=p.c2p(r.s0,!0),g[0]=v.c2p(r.p0,!0),m[1]=p.c2p(r.s1,!0),g[1]=v.c2p(r.p1,!0),m[2]=p.c2p(r.nextS0,!0),g[2]=v.c2p(r.nextP0,!0),s?[m,g]:[g,m]}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],1126:[function(t,P,R){var h=t("@plotly/d3"),u=t("../../components/drawing"),A=t("../../components/color"),T=t("../../constants/interactions").DESELECTDIM,e=t("../bar/style"),i=t("../bar/uniform_text").resizeText,n=e.styleTextPoints;function a(r,f,o){var s=o||h.select(r).selectAll("g.waterfalllayer").selectAll("g.trace");i(r,s,"waterfall"),s.style("opacity",function(m){return m[0].trace.opacity}),s.each(function(m){var g=h.select(this),p=m[0].trace;g.selectAll(".point > path").each(function(v){if(!v.isBlank){var x=p[v.dir].marker;h.select(this).call(A.fill,x.color).call(A.stroke,x.line.color).call(u.dashLine,x.line.dash,x.line.width).style("opacity",p.selectedpoints&&!v.selected?T:1)}}),n(g,p,r),g.selectAll(".lines").each(function(){var v=p.connector.line;u.lineGroupStyle(h.select(this).selectAll("path"),v.width,v.color,v.dash)})})}P.exports={style:a}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],1127:[function(t,P,R){var h=t("../plots/cartesian/axes"),u=t("../lib"),A=t("../plot_api/plot_schema"),T=t("./helpers").pointsAccessorFunction,e=t("../constants/numerical").BADNUM;R.moduleType="transform",R.name="aggregate";var i=R.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},n=i.aggregations;R.supplyDefaults=function(m,g){var p={},v;function x(k,B){return u.coerce(m,p,i,k,B)}var l=x("enabled");if(!l)return p;var b=A.findArrayAttributes(g),c={};for(v=0;v<b.length;v++)c[b[v]]=1;var M=x("groups");if(!Array.isArray(M)){if(!c[M])return p.enabled=!1,p;c[M]=0}var _=m.aggregations||[],y=p.aggregations=new Array(_.length),w;function d(k,B){return u.coerce(_[v],w,n,k,B)}for(v=0;v<_.length;v++){w={_index:v};var C=d("target"),S=d("func"),E=d("enabled");E&&C&&(c[C]||S==="count"&&c[C]===void 0)?(S==="stddev"&&d("funcmode"),c[C]=0,y[v]=w):y[v]={enabled:!1,_index:v}}for(v=0;v<b.length;v++)c[b[v]]&&y.push({target:b[v],func:n.func.dflt,enabled:!0,_index:-1});return p},R.calcTransform=function(m,g,p){if(!!p.enabled){var v=p.groups,x=u.getTargetArray(g,{target:v});if(!!x){var l,b,c,M,_={},y={},w=[],d=T(g.transforms,p),C=x.length;for(g._length&&(C=Math.min(C,g._length)),l=0;l<C;l++)b=x[l],c=_[b],c===void 0?(_[b]=w.length,M=[l],w.push(M),y[_[b]]=d(l)):(w[c].push(l),y[_[b]]=(y[_[b]]||[]).concat(d(l)));p._indexToPoints=y;var S=p.aggregations;for(l=0;l<S.length;l++)a(m,g,w,S[l]);typeof v=="string"&&a(m,g,w,{target:v,func:"first",enabled:!0}),g._length=w.length}}};function a(m,g,p,v){if(!!v.enabled){for(var x=v.target,l=u.nestedProperty(g,x),b=l.get(),c=h.getDataConversions(m,g,x,b),M=r(v,c),_=new Array(p.length),y=0;y<p.length;y++)_[y]=M(b,p[y]);l.set(_),v.func==="count"&&u.pushUnique(g._arrayAttrs,x)}}function r(m,g){var p=m.func,v=g.d2c,x=g.c2d;switch(p){case"count":return f;case"first":return o;case"last":return s;case"sum":return function(l,b){for(var c=0,M=0;M<b.length;M++){var _=v(l[b[M]]);_!==e&&(c+=_)}return x(c)};case"avg":return function(l,b){for(var c=0,M=0,_=0;_<b.length;_++){var y=v(l[b[_]]);y!==e&&(c+=y,M++)}return M?x(c/M):e};case"min":return function(l,b){for(var c=1/0,M=0;M<b.length;M++){var _=v(l[b[M]]);_!==e&&(c=Math.min(c,_))}return c===1/0?e:x(c)};case"max":return function(l,b){for(var c=-1/0,M=0;M<b.length;M++){var _=v(l[b[M]]);_!==e&&(c=Math.max(c,_))}return c===-1/0?e:x(c)};case"range":return function(l,b){for(var c=1/0,M=-1/0,_=0;_<b.length;_++){var y=v(l[b[_]]);y!==e&&(c=Math.min(c,y),M=Math.max(M,y))}return M===-1/0||c===1/0?e:x(M-c)};case"change":return function(l,b){var c=v(l[b[0]]),M=v(l[b[b.length-1]]);return c===e||M===e?e:x(M-c)};case"median":return function(l,b){for(var c=[],M=0;M<b.length;M++){var _=v(l[b[M]]);_!==e&&c.push(_)}if(!c.length)return e;c.sort(u.sorterAsc);var y=(c.length-1)/2;return x((c[Math.floor(y)]+c[Math.ceil(y)])/2)};case"mode":return function(l,b){for(var c={},M=0,_=e,y=0;y<b.length;y++){var w=v(l[b[y]]);if(w!==e){var d=c[w]=(c[w]||0)+1;d>M&&(M=d,_=w)}}return M?x(_):e};case"rms":return function(l,b){for(var c=0,M=0,_=0;_<b.length;_++){var y=v(l[b[_]]);y!==e&&(c+=y*y,M++)}return M?x(Math.sqrt(c/M)):e};case"stddev":return function(l,b){var c=0,M=0,_=1,y=e,w;for(w=0;w<b.length&&y===e;w++)y=v(l[b[w]]);if(y===e)return e;for(;w<b.length;w++){var d=v(l[b[w]]);if(d!==e){var C=d-y;c+=C,M+=C*C,_++}}var S=m.funcmode==="sample"?_-1:_;return S?Math.sqrt((M-c*c/_)/S):0}}}function f(m,g){return g.length}function o(m,g){return m[g[0]]}function s(m,g){return m[g[g.length-1]]}},{"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plots/cartesian/axes":566,"./helpers":1130}],1128:[function(t,P,R){var h=t("../lib"),u=t("../registry"),A=t("../plots/cartesian/axes"),T=t("./helpers").pointsAccessorFunction,e=t("../constants/filter_ops"),i=e.COMPARISON_OPS,n=e.INTERVAL_OPS,a=e.SET_OPS;R.moduleType="transform",R.name="filter",R.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(i).concat(n).concat(a),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},R.supplyDefaults=function(f){var o={};function s(v,x){return h.coerce(f,o,R.attributes,v,x)}var m=s("enabled");if(m){var g=s("target");if(h.isArrayOrTypedArray(g)&&g.length===0)return o.enabled=!1,o;s("preservegaps"),s("operation"),s("value");var p=u.getComponentMethod("calendars","handleDefaults");p(f,o,"valuecalendar",null),p(f,o,"targetcalendar",null)}return o},R.calcTransform=function(f,o,s){if(!s.enabled)return;var m=h.getTargetArray(o,s);if(!m)return;var g=s.target,p=m.length;o._length&&(p=Math.min(p,o._length));var v=s.targetcalendar,x=o._arrayAttrs,l=s.preservegaps;if(typeof g=="string"){var b=h.nestedProperty(o,g+"calendar").get();b&&(v=b)}var c=A.getDataToCoordFunc(f,o,g,m),M=r(s,c,v),_={},y={},w=0;function d(z,F){for(var I=0;I<x.length;I++){var O=h.nestedProperty(o,x[I]);z(O,F)}}var C,S;l?(C=function(z){_[z.astr]=h.extendDeep([],z.get()),z.set(new Array(p))},S=function(z,F){var I=_[z.astr][F];z.get()[F]=I}):(C=function(z){_[z.astr]=h.extendDeep([],z.get()),z.set([])},S=function(z,F){var I=_[z.astr][F];z.get().push(I)}),d(C);for(var E=T(o.transforms,s),k=0;k<p;k++){var B=M(m[k]);B?(d(S,k),y[w++]=E(k)):l&&w++}s._indexToPoints=y,o._length=w};function r(f,o,s){var m=f.operation,g=f.value,p=Array.isArray(g);function v(c){return c.indexOf(m)!==-1}var x=function(c){return o(c,0,f.valuecalendar)},l=function(c){return o(c,0,s)},b;switch(v(i)?b=x(p?g[0]:g):v(n)?b=p?[x(g[0]),x(g[1])]:[x(g),x(g)]:v(a)&&(b=p?g.map(x):[x(g)]),m){case"=":return function(c){return l(c)===b};case"!=":return function(c){return l(c)!==b};case"<":return function(c){return l(c)<b};case"<=":return function(c){return l(c)<=b};case">":return function(c){return l(c)>b};case">=":return function(c){return l(c)>=b};case"[]":return function(c){var M=l(c);return M>=b[0]&&M<=b[1]};case"()":return function(c){var M=l(c);return M>b[0]&&M<b[1]};case"[)":return function(c){var M=l(c);return M>=b[0]&&M<b[1]};case"(]":return function(c){var M=l(c);return M>b[0]&&M<=b[1]};case"][":return function(c){var M=l(c);return M<=b[0]||M>=b[1]};case")(":return function(c){var M=l(c);return M<b[0]||M>b[1]};case"](":return function(c){var M=l(c);return M<=b[0]||M>b[1]};case")[":return function(c){var M=l(c);return M<b[0]||M>=b[1]};case"{}":return function(c){return b.indexOf(l(c))!==-1};case"}{":return function(c){return b.indexOf(l(c))===-1}}}},{"../constants/filter_ops":487,"../lib":515,"../plots/cartesian/axes":566,"../registry":647,"./helpers":1130}],1129:[function(t,P,R){var h=t("../lib"),u=t("../plot_api/plot_schema"),A=t("../plots/plots"),T=t("./helpers").pointsAccessorFunction;R.moduleType="transform",R.name="groupby",R.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},R.supplyDefaults=function(i,n,a){var r,f={};function o(x,l){return h.coerce(i,f,R.attributes,x,l)}var s=o("enabled");if(!s)return f;o("groups"),o("nameformat",a._dataLength>1?"%{group} (%{trace})":"%{group}");var m=i.styles,g=f.styles=[];if(m)for(r=0;r<m.length;r++){var p=g[r]={};h.coerce(m[r],g[r],R.attributes.styles,"target");var v=h.coerce(m[r],g[r],R.attributes.styles,"value");h.isPlainObject(v)?p.value=h.extendDeep({},v):v&&delete p.value}return f},R.transform=function(i,n){var a,r,f,o=[];for(r=0;r<i.length;r++)for(a=e(i[r],n),f=0;f<a.length;f++)o.push(a[f]);return o};function e(i,n){var a,r,f,o,s,m,g,p,v,x,l=n.transform,b=n.transformIndex,c=i.transforms[b].groups,M=T(i.transforms,l);if(!h.isArrayOrTypedArray(c)||c.length===0)return[i];var _=h.filterUnique(c),y=new Array(_.length),w=c.length,d=u.findArrayAttributes(i),C=l.styles||[],S={};for(a=0;a<C.length;a++)S[C[a].target]=C[a].value;l.styles&&(x=h.keyedContainer(l,"styles","target","value.name"));var E={},k={};for(a=0;a<_.length;a++){m=_[a],E[m]=a,k[m]=0,g=y[a]=h.extendDeepNoArrays({},i),g._group=m,g.transforms[b]._indexToPoints={};var B=null;for(x&&(B=x.get(m)),B||B===""?g.name=B:g.name=h.templateString(l.nameformat,{trace:i.name,group:m}),p=g.transforms,g.transforms=[],r=0;r<p.length;r++)g.transforms[r]=h.extendDeepNoArrays({},p[r]);for(r=0;r<d.length;r++)h.nestedProperty(g,d[r]).set([])}for(f=0;f<d.length;f++){for(o=d[f],r=0,v=[];r<_.length;r++)v[r]=h.nestedProperty(y[r],o).get();for(s=h.nestedProperty(i,o).get(),r=0;r<w;r++)v[E[c[r]]].push(s[r])}for(r=0;r<w;r++){g=y[E[c[r]]];var z=g.transforms[b]._indexToPoints;z[k[c[r]]]=M(r),k[c[r]]++}for(a=0;a<_.length;a++)m=_[a],g=y[a],A.clearExpandedTraceDefaultColors(g),g=h.extendDeepNoArrays(g,S[m]||{});return y}},{"../lib":515,"../plot_api/plot_schema":554,"../plots/plots":628,"./helpers":1130}],1130:[function(t,P,R){R.pointsAccessorFunction=function(h,u){for(var A,T,e=0;e<h.length&&(A=h[e],A!==u);e++)!A._indexToPoints||A.enabled===!1||(T=A._indexToPoints);var i=T?function(n){return T[n]}:function(n){return[n]};return i}},{}],1131:[function(t,P,R){var h=t("../lib"),u=t("../plots/cartesian/axes"),A=t("./helpers").pointsAccessorFunction,T=t("../constants/numerical").BADNUM;R.moduleType="transform",R.name="sort",R.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},R.supplyDefaults=function(n){var a={};function r(o,s){return h.coerce(n,a,R.attributes,o,s)}var f=r("enabled");return f&&(r("target"),r("order")),a},R.calcTransform=function(n,a,r){if(!!r.enabled){var f=h.getTargetArray(a,r);if(!!f){var o=r.target,s=f.length;a._length&&(s=Math.min(s,a._length));var m=a._arrayAttrs,g=u.getDataToCoordFunc(n,a,o,f),p=e(r,f,g,s),v=A(a.transforms,r),x={},l,b;for(l=0;l<m.length;l++){var c=h.nestedProperty(a,m[l]),M=c.get(),_=new Array(s);for(b=0;b<s;b++)_[b]=M[p[b]];c.set(_)}for(b=0;b<s;b++)x[b]=v(p[b]);r._indexToPoints=x,a._length=s}}};function e(n,a,r,f){var o=new Array(f),s=new Array(f),m;for(m=0;m<f;m++)o[m]={v:a[m],i:m};for(o.sort(i(n,r)),m=0;m<f;m++)s[m]=o[m].i;return s}function i(n,a){switch(n.order){case"ascending":return function(r,f){var o=a(r.v),s=a(f.v);return o===T?1:s===T?-1:o-s};case"descending":return function(r,f){var o=a(r.v),s=a(f.v);return o===T?1:s===T?-1:s-o}}}},{"../constants/numerical":491,"../lib":515,"../plots/cartesian/axes":566,"./helpers":1130}],1132:[function(t,P,R){R.version="2.16.3"},{}],1133:[function(t,P,R){(function(h){(function(){(function(u){if(typeof R=="object"&&typeof P<"u")P.exports=u();else{var A;typeof window<"u"?A=window:typeof h<"u"?A=h:typeof self<"u"?A=self:A=this,A.stackgl=u()}})(function(){return function(){function u(A,T,e){function i(r,f){if(!T[r]){if(!A[r]){var o=typeof t=="function"&&t;if(!f&&o)return o(r,!0);if(n)return n(r,!0);var s=new Error("Cannot find module '"+r+"'");throw s.code="MODULE_NOT_FOUND",s}var m=T[r]={exports:{}};A[r][0].call(m.exports,function(g){var p=A[r][1][g];return i(p||g)},m,m.exports,u,A,T,e)}return T[r].exports}for(var n=typeof t=="function"&&t,a=0;a<e.length;a++)i(e[a]);return i}return u}()({1:[function(u,A,T){T.byteLength=s,T.toByteArray=g,T.fromByteArray=x;for(var e=[],i=[],n=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,f=a.length;r<f;++r)e[r]=a[r],i[a.charCodeAt(r)]=r;i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63;function o(l){var b=l.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=l.indexOf("=");c===-1&&(c=b);var M=c===b?0:4-c%4;return[c,M]}function s(l){var b=o(l),c=b[0],M=b[1];return(c+M)*3/4-M}function m(l,b,c){return(b+c)*3/4-c}function g(l){var b,c=o(l),M=c[0],_=c[1],y=new n(m(l,M,_)),w=0,d=_>0?M-4:M,C;for(C=0;C<d;C+=4)b=i[l.charCodeAt(C)]<<18|i[l.charCodeAt(C+1)]<<12|i[l.charCodeAt(C+2)]<<6|i[l.charCodeAt(C+3)],y[w++]=b>>16&255,y[w++]=b>>8&255,y[w++]=b&255;return _===2&&(b=i[l.charCodeAt(C)]<<2|i[l.charCodeAt(C+1)]>>4,y[w++]=b&255),_===1&&(b=i[l.charCodeAt(C)]<<10|i[l.charCodeAt(C+1)]<<4|i[l.charCodeAt(C+2)]>>2,y[w++]=b>>8&255,y[w++]=b&255),y}function p(l){return e[l>>18&63]+e[l>>12&63]+e[l>>6&63]+e[l&63]}function v(l,b,c){for(var M,_=[],y=b;y<c;y+=3)M=(l[y]<<16&16711680)+(l[y+1]<<8&65280)+(l[y+2]&255),_.push(p(M));return _.join("")}function x(l){for(var b,c=l.length,M=c%3,_=[],y=16383,w=0,d=c-M;w<d;w+=y)_.push(v(l,w,w+y>d?d:w+y));return M===1?(b=l[c-1],_.push(e[b>>2]+e[b<<4&63]+"==")):M===2&&(b=(l[c-2]<<8)+l[c-1],_.push(e[b>>10]+e[b>>4&63]+e[b<<2&63]+"=")),_.join("")}},{}],2:[function(u,A,T){},{}],3:[function(u,A,T){(function(e){(function(){var i=u("base64-js"),n=u("ieee754");T.Buffer=o,T.SlowBuffer=M,T.INSPECT_MAX_BYTES=50;var a=2147483647;T.kMaxLength=a,o.TYPED_ARRAY_SUPPORT=r(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function r(){try{var oe=new Uint8Array(1);return oe.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},oe.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(!!o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(!!o.isBuffer(this))return this.byteOffset}});function f(oe){if(oe>a)throw new RangeError('The value "'+oe+'" is invalid for option "size"');var he=new Uint8Array(oe);return he.__proto__=o.prototype,he}function o(oe,he,be){if(typeof oe=="number"){if(typeof he=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(oe)}return s(oe,he,be)}typeof Symbol<"u"&&Symbol.species!=null&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192;function s(oe,he,be){if(typeof oe=="string")return v(oe,he);if(ArrayBuffer.isView(oe))return x(oe);if(oe==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof oe);if(se(oe,ArrayBuffer)||oe&&se(oe.buffer,ArrayBuffer))return l(oe,he,be);if(typeof oe=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var me=oe.valueOf&&oe.valueOf();if(me!=null&&me!==oe)return o.from(me,he,be);var _e=b(oe);if(_e)return _e;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof oe[Symbol.toPrimitive]=="function")return o.from(oe[Symbol.toPrimitive]("string"),he,be);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof oe)}o.from=function(oe,he,be){return s(oe,he,be)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array;function m(oe){if(typeof oe!="number")throw new TypeError('"size" argument must be of type number');if(oe<0)throw new RangeError('The value "'+oe+'" is invalid for option "size"')}function g(oe,he,be){return m(oe),oe<=0?f(oe):he!==void 0?typeof be=="string"?f(oe).fill(he,be):f(oe).fill(he):f(oe)}o.alloc=function(oe,he,be){return g(oe,he,be)};function p(oe){return m(oe),f(oe<0?0:c(oe)|0)}o.allocUnsafe=function(oe){return p(oe)},o.allocUnsafeSlow=function(oe){return p(oe)};function v(oe,he){if((typeof he!="string"||he==="")&&(he="utf8"),!o.isEncoding(he))throw new TypeError("Unknown encoding: "+he);var be=_(oe,he)|0,me=f(be),_e=me.write(oe,he);return _e!==be&&(me=me.slice(0,_e)),me}function x(oe){for(var he=oe.length<0?0:c(oe.length)|0,be=f(he),me=0;me<he;me+=1)be[me]=oe[me]&255;return be}function l(oe,he,be){if(he<0||oe.byteLength<he)throw new RangeError('"offset" is outside of buffer bounds');if(oe.byteLength<he+(be||0))throw new RangeError('"length" is outside of buffer bounds');var me;return he===void 0&&be===void 0?me=new Uint8Array(oe):be===void 0?me=new Uint8Array(oe,he):me=new Uint8Array(oe,he,be),me.__proto__=o.prototype,me}function b(oe){if(o.isBuffer(oe)){var he=c(oe.length)|0,be=f(he);return be.length===0||oe.copy(be,0,0,he),be}if(oe.length!==void 0)return typeof oe.length!="number"||xe(oe.length)?f(0):x(oe);if(oe.type==="Buffer"&&Array.isArray(oe.data))return x(oe.data)}function c(oe){if(oe>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return oe|0}function M(oe){return+oe!=oe&&(oe=0),o.alloc(+oe)}o.isBuffer=function(he){return he!=null&&he._isBuffer===!0&&he!==o.prototype},o.compare=function(he,be){if(se(he,Uint8Array)&&(he=o.from(he,he.offset,he.byteLength)),se(be,Uint8Array)&&(be=o.from(be,be.offset,be.byteLength)),!o.isBuffer(he)||!o.isBuffer(be))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(he===be)return 0;for(var me=he.length,_e=be.length,Se=0,De=Math.min(me,_e);Se<De;++Se)if(he[Se]!==be[Se]){me=he[Se],_e=be[Se];break}return me<_e?-1:_e<me?1:0},o.isEncoding=function(he){switch(String(he).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(he,be){if(!Array.isArray(he))throw new TypeError('"list" argument must be an Array of Buffers');if(he.length===0)return o.alloc(0);var me;if(be===void 0)for(be=0,me=0;me<he.length;++me)be+=he[me].length;var _e=o.allocUnsafe(be),Se=0;for(me=0;me<he.length;++me){var De=he[me];if(se(De,Uint8Array)&&(De=o.from(De)),!o.isBuffer(De))throw new TypeError('"list" argument must be an Array of Buffers');De.copy(_e,Se),Se+=De.length}return _e};function _(oe,he){if(o.isBuffer(oe))return oe.length;if(ArrayBuffer.isView(oe)||se(oe,ArrayBuffer))return oe.byteLength;if(typeof oe!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof oe);var be=oe.length,me=arguments.length>2&&arguments[2]===!0;if(!me&&be===0)return 0;for(var _e=!1;;)switch(he){case"ascii":case"latin1":case"binary":return be;case"utf8":case"utf-8":return J(oe).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return be*2;case"hex":return be>>>1;case"base64":return le(oe).length;default:if(_e)return me?-1:J(oe).length;he=(""+he).toLowerCase(),_e=!0}}o.byteLength=_;function y(oe,he,be){var me=!1;if((he===void 0||he<0)&&(he=0),he>this.length||((be===void 0||be>this.length)&&(be=this.length),be<=0)||(be>>>=0,he>>>=0,be<=he))return"";for(oe||(oe="utf8");;)switch(oe){case"hex":return Z(this,he,be);case"utf8":case"utf-8":return O(this,he,be);case"ascii":return H(this,he,be);case"latin1":case"binary":return j(this,he,be);case"base64":return I(this,he,be);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,he,be);default:if(me)throw new TypeError("Unknown encoding: "+oe);oe=(oe+"").toLowerCase(),me=!0}}o.prototype._isBuffer=!0;function w(oe,he,be){var me=oe[he];oe[he]=oe[be],oe[be]=me}o.prototype.swap16=function(){var he=this.length;if(he%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var be=0;be<he;be+=2)w(this,be,be+1);return this},o.prototype.swap32=function(){var he=this.length;if(he%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var be=0;be<he;be+=4)w(this,be,be+3),w(this,be+1,be+2);return this},o.prototype.swap64=function(){var he=this.length;if(he%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var be=0;be<he;be+=8)w(this,be,be+7),w(this,be+1,be+6),w(this,be+2,be+5),w(this,be+3,be+4);return this},o.prototype.toString=function(){var he=this.length;return he===0?"":arguments.length===0?O(this,0,he):y.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(he){if(!o.isBuffer(he))throw new TypeError("Argument must be a Buffer");return this===he?!0:o.compare(this,he)===0},o.prototype.inspect=function(){var he="",be=T.INSPECT_MAX_BYTES;return he=this.toString("hex",0,be).replace(/(.{2})/g,"$1 ").trim(),this.length>be&&(he+=" ... "),"<Buffer "+he+">"},o.prototype.compare=function(he,be,me,_e,Se){if(se(he,Uint8Array)&&(he=o.from(he,he.offset,he.byteLength)),!o.isBuffer(he))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof he);if(be===void 0&&(be=0),me===void 0&&(me=he?he.length:0),_e===void 0&&(_e=0),Se===void 0&&(Se=this.length),be<0||me>he.length||_e<0||Se>this.length)throw new RangeError("out of range index");if(_e>=Se&&be>=me)return 0;if(_e>=Se)return-1;if(be>=me)return 1;if(be>>>=0,me>>>=0,_e>>>=0,Se>>>=0,this===he)return 0;for(var De=Se-_e,Ie=me-be,Te=Math.min(De,Ie),Ce=this.slice(_e,Se),He=he.slice(be,me),Xe=0;Xe<Te;++Xe)if(Ce[Xe]!==He[Xe]){De=Ce[Xe],Ie=He[Xe];break}return De<Ie?-1:Ie<De?1:0};function d(oe,he,be,me,_e){if(oe.length===0)return-1;if(typeof be=="string"?(me=be,be=0):be>2147483647?be=2147483647:be<-2147483648&&(be=-2147483648),be=+be,xe(be)&&(be=_e?0:oe.length-1),be<0&&(be=oe.length+be),be>=oe.length){if(_e)return-1;be=oe.length-1}else if(be<0)if(_e)be=0;else return-1;if(typeof he=="string"&&(he=o.from(he,me)),o.isBuffer(he))return he.length===0?-1:C(oe,he,be,me,_e);if(typeof he=="number")return he=he&255,typeof Uint8Array.prototype.indexOf=="function"?_e?Uint8Array.prototype.indexOf.call(oe,he,be):Uint8Array.prototype.lastIndexOf.call(oe,he,be):C(oe,[he],be,me,_e);throw new TypeError("val must be string, number or Buffer")}function C(oe,he,be,me,_e){var Se=1,De=oe.length,Ie=he.length;if(me!==void 0&&(me=String(me).toLowerCase(),me==="ucs2"||me==="ucs-2"||me==="utf16le"||me==="utf-16le")){if(oe.length<2||he.length<2)return-1;Se=2,De/=2,Ie/=2,be/=2}function Te(Re,We){return Se===1?Re[We]:Re.readUInt16BE(We*Se)}var Ce;if(_e){var He=-1;for(Ce=be;Ce<De;Ce++)if(Te(oe,Ce)===Te(he,He===-1?0:Ce-He)){if(He===-1&&(He=Ce),Ce-He+1===Ie)return He*Se}else He!==-1&&(Ce-=Ce-He),He=-1}else for(be+Ie>De&&(be=De-Ie),Ce=be;Ce>=0;Ce--){for(var Xe=!0,Be=0;Be<Ie;Be++)if(Te(oe,Ce+Be)!==Te(he,Be)){Xe=!1;break}if(Xe)return Ce}return-1}o.prototype.includes=function(he,be,me){return this.indexOf(he,be,me)!==-1},o.prototype.indexOf=function(he,be,me){return d(this,he,be,me,!0)},o.prototype.lastIndexOf=function(he,be,me){return d(this,he,be,me,!1)};function S(oe,he,be,me){be=Number(be)||0;var _e=oe.length-be;me?(me=Number(me),me>_e&&(me=_e)):me=_e;var Se=he.length;me>Se/2&&(me=Se/2);for(var De=0;De<me;++De){var Ie=parseInt(he.substr(De*2,2),16);if(xe(Ie))return De;oe[be+De]=Ie}return De}function E(oe,he,be,me){return ie(J(he,oe.length-be),oe,be,me)}function k(oe,he,be,me){return ie(q(he),oe,be,me)}function B(oe,he,be,me){return k(oe,he,be,me)}function z(oe,he,be,me){return ie(le(he),oe,be,me)}function F(oe,he,be,me){return ie(ae(he,oe.length-be),oe,be,me)}o.prototype.write=function(he,be,me,_e){if(be===void 0)_e="utf8",me=this.length,be=0;else if(me===void 0&&typeof be=="string")_e=be,me=this.length,be=0;else if(isFinite(be))be=be>>>0,isFinite(me)?(me=me>>>0,_e===void 0&&(_e="utf8")):(_e=me,me=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Se=this.length-be;if((me===void 0||me>Se)&&(me=Se),he.length>0&&(me<0||be<0)||be>this.length)throw new RangeError("Attempt to write outside buffer bounds");_e||(_e="utf8");for(var De=!1;;)switch(_e){case"hex":return S(this,he,be,me);case"utf8":case"utf-8":return E(this,he,be,me);case"ascii":return k(this,he,be,me);case"latin1":case"binary":return B(this,he,be,me);case"base64":return z(this,he,be,me);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,he,be,me);default:if(De)throw new TypeError("Unknown encoding: "+_e);_e=(""+_e).toLowerCase(),De=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(oe,he,be){return he===0&&be===oe.length?i.fromByteArray(oe):i.fromByteArray(oe.slice(he,be))}function O(oe,he,be){be=Math.min(oe.length,be);for(var me=[],_e=he;_e<be;){var Se=oe[_e],De=null,Ie=Se>239?4:Se>223?3:Se>191?2:1;if(_e+Ie<=be){var Te,Ce,He,Xe;switch(Ie){case 1:Se<128&&(De=Se);break;case 2:Te=oe[_e+1],(Te&192)===128&&(Xe=(Se&31)<<6|Te&63,Xe>127&&(De=Xe));break;case 3:Te=oe[_e+1],Ce=oe[_e+2],(Te&192)===128&&(Ce&192)===128&&(Xe=(Se&15)<<12|(Te&63)<<6|Ce&63,Xe>2047&&(Xe<55296||Xe>57343)&&(De=Xe));break;case 4:Te=oe[_e+1],Ce=oe[_e+2],He=oe[_e+3],(Te&192)===128&&(Ce&192)===128&&(He&192)===128&&(Xe=(Se&15)<<18|(Te&63)<<12|(Ce&63)<<6|He&63,Xe>65535&&Xe<1114112&&(De=Xe))}}De===null?(De=65533,Ie=1):De>65535&&(De-=65536,me.push(De>>>10&1023|55296),De=56320|De&1023),me.push(De),_e+=Ie}return V(me)}var N=4096;function V(oe){var he=oe.length;if(he<=N)return String.fromCharCode.apply(String,oe);for(var be="",me=0;me<he;)be+=String.fromCharCode.apply(String,oe.slice(me,me+=N));return be}function H(oe,he,be){var me="";be=Math.min(oe.length,be);for(var _e=he;_e<be;++_e)me+=String.fromCharCode(oe[_e]&127);return me}function j(oe,he,be){var me="";be=Math.min(oe.length,be);for(var _e=he;_e<be;++_e)me+=String.fromCharCode(oe[_e]);return me}function Z(oe,he,be){var me=oe.length;(!he||he<0)&&(he=0),(!be||be<0||be>me)&&(be=me);for(var _e="",Se=he;Se<be;++Se)_e+=ne(oe[Se]);return _e}function X(oe,he,be){for(var me=oe.slice(he,be),_e="",Se=0;Se<me.length;Se+=2)_e+=String.fromCharCode(me[Se]+me[Se+1]*256);return _e}o.prototype.slice=function(he,be){var me=this.length;he=~~he,be=be===void 0?me:~~be,he<0?(he+=me,he<0&&(he=0)):he>me&&(he=me),be<0?(be+=me,be<0&&(be=0)):be>me&&(be=me),be<he&&(be=he);var _e=this.subarray(he,be);return _e.__proto__=o.prototype,_e};function re(oe,he,be){if(oe%1!==0||oe<0)throw new RangeError("offset is not uint");if(oe+he>be)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUIntLE=function(he,be,me){he=he>>>0,be=be>>>0,me||re(he,be,this.length);for(var _e=this[he],Se=1,De=0;++De<be&&(Se*=256);)_e+=this[he+De]*Se;return _e},o.prototype.readUIntBE=function(he,be,me){he=he>>>0,be=be>>>0,me||re(he,be,this.length);for(var _e=this[he+--be],Se=1;be>0&&(Se*=256);)_e+=this[he+--be]*Se;return _e},o.prototype.readUInt8=function(he,be){return he=he>>>0,be||re(he,1,this.length),this[he]},o.prototype.readUInt16LE=function(he,be){return he=he>>>0,be||re(he,2,this.length),this[he]|this[he+1]<<8},o.prototype.readUInt16BE=function(he,be){return he=he>>>0,be||re(he,2,this.length),this[he]<<8|this[he+1]},o.prototype.readUInt32LE=function(he,be){return he=he>>>0,be||re(he,4,this.length),(this[he]|this[he+1]<<8|this[he+2]<<16)+this[he+3]*16777216},o.prototype.readUInt32BE=function(he,be){return he=he>>>0,be||re(he,4,this.length),this[he]*16777216+(this[he+1]<<16|this[he+2]<<8|this[he+3])},o.prototype.readIntLE=function(he,be,me){he=he>>>0,be=be>>>0,me||re(he,be,this.length);for(var _e=this[he],Se=1,De=0;++De<be&&(Se*=256);)_e+=this[he+De]*Se;return Se*=128,_e>=Se&&(_e-=Math.pow(2,8*be)),_e},o.prototype.readIntBE=function(he,be,me){he=he>>>0,be=be>>>0,me||re(he,be,this.length);for(var _e=be,Se=1,De=this[he+--_e];_e>0&&(Se*=256);)De+=this[he+--_e]*Se;return Se*=128,De>=Se&&(De-=Math.pow(2,8*be)),De},o.prototype.readInt8=function(he,be){return he=he>>>0,be||re(he,1,this.length),this[he]&128?(255-this[he]+1)*-1:this[he]},o.prototype.readInt16LE=function(he,be){he=he>>>0,be||re(he,2,this.length);var me=this[he]|this[he+1]<<8;return me&32768?me|4294901760:me},o.prototype.readInt16BE=function(he,be){he=he>>>0,be||re(he,2,this.length);var me=this[he+1]|this[he]<<8;return me&32768?me|4294901760:me},o.prototype.readInt32LE=function(he,be){return he=he>>>0,be||re(he,4,this.length),this[he]|this[he+1]<<8|this[he+2]<<16|this[he+3]<<24},o.prototype.readInt32BE=function(he,be){return he=he>>>0,be||re(he,4,this.length),this[he]<<24|this[he+1]<<16|this[he+2]<<8|this[he+3]},o.prototype.readFloatLE=function(he,be){return he=he>>>0,be||re(he,4,this.length),n.read(this,he,!0,23,4)},o.prototype.readFloatBE=function(he,be){return he=he>>>0,be||re(he,4,this.length),n.read(this,he,!1,23,4)},o.prototype.readDoubleLE=function(he,be){return he=he>>>0,be||re(he,8,this.length),n.read(this,he,!0,52,8)},o.prototype.readDoubleBE=function(he,be){return he=he>>>0,be||re(he,8,this.length),n.read(this,he,!1,52,8)};function ue(oe,he,be,me,_e,Se){if(!o.isBuffer(oe))throw new TypeError('"buffer" argument must be a Buffer instance');if(he>_e||he<Se)throw new RangeError('"value" argument is out of bounds');if(be+me>oe.length)throw new RangeError("Index out of range")}o.prototype.writeUIntLE=function(he,be,me,_e){if(he=+he,be=be>>>0,me=me>>>0,!_e){var Se=Math.pow(2,8*me)-1;ue(this,he,be,me,Se,0)}var De=1,Ie=0;for(this[be]=he&255;++Ie<me&&(De*=256);)this[be+Ie]=he/De&255;return be+me},o.prototype.writeUIntBE=function(he,be,me,_e){if(he=+he,be=be>>>0,me=me>>>0,!_e){var Se=Math.pow(2,8*me)-1;ue(this,he,be,me,Se,0)}var De=me-1,Ie=1;for(this[be+De]=he&255;--De>=0&&(Ie*=256);)this[be+De]=he/Ie&255;return be+me},o.prototype.writeUInt8=function(he,be,me){return he=+he,be=be>>>0,me||ue(this,he,be,1,255,0),this[be]=he&255,be+1},o.prototype.writeUInt16LE=function(he,be,me){return he=+he,be=be>>>0,me||ue(this,he,be,2,65535,0),this[be]=he&255,this[be+1]=he>>>8,be+2},o.prototype.writeUInt16BE=function(he,be,me){return he=+he,be=be>>>0,me||ue(this,he,be,2,65535,0),this[be]=he>>>8,this[be+1]=he&255,be+2},o.prototype.writeUInt32LE=function(he,be,me){return he=+he,be=be>>>0,me||ue(this,he,be,4,4294967295,0),this[be+3]=he>>>24,this[be+2]=he>>>16,this[be+1]=he>>>8,this[be]=he&255,be+4},o.prototype.writeUInt32BE=function(he,be,me){return he=+he,be=be>>>0,me||ue(this,he,be,4,4294967295,0),this[be]=he>>>24,this[be+1]=he>>>16,this[be+2]=he>>>8,this[be+3]=he&255,be+4},o.prototype.writeIntLE=function(he,be,me,_e){if(he=+he,be=be>>>0,!_e){var Se=Math.pow(2,8*me-1);ue(this,he,be,me,Se-1,-Se)}var De=0,Ie=1,Te=0;for(this[be]=he&255;++De<me&&(Ie*=256);)he<0&&Te===0&&this[be+De-1]!==0&&(Te=1),this[be+De]=(he/Ie>>0)-Te&255;return be+me},o.prototype.writeIntBE=function(he,be,me,_e){if(he=+he,be=be>>>0,!_e){var Se=Math.pow(2,8*me-1);ue(this,he,be,me,Se-1,-Se)}var De=me-1,Ie=1,Te=0;for(this[be+De]=he&255;--De>=0&&(Ie*=256);)he<0&&Te===0&&this[be+De+1]!==0&&(Te=1),this[be+De]=(he/Ie>>0)-Te&255;return be+me},o.prototype.writeInt8=function(he,be,me){return he=+he,be=be>>>0,me||ue(this,he,be,1,127,-128),he<0&&(he=255+he+1),this[be]=he&255,be+1},o.prototype.writeInt16LE=function(he,be,me){return he=+he,be=be>>>0,me||ue(this,he,be,2,32767,-32768),this[be]=he&255,this[be+1]=he>>>8,be+2},o.prototype.writeInt16BE=function(he,be,me){return he=+he,be=be>>>0,me||ue(this,he,be,2,32767,-32768),this[be]=he>>>8,this[be+1]=he&255,be+2},o.prototype.writeInt32LE=function(he,be,me){return he=+he,be=be>>>0,me||ue(this,he,be,4,2147483647,-2147483648),this[be]=he&255,this[be+1]=he>>>8,this[be+2]=he>>>16,this[be+3]=he>>>24,be+4},o.prototype.writeInt32BE=function(he,be,me){return he=+he,be=be>>>0,me||ue(this,he,be,4,2147483647,-2147483648),he<0&&(he=4294967295+he+1),this[be]=he>>>24,this[be+1]=he>>>16,this[be+2]=he>>>8,this[be+3]=he&255,be+4};function K(oe,he,be,me,_e,Se){if(be+me>oe.length)throw new RangeError("Index out of range");if(be<0)throw new RangeError("Index out of range")}function te(oe,he,be,me,_e){return he=+he,be=be>>>0,_e||K(oe,he,be,4),n.write(oe,he,be,me,23,4),be+4}o.prototype.writeFloatLE=function(he,be,me){return te(this,he,be,!0,me)},o.prototype.writeFloatBE=function(he,be,me){return te(this,he,be,!1,me)};function G(oe,he,be,me,_e){return he=+he,be=be>>>0,_e||K(oe,he,be,8),n.write(oe,he,be,me,52,8),be+8}o.prototype.writeDoubleLE=function(he,be,me){return G(this,he,be,!0,me)},o.prototype.writeDoubleBE=function(he,be,me){return G(this,he,be,!1,me)},o.prototype.copy=function(he,be,me,_e){if(!o.isBuffer(he))throw new TypeError("argument should be a Buffer");if(me||(me=0),!_e&&_e!==0&&(_e=this.length),be>=he.length&&(be=he.length),be||(be=0),_e>0&&_e<me&&(_e=me),_e===me||he.length===0||this.length===0)return 0;if(be<0)throw new RangeError("targetStart out of bounds");if(me<0||me>=this.length)throw new RangeError("Index out of range");if(_e<0)throw new RangeError("sourceEnd out of bounds");_e>this.length&&(_e=this.length),he.length-be<_e-me&&(_e=he.length-be+me);var Se=_e-me;if(this===he&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(be,me,_e);else if(this===he&&me<be&&be<_e)for(var De=Se-1;De>=0;--De)he[De+be]=this[De+me];else Uint8Array.prototype.set.call(he,this.subarray(me,_e),be);return Se},o.prototype.fill=function(he,be,me,_e){if(typeof he=="string"){if(typeof be=="string"?(_e=be,be=0,me=this.length):typeof me=="string"&&(_e=me,me=this.length),_e!==void 0&&typeof _e!="string")throw new TypeError("encoding must be a string");if(typeof _e=="string"&&!o.isEncoding(_e))throw new TypeError("Unknown encoding: "+_e);if(he.length===1){var Se=he.charCodeAt(0);(_e==="utf8"&&Se<128||_e==="latin1")&&(he=Se)}}else typeof he=="number"&&(he=he&255);if(be<0||this.length<be||this.length<me)throw new RangeError("Out of range index");if(me<=be)return this;be=be>>>0,me=me===void 0?this.length:me>>>0,he||(he=0);var De;if(typeof he=="number")for(De=be;De<me;++De)this[De]=he;else{var Ie=o.isBuffer(he)?he:o.from(he,_e),Te=Ie.length;if(Te===0)throw new TypeError('The value "'+he+'" is invalid for argument "value"');for(De=0;De<me-be;++De)this[De+be]=Ie[De%Te]}return this};var Y=/[^+/0-9A-Za-z-_]/g;function ee(oe){if(oe=oe.split("=")[0],oe=oe.trim().replace(Y,""),oe.length<2)return"";for(;oe.length%4!==0;)oe=oe+"=";return oe}function ne(oe){return oe<16?"0"+oe.toString(16):oe.toString(16)}function J(oe,he){he=he||1/0;for(var be,me=oe.length,_e=null,Se=[],De=0;De<me;++De){if(be=oe.charCodeAt(De),be>55295&&be<57344){if(!_e){if(be>56319){(he-=3)>-1&&Se.push(239,191,189);continue}else if(De+1===me){(he-=3)>-1&&Se.push(239,191,189);continue}_e=be;continue}if(be<56320){(he-=3)>-1&&Se.push(239,191,189),_e=be;continue}be=(_e-55296<<10|be-56320)+65536}else _e&&(he-=3)>-1&&Se.push(239,191,189);if(_e=null,be<128){if((he-=1)<0)break;Se.push(be)}else if(be<2048){if((he-=2)<0)break;Se.push(be>>6|192,be&63|128)}else if(be<65536){if((he-=3)<0)break;Se.push(be>>12|224,be>>6&63|128,be&63|128)}else if(be<1114112){if((he-=4)<0)break;Se.push(be>>18|240,be>>12&63|128,be>>6&63|128,be&63|128)}else throw new Error("Invalid code point")}return Se}function q(oe){for(var he=[],be=0;be<oe.length;++be)he.push(oe.charCodeAt(be)&255);return he}function ae(oe,he){for(var be,me,_e,Se=[],De=0;De<oe.length&&!((he-=2)<0);++De)be=oe.charCodeAt(De),me=be>>8,_e=be%256,Se.push(_e),Se.push(me);return Se}function le(oe){return i.toByteArray(ee(oe))}function ie(oe,he,be,me){for(var _e=0;_e<me&&!(_e+be>=he.length||_e>=oe.length);++_e)he[_e+be]=oe[_e];return _e}function se(oe,he){return oe instanceof he||oe!=null&&oe.constructor!=null&&oe.constructor.name!=null&&oe.constructor.name===he.name}function xe(oe){return oe!==oe}}).call(this)}).call(this,u("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(u,A,T){T.read=function(e,i,n,a,r){var f,o,s=r*8-a-1,m=(1<<s)-1,g=m>>1,p=-7,v=n?r-1:0,x=n?-1:1,l=e[i+v];for(v+=x,f=l&(1<<-p)-1,l>>=-p,p+=s;p>0;f=f*256+e[i+v],v+=x,p-=8);for(o=f&(1<<-p)-1,f>>=-p,p+=a;p>0;o=o*256+e[i+v],v+=x,p-=8);if(f===0)f=1-g;else{if(f===m)return o?NaN:(l?-1:1)*(1/0);o=o+Math.pow(2,a),f=f-g}return(l?-1:1)*o*Math.pow(2,f-a)},T.write=function(e,i,n,a,r,f){var o,s,m,g=f*8-r-1,p=(1<<g)-1,v=p>>1,x=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,l=a?0:f-1,b=a?1:-1,c=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(s=isNaN(i)?1:0,o=p):(o=Math.floor(Math.log(i)/Math.LN2),i*(m=Math.pow(2,-o))<1&&(o--,m*=2),o+v>=1?i+=x/m:i+=x*Math.pow(2,1-v),i*m>=2&&(o++,m/=2),o+v>=p?(s=0,o=p):o+v>=1?(s=(i*m-1)*Math.pow(2,r),o=o+v):(s=i*Math.pow(2,v-1)*Math.pow(2,r),o=0));r>=8;e[n+l]=s&255,l+=b,s/=256,r-=8);for(o=o<<r|s,g+=r;g>0;e[n+l]=o&255,l+=b,o/=256,g-=8);e[n+l-b]|=c*128}},{}],5:[function(u,A,T){var e=A.exports={},i,n;function a(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?i=setTimeout:i=a}catch{i=a}try{typeof clearTimeout=="function"?n=clearTimeout:n=r}catch{n=r}})();function f(c){if(i===setTimeout)return setTimeout(c,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(c,0);try{return i(c,0)}catch{try{return i.call(null,c,0)}catch{return i.call(this,c,0)}}}function o(c){if(n===clearTimeout)return clearTimeout(c);if((n===r||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(c);try{return n(c)}catch{try{return n.call(null,c)}catch{return n.call(this,c)}}}var s=[],m=!1,g,p=-1;function v(){!m||!g||(m=!1,g.length?s=g.concat(s):p=-1,s.length&&x())}function x(){if(!m){var c=f(v);m=!0;for(var M=s.length;M;){for(g=s,s=[];++p<M;)g&&g[p].run();p=-1,M=s.length}g=null,m=!1,o(c)}}e.nextTick=function(c){var M=new Array(arguments.length-1);if(arguments.length>1)for(var _=1;_<arguments.length;_++)M[_-1]=arguments[_];s.push(new l(c,M)),s.length===1&&!m&&f(x)};function l(c,M){this.fun=c,this.array=M}l.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={};function b(){}e.on=b,e.addListener=b,e.once=b,e.off=b,e.removeListener=b,e.removeAllListeners=b,e.emit=b,e.prependListener=b,e.prependOnceListener=b,e.listeners=function(c){return[]},e.binding=function(c){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(c){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],6:[function(u,A,T){A.exports={alpha_shape:u("alpha-shape"),convex_hull:u("convex-hull"),delaunay_triangulate:u("delaunay-triangulate"),gl_cone3d:u("gl-cone3d"),gl_error3d:u("gl-error3d"),gl_heatmap2d:u("gl-heatmap2d"),gl_line3d:u("gl-line3d"),gl_mesh3d:u("gl-mesh3d"),gl_plot2d:u("gl-plot2d"),gl_plot3d:u("gl-plot3d"),gl_pointcloud2d:u("gl-pointcloud2d"),gl_scatter3d:u("gl-scatter3d"),gl_select_box:u("gl-select-box"),gl_spikes2d:u("gl-spikes2d"),gl_streamtube3d:u("gl-streamtube3d"),gl_surface3d:u("gl-surface3d"),ndarray:u("ndarray"),ndarray_linear_interpolate:u("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(u,A,T){A.exports=f;var e=u("turntable-camera-controller"),i=u("orbit-camera-controller"),n=u("matrix-camera-controller");function a(o,s){this._controllerNames=Object.keys(o),this._controllerList=this._controllerNames.map(function(m){return o[m]}),this._mode=s,this._active=o[s],this._active||(this._mode="turntable",this._active=o.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var r=a.prototype;r.flush=function(o){for(var s=this._controllerList,m=0;m<s.length;++m)s[m].flush(o)},r.idle=function(o){for(var s=this._controllerList,m=0;m<s.length;++m)s[m].idle(o)},r.lookAt=function(o,s,m,g){for(var p=this._controllerList,v=0;v<p.length;++v)p[v].lookAt(o,s,m,g)},r.rotate=function(o,s,m,g){for(var p=this._controllerList,v=0;v<p.length;++v)p[v].rotate(o,s,m,g)},r.pan=function(o,s,m,g){for(var p=this._controllerList,v=0;v<p.length;++v)p[v].pan(o,s,m,g)},r.translate=function(o,s,m,g){for(var p=this._controllerList,v=0;v<p.length;++v)p[v].translate(o,s,m,g)},r.setMatrix=function(o,s){for(var m=this._controllerList,g=0;g<m.length;++g)m[g].setMatrix(o,s)},r.setDistanceLimits=function(o,s){for(var m=this._controllerList,g=0;g<m.length;++g)m[g].setDistanceLimits(o,s)},r.setDistance=function(o,s){for(var m=this._controllerList,g=0;g<m.length;++g)m[g].setDistance(o,s)},r.recalcMatrix=function(o){this._active.recalcMatrix(o)},r.getDistance=function(o){return this._active.getDistance(o)},r.getDistanceLimits=function(o){return this._active.getDistanceLimits(o)},r.lastT=function(){return this._active.lastT()},r.setMode=function(o){if(o!==this._mode){var s=this._controllerNames.indexOf(o);if(!(s<0)){var m=this._active,g=this._controllerList[s],p=Math.max(m.lastT(),g.lastT());m.recalcMatrix(p),g.setMatrix(p,m.computedMatrix),this._active=g,this._mode=o,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},r.getMode=function(){return this._mode};function f(o){o=o||{};var s=o.eye||[0,0,1],m=o.center||[0,0,0],g=o.up||[0,1,0],p=o.distanceLimits||[0,1/0],v=o.mode||"turntable",x=e(),l=i(),b=n();return x.setDistanceLimits(p[0],p[1]),x.lookAt(0,s,m,g),l.setDistanceLimits(p[0],p[1]),l.lookAt(0,s,m,g),b.setDistanceLimits(p[0],p[1]),b.lookAt(0,s,m,g),new a({turntable:x,orbit:l,matrix:b},v)}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(u,A,T){var e=typeof WeakMap>"u"?u("weak-map"):WeakMap,i=u("gl-buffer"),n=u("gl-vao"),a=new e;function r(f){var o=a.get(f),s=o&&(o._triangleBuffer.handle||o._triangleBuffer.buffer);if(!s||!f.isBuffer(s)){var m=i(f,new Float32Array([-1,-1,-1,4,4,-1]));o=n(f,[{buffer:m,type:f.FLOAT,size:2}]),o._triangleBuffer=m,a.set(f,o)}o.bind(),f.drawArrays(f.TRIANGLES,0,3),o.unbind()}A.exports=r},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(u,A,T){var e=u("pad-left");A.exports=i;function i(n,a,r){a=typeof a=="number"?a:1,r=r||": ";var f=n.split(/\r?\n/),o=String(f.length+a-1).length;return f.map(function(s,m){var g=m+a,p=String(g).length,v=e(g,o-p);return v+r+s}).join(`
`)}},{"pad-left":264}],10:[function(u,A,T){A.exports=n;var e=u("robust-orientation");function i(a,r){for(var f=new Array(r+1),o=0;o<a.length;++o)f[o]=a[o];for(var o=0;o<=a.length;++o){for(var s=a.length;s<=r;++s){for(var m=new Array(r),g=0;g<r;++g)m[g]=Math.pow(s+1-o,g);f[s]=m}var p=e.apply(void 0,f);if(p)return!0}return!1}function n(a){var r=a.length;if(r===0)return[];if(r===1)return[0];for(var f=a[0].length,o=[a[0]],s=[0],m=1;m<r;++m){if(o.push(a[m]),!i(o,f)){o.pop();continue}if(s.push(m),s.length===f+1)return s}return s}},{"robust-orientation":284}],11:[function(u,A,T){A.exports=n;var e=u("delaunay-triangulate"),i=u("circumradius");function n(a,r){return e(r).filter(function(f){for(var o=new Array(f.length),s=0;s<f.length;++s)o[s]=r[f[s]];return i(o)*a<1})}},{circumradius:49,"delaunay-triangulate":63}],12:[function(u,A,T){A.exports=n;var e=u("alpha-complex"),i=u("simplicial-complex-boundary");function n(a,r){return i(e(a,r))}},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(u,A,T){A.exports=function(i){return atob(i)}},{}],14:[function(u,A,T){A.exports=n;var e=u("robust-linear-solve");function i(a){for(var r=0,f=0;f<a.length;++f)r+=a[f];return r}function n(a,r){for(var f=r.length,o=new Array(f+1),s=0;s<f;++s){for(var m=new Array(f+1),g=0;g<=f;++g)m[g]=a[g][s];o[s]=m}o[f]=new Array(f+1);for(var s=0;s<=f;++s)o[f][s]=1;for(var p=new Array(f+1),s=0;s<f;++s)p[s]=r[s];p[f]=1;var v=e(o,p),x=i(v[f+1]);x===0&&(x=1);for(var l=new Array(f+1),s=0;s<=f;++s)l[s]=i(v[s])/x;return l}},{"robust-linear-solve":283}],15:[function(u,A,T){var e=u("./lib/rationalize");A.exports=i;function i(n,a){return e(n[0].mul(a[1]).add(a[0].mul(n[1])),n[1].mul(a[1]))}},{"./lib/rationalize":25}],16:[function(u,A,T){A.exports=e;function e(i,n){return i[0].mul(n[1]).cmp(n[0].mul(i[1]))}},{}],17:[function(u,A,T){var e=u("./lib/rationalize");A.exports=i;function i(n,a){return e(n[0].mul(a[1]),n[1].mul(a[0]))}},{"./lib/rationalize":25}],18:[function(u,A,T){var e=u("./is-rat"),i=u("./lib/is-bn"),n=u("./lib/num-to-bn"),a=u("./lib/str-to-bn"),r=u("./lib/rationalize"),f=u("./div");A.exports=o;function o(s,m){if(e(s))return m?f(s,o(m)):[s[0].clone(),s[1].clone()];var g=0,p,v;if(i(s))p=s.clone();else if(typeof s=="string")p=a(s);else{if(s===0)return[n(0),n(1)];if(s===Math.floor(s))p=n(s);else{for(;s!==Math.floor(s);)s=s*Math.pow(2,256),g-=256;p=n(s)}}if(e(m))p.mul(m[1]),v=m[0].clone();else if(i(m))v=m.clone();else if(typeof m=="string")v=a(m);else if(!m)v=n(1);else if(m===Math.floor(m))v=n(m);else{for(;m!==Math.floor(m);)m=m*Math.pow(2,256),g+=256;v=n(m)}return g>0?p=p.ushln(g):g<0&&(v=v.ushln(-g)),r(p,v)}},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(u,A,T){var e=u("./lib/is-bn");A.exports=i;function i(n){return Array.isArray(n)&&n.length===2&&e(n[0])&&e(n[1])}},{"./lib/is-bn":23}],20:[function(u,A,T){var e=u("bn.js");A.exports=i;function i(n){return n.cmp(new e(0))}},{"bn.js":33}],21:[function(u,A,T){var e=u("./bn-sign");A.exports=i;function i(n){var a=n.length,r=n.words,f=0;if(a===1)f=r[0];else if(a===2)f=r[0]+r[1]*67108864;else for(var o=0;o<a;o++){var s=r[o];f+=s*Math.pow(67108864,o)}return e(n)*f}},{"./bn-sign":20}],22:[function(u,A,T){var e=u("double-bits"),i=u("bit-twiddle").countTrailingZeros;A.exports=n;function n(a){var r=i(e.lo(a));if(r<32)return r;var f=i(e.hi(a));return f>20?52:f+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(u,A,T){u("bn.js"),A.exports=e;function e(i){return i&&typeof i=="object"&&Boolean(i.words)}},{"bn.js":33}],24:[function(u,A,T){var e=u("bn.js"),i=u("double-bits");A.exports=n;function n(a){var r=i.exponent(a);return r<52?new e(a):new e(a*Math.pow(2,52-r)).ushln(r-52)}},{"bn.js":33,"double-bits":64}],25:[function(u,A,T){var e=u("./num-to-bn"),i=u("./bn-sign");A.exports=n;function n(a,r){var f=i(a),o=i(r);if(f===0)return[e(0),e(1)];if(o===0)return[e(0),e(0)];o<0&&(a=a.neg(),r=r.neg());var s=a.gcd(r);return s.cmpn(1)?[a.div(s),r.div(s)]:[a,r]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(u,A,T){var e=u("bn.js");A.exports=i;function i(n){return new e(n)}},{"bn.js":33}],27:[function(u,A,T){var e=u("./lib/rationalize");A.exports=i;function i(n,a){return e(n[0].mul(a[0]),n[1].mul(a[1]))}},{"./lib/rationalize":25}],28:[function(u,A,T){var e=u("./lib/bn-sign");A.exports=i;function i(n){return e(n[0])*e(n[1])}},{"./lib/bn-sign":20}],29:[function(u,A,T){var e=u("./lib/rationalize");A.exports=i;function i(n,a){return e(n[0].mul(a[1]).sub(n[1].mul(a[0])),n[1].mul(a[1]))}},{"./lib/rationalize":25}],30:[function(u,A,T){var e=u("./lib/bn-to-num"),i=u("./lib/ctz");A.exports=n;function n(a){var r=a[0],f=a[1];if(r.cmpn(0)===0)return 0;var o=r.abs().divmod(f.abs()),s=o.div,m=e(s),g=o.mod,p=r.negative!==f.negative?-1:1;if(g.cmpn(0)===0)return p*m;if(m){var v=i(m)+4,x=e(g.ushln(v).divRound(f));return p*(m+x*Math.pow(2,-v))}else{var l=f.bitLength()-g.bitLength()+53,x=e(g.ushln(l).divRound(f));return l<1023?p*x*Math.pow(2,-l):(x*=Math.pow(2,-1023),p*x*Math.pow(2,1023-l))}}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(u,A,T){function e(o,s,m,g,p){for(var v=p+1;g<=p;){var x=g+p>>>1,l=o[x],b=m!==void 0?m(l,s):l-s;b>=0?(v=x,p=x-1):g=x+1}return v}function i(o,s,m,g,p){for(var v=p+1;g<=p;){var x=g+p>>>1,l=o[x],b=m!==void 0?m(l,s):l-s;b>0?(v=x,p=x-1):g=x+1}return v}function n(o,s,m,g,p){for(var v=g-1;g<=p;){var x=g+p>>>1,l=o[x],b=m!==void 0?m(l,s):l-s;b<0?(v=x,g=x+1):p=x-1}return v}function a(o,s,m,g,p){for(var v=g-1;g<=p;){var x=g+p>>>1,l=o[x],b=m!==void 0?m(l,s):l-s;b<=0?(v=x,g=x+1):p=x-1}return v}function r(o,s,m,g,p){for(;g<=p;){var v=g+p>>>1,x=o[v],l=m!==void 0?m(x,s):x-s;if(l===0)return v;l<=0?g=v+1:p=v-1}return-1}function f(o,s,m,g,p,v){return typeof m=="function"?v(o,s,m,g===void 0?0:g|0,p===void 0?o.length-1:p|0):v(o,s,void 0,m===void 0?0:m|0,g===void 0?o.length-1:g|0)}A.exports={ge:function(o,s,m,g,p){return f(o,s,m,g,p,e)},gt:function(o,s,m,g,p){return f(o,s,m,g,p,i)},lt:function(o,s,m,g,p){return f(o,s,m,g,p,n)},le:function(o,s,m,g,p){return f(o,s,m,g,p,a)},eq:function(o,s,m,g,p){return f(o,s,m,g,p,r)}}},{}],32:[function(u,A,T){var e=32;T.INT_BITS=e,T.INT_MAX=2147483647,T.INT_MIN=-1<<e-1,T.sign=function(a){return(a>0)-(a<0)},T.abs=function(a){var r=a>>e-1;return(a^r)-r},T.min=function(a,r){return r^(a^r)&-(a<r)},T.max=function(a,r){return a^(a^r)&-(a<r)},T.isPow2=function(a){return!(a&a-1)&&!!a},T.log2=function(a){var r,f;return r=(a>65535)<<4,a>>>=r,f=(a>255)<<3,a>>>=f,r|=f,f=(a>15)<<2,a>>>=f,r|=f,f=(a>3)<<1,a>>>=f,r|=f,r|a>>1},T.log10=function(a){return a>=1e9?9:a>=1e8?8:a>=1e7?7:a>=1e6?6:a>=1e5?5:a>=1e4?4:a>=1e3?3:a>=100?2:a>=10?1:0},T.popCount=function(a){return a=a-(a>>>1&1431655765),a=(a&858993459)+(a>>>2&858993459),(a+(a>>>4)&252645135)*16843009>>>24};function i(a){var r=32;return a&=-a,a&&r--,a&65535&&(r-=16),a&16711935&&(r-=8),a&252645135&&(r-=4),a&858993459&&(r-=2),a&1431655765&&(r-=1),r}T.countTrailingZeros=i,T.nextPow2=function(a){return a+=a===0,--a,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a+1},T.prevPow2=function(a){return a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a-(a>>>1)},T.parity=function(a){return a^=a>>>16,a^=a>>>8,a^=a>>>4,a&=15,27030>>>a&1};var n=new Array(256);(function(a){for(var r=0;r<256;++r){var f=r,o=r,s=7;for(f>>>=1;f;f>>>=1)o<<=1,o|=f&1,--s;a[r]=o<<s&255}})(n),T.reverse=function(a){return n[a&255]<<24|n[a>>>8&255]<<16|n[a>>>16&255]<<8|n[a>>>24&255]},T.interleave2=function(a,r){return a&=65535,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,r&=65535,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,a|r<<1},T.deinterleave2=function(a,r){return a=a>>>r&1431655765,a=(a|a>>>1)&858993459,a=(a|a>>>2)&252645135,a=(a|a>>>4)&16711935,a=(a|a>>>16)&65535,a<<16>>16},T.interleave3=function(a,r,f){return a&=1023,a=(a|a<<16)&4278190335,a=(a|a<<8)&251719695,a=(a|a<<4)&3272356035,a=(a|a<<2)&1227133513,r&=1023,r=(r|r<<16)&4278190335,r=(r|r<<8)&251719695,r=(r|r<<4)&3272356035,r=(r|r<<2)&1227133513,a|=r<<1,f&=1023,f=(f|f<<16)&4278190335,f=(f|f<<8)&251719695,f=(f|f<<4)&3272356035,f=(f|f<<2)&1227133513,a|f<<2},T.deinterleave3=function(a,r){return a=a>>>r&1227133513,a=(a|a>>>2)&3272356035,a=(a|a>>>4)&251719695,a=(a|a>>>8)&4278190335,a=(a|a>>>16)&1023,a<<22>>22},T.nextCombination=function(a){var r=a|a-1;return r+1|(~r&-~r)-1>>>i(a)+1}},{}],33:[function(u,A,T){(function(e,i){function n(z,F){if(!z)throw new Error(F||"Assertion failed")}function a(z,F){z.super_=F;var I=function(){};I.prototype=F.prototype,z.prototype=new I,z.prototype.constructor=z}function r(z,F,I){if(r.isBN(z))return z;this.negative=0,this.words=null,this.length=0,this.red=null,z!==null&&((F==="le"||F==="be")&&(I=F,F=10),this._init(z||0,F||10,I||"be"))}typeof e=="object"?e.exports=r:i.BN=r,r.BN=r,r.wordSize=26;var f;try{typeof window<"u"&&typeof window.Buffer<"u"?f=window.Buffer:f=u("buffer").Buffer}catch{}r.isBN=function(F){return F instanceof r?!0:F!==null&&typeof F=="object"&&F.constructor.wordSize===r.wordSize&&Array.isArray(F.words)},r.max=function(F,I){return F.cmp(I)>0?F:I},r.min=function(F,I){return F.cmp(I)<0?F:I},r.prototype._init=function(F,I,O){if(typeof F=="number")return this._initNumber(F,I,O);if(typeof F=="object")return this._initArray(F,I,O);I==="hex"&&(I=16),n(I===(I|0)&&I>=2&&I<=36),F=F.toString().replace(/\s+/g,"");var N=0;F[0]==="-"&&(N++,this.negative=1),N<F.length&&(I===16?this._parseHex(F,N,O):(this._parseBase(F,I,N),O==="le"&&this._initArray(this.toArray(),I,O)))},r.prototype._initNumber=function(F,I,O){F<0&&(this.negative=1,F=-F),F<67108864?(this.words=[F&67108863],this.length=1):F<4503599627370496?(this.words=[F&67108863,F/67108864&67108863],this.length=2):(n(F<9007199254740992),this.words=[F&67108863,F/67108864&67108863,1],this.length=3),O==="le"&&this._initArray(this.toArray(),I,O)},r.prototype._initArray=function(F,I,O){if(n(typeof F.length=="number"),F.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(F.length/3),this.words=new Array(this.length);for(var N=0;N<this.length;N++)this.words[N]=0;var V,H,j=0;if(O==="be")for(N=F.length-1,V=0;N>=0;N-=3)H=F[N]|F[N-1]<<8|F[N-2]<<16,this.words[V]|=H<<j&67108863,this.words[V+1]=H>>>26-j&67108863,j+=24,j>=26&&(j-=26,V++);else if(O==="le")for(N=0,V=0;N<F.length;N+=3)H=F[N]|F[N+1]<<8|F[N+2]<<16,this.words[V]|=H<<j&67108863,this.words[V+1]=H>>>26-j&67108863,j+=24,j>=26&&(j-=26,V++);return this.strip()};function o(z,F){var I=z.charCodeAt(F);return I>=65&&I<=70?I-55:I>=97&&I<=102?I-87:I-48&15}function s(z,F,I){var O=o(z,I);return I-1>=F&&(O|=o(z,I-1)<<4),O}r.prototype._parseHex=function(F,I,O){this.length=Math.ceil((F.length-I)/6),this.words=new Array(this.length);for(var N=0;N<this.length;N++)this.words[N]=0;var V=0,H=0,j;if(O==="be")for(N=F.length-1;N>=I;N-=2)j=s(F,I,N)<<V,this.words[H]|=j&67108863,V>=18?(V-=18,H+=1,this.words[H]|=j>>>26):V+=8;else{var Z=F.length-I;for(N=Z%2===0?I+1:I;N<F.length;N+=2)j=s(F,I,N)<<V,this.words[H]|=j&67108863,V>=18?(V-=18,H+=1,this.words[H]|=j>>>26):V+=8}this.strip()};function m(z,F,I,O){for(var N=0,V=Math.min(z.length,I),H=F;H<V;H++){var j=z.charCodeAt(H)-48;N*=O,j>=49?N+=j-49+10:j>=17?N+=j-17+10:N+=j}return N}r.prototype._parseBase=function(F,I,O){this.words=[0],this.length=1;for(var N=0,V=1;V<=67108863;V*=I)N++;N--,V=V/I|0;for(var H=F.length-O,j=H%N,Z=Math.min(H,H-j)+O,X=0,re=O;re<Z;re+=N)X=m(F,re,re+N,I),this.imuln(V),this.words[0]+X<67108864?this.words[0]+=X:this._iaddn(X);if(j!==0){var ue=1;for(X=m(F,re,F.length,I),re=0;re<j;re++)ue*=I;this.imuln(ue),this.words[0]+X<67108864?this.words[0]+=X:this._iaddn(X)}this.strip()},r.prototype.copy=function(F){F.words=new Array(this.length);for(var I=0;I<this.length;I++)F.words[I]=this.words[I];F.length=this.length,F.negative=this.negative,F.red=this.red},r.prototype.clone=function(){var F=new r(null);return this.copy(F),F},r.prototype._expand=function(F){for(;this.length<F;)this.words[this.length++]=0;return this},r.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},r.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},r.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var g=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],p=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],v=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];r.prototype.toString=function(F,I){F=F||10,I=I|0||1;var O;if(F===16||F==="hex"){O="";for(var N=0,V=0,H=0;H<this.length;H++){var j=this.words[H],Z=((j<<N|V)&16777215).toString(16);V=j>>>24-N&16777215,V!==0||H!==this.length-1?O=g[6-Z.length]+Z+O:O=Z+O,N+=2,N>=26&&(N-=26,H--)}for(V!==0&&(O=V.toString(16)+O);O.length%I!==0;)O="0"+O;return this.negative!==0&&(O="-"+O),O}if(F===(F|0)&&F>=2&&F<=36){var X=p[F],re=v[F];O="";var ue=this.clone();for(ue.negative=0;!ue.isZero();){var K=ue.modn(re).toString(F);ue=ue.idivn(re),ue.isZero()?O=K+O:O=g[X-K.length]+K+O}for(this.isZero()&&(O="0"+O);O.length%I!==0;)O="0"+O;return this.negative!==0&&(O="-"+O),O}n(!1,"Base should be between 2 and 36")},r.prototype.toNumber=function(){var F=this.words[0];return this.length===2?F+=this.words[1]*67108864:this.length===3&&this.words[2]===1?F+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-F:F},r.prototype.toJSON=function(){return this.toString(16)},r.prototype.toBuffer=function(F,I){return n(typeof f<"u"),this.toArrayLike(f,F,I)},r.prototype.toArray=function(F,I){return this.toArrayLike(Array,F,I)},r.prototype.toArrayLike=function(F,I,O){var N=this.byteLength(),V=O||Math.max(1,N);n(N<=V,"byte array longer than desired length"),n(V>0,"Requested array length <= 0"),this.strip();var H=I==="le",j=new F(V),Z,X,re=this.clone();if(H){for(X=0;!re.isZero();X++)Z=re.andln(255),re.iushrn(8),j[X]=Z;for(;X<V;X++)j[X]=0}else{for(X=0;X<V-N;X++)j[X]=0;for(X=0;!re.isZero();X++)Z=re.andln(255),re.iushrn(8),j[V-X-1]=Z}return j},Math.clz32?r.prototype._countBits=function(F){return 32-Math.clz32(F)}:r.prototype._countBits=function(F){var I=F,O=0;return I>=4096&&(O+=13,I>>>=13),I>=64&&(O+=7,I>>>=7),I>=8&&(O+=4,I>>>=4),I>=2&&(O+=2,I>>>=2),O+I},r.prototype._zeroBits=function(F){if(F===0)return 26;var I=F,O=0;return(I&8191)===0&&(O+=13,I>>>=13),(I&127)===0&&(O+=7,I>>>=7),(I&15)===0&&(O+=4,I>>>=4),(I&3)===0&&(O+=2,I>>>=2),(I&1)===0&&O++,O},r.prototype.bitLength=function(){var F=this.words[this.length-1],I=this._countBits(F);return(this.length-1)*26+I};function x(z){for(var F=new Array(z.bitLength()),I=0;I<F.length;I++){var O=I/26|0,N=I%26;F[I]=(z.words[O]&1<<N)>>>N}return F}r.prototype.zeroBits=function(){if(this.isZero())return 0;for(var F=0,I=0;I<this.length;I++){var O=this._zeroBits(this.words[I]);if(F+=O,O!==26)break}return F},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.toTwos=function(F){return this.negative!==0?this.abs().inotn(F).iaddn(1):this.clone()},r.prototype.fromTwos=function(F){return this.testn(F-1)?this.notn(F).iaddn(1).ineg():this.clone()},r.prototype.isNeg=function(){return this.negative!==0},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},r.prototype.iuor=function(F){for(;this.length<F.length;)this.words[this.length++]=0;for(var I=0;I<F.length;I++)this.words[I]=this.words[I]|F.words[I];return this.strip()},r.prototype.ior=function(F){return n((this.negative|F.negative)===0),this.iuor(F)},r.prototype.or=function(F){return this.length>F.length?this.clone().ior(F):F.clone().ior(this)},r.prototype.uor=function(F){return this.length>F.length?this.clone().iuor(F):F.clone().iuor(this)},r.prototype.iuand=function(F){var I;this.length>F.length?I=F:I=this;for(var O=0;O<I.length;O++)this.words[O]=this.words[O]&F.words[O];return this.length=I.length,this.strip()},r.prototype.iand=function(F){return n((this.negative|F.negative)===0),this.iuand(F)},r.prototype.and=function(F){return this.length>F.length?this.clone().iand(F):F.clone().iand(this)},r.prototype.uand=function(F){return this.length>F.length?this.clone().iuand(F):F.clone().iuand(this)},r.prototype.iuxor=function(F){var I,O;this.length>F.length?(I=this,O=F):(I=F,O=this);for(var N=0;N<O.length;N++)this.words[N]=I.words[N]^O.words[N];if(this!==I)for(;N<I.length;N++)this.words[N]=I.words[N];return this.length=I.length,this.strip()},r.prototype.ixor=function(F){return n((this.negative|F.negative)===0),this.iuxor(F)},r.prototype.xor=function(F){return this.length>F.length?this.clone().ixor(F):F.clone().ixor(this)},r.prototype.uxor=function(F){return this.length>F.length?this.clone().iuxor(F):F.clone().iuxor(this)},r.prototype.inotn=function(F){n(typeof F=="number"&&F>=0);var I=Math.ceil(F/26)|0,O=F%26;this._expand(I),O>0&&I--;for(var N=0;N<I;N++)this.words[N]=~this.words[N]&67108863;return O>0&&(this.words[N]=~this.words[N]&67108863>>26-O),this.strip()},r.prototype.notn=function(F){return this.clone().inotn(F)},r.prototype.setn=function(F,I){n(typeof F=="number"&&F>=0);var O=F/26|0,N=F%26;return this._expand(O+1),I?this.words[O]=this.words[O]|1<<N:this.words[O]=this.words[O]&~(1<<N),this.strip()},r.prototype.iadd=function(F){var I;if(this.negative!==0&&F.negative===0)return this.negative=0,I=this.isub(F),this.negative^=1,this._normSign();if(this.negative===0&&F.negative!==0)return F.negative=0,I=this.isub(F),F.negative=1,I._normSign();var O,N;this.length>F.length?(O=this,N=F):(O=F,N=this);for(var V=0,H=0;H<N.length;H++)I=(O.words[H]|0)+(N.words[H]|0)+V,this.words[H]=I&67108863,V=I>>>26;for(;V!==0&&H<O.length;H++)I=(O.words[H]|0)+V,this.words[H]=I&67108863,V=I>>>26;if(this.length=O.length,V!==0)this.words[this.length]=V,this.length++;else if(O!==this)for(;H<O.length;H++)this.words[H]=O.words[H];return this},r.prototype.add=function(F){var I;return F.negative!==0&&this.negative===0?(F.negative=0,I=this.sub(F),F.negative^=1,I):F.negative===0&&this.negative!==0?(this.negative=0,I=F.sub(this),this.negative=1,I):this.length>F.length?this.clone().iadd(F):F.clone().iadd(this)},r.prototype.isub=function(F){if(F.negative!==0){F.negative=0;var I=this.iadd(F);return F.negative=1,I._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(F),this.negative=1,this._normSign();var O=this.cmp(F);if(O===0)return this.negative=0,this.length=1,this.words[0]=0,this;var N,V;O>0?(N=this,V=F):(N=F,V=this);for(var H=0,j=0;j<V.length;j++)I=(N.words[j]|0)-(V.words[j]|0)+H,H=I>>26,this.words[j]=I&67108863;for(;H!==0&&j<N.length;j++)I=(N.words[j]|0)+H,H=I>>26,this.words[j]=I&67108863;if(H===0&&j<N.length&&N!==this)for(;j<N.length;j++)this.words[j]=N.words[j];return this.length=Math.max(this.length,j),N!==this&&(this.negative=1),this.strip()},r.prototype.sub=function(F){return this.clone().isub(F)};function l(z,F,I){I.negative=F.negative^z.negative;var O=z.length+F.length|0;I.length=O,O=O-1|0;var N=z.words[0]|0,V=F.words[0]|0,H=N*V,j=H&67108863,Z=H/67108864|0;I.words[0]=j;for(var X=1;X<O;X++){for(var re=Z>>>26,ue=Z&67108863,K=Math.min(X,F.length-1),te=Math.max(0,X-z.length+1);te<=K;te++){var G=X-te|0;N=z.words[G]|0,V=F.words[te]|0,H=N*V+ue,re+=H/67108864|0,ue=H&67108863}I.words[X]=ue|0,Z=re|0}return Z!==0?I.words[X]=Z|0:I.length--,I.strip()}var b=function(F,I,O){var N=F.words,V=I.words,H=O.words,j=0,Z,X,re,ue=N[0]|0,K=ue&8191,te=ue>>>13,G=N[1]|0,Y=G&8191,ee=G>>>13,ne=N[2]|0,J=ne&8191,q=ne>>>13,ae=N[3]|0,le=ae&8191,ie=ae>>>13,se=N[4]|0,xe=se&8191,oe=se>>>13,he=N[5]|0,be=he&8191,me=he>>>13,_e=N[6]|0,Se=_e&8191,De=_e>>>13,Ie=N[7]|0,Te=Ie&8191,Ce=Ie>>>13,He=N[8]|0,Xe=He&8191,Be=He>>>13,Re=N[9]|0,We=Re&8191,vt=Re>>>13,Pt=V[0]|0,Zt=Pt&8191,zt=Pt>>>13,At=V[1]|0,Wt=At&8191,Bt=At>>>13,Ct=V[2]|0,Ze=Ct&8191,nt=Ct>>>13,Ye=V[3]|0,Ee=Ye&8191,Ge=Ye>>>13,Je=V[4]|0,qe=Je&8191,Tt=Je>>>13,mt=V[5]|0,Mt=mt&8191,Ht=mt>>>13,Rt=V[6]|0,Vt=Rt&8191,Jt=Rt>>>13,Yt=V[7]|0,or=Yt&8191,Hr=Yt>>>13,an=V[8]|0,Kr=an&8191,ot=an>>>13,er=V[9]|0,Kt=er&8191,ur=er>>>13;O.negative=F.negative^I.negative,O.length=19,Z=Math.imul(K,Zt),X=Math.imul(K,zt),X=X+Math.imul(te,Zt)|0,re=Math.imul(te,zt);var Ar=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(Ar>>>26)|0,Ar&=67108863,Z=Math.imul(Y,Zt),X=Math.imul(Y,zt),X=X+Math.imul(ee,Zt)|0,re=Math.imul(ee,zt),Z=Z+Math.imul(K,Wt)|0,X=X+Math.imul(K,Bt)|0,X=X+Math.imul(te,Wt)|0,re=re+Math.imul(te,Bt)|0;var et=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(et>>>26)|0,et&=67108863,Z=Math.imul(J,Zt),X=Math.imul(J,zt),X=X+Math.imul(q,Zt)|0,re=Math.imul(q,zt),Z=Z+Math.imul(Y,Wt)|0,X=X+Math.imul(Y,Bt)|0,X=X+Math.imul(ee,Wt)|0,re=re+Math.imul(ee,Bt)|0,Z=Z+Math.imul(K,Ze)|0,X=X+Math.imul(K,nt)|0,X=X+Math.imul(te,Ze)|0,re=re+Math.imul(te,nt)|0;var $e=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+($e>>>26)|0,$e&=67108863,Z=Math.imul(le,Zt),X=Math.imul(le,zt),X=X+Math.imul(ie,Zt)|0,re=Math.imul(ie,zt),Z=Z+Math.imul(J,Wt)|0,X=X+Math.imul(J,Bt)|0,X=X+Math.imul(q,Wt)|0,re=re+Math.imul(q,Bt)|0,Z=Z+Math.imul(Y,Ze)|0,X=X+Math.imul(Y,nt)|0,X=X+Math.imul(ee,Ze)|0,re=re+Math.imul(ee,nt)|0,Z=Z+Math.imul(K,Ee)|0,X=X+Math.imul(K,Ge)|0,X=X+Math.imul(te,Ee)|0,re=re+Math.imul(te,Ge)|0;var st=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(st>>>26)|0,st&=67108863,Z=Math.imul(xe,Zt),X=Math.imul(xe,zt),X=X+Math.imul(oe,Zt)|0,re=Math.imul(oe,zt),Z=Z+Math.imul(le,Wt)|0,X=X+Math.imul(le,Bt)|0,X=X+Math.imul(ie,Wt)|0,re=re+Math.imul(ie,Bt)|0,Z=Z+Math.imul(J,Ze)|0,X=X+Math.imul(J,nt)|0,X=X+Math.imul(q,Ze)|0,re=re+Math.imul(q,nt)|0,Z=Z+Math.imul(Y,Ee)|0,X=X+Math.imul(Y,Ge)|0,X=X+Math.imul(ee,Ee)|0,re=re+Math.imul(ee,Ge)|0,Z=Z+Math.imul(K,qe)|0,X=X+Math.imul(K,Tt)|0,X=X+Math.imul(te,qe)|0,re=re+Math.imul(te,Tt)|0;var ft=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(ft>>>26)|0,ft&=67108863,Z=Math.imul(be,Zt),X=Math.imul(be,zt),X=X+Math.imul(me,Zt)|0,re=Math.imul(me,zt),Z=Z+Math.imul(xe,Wt)|0,X=X+Math.imul(xe,Bt)|0,X=X+Math.imul(oe,Wt)|0,re=re+Math.imul(oe,Bt)|0,Z=Z+Math.imul(le,Ze)|0,X=X+Math.imul(le,nt)|0,X=X+Math.imul(ie,Ze)|0,re=re+Math.imul(ie,nt)|0,Z=Z+Math.imul(J,Ee)|0,X=X+Math.imul(J,Ge)|0,X=X+Math.imul(q,Ee)|0,re=re+Math.imul(q,Ge)|0,Z=Z+Math.imul(Y,qe)|0,X=X+Math.imul(Y,Tt)|0,X=X+Math.imul(ee,qe)|0,re=re+Math.imul(ee,Tt)|0,Z=Z+Math.imul(K,Mt)|0,X=X+Math.imul(K,Ht)|0,X=X+Math.imul(te,Mt)|0,re=re+Math.imul(te,Ht)|0;var St=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(St>>>26)|0,St&=67108863,Z=Math.imul(Se,Zt),X=Math.imul(Se,zt),X=X+Math.imul(De,Zt)|0,re=Math.imul(De,zt),Z=Z+Math.imul(be,Wt)|0,X=X+Math.imul(be,Bt)|0,X=X+Math.imul(me,Wt)|0,re=re+Math.imul(me,Bt)|0,Z=Z+Math.imul(xe,Ze)|0,X=X+Math.imul(xe,nt)|0,X=X+Math.imul(oe,Ze)|0,re=re+Math.imul(oe,nt)|0,Z=Z+Math.imul(le,Ee)|0,X=X+Math.imul(le,Ge)|0,X=X+Math.imul(ie,Ee)|0,re=re+Math.imul(ie,Ge)|0,Z=Z+Math.imul(J,qe)|0,X=X+Math.imul(J,Tt)|0,X=X+Math.imul(q,qe)|0,re=re+Math.imul(q,Tt)|0,Z=Z+Math.imul(Y,Mt)|0,X=X+Math.imul(Y,Ht)|0,X=X+Math.imul(ee,Mt)|0,re=re+Math.imul(ee,Ht)|0,Z=Z+Math.imul(K,Vt)|0,X=X+Math.imul(K,Jt)|0,X=X+Math.imul(te,Vt)|0,re=re+Math.imul(te,Jt)|0;var Ut=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,Z=Math.imul(Te,Zt),X=Math.imul(Te,zt),X=X+Math.imul(Ce,Zt)|0,re=Math.imul(Ce,zt),Z=Z+Math.imul(Se,Wt)|0,X=X+Math.imul(Se,Bt)|0,X=X+Math.imul(De,Wt)|0,re=re+Math.imul(De,Bt)|0,Z=Z+Math.imul(be,Ze)|0,X=X+Math.imul(be,nt)|0,X=X+Math.imul(me,Ze)|0,re=re+Math.imul(me,nt)|0,Z=Z+Math.imul(xe,Ee)|0,X=X+Math.imul(xe,Ge)|0,X=X+Math.imul(oe,Ee)|0,re=re+Math.imul(oe,Ge)|0,Z=Z+Math.imul(le,qe)|0,X=X+Math.imul(le,Tt)|0,X=X+Math.imul(ie,qe)|0,re=re+Math.imul(ie,Tt)|0,Z=Z+Math.imul(J,Mt)|0,X=X+Math.imul(J,Ht)|0,X=X+Math.imul(q,Mt)|0,re=re+Math.imul(q,Ht)|0,Z=Z+Math.imul(Y,Vt)|0,X=X+Math.imul(Y,Jt)|0,X=X+Math.imul(ee,Vt)|0,re=re+Math.imul(ee,Jt)|0,Z=Z+Math.imul(K,or)|0,X=X+Math.imul(K,Hr)|0,X=X+Math.imul(te,or)|0,re=re+Math.imul(te,Hr)|0;var Pe=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,Z=Math.imul(Xe,Zt),X=Math.imul(Xe,zt),X=X+Math.imul(Be,Zt)|0,re=Math.imul(Be,zt),Z=Z+Math.imul(Te,Wt)|0,X=X+Math.imul(Te,Bt)|0,X=X+Math.imul(Ce,Wt)|0,re=re+Math.imul(Ce,Bt)|0,Z=Z+Math.imul(Se,Ze)|0,X=X+Math.imul(Se,nt)|0,X=X+Math.imul(De,Ze)|0,re=re+Math.imul(De,nt)|0,Z=Z+Math.imul(be,Ee)|0,X=X+Math.imul(be,Ge)|0,X=X+Math.imul(me,Ee)|0,re=re+Math.imul(me,Ge)|0,Z=Z+Math.imul(xe,qe)|0,X=X+Math.imul(xe,Tt)|0,X=X+Math.imul(oe,qe)|0,re=re+Math.imul(oe,Tt)|0,Z=Z+Math.imul(le,Mt)|0,X=X+Math.imul(le,Ht)|0,X=X+Math.imul(ie,Mt)|0,re=re+Math.imul(ie,Ht)|0,Z=Z+Math.imul(J,Vt)|0,X=X+Math.imul(J,Jt)|0,X=X+Math.imul(q,Vt)|0,re=re+Math.imul(q,Jt)|0,Z=Z+Math.imul(Y,or)|0,X=X+Math.imul(Y,Hr)|0,X=X+Math.imul(ee,or)|0,re=re+Math.imul(ee,Hr)|0,Z=Z+Math.imul(K,Kr)|0,X=X+Math.imul(K,ot)|0,X=X+Math.imul(te,Kr)|0,re=re+Math.imul(te,ot)|0;var ke=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(ke>>>26)|0,ke&=67108863,Z=Math.imul(We,Zt),X=Math.imul(We,zt),X=X+Math.imul(vt,Zt)|0,re=Math.imul(vt,zt),Z=Z+Math.imul(Xe,Wt)|0,X=X+Math.imul(Xe,Bt)|0,X=X+Math.imul(Be,Wt)|0,re=re+Math.imul(Be,Bt)|0,Z=Z+Math.imul(Te,Ze)|0,X=X+Math.imul(Te,nt)|0,X=X+Math.imul(Ce,Ze)|0,re=re+Math.imul(Ce,nt)|0,Z=Z+Math.imul(Se,Ee)|0,X=X+Math.imul(Se,Ge)|0,X=X+Math.imul(De,Ee)|0,re=re+Math.imul(De,Ge)|0,Z=Z+Math.imul(be,qe)|0,X=X+Math.imul(be,Tt)|0,X=X+Math.imul(me,qe)|0,re=re+Math.imul(me,Tt)|0,Z=Z+Math.imul(xe,Mt)|0,X=X+Math.imul(xe,Ht)|0,X=X+Math.imul(oe,Mt)|0,re=re+Math.imul(oe,Ht)|0,Z=Z+Math.imul(le,Vt)|0,X=X+Math.imul(le,Jt)|0,X=X+Math.imul(ie,Vt)|0,re=re+Math.imul(ie,Jt)|0,Z=Z+Math.imul(J,or)|0,X=X+Math.imul(J,Hr)|0,X=X+Math.imul(q,or)|0,re=re+Math.imul(q,Hr)|0,Z=Z+Math.imul(Y,Kr)|0,X=X+Math.imul(Y,ot)|0,X=X+Math.imul(ee,Kr)|0,re=re+Math.imul(ee,ot)|0,Z=Z+Math.imul(K,Kt)|0,X=X+Math.imul(K,ur)|0,X=X+Math.imul(te,Kt)|0,re=re+Math.imul(te,ur)|0;var it=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(it>>>26)|0,it&=67108863,Z=Math.imul(We,Wt),X=Math.imul(We,Bt),X=X+Math.imul(vt,Wt)|0,re=Math.imul(vt,Bt),Z=Z+Math.imul(Xe,Ze)|0,X=X+Math.imul(Xe,nt)|0,X=X+Math.imul(Be,Ze)|0,re=re+Math.imul(Be,nt)|0,Z=Z+Math.imul(Te,Ee)|0,X=X+Math.imul(Te,Ge)|0,X=X+Math.imul(Ce,Ee)|0,re=re+Math.imul(Ce,Ge)|0,Z=Z+Math.imul(Se,qe)|0,X=X+Math.imul(Se,Tt)|0,X=X+Math.imul(De,qe)|0,re=re+Math.imul(De,Tt)|0,Z=Z+Math.imul(be,Mt)|0,X=X+Math.imul(be,Ht)|0,X=X+Math.imul(me,Mt)|0,re=re+Math.imul(me,Ht)|0,Z=Z+Math.imul(xe,Vt)|0,X=X+Math.imul(xe,Jt)|0,X=X+Math.imul(oe,Vt)|0,re=re+Math.imul(oe,Jt)|0,Z=Z+Math.imul(le,or)|0,X=X+Math.imul(le,Hr)|0,X=X+Math.imul(ie,or)|0,re=re+Math.imul(ie,Hr)|0,Z=Z+Math.imul(J,Kr)|0,X=X+Math.imul(J,ot)|0,X=X+Math.imul(q,Kr)|0,re=re+Math.imul(q,ot)|0,Z=Z+Math.imul(Y,Kt)|0,X=X+Math.imul(Y,ur)|0,X=X+Math.imul(ee,Kt)|0,re=re+Math.imul(ee,ur)|0;var ut=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(ut>>>26)|0,ut&=67108863,Z=Math.imul(We,Ze),X=Math.imul(We,nt),X=X+Math.imul(vt,Ze)|0,re=Math.imul(vt,nt),Z=Z+Math.imul(Xe,Ee)|0,X=X+Math.imul(Xe,Ge)|0,X=X+Math.imul(Be,Ee)|0,re=re+Math.imul(Be,Ge)|0,Z=Z+Math.imul(Te,qe)|0,X=X+Math.imul(Te,Tt)|0,X=X+Math.imul(Ce,qe)|0,re=re+Math.imul(Ce,Tt)|0,Z=Z+Math.imul(Se,Mt)|0,X=X+Math.imul(Se,Ht)|0,X=X+Math.imul(De,Mt)|0,re=re+Math.imul(De,Ht)|0,Z=Z+Math.imul(be,Vt)|0,X=X+Math.imul(be,Jt)|0,X=X+Math.imul(me,Vt)|0,re=re+Math.imul(me,Jt)|0,Z=Z+Math.imul(xe,or)|0,X=X+Math.imul(xe,Hr)|0,X=X+Math.imul(oe,or)|0,re=re+Math.imul(oe,Hr)|0,Z=Z+Math.imul(le,Kr)|0,X=X+Math.imul(le,ot)|0,X=X+Math.imul(ie,Kr)|0,re=re+Math.imul(ie,ot)|0,Z=Z+Math.imul(J,Kt)|0,X=X+Math.imul(J,ur)|0,X=X+Math.imul(q,Kt)|0,re=re+Math.imul(q,ur)|0;var ht=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(ht>>>26)|0,ht&=67108863,Z=Math.imul(We,Ee),X=Math.imul(We,Ge),X=X+Math.imul(vt,Ee)|0,re=Math.imul(vt,Ge),Z=Z+Math.imul(Xe,qe)|0,X=X+Math.imul(Xe,Tt)|0,X=X+Math.imul(Be,qe)|0,re=re+Math.imul(Be,Tt)|0,Z=Z+Math.imul(Te,Mt)|0,X=X+Math.imul(Te,Ht)|0,X=X+Math.imul(Ce,Mt)|0,re=re+Math.imul(Ce,Ht)|0,Z=Z+Math.imul(Se,Vt)|0,X=X+Math.imul(Se,Jt)|0,X=X+Math.imul(De,Vt)|0,re=re+Math.imul(De,Jt)|0,Z=Z+Math.imul(be,or)|0,X=X+Math.imul(be,Hr)|0,X=X+Math.imul(me,or)|0,re=re+Math.imul(me,Hr)|0,Z=Z+Math.imul(xe,Kr)|0,X=X+Math.imul(xe,ot)|0,X=X+Math.imul(oe,Kr)|0,re=re+Math.imul(oe,ot)|0,Z=Z+Math.imul(le,Kt)|0,X=X+Math.imul(le,ur)|0,X=X+Math.imul(ie,Kt)|0,re=re+Math.imul(ie,ur)|0;var Et=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(Et>>>26)|0,Et&=67108863,Z=Math.imul(We,qe),X=Math.imul(We,Tt),X=X+Math.imul(vt,qe)|0,re=Math.imul(vt,Tt),Z=Z+Math.imul(Xe,Mt)|0,X=X+Math.imul(Xe,Ht)|0,X=X+Math.imul(Be,Mt)|0,re=re+Math.imul(Be,Ht)|0,Z=Z+Math.imul(Te,Vt)|0,X=X+Math.imul(Te,Jt)|0,X=X+Math.imul(Ce,Vt)|0,re=re+Math.imul(Ce,Jt)|0,Z=Z+Math.imul(Se,or)|0,X=X+Math.imul(Se,Hr)|0,X=X+Math.imul(De,or)|0,re=re+Math.imul(De,Hr)|0,Z=Z+Math.imul(be,Kr)|0,X=X+Math.imul(be,ot)|0,X=X+Math.imul(me,Kr)|0,re=re+Math.imul(me,ot)|0,Z=Z+Math.imul(xe,Kt)|0,X=X+Math.imul(xe,ur)|0,X=X+Math.imul(oe,Kt)|0,re=re+Math.imul(oe,ur)|0;var yt=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(yt>>>26)|0,yt&=67108863,Z=Math.imul(We,Mt),X=Math.imul(We,Ht),X=X+Math.imul(vt,Mt)|0,re=Math.imul(vt,Ht),Z=Z+Math.imul(Xe,Vt)|0,X=X+Math.imul(Xe,Jt)|0,X=X+Math.imul(Be,Vt)|0,re=re+Math.imul(Be,Jt)|0,Z=Z+Math.imul(Te,or)|0,X=X+Math.imul(Te,Hr)|0,X=X+Math.imul(Ce,or)|0,re=re+Math.imul(Ce,Hr)|0,Z=Z+Math.imul(Se,Kr)|0,X=X+Math.imul(Se,ot)|0,X=X+Math.imul(De,Kr)|0,re=re+Math.imul(De,ot)|0,Z=Z+Math.imul(be,Kt)|0,X=X+Math.imul(be,ur)|0,X=X+Math.imul(me,Kt)|0,re=re+Math.imul(me,ur)|0;var Dt=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,Z=Math.imul(We,Vt),X=Math.imul(We,Jt),X=X+Math.imul(vt,Vt)|0,re=Math.imul(vt,Jt),Z=Z+Math.imul(Xe,or)|0,X=X+Math.imul(Xe,Hr)|0,X=X+Math.imul(Be,or)|0,re=re+Math.imul(Be,Hr)|0,Z=Z+Math.imul(Te,Kr)|0,X=X+Math.imul(Te,ot)|0,X=X+Math.imul(Ce,Kr)|0,re=re+Math.imul(Ce,ot)|0,Z=Z+Math.imul(Se,Kt)|0,X=X+Math.imul(Se,ur)|0,X=X+Math.imul(De,Kt)|0,re=re+Math.imul(De,ur)|0;var Xt=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,Z=Math.imul(We,or),X=Math.imul(We,Hr),X=X+Math.imul(vt,or)|0,re=Math.imul(vt,Hr),Z=Z+Math.imul(Xe,Kr)|0,X=X+Math.imul(Xe,ot)|0,X=X+Math.imul(Be,Kr)|0,re=re+Math.imul(Be,ot)|0,Z=Z+Math.imul(Te,Kt)|0,X=X+Math.imul(Te,ur)|0,X=X+Math.imul(Ce,Kt)|0,re=re+Math.imul(Ce,ur)|0;var ar=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(ar>>>26)|0,ar&=67108863,Z=Math.imul(We,Kr),X=Math.imul(We,ot),X=X+Math.imul(vt,Kr)|0,re=Math.imul(vt,ot),Z=Z+Math.imul(Xe,Kt)|0,X=X+Math.imul(Xe,ur)|0,X=X+Math.imul(Be,Kt)|0,re=re+Math.imul(Be,ur)|0;var kr=(j+Z|0)+((X&8191)<<13)|0;j=(re+(X>>>13)|0)+(kr>>>26)|0,kr&=67108863,Z=Math.imul(We,Kt),X=Math.imul(We,ur),X=X+Math.imul(vt,Kt)|0,re=Math.imul(vt,ur);var wr=(j+Z|0)+((X&8191)<<13)|0;return j=(re+(X>>>13)|0)+(wr>>>26)|0,wr&=67108863,H[0]=Ar,H[1]=et,H[2]=$e,H[3]=st,H[4]=ft,H[5]=St,H[6]=Ut,H[7]=Pe,H[8]=ke,H[9]=it,H[10]=ut,H[11]=ht,H[12]=Et,H[13]=yt,H[14]=Dt,H[15]=Xt,H[16]=ar,H[17]=kr,H[18]=wr,j!==0&&(H[19]=j,O.length++),O};Math.imul||(b=l);function c(z,F,I){I.negative=F.negative^z.negative,I.length=z.length+F.length;for(var O=0,N=0,V=0;V<I.length-1;V++){var H=N;N=0;for(var j=O&67108863,Z=Math.min(V,F.length-1),X=Math.max(0,V-z.length+1);X<=Z;X++){var re=V-X,ue=z.words[re]|0,K=F.words[X]|0,te=ue*K,G=te&67108863;H=H+(te/67108864|0)|0,G=G+j|0,j=G&67108863,H=H+(G>>>26)|0,N+=H>>>26,H&=67108863}I.words[V]=j,O=H,H=N}return O!==0?I.words[V]=O:I.length--,I.strip()}function M(z,F,I){var O=new _;return O.mulp(z,F,I)}r.prototype.mulTo=function(F,I){var O,N=this.length+F.length;return this.length===10&&F.length===10?O=b(this,F,I):N<63?O=l(this,F,I):N<1024?O=c(this,F,I):O=M(this,F,I),O};function _(z,F){this.x=z,this.y=F}_.prototype.makeRBT=function(F){for(var I=new Array(F),O=r.prototype._countBits(F)-1,N=0;N<F;N++)I[N]=this.revBin(N,O,F);return I},_.prototype.revBin=function(F,I,O){if(F===0||F===O-1)return F;for(var N=0,V=0;V<I;V++)N|=(F&1)<<I-V-1,F>>=1;return N},_.prototype.permute=function(F,I,O,N,V,H){for(var j=0;j<H;j++)N[j]=I[F[j]],V[j]=O[F[j]]},_.prototype.transform=function(F,I,O,N,V,H){this.permute(H,F,I,O,N,V);for(var j=1;j<V;j<<=1)for(var Z=j<<1,X=Math.cos(2*Math.PI/Z),re=Math.sin(2*Math.PI/Z),ue=0;ue<V;ue+=Z)for(var K=X,te=re,G=0;G<j;G++){var Y=O[ue+G],ee=N[ue+G],ne=O[ue+G+j],J=N[ue+G+j],q=K*ne-te*J;J=K*J+te*ne,ne=q,O[ue+G]=Y+ne,N[ue+G]=ee+J,O[ue+G+j]=Y-ne,N[ue+G+j]=ee-J,G!==Z&&(q=X*K-re*te,te=X*te+re*K,K=q)}},_.prototype.guessLen13b=function(F,I){var O=Math.max(I,F)|1,N=O&1,V=0;for(O=O/2|0;O;O=O>>>1)V++;return 1<<V+1+N},_.prototype.conjugate=function(F,I,O){if(!(O<=1))for(var N=0;N<O/2;N++){var V=F[N];F[N]=F[O-N-1],F[O-N-1]=V,V=I[N],I[N]=-I[O-N-1],I[O-N-1]=-V}},_.prototype.normalize13b=function(F,I){for(var O=0,N=0;N<I/2;N++){var V=Math.round(F[2*N+1]/I)*8192+Math.round(F[2*N]/I)+O;F[N]=V&67108863,V<67108864?O=0:O=V/67108864|0}return F},_.prototype.convert13b=function(F,I,O,N){for(var V=0,H=0;H<I;H++)V=V+(F[H]|0),O[2*H]=V&8191,V=V>>>13,O[2*H+1]=V&8191,V=V>>>13;for(H=2*I;H<N;++H)O[H]=0;n(V===0),n((V&-8192)===0)},_.prototype.stub=function(F){for(var I=new Array(F),O=0;O<F;O++)I[O]=0;return I},_.prototype.mulp=function(F,I,O){var N=2*this.guessLen13b(F.length,I.length),V=this.makeRBT(N),H=this.stub(N),j=new Array(N),Z=new Array(N),X=new Array(N),re=new Array(N),ue=new Array(N),K=new Array(N),te=O.words;te.length=N,this.convert13b(F.words,F.length,j,N),this.convert13b(I.words,I.length,re,N),this.transform(j,H,Z,X,N,V),this.transform(re,H,ue,K,N,V);for(var G=0;G<N;G++){var Y=Z[G]*ue[G]-X[G]*K[G];X[G]=Z[G]*K[G]+X[G]*ue[G],Z[G]=Y}return this.conjugate(Z,X,N),this.transform(Z,X,te,H,N,V),this.conjugate(te,H,N),this.normalize13b(te,N),O.negative=F.negative^I.negative,O.length=F.length+I.length,O.strip()},r.prototype.mul=function(F){var I=new r(null);return I.words=new Array(this.length+F.length),this.mulTo(F,I)},r.prototype.mulf=function(F){var I=new r(null);return I.words=new Array(this.length+F.length),M(this,F,I)},r.prototype.imul=function(F){return this.clone().mulTo(F,this)},r.prototype.imuln=function(F){n(typeof F=="number"),n(F<67108864);for(var I=0,O=0;O<this.length;O++){var N=(this.words[O]|0)*F,V=(N&67108863)+(I&67108863);I>>=26,I+=N/67108864|0,I+=V>>>26,this.words[O]=V&67108863}return I!==0&&(this.words[O]=I,this.length++),this},r.prototype.muln=function(F){return this.clone().imuln(F)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this.clone())},r.prototype.pow=function(F){var I=x(F);if(I.length===0)return new r(1);for(var O=this,N=0;N<I.length&&I[N]===0;N++,O=O.sqr());if(++N<I.length)for(var V=O.sqr();N<I.length;N++,V=V.sqr())I[N]!==0&&(O=O.mul(V));return O},r.prototype.iushln=function(F){n(typeof F=="number"&&F>=0);var I=F%26,O=(F-I)/26,N=67108863>>>26-I<<26-I,V;if(I!==0){var H=0;for(V=0;V<this.length;V++){var j=this.words[V]&N,Z=(this.words[V]|0)-j<<I;this.words[V]=Z|H,H=j>>>26-I}H&&(this.words[V]=H,this.length++)}if(O!==0){for(V=this.length-1;V>=0;V--)this.words[V+O]=this.words[V];for(V=0;V<O;V++)this.words[V]=0;this.length+=O}return this.strip()},r.prototype.ishln=function(F){return n(this.negative===0),this.iushln(F)},r.prototype.iushrn=function(F,I,O){n(typeof F=="number"&&F>=0);var N;I?N=(I-I%26)/26:N=0;var V=F%26,H=Math.min((F-V)/26,this.length),j=67108863^67108863>>>V<<V,Z=O;if(N-=H,N=Math.max(0,N),Z){for(var X=0;X<H;X++)Z.words[X]=this.words[X];Z.length=H}if(H!==0)if(this.length>H)for(this.length-=H,X=0;X<this.length;X++)this.words[X]=this.words[X+H];else this.words[0]=0,this.length=1;var re=0;for(X=this.length-1;X>=0&&(re!==0||X>=N);X--){var ue=this.words[X]|0;this.words[X]=re<<26-V|ue>>>V,re=ue&j}return Z&&re!==0&&(Z.words[Z.length++]=re),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},r.prototype.ishrn=function(F,I,O){return n(this.negative===0),this.iushrn(F,I,O)},r.prototype.shln=function(F){return this.clone().ishln(F)},r.prototype.ushln=function(F){return this.clone().iushln(F)},r.prototype.shrn=function(F){return this.clone().ishrn(F)},r.prototype.ushrn=function(F){return this.clone().iushrn(F)},r.prototype.testn=function(F){n(typeof F=="number"&&F>=0);var I=F%26,O=(F-I)/26,N=1<<I;if(this.length<=O)return!1;var V=this.words[O];return!!(V&N)},r.prototype.imaskn=function(F){n(typeof F=="number"&&F>=0);var I=F%26,O=(F-I)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=O)return this;if(I!==0&&O++,this.length=Math.min(O,this.length),I!==0){var N=67108863^67108863>>>I<<I;this.words[this.length-1]&=N}return this.strip()},r.prototype.maskn=function(F){return this.clone().imaskn(F)},r.prototype.iaddn=function(F){return n(typeof F=="number"),n(F<67108864),F<0?this.isubn(-F):this.negative!==0?this.length===1&&(this.words[0]|0)<F?(this.words[0]=F-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(F),this.negative=1,this):this._iaddn(F)},r.prototype._iaddn=function(F){this.words[0]+=F;for(var I=0;I<this.length&&this.words[I]>=67108864;I++)this.words[I]-=67108864,I===this.length-1?this.words[I+1]=1:this.words[I+1]++;return this.length=Math.max(this.length,I+1),this},r.prototype.isubn=function(F){if(n(typeof F=="number"),n(F<67108864),F<0)return this.iaddn(-F);if(this.negative!==0)return this.negative=0,this.iaddn(F),this.negative=1,this;if(this.words[0]-=F,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var I=0;I<this.length&&this.words[I]<0;I++)this.words[I]+=67108864,this.words[I+1]-=1;return this.strip()},r.prototype.addn=function(F){return this.clone().iaddn(F)},r.prototype.subn=function(F){return this.clone().isubn(F)},r.prototype.iabs=function(){return this.negative=0,this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype._ishlnsubmul=function(F,I,O){var N=F.length+O,V;this._expand(N);var H,j=0;for(V=0;V<F.length;V++){H=(this.words[V+O]|0)+j;var Z=(F.words[V]|0)*I;H-=Z&67108863,j=(H>>26)-(Z/67108864|0),this.words[V+O]=H&67108863}for(;V<this.length-O;V++)H=(this.words[V+O]|0)+j,j=H>>26,this.words[V+O]=H&67108863;if(j===0)return this.strip();for(n(j===-1),j=0,V=0;V<this.length;V++)H=-(this.words[V]|0)+j,j=H>>26,this.words[V]=H&67108863;return this.negative=1,this.strip()},r.prototype._wordDiv=function(F,I){var O=this.length-F.length,N=this.clone(),V=F,H=V.words[V.length-1]|0,j=this._countBits(H);O=26-j,O!==0&&(V=V.ushln(O),N.iushln(O),H=V.words[V.length-1]|0);var Z=N.length-V.length,X;if(I!=="mod"){X=new r(null),X.length=Z+1,X.words=new Array(X.length);for(var re=0;re<X.length;re++)X.words[re]=0}var ue=N.clone()._ishlnsubmul(V,1,Z);ue.negative===0&&(N=ue,X&&(X.words[Z]=1));for(var K=Z-1;K>=0;K--){var te=(N.words[V.length+K]|0)*67108864+(N.words[V.length+K-1]|0);for(te=Math.min(te/H|0,67108863),N._ishlnsubmul(V,te,K);N.negative!==0;)te--,N.negative=0,N._ishlnsubmul(V,1,K),N.isZero()||(N.negative^=1);X&&(X.words[K]=te)}return X&&X.strip(),N.strip(),I!=="div"&&O!==0&&N.iushrn(O),{div:X||null,mod:N}},r.prototype.divmod=function(F,I,O){if(n(!F.isZero()),this.isZero())return{div:new r(0),mod:new r(0)};var N,V,H;return this.negative!==0&&F.negative===0?(H=this.neg().divmod(F,I),I!=="mod"&&(N=H.div.neg()),I!=="div"&&(V=H.mod.neg(),O&&V.negative!==0&&V.iadd(F)),{div:N,mod:V}):this.negative===0&&F.negative!==0?(H=this.divmod(F.neg(),I),I!=="mod"&&(N=H.div.neg()),{div:N,mod:H.mod}):(this.negative&F.negative)!==0?(H=this.neg().divmod(F.neg(),I),I!=="div"&&(V=H.mod.neg(),O&&V.negative!==0&&V.isub(F)),{div:H.div,mod:V}):F.length>this.length||this.cmp(F)<0?{div:new r(0),mod:this}:F.length===1?I==="div"?{div:this.divn(F.words[0]),mod:null}:I==="mod"?{div:null,mod:new r(this.modn(F.words[0]))}:{div:this.divn(F.words[0]),mod:new r(this.modn(F.words[0]))}:this._wordDiv(F,I)},r.prototype.div=function(F){return this.divmod(F,"div",!1).div},r.prototype.mod=function(F){return this.divmod(F,"mod",!1).mod},r.prototype.umod=function(F){return this.divmod(F,"mod",!0).mod},r.prototype.divRound=function(F){var I=this.divmod(F);if(I.mod.isZero())return I.div;var O=I.div.negative!==0?I.mod.isub(F):I.mod,N=F.ushrn(1),V=F.andln(1),H=O.cmp(N);return H<0||V===1&&H===0?I.div:I.div.negative!==0?I.div.isubn(1):I.div.iaddn(1)},r.prototype.modn=function(F){n(F<=67108863);for(var I=(1<<26)%F,O=0,N=this.length-1;N>=0;N--)O=(I*O+(this.words[N]|0))%F;return O},r.prototype.idivn=function(F){n(F<=67108863);for(var I=0,O=this.length-1;O>=0;O--){var N=(this.words[O]|0)+I*67108864;this.words[O]=N/F|0,I=N%F}return this.strip()},r.prototype.divn=function(F){return this.clone().idivn(F)},r.prototype.egcd=function(F){n(F.negative===0),n(!F.isZero());var I=this,O=F.clone();I.negative!==0?I=I.umod(F):I=I.clone();for(var N=new r(1),V=new r(0),H=new r(0),j=new r(1),Z=0;I.isEven()&&O.isEven();)I.iushrn(1),O.iushrn(1),++Z;for(var X=O.clone(),re=I.clone();!I.isZero();){for(var ue=0,K=1;(I.words[0]&K)===0&&ue<26;++ue,K<<=1);if(ue>0)for(I.iushrn(ue);ue-- >0;)(N.isOdd()||V.isOdd())&&(N.iadd(X),V.isub(re)),N.iushrn(1),V.iushrn(1);for(var te=0,G=1;(O.words[0]&G)===0&&te<26;++te,G<<=1);if(te>0)for(O.iushrn(te);te-- >0;)(H.isOdd()||j.isOdd())&&(H.iadd(X),j.isub(re)),H.iushrn(1),j.iushrn(1);I.cmp(O)>=0?(I.isub(O),N.isub(H),V.isub(j)):(O.isub(I),H.isub(N),j.isub(V))}return{a:H,b:j,gcd:O.iushln(Z)}},r.prototype._invmp=function(F){n(F.negative===0),n(!F.isZero());var I=this,O=F.clone();I.negative!==0?I=I.umod(F):I=I.clone();for(var N=new r(1),V=new r(0),H=O.clone();I.cmpn(1)>0&&O.cmpn(1)>0;){for(var j=0,Z=1;(I.words[0]&Z)===0&&j<26;++j,Z<<=1);if(j>0)for(I.iushrn(j);j-- >0;)N.isOdd()&&N.iadd(H),N.iushrn(1);for(var X=0,re=1;(O.words[0]&re)===0&&X<26;++X,re<<=1);if(X>0)for(O.iushrn(X);X-- >0;)V.isOdd()&&V.iadd(H),V.iushrn(1);I.cmp(O)>=0?(I.isub(O),N.isub(V)):(O.isub(I),V.isub(N))}var ue;return I.cmpn(1)===0?ue=N:ue=V,ue.cmpn(0)<0&&ue.iadd(F),ue},r.prototype.gcd=function(F){if(this.isZero())return F.abs();if(F.isZero())return this.abs();var I=this.clone(),O=F.clone();I.negative=0,O.negative=0;for(var N=0;I.isEven()&&O.isEven();N++)I.iushrn(1),O.iushrn(1);do{for(;I.isEven();)I.iushrn(1);for(;O.isEven();)O.iushrn(1);var V=I.cmp(O);if(V<0){var H=I;I=O,O=H}else if(V===0||O.cmpn(1)===0)break;I.isub(O)}while(!0);return O.iushln(N)},r.prototype.invm=function(F){return this.egcd(F).a.umod(F)},r.prototype.isEven=function(){return(this.words[0]&1)===0},r.prototype.isOdd=function(){return(this.words[0]&1)===1},r.prototype.andln=function(F){return this.words[0]&F},r.prototype.bincn=function(F){n(typeof F=="number");var I=F%26,O=(F-I)/26,N=1<<I;if(this.length<=O)return this._expand(O+1),this.words[O]|=N,this;for(var V=N,H=O;V!==0&&H<this.length;H++){var j=this.words[H]|0;j+=V,V=j>>>26,j&=67108863,this.words[H]=j}return V!==0&&(this.words[H]=V,this.length++),this},r.prototype.isZero=function(){return this.length===1&&this.words[0]===0},r.prototype.cmpn=function(F){var I=F<0;if(this.negative!==0&&!I)return-1;if(this.negative===0&&I)return 1;this.strip();var O;if(this.length>1)O=1;else{I&&(F=-F),n(F<=67108863,"Number is too big");var N=this.words[0]|0;O=N===F?0:N<F?-1:1}return this.negative!==0?-O|0:O},r.prototype.cmp=function(F){if(this.negative!==0&&F.negative===0)return-1;if(this.negative===0&&F.negative!==0)return 1;var I=this.ucmp(F);return this.negative!==0?-I|0:I},r.prototype.ucmp=function(F){if(this.length>F.length)return 1;if(this.length<F.length)return-1;for(var I=0,O=this.length-1;O>=0;O--){var N=this.words[O]|0,V=F.words[O]|0;if(N!==V){N<V?I=-1:N>V&&(I=1);break}}return I},r.prototype.gtn=function(F){return this.cmpn(F)===1},r.prototype.gt=function(F){return this.cmp(F)===1},r.prototype.gten=function(F){return this.cmpn(F)>=0},r.prototype.gte=function(F){return this.cmp(F)>=0},r.prototype.ltn=function(F){return this.cmpn(F)===-1},r.prototype.lt=function(F){return this.cmp(F)===-1},r.prototype.lten=function(F){return this.cmpn(F)<=0},r.prototype.lte=function(F){return this.cmp(F)<=0},r.prototype.eqn=function(F){return this.cmpn(F)===0},r.prototype.eq=function(F){return this.cmp(F)===0},r.red=function(F){return new k(F)},r.prototype.toRed=function(F){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),F.convertTo(this)._forceRed(F)},r.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},r.prototype._forceRed=function(F){return this.red=F,this},r.prototype.forceRed=function(F){return n(!this.red,"Already a number in reduction context"),this._forceRed(F)},r.prototype.redAdd=function(F){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,F)},r.prototype.redIAdd=function(F){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,F)},r.prototype.redSub=function(F){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,F)},r.prototype.redISub=function(F){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,F)},r.prototype.redShl=function(F){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,F)},r.prototype.redMul=function(F){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,F),this.red.mul(this,F)},r.prototype.redIMul=function(F){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,F),this.red.imul(this,F)},r.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},r.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},r.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},r.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},r.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},r.prototype.redPow=function(F){return n(this.red&&!F.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,F)};var y={k256:null,p224:null,p192:null,p25519:null};function w(z,F){this.name=z,this.p=new r(F,16),this.n=this.p.bitLength(),this.k=new r(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}w.prototype._tmp=function(){var F=new r(null);return F.words=new Array(Math.ceil(this.n/13)),F},w.prototype.ireduce=function(F){var I=F,O;do this.split(I,this.tmp),I=this.imulK(I),I=I.iadd(this.tmp),O=I.bitLength();while(O>this.n);var N=O<this.n?-1:I.ucmp(this.p);return N===0?(I.words[0]=0,I.length=1):N>0?I.isub(this.p):I.strip!==void 0?I.strip():I._strip(),I},w.prototype.split=function(F,I){F.iushrn(this.n,0,I)},w.prototype.imulK=function(F){return F.imul(this.k)};function d(){w.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(d,w),d.prototype.split=function(F,I){for(var O=4194303,N=Math.min(F.length,9),V=0;V<N;V++)I.words[V]=F.words[V];if(I.length=N,F.length<=9){F.words[0]=0,F.length=1;return}var H=F.words[9];for(I.words[I.length++]=H&O,V=10;V<F.length;V++){var j=F.words[V]|0;F.words[V-10]=(j&O)<<4|H>>>22,H=j}H>>>=22,F.words[V-10]=H,H===0&&F.length>10?F.length-=10:F.length-=9},d.prototype.imulK=function(F){F.words[F.length]=0,F.words[F.length+1]=0,F.length+=2;for(var I=0,O=0;O<F.length;O++){var N=F.words[O]|0;I+=N*977,F.words[O]=I&67108863,I=N*64+(I/67108864|0)}return F.words[F.length-1]===0&&(F.length--,F.words[F.length-1]===0&&F.length--),F};function C(){w.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(C,w);function S(){w.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(S,w);function E(){w.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(E,w),E.prototype.imulK=function(F){for(var I=0,O=0;O<F.length;O++){var N=(F.words[O]|0)*19+I,V=N&67108863;N>>>=26,F.words[O]=V,I=N}return I!==0&&(F.words[F.length++]=I),F},r._prime=function(F){if(y[F])return y[F];var I;if(F==="k256")I=new d;else if(F==="p224")I=new C;else if(F==="p192")I=new S;else if(F==="p25519")I=new E;else throw new Error("Unknown prime "+F);return y[F]=I,I};function k(z){if(typeof z=="string"){var F=r._prime(z);this.m=F.p,this.prime=F}else n(z.gtn(1),"modulus must be greater than 1"),this.m=z,this.prime=null}k.prototype._verify1=function(F){n(F.negative===0,"red works only with positives"),n(F.red,"red works only with red numbers")},k.prototype._verify2=function(F,I){n((F.negative|I.negative)===0,"red works only with positives"),n(F.red&&F.red===I.red,"red works only with red numbers")},k.prototype.imod=function(F){return this.prime?this.prime.ireduce(F)._forceRed(this):F.umod(this.m)._forceRed(this)},k.prototype.neg=function(F){return F.isZero()?F.clone():this.m.sub(F)._forceRed(this)},k.prototype.add=function(F,I){this._verify2(F,I);var O=F.add(I);return O.cmp(this.m)>=0&&O.isub(this.m),O._forceRed(this)},k.prototype.iadd=function(F,I){this._verify2(F,I);var O=F.iadd(I);return O.cmp(this.m)>=0&&O.isub(this.m),O},k.prototype.sub=function(F,I){this._verify2(F,I);var O=F.sub(I);return O.cmpn(0)<0&&O.iadd(this.m),O._forceRed(this)},k.prototype.isub=function(F,I){this._verify2(F,I);var O=F.isub(I);return O.cmpn(0)<0&&O.iadd(this.m),O},k.prototype.shl=function(F,I){return this._verify1(F),this.imod(F.ushln(I))},k.prototype.imul=function(F,I){return this._verify2(F,I),this.imod(F.imul(I))},k.prototype.mul=function(F,I){return this._verify2(F,I),this.imod(F.mul(I))},k.prototype.isqr=function(F){return this.imul(F,F.clone())},k.prototype.sqr=function(F){return this.mul(F,F)},k.prototype.sqrt=function(F){if(F.isZero())return F.clone();var I=this.m.andln(3);if(n(I%2===1),I===3){var O=this.m.add(new r(1)).iushrn(2);return this.pow(F,O)}for(var N=this.m.subn(1),V=0;!N.isZero()&&N.andln(1)===0;)V++,N.iushrn(1);n(!N.isZero());var H=new r(1).toRed(this),j=H.redNeg(),Z=this.m.subn(1).iushrn(1),X=this.m.bitLength();for(X=new r(2*X*X).toRed(this);this.pow(X,Z).cmp(j)!==0;)X.redIAdd(j);for(var re=this.pow(X,N),ue=this.pow(F,N.addn(1).iushrn(1)),K=this.pow(F,N),te=V;K.cmp(H)!==0;){for(var G=K,Y=0;G.cmp(H)!==0;Y++)G=G.redSqr();n(Y<te);var ee=this.pow(re,new r(1).iushln(te-Y-1));ue=ue.redMul(ee),re=ee.redSqr(),K=K.redMul(re),te=Y}return ue},k.prototype.invm=function(F){var I=F._invmp(this.m);return I.negative!==0?(I.negative=0,this.imod(I).redNeg()):this.imod(I)},k.prototype.pow=function(F,I){if(I.isZero())return new r(1).toRed(this);if(I.cmpn(1)===0)return F.clone();var O=4,N=new Array(1<<O);N[0]=new r(1).toRed(this),N[1]=F;for(var V=2;V<N.length;V++)N[V]=this.mul(N[V-1],F);var H=N[0],j=0,Z=0,X=I.bitLength()%26;for(X===0&&(X=26),V=I.length-1;V>=0;V--){for(var re=I.words[V],ue=X-1;ue>=0;ue--){var K=re>>ue&1;if(H!==N[0]&&(H=this.sqr(H)),K===0&&j===0){Z=0;continue}j<<=1,j|=K,Z++,!(Z!==O&&(V!==0||ue!==0))&&(H=this.mul(H,N[j]),Z=0,j=0)}X=26}return H},k.prototype.convertTo=function(F){var I=F.umod(this.m);return I===F?I.clone():I},k.prototype.convertFrom=function(F){var I=F.clone();return I.red=null,I},r.mont=function(F){return new B(F)};function B(z){k.call(this,z),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new r(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}a(B,k),B.prototype.convertTo=function(F){return this.imod(F.ushln(this.shift))},B.prototype.convertFrom=function(F){var I=this.imod(F.mul(this.rinv));return I.red=null,I},B.prototype.imul=function(F,I){if(F.isZero()||I.isZero())return F.words[0]=0,F.length=1,F;var O=F.imul(I),N=O.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),V=O.isub(N).iushrn(this.shift),H=V;return V.cmp(this.m)>=0?H=V.isub(this.m):V.cmpn(0)<0&&(H=V.iadd(this.m)),H._forceRed(this)},B.prototype.mul=function(F,I){if(F.isZero()||I.isZero())return new r(0)._forceRed(this);var O=F.mul(I),N=O.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),V=O.isub(N).iushrn(this.shift),H=V;return V.cmp(this.m)>=0?H=V.isub(this.m):V.cmpn(0)<0&&(H=V.iadd(this.m)),H._forceRed(this)},B.prototype.invm=function(F){var I=this.imod(F._invmp(this.m).mul(this.r2));return I._forceRed(this)}})(typeof A>"u"||A,this)},{buffer:2}],34:[function(u,A,T){A.exports=e;function e(i){var n,a,r,f=i.length,o=0;for(n=0;n<f;++n)o+=i[n].length;var s=new Array(o),m=0;for(n=0;n<f;++n){var g=i[n],p=g.length;for(a=0;a<p;++a){var v=s[m++]=new Array(p-1),x=0;for(r=0;r<p;++r)r!==a&&(v[x++]=g[r]);if(a&1){var l=v[1];v[1]=v[0],v[0]=l}}}return s}},{}],35:[function(u,A,T){A.exports=p;var e=u("typedarray-pool"),i=u("./lib/sweep"),n=u("./lib/intersect");function a(v,x){for(var l=0;l<v;++l)if(!(x[l]<=x[l+v]))return!0;return!1}function r(v,x,l,b){for(var c=0,M=0,_=0,y=v.length;_<y;++_){var w=v[_];if(!a(x,w)){for(var d=0;d<2*x;++d)l[c++]=w[d];b[M++]=_}}return M}function f(v,x,l,b){var c=v.length,M=x.length;if(!(c<=0||M<=0)){var _=v[0].length>>>1;if(!(_<=0)){var y,w=e.mallocDouble(2*_*c),d=e.mallocInt32(c);if(c=r(v,_,w,d),c>0){if(_===1&&b)i.init(c),y=i.sweepComplete(_,l,0,c,w,d,0,c,w,d);else{var C=e.mallocDouble(2*_*M),S=e.mallocInt32(M);M=r(x,_,C,S),M>0&&(i.init(c+M),_===1?y=i.sweepBipartite(_,l,0,c,w,d,0,M,C,S):y=n(_,l,b,c,w,d,M,C,S),e.free(C),e.free(S))}e.free(w),e.free(d)}return y}}}var o;function s(v,x){o.push([v,x])}function m(v){return o=[],f(v,v,s,!0),o}function g(v,x){return o=[],f(v,x,s,!1),o}function p(v,x,l){switch(arguments.length){case 1:return m(v);case 2:return typeof x=="function"?f(v,v,x,!0):g(v,x);case 3:return f(v,x,l,!1);default:throw new Error("box-intersect: Invalid arguments")}}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(u,A,T){function e(){function a(o,s,m,g,p,v,x,l,b,c,M){for(var _=2*o,y=g,w=_*g;y<p;++y,w+=_){var d=v[s+w],C=v[s+w+o],S=x[y];e:for(var E=l,k=_*l;E<b;++E,k+=_){var B=c[s+k],z=c[s+k+o],F=M[E];if(!(z<d||C<B)){for(var I=s+1;I<o;++I){var O=v[I+w],N=v[I+o+w],V=c[I+k],H=c[I+o+k];if(N<V||H<O)continue e}var j=m(S,F);if(j!==void 0)return j}}}}function r(o,s,m,g,p,v,x,l,b,c,M){for(var _=2*o,y=l,w=_*l;y<b;++y,w+=_){var d=c[s+w],C=c[s+w+o],S=M[y];e:for(var E=g,k=_*g;E<p;++E,k+=_){var B=v[s+k],z=v[s+k+o],F=x[E];if(!(C<B||z<d)){for(var I=s+1;I<o;++I){var O=v[I+k],N=v[I+o+k],V=c[I+w],H=c[I+o+w];if(N<V||H<O)continue e}var j=m(F,S);if(j!==void 0)return j}}}}function f(o,s,m,g,p,v,x,l,b,c,M){return p-g>b-l?a(o,s,m,g,p,v,x,l,b,c,M):r(o,s,m,g,p,v,x,l,b,c,M)}return f}function i(){function a(m,g,p,v,x,l,b,c,M,_,y){for(var w=2*m,d=v,C=w*v;d<x;++d,C+=w){var S=l[g+C],E=l[g+C+m],k=b[d];e:for(var B=c,z=w*c;B<M;++B,z+=w){var F=_[g+z],I=y[B];if(!(F<=S||E<F)){for(var O=g+1;O<m;++O){var N=l[O+C],V=l[O+m+C],H=_[O+z],j=_[O+m+z];if(V<H||j<N)continue e}var Z=p(I,k);if(Z!==void 0)return Z}}}}function r(m,g,p,v,x,l,b,c,M,_,y){for(var w=2*m,d=v,C=w*v;d<x;++d,C+=w){var S=l[g+C],E=l[g+C+m],k=b[d];e:for(var B=c,z=w*c;B<M;++B,z+=w){var F=_[g+z],I=y[B];if(!(F<S||E<F)){for(var O=g+1;O<m;++O){var N=l[O+C],V=l[O+m+C],H=_[O+z],j=_[O+m+z];if(V<H||j<N)continue e}var Z=p(k,I);if(Z!==void 0)return Z}}}}function f(m,g,p,v,x,l,b,c,M,_,y){for(var w=2*m,d=c,C=w*c;d<M;++d,C+=w){var S=_[g+C],E=y[d];e:for(var k=v,B=w*v;k<x;++k,B+=w){var z=l[g+B],F=l[g+B+m],I=b[k];if(!(S<=z||F<S)){for(var O=g+1;O<m;++O){var N=l[O+B],V=l[O+m+B],H=_[O+C],j=_[O+m+C];if(V<H||j<N)continue e}var Z=p(E,I);if(Z!==void 0)return Z}}}}function o(m,g,p,v,x,l,b,c,M,_,y){for(var w=2*m,d=c,C=w*c;d<M;++d,C+=w){var S=_[g+C],E=y[d];e:for(var k=v,B=w*v;k<x;++k,B+=w){var z=l[g+B],F=l[g+B+m],I=b[k];if(!(S<z||F<S)){for(var O=g+1;O<m;++O){var N=l[O+B],V=l[O+m+B],H=_[O+C],j=_[O+m+C];if(V<H||j<N)continue e}var Z=p(I,E);if(Z!==void 0)return Z}}}}function s(m,g,p,v,x,l,b,c,M,_,y,w){return l-x>_-M?v?a(m,g,p,x,l,b,c,M,_,y,w):r(m,g,p,x,l,b,c,M,_,y,w):v?f(m,g,p,x,l,b,c,M,_,y,w):o(m,g,p,x,l,b,c,M,_,y,w)}return s}function n(a){return a?e():i()}T.partial=n(!1),T.full=n(!0)},{}],37:[function(u,A,T){A.exports=z;var e=u("typedarray-pool"),i=u("bit-twiddle"),n=u("./brute"),a=n.partial,r=n.full,f=u("./sweep"),o=u("./median"),s=u("./partition"),m=128,g=1<<22,p=1<<22,v=s("!(lo>=p0)&&!(p1>=hi)"),x=s("lo===p0"),l=s("lo<p0"),b=s("hi<=p0"),c=s("lo<=p0&&p0<=hi"),M=s("lo<p0&&p0<=hi"),_=6,y=2,w=1024,d=e.mallocInt32(w),C=e.mallocDouble(w);function S(F,I){var O=8*i.log2(I+1)*(F+1)|0,N=i.nextPow2(_*O);d.length<N&&(e.free(d),d=e.mallocInt32(N));var V=i.nextPow2(y*O);C.length<V&&(e.free(C),C=e.mallocDouble(V))}function E(F,I,O,N,V,H,j,Z,X){var re=_*F;d[re]=I,d[re+1]=O,d[re+2]=N,d[re+3]=V,d[re+4]=H,d[re+5]=j;var ue=y*F;C[ue]=Z,C[ue+1]=X}function k(F,I,O,N,V,H,j,Z,X,re,ue){var K=2*F,te=X*K,G=re[te+I];e:for(var Y=V,ee=V*K;Y<H;++Y,ee+=K){var ne=j[ee+I],J=j[ee+I+F];if(!(G<ne||J<G)&&!(N&&G===ne)){for(var q=Z[Y],ae=I+1;ae<F;++ae){var ne=j[ee+ae],J=j[ee+ae+F],le=re[te+ae],ie=re[te+ae+F];if(J<le||ie<ne)continue e}var se;if(N?se=O(ue,q):se=O(q,ue),se!==void 0)return se}}}function B(F,I,O,N,V,H,j,Z,X,re){var ue=2*F,K=Z*ue,te=X[K+I];e:for(var G=N,Y=N*ue;G<V;++G,Y+=ue){var ee=j[G];if(ee!==re){var ne=H[Y+I],J=H[Y+I+F];if(!(te<ne||J<te)){for(var q=I+1;q<F;++q){var ne=H[Y+q],J=H[Y+q+F],ae=X[K+q],le=X[K+q+F];if(J<ae||le<ne)continue e}var ie=O(ee,re);if(ie!==void 0)return ie}}}}function z(F,I,O,N,V,H,j,Z,X){S(F,N+j);var re=0,ue=2*F,K;for(E(re++,0,0,N,0,j,O?16:0,-1/0,1/0),O||E(re++,0,0,j,0,N,1,-1/0,1/0);re>0;){re-=1;var te=re*_,G=d[te],Y=d[te+1],ee=d[te+2],ne=d[te+3],J=d[te+4],q=d[te+5],ae=re*y,le=C[ae],ie=C[ae+1],se=q&1,xe=!!(q&16),oe=V,he=H,be=Z,me=X;if(se&&(oe=Z,he=X,be=V,me=H),!(q&2&&(ee=l(F,G,Y,ee,oe,he,ie),Y>=ee))&&!(q&4&&(Y=b(F,G,Y,ee,oe,he,le),Y>=ee))){var _e=ee-Y,Se=J-ne;if(xe){if(F*_e*(_e+Se)<p){if(K=f.scanComplete(F,G,I,Y,ee,oe,he,ne,J,be,me),K!==void 0)return K;continue}}else if(F*Math.min(_e,Se)<m){if(K=a(F,G,I,se,Y,ee,oe,he,ne,J,be,me),K!==void 0)return K;continue}else if(F*_e*Se<g){if(K=f.scanBipartite(F,G,I,se,Y,ee,oe,he,ne,J,be,me),K!==void 0)return K;continue}var De=v(F,G,Y,ee,oe,he,le,ie);if(Y<De)if(F*(De-Y)<m){if(K=r(F,G+1,I,Y,De,oe,he,ne,J,be,me),K!==void 0)return K}else if(G===F-2){if(se?K=f.sweepBipartite(F,I,ne,J,be,me,Y,De,oe,he):K=f.sweepBipartite(F,I,Y,De,oe,he,ne,J,be,me),K!==void 0)return K}else E(re++,G+1,Y,De,ne,J,se,-1/0,1/0),E(re++,G+1,ne,J,Y,De,se^1,-1/0,1/0);if(De<ee){var Ie=o(F,G,ne,J,be,me),Te=be[ue*Ie+G],Ce=x(F,G,Ie,J,be,me,Te);if(Ce<J&&E(re++,G,De,ee,Ce,J,(se|4)+(xe?16:0),Te,ie),ne<Ie&&E(re++,G,De,ee,ne,Ie,(se|2)+(xe?16:0),le,Te),Ie+1===Ce){if(xe?K=B(F,G,I,De,ee,oe,he,Ie,be,me[Ie]):K=k(F,G,I,se,De,ee,oe,he,Ie,be,me[Ie]),K!==void 0)return K}else if(Ie<Ce){var He;if(xe){if(He=c(F,G,De,ee,oe,he,Te),De<He){var Xe=x(F,G,De,He,oe,he,Te);if(G===F-2){if(De<Xe&&(K=f.sweepComplete(F,I,De,Xe,oe,he,Ie,Ce,be,me),K!==void 0)||Xe<He&&(K=f.sweepBipartite(F,I,Xe,He,oe,he,Ie,Ce,be,me),K!==void 0))return K}else De<Xe&&E(re++,G+1,De,Xe,Ie,Ce,16,-1/0,1/0),Xe<He&&(E(re++,G+1,Xe,He,Ie,Ce,0,-1/0,1/0),E(re++,G+1,Ie,Ce,Xe,He,1,-1/0,1/0))}}else se?He=M(F,G,De,ee,oe,he,Te):He=c(F,G,De,ee,oe,he,Te),De<He&&(G===F-2?se?K=f.sweepBipartite(F,I,Ie,Ce,be,me,De,He,oe,he):K=f.sweepBipartite(F,I,De,He,oe,he,Ie,Ce,be,me):(E(re++,G+1,De,He,Ie,Ce,se,-1/0,1/0),E(re++,G+1,Ie,Ce,De,He,se^1,-1/0,1/0)))}}}}}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(u,A,T){A.exports=r;var e=u("./partition"),i=e("lo<p0"),n=8;function a(f,o,s,m,g,p){for(var v=2*f,x=v*(s+1)+o,l=s+1;l<m;++l,x+=v)for(var b=g[x],c=l,M=v*(l-1);c>s&&g[M+o]>b;--c,M-=v){for(var _=M,y=M+v,w=0;w<v;++w,++_,++y){var d=g[_];g[_]=g[y],g[y]=d}var C=p[c];p[c]=p[c-1],p[c-1]=C}}function r(f,o,s,m,g,p){if(m<=s+1)return s;for(var v=s,x=m,l=m+s>>>1,b=2*f,c=l,M=g[b*l+o];v<x;){if(x-v<n){a(f,o,v,x,g,p),M=g[b*l+o];break}var _=x-v,y=Math.random()*_+v|0,w=g[b*y+o],d=Math.random()*_+v|0,C=g[b*d+o],S=Math.random()*_+v|0,E=g[b*S+o];w<=C?E>=C?(c=d,M=C):w>=E?(c=y,M=w):(c=S,M=E):C>=E?(c=d,M=C):E>=w?(c=y,M=w):(c=S,M=E);for(var z=b*(x-1),F=b*c,k=0;k<b;++k,++z,++F){var B=g[z];g[z]=g[F],g[F]=B}var I=p[x-1];p[x-1]=p[c],p[c]=I,c=i(f,o,v,x-1,g,p,M);for(var z=b*(x-1),F=b*c,k=0;k<b;++k,++z,++F){var B=g[z];g[z]=g[F],g[F]=B}var I=p[x-1];if(p[x-1]=p[c],p[c]=I,l<c){for(x=c-1;v<x&&g[b*(x-1)+o]===M;)x-=1;x+=1}else if(c<l)for(v=c+1;v<x&&g[b*v+o]===M;)v+=1;else break}return i(f,o,s,l,g,p,g[b*l+o])}},{"./partition":39}],39:[function(u,A,T){A.exports=i;var e={"lo===p0":n,"lo<p0":a,"lo<=p0":r,"hi<=p0":f,"lo<p0&&p0<=hi":s,"lo<=p0&&p0<=hi":o,"!(lo>=p0)&&!(p1>=hi)":m};function i(g){return e[g]}function n(g,p,v,x,l,b,c){for(var M=2*g,_=M*v,y=_,w=v,d=p,C=g+p,S=v;x>S;++S,_+=M){var E=l[_+d];if(E===c)if(w===S)w+=1,y+=M;else{for(var k=0;M>k;++k){var B=l[_+k];l[_+k]=l[y],l[y++]=B}var z=b[S];b[S]=b[w],b[w++]=z}}return w}function a(g,p,v,x,l,b,c){for(var M=2*g,_=M*v,y=_,w=v,d=p,C=g+p,S=v;x>S;++S,_+=M){var E=l[_+d];if(E<c)if(w===S)w+=1,y+=M;else{for(var k=0;M>k;++k){var B=l[_+k];l[_+k]=l[y],l[y++]=B}var z=b[S];b[S]=b[w],b[w++]=z}}return w}function r(g,p,v,x,l,b,c){for(var M=2*g,_=M*v,y=_,w=v,d=p,C=g+p,S=v;x>S;++S,_+=M){var E=l[_+C];if(E<=c)if(w===S)w+=1,y+=M;else{for(var k=0;M>k;++k){var B=l[_+k];l[_+k]=l[y],l[y++]=B}var z=b[S];b[S]=b[w],b[w++]=z}}return w}function f(g,p,v,x,l,b,c){for(var M=2*g,_=M*v,y=_,w=v,d=p,C=g+p,S=v;x>S;++S,_+=M){var E=l[_+C];if(E<=c)if(w===S)w+=1,y+=M;else{for(var k=0;M>k;++k){var B=l[_+k];l[_+k]=l[y],l[y++]=B}var z=b[S];b[S]=b[w],b[w++]=z}}return w}function o(g,p,v,x,l,b,c){for(var M=2*g,_=M*v,y=_,w=v,d=p,C=g+p,S=v;x>S;++S,_+=M){var E=l[_+d],k=l[_+C];if(E<=c&&c<=k)if(w===S)w+=1,y+=M;else{for(var B=0;M>B;++B){var z=l[_+B];l[_+B]=l[y],l[y++]=z}var F=b[S];b[S]=b[w],b[w++]=F}}return w}function s(g,p,v,x,l,b,c){for(var M=2*g,_=M*v,y=_,w=v,d=p,C=g+p,S=v;x>S;++S,_+=M){var E=l[_+d],k=l[_+C];if(E<c&&c<=k)if(w===S)w+=1,y+=M;else{for(var B=0;M>B;++B){var z=l[_+B];l[_+B]=l[y],l[y++]=z}var F=b[S];b[S]=b[w],b[w++]=F}}return w}function m(g,p,v,x,l,b,c,M){for(var _=2*g,y=_*v,w=y,d=v,C=p,S=g+p,E=v;x>E;++E,y+=_){var k=l[y+C],B=l[y+S];if(!(k>=c)&&!(M>=B))if(d===E)d+=1,w+=_;else{for(var z=0;_>z;++z){var F=l[y+z];l[y+z]=l[w],l[w++]=F}var I=b[E];b[E]=b[d],b[d++]=I}}return d}},{}],40:[function(u,A,T){A.exports=i;var e=32;function i(p,v){v<=4*e?n(0,v-1,p):g(0,v-1,p)}function n(p,v,x){for(var l=2*(p+1),b=p+1;b<=v;++b){for(var c=x[l++],M=x[l++],_=b,y=l-2;_-- >p;){var w=x[y-2],d=x[y-1];if(w<c)break;if(w===c&&d<M)break;x[y]=w,x[y+1]=d,y-=2}x[y]=c,x[y+1]=M}}function a(p,v,x){p*=2,v*=2;var l=x[p],b=x[p+1];x[p]=x[v],x[p+1]=x[v+1],x[v]=l,x[v+1]=b}function r(p,v,x){p*=2,v*=2,x[p]=x[v],x[p+1]=x[v+1]}function f(p,v,x,l){p*=2,v*=2,x*=2;var b=l[p],c=l[p+1];l[p]=l[v],l[p+1]=l[v+1],l[v]=l[x],l[v+1]=l[x+1],l[x]=b,l[x+1]=c}function o(p,v,x,l,b){p*=2,v*=2,b[p]=b[v],b[v]=x,b[p+1]=b[v+1],b[v+1]=l}function s(p,v,x){p*=2,v*=2;var l=x[p],b=x[v];return l<b?!1:l===b?x[p+1]>x[v+1]:!0}function m(p,v,x,l){p*=2;var b=l[p];return b<v?!0:b===v?l[p+1]<x:!1}function g(p,v,x){var l=(v-p+1)/6|0,b=p+l,c=v-l,M=p+v>>1,_=M-l,y=M+l,w=b,d=_,C=M,S=y,E=c,k=p+1,B=v-1,z=0;s(w,d,x)&&(z=w,w=d,d=z),s(S,E,x)&&(z=S,S=E,E=z),s(w,C,x)&&(z=w,w=C,C=z),s(d,C,x)&&(z=d,d=C,C=z),s(w,S,x)&&(z=w,w=S,S=z),s(C,S,x)&&(z=C,C=S,S=z),s(d,E,x)&&(z=d,d=E,E=z),s(d,C,x)&&(z=d,d=C,C=z),s(S,E,x)&&(z=S,S=E,E=z);for(var F=x[2*d],I=x[2*d+1],O=x[2*S],N=x[2*S+1],V=2*w,H=2*C,j=2*E,Z=2*b,X=2*M,re=2*c,ue=0;ue<2;++ue){var K=x[V+ue],te=x[H+ue],G=x[j+ue];x[Z+ue]=K,x[X+ue]=te,x[re+ue]=G}r(_,p,x),r(y,v,x);for(var Y=k;Y<=B;++Y)if(m(Y,F,I,x))Y!==k&&a(Y,k,x),++k;else if(!m(Y,O,N,x))for(;;)if(m(B,O,N,x)){m(B,F,I,x)?(f(Y,k,B,x),++k,--B):(a(Y,B,x),--B);break}else{if(--B<Y)break;continue}o(p,k-1,F,I,x),o(v,B+1,O,N,x),k-2-p<=e?n(p,k-2,x):g(p,k-2,x),v-(B+2)<=e?n(B+2,v,x):g(B+2,v,x),B-k<=e?n(k,B,x):g(k,B,x)}},{}],41:[function(u,A,T){A.exports={init:x,sweepBipartite:c,sweepComplete:M,scanBipartite:_,scanComplete:y};var e=u("typedarray-pool"),i=u("bit-twiddle"),n=u("./sort"),a=1<<28,r=1024,f=e.mallocInt32(r),o=e.mallocInt32(r),s=e.mallocInt32(r),m=e.mallocInt32(r),g=e.mallocInt32(r),p=e.mallocInt32(r),v=e.mallocDouble(r*8);function x(w){var d=i.nextPow2(w);f.length<d&&(e.free(f),f=e.mallocInt32(d)),o.length<d&&(e.free(o),o=e.mallocInt32(d)),s.length<d&&(e.free(s),s=e.mallocInt32(d)),m.length<d&&(e.free(m),m=e.mallocInt32(d)),g.length<d&&(e.free(g),g=e.mallocInt32(d)),p.length<d&&(e.free(p),p=e.mallocInt32(d));var C=8*d;v.length<C&&(e.free(v),v=e.mallocDouble(C))}function l(w,d,C,S){var E=d[S],k=w[C-1];w[E]=k,d[k]=E}function b(w,d,C,S){w[C]=S,d[S]=C}function c(w,d,C,S,E,k,B,z,F,I){for(var O=0,N=2*w,V=w-1,H=N-1,j=C;j<S;++j){var Z=k[j],X=N*j;v[O++]=E[X+V],v[O++]=-(Z+1),v[O++]=E[X+H],v[O++]=Z}for(var j=B;j<z;++j){var Z=I[j]+a,re=N*j;v[O++]=F[re+V],v[O++]=-Z,v[O++]=F[re+H],v[O++]=Z}var ue=O>>>1;n(v,ue);for(var K=0,te=0,j=0;j<ue;++j){var G=v[2*j+1]|0;if(G>=a)G=G-a|0,l(s,m,te--,G);else if(G>=0)l(f,o,K--,G);else if(G<=-a){G=-G-a|0;for(var Y=0;Y<K;++Y){var ee=d(f[Y],G);if(ee!==void 0)return ee}b(s,m,te++,G)}else{G=-G-1|0;for(var Y=0;Y<te;++Y){var ee=d(G,s[Y]);if(ee!==void 0)return ee}b(f,o,K++,G)}}}function M(w,d,C,S,E,k,B,z,F,I){for(var O=0,N=2*w,V=w-1,H=N-1,j=C;j<S;++j){var Z=k[j]+1<<1,X=N*j;v[O++]=E[X+V],v[O++]=-Z,v[O++]=E[X+H],v[O++]=Z}for(var j=B;j<z;++j){var Z=I[j]+1<<1,re=N*j;v[O++]=F[re+V],v[O++]=-Z|1,v[O++]=F[re+H],v[O++]=Z|1}var ue=O>>>1;n(v,ue);for(var K=0,te=0,G=0,j=0;j<ue;++j){var Y=v[2*j+1]|0,ee=Y&1;if(j<ue-1&&Y>>1===v[2*j+3]>>1&&(ee=2,j+=1),Y<0){for(var ne=-(Y>>1)-1,J=0;J<G;++J){var q=d(g[J],ne);if(q!==void 0)return q}if(ee!==0)for(var J=0;J<K;++J){var q=d(f[J],ne);if(q!==void 0)return q}if(ee!==1)for(var J=0;J<te;++J){var q=d(s[J],ne);if(q!==void 0)return q}ee===0?b(f,o,K++,ne):ee===1?b(s,m,te++,ne):ee===2&&b(g,p,G++,ne)}else{var ne=(Y>>1)-1;ee===0?l(f,o,K--,ne):ee===1?l(s,m,te--,ne):ee===2&&l(g,p,G--,ne)}}}function _(w,d,C,S,E,k,B,z,F,I,O,N){var V=0,H=2*w,j=d,Z=d+w,X=1,re=1;S?re=a:X=a;for(var ue=E;ue<k;++ue){var K=ue+X,te=H*ue;v[V++]=B[te+j],v[V++]=-K,v[V++]=B[te+Z],v[V++]=K}for(var ue=F;ue<I;++ue){var K=ue+re,G=H*ue;v[V++]=O[G+j],v[V++]=-K}var Y=V>>>1;n(v,Y);for(var ee=0,ue=0;ue<Y;++ue){var ne=v[2*ue+1]|0;if(ne<0){var K=-ne,J=!1;if(K>=a?(J=!S,K-=a):(J=!!S,K-=1),J)b(f,o,ee++,K);else{var q=N[K],ae=H*K,le=O[ae+d+1],ie=O[ae+d+1+w];e:for(var se=0;se<ee;++se){var xe=f[se],oe=H*xe;if(!(ie<B[oe+d+1]||B[oe+d+1+w]<le)){for(var he=d+2;he<w;++he)if(O[ae+he+w]<B[oe+he]||B[oe+he+w]<O[ae+he])continue e;var be=z[xe],me;if(S?me=C(q,be):me=C(be,q),me!==void 0)return me}}}}else l(f,o,ee--,ne-X)}}function y(w,d,C,S,E,k,B,z,F,I,O){for(var N=0,V=2*w,H=d,j=d+w,Z=S;Z<E;++Z){var X=Z+a,re=V*Z;v[N++]=k[re+H],v[N++]=-X,v[N++]=k[re+j],v[N++]=X}for(var Z=z;Z<F;++Z){var X=Z+1,ue=V*Z;v[N++]=I[ue+H],v[N++]=-X}var K=N>>>1;n(v,K);for(var te=0,Z=0;Z<K;++Z){var G=v[2*Z+1]|0;if(G<0){var X=-G;if(X>=a)f[te++]=X-a;else{X-=1;var Y=O[X],ee=V*X,ne=I[ee+d+1],J=I[ee+d+1+w];e:for(var q=0;q<te;++q){var ae=f[q],le=B[ae];if(le===Y)break;var ie=V*ae;if(!(J<k[ie+d+1]||k[ie+d+1+w]<ne)){for(var se=d+2;se<w;++se)if(I[ee+se+w]<k[ie+se]||k[ie+se+w]<I[ee+se])continue e;var xe=C(le,Y);if(xe!==void 0)return xe}}}}else{for(var X=G-a,q=te-1;q>=0;--q)if(f[q]===X){for(var se=q+1;se<te;++se)f[se-1]=f[se];break}--te}}}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(u,A,T){var e=u("./lib/monotone"),i=u("./lib/triangulation"),n=u("./lib/delaunay"),a=u("./lib/filter");A.exports=m;function r(g){return[Math.min(g[0],g[1]),Math.max(g[0],g[1])]}function f(g,p){return g[0]-p[0]||g[1]-p[1]}function o(g){return g.map(r).sort(f)}function s(g,p,v){return p in g?g[p]:v}function m(g,p,v){Array.isArray(p)?(v=v||{},p=p||[]):(v=p||{},p=[]);var x=!!s(v,"delaunay",!0),l=!!s(v,"interior",!0),b=!!s(v,"exterior",!0),c=!!s(v,"infinity",!1);if(!l&&!b||g.length===0)return[];var M=e(g,p);if(x||l!==b||c){for(var _=i(g.length,o(p)),y=0;y<M.length;++y){var w=M[y];_.addTriangle(w[0],w[1],w[2])}return x&&n(g,_),b?l?c?a(_,0,c):_.cells():a(_,1,c):a(_,-1)}else return M}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(u,A,T){var e=u("robust-in-sphere")[4];u("binary-search-bounds"),A.exports=n;function i(a,r,f,o,s,m){var g=r.opposite(o,s);if(!(g<0)){if(s<o){var p=o;o=s,s=p,p=m,m=g,g=p}r.isConstraint(o,s)||e(a[o],a[s],a[m],a[g])<0&&f.push(o,s)}}function n(a,r){for(var f=[],o=a.length,s=r.stars,m=0;m<o;++m)for(var g=s[m],p=1;p<g.length;p+=2){var v=g[p];if(!(v<m)&&!r.isConstraint(m,v)){for(var x=g[p-1],l=-1,b=1;b<g.length;b+=2)if(g[b-1]===v){l=g[b];break}l<0||e(a[m],a[v],a[x],a[l])<0&&f.push(m,v)}}for(;f.length>0;){for(var v=f.pop(),m=f.pop(),x=-1,l=-1,g=s[m],c=1;c<g.length;c+=2){var M=g[c-1],_=g[c];M===v?l=_:_===v&&(x=M)}x<0||l<0||e(a[m],a[v],a[x],a[l])>=0||(r.flip(m,v),i(a,r,f,x,m,l),i(a,r,f,m,l,x),i(a,r,f,l,v,x),i(a,r,f,v,x,l))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(u,A,T){var e=u("binary-search-bounds");A.exports=o;function i(s,m,g,p,v,x,l){this.cells=s,this.neighbor=m,this.flags=p,this.constraint=g,this.active=v,this.next=x,this.boundary=l}var n=i.prototype;function a(s,m){return s[0]-m[0]||s[1]-m[1]||s[2]-m[2]}n.locate=function(){var s=[0,0,0];return function(m,g,p){var v=m,x=g,l=p;return g<p?g<m&&(v=g,x=p,l=m):p<m&&(v=p,x=m,l=g),v<0?-1:(s[0]=v,s[1]=x,s[2]=l,e.eq(this.cells,s,a))}}();function r(s,m){for(var g=s.cells(),p=g.length,v=0;v<p;++v){var x=g[v],l=x[0],b=x[1],c=x[2];b<c?b<l&&(x[0]=b,x[1]=c,x[2]=l):c<l&&(x[0]=c,x[1]=l,x[2]=b)}g.sort(a);for(var M=new Array(p),v=0;v<M.length;++v)M[v]=0;var _=[],y=[],w=new Array(3*p),d=new Array(3*p),C=null;m&&(C=[]);for(var S=new i(g,w,d,M,_,y,C),v=0;v<p;++v)for(var x=g[v],E=0;E<3;++E){var l=x[E],b=x[(E+1)%3],k=w[3*v+E]=S.locate(b,l,s.opposite(b,l)),B=d[3*v+E]=s.isConstraint(l,b);k<0&&(B?y.push(v):(_.push(v),M[v]=1),m&&C.push([b,l,-1]))}return S}function f(s,m,g){for(var p=0,v=0;v<s.length;++v)m[v]===g&&(s[p++]=s[v]);return s.length=p,s}function o(s,m,g){var p=r(s,g);if(m===0)return g?p.cells.concat(p.boundary):p.cells;for(var v=1,x=p.active,l=p.next,b=p.flags,c=p.cells,M=p.constraint,_=p.neighbor;x.length>0||l.length>0;){for(;x.length>0;){var y=x.pop();if(b[y]!==-v){b[y]=v,c[y];for(var w=0;w<3;++w){var d=_[3*y+w];d>=0&&b[d]===0&&(M[3*y+w]?l.push(d):(x.push(d),b[d]=v))}}}var C=l;l=x,x=C,l.length=0,v=-v}var S=f(c,b,m);return g?S.concat(p.boundary):S}},{"binary-search-bounds":31}],45:[function(u,A,T){var e=u("binary-search-bounds"),i=u("robust-orientation")[3],n=0,a=1,r=2;A.exports=l;function f(b,c,M,_,y){this.a=b,this.b=c,this.idx=M,this.lowerIds=_,this.upperIds=y}function o(b,c,M,_){this.a=b,this.b=c,this.type=M,this.idx=_}function s(b,c){var M=b.a[0]-c.a[0]||b.a[1]-c.a[1]||b.type-c.type;return M||b.type!==n&&(M=i(b.a,b.b,c.b),M)?M:b.idx-c.idx}function m(b,c){return i(b.a,b.b,c)}function g(b,c,M,_,y){for(var w=e.lt(c,_,m),d=e.gt(c,_,m),C=w;C<d;++C){for(var S=c[C],E=S.lowerIds,B=E.length;B>1&&i(M[E[B-2]],M[E[B-1]],_)>0;)b.push([E[B-1],E[B-2],y]),B-=1;E.length=B,E.push(y);for(var k=S.upperIds,B=k.length;B>1&&i(M[k[B-2]],M[k[B-1]],_)<0;)b.push([k[B-2],k[B-1],y]),B-=1;k.length=B,k.push(y)}}function p(b,c){var M;return b.a[0]<c.a[0]?M=i(b.a,b.b,c.a):M=i(c.b,c.a,b.a),M||(c.b[0]<b.b[0]?M=i(b.a,b.b,c.b):M=i(c.b,c.a,b.b),M||b.idx-c.idx)}function v(b,c,M){var _=e.le(b,M,p),y=b[_],w=y.upperIds,d=w[w.length-1];y.upperIds=[d],b.splice(_+1,0,new f(M.a,M.b,M.idx,[d],w))}function x(b,c,M){var _=M.a;M.a=M.b,M.b=_;var y=e.eq(b,M,p),w=b[y],d=b[y-1];d.upperIds=w.upperIds,b.splice(y,1)}function l(b,c){for(var M=b.length,_=c.length,y=[],w=0;w<M;++w)y.push(new o(b[w],null,n,w));for(var w=0;w<_;++w){var d=c[w],C=b[d[0]],S=b[d[1]];C[0]<S[0]?y.push(new o(C,S,r,w),new o(S,C,a,w)):C[0]>S[0]&&y.push(new o(S,C,r,w),new o(C,S,a,w))}y.sort(s);for(var E=y[0].a[0]-(1+Math.abs(y[0].a[0]))*Math.pow(2,-52),k=[new f([E,1],[E,0],-1,[],[])],B=[],w=0,z=y.length;w<z;++w){var F=y[w],I=F.type;I===n?g(B,k,b,F.a,F.idx):I===r?v(k,b,F):x(k,b,F)}return B}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(u,A,T){var e=u("binary-search-bounds");A.exports=r;function i(f,o){this.stars=f,this.edges=o}var n=i.prototype;function a(f,o,s){for(var m=1,g=f.length;m<g;m+=2)if(f[m-1]===o&&f[m]===s){f[m-1]=f[g-2],f[m]=f[g-1],f.length=g-2;return}}n.isConstraint=function(){var f=[0,0];function o(s,m){return s[0]-m[0]||s[1]-m[1]}return function(s,m){return f[0]=Math.min(s,m),f[1]=Math.max(s,m),e.eq(this.edges,f,o)>=0}}(),n.removeTriangle=function(f,o,s){var m=this.stars;a(m[f],o,s),a(m[o],s,f),a(m[s],f,o)},n.addTriangle=function(f,o,s){var m=this.stars;m[f].push(o,s),m[o].push(s,f),m[s].push(f,o)},n.opposite=function(f,o){for(var s=this.stars[o],m=1,g=s.length;m<g;m+=2)if(s[m]===f)return s[m-1];return-1},n.flip=function(f,o){var s=this.opposite(f,o),m=this.opposite(o,f);this.removeTriangle(f,o,s),this.removeTriangle(o,f,m),this.addTriangle(f,m,s),this.addTriangle(o,s,m)},n.edges=function(){for(var f=this.stars,o=[],s=0,m=f.length;s<m;++s)for(var g=f[s],p=0,v=g.length;p<v;p+=2)o.push([g[p],g[p+1]]);return o},n.cells=function(){for(var f=this.stars,o=[],s=0,m=f.length;s<m;++s)for(var g=f[s],p=0,v=g.length;p<v;p+=2){var x=g[p],l=g[p+1];s<Math.min(x,l)&&o.push([s,x,l])}return o};function r(f,o){for(var s=new Array(f),m=0;m<f;++m)s[m]=[];return new i(s,o)}},{"binary-search-bounds":31}],47:[function(u,A,T){A.exports=e;function e(i){for(var n=1,a=1;a<i.length;++a)for(var r=0;r<a;++r)if(i[a]<i[r])n=-n;else if(i[r]===i[a])return 0;return n}},{}],48:[function(u,A,T){var e=u("dup"),i=u("robust-linear-solve");function n(f,o){for(var s=0,m=f.length,g=0;g<m;++g)s+=f[g]*o[g];return s}function a(f){var o=f.length;if(o===0)return[];f[0].length;var s=e([f.length+1,f.length+1],1),m=e([f.length+1],1);s[o][o]=0;for(var g=0;g<o;++g){for(var p=0;p<=g;++p)s[p][g]=s[g][p]=2*n(f[g],f[p]);m[g]=n(f[g],f[g])}for(var v=i(s,m),x=0,l=v[o+1],g=0;g<l.length;++g)x+=l[g];for(var b=new Array(o),g=0;g<o;++g){for(var l=v[g],c=0,p=0;p<l.length;++p)c+=l[p];b[g]=c/x}return b}function r(f){if(f.length===0)return[];for(var o=f[0].length,s=e([o]),m=a(f),g=0;g<f.length;++g)for(var p=0;p<o;++p)s[p]+=f[g][p]*m[g];return s}r.barycenetric=a,A.exports=r},{dup:65,"robust-linear-solve":283}],49:[function(u,A,T){A.exports=i;var e=u("circumcenter");function i(n){for(var a=e(n),r=0,f=0;f<n.length;++f)for(var o=n[f],s=0;s<a.length;++s)r+=Math.pow(o[s]-a[s],2);return Math.sqrt(r/n.length)}},{circumcenter:48}],50:[function(u,A,T){A.exports=C;var e=u("union-find"),i=u("box-intersect"),n=u("robust-segment-intersect"),a=u("big-rat"),r=u("big-rat/cmp"),f=u("big-rat/to-float"),o=u("rat-vec"),s=u("nextafter"),m=u("./lib/rat-seg-intersect");function g(S){var E=f(S);return[s(E,-1/0),s(E,1/0)]}function p(S,E){for(var k=new Array(E.length),B=0;B<E.length;++B){var z=E[B],F=S[z[0]],I=S[z[1]];k[B]=[s(Math.min(F[0],I[0]),-1/0),s(Math.min(F[1],I[1]),-1/0),s(Math.max(F[0],I[0]),1/0),s(Math.max(F[1],I[1]),1/0)]}return k}function v(S){for(var E=new Array(S.length),k=0;k<S.length;++k){var B=S[k];E[k]=[s(B[0],-1/0),s(B[1],-1/0),s(B[0],1/0),s(B[1],1/0)]}return E}function x(S,E,k){var B=[];return i(k,function(z,F){var I=E[z],O=E[F];if(!(I[0]===O[0]||I[0]===O[1]||I[1]===O[0]||I[1]===O[1])){var N=S[I[0]],V=S[I[1]],H=S[O[0]],j=S[O[1]];n(N,V,H,j)&&B.push([z,F])}}),B}function l(S,E,k,B){var z=[];return i(k,B,function(F,I){var O=E[F];if(!(O[0]===I||O[1]===I)){var N=S[I],V=S[O[0]],H=S[O[1]];n(V,H,N,N)&&z.push([F,I])}}),z}function b(S,E,k,B,z){var F,I,O=S.map(function(ae){return[a(ae[0]),a(ae[1])]});for(F=0;F<k.length;++F){var N=k[F];I=N[0];var V=N[1],H=E[I],j=E[V],Z=m(o(S[H[0]]),o(S[H[1]]),o(S[j[0]]),o(S[j[1]]));if(!!Z){var X=S.length;S.push([f(Z[0]),f(Z[1])]),O.push(Z),B.push([I,X],[V,X])}}for(B.sort(function(ae,le){if(ae[0]!==le[0])return ae[0]-le[0];var ie=O[ae[1]],se=O[le[1]];return r(ie[0],se[0])||r(ie[1],se[1])}),F=B.length-1;F>=0;--F){var re=B[F];I=re[0];var ue=E[I],K=ue[0],te=ue[1],G=S[K],Y=S[te];if((G[0]-Y[0]||G[1]-Y[1])<0){var ee=K;K=te,te=ee}ue[0]=K;var ne=ue[1]=re[1],J;for(z&&(J=ue[2]);F>0&&B[F-1][0]===I;){var re=B[--F],q=re[1];z?E.push([ne,q,J]):E.push([ne,q]),ne=q}z?E.push([ne,te,J]):E.push([ne,te])}return O}function c(S,E,k){for(var B=E.length,z=new e(B),F=[],I=0;I<E.length;++I){var O=E[I],N=g(O[0]),V=g(O[1]);F.push([s(N[0],-1/0),s(V[0],-1/0),s(N[1],1/0),s(V[1],1/0)])}i(F,function(re,ue){z.link(re,ue)});for(var H=!0,j=new Array(B),I=0;I<B;++I){var Z=z.find(I);Z!==I&&(H=!1,S[Z]=[Math.min(S[I][0],S[Z][0]),Math.min(S[I][1],S[Z][1])])}if(H)return null;for(var X=0,I=0;I<B;++I){var Z=z.find(I);Z===I?(j[I]=X,S[X++]=S[I]):j[I]=-1}S.length=X;for(var I=0;I<B;++I)j[I]<0&&(j[I]=j[z.find(I)]);return j}function M(S,E){return S[0]-E[0]||S[1]-E[1]}function _(S,E){var k=S[0]-E[0]||S[1]-E[1];return k||(S[2]<E[2]?-1:S[2]>E[2]?1:0)}function y(S,E,k){if(S.length!==0){if(E)for(var B=0;B<S.length;++B){var z=S[B],F=E[z[0]],I=E[z[1]];z[0]=Math.min(F,I),z[1]=Math.max(F,I)}else for(var B=0;B<S.length;++B){var z=S[B],F=z[0],I=z[1];z[0]=Math.min(F,I),z[1]=Math.max(F,I)}k?S.sort(_):S.sort(M);for(var O=1,B=1;B<S.length;++B){var N=S[B-1],V=S[B];V[0]===N[0]&&V[1]===N[1]&&(!k||V[2]===N[2])||(S[O++]=V)}S.length=O}}function w(S,E,k){var B=c(S,[],v(S));return y(E,B,k),!!B}function d(S,E,k){var B=p(S,E),z=x(S,E,B),F=v(S),I=l(S,E,B,F),O=b(S,E,z,I,k),N=c(S,O);return y(E,N,k),N?!0:z.length>0||I.length>0}function C(S,E,k){var B;if(k){B=E;for(var z=new Array(E.length),F=0;F<E.length;++F){var I=E[F];z[F]=[I[0],I[1],k[F]]}E=z}for(var O=w(S,E,!!k);d(S,E,!!k);)O=!0;if(!!k&&O){B.length=0,k.length=0;for(var F=0;F<E.length;++F){var I=E[F];B.push([I[0],I[1]]),k.push(I[2])}}return O}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(u,A,T){A.exports=m;var e=u("big-rat/mul"),i=u("big-rat/div"),n=u("big-rat/sub"),a=u("big-rat/sign"),r=u("rat-vec/sub"),f=u("rat-vec/add"),o=u("rat-vec/muls");function s(g,p){return n(e(g[0],p[1]),e(g[1],p[0]))}function m(g,p,v,x){var l=r(p,g),b=r(x,v),c=s(l,b);if(a(c)===0)return null;var M=r(g,v),_=s(b,M),y=i(_,c),w=o(l,y),d=f(g,w);return d}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(u,A,T){A.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(u,A,T){var e=u("./colorScale"),i=u("lerp");A.exports=n;function n(o){var s,m,g,p,v,x,l,b,y,c,M;if(o||(o={}),b=(o.nshades||72)-1,l=o.format||"hex",x=o.colormap,x||(x="jet"),typeof x=="string"){if(x=x.toLowerCase(),!e[x])throw Error(x+" not a supported colorscale");v=e[x]}else if(Array.isArray(x))v=x.slice();else throw Error("unsupported colormap option",x);if(v.length>b+1)throw new Error(x+" map requires nshades to be at least size "+v.length);Array.isArray(o.alpha)?o.alpha.length!==2?c=[1,1]:c=o.alpha.slice():typeof o.alpha=="number"?c=[o.alpha,o.alpha]:c=[1,1],s=v.map(function(C){return Math.round(C.index*b)}),c[0]=Math.min(Math.max(c[0],0),1),c[1]=Math.min(Math.max(c[1],0),1);var _=v.map(function(C,S){var E=v[S].index,k=v[S].rgb.slice();return k.length===4&&k[3]>=0&&k[3]<=1||(k[3]=c[0]+(c[1]-c[0])*E),k}),y=[];for(M=0;M<s.length-1;++M){p=s[M+1]-s[M],m=_[M],g=_[M+1];for(var w=0;w<p;w++){var d=w/p;y.push([Math.round(i(m[0],g[0],d)),Math.round(i(m[1],g[1],d)),Math.round(i(m[2],g[2],d)),i(m[3],g[3],d)])}}return y.push(v[v.length-1].rgb.concat(c[1])),l==="hex"?y=y.map(r):l==="rgbaString"?y=y.map(f):l==="float"&&(y=y.map(a)),y}function a(o){return[o[0]/255,o[1]/255,o[2]/255,o[3]]}function r(o){for(var s,m="#",g=0;g<3;++g)s=o[g],s=s.toString(16),m+=("00"+s).substr(s.length);return m}function f(o){return"rgba("+o.join(",")+")"}},{"./colorScale":52,lerp:240}],54:[function(u,A,T){A.exports=o;var e=u("robust-orientation"),i=u("signum"),n=u("two-sum"),a=u("robust-product"),r=u("robust-sum");function f(s,m,g){var p=n(s[0],-m[0]),v=n(s[1],-m[1]),x=n(g[0],-m[0]),l=n(g[1],-m[1]),b=r(a(p,x),a(v,l));return b[b.length-1]>=0}function o(s,m,g,p){var v=e(m,g,p);if(v===0){var x=i(e(s,m,g)),l=i(e(s,m,p));if(x===l){if(x===0){var b=f(s,m,g),c=f(s,m,p);return b===c?0:b?1:-1}return 0}else{if(l===0)return x>0||f(s,m,p)?-1:1;if(x===0)return l>0||f(s,m,g)?1:-1}return i(l-x)}var M=e(s,m,g);if(M>0)return v>0&&e(s,m,p)>0?1:-1;if(M<0)return v>0||e(s,m,p)>0?1:-1;var _=e(s,m,p);return _>0||f(s,m,g)?1:-1}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(u,A,T){A.exports=function(i){return i<0?-1:i>0?1:0}},{}],56:[function(u,A,T){A.exports=n;var e=Math.min;function i(a,r){return a-r}function n(a,r){var f=a.length,o=a.length-r.length;if(o)return o;switch(f){case 0:return 0;case 1:return a[0]-r[0];case 2:return a[0]+a[1]-r[0]-r[1]||e(a[0],a[1])-e(r[0],r[1]);case 3:var s=a[0]+a[1],m=r[0]+r[1];if(o=s+a[2]-(m+r[2]),o)return o;var g=e(a[0],a[1]),p=e(r[0],r[1]);return e(g,a[2])-e(p,r[2])||e(g+a[2],s)-e(p+r[2],m);case 4:var v=a[0],x=a[1],l=a[2],b=a[3],c=r[0],M=r[1],_=r[2],y=r[3];return v+x+l+b-(c+M+_+y)||e(v,x,l,b)-e(c,M,_,y,c)||e(v+x,v+l,v+b,x+l,x+b,l+b)-e(c+M,c+_,c+y,M+_,M+y,_+y)||e(v+x+l,v+x+b,v+l+b,x+l+b)-e(c+M+_,c+M+y,c+_+y,M+_+y);default:for(var w=a.slice().sort(i),d=r.slice().sort(i),C=0;C<f;++C)if(o=w[C]-d[C],o)return o;return 0}}},{}],57:[function(u,A,T){var e=u("compare-cell"),i=u("cell-orientation");A.exports=n;function n(a,r){return e(a,r)||i(a)-i(r)}},{"cell-orientation":47,"compare-cell":56}],58:[function(u,A,T){var e=u("./lib/ch1d"),i=u("./lib/ch2d"),n=u("./lib/chnd");A.exports=a;function a(r){var f=r.length;if(f===0)return[];if(f===1)return[[0]];var o=r[0].length;return o===0?[]:o===1?e(r):o===2?i(r):n(r,o)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(u,A,T){A.exports=e;function e(i){for(var n=0,a=0,r=1;r<i.length;++r)i[r][0]<i[n][0]&&(n=r),i[r][0]>i[a][0]&&(a=r);return n<a?[[n],[a]]:n>a?[[a],[n]]:[[n]]}},{}],60:[function(u,A,T){A.exports=i;var e=u("monotone-convex-hull-2d");function i(n){var a=e(n),r=a.length;if(r<=2)return[];for(var f=new Array(r),o=a[r-1],s=0;s<r;++s){var m=a[s];f[s]=[o,m],o=m}return f}},{"monotone-convex-hull-2d":246}],61:[function(u,A,T){A.exports=r;var e=u("incremental-convex-hull"),i=u("affine-hull");function n(f,o){for(var s=f.length,m=new Array(s),g=0;g<o.length;++g)m[g]=f[o[g]];for(var p=o.length,g=0;g<s;++g)o.indexOf(g)<0&&(m[p++]=f[g]);return m}function a(f,o){for(var s=f.length,m=o.length,g=0;g<s;++g)for(var p=f[g],v=0;v<p.length;++v){var x=p[v];if(x<m)p[v]=o[x];else{x=x-m;for(var l=0;l<m;++l)x>=o[l]&&(x+=1);p[v]=x}}return f}function r(f,o){try{return e(f,!0)}catch{var s=i(f);if(s.length<=o)return[];var m=n(f,s),g=e(m,!0);return a(g,s)}}},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(u,A,T){function e(n,a,r,f,o,s){var m=6*o*o-6*o,g=3*o*o-4*o+1,p=-6*o*o+6*o,v=3*o*o-2*o;if(n.length){s||(s=new Array(n.length));for(var x=n.length-1;x>=0;--x)s[x]=m*n[x]+g*a[x]+p*r[x]+v*f[x];return s}return m*n+g*a+p*r[x]+v*f}function i(n,a,r,f,o,s){var m=o-1,g=o*o,p=m*m,v=(1+2*o)*p,x=o*p,l=g*(3-2*o),b=g*m;if(n.length){s||(s=new Array(n.length));for(var c=n.length-1;c>=0;--c)s[c]=v*n[c]+x*a[c]+l*r[c]+b*f[c];return s}return v*n+x*a+l*r+b*f}A.exports=i,A.exports.derivative=e},{}],63:[function(u,A,T){var e=u("incremental-convex-hull"),i=u("uniq");A.exports=f;function n(o,s){this.point=o,this.index=s}function a(o,s){for(var m=o.point,g=s.point,p=m.length,v=0;v<p;++v){var x=g[v]-m[v];if(x)return x}return 0}function r(o,s,m){if(o===1)return m?[[-1,0]]:[];var g=s.map(function(b,c){return[b[0],c]});g.sort(function(b,c){return b[0]-c[0]});for(var p=new Array(o-1),v=1;v<o;++v){var x=g[v-1],l=g[v];p[v-1]=[x[1],l[1]]}return m&&p.push([-1,p[0][1]],[p[o-1][1],-1]),p}function f(o,s){var m=o.length;if(m===0)return[];var g=o[0].length;if(g<1)return[];if(g===1)return r(m,o,s);for(var p=new Array(m),v=1,x=0;x<m;++x){for(var l=o[x],b=new Array(g+1),c=0,M=0;M<g;++M){var _=l[M];b[M]=_,c+=_*_}b[g]=c,p[x]=new n(b,x),v=Math.max(c,v)}i(p,a),m=p.length;for(var y=new Array(m+g+1),w=new Array(m+g+1),d=(g+1)*(g+1)*v,C=new Array(g+1),x=0;x<=g;++x)C[x]=0;C[g]=d,y[0]=C.slice(),w[0]=-1;for(var x=0;x<=g;++x){var b=C.slice();b[x]=1,y[x+1]=b,w[x+1]=-1}for(var x=0;x<m;++x){var S=p[x];y[x+g+1]=S.point,w[x+g+1]=S.index}var E=e(y,!1);if(s?E=E.filter(function(k){for(var B=0,z=0;z<=g;++z){var F=w[k[z]];if(F<0&&++B>=2)return!1;k[z]=F}return!0}):E=E.filter(function(k){for(var B=0;B<=g;++B){var z=w[k[B]];if(z<0)return!1;k[B]=z}return!0}),g&1)for(var x=0;x<E.length;++x){var S=E[x],b=S[0];S[0]=S[1],S[1]=b}return E}},{"incremental-convex-hull":233,uniq:310}],64:[function(u,A,T){(function(e){(function(){var i=!1;if(typeof Float64Array<"u"){var n=new Float64Array(1),a=new Uint32Array(n.buffer);if(n[0]=1,i=!0,a[1]===1072693248){let b=function(_,y){return a[0]=_,a[1]=y,n[0]},c=function(_){return n[0]=_,a[0]},M=function(_){return n[0]=_,a[1]};var f=b,o=c,s=M;A.exports=function(y){return n[0]=y,[a[0],a[1]]},A.exports.pack=b,A.exports.lo=c,A.exports.hi=M}else if(a[0]===1072693248){let b=function(_,y){return a[1]=_,a[0]=y,n[0]},c=function(_){return n[0]=_,a[1]},M=function(_){return n[0]=_,a[0]};var m=b,g=c,p=M;A.exports=function(y){return n[0]=y,[a[1],a[0]]},A.exports.pack=b,A.exports.lo=c,A.exports.hi=M}else i=!1}if(!i){let b=function(_,y){return r.writeUInt32LE(_,0,!0),r.writeUInt32LE(y,4,!0),r.readDoubleLE(0,!0)},c=function(_){return r.writeDoubleLE(_,0,!0),r.readUInt32LE(0,!0)},M=function(_){return r.writeDoubleLE(_,0,!0),r.readUInt32LE(4,!0)};var v=b,x=c,l=M,r=new e(8);A.exports=function(y){return r.writeDoubleLE(y,0,!0),[r.readUInt32LE(0,!0),r.readUInt32LE(4,!0)]},A.exports.pack=b,A.exports.lo=c,A.exports.hi=M}A.exports.sign=function(b){return A.exports.hi(b)>>>31},A.exports.exponent=function(b){var c=A.exports.hi(b);return(c<<1>>>21)-1023},A.exports.fraction=function(b){var c=A.exports.lo(b),M=A.exports.hi(b),_=M&(1<<20)-1;return M&2146435072&&(_+=1<<20),[c,_]},A.exports.denormalized=function(b){var c=A.exports.hi(b);return!(c&2146435072)}}).call(this)}).call(this,u("buffer").Buffer)},{buffer:3}],65:[function(u,A,T){function e(a,r,f){var o=a[f]|0;if(o<=0)return[];var s=new Array(o),m;if(f===a.length-1)for(m=0;m<o;++m)s[m]=r;else for(m=0;m<o;++m)s[m]=e(a,r,f+1);return s}function i(a,r){var f,o;for(f=new Array(a),o=0;o<a;++o)f[o]=r;return f}function n(a,r){switch(typeof r>"u"&&(r=0),typeof a){case"number":if(a>0)return i(a|0,r);break;case"object":if(typeof a.length=="number")return e(a,r,0);break}return[]}A.exports=n},{}],66:[function(u,A,T){A.exports=i;var e=u("uniq");function i(n,a){var r=n.length;if(typeof a!="number"){a=0;for(var f=0;f<r;++f){var o=n[f];a=Math.max(a,o[0],o[1])}a=(a|0)+1}a=a|0;for(var s=new Array(a),f=0;f<a;++f)s[f]=[];for(var f=0;f<r;++f){var o=n[f];s[o[0]].push(o[1]),s[o[1]].push(o[0])}for(var m=0;m<a;++m)e(s[m],function(g,p){return g-p});return s}},{uniq:310}],67:[function(u,A,T){A.exports=e;function e(i,n,a){var r=n||0,f=a||1;return[[i[12]+i[0],i[13]+i[1],i[14]+i[2],i[15]+i[3]],[i[12]-i[0],i[13]-i[1],i[14]-i[2],i[15]-i[3]],[i[12]+i[4],i[13]+i[5],i[14]+i[6],i[15]+i[7]],[i[12]-i[4],i[13]-i[5],i[14]-i[6],i[15]-i[7]],[r*i[12]+i[8],r*i[13]+i[9],r*i[14]+i[10],r*i[15]+i[11]],[f*i[12]-i[8],f*i[13]-i[9],f*i[14]-i[10],f*i[15]-i[11]]]}},{}],68:[function(u,A,T){A.exports=o;var e=u("cubic-hermite"),i=u("binary-search-bounds");function n(s,m,g){return Math.min(m,Math.max(s,g))}function a(s,m,g){this.dimension=s.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var p=0;p<this.dimension;++p)this.bounds[0][p]=-1/0,this.bounds[1][p]=1/0;this._state=s.slice().reverse(),this._velocity=m.slice().reverse(),this._time=[g],this._scratch=[s.slice(),s.slice(),s.slice(),s.slice(),s.slice()]}var r=a.prototype;r.flush=function(s){var m=i.gt(this._time,s)-1;m<=0||(this._time.splice(0,m),this._state.splice(0,m*this.dimension),this._velocity.splice(0,m*this.dimension))},r.curve=function(s){var m=this._time,g=m.length,p=i.le(m,s),v=this._scratch[0],x=this._state,l=this._velocity,b=this.dimension,c=this.bounds;if(p<0)for(var M=b-1,_=0;_<b;++_,--M)v[_]=x[M];else if(p>=g-1)for(var M=x.length-1,y=s-m[g-1],_=0;_<b;++_,--M)v[_]=x[M]+y*l[M];else{for(var M=b*(p+1)-1,w=m[p],d=m[p+1],C=d-w||1,S=this._scratch[1],E=this._scratch[2],k=this._scratch[3],B=this._scratch[4],z=!0,_=0;_<b;++_,--M)S[_]=x[M],k[_]=l[M]*C,E[_]=x[M+b],B[_]=l[M+b]*C,z=z&&S[_]===E[_]&&k[_]===B[_]&&k[_]===0;if(z)for(var _=0;_<b;++_)v[_]=S[_];else e(S,k,E,B,(s-w)/C,v)}for(var F=c[0],I=c[1],_=0;_<b;++_)v[_]=n(F[_],I[_],v[_]);return v},r.dcurve=function(s){var m=this._time,g=m.length,p=i.le(m,s),v=this._scratch[0],x=this._state,l=this._velocity,b=this.dimension;if(p>=g-1){var c=x.length-1;s-m[g-1];for(var M=0;M<b;++M,--c)v[M]=l[c]}else{for(var c=b*(p+1)-1,_=m[p],y=m[p+1],w=y-_||1,d=this._scratch[1],C=this._scratch[2],S=this._scratch[3],E=this._scratch[4],k=!0,M=0;M<b;++M,--c)d[M]=x[c],S[M]=l[c]*w,C[M]=x[c+b],E[M]=l[c+b]*w,k=k&&d[M]===C[M]&&S[M]===E[M]&&S[M]===0;if(k)for(var M=0;M<b;++M)v[M]=0;else{e.derivative(d,S,C,E,(s-_)/w,v);for(var M=0;M<b;++M)v[M]/=w}}return v},r.lastT=function(){var s=this._time;return s[s.length-1]},r.stable=function(){for(var s=this._velocity,m=s.length,g=this.dimension-1;g>=0;--g)if(s[--m])return!1;return!0},r.jump=function(s){var m=this.lastT(),g=this.dimension;if(!(s<m||arguments.length!==g+1)){var p=this._state,v=this._velocity,x=p.length-this.dimension,l=this.bounds,b=l[0],c=l[1];this._time.push(m,s);for(var M=0;M<2;++M)for(var _=0;_<g;++_)p.push(p[x++]),v.push(0);this._time.push(s);for(var _=g;_>0;--_)p.push(n(b[_-1],c[_-1],arguments[_])),v.push(0)}},r.push=function(s){var m=this.lastT(),g=this.dimension;if(!(s<m||arguments.length!==g+1)){var p=this._state,v=this._velocity,x=p.length-this.dimension,l=s-m,b=this.bounds,c=b[0],M=b[1],_=l>1e-6?1/l:0;this._time.push(s);for(var y=g;y>0;--y){var w=n(c[y-1],M[y-1],arguments[y]);p.push(w),v.push((w-p[x++])*_)}}},r.set=function(s){var m=this.dimension;if(!(s<this.lastT()||arguments.length!==m+1)){var g=this._state,p=this._velocity,v=this.bounds,x=v[0],l=v[1];this._time.push(s);for(var b=m;b>0;--b)g.push(n(x[b-1],l[b-1],arguments[b])),p.push(0)}},r.move=function(s){var m=this.lastT(),g=this.dimension;if(!(s<=m||arguments.length!==g+1)){var p=this._state,v=this._velocity,x=p.length-this.dimension,l=this.bounds,b=l[0],c=l[1],M=s-m,_=M>1e-6?1/M:0;this._time.push(s);for(var y=g;y>0;--y){var w=arguments[y];p.push(n(b[y-1],c[y-1],p[x++]+w)),v.push(w*_)}}},r.idle=function(s){var m=this.lastT();if(!(s<m)){var g=this.dimension,p=this._state,v=this._velocity,x=p.length-g,l=this.bounds,b=l[0],c=l[1],M=s-m;this._time.push(s);for(var _=g-1;_>=0;--_)p.push(n(b[_],c[_],p[x]+M*v[x])),v.push(0),x+=1}};function f(s){for(var m=new Array(s),g=0;g<s;++g)m[g]=0;return m}function o(s,m,g){switch(arguments.length){case 0:return new a([0],[0],0);case 1:if(typeof s=="number"){var p=f(s);return new a(p,p,0)}else return new a(s,f(s.length),0);case 2:if(typeof m=="number"){var p=f(s.length);return new a(s,p,+m)}else g=0;case 3:if(s.length!==m.length)throw new Error("state and velocity lengths must match");return new a(s,m,g)}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(u,A,T){A.exports=M;var e=0,i=1;function n(_,y,w,d,C,S){this._color=_,this.key=y,this.value=w,this.left=d,this.right=C,this._count=S}function a(_){return new n(_._color,_.key,_.value,_.left,_.right,_._count)}function r(_,y){return new n(_,y.key,y.value,y.left,y.right,y._count)}function f(_){_._count=1+(_.left?_.left._count:0)+(_.right?_.right._count:0)}function o(_,y){this._compare=_,this.root=y}var s=o.prototype;Object.defineProperty(s,"keys",{get:function(){var _=[];return this.forEach(function(y,w){_.push(y)}),_}}),Object.defineProperty(s,"values",{get:function(){var _=[];return this.forEach(function(y,w){_.push(w)}),_}}),Object.defineProperty(s,"length",{get:function(){return this.root?this.root._count:0}}),s.insert=function(_,y){for(var w=this._compare,d=this.root,C=[],S=[];d;){var E=w(_,d.key);C.push(d),S.push(E),E<=0?d=d.left:d=d.right}C.push(new n(e,_,y,null,null,1));for(var k=C.length-2;k>=0;--k){var d=C[k];S[k]<=0?C[k]=new n(d._color,d.key,d.value,C[k+1],d.right,d._count+1):C[k]=new n(d._color,d.key,d.value,d.left,C[k+1],d._count+1)}for(var k=C.length-1;k>1;--k){var B=C[k-1],d=C[k];if(B._color===i||d._color===i)break;var z=C[k-2];if(z.left===B)if(B.left===d){var F=z.right;if(F&&F._color===e)B._color=i,z.right=r(i,F),z._color=e,k-=1;else{if(z._color=e,z.left=B.right,B._color=i,B.right=z,C[k-2]=B,C[k-1]=d,f(z),f(B),k>=3){var I=C[k-3];I.left===z?I.left=B:I.right=B}break}}else{var F=z.right;if(F&&F._color===e)B._color=i,z.right=r(i,F),z._color=e,k-=1;else{if(B.right=d.left,z._color=e,z.left=d.right,d._color=i,d.left=B,d.right=z,C[k-2]=d,C[k-1]=B,f(z),f(B),f(d),k>=3){var I=C[k-3];I.left===z?I.left=d:I.right=d}break}}else if(B.right===d){var F=z.left;if(F&&F._color===e)B._color=i,z.left=r(i,F),z._color=e,k-=1;else{if(z._color=e,z.right=B.left,B._color=i,B.left=z,C[k-2]=B,C[k-1]=d,f(z),f(B),k>=3){var I=C[k-3];I.right===z?I.right=B:I.left=B}break}}else{var F=z.left;if(F&&F._color===e)B._color=i,z.left=r(i,F),z._color=e,k-=1;else{if(B.left=d.right,z._color=e,z.right=d.left,d._color=i,d.right=B,d.left=z,C[k-2]=d,C[k-1]=B,f(z),f(B),f(d),k>=3){var I=C[k-3];I.right===z?I.right=d:I.left=d}break}}}return C[0]._color=i,new o(w,C[0])};function m(_,y){if(y.left){var w=m(_,y.left);if(w)return w}var w=_(y.key,y.value);if(w)return w;if(y.right)return m(_,y.right)}function g(_,y,w,d){var C=y(_,d.key);if(C<=0){if(d.left){var S=g(_,y,w,d.left);if(S)return S}var S=w(d.key,d.value);if(S)return S}if(d.right)return g(_,y,w,d.right)}function p(_,y,w,d,C){var S=w(_,C.key),E=w(y,C.key),k;if(S<=0&&(C.left&&(k=p(_,y,w,d,C.left),k)||E>0&&(k=d(C.key,C.value),k)))return k;if(E>0&&C.right)return p(_,y,w,d,C.right)}s.forEach=function(y,w,d){if(!!this.root)switch(arguments.length){case 1:return m(y,this.root);case 2:return g(w,this._compare,y,this.root);case 3:return this._compare(w,d)>=0?void 0:p(w,d,this._compare,y,this.root)}},Object.defineProperty(s,"begin",{get:function(){for(var _=[],y=this.root;y;)_.push(y),y=y.left;return new v(this,_)}}),Object.defineProperty(s,"end",{get:function(){for(var _=[],y=this.root;y;)_.push(y),y=y.right;return new v(this,_)}}),s.at=function(_){if(_<0)return new v(this,[]);for(var y=this.root,w=[];;){if(w.push(y),y.left){if(_<y.left._count){y=y.left;continue}_-=y.left._count}if(!_)return new v(this,w);if(_-=1,y.right){if(_>=y.right._count)break;y=y.right}else break}return new v(this,[])},s.ge=function(_){for(var y=this._compare,w=this.root,d=[],C=0;w;){var S=y(_,w.key);d.push(w),S<=0&&(C=d.length),S<=0?w=w.left:w=w.right}return d.length=C,new v(this,d)},s.gt=function(_){for(var y=this._compare,w=this.root,d=[],C=0;w;){var S=y(_,w.key);d.push(w),S<0&&(C=d.length),S<0?w=w.left:w=w.right}return d.length=C,new v(this,d)},s.lt=function(_){for(var y=this._compare,w=this.root,d=[],C=0;w;){var S=y(_,w.key);d.push(w),S>0&&(C=d.length),S<=0?w=w.left:w=w.right}return d.length=C,new v(this,d)},s.le=function(_){for(var y=this._compare,w=this.root,d=[],C=0;w;){var S=y(_,w.key);d.push(w),S>=0&&(C=d.length),S<0?w=w.left:w=w.right}return d.length=C,new v(this,d)},s.find=function(_){for(var y=this._compare,w=this.root,d=[];w;){var C=y(_,w.key);if(d.push(w),C===0)return new v(this,d);C<=0?w=w.left:w=w.right}return new v(this,[])},s.remove=function(_){var y=this.find(_);return y?y.remove():this},s.get=function(_){for(var y=this._compare,w=this.root;w;){var d=y(_,w.key);if(d===0)return w.value;d<=0?w=w.left:w=w.right}};function v(_,y){this.tree=_,this._stack=y}var x=v.prototype;Object.defineProperty(x,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(x,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),x.clone=function(){return new v(this.tree,this._stack.slice())};function l(_,y){_.key=y.key,_.value=y.value,_.left=y.left,_.right=y.right,_._color=y._color,_._count=y._count}function b(_){for(var y,w,d,C,S=_.length-1;S>=0;--S){if(y=_[S],S===0){y._color=i;return}if(w=_[S-1],w.left===y){if(d=w.right,d.right&&d.right._color===e){if(d=w.right=a(d),C=d.right=a(d.right),w.right=d.left,d.left=w,d.right=C,d._color=w._color,y._color=i,w._color=i,C._color=i,f(w),f(d),S>1){var E=_[S-2];E.left===w?E.left=d:E.right=d}_[S-1]=d;return}else if(d.left&&d.left._color===e){if(d=w.right=a(d),C=d.left=a(d.left),w.right=C.left,d.left=C.right,C.left=w,C.right=d,C._color=w._color,w._color=i,d._color=i,y._color=i,f(w),f(d),f(C),S>1){var E=_[S-2];E.left===w?E.left=C:E.right=C}_[S-1]=C;return}if(d._color===i)if(w._color===e){w._color=i,w.right=r(e,d);return}else{w.right=r(e,d);continue}else{if(d=a(d),w.right=d.left,d.left=w,d._color=w._color,w._color=e,f(w),f(d),S>1){var E=_[S-2];E.left===w?E.left=d:E.right=d}_[S-1]=d,_[S]=w,S+1<_.length?_[S+1]=y:_.push(y),S=S+2}}else{if(d=w.left,d.left&&d.left._color===e){if(d=w.left=a(d),C=d.left=a(d.left),w.left=d.right,d.right=w,d.left=C,d._color=w._color,y._color=i,w._color=i,C._color=i,f(w),f(d),S>1){var E=_[S-2];E.right===w?E.right=d:E.left=d}_[S-1]=d;return}else if(d.right&&d.right._color===e){if(d=w.left=a(d),C=d.right=a(d.right),w.left=C.right,d.right=C.left,C.right=w,C.left=d,C._color=w._color,w._color=i,d._color=i,y._color=i,f(w),f(d),f(C),S>1){var E=_[S-2];E.right===w?E.right=C:E.left=C}_[S-1]=C;return}if(d._color===i)if(w._color===e){w._color=i,w.left=r(e,d);return}else{w.left=r(e,d);continue}else{if(d=a(d),w.left=d.right,d.right=w,d._color=w._color,w._color=e,f(w),f(d),S>1){var E=_[S-2];E.right===w?E.right=d:E.left=d}_[S-1]=d,_[S]=w,S+1<_.length?_[S+1]=y:_.push(y),S=S+2}}}}x.remove=function(){var _=this._stack;if(_.length===0)return this.tree;var y=new Array(_.length),w=_[_.length-1];y[y.length-1]=new n(w._color,w.key,w.value,w.left,w.right,w._count);for(var d=_.length-2;d>=0;--d){var w=_[d];w.left===_[d+1]?y[d]=new n(w._color,w.key,w.value,y[d+1],w.right,w._count):y[d]=new n(w._color,w.key,w.value,w.left,y[d+1],w._count)}if(w=y[y.length-1],w.left&&w.right){var C=y.length;for(w=w.left;w.right;)y.push(w),w=w.right;var S=y[C-1];y.push(new n(w._color,S.key,S.value,w.left,w.right,w._count)),y[C-1].key=w.key,y[C-1].value=w.value;for(var d=y.length-2;d>=C;--d)w=y[d],y[d]=new n(w._color,w.key,w.value,w.left,y[d+1],w._count);y[C-1].left=y[C]}if(w=y[y.length-1],w._color===e){var E=y[y.length-2];E.left===w?E.left=null:E.right===w&&(E.right=null),y.pop();for(var d=0;d<y.length;++d)y[d]._count--;return new o(this.tree._compare,y[0])}else if(w.left||w.right){w.left?l(w,w.left):w.right&&l(w,w.right),w._color=i;for(var d=0;d<y.length-1;++d)y[d]._count--;return new o(this.tree._compare,y[0])}else{if(y.length===1)return new o(this.tree._compare,null);for(var d=0;d<y.length;++d)y[d]._count--;var k=y[y.length-2];b(y),k.left===w?k.left=null:k.right=null}return new o(this.tree._compare,y[0])},Object.defineProperty(x,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(x,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(x,"index",{get:function(){var _=0,y=this._stack;if(y.length===0){var w=this.tree.root;return w?w._count:0}else y[y.length-1].left&&(_=y[y.length-1].left._count);for(var d=y.length-2;d>=0;--d)y[d+1]===y[d].right&&(++_,y[d].left&&(_+=y[d].left._count));return _},enumerable:!0}),x.next=function(){var _=this._stack;if(_.length!==0){var y=_[_.length-1];if(y.right)for(y=y.right;y;)_.push(y),y=y.left;else for(_.pop();_.length>0&&_[_.length-1].right===y;)y=_[_.length-1],_.pop()}},Object.defineProperty(x,"hasNext",{get:function(){var _=this._stack;if(_.length===0)return!1;if(_[_.length-1].right)return!0;for(var y=_.length-1;y>0;--y)if(_[y-1].left===_[y])return!0;return!1}}),x.update=function(_){var y=this._stack;if(y.length===0)throw new Error("Can't update empty node!");var w=new Array(y.length),d=y[y.length-1];w[w.length-1]=new n(d._color,d.key,_,d.left,d.right,d._count);for(var C=y.length-2;C>=0;--C)d=y[C],d.left===y[C+1]?w[C]=new n(d._color,d.key,d.value,w[C+1],d.right,d._count):w[C]=new n(d._color,d.key,d.value,d.left,w[C+1],d._count);return new o(this.tree._compare,w[0])},x.prev=function(){var _=this._stack;if(_.length!==0){var y=_[_.length-1];if(y.left)for(y=y.left;y;)_.push(y),y=y.right;else for(_.pop();_.length>0&&_[_.length-1].left===y;)y=_[_.length-1],_.pop()}},Object.defineProperty(x,"hasPrev",{get:function(){var _=this._stack;if(_.length===0)return!1;if(_[_.length-1].left)return!0;for(var y=_.length-1;y>0;--y)if(_[y-1].right===_[y])return!0;return!1}});function c(_,y){return _<y?-1:_>y?1:0}function M(_){return new o(_||c,null)}},{}],70:[function(u,A,T){A.exports=y;var e=u("./lib/text.js"),i=u("./lib/lines.js"),n=u("./lib/background.js"),a=u("./lib/cube.js"),r=u("./lib/ticks.js"),f=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function o(w,d){return w[0]=d[0],w[1]=d[1],w[2]=d[2],w}function s(w){this.gl=w,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=n(w)}var m=s.prototype;m.update=function(w){w=w||{};function d(H,j,Z){if(Z in w){var X=w[Z],re=this[Z],ue;(H?Array.isArray(X)&&Array.isArray(X[0]):Array.isArray(X))?this[Z]=ue=[j(X[0]),j(X[1]),j(X[2])]:this[Z]=ue=[j(X),j(X),j(X)];for(var K=0;K<3;++K)if(ue[K]!==re[K])return!0}return!1}var C=d.bind(this,!1,Number),S=d.bind(this,!1,Boolean),E=d.bind(this,!1,String),k=d.bind(this,!0,function(H){if(Array.isArray(H)){if(H.length===3)return[+H[0],+H[1],+H[2],1];if(H.length===4)return[+H[0],+H[1],+H[2],+H[3]]}return[0,0,0,1]}),B,z=!1,F=!1;if("bounds"in w)for(var I=w.bounds,O=0;O<2;++O)for(var N=0;N<3;++N)I[O][N]!==this.bounds[O][N]&&(F=!0),this.bounds[O][N]=I[O][N];if("ticks"in w){B=w.ticks,z=!0,this.autoTicks=!1;for(var O=0;O<3;++O)this.tickSpacing[O]=0}else C("tickSpacing")&&(this.autoTicks=!0,F=!0);if(this._firstInit&&("ticks"in w||"tickSpacing"in w||(this.autoTicks=!0),F=!0,z=!0,this._firstInit=!1),F&&this.autoTicks&&(B=r.create(this.bounds,this.tickSpacing),z=!0),z){for(var O=0;O<3;++O)B[O].sort(function(j,Z){return j.x-Z.x});r.equal(B,this.ticks)?z=!1:this.ticks=B}S("tickEnable"),E("tickFont")&&(z=!0),C("tickSize"),C("tickAngle"),C("tickPad"),k("tickColor");var V=E("labels");E("labelFont")&&(V=!0),S("labelEnable"),C("labelSize"),C("labelPad"),k("labelColor"),S("lineEnable"),S("lineMirror"),C("lineWidth"),k("lineColor"),S("lineTickEnable"),S("lineTickMirror"),C("lineTickLength"),C("lineTickWidth"),k("lineTickColor"),S("gridEnable"),C("gridWidth"),k("gridColor"),S("zeroEnable"),k("zeroLineColor"),C("zeroLineWidth"),S("backgroundEnable"),k("backgroundColor"),this._text?this._text&&(V||z)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=e(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&z&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=i(this.gl,this.bounds,this.ticks))};function g(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}var p=[new g,new g,new g];function v(w,d,C,S,E){for(var k=w.primalOffset,B=w.primalMinor,z=w.mirrorOffset,F=w.mirrorMinor,I=S[d],O=0;O<3;++O)if(d!==O){var N=k,V=z,H=B,j=F;I&1<<O&&(N=z,V=k,H=F,j=B),N[O]=C[0][O],V[O]=C[1][O],E[O]>0?(H[O]=-1,j[O]=0):(H[O]=0,j[O]=1)}}var x=[0,0,0],l={model:f,view:f,projection:f,_ortho:!1};m.isOpaque=function(){return!0},m.isTransparent=function(){return!1},m.drawTransparent=function(w){};var b=0,c=[0,0,0],M=[0,0,0],_=[0,0,0];m.draw=function(w){w=w||l;for(var re=this.gl,d=w.model||f,C=w.view||f,S=w.projection||f,E=this.bounds,k=w._ortho||!1,B=a(d,C,S,E,k),z=B.cubeEdges,F=B.axis,I=C[12],O=C[13],N=C[14],V=C[15],H=k?2:1,j=H*this.pixelRatio*(S[3]*I+S[7]*O+S[11]*N+S[15]*V)/re.drawingBufferHeight,Z=0;Z<3;++Z)this.lastCubeProps.cubeEdges[Z]=z[Z],this.lastCubeProps.axis[Z]=F[Z];for(var X=p,Z=0;Z<3;++Z)v(p[Z],Z,this.bounds,z,F);for(var re=this.gl,ue=x,Z=0;Z<3;++Z)this.backgroundEnable[Z]?ue[Z]=F[Z]:ue[Z]=0;this._background.draw(d,C,S,E,ue,this.backgroundColor),this._lines.bind(d,C,S,this);for(var Z=0;Z<3;++Z){var K=[0,0,0];F[Z]>0?K[Z]=E[1][Z]:K[Z]=E[0][Z];for(var te=0;te<2;++te){var G=(Z+1+te)%3,Y=(Z+1+(te^1))%3;this.gridEnable[G]&&this._lines.drawGrid(G,Y,this.bounds,K,this.gridColor[G],this.gridWidth[G]*this.pixelRatio)}for(var te=0;te<2;++te){var G=(Z+1+te)%3,Y=(Z+1+(te^1))%3;this.zeroEnable[Y]&&Math.min(E[0][Y],E[1][Y])<=0&&Math.max(E[0][Y],E[1][Y])>=0&&this._lines.drawZero(G,Y,this.bounds,K,this.zeroLineColor[Y],this.zeroLineWidth[Y]*this.pixelRatio)}}for(var Z=0;Z<3;++Z){this.lineEnable[Z]&&this._lines.drawAxisLine(Z,this.bounds,X[Z].primalOffset,this.lineColor[Z],this.lineWidth[Z]*this.pixelRatio),this.lineMirror[Z]&&this._lines.drawAxisLine(Z,this.bounds,X[Z].mirrorOffset,this.lineColor[Z],this.lineWidth[Z]*this.pixelRatio);for(var ee=o(c,X[Z].primalMinor),ne=o(M,X[Z].mirrorMinor),J=this.lineTickLength,te=0;te<3;++te){var q=j/d[5*te];ee[te]*=J[te]*q,ne[te]*=J[te]*q}this.lineTickEnable[Z]&&this._lines.drawAxisTicks(Z,X[Z].primalOffset,ee,this.lineTickColor[Z],this.lineTickWidth[Z]*this.pixelRatio),this.lineTickMirror[Z]&&this._lines.drawAxisTicks(Z,X[Z].mirrorOffset,ne,this.lineTickColor[Z],this.lineTickWidth[Z]*this.pixelRatio)}this._lines.unbind(),this._text.bind(d,C,S,this.pixelRatio);var ae,le=.5,ie,se;function xe(Se){se=[0,0,0],se[Se]=1}function oe(Se,De,Ie){var Te=(Se+1)%3,Ce=(Se+2)%3,He=De[Te],Xe=De[Ce],Be=Ie[Te],Re=Ie[Ce];if(He>0&&Re>0){xe(Te);return}else if(He>0&&Re<0){xe(Te);return}else if(He<0&&Re>0){xe(Te);return}else if(He<0&&Re<0){xe(Te);return}else if(Xe>0&&Be>0){xe(Ce);return}else if(Xe>0&&Be<0){xe(Ce);return}else if(Xe<0&&Be>0){xe(Ce);return}else if(Xe<0&&Be<0){xe(Ce);return}}for(var Z=0;Z<3;++Z){for(var he=X[Z].primalMinor,be=X[Z].mirrorMinor,me=o(_,X[Z].primalOffset),te=0;te<3;++te)this.lineTickEnable[Z]&&(me[te]+=j*he[te]*Math.max(this.lineTickLength[te],0)/d[5*te]);var _e=[0,0,0];if(_e[Z]=1,this.tickEnable[Z]){this.tickAngle[Z]===-3600?(this.tickAngle[Z]=0,this.tickAlign[Z]="auto"):this.tickAlign[Z]=-1,ie=1,ae=[this.tickAlign[Z],le,ie],ae[0]==="auto"?ae[0]=b:ae[0]=parseInt(""+ae[0]),se=[0,0,0],oe(Z,he,be);for(var te=0;te<3;++te)me[te]+=j*he[te]*this.tickPad[te]/d[5*te];this._text.drawTicks(Z,this.tickSize[Z],this.tickAngle[Z],me,this.tickColor[Z],_e,se,ae)}if(this.labelEnable[Z]){ie=0,se=[0,0,0],this.labels[Z].length>4&&(xe(Z),ie=1),ae=[this.labelAlign[Z],le,ie],ae[0]==="auto"?ae[0]=b:ae[0]=parseInt(""+ae[0]);for(var te=0;te<3;++te)me[te]+=j*he[te]*this.labelPad[te]/d[5*te];me[Z]+=.5*(E[0][Z]+E[1][Z]),this._text.drawLabel(Z,this.labelSize[Z],this.labelAngle[Z],me,this.labelColor[Z],[0,0,0],se,ae)}}this._text.unbind()},m.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null};function y(w,d){var C=new s(w);return C.update(d),C}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(u,A,T){A.exports=f;var e=u("gl-buffer"),i=u("gl-vao"),n=u("./shaders").bg;function a(o,s,m,g){this.gl=o,this.buffer=s,this.vao=m,this.shader=g}var r=a.prototype;r.draw=function(o,s,m,g,p,v){for(var x=!1,l=0;l<3;++l)x=x||p[l];if(!!x){var b=this.gl;b.enable(b.POLYGON_OFFSET_FILL),b.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:o,view:s,projection:m,bounds:g,enable:p,colors:v},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),b.disable(b.POLYGON_OFFSET_FILL)}},r.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};function f(o){for(var s=[],m=[],g=0,p=0;p<3;++p)for(var v=(p+1)%3,x=(p+2)%3,l=[0,0,0],b=[0,0,0],c=-1;c<=1;c+=2){m.push(g,g+2,g+1,g+1,g+2,g+3),l[p]=c,b[p]=c;for(var M=-1;M<=1;M+=2){l[v]=M;for(var _=-1;_<=1;_+=2)l[x]=_,s.push(l[0],l[1],l[2],b[0],b[1],b[2]),g+=1}var y=v;v=x,x=y}var w=e(o,new Float32Array(s)),d=e(o,new Uint16Array(m),o.ELEMENT_ARRAY_BUFFER),C=i(o,[{buffer:w,type:o.FLOAT,size:3,offset:0,stride:24},{buffer:w,type:o.FLOAT,size:3,offset:12,stride:24}],d),S=n(o);return S.attributes.position.location=0,S.attributes.normal.location=1,new a(o,w,C,S)}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(u,A,T){A.exports=c;var e=u("bit-twiddle"),i=u("gl-mat4/multiply"),n=u("split-polygon"),a=u("robust-orientation"),r=new Array(16),f=new Array(8),o=new Array(8),s=new Array(3),m=[0,0,0];(function(){for(var M=0;M<8;++M)f[M]=[1,1,1,1],o[M]=[1,1,1]})();function g(M,_,y){for(var w=0;w<4;++w){M[w]=y[12+w];for(var d=0;d<3;++d)M[w]+=_[d]*y[4*d+w]}}var p=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function v(M){for(var _=0;_<p.length;++_)if(M=n.positive(M,p[_]),M.length<3)return 0;for(var y=M[0],w=y[0]/y[3],d=y[1]/y[3],C=0,_=1;_+1<M.length;++_){var S=M[_],E=M[_+1],k=S[0]/S[3],B=S[1]/S[3],z=E[0]/E[3],F=E[1]/E[3],I=k-w,O=B-d,N=z-w,V=F-d;C+=Math.abs(I*V-O*N)}return C}var x=[1,1,1],l=[0,0,0],b={cubeEdges:x,axis:l};function c(M,_,y,w,d){i(r,_,M),i(r,y,r);for(var C=0,S=0;S<2;++S){s[2]=w[S][2];for(var E=0;E<2;++E){s[1]=w[E][1];for(var k=0;k<2;++k)s[0]=w[k][0],g(f[C],s,r),C+=1}}for(var B=-1,S=0;S<8;++S){for(var z=f[S][3],F=0;F<3;++F)o[S][F]=f[S][F]/z;d&&(o[S][2]*=-1),z<0&&(B<0||o[S][2]<o[B][2])&&(B=S)}if(B<0){B=0;for(var I=0;I<3;++I){for(var O=(I+2)%3,N=(I+1)%3,V=-1,H=-1,j=0;j<2;++j){var Z=j<<I,X=Z+(j<<O)+(1-j<<N),re=Z+(1-j<<O)+(j<<N);a(o[Z],o[X],o[re],m)<0||(j?V=1:H=1)}if(V<0||H<0){H>V&&(B|=1<<I);continue}for(var j=0;j<2;++j){var Z=j<<I,X=Z+(j<<O)+(1-j<<N),re=Z+(1-j<<O)+(j<<N),ue=v([f[Z],f[X],f[re],f[Z+(1<<O)+(1<<N)]]);j?V=ue:H=ue}if(H>V){B|=1<<I;continue}}}for(var K=7^B,te=-1,S=0;S<8;++S)S===B||S===K||(te<0||o[te][1]>o[S][1])&&(te=S);for(var G=-1,S=0;S<3;++S){var Y=te^1<<S;if(!(Y===B||Y===K)){G<0&&(G=Y);var N=o[Y];N[0]<o[G][0]&&(G=Y)}}for(var ee=-1,S=0;S<3;++S){var Y=te^1<<S;if(!(Y===B||Y===K||Y===G)){ee<0&&(ee=Y);var N=o[Y];N[0]>o[ee][0]&&(ee=Y)}}var ne=x;ne[0]=ne[1]=ne[2]=0,ne[e.log2(G^te)]=te&G,ne[e.log2(te^ee)]=te&ee;var J=ee^7;J===B||J===K?(J=G^7,ne[e.log2(ee^J)]=J&ee):ne[e.log2(G^J)]=J&G;for(var q=l,ae=B,I=0;I<3;++I)ae&1<<I?q[I]=-1:q[I]=1;return b}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(u,A,T){A.exports=x;var e=u("gl-buffer"),i=u("gl-vao"),n=u("./shaders").line,a=[0,0,0],r=[0,0,0],f=[0,0,0],o=[0,0,0],s=[1,1];function m(l){return l[0]=l[1]=l[2]=0,l}function g(l,b){return l[0]=b[0],l[1]=b[1],l[2]=b[2],l}function p(l,b,c,M,_,y,w,d){this.gl=l,this.vertBuffer=b,this.vao=c,this.shader=M,this.tickCount=_,this.tickOffset=y,this.gridCount=w,this.gridOffset=d}var v=p.prototype;v.bind=function(l,b,c){this.shader.bind(),this.shader.uniforms.model=l,this.shader.uniforms.view=b,this.shader.uniforms.projection=c,s[0]=this.gl.drawingBufferWidth,s[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=s,this.vao.bind()},v.unbind=function(){this.vao.unbind()},v.drawAxisLine=function(l,b,c,M,_){var y=m(r);this.shader.uniforms.majorAxis=r,y[l]=b[1][l]-b[0][l],this.shader.uniforms.minorAxis=y;var w=g(o,c);w[l]+=b[0][l],this.shader.uniforms.offset=w,this.shader.uniforms.lineWidth=_,this.shader.uniforms.color=M;var d=m(f);d[(l+2)%3]=1,this.shader.uniforms.screenAxis=d,this.vao.draw(this.gl.TRIANGLES,6);var d=m(f);d[(l+1)%3]=1,this.shader.uniforms.screenAxis=d,this.vao.draw(this.gl.TRIANGLES,6)},v.drawAxisTicks=function(l,b,c,M,_){if(!!this.tickCount[l]){var y=m(a);y[l]=1,this.shader.uniforms.majorAxis=y,this.shader.uniforms.offset=b,this.shader.uniforms.minorAxis=c,this.shader.uniforms.color=M,this.shader.uniforms.lineWidth=_;var w=m(f);w[l]=1,this.shader.uniforms.screenAxis=w,this.vao.draw(this.gl.TRIANGLES,this.tickCount[l],this.tickOffset[l])}},v.drawGrid=function(l,b,c,M,_,y){if(!!this.gridCount[l]){var w=m(r);w[b]=c[1][b]-c[0][b],this.shader.uniforms.minorAxis=w;var d=g(o,M);d[b]+=c[0][b],this.shader.uniforms.offset=d;var C=m(a);C[l]=1,this.shader.uniforms.majorAxis=C;var S=m(f);S[l]=1,this.shader.uniforms.screenAxis=S,this.shader.uniforms.lineWidth=y,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,this.gridCount[l],this.gridOffset[l])}},v.drawZero=function(l,b,c,M,_,y){var w=m(r);this.shader.uniforms.majorAxis=w,w[l]=c[1][l]-c[0][l],this.shader.uniforms.minorAxis=w;var d=g(o,M);d[l]+=c[0][l],this.shader.uniforms.offset=d;var C=m(f);C[b]=1,this.shader.uniforms.screenAxis=C,this.shader.uniforms.lineWidth=y,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,6)},v.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()};function x(l,b,c){var M=[],_=[0,0,0],y=[0,0,0],w=[0,0,0],d=[0,0,0];M.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var C=0;C<3;++C){for(var k=M.length/3|0,S=0;S<c[C].length;++S){var E=+c[C][S].x;M.push(E,0,1,E,1,1,E,0,-1,E,0,-1,E,1,1,E,1,-1)}var z=M.length/3|0;_[C]=k,y[C]=z-k;for(var k=M.length/3|0,B=0;B<c[C].length;++B){var E=+c[C][B].x;M.push(E,0,1,E,1,1,E,0,-1,E,0,-1,E,1,1,E,1,-1)}var z=M.length/3|0;w[C]=k,d[C]=z-k}var F=e(l,new Float32Array(M)),I=i(l,[{buffer:F,type:l.FLOAT,size:3,stride:0,offset:0}]),O=n(l);return O.attributes.position.location=0,new p(l,F,I,O,y,_,d,w)}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(u,A,T){var e=u("glslify"),i=u("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),a=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);T.line=function(m){return i(m,n,a,null,[{name:"position",type:"vec3"}])};var r=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),f=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);T.text=function(m){return i(m,r,f,null,[{name:"position",type:"vec3"}])};var o=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),s=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);T.bg=function(m){return i(m,o,s,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(u,A,T){(function(e){(function(){A.exports=x;var i=u("gl-buffer"),n=u("gl-vao"),a=u("vectorize-text"),r=u("./shaders").text,f=window||e.global||{},o=f.__TEXT_CACHE||{};f.__TEXT_CACHE={};var s=3;function m(l,b,c,M){this.gl=l,this.shader=b,this.buffer=c,this.vao=M,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var g=m.prototype,p=[0,0];g.bind=function(l,b,c,M){this.vao.bind(),this.shader.bind();var _=this.shader.uniforms;_.model=l,_.view=b,_.projection=c,_.pixelScale=M,p[0]=this.gl.drawingBufferWidth,p[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=p},g.unbind=function(){this.vao.unbind()},g.update=function(l,b,c,M,_){var y=[];function w(I,O,N,V,H,j){var Z=o[N];Z||(Z=o[N]={});var X=Z[O];X||(X=Z[O]=v(O,{triangles:!0,font:N,textAlign:"center",textBaseline:"middle",lineSpacing:H,styletags:j}));for(var re=(V||12)/12,ue=X.positions,K=X.cells,te=0,G=K.length;te<G;++te)for(var Y=K[te],ee=2;ee>=0;--ee){var ne=ue[Y[ee]];y.push(re*ne[0],-re*ne[1],I)}}for(var d=[0,0,0],C=[0,0,0],S=[0,0,0],E=[0,0,0],k=1.25,B={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},z=0;z<3;++z){S[z]=y.length/s|0,w(.5*(l[0][z]+l[1][z]),b[z],c[z],12,k,B),E[z]=(y.length/s|0)-S[z],d[z]=y.length/s|0;for(var F=0;F<M[z].length;++F)!M[z][F].text||w(M[z][F].x,M[z][F].text,M[z][F].font||_,M[z][F].fontSize||12,k,B);C[z]=(y.length/s|0)-d[z]}this.buffer.update(y),this.tickOffset=d,this.tickCount=C,this.labelOffset=S,this.labelCount=E},g.drawTicks=function(l,b,c,M,_,y,w,d){!this.tickCount[l]||(this.shader.uniforms.axis=y,this.shader.uniforms.color=_,this.shader.uniforms.angle=c,this.shader.uniforms.scale=b,this.shader.uniforms.offset=M,this.shader.uniforms.alignDir=w,this.shader.uniforms.alignOpt=d,this.vao.draw(this.gl.TRIANGLES,this.tickCount[l],this.tickOffset[l]))},g.drawLabel=function(l,b,c,M,_,y,w,d){!this.labelCount[l]||(this.shader.uniforms.axis=y,this.shader.uniforms.color=_,this.shader.uniforms.angle=c,this.shader.uniforms.scale=b,this.shader.uniforms.offset=M,this.shader.uniforms.alignDir=w,this.shader.uniforms.alignOpt=d,this.vao.draw(this.gl.TRIANGLES,this.labelCount[l],this.labelOffset[l]))},g.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()};function v(l,b){try{return a(l,b)}catch(c){return console.warn('error vectorizing text:"'+l+'" error:',c),{cells:[],positions:[]}}}function x(l,b,c,M,_,y){var w=i(l),d=n(l,[{buffer:w,size:3}]),C=r(l);C.attributes.position.location=0;var S=new m(l,C,w,d);return S.update(b,c,M,_,y),S}}).call(this)}).call(this,u("_process"))},{"./shaders":74,_process:5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(u,A,T){T.create=i,T.equal=n;function e(a,r){var f=a+"",o=f.indexOf("."),s=0;o>=0&&(s=f.length-o-1);var m=Math.pow(10,s),g=Math.round(a*r*m),p=g+"";if(p.indexOf("e")>=0)return p;var v=g/m,x=g%m;g<0?(v=-Math.ceil(v)|0,x=-x|0):(v=Math.floor(v)|0,x=x|0);var l=""+v;if(g<0&&(l="-"+l),s){for(var b=""+x;b.length<s;)b="0"+b;return l+"."+b}else return l}function i(a,r){for(var f=[],o=0;o<3;++o){var s=[];.5*(a[0][o]+a[1][o]);for(var m=0;m*r[o]<=a[1][o];++m)s.push({x:m*r[o],text:e(r[o],m)});for(var m=-1;m*r[o]>=a[0][o];--m)s.push({x:m*r[o],text:e(r[o],m)});f.push(s)}return f}function n(a,r){for(var f=0;f<3;++f){if(a[f].length!==r[f].length)return!1;for(var o=0;o<a[f].length;++o){var s=a[f][o],m=r[f][o];if(s.x!==m.x||s.text!==m.text||s.font!==m.font||s.fontColor!==m.fontColor||s.fontSize!==m.fontSize||s.dx!==m.dx||s.dy!==m.dy)return!1}}return!0}},{}],77:[function(u,A,T){A.exports=b;var e=u("extract-frustum-planes"),i=u("split-polygon"),n=u("./lib/cube.js"),a=u("gl-mat4/multiply"),r=u("gl-mat4/transpose"),f=u("gl-vec4/transformMat4"),o=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),s=new Float32Array(16);function m(c,M,_){this.lo=c,this.hi=M,this.pixelsPerDataUnit=_}var g=[0,0,0,1],p=[0,0,0,1];function v(c,M,_,y,w){for(var d=0;d<3;++d){for(var C=g,S=p,E=0;E<3;++E)S[E]=C[E]=_[E];S[3]=C[3]=1,S[d]+=1,f(S,S,M),S[3]<0&&(c[d]=1/0),C[d]-=1,f(C,C,M),C[3]<0&&(c[d]=1/0);var k=(C[0]/C[3]-S[0]/S[3])*y,B=(C[1]/C[3]-S[1]/S[3])*w;c[d]=.25*Math.sqrt(k*k+B*B)}return c}var x=[new m(1/0,-1/0,1/0),new m(1/0,-1/0,1/0),new m(1/0,-1/0,1/0)],l=[0,0,0];function b(c,M,_,y,B){var d=M.model||o,C=M.view||o,S=M.projection||o,E=M._ortho||!1,k=c.bounds,B=B||n(d,C,S,k,E),z=B.axis;a(s,C,d),a(s,S,s);for(var F=x,I=0;I<3;++I)F[I].lo=1/0,F[I].hi=-1/0,F[I].pixelsPerDataUnit=1/0;var O=e(r(s,s));r(s,s);for(var N=0;N<3;++N){var V=(N+1)%3,H=(N+2)%3,j=l;e:for(var I=0;I<2;++I){var Z=[];if(z[N]<0!=!!I){j[N]=k[I][N];for(var X=0;X<2;++X){j[V]=k[X^I][V];for(var re=0;re<2;++re)j[H]=k[re^X^I][H],Z.push(j.slice())}for(var ue=E?5:4,X=ue;X===ue;++X){if(Z.length===0)continue e;Z=i.positive(Z,O[X])}for(var X=0;X<Z.length;++X)for(var H=Z[X],K=v(l,s,H,_,y),re=0;re<3;++re)F[re].lo=Math.min(F[re].lo,H[re]),F[re].hi=Math.max(F[re].hi,H[re]),re!==N&&(F[re].pixelsPerDataUnit=Math.min(F[re].pixelsPerDataUnit,Math.abs(K[re])))}}}return F}},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(u,A,T){var e=u("typedarray-pool"),i=u("ndarray-ops"),n=u("ndarray"),a=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function r(p,v,x,l,b){this.gl=p,this.type=v,this.handle=x,this.length=l,this.usage=b}var f=r.prototype;f.bind=function(){this.gl.bindBuffer(this.type,this.handle)},f.unbind=function(){this.gl.bindBuffer(this.type,null)},f.dispose=function(){this.gl.deleteBuffer(this.handle)};function o(p,v,x,l,b,c){var M=b.length*b.BYTES_PER_ELEMENT;if(c<0)return p.bufferData(v,b,l),M;if(M+c>x)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return p.bufferSubData(v,c,b),x}function s(p,v){for(var x=e.malloc(p.length,v),l=p.length,b=0;b<l;++b)x[b]=p[b];return x}function m(p,v){for(var x=1,l=v.length-1;l>=0;--l){if(v[l]!==x)return!1;x*=p[l]}return!0}f.update=function(p,v){if(typeof v!="number"&&(v=-1),this.bind(),typeof p=="object"&&typeof p.shape<"u"){var x=p.dtype;if(a.indexOf(x)<0&&(x="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var l=gl.getExtension("OES_element_index_uint");l&&x!=="uint16"?x="uint32":x="uint16"}if(x===p.dtype&&m(p.shape,p.stride))p.offset===0&&p.data.length===p.shape[0]?this.length=o(this.gl,this.type,this.length,this.usage,p.data,v):this.length=o(this.gl,this.type,this.length,this.usage,p.data.subarray(p.offset,p.shape[0]),v);else{var b=e.malloc(p.size,x),c=n(b,p.shape);i.assign(c,p),v<0?this.length=o(this.gl,this.type,this.length,this.usage,b,v):this.length=o(this.gl,this.type,this.length,this.usage,b.subarray(0,p.size),v),e.free(b)}}else if(Array.isArray(p)){var M;this.type===this.gl.ELEMENT_ARRAY_BUFFER?M=s(p,"uint16"):M=s(p,"float32"),v<0?this.length=o(this.gl,this.type,this.length,this.usage,M,v):this.length=o(this.gl,this.type,this.length,this.usage,M.subarray(0,p.length),v),e.free(M)}else if(typeof p=="object"&&typeof p.length=="number")this.length=o(this.gl,this.type,this.length,this.usage,p,v);else if(typeof p=="number"||p===void 0){if(v>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");p=p|0,p<=0&&(p=1),this.gl.bufferData(this.type,p|0,this.usage),this.length=p}else throw new Error("gl-buffer: Invalid data type")};function g(p,v,x,l){if(x=x||p.ARRAY_BUFFER,l=l||p.DYNAMIC_DRAW,x!==p.ARRAY_BUFFER&&x!==p.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(l!==p.DYNAMIC_DRAW&&l!==p.STATIC_DRAW&&l!==p.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var b=p.createBuffer(),c=new r(p,x,b,0,l);return c.update(v),c}A.exports=g},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(u,A,T){var e=u("gl-vec3");A.exports=function(n,a){var r=n.positions,f=n.vectors,o={positions:[],vertexIntensity:[],vertexIntensityBounds:n.vertexIntensityBounds,vectors:[],cells:[],coneOffset:n.coneOffset,colormap:n.colormap};if(n.positions.length===0)return a&&(a[0]=[0,0,0],a[1]=[0,0,0]),o;for(var s=0,m=1/0,g=-1/0,p=1/0,v=-1/0,x=1/0,l=-1/0,b=null,c=null,M=[],_=1/0,y=!1,w=0;w<r.length;w++){var d=r[w];m=Math.min(d[0],m),g=Math.max(d[0],g),p=Math.min(d[1],p),v=Math.max(d[1],v),x=Math.min(d[2],x),l=Math.max(d[2],l);var C=f[w];if(e.length(C)>s&&(s=e.length(C)),w){var S=2*e.distance(b,d)/(e.length(c)+e.length(C));S?(_=Math.min(_,S),y=!1):y=!0}y||(b=d,c=C),M.push(C)}var E=[m,p,x],k=[g,v,l];a&&(a[0]=E,a[1]=k),s===0&&(s=1);var B=1/s;isFinite(_)||(_=1),o.vectorScale=_;var z=n.coneSize||.5;n.absoluteConeSize&&(z=n.absoluteConeSize*B),o.coneScale=z;for(var w=0,F=0;w<r.length;w++)for(var d=r[w],I=d[0],O=d[1],N=d[2],V=M[w],H=e.length(V)*B,j=0,Z=8;j<Z;j++){o.positions.push([I,O,N,F++]),o.positions.push([I,O,N,F++]),o.positions.push([I,O,N,F++]),o.positions.push([I,O,N,F++]),o.positions.push([I,O,N,F++]),o.positions.push([I,O,N,F++]),o.vectors.push(V),o.vectors.push(V),o.vectors.push(V),o.vectors.push(V),o.vectors.push(V),o.vectors.push(V),o.vertexIntensity.push(H,H,H),o.vertexIntensity.push(H,H,H);var X=o.positions.length;o.cells.push([X-6,X-5,X-4],[X-3,X-2,X-1])}return o};var i=u("./lib/shaders");A.exports.createMesh=u("./create_mesh"),A.exports.createConeMesh=function(n,a){return A.exports.createMesh(n,a,{shaders:i,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(u,A,T){var e=u("gl-shader"),i=u("gl-buffer"),n=u("gl-vao"),a=u("gl-texture2d"),r=u("gl-mat4/multiply"),f=u("gl-mat4/invert"),o=u("ndarray"),s=u("colormap"),m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function g(M,_,y,w,d,C,S,E,k,B,z){this.gl=M,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=_,this.dirty=!0,this.triShader=y,this.pickShader=w,this.trianglePositions=d,this.triangleVectors=C,this.triangleColors=E,this.triangleUVs=k,this.triangleIds=S,this.triangleVAO=B,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=z,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=m,this._view=m,this._projection=m,this._resolution=[1,1]}var p=g.prototype;p.isOpaque=function(){return this.opacity>=1},p.isTransparent=function(){return this.opacity<1},p.pickSlots=1,p.setPickBase=function(M){this.pickId=M};function v(M){for(var _=s({colormap:M,nshades:256,format:"rgba"}),y=new Uint8Array(256*4),w=0;w<256;++w){for(var d=_[w],C=0;C<3;++C)y[4*w+C]=d[C];y[4*w+3]=d[3]*255}return o(y,[256,256,4],[4,0,1])}function x(M){for(var _=M.length,y=new Array(_),w=0;w<_;++w)y[w]=M[w][2];return y}p.update=function(M){M=M||{};var _=this.gl;this.dirty=!0,"lightPosition"in M&&(this.lightPosition=M.lightPosition),"opacity"in M&&(this.opacity=M.opacity),"ambient"in M&&(this.ambientLight=M.ambient),"diffuse"in M&&(this.diffuseLight=M.diffuse),"specular"in M&&(this.specularLight=M.specular),"roughness"in M&&(this.roughness=M.roughness),"fresnel"in M&&(this.fresnel=M.fresnel),M.tubeScale!==void 0&&(this.tubeScale=M.tubeScale),M.vectorScale!==void 0&&(this.vectorScale=M.vectorScale),M.coneScale!==void 0&&(this.coneScale=M.coneScale),M.coneOffset!==void 0&&(this.coneOffset=M.coneOffset),M.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=_.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=_.LINEAR,this.texture.setPixels(v(M.colormap)),this.texture.generateMipmap());var y=M.cells,w=M.positions,d=M.vectors;if(!w||!y||!d)return;var C=[],S=[],E=[],k=[],B=[];this.cells=y,this.positions=w,this.vectors=d;var z=M.meshColor||[1,1,1,1],F=M.vertexIntensity,I=1/0,O=-1/0;if(F)if(M.vertexIntensityBounds)I=+M.vertexIntensityBounds[0],O=+M.vertexIntensityBounds[1];else for(var N=0;N<F.length;++N){var V=F[N];I=Math.min(I,V),O=Math.max(O,V)}else for(var N=0;N<w.length;++N){var V=w[N][2];I=Math.min(I,V),O=Math.max(O,V)}F?this.intensity=F:this.intensity=x(w),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var N=0;N<w.length;++N)for(var H=w[N],j=0;j<3;++j)isNaN(H[j])||!isFinite(H[j])||(this.bounds[0][j]=Math.min(this.bounds[0][j],H[j]),this.bounds[1][j]=Math.max(this.bounds[1][j],H[j]));var Z=0;e:for(var N=0;N<y.length;++N){var X=y[N];switch(X.length){case 3:for(var j=0;j<3;++j)for(var re=X[j],H=w[re],ue=0;ue<3;++ue)if(isNaN(H[ue])||!isFinite(H[ue]))continue e;for(var j=0;j<3;++j){var re=X[2-j],H=w[re];C.push(H[0],H[1],H[2],H[3]);var K=d[re];S.push(K[0],K[1],K[2],K[3]||0);var te=z;te.length===3?E.push(te[0],te[1],te[2],1):E.push(te[0],te[1],te[2],te[3]);var G;F?G=[(F[re]-I)/(O-I),0]:G=[(H[2]-I)/(O-I),0],k.push(G[0],G[1]),B.push(N)}Z+=1;break}}this.triangleCount=Z,this.trianglePositions.update(C),this.triangleVectors.update(S),this.triangleColors.update(E),this.triangleUVs.update(k),this.triangleIds.update(new Uint32Array(B))},p.drawTransparent=p.draw=function(M){M=M||{};for(var _=this.gl,y=M.model||m,w=M.view||m,d=M.projection||m,C=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],S=0;S<3;++S)C[0][S]=Math.max(C[0][S],this.clipBounds[0][S]),C[1][S]=Math.min(C[1][S],this.clipBounds[1][S]);var E={model:y,view:w,projection:d,inverseModel:m.slice(),clipBounds:C,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};E.inverseModel=f(E.inverseModel,E.model),_.disable(_.CULL_FACE),this.texture.bind(0);var k=new Array(16);r(k,E.view,E.model),r(k,E.projection,k),f(k,k);for(var S=0;S<3;++S)E.eyePosition[S]=k[12+S]/k[15];for(var B=k[15],S=0;S<3;++S)B+=this.lightPosition[S]*k[4*S+3];for(var S=0;S<3;++S){for(var z=k[12+S],F=0;F<3;++F)z+=k[4*F+S]*this.lightPosition[F];E.lightPosition[S]=z/B}if(this.triangleCount>0){var I=this.triShader;I.bind(),I.uniforms=E,this.triangleVAO.bind(),_.drawArrays(_.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()}},p.drawPick=function(M){M=M||{};for(var _=this.gl,y=M.model||m,w=M.view||m,d=M.projection||m,C=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],S=0;S<3;++S)C[0][S]=Math.max(C[0][S],this.clipBounds[0][S]),C[1][S]=Math.min(C[1][S],this.clipBounds[1][S]);this._model=[].slice.call(y),this._view=[].slice.call(w),this._projection=[].slice.call(d),this._resolution=[_.drawingBufferWidth,_.drawingBufferHeight];var E={model:y,view:w,projection:d,clipBounds:C,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},k=this.pickShader;k.bind(),k.uniforms=E,this.triangleCount>0&&(this.triangleVAO.bind(),_.drawArrays(_.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind())},p.pick=function(M){if(!M||M.id!==this.pickId)return null;var _=M.value[0]+256*M.value[1]+65536*M.value[2],y=this.cells[_],w=this.positions[y[1]].slice(0,3),d={position:w,dataCoordinate:w,index:Math.floor(y[1]/48)};return this.traceType==="cone"?d.index=Math.floor(y[1]/48):this.traceType==="streamtube"&&(d.intensity=this.intensity[y[1]],d.velocity=this.vectors[y[1]].slice(0,3),d.divergence=this.vectors[y[1]][3],d.index=_),d},p.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()};function l(M,_){var y=e(M,_.meshShader.vertex,_.meshShader.fragment,null,_.meshShader.attributes);return y.attributes.position.location=0,y.attributes.color.location=2,y.attributes.uv.location=3,y.attributes.vector.location=4,y}function b(M,_){var y=e(M,_.pickShader.vertex,_.pickShader.fragment,null,_.pickShader.attributes);return y.attributes.position.location=0,y.attributes.id.location=1,y.attributes.vector.location=4,y}function c(M,_,y){var w=y.shaders;arguments.length===1&&(_=M,M=_.gl);var d=l(M,w),C=b(M,w),S=a(M,o(new Uint8Array([255,255,255,255]),[1,1,4]));S.generateMipmap(),S.minFilter=M.LINEAR_MIPMAP_LINEAR,S.magFilter=M.LINEAR;var E=i(M),k=i(M),B=i(M),z=i(M),F=i(M),I=n(M,[{buffer:E,type:M.FLOAT,size:4},{buffer:F,type:M.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:B,type:M.FLOAT,size:4},{buffer:z,type:M.FLOAT,size:2},{buffer:k,type:M.FLOAT,size:4}]),O=new g(M,S,d,C,E,k,F,B,z,I,y.traceType||"cone");return O.update(_),O}A.exports=c},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(u,A,T){var e=u("glslify"),i=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);T.meshShader={vertex:i,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},T.pickShader={vertex:a,fragment:r,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(u,A,T){A.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(u,A,T){var e=u("./1.0/numbers");A.exports=function(n){return e[n]}},{"./1.0/numbers":82}],84:[function(u,A,T){A.exports=g;var e=u("gl-buffer"),i=u("gl-vao"),n=u("./shaders/index"),a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function r(p,v,x,l){this.gl=p,this.shader=l,this.buffer=v,this.vao=x,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var f=r.prototype;f.isOpaque=function(){return!this.hasAlpha},f.isTransparent=function(){return this.hasAlpha},f.drawTransparent=f.draw=function(p){var v=this.gl,x=this.shader.uniforms;this.shader.bind();var l=x.view=p.view||a,b=x.projection=p.projection||a;x.model=p.model||a,x.clipBounds=this.clipBounds,x.opacity=this.opacity;var c=l[12],M=l[13],_=l[14],y=l[15],w=p._ortho||!1,d=w?2:1,C=d*this.pixelRatio*(b[3]*c+b[7]*M+b[11]*_+b[15]*y)/v.drawingBufferHeight;this.vao.bind();for(var S=0;S<3;++S)v.lineWidth(this.lineWidth[S]*this.pixelRatio),x.capSize=this.capSize[S]*C,this.lineCount[S]&&v.drawArrays(v.LINES,this.lineOffset[S],this.lineCount[S]);this.vao.unbind()};function o(p,v){for(var x=0;x<3;++x)p[0][x]=Math.min(p[0][x],v[x]),p[1][x]=Math.max(p[1][x],v[x])}var s=function(){for(var p=new Array(3),v=0;v<3;++v){for(var x=[],l=1;l<=2;++l)for(var b=-1;b<=1;b+=2){var c=(l+v)%3,M=[0,0,0];M[c]=b,x.push(M)}p[v]=x}return p}();function m(p,v,x,l){for(var b=s[l],c=0;c<b.length;++c){var M=b[c];p.push(v[0],v[1],v[2],x[0],x[1],x[2],x[3],M[0],M[1],M[2])}return b.length}f.update=function(p){p=p||{},"lineWidth"in p&&(this.lineWidth=p.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in p&&(this.capSize=p.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in p&&(this.opacity=+p.opacity,this.opacity<1&&(this.hasAlpha=!0));var v=p.color||[[0,0,0],[0,0,0],[0,0,0]],x=p.position,l=p.error;if(Array.isArray(v[0])||(v=[v,v,v]),x&&l){var b=[],c=x.length,M=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var _=0;_<3;++_){this.lineOffset[_]=M;e:for(var y=0;y<c;++y){for(var w=x[y],d=0;d<3;++d)if(isNaN(w[d])||!isFinite(w[d]))continue e;var C=l[y],S=v[_];if(Array.isArray(S[0])&&(S=v[y]),S.length===3?S=[S[0],S[1],S[2],1]:S.length===4&&(S=[S[0],S[1],S[2],S[3]],!this.hasAlpha&&S[3]<1&&(this.hasAlpha=!0)),!(isNaN(C[0][_])||isNaN(C[1][_]))){if(C[0][_]<0){var E=w.slice();E[_]+=C[0][_],b.push(w[0],w[1],w[2],S[0],S[1],S[2],S[3],0,0,0,E[0],E[1],E[2],S[0],S[1],S[2],S[3],0,0,0),o(this.bounds,E),M+=2+m(b,E,S,_)}if(C[1][_]>0){var E=w.slice();E[_]+=C[1][_],b.push(w[0],w[1],w[2],S[0],S[1],S[2],S[3],0,0,0,E[0],E[1],E[2],S[0],S[1],S[2],S[3],0,0,0),o(this.bounds,E),M+=2+m(b,E,S,_)}}}this.lineCount[_]=M-this.lineOffset[_]}this.buffer.update(b)}},f.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()};function g(p){var v=p.gl,x=e(v),l=i(v,[{buffer:x,type:v.FLOAT,size:3,offset:0,stride:40},{buffer:x,type:v.FLOAT,size:4,offset:12,stride:40},{buffer:x,type:v.FLOAT,size:3,offset:28,stride:40}]),b=n(v);b.attributes.position.location=0,b.attributes.color.location=1,b.attributes.offset.location=2;var c=new r(v,x,l,b);return c.update(p),c}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(u,A,T){var e=u("glslify"),i=u("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),a=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);A.exports=function(r){return i(r,n,a,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(u,A,T){var e=u("gl-texture2d");A.exports=M;var i=null,n,a,r,f;function o(_){var y=_.getParameter(_.FRAMEBUFFER_BINDING),w=_.getParameter(_.RENDERBUFFER_BINDING),d=_.getParameter(_.TEXTURE_BINDING_2D);return[y,w,d]}function s(_,y){_.bindFramebuffer(_.FRAMEBUFFER,y[0]),_.bindRenderbuffer(_.RENDERBUFFER,y[1]),_.bindTexture(_.TEXTURE_2D,y[2])}function m(_,y){var w=_.getParameter(y.MAX_COLOR_ATTACHMENTS_WEBGL);i=new Array(w+1);for(var d=0;d<=w;++d){for(var C=new Array(w),S=0;S<d;++S)C[S]=_.COLOR_ATTACHMENT0+S;for(var S=d;S<w;++S)C[S]=_.NONE;i[d]=C}}function g(_){switch(_){case n:throw new Error("gl-fbo: Framebuffer unsupported");case a:throw new Error("gl-fbo: Framebuffer incomplete attachment");case r:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case f:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function p(_,y,w,d,C,S){if(!d)return null;var E=e(_,y,w,C,d);return E.magFilter=_.NEAREST,E.minFilter=_.NEAREST,E.mipSamples=1,E.bind(),_.framebufferTexture2D(_.FRAMEBUFFER,S,_.TEXTURE_2D,E.handle,0),E}function v(_,y,w,d,C){var S=_.createRenderbuffer();return _.bindRenderbuffer(_.RENDERBUFFER,S),_.renderbufferStorage(_.RENDERBUFFER,d,y,w),_.framebufferRenderbuffer(_.FRAMEBUFFER,C,_.RENDERBUFFER,S),S}function x(_){var y=o(_.gl),w=_.gl,d=_.handle=w.createFramebuffer(),C=_._shape[0],S=_._shape[1],E=_.color.length,k=_._ext,B=_._useStencil,z=_._useDepth,F=_._colorType;w.bindFramebuffer(w.FRAMEBUFFER,d);for(var I=0;I<E;++I)_.color[I]=p(w,C,S,F,w.RGBA,w.COLOR_ATTACHMENT0+I);E===0?(_._color_rb=v(w,C,S,w.RGBA4,w.COLOR_ATTACHMENT0),k&&k.drawBuffersWEBGL(i[0])):E>1&&k.drawBuffersWEBGL(i[E]);var O=w.getExtension("WEBGL_depth_texture");O?B?_.depth=p(w,C,S,O.UNSIGNED_INT_24_8_WEBGL,w.DEPTH_STENCIL,w.DEPTH_STENCIL_ATTACHMENT):z&&(_.depth=p(w,C,S,w.UNSIGNED_SHORT,w.DEPTH_COMPONENT,w.DEPTH_ATTACHMENT)):z&&B?_._depth_rb=v(w,C,S,w.DEPTH_STENCIL,w.DEPTH_STENCIL_ATTACHMENT):z?_._depth_rb=v(w,C,S,w.DEPTH_COMPONENT16,w.DEPTH_ATTACHMENT):B&&(_._depth_rb=v(w,C,S,w.STENCIL_INDEX,w.STENCIL_ATTACHMENT));var N=w.checkFramebufferStatus(w.FRAMEBUFFER);if(N!==w.FRAMEBUFFER_COMPLETE){_._destroyed=!0,w.bindFramebuffer(w.FRAMEBUFFER,null),w.deleteFramebuffer(_.handle),_.handle=null,_.depth&&(_.depth.dispose(),_.depth=null),_._depth_rb&&(w.deleteRenderbuffer(_._depth_rb),_._depth_rb=null);for(var I=0;I<_.color.length;++I)_.color[I].dispose(),_.color[I]=null;_._color_rb&&(w.deleteRenderbuffer(_._color_rb),_._color_rb=null),s(w,y),g(N)}s(w,y)}function l(_,y,w,d,C,S,E,k){this.gl=_,this._shape=[y|0,w|0],this._destroyed=!1,this._ext=k,this.color=new Array(C);for(var B=0;B<C;++B)this.color[B]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=d,this._useDepth=S,this._useStencil=E;var z=this,F=[y|0,w|0];Object.defineProperties(F,{0:{get:function(){return z._shape[0]},set:function(I){return z.width=I}},1:{get:function(){return z._shape[1]},set:function(I){return z.height=I}}}),this._shapeVector=F,x(this)}var b=l.prototype;function c(_,y,w){if(_._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(!(_._shape[0]===y&&_._shape[1]===w)){var d=_.gl,C=d.getParameter(d.MAX_RENDERBUFFER_SIZE);if(y<0||y>C||w<0||w>C)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");_._shape[0]=y,_._shape[1]=w;for(var S=o(d),E=0;E<_.color.length;++E)_.color[E].shape=_._shape;_._color_rb&&(d.bindRenderbuffer(d.RENDERBUFFER,_._color_rb),d.renderbufferStorage(d.RENDERBUFFER,d.RGBA4,_._shape[0],_._shape[1])),_.depth&&(_.depth.shape=_._shape),_._depth_rb&&(d.bindRenderbuffer(d.RENDERBUFFER,_._depth_rb),_._useDepth&&_._useStencil?d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_STENCIL,_._shape[0],_._shape[1]):_._useDepth?d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT16,_._shape[0],_._shape[1]):_._useStencil&&d.renderbufferStorage(d.RENDERBUFFER,d.STENCIL_INDEX,_._shape[0],_._shape[1])),d.bindFramebuffer(d.FRAMEBUFFER,_.handle);var k=d.checkFramebufferStatus(d.FRAMEBUFFER);k!==d.FRAMEBUFFER_COMPLETE&&(_.dispose(),s(d,S),g(k)),s(d,S)}}Object.defineProperties(b,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(_){if(Array.isArray(_)||(_=[_|0,_|0]),_.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var y=_[0]|0,w=_[1]|0;return c(this,y,w),[y,w]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(_){return _=_|0,c(this,_,this._shape[1]),_},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(_){return _=_|0,c(this,this._shape[0],_),_},enumerable:!1}}),b.bind=function(){if(!this._destroyed){var _=this.gl;_.bindFramebuffer(_.FRAMEBUFFER,this.handle),_.viewport(0,0,this._shape[0],this._shape[1])}},b.dispose=function(){if(!this._destroyed){this._destroyed=!0;var _=this.gl;_.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(_.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var y=0;y<this.color.length;++y)this.color[y].dispose(),this.color[y]=null;this._color_rb&&(_.deleteRenderbuffer(this._color_rb),this._color_rb=null)}};function M(_,y,w,d){n||(n=_.FRAMEBUFFER_UNSUPPORTED,a=_.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,r=_.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,f=_.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var C=_.getExtension("WEBGL_draw_buffers");if(!i&&C&&m(_,C),Array.isArray(y)&&(d=w,w=y[1]|0,y=y[0]|0),typeof y!="number")throw new Error("gl-fbo: Missing shape parameter");var S=_.getParameter(_.MAX_RENDERBUFFER_SIZE);if(y<0||y>S||w<0||w>S)throw new Error("gl-fbo: Parameters are too large for FBO");d=d||{};var E=1;if("color"in d){if(E=Math.max(d.color|0,0),E<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(E>1)if(C){if(E>_.getParameter(C.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+E+" draw buffers")}else throw new Error("gl-fbo: Multiple draw buffer extension not supported")}var k=_.UNSIGNED_BYTE,B=_.getExtension("OES_texture_float");if(d.float&&E>0){if(!B)throw new Error("gl-fbo: Context does not support floating point textures");k=_.FLOAT}else d.preferFloat&&E>0&&B&&(k=_.FLOAT);var z=!0;"depth"in d&&(z=!!d.depth);var F=!1;return"stencil"in d&&(F=!!d.stencil),new l(_,y,w,k,E,z,F,C)}},{"gl-texture2d":146}],87:[function(u,A,T){var e=u("sprintf-js").sprintf,i=u("gl-constants/lookup"),n=u("glsl-shader-name"),a=u("add-line-numbers");A.exports=r;function r(f,o,s){var m=n(o)||"of unknown name (see npm glsl-shader-name)",g="unknown type";s!==void 0&&(g=s===i.FRAGMENT_SHADER?"fragment":"vertex");for(var p=e(`Error compiling %s shader %s:
`,g,m),v=e("%s%s",p,f),x=f.split(`
`),l={},b=0;b<x.length;b++){var c=x[b];if(!(c===""||c==="\0")){var M=parseInt(c.split(":")[2]);if(isNaN(M))throw new Error(e("Could not parse error: %s",c));l[M]=c}}for(var _=a(o).split(`
`),b=0;b<_.length;b++)if(!(!l[b+3]&&!l[b+2]&&!l[b+1])){var y=_[b];if(p+=y+`
`,l[b+1]){var w=l[b+1];w=w.substr(w.split(":",3).join(":").length+1).trim(),p+=e(`^^^ %s

`,w)}}return{long:p.trim(),short:v.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(u,A,T){A.exports=g;var e=u("binary-search-bounds"),i=u("iota-array"),n=u("typedarray-pool"),a=u("gl-shader"),r=u("gl-buffer"),f=u("./lib/shaders");function o(p,v,x,l,b,c,M){this.plot=p,this.shader=v,this.pickShader=x,this.positionBuffer=l,this.weightBuffer=b,this.colorBuffer=c,this.idBuffer=M,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var s=o.prototype,m=[0,0,1,0,0,1,1,0,1,1,0,1];s.draw=function(){var p=[1,0,0,0,1,0,0,0,1];return function(){var v=this.plot,x=this.shader,l=this.bounds,b=this.numVertices;if(!(b<=0)){var c=v.gl,M=v.dataBox,_=l[2]-l[0],y=l[3]-l[1],w=M[2]-M[0],d=M[3]-M[1];p[0]=2*_/w,p[4]=2*y/d,p[6]=2*(l[0]-M[0])/w-1,p[7]=2*(l[1]-M[1])/d-1,x.bind();var C=x.uniforms;C.viewTransform=p,C.shape=this.shape;var S=x.attributes;this.positionBuffer.bind(),S.position.pointer(),this.weightBuffer.bind(),S.weight.pointer(c.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),S.color.pointer(c.UNSIGNED_BYTE,!0),c.drawArrays(c.TRIANGLES,0,b)}}}(),s.drawPick=function(){var p=[1,0,0,0,1,0,0,0,1],v=[0,0,0,0];return function(x){var l=this.plot,b=this.pickShader,c=this.bounds,M=this.numVertices;if(!(M<=0)){var _=l.gl,y=l.dataBox,w=c[2]-c[0],d=c[3]-c[1],C=y[2]-y[0],S=y[3]-y[1];p[0]=2*w/C,p[4]=2*d/S,p[6]=2*(c[0]-y[0])/C-1,p[7]=2*(c[1]-y[1])/S-1;for(var E=0;E<4;++E)v[E]=x>>E*8&255;this.pickOffset=x,b.bind();var k=b.uniforms;k.viewTransform=p,k.pickOffset=v,k.shape=this.shape;var B=b.attributes;return this.positionBuffer.bind(),B.position.pointer(),this.weightBuffer.bind(),B.weight.pointer(_.UNSIGNED_BYTE,!1),this.idBuffer.bind(),B.pickId.pointer(_.UNSIGNED_BYTE,!1),_.drawArrays(_.TRIANGLES,0,M),x+this.shape[0]*this.shape[1]}}}(),s.pick=function(p,v,x){var l=this.pickOffset,b=this.shape[0]*this.shape[1];if(x<l||x>=l+b)return null;var c=x-l,M=this.xData,_=this.yData;return{object:this,pointId:c,dataCoord:[M[c%this.shape[0]],_[c/this.shape[0]|0]]}},s.update=function(p){p=p||{};var v=p.shape||[0,0],x=p.x||i(v[0]),l=p.y||i(v[1]),b=p.z||new Float32Array(v[0]*v[1]),c=p.zsmooth!==!1;this.xData=x,this.yData=l;var M=p.colorLevels||[0],_=p.colorValues||[0,0,0,1],y=M.length,w=this.bounds,d,C,S,E;c?(d=w[0]=x[0],C=w[1]=l[0],S=w[2]=x[x.length-1],E=w[3]=l[l.length-1]):(d=w[0]=x[0]+(x[1]-x[0])/2,C=w[1]=l[0]+(l[1]-l[0])/2,S=w[2]=x[x.length-1]+(x[x.length-1]-x[x.length-2])/2,E=w[3]=l[l.length-1]+(l[l.length-1]-l[l.length-2])/2);var k=1/(S-d),B=1/(E-C),z=v[0],F=v[1];this.shape=[z,F];var I=(c?(z-1)*(F-1):z*F)*(m.length>>>1);this.numVertices=I;for(var O=n.mallocUint8(I*4),N=n.mallocFloat32(I*2),V=n.mallocUint8(I*2),H=n.mallocUint32(I),j=0,Z=c?z-1:z,X=c?F-1:F,re=0;re<X;++re){var ue,K;c?(ue=B*(l[re]-C),K=B*(l[re+1]-C)):(ue=re<F-1?B*(l[re]-(l[re+1]-l[re])/2-C):B*(l[re]-(l[re]-l[re-1])/2-C),K=re<F-1?B*(l[re]+(l[re+1]-l[re])/2-C):B*(l[re]+(l[re]-l[re-1])/2-C));for(var te=0;te<Z;++te){var G,Y;c?(G=k*(x[te]-d),Y=k*(x[te+1]-d)):(G=te<z-1?k*(x[te]-(x[te+1]-x[te])/2-d):k*(x[te]-(x[te]-x[te-1])/2-d),Y=te<z-1?k*(x[te]+(x[te+1]-x[te])/2-d):k*(x[te]+(x[te]-x[te-1])/2-d));for(var ee=0;ee<m.length;ee+=2){var ne=m[ee],J=m[ee+1],q=c?(re+J)*z+(te+ne):re*z+te,ae=b[q],le=e.le(M,ae),ie,se,xe,oe;if(le<0)ie=_[0],se=_[1],xe=_[2],oe=_[3];else if(le===y-1)ie=_[4*y-4],se=_[4*y-3],xe=_[4*y-2],oe=_[4*y-1];else{var he=(ae-M[le])/(M[le+1]-M[le]),be=1-he,me=4*le,_e=4*(le+1);ie=be*_[me]+he*_[_e],se=be*_[me+1]+he*_[_e+1],xe=be*_[me+2]+he*_[_e+2],oe=be*_[me+3]+he*_[_e+3]}O[4*j]=255*ie,O[4*j+1]=255*se,O[4*j+2]=255*xe,O[4*j+3]=255*oe,N[2*j]=G*.5+Y*.5,N[2*j+1]=ue*.5+K*.5,V[2*j]=ne,V[2*j+1]=J,H[j]=re*z+te,j+=1}}}this.positionBuffer.update(N),this.weightBuffer.update(V),this.colorBuffer.update(O),this.idBuffer.update(H),n.free(N),n.free(O),n.free(V),n.free(H)},s.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)};function g(p,v){var x=p.gl,l=a(x,f.vertex,f.fragment),b=a(x,f.pickVertex,f.pickFragment),c=r(x),M=r(x),_=r(x),y=r(x),w=new o(p,l,b,c,M,_,y);return w.update(v),p.addObject(w),w}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(u,A,T){var e=u("glslify");A.exports={fragment:e([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:231}],90:[function(u,A,T){var e=u("glslify"),i=u("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),a=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),f=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];T.createShader=function(o){return i(o,n,a,null,f)},T.createPickShader=function(o){return i(o,n,r,null,f)}},{"gl-shader":132,glslify:231}],91:[function(u,A,T){A.exports=_;var e=u("gl-buffer"),i=u("gl-vao"),n=u("gl-texture2d"),a=new Uint8Array(4),r=new Float32Array(a.buffer);function f(y,w,d,C){return a[0]=C,a[1]=d,a[2]=w,a[3]=y,r[0]}var o=u("binary-search-bounds"),s=u("ndarray"),m=u("./lib/shaders"),g=m.createShader,p=m.createPickShader,v=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function x(y,w){for(var d=0,C=0;C<3;++C){var S=y[C]-w[C];d+=S*S}return Math.sqrt(d)}function l(y){for(var w=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],d=0;d<3;++d)w[0][d]=Math.max(y[0][d],w[0][d]),w[1][d]=Math.min(y[1][d],w[1][d]);return w}function b(y,w,d,C){this.arcLength=y,this.position=w,this.index=d,this.dataCoordinate=C}function c(y,w,d,C,S,E){this.gl=y,this.shader=w,this.pickShader=d,this.buffer=C,this.vao=S,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=E,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var M=c.prototype;M.isTransparent=function(){return this.hasAlpha},M.isOpaque=function(){return!this.hasAlpha},M.pickSlots=1,M.setPickBase=function(y){this.pickId=y},M.drawTransparent=M.draw=function(y){if(!!this.vertexCount){var w=this.gl,d=this.shader,C=this.vao;d.bind(),d.uniforms={model:y.model||v,view:y.view||v,projection:y.projection||v,clipBounds:l(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[w.drawingBufferWidth,w.drawingBufferHeight],pixelRatio:this.pixelRatio},C.bind(),C.draw(w.TRIANGLE_STRIP,this.vertexCount),C.unbind()}},M.drawPick=function(y){if(!!this.vertexCount){var w=this.gl,d=this.pickShader,C=this.vao;d.bind(),d.uniforms={model:y.model||v,view:y.view||v,projection:y.projection||v,pickId:this.pickId,clipBounds:l(this.clipBounds),screenShape:[w.drawingBufferWidth,w.drawingBufferHeight],pixelRatio:this.pixelRatio},C.bind(),C.draw(w.TRIANGLE_STRIP,this.vertexCount),C.unbind()}},M.update=function(y){var w,d;this.dirty=!0;var C=!!y.connectGaps;"dashScale"in y&&(this.dashScale=y.dashScale),this.hasAlpha=!1,"opacity"in y&&(this.opacity=+y.opacity,this.opacity<1&&(this.hasAlpha=!0));var S=[],E=[],k=[],B=0,z=0,F=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],I=y.position||y.positions;if(I){var O=y.color||y.colors||[0,0,0,1],N=y.lineWidth||1,V=!1;e:for(w=1;w<I.length;++w){var H=I[w-1],j=I[w];for(E.push(B),k.push(H.slice()),d=0;d<3;++d){if(isNaN(H[d])||isNaN(j[d])||!isFinite(H[d])||!isFinite(j[d])){if(!C&&S.length>0){for(var Z=0;Z<24;++Z)S.push(S[S.length-12]);z+=2,V=!0}continue e}F[0][d]=Math.min(F[0][d],H[d],j[d]),F[1][d]=Math.max(F[1][d],H[d],j[d])}var X,re;Array.isArray(O[0])?(X=O.length>w-1?O[w-1]:O.length>0?O[O.length-1]:[0,0,0,1],re=O.length>w?O[w]:O.length>0?O[O.length-1]:[0,0,0,1]):X=re=O,X.length===3&&(X=[X[0],X[1],X[2],1]),re.length===3&&(re=[re[0],re[1],re[2],1]),!this.hasAlpha&&X[3]<1&&(this.hasAlpha=!0);var ue;Array.isArray(N)?ue=N.length>w-1?N[w-1]:N.length>0?N[N.length-1]:[0,0,0,1]:ue=N;var K=B;if(B+=x(H,j),V){for(d=0;d<2;++d)S.push(H[0],H[1],H[2],j[0],j[1],j[2],K,ue,X[0],X[1],X[2],X[3]);z+=2,V=!1}S.push(H[0],H[1],H[2],j[0],j[1],j[2],K,ue,X[0],X[1],X[2],X[3],H[0],H[1],H[2],j[0],j[1],j[2],K,-ue,X[0],X[1],X[2],X[3],j[0],j[1],j[2],H[0],H[1],H[2],B,-ue,re[0],re[1],re[2],re[3],j[0],j[1],j[2],H[0],H[1],H[2],B,ue,re[0],re[1],re[2],re[3]),z+=4}}if(this.buffer.update(S),E.push(B),k.push(I[I.length-1].slice()),this.bounds=F,this.vertexCount=z,this.points=k,this.arcLength=E,"dashes"in y){var te=y.dashes,G=te.slice();for(G.unshift(0),w=1;w<G.length;++w)G[w]=G[w-1]+G[w];var Y=s(new Array(256*4),[256,1,4]);for(w=0;w<256;++w){for(d=0;d<4;++d)Y.set(w,0,d,0);o.le(G,G[G.length-1]*w/255)&1?Y.set(w,0,0,0):Y.set(w,0,0,255)}this.texture.setPixels(Y)}},M.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},M.pick=function(y){if(!y||y.id!==this.pickId)return null;var w=f(y.value[0],y.value[1],y.value[2],0),d=o.le(this.arcLength,w);if(d<0)return null;if(d===this.arcLength.length-1)return new b(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),d);for(var C=this.points[d],S=this.points[Math.min(d+1,this.points.length-1)],E=(w-this.arcLength[d])/(this.arcLength[d+1]-this.arcLength[d]),k=1-E,B=[0,0,0],z=0;z<3;++z)B[z]=k*C[z]+E*S[z];var F=Math.min(E<.5?d:d+1,this.points.length-1);return new b(w,B,F,this.points[F])};function _(y){var w=y.gl||y.scene&&y.scene.gl,d=g(w);d.attributes.position.location=0,d.attributes.nextPosition.location=1,d.attributes.arcLength.location=2,d.attributes.lineWidth.location=3,d.attributes.color.location=4;var C=p(w);C.attributes.position.location=0,C.attributes.nextPosition.location=1,C.attributes.arcLength.location=2,C.attributes.lineWidth.location=3,C.attributes.color.location=4;for(var S=e(w),E=i(w,[{buffer:S,size:3,offset:0,stride:48},{buffer:S,size:3,offset:12,stride:48},{buffer:S,size:1,offset:24,stride:48},{buffer:S,size:1,offset:28,stride:48},{buffer:S,size:4,offset:32,stride:48}]),k=s(new Array(256*4),[256,1,4]),B=0;B<256*4;++B)k.data[B]=255;var z=n(w,k);z.wrap=w.REPEAT;var F=new c(w,d,C,S,E,z);return F.update(y),F}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(u,A,T){A.exports=e;function e(i){var n=new Float32Array(16);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],n}},{}],93:[function(u,A,T){A.exports=e;function e(){var i=new Float32Array(16);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}},{}],94:[function(u,A,T){A.exports=e;function e(i){var n=i[0],a=i[1],r=i[2],f=i[3],o=i[4],s=i[5],m=i[6],g=i[7],p=i[8],v=i[9],x=i[10],l=i[11],b=i[12],c=i[13],M=i[14],_=i[15],y=n*s-a*o,w=n*m-r*o,d=n*g-f*o,C=a*m-r*s,S=a*g-f*s,E=r*g-f*m,k=p*c-v*b,B=p*M-x*b,z=p*_-l*b,F=v*M-x*c,I=v*_-l*c,O=x*_-l*M;return y*O-w*I+d*F+C*z-S*B+E*k}},{}],95:[function(u,A,T){A.exports=e;function e(i,n){var a=n[0],r=n[1],f=n[2],o=n[3],s=a+a,m=r+r,g=f+f,p=a*s,v=r*s,x=r*m,l=f*s,b=f*m,c=f*g,M=o*s,_=o*m,y=o*g;return i[0]=1-x-c,i[1]=v+y,i[2]=l-_,i[3]=0,i[4]=v-y,i[5]=1-p-c,i[6]=b+M,i[7]=0,i[8]=l+_,i[9]=b-M,i[10]=1-p-x,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}},{}],96:[function(u,A,T){A.exports=e;function e(i,n,a){var r=n[0],f=n[1],o=n[2],s=n[3],m=r+r,g=f+f,p=o+o,v=r*m,x=r*g,l=r*p,b=f*g,c=f*p,M=o*p,_=s*m,y=s*g,w=s*p;return i[0]=1-(b+M),i[1]=x+w,i[2]=l-y,i[3]=0,i[4]=x-w,i[5]=1-(v+M),i[6]=c+_,i[7]=0,i[8]=l+y,i[9]=c-_,i[10]=1-(v+b),i[11]=0,i[12]=a[0],i[13]=a[1],i[14]=a[2],i[15]=1,i}},{}],97:[function(u,A,T){A.exports=e;function e(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}},{}],98:[function(u,A,T){A.exports=e;function e(i,n){var a=n[0],r=n[1],f=n[2],o=n[3],s=n[4],m=n[5],g=n[6],p=n[7],v=n[8],x=n[9],l=n[10],b=n[11],c=n[12],M=n[13],_=n[14],y=n[15],w=a*m-r*s,d=a*g-f*s,C=a*p-o*s,S=r*g-f*m,E=r*p-o*m,k=f*p-o*g,B=v*M-x*c,z=v*_-l*c,F=v*y-b*c,I=x*_-l*M,O=x*y-b*M,N=l*y-b*_,V=w*N-d*O+C*I+S*F-E*z+k*B;return V?(V=1/V,i[0]=(m*N-g*O+p*I)*V,i[1]=(f*O-r*N-o*I)*V,i[2]=(M*k-_*E+y*S)*V,i[3]=(l*E-x*k-b*S)*V,i[4]=(g*F-s*N-p*z)*V,i[5]=(a*N-f*F+o*z)*V,i[6]=(_*C-c*k-y*d)*V,i[7]=(v*k-l*C+b*d)*V,i[8]=(s*O-m*F+p*B)*V,i[9]=(r*F-a*O-o*B)*V,i[10]=(c*E-M*C+y*w)*V,i[11]=(x*C-v*E-b*w)*V,i[12]=(m*z-s*I-g*B)*V,i[13]=(a*I-r*z+f*B)*V,i[14]=(M*d-c*S-_*w)*V,i[15]=(v*S-x*d+l*w)*V,i):null}},{}],99:[function(u,A,T){var e=u("./identity");A.exports=i;function i(n,a,r,f){var o,s,m,g,p,v,x,l,b,c,M=a[0],_=a[1],y=a[2],w=f[0],d=f[1],C=f[2],S=r[0],E=r[1],k=r[2];return Math.abs(M-S)<1e-6&&Math.abs(_-E)<1e-6&&Math.abs(y-k)<1e-6?e(n):(x=M-S,l=_-E,b=y-k,c=1/Math.sqrt(x*x+l*l+b*b),x*=c,l*=c,b*=c,o=d*b-C*l,s=C*x-w*b,m=w*l-d*x,c=Math.sqrt(o*o+s*s+m*m),c?(c=1/c,o*=c,s*=c,m*=c):(o=0,s=0,m=0),g=l*m-b*s,p=b*o-x*m,v=x*s-l*o,c=Math.sqrt(g*g+p*p+v*v),c?(c=1/c,g*=c,p*=c,v*=c):(g=0,p=0,v=0),n[0]=o,n[1]=g,n[2]=x,n[3]=0,n[4]=s,n[5]=p,n[6]=l,n[7]=0,n[8]=m,n[9]=v,n[10]=b,n[11]=0,n[12]=-(o*M+s*_+m*y),n[13]=-(g*M+p*_+v*y),n[14]=-(x*M+l*_+b*y),n[15]=1,n)}},{"./identity":97}],100:[function(u,A,T){A.exports=e;function e(i,n,a){var r=n[0],f=n[1],o=n[2],s=n[3],m=n[4],g=n[5],p=n[6],v=n[7],x=n[8],l=n[9],b=n[10],c=n[11],M=n[12],_=n[13],y=n[14],w=n[15],d=a[0],C=a[1],S=a[2],E=a[3];return i[0]=d*r+C*m+S*x+E*M,i[1]=d*f+C*g+S*l+E*_,i[2]=d*o+C*p+S*b+E*y,i[3]=d*s+C*v+S*c+E*w,d=a[4],C=a[5],S=a[6],E=a[7],i[4]=d*r+C*m+S*x+E*M,i[5]=d*f+C*g+S*l+E*_,i[6]=d*o+C*p+S*b+E*y,i[7]=d*s+C*v+S*c+E*w,d=a[8],C=a[9],S=a[10],E=a[11],i[8]=d*r+C*m+S*x+E*M,i[9]=d*f+C*g+S*l+E*_,i[10]=d*o+C*p+S*b+E*y,i[11]=d*s+C*v+S*c+E*w,d=a[12],C=a[13],S=a[14],E=a[15],i[12]=d*r+C*m+S*x+E*M,i[13]=d*f+C*g+S*l+E*_,i[14]=d*o+C*p+S*b+E*y,i[15]=d*s+C*v+S*c+E*w,i}},{}],101:[function(u,A,T){A.exports=e;function e(i,n,a,r,f,o,s){var m=1/(n-a),g=1/(r-f),p=1/(o-s);return i[0]=-2*m,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*g,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*p,i[11]=0,i[12]=(n+a)*m,i[13]=(f+r)*g,i[14]=(s+o)*p,i[15]=1,i}},{}],102:[function(u,A,T){A.exports=e;function e(i,n,a,r,f){var o=1/Math.tan(n/2),s=1/(r-f);return i[0]=o/a,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=o,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=(f+r)*s,i[11]=-1,i[12]=0,i[13]=0,i[14]=2*f*r*s,i[15]=0,i}},{}],103:[function(u,A,T){A.exports=e;function e(i,n,a,r){var f=r[0],o=r[1],s=r[2],m=Math.sqrt(f*f+o*o+s*s),g,p,v,x,l,b,c,M,_,y,w,d,C,S,E,k,B,z,F,I,O,N,V,H;return Math.abs(m)<1e-6?null:(m=1/m,f*=m,o*=m,s*=m,g=Math.sin(a),p=Math.cos(a),v=1-p,x=n[0],l=n[1],b=n[2],c=n[3],M=n[4],_=n[5],y=n[6],w=n[7],d=n[8],C=n[9],S=n[10],E=n[11],k=f*f*v+p,B=o*f*v+s*g,z=s*f*v-o*g,F=f*o*v-s*g,I=o*o*v+p,O=s*o*v+f*g,N=f*s*v+o*g,V=o*s*v-f*g,H=s*s*v+p,i[0]=x*k+M*B+d*z,i[1]=l*k+_*B+C*z,i[2]=b*k+y*B+S*z,i[3]=c*k+w*B+E*z,i[4]=x*F+M*I+d*O,i[5]=l*F+_*I+C*O,i[6]=b*F+y*I+S*O,i[7]=c*F+w*I+E*O,i[8]=x*N+M*V+d*H,i[9]=l*N+_*V+C*H,i[10]=b*N+y*V+S*H,i[11]=c*N+w*V+E*H,n!==i&&(i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i)}},{}],104:[function(u,A,T){A.exports=e;function e(i,n,a){var r=Math.sin(a),f=Math.cos(a),o=n[4],s=n[5],m=n[6],g=n[7],p=n[8],v=n[9],x=n[10],l=n[11];return n!==i&&(i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[4]=o*f+p*r,i[5]=s*f+v*r,i[6]=m*f+x*r,i[7]=g*f+l*r,i[8]=p*f-o*r,i[9]=v*f-s*r,i[10]=x*f-m*r,i[11]=l*f-g*r,i}},{}],105:[function(u,A,T){A.exports=e;function e(i,n,a){var r=Math.sin(a),f=Math.cos(a),o=n[0],s=n[1],m=n[2],g=n[3],p=n[8],v=n[9],x=n[10],l=n[11];return n!==i&&(i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[0]=o*f-p*r,i[1]=s*f-v*r,i[2]=m*f-x*r,i[3]=g*f-l*r,i[8]=o*r+p*f,i[9]=s*r+v*f,i[10]=m*r+x*f,i[11]=g*r+l*f,i}},{}],106:[function(u,A,T){A.exports=e;function e(i,n,a){var r=Math.sin(a),f=Math.cos(a),o=n[0],s=n[1],m=n[2],g=n[3],p=n[4],v=n[5],x=n[6],l=n[7];return n!==i&&(i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[0]=o*f+p*r,i[1]=s*f+v*r,i[2]=m*f+x*r,i[3]=g*f+l*r,i[4]=p*f-o*r,i[5]=v*f-s*r,i[6]=x*f-m*r,i[7]=l*f-g*r,i}},{}],107:[function(u,A,T){A.exports=e;function e(i,n,a){var r=a[0],f=a[1],o=a[2];return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[3]=n[3]*r,i[4]=n[4]*f,i[5]=n[5]*f,i[6]=n[6]*f,i[7]=n[7]*f,i[8]=n[8]*o,i[9]=n[9]*o,i[10]=n[10]*o,i[11]=n[11]*o,i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i}},{}],108:[function(u,A,T){A.exports=e;function e(i,n,a){var r=a[0],f=a[1],o=a[2],s,m,g,p,v,x,l,b,c,M,_,y;return n===i?(i[12]=n[0]*r+n[4]*f+n[8]*o+n[12],i[13]=n[1]*r+n[5]*f+n[9]*o+n[13],i[14]=n[2]*r+n[6]*f+n[10]*o+n[14],i[15]=n[3]*r+n[7]*f+n[11]*o+n[15]):(s=n[0],m=n[1],g=n[2],p=n[3],v=n[4],x=n[5],l=n[6],b=n[7],c=n[8],M=n[9],_=n[10],y=n[11],i[0]=s,i[1]=m,i[2]=g,i[3]=p,i[4]=v,i[5]=x,i[6]=l,i[7]=b,i[8]=c,i[9]=M,i[10]=_,i[11]=y,i[12]=s*r+v*f+c*o+n[12],i[13]=m*r+x*f+M*o+n[13],i[14]=g*r+l*f+_*o+n[14],i[15]=p*r+b*f+y*o+n[15]),i}},{}],109:[function(u,A,T){A.exports=e;function e(i,n){if(i===n){var a=n[1],r=n[2],f=n[3],o=n[6],s=n[7],m=n[11];i[1]=n[4],i[2]=n[8],i[3]=n[12],i[4]=a,i[6]=n[9],i[7]=n[13],i[8]=r,i[9]=o,i[11]=n[14],i[12]=f,i[13]=s,i[14]=m}else i[0]=n[0],i[1]=n[4],i[2]=n[8],i[3]=n[12],i[4]=n[1],i[5]=n[5],i[6]=n[9],i[7]=n[13],i[8]=n[2],i[9]=n[6],i[10]=n[10],i[11]=n[14],i[12]=n[3],i[13]=n[7],i[14]=n[11],i[15]=n[15];return i}},{}],110:[function(u,A,T){var e=u("barycentric"),i=u("polytope-closest-point/lib/closest_point_2d.js");A.exports=o;function n(s,m){for(var g=[0,0,0,0],p=0;p<4;++p)for(var v=0;v<4;++v)g[v]+=s[4*p+v]*m[p];return g}function a(s,m,g,p,v){for(var x=n(p,n(g,n(m,[s[0],s[1],s[2],1]))),l=0;l<3;++l)x[l]/=x[3];return[.5*v[0]*(1+x[0]),.5*v[1]*(1-x[1])]}function r(s,m){if(s.length===2){for(var g=0,p=0,v=0;v<2;++v)g+=Math.pow(m[v]-s[0][v],2),p+=Math.pow(m[v]-s[1][v],2);return g=Math.sqrt(g),p=Math.sqrt(p),g+p<1e-6?[1,0]:[p/(g+p),g/(p+g)]}else if(s.length===3){var x=[0,0];return i(s[0],s[1],s[2],m,x),e(s,x)}return[]}function f(s,m){for(var g=[0,0,0],p=0;p<s.length;++p)for(var v=s[p],x=m[p],l=0;l<3;++l)g[l]+=x*v[l];return g}function o(s,m,g,p,v,x){if(s.length===1)return[0,s[0].slice()];for(var l=new Array(s.length),b=0;b<s.length;++b)l[b]=a(s[b],g,p,v,x);for(var c=0,M=1/0,b=0;b<l.length;++b){for(var _=0,y=0;y<2;++y)_+=Math.pow(l[b][y]-m[y],2);_<M&&(M=_,c=b)}for(var w=r(l,m),d=0,b=0;b<3;++b){if(w[b]<-.001||w[b]>1.0001)return null;d+=w[b]}return Math.abs(d-1)>.001?null:[c,f(s,w),w]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(u,A,T){var e=u("glslify"),i=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),a=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),f=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),o=e([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),s=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),m=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),g=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),p=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),v=e([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);T.meshShader={vertex:i,fragment:n,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},T.wireShader={vertex:a,fragment:r,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},T.pointShader={vertex:f,fragment:o,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},T.pickShader={vertex:s,fragment:m,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},T.pointPickShader={vertex:g,fragment:m,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},T.contourShader={vertex:p,fragment:v,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(u,A,T){var e=1e-6,i=1e-6,n=u("gl-shader"),a=u("gl-buffer"),r=u("gl-vao"),f=u("gl-texture2d"),o=u("normals"),s=u("gl-mat4/multiply"),m=u("gl-mat4/invert"),g=u("ndarray"),p=u("colormap"),v=u("simplicial-complex-contour"),x=u("typedarray-pool"),l=u("./lib/shaders"),b=u("./lib/closest-point"),c=l.meshShader,M=l.wireShader,_=l.pointShader,y=l.pickShader,w=l.pointPickShader,d=l.contourShader,C=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function S(Z,X,re,ue,K,te,G,Y,ee,ne,J,q,ae,le,ie,se,xe,oe,he,be,me,_e,Se,De,Ie,Te,Ce){this.gl=Z,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=X,this.dirty=!0,this.triShader=re,this.lineShader=ue,this.pointShader=K,this.pickShader=te,this.pointPickShader=G,this.contourShader=Y,this.trianglePositions=ee,this.triangleColors=J,this.triangleNormals=ae,this.triangleUVs=q,this.triangleIds=ne,this.triangleVAO=le,this.triangleCount=0,this.lineWidth=1,this.edgePositions=ie,this.edgeColors=xe,this.edgeUVs=oe,this.edgeIds=se,this.edgeVAO=he,this.edgeCount=0,this.pointPositions=be,this.pointColors=_e,this.pointUVs=Se,this.pointSizes=De,this.pointIds=me,this.pointVAO=Ie,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=Te,this.contourVAO=Ce,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=C,this._view=C,this._projection=C,this._resolution=[1,1]}var E=S.prototype;E.isOpaque=function(){return!this.hasAlpha},E.isTransparent=function(){return this.hasAlpha},E.pickSlots=1,E.setPickBase=function(Z){this.pickId=Z};function k(Z,X){if(!X||!X.length)return 1;for(var re=0;re<X.length;++re){if(X.length<2)return 1;if(X[re][0]===Z)return X[re][1];if(X[re][0]>Z&&re>0){var ue=(X[re][0]-Z)/(X[re][0]-X[re-1][0]);return X[re][1]*(1-ue)+ue*X[re-1][1]}}return 1}function B(Z,X){for(var re=p({colormap:Z,nshades:256,format:"rgba"}),ue=new Uint8Array(256*4),K=0;K<256;++K){for(var te=re[K],G=0;G<3;++G)ue[4*K+G]=te[G];X?ue[4*K+3]=255*k(K/255,X):ue[4*K+3]=255*te[3]}return g(ue,[256,256,4],[4,0,1])}function z(Z){for(var X=Z.length,re=new Array(X),ue=0;ue<X;++ue)re[ue]=Z[ue][2];return re}E.highlight=function(Z){if(!Z||!this.contourEnable){this.contourCount=0;return}for(var X=v(this.cells,this.intensity,Z.intensity),re=X.cells,ue=X.vertexIds,K=X.vertexWeights,te=re.length,G=x.mallocFloat32(2*3*te),Y=0,ee=0;ee<te;++ee)for(var ne=re[ee],J=0;J<2;++J){var q=ne[0];ne.length===2&&(q=ne[J]);for(var ae=ue[q][0],le=ue[q][1],ie=K[q],se=1-ie,xe=this.positions[ae],oe=this.positions[le],he=0;he<3;++he)G[Y++]=ie*xe[he]+se*oe[he]}this.contourCount=Y/3|0,this.contourPositions.update(G.subarray(0,Y)),x.free(G)},E.update=function(Z){Z=Z||{};var X=this.gl;this.dirty=!0,"contourEnable"in Z&&(this.contourEnable=Z.contourEnable),"contourColor"in Z&&(this.contourColor=Z.contourColor),"lineWidth"in Z&&(this.lineWidth=Z.lineWidth),"lightPosition"in Z&&(this.lightPosition=Z.lightPosition),this.hasAlpha=!1,"opacity"in Z&&(this.opacity=Z.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in Z&&(this.opacityscale=Z.opacityscale,this.hasAlpha=!0),"ambient"in Z&&(this.ambientLight=Z.ambient),"diffuse"in Z&&(this.diffuseLight=Z.diffuse),"specular"in Z&&(this.specularLight=Z.specular),"roughness"in Z&&(this.roughness=Z.roughness),"fresnel"in Z&&(this.fresnel=Z.fresnel),Z.texture?(this.texture.dispose(),this.texture=f(X,Z.texture)):Z.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=X.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=X.LINEAR,this.texture.setPixels(B(Z.colormap,this.opacityscale)),this.texture.generateMipmap());var re=Z.cells,ue=Z.positions;if(!ue||!re)return;var K=[],te=[],G=[],Y=[],ee=[],ne=[],J=[],q=[],ae=[],le=[],ie=[],se=[],xe=[],oe=[];this.cells=re,this.positions=ue;var he=Z.vertexNormals,be=Z.cellNormals,me=Z.vertexNormalsEpsilon===void 0?e:Z.vertexNormalsEpsilon,_e=Z.faceNormalsEpsilon===void 0?i:Z.faceNormalsEpsilon;Z.useFacetNormals&&!be&&(be=o.faceNormals(re,ue,_e)),!be&&!he&&(he=o.vertexNormals(re,ue,me));var Se=Z.vertexColors,De=Z.cellColors,Ie=Z.meshColor||[1,1,1,1],Te=Z.vertexUVs,Ce=Z.vertexIntensity,He=Z.cellUVs,Xe=Z.cellIntensity,Be=1/0,Re=-1/0;if(!Te&&!He)if(Ce)if(Z.vertexIntensityBounds)Be=+Z.vertexIntensityBounds[0],Re=+Z.vertexIntensityBounds[1];else for(var We=0;We<Ce.length;++We){var vt=Ce[We];Be=Math.min(Be,vt),Re=Math.max(Re,vt)}else if(Xe)if(Z.cellIntensityBounds)Be=+Z.cellIntensityBounds[0],Re=+Z.cellIntensityBounds[1];else for(var We=0;We<Xe.length;++We){var vt=Xe[We];Be=Math.min(Be,vt),Re=Math.max(Re,vt)}else for(var We=0;We<ue.length;++We){var vt=ue[We][2];Be=Math.min(Be,vt),Re=Math.max(Re,vt)}Ce?this.intensity=Ce:Xe?this.intensity=Xe:this.intensity=z(ue),this.pickVertex=!(Xe||De);var Pt=Z.pointSizes,Zt=Z.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var We=0;We<ue.length;++We)for(var zt=ue[We],At=0;At<3;++At)isNaN(zt[At])||!isFinite(zt[At])||(this.bounds[0][At]=Math.min(this.bounds[0][At],zt[At]),this.bounds[1][At]=Math.max(this.bounds[1][At],zt[At]));var Wt=0,Bt=0,Ct=0;e:for(var We=0;We<re.length;++We){var Ze=re[We];switch(Ze.length){case 1:for(var nt=Ze[0],zt=ue[nt],At=0;At<3;++At)if(isNaN(zt[At])||!isFinite(zt[At]))continue e;le.push(zt[0],zt[1],zt[2]);var Ye;Se?Ye=Se[nt]:De?Ye=De[We]:Ye=Ie,this.opacityscale&&Ce?te.push(Ye[0],Ye[1],Ye[2],this.opacity*k((Ce[nt]-Be)/(Re-Be),this.opacityscale)):Ye.length===3?ie.push(Ye[0],Ye[1],Ye[2],this.opacity):(ie.push(Ye[0],Ye[1],Ye[2],Ye[3]*this.opacity),Ye[3]<1&&(this.hasAlpha=!0));var Ee;Te?Ee=Te[nt]:Ce?Ee=[(Ce[nt]-Be)/(Re-Be),0]:He?Ee=He[We]:Xe?Ee=[(Xe[We]-Be)/(Re-Be),0]:Ee=[(zt[2]-Be)/(Re-Be),0],se.push(Ee[0],Ee[1]),Pt?xe.push(Pt[nt]):xe.push(Zt),oe.push(We),Ct+=1;break;case 2:for(var At=0;At<2;++At)for(var nt=Ze[At],zt=ue[nt],Ge=0;Ge<3;++Ge)if(isNaN(zt[Ge])||!isFinite(zt[Ge]))continue e;for(var At=0;At<2;++At){var nt=Ze[At],zt=ue[nt];ne.push(zt[0],zt[1],zt[2]);var Ye;Se?Ye=Se[nt]:De?Ye=De[We]:Ye=Ie,this.opacityscale&&Ce?te.push(Ye[0],Ye[1],Ye[2],this.opacity*k((Ce[nt]-Be)/(Re-Be),this.opacityscale)):Ye.length===3?J.push(Ye[0],Ye[1],Ye[2],this.opacity):(J.push(Ye[0],Ye[1],Ye[2],Ye[3]*this.opacity),Ye[3]<1&&(this.hasAlpha=!0));var Ee;Te?Ee=Te[nt]:Ce?Ee=[(Ce[nt]-Be)/(Re-Be),0]:He?Ee=He[We]:Xe?Ee=[(Xe[We]-Be)/(Re-Be),0]:Ee=[(zt[2]-Be)/(Re-Be),0],q.push(Ee[0],Ee[1]),ae.push(We)}Bt+=1;break;case 3:for(var At=0;At<3;++At)for(var nt=Ze[At],zt=ue[nt],Ge=0;Ge<3;++Ge)if(isNaN(zt[Ge])||!isFinite(zt[Ge]))continue e;for(var At=0;At<3;++At){var nt=Ze[2-At],zt=ue[nt];K.push(zt[0],zt[1],zt[2]);var Ye;Se?Ye=Se[nt]:De?Ye=De[We]:Ye=Ie,Ye?this.opacityscale&&Ce?te.push(Ye[0],Ye[1],Ye[2],this.opacity*k((Ce[nt]-Be)/(Re-Be),this.opacityscale)):Ye.length===3?te.push(Ye[0],Ye[1],Ye[2],this.opacity):(te.push(Ye[0],Ye[1],Ye[2],Ye[3]*this.opacity),Ye[3]<1&&(this.hasAlpha=!0)):te.push(.5,.5,.5,1);var Ee;Te?Ee=Te[nt]:Ce?Ee=[(Ce[nt]-Be)/(Re-Be),0]:He?Ee=He[We]:Xe?Ee=[(Xe[We]-Be)/(Re-Be),0]:Ee=[(zt[2]-Be)/(Re-Be),0],Y.push(Ee[0],Ee[1]);var Je;he?Je=he[nt]:Je=be[We],G.push(Je[0],Je[1],Je[2]),ee.push(We)}Wt+=1;break}}this.pointCount=Ct,this.edgeCount=Bt,this.triangleCount=Wt,this.pointPositions.update(le),this.pointColors.update(ie),this.pointUVs.update(se),this.pointSizes.update(xe),this.pointIds.update(new Uint32Array(oe)),this.edgePositions.update(ne),this.edgeColors.update(J),this.edgeUVs.update(q),this.edgeIds.update(new Uint32Array(ae)),this.trianglePositions.update(K),this.triangleColors.update(te),this.triangleUVs.update(Y),this.triangleNormals.update(G),this.triangleIds.update(new Uint32Array(ee))},E.drawTransparent=E.draw=function(Z){Z=Z||{};for(var X=this.gl,re=Z.model||C,ue=Z.view||C,K=Z.projection||C,te=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],G=0;G<3;++G)te[0][G]=Math.max(te[0][G],this.clipBounds[0][G]),te[1][G]=Math.min(te[1][G],this.clipBounds[1][G]);var Y={model:re,view:ue,projection:K,inverseModel:C.slice(),clipBounds:te,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};Y.inverseModel=m(Y.inverseModel,Y.model),X.disable(X.CULL_FACE),this.texture.bind(0);var ee=new Array(16);s(ee,Y.view,Y.model),s(ee,Y.projection,ee),m(ee,ee);for(var G=0;G<3;++G)Y.eyePosition[G]=ee[12+G]/ee[15];for(var ne=ee[15],G=0;G<3;++G)ne+=this.lightPosition[G]*ee[4*G+3];for(var G=0;G<3;++G){for(var J=ee[12+G],q=0;q<3;++q)J+=ee[4*q+G]*this.lightPosition[q];Y.lightPosition[G]=J/ne}if(this.triangleCount>0){var ae=this.triShader;ae.bind(),ae.uniforms=Y,this.triangleVAO.bind(),X.drawArrays(X.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var ae=this.lineShader;ae.bind(),ae.uniforms=Y,this.edgeVAO.bind(),X.lineWidth(this.lineWidth*this.pixelRatio),X.drawArrays(X.LINES,0,this.edgeCount*2),this.edgeVAO.unbind()}if(this.pointCount>0){var ae=this.pointShader;ae.bind(),ae.uniforms=Y,this.pointVAO.bind(),X.drawArrays(X.POINTS,0,this.pointCount),this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var ae=this.contourShader;ae.bind(),ae.uniforms=Y,this.contourVAO.bind(),X.drawArrays(X.LINES,0,this.contourCount),this.contourVAO.unbind()}},E.drawPick=function(Z){Z=Z||{};for(var X=this.gl,re=Z.model||C,ue=Z.view||C,K=Z.projection||C,te=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],G=0;G<3;++G)te[0][G]=Math.max(te[0][G],this.clipBounds[0][G]),te[1][G]=Math.min(te[1][G],this.clipBounds[1][G]);this._model=[].slice.call(re),this._view=[].slice.call(ue),this._projection=[].slice.call(K),this._resolution=[X.drawingBufferWidth,X.drawingBufferHeight];var Y={model:re,view:ue,projection:K,clipBounds:te,pickId:this.pickId/255},ee=this.pickShader;if(ee.bind(),ee.uniforms=Y,this.triangleCount>0&&(this.triangleVAO.bind(),X.drawArrays(X.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),X.lineWidth(this.lineWidth*this.pixelRatio),X.drawArrays(X.LINES,0,this.edgeCount*2),this.edgeVAO.unbind()),this.pointCount>0){var ee=this.pointPickShader;ee.bind(),ee.uniforms=Y,this.pointVAO.bind(),X.drawArrays(X.POINTS,0,this.pointCount),this.pointVAO.unbind()}},E.pick=function(Z){if(!Z||Z.id!==this.pickId)return null;for(var X=Z.value[0]+256*Z.value[1]+65536*Z.value[2],re=this.cells[X],ue=this.positions,K=new Array(re.length),te=0;te<re.length;++te)K[te]=ue[re[te]];var G=Z.coord[0],Y=Z.coord[1];if(!this.pickVertex){var ee=this.positions[re[0]],ne=this.positions[re[1]],J=this.positions[re[2]],q=[(ee[0]+ne[0]+J[0])/3,(ee[1]+ne[1]+J[1])/3,(ee[2]+ne[2]+J[2])/3];return{_cellCenter:!0,position:[G,Y],index:X,cell:re,cellId:X,intensity:this.intensity[X],dataCoordinate:q}}var ae=b(K,[G*this.pixelRatio,this._resolution[1]-Y*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!ae)return null;for(var le=ae[2],ie=0,te=0;te<re.length;++te)ie+=le[te]*this.intensity[re[te]];return{position:ae[1],index:re[ae[0]],cell:re,cellId:X,intensity:ie,dataCoordinate:this.positions[re[ae[0]]]}},E.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()};function F(Z){var X=n(Z,c.vertex,c.fragment);return X.attributes.position.location=0,X.attributes.color.location=2,X.attributes.uv.location=3,X.attributes.normal.location=4,X}function I(Z){var X=n(Z,M.vertex,M.fragment);return X.attributes.position.location=0,X.attributes.color.location=2,X.attributes.uv.location=3,X}function O(Z){var X=n(Z,_.vertex,_.fragment);return X.attributes.position.location=0,X.attributes.color.location=2,X.attributes.uv.location=3,X.attributes.pointSize.location=4,X}function N(Z){var X=n(Z,y.vertex,y.fragment);return X.attributes.position.location=0,X.attributes.id.location=1,X}function V(Z){var X=n(Z,w.vertex,w.fragment);return X.attributes.position.location=0,X.attributes.id.location=1,X.attributes.pointSize.location=4,X}function H(Z){var X=n(Z,d.vertex,d.fragment);return X.attributes.position.location=0,X}function j(Z,X){arguments.length===1&&(X=Z,Z=X.gl);var re=Z.getExtension("OES_standard_derivatives")||Z.getExtension("MOZ_OES_standard_derivatives")||Z.getExtension("WEBKIT_OES_standard_derivatives");if(!re)throw new Error("derivatives not supported");var ue=F(Z),K=I(Z),te=O(Z),G=N(Z),Y=V(Z),ee=H(Z),ne=f(Z,g(new Uint8Array([255,255,255,255]),[1,1,4]));ne.generateMipmap(),ne.minFilter=Z.LINEAR_MIPMAP_LINEAR,ne.magFilter=Z.LINEAR;var J=a(Z),q=a(Z),ae=a(Z),le=a(Z),ie=a(Z),se=r(Z,[{buffer:J,type:Z.FLOAT,size:3},{buffer:ie,type:Z.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:q,type:Z.FLOAT,size:4},{buffer:ae,type:Z.FLOAT,size:2},{buffer:le,type:Z.FLOAT,size:3}]),xe=a(Z),oe=a(Z),he=a(Z),be=a(Z),me=r(Z,[{buffer:xe,type:Z.FLOAT,size:3},{buffer:be,type:Z.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:oe,type:Z.FLOAT,size:4},{buffer:he,type:Z.FLOAT,size:2}]),_e=a(Z),Se=a(Z),De=a(Z),Ie=a(Z),Te=a(Z),Ce=r(Z,[{buffer:_e,type:Z.FLOAT,size:3},{buffer:Te,type:Z.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:Se,type:Z.FLOAT,size:4},{buffer:De,type:Z.FLOAT,size:2},{buffer:Ie,type:Z.FLOAT,size:1}]),He=a(Z),Xe=r(Z,[{buffer:He,type:Z.FLOAT,size:3}]),Be=new S(Z,ne,ue,K,te,G,Y,ee,J,ie,q,ae,le,se,xe,be,oe,he,me,_e,Te,Se,De,Ie,Ce,He,Xe);return Be.update(X),Be}A.exports=j},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(u,A,T){A.exports=f;var e=u("gl-buffer"),i=u("gl-shader"),n=u("./shaders");function a(o,s,m){this.plot=o,this.vbo=s,this.shader=m}var r=a.prototype;r.bind=function(){var o=this.shader;this.vbo.bind(),this.shader.bind(),o.attributes.coord.pointer(),o.uniforms.screenBox=this.plot.screenBox},r.drawBox=function(){var o=[0,0],s=[0,0];return function(m,g,p,v,x){var l=this.plot,b=this.shader,c=l.gl;o[0]=m,o[1]=g,s[0]=p,s[1]=v,b.uniforms.lo=o,b.uniforms.hi=s,b.uniforms.color=x,c.drawArrays(c.TRIANGLE_STRIP,0,4)}}(),r.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function f(o){var s=o.gl,m=e(s,[0,0,0,1,1,0,1,1]),g=i(s,n.boxVert,n.lineFrag);return new a(o,m,g)}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(u,A,T){A.exports=s;var e=u("gl-buffer"),i=u("gl-shader"),n=u("binary-search-bounds"),a=u("./shaders");function r(m,g,p,v){this.plot=m,this.vbo=g,this.shader=p,this.tickShader=v,this.ticks=[[],[]]}function f(m,g){return m-g}var o=r.prototype;o.draw=function(){var m=[0,0],g=[0,0],p=[0,0];return function(){for(var v=this.plot,x=this.vbo,l=this.shader,b=this.ticks,c=v.gl,M=v._tickBounds,_=v.dataBox,y=v.viewBox,w=v.gridLineWidth,d=v.gridLineColor,C=v.gridLineEnable,S=v.pixelRatio,E=0;E<2;++E){var k=M[E],B=M[E+2],z=B-k,F=.5*(_[E+2]+_[E]),I=_[E+2]-_[E];g[E]=2*z/I,m[E]=2*(k-F)/I}l.bind(),x.bind(),l.attributes.dataCoord.pointer(),l.uniforms.dataShift=m,l.uniforms.dataScale=g;for(var O=0,E=0;E<2;++E){p[0]=p[1]=0,p[E]=1,l.uniforms.dataAxis=p,l.uniforms.lineWidth=w[E]/(y[E+2]-y[E])*S,l.uniforms.color=d[E];var N=b[E].length*6;C[E]&&N&&c.drawArrays(c.TRIANGLES,O,N),O+=N}}}(),o.drawTickMarks=function(){var m=[0,0],g=[0,0],p=[1,0],v=[0,1],x=[0,0],l=[0,0];return function(){for(var b=this.plot,c=this.vbo,M=this.tickShader,_=this.ticks,y=b.gl,w=b._tickBounds,d=b.dataBox,C=b.viewBox,S=b.pixelRatio,E=b.screenBox,k=E[2]-E[0],B=E[3]-E[1],z=C[2]-C[0],F=C[3]-C[1],I=0;I<2;++I){var O=w[I],N=w[I+2],V=N-O,H=.5*(d[I+2]+d[I]),j=d[I+2]-d[I];g[I]=2*V/j,m[I]=2*(O-H)/j}g[0]*=z/k,m[0]*=z/k,g[1]*=F/B,m[1]*=F/B,M.bind(),c.bind(),M.attributes.dataCoord.pointer();var Z=M.uniforms;Z.dataShift=m,Z.dataScale=g;var X=b.tickMarkLength,re=b.tickMarkWidth,ue=b.tickMarkColor,K=0,te=_[0].length*6,G=Math.min(n.ge(_[0],(d[0]-w[0])/(w[2]-w[0]),f),_[0].length),Y=Math.min(n.gt(_[0],(d[2]-w[0])/(w[2]-w[0]),f),_[0].length),ee=K+6*G,ne=6*Math.max(0,Y-G),J=Math.min(n.ge(_[1],(d[1]-w[1])/(w[3]-w[1]),f),_[1].length),q=Math.min(n.gt(_[1],(d[3]-w[1])/(w[3]-w[1]),f),_[1].length),ae=te+6*J,le=6*Math.max(0,q-J);x[0]=2*(C[0]-X[1])/k-1,x[1]=(C[3]+C[1])/B-1,l[0]=X[1]*S/k,l[1]=re[1]*S/B,le&&(Z.color=ue[1],Z.tickScale=l,Z.dataAxis=v,Z.screenOffset=x,y.drawArrays(y.TRIANGLES,ae,le)),x[0]=(C[2]+C[0])/k-1,x[1]=2*(C[1]-X[0])/B-1,l[0]=re[0]*S/k,l[1]=X[0]*S/B,ne&&(Z.color=ue[0],Z.tickScale=l,Z.dataAxis=p,Z.screenOffset=x,y.drawArrays(y.TRIANGLES,ee,ne)),x[0]=2*(C[2]+X[3])/k-1,x[1]=(C[3]+C[1])/B-1,l[0]=X[3]*S/k,l[1]=re[3]*S/B,le&&(Z.color=ue[3],Z.tickScale=l,Z.dataAxis=v,Z.screenOffset=x,y.drawArrays(y.TRIANGLES,ae,le)),x[0]=(C[2]+C[0])/k-1,x[1]=2*(C[3]+X[2])/B-1,l[0]=re[2]*S/k,l[1]=X[2]*S/B,ne&&(Z.color=ue[2],Z.tickScale=l,Z.dataAxis=p,Z.screenOffset=x,y.drawArrays(y.TRIANGLES,ee,ne))}}(),o.update=function(){var m=[1,1,-1,-1,1,-1],g=[1,-1,1,1,-1,-1];return function(p){var v=p.ticks,x=p.bounds,l=new Float32Array(6*3*(v[0].length+v[1].length));this.plot.zeroLineEnable;for(var b=0,c=[[],[]],M=0;M<2;++M)for(var _=c[M],y=v[M],w=x[M],d=x[M+2],C=0;C<y.length;++C){var S=(y[C].x-w)/(d-w);_.push(S);for(var E=0;E<6;++E)l[b++]=S,l[b++]=m[E],l[b++]=g[E]}this.ticks=c,this.vbo.update(l)}}(),o.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()};function s(m){var g=m.gl,p=e(g),v=i(g,a.gridVert,a.gridFrag),x=i(g,a.tickVert,a.gridFrag),l=new r(m,p,v,x);return l}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(u,A,T){A.exports=f;var e=u("gl-buffer"),i=u("gl-shader"),n=u("./shaders");function a(o,s,m){this.plot=o,this.vbo=s,this.shader=m}var r=a.prototype;r.bind=function(){var o=this.shader;this.vbo.bind(),this.shader.bind(),o.attributes.coord.pointer(),o.uniforms.screenBox=this.plot.screenBox},r.drawLine=function(){var o=[0,0],s=[0,0];return function(m,g,p,v,x,l){var b=this.plot,c=this.shader,M=b.gl;o[0]=m,o[1]=g,s[0]=p,s[1]=v,c.uniforms.start=o,c.uniforms.end=s,c.uniforms.width=x*b.pixelRatio,c.uniforms.color=l,M.drawArrays(M.TRIANGLE_STRIP,0,4)}}(),r.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function f(o){var s=o.gl,m=e(s,[-1,-1,-1,1,1,-1,1,1]),g=i(s,n.lineVert,n.lineFrag),p=new a(o,m,g);return p}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(u,A,T){var e=u("glslify"),i=e([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);A.exports={lineVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:i,textVert:e([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:i,gridVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:i,boxVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:231}],117:[function(u,A,T){A.exports=s;var e=u("gl-buffer"),i=u("gl-shader"),n=u("text-cache"),a=u("binary-search-bounds"),r=u("./shaders");function f(m,g,p){this.plot=m,this.vbo=g,this.shader=p,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var o=f.prototype;o.drawTicks=function(){var m=[0,0],g=[0,0],p=[0,0];return function(v){var x=this.plot,l=this.shader,b=this.tickX[v],c=this.tickOffset[v],M=x.gl,_=x.viewBox,y=x.dataBox,w=x.screenBox,d=x.pixelRatio,C=x.tickEnable,S=x.tickPad,E=x.tickColor,k=x.tickAngle,B=x.labelEnable,z=x.labelPad,F=x.labelColor,I=x.labelAngle,O=this.labelOffset[v],N=this.labelCount[v],V=a.lt(b,y[v]),H=a.le(b,y[v+2]);m[0]=m[1]=0,m[v]=1,g[v]=(_[2+v]+_[v])/(w[2+v]-w[v])-1;var j=2/w[2+(v^1)]-w[v^1];g[v^1]=j*_[v^1]-1,C[v]&&(g[v^1]-=j*d*S[v],V<H&&c[H]>c[V]&&(l.uniforms.dataAxis=m,l.uniforms.screenOffset=g,l.uniforms.color=E[v],l.uniforms.angle=k[v],M.drawArrays(M.TRIANGLES,c[V],c[H]-c[V]))),B[v]&&N&&(g[v^1]-=j*d*z[v],l.uniforms.dataAxis=p,l.uniforms.screenOffset=g,l.uniforms.color=F[v],l.uniforms.angle=I[v],M.drawArrays(M.TRIANGLES,O,N)),g[v^1]=j*_[2+(v^1)]-1,C[v+2]&&(g[v^1]+=j*d*S[v+2],V<H&&c[H]>c[V]&&(l.uniforms.dataAxis=m,l.uniforms.screenOffset=g,l.uniforms.color=E[v+2],l.uniforms.angle=k[v+2],M.drawArrays(M.TRIANGLES,c[V],c[H]-c[V]))),B[v+2]&&N&&(g[v^1]+=j*d*z[v+2],l.uniforms.dataAxis=p,l.uniforms.screenOffset=g,l.uniforms.color=F[v+2],l.uniforms.angle=I[v+2],M.drawArrays(M.TRIANGLES,O,N))}}(),o.drawTitle=function(){var m=[0,0],g=[0,0];return function(){var p=this.plot,v=this.shader,x=p.gl,l=p.screenBox,b=p.titleCenter,c=p.titleAngle,M=p.titleColor,_=p.pixelRatio;if(!!this.titleCount){for(var y=0;y<2;++y)g[y]=2*(b[y]*_-l[y])/(l[2+y]-l[y])-1;v.bind(),v.uniforms.dataAxis=m,v.uniforms.screenOffset=g,v.uniforms.angle=c,v.uniforms.color=M,x.drawArrays(x.TRIANGLES,this.titleOffset,this.titleCount)}}}(),o.bind=function(){var m=[0,0],g=[0,0],p=[0,0];return function(){var v=this.plot,x=this.shader,l=v._tickBounds,b=v.dataBox,c=v.screenBox,M=v.viewBox;x.bind();for(var _=0;_<2;++_){var y=l[_],w=l[_+2],d=w-y,C=.5*(b[_+2]+b[_]),S=b[_+2]-b[_],E=M[_],k=M[_+2],B=k-E,z=c[_],F=c[_+2],I=F-z;g[_]=2*d/S*B/I,m[_]=2*(y-C)/S*B/I}p[1]=2*v.pixelRatio/(c[3]-c[1]),p[0]=p[1]*(c[3]-c[1])/(c[2]-c[0]),x.uniforms.dataScale=g,x.uniforms.dataShift=m,x.uniforms.textScale=p,this.vbo.bind(),x.attributes.textCoordinate.pointer()}}(),o.update=function(m){var g=[],p=m.ticks,v=m.bounds,x,l,b,c,M;for(M=0;M<2;++M){var _=[Math.floor(g.length/3)],y=[-1/0],w=p[M];for(x=0;x<w.length;++x){var d=w[x],C=d.x,S=d.text,E=d.font||"sans-serif";c=d.fontSize||12;for(var k=1/(v[M+2]-v[M]),B=v[M],z=S.split(`
`),F=0;F<z.length;F++)for(b=n(E,z[F]).data,l=0;l<b.length;l+=2)g.push(b[l]*c,-b[l+1]*c-F*c*1.2,(C-B)*k);_.push(Math.floor(g.length/3)),y.push(C)}this.tickOffset[M]=_,this.tickX[M]=y}for(M=0;M<2;++M){for(this.labelOffset[M]=Math.floor(g.length/3),b=n(m.labelFont[M],m.labels[M],{textAlign:"center"}).data,c=m.labelSize[M],x=0;x<b.length;x+=2)g.push(b[x]*c,-b[x+1]*c,0);this.labelCount[M]=Math.floor(g.length/3)-this.labelOffset[M]}for(this.titleOffset=Math.floor(g.length/3),b=n(m.titleFont,m.title).data,c=m.titleSize,x=0;x<b.length;x+=2)g.push(b[x]*c,-b[x+1]*c,0);this.titleCount=Math.floor(g.length/3)-this.titleOffset,this.vbo.update(g)},o.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function s(m){var g=m.gl,p=e(g),v=i(g,r.textVert,r.textFrag),x=new f(m,p,v);return x}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(u,A,T){A.exports=g;var e=u("gl-select-static"),i=u("./lib/grid"),n=u("./lib/text"),a=u("./lib/line"),r=u("./lib/box");function f(p,v){this.gl=p,this.pickBuffer=v,this.screenBox=[0,0,p.drawingBufferWidth,p.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var o=f.prototype;o.setDirty=function(){this.dirty=this.pickDirty=!0},o.setOverlayDirty=function(){this.dirty=!0},o.nextDepthValue=function(){return this._depthCounter++/65536},o.draw=function(){return function(){var p=this.gl,v=this.screenBox,x=this.viewBox,l=this.dataBox,b=this.pixelRatio,c=this.grid,M=this.line,_=this.text,y=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),!!this.dirty){if(this.dirty=!1,p.bindFramebuffer(p.FRAMEBUFFER,null),p.enable(p.SCISSOR_TEST),p.disable(p.DEPTH_TEST),p.depthFunc(p.LESS),p.depthMask(!1),p.enable(p.BLEND),p.blendEquation(p.FUNC_ADD,p.FUNC_ADD),p.blendFunc(p.ONE,p.ONE_MINUS_SRC_ALPHA),this.borderColor){p.scissor(v[0],v[1],v[2]-v[0],v[3]-v[1]);var w=this.borderColor;p.clearColor(w[0]*w[3],w[1]*w[3],w[2]*w[3],w[3]),p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT)}p.scissor(x[0],x[1],x[2]-x[0],x[3]-x[1]),p.viewport(x[0],x[1],x[2]-x[0],x[3]-x[1]);var d=this.backgroundColor;p.clearColor(d[0]*d[3],d[1]*d[3],d[2]*d[3],d[3]),p.clear(p.COLOR_BUFFER_BIT),c.draw();var C=this.zeroLineEnable,S=this.zeroLineColor,E=this.zeroLineWidth;if(C[0]||C[1]){M.bind();for(var k=0;k<2;++k)if(!(!C[k]||!(l[k]<=0&&l[k+2]>=0))){var B=v[k]-l[k]*(v[k+2]-v[k])/(l[k+2]-l[k]);k===0?M.drawLine(B,v[1],B,v[3],E[k],S[k]):M.drawLine(v[0],B,v[2],B,E[k],S[k])}}for(var k=0;k<y.length;++k)y[k].draw();p.viewport(v[0],v[1],v[2]-v[0],v[3]-v[1]),p.scissor(v[0],v[1],v[2]-v[0],v[3]-v[1]),this.grid.drawTickMarks(),M.bind();var z=this.borderLineEnable,F=this.borderLineWidth,I=this.borderLineColor;z[1]&&M.drawLine(x[0],x[1]-.5*F[1]*b,x[0],x[3]+.5*F[3]*b,F[1],I[1]),z[0]&&M.drawLine(x[0]-.5*F[0]*b,x[1],x[2]+.5*F[2]*b,x[1],F[0],I[0]),z[3]&&M.drawLine(x[2],x[1]-.5*F[1]*b,x[2],x[3]+.5*F[3]*b,F[3],I[3]),z[2]&&M.drawLine(x[0]-.5*F[0]*b,x[3],x[2]+.5*F[2]*b,x[3],F[2],I[2]),_.bind();for(var k=0;k<2;++k)_.drawTicks(k);this.titleEnable&&_.drawTitle();for(var O=this.overlays,k=0;k<O.length;++k)O[k].draw();p.disable(p.SCISSOR_TEST),p.disable(p.BLEND),p.depthMask(!0)}}}(),o.drawPick=function(){return function(){if(!this.static){var p=this.pickBuffer;this.gl,this._pickTimeout=null,p.begin();for(var v=1,x=this.objects,l=0;l<x.length;++l)v=x[l].drawPick(v);p.end()}}}(),o.pick=function(){return function(p,v){if(!this.static){var x=this.pixelRatio,l=this.pickPixelRatio,b=this.viewBox,c=Math.round((p-b[0]/x)*l)|0,M=Math.round((v-b[1]/x)*l)|0,_=this.pickBuffer.query(c,M,this.pickRadius);if(!_)return null;for(var y=_.id+(_.value[0]<<8)+(_.value[1]<<16)+(_.value[2]<<24),w=this.objects,d=0;d<w.length;++d){var C=w[d].pick(c,M,y);if(C)return C}return null}}}();function s(p){for(var v=p.slice(),x=0;x<v.length;++x)v[x]=v[x].slice();return v}function m(p,v){return p.x-v.x}o.setScreenBox=function(p){var v=this.screenBox,x=this.pixelRatio;v[0]=Math.round(p[0]*x)|0,v[1]=Math.round(p[1]*x)|0,v[2]=Math.round(p[2]*x)|0,v[3]=Math.round(p[3]*x)|0,this.setDirty()},o.setDataBox=function(p){var v=this.dataBox,x=v[0]!==p[0]||v[1]!==p[1]||v[2]!==p[2]||v[3]!==p[3];x&&(v[0]=p[0],v[1]=p[1],v[2]=p[2],v[3]=p[3],this.setDirty())},o.setViewBox=function(p){var v=this.pixelRatio,x=this.viewBox;x[0]=Math.round(p[0]*v)|0,x[1]=Math.round(p[1]*v)|0,x[2]=Math.round(p[2]*v)|0,x[3]=Math.round(p[3]*v)|0;var l=this.pickPixelRatio;this.pickBuffer.shape=[Math.round((p[2]-p[0])*l)|0,Math.round((p[3]-p[1])*l)|0],this.setDirty()},o.update=function(p){p=p||{};var v=this.gl;this.pixelRatio=p.pixelRatio||1;var x=this.pixelRatio;this.pickPixelRatio=Math.max(x,1),this.setScreenBox(p.screenBox||[0,0,v.drawingBufferWidth/x,v.drawingBufferHeight/x]),this.screenBox,this.setViewBox(p.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/x,.125*(this.screenBox[3]-this.screenBox[1])/x,.875*(this.screenBox[2]-this.screenBox[0])/x,.875*(this.screenBox[3]-this.screenBox[1])/x]);var l=this.viewBox,b=(l[2]-l[0])/(l[3]-l[1]);this.setDataBox(p.dataBox||[-10,-10/b,10,10/b]),this.borderColor=p.borderColor!==!1?(p.borderColor||[0,0,0,0]).slice():!1,this.backgroundColor=(p.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(p.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(p.gridLineWidth||[1,1]).slice(),this.gridLineColor=s(p.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(p.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(p.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=s(p.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(p.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(p.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=s(p.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(p.titleCenter||[.5*(l[0]+l[2])/x,(l[3]+120)/x]).slice(),this.titleEnable=!("titleEnable"in p)||!!p.titleEnable,this.titleAngle=p.titleAngle||0,this.titleColor=(p.titleColor||[0,0,0,1]).slice(),this.labelPad=(p.labelPad||[15,15,15,15]).slice(),this.labelAngle=(p.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(p.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=s(p.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(p.tickPad||[15,15,15,15]).slice(),this.tickAngle=(p.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(p.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=s(p.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(p.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(p.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=s(p.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var c=p.ticks||[[],[]],M=this._tickBounds;M[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(var _=0;_<2;++_){var y=c[_].slice(0);y.length!==0&&(y.sort(m),M[_]=Math.min(M[_],y[0].x),M[_+2]=Math.max(M[_+2],y[y.length-1].x))}this.grid.update({bounds:M,ticks:c}),this.text.update({bounds:M,ticks:c,labels:p.labels||["x","y"],labelSize:p.labelSize||[12,12],labelFont:p.labelFont||["sans-serif","sans-serif"],title:p.title||"",titleSize:p.titleSize||18,titleFont:p.titleFont||"sans-serif"}),this.static=!!p.static,this.setDirty()},o.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var p=this.objects.length-1;p>=0;--p)this.objects[p].dispose();this.objects.length=0;for(var p=this.overlays.length-1;p>=0;--p)this.overlays[p].dispose();this.overlays.length=0,this.gl=null},o.addObject=function(p){this.objects.indexOf(p)<0&&(this.objects.push(p),this.setDirty())},o.removeObject=function(p){for(var v=this.objects,x=0;x<v.length;++x)if(v[x]===p){v.splice(x,1),this.setDirty();break}},o.addOverlay=function(p){this.overlays.indexOf(p)<0&&(this.overlays.push(p),this.setOverlayDirty())},o.removeOverlay=function(p){for(var v=this.overlays,x=0;x<v.length;++x)if(v[x]===p){v.splice(x,1),this.setOverlayDirty();break}};function g(p){var v=p.gl,x=e(v,[v.drawingBufferWidth,v.drawingBufferHeight]),l=new f(v,x);return l.grid=i(l),l.text=n(l),l.line=a(l),l.box=r(l),l.update(p),l}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(u,A,T){A.exports=o;var e=u("right-now"),i=u("3d-view"),n=u("mouse-change"),a=u("mouse-wheel"),r=u("mouse-event-offset"),f=u("has-passive-events");function o(s,m){s=s||document.body,m=m||{};var g=[.01,1/0];"distanceLimits"in m&&(g[0]=m.distanceLimits[0],g[1]=m.distanceLimits[1]),"zoomMin"in m&&(g[0]=m.zoomMin),"zoomMax"in m&&(g[1]=m.zoomMax);var p=i({center:m.center||[0,0,0],up:m.up||[0,1,0],eye:m.eye||[0,0,10],mode:m.mode||"orbit",distanceLimits:g}),v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=0,l=s.clientWidth,b=s.clientHeight,c={keyBindingMode:"rotate",enableWheel:!0,view:p,element:s,delay:m.delay||16,rotateSpeed:m.rotateSpeed||1,zoomSpeed:m.zoomSpeed||1,translateSpeed:m.translateSpeed||1,flipX:!!m.flipX,flipY:!!m.flipY,modes:p.modes,_ortho:m._ortho||m.projection&&m.projection.type==="orthographic"||!1,tick:function(){var M=e(),_=this.delay,y=M-2*_;p.idle(M-_),p.recalcMatrix(y),p.flush(M-(100+_*2));for(var w=!0,d=p.computedMatrix,C=0;C<16;++C)w=w&&v[C]===d[C],v[C]=d[C];var S=s.clientWidth===l&&s.clientHeight===b;return l=s.clientWidth,b=s.clientHeight,w?!S:(x=Math.exp(p.computedRadius[0]),!0)},lookAt:function(M,_,y){p.lookAt(p.lastT(),M,_,y)},rotate:function(M,_,y){p.rotate(p.lastT(),M,_,y)},pan:function(M,_,y){p.pan(p.lastT(),M,_,y)},translate:function(M,_,y){p.translate(p.lastT(),M,_,y)}};return Object.defineProperties(c,{matrix:{get:function(){return p.computedMatrix},set:function(M){return p.setMatrix(p.lastT(),M),p.computedMatrix},enumerable:!0},mode:{get:function(){return p.getMode()},set:function(M){var _=p.computedUp.slice(),y=p.computedEye.slice(),w=p.computedCenter.slice();if(p.setMode(M),M==="turntable"){var d=e();p._active.lookAt(d,y,w,_),p._active.lookAt(d+500,y,w,[0,0,1]),p._active.flush(d)}return p.getMode()},enumerable:!0},center:{get:function(){return p.computedCenter},set:function(M){return p.lookAt(p.lastT(),null,M),p.computedCenter},enumerable:!0},eye:{get:function(){return p.computedEye},set:function(M){return p.lookAt(p.lastT(),M),p.computedEye},enumerable:!0},up:{get:function(){return p.computedUp},set:function(M){return p.lookAt(p.lastT(),null,null,M),p.computedUp},enumerable:!0},distance:{get:function(){return x},set:function(M){return p.setDistance(p.lastT(),M),M},enumerable:!0},distanceLimits:{get:function(){return p.getDistanceLimits(g)},set:function(M){return p.setDistanceLimits(M),M},enumerable:!0}}),s.addEventListener("contextmenu",function(M){return M.preventDefault(),!1}),c._lastX=-1,c._lastY=-1,c._lastMods={shift:!1,control:!1,alt:!1,meta:!1},c.enableMouseListeners=function(){c.mouseListener=n(s,M),s.addEventListener("touchstart",function(_){var y=r(_.changedTouches[0],s);M(0,y[0],y[1],c._lastMods),M(1,y[0],y[1],c._lastMods)},f?{passive:!0}:!1),s.addEventListener("touchmove",function(_){var y=r(_.changedTouches[0],s);M(1,y[0],y[1],c._lastMods),_.preventDefault()},f?{passive:!1}:!1),s.addEventListener("touchend",function(_){M(0,c._lastX,c._lastY,c._lastMods)},f?{passive:!0}:!1);function M(_,y,w,d){var C=c.keyBindingMode;if(C!==!1){var S=C==="rotate",E=C==="pan",k=C==="zoom",B=!!d.control,z=!!d.alt,F=!!d.shift,I=!!(_&1),O=!!(_&2),N=!!(_&4),V=1/s.clientHeight,H=V*(y-c._lastX),j=V*(w-c._lastY),Z=c.flipX?1:-1,X=c.flipY?1:-1,re=Math.PI*c.rotateSpeed,ue=e();if(c._lastX!==-1&&c._lastY!==-1&&((S&&I&&!B&&!z&&!F||I&&!B&&!z&&F)&&p.rotate(ue,Z*re*H,-X*re*j,0),(E&&I&&!B&&!z&&!F||O||I&&B&&!z&&!F)&&p.pan(ue,-c.translateSpeed*H*x,c.translateSpeed*j*x,0),k&&I&&!B&&!z&&!F||N||I&&!B&&z&&!F)){var K=-c.zoomSpeed*j/window.innerHeight*(ue-p.lastT())*100;p.pan(ue,0,0,x*(Math.exp(K)-1))}return c._lastX=y,c._lastY=w,c._lastMods=d,!0}}c.wheelListener=a(s,function(_,y){if(c.keyBindingMode!==!1&&!!c.enableWheel){var w=c.flipX?1:-1,d=c.flipY?1:-1,C=e();if(Math.abs(_)>Math.abs(y))p.rotate(C,0,0,-_*w*Math.PI*c.rotateSpeed/window.innerWidth);else if(!c._ortho){var S=-c.zoomSpeed*d*y/window.innerHeight*(C-p.lastT())/20;p.pan(C,0,0,x*(Math.exp(S)-1))}}},!0)},c.enableMouseListeners(),c}},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(u,A,T){var e=u("glslify"),i=u("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),a=e([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);A.exports=function(r){return i(r,n,a,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(u,A,T){var e=u("./camera.js"),i=u("gl-axes3d"),n=u("gl-axes3d/properties"),a=u("gl-spikes3d"),r=u("gl-select-static"),f=u("gl-fbo"),o=u("a-big-triangle"),s=u("mouse-change"),m=u("gl-mat4/perspective"),g=u("gl-mat4/ortho"),p=u("./lib/shader"),v=u("is-mobile")({tablet:!0,featureDetect:!0});A.exports={createScene:M,createCamera:e};function x(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function l(y,w){var d=null;try{d=y.getContext("webgl",w),d||(d=y.getContext("experimental-webgl",w))}catch{return null}return d}function b(y){var w=Math.round(Math.log(Math.abs(y))/Math.log(10));if(w<0){var d=Math.round(Math.pow(10,-w));return Math.ceil(y*d)/d}else if(w>0){var d=Math.round(Math.pow(10,w));return Math.ceil(y/d)*d}return Math.ceil(y)}function c(y){return typeof y=="boolean"?y:!0}function M(y){y=y||{},y.camera=y.camera||{};var w=y.canvas;if(!w)if(w=document.createElement("canvas"),y.container){var d=y.container;d.appendChild(w)}else document.body.appendChild(w);var C=y.gl;if(C||(y.glOptions&&(v=!!y.glOptions.preserveDrawingBuffer),C=l(w,y.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:v})),!C)throw new Error("webgl not supported");var S=y.bounds||[[-10,-10,-10],[10,10,10]],E=new x,k=f(C,C.drawingBufferWidth,C.drawingBufferHeight,{preferFloat:!v}),B=p(C),z=y.cameraObject&&y.cameraObject._ortho===!0||y.camera.projection&&y.camera.projection.type==="orthographic"||!1,F={eye:y.camera.eye||[2,0,0],center:y.camera.center||[0,0,0],up:y.camera.up||[0,1,0],zoomMin:y.camera.zoomMax||.1,zoomMax:y.camera.zoomMin||100,mode:y.camera.mode||"turntable",_ortho:z},I=y.axes||{},O=i(C,I);O.enable=!I.disable;var N=y.spikes||{},V=a(C,N),H=[],j=[],Z=[],X=[],re=!0,G=!0,ue=new Array(16),K=new Array(16),te={view:null,projection:ue,model:K,_ortho:!1},G=!0,Y=[C.drawingBufferWidth,C.drawingBufferHeight],ee=y.cameraObject||e(w,F),ne={gl:C,contextLost:!1,pixelRatio:y.pixelRatio||1,canvas:w,selection:E,camera:ee,axes:O,axesPixels:null,spikes:V,bounds:S,objects:H,shape:Y,aspect:y.aspectRatio||[1,1,1],pickRadius:y.pickRadius||10,zNear:y.zNear||.01,zFar:y.zFar||1e3,fovy:y.fovy||Math.PI/4,clearColor:y.clearColor||[0,0,0,0],autoResize:c(y.autoResize),autoBounds:c(y.autoBounds),autoScale:!!y.autoScale,autoCenter:c(y.autoCenter),clipToBounds:c(y.clipToBounds),snapToData:!!y.snapToData,onselect:y.onselect||null,onrender:y.onrender||null,onclick:y.onclick||null,cameraParams:te,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(be){this.aspect[0]=be.x,this.aspect[1]=be.y,this.aspect[2]=be.z,G=!0},setBounds:function(be,me){this.bounds[0][be]=me.min,this.bounds[1][be]=me.max},setClearColor:function(be){this.clearColor=be},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},J=[C.drawingBufferWidth/ne.pixelRatio|0,C.drawingBufferHeight/ne.pixelRatio|0];function q(){if(!ne._stopped&&!!ne.autoResize){var be=w.parentNode,me=1,_e=1;be&&be!==document.body?(me=be.clientWidth,_e=be.clientHeight):(me=window.innerWidth,_e=window.innerHeight);var Se=Math.ceil(me*ne.pixelRatio)|0,De=Math.ceil(_e*ne.pixelRatio)|0;if(Se!==w.width||De!==w.height){w.width=Se,w.height=De;var Ie=w.style;Ie.position=Ie.position||"absolute",Ie.left="0px",Ie.top="0px",Ie.width=me+"px",Ie.height=_e+"px",re=!0}}}ne.autoResize&&q(),window.addEventListener("resize",q);function ae(){for(var be=H.length,me=X.length,_e=0;_e<me;++_e)Z[_e]=0;e:for(var _e=0;_e<be;++_e){var Se=H[_e],De=Se.pickSlots;if(!De){j[_e]=-1;continue}for(var Ie=0;Ie<me;++Ie)if(Z[Ie]+De<255){j[_e]=Ie,Se.setPickBase(Z[Ie]+1),Z[Ie]+=De;continue e}var Te=r(C,Y);j[_e]=me,X.push(Te),Z.push(De),Se.setPickBase(1),me+=1}for(;me>0&&Z[me-1]===0;)Z.pop(),X.pop().dispose()}ne.update=function(be){ne._stopped||(re=!0,G=!0)},ne.add=function(be){ne._stopped||(be.axes=O,H.push(be),j.push(-1),re=!0,G=!0,ae())},ne.remove=function(be){if(!ne._stopped){var me=H.indexOf(be);me<0||(H.splice(me,1),j.pop(),re=!0,G=!0,ae())}},ne.dispose=function(){if(!ne._stopped&&(ne._stopped=!0,window.removeEventListener("resize",q),w.removeEventListener("webglcontextlost",le),ne.mouseListener.enabled=!1,!ne.contextLost)){O.dispose(),V.dispose();for(var be=0;be<H.length;++be)H[be].dispose();k.dispose();for(var be=0;be<X.length;++be)X[be].dispose();B.dispose(),C=null,O=null,V=null,H=[]}},ne._mouseRotating=!1,ne._prevButtons=0,ne.enableMouseListeners=function(){ne.mouseListener=s(w,function(be,me,_e){if(!ne._stopped){var Se=X.length,De=H.length,Ie=E.object;E.distance=1/0,E.mouse[0]=me,E.mouse[1]=_e,E.object=null,E.screen=null,E.dataCoordinate=E.dataPosition=null;var Te=!1;if(be&&ne._prevButtons)ne._mouseRotating=!0;else{ne._mouseRotating&&(G=!0),ne._mouseRotating=!1;for(var Ce=0;Ce<Se;++Ce){var He=X[Ce].query(me,J[1]-_e-1,ne.pickRadius);if(He){if(He.distance>E.distance)continue;for(var Xe=0;Xe<De;++Xe){var Be=H[Xe];if(j[Xe]===Ce){var Re=Be.pick(He);Re&&(E.buttons=be,E.screen=He.coord,E.distance=He.distance,E.object=Be,E.index=Re.distance,E.dataPosition=Re.position,E.dataCoordinate=Re.dataCoordinate,E.data=Re,Te=!0)}}}}}Ie&&Ie!==E.object&&(Ie.highlight&&Ie.highlight(null),re=!0),E.object&&(E.object.highlight&&E.object.highlight(E.data),re=!0),Te=Te||E.object!==Ie,Te&&ne.onselect&&ne.onselect(E),be&1&&!(ne._prevButtons&1)&&ne.onclick&&ne.onclick(E),ne._prevButtons=be}})};function le(){if(ne.contextLost)return!0;C.isContextLost()&&(ne.contextLost=!0,ne.mouseListener.enabled=!1,ne.selection.object=null,ne.oncontextloss&&ne.oncontextloss())}w.addEventListener("webglcontextlost",le);function ie(){if(!le()){C.colorMask(!0,!0,!0,!0),C.depthMask(!0),C.disable(C.BLEND),C.enable(C.DEPTH_TEST),C.depthFunc(C.LEQUAL);for(var be=H.length,me=X.length,_e=0;_e<me;++_e){var Se=X[_e];Se.shape=J,Se.begin();for(var De=0;De<be;++De)if(j[De]===_e){var Ie=H[De];Ie.drawPick&&(Ie.pixelRatio=1,Ie.drawPick(te))}Se.end()}}}var se=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],xe=[se[0].slice(),se[1].slice()];function oe(){if(!le()){q();var be=ne.camera.tick();te.view=ne.camera.matrix,re=re||be,G=G||be,O.pixelRatio=ne.pixelRatio,V.pixelRatio=ne.pixelRatio;var me=H.length,_e=se[0],Se=se[1];_e[0]=_e[1]=_e[2]=1/0,Se[0]=Se[1]=Se[2]=-1/0;for(var De=0;De<me;++De){var Ie=H[De];Ie.pixelRatio=ne.pixelRatio,Ie.axes=ne.axes,re=re||!!Ie.dirty,G=G||!!Ie.dirty;var Te=Ie.bounds;if(Te)for(var Ce=Te[0],He=Te[1],Xe=0;Xe<3;++Xe)_e[Xe]=Math.min(_e[Xe],Ce[Xe]),Se[Xe]=Math.max(Se[Xe],He[Xe])}var Be=ne.bounds;if(ne.autoBounds)for(var Xe=0;Xe<3;++Xe){if(Se[Xe]<_e[Xe])_e[Xe]=-1,Se[Xe]=1;else{_e[Xe]===Se[Xe]&&(_e[Xe]-=1,Se[Xe]+=1);var Re=.05*(Se[Xe]-_e[Xe]);_e[Xe]=_e[Xe]-Re,Se[Xe]=Se[Xe]+Re}Be[0][Xe]=_e[Xe],Be[1][Xe]=Se[Xe]}for(var We=!1,Xe=0;Xe<3;++Xe)We=We||xe[0][Xe]!==Be[0][Xe]||xe[1][Xe]!==Be[1][Xe],xe[0][Xe]=Be[0][Xe],xe[1][Xe]=Be[1][Xe];if(G=G||We,re=re||We,!!re){if(We){for(var vt=[0,0,0],De=0;De<3;++De)vt[De]=b((Be[1][De]-Be[0][De])/10);O.autoTicks?O.update({bounds:Be,tickSpacing:vt}):O.update({bounds:Be})}var Pt=C.drawingBufferWidth,Zt=C.drawingBufferHeight;Y[0]=Pt,Y[1]=Zt,J[0]=Math.max(Pt/ne.pixelRatio,1)|0,J[1]=Math.max(Zt/ne.pixelRatio,1)|0,_(ne,z);for(var De=0;De<me;++De){var Ie=H[De];Ie.axesBounds=Be,ne.clipToBounds&&(Ie.clipBounds=Be)}E.object&&(ne.snapToData?V.position=E.dataCoordinate:V.position=E.dataPosition,V.bounds=Be),G&&(G=!1,ie()),ne.axesPixels=n(ne.axes,te,Pt,Zt),ne.onrender&&ne.onrender(),C.bindFramebuffer(C.FRAMEBUFFER,null),C.viewport(0,0,Pt,Zt),ne.clearRGBA(),C.depthMask(!0),C.colorMask(!0,!0,!0,!0),C.enable(C.DEPTH_TEST),C.depthFunc(C.LEQUAL),C.disable(C.BLEND),C.disable(C.CULL_FACE);var zt=!1;O.enable&&(zt=zt||O.isTransparent(),O.draw(te)),V.axes=O,E.object&&V.draw(te),C.disable(C.CULL_FACE);for(var De=0;De<me;++De){var Ie=H[De];Ie.axes=O,Ie.pixelRatio=ne.pixelRatio,Ie.isOpaque&&Ie.isOpaque()&&Ie.draw(te),Ie.isTransparent&&Ie.isTransparent()&&(zt=!0)}if(zt){k.shape=Y,k.bind(),C.clear(C.DEPTH_BUFFER_BIT),C.colorMask(!1,!1,!1,!1),C.depthMask(!0),C.depthFunc(C.LESS),O.enable&&O.isTransparent()&&O.drawTransparent(te);for(var De=0;De<me;++De){var Ie=H[De];Ie.isOpaque&&Ie.isOpaque()&&Ie.draw(te)}C.enable(C.BLEND),C.blendEquation(C.FUNC_ADD),C.blendFunc(C.ONE,C.ONE_MINUS_SRC_ALPHA),C.colorMask(!0,!0,!0,!0),C.depthMask(!1),C.clearColor(0,0,0,0),C.clear(C.COLOR_BUFFER_BIT),O.isTransparent()&&O.drawTransparent(te);for(var De=0;De<me;++De){var Ie=H[De];Ie.isTransparent&&Ie.isTransparent()&&Ie.drawTransparent(te)}C.bindFramebuffer(C.FRAMEBUFFER,null),C.blendFunc(C.ONE,C.ONE_MINUS_SRC_ALPHA),C.disable(C.DEPTH_TEST),B.bind(),k.color[0].bind(0),B.uniforms.accumBuffer=0,o(C),C.disable(C.BLEND)}re=!1;for(var De=0;De<me;++De)H[De].dirty=!1}}}function he(){ne._stopped||ne.contextLost||(oe(),requestAnimationFrame(he))}return ne.enableMouseListeners(),he(),ne.redraw=function(){ne._stopped||(re=!0,oe())},ne}function _(y,w){var d=y.bounds,C=y.cameraParams,S=C.projection,E=C.model,k=y.gl.drawingBufferWidth,B=y.gl.drawingBufferHeight,z=y.zNear,F=y.zFar,I=y.fovy,O=k/B;w?(g(S,-O,O,-1,1,z,F),C._ortho=!0):(m(S,I,O,z,F),C._ortho=!1);for(var N=0;N<16;++N)E[N]=0;E[15]=1;for(var V=0,N=0;N<3;++N)V=Math.max(V,d[1][N]-d[0][N]);for(var N=0;N<3;++N)y.autoScale?E[5*N]=y.aspect[N]/(d[1][N]-d[0][N]):E[5*N]=1/V,y.autoCenter&&(E[12+N]=-E[5*N]*.5*(d[0][N]+d[1][N]))}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(u,A,T){var e=u("glslify");T.pointVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),T.pointFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),T.pickVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),T.pickFragment=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:231}],123:[function(u,A,T){var e=u("gl-shader"),i=u("gl-buffer"),n=u("typedarray-pool"),a=u("./lib/shader");A.exports=s;function r(m,g,p,v,x){this.plot=m,this.offsetBuffer=g,this.pickBuffer=p,this.shader=v,this.pickShader=x,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}var f=r.prototype;f.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},f.update=function(m){var g;m=m||{};function p(_,y){return _ in m?m[_]:y}this.sizeMin=p("sizeMin",.5),this.sizeMax=p("sizeMax",20),this.color=p("color",[1,0,0,1]).slice(),this.areaRatio=p("areaRatio",1),this.borderColor=p("borderColor",[0,0,0,1]).slice(),this.blend=p("blend",!1);var v=m.positions.length>>>1,x=m.positions instanceof Float32Array,l=m.idToIndex instanceof Int32Array&&m.idToIndex.length>=v,b=m.positions,c=x?b:n.mallocFloat32(b.length),M=l?m.idToIndex:n.mallocInt32(v);if(x||c.set(b),!l)for(c.set(b),g=0;g<v;g++)M[g]=g;this.points=b,this.offsetBuffer.update(c),this.pickBuffer.update(M),x||n.free(c),l||n.free(M),this.pointCount=v,this.pickOffset=0};function o(m,g){var p=0,v=m.length>>>1,x;for(x=0;x<v;x++){var l=m[x*2],b=m[x*2+1];l>=g[0]&&l<=g[2]&&b>=g[1]&&b<=g[3]&&p++}return p}f.unifiedDraw=function(){var m=[1,0,0,0,1,0,0,0,1],g=[0,0,0,0];return function(p){var v=p!==void 0,x=v?this.pickShader:this.shader,l=this.plot.gl,b=this.plot.dataBox;if(this.pointCount===0)return p;var c=b[2]-b[0],M=b[3]-b[1],_=o(this.points,b),y=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(_,.33333)));m[0]=2/c,m[4]=2/M,m[6]=-2*b[0]/c-1,m[7]=-2*b[1]/M-1,this.offsetBuffer.bind(),x.bind(),x.attributes.position.pointer(),x.uniforms.matrix=m,x.uniforms.color=this.color,x.uniforms.borderColor=this.borderColor,x.uniforms.pointCloud=y<5,x.uniforms.pointSize=y,x.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),v&&(g[0]=p&255,g[1]=p>>8&255,g[2]=p>>16&255,g[3]=p>>24&255,this.pickBuffer.bind(),x.attributes.pickId.pointer(l.UNSIGNED_BYTE),x.uniforms.pickOffset=g,this.pickOffset=p);var w=l.getParameter(l.BLEND),d=l.getParameter(l.DITHER);return w&&!this.blend&&l.disable(l.BLEND),d&&l.disable(l.DITHER),l.drawArrays(l.POINTS,0,this.pointCount),w&&!this.blend&&l.enable(l.BLEND),d&&l.enable(l.DITHER),p+this.pointCount}}(),f.draw=f.unifiedDraw,f.drawPick=f.unifiedDraw,f.pick=function(m,g,p){var v=this.pickOffset,x=this.pointCount;if(p<v||p>=v+x)return null;var l=p-v,b=this.points;return{object:this,pointId:l,dataCoord:[b[2*l],b[2*l+1]]}};function s(m,g){var p=m.gl,v=i(p),x=i(p),l=e(p,a.pointVertex,a.pointFragment),b=e(p,a.pickVertex,a.pickFragment),c=new r(m,v,x,l,b);return c.update(g),m.addObject(c),c}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(u,A,T){A.exports=e;function e(i,n,a,r){var f=n[0],o=n[1],s=n[2],m=n[3],g=a[0],p=a[1],v=a[2],x=a[3],l,b,c,M,_;return b=f*g+o*p+s*v+m*x,b<0&&(b=-b,g=-g,p=-p,v=-v,x=-x),1-b>1e-6?(l=Math.acos(b),c=Math.sin(l),M=Math.sin((1-r)*l)/c,_=Math.sin(r*l)/c):(M=1-r,_=r),i[0]=M*f+_*g,i[1]=M*o+_*p,i[2]=M*s+_*v,i[3]=M*m+_*x,i}},{}],125:[function(u,A,T){A.exports=function(e){return!e&&e!==0?"":e.toString()}},{}],126:[function(u,A,T){var e=u("vectorize-text");A.exports=n;var i={};function n(a,r,f){var o=i[r];if(o||(o=i[r]={}),a in o)return o[a];var s={textAlign:"center",textBaseline:"middle",lineHeight:1,font:r,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}};s.triangles=!0;var m=e(a,s);s.triangles=!1;var g=e(a,s),p,v;if(f&&f!==1){for(p=0;p<m.positions.length;++p)for(v=0;v<m.positions[p].length;++v)m.positions[p][v]/=f;for(p=0;p<g.positions.length;++p)for(v=0;v<g.positions[p].length;++v)g.positions[p][v]/=f}var x=[[1/0,1/0],[-1/0,-1/0]],l=g.positions.length;for(p=0;p<l;++p){var b=g.positions[p];for(v=0;v<2;++v)x[0][v]=Math.min(x[0][v],b[v]),x[1][v]=Math.max(x[1][v],b[v])}return o[a]=[m,g,x]}},{"vectorize-text":311}],127:[function(u,A,T){var e=u("gl-shader"),i=u("glslify"),n=i([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),a=i([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),r=i([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),f=i([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),o=i([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),s=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],m={vertex:n,fragment:f,attributes:s},g={vertex:a,fragment:f,attributes:s},p={vertex:r,fragment:f,attributes:s},v={vertex:n,fragment:o,attributes:s},x={vertex:a,fragment:o,attributes:s},l={vertex:r,fragment:o,attributes:s};function b(c,M){var _=e(c,M),y=_.attributes;return y.position.location=0,y.color.location=1,y.glyph.location=2,y.id.location=3,_}T.createPerspective=function(c){return b(c,m)},T.createOrtho=function(c){return b(c,g)},T.createProject=function(c){return b(c,p)},T.createPickPerspective=function(c){return b(c,v)},T.createPickOrtho=function(c){return b(c,x)},T.createPickProject=function(c){return b(c,l)}},{"gl-shader":132,glslify:231}],128:[function(u,A,T){var e=u("is-string-blank"),i=u("gl-buffer"),n=u("gl-vao"),a=u("typedarray-pool"),r=u("gl-mat4/multiply"),f=u("./lib/shaders"),o=u("./lib/glyphs"),s=u("./lib/get-simple-string"),m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];A.exports=j;function g(Z,X){var re=Z[0],ue=Z[1],K=Z[2],te=Z[3];return Z[0]=X[0]*re+X[4]*ue+X[8]*K+X[12]*te,Z[1]=X[1]*re+X[5]*ue+X[9]*K+X[13]*te,Z[2]=X[2]*re+X[6]*ue+X[10]*K+X[14]*te,Z[3]=X[3]*re+X[7]*ue+X[11]*K+X[15]*te,Z}function p(Z,X,re,ue){return g(ue,ue),g(ue,ue),g(ue,ue)}function v(Z,X){this.index=Z,this.dataCoordinate=this.position=X}function x(Z){return Z===!0||Z>1?1:Z}function l(Z,X,re,ue,K,te,G,Y,ee,ne,J,q){this.gl=Z,this.pixelRatio=1,this.shader=X,this.orthoShader=re,this.projectShader=ue,this.pointBuffer=K,this.colorBuffer=te,this.glyphBuffer=G,this.idBuffer=Y,this.vao=ee,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=ne,this.pickOrthoShader=J,this.pickProjectShader=q,this.points=[],this._selectResult=new v(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}var b=l.prototype;b.pickSlots=1,b.setPickBase=function(Z){this.pickId=Z},b.isTransparent=function(){if(this.hasAlpha)return!0;for(var Z=0;Z<3;++Z)if(this.axesProject[Z]&&this.projectHasAlpha)return!0;return!1},b.isOpaque=function(){if(!this.hasAlpha)return!0;for(var Z=0;Z<3;++Z)if(this.axesProject[Z]&&!this.projectHasAlpha)return!0;return!1};var c=[0,0],M=[0,0,0],_=[0,0,0],y=[0,0,0,1],w=[0,0,0,1],d=m.slice(),C=[0,0,0],S=[[0,0,0],[0,0,0]];function E(Z){return Z[0]=Z[1]=Z[2]=0,Z}function k(Z,X){return Z[0]=X[0],Z[1]=X[1],Z[2]=X[2],Z[3]=1,Z}function B(Z,X,re,ue){return Z[0]=X[0],Z[1]=X[1],Z[2]=X[2],Z[re]=ue,Z}function z(Z){for(var X=S,re=0;re<2;++re)for(var ue=0;ue<3;++ue)X[re][ue]=Math.max(Math.min(Z[re][ue],1e8),-1e8);return X}function F(Z,X,re,ue){var K=X.axesProject,te=X.gl,G=Z.uniforms,Y=re.model||m,ee=re.view||m,ne=re.projection||m,J=X.axesBounds,q=z(X.clipBounds),ae;X.axes&&X.axes.lastCubeProps?ae=X.axes.lastCubeProps.axis:ae=[1,1,1],c[0]=2/te.drawingBufferWidth,c[1]=2/te.drawingBufferHeight,Z.bind(),G.view=ee,G.projection=ne,G.screenSize=c,G.highlightId=X.highlightId,G.highlightScale=X.highlightScale,G.clipBounds=q,G.pickGroup=X.pickId/255,G.pixelRatio=ue;for(var le=0;le<3;++le)if(!!K[le]){G.scale=X.projectScale[le],G.opacity=X.projectOpacity[le];for(var ie=d,se=0;se<16;++se)ie[se]=0;for(var se=0;se<4;++se)ie[5*se]=1;ie[5*le]=0,ae[le]<0?ie[12+le]=J[0][le]:ie[12+le]=J[1][le],r(ie,Y,ie),G.model=ie;var xe=(le+1)%3,oe=(le+2)%3,he=E(M),be=E(_);he[xe]=1,be[oe]=1;var me=p(ne,ee,Y,k(y,he)),_e=p(ne,ee,Y,k(w,be));if(Math.abs(me[1])>Math.abs(_e[1])){var Se=me;me=_e,_e=Se,Se=he,he=be,be=Se;var De=xe;xe=oe,oe=De}me[0]<0&&(he[xe]=-1),_e[1]>0&&(be[oe]=-1);for(var Ie=0,Te=0,se=0;se<4;++se)Ie+=Math.pow(Y[4*xe+se],2),Te+=Math.pow(Y[4*oe+se],2);he[xe]/=Math.sqrt(Ie),be[oe]/=Math.sqrt(Te),G.axes[0]=he,G.axes[1]=be,G.fragClipBounds[0]=B(C,q[0],le,-1e8),G.fragClipBounds[1]=B(C,q[1],le,1e8),X.vao.bind(),X.vao.draw(te.TRIANGLES,X.vertexCount),X.lineWidth>0&&(te.lineWidth(X.lineWidth*ue),X.vao.draw(te.LINES,X.lineVertexCount,X.vertexCount)),X.vao.unbind()}}var I=[-1e8,-1e8,-1e8],O=[1e8,1e8,1e8],N=[I,O];function V(Z,X,re,ue,K,te,G){var Y=re.gl;if((te===re.projectHasAlpha||G)&&F(X,re,ue,K),te===re.hasAlpha||G){Z.bind();var ee=Z.uniforms;ee.model=ue.model||m,ee.view=ue.view||m,ee.projection=ue.projection||m,c[0]=2/Y.drawingBufferWidth,c[1]=2/Y.drawingBufferHeight,ee.screenSize=c,ee.highlightId=re.highlightId,ee.highlightScale=re.highlightScale,ee.fragClipBounds=N,ee.clipBounds=re.axes.bounds,ee.opacity=re.opacity,ee.pickGroup=re.pickId/255,ee.pixelRatio=K,re.vao.bind(),re.vao.draw(Y.TRIANGLES,re.vertexCount),re.lineWidth>0&&(Y.lineWidth(re.lineWidth*K),re.vao.draw(Y.LINES,re.lineVertexCount,re.vertexCount)),re.vao.unbind()}}b.draw=function(Z){var X=this.useOrtho?this.orthoShader:this.shader;V(X,this.projectShader,this,Z,this.pixelRatio,!1,!1)},b.drawTransparent=function(Z){var X=this.useOrtho?this.orthoShader:this.shader;V(X,this.projectShader,this,Z,this.pixelRatio,!0,!1)},b.drawPick=function(Z){var X=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;V(X,this.pickProjectShader,this,Z,1,!0,!0)},b.pick=function(Z){if(!Z||Z.id!==this.pickId)return null;var X=Z.value[2]+(Z.value[1]<<8)+(Z.value[0]<<16);if(X>=this.pointCount||X<0)return null;var re=this.points[X],ue=this._selectResult;ue.index=X;for(var K=0;K<3;++K)ue.position[K]=ue.dataCoordinate[K]=re[K];return ue},b.highlight=function(Z){if(!Z)this.highlightId=[1,1,1,1];else{var X=Z.index,re=X&255,ue=X>>8&255,K=X>>16&255;this.highlightId=[re/255,ue/255,K/255,0]}};function H(Z,X,re,ue){var K;Array.isArray(Z)?X<Z.length?K=Z[X]:K=void 0:K=Z,K=s(K);var te=!0;e(K)&&(K="\u25BC",te=!1);var G=o(K,re,ue);return{mesh:G[0],lines:G[1],bounds:G[2],visible:te}}b.update=function(Z){if(Z=Z||{},"perspective"in Z&&(this.useOrtho=!Z.perspective),"orthographic"in Z&&(this.useOrtho=!!Z.orthographic),"lineWidth"in Z&&(this.lineWidth=Z.lineWidth),"project"in Z)if(Array.isArray(Z.project))this.axesProject=Z.project;else{var X=!!Z.project;this.axesProject=[X,X,X]}if("projectScale"in Z)if(Array.isArray(Z.projectScale))this.projectScale=Z.projectScale.slice();else{var re=+Z.projectScale;this.projectScale=[re,re,re]}if(this.projectHasAlpha=!1,"projectOpacity"in Z){if(Array.isArray(Z.projectOpacity))this.projectOpacity=Z.projectOpacity.slice();else{var re=+Z.projectOpacity;this.projectOpacity=[re,re,re]}for(var ue=0;ue<3;++ue)this.projectOpacity[ue]=x(this.projectOpacity[ue]),this.projectOpacity[ue]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in Z&&(this.opacity=x(Z.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var K=Z.position,te=Z.font||"normal",G=Z.alignment||[0,0],Y,ee;if(G.length===2)Y=G[0],ee=G[1];else{Y=[],ee=[];for(var ue=0;ue<G.length;++ue)Y[ue]=G[ue][0],ee[ue]=G[ue][1]}var ne=[1/0,1/0,1/0],J=[-1/0,-1/0,-1/0],q=Z.glyph,ae=Z.color,le=Z.size,ie=Z.angle,se=Z.lineColor,xe=-1,oe=0,he=0,be=0;if(K.length){be=K.length;e:for(var ue=0;ue<be;++ue){for(var me=K[ue],_e=0;_e<3;++_e)if(isNaN(me[_e])||!isFinite(me[_e]))continue e;var Se=H(q,ue,te,this.pixelRatio),De=Se.mesh,Ie=Se.lines,Te=Se.bounds;oe+=De.cells.length*3,he+=Ie.edges.length*2}}var Ce=oe+he,He=a.mallocFloat(3*Ce),Xe=a.mallocFloat(4*Ce),Be=a.mallocFloat(2*Ce),Re=a.mallocUint32(Ce);if(Ce>0){var We=0,vt=oe,Pt=[0,0,0,1],Zt=[0,0,0,1],zt=Array.isArray(ae)&&Array.isArray(ae[0]),At=Array.isArray(se)&&Array.isArray(se[0]);e:for(var ue=0;ue<be;++ue){xe+=1;for(var me=K[ue],_e=0;_e<3;++_e){if(isNaN(me[_e])||!isFinite(me[_e]))continue e;J[_e]=Math.max(J[_e],me[_e]),ne[_e]=Math.min(ne[_e],me[_e])}var Se=H(q,ue,te,this.pixelRatio),De=Se.mesh,Ie=Se.lines,Te=Se.bounds,Wt=Se.visible;if(!Wt)Pt=[1,1,1,0];else if(Array.isArray(ae)){var Bt;if(zt?ue<ae.length?Bt=ae[ue]:Bt=[0,0,0,0]:Bt=ae,Bt.length===3){for(var _e=0;_e<3;++_e)Pt[_e]=Bt[_e];Pt[3]=1}else if(Bt.length===4){for(var _e=0;_e<4;++_e)Pt[_e]=Bt[_e];!this.hasAlpha&&Bt[3]<1&&(this.hasAlpha=!0)}}else Pt[0]=Pt[1]=Pt[2]=0,Pt[3]=1;if(!Wt)Zt=[1,1,1,0];else if(Array.isArray(se)){var Bt;if(At?ue<se.length?Bt=se[ue]:Bt=[0,0,0,0]:Bt=se,Bt.length===3){for(var _e=0;_e<3;++_e)Zt[_e]=Bt[_e];Zt[_e]=1}else if(Bt.length===4){for(var _e=0;_e<4;++_e)Zt[_e]=Bt[_e];!this.hasAlpha&&Bt[3]<1&&(this.hasAlpha=!0)}}else Zt[0]=Zt[1]=Zt[2]=0,Zt[3]=1;var Ct=.5;Wt?Array.isArray(le)?ue<le.length?Ct=+le[ue]:Ct=12:le?Ct=+le:this.useOrtho&&(Ct=12):Ct=0;var Ze=0;Array.isArray(ie)?ue<ie.length?Ze=+ie[ue]:Ze=0:ie&&(Ze=+ie);for(var nt=Math.cos(Ze),Ye=Math.sin(Ze),me=K[ue],_e=0;_e<3;++_e)J[_e]=Math.max(J[_e],me[_e]),ne[_e]=Math.min(ne[_e],me[_e]);var Ee=Y,Ge=ee,Ee=0;Array.isArray(Y)?ue<Y.length?Ee=Y[ue]:Ee=0:Y&&(Ee=Y);var Ge=0;Array.isArray(ee)?ue<ee.length?Ge=ee[ue]:Ge=0:ee&&(Ge=ee),Ee*=Ee>0?1-Te[0][0]:Ee<0?1+Te[1][0]:1,Ge*=Ge>0?1-Te[0][1]:Ge<0?1+Te[1][1]:1;for(var Je=[Ee,Ge],Ht=De.cells||[],Rt=De.positions||[],_e=0;_e<Ht.length;++_e)for(var qe=Ht[_e],Tt=0;Tt<3;++Tt){for(var mt=0;mt<3;++mt)He[3*We+mt]=me[mt];for(var mt=0;mt<4;++mt)Xe[4*We+mt]=Pt[mt];Re[We]=xe;var Mt=Rt[qe[Tt]];Be[2*We]=Ct*(nt*Mt[0]-Ye*Mt[1]+Je[0]),Be[2*We+1]=Ct*(Ye*Mt[0]+nt*Mt[1]+Je[1]),We+=1}for(var Ht=Ie.edges,Rt=Ie.positions,_e=0;_e<Ht.length;++_e)for(var qe=Ht[_e],Tt=0;Tt<2;++Tt){for(var mt=0;mt<3;++mt)He[3*vt+mt]=me[mt];for(var mt=0;mt<4;++mt)Xe[4*vt+mt]=Zt[mt];Re[vt]=xe;var Mt=Rt[qe[Tt]];Be[2*vt]=Ct*(nt*Mt[0]-Ye*Mt[1]+Je[0]),Be[2*vt+1]=Ct*(Ye*Mt[0]+nt*Mt[1]+Je[1]),vt+=1}}}this.bounds=[ne,J],this.points=K,this.pointCount=K.length,this.vertexCount=oe,this.lineVertexCount=he,this.pointBuffer.update(He),this.colorBuffer.update(Xe),this.glyphBuffer.update(Be),this.idBuffer.update(Re),a.free(He),a.free(Xe),a.free(Be),a.free(Re)},b.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()};function j(Z){var X=Z.gl,re=f.createPerspective(X),ue=f.createOrtho(X),K=f.createProject(X),te=f.createPickPerspective(X),G=f.createPickOrtho(X),Y=f.createPickProject(X),ee=i(X),ne=i(X),J=i(X),q=i(X),ae=n(X,[{buffer:ee,size:3,type:X.FLOAT},{buffer:ne,size:4,type:X.FLOAT},{buffer:J,size:2,type:X.FLOAT},{buffer:q,size:4,type:X.UNSIGNED_BYTE,normalized:!0}]),le=new l(X,re,ue,K,ee,ne,J,q,ae,te,G,Y);return le.update(Z),le}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(u,A,T){var e=u("glslify");T.boxVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),T.boxFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:231}],130:[function(u,A,T){var e=u("gl-shader"),i=u("gl-buffer"),n=u("./lib/shaders");A.exports=f;function a(o,s,m){this.plot=o,this.boxBuffer=s,this.boxShader=m,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}var r=a.prototype;r.draw=function(){if(!!this.enabled){var o=this.plot,s=this.selectBox,m=this.borderWidth;this.innerFill;var g=this.innerColor;this.outerFill;var p=this.outerColor,v=this.borderColor,x=o.box,l=o.screenBox,b=o.dataBox,c=o.viewBox,M=o.pixelRatio,_=(s[0]-b[0])*(c[2]-c[0])/(b[2]-b[0])+c[0],y=(s[1]-b[1])*(c[3]-c[1])/(b[3]-b[1])+c[1],w=(s[2]-b[0])*(c[2]-c[0])/(b[2]-b[0])+c[0],d=(s[3]-b[1])*(c[3]-c[1])/(b[3]-b[1])+c[1];if(_=Math.max(_,c[0]),y=Math.max(y,c[1]),w=Math.min(w,c[2]),d=Math.min(d,c[3]),!(w<_||d<y)){x.bind();var C=l[2]-l[0],S=l[3]-l[1];if(this.outerFill&&(x.drawBox(0,0,C,y,p),x.drawBox(0,y,_,d,p),x.drawBox(0,d,C,S,p),x.drawBox(w,y,C,d,p)),this.innerFill&&x.drawBox(_,y,w,d,g),m>0){var E=m*M;x.drawBox(_-E,y-E,w+E,y+E,v),x.drawBox(_-E,d-E,w+E,d+E,v),x.drawBox(_-E,y-E,_+E,d+E,v),x.drawBox(w-E,y-E,w+E,d+E,v)}}}},r.update=function(o){o=o||{},this.innerFill=!!o.innerFill,this.outerFill=!!o.outerFill,this.innerColor=(o.innerColor||[0,0,0,.5]).slice(),this.outerColor=(o.outerColor||[0,0,0,.5]).slice(),this.borderColor=(o.borderColor||[0,0,0,1]).slice(),this.borderWidth=o.borderWidth||0,this.selectBox=(o.selectBox||this.selectBox).slice()},r.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)};function f(o,s){var m=o.gl,g=i(m,[0,0,0,1,1,0,1,1]),p=e(m,n.boxVertex,n.boxFragment),v=new a(o,g,p);return v.update(s),o.addOverlay(v),v}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(u,A,T){A.exports=m;var e=u("gl-fbo"),i=u("typedarray-pool"),n=u("ndarray"),a=u("bit-twiddle").nextPow2,r=function(g,p,v){for(var x=1e8,l=-1,b=-1,c=g.shape[0],M=g.shape[1],_=0;_<c;_++)for(var y=0;y<M;y++){var w=g.get(_,y,0),d=g.get(_,y,1),C=g.get(_,y,2),S=g.get(_,y,3);if(w<255||d<255||C<255||S<255){var E=p-_,k=v-y,B=E*E+k*k;B<x&&(x=B,l=_,b=y)}}return[l,b,x]};function f(g,p,v,x,l){this.coord=[g,p],this.id=v,this.value=x,this.distance=l}function o(g,p,v){this.gl=g,this.fbo=p,this.buffer=v,this._readTimeout=null;var x=this;this._readCallback=function(){!x.gl||(p.bind(),g.readPixels(0,0,p.shape[0],p.shape[1],g.RGBA,g.UNSIGNED_BYTE,x.buffer),x._readTimeout=null)}}var s=o.prototype;Object.defineProperty(s,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(g){if(!!this.gl){this.fbo.shape=g;var p=this.fbo.shape[0],v=this.fbo.shape[1];if(v*p*4>this.buffer.length){i.free(this.buffer);for(var x=this.buffer=i.mallocUint8(a(v*p*4)),l=0;l<v*p*4;++l)x[l]=255}return g}}}),s.begin=function(){var g=this.gl;this.shape,g&&(this.fbo.bind(),g.clearColor(1,1,1,1),g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT))},s.end=function(){var g=this.gl;!g||(g.bindFramebuffer(g.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},s.query=function(g,p,v){if(!this.gl)return null;var x=this.fbo.shape.slice();g=g|0,p=p|0,typeof v!="number"&&(v=1);var l=Math.min(Math.max(g-v,0),x[0])|0,b=Math.min(Math.max(g+v,0),x[0])|0,c=Math.min(Math.max(p-v,0),x[1])|0,M=Math.min(Math.max(p+v,0),x[1])|0;if(b<=l||M<=c)return null;var _=[b-l,M-c],y=n(this.buffer,[_[0],_[1],4],[4,x[0]*4,1],4*(l+x[0]*c)),w=r(y.hi(_[0],_[1],1),v,v),d=w[0],C=w[1];if(d<0||Math.pow(this.radius,2)<w[2])return null;var S=y.get(d,C,0),E=y.get(d,C,1),k=y.get(d,C,2),B=y.get(d,C,3);return new f(d+l|0,C+c|0,S,[E,k,B],Math.sqrt(w[2]))},s.dispose=function(){!this.gl||(this.fbo.dispose(),i.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))};function m(g,p){var v=p[0],x=p[1],l={},b=e(g,v,x,l),c=i.mallocUint8(v*x*4);return new o(g,b,c)}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(u,A,T){var e=u("./lib/create-uniforms"),i=u("./lib/create-attributes"),n=u("./lib/reflect"),a=u("./lib/shader-cache"),r=u("./lib/runtime-reflect"),f=u("./lib/GLError");function o(p){this.gl=p,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var s=o.prototype;s.bind=function(){this.program||this._relink();var p,v=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),x=this.gl.lastAttribCount;if(v>x)for(p=x;p<v;p++)this.gl.enableVertexAttribArray(p);else if(x>v)for(p=v;p<x;p++)this.gl.disableVertexAttribArray(p);this.gl.lastAttribCount=v,this.gl.useProgram(this.program)},s.dispose=function(){for(var p=this.gl.lastAttribCount,v=0;v<p;v++)this.gl.disableVertexAttribArray(v);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null};function m(p,v){return p.name<v.name?-1:1}s.update=function(p,v,x,l){if(!v||arguments.length===1){var b=p;p=b.vertex,v=b.fragment,x=b.uniforms,l=b.attributes}var c=this,M=c.gl,_=c._vref;c._vref=a.shader(M,M.VERTEX_SHADER,p),_&&_.dispose(),c.vertShader=c._vref.shader;var y=this._fref;if(c._fref=a.shader(M,M.FRAGMENT_SHADER,v),y&&y.dispose(),c.fragShader=c._fref.shader,!x||!l){var w=M.createProgram();if(M.attachShader(w,c.fragShader),M.attachShader(w,c.vertShader),M.linkProgram(w),!M.getProgramParameter(w,M.LINK_STATUS)){var d=M.getProgramInfoLog(w);throw new f(d,"Error linking program:"+d)}x=x||r.uniforms(M,w),l=l||r.attributes(M,w),M.deleteProgram(w)}l=l.slice(),l.sort(m);var C=[],S=[],E=[],k;for(k=0;k<l.length;++k){var B=l[k];if(B.type.indexOf("mat")>=0){for(var z=B.type.charAt(B.type.length-1)|0,F=new Array(z),I=0;I<z;++I)F[I]=E.length,S.push(B.name+"["+I+"]"),typeof B.location=="number"?E.push(B.location+I):Array.isArray(B.location)&&B.location.length===z&&typeof B.location[I]=="number"?E.push(B.location[I]|0):E.push(-1);C.push({name:B.name,type:B.type,locations:F})}else C.push({name:B.name,type:B.type,locations:[E.length]}),S.push(B.name),typeof B.location=="number"?E.push(B.location|0):E.push(-1)}var O=0;for(k=0;k<E.length;++k)if(E[k]<0){for(;E.indexOf(O)>=0;)O+=1;E[k]=O}var N=new Array(x.length);function V(){c.program=a.program(M,c._vref,c._fref,S,E);for(var H=0;H<x.length;++H)N[H]=M.getUniformLocation(c.program,x[H].name)}V(),c._relink=V,c.types={uniforms:n(x),attributes:n(l)},c.attributes=i(M,c,C,E),Object.defineProperty(c,"uniforms",e(M,c,x,N))};function g(p,v,x,l,b){var c=new o(p);return c.update(v,x,l,b),c}A.exports=g},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(u,A,T){function e(i,n,a){this.shortMessage=n||"",this.longMessage=a||"",this.rawError=i||"",this.message="gl-shader: "+(n||i||"")+(a?`
`+a:""),this.stack=new Error().stack}e.prototype=new Error,e.prototype.name="GLError",e.prototype.constructor=e,A.exports=e},{}],134:[function(u,A,T){A.exports=o;var e=u("./GLError");function i(s,m,g,p,v,x){this._gl=s,this._wrapper=m,this._index=g,this._locations=p,this._dimension=v,this._constFunc=x}var n=i.prototype;n.pointer=function(m,g,p,v){var x=this,l=x._gl,b=x._locations[x._index];l.vertexAttribPointer(b,x._dimension,m||l.FLOAT,!!g,p||0,v||0),l.enableVertexAttribArray(b)},n.set=function(s,m,g,p){return this._constFunc(this._locations[this._index],s,m,g,p)},Object.defineProperty(n,"location",{get:function(){return this._locations[this._index]},set:function(s){return s!==this._locations[this._index]&&(this._locations[this._index]=s|0,this._wrapper.program=null),s|0}});var a=[function(s,m,g){return g.length===void 0?s.vertexAttrib1f(m,g):s.vertexAttrib1fv(m,g)},function(s,m,g,p){return g.length===void 0?s.vertexAttrib2f(m,g,p):s.vertexAttrib2fv(m,g)},function(s,m,g,p,v){return g.length===void 0?s.vertexAttrib3f(m,g,p,v):s.vertexAttrib3fv(m,g)},function(s,m,g,p,v,x){return g.length===void 0?s.vertexAttrib4f(m,g,p,v,x):s.vertexAttrib4fv(m,g)}];function r(s,m,g,p,v,x,l){var b=a[v],c=new i(s,m,g,p,v,b);Object.defineProperty(x,l,{set:function(M){return s.disableVertexAttribArray(p[g]),b(s,p[g],M),M},get:function(){return c},enumerable:!0})}function f(s,m,g,p,v,x,l){for(var b=new Array(v),c=new Array(v),M=0;M<v;++M)r(s,m,g[M],p,v,b,M),c[M]=b[M];Object.defineProperty(b,"location",{set:function(w){if(Array.isArray(w))for(var d=0;d<v;++d)c[d].location=w[d];else for(var d=0;d<v;++d)c[d].location=w+d;return w},get:function(){for(var w=new Array(v),d=0;d<v;++d)w[d]=p[g[d]];return w},enumerable:!0}),b.pointer=function(w,d,C,S){w=w||s.FLOAT,d=!!d,C=C||v*v,S=S||0;for(var E=0;E<v;++E){var k=p[g[E]];s.vertexAttribPointer(k,v,w,d,C,S+E*v),s.enableVertexAttribArray(k)}};var _=new Array(v),y=s["vertexAttrib"+v+"fv"];Object.defineProperty(x,l,{set:function(w){for(var d=0;d<v;++d){var C=p[g[d]];if(s.disableVertexAttribArray(C),Array.isArray(w[0]))y.call(s,C,w[d]);else{for(var S=0;S<v;++S)_[S]=w[v*d+S];y.call(s,C,_)}}return w},get:function(){return b},enumerable:!0})}function o(s,m,g,p){for(var v={},x=0,l=g.length;x<l;++x){var b=g[x],c=b.name,M=b.type,_=b.locations;switch(M){case"bool":case"int":case"float":r(s,m,_[0],p,1,v,c);break;default:if(M.indexOf("vec")>=0){var y=M.charCodeAt(M.length-1)-48;if(y<2||y>4)throw new e("","Invalid data type for attribute "+c+": "+M);r(s,m,_[0],p,y,v,c)}else if(M.indexOf("mat")>=0){var y=M.charCodeAt(M.length-1)-48;if(y<2||y>4)throw new e("","Invalid data type for attribute "+c+": "+M);f(s,m,_,p,y,v,c)}else throw new e("","Unknown data type for attribute "+c+": "+M);break}}return v}},{"./GLError":133}],135:[function(u,A,T){var e=u("./reflect"),i=u("./GLError");A.exports=r;function n(f){return function(){return f}}function a(f,o){for(var s=new Array(f),m=0;m<f;++m)s[m]=o;return s}function r(f,o,s,m){function g(M){return function(_,y,w){return _.getUniform(y.program,w[M])}}function p(M){return function(y){for(var w=v("",M),d=0;d<w.length;++d){var C=w[d],S=C[0],E=C[1];if(m[E]){var k=y;if(typeof S=="string"&&(S.indexOf(".")===0||S.indexOf("[")===0)){var B=S;if(S.indexOf(".")===0&&(B=S.slice(1)),B.indexOf("]")===B.length-1){var z=B.indexOf("["),F=B.slice(0,z),I=B.slice(z+1,B.length-1);k=F?y[F][I]:y[I]}else k=y[B]}var O=s[E].type,N;switch(O){case"bool":case"int":case"sampler2D":case"samplerCube":f.uniform1i(m[E],k);break;case"float":f.uniform1f(m[E],k);break;default:var V=O.indexOf("vec");if(0<=V&&V<=1&&O.length===4+V){if(N=O.charCodeAt(O.length-1)-48,N<2||N>4)throw new i("","Invalid data type");switch(O.charAt(0)){case"b":case"i":f["uniform"+N+"iv"](m[E],k);break;case"v":f["uniform"+N+"fv"](m[E],k);break;default:throw new i("","Unrecognized data type for vector "+name+": "+O)}}else if(O.indexOf("mat")===0&&O.length===4){if(N=O.charCodeAt(O.length-1)-48,N<2||N>4)throw new i("","Invalid uniform dimension type for matrix "+name+": "+O);f["uniformMatrix"+N+"fv"](m[E],!1,k);break}else throw new i("","Unknown uniform data type for "+name+": "+O)}}}}}function v(M,_){if(typeof _!="object")return[[M,_]];var y=[];for(var w in _){var d=_[w],C=M;parseInt(w)+""===w?C+="["+w+"]":C+="."+w,typeof d=="object"?y.push.apply(y,v(C,d)):y.push([C,d])}return y}function x(M){switch(M){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var _=M.indexOf("vec");if(0<=_&&_<=1&&M.length===4+_){var y=M.charCodeAt(M.length-1)-48;if(y<2||y>4)throw new i("","Invalid data type");return M.charAt(0)==="b"?a(y,!1):a(y,0)}else if(M.indexOf("mat")===0&&M.length===4){var y=M.charCodeAt(M.length-1)-48;if(y<2||y>4)throw new i("","Invalid uniform dimension type for matrix "+name+": "+M);return a(y*y,0)}else throw new i("","Unknown uniform data type for "+name+": "+M)}}function l(M,_,y){if(typeof y=="object"){var w=b(y);Object.defineProperty(M,_,{get:n(w),set:p(y),enumerable:!0,configurable:!1})}else m[y]?Object.defineProperty(M,_,{get:g(y),set:p(y),enumerable:!0,configurable:!1}):M[_]=x(s[y].type)}function b(M){var _;if(Array.isArray(M)){_=new Array(M.length);for(var y=0;y<M.length;++y)l(_,y,M[y])}else{_={};for(var w in M)l(_,w,M[w])}return _}var c=e(s,!0);return{get:n(b(c)),set:p(c),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(u,A,T){A.exports=e;function e(i,n){for(var a={},r=0;r<i.length;++r)for(var f=i[r].name,o=f.split("."),s=a,m=0;m<o.length;++m){var g=o[m].split("[");if(g.length>1){g[0]in s||(s[g[0]]=[]),s=s[g[0]];for(var p=1;p<g.length;++p){var v=parseInt(g[p]);p<g.length-1||m<o.length-1?(v in s||(p<g.length-1?s[v]=[]:s[v]={}),s=s[v]):n?s[v]=r:s[v]=i[r].type}}else m<o.length-1?(g[0]in s||(s[g[0]]={}),s=s[g[0]]):n?s[g[0]]=r:s[g[0]]=i[r].type}return a}},{}],137:[function(u,A,T){T.uniforms=a,T.attributes=r;var e={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},i=null;function n(f,o){if(!i){var s=Object.keys(e);i={};for(var m=0;m<s.length;++m){var g=s[m];i[f[g]]=e[g]}}return i[o]}function a(f,o){for(var s=f.getProgramParameter(o,f.ACTIVE_UNIFORMS),m=[],g=0;g<s;++g){var p=f.getActiveUniform(o,g);if(p){var v=n(f,p.type);if(p.size>1)for(var x=0;x<p.size;++x)m.push({name:p.name.replace("[0]","["+x+"]"),type:v});else m.push({name:p.name,type:v})}}return m}function r(f,o){for(var s=f.getProgramParameter(o,f.ACTIVE_ATTRIBUTES),m=[],g=0;g<s;++g){var p=f.getActiveAttrib(o,g);p&&m.push({name:p.name,type:n(f,p.type)})}return m}},{}],138:[function(u,A,T){T.shader=v,T.program=x;var e=u("./GLError"),i=u("gl-format-compiler-error"),n=typeof WeakMap>"u"?u("weakmap-shim"):WeakMap,a=new n,r=0;function f(l,b,c,M,_,y,w){this.id=l,this.src=b,this.type=c,this.shader=M,this.count=y,this.programs=[],this.cache=w}f.prototype.dispose=function(){if(--this.count===0){for(var l=this.cache,b=l.gl,c=this.programs,M=0,_=c.length;M<_;++M){var y=l.programs[c[M]];y&&(delete l.programs[M],b.deleteProgram(y))}b.deleteShader(this.shader),delete l.shaders[this.type===b.FRAGMENT_SHADER|0][this.src]}};function o(l){this.gl=l,this.shaders=[{},{}],this.programs={}}var s=o.prototype;function m(l,b,c){var M=l.createShader(b);if(l.shaderSource(M,c),l.compileShader(M),!l.getShaderParameter(M,l.COMPILE_STATUS)){var _=l.getShaderInfoLog(M);try{var y=i(_,c,b)}catch(w){throw console.warn("Failed to format compiler error: "+w),new e(_,`Error compiling shader:
`+_)}throw new e(_,y.short,y.long)}return M}s.getShaderReference=function(l,b){var c=this.gl,M=this.shaders[l===c.FRAGMENT_SHADER|0],_=M[b];if(!_||!c.isShader(_.shader)){var y=m(c,l,b);_=M[b]=new f(r++,b,l,y,[],1,this)}else _.count+=1;return _};function g(l,b,c,M,_){var y=l.createProgram();l.attachShader(y,b),l.attachShader(y,c);for(var w=0;w<M.length;++w)l.bindAttribLocation(y,_[w],M[w]);if(l.linkProgram(y),!l.getProgramParameter(y,l.LINK_STATUS)){var d=l.getProgramInfoLog(y);throw new e(d,"Error linking program: "+d)}return y}s.getProgram=function(l,b,c,M){var _=[l.id,b.id,c.join(":"),M.join(":")].join("@"),y=this.programs[_];return(!y||!this.gl.isProgram(y))&&(this.programs[_]=y=g(this.gl,l.shader,b.shader,c,M),l.programs.push(_),b.programs.push(_)),y};function p(l){var b=a.get(l);return b||(b=new o(l),a.set(l,b)),b}function v(l,b,c){return p(l).getShaderReference(b,c)}function x(l,b,c,M,_){return p(l).getProgram(b,c,M,_)}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(u,A,T){A.exports=n;function e(a){this.plot=a,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}var i=e.prototype;i.update=function(a){a=a||{},this.enable=(a.enable||[!0,!0,!1,!1]).slice(),this.width=(a.width||[1,1,1,1]).slice(),this.color=(a.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(r){return r.slice()}),this.center=(a.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},i.draw=function(){var a=this.enable,r=this.width,f=this.color,o=this.center,s=this.plot,m=s.line,g=s.dataBox,p=s.viewBox;if(m.bind(),g[0]<=o[0]&&o[0]<=g[2]&&g[1]<=o[1]&&o[1]<=g[3]){var v=p[0]+(o[0]-g[0])/(g[2]-g[0])*(p[2]-p[0]),x=p[1]+(o[1]-g[1])/(g[3]-g[1])*(p[3]-p[1]);a[0]&&m.drawLine(v,x,p[0],x,r[0],f[0]),a[1]&&m.drawLine(v,x,v,p[1],r[1],f[1]),a[2]&&m.drawLine(v,x,p[2],x,r[2],f[2]),a[3]&&m.drawLine(v,x,v,p[3],r[3],f[3])}},i.dispose=function(){this.plot.removeOverlay(this)};function n(a,r){var f=new e(a);return f.update(r),a.addOverlay(f),f}},{}],140:[function(u,A,T){var e=u("glslify"),i=u("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),a=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);A.exports=function(r){return i(r,n,a,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(u,A,T){var e=u("gl-buffer"),i=u("gl-vao"),n=u("./shaders/index");A.exports=g;var a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function r(p,v,x,l){this.gl=p,this.buffer=v,this.vao=x,this.shader=l,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var f=r.prototype,o=[0,0,0],s=[0,0,0],m=[0,0];f.isTransparent=function(){return!1},f.drawTransparent=function(p){},f.draw=function(p){var v=this.gl,x=this.vao,l=this.shader;x.bind(),l.bind();var b=p.model||a,c=p.view||a,M=p.projection||a,_;this.axes&&(_=this.axes.lastCubeProps.axis);for(var y=o,w=s,d=0;d<3;++d)_&&_[d]<0?(y[d]=this.bounds[0][d],w[d]=this.bounds[1][d]):(y[d]=this.bounds[1][d],w[d]=this.bounds[0][d]);m[0]=v.drawingBufferWidth,m[1]=v.drawingBufferHeight,l.uniforms.model=b,l.uniforms.view=c,l.uniforms.projection=M,l.uniforms.coordinates=[this.position,y,w],l.uniforms.colors=this.colors,l.uniforms.screenShape=m;for(var d=0;d<3;++d)l.uniforms.lineWidth=this.lineWidth[d]*this.pixelRatio,this.enabled[d]&&(x.draw(v.TRIANGLES,6,6*d),this.drawSides[d]&&x.draw(v.TRIANGLES,12,18+12*d));x.unbind()},f.update=function(p){!p||("bounds"in p&&(this.bounds=p.bounds),"position"in p&&(this.position=p.position),"lineWidth"in p&&(this.lineWidth=p.lineWidth),"colors"in p&&(this.colors=p.colors),"enabled"in p&&(this.enabled=p.enabled),"drawSides"in p&&(this.drawSides=p.drawSides))},f.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};function g(p,v){var x=[];function l(y,w,d,C,S,E){var k=[y,w,d,0,0,0,1];k[C+3]=1,k[C]=S,x.push.apply(x,k),k[6]=-1,x.push.apply(x,k),k[C]=E,x.push.apply(x,k),x.push.apply(x,k),k[6]=1,x.push.apply(x,k),k[C]=S,x.push.apply(x,k)}l(0,0,0,0,0,1),l(0,0,0,1,0,1),l(0,0,0,2,0,1),l(1,0,0,1,-1,1),l(1,0,0,2,-1,1),l(0,1,0,0,-1,1),l(0,1,0,2,-1,1),l(0,0,1,0,-1,1),l(0,0,1,1,-1,1);var b=e(p,x),c=i(p,[{type:p.FLOAT,buffer:b,size:3,offset:0,stride:28},{type:p.FLOAT,buffer:b,size:3,offset:12,stride:28},{type:p.FLOAT,buffer:b,size:1,offset:24,stride:28}]),M=n(p);M.attributes.position.location=0,M.attributes.color.location=1,M.attributes.weight.location=2;var _=new r(p,b,c,M);return _.update(v),_}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(u,A,T){var e=u("glslify"),i=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);T.meshShader={vertex:i,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},T.pickShader={vertex:a,fragment:r,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(u,A,T){var e=u("gl-vec3"),i=u("gl-vec4"),n=["xyz","xzy","yxz","yzx","zxy","zyx"],a=function(x,l,b,c){for(var M=x.points,_=x.velocities,y=x.divergences,w=[],d=[],C=[],S=[],E=[],k=[],B=0,z=0,F=i.create(),I=i.create(),O=8,N=0;N<M.length;N++){var V=M[N],H=_[N],j=y[N];l===0&&(j=b*.05),z=e.length(H)/c,F=i.create(),e.copy(F,H),F[3]=j;for(var Z=0;Z<O;Z++)E[Z]=[V[0],V[1],V[2],Z];if(S.length>0)for(var Z=0;Z<O;Z++){var X=(Z+1)%O;w.push(S[Z],E[Z],E[X],E[X],S[X],S[Z]),C.push(I,F,F,F,I,I),k.push(B,z,z,z,B,B);var re=w.length;d.push([re-6,re-5,re-4],[re-3,re-2,re-1])}var ue=S;S=E,E=ue;var K=I;I=F,F=K;var te=B;B=z,z=te}return{positions:w,cells:d,vectors:C,vertexIntensity:k}},r=function(x,l,b,c){for(var M=0,_=0;_<x.length;_++)for(var y=x[_].velocities,w=0;w<y.length;w++)M=Math.max(M,e.length(y[w]));for(var d=x.map(function(N){return a(N,b,c,M)}),C=[],S=[],E=[],k=[],_=0;_<d.length;_++){var B=d[_],z=C.length;C=C.concat(B.positions),E=E.concat(B.vectors),k=k.concat(B.vertexIntensity);for(var w=0;w<B.cells.length;w++){var F=B.cells[w],I=[];S.push(I);for(var O=0;O<F.length;O++)I.push(F[O]+z)}}return{positions:C,cells:S,vectors:E,vertexIntensity:k,colormap:l}},f=function(x,l){var b=x.length,c;for(c=0;c<b;c++){var M=x[c];if(M===l)return c;if(M>l)return c-1}return c},o=function(x,l,b){return x<l?l:x>b?b:x},s=function(x,l,b){var c=l.vectors,M=l.meshgrid,_=x[0],y=x[1],w=x[2],d=M[0].length,C=M[1].length,S=M[2].length,E=f(M[0],_),k=f(M[1],y),B=f(M[2],w),z=E+1,F=k+1,I=B+1;if(E=o(E,0,d-1),z=o(z,0,d-1),k=o(k,0,C-1),F=o(F,0,C-1),B=o(B,0,S-1),I=o(I,0,S-1),E<0||k<0||B<0||z>d-1||F>C-1||I>S-1)return e.create();var O=M[0][E],N=M[0][z],V=M[1][k],H=M[1][F],j=M[2][B],Z=M[2][I],X=(_-O)/(N-O),re=(y-V)/(H-V),ue=(w-j)/(Z-j);isFinite(X)||(X=.5),isFinite(re)||(re=.5),isFinite(ue)||(ue=.5);var K,te,G,Y,ee,ne;switch(b.reversedX&&(E=d-1-E,z=d-1-z),b.reversedY&&(k=C-1-k,F=C-1-F),b.reversedZ&&(B=S-1-B,I=S-1-I),b.filled){case 5:ee=B,ne=I,G=k*S,Y=F*S,K=E*S*C,te=z*S*C;break;case 4:ee=B,ne=I,K=E*S,te=z*S,G=k*S*d,Y=F*S*d;break;case 3:G=k,Y=F,ee=B*C,ne=I*C,K=E*C*S,te=z*C*S;break;case 2:G=k,Y=F,K=E*C,te=z*C,ee=B*C*d,ne=I*C*d;break;case 1:K=E,te=z,ee=B*d,ne=I*d,G=k*d*S,Y=F*d*S;break;default:K=E,te=z,G=k*d,Y=F*d,ee=B*d*C,ne=I*d*C;break}var J=c[K+G+ee],q=c[K+G+ne],ae=c[K+Y+ee],le=c[K+Y+ne],ie=c[te+G+ee],se=c[te+G+ne],xe=c[te+Y+ee],oe=c[te+Y+ne],he=e.create(),be=e.create(),me=e.create(),_e=e.create();e.lerp(he,J,ie,X),e.lerp(be,q,se,X),e.lerp(me,ae,xe,X),e.lerp(_e,le,oe,X);var Se=e.create(),De=e.create();e.lerp(Se,he,me,re),e.lerp(De,be,_e,re);var Ie=e.create();return e.lerp(Ie,Se,De,ue),Ie},m=function(x){var l=1/0;x.sort(function(_,y){return _-y});for(var b=x.length,c=1;c<b;c++){var M=Math.abs(x[c]-x[c-1]);M<l&&(l=M)}return l},g=function(x){for(var l=[],b=[],c=[],M={},_={},y={},w=x.length,d=0;d<w;d++){var C=x[d],S=C[0],E=C[1],k=C[2];M[S]||(l.push(S),M[S]=!0),_[E]||(b.push(E),_[E]=!0),y[k]||(c.push(k),y[k]=!0)}var B=m(l),z=m(b),F=m(c),I=Math.min(B,z,F);return isFinite(I)?I:1};A.exports=function(x,l){var b=x.startingPositions,c=x.maxLength||1e3,M=x.tubeSize||1,_=x.absoluteTubeSize,y=x.gridFill||"+x+y+z",w={};y.indexOf("-x")!==-1&&(w.reversedX=!0),y.indexOf("-y")!==-1&&(w.reversedY=!0),y.indexOf("-z")!==-1&&(w.reversedZ=!0),w.filled=n.indexOf(y.replace(/-/g,"").replace(/\+/g,""));var d=x.getVelocity||function(se){return s(se,x,w)},C=x.getDivergence||function(se,xe){var oe=e.create(),he=1e-4;e.add(oe,se,[he,0,0]);var be=d(oe);e.subtract(be,be,xe),e.scale(be,be,1/he),e.add(oe,se,[0,he,0]);var me=d(oe);e.subtract(me,me,xe),e.scale(me,me,1/he),e.add(oe,se,[0,0,he]);var _e=d(oe);return e.subtract(_e,_e,xe),e.scale(_e,_e,1/he),e.add(oe,be,me),e.add(oe,oe,_e),oe},S=[],E=l[0][0],k=l[0][1],B=l[0][2],z=l[1][0],F=l[1][1],I=l[1][2],O=function(se){var xe=se[0],oe=se[1],he=se[2];return!(xe<E||xe>z||oe<k||oe>F||he<B||he>I)},N=e.distance(l[0],l[1]),V=10*N/c,H=V*V,j=1,Z=0,X=b.length;X>1&&(j=g(b));for(var re=0;re<X;re++){var ue=e.create();e.copy(ue,b[re]);var K=[ue],te=[],G=d(ue),Y=ue;te.push(G);var ee=[],ne=C(ue,G),J=e.length(ne);isFinite(J)&&J>Z&&(Z=J),ee.push(J),S.push({points:K,velocities:te,divergences:ee});for(var q=0;q<c*100&&K.length<c&&O(ue);){q++;var ae=e.clone(G),le=e.squaredLength(ae);if(le===0)break;if(le>H&&e.scale(ae,ae,V/Math.sqrt(le)),e.add(ae,ae,ue),G=d(ae),e.squaredDistance(Y,ae)-H>-1e-4*H){K.push(ae),Y=ae,te.push(G);var ne=C(ae,G),J=e.length(ne);isFinite(J)&&J>Z&&(Z=J),ee.push(J)}ue=ae}}var ie=r(S,x.colormap,Z,j);return _?ie.tubeScale=_:(Z===0&&(Z=1),ie.tubeScale=M*.5*j/Z),ie};var p=u("./lib/shaders"),v=u("gl-cone3d").createMesh;A.exports.createTubeMesh=function(x,l){return v(x,l,{shaders:p,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(u,A,T){var e=u("gl-shader"),i=u("glslify"),n=i([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),a=i([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color \u2014 in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),r=i([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),f=i([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);T.createShader=function(o){var s=e(o,n,a,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s.attributes.normal.location=2,s},T.createPickShader=function(o){var s=e(o,n,f,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s.attributes.normal.location=2,s},T.createContourShader=function(o){var s=e(o,r,a,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s},T.createPickContourShader=function(o){var s=e(o,r,f,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s}},{"gl-shader":132,glslify:231}],145:[function(u,A,T){A.exports=te;var e=u("bit-twiddle"),i=u("gl-buffer"),n=u("gl-vao"),a=u("gl-texture2d"),r=u("typedarray-pool"),f=u("colormap"),o=u("ndarray-ops"),s=u("ndarray-pack"),m=u("ndarray"),g=u("surface-nets"),p=u("gl-mat4/multiply"),v=u("gl-mat4/invert"),x=u("binary-search-bounds"),l=u("ndarray-gradient"),b=u("./lib/shaders"),c=b.createShader,M=b.createContourShader,_=b.createPickShader,y=b.createPickContourShader,w=4*(4+3+3),d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],C=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],S=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var G=0;G<3;++G){var Y=S[G],ee=(G+1)%3,ne=(G+2)%3;Y[ee+0]=1,Y[ne+3]=1,Y[G+6]=1}})();function E(G,Y,ee,ne,J){this.position=G,this.index=Y,this.uv=ee,this.level=ne,this.dataCoordinate=J}var k=256;function B(G,Y,ee,ne,J,q,ae,le,ie,se,xe,oe,he,be,me){this.gl=G,this.shape=Y,this.bounds=ee,this.objectOffset=me,this.intensityBounds=[],this._shader=ne,this._pickShader=J,this._coordinateBuffer=q,this._vao=ae,this._colorMap=le,this._contourShader=ie,this._contourPickShader=se,this._contourBuffer=xe,this._contourVAO=oe,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new E([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=he,this._dynamicVAO=be,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[m(r.mallocFloat(1024),[0,0]),m(r.mallocFloat(1024),[0,0]),m(r.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var z=B.prototype;z.genColormap=function(G,Y){var ee=!1,ne=s([f({colormap:G,nshades:k,format:"rgba"}).map(function(J,q){var ae=Y?F(q/255,Y):J[3];return ae<1&&(ee=!0),[J[0],J[1],J[2],255*ae]})]);return o.divseq(ne,255),this.hasAlphaScale=ee,ne},z.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},z.isOpaque=function(){return!this.isTransparent()},z.pickSlots=1,z.setPickBase=function(G){this.pickId=G};function F(G,Y){if(!Y||!Y.length)return 1;for(var ee=0;ee<Y.length;++ee){if(Y.length<2)return 1;if(Y[ee][0]===G)return Y[ee][1];if(Y[ee][0]>G&&ee>0){var ne=(Y[ee][0]-G)/(Y[ee][0]-Y[ee-1][0]);return Y[ee][1]*(1-ne)+ne*Y[ee-1][1]}}return 1}var I=[0,0,0],O={showSurface:!1,showContour:!1,projections:[d.slice(),d.slice(),d.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function N(G,Y){var ee,ne,J,q=Y.axes&&Y.axes.lastCubeProps.axis||I,ae=Y.showSurface,le=Y.showContour;for(ee=0;ee<3;++ee)for(ae=ae||Y.surfaceProject[ee],ne=0;ne<3;++ne)le=le||Y.contourProject[ee][ne];for(ee=0;ee<3;++ee){var ie=O.projections[ee];for(ne=0;ne<16;++ne)ie[ne]=0;for(ne=0;ne<4;++ne)ie[5*ne]=1;ie[5*ee]=0,ie[12+ee]=Y.axesBounds[+(q[ee]>0)][ee],p(ie,G.model,ie);var se=O.clipBounds[ee];for(J=0;J<2;++J)for(ne=0;ne<3;++ne)se[J][ne]=G.clipBounds[J][ne];se[0][ee]=-1e8,se[1][ee]=1e8}return O.showSurface=ae,O.showContour=le,O}var V={model:d,view:d,projection:d,inverseModel:d.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},H=d.slice(),j=[1,0,0,0,1,0,0,0,1];function Z(G,Y){G=G||{};var ee=this.gl;ee.disable(ee.CULL_FACE),this._colorMap.bind(0);var ne=V;ne.model=G.model||d,ne.view=G.view||d,ne.projection=G.projection||d,ne.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],ne.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],ne.objectOffset=this.objectOffset,ne.contourColor=this.contourColor[0],ne.inverseModel=v(ne.inverseModel,ne.model);for(var J=0;J<2;++J)for(var q=ne.clipBounds[J],ae=0;ae<3;++ae)q[ae]=Math.min(Math.max(this.clipBounds[J][ae],-1e8),1e8);ne.kambient=this.ambientLight,ne.kdiffuse=this.diffuseLight,ne.kspecular=this.specularLight,ne.roughness=this.roughness,ne.fresnel=this.fresnel,ne.opacity=this.opacity,ne.height=0,ne.permutation=j,ne.vertexColor=this.vertexColor;var le=H;for(p(le,ne.view,ne.model),p(le,ne.projection,le),v(le,le),J=0;J<3;++J)ne.eyePosition[J]=le[12+J]/le[15];var ie=le[15];for(J=0;J<3;++J)ie+=this.lightPosition[J]*le[4*J+3];for(J=0;J<3;++J){var se=le[12+J];for(ae=0;ae<3;++ae)se+=le[4*ae+J]*this.lightPosition[ae];ne.lightPosition[J]=se/ie}var xe=N(ne,this);if(xe.showSurface){for(this._shader.bind(),this._shader.uniforms=ne,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(ee.TRIANGLES,this._vertexCount),J=0;J<3;++J)!this.surfaceProject[J]||!this.vertexCount||(this._shader.uniforms.model=xe.projections[J],this._shader.uniforms.clipBounds=xe.clipBounds[J],this._vao.draw(ee.TRIANGLES,this._vertexCount));this._vao.unbind()}if(xe.showContour){var oe=this._contourShader;ne.kambient=1,ne.kdiffuse=0,ne.kspecular=0,ne.opacity=1,oe.bind(),oe.uniforms=ne;var he=this._contourVAO;for(he.bind(),J=0;J<3;++J)for(oe.uniforms.permutation=S[J],ee.lineWidth(this.contourWidth[J]*this.pixelRatio),ae=0;ae<this.contourLevels[J].length;++ae)ae===this.highlightLevel[J]?(oe.uniforms.contourColor=this.highlightColor[J],oe.uniforms.contourTint=this.highlightTint[J]):(ae===0||ae-1===this.highlightLevel[J])&&(oe.uniforms.contourColor=this.contourColor[J],oe.uniforms.contourTint=this.contourTint[J]),this._contourCounts[J][ae]&&(oe.uniforms.height=this.contourLevels[J][ae],he.draw(ee.LINES,this._contourCounts[J][ae],this._contourOffsets[J][ae]));for(J=0;J<3;++J)for(oe.uniforms.model=xe.projections[J],oe.uniforms.clipBounds=xe.clipBounds[J],ae=0;ae<3;++ae)if(!!this.contourProject[J][ae]){oe.uniforms.permutation=S[ae],ee.lineWidth(this.contourWidth[ae]*this.pixelRatio);for(var be=0;be<this.contourLevels[ae].length;++be)be===this.highlightLevel[ae]?(oe.uniforms.contourColor=this.highlightColor[ae],oe.uniforms.contourTint=this.highlightTint[ae]):(be===0||be-1===this.highlightLevel[ae])&&(oe.uniforms.contourColor=this.contourColor[ae],oe.uniforms.contourTint=this.contourTint[ae]),this._contourCounts[ae][be]&&(oe.uniforms.height=this.contourLevels[ae][be],he.draw(ee.LINES,this._contourCounts[ae][be],this._contourOffsets[ae][be]))}for(he.unbind(),he=this._dynamicVAO,he.bind(),J=0;J<3;++J)if(this._dynamicCounts[J]!==0)for(oe.uniforms.model=ne.model,oe.uniforms.clipBounds=ne.clipBounds,oe.uniforms.permutation=S[J],ee.lineWidth(this.dynamicWidth[J]*this.pixelRatio),oe.uniforms.contourColor=this.dynamicColor[J],oe.uniforms.contourTint=this.dynamicTint[J],oe.uniforms.height=this.dynamicLevel[J],he.draw(ee.LINES,this._dynamicCounts[J],this._dynamicOffsets[J]),ae=0;ae<3;++ae)!this.contourProject[ae][J]||(oe.uniforms.model=xe.projections[ae],oe.uniforms.clipBounds=xe.clipBounds[ae],he.draw(ee.LINES,this._dynamicCounts[J],this._dynamicOffsets[J]));he.unbind()}}z.draw=function(G){return Z.call(this,G,!1)},z.drawTransparent=function(G){return Z.call(this,G,!0)};var X={model:d,view:d,projection:d,inverseModel:d,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};z.drawPick=function(G){G=G||{};var Y=this.gl;Y.disable(Y.CULL_FACE);var ee=X;ee.model=G.model||d,ee.view=G.view||d,ee.projection=G.projection||d,ee.shape=this._field[2].shape,ee.pickId=this.pickId/255,ee.lowerBound=this.bounds[0],ee.upperBound=this.bounds[1],ee.objectOffset=this.objectOffset,ee.permutation=j;for(var ne=0;ne<2;++ne)for(var J=ee.clipBounds[ne],q=0;q<3;++q)J[q]=Math.min(Math.max(this.clipBounds[ne][q],-1e8),1e8);var ae=N(ee,this);if(ae.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=ee,this._vao.bind(),this._vao.draw(Y.TRIANGLES,this._vertexCount),ne=0;ne<3;++ne)!this.surfaceProject[ne]||(this._pickShader.uniforms.model=ae.projections[ne],this._pickShader.uniforms.clipBounds=ae.clipBounds[ne],this._vao.draw(Y.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ae.showContour){var le=this._contourPickShader;le.bind(),le.uniforms=ee;var ie=this._contourVAO;for(ie.bind(),q=0;q<3;++q)for(Y.lineWidth(this.contourWidth[q]*this.pixelRatio),le.uniforms.permutation=S[q],ne=0;ne<this.contourLevels[q].length;++ne)this._contourCounts[q][ne]&&(le.uniforms.height=this.contourLevels[q][ne],ie.draw(Y.LINES,this._contourCounts[q][ne],this._contourOffsets[q][ne]));for(ne=0;ne<3;++ne)for(le.uniforms.model=ae.projections[ne],le.uniforms.clipBounds=ae.clipBounds[ne],q=0;q<3;++q)if(!!this.contourProject[ne][q]){le.uniforms.permutation=S[q],Y.lineWidth(this.contourWidth[q]*this.pixelRatio);for(var se=0;se<this.contourLevels[q].length;++se)this._contourCounts[q][se]&&(le.uniforms.height=this.contourLevels[q][se],ie.draw(Y.LINES,this._contourCounts[q][se],this._contourOffsets[q][se]))}ie.unbind()}},z.pick=function(G){if(!G||G.id!==this.pickId)return null;var Y=this._field[2].shape,ee=this._pickResult,ne=Y[0]*(G.value[0]+(G.value[2]>>4)/16)/255,J=Math.floor(ne),q=ne-J,ae=Y[1]*(G.value[1]+(G.value[2]&15)/16)/255,le=Math.floor(ae),ie=ae-le;J+=1,le+=1;var se=ee.position;se[0]=se[1]=se[2]=0;for(var xe=0;xe<2;++xe)for(var oe=xe?q:1-q,he=0;he<2;++he)for(var be=he?ie:1-ie,me=J+xe,_e=le+he,Se=oe*be,De=0;De<3;++De)se[De]+=this._field[De].get(me,_e)*Se;for(var Ie=this._pickResult.level,Te=0;Te<3;++Te)if(Ie[Te]=x.le(this.contourLevels[Te],se[Te]),Ie[Te]<0)this.contourLevels[Te].length>0&&(Ie[Te]=0);else if(Ie[Te]<this.contourLevels[Te].length-1){var Ce=this.contourLevels[Te][Ie[Te]],He=this.contourLevels[Te][Ie[Te]+1];Math.abs(Ce-se[Te])>Math.abs(He-se[Te])&&(Ie[Te]+=1)}for(ee.index[0]=q<.5?J:J+1,ee.index[1]=ie<.5?le:le+1,ee.uv[0]=ne/Y[0],ee.uv[1]=ae/Y[1],De=0;De<3;++De)ee.dataCoordinate[De]=this._field[De].get(ee.index[0],ee.index[1]);return ee},z.padField=function(G,Y){var ee=Y.shape.slice(),ne=G.shape.slice();o.assign(G.lo(1,1).hi(ee[0],ee[1]),Y),o.assign(G.lo(1).hi(ee[0],1),Y.hi(ee[0],1)),o.assign(G.lo(1,ne[1]-1).hi(ee[0],1),Y.lo(0,ee[1]-1).hi(ee[0],1)),o.assign(G.lo(0,1).hi(1,ee[1]),Y.hi(1)),o.assign(G.lo(ne[0]-1,1).hi(1,ee[1]),Y.lo(ee[0]-1)),G.set(0,0,Y.get(0,0)),G.set(0,ne[1]-1,Y.get(0,ee[1]-1)),G.set(ne[0]-1,0,Y.get(ee[0]-1,0)),G.set(ne[0]-1,ne[1]-1,Y.get(ee[0]-1,ee[1]-1))};function re(G,Y){return Array.isArray(G)?[Y(G[0]),Y(G[1]),Y(G[2])]:[Y(G),Y(G),Y(G)]}function ue(G){return Array.isArray(G)?G.length===3?[G[0],G[1],G[2],1]:[G[0],G[1],G[2],G[3]]:[0,0,0,1]}function K(G){if(Array.isArray(G)){if(Array.isArray(G))return[ue(G[0]),ue(G[1]),ue(G[2])];var Y=ue(G);return[Y.slice(),Y.slice(),Y.slice()]}}z.update=function(G){G=G||{},this.objectOffset=G.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in G&&(this.contourWidth=re(G.contourWidth,Number)),"showContour"in G&&(this.showContour=re(G.showContour,Boolean)),"showSurface"in G&&(this.showSurface=!!G.showSurface),"contourTint"in G&&(this.contourTint=re(G.contourTint,Boolean)),"contourColor"in G&&(this.contourColor=K(G.contourColor)),"contourProject"in G&&(this.contourProject=re(G.contourProject,function(ut){return re(ut,Boolean)})),"surfaceProject"in G&&(this.surfaceProject=G.surfaceProject),"dynamicColor"in G&&(this.dynamicColor=K(G.dynamicColor)),"dynamicTint"in G&&(this.dynamicTint=re(G.dynamicTint,Number)),"dynamicWidth"in G&&(this.dynamicWidth=re(G.dynamicWidth,Number)),"opacity"in G&&(this.opacity=G.opacity),"opacityscale"in G&&(this.opacityscale=G.opacityscale),"colorBounds"in G&&(this.colorBounds=G.colorBounds),"vertexColor"in G&&(this.vertexColor=G.vertexColor?1:0),"colormap"in G&&this._colorMap.setPixels(this.genColormap(G.colormap,this.opacityscale));var Y=G.field||G.coords&&G.coords[2]||null,ee=!1;if(Y||(this._field[2].shape[0]||this._field[2].shape[2]?Y=this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):Y=this._field[2].hi(0,0)),"field"in G||"coords"in G){var ne=(Y.shape[0]+2)*(Y.shape[1]+2);ne>this._field[2].data.length&&(r.freeFloat(this._field[2].data),this._field[2].data=r.mallocFloat(e.nextPow2(ne))),this._field[2]=m(this._field[2].data,[Y.shape[0]+2,Y.shape[1]+2]),this.padField(this._field[2],Y),this.shape=Y.shape.slice();for(var J=this.shape,q=0;q<2;++q)this._field[2].size>this._field[q].data.length&&(r.freeFloat(this._field[q].data),this._field[q].data=r.mallocFloat(this._field[2].size)),this._field[q]=m(this._field[q].data,[J[0]+2,J[1]+2]);if(G.coords){var ae=G.coords;if(!Array.isArray(ae)||ae.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(q=0;q<2;++q){var le=ae[q];for(he=0;he<2;++he)if(le.shape[he]!==J[he])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[q],le)}}else if(G.ticks){var ie=G.ticks;if(!Array.isArray(ie)||ie.length!==2)throw new Error("gl-surface: invalid ticks");for(q=0;q<2;++q){var se=ie[q];if((Array.isArray(se)||se.length)&&(se=m(se)),se.shape[0]!==J[q])throw new Error("gl-surface: invalid tick length");var xe=m(se.data,J);xe.stride[q]=se.stride[0],xe.stride[q^1]=0,this.padField(this._field[q],xe)}}else{for(q=0;q<2;++q){var oe=[0,0];oe[q]=1,this._field[q]=m(this._field[q].data,[J[0]+2,J[1]+2],oe,0)}this._field[0].set(0,0,0);for(var he=0;he<J[0];++he)this._field[0].set(he+1,0,he);for(this._field[0].set(J[0]+1,0,J[0]-1),this._field[1].set(0,0,0),he=0;he<J[1];++he)this._field[1].set(0,he+1,he);this._field[1].set(0,J[1]+1,J[1]-1)}var be=this._field,me=m(r.mallocFloat(be[2].size*3*2),[3,J[0]+2,J[1]+2,2]);for(q=0;q<3;++q)l(me.pick(q),be[q],"mirror");var _e=m(r.mallocFloat(be[2].size*3),[J[0]+2,J[1]+2,3]);for(q=0;q<J[0]+2;++q)for(he=0;he<J[1]+2;++he){var Se=me.get(0,q,he,0),De=me.get(0,q,he,1),Ie=me.get(1,q,he,0),Te=me.get(1,q,he,1),Ce=me.get(2,q,he,0),He=me.get(2,q,he,1),Xe=Ie*He-Te*Ce,Be=Ce*De-He*Se,Re=Se*Te-De*Ie,We=Math.sqrt(Xe*Xe+Be*Be+Re*Re);We<1e-8?(We=Math.max(Math.abs(Xe),Math.abs(Be),Math.abs(Re)),We<1e-8?(Re=1,Be=Xe=0,We=1):We=1/We):We=1/Math.sqrt(We),_e.set(q,he,0,Xe*We),_e.set(q,he,1,Be*We),_e.set(q,he,2,Re*We)}r.free(me.data);var vt=[1/0,1/0,1/0],Pt=[-1/0,-1/0,-1/0],Zt=1/0,zt=-1/0,At=(J[0]-1)*(J[1]-1)*6,Wt=r.mallocFloat(e.nextPow2(10*At)),Bt=0,Ct=0;for(q=0;q<J[0]-1;++q){e:for(he=0;he<J[1]-1;++he){for(var Ze=0;Ze<2;++Ze)for(var nt=0;nt<2;++nt)for(var Ye=0;Ye<3;++Ye){var Ee=this._field[Ye].get(1+q+Ze,1+he+nt);if(isNaN(Ee)||!isFinite(Ee))continue e}for(Ye=0;Ye<6;++Ye){var Ge=q+C[Ye][0],Je=he+C[Ye][1],qe=this._field[0].get(Ge+1,Je+1),Tt=this._field[1].get(Ge+1,Je+1);Ee=this._field[2].get(Ge+1,Je+1),Xe=_e.get(Ge+1,Je+1,0),Be=_e.get(Ge+1,Je+1,1),Re=_e.get(Ge+1,Je+1,2),G.intensity&&(mt=G.intensity.get(Ge,Je));var mt=G.intensity?G.intensity.get(Ge,Je):Ee+this.objectOffset[2];Wt[Bt++]=Ge,Wt[Bt++]=Je,Wt[Bt++]=qe,Wt[Bt++]=Tt,Wt[Bt++]=Ee,Wt[Bt++]=0,Wt[Bt++]=mt,Wt[Bt++]=Xe,Wt[Bt++]=Be,Wt[Bt++]=Re,vt[0]=Math.min(vt[0],qe+this.objectOffset[0]),vt[1]=Math.min(vt[1],Tt+this.objectOffset[1]),vt[2]=Math.min(vt[2],Ee+this.objectOffset[2]),Zt=Math.min(Zt,mt),Pt[0]=Math.max(Pt[0],qe+this.objectOffset[0]),Pt[1]=Math.max(Pt[1],Tt+this.objectOffset[1]),Pt[2]=Math.max(Pt[2],Ee+this.objectOffset[2]),zt=Math.max(zt,mt),Ct+=1}}}for(G.intensityBounds&&(Zt=+G.intensityBounds[0],zt=+G.intensityBounds[1]),q=6;q<Bt;q+=10)Wt[q]=(Wt[q]-Zt)/(zt-Zt);this._vertexCount=Ct,this._coordinateBuffer.update(Wt.subarray(0,Bt)),r.freeFloat(Wt),r.free(_e.data),this.bounds=[vt,Pt],this.intensity=G.intensity||this._field[2],(this.intensityBounds[0]!==Zt||this.intensityBounds[1]!==zt)&&(ee=!0),this.intensityBounds=[Zt,zt]}if("levels"in G){var Mt=G.levels;for(Array.isArray(Mt[0])?Mt=Mt.slice():Mt=[[],[],Mt],q=0;q<3;++q)Mt[q]=Mt[q].slice(),Mt[q].sort(function(ut,ht){return ut-ht});for(q=0;q<3;++q)for(he=0;he<Mt[q].length;++he)Mt[q][he]-=this.objectOffset[q];e:for(q=0;q<3;++q){if(Mt[q].length!==this.contourLevels[q].length){ee=!0;break}for(he=0;he<Mt[q].length;++he)if(Mt[q][he]!==this.contourLevels[q][he]){ee=!0;break e}}this.contourLevels=Mt}if(ee){be=this._field,J=this.shape;for(var Ht=[],Rt=0;Rt<3;++Rt){var Vt=this.contourLevels[Rt],Jt=[],Yt=[],or=[0,0,0];for(q=0;q<Vt.length;++q){var Hr=g(this._field[Rt],Vt[q]);Jt.push(Ht.length/5|0),Ct=0;e:for(he=0;he<Hr.cells.length;++he){var an=Hr.cells[he];for(Ye=0;Ye<2;++Ye){var Kr=Hr.positions[an[Ye]],ot=Kr[0],er=Math.floor(ot)|0,Kt=ot-er,ur=Kr[1],Ar=Math.floor(ur)|0,et=ur-Ar,$e=!1;t:for(var st=0;st<3;++st){or[st]=0;var ft=(Rt+st+1)%3;for(Ze=0;Ze<2;++Ze){var St=Ze?Kt:1-Kt;for(Ge=Math.min(Math.max(er+Ze,0),J[0])|0,nt=0;nt<2;++nt){var Ut=nt?et:1-et;if(Je=Math.min(Math.max(Ar+nt,0),J[1])|0,st<2?Ee=this._field[ft].get(Ge,Je):Ee=(this.intensity.get(Ge,Je)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(Ee)||isNaN(Ee)){$e=!0;break t}var Pe=St*Ut;or[st]+=Pe*Ee}}}if(!$e)Ht.push(or[0],or[1],Kr[0],Kr[1],or[2]),Ct+=1;else{if(Ye>0){for(var ke=0;ke<5;++ke)Ht.pop();Ct-=1}continue e}}}Yt.push(Ct)}this._contourOffsets[Rt]=Jt,this._contourCounts[Rt]=Yt}var it=r.mallocFloat(Ht.length);for(q=0;q<Ht.length;++q)it[q]=Ht[q];this._contourBuffer.update(it),r.freeFloat(it)}},z.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var G=0;G<3;++G)r.freeFloat(this._field[G].data)},z.highlight=function(G){var Y;if(!G){this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],this.highlightLevel=[-1,-1,-1];return}for(Y=0;Y<3;++Y)this.enableHighlight[Y]?this.highlightLevel[Y]=G.level[Y]:this.highlightLevel[Y]=-1;var ee;for(this.snapToData?ee=G.dataCoordinate:ee=G.position,Y=0;Y<3;++Y)ee[Y]-=this.objectOffset[Y];if(!((!this.enableDynamic[0]||ee[0]===this.dynamicLevel[0])&&(!this.enableDynamic[1]||ee[1]===this.dynamicLevel[1])&&(!this.enableDynamic[2]||ee[2]===this.dynamicLevel[2]))){for(var ne=0,J=this.shape,q=r.mallocFloat(12*J[0]*J[1]),ae=0;ae<3;++ae){if(!this.enableDynamic[ae]){this.dynamicLevel[ae]=NaN,this._dynamicCounts[ae]=0;continue}this.dynamicLevel[ae]=ee[ae];var le=(ae+1)%3,ie=(ae+2)%3,se=this._field[ae],xe=this._field[le],oe=this._field[ie],he=g(se,ee[ae]),be=he.cells,me=he.positions;for(this._dynamicOffsets[ae]=ne,Y=0;Y<be.length;++Y)for(var _e=be[Y],Se=0;Se<2;++Se){var De=me[_e[Se]],Ie=+De[0],Te=Ie|0,Ce=Math.min(Te+1,J[0])|0,He=Ie-Te,Xe=1-He,Be=+De[1],Re=Be|0,We=Math.min(Re+1,J[1])|0,vt=Be-Re,Pt=1-vt,Zt=Xe*Pt,zt=Xe*vt,At=He*Pt,Wt=He*vt,Bt=Zt*xe.get(Te,Re)+zt*xe.get(Te,We)+At*xe.get(Ce,Re)+Wt*xe.get(Ce,We),Ct=Zt*oe.get(Te,Re)+zt*oe.get(Te,We)+At*oe.get(Ce,Re)+Wt*oe.get(Ce,We);if(isNaN(Bt)||isNaN(Ct)){Se&&(ne-=1);break}q[2*ne+0]=Bt,q[2*ne+1]=Ct,ne+=1}this._dynamicCounts[ae]=ne-this._dynamicOffsets[ae]}this._dynamicBuffer.update(q.subarray(0,2*ne)),r.freeFloat(q)}};function te(G){var Y=G.gl,ee=c(Y),ne=_(Y),J=M(Y),q=y(Y),ae=i(Y),le=n(Y,[{buffer:ae,size:4,stride:w,offset:0},{buffer:ae,size:3,stride:w,offset:16},{buffer:ae,size:3,stride:w,offset:28}]),ie=i(Y),se=n(Y,[{buffer:ie,size:4,stride:20,offset:0},{buffer:ie,size:1,stride:20,offset:16}]),xe=i(Y),oe=n(Y,[{buffer:xe,size:2,type:Y.FLOAT}]),he=a(Y,1,k,Y.RGBA,Y.UNSIGNED_BYTE);he.minFilter=Y.LINEAR,he.magFilter=Y.LINEAR;var be=new B(Y,[0,0],[[0,0,0],[0,0,0]],ee,ne,ae,le,he,J,q,ie,se,xe,oe,[0,0,0]),me={levels:[[],[],[]]};for(var _e in G)me[_e]=G[_e];return me.colormap=me.colormap||"jet",be.update(me),be}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(u,A,T){var e=u("ndarray"),i=u("ndarray-ops"),n=u("typedarray-pool");A.exports=y;var a=null,r=null,f=null;function o(w){a=[w.LINEAR,w.NEAREST_MIPMAP_LINEAR,w.LINEAR_MIPMAP_NEAREST,w.LINEAR_MIPMAP_NEAREST],r=[w.NEAREST,w.LINEAR,w.NEAREST_MIPMAP_NEAREST,w.NEAREST_MIPMAP_LINEAR,w.LINEAR_MIPMAP_NEAREST,w.LINEAR_MIPMAP_LINEAR],f=[w.REPEAT,w.CLAMP_TO_EDGE,w.MIRRORED_REPEAT]}function s(w){return typeof HTMLCanvasElement<"u"&&w instanceof HTMLCanvasElement||typeof HTMLImageElement<"u"&&w instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&w instanceof HTMLVideoElement||typeof ImageData<"u"&&w instanceof ImageData}var m=function(w,d){i.muls(w,d,255)};function g(w,d,C){var S=w.gl,E=S.getParameter(S.MAX_TEXTURE_SIZE);if(d<0||d>E||C<0||C>E)throw new Error("gl-texture2d: Invalid texture size");return w._shape=[d,C],w.bind(),S.texImage2D(S.TEXTURE_2D,0,w.format,d,C,0,w.format,w.type,null),w._mipLevels=[0],w}function p(w,d,C,S,E,k){this.gl=w,this.handle=d,this.format=E,this.type=k,this._shape=[C,S],this._mipLevels=[0],this._magFilter=w.NEAREST,this._minFilter=w.NEAREST,this._wrapS=w.CLAMP_TO_EDGE,this._wrapT=w.CLAMP_TO_EDGE,this._anisoSamples=1;var B=this,z=[this._wrapS,this._wrapT];Object.defineProperties(z,[{get:function(){return B._wrapS},set:function(I){return B.wrapS=I}},{get:function(){return B._wrapT},set:function(I){return B.wrapT=I}}]),this._wrapVector=z;var F=[this._shape[0],this._shape[1]];Object.defineProperties(F,[{get:function(){return B._shape[0]},set:function(I){return B.width=I}},{get:function(){return B._shape[1]},set:function(I){return B.height=I}}]),this._shapeVector=F}var v=p.prototype;Object.defineProperties(v,{minFilter:{get:function(){return this._minFilter},set:function(w){this.bind();var d=this.gl;if(this.type===d.FLOAT&&a.indexOf(w)>=0&&(d.getExtension("OES_texture_float_linear")||(w=d.NEAREST)),r.indexOf(w)<0)throw new Error("gl-texture2d: Unknown filter mode "+w);return d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,w),this._minFilter=w}},magFilter:{get:function(){return this._magFilter},set:function(w){this.bind();var d=this.gl;if(this.type===d.FLOAT&&a.indexOf(w)>=0&&(d.getExtension("OES_texture_float_linear")||(w=d.NEAREST)),r.indexOf(w)<0)throw new Error("gl-texture2d: Unknown filter mode "+w);return d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,w),this._magFilter=w}},mipSamples:{get:function(){return this._anisoSamples},set:function(w){var d=this._anisoSamples;if(this._anisoSamples=Math.max(w,1)|0,d!==this._anisoSamples){var C=this.gl.getExtension("EXT_texture_filter_anisotropic");C&&this.gl.texParameterf(this.gl.TEXTURE_2D,C.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(w){if(this.bind(),f.indexOf(w)<0)throw new Error("gl-texture2d: Unknown wrap mode "+w);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,w),this._wrapS=w}},wrapT:{get:function(){return this._wrapT},set:function(w){if(this.bind(),f.indexOf(w)<0)throw new Error("gl-texture2d: Unknown wrap mode "+w);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,w),this._wrapT=w}},wrap:{get:function(){return this._wrapVector},set:function(w){if(Array.isArray(w)||(w=[w,w]),w.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var d=0;d<2;++d)if(f.indexOf(w[d])<0)throw new Error("gl-texture2d: Unknown wrap mode "+w);this._wrapS=w[0],this._wrapT=w[1];var C=this.gl;return this.bind(),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,this._wrapS),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,this._wrapT),w}},shape:{get:function(){return this._shapeVector},set:function(w){if(!Array.isArray(w))w=[w|0,w|0];else if(w.length!==2)throw new Error("gl-texture2d: Invalid texture shape");return g(this,w[0]|0,w[1]|0),[w[0]|0,w[1]|0]}},width:{get:function(){return this._shape[0]},set:function(w){return w=w|0,g(this,w,this._shape[1]),w}},height:{get:function(){return this._shape[1]},set:function(w){return w=w|0,g(this,this._shape[0],w),w}}}),v.bind=function(w){var d=this.gl;return w!==void 0&&d.activeTexture(d.TEXTURE0+(w|0)),d.bindTexture(d.TEXTURE_2D,this.handle),w!==void 0?w|0:d.getParameter(d.ACTIVE_TEXTURE)-d.TEXTURE0},v.dispose=function(){this.gl.deleteTexture(this.handle)},v.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var w=Math.min(this._shape[0],this._shape[1]),d=0;w>0;++d,w>>>=1)this._mipLevels.indexOf(d)<0&&this._mipLevels.push(d)},v.setPixels=function(w,d,C,S){var E=this.gl;this.bind(),Array.isArray(d)?(S=C,C=d[1]|0,d=d[0]|0):(d=d||0,C=C||0),S=S||0;var k=s(w)?w:w.raw;if(k){var B=this._mipLevels.indexOf(S)<0;B?(E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,this.type,k),this._mipLevels.push(S)):E.texSubImage2D(E.TEXTURE_2D,S,d,C,this.format,this.type,k)}else if(w.shape&&w.stride&&w.data){if(w.shape.length<2||d+w.shape[1]>this._shape[1]>>>S||C+w.shape[0]>this._shape[0]>>>S||d<0||C<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");l(E,d,C,S,this.format,this.type,this._mipLevels,w)}else throw new Error("gl-texture2d: Unsupported data type")};function x(w,d){return w.length===3?d[2]===1&&d[1]===w[0]*w[2]&&d[0]===w[2]:d[0]===1&&d[1]===w[0]}function l(w,d,C,S,E,k,B,z){var F=z.dtype,I=z.shape.slice();if(I.length<2||I.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var O=0,N=0,V=x(I,z.stride.slice());if(F==="float32"?O=w.FLOAT:F==="float64"?(O=w.FLOAT,V=!1,F="float32"):F==="uint8"?O=w.UNSIGNED_BYTE:(O=w.UNSIGNED_BYTE,V=!1,F="uint8"),I.length===2)N=w.LUMINANCE,I=[I[0],I[1],1],z=e(z.data,I,[z.stride[0],z.stride[1],1],z.offset);else if(I.length===3){if(I[2]===1)N=w.ALPHA;else if(I[2]===2)N=w.LUMINANCE_ALPHA;else if(I[2]===3)N=w.RGB;else if(I[2]===4)N=w.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");I[2]}else throw new Error("gl-texture2d: Invalid shape for texture");if((N===w.LUMINANCE||N===w.ALPHA)&&(E===w.LUMINANCE||E===w.ALPHA)&&(N=E),N!==E)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var H=z.size,j=B.indexOf(S)<0;if(j&&B.push(S),O===k&&V)z.offset===0&&z.data.length===H?j?w.texImage2D(w.TEXTURE_2D,S,E,I[0],I[1],0,E,k,z.data):w.texSubImage2D(w.TEXTURE_2D,S,d,C,I[0],I[1],E,k,z.data):j?w.texImage2D(w.TEXTURE_2D,S,E,I[0],I[1],0,E,k,z.data.subarray(z.offset,z.offset+H)):w.texSubImage2D(w.TEXTURE_2D,S,d,C,I[0],I[1],E,k,z.data.subarray(z.offset,z.offset+H));else{var Z;k===w.FLOAT?Z=n.mallocFloat32(H):Z=n.mallocUint8(H);var X=e(Z,I,[I[2],I[2]*I[0],1]);O===w.FLOAT&&k===w.UNSIGNED_BYTE?m(X,z):i.assign(X,z),j?w.texImage2D(w.TEXTURE_2D,S,E,I[0],I[1],0,E,k,Z.subarray(0,H)):w.texSubImage2D(w.TEXTURE_2D,S,d,C,I[0],I[1],E,k,Z.subarray(0,H)),k===w.FLOAT?n.freeFloat32(Z):n.freeUint8(Z)}}function b(w){var d=w.createTexture();return w.bindTexture(w.TEXTURE_2D,d),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.NEAREST),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.NEAREST),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),d}function c(w,d,C,S,E){var k=w.getParameter(w.MAX_TEXTURE_SIZE);if(d<0||d>k||C<0||C>k)throw new Error("gl-texture2d: Invalid texture shape");if(E===w.FLOAT&&!w.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var B=b(w);return w.texImage2D(w.TEXTURE_2D,0,S,d,C,0,S,E,null),new p(w,B,d,C,S,E)}function M(w,d,C,S,E,k){var B=b(w);return w.texImage2D(w.TEXTURE_2D,0,E,E,k,d),new p(w,B,C,S,E,k)}function _(w,d){var C=d.dtype,S=d.shape.slice(),E=w.getParameter(w.MAX_TEXTURE_SIZE);if(S[0]<0||S[0]>E||S[1]<0||S[1]>E)throw new Error("gl-texture2d: Invalid texture size");var k=x(S,d.stride.slice()),B=0;C==="float32"?B=w.FLOAT:C==="float64"?(B=w.FLOAT,k=!1,C="float32"):C==="uint8"?B=w.UNSIGNED_BYTE:(B=w.UNSIGNED_BYTE,k=!1,C="uint8");var z=0;if(S.length===2)z=w.LUMINANCE,S=[S[0],S[1],1],d=e(d.data,S,[d.stride[0],d.stride[1],1],d.offset);else if(S.length===3)if(S[2]===1)z=w.ALPHA;else if(S[2]===2)z=w.LUMINANCE_ALPHA;else if(S[2]===3)z=w.RGB;else if(S[2]===4)z=w.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");else throw new Error("gl-texture2d: Invalid shape for texture");B===w.FLOAT&&!w.getExtension("OES_texture_float")&&(B=w.UNSIGNED_BYTE,k=!1);var F,I,O=d.size;if(k)d.offset===0&&d.data.length===O?F=d.data:F=d.data.subarray(d.offset,d.offset+O);else{var N=[S[2],S[2]*S[0],1];I=n.malloc(O,C);var V=e(I,S,N,0);(C==="float32"||C==="float64")&&B===w.UNSIGNED_BYTE?m(V,d):i.assign(V,d),F=I.subarray(0,O)}var H=b(w);return w.texImage2D(w.TEXTURE_2D,0,z,S[0],S[1],0,z,B,F),k||n.free(I),new p(w,H,S[0],S[1],z,B)}function y(w){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(a||o(w),typeof arguments[1]=="number")return c(w,arguments[1],arguments[2],arguments[3]||w.RGBA,arguments[4]||w.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return c(w,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||w.RGBA,arguments[3]||w.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var d=arguments[1],C=s(d)?d:d.raw;if(C)return M(w,C,d.width|0,d.height|0,arguments[2]||w.RGBA,arguments[3]||w.UNSIGNED_BYTE);if(d.shape&&d.data&&d.stride)return _(w,d)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(u,A,T){function e(i,n,a){n?n.bind():i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,null);var r=i.getParameter(i.MAX_VERTEX_ATTRIBS)|0;if(a){if(a.length>r)throw new Error("gl-vao: Too many vertex attributes");for(var f=0;f<a.length;++f){var o=a[f];if(o.buffer){var s=o.buffer,m=o.size||4,g=o.type||i.FLOAT,p=!!o.normalized,v=o.stride||0,x=o.offset||0;s.bind(),i.enableVertexAttribArray(f),i.vertexAttribPointer(f,m,g,p,v,x)}else{if(typeof o=="number")i.vertexAttrib1f(f,o);else if(o.length===1)i.vertexAttrib1f(f,o[0]);else if(o.length===2)i.vertexAttrib2f(f,o[0],o[1]);else if(o.length===3)i.vertexAttrib3f(f,o[0],o[1],o[2]);else if(o.length===4)i.vertexAttrib4f(f,o[0],o[1],o[2],o[3]);else throw new Error("gl-vao: Invalid vertex attribute");i.disableVertexAttribArray(f)}}for(;f<r;++f)i.disableVertexAttribArray(f)}else{i.bindBuffer(i.ARRAY_BUFFER,null);for(var f=0;f<r;++f)i.disableVertexAttribArray(f)}}A.exports=e},{}],148:[function(u,A,T){var e=u("./do-bind.js");function i(a){this.gl=a,this._elements=null,this._attributes=null,this._elementsType=a.UNSIGNED_SHORT}i.prototype.bind=function(){e(this.gl,this._elements,this._attributes)},i.prototype.update=function(a,r,f){this._elements=r,this._attributes=a,this._elementsType=f||this.gl.UNSIGNED_SHORT},i.prototype.dispose=function(){},i.prototype.unbind=function(){},i.prototype.draw=function(a,r,f){f=f||0;var o=this.gl;this._elements?o.drawElements(a,r,this._elementsType,f):o.drawArrays(a,f,r)};function n(a){return new i(a)}A.exports=n},{"./do-bind.js":147}],149:[function(u,A,T){var e=u("./do-bind.js");function i(r,f,o,s,m,g){this.location=r,this.dimension=f,this.a=o,this.b=s,this.c=m,this.d=g}i.prototype.bind=function(r){switch(this.dimension){case 1:r.vertexAttrib1f(this.location,this.a);break;case 2:r.vertexAttrib2f(this.location,this.a,this.b);break;case 3:r.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:r.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function n(r,f,o){this.gl=r,this._ext=f,this.handle=o,this._attribs=[],this._useElements=!1,this._elementsType=r.UNSIGNED_SHORT}n.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var r=0;r<this._attribs.length;++r)this._attribs[r].bind(this.gl)},n.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},n.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},n.prototype.update=function(r,f,o){if(this.bind(),e(this.gl,f,r),this.unbind(),this._attribs.length=0,r)for(var s=0;s<r.length;++s){var m=r[s];typeof m=="number"?this._attribs.push(new i(s,1,m)):Array.isArray(m)&&this._attribs.push(new i(s,m.length,m[0],m[1],m[2],m[3]))}this._useElements=!!f,this._elementsType=o||this.gl.UNSIGNED_SHORT},n.prototype.draw=function(r,f,o){o=o||0;var s=this.gl;this._useElements?s.drawElements(r,f,this._elementsType,o):s.drawArrays(r,o,f)};function a(r,f){return new n(r,f,f.createVertexArrayOES())}A.exports=a},{"./do-bind.js":147}],150:[function(u,A,T){var e=u("./lib/vao-native.js"),i=u("./lib/vao-emulated.js");function n(r){this.bindVertexArrayOES=r.bindVertexArray.bind(r),this.createVertexArrayOES=r.createVertexArray.bind(r),this.deleteVertexArrayOES=r.deleteVertexArray.bind(r)}function a(r,f,o,s){var m=r.createVertexArray?new n(r):r.getExtension("OES_vertex_array_object"),g;return m?g=e(r,m):g=i(r),g.update(f,o,s),g}A.exports=a},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=n[0]+a[0],i[1]=n[1]+a[1],i[2]=n[2]+a[2],i}},{}],152:[function(u,A,T){A.exports=a;var e=u("./fromValues"),i=u("./normalize"),n=u("./dot");function a(r,f){var o=e(r[0],r[1],r[2]),s=e(f[0],f[1],f[2]);i(o,o),i(s,s);var m=n(o,s);return m>1?0:Math.acos(m)}},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(u,A,T){A.exports=e;function e(i,n){return i[0]=Math.ceil(n[0]),i[1]=Math.ceil(n[1]),i[2]=Math.ceil(n[2]),i}},{}],154:[function(u,A,T){A.exports=e;function e(i){var n=new Float32Array(3);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n}},{}],155:[function(u,A,T){A.exports=e;function e(i,n){return i[0]=n[0],i[1]=n[1],i[2]=n[2],i}},{}],156:[function(u,A,T){A.exports=e;function e(){var i=new Float32Array(3);return i[0]=0,i[1]=0,i[2]=0,i}},{}],157:[function(u,A,T){A.exports=e;function e(i,n,a){var r=n[0],f=n[1],o=n[2],s=a[0],m=a[1],g=a[2];return i[0]=f*g-o*m,i[1]=o*s-r*g,i[2]=r*m-f*s,i}},{}],158:[function(u,A,T){A.exports=u("./distance")},{"./distance":159}],159:[function(u,A,T){A.exports=e;function e(i,n){var a=n[0]-i[0],r=n[1]-i[1],f=n[2]-i[2];return Math.sqrt(a*a+r*r+f*f)}},{}],160:[function(u,A,T){A.exports=u("./divide")},{"./divide":161}],161:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=n[0]/a[0],i[1]=n[1]/a[1],i[2]=n[2]/a[2],i}},{}],162:[function(u,A,T){A.exports=e;function e(i,n){return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]}},{}],163:[function(u,A,T){A.exports=1e-6},{}],164:[function(u,A,T){A.exports=i;var e=u("./epsilon");function i(n,a){var r=n[0],f=n[1],o=n[2],s=a[0],m=a[1],g=a[2];return Math.abs(r-s)<=e*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(f-m)<=e*Math.max(1,Math.abs(f),Math.abs(m))&&Math.abs(o-g)<=e*Math.max(1,Math.abs(o),Math.abs(g))}},{"./epsilon":163}],165:[function(u,A,T){A.exports=e;function e(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]}},{}],166:[function(u,A,T){A.exports=e;function e(i,n){return i[0]=Math.floor(n[0]),i[1]=Math.floor(n[1]),i[2]=Math.floor(n[2]),i}},{}],167:[function(u,A,T){A.exports=i;var e=u("./create")();function i(n,a,r,f,o,s){var m,g;for(a||(a=3),r||(r=0),f?g=Math.min(f*a+r,n.length):g=n.length,m=r;m<g;m+=a)e[0]=n[m],e[1]=n[m+1],e[2]=n[m+2],o(e,e,s),n[m]=e[0],n[m+1]=e[1],n[m+2]=e[2];return n}},{"./create":156}],168:[function(u,A,T){A.exports=e;function e(i,n,a){var r=new Float32Array(3);return r[0]=i,r[1]=n,r[2]=a,r}},{}],169:[function(u,A,T){A.exports={EPSILON:u("./epsilon"),create:u("./create"),clone:u("./clone"),angle:u("./angle"),fromValues:u("./fromValues"),copy:u("./copy"),set:u("./set"),equals:u("./equals"),exactEquals:u("./exactEquals"),add:u("./add"),subtract:u("./subtract"),sub:u("./sub"),multiply:u("./multiply"),mul:u("./mul"),divide:u("./divide"),div:u("./div"),min:u("./min"),max:u("./max"),floor:u("./floor"),ceil:u("./ceil"),round:u("./round"),scale:u("./scale"),scaleAndAdd:u("./scaleAndAdd"),distance:u("./distance"),dist:u("./dist"),squaredDistance:u("./squaredDistance"),sqrDist:u("./sqrDist"),length:u("./length"),len:u("./len"),squaredLength:u("./squaredLength"),sqrLen:u("./sqrLen"),negate:u("./negate"),inverse:u("./inverse"),normalize:u("./normalize"),dot:u("./dot"),cross:u("./cross"),lerp:u("./lerp"),random:u("./random"),transformMat4:u("./transformMat4"),transformMat3:u("./transformMat3"),transformQuat:u("./transformQuat"),rotateX:u("./rotateX"),rotateY:u("./rotateY"),rotateZ:u("./rotateZ"),forEach:u("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(u,A,T){A.exports=e;function e(i,n){return i[0]=1/n[0],i[1]=1/n[1],i[2]=1/n[2],i}},{}],171:[function(u,A,T){A.exports=u("./length")},{"./length":172}],172:[function(u,A,T){A.exports=e;function e(i){var n=i[0],a=i[1],r=i[2];return Math.sqrt(n*n+a*a+r*r)}},{}],173:[function(u,A,T){A.exports=e;function e(i,n,a,r){var f=n[0],o=n[1],s=n[2];return i[0]=f+r*(a[0]-f),i[1]=o+r*(a[1]-o),i[2]=s+r*(a[2]-s),i}},{}],174:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=Math.max(n[0],a[0]),i[1]=Math.max(n[1],a[1]),i[2]=Math.max(n[2],a[2]),i}},{}],175:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=Math.min(n[0],a[0]),i[1]=Math.min(n[1],a[1]),i[2]=Math.min(n[2],a[2]),i}},{}],176:[function(u,A,T){A.exports=u("./multiply")},{"./multiply":177}],177:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=n[0]*a[0],i[1]=n[1]*a[1],i[2]=n[2]*a[2],i}},{}],178:[function(u,A,T){A.exports=e;function e(i,n){return i[0]=-n[0],i[1]=-n[1],i[2]=-n[2],i}},{}],179:[function(u,A,T){A.exports=e;function e(i,n){var a=n[0],r=n[1],f=n[2],o=a*a+r*r+f*f;return o>0&&(o=1/Math.sqrt(o),i[0]=n[0]*o,i[1]=n[1]*o,i[2]=n[2]*o),i}},{}],180:[function(u,A,T){A.exports=e;function e(i,n){n=n||1;var a=Math.random()*2*Math.PI,r=Math.random()*2-1,f=Math.sqrt(1-r*r)*n;return i[0]=Math.cos(a)*f,i[1]=Math.sin(a)*f,i[2]=r*n,i}},{}],181:[function(u,A,T){A.exports=e;function e(i,n,a,r){var f=a[1],o=a[2],s=n[1]-f,m=n[2]-o,g=Math.sin(r),p=Math.cos(r);return i[0]=n[0],i[1]=f+s*p-m*g,i[2]=o+s*g+m*p,i}},{}],182:[function(u,A,T){A.exports=e;function e(i,n,a,r){var f=a[0],o=a[2],s=n[0]-f,m=n[2]-o,g=Math.sin(r),p=Math.cos(r);return i[0]=f+m*g+s*p,i[1]=n[1],i[2]=o+m*p-s*g,i}},{}],183:[function(u,A,T){A.exports=e;function e(i,n,a,r){var f=a[0],o=a[1],s=n[0]-f,m=n[1]-o,g=Math.sin(r),p=Math.cos(r);return i[0]=f+s*p-m*g,i[1]=o+s*g+m*p,i[2]=n[2],i}},{}],184:[function(u,A,T){A.exports=e;function e(i,n){return i[0]=Math.round(n[0]),i[1]=Math.round(n[1]),i[2]=Math.round(n[2]),i}},{}],185:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=n[0]*a,i[1]=n[1]*a,i[2]=n[2]*a,i}},{}],186:[function(u,A,T){A.exports=e;function e(i,n,a,r){return i[0]=n[0]+a[0]*r,i[1]=n[1]+a[1]*r,i[2]=n[2]+a[2]*r,i}},{}],187:[function(u,A,T){A.exports=e;function e(i,n,a,r){return i[0]=n,i[1]=a,i[2]=r,i}},{}],188:[function(u,A,T){A.exports=u("./squaredDistance")},{"./squaredDistance":190}],189:[function(u,A,T){A.exports=u("./squaredLength")},{"./squaredLength":191}],190:[function(u,A,T){A.exports=e;function e(i,n){var a=n[0]-i[0],r=n[1]-i[1],f=n[2]-i[2];return a*a+r*r+f*f}},{}],191:[function(u,A,T){A.exports=e;function e(i){var n=i[0],a=i[1],r=i[2];return n*n+a*a+r*r}},{}],192:[function(u,A,T){A.exports=u("./subtract")},{"./subtract":193}],193:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=n[0]-a[0],i[1]=n[1]-a[1],i[2]=n[2]-a[2],i}},{}],194:[function(u,A,T){A.exports=e;function e(i,n,a){var r=n[0],f=n[1],o=n[2];return i[0]=r*a[0]+f*a[3]+o*a[6],i[1]=r*a[1]+f*a[4]+o*a[7],i[2]=r*a[2]+f*a[5]+o*a[8],i}},{}],195:[function(u,A,T){A.exports=e;function e(i,n,a){var r=n[0],f=n[1],o=n[2],s=a[3]*r+a[7]*f+a[11]*o+a[15];return s=s||1,i[0]=(a[0]*r+a[4]*f+a[8]*o+a[12])/s,i[1]=(a[1]*r+a[5]*f+a[9]*o+a[13])/s,i[2]=(a[2]*r+a[6]*f+a[10]*o+a[14])/s,i}},{}],196:[function(u,A,T){A.exports=e;function e(i,n,a){var r=n[0],f=n[1],o=n[2],s=a[0],m=a[1],g=a[2],p=a[3],v=p*r+m*o-g*f,x=p*f+g*r-s*o,l=p*o+s*f-m*r,b=-s*r-m*f-g*o;return i[0]=v*p+b*-s+x*-g-l*-m,i[1]=x*p+b*-m+l*-s-v*-g,i[2]=l*p+b*-g+v*-m-x*-s,i}},{}],197:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=n[0]+a[0],i[1]=n[1]+a[1],i[2]=n[2]+a[2],i[3]=n[3]+a[3],i}},{}],198:[function(u,A,T){A.exports=e;function e(i){var n=new Float32Array(4);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n}},{}],199:[function(u,A,T){A.exports=e;function e(i,n){return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i}},{}],200:[function(u,A,T){A.exports=e;function e(){var i=new Float32Array(4);return i[0]=0,i[1]=0,i[2]=0,i[3]=0,i}},{}],201:[function(u,A,T){A.exports=e;function e(i,n){var a=n[0]-i[0],r=n[1]-i[1],f=n[2]-i[2],o=n[3]-i[3];return Math.sqrt(a*a+r*r+f*f+o*o)}},{}],202:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=n[0]/a[0],i[1]=n[1]/a[1],i[2]=n[2]/a[2],i[3]=n[3]/a[3],i}},{}],203:[function(u,A,T){A.exports=e;function e(i,n){return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]+i[3]*n[3]}},{}],204:[function(u,A,T){A.exports=e;function e(i,n,a,r){var f=new Float32Array(4);return f[0]=i,f[1]=n,f[2]=a,f[3]=r,f}},{}],205:[function(u,A,T){A.exports={create:u("./create"),clone:u("./clone"),fromValues:u("./fromValues"),copy:u("./copy"),set:u("./set"),add:u("./add"),subtract:u("./subtract"),multiply:u("./multiply"),divide:u("./divide"),min:u("./min"),max:u("./max"),scale:u("./scale"),scaleAndAdd:u("./scaleAndAdd"),distance:u("./distance"),squaredDistance:u("./squaredDistance"),length:u("./length"),squaredLength:u("./squaredLength"),negate:u("./negate"),inverse:u("./inverse"),normalize:u("./normalize"),dot:u("./dot"),lerp:u("./lerp"),random:u("./random"),transformMat4:u("./transformMat4"),transformQuat:u("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(u,A,T){A.exports=e;function e(i,n){return i[0]=1/n[0],i[1]=1/n[1],i[2]=1/n[2],i[3]=1/n[3],i}},{}],207:[function(u,A,T){A.exports=e;function e(i){var n=i[0],a=i[1],r=i[2],f=i[3];return Math.sqrt(n*n+a*a+r*r+f*f)}},{}],208:[function(u,A,T){A.exports=e;function e(i,n,a,r){var f=n[0],o=n[1],s=n[2],m=n[3];return i[0]=f+r*(a[0]-f),i[1]=o+r*(a[1]-o),i[2]=s+r*(a[2]-s),i[3]=m+r*(a[3]-m),i}},{}],209:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=Math.max(n[0],a[0]),i[1]=Math.max(n[1],a[1]),i[2]=Math.max(n[2],a[2]),i[3]=Math.max(n[3],a[3]),i}},{}],210:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=Math.min(n[0],a[0]),i[1]=Math.min(n[1],a[1]),i[2]=Math.min(n[2],a[2]),i[3]=Math.min(n[3],a[3]),i}},{}],211:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=n[0]*a[0],i[1]=n[1]*a[1],i[2]=n[2]*a[2],i[3]=n[3]*a[3],i}},{}],212:[function(u,A,T){A.exports=e;function e(i,n){return i[0]=-n[0],i[1]=-n[1],i[2]=-n[2],i[3]=-n[3],i}},{}],213:[function(u,A,T){A.exports=e;function e(i,n){var a=n[0],r=n[1],f=n[2],o=n[3],s=a*a+r*r+f*f+o*o;return s>0&&(s=1/Math.sqrt(s),i[0]=a*s,i[1]=r*s,i[2]=f*s,i[3]=o*s),i}},{}],214:[function(u,A,T){var e=u("./normalize"),i=u("./scale");A.exports=n;function n(a,r){return r=r||1,a[0]=Math.random(),a[1]=Math.random(),a[2]=Math.random(),a[3]=Math.random(),e(a,a),i(a,a,r),a}},{"./normalize":213,"./scale":215}],215:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=n[0]*a,i[1]=n[1]*a,i[2]=n[2]*a,i[3]=n[3]*a,i}},{}],216:[function(u,A,T){A.exports=e;function e(i,n,a,r){return i[0]=n[0]+a[0]*r,i[1]=n[1]+a[1]*r,i[2]=n[2]+a[2]*r,i[3]=n[3]+a[3]*r,i}},{}],217:[function(u,A,T){A.exports=e;function e(i,n,a,r,f){return i[0]=n,i[1]=a,i[2]=r,i[3]=f,i}},{}],218:[function(u,A,T){A.exports=e;function e(i,n){var a=n[0]-i[0],r=n[1]-i[1],f=n[2]-i[2],o=n[3]-i[3];return a*a+r*r+f*f+o*o}},{}],219:[function(u,A,T){A.exports=e;function e(i){var n=i[0],a=i[1],r=i[2],f=i[3];return n*n+a*a+r*r+f*f}},{}],220:[function(u,A,T){A.exports=e;function e(i,n,a){return i[0]=n[0]-a[0],i[1]=n[1]-a[1],i[2]=n[2]-a[2],i[3]=n[3]-a[3],i}},{}],221:[function(u,A,T){A.exports=e;function e(i,n,a){var r=n[0],f=n[1],o=n[2],s=n[3];return i[0]=a[0]*r+a[4]*f+a[8]*o+a[12]*s,i[1]=a[1]*r+a[5]*f+a[9]*o+a[13]*s,i[2]=a[2]*r+a[6]*f+a[10]*o+a[14]*s,i[3]=a[3]*r+a[7]*f+a[11]*o+a[15]*s,i}},{}],222:[function(u,A,T){A.exports=e;function e(i,n,a){var r=n[0],f=n[1],o=n[2],s=a[0],m=a[1],g=a[2],p=a[3],v=p*r+m*o-g*f,x=p*f+g*r-s*o,l=p*o+s*f-m*r,b=-s*r-m*f-g*o;return i[0]=v*p+b*-s+x*-g-l*-m,i[1]=x*p+b*-m+l*-s-v*-g,i[2]=l*p+b*-g+v*-m-x*-s,i[3]=n[3],i}},{}],223:[function(u,A,T){var e=u("glsl-tokenizer"),i=u("atob-lite");A.exports=n;function n(a){for(var r=Array.isArray(a)?a:e(a),f=0;f<r.length;f++){var o=r[f];if(o.type==="preprocessor"){var s=o.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(!!s&&!!s[2]){var m=s[1],g=s[2];return(m?i(g):g).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(u,A,T){A.exports=d;var e=u("./lib/literals"),i=u("./lib/operators"),n=u("./lib/builtins"),a=u("./lib/literals-300es"),r=u("./lib/builtins-300es"),f=999,o=9999,s=0,m=1,g=2,p=3,v=4,x=5,l=6,b=7,c=8,M=9,_=10,y=11,w=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function d(C){var S=0,E=0,k=f,B,z,F=[],I=[],O=1,N=0,V=0,H=!1,j=!1,Z="",X;C=C||{};var re=n,ue=e;C.version==="300 es"&&(re=r,ue=a);for(var K={},te={},S=0;S<re.length;S++)K[re[S]]=!0;for(var S=0;S<ue.length;S++)te[ue[S]]=!0;return function(me){return I=[],me!==null?Y(me):ee()};function G(me){me.length&&I.push({type:w[k],data:me,position:V,line:O,column:N})}function Y(me){S=0,me.toString&&(me=me.toString()),Z+=me.replace(/\r\n/g,`
`),X=Z.length;for(var _e;B=Z[S],S<X;){switch(_e=S,k){case s:S=le();break;case m:S=ae();break;case g:S=q();break;case p:S=ie();break;case v:S=oe();break;case y:S=xe();break;case x:S=he();break;case o:S=be();break;case M:S=J();break;case f:S=ne();break}if(_e!==S)switch(Z[_e]){case`
`:N=0,++O;break;default:++N;break}}return E+=S,Z=Z.slice(S),I}function ee(me){return F.length&&G(F.join("")),k=_,G("(eof)"),I}function ne(){return F=F.length?[]:F,z==="/"&&B==="*"?(V=E+S-1,k=s,z=B,S+1):z==="/"&&B==="/"?(V=E+S-1,k=m,z=B,S+1):B==="#"?(k=g,V=E+S,S):/\s/.test(B)?(k=M,V=E+S,S):(H=/\d/.test(B),j=/[^\w_]/.test(B),V=E+S,k=H?v:j?p:o,S)}function J(){return/[^\s]/g.test(B)?(G(F.join("")),k=f,S):(F.push(B),z=B,S+1)}function q(){return(B==="\r"||B===`
`)&&z!=="\\"?(G(F.join("")),k=f,S):(F.push(B),z=B,S+1)}function ae(){return q()}function le(){return B==="/"&&z==="*"?(F.push(B),G(F.join("")),k=f,S+1):(F.push(B),z=B,S+1)}function ie(){if(z==="."&&/\d/.test(B))return k=x,S;if(z==="/"&&B==="*")return k=s,S;if(z==="/"&&B==="/")return k=m,S;if(B==="."&&F.length){for(;se(F););return k=x,S}if(B===";"||B===")"||B==="("){if(F.length)for(;se(F););return G(B),k=f,S+1}var me=F.length===2&&B!=="=";if(/[\w_\d\s]/.test(B)||me){for(;se(F););return k=f,S}return F.push(B),z=B,S+1}function se(me){var _e=0,Se,De;do{if(Se=i.indexOf(me.slice(0,me.length+_e).join("")),De=i[Se],Se===-1){if(_e--+me.length>0)continue;De=me.slice(0,1).join("")}return G(De),V+=De.length,F=F.slice(De.length),F.length}while(1)}function xe(){return/[^a-fA-F0-9]/.test(B)?(G(F.join("")),k=f,S):(F.push(B),z=B,S+1)}function oe(){return B==="."||/[eE]/.test(B)?(F.push(B),k=x,z=B,S+1):B==="x"&&F.length===1&&F[0]==="0"?(k=y,F.push(B),z=B,S+1):/[^\d]/.test(B)?(G(F.join("")),k=f,S):(F.push(B),z=B,S+1)}function he(){return B==="f"&&(F.push(B),z=B,S+=1),/[eE]/.test(B)||(B==="-"||B==="+")&&/[eE]/.test(z)?(F.push(B),z=B,S+1):/[^\d]/.test(B)?(G(F.join("")),k=f,S):(F.push(B),z=B,S+1)}function be(){if(/[^\d\w_]/.test(B)){var me=F.join("");return te[me]?k=c:K[me]?k=b:k=l,G(F.join("")),k=f,S}return F.push(B),z=B,S+1}}},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(u,A,T){var e=u("./builtins");e=e.slice().filter(function(i){return!/^(gl\_|texture)/.test(i)}),A.exports=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(u,A,T){A.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(u,A,T){var e=u("./literals");A.exports=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(u,A,T){A.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(u,A,T){A.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(u,A,T){var e=u("./index");A.exports=i;function i(n,a){var r=e(a),f=[];return f=f.concat(r(n)),f=f.concat(r(null)),f}},{"./index":224}],231:[function(u,A,T){A.exports=function(e){typeof e=="string"&&(e=[e]);for(var i=[].slice.call(arguments,1),n=[],a=0;a<e.length-1;a++)n.push(e[a],i[a]||"");return n.push(e[a]),n.join("")}},{}],232:[function(u,A,T){var e=u("is-browser");function i(){var n=!1;try{var a=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("test",null,a),window.removeEventListener("test",null,a)}catch{n=!1}return n}A.exports=e&&i()},{"is-browser":236}],233:[function(u,A,T){A.exports=p;var e=u("robust-orientation"),i=u("simplicial-complex").compareCells;function n(v,x,l){this.vertices=v,this.adjacent=x,this.boundary=l,this.lastVisited=-1}n.prototype.flip=function(){var v=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=v;var x=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=x};function a(v,x,l){this.vertices=v,this.cell=x,this.index=l}function r(v,x){return i(v.vertices,x.vertices)}function f(v){return function(){var x=this.tuple;return v.apply(this,x)}}function o(v){var x=e[v+1];return x||(x=e),f(x)}var s=[];function m(v,x,l){this.dimension=v,this.vertices=x,this.simplices=l,this.interior=l.filter(function(M){return!M.boundary}),this.tuple=new Array(v+1);for(var b=0;b<=v;++b)this.tuple[b]=this.vertices[b];var c=s[v];c||(c=s[v]=o(v)),this.orient=c}var g=m.prototype;g.handleBoundaryDegeneracy=function(v,x){var l=this.dimension,b=this.vertices.length-1,c=this.tuple,M=this.vertices,_=[v];for(v.lastVisited=-b;_.length>0;){v=_.pop();for(var y=v.adjacent,w=0;w<=l;++w){var d=y[w];if(!(!d.boundary||d.lastVisited<=-b)){for(var C=d.vertices,S=0;S<=l;++S){var E=C[S];E<0?c[S]=x:c[S]=M[E]}var k=this.orient();if(k>0)return d;d.lastVisited=-b,k===0&&_.push(d)}}}return null},g.walk=function(v,x){var l=this.vertices.length-1,b=this.dimension,c=this.vertices,M=this.tuple,_=x?this.interior.length*Math.random()|0:this.interior.length-1,y=this.interior[_];e:for(;!y.boundary;){for(var w=y.vertices,d=y.adjacent,C=0;C<=b;++C)M[C]=c[w[C]];y.lastVisited=l;for(var C=0;C<=b;++C){var S=d[C];if(!(S.lastVisited>=l)){var E=M[C];M[C]=v;var k=this.orient();if(M[C]=E,k<0){y=S;continue e}else S.boundary?S.lastVisited=-l:S.lastVisited=l}}return}return y},g.addPeaks=function(v,x){var l=this.vertices.length-1,b=this.dimension,c=this.vertices,M=this.tuple,_=this.interior,y=this.simplices,w=[x];x.lastVisited=l,x.vertices[x.vertices.indexOf(-1)]=l,x.boundary=!1,_.push(x);for(var d=[];w.length>0;){var x=w.pop(),C=x.vertices,S=x.adjacent,E=C.indexOf(l);if(!(E<0)){for(var k=0;k<=b;++k)if(k!==E){var B=S[k];if(!(!B.boundary||B.lastVisited>=l)){var z=B.vertices;if(B.lastVisited!==-l){for(var F=0,I=0;I<=b;++I)z[I]<0?(F=I,M[I]=v):M[I]=c[z[I]];var O=this.orient();if(O>0){z[F]=l,B.boundary=!1,_.push(B),w.push(B),B.lastVisited=l;continue}else B.lastVisited=-l}var N=B.adjacent,V=C.slice(),H=S.slice(),j=new n(V,H,!0);y.push(j);var Z=N.indexOf(x);if(!(Z<0)){N[Z]=j,H[E]=B,V[k]=-1,H[k]=x,S[k]=j,j.flip();for(var I=0;I<=b;++I){var X=V[I];if(!(X<0||X===l)){for(var re=new Array(b-1),ue=0,K=0;K<=b;++K){var te=V[K];te<0||K===I||(re[ue++]=te)}d.push(new a(re,j,I))}}}}}}}d.sort(r);for(var k=0;k+1<d.length;k+=2){var G=d[k],Y=d[k+1],ee=G.index,ne=Y.index;ee<0||ne<0||(G.cell.adjacent[G.index]=Y.cell,Y.cell.adjacent[Y.index]=G.cell)}},g.insert=function(v,x){var l=this.vertices;l.push(v);var b=this.walk(v,x);if(!!b){for(var c=this.dimension,M=this.tuple,_=0;_<=c;++_){var y=b.vertices[_];y<0?M[_]=v:M[_]=l[y]}var w=this.orient(M);w<0||w===0&&(b=this.handleBoundaryDegeneracy(b,v),!b)||this.addPeaks(v,b)}},g.boundary=function(){for(var v=this.dimension,x=[],l=this.simplices,b=l.length,c=0;c<b;++c){var M=l[c];if(M.boundary){for(var _=new Array(v),y=M.vertices,w=0,d=0,C=0;C<=v;++C)y[C]>=0?_[w++]=y[C]:d=C&1;if(d===(v&1)){var S=_[0];_[0]=_[1],_[1]=S}x.push(_)}}return x};function p(v,x){var l=v.length;if(l===0)throw new Error("Must have at least d+1 points");var b=v[0].length;if(l<=b)throw new Error("Must input at least d+1 points");var c=v.slice(0,b+1),M=e.apply(void 0,c);if(M===0)throw new Error("Input not in general position");for(var _=new Array(b+1),y=0;y<=b;++y)_[y]=y;M<0&&(_[0]=1,_[1]=0);for(var w=new n(_,new Array(b+1),!1),d=w.adjacent,C=new Array(b+2),y=0;y<=b;++y){for(var S=_.slice(),E=0;E<=b;++E)E===y&&(S[E]=-1);var k=S[0];S[0]=S[1],S[1]=k;var B=new n(S,new Array(b+1),!0);d[y]=B,C[y]=B}C[b+1]=w;for(var y=0;y<=b;++y)for(var S=d[y].vertices,z=d[y].adjacent,E=0;E<=b;++E){var F=S[E];if(F<0){z[E]=w;continue}for(var I=0;I<=b;++I)d[I].vertices.indexOf(F)<0&&(z[E]=d[I])}for(var O=new m(b,c,C),N=!!x,y=b+1;y<l;++y)O.insert(v[y],N);return O.boundary()}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(u,A,T){var e=u("binary-search-bounds"),i=0,n=1,a=2;A.exports=w;function r(d,C,S,E,k){this.mid=d,this.left=C,this.right=S,this.leftPoints=E,this.rightPoints=k,this.count=(C?C.count:0)+(S?S.count:0)+E.length}var f=r.prototype;function o(d,C){d.mid=C.mid,d.left=C.left,d.right=C.right,d.leftPoints=C.leftPoints,d.rightPoints=C.rightPoints,d.count=C.count}function s(d,C){var S=M(C);d.mid=S.mid,d.left=S.left,d.right=S.right,d.leftPoints=S.leftPoints,d.rightPoints=S.rightPoints,d.count=S.count}function m(d,C){var S=d.intervals([]);S.push(C),s(d,S)}function g(d,C){var S=d.intervals([]),E=S.indexOf(C);return E<0?i:(S.splice(E,1),s(d,S),n)}f.intervals=function(d){return d.push.apply(d,this.leftPoints),this.left&&this.left.intervals(d),this.right&&this.right.intervals(d),d},f.insert=function(d){var C=this.count-this.leftPoints.length;if(this.count+=1,d[1]<this.mid)this.left?4*(this.left.count+1)>3*(C+1)?m(this,d):this.left.insert(d):this.left=M([d]);else if(d[0]>this.mid)this.right?4*(this.right.count+1)>3*(C+1)?m(this,d):this.right.insert(d):this.right=M([d]);else{var S=e.ge(this.leftPoints,d,b),E=e.ge(this.rightPoints,d,c);this.leftPoints.splice(S,0,d),this.rightPoints.splice(E,0,d)}},f.remove=function(d){var C=this.count-this.leftPoints;if(d[1]<this.mid){if(!this.left)return i;var S=this.right?this.right.count:0;if(4*S>3*(C-1))return g(this,d);var E=this.left.remove(d);return E===a?(this.left=null,this.count-=1,n):(E===n&&(this.count-=1),E)}else if(d[0]>this.mid){if(!this.right)return i;var k=this.left?this.left.count:0;if(4*k>3*(C-1))return g(this,d);var E=this.right.remove(d);return E===a?(this.right=null,this.count-=1,n):(E===n&&(this.count-=1),E)}else{if(this.count===1)return this.leftPoints[0]===d?a:i;if(this.leftPoints.length===1&&this.leftPoints[0]===d){if(this.left&&this.right){for(var B=this,z=this.left;z.right;)B=z,z=z.right;if(B===this)z.right=this.right;else{var F=this.left,E=this.right;B.count-=z.count,B.right=z.left,z.left=F,z.right=E}o(this,z),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?o(this,this.left):o(this,this.right);return n}for(var F=e.ge(this.leftPoints,d,b);F<this.leftPoints.length&&this.leftPoints[F][0]===d[0];++F)if(this.leftPoints[F]===d){this.count-=1,this.leftPoints.splice(F,1);for(var E=e.ge(this.rightPoints,d,c);E<this.rightPoints.length&&this.rightPoints[E][1]===d[1];++E)if(this.rightPoints[E]===d)return this.rightPoints.splice(E,1),n}return i}};function p(d,C,S){for(var E=0;E<d.length&&d[E][0]<=C;++E){var k=S(d[E]);if(k)return k}}function v(d,C,S){for(var E=d.length-1;E>=0&&d[E][1]>=C;--E){var k=S(d[E]);if(k)return k}}function x(d,C){for(var S=0;S<d.length;++S){var E=C(d[S]);if(E)return E}}f.queryPoint=function(d,C){if(d<this.mid){if(this.left){var S=this.left.queryPoint(d,C);if(S)return S}return p(this.leftPoints,d,C)}else if(d>this.mid){if(this.right){var S=this.right.queryPoint(d,C);if(S)return S}return v(this.rightPoints,d,C)}else return x(this.leftPoints,C)},f.queryInterval=function(d,C,S){if(d<this.mid&&this.left){var E=this.left.queryInterval(d,C,S);if(E)return E}if(C>this.mid&&this.right){var E=this.right.queryInterval(d,C,S);if(E)return E}return C<this.mid?p(this.leftPoints,C,S):d>this.mid?v(this.rightPoints,d,S):x(this.leftPoints,S)};function l(d,C){return d-C}function b(d,C){var S=d[0]-C[0];return S||d[1]-C[1]}function c(d,C){var S=d[1]-C[1];return S||d[0]-C[0]}function M(d){if(d.length===0)return null;for(var C=[],S=0;S<d.length;++S)C.push(d[S][0],d[S][1]);C.sort(l);for(var E=C[C.length>>1],k=[],B=[],z=[],S=0;S<d.length;++S){var F=d[S];F[1]<E?k.push(F):E<F[0]?B.push(F):z.push(F)}var I=z,O=z.slice();return I.sort(b),O.sort(c),new r(E,M(k),M(B),I,O)}function _(d){this.root=d}var y=_.prototype;y.insert=function(d){this.root?this.root.insert(d):this.root=new r(d[0],null,null,[d],[d])},y.remove=function(d){if(this.root){var C=this.root.remove(d);return C===a&&(this.root=null),C!==i}return!1},y.queryPoint=function(d,C){if(this.root)return this.root.queryPoint(d,C)},y.queryInterval=function(d,C,S){if(d<=C&&this.root)return this.root.queryInterval(d,C,S)},Object.defineProperty(y,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(y,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});function w(d){return!d||d.length===0?new _(null):new _(M(d))}},{"binary-search-bounds":31}],235:[function(u,A,T){function e(i){for(var n=new Array(i),a=0;a<i;++a)n[a]=a;return n}A.exports=e},{}],236:[function(u,A,T){A.exports=!0},{}],237:[function(u,A,T){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */A.exports=function(n){return n!=null&&(e(n)||i(n)||!!n._isBuffer)};function e(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function i(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&e(n.slice(0,0))}},{}],238:[function(u,A,T){A.exports=n,A.exports.isMobile=n,A.exports.default=n;var e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,i=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function n(a){a||(a={});var r=a.ua;if(!r&&typeof navigator<"u"&&(r=navigator.userAgent),r&&r.headers&&typeof r.headers["user-agent"]=="string"&&(r=r.headers["user-agent"]),typeof r!="string")return!1;var f=a.tablet?i.test(r):e.test(r);return!f&&a.tablet&&a.featureDetect&&navigator&&navigator.maxTouchPoints>1&&r.indexOf("Macintosh")!==-1&&r.indexOf("Safari")!==-1&&(f=!0),f}},{}],239:[function(u,A,T){A.exports=function(e){for(var i=e.length,n,a=0;a<i;a++)if(n=e.charCodeAt(a),(n<9||n>13)&&n!==32&&n!==133&&n!==160&&n!==5760&&n!==6158&&(n<8192||n>8205)&&n!==8232&&n!==8233&&n!==8239&&n!==8287&&n!==8288&&n!==12288&&n!==65279)return!1;return!0}},{}],240:[function(u,A,T){function e(i,n,a){return i*(1-a)+n*a}A.exports=e},{}],241:[function(u,A,T){var e=u("./normalize"),i=u("gl-mat4/create"),n=u("gl-mat4/clone"),a=u("gl-mat4/determinant"),r=u("gl-mat4/invert"),f=u("gl-mat4/transpose"),o={length:u("gl-vec3/length"),normalize:u("gl-vec3/normalize"),dot:u("gl-vec3/dot"),cross:u("gl-vec3/cross")},s=i(),m=i(),g=[0,0,0,0],p=[[0,0,0],[0,0,0],[0,0,0]],v=[0,0,0];A.exports=function(M,_,y,w,d,C){if(_||(_=[0,0,0]),y||(y=[0,0,0]),w||(w=[0,0,0]),d||(d=[0,0,0,1]),C||(C=[0,0,0,1]),!e(s,M)||(n(m,s),m[3]=0,m[7]=0,m[11]=0,m[15]=1,Math.abs(a(m)<1e-8)))return!1;var S=s[3],E=s[7],k=s[11],B=s[12],z=s[13],F=s[14],I=s[15];if(S!==0||E!==0||k!==0){g[0]=S,g[1]=E,g[2]=k,g[3]=I;var O=r(m,m);if(!O)return!1;f(m,m),x(d,g,m)}else d[0]=d[1]=d[2]=0,d[3]=1;if(_[0]=B,_[1]=z,_[2]=F,l(p,s),y[0]=o.length(p[0]),o.normalize(p[0],p[0]),w[0]=o.dot(p[0],p[1]),b(p[1],p[1],p[0],1,-w[0]),y[1]=o.length(p[1]),o.normalize(p[1],p[1]),w[0]/=y[1],w[1]=o.dot(p[0],p[2]),b(p[2],p[2],p[0],1,-w[1]),w[2]=o.dot(p[1],p[2]),b(p[2],p[2],p[1],1,-w[2]),y[2]=o.length(p[2]),o.normalize(p[2],p[2]),w[1]/=y[2],w[2]/=y[2],o.cross(v,p[1],p[2]),o.dot(p[0],v)<0)for(var N=0;N<3;N++)y[N]*=-1,p[N][0]*=-1,p[N][1]*=-1,p[N][2]*=-1;return C[0]=.5*Math.sqrt(Math.max(1+p[0][0]-p[1][1]-p[2][2],0)),C[1]=.5*Math.sqrt(Math.max(1-p[0][0]+p[1][1]-p[2][2],0)),C[2]=.5*Math.sqrt(Math.max(1-p[0][0]-p[1][1]+p[2][2],0)),C[3]=.5*Math.sqrt(Math.max(1+p[0][0]+p[1][1]+p[2][2],0)),p[2][1]>p[1][2]&&(C[0]=-C[0]),p[0][2]>p[2][0]&&(C[1]=-C[1]),p[1][0]>p[0][1]&&(C[2]=-C[2]),!0};function x(c,M,_){var y=M[0],w=M[1],d=M[2],C=M[3];return c[0]=_[0]*y+_[4]*w+_[8]*d+_[12]*C,c[1]=_[1]*y+_[5]*w+_[9]*d+_[13]*C,c[2]=_[2]*y+_[6]*w+_[10]*d+_[14]*C,c[3]=_[3]*y+_[7]*w+_[11]*d+_[15]*C,c}function l(c,M){c[0][0]=M[0],c[0][1]=M[1],c[0][2]=M[2],c[1][0]=M[4],c[1][1]=M[5],c[1][2]=M[6],c[2][0]=M[8],c[2][1]=M[9],c[2][2]=M[10]}function b(c,M,_,y,w){c[0]=M[0]*y+_[0]*w,c[1]=M[1]*y+_[1]*w,c[2]=M[2]*y+_[2]*w}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(u,A,T){A.exports=function(i,n){var a=n[15];if(a===0)return!1;for(var r=1/a,f=0;f<16;f++)i[f]=n[f]*r;return!0}},{}],243:[function(u,A,T){var e=u("gl-vec3/lerp"),i=u("mat4-recompose"),n=u("mat4-decompose"),a=u("gl-mat4/determinant"),r=u("quat-slerp"),f=g(),o=g(),s=g();A.exports=m;function m(x,l,b,c){if(a(l)===0||a(b)===0)return!1;var M=n(l,f.translate,f.scale,f.skew,f.perspective,f.quaternion),_=n(b,o.translate,o.scale,o.skew,o.perspective,o.quaternion);return!M||!_?!1:(e(s.translate,f.translate,o.translate,c),e(s.skew,f.skew,o.skew,c),e(s.scale,f.scale,o.scale,c),e(s.perspective,f.perspective,o.perspective,c),r(s.quaternion,f.quaternion,o.quaternion,c),i(x,s.translate,s.scale,s.skew,s.perspective,s.quaternion),!0)}function g(){return{translate:p(),scale:p(1),skew:p(),perspective:v(),quaternion:v()}}function p(x){return[x||0,x||0,x||0]}function v(){return[0,0,0,1]}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(u,A,T){var e={identity:u("gl-mat4/identity"),translate:u("gl-mat4/translate"),multiply:u("gl-mat4/multiply"),create:u("gl-mat4/create"),scale:u("gl-mat4/scale"),fromRotationTranslation:u("gl-mat4/fromRotationTranslation")};e.create();var i=e.create();A.exports=function(a,r,f,o,s,m){return e.identity(a),e.fromRotationTranslation(a,m,r),a[3]=s[0],a[7]=s[1],a[11]=s[2],a[15]=s[3],e.identity(i),o[2]!==0&&(i[9]=o[2],e.multiply(a,a,i)),o[1]!==0&&(i[9]=0,i[8]=o[1],e.multiply(a,a,i)),o[0]!==0&&(i[8]=0,i[4]=o[0],e.multiply(a,a,i)),e.scale(a,a,f),a}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(u,A,T){var e=u("binary-search-bounds"),i=u("mat4-interpolate"),n=u("gl-mat4/invert"),a=u("gl-mat4/rotateX"),r=u("gl-mat4/rotateY"),f=u("gl-mat4/rotateZ"),o=u("gl-mat4/lookAt"),s=u("gl-mat4/translate");u("gl-mat4/scale");var m=u("gl-vec3/normalize"),g=[0,0,0];A.exports=l;function p(b){this._components=b.slice(),this._time=[0],this.prevMatrix=b.slice(),this.nextMatrix=b.slice(),this.computedMatrix=b.slice(),this.computedInverse=b.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}var v=p.prototype;v.recalcMatrix=function(b){var c=this._time,M=e.le(c,b),_=this.computedMatrix;if(!(M<0)){var y=this._components;if(M===c.length-1)for(var w=16*M,d=0;d<16;++d)_[d]=y[w++];else{for(var C=c[M+1]-c[M],w=16*M,S=this.prevMatrix,E=!0,d=0;d<16;++d)S[d]=y[w++];for(var k=this.nextMatrix,d=0;d<16;++d)k[d]=y[w++],E=E&&S[d]===k[d];if(C<1e-6||E)for(var d=0;d<16;++d)_[d]=S[d];else i(_,S,k,(b-c[M])/C)}var B=this.computedUp;B[0]=_[1],B[1]=_[5],B[2]=_[9],m(B,B);var z=this.computedInverse;n(z,_);var F=this.computedEye,I=z[15];F[0]=z[12]/I,F[1]=z[13]/I,F[2]=z[14]/I;for(var O=this.computedCenter,N=Math.exp(this.computedRadius[0]),d=0;d<3;++d)O[d]=F[d]-_[2+4*d]*N}},v.idle=function(b){if(!(b<this.lastT())){for(var c=this._components,M=c.length-16,_=0;_<16;++_)c.push(c[M++]);this._time.push(b)}},v.flush=function(b){var c=e.gt(this._time,b)-2;c<0||(this._time.splice(0,c),this._components.splice(0,16*c))},v.lastT=function(){return this._time[this._time.length-1]},v.lookAt=function(b,c,M,_){this.recalcMatrix(b),c=c||this.computedEye,M=M||g,_=_||this.computedUp,this.setMatrix(b,o(this.computedMatrix,c,M,_));for(var y=0,w=0;w<3;++w)y+=Math.pow(M[w]-c[w],2);y=Math.log(Math.sqrt(y)),this.computedRadius[0]=y},v.rotate=function(b,c,M,_){this.recalcMatrix(b);var y=this.computedInverse;c&&r(y,y,c),M&&a(y,y,M),_&&f(y,y,_),this.setMatrix(b,n(this.computedMatrix,y))};var x=[0,0,0];v.pan=function(b,c,M,_){x[0]=-(c||0),x[1]=-(M||0),x[2]=-(_||0),this.recalcMatrix(b);var y=this.computedInverse;s(y,y,x),this.setMatrix(b,n(y,y))},v.translate=function(b,c,M,_){x[0]=c||0,x[1]=M||0,x[2]=_||0,this.recalcMatrix(b);var y=this.computedMatrix;s(y,y,x),this.setMatrix(b,y)},v.setMatrix=function(b,c){if(!(b<this.lastT())){this._time.push(b);for(var M=0;M<16;++M)this._components.push(c[M])}},v.setDistance=function(b,c){this.computedRadius[0]=c},v.setDistanceLimits=function(b,c){var M=this._limits;M[0]=b,M[1]=c},v.getDistanceLimits=function(b){var c=this._limits;return b?(b[0]=c[0],b[1]=c[1],b):c};function l(b){b=b||{};var c=b.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new p(c)}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(u,A,T){A.exports=i;var e=u("robust-orientation")[3];function i(n){var a=n.length;if(a<3){for(var v=new Array(a),r=0;r<a;++r)v[r]=r;return a===2&&n[0][0]===n[1][0]&&n[0][1]===n[1][1]?[0]:v}for(var f=new Array(a),r=0;r<a;++r)f[r]=r;f.sort(function(c,M){var _=n[c][0]-n[M][0];return _||n[c][1]-n[M][1]});for(var o=[f[0],f[1]],s=[f[0],f[1]],r=2;r<a;++r){for(var m=f[r],g=n[m],p=o.length;p>1&&e(n[o[p-2]],n[o[p-1]],g)<=0;)p-=1,o.pop();for(o.push(m),p=s.length;p>1&&e(n[s[p-2]],n[s[p-1]],g)>=0;)p-=1,s.pop();s.push(m)}for(var v=new Array(s.length+o.length-2),x=0,r=0,l=o.length;r<l;++r)v[x++]=o[r];for(var b=s.length-2;b>0;--b)v[x++]=s[b];return v}},{"robust-orientation":284}],247:[function(u,A,T){A.exports=i;var e=u("mouse-event");function i(n,a){a||(a=n,n=window);var r=0,f=0,o=0,s={shift:!1,alt:!1,control:!1,meta:!1},m=!1;function g(d){var C=!1;return"altKey"in d&&(C=C||d.altKey!==s.alt,s.alt=!!d.altKey),"shiftKey"in d&&(C=C||d.shiftKey!==s.shift,s.shift=!!d.shiftKey),"ctrlKey"in d&&(C=C||d.ctrlKey!==s.control,s.control=!!d.ctrlKey),"metaKey"in d&&(C=C||d.metaKey!==s.meta,s.meta=!!d.metaKey),C}function p(d,C){var S=e.x(C),E=e.y(C);"buttons"in C&&(d=C.buttons|0),(d!==r||S!==f||E!==o||g(C))&&(r=d|0,f=S||0,o=E||0,a&&a(r,f,o,s))}function v(d){p(0,d)}function x(){(r||f||o||s.shift||s.alt||s.meta||s.control)&&(f=o=0,r=0,s.shift=s.alt=s.control=s.meta=!1,a&&a(0,0,0,s))}function l(d){g(d)&&a&&a(r,f,o,s)}function b(d){e.buttons(d)===0?p(0,d):p(r,d)}function c(d){p(r|e.buttons(d),d)}function M(d){p(r&~e.buttons(d),d)}function _(){m||(m=!0,n.addEventListener("mousemove",b),n.addEventListener("mousedown",c),n.addEventListener("mouseup",M),n.addEventListener("mouseleave",v),n.addEventListener("mouseenter",v),n.addEventListener("mouseout",v),n.addEventListener("mouseover",v),n.addEventListener("blur",x),n.addEventListener("keyup",l),n.addEventListener("keydown",l),n.addEventListener("keypress",l),n!==window&&(window.addEventListener("blur",x),window.addEventListener("keyup",l),window.addEventListener("keydown",l),window.addEventListener("keypress",l)))}function y(){!m||(m=!1,n.removeEventListener("mousemove",b),n.removeEventListener("mousedown",c),n.removeEventListener("mouseup",M),n.removeEventListener("mouseleave",v),n.removeEventListener("mouseenter",v),n.removeEventListener("mouseout",v),n.removeEventListener("mouseover",v),n.removeEventListener("blur",x),n.removeEventListener("keyup",l),n.removeEventListener("keydown",l),n.removeEventListener("keypress",l),n!==window&&(window.removeEventListener("blur",x),window.removeEventListener("keyup",l),window.removeEventListener("keydown",l),window.removeEventListener("keypress",l)))}_();var w={element:n};return Object.defineProperties(w,{enabled:{get:function(){return m},set:function(d){d?_():y()},enumerable:!0},buttons:{get:function(){return r},enumerable:!0},x:{get:function(){return f},enumerable:!0},y:{get:function(){return o},enumerable:!0},mods:{get:function(){return s},enumerable:!0}}),w}},{"mouse-event":249}],248:[function(u,A,T){var e={left:0,top:0};A.exports=i;function i(a,r,f){r=r||a.currentTarget||a.srcElement,Array.isArray(f)||(f=[0,0]);var o=a.clientX||0,s=a.clientY||0,m=n(r);return f[0]=o-m.left,f[1]=s-m.top,f}function n(a){return a===window||a===document||a===document.body?e:a.getBoundingClientRect()}},{}],249:[function(u,A,T){function e(r){if(typeof r=="object"){if("buttons"in r)return r.buttons;if("which"in r){var f=r.which;if(f===2)return 4;if(f===3)return 2;if(f>0)return 1<<f-1}else if("button"in r){var f=r.button;if(f===1)return 4;if(f===2)return 2;if(f>=0)return 1<<f}}return 0}T.buttons=e;function i(r){return r.target||r.srcElement||window}T.element=i;function n(r){if(typeof r=="object"){if("offsetX"in r)return r.offsetX;var f=i(r),o=f.getBoundingClientRect();return r.clientX-o.left}return 0}T.x=n;function a(r){if(typeof r=="object"){if("offsetY"in r)return r.offsetY;var f=i(r),o=f.getBoundingClientRect();return r.clientY-o.top}return 0}T.y=a},{}],250:[function(u,A,T){var e=u("to-px");A.exports=i;function i(n,a,r){typeof n=="function"&&(r=!!a,a=n,n=window);var f=e("ex",n),o=function(s){r&&s.preventDefault();var m=s.deltaX||0,g=s.deltaY||0,p=s.deltaZ||0,v=s.deltaMode,x=1;switch(v){case 1:x=f;break;case 2:x=window.innerHeight;break}if(m*=x,g*=x,p*=x,m||g||p)return a(m,g,p,s)};return n.addEventListener("wheel",o),o}},{"to-px":304}],251:[function(u,A,T){var e=u("typedarray-pool");A.exports=a;var i={"false,0,1":function(f,o,s,m,g){return function(v,x,l,b){var c=v.shape[0]|0,M=v.shape[1]|0,_=v.data,y=v.offset|0,w=v.stride[0]|0,d=v.stride[1]|0,C=y,S,E=-w|0,k=0,B=-d|0,z=0,F=-w-d|0,I=0,O=w|0,N=d-w*c|0,V=0,H=0,j=0,Z=2*c|0,X=m(Z),re=m(Z),ue=0,K=0,te=-1,G=-1,Y=0,ee=-c|0,ne=c|0,J=0,q=-c-1|0,ae=c-1|0,le=0,ie=0,se=0;for(V=0;V<c;++V)X[ue++]=s(_[C],x,l,b),C+=O;if(C+=N,M>0){if(H=1,X[ue++]=s(_[C],x,l,b),C+=O,c>0)for(V=1,S=_[C],K=X[ue]=s(S,x,l,b),Y=X[ue+te],J=X[ue+ee],le=X[ue+q],(K!==Y||K!==J||K!==le)&&(k=_[C+E],z=_[C+B],I=_[C+F],f(V,H,S,k,z,I,K,Y,J,le,x,l,b),ie=re[ue]=j++),ue+=1,C+=O,V=2;V<c;++V)S=_[C],K=X[ue]=s(S,x,l,b),Y=X[ue+te],J=X[ue+ee],le=X[ue+q],(K!==Y||K!==J||K!==le)&&(k=_[C+E],z=_[C+B],I=_[C+F],f(V,H,S,k,z,I,K,Y,J,le,x,l,b),ie=re[ue]=j++,le!==Y&&o(re[ue+te],ie,I,k,le,Y,x,l,b)),ue+=1,C+=O;for(C+=N,ue=0,se=te,te=G,G=se,se=ee,ee=ne,ne=se,se=q,q=ae,ae=se,H=2;H<M;++H){if(X[ue++]=s(_[C],x,l,b),C+=O,c>0)for(V=1,S=_[C],K=X[ue]=s(S,x,l,b),Y=X[ue+te],J=X[ue+ee],le=X[ue+q],(K!==Y||K!==J||K!==le)&&(k=_[C+E],z=_[C+B],I=_[C+F],f(V,H,S,k,z,I,K,Y,J,le,x,l,b),ie=re[ue]=j++,le!==J&&o(re[ue+ee],ie,z,I,J,le,x,l,b)),ue+=1,C+=O,V=2;V<c;++V)S=_[C],K=X[ue]=s(S,x,l,b),Y=X[ue+te],J=X[ue+ee],le=X[ue+q],(K!==Y||K!==J||K!==le)&&(k=_[C+E],z=_[C+B],I=_[C+F],f(V,H,S,k,z,I,K,Y,J,le,x,l,b),ie=re[ue]=j++,le!==J&&o(re[ue+ee],ie,z,I,J,le,x,l,b),le!==Y&&o(re[ue+te],ie,I,k,le,Y,x,l,b)),ue+=1,C+=O;H&1&&(ue=0),se=te,te=G,G=se,se=ee,ee=ne,ne=se,se=q,q=ae,ae=se,C+=N}}g(re),g(X)}},"false,1,0":function(f,o,s,m,g){return function(v,x,l,b){var c=v.shape[0]|0,M=v.shape[1]|0,_=v.data,y=v.offset|0,w=v.stride[0]|0,d=v.stride[1]|0,C=y,S,E=-w|0,k=0,B=-d|0,z=0,F=-w-d|0,I=0,O=d|0,N=w-d*M|0,V=0,H=0,j=0,Z=2*M|0,X=m(Z),re=m(Z),ue=0,K=0,te=-1,G=-1,Y=0,ee=-M|0,ne=M|0,J=0,q=-M-1|0,ae=M-1|0,le=0,ie=0,se=0;for(H=0;H<M;++H)X[ue++]=s(_[C],x,l,b),C+=O;if(C+=N,c>0){if(V=1,X[ue++]=s(_[C],x,l,b),C+=O,M>0)for(H=1,S=_[C],K=X[ue]=s(S,x,l,b),J=X[ue+ee],Y=X[ue+te],le=X[ue+q],(K!==J||K!==Y||K!==le)&&(k=_[C+E],z=_[C+B],I=_[C+F],f(V,H,S,k,z,I,K,J,Y,le,x,l,b),ie=re[ue]=j++),ue+=1,C+=O,H=2;H<M;++H)S=_[C],K=X[ue]=s(S,x,l,b),J=X[ue+ee],Y=X[ue+te],le=X[ue+q],(K!==J||K!==Y||K!==le)&&(k=_[C+E],z=_[C+B],I=_[C+F],f(V,H,S,k,z,I,K,J,Y,le,x,l,b),ie=re[ue]=j++,le!==Y&&o(re[ue+te],ie,z,I,Y,le,x,l,b)),ue+=1,C+=O;for(C+=N,ue=0,se=ee,ee=ne,ne=se,se=te,te=G,G=se,se=q,q=ae,ae=se,V=2;V<c;++V){if(X[ue++]=s(_[C],x,l,b),C+=O,M>0)for(H=1,S=_[C],K=X[ue]=s(S,x,l,b),J=X[ue+ee],Y=X[ue+te],le=X[ue+q],(K!==J||K!==Y||K!==le)&&(k=_[C+E],z=_[C+B],I=_[C+F],f(V,H,S,k,z,I,K,J,Y,le,x,l,b),ie=re[ue]=j++,le!==J&&o(re[ue+ee],ie,I,k,le,J,x,l,b)),ue+=1,C+=O,H=2;H<M;++H)S=_[C],K=X[ue]=s(S,x,l,b),J=X[ue+ee],Y=X[ue+te],le=X[ue+q],(K!==J||K!==Y||K!==le)&&(k=_[C+E],z=_[C+B],I=_[C+F],f(V,H,S,k,z,I,K,J,Y,le,x,l,b),ie=re[ue]=j++,le!==Y&&o(re[ue+te],ie,z,I,Y,le,x,l,b),le!==J&&o(re[ue+ee],ie,I,k,le,J,x,l,b)),ue+=1,C+=O;V&1&&(ue=0),se=ee,ee=ne,ne=se,se=te,te=G,G=se,se=q,q=ae,ae=se,C+=N}}g(re),g(X)}}};function n(r,f,o,s,m,g){var p=[g,m].join(","),v=i[p];return v(r,f,o,e.mallocUint32,e.freeUint32)}function a(r){function f(x){throw new Error("ndarray-extract-contour: "+x)}typeof r!="object"&&f("Must specify arguments");var o=r.order;Array.isArray(o)||f("Must specify order");var s=r.arrayArguments||1;s<1&&f("Must have at least one array argument");var m=r.scalarArguments||0;m<0&&f("Scalar arg count must be > 0"),typeof r.vertex!="function"&&f("Must specify vertex creation function"),typeof r.cell!="function"&&f("Must specify cell creation function"),typeof r.phase!="function"&&f("Must specify phase function");for(var g=r.getters||[],p=new Array(s),v=0;v<s;++v)g.indexOf(v)>=0?p[v]=!0:p[v]=!1;return n(r.vertex,r.cell,r.phase,m,o,p)}},{"typedarray-pool":308}],252:[function(u,A,T){var e=u("dup"),i={zero:function(l,b,c,M){var _=l[0],y=c[0];M|=0;var w=0,d=y;for(w=0;w<_;++w)b[M]=0,M+=d},fdTemplate1:function(l,b,c,M,_,y,w){var d=l[0],C=c[0],S=y[0],E=-1*C,k=C;M|=0,w|=0;var B=0,z=C,F=S;for(B=0;B<d;++B)_[w]=.5*(b[M+E]-b[M+k]),M+=z,w+=F},fdTemplate2:function(l,b,c,M,_,y,w,d,C,S){var E=l[0],k=l[1],B=c[0],z=c[1],F=y[0],I=y[1],O=C[0],N=C[1],V=-1*B,H=B,j=-1*z,Z=z;M|=0,w|=0,S|=0;var X=0,re=0,ue=z,K=B-k*z,te=I,G=F-k*I,Y=N,ee=O-k*N;for(re=0;re<E;++re){for(X=0;X<k;++X)_[w]=.5*(b[M+V]-b[M+H]),d[S]=.5*(b[M+j]-b[M+Z]),M+=ue,w+=te,S+=Y;M+=K,w+=G,S+=ee}}},n={cdiff:function(l){var b={};return function(M,_,y){var w=M.dtype,d=M.order,C=_.dtype,S=_.order,E=y.dtype,k=y.order,B=[w,d.join(),C,S.join(),E,k.join()].join(),z=b[B];return z||(b[B]=z=l([w,d,C,S,E,k])),z(M.shape.slice(0),M.data,M.stride,M.offset|0,_.data,_.stride,_.offset|0,y.data,y.stride,y.offset|0)}},zero:function(l){var b={};return function(M){var _=M.dtype,y=M.order,w=[_,y.join()].join(),d=b[w];return d||(b[w]=d=l([_,y])),d(M.shape.slice(0),M.data,M.stride,M.offset|0)}},fdTemplate1:function(l){var b={};return function(M,_){var y=M.dtype,w=M.order,d=_.dtype,C=_.order,S=[y,w.join(),d,C.join()].join(),E=b[S];return E||(b[S]=E=l([y,w,d,C])),E(M.shape.slice(0),M.data,M.stride,M.offset|0,_.data,_.stride,_.offset|0)}},fdTemplate2:function(l){var b={};return function(M,_,y){var w=M.dtype,d=M.order,C=_.dtype,S=_.order,E=y.dtype,k=y.order,B=[w,d.join(),C,S.join(),E,k.join()].join(),z=b[B];return z||(b[B]=z=l([w,d,C,S,E,k])),z(M.shape.slice(0),M.data,M.stride,M.offset|0,_.data,_.stride,_.offset|0,y.data,y.stride,y.offset|0)}}};function a(l){var b=n[l.funcName];return b(r.bind(void 0,l))}function r(l){return i[l.funcName]}function f(l){return a({funcName:l.funcName})}var o={},s={},m=f({funcName:"cdiff"}),g=f({funcName:"zero"});function p(l){return l in o?o[l]:o[l]=f({funcName:"fdTemplate"+l})}function v(l,b,c,M){return function(_,y){var w=y.shape.slice();return w[0]>2&&w[1]>2&&M(y.pick(-1,-1).lo(1,1).hi(w[0]-2,w[1]-2),_.pick(-1,-1,0).lo(1,1).hi(w[0]-2,w[1]-2),_.pick(-1,-1,1).lo(1,1).hi(w[0]-2,w[1]-2)),w[1]>2&&(c(y.pick(0,-1).lo(1).hi(w[1]-2),_.pick(0,-1,1).lo(1).hi(w[1]-2)),b(_.pick(0,-1,0).lo(1).hi(w[1]-2))),w[1]>2&&(c(y.pick(w[0]-1,-1).lo(1).hi(w[1]-2),_.pick(w[0]-1,-1,1).lo(1).hi(w[1]-2)),b(_.pick(w[0]-1,-1,0).lo(1).hi(w[1]-2))),w[0]>2&&(c(y.pick(-1,0).lo(1).hi(w[0]-2),_.pick(-1,0,0).lo(1).hi(w[0]-2)),b(_.pick(-1,0,1).lo(1).hi(w[0]-2))),w[0]>2&&(c(y.pick(-1,w[1]-1).lo(1).hi(w[0]-2),_.pick(-1,w[1]-1,0).lo(1).hi(w[0]-2)),b(_.pick(-1,w[1]-1,1).lo(1).hi(w[0]-2))),_.set(0,0,0,0),_.set(0,0,1,0),_.set(w[0]-1,0,0,0),_.set(w[0]-1,0,1,0),_.set(0,w[1]-1,0,0),_.set(0,w[1]-1,1,0),_.set(w[0]-1,w[1]-1,0,0),_.set(w[0]-1,w[1]-1,1,0),_}}function x(l){var b=l.join(),w=s[b];if(w)return w;for(var c=l.length,M=[m,g],_=1;_<=c;++_)M.push(p(_));var y=v,w=y.apply(void 0,M);return s[b]=w,w}A.exports=function(b,c,M){if(Array.isArray(M)||(typeof M=="string"?M=e(c.dimension,M):M=e(c.dimension,"clamp")),c.size===0)return b;if(c.dimension===0)return b.set(0),b;var _=x(M);return _(b,c)}},{dup:65}],253:[function(u,A,T){function e(f,o){var s=Math.floor(o),m=o-s,g=0<=s&&s<f.shape[0],p=0<=s+1&&s+1<f.shape[0],v=g?+f.get(s):0,x=p?+f.get(s+1):0;return(1-m)*v+m*x}function i(f,o,s){var m=Math.floor(o),g=o-m,p=0<=m&&m<f.shape[0],v=0<=m+1&&m+1<f.shape[0],x=Math.floor(s),l=s-x,b=0<=x&&x<f.shape[1],c=0<=x+1&&x+1<f.shape[1],M=p&&b?f.get(m,x):0,_=p&&c?f.get(m,x+1):0,y=v&&b?f.get(m+1,x):0,w=v&&c?f.get(m+1,x+1):0;return(1-l)*((1-g)*M+g*y)+l*((1-g)*_+g*w)}function n(f,o,s,m){var g=Math.floor(o),p=o-g,v=0<=g&&g<f.shape[0],x=0<=g+1&&g+1<f.shape[0],l=Math.floor(s),b=s-l,c=0<=l&&l<f.shape[1],M=0<=l+1&&l+1<f.shape[1],_=Math.floor(m),y=m-_,w=0<=_&&_<f.shape[2],d=0<=_+1&&_+1<f.shape[2],C=v&&c&&w?f.get(g,l,_):0,S=v&&M&&w?f.get(g,l+1,_):0,E=x&&c&&w?f.get(g+1,l,_):0,k=x&&M&&w?f.get(g+1,l+1,_):0,B=v&&c&&d?f.get(g,l,_+1):0,z=v&&M&&d?f.get(g,l+1,_+1):0,F=x&&c&&d?f.get(g+1,l,_+1):0,I=x&&M&&d?f.get(g+1,l+1,_+1):0;return(1-y)*((1-b)*((1-p)*C+p*E)+b*((1-p)*S+p*k))+y*((1-b)*((1-p)*B+p*F)+b*((1-p)*z+p*I))}function a(f){var o=f.shape.length|0,s=new Array(o),m=new Array(o),g=new Array(o),p=new Array(o),v,x;for(v=0;v<o;++v)x=+arguments[v+1],s[v]=Math.floor(x),m[v]=x-s[v],g[v]=0<=s[v]&&s[v]<f.shape[v],p[v]=0<=s[v]+1&&s[v]+1<f.shape[v];var l=0,b,c,M;e:for(v=0;v<1<<o;++v){for(c=1,M=f.offset,b=0;b<o;++b)if(v&1<<b){if(!p[b])continue e;c*=m[b],M+=f.stride[b]*(s[b]+1)}else{if(!g[b])continue e;c*=1-m[b],M+=f.stride[b]*s[b]}l+=c*f.data[M]}return l}function r(f,o,s,m){switch(f.shape.length){case 0:return 0;case 1:return e(f,o);case 2:return i(f,o,s);case 3:return n(f,o,s,m);default:return a.apply(void 0,arguments)}}A.exports=r,A.exports.d1=e,A.exports.d2=i,A.exports.d3=n},{}],254:[function(u,A,T){var e={"float64,2,1,0":function(){return function(m,g,p,v,x){var l=m[0],b=m[1],c=m[2],M=p[0],_=p[1],y=p[2];v|=0;var w=0,d=0,C=0,S=y,E=_-c*y,k=M-b*_;for(C=0;C<l;++C){for(d=0;d<b;++d){for(w=0;w<c;++w)g[v]/=x,v+=S;v+=E}v+=k}}},"uint8,2,0,1,float64,2,1,0":function(){return function(m,g,p,v,x,l,b,c){var M=m[0],_=m[1],y=m[2],w=p[0],d=p[1],C=p[2],S=l[0],E=l[1],k=l[2];v|=0,b|=0;for(var B=v,z=b,F=m[0]|0;F>0;){F<64?(M=F,F=0):(M=64,F-=64);for(var I=m[1]|0;I>0;){I<64?(_=I,I=0):(_=64,I-=64),v=B+F*w+I*d,b=z+F*S+I*E;var O=0,N=0,V=0,H=C,j=w-y*C,Z=d-M*w,X=k,re=S-y*k,ue=E-M*S;for(V=0;V<_;++V){for(N=0;N<M;++N){for(O=0;O<y;++O)g[v]=x[b]*c,v+=H,b+=X;v+=j,b+=re}v+=Z,b+=ue}}}}},"float32,1,0,float32,1,0":function(){return function(m,g,p,v,x,l,b){var c=m[0],M=m[1],_=p[0],y=p[1],w=l[0],d=l[1];v|=0,b|=0;var C=0,S=0,E=y,k=_-M*y,B=d,z=w-M*d;for(S=0;S<c;++S){for(C=0;C<M;++C)g[v]=x[b],v+=E,b+=B;v+=k,b+=z}}},"float32,1,0,float32,0,1":function(){return function(m,g,p,v,x,l,b){var c=m[0],M=m[1],_=p[0],y=p[1],w=l[0],d=l[1];v|=0,b|=0;for(var C=v,S=b,E=m[1]|0;E>0;){E<64?(M=E,E=0):(M=64,E-=64);for(var k=m[0]|0;k>0;){k<64?(c=k,k=0):(c=64,k-=64),v=C+E*y+k*_,b=S+E*d+k*w;var B=0,z=0,F=y,I=_-M*y,O=d,N=w-M*d;for(z=0;z<c;++z){for(B=0;B<M;++B)g[v]=x[b],v+=F,b+=O;v+=I,b+=N}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(m,g,p,v,x,l,b){var c=m[0],M=m[1],_=m[2],y=p[0],w=p[1],d=p[2],C=l[0],S=l[1],E=l[2];v|=0,b|=0;for(var k=v,B=b,z=m[2]|0;z>0;){z<64?(_=z,z=0):(_=64,z-=64);for(var F=m[0]|0;F>0;){F<64?(c=F,F=0):(c=64,F-=64);for(var I=m[1]|0;I>0;){I<64?(M=I,I=0):(M=64,I-=64),v=k+z*d+F*y+I*w,b=B+z*E+F*C+I*S;var O=0,N=0,V=0,H=d,j=y-_*d,Z=w-c*y,X=E,re=C-_*E,ue=S-c*C;for(V=0;V<M;++V){for(N=0;N<c;++N){for(O=0;O<_;++O)g[v]=x[b],v+=H,b+=X;v+=j,b+=re}v+=Z,b+=ue}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(m,g,p,v,x,l,b){var c=m[0],M=m[1],_=m[2],y=p[0],w=p[1],d=p[2],C=l[0],S=l[1],E=l[2];v|=0,b|=0;var k=0,B=0,z=0,F=d,I=y-_*d,O=w-c*y,N=E,V=C-_*E,H=S-c*C;for(z=0;z<M;++z){for(B=0;B<c;++B){for(k=0;k<_;++k)g[v]=x[b],v+=F,b+=N;v+=I,b+=V}v+=O,b+=H}}}};function i(s,m){var g=m.join(","),p=e[g];return p()}var n=i,a={mul:function(s){var m={};return function(p,v,x){var l=p.dtype,b=p.order,c=v.dtype,M=v.order,_=x.dtype,y=x.order,w=[l,b.join(),c,M.join(),_,y.join()].join(),d=m[w];return d||(m[w]=d=s([l,b,c,M,_,y])),d(p.shape.slice(0),p.data,p.stride,p.offset|0,v.data,v.stride,v.offset|0,x.data,x.stride,x.offset|0)}},muls:function(s){var m={};return function(p,v,x){var l=p.dtype,b=p.order,c=v.dtype,M=v.order,_=[l,b.join(),c,M.join()].join(),y=m[_];return y||(m[_]=y=s([l,b,c,M])),y(p.shape.slice(0),p.data,p.stride,p.offset|0,v.data,v.stride,v.offset|0,x)}},mulseq:function(s){var m={};return function(p,v){var x=p.dtype,l=p.order,b=[x,l.join()].join(),c=m[b];return c||(m[b]=c=s([x,l])),c(p.shape.slice(0),p.data,p.stride,p.offset|0,v)}},div:function(s){var m={};return function(p,v,x){var l=p.dtype,b=p.order,c=v.dtype,M=v.order,_=x.dtype,y=x.order,w=[l,b.join(),c,M.join(),_,y.join()].join(),d=m[w];return d||(m[w]=d=s([l,b,c,M,_,y])),d(p.shape.slice(0),p.data,p.stride,p.offset|0,v.data,v.stride,v.offset|0,x.data,x.stride,x.offset|0)}},divs:function(s){var m={};return function(p,v,x){var l=p.dtype,b=p.order,c=v.dtype,M=v.order,_=[l,b.join(),c,M.join()].join(),y=m[_];return y||(m[_]=y=s([l,b,c,M])),y(p.shape.slice(0),p.data,p.stride,p.offset|0,v.data,v.stride,v.offset|0,x)}},divseq:function(s){var m={};return function(p,v){var x=p.dtype,l=p.order,b=[x,l.join()].join(),c=m[b];return c||(m[b]=c=s([x,l])),c(p.shape.slice(0),p.data,p.stride,p.offset|0,v)}},assign:function(s){var m={};return function(p,v){var x=p.dtype,l=p.order,b=v.dtype,c=v.order,M=[x,l.join(),b,c.join()].join(),_=m[M];return _||(m[M]=_=s([x,l,b,c])),_(p.shape.slice(0),p.data,p.stride,p.offset|0,v.data,v.stride,v.offset|0)}}};function r(s){var m=a[s.funcName];return m(n.bind(void 0,s))}function f(s){return r({funcName:s.funcName})}var o={mul:"*",div:"/"};(function(){for(var s in o)T[s]=f({funcName:s}),T[s+"s"]=f({funcName:s+"s"}),T[s+"seq"]=f({funcName:s+"seq"})})(),T.assign=f({funcName:"assign"})},{}],255:[function(u,A,T){var e=u("ndarray"),i=u("./doConvert.js");A.exports=function(a,r){for(var f=[],o=a,s=1;Array.isArray(o);)f.push(o.length),s*=o.length,o=o[0];return f.length===0?e():(r||(r=e(new Float64Array(s),f)),i(r,a),r)}},{"./doConvert.js":256,ndarray:259}],256:[function(u,A,T){function e(){return function(o,s,m,g,p){var v=o[0],x=o[1],l=o[2],b=m[0],c=m[1],M=m[2],_=[0,0,0];g|=0;var y=0,w=0,d=0,C=M,S=c-l*M,E=b-x*c;for(d=0;d<v;++d){for(w=0;w<x;++w){for(y=0;y<l;++y){{var k=p,B;for(B=0;B<_.length-1;++B)k=k[_[B]];s[g]=k[_[_.length-1]]}g+=C,++_[2]}g+=S,_[2]-=l,++_[1]}g+=E,_[1]-=x,++_[0]}}}function i(){return e()}var n=i;function a(o){var s={};return function(g,p){var v=g.dtype,x=g.order,l=[v,x.join()].join(),b=s[l];return b||(s[l]=b=o([v,x])),b(g.shape.slice(0),g.data,g.stride,g.offset|0,p)}}function r(o){return a(n.bind(void 0,o))}function f(o){return r({funcName:o.funcName})}A.exports=f({funcName:"convert"})},{}],257:[function(u,A,T){var e=u("typedarray-pool");function i(m){switch(m){case"uint32":return[e.mallocUint32,e.freeUint32];default:return null}}var n={"uint32,1,0":function(m,g){return function(v,x,l,b,c,M,_,y,w,d,C){var S,E,k,B=v*c+b,z,F=m(y),I,O,N,V;for(S=v+1;S<=x;++S){for(E=S,B+=c,k=B,I=0,O=B,z=0;z<y;++z)F[I++]=l[O],O+=w;e:for(;E-- >v;){I=0,O=k-c;t:for(z=0;z<y;++z){if(N=l[O],V=F[I],N<V)break e;if(N>V)break t;O+=d,I+=C}for(I=k,O=k-c,z=0;z<y;++z)l[I]=l[O],I+=w,O+=w;k-=c}for(I=k,O=0,z=0;z<y;++z)l[I]=F[O++],I+=w}g(F)}}};function a(m,g){var p=i(g),v=[g,m].join(","),x=n[v];return p?x(p[0],p[1]):x()}var r={"uint32,1,0":function(m,g,p){return function v(x,l,b,c,M,_,y,w,d,C,S){var E=(l-x+1)/6|0,k=x+E,B=l-E,z=x+l>>1,F=z-E,I=z+E,O=k,N=F,V=z,H=I,j=B,Z=x+1,X=l-1,re=!0,ue,K,te,G,Y,ee,ne,J,q,ae=0,le=0,ie=0,se,xe,oe,he,be,me,_e,Se,De,Ie,Te,Ce,He,Xe,Be,Re,We=w,vt=g(We),Pt=g(We);xe=M*O,oe=M*N,Re=c;e:for(se=0;se<w;++se){if(ne=xe+Re,J=oe+Re,ie=b[ne]-b[J],ie>0){K=O,O=N,N=K;break e}if(ie<0)break e;Re+=C}xe=M*H,oe=M*j,Re=c;e:for(se=0;se<w;++se){if(ne=xe+Re,J=oe+Re,ie=b[ne]-b[J],ie>0){K=H,H=j,j=K;break e}if(ie<0)break e;Re+=C}xe=M*O,oe=M*V,Re=c;e:for(se=0;se<w;++se){if(ne=xe+Re,J=oe+Re,ie=b[ne]-b[J],ie>0){K=O,O=V,V=K;break e}if(ie<0)break e;Re+=C}xe=M*N,oe=M*V,Re=c;e:for(se=0;se<w;++se){if(ne=xe+Re,J=oe+Re,ie=b[ne]-b[J],ie>0){K=N,N=V,V=K;break e}if(ie<0)break e;Re+=C}xe=M*O,oe=M*H,Re=c;e:for(se=0;se<w;++se){if(ne=xe+Re,J=oe+Re,ie=b[ne]-b[J],ie>0){K=O,O=H,H=K;break e}if(ie<0)break e;Re+=C}xe=M*V,oe=M*H,Re=c;e:for(se=0;se<w;++se){if(ne=xe+Re,J=oe+Re,ie=b[ne]-b[J],ie>0){K=V,V=H,H=K;break e}if(ie<0)break e;Re+=C}xe=M*N,oe=M*j,Re=c;e:for(se=0;se<w;++se){if(ne=xe+Re,J=oe+Re,ie=b[ne]-b[J],ie>0){K=N,N=j,j=K;break e}if(ie<0)break e;Re+=C}xe=M*N,oe=M*V,Re=c;e:for(se=0;se<w;++se){if(ne=xe+Re,J=oe+Re,ie=b[ne]-b[J],ie>0){K=N,N=V,V=K;break e}if(ie<0)break e;Re+=C}xe=M*H,oe=M*j,Re=c;e:for(se=0;se<w;++se){if(ne=xe+Re,J=oe+Re,ie=b[ne]-b[J],ie>0){K=H,H=j,j=K;break e}if(ie<0)break e;Re+=C}for(xe=M*O,oe=M*N,he=M*V,be=M*H,me=M*j,_e=M*k,Se=M*z,De=M*B,Be=0,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,q=he+Re,Ie=be+Re,Te=me+Re,Ce=_e+Re,He=Se+Re,Xe=De+Re,vt[Be]=b[J],Pt[Be]=b[Ie],re=re&&vt[Be]===Pt[Be],te=b[ne],G=b[q],Y=b[Te],b[Ce]=te,b[He]=G,b[Xe]=Y,++Be,Re+=d;for(xe=M*F,oe=M*x,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,b[ne]=b[J],Re+=d;for(xe=M*I,oe=M*l,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,b[ne]=b[J],Re+=d;if(re)for(ee=Z;ee<=X;++ee){ne=c+ee*M,Be=0;e:for(se=0;se<w;++se){if(ie=b[ne]-vt[Be],ie!==0)break e;Be+=S,ne+=C}if(ie!==0)if(ie<0){if(ee!==Z)for(xe=M*ee,oe=M*Z,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,ue=b[ne],b[ne]=b[J],b[J]=ue,Re+=d;++Z}else for(;;){ne=c+X*M,Be=0;e:for(se=0;se<w;++se){if(ie=b[ne]-vt[Be],ie!==0)break e;Be+=S,ne+=C}if(ie>0)X--;else if(ie<0){for(xe=M*ee,oe=M*Z,he=M*X,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,q=he+Re,ue=b[ne],b[ne]=b[J],b[J]=b[q],b[q]=ue,Re+=d;++Z,--X;break}else{for(xe=M*ee,oe=M*X,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,ue=b[ne],b[ne]=b[J],b[J]=ue,Re+=d;--X;break}}}else for(ee=Z;ee<=X;++ee){ne=c+ee*M,Be=0;e:for(se=0;se<w;++se){if(ae=b[ne]-vt[Be],ae!==0)break e;Be+=S,ne+=C}if(ae<0){if(ee!==Z)for(xe=M*ee,oe=M*Z,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,ue=b[ne],b[ne]=b[J],b[J]=ue,Re+=d;++Z}else{ne=c+ee*M,Be=0;e:for(se=0;se<w;++se){if(le=b[ne]-Pt[Be],le!==0)break e;Be+=S,ne+=C}if(le>0)for(;;){ne=c+X*M,Be=0;e:for(se=0;se<w;++se){if(ie=b[ne]-Pt[Be],ie!==0)break e;Be+=S,ne+=C}if(ie>0){if(--X<ee)break;continue}else{ne=c+X*M,Be=0;e:for(se=0;se<w;++se){if(ie=b[ne]-vt[Be],ie!==0)break e;Be+=S,ne+=C}if(ie<0){for(xe=M*ee,oe=M*Z,he=M*X,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,q=he+Re,ue=b[ne],b[ne]=b[J],b[J]=b[q],b[q]=ue,Re+=d;++Z,--X}else{for(xe=M*ee,oe=M*X,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,ue=b[ne],b[ne]=b[J],b[J]=ue,Re+=d;--X}break}}}}for(xe=M*x,oe=M*(Z-1),Be=0,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,b[ne]=b[J],b[J]=vt[Be],++Be,Re+=d;for(xe=M*l,oe=M*(X+1),Be=0,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,b[ne]=b[J],b[J]=Pt[Be],++Be,Re+=d;if(Z-2-x<=32?m(x,Z-2,b,c,M,_,y,w,d,C,S):v(x,Z-2,b,c,M,_,y,w,d,C,S),l-(X+2)<=32?m(X+2,l,b,c,M,_,y,w,d,C,S):v(X+2,l,b,c,M,_,y,w,d,C,S),re){p(vt),p(Pt);return}if(Z<k&&X>B){e:for(;;){for(ne=c+Z*M,Be=0,Re=c,se=0;se<w;++se){if(b[ne]!==vt[Be])break e;++Be,ne+=d}++Z}e:for(;;){for(ne=c+X*M,Be=0,Re=c,se=0;se<w;++se){if(b[ne]!==Pt[Be])break e;++Be,ne+=d}--X}for(ee=Z;ee<=X;++ee){ne=c+ee*M,Be=0;e:for(se=0;se<w;++se){if(ae=b[ne]-vt[Be],ae!==0)break e;Be+=S,ne+=C}if(ae===0){if(ee!==Z)for(xe=M*ee,oe=M*Z,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,ue=b[ne],b[ne]=b[J],b[J]=ue,Re+=d;++Z}else{ne=c+ee*M,Be=0;e:for(se=0;se<w;++se){if(le=b[ne]-Pt[Be],le!==0)break e;Be+=S,ne+=C}if(le===0)for(;;){ne=c+X*M,Be=0;e:for(se=0;se<w;++se){if(ie=b[ne]-Pt[Be],ie!==0)break e;Be+=S,ne+=C}if(ie===0){if(--X<ee)break;continue}else{ne=c+X*M,Be=0;e:for(se=0;se<w;++se){if(ie=b[ne]-vt[Be],ie!==0)break e;Be+=S,ne+=C}if(ie<0){for(xe=M*ee,oe=M*Z,he=M*X,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,q=he+Re,ue=b[ne],b[ne]=b[J],b[J]=b[q],b[q]=ue,Re+=d;++Z,--X}else{for(xe=M*ee,oe=M*X,Re=c,se=0;se<w;++se)ne=xe+Re,J=oe+Re,ue=b[ne],b[ne]=b[J],b[J]=ue,Re+=d;--X}break}}}}}p(vt),p(Pt),X-Z<=32?m(Z,X,b,c,M,_,y,w,d,C,S):v(Z,X,b,c,M,_,y,w,d,C,S)}}};function f(m,g,p){var v=i(g),x=[g,m].join(","),l=r[x];return m.length>1&&v?l(p,v[0],v[1]):l(p)}var o={"uint32,1,0":function(m,g){return function(p){var v=p.data,x=p.offset|0,l=p.shape,b=p.stride,c=b[0]|0,M=l[0]|0,_=b[1]|0,y=l[1]|0,w=_,d=_,C=1;M<=32?m(0,M-1,v,x,c,_,M,y,w,d,C):g(0,M-1,v,x,c,_,M,y,w,d,C)}}};function s(m,g){var p=[g,m].join(","),v=o[p],x=a(m,g),l=f(m,g,x);return v(x,l)}A.exports=s},{"typedarray-pool":308}],258:[function(u,A,T){var e=u("./lib/compile_sort.js"),i={};function n(a){var r=a.order,f=a.dtype,o=[r,f],s=o.join(":"),m=i[s];return m||(i[s]=m=e(r,f)),m(a),a}A.exports=n},{"./lib/compile_sort.js":257}],259:[function(u,A,T){var e=u("is-buffer"),i=typeof Float64Array<"u";function n(g,p){return g[0]-p[0]}function a(){var g=this.stride,p=new Array(g.length),v;for(v=0;v<p.length;++v)p[v]=[Math.abs(g[v]),v];p.sort(n);var x=new Array(p.length);for(v=0;v<x.length;++v)x[v]=p[v][1];return x}var r={T:function(g){function p(x){this.data=x}var v=p.prototype;return v.dtype=g,v.index=function(){return-1},v.size=0,v.dimension=-1,v.shape=v.stride=v.order=[],v.lo=v.hi=v.transpose=v.step=function(){return new p(this.data)},v.get=v.set=function(){},v.pick=function(){return null},function(l){return new p(l)}},0:function(g,p){function v(l,b){this.data=l,this.offset=b}var x=v.prototype;return x.dtype=g,x.index=function(){return this.offset},x.dimension=0,x.size=1,x.shape=x.stride=x.order=[],x.lo=x.hi=x.transpose=x.step=function(){return new v(this.data,this.offset)},x.pick=function(){return p(this.data)},x.valueOf=x.get=function(){return g==="generic"?this.data.get(this.offset):this.data[this.offset]},x.set=function(b){return g==="generic"?this.data.set(this.offset,b):this.data[this.offset]=b},function(b,c,M,_){return new v(b,_)}},1:function(g,p,v){function x(b,c,M,_){this.data=b,this.shape=[c],this.stride=[M],this.offset=_|0}var l=x.prototype;return l.dtype=g,l.dimension=1,Object.defineProperty(l,"size",{get:function(){return this.shape[0]}}),l.order=[0],l.set=function(c,M){return g==="generic"?this.data.set(this.offset+this.stride[0]*c,M):this.data[this.offset+this.stride[0]*c]=M},l.get=function(c){return g==="generic"?this.data.get(this.offset+this.stride[0]*c):this.data[this.offset+this.stride[0]*c]},l.index=function(c){return this.offset+this.stride[0]*c},l.hi=function(c){return new x(this.data,typeof c!="number"||c<0?this.shape[0]:c|0,this.stride[0],this.offset)},l.lo=function(c){var M=this.offset,_=0,y=this.shape[0],w=this.stride[0];return typeof c=="number"&&c>=0&&(_=c|0,M+=w*_,y-=_),new x(this.data,y,w,M)},l.step=function(c){var M=this.shape[0],_=this.stride[0],y=this.offset,w=0,d=Math.ceil;return typeof c=="number"&&(w=c|0,w<0?(y+=_*(M-1),M=d(-M/w)):M=d(M/w),_*=w),new x(this.data,M,_,y)},l.transpose=function(c){c=c===void 0?0:c|0;var M=this.shape,_=this.stride;return new x(this.data,M[c],_[c],this.offset)},l.pick=function(c){var M=[],_=[],y=this.offset;typeof c=="number"&&c>=0?y=y+this.stride[0]*c|0:(M.push(this.shape[0]),_.push(this.stride[0]));var w=p[M.length+1];return w(this.data,M,_,y)},function(c,M,_,y){return new x(c,M[0],_[0],y)}},2:function(g,p,v){function x(b,c,M,_,y,w){this.data=b,this.shape=[c,M],this.stride=[_,y],this.offset=w|0}var l=x.prototype;return l.dtype=g,l.dimension=2,Object.defineProperty(l,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(l,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),l.set=function(c,M,_){return g==="generic"?this.data.set(this.offset+this.stride[0]*c+this.stride[1]*M,_):this.data[this.offset+this.stride[0]*c+this.stride[1]*M]=_},l.get=function(c,M){return g==="generic"?this.data.get(this.offset+this.stride[0]*c+this.stride[1]*M):this.data[this.offset+this.stride[0]*c+this.stride[1]*M]},l.index=function(c,M){return this.offset+this.stride[0]*c+this.stride[1]*M},l.hi=function(c,M){return new x(this.data,typeof c!="number"||c<0?this.shape[0]:c|0,typeof M!="number"||M<0?this.shape[1]:M|0,this.stride[0],this.stride[1],this.offset)},l.lo=function(c,M){var _=this.offset,y=0,w=this.shape[0],d=this.shape[1],C=this.stride[0],S=this.stride[1];return typeof c=="number"&&c>=0&&(y=c|0,_+=C*y,w-=y),typeof M=="number"&&M>=0&&(y=M|0,_+=S*y,d-=y),new x(this.data,w,d,C,S,_)},l.step=function(c,M){var _=this.shape[0],y=this.shape[1],w=this.stride[0],d=this.stride[1],C=this.offset,S=0,E=Math.ceil;return typeof c=="number"&&(S=c|0,S<0?(C+=w*(_-1),_=E(-_/S)):_=E(_/S),w*=S),typeof M=="number"&&(S=M|0,S<0?(C+=d*(y-1),y=E(-y/S)):y=E(y/S),d*=S),new x(this.data,_,y,w,d,C)},l.transpose=function(c,M){c=c===void 0?0:c|0,M=M===void 0?1:M|0;var _=this.shape,y=this.stride;return new x(this.data,_[c],_[M],y[c],y[M],this.offset)},l.pick=function(c,M){var _=[],y=[],w=this.offset;typeof c=="number"&&c>=0?w=w+this.stride[0]*c|0:(_.push(this.shape[0]),y.push(this.stride[0])),typeof M=="number"&&M>=0?w=w+this.stride[1]*M|0:(_.push(this.shape[1]),y.push(this.stride[1]));var d=p[_.length+1];return d(this.data,_,y,w)},function(c,M,_,y){return new x(c,M[0],M[1],_[0],_[1],y)}},3:function(g,p,v){function x(b,c,M,_,y,w,d,C){this.data=b,this.shape=[c,M,_],this.stride=[y,w,d],this.offset=C|0}var l=x.prototype;return l.dtype=g,l.dimension=3,Object.defineProperty(l,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(l,"order",{get:function(){var c=Math.abs(this.stride[0]),M=Math.abs(this.stride[1]),_=Math.abs(this.stride[2]);return c>M?M>_?[2,1,0]:c>_?[1,2,0]:[1,0,2]:c>_?[2,0,1]:_>M?[0,1,2]:[0,2,1]}}),l.set=function(c,M,_,y){return g==="generic"?this.data.set(this.offset+this.stride[0]*c+this.stride[1]*M+this.stride[2]*_,y):this.data[this.offset+this.stride[0]*c+this.stride[1]*M+this.stride[2]*_]=y},l.get=function(c,M,_){return g==="generic"?this.data.get(this.offset+this.stride[0]*c+this.stride[1]*M+this.stride[2]*_):this.data[this.offset+this.stride[0]*c+this.stride[1]*M+this.stride[2]*_]},l.index=function(c,M,_){return this.offset+this.stride[0]*c+this.stride[1]*M+this.stride[2]*_},l.hi=function(c,M,_){return new x(this.data,typeof c!="number"||c<0?this.shape[0]:c|0,typeof M!="number"||M<0?this.shape[1]:M|0,typeof _!="number"||_<0?this.shape[2]:_|0,this.stride[0],this.stride[1],this.stride[2],this.offset)},l.lo=function(c,M,_){var y=this.offset,w=0,d=this.shape[0],C=this.shape[1],S=this.shape[2],E=this.stride[0],k=this.stride[1],B=this.stride[2];return typeof c=="number"&&c>=0&&(w=c|0,y+=E*w,d-=w),typeof M=="number"&&M>=0&&(w=M|0,y+=k*w,C-=w),typeof _=="number"&&_>=0&&(w=_|0,y+=B*w,S-=w),new x(this.data,d,C,S,E,k,B,y)},l.step=function(c,M,_){var y=this.shape[0],w=this.shape[1],d=this.shape[2],C=this.stride[0],S=this.stride[1],E=this.stride[2],k=this.offset,B=0,z=Math.ceil;return typeof c=="number"&&(B=c|0,B<0?(k+=C*(y-1),y=z(-y/B)):y=z(y/B),C*=B),typeof M=="number"&&(B=M|0,B<0?(k+=S*(w-1),w=z(-w/B)):w=z(w/B),S*=B),typeof _=="number"&&(B=_|0,B<0?(k+=E*(d-1),d=z(-d/B)):d=z(d/B),E*=B),new x(this.data,y,w,d,C,S,E,k)},l.transpose=function(c,M,_){c=c===void 0?0:c|0,M=M===void 0?1:M|0,_=_===void 0?2:_|0;var y=this.shape,w=this.stride;return new x(this.data,y[c],y[M],y[_],w[c],w[M],w[_],this.offset)},l.pick=function(c,M,_){var y=[],w=[],d=this.offset;typeof c=="number"&&c>=0?d=d+this.stride[0]*c|0:(y.push(this.shape[0]),w.push(this.stride[0])),typeof M=="number"&&M>=0?d=d+this.stride[1]*M|0:(y.push(this.shape[1]),w.push(this.stride[1])),typeof _=="number"&&_>=0?d=d+this.stride[2]*_|0:(y.push(this.shape[2]),w.push(this.stride[2]));var C=p[y.length+1];return C(this.data,y,w,d)},function(c,M,_,y){return new x(c,M[0],M[1],M[2],_[0],_[1],_[2],y)}},4:function(g,p,v){function x(b,c,M,_,y,w,d,C,S,E){this.data=b,this.shape=[c,M,_,y],this.stride=[w,d,C,S],this.offset=E|0}var l=x.prototype;return l.dtype=g,l.dimension=4,Object.defineProperty(l,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(l,"order",{get:v}),l.set=function(c,M,_,y,w){return g==="generic"?this.data.set(this.offset+this.stride[0]*c+this.stride[1]*M+this.stride[2]*_+this.stride[3]*y,w):this.data[this.offset+this.stride[0]*c+this.stride[1]*M+this.stride[2]*_+this.stride[3]*y]=w},l.get=function(c,M,_,y){return g==="generic"?this.data.get(this.offset+this.stride[0]*c+this.stride[1]*M+this.stride[2]*_+this.stride[3]*y):this.data[this.offset+this.stride[0]*c+this.stride[1]*M+this.stride[2]*_+this.stride[3]*y]},l.index=function(c,M,_,y){return this.offset+this.stride[0]*c+this.stride[1]*M+this.stride[2]*_+this.stride[3]*y},l.hi=function(c,M,_,y){return new x(this.data,typeof c!="number"||c<0?this.shape[0]:c|0,typeof M!="number"||M<0?this.shape[1]:M|0,typeof _!="number"||_<0?this.shape[2]:_|0,typeof y!="number"||y<0?this.shape[3]:y|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},l.lo=function(c,M,_,y){var w=this.offset,d=0,C=this.shape[0],S=this.shape[1],E=this.shape[2],k=this.shape[3],B=this.stride[0],z=this.stride[1],F=this.stride[2],I=this.stride[3];return typeof c=="number"&&c>=0&&(d=c|0,w+=B*d,C-=d),typeof M=="number"&&M>=0&&(d=M|0,w+=z*d,S-=d),typeof _=="number"&&_>=0&&(d=_|0,w+=F*d,E-=d),typeof y=="number"&&y>=0&&(d=y|0,w+=I*d,k-=d),new x(this.data,C,S,E,k,B,z,F,I,w)},l.step=function(c,M,_,y){var w=this.shape[0],d=this.shape[1],C=this.shape[2],S=this.shape[3],E=this.stride[0],k=this.stride[1],B=this.stride[2],z=this.stride[3],F=this.offset,I=0,O=Math.ceil;return typeof c=="number"&&(I=c|0,I<0?(F+=E*(w-1),w=O(-w/I)):w=O(w/I),E*=I),typeof M=="number"&&(I=M|0,I<0?(F+=k*(d-1),d=O(-d/I)):d=O(d/I),k*=I),typeof _=="number"&&(I=_|0,I<0?(F+=B*(C-1),C=O(-C/I)):C=O(C/I),B*=I),typeof y=="number"&&(I=y|0,I<0?(F+=z*(S-1),S=O(-S/I)):S=O(S/I),z*=I),new x(this.data,w,d,C,S,E,k,B,z,F)},l.transpose=function(c,M,_,y){c=c===void 0?0:c|0,M=M===void 0?1:M|0,_=_===void 0?2:_|0,y=y===void 0?3:y|0;var w=this.shape,d=this.stride;return new x(this.data,w[c],w[M],w[_],w[y],d[c],d[M],d[_],d[y],this.offset)},l.pick=function(c,M,_,y){var w=[],d=[],C=this.offset;typeof c=="number"&&c>=0?C=C+this.stride[0]*c|0:(w.push(this.shape[0]),d.push(this.stride[0])),typeof M=="number"&&M>=0?C=C+this.stride[1]*M|0:(w.push(this.shape[1]),d.push(this.stride[1])),typeof _=="number"&&_>=0?C=C+this.stride[2]*_|0:(w.push(this.shape[2]),d.push(this.stride[2])),typeof y=="number"&&y>=0?C=C+this.stride[3]*y|0:(w.push(this.shape[3]),d.push(this.stride[3]));var S=p[w.length+1];return S(this.data,w,d,C)},function(c,M,_,y){return new x(c,M[0],M[1],M[2],M[3],_[0],_[1],_[2],_[3],y)}},5:function(p,v,x){function l(c,M,_,y,w,d,C,S,E,k,B,z){this.data=c,this.shape=[M,_,y,w,d],this.stride=[C,S,E,k,B],this.offset=z|0}var b=l.prototype;return b.dtype=p,b.dimension=5,Object.defineProperty(b,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(b,"order",{get:x}),b.set=function(M,_,y,w,d,C){return p==="generic"?this.data.set(this.offset+this.stride[0]*M+this.stride[1]*_+this.stride[2]*y+this.stride[3]*w+this.stride[4]*d,C):this.data[this.offset+this.stride[0]*M+this.stride[1]*_+this.stride[2]*y+this.stride[3]*w+this.stride[4]*d]=C},b.get=function(M,_,y,w,d){return p==="generic"?this.data.get(this.offset+this.stride[0]*M+this.stride[1]*_+this.stride[2]*y+this.stride[3]*w+this.stride[4]*d):this.data[this.offset+this.stride[0]*M+this.stride[1]*_+this.stride[2]*y+this.stride[3]*w+this.stride[4]*d]},b.index=function(M,_,y,w,d){return this.offset+this.stride[0]*M+this.stride[1]*_+this.stride[2]*y+this.stride[3]*w+this.stride[4]*d},b.hi=function(M,_,y,w,d){return new l(this.data,typeof M!="number"||M<0?this.shape[0]:M|0,typeof _!="number"||_<0?this.shape[1]:_|0,typeof y!="number"||y<0?this.shape[2]:y|0,typeof w!="number"||w<0?this.shape[3]:w|0,typeof d!="number"||d<0?this.shape[4]:d|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},b.lo=function(M,_,y,w,d){var C=this.offset,S=0,E=this.shape[0],k=this.shape[1],B=this.shape[2],z=this.shape[3],F=this.shape[4],I=this.stride[0],O=this.stride[1],N=this.stride[2],V=this.stride[3],H=this.stride[4];return typeof M=="number"&&M>=0&&(S=M|0,C+=I*S,E-=S),typeof _=="number"&&_>=0&&(S=_|0,C+=O*S,k-=S),typeof y=="number"&&y>=0&&(S=y|0,C+=N*S,B-=S),typeof w=="number"&&w>=0&&(S=w|0,C+=V*S,z-=S),typeof d=="number"&&d>=0&&(S=d|0,C+=H*S,F-=S),new l(this.data,E,k,B,z,F,I,O,N,V,H,C)},b.step=function(M,_,y,w,d){var C=this.shape[0],S=this.shape[1],E=this.shape[2],k=this.shape[3],B=this.shape[4],z=this.stride[0],F=this.stride[1],I=this.stride[2],O=this.stride[3],N=this.stride[4],V=this.offset,H=0,j=Math.ceil;return typeof M=="number"&&(H=M|0,H<0?(V+=z*(C-1),C=j(-C/H)):C=j(C/H),z*=H),typeof _=="number"&&(H=_|0,H<0?(V+=F*(S-1),S=j(-S/H)):S=j(S/H),F*=H),typeof y=="number"&&(H=y|0,H<0?(V+=I*(E-1),E=j(-E/H)):E=j(E/H),I*=H),typeof w=="number"&&(H=w|0,H<0?(V+=O*(k-1),k=j(-k/H)):k=j(k/H),O*=H),typeof d=="number"&&(H=d|0,H<0?(V+=N*(B-1),B=j(-B/H)):B=j(B/H),N*=H),new l(this.data,C,S,E,k,B,z,F,I,O,N,V)},b.transpose=function(M,_,y,w,d){M=M===void 0?0:M|0,_=_===void 0?1:_|0,y=y===void 0?2:y|0,w=w===void 0?3:w|0,d=d===void 0?4:d|0;var C=this.shape,S=this.stride;return new l(this.data,C[M],C[_],C[y],C[w],C[d],S[M],S[_],S[y],S[w],S[d],this.offset)},b.pick=function(M,_,y,w,d){var C=[],S=[],E=this.offset;typeof M=="number"&&M>=0?E=E+this.stride[0]*M|0:(C.push(this.shape[0]),S.push(this.stride[0])),typeof _=="number"&&_>=0?E=E+this.stride[1]*_|0:(C.push(this.shape[1]),S.push(this.stride[1])),typeof y=="number"&&y>=0?E=E+this.stride[2]*y|0:(C.push(this.shape[2]),S.push(this.stride[2])),typeof w=="number"&&w>=0?E=E+this.stride[3]*w|0:(C.push(this.shape[3]),S.push(this.stride[3])),typeof d=="number"&&d>=0?E=E+this.stride[4]*d|0:(C.push(this.shape[4]),S.push(this.stride[4]));var k=v[C.length+1];return k(this.data,C,S,E)},function(M,_,y,w){return new l(M,_[0],_[1],_[2],_[3],_[4],y[0],y[1],y[2],y[3],y[4],w)}}};function f(g,p){var v=p===-1?"T":String(p),x=r[v];return p===-1?x(g):p===0?x(g,s[g][0]):x(g,s[g],a)}function o(g){if(e(g))return"buffer";if(i)switch(Object.prototype.toString.call(g)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(g)?"array":"generic"}var s={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};function m(g,p,v,x){if(g===void 0){var y=s.array[0];return y([])}else typeof g=="number"&&(g=[g]);p===void 0&&(p=[g.length]);var l=p.length;if(v===void 0){v=new Array(l);for(var b=l-1,c=1;b>=0;--b)v[b]=c,c*=p[b]}if(x===void 0){x=0;for(var b=0;b<l;++b)v[b]<0&&(x-=(p[b]-1)*v[b])}for(var M=o(g),_=s[M];_.length<=l+1;)_.push(f(M,_.length-1));var y=_[l+1];return y(g,p,v,x)}A.exports=m},{"is-buffer":237}],260:[function(u,A,T){var e=u("double-bits"),i=Math.pow(2,-1074),n=-1>>>0;A.exports=a;function a(r,f){if(isNaN(r)||isNaN(f))return NaN;if(r===f)return r;if(r===0)return f<0?-i:i;var o=e.hi(r),s=e.lo(r);return f>r==r>0?s===n?(o+=1,s=0):s+=1:s===0?(s=n,o-=1):s-=1,e.pack(s,o)}},{"double-bits":64}],261:[function(u,A,T){var e=1e-6,i=1e-6;T.vertexNormals=function(n,a,r){for(var f=a.length,o=new Array(f),s=r===void 0?e:r,m=0;m<f;++m)o[m]=[0,0,0];for(var m=0;m<n.length;++m)for(var g=n[m],p=0,v=g[g.length-1],x=g[0],l=0;l<g.length;++l){p=v,v=x,x=g[(l+1)%g.length];for(var b=a[p],c=a[v],M=a[x],_=new Array(3),y=0,w=new Array(3),d=0,C=0;C<3;++C)_[C]=b[C]-c[C],y+=_[C]*_[C],w[C]=M[C]-c[C],d+=w[C]*w[C];if(y*d>s)for(var S=o[v],E=1/Math.sqrt(y*d),C=0;C<3;++C){var k=(C+1)%3,B=(C+2)%3;S[C]+=E*(w[k]*_[B]-w[B]*_[k])}}for(var m=0;m<f;++m){for(var S=o[m],z=0,C=0;C<3;++C)z+=S[C]*S[C];if(z>s)for(var E=1/Math.sqrt(z),C=0;C<3;++C)S[C]*=E;else for(var C=0;C<3;++C)S[C]=0}return o},T.faceNormals=function(n,a,r){for(var f=n.length,o=new Array(f),s=r===void 0?i:r,m=0;m<f;++m){for(var g=n[m],p=new Array(3),v=0;v<3;++v)p[v]=a[g[v]];for(var x=new Array(3),l=new Array(3),v=0;v<3;++v)x[v]=p[1][v]-p[0][v],l[v]=p[2][v]-p[0][v];for(var b=new Array(3),c=0,v=0;v<3;++v){var M=(v+1)%3,_=(v+2)%3;b[v]=x[M]*l[_]-x[_]*l[M],c+=b[v]*b[v]}c>s?c=1/Math.sqrt(c):c=0;for(var v=0;v<3;++v)b[v]*=c;o[m]=b}return o}},{}],262:[function(u,A,T){A.exports=e;function e(i,n,a,r,f,o,s,m,g,p){var v=n+o+p;if(x>0){var x=Math.sqrt(v+1);i[0]=.5*(s-g)/x,i[1]=.5*(m-r)/x,i[2]=.5*(a-o)/x,i[3]=.5*x}else{var l=Math.max(n,o,p),x=Math.sqrt(2*l-v+1);n>=l?(i[0]=.5*x,i[1]=.5*(f+a)/x,i[2]=.5*(m+r)/x,i[3]=.5*(s-g)/x):o>=l?(i[0]=.5*(a+f)/x,i[1]=.5*x,i[2]=.5*(g+s)/x,i[3]=.5*(m-r)/x):(i[0]=.5*(r+m)/x,i[1]=.5*(s+g)/x,i[2]=.5*x,i[3]=.5*(a-f)/x)}return i}},{}],263:[function(u,A,T){A.exports=p;var e=u("filtered-vector"),i=u("gl-mat4/lookAt"),n=u("gl-mat4/fromQuat"),a=u("gl-mat4/invert"),r=u("./lib/quatFromFrame");function f(v,x,l){return Math.sqrt(Math.pow(v,2)+Math.pow(x,2)+Math.pow(l,2))}function o(v,x,l,b){return Math.sqrt(Math.pow(v,2)+Math.pow(x,2)+Math.pow(l,2)+Math.pow(b,2))}function s(v,x){var l=x[0],b=x[1],c=x[2],M=x[3],_=o(l,b,c,M);_>1e-6?(v[0]=l/_,v[1]=b/_,v[2]=c/_,v[3]=M/_):(v[0]=v[1]=v[2]=0,v[3]=1)}function m(v,x,l){this.radius=e([l]),this.center=e(x),this.rotation=e(v),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var g=m.prototype;g.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},g.recalcMatrix=function(v){this.radius.curve(v),this.center.curve(v),this.rotation.curve(v);var x=this.computedRotation;s(x,x);var l=this.computedMatrix;n(l,x);var b=this.computedCenter,c=this.computedEye,M=this.computedUp,_=Math.exp(this.computedRadius[0]);c[0]=b[0]+_*l[2],c[1]=b[1]+_*l[6],c[2]=b[2]+_*l[10],M[0]=l[1],M[1]=l[5],M[2]=l[9];for(var y=0;y<3;++y){for(var w=0,d=0;d<3;++d)w+=l[y+4*d]*c[d];l[12+y]=-w}},g.getMatrix=function(v,x){this.recalcMatrix(v);var l=this.computedMatrix;if(x){for(var b=0;b<16;++b)x[b]=l[b];return x}return l},g.idle=function(v){this.center.idle(v),this.radius.idle(v),this.rotation.idle(v)},g.flush=function(v){this.center.flush(v),this.radius.flush(v),this.rotation.flush(v)},g.pan=function(v,x,l,b){x=x||0,l=l||0,b=b||0,this.recalcMatrix(v);var c=this.computedMatrix,M=c[1],_=c[5],y=c[9],w=f(M,_,y);M/=w,_/=w,y/=w;var d=c[0],C=c[4],S=c[8],E=d*M+C*_+S*y;d-=M*E,C-=_*E,S-=y*E;var k=f(d,C,S);d/=k,C/=k,S/=k,c[2],c[6],c[10];var B=d*x+M*l,z=C*x+_*l,F=S*x+y*l;this.center.move(v,B,z,F);var I=Math.exp(this.computedRadius[0]);I=Math.max(1e-4,I+b),this.radius.set(v,Math.log(I))},g.rotate=function(v,x,l,b){this.recalcMatrix(v),x=x||0,l=l||0;var c=this.computedMatrix,M=c[0],_=c[4],y=c[8],w=c[1],d=c[5],C=c[9],S=c[2],E=c[6],k=c[10],B=x*M+l*w,z=x*_+l*d,F=x*y+l*C,I=-(E*F-k*z),O=-(k*B-S*F),N=-(S*z-E*B),V=Math.sqrt(Math.max(0,1-Math.pow(I,2)-Math.pow(O,2)-Math.pow(N,2))),H=o(I,O,N,V);H>1e-6?(I/=H,O/=H,N/=H,V/=H):(I=O=N=0,V=1);var j=this.computedRotation,Z=j[0],X=j[1],re=j[2],ue=j[3],K=Z*V+ue*I+X*N-re*O,te=X*V+ue*O+re*I-Z*N,G=re*V+ue*N+Z*O-X*I,Y=ue*V-Z*I-X*O-re*N;if(b){I=S,O=E,N=k;var ee=Math.sin(b)/f(I,O,N);I*=ee,O*=ee,N*=ee,V=Math.cos(x),K=K*V+Y*I+te*N-G*O,te=te*V+Y*O+G*I-K*N,G=G*V+Y*N+K*O-te*I,Y=Y*V-K*I-te*O-G*N}var ne=o(K,te,G,Y);ne>1e-6?(K/=ne,te/=ne,G/=ne,Y/=ne):(K=te=G=0,Y=1),this.rotation.set(v,K,te,G,Y)},g.lookAt=function(v,x,l,b){this.recalcMatrix(v),l=l||this.computedCenter,x=x||this.computedEye,b=b||this.computedUp;var c=this.computedMatrix;i(c,x,l,b);var M=this.computedRotation;r(M,c[0],c[1],c[2],c[4],c[5],c[6],c[8],c[9],c[10]),s(M,M),this.rotation.set(v,M[0],M[1],M[2],M[3]);for(var _=0,y=0;y<3;++y)_+=Math.pow(l[y]-x[y],2);this.radius.set(v,.5*Math.log(Math.max(_,1e-6))),this.center.set(v,l[0],l[1],l[2])},g.translate=function(v,x,l,b){this.center.move(v,x||0,l||0,b||0)},g.setMatrix=function(v,x){var l=this.computedRotation;r(l,x[0],x[1],x[2],x[4],x[5],x[6],x[8],x[9],x[10]),s(l,l),this.rotation.set(v,l[0],l[1],l[2],l[3]);var b=this.computedMatrix;a(b,x);var c=b[15];if(Math.abs(c)>1e-6){var M=b[12]/c,_=b[13]/c,y=b[14]/c;this.recalcMatrix(v);var w=Math.exp(this.computedRadius[0]);this.center.set(v,M-b[2]*w,_-b[6]*w,y-b[10]*w),this.radius.idle(v)}else this.center.idle(v),this.radius.idle(v)},g.setDistance=function(v,x){x>0&&this.radius.set(v,Math.log(x))},g.setDistanceLimits=function(v,x){v>0?v=Math.log(v):v=-1/0,x>0?x=Math.log(x):x=1/0,x=Math.max(x,v),this.radius.bounds[0][0]=v,this.radius.bounds[1][0]=x},g.getDistanceLimits=function(v){var x=this.radius.bounds;return v?(v[0]=Math.exp(x[0][0]),v[1]=Math.exp(x[1][0]),v):[Math.exp(x[0][0]),Math.exp(x[1][0])]},g.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},g.fromJSON=function(v){var x=this.lastT(),l=v.center;l&&this.center.set(x,l[0],l[1],l[2]);var b=v.rotation;b&&this.rotation.set(x,b[0],b[1],b[2],b[3]);var c=v.distance;c&&c>0&&this.radius.set(x,Math.log(c)),this.setDistanceLimits(v.zoomMin,v.zoomMax)};function p(v){v=v||{};var x=v.center||[0,0,0],l=v.rotation||[0,0,0,1],b=v.radius||1;x=[].slice.call(x,0,3),l=[].slice.call(l,0,4),s(l,l);var c=new m(l,x,Math.log(b));return c.setDistanceLimits(v.zoomMin,v.zoomMax),("eye"in v||"up"in v)&&c.lookAt(0,v.eye,v.center,v.up),c}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(u,A,T){var e=u("repeat-string");A.exports=function(n,a,r){return r=typeof r<"u"?r+"":" ",e(r,a)+n}},{"repeat-string":277}],265:[function(u,A,T){A.exports=function(i,n){n||(n=[0,""]),i=String(i);var a=parseFloat(i,10);return n[0]=a,n[1]=i.match(/[\d.\-\+]*\s*(.*)/)[1]||"",n}},{}],266:[function(u,A,T){A.exports=i;var e=u("compare-angle");function i(n,a){for(var r=a.length|0,f=n.length,o=[new Array(r),new Array(r)],s=0;s<r;++s)o[0][s]=[],o[1][s]=[];for(var s=0;s<f;++s){var m=n[s];o[0][m[0]].push(m),o[1][m[1]].push(m)}for(var g=[],s=0;s<r;++s)o[0][s].length+o[1][s].length===0&&g.push([s]);function p(_,y){var w=o[y][_[y]];w.splice(w.indexOf(_),1)}function v(_,y,w){for(var d,C,S,E=0;E<2;++E)if(o[E][y].length>0){d=o[E][y][0],S=E;break}C=d[S^1];for(var k=0;k<2;++k)for(var B=o[k][y],z=0;z<B.length;++z){var F=B[z],I=F[k^1],O=e(a[_],a[y],a[C],a[I]);O>0&&(d=F,C=I,S=k)}return w||d&&p(d,S),C}function x(_,y){var w=o[y][_][0],d=[_];p(w,y);for(var C=w[y^1];;){for(;C!==_;)d.push(C),C=v(d[d.length-2],C,!1);if(o[0][_].length+o[1][_].length===0)break;var S=d[d.length-1],E=_,k=d[1],B=v(S,E,!0);if(e(a[S],a[E],a[k],a[B])<0)break;d.push(_),C=v(S,E)}return d}function l(_,y){return y[1]===y[y.length-1]}for(var s=0;s<r;++s)for(var b=0;b<2;++b){for(var c=[];o[b][s].length>0;){o[0][s].length;var M=x(s,b);l(c,M)?c.push.apply(c,M):(c.length>0&&g.push(c),c=M)}c.length>0&&g.push(c)}return g}},{"compare-angle":54}],267:[function(u,A,T){A.exports=i;var e=u("edges-to-adjacency-list");function i(n,a){for(var r=e(n,a.length),f=new Array(a.length),o=new Array(a.length),s=[],m=0;m<a.length;++m){var g=r[m].length;o[m]=g,f[m]=!0,g<=1&&s.push(m)}for(;s.length>0;){var p=s.pop();f[p]=!1;for(var v=r[p],m=0;m<v.length;++m){var x=v[m];--o[x]===0&&s.push(x)}}for(var l=new Array(a.length),b=[],m=0;m<a.length;++m)if(f[m]){var p=b.length;l[m]=p,b.push(a[m])}else l[m]=-1;for(var c=[],m=0;m<n.length;++m){var M=n[m];f[M[0]]&&f[M[1]]&&c.push([l[M[0]],l[M[1]]])}return[c,b]}},{"edges-to-adjacency-list":66}],268:[function(u,A,T){A.exports=g;var e=u("edges-to-adjacency-list"),i=u("planar-dual"),n=u("point-in-big-polygon"),a=u("two-product"),r=u("robust-sum"),f=u("uniq"),o=u("./lib/trim-leaves");function s(p,v){for(var x=new Array(p),l=0;l<p;++l)x[l]=v;return x}function m(p){for(var v=new Array(p),x=0;x<p;++x)v[x]=[];return v}function g(p,v){var Y=o(p,v);p=Y[0],v=Y[1];var x=v.length;p.length;for(var l=e(p,v.length),b=0;b<x;++b)if(l[b].length%2===1)throw new Error("planar-graph-to-polyline: graph must be manifold");var c=i(p,v);function M(ie){for(var se=ie.length,xe=[0],oe=0;oe<se;++oe){var he=v[ie[oe]],be=v[ie[(oe+1)%se]],me=a(-he[0],he[1]),_e=a(-he[0],be[1]),Se=a(be[0],he[1]),De=a(be[0],be[1]);xe=r(xe,r(r(me,_e),r(Se,De)))}return xe[xe.length-1]>0}c=c.filter(M);for(var _=c.length,y=new Array(_),w=new Array(_),b=0;b<_;++b){y[b]=b;var d=new Array(_),C=c[b].map(function(se){return v[se]}),S=n([C]),E=0;e:for(var k=0;k<_;++k)if(d[k]=0,b!==k){for(var B=c[k],z=B.length,F=0;F<z;++F){var I=S(v[B[F]]);if(I!==0){I<0&&(d[k]=1,E+=1);continue e}}d[k]=1,E+=1}w[b]=[E,b,d]}w.sort(function(ie,se){return se[0]-ie[0]});for(var b=0;b<_;++b)for(var d=w[b],O=d[1],N=d[2],k=0;k<_;++k)N[k]&&(y[k]=O);for(var V=m(_),b=0;b<_;++b)V[b].push(y[b]),V[y[b]].push(b);for(var H={},j=s(x,!1),b=0;b<_;++b)for(var B=c[b],z=B.length,k=0;k<z;++k){var Z=B[k],X=B[(k+1)%z],re=Math.min(Z,X)+":"+Math.max(Z,X);if(re in H){var ue=H[re];V[ue].push(b),V[b].push(ue),j[Z]=j[X]=!0}else H[re]=b}function K(ie){for(var se=ie.length,xe=0;xe<se;++xe)if(!j[ie[xe]])return!1;return!0}for(var te=[],G=s(_,-1),b=0;b<_;++b)y[b]===b&&!K(c[b])?(te.push(b),G[b]=0):G[b]=-1;for(var Y=[];te.length>0;){var ee=te.pop(),ne=V[ee];f(ne,function(ie,se){return ie-se});var J=ne.length,q=G[ee],ae;if(q===0){var B=c[ee];ae=[B]}for(var b=0;b<J;++b){var le=ne[b];if(!(G[le]>=0)&&(G[le]=q^1,te.push(le),q===0)){var B=c[le];K(B)||(B.reverse(),ae.push(B))}}q===0&&Y.push(ae)}return Y}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(u,A,T){A.exports=v;var e=u("robust-orientation")[3],i=u("slab-decomposition"),n=u("interval-tree-1d"),a=u("binary-search-bounds");function r(){return!0}function f(x){return function(l,b){var c=x[l];return c?!!c.queryPoint(b,r):!1}}function o(x){for(var l={},b=0;b<x.length;++b){var c=x[b],M=c[0][0],_=c[0][1],y=c[1][1],w=[Math.min(_,y),Math.max(_,y)];M in l?l[M].push(w):l[M]=[w]}for(var d={},C=Object.keys(l),b=0;b<C.length;++b){var S=l[C[b]];d[C[b]]=n(S)}return f(d)}function s(x,l){return function(b){var c=a.le(l,b[0]);if(c<0)return 1;var M=x[c];if(!M)if(c>0&&l[c]===b[0])M=x[c-1];else return 1;for(var _=1;M;){var y=M.key,w=e(b,y[0],y[1]);if(y[0][0]<y[1][0])if(w<0)M=M.left;else if(w>0)_=-1,M=M.right;else return 0;else if(w>0)M=M.left;else if(w<0)_=1,M=M.right;else return 0}return _}}function m(x){return 1}function g(x){return function(b){return x(b[0],b[1])?0:1}}function p(x,l){return function(c){return x(c[0],c[1])?0:l(c)}}function v(x){for(var l=x.length,b=[],c=[],M=0;M<l;++M)for(var _=x[M],y=_.length,w=y-1,d=0;d<y;w=d++){var C=_[w],S=_[d];C[0]===S[0]?c.push([C,S]):b.push([C,S])}if(b.length===0)return c.length===0?m:g(o(c));var E=i(b),k=s(E.slabs,E.coordinates);return c.length===0?k:p(o(c),k)}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(u,A,T){var e=new Float64Array(4),i=new Float64Array(4),n=new Float64Array(4);function a(r,f,o,s,m){e.length<s.length&&(e=new Float64Array(s.length),i=new Float64Array(s.length),n=new Float64Array(s.length));for(var g=0;g<s.length;++g)e[g]=r[g]-s[g],i[g]=f[g]-r[g],n[g]=o[g]-r[g];for(var p=0,v=0,x=0,l=0,b=0,c=0,g=0;g<s.length;++g){var M=i[g],_=n[g],y=e[g];p+=M*M,v+=M*_,x+=_*_,l+=y*M,b+=y*_,c+=y*y}var w=Math.abs(p*x-v*v),d=v*b-x*l,C=v*l-p*b,S;if(d+C<=w)if(d<0)C<0&&l<0?(C=0,-l>=p?(d=1,S=p+2*l+c):(d=-l/p,S=l*d+c)):(d=0,b>=0?(C=0,S=c):-b>=x?(C=1,S=x+2*b+c):(C=-b/x,S=b*C+c));else if(C<0)C=0,l>=0?(d=0,S=c):-l>=p?(d=1,S=p+2*l+c):(d=-l/p,S=l*d+c);else{var E=1/w;d*=E,C*=E,S=d*(p*d+v*C+2*l)+C*(v*d+x*C+2*b)+c}else{var k,B,z,F;d<0?(k=v+l,B=x+b,B>k?(z=B-k,F=p-2*v+x,z>=F?(d=1,C=0,S=p+2*l+c):(d=z/F,C=1-d,S=d*(p*d+v*C+2*l)+C*(v*d+x*C+2*b)+c)):(d=0,B<=0?(C=1,S=x+2*b+c):b>=0?(C=0,S=c):(C=-b/x,S=b*C+c))):C<0?(k=v+b,B=p+l,B>k?(z=B-k,F=p-2*v+x,z>=F?(C=1,d=0,S=x+2*b+c):(C=z/F,d=1-C,S=d*(p*d+v*C+2*l)+C*(v*d+x*C+2*b)+c)):(C=0,B<=0?(d=1,S=p+2*l+c):l>=0?(d=0,S=c):(d=-l/p,S=l*d+c))):(z=x+b-v-l,z<=0?(d=0,C=1,S=x+2*b+c):(F=p-2*v+x,z>=F?(d=1,C=0,S=p+2*l+c):(d=z/F,C=1-d,S=d*(p*d+v*C+2*l)+C*(v*d+x*C+2*b)+c)))}for(var I=1-d-C,g=0;g<s.length;++g)m[g]=I*r[g]+d*f[g]+C*o[g];return S<0?0:S}A.exports=a},{}],271:[function(u,A,T){A.exports=u("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(u,A,T){var e=u("big-rat/add");A.exports=i;function i(n,a){for(var r=n.length,f=new Array(r),o=0;o<r;++o)f[o]=e(n[o],a[o]);return f}},{"big-rat/add":15}],273:[function(u,A,T){A.exports=i;var e=u("big-rat");function i(n){for(var a=new Array(n.length),r=0;r<n.length;++r)a[r]=e(n[r]);return a}},{"big-rat":18}],274:[function(u,A,T){var e=u("big-rat"),i=u("big-rat/mul");A.exports=n;function n(a,r){for(var f=e(r),o=a.length,s=new Array(o),m=0;m<o;++m)s[m]=i(a[m],f);return s}},{"big-rat":18,"big-rat/mul":27}],275:[function(u,A,T){var e=u("big-rat/sub");A.exports=i;function i(n,a){for(var r=n.length,f=new Array(r),o=0;o<r;++o)f[o]=e(n[o],a[o]);return f}},{"big-rat/sub":29}],276:[function(u,A,T){var e=u("compare-cell"),i=u("compare-oriented-cell"),n=u("cell-orientation");A.exports=a;function a(r){r.sort(i);for(var f=r.length,o=0,s=0;s<f;++s){var m=r[s],g=n(m);if(g!==0){if(o>0){var p=r[o-1];if(e(m,p)===0&&n(p)!==g){o-=1;continue}}r[o++]=m}}return r.length=o,r}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(u,A,T){var e="",i;A.exports=n;function n(a,r){if(typeof a!="string")throw new TypeError("expected a string");if(r===1)return a;if(r===2)return a+a;var f=a.length*r;if(i!==a||typeof i>"u")i=a,e="";else if(e.length>=f)return e.substr(0,f);for(;f>e.length&&r>1;)r&1&&(e+=a),r>>=1,a+=a;return e+=a,e=e.substr(0,f),e}},{}],278:[function(u,A,T){(function(e){(function(){A.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,typeof h<"u"?h:typeof self<"u"?self:typeof window<"u"?window:{})},{}],279:[function(u,A,T){A.exports=e;function e(i){for(var n=i.length,a=i[i.length-1],r=n,f=n-2;f>=0;--f){var o=a,s=i[f];a=o+s;var m=a-o,g=s-m;g&&(i[--r]=a,a=g)}for(var p=0,f=r;f<n;++f){var o=i[f],s=a;a=o+s;var m=a-o,g=s-m;g&&(i[p++]=g)}return i[p++]=a,i.length=p,i}},{}],280:[function(u,A,T){var e=u("two-product"),i=u("robust-sum"),n=u("robust-scale"),a=u("robust-compress"),r=6;function f(l,b,c,M){return function(y){return M(l(c(y[0][0],y[1][1]),c(-y[0][1],y[1][0])))}}function o(l,b,c,M){return function(y){return M(l(b(l(c(y[1][1],y[2][2]),c(-y[1][2],y[2][1])),y[0][0]),l(b(l(c(y[1][0],y[2][2]),c(-y[1][2],y[2][0])),-y[0][1]),b(l(c(y[1][0],y[2][1]),c(-y[1][1],y[2][0])),y[0][2]))))}}function s(l,b,c,M){return function(y){return M(l(l(b(l(b(l(c(y[2][2],y[3][3]),c(-y[2][3],y[3][2])),y[1][1]),l(b(l(c(y[2][1],y[3][3]),c(-y[2][3],y[3][1])),-y[1][2]),b(l(c(y[2][1],y[3][2]),c(-y[2][2],y[3][1])),y[1][3]))),y[0][0]),b(l(b(l(c(y[2][2],y[3][3]),c(-y[2][3],y[3][2])),y[1][0]),l(b(l(c(y[2][0],y[3][3]),c(-y[2][3],y[3][0])),-y[1][2]),b(l(c(y[2][0],y[3][2]),c(-y[2][2],y[3][0])),y[1][3]))),-y[0][1])),l(b(l(b(l(c(y[2][1],y[3][3]),c(-y[2][3],y[3][1])),y[1][0]),l(b(l(c(y[2][0],y[3][3]),c(-y[2][3],y[3][0])),-y[1][1]),b(l(c(y[2][0],y[3][1]),c(-y[2][1],y[3][0])),y[1][3]))),y[0][2]),b(l(b(l(c(y[2][1],y[3][2]),c(-y[2][2],y[3][1])),y[1][0]),l(b(l(c(y[2][0],y[3][2]),c(-y[2][2],y[3][0])),-y[1][1]),b(l(c(y[2][0],y[3][1]),c(-y[2][1],y[3][0])),y[1][2]))),-y[0][3]))))}}function m(l,b,c,M){return function(y){return M(l(l(b(l(l(b(l(b(l(c(y[3][3],y[4][4]),c(-y[3][4],y[4][3])),y[2][2]),l(b(l(c(y[3][2],y[4][4]),c(-y[3][4],y[4][2])),-y[2][3]),b(l(c(y[3][2],y[4][3]),c(-y[3][3],y[4][2])),y[2][4]))),y[1][1]),b(l(b(l(c(y[3][3],y[4][4]),c(-y[3][4],y[4][3])),y[2][1]),l(b(l(c(y[3][1],y[4][4]),c(-y[3][4],y[4][1])),-y[2][3]),b(l(c(y[3][1],y[4][3]),c(-y[3][3],y[4][1])),y[2][4]))),-y[1][2])),l(b(l(b(l(c(y[3][2],y[4][4]),c(-y[3][4],y[4][2])),y[2][1]),l(b(l(c(y[3][1],y[4][4]),c(-y[3][4],y[4][1])),-y[2][2]),b(l(c(y[3][1],y[4][2]),c(-y[3][2],y[4][1])),y[2][4]))),y[1][3]),b(l(b(l(c(y[3][2],y[4][3]),c(-y[3][3],y[4][2])),y[2][1]),l(b(l(c(y[3][1],y[4][3]),c(-y[3][3],y[4][1])),-y[2][2]),b(l(c(y[3][1],y[4][2]),c(-y[3][2],y[4][1])),y[2][3]))),-y[1][4]))),y[0][0]),b(l(l(b(l(b(l(c(y[3][3],y[4][4]),c(-y[3][4],y[4][3])),y[2][2]),l(b(l(c(y[3][2],y[4][4]),c(-y[3][4],y[4][2])),-y[2][3]),b(l(c(y[3][2],y[4][3]),c(-y[3][3],y[4][2])),y[2][4]))),y[1][0]),b(l(b(l(c(y[3][3],y[4][4]),c(-y[3][4],y[4][3])),y[2][0]),l(b(l(c(y[3][0],y[4][4]),c(-y[3][4],y[4][0])),-y[2][3]),b(l(c(y[3][0],y[4][3]),c(-y[3][3],y[4][0])),y[2][4]))),-y[1][2])),l(b(l(b(l(c(y[3][2],y[4][4]),c(-y[3][4],y[4][2])),y[2][0]),l(b(l(c(y[3][0],y[4][4]),c(-y[3][4],y[4][0])),-y[2][2]),b(l(c(y[3][0],y[4][2]),c(-y[3][2],y[4][0])),y[2][4]))),y[1][3]),b(l(b(l(c(y[3][2],y[4][3]),c(-y[3][3],y[4][2])),y[2][0]),l(b(l(c(y[3][0],y[4][3]),c(-y[3][3],y[4][0])),-y[2][2]),b(l(c(y[3][0],y[4][2]),c(-y[3][2],y[4][0])),y[2][3]))),-y[1][4]))),-y[0][1])),l(b(l(l(b(l(b(l(c(y[3][3],y[4][4]),c(-y[3][4],y[4][3])),y[2][1]),l(b(l(c(y[3][1],y[4][4]),c(-y[3][4],y[4][1])),-y[2][3]),b(l(c(y[3][1],y[4][3]),c(-y[3][3],y[4][1])),y[2][4]))),y[1][0]),b(l(b(l(c(y[3][3],y[4][4]),c(-y[3][4],y[4][3])),y[2][0]),l(b(l(c(y[3][0],y[4][4]),c(-y[3][4],y[4][0])),-y[2][3]),b(l(c(y[3][0],y[4][3]),c(-y[3][3],y[4][0])),y[2][4]))),-y[1][1])),l(b(l(b(l(c(y[3][1],y[4][4]),c(-y[3][4],y[4][1])),y[2][0]),l(b(l(c(y[3][0],y[4][4]),c(-y[3][4],y[4][0])),-y[2][1]),b(l(c(y[3][0],y[4][1]),c(-y[3][1],y[4][0])),y[2][4]))),y[1][3]),b(l(b(l(c(y[3][1],y[4][3]),c(-y[3][3],y[4][1])),y[2][0]),l(b(l(c(y[3][0],y[4][3]),c(-y[3][3],y[4][0])),-y[2][1]),b(l(c(y[3][0],y[4][1]),c(-y[3][1],y[4][0])),y[2][3]))),-y[1][4]))),y[0][2]),l(b(l(l(b(l(b(l(c(y[3][2],y[4][4]),c(-y[3][4],y[4][2])),y[2][1]),l(b(l(c(y[3][1],y[4][4]),c(-y[3][4],y[4][1])),-y[2][2]),b(l(c(y[3][1],y[4][2]),c(-y[3][2],y[4][1])),y[2][4]))),y[1][0]),b(l(b(l(c(y[3][2],y[4][4]),c(-y[3][4],y[4][2])),y[2][0]),l(b(l(c(y[3][0],y[4][4]),c(-y[3][4],y[4][0])),-y[2][2]),b(l(c(y[3][0],y[4][2]),c(-y[3][2],y[4][0])),y[2][4]))),-y[1][1])),l(b(l(b(l(c(y[3][1],y[4][4]),c(-y[3][4],y[4][1])),y[2][0]),l(b(l(c(y[3][0],y[4][4]),c(-y[3][4],y[4][0])),-y[2][1]),b(l(c(y[3][0],y[4][1]),c(-y[3][1],y[4][0])),y[2][4]))),y[1][2]),b(l(b(l(c(y[3][1],y[4][2]),c(-y[3][2],y[4][1])),y[2][0]),l(b(l(c(y[3][0],y[4][2]),c(-y[3][2],y[4][0])),-y[2][1]),b(l(c(y[3][0],y[4][1]),c(-y[3][1],y[4][0])),y[2][2]))),-y[1][4]))),-y[0][3]),b(l(l(b(l(b(l(c(y[3][2],y[4][3]),c(-y[3][3],y[4][2])),y[2][1]),l(b(l(c(y[3][1],y[4][3]),c(-y[3][3],y[4][1])),-y[2][2]),b(l(c(y[3][1],y[4][2]),c(-y[3][2],y[4][1])),y[2][3]))),y[1][0]),b(l(b(l(c(y[3][2],y[4][3]),c(-y[3][3],y[4][2])),y[2][0]),l(b(l(c(y[3][0],y[4][3]),c(-y[3][3],y[4][0])),-y[2][2]),b(l(c(y[3][0],y[4][2]),c(-y[3][2],y[4][0])),y[2][3]))),-y[1][1])),l(b(l(b(l(c(y[3][1],y[4][3]),c(-y[3][3],y[4][1])),y[2][0]),l(b(l(c(y[3][0],y[4][3]),c(-y[3][3],y[4][0])),-y[2][1]),b(l(c(y[3][0],y[4][1]),c(-y[3][1],y[4][0])),y[2][3]))),y[1][2]),b(l(b(l(c(y[3][1],y[4][2]),c(-y[3][2],y[4][1])),y[2][0]),l(b(l(c(y[3][0],y[4][2]),c(-y[3][2],y[4][0])),-y[2][1]),b(l(c(y[3][0],y[4][1]),c(-y[3][1],y[4][0])),y[2][2]))),-y[1][3]))),y[0][4])))))}}function g(l){var b=l===2?f:l===3?o:l===4?s:l===5?m:void 0;return b(i,n,e,a)}var p=[function(){return[0]},function(b){return[b[0][0]]}];function v(l,b,c,M,_,y,w,d){return function(S){switch(S.length){case 0:return l(S);case 1:return b(S);case 2:return c(S);case 3:return M(S);case 4:return _(S);case 5:return y(S)}var E=w[S.length];return E||(E=w[S.length]=d(S.length)),E(S)}}function x(){for(;p.length<r;)p.push(g(p.length));A.exports=v.apply(void 0,p.concat([p,g]));for(var l=0;l<p.length;++l)A.exports[l]=p[l]}x()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(u,A,T){var e=u("two-product"),i=u("robust-sum");A.exports=n;function n(a,r){for(var f=e(a[0],r[0]),o=1;o<a.length;++o)f=i(f,e(a[o],r[o]));return f}},{"robust-sum":289,"two-product":306}],282:[function(u,A,T){var e=u("two-product"),i=u("robust-sum"),n=u("robust-subtract"),a=u("robust-scale"),r=6;function f(_){var y=_===3?g:_===4?p:_===5?v:x;return y(i,n,e,a)}function o(){return 0}function s(){return 0}function m(){return 0}function g(_,y,w,d){function C(S,E,k){var B=w(S[0],S[0]),z=d(B,E[0]),F=d(B,k[0]),I=w(E[0],E[0]),O=d(I,S[0]),N=d(I,k[0]),V=w(k[0],k[0]),H=d(V,S[0]),j=d(V,E[0]),Z=_(y(j,N),y(O,z)),X=y(H,F),re=y(Z,X);return re[re.length-1]}return C}function p(_,y,w,d){function C(S,E,k,B){var z=_(w(S[0],S[0]),w(S[1],S[1])),F=d(z,E[0]),I=d(z,k[0]),O=d(z,B[0]),N=_(w(E[0],E[0]),w(E[1],E[1])),V=d(N,S[0]),H=d(N,k[0]),j=d(N,B[0]),Z=_(w(k[0],k[0]),w(k[1],k[1])),X=d(Z,S[0]),re=d(Z,E[0]),ue=d(Z,B[0]),K=_(w(B[0],B[0]),w(B[1],B[1])),te=d(K,S[0]),G=d(K,E[0]),Y=d(K,k[0]),ee=_(_(d(y(Y,ue),E[1]),_(d(y(G,j),-k[1]),d(y(re,H),B[1]))),_(d(y(G,j),S[1]),_(d(y(te,O),-E[1]),d(y(V,F),B[1])))),ne=_(_(d(y(Y,ue),S[1]),_(d(y(te,O),-k[1]),d(y(X,I),B[1]))),_(d(y(re,H),S[1]),_(d(y(X,I),-E[1]),d(y(V,F),k[1])))),J=y(ee,ne);return J[J.length-1]}return C}function v(_,y,w,d){function C(S,E,k,B,z){var F=_(w(S[0],S[0]),_(w(S[1],S[1]),w(S[2],S[2]))),I=d(F,E[0]),O=d(F,k[0]),N=d(F,B[0]),V=d(F,z[0]),H=_(w(E[0],E[0]),_(w(E[1],E[1]),w(E[2],E[2]))),j=d(H,S[0]),Z=d(H,k[0]),X=d(H,B[0]),re=d(H,z[0]),ue=_(w(k[0],k[0]),_(w(k[1],k[1]),w(k[2],k[2]))),K=d(ue,S[0]),te=d(ue,E[0]),G=d(ue,B[0]),Y=d(ue,z[0]),ee=_(w(B[0],B[0]),_(w(B[1],B[1]),w(B[2],B[2]))),ne=d(ee,S[0]),J=d(ee,E[0]),q=d(ee,k[0]),ae=d(ee,z[0]),le=_(w(z[0],z[0]),_(w(z[1],z[1]),w(z[2],z[2]))),ie=d(le,S[0]),se=d(le,E[0]),xe=d(le,k[0]),oe=d(le,B[0]),he=_(_(_(d(_(d(y(oe,ae),k[1]),_(d(y(xe,Y),-B[1]),d(y(q,G),z[1]))),E[2]),_(d(_(d(y(oe,ae),E[1]),_(d(y(se,re),-B[1]),d(y(J,X),z[1]))),-k[2]),d(_(d(y(xe,Y),E[1]),_(d(y(se,re),-k[1]),d(y(te,Z),z[1]))),B[2]))),_(d(_(d(y(q,G),E[1]),_(d(y(J,X),-k[1]),d(y(te,Z),B[1]))),-z[2]),_(d(_(d(y(oe,ae),E[1]),_(d(y(se,re),-B[1]),d(y(J,X),z[1]))),S[2]),d(_(d(y(oe,ae),S[1]),_(d(y(ie,V),-B[1]),d(y(ne,N),z[1]))),-E[2])))),_(_(d(_(d(y(se,re),S[1]),_(d(y(ie,V),-E[1]),d(y(j,I),z[1]))),B[2]),_(d(_(d(y(J,X),S[1]),_(d(y(ne,N),-E[1]),d(y(j,I),B[1]))),-z[2]),d(_(d(y(q,G),E[1]),_(d(y(J,X),-k[1]),d(y(te,Z),B[1]))),S[2]))),_(d(_(d(y(q,G),S[1]),_(d(y(ne,N),-k[1]),d(y(K,O),B[1]))),-E[2]),_(d(_(d(y(J,X),S[1]),_(d(y(ne,N),-E[1]),d(y(j,I),B[1]))),k[2]),d(_(d(y(te,Z),S[1]),_(d(y(K,O),-E[1]),d(y(j,I),k[1]))),-B[2]))))),be=_(_(_(d(_(d(y(oe,ae),k[1]),_(d(y(xe,Y),-B[1]),d(y(q,G),z[1]))),S[2]),d(_(d(y(oe,ae),S[1]),_(d(y(ie,V),-B[1]),d(y(ne,N),z[1]))),-k[2])),_(d(_(d(y(xe,Y),S[1]),_(d(y(ie,V),-k[1]),d(y(K,O),z[1]))),B[2]),d(_(d(y(q,G),S[1]),_(d(y(ne,N),-k[1]),d(y(K,O),B[1]))),-z[2]))),_(_(d(_(d(y(xe,Y),E[1]),_(d(y(se,re),-k[1]),d(y(te,Z),z[1]))),S[2]),d(_(d(y(xe,Y),S[1]),_(d(y(ie,V),-k[1]),d(y(K,O),z[1]))),-E[2])),_(d(_(d(y(se,re),S[1]),_(d(y(ie,V),-E[1]),d(y(j,I),z[1]))),k[2]),d(_(d(y(te,Z),S[1]),_(d(y(K,O),-E[1]),d(y(j,I),k[1]))),-z[2])))),me=y(he,be);return me[me.length-1]}return C}function x(_,y,w,d){function C(S,E,k,B,z,F){var I=_(_(w(S[0],S[0]),w(S[1],S[1])),_(w(S[2],S[2]),w(S[3],S[3]))),O=d(I,E[0]),N=d(I,k[0]),V=d(I,B[0]),H=d(I,z[0]),j=d(I,F[0]),Z=_(_(w(E[0],E[0]),w(E[1],E[1])),_(w(E[2],E[2]),w(E[3],E[3]))),X=d(Z,S[0]),re=d(Z,k[0]),ue=d(Z,B[0]),K=d(Z,z[0]),te=d(Z,F[0]),G=_(_(w(k[0],k[0]),w(k[1],k[1])),_(w(k[2],k[2]),w(k[3],k[3]))),Y=d(G,S[0]),ee=d(G,E[0]),ne=d(G,B[0]),J=d(G,z[0]),q=d(G,F[0]),ae=_(_(w(B[0],B[0]),w(B[1],B[1])),_(w(B[2],B[2]),w(B[3],B[3]))),le=d(ae,S[0]),ie=d(ae,E[0]),se=d(ae,k[0]),xe=d(ae,z[0]),oe=d(ae,F[0]),he=_(_(w(z[0],z[0]),w(z[1],z[1])),_(w(z[2],z[2]),w(z[3],z[3]))),be=d(he,S[0]),me=d(he,E[0]),_e=d(he,k[0]),Se=d(he,B[0]),De=d(he,F[0]),Ie=_(_(w(F[0],F[0]),w(F[1],F[1])),_(w(F[2],F[2]),w(F[3],F[3]))),Te=d(Ie,S[0]),Ce=d(Ie,E[0]),He=d(Ie,k[0]),Xe=d(Ie,B[0]),Be=d(Ie,z[0]),Re=_(_(_(d(_(_(d(_(d(y(Be,De),B[1]),_(d(y(Xe,oe),-z[1]),d(y(Se,xe),F[1]))),k[2]),d(_(d(y(Be,De),k[1]),_(d(y(He,q),-z[1]),d(y(_e,J),F[1]))),-B[2])),_(d(_(d(y(Xe,oe),k[1]),_(d(y(He,q),-B[1]),d(y(se,ne),F[1]))),z[2]),d(_(d(y(Se,xe),k[1]),_(d(y(_e,J),-B[1]),d(y(se,ne),z[1]))),-F[2]))),E[3]),_(d(_(_(d(_(d(y(Be,De),B[1]),_(d(y(Xe,oe),-z[1]),d(y(Se,xe),F[1]))),E[2]),d(_(d(y(Be,De),E[1]),_(d(y(Ce,te),-z[1]),d(y(me,K),F[1]))),-B[2])),_(d(_(d(y(Xe,oe),E[1]),_(d(y(Ce,te),-B[1]),d(y(ie,ue),F[1]))),z[2]),d(_(d(y(Se,xe),E[1]),_(d(y(me,K),-B[1]),d(y(ie,ue),z[1]))),-F[2]))),-k[3]),d(_(_(d(_(d(y(Be,De),k[1]),_(d(y(He,q),-z[1]),d(y(_e,J),F[1]))),E[2]),d(_(d(y(Be,De),E[1]),_(d(y(Ce,te),-z[1]),d(y(me,K),F[1]))),-k[2])),_(d(_(d(y(He,q),E[1]),_(d(y(Ce,te),-k[1]),d(y(ee,re),F[1]))),z[2]),d(_(d(y(_e,J),E[1]),_(d(y(me,K),-k[1]),d(y(ee,re),z[1]))),-F[2]))),B[3]))),_(_(d(_(_(d(_(d(y(Xe,oe),k[1]),_(d(y(He,q),-B[1]),d(y(se,ne),F[1]))),E[2]),d(_(d(y(Xe,oe),E[1]),_(d(y(Ce,te),-B[1]),d(y(ie,ue),F[1]))),-k[2])),_(d(_(d(y(He,q),E[1]),_(d(y(Ce,te),-k[1]),d(y(ee,re),F[1]))),B[2]),d(_(d(y(se,ne),E[1]),_(d(y(ie,ue),-k[1]),d(y(ee,re),B[1]))),-F[2]))),-z[3]),d(_(_(d(_(d(y(Se,xe),k[1]),_(d(y(_e,J),-B[1]),d(y(se,ne),z[1]))),E[2]),d(_(d(y(Se,xe),E[1]),_(d(y(me,K),-B[1]),d(y(ie,ue),z[1]))),-k[2])),_(d(_(d(y(_e,J),E[1]),_(d(y(me,K),-k[1]),d(y(ee,re),z[1]))),B[2]),d(_(d(y(se,ne),E[1]),_(d(y(ie,ue),-k[1]),d(y(ee,re),B[1]))),-z[2]))),F[3])),_(d(_(_(d(_(d(y(Be,De),B[1]),_(d(y(Xe,oe),-z[1]),d(y(Se,xe),F[1]))),E[2]),d(_(d(y(Be,De),E[1]),_(d(y(Ce,te),-z[1]),d(y(me,K),F[1]))),-B[2])),_(d(_(d(y(Xe,oe),E[1]),_(d(y(Ce,te),-B[1]),d(y(ie,ue),F[1]))),z[2]),d(_(d(y(Se,xe),E[1]),_(d(y(me,K),-B[1]),d(y(ie,ue),z[1]))),-F[2]))),S[3]),d(_(_(d(_(d(y(Be,De),B[1]),_(d(y(Xe,oe),-z[1]),d(y(Se,xe),F[1]))),S[2]),d(_(d(y(Be,De),S[1]),_(d(y(Te,j),-z[1]),d(y(be,H),F[1]))),-B[2])),_(d(_(d(y(Xe,oe),S[1]),_(d(y(Te,j),-B[1]),d(y(le,V),F[1]))),z[2]),d(_(d(y(Se,xe),S[1]),_(d(y(be,H),-B[1]),d(y(le,V),z[1]))),-F[2]))),-E[3])))),_(_(_(d(_(_(d(_(d(y(Be,De),E[1]),_(d(y(Ce,te),-z[1]),d(y(me,K),F[1]))),S[2]),d(_(d(y(Be,De),S[1]),_(d(y(Te,j),-z[1]),d(y(be,H),F[1]))),-E[2])),_(d(_(d(y(Ce,te),S[1]),_(d(y(Te,j),-E[1]),d(y(X,O),F[1]))),z[2]),d(_(d(y(me,K),S[1]),_(d(y(be,H),-E[1]),d(y(X,O),z[1]))),-F[2]))),B[3]),d(_(_(d(_(d(y(Xe,oe),E[1]),_(d(y(Ce,te),-B[1]),d(y(ie,ue),F[1]))),S[2]),d(_(d(y(Xe,oe),S[1]),_(d(y(Te,j),-B[1]),d(y(le,V),F[1]))),-E[2])),_(d(_(d(y(Ce,te),S[1]),_(d(y(Te,j),-E[1]),d(y(X,O),F[1]))),B[2]),d(_(d(y(ie,ue),S[1]),_(d(y(le,V),-E[1]),d(y(X,O),B[1]))),-F[2]))),-z[3])),_(d(_(_(d(_(d(y(Se,xe),E[1]),_(d(y(me,K),-B[1]),d(y(ie,ue),z[1]))),S[2]),d(_(d(y(Se,xe),S[1]),_(d(y(be,H),-B[1]),d(y(le,V),z[1]))),-E[2])),_(d(_(d(y(me,K),S[1]),_(d(y(be,H),-E[1]),d(y(X,O),z[1]))),B[2]),d(_(d(y(ie,ue),S[1]),_(d(y(le,V),-E[1]),d(y(X,O),B[1]))),-z[2]))),F[3]),d(_(_(d(_(d(y(Xe,oe),k[1]),_(d(y(He,q),-B[1]),d(y(se,ne),F[1]))),E[2]),d(_(d(y(Xe,oe),E[1]),_(d(y(Ce,te),-B[1]),d(y(ie,ue),F[1]))),-k[2])),_(d(_(d(y(He,q),E[1]),_(d(y(Ce,te),-k[1]),d(y(ee,re),F[1]))),B[2]),d(_(d(y(se,ne),E[1]),_(d(y(ie,ue),-k[1]),d(y(ee,re),B[1]))),-F[2]))),S[3]))),_(_(d(_(_(d(_(d(y(Xe,oe),k[1]),_(d(y(He,q),-B[1]),d(y(se,ne),F[1]))),S[2]),d(_(d(y(Xe,oe),S[1]),_(d(y(Te,j),-B[1]),d(y(le,V),F[1]))),-k[2])),_(d(_(d(y(He,q),S[1]),_(d(y(Te,j),-k[1]),d(y(Y,N),F[1]))),B[2]),d(_(d(y(se,ne),S[1]),_(d(y(le,V),-k[1]),d(y(Y,N),B[1]))),-F[2]))),-E[3]),d(_(_(d(_(d(y(Xe,oe),E[1]),_(d(y(Ce,te),-B[1]),d(y(ie,ue),F[1]))),S[2]),d(_(d(y(Xe,oe),S[1]),_(d(y(Te,j),-B[1]),d(y(le,V),F[1]))),-E[2])),_(d(_(d(y(Ce,te),S[1]),_(d(y(Te,j),-E[1]),d(y(X,O),F[1]))),B[2]),d(_(d(y(ie,ue),S[1]),_(d(y(le,V),-E[1]),d(y(X,O),B[1]))),-F[2]))),k[3])),_(d(_(_(d(_(d(y(He,q),E[1]),_(d(y(Ce,te),-k[1]),d(y(ee,re),F[1]))),S[2]),d(_(d(y(He,q),S[1]),_(d(y(Te,j),-k[1]),d(y(Y,N),F[1]))),-E[2])),_(d(_(d(y(Ce,te),S[1]),_(d(y(Te,j),-E[1]),d(y(X,O),F[1]))),k[2]),d(_(d(y(ee,re),S[1]),_(d(y(Y,N),-E[1]),d(y(X,O),k[1]))),-F[2]))),-B[3]),d(_(_(d(_(d(y(se,ne),E[1]),_(d(y(ie,ue),-k[1]),d(y(ee,re),B[1]))),S[2]),d(_(d(y(se,ne),S[1]),_(d(y(le,V),-k[1]),d(y(Y,N),B[1]))),-E[2])),_(d(_(d(y(ie,ue),S[1]),_(d(y(le,V),-E[1]),d(y(X,O),B[1]))),k[2]),d(_(d(y(ee,re),S[1]),_(d(y(Y,N),-E[1]),d(y(X,O),k[1]))),-B[2]))),F[3]))))),We=_(_(_(d(_(_(d(_(d(y(Be,De),B[1]),_(d(y(Xe,oe),-z[1]),d(y(Se,xe),F[1]))),k[2]),d(_(d(y(Be,De),k[1]),_(d(y(He,q),-z[1]),d(y(_e,J),F[1]))),-B[2])),_(d(_(d(y(Xe,oe),k[1]),_(d(y(He,q),-B[1]),d(y(se,ne),F[1]))),z[2]),d(_(d(y(Se,xe),k[1]),_(d(y(_e,J),-B[1]),d(y(se,ne),z[1]))),-F[2]))),S[3]),_(d(_(_(d(_(d(y(Be,De),B[1]),_(d(y(Xe,oe),-z[1]),d(y(Se,xe),F[1]))),S[2]),d(_(d(y(Be,De),S[1]),_(d(y(Te,j),-z[1]),d(y(be,H),F[1]))),-B[2])),_(d(_(d(y(Xe,oe),S[1]),_(d(y(Te,j),-B[1]),d(y(le,V),F[1]))),z[2]),d(_(d(y(Se,xe),S[1]),_(d(y(be,H),-B[1]),d(y(le,V),z[1]))),-F[2]))),-k[3]),d(_(_(d(_(d(y(Be,De),k[1]),_(d(y(He,q),-z[1]),d(y(_e,J),F[1]))),S[2]),d(_(d(y(Be,De),S[1]),_(d(y(Te,j),-z[1]),d(y(be,H),F[1]))),-k[2])),_(d(_(d(y(He,q),S[1]),_(d(y(Te,j),-k[1]),d(y(Y,N),F[1]))),z[2]),d(_(d(y(_e,J),S[1]),_(d(y(be,H),-k[1]),d(y(Y,N),z[1]))),-F[2]))),B[3]))),_(_(d(_(_(d(_(d(y(Xe,oe),k[1]),_(d(y(He,q),-B[1]),d(y(se,ne),F[1]))),S[2]),d(_(d(y(Xe,oe),S[1]),_(d(y(Te,j),-B[1]),d(y(le,V),F[1]))),-k[2])),_(d(_(d(y(He,q),S[1]),_(d(y(Te,j),-k[1]),d(y(Y,N),F[1]))),B[2]),d(_(d(y(se,ne),S[1]),_(d(y(le,V),-k[1]),d(y(Y,N),B[1]))),-F[2]))),-z[3]),d(_(_(d(_(d(y(Se,xe),k[1]),_(d(y(_e,J),-B[1]),d(y(se,ne),z[1]))),S[2]),d(_(d(y(Se,xe),S[1]),_(d(y(be,H),-B[1]),d(y(le,V),z[1]))),-k[2])),_(d(_(d(y(_e,J),S[1]),_(d(y(be,H),-k[1]),d(y(Y,N),z[1]))),B[2]),d(_(d(y(se,ne),S[1]),_(d(y(le,V),-k[1]),d(y(Y,N),B[1]))),-z[2]))),F[3])),_(d(_(_(d(_(d(y(Be,De),k[1]),_(d(y(He,q),-z[1]),d(y(_e,J),F[1]))),E[2]),d(_(d(y(Be,De),E[1]),_(d(y(Ce,te),-z[1]),d(y(me,K),F[1]))),-k[2])),_(d(_(d(y(He,q),E[1]),_(d(y(Ce,te),-k[1]),d(y(ee,re),F[1]))),z[2]),d(_(d(y(_e,J),E[1]),_(d(y(me,K),-k[1]),d(y(ee,re),z[1]))),-F[2]))),S[3]),d(_(_(d(_(d(y(Be,De),k[1]),_(d(y(He,q),-z[1]),d(y(_e,J),F[1]))),S[2]),d(_(d(y(Be,De),S[1]),_(d(y(Te,j),-z[1]),d(y(be,H),F[1]))),-k[2])),_(d(_(d(y(He,q),S[1]),_(d(y(Te,j),-k[1]),d(y(Y,N),F[1]))),z[2]),d(_(d(y(_e,J),S[1]),_(d(y(be,H),-k[1]),d(y(Y,N),z[1]))),-F[2]))),-E[3])))),_(_(_(d(_(_(d(_(d(y(Be,De),E[1]),_(d(y(Ce,te),-z[1]),d(y(me,K),F[1]))),S[2]),d(_(d(y(Be,De),S[1]),_(d(y(Te,j),-z[1]),d(y(be,H),F[1]))),-E[2])),_(d(_(d(y(Ce,te),S[1]),_(d(y(Te,j),-E[1]),d(y(X,O),F[1]))),z[2]),d(_(d(y(me,K),S[1]),_(d(y(be,H),-E[1]),d(y(X,O),z[1]))),-F[2]))),k[3]),d(_(_(d(_(d(y(He,q),E[1]),_(d(y(Ce,te),-k[1]),d(y(ee,re),F[1]))),S[2]),d(_(d(y(He,q),S[1]),_(d(y(Te,j),-k[1]),d(y(Y,N),F[1]))),-E[2])),_(d(_(d(y(Ce,te),S[1]),_(d(y(Te,j),-E[1]),d(y(X,O),F[1]))),k[2]),d(_(d(y(ee,re),S[1]),_(d(y(Y,N),-E[1]),d(y(X,O),k[1]))),-F[2]))),-z[3])),_(d(_(_(d(_(d(y(_e,J),E[1]),_(d(y(me,K),-k[1]),d(y(ee,re),z[1]))),S[2]),d(_(d(y(_e,J),S[1]),_(d(y(be,H),-k[1]),d(y(Y,N),z[1]))),-E[2])),_(d(_(d(y(me,K),S[1]),_(d(y(be,H),-E[1]),d(y(X,O),z[1]))),k[2]),d(_(d(y(ee,re),S[1]),_(d(y(Y,N),-E[1]),d(y(X,O),k[1]))),-z[2]))),F[3]),d(_(_(d(_(d(y(Se,xe),k[1]),_(d(y(_e,J),-B[1]),d(y(se,ne),z[1]))),E[2]),d(_(d(y(Se,xe),E[1]),_(d(y(me,K),-B[1]),d(y(ie,ue),z[1]))),-k[2])),_(d(_(d(y(_e,J),E[1]),_(d(y(me,K),-k[1]),d(y(ee,re),z[1]))),B[2]),d(_(d(y(se,ne),E[1]),_(d(y(ie,ue),-k[1]),d(y(ee,re),B[1]))),-z[2]))),S[3]))),_(_(d(_(_(d(_(d(y(Se,xe),k[1]),_(d(y(_e,J),-B[1]),d(y(se,ne),z[1]))),S[2]),d(_(d(y(Se,xe),S[1]),_(d(y(be,H),-B[1]),d(y(le,V),z[1]))),-k[2])),_(d(_(d(y(_e,J),S[1]),_(d(y(be,H),-k[1]),d(y(Y,N),z[1]))),B[2]),d(_(d(y(se,ne),S[1]),_(d(y(le,V),-k[1]),d(y(Y,N),B[1]))),-z[2]))),-E[3]),d(_(_(d(_(d(y(Se,xe),E[1]),_(d(y(me,K),-B[1]),d(y(ie,ue),z[1]))),S[2]),d(_(d(y(Se,xe),S[1]),_(d(y(be,H),-B[1]),d(y(le,V),z[1]))),-E[2])),_(d(_(d(y(me,K),S[1]),_(d(y(be,H),-E[1]),d(y(X,O),z[1]))),B[2]),d(_(d(y(ie,ue),S[1]),_(d(y(le,V),-E[1]),d(y(X,O),B[1]))),-z[2]))),k[3])),_(d(_(_(d(_(d(y(_e,J),E[1]),_(d(y(me,K),-k[1]),d(y(ee,re),z[1]))),S[2]),d(_(d(y(_e,J),S[1]),_(d(y(be,H),-k[1]),d(y(Y,N),z[1]))),-E[2])),_(d(_(d(y(me,K),S[1]),_(d(y(be,H),-E[1]),d(y(X,O),z[1]))),k[2]),d(_(d(y(ee,re),S[1]),_(d(y(Y,N),-E[1]),d(y(X,O),k[1]))),-z[2]))),-B[3]),d(_(_(d(_(d(y(se,ne),E[1]),_(d(y(ie,ue),-k[1]),d(y(ee,re),B[1]))),S[2]),d(_(d(y(se,ne),S[1]),_(d(y(le,V),-k[1]),d(y(Y,N),B[1]))),-E[2])),_(d(_(d(y(ie,ue),S[1]),_(d(y(le,V),-E[1]),d(y(X,O),B[1]))),k[2]),d(_(d(y(ee,re),S[1]),_(d(y(Y,N),-E[1]),d(y(X,O),k[1]))),-B[2]))),z[3]))))),vt=y(Re,We);return vt[vt.length-1]}return C}var l=[o,s,m];function b(_){var y=l[_.length];return y||(y=l[_.length]=f(_.length)),y.apply(void 0,_)}function c(_,y,w,d,C,S,E,k){function B(z,F,I,O,N,V){switch(arguments.length){case 0:case 1:return 0;case 2:return d(z,F);case 3:return C(z,F,I);case 4:return S(z,F,I,O);case 5:return E(z,F,I,O,N);case 6:return k(z,F,I,O,N,V)}for(var H=new Array(arguments.length),j=0;j<arguments.length;++j)H[j]=arguments[j];return _(H)}return B}function M(){for(;l.length<=r;)l.push(f(l.length));A.exports=c.apply(void 0,[b].concat(l));for(var _=0;_<=r;++_)A.exports[_]=l[_]}M()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(u,A,T){var e=u("robust-determinant"),i=6;function n(l){var b=l===2?f:l===3?o:l===4?s:l===5?m:g;return l<6?b(e[l]):b(e)}function a(){return[[0]]}function r(l,b){return[[b[0]],[l[0][0]]]}function f(l){return function(c,M){return[l([[+M[0],+c[0][1]],[+M[1],+c[1][1]]]),l([[+c[0][0],+M[0]],[+c[1][0],+M[1]]]),l(c)]}}function o(l){return function(c,M){return[l([[+M[0],+c[0][1],+c[0][2]],[+M[1],+c[1][1],+c[1][2]],[+M[2],+c[2][1],+c[2][2]]]),l([[+c[0][0],+M[0],+c[0][2]],[+c[1][0],+M[1],+c[1][2]],[+c[2][0],+M[2],+c[2][2]]]),l([[+c[0][0],+c[0][1],+M[0]],[+c[1][0],+c[1][1],+M[1]],[+c[2][0],+c[2][1],+M[2]]]),l(c)]}}function s(l){return function(c,M){return[l([[+M[0],+c[0][1],+c[0][2],+c[0][3]],[+M[1],+c[1][1],+c[1][2],+c[1][3]],[+M[2],+c[2][1],+c[2][2],+c[2][3]],[+M[3],+c[3][1],+c[3][2],+c[3][3]]]),l([[+c[0][0],+M[0],+c[0][2],+c[0][3]],[+c[1][0],+M[1],+c[1][2],+c[1][3]],[+c[2][0],+M[2],+c[2][2],+c[2][3]],[+c[3][0],+M[3],+c[3][2],+c[3][3]]]),l([[+c[0][0],+c[0][1],+M[0],+c[0][3]],[+c[1][0],+c[1][1],+M[1],+c[1][3]],[+c[2][0],+c[2][1],+M[2],+c[2][3]],[+c[3][0],+c[3][1],+M[3],+c[3][3]]]),l([[+c[0][0],+c[0][1],+c[0][2],+M[0]],[+c[1][0],+c[1][1],+c[1][2],+M[1]],[+c[2][0],+c[2][1],+c[2][2],+M[2]],[+c[3][0],+c[3][1],+c[3][2],+M[3]]]),l(c)]}}function m(l){return function(c,M){return[l([[+M[0],+c[0][1],+c[0][2],+c[0][3],+c[0][4]],[+M[1],+c[1][1],+c[1][2],+c[1][3],+c[1][4]],[+M[2],+c[2][1],+c[2][2],+c[2][3],+c[2][4]],[+M[3],+c[3][1],+c[3][2],+c[3][3],+c[3][4]],[+M[4],+c[4][1],+c[4][2],+c[4][3],+c[4][4]]]),l([[+c[0][0],+M[0],+c[0][2],+c[0][3],+c[0][4]],[+c[1][0],+M[1],+c[1][2],+c[1][3],+c[1][4]],[+c[2][0],+M[2],+c[2][2],+c[2][3],+c[2][4]],[+c[3][0],+M[3],+c[3][2],+c[3][3],+c[3][4]],[+c[4][0],+M[4],+c[4][2],+c[4][3],+c[4][4]]]),l([[+c[0][0],+c[0][1],+M[0],+c[0][3],+c[0][4]],[+c[1][0],+c[1][1],+M[1],+c[1][3],+c[1][4]],[+c[2][0],+c[2][1],+M[2],+c[2][3],+c[2][4]],[+c[3][0],+c[3][1],+M[3],+c[3][3],+c[3][4]],[+c[4][0],+c[4][1],+M[4],+c[4][3],+c[4][4]]]),l([[+c[0][0],+c[0][1],+c[0][2],+M[0],+c[0][4]],[+c[1][0],+c[1][1],+c[1][2],+M[1],+c[1][4]],[+c[2][0],+c[2][1],+c[2][2],+M[2],+c[2][4]],[+c[3][0],+c[3][1],+c[3][2],+M[3],+c[3][4]],[+c[4][0],+c[4][1],+c[4][2],+M[4],+c[4][4]]]),l([[+c[0][0],+c[0][1],+c[0][2],+c[0][3],+M[0]],[+c[1][0],+c[1][1],+c[1][2],+c[1][3],+M[1]],[+c[2][0],+c[2][1],+c[2][2],+c[2][3],+M[2]],[+c[3][0],+c[3][1],+c[3][2],+c[3][3],+M[3]],[+c[4][0],+c[4][1],+c[4][2],+c[4][3],+M[4]]]),l(c)]}}function g(l){return function(c,M){return[l([[+M[0],+c[0][1],+c[0][2],+c[0][3],+c[0][4],+c[0][5]],[+M[1],+c[1][1],+c[1][2],+c[1][3],+c[1][4],+c[1][5]],[+M[2],+c[2][1],+c[2][2],+c[2][3],+c[2][4],+c[2][5]],[+M[3],+c[3][1],+c[3][2],+c[3][3],+c[3][4],+c[3][5]],[+M[4],+c[4][1],+c[4][2],+c[4][3],+c[4][4],+c[4][5]],[+M[5],+c[5][1],+c[5][2],+c[5][3],+c[5][4],+c[5][5]]]),l([[+c[0][0],+M[0],+c[0][2],+c[0][3],+c[0][4],+c[0][5]],[+c[1][0],+M[1],+c[1][2],+c[1][3],+c[1][4],+c[1][5]],[+c[2][0],+M[2],+c[2][2],+c[2][3],+c[2][4],+c[2][5]],[+c[3][0],+M[3],+c[3][2],+c[3][3],+c[3][4],+c[3][5]],[+c[4][0],+M[4],+c[4][2],+c[4][3],+c[4][4],+c[4][5]],[+c[5][0],+M[5],+c[5][2],+c[5][3],+c[5][4],+c[5][5]]]),l([[+c[0][0],+c[0][1],+M[0],+c[0][3],+c[0][4],+c[0][5]],[+c[1][0],+c[1][1],+M[1],+c[1][3],+c[1][4],+c[1][5]],[+c[2][0],+c[2][1],+M[2],+c[2][3],+c[2][4],+c[2][5]],[+c[3][0],+c[3][1],+M[3],+c[3][3],+c[3][4],+c[3][5]],[+c[4][0],+c[4][1],+M[4],+c[4][3],+c[4][4],+c[4][5]],[+c[5][0],+c[5][1],+M[5],+c[5][3],+c[5][4],+c[5][5]]]),l([[+c[0][0],+c[0][1],+c[0][2],+M[0],+c[0][4],+c[0][5]],[+c[1][0],+c[1][1],+c[1][2],+M[1],+c[1][4],+c[1][5]],[+c[2][0],+c[2][1],+c[2][2],+M[2],+c[2][4],+c[2][5]],[+c[3][0],+c[3][1],+c[3][2],+M[3],+c[3][4],+c[3][5]],[+c[4][0],+c[4][1],+c[4][2],+M[4],+c[4][4],+c[4][5]],[+c[5][0],+c[5][1],+c[5][2],+M[5],+c[5][4],+c[5][5]]]),l([[+c[0][0],+c[0][1],+c[0][2],+c[0][3],+M[0],+c[0][5]],[+c[1][0],+c[1][1],+c[1][2],+c[1][3],+M[1],+c[1][5]],[+c[2][0],+c[2][1],+c[2][2],+c[2][3],+M[2],+c[2][5]],[+c[3][0],+c[3][1],+c[3][2],+c[3][3],+M[3],+c[3][5]],[+c[4][0],+c[4][1],+c[4][2],+c[4][3],+M[4],+c[4][5]],[+c[5][0],+c[5][1],+c[5][2],+c[5][3],+M[5],+c[5][5]]]),l([[+c[0][0],+c[0][1],+c[0][2],+c[0][3],+c[0][4],+M[0]],[+c[1][0],+c[1][1],+c[1][2],+c[1][3],+c[1][4],+M[1]],[+c[2][0],+c[2][1],+c[2][2],+c[2][3],+c[2][4],+M[2]],[+c[3][0],+c[3][1],+c[3][2],+c[3][3],+c[3][4],+M[3]],[+c[4][0],+c[4][1],+c[4][2],+c[4][3],+c[4][4],+M[4]],[+c[5][0],+c[5][1],+c[5][2],+c[5][3],+c[5][4],+M[5]]]),l(c)]}}var p=[a,r];function v(l,b,c,M,_,y,w,d){return function(S,E){switch(S.length){case 0:return l(S,E);case 1:return b(S,E);case 2:return c(S,E);case 3:return M(S,E);case 4:return _(S,E);case 5:return y(S,E)}var k=w[S.length];return k||(k=w[S.length]=d(S.length)),k(S,E)}}function x(){for(;p.length<i;)p.push(n(p.length));A.exports=v.apply(void 0,p.concat([p,n]));for(var l=0;l<i;++l)A.exports[l]=p[l]}x()},{"robust-determinant":280}],284:[function(u,A,T){var e=u("two-product"),i=u("robust-sum"),n=u("robust-scale"),a=u("robust-subtract"),r=5,f=11102230246251565e-32,o=(3+16*f)*f,s=(7+56*f)*f;function m(y,w,d,C){return function(E,k,B){var z=y(y(w(k[1],B[0]),w(-B[1],k[0])),y(w(E[1],k[0]),w(-k[1],E[0]))),F=y(w(E[1],B[0]),w(-B[1],E[0])),I=C(z,F);return I[I.length-1]}}function g(y,w,d,C){return function(E,k,B,z){var F=y(y(d(y(w(B[1],z[0]),w(-z[1],B[0])),k[2]),y(d(y(w(k[1],z[0]),w(-z[1],k[0])),-B[2]),d(y(w(k[1],B[0]),w(-B[1],k[0])),z[2]))),y(d(y(w(k[1],z[0]),w(-z[1],k[0])),E[2]),y(d(y(w(E[1],z[0]),w(-z[1],E[0])),-k[2]),d(y(w(E[1],k[0]),w(-k[1],E[0])),z[2])))),I=y(y(d(y(w(B[1],z[0]),w(-z[1],B[0])),E[2]),y(d(y(w(E[1],z[0]),w(-z[1],E[0])),-B[2]),d(y(w(E[1],B[0]),w(-B[1],E[0])),z[2]))),y(d(y(w(k[1],B[0]),w(-B[1],k[0])),E[2]),y(d(y(w(E[1],B[0]),w(-B[1],E[0])),-k[2]),d(y(w(E[1],k[0]),w(-k[1],E[0])),B[2])))),O=C(F,I);return O[O.length-1]}}function p(y,w,d,C){return function(E,k,B,z,F){var I=y(y(y(d(y(d(y(w(z[1],F[0]),w(-F[1],z[0])),B[2]),y(d(y(w(B[1],F[0]),w(-F[1],B[0])),-z[2]),d(y(w(B[1],z[0]),w(-z[1],B[0])),F[2]))),k[3]),y(d(y(d(y(w(z[1],F[0]),w(-F[1],z[0])),k[2]),y(d(y(w(k[1],F[0]),w(-F[1],k[0])),-z[2]),d(y(w(k[1],z[0]),w(-z[1],k[0])),F[2]))),-B[3]),d(y(d(y(w(B[1],F[0]),w(-F[1],B[0])),k[2]),y(d(y(w(k[1],F[0]),w(-F[1],k[0])),-B[2]),d(y(w(k[1],B[0]),w(-B[1],k[0])),F[2]))),z[3]))),y(d(y(d(y(w(B[1],z[0]),w(-z[1],B[0])),k[2]),y(d(y(w(k[1],z[0]),w(-z[1],k[0])),-B[2]),d(y(w(k[1],B[0]),w(-B[1],k[0])),z[2]))),-F[3]),y(d(y(d(y(w(z[1],F[0]),w(-F[1],z[0])),k[2]),y(d(y(w(k[1],F[0]),w(-F[1],k[0])),-z[2]),d(y(w(k[1],z[0]),w(-z[1],k[0])),F[2]))),E[3]),d(y(d(y(w(z[1],F[0]),w(-F[1],z[0])),E[2]),y(d(y(w(E[1],F[0]),w(-F[1],E[0])),-z[2]),d(y(w(E[1],z[0]),w(-z[1],E[0])),F[2]))),-k[3])))),y(y(d(y(d(y(w(k[1],F[0]),w(-F[1],k[0])),E[2]),y(d(y(w(E[1],F[0]),w(-F[1],E[0])),-k[2]),d(y(w(E[1],k[0]),w(-k[1],E[0])),F[2]))),z[3]),y(d(y(d(y(w(k[1],z[0]),w(-z[1],k[0])),E[2]),y(d(y(w(E[1],z[0]),w(-z[1],E[0])),-k[2]),d(y(w(E[1],k[0]),w(-k[1],E[0])),z[2]))),-F[3]),d(y(d(y(w(B[1],z[0]),w(-z[1],B[0])),k[2]),y(d(y(w(k[1],z[0]),w(-z[1],k[0])),-B[2]),d(y(w(k[1],B[0]),w(-B[1],k[0])),z[2]))),E[3]))),y(d(y(d(y(w(B[1],z[0]),w(-z[1],B[0])),E[2]),y(d(y(w(E[1],z[0]),w(-z[1],E[0])),-B[2]),d(y(w(E[1],B[0]),w(-B[1],E[0])),z[2]))),-k[3]),y(d(y(d(y(w(k[1],z[0]),w(-z[1],k[0])),E[2]),y(d(y(w(E[1],z[0]),w(-z[1],E[0])),-k[2]),d(y(w(E[1],k[0]),w(-k[1],E[0])),z[2]))),B[3]),d(y(d(y(w(k[1],B[0]),w(-B[1],k[0])),E[2]),y(d(y(w(E[1],B[0]),w(-B[1],E[0])),-k[2]),d(y(w(E[1],k[0]),w(-k[1],E[0])),B[2]))),-z[3]))))),O=y(y(y(d(y(d(y(w(z[1],F[0]),w(-F[1],z[0])),B[2]),y(d(y(w(B[1],F[0]),w(-F[1],B[0])),-z[2]),d(y(w(B[1],z[0]),w(-z[1],B[0])),F[2]))),E[3]),d(y(d(y(w(z[1],F[0]),w(-F[1],z[0])),E[2]),y(d(y(w(E[1],F[0]),w(-F[1],E[0])),-z[2]),d(y(w(E[1],z[0]),w(-z[1],E[0])),F[2]))),-B[3])),y(d(y(d(y(w(B[1],F[0]),w(-F[1],B[0])),E[2]),y(d(y(w(E[1],F[0]),w(-F[1],E[0])),-B[2]),d(y(w(E[1],B[0]),w(-B[1],E[0])),F[2]))),z[3]),d(y(d(y(w(B[1],z[0]),w(-z[1],B[0])),E[2]),y(d(y(w(E[1],z[0]),w(-z[1],E[0])),-B[2]),d(y(w(E[1],B[0]),w(-B[1],E[0])),z[2]))),-F[3]))),y(y(d(y(d(y(w(B[1],F[0]),w(-F[1],B[0])),k[2]),y(d(y(w(k[1],F[0]),w(-F[1],k[0])),-B[2]),d(y(w(k[1],B[0]),w(-B[1],k[0])),F[2]))),E[3]),d(y(d(y(w(B[1],F[0]),w(-F[1],B[0])),E[2]),y(d(y(w(E[1],F[0]),w(-F[1],E[0])),-B[2]),d(y(w(E[1],B[0]),w(-B[1],E[0])),F[2]))),-k[3])),y(d(y(d(y(w(k[1],F[0]),w(-F[1],k[0])),E[2]),y(d(y(w(E[1],F[0]),w(-F[1],E[0])),-k[2]),d(y(w(E[1],k[0]),w(-k[1],E[0])),F[2]))),B[3]),d(y(d(y(w(k[1],B[0]),w(-B[1],k[0])),E[2]),y(d(y(w(E[1],B[0]),w(-B[1],E[0])),-k[2]),d(y(w(E[1],k[0]),w(-k[1],E[0])),B[2]))),-F[3])))),N=C(I,O);return N[N.length-1]}}function v(y){var w=y===3?m:y===4?g:p;return w(i,e,n,a)}var x=v(3),l=v(4),b=[function(){return 0},function(){return 0},function(w,d){return d[0]-w[0]},function(w,d,C){var S=(w[1]-C[1])*(d[0]-C[0]),E=(w[0]-C[0])*(d[1]-C[1]),k=S-E,B;if(S>0){if(E<=0)return k;B=S+E}else if(S<0){if(E>=0)return k;B=-(S+E)}else return k;var z=o*B;return k>=z||k<=-z?k:x(w,d,C)},function(w,d,C,S){var E=w[0]-S[0],k=d[0]-S[0],B=C[0]-S[0],z=w[1]-S[1],F=d[1]-S[1],I=C[1]-S[1],O=w[2]-S[2],N=d[2]-S[2],V=C[2]-S[2],H=k*I,j=B*F,Z=B*z,X=E*I,re=E*F,ue=k*z,K=O*(H-j)+N*(Z-X)+V*(re-ue),te=(Math.abs(H)+Math.abs(j))*Math.abs(O)+(Math.abs(Z)+Math.abs(X))*Math.abs(N)+(Math.abs(re)+Math.abs(ue))*Math.abs(V),G=s*te;return K>G||-K>G?K:l(w,d,C,S)}];function c(y){var w=b[y.length];return w||(w=b[y.length]=v(y.length)),w.apply(void 0,y)}function M(y,w,d,C,S,E,k){return function(z,F,I,O,N){switch(arguments.length){case 0:case 1:return 0;case 2:return C(z,F);case 3:return S(z,F,I);case 4:return E(z,F,I,O);case 5:return k(z,F,I,O,N)}for(var V=new Array(arguments.length),H=0;H<arguments.length;++H)V[H]=arguments[H];return y(V)}}function _(){for(;b.length<=r;)b.push(v(b.length));A.exports=M.apply(void 0,[c].concat(b));for(var y=0;y<=r;++y)A.exports[y]=b[y]}_()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(u,A,T){var e=u("robust-sum"),i=u("robust-scale");A.exports=n;function n(a,r){if(a.length===1)return i(r,a[0]);if(r.length===1)return i(a,r[0]);if(a.length===0||r.length===0)return[0];var f=[0];if(a.length<r.length)for(var o=0;o<a.length;++o)f=e(f,i(r,a[o]));else for(var o=0;o<r.length;++o)f=e(f,i(a,r[o]));return f}},{"robust-scale":286,"robust-sum":289}],286:[function(u,A,T){var e=u("two-product"),i=u("two-sum");A.exports=n;function n(a,r){var f=a.length;if(f===1){var o=e(a[0],r);return o[0]?o:[o[1]]}var s=new Array(2*f),m=[.1,.1],g=[.1,.1],p=0;e(a[0],r,m),m[0]&&(s[p++]=m[0]);for(var v=1;v<f;++v){e(a[v],r,g);var x=m[1];i(x,g[0],m),m[0]&&(s[p++]=m[0]);var l=g[1],b=m[1],c=l+b,M=c-l,_=b-M;m[1]=c,_&&(s[p++]=_)}return m[1]&&(s[p++]=m[1]),p===0&&(s[p++]=0),s.length=p,s}},{"two-product":306,"two-sum":307}],287:[function(u,A,T){A.exports=n;var e=u("robust-orientation")[3];function i(a,r,f,o){for(var s=0;s<2;++s){var m=a[s],g=r[s],p=Math.min(m,g),v=Math.max(m,g),x=f[s],l=o[s],b=Math.min(x,l),c=Math.max(x,l);if(c<p||v<b)return!1}return!0}function n(a,r,f,o){var s=e(a,f,o),m=e(r,f,o);if(s>0&&m>0||s<0&&m<0)return!1;var g=e(f,a,r),p=e(o,a,r);return g>0&&p>0||g<0&&p<0?!1:s===0&&m===0&&g===0&&p===0?i(a,r,f,o):!0}},{"robust-orientation":284}],288:[function(u,A,T){A.exports=i;function e(n,a){var r=n+a,f=r-n,o=r-f,s=a-f,m=n-o,g=m+s;return g?[g,r]:[r]}function i(n,a){var r=n.length|0,f=a.length|0;if(r===1&&f===1)return e(n[0],-a[0]);var o=r+f,s=new Array(o),m=0,g=0,p=0,v=Math.abs,x=n[g],l=v(x),b=-a[p],c=v(b),M,_;l<c?(_=x,g+=1,g<r&&(x=n[g],l=v(x))):(_=b,p+=1,p<f&&(b=-a[p],c=v(b))),g<r&&l<c||p>=f?(M=x,g+=1,g<r&&(x=n[g],l=v(x))):(M=b,p+=1,p<f&&(b=-a[p],c=v(b)));for(var y=M+_,w=y-M,d=_-w,C=d,S=y,E,k,B,z,F;g<r&&p<f;)l<c?(M=x,g+=1,g<r&&(x=n[g],l=v(x))):(M=b,p+=1,p<f&&(b=-a[p],c=v(b))),_=C,y=M+_,w=y-M,d=_-w,d&&(s[m++]=d),E=S+y,k=E-S,B=E-k,z=y-k,F=S-B,C=F+z,S=E;for(;g<r;)M=x,_=C,y=M+_,w=y-M,d=_-w,d&&(s[m++]=d),E=S+y,k=E-S,B=E-k,z=y-k,F=S-B,C=F+z,S=E,g+=1,g<r&&(x=n[g]);for(;p<f;)M=b,_=C,y=M+_,w=y-M,d=_-w,d&&(s[m++]=d),E=S+y,k=E-S,B=E-k,z=y-k,F=S-B,C=F+z,S=E,p+=1,p<f&&(b=-a[p]);return C&&(s[m++]=C),S&&(s[m++]=S),m||(s[m++]=0),s.length=m,s}},{}],289:[function(u,A,T){A.exports=i;function e(n,a){var r=n+a,f=r-n,o=r-f,s=a-f,m=n-o,g=m+s;return g?[g,r]:[r]}function i(n,a){var r=n.length|0,f=a.length|0;if(r===1&&f===1)return e(n[0],a[0]);var o=r+f,s=new Array(o),m=0,g=0,p=0,v=Math.abs,x=n[g],l=v(x),b=a[p],c=v(b),M,_;l<c?(_=x,g+=1,g<r&&(x=n[g],l=v(x))):(_=b,p+=1,p<f&&(b=a[p],c=v(b))),g<r&&l<c||p>=f?(M=x,g+=1,g<r&&(x=n[g],l=v(x))):(M=b,p+=1,p<f&&(b=a[p],c=v(b)));for(var y=M+_,w=y-M,d=_-w,C=d,S=y,E,k,B,z,F;g<r&&p<f;)l<c?(M=x,g+=1,g<r&&(x=n[g],l=v(x))):(M=b,p+=1,p<f&&(b=a[p],c=v(b))),_=C,y=M+_,w=y-M,d=_-w,d&&(s[m++]=d),E=S+y,k=E-S,B=E-k,z=y-k,F=S-B,C=F+z,S=E;for(;g<r;)M=x,_=C,y=M+_,w=y-M,d=_-w,d&&(s[m++]=d),E=S+y,k=E-S,B=E-k,z=y-k,F=S-B,C=F+z,S=E,g+=1,g<r&&(x=n[g]);for(;p<f;)M=b,_=C,y=M+_,w=y-M,d=_-w,d&&(s[m++]=d),E=S+y,k=E-S,B=E-k,z=y-k,F=S-B,C=F+z,S=E,p+=1,p<f&&(b=a[p]);return C&&(s[m++]=C),S&&(s[m++]=S),m||(s[m++]=0),s.length=m,s}},{}],290:[function(u,A,T){A.exports=n;var e=u("boundary-cells"),i=u("reduce-simplicial-complex");function n(a){return i(e(a))}},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(u,A,T){A.exports=p;var e=u("ndarray"),i=u("typedarray-pool"),n=u("ndarray-sort"),a=u("./lib/codegen");function r(v){for(var x=v.length,l=0,b=0;b<x;++b)l=Math.max(l,v[b].length)|0;return l-1}function f(v,x){for(var l=v.length,b=i.mallocUint8(l),c=0;c<l;++c)b[c]=v[c]<x|0;return b}function o(v,x){for(var l=v.length,b=x*(x+1)/2*l|0,c=i.mallocUint32(b*2),M=0,_=0;_<l;++_)for(var y=v[_],x=y.length,w=0;w<x;++w)for(var d=0;d<w;++d){var C=y[d],S=y[w];c[M++]=Math.min(C,S)|0,c[M++]=Math.max(C,S)|0}var E=M/2|0;n(e(c,[E,2]));for(var k=2,_=2;_<M;_+=2)c[_-2]===c[_]&&c[_-1]===c[_+1]||(c[k++]=c[_],c[k++]=c[_+1]);return e(c,[k/2|0,2])}function s(v,x,l,b){for(var c=v.data,M=v.shape[0],_=i.mallocDouble(M),y=0,w=0;w<M;++w){var d=c[2*w],C=c[2*w+1];if(l[d]!==l[C]){var S=x[d],E=x[C];c[2*y]=d,c[2*y+1]=C,_[y++]=(E-b)/(E-S)}}return v.shape[0]=y,e(_,[y])}function m(v,x){var l=i.mallocInt32(x*2),b=v.shape[0],c=v.data;l[0]=0;for(var M=0,_=0;_<b;++_){var y=c[2*_];if(y!==M){for(l[2*M+1]=_;++M<y;)l[2*M]=_,l[2*M+1]=_;l[2*M]=_}}for(l[2*M+1]=b;++M<x;)l[2*M]=l[2*M+1]=b;return l}function g(v){for(var x=v.shape[0]|0,l=v.data,b=new Array(x),c=0;c<x;++c)b[c]=[l[2*c],l[2*c+1]];return b}function p(v,x,l,b){l=l||0,typeof b>"u"&&(b=r(v));var c=v.length;if(c===0||b<1)return{cells:[],vertexIds:[],vertexWeights:[]};var M=f(x,+l),_=o(v,b),y=s(_,x,M,+l),w=m(_,x.length|0),d=a(b)(v,_.data,w,M),C=g(_),S=[].slice.call(y.data,0,y.shape[0]);return i.free(M),i.free(_.data),i.free(y.data),i.free(w),{cells:d,vertexIds:C,vertexWeights:S}}},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(u,A,T){A.exports=i;var e=[function(){function a(r,f,o,s){for(var m=r.length,g=[],p=0;p<m;++p){var v=r[p];v.length}return g}return a},function(){function a(f,o,s,m){for(var g=Math.min(s,m)|0,p=Math.max(s,m)|0,v=f[2*g],x=f[2*g+1];v<x;){var l=v+x>>1,b=o[2*l+1];if(b===p)return l;p<b?x=l:v=l+1}return v}function r(f,o,s,m){for(var g=f.length,p=[],v=0;v<g;++v){var x=f[v],l=x.length;if(l===2){var b=(m[x[0]]<<0)+(m[x[1]]<<1);if(b===0||b===3)continue;switch(b){case 0:break;case 1:p.push([a(s,o,x[0],x[1])]);break;case 2:p.push([a(s,o,x[1],x[0])]);break}}}return p}return r},function(){function a(f,o,s,m){for(var g=Math.min(s,m)|0,p=Math.max(s,m)|0,v=f[2*g],x=f[2*g+1];v<x;){var l=v+x>>1,b=o[2*l+1];if(b===p)return l;p<b?x=l:v=l+1}return v}function r(f,o,s,m){for(var g=f.length,p=[],v=0;v<g;++v){var x=f[v],l=x.length;if(l===3){var b=(m[x[0]]<<0)+(m[x[1]]<<1)+(m[x[2]]<<2);if(b===0||b===7)continue;switch(b){case 0:break;case 1:p.push([a(s,o,x[0],x[2]),a(s,o,x[0],x[1])]);break;case 2:p.push([a(s,o,x[1],x[0]),a(s,o,x[1],x[2])]);break;case 3:p.push([a(s,o,x[0],x[2]),a(s,o,x[1],x[2])]);break;case 4:p.push([a(s,o,x[2],x[1]),a(s,o,x[2],x[0])]);break;case 5:p.push([a(s,o,x[2],x[1]),a(s,o,x[0],x[1])]);break;case 6:p.push([a(s,o,x[1],x[0]),a(s,o,x[2],x[0])]);break}}else if(l===2){var b=(m[x[0]]<<0)+(m[x[1]]<<1);if(b===0||b===3)continue;switch(b){case 0:break;case 1:p.push([a(s,o,x[0],x[1])]);break;case 2:p.push([a(s,o,x[1],x[0])]);break}}}return p}return r},function(){function a(f,o,s,m){for(var g=Math.min(s,m)|0,p=Math.max(s,m)|0,v=f[2*g],x=f[2*g+1];v<x;){var l=v+x>>1,b=o[2*l+1];if(b===p)return l;p<b?x=l:v=l+1}return v}function r(f,o,s,m){for(var g=f.length,p=[],v=0;v<g;++v){var x=f[v],l=x.length;if(l===4){var b=(m[x[0]]<<0)+(m[x[1]]<<1)+(m[x[2]]<<2)+(m[x[3]]<<3);if(b===0||b===15)continue;switch(b){case 0:break;case 1:p.push([a(s,o,x[0],x[1]),a(s,o,x[0],x[2]),a(s,o,x[0],x[3])]);break;case 2:p.push([a(s,o,x[1],x[2]),a(s,o,x[1],x[0]),a(s,o,x[1],x[3])]);break;case 3:p.push([a(s,o,x[1],x[2]),a(s,o,x[0],x[2]),a(s,o,x[0],x[3])],[a(s,o,x[1],x[3]),a(s,o,x[1],x[2]),a(s,o,x[0],x[3])]);break;case 4:p.push([a(s,o,x[2],x[0]),a(s,o,x[2],x[1]),a(s,o,x[2],x[3])]);break;case 5:p.push([a(s,o,x[0],x[1]),a(s,o,x[2],x[1]),a(s,o,x[0],x[3])],[a(s,o,x[2],x[1]),a(s,o,x[2],x[3]),a(s,o,x[0],x[3])]);break;case 6:p.push([a(s,o,x[2],x[0]),a(s,o,x[1],x[0]),a(s,o,x[1],x[3])],[a(s,o,x[2],x[3]),a(s,o,x[2],x[0]),a(s,o,x[1],x[3])]);break;case 7:p.push([a(s,o,x[0],x[3]),a(s,o,x[1],x[3]),a(s,o,x[2],x[3])]);break;case 8:p.push([a(s,o,x[3],x[1]),a(s,o,x[3],x[0]),a(s,o,x[3],x[2])]);break;case 9:p.push([a(s,o,x[3],x[1]),a(s,o,x[0],x[1]),a(s,o,x[0],x[2])],[a(s,o,x[3],x[2]),a(s,o,x[3],x[1]),a(s,o,x[0],x[2])]);break;case 10:p.push([a(s,o,x[1],x[0]),a(s,o,x[3],x[0]),a(s,o,x[1],x[2])],[a(s,o,x[3],x[0]),a(s,o,x[3],x[2]),a(s,o,x[1],x[2])]);break;case 11:p.push([a(s,o,x[1],x[2]),a(s,o,x[0],x[2]),a(s,o,x[3],x[2])]);break;case 12:p.push([a(s,o,x[3],x[0]),a(s,o,x[2],x[0]),a(s,o,x[2],x[1])],[a(s,o,x[3],x[1]),a(s,o,x[3],x[0]),a(s,o,x[2],x[1])]);break;case 13:p.push([a(s,o,x[0],x[1]),a(s,o,x[2],x[1]),a(s,o,x[3],x[1])]);break;case 14:p.push([a(s,o,x[2],x[0]),a(s,o,x[1],x[0]),a(s,o,x[3],x[0])]);break}}else if(l===3){var b=(m[x[0]]<<0)+(m[x[1]]<<1)+(m[x[2]]<<2);if(b===0||b===7)continue;switch(b){case 0:break;case 1:p.push([a(s,o,x[0],x[2]),a(s,o,x[0],x[1])]);break;case 2:p.push([a(s,o,x[1],x[0]),a(s,o,x[1],x[2])]);break;case 3:p.push([a(s,o,x[0],x[2]),a(s,o,x[1],x[2])]);break;case 4:p.push([a(s,o,x[2],x[1]),a(s,o,x[2],x[0])]);break;case 5:p.push([a(s,o,x[2],x[1]),a(s,o,x[0],x[1])]);break;case 6:p.push([a(s,o,x[1],x[0]),a(s,o,x[2],x[0])]);break}}else if(l===2){var b=(m[x[0]]<<0)+(m[x[1]]<<1);if(b===0||b===3)continue;switch(b){case 0:break;case 1:p.push([a(s,o,x[0],x[1])]);break;case 2:p.push([a(s,o,x[1],x[0])]);break}}}return p}return r}];function i(n){return e[n]()}},{}],293:[function(u,A,T){var e=u("bit-twiddle"),i=u("union-find");function n(y){for(var w=0,d=Math.max,C=0,S=y.length;C<S;++C)w=d(w,y[C].length);return w-1}T.dimension=n;function a(y){for(var w=-1,d=Math.max,C=0,S=y.length;C<S;++C)for(var E=y[C],k=0,B=E.length;k<B;++k)w=d(w,E[k]);return w+1}T.countVertices=a;function r(y){for(var w=new Array(y.length),d=0,C=y.length;d<C;++d)w[d]=y[d].slice(0);return w}T.cloneCells=r;function f(y,w){var d=y.length,C=y.length-w.length,S=Math.min;if(C)return C;switch(d){case 0:return 0;case 1:return y[0]-w[0];case 2:var F=y[0]+y[1]-w[0]-w[1];return F||S(y[0],y[1])-S(w[0],w[1]);case 3:var E=y[0]+y[1],k=w[0]+w[1];if(F=E+y[2]-(k+w[2]),F)return F;var B=S(y[0],y[1]),z=S(w[0],w[1]),F=S(B,y[2])-S(z,w[2]);return F||S(B+y[2],E)-S(z+w[2],k);default:var I=y.slice(0);I.sort();var O=w.slice(0);O.sort();for(var N=0;N<d;++N)if(C=I[N]-O[N],C)return C;return 0}}T.compareCells=f;function o(y,w){return f(y[0],w[0])}function s(y,w){if(w){for(var d=y.length,C=new Array(d),S=0;S<d;++S)C[S]=[y[S],w[S]];C.sort(o);for(var S=0;S<d;++S)y[S]=C[S][0],w[S]=C[S][1];return y}else return y.sort(f),y}T.normalize=s;function m(y){if(y.length===0)return[];for(var w=1,d=y.length,C=1;C<d;++C){var S=y[C];if(f(S,y[C-1])){if(C===w){w++;continue}y[w++]=S}}return y.length=w,y}T.unique=m;function g(y,w){for(var d=0,C=y.length-1,S=-1;d<=C;){var E=d+C>>1,k=f(y[E],w);k<=0?(k===0&&(S=E),d=E+1):k>0&&(C=E-1)}return S}T.findCell=g;function p(y,w){for(var d=new Array(y.length),C=0,S=d.length;C<S;++C)d[C]=[];for(var E=[],C=0,k=w.length;C<k;++C)for(var B=w[C],z=B.length,F=1,I=1<<z;F<I;++F){E.length=e.popCount(F);for(var O=0,N=0;N<z;++N)F&1<<N&&(E[O++]=B[N]);var V=g(y,E);if(!(V<0))for(;d[V++].push(C),!(V>=y.length||f(y[V],E)!==0););}return d}T.incidence=p;function v(y,w){if(!w)return p(m(l(y,0)),y);for(var d=new Array(w),C=0;C<w;++C)d[C]=[];for(var C=0,S=y.length;C<S;++C)for(var E=y[C],k=0,B=E.length;k<B;++k)d[E[k]].push(C);return d}T.dual=v;function x(y){for(var w=[],d=0,C=y.length;d<C;++d)for(var S=y[d],E=S.length|0,k=1,B=1<<E;k<B;++k){for(var z=[],F=0;F<E;++F)k>>>F&1&&z.push(S[F]);w.push(z)}return s(w)}T.explode=x;function l(y,w){if(w<0)return[];for(var d=[],C=(1<<w+1)-1,S=0;S<y.length;++S)for(var E=y[S],k=C;k<1<<E.length;k=e.nextCombination(k)){for(var B=new Array(w+1),z=0,F=0;F<E.length;++F)k&1<<F&&(B[z++]=E[F]);d.push(B)}return s(d)}T.skeleton=l;function b(y){for(var w=[],d=0,C=y.length;d<C;++d)for(var S=y[d],E=0,k=S.length;E<k;++E){for(var B=new Array(S.length-1),z=0,F=0;z<k;++z)z!==E&&(B[F++]=S[z]);w.push(B)}return s(w)}T.boundary=b;function c(y,w){for(var d=new i(w),C=0;C<y.length;++C)for(var S=y[C],E=0;E<S.length;++E)for(var k=E+1;k<S.length;++k)d.link(S[E],S[k]);for(var B=[],z=d.ranks,C=0;C<z.length;++C)z[C]=-1;for(var C=0;C<y.length;++C){var F=d.find(y[C][0]);z[F]<0?(z[F]=B.length,B.push([y[C].slice(0)])):B[z[F]].push(y[C].slice(0))}return B}function M(y){for(var w=m(s(l(y,0))),d=new i(w.length),C=0;C<y.length;++C)for(var S=y[C],E=0;E<S.length;++E)for(var k=g(w,[S[E]]),B=E+1;B<S.length;++B)d.link(k,g(w,[S[B]]));for(var z=[],F=d.ranks,C=0;C<F.length;++C)F[C]=-1;for(var C=0;C<y.length;++C){var I=d.find(g(w,[y[C][0]]));F[I]<0?(F[I]=z.length,z.push([y[C].slice(0)])):z[F[I]].push(y[C].slice(0))}return z}function _(y,w){return w?c(y,w):M(y)}T.connectedComponents=_},{"bit-twiddle":32,"union-find":309}],294:[function(u,A,T){arguments[4][32][0].apply(T,arguments)},{dup:32}],295:[function(u,A,T){arguments[4][293][0].apply(T,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(u,A,T){A.exports=e;function e(i){this.roots=new Array(i),this.ranks=new Array(i);for(var n=0;n<i;++n)this.roots[n]=n,this.ranks[n]=0}e.prototype.length=function(){return this.roots.length},e.prototype.makeSet=function(){var i=this.roots.length;return this.roots.push(i),this.ranks.push(0),i},e.prototype.find=function(i){for(var n=this.roots;n[i]!==i;){var a=n[i];n[i]=n[a],i=a}return i},e.prototype.link=function(i,n){var a=this.find(i),r=this.find(n);if(a!==r){var f=this.ranks,o=this.roots,s=f[a],m=f[r];s<m?o[a]=r:m<s?o[r]=a:(o[r]=a,++f[a])}}},{}],297:[function(u,A,T){A.exports=a;var e=u("robust-orientation"),i=u("simplicial-complex");function n(r,f,o){var s=Math.abs(e(r,f,o)),m=Math.sqrt(Math.pow(f[0]-o[0],2)+Math.pow(f[1]-o[1],2));return s/m}function a(r,f,o){for(var s=f.length,m=r.length,g=new Array(s),p=new Array(s),v=new Array(s),x=new Array(s),l=0;l<s;++l)g[l]=p[l]=-1,v[l]=1/0,x[l]=!1;for(var l=0;l<m;++l){var b=r[l];if(b.length!==2)throw new Error("Input must be a graph");var c=b[1],M=b[0];p[M]!==-1?p[M]=-2:p[M]=c,g[c]!==-1?g[c]=-2:g[c]=M}function _(Z){if(x[Z])return 1/0;var X=g[Z],re=p[Z];return X<0||re<0?1/0:n(f[Z],f[X],f[re])}function y(Z,X){var re=z[Z],ue=z[X];z[Z]=ue,z[X]=re,F[re]=X,F[ue]=Z}function w(Z){return v[z[Z]]}function d(Z){return Z&1?Z-1>>1:(Z>>1)-1}function C(Z){for(var X=w(Z);;){var re=X,ue=2*Z+1,K=2*(Z+1),te=Z;if(ue<O){var G=w(ue);G<re&&(te=ue,re=G)}if(K<O){var Y=w(K);Y<re&&(te=K)}if(te===Z)return Z;y(Z,te),Z=te}}function S(Z){for(var X=w(Z);Z>0;){var re=d(Z);if(re>=0){var ue=w(re);if(X<ue){y(Z,re),Z=re;continue}}return Z}}function E(){if(O>0){var Z=z[0];return y(0,O-1),O-=1,C(0),Z}return-1}function k(Z,X){var re=z[Z];return v[re]===X?Z:(v[re]=-1/0,S(Z),E(),v[re]=X,O+=1,S(O-1))}function B(Z){if(!x[Z]){x[Z]=!0;var X=g[Z],re=p[Z];g[re]>=0&&(g[re]=X),p[X]>=0&&(p[X]=re),F[X]>=0&&k(F[X],_(X)),F[re]>=0&&k(F[re],_(re))}}for(var z=[],F=new Array(s),l=0;l<s;++l){var I=v[l]=_(l);I<1/0?(F[l]=z.length,z.push(l)):F[l]=-1}for(var O=z.length,l=O>>1;l>=0;--l)C(l);for(;;){var N=E();if(N<0||v[N]>o)break;B(N)}for(var V=[],l=0;l<s;++l)x[l]||(F[l]=V.length,V.push(f[l].slice()));V.length;function H(Z,X){if(Z[X]<0)return X;var re=X,ue=X;do{var K=Z[ue];if(!x[ue]||K<0||K===ue||(ue=K,K=Z[ue],!x[ue]||K<0||K===ue))break;ue=K,re=Z[re]}while(re!==ue);for(var te=X;te!==ue;te=Z[te])Z[te]=ue;return ue}var j=[];return r.forEach(function(Z){var X=H(g,Z[0]),re=H(p,Z[1]);if(X>=0&&re>=0&&X!==re){var ue=F[X],K=F[re];ue!==K&&j.push([ue,K])}}),i.unique(i.normalize(j)),{positions:V,edges:j}}},{"robust-orientation":284,"simplicial-complex":295}],298:[function(u,A,T){A.exports=n;var e=u("robust-orientation");function i(a,r){var f,o;if(r[0][0]<r[1][0])f=r[0],o=r[1];else if(r[0][0]>r[1][0])f=r[1],o=r[0];else{var s=Math.min(a[0][1],a[1][1]),m=Math.max(a[0][1],a[1][1]),g=Math.min(r[0][1],r[1][1]),p=Math.max(r[0][1],r[1][1]);return m<g?m-g:s>p?s-p:m-p}var v,x;a[0][1]<a[1][1]?(v=a[0],x=a[1]):(v=a[1],x=a[0]);var l=e(o,f,v);return l||(l=e(o,f,x),l)?l:x-o}function n(a,r){var f,o;if(r[0][0]<r[1][0])f=r[0],o=r[1];else if(r[0][0]>r[1][0])f=r[1],o=r[0];else return i(r,a);var s,m;if(a[0][0]<a[1][0])s=a[0],m=a[1];else if(a[0][0]>a[1][0])s=a[1],m=a[0];else return-i(a,r);var g=e(f,o,m),p=e(f,o,s);if(g<0){if(p<=0)return g}else if(g>0){if(p>=0)return g}else if(p)return p;if(g=e(m,s,o),p=e(m,s,f),g<0){if(p<=0)return g}else if(g>0){if(p>=0)return g}else if(p)return p;return o[0]-m[0]}},{"robust-orientation":284}],299:[function(u,A,T){A.exports=p;var e=u("binary-search-bounds"),i=u("functional-red-black-tree"),n=u("robust-orientation"),a=u("./lib/order-segments");function r(v,x,l){this.slabs=v,this.coordinates=x,this.horizontal=l}var f=r.prototype;function o(v,x){return v.y-x}function s(v,x){for(var l=null;v;){var b=v.key,c,M;b[0][0]<b[1][0]?(c=b[0],M=b[1]):(c=b[1],M=b[0]);var _=n(c,M,x);if(_<0)v=v.left;else if(_>0)if(x[0]!==b[1][0])l=v,v=v.right;else{var y=s(v.right,x);if(y)return y;v=v.left}else{if(x[0]!==b[1][0])return v;var y=s(v.right,x);if(y)return y;v=v.left}}return l}f.castUp=function(v){var x=e.le(this.coordinates,v[0]);if(x<0)return-1;this.slabs[x];var l=s(this.slabs[x],v),b=-1;if(l&&(b=l.value),this.coordinates[x]===v[0]){var c=null;if(l&&(c=l.key),x>0){var M=s(this.slabs[x-1],v);M&&(c?a(M.key,c)>0&&(c=M.key,b=M.value):(b=M.value,c=M.key))}var _=this.horizontal[x];if(_.length>0){var y=e.ge(_,v[1],o);if(y<_.length){var w=_[y];if(v[1]===w.y){if(w.closed)return w.index;for(;y<_.length-1&&_[y+1].y===v[1];)if(y=y+1,w=_[y],w.closed)return w.index;if(w.y===v[1]&&!w.start){if(y=y+1,y>=_.length)return b;w=_[y]}}if(w.start)if(c){var d=n(c[0],c[1],[v[0],w.y]);c[0][0]>c[1][0]&&(d=-d),d>0&&(b=w.index)}else b=w.index;else w.y!==v[1]&&(b=w.index)}}}return b};function m(v,x,l,b){this.y=v,this.index=x,this.start=l,this.closed=b}function g(v,x,l,b){this.x=v,this.segment=x,this.create=l,this.index=b}function p(v){for(var x=v.length,l=2*x,b=new Array(l),c=0;c<x;++c){var M=v[c],_=M[0][0]<M[1][0];b[2*c]=new g(M[0][0],M,_,c),b[2*c+1]=new g(M[1][0],M,!_,c)}b.sort(function(B,z){var F=B.x-z.x;return F||(F=B.create-z.create,F)?F:Math.min(B.segment[0][1],B.segment[1][1])-Math.min(z.segment[0][1],z.segment[1][1])});for(var y=i(a),w=[],d=[],C=[],c=0;c<l;){for(var S=b[c].x,E=[];c<l;){var k=b[c];if(k.x!==S)break;c+=1,k.segment[0][0]===k.x&&k.segment[1][0]===k.x?k.create&&(k.segment[0][1]<k.segment[1][1]?(E.push(new m(k.segment[0][1],k.index,!0,!0)),E.push(new m(k.segment[1][1],k.index,!1,!1))):(E.push(new m(k.segment[1][1],k.index,!0,!1)),E.push(new m(k.segment[0][1],k.index,!1,!0)))):k.create?y=y.insert(k.segment,k.index):y=y.remove(k.segment)}w.push(y.root),d.push(S),C.push(E)}return new r(w,d,C)}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(u,A,T){var e=u("robust-dot-product"),i=u("robust-sum");A.exports=r,A.exports.positive=f,A.exports.negative=o;function n(s,m){var g=i(e(s,m),[m[m.length-1]]);return g[g.length-1]}function a(s,m,g,p){var v=p-m,x=-m/v;x<0?x=0:x>1&&(x=1);for(var l=1-x,b=s.length,c=new Array(b),M=0;M<b;++M)c[M]=x*s[M]+l*g[M];return c}function r(s,m){for(var g=[],p=[],v=n(s[s.length-1],m),x=s[s.length-1],l=s[0],b=0;b<s.length;++b,x=l){l=s[b];var c=n(l,m);if(v<0&&c>0||v>0&&c<0){var M=a(x,c,l,v);g.push(M),p.push(M.slice())}c<0?p.push(l.slice()):c>0?g.push(l.slice()):(g.push(l.slice()),p.push(l.slice())),v=c}return{positive:g,negative:p}}function f(s,m){for(var g=[],p=n(s[s.length-1],m),v=s[s.length-1],x=s[0],l=0;l<s.length;++l,v=x){x=s[l];var b=n(x,m);(p<0&&b>0||p>0&&b<0)&&g.push(a(v,b,x,p)),b>=0&&g.push(x.slice()),p=b}return g}function o(s,m){for(var g=[],p=n(s[s.length-1],m),v=s[s.length-1],x=s[0],l=0;l<s.length;++l,v=x){x=s[l];var b=n(x,m);(p<0&&b>0||p>0&&b<0)&&g.push(a(v,b,x,p)),b<=0&&g.push(x.slice()),p=b}return g}},{"robust-dot-product":281,"robust-sum":289}],301:[function(u,A,T){(function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function i(o){return a(f(o),arguments)}function n(o,s){return i.apply(null,[o].concat(s||[]))}function a(o,s){var m=1,g=o.length,p,v="",x,l,b,c,M,_,y,w;for(x=0;x<g;x++)if(typeof o[x]=="string")v+=o[x];else if(typeof o[x]=="object"){if(b=o[x],b.keys)for(p=s[m],l=0;l<b.keys.length;l++){if(p==null)throw new Error(i('[sprintf] Cannot access property "%s" of undefined value "%s"',b.keys[l],b.keys[l-1]));p=p[b.keys[l]]}else b.param_no?p=s[b.param_no]:p=s[m++];if(e.not_type.test(b.type)&&e.not_primitive.test(b.type)&&p instanceof Function&&(p=p()),e.numeric_arg.test(b.type)&&typeof p!="number"&&isNaN(p))throw new TypeError(i("[sprintf] expecting number but found %T",p));switch(e.number.test(b.type)&&(y=p>=0),b.type){case"b":p=parseInt(p,10).toString(2);break;case"c":p=String.fromCharCode(parseInt(p,10));break;case"d":case"i":p=parseInt(p,10);break;case"j":p=JSON.stringify(p,null,b.width?parseInt(b.width):0);break;case"e":p=b.precision?parseFloat(p).toExponential(b.precision):parseFloat(p).toExponential();break;case"f":p=b.precision?parseFloat(p).toFixed(b.precision):parseFloat(p);break;case"g":p=b.precision?String(Number(p.toPrecision(b.precision))):parseFloat(p);break;case"o":p=(parseInt(p,10)>>>0).toString(8);break;case"s":p=String(p),p=b.precision?p.substring(0,b.precision):p;break;case"t":p=String(!!p),p=b.precision?p.substring(0,b.precision):p;break;case"T":p=Object.prototype.toString.call(p).slice(8,-1).toLowerCase(),p=b.precision?p.substring(0,b.precision):p;break;case"u":p=parseInt(p,10)>>>0;break;case"v":p=p.valueOf(),p=b.precision?p.substring(0,b.precision):p;break;case"x":p=(parseInt(p,10)>>>0).toString(16);break;case"X":p=(parseInt(p,10)>>>0).toString(16).toUpperCase();break}e.json.test(b.type)?v+=p:(e.number.test(b.type)&&(!y||b.sign)?(w=y?"+":"-",p=p.toString().replace(e.sign,"")):w="",M=b.pad_char?b.pad_char==="0"?"0":b.pad_char.charAt(1):" ",_=b.width-(w+p).length,c=b.width&&_>0?M.repeat(_):"",v+=b.align?w+p+c:M==="0"?w+c+p:c+w+p)}return v}var r=Object.create(null);function f(o){if(r[o])return r[o];for(var s=o,m,g=[],p=0;s;){if((m=e.text.exec(s))!==null)g.push(m[0]);else if((m=e.modulo.exec(s))!==null)g.push("%");else if((m=e.placeholder.exec(s))!==null){if(m[2]){p|=1;var v=[],x=m[2],l=[];if((l=e.key.exec(x))!==null)for(v.push(l[1]);(x=x.substring(l[0].length))!=="";)if((l=e.key_access.exec(x))!==null)v.push(l[1]);else if((l=e.index_access.exec(x))!==null)v.push(l[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");m[2]=v}else p|=2;if(p===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");g.push({placeholder:m[0],param_no:m[1],keys:m[2],sign:m[3],pad_char:m[4],align:m[5],width:m[6],precision:m[7],type:m[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");s=s.substring(m[0].length)}return r[o]=g}typeof T<"u"&&(T.sprintf=i,T.vsprintf=n),typeof window<"u"&&(window.sprintf=i,window.vsprintf=n)})()},{}],302:[function(u,A,T){A.exports=o;var e=u("ndarray-extract-contour"),i=u("zero-crossings"),n={"2d":function(s,m,g){var p=s({order:m,scalarArguments:3,getters:g==="generic"?[0]:void 0,phase:function(x,l,b,c){return x>c|0},vertex:function(x,l,b,c,M,_,y,w,d,C,S,E,k){var B=(y<<0)+(w<<1)+(d<<2)+(C<<3)|0;if(!(B===0||B===15))switch(B){case 0:S.push([x-.5,l-.5]);break;case 1:S.push([x-.25-.25*(c+b-2*k)/(b-c),l-.25-.25*(M+b-2*k)/(b-M)]);break;case 2:S.push([x-.75-.25*(-c-b+2*k)/(c-b),l-.25-.25*(_+c-2*k)/(c-_)]);break;case 3:S.push([x-.5,l-.5-.5*(M+b+_+c-4*k)/(b-M+c-_)]);break;case 4:S.push([x-.25-.25*(_+M-2*k)/(M-_),l-.75-.25*(-M-b+2*k)/(M-b)]);break;case 5:S.push([x-.5-.5*(c+b+_+M-4*k)/(b-c+M-_),l-.5]);break;case 6:S.push([x-.5-.25*(-c-b+_+M)/(c-b+M-_),l-.5-.25*(-M-b+_+c)/(M-b+c-_)]);break;case 7:S.push([x-.75-.25*(_+M-2*k)/(M-_),l-.75-.25*(_+c-2*k)/(c-_)]);break;case 8:S.push([x-.75-.25*(-_-M+2*k)/(_-M),l-.75-.25*(-_-c+2*k)/(_-c)]);break;case 9:S.push([x-.5-.25*(c+b+-_-M)/(b-c+_-M),l-.5-.25*(M+b+-_-c)/(b-M+_-c)]);break;case 10:S.push([x-.5-.5*(-c-b+-_-M+4*k)/(c-b+_-M),l-.5]);break;case 11:S.push([x-.25-.25*(-_-M+2*k)/(_-M),l-.75-.25*(M+b-2*k)/(b-M)]);break;case 12:S.push([x-.5,l-.5-.5*(-M-b+-_-c+4*k)/(M-b+_-c)]);break;case 13:S.push([x-.75-.25*(c+b-2*k)/(b-c),l-.25-.25*(-_-c+2*k)/(_-c)]);break;case 14:S.push([x-.25-.25*(-c-b+2*k)/(c-b),l-.25-.25*(-M-b+2*k)/(M-b)]);break;case 15:S.push([x-.5,l-.5]);break}},cell:function(x,l,b,c,M,_,y,w,d){M?w.push([x,l]):w.push([l,x])}});return function(v,x){var l=[],b=[];return p(v,l,b,x),{positions:l,cells:b}}}};function a(s,m){var g=s.length+"d",p=n[g];if(p)return p(e,s,m)}function r(s,m){for(var g=i(s,m),p=g.length,v=new Array(p),x=new Array(p),l=0;l<p;++l)v[l]=[g[l]],x[l]=[l];return{positions:v,cells:x}}var f={};function o(s,v){if(s.dimension<=0)return{positions:[],cells:[]};if(s.dimension===1)return r(s,v);var g=s.order.join()+"-"+s.dtype,p=f[g],v=+v||0;return p||(p=f[g]=a(s.order,s.dtype)),p(s,v)}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(u,A,T){(function(e){(function(){A.exports=f;var i=u("vectorize-text"),n=window||e.global||{},a=n.__TEXT_CACHE||{};n.__TEXT_CACHE={};function r(o){for(var s=o.cells,m=o.positions,g=new Float32Array(s.length*6),p=0,v=0,x=0;x<s.length;++x)for(var l=s[x],b=0;b<3;++b){var c=m[l[b]];g[p++]=c[0],g[p++]=c[1]+1.4,v=Math.max(c[0],v)}return{data:g,shape:v}}function f(o,s,g){var g=g||{},p=a[o];p||(p=a[o]={" ":{data:new Float32Array(0),shape:.2}});var v=p[s];if(!v)if(s.length<=1||!/\d/.test(s))v=p[s]=r(i(s,{triangles:!0,font:o,textAlign:g.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var x=s.split(/(\d|\s)/),l=new Array(x.length),b=0,c=0,M=0;M<x.length;++M)l[M]=f(o,x[M]),b+=l[M].data.length,c+=l[M].shape,M>0&&(c+=.02);for(var _=new Float32Array(b),y=0,w=-.5*c,M=0;M<l.length;++M){for(var d=l[M].data,C=0;C<d.length;C+=2)_[y++]=d[C]+w,_[y++]=d[C+1];w+=l[M].shape+.02}v=p[s]={data:_,shape:c}}return v}}).call(this)}).call(this,u("_process"))},{_process:5,"vectorize-text":311}],304:[function(u,A,T){var e=u("parse-unit");A.exports=r;var i=96;function n(f,o){var s=e(getComputedStyle(f).getPropertyValue(o));return s[0]*r(s[1],f)}function a(f,o){var s=document.createElement("div");s.style["font-size"]="128"+f,o.appendChild(s);var m=n(s,"font-size")/128;return o.removeChild(s),m}function r(f,o){switch(o=o||document.body,f=(f||"px").trim().toLowerCase(),(o===window||o===document)&&(o=document.body),f){case"%":return o.clientHeight/100;case"ch":case"ex":return a(f,o);case"em":return n(o,"font-size");case"rem":return n(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return i;case"cm":return i/2.54;case"mm":return i/25.4;case"pt":return i/72;case"pc":return i/6}return 1}},{"parse-unit":265}],305:[function(u,A,T){A.exports=x;var e=u("filtered-vector"),i=u("gl-mat4/invert"),n=u("gl-mat4/rotate"),a=u("gl-vec3/cross"),r=u("gl-vec3/normalize"),f=u("gl-vec3/dot");function o(l,b,c){return Math.sqrt(Math.pow(l,2)+Math.pow(b,2)+Math.pow(c,2))}function s(l){return Math.min(1,Math.max(-1,l))}function m(l){var b=Math.abs(l[0]),c=Math.abs(l[1]),M=Math.abs(l[2]),_=[0,0,0];b>Math.max(c,M)?_[2]=1:c>Math.max(b,M)?_[0]=1:_[1]=1;for(var y=0,w=0,d=0;d<3;++d)y+=l[d]*l[d],w+=_[d]*l[d];for(var d=0;d<3;++d)_[d]-=w/y*l[d];return r(_,_),_}function g(l,b,c,M,_,y,w,d){this.center=e(c),this.up=e(M),this.right=e(_),this.radius=e([y]),this.angle=e([w,d]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(l,b),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var C=0;C<16;++C)this.computedMatrix[C]=.5;this.recalcMatrix(0)}var p=g.prototype;p.setDistanceLimits=function(l,b){l>0?l=Math.log(l):l=-1/0,b>0?b=Math.log(b):b=1/0,b=Math.max(b,l),this.radius.bounds[0][0]=l,this.radius.bounds[1][0]=b},p.getDistanceLimits=function(l){var b=this.radius.bounds[0];return l?(l[0]=Math.exp(b[0][0]),l[1]=Math.exp(b[1][0]),l):[Math.exp(b[0][0]),Math.exp(b[1][0])]},p.recalcMatrix=function(l){this.center.curve(l),this.up.curve(l),this.right.curve(l),this.radius.curve(l),this.angle.curve(l);for(var b=this.computedUp,c=this.computedRight,M=0,_=0,y=0;y<3;++y)_+=b[y]*c[y],M+=b[y]*b[y];for(var w=Math.sqrt(M),d=0,y=0;y<3;++y)c[y]-=b[y]*_/M,d+=c[y]*c[y],b[y]/=w;for(var C=Math.sqrt(d),y=0;y<3;++y)c[y]/=C;var S=this.computedToward;a(S,b,c),r(S,S);for(var E=Math.exp(this.computedRadius[0]),k=this.computedAngle[0],B=this.computedAngle[1],z=Math.cos(k),F=Math.sin(k),I=Math.cos(B),O=Math.sin(B),N=this.computedCenter,V=z*I,H=F*I,j=O,Z=-z*O,X=-F*O,re=I,ue=this.computedEye,K=this.computedMatrix,y=0;y<3;++y){var te=V*c[y]+H*S[y]+j*b[y];K[4*y+1]=Z*c[y]+X*S[y]+re*b[y],K[4*y+2]=te,K[4*y+3]=0}var G=K[1],Y=K[5],ee=K[9],ne=K[2],J=K[6],q=K[10],ae=Y*q-ee*J,le=ee*ne-G*q,ie=G*J-Y*ne,se=o(ae,le,ie);ae/=se,le/=se,ie/=se,K[0]=ae,K[4]=le,K[8]=ie;for(var y=0;y<3;++y)ue[y]=N[y]+K[2+4*y]*E;for(var y=0;y<3;++y){for(var d=0,xe=0;xe<3;++xe)d+=K[y+4*xe]*ue[xe];K[12+y]=-d}K[15]=1},p.getMatrix=function(l,b){this.recalcMatrix(l);var c=this.computedMatrix;if(b){for(var M=0;M<16;++M)b[M]=c[M];return b}return c};var v=[0,0,0];p.rotate=function(l,b,c,M){if(this.angle.move(l,b,c),M){this.recalcMatrix(l);var _=this.computedMatrix;v[0]=_[2],v[1]=_[6],v[2]=_[10];for(var y=this.computedUp,w=this.computedRight,d=this.computedToward,C=0;C<3;++C)_[4*C]=y[C],_[4*C+1]=w[C],_[4*C+2]=d[C];n(_,_,M,v);for(var C=0;C<3;++C)y[C]=_[4*C],w[C]=_[4*C+1];this.up.set(l,y[0],y[1],y[2]),this.right.set(l,w[0],w[1],w[2])}},p.pan=function(l,b,c,M){b=b||0,c=c||0,M=M||0,this.recalcMatrix(l);var _=this.computedMatrix;Math.exp(this.computedRadius[0]);var y=_[1],w=_[5],d=_[9],C=o(y,w,d);y/=C,w/=C,d/=C;var S=_[0],E=_[4],k=_[8],B=S*y+E*w+k*d;S-=y*B,E-=w*B,k-=d*B;var z=o(S,E,k);S/=z,E/=z,k/=z;var F=S*b+y*c,I=E*b+w*c,O=k*b+d*c;this.center.move(l,F,I,O);var N=Math.exp(this.computedRadius[0]);N=Math.max(1e-4,N+M),this.radius.set(l,Math.log(N))},p.translate=function(l,b,c,M){this.center.move(l,b||0,c||0,M||0)},p.setMatrix=function(l,b,c,M){var _=1;typeof c=="number"&&(_=c|0),(_<0||_>3)&&(_=1);var y=(_+2)%3;b||(this.recalcMatrix(l),b=this.computedMatrix);var w=b[_],d=b[_+4],C=b[_+8];if(M){var E=Math.abs(w),k=Math.abs(d),B=Math.abs(C),z=Math.max(E,k,B);E===z?(w=w<0?-1:1,d=C=0):B===z?(C=C<0?-1:1,w=d=0):(d=d<0?-1:1,w=C=0)}else{var S=o(w,d,C);w/=S,d/=S,C/=S}var F=b[y],I=b[y+4],O=b[y+8],N=F*w+I*d+O*C;F-=w*N,I-=d*N,O-=C*N;var V=o(F,I,O);F/=V,I/=V,O/=V;var H=d*O-C*I,j=C*F-w*O,Z=w*I-d*F,X=o(H,j,Z);H/=X,j/=X,Z/=X,this.center.jump(l,me,_e,Se),this.radius.idle(l),this.up.jump(l,w,d,C),this.right.jump(l,F,I,O);var re,ue;if(_===2){var K=b[1],te=b[5],G=b[9],Y=K*F+te*I+G*O,ee=K*H+te*j+G*Z;ae<0?re=-Math.PI/2:re=Math.PI/2,ue=Math.atan2(ee,Y)}else{var ne=b[2],J=b[6],q=b[10],ae=ne*w+J*d+q*C,le=ne*F+J*I+q*O,ie=ne*H+J*j+q*Z;re=Math.asin(s(ae)),ue=Math.atan2(ie,le)}this.angle.jump(l,ue,re),this.recalcMatrix(l);var se=b[2],xe=b[6],oe=b[10],he=this.computedMatrix;i(he,b);var be=he[15],me=he[12]/be,_e=he[13]/be,Se=he[14]/be,De=Math.exp(this.computedRadius[0]);this.center.jump(l,me-se*De,_e-xe*De,Se-oe*De)},p.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},p.idle=function(l){this.center.idle(l),this.up.idle(l),this.right.idle(l),this.radius.idle(l),this.angle.idle(l)},p.flush=function(l){this.center.flush(l),this.up.flush(l),this.right.flush(l),this.radius.flush(l),this.angle.flush(l)},p.setDistance=function(l,b){b>0&&this.radius.set(l,Math.log(b))},p.lookAt=function(l,b,c,M){this.recalcMatrix(l),b=b||this.computedEye,c=c||this.computedCenter,M=M||this.computedUp;var _=M[0],y=M[1],w=M[2],d=o(_,y,w);if(!(d<1e-6)){_/=d,y/=d,w/=d;var C=b[0]-c[0],S=b[1]-c[1],E=b[2]-c[2],k=o(C,S,E);if(!(k<1e-6)){C/=k,S/=k,E/=k;var B=this.computedRight,z=B[0],F=B[1],I=B[2],O=_*z+y*F+w*I;z-=O*_,F-=O*y,I-=O*w;var N=o(z,F,I);if(!(N<.01&&(z=y*E-w*S,F=w*C-_*E,I=_*S-y*C,N=o(z,F,I),N<1e-6))){z/=N,F/=N,I/=N,this.up.set(l,_,y,w),this.right.set(l,z,F,I),this.center.set(l,c[0],c[1],c[2]),this.radius.set(l,Math.log(k));var V=y*I-w*F,H=w*z-_*I,j=_*F-y*z,Z=o(V,H,j);V/=Z,H/=Z,j/=Z;var X=_*C+y*S+w*E,re=z*C+F*S+I*E,ue=V*C+H*S+j*E,K=Math.asin(s(X)),te=Math.atan2(ue,re),G=this.angle._state,Y=G[G.length-1],ee=G[G.length-2];Y=Y%(2*Math.PI);var ne=Math.abs(Y+2*Math.PI-te),J=Math.abs(Y-te),q=Math.abs(Y-2*Math.PI-te);ne<J&&(Y+=2*Math.PI),q<J&&(Y-=2*Math.PI),this.angle.jump(this.angle.lastT(),Y,ee),this.angle.set(l,te,K)}}}};function x(l){l=l||{};var b=l.center||[0,0,0],c=l.up||[0,1,0],M=l.right||m(c),_=l.radius||1,y=l.theta||0,w=l.phi||0;if(b=[].slice.call(b,0,3),c=[].slice.call(c,0,3),r(c,c),M=[].slice.call(M,0,3),r(M,M),"eye"in l){var d=l.eye,C=[d[0]-b[0],d[1]-b[1],d[2]-b[2]];a(M,C,c),o(M[0],M[1],M[2])<1e-6?M=m(c):r(M,M),_=o(C[0],C[1],C[2]);var S=f(c,C)/_,E=f(M,C)/_;w=Math.acos(S),y=Math.acos(E)}return _=Math.log(_),new g(l.zoomMin,l.zoomMax,b,c,M,_,y,w)}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(u,A,T){A.exports=i;var e=+(Math.pow(2,27)+1);function i(n,a,r){var f=n*a,o=e*n,s=o-n,m=o-s,g=n-m,p=e*a,v=p-a,x=p-v,l=a-x,b=f-m*x,c=b-g*x,M=c-m*l,_=g*l-M;return r?(r[0]=_,r[1]=f,r):[_,f]}},{}],307:[function(u,A,T){A.exports=e;function e(i,n,a){var r=i+n,f=r-i,o=r-f,s=n-f,m=i-o;return a?(a[0]=m+s,a[1]=r,a):[m+s,r]}},{}],308:[function(u,A,T){(function(e){(function(){var i=u("bit-twiddle"),n=u("dup"),a=u("buffer").Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:n([32,0]),UINT16:n([32,0]),UINT32:n([32,0]),BIGUINT64:n([32,0]),INT8:n([32,0]),INT16:n([32,0]),INT32:n([32,0]),BIGINT64:n([32,0]),FLOAT:n([32,0]),DOUBLE:n([32,0]),DATA:n([32,0]),UINT8C:n([32,0]),BUFFER:n([32,0])});var r=typeof Uint8ClampedArray<"u",f=typeof BigUint64Array<"u",o=typeof BigInt64Array<"u",s=e.__TYPEDARRAY_POOL;s.UINT8C||(s.UINT8C=n([32,0])),s.BIGUINT64||(s.BIGUINT64=n([32,0])),s.BIGINT64||(s.BIGINT64=n([32,0])),s.BUFFER||(s.BUFFER=n([32,0]));var m=s.DATA,g=s.BUFFER;T.free=function(F){if(a.isBuffer(F))g[i.log2(F.length)].push(F);else{if(Object.prototype.toString.call(F)!=="[object ArrayBuffer]"&&(F=F.buffer),!F)return;var I=F.length||F.byteLength,O=i.log2(I)|0;m[O].push(F)}};function p(z){if(!!z){var F=z.length||z.byteLength,I=i.log2(F);m[I].push(z)}}function v(z){p(z.buffer)}T.freeUint8=T.freeUint16=T.freeUint32=T.freeBigUint64=T.freeInt8=T.freeInt16=T.freeInt32=T.freeBigInt64=T.freeFloat32=T.freeFloat=T.freeFloat64=T.freeDouble=T.freeUint8Clamped=T.freeDataView=v,T.freeArrayBuffer=p,T.freeBuffer=function(F){g[i.log2(F.length)].push(F)},T.malloc=function(F,I){if(I===void 0||I==="arraybuffer")return x(F);switch(I){case"uint8":return l(F);case"uint16":return b(F);case"uint32":return c(F);case"int8":return M(F);case"int16":return _(F);case"int32":return y(F);case"float":case"float32":return w(F);case"double":case"float64":return d(F);case"uint8_clamped":return C(F);case"bigint64":return E(F);case"biguint64":return S(F);case"buffer":return B(F);case"data":case"dataview":return k(F);default:return null}return null};function x(F){var F=i.nextPow2(F),I=i.log2(F),O=m[I];return O.length>0?O.pop():new ArrayBuffer(F)}T.mallocArrayBuffer=x;function l(z){return new Uint8Array(x(z),0,z)}T.mallocUint8=l;function b(z){return new Uint16Array(x(2*z),0,z)}T.mallocUint16=b;function c(z){return new Uint32Array(x(4*z),0,z)}T.mallocUint32=c;function M(z){return new Int8Array(x(z),0,z)}T.mallocInt8=M;function _(z){return new Int16Array(x(2*z),0,z)}T.mallocInt16=_;function y(z){return new Int32Array(x(4*z),0,z)}T.mallocInt32=y;function w(z){return new Float32Array(x(4*z),0,z)}T.mallocFloat32=T.mallocFloat=w;function d(z){return new Float64Array(x(8*z),0,z)}T.mallocFloat64=T.mallocDouble=d;function C(z){return r?new Uint8ClampedArray(x(z),0,z):l(z)}T.mallocUint8Clamped=C;function S(z){return f?new BigUint64Array(x(8*z),0,z):null}T.mallocBigUint64=S;function E(z){return o?new BigInt64Array(x(8*z),0,z):null}T.mallocBigInt64=E;function k(z){return new DataView(x(z),0,z)}T.mallocDataView=k;function B(z){z=i.nextPow2(z);var F=i.log2(z),I=g[F];return I.length>0?I.pop():new a(z)}T.mallocBuffer=B,T.clearCache=function(){for(var F=0;F<32;++F)s.UINT8[F].length=0,s.UINT16[F].length=0,s.UINT32[F].length=0,s.INT8[F].length=0,s.INT16[F].length=0,s.INT32[F].length=0,s.FLOAT[F].length=0,s.DOUBLE[F].length=0,s.BIGUINT64[F].length=0,s.BIGINT64[F].length=0,s.UINT8C[F].length=0,m[F].length=0,g[F].length=0}}).call(this)}).call(this,typeof h<"u"?h:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(u,A,T){A.exports=e;function e(n){this.roots=new Array(n),this.ranks=new Array(n);for(var a=0;a<n;++a)this.roots[a]=a,this.ranks[a]=0}var i=e.prototype;Object.defineProperty(i,"length",{get:function(){return this.roots.length}}),i.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n},i.find=function(n){for(var a=n,r=this.roots;r[n]!==n;)n=r[n];for(;r[a]!==n;){var f=r[a];r[a]=n,a=f}return n},i.link=function(n,a){var r=this.find(n),f=this.find(a);if(r!==f){var o=this.ranks,s=this.roots,m=o[r],g=o[f];m<g?s[r]=f:g<m?s[f]=r:(s[f]=r,++o[r])}}},{}],310:[function(u,A,T){function e(a,r){for(var f=1,o=a.length,s=a[0],m=a[0],g=1;g<o;++g)if(m=s,s=a[g],r(s,m)){if(g===f){f++;continue}a[f++]=s}return a.length=f,a}function i(a){for(var r=1,f=a.length,o=a[0],s=a[0],m=1;m<f;++m,s=o)if(s=o,o=a[m],o!==s){if(m===r){r++;continue}a[r++]=o}return a.length=r,a}function n(a,r,f){return a.length===0?a:r?(f||a.sort(r),e(a,r)):(f||a.sort(),i(a))}A.exports=n},{}],311:[function(u,A,T){A.exports=a;var e=u("./lib/vtext"),i=null,n=null;typeof document<"u"&&(i=document.createElement("canvas"),i.width=8192,i.height=1024,n=i.getContext("2d"));function a(r,f){return(typeof f!="object"||f===null)&&(f={}),e(r,f.canvas||i,f.context||n,f)}},{"./lib/vtext":312}],312:[function(u,A,T){A.exports=S,A.exports.processPixels=C;var e=u("surface-nets"),i=u("ndarray"),n=u("simplify-planar-graph"),a=u("clean-pslg"),r=u("cdt2d"),f=u("planar-graph-to-polyline"),o="b",s="b|",m="i",g="i|",p="sup",v="+",x="+1",l="sub",b="-",c="-1";function M(E,k,B,z){for(var F="<"+E+">",I="</"+E+">",O=F.length,N=I.length,V=k[0]===v||k[0]===b,H=0,j=-N;H>-1&&(H=B.indexOf(F,H),!(H===-1||(j=B.indexOf(I,H+O),j===-1)||j<=H));){for(var Z=H;Z<j+N;++Z)if(Z<H+O||Z>=j)z[Z]=null,B=B.substr(0,Z)+" "+B.substr(Z+1);else if(z[Z]!==null){var X=z[Z].indexOf(k[0]);X===-1?z[Z]+=k:V&&(z[Z]=z[Z].substr(0,X+1)+(1+parseInt(z[Z][X+1]))+z[Z].substr(X+2))}var re=H+O,ue=B.substr(re,j-re),K=ue.indexOf(F);K!==-1?H=K:H=j+N}return z}function _(E,k,B){for(var z=k.textAlign||"start",F=k.textBaseline||"alphabetic",I=[1<<30,1<<30],O=[0,0],N=E.length,V=0;V<N;++V)for(var H=E[V],j=0;j<2;++j)I[j]=Math.min(I[j],H[j])|0,O[j]=Math.max(O[j],H[j])|0;var Z=0;switch(z){case"center":Z=-.5*(I[0]+O[0]);break;case"right":case"end":Z=-O[0];break;case"left":case"start":Z=-I[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+z+"'")}var X=0;switch(F){case"hanging":case"top":X=-I[1];break;case"middle":X=-.5*(I[1]+O[1]);break;case"alphabetic":case"ideographic":X=-3*B;break;case"bottom":X=-O[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+F+"'")}var re=1/B;return"lineHeight"in k?re*=+k.lineHeight:"width"in k?re=k.width/(O[0]-I[0]):"height"in k&&(re=k.height/(O[1]-I[1])),E.map(function(ue){return[re*(ue[0]+Z),re*(ue[1]+X)]})}function y(E,k,B,z,F,I){B=B.replace(/\n/g,""),I.breaklines===!0?B=B.replace(/\<br\>/g,`
`):B=B.replace(/\<br\>/g," ");var O="",N=[];for(Y=0;Y<B.length;++Y)N[Y]=O;I.bolds===!0&&(N=M(o,s,B,N)),I.italics===!0&&(N=M(m,g,B,N)),I.superscripts===!0&&(N=M(p,x,B,N)),I.subscripts===!0&&(N=M(l,c,B,N));var V=[],H="";for(Y=0;Y<B.length;++Y)N[Y]!==null&&(H+=B[Y],V.push(N[Y]));var j=H.split(`
`),Z=j.length,X=Math.round(F*z),re=z,ue=z*2,K=0,te=Z*X+ue;E.height<te&&(E.height=te),k.fillStyle="#000",k.fillRect(0,0,E.width,E.height),k.fillStyle="#fff";var G,Y,ee,ne,J,q=0,ae="";function le(){if(ae!==""){var Se=k.measureText(ae).width;k.fillText(ae,re+ee,ue+ne),ee+=Se}}function ie(){return""+Math.round(J)+"px "}function se(Se,De){var Ie=""+k.font;if(I.subscripts===!0){var Te=Se.indexOf(b),Ce=De.indexOf(b),He=Te>-1?parseInt(Se[1+Te]):0,Xe=Ce>-1?parseInt(De[1+Ce]):0;He!==Xe&&(Ie=Ie.replace(ie(),"?px "),J*=Math.pow(.75,Xe-He),Ie=Ie.replace("?px ",ie())),ne+=.25*X*(Xe-He)}if(I.superscripts===!0){var Be=Se.indexOf(v),Re=De.indexOf(v),We=Be>-1?parseInt(Se[1+Be]):0,vt=Re>-1?parseInt(De[1+Re]):0;We!==vt&&(Ie=Ie.replace(ie(),"?px "),J*=Math.pow(.75,vt-We),Ie=Ie.replace("?px ",ie())),ne-=.25*X*(vt-We)}if(I.bolds===!0){var Pt=Se.indexOf(s)>-1,Zt=De.indexOf(s)>-1;!Pt&&Zt&&(zt?Ie=Ie.replace("italic ","italic bold "):Ie="bold "+Ie),Pt&&!Zt&&(Ie=Ie.replace("bold ",""))}if(I.italics===!0){var zt=Se.indexOf(g)>-1,At=De.indexOf(g)>-1;!zt&&At&&(Ie="italic "+Ie),zt&&!At&&(Ie=Ie.replace("italic ",""))}k.font=Ie}for(G=0;G<Z;++G){var xe=j[G]+`
`;for(ee=0,ne=G*X,J=z,ae="",Y=0;Y<xe.length;++Y){var oe=Y+q<V.length?V[Y+q]:V[V.length-1];O===oe?ae+=xe[Y]:(le(),ae=xe[Y],oe!==void 0&&(se(O,oe),O=oe))}le(),q+=xe.length;var he=Math.round(ee+2*re)|0;K<he&&(K=he)}var be=K,me=ue+X*Z,_e=i(k.getImageData(0,0,be,me).data,[me,be,4]);return _e.pick(-1,-1,0).transpose(1,0)}function w(E,k){var B=e(E,128);return k?n(B.cells,B.positions,.25):{edges:B.cells,positions:B.positions}}function d(E,k,B,z){var F=w(E,z),I=_(F.positions,k,B),O=F.edges,N=k.orientation==="ccw";if(a(I,O),k.polygons||k.polygon||k.polyline){for(var V=f(O,I),H=new Array(V.length),j=0;j<V.length;++j){for(var Z=V[j],X=new Array(Z.length),re=0;re<Z.length;++re){for(var ue=Z[re],K=new Array(ue.length),te=0;te<ue.length;++te)K[te]=I[ue[te]].slice();N&&K.reverse(),X[re]=K}H[j]=X}return H}else return k.triangles||k.triangulate||k.triangle?{cells:r(I,O,{delaunay:!1,exterior:!1,interior:!0}),positions:I}:{edges:O,positions:I}}function C(E,k,B){try{return d(E,k,B,!0)}catch{}try{return d(E,k,B,!1)}catch{}return k.polygons||k.polyline||k.polygon?[]:k.triangles||k.triangulate||k.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}function S(E,k,B,z){var F=64,I=1.25,O={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};z&&(z.size&&z.size>0&&(F=z.size),z.lineSpacing&&z.lineSpacing>0&&(I=z.lineSpacing),z.styletags&&z.styletags.breaklines&&(O.breaklines=!!z.styletags.breaklines),z.styletags&&z.styletags.bolds&&(O.bolds=!!z.styletags.bolds),z.styletags&&z.styletags.italics&&(O.italics=!!z.styletags.italics),z.styletags&&z.styletags.subscripts&&(O.subscripts=!!z.styletags.subscripts),z.styletags&&z.styletags.superscripts&&(O.superscripts=!!z.styletags.superscripts)),B.font=[z.fontStyle,z.fontVariant,z.fontWeight,F+"px",z.font].filter(function(V){return V}).join(" "),B.textAlign="start",B.textBaseline="alphabetic",B.direction="ltr";var N=y(k,B,E,F,I,O);return C(N,z,F)}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(u,A,T){(function(){if(typeof ses<"u"&&ses.ok&&!ses.ok())return;function i(C){C.permitHostObjects___&&C.permitHostObjects___(i)}typeof ses<"u"&&(ses.weakMapPermitHostObjects=i);var n=!1;if(typeof WeakMap=="function"){var a=WeakMap;if(!(typeof navigator<"u"&&/Firefox/.test(navigator.userAgent))){var r=new a,f=Object.freeze({});if(r.set(f,1),r.get(f)!==1)n=!0;else{A.exports=WeakMap;return}}}var o=Object.getOwnPropertyNames,s=Object.defineProperty,m=Object.isExtensible,g="weakmap:",p=g+"ident:"+Math.random()+"___";if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var v=new ArrayBuffer(25),x=new Uint8Array(v);crypto.getRandomValues(x),p=g+"rand:"+Array.prototype.map.call(x,function(C){return(C%36).toString(36)}).join("")+"___"}function l(C){return!(C.substr(0,g.length)==g&&C.substr(C.length-3)==="___")}if(s(Object,"getOwnPropertyNames",{value:function(S){return o(S).filter(l)}}),"getPropertyNames"in Object){var b=Object.getPropertyNames;s(Object,"getPropertyNames",{value:function(S){return b(S).filter(l)}})}function c(C){if(C!==Object(C))throw new TypeError("Not an object: "+C);var S=C[p];if(S&&S.key===C)return S;if(!!m(C)){S={key:C};try{return s(C,p,{value:S,writable:!1,enumerable:!1,configurable:!1}),S}catch{return}}}(function(){var C=Object.freeze;s(Object,"freeze",{value:function(B){return c(B),C(B)}});var S=Object.seal;s(Object,"seal",{value:function(B){return c(B),S(B)}});var E=Object.preventExtensions;s(Object,"preventExtensions",{value:function(B){return c(B),E(B)}})})();function M(C){return C.prototype=null,Object.freeze(C)}var _=!1;function y(){!_&&typeof console<"u"&&(_=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}var w=0,d=function(){this instanceof d||y();var C=[],S=[],E=w++;function k(I,O){var N,V=c(I);return V?E in V?V[E]:O:(N=C.indexOf(I),N>=0?S[N]:O)}function B(I){var O=c(I);return O?E in O:C.indexOf(I)>=0}function z(I,O){var N,V=c(I);return V?V[E]=O:(N=C.indexOf(I),N>=0?S[N]=O:(N=C.length,S[N]=O,C[N]=I)),this}function F(I){var O=c(I),N,V;return O?E in O&&delete O[E]:(N=C.indexOf(I),N<0?!1:(V=C.length-1,C[N]=void 0,S[N]=S[V],C[N]=C[V],C.length=V,S.length=V,!0))}return Object.create(d.prototype,{get___:{value:M(k)},has___:{value:M(B)},set___:{value:M(z)},delete___:{value:M(F)}})};d.prototype=Object.create(Object.prototype,{get:{value:function(S,E){return this.get___(S,E)},writable:!0,configurable:!0},has:{value:function(S){return this.has___(S)},writable:!0,configurable:!0},set:{value:function(S,E){return this.set___(S,E)},writable:!0,configurable:!0},delete:{value:function(S){return this.delete___(S)},writable:!0,configurable:!0}}),typeof a=="function"?function(){n&&typeof Proxy<"u"&&(Proxy=void 0);function C(){this instanceof d||y();var S=new a,E=void 0,k=!1;function B(O,N){return E?S.has(O)?S.get(O):E.get___(O,N):S.get(O,N)}function z(O){return S.has(O)||(E?E.has___(O):!1)}var F;n?F=function(O,N){return S.set(O,N),S.has(O)||(E||(E=new d),E.set(O,N)),this}:F=function(O,N){if(k)try{S.set(O,N)}catch{E||(E=new d),E.set___(O,N)}else S.set(O,N);return this};function I(O){var N=!!S.delete(O);return E&&E.delete___(O)||N}return Object.create(d.prototype,{get___:{value:M(B)},has___:{value:M(z)},set___:{value:M(F)},delete___:{value:M(I)},permitHostObjects___:{value:M(function(O){if(O===i)k=!0;else throw new Error("bogus call to permitHostObjects___")})}})}C.prototype=d.prototype,A.exports=C,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy<"u"&&(Proxy=void 0),A.exports=d)})()},{}],314:[function(u,A,T){var e=u("./hidden-store.js");A.exports=i;function i(){var n={};return function(a){if((typeof a!="object"||a===null)&&typeof a!="function")throw new Error("Weakmap-shim: Key must be object");var r=a.valueOf(n);return r&&r.identity===n?r:e(a,n)}}},{"./hidden-store.js":315}],315:[function(u,A,T){A.exports=e;function e(i,n){var a={identity:n},r=i.valueOf;return Object.defineProperty(i,"valueOf",{value:function(f){return f!==n?r.apply(this,arguments):a},writable:!0}),a}},{}],316:[function(u,A,T){var e=u("./create-store.js");A.exports=i;function i(){var n=e();return{get:function(a,r){var f=n(a);return f.hasOwnProperty("value")?f.value:r},set:function(a,r){return n(a).value=r,this},has:function(a){return"value"in n(a)},delete:function(a){return delete n(a).value}}}},{"./create-store.js":314}],317:[function(u,A,T){function e(){return function(o,s,m,g,p,v){var x=o[0],l=m[0],b=[0],c=l;g|=0;var M=0,_=l;for(M=0;M<x;++M){{var y=s[g]-v,w=s[g+c]-v;y>=0!=w>=0&&p.push(b[0]+.5+.5*(y+w)/(y-w))}g+=_,++b[0]}}}function i(){return e()}var n=i;function a(o){var s={};return function(g,p,v){var x=g.dtype,l=g.order,b=[x,l.join()].join(),c=s[b];return c||(s[b]=c=o([x,l])),c(g.shape.slice(0),g.data,g.stride,g.offset|0,p,v)}}function r(o){return a(n.bind(void 0,o))}function f(o){return r({funcName:o.funcName})}A.exports=f({funcName:"zeroCrossings"})},{}],318:[function(u,A,T){A.exports=i;var e=u("./lib/zc-core");function i(n,a){var r=[];return a=+a||0,e(n.hi(n.shape[0]-1),r,a),r}},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[27])(27)})})(fy);const l5=jp(fy.exports);class u5 extends $c{constructor(){super(lx);tc(this,"trace",{x:[],y:[],name:"no name",color:"#000",type:"scatter",mode:"markers",marker:{size:12}})}async validateData(){let t=await this.dataLoaderFn(),P=[];t[0].forEach((e,i)=>{P[i]=typeof e});let R=t[0].length,h=!0,u=!0,A=typeof t[0][R-1]=="string";t.forEach((e,i)=>{if(!h)return!1;if(e.length!==R)return u=!1,!1;e.forEach((n,a)=>{if(typeof n!==P[a])return h=!1,!1})});let T=[];h||T.push("data points should be of the same type"),u||T.push("all data point should be of the same length (have same number of dimensions)"),A||T.push("last data point element should be string and represent a datapoint title"),T.length!==0&&this.displayError("Data format error",T.join(`
`)),this.data=t}analyzeAndVisualizeData(){let t=n5(this.data);console.log("results:",t);let P=t.name.filter(f5),R=["rgb(255, 0, 0)","rgb(0, 255, 0)","rgb(0, 0, 255)","rgb(255, 255, 0)","rgb(255, 0, 255)","rgb(0, 255, 255)","rgb(0, 0, 0)"],h=[];for(let T=0;T<t.x.length;T++){let e=t.name[T],i=t.x[T],n=t.y[T];if(h[P.indexOf(e)]===void 0){let a=JSON.parse(JSON.stringify(this.trace));a.name=e,a.color=R[P.indexOf(e)],h[P.indexOf(e)]=a}h[P.indexOf(e)].x.push(i),h[P.indexOf(e)].y.push(n)}console.log(h);let u={title:"PCA plot",showLegend:!0,legend:{x:0,y:1,traceorder:"normal",font:{family:"sans-serif",size:12,color:"#000"},bgcolor:"#E2E2E2",bordercolor:"#FFFFFF",borderwidth:2},hovermode:"closest",yaxis:{hoverformat:","}},A={scrollZoom:!0,displayModeBar:!1};l5.newPlot(this.plotSpace,h,u,A)}}function f5(ye,ge,t){return t.indexOf(ye)===ge}window.addEventListener("load",()=>{window.customElements.define("pca-plot",u5)});
