var eg=Object.defineProperty;var tg=(Vi,Ii,d)=>Ii in Vi?eg(Vi,Ii,{enumerable:!0,configurable:!0,writable:!0,value:d}):Vi[Ii]=d;var Ef=(Vi,Ii,d)=>(tg(Vi,typeof Ii!="symbol"?Ii+"":Ii,d),d),Nh=(Vi,Ii,d)=>{if(!Ii.has(Vi))throw TypeError("Cannot "+d)};var Uh=(Vi,Ii,d)=>(Nh(Vi,Ii,"read from private field"),d?d.call(Vi):Ii.get(Vi)),$u=(Vi,Ii,d)=>{if(Ii.has(Vi))throw TypeError("Cannot add the same private member more than once");Ii instanceof WeakSet?Ii.add(Vi):Ii.set(Vi,d)},ep=(Vi,Ii,d,ee)=>(Nh(Vi,Ii,"write to private field"),ee?ee.call(Vi,d):Ii.set(Vi,d),d);var qu=(Vi,Ii,d)=>(Nh(Vi,Ii,"access private method"),d);(function(){const Ii=document.createElement("link").relList;if(Ii&&Ii.supports&&Ii.supports("modulepreload"))return;for(const te of document.querySelectorAll('link[rel="modulepreload"]'))ee(te);new MutationObserver(te=>{for(const A of te)if(A.type==="childList")for(const g of A.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&ee(g)}).observe(document,{childList:!0,subtree:!0});function d(te){const A={};return te.integrity&&(A.integrity=te.integrity),te.referrerpolicy&&(A.referrerPolicy=te.referrerpolicy),te.crossorigin==="use-credentials"?A.credentials="include":te.crossorigin==="anonymous"?A.credentials="omit":A.credentials="same-origin",A}function ee(te){if(te.ep)return;te.ep=!0;const A=d(te);fetch(te.href,A)}})();const Hh=Vi=>new Promise(Ii=>setTimeout(Ii,Vi));window.getValidData=async()=>(await Hh(1e3),{x:[1999,2e3,2001,2002],y:[10,15,13,17]});window.getAnotherValidData=async()=>(await Hh(1e3),{x:[1,2,3,4,5,6,7,8,9],y:[1,2,3,4,5,6,7,8,9]});window.getInvalidData=async()=>(await Hh(2e3),[[1,2,3]]);window.syncFn=()=>[[1,2,3],[4,5,6]];const rg=`.plot-space{height:500px;width:100%;border:1px black dashed;display:flex;align-items:center;justify-content:center}.error-msg{position:relative;color:red;text-align:center;font-weight:600}.error-msg:before{position:absolute;bottom:100%;left:0;right:0;content:"\\274c";font-size:12px;color:red}.loading:after{content:"";box-sizing:border-box;display:block;width:64px;height:64px;margin:8px;border:8px solid #fff;border-radius:50%;animation:lds-ring 1.2s cubic-bezier(.5,0,.5,1) infinite;border-color:blue transparent transparent transparent}.loading{position:relative}.loading:after:nth-child(1){animation-delay:-.45s}.loading:after:nth-child(2){animation-delay:-.3s}.loading:after:nth-child(3){animation-delay:-.15s}@keyframes lds-ring{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`;var nc,rh,tp,nh,rp,ah,np,ih,ap,oh,ip,Sc,Vh,sh,op;const ef=class extends HTMLElement{constructor(d){super();$u(this,rh);$u(this,nh);$u(this,ah);$u(this,ih);$u(this,oh);$u(this,Sc);$u(this,sh);Ef(this,"dataLoaderFn",null);Ef(this,"data",null);$u(this,nc,null);Ef(this,"plotSpace",null);qu(this,ih,ap).call(this),qu(this,rh,tp).call(this,d)}static get attrNames(){return{dataLoader:"dataloader"}}displayError(d,ee){let te=document.createElement("p");throw te.textContent=d,te.classList.add(ef.errorMsgClassName),te.part.add(ef.errorMsgClassName),this.plotSpace.appendChild(te),qu(this,Sc,Vh).call(this),ee}async connectedCallback(){qu(this,oh,ip).call(this),qu(this,sh,op).call(this),await this.validateData(),this.analyzeAndVisualizeData(),qu(this,Sc,Vh).call(this)}get dataLoaderAttr(){return this.getAttribute(ef.attrNames.dataLoader)}};let rc=ef;nc=new WeakMap,rh=new WeakSet,tp=function(d){ep(this,nc,this.attachShadow({mode:"closed"})),qu(this,nh,rp).call(this,d),qu(this,ah,np).call(this)},nh=new WeakSet,rp=function(d){let ee=document.createElement("style");ee.innerHTML=d,Uh(this,nc).appendChild(ee)},ah=new WeakSet,np=function(){this.plotSpace=document.createElement("div"),Uh(this,nc).appendChild(this.plotSpace),this.plotSpace.classList.add(ef.plotSpaceClassName),this.plotSpace.part.add(ef.plotSpaceClassName)},ih=new WeakSet,ap=function(){this.validateData===void 0&&this.displayError("Initialization error",'function "validateData" must be implemented'),this.analyzeAndVisualizeData===void 0&&this.displayError("Initialization error",'function "validateData" must be implemented')},oh=new WeakSet,ip=function(){this.plotSpace.classList.add(ef.loadingClassName)},Sc=new WeakSet,Vh=function(){this.plotSpace.classList.remove(ef.loadingClassName)},sh=new WeakSet,op=function(){this.dataLoaderAttr===""&&this.displayError("Attribute error",'"data-vis" element requires "dataLoader" attribute to be set');let d=window[this.dataLoaderAttr];(d==null||d.constructor.name!=="AsyncFunction")&&this.displayError("dataLoader function error","dataLoader function does not exist or is not async"),this.dataLoaderFn=d},Ef(rc,"loadingClassName","loading"),Ef(rc,"plotSpaceClassName","plot-space"),Ef(rc,"errorMsgClassName","error-msg");var Mo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ng(Vi){return Vi&&Vi.__esModule&&Object.prototype.hasOwnProperty.call(Vi,"default")?Vi.default:Vi}function th(Vi){throw new Error('Could not dynamically require "'+Vi+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sp={exports:{}};(function(Vi,Ii){(function(d){Vi.exports=d()})(function(){return function(){function d(ee,te,A){function g(e,a){if(!te[e]){if(!ee[e]){var n=typeof th=="function"&&th;if(!a&&n)return n(e,!0);if(S)return S(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var t=te[e]={exports:{}};ee[e][0].call(t.exports,function(c){var s=ee[e][1][c];return g(s||c)},t,t.exports,d,ee,te,A)}return te[e].exports}for(var S=typeof th=="function"&&th,M=0;M<A.length;M++)g(A[M]);return g}return d}()({1:[function(d,ee,te){var A=d("../src/lib"),g={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:rgba(0,0,0,0);border:6px solid rgba(0,0,0,0);z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid rgba(0,0,0,0);border-left-color:#69738a;margin-top:8px;margin-right:-30px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var S in g){var M=S.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");A.addStyleRule(M,g[S])}},{"../src/lib":515}],2:[function(d,ee,te){ee.exports=d("../src/transforms/aggregate")},{"../src/transforms/aggregate":1127}],3:[function(d,ee,te){ee.exports=d("../src/traces/bar")},{"../src/traces/bar":665}],4:[function(d,ee,te){ee.exports=d("../src/traces/barpolar")},{"../src/traces/barpolar":678}],5:[function(d,ee,te){ee.exports=d("../src/traces/box")},{"../src/traces/box":688}],6:[function(d,ee,te){ee.exports=d("../src/components/calendars")},{"../src/components/calendars":365}],7:[function(d,ee,te){ee.exports=d("../src/traces/candlestick")},{"../src/traces/candlestick":697}],8:[function(d,ee,te){ee.exports=d("../src/traces/carpet")},{"../src/traces/carpet":716}],9:[function(d,ee,te){ee.exports=d("../src/traces/choropleth")},{"../src/traces/choropleth":730}],10:[function(d,ee,te){ee.exports=d("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":737}],11:[function(d,ee,te){ee.exports=d("../src/traces/cone")},{"../src/traces/cone":743}],12:[function(d,ee,te){ee.exports=d("../src/traces/contour")},{"../src/traces/contour":758}],13:[function(d,ee,te){ee.exports=d("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":769}],14:[function(d,ee,te){ee.exports=d("../src/core")},{"../src/core":493}],15:[function(d,ee,te){ee.exports=d("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":777}],16:[function(d,ee,te){ee.exports=d("../src/transforms/filter")},{"../src/transforms/filter":1128}],17:[function(d,ee,te){ee.exports=d("../src/traces/funnel")},{"../src/traces/funnel":787}],18:[function(d,ee,te){ee.exports=d("../src/traces/funnelarea")},{"../src/traces/funnelarea":796}],19:[function(d,ee,te){ee.exports=d("../src/transforms/groupby")},{"../src/transforms/groupby":1129}],20:[function(d,ee,te){ee.exports=d("../src/traces/heatmap")},{"../src/traces/heatmap":809}],21:[function(d,ee,te){ee.exports=d("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":820}],22:[function(d,ee,te){ee.exports=d("../src/traces/histogram")},{"../src/traces/histogram":832}],23:[function(d,ee,te){ee.exports=d("../src/traces/histogram2d")},{"../src/traces/histogram2d":838}],24:[function(d,ee,te){ee.exports=d("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":842}],25:[function(d,ee,te){ee.exports=d("../src/traces/icicle")},{"../src/traces/icicle":848}],26:[function(d,ee,te){ee.exports=d("../src/traces/image")},{"../src/traces/image":861}],27:[function(d,ee,te){var A=d("./core");A.register([d("./bar"),d("./box"),d("./heatmap"),d("./histogram"),d("./histogram2d"),d("./histogram2dcontour"),d("./contour"),d("./scatterternary"),d("./violin"),d("./funnel"),d("./waterfall"),d("./image"),d("./pie"),d("./sunburst"),d("./treemap"),d("./icicle"),d("./funnelarea"),d("./scatter3d"),d("./surface"),d("./isosurface"),d("./volume"),d("./mesh3d"),d("./cone"),d("./streamtube"),d("./scattergeo"),d("./choropleth"),d("./scattergl"),d("./splom"),d("./pointcloud"),d("./heatmapgl"),d("./parcoords"),d("./parcats"),d("./scattermapbox"),d("./choroplethmapbox"),d("./densitymapbox"),d("./sankey"),d("./indicator"),d("./table"),d("./carpet"),d("./scattercarpet"),d("./contourcarpet"),d("./ohlc"),d("./candlestick"),d("./scatterpolar"),d("./scatterpolargl"),d("./barpolar"),d("./scattersmith"),d("./aggregate"),d("./filter"),d("./groupby"),d("./sort"),d("./calendars")]),ee.exports=A},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(d,ee,te){ee.exports=d("../src/traces/indicator")},{"../src/traces/indicator":869}],29:[function(d,ee,te){ee.exports=d("../src/traces/isosurface")},{"../src/traces/isosurface":875}],30:[function(d,ee,te){ee.exports=d("../src/traces/mesh3d")},{"../src/traces/mesh3d":880}],31:[function(d,ee,te){ee.exports=d("../src/traces/ohlc")},{"../src/traces/ohlc":885}],32:[function(d,ee,te){ee.exports=d("../src/traces/parcats")},{"../src/traces/parcats":894}],33:[function(d,ee,te){ee.exports=d("../src/traces/parcoords")},{"../src/traces/parcoords":905}],34:[function(d,ee,te){ee.exports=d("../src/traces/pie")},{"../src/traces/pie":916}],35:[function(d,ee,te){ee.exports=d("../src/traces/pointcloud")},{"../src/traces/pointcloud":925}],36:[function(d,ee,te){ee.exports=d("../src/traces/sankey")},{"../src/traces/sankey":931}],37:[function(d,ee,te){ee.exports=d("../src/traces/scatter3d")},{"../src/traces/scatter3d":969}],38:[function(d,ee,te){ee.exports=d("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":976}],39:[function(d,ee,te){ee.exports=d("../src/traces/scattergeo")},{"../src/traces/scattergeo":984}],40:[function(d,ee,te){ee.exports=d("../src/traces/scattergl")},{"../src/traces/scattergl":998}],41:[function(d,ee,te){ee.exports=d("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1008}],42:[function(d,ee,te){ee.exports=d("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1016}],43:[function(d,ee,te){ee.exports=d("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1024}],44:[function(d,ee,te){ee.exports=d("../src/traces/scattersmith")},{"../src/traces/scattersmith":1031}],45:[function(d,ee,te){ee.exports=d("../src/traces/scatterternary")},{"../src/traces/scatterternary":1039}],46:[function(d,ee,te){ee.exports=d("../src/transforms/sort")},{"../src/transforms/sort":1131}],47:[function(d,ee,te){ee.exports=d("../src/traces/splom")},{"../src/traces/splom":1049}],48:[function(d,ee,te){ee.exports=d("../src/traces/streamtube")},{"../src/traces/streamtube":1057}],49:[function(d,ee,te){ee.exports=d("../src/traces/sunburst")},{"../src/traces/sunburst":1065}],50:[function(d,ee,te){ee.exports=d("../src/traces/surface")},{"../src/traces/surface":1074}],51:[function(d,ee,te){ee.exports=d("../src/traces/table")},{"../src/traces/table":1082}],52:[function(d,ee,te){ee.exports=d("../src/traces/treemap")},{"../src/traces/treemap":1093}],53:[function(d,ee,te){ee.exports=d("../src/traces/violin")},{"../src/traces/violin":1106}],54:[function(d,ee,te){ee.exports=d("../src/traces/volume")},{"../src/traces/volume":1114}],55:[function(d,ee,te){ee.exports=d("../src/traces/waterfall")},{"../src/traces/waterfall":1122}],56:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,d("d3-array"),d("d3-collection"),d("d3-shape"),d("elementary-circuits-directed-graph")):g(A.d3=A.d3||{},A.d3,A.d3,A.d3,null)})(this,function(A,g,S,M,e){e=e&&e.hasOwnProperty("default")?e.default:e;function a(ce){return ce.target.depth}function n(ce){return ce.depth}function r(ce,de){return de-1-ce.height}function t(ce,de){return ce.sourceLinks.length?ce.depth:de-1}function c(ce){return ce.targetLinks.length?ce.depth:ce.sourceLinks.length?g.min(ce.sourceLinks,a)-1:0}function s(ce){return function(){return ce}}var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ce){return typeof ce}:function(ce){return ce&&typeof Symbol=="function"&&ce.constructor===Symbol&&ce!==Symbol.prototype?"symbol":typeof ce};function x(ce,de){return v(ce.source,de.source)||ce.index-de.index}function p(ce,de){return v(ce.target,de.target)||ce.index-de.index}function v(ce,de){return ce.partOfCycle===de.partOfCycle?ce.y0-de.y0:ce.circularLinkType==="top"||de.circularLinkType==="bottom"?-1:1}function f(ce){return ce.value}function y(ce){return(ce.y0+ce.y1)/2}function o(ce){return y(ce.source)}function m(ce){return y(ce.target)}function l(ce){return ce.index}function w(ce){return ce.nodes}function _(ce){return ce.links}function h(ce,de){var ye=ce.get(de);if(!ye)throw new Error("missing: "+de);return ye}function b(ce,de){return de(ce)}var u=25,L=10,T=.3;function k(){var ce=0,de=0,ye=1,ge=1,me=24,Ee,Pe=l,Ne=t,we=w,ke=_,Xe=32,He=2,Ie,De=null;function Ge(){var St={nodes:we.apply(null,arguments),links:ke.apply(null,arguments)};ht(St),P(St,Pe,De),Rt(St),Mt(St),z(St,Pe),Yt(St,Xe,Pe),zt(St);for(var Ye=4,rt=0;rt<Ye;rt++)Q(St,ge,Pe),ie(St,ge,Pe),$(St,de,ge,Pe),Q(St,ge,Pe),ie(St,ge,Pe);return be(St,de,ge),N(St,He,ge,Pe),St}Ge.nodeId=function(St){return arguments.length?(Pe=typeof St=="function"?St:s(St),Ge):Pe},Ge.nodeAlign=function(St){return arguments.length?(Ne=typeof St=="function"?St:s(St),Ge):Ne},Ge.nodeWidth=function(St){return arguments.length?(me=+St,Ge):me},Ge.nodePadding=function(St){return arguments.length?(Ee=+St,Ge):Ee},Ge.nodes=function(St){return arguments.length?(we=typeof St=="function"?St:s(St),Ge):we},Ge.links=function(St){return arguments.length?(ke=typeof St=="function"?St:s(St),Ge):ke},Ge.size=function(St){return arguments.length?(ce=de=0,ye=+St[0],ge=+St[1],Ge):[ye-ce,ge-de]},Ge.extent=function(St){return arguments.length?(ce=+St[0][0],ye=+St[1][0],de=+St[0][1],ge=+St[1][1],Ge):[[ce,de],[ye,ge]]},Ge.iterations=function(St){return arguments.length?(Xe=+St,Ge):Xe},Ge.circularLinkGap=function(St){return arguments.length?(He=+St,Ge):He},Ge.nodePaddingRatio=function(St){return arguments.length?(Ie=+St,Ge):Ie},Ge.sortNodes=function(St){return arguments.length?(De=St,Ge):De},Ge.update=function(St){return z(St,Pe),zt(St),St.links.forEach(function(Ye){Ye.circular&&(Ye.circularLinkType=Ye.y0+Ye.y1<ge?"top":"bottom",Ye.source.circularLinkType=Ye.circularLinkType,Ye.target.circularLinkType=Ye.circularLinkType)}),Q(St,ge,Pe,!1),ie(St,ge,Pe),N(St,He,ge,Pe),St};function ht(St){St.nodes.forEach(function(rt,Ve){rt.index=Ve,rt.sourceLinks=[],rt.targetLinks=[]});var Ye=S.map(St.nodes,Pe);return St.links.forEach(function(rt,Ve){rt.index=Ve;var Ae=rt.source,Ue=rt.target;(typeof Ae>"u"?"undefined":i(Ae))!=="object"&&(Ae=rt.source=h(Ye,Ae)),(typeof Ue>"u"?"undefined":i(Ue))!=="object"&&(Ue=rt.target=h(Ye,Ue)),Ae.sourceLinks.push(rt),Ue.targetLinks.push(rt)}),St}function Rt(St){St.nodes.forEach(function(Ye){Ye.partOfCycle=!1,Ye.value=Math.max(g.sum(Ye.sourceLinks,f),g.sum(Ye.targetLinks,f)),Ye.sourceLinks.forEach(function(rt){rt.circular&&(Ye.partOfCycle=!0,Ye.circularLinkType=rt.circularLinkType)}),Ye.targetLinks.forEach(function(rt){rt.circular&&(Ye.partOfCycle=!0,Ye.circularLinkType=rt.circularLinkType)})})}function Kt(St){var Ye=0,rt=0,Ve=0,Ae=0,Ue=g.max(St.nodes,function(Ze){return Ze.column});return St.links.forEach(function(Ze){Ze.circular&&(Ze.circularLinkType=="top"?Ye=Ye+Ze.width:rt=rt+Ze.width,Ze.target.column==0&&(Ae=Ae+Ze.width),Ze.source.column==Ue&&(Ve=Ve+Ze.width))}),Ye=Ye>0?Ye+u+L:Ye,rt=rt>0?rt+u+L:rt,Ve=Ve>0?Ve+u+L:Ve,Ae=Ae>0?Ae+u+L:Ae,{top:Ye,bottom:rt,left:Ae,right:Ve}}function It(St,Ye){var rt=g.max(St.nodes,function(gt){return gt.column}),Ve=ye-ce,Ae=ge-de,Ue=Ve+Ye.right+Ye.left,Ze=Ae+Ye.top+Ye.bottom,Qe=Ve/Ue,_t=Ae/Ze;return ce=ce*Qe+Ye.left,ye=Ye.right==0?ye:ye*Qe,de=de*_t+Ye.top,ge=ge*_t,St.nodes.forEach(function(gt){gt.x0=ce+gt.column*((ye-ce-me)/rt),gt.x1=gt.x0+me}),_t}function Mt(St){var Ye,rt,Ve;for(Ye=St.nodes,rt=[],Ve=0;Ye.length;++Ve,Ye=rt,rt=[])Ye.forEach(function(Ae){Ae.depth=Ve,Ae.sourceLinks.forEach(function(Ue){rt.indexOf(Ue.target)<0&&!Ue.circular&&rt.push(Ue.target)})});for(Ye=St.nodes,rt=[],Ve=0;Ye.length;++Ve,Ye=rt,rt=[])Ye.forEach(function(Ae){Ae.height=Ve,Ae.targetLinks.forEach(function(Ue){rt.indexOf(Ue.source)<0&&!Ue.circular&&rt.push(Ue.source)})});St.nodes.forEach(function(Ae){Ae.column=Math.floor(Ne.call(null,Ae,Ve))})}function Yt(St,Ye,rt){var Ve=S.nest().key(function(gt){return gt.column}).sortKeys(g.ascending).entries(St.nodes).map(function(gt){return gt.values});Ze(rt),_t();for(var Ae=1,Ue=Ye;Ue>0;--Ue)Qe(Ae*=.99,rt),_t();function Ze(gt){if(Ie){var wt=1/0;Ve.forEach(function(Xt){var Ht=ge*Ie/(Xt.length+1);wt=Ht<wt?Ht:wt}),Ee=wt}var Ut=g.min(Ve,function(Xt){return(ge-de-(Xt.length-1)*Ee)/g.sum(Xt,f)});Ut=Ut*T,St.links.forEach(function(Xt){Xt.width=Xt.value*Ut});var Dt=Kt(St),Nt=It(St,Dt);Ut=Ut*Nt,St.links.forEach(function(Xt){Xt.width=Xt.value*Ut}),Ve.forEach(function(Xt){var Ht=Xt.length;Xt.forEach(function(ar,Vr){ar.depth==Ve.length-1&&Ht==1||ar.depth==0&&Ht==1?(ar.y0=ge/2-ar.value*Ut,ar.y1=ar.y0+ar.value*Ut):ar.partOfCycle?R(ar,gt)==0?(ar.y0=ge/2+Vr,ar.y1=ar.y0+ar.value*Ut):ar.circularLinkType=="top"?(ar.y0=de+Vr,ar.y1=ar.y0+ar.value*Ut):(ar.y0=ge-ar.value*Ut-Vr,ar.y1=ar.y0+ar.value*Ut):Dt.top==0||Dt.bottom==0?(ar.y0=(ge-de)/Ht*Vr,ar.y1=ar.y0+ar.value*Ut):(ar.y0=(ge-de)/2-Ht/2+Vr,ar.y1=ar.y0+ar.value*Ut)})})}function Qe(gt,wt){var Ut=Ve.length;Ve.forEach(function(Dt){var Nt=Dt.length,Xt=Dt[0].depth;Dt.forEach(function(Ht){var ar;if((Ht.sourceLinks.length||Ht.targetLinks.length)&&!(Ht.partOfCycle&&R(Ht,wt)>0))if(Xt==0&&Nt==1)ar=Ht.y1-Ht.y0,Ht.y0=ge/2-ar/2,Ht.y1=ge/2+ar/2;else if(Xt==Ut-1&&Nt==1)ar=Ht.y1-Ht.y0,Ht.y0=ge/2-ar/2,Ht.y1=ge/2+ar/2;else{var Vr=0,nn=g.mean(Ht.sourceLinks,m),jr=g.mean(Ht.targetLinks,o);nn&&jr?Vr=(nn+jr)/2:Vr=nn||jr;var at=(Vr-y(Ht))*gt;Ht.y0+=at,Ht.y1+=at}})})}function _t(){Ve.forEach(function(gt){var wt,Ut,Dt=de,Nt=gt.length,Xt;for(gt.sort(v),Xt=0;Xt<Nt;++Xt)wt=gt[Xt],Ut=Dt-wt.y0,Ut>0&&(wt.y0+=Ut,wt.y1+=Ut),Dt=wt.y1+Ee;if(Ut=Dt-Ee-ge,Ut>0)for(Dt=wt.y0-=Ut,wt.y1-=Ut,Xt=Nt-2;Xt>=0;--Xt)wt=gt[Xt],Ut=wt.y1+Ee-Dt,Ut>0&&(wt.y0-=Ut,wt.y1-=Ut),Dt=wt.y0})}}function zt(St){St.nodes.forEach(function(Ye){Ye.sourceLinks.sort(p),Ye.targetLinks.sort(x)}),St.nodes.forEach(function(Ye){var rt=Ye.y0,Ve=rt,Ae=Ye.y1,Ue=Ae;Ye.sourceLinks.forEach(function(Ze){Ze.circular?(Ze.y0=Ae-Ze.width/2,Ae=Ae-Ze.width):(Ze.y0=rt+Ze.width/2,rt+=Ze.width)}),Ye.targetLinks.forEach(function(Ze){Ze.circular?(Ze.y1=Ue-Ze.width/2,Ue=Ue-Ze.width):(Ze.y1=Ve+Ze.width/2,Ve+=Ze.width)})})}return Ge}function P(ce,de,ye){var ge=0;if(ye===null){for(var me=[],Ee=0;Ee<ce.links.length;Ee++){var Pe=ce.links[Ee],Ne=Pe.source.index,we=Pe.target.index;me[Ne]||(me[Ne]=[]),me[we]||(me[we]=[]),me[Ne].indexOf(we)===-1&&me[Ne].push(we)}var ke=e(me);ke.sort(function(De,Ge){return De.length-Ge.length});var Xe={};for(Ee=0;Ee<ke.length;Ee++){var He=ke[Ee],Ie=He.slice(-2);Xe[Ie[0]]||(Xe[Ie[0]]={}),Xe[Ie[0]][Ie[1]]=!0}ce.links.forEach(function(De){var Ge=De.target.index,ht=De.source.index;Ge===ht||Xe[ht]&&Xe[ht][Ge]?(De.circular=!0,De.circularLinkID=ge,ge=ge+1):De.circular=!1})}else ce.links.forEach(function(De){De.source[ye]<De.target[ye]?De.circular=!1:(De.circular=!0,De.circularLinkID=ge,ge=ge+1)})}function z(ce,de){var ye=0,ge=0;ce.links.forEach(function(me){me.circular&&(me.source.circularLinkType||me.target.circularLinkType?me.circularLinkType=me.source.circularLinkType?me.source.circularLinkType:me.target.circularLinkType:me.circularLinkType=ye<ge?"top":"bottom",me.circularLinkType=="top"?ye=ye+1:ge=ge+1,ce.nodes.forEach(function(Ee){(b(Ee,de)==b(me.source,de)||b(Ee,de)==b(me.target,de))&&(Ee.circularLinkType=me.circularLinkType)}))}),ce.links.forEach(function(me){me.circular&&(me.source.circularLinkType==me.target.circularLinkType&&(me.circularLinkType=me.source.circularLinkType),oe(me,de)&&(me.circularLinkType=me.source.circularLinkType))})}function I(ce){var de=Math.abs(ce.y1-ce.y0),ye=Math.abs(ce.target.x0-ce.source.x1);return Math.atan(ye/de)}function D(ce,de){return ce.source.column<de.target.column?!1:!(ce.target.column>de.source.column)}function R(ce,de){var ye=0;ce.sourceLinks.forEach(function(me){ye=me.circular&&!oe(me,de)?ye+1:ye});var ge=0;return ce.targetLinks.forEach(function(me){ge=me.circular&&!oe(me,de)?ge+1:ge}),ye+ge}function O(ce){var de=ce.source.sourceLinks,ye=0;de.forEach(function(Ee){ye=Ee.circular?ye+1:ye});var ge=ce.target.targetLinks,me=0;return ge.forEach(function(Ee){me=Ee.circular?me+1:me}),!(ye>1||me>1)}function F(ce,de,ye){return ce.sort(K),ce.forEach(function(ge,me){var Ee=0;if(oe(ge,ye)&&O(ge))ge.circularPathData.verticalBuffer=Ee+ge.width/2;else{var Pe=0;for(Pe;Pe<me;Pe++)if(D(ce[me],ce[Pe])){var Ne=ce[Pe].circularPathData.verticalBuffer+ce[Pe].width/2+de;Ee=Ne>Ee?Ne:Ee}ge.circularPathData.verticalBuffer=Ee+ge.width/2}}),ce}function N(ce,de,ye,ge){var me=5,Ee=g.min(ce.links,function(we){return we.source.y0});ce.links.forEach(function(we){we.circular&&(we.circularPathData={})});var Pe=ce.links.filter(function(we){return we.circularLinkType=="top"});F(Pe,de,ge);var Ne=ce.links.filter(function(we){return we.circularLinkType=="bottom"});F(Ne,de,ge),ce.links.forEach(function(we){if(we.circular){if(we.circularPathData.arcRadius=we.width+L,we.circularPathData.leftNodeBuffer=me,we.circularPathData.rightNodeBuffer=me,we.circularPathData.sourceWidth=we.source.x1-we.source.x0,we.circularPathData.sourceX=we.source.x0+we.circularPathData.sourceWidth,we.circularPathData.targetX=we.target.x0,we.circularPathData.sourceY=we.y0,we.circularPathData.targetY=we.y1,oe(we,ge)&&O(we))we.circularPathData.leftSmallArcRadius=L+we.width/2,we.circularPathData.leftLargeArcRadius=L+we.width/2,we.circularPathData.rightSmallArcRadius=L+we.width/2,we.circularPathData.rightLargeArcRadius=L+we.width/2,we.circularLinkType=="bottom"?(we.circularPathData.verticalFullExtent=we.source.y1+u+we.circularPathData.verticalBuffer,we.circularPathData.verticalLeftInnerExtent=we.circularPathData.verticalFullExtent-we.circularPathData.leftLargeArcRadius,we.circularPathData.verticalRightInnerExtent=we.circularPathData.verticalFullExtent-we.circularPathData.rightLargeArcRadius):(we.circularPathData.verticalFullExtent=we.source.y0-u-we.circularPathData.verticalBuffer,we.circularPathData.verticalLeftInnerExtent=we.circularPathData.verticalFullExtent+we.circularPathData.leftLargeArcRadius,we.circularPathData.verticalRightInnerExtent=we.circularPathData.verticalFullExtent+we.circularPathData.rightLargeArcRadius);else{var ke=we.source.column,Xe=we.circularLinkType,He=ce.links.filter(function(Ge){return Ge.source.column==ke&&Ge.circularLinkType==Xe});we.circularLinkType=="bottom"?He.sort(Y):He.sort(W);var Ie=0;He.forEach(function(Ge,ht){Ge.circularLinkID==we.circularLinkID&&(we.circularPathData.leftSmallArcRadius=L+we.width/2+Ie,we.circularPathData.leftLargeArcRadius=L+we.width/2+ht*de+Ie),Ie=Ie+Ge.width}),ke=we.target.column,He=ce.links.filter(function(Ge){return Ge.target.column==ke&&Ge.circularLinkType==Xe}),we.circularLinkType=="bottom"?He.sort(ue):He.sort(re),Ie=0,He.forEach(function(Ge,ht){Ge.circularLinkID==we.circularLinkID&&(we.circularPathData.rightSmallArcRadius=L+we.width/2+Ie,we.circularPathData.rightLargeArcRadius=L+we.width/2+ht*de+Ie),Ie=Ie+Ge.width}),we.circularLinkType=="bottom"?(we.circularPathData.verticalFullExtent=Math.max(ye,we.source.y1,we.target.y1)+u+we.circularPathData.verticalBuffer,we.circularPathData.verticalLeftInnerExtent=we.circularPathData.verticalFullExtent-we.circularPathData.leftLargeArcRadius,we.circularPathData.verticalRightInnerExtent=we.circularPathData.verticalFullExtent-we.circularPathData.rightLargeArcRadius):(we.circularPathData.verticalFullExtent=Ee-u-we.circularPathData.verticalBuffer,we.circularPathData.verticalLeftInnerExtent=we.circularPathData.verticalFullExtent+we.circularPathData.leftLargeArcRadius,we.circularPathData.verticalRightInnerExtent=we.circularPathData.verticalFullExtent+we.circularPathData.rightLargeArcRadius)}we.circularPathData.leftInnerExtent=we.circularPathData.sourceX+we.circularPathData.leftNodeBuffer,we.circularPathData.rightInnerExtent=we.circularPathData.targetX-we.circularPathData.rightNodeBuffer,we.circularPathData.leftFullExtent=we.circularPathData.sourceX+we.circularPathData.leftLargeArcRadius+we.circularPathData.leftNodeBuffer,we.circularPathData.rightFullExtent=we.circularPathData.targetX-we.circularPathData.rightLargeArcRadius-we.circularPathData.rightNodeBuffer}if(we.circular)we.path=G(we);else{var De=M.linkHorizontal().source(function(Ge){var ht=Ge.source.x0+(Ge.source.x1-Ge.source.x0),Rt=Ge.y0;return[ht,Rt]}).target(function(Ge){var ht=Ge.target.x0,Rt=Ge.y1;return[ht,Rt]});we.path=De(we)}})}function G(ce){var de="";return ce.circularLinkType=="top"?de="M"+ce.circularPathData.sourceX+" "+ce.circularPathData.sourceY+" L"+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.sourceY+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftSmallArcRadius+" 0 0 0 "+ce.circularPathData.leftFullExtent+" "+(ce.circularPathData.sourceY-ce.circularPathData.leftSmallArcRadius)+" L"+ce.circularPathData.leftFullExtent+" "+ce.circularPathData.verticalLeftInnerExtent+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftLargeArcRadius+" 0 0 0 "+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.verticalFullExtent+" L"+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.verticalFullExtent+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightLargeArcRadius+" 0 0 0 "+ce.circularPathData.rightFullExtent+" "+ce.circularPathData.verticalRightInnerExtent+" L"+ce.circularPathData.rightFullExtent+" "+(ce.circularPathData.targetY-ce.circularPathData.rightSmallArcRadius)+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightSmallArcRadius+" 0 0 0 "+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.targetY+" L"+ce.circularPathData.targetX+" "+ce.circularPathData.targetY:de="M"+ce.circularPathData.sourceX+" "+ce.circularPathData.sourceY+" L"+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.sourceY+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftSmallArcRadius+" 0 0 1 "+ce.circularPathData.leftFullExtent+" "+(ce.circularPathData.sourceY+ce.circularPathData.leftSmallArcRadius)+" L"+ce.circularPathData.leftFullExtent+" "+ce.circularPathData.verticalLeftInnerExtent+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftLargeArcRadius+" 0 0 1 "+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.verticalFullExtent+" L"+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.verticalFullExtent+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightLargeArcRadius+" 0 0 1 "+ce.circularPathData.rightFullExtent+" "+ce.circularPathData.verticalRightInnerExtent+" L"+ce.circularPathData.rightFullExtent+" "+(ce.circularPathData.targetY+ce.circularPathData.rightSmallArcRadius)+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightSmallArcRadius+" 0 0 1 "+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.targetY+" L"+ce.circularPathData.targetX+" "+ce.circularPathData.targetY,de}function K(ce,de){return j(ce)==j(de)?ce.circularLinkType=="bottom"?Y(ce,de):W(ce,de):j(de)-j(ce)}function W(ce,de){return ce.y0-de.y0}function Y(ce,de){return de.y0-ce.y0}function re(ce,de){return ce.y1-de.y1}function ue(ce,de){return de.y1-ce.y1}function j(ce){return ce.target.column-ce.source.column}function q(ce){return ce.target.x0-ce.source.x1}function V(ce,de){var ye=I(ce),ge=q(de)/Math.tan(ye),me=ae(ce)=="up"?ce.y1+ge:ce.y1-ge;return me}function U(ce,de){var ye=I(ce),ge=q(de)/Math.tan(ye),me=ae(ce)=="up"?ce.y1-ge:ce.y1+ge;return me}function $(ce,de,ye,ge){ce.links.forEach(function(me){if(!me.circular&&me.target.column-me.source.column>1){var Ee=me.source.column+1,Pe=me.target.column-1,Ne=1,we=Pe-Ee+1;for(Ne=1;Ee<=Pe;Ee++,Ne++)ce.nodes.forEach(function(ke){if(ke.column==Ee){var Xe=Ne/(we+1),He=Math.pow(1-Xe,3),Ie=3*Xe*Math.pow(1-Xe,2),De=3*Math.pow(Xe,2)*(1-Xe),Ge=Math.pow(Xe,3),ht=He*me.y0+Ie*me.y0+De*me.y1+Ge*me.y1,Rt=ht-me.width/2,Kt=ht+me.width/2,It;Rt>ke.y0&&Rt<ke.y1?(It=ke.y1-Rt+10,It=ke.circularLinkType=="bottom"?It:-It,ke=X(ke,It,de,ye),ce.nodes.forEach(function(Mt){b(Mt,ge)==b(ke,ge)||Mt.column!=ke.column||ne(ke,Mt)&&X(Mt,It,de,ye)})):Kt>ke.y0&&Kt<ke.y1?(It=Kt-ke.y0+10,ke=X(ke,It,de,ye),ce.nodes.forEach(function(Mt){b(Mt,ge)==b(ke,ge)||Mt.column!=ke.column||Mt.y0<ke.y1&&Mt.y1>ke.y1&&X(Mt,It,de,ye)})):Rt<ke.y0&&Kt>ke.y1&&(It=Kt-ke.y0+10,ke=X(ke,It,de,ye),ce.nodes.forEach(function(Mt){b(Mt,ge)==b(ke,ge)||Mt.column!=ke.column||Mt.y0<ke.y1&&Mt.y1>ke.y1&&X(Mt,It,de,ye)}))}})}})}function ne(ce,de){return ce.y0>de.y0&&ce.y0<de.y1||ce.y1>de.y0&&ce.y1<de.y1?!0:ce.y0<de.y0&&ce.y1>de.y1}function X(ce,de,ye,ge){return ce.y0+de>=ye&&ce.y1+de<=ge&&(ce.y0=ce.y0+de,ce.y1=ce.y1+de,ce.targetLinks.forEach(function(me){me.y1=me.y1+de}),ce.sourceLinks.forEach(function(me){me.y0=me.y0+de})),ce}function Q(ce,de,ye,ge){ce.nodes.forEach(function(me){ge&&me.y+(me.y1-me.y0)>de&&(me.y=me.y-(me.y+(me.y1-me.y0)-de));var Ee=ce.links.filter(function(we){return b(we.source,ye)==b(me,ye)}),Pe=Ee.length;Pe>1&&Ee.sort(function(we,ke){if(!we.circular&&!ke.circular){if(we.target.column==ke.target.column)return we.y1-ke.y1;if(se(we,ke)){if(we.target.column>ke.target.column){var Xe=U(ke,we);return we.y1-Xe}if(ke.target.column>we.target.column){var He=U(we,ke);return He-ke.y1}}else return we.y1-ke.y1}if(we.circular&&!ke.circular)return we.circularLinkType=="top"?-1:1;if(ke.circular&&!we.circular)return ke.circularLinkType=="top"?1:-1;if(we.circular&&ke.circular)return we.circularLinkType===ke.circularLinkType&&we.circularLinkType=="top"?we.target.column===ke.target.column?we.target.y1-ke.target.y1:ke.target.column-we.target.column:we.circularLinkType===ke.circularLinkType&&we.circularLinkType=="bottom"?we.target.column===ke.target.column?ke.target.y1-we.target.y1:we.target.column-ke.target.column:we.circularLinkType=="top"?-1:1});var Ne=me.y0;Ee.forEach(function(we){we.y0=Ne+we.width/2,Ne=Ne+we.width}),Ee.forEach(function(we,ke){if(we.circularLinkType=="bottom"){var Xe=ke+1,He=0;for(Xe;Xe<Pe;Xe++)He=He+Ee[Xe].width;we.y0=me.y1-He-we.width/2}})})}function ie(ce,de,ye){ce.nodes.forEach(function(ge){var me=ce.links.filter(function(Ne){return b(Ne.target,ye)==b(ge,ye)}),Ee=me.length;Ee>1&&me.sort(function(Ne,we){if(!Ne.circular&&!we.circular){if(Ne.source.column==we.source.column)return Ne.y0-we.y0;if(se(Ne,we)){if(we.source.column<Ne.source.column){var ke=V(we,Ne);return Ne.y0-ke}if(Ne.source.column<we.source.column){var Xe=V(Ne,we);return Xe-we.y0}}else return Ne.y0-we.y0}if(Ne.circular&&!we.circular)return Ne.circularLinkType=="top"?-1:1;if(we.circular&&!Ne.circular)return we.circularLinkType=="top"?1:-1;if(Ne.circular&&we.circular)return Ne.circularLinkType===we.circularLinkType&&Ne.circularLinkType=="top"?Ne.source.column===we.source.column?Ne.source.y1-we.source.y1:Ne.source.column-we.source.column:Ne.circularLinkType===we.circularLinkType&&Ne.circularLinkType=="bottom"?Ne.source.column===we.source.column?Ne.source.y1-we.source.y1:we.source.column-Ne.source.column:Ne.circularLinkType=="top"?-1:1});var Pe=ge.y0;me.forEach(function(Ne){Ne.y1=Pe+Ne.width/2,Pe=Pe+Ne.width}),me.forEach(function(Ne,we){if(Ne.circularLinkType=="bottom"){var ke=we+1,Xe=0;for(ke;ke<Ee;ke++)Xe=Xe+me[ke].width;Ne.y1=ge.y1-Xe-Ne.width/2}})})}function se(ce,de){return ae(ce)==ae(de)}function ae(ce){return ce.y0-ce.y1>0?"up":"down"}function oe(ce,de){return b(ce.source,de)==b(ce.target,de)}function be(ce,de,ye){var ge=ce.nodes,me=ce.links,Ee=!1,Pe=!1;if(me.forEach(function(Ie){Ie.circularLinkType=="top"?Ee=!0:Ie.circularLinkType=="bottom"&&(Pe=!0)}),Ee==!1||Pe==!1){var Ne=g.min(ge,function(Ie){return Ie.y0}),we=g.max(ge,function(Ie){return Ie.y1}),ke=we-Ne,Xe=ye-de,He=Xe/ke;ge.forEach(function(Ie){var De=(Ie.y1-Ie.y0)*He;Ie.y0=(Ie.y0-Ne)*He,Ie.y1=Ie.y0+De}),me.forEach(function(Ie){Ie.y0=(Ie.y0-Ne)*He,Ie.y1=(Ie.y1-Ne)*He,Ie.width=Ie.width*He})}}A.sankeyCircular=k,A.sankeyCenter=c,A.sankeyLeft=n,A.sankeyRight=r,A.sankeyJustify=t,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,d("d3-array"),d("d3-collection"),d("d3-shape")):g(A.d3=A.d3||{},A.d3,A.d3,A.d3)})(this,function(A,g,S,M){function e(L){return L.target.depth}function a(L){return L.depth}function n(L,T){return T-1-L.height}function r(L,T){return L.sourceLinks.length?L.depth:T-1}function t(L){return L.targetLinks.length?L.depth:L.sourceLinks.length?g.min(L.sourceLinks,e)-1:0}function c(L){return function(){return L}}function s(L,T){return x(L.source,T.source)||L.index-T.index}function i(L,T){return x(L.target,T.target)||L.index-T.index}function x(L,T){return L.y0-T.y0}function p(L){return L.value}function v(L){return(L.y0+L.y1)/2}function f(L){return v(L.source)*L.value}function y(L){return v(L.target)*L.value}function o(L){return L.index}function m(L){return L.nodes}function l(L){return L.links}function w(L,T){var k=L.get(T);if(!k)throw new Error("missing: "+T);return k}var _=function(){var L=0,T=0,k=1,P=1,z=24,I=8,D=o,R=r,O=m,F=l,N=32,G=2/3;function K(){var q={nodes:O.apply(null,arguments),links:F.apply(null,arguments)};return W(q),Y(q),re(q),ue(q),j(q),q}K.update=function(q){return j(q),q},K.nodeId=function(q){return arguments.length?(D=typeof q=="function"?q:c(q),K):D},K.nodeAlign=function(q){return arguments.length?(R=typeof q=="function"?q:c(q),K):R},K.nodeWidth=function(q){return arguments.length?(z=+q,K):z},K.nodePadding=function(q){return arguments.length?(I=+q,K):I},K.nodes=function(q){return arguments.length?(O=typeof q=="function"?q:c(q),K):O},K.links=function(q){return arguments.length?(F=typeof q=="function"?q:c(q),K):F},K.size=function(q){return arguments.length?(L=T=0,k=+q[0],P=+q[1],K):[k-L,P-T]},K.extent=function(q){return arguments.length?(L=+q[0][0],k=+q[1][0],T=+q[0][1],P=+q[1][1],K):[[L,T],[k,P]]},K.iterations=function(q){return arguments.length?(N=+q,K):N};function W(q){q.nodes.forEach(function(U,$){U.index=$,U.sourceLinks=[],U.targetLinks=[]});var V=S.map(q.nodes,D);q.links.forEach(function(U,$){U.index=$;var ne=U.source,X=U.target;typeof ne!="object"&&(ne=U.source=w(V,ne)),typeof X!="object"&&(X=U.target=w(V,X)),ne.sourceLinks.push(U),X.targetLinks.push(U)})}function Y(q){q.nodes.forEach(function(V){V.value=Math.max(g.sum(V.sourceLinks,p),g.sum(V.targetLinks,p))})}function re(q){var V,U,$;for(V=q.nodes,U=[],$=0;V.length;++$,V=U,U=[])V.forEach(function(X){X.depth=$,X.sourceLinks.forEach(function(Q){U.indexOf(Q.target)<0&&U.push(Q.target)})});for(V=q.nodes,U=[],$=0;V.length;++$,V=U,U=[])V.forEach(function(X){X.height=$,X.targetLinks.forEach(function(Q){U.indexOf(Q.source)<0&&U.push(Q.source)})});var ne=(k-L-z)/($-1);q.nodes.forEach(function(X){X.x1=(X.x0=L+Math.max(0,Math.min($-1,Math.floor(R.call(null,X,$))))*ne)+z})}function ue(q){var V=S.nest().key(function(se){return se.x0}).sortKeys(g.ascending).entries(q.nodes).map(function(se){return se.values});ne(),ie();for(var U=1,$=N;$>0;--$)Q(U*=.99),ie(),X(U),ie();function ne(){var se=g.max(V,function(be){return be.length}),ae=G*(P-T)/(se-1);I>ae&&(I=ae);var oe=g.min(V,function(be){return(P-T-(be.length-1)*I)/g.sum(be,p)});V.forEach(function(be){be.forEach(function(ce,de){ce.y1=(ce.y0=de)+ce.value*oe})}),q.links.forEach(function(be){be.width=be.value*oe})}function X(se){V.forEach(function(ae){ae.forEach(function(oe){if(oe.targetLinks.length){var be=(g.sum(oe.targetLinks,f)/g.sum(oe.targetLinks,p)-v(oe))*se;oe.y0+=be,oe.y1+=be}})})}function Q(se){V.slice().reverse().forEach(function(ae){ae.forEach(function(oe){if(oe.sourceLinks.length){var be=(g.sum(oe.sourceLinks,y)/g.sum(oe.sourceLinks,p)-v(oe))*se;oe.y0+=be,oe.y1+=be}})})}function ie(){V.forEach(function(se){var ae,oe,be=T,ce=se.length,de;for(se.sort(x),de=0;de<ce;++de)ae=se[de],oe=be-ae.y0,oe>0&&(ae.y0+=oe,ae.y1+=oe),be=ae.y1+I;if(oe=be-I-P,oe>0)for(be=ae.y0-=oe,ae.y1-=oe,de=ce-2;de>=0;--de)ae=se[de],oe=ae.y1+I-be,oe>0&&(ae.y0-=oe,ae.y1-=oe),be=ae.y0})}}function j(q){q.nodes.forEach(function(V){V.sourceLinks.sort(i),V.targetLinks.sort(s)}),q.nodes.forEach(function(V){var U=V.y0,$=U;V.sourceLinks.forEach(function(ne){ne.y0=U+ne.width/2,U+=ne.width}),V.targetLinks.forEach(function(ne){ne.y1=$+ne.width/2,$+=ne.width})})}return K};function h(L){return[L.source.x1,L.y0]}function b(L){return[L.target.x0,L.y1]}var u=function(){return M.linkHorizontal().source(h).target(b)};A.sankey=_,A.sankeyCenter=t,A.sankeyLeft=a,A.sankeyRight=n,A.sankeyJustify=r,A.sankeyLinkHorizontal=u,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(d,ee,te){(function(){var A={version:"3.8.0"},g=[].slice,S=function(le){return g.call(le)},M=self.document;function e(le){return le&&(le.ownerDocument||le.document||le).documentElement}function a(le){return le&&(le.ownerDocument&&le.ownerDocument.defaultView||le.document&&le||le.defaultView)}if(M)try{S(M.documentElement.childNodes)[0].nodeType}catch{S=function(_e){for(var Le=_e.length,Be=new Array(Le);Le--;)Be[Le]=_e[Le];return Be}}if(Date.now||(Date.now=function(){return+new Date}),M)try{M.createElement("DIV").style.setProperty("opacity",0,"")}catch{var n=this.Element.prototype,r=n.setAttribute,t=n.setAttributeNS,c=this.CSSStyleDeclaration.prototype,s=c.setProperty;n.setAttribute=function(_e,Le){r.call(this,_e,Le+"")},n.setAttributeNS=function(_e,Le,Be){t.call(this,_e,Le,Be+"")},c.setProperty=function(_e,Le,Be){s.call(this,_e,Le+"",Be)}}A.ascending=i;function i(le,_e){return le<_e?-1:le>_e?1:le>=_e?0:NaN}A.descending=function(le,_e){return _e<le?-1:_e>le?1:_e>=le?0:NaN},A.min=function(le,_e){var Le=-1,Be=le.length,Oe,Ke;if(arguments.length===1){for(;++Le<Be;)if((Ke=le[Le])!=null&&Ke>=Ke){Oe=Ke;break}for(;++Le<Be;)(Ke=le[Le])!=null&&Oe>Ke&&(Oe=Ke)}else{for(;++Le<Be;)if((Ke=_e.call(le,le[Le],Le))!=null&&Ke>=Ke){Oe=Ke;break}for(;++Le<Be;)(Ke=_e.call(le,le[Le],Le))!=null&&Oe>Ke&&(Oe=Ke)}return Oe},A.max=function(le,_e){var Le=-1,Be=le.length,Oe,Ke;if(arguments.length===1){for(;++Le<Be;)if((Ke=le[Le])!=null&&Ke>=Ke){Oe=Ke;break}for(;++Le<Be;)(Ke=le[Le])!=null&&Ke>Oe&&(Oe=Ke)}else{for(;++Le<Be;)if((Ke=_e.call(le,le[Le],Le))!=null&&Ke>=Ke){Oe=Ke;break}for(;++Le<Be;)(Ke=_e.call(le,le[Le],Le))!=null&&Ke>Oe&&(Oe=Ke)}return Oe},A.extent=function(le,_e){var Le=-1,Be=le.length,Oe,Ke,xt;if(arguments.length===1){for(;++Le<Be;)if((Ke=le[Le])!=null&&Ke>=Ke){Oe=xt=Ke;break}for(;++Le<Be;)(Ke=le[Le])!=null&&(Oe>Ke&&(Oe=Ke),xt<Ke&&(xt=Ke))}else{for(;++Le<Be;)if((Ke=_e.call(le,le[Le],Le))!=null&&Ke>=Ke){Oe=xt=Ke;break}for(;++Le<Be;)(Ke=_e.call(le,le[Le],Le))!=null&&(Oe>Ke&&(Oe=Ke),xt<Ke&&(xt=Ke))}return[Oe,xt]};function x(le){return le===null?NaN:+le}function p(le){return!isNaN(le)}A.sum=function(le,_e){var Le=0,Be=le.length,Oe,Ke=-1;if(arguments.length===1)for(;++Ke<Be;)p(Oe=+le[Ke])&&(Le+=Oe);else for(;++Ke<Be;)p(Oe=+_e.call(le,le[Ke],Ke))&&(Le+=Oe);return Le},A.mean=function(le,_e){var Le=0,Be=le.length,Oe,Ke=-1,xt=Be;if(arguments.length===1)for(;++Ke<Be;)p(Oe=x(le[Ke]))?Le+=Oe:--xt;else for(;++Ke<Be;)p(Oe=x(_e.call(le,le[Ke],Ke)))?Le+=Oe:--xt;if(xt)return Le/xt},A.quantile=function(le,_e){var Le=(le.length-1)*_e+1,Be=Math.floor(Le),Oe=+le[Be-1],Ke=Le-Be;return Ke?Oe+Ke*(le[Be]-Oe):Oe},A.median=function(le,_e){var Le=[],Be=le.length,Oe,Ke=-1;if(arguments.length===1)for(;++Ke<Be;)p(Oe=x(le[Ke]))&&Le.push(Oe);else for(;++Ke<Be;)p(Oe=x(_e.call(le,le[Ke],Ke)))&&Le.push(Oe);if(Le.length)return A.quantile(Le.sort(i),.5)},A.variance=function(le,_e){var Le=le.length,Be=0,Oe,Ke,xt=0,vt=-1,Pt=0;if(arguments.length===1)for(;++vt<Le;)p(Oe=x(le[vt]))&&(Ke=Oe-Be,Be+=Ke/++Pt,xt+=Ke*(Oe-Be));else for(;++vt<Le;)p(Oe=x(_e.call(le,le[vt],vt)))&&(Ke=Oe-Be,Be+=Ke/++Pt,xt+=Ke*(Oe-Be));if(Pt>1)return xt/(Pt-1)},A.deviation=function(){var le=A.variance.apply(this,arguments);return le&&Math.sqrt(le)};function v(le){return{left:function(_e,Le,Be,Oe){for(arguments.length<3&&(Be=0),arguments.length<4&&(Oe=_e.length);Be<Oe;){var Ke=Be+Oe>>>1;le(_e[Ke],Le)<0?Be=Ke+1:Oe=Ke}return Be},right:function(_e,Le,Be,Oe){for(arguments.length<3&&(Be=0),arguments.length<4&&(Oe=_e.length);Be<Oe;){var Ke=Be+Oe>>>1;le(_e[Ke],Le)>0?Oe=Ke:Be=Ke+1}return Be}}}var f=v(i);A.bisectLeft=f.left,A.bisect=A.bisectRight=f.right,A.bisector=function(le){return v(le.length===1?function(_e,Le){return i(le(_e),Le)}:le)},A.shuffle=function(le,_e,Le){(Be=arguments.length)<3&&(Le=le.length,Be<2&&(_e=0));for(var Be=Le-_e,Oe,Ke;Be;)Ke=Math.random()*Be--|0,Oe=le[Be+_e],le[Be+_e]=le[Ke+_e],le[Ke+_e]=Oe;return le},A.permute=function(le,_e){for(var Le=_e.length,Be=new Array(Le);Le--;)Be[Le]=le[_e[Le]];return Be},A.pairs=function(le){for(var _e=0,Le=le.length-1,Be=le[0],Oe=new Array(Le<0?0:Le);_e<Le;)Oe[_e]=[Be,Be=le[++_e]];return Oe},A.transpose=function(le){if(!(Ke=le.length))return[];for(var _e=-1,Le=A.min(le,y),Be=new Array(Le);++_e<Le;)for(var Oe=-1,Ke,xt=Be[_e]=new Array(Ke);++Oe<Ke;)xt[Oe]=le[Oe][_e];return Be};function y(le){return le.length}A.zip=function(){return A.transpose(arguments)},A.keys=function(le){var _e=[];for(var Le in le)_e.push(Le);return _e},A.values=function(le){var _e=[];for(var Le in le)_e.push(le[Le]);return _e},A.entries=function(le){var _e=[];for(var Le in le)_e.push({key:Le,value:le[Le]});return _e},A.merge=function(le){for(var _e=le.length,Le,Be=-1,Oe=0,Ke,xt;++Be<_e;)Oe+=le[Be].length;for(Ke=new Array(Oe);--_e>=0;)for(xt=le[_e],Le=xt.length;--Le>=0;)Ke[--Oe]=xt[Le];return Ke};var o=Math.abs;A.range=function(le,_e,Le){if(arguments.length<3&&(Le=1,arguments.length<2&&(_e=le,le=0)),(_e-le)/Le===1/0)throw new Error("infinite range");var Be=[],Oe=m(o(Le)),Ke=-1,xt;if(le*=Oe,_e*=Oe,Le*=Oe,Le<0)for(;(xt=le+Le*++Ke)>_e;)Be.push(xt/Oe);else for(;(xt=le+Le*++Ke)<_e;)Be.push(xt/Oe);return Be};function m(le){for(var _e=1;le*_e%1;)_e*=10;return _e}function l(le,_e){for(var Le in _e)Object.defineProperty(le.prototype,Le,{value:_e[Le],enumerable:!1})}A.map=function(le,_e){var Le=new w;if(le instanceof w)le.forEach(function(vt,Pt){Le.set(vt,Pt)});else if(Array.isArray(le)){var Be=-1,Oe=le.length,Ke;if(arguments.length===1)for(;++Be<Oe;)Le.set(Be,le[Be]);else for(;++Be<Oe;)Le.set(_e.call(le,Ke=le[Be],Be),Ke)}else for(var xt in le)Le.set(xt,le[xt]);return Le};function w(){this._=Object.create(null)}var _="__proto__",h="\0";l(w,{has:L,get:function(le){return this._[b(le)]},set:function(le,_e){return this._[b(le)]=_e},remove:T,keys:k,values:function(){var le=[];for(var _e in this._)le.push(this._[_e]);return le},entries:function(){var le=[];for(var _e in this._)le.push({key:u(_e),value:this._[_e]});return le},size:P,empty:z,forEach:function(le){for(var _e in this._)le.call(this,u(_e),this._[_e])}});function b(le){return(le+="")===_||le[0]===h?h+le:le}function u(le){return(le+="")[0]===h?le.slice(1):le}function L(le){return b(le)in this._}function T(le){return(le=b(le))in this._&&delete this._[le]}function k(){var le=[];for(var _e in this._)le.push(u(_e));return le}function P(){var le=0;for(var _e in this._)++le;return le}function z(){for(var le in this._)return!1;return!0}A.nest=function(){var le={},_e=[],Le=[],Be,Oe;function Ke(vt,Pt,jt){if(jt>=_e.length)return Oe?Oe.call(le,Pt):Be?Pt.sort(Be):Pt;for(var qt=-1,er=Pt.length,Mr=_e[jt++],Qr,ln,Lr,Nr=new w,Zr;++qt<er;)(Zr=Nr.get(Qr=Mr(ln=Pt[qt])))?Zr.push(ln):Nr.set(Qr,[ln]);return vt?(ln=vt(),Lr=function(an,sn){ln.set(an,Ke(vt,sn,jt))}):(ln={},Lr=function(an,sn){ln[an]=Ke(vt,sn,jt)}),Nr.forEach(Lr),ln}function xt(vt,Pt){if(Pt>=_e.length)return vt;var jt=[],qt=Le[Pt++];return vt.forEach(function(er,Mr){jt.push({key:er,values:xt(Mr,Pt)})}),qt?jt.sort(function(er,Mr){return qt(er.key,Mr.key)}):jt}return le.map=function(vt,Pt){return Ke(Pt,vt,0)},le.entries=function(vt){return xt(Ke(A.map,vt,0),0)},le.key=function(vt){return _e.push(vt),le},le.sortKeys=function(vt){return Le[_e.length-1]=vt,le},le.sortValues=function(vt){return Be=vt,le},le.rollup=function(vt){return Oe=vt,le},le},A.set=function(le){var _e=new I;if(le)for(var Le=0,Be=le.length;Le<Be;++Le)_e.add(le[Le]);return _e};function I(){this._=Object.create(null)}l(I,{has:L,add:function(le){return this._[b(le+="")]=!0,le},remove:T,values:k,size:P,empty:z,forEach:function(le){for(var _e in this._)le.call(this,u(_e))}}),A.behavior={};function D(le){return le}A.rebind=function(le,_e){for(var Le=1,Be=arguments.length,Oe;++Le<Be;)le[Oe=arguments[Le]]=R(le,_e,_e[Oe]);return le};function R(le,_e,Le){return function(){var Be=Le.apply(_e,arguments);return Be===_e?le:Be}}function O(le,_e){if(_e in le)return _e;_e=_e.charAt(0).toUpperCase()+_e.slice(1);for(var Le=0,Be=F.length;Le<Be;++Le){var Oe=F[Le]+_e;if(Oe in le)return Oe}}var F=["webkit","ms","moz","Moz","o","O"];function N(){}A.dispatch=function(){for(var le=new G,_e=-1,Le=arguments.length;++_e<Le;)le[arguments[_e]]=K(le);return le};function G(){}G.prototype.on=function(le,_e){var Le=le.indexOf("."),Be="";if(Le>=0&&(Be=le.slice(Le+1),le=le.slice(0,Le)),le)return arguments.length<2?this[le].on(Be):this[le].on(Be,_e);if(arguments.length===2){if(_e==null)for(le in this)this.hasOwnProperty(le)&&this[le].on(Be,null);return this}};function K(le){var _e=[],Le=new w;function Be(){for(var Oe=_e,Ke=-1,xt=Oe.length,vt;++Ke<xt;)(vt=Oe[Ke].on)&&vt.apply(this,arguments);return le}return Be.on=function(Oe,Ke){var xt=Le.get(Oe),vt;return arguments.length<2?xt&&xt.on:(xt&&(xt.on=null,_e=_e.slice(0,vt=_e.indexOf(xt)).concat(_e.slice(vt+1)),Le.remove(Oe)),Ke&&_e.push(Le.set(Oe,{on:Ke})),le)},Be}A.event=null;function W(){A.event.preventDefault()}function Y(){for(var le=A.event,_e;_e=le.sourceEvent;)le=_e;return le}function re(le){for(var _e=new G,Le=0,Be=arguments.length;++Le<Be;)_e[arguments[Le]]=K(_e);return _e.of=function(Oe,Ke){return function(xt){try{var vt=xt.sourceEvent=A.event;xt.target=le,A.event=xt,_e[xt.type].apply(Oe,Ke)}finally{A.event=vt}}},_e}A.requote=function(le){return le.replace(ue,"\\$&")};var ue=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,j={}.__proto__?function(le,_e){le.__proto__=_e}:function(le,_e){for(var Le in _e)le[Le]=_e[Le]};function q(le){return j(le,ne),le}var V=function(le,_e){return _e.querySelector(le)},U=function(le,_e){return _e.querySelectorAll(le)},$=function(le,_e){var Le=le.matches||le[O(le,"matchesSelector")];return $=function(Be,Oe){return Le.call(Be,Oe)},$(le,_e)};typeof Sizzle=="function"&&(V=function(le,_e){return Sizzle(le,_e)[0]||null},U=Sizzle,$=Sizzle.matchesSelector),A.selection=function(){return A.select(M.documentElement)};var ne=A.selection.prototype=[];ne.select=function(le){var _e=[],Le,Be,Oe,Ke;le=X(le);for(var xt=-1,vt=this.length;++xt<vt;){_e.push(Le=[]),Le.parentNode=(Oe=this[xt]).parentNode;for(var Pt=-1,jt=Oe.length;++Pt<jt;)(Ke=Oe[Pt])?(Le.push(Be=le.call(Ke,Ke.__data__,Pt,xt)),Be&&"__data__"in Ke&&(Be.__data__=Ke.__data__)):Le.push(null)}return q(_e)};function X(le){return typeof le=="function"?le:function(){return V(le,this)}}ne.selectAll=function(le){var _e=[],Le,Be;le=Q(le);for(var Oe=-1,Ke=this.length;++Oe<Ke;)for(var xt=this[Oe],vt=-1,Pt=xt.length;++vt<Pt;)(Be=xt[vt])&&(_e.push(Le=S(le.call(Be,Be.__data__,vt,Oe))),Le.parentNode=Be);return q(_e)};function Q(le){return typeof le=="function"?le:function(){return U(le,this)}}var ie="http://www.w3.org/1999/xhtml",se={svg:"http://www.w3.org/2000/svg",xhtml:ie,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};A.ns={prefix:se,qualify:function(le){var _e=le.indexOf(":"),Le=le;return _e>=0&&(Le=le.slice(0,_e))!=="xmlns"&&(le=le.slice(_e+1)),se.hasOwnProperty(Le)?{space:se[Le],local:le}:le}},ne.attr=function(le,_e){if(arguments.length<2){if(typeof le=="string"){var Le=this.node();return le=A.ns.qualify(le),le.local?Le.getAttributeNS(le.space,le.local):Le.getAttribute(le)}for(_e in le)this.each(ae(_e,le[_e]));return this}return this.each(ae(le,_e))};function ae(le,_e){le=A.ns.qualify(le);function Le(){this.removeAttribute(le)}function Be(){this.removeAttributeNS(le.space,le.local)}function Oe(){this.setAttribute(le,_e)}function Ke(){this.setAttributeNS(le.space,le.local,_e)}function xt(){var Pt=_e.apply(this,arguments);Pt==null?this.removeAttribute(le):this.setAttribute(le,Pt)}function vt(){var Pt=_e.apply(this,arguments);Pt==null?this.removeAttributeNS(le.space,le.local):this.setAttributeNS(le.space,le.local,Pt)}return _e==null?le.local?Be:Le:typeof _e=="function"?le.local?vt:xt:le.local?Ke:Oe}function oe(le){return le.trim().replace(/\s+/g," ")}ne.classed=function(le,_e){if(arguments.length<2){if(typeof le=="string"){var Le=this.node(),Be=(le=ce(le)).length,Oe=-1;if(_e=Le.classList){for(;++Oe<Be;)if(!_e.contains(le[Oe]))return!1}else for(_e=Le.getAttribute("class");++Oe<Be;)if(!be(le[Oe]).test(_e))return!1;return!0}for(_e in le)this.each(de(_e,le[_e]));return this}return this.each(de(le,_e))};function be(le){return new RegExp("(?:^|\\s+)"+A.requote(le)+"(?:\\s+|$)","g")}function ce(le){return(le+"").trim().split(/^|\s+/)}function de(le,_e){le=ce(le).map(ye);var Le=le.length;function Be(){for(var Ke=-1;++Ke<Le;)le[Ke](this,_e)}function Oe(){for(var Ke=-1,xt=_e.apply(this,arguments);++Ke<Le;)le[Ke](this,xt)}return typeof _e=="function"?Oe:Be}function ye(le){var _e=be(le);return function(Le,Be){if(Oe=Le.classList)return Be?Oe.add(le):Oe.remove(le);var Oe=Le.getAttribute("class")||"";Be?(_e.lastIndex=0,_e.test(Oe)||Le.setAttribute("class",oe(Oe+" "+le))):Le.setAttribute("class",oe(Oe.replace(_e," ")))}}ne.style=function(le,_e,Le){var Be=arguments.length;if(Be<3){if(typeof le!="string"){Be<2&&(_e="");for(Le in le)this.each(ge(Le,le[Le],_e));return this}if(Be<2){var Oe=this.node();return a(Oe).getComputedStyle(Oe,null).getPropertyValue(le)}Le=""}return this.each(ge(le,_e,Le))};function ge(le,_e,Le){function Be(){this.style.removeProperty(le)}function Oe(){this.style.setProperty(le,_e,Le)}function Ke(){var xt=_e.apply(this,arguments);xt==null?this.style.removeProperty(le):this.style.setProperty(le,xt,Le)}return _e==null?Be:typeof _e=="function"?Ke:Oe}ne.property=function(le,_e){if(arguments.length<2){if(typeof le=="string")return this.node()[le];for(_e in le)this.each(me(_e,le[_e]));return this}return this.each(me(le,_e))};function me(le,_e){function Le(){delete this[le]}function Be(){this[le]=_e}function Oe(){var Ke=_e.apply(this,arguments);Ke==null?delete this[le]:this[le]=Ke}return _e==null?Le:typeof _e=="function"?Oe:Be}ne.text=function(le){return arguments.length?this.each(typeof le=="function"?function(){var _e=le.apply(this,arguments);this.textContent=_e==null?"":_e}:le==null?function(){this.textContent=""}:function(){this.textContent=le}):this.node().textContent},ne.html=function(le){return arguments.length?this.each(typeof le=="function"?function(){var _e=le.apply(this,arguments);this.innerHTML=_e==null?"":_e}:le==null?function(){this.innerHTML=""}:function(){this.innerHTML=le}):this.node().innerHTML},ne.append=function(le){return le=Ee(le),this.select(function(){return this.appendChild(le.apply(this,arguments))})};function Ee(le){function _e(){var Be=this.ownerDocument,Oe=this.namespaceURI;return Oe===ie&&Be.documentElement.namespaceURI===ie?Be.createElement(le):Be.createElementNS(Oe,le)}function Le(){return this.ownerDocument.createElementNS(le.space,le.local)}return typeof le=="function"?le:(le=A.ns.qualify(le)).local?Le:_e}ne.insert=function(le,_e){return le=Ee(le),_e=X(_e),this.select(function(){return this.insertBefore(le.apply(this,arguments),_e.apply(this,arguments)||null)})},ne.remove=function(){return this.each(Pe)};function Pe(){var le=this.parentNode;le&&le.removeChild(this)}ne.data=function(le,_e){var Le=-1,Be=this.length,Oe,Ke;if(!arguments.length){for(le=new Array(Be=(Oe=this[0]).length);++Le<Be;)(Ke=Oe[Le])&&(le[Le]=Ke.__data__);return le}function xt(qt,er){var Mr,Qr=qt.length,ln=er.length,Lr=Math.min(Qr,ln),Nr=new Array(ln),Zr=new Array(ln),an=new Array(Qr),sn,Kr;if(_e){var Un=new w,ra=new Array(Qr),_a;for(Mr=-1;++Mr<Qr;)(sn=qt[Mr])&&(Un.has(_a=_e.call(sn,sn.__data__,Mr))?an[Mr]=sn:Un.set(_a,sn),ra[Mr]=_a);for(Mr=-1;++Mr<ln;)(sn=Un.get(_a=_e.call(er,Kr=er[Mr],Mr)))?sn!==!0&&(Nr[Mr]=sn,sn.__data__=Kr):Zr[Mr]=Ne(Kr),Un.set(_a,!0);for(Mr=-1;++Mr<Qr;)Mr in ra&&Un.get(ra[Mr])!==!0&&(an[Mr]=qt[Mr])}else{for(Mr=-1;++Mr<Lr;)sn=qt[Mr],Kr=er[Mr],sn?(sn.__data__=Kr,Nr[Mr]=sn):Zr[Mr]=Ne(Kr);for(;Mr<ln;++Mr)Zr[Mr]=Ne(er[Mr]);for(;Mr<Qr;++Mr)an[Mr]=qt[Mr]}Zr.update=Nr,Zr.parentNode=Nr.parentNode=an.parentNode=qt.parentNode,vt.push(Zr),Pt.push(Nr),jt.push(an)}var vt=He([]),Pt=q([]),jt=q([]);if(typeof le=="function")for(;++Le<Be;)xt(Oe=this[Le],le.call(Oe,Oe.parentNode.__data__,Le));else for(;++Le<Be;)xt(Oe=this[Le],le);return Pt.enter=function(){return vt},Pt.exit=function(){return jt},Pt};function Ne(le){return{__data__:le}}ne.datum=function(le){return arguments.length?this.property("__data__",le):this.property("__data__")},ne.filter=function(le){var _e=[],Le,Be,Oe;typeof le!="function"&&(le=we(le));for(var Ke=0,xt=this.length;Ke<xt;Ke++){_e.push(Le=[]),Le.parentNode=(Be=this[Ke]).parentNode;for(var vt=0,Pt=Be.length;vt<Pt;vt++)(Oe=Be[vt])&&le.call(Oe,Oe.__data__,vt,Ke)&&Le.push(Oe)}return q(_e)};function we(le){return function(){return $(this,le)}}ne.order=function(){for(var le=-1,_e=this.length;++le<_e;)for(var Le=this[le],Be=Le.length-1,Oe=Le[Be],Ke;--Be>=0;)(Ke=Le[Be])&&(Oe&&Oe!==Ke.nextSibling&&Oe.parentNode.insertBefore(Ke,Oe),Oe=Ke);return this},ne.sort=function(le){le=ke.apply(this,arguments);for(var _e=-1,Le=this.length;++_e<Le;)this[_e].sort(le);return this.order()};function ke(le){return arguments.length||(le=i),function(_e,Le){return _e&&Le?le(_e.__data__,Le.__data__):!_e-!Le}}ne.each=function(le){return Xe(this,function(_e,Le,Be){le.call(_e,_e.__data__,Le,Be)})};function Xe(le,_e){for(var Le=0,Be=le.length;Le<Be;Le++)for(var Oe=le[Le],Ke=0,xt=Oe.length,vt;Ke<xt;Ke++)(vt=Oe[Ke])&&_e(vt,Ke,Le);return le}ne.call=function(le){var _e=S(arguments);return le.apply(_e[0]=this,_e),this},ne.empty=function(){return!this.node()},ne.node=function(){for(var le=0,_e=this.length;le<_e;le++)for(var Le=this[le],Be=0,Oe=Le.length;Be<Oe;Be++){var Ke=Le[Be];if(Ke)return Ke}return null},ne.size=function(){var le=0;return Xe(this,function(){++le}),le};function He(le){return j(le,Ie),le}var Ie=[];A.selection.enter=He,A.selection.enter.prototype=Ie,Ie.append=ne.append,Ie.empty=ne.empty,Ie.node=ne.node,Ie.call=ne.call,Ie.size=ne.size,Ie.select=function(le){for(var _e=[],Le,Be,Oe,Ke,xt,vt=-1,Pt=this.length;++vt<Pt;){Oe=(Ke=this[vt]).update,_e.push(Le=[]),Le.parentNode=Ke.parentNode;for(var jt=-1,qt=Ke.length;++jt<qt;)(xt=Ke[jt])?(Le.push(Oe[jt]=Be=le.call(Ke.parentNode,xt.__data__,jt,vt)),Be.__data__=xt.__data__):Le.push(null)}return q(_e)},Ie.insert=function(le,_e){return arguments.length<2&&(_e=De(this)),ne.insert.call(this,le,_e)};function De(le){var _e,Le;return function(Be,Oe,Ke){var xt=le[Ke].update,vt=xt.length,Pt;for(Ke!=Le&&(Le=Ke,_e=0),Oe>=_e&&(_e=Oe+1);!(Pt=xt[_e])&&++_e<vt;);return Pt}}A.select=function(le){var _e;return typeof le=="string"?(_e=[V(le,M)],_e.parentNode=M.documentElement):(_e=[le],_e.parentNode=e(le)),q([_e])},A.selectAll=function(le){var _e;return typeof le=="string"?(_e=S(U(le,M)),_e.parentNode=M.documentElement):(_e=S(le),_e.parentNode=null),q([_e])},ne.on=function(le,_e,Le){var Be=arguments.length;if(Be<3){if(typeof le!="string"){Be<2&&(_e=!1);for(Le in le)this.each(Ge(Le,le[Le],_e));return this}if(Be<2)return(Be=this.node()["__on"+le])&&Be._;Le=!1}return this.each(Ge(le,_e,Le))};function Ge(le,_e,Le){var Be="__on"+le,Oe=le.indexOf("."),Ke=Rt;Oe>0&&(le=le.slice(0,Oe));var xt=ht.get(le);xt&&(le=xt,Ke=Kt);function vt(){var qt=this[Be];qt&&(this.removeEventListener(le,qt,qt.$),delete this[Be])}function Pt(){var qt=Ke(_e,S(arguments));vt.call(this),this.addEventListener(le,this[Be]=qt,qt.$=Le),qt._=_e}function jt(){var qt=new RegExp("^__on([^.]+)"+A.requote(le)+"$"),er;for(var Mr in this)if(er=Mr.match(qt)){var Qr=this[Mr];this.removeEventListener(er[1],Qr,Qr.$),delete this[Mr]}}return Oe?_e?Pt:vt:_e?N:jt}var ht=A.map({mouseenter:"mouseover",mouseleave:"mouseout"});M&&ht.forEach(function(le){"on"+le in M&&ht.remove(le)});function Rt(le,_e){return function(Le){var Be=A.event;A.event=Le,_e[0]=this.__data__;try{le.apply(this,_e)}finally{A.event=Be}}}function Kt(le,_e){var Le=Rt(le,_e);return function(Be){var Oe=this,Ke=Be.relatedTarget;(!Ke||Ke!==Oe&&!(Ke.compareDocumentPosition(Oe)&8))&&Le.call(Oe,Be)}}var It,Mt=0;function Yt(le){var _e=".dragsuppress-"+ ++Mt,Le="click"+_e,Be=A.select(a(le)).on("touchmove"+_e,W).on("dragstart"+_e,W).on("selectstart"+_e,W);if(It==null&&(It="onselectstart"in le?!1:O(le.style,"userSelect")),It){var Oe=e(le).style,Ke=Oe[It];Oe[It]="none"}return function(xt){if(Be.on(_e,null),It&&(Oe[It]=Ke),xt){var vt=function(){Be.on(Le,null)};Be.on(Le,function(){W(),vt()},!0),setTimeout(vt,0)}}}A.mouse=function(le){return St(le,Y())};var zt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function St(le,_e){_e.changedTouches&&(_e=_e.changedTouches[0]);var Le=le.ownerSVGElement||le;if(Le.createSVGPoint){var Be=Le.createSVGPoint();if(zt<0){var Oe=a(le);if(Oe.scrollX||Oe.scrollY){Le=A.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var Ke=Le[0][0].getScreenCTM();zt=!(Ke.f||Ke.e),Le.remove()}}return zt?(Be.x=_e.pageX,Be.y=_e.pageY):(Be.x=_e.clientX,Be.y=_e.clientY),Be=Be.matrixTransform(le.getScreenCTM().inverse()),[Be.x,Be.y]}var xt=le.getBoundingClientRect();return[_e.clientX-xt.left-le.clientLeft,_e.clientY-xt.top-le.clientTop]}A.touch=function(le,_e,Le){if(arguments.length<3&&(Le=_e,_e=Y().changedTouches),_e){for(var Be=0,Oe=_e.length,Ke;Be<Oe;++Be)if((Ke=_e[Be]).identifier===Le)return St(le,Ke)}},A.behavior.drag=function(){var le=re(Oe,"drag","dragstart","dragend"),_e=null,Le=Ke(N,A.mouse,a,"mousemove","mouseup"),Be=Ke(Ye,A.touch,D,"touchmove","touchend");function Oe(){this.on("mousedown.drag",Le).on("touchstart.drag",Be)}function Ke(xt,vt,Pt,jt,qt){return function(){var er=this,Mr=A.event.target.correspondingElement||A.event.target,Qr=er.parentNode,ln=le.of(er,arguments),Lr=0,Nr=xt(),Zr=".drag"+(Nr==null?"":"-"+Nr),an,sn=A.select(Pt(Mr)).on(jt+Zr,ra).on(qt+Zr,_a),Kr=Yt(Mr),Un=vt(Qr,Nr);_e?(an=_e.apply(er,arguments),an=[an.x-Un[0],an.y-Un[1]]):an=[0,0],ln({type:"dragstart"});function ra(){var ia=vt(Qr,Nr),ka,la;!ia||(ka=ia[0]-Un[0],la=ia[1]-Un[1],Lr|=ka|la,Un=ia,ln({type:"drag",x:ia[0]+an[0],y:ia[1]+an[1],dx:ka,dy:la}))}function _a(){!vt(Qr,Nr)||(sn.on(jt+Zr,null).on(qt+Zr,null),Kr(Lr),ln({type:"dragend"}))}}}return Oe.origin=function(xt){return arguments.length?(_e=xt,Oe):_e},A.rebind(Oe,le,"on")};function Ye(){return A.event.changedTouches[0].identifier}A.touches=function(le,_e){return arguments.length<2&&(_e=Y().touches),_e?S(_e).map(function(Le){var Be=St(le,Le);return Be.identifier=Le.identifier,Be}):[]};var rt=1e-6,Ve=rt*rt,Ae=Math.PI,Ue=2*Ae,Ze=Ue-rt,Qe=Ae/2,_t=Ae/180,gt=180/Ae;function wt(le,_e,Le){return(_e[0]-le[0])*(Le[1]-le[1])-(_e[1]-le[1])*(Le[0]-le[0])}function Ut(le){return le>1?Qe:le<-1?-Qe:Math.asin(le)}function Dt(le){return((le=Math.exp(le))-1/le)/2}function Nt(le){return((le=Math.exp(le))+1/le)/2}function Xt(le){return((le=Math.exp(2*le))-1)/(le+1)}var Ht=Math.SQRT2,ar=2,Vr=4;A.interpolateZoom=function(le,_e){var Le=le[0],Be=le[1],Oe=le[2],Ke=_e[0],xt=_e[1],vt=_e[2],Pt=Ke-Le,jt=xt-Be,qt=Pt*Pt+jt*jt,er,Mr;if(qt<Ve)Mr=Math.log(vt/Oe)/Ht,er=function(an){return[Le+an*Pt,Be+an*jt,Oe*Math.exp(Ht*an*Mr)]};else{var Qr=Math.sqrt(qt),ln=(vt*vt-Oe*Oe+Vr*qt)/(2*Oe*ar*Qr),Lr=(vt*vt-Oe*Oe-Vr*qt)/(2*vt*ar*Qr),Nr=Math.log(Math.sqrt(ln*ln+1)-ln),Zr=Math.log(Math.sqrt(Lr*Lr+1)-Lr);Mr=(Zr-Nr)/Ht,er=function(an){var sn=an*Mr,Kr=Nt(Nr),Un=Oe/(ar*Qr)*(Kr*Xt(Ht*sn+Nr)-Dt(Nr));return[Le+Un*Pt,Be+Un*jt,Oe*Kr/Nt(Ht*sn+Nr)]}}return er.duration=Mr*1e3,er},A.behavior.zoom=function(){var le={x:0,y:0,k:1},_e,Le,Be,Oe=[960,500],Ke=nn,xt=250,vt=0,Pt="mousedown.zoom",jt="mousemove.zoom",qt="mouseup.zoom",er,Mr="touchstart.zoom",Qr,ln=re(sn,"zoomstart","zoom","zoomend"),Lr,Nr,Zr,an;at||(at="onwheel"in M?(jr=function(){return-A.event.deltaY*(A.event.deltaMode?120:1)},"wheel"):"onmousewheel"in M?(jr=function(){return A.event.wheelDelta},"mousewheel"):(jr=function(){return-A.event.detail},"MozMousePixelScroll"));function sn(fa){fa.on(Pt,$a).on(at+".zoom",ho).on("dblclick.zoom",zi).on(Mr,yi)}sn.event=function(fa){fa.each(function(){var ai=ln.of(this,arguments),Xa=le;Ya?A.select(this).transition().each("start.zoom",function(){le=this.__chart__||{x:0,y:0,k:1},la(ai)}).tween("zoom:zoom",function(){var Si=Oe[0],si=Oe[1],so=Le?Le[0]:Si/2,qi=Le?Le[1]:si/2,mo=A.interpolateZoom([(so-le.x)/le.k,(qi-le.y)/le.k,Si/le.k],[(so-Xa.x)/Xa.k,(qi-Xa.y)/Xa.k,Si/Xa.k]);return function(Wo){var Bo=mo(Wo),Xo=Si/Bo[2];this.__chart__=le={x:so-Bo[0]*Xo,y:qi-Bo[1]*Xo,k:Xo},Na(ai)}}).each("interrupt.zoom",function(){Pa(ai)}).each("end.zoom",function(){Pa(ai)}):(this.__chart__=le,la(ai),Na(ai),Pa(ai))})},sn.translate=function(fa){return arguments.length?(le={x:+fa[0],y:+fa[1],k:le.k},ka(),sn):[le.x,le.y]},sn.scale=function(fa){return arguments.length?(le={x:le.x,y:le.y,k:null},ra(+fa),ka(),sn):le.k},sn.scaleExtent=function(fa){return arguments.length?(Ke=fa==null?nn:[+fa[0],+fa[1]],sn):Ke},sn.center=function(fa){return arguments.length?(Be=fa&&[+fa[0],+fa[1]],sn):Be},sn.size=function(fa){return arguments.length?(Oe=fa&&[+fa[0],+fa[1]],sn):Oe},sn.duration=function(fa){return arguments.length?(xt=+fa,sn):xt},sn.x=function(fa){return arguments.length?(Nr=fa,Lr=fa.copy(),le={x:0,y:0,k:1},sn):Nr},sn.y=function(fa){return arguments.length?(an=fa,Zr=fa.copy(),le={x:0,y:0,k:1},sn):an};function Kr(fa){return[(fa[0]-le.x)/le.k,(fa[1]-le.y)/le.k]}function Un(fa){return[fa[0]*le.k+le.x,fa[1]*le.k+le.y]}function ra(fa){le.k=Math.max(Ke[0],Math.min(Ke[1],fa))}function _a(fa,ai){ai=Un(ai),le.x+=fa[0]-ai[0],le.y+=fa[1]-ai[1]}function ia(fa,ai,Xa,Si){fa.__chart__={x:le.x,y:le.y,k:le.k},ra(Math.pow(2,Si)),_a(Le=ai,Xa),fa=A.select(fa),xt>0&&(fa=fa.transition().duration(xt)),fa.call(sn.event)}function ka(){Nr&&Nr.domain(Lr.range().map(function(fa){return(fa-le.x)/le.k}).map(Lr.invert)),an&&an.domain(Zr.range().map(function(fa){return(fa-le.y)/le.k}).map(Zr.invert))}function la(fa){vt++||fa({type:"zoomstart"})}function Na(fa){ka(),fa({type:"zoom",scale:le.k,translate:[le.x,le.y]})}function Pa(fa){--vt||(fa({type:"zoomend"}),Le=null)}function $a(){var fa=this,ai=ln.of(fa,arguments),Xa=0,Si=A.select(a(fa)).on(jt,qi).on(qt,mo),si=Kr(A.mouse(fa)),so=Yt(fa);Dn.call(fa),la(ai);function qi(){Xa=1,_a(A.mouse(fa),si),Na(ai)}function mo(){Si.on(jt,null).on(qt,null),so(Xa),Pa(ai)}}function yi(){var fa=this,ai=ln.of(fa,arguments),Xa={},Si=0,si,so=".zoom-"+A.event.changedTouches[0].identifier,qi="touchmove"+so,mo="touchend"+so,Wo=[],Bo=A.select(fa),Xo=Yt(fa);Ni(),la(ai),Bo.on(Pt,null).on(Mr,Ni);function Wi(){var _o=A.touches(fa);return si=le.k,_o.forEach(function(ro){ro.identifier in Xa&&(Xa[ro.identifier]=Kr(ro))}),_o}function Ni(){var _o=A.event.target;A.select(_o).on(qi,Ia).on(mo,Za),Wo.push(_o);for(var ro=A.event.changedTouches,Ro=0,ji=ro.length;Ro<ji;++Ro)Xa[ro[Ro].identifier]=null;var Zo=Wi(),bs=Date.now();if(Zo.length===1){if(bs-Qr<500){var Ul=Zo[0];ia(fa,Ul,Xa[Ul.identifier],Math.floor(Math.log(le.k)/Math.LN2)+1),W()}Qr=bs}else if(Zo.length>1){var Ul=Zo[0],Ki=Zo[1],rf=Ul[0]-Ki[0],Ml=Ul[1]-Ki[1];Si=rf*rf+Ml*Ml}}function Ia(){var _o=A.touches(fa),ro,Ro,ji,Zo;Dn.call(fa);for(var bs=0,Ul=_o.length;bs<Ul;++bs,Zo=null)if(ji=_o[bs],Zo=Xa[ji.identifier]){if(Ro)break;ro=ji,Ro=Zo}if(Zo){var Ki=(Ki=ji[0]-ro[0])*Ki+(Ki=ji[1]-ro[1])*Ki,rf=Si&&Math.sqrt(Ki/Si);ro=[(ro[0]+ji[0])/2,(ro[1]+ji[1])/2],Ro=[(Ro[0]+Zo[0])/2,(Ro[1]+Zo[1])/2],ra(rf*si)}Qr=null,_a(ro,Ro),Na(ai)}function Za(){if(A.event.touches.length){for(var _o=A.event.changedTouches,ro=0,Ro=_o.length;ro<Ro;++ro)delete Xa[_o[ro].identifier];for(var ji in Xa)return void Wi()}A.selectAll(Wo).on(so,null),Bo.on(Pt,$a).on(Mr,yi),Xo(),Pa(ai)}}function ho(){var fa=ln.of(this,arguments);er?clearTimeout(er):(Dn.call(this),_e=Kr(Le=Be||A.mouse(this)),la(fa)),er=setTimeout(function(){er=null,Pa(fa)},50),W(),ra(Math.pow(2,jr()*.002)*le.k),_a(Le,_e),Na(fa)}function zi(){var fa=A.mouse(this),ai=Math.log(le.k)/Math.LN2;ia(this,fa,Kr(fa),A.event.shiftKey?Math.ceil(ai)-1:Math.floor(ai)+1)}return A.rebind(sn,ln,"on")};var nn=[0,1/0],jr,at;A.color=$t;function $t(){}$t.prototype.toString=function(){return this.rgb()+""},A.hsl=Zt;function Zt(le,_e,Le){return this instanceof Zt?(this.h=+le,this.s=+_e,void(this.l=+Le)):arguments.length<2?le instanceof Zt?new Zt(le.h,le.s,le.l):Wr(""+le,nr,Zt):new Zt(le,_e,Le)}var ur=Zt.prototype=new $t;ur.brighter=function(le){return le=Math.pow(.7,arguments.length?le:1),new Zt(this.h,this.s,this.l/le)},ur.darker=function(le){return le=Math.pow(.7,arguments.length?le:1),new Zt(this.h,this.s,le*this.l)},ur.rgb=function(){return wr(this.h,this.s,this.l)};function wr(le,_e,Le){var Be,Oe;le=isNaN(le)?0:(le%=360)<0?le+360:le,_e=isNaN(_e)||_e<0?0:_e>1?1:_e,Le=Le<0?0:Le>1?1:Le,Oe=Le<=.5?Le*(1+_e):Le+_e-Le*_e,Be=2*Le-Oe;function Ke(vt){return vt>360?vt-=360:vt<0&&(vt+=360),vt<60?Be+(Oe-Be)*vt/60:vt<180?Oe:vt<240?Be+(Oe-Be)*(240-vt)/60:Be}function xt(vt){return Math.round(Ke(vt)*255)}return new Gt(xt(le+120),xt(le),xt(le-120))}A.hcl=$e;function $e(le,_e,Le){return this instanceof $e?(this.h=+le,this.c=+_e,void(this.l=+Le)):arguments.length<2?le instanceof $e?new $e(le.h,le.c,le.l):le instanceof lt?ct(le.l,le.a,le.b):ct((le=yr((le=A.rgb(le)).r,le.g,le.b)).l,le.a,le.b):new $e(le,_e,Le)}var Je=$e.prototype=new $t;Je.brighter=function(le){return new $e(this.h,this.c,Math.min(100,this.l+Tt*(arguments.length?le:1)))},Je.darker=function(le){return new $e(this.h,this.c,Math.max(0,this.l-Tt*(arguments.length?le:1)))},Je.rgb=function(){return it(this.h,this.c,this.l).rgb()};function it(le,_e,Le){return isNaN(le)&&(le=0),isNaN(_e)&&(_e=0),new lt(Le,Math.cos(le*=_t)*_e,Math.sin(le)*_e)}A.lab=lt;function lt(le,_e,Le){return this instanceof lt?(this.l=+le,this.a=+_e,void(this.b=+Le)):arguments.length<2?le instanceof lt?new lt(le.l,le.a,le.b):le instanceof $e?it(le.h,le.c,le.l):yr((le=Gt(le)).r,le.g,le.b):new lt(le,_e,Le)}var Tt=18,Bt=.95047,Ce=1,Me=1.08883,nt=lt.prototype=new $t;nt.brighter=function(le){return new lt(Math.min(100,this.l+Tt*(arguments.length?le:1)),this.a,this.b)},nt.darker=function(le){return new lt(Math.max(0,this.l-Tt*(arguments.length?le:1)),this.a,this.b)},nt.rgb=function(){return st(this.l,this.a,this.b)};function st(le,_e,Le){var Be=(le+16)/116,Oe=Be+_e/500,Ke=Be-Le/200;return Oe=At(Oe)*Bt,Be=At(Be)*Ce,Ke=At(Ke)*Me,new Gt(Ct(3.2404542*Oe-1.5371385*Be-.4985314*Ke),Ct(-.969266*Oe+1.8760108*Be+.041556*Ke),Ct(.0556434*Oe-.2040259*Be+1.0572252*Ke))}function ct(le,_e,Le){return le>0?new $e(Math.atan2(Le,_e)*gt,Math.sqrt(_e*_e+Le*Le),le):new $e(NaN,NaN,le)}function At(le){return le>.206893034?le*le*le:(le-4/29)/7.787037}function dt(le){return le>.008856?Math.pow(le,1/3):7.787037*le+4/29}function Ct(le){return Math.round(255*(le<=.00304?12.92*le:1.055*Math.pow(le,1/2.4)-.055))}A.rgb=Gt;function Gt(le,_e,Le){return this instanceof Gt?(this.r=~~le,this.g=~~_e,void(this.b=~~Le)):arguments.length<2?le instanceof Gt?new Gt(le.r,le.g,le.b):Wr(""+le,Gt,wr):new Gt(le,_e,Le)}function rr(le){return new Gt(le>>16,le>>8&255,le&255)}function kr(le){return rr(le)+""}var br=Gt.prototype=new $t;br.brighter=function(le){le=Math.pow(.7,arguments.length?le:1);var _e=this.r,Le=this.g,Be=this.b,Oe=30;return!_e&&!Le&&!Be?new Gt(Oe,Oe,Oe):(_e&&_e<Oe&&(_e=Oe),Le&&Le<Oe&&(Le=Oe),Be&&Be<Oe&&(Be=Oe),new Gt(Math.min(255,_e/le),Math.min(255,Le/le),Math.min(255,Be/le)))},br.darker=function(le){return le=Math.pow(.7,arguments.length?le:1),new Gt(le*this.r,le*this.g,le*this.b)},br.hsl=function(){return nr(this.r,this.g,this.b)},br.toString=function(){return"#"+Ar(this.r)+Ar(this.g)+Ar(this.b)};function Ar(le){return le<16?"0"+Math.max(0,le).toString(16):Math.min(255,le).toString(16)}function Wr(le,_e,Le){var Be=0,Oe=0,Ke=0,xt,vt,Pt;if(xt=/([a-z]+)\((.*)\)/.exec(le=le.toLowerCase()),xt)switch(vt=xt[2].split(","),xt[1]){case"hsl":return Le(parseFloat(vt[0]),parseFloat(vt[1])/100,parseFloat(vt[2])/100);case"rgb":return _e(Or(vt[0]),Or(vt[1]),Or(vt[2]))}return(Pt=Sr.get(le))?_e(Pt.r,Pt.g,Pt.b):(le!=null&&le.charAt(0)==="#"&&!isNaN(Pt=parseInt(le.slice(1),16))&&(le.length===4?(Be=(Pt&3840)>>4,Be=Be>>4|Be,Oe=Pt&240,Oe=Oe>>4|Oe,Ke=Pt&15,Ke=Ke<<4|Ke):le.length===7&&(Be=(Pt&16711680)>>16,Oe=(Pt&65280)>>8,Ke=Pt&255)),_e(Be,Oe,Ke))}function nr(le,_e,Le){var Be=Math.min(le/=255,_e/=255,Le/=255),Oe=Math.max(le,_e,Le),Ke=Oe-Be,xt,vt,Pt=(Oe+Be)/2;return Ke?(vt=Pt<.5?Ke/(Oe+Be):Ke/(2-Oe-Be),le==Oe?xt=(_e-Le)/Ke+(_e<Le?6:0):_e==Oe?xt=(Le-le)/Ke+2:xt=(le-_e)/Ke+4,xt*=60):(xt=NaN,vt=Pt>0&&Pt<1?0:xt),new Zt(xt,vt,Pt)}function yr(le,_e,Le){le=Pr(le),_e=Pr(_e),Le=Pr(Le);var Be=dt((.4124564*le+.3575761*_e+.1804375*Le)/Bt),Oe=dt((.2126729*le+.7151522*_e+.072175*Le)/Ce),Ke=dt((.0193339*le+.119192*_e+.9503041*Le)/Me);return lt(116*Oe-16,500*(Be-Oe),200*(Oe-Ke))}function Pr(le){return(le/=255)<=.04045?le/12.92:Math.pow((le+.055)/1.055,2.4)}function Or(le){var _e=parseFloat(le);return le.charAt(le.length-1)==="%"?Math.round(_e*2.55):_e}var Sr=A.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Sr.forEach(function(le,_e){Sr.set(le,rr(_e))});function tt(le){return typeof le=="function"?le:function(){return le}}A.functor=tt,A.xhr=Lt(D);function Lt(le){return function(_e,Le,Be){return arguments.length===2&&typeof Le=="function"&&(Be=Le,Le=null),Wt(_e,Le,le,Be)}}function Wt(le,_e,Le,Be){var Oe={},Ke=A.dispatch("beforesend","progress","load","error"),xt={},vt=new XMLHttpRequest,Pt=null;self.XDomainRequest&&!("withCredentials"in vt)&&/^(http(s)?:)?\/\//.test(le)&&(vt=new XDomainRequest),"onload"in vt?vt.onload=vt.onerror=jt:vt.onreadystatechange=function(){vt.readyState>3&&jt()};function jt(){var qt=vt.status,er;if(!qt&&Ir(vt)||qt>=200&&qt<300||qt===304){try{er=Le.call(Oe,vt)}catch(Mr){Ke.error.call(Oe,Mr);return}Ke.load.call(Oe,er)}else Ke.error.call(Oe,vt)}return vt.onprogress=function(qt){var er=A.event;A.event=qt;try{Ke.progress.call(Oe,vt)}finally{A.event=er}},Oe.header=function(qt,er){return qt=(qt+"").toLowerCase(),arguments.length<2?xt[qt]:(er==null?delete xt[qt]:xt[qt]=er+"",Oe)},Oe.mimeType=function(qt){return arguments.length?(_e=qt==null?null:qt+"",Oe):_e},Oe.responseType=function(qt){return arguments.length?(Pt=qt,Oe):Pt},Oe.response=function(qt){return Le=qt,Oe},["get","post"].forEach(function(qt){Oe[qt]=function(){return Oe.send.apply(Oe,[qt].concat(S(arguments)))}}),Oe.send=function(qt,er,Mr){if(arguments.length===2&&typeof er=="function"&&(Mr=er,er=null),vt.open(qt,le,!0),_e!=null&&!("accept"in xt)&&(xt.accept=_e+",*/*"),vt.setRequestHeader)for(var Qr in xt)vt.setRequestHeader(Qr,xt[Qr]);return _e!=null&&vt.overrideMimeType&&vt.overrideMimeType(_e),Pt!=null&&(vt.responseType=Pt),Mr!=null&&Oe.on("error",Mr).on("load",function(ln){Mr(null,ln)}),Ke.beforesend.call(Oe,vt),vt.send(er==null?null:er),Oe},Oe.abort=function(){return vt.abort(),Oe},A.rebind(Oe,Ke,"on"),Be==null?Oe:Oe.get(ir(Be))}function ir(le){return le.length===1?function(_e,Le){le(_e==null?Le:null)}:le}function Ir(le){var _e=le.responseType;return _e&&_e!=="text"?le.response:le.responseText}A.dsv=function(le,_e){var Le=new RegExp('["'+le+`
]`),Be=le.charCodeAt(0);function Oe(jt,qt,er){arguments.length<3&&(er=qt,qt=null);var Mr=Wt(jt,_e,qt==null?Ke:xt(qt),er);return Mr.row=function(Qr){return arguments.length?Mr.response((qt=Qr)==null?Ke:xt(Qr)):qt},Mr}function Ke(jt){return Oe.parse(jt.responseText)}function xt(jt){return function(qt){return Oe.parse(qt.responseText,jt)}}Oe.parse=function(jt,qt){var er;return Oe.parseRows(jt,function(Mr,Qr){if(er)return er(Mr,Qr-1);var ln=function(Lr){for(var Nr={},Zr=Mr.length,an=0;an<Zr;++an)Nr[Mr[an]]=Lr[an];return Nr};er=qt?function(Lr,Nr){return qt(ln(Lr),Nr)}:ln})},Oe.parseRows=function(jt,qt){var er={},Mr={},Qr=[],ln=jt.length,Lr=0,Nr=0,Zr,an;function sn(){if(Lr>=ln)return Mr;if(an)return an=!1,er;var Un=Lr;if(jt.charCodeAt(Un)===34){for(var ra=Un;ra++<ln;)if(jt.charCodeAt(ra)===34){if(jt.charCodeAt(ra+1)!==34)break;++ra}Lr=ra+2;var _a=jt.charCodeAt(ra+1);return _a===13?(an=!0,jt.charCodeAt(ra+2)===10&&++Lr):_a===10&&(an=!0),jt.slice(Un+1,ra).replace(/""/g,'"')}for(;Lr<ln;){var _a=jt.charCodeAt(Lr++),ia=1;if(_a===10)an=!0;else if(_a===13)an=!0,jt.charCodeAt(Lr)===10&&(++Lr,++ia);else if(_a!==Be)continue;return jt.slice(Un,Lr-ia)}return jt.slice(Un)}for(;(Zr=sn())!==Mr;){for(var Kr=[];Zr!==er&&Zr!==Mr;)Kr.push(Zr),Zr=sn();qt&&(Kr=qt(Kr,Nr++))==null||Qr.push(Kr)}return Qr},Oe.format=function(jt){if(Array.isArray(jt[0]))return Oe.formatRows(jt);var qt=new I,er=[];return jt.forEach(function(Mr){for(var Qr in Mr)qt.has(Qr)||er.push(qt.add(Qr))}),[er.map(Pt).join(le)].concat(jt.map(function(Mr){return er.map(function(Qr){return Pt(Mr[Qr])}).join(le)})).join(`
`)},Oe.formatRows=function(jt){return jt.map(vt).join(`
`)};function vt(jt){return jt.map(Pt).join(le)}function Pt(jt){return Le.test(jt)?'"'+jt.replace(/\"/g,'""')+'"':jt}return Oe},A.csv=A.dsv(",","text/csv"),A.tsv=A.dsv("	","text/tab-separated-values");var Br,Er,_r,Gr,wn=this[O(this,"requestAnimationFrame")]||function(le){setTimeout(le,17)};A.timer=function(){cn.apply(this,arguments)};function cn(le,_e,Le){var Be=arguments.length;Be<2&&(_e=0),Be<3&&(Le=Date.now());var Oe=Le+_e,Ke={c:le,t:Oe,n:null};return Er?Er.n=Ke:Br=Ke,Er=Ke,_r||(Gr=clearTimeout(Gr),_r=1,wn(Bn)),Ke}function Bn(){var le=En(),_e=Yn()-le;_e>24?(isFinite(_e)&&(clearTimeout(Gr),Gr=setTimeout(Bn,_e)),_r=0):(_r=1,wn(Bn))}A.timer.flush=function(){En(),Yn()};function En(){for(var le=Date.now(),_e=Br;_e;)le>=_e.t&&_e.c(le-_e.t)&&(_e.c=null),_e=_e.n;return le}function Yn(){for(var le,_e=Br,Le=1/0;_e;)_e.c?(_e.t<Le&&(Le=_e.t),_e=(le=_e).n):_e=le?le.n=_e.n:Br=_e.n;return Er=le,Le}A.round=function(le,_e){return _e?Math.round(le*(_e=Math.pow(10,_e)))/_e:Math.round(le)},A.geom={};function Hn(le){return le[0]}function pa(le){return le[1]}A.geom.hull=function(le){var _e=Hn,Le=pa;if(arguments.length)return Be(le);function Be(Oe){if(Oe.length<3)return[];var Ke=tt(_e),xt=tt(Le),vt,Pt=Oe.length,jt=[],qt=[];for(vt=0;vt<Pt;vt++)jt.push([+Ke.call(this,Oe[vt],vt),+xt.call(this,Oe[vt],vt),vt]);for(jt.sort(ci),vt=0;vt<Pt;vt++)qt.push([jt[vt][0],-jt[vt][1]]);var er=Ma(jt),Mr=Ma(qt),Qr=Mr[0]===er[0],ln=Mr[Mr.length-1]===er[er.length-1],Lr=[];for(vt=er.length-1;vt>=0;--vt)Lr.push(Oe[jt[er[vt]][2]]);for(vt=+Qr;vt<Mr.length-ln;++vt)Lr.push(Oe[jt[Mr[vt]][2]]);return Lr}return Be.x=function(Oe){return arguments.length?(_e=Oe,Be):_e},Be.y=function(Oe){return arguments.length?(Le=Oe,Be):Le},Be};function Ma(le){for(var _e=le.length,Le=[0,1],Be=2,Oe=2;Oe<_e;Oe++){for(;Be>1&&wt(le[Le[Be-2]],le[Le[Be-1]],le[Oe])<=0;)--Be;Le[Be++]=Oe}return Le.slice(0,Be)}function ci(le,_e){return le[0]-_e[0]||le[1]-_e[1]}A.geom.polygon=function(le){return j(le,Ha),le};var Ha=A.geom.polygon.prototype=[];Ha.area=function(){for(var le=-1,_e=this.length,Le,Be=this[_e-1],Oe=0;++le<_e;)Le=Be,Be=this[le],Oe+=Le[1]*Be[0]-Le[0]*Be[1];return Oe*.5},Ha.centroid=function(le){var _e=-1,Le=this.length,Be=0,Oe=0,Ke,xt=this[Le-1],vt;for(arguments.length||(le=-1/(6*this.area()));++_e<Le;)Ke=xt,xt=this[_e],vt=Ke[0]*xt[1]-xt[0]*Ke[1],Be+=(Ke[0]+xt[0])*vt,Oe+=(Ke[1]+xt[1])*vt;return[Be*le,Oe*le]},Ha.clip=function(le){for(var _e,Le=Tr(le),Be=-1,Oe=this.length-Tr(this),Ke,xt,vt=this[Oe-1],Pt,jt,qt;++Be<Oe;){for(_e=le.slice(),le.length=0,Pt=this[Be],jt=_e[(xt=_e.length-Le)-1],Ke=-1;++Ke<xt;)qt=_e[Ke],ja(qt,vt,Pt)?(ja(jt,vt,Pt)||le.push(Wa(jt,qt,vt,Pt)),le.push(qt)):ja(jt,vt,Pt)&&le.push(Wa(jt,qt,vt,Pt)),jt=qt;Le&&le.push(le[0]),vt=Pt}return le};function ja(le,_e,Le){return(Le[0]-_e[0])*(le[1]-_e[1])<(Le[1]-_e[1])*(le[0]-_e[0])}function Wa(le,_e,Le,Be){var Oe=le[0],Ke=Le[0],xt=_e[0]-Oe,vt=Be[0]-Ke,Pt=le[1],jt=Le[1],qt=_e[1]-Pt,er=Be[1]-jt,Mr=(vt*(Pt-jt)-er*(Oe-Ke))/(er*xt-vt*qt);return[Oe+Mr*xt,Pt+Mr*qt]}function Tr(le){var _e=le[0],Le=le[le.length-1];return!(_e[0]-Le[0]||_e[1]-Le[1])}var pn,fn,An,Zn=[],ua,ea,Rn=[];function Xn(){sa(this),this.edge=this.site=this.circle=null}function Ua(le){var _e=Zn.pop()||new Xn;return _e.site=le,_e}function li(le){mr(le),An.remove(le),Zn.push(le),sa(le)}function Vt(le){var _e=le.circle,Le=_e.x,Be=_e.cy,Oe={x:Le,y:Be},Ke=le.P,xt=le.N,vt=[le];li(le);for(var Pt=Ke;Pt.circle&&o(Le-Pt.circle.x)<rt&&o(Be-Pt.circle.cy)<rt;)Ke=Pt.P,vt.unshift(Pt),li(Pt),Pt=Ke;vt.unshift(Pt),mr(Pt);for(var jt=xt;jt.circle&&o(Le-jt.circle.x)<rt&&o(Be-jt.circle.cy)<rt;)xt=jt.N,vt.push(jt),li(jt),jt=xt;vt.push(jt),mr(jt);var qt=vt.length,er;for(er=1;er<qt;++er)jt=vt[er],Pt=vt[er-1],aa(jt.edge,Pt.site,jt.site,Oe);Pt=vt[0],jt=vt[qt-1],jt.edge=_n(Pt.site,jt.site,null,Oe),gr(Pt),gr(jt)}function hr(le){for(var _e=le.x,Le=le.y,Be,Oe,Ke,xt,vt=An._;vt;)if(Ke=rn(vt,Le)-_e,Ke>rt)vt=vt.L;else if(xt=_e-vn(vt,Le),xt>rt){if(!vt.R){Be=vt;break}vt=vt.R}else{Ke>-rt?(Be=vt.P,Oe=vt):xt>-rt?(Be=vt,Oe=vt.N):Be=Oe=vt;break}var Pt=Ua(le);if(An.insert(Be,Pt),!(!Be&&!Oe)){if(Be===Oe){mr(Be),Oe=Ua(Be.site),An.insert(Pt,Oe),Pt.edge=Oe.edge=_n(Be.site,Pt.site),gr(Be),gr(Oe);return}if(!Oe){Pt.edge=_n(Be.site,Pt.site);return}mr(Be),mr(Oe);var jt=Be.site,qt=jt.x,er=jt.y,Mr=le.x-qt,Qr=le.y-er,ln=Oe.site,Lr=ln.x-qt,Nr=ln.y-er,Zr=2*(Mr*Nr-Qr*Lr),an=Mr*Mr+Qr*Qr,sn=Lr*Lr+Nr*Nr,Kr={x:(Nr*an-Qr*sn)/Zr+qt,y:(Mr*sn-Lr*an)/Zr+er};aa(Oe.edge,jt,ln,Kr),Pt.edge=_n(jt,le,null,Kr),Oe.edge=_n(le,ln,null,Kr),gr(Be),gr(Oe)}}function rn(le,_e){var Le=le.site,Be=Le.x,Oe=Le.y,Ke=Oe-_e;if(!Ke)return Be;var xt=le.P;if(!xt)return-1/0;Le=xt.site;var vt=Le.x,Pt=Le.y,jt=Pt-_e;if(!jt)return vt;var qt=vt-Be,er=1/Ke-1/jt,Mr=qt/jt;return er?(-Mr+Math.sqrt(Mr*Mr-2*er*(qt*qt/(-2*jt)-Pt+jt/2+Oe-Ke/2)))/er+Be:(Be+vt)/2}function vn(le,_e){var Le=le.N;if(Le)return rn(Le,_e);var Be=le.site;return Be.y===_e?Be.x:1/0}function en(le){this.site=le,this.edges=[]}en.prototype.prepare=function(){for(var le=this.edges,_e=le.length,Le;_e--;)Le=le[_e].edge,(!Le.b||!Le.a)&&le.splice(_e,1);return le.sort(xn),le.length};function Tn(le){for(var _e=le[0][0],Le=le[1][0],Be=le[0][1],Oe=le[1][1],Ke,xt,vt,Pt,jt=fn,qt=jt.length,er,Mr,Qr,ln,Lr,Nr;qt--;)if(er=jt[qt],!(!er||!er.prepare()))for(Qr=er.edges,ln=Qr.length,Mr=0;Mr<ln;)Nr=Qr[Mr].end(),vt=Nr.x,Pt=Nr.y,Lr=Qr[++Mr%ln].start(),Ke=Lr.x,xt=Lr.y,(o(vt-Ke)>rt||o(Pt-xt)>rt)&&(Qr.splice(Mr,0,new da(jn(er.site,Nr,o(vt-_e)<rt&&Oe-Pt>rt?{x:_e,y:o(Ke-_e)<rt?xt:Oe}:o(Pt-Oe)<rt&&Le-vt>rt?{x:o(xt-Oe)<rt?Ke:Le,y:Oe}:o(vt-Le)<rt&&Pt-Be>rt?{x:Le,y:o(Ke-Le)<rt?xt:Be}:o(Pt-Be)<rt&&vt-_e>rt?{x:o(xt-Be)<rt?Ke:_e,y:Be}:null),er.site,null)),++ln)}function xn(le,_e){return _e.angle-le.angle}function un(){sa(this),this.x=this.y=this.arc=this.site=this.cy=null}function gr(le){var _e=le.P,Le=le.N;if(!(!_e||!Le)){var Be=_e.site,Oe=le.site,Ke=Le.site;if(Be!==Ke){var xt=Oe.x,vt=Oe.y,Pt=Be.x-xt,jt=Be.y-vt,qt=Ke.x-xt,Nr=Ke.y-vt,er=2*(Pt*Nr-jt*qt);if(!(er>=-Ve)){var Mr=Pt*Pt+jt*jt,Qr=qt*qt+Nr*Nr,ln=(Nr*Mr-jt*Qr)/er,Lr=(Pt*Qr-qt*Mr)/er,Nr=Lr+vt,Zr=Rn.pop()||new un;Zr.arc=le,Zr.site=Oe,Zr.x=ln+xt,Zr.y=Nr+Math.sqrt(ln*ln+Lr*Lr),Zr.cy=Nr,le.circle=Zr;for(var an=null,sn=ea._;sn;)if(Zr.y<sn.y||Zr.y===sn.y&&Zr.x<=sn.x)if(sn.L)sn=sn.L;else{an=sn.P;break}else if(sn.R)sn=sn.R;else{an=sn;break}ea.insert(an,Zr),an||(ua=Zr)}}}}function mr(le){var _e=le.circle;_e&&(_e.P||(ua=_e.N),ea.remove(_e),Rn.push(_e),sa(_e),le.circle=null)}function zr(le,_e,Le,Be){return function(Oe){var Ke=Oe.a,xt=Oe.b,vt=Ke.x,Pt=Ke.y,jt=xt.x,qt=xt.y,er=0,Mr=1,Qr=jt-vt,ln=qt-Pt,Lr;if(Lr=le-vt,!(!Qr&&Lr>0)){if(Lr/=Qr,Qr<0){if(Lr<er)return;Lr<Mr&&(Mr=Lr)}else if(Qr>0){if(Lr>Mr)return;Lr>er&&(er=Lr)}if(Lr=Le-vt,!(!Qr&&Lr<0)){if(Lr/=Qr,Qr<0){if(Lr>Mr)return;Lr>er&&(er=Lr)}else if(Qr>0){if(Lr<er)return;Lr<Mr&&(Mr=Lr)}if(Lr=_e-Pt,!(!ln&&Lr>0)){if(Lr/=ln,ln<0){if(Lr<er)return;Lr<Mr&&(Mr=Lr)}else if(ln>0){if(Lr>Mr)return;Lr>er&&(er=Lr)}if(Lr=Be-Pt,!(!ln&&Lr<0)){if(Lr/=ln,ln<0){if(Lr>Mr)return;Lr>er&&(er=Lr)}else if(ln>0){if(Lr<er)return;Lr<Mr&&(Mr=Lr)}return er>0&&(Oe.a={x:vt+er*Qr,y:Pt+er*ln}),Mr<1&&(Oe.b={x:vt+Mr*Qr,y:Pt+Mr*ln}),Oe}}}}}}function gn(le){for(var _e=pn,Le=zr(le[0][0],le[0][1],le[1][0],le[1][1]),Be=_e.length,Oe;Be--;)Oe=_e[Be],(!On(Oe,le)||!Le(Oe)||o(Oe.a.x-Oe.b.x)<rt&&o(Oe.a.y-Oe.b.y)<rt)&&(Oe.a=Oe.b=null,_e.splice(Be,1))}function On(le,_e){var Le=le.b;if(Le)return!0;var Be=le.a,Oe=_e[0][0],Ke=_e[1][0],xt=_e[0][1],vt=_e[1][1],Pt=le.l,jt=le.r,qt=Pt.x,er=Pt.y,Mr=jt.x,Qr=jt.y,ln=(qt+Mr)/2,Lr=(er+Qr)/2,Nr,Zr;if(Qr===er){if(ln<Oe||ln>=Ke)return;if(qt>Mr){if(!Be)Be={x:ln,y:xt};else if(Be.y>=vt)return;Le={x:ln,y:vt}}else{if(!Be)Be={x:ln,y:vt};else if(Be.y<xt)return;Le={x:ln,y:xt}}}else if(Nr=(qt-Mr)/(Qr-er),Zr=Lr-Nr*ln,Nr<-1||Nr>1)if(qt>Mr){if(!Be)Be={x:(xt-Zr)/Nr,y:xt};else if(Be.y>=vt)return;Le={x:(vt-Zr)/Nr,y:vt}}else{if(!Be)Be={x:(vt-Zr)/Nr,y:vt};else if(Be.y<xt)return;Le={x:(xt-Zr)/Nr,y:xt}}else if(er<Qr){if(!Be)Be={x:Oe,y:Nr*Oe+Zr};else if(Be.x>=Ke)return;Le={x:Ke,y:Nr*Ke+Zr}}else{if(!Be)Be={x:Ke,y:Nr*Ke+Zr};else if(Be.x<Oe)return;Le={x:Oe,y:Nr*Oe+Zr}}return le.a=Be,le.b=Le,!0}function ta(le,_e){this.l=le,this.r=_e,this.a=this.b=null}function _n(le,_e,Le,Be){var Oe=new ta(le,_e);return pn.push(Oe),Le&&aa(Oe,le,_e,Le),Be&&aa(Oe,_e,le,Be),fn[le.i].edges.push(new da(Oe,le,_e)),fn[_e.i].edges.push(new da(Oe,_e,le)),Oe}function jn(le,_e,Le){var Be=new ta(le,null);return Be.a=_e,Be.b=Le,pn.push(Be),Be}function aa(le,_e,Le,Be){!le.a&&!le.b?(le.a=Be,le.l=_e,le.r=Le):le.l===Le?le.b=Be:le.a=Be}function da(le,_e,Le){var Be=le.a,Oe=le.b;this.edge=le,this.site=_e,this.angle=Le?Math.atan2(Le.y-_e.y,Le.x-_e.x):le.l===_e?Math.atan2(Oe.x-Be.x,Be.y-Oe.y):Math.atan2(Be.x-Oe.x,Oe.y-Be.y)}da.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function ma(){this._=null}function sa(le){le.U=le.C=le.L=le.R=le.P=le.N=null}ma.prototype={insert:function(le,_e){var Le,Be,Oe;if(le){if(_e.P=le,_e.N=le.N,le.N&&(le.N.P=_e),le.N=_e,le.R){for(le=le.R;le.L;)le=le.L;le.L=_e}else le.R=_e;Le=le}else this._?(le=zo(this._),_e.P=null,_e.N=le,le.P=le.L=_e,Le=le):(_e.P=_e.N=null,this._=_e,Le=null);for(_e.L=_e.R=null,_e.U=Le,_e.C=!0,le=_e;Le&&Le.C;)Be=Le.U,Le===Be.L?(Oe=Be.R,Oe&&Oe.C?(Le.C=Oe.C=!1,Be.C=!0,le=Be):(le===Le.R&&(Aa(this,Le),le=Le,Le=le.U),Le.C=!1,Be.C=!0,po(this,Be))):(Oe=Be.L,Oe&&Oe.C?(Le.C=Oe.C=!1,Be.C=!0,le=Be):(le===Le.L&&(po(this,Le),le=Le,Le=le.U),Le.C=!1,Be.C=!0,Aa(this,Be))),Le=le.U;this._.C=!1},remove:function(le){le.N&&(le.N.P=le.P),le.P&&(le.P.N=le.N),le.N=le.P=null;var _e=le.U,Le,Be=le.L,Oe=le.R,Ke,xt;if(Be?Oe?Ke=zo(Oe):Ke=Be:Ke=Oe,_e?_e.L===le?_e.L=Ke:_e.R=Ke:this._=Ke,Be&&Oe?(xt=Ke.C,Ke.C=le.C,Ke.L=Be,Be.U=Ke,Ke!==Oe?(_e=Ke.U,Ke.U=le.U,le=Ke.R,_e.L=le,Ke.R=Oe,Oe.U=Ke):(Ke.U=_e,_e=Ke,le=Ke.R)):(xt=le.C,le=Ke),le&&(le.U=_e),!xt){if(le&&le.C){le.C=!1;return}do{if(le===this._)break;if(le===_e.L){if(Le=_e.R,Le.C&&(Le.C=!1,_e.C=!0,Aa(this,_e),Le=_e.R),Le.L&&Le.L.C||Le.R&&Le.R.C){(!Le.R||!Le.R.C)&&(Le.L.C=!1,Le.C=!0,po(this,Le),Le=_e.R),Le.C=_e.C,_e.C=Le.R.C=!1,Aa(this,_e),le=this._;break}}else if(Le=_e.L,Le.C&&(Le.C=!1,_e.C=!0,po(this,_e),Le=_e.L),Le.L&&Le.L.C||Le.R&&Le.R.C){(!Le.L||!Le.L.C)&&(Le.R.C=!1,Le.C=!0,Aa(this,Le),Le=_e.L),Le.C=_e.C,_e.C=Le.L.C=!1,po(this,_e),le=this._;break}Le.C=!0,le=_e,_e=_e.U}while(!le.C);le&&(le.C=!1)}}};function Aa(le,_e){var Le=_e,Be=_e.R,Oe=Le.U;Oe?Oe.L===Le?Oe.L=Be:Oe.R=Be:le._=Be,Be.U=Oe,Le.U=Be,Le.R=Be.L,Le.R&&(Le.R.U=Le),Be.L=Le}function po(le,_e){var Le=_e,Be=_e.L,Oe=Le.U;Oe?Oe.L===Le?Oe.L=Be:Oe.R=Be:le._=Be,Be.U=Oe,Le.U=Be,Le.L=Be.R,Le.L&&(Le.L.U=Le),Be.R=Le}function zo(le){for(;le.L;)le=le.L;return le}function Ko(le,_e){var Le=le.sort(nl).pop(),Be,Oe,Ke;for(pn=[],fn=new Array(le.length),An=new ma,ea=new ma;;)if(Ke=ua,Le&&(!Ke||Le.y<Ke.y||Le.y===Ke.y&&Le.x<Ke.x))(Le.x!==Be||Le.y!==Oe)&&(fn[Le.i]=new en(Le),hr(Le),Be=Le.x,Oe=Le.y),Le=le.pop();else if(Ke)Vt(Ke.arc);else break;_e&&(gn(_e),Tn(_e));var xt={cells:fn,edges:pn};return An=ea=pn=fn=null,xt}function nl(le,_e){return _e.y-le.y||_e.x-le.x}A.geom.voronoi=function(le){var _e=Hn,Le=pa,Be=_e,Oe=Le,Ke=pl;if(le)return xt(le);function xt(Pt){var jt=new Array(Pt.length),qt=Ke[0][0],er=Ke[0][1],Mr=Ke[1][0],Qr=Ke[1][1];return Ko(vt(Pt),Ke).cells.forEach(function(ln,Lr){var Nr=ln.edges,Zr=ln.site,an=jt[Lr]=Nr.length?Nr.map(function(sn){var Kr=sn.start();return[Kr.x,Kr.y]}):Zr.x>=qt&&Zr.x<=Mr&&Zr.y>=er&&Zr.y<=Qr?[[qt,Qr],[Mr,Qr],[Mr,er],[qt,er]]:[];an.point=Pt[Lr]}),jt}function vt(Pt){return Pt.map(function(jt,qt){return{x:Math.round(Be(jt,qt)/rt)*rt,y:Math.round(Oe(jt,qt)/rt)*rt,i:qt}})}return xt.links=function(Pt){return Ko(vt(Pt)).edges.filter(function(jt){return jt.l&&jt.r}).map(function(jt){return{source:Pt[jt.l.i],target:Pt[jt.r.i]}})},xt.triangles=function(Pt){var jt=[];return Ko(vt(Pt)).cells.forEach(function(qt,er){for(var Mr=qt.site,Qr=qt.edges.sort(xn),ln=-1,Lr=Qr.length,Nr,Zr=Qr[Lr-1].edge,an=Zr.l===Mr?Zr.r:Zr.l;++ln<Lr;)Nr=an,Zr=Qr[ln].edge,an=Zr.l===Mr?Zr.r:Zr.l,er<Nr.i&&er<an.i&&Yl(Mr,Nr,an)<0&&jt.push([Pt[er],Pt[Nr.i],Pt[an.i]])}),jt},xt.x=function(Pt){return arguments.length?(Be=tt(_e=Pt),xt):_e},xt.y=function(Pt){return arguments.length?(Oe=tt(Le=Pt),xt):Le},xt.clipExtent=function(Pt){return arguments.length?(Ke=Pt==null?pl:Pt,xt):Ke===pl?null:Ke},xt.size=function(Pt){return arguments.length?xt.clipExtent(Pt&&[[0,0],Pt]):Ke===pl?null:Ke&&Ke[1]},xt};var pl=[[-1e6,-1e6],[1e6,1e6]];function Yl(le,_e,Le){return(le.x-Le.x)*(_e.y-le.y)-(le.x-_e.x)*(Le.y-le.y)}A.geom.delaunay=function(le){return A.geom.voronoi().triangles(le)},A.geom.quadtree=function(le,_e,Le,Be,Oe){var Ke=Hn,xt=pa,vt;if(vt=arguments.length)return Ke=vi,xt=Gs,vt===3&&(Oe=Le,Be=_e,Le=_e=0),Pt(le);function Pt(jt){var qt,er=tt(Ke),Mr=tt(xt),Qr,ln,Lr,Nr,Zr,an,sn,Kr;if(_e!=null)Zr=_e,an=Le,sn=Be,Kr=Oe;else if(sn=Kr=-(Zr=an=1/0),Qr=[],ln=[],Nr=jt.length,vt)for(Lr=0;Lr<Nr;++Lr)qt=jt[Lr],qt.x<Zr&&(Zr=qt.x),qt.y<an&&(an=qt.y),qt.x>sn&&(sn=qt.x),qt.y>Kr&&(Kr=qt.y),Qr.push(qt.x),ln.push(qt.y);else for(Lr=0;Lr<Nr;++Lr){var Un=+er(qt=jt[Lr],Lr),ra=+Mr(qt,Lr);Un<Zr&&(Zr=Un),ra<an&&(an=ra),Un>sn&&(sn=Un),ra>Kr&&(Kr=ra),Qr.push(Un),ln.push(ra)}var _a=sn-Zr,ia=Kr-an;_a>ia?Kr=an+_a:sn=Zr+ia;function ka(Pa,$a,yi,ho,zi,fa,ai,Xa){if(!(isNaN(yi)||isNaN(ho)))if(Pa.leaf){var Si=Pa.x,si=Pa.y;if(Si!=null)if(o(Si-yi)+o(si-ho)<.01)la(Pa,$a,yi,ho,zi,fa,ai,Xa);else{var so=Pa.point;Pa.x=Pa.y=Pa.point=null,la(Pa,so,Si,si,zi,fa,ai,Xa),la(Pa,$a,yi,ho,zi,fa,ai,Xa)}else Pa.x=yi,Pa.y=ho,Pa.point=$a}else la(Pa,$a,yi,ho,zi,fa,ai,Xa)}function la(Pa,$a,yi,ho,zi,fa,ai,Xa){var Si=(zi+ai)*.5,si=(fa+Xa)*.5,so=yi>=Si,qi=ho>=si,mo=qi<<1|so;Pa.leaf=!1,Pa=Pa.nodes[mo]||(Pa.nodes[mo]=Rs()),so?zi=Si:ai=Si,qi?fa=si:Xa=si,ka(Pa,$a,yi,ho,zi,fa,ai,Xa)}var Na=Rs();if(Na.add=function(Pa){ka(Na,Pa,+er(Pa,++Lr),+Mr(Pa,Lr),Zr,an,sn,Kr)},Na.visit=function(Pa){Hi(Pa,Na,Zr,an,sn,Kr)},Na.find=function(Pa){return So(Na,Pa[0],Pa[1],Zr,an,sn,Kr)},Lr=-1,_e==null){for(;++Lr<Nr;)ka(Na,jt[Lr],Qr[Lr],ln[Lr],Zr,an,sn,Kr);--Lr}else jt.forEach(Na.add);return Qr=ln=jt=qt=null,Na}return Pt.x=function(jt){return arguments.length?(Ke=jt,Pt):Ke},Pt.y=function(jt){return arguments.length?(xt=jt,Pt):xt},Pt.extent=function(jt){return arguments.length?(jt==null?_e=Le=Be=Oe=null:(_e=+jt[0][0],Le=+jt[0][1],Be=+jt[1][0],Oe=+jt[1][1]),Pt):_e==null?null:[[_e,Le],[Be,Oe]]},Pt.size=function(jt){return arguments.length?(jt==null?_e=Le=Be=Oe=null:(_e=Le=0,Be=+jt[0],Oe=+jt[1]),Pt):_e==null?null:[Be-_e,Oe-Le]},Pt};function vi(le){return le.x}function Gs(le){return le.y}function Rs(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Hi(le,_e,Le,Be,Oe,Ke){if(!le(_e,Le,Be,Oe,Ke)){var xt=(Le+Oe)*.5,vt=(Be+Ke)*.5,Pt=_e.nodes;Pt[0]&&Hi(le,Pt[0],Le,Be,xt,vt),Pt[1]&&Hi(le,Pt[1],xt,Be,Oe,vt),Pt[2]&&Hi(le,Pt[2],Le,vt,xt,Ke),Pt[3]&&Hi(le,Pt[3],xt,vt,Oe,Ke)}}function So(le,_e,Le,Be,Oe,Ke,xt){var vt=1/0,Pt;return function jt(qt,er,Mr,Qr,ln){if(!(er>Ke||Mr>xt||Qr<Be||ln<Oe)){if(Lr=qt.point){var Lr,Nr=_e-qt.x,Zr=Le-qt.y,an=Nr*Nr+Zr*Zr;if(an<vt){var sn=Math.sqrt(vt=an);Be=_e-sn,Oe=Le-sn,Ke=_e+sn,xt=Le+sn,Pt=Lr}}for(var Kr=qt.nodes,Un=(er+Qr)*.5,ra=(Mr+ln)*.5,_a=_e>=Un,ia=Le>=ra,ka=ia<<1|_a,la=ka+4;ka<la;++ka)if(qt=Kr[ka&3])switch(ka&3){case 0:jt(qt,er,Mr,Un,ra);break;case 1:jt(qt,Un,Mr,Qr,ra);break;case 2:jt(qt,er,ra,Un,ln);break;case 3:jt(qt,Un,ra,Qr,ln);break}}}(le,Be,Oe,Ke,xt),Pt}A.interpolateRgb=dl;function dl(le,_e){le=A.rgb(le),_e=A.rgb(_e);var Le=le.r,Be=le.g,Oe=le.b,Ke=_e.r-Le,xt=_e.g-Be,vt=_e.b-Oe;return function(Pt){return"#"+Ar(Math.round(Le+Ke*Pt))+Ar(Math.round(Be+xt*Pt))+Ar(Math.round(Oe+vt*Pt))}}A.interpolateObject=ps;function ps(le,_e){var Le={},Be={},Oe;for(Oe in le)Oe in _e?Le[Oe]=io(le[Oe],_e[Oe]):Be[Oe]=le[Oe];for(Oe in _e)Oe in le||(Be[Oe]=_e[Oe]);return function(Ke){for(Oe in Le)Be[Oe]=Le[Oe](Ke);return Be}}A.interpolateNumber=Di;function Di(le,_e){return le=+le,_e=+_e,function(Le){return le*(1-Le)+_e*Le}}A.interpolateString=al;function al(le,_e){var Le=Qi.lastIndex=Oi.lastIndex=0,Be,Oe,Ke,xt=-1,vt=[],Pt=[];for(le=le+"",_e=_e+"";(Be=Qi.exec(le))&&(Oe=Oi.exec(_e));)(Ke=Oe.index)>Le&&(Ke=_e.slice(Le,Ke),vt[xt]?vt[xt]+=Ke:vt[++xt]=Ke),(Be=Be[0])===(Oe=Oe[0])?vt[xt]?vt[xt]+=Oe:vt[++xt]=Oe:(vt[++xt]=null,Pt.push({i:xt,x:Di(Be,Oe)})),Le=Oi.lastIndex;return Le<_e.length&&(Ke=_e.slice(Le),vt[xt]?vt[xt]+=Ke:vt[++xt]=Ke),vt.length<2?Pt[0]?(_e=Pt[0].x,function(jt){return _e(jt)+""}):function(){return _e}:(_e=Pt.length,function(jt){for(var qt=0,er;qt<_e;++qt)vt[(er=Pt[qt]).i]=er.x(jt);return vt.join("")})}var Qi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Oi=new RegExp(Qi.source,"g");A.interpolate=io;function io(le,_e){for(var Le=A.interpolators.length,Be;--Le>=0&&!(Be=A.interpolators[Le](le,_e)););return Be}A.interpolators=[function(le,_e){var Le=typeof _e;return(Le==="string"?Sr.has(_e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(_e)?dl:al:_e instanceof $t?dl:Array.isArray(_e)?$i:Le==="object"&&isNaN(_e)?ps:Di)(le,_e)}],A.interpolateArray=$i;function $i(le,_e){var Le=[],Be=[],Oe=le.length,Ke=_e.length,xt=Math.min(le.length,_e.length),vt;for(vt=0;vt<xt;++vt)Le.push(io(le[vt],_e[vt]));for(;vt<Oe;++vt)Be[vt]=le[vt];for(;vt<Ke;++vt)Be[vt]=_e[vt];return function(Pt){for(vt=0;vt<xt;++vt)Be[vt]=Le[vt](Pt);return Be}}var rs=function(){return D},Ys=A.map({linear:rs,poly:ws,quad:function(){return ko},cubic:function(){return Mu},sin:function(){return Ll},exp:function(){return Su},circle:function(){return ku},elastic:Ws,back:Pl,bounce:function(){return Ts}}),au=A.map({in:D,out:iu,"in-out":Is,"out-in":function(le){return Is(iu(le))}});A.ease=function(le){var _e=le.indexOf("-"),Le=_e>=0?le.slice(0,_e):le,Be=_e>=0?le.slice(_e+1):"in";return Le=Ys.get(Le)||rs,Be=au.get(Be)||D,Jo(Be(Le.apply(null,g.call(arguments,1))))};function Jo(le){return function(_e){return _e<=0?0:_e>=1?1:le(_e)}}function iu(le){return function(_e){return 1-le(1-_e)}}function Is(le){return function(_e){return .5*(_e<.5?le(2*_e):2-le(2-2*_e))}}function ko(le){return le*le}function Mu(le){return le*le*le}function zs(le){if(le<=0)return 0;if(le>=1)return 1;var _e=le*le,Le=_e*le;return 4*(le<.5?Le:3*(le-_e)+Le-.75)}function ws(le){return function(_e){return Math.pow(_e,le)}}function Ll(le){return 1-Math.cos(le*Qe)}function Su(le){return Math.pow(2,10*(le-1))}function ku(le){return 1-Math.sqrt(1-le*le)}function Ws(le,_e){var Le;return arguments.length<2&&(_e=.45),arguments.length?Le=_e/Ue*Math.asin(1/le):(le=1,Le=_e/4),function(Be){return 1+le*Math.pow(2,-10*Be)*Math.sin((Be-Le)*Ue/_e)}}function Pl(le){return le||(le=1.70158),function(_e){return _e*_e*((le+1)*_e-le)}}function Ts(le){return le<1/2.75?7.5625*le*le:le<2/2.75?7.5625*(le-=1.5/2.75)*le+.75:le<2.5/2.75?7.5625*(le-=2.25/2.75)*le+.9375:7.5625*(le-=2.625/2.75)*le+.984375}A.interpolateHcl=Wl;function Wl(le,_e){le=A.hcl(le),_e=A.hcl(_e);var Le=le.h,Be=le.c,Oe=le.l,Ke=_e.h-Le,xt=_e.c-Be,vt=_e.l-Oe;return isNaN(xt)&&(xt=0,Be=isNaN(Be)?_e.c:Be),isNaN(Ke)?(Ke=0,Le=isNaN(Le)?_e.h:Le):Ke>180?Ke-=360:Ke<-180&&(Ke+=360),function(Pt){return it(Le+Ke*Pt,Be+xt*Pt,Oe+vt*Pt)+""}}A.interpolateHsl=il;function il(le,_e){le=A.hsl(le),_e=A.hsl(_e);var Le=le.h,Be=le.s,Oe=le.l,Ke=_e.h-Le,xt=_e.s-Be,vt=_e.l-Oe;return isNaN(xt)&&(xt=0,Be=isNaN(Be)?_e.s:Be),isNaN(Ke)?(Ke=0,Le=isNaN(Le)?_e.h:Le):Ke>180?Ke-=360:Ke<-180&&(Ke+=360),function(Pt){return wr(Le+Ke*Pt,Be+xt*Pt,Oe+vt*Pt)+""}}A.interpolateLab=Xl;function Xl(le,_e){le=A.lab(le),_e=A.lab(_e);var Le=le.l,Be=le.a,Oe=le.b,Ke=_e.l-Le,xt=_e.a-Be,vt=_e.b-Oe;return function(Pt){return st(Le+Ke*Pt,Be+xt*Pt,Oe+vt*Pt)+""}}A.interpolateRound=ou;function ou(le,_e){return _e-=le,function(Le){return Math.round(le+_e*Le)}}A.transform=function(le){var _e=M.createElementNS(A.ns.prefix.svg,"g");return(A.transform=function(Le){if(Le!=null){_e.setAttribute("transform",Le);var Be=_e.transform.baseVal.consolidate()}return new Dl(Be?Be.matrix:Rl)})(le)};function Dl(le){var _e=[le.a,le.b],Le=[le.c,le.d],Be=Xs(_e),Oe=Eu(_e,Le),Ke=Xs(Zl(Le,_e,-Oe))||0;_e[0]*Le[1]<Le[0]*_e[1]&&(_e[0]*=-1,_e[1]*=-1,Be*=-1,Oe*=-1),this.rotate=(Be?Math.atan2(_e[1],_e[0]):Math.atan2(-Le[0],Le[1]))*gt,this.translate=[le.e,le.f],this.scale=[Be,Ke],this.skew=Ke?Math.atan2(Oe,Ke)*gt:0}Dl.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function Eu(le,_e){return le[0]*_e[0]+le[1]*_e[1]}function Xs(le){var _e=Math.sqrt(Eu(le,le));return _e&&(le[0]/=_e,le[1]/=_e),_e}function Zl(le,_e,Le){return le[0]+=Le*_e[0],le[1]+=Le*_e[1],le}var Rl={a:1,b:0,c:0,d:1,e:0,f:0};A.interpolateTransform=Il;function ds(le){return le.length?le.pop()+",":""}function yl(le,_e,Le,Be){if(le[0]!==_e[0]||le[1]!==_e[1]){var Oe=Le.push("translate(",null,",",null,")");Be.push({i:Oe-4,x:Di(le[0],_e[0])},{i:Oe-2,x:Di(le[1],_e[1])})}else(_e[0]||_e[1])&&Le.push("translate("+_e+")")}function jl(le,_e,Le,Be){le!==_e?(le-_e>180?_e+=360:_e-le>180&&(le+=360),Be.push({i:Le.push(ds(Le)+"rotate(",null,")")-2,x:Di(le,_e)})):_e&&Le.push(ds(Le)+"rotate("+_e+")")}function su(le,_e,Le,Be){le!==_e?Be.push({i:Le.push(ds(Le)+"skewX(",null,")")-2,x:Di(le,_e)}):_e&&Le.push(ds(Le)+"skewX("+_e+")")}function lu(le,_e,Le,Be){if(le[0]!==_e[0]||le[1]!==_e[1]){var Oe=Le.push(ds(Le)+"scale(",null,",",null,")");Be.push({i:Oe-4,x:Di(le[0],_e[0])},{i:Oe-2,x:Di(le[1],_e[1])})}else(_e[0]!==1||_e[1]!==1)&&Le.push(ds(Le)+"scale("+_e+")")}function Il(le,_e){var Le=[],Be=[];return le=A.transform(le),_e=A.transform(_e),yl(le.translate,_e.translate,Le,Be),jl(le.rotate,_e.rotate,Le,Be),su(le.skew,_e.skew,Le,Be),lu(le.scale,_e.scale,Le,Be),le=_e=null,function(Oe){for(var Ke=-1,xt=Be.length,vt;++Ke<xt;)Le[(vt=Be[Ke]).i]=vt.x(Oe);return Le.join("")}}function Cu(le,_e){return _e=(_e-=le=+le)||1/_e,function(Le){return(Le-le)/_e}}function uu(le,_e){return _e=(_e-=le=+le)||1/_e,function(Le){return Math.max(0,Math.min(1,(Le-le)/_e))}}A.layout={},A.layout.bundle=function(){return function(le){for(var _e=[],Le=-1,Be=le.length;++Le<Be;)_e.push(Qo(le[Le]));return _e}};function Qo(le){for(var _e=le.source,Le=le.target,Be=sl(_e,Le),Oe=[_e];_e!==Be;)_e=_e.parent,Oe.push(_e);for(var Ke=Oe.length;Le!==Be;)Oe.splice(Ke,0,Le),Le=Le.parent;return Oe}function ol(le){for(var _e=[],Le=le.parent;Le!=null;)_e.push(le),le=Le,Le=Le.parent;return _e.push(le),_e}function sl(le,_e){if(le===_e)return le;for(var Le=ol(le),Be=ol(_e),Oe=Le.pop(),Ke=Be.pop(),xt=null;Oe===Ke;)xt=Oe,Oe=Le.pop(),Ke=Be.pop();return xt}A.layout.chord=function(){var le={},_e,Le,Be,Oe,Ke=0,xt,vt,Pt;function jt(){var er={},Mr=[],Qr=A.range(Oe),ln=[],Lr,Nr,Zr,an,sn;for(_e=[],Le=[],Lr=0,an=-1;++an<Oe;){for(Nr=0,sn=-1;++sn<Oe;)Nr+=Be[an][sn];Mr.push(Nr),ln.push(A.range(Oe)),Lr+=Nr}for(xt&&Qr.sort(function(Na,Pa){return xt(Mr[Na],Mr[Pa])}),vt&&ln.forEach(function(Na,Pa){Na.sort(function($a,yi){return vt(Be[Pa][$a],Be[Pa][yi])})}),Lr=(Ue-Ke*Oe)/Lr,Nr=0,an=-1;++an<Oe;){for(Zr=Nr,sn=-1;++sn<Oe;){var Kr=Qr[an],Un=ln[Kr][sn],ra=Be[Kr][Un],_a=Nr,ia=Nr+=ra*Lr;er[Kr+"-"+Un]={index:Kr,subindex:Un,startAngle:_a,endAngle:ia,value:ra}}Le[Kr]={index:Kr,startAngle:Zr,endAngle:Nr,value:Mr[Kr]},Nr+=Ke}for(an=-1;++an<Oe;)for(sn=an-1;++sn<Oe;){var ka=er[an+"-"+sn],la=er[sn+"-"+an];(ka.value||la.value)&&_e.push(ka.value<la.value?{source:la,target:ka}:{source:ka,target:la})}Pt&&qt()}function qt(){_e.sort(function(er,Mr){return Pt((er.source.value+er.target.value)/2,(Mr.source.value+Mr.target.value)/2)})}return le.matrix=function(er){return arguments.length?(Oe=(Be=er)&&Be.length,_e=Le=null,le):Be},le.padding=function(er){return arguments.length?(Ke=er,_e=Le=null,le):Ke},le.sortGroups=function(er){return arguments.length?(xt=er,_e=Le=null,le):xt},le.sortSubgroups=function(er){return arguments.length?(vt=er,_e=null,le):vt},le.sortChords=function(er){return arguments.length?(Pt=er,_e&&qt(),le):Pt},le.chords=function(){return _e||jt(),_e},le.groups=function(){return Le||jt(),Le},le},A.layout.force=function(){var le={},_e=A.dispatch("start","tick","end"),Le,Be=[1,1],Oe,Ke,xt=.9,vt=Ms,Pt=lo,jt=-30,qt=ml,er=.1,Mr=.64,Qr=[],ln=[],Lr,Nr,Zr;function an(Kr){return function(Un,ra,_a,ia){if(Un.point!==Kr){var ka=Un.cx-Kr.x,la=Un.cy-Kr.y,Na=ia-ra,Pa=ka*ka+la*la;if(Na*Na/Mr<Pa){if(Pa<qt){var $a=Un.charge/Pa;Kr.px-=ka*$a,Kr.py-=la*$a}return!0}if(Un.point&&Pa&&Pa<qt){var $a=Un.pointCharge/Pa;Kr.px-=ka*$a,Kr.py-=la*$a}}return!Un.charge}}le.tick=function(){if((Ke*=.99)<.005)return Le=null,_e.end({type:"end",alpha:Ke=0}),!0;var Kr=Qr.length,Un=ln.length,ra,_a,ia,ka,la,Na,Pa,$a,yi;for(_a=0;_a<Un;++_a)ia=ln[_a],ka=ia.source,la=ia.target,$a=la.x-ka.x,yi=la.y-ka.y,(Na=$a*$a+yi*yi)&&(Na=Ke*Nr[_a]*((Na=Math.sqrt(Na))-Lr[_a])/Na,$a*=Na,yi*=Na,la.x-=$a*(Pa=ka.weight+la.weight?ka.weight/(ka.weight+la.weight):.5),la.y-=yi*Pa,ka.x+=$a*(Pa=1-Pa),ka.y+=yi*Pa);if((Pa=Ke*er)&&($a=Be[0]/2,yi=Be[1]/2,_a=-1,Pa))for(;++_a<Kr;)ia=Qr[_a],ia.x+=($a-ia.x)*Pa,ia.y+=(yi-ia.y)*Pa;if(jt)for(As(ra=A.geom.quadtree(Qr),Ke,Zr),_a=-1;++_a<Kr;)(ia=Qr[_a]).fixed||ra.visit(an(ia));for(_a=-1;++_a<Kr;)ia=Qr[_a],ia.fixed?(ia.x=ia.px,ia.y=ia.py):(ia.x-=(ia.px-(ia.px=ia.x))*xt,ia.y-=(ia.py-(ia.py=ia.y))*xt);_e.tick({type:"tick",alpha:Ke})},le.nodes=function(Kr){return arguments.length?(Qr=Kr,le):Qr},le.links=function(Kr){return arguments.length?(ln=Kr,le):ln},le.size=function(Kr){return arguments.length?(Be=Kr,le):Be},le.linkDistance=function(Kr){return arguments.length?(vt=typeof Kr=="function"?Kr:+Kr,le):vt},le.distance=le.linkDistance,le.linkStrength=function(Kr){return arguments.length?(Pt=typeof Kr=="function"?Kr:+Kr,le):Pt},le.friction=function(Kr){return arguments.length?(xt=+Kr,le):xt},le.charge=function(Kr){return arguments.length?(jt=typeof Kr=="function"?Kr:+Kr,le):jt},le.chargeDistance=function(Kr){return arguments.length?(qt=Kr*Kr,le):Math.sqrt(qt)},le.gravity=function(Kr){return arguments.length?(er=+Kr,le):er},le.theta=function(Kr){return arguments.length?(Mr=Kr*Kr,le):Math.sqrt(Mr)},le.alpha=function(Kr){return arguments.length?(Kr=+Kr,Ke?Kr>0?Ke=Kr:(Le.c=null,Le.t=NaN,Le=null,_e.end({type:"end",alpha:Ke=0})):Kr>0&&(_e.start({type:"start",alpha:Ke=Kr}),Le=cn(le.tick)),le):Ke},le.start=function(){var Kr,Un=Qr.length,ra=ln.length,_a=Be[0],ia=Be[1],ka,la;for(Kr=0;Kr<Un;++Kr)(la=Qr[Kr]).index=Kr,la.weight=0;for(Kr=0;Kr<ra;++Kr)la=ln[Kr],typeof la.source=="number"&&(la.source=Qr[la.source]),typeof la.target=="number"&&(la.target=Qr[la.target]),++la.source.weight,++la.target.weight;for(Kr=0;Kr<Un;++Kr)la=Qr[Kr],isNaN(la.x)&&(la.x=Na("x",_a)),isNaN(la.y)&&(la.y=Na("y",ia)),isNaN(la.px)&&(la.px=la.x),isNaN(la.py)&&(la.py=la.y);if(Lr=[],typeof vt=="function")for(Kr=0;Kr<ra;++Kr)Lr[Kr]=+vt.call(this,ln[Kr],Kr);else for(Kr=0;Kr<ra;++Kr)Lr[Kr]=vt;if(Nr=[],typeof Pt=="function")for(Kr=0;Kr<ra;++Kr)Nr[Kr]=+Pt.call(this,ln[Kr],Kr);else for(Kr=0;Kr<ra;++Kr)Nr[Kr]=Pt;if(Zr=[],typeof jt=="function")for(Kr=0;Kr<Un;++Kr)Zr[Kr]=+jt.call(this,Qr[Kr],Kr);else for(Kr=0;Kr<Un;++Kr)Zr[Kr]=jt;function Na(Pa,$a){if(!ka){for(ka=new Array(Un),zi=0;zi<Un;++zi)ka[zi]=[];for(zi=0;zi<ra;++zi){var yi=ln[zi];ka[yi.source.index].push(yi.target),ka[yi.target.index].push(yi.source)}}for(var ho=ka[Kr],zi=-1,fa=ho.length,ai;++zi<fa;)if(!isNaN(ai=ho[zi][Pa]))return ai;return Math.random()*$a}return le.resume()},le.resume=function(){return le.alpha(.1)},le.stop=function(){return le.alpha(0)},le.drag=function(){if(Oe||(Oe=A.behavior.drag().origin(D).on("dragstart.force",Kl).on("drag.force",sn).on("dragend.force",gs)),!arguments.length)return Oe;this.on("mouseover.force",Eo).on("mouseout.force",zl).call(Oe)};function sn(Kr){Kr.px=A.event.x,Kr.py=A.event.y,le.resume()}return A.rebind(le,_e,"on")};function Kl(le){le.fixed|=2}function gs(le){le.fixed&=-7}function Eo(le){le.fixed|=4,le.px=le.x,le.py=le.y}function zl(le){le.fixed&=-5}function As(le,_e,Le){var Be=0,Oe=0;if(le.charge=0,!le.leaf)for(var Ke=le.nodes,xt=Ke.length,vt=-1,Pt;++vt<xt;)Pt=Ke[vt],Pt!=null&&(As(Pt,_e,Le),le.charge+=Pt.charge,Be+=Pt.charge*Pt.cx,Oe+=Pt.charge*Pt.cy);if(le.point){le.leaf||(le.point.x+=Math.random()-.5,le.point.y+=Math.random()-.5);var jt=_e*Le[le.point.index];le.charge+=le.pointCharge=jt,Be+=jt*le.point.x,Oe+=jt*le.point.y}le.cx=Be/le.charge,le.cy=Oe/le.charge}var Ms=20,lo=1,ml=1/0;A.layout.hierarchy=function(){var le=Fl,_e=bl,Le=ll;function Be(Oe){var Ke=[Oe],xt=[],vt;for(Oe.depth=0;(vt=Ke.pop())!=null;)if(xt.push(vt),(jt=_e.call(Be,vt,vt.depth))&&(Pt=jt.length)){for(var Pt,jt,qt;--Pt>=0;)Ke.push(qt=jt[Pt]),qt.parent=vt,qt.depth=vt.depth+1;Le&&(vt.value=0),vt.children=jt}else Le&&(vt.value=+Le.call(Be,vt,vt.depth)||0),delete vt.children;return ys(Oe,function(er){var Mr,Qr;le&&(Mr=er.children)&&Mr.sort(le),Le&&(Qr=er.parent)&&(Qr.value+=er.value)}),xt}return Be.sort=function(Oe){return arguments.length?(le=Oe,Be):le},Be.children=function(Oe){return arguments.length?(_e=Oe,Be):_e},Be.value=function(Oe){return arguments.length?(Le=Oe,Be):Le},Be.revalue=function(Oe){return Le&&(Zs(Oe,function(Ke){Ke.children&&(Ke.value=0)}),ys(Oe,function(Ke){var xt;Ke.children||(Ke.value=+Le.call(Be,Ke,Ke.depth)||0),(xt=Ke.parent)&&(xt.value+=Ke.value)})),Oe},Be};function xl(le,_e){return A.rebind(le,_e,"sort","children","value"),le.nodes=le,le.links=_l,le}function Zs(le,_e){for(var Le=[le];(le=Le.pop())!=null;)if(_e(le),(Oe=le.children)&&(Be=Oe.length))for(var Be,Oe;--Be>=0;)Le.push(Oe[Be])}function ys(le,_e){for(var Le=[le],Be=[];(le=Le.pop())!=null;)if(Be.push(le),(xt=le.children)&&(Ke=xt.length))for(var Oe=-1,Ke,xt;++Oe<Ke;)Le.push(xt[Oe]);for(;(le=Be.pop())!=null;)_e(le)}function bl(le){return le.children}function ll(le){return le.value}function Fl(le,_e){return _e.value-le.value}function _l(le){return A.merge(le.map(function(_e){return(_e.children||[]).map(function(Le){return{source:_e,target:Le}})}))}A.layout.partition=function(){var le=A.layout.hierarchy(),_e=[1,1];function Le(Ke,xt,vt,Pt){var jt=Ke.children;if(Ke.x=xt,Ke.y=Ke.depth*Pt,Ke.dx=vt,Ke.dy=Pt,jt&&(er=jt.length)){var qt=-1,er,Mr,Qr;for(vt=Ke.value?vt/Ke.value:0;++qt<er;)Le(Mr=jt[qt],xt,Qr=Mr.value*vt,Pt),xt+=Qr}}function Be(Ke){var xt=Ke.children,vt=0;if(xt&&(jt=xt.length))for(var Pt=-1,jt;++Pt<jt;)vt=Math.max(vt,Be(xt[Pt]));return 1+vt}function Oe(Ke,xt){var vt=le.call(this,Ke,xt);return Le(vt[0],0,_e[0],_e[1]/Be(vt[0])),vt}return Oe.size=function(Ke){return arguments.length?(_e=Ke,Oe):_e},xl(Oe,le)},A.layout.pie=function(){var le=Number,_e=js,Le=0,Be=Ue,Oe=0;function Ke(xt){var vt=xt.length,Pt=xt.map(function(an,sn){return+le.call(Ke,an,sn)}),jt=+(typeof Le=="function"?Le.apply(this,arguments):Le),qt=(typeof Be=="function"?Be.apply(this,arguments):Be)-jt,er=Math.min(Math.abs(qt)/vt,+(typeof Oe=="function"?Oe.apply(this,arguments):Oe)),Mr=er*(qt<0?-1:1),Qr=A.sum(Pt),ln=Qr?(qt-vt*Mr)/Qr:0,Lr=A.range(vt),Nr=[],Zr;return _e!=null&&Lr.sort(_e===js?function(an,sn){return Pt[sn]-Pt[an]}:function(an,sn){return _e(xt[an],xt[sn])}),Lr.forEach(function(an){Nr[an]={data:xt[an],value:Zr=Pt[an],startAngle:jt,endAngle:jt+=Zr*ln+Mr,padAngle:er}}),Nr}return Ke.value=function(xt){return arguments.length?(le=xt,Ke):le},Ke.sort=function(xt){return arguments.length?(_e=xt,Ke):_e},Ke.startAngle=function(xt){return arguments.length?(Le=xt,Ke):Le},Ke.endAngle=function(xt){return arguments.length?(Be=xt,Ke):Be},Ke.padAngle=function(xt){return arguments.length?(Oe=xt,Ke):Oe},Ke};var js={};A.layout.stack=function(){var le=D,_e=wl,Le=Ks,Be=Yu,Oe=Lu,Ke=ns;function xt(vt,Pt){if(!(ln=vt.length))return vt;var jt=vt.map(function(an,sn){return le.call(xt,an,sn)}),qt=jt.map(function(an){return an.map(function(sn,Kr){return[Oe.call(xt,sn,Kr),Ke.call(xt,sn,Kr)]})}),er=_e.call(xt,qt,Pt);jt=A.permute(jt,er),qt=A.permute(qt,er);var Mr=Le.call(xt,qt,Pt),Qr=jt[0].length,ln,Lr,Nr,Zr;for(Nr=0;Nr<Qr;++Nr)for(Be.call(xt,jt[0][Nr],Zr=Mr[Nr],qt[0][Nr][1]),Lr=1;Lr<ln;++Lr)Be.call(xt,jt[Lr][Nr],Zr+=qt[Lr-1][Nr][1],qt[Lr][Nr][1]);return vt}return xt.values=function(vt){return arguments.length?(le=vt,xt):le},xt.order=function(vt){return arguments.length?(_e=typeof vt=="function"?vt:Jl.get(vt)||wl,xt):_e},xt.offset=function(vt){return arguments.length?(Le=typeof vt=="function"?vt:ul.get(vt)||Ks,xt):Le},xt.x=function(vt){return arguments.length?(Oe=vt,xt):Oe},xt.y=function(vt){return arguments.length?(Ke=vt,xt):Ke},xt.out=function(vt){return arguments.length?(Be=vt,xt):Be},xt};function Lu(le){return le.x}function ns(le){return le.y}function Yu(le,_e,Le){le.y0=_e,le.y=Le}var Jl=A.map({"inside-out":function(le){var _e=le.length,Le,Be,Oe=le.map(Tl),Ke=le.map(fu),xt=A.range(_e).sort(function(er,Mr){return Oe[er]-Oe[Mr]}),vt=0,Pt=0,jt=[],qt=[];for(Le=0;Le<_e;++Le)Be=xt[Le],vt<Pt?(vt+=Ke[Be],jt.push(Be)):(Pt+=Ke[Be],qt.push(Be));return qt.reverse().concat(jt)},reverse:function(le){return A.range(le.length).reverse()},default:wl}),ul=A.map({silhouette:function(le){var _e=le.length,Le=le[0].length,Be=[],Oe=0,Ke,xt,vt,Pt=[];for(xt=0;xt<Le;++xt){for(Ke=0,vt=0;Ke<_e;Ke++)vt+=le[Ke][xt][1];vt>Oe&&(Oe=vt),Be.push(vt)}for(xt=0;xt<Le;++xt)Pt[xt]=(Oe-Be[xt])/2;return Pt},wiggle:function(le){var _e=le.length,Le=le[0],Be=Le.length,Oe,Ke,xt,vt,Pt,jt,qt,er,Mr,Qr=[];for(Qr[0]=er=Mr=0,Ke=1;Ke<Be;++Ke){for(Oe=0,vt=0;Oe<_e;++Oe)vt+=le[Oe][Ke][1];for(Oe=0,Pt=0,qt=Le[Ke][0]-Le[Ke-1][0];Oe<_e;++Oe){for(xt=0,jt=(le[Oe][Ke][1]-le[Oe][Ke-1][1])/(2*qt);xt<Oe;++xt)jt+=(le[xt][Ke][1]-le[xt][Ke-1][1])/qt;Pt+=jt*le[Oe][Ke][1]}Qr[Ke]=er-=vt?Pt/vt*qt:0,er<Mr&&(Mr=er)}for(Ke=0;Ke<Be;++Ke)Qr[Ke]-=Mr;return Qr},expand:function(le){var _e=le.length,Le=le[0].length,Be=1/_e,Oe,Ke,xt,vt=[];for(Ke=0;Ke<Le;++Ke){for(Oe=0,xt=0;Oe<_e;Oe++)xt+=le[Oe][Ke][1];if(xt)for(Oe=0;Oe<_e;Oe++)le[Oe][Ke][1]/=xt;else for(Oe=0;Oe<_e;Oe++)le[Oe][Ke][1]=Be}for(Ke=0;Ke<Le;++Ke)vt[Ke]=0;return vt},zero:Ks});function wl(le){return A.range(le.length)}function Ks(le){for(var _e=-1,Le=le[0].length,Be=[];++_e<Le;)Be[_e]=0;return Be}function Tl(le){for(var _e=1,Le=0,Be=le[0][1],Oe,Ke=le.length;_e<Ke;++_e)(Oe=le[_e][1])>Be&&(Le=_e,Be=Oe);return Le}function fu(le){return le.reduce(cu,0)}function cu(le,_e){return le+_e[1]}A.layout.histogram=function(){var le=!0,_e=Number,Le=fl,Be=Wu;function Oe(Ke,Mr){for(var vt=[],Pt=Ke.map(_e,this),jt=Le.call(this,Pt,Mr),qt=Be.call(this,jt,Pt,Mr),er,Mr=-1,Qr=Pt.length,ln=qt.length-1,Lr=le?1:1/Qr,Nr;++Mr<ln;)er=vt[Mr]=[],er.dx=qt[Mr+1]-(er.x=qt[Mr]),er.y=0;if(ln>0)for(Mr=-1;++Mr<Qr;)Nr=Pt[Mr],Nr>=jt[0]&&Nr<=jt[1]&&(er=vt[A.bisect(qt,Nr,1,ln)-1],er.y+=Lr,er.push(Ke[Mr]));return vt}return Oe.value=function(Ke){return arguments.length?(_e=Ke,Oe):_e},Oe.range=function(Ke){return arguments.length?(Le=tt(Ke),Oe):Le},Oe.bins=function(Ke){return arguments.length?(Be=typeof Ke=="number"?function(xt){return Ri(xt,Ke)}:tt(Ke),Oe):Be},Oe.frequency=function(Ke){return arguments.length?(le=!!Ke,Oe):le},Oe};function Wu(le,_e){return Ri(le,Math.ceil(Math.log(_e.length)/Math.LN2+1))}function Ri(le,_e){for(var Le=-1,Be=+le[0],Oe=(le[1]-Be)/_e,Ke=[];++Le<=_e;)Ke[Le]=Oe*Le+Be;return Ke}function fl(le){return[A.min(le),A.max(le)]}A.layout.pack=function(){var le=A.layout.hierarchy().sort(Js),_e=0,Le=[1,1],Be;function Oe(Ke,xt){var vt=le.call(this,Ke,xt),Pt=vt[0],jt=Le[0],qt=Le[1],er=Be==null?Math.sqrt:typeof Be=="function"?Be:function(){return Be};if(Pt.x=Pt.y=0,ys(Pt,function(Qr){Qr.r=+er(Qr.value)}),ys(Pt,uo),_e){var Mr=_e*(Be?1:Math.max(2*Pt.r/jt,2*Pt.r/qt))/2;ys(Pt,function(Qr){Qr.r+=Mr}),ys(Pt,uo),ys(Pt,function(Qr){Qr.r-=Mr})}return Fs(Pt,jt/2,qt/2,Be?1:1/Math.max(2*Pt.r/jt,2*Pt.r/qt)),vt}return Oe.size=function(Ke){return arguments.length?(Le=Ke,Oe):Le},Oe.radius=function(Ke){return arguments.length?(Be=Ke==null||typeof Ke=="function"?Ke:+Ke,Oe):Be},Oe.padding=function(Ke){return arguments.length?(_e=+Ke,Oe):_e},xl(Oe,le)};function Js(le,_e){return le.value-_e.value}function $o(le,_e){var Le=le._pack_next;le._pack_next=_e,_e._pack_prev=le,_e._pack_next=Le,Le._pack_prev=_e}function as(le,_e){le._pack_next=_e,_e._pack_prev=le}function Al(le,_e){var Le=_e.x-le.x,Be=_e.y-le.y,Oe=le.r+_e.r;return .999*Oe*Oe>Le*Le+Be*Be}function uo(le){if(!(_e=le.children)||!(Mr=_e.length))return;var _e,Le=1/0,Be=-1/0,Oe=1/0,Ke=-1/0,xt,vt,Pt,jt,qt,er,Mr;function Qr(Kr){Le=Math.min(Kr.x-Kr.r,Le),Be=Math.max(Kr.x+Kr.r,Be),Oe=Math.min(Kr.y-Kr.r,Oe),Ke=Math.max(Kr.y+Kr.r,Ke)}if(_e.forEach(hu),xt=_e[0],xt.x=-xt.r,xt.y=0,Qr(xt),Mr>1&&(vt=_e[1],vt.x=vt.r,vt.y=0,Qr(vt),Mr>2))for(Pt=_e[2],Os(xt,vt,Pt),Qr(Pt),$o(xt,Pt),xt._pack_prev=Pt,$o(Pt,vt),vt=xt._pack_next,jt=3;jt<Mr;jt++){Os(xt,vt,Pt=_e[jt]);var ln=0,Lr=1,Nr=1;for(qt=vt._pack_next;qt!==vt;qt=qt._pack_next,Lr++)if(Al(qt,Pt)){ln=1;break}if(ln==1)for(er=xt._pack_prev;er!==qt._pack_prev&&!Al(er,Pt);er=er._pack_prev,Nr++);ln?(Lr<Nr||Lr==Nr&&vt.r<xt.r?as(xt,vt=qt):as(xt=er,vt),jt--):($o(xt,Pt),vt=Pt,Qr(Pt))}var Zr=(Le+Be)/2,an=(Oe+Ke)/2,sn=0;for(jt=0;jt<Mr;jt++)Pt=_e[jt],Pt.x-=Zr,Pt.y-=an,sn=Math.max(sn,Pt.r+Math.sqrt(Pt.x*Pt.x+Pt.y*Pt.y));le.r=sn,_e.forEach(is)}function hu(le){le._pack_next=le._pack_prev=le}function is(le){delete le._pack_next,delete le._pack_prev}function Fs(le,_e,Le,Be){var Oe=le.children;if(le.x=_e+=Be*le.x,le.y=Le+=Be*le.y,le.r*=Be,Oe)for(var Ke=-1,xt=Oe.length;++Ke<xt;)Fs(Oe[Ke],_e,Le,Be)}function Os(le,_e,Le){var Be=le.r+Le.r,Oe=_e.x-le.x,Ke=_e.y-le.y;if(Be&&(Oe||Ke)){var xt=_e.r+Le.r,vt=Oe*Oe+Ke*Ke;xt*=xt,Be*=Be;var Pt=.5+(Be-xt)/(2*vt),jt=Math.sqrt(Math.max(0,2*xt*(Be+vt)-(Be-=vt)*Be-xt*xt))/(2*vt);Le.x=le.x+Pt*Oe+jt*Ke,Le.y=le.y+Pt*Ke-jt*Oe}else Le.x=le.x+Be,Le.y=le.y}A.layout.tree=function(){var le=A.layout.hierarchy().sort(null).value(null),_e=Ss,Le=[1,1],Be=null;function Oe(qt,er){var Mr=le.call(this,qt,er),Qr=Mr[0],ln=Ke(Qr);if(ys(ln,xt),ln.parent.m=-ln.z,Zs(ln,vt),Be)Zs(Qr,jt);else{var Lr=Qr,Nr=Qr,Zr=Qr;Zs(Qr,function(Un){Un.x<Lr.x&&(Lr=Un),Un.x>Nr.x&&(Nr=Un),Un.depth>Zr.depth&&(Zr=Un)});var an=_e(Lr,Nr)/2-Lr.x,sn=Le[0]/(Nr.x+_e(Nr,Lr)/2+an),Kr=Le[1]/(Zr.depth||1);Zs(Qr,function(Un){Un.x=(Un.x+an)*sn,Un.y=Un.depth*Kr})}return Mr}function Ke(qt){for(var er={A:null,children:[qt]},Mr=[er],Qr;(Qr=Mr.pop())!=null;)for(var ln=Qr.children,Lr,Nr=0,Zr=ln.length;Nr<Zr;++Nr)Mr.push((ln[Nr]=Lr={_:ln[Nr],parent:Qr,children:(Lr=ln[Nr].children)&&Lr.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:Nr}).a=Lr);return er.children[0]}function xt(qt){var er=qt.children,Mr=qt.parent.children,Qr=qt.i?Mr[qt.i-1]:null;if(er.length){ss(qt);var ln=(er[0].z+er[er.length-1].z)/2;Qr?(qt.z=Qr.z+_e(qt._,Qr._),qt.m=qt.z-ln):qt.z=ln}else Qr&&(qt.z=Qr.z+_e(qt._,Qr._));qt.parent.A=Pt(qt,Qr,qt.parent.A||Mr[0])}function vt(qt){qt._.x=qt.z+qt.parent.m,qt.m+=qt.parent.m}function Pt(qt,er,Mr){if(er){for(var Qr=qt,ln=qt,Lr=er,Nr=Qr.parent.children[0],Zr=Qr.m,an=ln.m,sn=Lr.m,Kr=Nr.m,Un;Lr=Gi(Lr),Qr=os(Qr),Lr&&Qr;)Nr=os(Nr),ln=Gi(ln),ln.a=qt,Un=Lr.z+sn-Qr.z-Zr+_e(Lr._,Qr._),Un>0&&(Co(vu(Lr,qt,Mr),qt,Un),Zr+=Un,an+=Un),sn+=Lr.m,Zr+=Qr.m,Kr+=Nr.m,an+=ln.m;Lr&&!Gi(ln)&&(ln.t=Lr,ln.m+=sn-an),Qr&&!os(Nr)&&(Nr.t=Qr,Nr.m+=Zr-Kr,Mr=qt)}return Mr}function jt(qt){qt.x*=Le[0],qt.y=qt.depth*Le[1]}return Oe.separation=function(qt){return arguments.length?(_e=qt,Oe):_e},Oe.size=function(qt){return arguments.length?(Be=(Le=qt)==null?jt:null,Oe):Be?null:Le},Oe.nodeSize=function(qt){return arguments.length?(Be=(Le=qt)==null?null:jt,Oe):Be?Le:null},xl(Oe,le)};function Ss(le,_e){return le.parent==_e.parent?1:2}function os(le){var _e=le.children;return _e.length?_e[0]:le.t}function Gi(le){var _e=le.children,Le;return(Le=_e.length)?_e[Le-1]:le.t}function Co(le,_e,Le){var Be=Le/(_e.i-le.i);_e.c-=Be,_e.s+=Le,le.c+=Be,_e.z+=Le,_e.m+=Le}function ss(le){for(var _e=0,Le=0,Be=le.children,Oe=Be.length,Ke;--Oe>=0;)Ke=Be[Oe],Ke.z+=_e,Ke.m+=_e,_e+=Ke.s+(Le+=Ke.c)}function vu(le,_e,Le){return le.a.parent===_e.parent?le.a:Le}A.layout.cluster=function(){var le=A.layout.hierarchy().sort(null).value(null),_e=Ss,Le=[1,1],Be=!1;function Oe(Ke,xt){var vt=le.call(this,Ke,xt),Pt=vt[0],jt,qt=0;ys(Pt,function(Lr){var Nr=Lr.children;Nr&&Nr.length?(Lr.x=pu(Nr),Lr.y=Ol(Nr)):(Lr.x=jt?qt+=_e(Lr,jt):0,Lr.y=0,jt=Lr)});var er=yt(Pt),Mr=Ot(Pt),Qr=er.x-_e(er,Mr)/2,ln=Mr.x+_e(Mr,er)/2;return ys(Pt,Be?function(Lr){Lr.x=(Lr.x-Pt.x)*Le[0],Lr.y=(Pt.y-Lr.y)*Le[1]}:function(Lr){Lr.x=(Lr.x-Qr)/(ln-Qr)*Le[0],Lr.y=(1-(Pt.y?Lr.y/Pt.y:1))*Le[1]}),vt}return Oe.separation=function(Ke){return arguments.length?(_e=Ke,Oe):_e},Oe.size=function(Ke){return arguments.length?(Be=(Le=Ke)==null,Oe):Be?null:Le},Oe.nodeSize=function(Ke){return arguments.length?(Be=(Le=Ke)!=null,Oe):Be?Le:null},xl(Oe,le)};function Ol(le){return 1+A.max(le,function(_e){return _e.y})}function pu(le){return le.reduce(function(_e,Le){return _e+Le.x},0)/le.length}function yt(le){var _e=le.children;return _e&&_e.length?yt(_e[0]):le}function Ot(le){var _e=le.children,Le;return _e&&(Le=_e.length)?Ot(_e[Le-1]):le}A.layout.treemap=function(){var le=A.layout.hierarchy(),_e=Math.round,Le=[1,1],Be=null,Oe=cr,Ke=!1,xt,vt="squarify",Pt=.5*(1+Math.sqrt(5));function jt(Lr,Nr){for(var Zr=-1,an=Lr.length,sn,Kr;++Zr<an;)Kr=(sn=Lr[Zr]).value*(Nr<0?0:Nr),sn.area=isNaN(Kr)||Kr<=0?0:Kr}function qt(Lr){var Nr=Lr.children;if(Nr&&Nr.length){var Zr=Oe(Lr),an=[],sn=Nr.slice(),Kr,Un=1/0,ra,_a=vt==="slice"?Zr.dx:vt==="dice"?Zr.dy:vt==="slice-dice"?Lr.depth&1?Zr.dy:Zr.dx:Math.min(Zr.dx,Zr.dy),ia;for(jt(sn,Zr.dx*Zr.dy/Lr.value),an.area=0;(ia=sn.length)>0;)an.push(Kr=sn[ia-1]),an.area+=Kr.area,vt!=="squarify"||(ra=Mr(an,_a))<=Un?(sn.pop(),Un=ra):(an.area-=an.pop().area,Qr(an,_a,Zr,!1),_a=Math.min(Zr.dx,Zr.dy),an.length=an.area=0,Un=1/0);an.length&&(Qr(an,_a,Zr,!0),an.length=an.area=0),Nr.forEach(qt)}}function er(Lr){var Nr=Lr.children;if(Nr&&Nr.length){var Zr=Oe(Lr),an=Nr.slice(),sn,Kr=[];for(jt(an,Zr.dx*Zr.dy/Lr.value),Kr.area=0;sn=an.pop();)Kr.push(sn),Kr.area+=sn.area,sn.z!=null&&(Qr(Kr,sn.z?Zr.dx:Zr.dy,Zr,!an.length),Kr.length=Kr.area=0);Nr.forEach(er)}}function Mr(Lr,Nr){for(var Zr=Lr.area,an,sn=0,Kr=1/0,Un=-1,ra=Lr.length;++Un<ra;)!(an=Lr[Un].area)||(an<Kr&&(Kr=an),an>sn&&(sn=an));return Zr*=Zr,Nr*=Nr,Zr?Math.max(Nr*sn*Pt/Zr,Zr/(Nr*Kr*Pt)):1/0}function Qr(Lr,Nr,Zr,an){var sn=-1,Kr=Lr.length,Un=Zr.x,ra=Zr.y,_a=Nr?_e(Lr.area/Nr):0,ia;if(Nr==Zr.dx){for((an||_a>Zr.dy)&&(_a=Zr.dy);++sn<Kr;)ia=Lr[sn],ia.x=Un,ia.y=ra,ia.dy=_a,Un+=ia.dx=Math.min(Zr.x+Zr.dx-Un,_a?_e(ia.area/_a):0);ia.z=!0,ia.dx+=Zr.x+Zr.dx-Un,Zr.y+=_a,Zr.dy-=_a}else{for((an||_a>Zr.dx)&&(_a=Zr.dx);++sn<Kr;)ia=Lr[sn],ia.x=Un,ia.y=ra,ia.dx=_a,ra+=ia.dy=Math.min(Zr.y+Zr.dy-ra,_a?_e(ia.area/_a):0);ia.z=!1,ia.dy+=Zr.y+Zr.dy-ra,Zr.x+=_a,Zr.dx-=_a}}function ln(Lr){var Nr=xt||le(Lr),Zr=Nr[0];return Zr.x=Zr.y=0,Zr.value?(Zr.dx=Le[0],Zr.dy=Le[1]):Zr.dx=Zr.dy=0,xt&&le.revalue(Zr),jt([Zr],Zr.dx*Zr.dy/Zr.value),(xt?er:qt)(Zr),Ke&&(xt=Nr),Nr}return ln.size=function(Lr){return arguments.length?(Le=Lr,ln):Le},ln.padding=function(Lr){if(!arguments.length)return Be;function Nr(sn){var Kr=Lr.call(ln,sn,sn.depth);return Kr==null?cr(sn):or(sn,typeof Kr=="number"?[Kr,Kr,Kr,Kr]:Kr)}function Zr(sn){return or(sn,Lr)}var an;return Oe=(Be=Lr)==null?cr:(an=typeof Lr)=="function"?Nr:(an==="number"&&(Lr=[Lr,Lr,Lr,Lr]),Zr),ln},ln.round=function(Lr){return arguments.length?(_e=Lr?Math.round:Number,ln):_e!=Number},ln.sticky=function(Lr){return arguments.length?(Ke=Lr,xt=null,ln):Ke},ln.ratio=function(Lr){return arguments.length?(Pt=Lr,ln):Pt},ln.mode=function(Lr){return arguments.length?(vt=Lr+"",ln):vt},xl(ln,le)};function cr(le){return{x:le.x,y:le.y,dx:le.dx,dy:le.dy}}function or(le,_e){var Le=le.x+_e[3],Be=le.y+_e[0],Oe=le.dx-_e[1]-_e[3],Ke=le.dy-_e[0]-_e[2];return Oe<0&&(Le+=Oe/2,Oe=0),Ke<0&&(Be+=Ke/2,Ke=0),{x:Le,y:Be,dx:Oe,dy:Ke}}A.random={normal:function(le,_e){var Le=arguments.length;return Le<2&&(_e=1),Le<1&&(le=0),function(){var Be,Oe,Ke;do Be=Math.random()*2-1,Oe=Math.random()*2-1,Ke=Be*Be+Oe*Oe;while(!Ke||Ke>1);return le+_e*Be*Math.sqrt(-2*Math.log(Ke)/Ke)}},logNormal:function(){var le=A.random.normal.apply(A,arguments);return function(){return Math.exp(le())}},bates:function(le){var _e=A.random.irwinHall(le);return function(){return _e()/le}},irwinHall:function(le){return function(){for(var _e=0,Le=0;Le<le;Le++)_e+=Math.random();return _e}}},A.scale={};function Rr(le){var _e=le[0],Le=le[le.length-1];return _e<Le?[_e,Le]:[Le,_e]}function tn(le){return le.rangeExtent?le.rangeExtent():Rr(le.range())}function dn(le,_e,Le,Be){var Oe=Le(le[0],le[1]),Ke=Be(_e[0],_e[1]);return function(xt){return Ke(Oe(xt))}}function Mn(le,_e){var Le=0,Be=le.length-1,Oe=le[Le],Ke=le[Be],xt;return Ke<Oe&&(xt=Le,Le=Be,Be=xt,xt=Oe,Oe=Ke,Ke=xt),le[Le]=_e.floor(Oe),le[Be]=_e.ceil(Ke),le}function Ln(le){return le?{floor:function(_e){return Math.floor(_e/le)*le},ceil:function(_e){return Math.ceil(_e/le)*le}}:Nn}var Nn={floor:D,ceil:D};function yn(le,_e,Le,Be){var Oe=[],Ke=[],xt=0,vt=Math.min(le.length,_e.length)-1;for(le[vt]<le[0]&&(le=le.slice().reverse(),_e=_e.slice().reverse());++xt<=vt;)Oe.push(Le(le[xt-1],le[xt])),Ke.push(Be(_e[xt-1],_e[xt]));return function(Pt){var jt=A.bisect(le,Pt,1,vt)-1;return Ke[jt](Oe[jt](Pt))}}A.scale.linear=function(){return zn([0,1],[0,1],io,!1)};function zn(le,_e,Le,Be){var Oe,Ke;function xt(){var Pt=Math.min(le.length,_e.length)>2?yn:dn,jt=Be?uu:Cu;return Oe=Pt(le,_e,jt,Le),Ke=Pt(_e,le,jt,io),vt}function vt(Pt){return Oe(Pt)}return vt.invert=function(Pt){return Ke(Pt)},vt.domain=function(Pt){return arguments.length?(le=Pt.map(Number),xt()):le},vt.range=function(Pt){return arguments.length?(_e=Pt,xt()):_e},vt.rangeRound=function(Pt){return vt.range(Pt).interpolate(ou)},vt.clamp=function(Pt){return arguments.length?(Be=Pt,xt()):Be},vt.interpolate=function(Pt){return arguments.length?(Le=Pt,xt()):Le},vt.ticks=function(Pt){return za(le,Pt)},vt.tickFormat=function(Pt,jt){return d3_scale_linearTickFormat(le,Pt,jt)},vt.nice=function(Pt){return Vn(le,Pt),xt()},vt.copy=function(){return zn(le,_e,Le,Be)},xt()}function Pn(le,_e){return A.rebind(le,_e,"range","rangeRound","interpolate","clamp")}function Vn(le,_e){return Mn(le,Ln($n(le,_e)[2])),Mn(le,Ln($n(le,_e)[2])),le}function $n(le,_e){_e==null&&(_e=10);var Le=Rr(le),Be=Le[1]-Le[0],Oe=Math.pow(10,Math.floor(Math.log(Be/_e)/Math.LN10)),Ke=_e/Be*Oe;return Ke<=.15?Oe*=10:Ke<=.35?Oe*=5:Ke<=.75&&(Oe*=2),Le[0]=Math.ceil(Le[0]/Oe)*Oe,Le[1]=Math.floor(Le[1]/Oe)*Oe+Oe*.5,Le[2]=Oe,Le}function za(le,_e){return A.range.apply(A,$n(le,_e))}A.scale.log=function(){return Ea(A.scale.linear().domain([0,1]),10,!0,[1,10])};function Ea(le,_e,Le,Be){function Oe(vt){return(Le?Math.log(vt<0?0:vt):-Math.log(vt>0?0:-vt))/Math.log(_e)}function Ke(vt){return Le?Math.pow(_e,vt):-Math.pow(_e,-vt)}function xt(vt){return le(Oe(vt))}return xt.invert=function(vt){return Ke(le.invert(vt))},xt.domain=function(vt){return arguments.length?(Le=vt[0]>=0,le.domain((Be=vt.map(Number)).map(Oe)),xt):Be},xt.base=function(vt){return arguments.length?(_e=+vt,le.domain(Be.map(Oe)),xt):_e},xt.nice=function(){var vt=Mn(Be.map(Oe),Le?Math:Fa);return le.domain(vt),Be=vt.map(Ke),xt},xt.ticks=function(){var vt=Rr(Be),Pt=[],jt=vt[0],qt=vt[1],er=Math.floor(Oe(jt)),Mr=Math.ceil(Oe(qt)),Qr=_e%1?2:_e;if(isFinite(Mr-er)){if(Le){for(;er<Mr;er++)for(var ln=1;ln<Qr;ln++)Pt.push(Ke(er)*ln);Pt.push(Ke(er))}else for(Pt.push(Ke(er));er++<Mr;)for(var ln=Qr-1;ln>0;ln--)Pt.push(Ke(er)*ln);for(er=0;Pt[er]<jt;er++);for(Mr=Pt.length;Pt[Mr-1]>qt;Mr--);Pt=Pt.slice(er,Mr)}return Pt},xt.copy=function(){return Ea(le.copy(),_e,Le,Be)},Pn(xt,le)}var Fa={floor:function(le){return-Math.ceil(-le)},ceil:function(le){return-Math.floor(-le)}};A.scale.pow=function(){return Oa(A.scale.linear(),1,[0,1])};function Oa(le,_e,Le){var Be=Jn(_e),Oe=Jn(1/_e);function Ke(xt){return le(Be(xt))}return Ke.invert=function(xt){return Oe(le.invert(xt))},Ke.domain=function(xt){return arguments.length?(le.domain((Le=xt.map(Number)).map(Be)),Ke):Le},Ke.ticks=function(xt){return za(Le,xt)},Ke.tickFormat=function(xt,vt){return d3_scale_linearTickFormat(Le,xt,vt)},Ke.nice=function(xt){return Ke.domain(Vn(Le,xt))},Ke.exponent=function(xt){return arguments.length?(Be=Jn(_e=xt),Oe=Jn(1/_e),le.domain(Le.map(Be)),Ke):_e},Ke.copy=function(){return Oa(le.copy(),_e,Le)},Pn(Ke,le)}function Jn(le){return function(_e){return _e<0?-Math.pow(-_e,le):Math.pow(_e,le)}}A.scale.sqrt=function(){return A.scale.pow().exponent(.5)},A.scale.ordinal=function(){return ha([],{t:"range",a:[[]]})};function ha(le,_e){var Le,Be,Oe;function Ke(vt){return Be[((Le.get(vt)||(_e.t==="range"?Le.set(vt,le.push(vt)):NaN))-1)%Be.length]}function xt(vt,Pt){return A.range(le.length).map(function(jt){return vt+Pt*jt})}return Ke.domain=function(vt){if(!arguments.length)return le;le=[],Le=new w;for(var Pt=-1,jt=vt.length,qt;++Pt<jt;)Le.has(qt=vt[Pt])||Le.set(qt,le.push(qt));return Ke[_e.t].apply(Ke,_e.a)},Ke.range=function(vt){return arguments.length?(Be=vt,Oe=0,_e={t:"range",a:arguments},Ke):Be},Ke.rangePoints=function(vt,Pt){arguments.length<2&&(Pt=0);var jt=vt[0],qt=vt[1],er=le.length<2?(jt=(jt+qt)/2,0):(qt-jt)/(le.length-1+Pt);return Be=xt(jt+er*Pt/2,er),Oe=0,_e={t:"rangePoints",a:arguments},Ke},Ke.rangeRoundPoints=function(vt,Pt){arguments.length<2&&(Pt=0);var jt=vt[0],qt=vt[1],er=le.length<2?(jt=qt=Math.round((jt+qt)/2),0):(qt-jt)/(le.length-1+Pt)|0;return Be=xt(jt+Math.round(er*Pt/2+(qt-jt-(le.length-1+Pt)*er)/2),er),Oe=0,_e={t:"rangeRoundPoints",a:arguments},Ke},Ke.rangeBands=function(vt,Pt,jt){arguments.length<2&&(Pt=0),arguments.length<3&&(jt=Pt);var qt=vt[1]<vt[0],er=vt[qt-0],Mr=vt[1-qt],Qr=(Mr-er)/(le.length-Pt+2*jt);return Be=xt(er+Qr*jt,Qr),qt&&Be.reverse(),Oe=Qr*(1-Pt),_e={t:"rangeBands",a:arguments},Ke},Ke.rangeRoundBands=function(vt,Pt,jt){arguments.length<2&&(Pt=0),arguments.length<3&&(jt=Pt);var qt=vt[1]<vt[0],er=vt[qt-0],Mr=vt[1-qt],Qr=Math.floor((Mr-er)/(le.length-Pt+2*jt));return Be=xt(er+Math.round((Mr-er-(le.length-Pt)*Qr)/2),Qr),qt&&Be.reverse(),Oe=Math.round(Qr*(1-Pt)),_e={t:"rangeRoundBands",a:arguments},Ke},Ke.rangeBand=function(){return Oe},Ke.rangeExtent=function(){return Rr(_e.a[0])},Ke.copy=function(){return ha(le,_e)},Ke.domain(le)}A.scale.category10=function(){return A.scale.ordinal().range(Ga)},A.scale.category20=function(){return A.scale.ordinal().range(Qa)},A.scale.category20b=function(){return A.scale.ordinal().range(di)},A.scale.category20c=function(){return A.scale.ordinal().range(gi)};var Ga=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(kr),Qa=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(kr),di=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(kr),gi=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(kr);A.scale.quantile=function(){return mi([],[])};function mi(le,_e){var Le;function Be(){var Ke=0,xt=_e.length;for(Le=[];++Ke<xt;)Le[Ke-1]=A.quantile(le,Ke/xt);return Oe}function Oe(Ke){if(!isNaN(Ke=+Ke))return _e[A.bisect(Le,Ke)]}return Oe.domain=function(Ke){return arguments.length?(le=Ke.map(x).filter(p).sort(i),Be()):le},Oe.range=function(Ke){return arguments.length?(_e=Ke,Be()):_e},Oe.quantiles=function(){return Le},Oe.invertExtent=function(Ke){return Ke=_e.indexOf(Ke),Ke<0?[NaN,NaN]:[Ke>0?Le[Ke-1]:le[0],Ke<Le.length?Le[Ke]:le[le.length-1]]},Oe.copy=function(){return mi(le,_e)},Be()}A.scale.quantize=function(){return Ai(0,1,[0,1])};function Ai(le,_e,Le){var Be,Oe;function Ke(vt){return Le[Math.max(0,Math.min(Oe,Math.floor(Be*(vt-le))))]}function xt(){return Be=Le.length/(_e-le),Oe=Le.length-1,Ke}return Ke.domain=function(vt){return arguments.length?(le=+vt[0],_e=+vt[vt.length-1],xt()):[le,_e]},Ke.range=function(vt){return arguments.length?(Le=vt,xt()):Le},Ke.invertExtent=function(vt){return vt=Le.indexOf(vt),vt=vt<0?NaN:vt/Be+le,[vt,vt+1/Be]},Ke.copy=function(){return Ai(le,_e,Le)},xt()}A.scale.threshold=function(){return oi([.5],[0,1])};function oi(le,_e){function Le(Be){if(Be<=Be)return _e[A.bisect(le,Be)]}return Le.domain=function(Be){return arguments.length?(le=Be,Le):le},Le.range=function(Be){return arguments.length?(_e=Be,Le):_e},Le.invertExtent=function(Be){return Be=_e.indexOf(Be),[le[Be-1],le[Be]]},Le.copy=function(){return oi(le,_e)},Le}A.scale.identity=function(){return xo([0,1])};function xo(le){function _e(Le){return+Le}return _e.invert=_e,_e.domain=_e.range=function(Le){return arguments.length?(le=Le.map(_e),_e):le},_e.ticks=function(Le){return za(le,Le)},_e.tickFormat=function(Le,Be){return d3_scale_linearTickFormat(le,Le,Be)},_e.copy=function(){return xo(le)},_e}A.svg={};function to(){return 0}A.svg.arc=function(){var le=va,_e=xi,Le=to,Be=Ja,Oe=fo,Ke=go,xt=ls;function vt(){var jt=Math.max(0,+le.apply(this,arguments)),qt=Math.max(0,+_e.apply(this,arguments)),er=Oe.apply(this,arguments)-Qe,Mr=Ke.apply(this,arguments)-Qe,Qr=Math.abs(Mr-er),ln=er>Mr?0:1;if(qt<jt&&(Lr=qt,qt=jt,jt=Lr),Qr>=Ze)return Pt(qt,ln)+(jt?Pt(jt,1-ln):"")+"Z";var Lr,Nr,Zr,an,sn=0,Kr=0,Un,ra,_a,ia,ka,la,Na,Pa,$a=[];if((an=(+xt.apply(this,arguments)||0)/2)&&(Zr=Be===Ja?Math.sqrt(jt*jt+qt*qt):+Be.apply(this,arguments),ln||(Kr*=-1),qt&&(Kr=Ut(Zr/qt*Math.sin(an))),jt&&(sn=Ut(Zr/jt*Math.sin(an)))),qt){Un=qt*Math.cos(er+Kr),ra=qt*Math.sin(er+Kr),_a=qt*Math.cos(Mr-Kr),ia=qt*Math.sin(Mr-Kr);var yi=Math.abs(Mr-er-2*Kr)<=Ae?0:1;if(Kr&&ks(Un,ra,_a,ia)===ln^yi){var ho=(er+Mr)/2;Un=qt*Math.cos(ho),ra=qt*Math.sin(ho),_a=ia=null}}else Un=ra=0;if(jt){ka=jt*Math.cos(Mr-sn),la=jt*Math.sin(Mr-sn),Na=jt*Math.cos(er+sn),Pa=jt*Math.sin(er+sn);var zi=Math.abs(er-Mr+2*sn)<=Ae?0:1;if(sn&&ks(ka,la,Na,Pa)===1-ln^zi){var fa=(er+Mr)/2;ka=jt*Math.cos(fa),la=jt*Math.sin(fa),Na=Pa=null}}else ka=la=0;if(Qr>rt&&(Lr=Math.min(Math.abs(qt-jt)/2,+Le.apply(this,arguments)))>.001){Nr=jt<qt^ln?0:1;var ai=Lr,Xa=Lr;if(Qr<Ae){var Si=Na==null?[ka,la]:_a==null?[Un,ra]:Wa([Un,ra],[Na,Pa],[_a,ia],[ka,la]),si=Un-Si[0],so=ra-Si[1],qi=_a-Si[0],mo=ia-Si[1],Wo=1/Math.sin(Math.acos((si*qi+so*mo)/(Math.sqrt(si*si+so*so)*Math.sqrt(qi*qi+mo*mo)))/2),Bo=Math.sqrt(Si[0]*Si[0]+Si[1]*Si[1]);Xa=Math.min(Lr,(jt-Bo)/(Wo-1)),ai=Math.min(Lr,(qt-Bo)/(Wo+1))}if(_a!=null){var Xo=Fo(Na==null?[ka,la]:[Na,Pa],[Un,ra],qt,ai,ln),Wi=Fo([_a,ia],[ka,la],qt,ai,ln);Lr===ai?$a.push("M",Xo[0],"A",ai,",",ai," 0 0,",Nr," ",Xo[1],"A",qt,",",qt," 0 ",1-ln^ks(Xo[1][0],Xo[1][1],Wi[1][0],Wi[1][1]),",",ln," ",Wi[1],"A",ai,",",ai," 0 0,",Nr," ",Wi[0]):$a.push("M",Xo[0],"A",ai,",",ai," 0 1,",Nr," ",Wi[0])}else $a.push("M",Un,",",ra);if(Na!=null){var Ni=Fo([Un,ra],[Na,Pa],jt,-Xa,ln),Ia=Fo([ka,la],_a==null?[Un,ra]:[_a,ia],jt,-Xa,ln);Lr===Xa?$a.push("L",Ia[0],"A",Xa,",",Xa," 0 0,",Nr," ",Ia[1],"A",jt,",",jt," 0 ",ln^ks(Ia[1][0],Ia[1][1],Ni[1][0],Ni[1][1]),",",1-ln," ",Ni[1],"A",Xa,",",Xa," 0 0,",Nr," ",Ni[0]):$a.push("L",Ia[0],"A",Xa,",",Xa," 0 0,",Nr," ",Ni[0])}else $a.push("L",ka,",",la)}else $a.push("M",Un,",",ra),_a!=null&&$a.push("A",qt,",",qt," 0 ",yi,",",ln," ",_a,",",ia),$a.push("L",ka,",",la),Na!=null&&$a.push("A",jt,",",jt," 0 ",zi,",",1-ln," ",Na,",",Pa);return $a.push("Z"),$a.join("")}function Pt(jt,qt){return"M0,"+jt+"A"+jt+","+jt+" 0 1,"+qt+" 0,"+-jt+"A"+jt+","+jt+" 0 1,"+qt+" 0,"+jt}return vt.innerRadius=function(jt){return arguments.length?(le=tt(jt),vt):le},vt.outerRadius=function(jt){return arguments.length?(_e=tt(jt),vt):_e},vt.cornerRadius=function(jt){return arguments.length?(Le=tt(jt),vt):Le},vt.padRadius=function(jt){return arguments.length?(Be=jt==Ja?Ja:tt(jt),vt):Be},vt.startAngle=function(jt){return arguments.length?(Oe=tt(jt),vt):Oe},vt.endAngle=function(jt){return arguments.length?(Ke=tt(jt),vt):Ke},vt.padAngle=function(jt){return arguments.length?(xt=tt(jt),vt):xt},vt.centroid=function(){var jt=(+le.apply(this,arguments)+ +_e.apply(this,arguments))/2,qt=(+Oe.apply(this,arguments)+ +Ke.apply(this,arguments))/2-Qe;return[Math.cos(qt)*jt,Math.sin(qt)*jt]},vt};var Ja="auto";function va(le){return le.innerRadius}function xi(le){return le.outerRadius}function fo(le){return le.startAngle}function go(le){return le.endAngle}function ls(le){return le&&le.padAngle}function ks(le,_e,Le,Be){return(le-Le)*_e-(_e-Be)*le>0?0:1}function Fo(le,_e,Le,Be,Oe){var Ke=le[0]-_e[0],xt=le[1]-_e[1],vt=(Oe?Be:-Be)/Math.sqrt(Ke*Ke+xt*xt),Pt=vt*xt,jt=-vt*Ke,qt=le[0]+Pt,er=le[1]+jt,Mr=_e[0]+Pt,Qr=_e[1]+jt,ln=(qt+Mr)/2,Lr=(er+Qr)/2,Nr=Mr-qt,Zr=Qr-er,an=Nr*Nr+Zr*Zr,sn=Le-Be,Kr=qt*Qr-Mr*er,Un=(Zr<0?-1:1)*Math.sqrt(Math.max(0,sn*sn*an-Kr*Kr)),ra=(Kr*Zr-Nr*Un)/an,_a=(-Kr*Nr-Zr*Un)/an,ia=(Kr*Zr+Nr*Un)/an,ka=(-Kr*Nr+Zr*Un)/an,la=ra-ln,Na=_a-Lr,Pa=ia-ln,$a=ka-Lr;return la*la+Na*Na>Pa*Pa+$a*$a&&(ra=ia,_a=ka),[[ra-Pt,_a-jt],[ra*Le/sn,_a*Le/sn]]}function Qs(){return!0}function ms(le){var _e=Hn,Le=pa,Be=Qs,Oe=bo,Ke=Oe.key,xt=.7;function vt(Pt){var jt=[],qt=[],er=-1,Mr=Pt.length,Qr,ln=tt(_e),Lr=tt(Le);function Nr(){jt.push("M",Oe(le(qt),xt))}for(;++er<Mr;)Be.call(this,Qr=Pt[er],er)?qt.push([+ln.call(this,Qr,er),+Lr.call(this,Qr,er)]):qt.length&&(Nr(),qt=[]);return qt.length&&Nr(),jt.length?jt.join(""):null}return vt.x=function(Pt){return arguments.length?(_e=Pt,vt):_e},vt.y=function(Pt){return arguments.length?(Le=Pt,vt):Le},vt.defined=function(Pt){return arguments.length?(Be=Pt,vt):Be},vt.interpolate=function(Pt){return arguments.length?(typeof Pt=="function"?Ke=Oe=Pt:Ke=(Oe=us.get(Pt)||bo).key,vt):Ke},vt.tension=function(Pt){return arguments.length?(xt=Pt,vt):xt},vt}A.svg.line=function(){return ms(D)};var us=A.map({linear:bo,"linear-closed":Bl,step:Ql,"step-before":fs,"step-after":du,basis:Es,"basis-open":Xu,"basis-closed":Ru,bundle:Iu,cardinal:Pu,"cardinal-open":Nl,"cardinal-closed":gf,monotone:We});us.forEach(function(le,_e){_e.key=le,_e.closed=/-closed$/.test(le)});function bo(le){return le.length>1?le.join("L"):le+"Z"}function Bl(le){return le.join("L")+"Z"}function Ql(le){for(var _e=0,Le=le.length,Be=le[0],Oe=[Be[0],",",Be[1]];++_e<Le;)Oe.push("H",(Be[0]+(Be=le[_e])[0])/2,"V",Be[1]);return Le>1&&Oe.push("H",Be[0]),Oe.join("")}function fs(le){for(var _e=0,Le=le.length,Be=le[0],Oe=[Be[0],",",Be[1]];++_e<Le;)Oe.push("V",(Be=le[_e])[1],"H",Be[0]);return Oe.join("")}function du(le){for(var _e=0,Le=le.length,Be=le[0],Oe=[Be[0],",",Be[1]];++_e<Le;)Oe.push("H",(Be=le[_e])[0],"V",Be[1]);return Oe.join("")}function Nl(le,_e){return le.length<4?bo(le):le[1]+gu(le.slice(1,-1),Du(le,_e))}function gf(le,_e){return le.length<3?Bl(le):le[0]+gu((le.push(le[0]),le),Du([le[le.length-2]].concat(le,[le[1]]),_e))}function Pu(le,_e){return le.length<3?bo(le):le[0]+gu(le,Du(le,_e))}function gu(le,_e){if(_e.length<1||le.length!=_e.length&&le.length!=_e.length+2)return bo(le);var Le=le.length!=_e.length,Be="",Oe=le[0],Ke=le[1],xt=_e[0],vt=xt,Pt=1;if(Le&&(Be+="Q"+(Ke[0]-xt[0]*2/3)+","+(Ke[1]-xt[1]*2/3)+","+Ke[0]+","+Ke[1],Oe=le[1],Pt=2),_e.length>1){vt=_e[1],Ke=le[Pt],Pt++,Be+="C"+(Oe[0]+xt[0])+","+(Oe[1]+xt[1])+","+(Ke[0]-vt[0])+","+(Ke[1]-vt[1])+","+Ke[0]+","+Ke[1];for(var jt=2;jt<_e.length;jt++,Pt++)Ke=le[Pt],vt=_e[jt],Be+="S"+(Ke[0]-vt[0])+","+(Ke[1]-vt[1])+","+Ke[0]+","+Ke[1]}if(Le){var qt=le[Pt];Be+="Q"+(Ke[0]+vt[0]*2/3)+","+(Ke[1]+vt[1]*2/3)+","+qt[0]+","+qt[1]}return Be}function Du(le,_e){for(var Le=[],Be=(1-_e)/2,Oe,Ke=le[0],xt=le[1],vt=1,Pt=le.length;++vt<Pt;)Oe=Ke,Ke=xt,xt=le[vt],Le.push([Be*(xt[0]-Oe[0]),Be*(xt[1]-Oe[1])]);return Le}function Es(le){if(le.length<3)return bo(le);var _e=1,Le=le.length,Be=le[0],Oe=Be[0],Ke=Be[1],xt=[Oe,Oe,Oe,(Be=le[1])[0]],vt=[Ke,Ke,Ke,Be[1]],Pt=[Oe,",",Ke,"L",Oo(xs,xt),",",Oo(xs,vt)];for(le.push(le[Le-1]);++_e<=Le;)Be=le[_e],xt.shift(),xt.push(Be[0]),vt.shift(),vt.push(Be[1]),yu(Pt,xt,vt);return le.pop(),Pt.push("L",Be),Pt.join("")}function Xu(le){if(le.length<4)return bo(le);for(var _e=[],Le=-1,Be=le.length,Oe,Ke=[0],xt=[0];++Le<3;)Oe=le[Le],Ke.push(Oe[0]),xt.push(Oe[1]);for(_e.push(Oo(xs,Ke)+","+Oo(xs,xt)),--Le;++Le<Be;)Oe=le[Le],Ke.shift(),Ke.push(Oe[0]),xt.shift(),xt.push(Oe[1]),yu(_e,Ke,xt);return _e.join("")}function Ru(le){for(var _e,Le=-1,Be=le.length,Oe=Be+4,Ke,xt=[],vt=[];++Le<4;)Ke=le[Le%Be],xt.push(Ke[0]),vt.push(Ke[1]);for(_e=[Oo(xs,xt),",",Oo(xs,vt)],--Le;++Le<Oe;)Ke=le[Le%Be],xt.shift(),xt.push(Ke[0]),vt.shift(),vt.push(Ke[1]),yu(_e,xt,vt);return _e.join("")}function Iu(le,_e){var Le=le.length-1;if(Le)for(var Be=le[0][0],Oe=le[0][1],Ke=le[Le][0]-Be,xt=le[Le][1]-Oe,vt=-1,Pt,jt;++vt<=Le;)Pt=le[vt],jt=vt/Le,Pt[0]=_e*Pt[0]+(1-_e)*(Be+jt*Ke),Pt[1]=_e*Pt[1]+(1-_e)*(Oe+jt*xt);return Es(le)}function Oo(le,_e){return le[0]*_e[0]+le[1]*_e[1]+le[2]*_e[2]+le[3]*_e[3]}var zu=[0,2/3,1/3,0],tf=[0,1/3,2/3,0],xs=[0,1/6,2/3,1/6];function yu(le,_e,Le){le.push("C",Oo(zu,_e),",",Oo(zu,Le),",",Oo(tf,_e),",",Oo(tf,Le),",",Oo(xs,_e),",",Oo(xs,Le))}function mu(le,_e){return(_e[1]-le[1])/(_e[0]-le[0])}function Fu(le){for(var _e=0,Le=le.length-1,Be=[],Oe=le[0],Ke=le[1],xt=Be[0]=mu(Oe,Ke);++_e<Le;)Be[_e]=(xt+(xt=mu(Oe=Ke,Ke=le[_e+1])))/2;return Be[_e]=xt,Be}function ze(le){for(var _e=[],Le,Be,Oe,Ke,xt=Fu(le),vt=-1,Pt=le.length-1;++vt<Pt;)Le=mu(le[vt],le[vt+1]),o(Le)<rt?xt[vt]=xt[vt+1]=0:(Be=xt[vt]/Le,Oe=xt[vt+1]/Le,Ke=Be*Be+Oe*Oe,Ke>9&&(Ke=Le*3/Math.sqrt(Ke),xt[vt]=Ke*Be,xt[vt+1]=Ke*Oe));for(vt=-1;++vt<=Pt;)Ke=(le[Math.min(Pt,vt+1)][0]-le[Math.max(0,vt-1)][0])/(6*(1+xt[vt]*xt[vt])),_e.push([Ke||0,xt[vt]*Ke||0]);return _e}function We(le){return le.length<3?bo(le):le[0]+gu(le,ze(le))}A.svg.line.radial=function(){var le=ms(et);return le.radius=le.x,delete le.x,le.angle=le.y,delete le.y,le};function et(le){for(var _e,Le=-1,Be=le.length,Oe,Ke;++Le<Be;)_e=le[Le],Oe=_e[0],Ke=_e[1]-Qe,_e[0]=Oe*Math.cos(Ke),_e[1]=Oe*Math.sin(Ke);return le}function ot(le){var _e=Hn,Le=Hn,Be=0,Oe=pa,Ke=Qs,xt=bo,vt=xt.key,Pt=xt,jt="L",qt=.7;function er(Mr){var Qr=[],ln=[],Lr=[],Nr=-1,Zr=Mr.length,an,sn=tt(_e),Kr=tt(Be),Un=_e===Le?function(){return _a}:tt(Le),ra=Be===Oe?function(){return ia}:tt(Oe),_a,ia;function ka(){Qr.push("M",xt(le(Lr),qt),jt,Pt(le(ln.reverse()),qt),"Z")}for(;++Nr<Zr;)Ke.call(this,an=Mr[Nr],Nr)?(ln.push([_a=+sn.call(this,an,Nr),ia=+Kr.call(this,an,Nr)]),Lr.push([+Un.call(this,an,Nr),+ra.call(this,an,Nr)])):ln.length&&(ka(),ln=[],Lr=[]);return ln.length&&ka(),Qr.length?Qr.join(""):null}return er.x=function(Mr){return arguments.length?(_e=Le=Mr,er):Le},er.x0=function(Mr){return arguments.length?(_e=Mr,er):_e},er.x1=function(Mr){return arguments.length?(Le=Mr,er):Le},er.y=function(Mr){return arguments.length?(Be=Oe=Mr,er):Oe},er.y0=function(Mr){return arguments.length?(Be=Mr,er):Be},er.y1=function(Mr){return arguments.length?(Oe=Mr,er):Oe},er.defined=function(Mr){return arguments.length?(Ke=Mr,er):Ke},er.interpolate=function(Mr){return arguments.length?(typeof Mr=="function"?vt=xt=Mr:vt=(xt=us.get(Mr)||bo).key,Pt=xt.reverse||xt,jt=xt.closed?"M":"L",er):vt},er.tension=function(Mr){return arguments.length?(qt=Mr,er):qt},er}fs.reverse=du,du.reverse=fs,A.svg.area=function(){return ot(D)},A.svg.area.radial=function(){var le=ot(et);return le.radius=le.x,delete le.x,le.innerRadius=le.x0,delete le.x0,le.outerRadius=le.x1,delete le.x1,le.angle=le.y,delete le.y,le.startAngle=le.y0,delete le.y0,le.endAngle=le.y1,delete le.y1,le};function bt(le){return le.source}function mt(le){return le.target}A.svg.chord=function(){var le=bt,_e=mt,Le=kt,Be=fo,Oe=go;function Ke(qt,er){var Mr=xt(this,le,qt,er),Qr=xt(this,_e,qt,er);return"M"+Mr.p0+Pt(Mr.r,Mr.p1,Mr.a1-Mr.a0)+(vt(Mr,Qr)?jt(Mr.r,Mr.p1,Mr.r,Mr.p0):jt(Mr.r,Mr.p1,Qr.r,Qr.p0)+Pt(Qr.r,Qr.p1,Qr.a1-Qr.a0)+jt(Qr.r,Qr.p1,Mr.r,Mr.p0))+"Z"}function xt(qt,er,Mr,Qr){var ln=er.call(qt,Mr,Qr),Lr=Le.call(qt,ln,Qr),Nr=Be.call(qt,ln,Qr)-Qe,Zr=Oe.call(qt,ln,Qr)-Qe;return{r:Lr,a0:Nr,a1:Zr,p0:[Lr*Math.cos(Nr),Lr*Math.sin(Nr)],p1:[Lr*Math.cos(Zr),Lr*Math.sin(Zr)]}}function vt(qt,er){return qt.a0==er.a0&&qt.a1==er.a1}function Pt(qt,er,Mr){return"A"+qt+","+qt+" 0 "+ +(Mr>Ae)+",1 "+er}function jt(qt,er,Mr,Qr){return"Q 0,0 "+Qr}return Ke.radius=function(qt){return arguments.length?(Le=tt(qt),Ke):Le},Ke.source=function(qt){return arguments.length?(le=tt(qt),Ke):le},Ke.target=function(qt){return arguments.length?(_e=tt(qt),Ke):_e},Ke.startAngle=function(qt){return arguments.length?(Be=tt(qt),Ke):Be},Ke.endAngle=function(qt){return arguments.length?(Oe=tt(qt),Ke):Oe},Ke};function kt(le){return le.radius}A.svg.diagonal=function(){var le=bt,_e=mt,Le=fr;function Be(Oe,Ke){var xt=le.call(this,Oe,Ke),vt=_e.call(this,Oe,Ke),Pt=(xt.y+vt.y)/2,jt=[xt,{x:xt.x,y:Pt},{x:vt.x,y:Pt},vt];return jt=jt.map(Le),"M"+jt[0]+"C"+jt[1]+" "+jt[2]+" "+jt[3]}return Be.source=function(Oe){return arguments.length?(le=tt(Oe),Be):le},Be.target=function(Oe){return arguments.length?(_e=tt(Oe),Be):_e},Be.projection=function(Oe){return arguments.length?(Le=Oe,Be):Le},Be};function fr(le){return[le.x,le.y]}A.svg.diagonal.radial=function(){var le=A.svg.diagonal(),_e=fr,Le=le.projection;return le.projection=function(Be){return arguments.length?Le(pr(_e=Be)):_e},le};function pr(le){return function(){var _e=le.apply(this,arguments),Le=_e[0],Be=_e[1]-Qe;return[Le*Math.cos(Be),Le*Math.sin(Be)]}}A.svg.symbol=function(){var le=xr,_e=sr;function Le(Be,Oe){return(Xr.get(le.call(this,Be,Oe))||Dr)(_e.call(this,Be,Oe))}return Le.type=function(Be){return arguments.length?(le=tt(Be),Le):le},Le.size=function(Be){return arguments.length?(_e=tt(Be),Le):_e},Le};function sr(){return 64}function xr(){return"circle"}function Dr(le){var _e=Math.sqrt(le/Ae);return"M0,"+_e+"A"+_e+","+_e+" 0 1,1 0,"+-_e+"A"+_e+","+_e+" 0 1,1 0,"+_e+"Z"}var Xr=A.map({circle:Dr,cross:function(le){var _e=Math.sqrt(le/5)/2;return"M"+-3*_e+","+-_e+"H"+-_e+"V"+-3*_e+"H"+_e+"V"+-_e+"H"+3*_e+"V"+_e+"H"+_e+"V"+3*_e+"H"+-_e+"V"+_e+"H"+-3*_e+"Z"},diamond:function(le){var _e=Math.sqrt(le/(2*bn)),Le=_e*bn;return"M0,"+-_e+"L"+Le+",0 0,"+_e+" "+-Le+",0Z"},square:function(le){var _e=Math.sqrt(le)/2;return"M"+-_e+","+-_e+"L"+_e+","+-_e+" "+_e+","+_e+" "+-_e+","+_e+"Z"},"triangle-down":function(le){var _e=Math.sqrt(le/qr),Le=_e*qr/2;return"M0,"+Le+"L"+_e+","+-Le+" "+-_e+","+-Le+"Z"},"triangle-up":function(le){var _e=Math.sqrt(le/qr),Le=_e*qr/2;return"M0,"+-Le+"L"+_e+","+Le+" "+-_e+","+Le+"Z"}});A.svg.symbolTypes=Xr.keys();var qr=Math.sqrt(3),bn=Math.tan(30*_t);ne.transition=function(le){for(var _e=Ya||++Ka,Le=ri(le),Be=[],Oe,Ke,xt=ei||{time:Date.now(),ease:zs,delay:0,duration:250},vt=-1,Pt=this.length;++vt<Pt;){Be.push(Oe=[]);for(var jt=this[vt],qt=-1,er=jt.length;++qt<er;)(Ke=jt[qt])&&Yi(Ke,qt,Le,_e,xt),Oe.push(Ke)}return ga(Be,Le,_e)},ne.interrupt=function(le){return this.each(le==null?Dn:Wn(ri(le)))};var Dn=Wn(ri());function Wn(le){return function(){var _e,Le,Be;(_e=this[le])&&(Be=_e[Le=_e.active])&&(Be.timer.c=null,Be.timer.t=NaN,--_e.count?delete _e[Le]:delete this[le],_e.active+=.5,Be.event&&Be.event.interrupt.call(this,this.__data__,Be.index))}}function ga(le,_e,Le){return j(le,xa),le.namespace=_e,le.id=Le,le}var xa=[],Ka=0,Ya,ei;xa.call=ne.call,xa.empty=ne.empty,xa.node=ne.node,xa.size=ne.size,A.transition=function(le,_e){return le&&le.transition?Ya?le.transition(_e):le:A.selection().transition(le)},A.transition.prototype=xa,xa.select=function(le){var _e=this.id,Le=this.namespace,Be=[],Oe,Ke,xt;le=X(le);for(var vt=-1,Pt=this.length;++vt<Pt;){Be.push(Oe=[]);for(var jt=this[vt],qt=-1,er=jt.length;++qt<er;)(xt=jt[qt])&&(Ke=le.call(xt,xt.__data__,qt,vt))?("__data__"in xt&&(Ke.__data__=xt.__data__),Yi(Ke,qt,Le,_e,xt[Le][_e]),Oe.push(Ke)):Oe.push(null)}return ga(Be,Le,_e)},xa.selectAll=function(le){var _e=this.id,Le=this.namespace,Be=[],Oe,Ke,xt,vt,Pt;le=Q(le);for(var jt=-1,qt=this.length;++jt<qt;)for(var er=this[jt],Mr=-1,Qr=er.length;++Mr<Qr;)if(xt=er[Mr]){Pt=xt[Le][_e],Ke=le.call(xt,xt.__data__,Mr,jt),Be.push(Oe=[]);for(var ln=-1,Lr=Ke.length;++ln<Lr;)(vt=Ke[ln])&&Yi(vt,ln,Le,_e,Pt),Oe.push(vt)}return ga(Be,Le,_e)},xa.filter=function(le){var _e=[],Le,Be,Oe;typeof le!="function"&&(le=we(le));for(var Ke=0,xt=this.length;Ke<xt;Ke++){_e.push(Le=[]);for(var Be=this[Ke],vt=0,Pt=Be.length;vt<Pt;vt++)(Oe=Be[vt])&&le.call(Oe,Oe.__data__,vt,Ke)&&Le.push(Oe)}return ga(_e,this.namespace,this.id)},xa.tween=function(le,_e){var Le=this.id,Be=this.namespace;return arguments.length<2?this.node()[Be][Le].tween.get(le):Xe(this,_e==null?function(Oe){Oe[Be][Le].tween.remove(le)}:function(Oe){Oe[Be][Le].tween.set(le,_e)})};function hi(le,_e,Le,Be){var Oe=le.id,Ke=le.namespace;return Xe(le,typeof Le=="function"?function(xt,vt,Pt){xt[Ke][Oe].tween.set(_e,Be(Le.call(xt,xt.__data__,vt,Pt)))}:(Le=Be(Le),function(xt){xt[Ke][Oe].tween.set(_e,Le)}))}xa.attr=function(le,_e){if(arguments.length<2){for(_e in le)this.attr(_e,le[_e]);return this}var Le=le=="transform"?Il:io,Be=A.ns.qualify(le);function Oe(){this.removeAttribute(Be)}function Ke(){this.removeAttributeNS(Be.space,Be.local)}function xt(Pt){return Pt==null?Oe:(Pt+="",function(){var jt=this.getAttribute(Be),qt;return jt!==Pt&&(qt=Le(jt,Pt),function(er){this.setAttribute(Be,qt(er))})})}function vt(Pt){return Pt==null?Ke:(Pt+="",function(){var jt=this.getAttributeNS(Be.space,Be.local),qt;return jt!==Pt&&(qt=Le(jt,Pt),function(er){this.setAttributeNS(Be.space,Be.local,qt(er))})})}return hi(this,"attr."+le,_e,Be.local?vt:xt)},xa.attrTween=function(le,_e){var Le=A.ns.qualify(le);function Be(Ke,xt){var vt=_e.call(this,Ke,xt,this.getAttribute(Le));return vt&&function(Pt){this.setAttribute(Le,vt(Pt))}}function Oe(Ke,xt){var vt=_e.call(this,Ke,xt,this.getAttributeNS(Le.space,Le.local));return vt&&function(Pt){this.setAttributeNS(Le.space,Le.local,vt(Pt))}}return this.tween("attr."+le,Le.local?Oe:Be)},xa.style=function(le,_e,Le){var Be=arguments.length;if(Be<3){if(typeof le!="string"){Be<2&&(_e="");for(Le in le)this.style(Le,le[Le],_e);return this}Le=""}function Oe(){this.style.removeProperty(le)}function Ke(xt){return xt==null?Oe:(xt+="",function(){var vt=a(this).getComputedStyle(this,null).getPropertyValue(le),Pt;return vt!==xt&&(Pt=io(vt,xt),function(jt){this.style.setProperty(le,Pt(jt),Le)})})}return hi(this,"style."+le,_e,Ke)},xa.styleTween=function(le,_e,Le){arguments.length<3&&(Le="");function Be(Oe,Ke){var xt=_e.call(this,Oe,Ke,a(this).getComputedStyle(this,null).getPropertyValue(le));return xt&&function(vt){this.style.setProperty(le,xt(vt),Le)}}return this.tween("style."+le,Be)},xa.text=function(le){return hi(this,"text",le,oo)};function oo(le){return le==null&&(le=""),function(){this.textContent=le}}xa.remove=function(){var le=this.namespace;return this.each("end.transition",function(){var _e;this[le].count<2&&(_e=this.parentNode)&&_e.removeChild(this)})},xa.ease=function(le){var _e=this.id,Le=this.namespace;return arguments.length<1?this.node()[Le][_e].ease:(typeof le!="function"&&(le=A.ease.apply(A,arguments)),Xe(this,function(Be){Be[Le][_e].ease=le}))},xa.delay=function(le){var _e=this.id,Le=this.namespace;return arguments.length<1?this.node()[Le][_e].delay:Xe(this,typeof le=="function"?function(Be,Oe,Ke){Be[Le][_e].delay=+le.call(Be,Be.__data__,Oe,Ke)}:(le=+le,function(Be){Be[Le][_e].delay=le}))},xa.duration=function(le){var _e=this.id,Le=this.namespace;return arguments.length<1?this.node()[Le][_e].duration:Xe(this,typeof le=="function"?function(Be,Oe,Ke){Be[Le][_e].duration=Math.max(1,le.call(Be,Be.__data__,Oe,Ke))}:(le=Math.max(1,le),function(Be){Be[Le][_e].duration=le}))},xa.each=function(le,_e){var Le=this.id,Be=this.namespace;if(arguments.length<2){var Oe=ei,Ke=Ya;try{Ya=Le,Xe(this,function(xt,vt,Pt){ei=xt[Be][Le],le.call(xt,xt.__data__,vt,Pt)})}finally{ei=Oe,Ya=Ke}}else Xe(this,function(xt){var vt=xt[Be][Le];(vt.event||(vt.event=A.dispatch("start","end","interrupt"))).on(le,_e)});return this},xa.transition=function(){for(var le=this.id,_e=++Ka,Le=this.namespace,Be=[],Oe,Ke,xt,vt,Pt=0,jt=this.length;Pt<jt;Pt++){Be.push(Oe=[]);for(var Ke=this[Pt],qt=0,er=Ke.length;qt<er;qt++)(xt=Ke[qt])&&(vt=xt[Le][le],Yi(xt,qt,Le,_e,{time:vt.time,ease:vt.ease,delay:vt.delay+vt.duration,duration:vt.duration})),Oe.push(xt)}return ga(Be,Le,_e)};function ri(le){return le==null?"__transition__":"__transition_"+le+"__"}function Yi(le,_e,Le,Be,Oe){var Ke=le[Le]||(le[Le]={active:0,count:0}),xt=Ke[Be],vt,Pt,jt,qt,er;function Mr(Lr){var Nr=xt.delay;if(Pt.t=Nr+vt,Nr<=Lr)return Qr(Lr-Nr);Pt.c=Qr}function Qr(Lr){var Nr=Ke.active,Zr=Ke[Nr];Zr&&(Zr.timer.c=null,Zr.timer.t=NaN,--Ke.count,delete Ke[Nr],Zr.event&&Zr.event.interrupt.call(le,le.__data__,Zr.index));for(var an in Ke)if(+an<Be){var sn=Ke[an];sn.timer.c=null,sn.timer.t=NaN,--Ke.count,delete Ke[an]}Pt.c=ln,cn(function(){return Pt.c&&ln(Lr||1)&&(Pt.c=null,Pt.t=NaN),1},0,vt),Ke.active=Be,xt.event&&xt.event.start.call(le,le.__data__,_e),er=[],xt.tween.forEach(function(Kr,Un){(Un=Un.call(le,le.__data__,_e))&&er.push(Un)}),qt=xt.ease,jt=xt.duration}function ln(Lr){for(var Nr=Lr/jt,Zr=qt(Nr),an=er.length;an>0;)er[--an].call(le,Zr);if(Nr>=1)return xt.event&&xt.event.end.call(le,le.__data__,_e),--Ke.count?delete Ke[Be]:delete le[Le],1}xt||(vt=Oe.time,Pt=cn(Mr,0,vt),xt=Ke[Be]={tween:new w,time:vt,timer:Pt,delay:Oe.delay,duration:Oe.duration,ease:Oe.ease,index:_e},Oe=null,++Ke.count)}A.svg.axis=function(){var le=A.scale.linear(),_e=co,Le=6,Be=6,Oe=3,Ke=[10],xt=null,vt;function Pt(jt){jt.each(function(){var qt=A.select(this),er=this.__chart__||le,Mr=this.__chart__=le.copy(),Qr=xt==null?Mr.ticks?Mr.ticks.apply(Mr,Ke):Mr.domain():xt,ln=vt==null?Mr.tickFormat?Mr.tickFormat.apply(Mr,Ke):D:vt,Lr=qt.selectAll(".tick").data(Qr,Mr),Nr=Lr.enter().insert("g",".domain").attr("class","tick").style("opacity",rt),Zr=A.transition(Lr.exit()).style("opacity",rt).remove(),an=A.transition(Lr.order()).style("opacity",1),sn=Math.max(Le,0)+Oe,Kr,Un=tn(Mr),ra=qt.selectAll(".domain").data([0]),_a=(ra.enter().append("path").attr("class","domain"),A.transition(ra));Nr.append("line"),Nr.append("text");var ia=Nr.select("line"),ka=an.select("line"),la=Lr.select("text").text(ln),Na=Nr.select("text"),Pa=an.select("text"),$a=_e==="top"||_e==="left"?-1:1,yi,ho,zi,fa;if(_e==="bottom"||_e==="top"?(Kr=bi,yi="x",zi="y",ho="x2",fa="y2",la.attr("dy",$a<0?"0em":".71em").style("text-anchor","middle"),_a.attr("d","M"+Un[0]+","+$a*Be+"V0H"+Un[1]+"V"+$a*Be)):(Kr=Mi,yi="y",zi="x",ho="y2",fa="x2",la.attr("dy",".32em").style("text-anchor",$a<0?"end":"start"),_a.attr("d","M"+$a*Be+","+Un[0]+"H0V"+Un[1]+"H"+$a*Be)),ia.attr(fa,$a*Le),Na.attr(zi,$a*sn),ka.attr(ho,0).attr(fa,$a*Le),Pa.attr(yi,0).attr(zi,$a*sn),Mr.rangeBand){var ai=Mr,Xa=ai.rangeBand()/2;er=Mr=function(Si){return ai(Si)+Xa}}else er.rangeBand?er=Mr:Zr.call(Kr,Mr,er);Nr.call(Kr,er,Mr),an.call(Kr,Mr,Mr)})}return Pt.scale=function(jt){return arguments.length?(le=jt,Pt):le},Pt.orient=function(jt){return arguments.length?(_e=jt in wo?jt+"":co,Pt):_e},Pt.ticks=function(){return arguments.length?(Ke=S(arguments),Pt):Ke},Pt.tickValues=function(jt){return arguments.length?(xt=jt,Pt):xt},Pt.tickFormat=function(jt){return arguments.length?(vt=jt,Pt):vt},Pt.tickSize=function(jt){var qt=arguments.length;return qt?(Le=+jt,Be=+arguments[qt-1],Pt):Le},Pt.innerTickSize=function(jt){return arguments.length?(Le=+jt,Pt):Le},Pt.outerTickSize=function(jt){return arguments.length?(Be=+jt,Pt):Be},Pt.tickPadding=function(jt){return arguments.length?(Oe=+jt,Pt):Oe},Pt.tickSubdivide=function(){return arguments.length&&Pt},Pt};var co="bottom",wo={top:1,right:1,bottom:1,left:1};function bi(le,_e,Le){le.attr("transform",function(Be){var Oe=_e(Be);return"translate("+(isFinite(Oe)?Oe:Le(Be))+",0)"})}function Mi(le,_e,Le){le.attr("transform",function(Be){var Oe=_e(Be);return"translate(0,"+(isFinite(Oe)?Oe:Le(Be))+")"})}A.svg.brush=function(){var le=re(qt,"brushstart","brush","brushend"),_e=null,Le=null,Be=[0,0],Oe=[0,0],Ke,xt,vt=!0,Pt=!0,jt=yo[0];function qt(Lr){Lr.each(function(){var Nr=A.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",ln).on("touchstart.brush",ln),Zr=Nr.selectAll(".background").data([0]);Zr.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Nr.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var an=Nr.selectAll(".resize").data(jt,D);an.exit().remove(),an.enter().append("g").attr("class",function(ra){return"resize "+ra}).style("cursor",function(ra){return cs[ra]}).append("rect").attr("x",function(ra){return/[ew]$/.test(ra)?-3:null}).attr("y",function(ra){return/^[ns]/.test(ra)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),an.style("display",qt.empty()?"none":null);var sn=A.transition(Nr),Kr=A.transition(Zr),Un;_e&&(Un=tn(_e),Kr.attr("x",Un[0]).attr("width",Un[1]-Un[0]),Mr(sn)),Le&&(Un=tn(Le),Kr.attr("y",Un[0]).attr("height",Un[1]-Un[0]),Qr(sn)),er(sn)})}qt.event=function(Lr){Lr.each(function(){var Nr=le.of(this,arguments),Zr={x:Be,y:Oe,i:Ke,j:xt},an=this.__chart__||Zr;this.__chart__=Zr,Ya?A.select(this).transition().each("start.brush",function(){Ke=an.i,xt=an.j,Be=an.x,Oe=an.y,Nr({type:"brushstart"})}).tween("brush:brush",function(){var sn=$i(Be,Zr.x),Kr=$i(Oe,Zr.y);return Ke=xt=null,function(Un){Be=Zr.x=sn(Un),Oe=Zr.y=Kr(Un),Nr({type:"brush",mode:"resize"})}}).each("end.brush",function(){Ke=Zr.i,xt=Zr.j,Nr({type:"brush",mode:"resize"}),Nr({type:"brushend"})}):(Nr({type:"brushstart"}),Nr({type:"brush",mode:"resize"}),Nr({type:"brushend"}))})};function er(Lr){Lr.selectAll(".resize").attr("transform",function(Nr){return"translate("+Be[+/e$/.test(Nr)]+","+Oe[+/^s/.test(Nr)]+")"})}function Mr(Lr){Lr.select(".extent").attr("x",Be[0]),Lr.selectAll(".extent,.n>rect,.s>rect").attr("width",Be[1]-Be[0])}function Qr(Lr){Lr.select(".extent").attr("y",Oe[0]),Lr.selectAll(".extent,.e>rect,.w>rect").attr("height",Oe[1]-Oe[0])}function ln(){var Lr=this,Nr=A.select(A.event.target),Zr=le.of(Lr,arguments),an=A.select(Lr),sn=Nr.datum(),Kr=!/^(n|s)$/.test(sn)&&_e,Un=!/^(e|w)$/.test(sn)&&Le,ra=Nr.classed("extent"),_a=Yt(Lr),ia,ka=A.mouse(Lr),la,Na=A.select(a(Lr)).on("keydown.brush",yi).on("keyup.brush",ho);if(A.event.changedTouches?Na.on("touchmove.brush",zi).on("touchend.brush",ai):Na.on("mousemove.brush",zi).on("mouseup.brush",ai),an.interrupt().selectAll("*").interrupt(),ra)ka[0]=Be[0]-ka[0],ka[1]=Oe[0]-ka[1];else if(sn){var Pa=+/w$/.test(sn),$a=+/^n/.test(sn);la=[Be[1-Pa]-ka[0],Oe[1-$a]-ka[1]],ka[0]=Be[Pa],ka[1]=Oe[$a]}else A.event.altKey&&(ia=ka.slice());an.style("pointer-events","none").selectAll(".resize").style("display",null),A.select("body").style("cursor",Nr.style("cursor")),Zr({type:"brushstart"}),zi();function yi(){A.event.keyCode==32&&(ra||(ia=null,ka[0]-=Be[1],ka[1]-=Oe[1],ra=2),W())}function ho(){A.event.keyCode==32&&ra==2&&(ka[0]+=Be[1],ka[1]+=Oe[1],ra=0,W())}function zi(){var Xa=A.mouse(Lr),Si=!1;la&&(Xa[0]+=la[0],Xa[1]+=la[1]),ra||(A.event.altKey?(ia||(ia=[(Be[0]+Be[1])/2,(Oe[0]+Oe[1])/2]),ka[0]=Be[+(Xa[0]<ia[0])],ka[1]=Oe[+(Xa[1]<ia[1])]):ia=null),Kr&&fa(Xa,_e,0)&&(Mr(an),Si=!0),Un&&fa(Xa,Le,1)&&(Qr(an),Si=!0),Si&&(er(an),Zr({type:"brush",mode:ra?"move":"resize"}))}function fa(Xa,Si,si){var so=tn(Si),qi=so[0],mo=so[1],Wo=ka[si],Bo=si?Oe:Be,Xo=Bo[1]-Bo[0],Wi,Ni;if(ra&&(qi-=Wo,mo-=Xo+Wo),Wi=(si?Pt:vt)?Math.max(qi,Math.min(mo,Xa[si])):Xa[si],ra?Ni=(Wi+=Wo)+Xo:(ia&&(Wo=Math.max(qi,Math.min(mo,2*ia[si]-Wi))),Wo<Wi?(Ni=Wi,Wi=Wo):Ni=Wo),Bo[0]!=Wi||Bo[1]!=Ni)return si?xt=null:Ke=null,Bo[0]=Wi,Bo[1]=Ni,!0}function ai(){zi(),an.style("pointer-events","all").selectAll(".resize").style("display",qt.empty()?"none":null),A.select("body").style("cursor",null),Na.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),_a(),Zr({type:"brushend"})}}return qt.x=function(Lr){return arguments.length?(_e=Lr,jt=yo[!_e<<1|!Le],qt):_e},qt.y=function(Lr){return arguments.length?(Le=Lr,jt=yo[!_e<<1|!Le],qt):Le},qt.clamp=function(Lr){return arguments.length?(_e&&Le?(vt=!!Lr[0],Pt=!!Lr[1]):_e?vt=!!Lr:Le&&(Pt=!!Lr),qt):_e&&Le?[vt,Pt]:_e?vt:Le?Pt:null},qt.extent=function(Lr){var Nr,Zr,an,sn,Kr;return arguments.length?(_e&&(Nr=Lr[0],Zr=Lr[1],Le&&(Nr=Nr[0],Zr=Zr[0]),Ke=[Nr,Zr],_e.invert&&(Nr=_e(Nr),Zr=_e(Zr)),Zr<Nr&&(Kr=Nr,Nr=Zr,Zr=Kr),(Nr!=Be[0]||Zr!=Be[1])&&(Be=[Nr,Zr])),Le&&(an=Lr[0],sn=Lr[1],_e&&(an=an[1],sn=sn[1]),xt=[an,sn],Le.invert&&(an=Le(an),sn=Le(sn)),sn<an&&(Kr=an,an=sn,sn=Kr),(an!=Oe[0]||sn!=Oe[1])&&(Oe=[an,sn])),qt):(_e&&(Ke?(Nr=Ke[0],Zr=Ke[1]):(Nr=Be[0],Zr=Be[1],_e.invert&&(Nr=_e.invert(Nr),Zr=_e.invert(Zr)),Zr<Nr&&(Kr=Nr,Nr=Zr,Zr=Kr))),Le&&(xt?(an=xt[0],sn=xt[1]):(an=Oe[0],sn=Oe[1],Le.invert&&(an=Le.invert(an),sn=Le.invert(sn)),sn<an&&(Kr=an,an=sn,sn=Kr))),_e&&Le?[[Nr,an],[Zr,sn]]:_e?[Nr,Zr]:Le&&[an,sn])},qt.clear=function(){return qt.empty()||(Be=[0,0],Oe=[0,0],Ke=xt=null),qt},qt.empty=function(){return!!_e&&Be[0]==Be[1]||!!Le&&Oe[0]==Oe[1]},A.rebind(qt,le,"on")};var cs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},yo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];A.text=Lt(function(le){return le.responseText}),A.json=function(le,_e){return Wt(le,"application/json",Do,_e)};function Do(le){return JSON.parse(le.responseText)}A.html=function(le,_e){return Wt(le,"text/html",Yo,_e)};function Yo(le){var _e=M.createRange();return _e.selectNode(M.body),_e.createContextualFragment(le.responseText)}A.xml=Lt(function(le){return le.responseXML}),typeof ee=="object"&&ee.exports?ee.exports=A:this.d3=A}).apply(self)},{}],59:[function(d,ee,te){ee.exports=d("./quad")},{"./quad":60}],60:[function(d,ee,te){var A=d("binary-search-bounds"),g=d("clamp"),S=d("parse-rect"),M=d("array-bounds"),e=d("pick-by-alias"),a=d("defined"),n=d("flatten-vertex-data"),r=d("is-obj"),t=d("dtype"),c=d("math-log2"),s=1073741824;ee.exports=function(p,v){v||(v={}),p=n(p,"float64"),v=e(v,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var f=a(v.maxDepth,255),y=a(v.bounds,M(p,2));y[0]===y[2]&&y[2]++,y[1]===y[3]&&y[3]++;var o=i(p,y),m=p.length>>>1,l;v.dtype||(v.dtype="array"),typeof v.dtype=="string"?l=new(t(v.dtype))(m):v.dtype&&(l=v.dtype,Array.isArray(l)&&(l.length=m));for(var w=0;w<m;++w)l[w]=w;var _=[],h=[],b=[],u=[];D(0,0,1,l,0,1);for(var L=0,T=0;T<_.length;T++){var k=_[T];if(l.set)l.set(k,L);else for(var P=0,z=k.length;P<z;P++)l[P+L]=k[P];var I=L+_[T].length;u[T]=[L,I],L=I}return l.range=R,l;function D(N,G,K,W,Y,re){if(!W.length)return null;var ue=_[Y]||(_[Y]=[]),j=b[Y]||(b[Y]=[]),q=h[Y]||(h[Y]=[]),V=ue.length;if(Y++,Y>f||re>s){for(var U=0;U<W.length;U++)ue.push(W[U]),j.push(re),q.push(null,null,null,null);return V}if(ue.push(W[0]),j.push(re),W.length<=1)return q.push(null,null,null,null),V;for(var $=K*.5,ne=N+$,X=G+$,Q=[],ie=[],se=[],ae=[],oe=1,be=W.length;oe<be;oe++){var ce=W[oe],de=o[ce*2],ye=o[ce*2+1];de<ne?ye<X?Q.push(ce):ie.push(ce):ye<X?se.push(ce):ae.push(ce)}return re<<=2,q.push(D(N,G,$,Q,Y,re),D(N,X,$,ie,Y,re+1),D(ne,G,$,se,Y,re+2),D(ne,X,$,ae,Y,re+3)),V}function R(){for(var N=[],G=arguments.length;G--;)N[G]=arguments[G];var K;if(r(N[N.length-1])){var W=N.pop();!N.length&&(W.x!=null||W.l!=null||W.left!=null)&&(N=[W],K={}),K=e(W,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else K={};N.length||(N=y);var Y=S.apply(void 0,N),re=[Math.min(Y.x,Y.x+Y.width),Math.min(Y.y,Y.y+Y.height),Math.max(Y.x,Y.x+Y.width),Math.max(Y.y,Y.y+Y.height)],ue=re[0],j=re[1],q=re[2],V=re[3],U=i([ue,j,q,V],y),$=U[0],ne=U[1],X=U[2],Q=U[3],ie=a(K.level,_.length);if(K.d!=null){var se;typeof K.d=="number"?se=[K.d,K.d]:K.d.length&&(se=K.d),ie=Math.min(Math.max(Math.ceil(-c(Math.abs(se[0])/(y[2]-y[0]))),Math.ceil(-c(Math.abs(se[1])/(y[3]-y[1])))),ie)}if(ie=Math.min(ie,_.length),K.lod)return O($,ne,X,Q,ie);var ae=[];oe(0,0,1,0,0,1);function oe(ce,de,ye,ge,me,Ee){if(!(me===null||Ee===null)){var Pe=ce+ye,Ne=de+ye;if(!($>Pe||ne>Ne||X<ce||Q<de)&&!(ge>=ie)&&me!==Ee){var we=_[ge];Ee===void 0&&(Ee=we.length);for(var ke=me;ke<Ee;ke++){var Xe=we[ke],He=p[Xe*2],Ie=p[Xe*2+1];He>=ue&&He<=q&&Ie>=j&&Ie<=V&&ae.push(Xe)}var De=h[ge],Ge=De[me*4+0],ht=De[me*4+1],Rt=De[me*4+2],Kt=De[me*4+3],It=be(De,me+1),Mt=ye*.5,Yt=ge+1;oe(ce,de,Mt,Yt,Ge,ht||Rt||Kt||It),oe(ce,de+Mt,Mt,Yt,ht,Rt||Kt||It),oe(ce+Mt,de,Mt,Yt,Rt,Kt||It),oe(ce+Mt,de+Mt,Mt,Yt,Kt,It)}}}function be(ce,de){for(var ye=null,ge=0;ye===null;)if(ye=ce[de*4+ge],ge++,ge>ce.length)return null;return ye}return ae}function O(N,G,K,W,Y){for(var re=[],ue=0;ue<Y;ue++){var j=b[ue],q=u[ue][0],V=F(N,G,ue),U=F(K,W,ue),$=A.ge(j,V),ne=A.gt(j,U,$,j.length-1);re[ue]=[$+q,ne+q]}return re}function F(N,G,K){for(var W=1,Y=.5,re=.5,ue=.5,j=0;j<K;j++)W<<=2,W+=N<Y?G<re?0:1:G<re?2:3,ue*=.5,Y+=N<Y?-ue:ue,re+=G<re?-ue:ue;return W}};function i(x,p){for(var v=p[0],f=p[1],y=p[2],o=p[3],m=1/(y-v),l=1/(o-f),w=new Array(x.length),_=0,h=x.length/2;_<h;_++)w[2*_]=g((x[2*_]-v)*m,0,1),w[2*_+1]=g((x[2*_+1]-f)*l,0,1);return w}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var A=d("@turf/meta"),g=6378137;function S(r){return A.geomReduce(r,function(t,c){return t+M(c)},0)}te.default=S;function M(r){var t=0,c;switch(r.type){case"Polygon":return e(r.coordinates);case"MultiPolygon":for(c=0;c<r.coordinates.length;c++)t+=e(r.coordinates[c]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function e(r){var t=0;if(r&&r.length>0){t+=Math.abs(a(r[0]));for(var c=1;c<r.length;c++)t-=Math.abs(a(r[c]))}return t}function a(r){var t,c,s,i,x,p,v,f=0,y=r.length;if(y>2){for(v=0;v<y;v++)v===y-2?(i=y-2,x=y-1,p=0):v===y-1?(i=y-1,x=0,p=1):(i=v,x=v+1,p=v+2),t=r[i],c=r[x],s=r[p],f+=(n(s[0])-n(t[0]))*Math.sin(n(c[1]));f=f*g*g/2}return f}function n(r){return r*Math.PI/180}},{"@turf/meta":63}],62:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0}),te.earthRadius=63710088e-1,te.factors={centimeters:te.earthRadius*100,centimetres:te.earthRadius*100,degrees:te.earthRadius/111325,feet:te.earthRadius*3.28084,inches:te.earthRadius*39.37,kilometers:te.earthRadius/1e3,kilometres:te.earthRadius/1e3,meters:te.earthRadius,metres:te.earthRadius,miles:te.earthRadius/1609.344,millimeters:te.earthRadius*1e3,millimetres:te.earthRadius*1e3,nauticalmiles:te.earthRadius/1852,radians:1,yards:te.earthRadius*1.0936},te.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/te.earthRadius,yards:1.0936133},te.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function A(T,k,P){P===void 0&&(P={});var z={type:"Feature"};return(P.id===0||P.id)&&(z.id=P.id),P.bbox&&(z.bbox=P.bbox),z.properties=k||{},z.geometry=T,z}te.feature=A;function g(T,k,P){switch(T){case"Point":return S(k).geometry;case"LineString":return n(k).geometry;case"Polygon":return e(k).geometry;case"MultiPoint":return s(k).geometry;case"MultiLineString":return c(k).geometry;case"MultiPolygon":return i(k).geometry;default:throw new Error(T+" is invalid")}}te.geometry=g;function S(T,k,P){if(P===void 0&&(P={}),!T)throw new Error("coordinates is required");if(!Array.isArray(T))throw new Error("coordinates must be an Array");if(T.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!h(T[0])||!h(T[1]))throw new Error("coordinates must contain numbers");var z={type:"Point",coordinates:T};return A(z,k,P)}te.point=S;function M(T,k,P){return P===void 0&&(P={}),t(T.map(function(z){return S(z,k)}),P)}te.points=M;function e(T,k,P){P===void 0&&(P={});for(var z=0,I=T;z<I.length;z++){var D=I[z];if(D.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var R=0;R<D[D.length-1].length;R++)if(D[D.length-1][R]!==D[0][R])throw new Error("First and last Position are not equivalent.")}var O={type:"Polygon",coordinates:T};return A(O,k,P)}te.polygon=e;function a(T,k,P){return P===void 0&&(P={}),t(T.map(function(z){return e(z,k)}),P)}te.polygons=a;function n(T,k,P){if(P===void 0&&(P={}),T.length<2)throw new Error("coordinates must be an array of two or more positions");var z={type:"LineString",coordinates:T};return A(z,k,P)}te.lineString=n;function r(T,k,P){return P===void 0&&(P={}),t(T.map(function(z){return n(z,k)}),P)}te.lineStrings=r;function t(T,k){k===void 0&&(k={});var P={type:"FeatureCollection"};return k.id&&(P.id=k.id),k.bbox&&(P.bbox=k.bbox),P.features=T,P}te.featureCollection=t;function c(T,k,P){P===void 0&&(P={});var z={type:"MultiLineString",coordinates:T};return A(z,k,P)}te.multiLineString=c;function s(T,k,P){P===void 0&&(P={});var z={type:"MultiPoint",coordinates:T};return A(z,k,P)}te.multiPoint=s;function i(T,k,P){P===void 0&&(P={});var z={type:"MultiPolygon",coordinates:T};return A(z,k,P)}te.multiPolygon=i;function x(T,k,P){P===void 0&&(P={});var z={type:"GeometryCollection",geometries:T};return A(z,k,P)}te.geometryCollection=x;function p(T,k){if(k===void 0&&(k=0),k&&!(k>=0))throw new Error("precision must be a positive number");var P=Math.pow(10,k||0);return Math.round(T*P)/P}te.round=p;function v(T,k){k===void 0&&(k="kilometers");var P=te.factors[k];if(!P)throw new Error(k+" units is invalid");return T*P}te.radiansToLength=v;function f(T,k){k===void 0&&(k="kilometers");var P=te.factors[k];if(!P)throw new Error(k+" units is invalid");return T/P}te.lengthToRadians=f;function y(T,k){return m(f(T,k))}te.lengthToDegrees=y;function o(T){var k=T%360;return k<0&&(k+=360),k}te.bearingToAzimuth=o;function m(T){var k=T%(2*Math.PI);return k*180/Math.PI}te.radiansToDegrees=m;function l(T){var k=T%360;return k*Math.PI/180}te.degreesToRadians=l;function w(T,k,P){if(k===void 0&&(k="kilometers"),P===void 0&&(P="kilometers"),!(T>=0))throw new Error("length must be a positive number");return v(f(T,k),P)}te.convertLength=w;function _(T,k,P){if(k===void 0&&(k="meters"),P===void 0&&(P="kilometers"),!(T>=0))throw new Error("area must be a positive number");var z=te.areaFactors[k];if(!z)throw new Error("invalid original units");var I=te.areaFactors[P];if(!I)throw new Error("invalid final units");return T/z*I}te.convertArea=_;function h(T){return!isNaN(T)&&T!==null&&!Array.isArray(T)}te.isNumber=h;function b(T){return!!T&&T.constructor===Object}te.isObject=b;function u(T){if(!T)throw new Error("bbox is required");if(!Array.isArray(T))throw new Error("bbox must be an Array");if(T.length!==4&&T.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");T.forEach(function(k){if(!h(k))throw new Error("bbox must only contain numbers")})}te.validateBBox=u;function L(T){if(!T)throw new Error("id is required");if(["string","number"].indexOf(typeof T)===-1)throw new Error("id must be a number or a string")}te.validateId=L},{}],63:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var A=d("@turf/helpers");function g(m,l,w){if(m!==null)for(var _,h,b,u,L,T,k,P=0,z=0,I,D=m.type,R=D==="FeatureCollection",O=D==="Feature",F=R?m.features.length:1,N=0;N<F;N++){k=R?m.features[N].geometry:O?m.geometry:m,I=k?k.type==="GeometryCollection":!1,L=I?k.geometries.length:1;for(var G=0;G<L;G++){var K=0,W=0;if(u=I?k.geometries[G]:k,u!==null){T=u.coordinates;var Y=u.type;switch(P=w&&(Y==="Polygon"||Y==="MultiPolygon")?1:0,Y){case null:break;case"Point":if(l(T,z,N,K,W)===!1)return!1;z++,K++;break;case"LineString":case"MultiPoint":for(_=0;_<T.length;_++){if(l(T[_],z,N,K,W)===!1)return!1;z++,Y==="MultiPoint"&&K++}Y==="LineString"&&K++;break;case"Polygon":case"MultiLineString":for(_=0;_<T.length;_++){for(h=0;h<T[_].length-P;h++){if(l(T[_][h],z,N,K,W)===!1)return!1;z++}Y==="MultiLineString"&&K++,Y==="Polygon"&&W++}Y==="Polygon"&&K++;break;case"MultiPolygon":for(_=0;_<T.length;_++){for(W=0,h=0;h<T[_].length;h++){for(b=0;b<T[_][h].length-P;b++){if(l(T[_][h][b],z,N,K,W)===!1)return!1;z++}W++}K++}break;case"GeometryCollection":for(_=0;_<u.geometries.length;_++)if(g(u.geometries[_],l,w)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function S(m,l,w,_){var h=w;return g(m,function(b,u,L,T,k){u===0&&w===void 0?h=b:h=l(h,b,u,L,T,k)},_),h}function M(m,l){var w;switch(m.type){case"FeatureCollection":for(w=0;w<m.features.length&&l(m.features[w].properties,w)!==!1;w++);break;case"Feature":l(m.properties,0);break}}function e(m,l,w){var _=w;return M(m,function(h,b){b===0&&w===void 0?_=h:_=l(_,h,b)}),_}function a(m,l){if(m.type==="Feature")l(m,0);else if(m.type==="FeatureCollection")for(var w=0;w<m.features.length&&l(m.features[w],w)!==!1;w++);}function n(m,l,w){var _=w;return a(m,function(h,b){b===0&&w===void 0?_=h:_=l(_,h,b)}),_}function r(m){var l=[];return g(m,function(w){l.push(w)}),l}function t(m,l){var w,_,h,b,u,L,T,k,P,z,I=0,D=m.type==="FeatureCollection",R=m.type==="Feature",O=D?m.features.length:1;for(w=0;w<O;w++){for(L=D?m.features[w].geometry:R?m.geometry:m,k=D?m.features[w].properties:R?m.properties:{},P=D?m.features[w].bbox:R?m.bbox:void 0,z=D?m.features[w].id:R?m.id:void 0,T=L?L.type==="GeometryCollection":!1,u=T?L.geometries.length:1,h=0;h<u;h++){if(b=T?L.geometries[h]:L,b===null){if(l(null,I,k,P,z)===!1)return!1;continue}switch(b.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(l(b,I,k,P,z)===!1)return!1;break}case"GeometryCollection":{for(_=0;_<b.geometries.length;_++)if(l(b.geometries[_],I,k,P,z)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}I++}}function c(m,l,w){var _=w;return t(m,function(h,b,u,L,T){b===0&&w===void 0?_=h:_=l(_,h,b,u,L,T)}),_}function s(m,l){t(m,function(w,_,h,b,u){var L=w===null?null:w.type;switch(L){case null:case"Point":case"LineString":case"Polygon":return l(A.feature(w,h,{bbox:b,id:u}),_,0)===!1?!1:void 0}var T;switch(L){case"MultiPoint":T="Point";break;case"MultiLineString":T="LineString";break;case"MultiPolygon":T="Polygon";break}for(var k=0;k<w.coordinates.length;k++){var P=w.coordinates[k],z={type:T,coordinates:P};if(l(A.feature(z,h),_,k)===!1)return!1}})}function i(m,l,w){var _=w;return s(m,function(h,b,u){b===0&&u===0&&w===void 0?_=h:_=l(_,h,b,u)}),_}function x(m,l){s(m,function(w,_,h){var b=0;if(!!w.geometry){var u=w.geometry.type;if(!(u==="Point"||u==="MultiPoint")){var L,T=0,k=0,P=0;if(g(w,function(z,I,D,R,O){if(L===void 0||_>T||R>k||O>P){L=z,T=_,k=R,P=O,b=0;return}var F=A.lineString([L,z],w.properties);if(l(F,_,h,O,b)===!1)return!1;b++,L=z})===!1)return!1}}})}function p(m,l,w){var _=w,h=!1;return x(m,function(b,u,L,T,k){h===!1&&w===void 0?_=b:_=l(_,b,u,L,T,k),h=!0}),_}function v(m,l){if(!m)throw new Error("geojson is required");s(m,function(w,_,h){if(w.geometry!==null){var b=w.geometry.type,u=w.geometry.coordinates;switch(b){case"LineString":if(l(w,_,h,0,0)===!1)return!1;break;case"Polygon":for(var L=0;L<u.length;L++)if(l(A.lineString(u[L],w.properties),_,h,L)===!1)return!1;break}}})}function f(m,l,w){var _=w;return v(m,function(h,b,u,L){b===0&&w===void 0?_=h:_=l(_,h,b,u,L)}),_}function y(m,l){if(l=l||{},!A.isObject(l))throw new Error("options is invalid");var w=l.featureIndex||0,_=l.multiFeatureIndex||0,h=l.geometryIndex||0,b=l.segmentIndex||0,u=l.properties,L;switch(m.type){case"FeatureCollection":w<0&&(w=m.features.length+w),u=u||m.features[w].properties,L=m.features[w].geometry;break;case"Feature":u=u||m.properties,L=m.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=m;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var T=L.coordinates;switch(L.type){case"Point":case"MultiPoint":return null;case"LineString":return b<0&&(b=T.length+b-1),A.lineString([T[b],T[b+1]],u,l);case"Polygon":return h<0&&(h=T.length+h),b<0&&(b=T[h].length+b-1),A.lineString([T[h][b],T[h][b+1]],u,l);case"MultiLineString":return _<0&&(_=T.length+_),b<0&&(b=T[_].length+b-1),A.lineString([T[_][b],T[_][b+1]],u,l);case"MultiPolygon":return _<0&&(_=T.length+_),h<0&&(h=T[_].length+h),b<0&&(b=T[_][h].length-b-1),A.lineString([T[_][h][b],T[_][h][b+1]],u,l)}throw new Error("geojson is invalid")}function o(m,l){if(l=l||{},!A.isObject(l))throw new Error("options is invalid");var w=l.featureIndex||0,_=l.multiFeatureIndex||0,h=l.geometryIndex||0,b=l.coordIndex||0,u=l.properties,L;switch(m.type){case"FeatureCollection":w<0&&(w=m.features.length+w),u=u||m.features[w].properties,L=m.features[w].geometry;break;case"Feature":u=u||m.properties,L=m.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=m;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var T=L.coordinates;switch(L.type){case"Point":return A.point(T,u,l);case"MultiPoint":return _<0&&(_=T.length+_),A.point(T[_],u,l);case"LineString":return b<0&&(b=T.length+b),A.point(T[b],u,l);case"Polygon":return h<0&&(h=T.length+h),b<0&&(b=T[h].length+b),A.point(T[h][b],u,l);case"MultiLineString":return _<0&&(_=T.length+_),b<0&&(b=T[_].length+b),A.point(T[_][b],u,l);case"MultiPolygon":return _<0&&(_=T.length+_),h<0&&(h=T[_].length+h),b<0&&(b=T[_][h].length-b),A.point(T[_][h][b],u,l)}throw new Error("geojson is invalid")}te.coordEach=g,te.coordReduce=S,te.propEach=M,te.propReduce=e,te.featureEach=a,te.featureReduce=n,te.coordAll=r,te.geomEach=t,te.geomReduce=c,te.flattenEach=s,te.flattenReduce=i,te.segmentEach=x,te.segmentReduce=p,te.lineEach=v,te.lineReduce=f,te.findSegment=y,te.findPoint=o},{"@turf/helpers":62}],64:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var A=d("@turf/meta");function g(S){var M=[1/0,1/0,-1/0,-1/0];return A.coordEach(S,function(e){M[0]>e[0]&&(M[0]=e[0]),M[1]>e[1]&&(M[1]=e[1]),M[2]<e[0]&&(M[2]=e[0]),M[3]<e[1]&&(M[3]=e[1])}),M}g.default=g,te.default=g},{"@turf/meta":66}],65:[function(d,ee,te){arguments[4][62][0].apply(te,arguments)},{dup:62}],66:[function(d,ee,te){arguments[4][63][0].apply(te,arguments)},{"@turf/helpers":65,dup:63}],67:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var A=d("@turf/meta"),g=d("@turf/helpers");function S(M,e){e===void 0&&(e={});var a=0,n=0,r=0;return A.coordEach(M,function(t){a+=t[0],n+=t[1],r++}),g.point([a/r,n/r],e.properties)}te.default=S},{"@turf/helpers":68,"@turf/meta":69}],68:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0}),te.earthRadius=63710088e-1,te.factors={centimeters:te.earthRadius*100,centimetres:te.earthRadius*100,degrees:te.earthRadius/111325,feet:te.earthRadius*3.28084,inches:te.earthRadius*39.37,kilometers:te.earthRadius/1e3,kilometres:te.earthRadius/1e3,meters:te.earthRadius,metres:te.earthRadius,miles:te.earthRadius/1609.344,millimeters:te.earthRadius*1e3,millimetres:te.earthRadius*1e3,nauticalmiles:te.earthRadius/1852,radians:1,yards:te.earthRadius/1.0936},te.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/te.earthRadius,yards:1/1.0936},te.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function A(O,F,N){N===void 0&&(N={});var G={type:"Feature"};return(N.id===0||N.id)&&(G.id=N.id),N.bbox&&(G.bbox=N.bbox),G.properties=F||{},G.geometry=O,G}te.feature=A;function g(O,F,N){switch(O){case"Point":return S(F).geometry;case"LineString":return n(F).geometry;case"Polygon":return e(F).geometry;case"MultiPoint":return s(F).geometry;case"MultiLineString":return c(F).geometry;case"MultiPolygon":return i(F).geometry;default:throw new Error(O+" is invalid")}}te.geometry=g;function S(O,F,N){N===void 0&&(N={});var G={type:"Point",coordinates:O};return A(G,F,N)}te.point=S;function M(O,F,N){return N===void 0&&(N={}),t(O.map(function(G){return S(G,F)}),N)}te.points=M;function e(O,F,N){N===void 0&&(N={});for(var G=0,K=O;G<K.length;G++){var W=K[G];if(W.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Y=0;Y<W[W.length-1].length;Y++)if(W[W.length-1][Y]!==W[0][Y])throw new Error("First and last Position are not equivalent.")}var re={type:"Polygon",coordinates:O};return A(re,F,N)}te.polygon=e;function a(O,F,N){return N===void 0&&(N={}),t(O.map(function(G){return e(G,F)}),N)}te.polygons=a;function n(O,F,N){if(N===void 0&&(N={}),O.length<2)throw new Error("coordinates must be an array of two or more positions");var G={type:"LineString",coordinates:O};return A(G,F,N)}te.lineString=n;function r(O,F,N){return N===void 0&&(N={}),t(O.map(function(G){return n(G,F)}),N)}te.lineStrings=r;function t(O,F){F===void 0&&(F={});var N={type:"FeatureCollection"};return F.id&&(N.id=F.id),F.bbox&&(N.bbox=F.bbox),N.features=O,N}te.featureCollection=t;function c(O,F,N){N===void 0&&(N={});var G={type:"MultiLineString",coordinates:O};return A(G,F,N)}te.multiLineString=c;function s(O,F,N){N===void 0&&(N={});var G={type:"MultiPoint",coordinates:O};return A(G,F,N)}te.multiPoint=s;function i(O,F,N){N===void 0&&(N={});var G={type:"MultiPolygon",coordinates:O};return A(G,F,N)}te.multiPolygon=i;function x(O,F,N){N===void 0&&(N={});var G={type:"GeometryCollection",geometries:O};return A(G,F,N)}te.geometryCollection=x;function p(O,F){if(F===void 0&&(F=0),F&&!(F>=0))throw new Error("precision must be a positive number");var N=Math.pow(10,F||0);return Math.round(O*N)/N}te.round=p;function v(O,F){F===void 0&&(F="kilometers");var N=te.factors[F];if(!N)throw new Error(F+" units is invalid");return O*N}te.radiansToLength=v;function f(O,F){F===void 0&&(F="kilometers");var N=te.factors[F];if(!N)throw new Error(F+" units is invalid");return O/N}te.lengthToRadians=f;function y(O,F){return m(f(O,F))}te.lengthToDegrees=y;function o(O){var F=O%360;return F<0&&(F+=360),F}te.bearingToAzimuth=o;function m(O){var F=O%(2*Math.PI);return F*180/Math.PI}te.radiansToDegrees=m;function l(O){var F=O%360;return F*Math.PI/180}te.degreesToRadians=l;function w(O,F,N){if(F===void 0&&(F="kilometers"),N===void 0&&(N="kilometers"),!(O>=0))throw new Error("length must be a positive number");return v(f(O,F),N)}te.convertLength=w;function _(O,F,N){if(F===void 0&&(F="meters"),N===void 0&&(N="kilometers"),!(O>=0))throw new Error("area must be a positive number");var G=te.areaFactors[F];if(!G)throw new Error("invalid original units");var K=te.areaFactors[N];if(!K)throw new Error("invalid final units");return O/G*K}te.convertArea=_;function h(O){return!isNaN(O)&&O!==null&&!Array.isArray(O)&&!/^\s*$/.test(O)}te.isNumber=h;function b(O){return!!O&&O.constructor===Object}te.isObject=b;function u(O){if(!O)throw new Error("bbox is required");if(!Array.isArray(O))throw new Error("bbox must be an Array");if(O.length!==4&&O.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");O.forEach(function(F){if(!h(F))throw new Error("bbox must only contain numbers")})}te.validateBBox=u;function L(O){if(!O)throw new Error("id is required");if(["string","number"].indexOf(typeof O)===-1)throw new Error("id must be a number or a string")}te.validateId=L;function T(){throw new Error("method has been renamed to `radiansToDegrees`")}te.radians2degrees=T;function k(){throw new Error("method has been renamed to `degreesToRadians`")}te.degrees2radians=k;function P(){throw new Error("method has been renamed to `lengthToDegrees`")}te.distanceToDegrees=P;function z(){throw new Error("method has been renamed to `lengthToRadians`")}te.distanceToRadians=z;function I(){throw new Error("method has been renamed to `radiansToLength`")}te.radiansToDistance=I;function D(){throw new Error("method has been renamed to `bearingToAzimuth`")}te.bearingToAngle=D;function R(){throw new Error("method has been renamed to `convertLength`")}te.convertDistance=R},{}],69:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var A=d("@turf/helpers");function g(m,l,w){if(m!==null)for(var _,h,b,u,L,T,k,P=0,z=0,I,D=m.type,R=D==="FeatureCollection",O=D==="Feature",F=R?m.features.length:1,N=0;N<F;N++){k=R?m.features[N].geometry:O?m.geometry:m,I=k?k.type==="GeometryCollection":!1,L=I?k.geometries.length:1;for(var G=0;G<L;G++){var K=0,W=0;if(u=I?k.geometries[G]:k,u!==null){T=u.coordinates;var Y=u.type;switch(P=w&&(Y==="Polygon"||Y==="MultiPolygon")?1:0,Y){case null:break;case"Point":if(l(T,z,N,K,W)===!1)return!1;z++,K++;break;case"LineString":case"MultiPoint":for(_=0;_<T.length;_++){if(l(T[_],z,N,K,W)===!1)return!1;z++,Y==="MultiPoint"&&K++}Y==="LineString"&&K++;break;case"Polygon":case"MultiLineString":for(_=0;_<T.length;_++){for(h=0;h<T[_].length-P;h++){if(l(T[_][h],z,N,K,W)===!1)return!1;z++}Y==="MultiLineString"&&K++,Y==="Polygon"&&W++}Y==="Polygon"&&K++;break;case"MultiPolygon":for(_=0;_<T.length;_++){for(W=0,h=0;h<T[_].length;h++){for(b=0;b<T[_][h].length-P;b++){if(l(T[_][h][b],z,N,K,W)===!1)return!1;z++}W++}K++}break;case"GeometryCollection":for(_=0;_<u.geometries.length;_++)if(g(u.geometries[_],l,w)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function S(m,l,w,_){var h=w;return g(m,function(b,u,L,T,k){u===0&&w===void 0?h=b:h=l(h,b,u,L,T,k)},_),h}function M(m,l){var w;switch(m.type){case"FeatureCollection":for(w=0;w<m.features.length&&l(m.features[w].properties,w)!==!1;w++);break;case"Feature":l(m.properties,0);break}}function e(m,l,w){var _=w;return M(m,function(h,b){b===0&&w===void 0?_=h:_=l(_,h,b)}),_}function a(m,l){if(m.type==="Feature")l(m,0);else if(m.type==="FeatureCollection")for(var w=0;w<m.features.length&&l(m.features[w],w)!==!1;w++);}function n(m,l,w){var _=w;return a(m,function(h,b){b===0&&w===void 0?_=h:_=l(_,h,b)}),_}function r(m){var l=[];return g(m,function(w){l.push(w)}),l}function t(m,l){var w,_,h,b,u,L,T,k,P,z,I=0,D=m.type==="FeatureCollection",R=m.type==="Feature",O=D?m.features.length:1;for(w=0;w<O;w++){for(L=D?m.features[w].geometry:R?m.geometry:m,k=D?m.features[w].properties:R?m.properties:{},P=D?m.features[w].bbox:R?m.bbox:void 0,z=D?m.features[w].id:R?m.id:void 0,T=L?L.type==="GeometryCollection":!1,u=T?L.geometries.length:1,h=0;h<u;h++){if(b=T?L.geometries[h]:L,b===null){if(l(null,I,k,P,z)===!1)return!1;continue}switch(b.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(l(b,I,k,P,z)===!1)return!1;break}case"GeometryCollection":{for(_=0;_<b.geometries.length;_++)if(l(b.geometries[_],I,k,P,z)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}I++}}function c(m,l,w){var _=w;return t(m,function(h,b,u,L,T){b===0&&w===void 0?_=h:_=l(_,h,b,u,L,T)}),_}function s(m,l){t(m,function(w,_,h,b,u){var L=w===null?null:w.type;switch(L){case null:case"Point":case"LineString":case"Polygon":return l(A.feature(w,h,{bbox:b,id:u}),_,0)===!1?!1:void 0}var T;switch(L){case"MultiPoint":T="Point";break;case"MultiLineString":T="LineString";break;case"MultiPolygon":T="Polygon";break}for(var k=0;k<w.coordinates.length;k++){var P=w.coordinates[k],z={type:T,coordinates:P};if(l(A.feature(z,h),_,k)===!1)return!1}})}function i(m,l,w){var _=w;return s(m,function(h,b,u){b===0&&u===0&&w===void 0?_=h:_=l(_,h,b,u)}),_}function x(m,l){s(m,function(w,_,h){var b=0;if(!!w.geometry){var u=w.geometry.type;if(!(u==="Point"||u==="MultiPoint")){var L,T=0,k=0,P=0;if(g(w,function(z,I,D,R,O){if(L===void 0||_>T||R>k||O>P){L=z,T=_,k=R,P=O,b=0;return}var F=A.lineString([L,z],w.properties);if(l(F,_,h,O,b)===!1)return!1;b++,L=z})===!1)return!1}}})}function p(m,l,w){var _=w,h=!1;return x(m,function(b,u,L,T,k){h===!1&&w===void 0?_=b:_=l(_,b,u,L,T,k),h=!0}),_}function v(m,l){if(!m)throw new Error("geojson is required");s(m,function(w,_,h){if(w.geometry!==null){var b=w.geometry.type,u=w.geometry.coordinates;switch(b){case"LineString":if(l(w,_,h,0,0)===!1)return!1;break;case"Polygon":for(var L=0;L<u.length;L++)if(l(A.lineString(u[L],w.properties),_,h,L)===!1)return!1;break}}})}function f(m,l,w){var _=w;return v(m,function(h,b,u,L){b===0&&w===void 0?_=h:_=l(_,h,b,u,L)}),_}function y(m,l){if(l=l||{},!A.isObject(l))throw new Error("options is invalid");var w=l.featureIndex||0,_=l.multiFeatureIndex||0,h=l.geometryIndex||0,b=l.segmentIndex||0,u=l.properties,L;switch(m.type){case"FeatureCollection":w<0&&(w=m.features.length+w),u=u||m.features[w].properties,L=m.features[w].geometry;break;case"Feature":u=u||m.properties,L=m.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=m;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var T=L.coordinates;switch(L.type){case"Point":case"MultiPoint":return null;case"LineString":return b<0&&(b=T.length+b-1),A.lineString([T[b],T[b+1]],u,l);case"Polygon":return h<0&&(h=T.length+h),b<0&&(b=T[h].length+b-1),A.lineString([T[h][b],T[h][b+1]],u,l);case"MultiLineString":return _<0&&(_=T.length+_),b<0&&(b=T[_].length+b-1),A.lineString([T[_][b],T[_][b+1]],u,l);case"MultiPolygon":return _<0&&(_=T.length+_),h<0&&(h=T[_].length+h),b<0&&(b=T[_][h].length-b-1),A.lineString([T[_][h][b],T[_][h][b+1]],u,l)}throw new Error("geojson is invalid")}function o(m,l){if(l=l||{},!A.isObject(l))throw new Error("options is invalid");var w=l.featureIndex||0,_=l.multiFeatureIndex||0,h=l.geometryIndex||0,b=l.coordIndex||0,u=l.properties,L;switch(m.type){case"FeatureCollection":w<0&&(w=m.features.length+w),u=u||m.features[w].properties,L=m.features[w].geometry;break;case"Feature":u=u||m.properties,L=m.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=m;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var T=L.coordinates;switch(L.type){case"Point":return A.point(T,u,l);case"MultiPoint":return _<0&&(_=T.length+_),A.point(T[_],u,l);case"LineString":return b<0&&(b=T.length+b),A.point(T[b],u,l);case"Polygon":return h<0&&(h=T.length+h),b<0&&(b=T[h].length+b),A.point(T[h][b],u,l);case"MultiLineString":return _<0&&(_=T.length+_),b<0&&(b=T[_].length+b),A.point(T[_][b],u,l);case"MultiPolygon":return _<0&&(_=T.length+_),h<0&&(h=T[_].length+h),b<0&&(b=T[_][h].length-b),A.point(T[_][h][b],u,l)}throw new Error("geojson is invalid")}te.coordEach=g,te.coordReduce=S,te.propEach=M,te.propReduce=e,te.featureEach=a,te.featureReduce=n,te.coordAll=r,te.geomEach=t,te.geomReduce=c,te.flattenEach=s,te.flattenReduce=i,te.segmentEach=x,te.segmentReduce=p,te.lineEach=v,te.lineReduce=f,te.findSegment=y,te.findPoint=o},{"@turf/helpers":68}],70:[function(d,ee,te){ee.exports=A;function A(g){var S=0,M=0,e=0,a=0;return g.map(function(n){n=n.slice();var r=n[0],t=r.toUpperCase();if(r!=t)switch(n[0]=t,r){case"a":n[6]+=e,n[7]+=a;break;case"v":n[1]+=a;break;case"h":n[1]+=e;break;default:for(var c=1;c<n.length;)n[c++]+=e,n[c++]+=a}switch(t){case"Z":e=S,a=M;break;case"H":e=n[1];break;case"V":a=n[1];break;case"M":e=S=n[1],a=M=n[2];break;default:e=n[n.length-2],a=n[n.length-1]}return n})}},{}],71:[function(d,ee,te){ee.exports=A;function A(g,S){if(!g||g.length==null)throw Error("Argument should be an array");S==null?S=1:S=Math.floor(S);for(var M=Array(S*2),e=0;e<S;e++){for(var a=-1/0,n=1/0,r=e,t=g.length;r<t;r+=S)g[r]>a&&(a=g[r]),g[r]<n&&(n=g[r]);M[e]=n,M[S+e]=a}return M}},{}],72:[function(d,ee,te){ee.exports=function(A,g,S){if(typeof Array.prototype.findIndex=="function")return A.findIndex(g,S);if(typeof g!="function")throw new TypeError("predicate must be a function");var M=Object(A),e=M.length;if(e===0)return-1;for(var a=0;a<e;a++)if(g.call(S,M[a],a,M))return a;return-1}},{}],73:[function(d,ee,te){var A=d("array-bounds");ee.exports=g;function g(S,M,e){if(!S||S.length==null)throw Error("Argument should be an array");M==null&&(M=1),e==null&&(e=A(S,M));for(var a=0;a<M;a++){var n=e[M+a],r=e[a],t=a,c=S.length;if(n===1/0&&r===-1/0)for(t=a;t<c;t+=M)S[t]=S[t]===n?1:S[t]===r?0:.5;else if(n===1/0)for(t=a;t<c;t+=M)S[t]=S[t]===n?1:0;else if(r===-1/0)for(t=a;t<c;t+=M)S[t]=S[t]===r?0:1;else{var s=n-r;for(t=a;t<c;t+=M)isNaN(S[t])||(S[t]=s===0?.5:(S[t]-r)/s)}}return S}},{"array-bounds":71}],74:[function(d,ee,te){ee.exports=function(g,S){var M=typeof g=="number",e=typeof S=="number";M&&!e?(S=g,g=0):!M&&!e&&(g=0,S=0),g=g|0,S=S|0;var a=S-g;if(a<0)throw new Error("array length must be positive");for(var n=new Array(a),r=0,t=g;r<a;r++,t++)n[r]=t;return n}},{}],75:[function(d,ee,te){(function(A){(function(){var g=d("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function S(k,P){if(k===P)return 0;for(var z=k.length,I=P.length,D=0,R=Math.min(z,I);D<R;++D)if(k[D]!==P[D]){z=k[D],I=P[D];break}return z<I?-1:I<z?1:0}function M(k){return A.Buffer&&typeof A.Buffer.isBuffer=="function"?A.Buffer.isBuffer(k):!!(k!=null&&k._isBuffer)}var e=d("util/"),a=Object.prototype.hasOwnProperty,n=Array.prototype.slice,r=function(){return function(){}.name==="foo"}();function t(k){return Object.prototype.toString.call(k)}function c(k){return M(k)||typeof A.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(k):k?!!(k instanceof DataView||k.buffer&&k.buffer instanceof ArrayBuffer):!1}var s=ee.exports=o,i=/\s*function\s+([^\(\s]*)\s*/;function x(k){if(!!e.isFunction(k)){if(r)return k.name;var P=k.toString(),z=P.match(i);return z&&z[1]}}s.AssertionError=function(P){this.name="AssertionError",this.actual=P.actual,this.expected=P.expected,this.operator=P.operator,P.message?(this.message=P.message,this.generatedMessage=!1):(this.message=f(this),this.generatedMessage=!0);var z=P.stackStartFunction||y;if(Error.captureStackTrace)Error.captureStackTrace(this,z);else{var I=new Error;if(I.stack){var D=I.stack,R=x(z),O=D.indexOf(`
`+R);if(O>=0){var F=D.indexOf(`
`,O+1);D=D.substring(F+1)}this.stack=D}}},e.inherits(s.AssertionError,Error);function p(k,P){return typeof k=="string"?k.length<P?k:k.slice(0,P):k}function v(k){if(r||!e.isFunction(k))return e.inspect(k);var P=x(k),z=P?": "+P:"";return"[Function"+z+"]"}function f(k){return p(v(k.actual),128)+" "+k.operator+" "+p(v(k.expected),128)}function y(k,P,z,I,D){throw new s.AssertionError({message:z,actual:k,expected:P,operator:I,stackStartFunction:D})}s.fail=y;function o(k,P){k||y(k,!0,P,"==",s.ok)}s.ok=o,s.equal=function(P,z,I){P!=z&&y(P,z,I,"==",s.equal)},s.notEqual=function(P,z,I){P==z&&y(P,z,I,"!=",s.notEqual)},s.deepEqual=function(P,z,I){m(P,z,!1)||y(P,z,I,"deepEqual",s.deepEqual)},s.deepStrictEqual=function(P,z,I){m(P,z,!0)||y(P,z,I,"deepStrictEqual",s.deepStrictEqual)};function m(k,P,z,I){if(k===P)return!0;if(M(k)&&M(P))return S(k,P)===0;if(e.isDate(k)&&e.isDate(P))return k.getTime()===P.getTime();if(e.isRegExp(k)&&e.isRegExp(P))return k.source===P.source&&k.global===P.global&&k.multiline===P.multiline&&k.lastIndex===P.lastIndex&&k.ignoreCase===P.ignoreCase;if((k===null||typeof k!="object")&&(P===null||typeof P!="object"))return z?k===P:k==P;if(c(k)&&c(P)&&t(k)===t(P)&&!(k instanceof Float32Array||k instanceof Float64Array))return S(new Uint8Array(k.buffer),new Uint8Array(P.buffer))===0;if(M(k)!==M(P))return!1;I=I||{actual:[],expected:[]};var D=I.actual.indexOf(k);return D!==-1&&D===I.expected.indexOf(P)?!0:(I.actual.push(k),I.expected.push(P),w(k,P,z,I))}function l(k){return Object.prototype.toString.call(k)=="[object Arguments]"}function w(k,P,z,I){if(k==null||P===null||P===void 0)return!1;if(e.isPrimitive(k)||e.isPrimitive(P))return k===P;if(z&&Object.getPrototypeOf(k)!==Object.getPrototypeOf(P))return!1;var D=l(k),R=l(P);if(D&&!R||!D&&R)return!1;if(D)return k=n.call(k),P=n.call(P),m(k,P,z);var O=T(k),F=T(P),N,G;if(O.length!==F.length)return!1;for(O.sort(),F.sort(),G=O.length-1;G>=0;G--)if(O[G]!==F[G])return!1;for(G=O.length-1;G>=0;G--)if(N=O[G],!m(k[N],P[N],z,I))return!1;return!0}s.notDeepEqual=function(P,z,I){m(P,z,!1)&&y(P,z,I,"notDeepEqual",s.notDeepEqual)},s.notDeepStrictEqual=_;function _(k,P,z){m(k,P,!0)&&y(k,P,z,"notDeepStrictEqual",_)}s.strictEqual=function(P,z,I){P!==z&&y(P,z,I,"===",s.strictEqual)},s.notStrictEqual=function(P,z,I){P===z&&y(P,z,I,"!==",s.notStrictEqual)};function h(k,P){if(!k||!P)return!1;if(Object.prototype.toString.call(P)=="[object RegExp]")return P.test(k);try{if(k instanceof P)return!0}catch{}return Error.isPrototypeOf(P)?!1:P.call({},k)===!0}function b(k){var P;try{k()}catch(z){P=z}return P}function u(k,P,z,I){var D;if(typeof P!="function")throw new TypeError('"block" argument must be a function');typeof z=="string"&&(I=z,z=null),D=b(P),I=(z&&z.name?" ("+z.name+").":".")+(I?" "+I:"."),k&&!D&&y(D,z,"Missing expected exception"+I);var R=typeof I=="string",O=!k&&e.isError(D),F=!k&&D&&!z;if((O&&R&&h(D,z)||F)&&y(D,z,"Got unwanted exception"+I),k&&D&&z&&!h(D,z)||!k&&D)throw D}s.throws=function(k,P,z){u(!0,k,P,z)},s.doesNotThrow=function(k,P,z){u(!1,k,P,z)},s.ifError=function(k){if(k)throw k};function L(k,P){k||y(k,!0,P,"==",L)}s.strict=g(L,s,{equal:s.strictEqual,deepEqual:s.deepStrictEqual,notEqual:s.notStrictEqual,notDeepEqual:s.notDeepStrictEqual}),s.strict.strict=s.strict;var T=Object.keys||function(k){var P=[];for(var z in k)a.call(k,z)&&P.push(z);return P}}).call(this)}).call(this,typeof Mo<"u"?Mo:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":247,"util/":78}],76:[function(d,ee,te){typeof Object.create=="function"?ee.exports=function(g,S){g.super_=S,g.prototype=Object.create(S.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:ee.exports=function(g,S){g.super_=S;var M=function(){};M.prototype=S.prototype,g.prototype=new M,g.prototype.constructor=g}},{}],77:[function(d,ee,te){ee.exports=function(g){return g&&typeof g=="object"&&typeof g.copy=="function"&&typeof g.fill=="function"&&typeof g.readUInt8=="function"}},{}],78:[function(d,ee,te){(function(A,g){(function(){var S=/%[sdj%]/g;te.format=function(F){if(!w(F)){for(var N=[],G=0;G<arguments.length;G++)N.push(a(arguments[G]));return N.join(" ")}for(var G=1,K=arguments,W=K.length,Y=String(F).replace(S,function(ue){if(ue==="%%")return"%";if(G>=W)return ue;switch(ue){case"%s":return String(K[G++]);case"%d":return Number(K[G++]);case"%j":try{return JSON.stringify(K[G++])}catch{return"[Circular]"}default:return ue}}),re=K[G];G<W;re=K[++G])o(re)||!u(re)?Y+=" "+re:Y+=" "+a(re);return Y},te.deprecate=function(F,N){if(h(g.process))return function(){return te.deprecate(F,N).apply(this,arguments)};if(A.noDeprecation===!0)return F;var G=!1;function K(){if(!G){if(A.throwDeprecation)throw new Error(N);A.traceDeprecation?console.trace(N):console.error(N),G=!0}return F.apply(this,arguments)}return K};var M={},e;te.debuglog=function(F){if(h(e)&&(e=A.env.NODE_DEBUG||""),F=F.toUpperCase(),!M[F])if(new RegExp("\\b"+F+"\\b","i").test(e)){var N=A.pid;M[F]=function(){var G=te.format.apply(te,arguments);console.error("%s %d: %s",F,N,G)}}else M[F]=function(){};return M[F]};function a(F,N){var G={seen:[],stylize:r};return arguments.length>=3&&(G.depth=arguments[2]),arguments.length>=4&&(G.colors=arguments[3]),y(N)?G.showHidden=N:N&&te._extend(G,N),h(G.showHidden)&&(G.showHidden=!1),h(G.depth)&&(G.depth=2),h(G.colors)&&(G.colors=!1),h(G.customInspect)&&(G.customInspect=!0),G.colors&&(G.stylize=n),c(G,F,G.depth)}te.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function n(F,N){var G=a.styles[N];return G?"\x1B["+a.colors[G][0]+"m"+F+"\x1B["+a.colors[G][1]+"m":F}function r(F,N){return F}function t(F){var N={};return F.forEach(function(G,K){N[G]=!0}),N}function c(F,N,G){if(F.customInspect&&N&&k(N.inspect)&&N.inspect!==te.inspect&&!(N.constructor&&N.constructor.prototype===N)){var K=N.inspect(G,F);return w(K)||(K=c(F,K,G)),K}var W=s(F,N);if(W)return W;var Y=Object.keys(N),re=t(Y);if(F.showHidden&&(Y=Object.getOwnPropertyNames(N)),T(N)&&(Y.indexOf("message")>=0||Y.indexOf("description")>=0))return i(N);if(Y.length===0){if(k(N)){var ue=N.name?": "+N.name:"";return F.stylize("[Function"+ue+"]","special")}if(b(N))return F.stylize(RegExp.prototype.toString.call(N),"regexp");if(L(N))return F.stylize(Date.prototype.toString.call(N),"date");if(T(N))return i(N)}var j="",q=!1,V=["{","}"];if(f(N)&&(q=!0,V=["[","]"]),k(N)){var U=N.name?": "+N.name:"";j=" [Function"+U+"]"}if(b(N)&&(j=" "+RegExp.prototype.toString.call(N)),L(N)&&(j=" "+Date.prototype.toUTCString.call(N)),T(N)&&(j=" "+i(N)),Y.length===0&&(!q||N.length==0))return V[0]+j+V[1];if(G<0)return b(N)?F.stylize(RegExp.prototype.toString.call(N),"regexp"):F.stylize("[Object]","special");F.seen.push(N);var $;return q?$=x(F,N,G,re,Y):$=Y.map(function(ne){return p(F,N,G,re,ne,q)}),F.seen.pop(),v($,j,V)}function s(F,N){if(h(N))return F.stylize("undefined","undefined");if(w(N)){var G="'"+JSON.stringify(N).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return F.stylize(G,"string")}if(l(N))return F.stylize(""+N,"number");if(y(N))return F.stylize(""+N,"boolean");if(o(N))return F.stylize("null","null")}function i(F){return"["+Error.prototype.toString.call(F)+"]"}function x(F,N,G,K,W){for(var Y=[],re=0,ue=N.length;re<ue;++re)O(N,String(re))?Y.push(p(F,N,G,K,String(re),!0)):Y.push("");return W.forEach(function(j){j.match(/^\d+$/)||Y.push(p(F,N,G,K,j,!0))}),Y}function p(F,N,G,K,W,Y){var re,ue,j;if(j=Object.getOwnPropertyDescriptor(N,W)||{value:N[W]},j.get?j.set?ue=F.stylize("[Getter/Setter]","special"):ue=F.stylize("[Getter]","special"):j.set&&(ue=F.stylize("[Setter]","special")),O(K,W)||(re="["+W+"]"),ue||(F.seen.indexOf(j.value)<0?(o(G)?ue=c(F,j.value,null):ue=c(F,j.value,G-1),ue.indexOf(`
`)>-1&&(Y?ue=ue.split(`
`).map(function(q){return"  "+q}).join(`
`).substr(2):ue=`
`+ue.split(`
`).map(function(q){return"   "+q}).join(`
`))):ue=F.stylize("[Circular]","special")),h(re)){if(Y&&W.match(/^\d+$/))return ue;re=JSON.stringify(""+W),re.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(re=re.substr(1,re.length-2),re=F.stylize(re,"name")):(re=re.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),re=F.stylize(re,"string"))}return re+": "+ue}function v(F,N,G){var K=F.reduce(function(W,Y){return Y.indexOf(`
`)>=0,W+Y.replace(/\u001b\[\d\d?m/g,"").length+1},0);return K>60?G[0]+(N===""?"":N+`
 `)+" "+F.join(`,
  `)+" "+G[1]:G[0]+N+" "+F.join(", ")+" "+G[1]}function f(F){return Array.isArray(F)}te.isArray=f;function y(F){return typeof F=="boolean"}te.isBoolean=y;function o(F){return F===null}te.isNull=o;function m(F){return F==null}te.isNullOrUndefined=m;function l(F){return typeof F=="number"}te.isNumber=l;function w(F){return typeof F=="string"}te.isString=w;function _(F){return typeof F=="symbol"}te.isSymbol=_;function h(F){return F===void 0}te.isUndefined=h;function b(F){return u(F)&&z(F)==="[object RegExp]"}te.isRegExp=b;function u(F){return typeof F=="object"&&F!==null}te.isObject=u;function L(F){return u(F)&&z(F)==="[object Date]"}te.isDate=L;function T(F){return u(F)&&(z(F)==="[object Error]"||F instanceof Error)}te.isError=T;function k(F){return typeof F=="function"}te.isFunction=k;function P(F){return F===null||typeof F=="boolean"||typeof F=="number"||typeof F=="string"||typeof F=="symbol"||typeof F>"u"}te.isPrimitive=P,te.isBuffer=d("./support/isBuffer");function z(F){return Object.prototype.toString.call(F)}function I(F){return F<10?"0"+F.toString(10):F.toString(10)}var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var F=new Date,N=[I(F.getHours()),I(F.getMinutes()),I(F.getSeconds())].join(":");return[F.getDate(),D[F.getMonth()],N].join(" ")}te.log=function(){console.log("%s - %s",R(),te.format.apply(te,arguments))},te.inherits=d("inherits"),te._extend=function(F,N){if(!N||!u(N))return F;for(var G=Object.keys(N),K=G.length;K--;)F[G[K]]=N[G[K]];return F};function O(F,N){return Object.prototype.hasOwnProperty.call(F,N)}}).call(this)}).call(this,d("_process"),typeof Mo<"u"?Mo:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":77,_process:278,inherits:76}],79:[function(d,ee,te){te.byteLength=r,te.toByteArray=c,te.fromByteArray=x;for(var A=[],g=[],S=typeof Uint8Array<"u"?Uint8Array:Array,M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,a=M.length;e<a;++e)A[e]=M[e],g[M.charCodeAt(e)]=e;g["-".charCodeAt(0)]=62,g["_".charCodeAt(0)]=63;function n(p){var v=p.length;if(v%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var f=p.indexOf("=");f===-1&&(f=v);var y=f===v?0:4-f%4;return[f,y]}function r(p){var v=n(p),f=v[0],y=v[1];return(f+y)*3/4-y}function t(p,v,f){return(v+f)*3/4-f}function c(p){var v,f=n(p),y=f[0],o=f[1],m=new S(t(p,y,o)),l=0,w=o>0?y-4:y,_;for(_=0;_<w;_+=4)v=g[p.charCodeAt(_)]<<18|g[p.charCodeAt(_+1)]<<12|g[p.charCodeAt(_+2)]<<6|g[p.charCodeAt(_+3)],m[l++]=v>>16&255,m[l++]=v>>8&255,m[l++]=v&255;return o===2&&(v=g[p.charCodeAt(_)]<<2|g[p.charCodeAt(_+1)]>>4,m[l++]=v&255),o===1&&(v=g[p.charCodeAt(_)]<<10|g[p.charCodeAt(_+1)]<<4|g[p.charCodeAt(_+2)]>>2,m[l++]=v>>8&255,m[l++]=v&255),m}function s(p){return A[p>>18&63]+A[p>>12&63]+A[p>>6&63]+A[p&63]}function i(p,v,f){for(var y,o=[],m=v;m<f;m+=3)y=(p[m]<<16&16711680)+(p[m+1]<<8&65280)+(p[m+2]&255),o.push(s(y));return o.join("")}function x(p){for(var v,f=p.length,y=f%3,o=[],m=16383,l=0,w=f-y;l<w;l+=m)o.push(i(p,l,l+m>w?w:l+m));return y===1?(v=p[f-1],o.push(A[v>>2]+A[v<<4&63]+"==")):y===2&&(v=(p[f-2]<<8)+p[f-1],o.push(A[v>>10]+A[v>>4&63]+A[v<<2&63]+"=")),o.join("")}},{}],80:[function(d,ee,te){function A(n,r,t,c,s){for(var i=s+1;c<=s;){var x=c+s>>>1,p=n[x],v=t!==void 0?t(p,r):p-r;v>=0?(i=x,s=x-1):c=x+1}return i}function g(n,r,t,c,s){for(var i=s+1;c<=s;){var x=c+s>>>1,p=n[x],v=t!==void 0?t(p,r):p-r;v>0?(i=x,s=x-1):c=x+1}return i}function S(n,r,t,c,s){for(var i=c-1;c<=s;){var x=c+s>>>1,p=n[x],v=t!==void 0?t(p,r):p-r;v<0?(i=x,c=x+1):s=x-1}return i}function M(n,r,t,c,s){for(var i=c-1;c<=s;){var x=c+s>>>1,p=n[x],v=t!==void 0?t(p,r):p-r;v<=0?(i=x,c=x+1):s=x-1}return i}function e(n,r,t,c,s){for(;c<=s;){var i=c+s>>>1,x=n[i],p=t!==void 0?t(x,r):x-r;if(p===0)return i;p<=0?c=i+1:s=i-1}return-1}function a(n,r,t,c,s,i){return typeof t=="function"?i(n,r,t,c===void 0?0:c|0,s===void 0?n.length-1:s|0):i(n,r,void 0,t===void 0?0:t|0,c===void 0?n.length-1:c|0)}ee.exports={ge:function(n,r,t,c,s){return a(n,r,t,c,s,A)},gt:function(n,r,t,c,s){return a(n,r,t,c,s,g)},lt:function(n,r,t,c,s){return a(n,r,t,c,s,S)},le:function(n,r,t,c,s){return a(n,r,t,c,s,M)},eq:function(n,r,t,c,s){return a(n,r,t,c,s,e)}}},{}],81:[function(d,ee,te){var A=32;te.INT_BITS=A,te.INT_MAX=2147483647,te.INT_MIN=-1<<A-1,te.sign=function(M){return(M>0)-(M<0)},te.abs=function(M){var e=M>>A-1;return(M^e)-e},te.min=function(M,e){return e^(M^e)&-(M<e)},te.max=function(M,e){return M^(M^e)&-(M<e)},te.isPow2=function(M){return!(M&M-1)&&!!M},te.log2=function(M){var e,a;return e=(M>65535)<<4,M>>>=e,a=(M>255)<<3,M>>>=a,e|=a,a=(M>15)<<2,M>>>=a,e|=a,a=(M>3)<<1,M>>>=a,e|=a,e|M>>1},te.log10=function(M){return M>=1e9?9:M>=1e8?8:M>=1e7?7:M>=1e6?6:M>=1e5?5:M>=1e4?4:M>=1e3?3:M>=100?2:M>=10?1:0},te.popCount=function(M){return M=M-(M>>>1&1431655765),M=(M&858993459)+(M>>>2&858993459),(M+(M>>>4)&252645135)*16843009>>>24};function g(M){var e=32;return M&=-M,M&&e--,M&65535&&(e-=16),M&16711935&&(e-=8),M&252645135&&(e-=4),M&858993459&&(e-=2),M&1431655765&&(e-=1),e}te.countTrailingZeros=g,te.nextPow2=function(M){return M+=M===0,--M,M|=M>>>1,M|=M>>>2,M|=M>>>4,M|=M>>>8,M|=M>>>16,M+1},te.prevPow2=function(M){return M|=M>>>1,M|=M>>>2,M|=M>>>4,M|=M>>>8,M|=M>>>16,M-(M>>>1)},te.parity=function(M){return M^=M>>>16,M^=M>>>8,M^=M>>>4,M&=15,27030>>>M&1};var S=new Array(256);(function(M){for(var e=0;e<256;++e){var a=e,n=e,r=7;for(a>>>=1;a;a>>>=1)n<<=1,n|=a&1,--r;M[e]=n<<r&255}})(S),te.reverse=function(M){return S[M&255]<<24|S[M>>>8&255]<<16|S[M>>>16&255]<<8|S[M>>>24&255]},te.interleave2=function(M,e){return M&=65535,M=(M|M<<8)&16711935,M=(M|M<<4)&252645135,M=(M|M<<2)&858993459,M=(M|M<<1)&1431655765,e&=65535,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,M|e<<1},te.deinterleave2=function(M,e){return M=M>>>e&1431655765,M=(M|M>>>1)&858993459,M=(M|M>>>2)&252645135,M=(M|M>>>4)&16711935,M=(M|M>>>16)&65535,M<<16>>16},te.interleave3=function(M,e,a){return M&=1023,M=(M|M<<16)&4278190335,M=(M|M<<8)&251719695,M=(M|M<<4)&3272356035,M=(M|M<<2)&1227133513,e&=1023,e=(e|e<<16)&4278190335,e=(e|e<<8)&251719695,e=(e|e<<4)&3272356035,e=(e|e<<2)&1227133513,M|=e<<1,a&=1023,a=(a|a<<16)&4278190335,a=(a|a<<8)&251719695,a=(a|a<<4)&3272356035,a=(a|a<<2)&1227133513,M|a<<2},te.deinterleave3=function(M,e){return M=M>>>e&1227133513,M=(M|M>>>2)&3272356035,M=(M|M>>>4)&251719695,M=(M|M>>>8)&4278190335,M=(M|M>>>16)&1023,M<<22>>22},te.nextCombination=function(M){var e=M|M-1;return e+1|(~e&-~e)-1>>>g(M)+1}},{}],82:[function(d,ee,te){var A=d("clamp");ee.exports=S;var g=1e20;function S(a,n){n||(n={});var r=n.cutoff==null?.25:n.cutoff,t=n.radius==null?8:n.radius,c=n.channel||0,s,i,x,p,v,f,y,o,m,l,w;if(ArrayBuffer.isView(a)||Array.isArray(a)){if(!n.width||!n.height)throw Error("For raw data width and height should be provided by options");s=n.width,i=n.height,p=a,n.stride?f=n.stride:f=Math.floor(a.length/s/i)}else window.HTMLCanvasElement&&a instanceof window.HTMLCanvasElement?(o=a,y=o.getContext("2d"),s=o.width,i=o.height,m=y.getImageData(0,0,s,i),p=m.data,f=4):window.CanvasRenderingContext2D&&a instanceof window.CanvasRenderingContext2D?(o=a.canvas,y=a,s=o.width,i=o.height,m=y.getImageData(0,0,s,i),p=m.data,f=4):window.ImageData&&a instanceof window.ImageData&&(m=a,s=a.width,i=a.height,p=m.data,f=4);if(x=Math.max(s,i),window.Uint8ClampedArray&&p instanceof window.Uint8ClampedArray||window.Uint8Array&&p instanceof window.Uint8Array)for(v=p,p=Array(s*i),l=0,w=v.length;l<w;l++)p[l]=v[l*f+c]/255;else if(f!==1)throw Error("Raw data can have only 1 value per pixel");var _=Array(s*i),h=Array(s*i),b=Array(x),u=Array(x),L=Array(x+1),T=Array(x);for(l=0,w=s*i;l<w;l++){var k=p[l];_[l]=k===1?0:k===0?g:Math.pow(Math.max(0,.5-k),2),h[l]=k===1?g:k===0?0:Math.pow(Math.max(0,k-.5),2)}M(_,s,i,b,u,T,L),M(h,s,i,b,u,T,L);var P=window.Float32Array?new Float32Array(s*i):new Array(s*i);for(l=0,w=s*i;l<w;l++)P[l]=A(1-((_[l]-h[l])/t+r),0,1);return P}function M(a,n,r,t,c,s,i){for(var x=0;x<n;x++){for(var p=0;p<r;p++)t[p]=a[p*n+x];for(e(t,c,s,i,r),p=0;p<r;p++)a[p*n+x]=c[p]}for(p=0;p<r;p++){for(x=0;x<n;x++)t[x]=a[p*n+x];for(e(t,c,s,i,n),x=0;x<n;x++)a[p*n+x]=Math.sqrt(c[x])}}function e(a,n,r,t,c){r[0]=0,t[0]=-g,t[1]=+g;for(var s=1,i=0;s<c;s++){for(var x=(a[s]+s*s-(a[r[i]]+r[i]*r[i]))/(2*s-2*r[i]);x<=t[i];)i--,x=(a[s]+s*s-(a[r[i]]+r[i]*r[i]))/(2*s-2*r[i]);i++,r[i]=s,t[i]=x,t[i+1]=+g}for(s=0,i=0;s<c;s++){for(;t[i+1]<s;)i++;n[s]=(s-r[i])*(s-r[i])+a[r[i]]}}},{clamp:86}],83:[function(d,ee,te){},{}],84:[function(d,ee,te){var A=typeof Reflect=="object"?Reflect:null,g=A&&typeof A.apply=="function"?A.apply:function(l,w,_){return Function.prototype.apply.call(l,w,_)},S;A&&typeof A.ownKeys=="function"?S=A.ownKeys:Object.getOwnPropertySymbols?S=function(l){return Object.getOwnPropertyNames(l).concat(Object.getOwnPropertySymbols(l))}:S=function(l){return Object.getOwnPropertyNames(l)};function M(m){console&&console.warn&&console.warn(m)}var e=Number.isNaN||function(l){return l!==l};function a(){a.init.call(this)}ee.exports=a,ee.exports.once=o,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var n=10;function r(m){if(typeof m!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof m)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return n},set:function(m){if(typeof m!="number"||m<0||e(m))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+m+".");n=m}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(l){if(typeof l!="number"||l<0||e(l))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+l+".");return this._maxListeners=l,this};function t(m){return m._maxListeners===void 0?a.defaultMaxListeners:m._maxListeners}a.prototype.getMaxListeners=function(){return t(this)},a.prototype.emit=function(l){for(var w=[],_=1;_<arguments.length;_++)w.push(arguments[_]);var h=l==="error",b=this._events;if(b!==void 0)h=h&&b.error===void 0;else if(!h)return!1;if(h){var u;if(w.length>0&&(u=w[0]),u instanceof Error)throw u;var L=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw L.context=u,L}var T=b[l];if(T===void 0)return!1;if(typeof T=="function")g(T,this,w);else for(var k=T.length,P=v(T,k),_=0;_<k;++_)g(P[_],this,w);return!0};function c(m,l,w,_){var h,b,u;if(r(w),b=m._events,b===void 0?(b=m._events=Object.create(null),m._eventsCount=0):(b.newListener!==void 0&&(m.emit("newListener",l,w.listener?w.listener:w),b=m._events),u=b[l]),u===void 0)u=b[l]=w,++m._eventsCount;else if(typeof u=="function"?u=b[l]=_?[w,u]:[u,w]:_?u.unshift(w):u.push(w),h=t(m),h>0&&u.length>h&&!u.warned){u.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(l)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=m,L.type=l,L.count=u.length,M(L)}return m}a.prototype.addListener=function(l,w){return c(this,l,w,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(l,w){return c(this,l,w,!0)};function s(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function i(m,l,w){var _={fired:!1,wrapFn:void 0,target:m,type:l,listener:w},h=s.bind(_);return h.listener=w,_.wrapFn=h,h}a.prototype.once=function(l,w){return r(w),this.on(l,i(this,l,w)),this},a.prototype.prependOnceListener=function(l,w){return r(w),this.prependListener(l,i(this,l,w)),this},a.prototype.removeListener=function(l,w){var _,h,b,u,L;if(r(w),h=this._events,h===void 0)return this;if(_=h[l],_===void 0)return this;if(_===w||_.listener===w)--this._eventsCount===0?this._events=Object.create(null):(delete h[l],h.removeListener&&this.emit("removeListener",l,_.listener||w));else if(typeof _!="function"){for(b=-1,u=_.length-1;u>=0;u--)if(_[u]===w||_[u].listener===w){L=_[u].listener,b=u;break}if(b<0)return this;b===0?_.shift():f(_,b),_.length===1&&(h[l]=_[0]),h.removeListener!==void 0&&this.emit("removeListener",l,L||w)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(l){var w,_,h;if(_=this._events,_===void 0)return this;if(_.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):_[l]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete _[l]),this;if(arguments.length===0){var b=Object.keys(_),u;for(h=0;h<b.length;++h)u=b[h],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(w=_[l],typeof w=="function")this.removeListener(l,w);else if(w!==void 0)for(h=w.length-1;h>=0;h--)this.removeListener(l,w[h]);return this};function x(m,l,w){var _=m._events;if(_===void 0)return[];var h=_[l];return h===void 0?[]:typeof h=="function"?w?[h.listener||h]:[h]:w?y(h):v(h,h.length)}a.prototype.listeners=function(l){return x(this,l,!0)},a.prototype.rawListeners=function(l){return x(this,l,!1)},a.listenerCount=function(m,l){return typeof m.listenerCount=="function"?m.listenerCount(l):p.call(m,l)},a.prototype.listenerCount=p;function p(m){var l=this._events;if(l!==void 0){var w=l[m];if(typeof w=="function")return 1;if(w!==void 0)return w.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?S(this._events):[]};function v(m,l){for(var w=new Array(l),_=0;_<l;++_)w[_]=m[_];return w}function f(m,l){for(;l+1<m.length;l++)m[l]=m[l+1];m.pop()}function y(m){for(var l=new Array(m.length),w=0;w<l.length;++w)l[w]=m[w].listener||m[w];return l}function o(m,l){return new Promise(function(w,_){function h(){b!==void 0&&m.removeListener("error",b),w([].slice.call(arguments))}var b;l!=="error"&&(b=function(L){m.removeListener(l,h),_(L)},m.once("error",b)),m.once(l,h)})}},{}],85:[function(d,ee,te){(function(A){(function(){var g=d("base64-js"),S=d("ieee754");te.Buffer=n,te.SlowBuffer=y,te.INSPECT_MAX_BYTES=50;var M=2147483647;te.kMaxLength=M,n.TYPED_ARRAY_SUPPORT=e(),!n.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function e(){try{var se=new Uint8Array(1);return se.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},se.foo()===42}catch{return!1}}Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(!!n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(!!n.isBuffer(this))return this.byteOffset}});function a(se){if(se>M)throw new RangeError('The value "'+se+'" is invalid for option "size"');var ae=new Uint8Array(se);return ae.__proto__=n.prototype,ae}function n(se,ae,oe){if(typeof se=="number"){if(typeof ae=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return s(se)}return r(se,ae,oe)}typeof Symbol<"u"&&Symbol.species!=null&&n[Symbol.species]===n&&Object.defineProperty(n,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),n.poolSize=8192;function r(se,ae,oe){if(typeof se=="string")return i(se,ae);if(ArrayBuffer.isView(se))return x(se);if(se==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof se);if(Q(se,ArrayBuffer)||se&&Q(se.buffer,ArrayBuffer))return p(se,ae,oe);if(typeof se=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var be=se.valueOf&&se.valueOf();if(be!=null&&be!==se)return n.from(be,ae,oe);var ce=v(se);if(ce)return ce;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof se[Symbol.toPrimitive]=="function")return n.from(se[Symbol.toPrimitive]("string"),ae,oe);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof se)}n.from=function(se,ae,oe){return r(se,ae,oe)},n.prototype.__proto__=Uint8Array.prototype,n.__proto__=Uint8Array;function t(se){if(typeof se!="number")throw new TypeError('"size" argument must be of type number');if(se<0)throw new RangeError('The value "'+se+'" is invalid for option "size"')}function c(se,ae,oe){return t(se),se<=0?a(se):ae!==void 0?typeof oe=="string"?a(se).fill(ae,oe):a(se).fill(ae):a(se)}n.alloc=function(se,ae,oe){return c(se,ae,oe)};function s(se){return t(se),a(se<0?0:f(se)|0)}n.allocUnsafe=function(se){return s(se)},n.allocUnsafeSlow=function(se){return s(se)};function i(se,ae){if((typeof ae!="string"||ae==="")&&(ae="utf8"),!n.isEncoding(ae))throw new TypeError("Unknown encoding: "+ae);var oe=o(se,ae)|0,be=a(oe),ce=be.write(se,ae);return ce!==oe&&(be=be.slice(0,ce)),be}function x(se){for(var ae=se.length<0?0:f(se.length)|0,oe=a(ae),be=0;be<ae;be+=1)oe[be]=se[be]&255;return oe}function p(se,ae,oe){if(ae<0||se.byteLength<ae)throw new RangeError('"offset" is outside of buffer bounds');if(se.byteLength<ae+(oe||0))throw new RangeError('"length" is outside of buffer bounds');var be;return ae===void 0&&oe===void 0?be=new Uint8Array(se):oe===void 0?be=new Uint8Array(se,ae):be=new Uint8Array(se,ae,oe),be.__proto__=n.prototype,be}function v(se){if(n.isBuffer(se)){var ae=f(se.length)|0,oe=a(ae);return oe.length===0||se.copy(oe,0,0,ae),oe}if(se.length!==void 0)return typeof se.length!="number"||ie(se.length)?a(0):x(se);if(se.type==="Buffer"&&Array.isArray(se.data))return x(se.data)}function f(se){if(se>=M)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+M.toString(16)+" bytes");return se|0}function y(se){return+se!=se&&(se=0),n.alloc(+se)}n.isBuffer=function(ae){return ae!=null&&ae._isBuffer===!0&&ae!==n.prototype},n.compare=function(ae,oe){if(Q(ae,Uint8Array)&&(ae=n.from(ae,ae.offset,ae.byteLength)),Q(oe,Uint8Array)&&(oe=n.from(oe,oe.offset,oe.byteLength)),!n.isBuffer(ae)||!n.isBuffer(oe))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ae===oe)return 0;for(var be=ae.length,ce=oe.length,de=0,ye=Math.min(be,ce);de<ye;++de)if(ae[de]!==oe[de]){be=ae[de],ce=oe[de];break}return be<ce?-1:ce<be?1:0},n.isEncoding=function(ae){switch(String(ae).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(ae,oe){if(!Array.isArray(ae))throw new TypeError('"list" argument must be an Array of Buffers');if(ae.length===0)return n.alloc(0);var be;if(oe===void 0)for(oe=0,be=0;be<ae.length;++be)oe+=ae[be].length;var ce=n.allocUnsafe(oe),de=0;for(be=0;be<ae.length;++be){var ye=ae[be];if(Q(ye,Uint8Array)&&(ye=n.from(ye)),!n.isBuffer(ye))throw new TypeError('"list" argument must be an Array of Buffers');ye.copy(ce,de),de+=ye.length}return ce};function o(se,ae){if(n.isBuffer(se))return se.length;if(ArrayBuffer.isView(se)||Q(se,ArrayBuffer))return se.byteLength;if(typeof se!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof se);var oe=se.length,be=arguments.length>2&&arguments[2]===!0;if(!be&&oe===0)return 0;for(var ce=!1;;)switch(ae){case"ascii":case"latin1":case"binary":return oe;case"utf8":case"utf-8":return V(se).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe*2;case"hex":return oe>>>1;case"base64":return ne(se).length;default:if(ce)return be?-1:V(se).length;ae=(""+ae).toLowerCase(),ce=!0}}n.byteLength=o;function m(se,ae,oe){var be=!1;if((ae===void 0||ae<0)&&(ae=0),ae>this.length||((oe===void 0||oe>this.length)&&(oe=this.length),oe<=0)||(oe>>>=0,ae>>>=0,oe<=ae))return"";for(se||(se="utf8");;)switch(se){case"hex":return F(this,ae,oe);case"utf8":case"utf-8":return z(this,ae,oe);case"ascii":return R(this,ae,oe);case"latin1":case"binary":return O(this,ae,oe);case"base64":return P(this,ae,oe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,ae,oe);default:if(be)throw new TypeError("Unknown encoding: "+se);se=(se+"").toLowerCase(),be=!0}}n.prototype._isBuffer=!0;function l(se,ae,oe){var be=se[ae];se[ae]=se[oe],se[oe]=be}n.prototype.swap16=function(){var ae=this.length;if(ae%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var oe=0;oe<ae;oe+=2)l(this,oe,oe+1);return this},n.prototype.swap32=function(){var ae=this.length;if(ae%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var oe=0;oe<ae;oe+=4)l(this,oe,oe+3),l(this,oe+1,oe+2);return this},n.prototype.swap64=function(){var ae=this.length;if(ae%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var oe=0;oe<ae;oe+=8)l(this,oe,oe+7),l(this,oe+1,oe+6),l(this,oe+2,oe+5),l(this,oe+3,oe+4);return this},n.prototype.toString=function(){var ae=this.length;return ae===0?"":arguments.length===0?z(this,0,ae):m.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(ae){if(!n.isBuffer(ae))throw new TypeError("Argument must be a Buffer");return this===ae?!0:n.compare(this,ae)===0},n.prototype.inspect=function(){var ae="",oe=te.INSPECT_MAX_BYTES;return ae=this.toString("hex",0,oe).replace(/(.{2})/g,"$1 ").trim(),this.length>oe&&(ae+=" ... "),"<Buffer "+ae+">"},n.prototype.compare=function(ae,oe,be,ce,de){if(Q(ae,Uint8Array)&&(ae=n.from(ae,ae.offset,ae.byteLength)),!n.isBuffer(ae))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ae);if(oe===void 0&&(oe=0),be===void 0&&(be=ae?ae.length:0),ce===void 0&&(ce=0),de===void 0&&(de=this.length),oe<0||be>ae.length||ce<0||de>this.length)throw new RangeError("out of range index");if(ce>=de&&oe>=be)return 0;if(ce>=de)return-1;if(oe>=be)return 1;if(oe>>>=0,be>>>=0,ce>>>=0,de>>>=0,this===ae)return 0;for(var ye=de-ce,ge=be-oe,me=Math.min(ye,ge),Ee=this.slice(ce,de),Pe=ae.slice(oe,be),Ne=0;Ne<me;++Ne)if(Ee[Ne]!==Pe[Ne]){ye=Ee[Ne],ge=Pe[Ne];break}return ye<ge?-1:ge<ye?1:0};function w(se,ae,oe,be,ce){if(se.length===0)return-1;if(typeof oe=="string"?(be=oe,oe=0):oe>2147483647?oe=2147483647:oe<-2147483648&&(oe=-2147483648),oe=+oe,ie(oe)&&(oe=ce?0:se.length-1),oe<0&&(oe=se.length+oe),oe>=se.length){if(ce)return-1;oe=se.length-1}else if(oe<0)if(ce)oe=0;else return-1;if(typeof ae=="string"&&(ae=n.from(ae,be)),n.isBuffer(ae))return ae.length===0?-1:_(se,ae,oe,be,ce);if(typeof ae=="number")return ae=ae&255,typeof Uint8Array.prototype.indexOf=="function"?ce?Uint8Array.prototype.indexOf.call(se,ae,oe):Uint8Array.prototype.lastIndexOf.call(se,ae,oe):_(se,[ae],oe,be,ce);throw new TypeError("val must be string, number or Buffer")}function _(se,ae,oe,be,ce){var de=1,ye=se.length,ge=ae.length;if(be!==void 0&&(be=String(be).toLowerCase(),be==="ucs2"||be==="ucs-2"||be==="utf16le"||be==="utf-16le")){if(se.length<2||ae.length<2)return-1;de=2,ye/=2,ge/=2,oe/=2}function me(ke,Xe){return de===1?ke[Xe]:ke.readUInt16BE(Xe*de)}var Ee;if(ce){var Pe=-1;for(Ee=oe;Ee<ye;Ee++)if(me(se,Ee)===me(ae,Pe===-1?0:Ee-Pe)){if(Pe===-1&&(Pe=Ee),Ee-Pe+1===ge)return Pe*de}else Pe!==-1&&(Ee-=Ee-Pe),Pe=-1}else for(oe+ge>ye&&(oe=ye-ge),Ee=oe;Ee>=0;Ee--){for(var Ne=!0,we=0;we<ge;we++)if(me(se,Ee+we)!==me(ae,we)){Ne=!1;break}if(Ne)return Ee}return-1}n.prototype.includes=function(ae,oe,be){return this.indexOf(ae,oe,be)!==-1},n.prototype.indexOf=function(ae,oe,be){return w(this,ae,oe,be,!0)},n.prototype.lastIndexOf=function(ae,oe,be){return w(this,ae,oe,be,!1)};function h(se,ae,oe,be){oe=Number(oe)||0;var ce=se.length-oe;be?(be=Number(be),be>ce&&(be=ce)):be=ce;var de=ae.length;be>de/2&&(be=de/2);for(var ye=0;ye<be;++ye){var ge=parseInt(ae.substr(ye*2,2),16);if(ie(ge))return ye;se[oe+ye]=ge}return ye}function b(se,ae,oe,be){return X(V(ae,se.length-oe),se,oe,be)}function u(se,ae,oe,be){return X(U(ae),se,oe,be)}function L(se,ae,oe,be){return u(se,ae,oe,be)}function T(se,ae,oe,be){return X(ne(ae),se,oe,be)}function k(se,ae,oe,be){return X($(ae,se.length-oe),se,oe,be)}n.prototype.write=function(ae,oe,be,ce){if(oe===void 0)ce="utf8",be=this.length,oe=0;else if(be===void 0&&typeof oe=="string")ce=oe,be=this.length,oe=0;else if(isFinite(oe))oe=oe>>>0,isFinite(be)?(be=be>>>0,ce===void 0&&(ce="utf8")):(ce=be,be=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var de=this.length-oe;if((be===void 0||be>de)&&(be=de),ae.length>0&&(be<0||oe<0)||oe>this.length)throw new RangeError("Attempt to write outside buffer bounds");ce||(ce="utf8");for(var ye=!1;;)switch(ce){case"hex":return h(this,ae,oe,be);case"utf8":case"utf-8":return b(this,ae,oe,be);case"ascii":return u(this,ae,oe,be);case"latin1":case"binary":return L(this,ae,oe,be);case"base64":return T(this,ae,oe,be);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,ae,oe,be);default:if(ye)throw new TypeError("Unknown encoding: "+ce);ce=(""+ce).toLowerCase(),ye=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(se,ae,oe){return ae===0&&oe===se.length?g.fromByteArray(se):g.fromByteArray(se.slice(ae,oe))}function z(se,ae,oe){oe=Math.min(se.length,oe);for(var be=[],ce=ae;ce<oe;){var de=se[ce],ye=null,ge=de>239?4:de>223?3:de>191?2:1;if(ce+ge<=oe){var me,Ee,Pe,Ne;switch(ge){case 1:de<128&&(ye=de);break;case 2:me=se[ce+1],(me&192)===128&&(Ne=(de&31)<<6|me&63,Ne>127&&(ye=Ne));break;case 3:me=se[ce+1],Ee=se[ce+2],(me&192)===128&&(Ee&192)===128&&(Ne=(de&15)<<12|(me&63)<<6|Ee&63,Ne>2047&&(Ne<55296||Ne>57343)&&(ye=Ne));break;case 4:me=se[ce+1],Ee=se[ce+2],Pe=se[ce+3],(me&192)===128&&(Ee&192)===128&&(Pe&192)===128&&(Ne=(de&15)<<18|(me&63)<<12|(Ee&63)<<6|Pe&63,Ne>65535&&Ne<1114112&&(ye=Ne))}}ye===null?(ye=65533,ge=1):ye>65535&&(ye-=65536,be.push(ye>>>10&1023|55296),ye=56320|ye&1023),be.push(ye),ce+=ge}return D(be)}var I=4096;function D(se){var ae=se.length;if(ae<=I)return String.fromCharCode.apply(String,se);for(var oe="",be=0;be<ae;)oe+=String.fromCharCode.apply(String,se.slice(be,be+=I));return oe}function R(se,ae,oe){var be="";oe=Math.min(se.length,oe);for(var ce=ae;ce<oe;++ce)be+=String.fromCharCode(se[ce]&127);return be}function O(se,ae,oe){var be="";oe=Math.min(se.length,oe);for(var ce=ae;ce<oe;++ce)be+=String.fromCharCode(se[ce]);return be}function F(se,ae,oe){var be=se.length;(!ae||ae<0)&&(ae=0),(!oe||oe<0||oe>be)&&(oe=be);for(var ce="",de=ae;de<oe;++de)ce+=q(se[de]);return ce}function N(se,ae,oe){for(var be=se.slice(ae,oe),ce="",de=0;de<be.length;de+=2)ce+=String.fromCharCode(be[de]+be[de+1]*256);return ce}n.prototype.slice=function(ae,oe){var be=this.length;ae=~~ae,oe=oe===void 0?be:~~oe,ae<0?(ae+=be,ae<0&&(ae=0)):ae>be&&(ae=be),oe<0?(oe+=be,oe<0&&(oe=0)):oe>be&&(oe=be),oe<ae&&(oe=ae);var ce=this.subarray(ae,oe);return ce.__proto__=n.prototype,ce};function G(se,ae,oe){if(se%1!==0||se<0)throw new RangeError("offset is not uint");if(se+ae>oe)throw new RangeError("Trying to access beyond buffer length")}n.prototype.readUIntLE=function(ae,oe,be){ae=ae>>>0,oe=oe>>>0,be||G(ae,oe,this.length);for(var ce=this[ae],de=1,ye=0;++ye<oe&&(de*=256);)ce+=this[ae+ye]*de;return ce},n.prototype.readUIntBE=function(ae,oe,be){ae=ae>>>0,oe=oe>>>0,be||G(ae,oe,this.length);for(var ce=this[ae+--oe],de=1;oe>0&&(de*=256);)ce+=this[ae+--oe]*de;return ce},n.prototype.readUInt8=function(ae,oe){return ae=ae>>>0,oe||G(ae,1,this.length),this[ae]},n.prototype.readUInt16LE=function(ae,oe){return ae=ae>>>0,oe||G(ae,2,this.length),this[ae]|this[ae+1]<<8},n.prototype.readUInt16BE=function(ae,oe){return ae=ae>>>0,oe||G(ae,2,this.length),this[ae]<<8|this[ae+1]},n.prototype.readUInt32LE=function(ae,oe){return ae=ae>>>0,oe||G(ae,4,this.length),(this[ae]|this[ae+1]<<8|this[ae+2]<<16)+this[ae+3]*16777216},n.prototype.readUInt32BE=function(ae,oe){return ae=ae>>>0,oe||G(ae,4,this.length),this[ae]*16777216+(this[ae+1]<<16|this[ae+2]<<8|this[ae+3])},n.prototype.readIntLE=function(ae,oe,be){ae=ae>>>0,oe=oe>>>0,be||G(ae,oe,this.length);for(var ce=this[ae],de=1,ye=0;++ye<oe&&(de*=256);)ce+=this[ae+ye]*de;return de*=128,ce>=de&&(ce-=Math.pow(2,8*oe)),ce},n.prototype.readIntBE=function(ae,oe,be){ae=ae>>>0,oe=oe>>>0,be||G(ae,oe,this.length);for(var ce=oe,de=1,ye=this[ae+--ce];ce>0&&(de*=256);)ye+=this[ae+--ce]*de;return de*=128,ye>=de&&(ye-=Math.pow(2,8*oe)),ye},n.prototype.readInt8=function(ae,oe){return ae=ae>>>0,oe||G(ae,1,this.length),this[ae]&128?(255-this[ae]+1)*-1:this[ae]},n.prototype.readInt16LE=function(ae,oe){ae=ae>>>0,oe||G(ae,2,this.length);var be=this[ae]|this[ae+1]<<8;return be&32768?be|4294901760:be},n.prototype.readInt16BE=function(ae,oe){ae=ae>>>0,oe||G(ae,2,this.length);var be=this[ae+1]|this[ae]<<8;return be&32768?be|4294901760:be},n.prototype.readInt32LE=function(ae,oe){return ae=ae>>>0,oe||G(ae,4,this.length),this[ae]|this[ae+1]<<8|this[ae+2]<<16|this[ae+3]<<24},n.prototype.readInt32BE=function(ae,oe){return ae=ae>>>0,oe||G(ae,4,this.length),this[ae]<<24|this[ae+1]<<16|this[ae+2]<<8|this[ae+3]},n.prototype.readFloatLE=function(ae,oe){return ae=ae>>>0,oe||G(ae,4,this.length),S.read(this,ae,!0,23,4)},n.prototype.readFloatBE=function(ae,oe){return ae=ae>>>0,oe||G(ae,4,this.length),S.read(this,ae,!1,23,4)},n.prototype.readDoubleLE=function(ae,oe){return ae=ae>>>0,oe||G(ae,8,this.length),S.read(this,ae,!0,52,8)},n.prototype.readDoubleBE=function(ae,oe){return ae=ae>>>0,oe||G(ae,8,this.length),S.read(this,ae,!1,52,8)};function K(se,ae,oe,be,ce,de){if(!n.isBuffer(se))throw new TypeError('"buffer" argument must be a Buffer instance');if(ae>ce||ae<de)throw new RangeError('"value" argument is out of bounds');if(oe+be>se.length)throw new RangeError("Index out of range")}n.prototype.writeUIntLE=function(ae,oe,be,ce){if(ae=+ae,oe=oe>>>0,be=be>>>0,!ce){var de=Math.pow(2,8*be)-1;K(this,ae,oe,be,de,0)}var ye=1,ge=0;for(this[oe]=ae&255;++ge<be&&(ye*=256);)this[oe+ge]=ae/ye&255;return oe+be},n.prototype.writeUIntBE=function(ae,oe,be,ce){if(ae=+ae,oe=oe>>>0,be=be>>>0,!ce){var de=Math.pow(2,8*be)-1;K(this,ae,oe,be,de,0)}var ye=be-1,ge=1;for(this[oe+ye]=ae&255;--ye>=0&&(ge*=256);)this[oe+ye]=ae/ge&255;return oe+be},n.prototype.writeUInt8=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,1,255,0),this[oe]=ae&255,oe+1},n.prototype.writeUInt16LE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,2,65535,0),this[oe]=ae&255,this[oe+1]=ae>>>8,oe+2},n.prototype.writeUInt16BE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,2,65535,0),this[oe]=ae>>>8,this[oe+1]=ae&255,oe+2},n.prototype.writeUInt32LE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,4,4294967295,0),this[oe+3]=ae>>>24,this[oe+2]=ae>>>16,this[oe+1]=ae>>>8,this[oe]=ae&255,oe+4},n.prototype.writeUInt32BE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,4,4294967295,0),this[oe]=ae>>>24,this[oe+1]=ae>>>16,this[oe+2]=ae>>>8,this[oe+3]=ae&255,oe+4},n.prototype.writeIntLE=function(ae,oe,be,ce){if(ae=+ae,oe=oe>>>0,!ce){var de=Math.pow(2,8*be-1);K(this,ae,oe,be,de-1,-de)}var ye=0,ge=1,me=0;for(this[oe]=ae&255;++ye<be&&(ge*=256);)ae<0&&me===0&&this[oe+ye-1]!==0&&(me=1),this[oe+ye]=(ae/ge>>0)-me&255;return oe+be},n.prototype.writeIntBE=function(ae,oe,be,ce){if(ae=+ae,oe=oe>>>0,!ce){var de=Math.pow(2,8*be-1);K(this,ae,oe,be,de-1,-de)}var ye=be-1,ge=1,me=0;for(this[oe+ye]=ae&255;--ye>=0&&(ge*=256);)ae<0&&me===0&&this[oe+ye+1]!==0&&(me=1),this[oe+ye]=(ae/ge>>0)-me&255;return oe+be},n.prototype.writeInt8=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,1,127,-128),ae<0&&(ae=255+ae+1),this[oe]=ae&255,oe+1},n.prototype.writeInt16LE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,2,32767,-32768),this[oe]=ae&255,this[oe+1]=ae>>>8,oe+2},n.prototype.writeInt16BE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,2,32767,-32768),this[oe]=ae>>>8,this[oe+1]=ae&255,oe+2},n.prototype.writeInt32LE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,4,2147483647,-2147483648),this[oe]=ae&255,this[oe+1]=ae>>>8,this[oe+2]=ae>>>16,this[oe+3]=ae>>>24,oe+4},n.prototype.writeInt32BE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,4,2147483647,-2147483648),ae<0&&(ae=4294967295+ae+1),this[oe]=ae>>>24,this[oe+1]=ae>>>16,this[oe+2]=ae>>>8,this[oe+3]=ae&255,oe+4};function W(se,ae,oe,be,ce,de){if(oe+be>se.length)throw new RangeError("Index out of range");if(oe<0)throw new RangeError("Index out of range")}function Y(se,ae,oe,be,ce){return ae=+ae,oe=oe>>>0,ce||W(se,ae,oe,4),S.write(se,ae,oe,be,23,4),oe+4}n.prototype.writeFloatLE=function(ae,oe,be){return Y(this,ae,oe,!0,be)},n.prototype.writeFloatBE=function(ae,oe,be){return Y(this,ae,oe,!1,be)};function re(se,ae,oe,be,ce){return ae=+ae,oe=oe>>>0,ce||W(se,ae,oe,8),S.write(se,ae,oe,be,52,8),oe+8}n.prototype.writeDoubleLE=function(ae,oe,be){return re(this,ae,oe,!0,be)},n.prototype.writeDoubleBE=function(ae,oe,be){return re(this,ae,oe,!1,be)},n.prototype.copy=function(ae,oe,be,ce){if(!n.isBuffer(ae))throw new TypeError("argument should be a Buffer");if(be||(be=0),!ce&&ce!==0&&(ce=this.length),oe>=ae.length&&(oe=ae.length),oe||(oe=0),ce>0&&ce<be&&(ce=be),ce===be||ae.length===0||this.length===0)return 0;if(oe<0)throw new RangeError("targetStart out of bounds");if(be<0||be>=this.length)throw new RangeError("Index out of range");if(ce<0)throw new RangeError("sourceEnd out of bounds");ce>this.length&&(ce=this.length),ae.length-oe<ce-be&&(ce=ae.length-oe+be);var de=ce-be;if(this===ae&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(oe,be,ce);else if(this===ae&&be<oe&&oe<ce)for(var ye=de-1;ye>=0;--ye)ae[ye+oe]=this[ye+be];else Uint8Array.prototype.set.call(ae,this.subarray(be,ce),oe);return de},n.prototype.fill=function(ae,oe,be,ce){if(typeof ae=="string"){if(typeof oe=="string"?(ce=oe,oe=0,be=this.length):typeof be=="string"&&(ce=be,be=this.length),ce!==void 0&&typeof ce!="string")throw new TypeError("encoding must be a string");if(typeof ce=="string"&&!n.isEncoding(ce))throw new TypeError("Unknown encoding: "+ce);if(ae.length===1){var de=ae.charCodeAt(0);(ce==="utf8"&&de<128||ce==="latin1")&&(ae=de)}}else typeof ae=="number"&&(ae=ae&255);if(oe<0||this.length<oe||this.length<be)throw new RangeError("Out of range index");if(be<=oe)return this;oe=oe>>>0,be=be===void 0?this.length:be>>>0,ae||(ae=0);var ye;if(typeof ae=="number")for(ye=oe;ye<be;++ye)this[ye]=ae;else{var ge=n.isBuffer(ae)?ae:n.from(ae,ce),me=ge.length;if(me===0)throw new TypeError('The value "'+ae+'" is invalid for argument "value"');for(ye=0;ye<be-oe;++ye)this[ye+oe]=ge[ye%me]}return this};var ue=/[^+/0-9A-Za-z-_]/g;function j(se){if(se=se.split("=")[0],se=se.trim().replace(ue,""),se.length<2)return"";for(;se.length%4!==0;)se=se+"=";return se}function q(se){return se<16?"0"+se.toString(16):se.toString(16)}function V(se,ae){ae=ae||1/0;for(var oe,be=se.length,ce=null,de=[],ye=0;ye<be;++ye){if(oe=se.charCodeAt(ye),oe>55295&&oe<57344){if(!ce){if(oe>56319){(ae-=3)>-1&&de.push(239,191,189);continue}else if(ye+1===be){(ae-=3)>-1&&de.push(239,191,189);continue}ce=oe;continue}if(oe<56320){(ae-=3)>-1&&de.push(239,191,189),ce=oe;continue}oe=(ce-55296<<10|oe-56320)+65536}else ce&&(ae-=3)>-1&&de.push(239,191,189);if(ce=null,oe<128){if((ae-=1)<0)break;de.push(oe)}else if(oe<2048){if((ae-=2)<0)break;de.push(oe>>6|192,oe&63|128)}else if(oe<65536){if((ae-=3)<0)break;de.push(oe>>12|224,oe>>6&63|128,oe&63|128)}else if(oe<1114112){if((ae-=4)<0)break;de.push(oe>>18|240,oe>>12&63|128,oe>>6&63|128,oe&63|128)}else throw new Error("Invalid code point")}return de}function U(se){for(var ae=[],oe=0;oe<se.length;++oe)ae.push(se.charCodeAt(oe)&255);return ae}function $(se,ae){for(var oe,be,ce,de=[],ye=0;ye<se.length&&!((ae-=2)<0);++ye)oe=se.charCodeAt(ye),be=oe>>8,ce=oe%256,de.push(ce),de.push(be);return de}function ne(se){return g.toByteArray(j(se))}function X(se,ae,oe,be){for(var ce=0;ce<be&&!(ce+oe>=ae.length||ce>=se.length);++ce)ae[ce+oe]=se[ce];return ce}function Q(se,ae){return se instanceof ae||se!=null&&se.constructor!=null&&se.constructor.name!=null&&se.constructor.name===ae.name}function ie(se){return se!==se}}).call(this)}).call(this,d("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(d,ee,te){ee.exports=A;function A(g,S,M){return S<M?g<S?S:g>M?M:g:g<M?M:g>S?S:g}},{}],87:[function(d,ee,te){var A=d("clamp");ee.exports=g,ee.exports.to=g,ee.exports.from=S;function g(M,e){e==null&&(e=!0);var a=M[0],n=M[1],r=M[2],t=M[3];t==null&&(t=e?1:255),e&&(a*=255,n*=255,r*=255,t*=255),a=A(a,0,255)&255,n=A(n,0,255)&255,r=A(r,0,255)&255,t=A(t,0,255)&255;var c=a*16777216+(n<<16)+(r<<8)+t;return c}function S(M,e){M=+M;var a=M>>>24,n=(M&16711680)>>>16,r=(M&65280)>>>8,t=M&255;return e===!1?[a,n,r,t]:[a/255,n/255,r/255,t/255]}},{clamp:86}],88:[function(d,ee,te){ee.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(d,ee,te){var A=d("color-rgba"),g=d("clamp"),S=d("dtype");ee.exports=function(a,n){(n==="float"||!n)&&(n="array"),n==="uint"&&(n="uint8"),n==="uint_clamped"&&(n="uint8_clamped");var r=S(n),t=new r(4),c=n!=="uint8"&&n!=="uint8_clamped";return(!a.length||typeof a=="string")&&(a=A(a),a[0]/=255,a[1]/=255,a[2]/=255),M(a)?(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3]!=null?a[3]:255,c&&(t[0]/=255,t[1]/=255,t[2]/=255,t[3]/=255),t):(c?(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3]!=null?a[3]:1):(t[0]=g(Math.floor(a[0]*255),0,255),t[1]=g(Math.floor(a[1]*255),0,255),t[2]=g(Math.floor(a[2]*255),0,255),t[3]=a[3]==null?255:g(Math.floor(a[3]*255),0,255)),t)};function M(e){return!!(e instanceof Uint8Array||e instanceof Uint8ClampedArray||Array.isArray(e)&&(e[0]>1||e[0]===0)&&(e[1]>1||e[1]===0)&&(e[2]>1||e[2]===0)&&(!e[3]||e[3]>1))}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(d,ee,te){(function(A){(function(){var g=d("color-name"),S=d("is-plain-obj"),M=d("defined");ee.exports=a;var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function a(n){var r,t=[],c=1,s;if(typeof n=="string")if(g[n])t=g[n].slice(),s="rgb";else if(n==="transparent")c=0,s="rgb",t=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(n)){var i=n.slice(1),x=i.length,p=x<=4;c=1,p?(t=[parseInt(i[0]+i[0],16),parseInt(i[1]+i[1],16),parseInt(i[2]+i[2],16)],x===4&&(c=parseInt(i[3]+i[3],16)/255)):(t=[parseInt(i[0]+i[1],16),parseInt(i[2]+i[3],16),parseInt(i[4]+i[5],16)],x===8&&(c=parseInt(i[6]+i[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),s="rgb"}else if(r=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(n)){var v=r[1],f=v==="rgb",i=v.replace(/a$/,"");s=i;var x=i==="cmyk"?4:i==="gray"?1:3;t=r[2].trim().split(/\s*,\s*/).map(function(l,w){if(/%$/.test(l))return w===x?parseFloat(l)/100:i==="rgb"?parseFloat(l)*255/100:parseFloat(l);if(i[w]==="h"){if(/deg$/.test(l))return parseFloat(l);if(e[l]!==void 0)return e[l]}return parseFloat(l)}),v===i&&t.push(1),c=f||t[x]===void 0?1:t[x],t=t.slice(0,x)}else n.length>10&&/[0-9](?:\s|\/)/.test(n)&&(t=n.match(/([0-9]+)/g).map(function(o){return parseFloat(o)}),s=n.match(/([a-z])/ig).join("").toLowerCase());else if(!isNaN(n))s="rgb",t=[n>>>16,(n&65280)>>>8,n&255];else if(S(n)){var y=M(n.r,n.red,n.R,null);y!==null?(s="rgb",t=[y,M(n.g,n.green,n.G),M(n.b,n.blue,n.B)]):(s="hsl",t=[M(n.h,n.hue,n.H),M(n.s,n.saturation,n.S),M(n.l,n.lightness,n.L,n.b,n.brightness)]),c=M(n.a,n.alpha,n.opacity,1),n.opacity!=null&&(c/=100)}else(Array.isArray(n)||A.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(n))&&(t=[n[0],n[1],n[2]],s="rgb",c=n.length===4?n[3]:1);return{space:s,values:t,alpha:c}}}).call(this)}).call(this,typeof Mo<"u"?Mo:typeof self<"u"?self:typeof window<"u"?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(d,ee,te){var A=d("color-parse"),g=d("color-space/hsl"),S=d("clamp");ee.exports=function(e){var a,n=A(e);return n.space?(a=Array(3),a[0]=S(n.values[0],0,255),a[1]=S(n.values[1],0,255),a[2]=S(n.values[2],0,255),n.space[0]==="h"&&(a=g.rgb(a)),a.push(S(n.alpha,0,1)),a):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(d,ee,te){var A=d("./rgb");ee.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(g){var S=g[0]/360,M=g[1]/100,e=g[2]/100,a,n,r,t,c;if(M===0)return c=e*255,[c,c,c];e<.5?n=e*(1+M):n=e+M-e*M,a=2*e-n,t=[0,0,0];for(var s=0;s<3;s++)r=S+1/3*-(s-1),r<0?r++:r>1&&r--,6*r<1?c=a+(n-a)*6*r:2*r<1?c=n:3*r<2?c=a+(n-a)*(2/3-r)*6:c=a,t[s]=c*255;return t}},A.hsl=function(g){var S=g[0]/255,M=g[1]/255,e=g[2]/255,a=Math.min(S,M,e),n=Math.max(S,M,e),r=n-a,t,c,s;return n===a?t=0:S===n?t=(M-e)/r:M===n?t=2+(e-S)/r:e===n&&(t=4+(S-M)/r),t=Math.min(t*60,360),t<0&&(t+=360),s=(a+n)/2,n===a?c=0:s<=.5?c=r/(n+a):c=r/(2-n-a),[t,c*100,s*100]}},{"./rgb":93}],93:[function(d,ee,te){ee.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(d,ee,te){ee.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(d,ee,te){ee.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(d,ee,te){ee.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(d,ee,te){ee.exports=["normal","italic","oblique"]},{}],98:[function(d,ee,te){ee.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(d,ee,te){ee.exports={parse:d("./parse"),stringify:d("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(d,ee,te){var A=d("css-font-size-keywords");ee.exports={isSize:function(S){return/^[\d\.]/.test(S)||S.indexOf("/")!==-1||A.indexOf(S)!==-1}}},{"css-font-size-keywords":95}],101:[function(d,ee,te){var A=d("unquote"),g=d("css-global-keywords"),S=d("css-system-font-keywords"),M=d("css-font-weight-keywords"),e=d("css-font-style-keywords"),a=d("css-font-stretch-keywords"),n=d("string-split-by"),r=d("./lib/util").isSize;ee.exports=c;var t=c.cache={};function c(i){if(typeof i!="string")throw new Error("Font argument must be a string.");if(t[i])return t[i];if(i==="")throw new Error("Cannot parse an empty string.");if(S.indexOf(i)!==-1)return t[i]={system:i};for(var x={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},p=n(i,/\s+/),v;v=p.shift();){if(g.indexOf(v)!==-1)return["style","variant","weight","stretch"].forEach(function(y){x[y]=v}),t[i]=x;if(e.indexOf(v)!==-1){x.style=v;continue}if(v==="normal"||v==="small-caps"){x.variant=v;continue}if(a.indexOf(v)!==-1){x.stretch=v;continue}if(M.indexOf(v)!==-1){x.weight=v;continue}if(r(v)){var f=n(v,"/");if(x.size=f[0],f[1]!=null?x.lineHeight=s(f[1]):p[0]==="/"&&(p.shift(),x.lineHeight=s(p.shift())),!p.length)throw new Error("Missing required font-family.");return x.family=n(p.join(" "),/\s*,\s*/).map(A),t[i]=x}throw new Error("Unknown or unsupported font token: "+v)}throw new Error("Missing required font-size.")}function s(i){var x=parseFloat(i);return x.toString()===i?x:i}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":306,unquote:329}],102:[function(d,ee,te){var A=d("pick-by-alias"),g=d("./lib/util").isSize,S=i(d("css-global-keywords")),M=i(d("css-system-font-keywords")),e=i(d("css-font-weight-keywords")),a=i(d("css-font-style-keywords")),n=i(d("css-font-stretch-keywords")),r={normal:1,"small-caps":1},t={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},c={style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"1rem",lineHeight:"normal",family:"serif"};ee.exports=function(p){if(p=A(p,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"}),p.system)return p.system&&s(p.system,M),p.system;if(s(p.style,a),s(p.variant,r),s(p.weight,e),s(p.stretch,n),p.size==null&&(p.size=c.size),typeof p.size=="number"&&(p.size+="px"),!g)throw Error("Bad size value `"+p.size+"`");p.family||(p.family=c.family),Array.isArray(p.family)&&(p.family.length||(p.family=[c.family]),p.family=p.family.map(function(f){return t[f]?f:'"'+f+'"'}).join(", "));var v=[];return v.push(p.style),p.variant!==p.style&&v.push(p.variant),p.weight!==p.variant&&p.weight!==p.style&&v.push(p.weight),p.stretch!==p.weight&&p.stretch!==p.variant&&p.stretch!==p.style&&v.push(p.stretch),v.push(p.size+(p.lineHeight==null||p.lineHeight==="normal"||p.lineHeight+""=="1"?"":"/"+p.lineHeight)),v.push(p.family),v.filter(Boolean).join(" ")};function s(x,p){if(x&&!p[x]&&!S[x])throw Error("Unknown keyword `"+x+"`");return x}function i(x){for(var p={},v=0;v<x.length;v++)p[x[v]]=1;return p}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(d,ee,te){ee.exports=["inherit","initial","unset"]},{}],104:[function(d,ee,te){ee.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(d,ee,te){var A=d("type/value/is"),g=d("type/value/ensure"),S=d("type/plain-function/ensure"),M=d("es5-ext/object/copy"),e=d("es5-ext/object/normalize-options"),a=d("es5-ext/object/map"),n=Function.prototype.bind,r=Object.defineProperty,t=Object.prototype.hasOwnProperty,c;c=function(s,i,x){var p=g(i)&&S(i.value),v;return v=M(i),delete v.writable,delete v.value,v.get=function(){return!x.overwriteDefinition&&t.call(this,s)?p:(i.value=n.call(p,x.resolveContext?x.resolveContext(this):this),r(this,s,i),this[s])},v},ee.exports=function(s){var i=e(arguments[1]);return A(i.resolveContext)&&S(i.resolveContext),a(s,function(x,p){return c(p,x,i)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":322,"type/value/ensure":326,"type/value/is":327}],106:[function(d,ee,te){var A=d("type/value/is"),g=d("type/plain-function/is"),S=d("es5-ext/object/assign"),M=d("es5-ext/object/normalize-options"),e=d("es5-ext/string/#/contains"),a=ee.exports=function(n,r){var t,c,s,i,x;return arguments.length<2||typeof n!="string"?(i=r,r=n,n=null):i=arguments[2],A(n)?(t=e.call(n,"c"),c=e.call(n,"e"),s=e.call(n,"w")):(t=s=!0,c=!1),x={value:r,configurable:t,enumerable:c,writable:s},i?S(M(i),x):x};a.gs=function(n,r,t){var c,s,i,x;return typeof n!="string"?(i=t,t=r,r=n,n=null):i=arguments[3],A(r)?g(r)?A(t)?g(t)||(i=t,t=void 0):t=void 0:(i=r,r=t=void 0):r=void 0,A(n)?(c=e.call(n,"c"),s=e.call(n,"e")):(c=!0,s=!1),x={get:r,set:t,configurable:c,enumerable:s},i?S(M(i),x):x}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":323,"type/value/is":327}],107:[function(d,ee,te){(function(A,g){g(typeof te=="object"&&typeof ee<"u"?te:A.d3=A.d3||{})})(this,function(A){function g(V,U){return V<U?-1:V>U?1:V>=U?0:NaN}function S(V){return V.length===1&&(V=M(V)),{left:function(U,$,ne,X){for(ne==null&&(ne=0),X==null&&(X=U.length);ne<X;){var Q=ne+X>>>1;V(U[Q],$)<0?ne=Q+1:X=Q}return ne},right:function(U,$,ne,X){for(ne==null&&(ne=0),X==null&&(X=U.length);ne<X;){var Q=ne+X>>>1;V(U[Q],$)>0?X=Q:ne=Q+1}return ne}}}function M(V){return function(U,$){return g(V(U),$)}}var e=S(g),a=e.right,n=e.left;function r(V,U){U==null&&(U=t);for(var $=0,ne=V.length-1,X=V[0],Q=new Array(ne<0?0:ne);$<ne;)Q[$]=U(X,X=V[++$]);return Q}function t(V,U){return[V,U]}function c(V,U,$){var ne=V.length,X=U.length,Q=new Array(ne*X),ie,se,ae,oe;for($==null&&($=t),ie=ae=0;ie<ne;++ie)for(oe=V[ie],se=0;se<X;++se,++ae)Q[ae]=$(oe,U[se]);return Q}function s(V,U){return U<V?-1:U>V?1:U>=V?0:NaN}function i(V){return V===null?NaN:+V}function x(V,U){var $=V.length,ne=0,X=-1,Q=0,ie,se,ae=0;if(U==null)for(;++X<$;)isNaN(ie=i(V[X]))||(se=ie-Q,Q+=se/++ne,ae+=se*(ie-Q));else for(;++X<$;)isNaN(ie=i(U(V[X],X,V)))||(se=ie-Q,Q+=se/++ne,ae+=se*(ie-Q));if(ne>1)return ae/(ne-1)}function p(V,U){var $=x(V,U);return $&&Math.sqrt($)}function v(V,U){var $=V.length,ne=-1,X,Q,ie;if(U==null){for(;++ne<$;)if((X=V[ne])!=null&&X>=X)for(Q=ie=X;++ne<$;)(X=V[ne])!=null&&(Q>X&&(Q=X),ie<X&&(ie=X))}else for(;++ne<$;)if((X=U(V[ne],ne,V))!=null&&X>=X)for(Q=ie=X;++ne<$;)(X=U(V[ne],ne,V))!=null&&(Q>X&&(Q=X),ie<X&&(ie=X));return[Q,ie]}var f=Array.prototype,y=f.slice,o=f.map;function m(V){return function(){return V}}function l(V){return V}function w(V,U,$){V=+V,U=+U,$=(X=arguments.length)<2?(U=V,V=0,1):X<3?1:+$;for(var ne=-1,X=Math.max(0,Math.ceil((U-V)/$))|0,Q=new Array(X);++ne<X;)Q[ne]=V+ne*$;return Q}var _=Math.sqrt(50),h=Math.sqrt(10),b=Math.sqrt(2);function u(V,U,$){var ne,X=-1,Q,ie,se;if(U=+U,V=+V,$=+$,V===U&&$>0)return[V];if((ne=U<V)&&(Q=V,V=U,U=Q),(se=L(V,U,$))===0||!isFinite(se))return[];if(se>0)for(V=Math.ceil(V/se),U=Math.floor(U/se),ie=new Array(Q=Math.ceil(U-V+1));++X<Q;)ie[X]=(V+X)*se;else for(V=Math.floor(V*se),U=Math.ceil(U*se),ie=new Array(Q=Math.ceil(V-U+1));++X<Q;)ie[X]=(V-X)/se;return ne&&ie.reverse(),ie}function L(V,U,$){var ne=(U-V)/Math.max(0,$),X=Math.floor(Math.log(ne)/Math.LN10),Q=ne/Math.pow(10,X);return X>=0?(Q>=_?10:Q>=h?5:Q>=b?2:1)*Math.pow(10,X):-Math.pow(10,-X)/(Q>=_?10:Q>=h?5:Q>=b?2:1)}function T(V,U,$){var ne=Math.abs(U-V)/Math.max(0,$),X=Math.pow(10,Math.floor(Math.log(ne)/Math.LN10)),Q=ne/X;return Q>=_?X*=10:Q>=h?X*=5:Q>=b&&(X*=2),U<V?-X:X}function k(V){return Math.ceil(Math.log(V.length)/Math.LN2)+1}function P(){var V=l,U=v,$=k;function ne(X){var Q,ie=X.length,se,ae=new Array(ie);for(Q=0;Q<ie;++Q)ae[Q]=V(X[Q],Q,X);var oe=U(ae),be=oe[0],ce=oe[1],de=$(ae,be,ce);Array.isArray(de)||(de=T(be,ce,de),de=w(Math.ceil(be/de)*de,ce,de));for(var ye=de.length;de[0]<=be;)de.shift(),--ye;for(;de[ye-1]>ce;)de.pop(),--ye;var ge=new Array(ye+1),me;for(Q=0;Q<=ye;++Q)me=ge[Q]=[],me.x0=Q>0?de[Q-1]:be,me.x1=Q<ye?de[Q]:ce;for(Q=0;Q<ie;++Q)se=ae[Q],be<=se&&se<=ce&&ge[a(de,se,0,ye)].push(X[Q]);return ge}return ne.value=function(X){return arguments.length?(V=typeof X=="function"?X:m(X),ne):V},ne.domain=function(X){return arguments.length?(U=typeof X=="function"?X:m([X[0],X[1]]),ne):U},ne.thresholds=function(X){return arguments.length?($=typeof X=="function"?X:Array.isArray(X)?m(y.call(X)):m(X),ne):$},ne}function z(V,U,$){if($==null&&($=i),!!(ne=V.length)){if((U=+U)<=0||ne<2)return+$(V[0],0,V);if(U>=1)return+$(V[ne-1],ne-1,V);var ne,X=(ne-1)*U,Q=Math.floor(X),ie=+$(V[Q],Q,V),se=+$(V[Q+1],Q+1,V);return ie+(se-ie)*(X-Q)}}function I(V,U,$){return V=o.call(V,i).sort(g),Math.ceil(($-U)/(2*(z(V,.75)-z(V,.25))*Math.pow(V.length,-1/3)))}function D(V,U,$){return Math.ceil(($-U)/(3.5*p(V)*Math.pow(V.length,-1/3)))}function R(V,U){var $=V.length,ne=-1,X,Q;if(U==null){for(;++ne<$;)if((X=V[ne])!=null&&X>=X)for(Q=X;++ne<$;)(X=V[ne])!=null&&X>Q&&(Q=X)}else for(;++ne<$;)if((X=U(V[ne],ne,V))!=null&&X>=X)for(Q=X;++ne<$;)(X=U(V[ne],ne,V))!=null&&X>Q&&(Q=X);return Q}function O(V,U){var $=V.length,ne=$,X=-1,Q,ie=0;if(U==null)for(;++X<$;)isNaN(Q=i(V[X]))?--ne:ie+=Q;else for(;++X<$;)isNaN(Q=i(U(V[X],X,V)))?--ne:ie+=Q;if(ne)return ie/ne}function F(V,U){var $=V.length,ne=-1,X,Q=[];if(U==null)for(;++ne<$;)isNaN(X=i(V[ne]))||Q.push(X);else for(;++ne<$;)isNaN(X=i(U(V[ne],ne,V)))||Q.push(X);return z(Q.sort(g),.5)}function N(V){for(var U=V.length,$,ne=-1,X=0,Q,ie;++ne<U;)X+=V[ne].length;for(Q=new Array(X);--U>=0;)for(ie=V[U],$=ie.length;--$>=0;)Q[--X]=ie[$];return Q}function G(V,U){var $=V.length,ne=-1,X,Q;if(U==null){for(;++ne<$;)if((X=V[ne])!=null&&X>=X)for(Q=X;++ne<$;)(X=V[ne])!=null&&Q>X&&(Q=X)}else for(;++ne<$;)if((X=U(V[ne],ne,V))!=null&&X>=X)for(Q=X;++ne<$;)(X=U(V[ne],ne,V))!=null&&Q>X&&(Q=X);return Q}function K(V,U){for(var $=U.length,ne=new Array($);$--;)ne[$]=V[U[$]];return ne}function W(V,U){if(!!($=V.length)){var $,ne=0,X=0,Q,ie=V[X];for(U==null&&(U=g);++ne<$;)(U(Q=V[ne],ie)<0||U(ie,ie)!==0)&&(ie=Q,X=ne);if(U(ie,ie)===0)return X}}function Y(V,U,$){for(var ne=($==null?V.length:$)-(U=U==null?0:+U),X,Q;ne;)Q=Math.random()*ne--|0,X=V[ne+U],V[ne+U]=V[Q+U],V[Q+U]=X;return V}function re(V,U){var $=V.length,ne=-1,X,Q=0;if(U==null)for(;++ne<$;)(X=+V[ne])&&(Q+=X);else for(;++ne<$;)(X=+U(V[ne],ne,V))&&(Q+=X);return Q}function ue(V){if(!(Q=V.length))return[];for(var U=-1,$=G(V,j),ne=new Array($);++U<$;)for(var X=-1,Q,ie=ne[U]=new Array(Q);++X<Q;)ie[X]=V[X][U];return ne}function j(V){return V.length}function q(){return ue(arguments)}A.bisect=a,A.bisectRight=a,A.bisectLeft=n,A.ascending=g,A.bisector=S,A.cross=c,A.descending=s,A.deviation=p,A.extent=v,A.histogram=P,A.thresholdFreedmanDiaconis=I,A.thresholdScott=D,A.thresholdSturges=k,A.max=R,A.mean=O,A.median=F,A.merge=N,A.min=G,A.pairs=r,A.permute=K,A.quantile=z,A.range=w,A.scan=W,A.shuffle=Y,A.sum=re,A.ticks=u,A.tickIncrement=L,A.tickStep=T,A.transpose=ue,A.variance=x,A.zip=q,Object.defineProperty(A,"__esModule",{value:!0})})},{}],108:[function(d,ee,te){(function(A,g){g(typeof te=="object"&&typeof ee<"u"?te:A.d3=A.d3||{})})(this,function(A){var g="$";function S(){}S.prototype=M.prototype={constructor:S,has:function(f){return g+f in this},get:function(f){return this[g+f]},set:function(f,y){return this[g+f]=y,this},remove:function(f){var y=g+f;return y in this&&delete this[y]},clear:function(){for(var f in this)f[0]===g&&delete this[f]},keys:function(){var f=[];for(var y in this)y[0]===g&&f.push(y.slice(1));return f},values:function(){var f=[];for(var y in this)y[0]===g&&f.push(this[y]);return f},entries:function(){var f=[];for(var y in this)y[0]===g&&f.push({key:y.slice(1),value:this[y]});return f},size:function(){var f=0;for(var y in this)y[0]===g&&++f;return f},empty:function(){for(var f in this)if(f[0]===g)return!1;return!0},each:function(f){for(var y in this)y[0]===g&&f(this[y],y.slice(1),this)}};function M(f,y){var o=new S;if(f instanceof S)f.each(function(h,b){o.set(b,h)});else if(Array.isArray(f)){var m=-1,l=f.length,w;if(y==null)for(;++m<l;)o.set(m,f[m]);else for(;++m<l;)o.set(y(w=f[m],m,f),w)}else if(f)for(var _ in f)o.set(_,f[_]);return o}function e(){var f=[],y=[],o,m,l;function w(h,b,u,L){if(b>=f.length)return o!=null&&h.sort(o),m!=null?m(h):h;for(var T=-1,k=h.length,P=f[b++],z,I,D=M(),R,O=u();++T<k;)(R=D.get(z=P(I=h[T])+""))?R.push(I):D.set(z,[I]);return D.each(function(F,N){L(O,N,w(F,b,u,L))}),O}function _(h,b){if(++b>f.length)return h;var u,L=y[b-1];return m!=null&&b>=f.length?u=h.entries():(u=[],h.each(function(T,k){u.push({key:k,values:_(T,b)})})),L!=null?u.sort(function(T,k){return L(T.key,k.key)}):u}return l={object:function(h){return w(h,0,a,n)},map:function(h){return w(h,0,r,t)},entries:function(h){return _(w(h,0,r,t),0)},key:function(h){return f.push(h),l},sortKeys:function(h){return y[f.length-1]=h,l},sortValues:function(h){return o=h,l},rollup:function(h){return m=h,l}}}function a(){return{}}function n(f,y,o){f[y]=o}function r(){return M()}function t(f,y,o){f.set(y,o)}function c(){}var s=M.prototype;c.prototype=i.prototype={constructor:c,has:s.has,add:function(f){return f+="",this[g+f]=f,this},remove:s.remove,clear:s.clear,values:s.keys,size:s.size,empty:s.empty,each:s.each};function i(f,y){var o=new c;if(f instanceof c)f.each(function(w){o.add(w)});else if(f){var m=-1,l=f.length;if(y==null)for(;++m<l;)o.add(f[m]);else for(;++m<l;)o.add(y(f[m],m,f))}return o}function x(f){var y=[];for(var o in f)y.push(o);return y}function p(f){var y=[];for(var o in f)y.push(f[o]);return y}function v(f){var y=[];for(var o in f)y.push({key:o,value:f[o]});return y}A.nest=e,A.set=i,A.map=M,A.keys=x,A.values=p,A.entries=v,Object.defineProperty(A,"__esModule",{value:!0})})},{}],109:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){function g(De,Ge,ht){De.prototype=Ge.prototype=ht,ht.constructor=De}function S(De,Ge){var ht=Object.create(De.prototype);for(var Rt in Ge)ht[Rt]=Ge[Rt];return ht}function M(){}var e=.7,a=1/e,n="\\s*([+-]?\\d+)\\s*",r="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",t="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,s=new RegExp("^rgb\\("+[n,n,n]+"\\)$"),i=new RegExp("^rgb\\("+[t,t,t]+"\\)$"),x=new RegExp("^rgba\\("+[n,n,n,r]+"\\)$"),p=new RegExp("^rgba\\("+[t,t,t,r]+"\\)$"),v=new RegExp("^hsl\\("+[r,t,t]+"\\)$"),f=new RegExp("^hsla\\("+[r,t,t,r]+"\\)$"),y={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};g(M,w,{copy:function(De){return Object.assign(new this.constructor,this,De)},displayable:function(){return this.rgb().displayable()},hex:o,formatHex:o,formatHsl:m,formatRgb:l,toString:l});function o(){return this.rgb().formatHex()}function m(){return I(this).formatHsl()}function l(){return this.rgb().formatRgb()}function w(De){var Ge,ht;return De=(De+"").trim().toLowerCase(),(Ge=c.exec(De))?(ht=Ge[1].length,Ge=parseInt(Ge[1],16),ht===6?_(Ge):ht===3?new L(Ge>>8&15|Ge>>4&240,Ge>>4&15|Ge&240,(Ge&15)<<4|Ge&15,1):ht===8?h(Ge>>24&255,Ge>>16&255,Ge>>8&255,(Ge&255)/255):ht===4?h(Ge>>12&15|Ge>>8&240,Ge>>8&15|Ge>>4&240,Ge>>4&15|Ge&240,((Ge&15)<<4|Ge&15)/255):null):(Ge=s.exec(De))?new L(Ge[1],Ge[2],Ge[3],1):(Ge=i.exec(De))?new L(Ge[1]*255/100,Ge[2]*255/100,Ge[3]*255/100,1):(Ge=x.exec(De))?h(Ge[1],Ge[2],Ge[3],Ge[4]):(Ge=p.exec(De))?h(Ge[1]*255/100,Ge[2]*255/100,Ge[3]*255/100,Ge[4]):(Ge=v.exec(De))?z(Ge[1],Ge[2]/100,Ge[3]/100,1):(Ge=f.exec(De))?z(Ge[1],Ge[2]/100,Ge[3]/100,Ge[4]):y.hasOwnProperty(De)?_(y[De]):De==="transparent"?new L(NaN,NaN,NaN,0):null}function _(De){return new L(De>>16&255,De>>8&255,De&255,1)}function h(De,Ge,ht,Rt){return Rt<=0&&(De=Ge=ht=NaN),new L(De,Ge,ht,Rt)}function b(De){return De instanceof M||(De=w(De)),De?(De=De.rgb(),new L(De.r,De.g,De.b,De.opacity)):new L}function u(De,Ge,ht,Rt){return arguments.length===1?b(De):new L(De,Ge,ht,Rt==null?1:Rt)}function L(De,Ge,ht,Rt){this.r=+De,this.g=+Ge,this.b=+ht,this.opacity=+Rt}g(L,u,S(M,{brighter:function(De){return De=De==null?a:Math.pow(a,De),new L(this.r*De,this.g*De,this.b*De,this.opacity)},darker:function(De){return De=De==null?e:Math.pow(e,De),new L(this.r*De,this.g*De,this.b*De,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:T,formatHex:T,formatRgb:k,toString:k}));function T(){return"#"+P(this.r)+P(this.g)+P(this.b)}function k(){var De=this.opacity;return De=isNaN(De)?1:Math.max(0,Math.min(1,De)),(De===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(De===1?")":", "+De+")")}function P(De){return De=Math.max(0,Math.min(255,Math.round(De)||0)),(De<16?"0":"")+De.toString(16)}function z(De,Ge,ht,Rt){return Rt<=0?De=Ge=ht=NaN:ht<=0||ht>=1?De=Ge=NaN:Ge<=0&&(De=NaN),new R(De,Ge,ht,Rt)}function I(De){if(De instanceof R)return new R(De.h,De.s,De.l,De.opacity);if(De instanceof M||(De=w(De)),!De)return new R;if(De instanceof R)return De;De=De.rgb();var Ge=De.r/255,ht=De.g/255,Rt=De.b/255,Kt=Math.min(Ge,ht,Rt),It=Math.max(Ge,ht,Rt),Mt=NaN,Yt=It-Kt,zt=(It+Kt)/2;return Yt?(Ge===It?Mt=(ht-Rt)/Yt+(ht<Rt)*6:ht===It?Mt=(Rt-Ge)/Yt+2:Mt=(Ge-ht)/Yt+4,Yt/=zt<.5?It+Kt:2-It-Kt,Mt*=60):Yt=zt>0&&zt<1?0:Mt,new R(Mt,Yt,zt,De.opacity)}function D(De,Ge,ht,Rt){return arguments.length===1?I(De):new R(De,Ge,ht,Rt==null?1:Rt)}function R(De,Ge,ht,Rt){this.h=+De,this.s=+Ge,this.l=+ht,this.opacity=+Rt}g(R,D,S(M,{brighter:function(De){return De=De==null?a:Math.pow(a,De),new R(this.h,this.s,this.l*De,this.opacity)},darker:function(De){return De=De==null?e:Math.pow(e,De),new R(this.h,this.s,this.l*De,this.opacity)},rgb:function(){var De=this.h%360+(this.h<0)*360,Ge=isNaN(De)||isNaN(this.s)?0:this.s,ht=this.l,Rt=ht+(ht<.5?ht:1-ht)*Ge,Kt=2*ht-Rt;return new L(O(De>=240?De-240:De+120,Kt,Rt),O(De,Kt,Rt),O(De<120?De+240:De-120,Kt,Rt),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var De=this.opacity;return De=isNaN(De)?1:Math.max(0,Math.min(1,De)),(De===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(De===1?")":", "+De+")")}}));function O(De,Ge,ht){return(De<60?Ge+(ht-Ge)*De/60:De<180?ht:De<240?Ge+(ht-Ge)*(240-De)/60:Ge)*255}var F=Math.PI/180,N=180/Math.PI,G=18,K=.96422,W=1,Y=.82521,re=4/29,ue=6/29,j=3*ue*ue,q=ue*ue*ue;function V(De){if(De instanceof ne)return new ne(De.l,De.a,De.b,De.opacity);if(De instanceof ce)return de(De);De instanceof L||(De=b(De));var Ge=se(De.r),ht=se(De.g),Rt=se(De.b),Kt=X((.2225045*Ge+.7168786*ht+.0606169*Rt)/W),It,Mt;return Ge===ht&&ht===Rt?It=Mt=Kt:(It=X((.4360747*Ge+.3850649*ht+.1430804*Rt)/K),Mt=X((.0139322*Ge+.0971045*ht+.7141733*Rt)/Y)),new ne(116*Kt-16,500*(It-Kt),200*(Kt-Mt),De.opacity)}function U(De,Ge){return new ne(De,0,0,Ge==null?1:Ge)}function $(De,Ge,ht,Rt){return arguments.length===1?V(De):new ne(De,Ge,ht,Rt==null?1:Rt)}function ne(De,Ge,ht,Rt){this.l=+De,this.a=+Ge,this.b=+ht,this.opacity=+Rt}g(ne,$,S(M,{brighter:function(De){return new ne(this.l+G*(De==null?1:De),this.a,this.b,this.opacity)},darker:function(De){return new ne(this.l-G*(De==null?1:De),this.a,this.b,this.opacity)},rgb:function(){var De=(this.l+16)/116,Ge=isNaN(this.a)?De:De+this.a/500,ht=isNaN(this.b)?De:De-this.b/200;return Ge=K*Q(Ge),De=W*Q(De),ht=Y*Q(ht),new L(ie(3.1338561*Ge-1.6168667*De-.4906146*ht),ie(-.9787684*Ge+1.9161415*De+.033454*ht),ie(.0719453*Ge-.2289914*De+1.4052427*ht),this.opacity)}}));function X(De){return De>q?Math.pow(De,1/3):De/j+re}function Q(De){return De>ue?De*De*De:j*(De-re)}function ie(De){return 255*(De<=.0031308?12.92*De:1.055*Math.pow(De,1/2.4)-.055)}function se(De){return(De/=255)<=.04045?De/12.92:Math.pow((De+.055)/1.055,2.4)}function ae(De){if(De instanceof ce)return new ce(De.h,De.c,De.l,De.opacity);if(De instanceof ne||(De=V(De)),De.a===0&&De.b===0)return new ce(NaN,0<De.l&&De.l<100?0:NaN,De.l,De.opacity);var Ge=Math.atan2(De.b,De.a)*N;return new ce(Ge<0?Ge+360:Ge,Math.sqrt(De.a*De.a+De.b*De.b),De.l,De.opacity)}function oe(De,Ge,ht,Rt){return arguments.length===1?ae(De):new ce(ht,Ge,De,Rt==null?1:Rt)}function be(De,Ge,ht,Rt){return arguments.length===1?ae(De):new ce(De,Ge,ht,Rt==null?1:Rt)}function ce(De,Ge,ht,Rt){this.h=+De,this.c=+Ge,this.l=+ht,this.opacity=+Rt}function de(De){if(isNaN(De.h))return new ne(De.l,0,0,De.opacity);var Ge=De.h*F;return new ne(De.l,Math.cos(Ge)*De.c,Math.sin(Ge)*De.c,De.opacity)}g(ce,be,S(M,{brighter:function(De){return new ce(this.h,this.c,this.l+G*(De==null?1:De),this.opacity)},darker:function(De){return new ce(this.h,this.c,this.l-G*(De==null?1:De),this.opacity)},rgb:function(){return de(this).rgb()}}));var ye=-.14861,ge=1.78277,me=-.29227,Ee=-.90649,Pe=1.97294,Ne=Pe*Ee,we=Pe*ge,ke=ge*me-Ee*ye;function Xe(De){if(De instanceof Ie)return new Ie(De.h,De.s,De.l,De.opacity);De instanceof L||(De=b(De));var Ge=De.r/255,ht=De.g/255,Rt=De.b/255,Kt=(ke*Rt+Ne*Ge-we*ht)/(ke+Ne-we),It=Rt-Kt,Mt=(Pe*(ht-Kt)-me*It)/Ee,Yt=Math.sqrt(Mt*Mt+It*It)/(Pe*Kt*(1-Kt)),zt=Yt?Math.atan2(Mt,It)*N-120:NaN;return new Ie(zt<0?zt+360:zt,Yt,Kt,De.opacity)}function He(De,Ge,ht,Rt){return arguments.length===1?Xe(De):new Ie(De,Ge,ht,Rt==null?1:Rt)}function Ie(De,Ge,ht,Rt){this.h=+De,this.s=+Ge,this.l=+ht,this.opacity=+Rt}g(Ie,He,S(M,{brighter:function(De){return De=De==null?a:Math.pow(a,De),new Ie(this.h,this.s,this.l*De,this.opacity)},darker:function(De){return De=De==null?e:Math.pow(e,De),new Ie(this.h,this.s,this.l*De,this.opacity)},rgb:function(){var De=isNaN(this.h)?0:(this.h+120)*F,Ge=+this.l,ht=isNaN(this.s)?0:this.s*Ge*(1-Ge),Rt=Math.cos(De),Kt=Math.sin(De);return new L(255*(Ge+ht*(ye*Rt+ge*Kt)),255*(Ge+ht*(me*Rt+Ee*Kt)),255*(Ge+ht*(Pe*Rt)),this.opacity)}})),A.color=w,A.cubehelix=He,A.gray=U,A.hcl=be,A.hsl=D,A.lab=$,A.lch=oe,A.rgb=u,Object.defineProperty(A,"__esModule",{value:!0})})},{}],110:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){var g={value:function(){}};function S(){for(var r=0,t=arguments.length,c={},s;r<t;++r){if(!(s=arguments[r]+"")||s in c||/[\s.]/.test(s))throw new Error("illegal type: "+s);c[s]=[]}return new M(c)}function M(r){this._=r}function e(r,t){return r.trim().split(/^|\s+/).map(function(c){var s="",i=c.indexOf(".");if(i>=0&&(s=c.slice(i+1),c=c.slice(0,i)),c&&!t.hasOwnProperty(c))throw new Error("unknown type: "+c);return{type:c,name:s}})}M.prototype=S.prototype={constructor:M,on:function(r,t){var c=this._,s=e(r+"",c),i,x=-1,p=s.length;if(arguments.length<2){for(;++x<p;)if((i=(r=s[x]).type)&&(i=a(c[i],r.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++x<p;)if(i=(r=s[x]).type)c[i]=n(c[i],r.name,t);else if(t==null)for(i in c)c[i]=n(c[i],r.name,null);return this},copy:function(){var r={},t=this._;for(var c in t)r[c]=t[c].slice();return new M(r)},call:function(r,t){if((i=arguments.length-2)>0)for(var c=new Array(i),s=0,i,x;s<i;++s)c[s]=arguments[s+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(x=this._[r],s=0,i=x.length;s<i;++s)x[s].value.apply(t,c)},apply:function(r,t,c){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var s=this._[r],i=0,x=s.length;i<x;++i)s[i].value.apply(t,c)}};function a(r,t){for(var c=0,s=r.length,i;c<s;++c)if((i=r[c]).name===t)return i.value}function n(r,t,c){for(var s=0,i=r.length;s<i;++s)if(r[s].name===t){r[s]=g,r=r.slice(0,s).concat(r.slice(s+1));break}return c!=null&&r.push({name:t,value:c}),r}A.dispatch=S,Object.defineProperty(A,"__esModule",{value:!0})})},{}],111:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,d("d3-quadtree"),d("d3-collection"),d("d3-dispatch"),d("d3-timer")):g(A.d3=A.d3||{},A.d3,A.d3,A.d3,A.d3)})(this,function(A,g,S,M,e){function a(b,u){var L;b==null&&(b=0),u==null&&(u=0);function T(){var k,P=L.length,z,I=0,D=0;for(k=0;k<P;++k)z=L[k],I+=z.x,D+=z.y;for(I=I/P-b,D=D/P-u,k=0;k<P;++k)z=L[k],z.x-=I,z.y-=D}return T.initialize=function(k){L=k},T.x=function(k){return arguments.length?(b=+k,T):b},T.y=function(k){return arguments.length?(u=+k,T):u},T}function n(b){return function(){return b}}function r(){return(Math.random()-.5)*1e-6}function t(b){return b.x+b.vx}function c(b){return b.y+b.vy}function s(b){var u,L,T=1,k=1;typeof b!="function"&&(b=n(b==null?1:+b));function P(){for(var D,R=u.length,O,F,N,G,K,W,Y=0;Y<k;++Y)for(O=g.quadtree(u,t,c).visitAfter(z),D=0;D<R;++D)F=u[D],K=L[F.index],W=K*K,N=F.x+F.vx,G=F.y+F.vy,O.visit(re);function re(ue,j,q,V,U){var $=ue.data,ne=ue.r,X=K+ne;if($){if($.index>F.index){var Q=N-$.x-$.vx,ie=G-$.y-$.vy,se=Q*Q+ie*ie;se<X*X&&(Q===0&&(Q=r(),se+=Q*Q),ie===0&&(ie=r(),se+=ie*ie),se=(X-(se=Math.sqrt(se)))/se*T,F.vx+=(Q*=se)*(X=(ne*=ne)/(W+ne)),F.vy+=(ie*=se)*X,$.vx-=Q*(X=1-X),$.vy-=ie*X)}return}return j>N+X||V<N-X||q>G+X||U<G-X}}function z(D){if(D.data)return D.r=L[D.data.index];for(var R=D.r=0;R<4;++R)D[R]&&D[R].r>D.r&&(D.r=D[R].r)}function I(){if(!!u){var D,R=u.length,O;for(L=new Array(R),D=0;D<R;++D)O=u[D],L[O.index]=+b(O,D,u)}}return P.initialize=function(D){u=D,I()},P.iterations=function(D){return arguments.length?(k=+D,P):k},P.strength=function(D){return arguments.length?(T=+D,P):T},P.radius=function(D){return arguments.length?(b=typeof D=="function"?D:n(+D),I(),P):b},P}function i(b){return b.index}function x(b,u){var L=b.get(u);if(!L)throw new Error("missing: "+u);return L}function p(b){var u=i,L=O,T,k=n(30),P,z,I,D,R=1;b==null&&(b=[]);function O(W){return 1/Math.min(I[W.source.index],I[W.target.index])}function F(W){for(var Y=0,re=b.length;Y<R;++Y)for(var ue=0,j,q,V,U,$,ne,X;ue<re;++ue)j=b[ue],q=j.source,V=j.target,U=V.x+V.vx-q.x-q.vx||r(),$=V.y+V.vy-q.y-q.vy||r(),ne=Math.sqrt(U*U+$*$),ne=(ne-P[ue])/ne*W*T[ue],U*=ne,$*=ne,V.vx-=U*(X=D[ue]),V.vy-=$*X,q.vx+=U*(X=1-X),q.vy+=$*X}function N(){if(!!z){var W,Y=z.length,re=b.length,ue=S.map(z,u),j;for(W=0,I=new Array(Y);W<re;++W)j=b[W],j.index=W,typeof j.source!="object"&&(j.source=x(ue,j.source)),typeof j.target!="object"&&(j.target=x(ue,j.target)),I[j.source.index]=(I[j.source.index]||0)+1,I[j.target.index]=(I[j.target.index]||0)+1;for(W=0,D=new Array(re);W<re;++W)j=b[W],D[W]=I[j.source.index]/(I[j.source.index]+I[j.target.index]);T=new Array(re),G(),P=new Array(re),K()}}function G(){if(!!z)for(var W=0,Y=b.length;W<Y;++W)T[W]=+L(b[W],W,b)}function K(){if(!!z)for(var W=0,Y=b.length;W<Y;++W)P[W]=+k(b[W],W,b)}return F.initialize=function(W){z=W,N()},F.links=function(W){return arguments.length?(b=W,N(),F):b},F.id=function(W){return arguments.length?(u=W,F):u},F.iterations=function(W){return arguments.length?(R=+W,F):R},F.strength=function(W){return arguments.length?(L=typeof W=="function"?W:n(+W),G(),F):L},F.distance=function(W){return arguments.length?(k=typeof W=="function"?W:n(+W),K(),F):k},F}function v(b){return b.x}function f(b){return b.y}var y=10,o=Math.PI*(3-Math.sqrt(5));function m(b){var u,L=1,T=.001,k=1-Math.pow(T,1/300),P=0,z=.6,I=S.map(),D=e.timer(O),R=M.dispatch("tick","end");b==null&&(b=[]);function O(){F(),R.call("tick",u),L<T&&(D.stop(),R.call("end",u))}function F(K){var W,Y=b.length,re;K===void 0&&(K=1);for(var ue=0;ue<K;++ue)for(L+=(P-L)*k,I.each(function(j){j(L)}),W=0;W<Y;++W)re=b[W],re.fx==null?re.x+=re.vx*=z:(re.x=re.fx,re.vx=0),re.fy==null?re.y+=re.vy*=z:(re.y=re.fy,re.vy=0);return u}function N(){for(var K=0,W=b.length,Y;K<W;++K){if(Y=b[K],Y.index=K,Y.fx!=null&&(Y.x=Y.fx),Y.fy!=null&&(Y.y=Y.fy),isNaN(Y.x)||isNaN(Y.y)){var re=y*Math.sqrt(K),ue=K*o;Y.x=re*Math.cos(ue),Y.y=re*Math.sin(ue)}(isNaN(Y.vx)||isNaN(Y.vy))&&(Y.vx=Y.vy=0)}}function G(K){return K.initialize&&K.initialize(b),K}return N(),u={tick:F,restart:function(){return D.restart(O),u},stop:function(){return D.stop(),u},nodes:function(K){return arguments.length?(b=K,N(),I.each(G),u):b},alpha:function(K){return arguments.length?(L=+K,u):L},alphaMin:function(K){return arguments.length?(T=+K,u):T},alphaDecay:function(K){return arguments.length?(k=+K,u):+k},alphaTarget:function(K){return arguments.length?(P=+K,u):P},velocityDecay:function(K){return arguments.length?(z=1-K,u):1-z},force:function(K,W){return arguments.length>1?(W==null?I.remove(K):I.set(K,G(W)),u):I.get(K)},find:function(K,W,Y){var re=0,ue=b.length,j,q,V,U,$;for(Y==null?Y=1/0:Y*=Y,re=0;re<ue;++re)U=b[re],j=K-U.x,q=W-U.y,V=j*j+q*q,V<Y&&($=U,Y=V);return $},on:function(K,W){return arguments.length>1?(R.on(K,W),u):R.on(K)}}}function l(){var b,u,L,T=n(-30),k,P=1,z=1/0,I=.81;function D(N){var G,K=b.length,W=g.quadtree(b,v,f).visitAfter(O);for(L=N,G=0;G<K;++G)u=b[G],W.visit(F)}function R(){if(!!b){var N,G=b.length,K;for(k=new Array(G),N=0;N<G;++N)K=b[N],k[K.index]=+T(K,N,b)}}function O(N){var G=0,K,W,Y=0,re,ue,j;if(N.length){for(re=ue=j=0;j<4;++j)(K=N[j])&&(W=Math.abs(K.value))&&(G+=K.value,Y+=W,re+=W*K.x,ue+=W*K.y);N.x=re/Y,N.y=ue/Y}else{K=N,K.x=K.data.x,K.y=K.data.y;do G+=k[K.data.index];while(K=K.next)}N.value=G}function F(N,G,K,W){if(!N.value)return!0;var Y=N.x-u.x,re=N.y-u.y,ue=W-G,j=Y*Y+re*re;if(ue*ue/I<j)return j<z&&(Y===0&&(Y=r(),j+=Y*Y),re===0&&(re=r(),j+=re*re),j<P&&(j=Math.sqrt(P*j)),u.vx+=Y*N.value*L/j,u.vy+=re*N.value*L/j),!0;if(N.length||j>=z)return;(N.data!==u||N.next)&&(Y===0&&(Y=r(),j+=Y*Y),re===0&&(re=r(),j+=re*re),j<P&&(j=Math.sqrt(P*j)));do N.data!==u&&(ue=k[N.data.index]*L/j,u.vx+=Y*ue,u.vy+=re*ue);while(N=N.next)}return D.initialize=function(N){b=N,R()},D.strength=function(N){return arguments.length?(T=typeof N=="function"?N:n(+N),R(),D):T},D.distanceMin=function(N){return arguments.length?(P=N*N,D):Math.sqrt(P)},D.distanceMax=function(N){return arguments.length?(z=N*N,D):Math.sqrt(z)},D.theta=function(N){return arguments.length?(I=N*N,D):Math.sqrt(I)},D}function w(b,u,L){var T,k=n(.1),P,z;typeof b!="function"&&(b=n(+b)),u==null&&(u=0),L==null&&(L=0);function I(R){for(var O=0,F=T.length;O<F;++O){var N=T[O],G=N.x-u||1e-6,K=N.y-L||1e-6,W=Math.sqrt(G*G+K*K),Y=(z[O]-W)*P[O]*R/W;N.vx+=G*Y,N.vy+=K*Y}}function D(){if(!!T){var R,O=T.length;for(P=new Array(O),z=new Array(O),R=0;R<O;++R)z[R]=+b(T[R],R,T),P[R]=isNaN(z[R])?0:+k(T[R],R,T)}}return I.initialize=function(R){T=R,D()},I.strength=function(R){return arguments.length?(k=typeof R=="function"?R:n(+R),D(),I):k},I.radius=function(R){return arguments.length?(b=typeof R=="function"?R:n(+R),D(),I):b},I.x=function(R){return arguments.length?(u=+R,I):u},I.y=function(R){return arguments.length?(L=+R,I):L},I}function _(b){var u=n(.1),L,T,k;typeof b!="function"&&(b=n(b==null?0:+b));function P(I){for(var D=0,R=L.length,O;D<R;++D)O=L[D],O.vx+=(k[D]-O.x)*T[D]*I}function z(){if(!!L){var I,D=L.length;for(T=new Array(D),k=new Array(D),I=0;I<D;++I)T[I]=isNaN(k[I]=+b(L[I],I,L))?0:+u(L[I],I,L)}}return P.initialize=function(I){L=I,z()},P.strength=function(I){return arguments.length?(u=typeof I=="function"?I:n(+I),z(),P):u},P.x=function(I){return arguments.length?(b=typeof I=="function"?I:n(+I),z(),P):b},P}function h(b){var u=n(.1),L,T,k;typeof b!="function"&&(b=n(b==null?0:+b));function P(I){for(var D=0,R=L.length,O;D<R;++D)O=L[D],O.vy+=(k[D]-O.y)*T[D]*I}function z(){if(!!L){var I,D=L.length;for(T=new Array(D),k=new Array(D),I=0;I<D;++I)T[I]=isNaN(k[I]=+b(L[I],I,L))?0:+u(L[I],I,L)}}return P.initialize=function(I){L=I,z()},P.strength=function(I){return arguments.length?(u=typeof I=="function"?I:n(+I),z(),P):u},P.y=function(I){return arguments.length?(b=typeof I=="function"?I:n(+I),z(),P):b},P}A.forceCenter=a,A.forceCollide=s,A.forceLink=p,A.forceManyBody=l,A.forceRadial=w,A.forceSimulation=m,A.forceX=_,A.forceY=h,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=typeof globalThis<"u"?globalThis:A||self,g(A.d3=A.d3||{}))})(this,function(A){function g(b){return Math.abs(b=Math.round(b))>=1e21?b.toLocaleString("en").replace(/,/g,""):b.toString(10)}function S(b,u){if((L=(b=u?b.toExponential(u-1):b.toExponential()).indexOf("e"))<0)return null;var L,T=b.slice(0,L);return[T.length>1?T[0]+T.slice(2):T,+b.slice(L+1)]}function M(b){return b=S(Math.abs(b)),b?b[1]:NaN}function e(b,u){return function(L,T){for(var k=L.length,P=[],z=0,I=b[0],D=0;k>0&&I>0&&(D+I+1>T&&(I=Math.max(1,T-D)),P.push(L.substring(k-=I,k+I)),!((D+=I+1)>T));)I=b[z=(z+1)%b.length];return P.reverse().join(u)}}function a(b){return function(u){return u.replace(/[0-9]/g,function(L){return b[+L]})}}var n=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r(b){if(!(u=n.exec(b)))throw new Error("invalid format: "+b);var u;return new t({fill:u[1],align:u[2],sign:u[3],symbol:u[4],zero:u[5],width:u[6],comma:u[7],precision:u[8]&&u[8].slice(1),trim:u[9],type:u[10]})}r.prototype=t.prototype;function t(b){this.fill=b.fill===void 0?" ":b.fill+"",this.align=b.align===void 0?">":b.align+"",this.sign=b.sign===void 0?"-":b.sign+"",this.symbol=b.symbol===void 0?"":b.symbol+"",this.zero=!!b.zero,this.width=b.width===void 0?void 0:+b.width,this.comma=!!b.comma,this.precision=b.precision===void 0?void 0:+b.precision,this.trim=!!b.trim,this.type=b.type===void 0?"":b.type+""}t.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function c(b){e:for(var u=b.length,L=1,T=-1,k;L<u;++L)switch(b[L]){case".":T=k=L;break;case"0":T===0&&(T=L),k=L;break;default:if(!+b[L])break e;T>0&&(T=0);break}return T>0?b.slice(0,T)+b.slice(k+1):b}var s;function i(b,u){var L=S(b,u);if(!L)return b+"";var T=L[0],k=L[1],P=k-(s=Math.max(-8,Math.min(8,Math.floor(k/3)))*3)+1,z=T.length;return P===z?T:P>z?T+new Array(P-z+1).join("0"):P>0?T.slice(0,P)+"."+T.slice(P):"0."+new Array(1-P).join("0")+S(b,Math.max(0,u+P-1))[0]}function x(b,u){var L=S(b,u);if(!L)return b+"";var T=L[0],k=L[1];return k<0?"0."+new Array(-k).join("0")+T:T.length>k+1?T.slice(0,k+1)+"."+T.slice(k+1):T+new Array(k-T.length+2).join("0")}var p={"%":function(b,u){return(b*100).toFixed(u)},b:function(b){return Math.round(b).toString(2)},c:function(b){return b+""},d:g,e:function(b,u){return b.toExponential(u)},f:function(b,u){return b.toFixed(u)},g:function(b,u){return b.toPrecision(u)},o:function(b){return Math.round(b).toString(8)},p:function(b,u){return x(b*100,u)},r:x,s:i,X:function(b){return Math.round(b).toString(16).toUpperCase()},x:function(b){return Math.round(b).toString(16)}};function v(b){return b}var f=Array.prototype.map,y=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function o(b){var u=b.grouping===void 0||b.thousands===void 0?v:e(f.call(b.grouping,Number),b.thousands+""),L=b.currency===void 0?"":b.currency[0]+"",T=b.currency===void 0?"":b.currency[1]+"",k=b.decimal===void 0?".":b.decimal+"",P=b.numerals===void 0?v:a(f.call(b.numerals,String)),z=b.percent===void 0?"%":b.percent+"",I=b.minus===void 0?"-":b.minus+"",D=b.nan===void 0?"NaN":b.nan+"";function R(F){F=r(F);var N=F.fill,G=F.align,K=F.sign,W=F.symbol,Y=F.zero,re=F.width,ue=F.comma,j=F.precision,q=F.trim,V=F.type;V==="n"?(ue=!0,V="g"):p[V]||(j===void 0&&(j=12),q=!0,V="g"),(Y||N==="0"&&G==="=")&&(Y=!0,N="0",G="=");var U=W==="$"?L:W==="#"&&/[boxX]/.test(V)?"0"+V.toLowerCase():"",$=W==="$"?T:/[%p]/.test(V)?z:"",ne=p[V],X=/[defgprs%]/.test(V);j=j===void 0?6:/[gprs]/.test(V)?Math.max(1,Math.min(21,j)):Math.max(0,Math.min(20,j));function Q(ie){var se=U,ae=$,oe,be,ce;if(V==="c")ae=ne(ie)+ae,ie="";else{ie=+ie;var de=ie<0||1/ie<0;if(ie=isNaN(ie)?D:ne(Math.abs(ie),j),q&&(ie=c(ie)),de&&+ie==0&&K!=="+"&&(de=!1),se=(de?K==="("?K:I:K==="-"||K==="("?"":K)+se,ae=(V==="s"?y[8+s/3]:"")+ae+(de&&K==="("?")":""),X){for(oe=-1,be=ie.length;++oe<be;)if(ce=ie.charCodeAt(oe),48>ce||ce>57){ae=(ce===46?k+ie.slice(oe+1):ie.slice(oe))+ae,ie=ie.slice(0,oe);break}}}ue&&!Y&&(ie=u(ie,1/0));var ye=se.length+ie.length+ae.length,ge=ye<re?new Array(re-ye+1).join(N):"";switch(ue&&Y&&(ie=u(ge+ie,ge.length?re-ae.length:1/0),ge=""),G){case"<":ie=se+ie+ae+ge;break;case"=":ie=se+ge+ie+ae;break;case"^":ie=ge.slice(0,ye=ge.length>>1)+se+ie+ae+ge.slice(ye);break;default:ie=ge+se+ie+ae;break}return P(ie)}return Q.toString=function(){return F+""},Q}function O(F,N){var G=R((F=r(F),F.type="f",F)),K=Math.max(-8,Math.min(8,Math.floor(M(N)/3)))*3,W=Math.pow(10,-K),Y=y[8+K/3];return function(re){return G(W*re)+Y}}return{format:R,formatPrefix:O}}var m;l({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function l(b){return m=o(b),A.format=m.format,A.formatPrefix=m.formatPrefix,m}function w(b){return Math.max(0,-M(Math.abs(b)))}function _(b,u){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(M(u)/3)))*3-M(Math.abs(b)))}function h(b,u){return b=Math.abs(b),u=Math.abs(u)-b,Math.max(0,M(u)-M(b))+1}A.FormatSpecifier=t,A.formatDefaultLocale=l,A.formatLocale=o,A.formatSpecifier=r,A.precisionFixed=w,A.precisionPrefix=_,A.precisionRound=h,Object.defineProperty(A,"__esModule",{value:!0})})},{}],113:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,d("d3-geo"),d("d3-array")):g(A.d3=A.d3||{},A.d3,A.d3)})(this,function(A,g,S){var M=Math.abs,e=Math.atan,a=Math.atan2,n=Math.cos,r=Math.exp,t=Math.floor,c=Math.log,s=Math.max,i=Math.min,x=Math.pow,p=Math.round,v=Math.sign||function(ze){return ze>0?1:ze<0?-1:0},f=Math.sin,y=Math.tan,o=1e-6,m=1e-12,l=Math.PI,w=l/2,_=l/4,h=Math.SQRT1_2,b=D(2),u=D(l),L=l*2,T=180/l,k=l/180;function P(ze){return ze?ze/Math.sin(ze):1}function z(ze){return ze>1?w:ze<-1?-w:Math.asin(ze)}function I(ze){return ze>1?0:ze<-1?l:Math.acos(ze)}function D(ze){return ze>0?Math.sqrt(ze):0}function R(ze){return ze=r(2*ze),(ze-1)/(ze+1)}function O(ze){return(r(ze)-r(-ze))/2}function F(ze){return(r(ze)+r(-ze))/2}function N(ze){return c(ze+D(ze*ze+1))}function G(ze){return c(ze+D(ze*ze-1))}function K(ze){var We=y(ze/2),et=2*c(n(ze/2))/(We*We);function ot(bt,mt){var kt=n(bt),fr=n(mt),pr=f(mt),sr=fr*kt,xr=-((1-sr?c((1+sr)/2)/(1-sr):-.5)+et/(1+sr));return[xr*fr*f(bt),xr*pr]}return ot.invert=function(bt,mt){var kt=D(bt*bt+mt*mt),fr=-ze/2,pr=50,sr;if(!kt)return[0,0];do{var xr=fr/2,Dr=n(xr),Xr=f(xr),qr=Xr/Dr,bn=-c(M(Dr));fr-=sr=(2/qr*bn-et*qr-kt)/(-bn/(Xr*Xr)+1-et/(2*Dr*Dr))*(Dr<0?.7:1)}while(M(sr)>o&&--pr>0);var Dn=f(fr);return[a(bt*Dn,kt*n(fr)),z(mt*Dn/kt)]},ot}function W(){var ze=w,We=g.geoProjectionMutator(K),et=We(ze);return et.radius=function(ot){return arguments.length?We(ze=ot*k):ze*T},et.scale(179.976).clipAngle(147)}function Y(ze,We){var et=n(We),ot=P(I(et*n(ze/=2)));return[2*et*f(ze)*ot,f(We)*ot]}Y.invert=function(ze,We){if(!(ze*ze+4*We*We>l*l+o)){var et=ze,ot=We,bt=25;do{var mt=f(et),kt=f(et/2),fr=n(et/2),pr=f(ot),sr=n(ot),xr=f(2*ot),Dr=pr*pr,Xr=sr*sr,qr=kt*kt,bn=1-Xr*fr*fr,Dn=bn?I(sr*fr)*D(Wn=1/bn):Wn=0,Wn,ga=2*Dn*sr*kt-ze,xa=Dn*pr-We,Ka=Wn*(Xr*qr+Dn*sr*fr*Dr),Ya=Wn*(.5*mt*xr-Dn*2*pr*kt),ei=Wn*.25*(xr*kt-Dn*pr*Xr*mt),hi=Wn*(Dr*fr+Dn*qr*sr),oo=Ya*ei-hi*Ka;if(!oo)break;var ri=(xa*Ya-ga*hi)/oo,Yi=(ga*ei-xa*Ka)/oo;et-=ri,ot-=Yi}while((M(ri)>o||M(Yi)>o)&&--bt>0);return[et,ot]}};function re(){return g.geoProjection(Y).scale(152.63)}function ue(ze){var We=f(ze),et=n(ze),ot=ze>=0?1:-1,bt=y(ot*ze),mt=(1+We-et)/2;function kt(fr,pr){var sr=n(pr),xr=n(fr/=2);return[(1+sr)*f(fr),(ot*pr>-a(xr,bt)-.001?0:-ot*10)+mt+f(pr)*et-(1+sr)*We*xr]}return kt.invert=function(fr,pr){var sr=0,xr=0,Dr=50;do{var Xr=n(sr),qr=f(sr),bn=n(xr),Dn=f(xr),Wn=1+bn,ga=Wn*qr-fr,xa=mt+Dn*et-Wn*We*Xr-pr,Ka=Wn*Xr/2,Ya=-qr*Dn,ei=We*Wn*qr/2,hi=et*bn+We*Xr*Dn,oo=Ya*ei-hi*Ka,ri=(xa*Ya-ga*hi)/oo/2,Yi=(ga*ei-xa*Ka)/oo;M(Yi)>2&&(Yi/=2),sr-=ri,xr-=Yi}while((M(ri)>o||M(Yi)>o)&&--Dr>0);return ot*xr>-a(n(sr),bt)-.001?[sr*2,xr]:null},kt}function j(){var ze=20*k,We=ze>=0?1:-1,et=y(We*ze),ot=g.geoProjectionMutator(ue),bt=ot(ze),mt=bt.stream;return bt.parallel=function(kt){return arguments.length?(et=y((We=(ze=kt*k)>=0?1:-1)*ze),ot(ze)):ze*T},bt.stream=function(kt){var fr=bt.rotate(),pr=mt(kt),sr=(bt.rotate([0,0]),mt(kt)),xr=bt.precision();return bt.rotate(fr),pr.sphere=function(){sr.polygonStart(),sr.lineStart();for(var Dr=We*-180;We*Dr<180;Dr+=We*90)sr.point(Dr,We*90);if(ze)for(;We*(Dr-=3*We*xr)>=-180;)sr.point(Dr,We*-a(n(Dr*k/2),et)*T);sr.lineEnd(),sr.polygonEnd()},pr},bt.scale(218.695).center([0,28.0974])}function q(ze,We){var et=y(We/2),ot=D(1-et*et),bt=1+ot*n(ze/=2),mt=f(ze)*ot/bt,kt=et/bt,fr=mt*mt,pr=kt*kt;return[4/3*mt*(3+fr-3*pr),4/3*kt*(3+3*fr-pr)]}q.invert=function(ze,We){if(ze*=3/8,We*=3/8,!ze&&M(We)>1)return null;var et=ze*ze,ot=We*We,bt=1+et+ot,mt=D((bt-D(bt*bt-4*We*We))/2),kt=z(mt)/3,fr=mt?G(M(We/mt))/3:N(M(ze))/3,pr=n(kt),sr=F(fr),xr=sr*sr-pr*pr;return[v(ze)*2*a(O(fr)*pr,.25-xr),v(We)*2*a(sr*f(kt),.25+xr)]};function V(){return g.geoProjection(q).scale(66.1603)}var U=D(8),$=c(1+b);function ne(ze,We){var et=M(We);return et<_?[ze,c(y(_+We/2))]:[ze*n(et)*(2*b-1/f(et)),v(We)*(2*b*(et-_)-c(y(et/2)))]}ne.invert=function(ze,We){if((mt=M(We))<$)return[ze,2*e(r(We))-w];var et=_,ot=25,bt,mt;do{var kt=n(et/2),fr=y(et/2);et-=bt=(U*(et-_)-c(fr)-mt)/(U-kt*kt/(2*fr))}while(M(bt)>m&&--ot>0);return[ze/(n(et)*(U-1/f(et))),v(We)*et]};function X(){return g.geoProjection(ne).scale(112.314)}function Q(ze){var We=2*l/ze;function et(ot,bt){var mt=g.geoAzimuthalEquidistantRaw(ot,bt);if(M(ot)>w){var kt=a(mt[1],mt[0]),fr=D(mt[0]*mt[0]+mt[1]*mt[1]),pr=We*p((kt-w)/We)+w,sr=a(f(kt-=pr),2-n(kt));kt=pr+z(l/fr*f(sr))-sr,mt[0]=fr*n(kt),mt[1]=fr*f(kt)}return mt}return et.invert=function(ot,bt){var mt=D(ot*ot+bt*bt);if(mt>w){var kt=a(bt,ot),fr=We*p((kt-w)/We)+w,pr=kt>fr?-1:1,sr=mt*n(fr-kt),xr=1/y(pr*I((sr-l)/D(l*(l-2*sr)+mt*mt)));kt=fr+2*e((xr+pr*D(xr*xr-3))/3),ot=mt*n(kt),bt=mt*f(kt)}return g.geoAzimuthalEquidistantRaw.invert(ot,bt)},et}function ie(){var ze=5,We=g.geoProjectionMutator(Q),et=We(ze),ot=et.stream,bt=.01,mt=-n(bt*k),kt=f(bt*k);return et.lobes=function(fr){return arguments.length?We(ze=+fr):ze},et.stream=function(fr){var pr=et.rotate(),sr=ot(fr),xr=(et.rotate([0,0]),ot(fr));return et.rotate(pr),sr.sphere=function(){xr.polygonStart(),xr.lineStart();for(var Dr=0,Xr=360/ze,qr=2*l/ze,bn=90-180/ze,Dn=w;Dr<ze;++Dr,bn-=Xr,Dn-=qr)xr.point(a(kt*n(Dn),mt)*T,z(kt*f(Dn))*T),bn<-90?(xr.point(-90,-180-bn-bt),xr.point(-90,-180-bn+bt)):(xr.point(90,bn+bt),xr.point(90,bn-bt));xr.lineEnd(),xr.polygonEnd()},sr},et.scale(87.8076).center([0,17.1875]).clipAngle(180-.001)}function se(ze,We){if(arguments.length<2&&(We=ze),We===1)return g.geoAzimuthalEqualAreaRaw;if(We===1/0)return ae;function et(ot,bt){var mt=g.geoAzimuthalEqualAreaRaw(ot/We,bt);return mt[0]*=ze,mt}return et.invert=function(ot,bt){var mt=g.geoAzimuthalEqualAreaRaw.invert(ot/ze,bt);return mt[0]*=We,mt},et}function ae(ze,We){return[ze*n(We)/n(We/=2),2*f(We)]}ae.invert=function(ze,We){var et=2*z(We/2);return[ze*n(et/2)/n(et),et]};function oe(){var ze=2,We=g.geoProjectionMutator(se),et=We(ze);return et.coefficient=function(ot){return arguments.length?We(ze=+ot):ze},et.scale(169.529)}function be(ze,We,et){var ot=100,bt,mt,kt;et=et===void 0?0:+et,We=+We;do mt=ze(et),kt=ze(et+o),mt===kt&&(kt=mt+o),et-=bt=-1*o*(mt-We)/(mt-kt);while(ot-- >0&&M(bt)>o);return ot<0?NaN:et}function ce(ze,We,et){return We===void 0&&(We=40),et===void 0&&(et=m),function(ot,bt,mt,kt){var fr,pr,sr;mt=mt===void 0?0:+mt,kt=kt===void 0?0:+kt;for(var xr=0;xr<We;xr++){var Dr=ze(mt,kt),Xr=Dr[0]-ot,qr=Dr[1]-bt;if(M(Xr)<et&&M(qr)<et)break;var bn=Xr*Xr+qr*qr;if(bn>fr){mt-=pr/=2,kt-=sr/=2;continue}fr=bn;var Dn=(mt>0?-1:1)*et,Wn=(kt>0?-1:1)*et,ga=ze(mt+Dn,kt),xa=ze(mt,kt+Wn),Ka=(ga[0]-Dr[0])/Dn,Ya=(ga[1]-Dr[1])/Dn,ei=(xa[0]-Dr[0])/Wn,hi=(xa[1]-Dr[1])/Wn,oo=hi*Ka-Ya*ei,ri=(M(oo)<.5?.5:1)/oo;if(pr=(qr*ei-Xr*hi)*ri,sr=(Xr*Ya-qr*Ka)*ri,mt+=pr,kt+=sr,M(pr)<et&&M(sr)<et)break}return[mt,kt]}}function de(){var ze=se(1.68,2),We=1.4,et=12;function ot(bt,mt){if(bt+mt<-We){var kt=(bt-mt+1.6)*(bt+mt+We)/8;bt+=kt,mt-=.8*kt*f(mt+l/2)}var fr=ze(bt,mt),pr=(1-n(bt*mt))/et;return fr[1]<0&&(fr[0]*=1+pr),fr[1]>0&&(fr[1]*=1+pr/1.5*fr[0]*fr[0]),fr}return ot.invert=ce(ot),ot}function ye(){return g.geoProjection(de()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])}function ge(ze,We){var et=ze*f(We),ot=30,bt;do We-=bt=(We+f(We)-et)/(1+n(We));while(M(bt)>o&&--ot>0);return We/2}function me(ze,We,et){function ot(bt,mt){return[ze*bt*n(mt=ge(et,mt)),We*f(mt)]}return ot.invert=function(bt,mt){return mt=z(mt/We),[bt/(ze*n(mt)),z((2*mt+f(2*mt))/et)]},ot}var Ee=me(b/w,b,l);function Pe(){return g.geoProjection(Ee).scale(169.529)}var Ne=2.00276,we=1.11072;function ke(ze,We){var et=ge(l,We);return[Ne*ze/(1/n(We)+we/n(et)),(We+b*f(et))/Ne]}ke.invert=function(ze,We){var et=Ne*We,ot=We<0?-_:_,bt=25,mt,kt;do kt=et-b*f(ot),ot-=mt=(f(2*ot)+2*ot-l*f(kt))/(2*n(2*ot)+2+l*n(kt)*b*n(ot));while(M(mt)>o&&--bt>0);return kt=et-b*f(ot),[ze*(1/n(kt)+we/n(ot))/Ne,kt]};function Xe(){return g.geoProjection(ke).scale(160.857)}function He(ze){var We=0,et=g.geoProjectionMutator(ze),ot=et(We);return ot.parallel=function(bt){return arguments.length?et(We=bt*k):We*T},ot}function Ie(ze,We){return[ze*n(We),We]}Ie.invert=function(ze,We){return[ze/n(We),We]};function De(){return g.geoProjection(Ie).scale(152.63)}function Ge(ze){if(!ze)return Ie;var We=1/y(ze);function et(ot,bt){var mt=We+ze-bt,kt=mt&&ot*n(bt)/mt;return[mt*f(kt),We-mt*n(kt)]}return et.invert=function(ot,bt){var mt=D(ot*ot+(bt=We-bt)*bt),kt=We+ze-mt;return[mt/n(kt)*a(ot,bt),kt]},et}function ht(){return He(Ge).scale(123.082).center([0,26.1441]).parallel(45)}function Rt(ze){function We(et,ot){var bt=w-ot,mt=bt&&et*ze*f(bt)/bt;return[bt*f(mt)/ze,w-bt*n(mt)]}return We.invert=function(et,ot){var bt=et*ze,mt=w-ot,kt=D(bt*bt+mt*mt),fr=a(bt,mt);return[(kt?kt/f(kt):1)*fr/ze,w-kt]},We}function Kt(){var ze=.5,We=g.geoProjectionMutator(Rt),et=We(ze);return et.fraction=function(ot){return arguments.length?We(ze=+ot):ze},et.scale(158.837)}var It=me(1,4/l,l);function Mt(){return g.geoProjection(It).scale(152.63)}function Yt(ze,We,et,ot,bt,mt){var kt=n(mt),fr;if(M(ze)>1||M(mt)>1)fr=I(et*bt+We*ot*kt);else{var pr=f(ze/2),sr=f(mt/2);fr=2*z(D(pr*pr+We*ot*sr*sr))}return M(fr)>o?[fr,a(ot*f(mt),We*bt-et*ot*kt)]:[0,0]}function zt(ze,We,et){return I((ze*ze+We*We-et*et)/(2*ze*We))}function St(ze){return ze-2*l*t((ze+l)/(2*l))}function Ye(ze,We,et){for(var ot=[[ze[0],ze[1],f(ze[1]),n(ze[1])],[We[0],We[1],f(We[1]),n(We[1])],[et[0],et[1],f(et[1]),n(et[1])]],bt=ot[2],mt,kt=0;kt<3;++kt,bt=mt)mt=ot[kt],bt.v=Yt(mt[1]-bt[1],bt[3],bt[2],mt[3],mt[2],mt[0]-bt[0]),bt.point=[0,0];var fr=zt(ot[0].v[0],ot[2].v[0],ot[1].v[0]),pr=zt(ot[0].v[0],ot[1].v[0],ot[2].v[0]),sr=l-fr;ot[2].point[1]=0,ot[0].point[0]=-(ot[1].point[0]=ot[0].v[0]/2);var xr=[ot[2].point[0]=ot[0].point[0]+ot[2].v[0]*n(fr),2*(ot[0].point[1]=ot[1].point[1]=ot[2].v[0]*f(fr))];function Dr(Xr,qr){var bn=f(qr),Dn=n(qr),Wn=new Array(3),ga;for(ga=0;ga<3;++ga){var xa=ot[ga];if(Wn[ga]=Yt(qr-xa[1],xa[3],xa[2],Dn,bn,Xr-xa[0]),!Wn[ga][0])return xa.point;Wn[ga][1]=St(Wn[ga][1]-xa.v[1])}var Ka=xr.slice();for(ga=0;ga<3;++ga){var Ya=ga==2?0:ga+1,ei=zt(ot[ga].v[0],Wn[ga][0],Wn[Ya][0]);Wn[ga][1]<0&&(ei=-ei),ga?ga==1?(ei=pr-ei,Ka[0]-=Wn[ga][0]*n(ei),Ka[1]-=Wn[ga][0]*f(ei)):(ei=sr-ei,Ka[0]+=Wn[ga][0]*n(ei),Ka[1]+=Wn[ga][0]*f(ei)):(Ka[0]+=Wn[ga][0]*n(ei),Ka[1]-=Wn[ga][0]*f(ei))}return Ka[0]/=3,Ka[1]/=3,Ka}return Dr}function rt(ze){return ze[0]*=k,ze[1]*=k,ze}function Ve(){return Ae([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])}function Ae(ze,We,et){var ot=g.geoCentroid({type:"MultiPoint",coordinates:[ze,We,et]}),bt=[-ot[0],-ot[1]],mt=g.geoRotation(bt),kt=Ye(rt(mt(ze)),rt(mt(We)),rt(mt(et)));kt.invert=ce(kt);var fr=g.geoProjection(kt).rotate(bt),pr=fr.center;return delete fr.rotate,fr.center=function(sr){return arguments.length?pr(mt(sr)):mt.invert(pr())},fr.clipAngle(90)}function Ue(ze,We){var et=D(1-f(We));return[2/u*ze*et,u*(1-et)]}Ue.invert=function(ze,We){var et=(et=We/u-1)*et;return[et>0?ze*D(l/et)/2:0,z(1-et)]};function Ze(){return g.geoProjection(Ue).scale(95.6464).center([0,30])}function Qe(ze){var We=y(ze);function et(ot,bt){return[ot,(ot?ot/f(ot):1)*(f(bt)*n(ot)-We*n(bt))]}return et.invert=We?function(ot,bt){ot&&(bt*=f(ot)/ot);var mt=n(ot);return[ot,2*a(D(mt*mt+We*We-bt*bt)-mt,We-bt)]}:function(ot,bt){return[ot,z(ot?bt*y(ot)/ot:bt)]},et}function _t(){return He(Qe).scale(249.828).clipAngle(90)}var gt=D(3);function wt(ze,We){return[gt*ze*(2*n(2*We/3)-1)/u,gt*u*f(We/3)]}wt.invert=function(ze,We){var et=3*z(We/(gt*u));return[u*ze/(gt*(2*n(2*et/3)-1)),et]};function Ut(){return g.geoProjection(wt).scale(156.19)}function Dt(ze){var We=n(ze);function et(ot,bt){return[ot*We,f(bt)/We]}return et.invert=function(ot,bt){return[ot/We,z(bt*We)]},et}function Nt(){return He(Dt).parallel(38.58).scale(195.044)}function Xt(ze){var We=n(ze);function et(ot,bt){return[ot*We,(1+We)*y(bt/2)]}return et.invert=function(ot,bt){return[ot/We,e(bt/(1+We))*2]},et}function Ht(){return He(Xt).scale(124.75)}function ar(ze,We){var et=D(8/(3*l));return[et*ze*(1-M(We)/l),et*We]}ar.invert=function(ze,We){var et=D(8/(3*l)),ot=We/et;return[ze/(et*(1-M(ot)/l)),ot]};function Vr(){return g.geoProjection(ar).scale(165.664)}function nn(ze,We){var et=D(4-3*f(M(We)));return[2/D(6*l)*ze*et,v(We)*D(2*l/3)*(2-et)]}nn.invert=function(ze,We){var et=2-M(We)/D(2*l/3);return[ze*D(6*l)/(2*et),v(We)*z((4-et*et)/3)]};function jr(){return g.geoProjection(nn).scale(165.664)}function at(ze,We){var et=D(l*(4+l));return[2/et*ze*(1+D(1-4*We*We/(l*l))),4/et*We]}at.invert=function(ze,We){var et=D(l*(4+l))/2;return[ze*et/(1+D(1-We*We*(4+l)/(4*l))),We*et/2]};function $t(){return g.geoProjection(at).scale(180.739)}function Zt(ze,We){var et=(2+w)*f(We);We/=2;for(var ot=0,bt=1/0;ot<10&&M(bt)>o;ot++){var mt=n(We);We-=bt=(We+f(We)*(mt+2)-et)/(2*mt*(1+mt))}return[2/D(l*(4+l))*ze*(1+n(We)),2*D(l/(4+l))*f(We)]}Zt.invert=function(ze,We){var et=We*D((4+l)/l)/2,ot=z(et),bt=n(ot);return[ze/(2/D(l*(4+l))*(1+bt)),z((ot+et*(bt+2))/(2+w))]};function ur(){return g.geoProjection(Zt).scale(180.739)}function wr(ze,We){return[ze*(1+n(We))/D(2+l),2*We/D(2+l)]}wr.invert=function(ze,We){var et=D(2+l),ot=We*et/2;return[et*ze/(1+n(ot)),ot]};function $e(){return g.geoProjection(wr).scale(173.044)}function Je(ze,We){for(var et=(1+w)*f(We),ot=0,bt=1/0;ot<10&&M(bt)>o;ot++)We-=bt=(We+f(We)-et)/(1+n(We));return et=D(2+l),[ze*(1+n(We))/et,2*We/et]}Je.invert=function(ze,We){var et=1+w,ot=D(et/2);return[ze*2*ot/(1+n(We*=ot)),z((We+f(We))/et)]};function it(){return g.geoProjection(Je).scale(173.044)}var lt=3+2*b;function Tt(ze,We){var et=f(ze/=2),ot=n(ze),bt=D(n(We)),mt=n(We/=2),kt=f(We)/(mt+b*ot*bt),fr=D(2/(1+kt*kt)),pr=D((b*mt+(ot+et)*bt)/(b*mt+(ot-et)*bt));return[lt*(fr*(pr-1/pr)-2*c(pr)),lt*(fr*kt*(pr+1/pr)-2*e(kt))]}Tt.invert=function(ze,We){if(!(mt=q.invert(ze/1.2,We*1.065)))return null;var et=mt[0],ot=mt[1],bt=20,mt;ze/=lt,We/=lt;do{var kt=et/2,fr=ot/2,pr=f(kt),sr=n(kt),xr=f(fr),Dr=n(fr),Xr=n(ot),qr=D(Xr),bn=xr/(Dr+b*sr*qr),Dn=bn*bn,Wn=D(2/(1+Dn)),ga=b*Dr+(sr+pr)*qr,xa=b*Dr+(sr-pr)*qr,Ka=ga/xa,Ya=D(Ka),ei=Ya-1/Ya,hi=Ya+1/Ya,oo=Wn*ei-2*c(Ya)-ze,ri=Wn*bn*hi-2*e(bn)-We,Yi=xr&&h*qr*pr*Dn/xr,co=(b*sr*Dr+qr)/(2*(Dr+b*sr*qr)*(Dr+b*sr*qr)*qr),wo=-.5*bn*Wn*Wn*Wn,bi=wo*Yi,Mi=wo*co,cs=(cs=2*Dr+b*qr*(sr-pr))*cs*Ya,yo=(b*sr*Dr*qr+Xr)/cs,Do=-(b*pr*xr)/(qr*cs),Yo=ei*bi-2*yo/Ya+Wn*(yo+yo/Ka),le=ei*Mi-2*Do/Ya+Wn*(Do+Do/Ka),_e=bn*hi*bi-2*Yi/(1+Dn)+Wn*hi*Yi+Wn*bn*(yo-yo/Ka),Le=bn*hi*Mi-2*co/(1+Dn)+Wn*hi*co+Wn*bn*(Do-Do/Ka),Be=le*_e-Le*Yo;if(!Be)break;var Oe=(ri*le-oo*Le)/Be,Ke=(oo*_e-ri*Yo)/Be;et-=Oe,ot=s(-w,i(w,ot-Ke))}while((M(Oe)>o||M(Ke)>o)&&--bt>0);return M(M(ot)-w)<o?[0,ot]:bt&&[et,ot]};function Bt(){return g.geoProjection(Tt).scale(62.5271)}var Ce=n(35*k);function Me(ze,We){var et=y(We/2);return[ze*Ce*D(1-et*et),(1+Ce)*et]}Me.invert=function(ze,We){var et=We/(1+Ce);return[ze&&ze/(Ce*D(1-et*et)),2*e(et)]};function nt(){return g.geoProjection(Me).scale(137.152)}function st(ze,We){var et=We/2,ot=n(et);return[2*ze/u*n(We)*ot*ot,u*y(et)]}st.invert=function(ze,We){var et=e(We/u),ot=n(et),bt=2*et;return[ze*u/2/(n(bt)*ot*ot),bt]};function ct(){return g.geoProjection(st).scale(135.264)}function At(ze){var We=1-ze,et=mt(l,0)[0]-mt(-l,0)[0],ot=mt(0,w)[1]-mt(0,-w)[1],bt=D(2*ot/et);function mt(pr,sr){var xr=n(sr),Dr=f(sr);return[xr/(We+ze*xr)*pr,We*sr+ze*Dr]}function kt(pr,sr){var xr=mt(pr,sr);return[xr[0]*bt,xr[1]/bt]}function fr(pr){return kt(0,pr)[1]}return kt.invert=function(pr,sr){var xr=be(fr,sr),Dr=pr/bt*(ze+We/n(xr));return[Dr,xr]},kt}function dt(){var ze=.5,We=g.geoProjectionMutator(At),et=We(ze);return et.alpha=function(ot){return arguments.length?We(ze=+ot):ze},et.scale(168.725)}function Ct(ze){return[ze[0]/2,z(y(ze[1]/2*k))*T]}function Gt(ze){return[ze[0]*2,2*e(f(ze[1]*k))*T]}function rr(ze){ze==null&&(ze=g.geoOrthographic);var We=ze(),et=g.geoEquirectangular().scale(T).precision(0).clipAngle(null).translate([0,0]);function ot(mt){return We(Ct(mt))}We.invert&&(ot.invert=function(mt){return Gt(We.invert(mt))}),ot.stream=function(mt){var kt=We.stream(mt),fr=et.stream({point:function(pr,sr){kt.point(pr/2,z(y(-sr/2*k))*T)},lineStart:function(){kt.lineStart()},lineEnd:function(){kt.lineEnd()},polygonStart:function(){kt.polygonStart()},polygonEnd:function(){kt.polygonEnd()}});return fr.sphere=kt.sphere,fr};function bt(mt){ot[mt]=function(){return arguments.length?(We[mt].apply(We,arguments),ot):We[mt]()}}return ot.rotate=function(mt){return arguments.length?(et.rotate(mt),ot):et.rotate()},ot.center=function(mt){return arguments.length?(We.center(Ct(mt)),ot):Gt(We.center())},bt("angle"),bt("clipAngle"),bt("clipExtent"),bt("fitExtent"),bt("fitHeight"),bt("fitSize"),bt("fitWidth"),bt("scale"),bt("translate"),bt("precision"),ot.scale(249.5)}function kr(ze,We){var et=2*l/We,ot=ze*ze;function bt(mt,kt){var fr=g.geoAzimuthalEquidistantRaw(mt,kt),pr=fr[0],sr=fr[1],xr=pr*pr+sr*sr;if(xr>ot){var Dr=D(xr),Xr=a(sr,pr),qr=et*p(Xr/et),bn=Xr-qr,Dn=ze*n(bn),Wn=(ze*f(bn)-bn*f(Dn))/(w-Dn),ga=br(bn,Wn),xa=(l-ze)/Ar(ga,Dn,l);pr=Dr;var Ka=50,Ya;do pr-=Ya=(ze+Ar(ga,Dn,pr)*xa-Dr)/(ga(pr)*xa);while(M(Ya)>o&&--Ka>0);sr=bn*f(pr),pr<w&&(sr-=Wn*(pr-w));var ei=f(qr),hi=n(qr);fr[0]=pr*hi-sr*ei,fr[1]=pr*ei+sr*hi}return fr}return bt.invert=function(mt,kt){var fr=mt*mt+kt*kt;if(fr>ot){var pr=D(fr),sr=a(kt,mt),xr=et*p(sr/et),Dr=sr-xr;mt=pr*n(Dr),kt=pr*f(Dr);for(var Xr=mt-w,qr=f(mt),bn=kt/qr,Dn=mt<w?1/0:0,Wn=10;;){var ga=ze*f(bn),xa=ze*n(bn),Ka=f(xa),Ya=w-xa,ei=(ga-bn*Ka)/Ya,hi=br(bn,ei);if(M(Dn)<m||!--Wn)break;bn-=Dn=(bn*qr-ei*Xr-kt)/(qr-Xr*2*(Ya*(xa+bn*ga*n(xa)-Ka)-ga*(ga-bn*Ka))/(Ya*Ya))}pr=ze+Ar(hi,xa,mt)*(l-ze)/Ar(hi,xa,l),sr=xr+bn,mt=pr*n(sr),kt=pr*f(sr)}return g.geoAzimuthalEquidistantRaw.invert(mt,kt)},bt}function br(ze,We){return function(et){var ot=ze*n(et);return et<w&&(ot-=We),D(1+ot*ot)}}function Ar(ze,We,et){for(var ot=50,bt=(et-We)/ot,mt=ze(We)+ze(et),kt=1,fr=We;kt<ot;++kt)mt+=2*ze(fr+=bt);return mt*.5*bt}function Wr(){var ze=6,We=30*k,et=n(We),ot=f(We),bt=g.geoProjectionMutator(kr),mt=bt(We,ze),kt=mt.stream,fr=.01,pr=-n(fr*k),sr=f(fr*k);return mt.radius=function(xr){return arguments.length?(et=n(We=xr*k),ot=f(We),bt(We,ze)):We*T},mt.lobes=function(xr){return arguments.length?bt(We,ze=+xr):ze},mt.stream=function(xr){var Dr=mt.rotate(),Xr=kt(xr),qr=(mt.rotate([0,0]),kt(xr));return mt.rotate(Dr),Xr.sphere=function(){qr.polygonStart(),qr.lineStart();for(var bn=0,Dn=2*l/ze,Wn=0;bn<ze;++bn,Wn-=Dn)qr.point(a(sr*n(Wn),pr)*T,z(sr*f(Wn))*T),qr.point(a(ot*n(Wn-Dn/2),et)*T,z(ot*f(Wn-Dn/2))*T);qr.lineEnd(),qr.polygonEnd()},Xr},mt.rotate([90,-40]).scale(91.7095).clipAngle(180-.001)}function nr(ze,We,et,ot,bt,mt,kt,fr){arguments.length<8&&(fr=0);function pr(sr,xr){if(!xr)return[ze*sr/l,0];var Dr=xr*xr,Xr=ze+Dr*(We+Dr*(et+Dr*ot)),qr=xr*(bt-1+Dr*(mt-fr+Dr*kt)),bn=(Xr*Xr+qr*qr)/(2*qr),Dn=sr*z(Xr/bn)/l;return[bn*f(Dn),xr*(1+Dr*fr)+bn*(1-n(Dn))]}return pr.invert=function(sr,xr){var Dr=l*sr/ze,Xr=xr,qr,bn,Dn=50;do{var Wn=Xr*Xr,ga=ze+Wn*(We+Wn*(et+Wn*ot)),xa=Xr*(bt-1+Wn*(mt-fr+Wn*kt)),Ka=ga*ga+xa*xa,Ya=2*xa,ei=Ka/Ya,hi=ei*ei,oo=z(ga/ei)/l,ri=Dr*oo,Yi=ga*ga,co=(2*We+Wn*(4*et+Wn*6*ot))*Xr,wo=bt+Wn*(3*mt+Wn*5*kt),bi=2*(ga*co+xa*(wo-1)),Mi=2*(wo-1),cs=(bi*Ya-Ka*Mi)/(Ya*Ya),yo=n(ri),Do=f(ri),Yo=ei*yo,le=ei*Do,_e=Dr/l*(1/D(1-Yi/hi))*(co*ei-ga*cs)/hi,Le=le-sr,Be=Xr*(1+Wn*fr)+ei-Yo-xr,Oe=cs*Do+Yo*_e,Ke=Yo*oo,xt=1+cs-(cs*yo-le*_e),vt=le*oo,Pt=Oe*vt-xt*Ke;if(!Pt)break;Dr-=qr=(Be*Oe-Le*xt)/Pt,Xr-=bn=(Le*vt-Be*Ke)/Pt}while((M(qr)>o||M(bn)>o)&&--Dn>0);return[Dr,Xr]},pr}var yr=nr(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);function Pr(){return g.geoProjection(yr).scale(149.995)}var Or=nr(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);function Sr(){return g.geoProjection(Or).scale(153.93)}var tt=nr(5/6*l,-.62636,-.0344,0,1.3493,-.05524,0,.045);function Lt(){return g.geoProjection(tt).scale(130.945)}function Wt(ze,We){var et=ze*ze,ot=We*We;return[ze*(1-.162388*ot)*(.87-952426e-9*et*et),We*(1+ot/12)]}Wt.invert=function(ze,We){var et=ze,ot=We,bt=50,mt;do{var kt=ot*ot;ot-=mt=(ot*(1+kt/12)-We)/(1+kt/4)}while(M(mt)>o&&--bt>0);bt=50,ze/=1-.162388*kt;do{var fr=(fr=et*et)*fr;et-=mt=(et*(.87-952426e-9*fr)-ze)/(.87-.00476213*fr)}while(M(mt)>o&&--bt>0);return[et,ot]};function ir(){return g.geoProjection(Wt).scale(131.747)}var Ir=nr(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function Br(){return g.geoProjection(Ir).scale(131.087)}function Er(ze){var We=ze(w,0)[0]-ze(-w,0)[0];function et(ot,bt){var mt=ot>0?-.5:.5,kt=ze(ot+mt*l,bt);return kt[0]-=mt*We,kt}return ze.invert&&(et.invert=function(ot,bt){var mt=ot>0?-.5:.5,kt=ze.invert(ot+mt*We,bt),fr=kt[0]-mt*l;return fr<-l?fr+=2*l:fr>l&&(fr-=2*l),kt[0]=fr,kt}),et}function _r(ze,We){var et=v(ze),ot=v(We),bt=n(We),mt=n(ze)*bt,kt=f(ze)*bt,fr=f(ot*We);ze=M(a(kt,fr)),We=z(mt),M(ze-w)>o&&(ze%=w);var pr=Gr(ze>l/4?w-ze:ze,We);return ze>l/4&&(fr=pr[0],pr[0]=-pr[1],pr[1]=-fr),pr[0]*=et,pr[1]*=-ot,pr}_r.invert=function(ze,We){M(ze)>1&&(ze=v(ze)*2-ze),M(We)>1&&(We=v(We)*2-We);var et=v(ze),ot=v(We),bt=-et*ze,mt=-ot*We,kt=mt/bt<1,fr=wn(kt?mt:bt,kt?bt:mt),pr=fr[0],sr=fr[1],xr=n(sr);return kt&&(pr=-w-pr),[et*(a(f(pr)*xr,-f(sr))+l),ot*z(n(pr)*xr)]};function Gr(ze,We){if(We===w)return[0,0];var et=f(We),ot=et*et,bt=ot*ot,mt=1+bt,kt=1+3*bt,fr=1-bt,pr=z(1/D(mt)),sr=fr+ot*mt*pr,xr=(1-et)/sr,Dr=D(xr),Xr=xr*mt,qr=D(Xr),bn=Dr*fr,Dn,Wn;if(ze===0)return[0,-(bn+ot*qr)];var ga=n(We),xa=1/ga,Ka=2*et*ga,Ya=(-3*ot+pr*kt)*Ka,ei=(-sr*ga-(1-et)*Ya)/(sr*sr),hi=.5*ei/Dr,oo=fr*hi-2*ot*Dr*Ka,ri=ot*mt*ei+xr*kt*Ka,Yi=-xa*Ka,co=-xa*ri,wo=-2*xa*oo,bi=4*ze/l,Mi;if(ze>.222*l||We<l/4&&ze>.175*l){if(Dn=(bn+ot*D(Xr*(1+bt)-bn*bn))/(1+bt),ze>l/4)return[Dn,Dn];var cs=Dn,yo=.5*Dn;Dn=.5*(yo+cs),Wn=50;do{var Do=D(Xr-Dn*Dn),Yo=Dn*(wo+Yi*Do)+co*z(Dn/qr)-bi;if(!Yo)break;Yo<0?yo=Dn:cs=Dn,Dn=.5*(yo+cs)}while(M(cs-yo)>o&&--Wn>0)}else{Dn=o,Wn=25;do{var le=Dn*Dn,_e=D(Xr-le),Le=wo+Yi*_e,Be=Dn*Le+co*z(Dn/qr)-bi,Oe=Le+(co-Yi*le)/_e;Dn-=Mi=_e?Be/Oe:0}while(M(Mi)>o&&--Wn>0)}return[Dn,-bn-ot*D(Xr-Dn*Dn)]}function wn(ze,We){for(var et=0,ot=1,bt=.5,mt=50;;){var kt=bt*bt,fr=D(bt),pr=z(1/D(1+kt)),sr=1-kt+bt*(1+kt)*pr,xr=(1-fr)/sr,Dr=D(xr),Xr=xr*(1+kt),qr=Dr*(1-kt),bn=Xr-ze*ze,Dn=D(bn),Wn=We+qr+bt*Dn;if(M(ot-et)<m||--mt===0||Wn===0)break;Wn>0?et=bt:ot=bt,bt=.5*(et+ot)}if(!mt)return null;var ga=z(fr),xa=n(ga),Ka=1/xa,Ya=2*fr*xa,ei=(-3*bt+pr*(1+3*kt))*Ya,hi=(-sr*xa-(1-fr)*ei)/(sr*sr),oo=.5*hi/Dr,ri=(1-kt)*oo-2*bt*Dr*Ya,Yi=-2*Ka*ri,co=-Ka*Ya,wo=-Ka*(bt*(1+kt)*hi+xr*(1+3*kt)*Ya);return[l/4*(ze*(Yi+co*Dn)+wo*z(ze/D(Xr))),ga]}function cn(){return g.geoProjection(Er(_r)).scale(239.75)}function Bn(ze,We,et){var ot,bt,mt;return ze?(ot=En(ze,et),We?(bt=En(We,1-et),mt=bt[1]*bt[1]+et*ot[0]*ot[0]*bt[0]*bt[0],[[ot[0]*bt[2]/mt,ot[1]*ot[2]*bt[0]*bt[1]/mt],[ot[1]*bt[1]/mt,-ot[0]*ot[2]*bt[0]*bt[2]/mt],[ot[2]*bt[1]*bt[2]/mt,-et*ot[0]*ot[1]*bt[0]/mt]]):[[ot[0],0],[ot[1],0],[ot[2],0]]):(bt=En(We,1-et),[[0,bt[0]/bt[1]],[1/bt[1],0],[bt[2]/bt[1],0]])}function En(ze,We){var et,ot,bt,mt,kt;if(We<o)return mt=f(ze),ot=n(ze),et=We*(ze-mt*ot)/4,[mt-et*ot,ot+et*mt,1-We*mt*mt/2,ze-et];if(We>=1-o)return et=(1-We)/4,ot=F(ze),mt=R(ze),bt=1/ot,kt=ot*O(ze),[mt+et*(kt-ze)/(ot*ot),bt-et*mt*bt*(kt-ze),bt+et*mt*bt*(kt+ze),2*e(r(ze))-w+et*(kt-ze)/ot];var fr=[1,0,0,0,0,0,0,0,0],pr=[D(We),0,0,0,0,0,0,0,0],sr=0;for(ot=D(1-We),kt=1;M(pr[sr]/fr[sr])>o&&sr<8;)et=fr[sr++],pr[sr]=(et-ot)/2,fr[sr]=(et+ot)/2,ot=D(et*ot),kt*=2;bt=kt*fr[sr]*ze;do mt=pr[sr]*f(ot=bt)/fr[sr],bt=(z(mt)+bt)/2;while(--sr);return[f(bt),mt=n(bt),mt/n(bt-ot),bt]}function Yn(ze,We,et){var ot=M(ze),bt=M(We),mt=O(bt);if(ot){var kt=1/f(ot),fr=1/(y(ot)*y(ot)),pr=-(fr+et*(mt*mt*kt*kt)-1+et),sr=(et-1)*fr,xr=(-pr+D(pr*pr-4*sr))/2;return[Hn(e(1/D(xr)),et)*v(ze),Hn(e(D((xr/fr-1)/et)),1-et)*v(We)]}return[0,Hn(e(mt),1-et)*v(We)]}function Hn(ze,We){if(!We)return ze;if(We===1)return c(y(ze/2+_));for(var et=1,ot=D(1-We),bt=D(We),mt=0;M(bt)>o;mt++){if(ze%l){var kt=e(ot*y(ze)/et);kt<0&&(kt+=l),ze+=kt+~~(ze/l)*l}else ze+=ze;bt=(et+ot)/2,ot=D(et*ot),bt=((et=bt)-ot)/2}return ze/(x(2,mt)*et)}function pa(ze,We){var et=(b-1)/(b+1),ot=D(1-et*et),bt=Hn(w,ot*ot),mt=-1,kt=c(y(l/4+M(We)/2)),fr=r(mt*kt)/D(et),pr=Ma(fr*n(mt*ze),fr*f(mt*ze)),sr=Yn(pr[0],pr[1],ot*ot);return[-sr[1],(We>=0?1:-1)*(.5*bt-sr[0])]}function Ma(ze,We){var et=ze*ze,ot=We+1,bt=1-et-We*We;return[.5*((ze>=0?w:-w)-a(bt,2*ze)),-.25*c(bt*bt+4*et)+.5*c(ot*ot+et)]}function ci(ze,We){var et=We[0]*We[0]+We[1]*We[1];return[(ze[0]*We[0]+ze[1]*We[1])/et,(ze[1]*We[0]-ze[0]*We[1])/et]}pa.invert=function(ze,We){var et=(b-1)/(b+1),ot=D(1-et*et),bt=Hn(w,ot*ot),mt=-1,kt=Bn(.5*bt-We,-ze,ot*ot),fr=ci(kt[0],kt[1]),pr=a(fr[1],fr[0])/mt;return[pr,2*e(r(.5/mt*c(et*fr[0]*fr[0]+et*fr[1]*fr[1])))-w]};function Ha(){return g.geoProjection(Er(pa)).scale(151.496)}function ja(ze){var We=f(ze),et=n(ze),ot=Wa(ze);ot.invert=Wa(-ze);function bt(mt,kt){var fr=ot(mt,kt);mt=fr[0],kt=fr[1];var pr=f(kt),sr=n(kt),xr=n(mt),Dr=I(We*pr+et*sr*xr),Xr=f(Dr),qr=M(Xr)>o?Dr/Xr:1;return[qr*et*f(mt),(M(mt)>w?qr:-qr)*(We*sr-et*pr*xr)]}return bt.invert=function(mt,kt){var fr=D(mt*mt+kt*kt),pr=-f(fr),sr=n(fr),xr=fr*sr,Dr=-kt*pr,Xr=fr*We,qr=D(xr*xr+Dr*Dr-Xr*Xr),bn=a(xr*Xr+Dr*qr,Dr*Xr-xr*qr),Dn=(fr>w?-1:1)*a(mt*pr,fr*n(bn)*sr+kt*f(bn)*pr);return ot.invert(Dn,bn)},bt}function Wa(ze){var We=f(ze),et=n(ze);return function(ot,bt){var mt=n(bt),kt=n(ot)*mt,fr=f(ot)*mt,pr=f(bt);return[a(fr,kt*et-pr*We),z(pr*et+kt*We)]}}function Tr(){var ze=0,We=g.geoProjectionMutator(ja),et=We(ze),ot=et.rotate,bt=et.stream,mt=g.geoCircle();return et.parallel=function(kt){if(!arguments.length)return ze*T;var fr=et.rotate();return We(ze=kt*k).rotate(fr)},et.rotate=function(kt){return arguments.length?(ot.call(et,[kt[0],kt[1]-ze*T]),mt.center([-kt[0],-kt[1]]),et):(kt=ot.call(et),kt[1]+=ze*T,kt)},et.stream=function(kt){return kt=bt(kt),kt.sphere=function(){kt.polygonStart();var fr=.01,pr=mt.radius(90-fr)().coordinates[0],sr=pr.length-1,xr=-1,Dr;for(kt.lineStart();++xr<sr;)kt.point((Dr=pr[xr])[0],Dr[1]);for(kt.lineEnd(),pr=mt.radius(90+fr)().coordinates[0],sr=pr.length-1,kt.lineStart();--xr>=0;)kt.point((Dr=pr[xr])[0],Dr[1]);kt.lineEnd(),kt.polygonEnd()},kt},et.scale(79.4187).parallel(45).clipAngle(180-.001)}var pn=3,fn=z(1-1/pn)*T,An=Dt(0);function Zn(ze){var We=fn*k,et=Ue(l,We)[0]-Ue(-l,We)[0],ot=An(0,We)[1],bt=Ue(0,We)[1],mt=u-bt,kt=L/ze,fr=4/L,pr=ot+mt*mt*4/L;function sr(xr,Dr){var Xr,qr=M(Dr);if(qr>We){var bn=i(ze-1,s(0,t((xr+l)/kt)));xr+=l*(ze-1)/ze-bn*kt,Xr=Ue(xr,qr),Xr[0]=Xr[0]*L/et-L*(ze-1)/(2*ze)+bn*L/ze,Xr[1]=ot+(Xr[1]-bt)*4*mt/L,Dr<0&&(Xr[1]=-Xr[1])}else Xr=An(xr,Dr);return Xr[0]*=fr,Xr[1]/=pr,Xr}return sr.invert=function(xr,Dr){xr/=fr,Dr*=pr;var Xr=M(Dr);if(Xr>ot){var qr=i(ze-1,s(0,t((xr+l)/kt)));xr=(xr+l*(ze-1)/ze-qr*kt)*et/L;var bn=Ue.invert(xr,.25*(Xr-ot)*L/mt+bt);return bn[0]-=l*(ze-1)/ze-qr*kt,Dr<0&&(bn[1]=-bn[1]),bn}return An.invert(xr,Dr)},sr}function ua(ze,We){return[ze,We&1?90-o:fn]}function ea(ze,We){return[ze,We&1?-90+o:-fn]}function Rn(ze){return[ze[0]*(1-o),ze[1]]}function Xn(ze){var We=[].concat(S.range(-180,180+ze/2,ze).map(ua),S.range(180,-180-ze/2,-ze).map(ea));return{type:"Polygon",coordinates:[ze===180?We.map(Rn):We]}}function Ua(){var ze=4,We=g.geoProjectionMutator(Zn),et=We(ze),ot=et.stream;return et.lobes=function(bt){return arguments.length?We(ze=+bt):ze},et.stream=function(bt){var mt=et.rotate(),kt=ot(bt),fr=(et.rotate([0,0]),ot(bt));return et.rotate(mt),kt.sphere=function(){g.geoStream(Xn(180/ze),fr)},kt},et.scale(239.75)}function li(ze){var We=1+ze,et=f(1/We),ot=z(et),bt=2*D(l/(mt=l+4*ot*We)),mt,kt=.5*bt*(We+D(ze*(2+ze))),fr=ze*ze,pr=We*We;function sr(xr,Dr){var Xr=1-f(Dr),qr,bn;if(Xr&&Xr<2){var Dn=w-Dr,Wn=25,ga;do{var xa=f(Dn),Ka=n(Dn),Ya=ot+a(xa,We-Ka),ei=1+pr-2*We*Ka;Dn-=ga=(Dn-fr*ot-We*xa+ei*Ya-.5*Xr*mt)/(2*We*xa*Ya)}while(M(ga)>m&&--Wn>0);qr=bt*D(ei),bn=xr*Ya/l}else qr=bt*(ze+Xr),bn=xr*ot/l;return[qr*f(bn),kt-qr*n(bn)]}return sr.invert=function(xr,Dr){var Xr=xr*xr+(Dr-=kt)*Dr,qr=(1+pr-Xr/(bt*bt))/(2*We),bn=I(qr),Dn=f(bn),Wn=ot+a(Dn,We-qr);return[z(xr/D(Xr))*l/Wn,z(1-2*(bn-fr*ot-We*Dn+(1+pr-2*We*qr)*Wn)/mt)]},sr}function Vt(){var ze=1,We=g.geoProjectionMutator(li),et=We(ze);return et.ratio=function(ot){return arguments.length?We(ze=+ot):ze},et.scale(167.774).center([0,18.67])}var hr=.7109889596207567,rn=.0528035274542;function vn(ze,We){return We>-hr?(ze=Ee(ze,We),ze[1]+=rn,ze):Ie(ze,We)}vn.invert=function(ze,We){return We>-hr?Ee.invert(ze,We-rn):Ie.invert(ze,We)};function en(){return g.geoProjection(vn).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}function Tn(ze,We){return M(We)>hr?(ze=Ee(ze,We),ze[1]-=We>0?rn:-rn,ze):Ie(ze,We)}Tn.invert=function(ze,We){return M(We)>hr?Ee.invert(ze,We+(We>0?rn:-rn)):Ie.invert(ze,We)};function xn(){return g.geoProjection(Tn).scale(152.63)}function un(ze,We,et,ot){var bt=D(4*l/(2*et+(1+ze-We/2)*f(2*et)+(ze+We)/2*f(4*et)+We/2*f(6*et))),mt=D(ot*f(et)*D((1+ze*n(2*et)+We*n(4*et))/(1+ze+We))),kt=et*pr(1);function fr(Dr){return D(1+ze*n(2*Dr)+We*n(4*Dr))}function pr(Dr){var Xr=Dr*et;return(2*Xr+(1+ze-We/2)*f(2*Xr)+(ze+We)/2*f(4*Xr)+We/2*f(6*Xr))/et}function sr(Dr){return fr(Dr)*f(Dr)}var xr=function(Dr,Xr){var qr=et*be(pr,kt*f(Xr)/et,Xr/l);isNaN(qr)&&(qr=et*v(Xr));var bn=bt*fr(qr);return[bn*mt*Dr/l*n(qr),bn/mt*f(qr)]};return xr.invert=function(Dr,Xr){var qr=be(sr,Xr*mt/bt);return[Dr*l/(n(qr)*bt*mt*fr(qr)),z(et*pr(qr/et)/kt)]},et===0&&(bt=D(ot/l),xr=function(Dr,Xr){return[Dr*bt,f(Xr)/bt]},xr.invert=function(Dr,Xr){return[Dr/bt,z(Xr*bt)]}),xr}function gr(){var ze=1,We=0,et=45*k,ot=2,bt=g.geoProjectionMutator(un),mt=bt(ze,We,et,ot);return mt.a=function(kt){return arguments.length?bt(ze=+kt,We,et,ot):ze},mt.b=function(kt){return arguments.length?bt(ze,We=+kt,et,ot):We},mt.psiMax=function(kt){return arguments.length?bt(ze,We,et=+kt*k,ot):et*T},mt.ratio=function(kt){return arguments.length?bt(ze,We,et,ot=+kt):ot},mt.scale(180.739)}function mr(ze,We,et,ot,bt,mt,kt,fr,pr,sr,xr){if(xr.nanEncountered)return NaN;var Dr,Xr,qr,bn,Dn,Wn,ga,xa,Ka,Ya;if(Dr=et-We,Xr=ze(We+Dr*.25),qr=ze(et-Dr*.25),isNaN(Xr)){xr.nanEncountered=!0;return}if(isNaN(qr)){xr.nanEncountered=!0;return}return bn=Dr*(ot+4*Xr+bt)/12,Dn=Dr*(bt+4*qr+mt)/12,Wn=bn+Dn,Ya=(Wn-kt)/15,sr>pr?(xr.maxDepthCount++,Wn+Ya):Math.abs(Ya)<fr?Wn+Ya:(ga=We+Dr*.5,xa=mr(ze,We,ga,ot,Xr,bt,bn,fr*.5,pr,sr+1,xr),isNaN(xa)?(xr.nanEncountered=!0,NaN):(Ka=mr(ze,ga,et,bt,qr,mt,Dn,fr*.5,pr,sr+1,xr),isNaN(Ka)?(xr.nanEncountered=!0,NaN):xa+Ka))}function zr(ze,We,et,ot,bt){var mt={maxDepthCount:0,nanEncountered:!1};ot===void 0&&(ot=1e-8),bt===void 0&&(bt=20);var kt=ze(We),fr=ze(.5*(We+et)),pr=ze(et),sr=(kt+4*fr+pr)*(et-We)/6,xr=mr(ze,We,et,kt,fr,pr,sr,ot,bt,1,mt);return xr}function gn(ze,We,et){function ot(qr){return ze+(1-ze)*x(1-x(qr,We),1/We)}function bt(qr){return zr(ot,0,qr,1e-4)}for(var mt=1/bt(1),kt=1e3,fr=(1+1e-8)*mt,pr=[],sr=0;sr<=kt;sr++)pr.push(bt(sr/kt)*fr);function xr(qr){var bn=0,Dn=kt,Wn=kt>>1;do pr[Wn]>qr?Dn=Wn:bn=Wn,Wn=bn+Dn>>1;while(Wn>bn);var ga=pr[Wn+1]-pr[Wn];return ga&&(ga=(qr-pr[Wn+1])/ga),(Wn+1+ga)/kt}var Dr=2*xr(1)/l*mt/et,Xr=function(qr,bn){var Dn=xr(M(f(bn))),Wn=ot(Dn)*qr;return Dn/=Dr,[Wn,bn>=0?Dn:-Dn]};return Xr.invert=function(qr,bn){var Dn;return bn*=Dr,M(bn)<1&&(Dn=v(bn)*z(bt(M(bn))*mt)),[qr/ot(M(bn)),Dn]},Xr}function On(){var ze=0,We=2.5,et=1.183136,ot=g.geoProjectionMutator(gn),bt=ot(ze,We,et);return bt.alpha=function(mt){return arguments.length?ot(ze=+mt,We,et):ze},bt.k=function(mt){return arguments.length?ot(ze,We=+mt,et):We},bt.gamma=function(mt){return arguments.length?ot(ze,We,et=+mt):et},bt.scale(152.63)}function ta(ze,We){return M(ze[0]-We[0])<o&&M(ze[1]-We[1])<o}function _n(ze,We){for(var et=-1,ot=ze.length,bt=ze[0],mt,kt,fr,pr=[];++et<ot;){mt=ze[et],kt=(mt[0]-bt[0])/We,fr=(mt[1]-bt[1])/We;for(var sr=0;sr<We;++sr)pr.push([bt[0]+sr*kt,bt[1]+sr*fr]);bt=mt}return pr.push(mt),pr}function jn(ze){var We=[],et,ot,bt,mt,kt,fr,pr,sr=ze[0].length;for(pr=0;pr<sr;++pr)et=ze[0][pr],ot=et[0][0],bt=et[0][1],mt=et[1][1],kt=et[2][0],fr=et[2][1],We.push(_n([[ot+o,bt+o],[ot+o,mt-o],[kt-o,mt-o],[kt-o,fr+o]],30));for(pr=ze[1].length-1;pr>=0;--pr)et=ze[1][pr],ot=et[0][0],bt=et[0][1],mt=et[1][1],kt=et[2][0],fr=et[2][1],We.push(_n([[kt-o,fr-o],[kt-o,mt+o],[ot+o,mt+o],[ot+o,bt-o]],30));return{type:"Polygon",coordinates:[S.merge(We)]}}function aa(ze,We,et){var ot,bt;function mt(pr,sr){for(var xr=sr<0?-1:1,Dr=We[+(sr<0)],Xr=0,qr=Dr.length-1;Xr<qr&&pr>Dr[Xr][2][0];++Xr);var bn=ze(pr-Dr[Xr][1][0],sr);return bn[0]+=ze(Dr[Xr][1][0],xr*sr>xr*Dr[Xr][0][1]?Dr[Xr][0][1]:sr)[0],bn}et?mt.invert=et(mt):ze.invert&&(mt.invert=function(pr,sr){for(var xr=bt[+(sr<0)],Dr=We[+(sr<0)],Xr=0,qr=xr.length;Xr<qr;++Xr){var bn=xr[Xr];if(bn[0][0]<=pr&&pr<bn[1][0]&&bn[0][1]<=sr&&sr<bn[1][1]){var Dn=ze.invert(pr-ze(Dr[Xr][1][0],0)[0],sr);return Dn[0]+=Dr[Xr][1][0],ta(mt(Dn[0],Dn[1]),[pr,sr])?Dn:null}}});var kt=g.geoProjection(mt),fr=kt.stream;return kt.stream=function(pr){var sr=kt.rotate(),xr=fr(pr),Dr=(kt.rotate([0,0]),fr(pr));return kt.rotate(sr),xr.sphere=function(){g.geoStream(ot,Dr)},xr},kt.lobes=function(pr){return arguments.length?(ot=jn(pr),We=pr.map(function(sr){return sr.map(function(xr){return[[xr[0][0]*k,xr[0][1]*k],[xr[1][0]*k,xr[1][1]*k],[xr[2][0]*k,xr[2][1]*k]]})}),bt=We.map(function(sr){return sr.map(function(xr){var Dr=ze(xr[0][0],xr[0][1])[0],Xr=ze(xr[2][0],xr[2][1])[0],qr=ze(xr[1][0],xr[0][1])[1],bn=ze(xr[1][0],xr[1][1])[1],Dn;return qr>bn&&(Dn=qr,qr=bn,bn=Dn),[[Dr,qr],[Xr,bn]]})}),kt):We.map(function(sr){return sr.map(function(xr){return[[xr[0][0]*T,xr[0][1]*T],[xr[1][0]*T,xr[1][1]*T],[xr[2][0]*T,xr[2][1]*T]]})})},We!=null&&kt.lobes(We),kt}var da=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function ma(){return aa(ke,da).scale(160.857)}var sa=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function Aa(){return aa(Tn,sa).scale(152.63)}var po=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function zo(){return aa(Ee,po).scale(169.529)}var Ko=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function nl(){return aa(Ee,Ko).scale(169.529).rotate([20,0])}var pl=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]];function Yl(){return aa(vn,pl,ce).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}var vi=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function Gs(){return aa(Ie,vi).scale(152.63).rotate([-20,0])}function Rs(ze,We){return[3/L*ze*D(l*l/3-We*We),We]}Rs.invert=function(ze,We){return[L/3*ze/D(l*l/3-We*We),We]};function Hi(){return g.geoProjection(Rs).scale(158.837)}function So(ze){function We(et,ot){if(M(M(ot)-w)<o)return[0,ot<0?-2:2];var bt=f(ot),mt=x((1+bt)/(1-bt),ze/2),kt=.5*(mt+1/mt)+n(et*=ze);return[2*f(et)/kt,(mt-1/mt)/kt]}return We.invert=function(et,ot){var bt=M(ot);if(M(bt-2)<o)return et?null:[0,v(ot)*w];if(bt>2)return null;et/=2,ot/=2;var mt=et*et,kt=ot*ot,fr=2*ot/(1+mt+kt);return fr=x((1+fr)/(1-fr),1/ze),[a(2*et,1-mt-kt)/ze,z((fr-1)/(fr+1))]},We}function dl(){var ze=.5,We=g.geoProjectionMutator(So),et=We(ze);return et.spacing=function(ot){return arguments.length?We(ze=+ot):ze},et.scale(124.75)}var ps=l/b;function Di(ze,We){return[ze*(1+D(n(We)))/2,We/(n(We/2)*n(ze/6))]}Di.invert=function(ze,We){var et=M(ze),ot=M(We),bt=o,mt=w;ot<ps?mt*=ot/ps:bt+=6*I(ps/ot);for(var kt=0;kt<25;kt++){var fr=f(mt),pr=D(n(mt)),sr=f(mt/2),xr=n(mt/2),Dr=f(bt/6),Xr=n(bt/6),qr=.5*bt*(1+pr)-et,bn=mt/(xr*Xr)-ot,Dn=pr?-.25*bt*fr/pr:0,Wn=.5*(1+pr),ga=(1+.5*mt*sr/xr)/(xr*Xr),xa=mt/xr*(Dr/6)/(Xr*Xr),Ka=Dn*xa-ga*Wn,Ya=(qr*xa-bn*Wn)/Ka,ei=(bn*Dn-qr*ga)/Ka;if(mt-=Ya,bt-=ei,M(Ya)<o&&M(ei)<o)break}return[ze<0?-bt:bt,We<0?-mt:mt]};function al(){return g.geoProjection(Di).scale(97.2672)}function Qi(ze,We){var et=ze*ze,ot=We*We;return[ze*(.975534+ot*(-.119161+et*-.0143059+ot*-.0547009)),We*(1.00384+et*(.0802894+ot*-.02855+et*199025e-9)+ot*(.0998909+ot*-.0491032))]}Qi.invert=function(ze,We){var et=v(ze)*l,ot=We/2,bt=50;do{var mt=et*et,kt=ot*ot,fr=et*ot,pr=et*(.975534+kt*(-.119161+mt*-.0143059+kt*-.0547009))-ze,sr=ot*(1.00384+mt*(.0802894+kt*-.02855+mt*199025e-9)+kt*(.0998909+kt*-.0491032))-We,xr=.975534-kt*(.119161+3*mt*.0143059+kt*.0547009),Dr=-fr*(2*.119161+4*.0547009*kt+2*.0143059*mt),Xr=fr*(2*.0802894+4*199025e-9*mt+2*-.02855*kt),qr=1.00384+mt*(.0802894+199025e-9*mt)+kt*(3*(.0998909-.02855*mt)-5*.0491032*kt),bn=Dr*Xr-qr*xr,Dn=(sr*Dr-pr*qr)/bn,Wn=(pr*Xr-sr*xr)/bn;et-=Dn,ot-=Wn}while((M(Dn)>o||M(Wn)>o)&&--bt>0);return bt&&[et,ot]};function Oi(){return g.geoProjection(Qi).scale(139.98)}function io(ze,We){return[f(ze)/n(We),y(We)*n(ze)]}io.invert=function(ze,We){var et=ze*ze,ot=We*We,bt=ot+1,mt=et+bt,kt=ze?h*D((mt-D(mt*mt-4*et))/et):1/D(bt);return[z(ze*kt),v(We)*I(kt)]};function $i(){return g.geoProjection(io).scale(144.049).clipAngle(90-.001)}function rs(ze){var We=n(ze),et=y(_+ze/2);function ot(bt,mt){var kt=mt-ze,fr=M(kt)<o?bt*We:M(fr=_+mt/2)<o||M(M(fr)-w)<o?0:bt*kt/c(y(fr)/et);return[fr,kt]}return ot.invert=function(bt,mt){var kt,fr=mt+ze;return[M(mt)<o?bt/We:M(kt=_+fr/2)<o||M(M(kt)-w)<o?0:bt*c(y(kt)/et)/mt,fr]},ot}function Ys(){return He(rs).parallel(40).scale(158.837)}function au(ze,We){return[ze,1.25*c(y(_+.4*We))]}au.invert=function(ze,We){return[ze,2.5*e(r(.8*We))-.625*l]};function Jo(){return g.geoProjection(au).scale(108.318)}function iu(ze){var We=ze.length-1;function et(ot,bt){for(var mt=n(bt),kt=2/(1+mt*n(ot)),fr=kt*mt*f(ot),pr=kt*f(bt),sr=We,xr=ze[sr],Dr=xr[0],Xr=xr[1],qr;--sr>=0;)xr=ze[sr],Dr=xr[0]+fr*(qr=Dr)-pr*Xr,Xr=xr[1]+fr*Xr+pr*qr;return Dr=fr*(qr=Dr)-pr*Xr,Xr=fr*Xr+pr*qr,[Dr,Xr]}return et.invert=function(ot,bt){var mt=20,kt=ot,fr=bt;do{for(var pr=We,sr=ze[pr],xr=sr[0],Dr=sr[1],Xr=0,qr=0,bn;--pr>=0;)sr=ze[pr],Xr=xr+kt*(bn=Xr)-fr*qr,qr=Dr+kt*qr+fr*bn,xr=sr[0]+kt*(bn=xr)-fr*Dr,Dr=sr[1]+kt*Dr+fr*bn;Xr=xr+kt*(bn=Xr)-fr*qr,qr=Dr+kt*qr+fr*bn,xr=kt*(bn=xr)-fr*Dr-ot,Dr=kt*Dr+fr*bn-bt;var Dn=Xr*Xr+qr*qr,Wn,ga;kt-=Wn=(xr*Xr+Dr*qr)/Dn,fr-=ga=(Dr*Xr-xr*qr)/Dn}while(M(Wn)+M(ga)>o*o&&--mt>0);if(mt){var xa=D(kt*kt+fr*fr),Ka=2*e(xa*.5),Ya=f(Ka);return[a(kt*Ya,xa*n(Ka)),xa?z(fr*Ya/xa):0]}},et}var Is=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],ko=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],Mu=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],zs=[[.9245,0],[0,0],[.01943,0]],ws=[[.721316,0],[0,0],[-.00881625,-.00617325]];function Ll(){return Ts(Is,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)}function Su(){return Ts(ko,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])}function ku(){return Ts(Mu,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])}function Ws(){return Ts(zs,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)}function Pl(){return Ts(ws,[165,10]).scale(250).clipAngle(130).center([-165,-10])}function Ts(ze,We){var et=g.geoProjection(iu(ze)).rotate(We).clipAngle(90),ot=g.geoRotation(We),bt=et.center;return delete et.rotate,et.center=function(mt){return arguments.length?bt(ot(mt)):ot.invert(bt())},et}var Wl=D(6),il=D(7);function Xl(ze,We){var et=z(7*f(We)/(3*Wl));return[Wl*ze*(2*n(2*et/3)-1)/il,9*f(et/3)/il]}Xl.invert=function(ze,We){var et=3*z(We*il/9);return[ze*il/(Wl*(2*n(2*et/3)-1)),z(f(et)*3*Wl/7)]};function ou(){return g.geoProjection(Xl).scale(164.859)}function Dl(ze,We){for(var et=(1+h)*f(We),ot=We,bt=0,mt;bt<25&&(ot-=mt=(f(ot/2)+f(ot)-et)/(.5*n(ot/2)+n(ot)),!(M(mt)<o));bt++);return[ze*(1+2*n(ot)/n(ot/2))/(3*b),2*D(3)*f(ot/2)/D(2+b)]}Dl.invert=function(ze,We){var et=We*D(2+b)/(2*D(3)),ot=2*z(et);return[3*b*ze/(1+2*n(ot)/n(ot/2)),z((et+f(ot))/(1+h))]};function Eu(){return g.geoProjection(Dl).scale(188.209)}function Xs(ze,We){for(var et=D(6/(4+l)),ot=(1+l/4)*f(We),bt=We/2,mt=0,kt;mt<25&&(bt-=kt=(bt/2+f(bt)-ot)/(.5+n(bt)),!(M(kt)<o));mt++);return[et*(.5+n(bt))*ze/1.5,et*bt]}Xs.invert=function(ze,We){var et=D(6/(4+l)),ot=We/et;return M(M(ot)-w)<o&&(ot=ot<0?-w:w),[1.5*ze/(et*(.5+n(ot))),z((ot/2+f(ot))/(1+l/4))]};function Zl(){return g.geoProjection(Xs).scale(166.518)}function Rl(ze,We){var et=We*We,ot=et*et,bt=et*ot;return[ze*(.84719-.13063*et+bt*bt*(-.04515+.05494*et-.02326*ot+.00331*bt)),We*(1.01183+ot*ot*(-.02625+.01926*et-.00396*ot))]}Rl.invert=function(ze,We){var et=We,ot=25,bt,mt,kt,fr;do mt=et*et,kt=mt*mt,et-=bt=(et*(1.01183+kt*kt*(-.02625+.01926*mt-.00396*kt))-We)/(1.01183+kt*kt*(9*-.02625+11*.01926*mt+13*-.00396*kt));while(M(bt)>m&&--ot>0);return mt=et*et,kt=mt*mt,fr=mt*kt,[ze/(.84719-.13063*mt+fr*fr*(-.04515+.05494*mt-.02326*kt+.00331*fr)),et]};function ds(){return g.geoProjection(Rl).scale(175.295)}function yl(ze,We){return[ze*(1+n(We))/2,2*(We-y(We/2))]}yl.invert=function(ze,We){for(var et=We/2,ot=0,bt=1/0;ot<10&&M(bt)>o;++ot){var mt=n(We/2);We-=bt=(We-y(We/2)-et)/(1-.5/(mt*mt))}return[2*ze/(1+n(We)),We]};function jl(){return g.geoProjection(yl).scale(152.63)}var su=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function lu(){return aa(se(1/0),su).rotate([20,0]).scale(152.63)}function Il(ze,We){var et=f(We),ot=n(We),bt=v(ze);if(ze===0||M(We)===w)return[0,We];if(We===0)return[ze,0];if(M(ze)===w)return[ze*ot,w*et];var mt=l/(2*ze)-2*ze/l,kt=2*We/l,fr=(1-kt*kt)/(et-kt),pr=mt*mt,sr=fr*fr,xr=1+pr/sr,Dr=1+sr/pr,Xr=(mt*et/fr-mt/2)/xr,qr=(sr*et/pr+fr/2)/Dr,bn=Xr*Xr+ot*ot/xr,Dn=qr*qr-(sr*et*et/pr+fr*et-1)/Dr;return[w*(Xr+D(bn)*bt),w*(qr+D(Dn<0?0:Dn)*v(-We*mt)*bt)]}Il.invert=function(ze,We){ze/=w,We/=w;var et=ze*ze,ot=We*We,bt=et+ot,mt=l*l;return[ze?(bt-1+D((1-bt)*(1-bt)+4*et))/(2*ze)*w:0,be(function(kt){return bt*(l*f(kt)-2*kt)*l+4*kt*kt*(We-f(kt))+2*l*kt-mt*We},0)]};function Cu(){return g.geoProjection(Il).scale(127.267)}var uu=1.0148,Qo=.23185,ol=-.14499,sl=.02406,Kl=uu,gs=5*Qo,Eo=7*ol,zl=9*sl,As=1.790857183;function Ms(ze,We){var et=We*We;return[ze,We*(uu+et*et*(Qo+et*(ol+sl*et)))]}Ms.invert=function(ze,We){We>As?We=As:We<-As&&(We=-As);var et=We,ot;do{var bt=et*et;et-=ot=(et*(uu+bt*bt*(Qo+bt*(ol+sl*bt)))-We)/(Kl+bt*bt*(gs+bt*(Eo+zl*bt)))}while(M(ot)>o);return[ze,et]};function lo(){return g.geoProjection(Ms).scale(139.319)}function ml(ze,We){if(M(We)<o)return[ze,0];var et=y(We),ot=ze*f(We);return[f(ot)/et,We+(1-n(ot))/et]}ml.invert=function(ze,We){if(M(We)<o)return[ze,0];var et=ze*ze+We*We,ot=We*.5,bt=10,mt;do{var kt=y(ot),fr=1/n(ot),pr=et-2*We*ot+ot*ot;ot-=mt=(kt*pr+2*(ot-We))/(2+pr*fr*fr+2*(ot-We)*kt)}while(M(mt)>o&&--bt>0);return kt=y(ot),[(M(We)<M(ot+1/kt)?z(ze*kt):v(We)*v(ze)*(I(M(ze*kt))+w))/f(ot),ot]};function xl(){return g.geoProjection(ml).scale(103.74)}function Zs(ze,We){var et=ll(ze[1],ze[0]),ot=ll(We[1],We[0]),bt=_l(et,ot),mt=Fl(et)/Fl(ot);return bl([1,0,ze[0][0],0,1,ze[0][1]],bl([mt,0,0,0,mt,0],bl([n(bt),f(bt),0,-f(bt),n(bt),0],[1,0,-We[0][0],0,1,-We[0][1]])))}function ys(ze){var We=1/(ze[0]*ze[4]-ze[1]*ze[3]);return[We*ze[4],-We*ze[1],We*(ze[1]*ze[5]-ze[2]*ze[4]),-We*ze[3],We*ze[0],We*(ze[2]*ze[3]-ze[0]*ze[5])]}function bl(ze,We){return[ze[0]*We[0]+ze[1]*We[3],ze[0]*We[1]+ze[1]*We[4],ze[0]*We[2]+ze[1]*We[5]+ze[2],ze[3]*We[0]+ze[4]*We[3],ze[3]*We[1]+ze[4]*We[4],ze[3]*We[2]+ze[4]*We[5]+ze[5]]}function ll(ze,We){return[ze[0]-We[0],ze[1]-We[1]]}function Fl(ze){return D(ze[0]*ze[0]+ze[1]*ze[1])}function _l(ze,We){return a(ze[0]*We[1]-ze[1]*We[0],ze[0]*We[0]+ze[1]*We[1])}function js(ze,We,et){ot(ze,{transform:null});function ot(sr,xr){if(sr.edges=Jl(sr.face),xr.face){var Dr=sr.shared=Yu(sr.face,xr.face),Xr=Zs(Dr.map(xr.project),Dr.map(sr.project));sr.transform=xr.transform?bl(xr.transform,Xr):Xr;for(var qr=xr.edges,bn=0,Dn=qr.length;bn<Dn;++bn)ns(Dr[0],qr[bn][1])&&ns(Dr[1],qr[bn][0])&&(qr[bn]=sr),ns(Dr[0],qr[bn][0])&&ns(Dr[1],qr[bn][1])&&(qr[bn]=sr);for(qr=sr.edges,bn=0,Dn=qr.length;bn<Dn;++bn)ns(Dr[0],qr[bn][0])&&ns(Dr[1],qr[bn][1])&&(qr[bn]=xr),ns(Dr[0],qr[bn][1])&&ns(Dr[1],qr[bn][0])&&(qr[bn]=xr)}else sr.transform=xr.transform;return sr.children&&sr.children.forEach(function(Wn){ot(Wn,sr)}),sr}function bt(sr,xr){var Dr=We(sr,xr),Xr=Dr.project([sr*T,xr*T]),qr;return(qr=Dr.transform)?[qr[0]*Xr[0]+qr[1]*Xr[1]+qr[2],-(qr[3]*Xr[0]+qr[4]*Xr[1]+qr[5])]:(Xr[1]=-Xr[1],Xr)}ul(ze)&&(bt.invert=function(sr,xr){var Dr=mt(ze,[sr,-xr]);return Dr&&(Dr[0]*=k,Dr[1]*=k,Dr)});function mt(sr,xr){var Dr=sr.project.invert,Xr=sr.transform,qr=xr;if(Xr&&(Xr=ys(Xr),qr=[Xr[0]*qr[0]+Xr[1]*qr[1]+Xr[2],Xr[3]*qr[0]+Xr[4]*qr[1]+Xr[5]]),Dr&&sr===kt(bn=Dr(qr)))return bn;for(var bn,Dn=sr.children,Wn=0,ga=Dn&&Dn.length;Wn<ga;++Wn)if(bn=mt(Dn[Wn],xr))return bn}function kt(sr){return We(sr[0]*k,sr[1]*k)}var fr=g.geoProjection(bt),pr=fr.stream;return fr.stream=function(sr){var xr=fr.rotate(),Dr=pr(sr),Xr=(fr.rotate([0,0]),pr(sr));return fr.rotate(xr),Dr.sphere=function(){Xr.polygonStart(),Xr.lineStart(),Lu(Xr,ze),Xr.lineEnd(),Xr.polygonEnd()},Dr},fr.angle(et==null?-30:et*T)}function Lu(ze,We,et){var ot,bt=We.edges,mt=bt.length,kt,fr={type:"MultiPoint",coordinates:We.face},pr=We.face.filter(function(Dn){return M(Dn[1])!==90}),sr=g.geoBounds({type:"MultiPoint",coordinates:pr}),xr=!1,Dr=-1,Xr=sr[1][0]-sr[0][0],qr=Xr===180||Xr===360?[(sr[0][0]+sr[1][0])/2,(sr[0][1]+sr[1][1])/2]:g.geoCentroid(fr);if(et)for(;++Dr<mt&&bt[Dr]!==et;);++Dr;for(var bn=0;bn<mt;++bn)kt=bt[(bn+Dr)%mt],Array.isArray(kt)?(xr||(ze.point((ot=g.geoInterpolate(kt[0],qr)(o))[0],ot[1]),xr=!0),ze.point((ot=g.geoInterpolate(kt[1],qr)(o))[0],ot[1])):(xr=!1,kt!==et&&Lu(ze,kt,We))}function ns(ze,We){return ze&&We&&ze[0]===We[0]&&ze[1]===We[1]}function Yu(ze,We){for(var et,ot,bt=ze.length,mt=null,kt=0;kt<bt;++kt){et=ze[kt];for(var fr=We.length;--fr>=0;)if(ot=We[fr],et[0]===ot[0]&&et[1]===ot[1]){if(mt)return[mt,et];mt=et}}}function Jl(ze){for(var We=ze.length,et=[],ot=ze[We-1],bt=0;bt<We;++bt)et.push([ot,ot=ze[bt]]);return et}function ul(ze){return ze.project.invert||ze.children&&ze.children.some(ul)}var wl=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],Ks=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(ze){return ze.map(function(We){return wl[We]})});function Tl(ze){ze=ze||function(et){var ot=g.geoCentroid({type:"MultiPoint",coordinates:et});return g.geoGnomonic().scale(1).translate([0,0]).rotate([-ot[0],-ot[1]])};var We=Ks.map(function(et){return{face:et,project:ze(et)}});return[-1,0,0,1,0,1,4,5].forEach(function(et,ot){var bt=We[et];bt&&(bt.children||(bt.children=[])).push(We[ot])}),js(We[0],function(et,ot){return We[et<-l/2?ot<0?6:4:et<0?ot<0?2:0:et<l/2?ot<0?3:1:ot<0?7:5]}).angle(-30).scale(101.858).center([0,45])}var fu=2/D(3);function cu(ze,We){var et=Ue(ze,We);return[et[0]*fu,et[1]]}cu.invert=function(ze,We){return Ue.invert(ze/fu,We)};function Wu(ze){ze=ze||function(et){var ot=g.geoCentroid({type:"MultiPoint",coordinates:et});return g.geoProjection(cu).translate([0,0]).scale(1).rotate(ot[1]>0?[-ot[0],0]:[180-ot[0],180])};var We=Ks.map(function(et){return{face:et,project:ze(et)}});return[-1,0,0,1,0,1,4,5].forEach(function(et,ot){var bt=We[et];bt&&(bt.children||(bt.children=[])).push(We[ot])}),js(We[0],function(et,ot){return We[et<-l/2?ot<0?6:4:et<0?ot<0?2:0:et<l/2?ot<0?3:1:ot<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])}function Ri(ze){ze=ze||function(kt){var fr=kt.length===6?g.geoCentroid({type:"MultiPoint",coordinates:kt}):kt[0];return g.geoGnomonic().scale(1).translate([0,0]).rotate([-fr[0],-fr[1]])};var We=Ks.map(function(kt){for(var fr=kt.map(as),pr=fr.length,sr=fr[pr-1],xr,Dr=[],Xr=0;Xr<pr;++Xr)xr=fr[Xr],Dr.push($o([sr[0]*.9486832980505138+xr[0]*.31622776601683794,sr[1]*.9486832980505138+xr[1]*.31622776601683794,sr[2]*.9486832980505138+xr[2]*.31622776601683794]),$o([xr[0]*.9486832980505138+sr[0]*.31622776601683794,xr[1]*.9486832980505138+sr[1]*.31622776601683794,xr[2]*.9486832980505138+sr[2]*.31622776601683794])),sr=xr;return Dr}),et=[],ot=[-1,0,0,1,0,1,4,5];We.forEach(function(kt,fr){for(var pr=Ks[fr],sr=pr.length,xr=et[fr]=[],Dr=0;Dr<sr;++Dr)We.push([pr[Dr],kt[(Dr*2+2)%(2*sr)],kt[(Dr*2+1)%(2*sr)]]),ot.push(fr),xr.push(Js(as(kt[(Dr*2+2)%(2*sr)]),as(kt[(Dr*2+1)%(2*sr)])))});var bt=We.map(function(kt){return{project:ze(kt),face:kt}});ot.forEach(function(kt,fr){var pr=bt[kt];pr&&(pr.children||(pr.children=[])).push(bt[fr])});function mt(kt,fr){var pr=n(fr),sr=[pr*n(kt),pr*f(kt),f(fr)],xr=kt<-l/2?fr<0?6:4:kt<0?fr<0?2:0:kt<l/2?fr<0?3:1:fr<0?7:5,Dr=et[xr];return bt[fl(Dr[0],sr)<0?8+3*xr:fl(Dr[1],sr)<0?8+3*xr+1:fl(Dr[2],sr)<0?8+3*xr+2:xr]}return js(bt[0],mt).angle(-30).scale(110.625).center([0,45])}function fl(ze,We){for(var et=0,ot=ze.length,bt=0;et<ot;++et)bt+=ze[et]*We[et];return bt}function Js(ze,We){return[ze[1]*We[2]-ze[2]*We[1],ze[2]*We[0]-ze[0]*We[2],ze[0]*We[1]-ze[1]*We[0]]}function $o(ze){return[a(ze[1],ze[0])*T,z(s(-1,i(1,ze[2])))*T]}function as(ze){var We=ze[0]*k,et=ze[1]*k,ot=n(et);return[ot*n(We),ot*f(We),f(et)]}function Al(){}function uo(ze){if((et=ze.length)<4)return!1;for(var We=0,et,ot=ze[et-1][1]*ze[0][0]-ze[et-1][0]*ze[0][1];++We<et;)ot+=ze[We-1][1]*ze[We][0]-ze[We-1][0]*ze[We][1];return ot<=0}function hu(ze,We){for(var et=We[0],ot=We[1],bt=!1,mt=0,kt=ze.length,fr=kt-1;mt<kt;fr=mt++){var pr=ze[mt],sr=pr[0],xr=pr[1],Dr=ze[fr],Xr=Dr[0],qr=Dr[1];xr>ot^qr>ot&&et<(Xr-sr)*(ot-xr)/(qr-xr)+sr&&(bt=!bt)}return bt}function is(ze,We){var et=We.stream,ot;if(!et)throw new Error("invalid projection");switch(ze&&ze.type){case"Feature":ot=Os;break;case"FeatureCollection":ot=Fs;break;default:ot=os;break}return ot(ze,et)}function Fs(ze,We){return{type:"FeatureCollection",features:ze.features.map(function(et){return Os(et,We)})}}function Os(ze,We){return{type:"Feature",id:ze.id,properties:ze.properties,geometry:os(ze.geometry,We)}}function Ss(ze,We){return{type:"GeometryCollection",geometries:ze.geometries.map(function(et){return os(et,We)})}}function os(ze,We){if(!ze)return null;if(ze.type==="GeometryCollection")return Ss(ze,We);var et;switch(ze.type){case"Point":et=ss;break;case"MultiPoint":et=ss;break;case"LineString":et=vu;break;case"MultiLineString":et=vu;break;case"Polygon":et=Ol;break;case"MultiPolygon":et=Ol;break;case"Sphere":et=Ol;break;default:return null}return g.geoStream(ze,We(et)),et.result()}var Gi=[],Co=[],ss={point:function(ze,We){Gi.push([ze,We])},result:function(){var ze=Gi.length?Gi.length<2?{type:"Point",coordinates:Gi[0]}:{type:"MultiPoint",coordinates:Gi}:null;return Gi=[],ze}},vu={lineStart:Al,point:function(ze,We){Gi.push([ze,We])},lineEnd:function(){Gi.length&&(Co.push(Gi),Gi=[])},result:function(){var ze=Co.length?Co.length<2?{type:"LineString",coordinates:Co[0]}:{type:"MultiLineString",coordinates:Co}:null;return Co=[],ze}},Ol={polygonStart:Al,lineStart:Al,point:function(ze,We){Gi.push([ze,We])},lineEnd:function(){var ze=Gi.length;if(ze){do Gi.push(Gi[0].slice());while(++ze<4);Co.push(Gi),Gi=[]}},polygonEnd:Al,result:function(){if(!Co.length)return null;var ze=[],We=[];return Co.forEach(function(et){uo(et)?ze.push([et]):We.push(et)}),We.forEach(function(et){var ot=et[0];ze.some(function(bt){if(hu(bt[0],ot))return bt.push(et),!0})||ze.push([et])}),Co=[],ze.length?ze.length>1?{type:"MultiPolygon",coordinates:ze}:{type:"Polygon",coordinates:ze[0]}:null}};function pu(ze){var We=ze(w,0)[0]-ze(-w,0)[0];function et(ot,bt){var mt=M(ot)<w,kt=ze(mt?ot:ot>0?ot-l:ot+l,bt),fr=(kt[0]-kt[1])*h,pr=(kt[0]+kt[1])*h;if(mt)return[fr,pr];var sr=We*h,xr=fr>0^pr>0?-1:1;return[xr*fr-v(pr)*sr,xr*pr-v(fr)*sr]}return ze.invert&&(et.invert=function(ot,bt){var mt=(ot+bt)*h,kt=(bt-ot)*h,fr=M(mt)<.5*We&&M(kt)<.5*We;if(!fr){var pr=We*h,sr=mt>0^kt>0?-1:1,xr=-sr*ot+(kt>0?1:-1)*pr,Dr=-sr*bt+(mt>0?1:-1)*pr;mt=(-xr-Dr)*h,kt=(xr-Dr)*h}var Xr=ze.invert(mt,kt);return fr||(Xr[0]+=mt>0?l:-l),Xr}),g.geoProjection(et).rotate([-90,-90,45]).clipAngle(180-.001)}function yt(){return pu(_r).scale(176.423)}function Ot(){return pu(pa).scale(111.48)}function cr(ze,We){if(!(0<=(We=+We)&&We<=20))throw new Error("invalid digits");function et(sr){var xr=sr.length,Dr=2,Xr=new Array(xr);for(Xr[0]=+sr[0].toFixed(We),Xr[1]=+sr[1].toFixed(We);Dr<xr;)Xr[Dr]=sr[Dr],++Dr;return Xr}function ot(sr){return sr.map(et)}function bt(sr){for(var xr=et(sr[0]),Dr=[xr],Xr=1;Xr<sr.length;Xr++){var qr=et(sr[Xr]);(qr.length>2||qr[0]!=xr[0]||qr[1]!=xr[1])&&(Dr.push(qr),xr=qr)}return Dr.length===1&&sr.length>1&&Dr.push(et(sr[sr.length-1])),Dr}function mt(sr){return sr.map(bt)}function kt(sr){if(sr==null)return sr;var xr;switch(sr.type){case"GeometryCollection":xr={type:"GeometryCollection",geometries:sr.geometries.map(kt)};break;case"Point":xr={type:"Point",coordinates:et(sr.coordinates)};break;case"MultiPoint":xr={type:sr.type,coordinates:ot(sr.coordinates)};break;case"LineString":xr={type:sr.type,coordinates:bt(sr.coordinates)};break;case"MultiLineString":case"Polygon":xr={type:sr.type,coordinates:mt(sr.coordinates)};break;case"MultiPolygon":xr={type:"MultiPolygon",coordinates:sr.coordinates.map(mt)};break;default:return sr}return sr.bbox!=null&&(xr.bbox=sr.bbox),xr}function fr(sr){var xr={type:"Feature",properties:sr.properties,geometry:kt(sr.geometry)};return sr.id!=null&&(xr.id=sr.id),sr.bbox!=null&&(xr.bbox=sr.bbox),xr}if(ze!=null)switch(ze.type){case"Feature":return fr(ze);case"FeatureCollection":{var pr={type:"FeatureCollection",features:ze.features.map(fr)};return ze.bbox!=null&&(pr.bbox=ze.bbox),pr}default:return kt(ze)}return ze}function or(ze){var We=f(ze);function et(ot,bt){var mt=We?y(ot*We/2)/We:ot/2;if(!bt)return[2*mt,-ze];var kt=2*e(mt*f(bt)),fr=1/y(bt);return[f(kt)*fr,bt+(1-n(kt))*fr-ze]}return et.invert=function(ot,bt){if(M(bt+=ze)<o)return[We?2*e(We*ot/2)/We:ot,0];var mt=ot*ot+bt*bt,kt=0,fr=10,pr;do{var sr=y(kt),xr=1/n(kt),Dr=mt-2*bt*kt+kt*kt;kt-=pr=(sr*Dr+2*(kt-bt))/(2+Dr*xr*xr+2*(kt-bt)*sr)}while(M(pr)>o&&--fr>0);var Xr=ot*(sr=y(kt)),qr=y(M(bt)<M(kt+1/sr)?z(Xr)*.5:I(Xr)*.5+l/4)/f(kt);return[We?2*e(We*qr)/We:2*qr,kt]},et}function Rr(){return He(or).scale(131.215)}var tn=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];tn.forEach(function(ze){ze[1]*=1.0144});function dn(ze,We){var et=i(18,M(We)*36/l),ot=t(et),bt=et-ot,mt=(Dr=tn[ot])[0],kt=Dr[1],fr=(Dr=tn[++ot])[0],pr=Dr[1],sr=(Dr=tn[i(19,++ot)])[0],xr=Dr[1],Dr;return[ze*(fr+bt*(sr-mt)/2+bt*bt*(sr-2*fr+mt)/2),(We>0?w:-w)*(pr+bt*(xr-kt)/2+bt*bt*(xr-2*pr+kt)/2)]}dn.invert=function(ze,We){var et=We/w,ot=et*90,bt=i(18,M(ot/5)),mt=s(0,t(bt));do{var kt=tn[mt][1],fr=tn[mt+1][1],pr=tn[i(19,mt+2)][1],sr=pr-kt,xr=pr-2*fr+kt,Dr=2*(M(et)-fr)/sr,Xr=xr/sr,qr=Dr*(1-Xr*Dr*(1-2*Xr*Dr));if(qr>=0||mt===1){ot=(We>=0?5:-5)*(qr+bt);var bn=50,Dn;do bt=i(18,M(ot)/5),mt=t(bt),qr=bt-mt,kt=tn[mt][1],fr=tn[mt+1][1],pr=tn[i(19,mt+2)][1],ot-=(Dn=(We>=0?w:-w)*(fr+qr*(pr-kt)/2+qr*qr*(pr-2*fr+kt)/2)-We)*T;while(M(Dn)>m&&--bn>0);break}}while(--mt>=0);var Wn=tn[mt][0],ga=tn[mt+1][0],xa=tn[i(19,mt+2)][0];return[ze/(ga+qr*(xa-Wn)/2+qr*qr*(xa-2*ga+Wn)/2),ot*k]};function Mn(){return g.geoProjection(dn).scale(152.63)}function Ln(ze){function We(et,ot){var bt=n(ot),mt=(ze-1)/(ze-bt*n(et));return[mt*bt*f(et),mt*f(ot)]}return We.invert=function(et,ot){var bt=et*et+ot*ot,mt=D(bt),kt=(ze-D(1-bt*(ze+1)/(ze-1)))/((ze-1)/mt+mt/(ze-1));return[a(et*kt,mt*D(1-kt*kt)),mt?z(ot*kt/mt):0]},We}function Nn(ze,We){var et=Ln(ze);if(!We)return et;var ot=n(We),bt=f(We);function mt(kt,fr){var pr=et(kt,fr),sr=pr[1],xr=sr*bt/(ze-1)+ot;return[pr[0]*ot/xr,sr/xr]}return mt.invert=function(kt,fr){var pr=(ze-1)/(ze-1-fr*bt);return et.invert(pr*kt,pr*fr*ot)},mt}function yn(){var ze=2,We=0,et=g.geoProjectionMutator(Nn),ot=et(ze,We);return ot.distance=function(bt){return arguments.length?et(ze=+bt,We):ze},ot.tilt=function(bt){return arguments.length?et(ze,We=bt*k):We*T},ot.scale(432.147).clipAngle(I(1/ze)*T-1e-6)}var zn=1e-4,Pn=1e4,Vn=-180,$n=Vn+zn,za=180,Ea=za-zn,Fa=-90,Oa=Fa+zn,Jn=90,ha=Jn-zn;function Ga(ze){return ze.length>0}function Qa(ze){return Math.floor(ze*Pn)/Pn}function di(ze){return ze===Fa||ze===Jn?[0,ze]:[Vn,Qa(ze)]}function gi(ze){var We=ze[0],et=ze[1],ot=!1;return We<=$n?(We=Vn,ot=!0):We>=Ea&&(We=za,ot=!0),et<=Oa?(et=Fa,ot=!0):et>=ha&&(et=Jn,ot=!0),ot?[We,et]:ze}function mi(ze){return ze.map(gi)}function Ai(ze,We,et){for(var ot=0,bt=ze.length;ot<bt;++ot){var mt=ze[ot].slice();et.push({index:-1,polygon:We,ring:mt});for(var kt=0,fr=mt.length;kt<fr;++kt){var pr=mt[kt],sr=pr[0],xr=pr[1];if(sr<=$n||sr>=Ea||xr<=Oa||xr>=ha){mt[kt]=gi(pr);for(var Dr=kt+1;Dr<fr;++Dr){var Xr=mt[Dr],qr=Xr[0],bn=Xr[1];if(qr>$n&&qr<Ea&&bn>Oa&&bn<ha)break}if(Dr===kt+1)continue;if(kt){var Dn={index:-1,polygon:We,ring:mt.slice(0,kt+1)};Dn.ring[Dn.ring.length-1]=di(xr),et[et.length-1]=Dn}else et.pop();if(Dr>=fr)break;et.push({index:-1,polygon:We,ring:mt=mt.slice(Dr-1)}),mt[0]=di(mt[0][1]),kt=-1,fr=mt.length}}}}function oi(ze){var We,et=ze.length,ot={},bt={},mt,kt,fr,pr,sr;for(We=0;We<et;++We){if(mt=ze[We],kt=mt.ring[0],pr=mt.ring[mt.ring.length-1],kt[0]===pr[0]&&kt[1]===pr[1]){mt.polygon.push(mt.ring),ze[We]=null;continue}mt.index=We,ot[kt]=bt[pr]=mt}for(We=0;We<et;++We)if(mt=ze[We],mt){if(kt=mt.ring[0],pr=mt.ring[mt.ring.length-1],fr=bt[kt],sr=ot[pr],delete ot[kt],delete bt[pr],kt[0]===pr[0]&&kt[1]===pr[1]){mt.polygon.push(mt.ring);continue}fr?(delete bt[kt],delete ot[fr.ring[0]],fr.ring.pop(),ze[fr.index]=null,mt={index:-1,polygon:fr.polygon,ring:fr.ring.concat(mt.ring)},fr===sr?mt.polygon.push(mt.ring):(mt.index=et++,ze.push(ot[mt.ring[0]]=bt[mt.ring[mt.ring.length-1]]=mt))):sr?(delete ot[pr],delete bt[sr.ring[sr.ring.length-1]],mt.ring.pop(),mt={index:et++,polygon:sr.polygon,ring:mt.ring.concat(sr.ring)},ze[sr.index]=null,ze.push(ot[mt.ring[0]]=bt[mt.ring[mt.ring.length-1]]=mt)):(mt.ring.push(mt.ring[0]),mt.polygon.push(mt.ring))}}function xo(ze){var We={type:"Feature",geometry:to(ze.geometry)};return ze.id!=null&&(We.id=ze.id),ze.bbox!=null&&(We.bbox=ze.bbox),ze.properties!=null&&(We.properties=ze.properties),We}function to(ze){if(ze==null)return ze;var We,et,ot,bt;switch(ze.type){case"GeometryCollection":We={type:"GeometryCollection",geometries:ze.geometries.map(to)};break;case"Point":We={type:"Point",coordinates:gi(ze.coordinates)};break;case"MultiPoint":case"LineString":We={type:ze.type,coordinates:mi(ze.coordinates)};break;case"MultiLineString":We={type:"MultiLineString",coordinates:ze.coordinates.map(mi)};break;case"Polygon":{var mt=[];Ai(ze.coordinates,mt,et=[]),oi(et),We={type:"Polygon",coordinates:mt};break}case"MultiPolygon":{et=[],ot=-1,bt=ze.coordinates.length;for(var kt=new Array(bt);++ot<bt;)Ai(ze.coordinates[ot],kt[ot]=[],et);oi(et),We={type:"MultiPolygon",coordinates:kt.filter(Ga)};break}default:return ze}return ze.bbox!=null&&(We.bbox=ze.bbox),We}function Ja(ze){if(ze==null)return ze;switch(ze.type){case"Feature":return xo(ze);case"FeatureCollection":{var We={type:"FeatureCollection",features:ze.features.map(xo)};return ze.bbox!=null&&(We.bbox=ze.bbox),We}default:return to(ze)}}function va(ze,We){var et=y(We/2),ot=f(_*et);return[ze*(.74482-.34588*ot*ot),1.70711*et]}va.invert=function(ze,We){var et=We/1.70711,ot=f(_*et);return[ze/(.74482-.34588*ot*ot),2*e(et)]};function xi(){return g.geoProjection(va).scale(146.153)}function fo(ze,We,et){var ot=g.geoInterpolate(We,et),bt=ot(.5),mt=g.geoRotation([-bt[0],-bt[1]])(We),kt=ot.distance/2,fr=-z(f(mt[1]*k)/f(kt)),pr=[-bt[0],-bt[1],-(mt[0]>0?l-fr:fr)*T],sr=g.geoProjection(ze(kt)).rotate(pr),xr=g.geoRotation(pr),Dr=sr.center;return delete sr.rotate,sr.center=function(Xr){return arguments.length?Dr(xr(Xr)):xr.invert(Dr())},sr.clipAngle(90)}function go(ze){var We=n(ze);function et(ot,bt){var mt=g.geoGnomonicRaw(ot,bt);return mt[0]*=We,mt}return et.invert=function(ot,bt){return g.geoGnomonicRaw.invert(ot/We,bt)},et}function ls(){return ks([-158,21.5],[-77,39]).clipAngle(60).scale(400)}function ks(ze,We){return fo(go,ze,We)}function Fo(ze){if(!(ze*=2))return g.geoAzimuthalEquidistantRaw;var We=-ze/2,et=-We,ot=ze*ze,bt=y(et),mt=.5/f(et);function kt(fr,pr){var sr=I(n(pr)*n(fr-We)),xr=I(n(pr)*n(fr-et)),Dr=pr<0?-1:1;return sr*=sr,xr*=xr,[(sr-xr)/(2*ze),Dr*D(4*ot*xr-(ot-sr+xr)*(ot-sr+xr))/(2*ze)]}return kt.invert=function(fr,pr){var sr=pr*pr,xr=n(D(sr+(Xr=fr+We)*Xr)),Dr=n(D(sr+(Xr=fr+et)*Xr)),Xr,qr;return[a(qr=xr-Dr,Xr=(xr+Dr)*bt),(pr<0?-1:1)*I(D(Xr*Xr+qr*qr)*mt)]},kt}function Qs(){return ms([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)}function ms(ze,We){return fo(Fo,ze,We)}function us(ze,We){if(M(We)<o)return[ze,0];var et=M(We/w),ot=z(et);if(M(ze)<o||M(M(We)-w)<o)return[0,v(We)*l*y(ot/2)];var bt=n(ot),mt=M(l/ze-ze/l)/2,kt=mt*mt,fr=bt/(et+bt-1),pr=fr*(2/et-1),sr=pr*pr,xr=sr+kt,Dr=fr-sr,Xr=kt+fr;return[v(ze)*l*(mt*Dr+D(kt*Dr*Dr-xr*(fr*fr-sr)))/xr,v(We)*l*(pr*Xr-mt*D((kt+1)*xr-Xr*Xr))/xr]}us.invert=function(ze,We){if(M(We)<o)return[ze,0];if(M(ze)<o)return[0,w*f(2*e(We/l))];var et=(ze/=l)*ze,ot=(We/=l)*We,bt=et+ot,mt=bt*bt,kt=-M(We)*(1+bt),fr=kt-2*ot+et,pr=-2*kt+1+2*ot+mt,sr=ot/pr+(2*fr*fr*fr/(pr*pr*pr)-9*kt*fr/(pr*pr))/27,xr=(kt-fr*fr/(3*pr))/pr,Dr=2*D(-xr/3),Xr=I(3*sr/(xr*Dr))/3;return[l*(bt-1+D(1+2*(et-ot)+mt))/(2*ze),v(We)*l*(-Dr*n(Xr+l/3)-fr/(3*pr))]};function bo(){return g.geoProjection(us).scale(79.4183)}function Bl(ze,We){if(M(We)<o)return[ze,0];var et=M(We/w),ot=z(et);if(M(ze)<o||M(M(We)-w)<o)return[0,v(We)*l*y(ot/2)];var bt=n(ot),mt=M(l/ze-ze/l)/2,kt=mt*mt,fr=bt*(D(1+kt)-mt*bt)/(1+kt*et*et);return[v(ze)*l*fr,v(We)*l*D(1-fr*(2*mt+fr))]}Bl.invert=function(ze,We){if(!ze)return[0,w*f(2*e(We/l))];var et=M(ze/l),ot=(1-et*et-(We/=l)*We)/(2*et),bt=ot*ot,mt=D(bt+1);return[v(ze)*l*(mt-ot),v(We)*w*f(2*a(D((1-2*ot*et)*(ot+mt)-et),D(mt+ot+et)))]};function Ql(){return g.geoProjection(Bl).scale(79.4183)}function fs(ze,We){if(M(We)<o)return[ze,0];var et=We/w,ot=z(et);if(M(ze)<o||M(M(We)-w)<o)return[0,l*y(ot/2)];var bt=(l/ze-ze/l)/2,mt=et/(1+n(ot));return[l*(v(ze)*D(bt*bt+1-mt*mt)-bt),l*mt]}fs.invert=function(ze,We){if(!We)return[ze,0];var et=We/l,ot=(l*l*(1-et*et)-ze*ze)/(2*l*ze);return[ze?l*(v(ze)*D(ot*ot+1)-ot):0,w*f(2*e(et))]};function du(){return g.geoProjection(fs).scale(79.4183)}function Nl(ze,We){if(!We)return[ze,0];var et=M(We);if(!ze||et===w)return[0,We];var ot=et/w,bt=ot*ot,mt=(8*ot-bt*(bt+2)-5)/(2*bt*(ot-1)),kt=mt*mt,fr=ot*mt,pr=bt+kt+2*fr,sr=ot+3*mt,xr=ze/w,Dr=xr+1/xr,Xr=v(M(ze)-w)*D(Dr*Dr-4),qr=Xr*Xr,bn=pr*(bt+kt*qr-1)+(1-bt)*(bt*(sr*sr+4*kt)+12*fr*kt+4*kt*kt),Dn=(Xr*(pr+kt-1)+2*D(bn))/(4*pr+qr);return[v(ze)*w*Dn,v(We)*w*D(1+Xr*M(Dn)-Dn*Dn)]}Nl.invert=function(ze,We){var et;if(!ze||!We)return[ze,We];We/=l;var ot=v(ze)*ze/w,bt=(ot*ot-1+4*We*We)/M(ot),mt=bt*bt,kt=2*We,fr=50;do{var pr=kt*kt,sr=(8*kt-pr*(pr+2)-5)/(2*pr*(kt-1)),xr=(3*kt-pr*kt-10)/(2*pr*kt),Dr=sr*sr,Xr=kt*sr,qr=kt+sr,bn=qr*qr,Dn=kt+3*sr,Wn=bn*(pr+Dr*mt-1)+(1-pr)*(pr*(Dn*Dn+4*Dr)+Dr*(12*Xr+4*Dr)),ga=-2*qr*(4*Xr*Dr+(1-4*pr+3*pr*pr)*(1+xr)+Dr*(-6+14*pr-mt+(-8+8*pr-2*mt)*xr)+Xr*(-8+12*pr+(-10+10*pr-mt)*xr)),xa=D(Wn),Ka=bt*(bn+Dr-1)+2*xa-ot*(4*bn+mt),Ya=bt*(2*sr*xr+2*qr*(1+xr))+ga/xa-8*qr*(bt*(-1+Dr+bn)+2*xa)*(1+xr)/(mt+4*bn);kt-=et=Ka/Ya}while(et>o&&--fr>0);return[v(ze)*(D(bt*bt+4)+bt)*l/4,w*kt]};function gf(){return g.geoProjection(Nl).scale(127.16)}function Pu(ze,We,et,ot,bt){function mt(kt,fr){var pr=et*f(ot*fr),sr=D(1-pr*pr),xr=D(2/(1+sr*n(kt*=bt)));return[ze*sr*xr*f(kt),We*pr*xr]}return mt.invert=function(kt,fr){var pr=kt/ze,sr=fr/We,xr=D(pr*pr+sr*sr),Dr=2*z(xr/2);return[a(kt*y(Dr),ze*xr)/bt,xr&&z(fr*f(Dr)/(We*et*xr))/ot]},mt}function gu(ze,We,et,ot){var bt=l/3;ze=s(ze,o),We=s(We,o),ze=i(ze,w),We=i(We,l-o),et=s(et,0),et=i(et,100-o),ot=s(ot,o);var mt=et/100+1,kt=ot/100,fr=I(mt*n(bt))/bt,pr=f(ze)/f(fr*w),sr=We/l,xr=D(kt*f(ze/2)/f(We/2)),Dr=xr/D(sr*pr*fr),Xr=1/(xr*D(sr*pr*fr));return Pu(Dr,Xr,pr,fr,sr)}function Du(){var ze=65*k,We=60*k,et=20,ot=200,bt=g.geoProjectionMutator(gu),mt=bt(ze,We,et,ot);return mt.poleline=function(kt){return arguments.length?bt(ze=+kt*k,We,et,ot):ze*T},mt.parallels=function(kt){return arguments.length?bt(ze,We=+kt*k,et,ot):We*T},mt.inflation=function(kt){return arguments.length?bt(ze,We,et=+kt,ot):et},mt.ratio=function(kt){return arguments.length?bt(ze,We,et,ot=+kt):ot},mt.scale(163.775)}function Es(){return Du().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)}var Xu=4*l+3*D(3),Ru=2*D(2*l*D(3)/Xu),Iu=me(Ru*D(3)/l,Ru,Xu/6);function Oo(){return g.geoProjection(Iu).scale(176.84)}function zu(ze,We){return[ze*D(1-3*We*We/(l*l)),We]}zu.invert=function(ze,We){return[ze/D(1-3*We*We/(l*l)),We]};function tf(){return g.geoProjection(zu).scale(152.63)}function xs(ze,We){var et=n(We),ot=n(ze)*et,bt=1-ot,mt=n(ze=a(f(ze)*et,-f(We))),kt=f(ze);return et=D(1-ot*ot),[kt*et-mt*bt,-mt*et-kt*bt]}xs.invert=function(ze,We){var et=(ze*ze+We*We)/-2,ot=D(-et*(2+et)),bt=We*et+ze*ot,mt=ze*et-We*ot,kt=D(mt*mt+bt*bt);return[a(ot*bt,kt*(1+et)),kt?-z(ot*mt/kt):0]};function yu(){return g.geoProjection(xs).rotate([0,-90,45]).scale(124.75).clipAngle(180-.001)}function mu(ze,We){var et=Y(ze,We);return[(et[0]+ze/w)/2,(et[1]+We)/2]}mu.invert=function(ze,We){var et=ze,ot=We,bt=25;do{var mt=n(ot),kt=f(ot),fr=f(2*ot),pr=kt*kt,sr=mt*mt,xr=f(et),Dr=n(et/2),Xr=f(et/2),qr=Xr*Xr,bn=1-sr*Dr*Dr,Dn=bn?I(mt*Dr)*D(Wn=1/bn):Wn=0,Wn,ga=.5*(2*Dn*mt*Xr+et/w)-ze,xa=.5*(Dn*kt+ot)-We,Ka=.5*Wn*(sr*qr+Dn*mt*Dr*pr)+.5/w,Ya=Wn*(xr*fr/4-Dn*kt*Xr),ei=.125*Wn*(fr*Xr-Dn*kt*sr*xr),hi=.5*Wn*(pr*Dr+Dn*qr*mt)+.5,oo=Ya*ei-hi*Ka,ri=(xa*Ya-ga*hi)/oo,Yi=(ga*ei-xa*Ka)/oo;et-=ri,ot-=Yi}while((M(ri)>o||M(Yi)>o)&&--bt>0);return[et,ot]};function Fu(){return g.geoProjection(mu).scale(158.837)}A.geoNaturalEarth=g.geoNaturalEarth1,A.geoNaturalEarthRaw=g.geoNaturalEarth1Raw,A.geoAiry=W,A.geoAiryRaw=K,A.geoAitoff=re,A.geoAitoffRaw=Y,A.geoArmadillo=j,A.geoArmadilloRaw=ue,A.geoAugust=V,A.geoAugustRaw=q,A.geoBaker=X,A.geoBakerRaw=ne,A.geoBerghaus=ie,A.geoBerghausRaw=Q,A.geoBertin1953=ye,A.geoBertin1953Raw=de,A.geoBoggs=Xe,A.geoBoggsRaw=ke,A.geoBonne=ht,A.geoBonneRaw=Ge,A.geoBottomley=Kt,A.geoBottomleyRaw=Rt,A.geoBromley=Mt,A.geoBromleyRaw=It,A.geoChamberlin=Ae,A.geoChamberlinRaw=Ye,A.geoChamberlinAfrica=Ve,A.geoCollignon=Ze,A.geoCollignonRaw=Ue,A.geoCraig=_t,A.geoCraigRaw=Qe,A.geoCraster=Ut,A.geoCrasterRaw=wt,A.geoCylindricalEqualArea=Nt,A.geoCylindricalEqualAreaRaw=Dt,A.geoCylindricalStereographic=Ht,A.geoCylindricalStereographicRaw=Xt,A.geoEckert1=Vr,A.geoEckert1Raw=ar,A.geoEckert2=jr,A.geoEckert2Raw=nn,A.geoEckert3=$t,A.geoEckert3Raw=at,A.geoEckert4=ur,A.geoEckert4Raw=Zt,A.geoEckert5=$e,A.geoEckert5Raw=wr,A.geoEckert6=it,A.geoEckert6Raw=Je,A.geoEisenlohr=Bt,A.geoEisenlohrRaw=Tt,A.geoFahey=nt,A.geoFaheyRaw=Me,A.geoFoucaut=ct,A.geoFoucautRaw=st,A.geoFoucautSinusoidal=dt,A.geoFoucautSinusoidalRaw=At,A.geoGilbert=rr,A.geoGingery=Wr,A.geoGingeryRaw=kr,A.geoGinzburg4=Pr,A.geoGinzburg4Raw=yr,A.geoGinzburg5=Sr,A.geoGinzburg5Raw=Or,A.geoGinzburg6=Lt,A.geoGinzburg6Raw=tt,A.geoGinzburg8=ir,A.geoGinzburg8Raw=Wt,A.geoGinzburg9=Br,A.geoGinzburg9Raw=Ir,A.geoGringorten=cn,A.geoGringortenRaw=_r,A.geoGuyou=Ha,A.geoGuyouRaw=pa,A.geoHammer=oe,A.geoHammerRaw=se,A.geoHammerRetroazimuthal=Tr,A.geoHammerRetroazimuthalRaw=ja,A.geoHealpix=Ua,A.geoHealpixRaw=Zn,A.geoHill=Vt,A.geoHillRaw=li,A.geoHomolosine=xn,A.geoHomolosineRaw=Tn,A.geoHufnagel=gr,A.geoHufnagelRaw=un,A.geoHyperelliptical=On,A.geoHyperellipticalRaw=gn,A.geoInterrupt=aa,A.geoInterruptedBoggs=ma,A.geoInterruptedHomolosine=Aa,A.geoInterruptedMollweide=zo,A.geoInterruptedMollweideHemispheres=nl,A.geoInterruptedSinuMollweide=Yl,A.geoInterruptedSinusoidal=Gs,A.geoKavrayskiy7=Hi,A.geoKavrayskiy7Raw=Rs,A.geoLagrange=dl,A.geoLagrangeRaw=So,A.geoLarrivee=al,A.geoLarriveeRaw=Di,A.geoLaskowski=Oi,A.geoLaskowskiRaw=Qi,A.geoLittrow=$i,A.geoLittrowRaw=io,A.geoLoximuthal=Ys,A.geoLoximuthalRaw=rs,A.geoMiller=Jo,A.geoMillerRaw=au,A.geoModifiedStereographic=Ts,A.geoModifiedStereographicRaw=iu,A.geoModifiedStereographicAlaska=Ll,A.geoModifiedStereographicGs48=Su,A.geoModifiedStereographicGs50=ku,A.geoModifiedStereographicMiller=Ws,A.geoModifiedStereographicLee=Pl,A.geoMollweide=Pe,A.geoMollweideRaw=Ee,A.geoMtFlatPolarParabolic=ou,A.geoMtFlatPolarParabolicRaw=Xl,A.geoMtFlatPolarQuartic=Eu,A.geoMtFlatPolarQuarticRaw=Dl,A.geoMtFlatPolarSinusoidal=Zl,A.geoMtFlatPolarSinusoidalRaw=Xs,A.geoNaturalEarth2=ds,A.geoNaturalEarth2Raw=Rl,A.geoNellHammer=jl,A.geoNellHammerRaw=yl,A.geoInterruptedQuarticAuthalic=lu,A.geoNicolosi=Cu,A.geoNicolosiRaw=Il,A.geoPatterson=lo,A.geoPattersonRaw=Ms,A.geoPolyconic=xl,A.geoPolyconicRaw=ml,A.geoPolyhedral=js,A.geoPolyhedralButterfly=Tl,A.geoPolyhedralCollignon=Wu,A.geoPolyhedralWaterman=Ri,A.geoProject=is,A.geoGringortenQuincuncial=yt,A.geoPeirceQuincuncial=Ot,A.geoPierceQuincuncial=Ot,A.geoQuantize=cr,A.geoQuincuncial=pu,A.geoRectangularPolyconic=Rr,A.geoRectangularPolyconicRaw=or,A.geoRobinson=Mn,A.geoRobinsonRaw=dn,A.geoSatellite=yn,A.geoSatelliteRaw=Nn,A.geoSinuMollweide=en,A.geoSinuMollweideRaw=vn,A.geoSinusoidal=De,A.geoSinusoidalRaw=Ie,A.geoStitch=Ja,A.geoTimes=xi,A.geoTimesRaw=va,A.geoTwoPointAzimuthal=ks,A.geoTwoPointAzimuthalRaw=go,A.geoTwoPointAzimuthalUsa=ls,A.geoTwoPointEquidistant=ms,A.geoTwoPointEquidistantRaw=Fo,A.geoTwoPointEquidistantUsa=Qs,A.geoVanDerGrinten=bo,A.geoVanDerGrintenRaw=us,A.geoVanDerGrinten2=Ql,A.geoVanDerGrinten2Raw=Bl,A.geoVanDerGrinten3=du,A.geoVanDerGrinten3Raw=fs,A.geoVanDerGrinten4=gf,A.geoVanDerGrinten4Raw=Nl,A.geoWagner=Du,A.geoWagner7=Es,A.geoWagnerRaw=gu,A.geoWagner4=Oo,A.geoWagner4Raw=Iu,A.geoWagner6=tf,A.geoWagner6Raw=zu,A.geoWiechel=yu,A.geoWiechelRaw=xs,A.geoWinkel3=Fu,A.geoWinkel3Raw=mu,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-array":107,"d3-geo":114}],114:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,d("d3-array")):(A=A||self,g(A.d3=A.d3||{},A.d3))})(this,function(A,g){function S(){return new M}function M(){this.reset()}M.prototype={constructor:M,reset:function(){this.s=this.t=0},add:function(yt){a(e,yt,this.t),a(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new M;function a(yt,Ot,cr){var or=yt.s=Ot+cr,Rr=or-Ot,tn=or-Rr;yt.t=Ot-tn+(cr-Rr)}var n=1e-6,r=1e-12,t=Math.PI,c=t/2,s=t/4,i=t*2,x=180/t,p=t/180,v=Math.abs,f=Math.atan,y=Math.atan2,o=Math.cos,m=Math.ceil,l=Math.exp,w=Math.log,_=Math.pow,h=Math.sin,b=Math.sign||function(yt){return yt>0?1:yt<0?-1:0},u=Math.sqrt,L=Math.tan;function T(yt){return yt>1?0:yt<-1?t:Math.acos(yt)}function k(yt){return yt>1?c:yt<-1?-c:Math.asin(yt)}function P(yt){return(yt=h(yt/2))*yt}function z(){}function I(yt,Ot){yt&&R.hasOwnProperty(yt.type)&&R[yt.type](yt,Ot)}var D={Feature:function(yt,Ot){I(yt.geometry,Ot)},FeatureCollection:function(yt,Ot){for(var cr=yt.features,or=-1,Rr=cr.length;++or<Rr;)I(cr[or].geometry,Ot)}},R={Sphere:function(yt,Ot){Ot.sphere()},Point:function(yt,Ot){yt=yt.coordinates,Ot.point(yt[0],yt[1],yt[2])},MultiPoint:function(yt,Ot){for(var cr=yt.coordinates,or=-1,Rr=cr.length;++or<Rr;)yt=cr[or],Ot.point(yt[0],yt[1],yt[2])},LineString:function(yt,Ot){O(yt.coordinates,Ot,0)},MultiLineString:function(yt,Ot){for(var cr=yt.coordinates,or=-1,Rr=cr.length;++or<Rr;)O(cr[or],Ot,0)},Polygon:function(yt,Ot){F(yt.coordinates,Ot)},MultiPolygon:function(yt,Ot){for(var cr=yt.coordinates,or=-1,Rr=cr.length;++or<Rr;)F(cr[or],Ot)},GeometryCollection:function(yt,Ot){for(var cr=yt.geometries,or=-1,Rr=cr.length;++or<Rr;)I(cr[or],Ot)}};function O(yt,Ot,cr){var or=-1,Rr=yt.length-cr,tn;for(Ot.lineStart();++or<Rr;)tn=yt[or],Ot.point(tn[0],tn[1],tn[2]);Ot.lineEnd()}function F(yt,Ot){var cr=-1,or=yt.length;for(Ot.polygonStart();++cr<or;)O(yt[cr],Ot,1);Ot.polygonEnd()}function N(yt,Ot){yt&&D.hasOwnProperty(yt.type)?D[yt.type](yt,Ot):I(yt,Ot)}var G=S(),K=S(),W,Y,re,ue,j,q={point:z,lineStart:z,lineEnd:z,polygonStart:function(){G.reset(),q.lineStart=V,q.lineEnd=U},polygonEnd:function(){var yt=+G;K.add(yt<0?i+yt:yt),this.lineStart=this.lineEnd=this.point=z},sphere:function(){K.add(i)}};function V(){q.point=$}function U(){ne(W,Y)}function $(yt,Ot){q.point=ne,W=yt,Y=Ot,yt*=p,Ot*=p,re=yt,ue=o(Ot=Ot/2+s),j=h(Ot)}function ne(yt,Ot){yt*=p,Ot*=p,Ot=Ot/2+s;var cr=yt-re,or=cr>=0?1:-1,Rr=or*cr,tn=o(Ot),dn=h(Ot),Mn=j*dn,Ln=ue*tn+Mn*o(Rr),Nn=Mn*or*h(Rr);G.add(y(Nn,Ln)),re=yt,ue=tn,j=dn}function X(yt){return K.reset(),N(yt,q),K*2}function Q(yt){return[y(yt[1],yt[0]),k(yt[2])]}function ie(yt){var Ot=yt[0],cr=yt[1],or=o(cr);return[or*o(Ot),or*h(Ot),h(cr)]}function se(yt,Ot){return yt[0]*Ot[0]+yt[1]*Ot[1]+yt[2]*Ot[2]}function ae(yt,Ot){return[yt[1]*Ot[2]-yt[2]*Ot[1],yt[2]*Ot[0]-yt[0]*Ot[2],yt[0]*Ot[1]-yt[1]*Ot[0]]}function oe(yt,Ot){yt[0]+=Ot[0],yt[1]+=Ot[1],yt[2]+=Ot[2]}function be(yt,Ot){return[yt[0]*Ot,yt[1]*Ot,yt[2]*Ot]}function ce(yt){var Ot=u(yt[0]*yt[0]+yt[1]*yt[1]+yt[2]*yt[2]);yt[0]/=Ot,yt[1]/=Ot,yt[2]/=Ot}var de,ye,ge,me,Ee,Pe,Ne,we,ke=S(),Xe,He,Ie={point:De,lineStart:ht,lineEnd:Rt,polygonStart:function(){Ie.point=Kt,Ie.lineStart=It,Ie.lineEnd=Mt,ke.reset(),q.polygonStart()},polygonEnd:function(){q.polygonEnd(),Ie.point=De,Ie.lineStart=ht,Ie.lineEnd=Rt,G<0?(de=-(ge=180),ye=-(me=90)):ke>n?me=90:ke<-n&&(ye=-90),He[0]=de,He[1]=ge},sphere:function(){de=-(ge=180),ye=-(me=90)}};function De(yt,Ot){Xe.push(He=[de=yt,ge=yt]),Ot<ye&&(ye=Ot),Ot>me&&(me=Ot)}function Ge(yt,Ot){var cr=ie([yt*p,Ot*p]);if(we){var or=ae(we,cr),Rr=[or[1],-or[0],0],tn=ae(Rr,or);ce(tn),tn=Q(tn);var dn=yt-Ee,Mn=dn>0?1:-1,Ln=tn[0]*x*Mn,Nn,yn=v(dn)>180;yn^(Mn*Ee<Ln&&Ln<Mn*yt)?(Nn=tn[1]*x,Nn>me&&(me=Nn)):(Ln=(Ln+360)%360-180,yn^(Mn*Ee<Ln&&Ln<Mn*yt)?(Nn=-tn[1]*x,Nn<ye&&(ye=Nn)):(Ot<ye&&(ye=Ot),Ot>me&&(me=Ot))),yn?yt<Ee?Yt(de,yt)>Yt(de,ge)&&(ge=yt):Yt(yt,ge)>Yt(de,ge)&&(de=yt):ge>=de?(yt<de&&(de=yt),yt>ge&&(ge=yt)):yt>Ee?Yt(de,yt)>Yt(de,ge)&&(ge=yt):Yt(yt,ge)>Yt(de,ge)&&(de=yt)}else Xe.push(He=[de=yt,ge=yt]);Ot<ye&&(ye=Ot),Ot>me&&(me=Ot),we=cr,Ee=yt}function ht(){Ie.point=Ge}function Rt(){He[0]=de,He[1]=ge,Ie.point=De,we=null}function Kt(yt,Ot){if(we){var cr=yt-Ee;ke.add(v(cr)>180?cr+(cr>0?360:-360):cr)}else Pe=yt,Ne=Ot;q.point(yt,Ot),Ge(yt,Ot)}function It(){q.lineStart()}function Mt(){Kt(Pe,Ne),q.lineEnd(),v(ke)>n&&(de=-(ge=180)),He[0]=de,He[1]=ge,we=null}function Yt(yt,Ot){return(Ot-=yt)<0?Ot+360:Ot}function zt(yt,Ot){return yt[0]-Ot[0]}function St(yt,Ot){return yt[0]<=yt[1]?yt[0]<=Ot&&Ot<=yt[1]:Ot<yt[0]||yt[1]<Ot}function Ye(yt){var Ot,cr,or,Rr,tn,dn,Mn;if(me=ge=-(de=ye=1/0),Xe=[],N(yt,Ie),cr=Xe.length){for(Xe.sort(zt),Ot=1,or=Xe[0],tn=[or];Ot<cr;++Ot)Rr=Xe[Ot],St(or,Rr[0])||St(or,Rr[1])?(Yt(or[0],Rr[1])>Yt(or[0],or[1])&&(or[1]=Rr[1]),Yt(Rr[0],or[1])>Yt(or[0],or[1])&&(or[0]=Rr[0])):tn.push(or=Rr);for(dn=-1/0,cr=tn.length-1,Ot=0,or=tn[cr];Ot<=cr;or=Rr,++Ot)Rr=tn[Ot],(Mn=Yt(or[1],Rr[0]))>dn&&(dn=Mn,de=Rr[0],ge=or[1])}return Xe=He=null,de===1/0||ye===1/0?[[NaN,NaN],[NaN,NaN]]:[[de,ye],[ge,me]]}var rt,Ve,Ae,Ue,Ze,Qe,_t,gt,wt,Ut,Dt,Nt,Xt,Ht,ar,Vr,nn={sphere:z,point:jr,lineStart:$t,lineEnd:wr,polygonStart:function(){nn.lineStart=$e,nn.lineEnd=Je},polygonEnd:function(){nn.lineStart=$t,nn.lineEnd=wr}};function jr(yt,Ot){yt*=p,Ot*=p;var cr=o(Ot);at(cr*o(yt),cr*h(yt),h(Ot))}function at(yt,Ot,cr){++rt,Ae+=(yt-Ae)/rt,Ue+=(Ot-Ue)/rt,Ze+=(cr-Ze)/rt}function $t(){nn.point=Zt}function Zt(yt,Ot){yt*=p,Ot*=p;var cr=o(Ot);Ht=cr*o(yt),ar=cr*h(yt),Vr=h(Ot),nn.point=ur,at(Ht,ar,Vr)}function ur(yt,Ot){yt*=p,Ot*=p;var cr=o(Ot),or=cr*o(yt),Rr=cr*h(yt),tn=h(Ot),dn=y(u((dn=ar*tn-Vr*Rr)*dn+(dn=Vr*or-Ht*tn)*dn+(dn=Ht*Rr-ar*or)*dn),Ht*or+ar*Rr+Vr*tn);Ve+=dn,Qe+=dn*(Ht+(Ht=or)),_t+=dn*(ar+(ar=Rr)),gt+=dn*(Vr+(Vr=tn)),at(Ht,ar,Vr)}function wr(){nn.point=jr}function $e(){nn.point=it}function Je(){lt(Nt,Xt),nn.point=jr}function it(yt,Ot){Nt=yt,Xt=Ot,yt*=p,Ot*=p,nn.point=lt;var cr=o(Ot);Ht=cr*o(yt),ar=cr*h(yt),Vr=h(Ot),at(Ht,ar,Vr)}function lt(yt,Ot){yt*=p,Ot*=p;var cr=o(Ot),or=cr*o(yt),Rr=cr*h(yt),tn=h(Ot),dn=ar*tn-Vr*Rr,Mn=Vr*or-Ht*tn,Ln=Ht*Rr-ar*or,Nn=u(dn*dn+Mn*Mn+Ln*Ln),yn=k(Nn),zn=Nn&&-yn/Nn;wt+=zn*dn,Ut+=zn*Mn,Dt+=zn*Ln,Ve+=yn,Qe+=yn*(Ht+(Ht=or)),_t+=yn*(ar+(ar=Rr)),gt+=yn*(Vr+(Vr=tn)),at(Ht,ar,Vr)}function Tt(yt){rt=Ve=Ae=Ue=Ze=Qe=_t=gt=wt=Ut=Dt=0,N(yt,nn);var Ot=wt,cr=Ut,or=Dt,Rr=Ot*Ot+cr*cr+or*or;return Rr<r&&(Ot=Qe,cr=_t,or=gt,Ve<n&&(Ot=Ae,cr=Ue,or=Ze),Rr=Ot*Ot+cr*cr+or*or,Rr<r)?[NaN,NaN]:[y(cr,Ot)*x,k(or/u(Rr))*x]}function Bt(yt){return function(){return yt}}function Ce(yt,Ot){function cr(or,Rr){return or=yt(or,Rr),Ot(or[0],or[1])}return yt.invert&&Ot.invert&&(cr.invert=function(or,Rr){return or=Ot.invert(or,Rr),or&&yt.invert(or[0],or[1])}),cr}function Me(yt,Ot){return[v(yt)>t?yt+Math.round(-yt/i)*i:yt,Ot]}Me.invert=Me;function nt(yt,Ot,cr){return(yt%=i)?Ot||cr?Ce(ct(yt),At(Ot,cr)):ct(yt):Ot||cr?At(Ot,cr):Me}function st(yt){return function(Ot,cr){return Ot+=yt,[Ot>t?Ot-i:Ot<-t?Ot+i:Ot,cr]}}function ct(yt){var Ot=st(yt);return Ot.invert=st(-yt),Ot}function At(yt,Ot){var cr=o(yt),or=h(yt),Rr=o(Ot),tn=h(Ot);function dn(Mn,Ln){var Nn=o(Ln),yn=o(Mn)*Nn,zn=h(Mn)*Nn,Pn=h(Ln),Vn=Pn*cr+yn*or;return[y(zn*Rr-Vn*tn,yn*cr-Pn*or),k(Vn*Rr+zn*tn)]}return dn.invert=function(Mn,Ln){var Nn=o(Ln),yn=o(Mn)*Nn,zn=h(Mn)*Nn,Pn=h(Ln),Vn=Pn*Rr-zn*tn;return[y(zn*Rr+Pn*tn,yn*cr+Vn*or),k(Vn*cr-yn*or)]},dn}function dt(yt){yt=nt(yt[0]*p,yt[1]*p,yt.length>2?yt[2]*p:0);function Ot(cr){return cr=yt(cr[0]*p,cr[1]*p),cr[0]*=x,cr[1]*=x,cr}return Ot.invert=function(cr){return cr=yt.invert(cr[0]*p,cr[1]*p),cr[0]*=x,cr[1]*=x,cr},Ot}function Ct(yt,Ot,cr,or,Rr,tn){if(!!cr){var dn=o(Ot),Mn=h(Ot),Ln=or*cr;Rr==null?(Rr=Ot+or*i,tn=Ot-Ln/2):(Rr=Gt(dn,Rr),tn=Gt(dn,tn),(or>0?Rr<tn:Rr>tn)&&(Rr+=or*i));for(var Nn,yn=Rr;or>0?yn>tn:yn<tn;yn-=Ln)Nn=Q([dn,-Mn*o(yn),-Mn*h(yn)]),yt.point(Nn[0],Nn[1])}}function Gt(yt,Ot){Ot=ie(Ot),Ot[0]-=yt,ce(Ot);var cr=T(-Ot[1]);return((-Ot[2]<0?-cr:cr)+i-n)%i}function rr(){var yt=Bt([0,0]),Ot=Bt(90),cr=Bt(6),or,Rr,tn={point:dn};function dn(Ln,Nn){or.push(Ln=Rr(Ln,Nn)),Ln[0]*=x,Ln[1]*=x}function Mn(){var Ln=yt.apply(this,arguments),Nn=Ot.apply(this,arguments)*p,yn=cr.apply(this,arguments)*p;return or=[],Rr=nt(-Ln[0]*p,-Ln[1]*p,0).invert,Ct(tn,Nn,yn,1),Ln={type:"Polygon",coordinates:[or]},or=Rr=null,Ln}return Mn.center=function(Ln){return arguments.length?(yt=typeof Ln=="function"?Ln:Bt([+Ln[0],+Ln[1]]),Mn):yt},Mn.radius=function(Ln){return arguments.length?(Ot=typeof Ln=="function"?Ln:Bt(+Ln),Mn):Ot},Mn.precision=function(Ln){return arguments.length?(cr=typeof Ln=="function"?Ln:Bt(+Ln),Mn):cr},Mn}function kr(){var yt=[],Ot;return{point:function(cr,or,Rr){Ot.push([cr,or,Rr])},lineStart:function(){yt.push(Ot=[])},lineEnd:z,rejoin:function(){yt.length>1&&yt.push(yt.pop().concat(yt.shift()))},result:function(){var cr=yt;return yt=[],Ot=null,cr}}}function br(yt,Ot){return v(yt[0]-Ot[0])<n&&v(yt[1]-Ot[1])<n}function Ar(yt,Ot,cr,or){this.x=yt,this.z=Ot,this.o=cr,this.e=or,this.v=!1,this.n=this.p=null}function Wr(yt,Ot,cr,or,Rr){var tn=[],dn=[],Mn,Ln;if(yt.forEach(function($n){if(!((za=$n.length-1)<=0)){var za,Ea=$n[0],Fa=$n[za],Oa;if(br(Ea,Fa)){if(!Ea[2]&&!Fa[2]){for(Rr.lineStart(),Mn=0;Mn<za;++Mn)Rr.point((Ea=$n[Mn])[0],Ea[1]);Rr.lineEnd();return}Fa[0]+=2*n}tn.push(Oa=new Ar(Ea,$n,null,!0)),dn.push(Oa.o=new Ar(Ea,null,Oa,!1)),tn.push(Oa=new Ar(Fa,$n,null,!1)),dn.push(Oa.o=new Ar(Fa,null,Oa,!0))}}),!!tn.length){for(dn.sort(Ot),nr(tn),nr(dn),Mn=0,Ln=dn.length;Mn<Ln;++Mn)dn[Mn].e=cr=!cr;for(var Nn=tn[0],yn,zn;;){for(var Pn=Nn,Vn=!0;Pn.v;)if((Pn=Pn.n)===Nn)return;yn=Pn.z,Rr.lineStart();do{if(Pn.v=Pn.o.v=!0,Pn.e){if(Vn)for(Mn=0,Ln=yn.length;Mn<Ln;++Mn)Rr.point((zn=yn[Mn])[0],zn[1]);else or(Pn.x,Pn.n.x,1,Rr);Pn=Pn.n}else{if(Vn)for(yn=Pn.p.z,Mn=yn.length-1;Mn>=0;--Mn)Rr.point((zn=yn[Mn])[0],zn[1]);else or(Pn.x,Pn.p.x,-1,Rr);Pn=Pn.p}Pn=Pn.o,yn=Pn.z,Vn=!Vn}while(!Pn.v);Rr.lineEnd()}}}function nr(yt){if(!!(Ot=yt.length)){for(var Ot,cr=0,or=yt[0],Rr;++cr<Ot;)or.n=Rr=yt[cr],Rr.p=or,or=Rr;or.n=Rr=yt[0],Rr.p=or}}var yr=S();function Pr(yt){return v(yt[0])<=t?yt[0]:b(yt[0])*((v(yt[0])+t)%i-t)}function Or(yt,Ot){var cr=Pr(Ot),or=Ot[1],Rr=h(or),tn=[h(cr),-o(cr),0],dn=0,Mn=0;yr.reset(),Rr===1?or=c+n:Rr===-1&&(or=-c-n);for(var Ln=0,Nn=yt.length;Ln<Nn;++Ln)if(!!(zn=(yn=yt[Ln]).length))for(var yn,zn,Pn=yn[zn-1],Vn=Pr(Pn),$n=Pn[1]/2+s,za=h($n),Ea=o($n),Fa=0;Fa<zn;++Fa,Vn=Jn,za=Ga,Ea=Qa,Pn=Oa){var Oa=yn[Fa],Jn=Pr(Oa),ha=Oa[1]/2+s,Ga=h(ha),Qa=o(ha),di=Jn-Vn,gi=di>=0?1:-1,mi=gi*di,Ai=mi>t,oi=za*Ga;if(yr.add(y(oi*gi*h(mi),Ea*Qa+oi*o(mi))),dn+=Ai?di+gi*i:di,Ai^Vn>=cr^Jn>=cr){var xo=ae(ie(Pn),ie(Oa));ce(xo);var to=ae(tn,xo);ce(to);var Ja=(Ai^di>=0?-1:1)*k(to[2]);(or>Ja||or===Ja&&(xo[0]||xo[1]))&&(Mn+=Ai^di>=0?1:-1)}}return(dn<-n||dn<n&&yr<-n)^Mn&1}function Sr(yt,Ot,cr,or){return function(Rr){var tn=Ot(Rr),dn=kr(),Mn=Ot(dn),Ln=!1,Nn,yn,zn,Pn={point:Vn,lineStart:za,lineEnd:Ea,polygonStart:function(){Pn.point=Fa,Pn.lineStart=Oa,Pn.lineEnd=Jn,yn=[],Nn=[]},polygonEnd:function(){Pn.point=Vn,Pn.lineStart=za,Pn.lineEnd=Ea,yn=g.merge(yn);var ha=Or(Nn,or);yn.length?(Ln||(Rr.polygonStart(),Ln=!0),Wr(yn,Lt,ha,cr,Rr)):ha&&(Ln||(Rr.polygonStart(),Ln=!0),Rr.lineStart(),cr(null,null,1,Rr),Rr.lineEnd()),Ln&&(Rr.polygonEnd(),Ln=!1),yn=Nn=null},sphere:function(){Rr.polygonStart(),Rr.lineStart(),cr(null,null,1,Rr),Rr.lineEnd(),Rr.polygonEnd()}};function Vn(ha,Ga){yt(ha,Ga)&&Rr.point(ha,Ga)}function $n(ha,Ga){tn.point(ha,Ga)}function za(){Pn.point=$n,tn.lineStart()}function Ea(){Pn.point=Vn,tn.lineEnd()}function Fa(ha,Ga){zn.push([ha,Ga]),Mn.point(ha,Ga)}function Oa(){Mn.lineStart(),zn=[]}function Jn(){Fa(zn[0][0],zn[0][1]),Mn.lineEnd();var ha=Mn.clean(),Ga=dn.result(),Qa,di=Ga.length,gi,mi,Ai;if(zn.pop(),Nn.push(zn),zn=null,!!di){if(ha&1){if(mi=Ga[0],(gi=mi.length-1)>0){for(Ln||(Rr.polygonStart(),Ln=!0),Rr.lineStart(),Qa=0;Qa<gi;++Qa)Rr.point((Ai=mi[Qa])[0],Ai[1]);Rr.lineEnd()}return}di>1&&ha&2&&Ga.push(Ga.pop().concat(Ga.shift())),yn.push(Ga.filter(tt))}}return Pn}}function tt(yt){return yt.length>1}function Lt(yt,Ot){return((yt=yt.x)[0]<0?yt[1]-c-n:c-yt[1])-((Ot=Ot.x)[0]<0?Ot[1]-c-n:c-Ot[1])}var Wt=Sr(function(){return!0},ir,Br,[-t,-c]);function ir(yt){var Ot=NaN,cr=NaN,or=NaN,Rr;return{lineStart:function(){yt.lineStart(),Rr=1},point:function(tn,dn){var Mn=tn>0?t:-t,Ln=v(tn-Ot);v(Ln-t)<n?(yt.point(Ot,cr=(cr+dn)/2>0?c:-c),yt.point(or,cr),yt.lineEnd(),yt.lineStart(),yt.point(Mn,cr),yt.point(tn,cr),Rr=0):or!==Mn&&Ln>=t&&(v(Ot-or)<n&&(Ot-=or*n),v(tn-Mn)<n&&(tn-=Mn*n),cr=Ir(Ot,cr,tn,dn),yt.point(or,cr),yt.lineEnd(),yt.lineStart(),yt.point(Mn,cr),Rr=0),yt.point(Ot=tn,cr=dn),or=Mn},lineEnd:function(){yt.lineEnd(),Ot=cr=NaN},clean:function(){return 2-Rr}}}function Ir(yt,Ot,cr,or){var Rr,tn,dn=h(yt-cr);return v(dn)>n?f((h(Ot)*(tn=o(or))*h(cr)-h(or)*(Rr=o(Ot))*h(yt))/(Rr*tn*dn)):(Ot+or)/2}function Br(yt,Ot,cr,or){var Rr;if(yt==null)Rr=cr*c,or.point(-t,Rr),or.point(0,Rr),or.point(t,Rr),or.point(t,0),or.point(t,-Rr),or.point(0,-Rr),or.point(-t,-Rr),or.point(-t,0),or.point(-t,Rr);else if(v(yt[0]-Ot[0])>n){var tn=yt[0]<Ot[0]?t:-t;Rr=cr*tn/2,or.point(-tn,Rr),or.point(0,Rr),or.point(tn,Rr)}else or.point(Ot[0],Ot[1])}function Er(yt){var Ot=o(yt),cr=6*p,or=Ot>0,Rr=v(Ot)>n;function tn(yn,zn,Pn,Vn){Ct(Vn,yt,cr,Pn,yn,zn)}function dn(yn,zn){return o(yn)*o(zn)>Ot}function Mn(yn){var zn,Pn,Vn,$n,za;return{lineStart:function(){$n=Vn=!1,za=1},point:function(Ea,Fa){var Oa=[Ea,Fa],Jn,ha=dn(Ea,Fa),Ga=or?ha?0:Nn(Ea,Fa):ha?Nn(Ea+(Ea<0?t:-t),Fa):0;if(!zn&&($n=Vn=ha)&&yn.lineStart(),ha!==Vn&&(Jn=Ln(zn,Oa),(!Jn||br(zn,Jn)||br(Oa,Jn))&&(Oa[2]=1)),ha!==Vn)za=0,ha?(yn.lineStart(),Jn=Ln(Oa,zn),yn.point(Jn[0],Jn[1])):(Jn=Ln(zn,Oa),yn.point(Jn[0],Jn[1],2),yn.lineEnd()),zn=Jn;else if(Rr&&zn&&or^ha){var Qa;!(Ga&Pn)&&(Qa=Ln(Oa,zn,!0))&&(za=0,or?(yn.lineStart(),yn.point(Qa[0][0],Qa[0][1]),yn.point(Qa[1][0],Qa[1][1]),yn.lineEnd()):(yn.point(Qa[1][0],Qa[1][1]),yn.lineEnd(),yn.lineStart(),yn.point(Qa[0][0],Qa[0][1],3)))}ha&&(!zn||!br(zn,Oa))&&yn.point(Oa[0],Oa[1]),zn=Oa,Vn=ha,Pn=Ga},lineEnd:function(){Vn&&yn.lineEnd(),zn=null},clean:function(){return za|($n&&Vn)<<1}}}function Ln(yn,zn,Pn){var Vn=ie(yn),$n=ie(zn),za=[1,0,0],Ea=ae(Vn,$n),Fa=se(Ea,Ea),Oa=Ea[0],Jn=Fa-Oa*Oa;if(!Jn)return!Pn&&yn;var ha=Ot*Fa/Jn,Ga=-Ot*Oa/Jn,Qa=ae(za,Ea),di=be(za,ha),gi=be(Ea,Ga);oe(di,gi);var mi=Qa,Ai=se(di,mi),oi=se(mi,mi),xo=Ai*Ai-oi*(se(di,di)-1);if(!(xo<0)){var to=u(xo),Ja=be(mi,(-Ai-to)/oi);if(oe(Ja,di),Ja=Q(Ja),!Pn)return Ja;var va=yn[0],xi=zn[0],fo=yn[1],go=zn[1],ls;xi<va&&(ls=va,va=xi,xi=ls);var ks=xi-va,Fo=v(ks-t)<n,Qs=Fo||ks<n;if(!Fo&&go<fo&&(ls=fo,fo=go,go=ls),Qs?Fo?fo+go>0^Ja[1]<(v(Ja[0]-va)<n?fo:go):fo<=Ja[1]&&Ja[1]<=go:ks>t^(va<=Ja[0]&&Ja[0]<=xi)){var ms=be(mi,(-Ai+to)/oi);return oe(ms,di),[Ja,Q(ms)]}}}function Nn(yn,zn){var Pn=or?yt:t-yt,Vn=0;return yn<-Pn?Vn|=1:yn>Pn&&(Vn|=2),zn<-Pn?Vn|=4:zn>Pn&&(Vn|=8),Vn}return Sr(dn,Mn,tn,or?[0,-yt]:[-t,yt-t])}function _r(yt,Ot,cr,or,Rr,tn){var dn=yt[0],Mn=yt[1],Ln=Ot[0],Nn=Ot[1],yn=0,zn=1,Pn=Ln-dn,Vn=Nn-Mn,$n;if($n=cr-dn,!(!Pn&&$n>0)){if($n/=Pn,Pn<0){if($n<yn)return;$n<zn&&(zn=$n)}else if(Pn>0){if($n>zn)return;$n>yn&&(yn=$n)}if($n=Rr-dn,!(!Pn&&$n<0)){if($n/=Pn,Pn<0){if($n>zn)return;$n>yn&&(yn=$n)}else if(Pn>0){if($n<yn)return;$n<zn&&(zn=$n)}if($n=or-Mn,!(!Vn&&$n>0)){if($n/=Vn,Vn<0){if($n<yn)return;$n<zn&&(zn=$n)}else if(Vn>0){if($n>zn)return;$n>yn&&(yn=$n)}if($n=tn-Mn,!(!Vn&&$n<0)){if($n/=Vn,Vn<0){if($n>zn)return;$n>yn&&(yn=$n)}else if(Vn>0){if($n<yn)return;$n<zn&&(zn=$n)}return yn>0&&(yt[0]=dn+yn*Pn,yt[1]=Mn+yn*Vn),zn<1&&(Ot[0]=dn+zn*Pn,Ot[1]=Mn+zn*Vn),!0}}}}}var Gr=1e9,wn=-Gr;function cn(yt,Ot,cr,or){function Rr(Nn,yn){return yt<=Nn&&Nn<=cr&&Ot<=yn&&yn<=or}function tn(Nn,yn,zn,Pn){var Vn=0,$n=0;if(Nn==null||(Vn=dn(Nn,zn))!==($n=dn(yn,zn))||Ln(Nn,yn)<0^zn>0)do Pn.point(Vn===0||Vn===3?yt:cr,Vn>1?or:Ot);while((Vn=(Vn+zn+4)%4)!==$n);else Pn.point(yn[0],yn[1])}function dn(Nn,yn){return v(Nn[0]-yt)<n?yn>0?0:3:v(Nn[0]-cr)<n?yn>0?2:1:v(Nn[1]-Ot)<n?yn>0?1:0:yn>0?3:2}function Mn(Nn,yn){return Ln(Nn.x,yn.x)}function Ln(Nn,yn){var zn=dn(Nn,1),Pn=dn(yn,1);return zn!==Pn?zn-Pn:zn===0?yn[1]-Nn[1]:zn===1?Nn[0]-yn[0]:zn===2?Nn[1]-yn[1]:yn[0]-Nn[0]}return function(Nn){var yn=Nn,zn=kr(),Pn,Vn,$n,za,Ea,Fa,Oa,Jn,ha,Ga,Qa,di={point:gi,lineStart:xo,lineEnd:to,polygonStart:Ai,polygonEnd:oi};function gi(va,xi){Rr(va,xi)&&yn.point(va,xi)}function mi(){for(var va=0,xi=0,fo=Vn.length;xi<fo;++xi)for(var go=Vn[xi],ls=1,ks=go.length,Fo=go[0],Qs,ms,us=Fo[0],bo=Fo[1];ls<ks;++ls)Qs=us,ms=bo,Fo=go[ls],us=Fo[0],bo=Fo[1],ms<=or?bo>or&&(us-Qs)*(or-ms)>(bo-ms)*(yt-Qs)&&++va:bo<=or&&(us-Qs)*(or-ms)<(bo-ms)*(yt-Qs)&&--va;return va}function Ai(){yn=zn,Pn=[],Vn=[],Qa=!0}function oi(){var va=mi(),xi=Qa&&va,fo=(Pn=g.merge(Pn)).length;(xi||fo)&&(Nn.polygonStart(),xi&&(Nn.lineStart(),tn(null,null,1,Nn),Nn.lineEnd()),fo&&Wr(Pn,Mn,va,tn,Nn),Nn.polygonEnd()),yn=Nn,Pn=Vn=$n=null}function xo(){di.point=Ja,Vn&&Vn.push($n=[]),Ga=!0,ha=!1,Oa=Jn=NaN}function to(){Pn&&(Ja(za,Ea),Fa&&ha&&zn.rejoin(),Pn.push(zn.result())),di.point=gi,ha&&yn.lineEnd()}function Ja(va,xi){var fo=Rr(va,xi);if(Vn&&$n.push([va,xi]),Ga)za=va,Ea=xi,Fa=fo,Ga=!1,fo&&(yn.lineStart(),yn.point(va,xi));else if(fo&&ha)yn.point(va,xi);else{var go=[Oa=Math.max(wn,Math.min(Gr,Oa)),Jn=Math.max(wn,Math.min(Gr,Jn))],ls=[va=Math.max(wn,Math.min(Gr,va)),xi=Math.max(wn,Math.min(Gr,xi))];_r(go,ls,yt,Ot,cr,or)?(ha||(yn.lineStart(),yn.point(go[0],go[1])),yn.point(ls[0],ls[1]),fo||yn.lineEnd(),Qa=!1):fo&&(yn.lineStart(),yn.point(va,xi),Qa=!1)}Oa=va,Jn=xi,ha=fo}return di}}function Bn(){var yt=0,Ot=0,cr=960,or=500,Rr,tn,dn;return dn={stream:function(Mn){return Rr&&tn===Mn?Rr:Rr=cn(yt,Ot,cr,or)(tn=Mn)},extent:function(Mn){return arguments.length?(yt=+Mn[0][0],Ot=+Mn[0][1],cr=+Mn[1][0],or=+Mn[1][1],Rr=tn=null,dn):[[yt,Ot],[cr,or]]}}}var En=S(),Yn,Hn,pa,Ma={sphere:z,point:z,lineStart:ci,lineEnd:z,polygonStart:z,polygonEnd:z};function ci(){Ma.point=ja,Ma.lineEnd=Ha}function Ha(){Ma.point=Ma.lineEnd=z}function ja(yt,Ot){yt*=p,Ot*=p,Yn=yt,Hn=h(Ot),pa=o(Ot),Ma.point=Wa}function Wa(yt,Ot){yt*=p,Ot*=p;var cr=h(Ot),or=o(Ot),Rr=v(yt-Yn),tn=o(Rr),dn=h(Rr),Mn=or*dn,Ln=pa*cr-Hn*or*tn,Nn=Hn*cr+pa*or*tn;En.add(y(u(Mn*Mn+Ln*Ln),Nn)),Yn=yt,Hn=cr,pa=or}function Tr(yt){return En.reset(),N(yt,Ma),+En}var pn=[null,null],fn={type:"LineString",coordinates:pn};function An(yt,Ot){return pn[0]=yt,pn[1]=Ot,Tr(fn)}var Zn={Feature:function(yt,Ot){return ea(yt.geometry,Ot)},FeatureCollection:function(yt,Ot){for(var cr=yt.features,or=-1,Rr=cr.length;++or<Rr;)if(ea(cr[or].geometry,Ot))return!0;return!1}},ua={Sphere:function(){return!0},Point:function(yt,Ot){return Rn(yt.coordinates,Ot)},MultiPoint:function(yt,Ot){for(var cr=yt.coordinates,or=-1,Rr=cr.length;++or<Rr;)if(Rn(cr[or],Ot))return!0;return!1},LineString:function(yt,Ot){return Xn(yt.coordinates,Ot)},MultiLineString:function(yt,Ot){for(var cr=yt.coordinates,or=-1,Rr=cr.length;++or<Rr;)if(Xn(cr[or],Ot))return!0;return!1},Polygon:function(yt,Ot){return Ua(yt.coordinates,Ot)},MultiPolygon:function(yt,Ot){for(var cr=yt.coordinates,or=-1,Rr=cr.length;++or<Rr;)if(Ua(cr[or],Ot))return!0;return!1},GeometryCollection:function(yt,Ot){for(var cr=yt.geometries,or=-1,Rr=cr.length;++or<Rr;)if(ea(cr[or],Ot))return!0;return!1}};function ea(yt,Ot){return yt&&ua.hasOwnProperty(yt.type)?ua[yt.type](yt,Ot):!1}function Rn(yt,Ot){return An(yt,Ot)===0}function Xn(yt,Ot){for(var cr,or,Rr,tn=0,dn=yt.length;tn<dn;tn++){if(or=An(yt[tn],Ot),or===0||tn>0&&(Rr=An(yt[tn],yt[tn-1]),Rr>0&&cr<=Rr&&or<=Rr&&(cr+or-Rr)*(1-Math.pow((cr-or)/Rr,2))<r*Rr))return!0;cr=or}return!1}function Ua(yt,Ot){return!!Or(yt.map(li),Vt(Ot))}function li(yt){return yt=yt.map(Vt),yt.pop(),yt}function Vt(yt){return[yt[0]*p,yt[1]*p]}function hr(yt,Ot){return(yt&&Zn.hasOwnProperty(yt.type)?Zn[yt.type]:ea)(yt,Ot)}function rn(yt,Ot,cr){var or=g.range(yt,Ot-n,cr).concat(Ot);return function(Rr){return or.map(function(tn){return[Rr,tn]})}}function vn(yt,Ot,cr){var or=g.range(yt,Ot-n,cr).concat(Ot);return function(Rr){return or.map(function(tn){return[tn,Rr]})}}function en(){var yt,Ot,cr,or,Rr,tn,dn,Mn,Ln=10,Nn=Ln,yn=90,zn=360,Pn,Vn,$n,za,Ea=2.5;function Fa(){return{type:"MultiLineString",coordinates:Oa()}}function Oa(){return g.range(m(or/yn)*yn,cr,yn).map($n).concat(g.range(m(Mn/zn)*zn,dn,zn).map(za)).concat(g.range(m(Ot/Ln)*Ln,yt,Ln).filter(function(Jn){return v(Jn%yn)>n}).map(Pn)).concat(g.range(m(tn/Nn)*Nn,Rr,Nn).filter(function(Jn){return v(Jn%zn)>n}).map(Vn))}return Fa.lines=function(){return Oa().map(function(Jn){return{type:"LineString",coordinates:Jn}})},Fa.outline=function(){return{type:"Polygon",coordinates:[$n(or).concat(za(dn).slice(1),$n(cr).reverse().slice(1),za(Mn).reverse().slice(1))]}},Fa.extent=function(Jn){return arguments.length?Fa.extentMajor(Jn).extentMinor(Jn):Fa.extentMinor()},Fa.extentMajor=function(Jn){return arguments.length?(or=+Jn[0][0],cr=+Jn[1][0],Mn=+Jn[0][1],dn=+Jn[1][1],or>cr&&(Jn=or,or=cr,cr=Jn),Mn>dn&&(Jn=Mn,Mn=dn,dn=Jn),Fa.precision(Ea)):[[or,Mn],[cr,dn]]},Fa.extentMinor=function(Jn){return arguments.length?(Ot=+Jn[0][0],yt=+Jn[1][0],tn=+Jn[0][1],Rr=+Jn[1][1],Ot>yt&&(Jn=Ot,Ot=yt,yt=Jn),tn>Rr&&(Jn=tn,tn=Rr,Rr=Jn),Fa.precision(Ea)):[[Ot,tn],[yt,Rr]]},Fa.step=function(Jn){return arguments.length?Fa.stepMajor(Jn).stepMinor(Jn):Fa.stepMinor()},Fa.stepMajor=function(Jn){return arguments.length?(yn=+Jn[0],zn=+Jn[1],Fa):[yn,zn]},Fa.stepMinor=function(Jn){return arguments.length?(Ln=+Jn[0],Nn=+Jn[1],Fa):[Ln,Nn]},Fa.precision=function(Jn){return arguments.length?(Ea=+Jn,Pn=rn(tn,Rr,90),Vn=vn(Ot,yt,Ea),$n=rn(Mn,dn,90),za=vn(or,cr,Ea),Fa):Ea},Fa.extentMajor([[-180,-90+n],[180,90-n]]).extentMinor([[-180,-80-n],[180,80+n]])}function Tn(){return en()()}function xn(yt,Ot){var cr=yt[0]*p,or=yt[1]*p,Rr=Ot[0]*p,tn=Ot[1]*p,dn=o(or),Mn=h(or),Ln=o(tn),Nn=h(tn),yn=dn*o(cr),zn=dn*h(cr),Pn=Ln*o(Rr),Vn=Ln*h(Rr),$n=2*k(u(P(tn-or)+dn*Ln*P(Rr-cr))),za=h($n),Ea=$n?function(Fa){var Oa=h(Fa*=$n)/za,Jn=h($n-Fa)/za,ha=Jn*yn+Oa*Pn,Ga=Jn*zn+Oa*Vn,Qa=Jn*Mn+Oa*Nn;return[y(Ga,ha)*x,y(Qa,u(ha*ha+Ga*Ga))*x]}:function(){return[cr*x,or*x]};return Ea.distance=$n,Ea}function un(yt){return yt}var gr=S(),mr=S(),zr,gn,On,ta,_n={point:z,lineStart:z,lineEnd:z,polygonStart:function(){_n.lineStart=jn,_n.lineEnd=ma},polygonEnd:function(){_n.lineStart=_n.lineEnd=_n.point=z,gr.add(v(mr)),mr.reset()},result:function(){var yt=gr/2;return gr.reset(),yt}};function jn(){_n.point=aa}function aa(yt,Ot){_n.point=da,zr=On=yt,gn=ta=Ot}function da(yt,Ot){mr.add(ta*yt-On*Ot),On=yt,ta=Ot}function ma(){da(zr,gn)}var sa=1/0,Aa=sa,po=-sa,zo=po,Ko={point:nl,lineStart:z,lineEnd:z,polygonStart:z,polygonEnd:z,result:function(){var yt=[[sa,Aa],[po,zo]];return po=zo=-(Aa=sa=1/0),yt}};function nl(yt,Ot){yt<sa&&(sa=yt),yt>po&&(po=yt),Ot<Aa&&(Aa=Ot),Ot>zo&&(zo=Ot)}var pl=0,Yl=0,vi=0,Gs=0,Rs=0,Hi=0,So=0,dl=0,ps=0,Di,al,Qi,Oi,io={point:$i,lineStart:rs,lineEnd:Jo,polygonStart:function(){io.lineStart=iu,io.lineEnd=Is},polygonEnd:function(){io.point=$i,io.lineStart=rs,io.lineEnd=Jo},result:function(){var yt=ps?[So/ps,dl/ps]:Hi?[Gs/Hi,Rs/Hi]:vi?[pl/vi,Yl/vi]:[NaN,NaN];return pl=Yl=vi=Gs=Rs=Hi=So=dl=ps=0,yt}};function $i(yt,Ot){pl+=yt,Yl+=Ot,++vi}function rs(){io.point=Ys}function Ys(yt,Ot){io.point=au,$i(Qi=yt,Oi=Ot)}function au(yt,Ot){var cr=yt-Qi,or=Ot-Oi,Rr=u(cr*cr+or*or);Gs+=Rr*(Qi+yt)/2,Rs+=Rr*(Oi+Ot)/2,Hi+=Rr,$i(Qi=yt,Oi=Ot)}function Jo(){io.point=$i}function iu(){io.point=ko}function Is(){Mu(Di,al)}function ko(yt,Ot){io.point=Mu,$i(Di=Qi=yt,al=Oi=Ot)}function Mu(yt,Ot){var cr=yt-Qi,or=Ot-Oi,Rr=u(cr*cr+or*or);Gs+=Rr*(Qi+yt)/2,Rs+=Rr*(Oi+Ot)/2,Hi+=Rr,Rr=Oi*yt-Qi*Ot,So+=Rr*(Qi+yt),dl+=Rr*(Oi+Ot),ps+=Rr*3,$i(Qi=yt,Oi=Ot)}function zs(yt){this._context=yt}zs.prototype={_radius:4.5,pointRadius:function(yt){return this._radius=yt,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(yt,Ot){switch(this._point){case 0:{this._context.moveTo(yt,Ot),this._point=1;break}case 1:{this._context.lineTo(yt,Ot);break}default:{this._context.moveTo(yt+this._radius,Ot),this._context.arc(yt,Ot,this._radius,0,i);break}}},result:z};var ws=S(),Ll,Su,ku,Ws,Pl,Ts={point:z,lineStart:function(){Ts.point=Wl},lineEnd:function(){Ll&&il(Su,ku),Ts.point=z},polygonStart:function(){Ll=!0},polygonEnd:function(){Ll=null},result:function(){var yt=+ws;return ws.reset(),yt}};function Wl(yt,Ot){Ts.point=il,Su=Ws=yt,ku=Pl=Ot}function il(yt,Ot){Ws-=yt,Pl-=Ot,ws.add(u(Ws*Ws+Pl*Pl)),Ws=yt,Pl=Ot}function Xl(){this._string=[]}Xl.prototype={_radius:4.5,_circle:ou(4.5),pointRadius:function(yt){return(yt=+yt)!==this._radius&&(this._radius=yt,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(yt,Ot){switch(this._point){case 0:{this._string.push("M",yt,",",Ot),this._point=1;break}case 1:{this._string.push("L",yt,",",Ot);break}default:{this._circle==null&&(this._circle=ou(this._radius)),this._string.push("M",yt,",",Ot,this._circle);break}}},result:function(){if(this._string.length){var yt=this._string.join("");return this._string=[],yt}else return null}};function ou(yt){return"m0,"+yt+"a"+yt+","+yt+" 0 1,1 0,"+-2*yt+"a"+yt+","+yt+" 0 1,1 0,"+2*yt+"z"}function Dl(yt,Ot){var cr=4.5,or,Rr;function tn(dn){return dn&&(typeof cr=="function"&&Rr.pointRadius(+cr.apply(this,arguments)),N(dn,or(Rr))),Rr.result()}return tn.area=function(dn){return N(dn,or(_n)),_n.result()},tn.measure=function(dn){return N(dn,or(Ts)),Ts.result()},tn.bounds=function(dn){return N(dn,or(Ko)),Ko.result()},tn.centroid=function(dn){return N(dn,or(io)),io.result()},tn.projection=function(dn){return arguments.length?(or=dn==null?(yt=null,un):(yt=dn).stream,tn):yt},tn.context=function(dn){return arguments.length?(Rr=dn==null?(Ot=null,new Xl):new zs(Ot=dn),typeof cr!="function"&&Rr.pointRadius(cr),tn):Ot},tn.pointRadius=function(dn){return arguments.length?(cr=typeof dn=="function"?dn:(Rr.pointRadius(+dn),+dn),tn):cr},tn.projection(yt).context(Ot)}function Eu(yt){return{stream:Xs(yt)}}function Xs(yt){return function(Ot){var cr=new Zl;for(var or in yt)cr[or]=yt[or];return cr.stream=Ot,cr}}function Zl(){}Zl.prototype={constructor:Zl,point:function(yt,Ot){this.stream.point(yt,Ot)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Rl(yt,Ot,cr){var or=yt.clipExtent&&yt.clipExtent();return yt.scale(150).translate([0,0]),or!=null&&yt.clipExtent(null),N(cr,yt.stream(Ko)),Ot(Ko.result()),or!=null&&yt.clipExtent(or),yt}function ds(yt,Ot,cr){return Rl(yt,function(or){var Rr=Ot[1][0]-Ot[0][0],tn=Ot[1][1]-Ot[0][1],dn=Math.min(Rr/(or[1][0]-or[0][0]),tn/(or[1][1]-or[0][1])),Mn=+Ot[0][0]+(Rr-dn*(or[1][0]+or[0][0]))/2,Ln=+Ot[0][1]+(tn-dn*(or[1][1]+or[0][1]))/2;yt.scale(150*dn).translate([Mn,Ln])},cr)}function yl(yt,Ot,cr){return ds(yt,[[0,0],Ot],cr)}function jl(yt,Ot,cr){return Rl(yt,function(or){var Rr=+Ot,tn=Rr/(or[1][0]-or[0][0]),dn=(Rr-tn*(or[1][0]+or[0][0]))/2,Mn=-tn*or[0][1];yt.scale(150*tn).translate([dn,Mn])},cr)}function su(yt,Ot,cr){return Rl(yt,function(or){var Rr=+Ot,tn=Rr/(or[1][1]-or[0][1]),dn=-tn*or[0][0],Mn=(Rr-tn*(or[1][1]+or[0][1]))/2;yt.scale(150*tn).translate([dn,Mn])},cr)}var lu=16,Il=o(30*p);function Cu(yt,Ot){return+Ot?Qo(yt,Ot):uu(yt)}function uu(yt){return Xs({point:function(Ot,cr){Ot=yt(Ot,cr),this.stream.point(Ot[0],Ot[1])}})}function Qo(yt,Ot){function cr(or,Rr,tn,dn,Mn,Ln,Nn,yn,zn,Pn,Vn,$n,za,Ea){var Fa=Nn-or,Oa=yn-Rr,Jn=Fa*Fa+Oa*Oa;if(Jn>4*Ot&&za--){var ha=dn+Pn,Ga=Mn+Vn,Qa=Ln+$n,di=u(ha*ha+Ga*Ga+Qa*Qa),gi=k(Qa/=di),mi=v(v(Qa)-1)<n||v(tn-zn)<n?(tn+zn)/2:y(Ga,ha),Ai=yt(mi,gi),oi=Ai[0],xo=Ai[1],to=oi-or,Ja=xo-Rr,va=Oa*to-Fa*Ja;(va*va/Jn>Ot||v((Fa*to+Oa*Ja)/Jn-.5)>.3||dn*Pn+Mn*Vn+Ln*$n<Il)&&(cr(or,Rr,tn,dn,Mn,Ln,oi,xo,mi,ha/=di,Ga/=di,Qa,za,Ea),Ea.point(oi,xo),cr(oi,xo,mi,ha,Ga,Qa,Nn,yn,zn,Pn,Vn,$n,za,Ea))}}return function(or){var Rr,tn,dn,Mn,Ln,Nn,yn,zn,Pn,Vn,$n,za,Ea={point:Fa,lineStart:Oa,lineEnd:ha,polygonStart:function(){or.polygonStart(),Ea.lineStart=Ga},polygonEnd:function(){or.polygonEnd(),Ea.lineStart=Oa}};function Fa(gi,mi){gi=yt(gi,mi),or.point(gi[0],gi[1])}function Oa(){zn=NaN,Ea.point=Jn,or.lineStart()}function Jn(gi,mi){var Ai=ie([gi,mi]),oi=yt(gi,mi);cr(zn,Pn,yn,Vn,$n,za,zn=oi[0],Pn=oi[1],yn=gi,Vn=Ai[0],$n=Ai[1],za=Ai[2],lu,or),or.point(zn,Pn)}function ha(){Ea.point=Fa,or.lineEnd()}function Ga(){Oa(),Ea.point=Qa,Ea.lineEnd=di}function Qa(gi,mi){Jn(Rr=gi,mi),tn=zn,dn=Pn,Mn=Vn,Ln=$n,Nn=za,Ea.point=Jn}function di(){cr(zn,Pn,yn,Vn,$n,za,tn,dn,Rr,Mn,Ln,Nn,lu,or),Ea.lineEnd=ha,ha()}return Ea}}var ol=Xs({point:function(yt,Ot){this.stream.point(yt*p,Ot*p)}});function sl(yt){return Xs({point:function(Ot,cr){var or=yt(Ot,cr);return this.stream.point(or[0],or[1])}})}function Kl(yt,Ot,cr,or,Rr){function tn(dn,Mn){return dn*=or,Mn*=Rr,[Ot+yt*dn,cr-yt*Mn]}return tn.invert=function(dn,Mn){return[(dn-Ot)/yt*or,(cr-Mn)/yt*Rr]},tn}function gs(yt,Ot,cr,or,Rr,tn){var dn=o(tn),Mn=h(tn),Ln=dn*yt,Nn=Mn*yt,yn=dn/yt,zn=Mn/yt,Pn=(Mn*cr-dn*Ot)/yt,Vn=(Mn*Ot+dn*cr)/yt;function $n(za,Ea){return za*=or,Ea*=Rr,[Ln*za-Nn*Ea+Ot,cr-Nn*za-Ln*Ea]}return $n.invert=function(za,Ea){return[or*(yn*za-zn*Ea+Pn),Rr*(Vn-zn*za-yn*Ea)]},$n}function Eo(yt){return zl(function(){return yt})()}function zl(yt){var Ot,cr=150,or=480,Rr=250,tn=0,dn=0,Mn=0,Ln=0,Nn=0,yn,zn=0,Pn=1,Vn=1,$n=null,za=Wt,Ea=null,Fa,Oa,Jn,ha=un,Ga=.5,Qa,di,gi,mi,Ai;function oi(va){return gi(va[0]*p,va[1]*p)}function xo(va){return va=gi.invert(va[0],va[1]),va&&[va[0]*x,va[1]*x]}oi.stream=function(va){return mi&&Ai===va?mi:mi=ol(sl(yn)(za(Qa(ha(Ai=va)))))},oi.preclip=function(va){return arguments.length?(za=va,$n=void 0,Ja()):za},oi.postclip=function(va){return arguments.length?(ha=va,Ea=Fa=Oa=Jn=null,Ja()):ha},oi.clipAngle=function(va){return arguments.length?(za=+va?Er($n=va*p):($n=null,Wt),Ja()):$n*x},oi.clipExtent=function(va){return arguments.length?(ha=va==null?(Ea=Fa=Oa=Jn=null,un):cn(Ea=+va[0][0],Fa=+va[0][1],Oa=+va[1][0],Jn=+va[1][1]),Ja()):Ea==null?null:[[Ea,Fa],[Oa,Jn]]},oi.scale=function(va){return arguments.length?(cr=+va,to()):cr},oi.translate=function(va){return arguments.length?(or=+va[0],Rr=+va[1],to()):[or,Rr]},oi.center=function(va){return arguments.length?(tn=va[0]%360*p,dn=va[1]%360*p,to()):[tn*x,dn*x]},oi.rotate=function(va){return arguments.length?(Mn=va[0]%360*p,Ln=va[1]%360*p,Nn=va.length>2?va[2]%360*p:0,to()):[Mn*x,Ln*x,Nn*x]},oi.angle=function(va){return arguments.length?(zn=va%360*p,to()):zn*x},oi.reflectX=function(va){return arguments.length?(Pn=va?-1:1,to()):Pn<0},oi.reflectY=function(va){return arguments.length?(Vn=va?-1:1,to()):Vn<0},oi.precision=function(va){return arguments.length?(Qa=Cu(di,Ga=va*va),Ja()):u(Ga)},oi.fitExtent=function(va,xi){return ds(oi,va,xi)},oi.fitSize=function(va,xi){return yl(oi,va,xi)},oi.fitWidth=function(va,xi){return jl(oi,va,xi)},oi.fitHeight=function(va,xi){return su(oi,va,xi)};function to(){var va=gs(cr,0,0,Pn,Vn,zn).apply(null,Ot(tn,dn)),xi=(zn?gs:Kl)(cr,or-va[0],Rr-va[1],Pn,Vn,zn);return yn=nt(Mn,Ln,Nn),di=Ce(Ot,xi),gi=Ce(yn,di),Qa=Cu(di,Ga),Ja()}function Ja(){return mi=Ai=null,oi}return function(){return Ot=yt.apply(this,arguments),oi.invert=Ot.invert&&xo,to()}}function As(yt){var Ot=0,cr=t/3,or=zl(yt),Rr=or(Ot,cr);return Rr.parallels=function(tn){return arguments.length?or(Ot=tn[0]*p,cr=tn[1]*p):[Ot*x,cr*x]},Rr}function Ms(yt){var Ot=o(yt);function cr(or,Rr){return[or*Ot,h(Rr)/Ot]}return cr.invert=function(or,Rr){return[or/Ot,k(Rr*Ot)]},cr}function lo(yt,Ot){var cr=h(yt),or=(cr+h(Ot))/2;if(v(or)<n)return Ms(yt);var Rr=1+cr*(2*or-cr),tn=u(Rr)/or;function dn(Mn,Ln){var Nn=u(Rr-2*or*h(Ln))/or;return[Nn*h(Mn*=or),tn-Nn*o(Mn)]}return dn.invert=function(Mn,Ln){var Nn=tn-Ln,yn=y(Mn,v(Nn))*b(Nn);return Nn*or<0&&(yn-=t*b(Mn)*b(Nn)),[yn/or,k((Rr-(Mn*Mn+Nn*Nn)*or*or)/(2*or))]},dn}function ml(){return As(lo).scale(155.424).center([0,33.6442])}function xl(){return ml().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Zs(yt){var Ot=yt.length;return{point:function(cr,or){for(var Rr=-1;++Rr<Ot;)yt[Rr].point(cr,or)},sphere:function(){for(var cr=-1;++cr<Ot;)yt[cr].sphere()},lineStart:function(){for(var cr=-1;++cr<Ot;)yt[cr].lineStart()},lineEnd:function(){for(var cr=-1;++cr<Ot;)yt[cr].lineEnd()},polygonStart:function(){for(var cr=-1;++cr<Ot;)yt[cr].polygonStart()},polygonEnd:function(){for(var cr=-1;++cr<Ot;)yt[cr].polygonEnd()}}}function ys(){var yt,Ot,cr=xl(),or,Rr=ml().rotate([154,0]).center([-2,58.5]).parallels([55,65]),tn,dn=ml().rotate([157,0]).center([-3,19.9]).parallels([8,18]),Mn,Ln,Nn={point:function(Pn,Vn){Ln=[Pn,Vn]}};function yn(Pn){var Vn=Pn[0],$n=Pn[1];return Ln=null,or.point(Vn,$n),Ln||(tn.point(Vn,$n),Ln)||(Mn.point(Vn,$n),Ln)}yn.invert=function(Pn){var Vn=cr.scale(),$n=cr.translate(),za=(Pn[0]-$n[0])/Vn,Ea=(Pn[1]-$n[1])/Vn;return(Ea>=.12&&Ea<.234&&za>=-.425&&za<-.214?Rr:Ea>=.166&&Ea<.234&&za>=-.214&&za<-.115?dn:cr).invert(Pn)},yn.stream=function(Pn){return yt&&Ot===Pn?yt:yt=Zs([cr.stream(Ot=Pn),Rr.stream(Pn),dn.stream(Pn)])},yn.precision=function(Pn){return arguments.length?(cr.precision(Pn),Rr.precision(Pn),dn.precision(Pn),zn()):cr.precision()},yn.scale=function(Pn){return arguments.length?(cr.scale(Pn),Rr.scale(Pn*.35),dn.scale(Pn),yn.translate(cr.translate())):cr.scale()},yn.translate=function(Pn){if(!arguments.length)return cr.translate();var Vn=cr.scale(),$n=+Pn[0],za=+Pn[1];return or=cr.translate(Pn).clipExtent([[$n-.455*Vn,za-.238*Vn],[$n+.455*Vn,za+.238*Vn]]).stream(Nn),tn=Rr.translate([$n-.307*Vn,za+.201*Vn]).clipExtent([[$n-.425*Vn+n,za+.12*Vn+n],[$n-.214*Vn-n,za+.234*Vn-n]]).stream(Nn),Mn=dn.translate([$n-.205*Vn,za+.212*Vn]).clipExtent([[$n-.214*Vn+n,za+.166*Vn+n],[$n-.115*Vn-n,za+.234*Vn-n]]).stream(Nn),zn()},yn.fitExtent=function(Pn,Vn){return ds(yn,Pn,Vn)},yn.fitSize=function(Pn,Vn){return yl(yn,Pn,Vn)},yn.fitWidth=function(Pn,Vn){return jl(yn,Pn,Vn)},yn.fitHeight=function(Pn,Vn){return su(yn,Pn,Vn)};function zn(){return yt=Ot=null,yn}return yn.scale(1070)}function bl(yt){return function(Ot,cr){var or=o(Ot),Rr=o(cr),tn=yt(or*Rr);return[tn*Rr*h(Ot),tn*h(cr)]}}function ll(yt){return function(Ot,cr){var or=u(Ot*Ot+cr*cr),Rr=yt(or),tn=h(Rr),dn=o(Rr);return[y(Ot*tn,or*dn),k(or&&cr*tn/or)]}}var Fl=bl(function(yt){return u(2/(1+yt))});Fl.invert=ll(function(yt){return 2*k(yt/2)});function _l(){return Eo(Fl).scale(124.75).clipAngle(180-.001)}var js=bl(function(yt){return(yt=T(yt))&&yt/h(yt)});js.invert=ll(function(yt){return yt});function Lu(){return Eo(js).scale(79.4188).clipAngle(180-.001)}function ns(yt,Ot){return[yt,w(L((c+Ot)/2))]}ns.invert=function(yt,Ot){return[yt,2*f(l(Ot))-c]};function Yu(){return Jl(ns).scale(961/i)}function Jl(yt){var Ot=Eo(yt),cr=Ot.center,or=Ot.scale,Rr=Ot.translate,tn=Ot.clipExtent,dn=null,Mn,Ln,Nn;Ot.scale=function(zn){return arguments.length?(or(zn),yn()):or()},Ot.translate=function(zn){return arguments.length?(Rr(zn),yn()):Rr()},Ot.center=function(zn){return arguments.length?(cr(zn),yn()):cr()},Ot.clipExtent=function(zn){return arguments.length?(zn==null?dn=Mn=Ln=Nn=null:(dn=+zn[0][0],Mn=+zn[0][1],Ln=+zn[1][0],Nn=+zn[1][1]),yn()):dn==null?null:[[dn,Mn],[Ln,Nn]]};function yn(){var zn=t*or(),Pn=Ot(dt(Ot.rotate()).invert([0,0]));return tn(dn==null?[[Pn[0]-zn,Pn[1]-zn],[Pn[0]+zn,Pn[1]+zn]]:yt===ns?[[Math.max(Pn[0]-zn,dn),Mn],[Math.min(Pn[0]+zn,Ln),Nn]]:[[dn,Math.max(Pn[1]-zn,Mn)],[Ln,Math.min(Pn[1]+zn,Nn)]])}return yn()}function ul(yt){return L((c+yt)/2)}function wl(yt,Ot){var cr=o(yt),or=yt===Ot?h(yt):w(cr/o(Ot))/w(ul(Ot)/ul(yt)),Rr=cr*_(ul(yt),or)/or;if(!or)return ns;function tn(dn,Mn){Rr>0?Mn<-c+n&&(Mn=-c+n):Mn>c-n&&(Mn=c-n);var Ln=Rr/_(ul(Mn),or);return[Ln*h(or*dn),Rr-Ln*o(or*dn)]}return tn.invert=function(dn,Mn){var Ln=Rr-Mn,Nn=b(or)*u(dn*dn+Ln*Ln),yn=y(dn,v(Ln))*b(Ln);return Ln*or<0&&(yn-=t*b(dn)*b(Ln)),[yn/or,2*f(_(Rr/Nn,1/or))-c]},tn}function Ks(){return As(wl).scale(109.5).parallels([30,30])}function Tl(yt,Ot){return[yt,Ot]}Tl.invert=Tl;function fu(){return Eo(Tl).scale(152.63)}function cu(yt,Ot){var cr=o(yt),or=yt===Ot?h(yt):(cr-o(Ot))/(Ot-yt),Rr=cr/or+yt;if(v(or)<n)return Tl;function tn(dn,Mn){var Ln=Rr-Mn,Nn=or*dn;return[Ln*h(Nn),Rr-Ln*o(Nn)]}return tn.invert=function(dn,Mn){var Ln=Rr-Mn,Nn=y(dn,v(Ln))*b(Ln);return Ln*or<0&&(Nn-=t*b(dn)*b(Ln)),[Nn/or,Rr-b(or)*u(dn*dn+Ln*Ln)]},tn}function Wu(){return As(cu).scale(131.154).center([0,13.9389])}var Ri=1.340264,fl=-.081106,Js=893e-6,$o=.003796,as=u(3)/2,Al=12;function uo(yt,Ot){var cr=k(as*h(Ot)),or=cr*cr,Rr=or*or*or;return[yt*o(cr)/(as*(Ri+3*fl*or+Rr*(7*Js+9*$o*or))),cr*(Ri+fl*or+Rr*(Js+$o*or))]}uo.invert=function(yt,Ot){for(var cr=Ot,or=cr*cr,Rr=or*or*or,tn=0,dn,Mn,Ln;tn<Al&&(Mn=cr*(Ri+fl*or+Rr*(Js+$o*or))-Ot,Ln=Ri+3*fl*or+Rr*(7*Js+9*$o*or),cr-=dn=Mn/Ln,or=cr*cr,Rr=or*or*or,!(v(dn)<r));++tn);return[as*yt*(Ri+3*fl*or+Rr*(7*Js+9*$o*or))/o(cr),k(h(cr)/as)]};function hu(){return Eo(uo).scale(177.158)}function is(yt,Ot){var cr=o(Ot),or=o(yt)*cr;return[cr*h(yt)/or,h(Ot)/or]}is.invert=ll(f);function Fs(){return Eo(is).scale(144.049).clipAngle(60)}function Os(){var yt=1,Ot=0,cr=0,or=1,Rr=1,tn=0,dn,Mn,Ln=null,Nn,yn,zn,Pn=1,Vn=1,$n=Xs({point:function(ha,Ga){var Qa=Jn([ha,Ga]);this.stream.point(Qa[0],Qa[1])}}),za=un,Ea,Fa;function Oa(){return Pn=yt*or,Vn=yt*Rr,Ea=Fa=null,Jn}function Jn(ha){var Ga=ha[0]*Pn,Qa=ha[1]*Vn;if(tn){var di=Qa*dn-Ga*Mn;Ga=Ga*dn+Qa*Mn,Qa=di}return[Ga+Ot,Qa+cr]}return Jn.invert=function(ha){var Ga=ha[0]-Ot,Qa=ha[1]-cr;if(tn){var di=Qa*dn+Ga*Mn;Ga=Ga*dn-Qa*Mn,Qa=di}return[Ga/Pn,Qa/Vn]},Jn.stream=function(ha){return Ea&&Fa===ha?Ea:Ea=$n(za(Fa=ha))},Jn.postclip=function(ha){return arguments.length?(za=ha,Ln=Nn=yn=zn=null,Oa()):za},Jn.clipExtent=function(ha){return arguments.length?(za=ha==null?(Ln=Nn=yn=zn=null,un):cn(Ln=+ha[0][0],Nn=+ha[0][1],yn=+ha[1][0],zn=+ha[1][1]),Oa()):Ln==null?null:[[Ln,Nn],[yn,zn]]},Jn.scale=function(ha){return arguments.length?(yt=+ha,Oa()):yt},Jn.translate=function(ha){return arguments.length?(Ot=+ha[0],cr=+ha[1],Oa()):[Ot,cr]},Jn.angle=function(ha){return arguments.length?(tn=ha%360*p,Mn=h(tn),dn=o(tn),Oa()):tn*x},Jn.reflectX=function(ha){return arguments.length?(or=ha?-1:1,Oa()):or<0},Jn.reflectY=function(ha){return arguments.length?(Rr=ha?-1:1,Oa()):Rr<0},Jn.fitExtent=function(ha,Ga){return ds(Jn,ha,Ga)},Jn.fitSize=function(ha,Ga){return yl(Jn,ha,Ga)},Jn.fitWidth=function(ha,Ga){return jl(Jn,ha,Ga)},Jn.fitHeight=function(ha,Ga){return su(Jn,ha,Ga)},Jn}function Ss(yt,Ot){var cr=Ot*Ot,or=cr*cr;return[yt*(.8707-.131979*cr+or*(-.013791+or*(.003971*cr-.001529*or))),Ot*(1.007226+cr*(.015085+or*(-.044475+.028874*cr-.005916*or)))]}Ss.invert=function(yt,Ot){var cr=Ot,or=25,Rr;do{var tn=cr*cr,dn=tn*tn;cr-=Rr=(cr*(1.007226+tn*(.015085+dn*(-.044475+.028874*tn-.005916*dn)))-Ot)/(1.007226+tn*(.015085*3+dn*(-.044475*7+.028874*9*tn-.005916*11*dn)))}while(v(Rr)>n&&--or>0);return[yt/(.8707+(tn=cr*cr)*(-.131979+tn*(-.013791+tn*tn*tn*(.003971-.001529*tn)))),cr]};function os(){return Eo(Ss).scale(175.295)}function Gi(yt,Ot){return[o(Ot)*h(yt),h(Ot)]}Gi.invert=ll(k);function Co(){return Eo(Gi).scale(249.5).clipAngle(90+n)}function ss(yt,Ot){var cr=o(Ot),or=1+o(yt)*cr;return[cr*h(yt)/or,h(Ot)/or]}ss.invert=ll(function(yt){return 2*f(yt)});function vu(){return Eo(ss).scale(250).clipAngle(142)}function Ol(yt,Ot){return[w(L((c+Ot)/2)),-yt]}Ol.invert=function(yt,Ot){return[-Ot,2*f(l(yt))-c]};function pu(){var yt=Jl(Ol),Ot=yt.center,cr=yt.rotate;return yt.center=function(or){return arguments.length?Ot([-or[1],or[0]]):(or=Ot(),[or[1],-or[0]])},yt.rotate=function(or){return arguments.length?cr([or[0],or[1],or.length>2?or[2]+90:90]):(or=cr(),[or[0],or[1],or[2]-90])},cr([0,0,90]).scale(159.155)}A.geoAlbers=xl,A.geoAlbersUsa=ys,A.geoArea=X,A.geoAzimuthalEqualArea=_l,A.geoAzimuthalEqualAreaRaw=Fl,A.geoAzimuthalEquidistant=Lu,A.geoAzimuthalEquidistantRaw=js,A.geoBounds=Ye,A.geoCentroid=Tt,A.geoCircle=rr,A.geoClipAntimeridian=Wt,A.geoClipCircle=Er,A.geoClipExtent=Bn,A.geoClipRectangle=cn,A.geoConicConformal=Ks,A.geoConicConformalRaw=wl,A.geoConicEqualArea=ml,A.geoConicEqualAreaRaw=lo,A.geoConicEquidistant=Wu,A.geoConicEquidistantRaw=cu,A.geoContains=hr,A.geoDistance=An,A.geoEqualEarth=hu,A.geoEqualEarthRaw=uo,A.geoEquirectangular=fu,A.geoEquirectangularRaw=Tl,A.geoGnomonic=Fs,A.geoGnomonicRaw=is,A.geoGraticule=en,A.geoGraticule10=Tn,A.geoIdentity=Os,A.geoInterpolate=xn,A.geoLength=Tr,A.geoMercator=Yu,A.geoMercatorRaw=ns,A.geoNaturalEarth1=os,A.geoNaturalEarth1Raw=Ss,A.geoOrthographic=Co,A.geoOrthographicRaw=Gi,A.geoPath=Dl,A.geoProjection=Eo,A.geoProjectionMutator=zl,A.geoRotation=dt,A.geoStereographic=vu,A.geoStereographicRaw=ss,A.geoStream=N,A.geoTransform=Eu,A.geoTransverseMercator=pu,A.geoTransverseMercatorRaw=Ol,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-array":107}],115:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){function g(Ve,Ae){return Ve.parent===Ae.parent?1:2}function S(Ve){return Ve.reduce(M,0)/Ve.length}function M(Ve,Ae){return Ve+Ae.x}function e(Ve){return 1+Ve.reduce(a,0)}function a(Ve,Ae){return Math.max(Ve,Ae.y)}function n(Ve){for(var Ae;Ae=Ve.children;)Ve=Ae[0];return Ve}function r(Ve){for(var Ae;Ae=Ve.children;)Ve=Ae[Ae.length-1];return Ve}function t(){var Ve=g,Ae=1,Ue=1,Ze=!1;function Qe(_t){var gt,wt=0;_t.eachAfter(function(Ht){var ar=Ht.children;ar?(Ht.x=S(ar),Ht.y=e(ar)):(Ht.x=gt?wt+=Ve(Ht,gt):0,Ht.y=0,gt=Ht)});var Ut=n(_t),Dt=r(_t),Nt=Ut.x-Ve(Ut,Dt)/2,Xt=Dt.x+Ve(Dt,Ut)/2;return _t.eachAfter(Ze?function(Ht){Ht.x=(Ht.x-_t.x)*Ae,Ht.y=(_t.y-Ht.y)*Ue}:function(Ht){Ht.x=(Ht.x-Nt)/(Xt-Nt)*Ae,Ht.y=(1-(_t.y?Ht.y/_t.y:1))*Ue})}return Qe.separation=function(_t){return arguments.length?(Ve=_t,Qe):Ve},Qe.size=function(_t){return arguments.length?(Ze=!1,Ae=+_t[0],Ue=+_t[1],Qe):Ze?null:[Ae,Ue]},Qe.nodeSize=function(_t){return arguments.length?(Ze=!0,Ae=+_t[0],Ue=+_t[1],Qe):Ze?[Ae,Ue]:null},Qe}function c(Ve){var Ae=0,Ue=Ve.children,Ze=Ue&&Ue.length;if(!Ze)Ae=1;else for(;--Ze>=0;)Ae+=Ue[Ze].value;Ve.value=Ae}function s(){return this.eachAfter(c)}function i(Ve){var Ae=this,Ue,Ze=[Ae],Qe,_t,gt;do for(Ue=Ze.reverse(),Ze=[];Ae=Ue.pop();)if(Ve(Ae),Qe=Ae.children,Qe)for(_t=0,gt=Qe.length;_t<gt;++_t)Ze.push(Qe[_t]);while(Ze.length);return this}function x(Ve){for(var Ae=this,Ue=[Ae],Ze,Qe;Ae=Ue.pop();)if(Ve(Ae),Ze=Ae.children,Ze)for(Qe=Ze.length-1;Qe>=0;--Qe)Ue.push(Ze[Qe]);return this}function p(Ve){for(var Ae=this,Ue=[Ae],Ze=[],Qe,_t,gt;Ae=Ue.pop();)if(Ze.push(Ae),Qe=Ae.children,Qe)for(_t=0,gt=Qe.length;_t<gt;++_t)Ue.push(Qe[_t]);for(;Ae=Ze.pop();)Ve(Ae);return this}function v(Ve){return this.eachAfter(function(Ae){for(var Ue=+Ve(Ae.data)||0,Ze=Ae.children,Qe=Ze&&Ze.length;--Qe>=0;)Ue+=Ze[Qe].value;Ae.value=Ue})}function f(Ve){return this.eachBefore(function(Ae){Ae.children&&Ae.children.sort(Ve)})}function y(Ve){for(var Ae=this,Ue=o(Ae,Ve),Ze=[Ae];Ae!==Ue;)Ae=Ae.parent,Ze.push(Ae);for(var Qe=Ze.length;Ve!==Ue;)Ze.splice(Qe,0,Ve),Ve=Ve.parent;return Ze}function o(Ve,Ae){if(Ve===Ae)return Ve;var Ue=Ve.ancestors(),Ze=Ae.ancestors(),Qe=null;for(Ve=Ue.pop(),Ae=Ze.pop();Ve===Ae;)Qe=Ve,Ve=Ue.pop(),Ae=Ze.pop();return Qe}function m(){for(var Ve=this,Ae=[Ve];Ve=Ve.parent;)Ae.push(Ve);return Ae}function l(){var Ve=[];return this.each(function(Ae){Ve.push(Ae)}),Ve}function w(){var Ve=[];return this.eachBefore(function(Ae){Ae.children||Ve.push(Ae)}),Ve}function _(){var Ve=this,Ae=[];return Ve.each(function(Ue){Ue!==Ve&&Ae.push({source:Ue.parent,target:Ue})}),Ae}function h(Ve,Ae){var Ue=new k(Ve),Ze=+Ve.value&&(Ue.value=Ve.value),Qe,_t=[Ue],gt,wt,Ut,Dt;for(Ae==null&&(Ae=u);Qe=_t.pop();)if(Ze&&(Qe.value=+Qe.data.value),(wt=Ae(Qe.data))&&(Dt=wt.length))for(Qe.children=new Array(Dt),Ut=Dt-1;Ut>=0;--Ut)_t.push(gt=Qe.children[Ut]=new k(wt[Ut])),gt.parent=Qe,gt.depth=Qe.depth+1;return Ue.eachBefore(T)}function b(){return h(this).eachBefore(L)}function u(Ve){return Ve.children}function L(Ve){Ve.data=Ve.data.data}function T(Ve){var Ae=0;do Ve.height=Ae;while((Ve=Ve.parent)&&Ve.height<++Ae)}function k(Ve){this.data=Ve,this.depth=this.height=0,this.parent=null}k.prototype=h.prototype={constructor:k,count:s,each:i,eachAfter:p,eachBefore:x,sum:v,sort:f,path:y,ancestors:m,descendants:l,leaves:w,links:_,copy:b};var P=Array.prototype.slice;function z(Ve){for(var Ae=Ve.length,Ue,Ze;Ae;)Ze=Math.random()*Ae--|0,Ue=Ve[Ae],Ve[Ae]=Ve[Ze],Ve[Ze]=Ue;return Ve}function I(Ve){for(var Ae=0,Ue=(Ve=z(P.call(Ve))).length,Ze=[],Qe,_t;Ae<Ue;)Qe=Ve[Ae],_t&&O(_t,Qe)?++Ae:(_t=N(Ze=D(Ze,Qe)),Ae=0);return _t}function D(Ve,Ae){var Ue,Ze;if(F(Ae,Ve))return[Ae];for(Ue=0;Ue<Ve.length;++Ue)if(R(Ae,Ve[Ue])&&F(K(Ve[Ue],Ae),Ve))return[Ve[Ue],Ae];for(Ue=0;Ue<Ve.length-1;++Ue)for(Ze=Ue+1;Ze<Ve.length;++Ze)if(R(K(Ve[Ue],Ve[Ze]),Ae)&&R(K(Ve[Ue],Ae),Ve[Ze])&&R(K(Ve[Ze],Ae),Ve[Ue])&&F(W(Ve[Ue],Ve[Ze],Ae),Ve))return[Ve[Ue],Ve[Ze],Ae];throw new Error}function R(Ve,Ae){var Ue=Ve.r-Ae.r,Ze=Ae.x-Ve.x,Qe=Ae.y-Ve.y;return Ue<0||Ue*Ue<Ze*Ze+Qe*Qe}function O(Ve,Ae){var Ue=Ve.r-Ae.r+1e-6,Ze=Ae.x-Ve.x,Qe=Ae.y-Ve.y;return Ue>0&&Ue*Ue>Ze*Ze+Qe*Qe}function F(Ve,Ae){for(var Ue=0;Ue<Ae.length;++Ue)if(!O(Ve,Ae[Ue]))return!1;return!0}function N(Ve){switch(Ve.length){case 1:return G(Ve[0]);case 2:return K(Ve[0],Ve[1]);case 3:return W(Ve[0],Ve[1],Ve[2])}}function G(Ve){return{x:Ve.x,y:Ve.y,r:Ve.r}}function K(Ve,Ae){var Ue=Ve.x,Ze=Ve.y,Qe=Ve.r,_t=Ae.x,gt=Ae.y,wt=Ae.r,Ut=_t-Ue,Dt=gt-Ze,Nt=wt-Qe,Xt=Math.sqrt(Ut*Ut+Dt*Dt);return{x:(Ue+_t+Ut/Xt*Nt)/2,y:(Ze+gt+Dt/Xt*Nt)/2,r:(Xt+Qe+wt)/2}}function W(Ve,Ae,Ue){var Ze=Ve.x,Qe=Ve.y,_t=Ve.r,gt=Ae.x,wt=Ae.y,Ut=Ae.r,Dt=Ue.x,Nt=Ue.y,Xt=Ue.r,Ht=Ze-gt,ar=Ze-Dt,Vr=Qe-wt,nn=Qe-Nt,jr=Ut-_t,at=Xt-_t,$t=Ze*Ze+Qe*Qe-_t*_t,Zt=$t-gt*gt-wt*wt+Ut*Ut,ur=$t-Dt*Dt-Nt*Nt+Xt*Xt,wr=ar*Vr-Ht*nn,$e=(Vr*ur-nn*Zt)/(wr*2)-Ze,Je=(nn*jr-Vr*at)/wr,it=(ar*Zt-Ht*ur)/(wr*2)-Qe,lt=(Ht*at-ar*jr)/wr,Tt=Je*Je+lt*lt-1,Bt=2*(_t+$e*Je+it*lt),Ce=$e*$e+it*it-_t*_t,Me=-(Tt?(Bt+Math.sqrt(Bt*Bt-4*Tt*Ce))/(2*Tt):Ce/Bt);return{x:Ze+$e+Je*Me,y:Qe+it+lt*Me,r:Me}}function Y(Ve,Ae,Ue){var Ze=Ve.x-Ae.x,Qe,_t,gt=Ve.y-Ae.y,wt,Ut,Dt=Ze*Ze+gt*gt;Dt?(_t=Ae.r+Ue.r,_t*=_t,Ut=Ve.r+Ue.r,Ut*=Ut,_t>Ut?(Qe=(Dt+Ut-_t)/(2*Dt),wt=Math.sqrt(Math.max(0,Ut/Dt-Qe*Qe)),Ue.x=Ve.x-Qe*Ze-wt*gt,Ue.y=Ve.y-Qe*gt+wt*Ze):(Qe=(Dt+_t-Ut)/(2*Dt),wt=Math.sqrt(Math.max(0,_t/Dt-Qe*Qe)),Ue.x=Ae.x+Qe*Ze-wt*gt,Ue.y=Ae.y+Qe*gt+wt*Ze)):(Ue.x=Ae.x+Ue.r,Ue.y=Ae.y)}function re(Ve,Ae){var Ue=Ve.r+Ae.r-1e-6,Ze=Ae.x-Ve.x,Qe=Ae.y-Ve.y;return Ue>0&&Ue*Ue>Ze*Ze+Qe*Qe}function ue(Ve){var Ae=Ve._,Ue=Ve.next._,Ze=Ae.r+Ue.r,Qe=(Ae.x*Ue.r+Ue.x*Ae.r)/Ze,_t=(Ae.y*Ue.r+Ue.y*Ae.r)/Ze;return Qe*Qe+_t*_t}function j(Ve){this._=Ve,this.next=null,this.previous=null}function q(Ve){if(!(Qe=Ve.length))return 0;var Ae,Ue,Ze,Qe,_t,gt,wt,Ut,Dt,Nt,Xt;if(Ae=Ve[0],Ae.x=0,Ae.y=0,!(Qe>1))return Ae.r;if(Ue=Ve[1],Ae.x=-Ue.r,Ue.x=Ae.r,Ue.y=0,!(Qe>2))return Ae.r+Ue.r;Y(Ue,Ae,Ze=Ve[2]),Ae=new j(Ae),Ue=new j(Ue),Ze=new j(Ze),Ae.next=Ze.previous=Ue,Ue.next=Ae.previous=Ze,Ze.next=Ue.previous=Ae;e:for(wt=3;wt<Qe;++wt){Y(Ae._,Ue._,Ze=Ve[wt]),Ze=new j(Ze),Ut=Ue.next,Dt=Ae.previous,Nt=Ue._.r,Xt=Ae._.r;do if(Nt<=Xt){if(re(Ut._,Ze._)){Ue=Ut,Ae.next=Ue,Ue.previous=Ae,--wt;continue e}Nt+=Ut._.r,Ut=Ut.next}else{if(re(Dt._,Ze._)){Ae=Dt,Ae.next=Ue,Ue.previous=Ae,--wt;continue e}Xt+=Dt._.r,Dt=Dt.previous}while(Ut!==Dt.next);for(Ze.previous=Ae,Ze.next=Ue,Ae.next=Ue.previous=Ue=Ze,_t=ue(Ae);(Ze=Ze.next)!==Ue;)(gt=ue(Ze))<_t&&(Ae=Ze,_t=gt);Ue=Ae.next}for(Ae=[Ue._],Ze=Ue;(Ze=Ze.next)!==Ue;)Ae.push(Ze._);for(Ze=I(Ae),wt=0;wt<Qe;++wt)Ae=Ve[wt],Ae.x-=Ze.x,Ae.y-=Ze.y;return Ze.r}function V(Ve){return q(Ve),Ve}function U(Ve){return Ve==null?null:$(Ve)}function $(Ve){if(typeof Ve!="function")throw new Error;return Ve}function ne(){return 0}function X(Ve){return function(){return Ve}}function Q(Ve){return Math.sqrt(Ve.value)}function ie(){var Ve=null,Ae=1,Ue=1,Ze=ne;function Qe(_t){return _t.x=Ae/2,_t.y=Ue/2,Ve?_t.eachBefore(se(Ve)).eachAfter(ae(Ze,.5)).eachBefore(oe(1)):_t.eachBefore(se(Q)).eachAfter(ae(ne,1)).eachAfter(ae(Ze,_t.r/Math.min(Ae,Ue))).eachBefore(oe(Math.min(Ae,Ue)/(2*_t.r))),_t}return Qe.radius=function(_t){return arguments.length?(Ve=U(_t),Qe):Ve},Qe.size=function(_t){return arguments.length?(Ae=+_t[0],Ue=+_t[1],Qe):[Ae,Ue]},Qe.padding=function(_t){return arguments.length?(Ze=typeof _t=="function"?_t:X(+_t),Qe):Ze},Qe}function se(Ve){return function(Ae){Ae.children||(Ae.r=Math.max(0,+Ve(Ae)||0))}}function ae(Ve,Ae){return function(Ue){if(Ze=Ue.children){var Ze,Qe,_t=Ze.length,gt=Ve(Ue)*Ae||0,wt;if(gt)for(Qe=0;Qe<_t;++Qe)Ze[Qe].r+=gt;if(wt=q(Ze),gt)for(Qe=0;Qe<_t;++Qe)Ze[Qe].r-=gt;Ue.r=wt+gt}}}function oe(Ve){return function(Ae){var Ue=Ae.parent;Ae.r*=Ve,Ue&&(Ae.x=Ue.x+Ve*Ae.x,Ae.y=Ue.y+Ve*Ae.y)}}function be(Ve){Ve.x0=Math.round(Ve.x0),Ve.y0=Math.round(Ve.y0),Ve.x1=Math.round(Ve.x1),Ve.y1=Math.round(Ve.y1)}function ce(Ve,Ae,Ue,Ze,Qe){for(var _t=Ve.children,gt,wt=-1,Ut=_t.length,Dt=Ve.value&&(Ze-Ae)/Ve.value;++wt<Ut;)gt=_t[wt],gt.y0=Ue,gt.y1=Qe,gt.x0=Ae,gt.x1=Ae+=gt.value*Dt}function de(){var Ve=1,Ae=1,Ue=0,Ze=!1;function Qe(gt){var wt=gt.height+1;return gt.x0=gt.y0=Ue,gt.x1=Ve,gt.y1=Ae/wt,gt.eachBefore(_t(Ae,wt)),Ze&&gt.eachBefore(be),gt}function _t(gt,wt){return function(Ut){Ut.children&&ce(Ut,Ut.x0,gt*(Ut.depth+1)/wt,Ut.x1,gt*(Ut.depth+2)/wt);var Dt=Ut.x0,Nt=Ut.y0,Xt=Ut.x1-Ue,Ht=Ut.y1-Ue;Xt<Dt&&(Dt=Xt=(Dt+Xt)/2),Ht<Nt&&(Nt=Ht=(Nt+Ht)/2),Ut.x0=Dt,Ut.y0=Nt,Ut.x1=Xt,Ut.y1=Ht}}return Qe.round=function(gt){return arguments.length?(Ze=!!gt,Qe):Ze},Qe.size=function(gt){return arguments.length?(Ve=+gt[0],Ae=+gt[1],Qe):[Ve,Ae]},Qe.padding=function(gt){return arguments.length?(Ue=+gt,Qe):Ue},Qe}var ye="$",ge={depth:-1},me={};function Ee(Ve){return Ve.id}function Pe(Ve){return Ve.parentId}function Ne(){var Ve=Ee,Ae=Pe;function Ue(Ze){var Qe,_t,gt=Ze.length,wt,Ut,Dt,Nt=new Array(gt),Xt,Ht,ar={};for(_t=0;_t<gt;++_t)Qe=Ze[_t],Dt=Nt[_t]=new k(Qe),(Xt=Ve(Qe,_t,Ze))!=null&&(Xt+="")&&(Ht=ye+(Dt.id=Xt),ar[Ht]=Ht in ar?me:Dt);for(_t=0;_t<gt;++_t)if(Dt=Nt[_t],Xt=Ae(Ze[_t],_t,Ze),Xt==null||!(Xt+="")){if(wt)throw new Error("multiple roots");wt=Dt}else{if(Ut=ar[ye+Xt],!Ut)throw new Error("missing: "+Xt);if(Ut===me)throw new Error("ambiguous: "+Xt);Ut.children?Ut.children.push(Dt):Ut.children=[Dt],Dt.parent=Ut}if(!wt)throw new Error("no root");if(wt.parent=ge,wt.eachBefore(function(Vr){Vr.depth=Vr.parent.depth+1,--gt}).eachBefore(T),wt.parent=null,gt>0)throw new Error("cycle");return wt}return Ue.id=function(Ze){return arguments.length?(Ve=$(Ze),Ue):Ve},Ue.parentId=function(Ze){return arguments.length?(Ae=$(Ze),Ue):Ae},Ue}function we(Ve,Ae){return Ve.parent===Ae.parent?1:2}function ke(Ve){var Ae=Ve.children;return Ae?Ae[0]:Ve.t}function Xe(Ve){var Ae=Ve.children;return Ae?Ae[Ae.length-1]:Ve.t}function He(Ve,Ae,Ue){var Ze=Ue/(Ae.i-Ve.i);Ae.c-=Ze,Ae.s+=Ue,Ve.c+=Ze,Ae.z+=Ue,Ae.m+=Ue}function Ie(Ve){for(var Ae=0,Ue=0,Ze=Ve.children,Qe=Ze.length,_t;--Qe>=0;)_t=Ze[Qe],_t.z+=Ae,_t.m+=Ae,Ae+=_t.s+(Ue+=_t.c)}function De(Ve,Ae,Ue){return Ve.a.parent===Ae.parent?Ve.a:Ue}function Ge(Ve,Ae){this._=Ve,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=Ae}Ge.prototype=Object.create(k.prototype);function ht(Ve){for(var Ae=new Ge(Ve,0),Ue,Ze=[Ae],Qe,_t,gt,wt;Ue=Ze.pop();)if(_t=Ue._.children)for(Ue.children=new Array(wt=_t.length),gt=wt-1;gt>=0;--gt)Ze.push(Qe=Ue.children[gt]=new Ge(_t[gt],gt)),Qe.parent=Ue;return(Ae.parent=new Ge(null,0)).children=[Ae],Ae}function Rt(){var Ve=we,Ae=1,Ue=1,Ze=null;function Qe(Dt){var Nt=ht(Dt);if(Nt.eachAfter(_t),Nt.parent.m=-Nt.z,Nt.eachBefore(gt),Ze)Dt.eachBefore(Ut);else{var Xt=Dt,Ht=Dt,ar=Dt;Dt.eachBefore(function($t){$t.x<Xt.x&&(Xt=$t),$t.x>Ht.x&&(Ht=$t),$t.depth>ar.depth&&(ar=$t)});var Vr=Xt===Ht?1:Ve(Xt,Ht)/2,nn=Vr-Xt.x,jr=Ae/(Ht.x+Vr+nn),at=Ue/(ar.depth||1);Dt.eachBefore(function($t){$t.x=($t.x+nn)*jr,$t.y=$t.depth*at})}return Dt}function _t(Dt){var Nt=Dt.children,Xt=Dt.parent.children,Ht=Dt.i?Xt[Dt.i-1]:null;if(Nt){Ie(Dt);var ar=(Nt[0].z+Nt[Nt.length-1].z)/2;Ht?(Dt.z=Ht.z+Ve(Dt._,Ht._),Dt.m=Dt.z-ar):Dt.z=ar}else Ht&&(Dt.z=Ht.z+Ve(Dt._,Ht._));Dt.parent.A=wt(Dt,Ht,Dt.parent.A||Xt[0])}function gt(Dt){Dt._.x=Dt.z+Dt.parent.m,Dt.m+=Dt.parent.m}function wt(Dt,Nt,Xt){if(Nt){for(var Ht=Dt,ar=Dt,Vr=Nt,nn=Ht.parent.children[0],jr=Ht.m,at=ar.m,$t=Vr.m,Zt=nn.m,ur;Vr=Xe(Vr),Ht=ke(Ht),Vr&&Ht;)nn=ke(nn),ar=Xe(ar),ar.a=Dt,ur=Vr.z+$t-Ht.z-jr+Ve(Vr._,Ht._),ur>0&&(He(De(Vr,Dt,Xt),Dt,ur),jr+=ur,at+=ur),$t+=Vr.m,jr+=Ht.m,Zt+=nn.m,at+=ar.m;Vr&&!Xe(ar)&&(ar.t=Vr,ar.m+=$t-at),Ht&&!ke(nn)&&(nn.t=Ht,nn.m+=jr-Zt,Xt=Dt)}return Xt}function Ut(Dt){Dt.x*=Ae,Dt.y=Dt.depth*Ue}return Qe.separation=function(Dt){return arguments.length?(Ve=Dt,Qe):Ve},Qe.size=function(Dt){return arguments.length?(Ze=!1,Ae=+Dt[0],Ue=+Dt[1],Qe):Ze?null:[Ae,Ue]},Qe.nodeSize=function(Dt){return arguments.length?(Ze=!0,Ae=+Dt[0],Ue=+Dt[1],Qe):Ze?[Ae,Ue]:null},Qe}function Kt(Ve,Ae,Ue,Ze,Qe){for(var _t=Ve.children,gt,wt=-1,Ut=_t.length,Dt=Ve.value&&(Qe-Ue)/Ve.value;++wt<Ut;)gt=_t[wt],gt.x0=Ae,gt.x1=Ze,gt.y0=Ue,gt.y1=Ue+=gt.value*Dt}var It=(1+Math.sqrt(5))/2;function Mt(Ve,Ae,Ue,Ze,Qe,_t){for(var gt=[],wt=Ae.children,Ut,Dt,Nt=0,Xt=0,Ht=wt.length,ar,Vr,nn=Ae.value,jr,at,$t,Zt,ur,wr,$e;Nt<Ht;){ar=Qe-Ue,Vr=_t-Ze;do jr=wt[Xt++].value;while(!jr&&Xt<Ht);for(at=$t=jr,wr=Math.max(Vr/ar,ar/Vr)/(nn*Ve),$e=jr*jr*wr,ur=Math.max($t/$e,$e/at);Xt<Ht;++Xt){if(jr+=Dt=wt[Xt].value,Dt<at&&(at=Dt),Dt>$t&&($t=Dt),$e=jr*jr*wr,Zt=Math.max($t/$e,$e/at),Zt>ur){jr-=Dt;break}ur=Zt}gt.push(Ut={value:jr,dice:ar<Vr,children:wt.slice(Nt,Xt)}),Ut.dice?ce(Ut,Ue,Ze,Qe,nn?Ze+=Vr*jr/nn:_t):Kt(Ut,Ue,Ze,nn?Ue+=ar*jr/nn:Qe,_t),nn-=jr,Nt=Xt}return gt}var Yt=function Ve(Ae){function Ue(Ze,Qe,_t,gt,wt){Mt(Ae,Ze,Qe,_t,gt,wt)}return Ue.ratio=function(Ze){return Ve((Ze=+Ze)>1?Ze:1)},Ue}(It);function zt(){var Ve=Yt,Ae=!1,Ue=1,Ze=1,Qe=[0],_t=ne,gt=ne,wt=ne,Ut=ne,Dt=ne;function Nt(Ht){return Ht.x0=Ht.y0=0,Ht.x1=Ue,Ht.y1=Ze,Ht.eachBefore(Xt),Qe=[0],Ae&&Ht.eachBefore(be),Ht}function Xt(Ht){var ar=Qe[Ht.depth],Vr=Ht.x0+ar,nn=Ht.y0+ar,jr=Ht.x1-ar,at=Ht.y1-ar;jr<Vr&&(Vr=jr=(Vr+jr)/2),at<nn&&(nn=at=(nn+at)/2),Ht.x0=Vr,Ht.y0=nn,Ht.x1=jr,Ht.y1=at,Ht.children&&(ar=Qe[Ht.depth+1]=_t(Ht)/2,Vr+=Dt(Ht)-ar,nn+=gt(Ht)-ar,jr-=wt(Ht)-ar,at-=Ut(Ht)-ar,jr<Vr&&(Vr=jr=(Vr+jr)/2),at<nn&&(nn=at=(nn+at)/2),Ve(Ht,Vr,nn,jr,at))}return Nt.round=function(Ht){return arguments.length?(Ae=!!Ht,Nt):Ae},Nt.size=function(Ht){return arguments.length?(Ue=+Ht[0],Ze=+Ht[1],Nt):[Ue,Ze]},Nt.tile=function(Ht){return arguments.length?(Ve=$(Ht),Nt):Ve},Nt.padding=function(Ht){return arguments.length?Nt.paddingInner(Ht).paddingOuter(Ht):Nt.paddingInner()},Nt.paddingInner=function(Ht){return arguments.length?(_t=typeof Ht=="function"?Ht:X(+Ht),Nt):_t},Nt.paddingOuter=function(Ht){return arguments.length?Nt.paddingTop(Ht).paddingRight(Ht).paddingBottom(Ht).paddingLeft(Ht):Nt.paddingTop()},Nt.paddingTop=function(Ht){return arguments.length?(gt=typeof Ht=="function"?Ht:X(+Ht),Nt):gt},Nt.paddingRight=function(Ht){return arguments.length?(wt=typeof Ht=="function"?Ht:X(+Ht),Nt):wt},Nt.paddingBottom=function(Ht){return arguments.length?(Ut=typeof Ht=="function"?Ht:X(+Ht),Nt):Ut},Nt.paddingLeft=function(Ht){return arguments.length?(Dt=typeof Ht=="function"?Ht:X(+Ht),Nt):Dt},Nt}function St(Ve,Ae,Ue,Ze,Qe){var _t=Ve.children,gt,wt=_t.length,Ut,Dt=new Array(wt+1);for(Dt[0]=Ut=gt=0;gt<wt;++gt)Dt[gt+1]=Ut+=_t[gt].value;Nt(0,wt,Ve.value,Ae,Ue,Ze,Qe);function Nt(Xt,Ht,ar,Vr,nn,jr,at){if(Xt>=Ht-1){var $t=_t[Xt];$t.x0=Vr,$t.y0=nn,$t.x1=jr,$t.y1=at;return}for(var Zt=Dt[Xt],ur=ar/2+Zt,wr=Xt+1,$e=Ht-1;wr<$e;){var Je=wr+$e>>>1;Dt[Je]<ur?wr=Je+1:$e=Je}ur-Dt[wr-1]<Dt[wr]-ur&&Xt+1<wr&&--wr;var it=Dt[wr]-Zt,lt=ar-it;if(jr-Vr>at-nn){var Tt=(Vr*lt+jr*it)/ar;Nt(Xt,wr,it,Vr,nn,Tt,at),Nt(wr,Ht,lt,Tt,nn,jr,at)}else{var Bt=(nn*lt+at*it)/ar;Nt(Xt,wr,it,Vr,nn,jr,Bt),Nt(wr,Ht,lt,Vr,Bt,jr,at)}}}function Ye(Ve,Ae,Ue,Ze,Qe){(Ve.depth&1?Kt:ce)(Ve,Ae,Ue,Ze,Qe)}var rt=function Ve(Ae){function Ue(Ze,Qe,_t,gt,wt){if((Ut=Ze._squarify)&&Ut.ratio===Ae)for(var Ut,Dt,Nt,Xt,Ht=-1,ar,Vr=Ut.length,nn=Ze.value;++Ht<Vr;){for(Dt=Ut[Ht],Nt=Dt.children,Xt=Dt.value=0,ar=Nt.length;Xt<ar;++Xt)Dt.value+=Nt[Xt].value;Dt.dice?ce(Dt,Qe,_t,gt,_t+=(wt-_t)*Dt.value/nn):Kt(Dt,Qe,_t,Qe+=(gt-Qe)*Dt.value/nn,wt),nn-=Dt.value}else Ze._squarify=Ut=Mt(Ae,Ze,Qe,_t,gt,wt),Ut.ratio=Ae}return Ue.ratio=function(Ze){return Ve((Ze=+Ze)>1?Ze:1)},Ue}(It);A.cluster=t,A.hierarchy=h,A.pack=ie,A.packEnclose=I,A.packSiblings=V,A.partition=de,A.stratify=Ne,A.tree=Rt,A.treemap=zt,A.treemapBinary=St,A.treemapDice=ce,A.treemapResquarify=rt,A.treemapSlice=Kt,A.treemapSliceDice=Ye,A.treemapSquarify=Yt,Object.defineProperty(A,"__esModule",{value:!0})})},{}],116:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,d("d3-color")):(A=A||self,g(A.d3=A.d3||{},A.d3))})(this,function(A,g){function S(we,ke,Xe,He,Ie){var De=we*we,Ge=De*we;return((1-3*we+3*De-Ge)*ke+(4-6*De+3*Ge)*Xe+(1+3*we+3*De-3*Ge)*He+Ge*Ie)/6}function M(we){var ke=we.length-1;return function(Xe){var He=Xe<=0?Xe=0:Xe>=1?(Xe=1,ke-1):Math.floor(Xe*ke),Ie=we[He],De=we[He+1],Ge=He>0?we[He-1]:2*Ie-De,ht=He<ke-1?we[He+2]:2*De-Ie;return S((Xe-He/ke)*ke,Ge,Ie,De,ht)}}function e(we){var ke=we.length;return function(Xe){var He=Math.floor(((Xe%=1)<0?++Xe:Xe)*ke),Ie=we[(He+ke-1)%ke],De=we[He%ke],Ge=we[(He+1)%ke],ht=we[(He+2)%ke];return S((Xe-He/ke)*ke,Ie,De,Ge,ht)}}function a(we){return function(){return we}}function n(we,ke){return function(Xe){return we+Xe*ke}}function r(we,ke,Xe){return we=Math.pow(we,Xe),ke=Math.pow(ke,Xe)-we,Xe=1/Xe,function(He){return Math.pow(we+He*ke,Xe)}}function t(we,ke){var Xe=ke-we;return Xe?n(we,Xe>180||Xe<-180?Xe-360*Math.round(Xe/360):Xe):a(isNaN(we)?ke:we)}function c(we){return(we=+we)==1?s:function(ke,Xe){return Xe-ke?r(ke,Xe,we):a(isNaN(ke)?Xe:ke)}}function s(we,ke){var Xe=ke-we;return Xe?n(we,Xe):a(isNaN(we)?ke:we)}var i=function we(ke){var Xe=c(ke);function He(Ie,De){var Ge=Xe((Ie=g.rgb(Ie)).r,(De=g.rgb(De)).r),ht=Xe(Ie.g,De.g),Rt=Xe(Ie.b,De.b),Kt=s(Ie.opacity,De.opacity);return function(It){return Ie.r=Ge(It),Ie.g=ht(It),Ie.b=Rt(It),Ie.opacity=Kt(It),Ie+""}}return He.gamma=we,He}(1);function x(we){return function(ke){var Xe=ke.length,He=new Array(Xe),Ie=new Array(Xe),De=new Array(Xe),Ge,ht;for(Ge=0;Ge<Xe;++Ge)ht=g.rgb(ke[Ge]),He[Ge]=ht.r||0,Ie[Ge]=ht.g||0,De[Ge]=ht.b||0;return He=we(He),Ie=we(Ie),De=we(De),ht.opacity=1,function(Rt){return ht.r=He(Rt),ht.g=Ie(Rt),ht.b=De(Rt),ht+""}}}var p=x(M),v=x(e);function f(we,ke){ke||(ke=[]);var Xe=we?Math.min(ke.length,we.length):0,He=ke.slice(),Ie;return function(De){for(Ie=0;Ie<Xe;++Ie)He[Ie]=we[Ie]*(1-De)+ke[Ie]*De;return He}}function y(we){return ArrayBuffer.isView(we)&&!(we instanceof DataView)}function o(we,ke){return(y(ke)?f:m)(we,ke)}function m(we,ke){var Xe=ke?ke.length:0,He=we?Math.min(Xe,we.length):0,Ie=new Array(He),De=new Array(Xe),Ge;for(Ge=0;Ge<He;++Ge)Ie[Ge]=k(we[Ge],ke[Ge]);for(;Ge<Xe;++Ge)De[Ge]=ke[Ge];return function(ht){for(Ge=0;Ge<He;++Ge)De[Ge]=Ie[Ge](ht);return De}}function l(we,ke){var Xe=new Date;return we=+we,ke=+ke,function(He){return Xe.setTime(we*(1-He)+ke*He),Xe}}function w(we,ke){return we=+we,ke=+ke,function(Xe){return we*(1-Xe)+ke*Xe}}function _(we,ke){var Xe={},He={},Ie;(we===null||typeof we!="object")&&(we={}),(ke===null||typeof ke!="object")&&(ke={});for(Ie in ke)Ie in we?Xe[Ie]=k(we[Ie],ke[Ie]):He[Ie]=ke[Ie];return function(De){for(Ie in Xe)He[Ie]=Xe[Ie](De);return He}}var h=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,b=new RegExp(h.source,"g");function u(we){return function(){return we}}function L(we){return function(ke){return we(ke)+""}}function T(we,ke){var Xe=h.lastIndex=b.lastIndex=0,He,Ie,De,Ge=-1,ht=[],Rt=[];for(we=we+"",ke=ke+"";(He=h.exec(we))&&(Ie=b.exec(ke));)(De=Ie.index)>Xe&&(De=ke.slice(Xe,De),ht[Ge]?ht[Ge]+=De:ht[++Ge]=De),(He=He[0])===(Ie=Ie[0])?ht[Ge]?ht[Ge]+=Ie:ht[++Ge]=Ie:(ht[++Ge]=null,Rt.push({i:Ge,x:w(He,Ie)})),Xe=b.lastIndex;return Xe<ke.length&&(De=ke.slice(Xe),ht[Ge]?ht[Ge]+=De:ht[++Ge]=De),ht.length<2?Rt[0]?L(Rt[0].x):u(ke):(ke=Rt.length,function(Kt){for(var It=0,Mt;It<ke;++It)ht[(Mt=Rt[It]).i]=Mt.x(Kt);return ht.join("")})}function k(we,ke){var Xe=typeof ke,He;return ke==null||Xe==="boolean"?a(ke):(Xe==="number"?w:Xe==="string"?(He=g.color(ke))?(ke=He,i):T:ke instanceof g.color?i:ke instanceof Date?l:y(ke)?f:Array.isArray(ke)?m:typeof ke.valueOf!="function"&&typeof ke.toString!="function"||isNaN(ke)?_:w)(we,ke)}function P(we){var ke=we.length;return function(Xe){return we[Math.max(0,Math.min(ke-1,Math.floor(Xe*ke)))]}}function z(we,ke){var Xe=t(+we,+ke);return function(He){var Ie=Xe(He);return Ie-360*Math.floor(Ie/360)}}function I(we,ke){return we=+we,ke=+ke,function(Xe){return Math.round(we*(1-Xe)+ke*Xe)}}var D=180/Math.PI,R={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function O(we,ke,Xe,He,Ie,De){var Ge,ht,Rt;return(Ge=Math.sqrt(we*we+ke*ke))&&(we/=Ge,ke/=Ge),(Rt=we*Xe+ke*He)&&(Xe-=we*Rt,He-=ke*Rt),(ht=Math.sqrt(Xe*Xe+He*He))&&(Xe/=ht,He/=ht,Rt/=ht),we*He<ke*Xe&&(we=-we,ke=-ke,Rt=-Rt,Ge=-Ge),{translateX:Ie,translateY:De,rotate:Math.atan2(ke,we)*D,skewX:Math.atan(Rt)*D,scaleX:Ge,scaleY:ht}}var F,N,G,K;function W(we){return we==="none"?R:(F||(F=document.createElement("DIV"),N=document.documentElement,G=document.defaultView),F.style.transform=we,we=G.getComputedStyle(N.appendChild(F),null).getPropertyValue("transform"),N.removeChild(F),we=we.slice(7,-1).split(","),O(+we[0],+we[1],+we[2],+we[3],+we[4],+we[5]))}function Y(we){return we==null||(K||(K=document.createElementNS("http://www.w3.org/2000/svg","g")),K.setAttribute("transform",we),!(we=K.transform.baseVal.consolidate()))?R:(we=we.matrix,O(we.a,we.b,we.c,we.d,we.e,we.f))}function re(we,ke,Xe,He){function Ie(Kt){return Kt.length?Kt.pop()+" ":""}function De(Kt,It,Mt,Yt,zt,St){if(Kt!==Mt||It!==Yt){var Ye=zt.push("translate(",null,ke,null,Xe);St.push({i:Ye-4,x:w(Kt,Mt)},{i:Ye-2,x:w(It,Yt)})}else(Mt||Yt)&&zt.push("translate("+Mt+ke+Yt+Xe)}function Ge(Kt,It,Mt,Yt){Kt!==It?(Kt-It>180?It+=360:It-Kt>180&&(Kt+=360),Yt.push({i:Mt.push(Ie(Mt)+"rotate(",null,He)-2,x:w(Kt,It)})):It&&Mt.push(Ie(Mt)+"rotate("+It+He)}function ht(Kt,It,Mt,Yt){Kt!==It?Yt.push({i:Mt.push(Ie(Mt)+"skewX(",null,He)-2,x:w(Kt,It)}):It&&Mt.push(Ie(Mt)+"skewX("+It+He)}function Rt(Kt,It,Mt,Yt,zt,St){if(Kt!==Mt||It!==Yt){var Ye=zt.push(Ie(zt)+"scale(",null,",",null,")");St.push({i:Ye-4,x:w(Kt,Mt)},{i:Ye-2,x:w(It,Yt)})}else(Mt!==1||Yt!==1)&&zt.push(Ie(zt)+"scale("+Mt+","+Yt+")")}return function(Kt,It){var Mt=[],Yt=[];return Kt=we(Kt),It=we(It),De(Kt.translateX,Kt.translateY,It.translateX,It.translateY,Mt,Yt),Ge(Kt.rotate,It.rotate,Mt,Yt),ht(Kt.skewX,It.skewX,Mt,Yt),Rt(Kt.scaleX,Kt.scaleY,It.scaleX,It.scaleY,Mt,Yt),Kt=It=null,function(zt){for(var St=-1,Ye=Yt.length,rt;++St<Ye;)Mt[(rt=Yt[St]).i]=rt.x(zt);return Mt.join("")}}}var ue=re(W,"px, ","px)","deg)"),j=re(Y,", ",")",")"),q=Math.SQRT2,V=2,U=4,$=1e-12;function ne(we){return((we=Math.exp(we))+1/we)/2}function X(we){return((we=Math.exp(we))-1/we)/2}function Q(we){return((we=Math.exp(2*we))-1)/(we+1)}function ie(we,ke){var Xe=we[0],He=we[1],Ie=we[2],De=ke[0],Ge=ke[1],ht=ke[2],Rt=De-Xe,Kt=Ge-He,It=Rt*Rt+Kt*Kt,Mt,Yt;if(It<$)Yt=Math.log(ht/Ie)/q,Mt=function(Ae){return[Xe+Ae*Rt,He+Ae*Kt,Ie*Math.exp(q*Ae*Yt)]};else{var zt=Math.sqrt(It),St=(ht*ht-Ie*Ie+U*It)/(2*Ie*V*zt),Ye=(ht*ht-Ie*Ie-U*It)/(2*ht*V*zt),rt=Math.log(Math.sqrt(St*St+1)-St),Ve=Math.log(Math.sqrt(Ye*Ye+1)-Ye);Yt=(Ve-rt)/q,Mt=function(Ae){var Ue=Ae*Yt,Ze=ne(rt),Qe=Ie/(V*zt)*(Ze*Q(q*Ue+rt)-X(rt));return[Xe+Qe*Rt,He+Qe*Kt,Ie*Ze/ne(q*Ue+rt)]}}return Mt.duration=Yt*1e3,Mt}function se(we){return function(ke,Xe){var He=we((ke=g.hsl(ke)).h,(Xe=g.hsl(Xe)).h),Ie=s(ke.s,Xe.s),De=s(ke.l,Xe.l),Ge=s(ke.opacity,Xe.opacity);return function(ht){return ke.h=He(ht),ke.s=Ie(ht),ke.l=De(ht),ke.opacity=Ge(ht),ke+""}}}var ae=se(t),oe=se(s);function be(we,ke){var Xe=s((we=g.lab(we)).l,(ke=g.lab(ke)).l),He=s(we.a,ke.a),Ie=s(we.b,ke.b),De=s(we.opacity,ke.opacity);return function(Ge){return we.l=Xe(Ge),we.a=He(Ge),we.b=Ie(Ge),we.opacity=De(Ge),we+""}}function ce(we){return function(ke,Xe){var He=we((ke=g.hcl(ke)).h,(Xe=g.hcl(Xe)).h),Ie=s(ke.c,Xe.c),De=s(ke.l,Xe.l),Ge=s(ke.opacity,Xe.opacity);return function(ht){return ke.h=He(ht),ke.c=Ie(ht),ke.l=De(ht),ke.opacity=Ge(ht),ke+""}}}var de=ce(t),ye=ce(s);function ge(we){return function ke(Xe){Xe=+Xe;function He(Ie,De){var Ge=we((Ie=g.cubehelix(Ie)).h,(De=g.cubehelix(De)).h),ht=s(Ie.s,De.s),Rt=s(Ie.l,De.l),Kt=s(Ie.opacity,De.opacity);return function(It){return Ie.h=Ge(It),Ie.s=ht(It),Ie.l=Rt(Math.pow(It,Xe)),Ie.opacity=Kt(It),Ie+""}}return He.gamma=ke,He}(1)}var me=ge(t),Ee=ge(s);function Pe(we,ke){for(var Xe=0,He=ke.length-1,Ie=ke[0],De=new Array(He<0?0:He);Xe<He;)De[Xe]=we(Ie,Ie=ke[++Xe]);return function(Ge){var ht=Math.max(0,Math.min(He-1,Math.floor(Ge*=He)));return De[ht](Ge-ht)}}function Ne(we,ke){for(var Xe=new Array(ke),He=0;He<ke;++He)Xe[He]=we(He/(ke-1));return Xe}A.interpolate=k,A.interpolateArray=o,A.interpolateBasis=M,A.interpolateBasisClosed=e,A.interpolateCubehelix=me,A.interpolateCubehelixLong=Ee,A.interpolateDate=l,A.interpolateDiscrete=P,A.interpolateHcl=de,A.interpolateHclLong=ye,A.interpolateHsl=ae,A.interpolateHslLong=oe,A.interpolateHue=z,A.interpolateLab=be,A.interpolateNumber=w,A.interpolateNumberArray=f,A.interpolateObject=_,A.interpolateRgb=i,A.interpolateRgbBasis=p,A.interpolateRgbBasisClosed=v,A.interpolateRound=I,A.interpolateString=T,A.interpolateTransformCss=ue,A.interpolateTransformSvg=j,A.interpolateZoom=ie,A.piecewise=Pe,A.quantize=Ne,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-color":109}],117:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){var g=Math.PI,S=2*g,M=1e-6,e=S-M;function a(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function n(){return new a}a.prototype=n.prototype={constructor:a,moveTo:function(r,t){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(r,t){this._+="L"+(this._x1=+r)+","+(this._y1=+t)},quadraticCurveTo:function(r,t,c,s){this._+="Q"+ +r+","+ +t+","+(this._x1=+c)+","+(this._y1=+s)},bezierCurveTo:function(r,t,c,s,i,x){this._+="C"+ +r+","+ +t+","+ +c+","+ +s+","+(this._x1=+i)+","+(this._y1=+x)},arcTo:function(r,t,c,s,i){r=+r,t=+t,c=+c,s=+s,i=+i;var x=this._x1,p=this._y1,v=c-r,f=s-t,y=x-r,o=p-t,m=y*y+o*o;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=r)+","+(this._y1=t);else if(m>M)if(!(Math.abs(o*v-f*y)>M)||!i)this._+="L"+(this._x1=r)+","+(this._y1=t);else{var l=c-x,w=s-p,_=v*v+f*f,h=l*l+w*w,b=Math.sqrt(_),u=Math.sqrt(m),L=i*Math.tan((g-Math.acos((_+m-h)/(2*b*u)))/2),T=L/u,k=L/b;Math.abs(T-1)>M&&(this._+="L"+(r+T*y)+","+(t+T*o)),this._+="A"+i+","+i+",0,0,"+ +(o*l>y*w)+","+(this._x1=r+k*v)+","+(this._y1=t+k*f)}},arc:function(r,t,c,s,i,x){r=+r,t=+t,c=+c,x=!!x;var p=c*Math.cos(s),v=c*Math.sin(s),f=r+p,y=t+v,o=1^x,m=x?s-i:i-s;if(c<0)throw new Error("negative radius: "+c);this._x1===null?this._+="M"+f+","+y:(Math.abs(this._x1-f)>M||Math.abs(this._y1-y)>M)&&(this._+="L"+f+","+y),c&&(m<0&&(m=m%S+S),m>e?this._+="A"+c+","+c+",0,1,"+o+","+(r-p)+","+(t-v)+"A"+c+","+c+",0,1,"+o+","+(this._x1=f)+","+(this._y1=y):m>M&&(this._+="A"+c+","+c+",0,"+ +(m>=g)+","+o+","+(this._x1=r+c*Math.cos(i))+","+(this._y1=t+c*Math.sin(i))))},rect:function(r,t,c,s){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+t)+"h"+ +c+"v"+ +s+"h"+-c+"Z"},toString:function(){return this._}},A.path=n,Object.defineProperty(A,"__esModule",{value:!0})})},{}],118:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){function g(b){var u=+this._x.call(null,b),L=+this._y.call(null,b);return S(this.cover(u,L),u,L,b)}function S(b,u,L,T){if(isNaN(u)||isNaN(L))return b;var k,P=b._root,z={data:T},I=b._x0,D=b._y0,R=b._x1,O=b._y1,F,N,G,K,W,Y,re,ue;if(!P)return b._root=z,b;for(;P.length;)if((W=u>=(F=(I+R)/2))?I=F:R=F,(Y=L>=(N=(D+O)/2))?D=N:O=N,k=P,!(P=P[re=Y<<1|W]))return k[re]=z,b;if(G=+b._x.call(null,P.data),K=+b._y.call(null,P.data),u===G&&L===K)return z.next=P,k?k[re]=z:b._root=z,b;do k=k?k[re]=new Array(4):b._root=new Array(4),(W=u>=(F=(I+R)/2))?I=F:R=F,(Y=L>=(N=(D+O)/2))?D=N:O=N;while((re=Y<<1|W)===(ue=(K>=N)<<1|G>=F));return k[ue]=P,k[re]=z,b}function M(b){var u,L,T=b.length,k,P,z=new Array(T),I=new Array(T),D=1/0,R=1/0,O=-1/0,F=-1/0;for(L=0;L<T;++L)isNaN(k=+this._x.call(null,u=b[L]))||isNaN(P=+this._y.call(null,u))||(z[L]=k,I[L]=P,k<D&&(D=k),k>O&&(O=k),P<R&&(R=P),P>F&&(F=P));if(D>O||R>F)return this;for(this.cover(D,R).cover(O,F),L=0;L<T;++L)S(this,z[L],I[L],b[L]);return this}function e(b,u){if(isNaN(b=+b)||isNaN(u=+u))return this;var L=this._x0,T=this._y0,k=this._x1,P=this._y1;if(isNaN(L))k=(L=Math.floor(b))+1,P=(T=Math.floor(u))+1;else{for(var z=k-L,I=this._root,D,R;L>b||b>=k||T>u||u>=P;)switch(R=(u<T)<<1|b<L,D=new Array(4),D[R]=I,I=D,z*=2,R){case 0:k=L+z,P=T+z;break;case 1:L=k-z,P=T+z;break;case 2:k=L+z,T=P-z;break;case 3:L=k-z,T=P-z;break}this._root&&this._root.length&&(this._root=I)}return this._x0=L,this._y0=T,this._x1=k,this._y1=P,this}function a(){var b=[];return this.visit(function(u){if(!u.length)do b.push(u.data);while(u=u.next)}),b}function n(b){return arguments.length?this.cover(+b[0][0],+b[0][1]).cover(+b[1][0],+b[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function r(b,u,L,T,k){this.node=b,this.x0=u,this.y0=L,this.x1=T,this.y1=k}function t(b,u,L){var T,k=this._x0,P=this._y0,z,I,D,R,O=this._x1,F=this._y1,N=[],G=this._root,K,W;for(G&&N.push(new r(G,k,P,O,F)),L==null?L=1/0:(k=b-L,P=u-L,O=b+L,F=u+L,L*=L);K=N.pop();)if(!(!(G=K.node)||(z=K.x0)>O||(I=K.y0)>F||(D=K.x1)<k||(R=K.y1)<P))if(G.length){var Y=(z+D)/2,re=(I+R)/2;N.push(new r(G[3],Y,re,D,R),new r(G[2],z,re,Y,R),new r(G[1],Y,I,D,re),new r(G[0],z,I,Y,re)),(W=(u>=re)<<1|b>=Y)&&(K=N[N.length-1],N[N.length-1]=N[N.length-1-W],N[N.length-1-W]=K)}else{var ue=b-+this._x.call(null,G.data),j=u-+this._y.call(null,G.data),q=ue*ue+j*j;if(q<L){var V=Math.sqrt(L=q);k=b-V,P=u-V,O=b+V,F=u+V,T=G.data}}return T}function c(b){if(isNaN(O=+this._x.call(null,b))||isNaN(F=+this._y.call(null,b)))return this;var u,L=this._root,T,k,P,z=this._x0,I=this._y0,D=this._x1,R=this._y1,O,F,N,G,K,W,Y,re;if(!L)return this;if(L.length)for(;;){if((K=O>=(N=(z+D)/2))?z=N:D=N,(W=F>=(G=(I+R)/2))?I=G:R=G,u=L,!(L=L[Y=W<<1|K]))return this;if(!L.length)break;(u[Y+1&3]||u[Y+2&3]||u[Y+3&3])&&(T=u,re=Y)}for(;L.data!==b;)if(k=L,!(L=L.next))return this;return(P=L.next)&&delete L.next,k?(P?k.next=P:delete k.next,this):u?(P?u[Y]=P:delete u[Y],(L=u[0]||u[1]||u[2]||u[3])&&L===(u[3]||u[2]||u[1]||u[0])&&!L.length&&(T?T[re]=L:this._root=L),this):(this._root=P,this)}function s(b){for(var u=0,L=b.length;u<L;++u)this.remove(b[u]);return this}function i(){return this._root}function x(){var b=0;return this.visit(function(u){if(!u.length)do++b;while(u=u.next)}),b}function p(b){var u=[],L,T=this._root,k,P,z,I,D;for(T&&u.push(new r(T,this._x0,this._y0,this._x1,this._y1));L=u.pop();)if(!b(T=L.node,P=L.x0,z=L.y0,I=L.x1,D=L.y1)&&T.length){var R=(P+I)/2,O=(z+D)/2;(k=T[3])&&u.push(new r(k,R,O,I,D)),(k=T[2])&&u.push(new r(k,P,O,R,D)),(k=T[1])&&u.push(new r(k,R,z,I,O)),(k=T[0])&&u.push(new r(k,P,z,R,O))}return this}function v(b){var u=[],L=[],T;for(this._root&&u.push(new r(this._root,this._x0,this._y0,this._x1,this._y1));T=u.pop();){var k=T.node;if(k.length){var P,z=T.x0,I=T.y0,D=T.x1,R=T.y1,O=(z+D)/2,F=(I+R)/2;(P=k[0])&&u.push(new r(P,z,I,O,F)),(P=k[1])&&u.push(new r(P,O,I,D,F)),(P=k[2])&&u.push(new r(P,z,F,O,R)),(P=k[3])&&u.push(new r(P,O,F,D,R))}L.push(T)}for(;T=L.pop();)b(T.node,T.x0,T.y0,T.x1,T.y1);return this}function f(b){return b[0]}function y(b){return arguments.length?(this._x=b,this):this._x}function o(b){return b[1]}function m(b){return arguments.length?(this._y=b,this):this._y}function l(b,u,L){var T=new w(u==null?f:u,L==null?o:L,NaN,NaN,NaN,NaN);return b==null?T:T.addAll(b)}function w(b,u,L,T,k,P){this._x=b,this._y=u,this._x0=L,this._y0=T,this._x1=k,this._y1=P,this._root=void 0}function _(b){for(var u={data:b.data},L=u;b=b.next;)L=L.next={data:b.data};return u}var h=l.prototype=w.prototype;h.copy=function(){var b=new w(this._x,this._y,this._x0,this._y0,this._x1,this._y1),u=this._root,L,T;if(!u)return b;if(!u.length)return b._root=_(u),b;for(L=[{source:u,target:b._root=new Array(4)}];u=L.pop();)for(var k=0;k<4;++k)(T=u.source[k])&&(T.length?L.push({source:T,target:u.target[k]=new Array(4)}):u.target[k]=_(T));return b},h.add=g,h.addAll=M,h.cover=e,h.data=a,h.extent=n,h.find=t,h.remove=c,h.removeAll=s,h.root=i,h.size=x,h.visit=p,h.visitAfter=v,h.x=y,h.y=m,A.quadtree=l,Object.defineProperty(A,"__esModule",{value:!0})})},{}],119:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,d("d3-path")):(A=A||self,g(A.d3=A.d3||{},A.d3))})(this,function(A,g){function S(tt){return function(){return tt}}var M=Math.abs,e=Math.atan2,a=Math.cos,n=Math.max,r=Math.min,t=Math.sin,c=Math.sqrt,s=1e-12,i=Math.PI,x=i/2,p=2*i;function v(tt){return tt>1?0:tt<-1?i:Math.acos(tt)}function f(tt){return tt>=1?x:tt<=-1?-x:Math.asin(tt)}function y(tt){return tt.innerRadius}function o(tt){return tt.outerRadius}function m(tt){return tt.startAngle}function l(tt){return tt.endAngle}function w(tt){return tt&&tt.padAngle}function _(tt,Lt,Wt,ir,Ir,Br,Er,_r){var Gr=Wt-tt,wn=ir-Lt,cn=Er-Ir,Bn=_r-Br,En=Bn*Gr-cn*wn;if(!(En*En<s))return En=(cn*(Lt-Br)-Bn*(tt-Ir))/En,[tt+En*Gr,Lt+En*wn]}function h(tt,Lt,Wt,ir,Ir,Br,Er){var _r=tt-Wt,Gr=Lt-ir,wn=(Er?Br:-Br)/c(_r*_r+Gr*Gr),cn=wn*Gr,Bn=-wn*_r,En=tt+cn,Yn=Lt+Bn,Hn=Wt+cn,pa=ir+Bn,Ma=(En+Hn)/2,ci=(Yn+pa)/2,Ha=Hn-En,ja=pa-Yn,Wa=Ha*Ha+ja*ja,Tr=Ir-Br,pn=En*pa-Hn*Yn,fn=(ja<0?-1:1)*c(n(0,Tr*Tr*Wa-pn*pn)),An=(pn*ja-Ha*fn)/Wa,Zn=(-pn*Ha-ja*fn)/Wa,ua=(pn*ja+Ha*fn)/Wa,ea=(-pn*Ha+ja*fn)/Wa,Rn=An-Ma,Xn=Zn-ci,Ua=ua-Ma,li=ea-ci;return Rn*Rn+Xn*Xn>Ua*Ua+li*li&&(An=ua,Zn=ea),{cx:An,cy:Zn,x01:-cn,y01:-Bn,x11:An*(Ir/Tr-1),y11:Zn*(Ir/Tr-1)}}function b(){var tt=y,Lt=o,Wt=S(0),ir=null,Ir=m,Br=l,Er=w,_r=null;function Gr(){var wn,cn,Bn=+tt.apply(this,arguments),En=+Lt.apply(this,arguments),Yn=Ir.apply(this,arguments)-x,Hn=Br.apply(this,arguments)-x,pa=M(Hn-Yn),Ma=Hn>Yn;if(_r||(_r=wn=g.path()),En<Bn&&(cn=En,En=Bn,Bn=cn),!(En>s))_r.moveTo(0,0);else if(pa>p-s)_r.moveTo(En*a(Yn),En*t(Yn)),_r.arc(0,0,En,Yn,Hn,!Ma),Bn>s&&(_r.moveTo(Bn*a(Hn),Bn*t(Hn)),_r.arc(0,0,Bn,Hn,Yn,Ma));else{var ci=Yn,Ha=Hn,ja=Yn,Wa=Hn,Tr=pa,pn=pa,fn=Er.apply(this,arguments)/2,An=fn>s&&(ir?+ir.apply(this,arguments):c(Bn*Bn+En*En)),Zn=r(M(En-Bn)/2,+Wt.apply(this,arguments)),ua=Zn,ea=Zn,Rn,Xn;if(An>s){var Ua=f(An/Bn*t(fn)),li=f(An/En*t(fn));(Tr-=Ua*2)>s?(Ua*=Ma?1:-1,ja+=Ua,Wa-=Ua):(Tr=0,ja=Wa=(Yn+Hn)/2),(pn-=li*2)>s?(li*=Ma?1:-1,ci+=li,Ha-=li):(pn=0,ci=Ha=(Yn+Hn)/2)}var Vt=En*a(ci),hr=En*t(ci),rn=Bn*a(Wa),vn=Bn*t(Wa);if(Zn>s){var en=En*a(Ha),Tn=En*t(Ha),xn=Bn*a(ja),un=Bn*t(ja),gr;if(pa<i&&(gr=_(Vt,hr,xn,un,en,Tn,rn,vn))){var mr=Vt-gr[0],zr=hr-gr[1],gn=en-gr[0],On=Tn-gr[1],ta=1/t(v((mr*gn+zr*On)/(c(mr*mr+zr*zr)*c(gn*gn+On*On)))/2),_n=c(gr[0]*gr[0]+gr[1]*gr[1]);ua=r(Zn,(Bn-_n)/(ta-1)),ea=r(Zn,(En-_n)/(ta+1))}}pn>s?ea>s?(Rn=h(xn,un,Vt,hr,En,ea,Ma),Xn=h(en,Tn,rn,vn,En,ea,Ma),_r.moveTo(Rn.cx+Rn.x01,Rn.cy+Rn.y01),ea<Zn?_r.arc(Rn.cx,Rn.cy,ea,e(Rn.y01,Rn.x01),e(Xn.y01,Xn.x01),!Ma):(_r.arc(Rn.cx,Rn.cy,ea,e(Rn.y01,Rn.x01),e(Rn.y11,Rn.x11),!Ma),_r.arc(0,0,En,e(Rn.cy+Rn.y11,Rn.cx+Rn.x11),e(Xn.cy+Xn.y11,Xn.cx+Xn.x11),!Ma),_r.arc(Xn.cx,Xn.cy,ea,e(Xn.y11,Xn.x11),e(Xn.y01,Xn.x01),!Ma))):(_r.moveTo(Vt,hr),_r.arc(0,0,En,ci,Ha,!Ma)):_r.moveTo(Vt,hr),!(Bn>s)||!(Tr>s)?_r.lineTo(rn,vn):ua>s?(Rn=h(rn,vn,en,Tn,Bn,-ua,Ma),Xn=h(Vt,hr,xn,un,Bn,-ua,Ma),_r.lineTo(Rn.cx+Rn.x01,Rn.cy+Rn.y01),ua<Zn?_r.arc(Rn.cx,Rn.cy,ua,e(Rn.y01,Rn.x01),e(Xn.y01,Xn.x01),!Ma):(_r.arc(Rn.cx,Rn.cy,ua,e(Rn.y01,Rn.x01),e(Rn.y11,Rn.x11),!Ma),_r.arc(0,0,Bn,e(Rn.cy+Rn.y11,Rn.cx+Rn.x11),e(Xn.cy+Xn.y11,Xn.cx+Xn.x11),Ma),_r.arc(Xn.cx,Xn.cy,ua,e(Xn.y11,Xn.x11),e(Xn.y01,Xn.x01),!Ma))):_r.arc(0,0,Bn,Wa,ja,Ma)}if(_r.closePath(),wn)return _r=null,wn+""||null}return Gr.centroid=function(){var wn=(+tt.apply(this,arguments)+ +Lt.apply(this,arguments))/2,cn=(+Ir.apply(this,arguments)+ +Br.apply(this,arguments))/2-i/2;return[a(cn)*wn,t(cn)*wn]},Gr.innerRadius=function(wn){return arguments.length?(tt=typeof wn=="function"?wn:S(+wn),Gr):tt},Gr.outerRadius=function(wn){return arguments.length?(Lt=typeof wn=="function"?wn:S(+wn),Gr):Lt},Gr.cornerRadius=function(wn){return arguments.length?(Wt=typeof wn=="function"?wn:S(+wn),Gr):Wt},Gr.padRadius=function(wn){return arguments.length?(ir=wn==null?null:typeof wn=="function"?wn:S(+wn),Gr):ir},Gr.startAngle=function(wn){return arguments.length?(Ir=typeof wn=="function"?wn:S(+wn),Gr):Ir},Gr.endAngle=function(wn){return arguments.length?(Br=typeof wn=="function"?wn:S(+wn),Gr):Br},Gr.padAngle=function(wn){return arguments.length?(Er=typeof wn=="function"?wn:S(+wn),Gr):Er},Gr.context=function(wn){return arguments.length?(_r=wn==null?null:wn,Gr):_r},Gr}function u(tt){this._context=tt}u.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Lt){switch(tt=+tt,Lt=+Lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Lt):this._context.moveTo(tt,Lt);break;case 1:this._point=2;default:this._context.lineTo(tt,Lt);break}}};function L(tt){return new u(tt)}function T(tt){return tt[0]}function k(tt){return tt[1]}function P(){var tt=T,Lt=k,Wt=S(!0),ir=null,Ir=L,Br=null;function Er(_r){var Gr,wn=_r.length,cn,Bn=!1,En;for(ir==null&&(Br=Ir(En=g.path())),Gr=0;Gr<=wn;++Gr)!(Gr<wn&&Wt(cn=_r[Gr],Gr,_r))===Bn&&((Bn=!Bn)?Br.lineStart():Br.lineEnd()),Bn&&Br.point(+tt(cn,Gr,_r),+Lt(cn,Gr,_r));if(En)return Br=null,En+""||null}return Er.x=function(_r){return arguments.length?(tt=typeof _r=="function"?_r:S(+_r),Er):tt},Er.y=function(_r){return arguments.length?(Lt=typeof _r=="function"?_r:S(+_r),Er):Lt},Er.defined=function(_r){return arguments.length?(Wt=typeof _r=="function"?_r:S(!!_r),Er):Wt},Er.curve=function(_r){return arguments.length?(Ir=_r,ir!=null&&(Br=Ir(ir)),Er):Ir},Er.context=function(_r){return arguments.length?(_r==null?ir=Br=null:Br=Ir(ir=_r),Er):ir},Er}function z(){var tt=T,Lt=null,Wt=S(0),ir=k,Ir=S(!0),Br=null,Er=L,_r=null;function Gr(cn){var Bn,En,Yn,Hn=cn.length,pa,Ma=!1,ci,Ha=new Array(Hn),ja=new Array(Hn);for(Br==null&&(_r=Er(ci=g.path())),Bn=0;Bn<=Hn;++Bn){if(!(Bn<Hn&&Ir(pa=cn[Bn],Bn,cn))===Ma)if(Ma=!Ma)En=Bn,_r.areaStart(),_r.lineStart();else{for(_r.lineEnd(),_r.lineStart(),Yn=Bn-1;Yn>=En;--Yn)_r.point(Ha[Yn],ja[Yn]);_r.lineEnd(),_r.areaEnd()}Ma&&(Ha[Bn]=+tt(pa,Bn,cn),ja[Bn]=+Wt(pa,Bn,cn),_r.point(Lt?+Lt(pa,Bn,cn):Ha[Bn],ir?+ir(pa,Bn,cn):ja[Bn]))}if(ci)return _r=null,ci+""||null}function wn(){return P().defined(Ir).curve(Er).context(Br)}return Gr.x=function(cn){return arguments.length?(tt=typeof cn=="function"?cn:S(+cn),Lt=null,Gr):tt},Gr.x0=function(cn){return arguments.length?(tt=typeof cn=="function"?cn:S(+cn),Gr):tt},Gr.x1=function(cn){return arguments.length?(Lt=cn==null?null:typeof cn=="function"?cn:S(+cn),Gr):Lt},Gr.y=function(cn){return arguments.length?(Wt=typeof cn=="function"?cn:S(+cn),ir=null,Gr):Wt},Gr.y0=function(cn){return arguments.length?(Wt=typeof cn=="function"?cn:S(+cn),Gr):Wt},Gr.y1=function(cn){return arguments.length?(ir=cn==null?null:typeof cn=="function"?cn:S(+cn),Gr):ir},Gr.lineX0=Gr.lineY0=function(){return wn().x(tt).y(Wt)},Gr.lineY1=function(){return wn().x(tt).y(ir)},Gr.lineX1=function(){return wn().x(Lt).y(Wt)},Gr.defined=function(cn){return arguments.length?(Ir=typeof cn=="function"?cn:S(!!cn),Gr):Ir},Gr.curve=function(cn){return arguments.length?(Er=cn,Br!=null&&(_r=Er(Br)),Gr):Er},Gr.context=function(cn){return arguments.length?(cn==null?Br=_r=null:_r=Er(Br=cn),Gr):Br},Gr}function I(tt,Lt){return Lt<tt?-1:Lt>tt?1:Lt>=tt?0:NaN}function D(tt){return tt}function R(){var tt=D,Lt=I,Wt=null,ir=S(0),Ir=S(p),Br=S(0);function Er(_r){var Gr,wn=_r.length,cn,Bn,En=0,Yn=new Array(wn),Hn=new Array(wn),pa=+ir.apply(this,arguments),Ma=Math.min(p,Math.max(-p,Ir.apply(this,arguments)-pa)),ci,Ha=Math.min(Math.abs(Ma)/wn,Br.apply(this,arguments)),ja=Ha*(Ma<0?-1:1),Wa;for(Gr=0;Gr<wn;++Gr)(Wa=Hn[Yn[Gr]=Gr]=+tt(_r[Gr],Gr,_r))>0&&(En+=Wa);for(Lt!=null?Yn.sort(function(Tr,pn){return Lt(Hn[Tr],Hn[pn])}):Wt!=null&&Yn.sort(function(Tr,pn){return Wt(_r[Tr],_r[pn])}),Gr=0,Bn=En?(Ma-wn*ja)/En:0;Gr<wn;++Gr,pa=ci)cn=Yn[Gr],Wa=Hn[cn],ci=pa+(Wa>0?Wa*Bn:0)+ja,Hn[cn]={data:_r[cn],index:Gr,value:Wa,startAngle:pa,endAngle:ci,padAngle:Ha};return Hn}return Er.value=function(_r){return arguments.length?(tt=typeof _r=="function"?_r:S(+_r),Er):tt},Er.sortValues=function(_r){return arguments.length?(Lt=_r,Wt=null,Er):Lt},Er.sort=function(_r){return arguments.length?(Wt=_r,Lt=null,Er):Wt},Er.startAngle=function(_r){return arguments.length?(ir=typeof _r=="function"?_r:S(+_r),Er):ir},Er.endAngle=function(_r){return arguments.length?(Ir=typeof _r=="function"?_r:S(+_r),Er):Ir},Er.padAngle=function(_r){return arguments.length?(Br=typeof _r=="function"?_r:S(+_r),Er):Br},Er}var O=N(L);function F(tt){this._curve=tt}F.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(tt,Lt){this._curve.point(Lt*Math.sin(tt),Lt*-Math.cos(tt))}};function N(tt){function Lt(Wt){return new F(tt(Wt))}return Lt._curve=tt,Lt}function G(tt){var Lt=tt.curve;return tt.angle=tt.x,delete tt.x,tt.radius=tt.y,delete tt.y,tt.curve=function(Wt){return arguments.length?Lt(N(Wt)):Lt()._curve},tt}function K(){return G(P().curve(O))}function W(){var tt=z().curve(O),Lt=tt.curve,Wt=tt.lineX0,ir=tt.lineX1,Ir=tt.lineY0,Br=tt.lineY1;return tt.angle=tt.x,delete tt.x,tt.startAngle=tt.x0,delete tt.x0,tt.endAngle=tt.x1,delete tt.x1,tt.radius=tt.y,delete tt.y,tt.innerRadius=tt.y0,delete tt.y0,tt.outerRadius=tt.y1,delete tt.y1,tt.lineStartAngle=function(){return G(Wt())},delete tt.lineX0,tt.lineEndAngle=function(){return G(ir())},delete tt.lineX1,tt.lineInnerRadius=function(){return G(Ir())},delete tt.lineY0,tt.lineOuterRadius=function(){return G(Br())},delete tt.lineY1,tt.curve=function(Er){return arguments.length?Lt(N(Er)):Lt()._curve},tt}function Y(tt,Lt){return[(Lt=+Lt)*Math.cos(tt-=Math.PI/2),Lt*Math.sin(tt)]}var re=Array.prototype.slice;function ue(tt){return tt.source}function j(tt){return tt.target}function q(tt){var Lt=ue,Wt=j,ir=T,Ir=k,Br=null;function Er(){var _r,Gr=re.call(arguments),wn=Lt.apply(this,Gr),cn=Wt.apply(this,Gr);if(Br||(Br=_r=g.path()),tt(Br,+ir.apply(this,(Gr[0]=wn,Gr)),+Ir.apply(this,Gr),+ir.apply(this,(Gr[0]=cn,Gr)),+Ir.apply(this,Gr)),_r)return Br=null,_r+""||null}return Er.source=function(_r){return arguments.length?(Lt=_r,Er):Lt},Er.target=function(_r){return arguments.length?(Wt=_r,Er):Wt},Er.x=function(_r){return arguments.length?(ir=typeof _r=="function"?_r:S(+_r),Er):ir},Er.y=function(_r){return arguments.length?(Ir=typeof _r=="function"?_r:S(+_r),Er):Ir},Er.context=function(_r){return arguments.length?(Br=_r==null?null:_r,Er):Br},Er}function V(tt,Lt,Wt,ir,Ir){tt.moveTo(Lt,Wt),tt.bezierCurveTo(Lt=(Lt+ir)/2,Wt,Lt,Ir,ir,Ir)}function U(tt,Lt,Wt,ir,Ir){tt.moveTo(Lt,Wt),tt.bezierCurveTo(Lt,Wt=(Wt+Ir)/2,ir,Wt,ir,Ir)}function $(tt,Lt,Wt,ir,Ir){var Br=Y(Lt,Wt),Er=Y(Lt,Wt=(Wt+Ir)/2),_r=Y(ir,Wt),Gr=Y(ir,Ir);tt.moveTo(Br[0],Br[1]),tt.bezierCurveTo(Er[0],Er[1],_r[0],_r[1],Gr[0],Gr[1])}function ne(){return q(V)}function X(){return q(U)}function Q(){var tt=q($);return tt.angle=tt.x,delete tt.x,tt.radius=tt.y,delete tt.y,tt}var ie={draw:function(tt,Lt){var Wt=Math.sqrt(Lt/i);tt.moveTo(Wt,0),tt.arc(0,0,Wt,0,p)}},se={draw:function(tt,Lt){var Wt=Math.sqrt(Lt/5)/2;tt.moveTo(-3*Wt,-Wt),tt.lineTo(-Wt,-Wt),tt.lineTo(-Wt,-3*Wt),tt.lineTo(Wt,-3*Wt),tt.lineTo(Wt,-Wt),tt.lineTo(3*Wt,-Wt),tt.lineTo(3*Wt,Wt),tt.lineTo(Wt,Wt),tt.lineTo(Wt,3*Wt),tt.lineTo(-Wt,3*Wt),tt.lineTo(-Wt,Wt),tt.lineTo(-3*Wt,Wt),tt.closePath()}},ae=Math.sqrt(1/3),oe=ae*2,be={draw:function(tt,Lt){var Wt=Math.sqrt(Lt/oe),ir=Wt*ae;tt.moveTo(0,-Wt),tt.lineTo(ir,0),tt.lineTo(0,Wt),tt.lineTo(-ir,0),tt.closePath()}},ce=.8908130915292852,de=Math.sin(i/10)/Math.sin(7*i/10),ye=Math.sin(p/10)*de,ge=-Math.cos(p/10)*de,me={draw:function(tt,Lt){var Wt=Math.sqrt(Lt*ce),ir=ye*Wt,Ir=ge*Wt;tt.moveTo(0,-Wt),tt.lineTo(ir,Ir);for(var Br=1;Br<5;++Br){var Er=p*Br/5,_r=Math.cos(Er),Gr=Math.sin(Er);tt.lineTo(Gr*Wt,-_r*Wt),tt.lineTo(_r*ir-Gr*Ir,Gr*ir+_r*Ir)}tt.closePath()}},Ee={draw:function(tt,Lt){var Wt=Math.sqrt(Lt),ir=-Wt/2;tt.rect(ir,ir,Wt,Wt)}},Pe=Math.sqrt(3),Ne={draw:function(tt,Lt){var Wt=-Math.sqrt(Lt/(Pe*3));tt.moveTo(0,Wt*2),tt.lineTo(-Pe*Wt,-Wt),tt.lineTo(Pe*Wt,-Wt),tt.closePath()}},we=-.5,ke=Math.sqrt(3)/2,Xe=1/Math.sqrt(12),He=(Xe/2+1)*3,Ie={draw:function(tt,Lt){var Wt=Math.sqrt(Lt/He),ir=Wt/2,Ir=Wt*Xe,Br=ir,Er=Wt*Xe+Wt,_r=-Br,Gr=Er;tt.moveTo(ir,Ir),tt.lineTo(Br,Er),tt.lineTo(_r,Gr),tt.lineTo(we*ir-ke*Ir,ke*ir+we*Ir),tt.lineTo(we*Br-ke*Er,ke*Br+we*Er),tt.lineTo(we*_r-ke*Gr,ke*_r+we*Gr),tt.lineTo(we*ir+ke*Ir,we*Ir-ke*ir),tt.lineTo(we*Br+ke*Er,we*Er-ke*Br),tt.lineTo(we*_r+ke*Gr,we*Gr-ke*_r),tt.closePath()}},De=[ie,se,be,Ee,me,Ne,Ie];function Ge(){var tt=S(ie),Lt=S(64),Wt=null;function ir(){var Ir;if(Wt||(Wt=Ir=g.path()),tt.apply(this,arguments).draw(Wt,+Lt.apply(this,arguments)),Ir)return Wt=null,Ir+""||null}return ir.type=function(Ir){return arguments.length?(tt=typeof Ir=="function"?Ir:S(Ir),ir):tt},ir.size=function(Ir){return arguments.length?(Lt=typeof Ir=="function"?Ir:S(+Ir),ir):Lt},ir.context=function(Ir){return arguments.length?(Wt=Ir==null?null:Ir,ir):Wt},ir}function ht(){}function Rt(tt,Lt,Wt){tt._context.bezierCurveTo((2*tt._x0+tt._x1)/3,(2*tt._y0+tt._y1)/3,(tt._x0+2*tt._x1)/3,(tt._y0+2*tt._y1)/3,(tt._x0+4*tt._x1+Lt)/6,(tt._y0+4*tt._y1+Wt)/6)}function Kt(tt){this._context=tt}Kt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Rt(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Lt){switch(tt=+tt,Lt=+Lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Lt):this._context.moveTo(tt,Lt);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Rt(this,tt,Lt);break}this._x0=this._x1,this._x1=tt,this._y0=this._y1,this._y1=Lt}};function It(tt){return new Kt(tt)}function Mt(tt){this._context=tt}Mt.prototype={areaStart:ht,areaEnd:ht,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(tt,Lt){switch(tt=+tt,Lt=+Lt,this._point){case 0:this._point=1,this._x2=tt,this._y2=Lt;break;case 1:this._point=2,this._x3=tt,this._y3=Lt;break;case 2:this._point=3,this._x4=tt,this._y4=Lt,this._context.moveTo((this._x0+4*this._x1+tt)/6,(this._y0+4*this._y1+Lt)/6);break;default:Rt(this,tt,Lt);break}this._x0=this._x1,this._x1=tt,this._y0=this._y1,this._y1=Lt}};function Yt(tt){return new Mt(tt)}function zt(tt){this._context=tt}zt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Lt){switch(tt=+tt,Lt=+Lt,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var Wt=(this._x0+4*this._x1+tt)/6,ir=(this._y0+4*this._y1+Lt)/6;this._line?this._context.lineTo(Wt,ir):this._context.moveTo(Wt,ir);break;case 3:this._point=4;default:Rt(this,tt,Lt);break}this._x0=this._x1,this._x1=tt,this._y0=this._y1,this._y1=Lt}};function St(tt){return new zt(tt)}function Ye(tt,Lt){this._basis=new Kt(tt),this._beta=Lt}Ye.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var tt=this._x,Lt=this._y,Wt=tt.length-1;if(Wt>0)for(var ir=tt[0],Ir=Lt[0],Br=tt[Wt]-ir,Er=Lt[Wt]-Ir,_r=-1,Gr;++_r<=Wt;)Gr=_r/Wt,this._basis.point(this._beta*tt[_r]+(1-this._beta)*(ir+Gr*Br),this._beta*Lt[_r]+(1-this._beta)*(Ir+Gr*Er));this._x=this._y=null,this._basis.lineEnd()},point:function(tt,Lt){this._x.push(+tt),this._y.push(+Lt)}};var rt=function tt(Lt){function Wt(ir){return Lt===1?new Kt(ir):new Ye(ir,Lt)}return Wt.beta=function(ir){return tt(+ir)},Wt}(.85);function Ve(tt,Lt,Wt){tt._context.bezierCurveTo(tt._x1+tt._k*(tt._x2-tt._x0),tt._y1+tt._k*(tt._y2-tt._y0),tt._x2+tt._k*(tt._x1-Lt),tt._y2+tt._k*(tt._y1-Wt),tt._x2,tt._y2)}function Ae(tt,Lt){this._context=tt,this._k=(1-Lt)/6}Ae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ve(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Lt){switch(tt=+tt,Lt=+Lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Lt):this._context.moveTo(tt,Lt);break;case 1:this._point=2,this._x1=tt,this._y1=Lt;break;case 2:this._point=3;default:Ve(this,tt,Lt);break}this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var Ue=function tt(Lt){function Wt(ir){return new Ae(ir,Lt)}return Wt.tension=function(ir){return tt(+ir)},Wt}(0);function Ze(tt,Lt){this._context=tt,this._k=(1-Lt)/6}Ze.prototype={areaStart:ht,areaEnd:ht,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(tt,Lt){switch(tt=+tt,Lt=+Lt,this._point){case 0:this._point=1,this._x3=tt,this._y3=Lt;break;case 1:this._point=2,this._context.moveTo(this._x4=tt,this._y4=Lt);break;case 2:this._point=3,this._x5=tt,this._y5=Lt;break;default:Ve(this,tt,Lt);break}this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var Qe=function tt(Lt){function Wt(ir){return new Ze(ir,Lt)}return Wt.tension=function(ir){return tt(+ir)},Wt}(0);function _t(tt,Lt){this._context=tt,this._k=(1-Lt)/6}_t.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Lt){switch(tt=+tt,Lt=+Lt,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ve(this,tt,Lt);break}this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var gt=function tt(Lt){function Wt(ir){return new _t(ir,Lt)}return Wt.tension=function(ir){return tt(+ir)},Wt}(0);function wt(tt,Lt,Wt){var ir=tt._x1,Ir=tt._y1,Br=tt._x2,Er=tt._y2;if(tt._l01_a>s){var _r=2*tt._l01_2a+3*tt._l01_a*tt._l12_a+tt._l12_2a,Gr=3*tt._l01_a*(tt._l01_a+tt._l12_a);ir=(ir*_r-tt._x0*tt._l12_2a+tt._x2*tt._l01_2a)/Gr,Ir=(Ir*_r-tt._y0*tt._l12_2a+tt._y2*tt._l01_2a)/Gr}if(tt._l23_a>s){var wn=2*tt._l23_2a+3*tt._l23_a*tt._l12_a+tt._l12_2a,cn=3*tt._l23_a*(tt._l23_a+tt._l12_a);Br=(Br*wn+tt._x1*tt._l23_2a-Lt*tt._l12_2a)/cn,Er=(Er*wn+tt._y1*tt._l23_2a-Wt*tt._l12_2a)/cn}tt._context.bezierCurveTo(ir,Ir,Br,Er,tt._x2,tt._y2)}function Ut(tt,Lt){this._context=tt,this._alpha=Lt}Ut.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Lt){if(tt=+tt,Lt=+Lt,this._point){var Wt=this._x2-tt,ir=this._y2-Lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Wt*Wt+ir*ir,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Lt):this._context.moveTo(tt,Lt);break;case 1:this._point=2;break;case 2:this._point=3;default:wt(this,tt,Lt);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var Dt=function tt(Lt){function Wt(ir){return Lt?new Ut(ir,Lt):new Ae(ir,0)}return Wt.alpha=function(ir){return tt(+ir)},Wt}(.5);function Nt(tt,Lt){this._context=tt,this._alpha=Lt}Nt.prototype={areaStart:ht,areaEnd:ht,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(tt,Lt){if(tt=+tt,Lt=+Lt,this._point){var Wt=this._x2-tt,ir=this._y2-Lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Wt*Wt+ir*ir,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=tt,this._y3=Lt;break;case 1:this._point=2,this._context.moveTo(this._x4=tt,this._y4=Lt);break;case 2:this._point=3,this._x5=tt,this._y5=Lt;break;default:wt(this,tt,Lt);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var Xt=function tt(Lt){function Wt(ir){return Lt?new Nt(ir,Lt):new Ze(ir,0)}return Wt.alpha=function(ir){return tt(+ir)},Wt}(.5);function Ht(tt,Lt){this._context=tt,this._alpha=Lt}Ht.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Lt){if(tt=+tt,Lt=+Lt,this._point){var Wt=this._x2-tt,ir=this._y2-Lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Wt*Wt+ir*ir,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:wt(this,tt,Lt);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var ar=function tt(Lt){function Wt(ir){return Lt?new Ht(ir,Lt):new _t(ir,0)}return Wt.alpha=function(ir){return tt(+ir)},Wt}(.5);function Vr(tt){this._context=tt}Vr.prototype={areaStart:ht,areaEnd:ht,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(tt,Lt){tt=+tt,Lt=+Lt,this._point?this._context.lineTo(tt,Lt):(this._point=1,this._context.moveTo(tt,Lt))}};function nn(tt){return new Vr(tt)}function jr(tt){return tt<0?-1:1}function at(tt,Lt,Wt){var ir=tt._x1-tt._x0,Ir=Lt-tt._x1,Br=(tt._y1-tt._y0)/(ir||Ir<0&&-0),Er=(Wt-tt._y1)/(Ir||ir<0&&-0),_r=(Br*Ir+Er*ir)/(ir+Ir);return(jr(Br)+jr(Er))*Math.min(Math.abs(Br),Math.abs(Er),.5*Math.abs(_r))||0}function $t(tt,Lt){var Wt=tt._x1-tt._x0;return Wt?(3*(tt._y1-tt._y0)/Wt-Lt)/2:Lt}function Zt(tt,Lt,Wt){var ir=tt._x0,Ir=tt._y0,Br=tt._x1,Er=tt._y1,_r=(Br-ir)/3;tt._context.bezierCurveTo(ir+_r,Ir+_r*Lt,Br-_r,Er-_r*Wt,Br,Er)}function ur(tt){this._context=tt}ur.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Zt(this,this._t0,$t(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Lt){var Wt=NaN;if(tt=+tt,Lt=+Lt,!(tt===this._x1&&Lt===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Lt):this._context.moveTo(tt,Lt);break;case 1:this._point=2;break;case 2:this._point=3,Zt(this,$t(this,Wt=at(this,tt,Lt)),Wt);break;default:Zt(this,this._t0,Wt=at(this,tt,Lt));break}this._x0=this._x1,this._x1=tt,this._y0=this._y1,this._y1=Lt,this._t0=Wt}}};function wr(tt){this._context=new $e(tt)}(wr.prototype=Object.create(ur.prototype)).point=function(tt,Lt){ur.prototype.point.call(this,Lt,tt)};function $e(tt){this._context=tt}$e.prototype={moveTo:function(tt,Lt){this._context.moveTo(Lt,tt)},closePath:function(){this._context.closePath()},lineTo:function(tt,Lt){this._context.lineTo(Lt,tt)},bezierCurveTo:function(tt,Lt,Wt,ir,Ir,Br){this._context.bezierCurveTo(Lt,tt,ir,Wt,Br,Ir)}};function Je(tt){return new ur(tt)}function it(tt){return new wr(tt)}function lt(tt){this._context=tt}lt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var tt=this._x,Lt=this._y,Wt=tt.length;if(Wt)if(this._line?this._context.lineTo(tt[0],Lt[0]):this._context.moveTo(tt[0],Lt[0]),Wt===2)this._context.lineTo(tt[1],Lt[1]);else for(var ir=Tt(tt),Ir=Tt(Lt),Br=0,Er=1;Er<Wt;++Br,++Er)this._context.bezierCurveTo(ir[0][Br],Ir[0][Br],ir[1][Br],Ir[1][Br],tt[Er],Lt[Er]);(this._line||this._line!==0&&Wt===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(tt,Lt){this._x.push(+tt),this._y.push(+Lt)}};function Tt(tt){var Lt,Wt=tt.length-1,ir,Ir=new Array(Wt),Br=new Array(Wt),Er=new Array(Wt);for(Ir[0]=0,Br[0]=2,Er[0]=tt[0]+2*tt[1],Lt=1;Lt<Wt-1;++Lt)Ir[Lt]=1,Br[Lt]=4,Er[Lt]=4*tt[Lt]+2*tt[Lt+1];for(Ir[Wt-1]=2,Br[Wt-1]=7,Er[Wt-1]=8*tt[Wt-1]+tt[Wt],Lt=1;Lt<Wt;++Lt)ir=Ir[Lt]/Br[Lt-1],Br[Lt]-=ir,Er[Lt]-=ir*Er[Lt-1];for(Ir[Wt-1]=Er[Wt-1]/Br[Wt-1],Lt=Wt-2;Lt>=0;--Lt)Ir[Lt]=(Er[Lt]-Ir[Lt+1])/Br[Lt];for(Br[Wt-1]=(tt[Wt]+Ir[Wt-1])/2,Lt=0;Lt<Wt-1;++Lt)Br[Lt]=2*tt[Lt+1]-Ir[Lt+1];return[Ir,Br]}function Bt(tt){return new lt(tt)}function Ce(tt,Lt){this._context=tt,this._t=Lt}Ce.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(tt,Lt){switch(tt=+tt,Lt=+Lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Lt):this._context.moveTo(tt,Lt);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,Lt),this._context.lineTo(tt,Lt);else{var Wt=this._x*(1-this._t)+tt*this._t;this._context.lineTo(Wt,this._y),this._context.lineTo(Wt,Lt)}break}}this._x=tt,this._y=Lt}};function Me(tt){return new Ce(tt,.5)}function nt(tt){return new Ce(tt,0)}function st(tt){return new Ce(tt,1)}function ct(tt,Lt){if((Er=tt.length)>1)for(var Wt=1,ir,Ir,Br=tt[Lt[0]],Er,_r=Br.length;Wt<Er;++Wt)for(Ir=Br,Br=tt[Lt[Wt]],ir=0;ir<_r;++ir)Br[ir][1]+=Br[ir][0]=isNaN(Ir[ir][1])?Ir[ir][0]:Ir[ir][1]}function At(tt){for(var Lt=tt.length,Wt=new Array(Lt);--Lt>=0;)Wt[Lt]=Lt;return Wt}function dt(tt,Lt){return tt[Lt]}function Ct(){var tt=S([]),Lt=At,Wt=ct,ir=dt;function Ir(Br){var Er=tt.apply(this,arguments),_r,Gr=Br.length,wn=Er.length,cn=new Array(wn),Bn;for(_r=0;_r<wn;++_r){for(var En=Er[_r],Yn=cn[_r]=new Array(Gr),Hn=0,pa;Hn<Gr;++Hn)Yn[Hn]=pa=[0,+ir(Br[Hn],En,Hn,Br)],pa.data=Br[Hn];Yn.key=En}for(_r=0,Bn=Lt(cn);_r<wn;++_r)cn[Bn[_r]].index=_r;return Wt(cn,Bn),cn}return Ir.keys=function(Br){return arguments.length?(tt=typeof Br=="function"?Br:S(re.call(Br)),Ir):tt},Ir.value=function(Br){return arguments.length?(ir=typeof Br=="function"?Br:S(+Br),Ir):ir},Ir.order=function(Br){return arguments.length?(Lt=Br==null?At:typeof Br=="function"?Br:S(re.call(Br)),Ir):Lt},Ir.offset=function(Br){return arguments.length?(Wt=Br==null?ct:Br,Ir):Wt},Ir}function Gt(tt,Lt){if((ir=tt.length)>0){for(var Wt,ir,Ir=0,Br=tt[0].length,Er;Ir<Br;++Ir){for(Er=Wt=0;Wt<ir;++Wt)Er+=tt[Wt][Ir][1]||0;if(Er)for(Wt=0;Wt<ir;++Wt)tt[Wt][Ir][1]/=Er}ct(tt,Lt)}}function rr(tt,Lt){if((Gr=tt.length)>0)for(var Wt,ir=0,Ir,Br,Er,_r,Gr,wn=tt[Lt[0]].length;ir<wn;++ir)for(Er=_r=0,Wt=0;Wt<Gr;++Wt)(Br=(Ir=tt[Lt[Wt]][ir])[1]-Ir[0])>0?(Ir[0]=Er,Ir[1]=Er+=Br):Br<0?(Ir[1]=_r,Ir[0]=_r+=Br):(Ir[0]=0,Ir[1]=Br)}function kr(tt,Lt){if((Ir=tt.length)>0){for(var Wt=0,ir=tt[Lt[0]],Ir,Br=ir.length;Wt<Br;++Wt){for(var Er=0,_r=0;Er<Ir;++Er)_r+=tt[Er][Wt][1]||0;ir[Wt][1]+=ir[Wt][0]=-_r/2}ct(tt,Lt)}}function br(tt,Lt){if(!(!((Er=tt.length)>0)||!((Br=(Ir=tt[Lt[0]]).length)>0))){for(var Wt=0,ir=1,Ir,Br,Er;ir<Br;++ir){for(var _r=0,Gr=0,wn=0;_r<Er;++_r){for(var cn=tt[Lt[_r]],Bn=cn[ir][1]||0,En=cn[ir-1][1]||0,Yn=(Bn-En)/2,Hn=0;Hn<_r;++Hn){var pa=tt[Lt[Hn]],Ma=pa[ir][1]||0,ci=pa[ir-1][1]||0;Yn+=Ma-ci}Gr+=Bn,wn+=Yn*Bn}Ir[ir-1][1]+=Ir[ir-1][0]=Wt,Gr&&(Wt-=wn/Gr)}Ir[ir-1][1]+=Ir[ir-1][0]=Wt,ct(tt,Lt)}}function Ar(tt){var Lt=tt.map(Wr);return At(tt).sort(function(Wt,ir){return Lt[Wt]-Lt[ir]})}function Wr(tt){for(var Lt=-1,Wt=0,ir=tt.length,Ir,Br=-1/0;++Lt<ir;)(Ir=+tt[Lt][1])>Br&&(Br=Ir,Wt=Lt);return Wt}function nr(tt){var Lt=tt.map(yr);return At(tt).sort(function(Wt,ir){return Lt[Wt]-Lt[ir]})}function yr(tt){for(var Lt=0,Wt=-1,ir=tt.length,Ir;++Wt<ir;)(Ir=+tt[Wt][1])&&(Lt+=Ir);return Lt}function Pr(tt){return nr(tt).reverse()}function Or(tt){var Lt=tt.length,Wt,ir,Ir=tt.map(yr),Br=Ar(tt),Er=0,_r=0,Gr=[],wn=[];for(Wt=0;Wt<Lt;++Wt)ir=Br[Wt],Er<_r?(Er+=Ir[ir],Gr.push(ir)):(_r+=Ir[ir],wn.push(ir));return wn.reverse().concat(Gr)}function Sr(tt){return At(tt).reverse()}A.arc=b,A.area=z,A.areaRadial=W,A.curveBasis=It,A.curveBasisClosed=Yt,A.curveBasisOpen=St,A.curveBundle=rt,A.curveCardinal=Ue,A.curveCardinalClosed=Qe,A.curveCardinalOpen=gt,A.curveCatmullRom=Dt,A.curveCatmullRomClosed=Xt,A.curveCatmullRomOpen=ar,A.curveLinear=L,A.curveLinearClosed=nn,A.curveMonotoneX=Je,A.curveMonotoneY=it,A.curveNatural=Bt,A.curveStep=Me,A.curveStepAfter=st,A.curveStepBefore=nt,A.line=P,A.lineRadial=K,A.linkHorizontal=ne,A.linkRadial=Q,A.linkVertical=X,A.pie=R,A.pointRadial=Y,A.radialArea=W,A.radialLine=K,A.stack=Ct,A.stackOffsetDiverging=rr,A.stackOffsetExpand=Gt,A.stackOffsetNone=ct,A.stackOffsetSilhouette=kr,A.stackOffsetWiggle=br,A.stackOrderAppearance=Ar,A.stackOrderAscending=nr,A.stackOrderDescending=Pr,A.stackOrderInsideOut=Or,A.stackOrderNone=At,A.stackOrderReverse=Sr,A.symbol=Ge,A.symbolCircle=ie,A.symbolCross=se,A.symbolDiamond=be,A.symbolSquare=Ee,A.symbolStar=me,A.symbolTriangle=Ne,A.symbolWye=Ie,A.symbols=De,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-path":117}],120:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,d("d3-time")):(A=A||self,g(A.d3=A.d3||{},A.d3))})(this,function(A,g){function S(Ye){if(0<=Ye.y&&Ye.y<100){var rt=new Date(-1,Ye.m,Ye.d,Ye.H,Ye.M,Ye.S,Ye.L);return rt.setFullYear(Ye.y),rt}return new Date(Ye.y,Ye.m,Ye.d,Ye.H,Ye.M,Ye.S,Ye.L)}function M(Ye){if(0<=Ye.y&&Ye.y<100){var rt=new Date(Date.UTC(-1,Ye.m,Ye.d,Ye.H,Ye.M,Ye.S,Ye.L));return rt.setUTCFullYear(Ye.y),rt}return new Date(Date.UTC(Ye.y,Ye.m,Ye.d,Ye.H,Ye.M,Ye.S,Ye.L))}function e(Ye,rt,Ve){return{y:Ye,m:rt,d:Ve,H:0,M:0,S:0,L:0}}function a(Ye){var rt=Ye.dateTime,Ve=Ye.date,Ae=Ye.time,Ue=Ye.periods,Ze=Ye.days,Qe=Ye.shortDays,_t=Ye.months,gt=Ye.shortMonths,wt=x(Ue),Ut=p(Ue),Dt=x(Ze),Nt=p(Ze),Xt=x(Qe),Ht=p(Qe),ar=x(_t),Vr=p(_t),nn=x(gt),jr=p(gt),at={a:st,A:ct,b:At,B:dt,c:null,d:F,e:F,f:Y,H:N,I:G,j:K,L:W,m:re,M:ue,p:Ct,q:Gt,Q:Ge,s:ht,S:j,u:q,U:V,V:U,w:$,W:ne,x:null,X:null,y:X,Y:Q,Z:ie,"%":De},$t={a:rr,A:kr,b:br,B:Ar,c:null,d:se,e:se,f:de,H:ae,I:oe,j:be,L:ce,m:ye,M:ge,p:Wr,q:nr,Q:Ge,s:ht,S:me,u:Ee,U:Pe,V:Ne,w:we,W:ke,x:null,X:null,y:Xe,Y:He,Z:Ie,"%":De},Zt={a:it,A:lt,b:Tt,B:Bt,c:Ce,d:u,e:u,f:I,H:T,I:T,j:L,L:z,m:b,M:k,p:Je,q:h,Q:R,s:O,S:P,u:f,U:y,V:o,w:v,W:m,x:Me,X:nt,y:w,Y:l,Z:_,"%":D};at.x=ur(Ve,at),at.X=ur(Ae,at),at.c=ur(rt,at),$t.x=ur(Ve,$t),$t.X=ur(Ae,$t),$t.c=ur(rt,$t);function ur(yr,Pr){return function(Or){var Sr=[],tt=-1,Lt=0,Wt=yr.length,ir,Ir,Br;for(Or instanceof Date||(Or=new Date(+Or));++tt<Wt;)yr.charCodeAt(tt)===37&&(Sr.push(yr.slice(Lt,tt)),(Ir=n[ir=yr.charAt(++tt)])!=null?ir=yr.charAt(++tt):Ir=ir==="e"?" ":"0",(Br=Pr[ir])&&(ir=Br(Or,Ir)),Sr.push(ir),Lt=tt+1);return Sr.push(yr.slice(Lt,tt)),Sr.join("")}}function wr(yr,Pr){return function(Or){var Sr=e(1900,void 0,1),tt=$e(Sr,yr,Or+="",0),Lt,Wt;if(tt!=Or.length)return null;if("Q"in Sr)return new Date(Sr.Q);if("s"in Sr)return new Date(Sr.s*1e3+("L"in Sr?Sr.L:0));if(Pr&&!("Z"in Sr)&&(Sr.Z=0),"p"in Sr&&(Sr.H=Sr.H%12+Sr.p*12),Sr.m===void 0&&(Sr.m="q"in Sr?Sr.q:0),"V"in Sr){if(Sr.V<1||Sr.V>53)return null;"w"in Sr||(Sr.w=1),"Z"in Sr?(Lt=M(e(Sr.y,0,1)),Wt=Lt.getUTCDay(),Lt=Wt>4||Wt===0?g.utcMonday.ceil(Lt):g.utcMonday(Lt),Lt=g.utcDay.offset(Lt,(Sr.V-1)*7),Sr.y=Lt.getUTCFullYear(),Sr.m=Lt.getUTCMonth(),Sr.d=Lt.getUTCDate()+(Sr.w+6)%7):(Lt=S(e(Sr.y,0,1)),Wt=Lt.getDay(),Lt=Wt>4||Wt===0?g.timeMonday.ceil(Lt):g.timeMonday(Lt),Lt=g.timeDay.offset(Lt,(Sr.V-1)*7),Sr.y=Lt.getFullYear(),Sr.m=Lt.getMonth(),Sr.d=Lt.getDate()+(Sr.w+6)%7)}else("W"in Sr||"U"in Sr)&&("w"in Sr||(Sr.w="u"in Sr?Sr.u%7:"W"in Sr?1:0),Wt="Z"in Sr?M(e(Sr.y,0,1)).getUTCDay():S(e(Sr.y,0,1)).getDay(),Sr.m=0,Sr.d="W"in Sr?(Sr.w+6)%7+Sr.W*7-(Wt+5)%7:Sr.w+Sr.U*7-(Wt+6)%7);return"Z"in Sr?(Sr.H+=Sr.Z/100|0,Sr.M+=Sr.Z%100,M(Sr)):S(Sr)}}function $e(yr,Pr,Or,Sr){for(var tt=0,Lt=Pr.length,Wt=Or.length,ir,Ir;tt<Lt;){if(Sr>=Wt)return-1;if(ir=Pr.charCodeAt(tt++),ir===37){if(ir=Pr.charAt(tt++),Ir=Zt[ir in n?Pr.charAt(tt++):ir],!Ir||(Sr=Ir(yr,Or,Sr))<0)return-1}else if(ir!=Or.charCodeAt(Sr++))return-1}return Sr}function Je(yr,Pr,Or){var Sr=wt.exec(Pr.slice(Or));return Sr?(yr.p=Ut[Sr[0].toLowerCase()],Or+Sr[0].length):-1}function it(yr,Pr,Or){var Sr=Xt.exec(Pr.slice(Or));return Sr?(yr.w=Ht[Sr[0].toLowerCase()],Or+Sr[0].length):-1}function lt(yr,Pr,Or){var Sr=Dt.exec(Pr.slice(Or));return Sr?(yr.w=Nt[Sr[0].toLowerCase()],Or+Sr[0].length):-1}function Tt(yr,Pr,Or){var Sr=nn.exec(Pr.slice(Or));return Sr?(yr.m=jr[Sr[0].toLowerCase()],Or+Sr[0].length):-1}function Bt(yr,Pr,Or){var Sr=ar.exec(Pr.slice(Or));return Sr?(yr.m=Vr[Sr[0].toLowerCase()],Or+Sr[0].length):-1}function Ce(yr,Pr,Or){return $e(yr,rt,Pr,Or)}function Me(yr,Pr,Or){return $e(yr,Ve,Pr,Or)}function nt(yr,Pr,Or){return $e(yr,Ae,Pr,Or)}function st(yr){return Qe[yr.getDay()]}function ct(yr){return Ze[yr.getDay()]}function At(yr){return gt[yr.getMonth()]}function dt(yr){return _t[yr.getMonth()]}function Ct(yr){return Ue[+(yr.getHours()>=12)]}function Gt(yr){return 1+~~(yr.getMonth()/3)}function rr(yr){return Qe[yr.getUTCDay()]}function kr(yr){return Ze[yr.getUTCDay()]}function br(yr){return gt[yr.getUTCMonth()]}function Ar(yr){return _t[yr.getUTCMonth()]}function Wr(yr){return Ue[+(yr.getUTCHours()>=12)]}function nr(yr){return 1+~~(yr.getUTCMonth()/3)}return{format:function(yr){var Pr=ur(yr+="",at);return Pr.toString=function(){return yr},Pr},parse:function(yr){var Pr=wr(yr+="",!1);return Pr.toString=function(){return yr},Pr},utcFormat:function(yr){var Pr=ur(yr+="",$t);return Pr.toString=function(){return yr},Pr},utcParse:function(yr){var Pr=wr(yr+="",!0);return Pr.toString=function(){return yr},Pr}}}var n={"-":"",_:" ",0:"0"},r=/^\s*\d+/,t=/^%/,c=/[\\^$*+?|[\]().{}]/g;function s(Ye,rt,Ve){var Ae=Ye<0?"-":"",Ue=(Ae?-Ye:Ye)+"",Ze=Ue.length;return Ae+(Ze<Ve?new Array(Ve-Ze+1).join(rt)+Ue:Ue)}function i(Ye){return Ye.replace(c,"\\$&")}function x(Ye){return new RegExp("^(?:"+Ye.map(i).join("|")+")","i")}function p(Ye){for(var rt={},Ve=-1,Ae=Ye.length;++Ve<Ae;)rt[Ye[Ve].toLowerCase()]=Ve;return rt}function v(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+1));return Ae?(Ye.w=+Ae[0],Ve+Ae[0].length):-1}function f(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+1));return Ae?(Ye.u=+Ae[0],Ve+Ae[0].length):-1}function y(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+2));return Ae?(Ye.U=+Ae[0],Ve+Ae[0].length):-1}function o(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+2));return Ae?(Ye.V=+Ae[0],Ve+Ae[0].length):-1}function m(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+2));return Ae?(Ye.W=+Ae[0],Ve+Ae[0].length):-1}function l(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+4));return Ae?(Ye.y=+Ae[0],Ve+Ae[0].length):-1}function w(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+2));return Ae?(Ye.y=+Ae[0]+(+Ae[0]>68?1900:2e3),Ve+Ae[0].length):-1}function _(Ye,rt,Ve){var Ae=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(rt.slice(Ve,Ve+6));return Ae?(Ye.Z=Ae[1]?0:-(Ae[2]+(Ae[3]||"00")),Ve+Ae[0].length):-1}function h(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+1));return Ae?(Ye.q=Ae[0]*3-3,Ve+Ae[0].length):-1}function b(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+2));return Ae?(Ye.m=Ae[0]-1,Ve+Ae[0].length):-1}function u(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+2));return Ae?(Ye.d=+Ae[0],Ve+Ae[0].length):-1}function L(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+3));return Ae?(Ye.m=0,Ye.d=+Ae[0],Ve+Ae[0].length):-1}function T(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+2));return Ae?(Ye.H=+Ae[0],Ve+Ae[0].length):-1}function k(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+2));return Ae?(Ye.M=+Ae[0],Ve+Ae[0].length):-1}function P(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+2));return Ae?(Ye.S=+Ae[0],Ve+Ae[0].length):-1}function z(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+3));return Ae?(Ye.L=+Ae[0],Ve+Ae[0].length):-1}function I(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve,Ve+6));return Ae?(Ye.L=Math.floor(Ae[0]/1e3),Ve+Ae[0].length):-1}function D(Ye,rt,Ve){var Ae=t.exec(rt.slice(Ve,Ve+1));return Ae?Ve+Ae[0].length:-1}function R(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve));return Ae?(Ye.Q=+Ae[0],Ve+Ae[0].length):-1}function O(Ye,rt,Ve){var Ae=r.exec(rt.slice(Ve));return Ae?(Ye.s=+Ae[0],Ve+Ae[0].length):-1}function F(Ye,rt){return s(Ye.getDate(),rt,2)}function N(Ye,rt){return s(Ye.getHours(),rt,2)}function G(Ye,rt){return s(Ye.getHours()%12||12,rt,2)}function K(Ye,rt){return s(1+g.timeDay.count(g.timeYear(Ye),Ye),rt,3)}function W(Ye,rt){return s(Ye.getMilliseconds(),rt,3)}function Y(Ye,rt){return W(Ye,rt)+"000"}function re(Ye,rt){return s(Ye.getMonth()+1,rt,2)}function ue(Ye,rt){return s(Ye.getMinutes(),rt,2)}function j(Ye,rt){return s(Ye.getSeconds(),rt,2)}function q(Ye){var rt=Ye.getDay();return rt===0?7:rt}function V(Ye,rt){return s(g.timeSunday.count(g.timeYear(Ye)-1,Ye),rt,2)}function U(Ye,rt){var Ve=Ye.getDay();return Ye=Ve>=4||Ve===0?g.timeThursday(Ye):g.timeThursday.ceil(Ye),s(g.timeThursday.count(g.timeYear(Ye),Ye)+(g.timeYear(Ye).getDay()===4),rt,2)}function $(Ye){return Ye.getDay()}function ne(Ye,rt){return s(g.timeMonday.count(g.timeYear(Ye)-1,Ye),rt,2)}function X(Ye,rt){return s(Ye.getFullYear()%100,rt,2)}function Q(Ye,rt){return s(Ye.getFullYear()%1e4,rt,4)}function ie(Ye){var rt=Ye.getTimezoneOffset();return(rt>0?"-":(rt*=-1,"+"))+s(rt/60|0,"0",2)+s(rt%60,"0",2)}function se(Ye,rt){return s(Ye.getUTCDate(),rt,2)}function ae(Ye,rt){return s(Ye.getUTCHours(),rt,2)}function oe(Ye,rt){return s(Ye.getUTCHours()%12||12,rt,2)}function be(Ye,rt){return s(1+g.utcDay.count(g.utcYear(Ye),Ye),rt,3)}function ce(Ye,rt){return s(Ye.getUTCMilliseconds(),rt,3)}function de(Ye,rt){return ce(Ye,rt)+"000"}function ye(Ye,rt){return s(Ye.getUTCMonth()+1,rt,2)}function ge(Ye,rt){return s(Ye.getUTCMinutes(),rt,2)}function me(Ye,rt){return s(Ye.getUTCSeconds(),rt,2)}function Ee(Ye){var rt=Ye.getUTCDay();return rt===0?7:rt}function Pe(Ye,rt){return s(g.utcSunday.count(g.utcYear(Ye)-1,Ye),rt,2)}function Ne(Ye,rt){var Ve=Ye.getUTCDay();return Ye=Ve>=4||Ve===0?g.utcThursday(Ye):g.utcThursday.ceil(Ye),s(g.utcThursday.count(g.utcYear(Ye),Ye)+(g.utcYear(Ye).getUTCDay()===4),rt,2)}function we(Ye){return Ye.getUTCDay()}function ke(Ye,rt){return s(g.utcMonday.count(g.utcYear(Ye)-1,Ye),rt,2)}function Xe(Ye,rt){return s(Ye.getUTCFullYear()%100,rt,2)}function He(Ye,rt){return s(Ye.getUTCFullYear()%1e4,rt,4)}function Ie(){return"+0000"}function De(){return"%"}function Ge(Ye){return+Ye}function ht(Ye){return Math.floor(+Ye/1e3)}var Rt;Kt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Kt(Ye){return Rt=a(Ye),A.timeFormat=Rt.format,A.timeParse=Rt.parse,A.utcFormat=Rt.utcFormat,A.utcParse=Rt.utcParse,Rt}var It="%Y-%m-%dT%H:%M:%S.%LZ";function Mt(Ye){return Ye.toISOString()}var Yt=Date.prototype.toISOString?Mt:A.utcFormat(It);function zt(Ye){var rt=new Date(Ye);return isNaN(rt)?null:rt}var St=+new Date("2000-01-01T00:00:00.000Z")?zt:A.utcParse(It);A.isoFormat=Yt,A.isoParse=St,A.timeFormatDefaultLocale=Kt,A.timeFormatLocale=a,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-time":121}],121:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){var g=new Date,S=new Date;function M(we,ke,Xe,He){function Ie(De){return we(De=arguments.length===0?new Date:new Date(+De)),De}return Ie.floor=function(De){return we(De=new Date(+De)),De},Ie.ceil=function(De){return we(De=new Date(De-1)),ke(De,1),we(De),De},Ie.round=function(De){var Ge=Ie(De),ht=Ie.ceil(De);return De-Ge<ht-De?Ge:ht},Ie.offset=function(De,Ge){return ke(De=new Date(+De),Ge==null?1:Math.floor(Ge)),De},Ie.range=function(De,Ge,ht){var Rt=[],Kt;if(De=Ie.ceil(De),ht=ht==null?1:Math.floor(ht),!(De<Ge)||!(ht>0))return Rt;do Rt.push(Kt=new Date(+De)),ke(De,ht),we(De);while(Kt<De&&De<Ge);return Rt},Ie.filter=function(De){return M(function(Ge){if(Ge>=Ge)for(;we(Ge),!De(Ge);)Ge.setTime(Ge-1)},function(Ge,ht){if(Ge>=Ge)if(ht<0)for(;++ht<=0;)for(;ke(Ge,-1),!De(Ge););else for(;--ht>=0;)for(;ke(Ge,1),!De(Ge););})},Xe&&(Ie.count=function(De,Ge){return g.setTime(+De),S.setTime(+Ge),we(g),we(S),Math.floor(Xe(g,S))},Ie.every=function(De){return De=Math.floor(De),!isFinite(De)||!(De>0)?null:De>1?Ie.filter(He?function(Ge){return He(Ge)%De===0}:function(Ge){return Ie.count(0,Ge)%De===0}):Ie}),Ie}var e=M(function(){},function(we,ke){we.setTime(+we+ke)},function(we,ke){return ke-we});e.every=function(we){return we=Math.floor(we),!isFinite(we)||!(we>0)?null:we>1?M(function(ke){ke.setTime(Math.floor(ke/we)*we)},function(ke,Xe){ke.setTime(+ke+Xe*we)},function(ke,Xe){return(Xe-ke)/we}):e};var a=e.range,n=1e3,r=6e4,t=36e5,c=864e5,s=6048e5,i=M(function(we){we.setTime(we-we.getMilliseconds())},function(we,ke){we.setTime(+we+ke*n)},function(we,ke){return(ke-we)/n},function(we){return we.getUTCSeconds()}),x=i.range,p=M(function(we){we.setTime(we-we.getMilliseconds()-we.getSeconds()*n)},function(we,ke){we.setTime(+we+ke*r)},function(we,ke){return(ke-we)/r},function(we){return we.getMinutes()}),v=p.range,f=M(function(we){we.setTime(we-we.getMilliseconds()-we.getSeconds()*n-we.getMinutes()*r)},function(we,ke){we.setTime(+we+ke*t)},function(we,ke){return(ke-we)/t},function(we){return we.getHours()}),y=f.range,o=M(function(we){we.setHours(0,0,0,0)},function(we,ke){we.setDate(we.getDate()+ke)},function(we,ke){return(ke-we-(ke.getTimezoneOffset()-we.getTimezoneOffset())*r)/c},function(we){return we.getDate()-1}),m=o.range;function l(we){return M(function(ke){ke.setDate(ke.getDate()-(ke.getDay()+7-we)%7),ke.setHours(0,0,0,0)},function(ke,Xe){ke.setDate(ke.getDate()+Xe*7)},function(ke,Xe){return(Xe-ke-(Xe.getTimezoneOffset()-ke.getTimezoneOffset())*r)/s})}var w=l(0),_=l(1),h=l(2),b=l(3),u=l(4),L=l(5),T=l(6),k=w.range,P=_.range,z=h.range,I=b.range,D=u.range,R=L.range,O=T.range,F=M(function(we){we.setDate(1),we.setHours(0,0,0,0)},function(we,ke){we.setMonth(we.getMonth()+ke)},function(we,ke){return ke.getMonth()-we.getMonth()+(ke.getFullYear()-we.getFullYear())*12},function(we){return we.getMonth()}),N=F.range,G=M(function(we){we.setMonth(0,1),we.setHours(0,0,0,0)},function(we,ke){we.setFullYear(we.getFullYear()+ke)},function(we,ke){return ke.getFullYear()-we.getFullYear()},function(we){return we.getFullYear()});G.every=function(we){return!isFinite(we=Math.floor(we))||!(we>0)?null:M(function(ke){ke.setFullYear(Math.floor(ke.getFullYear()/we)*we),ke.setMonth(0,1),ke.setHours(0,0,0,0)},function(ke,Xe){ke.setFullYear(ke.getFullYear()+Xe*we)})};var K=G.range,W=M(function(we){we.setUTCSeconds(0,0)},function(we,ke){we.setTime(+we+ke*r)},function(we,ke){return(ke-we)/r},function(we){return we.getUTCMinutes()}),Y=W.range,re=M(function(we){we.setUTCMinutes(0,0,0)},function(we,ke){we.setTime(+we+ke*t)},function(we,ke){return(ke-we)/t},function(we){return we.getUTCHours()}),ue=re.range,j=M(function(we){we.setUTCHours(0,0,0,0)},function(we,ke){we.setUTCDate(we.getUTCDate()+ke)},function(we,ke){return(ke-we)/c},function(we){return we.getUTCDate()-1}),q=j.range;function V(we){return M(function(ke){ke.setUTCDate(ke.getUTCDate()-(ke.getUTCDay()+7-we)%7),ke.setUTCHours(0,0,0,0)},function(ke,Xe){ke.setUTCDate(ke.getUTCDate()+Xe*7)},function(ke,Xe){return(Xe-ke)/s})}var U=V(0),$=V(1),ne=V(2),X=V(3),Q=V(4),ie=V(5),se=V(6),ae=U.range,oe=$.range,be=ne.range,ce=X.range,de=Q.range,ye=ie.range,ge=se.range,me=M(function(we){we.setUTCDate(1),we.setUTCHours(0,0,0,0)},function(we,ke){we.setUTCMonth(we.getUTCMonth()+ke)},function(we,ke){return ke.getUTCMonth()-we.getUTCMonth()+(ke.getUTCFullYear()-we.getUTCFullYear())*12},function(we){return we.getUTCMonth()}),Ee=me.range,Pe=M(function(we){we.setUTCMonth(0,1),we.setUTCHours(0,0,0,0)},function(we,ke){we.setUTCFullYear(we.getUTCFullYear()+ke)},function(we,ke){return ke.getUTCFullYear()-we.getUTCFullYear()},function(we){return we.getUTCFullYear()});Pe.every=function(we){return!isFinite(we=Math.floor(we))||!(we>0)?null:M(function(ke){ke.setUTCFullYear(Math.floor(ke.getUTCFullYear()/we)*we),ke.setUTCMonth(0,1),ke.setUTCHours(0,0,0,0)},function(ke,Xe){ke.setUTCFullYear(ke.getUTCFullYear()+Xe*we)})};var Ne=Pe.range;A.timeDay=o,A.timeDays=m,A.timeFriday=L,A.timeFridays=R,A.timeHour=f,A.timeHours=y,A.timeInterval=M,A.timeMillisecond=e,A.timeMilliseconds=a,A.timeMinute=p,A.timeMinutes=v,A.timeMonday=_,A.timeMondays=P,A.timeMonth=F,A.timeMonths=N,A.timeSaturday=T,A.timeSaturdays=O,A.timeSecond=i,A.timeSeconds=x,A.timeSunday=w,A.timeSundays=k,A.timeThursday=u,A.timeThursdays=D,A.timeTuesday=h,A.timeTuesdays=z,A.timeWednesday=b,A.timeWednesdays=I,A.timeWeek=w,A.timeWeeks=k,A.timeYear=G,A.timeYears=K,A.utcDay=j,A.utcDays=q,A.utcFriday=ie,A.utcFridays=ye,A.utcHour=re,A.utcHours=ue,A.utcMillisecond=e,A.utcMilliseconds=a,A.utcMinute=W,A.utcMinutes=Y,A.utcMonday=$,A.utcMondays=oe,A.utcMonth=me,A.utcMonths=Ee,A.utcSaturday=se,A.utcSaturdays=ge,A.utcSecond=i,A.utcSeconds=x,A.utcSunday=U,A.utcSundays=ae,A.utcThursday=Q,A.utcThursdays=de,A.utcTuesday=ne,A.utcTuesdays=be,A.utcWednesday=X,A.utcWednesdays=ce,A.utcWeek=U,A.utcWeeks=ae,A.utcYear=Pe,A.utcYears=Ne,Object.defineProperty(A,"__esModule",{value:!0})})},{}],122:[function(d,ee,te){arguments[4][121][0].apply(te,arguments)},{dup:121}],123:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){var g=0,S=0,M=0,e=1e3,a,n,r=0,t=0,c=0,s=typeof performance=="object"&&performance.now?performance:Date,i=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(b){setTimeout(b,17)};function x(){return t||(i(p),t=s.now()+c)}function p(){t=0}function v(){this._call=this._time=this._next=null}v.prototype=f.prototype={constructor:v,restart:function(b,u,L){if(typeof b!="function")throw new TypeError("callback is not a function");L=(L==null?x():+L)+(u==null?0:+u),!this._next&&n!==this&&(n?n._next=this:a=this,n=this),this._call=b,this._time=L,w()},stop:function(){this._call&&(this._call=null,this._time=1/0,w())}};function f(b,u,L){var T=new v;return T.restart(b,u,L),T}function y(){x(),++g;for(var b=a,u;b;)(u=t-b._time)>=0&&b._call.call(null,u),b=b._next;--g}function o(){t=(r=s.now())+c,g=S=0;try{y()}finally{g=0,l(),t=0}}function m(){var b=s.now(),u=b-r;u>e&&(c-=u,r=b)}function l(){for(var b,u=a,L,T=1/0;u;)u._call?(T>u._time&&(T=u._time),b=u,u=u._next):(L=u._next,u._next=null,u=b?b._next=L:a=L);n=b,w(T)}function w(b){if(!g){S&&(S=clearTimeout(S));var u=b-t;u>24?(b<1/0&&(S=setTimeout(o,b-s.now()-c)),M&&(M=clearInterval(M))):(M||(r=s.now(),M=setInterval(m,e)),g=1,i(o))}}function _(b,u,L){var T=new v;return u=u==null?0:+u,T.restart(function(k){T.stop(),b(k+u)},u,L),T}function h(b,u,L){var T=new v,k=u;return u==null?(T.restart(b,u,L),T):(u=+u,L=L==null?x():+L,T.restart(function P(z){z+=k,T.restart(P,k+=u,L),b(z)},u,L),T)}A.interval=h,A.now=x,A.timeout=_,A.timer=f,A.timerFlush=y,Object.defineProperty(A,"__esModule",{value:!0})})},{}],124:[function(d,ee,te){ee.exports=function(){for(var A=0;A<arguments.length;A++)if(arguments[A]!==void 0)return arguments[A]}},{}],125:[function(d,ee,te){ee.exports=M;var A=M.canvas=document.createElement("canvas"),g=A.getContext("2d"),S=e([32,126]);M.createPairs=e,M.ascii=S;function M(a,n){Array.isArray(a)&&(a=a.join(", "));var r={},t,c=16,s=.05;n&&(n.length===2&&typeof n[0]=="number"?t=e(n):Array.isArray(n)?t=n:(n.o?t=e(n.o):n.pairs&&(t=n.pairs),n.fontSize&&(c=n.fontSize),n.threshold!=null&&(s=n.threshold))),t||(t=S),g.font=c+"px "+a;for(var i=0;i<t.length;i++){var x=t[i],p=g.measureText(x[0]).width+g.measureText(x[1]).width,v=g.measureText(x).width;if(Math.abs(p-v)>c*s){var f=(v-p)/c;r[x]=f*1e3}}return r}function e(a){for(var n=[],r=a[0];r<=a[1];r++)for(var t=String.fromCharCode(r),c=a[0];c<a[1];c++){var s=String.fromCharCode(c),i=t+s;n.push(i)}return n}},{}],126:[function(d,ee,te){var A=d("abs-svg-path"),g=d("normalize-svg-path"),S={M:"moveTo",C:"bezierCurveTo"};ee.exports=function(M,e){M.beginPath(),g(A(e)).forEach(function(a){var n=a[0],r=a.slice(1);M[S[n]].apply(M,r)}),M.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(d,ee,te){ee.exports=function(A){switch(A){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(d,ee,te){function A(M,e,a){var n=M[a]|0;if(n<=0)return[];var r=new Array(n),t;if(a===M.length-1)for(t=0;t<n;++t)r[t]=e;else for(t=0;t<n;++t)r[t]=A(M,e,a+1);return r}function g(M,e){var a,n;for(a=new Array(M),n=0;n<M;++n)a[n]=e;return a}function S(M,e){switch(typeof e>"u"&&(e=0),typeof M){case"number":if(M>0)return g(M|0,e);break;case"object":if(typeof M.length=="number")return A(M,e,0);break}return[]}ee.exports=S},{}],129:[function(d,ee,te){ee.exports=A,ee.exports.default=A;function A(R,O,F){F=F||2;var N=O&&O.length,G=N?O[0]*F:R.length,K=g(R,0,G,F,!0),W=[];if(!K||K.next===K.prev)return W;var Y,re,ue,j,q,V,U;if(N&&(K=t(R,O,K,F)),R.length>80*F){Y=ue=R[0],re=j=R[1];for(var $=F;$<G;$+=F)q=R[$],V=R[$+1],q<Y&&(Y=q),V<re&&(re=V),q>ue&&(ue=q),V>j&&(j=V);U=Math.max(ue-Y,j-re),U=U!==0?1/U:0}return M(K,W,F,Y,re,U),W}function g(R,O,F,N,G){var K,W;if(G===D(R,O,F,N)>0)for(K=O;K<F;K+=N)W=P(K,R[K],R[K+1],W);else for(K=F-N;K>=O;K-=N)W=P(K,R[K],R[K+1],W);return W&&w(W,W.next)&&(z(W),W=W.next),W}function S(R,O){if(!R)return R;O||(O=R);var F=R,N;do if(N=!1,!F.steiner&&(w(F,F.next)||l(F.prev,F,F.next)===0)){if(z(F),F=O=F.prev,F===F.next)break;N=!0}else F=F.next;while(N||F!==O);return O}function M(R,O,F,N,G,K,W){if(!!R){!W&&K&&p(R,N,G,K);for(var Y=R,re,ue;R.prev!==R.next;){if(re=R.prev,ue=R.next,K?a(R,N,G,K):e(R)){O.push(re.i/F),O.push(R.i/F),O.push(ue.i/F),z(R),R=ue.next,Y=ue.next;continue}if(R=ue,R===Y){W?W===1?(R=n(S(R),O,F),M(R,O,F,N,G,K,2)):W===2&&r(R,O,F,N,G,K):M(S(R),O,F,N,G,K,1);break}}}}function e(R){var O=R.prev,F=R,N=R.next;if(l(O,F,N)>=0)return!1;for(var G=R.next.next;G!==R.prev;){if(o(O.x,O.y,F.x,F.y,N.x,N.y,G.x,G.y)&&l(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function a(R,O,F,N){var G=R.prev,K=R,W=R.next;if(l(G,K,W)>=0)return!1;for(var Y=G.x<K.x?G.x<W.x?G.x:W.x:K.x<W.x?K.x:W.x,re=G.y<K.y?G.y<W.y?G.y:W.y:K.y<W.y?K.y:W.y,ue=G.x>K.x?G.x>W.x?G.x:W.x:K.x>W.x?K.x:W.x,j=G.y>K.y?G.y>W.y?G.y:W.y:K.y>W.y?K.y:W.y,q=f(Y,re,O,F,N),V=f(ue,j,O,F,N),U=R.prevZ,$=R.nextZ;U&&U.z>=q&&$&&$.z<=V;){if(U!==R.prev&&U!==R.next&&o(G.x,G.y,K.x,K.y,W.x,W.y,U.x,U.y)&&l(U.prev,U,U.next)>=0||(U=U.prevZ,$!==R.prev&&$!==R.next&&o(G.x,G.y,K.x,K.y,W.x,W.y,$.x,$.y)&&l($.prev,$,$.next)>=0))return!1;$=$.nextZ}for(;U&&U.z>=q;){if(U!==R.prev&&U!==R.next&&o(G.x,G.y,K.x,K.y,W.x,W.y,U.x,U.y)&&l(U.prev,U,U.next)>=0)return!1;U=U.prevZ}for(;$&&$.z<=V;){if($!==R.prev&&$!==R.next&&o(G.x,G.y,K.x,K.y,W.x,W.y,$.x,$.y)&&l($.prev,$,$.next)>=0)return!1;$=$.nextZ}return!0}function n(R,O,F){var N=R;do{var G=N.prev,K=N.next.next;!w(G,K)&&_(G,N,N.next,K)&&L(G,K)&&L(K,G)&&(O.push(G.i/F),O.push(N.i/F),O.push(K.i/F),z(N),z(N.next),N=R=K),N=N.next}while(N!==R);return S(N)}function r(R,O,F,N,G,K){var W=R;do{for(var Y=W.next.next;Y!==W.prev;){if(W.i!==Y.i&&m(W,Y)){var re=k(W,Y);W=S(W,W.next),re=S(re,re.next),M(W,O,F,N,G,K),M(re,O,F,N,G,K);return}Y=Y.next}W=W.next}while(W!==R)}function t(R,O,F,N){var G=[],K,W,Y,re,ue;for(K=0,W=O.length;K<W;K++)Y=O[K]*N,re=K<W-1?O[K+1]*N:R.length,ue=g(R,Y,re,N,!1),ue===ue.next&&(ue.steiner=!0),G.push(y(ue));for(G.sort(c),K=0;K<G.length;K++)s(G[K],F),F=S(F,F.next);return F}function c(R,O){return R.x-O.x}function s(R,O){if(O=i(R,O),O){var F=k(O,R);S(O,O.next),S(F,F.next)}}function i(R,O){var F=O,N=R.x,G=R.y,K=-1/0,W;do{if(G<=F.y&&G>=F.next.y&&F.next.y!==F.y){var Y=F.x+(G-F.y)*(F.next.x-F.x)/(F.next.y-F.y);if(Y<=N&&Y>K){if(K=Y,Y===N){if(G===F.y)return F;if(G===F.next.y)return F.next}W=F.x<F.next.x?F:F.next}}F=F.next}while(F!==O);if(!W)return null;if(N===K)return W;var re=W,ue=W.x,j=W.y,q=1/0,V;F=W;do N>=F.x&&F.x>=ue&&N!==F.x&&o(G<j?N:K,G,ue,j,G<j?K:N,G,F.x,F.y)&&(V=Math.abs(G-F.y)/(N-F.x),L(F,R)&&(V<q||V===q&&(F.x>W.x||F.x===W.x&&x(W,F)))&&(W=F,q=V)),F=F.next;while(F!==re);return W}function x(R,O){return l(R.prev,R,O.prev)<0&&l(O.next,R,R.next)<0}function p(R,O,F,N){var G=R;do G.z===null&&(G.z=f(G.x,G.y,O,F,N)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==R);G.prevZ.nextZ=null,G.prevZ=null,v(G)}function v(R){var O,F,N,G,K,W,Y,re,ue=1;do{for(F=R,R=null,K=null,W=0;F;){for(W++,N=F,Y=0,O=0;O<ue&&(Y++,N=N.nextZ,!!N);O++);for(re=ue;Y>0||re>0&&N;)Y!==0&&(re===0||!N||F.z<=N.z)?(G=F,F=F.nextZ,Y--):(G=N,N=N.nextZ,re--),K?K.nextZ=G:R=G,G.prevZ=K,K=G;F=N}K.nextZ=null,ue*=2}while(W>1);return R}function f(R,O,F,N,G){return R=32767*(R-F)*G,O=32767*(O-N)*G,R=(R|R<<8)&16711935,R=(R|R<<4)&252645135,R=(R|R<<2)&858993459,R=(R|R<<1)&1431655765,O=(O|O<<8)&16711935,O=(O|O<<4)&252645135,O=(O|O<<2)&858993459,O=(O|O<<1)&1431655765,R|O<<1}function y(R){var O=R,F=R;do(O.x<F.x||O.x===F.x&&O.y<F.y)&&(F=O),O=O.next;while(O!==R);return F}function o(R,O,F,N,G,K,W,Y){return(G-W)*(O-Y)-(R-W)*(K-Y)>=0&&(R-W)*(N-Y)-(F-W)*(O-Y)>=0&&(F-W)*(K-Y)-(G-W)*(N-Y)>=0}function m(R,O){return R.next.i!==O.i&&R.prev.i!==O.i&&!u(R,O)&&(L(R,O)&&L(O,R)&&T(R,O)&&(l(R.prev,R,O.prev)||l(R,O.prev,O))||w(R,O)&&l(R.prev,R,R.next)>0&&l(O.prev,O,O.next)>0)}function l(R,O,F){return(O.y-R.y)*(F.x-O.x)-(O.x-R.x)*(F.y-O.y)}function w(R,O){return R.x===O.x&&R.y===O.y}function _(R,O,F,N){var G=b(l(R,O,F)),K=b(l(R,O,N)),W=b(l(F,N,R)),Y=b(l(F,N,O));return!!(G!==K&&W!==Y||G===0&&h(R,F,O)||K===0&&h(R,N,O)||W===0&&h(F,R,N)||Y===0&&h(F,O,N))}function h(R,O,F){return O.x<=Math.max(R.x,F.x)&&O.x>=Math.min(R.x,F.x)&&O.y<=Math.max(R.y,F.y)&&O.y>=Math.min(R.y,F.y)}function b(R){return R>0?1:R<0?-1:0}function u(R,O){var F=R;do{if(F.i!==R.i&&F.next.i!==R.i&&F.i!==O.i&&F.next.i!==O.i&&_(F,F.next,R,O))return!0;F=F.next}while(F!==R);return!1}function L(R,O){return l(R.prev,R,R.next)<0?l(R,O,R.next)>=0&&l(R,R.prev,O)>=0:l(R,O,R.prev)<0||l(R,R.next,O)<0}function T(R,O){var F=R,N=!1,G=(R.x+O.x)/2,K=(R.y+O.y)/2;do F.y>K!=F.next.y>K&&F.next.y!==F.y&&G<(F.next.x-F.x)*(K-F.y)/(F.next.y-F.y)+F.x&&(N=!N),F=F.next;while(F!==R);return N}function k(R,O){var F=new I(R.i,R.x,R.y),N=new I(O.i,O.x,O.y),G=R.next,K=O.prev;return R.next=O,O.prev=R,F.next=G,G.prev=F,N.next=F,F.prev=N,K.next=N,N.prev=K,N}function P(R,O,F,N){var G=new I(R,O,F);return N?(G.next=N.next,G.prev=N,N.next.prev=G,N.next=G):(G.prev=G,G.next=G),G}function z(R){R.next.prev=R.prev,R.prev.next=R.next,R.prevZ&&(R.prevZ.nextZ=R.nextZ),R.nextZ&&(R.nextZ.prevZ=R.prevZ)}function I(R,O,F){this.i=R,this.x=O,this.y=F,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}A.deviation=function(R,O,F,N){var G=O&&O.length,K=G?O[0]*F:R.length,W=Math.abs(D(R,0,K,F));if(G)for(var Y=0,re=O.length;Y<re;Y++){var ue=O[Y]*F,j=Y<re-1?O[Y+1]*F:R.length;W-=Math.abs(D(R,ue,j,F))}var q=0;for(Y=0;Y<N.length;Y+=3){var V=N[Y]*F,U=N[Y+1]*F,$=N[Y+2]*F;q+=Math.abs((R[V]-R[$])*(R[U+1]-R[V+1])-(R[V]-R[U])*(R[$+1]-R[V+1]))}return W===0&&q===0?0:Math.abs((q-W)/W)};function D(R,O,F,N){for(var G=0,K=O,W=F-N;K<F;K+=N)G+=(R[W]-R[K])*(R[K+1]+R[W+1]),W=K;return G}A.flatten=function(R){for(var O=R[0][0].length,F={vertices:[],holes:[],dimensions:O},N=0,G=0;G<R.length;G++){for(var K=0;K<R[G].length;K++)for(var W=0;W<O;W++)F.vertices.push(R[G][K][W]);G>0&&(N+=R[G-1].length,F.holes.push(N))}return F}},{}],130:[function(d,ee,te){var A=d("strongly-connected-components");ee.exports=function(S,M){var e=[],a=[],n=[],r={},t=[],c;function s(w){n[w]=!1,r.hasOwnProperty(w)&&Object.keys(r[w]).forEach(function(_){delete r[w][_],n[_]&&s(_)})}function i(w){var _=!1;a.push(w),n[w]=!0;var h,b;for(h=0;h<t[w].length;h++)b=t[w][h],b===c?(x(c,a),_=!0):n[b]||(_=i(b));if(_)s(w);else for(h=0;h<t[w].length;h++){b=t[w][h];var u=r[b];u||(u={},r[b]=u),u[b]=!0}return a.pop(),_}function x(w,_){var h=[].concat(_).concat(w);M?M(i):e.push(h)}function p(w){for(var _=0;_<S.length;_++)_<w&&(S[_]=[]),S[_]=S[_].filter(function(h){return h>=w})}function v(w){p(w);for(var _=S,h=A(_),b=h.components.filter(function(I){return I.length>1}),u=1/0,L,T=0;T<b.length;T++)for(var k=0;k<b[T].length;k++)b[T][k]<u&&(u=b[T][k],L=T);var P=b[L];if(!P)return!1;var z=S.map(function(I,D){return P.indexOf(D)===-1?[]:I.filter(function(R){return P.indexOf(R)!==-1})});return{leastVertex:u,adjList:z}}c=0;for(var f=S.length;c<f;){var y=v(c);if(c=y.leastVertex,t=y.adjList,t){for(var o=0;o<t.length;o++)for(var m=0;m<t[o].length;m++){var l=t[o][m];n[+l]=!1,r[l]={}}i(c),c=c+1}else c=f}if(!M)return e}},{"strongly-connected-components":307}],131:[function(d,ee,te){var A=d("../../object/valid-value");ee.exports=function(){return A(this).length=0,this}},{"../../object/valid-value":162}],132:[function(d,ee,te){ee.exports=d("./is-implemented")()?Array.from:d("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(d,ee,te){ee.exports=function(){var A=Array.from,g,S;return typeof A!="function"?!1:(g=["raz","dwa"],S=A(g),Boolean(S&&S!==g&&S[1]==="dwa"))}},{}],134:[function(d,ee,te){var A=d("es6-symbol").iterator,g=d("../../function/is-arguments"),S=d("../../function/is-function"),M=d("../../number/to-pos-integer"),e=d("../../object/valid-callable"),a=d("../../object/valid-value"),n=d("../../object/is-value"),r=d("../../string/is-string"),t=Array.isArray,c=Function.prototype.call,s={configurable:!0,enumerable:!0,writable:!0,value:null},i=Object.defineProperty;ee.exports=function(x){var p=arguments[1],v=arguments[2],f,y,o,m,l,w,_,h,b,u;if(x=Object(a(x)),n(p)&&e(p),!this||this===Array||!S(this)){if(!p){if(g(x))return l=x.length,l!==1?Array.apply(null,x):(m=new Array(1),m[0]=x[0],m);if(t(x)){for(m=new Array(l=x.length),y=0;y<l;++y)m[y]=x[y];return m}}m=[]}else f=this;if(!t(x)){if((b=x[A])!==void 0){for(_=e(b).call(x),f&&(m=new f),h=_.next(),y=0;!h.done;)u=p?c.call(p,v,h.value,y):h.value,f?(s.value=u,i(m,y,s)):m[y]=u,h=_.next(),++y;l=y}else if(r(x)){for(l=x.length,f&&(m=new f),y=0,o=0;y<l;++y)u=x[y],y+1<l&&(w=u.charCodeAt(0),w>=55296&&w<=56319&&(u+=x[++y])),u=p?c.call(p,v,u,o):u,f?(s.value=u,i(m,o,s)):m[o]=u,++o;l=o}}if(l===void 0)for(l=M(x.length),f&&(m=new f(l)),y=0;y<l;++y)u=p?c.call(p,v,x[y],y):x[y],f?(s.value=u,i(m,y,s)):m[y]=u;return f&&(s.value=null,m.length=l),m}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(d,ee,te){var A=Object.prototype.toString,g=A.call(function(){return arguments}());ee.exports=function(S){return A.call(S)===g}},{}],136:[function(d,ee,te){var A=Object.prototype.toString,g=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);ee.exports=function(S){return typeof S=="function"&&g(A.call(S))}},{}],137:[function(d,ee,te){ee.exports=function(){}},{}],138:[function(d,ee,te){ee.exports=d("./is-implemented")()?Math.sign:d("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(d,ee,te){ee.exports=function(){var A=Math.sign;return typeof A!="function"?!1:A(10)===1&&A(-20)===-1}},{}],140:[function(d,ee,te){ee.exports=function(A){return A=Number(A),isNaN(A)||A===0?A:A>0?1:-1}},{}],141:[function(d,ee,te){var A=d("../math/sign"),g=Math.abs,S=Math.floor;ee.exports=function(M){return isNaN(M)?0:(M=Number(M),M===0||!isFinite(M)?M:A(M)*S(g(M)))}},{"../math/sign":138}],142:[function(d,ee,te){var A=d("./to-integer"),g=Math.max;ee.exports=function(S){return g(0,A(S))}},{"./to-integer":141}],143:[function(d,ee,te){var A=d("./valid-callable"),g=d("./valid-value"),S=Function.prototype.bind,M=Function.prototype.call,e=Object.keys,a=Object.prototype.propertyIsEnumerable;ee.exports=function(n,r){return function(t,c){var s,i=arguments[2],x=arguments[3];return t=Object(g(t)),A(c),s=e(t),x&&s.sort(typeof x=="function"?S.call(x,t):void 0),typeof n!="function"&&(n=s[n]),M.call(n,s,function(p,v){return a.call(t,p)?M.call(c,i,t[p],p,t,v):r})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(d,ee,te){ee.exports=d("./is-implemented")()?Object.assign:d("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(d,ee,te){ee.exports=function(){var A=Object.assign,g;return typeof A!="function"?!1:(g={foo:"raz"},A(g,{bar:"dwa"},{trzy:"trzy"}),g.foo+g.bar+g.trzy==="razdwatrzy")}},{}],146:[function(d,ee,te){var A=d("../keys"),g=d("../valid-value"),S=Math.max;ee.exports=function(M,e){var a,n,r=S(arguments.length,2),t;for(M=Object(g(M)),t=function(c){try{M[c]=e[c]}catch(s){a||(a=s)}},n=1;n<r;++n)e=arguments[n],A(e).forEach(t);if(a!==void 0)throw a;return M}},{"../keys":152,"../valid-value":162}],147:[function(d,ee,te){var A=d("../array/from"),g=d("./assign"),S=d("./valid-value");ee.exports=function(M){var e=Object(S(M)),a=arguments[1],n=Object(arguments[2]);if(e!==M&&!a)return e;var r={};return a?A(a,function(t){(n.ensure||t in M)&&(r[t]=M[t])}):g(r,M),r}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(d,ee,te){var A=Object.create,g;d("./set-prototype-of/is-implemented")()||(g=d("./set-prototype-of/shim")),ee.exports=function(){var S,M,e;return!g||g.level!==1?A:(S={},M={},e={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(a){if(a==="__proto__"){M[a]={configurable:!0,enumerable:!1,writable:!0,value:void 0};return}M[a]=e}),Object.defineProperties(S,M),Object.defineProperty(g,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:S}),function(a,n){return A(a===null?S:a,n)})}()},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(d,ee,te){ee.exports=d("./_iterate")("forEach")},{"./_iterate":143}],150:[function(d,ee,te){var A=d("./is-value"),g={function:!0,object:!0};ee.exports=function(S){return A(S)&&g[typeof S]||!1}},{"./is-value":151}],151:[function(d,ee,te){var A=d("../function/noop")();ee.exports=function(g){return g!==A&&g!==null}},{"../function/noop":137}],152:[function(d,ee,te){ee.exports=d("./is-implemented")()?Object.keys:d("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(d,ee,te){ee.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},{}],154:[function(d,ee,te){var A=d("../is-value"),g=Object.keys;ee.exports=function(S){return g(A(S)?Object(S):S)}},{"../is-value":151}],155:[function(d,ee,te){var A=d("./valid-callable"),g=d("./for-each"),S=Function.prototype.call;ee.exports=function(M,e){var a={},n=arguments[2];return A(e),g(M,function(r,t,c,s){a[t]=S.call(e,n,r,t,c,s)}),a}},{"./for-each":149,"./valid-callable":160}],156:[function(d,ee,te){var A=d("./is-value"),g=Array.prototype.forEach,S=Object.create,M=function(e,a){var n;for(n in e)a[n]=e[n]};ee.exports=function(e){var a=S(null);return g.call(arguments,function(n){!A(n)||M(Object(n),a)}),a}},{"./is-value":151}],157:[function(d,ee,te){ee.exports=d("./is-implemented")()?Object.setPrototypeOf:d("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(d,ee,te){var A=Object.create,g=Object.getPrototypeOf,S={};ee.exports=function(){var M=Object.setPrototypeOf,e=arguments[0]||A;return typeof M!="function"?!1:g(M(e(null),S))===S}},{}],159:[function(d,ee,te){var A=d("../is-object"),g=d("../valid-value"),S=Object.prototype.isPrototypeOf,M=Object.defineProperty,e={configurable:!0,enumerable:!1,writable:!0,value:void 0},a;a=function(n,r){if(g(n),r===null||A(r))return n;throw new TypeError("Prototype must be null or an object")},ee.exports=function(n){var r,t;return n?(n.level===2?n.set?(t=n.set,r=function(c,s){return t.call(a(c,s),s),c}):r=function(c,s){return a(c,s).__proto__=s,c}:r=function c(s,i){var x;return a(s,i),x=S.call(c.nullPolyfill,s),x&&delete c.nullPolyfill.__proto__,i===null&&(i=c.nullPolyfill),s.__proto__=i,x&&M(c.nullPolyfill,"__proto__",e),s},Object.defineProperty(r,"level",{configurable:!1,enumerable:!1,writable:!1,value:n.level})):null}(function(){var n=Object.create(null),r={},t,c=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(c){try{t=c.set,t.call(n,r)}catch{}if(Object.getPrototypeOf(n)===r)return{set:t,level:2}}return n.__proto__=r,Object.getPrototypeOf(n)===r?{level:2}:(n={},n.__proto__=r,Object.getPrototypeOf(n)===r?{level:1}:!1)}()),d("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(d,ee,te){ee.exports=function(A){if(typeof A!="function")throw new TypeError(A+" is not a function");return A}},{}],161:[function(d,ee,te){var A=d("./is-object");ee.exports=function(g){if(!A(g))throw new TypeError(g+" is not an Object");return g}},{"./is-object":150}],162:[function(d,ee,te){var A=d("./is-value");ee.exports=function(g){if(!A(g))throw new TypeError("Cannot use null or undefined");return g}},{"./is-value":151}],163:[function(d,ee,te){ee.exports=d("./is-implemented")()?String.prototype.contains:d("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(d,ee,te){var A="razdwatrzy";ee.exports=function(){return typeof A.contains!="function"?!1:A.contains("dwa")===!0&&A.contains("foo")===!1}},{}],165:[function(d,ee,te){var A=String.prototype.indexOf;ee.exports=function(g){return A.call(this,g,arguments[1])>-1}},{}],166:[function(d,ee,te){var A=Object.prototype.toString,g=A.call("");ee.exports=function(S){return typeof S=="string"||S&&typeof S=="object"&&(S instanceof String||A.call(S)===g)||!1}},{}],167:[function(d,ee,te){var A=Object.create(null),g=Math.random;ee.exports=function(){var S;do S=g().toString(36).slice(2);while(A[S]);return S}},{}],168:[function(d,ee,te){var A=d("es5-ext/object/set-prototype-of"),g=d("es5-ext/string/#/contains"),S=d("d"),M=d("es6-symbol"),e=d("./"),a=Object.defineProperty,n;n=ee.exports=function(r,t){if(!(this instanceof n))throw new TypeError("Constructor requires 'new'");e.call(this,r),t?g.call(t,"key+value")?t="key+value":g.call(t,"key")?t="key":t="value":t="value",a(this,"__kind__",S("",t))},A&&A(n,e),delete n.prototype.constructor,n.prototype=Object.create(e.prototype,{_resolve:S(function(r){return this.__kind__==="value"?this.__list__[r]:this.__kind__==="key+value"?[r,this.__list__[r]]:r})}),a(n.prototype,M.toStringTag,S("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(d,ee,te){var A=d("es5-ext/function/is-arguments"),g=d("es5-ext/object/valid-callable"),S=d("es5-ext/string/is-string"),M=d("./get"),e=Array.isArray,a=Function.prototype.call,n=Array.prototype.some;ee.exports=function(r,t){var c,s=arguments[2],i,x,p,v,f,y,o;if(e(r)||A(r)?c="array":S(r)?c="string":r=M(r),g(t),x=function(){p=!0},c==="array"){n.call(r,function(m){return a.call(t,s,m,x),p});return}if(c==="string"){for(f=r.length,v=0;v<f&&(y=r[v],v+1<f&&(o=y.charCodeAt(0),o>=55296&&o<=56319&&(y+=r[++v])),a.call(t,s,y,x),!p);++v);return}for(i=r.next();!i.done;){if(a.call(t,s,i.value,x),p)return;i=r.next()}}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(d,ee,te){var A=d("es5-ext/function/is-arguments"),g=d("es5-ext/string/is-string"),S=d("./array"),M=d("./string"),e=d("./valid-iterable"),a=d("es6-symbol").iterator;ee.exports=function(n){return typeof e(n)[a]=="function"?n[a]():A(n)?new S(n):g(n)?new M(n):new S(n)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(d,ee,te){var A=d("es5-ext/array/#/clear"),g=d("es5-ext/object/assign"),S=d("es5-ext/object/valid-callable"),M=d("es5-ext/object/valid-value"),e=d("d"),a=d("d/auto-bind"),n=d("es6-symbol"),r=Object.defineProperty,t=Object.defineProperties,c;ee.exports=c=function(s,i){if(!(this instanceof c))throw new TypeError("Constructor requires 'new'");t(this,{__list__:e("w",M(s)),__context__:e("w",i),__nextIndex__:e("w",0)}),i&&(S(i.on),i.on("_add",this._onAdd),i.on("_delete",this._onDelete),i.on("_clear",this._onClear))},delete c.prototype.constructor,t(c.prototype,g({_next:e(function(){var s;if(!!this.__list__){if(this.__redo__&&(s=this.__redo__.shift(),s!==void 0))return s;if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind()}}),next:e(function(){return this._createResult(this._next())}),_createResult:e(function(s){return s===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(s)}}),_resolve:e(function(s){return this.__list__[s]}),_unBind:e(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:e(function(){return"[object "+(this[n.toStringTag]||"Object")+"]"})},a({_onAdd:e(function(s){if(!(s>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__){r(this,"__redo__",e("c",[s]));return}this.__redo__.forEach(function(i,x){i>=s&&(this.__redo__[x]=++i)},this),this.__redo__.push(s)}}),_onDelete:e(function(s){var i;s>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(i=this.__redo__.indexOf(s),i!==-1&&this.__redo__.splice(i,1),this.__redo__.forEach(function(x,p){x>s&&(this.__redo__[p]=--x)},this)))}),_onClear:e(function(){this.__redo__&&A.call(this.__redo__),this.__nextIndex__=0})}))),r(c.prototype,n.iterator,e(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(d,ee,te){var A=d("es5-ext/function/is-arguments"),g=d("es5-ext/object/is-value"),S=d("es5-ext/string/is-string"),M=d("es6-symbol").iterator,e=Array.isArray;ee.exports=function(a){return g(a)?e(a)||S(a)||A(a)?!0:typeof a[M]=="function":!1}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(d,ee,te){var A=d("es5-ext/object/set-prototype-of"),g=d("d"),S=d("es6-symbol"),M=d("./"),e=Object.defineProperty,a;a=ee.exports=function(n){if(!(this instanceof a))throw new TypeError("Constructor requires 'new'");n=String(n),M.call(this,n),e(this,"__length__",g("",n.length))},A&&A(a,M),delete a.prototype.constructor,a.prototype=Object.create(M.prototype,{_next:g(function(){if(!!this.__list__){if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind()}}),_resolve:g(function(n){var r=this.__list__[n],t;return this.__nextIndex__===this.__length__?r:(t=r.charCodeAt(0),t>=55296&&t<=56319?r+this.__list__[this.__nextIndex__++]:r)})}),e(a.prototype,S.toStringTag,g("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(d,ee,te){var A=d("./is-iterable");ee.exports=function(g){if(!A(g))throw new TypeError(g+" is not iterable");return g}},{"./is-iterable":172}],175:[function(d,ee,te){ee.exports=d("./is-implemented")()?d("ext/global-this").Symbol:d("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(d,ee,te){var A=d("ext/global-this"),g={object:!0,symbol:!0};ee.exports=function(){var S=A.Symbol,M;if(typeof S!="function")return!1;M=S("test symbol");try{String(M)}catch{return!1}return!(!g[typeof S.iterator]||!g[typeof S.toPrimitive]||!g[typeof S.toStringTag])}},{"ext/global-this":188}],177:[function(d,ee,te){ee.exports=function(A){return A?typeof A=="symbol"?!0:!A.constructor||A.constructor.name!=="Symbol"?!1:A[A.constructor.toStringTag]==="Symbol":!1}},{}],178:[function(d,ee,te){var A=d("d"),g=Object.create,S=Object.defineProperty,M=Object.prototype,e=g(null);ee.exports=function(a){for(var n=0,r,t;e[a+(n||"")];)++n;return a+=n||"",e[a]=!0,r="@@"+a,S(M,r,A.gs(null,function(c){t||(t=!0,S(this,r,A(c)),t=!1)})),r}},{d:106}],179:[function(d,ee,te){var A=d("d"),g=d("ext/global-this").Symbol;ee.exports=function(S){return Object.defineProperties(S,{hasInstance:A("",g&&g.hasInstance||S("hasInstance")),isConcatSpreadable:A("",g&&g.isConcatSpreadable||S("isConcatSpreadable")),iterator:A("",g&&g.iterator||S("iterator")),match:A("",g&&g.match||S("match")),replace:A("",g&&g.replace||S("replace")),search:A("",g&&g.search||S("search")),species:A("",g&&g.species||S("species")),split:A("",g&&g.split||S("split")),toPrimitive:A("",g&&g.toPrimitive||S("toPrimitive")),toStringTag:A("",g&&g.toStringTag||S("toStringTag")),unscopables:A("",g&&g.unscopables||S("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(d,ee,te){var A=d("d"),g=d("../../../validate-symbol"),S=Object.create(null);ee.exports=function(M){return Object.defineProperties(M,{for:A(function(e){return S[e]?S[e]:S[e]=M(String(e))}),keyFor:A(function(e){var a;g(e);for(a in S)if(S[a]===e)return a})})}},{"../../../validate-symbol":182,d:106}],181:[function(d,ee,te){var A=d("d"),g=d("./validate-symbol"),S=d("ext/global-this").Symbol,M=d("./lib/private/generate-name"),e=d("./lib/private/setup/standard-symbols"),a=d("./lib/private/setup/symbol-registry"),n=Object.create,r=Object.defineProperties,t=Object.defineProperty,c,s,i;if(typeof S=="function")try{String(S()),i=!0}catch{}else S=null;s=function(p){if(this instanceof s)throw new TypeError("Symbol is not a constructor");return c(p)},ee.exports=c=function x(p){var v;if(this instanceof x)throw new TypeError("Symbol is not a constructor");return i?S(p):(v=n(s.prototype),p=p===void 0?"":String(p),r(v,{__description__:A("",p),__name__:A("",M(p))}))},e(c),a(c),r(s.prototype,{constructor:A(c),toString:A("",function(){return this.__name__})}),r(c.prototype,{toString:A(function(){return"Symbol ("+g(this).__description__+")"}),valueOf:A(function(){return g(this)})}),t(c.prototype,c.toPrimitive,A("",function(){var x=g(this);return typeof x=="symbol"?x:x.toString()})),t(c.prototype,c.toStringTag,A("c","Symbol")),t(s.prototype,c.toStringTag,A("c",c.prototype[c.toStringTag])),t(s.prototype,c.toPrimitive,A("c",c.prototype[c.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(d,ee,te){var A=d("./is-symbol");ee.exports=function(g){if(!A(g))throw new TypeError(g+" is not a symbol");return g}},{"./is-symbol":177}],183:[function(d,ee,te){ee.exports=d("./is-implemented")()?WeakMap:d("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(d,ee,te){ee.exports=function(){var A,g;if(typeof WeakMap!="function")return!1;try{A=new WeakMap([[g={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return!(String(A)!=="[object WeakMap]"||typeof A.set!="function"||A.set({},1)!==A||typeof A.delete!="function"||typeof A.has!="function"||A.get(g)!=="one")}},{}],185:[function(d,ee,te){ee.exports=function(){return typeof WeakMap!="function"?!1:Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"}()},{}],186:[function(d,ee,te){var A=d("es5-ext/object/is-value"),g=d("es5-ext/object/set-prototype-of"),S=d("es5-ext/object/valid-object"),M=d("es5-ext/object/valid-value"),e=d("es5-ext/string/random-uniq"),a=d("d"),n=d("es6-iterator/get"),r=d("es6-iterator/for-of"),t=d("es6-symbol").toStringTag,c=d("./is-native-implemented"),s=Array.isArray,i=Object.defineProperty,x=Object.prototype.hasOwnProperty,p=Object.getPrototypeOf,v;ee.exports=v=function(){var f=arguments[0],y;if(!(this instanceof v))throw new TypeError("Constructor requires 'new'");return y=c&&g&&WeakMap!==v?g(new WeakMap,p(this)):this,A(f)&&(s(f)||(f=n(f))),i(y,"__weakMapData__",a("c","$weakMap$"+e())),f&&r(f,function(o){M(o),y.set(o[0],o[1])}),y},c&&(g&&g(v,WeakMap),v.prototype=Object.create(WeakMap.prototype,{constructor:a(v)})),Object.defineProperties(v.prototype,{delete:a(function(f){return x.call(S(f),this.__weakMapData__)?(delete f[this.__weakMapData__],!0):!1}),get:a(function(f){if(!!x.call(S(f),this.__weakMapData__))return f[this.__weakMapData__]}),has:a(function(f){return x.call(S(f),this.__weakMapData__)}),set:a(function(f,y){return i(S(f),this.__weakMapData__,a("c",y)),this}),toString:a(function(){return"[object WeakMap]"})}),i(v.prototype,t,a("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(d,ee,te){var A=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};ee.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return A()}try{return __global__||A()}finally{delete Object.prototype.__global__}}()},{}],188:[function(d,ee,te){ee.exports=d("./is-implemented")()?globalThis:d("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(d,ee,te){ee.exports=function(){return typeof globalThis!="object"||!globalThis?!1:globalThis.Array===Array}},{}],190:[function(d,ee,te){var A=d("is-string-blank");ee.exports=function(g){var S=typeof g;if(S==="string"){var M=g;if(g=+g,g===0&&A(M))return!1}else if(S!=="number")return!1;return g-g<1}},{"is-string-blank":237}],191:[function(d,ee,te){var A=d("dtype");ee.exports=g;function g(S,M,e){if(!S)throw new TypeError("must specify data as first parameter");if(e=+(e||0)|0,Array.isArray(S)&&S[0]&&typeof S[0][0]=="number"){var a=S[0].length,n=S.length*a,r,t,c,s;(!M||typeof M=="string")&&(M=new(A(M||"float32"))(n+e));var i=M.length-e;if(n!==i)throw new Error("source length "+n+" ("+a+"x"+S.length+") does not match destination length "+i);for(r=0,c=e;r<S.length;r++)for(t=0;t<a;t++)M[c++]=S[r][t]===null?NaN:S[r][t]}else if(!M||typeof M=="string"){var x=A(M||"float32");if(Array.isArray(S)||M==="array")for(M=new x(S.length+e),r=0,c=e,s=M.length;c<s;c++,r++)M[c]=S[r]===null?NaN:S[r];else e===0?M=new x(S):(M=new x(S.length+e),M.set(S,e))}else M.set(S,e);return M}},{dtype:127}],192:[function(d,ee,te){var A=d("css-font/stringify"),g=[32,126];ee.exports=S;function S(M){M=M||{};var e=M.shape?M.shape:M.canvas?[M.canvas.width,M.canvas.height]:[512,512],a=M.canvas||document.createElement("canvas"),n=M.font,r=typeof M.step=="number"?[M.step,M.step]:M.step||[32,32],t=M.chars||g;if(n&&typeof n!="string"&&(n=A(n)),!Array.isArray(t))t=String(t).split("");else if(t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"){for(var c=[],s=t[0],i=0;s<=t[1];s++)c[i++]=String.fromCharCode(s);t=c}e=e.slice(),a.width=e[0],a.height=e[1];var x=a.getContext("2d");x.fillStyle="#000",x.fillRect(0,0,a.width,a.height),x.font=n,x.textAlign="center",x.textBaseline="middle",x.fillStyle="#fff";for(var p=r[0]/2,v=r[1]/2,s=0;s<t.length;s++)x.fillText(t[s],p,v),(p+=r[0])>e[0]-r[0]/2&&(p=r[0]/2,v+=r[1]);return a}},{"css-font/stringify":102}],193:[function(d,ee,te){ee.exports=A,A.canvas=document.createElement("canvas"),A.cache={};function A(s,a){a||(a={}),(typeof s=="string"||Array.isArray(s))&&(a.family=s);var n=Array.isArray(a.family)?a.family.join(", "):a.family;if(!n)throw Error("`family` must be defined");var r=a.size||a.fontSize||a.em||48,t=a.weight||a.fontWeight||"",c=a.style||a.fontStyle||"",s=[c,t,r].join(" ")+"px "+n,i=a.origin||"top";if(A.cache[n]&&r<=A.cache[n].em)return g(A.cache[n],i);var x=a.canvas||A.canvas,p=x.getContext("2d"),v={upper:a.upper!==void 0?a.upper:"H",lower:a.lower!==void 0?a.lower:"x",descent:a.descent!==void 0?a.descent:"p",ascent:a.ascent!==void 0?a.ascent:"h",tittle:a.tittle!==void 0?a.tittle:"i",overshoot:a.overshoot!==void 0?a.overshoot:"O"},f=Math.ceil(r*1.5);x.height=f,x.width=f*.5,p.font=s;var y="H",o={top:0};p.clearRect(0,0,f,f),p.textBaseline="top",p.fillStyle="black",p.fillText(y,0,0);var m=S(p.getImageData(0,0,f,f));p.clearRect(0,0,f,f),p.textBaseline="bottom",p.fillText(y,0,f);var l=S(p.getImageData(0,0,f,f));o.lineHeight=o.bottom=f-l+m,p.clearRect(0,0,f,f),p.textBaseline="alphabetic",p.fillText(y,0,f);var w=S(p.getImageData(0,0,f,f)),_=f-w-1+m;o.baseline=o.alphabetic=_,p.clearRect(0,0,f,f),p.textBaseline="middle",p.fillText(y,0,f*.5);var h=S(p.getImageData(0,0,f,f));o.median=o.middle=f-h-1+m-f*.5,p.clearRect(0,0,f,f),p.textBaseline="hanging",p.fillText(y,0,f*.5);var b=S(p.getImageData(0,0,f,f));o.hanging=f-b-1+m-f*.5,p.clearRect(0,0,f,f),p.textBaseline="ideographic",p.fillText(y,0,f);var u=S(p.getImageData(0,0,f,f));if(o.ideographic=f-u-1+m,v.upper&&(p.clearRect(0,0,f,f),p.textBaseline="top",p.fillText(v.upper,0,0),o.upper=S(p.getImageData(0,0,f,f)),o.capHeight=o.baseline-o.upper),v.lower&&(p.clearRect(0,0,f,f),p.textBaseline="top",p.fillText(v.lower,0,0),o.lower=S(p.getImageData(0,0,f,f)),o.xHeight=o.baseline-o.lower),v.tittle&&(p.clearRect(0,0,f,f),p.textBaseline="top",p.fillText(v.tittle,0,0),o.tittle=S(p.getImageData(0,0,f,f))),v.ascent&&(p.clearRect(0,0,f,f),p.textBaseline="top",p.fillText(v.ascent,0,0),o.ascent=S(p.getImageData(0,0,f,f))),v.descent&&(p.clearRect(0,0,f,f),p.textBaseline="top",p.fillText(v.descent,0,0),o.descent=M(p.getImageData(0,0,f,f))),v.overshoot){p.clearRect(0,0,f,f),p.textBaseline="top",p.fillText(v.overshoot,0,0);var L=M(p.getImageData(0,0,f,f));o.overshoot=L-_}for(var T in o)o[T]/=r;return o.em=r,A.cache[n]=o,g(o,i)}function g(e,a){var n={};typeof a=="string"&&(a=e[a]);for(var r in e)r!=="em"&&(n[r]=e[r]-a);return n}function S(e){for(var a=e.height,n=e.data,r=3;r<n.length;r+=4)if(n[r]!==0)return Math.floor((r-3)*.25/a)}function M(e){for(var a=e.height,n=e.data,r=n.length-1;r>0;r-=4)if(n[r]!==0)return Math.floor((r-3)*.25/a)}},{}],194:[function(d,ee,te){ee.exports=A;function A(g,S){if(typeof g!="string")throw new TypeError("must specify type string");if(S=S||{},typeof document>"u"&&!S.canvas)return null;var M=S.canvas||document.createElement("canvas");typeof S.width=="number"&&(M.width=S.width),typeof S.height=="number"&&(M.height=S.height);var e=S,a;try{var n=[g];g.indexOf("webgl")===0&&n.push("experimental-"+g);for(var r=0;r<n.length;r++)if(a=M.getContext(n[r],e),a)return a}catch{a=null}return a||null}},{}],195:[function(d,ee,te){ee.exports=A;function A(g,S){var M=S[0],e=S[1],a=S[2],n=S[3],r=S[4],t=S[5],c=S[6],s=S[7],i=S[8],x=S[9],p=S[10],v=S[11],f=S[12],y=S[13],o=S[14],m=S[15];return g[0]=t*(p*m-v*o)-x*(c*m-s*o)+y*(c*v-s*p),g[1]=-(e*(p*m-v*o)-x*(a*m-n*o)+y*(a*v-n*p)),g[2]=e*(c*m-s*o)-t*(a*m-n*o)+y*(a*s-n*c),g[3]=-(e*(c*v-s*p)-t*(a*v-n*p)+x*(a*s-n*c)),g[4]=-(r*(p*m-v*o)-i*(c*m-s*o)+f*(c*v-s*p)),g[5]=M*(p*m-v*o)-i*(a*m-n*o)+f*(a*v-n*p),g[6]=-(M*(c*m-s*o)-r*(a*m-n*o)+f*(a*s-n*c)),g[7]=M*(c*v-s*p)-r*(a*v-n*p)+i*(a*s-n*c),g[8]=r*(x*m-v*y)-i*(t*m-s*y)+f*(t*v-s*x),g[9]=-(M*(x*m-v*y)-i*(e*m-n*y)+f*(e*v-n*x)),g[10]=M*(t*m-s*y)-r*(e*m-n*y)+f*(e*s-n*t),g[11]=-(M*(t*v-s*x)-r*(e*v-n*x)+i*(e*s-n*t)),g[12]=-(r*(x*o-p*y)-i*(t*o-c*y)+f*(t*p-c*x)),g[13]=M*(x*o-p*y)-i*(e*o-a*y)+f*(e*p-a*x),g[14]=-(M*(t*o-c*y)-r*(e*o-a*y)+f*(e*c-a*t)),g[15]=M*(t*p-c*x)-r*(e*p-a*x)+i*(e*c-a*t),g}},{}],196:[function(d,ee,te){ee.exports=A;function A(g){var S=new Float32Array(16);return S[0]=g[0],S[1]=g[1],S[2]=g[2],S[3]=g[3],S[4]=g[4],S[5]=g[5],S[6]=g[6],S[7]=g[7],S[8]=g[8],S[9]=g[9],S[10]=g[10],S[11]=g[11],S[12]=g[12],S[13]=g[13],S[14]=g[14],S[15]=g[15],S}},{}],197:[function(d,ee,te){ee.exports=A;function A(g,S){return g[0]=S[0],g[1]=S[1],g[2]=S[2],g[3]=S[3],g[4]=S[4],g[5]=S[5],g[6]=S[6],g[7]=S[7],g[8]=S[8],g[9]=S[9],g[10]=S[10],g[11]=S[11],g[12]=S[12],g[13]=S[13],g[14]=S[14],g[15]=S[15],g}},{}],198:[function(d,ee,te){ee.exports=A;function A(){var g=new Float32Array(16);return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],199:[function(d,ee,te){ee.exports=A;function A(g){var S=g[0],M=g[1],e=g[2],a=g[3],n=g[4],r=g[5],t=g[6],c=g[7],s=g[8],i=g[9],x=g[10],p=g[11],v=g[12],f=g[13],y=g[14],o=g[15],m=S*r-M*n,l=S*t-e*n,w=S*c-a*n,_=M*t-e*r,h=M*c-a*r,b=e*c-a*t,u=s*f-i*v,L=s*y-x*v,T=s*o-p*v,k=i*y-x*f,P=i*o-p*f,z=x*o-p*y;return m*z-l*P+w*k+_*T-h*L+b*u}},{}],200:[function(d,ee,te){ee.exports=A;function A(g,S){var M=S[0],e=S[1],a=S[2],n=S[3],r=M+M,t=e+e,c=a+a,s=M*r,i=e*r,x=e*t,p=a*r,v=a*t,f=a*c,y=n*r,o=n*t,m=n*c;return g[0]=1-x-f,g[1]=i+m,g[2]=p-o,g[3]=0,g[4]=i-m,g[5]=1-s-f,g[6]=v+y,g[7]=0,g[8]=p+o,g[9]=v-y,g[10]=1-s-x,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],201:[function(d,ee,te){ee.exports=A;function A(g,S,M){var e,a,n,r=M[0],t=M[1],c=M[2],s=Math.sqrt(r*r+t*t+c*c);return Math.abs(s)<1e-6?null:(s=1/s,r*=s,t*=s,c*=s,e=Math.sin(S),a=Math.cos(S),n=1-a,g[0]=r*r*n+a,g[1]=t*r*n+c*e,g[2]=c*r*n-t*e,g[3]=0,g[4]=r*t*n-c*e,g[5]=t*t*n+a,g[6]=c*t*n+r*e,g[7]=0,g[8]=r*c*n+t*e,g[9]=t*c*n-r*e,g[10]=c*c*n+a,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g)}},{}],202:[function(d,ee,te){ee.exports=A;function A(g,S,M){var e=S[0],a=S[1],n=S[2],r=S[3],t=e+e,c=a+a,s=n+n,i=e*t,x=e*c,p=e*s,v=a*c,f=a*s,y=n*s,o=r*t,m=r*c,l=r*s;return g[0]=1-(v+y),g[1]=x+l,g[2]=p-m,g[3]=0,g[4]=x-l,g[5]=1-(i+y),g[6]=f+o,g[7]=0,g[8]=p+m,g[9]=f-o,g[10]=1-(i+v),g[11]=0,g[12]=M[0],g[13]=M[1],g[14]=M[2],g[15]=1,g}},{}],203:[function(d,ee,te){ee.exports=A;function A(g,S){return g[0]=S[0],g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=S[1],g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=S[2],g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],204:[function(d,ee,te){ee.exports=A;function A(g,S){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=S[0],g[13]=S[1],g[14]=S[2],g[15]=1,g}},{}],205:[function(d,ee,te){ee.exports=A;function A(g,S){var M=Math.sin(S),e=Math.cos(S);return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=e,g[6]=M,g[7]=0,g[8]=0,g[9]=-M,g[10]=e,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],206:[function(d,ee,te){ee.exports=A;function A(g,S){var M=Math.sin(S),e=Math.cos(S);return g[0]=e,g[1]=0,g[2]=-M,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=M,g[9]=0,g[10]=e,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],207:[function(d,ee,te){ee.exports=A;function A(g,S){var M=Math.sin(S),e=Math.cos(S);return g[0]=e,g[1]=M,g[2]=0,g[3]=0,g[4]=-M,g[5]=e,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],208:[function(d,ee,te){ee.exports=A;function A(g,S,M,e,a,n,r){var t=1/(M-S),c=1/(a-e),s=1/(n-r);return g[0]=n*2*t,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=n*2*c,g[6]=0,g[7]=0,g[8]=(M+S)*t,g[9]=(a+e)*c,g[10]=(r+n)*s,g[11]=-1,g[12]=0,g[13]=0,g[14]=r*n*2*s,g[15]=0,g}},{}],209:[function(d,ee,te){ee.exports=A;function A(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],210:[function(d,ee,te){ee.exports={create:d("./create"),clone:d("./clone"),copy:d("./copy"),identity:d("./identity"),transpose:d("./transpose"),invert:d("./invert"),adjoint:d("./adjoint"),determinant:d("./determinant"),multiply:d("./multiply"),translate:d("./translate"),scale:d("./scale"),rotate:d("./rotate"),rotateX:d("./rotateX"),rotateY:d("./rotateY"),rotateZ:d("./rotateZ"),fromRotation:d("./fromRotation"),fromRotationTranslation:d("./fromRotationTranslation"),fromScaling:d("./fromScaling"),fromTranslation:d("./fromTranslation"),fromXRotation:d("./fromXRotation"),fromYRotation:d("./fromYRotation"),fromZRotation:d("./fromZRotation"),fromQuat:d("./fromQuat"),frustum:d("./frustum"),perspective:d("./perspective"),perspectiveFromFieldOfView:d("./perspectiveFromFieldOfView"),ortho:d("./ortho"),lookAt:d("./lookAt"),str:d("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(d,ee,te){ee.exports=A;function A(g,S){var M=S[0],e=S[1],a=S[2],n=S[3],r=S[4],t=S[5],c=S[6],s=S[7],i=S[8],x=S[9],p=S[10],v=S[11],f=S[12],y=S[13],o=S[14],m=S[15],l=M*t-e*r,w=M*c-a*r,_=M*s-n*r,h=e*c-a*t,b=e*s-n*t,u=a*s-n*c,L=i*y-x*f,T=i*o-p*f,k=i*m-v*f,P=x*o-p*y,z=x*m-v*y,I=p*m-v*o,D=l*I-w*z+_*P+h*k-b*T+u*L;return D?(D=1/D,g[0]=(t*I-c*z+s*P)*D,g[1]=(a*z-e*I-n*P)*D,g[2]=(y*u-o*b+m*h)*D,g[3]=(p*b-x*u-v*h)*D,g[4]=(c*k-r*I-s*T)*D,g[5]=(M*I-a*k+n*T)*D,g[6]=(o*_-f*u-m*w)*D,g[7]=(i*u-p*_+v*w)*D,g[8]=(r*z-t*k+s*L)*D,g[9]=(e*k-M*z-n*L)*D,g[10]=(f*b-y*_+m*l)*D,g[11]=(x*_-i*b-v*l)*D,g[12]=(t*T-r*P-c*L)*D,g[13]=(M*P-e*T+a*L)*D,g[14]=(y*w-f*h-o*l)*D,g[15]=(i*h-x*w+p*l)*D,g):null}},{}],212:[function(d,ee,te){var A=d("./identity");ee.exports=g;function g(S,M,e,a){var n,r,t,c,s,i,x,p,v,f,y=M[0],o=M[1],m=M[2],l=a[0],w=a[1],_=a[2],h=e[0],b=e[1],u=e[2];return Math.abs(y-h)<1e-6&&Math.abs(o-b)<1e-6&&Math.abs(m-u)<1e-6?A(S):(x=y-h,p=o-b,v=m-u,f=1/Math.sqrt(x*x+p*p+v*v),x*=f,p*=f,v*=f,n=w*v-_*p,r=_*x-l*v,t=l*p-w*x,f=Math.sqrt(n*n+r*r+t*t),f?(f=1/f,n*=f,r*=f,t*=f):(n=0,r=0,t=0),c=p*t-v*r,s=v*n-x*t,i=x*r-p*n,f=Math.sqrt(c*c+s*s+i*i),f?(f=1/f,c*=f,s*=f,i*=f):(c=0,s=0,i=0),S[0]=n,S[1]=c,S[2]=x,S[3]=0,S[4]=r,S[5]=s,S[6]=p,S[7]=0,S[8]=t,S[9]=i,S[10]=v,S[11]=0,S[12]=-(n*y+r*o+t*m),S[13]=-(c*y+s*o+i*m),S[14]=-(x*y+p*o+v*m),S[15]=1,S)}},{"./identity":209}],213:[function(d,ee,te){ee.exports=A;function A(g,S,M){var e=S[0],a=S[1],n=S[2],r=S[3],t=S[4],c=S[5],s=S[6],i=S[7],x=S[8],p=S[9],v=S[10],f=S[11],y=S[12],o=S[13],m=S[14],l=S[15],w=M[0],_=M[1],h=M[2],b=M[3];return g[0]=w*e+_*t+h*x+b*y,g[1]=w*a+_*c+h*p+b*o,g[2]=w*n+_*s+h*v+b*m,g[3]=w*r+_*i+h*f+b*l,w=M[4],_=M[5],h=M[6],b=M[7],g[4]=w*e+_*t+h*x+b*y,g[5]=w*a+_*c+h*p+b*o,g[6]=w*n+_*s+h*v+b*m,g[7]=w*r+_*i+h*f+b*l,w=M[8],_=M[9],h=M[10],b=M[11],g[8]=w*e+_*t+h*x+b*y,g[9]=w*a+_*c+h*p+b*o,g[10]=w*n+_*s+h*v+b*m,g[11]=w*r+_*i+h*f+b*l,w=M[12],_=M[13],h=M[14],b=M[15],g[12]=w*e+_*t+h*x+b*y,g[13]=w*a+_*c+h*p+b*o,g[14]=w*n+_*s+h*v+b*m,g[15]=w*r+_*i+h*f+b*l,g}},{}],214:[function(d,ee,te){ee.exports=A;function A(g,S,M,e,a,n,r){var t=1/(S-M),c=1/(e-a),s=1/(n-r);return g[0]=-2*t,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=-2*c,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=2*s,g[11]=0,g[12]=(S+M)*t,g[13]=(a+e)*c,g[14]=(r+n)*s,g[15]=1,g}},{}],215:[function(d,ee,te){ee.exports=A;function A(g,S,M,e,a){var n=1/Math.tan(S/2),r=1/(e-a);return g[0]=n/M,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=n,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=(a+e)*r,g[11]=-1,g[12]=0,g[13]=0,g[14]=2*a*e*r,g[15]=0,g}},{}],216:[function(d,ee,te){ee.exports=A;function A(g,S,M,e){var a=Math.tan(S.upDegrees*Math.PI/180),n=Math.tan(S.downDegrees*Math.PI/180),r=Math.tan(S.leftDegrees*Math.PI/180),t=Math.tan(S.rightDegrees*Math.PI/180),c=2/(r+t),s=2/(a+n);return g[0]=c,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=s,g[6]=0,g[7]=0,g[8]=-((r-t)*c*.5),g[9]=(a-n)*s*.5,g[10]=e/(M-e),g[11]=-1,g[12]=0,g[13]=0,g[14]=e*M/(M-e),g[15]=0,g}},{}],217:[function(d,ee,te){ee.exports=A;function A(g,S,M,e){var a=e[0],n=e[1],r=e[2],t=Math.sqrt(a*a+n*n+r*r),c,s,i,x,p,v,f,y,o,m,l,w,_,h,b,u,L,T,k,P,z,I,D,R;return Math.abs(t)<1e-6?null:(t=1/t,a*=t,n*=t,r*=t,c=Math.sin(M),s=Math.cos(M),i=1-s,x=S[0],p=S[1],v=S[2],f=S[3],y=S[4],o=S[5],m=S[6],l=S[7],w=S[8],_=S[9],h=S[10],b=S[11],u=a*a*i+s,L=n*a*i+r*c,T=r*a*i-n*c,k=a*n*i-r*c,P=n*n*i+s,z=r*n*i+a*c,I=a*r*i+n*c,D=n*r*i-a*c,R=r*r*i+s,g[0]=x*u+y*L+w*T,g[1]=p*u+o*L+_*T,g[2]=v*u+m*L+h*T,g[3]=f*u+l*L+b*T,g[4]=x*k+y*P+w*z,g[5]=p*k+o*P+_*z,g[6]=v*k+m*P+h*z,g[7]=f*k+l*P+b*z,g[8]=x*I+y*D+w*R,g[9]=p*I+o*D+_*R,g[10]=v*I+m*D+h*R,g[11]=f*I+l*D+b*R,S!==g&&(g[12]=S[12],g[13]=S[13],g[14]=S[14],g[15]=S[15]),g)}},{}],218:[function(d,ee,te){ee.exports=A;function A(g,S,M){var e=Math.sin(M),a=Math.cos(M),n=S[4],r=S[5],t=S[6],c=S[7],s=S[8],i=S[9],x=S[10],p=S[11];return S!==g&&(g[0]=S[0],g[1]=S[1],g[2]=S[2],g[3]=S[3],g[12]=S[12],g[13]=S[13],g[14]=S[14],g[15]=S[15]),g[4]=n*a+s*e,g[5]=r*a+i*e,g[6]=t*a+x*e,g[7]=c*a+p*e,g[8]=s*a-n*e,g[9]=i*a-r*e,g[10]=x*a-t*e,g[11]=p*a-c*e,g}},{}],219:[function(d,ee,te){ee.exports=A;function A(g,S,M){var e=Math.sin(M),a=Math.cos(M),n=S[0],r=S[1],t=S[2],c=S[3],s=S[8],i=S[9],x=S[10],p=S[11];return S!==g&&(g[4]=S[4],g[5]=S[5],g[6]=S[6],g[7]=S[7],g[12]=S[12],g[13]=S[13],g[14]=S[14],g[15]=S[15]),g[0]=n*a-s*e,g[1]=r*a-i*e,g[2]=t*a-x*e,g[3]=c*a-p*e,g[8]=n*e+s*a,g[9]=r*e+i*a,g[10]=t*e+x*a,g[11]=c*e+p*a,g}},{}],220:[function(d,ee,te){ee.exports=A;function A(g,S,M){var e=Math.sin(M),a=Math.cos(M),n=S[0],r=S[1],t=S[2],c=S[3],s=S[4],i=S[5],x=S[6],p=S[7];return S!==g&&(g[8]=S[8],g[9]=S[9],g[10]=S[10],g[11]=S[11],g[12]=S[12],g[13]=S[13],g[14]=S[14],g[15]=S[15]),g[0]=n*a+s*e,g[1]=r*a+i*e,g[2]=t*a+x*e,g[3]=c*a+p*e,g[4]=s*a-n*e,g[5]=i*a-r*e,g[6]=x*a-t*e,g[7]=p*a-c*e,g}},{}],221:[function(d,ee,te){ee.exports=A;function A(g,S,M){var e=M[0],a=M[1],n=M[2];return g[0]=S[0]*e,g[1]=S[1]*e,g[2]=S[2]*e,g[3]=S[3]*e,g[4]=S[4]*a,g[5]=S[5]*a,g[6]=S[6]*a,g[7]=S[7]*a,g[8]=S[8]*n,g[9]=S[9]*n,g[10]=S[10]*n,g[11]=S[11]*n,g[12]=S[12],g[13]=S[13],g[14]=S[14],g[15]=S[15],g}},{}],222:[function(d,ee,te){ee.exports=A;function A(g){return"mat4("+g[0]+", "+g[1]+", "+g[2]+", "+g[3]+", "+g[4]+", "+g[5]+", "+g[6]+", "+g[7]+", "+g[8]+", "+g[9]+", "+g[10]+", "+g[11]+", "+g[12]+", "+g[13]+", "+g[14]+", "+g[15]+")"}},{}],223:[function(d,ee,te){ee.exports=A;function A(g,S,M){var e=M[0],a=M[1],n=M[2],r,t,c,s,i,x,p,v,f,y,o,m;return S===g?(g[12]=S[0]*e+S[4]*a+S[8]*n+S[12],g[13]=S[1]*e+S[5]*a+S[9]*n+S[13],g[14]=S[2]*e+S[6]*a+S[10]*n+S[14],g[15]=S[3]*e+S[7]*a+S[11]*n+S[15]):(r=S[0],t=S[1],c=S[2],s=S[3],i=S[4],x=S[5],p=S[6],v=S[7],f=S[8],y=S[9],o=S[10],m=S[11],g[0]=r,g[1]=t,g[2]=c,g[3]=s,g[4]=i,g[5]=x,g[6]=p,g[7]=v,g[8]=f,g[9]=y,g[10]=o,g[11]=m,g[12]=r*e+i*a+f*n+S[12],g[13]=t*e+x*a+y*n+S[13],g[14]=c*e+p*a+o*n+S[14],g[15]=s*e+v*a+m*n+S[15]),g}},{}],224:[function(d,ee,te){ee.exports=A;function A(g,S){if(g===S){var M=S[1],e=S[2],a=S[3],n=S[6],r=S[7],t=S[11];g[1]=S[4],g[2]=S[8],g[3]=S[12],g[4]=M,g[6]=S[9],g[7]=S[13],g[8]=e,g[9]=n,g[11]=S[14],g[12]=a,g[13]=r,g[14]=t}else g[0]=S[0],g[1]=S[4],g[2]=S[8],g[3]=S[12],g[4]=S[1],g[5]=S[5],g[6]=S[9],g[7]=S[13],g[8]=S[2],g[9]=S[6],g[10]=S[10],g[11]=S[14],g[12]=S[3],g[13]=S[7],g[14]=S[11],g[15]=S[15];return g}},{}],225:[function(d,ee,te){var A=d("css-font"),g=d("pick-by-alias"),S=d("regl"),M=d("gl-util/context"),e=d("es6-weak-map"),a=d("color-normalize"),n=d("font-atlas"),r=d("typedarray-pool"),t=d("parse-rect"),c=d("is-plain-obj"),s=d("parse-unit"),i=d("to-px"),x=d("detect-kerning"),p=d("object-assign"),v=d("font-measure"),f=d("flatten-vertex-data"),y=d("bit-twiddle"),o=y.nextPow2,m=new e,l=!1;if(document.body){var w=document.body.appendChild(document.createElement("div"));w.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(w).fontStretch&&(l=!0),document.body.removeChild(w)}var _=function(u){h(u)?(u={regl:u},this.gl=u.regl._gl):this.gl=M(u),this.shader=m.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=u.regl||S({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),m.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(c(u)?u:{})};_.prototype.createShader=function(){var u=this.regl,L=u({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:u.prop("count"),offset:u.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:u.this("sizeBuffer")},width:{offset:0,stride:8,buffer:u.this("sizeBuffer")},char:u.this("charBuffer"),position:u.this("position")},uniforms:{atlasSize:function(k,P){return[P.atlas.width,P.atlas.height]},atlasDim:function(k,P){return[P.atlas.cols,P.atlas.rows]},atlas:function(k,P){return P.atlas.texture},charStep:function(k,P){return P.atlas.step},em:function(k,P){return P.atlas.em},color:u.prop("color"),opacity:u.prop("opacity"),viewport:u.this("viewportArray"),scale:u.this("scale"),align:u.prop("align"),baseline:u.prop("baseline"),translate:u.this("translate"),positionOffset:u.prop("positionOffset")},primitive:"points",viewport:u.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ vec2(positionOffset.x, -positionOffset.y)))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			uniform sampler2D atlas;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`}),T={};return{regl:u,draw:L,atlas:T}},_.prototype.update=function(u){var L=this;if(typeof u=="string")u={text:u};else if(!u)return;u=g(u,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0),u.opacity!=null&&(Array.isArray(u.opacity)?this.opacity=u.opacity.map(function(we){return parseFloat(we)}):this.opacity=parseFloat(u.opacity)),u.viewport!=null&&(this.viewport=t(u.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),u.kerning!=null&&(this.kerning=u.kerning),u.offset!=null&&(typeof u.offset=="number"&&(u.offset=[u.offset,0]),this.positionOffset=f(u.offset)),u.direction&&(this.direction=u.direction),u.range&&(this.range=u.range,this.scale=[1/(u.range[2]-u.range[0]),1/(u.range[3]-u.range[1])],this.translate=[-u.range[0],-u.range[1]]),u.scale&&(this.scale=u.scale),u.translate&&(this.translate=u.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),!this.font.length&&!u.font&&(u.font=_.baseFontSize+"px sans-serif");var T=!1,k=!1;if(u.font&&(Array.isArray(u.font)?u.font:[u.font]).forEach(function(we,ke){if(typeof we=="string")try{we=A.parse(we)}catch{we=A.parse(_.baseFontSize+"px "+we)}else we=A.parse(A.stringify(we));var Xe=A.stringify({size:_.baseFontSize,family:we.family,stretch:l?we.stretch:void 0,variant:we.variant,weight:we.weight,style:we.style}),He=s(we.size),Ie=Math.round(He[0]*i(He[1]));if(Ie!==L.fontSize[ke]&&(k=!0,L.fontSize[ke]=Ie),(!L.font[ke]||Xe!=L.font[ke].baseString)&&(T=!0,L.font[ke]=_.fonts[Xe],!L.font[ke])){var De=we.family.join(", "),Ge=[we.style];we.style!=we.variant&&Ge.push(we.variant),we.variant!=we.weight&&Ge.push(we.weight),l&&we.weight!=we.stretch&&Ge.push(we.stretch),L.font[ke]={baseString:Xe,family:De,weight:we.weight,stretch:we.stretch,style:we.style,variant:we.variant,width:{},kerning:{},metrics:v(De,{origin:"top",fontSize:_.baseFontSize,fontStyle:Ge.join(" ")})},_.fonts[Xe]=L.font[ke]}}),(T||k)&&this.font.forEach(function(we,ke){var Xe=A.stringify({size:L.fontSize[ke],family:we.family,stretch:l?we.stretch:void 0,variant:we.variant,weight:we.weight,style:we.style});if(L.fontAtlas[ke]=L.shader.atlas[Xe],!L.fontAtlas[ke]){var He=we.metrics;L.shader.atlas[Xe]=L.fontAtlas[ke]={fontString:Xe,step:Math.ceil(L.fontSize[ke]*He.bottom*.5)*2,em:L.fontSize[ke],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:L.regl.texture()}}u.text==null&&(u.text=L.text)}),typeof u.text=="string"&&u.position&&u.position.length>2){for(var P=Array(u.position.length*.5),z=0;z<P.length;z++)P[z]=u.text;u.text=P}var I;if(u.text!=null||T){if(this.textOffsets=[0],Array.isArray(u.text)){this.count=u.text[0].length,this.counts=[this.count];for(var D=1;D<u.text.length;D++)this.textOffsets[D]=this.textOffsets[D-1]+u.text[D-1].length,this.count+=u.text[D].length,this.counts.push(u.text[D].length);this.text=u.text.join("")}else this.text=u.text,this.count=this.text.length,this.counts=[this.count];I=[],this.font.forEach(function(we,ke){_.atlasContext.font=we.baseString;for(var Xe=L.fontAtlas[ke],He=0;He<L.text.length;He++){var Ie=L.text.charAt(He);if(Xe.ids[Ie]==null&&(Xe.ids[Ie]=Xe.chars.length,Xe.chars.push(Ie),I.push(Ie)),we.width[Ie]==null&&(we.width[Ie]=_.atlasContext.measureText(Ie).width/_.baseFontSize,L.kerning)){var De=[];for(var Ge in we.width)De.push(Ge+Ie,Ie+Ge);p(we.kerning,x(we.family,{pairs:De}))}}})}if(u.position)if(u.position.length>2){for(var R=!u.position[0].length,O=r.mallocFloat(this.count*2),F=0,N=0;F<this.counts.length;F++){var G=this.counts[F];if(R)for(var K=0;K<G;K++)O[N++]=u.position[F*2],O[N++]=u.position[F*2+1];else for(var W=0;W<G;W++)O[N++]=u.position[F][0],O[N++]=u.position[F][1]}this.position.call?this.position({type:"float",data:O}):this.position=this.regl.buffer({type:"float",data:O}),r.freeFloat(O)}else this.position.destroy&&this.position.destroy(),this.position={constant:u.position};if(u.text||T){var Y=r.mallocUint8(this.count),re=r.mallocFloat(this.count*2);this.textWidth=[];for(var ue=0,j=0;ue<this.counts.length;ue++){for(var q=this.counts[ue],V=this.font[ue]||this.font[0],U=this.fontAtlas[ue]||this.fontAtlas[0],$=0;$<q;$++){var ne=this.text.charAt(j),X=this.text.charAt(j-1);if(Y[j]=U.ids[ne],re[j*2]=V.width[ne],$){var Q=re[j*2-2],ie=re[j*2],se=re[j*2-1],ae=se+Q*.5+ie*.5;if(this.kerning){var oe=V.kerning[X+ne];oe&&(ae+=oe*.001)}re[j*2+1]=ae}else re[j*2+1]=re[j*2]*.5;j++}this.textWidth.push(re.length?re[j*2-2]*.5+re[j*2-1]:0)}u.align||(u.align=this.align),this.charBuffer({data:Y,type:"uint8",usage:"stream"}),this.sizeBuffer({data:re,type:"float",usage:"stream"}),r.freeUint8(Y),r.freeFloat(re),I.length&&this.font.forEach(function(we,ke){var Xe=L.fontAtlas[ke],He=Xe.step,Ie=Math.floor(_.maxAtlasSize/He),De=Math.min(Ie,Xe.chars.length),Ge=Math.ceil(Xe.chars.length/De),ht=o(De*He),Rt=o(Ge*He);Xe.width=ht,Xe.height=Rt,Xe.rows=Ge,Xe.cols=De,Xe.em&&Xe.texture({data:n({canvas:_.atlasCanvas,font:Xe.fontString,chars:Xe.chars,shape:[ht,Rt],step:[He,He]})})})}if(u.align&&(this.align=u.align,this.alignOffset=this.textWidth.map(function(we,ke){var Xe=Array.isArray(L.align)?L.align.length>1?L.align[ke]:L.align[0]:L.align;if(typeof Xe=="number")return Xe;switch(Xe){case"right":case"end":return-we;case"center":case"centre":case"middle":return-we*.5}return 0})),this.baseline==null&&u.baseline==null&&(u.baseline=0),u.baseline!=null&&(this.baseline=u.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(we,ke){var Xe=(L.font[ke]||L.font[0]).metrics,He=0;return He+=Xe.bottom*.5,typeof we=="number"?He+=we-Xe.baseline:He+=-Xe[we],He*=-1,He})),u.color!=null)if(u.color||(u.color="transparent"),typeof u.color=="string"||!isNaN(u.color))this.color=a(u.color,"uint8");else{var be;if(typeof u.color[0]=="number"&&u.color.length>this.counts.length){var ce=u.color.length;be=r.mallocUint8(ce);for(var de=(u.color.subarray||u.color.slice).bind(u.color),ye=0;ye<ce;ye+=4)be.set(a(de(ye,ye+4),"uint8"),ye)}else{var ge=u.color.length;be=r.mallocUint8(ge*4);for(var me=0;me<ge;me++)be.set(a(u.color[me]||0,"uint8"),me*4)}this.color=be}if(u.position||u.text||u.color||u.baseline||u.align||u.font||u.offset||u.opacity){var Ee=this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2;if(Ee){var Pe=Math.max(this.position.length*.5||0,this.color.length*.25||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,this.positionOffset.length*.5||0);this.batch=Array(Pe);for(var Ne=0;Ne<this.batch.length;Ne++)this.batch[Ne]={count:this.counts.length>1?this.counts[Ne]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[Ne]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(Ne*4,Ne*4+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[Ne]:this.opacity,baseline:this.baselineOffset[Ne]!=null?this.baselineOffset[Ne]:this.baselineOffset[0],align:this.align?this.alignOffset[Ne]!=null?this.alignOffset[Ne]:this.alignOffset[0]:0,atlas:this.fontAtlas[Ne]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(Ne*2,Ne*2+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]}},_.prototype.destroy=function(){},_.prototype.kerning=!0,_.prototype.position={constant:new Float32Array(2)},_.prototype.translate=null,_.prototype.scale=null,_.prototype.font=null,_.prototype.text="",_.prototype.positionOffset=[0,0],_.prototype.opacity=1,_.prototype.color=new Uint8Array([0,0,0,255]),_.prototype.alignOffset=[0,0],_.maxAtlasSize=1024,_.atlasCanvas=document.createElement("canvas"),_.atlasContext=_.atlasCanvas.getContext("2d",{alpha:!1}),_.baseFontSize=64,_.fonts={};function h(b){return typeof b=="function"&&b._gl&&b.prop&&b.texture&&b.buffer}ee.exports=_},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:284,"to-px":315,"typedarray-pool":328}],226:[function(d,ee,te){(function(A){(function(){var g=d("pick-by-alias");ee.exports=function(t){if(t?typeof t=="string"&&(t={container:t}):t={},M(t)?t={container:t}:e(t)?t={container:t}:a(t)?t={gl:t}:t=g(t,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),t.pixelRatio||(t.pixelRatio=A.pixelRatio||1),t.gl)return t.gl;if(t.canvas&&(t.container=t.canvas.parentNode),t.container){if(typeof t.container=="string"){var c=document.querySelector(t.container);if(!c)throw Error("Element "+t.container+" is not found");t.container=c}M(t.container)?(t.canvas=t.container,t.container=t.canvas.parentNode):t.canvas||(t.canvas=n(),t.container.appendChild(t.canvas),S(t))}else if(!t.canvas)if(typeof document<"u")t.container=document.body||document.documentElement,t.canvas=n(),t.container.appendChild(t.canvas),S(t);else throw Error("Not DOM environment. Use headless-gl.");return t.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(s){try{t.gl=t.canvas.getContext(s,t.attrs)}catch{}return t.gl}),t.gl};function S(r){if(r.container)if(r.container==document.body)document.body.style.width||(r.canvas.width=r.width||r.pixelRatio*A.innerWidth),document.body.style.height||(r.canvas.height=r.height||r.pixelRatio*A.innerHeight);else{var t=r.container.getBoundingClientRect();r.canvas.width=r.width||t.right-t.left,r.canvas.height=r.height||t.bottom-t.top}}function M(r){return typeof r.getContext=="function"&&"width"in r&&"height"in r}function e(r){return typeof r.nodeName=="string"&&typeof r.appendChild=="function"&&typeof r.getBoundingClientRect=="function"}function a(r){return typeof r.drawArrays=="function"||typeof r.drawElements=="function"}function n(){var r=document.createElement("canvas");return r.style.position="absolute",r.style.top=0,r.style.left=0,r}}).call(this)}).call(this,typeof Mo<"u"?Mo:typeof self<"u"?self:typeof window<"u"?window:{})},{"pick-by-alias":253}],227:[function(d,ee,te){ee.exports=function(A){typeof A=="string"&&(A=[A]);for(var g=[].slice.call(arguments,1),S=[],M=0;M<A.length-1;M++)S.push(A[M],g[M]||"");return S.push(A[M]),S.join("")}},{}],228:[function(d,ee,te){(function(A){(function(){var g=d("is-browser"),S;typeof A.matchMedia=="function"?S=!A.matchMedia("(hover: none)").matches:S=g,ee.exports=S}).call(this)}).call(this,typeof Mo<"u"?Mo:typeof self<"u"?self:typeof window<"u"?window:{})},{"is-browser":232}],229:[function(d,ee,te){var A=d("is-browser");function g(){var S=!1;try{var M=Object.defineProperty({},"passive",{get:function(){S=!0}});window.addEventListener("test",null,M),window.removeEventListener("test",null,M)}catch{S=!1}return S}ee.exports=A&&g()},{"is-browser":232}],230:[function(d,ee,te){te.read=function(A,g,S,M,e){var a,n,r=e*8-M-1,t=(1<<r)-1,c=t>>1,s=-7,i=S?e-1:0,x=S?-1:1,p=A[g+i];for(i+=x,a=p&(1<<-s)-1,p>>=-s,s+=r;s>0;a=a*256+A[g+i],i+=x,s-=8);for(n=a&(1<<-s)-1,a>>=-s,s+=M;s>0;n=n*256+A[g+i],i+=x,s-=8);if(a===0)a=1-c;else{if(a===t)return n?NaN:(p?-1:1)*(1/0);n=n+Math.pow(2,M),a=a-c}return(p?-1:1)*n*Math.pow(2,a-M)},te.write=function(A,g,S,M,e,a){var n,r,t,c=a*8-e-1,s=(1<<c)-1,i=s>>1,x=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=M?0:a-1,v=M?1:-1,f=g<0||g===0&&1/g<0?1:0;for(g=Math.abs(g),isNaN(g)||g===1/0?(r=isNaN(g)?1:0,n=s):(n=Math.floor(Math.log(g)/Math.LN2),g*(t=Math.pow(2,-n))<1&&(n--,t*=2),n+i>=1?g+=x/t:g+=x*Math.pow(2,1-i),g*t>=2&&(n++,t/=2),n+i>=s?(r=0,n=s):n+i>=1?(r=(g*t-1)*Math.pow(2,e),n=n+i):(r=g*Math.pow(2,i-1)*Math.pow(2,e),n=0));e>=8;A[S+p]=r&255,p+=v,r/=256,e-=8);for(n=n<<e|r,c+=e;c>0;A[S+p]=n&255,p+=v,n/=256,c-=8);A[S+p-v]|=f*128}},{}],231:[function(d,ee,te){typeof Object.create=="function"?ee.exports=function(g,S){S&&(g.super_=S,g.prototype=Object.create(S.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}))}:ee.exports=function(g,S){if(S){g.super_=S;var M=function(){};M.prototype=S.prototype,g.prototype=new M,g.prototype.constructor=g}}},{}],232:[function(d,ee,te){ee.exports=!0},{}],233:[function(d,ee,te){ee.exports=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(d,ee,te){ee.exports=S,ee.exports.isMobile=S,ee.exports.default=S;var A=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,g=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function S(M){M||(M={});var e=M.ua;if(!e&&typeof navigator<"u"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var a=M.tablet?g.test(e):A.test(e);return!a&&M.tablet&&M.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(a=!0),a}},{}],235:[function(d,ee,te){ee.exports=function(A){var g=typeof A;return A!==null&&(g==="object"||g==="function")}},{}],236:[function(d,ee,te){var A=Object.prototype.toString;ee.exports=function(g){var S;return A.call(g)==="[object Object]"&&(S=Object.getPrototypeOf(g),S===null||S===Object.getPrototypeOf({}))}},{}],237:[function(d,ee,te){ee.exports=function(A){for(var g=A.length,S,M=0;M<g;M++)if(S=A.charCodeAt(M),(S<9||S>13)&&S!==32&&S!==133&&S!==160&&S!==5760&&S!==6158&&(S<8192||S>8205)&&S!==8232&&S!==8233&&S!==8239&&S!==8287&&S!==8288&&S!==12288&&S!==65279)return!1;return!0}},{}],238:[function(d,ee,te){ee.exports=function(g){return typeof g!="string"?!1:(g=g.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(g)&&/[\dz]$/i.test(g)&&g.length>4))}},{}],239:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?ee.exports=g():(A=A||self,A.mapboxgl=g())})(this,function(){var A,g,S;function M(e,a){if(!A)A=a;else if(!g)g=a;else{var n="var sharedChunk = {}; ("+A+")(sharedChunk); ("+g+")(sharedChunk);",r={};A(r),S=a(r),S.workerUrl=window.URL.createObjectURL(new Blob([n],{type:"text/javascript"}))}}return M(["exports"],function(e){function a(E,C){return C={exports:{}},E(C,C.exports),C.exports}var n="1.10.1",r=t;function t(E,C,B,J){this.cx=3*E,this.bx=3*(B-E)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*C,this.by=3*(J-C)-this.cy,this.ay=1-this.cy-this.by,this.p1x=E,this.p1y=J,this.p2x=B,this.p2y=J}t.prototype.sampleCurveX=function(E){return((this.ax*E+this.bx)*E+this.cx)*E},t.prototype.sampleCurveY=function(E){return((this.ay*E+this.by)*E+this.cy)*E},t.prototype.sampleCurveDerivativeX=function(E){return(3*this.ax*E+2*this.bx)*E+this.cx},t.prototype.solveCurveX=function(E,C){typeof C>"u"&&(C=1e-6);var B,J,he,xe,Te;for(he=E,Te=0;Te<8;Te++){if(xe=this.sampleCurveX(he)-E,Math.abs(xe)<C)return he;var Fe=this.sampleCurveDerivativeX(he);if(Math.abs(Fe)<1e-6)break;he=he-xe/Fe}if(B=0,J=1,he=E,he<B)return B;if(he>J)return J;for(;B<J;){if(xe=this.sampleCurveX(he),Math.abs(xe-E)<C)return he;E>xe?B=he:J=he,he=(J-B)*.5+B}return he},t.prototype.solve=function(E,C){return this.sampleCurveY(this.solveCurveX(E,C))};var c=s;function s(E,C){this.x=E,this.y=C}s.prototype={clone:function(){return new s(this.x,this.y)},add:function(E){return this.clone()._add(E)},sub:function(E){return this.clone()._sub(E)},multByPoint:function(E){return this.clone()._multByPoint(E)},divByPoint:function(E){return this.clone()._divByPoint(E)},mult:function(E){return this.clone()._mult(E)},div:function(E){return this.clone()._div(E)},rotate:function(E){return this.clone()._rotate(E)},rotateAround:function(E,C){return this.clone()._rotateAround(E,C)},matMult:function(E){return this.clone()._matMult(E)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(E){return this.x===E.x&&this.y===E.y},dist:function(E){return Math.sqrt(this.distSqr(E))},distSqr:function(E){var C=E.x-this.x,B=E.y-this.y;return C*C+B*B},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(E){return Math.atan2(this.y-E.y,this.x-E.x)},angleWith:function(E){return this.angleWithSep(E.x,E.y)},angleWithSep:function(E,C){return Math.atan2(this.x*C-this.y*E,this.x*E+this.y*C)},_matMult:function(E){var C=E[0]*this.x+E[1]*this.y,B=E[2]*this.x+E[3]*this.y;return this.x=C,this.y=B,this},_add:function(E){return this.x+=E.x,this.y+=E.y,this},_sub:function(E){return this.x-=E.x,this.y-=E.y,this},_mult:function(E){return this.x*=E,this.y*=E,this},_div:function(E){return this.x/=E,this.y/=E,this},_multByPoint:function(E){return this.x*=E.x,this.y*=E.y,this},_divByPoint:function(E){return this.x/=E.x,this.y/=E.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var E=this.y;return this.y=this.x,this.x=-E,this},_rotate:function(E){var C=Math.cos(E),B=Math.sin(E),J=C*this.x-B*this.y,he=B*this.x+C*this.y;return this.x=J,this.y=he,this},_rotateAround:function(E,C){var B=Math.cos(E),J=Math.sin(E),he=C.x+B*(this.x-C.x)-J*(this.y-C.y),xe=C.y+J*(this.x-C.x)+B*(this.y-C.y);return this.x=he,this.y=xe,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},s.convert=function(E){return E instanceof s?E:Array.isArray(E)?new s(E[0],E[1]):E};function i(E,C){if(Array.isArray(E)){if(!Array.isArray(C)||E.length!==C.length)return!1;for(var B=0;B<E.length;B++)if(!i(E[B],C[B]))return!1;return!0}if(typeof E=="object"&&E!==null&&C!==null){if(typeof C!="object")return!1;var J=Object.keys(E);if(J.length!==Object.keys(C).length)return!1;for(var he in E)if(!i(E[he],C[he]))return!1;return!0}return E===C}function x(E){if(E<=0)return 0;if(E>=1)return 1;var C=E*E,B=C*E;return 4*(E<.5?B:3*(E-C)+B-.75)}function p(E,C,B,J){var he=new r(E,C,B,J);return function(xe){return he.solve(xe)}}var v=p(.25,.1,.25,1);function f(E,C,B){return Math.min(B,Math.max(C,E))}function y(E,C,B){var J=B-C,he=((E-C)%J+J)%J+C;return he===C?B:he}function o(E,C,B){if(!E.length)return B(null,[]);var J=E.length,he=new Array(E.length),xe=null;E.forEach(function(Te,Fe){C(Te,function(qe,ft){qe&&(xe=qe),he[Fe]=ft,--J===0&&B(xe,he)})})}function m(E){var C=[];for(var B in E)C.push(E[B]);return C}function l(E,C){var B=[];for(var J in E)J in C||B.push(J);return B}function w(E){for(var C=[],B=arguments.length-1;B-- >0;)C[B]=arguments[B+1];for(var J=0,he=C;J<he.length;J+=1){var xe=he[J];for(var Te in xe)E[Te]=xe[Te]}return E}function _(E,C){for(var B={},J=0;J<C.length;J++){var he=C[J];he in E&&(B[he]=E[he])}return B}var h=1;function b(){return h++}function u(){function E(C){return C?(C^Math.random()*16>>C/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,E)}return E()}function L(E){return E?/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(E):!1}function T(E,C){E.forEach(function(B){!C[B]||(C[B]=C[B].bind(C))})}function k(E,C){return E.indexOf(C,E.length-C.length)!==-1}function P(E,C,B){var J={};for(var he in E)J[he]=C.call(B||this,E[he],he,E);return J}function z(E,C,B){var J={};for(var he in E)C.call(B||this,E[he],he,E)&&(J[he]=E[he]);return J}function I(E){return Array.isArray(E)?E.map(I):typeof E=="object"&&E?P(E,I):E}function D(E,C){for(var B=0;B<E.length;B++)if(C.indexOf(E[B])>=0)return!0;return!1}var R={};function O(E){R[E]||(typeof console<"u"&&console.warn(E),R[E]=!0)}function F(E,C,B){return(B.y-E.y)*(C.x-E.x)>(C.y-E.y)*(B.x-E.x)}function N(E){for(var C=0,B=0,J=E.length,he=J-1,xe=void 0,Te=void 0;B<J;he=B++)xe=E[B],Te=E[he],C+=(Te.x-xe.x)*(xe.y+Te.y);return C}function G(E){var C=E[0],B=E[1],J=E[2];return B+=90,B*=Math.PI/180,J*=Math.PI/180,{x:C*Math.cos(B)*Math.sin(J),y:C*Math.sin(B)*Math.sin(J),z:C*Math.cos(J)}}function K(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function W(E){var C=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,B={};if(E.replace(C,function(he,xe,Te,Fe){var qe=Te||Fe;return B[xe]=qe?qe.toLowerCase():!0,""}),B["max-age"]){var J=parseInt(B["max-age"],10);isNaN(J)?delete B["max-age"]:B["max-age"]=J}return B}var Y=null;function re(E){if(Y==null){var C=E.navigator?E.navigator.userAgent:null;Y=!!E.safari||!!(C&&(/\b(iPad|iPhone|iPod)\b/.test(C)||!!C.match("Safari")&&!C.match("Chrome")))}return Y}function ue(E){try{var C=self[E];return C.setItem("_mapbox_test_",1),C.removeItem("_mapbox_test_"),!0}catch{return!1}}function j(E){return self.btoa(encodeURIComponent(E).replace(/%([0-9A-F]{2})/g,function(C,B){return String.fromCharCode(Number("0x"+B))}))}function q(E){return decodeURIComponent(self.atob(E).split("").map(function(C){return"%"+("00"+C.charCodeAt(0).toString(16)).slice(-2)}).join(""))}var V=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),U=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,$=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,ne,X,Q={now:V,frame:function(C){var B=U(C);return{cancel:function(){return $(B)}}},getImageData:function(C,B){B===void 0&&(B=0);var J=self.document.createElement("canvas"),he=J.getContext("2d");if(!he)throw new Error("failed to create canvas 2d context");return J.width=C.width,J.height=C.height,he.drawImage(C,0,0,C.width,C.height),he.getImageData(-B,-B,C.width+2*B,C.height+2*B)},resolveURL:function(C){return ne||(ne=self.document.createElement("a")),ne.href=C,ne.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return self.matchMedia?(X==null&&(X=self.matchMedia("(prefers-reduced-motion: reduce)")),X.matches):!1}},ie={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},se={supported:!1,testSupport:de},ae,oe=!1,be,ce=!1;self.document&&(be=self.document.createElement("img"),be.onload=function(){ae&&ye(ae),ae=null,ce=!0},be.onerror=function(){oe=!0,ae=null},be.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");function de(E){oe||!be||(ce?ye(E):ae=E)}function ye(E){var C=E.createTexture();E.bindTexture(E.TEXTURE_2D,C);try{if(E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,be),E.isContextLost())return;se.supported=!0}catch{}E.deleteTexture(C),oe=!0}var ge="01";function me(){for(var E="1",C="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",B="",J=0;J<10;J++)B+=C[Math.floor(Math.random()*62)];var he=12*60*60*1e3,xe=[E,ge,B].join(""),Te=Date.now()+he;return{token:xe,tokenExpiresAt:Te}}var Ee=function(C,B){this._transformRequestFn=C,this._customAccessToken=B,this._createSkuToken()};Ee.prototype._createSkuToken=function(){var C=me();this._skuToken=C.token,this._skuTokenExpiresAt=C.tokenExpiresAt},Ee.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Ee.prototype.transformRequest=function(C,B){return this._transformRequestFn?this._transformRequestFn(C,B)||{url:C}:{url:C}},Ee.prototype.normalizeStyleURL=function(C,B){if(!Pe(C))return C;var J=Ie(C);return J.path="/styles/v1"+J.path,this._makeAPIURL(J,this._customAccessToken||B)},Ee.prototype.normalizeGlyphsURL=function(C,B){if(!Pe(C))return C;var J=Ie(C);return J.path="/fonts/v1"+J.path,this._makeAPIURL(J,this._customAccessToken||B)},Ee.prototype.normalizeSourceURL=function(C,B){if(!Pe(C))return C;var J=Ie(C);return J.path="/v4/"+J.authority+".json",J.params.push("secure"),this._makeAPIURL(J,this._customAccessToken||B)},Ee.prototype.normalizeSpriteURL=function(C,B,J,he){var xe=Ie(C);return Pe(C)?(xe.path="/styles/v1"+xe.path+"/sprite"+B+J,this._makeAPIURL(xe,this._customAccessToken||he)):(xe.path+=""+B+J,De(xe))},Ee.prototype.normalizeTileURL=function(C,B){if(this._isSkuTokenExpired()&&this._createSkuToken(),C&&!Pe(C))return C;var J=Ie(C),he=/(\.(png|jpg)\d*)(?=$)/,xe=/^.+\/v4\//,Te=Q.devicePixelRatio>=2||B===512?"@2x":"",Fe=se.supported?".webp":"$1";J.path=J.path.replace(he,""+Te+Fe),J.path=J.path.replace(xe,"/"),J.path="/v4"+J.path;var qe=this._customAccessToken||Xe(J.params)||ie.ACCESS_TOKEN;return ie.REQUIRE_ACCESS_TOKEN&&qe&&this._skuToken&&J.params.push("sku="+this._skuToken),this._makeAPIURL(J,qe)},Ee.prototype.canonicalizeTileURL=function(C,B){var J="/v4/",he=/\.[\w]+$/,xe=Ie(C);if(!xe.path.match(/(^\/v4\/)/)||!xe.path.match(he))return C;var Te="mapbox://tiles/";Te+=xe.path.replace(J,"");var Fe=xe.params;return B&&(Fe=Fe.filter(function(qe){return!qe.match(/^access_token=/)})),Fe.length&&(Te+="?"+Fe.join("&")),Te},Ee.prototype.canonicalizeTileset=function(C,B){for(var J=B?Pe(B):!1,he=[],xe=0,Te=C.tiles||[];xe<Te.length;xe+=1){var Fe=Te[xe];we(Fe)?he.push(this.canonicalizeTileURL(Fe,J)):he.push(Fe)}return he},Ee.prototype._makeAPIURL=function(C,B){var J="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",he=Ie(ie.API_URL);if(C.protocol=he.protocol,C.authority=he.authority,he.path!=="/"&&(C.path=""+he.path+C.path),!ie.REQUIRE_ACCESS_TOKEN)return De(C);if(B=B||ie.ACCESS_TOKEN,!B)throw new Error("An API access token is required to use Mapbox GL. "+J);if(B[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+J);return C.params=C.params.filter(function(xe){return xe.indexOf("access_token")===-1}),C.params.push("access_token="+B),De(C)};function Pe(E){return E.indexOf("mapbox:")===0}var Ne=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function we(E){return Ne.test(E)}function ke(E){return E.indexOf("sku=")>0&&we(E)}function Xe(E){for(var C=0,B=E;C<B.length;C+=1){var J=B[C],he=J.match(/^access_token=(.*)$/);if(he)return he[1]}return null}var He=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ie(E){var C=E.match(He);if(!C)throw new Error("Unable to parse URL object");return{protocol:C[1],authority:C[2],path:C[3]||"/",params:C[4]?C[4].split("&"):[]}}function De(E){var C=E.params.length?"?"+E.params.join("&"):"";return E.protocol+"://"+E.authority+E.path+C}var Ge="mapbox.eventData";function ht(E){if(!E)return null;var C=E.split(".");if(!C||C.length!==3)return null;try{var B=JSON.parse(q(C[1]));return B}catch{return null}}var Rt=function(C){this.type=C,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Rt.prototype.getStorageKey=function(C){var B=ht(ie.ACCESS_TOKEN),J="";return B&&B.u?J=j(B.u):J=ie.ACCESS_TOKEN||"",C?Ge+"."+C+":"+J:Ge+":"+J},Rt.prototype.fetchEventData=function(){var C=ue("localStorage"),B=this.getStorageKey(),J=this.getStorageKey("uuid");if(C)try{var he=self.localStorage.getItem(B);he&&(this.eventData=JSON.parse(he));var xe=self.localStorage.getItem(J);xe&&(this.anonId=xe)}catch{O("Unable to read from LocalStorage")}},Rt.prototype.saveEventData=function(){var C=ue("localStorage"),B=this.getStorageKey(),J=this.getStorageKey("uuid");if(C)try{self.localStorage.setItem(J,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(B,JSON.stringify(this.eventData))}catch{O("Unable to write to LocalStorage")}},Rt.prototype.processRequests=function(C){},Rt.prototype.postEvent=function(C,B,J,he){var xe=this;if(!!ie.EVENTS_URL){var Te=Ie(ie.EVENTS_URL);Te.params.push("access_token="+(he||ie.ACCESS_TOKEN||""));var Fe={event:this.type,created:new Date(C).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:n,skuId:ge,userId:this.anonId},qe=B?w(Fe,B):Fe,ft={url:De(Te),headers:{"Content-Type":"text/plain"},body:JSON.stringify([qe])};this.pendingRequest=Tt(ft,function(pt){xe.pendingRequest=null,J(pt),xe.saveEventData(),xe.processRequests(he)})}},Rt.prototype.queueRequest=function(C,B){this.queue.push(C),this.processRequests(B)};var Kt=function(E){function C(){E.call(this,"map.load"),this.success={},this.skuToken=""}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.postMapLoadEvent=function(J,he,xe,Te){this.skuToken=xe,(ie.EVENTS_URL&&Te||ie.ACCESS_TOKEN&&Array.isArray(J)&&J.some(function(Fe){return Pe(Fe)||we(Fe)}))&&this.queueRequest({id:he,timestamp:Date.now()},Te)},C.prototype.processRequests=function(J){var he=this;if(!(this.pendingRequest||this.queue.length===0)){var xe=this.queue.shift(),Te=xe.id,Fe=xe.timestamp;Te&&this.success[Te]||(this.anonId||this.fetchEventData(),L(this.anonId)||(this.anonId=u()),this.postEvent(Fe,{skuToken:this.skuToken},function(qe){qe||Te&&(he.success[Te]=!0)},J))}},C}(Rt),It=function(E){function C(B){E.call(this,"appUserTurnstile"),this._customAccessToken=B}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.postTurnstileEvent=function(J,he){ie.EVENTS_URL&&ie.ACCESS_TOKEN&&Array.isArray(J)&&J.some(function(xe){return Pe(xe)||we(xe)})&&this.queueRequest(Date.now(),he)},C.prototype.processRequests=function(J){var he=this;if(!(this.pendingRequest||this.queue.length===0)){(!this.anonId||!this.eventData.lastSuccess||!this.eventData.tokenU)&&this.fetchEventData();var xe=ht(ie.ACCESS_TOKEN),Te=xe?xe.u:ie.ACCESS_TOKEN,Fe=Te!==this.eventData.tokenU;L(this.anonId)||(this.anonId=u(),Fe=!0);var qe=this.queue.shift();if(this.eventData.lastSuccess){var ft=new Date(this.eventData.lastSuccess),pt=new Date(qe),Ft=(qe-this.eventData.lastSuccess)/(24*60*60*1e3);Fe=Fe||Ft>=1||Ft<-1||ft.getDate()!==pt.getDate()}else Fe=!0;if(!Fe)return this.processRequests();this.postEvent(qe,{"enabled.telemetry":!1},function(tr){tr||(he.eventData.lastSuccess=qe,he.eventData.tokenU=Te)},J)}},C}(Rt),Mt=new It,Yt=Mt.postTurnstileEvent.bind(Mt),zt=new Kt,St=zt.postMapLoadEvent.bind(zt),Ye="mapbox-tiles",rt=500,Ve=50,Ae=1e3*60*7,Ue;function Ze(){self.caches&&!Ue&&(Ue=self.caches.open(Ye))}var Qe;function _t(E,C){if(Qe===void 0)try{new Response(new ReadableStream),Qe=!0}catch{Qe=!1}Qe?C(E.body):E.blob().then(C)}function gt(E,C,B){if(Ze(),!!Ue){var J={status:C.status,statusText:C.statusText,headers:new self.Headers};C.headers.forEach(function(Te,Fe){return J.headers.set(Fe,Te)});var he=W(C.headers.get("Cache-Control")||"");if(!he["no-store"]){he["max-age"]&&J.headers.set("Expires",new Date(B+he["max-age"]*1e3).toUTCString());var xe=new Date(J.headers.get("Expires")).getTime()-B;xe<Ae||_t(C,function(Te){var Fe=new self.Response(Te,J);Ze(),Ue&&Ue.then(function(qe){return qe.put(wt(E.url),Fe)}).catch(function(qe){return O(qe.message)})})}}}function wt(E){var C=E.indexOf("?");return C<0?E:E.slice(0,C)}function Ut(E,C){if(Ze(),!Ue)return C(null);var B=wt(E.url);Ue.then(function(J){J.match(B).then(function(he){var xe=Dt(he);J.delete(B),xe&&J.put(B,he.clone()),C(null,he,xe)}).catch(C)}).catch(C)}function Dt(E){if(!E)return!1;var C=new Date(E.headers.get("Expires")||0),B=W(E.headers.get("Cache-Control")||"");return C>Date.now()&&!B["no-cache"]}var Nt=1/0;function Xt(E){Nt++,Nt>Ve&&(E.getActor().send("enforceCacheSizeLimit",rt),Nt=0)}function Ht(E){Ze(),Ue&&Ue.then(function(C){C.keys().then(function(B){for(var J=0;J<B.length-E;J++)C.delete(B[J])})})}function ar(E){var C=self.caches.delete(Ye);E&&C.catch(E).then(function(){return E()})}function Vr(E,C){rt=E,Ve=C}var nn;function jr(){return nn==null&&(nn=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),nn}var at={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(at);var $t=function(E){function C(B,J,he){J===401&&we(he)&&(B+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),E.call(this,B),this.status=J,this.url=he,this.name=this.constructor.name,this.message=B}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},C}(Error),Zt=K()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href},ur=function(E){return/^file:/.test(E)||/^file:/.test(Zt())&&!/^\w+:/.test(E)};function wr(E,C){var B=new self.AbortController,J=new self.Request(E.url,{method:E.method||"GET",body:E.body,credentials:E.credentials,headers:E.headers,referrer:Zt(),signal:B.signal}),he=!1,xe=!1,Te=ke(J.url);E.type==="json"&&J.headers.set("Accept","application/json");var Fe=function(ft,pt,Ft){if(!xe){if(ft&&ft.message!=="SecurityError"&&O(ft),pt&&Ft)return qe(pt);var tr=Date.now();self.fetch(J).then(function(Qt){if(Qt.ok){var dr=Te?Qt.clone():null;return qe(Qt,dr,tr)}else return C(new $t(Qt.statusText,Qt.status,E.url))}).catch(function(Qt){Qt.code!==20&&C(new Error(Qt.message))})}},qe=function(ft,pt,Ft){(E.type==="arrayBuffer"?ft.arrayBuffer():E.type==="json"?ft.json():ft.text()).then(function(tr){xe||(pt&&Ft&&gt(J,pt,Ft),he=!0,C(null,tr,ft.headers.get("Cache-Control"),ft.headers.get("Expires")))}).catch(function(tr){xe||C(new Error(tr.message))})};return Te?Ut(J,Fe):Fe(null,null),{cancel:function(){xe=!0,he||B.abort()}}}function $e(E,C){var B=new self.XMLHttpRequest;B.open(E.method||"GET",E.url,!0),E.type==="arrayBuffer"&&(B.responseType="arraybuffer");for(var J in E.headers)B.setRequestHeader(J,E.headers[J]);return E.type==="json"&&(B.responseType="text",B.setRequestHeader("Accept","application/json")),B.withCredentials=E.credentials==="include",B.onerror=function(){C(new Error(B.statusText))},B.onload=function(){if((B.status>=200&&B.status<300||B.status===0)&&B.response!==null){var he=B.response;if(E.type==="json")try{he=JSON.parse(B.response)}catch(xe){return C(xe)}C(null,he,B.getResponseHeader("Cache-Control"),B.getResponseHeader("Expires"))}else C(new $t(B.statusText,B.status,E.url))},B.send(E.body),{cancel:function(){return B.abort()}}}var Je=function(E,C){if(!ur(E.url)){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return wr(E,C);if(K()&&self.worker&&self.worker.actor){var B=!0;return self.worker.actor.send("getResource",E,C,void 0,B)}}return $e(E,C)},it=function(E,C){return Je(w(E,{type:"json"}),C)},lt=function(E,C){return Je(w(E,{type:"arrayBuffer"}),C)},Tt=function(E,C){return Je(w(E,{method:"POST"}),C)};function Bt(E){var C=self.document.createElement("a");return C.href=E,C.protocol===self.document.location.protocol&&C.host===self.document.location.host}var Ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Me(E,C,B,J){var he=new self.Image,xe=self.URL;he.onload=function(){C(null,he),xe.revokeObjectURL(he.src)},he.onerror=function(){return C(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Te=new self.Blob([new Uint8Array(E)],{type:"image/png"});he.cacheControl=B,he.expires=J,he.src=E.byteLength?xe.createObjectURL(Te):Ce}function nt(E,C){var B=new self.Blob([new Uint8Array(E)],{type:"image/png"});self.createImageBitmap(B).then(function(J){C(null,J)}).catch(function(J){C(new Error("Could not load image because of "+J.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}var st,ct,At=function(){st=[],ct=0};At();var dt=function(E,C){if(se.supported&&(E.headers||(E.headers={}),E.headers.accept="image/webp,*/*"),ct>=ie.MAX_PARALLEL_IMAGE_REQUESTS){var B={requestParameters:E,callback:C,cancelled:!1,cancel:function(){this.cancelled=!0}};return st.push(B),B}ct++;var J=!1,he=function(){if(!J)for(J=!0,ct--;st.length&&ct<ie.MAX_PARALLEL_IMAGE_REQUESTS;){var Te=st.shift(),Fe=Te.requestParameters,qe=Te.callback,ft=Te.cancelled;ft||(Te.cancel=dt(Fe,qe).cancel)}},xe=lt(E,function(Te,Fe,qe,ft){he(),Te?C(Te):Fe&&(jr()?nt(Fe,C):Me(Fe,C,qe,ft))});return{cancel:function(){xe.cancel(),he()}}},Ct=function(E,C){var B=self.document.createElement("video");B.muted=!0,B.onloadstart=function(){C(null,B)};for(var J=0;J<E.length;J++){var he=self.document.createElement("source");Bt(E[J])||(B.crossOrigin="Anonymous"),he.src=E[J],B.appendChild(he)}return{cancel:function(){}}};function Gt(E,C,B){var J=B[E]&&B[E].indexOf(C)!==-1;J||(B[E]=B[E]||[],B[E].push(C))}function rr(E,C,B){if(B&&B[E]){var J=B[E].indexOf(C);J!==-1&&B[E].splice(J,1)}}var kr=function(C,B){B===void 0&&(B={}),w(this,B),this.type=C},br=function(E){function C(B,J){J===void 0&&(J={}),E.call(this,"error",w({error:B},J))}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(kr),Ar=function(){};Ar.prototype.on=function(C,B){return this._listeners=this._listeners||{},Gt(C,B,this._listeners),this},Ar.prototype.off=function(C,B){return rr(C,B,this._listeners),rr(C,B,this._oneTimeListeners),this},Ar.prototype.once=function(C,B){return this._oneTimeListeners=this._oneTimeListeners||{},Gt(C,B,this._oneTimeListeners),this},Ar.prototype.fire=function(C,B){typeof C=="string"&&(C=new kr(C,B||{}));var J=C.type;if(this.listens(J)){C.target=this;for(var he=this._listeners&&this._listeners[J]?this._listeners[J].slice():[],xe=0,Te=he;xe<Te.length;xe+=1){var Fe=Te[xe];Fe.call(this,C)}for(var qe=this._oneTimeListeners&&this._oneTimeListeners[J]?this._oneTimeListeners[J].slice():[],ft=0,pt=qe;ft<pt.length;ft+=1){var Ft=pt[ft];rr(J,Ft,this._oneTimeListeners),Ft.call(this,C)}var tr=this._eventedParent;tr&&(w(C,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),tr.fire(C))}else C instanceof br&&console.error(C.error);return this},Ar.prototype.listens=function(C){return this._listeners&&this._listeners[C]&&this._listeners[C].length>0||this._oneTimeListeners&&this._oneTimeListeners[C]&&this._oneTimeListeners[C].length>0||this._eventedParent&&this._eventedParent.listens(C)},Ar.prototype.setEventedParent=function(C,B){return this._eventedParent=C,this._eventedParentData=B,this};var Wr=8,nr={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},yr={"*":{type:"source"}},Pr=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],Or={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},Sr={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},tt={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},Lt={type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Wt={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},ir={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Ir={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Br=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Er={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},_r={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Gr={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},wn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},cn={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Bn={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},En={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Yn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Hn={type:"array",value:"*"},pa={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},Ma={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},ci={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},Ha={type:"array",value:"*",minimum:1},ja={type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},Wa={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},Tr=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],pn={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},fn={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},An={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},Zn={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ua={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},ea={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Rn={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Xn={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Ua={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},li={"*":{type:"string"}},Vt={$version:Wr,$root:nr,sources:yr,source:Pr,source_vector:Or,source_raster:Sr,source_raster_dem:tt,source_geojson:Lt,source_video:Wt,source_image:ir,layer:Ir,layout:Br,layout_background:Er,layout_fill:_r,layout_circle:Gr,layout_heatmap:wn,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:cn,layout_symbol:Bn,layout_raster:En,layout_hillshade:Yn,filter:Hn,filter_operator:pa,geometry_type:Ma,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:ci,expression:Ha,expression_name:ja,light:Wa,paint:Tr,paint_fill:pn,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:fn,paint_circle:An,paint_heatmap:Zn,paint_symbol:ua,paint_raster:ea,paint_hillshade:Rn,paint_background:Xn,transition:Ua,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:li},hr=function(C,B,J,he){this.message=(C?C+": ":"")+J,he&&(this.identifier=he),B!=null&&B.__line__&&(this.line=B.__line__)};function rn(E){var C=E.key,B=E.value;return B?[new hr(C,B,"constants have been deprecated as of v8")]:[]}function vn(E){for(var C=[],B=arguments.length-1;B-- >0;)C[B]=arguments[B+1];for(var J=0,he=C;J<he.length;J+=1){var xe=he[J];for(var Te in xe)E[Te]=xe[Te]}return E}function en(E){return E instanceof Number||E instanceof String||E instanceof Boolean?E.valueOf():E}function Tn(E){if(Array.isArray(E))return E.map(Tn);if(E instanceof Object&&!(E instanceof Number||E instanceof String||E instanceof Boolean)){var C={};for(var B in E)C[B]=Tn(E[B]);return C}return en(E)}var xn=function(E){function C(B,J){E.call(this,J),this.message=J,this.key=B}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(Error),un=function(C,B){B===void 0&&(B=[]),this.parent=C,this.bindings={};for(var J=0,he=B;J<he.length;J+=1){var xe=he[J],Te=xe[0],Fe=xe[1];this.bindings[Te]=Fe}};un.prototype.concat=function(C){return new un(this,C)},un.prototype.get=function(C){if(this.bindings[C])return this.bindings[C];if(this.parent)return this.parent.get(C);throw new Error(C+" not found in scope.")},un.prototype.has=function(C){return this.bindings[C]?!0:this.parent?this.parent.has(C):!1};var gr={kind:"null"},mr={kind:"number"},zr={kind:"string"},gn={kind:"boolean"},On={kind:"color"},ta={kind:"object"},_n={kind:"value"},jn={kind:"error"},aa={kind:"collator"},da={kind:"formatted"},ma={kind:"resolvedImage"};function sa(E,C){return{kind:"array",itemType:E,N:C}}function Aa(E){if(E.kind==="array"){var C=Aa(E.itemType);return typeof E.N=="number"?"array<"+C+", "+E.N+">":E.itemType.kind==="value"?"array":"array<"+C+">"}else return E.kind}var po=[gr,mr,zr,gn,On,da,ta,sa(_n),ma];function zo(E,C){if(C.kind==="error")return null;if(E.kind==="array"){if(C.kind==="array"&&(C.N===0&&C.itemType.kind==="value"||!zo(E.itemType,C.itemType))&&(typeof E.N!="number"||E.N===C.N))return null}else{if(E.kind===C.kind)return null;if(E.kind==="value")for(var B=0,J=po;B<J.length;B+=1){var he=J[B];if(!zo(he,C))return null}}return"Expected "+Aa(E)+" but found "+Aa(C)+" instead."}function Ko(E,C){return C.some(function(B){return B.kind===E.kind})}function nl(E,C){return C.some(function(B){return B==="null"?E===null:B==="array"?Array.isArray(E):B==="object"?E&&!Array.isArray(E)&&typeof E=="object":B===typeof E})}var pl=a(function(E,C){var B={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function J(ft){return ft=Math.round(ft),ft<0?0:ft>255?255:ft}function he(ft){return ft<0?0:ft>1?1:ft}function xe(ft){return ft[ft.length-1]==="%"?J(parseFloat(ft)/100*255):J(parseInt(ft))}function Te(ft){return ft[ft.length-1]==="%"?he(parseFloat(ft)/100):he(parseFloat(ft))}function Fe(ft,pt,Ft){return Ft<0?Ft+=1:Ft>1&&(Ft-=1),Ft*6<1?ft+(pt-ft)*Ft*6:Ft*2<1?pt:Ft*3<2?ft+(pt-ft)*(2/3-Ft)*6:ft}function qe(ft){var pt=ft.replace(/ /g,"").toLowerCase();if(pt in B)return B[pt].slice();if(pt[0]==="#"){if(pt.length===4){var Ft=parseInt(pt.substr(1),16);return Ft>=0&&Ft<=4095?[(Ft&3840)>>4|(Ft&3840)>>8,Ft&240|(Ft&240)>>4,Ft&15|(Ft&15)<<4,1]:null}else if(pt.length===7){var Ft=parseInt(pt.substr(1),16);return Ft>=0&&Ft<=16777215?[(Ft&16711680)>>16,(Ft&65280)>>8,Ft&255,1]:null}return null}var tr=pt.indexOf("("),Qt=pt.indexOf(")");if(tr!==-1&&Qt+1===pt.length){var dr=pt.substr(0,tr),Fr=pt.substr(tr+1,Qt-(tr+1)).split(","),on=1;switch(dr){case"rgba":if(Fr.length!==4)return null;on=Te(Fr.pop());case"rgb":return Fr.length!==3?null:[xe(Fr[0]),xe(Fr[1]),xe(Fr[2]),on];case"hsla":if(Fr.length!==4)return null;on=Te(Fr.pop());case"hsl":if(Fr.length!==3)return null;var $r=(parseFloat(Fr[0])%360+360)%360/360,kn=Te(Fr[1]),mn=Te(Fr[2]),Sn=mn<=.5?mn*(kn+1):mn+kn-mn*kn,In=mn*2-Sn;return[J(Fe(In,Sn,$r+1/3)*255),J(Fe(In,Sn,$r)*255),J(Fe(In,Sn,$r-1/3)*255),on];default:return null}}return null}try{C.parseCSSColor=qe}catch{}}),Yl=pl.parseCSSColor,vi=function(C,B,J,he){he===void 0&&(he=1),this.r=C,this.g=B,this.b=J,this.a=he};vi.parse=function(C){if(!!C){if(C instanceof vi)return C;if(typeof C=="string"){var B=Yl(C);if(!!B)return new vi(B[0]/255*B[3],B[1]/255*B[3],B[2]/255*B[3],B[3])}}},vi.prototype.toString=function(){var C=this.toArray(),B=C[0],J=C[1],he=C[2],xe=C[3];return"rgba("+Math.round(B)+","+Math.round(J)+","+Math.round(he)+","+xe+")"},vi.prototype.toArray=function(){var C=this,B=C.r,J=C.g,he=C.b,xe=C.a;return xe===0?[0,0,0,0]:[B*255/xe,J*255/xe,he*255/xe,xe]},vi.black=new vi(0,0,0,1),vi.white=new vi(1,1,1,1),vi.transparent=new vi(0,0,0,0),vi.red=new vi(1,0,0,1);var Gs=function(C,B,J){C?this.sensitivity=B?"variant":"case":this.sensitivity=B?"accent":"base",this.locale=J,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Gs.prototype.compare=function(C,B){return this.collator.compare(C,B)},Gs.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Rs=function(C,B,J,he,xe){this.text=C,this.image=B,this.scale=J,this.fontStack=he,this.textColor=xe},Hi=function(C){this.sections=C};Hi.fromString=function(C){return new Hi([new Rs(C,null,null,null,null)])},Hi.prototype.isEmpty=function(){return this.sections.length===0?!0:!this.sections.some(function(C){return C.text.length!==0||C.image&&C.image.name.length!==0})},Hi.factory=function(C){return C instanceof Hi?C:Hi.fromString(C)},Hi.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(C){return C.text}).join("")},Hi.prototype.serialize=function(){for(var C=["format"],B=0,J=this.sections;B<J.length;B+=1){var he=J[B];if(he.image){C.push(["image",he.image.name]);continue}C.push(he.text);var xe={};he.fontStack&&(xe["text-font"]=["literal",he.fontStack.split(",")]),he.scale&&(xe["font-scale"]=he.scale),he.textColor&&(xe["text-color"]=["rgba"].concat(he.textColor.toArray())),C.push(xe)}return C};var So=function(C){this.name=C.name,this.available=C.available};So.prototype.toString=function(){return this.name},So.fromString=function(C){return C?new So({name:C,available:!1}):null},So.prototype.serialize=function(){return["image",this.name]};function dl(E,C,B,J){if(!(typeof E=="number"&&E>=0&&E<=255&&typeof C=="number"&&C>=0&&C<=255&&typeof B=="number"&&B>=0&&B<=255)){var he=typeof J=="number"?[E,C,B,J]:[E,C,B];return"Invalid rgba value ["+he.join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}return typeof J>"u"||typeof J=="number"&&J>=0&&J<=1?null:"Invalid rgba value ["+[E,C,B,J].join(", ")+"]: 'a' must be between 0 and 1."}function ps(E){if(E===null)return!0;if(typeof E=="string")return!0;if(typeof E=="boolean")return!0;if(typeof E=="number")return!0;if(E instanceof vi)return!0;if(E instanceof Gs)return!0;if(E instanceof Hi)return!0;if(E instanceof So)return!0;if(Array.isArray(E)){for(var C=0,B=E;C<B.length;C+=1){var J=B[C];if(!ps(J))return!1}return!0}else if(typeof E=="object"){for(var he in E)if(!ps(E[he]))return!1;return!0}else return!1}function Di(E){if(E===null)return gr;if(typeof E=="string")return zr;if(typeof E=="boolean")return gn;if(typeof E=="number")return mr;if(E instanceof vi)return On;if(E instanceof Gs)return aa;if(E instanceof Hi)return da;if(E instanceof So)return ma;if(Array.isArray(E)){for(var C=E.length,B,J=0,he=E;J<he.length;J+=1){var xe=he[J],Te=Di(xe);if(!B)B=Te;else{if(B===Te)continue;B=_n;break}}return sa(B||_n,C)}else return ta}function al(E){var C=typeof E;return E===null?"":C==="string"||C==="number"||C==="boolean"?String(E):E instanceof vi||E instanceof Hi||E instanceof So?E.toString():JSON.stringify(E)}var Qi=function(C,B){this.type=C,this.value=B};Qi.parse=function(C,B){if(C.length!==2)return B.error("'literal' expression requires exactly one argument, but found "+(C.length-1)+" instead.");if(!ps(C[1]))return B.error("invalid value");var J=C[1],he=Di(J),xe=B.expectedType;return he.kind==="array"&&he.N===0&&xe&&xe.kind==="array"&&(typeof xe.N!="number"||xe.N===0)&&(he=xe),new Qi(he,J)},Qi.prototype.evaluate=function(){return this.value},Qi.prototype.eachChild=function(){},Qi.prototype.outputDefined=function(){return!0},Qi.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof vi?["rgba"].concat(this.value.toArray()):this.value instanceof Hi?this.value.serialize():this.value};var Oi=function(C){this.name="ExpressionEvaluationError",this.message=C};Oi.prototype.toJSON=function(){return this.message};var io={string:zr,number:mr,boolean:gn,object:ta},$i=function(C,B){this.type=C,this.args=B};$i.parse=function(C,B){if(C.length<2)return B.error("Expected at least one argument.");var J=1,he,xe=C[0];if(xe==="array"){var Te;if(C.length>2){var Fe=C[1];if(typeof Fe!="string"||!(Fe in io)||Fe==="object")return B.error('The item type argument of "array" must be one of string, number, boolean',1);Te=io[Fe],J++}else Te=_n;var qe;if(C.length>3){if(C[2]!==null&&(typeof C[2]!="number"||C[2]<0||C[2]!==Math.floor(C[2])))return B.error('The length argument to "array" must be a positive integer literal',2);qe=C[2],J++}he=sa(Te,qe)}else he=io[xe];for(var ft=[];J<C.length;J++){var pt=B.parse(C[J],J,_n);if(!pt)return null;ft.push(pt)}return new $i(he,ft)},$i.prototype.evaluate=function(C){for(var B=0;B<this.args.length;B++){var J=this.args[B].evaluate(C),he=zo(this.type,Di(J));if(he){if(B===this.args.length-1)throw new Oi("Expected value to be of type "+Aa(this.type)+", but found "+Aa(Di(J))+" instead.")}else return J}return null},$i.prototype.eachChild=function(C){this.args.forEach(C)},$i.prototype.outputDefined=function(){return this.args.every(function(C){return C.outputDefined()})},$i.prototype.serialize=function(){var C=this.type,B=[C.kind];if(C.kind==="array"){var J=C.itemType;if(J.kind==="string"||J.kind==="number"||J.kind==="boolean"){B.push(J.kind);var he=C.N;(typeof he=="number"||this.args.length>1)&&B.push(he)}}return B.concat(this.args.map(function(xe){return xe.serialize()}))};var rs=function(C){this.type=da,this.sections=C};rs.parse=function(C,B){if(C.length<2)return B.error("Expected at least one argument.");var J=C[1];if(!Array.isArray(J)&&typeof J=="object")return B.error("First argument must be an image or text section.");for(var he=[],xe=!1,Te=1;Te<=C.length-1;++Te){var Fe=C[Te];if(xe&&typeof Fe=="object"&&!Array.isArray(Fe)){xe=!1;var qe=null;if(Fe["font-scale"]&&(qe=B.parse(Fe["font-scale"],1,mr),!qe))return null;var ft=null;if(Fe["text-font"]&&(ft=B.parse(Fe["text-font"],1,sa(zr)),!ft))return null;var pt=null;if(Fe["text-color"]&&(pt=B.parse(Fe["text-color"],1,On),!pt))return null;var Ft=he[he.length-1];Ft.scale=qe,Ft.font=ft,Ft.textColor=pt}else{var tr=B.parse(C[Te],1,_n);if(!tr)return null;var Qt=tr.type.kind;if(Qt!=="string"&&Qt!=="value"&&Qt!=="null"&&Qt!=="resolvedImage")return B.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");xe=!0,he.push({content:tr,scale:null,font:null,textColor:null})}}return new rs(he)},rs.prototype.evaluate=function(C){var B=function(J){var he=J.content.evaluate(C);return Di(he)===ma?new Rs("",he,null,null,null):new Rs(al(he),null,J.scale?J.scale.evaluate(C):null,J.font?J.font.evaluate(C).join(","):null,J.textColor?J.textColor.evaluate(C):null)};return new Hi(this.sections.map(B))},rs.prototype.eachChild=function(C){for(var B=0,J=this.sections;B<J.length;B+=1){var he=J[B];C(he.content),he.scale&&C(he.scale),he.font&&C(he.font),he.textColor&&C(he.textColor)}},rs.prototype.outputDefined=function(){return!1},rs.prototype.serialize=function(){for(var C=["format"],B=0,J=this.sections;B<J.length;B+=1){var he=J[B];C.push(he.content.serialize());var xe={};he.scale&&(xe["font-scale"]=he.scale.serialize()),he.font&&(xe["text-font"]=he.font.serialize()),he.textColor&&(xe["text-color"]=he.textColor.serialize()),C.push(xe)}return C};var Ys=function(C){this.type=ma,this.input=C};Ys.parse=function(C,B){if(C.length!==2)return B.error("Expected two arguments.");var J=B.parse(C[1],1,zr);return J?new Ys(J):B.error("No image name provided.")},Ys.prototype.evaluate=function(C){var B=this.input.evaluate(C),J=So.fromString(B);return J&&C.availableImages&&(J.available=C.availableImages.indexOf(B)>-1),J},Ys.prototype.eachChild=function(C){C(this.input)},Ys.prototype.outputDefined=function(){return!1},Ys.prototype.serialize=function(){return["image",this.input.serialize()]};var au={"to-boolean":gn,"to-color":On,"to-number":mr,"to-string":zr},Jo=function(C,B){this.type=C,this.args=B};Jo.parse=function(C,B){if(C.length<2)return B.error("Expected at least one argument.");var J=C[0];if((J==="to-boolean"||J==="to-string")&&C.length!==2)return B.error("Expected one argument.");for(var he=au[J],xe=[],Te=1;Te<C.length;Te++){var Fe=B.parse(C[Te],Te,_n);if(!Fe)return null;xe.push(Fe)}return new Jo(he,xe)},Jo.prototype.evaluate=function(C){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(C));if(this.type.kind==="color"){for(var B,J,he=0,xe=this.args;he<xe.length;he+=1){var Te=xe[he];if(B=Te.evaluate(C),J=null,B instanceof vi)return B;if(typeof B=="string"){var Fe=C.parseColor(B);if(Fe)return Fe}else if(Array.isArray(B)&&(B.length<3||B.length>4?J="Invalid rbga value "+JSON.stringify(B)+": expected an array containing either three or four numeric values.":J=dl(B[0],B[1],B[2],B[3]),!J))return new vi(B[0]/255,B[1]/255,B[2]/255,B[3])}throw new Oi(J||"Could not parse color from value '"+(typeof B=="string"?B:String(JSON.stringify(B)))+"'")}else if(this.type.kind==="number"){for(var qe=null,ft=0,pt=this.args;ft<pt.length;ft+=1){var Ft=pt[ft];if(qe=Ft.evaluate(C),qe===null)return 0;var tr=Number(qe);if(!isNaN(tr))return tr}throw new Oi("Could not convert "+JSON.stringify(qe)+" to number.")}else return this.type.kind==="formatted"?Hi.fromString(al(this.args[0].evaluate(C))):this.type.kind==="resolvedImage"?So.fromString(al(this.args[0].evaluate(C))):al(this.args[0].evaluate(C))},Jo.prototype.eachChild=function(C){this.args.forEach(C)},Jo.prototype.outputDefined=function(){return this.args.every(function(C){return C.outputDefined()})},Jo.prototype.serialize=function(){if(this.type.kind==="formatted")return new rs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ys(this.args[0]).serialize();var C=["to-"+this.type.kind];return this.eachChild(function(B){C.push(B.serialize())}),C};var iu=["Unknown","Point","LineString","Polygon"],Is=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Is.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Is.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?iu[this.feature.type]:this.feature.type:null},Is.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Is.prototype.canonicalID=function(){return this.canonical},Is.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Is.prototype.parseColor=function(C){var B=this._parseColorCache[C];return B||(B=this._parseColorCache[C]=vi.parse(C)),B};var ko=function(C,B,J,he){this.name=C,this.type=B,this._evaluate=J,this.args=he};ko.prototype.evaluate=function(C){return this._evaluate(C,this.args)},ko.prototype.eachChild=function(C){this.args.forEach(C)},ko.prototype.outputDefined=function(){return!1},ko.prototype.serialize=function(){return[this.name].concat(this.args.map(function(C){return C.serialize()}))},ko.parse=function(C,B){var J,he=C[0],xe=ko.definitions[he];if(!xe)return B.error('Unknown expression "'+he+'". If you wanted a literal array, use ["literal", [...]].',0);for(var Te=Array.isArray(xe)?xe[0]:xe.type,Fe=Array.isArray(xe)?[[xe[1],xe[2]]]:xe.overloads,qe=Fe.filter(function(La){var Da=La[0];return!Array.isArray(Da)||Da.length===C.length-1}),ft=null,pt=0,Ft=qe;pt<Ft.length;pt+=1){var tr=Ft[pt],Qt=tr[0],dr=tr[1];ft=new Eo(B.registry,B.path,null,B.scope);for(var Fr=[],on=!1,$r=1;$r<C.length;$r++){var kn=C[$r],mn=Array.isArray(Qt)?Qt[$r-1]:Qt.type,Sn=ft.parse(kn,1+Fr.length,mn);if(!Sn){on=!0;break}Fr.push(Sn)}if(!on){if(Array.isArray(Qt)&&Qt.length!==Fr.length){ft.error("Expected "+Qt.length+" arguments, but found "+Fr.length+" instead.");continue}for(var In=0;In<Fr.length;In++){var Gn=Array.isArray(Qt)?Qt[In]:Qt.type,oa=Fr[In];ft.concat(In+1).checkSubtype(Gn,oa.type)}if(ft.errors.length===0)return new ko(he,Te,dr,Fr)}}if(qe.length===1)(J=B.errors).push.apply(J,ft.errors);else{for(var na=qe.length?qe:Fe,Ra=na.map(function(La){var Da=La[0];return Mu(Da)}).join(" | "),wa=[],Sa=1;Sa<C.length;Sa++){var ti=B.parse(C[Sa],1+wa.length);if(!ti)return null;wa.push(Aa(ti.type))}B.error("Expected arguments of type "+Ra+", but found ("+wa.join(", ")+") instead.")}return null},ko.register=function(C,B){ko.definitions=B;for(var J in B)C[J]=ko};function Mu(E){return Array.isArray(E)?"("+E.map(Aa).join(", ")+")":"("+Aa(E.type)+"...)"}var zs=function(C,B,J){this.type=aa,this.locale=J,this.caseSensitive=C,this.diacriticSensitive=B};zs.parse=function(C,B){if(C.length!==2)return B.error("Expected one argument.");var J=C[1];if(typeof J!="object"||Array.isArray(J))return B.error("Collator options argument must be an object.");var he=B.parse(J["case-sensitive"]===void 0?!1:J["case-sensitive"],1,gn);if(!he)return null;var xe=B.parse(J["diacritic-sensitive"]===void 0?!1:J["diacritic-sensitive"],1,gn);if(!xe)return null;var Te=null;return J.locale&&(Te=B.parse(J.locale,1,zr),!Te)?null:new zs(he,xe,Te)},zs.prototype.evaluate=function(C){return new Gs(this.caseSensitive.evaluate(C),this.diacriticSensitive.evaluate(C),this.locale?this.locale.evaluate(C):null)},zs.prototype.eachChild=function(C){C(this.caseSensitive),C(this.diacriticSensitive),this.locale&&C(this.locale)},zs.prototype.outputDefined=function(){return!1},zs.prototype.serialize=function(){var C={};return C["case-sensitive"]=this.caseSensitive.serialize(),C["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(C.locale=this.locale.serialize()),["collator",C]};var ws=8192;function Ll(E,C){E[0]=Math.min(E[0],C[0]),E[1]=Math.min(E[1],C[1]),E[2]=Math.max(E[2],C[0]),E[3]=Math.max(E[3],C[1])}function Su(E){return(180+E)/360}function ku(E){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+E*Math.PI/360)))/360}function Ws(E,C){return!(E[0]<=C[0]||E[2]>=C[2]||E[1]<=C[1]||E[3]>=C[3])}function Pl(E,C){var B=Su(E[0]),J=ku(E[1]),he=Math.pow(2,C.z);return[Math.round(B*he*ws),Math.round(J*he*ws)]}function Ts(E,C,B){var J=E[0]-C[0],he=E[1]-C[1],xe=E[0]-B[0],Te=E[1]-B[1];return J*Te-xe*he===0&&J*xe<=0&&he*Te<=0}function Wl(E,C,B){return C[1]>E[1]!=B[1]>E[1]&&E[0]<(B[0]-C[0])*(E[1]-C[1])/(B[1]-C[1])+C[0]}function il(E,C){for(var B=!1,J=0,he=C.length;J<he;J++)for(var xe=C[J],Te=0,Fe=xe.length;Te<Fe-1;Te++){if(Ts(E,xe[Te],xe[Te+1]))return!1;Wl(E,xe[Te],xe[Te+1])&&(B=!B)}return B}function Xl(E,C){for(var B=0;B<C.length;B++)if(il(E,C[B]))return!0;return!1}function ou(E,C){return E[0]*C[1]-E[1]*C[0]}function Dl(E,C,B,J){var he=E[0]-B[0],xe=E[1]-B[1],Te=C[0]-B[0],Fe=C[1]-B[1],qe=J[0]-B[0],ft=J[1]-B[1],pt=he*ft-qe*xe,Ft=Te*ft-qe*Fe;return pt>0&&Ft<0||pt<0&&Ft>0}function Eu(E,C,B,J){var he=[C[0]-E[0],C[1]-E[1]],xe=[J[0]-B[0],J[1]-B[1]];return ou(xe,he)===0?!1:!!(Dl(E,C,B,J)&&Dl(B,J,E,C))}function Xs(E,C,B){for(var J=0,he=B;J<he.length;J+=1)for(var xe=he[J],Te=0;Te<xe.length-1;++Te)if(Eu(E,C,xe[Te],xe[Te+1]))return!0;return!1}function Zl(E,C){for(var B=0;B<E.length;++B)if(!il(E[B],C))return!1;for(var J=0;J<E.length-1;++J)if(Xs(E[J],E[J+1],C))return!1;return!0}function Rl(E,C){for(var B=0;B<C.length;B++)if(Zl(E,C[B]))return!0;return!1}function ds(E,C,B){for(var J=[],he=0;he<E.length;he++){for(var xe=[],Te=0;Te<E[he].length;Te++){var Fe=Pl(E[he][Te],B);Ll(C,Fe),xe.push(Fe)}J.push(xe)}return J}function yl(E,C,B){for(var J=[],he=0;he<E.length;he++){var xe=ds(E[he],C,B);J.push(xe)}return J}function jl(E,C,B,J){if(E[0]<B[0]||E[0]>B[2]){var he=J*.5,xe=E[0]-B[0]>he?-J:B[0]-E[0]>he?J:0;xe===0&&(xe=E[0]-B[2]>he?-J:B[2]-E[0]>he?J:0),E[0]+=xe}Ll(C,E)}function su(E){E[0]=E[1]=1/0,E[2]=E[3]=-1/0}function lu(E,C,B,J){for(var he=Math.pow(2,J.z)*ws,xe=[J.x*ws,J.y*ws],Te=[],Fe=0,qe=E;Fe<qe.length;Fe+=1)for(var ft=qe[Fe],pt=0,Ft=ft;pt<Ft.length;pt+=1){var tr=Ft[pt],Qt=[tr.x+xe[0],tr.y+xe[1]];jl(Qt,C,B,he),Te.push(Qt)}return Te}function Il(E,C,B,J){for(var he=Math.pow(2,J.z)*ws,xe=[J.x*ws,J.y*ws],Te=[],Fe=0,qe=E;Fe<qe.length;Fe+=1){for(var ft=qe[Fe],pt=[],Ft=0,tr=ft;Ft<tr.length;Ft+=1){var Qt=tr[Ft],dr=[Qt.x+xe[0],Qt.y+xe[1]];Ll(C,dr),pt.push(dr)}Te.push(pt)}if(C[2]-C[0]<=he/2){su(C);for(var Fr=0,on=Te;Fr<on.length;Fr+=1)for(var $r=on[Fr],kn=0,mn=$r;kn<mn.length;kn+=1){var Sn=mn[kn];jl(Sn,C,B,he)}}return Te}function Cu(E,C){var B=[1/0,1/0,-1/0,-1/0],J=[1/0,1/0,-1/0,-1/0],he=E.canonicalID();if(C.type==="Polygon"){var xe=ds(C.coordinates,J,he),Te=lu(E.geometry(),B,J,he);if(!Ws(B,J))return!1;for(var Fe=0,qe=Te;Fe<qe.length;Fe+=1){var ft=qe[Fe];if(!il(ft,xe))return!1}}if(C.type==="MultiPolygon"){var pt=yl(C.coordinates,J,he),Ft=lu(E.geometry(),B,J,he);if(!Ws(B,J))return!1;for(var tr=0,Qt=Ft;tr<Qt.length;tr+=1){var dr=Qt[tr];if(!Xl(dr,pt))return!1}}return!0}function uu(E,C){var B=[1/0,1/0,-1/0,-1/0],J=[1/0,1/0,-1/0,-1/0],he=E.canonicalID();if(C.type==="Polygon"){var xe=ds(C.coordinates,J,he),Te=Il(E.geometry(),B,J,he);if(!Ws(B,J))return!1;for(var Fe=0,qe=Te;Fe<qe.length;Fe+=1){var ft=qe[Fe];if(!Zl(ft,xe))return!1}}if(C.type==="MultiPolygon"){var pt=yl(C.coordinates,J,he),Ft=Il(E.geometry(),B,J,he);if(!Ws(B,J))return!1;for(var tr=0,Qt=Ft;tr<Qt.length;tr+=1){var dr=Qt[tr];if(!Rl(dr,pt))return!1}}return!0}var Qo=function(C,B){this.type=gn,this.geojson=C,this.geometries=B};Qo.parse=function(C,B){if(C.length!==2)return B.error("'within' expression requires exactly one argument, but found "+(C.length-1)+" instead.");if(ps(C[1])){var J=C[1];if(J.type==="FeatureCollection")for(var he=0;he<J.features.length;++he){var xe=J.features[he].geometry.type;if(xe==="Polygon"||xe==="MultiPolygon")return new Qo(J,J.features[he].geometry)}else if(J.type==="Feature"){var Te=J.geometry.type;if(Te==="Polygon"||Te==="MultiPolygon")return new Qo(J,J.geometry)}else if(J.type==="Polygon"||J.type==="MultiPolygon")return new Qo(J,J)}return B.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Qo.prototype.evaluate=function(C){if(C.geometry()!=null&&C.canonicalID()!=null){if(C.geometryType()==="Point")return Cu(C,this.geometries);if(C.geometryType()==="LineString")return uu(C,this.geometries)}return!1},Qo.prototype.eachChild=function(){},Qo.prototype.outputDefined=function(){return!0},Qo.prototype.serialize=function(){return["within",this.geojson]};function ol(E){if(E instanceof ko){if(E.name==="get"&&E.args.length===1)return!1;if(E.name==="feature-state")return!1;if(E.name==="has"&&E.args.length===1)return!1;if(E.name==="properties"||E.name==="geometry-type"||E.name==="id")return!1;if(/^filter-/.test(E.name))return!1}if(E instanceof Qo)return!1;var C=!0;return E.eachChild(function(B){C&&!ol(B)&&(C=!1)}),C}function sl(E){if(E instanceof ko&&E.name==="feature-state")return!1;var C=!0;return E.eachChild(function(B){C&&!sl(B)&&(C=!1)}),C}function Kl(E,C){if(E instanceof ko&&C.indexOf(E.name)>=0)return!1;var B=!0;return E.eachChild(function(J){B&&!Kl(J,C)&&(B=!1)}),B}var gs=function(C,B){this.type=B.type,this.name=C,this.boundExpression=B};gs.parse=function(C,B){if(C.length!==2||typeof C[1]!="string")return B.error("'var' expression requires exactly one string literal argument.");var J=C[1];return B.scope.has(J)?new gs(J,B.scope.get(J)):B.error('Unknown variable "'+J+'". Make sure "'+J+'" has been bound in an enclosing "let" expression before using it.',1)},gs.prototype.evaluate=function(C){return this.boundExpression.evaluate(C)},gs.prototype.eachChild=function(){},gs.prototype.outputDefined=function(){return!1},gs.prototype.serialize=function(){return["var",this.name]};var Eo=function(C,B,J,he,xe){B===void 0&&(B=[]),he===void 0&&(he=new un),xe===void 0&&(xe=[]),this.registry=C,this.path=B,this.key=B.map(function(Te){return"["+Te+"]"}).join(""),this.scope=he,this.errors=xe,this.expectedType=J};Eo.prototype.parse=function(C,B,J,he,xe){return xe===void 0&&(xe={}),B?this.concat(B,J,he)._parse(C,xe):this._parse(C,xe)},Eo.prototype._parse=function(C,B){(C===null||typeof C=="string"||typeof C=="boolean"||typeof C=="number")&&(C=["literal",C]);function J(pt,Ft,tr){return tr==="assert"?new $i(Ft,[pt]):tr==="coerce"?new Jo(Ft,[pt]):pt}if(Array.isArray(C)){if(C.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var he=C[0];if(typeof he!="string")return this.error("Expression name must be a string, but found "+typeof he+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var xe=this.registry[he];if(xe){var Te=xe.parse(C,this);if(!Te)return null;if(this.expectedType){var Fe=this.expectedType,qe=Te.type;if((Fe.kind==="string"||Fe.kind==="number"||Fe.kind==="boolean"||Fe.kind==="object"||Fe.kind==="array")&&qe.kind==="value")Te=J(Te,Fe,B.typeAnnotation||"assert");else if((Fe.kind==="color"||Fe.kind==="formatted"||Fe.kind==="resolvedImage")&&(qe.kind==="value"||qe.kind==="string"))Te=J(Te,Fe,B.typeAnnotation||"coerce");else if(this.checkSubtype(Fe,qe))return null}if(!(Te instanceof Qi)&&Te.type.kind!=="resolvedImage"&&zl(Te)){var ft=new Is;try{Te=new Qi(Te.type,Te.evaluate(ft))}catch(pt){return this.error(pt.message),null}}return Te}return this.error('Unknown expression "'+he+'". If you wanted a literal array, use ["literal", [...]].',0)}else return typeof C>"u"?this.error("'undefined' value invalid. Use null instead."):typeof C=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof C+" instead.")},Eo.prototype.concat=function(C,B,J){var he=typeof C=="number"?this.path.concat(C):this.path,xe=J?this.scope.concat(J):this.scope;return new Eo(this.registry,he,B||null,xe,this.errors)},Eo.prototype.error=function(C){for(var B=[],J=arguments.length-1;J-- >0;)B[J]=arguments[J+1];var he=""+this.key+B.map(function(xe){return"["+xe+"]"}).join("");this.errors.push(new xn(he,C))},Eo.prototype.checkSubtype=function(C,B){var J=zo(C,B);return J&&this.error(J),J};function zl(E){if(E instanceof gs)return zl(E.boundExpression);if(E instanceof ko&&E.name==="error")return!1;if(E instanceof zs)return!1;if(E instanceof Qo)return!1;var C=E instanceof Jo||E instanceof $i,B=!0;return E.eachChild(function(J){C?B=B&&zl(J):B=B&&J instanceof Qi}),B?ol(E)&&Kl(E,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function As(E,C){for(var B=E.length-1,J=0,he=B,xe=0,Te,Fe;J<=he;)if(xe=Math.floor((J+he)/2),Te=E[xe],Fe=E[xe+1],Te<=C){if(xe===B||C<Fe)return xe;J=xe+1}else if(Te>C)he=xe-1;else throw new Oi("Input is not a number.");return 0}var Ms=function(C,B,J){this.type=C,this.input=B,this.labels=[],this.outputs=[];for(var he=0,xe=J;he<xe.length;he+=1){var Te=xe[he],Fe=Te[0],qe=Te[1];this.labels.push(Fe),this.outputs.push(qe)}};Ms.parse=function(C,B){if(C.length-1<4)return B.error("Expected at least 4 arguments, but found only "+(C.length-1)+".");if((C.length-1)%2!==0)return B.error("Expected an even number of arguments.");var J=B.parse(C[1],1,mr);if(!J)return null;var he=[],xe=null;B.expectedType&&B.expectedType.kind!=="value"&&(xe=B.expectedType);for(var Te=1;Te<C.length;Te+=2){var Fe=Te===1?-1/0:C[Te],qe=C[Te+1],ft=Te,pt=Te+1;if(typeof Fe!="number")return B.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ft);if(he.length&&he[he.length-1][0]>=Fe)return B.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',ft);var Ft=B.parse(qe,pt,xe);if(!Ft)return null;xe=xe||Ft.type,he.push([Fe,Ft])}return new Ms(xe,J,he)},Ms.prototype.evaluate=function(C){var B=this.labels,J=this.outputs;if(B.length===1)return J[0].evaluate(C);var he=this.input.evaluate(C);if(he<=B[0])return J[0].evaluate(C);var xe=B.length;if(he>=B[xe-1])return J[xe-1].evaluate(C);var Te=As(B,he);return J[Te].evaluate(C)},Ms.prototype.eachChild=function(C){C(this.input);for(var B=0,J=this.outputs;B<J.length;B+=1){var he=J[B];C(he)}},Ms.prototype.outputDefined=function(){return this.outputs.every(function(C){return C.outputDefined()})},Ms.prototype.serialize=function(){for(var C=["step",this.input.serialize()],B=0;B<this.labels.length;B++)B>0&&C.push(this.labels[B]),C.push(this.outputs[B].serialize());return C};function lo(E,C,B){return E*(1-B)+C*B}function ml(E,C,B){return new vi(lo(E.r,C.r,B),lo(E.g,C.g,B),lo(E.b,C.b,B),lo(E.a,C.a,B))}function xl(E,C,B){return E.map(function(J,he){return lo(J,C[he],B)})}var Zs=Object.freeze({__proto__:null,number:lo,color:ml,array:xl}),ys=.95047,bl=1,ll=1.08883,Fl=4/29,_l=6/29,js=3*_l*_l,Lu=_l*_l*_l,ns=Math.PI/180,Yu=180/Math.PI;function Jl(E){return E>Lu?Math.pow(E,1/3):E/js+Fl}function ul(E){return E>_l?E*E*E:js*(E-Fl)}function wl(E){return 255*(E<=.0031308?12.92*E:1.055*Math.pow(E,1/2.4)-.055)}function Ks(E){return E/=255,E<=.04045?E/12.92:Math.pow((E+.055)/1.055,2.4)}function Tl(E){var C=Ks(E.r),B=Ks(E.g),J=Ks(E.b),he=Jl((.4124564*C+.3575761*B+.1804375*J)/ys),xe=Jl((.2126729*C+.7151522*B+.072175*J)/bl),Te=Jl((.0193339*C+.119192*B+.9503041*J)/ll);return{l:116*xe-16,a:500*(he-xe),b:200*(xe-Te),alpha:E.a}}function fu(E){var C=(E.l+16)/116,B=isNaN(E.a)?C:C+E.a/500,J=isNaN(E.b)?C:C-E.b/200;return C=bl*ul(C),B=ys*ul(B),J=ll*ul(J),new vi(wl(3.2404542*B-1.5371385*C-.4985314*J),wl(-.969266*B+1.8760108*C+.041556*J),wl(.0556434*B-.2040259*C+1.0572252*J),E.alpha)}function cu(E,C,B){return{l:lo(E.l,C.l,B),a:lo(E.a,C.a,B),b:lo(E.b,C.b,B),alpha:lo(E.alpha,C.alpha,B)}}function Wu(E){var C=Tl(E),B=C.l,J=C.a,he=C.b,xe=Math.atan2(he,J)*Yu;return{h:xe<0?xe+360:xe,c:Math.sqrt(J*J+he*he),l:B,alpha:E.a}}function Ri(E){var C=E.h*ns,B=E.c,J=E.l;return fu({l:J,a:Math.cos(C)*B,b:Math.sin(C)*B,alpha:E.alpha})}function fl(E,C,B){var J=C-E;return E+B*(J>180||J<-180?J-360*Math.round(J/360):J)}function Js(E,C,B){return{h:fl(E.h,C.h,B),c:lo(E.c,C.c,B),l:lo(E.l,C.l,B),alpha:lo(E.alpha,C.alpha,B)}}var $o={forward:Tl,reverse:fu,interpolate:cu},as={forward:Wu,reverse:Ri,interpolate:Js},Al=Object.freeze({__proto__:null,lab:$o,hcl:as}),uo=function(C,B,J,he,xe){this.type=C,this.operator=B,this.interpolation=J,this.input=he,this.labels=[],this.outputs=[];for(var Te=0,Fe=xe;Te<Fe.length;Te+=1){var qe=Fe[Te],ft=qe[0],pt=qe[1];this.labels.push(ft),this.outputs.push(pt)}};uo.interpolationFactor=function(C,B,J,he){var xe=0;if(C.name==="exponential")xe=hu(B,C.base,J,he);else if(C.name==="linear")xe=hu(B,1,J,he);else if(C.name==="cubic-bezier"){var Te=C.controlPoints,Fe=new r(Te[0],Te[1],Te[2],Te[3]);xe=Fe.solve(hu(B,1,J,he))}return xe},uo.parse=function(C,B){var J=C[0],he=C[1],xe=C[2],Te=C.slice(3);if(!Array.isArray(he)||he.length===0)return B.error("Expected an interpolation type expression.",1);if(he[0]==="linear")he={name:"linear"};else if(he[0]==="exponential"){var Fe=he[1];if(typeof Fe!="number")return B.error("Exponential interpolation requires a numeric base.",1,1);he={name:"exponential",base:Fe}}else if(he[0]==="cubic-bezier"){var qe=he.slice(1);if(qe.length!==4||qe.some(function($r){return typeof $r!="number"||$r<0||$r>1}))return B.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);he={name:"cubic-bezier",controlPoints:qe}}else return B.error("Unknown interpolation type "+String(he[0]),1,0);if(C.length-1<4)return B.error("Expected at least 4 arguments, but found only "+(C.length-1)+".");if((C.length-1)%2!==0)return B.error("Expected an even number of arguments.");if(xe=B.parse(xe,2,mr),!xe)return null;var ft=[],pt=null;J==="interpolate-hcl"||J==="interpolate-lab"?pt=On:B.expectedType&&B.expectedType.kind!=="value"&&(pt=B.expectedType);for(var Ft=0;Ft<Te.length;Ft+=2){var tr=Te[Ft],Qt=Te[Ft+1],dr=Ft+3,Fr=Ft+4;if(typeof tr!="number")return B.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',dr);if(ft.length&&ft[ft.length-1][0]>=tr)return B.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',dr);var on=B.parse(Qt,Fr,pt);if(!on)return null;pt=pt||on.type,ft.push([tr,on])}return pt.kind!=="number"&&pt.kind!=="color"&&!(pt.kind==="array"&&pt.itemType.kind==="number"&&typeof pt.N=="number")?B.error("Type "+Aa(pt)+" is not interpolatable."):new uo(pt,J,he,xe,ft)},uo.prototype.evaluate=function(C){var B=this.labels,J=this.outputs;if(B.length===1)return J[0].evaluate(C);var he=this.input.evaluate(C);if(he<=B[0])return J[0].evaluate(C);var xe=B.length;if(he>=B[xe-1])return J[xe-1].evaluate(C);var Te=As(B,he),Fe=B[Te],qe=B[Te+1],ft=uo.interpolationFactor(this.interpolation,he,Fe,qe),pt=J[Te].evaluate(C),Ft=J[Te+1].evaluate(C);return this.operator==="interpolate"?Zs[this.type.kind.toLowerCase()](pt,Ft,ft):this.operator==="interpolate-hcl"?as.reverse(as.interpolate(as.forward(pt),as.forward(Ft),ft)):$o.reverse($o.interpolate($o.forward(pt),$o.forward(Ft),ft))},uo.prototype.eachChild=function(C){C(this.input);for(var B=0,J=this.outputs;B<J.length;B+=1){var he=J[B];C(he)}},uo.prototype.outputDefined=function(){return this.outputs.every(function(C){return C.outputDefined()})},uo.prototype.serialize=function(){var C;this.interpolation.name==="linear"?C=["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?C=["linear"]:C=["exponential",this.interpolation.base]:C=["cubic-bezier"].concat(this.interpolation.controlPoints);for(var B=[this.operator,C,this.input.serialize()],J=0;J<this.labels.length;J++)B.push(this.labels[J],this.outputs[J].serialize());return B};function hu(E,C,B,J){var he=J-B,xe=E-B;return he===0?0:C===1?xe/he:(Math.pow(C,xe)-1)/(Math.pow(C,he)-1)}var is=function(C,B){this.type=C,this.args=B};is.parse=function(C,B){if(C.length<2)return B.error("Expectected at least one argument.");var J=null,he=B.expectedType;he&&he.kind!=="value"&&(J=he);for(var xe=[],Te=0,Fe=C.slice(1);Te<Fe.length;Te+=1){var qe=Fe[Te],ft=B.parse(qe,1+xe.length,J,void 0,{typeAnnotation:"omit"});if(!ft)return null;J=J||ft.type,xe.push(ft)}var pt=he&&xe.some(function(Ft){return zo(he,Ft.type)});return pt?new is(_n,xe):new is(J,xe)},is.prototype.evaluate=function(C){for(var B=null,J=0,he,xe=0,Te=this.args;xe<Te.length;xe+=1){var Fe=Te[xe];if(J++,B=Fe.evaluate(C),B&&B instanceof So&&!B.available&&(he||(he=B.name),B=null,J===this.args.length&&(B=he)),B!==null)break}return B},is.prototype.eachChild=function(C){this.args.forEach(C)},is.prototype.outputDefined=function(){return this.args.every(function(C){return C.outputDefined()})},is.prototype.serialize=function(){var C=["coalesce"];return this.eachChild(function(B){C.push(B.serialize())}),C};var Fs=function(C,B){this.type=B.type,this.bindings=[].concat(C),this.result=B};Fs.prototype.evaluate=function(C){return this.result.evaluate(C)},Fs.prototype.eachChild=function(C){for(var B=0,J=this.bindings;B<J.length;B+=1){var he=J[B];C(he[1])}C(this.result)},Fs.parse=function(C,B){if(C.length<4)return B.error("Expected at least 3 arguments, but found "+(C.length-1)+" instead.");for(var J=[],he=1;he<C.length-1;he+=2){var xe=C[he];if(typeof xe!="string")return B.error("Expected string, but found "+typeof xe+" instead.",he);if(/[^a-zA-Z0-9_]/.test(xe))return B.error("Variable names must contain only alphanumeric characters or '_'.",he);var Te=B.parse(C[he+1],he+1);if(!Te)return null;J.push([xe,Te])}var Fe=B.parse(C[C.length-1],C.length-1,B.expectedType,J);return Fe?new Fs(J,Fe):null},Fs.prototype.outputDefined=function(){return this.result.outputDefined()},Fs.prototype.serialize=function(){for(var C=["let"],B=0,J=this.bindings;B<J.length;B+=1){var he=J[B],xe=he[0],Te=he[1];C.push(xe,Te.serialize())}return C.push(this.result.serialize()),C};var Os=function(C,B,J){this.type=C,this.index=B,this.input=J};Os.parse=function(C,B){if(C.length!==3)return B.error("Expected 2 arguments, but found "+(C.length-1)+" instead.");var J=B.parse(C[1],1,mr),he=B.parse(C[2],2,sa(B.expectedType||_n));if(!J||!he)return null;var xe=he.type;return new Os(xe.itemType,J,he)},Os.prototype.evaluate=function(C){var B=this.index.evaluate(C),J=this.input.evaluate(C);if(B<0)throw new Oi("Array index out of bounds: "+B+" < 0.");if(B>=J.length)throw new Oi("Array index out of bounds: "+B+" > "+(J.length-1)+".");if(B!==Math.floor(B))throw new Oi("Array index must be an integer, but found "+B+" instead.");return J[B]},Os.prototype.eachChild=function(C){C(this.index),C(this.input)},Os.prototype.outputDefined=function(){return!1},Os.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ss=function(C,B){this.type=gn,this.needle=C,this.haystack=B};Ss.parse=function(C,B){if(C.length!==3)return B.error("Expected 2 arguments, but found "+(C.length-1)+" instead.");var J=B.parse(C[1],1,_n),he=B.parse(C[2],2,_n);return!J||!he?null:Ko(J.type,[gn,zr,mr,gr,_n])?new Ss(J,he):B.error("Expected first argument to be of type boolean, string, number or null, but found "+Aa(J.type)+" instead")},Ss.prototype.evaluate=function(C){var B=this.needle.evaluate(C),J=this.haystack.evaluate(C);if(!J)return!1;if(!nl(B,["boolean","string","number","null"]))throw new Oi("Expected first argument to be of type boolean, string, number or null, but found "+Aa(Di(B))+" instead.");if(!nl(J,["string","array"]))throw new Oi("Expected second argument to be of type array or string, but found "+Aa(Di(J))+" instead.");return J.indexOf(B)>=0},Ss.prototype.eachChild=function(C){C(this.needle),C(this.haystack)},Ss.prototype.outputDefined=function(){return!0},Ss.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var os=function(C,B,J){this.type=mr,this.needle=C,this.haystack=B,this.fromIndex=J};os.parse=function(C,B){if(C.length<=2||C.length>=5)return B.error("Expected 3 or 4 arguments, but found "+(C.length-1)+" instead.");var J=B.parse(C[1],1,_n),he=B.parse(C[2],2,_n);if(!J||!he)return null;if(!Ko(J.type,[gn,zr,mr,gr,_n]))return B.error("Expected first argument to be of type boolean, string, number or null, but found "+Aa(J.type)+" instead");if(C.length===4){var xe=B.parse(C[3],3,mr);return xe?new os(J,he,xe):null}else return new os(J,he)},os.prototype.evaluate=function(C){var B=this.needle.evaluate(C),J=this.haystack.evaluate(C);if(!nl(B,["boolean","string","number","null"]))throw new Oi("Expected first argument to be of type boolean, string, number or null, but found "+Aa(Di(B))+" instead.");if(!nl(J,["string","array"]))throw new Oi("Expected second argument to be of type array or string, but found "+Aa(Di(J))+" instead.");if(this.fromIndex){var he=this.fromIndex.evaluate(C);return J.indexOf(B,he)}return J.indexOf(B)},os.prototype.eachChild=function(C){C(this.needle),C(this.haystack),this.fromIndex&&C(this.fromIndex)},os.prototype.outputDefined=function(){return!1},os.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var C=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),C]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Gi=function(C,B,J,he,xe,Te){this.inputType=C,this.type=B,this.input=J,this.cases=he,this.outputs=xe,this.otherwise=Te};Gi.parse=function(C,B){if(C.length<5)return B.error("Expected at least 4 arguments, but found only "+(C.length-1)+".");if(C.length%2!==1)return B.error("Expected an even number of arguments.");var J,he;B.expectedType&&B.expectedType.kind!=="value"&&(he=B.expectedType);for(var xe={},Te=[],Fe=2;Fe<C.length-1;Fe+=2){var qe=C[Fe],ft=C[Fe+1];Array.isArray(qe)||(qe=[qe]);var pt=B.concat(Fe);if(qe.length===0)return pt.error("Expected at least one branch label.");for(var Ft=0,tr=qe;Ft<tr.length;Ft+=1){var Qt=tr[Ft];if(typeof Qt!="number"&&typeof Qt!="string")return pt.error("Branch labels must be numbers or strings.");if(typeof Qt=="number"&&Math.abs(Qt)>Number.MAX_SAFE_INTEGER)return pt.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Qt=="number"&&Math.floor(Qt)!==Qt)return pt.error("Numeric branch labels must be integer values.");if(!J)J=Di(Qt);else if(pt.checkSubtype(J,Di(Qt)))return null;if(typeof xe[String(Qt)]<"u")return pt.error("Branch labels must be unique.");xe[String(Qt)]=Te.length}var dr=B.parse(ft,Fe,he);if(!dr)return null;he=he||dr.type,Te.push(dr)}var Fr=B.parse(C[1],1,_n);if(!Fr)return null;var on=B.parse(C[C.length-1],C.length-1,he);return!on||Fr.type.kind!=="value"&&B.concat(1).checkSubtype(J,Fr.type)?null:new Gi(J,he,Fr,xe,Te,on)},Gi.prototype.evaluate=function(C){var B=this.input.evaluate(C),J=Di(B)===this.inputType&&this.outputs[this.cases[B]]||this.otherwise;return J.evaluate(C)},Gi.prototype.eachChild=function(C){C(this.input),this.outputs.forEach(C),C(this.otherwise)},Gi.prototype.outputDefined=function(){return this.outputs.every(function(C){return C.outputDefined()})&&this.otherwise.outputDefined()},Gi.prototype.serialize=function(){for(var C=this,B=["match",this.input.serialize()],J=Object.keys(this.cases).sort(),he=[],xe={},Te=0,Fe=J;Te<Fe.length;Te+=1){var qe=Fe[Te],ft=xe[this.cases[qe]];ft===void 0?(xe[this.cases[qe]]=he.length,he.push([this.cases[qe],[qe]])):he[ft][1].push(qe)}for(var pt=function(Fr){return C.inputType.kind==="number"?Number(Fr):Fr},Ft=0,tr=he;Ft<tr.length;Ft+=1){var Qt=tr[Ft],ft=Qt[0],dr=Qt[1];dr.length===1?B.push(pt(dr[0])):B.push(dr.map(pt)),B.push(this.outputs[outputIndex$1].serialize())}return B.push(this.otherwise.serialize()),B};var Co=function(C,B,J){this.type=C,this.branches=B,this.otherwise=J};Co.parse=function(C,B){if(C.length<4)return B.error("Expected at least 3 arguments, but found only "+(C.length-1)+".");if(C.length%2!==0)return B.error("Expected an odd number of arguments.");var J;B.expectedType&&B.expectedType.kind!=="value"&&(J=B.expectedType);for(var he=[],xe=1;xe<C.length-1;xe+=2){var Te=B.parse(C[xe],xe,gn);if(!Te)return null;var Fe=B.parse(C[xe+1],xe+1,J);if(!Fe)return null;he.push([Te,Fe]),J=J||Fe.type}var qe=B.parse(C[C.length-1],C.length-1,J);return qe?new Co(J,he,qe):null},Co.prototype.evaluate=function(C){for(var B=0,J=this.branches;B<J.length;B+=1){var he=J[B],xe=he[0],Te=he[1];if(xe.evaluate(C))return Te.evaluate(C)}return this.otherwise.evaluate(C)},Co.prototype.eachChild=function(C){for(var B=0,J=this.branches;B<J.length;B+=1){var he=J[B],xe=he[0],Te=he[1];C(xe),C(Te)}C(this.otherwise)},Co.prototype.outputDefined=function(){return this.branches.every(function(C){C[0];var B=C[1];return B.outputDefined()})&&this.otherwise.outputDefined()},Co.prototype.serialize=function(){var C=["case"];return this.eachChild(function(B){C.push(B.serialize())}),C};var ss=function(C,B,J,he){this.type=C,this.input=B,this.beginIndex=J,this.endIndex=he};ss.parse=function(C,B){if(C.length<=2||C.length>=5)return B.error("Expected 3 or 4 arguments, but found "+(C.length-1)+" instead.");var J=B.parse(C[1],1,_n),he=B.parse(C[2],2,mr);if(!J||!he)return null;if(!Ko(J.type,[sa(_n),zr,_n]))return B.error("Expected first argument to be of type array or string, but found "+Aa(J.type)+" instead");if(C.length===4){var xe=B.parse(C[3],3,mr);return xe?new ss(J.type,J,he,xe):null}else return new ss(J.type,J,he)},ss.prototype.evaluate=function(C){var B=this.input.evaluate(C),J=this.beginIndex.evaluate(C);if(!nl(B,["string","array"]))throw new Oi("Expected first argument to be of type array or string, but found "+Aa(Di(B))+" instead.");if(this.endIndex){var he=this.endIndex.evaluate(C);return B.slice(J,he)}return B.slice(J)},ss.prototype.eachChild=function(C){C(this.input),C(this.beginIndex),this.endIndex&&C(this.endIndex)},ss.prototype.outputDefined=function(){return!1},ss.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var C=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),C]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};function vu(E,C){return E==="=="||E==="!="?C.kind==="boolean"||C.kind==="string"||C.kind==="number"||C.kind==="null"||C.kind==="value":C.kind==="string"||C.kind==="number"||C.kind==="value"}function Ol(E,C,B){return C===B}function pu(E,C,B){return C!==B}function yt(E,C,B){return C<B}function Ot(E,C,B){return C>B}function cr(E,C,B){return C<=B}function or(E,C,B){return C>=B}function Rr(E,C,B,J){return J.compare(C,B)===0}function tn(E,C,B,J){return!Rr(E,C,B,J)}function dn(E,C,B,J){return J.compare(C,B)<0}function Mn(E,C,B,J){return J.compare(C,B)>0}function Ln(E,C,B,J){return J.compare(C,B)<=0}function Nn(E,C,B,J){return J.compare(C,B)>=0}function yn(E,C,B){var J=E!=="=="&&E!=="!=";return function(){function he(xe,Te,Fe){this.type=gn,this.lhs=xe,this.rhs=Te,this.collator=Fe,this.hasUntypedArgument=xe.type.kind==="value"||Te.type.kind==="value"}return he.parse=function(Te,Fe){if(Te.length!==3&&Te.length!==4)return Fe.error("Expected two or three arguments.");var qe=Te[0],ft=Fe.parse(Te[1],1,_n);if(!ft)return null;if(!vu(qe,ft.type))return Fe.concat(1).error('"'+qe+`" comparisons are not supported for type '`+Aa(ft.type)+"'.");var pt=Fe.parse(Te[2],2,_n);if(!pt)return null;if(!vu(qe,pt.type))return Fe.concat(2).error('"'+qe+`" comparisons are not supported for type '`+Aa(pt.type)+"'.");if(ft.type.kind!==pt.type.kind&&ft.type.kind!=="value"&&pt.type.kind!=="value")return Fe.error("Cannot compare types '"+Aa(ft.type)+"' and '"+Aa(pt.type)+"'.");J&&(ft.type.kind==="value"&&pt.type.kind!=="value"?ft=new $i(pt.type,[ft]):ft.type.kind!=="value"&&pt.type.kind==="value"&&(pt=new $i(ft.type,[pt])));var Ft=null;if(Te.length===4){if(ft.type.kind!=="string"&&pt.type.kind!=="string"&&ft.type.kind!=="value"&&pt.type.kind!=="value")return Fe.error("Cannot use collator to compare non-string types.");if(Ft=Fe.parse(Te[3],3,aa),!Ft)return null}return new he(ft,pt,Ft)},he.prototype.evaluate=function(Te){var Fe=this.lhs.evaluate(Te),qe=this.rhs.evaluate(Te);if(J&&this.hasUntypedArgument){var ft=Di(Fe),pt=Di(qe);if(ft.kind!==pt.kind||!(ft.kind==="string"||ft.kind==="number"))throw new Oi('Expected arguments for "'+E+'" to be (string, string) or (number, number), but found ('+ft.kind+", "+pt.kind+") instead.")}if(this.collator&&!J&&this.hasUntypedArgument){var Ft=Di(Fe),tr=Di(qe);if(Ft.kind!=="string"||tr.kind!=="string")return C(Te,Fe,qe)}return this.collator?B(Te,Fe,qe,this.collator.evaluate(Te)):C(Te,Fe,qe)},he.prototype.eachChild=function(Te){Te(this.lhs),Te(this.rhs),this.collator&&Te(this.collator)},he.prototype.outputDefined=function(){return!0},he.prototype.serialize=function(){var Te=[E];return this.eachChild(function(Fe){Te.push(Fe.serialize())}),Te},he}()}var zn=yn("==",Ol,Rr),Pn=yn("!=",pu,tn),Vn=yn("<",yt,dn),$n=yn(">",Ot,Mn),za=yn("<=",cr,Ln),Ea=yn(">=",or,Nn),Fa=function(C,B,J,he,xe){this.type=zr,this.number=C,this.locale=B,this.currency=J,this.minFractionDigits=he,this.maxFractionDigits=xe};Fa.parse=function(C,B){if(C.length!==3)return B.error("Expected two arguments.");var J=B.parse(C[1],1,mr);if(!J)return null;var he=C[2];if(typeof he!="object"||Array.isArray(he))return B.error("NumberFormat options argument must be an object.");var xe=null;if(he.locale&&(xe=B.parse(he.locale,1,zr),!xe))return null;var Te=null;if(he.currency&&(Te=B.parse(he.currency,1,zr),!Te))return null;var Fe=null;if(he["min-fraction-digits"]&&(Fe=B.parse(he["min-fraction-digits"],1,mr),!Fe))return null;var qe=null;return he["max-fraction-digits"]&&(qe=B.parse(he["max-fraction-digits"],1,mr),!qe)?null:new Fa(J,xe,Te,Fe,qe)},Fa.prototype.evaluate=function(C){return new Intl.NumberFormat(this.locale?this.locale.evaluate(C):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(C):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(C):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(C):void 0}).format(this.number.evaluate(C))},Fa.prototype.eachChild=function(C){C(this.number),this.locale&&C(this.locale),this.currency&&C(this.currency),this.minFractionDigits&&C(this.minFractionDigits),this.maxFractionDigits&&C(this.maxFractionDigits)},Fa.prototype.outputDefined=function(){return!1},Fa.prototype.serialize=function(){var C={};return this.locale&&(C.locale=this.locale.serialize()),this.currency&&(C.currency=this.currency.serialize()),this.minFractionDigits&&(C["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(C["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),C]};var Oa=function(C){this.type=mr,this.input=C};Oa.parse=function(C,B){if(C.length!==2)return B.error("Expected 1 argument, but found "+(C.length-1)+" instead.");var J=B.parse(C[1],1);return J?J.type.kind!=="array"&&J.type.kind!=="string"&&J.type.kind!=="value"?B.error("Expected argument of type string or array, but found "+Aa(J.type)+" instead."):new Oa(J):null},Oa.prototype.evaluate=function(C){var B=this.input.evaluate(C);if(typeof B=="string")return B.length;if(Array.isArray(B))return B.length;throw new Oi("Expected value to be of type string or array, but found "+Aa(Di(B))+" instead.")},Oa.prototype.eachChild=function(C){C(this.input)},Oa.prototype.outputDefined=function(){return!1},Oa.prototype.serialize=function(){var C=["length"];return this.eachChild(function(B){C.push(B.serialize())}),C};var Jn={"==":zn,"!=":Pn,">":$n,"<":Vn,">=":Ea,"<=":za,array:$i,at:Os,boolean:$i,case:Co,coalesce:is,collator:zs,format:rs,image:Ys,in:Ss,"index-of":os,interpolate:uo,"interpolate-hcl":uo,"interpolate-lab":uo,length:Oa,let:Fs,literal:Qi,match:Gi,number:$i,"number-format":Fa,object:$i,slice:ss,step:Ms,string:$i,"to-boolean":Jo,"to-color":Jo,"to-number":Jo,"to-string":Jo,var:gs,within:Qo};function ha(E,C){var B=C[0],J=C[1],he=C[2],xe=C[3];B=B.evaluate(E),J=J.evaluate(E),he=he.evaluate(E);var Te=xe?xe.evaluate(E):1,Fe=dl(B,J,he,Te);if(Fe)throw new Oi(Fe);return new vi(B/255*Te,J/255*Te,he/255*Te,Te)}function Ga(E,C){return E in C}function Qa(E,C){var B=C[E];return typeof B>"u"?null:B}function di(E,C,B,J){for(;B<=J;){var he=B+J>>1;if(C[he]===E)return!0;C[he]>E?J=he-1:B=he+1}return!1}function gi(E){return{type:E}}ko.register(Jn,{error:[jn,[zr],function(E,C){var B=C[0];throw new Oi(B.evaluate(E))}],typeof:[zr,[_n],function(E,C){var B=C[0];return Aa(Di(B.evaluate(E)))}],"to-rgba":[sa(mr,4),[On],function(E,C){var B=C[0];return B.evaluate(E).toArray()}],rgb:[On,[mr,mr,mr],ha],rgba:[On,[mr,mr,mr,mr],ha],has:{type:gn,overloads:[[[zr],function(E,C){var B=C[0];return Ga(B.evaluate(E),E.properties())}],[[zr,ta],function(E,C){var B=C[0],J=C[1];return Ga(B.evaluate(E),J.evaluate(E))}]]},get:{type:_n,overloads:[[[zr],function(E,C){var B=C[0];return Qa(B.evaluate(E),E.properties())}],[[zr,ta],function(E,C){var B=C[0],J=C[1];return Qa(B.evaluate(E),J.evaluate(E))}]]},"feature-state":[_n,[zr],function(E,C){var B=C[0];return Qa(B.evaluate(E),E.featureState||{})}],properties:[ta,[],function(E){return E.properties()}],"geometry-type":[zr,[],function(E){return E.geometryType()}],id:[_n,[],function(E){return E.id()}],zoom:[mr,[],function(E){return E.globals.zoom}],"heatmap-density":[mr,[],function(E){return E.globals.heatmapDensity||0}],"line-progress":[mr,[],function(E){return E.globals.lineProgress||0}],accumulated:[_n,[],function(E){return E.globals.accumulated===void 0?null:E.globals.accumulated}],"+":[mr,gi(mr),function(E,C){for(var B=0,J=0,he=C;J<he.length;J+=1){var xe=he[J];B+=xe.evaluate(E)}return B}],"*":[mr,gi(mr),function(E,C){for(var B=1,J=0,he=C;J<he.length;J+=1){var xe=he[J];B*=xe.evaluate(E)}return B}],"-":{type:mr,overloads:[[[mr,mr],function(E,C){var B=C[0],J=C[1];return B.evaluate(E)-J.evaluate(E)}],[[mr],function(E,C){var B=C[0];return-B.evaluate(E)}]]},"/":[mr,[mr,mr],function(E,C){var B=C[0],J=C[1];return B.evaluate(E)/J.evaluate(E)}],"%":[mr,[mr,mr],function(E,C){var B=C[0],J=C[1];return B.evaluate(E)%J.evaluate(E)}],ln2:[mr,[],function(){return Math.LN2}],pi:[mr,[],function(){return Math.PI}],e:[mr,[],function(){return Math.E}],"^":[mr,[mr,mr],function(E,C){var B=C[0],J=C[1];return Math.pow(B.evaluate(E),J.evaluate(E))}],sqrt:[mr,[mr],function(E,C){var B=C[0];return Math.sqrt(B.evaluate(E))}],log10:[mr,[mr],function(E,C){var B=C[0];return Math.log(B.evaluate(E))/Math.LN10}],ln:[mr,[mr],function(E,C){var B=C[0];return Math.log(B.evaluate(E))}],log2:[mr,[mr],function(E,C){var B=C[0];return Math.log(B.evaluate(E))/Math.LN2}],sin:[mr,[mr],function(E,C){var B=C[0];return Math.sin(B.evaluate(E))}],cos:[mr,[mr],function(E,C){var B=C[0];return Math.cos(B.evaluate(E))}],tan:[mr,[mr],function(E,C){var B=C[0];return Math.tan(B.evaluate(E))}],asin:[mr,[mr],function(E,C){var B=C[0];return Math.asin(B.evaluate(E))}],acos:[mr,[mr],function(E,C){var B=C[0];return Math.acos(B.evaluate(E))}],atan:[mr,[mr],function(E,C){var B=C[0];return Math.atan(B.evaluate(E))}],min:[mr,gi(mr),function(E,C){return Math.min.apply(Math,C.map(function(B){return B.evaluate(E)}))}],max:[mr,gi(mr),function(E,C){return Math.max.apply(Math,C.map(function(B){return B.evaluate(E)}))}],abs:[mr,[mr],function(E,C){var B=C[0];return Math.abs(B.evaluate(E))}],round:[mr,[mr],function(E,C){var B=C[0],J=B.evaluate(E);return J<0?-Math.round(-J):Math.round(J)}],floor:[mr,[mr],function(E,C){var B=C[0];return Math.floor(B.evaluate(E))}],ceil:[mr,[mr],function(E,C){var B=C[0];return Math.ceil(B.evaluate(E))}],"filter-==":[gn,[zr,_n],function(E,C){var B=C[0],J=C[1];return E.properties()[B.value]===J.value}],"filter-id-==":[gn,[_n],function(E,C){var B=C[0];return E.id()===B.value}],"filter-type-==":[gn,[zr],function(E,C){var B=C[0];return E.geometryType()===B.value}],"filter-<":[gn,[zr,_n],function(E,C){var B=C[0],J=C[1],he=E.properties()[B.value],xe=J.value;return typeof he==typeof xe&&he<xe}],"filter-id-<":[gn,[_n],function(E,C){var B=C[0],J=E.id(),he=B.value;return typeof J==typeof he&&J<he}],"filter->":[gn,[zr,_n],function(E,C){var B=C[0],J=C[1],he=E.properties()[B.value],xe=J.value;return typeof he==typeof xe&&he>xe}],"filter-id->":[gn,[_n],function(E,C){var B=C[0],J=E.id(),he=B.value;return typeof J==typeof he&&J>he}],"filter-<=":[gn,[zr,_n],function(E,C){var B=C[0],J=C[1],he=E.properties()[B.value],xe=J.value;return typeof he==typeof xe&&he<=xe}],"filter-id-<=":[gn,[_n],function(E,C){var B=C[0],J=E.id(),he=B.value;return typeof J==typeof he&&J<=he}],"filter->=":[gn,[zr,_n],function(E,C){var B=C[0],J=C[1],he=E.properties()[B.value],xe=J.value;return typeof he==typeof xe&&he>=xe}],"filter-id->=":[gn,[_n],function(E,C){var B=C[0],J=E.id(),he=B.value;return typeof J==typeof he&&J>=he}],"filter-has":[gn,[_n],function(E,C){var B=C[0];return B.value in E.properties()}],"filter-has-id":[gn,[],function(E){return E.id()!==null&&E.id()!==void 0}],"filter-type-in":[gn,[sa(zr)],function(E,C){var B=C[0];return B.value.indexOf(E.geometryType())>=0}],"filter-id-in":[gn,[sa(_n)],function(E,C){var B=C[0];return B.value.indexOf(E.id())>=0}],"filter-in-small":[gn,[zr,sa(_n)],function(E,C){var B=C[0],J=C[1];return J.value.indexOf(E.properties()[B.value])>=0}],"filter-in-large":[gn,[zr,sa(_n)],function(E,C){var B=C[0],J=C[1];return di(E.properties()[B.value],J.value,0,J.value.length-1)}],all:{type:gn,overloads:[[[gn,gn],function(E,C){var B=C[0],J=C[1];return B.evaluate(E)&&J.evaluate(E)}],[gi(gn),function(E,C){for(var B=0,J=C;B<J.length;B+=1){var he=J[B];if(!he.evaluate(E))return!1}return!0}]]},any:{type:gn,overloads:[[[gn,gn],function(E,C){var B=C[0],J=C[1];return B.evaluate(E)||J.evaluate(E)}],[gi(gn),function(E,C){for(var B=0,J=C;B<J.length;B+=1){var he=J[B];if(he.evaluate(E))return!0}return!1}]]},"!":[gn,[gn],function(E,C){var B=C[0];return!B.evaluate(E)}],"is-supported-script":[gn,[zr],function(E,C){var B=C[0],J=E.globals&&E.globals.isSupportedScript;return J?J(B.evaluate(E)):!0}],upcase:[zr,[zr],function(E,C){var B=C[0];return B.evaluate(E).toUpperCase()}],downcase:[zr,[zr],function(E,C){var B=C[0];return B.evaluate(E).toLowerCase()}],concat:[zr,gi(_n),function(E,C){return C.map(function(B){return al(B.evaluate(E))}).join("")}],"resolved-locale":[zr,[aa],function(E,C){var B=C[0];return B.evaluate(E).resolvedLocale()}]});function mi(E){return{result:"success",value:E}}function Ai(E){return{result:"error",value:E}}function oi(E){return E["property-type"]==="data-driven"||E["property-type"]==="cross-faded-data-driven"}function xo(E){return!!E.expression&&E.expression.parameters.indexOf("zoom")>-1}function to(E){return!!E.expression&&E.expression.interpolated}function Ja(E){return E instanceof Number?"number":E instanceof String?"string":E instanceof Boolean?"boolean":Array.isArray(E)?"array":E===null?"null":typeof E}function va(E){return typeof E=="object"&&E!==null&&!Array.isArray(E)}function xi(E){return E}function fo(E,C){var B=C.type==="color",J=E.stops&&typeof E.stops[0][0]=="object",he=J||E.property!==void 0,xe=J||!he,Te=E.type||(to(C)?"exponential":"interval");if(B&&(E=vn({},E),E.stops&&(E.stops=E.stops.map(function(na){return[na[0],vi.parse(na[1])]})),E.default?E.default=vi.parse(E.default):E.default=vi.parse(C.default)),E.colorSpace&&E.colorSpace!=="rgb"&&!Al[E.colorSpace])throw new Error("Unknown color space: "+E.colorSpace);var Fe,qe,ft;if(Te==="exponential")Fe=Fo;else if(Te==="interval")Fe=ks;else if(Te==="categorical"){Fe=ls,qe=Object.create(null);for(var pt=0,Ft=E.stops;pt<Ft.length;pt+=1){var tr=Ft[pt];qe[tr[0]]=tr[1]}ft=typeof E.stops[0][0]}else if(Te==="identity")Fe=Qs;else throw new Error('Unknown function type "'+Te+'"');if(J){for(var Qt={},dr=[],Fr=0;Fr<E.stops.length;Fr++){var on=E.stops[Fr],$r=on[0].zoom;Qt[$r]===void 0&&(Qt[$r]={zoom:$r,type:E.type,property:E.property,default:E.default,stops:[]},dr.push($r)),Qt[$r].stops.push([on[0].value,on[1]])}for(var kn=[],mn=0,Sn=dr;mn<Sn.length;mn+=1){var In=Sn[mn];kn.push([Qt[In].zoom,fo(Qt[In],C)])}var Gn={name:"linear"};return{kind:"composite",interpolationType:Gn,interpolationFactor:uo.interpolationFactor.bind(void 0,Gn),zoomStops:kn.map(function(na){return na[0]}),evaluate:function(Ra,wa){var Sa=Ra.zoom;return Fo({stops:kn,base:E.base},C,Sa).evaluate(Sa,wa)}}}else if(xe){var oa=Te==="exponential"?{name:"exponential",base:E.base!==void 0?E.base:1}:null;return{kind:"camera",interpolationType:oa,interpolationFactor:uo.interpolationFactor.bind(void 0,oa),zoomStops:E.stops.map(function(na){return na[0]}),evaluate:function(na){var Ra=na.zoom;return Fe(E,C,Ra,qe,ft)}}}else return{kind:"source",evaluate:function(Ra,wa){var Sa=wa&&wa.properties?wa.properties[E.property]:void 0;return Sa===void 0?go(E.default,C.default):Fe(E,C,Sa,qe,ft)}}}function go(E,C,B){if(E!==void 0)return E;if(C!==void 0)return C;if(B!==void 0)return B}function ls(E,C,B,J,he){var xe=typeof B===he?J[B]:void 0;return go(xe,E.default,C.default)}function ks(E,C,B){if(Ja(B)!=="number")return go(E.default,C.default);var J=E.stops.length;if(J===1||B<=E.stops[0][0])return E.stops[0][1];if(B>=E.stops[J-1][0])return E.stops[J-1][1];var he=As(E.stops.map(function(xe){return xe[0]}),B);return E.stops[he][1]}function Fo(E,C,B){var J=E.base!==void 0?E.base:1;if(Ja(B)!=="number")return go(E.default,C.default);var he=E.stops.length;if(he===1||B<=E.stops[0][0])return E.stops[0][1];if(B>=E.stops[he-1][0])return E.stops[he-1][1];var xe=As(E.stops.map(function(Ft){return Ft[0]}),B),Te=ms(B,J,E.stops[xe][0],E.stops[xe+1][0]),Fe=E.stops[xe][1],qe=E.stops[xe+1][1],ft=Zs[C.type]||xi;if(E.colorSpace&&E.colorSpace!=="rgb"){var pt=Al[E.colorSpace];ft=function(Ft,tr){return pt.reverse(pt.interpolate(pt.forward(Ft),pt.forward(tr),Te))}}return typeof Fe.evaluate=="function"?{evaluate:function(){for(var tr=[],Qt=arguments.length;Qt--;)tr[Qt]=arguments[Qt];var dr=Fe.evaluate.apply(void 0,tr),Fr=qe.evaluate.apply(void 0,tr);if(!(dr===void 0||Fr===void 0))return ft(dr,Fr,Te)}}:ft(Fe,qe,Te)}function Qs(E,C,B){return C.type==="color"?B=vi.parse(B):C.type==="formatted"?B=Hi.fromString(B.toString()):C.type==="resolvedImage"?B=So.fromString(B.toString()):Ja(B)!==C.type&&(C.type!=="enum"||!C.values[B])&&(B=void 0),go(B,E.default,C.default)}function ms(E,C,B,J){var he=J-B,xe=E-B;return he===0?0:C===1?xe/he:(Math.pow(C,xe)-1)/(Math.pow(C,he)-1)}var us=function(C,B){this.expression=C,this._warningHistory={},this._evaluator=new Is,this._defaultValue=B?Du(B):null,this._enumValues=B&&B.type==="enum"?B.values:null};us.prototype.evaluateWithoutErrorHandling=function(C,B,J,he,xe,Te){return this._evaluator.globals=C,this._evaluator.feature=B,this._evaluator.featureState=J,this._evaluator.canonical=he,this._evaluator.availableImages=xe||null,this._evaluator.formattedSection=Te,this.expression.evaluate(this._evaluator)},us.prototype.evaluate=function(C,B,J,he,xe,Te){this._evaluator.globals=C,this._evaluator.feature=B||null,this._evaluator.featureState=J||null,this._evaluator.canonical=he,this._evaluator.availableImages=xe||null,this._evaluator.formattedSection=Te||null;try{var Fe=this.expression.evaluate(this._evaluator);if(Fe==null||typeof Fe=="number"&&Fe!==Fe)return this._defaultValue;if(this._enumValues&&!(Fe in this._enumValues))throw new Oi("Expected value to be one of "+Object.keys(this._enumValues).map(function(qe){return JSON.stringify(qe)}).join(", ")+", but found "+JSON.stringify(Fe)+" instead.");return Fe}catch(qe){return this._warningHistory[qe.message]||(this._warningHistory[qe.message]=!0,typeof console<"u"&&console.warn(qe.message)),this._defaultValue}};function bo(E){return Array.isArray(E)&&E.length>0&&typeof E[0]=="string"&&E[0]in Jn}function Bl(E,C){var B=new Eo(Jn,[],C?gu(C):void 0),J=B.parse(E,void 0,void 0,void 0,C&&C.type==="string"?{typeAnnotation:"coerce"}:void 0);return J?mi(new us(J,C)):Ai(B.errors)}var Ql=function(C,B){this.kind=C,this._styleExpression=B,this.isStateDependent=C!=="constant"&&!sl(B.expression)};Ql.prototype.evaluateWithoutErrorHandling=function(C,B,J,he,xe,Te){return this._styleExpression.evaluateWithoutErrorHandling(C,B,J,he,xe,Te)},Ql.prototype.evaluate=function(C,B,J,he,xe,Te){return this._styleExpression.evaluate(C,B,J,he,xe,Te)};var fs=function(C,B,J,he){this.kind=C,this.zoomStops=J,this._styleExpression=B,this.isStateDependent=C!=="camera"&&!sl(B.expression),this.interpolationType=he};fs.prototype.evaluateWithoutErrorHandling=function(C,B,J,he,xe,Te){return this._styleExpression.evaluateWithoutErrorHandling(C,B,J,he,xe,Te)},fs.prototype.evaluate=function(C,B,J,he,xe,Te){return this._styleExpression.evaluate(C,B,J,he,xe,Te)},fs.prototype.interpolationFactor=function(C,B,J){return this.interpolationType?uo.interpolationFactor(this.interpolationType,C,B,J):0};function du(E,C){if(E=Bl(E,C),E.result==="error")return E;var B=E.value.expression,J=ol(B);if(!J&&!oi(C))return Ai([new xn("","data expressions not supported")]);var he=Kl(B,["zoom"]);if(!he&&!xo(C))return Ai([new xn("","zoom expressions not supported")]);var xe=Pu(B);if(!xe&&!he)return Ai([new xn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(xe instanceof xn)return Ai([xe]);if(xe instanceof uo&&!to(C))return Ai([new xn("",'"interpolate" expressions cannot be used with this property')]);if(!xe)return mi(J?new Ql("constant",E.value):new Ql("source",E.value));var Te=xe instanceof uo?xe.interpolation:void 0;return mi(J?new fs("camera",E.value,xe.labels,Te):new fs("composite",E.value,xe.labels,Te))}var Nl=function(C,B){this._parameters=C,this._specification=B,vn(this,fo(this._parameters,this._specification))};Nl.deserialize=function(C){return new Nl(C._parameters,C._specification)},Nl.serialize=function(C){return{_parameters:C._parameters,_specification:C._specification}};function gf(E,C){if(va(E))return new Nl(E,C);if(bo(E)){var B=du(E,C);if(B.result==="error")throw new Error(B.value.map(function(he){return he.key+": "+he.message}).join(", "));return B.value}else{var J=E;return typeof E=="string"&&C.type==="color"&&(J=vi.parse(E)),{kind:"constant",evaluate:function(){return J}}}}function Pu(E){var C=null;if(E instanceof Fs)C=Pu(E.result);else if(E instanceof is)for(var B=0,J=E.args;B<J.length;B+=1){var he=J[B];if(C=Pu(he),C)break}else(E instanceof Ms||E instanceof uo)&&E.input instanceof ko&&E.input.name==="zoom"&&(C=E);return C instanceof xn||E.eachChild(function(xe){var Te=Pu(xe);Te instanceof xn?C=Te:!C&&Te?C=new xn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):C&&Te&&C!==Te&&(C=new xn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),C}function gu(E){var C={color:On,string:zr,number:mr,enum:zr,boolean:gn,formatted:da,resolvedImage:ma};return E.type==="array"?sa(C[E.value]||_n,E.length):C[E.type]}function Du(E){return E.type==="color"&&va(E.default)?new vi(0,0,0,0):E.type==="color"?vi.parse(E.default)||null:E.default===void 0?null:E.default}function Es(E){var C=E.key,B=E.value,J=E.valueSpec||{},he=E.objectElementValidators||{},xe=E.style,Te=E.styleSpec,Fe=[],qe=Ja(B);if(qe!=="object")return[new hr(C,B,"object expected, "+qe+" found")];for(var ft in B){var pt=ft.split(".")[0],Ft=J[pt]||J["*"],tr=void 0;if(he[pt])tr=he[pt];else if(J[pt])tr=hi;else if(he["*"])tr=he["*"];else if(J["*"])tr=hi;else{Fe.push(new hr(C,B[ft],'unknown property "'+ft+'"'));continue}Fe=Fe.concat(tr({key:(C&&C+".")+ft,value:B[ft],valueSpec:Ft,style:xe,styleSpec:Te,object:B,objectKey:ft},B))}for(var Qt in J)he[Qt]||J[Qt].required&&J[Qt].default===void 0&&B[Qt]===void 0&&Fe.push(new hr(C,B,'missing required property "'+Qt+'"'));return Fe}function Xu(E){var C=E.value,B=E.valueSpec,J=E.style,he=E.styleSpec,xe=E.key,Te=E.arrayElementValidator||hi;if(Ja(C)!=="array")return[new hr(xe,C,"array expected, "+Ja(C)+" found")];if(B.length&&C.length!==B.length)return[new hr(xe,C,"array length "+B.length+" expected, length "+C.length+" found")];if(B["min-length"]&&C.length<B["min-length"])return[new hr(xe,C,"array length at least "+B["min-length"]+" expected, length "+C.length+" found")];var Fe={type:B.value,values:B.values};he.$version<7&&(Fe.function=B.function),Ja(B.value)==="object"&&(Fe=B.value);for(var qe=[],ft=0;ft<C.length;ft++)qe=qe.concat(Te({array:C,arrayIndex:ft,value:C[ft],valueSpec:Fe,style:J,styleSpec:he,key:xe+"["+ft+"]"}));return qe}function Ru(E){var C=E.key,B=E.value,J=E.valueSpec,he=Ja(B);return he==="number"&&B!==B&&(he="NaN"),he!=="number"?[new hr(C,B,"number expected, "+he+" found")]:"minimum"in J&&B<J.minimum?[new hr(C,B,B+" is less than the minimum value "+J.minimum)]:"maximum"in J&&B>J.maximum?[new hr(C,B,B+" is greater than the maximum value "+J.maximum)]:[]}function Iu(E){var C=E.valueSpec,B=en(E.value.type),J,he={},xe,Te,Fe=B!=="categorical"&&E.value.property===void 0,qe=!Fe,ft=Ja(E.value.stops)==="array"&&Ja(E.value.stops[0])==="array"&&Ja(E.value.stops[0][0])==="object",pt=Es({key:E.key,value:E.value,valueSpec:E.styleSpec.function,style:E.style,styleSpec:E.styleSpec,objectElementValidators:{stops:Ft,default:dr}});return B==="identity"&&Fe&&pt.push(new hr(E.key,E.value,'missing required property "property"')),B!=="identity"&&!E.value.stops&&pt.push(new hr(E.key,E.value,'missing required property "stops"')),B==="exponential"&&E.valueSpec.expression&&!to(E.valueSpec)&&pt.push(new hr(E.key,E.value,"exponential functions not supported")),E.styleSpec.$version>=8&&(qe&&!oi(E.valueSpec)?pt.push(new hr(E.key,E.value,"property functions not supported")):Fe&&!xo(E.valueSpec)&&pt.push(new hr(E.key,E.value,"zoom functions not supported"))),(B==="categorical"||ft)&&E.value.property===void 0&&pt.push(new hr(E.key,E.value,'"property" property is required')),pt;function Ft(Fr){if(B==="identity")return[new hr(Fr.key,Fr.value,'identity function may not have a "stops" property')];var on=[],$r=Fr.value;return on=on.concat(Xu({key:Fr.key,value:$r,valueSpec:Fr.valueSpec,style:Fr.style,styleSpec:Fr.styleSpec,arrayElementValidator:tr})),Ja($r)==="array"&&$r.length===0&&on.push(new hr(Fr.key,$r,"array must have at least one stop")),on}function tr(Fr){var on=[],$r=Fr.value,kn=Fr.key;if(Ja($r)!=="array")return[new hr(kn,$r,"array expected, "+Ja($r)+" found")];if($r.length!==2)return[new hr(kn,$r,"array length 2 expected, length "+$r.length+" found")];if(ft){if(Ja($r[0])!=="object")return[new hr(kn,$r,"object expected, "+Ja($r[0])+" found")];if($r[0].zoom===void 0)return[new hr(kn,$r,"object stop key must have zoom")];if($r[0].value===void 0)return[new hr(kn,$r,"object stop key must have value")];if(Te&&Te>en($r[0].zoom))return[new hr(kn,$r[0].zoom,"stop zoom values must appear in ascending order")];en($r[0].zoom)!==Te&&(Te=en($r[0].zoom),xe=void 0,he={}),on=on.concat(Es({key:kn+"[0]",value:$r[0],valueSpec:{zoom:{}},style:Fr.style,styleSpec:Fr.styleSpec,objectElementValidators:{zoom:Ru,value:Qt}}))}else on=on.concat(Qt({key:kn+"[0]",value:$r[0],valueSpec:{},style:Fr.style,styleSpec:Fr.styleSpec},$r));return bo(Tn($r[1]))?on.concat([new hr(kn+"[1]",$r[1],"expressions are not allowed in function stops.")]):on.concat(hi({key:kn+"[1]",value:$r[1],valueSpec:C,style:Fr.style,styleSpec:Fr.styleSpec}))}function Qt(Fr,on){var $r=Ja(Fr.value),kn=en(Fr.value),mn=Fr.value!==null?Fr.value:on;if(!J)J=$r;else if($r!==J)return[new hr(Fr.key,mn,$r+" stop domain type must match previous stop domain type "+J)];if($r!=="number"&&$r!=="string"&&$r!=="boolean")return[new hr(Fr.key,mn,"stop domain value must be a number, string, or boolean")];if($r!=="number"&&B!=="categorical"){var Sn="number expected, "+$r+" found";return oi(C)&&B===void 0&&(Sn+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new hr(Fr.key,mn,Sn)]}return B==="categorical"&&$r==="number"&&(!isFinite(kn)||Math.floor(kn)!==kn)?[new hr(Fr.key,mn,"integer expected, found "+kn)]:B!=="categorical"&&$r==="number"&&xe!==void 0&&kn<xe?[new hr(Fr.key,mn,"stop domain values must appear in ascending order")]:(xe=kn,B==="categorical"&&kn in he?[new hr(Fr.key,mn,"stop domain values must be unique")]:(he[kn]=!0,[]))}function dr(Fr){return hi({key:Fr.key,value:Fr.value,valueSpec:C,style:Fr.style,styleSpec:Fr.styleSpec})}}function Oo(E){var C=(E.expressionContext==="property"?du:Bl)(Tn(E.value),E.valueSpec);if(C.result==="error")return C.value.map(function(J){return new hr(""+E.key+J.key,E.value,J.message)});var B=C.value.expression||C.value._styleExpression.expression;if(E.expressionContext==="property"&&E.propertyKey==="text-font"&&!B.outputDefined())return[new hr(E.key,E.value,'Invalid data expression for "'+E.propertyKey+'". Output values must be contained as literals within the expression.')];if(E.expressionContext==="property"&&E.propertyType==="layout"&&!sl(B))return[new hr(E.key,E.value,'"feature-state" data expressions are not supported with layout properties.')];if(E.expressionContext==="filter"&&!sl(B))return[new hr(E.key,E.value,'"feature-state" data expressions are not supported with filters.')];if(E.expressionContext&&E.expressionContext.indexOf("cluster")===0){if(!Kl(B,["zoom","feature-state"]))return[new hr(E.key,E.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(E.expressionContext==="cluster-initial"&&!ol(B))return[new hr(E.key,E.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function zu(E){var C=E.value,B=E.key,J=Ja(C);return J!=="boolean"?[new hr(B,C,"boolean expected, "+J+" found")]:[]}function tf(E){var C=E.key,B=E.value,J=Ja(B);return J!=="string"?[new hr(C,B,"color expected, "+J+" found")]:Yl(B)===null?[new hr(C,B,'color expected, "'+B+'" found')]:[]}function xs(E){var C=E.key,B=E.value,J=E.valueSpec,he=[];return Array.isArray(J.values)?J.values.indexOf(en(B))===-1&&he.push(new hr(C,B,"expected one of ["+J.values.join(", ")+"], "+JSON.stringify(B)+" found")):Object.keys(J.values).indexOf(en(B))===-1&&he.push(new hr(C,B,"expected one of ["+Object.keys(J.values).join(", ")+"], "+JSON.stringify(B)+" found")),he}function yu(E){if(E===!0||E===!1)return!0;if(!Array.isArray(E)||E.length===0)return!1;switch(E[0]){case"has":return E.length>=2&&E[1]!=="$id"&&E[1]!=="$type";case"in":return E.length>=3&&(typeof E[1]!="string"||Array.isArray(E[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return E.length!==3||Array.isArray(E[1])||Array.isArray(E[2]);case"any":case"all":for(var C=0,B=E.slice(1);C<B.length;C+=1){var J=B[C];if(!yu(J)&&typeof J!="boolean")return!1}return!0;default:return!0}}var mu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Fu(E){if(E==null)return{filter:function(){return!0},needGeometry:!1};yu(E)||(E=et(E));var C=Bl(E,mu);if(C.result==="error")throw new Error(C.value.map(function(J){return J.key+": "+J.message}).join(", "));var B=We(E);return{filter:function(J,he,xe){return C.value.evaluate(J,he,{},xe)},needGeometry:B}}function ze(E,C){return E<C?-1:E>C?1:0}function We(E){if(!Array.isArray(E))return!1;if(E[0]==="within")return!0;for(var C=1;C<E.length;C++)if(We(E[C]))return!0;return!1}function et(E){if(!E)return!0;var C=E[0];if(E.length<=1)return C!=="any";var B=C==="=="?ot(E[1],E[2],"=="):C==="!="?fr(ot(E[1],E[2],"==")):C==="<"||C===">"||C==="<="||C===">="?ot(E[1],E[2],C):C==="any"?bt(E.slice(1)):C==="all"?["all"].concat(E.slice(1).map(et)):C==="none"?["all"].concat(E.slice(1).map(et).map(fr)):C==="in"?mt(E[1],E.slice(2)):C==="!in"?fr(mt(E[1],E.slice(2))):C==="has"?kt(E[1]):C==="!has"?fr(kt(E[1])):C==="within"?E:!0;return B}function ot(E,C,B){switch(E){case"$type":return["filter-type-"+B,C];case"$id":return["filter-id-"+B,C];default:return["filter-"+B,E,C]}}function bt(E){return["any"].concat(E.map(et))}function mt(E,C){if(C.length===0)return!1;switch(E){case"$type":return["filter-type-in",["literal",C]];case"$id":return["filter-id-in",["literal",C]];default:return C.length>200&&!C.some(function(B){return typeof B!=typeof C[0]})?["filter-in-large",E,["literal",C.sort(ze)]]:["filter-in-small",E,["literal",C]]}}function kt(E){switch(E){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",E]}}function fr(E){return["!",E]}function pr(E){return yu(Tn(E.value))?Oo(vn({},E,{expressionContext:"filter",valueSpec:{value:"boolean"}})):sr(E)}function sr(E){var C=E.value,B=E.key;if(Ja(C)!=="array")return[new hr(B,C,"array expected, "+Ja(C)+" found")];var J=E.styleSpec,he,xe=[];if(C.length<1)return[new hr(B,C,"filter array must have at least 1 element")];switch(xe=xe.concat(xs({key:B+"[0]",value:C[0],valueSpec:J.filter_operator,style:E.style,styleSpec:E.styleSpec})),en(C[0])){case"<":case"<=":case">":case">=":C.length>=2&&en(C[1])==="$type"&&xe.push(new hr(B,C,'"$type" cannot be use with operator "'+C[0]+'"'));case"==":case"!=":C.length!==3&&xe.push(new hr(B,C,'filter array for operator "'+C[0]+'" must have 3 elements'));case"in":case"!in":C.length>=2&&(he=Ja(C[1]),he!=="string"&&xe.push(new hr(B+"[1]",C[1],"string expected, "+he+" found")));for(var Te=2;Te<C.length;Te++)he=Ja(C[Te]),en(C[1])==="$type"?xe=xe.concat(xs({key:B+"["+Te+"]",value:C[Te],valueSpec:J.geometry_type,style:E.style,styleSpec:E.styleSpec})):he!=="string"&&he!=="number"&&he!=="boolean"&&xe.push(new hr(B+"["+Te+"]",C[Te],"string, number, or boolean expected, "+he+" found"));break;case"any":case"all":case"none":for(var Fe=1;Fe<C.length;Fe++)xe=xe.concat(sr({key:B+"["+Fe+"]",value:C[Fe],style:E.style,styleSpec:E.styleSpec}));break;case"has":case"!has":he=Ja(C[1]),C.length!==2?xe.push(new hr(B,C,'filter array for "'+C[0]+'" operator must have 2 elements')):he!=="string"&&xe.push(new hr(B+"[1]",C[1],"string expected, "+he+" found"));break;case"within":he=Ja(C[1]),C.length!==2?xe.push(new hr(B,C,'filter array for "'+C[0]+'" operator must have 2 elements')):he!=="object"&&xe.push(new hr(B+"[1]",C[1],"object expected, "+he+" found"));break}return xe}function xr(E,C){var B=E.key,J=E.style,he=E.styleSpec,xe=E.value,Te=E.objectKey,Fe=he[C+"_"+E.layerType];if(!Fe)return[];var qe=Te.match(/^(.*)-transition$/);if(C==="paint"&&qe&&Fe[qe[1]]&&Fe[qe[1]].transition)return hi({key:B,value:xe,valueSpec:he.transition,style:J,styleSpec:he});var ft=E.valueSpec||Fe[Te];if(!ft)return[new hr(B,xe,'unknown property "'+Te+'"')];var pt;if(Ja(xe)==="string"&&oi(ft)&&!ft.tokens&&(pt=/^{([^}]+)}$/.exec(xe)))return[new hr(B,xe,'"'+Te+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(pt[1])+" }`.")];var Ft=[];return E.layerType==="symbol"&&(Te==="text-field"&&J&&!J.glyphs&&Ft.push(new hr(B,xe,'use of "text-field" requires a style "glyphs" property')),Te==="text-font"&&va(Tn(xe))&&en(xe.type)==="identity"&&Ft.push(new hr(B,xe,'"text-font" does not support identity functions'))),Ft.concat(hi({key:E.key,value:xe,valueSpec:ft,style:J,styleSpec:he,expressionContext:"property",propertyType:C,propertyKey:Te}))}function Dr(E){return xr(E,"paint")}function Xr(E){return xr(E,"layout")}function qr(E){var C=[],B=E.value,J=E.key,he=E.style,xe=E.styleSpec;!B.type&&!B.ref&&C.push(new hr(J,B,'either "type" or "ref" is required'));var Te=en(B.type),Fe=en(B.ref);if(B.id)for(var qe=en(B.id),ft=0;ft<E.arrayIndex;ft++){var pt=he.layers[ft];en(pt.id)===qe&&C.push(new hr(J,B.id,'duplicate layer id "'+B.id+'", previously used at line '+pt.id.__line__))}if("ref"in B){["type","source","source-layer","filter","layout"].forEach(function(dr){dr in B&&C.push(new hr(J,B[dr],'"'+dr+'" is prohibited for ref layers'))});var Ft;he.layers.forEach(function(dr){en(dr.id)===Fe&&(Ft=dr)}),Ft?Ft.ref?C.push(new hr(J,B.ref,"ref cannot reference another ref layer")):Te=en(Ft.type):C.push(new hr(J,B.ref,'ref layer "'+Fe+'" not found'))}else if(Te!=="background")if(!B.source)C.push(new hr(J,B,'missing required property "source"'));else{var tr=he.sources&&he.sources[B.source],Qt=tr&&en(tr.type);tr?Qt==="vector"&&Te==="raster"?C.push(new hr(J,B.source,'layer "'+B.id+'" requires a raster source')):Qt==="raster"&&Te!=="raster"?C.push(new hr(J,B.source,'layer "'+B.id+'" requires a vector source')):Qt==="vector"&&!B["source-layer"]?C.push(new hr(J,B,'layer "'+B.id+'" must specify a "source-layer"')):Qt==="raster-dem"&&Te!=="hillshade"?C.push(new hr(J,B.source,"raster-dem source can only be used with layer type 'hillshade'.")):Te==="line"&&B.paint&&B.paint["line-gradient"]&&(Qt!=="geojson"||!tr.lineMetrics)&&C.push(new hr(J,B,'layer "'+B.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):C.push(new hr(J,B.source,'source "'+B.source+'" not found'))}return C=C.concat(Es({key:J,value:B,valueSpec:xe.layer,style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return hi({key:J+".type",value:B.type,valueSpec:xe.layer.type,style:E.style,styleSpec:E.styleSpec,object:B,objectKey:"type"})},filter:pr,layout:function(Fr){return Es({layer:B,key:Fr.key,value:Fr.value,style:Fr.style,styleSpec:Fr.styleSpec,objectElementValidators:{"*":function($r){return Xr(vn({layerType:Te},$r))}}})},paint:function(Fr){return Es({layer:B,key:Fr.key,value:Fr.value,style:Fr.style,styleSpec:Fr.styleSpec,objectElementValidators:{"*":function($r){return Dr(vn({layerType:Te},$r))}}})}}})),C}function bn(E){var C=E.value,B=E.key,J=Ja(C);return J!=="string"?[new hr(B,C,"string expected, "+J+" found")]:[]}var Dn={promoteId:ga};function Wn(E){var C=E.value,B=E.key,J=E.styleSpec,he=E.style;if(!C.type)return[new hr(B,C,'"type" is required')];var xe=en(C.type),Te;switch(xe){case"vector":case"raster":case"raster-dem":return Te=Es({key:B,value:C,valueSpec:J["source_"+xe.replace("-","_")],style:E.style,styleSpec:J,objectElementValidators:Dn}),Te;case"geojson":if(Te=Es({key:B,value:C,valueSpec:J.source_geojson,style:he,styleSpec:J,objectElementValidators:Dn}),C.cluster)for(var Fe in C.clusterProperties){var qe=C.clusterProperties[Fe],ft=qe[0],pt=qe[1],Ft=typeof ft=="string"?[ft,["accumulated"],["get",Fe]]:ft;Te.push.apply(Te,Oo({key:B+"."+Fe+".map",value:pt,expressionContext:"cluster-map"})),Te.push.apply(Te,Oo({key:B+"."+Fe+".reduce",value:Ft,expressionContext:"cluster-reduce"}))}return Te;case"video":return Es({key:B,value:C,valueSpec:J.source_video,style:he,styleSpec:J});case"image":return Es({key:B,value:C,valueSpec:J.source_image,style:he,styleSpec:J});case"canvas":return[new hr(B,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return xs({key:B+".type",value:C.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:he,styleSpec:J})}}function ga(E){var C=E.key,B=E.value;if(Ja(B)==="string")return bn({key:C,value:B});var J=[];for(var he in B)J.push.apply(J,bn({key:C+"."+he,value:B[he]}));return J}function xa(E){var C=E.value,B=E.styleSpec,J=B.light,he=E.style,xe=[],Te=Ja(C);if(C===void 0)return xe;if(Te!=="object")return xe=xe.concat([new hr("light",C,"object expected, "+Te+" found")]),xe;for(var Fe in C){var qe=Fe.match(/^(.*)-transition$/);qe&&J[qe[1]]&&J[qe[1]].transition?xe=xe.concat(hi({key:Fe,value:C[Fe],valueSpec:B.transition,style:he,styleSpec:B})):J[Fe]?xe=xe.concat(hi({key:Fe,value:C[Fe],valueSpec:J[Fe],style:he,styleSpec:B})):xe=xe.concat([new hr(Fe,C[Fe],'unknown property "'+Fe+'"')])}return xe}function Ka(E){return bn(E).length===0?[]:Oo(E)}function Ya(E){return bn(E).length===0?[]:Oo(E)}var ei={"*":function(){return[]},array:Xu,boolean:zu,number:Ru,color:tf,constants:rn,enum:xs,filter:pr,function:Iu,layer:qr,object:Es,source:Wn,light:xa,string:bn,formatted:Ka,resolvedImage:Ya};function hi(E){var C=E.value,B=E.valueSpec,J=E.styleSpec;if(B.expression&&va(en(C)))return Iu(E);if(B.expression&&bo(Tn(C)))return Oo(E);if(B.type&&ei[B.type])return ei[B.type](E);var he=Es(vn({},E,{valueSpec:B.type?J[B.type]:B}));return he}function oo(E){var C=E.value,B=E.key,J=bn(E);return J.length||(C.indexOf("{fontstack}")===-1&&J.push(new hr(B,C,'"glyphs" url must include a "{fontstack}" token')),C.indexOf("{range}")===-1&&J.push(new hr(B,C,'"glyphs" url must include a "{range}" token'))),J}function ri(E,C){C===void 0&&(C=Vt);var B=[];return B=B.concat(hi({key:"",value:E,valueSpec:C.$root,styleSpec:C,style:E,objectElementValidators:{glyphs:oo,"*":function(){return[]}}})),E.constants&&(B=B.concat(rn({key:"constants",value:E.constants,style:E,styleSpec:C}))),Yi(B)}ri.source=co(Wn),ri.light=co(xa),ri.layer=co(qr),ri.filter=co(pr),ri.paintProperty=co(Dr),ri.layoutProperty=co(Xr);function Yi(E){return[].concat(E).sort(function(C,B){return C.line-B.line})}function co(E){return function(){for(var C=[],B=arguments.length;B--;)C[B]=arguments[B];return Yi(E.apply(this,C))}}var wo=ri,bi=wo.light,Mi=wo.paintProperty,cs=wo.layoutProperty;function yo(E,C){var B=!1;if(C&&C.length)for(var J=0,he=C;J<he.length;J+=1){var xe=he[J];E.fire(new br(new Error(xe.message))),B=!0}return B}var Do=le,Yo=3;function le(E,C,B){var J=this.cells=[];if(E instanceof ArrayBuffer){this.arrayBuffer=E;var he=new Int32Array(this.arrayBuffer);E=he[0],C=he[1],B=he[2],this.d=C+2*B;for(var xe=0;xe<this.d*this.d;xe++){var Te=he[Yo+xe],Fe=he[Yo+xe+1];J.push(Te===Fe?null:he.subarray(Te,Fe))}var qe=he[Yo+J.length],ft=he[Yo+J.length+1];this.keys=he.subarray(qe,ft),this.bboxes=he.subarray(ft),this.insert=this._insertReadonly}else{this.d=C+2*B;for(var pt=0;pt<this.d*this.d;pt++)J.push([]);this.keys=[],this.bboxes=[]}this.n=C,this.extent=E,this.padding=B,this.scale=C/E,this.uid=0;var Ft=B/C*E;this.min=-Ft,this.max=E+Ft}le.prototype.insert=function(E,C,B,J,he){this._forEachCell(C,B,J,he,this._insertCell,this.uid++),this.keys.push(E),this.bboxes.push(C),this.bboxes.push(B),this.bboxes.push(J),this.bboxes.push(he)},le.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},le.prototype._insertCell=function(E,C,B,J,he,xe){this.cells[he].push(xe)},le.prototype.query=function(E,C,B,J,he){var xe=this.min,Te=this.max;if(E<=xe&&C<=xe&&Te<=B&&Te<=J&&!he)return Array.prototype.slice.call(this.keys);var Fe=[],qe={};return this._forEachCell(E,C,B,J,this._queryCell,Fe,qe,he),Fe},le.prototype._queryCell=function(E,C,B,J,he,xe,Te,Fe){var qe=this.cells[he];if(qe!==null)for(var ft=this.keys,pt=this.bboxes,Ft=0;Ft<qe.length;Ft++){var tr=qe[Ft];if(Te[tr]===void 0){var Qt=tr*4;(Fe?Fe(pt[Qt+0],pt[Qt+1],pt[Qt+2],pt[Qt+3]):E<=pt[Qt+2]&&C<=pt[Qt+3]&&B>=pt[Qt+0]&&J>=pt[Qt+1])?(Te[tr]=!0,xe.push(ft[tr])):Te[tr]=!1}}},le.prototype._forEachCell=function(E,C,B,J,he,xe,Te,Fe){for(var qe=this._convertToCellCoord(E),ft=this._convertToCellCoord(C),pt=this._convertToCellCoord(B),Ft=this._convertToCellCoord(J),tr=qe;tr<=pt;tr++)for(var Qt=ft;Qt<=Ft;Qt++){var dr=this.d*Qt+tr;if(!(Fe&&!Fe(this._convertFromCellCoord(tr),this._convertFromCellCoord(Qt),this._convertFromCellCoord(tr+1),this._convertFromCellCoord(Qt+1)))&&he.call(this,E,C,B,J,dr,xe,Te,Fe))return}},le.prototype._convertFromCellCoord=function(E){return(E-this.padding)/this.scale},le.prototype._convertToCellCoord=function(E){return Math.max(0,Math.min(this.d-1,Math.floor(E*this.scale)+this.padding))},le.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var E=this.cells,C=Yo+this.cells.length+1+1,B=0,J=0;J<this.cells.length;J++)B+=this.cells[J].length;var he=new Int32Array(C+B+this.keys.length+this.bboxes.length);he[0]=this.extent,he[1]=this.n,he[2]=this.padding;for(var xe=C,Te=0;Te<E.length;Te++){var Fe=E[Te];he[Yo+Te]=xe,he.set(Fe,xe),xe+=Fe.length}return he[Yo+E.length]=xe,he.set(this.keys,xe),xe+=this.keys.length,he[Yo+E.length+1]=xe,he.set(this.bboxes,xe),xe+=this.bboxes.length,he.buffer};var _e=self.ImageData,Le=self.ImageBitmap,Be={};function Oe(E,C,B){B===void 0&&(B={}),Object.defineProperty(C,"_classRegistryKey",{value:E,writeable:!1}),Be[E]={klass:C,omit:B.omit||[],shallow:B.shallow||[]}}Oe("Object",Object),Do.serialize=function(C,B){var J=C.toArrayBuffer();return B&&B.push(J),{buffer:J}},Do.deserialize=function(C){return new Do(C.buffer)},Oe("Grid",Do),Oe("Color",vi),Oe("Error",Error),Oe("ResolvedImage",So),Oe("StylePropertyFunction",Nl),Oe("StyleExpression",us,{omit:["_evaluator"]}),Oe("ZoomDependentExpression",fs),Oe("ZoomConstantExpression",Ql),Oe("CompoundExpression",ko,{omit:["_evaluate"]});for(var Ke in Jn)Jn[Ke]._classRegistryKey||Oe("Expression_"+Ke,Jn[Ke]);function xt(E){return E&&typeof ArrayBuffer<"u"&&(E instanceof ArrayBuffer||E.constructor&&E.constructor.name==="ArrayBuffer")}function vt(E){return Le&&E instanceof Le}function Pt(E,C){if(E==null||typeof E=="boolean"||typeof E=="number"||typeof E=="string"||E instanceof Boolean||E instanceof Number||E instanceof String||E instanceof Date||E instanceof RegExp)return E;if(xt(E)||vt(E))return C&&C.push(E),E;if(ArrayBuffer.isView(E)){var B=E;return C&&C.push(B.buffer),B}if(E instanceof _e)return C&&C.push(E.data.buffer),E;if(Array.isArray(E)){for(var J=[],he=0,xe=E;he<xe.length;he+=1){var Te=xe[he];J.push(Pt(Te,C))}return J}if(typeof E=="object"){var Fe=E.constructor,qe=Fe._classRegistryKey;if(!qe)throw new Error("can't serialize object of unregistered class");var ft=Fe.serialize?Fe.serialize(E,C):{};if(!Fe.serialize){for(var pt in E)if(!!E.hasOwnProperty(pt)&&!(Be[qe].omit.indexOf(pt)>=0)){var Ft=E[pt];ft[pt]=Be[qe].shallow.indexOf(pt)>=0?Ft:Pt(Ft,C)}E instanceof Error&&(ft.message=E.message)}if(ft.$name)throw new Error("$name property is reserved for worker serialization logic.");return qe!=="Object"&&(ft.$name=qe),ft}throw new Error("can't serialize object of type "+typeof E)}function jt(E){if(E==null||typeof E=="boolean"||typeof E=="number"||typeof E=="string"||E instanceof Boolean||E instanceof Number||E instanceof String||E instanceof Date||E instanceof RegExp||xt(E)||vt(E)||ArrayBuffer.isView(E)||E instanceof _e)return E;if(Array.isArray(E))return E.map(jt);if(typeof E=="object"){var C=E.$name||"Object",B=Be[C],J=B.klass;if(!J)throw new Error("can't deserialize unregistered class "+C);if(J.deserialize)return J.deserialize(E);for(var he=Object.create(J.prototype),xe=0,Te=Object.keys(E);xe<Te.length;xe+=1){var Fe=Te[xe];if(Fe!=="$name"){var qe=E[Fe];he[Fe]=Be[C].shallow.indexOf(Fe)>=0?qe:jt(qe)}}return he}throw new Error("can't deserialize object of type "+typeof E)}var qt=function(){this.first=!0};qt.prototype.update=function(C,B){var J=Math.floor(C);return this.first?(this.first=!1,this.lastIntegerZoom=J,this.lastIntegerZoomTime=0,this.lastZoom=C,this.lastFloorZoom=J,!0):(this.lastFloorZoom>J?(this.lastIntegerZoom=J+1,this.lastIntegerZoomTime=B):this.lastFloorZoom<J&&(this.lastIntegerZoom=J,this.lastIntegerZoomTime=B),C!==this.lastZoom?(this.lastZoom=C,this.lastFloorZoom=J,!0):!1)};var er={"Latin-1 Supplement":function(E){return E>=128&&E<=255},Arabic:function(E){return E>=1536&&E<=1791},"Arabic Supplement":function(E){return E>=1872&&E<=1919},"Arabic Extended-A":function(E){return E>=2208&&E<=2303},"Hangul Jamo":function(E){return E>=4352&&E<=4607},"Unified Canadian Aboriginal Syllabics":function(E){return E>=5120&&E<=5759},Khmer:function(E){return E>=6016&&E<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(E){return E>=6320&&E<=6399},"General Punctuation":function(E){return E>=8192&&E<=8303},"Letterlike Symbols":function(E){return E>=8448&&E<=8527},"Number Forms":function(E){return E>=8528&&E<=8591},"Miscellaneous Technical":function(E){return E>=8960&&E<=9215},"Control Pictures":function(E){return E>=9216&&E<=9279},"Optical Character Recognition":function(E){return E>=9280&&E<=9311},"Enclosed Alphanumerics":function(E){return E>=9312&&E<=9471},"Geometric Shapes":function(E){return E>=9632&&E<=9727},"Miscellaneous Symbols":function(E){return E>=9728&&E<=9983},"Miscellaneous Symbols and Arrows":function(E){return E>=11008&&E<=11263},"CJK Radicals Supplement":function(E){return E>=11904&&E<=12031},"Kangxi Radicals":function(E){return E>=12032&&E<=12255},"Ideographic Description Characters":function(E){return E>=12272&&E<=12287},"CJK Symbols and Punctuation":function(E){return E>=12288&&E<=12351},Hiragana:function(E){return E>=12352&&E<=12447},Katakana:function(E){return E>=12448&&E<=12543},Bopomofo:function(E){return E>=12544&&E<=12591},"Hangul Compatibility Jamo":function(E){return E>=12592&&E<=12687},Kanbun:function(E){return E>=12688&&E<=12703},"Bopomofo Extended":function(E){return E>=12704&&E<=12735},"CJK Strokes":function(E){return E>=12736&&E<=12783},"Katakana Phonetic Extensions":function(E){return E>=12784&&E<=12799},"Enclosed CJK Letters and Months":function(E){return E>=12800&&E<=13055},"CJK Compatibility":function(E){return E>=13056&&E<=13311},"CJK Unified Ideographs Extension A":function(E){return E>=13312&&E<=19903},"Yijing Hexagram Symbols":function(E){return E>=19904&&E<=19967},"CJK Unified Ideographs":function(E){return E>=19968&&E<=40959},"Yi Syllables":function(E){return E>=40960&&E<=42127},"Yi Radicals":function(E){return E>=42128&&E<=42191},"Hangul Jamo Extended-A":function(E){return E>=43360&&E<=43391},"Hangul Syllables":function(E){return E>=44032&&E<=55215},"Hangul Jamo Extended-B":function(E){return E>=55216&&E<=55295},"Private Use Area":function(E){return E>=57344&&E<=63743},"CJK Compatibility Ideographs":function(E){return E>=63744&&E<=64255},"Arabic Presentation Forms-A":function(E){return E>=64336&&E<=65023},"Vertical Forms":function(E){return E>=65040&&E<=65055},"CJK Compatibility Forms":function(E){return E>=65072&&E<=65103},"Small Form Variants":function(E){return E>=65104&&E<=65135},"Arabic Presentation Forms-B":function(E){return E>=65136&&E<=65279},"Halfwidth and Fullwidth Forms":function(E){return E>=65280&&E<=65519}};function Mr(E){for(var C=0,B=E;C<B.length;C+=1){var J=B[C];if(Nr(J.charCodeAt(0)))return!0}return!1}function Qr(E){for(var C=0,B=E;C<B.length;C+=1){var J=B[C];if(!ln(J.charCodeAt(0)))return!1}return!0}function ln(E){return!(er.Arabic(E)||er["Arabic Supplement"](E)||er["Arabic Extended-A"](E)||er["Arabic Presentation Forms-A"](E)||er["Arabic Presentation Forms-B"](E))}function Lr(E){return E<11904?!1:!!(er["Bopomofo Extended"](E)||er.Bopomofo(E)||er["CJK Compatibility Forms"](E)||er["CJK Compatibility Ideographs"](E)||er["CJK Compatibility"](E)||er["CJK Radicals Supplement"](E)||er["CJK Strokes"](E)||er["CJK Symbols and Punctuation"](E)||er["CJK Unified Ideographs Extension A"](E)||er["CJK Unified Ideographs"](E)||er["Enclosed CJK Letters and Months"](E)||er["Halfwidth and Fullwidth Forms"](E)||er.Hiragana(E)||er["Ideographic Description Characters"](E)||er["Kangxi Radicals"](E)||er["Katakana Phonetic Extensions"](E)||er.Katakana(E)||er["Vertical Forms"](E)||er["Yi Radicals"](E)||er["Yi Syllables"](E))}function Nr(E){return E===746||E===747?!0:E<4352?!1:!!(er["Bopomofo Extended"](E)||er.Bopomofo(E)||er["CJK Compatibility Forms"](E)&&!(E>=65097&&E<=65103)||er["CJK Compatibility Ideographs"](E)||er["CJK Compatibility"](E)||er["CJK Radicals Supplement"](E)||er["CJK Strokes"](E)||er["CJK Symbols and Punctuation"](E)&&!(E>=12296&&E<=12305)&&!(E>=12308&&E<=12319)&&E!==12336||er["CJK Unified Ideographs Extension A"](E)||er["CJK Unified Ideographs"](E)||er["Enclosed CJK Letters and Months"](E)||er["Hangul Compatibility Jamo"](E)||er["Hangul Jamo Extended-A"](E)||er["Hangul Jamo Extended-B"](E)||er["Hangul Jamo"](E)||er["Hangul Syllables"](E)||er.Hiragana(E)||er["Ideographic Description Characters"](E)||er.Kanbun(E)||er["Kangxi Radicals"](E)||er["Katakana Phonetic Extensions"](E)||er.Katakana(E)&&E!==12540||er["Halfwidth and Fullwidth Forms"](E)&&E!==65288&&E!==65289&&E!==65293&&!(E>=65306&&E<=65310)&&E!==65339&&E!==65341&&E!==65343&&!(E>=65371&&E<=65503)&&E!==65507&&!(E>=65512&&E<=65519)||er["Small Form Variants"](E)&&!(E>=65112&&E<=65118)&&!(E>=65123&&E<=65126)||er["Unified Canadian Aboriginal Syllabics"](E)||er["Unified Canadian Aboriginal Syllabics Extended"](E)||er["Vertical Forms"](E)||er["Yijing Hexagram Symbols"](E)||er["Yi Syllables"](E)||er["Yi Radicals"](E))}function Zr(E){return!!(er["Latin-1 Supplement"](E)&&(E===167||E===169||E===174||E===177||E===188||E===189||E===190||E===215||E===247)||er["General Punctuation"](E)&&(E===8214||E===8224||E===8225||E===8240||E===8241||E===8251||E===8252||E===8258||E===8263||E===8264||E===8265||E===8273)||er["Letterlike Symbols"](E)||er["Number Forms"](E)||er["Miscellaneous Technical"](E)&&(E>=8960&&E<=8967||E>=8972&&E<=8991||E>=8996&&E<=9e3||E===9003||E>=9085&&E<=9114||E>=9150&&E<=9165||E===9167||E>=9169&&E<=9179||E>=9186&&E<=9215)||er["Control Pictures"](E)&&E!==9251||er["Optical Character Recognition"](E)||er["Enclosed Alphanumerics"](E)||er["Geometric Shapes"](E)||er["Miscellaneous Symbols"](E)&&!(E>=9754&&E<=9759)||er["Miscellaneous Symbols and Arrows"](E)&&(E>=11026&&E<=11055||E>=11088&&E<=11097||E>=11192&&E<=11243)||er["CJK Symbols and Punctuation"](E)||er.Katakana(E)||er["Private Use Area"](E)||er["CJK Compatibility Forms"](E)||er["Small Form Variants"](E)||er["Halfwidth and Fullwidth Forms"](E)||E===8734||E===8756||E===8757||E>=9984&&E<=10087||E>=10102&&E<=10131||E===65532||E===65533)}function an(E){return!(Nr(E)||Zr(E))}function sn(E){return er.Arabic(E)||er["Arabic Supplement"](E)||er["Arabic Extended-A"](E)||er["Arabic Presentation Forms-A"](E)||er["Arabic Presentation Forms-B"](E)}function Kr(E){return E>=1424&&E<=2303||er["Arabic Presentation Forms-A"](E)||er["Arabic Presentation Forms-B"](E)}function Un(E,C){return!(!C&&Kr(E)||E>=2304&&E<=3583||E>=3840&&E<=4255||er.Khmer(E))}function ra(E){for(var C=0,B=E;C<B.length;C+=1){var J=B[C];if(Kr(J.charCodeAt(0)))return!0}return!1}function _a(E,C){for(var B=0,J=E;B<J.length;B+=1){var he=J[B];if(!Un(he.charCodeAt(0),C))return!1}return!0}var ia={unavailable:"unavailable",deferred:"deferred",loading:"loading",loaded:"loaded",error:"error"},ka=null,la=ia.unavailable,Na=null,Pa=function(E){E&&typeof E=="string"&&E.indexOf("NetworkError")>-1&&(la=ia.error),ka&&ka(E)};function $a(){yi.fire(new kr("pluginStateChange",{pluginStatus:la,pluginURL:Na}))}var yi=new Ar,ho=function(){return la},zi=function(E){return E({pluginStatus:la,pluginURL:Na}),yi.on("pluginStateChange",E),E},fa=function(E,C,B){if(B===void 0&&(B=!1),la===ia.deferred||la===ia.loading||la===ia.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Na=Q.resolveURL(E),la=ia.deferred,ka=C,$a(),B||ai()},ai=function(){if(la!==ia.deferred||!Na)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");la=ia.loading,$a(),Na&&lt({url:Na},function(E){E?Pa(E):(la=ia.loaded,$a())})},Xa={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return la===ia.loaded||Xa.applyArabicShaping!=null},isLoading:function(){return la===ia.loading},setState:function(C){la=C.pluginStatus,Na=C.pluginURL},isParsed:function(){return Xa.applyArabicShaping!=null&&Xa.processBidirectionalText!=null&&Xa.processStyledBidirectionalText!=null},getPluginURL:function(){return Na}},Si=function(){!Xa.isLoading()&&!Xa.isLoaded()&&ho()==="deferred"&&ai()},si=function(C,B){this.zoom=C,B?(this.now=B.now,this.fadeDuration=B.fadeDuration,this.zoomHistory=B.zoomHistory,this.transition=B.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new qt,this.transition={})};si.prototype.isSupportedScript=function(C){return _a(C,Xa.isLoaded())},si.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},si.prototype.getCrossfadeParameters=function(){var C=this.zoom,B=C-Math.floor(C),J=this.crossFadingFactor();return C>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:B+(1-B)*J}:{fromScale:.5,toScale:1,t:1-(1-J)*B}};var so=function(C,B){this.property=C,this.value=B,this.expression=gf(B===void 0?C.specification.default:B,C.specification)};so.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},so.prototype.possiblyEvaluate=function(C,B,J){return this.property.possiblyEvaluate(this,C,B,J)};var qi=function(C){this.property=C,this.value=new so(C,void 0)};qi.prototype.transitioned=function(C,B){return new Wo(this.property,this.value,B,w({},C.transition,this.transition),C.now)},qi.prototype.untransitioned=function(){return new Wo(this.property,this.value,null,{},0)};var mo=function(C){this._properties=C,this._values=Object.create(C.defaultTransitionablePropertyValues)};mo.prototype.getValue=function(C){return I(this._values[C].value.value)},mo.prototype.setValue=function(C,B){this._values.hasOwnProperty(C)||(this._values[C]=new qi(this._values[C].property)),this._values[C].value=new so(this._values[C].property,B===null?void 0:I(B))},mo.prototype.getTransition=function(C){return I(this._values[C].transition)},mo.prototype.setTransition=function(C,B){this._values.hasOwnProperty(C)||(this._values[C]=new qi(this._values[C].property)),this._values[C].transition=I(B)||void 0},mo.prototype.serialize=function(){for(var C={},B=0,J=Object.keys(this._values);B<J.length;B+=1){var he=J[B],xe=this.getValue(he);xe!==void 0&&(C[he]=xe);var Te=this.getTransition(he);Te!==void 0&&(C[he+"-transition"]=Te)}return C},mo.prototype.transitioned=function(C,B){for(var J=new Bo(this._properties),he=0,xe=Object.keys(this._values);he<xe.length;he+=1){var Te=xe[he];J._values[Te]=this._values[Te].transitioned(C,B._values[Te])}return J},mo.prototype.untransitioned=function(){for(var C=new Bo(this._properties),B=0,J=Object.keys(this._values);B<J.length;B+=1){var he=J[B];C._values[he]=this._values[he].untransitioned()}return C};var Wo=function(C,B,J,he,xe){this.property=C,this.value=B,this.begin=xe+he.delay||0,this.end=this.begin+he.duration||0,C.specification.transition&&(he.delay||he.duration)&&(this.prior=J)};Wo.prototype.possiblyEvaluate=function(C,B,J){var he=C.now||0,xe=this.value.possiblyEvaluate(C,B,J),Te=this.prior;if(Te){if(he>this.end)return this.prior=null,xe;if(this.value.isDataDriven())return this.prior=null,xe;if(he<this.begin)return Te.possiblyEvaluate(C,B,J);var Fe=(he-this.begin)/(this.end-this.begin);return this.property.interpolate(Te.possiblyEvaluate(C,B,J),xe,x(Fe))}else return xe};var Bo=function(C){this._properties=C,this._values=Object.create(C.defaultTransitioningPropertyValues)};Bo.prototype.possiblyEvaluate=function(C,B,J){for(var he=new Ni(this._properties),xe=0,Te=Object.keys(this._values);xe<Te.length;xe+=1){var Fe=Te[xe];he._values[Fe]=this._values[Fe].possiblyEvaluate(C,B,J)}return he},Bo.prototype.hasTransition=function(){for(var C=0,B=Object.keys(this._values);C<B.length;C+=1){var J=B[C];if(this._values[J].prior)return!0}return!1};var Xo=function(C){this._properties=C,this._values=Object.create(C.defaultPropertyValues)};Xo.prototype.getValue=function(C){return I(this._values[C].value)},Xo.prototype.setValue=function(C,B){this._values[C]=new so(this._values[C].property,B===null?void 0:I(B))},Xo.prototype.serialize=function(){for(var C={},B=0,J=Object.keys(this._values);B<J.length;B+=1){var he=J[B],xe=this.getValue(he);xe!==void 0&&(C[he]=xe)}return C},Xo.prototype.possiblyEvaluate=function(C,B,J){for(var he=new Ni(this._properties),xe=0,Te=Object.keys(this._values);xe<Te.length;xe+=1){var Fe=Te[xe];he._values[Fe]=this._values[Fe].possiblyEvaluate(C,B,J)}return he};var Wi=function(C,B,J){this.property=C,this.value=B,this.parameters=J};Wi.prototype.isConstant=function(){return this.value.kind==="constant"},Wi.prototype.constantOr=function(C){return this.value.kind==="constant"?this.value.value:C},Wi.prototype.evaluate=function(C,B,J,he){return this.property.evaluate(this.value,this.parameters,C,B,J,he)};var Ni=function(C){this._properties=C,this._values=Object.create(C.defaultPossiblyEvaluatedValues)};Ni.prototype.get=function(C){return this._values[C]};var Ia=function(C){this.specification=C};Ia.prototype.possiblyEvaluate=function(C,B){return C.expression.evaluate(B)},Ia.prototype.interpolate=function(C,B,J){var he=Zs[this.specification.type];return he?he(C,B,J):C};var Za=function(C,B){this.specification=C,this.overrides=B};Za.prototype.possiblyEvaluate=function(C,B,J,he){return C.expression.kind==="constant"||C.expression.kind==="camera"?new Wi(this,{kind:"constant",value:C.expression.evaluate(B,null,{},J,he)},B):new Wi(this,C.expression,B)},Za.prototype.interpolate=function(C,B,J){if(C.value.kind!=="constant"||B.value.kind!=="constant")return C;if(C.value.value===void 0||B.value.value===void 0)return new Wi(this,{kind:"constant",value:void 0},C.parameters);var he=Zs[this.specification.type];return he?new Wi(this,{kind:"constant",value:he(C.value.value,B.value.value,J)},C.parameters):C},Za.prototype.evaluate=function(C,B,J,he,xe,Te){return C.kind==="constant"?C.value:C.evaluate(B,J,he,xe,Te)};var _o=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.possiblyEvaluate=function(J,he,xe,Te){if(J.value===void 0)return new Wi(this,{kind:"constant",value:void 0},he);if(J.expression.kind==="constant"){var Fe=J.expression.evaluate(he,null,{},xe,Te),qe=J.property.specification.type==="resolvedImage",ft=qe&&typeof Fe!="string"?Fe.name:Fe,pt=this._calculate(ft,ft,ft,he);return new Wi(this,{kind:"constant",value:pt},he)}else if(J.expression.kind==="camera"){var Ft=this._calculate(J.expression.evaluate({zoom:he.zoom-1}),J.expression.evaluate({zoom:he.zoom}),J.expression.evaluate({zoom:he.zoom+1}),he);return new Wi(this,{kind:"constant",value:Ft},he)}else return new Wi(this,J.expression,he)},C.prototype.evaluate=function(J,he,xe,Te,Fe,qe){if(J.kind==="source"){var ft=J.evaluate(he,xe,Te,Fe,qe);return this._calculate(ft,ft,ft,he)}else return J.kind==="composite"?this._calculate(J.evaluate({zoom:Math.floor(he.zoom)-1},xe,Te),J.evaluate({zoom:Math.floor(he.zoom)},xe,Te),J.evaluate({zoom:Math.floor(he.zoom)+1},xe,Te),he):J.value},C.prototype._calculate=function(J,he,xe,Te){var Fe=Te.zoom;return Fe>Te.zoomHistory.lastIntegerZoom?{from:J,to:he}:{from:xe,to:he}},C.prototype.interpolate=function(J){return J},C}(Za),ro=function(C){this.specification=C};ro.prototype.possiblyEvaluate=function(C,B,J,he){if(C.value!==void 0)if(C.expression.kind==="constant"){var xe=C.expression.evaluate(B,null,{},J,he);return this._calculate(xe,xe,xe,B)}else return this._calculate(C.expression.evaluate(new si(Math.floor(B.zoom-1),B)),C.expression.evaluate(new si(Math.floor(B.zoom),B)),C.expression.evaluate(new si(Math.floor(B.zoom+1),B)),B)},ro.prototype._calculate=function(C,B,J,he){var xe=he.zoom;return xe>he.zoomHistory.lastIntegerZoom?{from:C,to:B}:{from:J,to:B}},ro.prototype.interpolate=function(C){return C};var Ro=function(C){this.specification=C};Ro.prototype.possiblyEvaluate=function(C,B,J,he){return!!C.expression.evaluate(B,null,{},J,he)},Ro.prototype.interpolate=function(){return!1};var ji=function(C){this.properties=C,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(var B in C){var J=C[B];J.specification.overridable&&this.overridableProperties.push(B);var he=this.defaultPropertyValues[B]=new so(J,void 0),xe=this.defaultTransitionablePropertyValues[B]=new qi(J);this.defaultTransitioningPropertyValues[B]=xe.untransitioned(),this.defaultPossiblyEvaluatedValues[B]=he.possiblyEvaluate({})}};Oe("DataDrivenProperty",Za),Oe("DataConstantProperty",Ia),Oe("CrossFadedDataDrivenProperty",_o),Oe("CrossFadedProperty",ro),Oe("ColorRampProperty",Ro);var Zo="-transition",bs=function(E){function C(B,J){if(E.call(this),this.id=B.id,this.type=B.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},B.type!=="custom"&&(B=B,this.metadata=B.metadata,this.minzoom=B.minzoom,this.maxzoom=B.maxzoom,B.type!=="background"&&(this.source=B.source,this.sourceLayer=B["source-layer"],this.filter=B.filter),J.layout&&(this._unevaluatedLayout=new Xo(J.layout)),J.paint)){this._transitionablePaint=new mo(J.paint);for(var he in B.paint)this.setPaintProperty(he,B.paint[he],{validate:!1});for(var xe in B.layout)this.setLayoutProperty(xe,B.layout[xe],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ni(J.paint)}}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},C.prototype.getLayoutProperty=function(J){return J==="visibility"?this.visibility:this._unevaluatedLayout.getValue(J)},C.prototype.setLayoutProperty=function(J,he,xe){if(xe===void 0&&(xe={}),he!=null){var Te="layers."+this.id+".layout."+J;if(this._validate(cs,Te,J,he,xe))return}if(J==="visibility"){this.visibility=he;return}this._unevaluatedLayout.setValue(J,he)},C.prototype.getPaintProperty=function(J){return k(J,Zo)?this._transitionablePaint.getTransition(J.slice(0,-Zo.length)):this._transitionablePaint.getValue(J)},C.prototype.setPaintProperty=function(J,he,xe){if(xe===void 0&&(xe={}),he!=null){var Te="layers."+this.id+".paint."+J;if(this._validate(Mi,Te,J,he,xe))return!1}if(k(J,Zo))return this._transitionablePaint.setTransition(J.slice(0,-Zo.length),he||void 0),!1;var Fe=this._transitionablePaint._values[J],qe=Fe.property.specification["property-type"]==="cross-faded-data-driven",ft=Fe.value.isDataDriven(),pt=Fe.value;this._transitionablePaint.setValue(J,he),this._handleSpecialPaintPropertyUpdate(J);var Ft=this._transitionablePaint._values[J].value,tr=Ft.isDataDriven();return tr||ft||qe||this._handleOverridablePaintPropertyUpdate(J,pt,Ft)},C.prototype._handleSpecialPaintPropertyUpdate=function(J){},C.prototype._handleOverridablePaintPropertyUpdate=function(J,he,xe){return!1},C.prototype.isHidden=function(J){return this.minzoom&&J<this.minzoom||this.maxzoom&&J>=this.maxzoom?!0:this.visibility==="none"},C.prototype.updateTransitions=function(J){this._transitioningPaint=this._transitionablePaint.transitioned(J,this._transitioningPaint)},C.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},C.prototype.recalculate=function(J,he){J.getCrossfadeParameters&&(this._crossfadeParameters=J.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(J,void 0,he)),this.paint=this._transitioningPaint.possiblyEvaluate(J,void 0,he)},C.prototype.serialize=function(){var J={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(J.layout=J.layout||{},J.layout.visibility=this.visibility),z(J,function(he,xe){return he!==void 0&&!(xe==="layout"&&!Object.keys(he).length)&&!(xe==="paint"&&!Object.keys(he).length)})},C.prototype._validate=function(J,he,xe,Te,Fe){return Fe===void 0&&(Fe={}),Fe&&Fe.validate===!1?!1:yo(this,J.call(wo,{key:he,layerType:this.type,objectKey:xe,value:Te,styleSpec:Vt,style:{glyphs:!0,sprite:!0}}))},C.prototype.is3D=function(){return!1},C.prototype.isTileClipped=function(){return!1},C.prototype.hasOffscreenPass=function(){return!1},C.prototype.resize=function(){},C.prototype.isStateDependent=function(){for(var J in this.paint._values){var he=this.paint.get(J);if(!(!(he instanceof Wi)||!oi(he.property.specification))&&(he.value.kind==="source"||he.value.kind==="composite")&&he.value.isStateDependent)return!0}return!1},C}(Ar),Ul={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Ki=function(C,B){this._structArray=C,this._pos1=B*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},rf=128,Ml=5,Bi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};Bi.serialize=function(C,B){return C._trim(),B&&(C.isTransferred=!0,B.push(C.arrayBuffer)),{length:C.length,arrayBuffer:C.arrayBuffer}},Bi.deserialize=function(C){var B=Object.create(this.prototype);return B.arrayBuffer=C.arrayBuffer,B.length=C.length,B.capacity=C.arrayBuffer.byteLength/B.bytesPerElement,B._refreshViews(),B},Bi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Bi.prototype.clear=function(){this.length=0},Bi.prototype.resize=function(C){this.reserve(C),this.length=C},Bi.prototype.reserve=function(C){if(C>this.capacity){this.capacity=Math.max(C,Math.floor(this.capacity*Ml),rf),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var B=this.uint8;this._refreshViews(),B&&this.uint8.set(B)}},Bi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};function Io(E,C){C===void 0&&(C=1);var B=0,J=0,he=E.map(function(Te){var Fe=lh(Te.type),qe=B=Cf(B,Math.max(C,Fe)),ft=Te.components||1;return J=Math.max(J,Fe),B+=Fe*ft,{name:Te.name,type:Te.type,components:ft,offset:qe}}),xe=Cf(B,Math.max(J,C));return{members:he,size:xe,alignment:C}}function lh(E){return Ul[E].BYTES_PER_ELEMENT}function Cf(E,C){return Math.ceil(E/C)*C}var yf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he){var xe=this.length;return this.resize(xe+1),this.emplace(xe,J,he)},C.prototype.emplace=function(J,he,xe){var Te=J*2;return this.int16[Te+0]=he,this.int16[Te+1]=xe,J},C}(Bi);yf.prototype.bytesPerElement=4,Oe("StructArrayLayout2i4",yf);var Ou=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te){var Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,J,he,xe,Te)},C.prototype.emplace=function(J,he,xe,Te,Fe){var qe=J*4;return this.int16[qe+0]=he,this.int16[qe+1]=xe,this.int16[qe+2]=Te,this.int16[qe+3]=Fe,J},C}(Bi);Ou.prototype.bytesPerElement=8,Oe("StructArrayLayout4i8",Ou);var nf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,qe){var ft=this.length;return this.resize(ft+1),this.emplace(ft,J,he,xe,Te,Fe,qe)},C.prototype.emplace=function(J,he,xe,Te,Fe,qe,ft){var pt=J*6;return this.int16[pt+0]=he,this.int16[pt+1]=xe,this.int16[pt+2]=Te,this.int16[pt+3]=Fe,this.int16[pt+4]=qe,this.int16[pt+5]=ft,J},C}(Bi);nf.prototype.bytesPerElement=12,Oe("StructArrayLayout2i4i12",nf);var Lf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,qe){var ft=this.length;return this.resize(ft+1),this.emplace(ft,J,he,xe,Te,Fe,qe)},C.prototype.emplace=function(J,he,xe,Te,Fe,qe,ft){var pt=J*4,Ft=J*8;return this.int16[pt+0]=he,this.int16[pt+1]=xe,this.uint8[Ft+4]=Te,this.uint8[Ft+5]=Fe,this.uint8[Ft+6]=qe,this.uint8[Ft+7]=ft,J},C}(Bi);Lf.prototype.bytesPerElement=8,Oe("StructArrayLayout2i4ub8",Lf);var Bs=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,qe,ft,pt,Ft,tr){var Qt=this.length;return this.resize(Qt+1),this.emplace(Qt,J,he,xe,Te,Fe,qe,ft,pt,Ft,tr)},C.prototype.emplace=function(J,he,xe,Te,Fe,qe,ft,pt,Ft,tr,Qt){var dr=J*9,Fr=J*18;return this.uint16[dr+0]=he,this.uint16[dr+1]=xe,this.uint16[dr+2]=Te,this.uint16[dr+3]=Fe,this.uint16[dr+4]=qe,this.uint16[dr+5]=ft,this.uint16[dr+6]=pt,this.uint16[dr+7]=Ft,this.uint8[Fr+16]=tr,this.uint8[Fr+17]=Qt,J},C}(Bi);Bs.prototype.bytesPerElement=18,Oe("StructArrayLayout8ui2ub18",Bs);var Bu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,qe,ft,pt,Ft,tr,Qt,dr){var Fr=this.length;return this.resize(Fr+1),this.emplace(Fr,J,he,xe,Te,Fe,qe,ft,pt,Ft,tr,Qt,dr)},C.prototype.emplace=function(J,he,xe,Te,Fe,qe,ft,pt,Ft,tr,Qt,dr,Fr){var on=J*12;return this.int16[on+0]=he,this.int16[on+1]=xe,this.int16[on+2]=Te,this.int16[on+3]=Fe,this.uint16[on+4]=qe,this.uint16[on+5]=ft,this.uint16[on+6]=pt,this.uint16[on+7]=Ft,this.int16[on+8]=tr,this.int16[on+9]=Qt,this.int16[on+10]=dr,this.int16[on+11]=Fr,J},C}(Bi);Bu.prototype.bytesPerElement=24,Oe("StructArrayLayout4i4ui4i24",Bu);var ac=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe){var Te=this.length;return this.resize(Te+1),this.emplace(Te,J,he,xe)},C.prototype.emplace=function(J,he,xe,Te){var Fe=J*3;return this.float32[Fe+0]=he,this.float32[Fe+1]=xe,this.float32[Fe+2]=Te,J},C}(Bi);ac.prototype.bytesPerElement=12,Oe("StructArrayLayout3f12",ac);var ic=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J){var he=this.length;return this.resize(he+1),this.emplace(he,J)},C.prototype.emplace=function(J,he){var xe=J*1;return this.uint32[xe+0]=he,J},C}(Bi);ic.prototype.bytesPerElement=4,Oe("StructArrayLayout1ul4",ic);var mf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,qe,ft,pt,Ft){var tr=this.length;return this.resize(tr+1),this.emplace(tr,J,he,xe,Te,Fe,qe,ft,pt,Ft)},C.prototype.emplace=function(J,he,xe,Te,Fe,qe,ft,pt,Ft,tr){var Qt=J*10,dr=J*5;return this.int16[Qt+0]=he,this.int16[Qt+1]=xe,this.int16[Qt+2]=Te,this.int16[Qt+3]=Fe,this.int16[Qt+4]=qe,this.int16[Qt+5]=ft,this.uint32[dr+3]=pt,this.uint16[Qt+8]=Ft,this.uint16[Qt+9]=tr,J},C}(Bi);mf.prototype.bytesPerElement=20,Oe("StructArrayLayout6i1ul2ui20",mf);var Pf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,qe){var ft=this.length;return this.resize(ft+1),this.emplace(ft,J,he,xe,Te,Fe,qe)},C.prototype.emplace=function(J,he,xe,Te,Fe,qe,ft){var pt=J*6;return this.int16[pt+0]=he,this.int16[pt+1]=xe,this.int16[pt+2]=Te,this.int16[pt+3]=Fe,this.int16[pt+4]=qe,this.int16[pt+5]=ft,J},C}(Bi);Pf.prototype.bytesPerElement=12,Oe("StructArrayLayout2i2i2i12",Pf);var xu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe){var qe=this.length;return this.resize(qe+1),this.emplace(qe,J,he,xe,Te,Fe)},C.prototype.emplace=function(J,he,xe,Te,Fe,qe){var ft=J*4,pt=J*8;return this.float32[ft+0]=he,this.float32[ft+1]=xe,this.float32[ft+2]=Te,this.int16[pt+6]=Fe,this.int16[pt+7]=qe,J},C}(Bi);xu.prototype.bytesPerElement=16,Oe("StructArrayLayout2f1f2i16",xu);var $s=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te){var Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,J,he,xe,Te)},C.prototype.emplace=function(J,he,xe,Te,Fe){var qe=J*12,ft=J*3;return this.uint8[qe+0]=he,this.uint8[qe+1]=xe,this.float32[ft+1]=Te,this.float32[ft+2]=Fe,J},C}(Bi);$s.prototype.bytesPerElement=12,Oe("StructArrayLayout2ub2f12",$s);var bu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe){var Te=this.length;return this.resize(Te+1),this.emplace(Te,J,he,xe)},C.prototype.emplace=function(J,he,xe,Te){var Fe=J*3;return this.uint16[Fe+0]=he,this.uint16[Fe+1]=xe,this.uint16[Fe+2]=Te,J},C}(Bi);bu.prototype.bytesPerElement=6,Oe("StructArrayLayout3ui6",bu);var xf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,qe,ft,pt,Ft,tr,Qt,dr,Fr,on,$r,kn,mn){var Sn=this.length;return this.resize(Sn+1),this.emplace(Sn,J,he,xe,Te,Fe,qe,ft,pt,Ft,tr,Qt,dr,Fr,on,$r,kn,mn)},C.prototype.emplace=function(J,he,xe,Te,Fe,qe,ft,pt,Ft,tr,Qt,dr,Fr,on,$r,kn,mn,Sn){var In=J*24,Gn=J*12,oa=J*48;return this.int16[In+0]=he,this.int16[In+1]=xe,this.uint16[In+2]=Te,this.uint16[In+3]=Fe,this.uint32[Gn+2]=qe,this.uint32[Gn+3]=ft,this.uint32[Gn+4]=pt,this.uint16[In+10]=Ft,this.uint16[In+11]=tr,this.uint16[In+12]=Qt,this.float32[Gn+7]=dr,this.float32[Gn+8]=Fr,this.uint8[oa+36]=on,this.uint8[oa+37]=$r,this.uint8[oa+38]=kn,this.uint32[Gn+10]=mn,this.int16[In+22]=Sn,J},C}(Bi);xf.prototype.bytesPerElement=48,Oe("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",xf);var Df=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,qe,ft,pt,Ft,tr,Qt,dr,Fr,on,$r,kn,mn,Sn,In,Gn,oa,na,Ra,wa,Sa,ti,La,Da){var fi=this.length;return this.resize(fi+1),this.emplace(fi,J,he,xe,Te,Fe,qe,ft,pt,Ft,tr,Qt,dr,Fr,on,$r,kn,mn,Sn,In,Gn,oa,na,Ra,wa,Sa,ti,La,Da)},C.prototype.emplace=function(J,he,xe,Te,Fe,qe,ft,pt,Ft,tr,Qt,dr,Fr,on,$r,kn,mn,Sn,In,Gn,oa,na,Ra,wa,Sa,ti,La,Da,fi){var qa=J*34,ki=J*17;return this.int16[qa+0]=he,this.int16[qa+1]=xe,this.int16[qa+2]=Te,this.int16[qa+3]=Fe,this.int16[qa+4]=qe,this.int16[qa+5]=ft,this.int16[qa+6]=pt,this.int16[qa+7]=Ft,this.uint16[qa+8]=tr,this.uint16[qa+9]=Qt,this.uint16[qa+10]=dr,this.uint16[qa+11]=Fr,this.uint16[qa+12]=on,this.uint16[qa+13]=$r,this.uint16[qa+14]=kn,this.uint16[qa+15]=mn,this.uint16[qa+16]=Sn,this.uint16[qa+17]=In,this.uint16[qa+18]=Gn,this.uint16[qa+19]=oa,this.uint16[qa+20]=na,this.uint16[qa+21]=Ra,this.uint16[qa+22]=wa,this.uint32[ki+12]=Sa,this.float32[ki+13]=ti,this.float32[ki+14]=La,this.float32[ki+15]=Da,this.float32[ki+16]=fi,J},C}(Bi);Df.prototype.bytesPerElement=68,Oe("StructArrayLayout8i15ui1ul4f68",Df);var af=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J){var he=this.length;return this.resize(he+1),this.emplace(he,J)},C.prototype.emplace=function(J,he){var xe=J*1;return this.float32[xe+0]=he,J},C}(Bi);af.prototype.bytesPerElement=4,Oe("StructArrayLayout1f4",af);var oc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe){var Te=this.length;return this.resize(Te+1),this.emplace(Te,J,he,xe)},C.prototype.emplace=function(J,he,xe,Te){var Fe=J*3;return this.int16[Fe+0]=he,this.int16[Fe+1]=xe,this.int16[Fe+2]=Te,J},C}(Bi);oc.prototype.bytesPerElement=6,Oe("StructArrayLayout3i6",oc);var Nu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe){var Te=this.length;return this.resize(Te+1),this.emplace(Te,J,he,xe)},C.prototype.emplace=function(J,he,xe,Te){var Fe=J*2,qe=J*4;return this.uint32[Fe+0]=he,this.uint16[qe+2]=xe,this.uint16[qe+3]=Te,J},C}(Bi);Nu.prototype.bytesPerElement=8,Oe("StructArrayLayout1ul2ui8",Nu);var bf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he){var xe=this.length;return this.resize(xe+1),this.emplace(xe,J,he)},C.prototype.emplace=function(J,he,xe){var Te=J*2;return this.uint16[Te+0]=he,this.uint16[Te+1]=xe,J},C}(Bi);bf.prototype.bytesPerElement=4,Oe("StructArrayLayout2ui4",bf);var of=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J){var he=this.length;return this.resize(he+1),this.emplace(he,J)},C.prototype.emplace=function(J,he){var xe=J*1;return this.uint16[xe+0]=he,J},C}(Bi);of.prototype.bytesPerElement=2,Oe("StructArrayLayout1ui2",of);var Uu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he){var xe=this.length;return this.resize(xe+1),this.emplace(xe,J,he)},C.prototype.emplace=function(J,he,xe){var Te=J*2;return this.float32[Te+0]=he,this.float32[Te+1]=xe,J},C}(Bi);Uu.prototype.bytesPerElement=8,Oe("StructArrayLayout2f8",Uu);var sc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te){var Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,J,he,xe,Te)},C.prototype.emplace=function(J,he,xe,Te,Fe){var qe=J*4;return this.float32[qe+0]=he,this.float32[qe+1]=xe,this.float32[qe+2]=Te,this.float32[qe+3]=Fe,J},C}(Bi);sc.prototype.bytesPerElement=16,Oe("StructArrayLayout4f16",sc);var kc=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var B={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return B.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},B.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},B.x1.get=function(){return this._structArray.int16[this._pos2+2]},B.y1.get=function(){return this._structArray.int16[this._pos2+3]},B.x2.get=function(){return this._structArray.int16[this._pos2+4]},B.y2.get=function(){return this._structArray.int16[this._pos2+5]},B.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},B.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},B.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},B.anchorPoint.get=function(){return new c(this.anchorPointX,this.anchorPointY)},Object.defineProperties(C.prototype,B),C}(Ki);kc.prototype.size=20;var Vu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function(J){return new kc(this,J)},C}(mf);Oe("CollisionBoxArray",Vu);var lc=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var B={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return B.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},B.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},B.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},B.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},B.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},B.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},B.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},B.segment.get=function(){return this._structArray.uint16[this._pos2+10]},B.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},B.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},B.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},B.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},B.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},B.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},B.placedOrientation.set=function(J){this._structArray.uint8[this._pos1+37]=J},B.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},B.hidden.set=function(J){this._structArray.uint8[this._pos1+38]=J},B.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},B.crossTileID.set=function(J){this._structArray.uint32[this._pos4+10]=J},B.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(C.prototype,B),C}(Ki);lc.prototype.size=48;var sf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function(J){return new lc(this,J)},C}(xf);Oe("PlacedSymbolArray",sf);var Ec=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var B={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return B.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},B.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},B.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},B.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},B.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},B.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},B.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},B.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},B.key.get=function(){return this._structArray.uint16[this._pos2+8]},B.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},B.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},B.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},B.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},B.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},B.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},B.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},B.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},B.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},B.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},B.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},B.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},B.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},B.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},B.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},B.crossTileID.set=function(J){this._structArray.uint32[this._pos4+12]=J},B.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},B.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},B.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},B.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(C.prototype,B),C}(Ki);Ec.prototype.size=68;var Cc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function(J){return new Ec(this,J)},C}(Df);Oe("SymbolInstanceArray",Cc);var Vl=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.getoffsetX=function(J){return this.float32[J*1+0]},C}(af);Oe("GlyphOffsetArray",Vl);var Lc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.getx=function(J){return this.int16[J*3+0]},C.prototype.gety=function(J){return this.int16[J*3+1]},C.prototype.gettileUnitDistanceFromAnchor=function(J){return this.int16[J*3+2]},C}(oc);Oe("SymbolLineVertexArray",Lc);var Pc=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var B={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return B.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},B.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},B.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(C.prototype,B),C}(Ki);Pc.prototype.size=8;var uc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function(J){return new Pc(this,J)},C}(Nu);Oe("FeatureIndexArray",uc);var Dc=Io([{name:"a_pos",components:2,type:"Int16"}],4),fe=Dc.members,H=function(C){C===void 0&&(C=[]),this.segments=C};H.prototype.prepareSegment=function(C,B,J,he){var xe=this.segments[this.segments.length-1];return C>H.MAX_VERTEX_ARRAY_LENGTH&&O("Max vertices per segment is "+H.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+C),(!xe||xe.vertexLength+C>H.MAX_VERTEX_ARRAY_LENGTH||xe.sortKey!==he)&&(xe={vertexOffset:B.length,primitiveOffset:J.length,vertexLength:0,primitiveLength:0},he!==void 0&&(xe.sortKey=he),this.segments.push(xe)),xe},H.prototype.get=function(){return this.segments},H.prototype.destroy=function(){for(var C=0,B=this.segments;C<B.length;C+=1){var J=B[C];for(var he in J.vaos)J.vaos[he].destroy()}},H.simpleSegment=function(C,B,J,he){return new H([{vertexOffset:C,primitiveOffset:B,vertexLength:J,primitiveLength:he,vaos:{},sortKey:0}])},H.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Oe("SegmentVector",H);function ve(E,C){return E=f(Math.floor(E),0,255),C=f(Math.floor(C),0,255),256*E+C}var Z=Io([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),pe=a(function(E){function C(B,J){var he,xe,Te,Fe,qe,ft,pt,Ft;for(he=B.length&3,xe=B.length-he,Te=J,qe=3432918353,ft=461845907,Ft=0;Ft<xe;)pt=B.charCodeAt(Ft)&255|(B.charCodeAt(++Ft)&255)<<8|(B.charCodeAt(++Ft)&255)<<16|(B.charCodeAt(++Ft)&255)<<24,++Ft,pt=(pt&65535)*qe+(((pt>>>16)*qe&65535)<<16)&4294967295,pt=pt<<15|pt>>>17,pt=(pt&65535)*ft+(((pt>>>16)*ft&65535)<<16)&4294967295,Te^=pt,Te=Te<<13|Te>>>19,Fe=(Te&65535)*5+(((Te>>>16)*5&65535)<<16)&4294967295,Te=(Fe&65535)+27492+(((Fe>>>16)+58964&65535)<<16);switch(pt=0,he){case 3:pt^=(B.charCodeAt(Ft+2)&255)<<16;case 2:pt^=(B.charCodeAt(Ft+1)&255)<<8;case 1:pt^=B.charCodeAt(Ft)&255,pt=(pt&65535)*qe+(((pt>>>16)*qe&65535)<<16)&4294967295,pt=pt<<15|pt>>>17,pt=(pt&65535)*ft+(((pt>>>16)*ft&65535)<<16)&4294967295,Te^=pt}return Te^=B.length,Te^=Te>>>16,Te=(Te&65535)*2246822507+(((Te>>>16)*2246822507&65535)<<16)&4294967295,Te^=Te>>>13,Te=(Te&65535)*3266489909+(((Te>>>16)*3266489909&65535)<<16)&4294967295,Te^=Te>>>16,Te>>>0}E.exports=C}),Se=a(function(E){function C(B,J){for(var he=B.length,xe=J^he,Te=0,Fe;he>=4;)Fe=B.charCodeAt(Te)&255|(B.charCodeAt(++Te)&255)<<8|(B.charCodeAt(++Te)&255)<<16|(B.charCodeAt(++Te)&255)<<24,Fe=(Fe&65535)*1540483477+(((Fe>>>16)*1540483477&65535)<<16),Fe^=Fe>>>24,Fe=(Fe&65535)*1540483477+(((Fe>>>16)*1540483477&65535)<<16),xe=(xe&65535)*1540483477+(((xe>>>16)*1540483477&65535)<<16)^Fe,he-=4,++Te;switch(he){case 3:xe^=(B.charCodeAt(Te+2)&255)<<16;case 2:xe^=(B.charCodeAt(Te+1)&255)<<8;case 1:xe^=B.charCodeAt(Te)&255,xe=(xe&65535)*1540483477+(((xe>>>16)*1540483477&65535)<<16)}return xe^=xe>>>13,xe=(xe&65535)*1540483477+(((xe>>>16)*1540483477&65535)<<16),xe^=xe>>>15,xe>>>0}E.exports=C}),Re=pe,je=pe,ut=Se;Re.murmur3=je,Re.murmur2=ut;var Et=function(){this.ids=[],this.positions=[],this.indexed=!1};Et.prototype.add=function(C,B,J,he){this.ids.push(lr(C)),this.positions.push(B,J,he)},Et.prototype.getPositions=function(C){for(var B=lr(C),J=0,he=this.ids.length-1;J<he;){var xe=J+he>>1;this.ids[xe]>=B?he=xe:J=xe+1}for(var Te=[];this.ids[J]===B;){var Fe=this.positions[3*J],qe=this.positions[3*J+1],ft=this.positions[3*J+2];Te.push({index:Fe,start:qe,end:ft}),J++}return Te},Et.serialize=function(C,B){var J=new Float64Array(C.ids),he=new Uint32Array(C.positions);return vr(J,he,0,J.length-1),B&&B.push(J.buffer,he.buffer),{ids:J,positions:he}},Et.deserialize=function(C){var B=new Et;return B.ids=C.ids,B.positions=C.positions,B.indexed=!0,B};var Jt=Math.pow(2,53)-1;function lr(E){var C=+E;return!isNaN(C)&&C<=Jt?C:Re(String(E))}function vr(E,C,B,J){for(;B<J;){for(var he=E[B+J>>1],xe=B-1,Te=J+1;;){do xe++;while(E[xe]<he);do Te--;while(E[Te]>he);if(xe>=Te)break;Cr(E,xe,Te),Cr(C,3*xe,3*Te),Cr(C,3*xe+1,3*Te+1),Cr(C,3*xe+2,3*Te+2)}Te-B<J-Te?(vr(E,C,B,Te),B=Te+1):(vr(E,C,Te+1,J),J=Te)}}function Cr(E,C,B){var J=E[C];E[C]=E[B],E[B]=J}Oe("FeaturePositionMap",Et);var Hr=function(C,B){this.gl=C.gl,this.location=B},Yr=function(E){function C(B,J){E.call(this,B,J),this.current=0}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){this.current!==J&&(this.current=J,this.gl.uniform1i(this.location,J))},C}(Hr),Ur=function(E){function C(B,J){E.call(this,B,J),this.current=0}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){this.current!==J&&(this.current=J,this.gl.uniform1f(this.location,J))},C}(Hr),Jr=function(E){function C(B,J){E.call(this,B,J),this.current=[0,0]}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){(J[0]!==this.current[0]||J[1]!==this.current[1])&&(this.current=J,this.gl.uniform2f(this.location,J[0],J[1]))},C}(Hr),hn=function(E){function C(B,J){E.call(this,B,J),this.current=[0,0,0]}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){(J[0]!==this.current[0]||J[1]!==this.current[1]||J[2]!==this.current[2])&&(this.current=J,this.gl.uniform3f(this.location,J[0],J[1],J[2]))},C}(Hr),Cn=function(E){function C(B,J){E.call(this,B,J),this.current=[0,0,0,0]}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){(J[0]!==this.current[0]||J[1]!==this.current[1]||J[2]!==this.current[2]||J[3]!==this.current[3])&&(this.current=J,this.gl.uniform4f(this.location,J[0],J[1],J[2],J[3]))},C}(Hr),Fn=function(E){function C(B,J){E.call(this,B,J),this.current=vi.transparent}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){(J.r!==this.current.r||J.g!==this.current.g||J.b!==this.current.b||J.a!==this.current.a)&&(this.current=J,this.gl.uniform4f(this.location,J.r,J.g,J.b,J.a))},C}(Hr),Kn=new Float32Array(16),qn=function(E){function C(B,J){E.call(this,B,J),this.current=Kn}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){if(J[12]!==this.current[12]||J[0]!==this.current[0]){this.current=J,this.gl.uniformMatrix4fv(this.location,!1,J);return}for(var he=1;he<16;he++)if(J[he]!==this.current[he]){this.current=J,this.gl.uniformMatrix4fv(this.location,!1,J);break}},C}(Hr);function Qn(E){return[ve(255*E.r,255*E.g),ve(255*E.b,255*E.a)]}var ca=function(C,B,J){this.value=C,this.uniformNames=B.map(function(he){return"u_"+he}),this.type=J};ca.prototype.setUniform=function(C,B,J){C.set(J.constantOr(this.value))},ca.prototype.getBinding=function(C,B,J){return this.type==="color"?new Fn(C,B):new Ur(C,B)};var ba=function(C,B){this.uniformNames=B.map(function(J){return"u_"+J}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ba.prototype.setConstantPatternPositions=function(C,B){this.pixelRatioFrom=B.pixelRatio,this.pixelRatioTo=C.pixelRatio,this.patternFrom=B.tlbr,this.patternTo=C.tlbr},ba.prototype.setUniform=function(C,B,J,he){var xe=he==="u_pattern_to"?this.patternTo:he==="u_pattern_from"?this.patternFrom:he==="u_pixel_ratio_to"?this.pixelRatioTo:he==="u_pixel_ratio_from"?this.pixelRatioFrom:null;xe&&C.set(xe)},ba.prototype.getBinding=function(C,B,J){return J.substr(0,9)==="u_pattern"?new Cn(C,B):new Ur(C,B)};var ya=function(C,B,J,he){this.expression=C,this.type=J,this.maxValue=0,this.paintVertexAttributes=B.map(function(xe){return{name:"a_"+xe,type:"Float32",components:J==="color"?2:1,offset:0}}),this.paintVertexArray=new he};ya.prototype.populatePaintArray=function(C,B,J,he,xe){var Te=this.paintVertexArray.length,Fe=this.expression.evaluate(new si(0),B,{},he,[],xe);this.paintVertexArray.resize(C),this._setPaintValue(Te,C,Fe)},ya.prototype.updatePaintArray=function(C,B,J,he){var xe=this.expression.evaluate({zoom:0},J,he);this._setPaintValue(C,B,xe)},ya.prototype._setPaintValue=function(C,B,J){if(this.type==="color")for(var he=Qn(J),xe=C;xe<B;xe++)this.paintVertexArray.emplace(xe,he[0],he[1]);else{for(var Te=C;Te<B;Te++)this.paintVertexArray.emplace(Te,J);this.maxValue=Math.max(this.maxValue,Math.abs(J))}},ya.prototype.upload=function(C){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=C.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ya.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ta=function(C,B,J,he,xe,Te){this.expression=C,this.uniformNames=B.map(function(Fe){return"u_"+Fe+"_t"}),this.type=J,this.useIntegerZoom=he,this.zoom=xe,this.maxValue=0,this.paintVertexAttributes=B.map(function(Fe){return{name:"a_"+Fe,type:"Float32",components:J==="color"?4:2,offset:0}}),this.paintVertexArray=new Te};Ta.prototype.populatePaintArray=function(C,B,J,he,xe){var Te=this.expression.evaluate(new si(this.zoom),B,{},he,[],xe),Fe=this.expression.evaluate(new si(this.zoom+1),B,{},he,[],xe),qe=this.paintVertexArray.length;this.paintVertexArray.resize(C),this._setPaintValue(qe,C,Te,Fe)},Ta.prototype.updatePaintArray=function(C,B,J,he){var xe=this.expression.evaluate({zoom:this.zoom},J,he),Te=this.expression.evaluate({zoom:this.zoom+1},J,he);this._setPaintValue(C,B,xe,Te)},Ta.prototype._setPaintValue=function(C,B,J,he){if(this.type==="color")for(var xe=Qn(J),Te=Qn(he),Fe=C;Fe<B;Fe++)this.paintVertexArray.emplace(Fe,xe[0],xe[1],Te[0],Te[1]);else{for(var qe=C;qe<B;qe++)this.paintVertexArray.emplace(qe,J,he);this.maxValue=Math.max(this.maxValue,Math.abs(J),Math.abs(he))}},Ta.prototype.upload=function(C){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=C.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ta.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ta.prototype.setUniform=function(C,B){var J=this.useIntegerZoom?Math.floor(B.zoom):B.zoom,he=f(this.expression.interpolationFactor(J,this.zoom,this.zoom+1),0,1);C.set(he)},Ta.prototype.getBinding=function(C,B,J){return new Ur(C,B)};var Ca=function(C,B,J,he,xe,Te){this.expression=C,this.type=B,this.useIntegerZoom=J,this.zoom=he,this.layerId=Te,this.zoomInPaintVertexArray=new xe,this.zoomOutPaintVertexArray=new xe};Ca.prototype.populatePaintArray=function(C,B,J){var he=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(C),this.zoomOutPaintVertexArray.resize(C),this._setPaintValues(he,C,B.patterns&&B.patterns[this.layerId],J)},Ca.prototype.updatePaintArray=function(C,B,J,he,xe){this._setPaintValues(C,B,J.patterns&&J.patterns[this.layerId],xe)},Ca.prototype._setPaintValues=function(C,B,J,he){if(!(!he||!J)){var xe=J.min,Te=J.mid,Fe=J.max,qe=he[xe],ft=he[Te],pt=he[Fe];if(!(!qe||!ft||!pt))for(var Ft=C;Ft<B;Ft++)this.zoomInPaintVertexArray.emplace(Ft,ft.tl[0],ft.tl[1],ft.br[0],ft.br[1],qe.tl[0],qe.tl[1],qe.br[0],qe.br[1],ft.pixelRatio,qe.pixelRatio),this.zoomOutPaintVertexArray.emplace(Ft,ft.tl[0],ft.tl[1],ft.br[0],ft.br[1],pt.tl[0],pt.tl[1],pt.br[0],pt.br[1],ft.pixelRatio,pt.pixelRatio)}},Ca.prototype.upload=function(C){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=C.createVertexBuffer(this.zoomInPaintVertexArray,Z.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=C.createVertexBuffer(this.zoomOutPaintVertexArray,Z.members,this.expression.isStateDependent))},Ca.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Va=function(C,B,J,he){this.binders={},this.layoutAttributes=he,this._buffers=[];var xe=[];for(var Te in C.paint._values)if(!!J(Te)){var Fe=C.paint.get(Te);if(!(!(Fe instanceof Wi)||!oi(Fe.property.specification))){var qe=Li(Te,C.type),ft=Fe.value,pt=Fe.property.specification.type,Ft=Fe.property.useIntegerZoom,tr=Fe.property.specification["property-type"],Qt=tr==="cross-faded"||tr==="cross-faded-data-driven";if(ft.kind==="constant")this.binders[Te]=Qt?new ba(ft.value,qe):new ca(ft.value,qe,pt),xe.push("/u_"+Te);else if(ft.kind==="source"||Qt){var dr=pi(Te,pt,"source");this.binders[Te]=Qt?new Ca(ft,pt,Ft,B,dr,C.id):new ya(ft,qe,pt,dr),xe.push("/a_"+Te)}else{var Fr=pi(Te,pt,"composite");this.binders[Te]=new Ta(ft,qe,pt,Ft,B,Fr),xe.push("/z_"+Te)}}}this.cacheKey=xe.sort().join("")};Va.prototype.getMaxValue=function(C){var B=this.binders[C];return B instanceof ya||B instanceof Ta?B.maxValue:0},Va.prototype.populatePaintArrays=function(C,B,J,he,xe){for(var Te in this.binders){var Fe=this.binders[Te];(Fe instanceof ya||Fe instanceof Ta||Fe instanceof Ca)&&Fe.populatePaintArray(C,B,J,he,xe)}},Va.prototype.setConstantPatternPositions=function(C,B){for(var J in this.binders){var he=this.binders[J];he instanceof ba&&he.setConstantPatternPositions(C,B)}},Va.prototype.updatePaintArrays=function(C,B,J,he,xe){var Te=!1;for(var Fe in C)for(var qe=B.getPositions(Fe),ft=0,pt=qe;ft<pt.length;ft+=1){var Ft=pt[ft],tr=J.feature(Ft.index);for(var Qt in this.binders){var dr=this.binders[Qt];if((dr instanceof ya||dr instanceof Ta||dr instanceof Ca)&&dr.expression.isStateDependent===!0){var Fr=he.paint.get(Qt);dr.expression=Fr.value,dr.updatePaintArray(Ft.start,Ft.end,tr,C[Fe],xe),Te=!0}}}return Te},Va.prototype.defines=function(){var C=[];for(var B in this.binders){var J=this.binders[B];(J instanceof ca||J instanceof ba)&&C.push.apply(C,J.uniformNames.map(function(he){return"#define HAS_UNIFORM_"+he}))}return C},Va.prototype.getPaintVertexBuffers=function(){return this._buffers},Va.prototype.getUniforms=function(C,B){var J=[];for(var he in this.binders){var xe=this.binders[he];if(xe instanceof ca||xe instanceof ba||xe instanceof Ta)for(var Te=0,Fe=xe.uniformNames;Te<Fe.length;Te+=1){var qe=Fe[Te];if(B[qe]){var ft=xe.getBinding(C,B[qe],qe);J.push({name:qe,property:he,binding:ft})}}}return J},Va.prototype.setUniforms=function(C,B,J,he){for(var xe=0,Te=B;xe<Te.length;xe+=1){var Fe=Te[xe],qe=Fe.name,ft=Fe.property,pt=Fe.binding;this.binders[ft].setUniform(pt,he,J.get(ft),qe)}},Va.prototype.updatePaintBuffers=function(C){this._buffers=[];for(var B in this.binders){var J=this.binders[B];if(C&&J instanceof Ca){var he=C.fromScale===2?J.zoomInPaintVertexBuffer:J.zoomOutPaintVertexBuffer;he&&this._buffers.push(he)}else(J instanceof ya||J instanceof Ta)&&J.paintVertexBuffer&&this._buffers.push(J.paintVertexBuffer)}},Va.prototype.upload=function(C){for(var B in this.binders){var J=this.binders[B];(J instanceof ya||J instanceof Ta||J instanceof Ca)&&J.upload(C)}this.updatePaintBuffers()},Va.prototype.destroy=function(){for(var C in this.binders){var B=this.binders[C];(B instanceof ya||B instanceof Ta||B instanceof Ca)&&B.destroy()}};var ni=function(C,B,J,he){he===void 0&&(he=function(){return!0}),this.programConfigurations={};for(var xe=0,Te=B;xe<Te.length;xe+=1){var Fe=Te[xe];this.programConfigurations[Fe.id]=new Va(Fe,J,he,C)}this.needsUpload=!1,this._featureMap=new Et,this._bufferOffset=0};ni.prototype.populatePaintArrays=function(C,B,J,he,xe,Te){for(var Fe in this.programConfigurations)this.programConfigurations[Fe].populatePaintArrays(C,B,he,xe,Te);B.id!==void 0&&this._featureMap.add(B.id,J,this._bufferOffset,C),this._bufferOffset=C,this.needsUpload=!0},ni.prototype.updatePaintArrays=function(C,B,J,he){for(var xe=0,Te=J;xe<Te.length;xe+=1){var Fe=Te[xe];this.needsUpload=this.programConfigurations[Fe.id].updatePaintArrays(C,this._featureMap,B,Fe,he)||this.needsUpload}},ni.prototype.get=function(C){return this.programConfigurations[C]},ni.prototype.upload=function(C){if(!!this.needsUpload){for(var B in this.programConfigurations)this.programConfigurations[B].upload(C);this.needsUpload=!1}},ni.prototype.destroy=function(){for(var C in this.programConfigurations)this.programConfigurations[C].destroy()};function Li(E,C){var B={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]};return B[E]||[E.replace(C+"-","").replace(/-/g,"_")]}function ui(E){var C={"line-pattern":{source:Bs,composite:Bs},"fill-pattern":{source:Bs,composite:Bs},"fill-extrusion-pattern":{source:Bs,composite:Bs}};return C[E]}function pi(E,C,B){var J={color:{source:Uu,composite:sc},number:{source:af,composite:Uu}},he=ui(E);return he&&he[B]||J[C][B]}Oe("ConstantBinder",ca),Oe("CrossFadedConstantBinder",ba),Oe("SourceExpressionBinder",ya),Oe("CrossFadedCompositeBinder",Ca),Oe("CompositeExpressionBinder",Ta),Oe("ProgramConfiguration",Va,{omit:["_buffers"]}),Oe("ProgramConfigurationSet",ni);var Ba=8192;function Pi(E){return{min:-1*Math.pow(2,E-1),max:Math.pow(2,E-1)-1}}var Fi=Pi(15);function Ui(E){for(var C=Ba/E.extent,B=E.loadGeometry(),J=0;J<B.length;J++)for(var he=B[J],xe=0;xe<he.length;xe++){var Te=he[xe];Te.x=Math.round(Te.x*C),Te.y=Math.round(Te.y*C),(Te.x<Fi.min||Te.x>Fi.max||Te.y<Fi.min||Te.y>Fi.max)&&(O("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Te.x=f(Te.x,Fi.min,Fi.max),Te.y=f(Te.y,Fi.min,Fi.max))}return B}function _i(E,C,B,J,he){E.emplaceBack(C*2+(J+1)/2,B*2+(he+1)/2)}var Ji=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(B){return B.id}),this.index=C.index,this.hasPattern=!1,this.layoutVertexArray=new yf,this.indexArray=new bu,this.segments=new H,this.programConfigurations=new ni(fe,C.layers,C.zoom),this.stateDependentLayerIds=this.layers.filter(function(B){return B.isStateDependent()}).map(function(B){return B.id})};Ji.prototype.populate=function(C,B,J){var he=this.layers[0],xe=[],Te=null;he.type==="circle"&&(Te=he.layout.get("circle-sort-key"));for(var Fe=0,qe=C;Fe<qe.length;Fe+=1){var ft=qe[Fe],pt=ft.feature,Ft=ft.id,tr=ft.index,Qt=ft.sourceLayerIndex,dr=this.layers[0]._featureFilter.needGeometry,Fr={type:pt.type,id:Ft,properties:pt.properties,geometry:dr?Ui(pt):[]};if(!!this.layers[0]._featureFilter.filter(new si(this.zoom),Fr,J)){dr||(Fr.geometry=Ui(pt));var on=Te?Te.evaluate(Fr,{},J):void 0,$r={id:Ft,properties:pt.properties,type:pt.type,sourceLayerIndex:Qt,index:tr,geometry:Fr.geometry,patterns:{},sortKey:on};xe.push($r)}}Te&&xe.sort(function(wa,Sa){return wa.sortKey-Sa.sortKey});for(var kn=0,mn=xe;kn<mn.length;kn+=1){var Sn=mn[kn],In=Sn,Gn=In.geometry,oa=In.index,na=In.sourceLayerIndex,Ra=C[oa].feature;this.addFeature(Sn,Gn,oa,J),B.featureIndex.insert(Ra,Gn,oa,na,this.index)}},Ji.prototype.update=function(C,B,J){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(C,B,this.stateDependentLayers,J)},Ji.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ji.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ji.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,fe),this.indexBuffer=C.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(C),this.uploaded=!0},Ji.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ji.prototype.addFeature=function(C,B,J,he){for(var xe=0,Te=B;xe<Te.length;xe+=1)for(var Fe=Te[xe],qe=0,ft=Fe;qe<ft.length;qe+=1){var pt=ft[qe],Ft=pt.x,tr=pt.y;if(!(Ft<0||Ft>=Ba||tr<0||tr>=Ba)){var Qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,C.sortKey),dr=Qt.vertexLength;_i(this.layoutVertexArray,Ft,tr,-1,-1),_i(this.layoutVertexArray,Ft,tr,1,-1),_i(this.layoutVertexArray,Ft,tr,1,1),_i(this.layoutVertexArray,Ft,tr,-1,1),this.indexArray.emplaceBack(dr,dr+1,dr+2),this.indexArray.emplaceBack(dr,dr+3,dr+2),Qt.vertexLength+=4,Qt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,J,{},he)},Oe("CircleBucket",Ji,{omit:["layers"]});function ii(E,C){for(var B=0;B<E.length;B++)if(Ns(C,E[B]))return!0;for(var J=0;J<C.length;J++)if(Ns(E,C[J]))return!0;return!!kl(E,C)}function wi(E,C,B){return!!(Ns(E,C)||ql(C,E,B))}function To(E,C){if(E.length===1)return eu(C,E[0]);for(var B=0;B<C.length;B++)for(var J=C[B],he=0;he<J.length;he++)if(Ns(E,J[he]))return!0;for(var xe=0;xe<E.length;xe++)if(eu(C,E[xe]))return!0;for(var Te=0;Te<C.length;Te++)if(kl(E,C[Te]))return!0;return!1}function No(E,C,B){for(var J=0;J<C.length;J++){var he=C[J];if(E.length>=3){for(var xe=0;xe<he.length;xe++)if(Ns(E,he[xe]))return!0}if(Sl(E,he,B))return!0}return!1}function Sl(E,C,B){if(E.length>1){if(kl(E,C))return!0;for(var J=0;J<C.length;J++)if(ql(C[J],E,B))return!0}for(var he=0;he<E.length;he++)if(ql(E[he],C,B))return!0;return!1}function kl(E,C){if(E.length===0||C.length===0)return!1;for(var B=0;B<E.length-1;B++)for(var J=E[B],he=E[B+1],xe=0;xe<C.length-1;xe++){var Te=C[xe],Fe=C[xe+1];if($l(J,he,Te,Fe))return!0}return!1}function $l(E,C,B,J){return F(E,B,J)!==F(C,B,J)&&F(E,C,B)!==F(E,C,J)}function ql(E,C,B){var J=B*B;if(C.length===1)return E.distSqr(C[0])<J;for(var he=1;he<C.length;he++){var xe=C[he-1],Te=C[he];if(_u(E,xe,Te)<J)return!0}return!1}function _u(E,C,B){var J=C.distSqr(B);if(J===0)return E.distSqr(C);var he=((E.x-C.x)*(B.x-C.x)+(E.y-C.y)*(B.y-C.y))/J;return he<0?E.distSqr(C):he>1?E.distSqr(B):E.distSqr(B.sub(C)._mult(he)._add(C))}function eu(E,C){for(var B=!1,J,he,xe,Te=0;Te<E.length;Te++){J=E[Te];for(var Fe=0,qe=J.length-1;Fe<J.length;qe=Fe++)he=J[Fe],xe=J[qe],he.y>C.y!=xe.y>C.y&&C.x<(xe.x-he.x)*(C.y-he.y)/(xe.y-he.y)+he.x&&(B=!B)}return B}function Ns(E,C){for(var B=!1,J=0,he=E.length-1;J<E.length;he=J++){var xe=E[J],Te=E[he];xe.y>C.y!=Te.y>C.y&&C.x<(Te.x-xe.x)*(C.y-xe.y)/(Te.y-xe.y)+xe.x&&(B=!B)}return B}function Hu(E,C,B,J,he){for(var xe=0,Te=E;xe<Te.length;xe+=1){var Fe=Te[xe];if(C<=Fe.x&&B<=Fe.y&&J>=Fe.x&&he>=Fe.y)return!0}var qe=[new c(C,B),new c(C,he),new c(J,he),new c(J,B)];if(E.length>2)for(var ft=0,pt=qe;ft<pt.length;ft+=1){var Ft=pt[ft];if(Ns(E,Ft))return!0}for(var tr=0;tr<E.length-1;tr++){var Qt=E[tr],dr=E[tr+1];if(_s(Qt,dr,qe))return!0}return!1}function _s(E,C,B){var J=B[0],he=B[2];if(E.x<J.x&&C.x<J.x||E.x>he.x&&C.x>he.x||E.y<J.y&&C.y<J.y||E.y>he.y&&C.y>he.y)return!1;var xe=F(E,C,B[0]);return xe!==F(E,C,B[1])||xe!==F(E,C,B[2])||xe!==F(E,C,B[3])}function cl(E,C,B){var J=C.paint.get(E).value;return J.kind==="constant"?J.value:B.programConfigurations.get(C.id).getMaxValue(E)}function tu(E){return Math.sqrt(E[0]*E[0]+E[1]*E[1])}function Hl(E,C,B,J,he){if(!C[0]&&!C[1])return E;var xe=c.convert(C)._mult(he);B==="viewport"&&xe._rotate(-J);for(var Te=[],Fe=0;Fe<E.length;Fe++){var qe=E[Fe];Te.push(qe.sub(xe))}return Te}var ru=new ji({"circle-sort-key":new Za(Vt.layout_circle["circle-sort-key"])}),Rf=new ji({"circle-radius":new Za(Vt.paint_circle["circle-radius"]),"circle-color":new Za(Vt.paint_circle["circle-color"]),"circle-blur":new Za(Vt.paint_circle["circle-blur"]),"circle-opacity":new Za(Vt.paint_circle["circle-opacity"]),"circle-translate":new Ia(Vt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ia(Vt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ia(Vt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ia(Vt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Za(Vt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Za(Vt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Za(Vt.paint_circle["circle-stroke-opacity"])}),Zu={paint:Rf,layout:ru},hs=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var E=arguments,C=0,B=arguments.length;B--;)C+=E[B]*E[B];return Math.sqrt(C)});function _f(){var E=new hs(4);return hs!=Float32Array&&(E[1]=0,E[2]=0),E[0]=1,E[3]=1,E}function Cs(E,C,B){var J=C[0],he=C[1],xe=C[2],Te=C[3],Fe=Math.sin(B),qe=Math.cos(B);return E[0]=J*qe+xe*Fe,E[1]=he*qe+Te*Fe,E[2]=J*-Fe+xe*qe,E[3]=he*-Fe+Te*qe,E}function wf(){var E=new hs(9);return hs!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[5]=0,E[6]=0,E[7]=0),E[0]=1,E[4]=1,E[8]=1,E}function If(E,C){var B=Math.sin(C),J=Math.cos(C);return E[0]=J,E[1]=B,E[2]=0,E[3]=-B,E[4]=J,E[5]=0,E[6]=0,E[7]=0,E[8]=1,E}function zf(){var E=new hs(16);return hs!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=0,E[12]=0,E[13]=0,E[14]=0),E[0]=1,E[5]=1,E[10]=1,E[15]=1,E}function Rc(E){var C=new hs(16);return C[0]=E[0],C[1]=E[1],C[2]=E[2],C[3]=E[3],C[4]=E[4],C[5]=E[5],C[6]=E[6],C[7]=E[7],C[8]=E[8],C[9]=E[9],C[10]=E[10],C[11]=E[11],C[12]=E[12],C[13]=E[13],C[14]=E[14],C[15]=E[15],C}function Ff(E){return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E}function lf(E,C){var B=C[0],J=C[1],he=C[2],xe=C[3],Te=C[4],Fe=C[5],qe=C[6],ft=C[7],pt=C[8],Ft=C[9],tr=C[10],Qt=C[11],dr=C[12],Fr=C[13],on=C[14],$r=C[15],kn=B*Fe-J*Te,mn=B*qe-he*Te,Sn=B*ft-xe*Te,In=J*qe-he*Fe,Gn=J*ft-xe*Fe,oa=he*ft-xe*qe,na=pt*Fr-Ft*dr,Ra=pt*on-tr*dr,wa=pt*$r-Qt*dr,Sa=Ft*on-tr*Fr,ti=Ft*$r-Qt*Fr,La=tr*$r-Qt*on,Da=kn*La-mn*ti+Sn*Sa+In*wa-Gn*Ra+oa*na;return Da?(Da=1/Da,E[0]=(Fe*La-qe*ti+ft*Sa)*Da,E[1]=(he*ti-J*La-xe*Sa)*Da,E[2]=(Fr*oa-on*Gn+$r*In)*Da,E[3]=(tr*Gn-Ft*oa-Qt*In)*Da,E[4]=(qe*wa-Te*La-ft*Ra)*Da,E[5]=(B*La-he*wa+xe*Ra)*Da,E[6]=(on*Sn-dr*oa-$r*mn)*Da,E[7]=(pt*oa-tr*Sn+Qt*mn)*Da,E[8]=(Te*ti-Fe*wa+ft*na)*Da,E[9]=(J*wa-B*ti-xe*na)*Da,E[10]=(dr*Gn-Fr*Sn+$r*kn)*Da,E[11]=(Ft*Sn-pt*Gn-Qt*kn)*Da,E[12]=(Fe*Ra-Te*Sa-qe*na)*Da,E[13]=(B*Sa-J*Ra+he*na)*Da,E[14]=(Fr*mn-dr*In-on*kn)*Da,E[15]=(pt*In-Ft*mn+tr*kn)*Da,E):null}function uf(E,C,B){var J=C[0],he=C[1],xe=C[2],Te=C[3],Fe=C[4],qe=C[5],ft=C[6],pt=C[7],Ft=C[8],tr=C[9],Qt=C[10],dr=C[11],Fr=C[12],on=C[13],$r=C[14],kn=C[15],mn=B[0],Sn=B[1],In=B[2],Gn=B[3];return E[0]=mn*J+Sn*Fe+In*Ft+Gn*Fr,E[1]=mn*he+Sn*qe+In*tr+Gn*on,E[2]=mn*xe+Sn*ft+In*Qt+Gn*$r,E[3]=mn*Te+Sn*pt+In*dr+Gn*kn,mn=B[4],Sn=B[5],In=B[6],Gn=B[7],E[4]=mn*J+Sn*Fe+In*Ft+Gn*Fr,E[5]=mn*he+Sn*qe+In*tr+Gn*on,E[6]=mn*xe+Sn*ft+In*Qt+Gn*$r,E[7]=mn*Te+Sn*pt+In*dr+Gn*kn,mn=B[8],Sn=B[9],In=B[10],Gn=B[11],E[8]=mn*J+Sn*Fe+In*Ft+Gn*Fr,E[9]=mn*he+Sn*qe+In*tr+Gn*on,E[10]=mn*xe+Sn*ft+In*Qt+Gn*$r,E[11]=mn*Te+Sn*pt+In*dr+Gn*kn,mn=B[12],Sn=B[13],In=B[14],Gn=B[15],E[12]=mn*J+Sn*Fe+In*Ft+Gn*Fr,E[13]=mn*he+Sn*qe+In*tr+Gn*on,E[14]=mn*xe+Sn*ft+In*Qt+Gn*$r,E[15]=mn*Te+Sn*pt+In*dr+Gn*kn,E}function Lo(E,C,B){var J=B[0],he=B[1],xe=B[2],Te,Fe,qe,ft,pt,Ft,tr,Qt,dr,Fr,on,$r;return C===E?(E[12]=C[0]*J+C[4]*he+C[8]*xe+C[12],E[13]=C[1]*J+C[5]*he+C[9]*xe+C[13],E[14]=C[2]*J+C[6]*he+C[10]*xe+C[14],E[15]=C[3]*J+C[7]*he+C[11]*xe+C[15]):(Te=C[0],Fe=C[1],qe=C[2],ft=C[3],pt=C[4],Ft=C[5],tr=C[6],Qt=C[7],dr=C[8],Fr=C[9],on=C[10],$r=C[11],E[0]=Te,E[1]=Fe,E[2]=qe,E[3]=ft,E[4]=pt,E[5]=Ft,E[6]=tr,E[7]=Qt,E[8]=dr,E[9]=Fr,E[10]=on,E[11]=$r,E[12]=Te*J+pt*he+dr*xe+C[12],E[13]=Fe*J+Ft*he+Fr*xe+C[13],E[14]=qe*J+tr*he+on*xe+C[14],E[15]=ft*J+Qt*he+$r*xe+C[15]),E}function qs(E,C,B){var J=B[0],he=B[1],xe=B[2];return E[0]=C[0]*J,E[1]=C[1]*J,E[2]=C[2]*J,E[3]=C[3]*J,E[4]=C[4]*he,E[5]=C[5]*he,E[6]=C[6]*he,E[7]=C[7]*he,E[8]=C[8]*xe,E[9]=C[9]*xe,E[10]=C[10]*xe,E[11]=C[11]*xe,E[12]=C[12],E[13]=C[13],E[14]=C[14],E[15]=C[15],E}function el(E,C,B){var J=Math.sin(B),he=Math.cos(B),xe=C[4],Te=C[5],Fe=C[6],qe=C[7],ft=C[8],pt=C[9],Ft=C[10],tr=C[11];return C!==E&&(E[0]=C[0],E[1]=C[1],E[2]=C[2],E[3]=C[3],E[12]=C[12],E[13]=C[13],E[14]=C[14],E[15]=C[15]),E[4]=xe*he+ft*J,E[5]=Te*he+pt*J,E[6]=Fe*he+Ft*J,E[7]=qe*he+tr*J,E[8]=ft*he-xe*J,E[9]=pt*he-Te*J,E[10]=Ft*he-Fe*J,E[11]=tr*he-qe*J,E}function Of(E,C,B){var J=Math.sin(B),he=Math.cos(B),xe=C[0],Te=C[1],Fe=C[2],qe=C[3],ft=C[4],pt=C[5],Ft=C[6],tr=C[7];return C!==E&&(E[8]=C[8],E[9]=C[9],E[10]=C[10],E[11]=C[11],E[12]=C[12],E[13]=C[13],E[14]=C[14],E[15]=C[15]),E[0]=xe*he+ft*J,E[1]=Te*he+pt*J,E[2]=Fe*he+Ft*J,E[3]=qe*he+tr*J,E[4]=ft*he-xe*J,E[5]=pt*he-Te*J,E[6]=Ft*he-Fe*J,E[7]=tr*he-qe*J,E}function fc(E,C,B,J,he){var xe=1/Math.tan(C/2),Te;return E[0]=xe/B,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=xe,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=-1,E[12]=0,E[13]=0,E[15]=0,he!=null&&he!==1/0?(Te=1/(J-he),E[10]=(he+J)*Te,E[14]=2*he*J*Te):(E[10]=-1,E[14]=-2*J),E}function uh(E,C,B,J,he,xe,Te){var Fe=1/(C-B),qe=1/(J-he),ft=1/(xe-Te);return E[0]=-2*Fe,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=-2*qe,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=2*ft,E[11]=0,E[12]=(C+B)*Fe,E[13]=(he+J)*qe,E[14]=(Te+xe)*ft,E[15]=1,E}var fh=uf;function Tf(){var E=new hs(3);return hs!=Float32Array&&(E[0]=0,E[1]=0,E[2]=0),E}function ch(E){var C=new hs(3);return C[0]=E[0],C[1]=E[1],C[2]=E[2],C}function Bf(E,C,B){return E[0]=C[0]+B[0],E[1]=C[1]+B[1],E[2]=C[2]+B[2],E}function hh(E,C,B){return E[0]=C[0]-B[0],E[1]=C[1]-B[1],E[2]=C[2]-B[2],E}function vh(E,C,B){return E[0]=C[0]*B,E[1]=C[1]*B,E[2]=C[2]*B,E}function cc(E,C){var B=C[0],J=C[1],he=C[2],xe=B*B+J*J+he*he;return xe>0&&(xe=1/Math.sqrt(xe)),E[0]=C[0]*xe,E[1]=C[1]*xe,E[2]=C[2]*xe,E}function lp(E,C){return E[0]*C[0]+E[1]*C[1]+E[2]*C[2]}function up(E,C,B){var J=C[0],he=C[1],xe=C[2],Te=B[0],Fe=B[1],qe=B[2];return E[0]=he*qe-xe*Fe,E[1]=xe*Te-J*qe,E[2]=J*Fe-he*Te,E}function fp(E,C,B){var J=C[0],he=C[1],xe=C[2];return E[0]=J*B[0]+he*B[3]+xe*B[6],E[1]=J*B[1]+he*B[4]+xe*B[7],E[2]=J*B[2]+he*B[5]+xe*B[8],E}var cp=hh;(function(){var E=Tf();return function(C,B,J,he,xe,Te){var Fe,qe;for(B||(B=3),J||(J=0),he?qe=Math.min(he*B+J,C.length):qe=C.length,Fe=J;Fe<qe;Fe+=B)E[0]=C[Fe],E[1]=C[Fe+1],E[2]=C[Fe+2],xe(E,E,Te),C[Fe]=E[0],C[Fe+1]=E[1],C[Fe+2]=E[2];return C}})();function hp(){var E=new hs(4);return hs!=Float32Array&&(E[0]=0,E[1]=0,E[2]=0,E[3]=0),E}function vp(E,C,B){return E[0]=C[0]*B,E[1]=C[1]*B,E[2]=C[2]*B,E[3]=C[3]*B,E}function pp(E,C){return E[0]*C[0]+E[1]*C[1]+E[2]*C[2]+E[3]*C[3]}function Ic(E,C,B){var J=C[0],he=C[1],xe=C[2],Te=C[3];return E[0]=B[0]*J+B[4]*he+B[8]*xe+B[12]*Te,E[1]=B[1]*J+B[5]*he+B[9]*xe+B[13]*Te,E[2]=B[2]*J+B[6]*he+B[10]*xe+B[14]*Te,E[3]=B[3]*J+B[7]*he+B[11]*xe+B[15]*Te,E}(function(){var E=hp();return function(C,B,J,he,xe,Te){var Fe,qe;for(B||(B=4),J||(J=0),he?qe=Math.min(he*B+J,C.length):qe=C.length,Fe=J;Fe<qe;Fe+=B)E[0]=C[Fe],E[1]=C[Fe+1],E[2]=C[Fe+2],E[3]=C[Fe+3],xe(E,E,Te),C[Fe]=E[0],C[Fe+1]=E[1],C[Fe+2]=E[2],C[Fe+3]=E[3];return C}})();function dp(){var E=new hs(2);return hs!=Float32Array&&(E[0]=0,E[1]=0),E}function gp(E){var C=E[0],B=E[1];return C*C+B*B}var yp=gp;(function(){var E=dp();return function(C,B,J,he,xe,Te){var Fe,qe;for(B||(B=2),J||(J=0),he?qe=Math.min(he*B+J,C.length):qe=C.length,Fe=J;Fe<qe;Fe+=B)E[0]=C[Fe],E[1]=C[Fe+1],xe(E,E,Te),C[Fe]=E[0],C[Fe+1]=E[1];return C}})();var mp=function(E){function C(B){E.call(this,B,Zu)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.createBucket=function(J){return new Ji(J)},C.prototype.queryRadius=function(J){var he=J;return cl("circle-radius",this,he)+cl("circle-stroke-width",this,he)+tu(this.paint.get("circle-translate"))},C.prototype.queryIntersectsFeature=function(J,he,xe,Te,Fe,qe,ft,pt){for(var Ft=Hl(J,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),qe.angle,ft),tr=this.paint.get("circle-radius").evaluate(he,xe),Qt=this.paint.get("circle-stroke-width").evaluate(he,xe),dr=tr+Qt,Fr=this.paint.get("circle-pitch-alignment")==="map",on=Fr?Ft:xp(Ft,pt),$r=Fr?dr*ft:dr,kn=0,mn=Te;kn<mn.length;kn+=1)for(var Sn=mn[kn],In=0,Gn=Sn;In<Gn.length;In+=1){var oa=Gn[In],na=Fr?oa:Gh(oa,pt),Ra=$r,wa=Ic([],[oa.x,oa.y,0,1],pt);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ra*=wa[3]/qe.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ra*=qe.cameraToCenterDistance/wa[3]),wi(on,na,Ra))return!0}return!1},C}(bs);function Gh(E,C){var B=Ic([],[E.x,E.y,0,1],C);return new c(B[0]/B[3],B[1]/B[3])}function xp(E,C){return E.map(function(B){return Gh(B,C)})}var Yh=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(Ji);Oe("HeatmapBucket",Yh,{omit:["layers"]});function ph(E,C,B,J){var he=C.width,xe=C.height;if(!J)J=new Uint8Array(he*xe*B);else if(J instanceof Uint8ClampedArray)J=new Uint8Array(J.buffer);else if(J.length!==he*xe*B)throw new RangeError("mismatched image size");return E.width=he,E.height=xe,E.data=J,E}function Wh(E,C,B){var J=C.width,he=C.height;if(!(J===E.width&&he===E.height)){var xe=ph({},{width:J,height:he},B);dh(E,xe,{x:0,y:0},{x:0,y:0},{width:Math.min(E.width,J),height:Math.min(E.height,he)},B),E.width=J,E.height=he,E.data=xe.data}}function dh(E,C,B,J,he,xe){if(he.width===0||he.height===0)return C;if(he.width>E.width||he.height>E.height||B.x>E.width-he.width||B.y>E.height-he.height)throw new RangeError("out of range source coordinates for image copy");if(he.width>C.width||he.height>C.height||J.x>C.width-he.width||J.y>C.height-he.height)throw new RangeError("out of range destination coordinates for image copy");for(var Te=E.data,Fe=C.data,qe=0;qe<he.height;qe++)for(var ft=((B.y+qe)*E.width+B.x)*xe,pt=((J.y+qe)*C.width+J.x)*xe,Ft=0;Ft<he.width*xe;Ft++)Fe[pt+Ft]=Te[ft+Ft];return C}var Af=function(C,B){ph(this,C,1,B)};Af.prototype.resize=function(C){Wh(this,C,1)},Af.prototype.clone=function(){return new Af({width:this.width,height:this.height},new Uint8Array(this.data))},Af.copy=function(C,B,J,he,xe){dh(C,B,J,he,xe,1)};var tl=function(C,B){ph(this,C,4,B)};tl.prototype.resize=function(C){Wh(this,C,4)},tl.prototype.replace=function(C,B){B?this.data.set(C):C instanceof Uint8ClampedArray?this.data=new Uint8Array(C.buffer):this.data=C},tl.prototype.clone=function(){return new tl({width:this.width,height:this.height},new Uint8Array(this.data))},tl.copy=function(C,B,J,he,xe){dh(C,B,J,he,xe,4)},Oe("AlphaImage",Af),Oe("RGBAImage",tl);var bp=new ji({"heatmap-radius":new Za(Vt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Za(Vt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ia(Vt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ro(Vt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ia(Vt.paint_heatmap["heatmap-opacity"])}),_p={paint:bp};function Xh(E,C){for(var B=new Uint8Array(1024),J={},he=0,xe=0;he<256;he++,xe+=4){J[C]=he/255;var Te=E.evaluate(J);B[xe+0]=Math.floor(Te.r*255/Te.a),B[xe+1]=Math.floor(Te.g*255/Te.a),B[xe+2]=Math.floor(Te.b*255/Te.a),B[xe+3]=Math.floor(Te.a*255)}return new tl({width:256,height:1},B)}var wp=function(E){function C(B){E.call(this,B,_p),this._updateColorRamp()}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.createBucket=function(J){return new Yh(J)},C.prototype._handleSpecialPaintPropertyUpdate=function(J){J==="heatmap-color"&&this._updateColorRamp()},C.prototype._updateColorRamp=function(){var J=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Xh(J,"heatmapDensity"),this.colorRampTexture=null},C.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},C.prototype.queryRadius=function(){return 0},C.prototype.queryIntersectsFeature=function(){return!1},C.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},C}(bs),Tp=new ji({"hillshade-illumination-direction":new Ia(Vt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ia(Vt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ia(Vt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ia(Vt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ia(Vt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ia(Vt.paint_hillshade["hillshade-accent-color"])}),Ap={paint:Tp},Mp=function(E){function C(B){E.call(this,B,Ap)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},C}(bs),Sp=Io([{name:"a_pos",components:2,type:"Int16"}],4),Zh=Sp.members,gh=zc,kp=zc;function zc(E,C,B){B=B||2;var J=C&&C.length,he=J?C[0]*B:E.length,xe=jh(E,0,he,B,!0),Te=[];if(!xe||xe.next===xe.prev)return Te;var Fe,qe,ft,pt,Ft,tr,Qt;if(J&&(xe=Dp(E,C,xe,B)),E.length>80*B){Fe=ft=E[0],qe=pt=E[1];for(var dr=B;dr<he;dr+=B)Ft=E[dr],tr=E[dr+1],Ft<Fe&&(Fe=Ft),tr<qe&&(qe=tr),Ft>ft&&(ft=Ft),tr>pt&&(pt=tr);Qt=Math.max(ft-Fe,pt-qe),Qt=Qt!==0?1/Qt:0}return hc(xe,Te,B,Fe,qe,Qt),Te}function jh(E,C,B,J,he){var xe,Te;if(he===xh(E,C,B,J)>0)for(xe=C;xe<B;xe+=J)Te=Qh(xe,E[xe],E[xe+1],Te);else for(xe=B-J;xe>=C;xe-=J)Te=Qh(xe,E[xe],E[xe+1],Te);return Te&&Fc(Te,Te.next)&&(pc(Te),Te=Te.next),Te}function ff(E,C){if(!E)return E;C||(C=E);var B=E,J;do if(J=!1,!B.steiner&&(Fc(B,B.next)||Uo(B.prev,B,B.next)===0)){if(pc(B),B=C=B.prev,B===B.next)break;J=!0}else B=B.next;while(J||B!==C);return C}function hc(E,C,B,J,he,xe,Te){if(!!E){!Te&&xe&&Op(E,J,he,xe);for(var Fe=E,qe,ft;E.prev!==E.next;){if(qe=E.prev,ft=E.next,xe?Cp(E,J,he,xe):Ep(E)){C.push(qe.i/B),C.push(E.i/B),C.push(ft.i/B),pc(E),E=ft.next,Fe=ft.next;continue}if(E=ft,E===Fe){Te?Te===1?(E=Lp(ff(E),C,B),hc(E,C,B,J,he,xe,2)):Te===2&&Pp(E,C,B,J,he,xe):hc(ff(E),C,B,J,he,xe,1);break}}}}function Ep(E){var C=E.prev,B=E,J=E.next;if(Uo(C,B,J)>=0)return!1;for(var he=E.next.next;he!==E.prev;){if(Nf(C.x,C.y,B.x,B.y,J.x,J.y,he.x,he.y)&&Uo(he.prev,he,he.next)>=0)return!1;he=he.next}return!0}function Cp(E,C,B,J){var he=E.prev,xe=E,Te=E.next;if(Uo(he,xe,Te)>=0)return!1;for(var Fe=he.x<xe.x?he.x<Te.x?he.x:Te.x:xe.x<Te.x?xe.x:Te.x,qe=he.y<xe.y?he.y<Te.y?he.y:Te.y:xe.y<Te.y?xe.y:Te.y,ft=he.x>xe.x?he.x>Te.x?he.x:Te.x:xe.x>Te.x?xe.x:Te.x,pt=he.y>xe.y?he.y>Te.y?he.y:Te.y:xe.y>Te.y?xe.y:Te.y,Ft=yh(Fe,qe,C,B,J),tr=yh(ft,pt,C,B,J),Qt=E.prevZ,dr=E.nextZ;Qt&&Qt.z>=Ft&&dr&&dr.z<=tr;){if(Qt!==E.prev&&Qt!==E.next&&Nf(he.x,he.y,xe.x,xe.y,Te.x,Te.y,Qt.x,Qt.y)&&Uo(Qt.prev,Qt,Qt.next)>=0||(Qt=Qt.prevZ,dr!==E.prev&&dr!==E.next&&Nf(he.x,he.y,xe.x,xe.y,Te.x,Te.y,dr.x,dr.y)&&Uo(dr.prev,dr,dr.next)>=0))return!1;dr=dr.nextZ}for(;Qt&&Qt.z>=Ft;){if(Qt!==E.prev&&Qt!==E.next&&Nf(he.x,he.y,xe.x,xe.y,Te.x,Te.y,Qt.x,Qt.y)&&Uo(Qt.prev,Qt,Qt.next)>=0)return!1;Qt=Qt.prevZ}for(;dr&&dr.z<=tr;){if(dr!==E.prev&&dr!==E.next&&Nf(he.x,he.y,xe.x,xe.y,Te.x,Te.y,dr.x,dr.y)&&Uo(dr.prev,dr,dr.next)>=0)return!1;dr=dr.nextZ}return!0}function Lp(E,C,B){var J=E;do{var he=J.prev,xe=J.next.next;!Fc(he,xe)&&Kh(he,J,J.next,xe)&&vc(he,xe)&&vc(xe,he)&&(C.push(he.i/B),C.push(J.i/B),C.push(xe.i/B),pc(J),pc(J.next),J=E=xe),J=J.next}while(J!==E);return ff(J)}function Pp(E,C,B,J,he,xe){var Te=E;do{for(var Fe=Te.next.next;Fe!==Te.prev;){if(Te.i!==Fe.i&&Up(Te,Fe)){var qe=Jh(Te,Fe);Te=ff(Te,Te.next),qe=ff(qe,qe.next),hc(Te,C,B,J,he,xe),hc(qe,C,B,J,he,xe);return}Fe=Fe.next}Te=Te.next}while(Te!==E)}function Dp(E,C,B,J){var he=[],xe,Te,Fe,qe,ft;for(xe=0,Te=C.length;xe<Te;xe++)Fe=C[xe]*J,qe=xe<Te-1?C[xe+1]*J:E.length,ft=jh(E,Fe,qe,J,!1),ft===ft.next&&(ft.steiner=!0),he.push(Np(ft));for(he.sort(Rp),xe=0;xe<he.length;xe++)Ip(he[xe],B),B=ff(B,B.next);return B}function Rp(E,C){return E.x-C.x}function Ip(E,C){if(C=zp(E,C),C){var B=Jh(C,E);ff(C,C.next),ff(B,B.next)}}function zp(E,C){var B=C,J=E.x,he=E.y,xe=-1/0,Te;do{if(he<=B.y&&he>=B.next.y&&B.next.y!==B.y){var Fe=B.x+(he-B.y)*(B.next.x-B.x)/(B.next.y-B.y);if(Fe<=J&&Fe>xe){if(xe=Fe,Fe===J){if(he===B.y)return B;if(he===B.next.y)return B.next}Te=B.x<B.next.x?B:B.next}}B=B.next}while(B!==C);if(!Te)return null;if(J===xe)return Te;var qe=Te,ft=Te.x,pt=Te.y,Ft=1/0,tr;B=Te;do J>=B.x&&B.x>=ft&&J!==B.x&&Nf(he<pt?J:xe,he,ft,pt,he<pt?xe:J,he,B.x,B.y)&&(tr=Math.abs(he-B.y)/(J-B.x),vc(B,E)&&(tr<Ft||tr===Ft&&(B.x>Te.x||B.x===Te.x&&Fp(Te,B)))&&(Te=B,Ft=tr)),B=B.next;while(B!==qe);return Te}function Fp(E,C){return Uo(E.prev,E,C.prev)<0&&Uo(C.next,E,E.next)<0}function Op(E,C,B,J){var he=E;do he.z===null&&(he.z=yh(he.x,he.y,C,B,J)),he.prevZ=he.prev,he.nextZ=he.next,he=he.next;while(he!==E);he.prevZ.nextZ=null,he.prevZ=null,Bp(he)}function Bp(E){var C,B,J,he,xe,Te,Fe,qe,ft=1;do{for(B=E,E=null,xe=null,Te=0;B;){for(Te++,J=B,Fe=0,C=0;C<ft&&(Fe++,J=J.nextZ,!!J);C++);for(qe=ft;Fe>0||qe>0&&J;)Fe!==0&&(qe===0||!J||B.z<=J.z)?(he=B,B=B.nextZ,Fe--):(he=J,J=J.nextZ,qe--),xe?xe.nextZ=he:E=he,he.prevZ=xe,xe=he;B=J}xe.nextZ=null,ft*=2}while(Te>1);return E}function yh(E,C,B,J,he){return E=32767*(E-B)*he,C=32767*(C-J)*he,E=(E|E<<8)&16711935,E=(E|E<<4)&252645135,E=(E|E<<2)&858993459,E=(E|E<<1)&1431655765,C=(C|C<<8)&16711935,C=(C|C<<4)&252645135,C=(C|C<<2)&858993459,C=(C|C<<1)&1431655765,E|C<<1}function Np(E){var C=E,B=E;do(C.x<B.x||C.x===B.x&&C.y<B.y)&&(B=C),C=C.next;while(C!==E);return B}function Nf(E,C,B,J,he,xe,Te,Fe){return(he-Te)*(C-Fe)-(E-Te)*(xe-Fe)>=0&&(E-Te)*(J-Fe)-(B-Te)*(C-Fe)>=0&&(B-Te)*(xe-Fe)-(he-Te)*(J-Fe)>=0}function Up(E,C){return E.next.i!==C.i&&E.prev.i!==C.i&&!Vp(E,C)&&(vc(E,C)&&vc(C,E)&&Hp(E,C)&&(Uo(E.prev,E,C.prev)||Uo(E,C.prev,C))||Fc(E,C)&&Uo(E.prev,E,E.next)>0&&Uo(C.prev,C,C.next)>0)}function Uo(E,C,B){return(C.y-E.y)*(B.x-C.x)-(C.x-E.x)*(B.y-C.y)}function Fc(E,C){return E.x===C.x&&E.y===C.y}function Kh(E,C,B,J){var he=Bc(Uo(E,C,B)),xe=Bc(Uo(E,C,J)),Te=Bc(Uo(B,J,E)),Fe=Bc(Uo(B,J,C));return!!(he!==xe&&Te!==Fe||he===0&&Oc(E,B,C)||xe===0&&Oc(E,J,C)||Te===0&&Oc(B,E,J)||Fe===0&&Oc(B,C,J))}function Oc(E,C,B){return C.x<=Math.max(E.x,B.x)&&C.x>=Math.min(E.x,B.x)&&C.y<=Math.max(E.y,B.y)&&C.y>=Math.min(E.y,B.y)}function Bc(E){return E>0?1:E<0?-1:0}function Vp(E,C){var B=E;do{if(B.i!==E.i&&B.next.i!==E.i&&B.i!==C.i&&B.next.i!==C.i&&Kh(B,B.next,E,C))return!0;B=B.next}while(B!==E);return!1}function vc(E,C){return Uo(E.prev,E,E.next)<0?Uo(E,C,E.next)>=0&&Uo(E,E.prev,C)>=0:Uo(E,C,E.prev)<0||Uo(E,E.next,C)<0}function Hp(E,C){var B=E,J=!1,he=(E.x+C.x)/2,xe=(E.y+C.y)/2;do B.y>xe!=B.next.y>xe&&B.next.y!==B.y&&he<(B.next.x-B.x)*(xe-B.y)/(B.next.y-B.y)+B.x&&(J=!J),B=B.next;while(B!==E);return J}function Jh(E,C){var B=new mh(E.i,E.x,E.y),J=new mh(C.i,C.x,C.y),he=E.next,xe=C.prev;return E.next=C,C.prev=E,B.next=he,he.prev=B,J.next=B,B.prev=J,xe.next=J,J.prev=xe,J}function Qh(E,C,B,J){var he=new mh(E,C,B);return J?(he.next=J.next,he.prev=J,J.next.prev=he,J.next=he):(he.prev=he,he.next=he),he}function pc(E){E.next.prev=E.prev,E.prev.next=E.next,E.prevZ&&(E.prevZ.nextZ=E.nextZ),E.nextZ&&(E.nextZ.prevZ=E.prevZ)}function mh(E,C,B){this.i=E,this.x=C,this.y=B,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}zc.deviation=function(E,C,B,J){var he=C&&C.length,xe=he?C[0]*B:E.length,Te=Math.abs(xh(E,0,xe,B));if(he)for(var Fe=0,qe=C.length;Fe<qe;Fe++){var ft=C[Fe]*B,pt=Fe<qe-1?C[Fe+1]*B:E.length;Te-=Math.abs(xh(E,ft,pt,B))}var Ft=0;for(Fe=0;Fe<J.length;Fe+=3){var tr=J[Fe]*B,Qt=J[Fe+1]*B,dr=J[Fe+2]*B;Ft+=Math.abs((E[tr]-E[dr])*(E[Qt+1]-E[tr+1])-(E[tr]-E[Qt])*(E[dr+1]-E[tr+1]))}return Te===0&&Ft===0?0:Math.abs((Ft-Te)/Te)};function xh(E,C,B,J){for(var he=0,xe=C,Te=B-J;xe<B;xe+=J)he+=(E[Te]-E[xe])*(E[xe+1]+E[Te+1]),Te=xe;return he}zc.flatten=function(E){for(var C=E[0][0].length,B={vertices:[],holes:[],dimensions:C},J=0,he=0;he<E.length;he++){for(var xe=0;xe<E[he].length;xe++)for(var Te=0;Te<C;Te++)B.vertices.push(E[he][xe][Te]);he>0&&(J+=E[he-1].length,B.holes.push(J))}return B},gh.default=kp;function Gp(E,C,B,J,he){$h(E,C,B||0,J||E.length-1,he||Yp)}function $h(E,C,B,J,he){for(;J>B;){if(J-B>600){var xe=J-B+1,Te=C-B+1,Fe=Math.log(xe),qe=.5*Math.exp(2*Fe/3),ft=.5*Math.sqrt(Fe*qe*(xe-qe)/xe)*(Te-xe/2<0?-1:1),pt=Math.max(B,Math.floor(C-Te*qe/xe+ft)),Ft=Math.min(J,Math.floor(C+(xe-Te)*qe/xe+ft));$h(E,C,pt,Ft,he)}var tr=E[C],Qt=B,dr=J;for(dc(E,B,C),he(E[J],tr)>0&&dc(E,B,J);Qt<dr;){for(dc(E,Qt,dr),Qt++,dr--;he(E[Qt],tr)<0;)Qt++;for(;he(E[dr],tr)>0;)dr--}he(E[B],tr)===0?dc(E,B,dr):(dr++,dc(E,dr,J)),dr<=C&&(B=dr+1),C<=dr&&(J=dr-1)}}function dc(E,C,B){var J=E[C];E[C]=E[B],E[B]=J}function Yp(E,C){return E<C?-1:E>C?1:0}function bh(E,C){var B=E.length;if(B<=1)return[E];for(var J=[],he,xe,Te=0;Te<B;Te++){var Fe=N(E[Te]);Fe!==0&&(E[Te].area=Math.abs(Fe),xe===void 0&&(xe=Fe<0),xe===Fe<0?(he&&J.push(he),he=[E[Te]]):he.push(E[Te]))}if(he&&J.push(he),C>1)for(var qe=0;qe<J.length;qe++)J[qe].length<=C||(Gp(J[qe],C,1,J[qe].length-1,Wp),J[qe]=J[qe].slice(0,C));return J}function Wp(E,C){return C.area-E.area}function _h(E,C,B){for(var J=B.patternDependencies,he=!1,xe=0,Te=C;xe<Te.length;xe+=1){var Fe=Te[xe],qe=Fe.paint.get(E+"-pattern");qe.isConstant()||(he=!0);var ft=qe.constantOr(null);ft&&(he=!0,J[ft.to]=!0,J[ft.from]=!0)}return he}function wh(E,C,B,J,he){for(var xe=he.patternDependencies,Te=0,Fe=C;Te<Fe.length;Te+=1){var qe=Fe[Te],ft=qe.paint.get(E+"-pattern"),pt=ft.value;if(pt.kind!=="constant"){var Ft=pt.evaluate({zoom:J-1},B,{},he.availableImages),tr=pt.evaluate({zoom:J},B,{},he.availableImages),Qt=pt.evaluate({zoom:J+1},B,{},he.availableImages);Ft=Ft&&Ft.name?Ft.name:Ft,tr=tr&&tr.name?tr.name:tr,Qt=Qt&&Qt.name?Qt.name:Qt,xe[Ft]=!0,xe[tr]=!0,xe[Qt]=!0,B.patterns[qe.id]={min:Ft,mid:tr,max:Qt}}}return B}var Xp=500,wu=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(B){return B.id}),this.index=C.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new yf,this.indexArray=new bu,this.indexArray2=new bf,this.programConfigurations=new ni(Zh,C.layers,C.zoom),this.segments=new H,this.segments2=new H,this.stateDependentLayerIds=this.layers.filter(function(B){return B.isStateDependent()}).map(function(B){return B.id})};wu.prototype.populate=function(C,B,J){this.hasPattern=_h("fill",this.layers,B);for(var he=this.layers[0].layout.get("fill-sort-key"),xe=[],Te=0,Fe=C;Te<Fe.length;Te+=1){var qe=Fe[Te],ft=qe.feature,pt=qe.id,Ft=qe.index,tr=qe.sourceLayerIndex,Qt=this.layers[0]._featureFilter.needGeometry,dr={type:ft.type,id:pt,properties:ft.properties,geometry:Qt?Ui(ft):[]};if(!!this.layers[0]._featureFilter.filter(new si(this.zoom),dr,J)){Qt||(dr.geometry=Ui(ft));var Fr=he?he.evaluate(dr,{},J,B.availableImages):void 0,on={id:pt,properties:ft.properties,type:ft.type,sourceLayerIndex:tr,index:Ft,geometry:dr.geometry,patterns:{},sortKey:Fr};xe.push(on)}}he&&xe.sort(function(wa,Sa){return wa.sortKey-Sa.sortKey});for(var $r=0,kn=xe;$r<kn.length;$r+=1){var mn=kn[$r],Sn=mn,In=Sn.geometry,Gn=Sn.index,oa=Sn.sourceLayerIndex;if(this.hasPattern){var na=wh("fill",this.layers,mn,this.zoom,B);this.patternFeatures.push(na)}else this.addFeature(mn,In,Gn,J,{});var Ra=C[Gn].feature;B.featureIndex.insert(Ra,In,Gn,oa,this.index)}},wu.prototype.update=function(C,B,J){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(C,B,this.stateDependentLayers,J)},wu.prototype.addFeatures=function(C,B,J){for(var he=0,xe=this.patternFeatures;he<xe.length;he+=1){var Te=xe[he];this.addFeature(Te,Te.geometry,Te.index,B,J)}},wu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},wu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},wu.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,Zh),this.indexBuffer=C.createIndexBuffer(this.indexArray),this.indexBuffer2=C.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(C),this.uploaded=!0},wu.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},wu.prototype.addFeature=function(C,B,J,he,xe){for(var Te=0,Fe=bh(B,Xp);Te<Fe.length;Te+=1){for(var qe=Fe[Te],ft=0,pt=0,Ft=qe;pt<Ft.length;pt+=1){var tr=Ft[pt];ft+=tr.length}for(var Qt=this.segments.prepareSegment(ft,this.layoutVertexArray,this.indexArray),dr=Qt.vertexLength,Fr=[],on=[],$r=0,kn=qe;$r<kn.length;$r+=1){var mn=kn[$r];if(mn.length!==0){mn!==qe[0]&&on.push(Fr.length/2);var Sn=this.segments2.prepareSegment(mn.length,this.layoutVertexArray,this.indexArray2),In=Sn.vertexLength;this.layoutVertexArray.emplaceBack(mn[0].x,mn[0].y),this.indexArray2.emplaceBack(In+mn.length-1,In),Fr.push(mn[0].x),Fr.push(mn[0].y);for(var Gn=1;Gn<mn.length;Gn++)this.layoutVertexArray.emplaceBack(mn[Gn].x,mn[Gn].y),this.indexArray2.emplaceBack(In+Gn-1,In+Gn),Fr.push(mn[Gn].x),Fr.push(mn[Gn].y);Sn.vertexLength+=mn.length,Sn.primitiveLength+=mn.length}}for(var oa=gh(Fr,on),na=0;na<oa.length;na+=3)this.indexArray.emplaceBack(dr+oa[na],dr+oa[na+1],dr+oa[na+2]);Qt.vertexLength+=ft,Qt.primitiveLength+=oa.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,J,xe,he)},Oe("FillBucket",wu,{omit:["layers","patternFeatures"]});var Zp=new ji({"fill-sort-key":new Za(Vt.layout_fill["fill-sort-key"])}),jp=new ji({"fill-antialias":new Ia(Vt.paint_fill["fill-antialias"]),"fill-opacity":new Za(Vt.paint_fill["fill-opacity"]),"fill-color":new Za(Vt.paint_fill["fill-color"]),"fill-outline-color":new Za(Vt.paint_fill["fill-outline-color"]),"fill-translate":new Ia(Vt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ia(Vt.paint_fill["fill-translate-anchor"]),"fill-pattern":new _o(Vt.paint_fill["fill-pattern"])}),Kp={paint:jp,layout:Zp},Jp=function(E){function C(B){E.call(this,B,Kp)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.recalculate=function(J,he){E.prototype.recalculate.call(this,J,he);var xe=this.paint._values["fill-outline-color"];xe.value.kind==="constant"&&xe.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},C.prototype.createBucket=function(J){return new wu(J)},C.prototype.queryRadius=function(){return tu(this.paint.get("fill-translate"))},C.prototype.queryIntersectsFeature=function(J,he,xe,Te,Fe,qe,ft){var pt=Hl(J,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),qe.angle,ft);return To(pt,Te)},C.prototype.isTileClipped=function(){return!0},C}(bs),Qp=Io([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),qh=Qp.members,ev=Uf;function Uf(E,C,B,J,he){this.properties={},this.extent=B,this.type=0,this._pbf=E,this._geometry=-1,this._keys=J,this._values=he,E.readFields($p,this,C)}function $p(E,C,B){E==1?C.id=B.readVarint():E==2?qp(B,C):E==3?C.type=B.readVarint():E==4&&(C._geometry=B.pos)}function qp(E,C){for(var B=E.readVarint()+E.pos;E.pos<B;){var J=C._keys[E.readVarint()],he=C._values[E.readVarint()];C.properties[J]=he}}Uf.types=["Unknown","Point","LineString","Polygon"],Uf.prototype.loadGeometry=function(){var E=this._pbf;E.pos=this._geometry;for(var C=E.readVarint()+E.pos,B=1,J=0,he=0,xe=0,Te=[],Fe;E.pos<C;){if(J<=0){var qe=E.readVarint();B=qe&7,J=qe>>3}if(J--,B===1||B===2)he+=E.readSVarint(),xe+=E.readSVarint(),B===1&&(Fe&&Te.push(Fe),Fe=[]),Fe.push(new c(he,xe));else if(B===7)Fe&&Fe.push(Fe[0].clone());else throw new Error("unknown command "+B)}return Fe&&Te.push(Fe),Te},Uf.prototype.bbox=function(){var E=this._pbf;E.pos=this._geometry;for(var C=E.readVarint()+E.pos,B=1,J=0,he=0,xe=0,Te=1/0,Fe=-1/0,qe=1/0,ft=-1/0;E.pos<C;){if(J<=0){var pt=E.readVarint();B=pt&7,J=pt>>3}if(J--,B===1||B===2)he+=E.readSVarint(),xe+=E.readSVarint(),he<Te&&(Te=he),he>Fe&&(Fe=he),xe<qe&&(qe=xe),xe>ft&&(ft=xe);else if(B!==7)throw new Error("unknown command "+B)}return[Te,qe,Fe,ft]},Uf.prototype.toGeoJSON=function(E,C,B){var J=this.extent*Math.pow(2,B),he=this.extent*E,xe=this.extent*C,Te=this.loadGeometry(),Fe=Uf.types[this.type],qe,ft;function pt(Qt){for(var dr=0;dr<Qt.length;dr++){var Fr=Qt[dr],on=180-(Fr.y+xe)*360/J;Qt[dr]=[(Fr.x+he)*360/J-180,360/Math.PI*Math.atan(Math.exp(on*Math.PI/180))-90]}}switch(this.type){case 1:var Ft=[];for(qe=0;qe<Te.length;qe++)Ft[qe]=Te[qe][0];Te=Ft,pt(Te);break;case 2:for(qe=0;qe<Te.length;qe++)pt(Te[qe]);break;case 3:for(Te=ed(Te),qe=0;qe<Te.length;qe++)for(ft=0;ft<Te[qe].length;ft++)pt(Te[qe][ft]);break}Te.length===1?Te=Te[0]:Fe="Multi"+Fe;var tr={type:"Feature",geometry:{type:Fe,coordinates:Te},properties:this.properties};return"id"in this&&(tr.id=this.id),tr};function ed(E){var C=E.length;if(C<=1)return[E];for(var B=[],J,he,xe=0;xe<C;xe++){var Te=td(E[xe]);Te!==0&&(he===void 0&&(he=Te<0),he===Te<0?(J&&B.push(J),J=[E[xe]]):J.push(E[xe]))}return J&&B.push(J),B}function td(E){for(var C=0,B=0,J=E.length,he=J-1,xe,Te;B<J;he=B++)xe=E[B],Te=E[he],C+=(Te.x-xe.x)*(xe.y+Te.y);return C}var tv=rv;function rv(E,C){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=E,this._keys=[],this._values=[],this._features=[],E.readFields(rd,this,C),this.length=this._features.length}function rd(E,C,B){E===15?C.version=B.readVarint():E===1?C.name=B.readString():E===5?C.extent=B.readVarint():E===2?C._features.push(B.pos):E===3?C._keys.push(B.readString()):E===4&&C._values.push(nd(B))}function nd(E){for(var C=null,B=E.readVarint()+E.pos;E.pos<B;){var J=E.readVarint()>>3;C=J===1?E.readString():J===2?E.readFloat():J===3?E.readDouble():J===4?E.readVarint64():J===5?E.readVarint():J===6?E.readSVarint():J===7?E.readBoolean():null}return C}rv.prototype.feature=function(E){if(E<0||E>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[E];var C=this._pbf.readVarint()+this._pbf.pos;return new ev(this._pbf,C,this.extent,this._keys,this._values)};var ad=id;function id(E,C){this.layers=E.readFields(od,{},C)}function od(E,C,B){if(E===3){var J=new tv(B,B.readVarint()+B.pos);J.length&&(C[J.name]=J)}}var sd=ad,ld=ev,ud=tv,Vf={VectorTile:sd,VectorTileFeature:ld,VectorTileLayer:ud},fd=Vf.VectorTileFeature.types,cd=500,Th=Math.pow(2,13);function gc(E,C,B,J,he,xe,Te,Fe){E.emplaceBack(C,B,Math.floor(J*Th)*2+Te,he*Th*2,xe*Th*2,Math.round(Fe))}var Tu=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(B){return B.id}),this.index=C.index,this.hasPattern=!1,this.layoutVertexArray=new nf,this.indexArray=new bu,this.programConfigurations=new ni(qh,C.layers,C.zoom),this.segments=new H,this.stateDependentLayerIds=this.layers.filter(function(B){return B.isStateDependent()}).map(function(B){return B.id})};Tu.prototype.populate=function(C,B,J){this.features=[],this.hasPattern=_h("fill-extrusion",this.layers,B);for(var he=0,xe=C;he<xe.length;he+=1){var Te=xe[he],Fe=Te.feature,qe=Te.id,ft=Te.index,pt=Te.sourceLayerIndex,Ft=this.layers[0]._featureFilter.needGeometry,tr={type:Fe.type,id:qe,properties:Fe.properties,geometry:Ft?Ui(Fe):[]};if(!!this.layers[0]._featureFilter.filter(new si(this.zoom),tr,J)){var Qt={id:qe,sourceLayerIndex:pt,index:ft,geometry:Ft?tr.geometry:Ui(Fe),properties:Fe.properties,type:Fe.type,patterns:{}};typeof Fe.id<"u"&&(Qt.id=Fe.id),this.hasPattern?this.features.push(wh("fill-extrusion",this.layers,Qt,this.zoom,B)):this.addFeature(Qt,Qt.geometry,ft,J,{}),B.featureIndex.insert(Fe,Qt.geometry,ft,pt,this.index,!0)}}},Tu.prototype.addFeatures=function(C,B,J){for(var he=0,xe=this.features;he<xe.length;he+=1){var Te=xe[he],Fe=Te.geometry;this.addFeature(Te,Fe,Te.index,B,J)}},Tu.prototype.update=function(C,B,J){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(C,B,this.stateDependentLayers,J)},Tu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Tu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Tu.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,qh),this.indexBuffer=C.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(C),this.uploaded=!0},Tu.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Tu.prototype.addFeature=function(C,B,J,he,xe){for(var Te=0,Fe=bh(B,cd);Te<Fe.length;Te+=1){for(var qe=Fe[Te],ft=0,pt=0,Ft=qe;pt<Ft.length;pt+=1){var tr=Ft[pt];ft+=tr.length}for(var Qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),dr=0,Fr=qe;dr<Fr.length;dr+=1){var on=Fr[dr];if(on.length!==0&&!vd(on))for(var $r=0,kn=0;kn<on.length;kn++){var mn=on[kn];if(kn>=1){var Sn=on[kn-1];if(!hd(mn,Sn)){Qt.vertexLength+4>H.MAX_VERTEX_ARRAY_LENGTH&&(Qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var In=mn.sub(Sn)._perp()._unit(),Gn=Sn.dist(mn);$r+Gn>32768&&($r=0),gc(this.layoutVertexArray,mn.x,mn.y,In.x,In.y,0,0,$r),gc(this.layoutVertexArray,mn.x,mn.y,In.x,In.y,0,1,$r),$r+=Gn,gc(this.layoutVertexArray,Sn.x,Sn.y,In.x,In.y,0,0,$r),gc(this.layoutVertexArray,Sn.x,Sn.y,In.x,In.y,0,1,$r);var oa=Qt.vertexLength;this.indexArray.emplaceBack(oa,oa+2,oa+1),this.indexArray.emplaceBack(oa+1,oa+2,oa+3),Qt.vertexLength+=4,Qt.primitiveLength+=2}}}}if(Qt.vertexLength+ft>H.MAX_VERTEX_ARRAY_LENGTH&&(Qt=this.segments.prepareSegment(ft,this.layoutVertexArray,this.indexArray)),fd[C.type]==="Polygon"){for(var na=[],Ra=[],wa=Qt.vertexLength,Sa=0,ti=qe;Sa<ti.length;Sa+=1){var La=ti[Sa];if(La.length!==0){La!==qe[0]&&Ra.push(na.length/2);for(var Da=0;Da<La.length;Da++){var fi=La[Da];gc(this.layoutVertexArray,fi.x,fi.y,0,0,1,1,0),na.push(fi.x),na.push(fi.y)}}}for(var qa=gh(na,Ra),ki=0;ki<qa.length;ki+=3)this.indexArray.emplaceBack(wa+qa[ki],wa+qa[ki+2],wa+qa[ki+1]);Qt.primitiveLength+=qa.length/3,Qt.vertexLength+=ft}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,J,xe,he)},Oe("FillExtrusionBucket",Tu,{omit:["layers","features"]});function hd(E,C){return E.x===C.x&&(E.x<0||E.x>Ba)||E.y===C.y&&(E.y<0||E.y>Ba)}function vd(E){return E.every(function(C){return C.x<0})||E.every(function(C){return C.x>Ba})||E.every(function(C){return C.y<0})||E.every(function(C){return C.y>Ba})}var pd=new ji({"fill-extrusion-opacity":new Ia(Vt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Za(Vt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ia(Vt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ia(Vt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _o(Vt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Za(Vt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Za(Vt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ia(Vt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),dd={paint:pd},gd=function(E){function C(B){E.call(this,B,dd)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.createBucket=function(J){return new Tu(J)},C.prototype.queryRadius=function(){return tu(this.paint.get("fill-extrusion-translate"))},C.prototype.is3D=function(){return!0},C.prototype.queryIntersectsFeature=function(J,he,xe,Te,Fe,qe,ft,pt){var Ft=Hl(J,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),qe.angle,ft),tr=this.paint.get("fill-extrusion-height").evaluate(he,xe),Qt=this.paint.get("fill-extrusion-base").evaluate(he,xe),dr=xd(Ft,pt,qe,0),Fr=md(Te,Qt,tr,pt),on=Fr[0],$r=Fr[1];return yd(on,$r,dr)},C}(bs);function yc(E,C){return E.x*C.x+E.y*C.y}function nv(E,C){if(E.length===1){for(var B=0,J=C[B++],he;!he||J.equals(he);)if(he=C[B++],!he)return 1/0;for(;B<C.length;B++){var xe=C[B],Te=E[0],Fe=he.sub(J),qe=xe.sub(J),ft=Te.sub(J),pt=yc(Fe,Fe),Ft=yc(Fe,qe),tr=yc(qe,qe),Qt=yc(ft,Fe),dr=yc(ft,qe),Fr=pt*tr-Ft*Ft,on=(tr*Qt-Ft*dr)/Fr,$r=(pt*dr-Ft*Qt)/Fr,kn=1-on-$r,mn=J.z*kn+he.z*on+xe.z*$r;if(isFinite(mn))return mn}return 1/0}else{for(var Sn=1/0,In=0,Gn=C;In<Gn.length;In+=1){var oa=Gn[In];Sn=Math.min(Sn,oa.z)}return Sn}}function yd(E,C,B){var J=1/0;To(B,C)&&(J=nv(B,C[0]));for(var he=0;he<C.length;he++)for(var xe=C[he],Te=E[he],Fe=0;Fe<xe.length-1;Fe++){var qe=xe[Fe],ft=xe[Fe+1],pt=Te[Fe],Ft=Te[Fe+1],tr=[qe,ft,Ft,pt,qe];ii(B,tr)&&(J=Math.min(J,nv(B,tr)))}return J===1/0?!1:J}function md(E,C,B,J){for(var he=[],xe=[],Te=J[8]*C,Fe=J[9]*C,qe=J[10]*C,ft=J[11]*C,pt=J[8]*B,Ft=J[9]*B,tr=J[10]*B,Qt=J[11]*B,dr=0,Fr=E;dr<Fr.length;dr+=1){for(var on=Fr[dr],$r=[],kn=[],mn=0,Sn=on;mn<Sn.length;mn+=1){var In=Sn[mn],Gn=In.x,oa=In.y,na=J[0]*Gn+J[4]*oa+J[12],Ra=J[1]*Gn+J[5]*oa+J[13],wa=J[2]*Gn+J[6]*oa+J[14],Sa=J[3]*Gn+J[7]*oa+J[15],ti=na+Te,La=Ra+Fe,Da=wa+qe,fi=Sa+ft,qa=na+pt,ki=Ra+Ft,Zi=wa+tr,Ei=Sa+Qt,Ci=new c(ti/fi,La/fi);Ci.z=Da/fi,$r.push(Ci);var Ti=new c(qa/Ei,ki/Ei);Ti.z=Zi/Ei,kn.push(Ti)}he.push($r),xe.push(kn)}return[he,xe]}function xd(E,C,B,J){for(var he=[],xe=0,Te=E;xe<Te.length;xe+=1){var Fe=Te[xe],qe=[Fe.x,Fe.y,J,1];Ic(qe,qe,C),he.push(new c(qe[0]/qe[3],qe[1]/qe[3]))}return he}var bd=Io([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),av=bd.members,_d=Vf.VectorTileFeature.types,iv=63,wd=Math.cos(75/2*(Math.PI/180)),Td=15,Ad=20,Md=15,ov=1/2,sv=Math.pow(2,Md-1)/ov,rl=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(B){return B.id}),this.index=C.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Lf,this.indexArray=new bu,this.programConfigurations=new ni(av,C.layers,C.zoom),this.segments=new H,this.stateDependentLayerIds=this.layers.filter(function(B){return B.isStateDependent()}).map(function(B){return B.id})};rl.prototype.populate=function(C,B,J){this.hasPattern=_h("line",this.layers,B);for(var he=this.layers[0].layout.get("line-sort-key"),xe=[],Te=0,Fe=C;Te<Fe.length;Te+=1){var qe=Fe[Te],ft=qe.feature,pt=qe.id,Ft=qe.index,tr=qe.sourceLayerIndex,Qt=this.layers[0]._featureFilter.needGeometry,dr={type:ft.type,id:pt,properties:ft.properties,geometry:Qt?Ui(ft):[]};if(!!this.layers[0]._featureFilter.filter(new si(this.zoom),dr,J)){Qt||(dr.geometry=Ui(ft));var Fr=he?he.evaluate(dr,{},J):void 0,on={id:pt,properties:ft.properties,type:ft.type,sourceLayerIndex:tr,index:Ft,geometry:dr.geometry,patterns:{},sortKey:Fr};xe.push(on)}}he&&xe.sort(function(wa,Sa){return wa.sortKey-Sa.sortKey});for(var $r=0,kn=xe;$r<kn.length;$r+=1){var mn=kn[$r],Sn=mn,In=Sn.geometry,Gn=Sn.index,oa=Sn.sourceLayerIndex;if(this.hasPattern){var na=wh("line",this.layers,mn,this.zoom,B);this.patternFeatures.push(na)}else this.addFeature(mn,In,Gn,J,{});var Ra=C[Gn].feature;B.featureIndex.insert(Ra,In,Gn,oa,this.index)}},rl.prototype.update=function(C,B,J){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(C,B,this.stateDependentLayers,J)},rl.prototype.addFeatures=function(C,B,J){for(var he=0,xe=this.patternFeatures;he<xe.length;he+=1){var Te=xe[he];this.addFeature(Te,Te.geometry,Te.index,B,J)}},rl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},rl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},rl.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,av),this.indexBuffer=C.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(C),this.uploaded=!0},rl.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},rl.prototype.addFeature=function(C,B,J,he,xe){for(var Te=this.layers[0].layout,Fe=Te.get("line-join").evaluate(C,{}),qe=Te.get("line-cap"),ft=Te.get("line-miter-limit"),pt=Te.get("line-round-limit"),Ft=0,tr=B;Ft<tr.length;Ft+=1){var Qt=tr[Ft];this.addLine(Qt,C,Fe,qe,ft,pt)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,J,xe,he)},rl.prototype.addLine=function(C,B,J,he,xe,Te){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,!!B.properties&&B.properties.hasOwnProperty("mapbox_clip_start")&&B.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+B.properties.mapbox_clip_start,this.clipEnd=+B.properties.mapbox_clip_end;for(var Fe=0;Fe<C.length-1;Fe++)this.totalDistance+=C[Fe].dist(C[Fe+1]);this.updateScaledDistance()}for(var qe=_d[B.type]==="Polygon",ft=C.length;ft>=2&&C[ft-1].equals(C[ft-2]);)ft--;for(var pt=0;pt<ft-1&&C[pt].equals(C[pt+1]);)pt++;if(!(ft<(qe?3:2))){J==="bevel"&&(xe=1.05);var Ft=this.overscaling<=16?Td*Ba/(512*this.overscaling):0,tr=this.segments.prepareSegment(ft*10,this.layoutVertexArray,this.indexArray),Qt,dr=void 0,Fr=void 0,on=void 0,$r=void 0;this.e1=this.e2=-1,qe&&(Qt=C[ft-2],$r=C[pt].sub(Qt)._unit()._perp());for(var kn=pt;kn<ft;kn++)if(Fr=kn===ft-1?qe?C[pt+1]:void 0:C[kn+1],!(Fr&&C[kn].equals(Fr))){$r&&(on=$r),Qt&&(dr=Qt),Qt=C[kn],$r=Fr?Fr.sub(Qt)._unit()._perp():on,on=on||$r;var mn=on.add($r);(mn.x!==0||mn.y!==0)&&mn._unit();var Sn=on.x*$r.x+on.y*$r.y,In=mn.x*$r.x+mn.y*$r.y,Gn=In!==0?1/In:1/0,oa=2*Math.sqrt(2-2*In),na=In<wd&&dr&&Fr,Ra=on.x*$r.y-on.y*$r.x>0;if(na&&kn>pt){var wa=Qt.dist(dr);if(wa>2*Ft){var Sa=Qt.sub(Qt.sub(dr)._mult(Ft/wa)._round());this.updateDistance(dr,Sa),this.addCurrentVertex(Sa,on,0,0,tr),dr=Sa}}var ti=dr&&Fr,La=ti?J:qe?"butt":he;if(ti&&La==="round"&&(Gn<Te?La="miter":Gn<=2&&(La="fakeround")),La==="miter"&&Gn>xe&&(La="bevel"),La==="bevel"&&(Gn>2&&(La="flipbevel"),Gn<xe&&(La="miter")),dr&&this.updateDistance(dr,Qt),La==="miter")mn._mult(Gn),this.addCurrentVertex(Qt,mn,0,0,tr);else if(La==="flipbevel"){if(Gn>100)mn=$r.mult(-1);else{var Da=Gn*on.add($r).mag()/on.sub($r).mag();mn._perp()._mult(Da*(Ra?-1:1))}this.addCurrentVertex(Qt,mn,0,0,tr),this.addCurrentVertex(Qt,mn.mult(-1),0,0,tr)}else if(La==="bevel"||La==="fakeround"){var fi=-Math.sqrt(Gn*Gn-1),qa=Ra?fi:0,ki=Ra?0:fi;if(dr&&this.addCurrentVertex(Qt,on,qa,ki,tr),La==="fakeround")for(var Zi=Math.round(oa*180/Math.PI/Ad),Ei=1;Ei<Zi;Ei++){var Ci=Ei/Zi;if(Ci!==.5){var Ti=Ci-.5,eo=1.0904+Sn*(-3.2452+Sn*(3.55645-Sn*1.43519)),ao=.848013+Sn*(-1.06021+Sn*.215638);Ci=Ci+Ci*Ti*(Ci-1)*(eo*Ti*Ti+ao)}var Ao=$r.sub(on)._mult(Ci)._add(on)._unit()._mult(Ra?-1:1);this.addHalfVertex(Qt,Ao.x,Ao.y,!1,Ra,0,tr)}Fr&&this.addCurrentVertex(Qt,$r,-qa,-ki,tr)}else if(La==="butt")this.addCurrentVertex(Qt,mn,0,0,tr);else if(La==="square"){var Po=dr?1:-1;this.addCurrentVertex(Qt,mn,Po,Po,tr)}else La==="round"&&(dr&&(this.addCurrentVertex(Qt,on,0,0,tr),this.addCurrentVertex(Qt,on,1,1,tr,!0)),Fr&&(this.addCurrentVertex(Qt,$r,-1,-1,tr,!0),this.addCurrentVertex(Qt,$r,0,0,tr)));if(na&&kn<ft-1){var es=Qt.dist(Fr);if(es>2*Ft){var Go=Qt.add(Fr.sub(Qt)._mult(Ft/es)._round());this.updateDistance(Qt,Go),this.addCurrentVertex(Go,$r,0,0,tr),Qt=Go}}}}},rl.prototype.addCurrentVertex=function(C,B,J,he,xe,Te){Te===void 0&&(Te=!1);var Fe=B.x+B.y*J,qe=B.y-B.x*J,ft=-B.x+B.y*he,pt=-B.y-B.x*he;this.addHalfVertex(C,Fe,qe,Te,!1,J,xe),this.addHalfVertex(C,ft,pt,Te,!0,-he,xe),this.distance>sv/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(C,B,J,he,xe,Te))},rl.prototype.addHalfVertex=function(C,B,J,he,xe,Te,Fe){var qe=C.x,ft=C.y,pt=this.scaledDistance*ov;this.layoutVertexArray.emplaceBack((qe<<1)+(he?1:0),(ft<<1)+(xe?1:0),Math.round(iv*B)+128,Math.round(iv*J)+128,(Te===0?0:Te<0?-1:1)+1|(pt&63)<<2,pt>>6);var Ft=Fe.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Ft),Fe.primitiveLength++),xe?this.e2=Ft:this.e1=Ft},rl.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(sv-1):this.distance},rl.prototype.updateDistance=function(C,B){this.distance+=C.dist(B),this.updateScaledDistance()},Oe("LineBucket",rl,{omit:["layers","patternFeatures"]});var Sd=new ji({"line-cap":new Ia(Vt.layout_line["line-cap"]),"line-join":new Za(Vt.layout_line["line-join"]),"line-miter-limit":new Ia(Vt.layout_line["line-miter-limit"]),"line-round-limit":new Ia(Vt.layout_line["line-round-limit"]),"line-sort-key":new Za(Vt.layout_line["line-sort-key"])}),kd=new ji({"line-opacity":new Za(Vt.paint_line["line-opacity"]),"line-color":new Za(Vt.paint_line["line-color"]),"line-translate":new Ia(Vt.paint_line["line-translate"]),"line-translate-anchor":new Ia(Vt.paint_line["line-translate-anchor"]),"line-width":new Za(Vt.paint_line["line-width"]),"line-gap-width":new Za(Vt.paint_line["line-gap-width"]),"line-offset":new Za(Vt.paint_line["line-offset"]),"line-blur":new Za(Vt.paint_line["line-blur"]),"line-dasharray":new ro(Vt.paint_line["line-dasharray"]),"line-pattern":new _o(Vt.paint_line["line-pattern"]),"line-gradient":new Ro(Vt.paint_line["line-gradient"])}),lv={paint:kd,layout:Sd},Ed=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.possiblyEvaluate=function(J,he){return he=new si(Math.floor(he.zoom),{now:he.now,fadeDuration:he.fadeDuration,zoomHistory:he.zoomHistory,transition:he.transition}),E.prototype.possiblyEvaluate.call(this,J,he)},C.prototype.evaluate=function(J,he,xe,Te){return he=w({},he,{zoom:Math.floor(he.zoom)}),E.prototype.evaluate.call(this,J,he,xe,Te)},C}(Za),uv=new Ed(lv.paint.properties["line-width"].specification);uv.useIntegerZoom=!0;var Cd=function(E){function C(B){E.call(this,B,lv)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._handleSpecialPaintPropertyUpdate=function(J){J==="line-gradient"&&this._updateGradient()},C.prototype._updateGradient=function(){var J=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Xh(J,"lineProgress"),this.gradientTexture=null},C.prototype.recalculate=function(J,he){E.prototype.recalculate.call(this,J,he),this.paint._values["line-floorwidth"]=uv.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,J)},C.prototype.createBucket=function(J){return new rl(J)},C.prototype.queryRadius=function(J){var he=J,xe=fv(cl("line-width",this,he),cl("line-gap-width",this,he)),Te=cl("line-offset",this,he);return xe/2+Math.abs(Te)+tu(this.paint.get("line-translate"))},C.prototype.queryIntersectsFeature=function(J,he,xe,Te,Fe,qe,ft){var pt=Hl(J,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),qe.angle,ft),Ft=ft/2*fv(this.paint.get("line-width").evaluate(he,xe),this.paint.get("line-gap-width").evaluate(he,xe)),tr=this.paint.get("line-offset").evaluate(he,xe);return tr&&(Te=Ld(Te,tr*ft)),No(pt,Te,Ft)},C.prototype.isTileClipped=function(){return!0},C}(bs);function fv(E,C){return C>0?C+2*E:E}function Ld(E,C){for(var B=[],J=new c(0,0),he=0;he<E.length;he++){for(var xe=E[he],Te=[],Fe=0;Fe<xe.length;Fe++){var qe=xe[Fe-1],ft=xe[Fe],pt=xe[Fe+1],Ft=Fe===0?J:ft.sub(qe)._unit()._perp(),tr=Fe===xe.length-1?J:pt.sub(ft)._unit()._perp(),Qt=Ft._add(tr)._unit(),dr=Qt.x*tr.x+Qt.y*tr.y;Qt._mult(1/dr),Te.push(Qt._mult(C)._add(ft))}B.push(Te)}return B}var Ah=Io([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Pd=Io([{name:"a_projected_pos",components:3,type:"Float32"}],4);Io([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var Dd=Io([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Io([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var cv=Io([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Rd=Io([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Io([{name:"triangle",components:3,type:"Uint16"}]),Io([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Io([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Io([{type:"Float32",name:"offsetX"}]),Io([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function Id(E,C,B){var J=C.layout.get("text-transform").evaluate(B,{});return J==="uppercase"?E=E.toLocaleUpperCase():J==="lowercase"&&(E=E.toLocaleLowerCase()),Xa.applyArabicShaping&&(E=Xa.applyArabicShaping(E)),E}function zd(E,C,B){return E.sections.forEach(function(J){J.text=Id(J.text,C,B)}),E}function Fd(E){var C={},B={},J=[],he=0;function xe($r){J.push(E[$r]),he++}function Te($r,kn,mn){var Sn=B[$r];return delete B[$r],B[kn]=Sn,J[Sn].geometry[0].pop(),J[Sn].geometry[0]=J[Sn].geometry[0].concat(mn[0]),Sn}function Fe($r,kn,mn){var Sn=C[kn];return delete C[kn],C[$r]=Sn,J[Sn].geometry[0].shift(),J[Sn].geometry[0]=mn[0].concat(J[Sn].geometry[0]),Sn}function qe($r,kn,mn){var Sn=mn?kn[0][kn[0].length-1]:kn[0][0];return $r+":"+Sn.x+":"+Sn.y}for(var ft=0;ft<E.length;ft++){var pt=E[ft],Ft=pt.geometry,tr=pt.text?pt.text.toString():null;if(!tr){xe(ft);continue}var Qt=qe(tr,Ft),dr=qe(tr,Ft,!0);if(Qt in B&&dr in C&&B[Qt]!==C[dr]){var Fr=Fe(Qt,dr,Ft),on=Te(Qt,dr,J[Fr].geometry);delete C[Qt],delete B[dr],B[qe(tr,J[on].geometry,!0)]=on,J[Fr].geometry=null}else Qt in B?Te(Qt,dr,Ft):dr in C?Fe(Qt,dr,Ft):(xe(ft),C[Qt]=he-1,B[dr]=he-1)}return J.filter(function($r){return $r.geometry})}var mc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function Od(E){for(var C="",B=0;B<E.length;B++){var J=E.charCodeAt(B+1)||null,he=E.charCodeAt(B-1)||null,xe=(!J||!an(J)||mc[E[B+1]])&&(!he||!an(he)||mc[E[B-1]]);xe&&mc[E[B]]?C+=mc[E[B]]:C+=E[B]}return C}var vs=24,Bd=function(E,C,B,J,he){var xe,Te,Fe=he*8-J-1,qe=(1<<Fe)-1,ft=qe>>1,pt=-7,Ft=B?he-1:0,tr=B?-1:1,Qt=E[C+Ft];for(Ft+=tr,xe=Qt&(1<<-pt)-1,Qt>>=-pt,pt+=Fe;pt>0;xe=xe*256+E[C+Ft],Ft+=tr,pt-=8);for(Te=xe&(1<<-pt)-1,xe>>=-pt,pt+=J;pt>0;Te=Te*256+E[C+Ft],Ft+=tr,pt-=8);if(xe===0)xe=1-ft;else{if(xe===qe)return Te?NaN:(Qt?-1:1)*(1/0);Te=Te+Math.pow(2,J),xe=xe-ft}return(Qt?-1:1)*Te*Math.pow(2,xe-J)},Nd=function(E,C,B,J,he,xe){var Te,Fe,qe,ft=xe*8-he-1,pt=(1<<ft)-1,Ft=pt>>1,tr=he===23?Math.pow(2,-24)-Math.pow(2,-77):0,Qt=J?0:xe-1,dr=J?1:-1,Fr=C<0||C===0&&1/C<0?1:0;for(C=Math.abs(C),isNaN(C)||C===1/0?(Fe=isNaN(C)?1:0,Te=pt):(Te=Math.floor(Math.log(C)/Math.LN2),C*(qe=Math.pow(2,-Te))<1&&(Te--,qe*=2),Te+Ft>=1?C+=tr/qe:C+=tr*Math.pow(2,1-Ft),C*qe>=2&&(Te++,qe/=2),Te+Ft>=pt?(Fe=0,Te=pt):Te+Ft>=1?(Fe=(C*qe-1)*Math.pow(2,he),Te=Te+Ft):(Fe=C*Math.pow(2,Ft-1)*Math.pow(2,he),Te=0));he>=8;E[B+Qt]=Fe&255,Qt+=dr,Fe/=256,he-=8);for(Te=Te<<he|Fe,ft+=he;ft>0;E[B+Qt]=Te&255,Qt+=dr,Te/=256,ft-=8);E[B+Qt-dr]|=Fr*128},Nc={read:Bd,write:Nd},Uc=no;function no(E){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(E)?E:new Uint8Array(E||0),this.pos=0,this.type=0,this.length=this.buf.length}no.Varint=0,no.Fixed64=1,no.Bytes=2,no.Fixed32=5;var Mh=(1<<16)*(1<<16),hv=1/Mh,Ud=12,vv=typeof TextDecoder>"u"?null:new TextDecoder("utf8");no.prototype={destroy:function(){this.buf=null},readFields:function(E,C,B){for(B=B||this.length;this.pos<B;){var J=this.readVarint(),he=J>>3,xe=this.pos;this.type=J&7,E(he,C,this),this.pos===xe&&this.skip(J)}return C},readMessage:function(E,C){return this.readFields(E,C,this.readVarint()+this.pos)},readFixed32:function(){var E=Vc(this.buf,this.pos);return this.pos+=4,E},readSFixed32:function(){var E=dv(this.buf,this.pos);return this.pos+=4,E},readFixed64:function(){var E=Vc(this.buf,this.pos)+Vc(this.buf,this.pos+4)*Mh;return this.pos+=8,E},readSFixed64:function(){var E=Vc(this.buf,this.pos)+dv(this.buf,this.pos+4)*Mh;return this.pos+=8,E},readFloat:function(){var E=Nc.read(this.buf,this.pos,!0,23,4);return this.pos+=4,E},readDouble:function(){var E=Nc.read(this.buf,this.pos,!0,52,8);return this.pos+=8,E},readVarint:function(E){var C=this.buf,B,J;return J=C[this.pos++],B=J&127,J<128||(J=C[this.pos++],B|=(J&127)<<7,J<128)||(J=C[this.pos++],B|=(J&127)<<14,J<128)||(J=C[this.pos++],B|=(J&127)<<21,J<128)?B:(J=C[this.pos],B|=(J&15)<<28,Vd(B,E,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var E=this.readVarint();return E%2===1?(E+1)/-2:E/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var E=this.readVarint()+this.pos,C=this.pos;return this.pos=E,E-C>=Ud&&vv?t0(this.buf,C,E):e0(this.buf,C,E)},readBytes:function(){var E=this.readVarint()+this.pos,C=this.buf.subarray(this.pos,E);return this.pos=E,C},readPackedVarint:function(E,C){if(this.type!==no.Bytes)return E.push(this.readVarint(C));var B=ju(this);for(E=E||[];this.pos<B;)E.push(this.readVarint(C));return E},readPackedSVarint:function(E){if(this.type!==no.Bytes)return E.push(this.readSVarint());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readSVarint());return E},readPackedBoolean:function(E){if(this.type!==no.Bytes)return E.push(this.readBoolean());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readBoolean());return E},readPackedFloat:function(E){if(this.type!==no.Bytes)return E.push(this.readFloat());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readFloat());return E},readPackedDouble:function(E){if(this.type!==no.Bytes)return E.push(this.readDouble());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readDouble());return E},readPackedFixed32:function(E){if(this.type!==no.Bytes)return E.push(this.readFixed32());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readFixed32());return E},readPackedSFixed32:function(E){if(this.type!==no.Bytes)return E.push(this.readSFixed32());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readSFixed32());return E},readPackedFixed64:function(E){if(this.type!==no.Bytes)return E.push(this.readFixed64());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readFixed64());return E},readPackedSFixed64:function(E){if(this.type!==no.Bytes)return E.push(this.readSFixed64());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readSFixed64());return E},skip:function(E){var C=E&7;if(C===no.Varint)for(;this.buf[this.pos++]>127;);else if(C===no.Bytes)this.pos=this.readVarint()+this.pos;else if(C===no.Fixed32)this.pos+=4;else if(C===no.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+C)},writeTag:function(E,C){this.writeVarint(E<<3|C)},realloc:function(E){for(var C=this.length||16;C<this.pos+E;)C*=2;if(C!==this.length){var B=new Uint8Array(C);B.set(this.buf),this.buf=B,this.length=C}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(E){this.realloc(4),Gf(this.buf,E,this.pos),this.pos+=4},writeSFixed32:function(E){this.realloc(4),Gf(this.buf,E,this.pos),this.pos+=4},writeFixed64:function(E){this.realloc(8),Gf(this.buf,E&-1,this.pos),Gf(this.buf,Math.floor(E*hv),this.pos+4),this.pos+=8},writeSFixed64:function(E){this.realloc(8),Gf(this.buf,E&-1,this.pos),Gf(this.buf,Math.floor(E*hv),this.pos+4),this.pos+=8},writeVarint:function(E){if(E=+E||0,E>268435455||E<0){Hd(E,this);return}this.realloc(4),this.buf[this.pos++]=E&127|(E>127?128:0),!(E<=127)&&(this.buf[this.pos++]=(E>>>=7)&127|(E>127?128:0),!(E<=127)&&(this.buf[this.pos++]=(E>>>=7)&127|(E>127?128:0),!(E<=127)&&(this.buf[this.pos++]=E>>>7&127)))},writeSVarint:function(E){this.writeVarint(E<0?-E*2-1:E*2)},writeBoolean:function(E){this.writeVarint(Boolean(E))},writeString:function(E){E=String(E),this.realloc(E.length*4),this.pos++;var C=this.pos;this.pos=r0(this.buf,E,this.pos);var B=this.pos-C;B>=128&&pv(C,B,this),this.pos=C-1,this.writeVarint(B),this.pos+=B},writeFloat:function(E){this.realloc(4),Nc.write(this.buf,E,this.pos,!0,23,4),this.pos+=4},writeDouble:function(E){this.realloc(8),Nc.write(this.buf,E,this.pos,!0,52,8),this.pos+=8},writeBytes:function(E){var C=E.length;this.writeVarint(C),this.realloc(C);for(var B=0;B<C;B++)this.buf[this.pos++]=E[B]},writeRawMessage:function(E,C){this.pos++;var B=this.pos;E(C,this);var J=this.pos-B;J>=128&&pv(B,J,this),this.pos=B-1,this.writeVarint(J),this.pos+=J},writeMessage:function(E,C,B){this.writeTag(E,no.Bytes),this.writeRawMessage(C,B)},writePackedVarint:function(E,C){C.length&&this.writeMessage(E,Wd,C)},writePackedSVarint:function(E,C){C.length&&this.writeMessage(E,Xd,C)},writePackedBoolean:function(E,C){C.length&&this.writeMessage(E,Kd,C)},writePackedFloat:function(E,C){C.length&&this.writeMessage(E,Zd,C)},writePackedDouble:function(E,C){C.length&&this.writeMessage(E,jd,C)},writePackedFixed32:function(E,C){C.length&&this.writeMessage(E,Jd,C)},writePackedSFixed32:function(E,C){C.length&&this.writeMessage(E,Qd,C)},writePackedFixed64:function(E,C){C.length&&this.writeMessage(E,$d,C)},writePackedSFixed64:function(E,C){C.length&&this.writeMessage(E,qd,C)},writeBytesField:function(E,C){this.writeTag(E,no.Bytes),this.writeBytes(C)},writeFixed32Field:function(E,C){this.writeTag(E,no.Fixed32),this.writeFixed32(C)},writeSFixed32Field:function(E,C){this.writeTag(E,no.Fixed32),this.writeSFixed32(C)},writeFixed64Field:function(E,C){this.writeTag(E,no.Fixed64),this.writeFixed64(C)},writeSFixed64Field:function(E,C){this.writeTag(E,no.Fixed64),this.writeSFixed64(C)},writeVarintField:function(E,C){this.writeTag(E,no.Varint),this.writeVarint(C)},writeSVarintField:function(E,C){this.writeTag(E,no.Varint),this.writeSVarint(C)},writeStringField:function(E,C){this.writeTag(E,no.Bytes),this.writeString(C)},writeFloatField:function(E,C){this.writeTag(E,no.Fixed32),this.writeFloat(C)},writeDoubleField:function(E,C){this.writeTag(E,no.Fixed64),this.writeDouble(C)},writeBooleanField:function(E,C){this.writeVarintField(E,Boolean(C))}};function Vd(E,C,B){var J=B.buf,he,xe;if(xe=J[B.pos++],he=(xe&112)>>4,xe<128||(xe=J[B.pos++],he|=(xe&127)<<3,xe<128)||(xe=J[B.pos++],he|=(xe&127)<<10,xe<128)||(xe=J[B.pos++],he|=(xe&127)<<17,xe<128)||(xe=J[B.pos++],he|=(xe&127)<<24,xe<128)||(xe=J[B.pos++],he|=(xe&1)<<31,xe<128))return Hf(E,he,C);throw new Error("Expected varint not more than 10 bytes")}function ju(E){return E.type===no.Bytes?E.readVarint()+E.pos:E.pos+1}function Hf(E,C,B){return B?C*4294967296+(E>>>0):(C>>>0)*4294967296+(E>>>0)}function Hd(E,C){var B,J;if(E>=0?(B=E%4294967296|0,J=E/4294967296|0):(B=~(-E%4294967296),J=~(-E/4294967296),B^4294967295?B=B+1|0:(B=0,J=J+1|0)),E>=18446744073709552e3||E<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");C.realloc(10),Gd(B,J,C),Yd(J,C)}function Gd(E,C,B){B.buf[B.pos++]=E&127|128,E>>>=7,B.buf[B.pos++]=E&127|128,E>>>=7,B.buf[B.pos++]=E&127|128,E>>>=7,B.buf[B.pos++]=E&127|128,E>>>=7,B.buf[B.pos]=E&127}function Yd(E,C){var B=(E&7)<<4;C.buf[C.pos++]|=B|((E>>>=3)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127)))))}function pv(E,C,B){var J=C<=16383?1:C<=2097151?2:C<=268435455?3:Math.floor(Math.log(C)/(Math.LN2*7));B.realloc(J);for(var he=B.pos-1;he>=E;he--)B.buf[he+J]=B.buf[he]}function Wd(E,C){for(var B=0;B<E.length;B++)C.writeVarint(E[B])}function Xd(E,C){for(var B=0;B<E.length;B++)C.writeSVarint(E[B])}function Zd(E,C){for(var B=0;B<E.length;B++)C.writeFloat(E[B])}function jd(E,C){for(var B=0;B<E.length;B++)C.writeDouble(E[B])}function Kd(E,C){for(var B=0;B<E.length;B++)C.writeBoolean(E[B])}function Jd(E,C){for(var B=0;B<E.length;B++)C.writeFixed32(E[B])}function Qd(E,C){for(var B=0;B<E.length;B++)C.writeSFixed32(E[B])}function $d(E,C){for(var B=0;B<E.length;B++)C.writeFixed64(E[B])}function qd(E,C){for(var B=0;B<E.length;B++)C.writeSFixed64(E[B])}function Vc(E,C){return(E[C]|E[C+1]<<8|E[C+2]<<16)+E[C+3]*16777216}function Gf(E,C,B){E[B]=C,E[B+1]=C>>>8,E[B+2]=C>>>16,E[B+3]=C>>>24}function dv(E,C){return(E[C]|E[C+1]<<8|E[C+2]<<16)+(E[C+3]<<24)}function e0(E,C,B){for(var J="",he=C;he<B;){var xe=E[he],Te=null,Fe=xe>239?4:xe>223?3:xe>191?2:1;if(he+Fe>B)break;var qe,ft,pt;Fe===1?xe<128&&(Te=xe):Fe===2?(qe=E[he+1],(qe&192)===128&&(Te=(xe&31)<<6|qe&63,Te<=127&&(Te=null))):Fe===3?(qe=E[he+1],ft=E[he+2],(qe&192)===128&&(ft&192)===128&&(Te=(xe&15)<<12|(qe&63)<<6|ft&63,(Te<=2047||Te>=55296&&Te<=57343)&&(Te=null))):Fe===4&&(qe=E[he+1],ft=E[he+2],pt=E[he+3],(qe&192)===128&&(ft&192)===128&&(pt&192)===128&&(Te=(xe&15)<<18|(qe&63)<<12|(ft&63)<<6|pt&63,(Te<=65535||Te>=1114112)&&(Te=null))),Te===null?(Te=65533,Fe=1):Te>65535&&(Te-=65536,J+=String.fromCharCode(Te>>>10&1023|55296),Te=56320|Te&1023),J+=String.fromCharCode(Te),he+=Fe}return J}function t0(E,C,B){return vv.decode(E.subarray(C,B))}function r0(E,C,B){for(var J=0,he,xe;J<C.length;J++){if(he=C.charCodeAt(J),he>55295&&he<57344)if(xe)if(he<56320){E[B++]=239,E[B++]=191,E[B++]=189,xe=he;continue}else he=xe-55296<<10|he-56320|65536,xe=null;else{he>56319||J+1===C.length?(E[B++]=239,E[B++]=191,E[B++]=189):xe=he;continue}else xe&&(E[B++]=239,E[B++]=191,E[B++]=189,xe=null);he<128?E[B++]=he:(he<2048?E[B++]=he>>6|192:(he<65536?E[B++]=he>>12|224:(E[B++]=he>>18|240,E[B++]=he>>12&63|128),E[B++]=he>>6&63|128),E[B++]=he&63|128)}return B}var Sh=3;function n0(E,C,B){E===1&&B.readMessage(a0,C)}function a0(E,C,B){if(E===3){var J=B.readMessage(i0,{}),he=J.id,xe=J.bitmap,Te=J.width,Fe=J.height,qe=J.left,ft=J.top,pt=J.advance;C.push({id:he,bitmap:new Af({width:Te+2*Sh,height:Fe+2*Sh},xe),metrics:{width:Te,height:Fe,left:qe,top:ft,advance:pt}})}}function i0(E,C,B){E===1?C.id=B.readVarint():E===2?C.bitmap=B.readBytes():E===3?C.width=B.readVarint():E===4?C.height=B.readVarint():E===5?C.left=B.readSVarint():E===6?C.top=B.readSVarint():E===7&&(C.advance=B.readVarint())}function o0(E){return new Uc(E).readFields(n0,[])}var gv=Sh;function yv(E){for(var C=0,B=0,J=0,he=E;J<he.length;J+=1){var xe=he[J];C+=xe.w*xe.h,B=Math.max(B,xe.w)}E.sort(function(on,$r){return $r.h-on.h});for(var Te=Math.max(Math.ceil(Math.sqrt(C/.95)),B),Fe=[{x:0,y:0,w:Te,h:1/0}],qe=0,ft=0,pt=0,Ft=E;pt<Ft.length;pt+=1)for(var tr=Ft[pt],Qt=Fe.length-1;Qt>=0;Qt--){var dr=Fe[Qt];if(!(tr.w>dr.w||tr.h>dr.h)){if(tr.x=dr.x,tr.y=dr.y,ft=Math.max(ft,tr.y+tr.h),qe=Math.max(qe,tr.x+tr.w),tr.w===dr.w&&tr.h===dr.h){var Fr=Fe.pop();Qt<Fe.length&&(Fe[Qt]=Fr)}else tr.h===dr.h?(dr.x+=tr.w,dr.w-=tr.w):tr.w===dr.w?(dr.y+=tr.h,dr.h-=tr.h):(Fe.push({x:dr.x+tr.w,y:dr.y,w:dr.w-tr.w,h:tr.h}),dr.y+=tr.h,dr.h-=tr.h);break}}return{w:qe,h:ft,fill:C/(qe*ft)||0}}var hl=1,Hc=function(C,B){var J=B.pixelRatio,he=B.version,xe=B.stretchX,Te=B.stretchY,Fe=B.content;this.paddedRect=C,this.pixelRatio=J,this.stretchX=xe,this.stretchY=Te,this.content=Fe,this.version=he},xc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};xc.tl.get=function(){return[this.paddedRect.x+hl,this.paddedRect.y+hl]},xc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-hl,this.paddedRect.y+this.paddedRect.h-hl]},xc.tlbr.get=function(){return this.tl.concat(this.br)},xc.displaySize.get=function(){return[(this.paddedRect.w-hl*2)/this.pixelRatio,(this.paddedRect.h-hl*2)/this.pixelRatio]},Object.defineProperties(Hc.prototype,xc);var bc=function(C,B){var J={},he={};this.haveRenderCallbacks=[];var xe=[];this.addImages(C,J,xe),this.addImages(B,he,xe);var Te=yv(xe),Fe=Te.w,qe=Te.h,ft=new tl({width:Fe||1,height:qe||1});for(var pt in C){var Ft=C[pt],tr=J[pt].paddedRect;tl.copy(Ft.data,ft,{x:0,y:0},{x:tr.x+hl,y:tr.y+hl},Ft.data)}for(var Qt in B){var dr=B[Qt],Fr=he[Qt].paddedRect,on=Fr.x+hl,$r=Fr.y+hl,kn=dr.data.width,mn=dr.data.height;tl.copy(dr.data,ft,{x:0,y:0},{x:on,y:$r},dr.data),tl.copy(dr.data,ft,{x:0,y:mn-1},{x:on,y:$r-1},{width:kn,height:1}),tl.copy(dr.data,ft,{x:0,y:0},{x:on,y:$r+mn},{width:kn,height:1}),tl.copy(dr.data,ft,{x:kn-1,y:0},{x:on-1,y:$r},{width:1,height:mn}),tl.copy(dr.data,ft,{x:0,y:0},{x:on+kn,y:$r},{width:1,height:mn})}this.image=ft,this.iconPositions=J,this.patternPositions=he};bc.prototype.addImages=function(C,B,J){for(var he in C){var xe=C[he],Te={x:0,y:0,w:xe.data.width+2*hl,h:xe.data.height+2*hl};J.push(Te),B[he]=new Hc(Te,xe),xe.hasRenderCallback&&this.haveRenderCallbacks.push(he)}},bc.prototype.patchUpdatedImages=function(C,B){C.dispatchRenderCallbacks(this.haveRenderCallbacks);for(var J in C.updatedImages)this.patchUpdatedImage(this.iconPositions[J],C.getImage(J),B),this.patchUpdatedImage(this.patternPositions[J],C.getImage(J),B)},bc.prototype.patchUpdatedImage=function(C,B,J){if(!(!C||!B)&&C.version!==B.version){C.version=B.version;var he=C.tl,xe=he[0],Te=he[1];J.update(B.data,void 0,{x:xe,y:Te})}},Oe("ImagePosition",Hc),Oe("ImageAtlas",bc);var El={horizontal:1,vertical:2,horizontalOnly:3},_c=-17;function s0(E){for(var C=0,B=E;C<B.length;C+=1){var J=B[C];if(J.positionedGlyphs.length!==0)return!1}return!0}var mv=57344,xv=63743,Yf=function(){this.scale=1,this.fontStack="",this.imageName=null};Yf.forText=function(C,B){var J=new Yf;return J.scale=C||1,J.fontStack=B,J},Yf.forImage=function(C){var B=new Yf;return B.imageName=C,B};var Ls=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};Ls.fromFeature=function(C,B){for(var J=new Ls,he=0;he<C.sections.length;he++){var xe=C.sections[he];xe.image?J.addImageSection(xe):J.addTextSection(xe,B)}return J},Ls.prototype.length=function(){return this.text.length},Ls.prototype.getSection=function(C){return this.sections[this.sectionIndex[C]]},Ls.prototype.getSectionIndex=function(C){return this.sectionIndex[C]},Ls.prototype.getCharCode=function(C){return this.text.charCodeAt(C)},Ls.prototype.verticalizePunctuation=function(){this.text=Od(this.text)},Ls.prototype.trim=function(){for(var C=0,B=0;B<this.text.length&&Gu[this.text.charCodeAt(B)];B++)C++;for(var J=this.text.length,he=this.text.length-1;he>=0&&he>=C&&Gu[this.text.charCodeAt(he)];he--)J--;this.text=this.text.substring(C,J),this.sectionIndex=this.sectionIndex.slice(C,J)},Ls.prototype.substring=function(C,B){var J=new Ls;return J.text=this.text.substring(C,B),J.sectionIndex=this.sectionIndex.slice(C,B),J.sections=this.sections,J},Ls.prototype.toString=function(){return this.text},Ls.prototype.getMaxScale=function(){var C=this;return this.sectionIndex.reduce(function(B,J){return Math.max(B,C.sections[J].scale)},0)},Ls.prototype.addTextSection=function(C,B){this.text+=C.text,this.sections.push(Yf.forText(C.scale,C.fontStack||B));for(var J=this.sections.length-1,he=0;he<C.text.length;++he)this.sectionIndex.push(J)},Ls.prototype.addImageSection=function(C){var B=C.image?C.image.name:"";if(B.length===0){O("Can't add FormattedSection with an empty image.");return}var J=this.getNextImageSectionCharCode();if(!J){O("Reached maximum number of images "+(xv-mv+2));return}this.text+=String.fromCharCode(J),this.sections.push(Yf.forImage(B)),this.sectionIndex.push(this.sections.length-1)},Ls.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=xv?null:++this.imageSectionID:(this.imageSectionID=mv,this.imageSectionID)};function l0(E,C){for(var B=[],J=E.text,he=0,xe=0,Te=C;xe<Te.length;xe+=1){var Fe=Te[xe];B.push(E.substring(he,Fe)),he=Fe}return he<J.length&&B.push(E.substring(he,J.length)),B}function Gc(E,C,B,J,he,xe,Te,Fe,qe,ft,pt,Ft,tr,Qt,dr,Fr){var on=Ls.fromFeature(E,he);Ft===El.vertical&&on.verticalizePunctuation();var $r,kn=Xa.processBidirectionalText,mn=Xa.processStyledBidirectionalText;if(kn&&on.sections.length===1){$r=[];for(var Sn=kn(on.toString(),kh(on,ft,xe,C,J,Qt,dr)),In=0,Gn=Sn;In<Gn.length;In+=1){var oa=Gn[In],na=new Ls;na.text=oa,na.sections=on.sections;for(var Ra=0;Ra<oa.length;Ra++)na.sectionIndex.push(0);$r.push(na)}}else if(mn){$r=[];for(var wa=mn(on.text,on.sectionIndex,kh(on,ft,xe,C,J,Qt,dr)),Sa=0,ti=wa;Sa<ti.length;Sa+=1){var La=ti[Sa],Da=new Ls;Da.text=La[0],Da.sectionIndex=La[1],Da.sections=on.sections,$r.push(Da)}}else $r=l0(on,kh(on,ft,xe,C,J,Qt,dr));var fi=[],qa={positionedLines:fi,text:on.toString(),top:pt[1],bottom:pt[1],left:pt[0],right:pt[0],writingMode:Ft,iconsInText:!1,verticalizable:!1};return c0(qa,C,B,J,$r,Te,Fe,qe,Ft,ft,tr,Fr),s0(fi)?!1:qa}var Gu={};Gu[9]=!0,Gu[10]=!0,Gu[11]=!0,Gu[12]=!0,Gu[13]=!0,Gu[32]=!0;var vl={};vl[10]=!0,vl[32]=!0,vl[38]=!0,vl[40]=!0,vl[41]=!0,vl[43]=!0,vl[45]=!0,vl[47]=!0,vl[173]=!0,vl[183]=!0,vl[8203]=!0,vl[8208]=!0,vl[8211]=!0,vl[8231]=!0;function bv(E,C,B,J,he,xe){if(C.imageName){var qe=J[C.imageName];return qe?qe.displaySize[0]*C.scale*vs/xe+he:0}else{var Te=B[C.fontStack],Fe=Te&&Te[E];return Fe?Fe.metrics.advance*C.scale+he:0}}function u0(E,C,B,J,he,xe){for(var Te=0,Fe=0;Fe<E.length();Fe++){var qe=E.getSection(Fe);Te+=bv(E.getCharCode(Fe),qe,J,he,C,xe)}var ft=Math.max(1,Math.ceil(Te/B));return Te/ft}function _v(E,C,B,J){var he=Math.pow(E-C,2);return J?E<C?he/2:he*2:he+Math.abs(B)*B}function f0(E,C,B){var J=0;return E===10&&(J-=1e4),B&&(J+=150),(E===40||E===65288)&&(J+=50),(C===41||C===65289)&&(J+=50),J}function wv(E,C,B,J,he,xe){for(var Te=null,Fe=_v(C,B,he,xe),qe=0,ft=J;qe<ft.length;qe+=1){var pt=ft[qe],Ft=C-pt.x,tr=_v(Ft,B,he,xe)+pt.badness;tr<=Fe&&(Te=pt,Fe=tr)}return{index:E,x:C,priorBreak:Te,badness:Fe}}function Tv(E){return E?Tv(E.priorBreak).concat(E.index):[]}function kh(E,C,B,J,he,xe,Te){if(xe!=="point")return[];if(!E)return[];for(var Fe=[],qe=u0(E,C,B,J,he,Te),ft=E.text.indexOf("\u200B")>=0,pt=0,Ft=0;Ft<E.length();Ft++){var tr=E.getSection(Ft),Qt=E.getCharCode(Ft);if(Gu[Qt]||(pt+=bv(Qt,tr,J,he,C,Te)),Ft<E.length()-1){var dr=Lr(Qt);(vl[Qt]||dr||tr.imageName)&&Fe.push(wv(Ft+1,pt,qe,Fe,f0(Qt,E.getCharCode(Ft+1),dr&&ft),!1))}}return Tv(wv(E.length(),pt,qe,Fe,0,!0))}function Eh(E){var C=.5,B=.5;switch(E){case"right":case"top-right":case"bottom-right":C=1;break;case"left":case"top-left":case"bottom-left":C=0;break}switch(E){case"bottom":case"bottom-right":case"bottom-left":B=1;break;case"top":case"top-right":case"top-left":B=0;break}return{horizontalAlign:C,verticalAlign:B}}function c0(E,C,B,J,he,xe,Te,Fe,qe,ft,pt,Ft){for(var tr=0,Qt=_c,dr=0,Fr=0,on=Fe==="right"?1:Fe==="left"?0:.5,$r=0,kn=0,mn=he;kn<mn.length;kn+=1){var Sn=mn[kn];Sn.trim();var In=Sn.getMaxScale(),Gn=(In-1)*vs,oa={positionedGlyphs:[],lineOffset:0};E.positionedLines[$r]=oa;var na=oa.positionedGlyphs,Ra=0;if(!Sn.length()){Qt+=xe,++$r;continue}for(var wa=0;wa<Sn.length();wa++){var Sa=Sn.getSection(wa),ti=Sn.getSectionIndex(wa),La=Sn.getCharCode(wa),Da=0,fi=null,qa=null,ki=null,Zi=vs,Ei=!(qe===El.horizontal||!pt&&!Nr(La)||pt&&(Gu[La]||sn(La)));if(Sa.imageName){var Ao=J[Sa.imageName];if(!Ao)continue;ki=Sa.imageName,E.iconsInText=E.iconsInText||!0,qa=Ao.paddedRect;var Po=Ao.displaySize;Sa.scale=Sa.scale*vs/Ft,fi={width:Po[0],height:Po[1],left:hl,top:-gv,advance:Ei?Po[1]:Po[0]};var es=vs-Po[1]*Sa.scale;Da=Gn+es,Zi=fi.advance;var Go=Ei?Po[0]*Sa.scale-vs*In:Po[1]*Sa.scale-vs*In;Go>0&&Go>Ra&&(Ra=Go)}else{var Ci=B[Sa.fontStack],Ti=Ci&&Ci[La];if(Ti&&Ti.rect)qa=Ti.rect,fi=Ti.metrics;else{var eo=C[Sa.fontStack],ao=eo&&eo[La];if(!ao)continue;fi=ao.metrics}Da=(In-Sa.scale)*vs}Ei?(E.verticalizable=!0,na.push({glyph:La,imageName:ki,x:tr,y:Qt+Da,vertical:Ei,scale:Sa.scale,fontStack:Sa.fontStack,sectionIndex:ti,metrics:fi,rect:qa}),tr+=Zi*Sa.scale+ft):(na.push({glyph:La,imageName:ki,x:tr,y:Qt+Da,vertical:Ei,scale:Sa.scale,fontStack:Sa.fontStack,sectionIndex:ti,metrics:fi,rect:qa}),tr+=fi.advance*Sa.scale+ft)}if(na.length!==0){var Ps=tr-ft;dr=Math.max(Ps,dr),h0(na,0,na.length-1,on,Ra)}tr=0;var Ds=xe*In+Ra;oa.lineOffset=Math.max(Ra,Gn),Qt+=Ds,Fr=Math.max(Ds,Fr),++$r}var ts=Qt-_c,Us=Eh(Te),Vs=Us.horizontalAlign,jo=Us.verticalAlign;v0(E.positionedLines,on,Vs,jo,dr,Fr,xe,ts,he.length),E.top+=-jo*ts,E.bottom=E.top+ts,E.left+=-Vs*dr,E.right=E.left+dr}function h0(E,C,B,J,he){if(!(!J&&!he))for(var xe=E[B],Te=xe.metrics.advance*xe.scale,Fe=(E[B].x+Te)*J,qe=C;qe<=B;qe++)E[qe].x-=Fe,E[qe].y+=he}function v0(E,C,B,J,he,xe,Te,Fe,qe){var ft=(C-B)*he,pt=0;xe!==Te?pt=-Fe*J-_c:pt=(-J*qe+.5)*Te;for(var Ft=0,tr=E;Ft<tr.length;Ft+=1)for(var Qt=tr[Ft],dr=0,Fr=Qt.positionedGlyphs;dr<Fr.length;dr+=1){var on=Fr[dr];on.x+=ft,on.y+=pt}}function p0(E,C,B){var J=Eh(B),he=J.horizontalAlign,xe=J.verticalAlign,Te=C[0],Fe=C[1],qe=Te-E.displaySize[0]*he,ft=qe+E.displaySize[0],pt=Fe-E.displaySize[1]*xe,Ft=pt+E.displaySize[1];return{image:E,top:pt,bottom:Ft,left:qe,right:ft}}function Av(E,C,B,J,he,xe){var Te=E.image,Fe;if(Te.content){var qe=Te.content,ft=Te.pixelRatio||1;Fe=[qe[0]/ft,qe[1]/ft,Te.displaySize[0]-qe[2]/ft,Te.displaySize[1]-qe[3]/ft]}var pt=C.left*xe,Ft=C.right*xe,tr,Qt,dr,Fr;B==="width"||B==="both"?(Fr=he[0]+pt-J[3],Qt=he[0]+Ft+J[1]):(Fr=he[0]+(pt+Ft-Te.displaySize[0])/2,Qt=Fr+Te.displaySize[0]);var on=C.top*xe,$r=C.bottom*xe;return B==="height"||B==="both"?(tr=he[1]+on-J[0],dr=he[1]+$r+J[2]):(tr=he[1]+(on+$r-Te.displaySize[1])/2,dr=tr+Te.displaySize[1]),{image:Te,top:tr,right:Qt,bottom:dr,left:Fr,collisionPadding:Fe}}var Wf=function(E){function C(B,J,he,xe){E.call(this,B,J),this.angle=he,xe!==void 0&&(this.segment=xe)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.clone=function(){return new C(this.x,this.y,this.angle,this.segment)},C}(c);Oe("Anchor",Wf);var Au=128;function Ch(E,C){var B=C.expression;if(B.kind==="constant"){var J=B.evaluate(new si(E+1));return{kind:"constant",layoutSize:J}}else{if(B.kind==="source")return{kind:"source"};for(var he=B.zoomStops,xe=B.interpolationType,Te=0;Te<he.length&&he[Te]<=E;)Te++;Te=Math.max(0,Te-1);for(var Fe=Te;Fe<he.length&&he[Fe]<E+1;)Fe++;Fe=Math.min(he.length-1,Fe);var qe=he[Te],ft=he[Fe];if(B.kind==="composite")return{kind:"composite",minZoom:qe,maxZoom:ft,interpolationType:xe};var pt=B.evaluate(new si(qe)),Ft=B.evaluate(new si(ft));return{kind:"camera",minZoom:qe,maxZoom:ft,minSize:pt,maxSize:Ft,interpolationType:xe}}}function Mv(E,C,B){var J=C.uSize,he=C.uSizeT,xe=B.lowerSize,Te=B.upperSize;return E.kind==="source"?xe/Au:E.kind==="composite"?lo(xe/Au,Te/Au,he):J}function Sv(E,C){var B=0,J=0;if(E.kind==="constant")J=E.layoutSize;else if(E.kind!=="source"){var he=E.interpolationType,xe=E.minZoom,Te=E.maxZoom,Fe=he?f(uo.interpolationFactor(he,C,xe,Te),0,1):0;E.kind==="camera"?J=lo(E.minSize,E.maxSize,Fe):B=Fe}return{uSizeT:B,uSize:J}}var d0=Object.freeze({__proto__:null,getSizeData:Ch,evaluateSizeForFeature:Mv,evaluateSizeForZoom:Sv,SIZE_PACK_FACTOR:Au});function kv(E,C,B,J,he){if(C.segment===void 0)return!0;for(var xe=C,Te=C.segment+1,Fe=0;Fe>-B/2;){if(Te--,Te<0)return!1;Fe-=E[Te].dist(xe),xe=E[Te]}Fe+=E[Te].dist(E[Te+1]),Te++;for(var qe=[],ft=0;Fe<B/2;){var pt=E[Te-1],Ft=E[Te],tr=E[Te+1];if(!tr)return!1;var Qt=pt.angleTo(Ft)-Ft.angleTo(tr);for(Qt=Math.abs((Qt+3*Math.PI)%(Math.PI*2)-Math.PI),qe.push({distance:Fe,angleDelta:Qt}),ft+=Qt;Fe-qe[0].distance>J;)ft-=qe.shift().angleDelta;if(ft>he)return!1;Te++,Fe+=Ft.dist(tr)}return!0}function Ev(E){for(var C=0,B=0;B<E.length-1;B++)C+=E[B].dist(E[B+1]);return C}function Cv(E,C,B){return E?3/5*C*B:0}function Lv(E,C){return Math.max(E?E.right-E.left:0,C?C.right-C.left:0)}function g0(E,C,B,J,he,xe){for(var Te=Cv(B,he,xe),Fe=Lv(B,J)*xe,qe=0,ft=Ev(E)/2,pt=0;pt<E.length-1;pt++){var Ft=E[pt],tr=E[pt+1],Qt=Ft.dist(tr);if(qe+Qt>ft){var dr=(ft-qe)/Qt,Fr=lo(Ft.x,tr.x,dr),on=lo(Ft.y,tr.y,dr),$r=new Wf(Fr,on,tr.angleTo(Ft),pt);return $r._round(),!Te||kv(E,$r,Fe,Te,C)?$r:void 0}qe+=Qt}}function y0(E,C,B,J,he,xe,Te,Fe,qe){var ft=Cv(J,xe,Te),pt=Lv(J,he),Ft=pt*Te,tr=E[0].x===0||E[0].x===qe||E[0].y===0||E[0].y===qe;C-Ft<C/4&&(C=Ft+C/4);var Qt=xe*2,dr=tr?C/2*Fe%C:(pt/2+Qt)*Te*Fe%C;return Pv(E,dr,C,ft,B,Ft,tr,!1,qe)}function Pv(E,C,B,J,he,xe,Te,Fe,qe){for(var ft=xe/2,pt=Ev(E),Ft=0,tr=C-B,Qt=[],dr=0;dr<E.length-1;dr++){for(var Fr=E[dr],on=E[dr+1],$r=Fr.dist(on),kn=on.angleTo(Fr);tr+B<Ft+$r;){tr+=B;var mn=(tr-Ft)/$r,Sn=lo(Fr.x,on.x,mn),In=lo(Fr.y,on.y,mn);if(Sn>=0&&Sn<qe&&In>=0&&In<qe&&tr-ft>=0&&tr+ft<=pt){var Gn=new Wf(Sn,In,kn,dr);Gn._round(),(!J||kv(E,Gn,xe,J,he))&&Qt.push(Gn)}}Ft+=$r}return!Fe&&!Qt.length&&!Te&&(Qt=Pv(E,Ft/2,B,J,he,xe,Te,!0,qe)),Qt}function Dv(E,C,B,J,he){for(var xe=[],Te=0;Te<E.length;Te++)for(var Fe=E[Te],qe=void 0,ft=0;ft<Fe.length-1;ft++){var pt=Fe[ft],Ft=Fe[ft+1];pt.x<C&&Ft.x<C||(pt.x<C?pt=new c(C,pt.y+(Ft.y-pt.y)*((C-pt.x)/(Ft.x-pt.x)))._round():Ft.x<C&&(Ft=new c(C,pt.y+(Ft.y-pt.y)*((C-pt.x)/(Ft.x-pt.x)))._round()),!(pt.y<B&&Ft.y<B)&&(pt.y<B?pt=new c(pt.x+(Ft.x-pt.x)*((B-pt.y)/(Ft.y-pt.y)),B)._round():Ft.y<B&&(Ft=new c(pt.x+(Ft.x-pt.x)*((B-pt.y)/(Ft.y-pt.y)),B)._round()),!(pt.x>=J&&Ft.x>=J)&&(pt.x>=J?pt=new c(J,pt.y+(Ft.y-pt.y)*((J-pt.x)/(Ft.x-pt.x)))._round():Ft.x>=J&&(Ft=new c(J,pt.y+(Ft.y-pt.y)*((J-pt.x)/(Ft.x-pt.x)))._round()),!(pt.y>=he&&Ft.y>=he)&&(pt.y>=he?pt=new c(pt.x+(Ft.x-pt.x)*((he-pt.y)/(Ft.y-pt.y)),he)._round():Ft.y>=he&&(Ft=new c(pt.x+(Ft.x-pt.x)*((he-pt.y)/(Ft.y-pt.y)),he)._round()),(!qe||!pt.equals(qe[qe.length-1]))&&(qe=[pt],xe.push(qe)),qe.push(Ft)))))}return xe}var Xf=hl;function Rv(E,C,B,J){var he=[],xe=E.image,Te=xe.pixelRatio,Fe=xe.paddedRect.w-2*Xf,qe=xe.paddedRect.h-2*Xf,ft=E.right-E.left,pt=E.bottom-E.top,Ft=xe.stretchX||[[0,Fe]],tr=xe.stretchY||[[0,qe]],Qt=function(Ci,Ti){return Ci+Ti[1]-Ti[0]},dr=Ft.reduce(Qt,0),Fr=tr.reduce(Qt,0),on=Fe-dr,$r=qe-Fr,kn=0,mn=dr,Sn=0,In=Fr,Gn=0,oa=on,na=0,Ra=$r;if(xe.content&&J){var wa=xe.content;kn=Yc(Ft,0,wa[0]),Sn=Yc(tr,0,wa[1]),mn=Yc(Ft,wa[0],wa[2]),In=Yc(tr,wa[1],wa[3]),Gn=wa[0]-kn,na=wa[1]-Sn,oa=wa[2]-wa[0]-mn,Ra=wa[3]-wa[1]-In}var Sa=function(Ci,Ti,eo,ao){var Ao=Wc(Ci.stretch-kn,mn,ft,E.left),Po=Xc(Ci.fixed-Gn,oa,Ci.stretch,dr),es=Wc(Ti.stretch-Sn,In,pt,E.top),Go=Xc(Ti.fixed-na,Ra,Ti.stretch,Fr),Ps=Wc(eo.stretch-kn,mn,ft,E.left),Ds=Xc(eo.fixed-Gn,oa,eo.stretch,dr),ts=Wc(ao.stretch-Sn,In,pt,E.top),Us=Xc(ao.fixed-na,Ra,ao.stretch,Fr),Vs=new c(Ao,es),jo=new c(Ps,es),Hs=new c(Ps,ts),Cl=new c(Ao,ts),Qu=new c(Po/Te,Go/Te),vf=new c(Ds/Te,Us/Te),pf=C*Math.PI/180;if(pf){var df=Math.sin(pf),ec=Math.cos(pf),nu=[ec,-df,df,ec];Vs._matMult(nu),jo._matMult(nu),Cl._matMult(nu),Hs._matMult(nu)}var $c=Ci.stretch+Ci.fixed,Oh=eo.stretch+eo.fixed,qc=Ti.stretch+Ti.fixed,Bh=ao.stretch+ao.fixed,Gl={x:xe.paddedRect.x+Xf+$c,y:xe.paddedRect.y+Xf+qc,w:Oh-$c,h:Bh-qc},tc=oa/Te/ft,eh=Ra/Te/pt;return{tl:Vs,tr:jo,bl:Cl,br:Hs,tex:Gl,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Qu,pixelOffsetBR:vf,minFontScaleX:tc,minFontScaleY:eh,isSDF:B}};if(!J||!xe.stretchX&&!xe.stretchY)he.push(Sa({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Fe+1},{fixed:0,stretch:qe+1}));else for(var ti=Iv(Ft,on,dr),La=Iv(tr,$r,Fr),Da=0;Da<ti.length-1;Da++)for(var fi=ti[Da],qa=ti[Da+1],ki=0;ki<La.length-1;ki++){var Zi=La[ki],Ei=La[ki+1];he.push(Sa(fi,Zi,qa,Ei))}return he}function Yc(E,C,B){for(var J=0,he=0,xe=E;he<xe.length;he+=1){var Te=xe[he];J+=Math.max(C,Math.min(B,Te[1]))-Math.max(C,Math.min(B,Te[0]))}return J}function Iv(E,C,B){for(var J=[{fixed:-Xf,stretch:0}],he=0,xe=E;he<xe.length;he+=1){var Te=xe[he],Fe=Te[0],qe=Te[1],ft=J[J.length-1];J.push({fixed:Fe-ft.stretch,stretch:ft.stretch}),J.push({fixed:Fe-ft.stretch,stretch:ft.stretch+(qe-Fe)})}return J.push({fixed:C+Xf,stretch:B}),J}function Wc(E,C,B,J){return E/C*B+J}function Xc(E,C,B,J){return E-C*B/J}function m0(E,C,B,J,he,xe,Te,Fe){for(var qe=J.layout.get("text-rotate").evaluate(xe,{})*Math.PI/180,ft=[],pt=0,Ft=C.positionedLines;pt<Ft.length;pt+=1)for(var tr=Ft[pt],Qt=0,dr=tr.positionedGlyphs;Qt<dr.length;Qt+=1){var Fr=dr[Qt];if(!!Fr.rect){var on=Fr.rect||{},$r=1,kn=gv+$r,mn=!0,Sn=1,In=0,Gn=(he||Fe)&&Fr.vertical,oa=Fr.metrics.advance*Fr.scale/2;if(Fe&&C.verticalizable){var na=(Fr.scale-1)*vs,Ra=(vs-Fr.metrics.width*Fr.scale)/2;In=tr.lineOffset/2-(Fr.imageName?-Ra:na)}if(Fr.imageName){var wa=Te[Fr.imageName];mn=wa.sdf,Sn=wa.pixelRatio,kn=hl/Sn}var Sa=he?[Fr.x+oa,Fr.y]:[0,0],ti=he?[0,0]:[Fr.x+oa+B[0],Fr.y+B[1]-In],La=[0,0];Gn&&(La=ti,ti=[0,0]);var Da=(Fr.metrics.left-kn)*Fr.scale-oa+ti[0],fi=(-Fr.metrics.top-kn)*Fr.scale+ti[1],qa=Da+on.w*Fr.scale/Sn,ki=fi+on.h*Fr.scale/Sn,Zi=new c(Da,fi),Ei=new c(qa,fi),Ci=new c(Da,ki),Ti=new c(qa,ki);if(Gn){var eo=new c(-oa,oa-_c),ao=-Math.PI/2,Ao=vs/2-oa,Po=Fr.imageName?Ao:0,es=new c(5-_c-Ao,-Po),Go=new(Function.prototype.bind.apply(c,[null].concat(La)));Zi._rotateAround(ao,eo)._add(es)._add(Go),Ei._rotateAround(ao,eo)._add(es)._add(Go),Ci._rotateAround(ao,eo)._add(es)._add(Go),Ti._rotateAround(ao,eo)._add(es)._add(Go)}if(qe){var Ps=Math.sin(qe),Ds=Math.cos(qe),ts=[Ds,-Ps,Ps,Ds];Zi._matMult(ts),Ei._matMult(ts),Ci._matMult(ts),Ti._matMult(ts)}var Us=new c(0,0),Vs=new c(0,0),jo=0,Hs=0;ft.push({tl:Zi,tr:Ei,bl:Ci,br:Ti,tex:on,writingMode:C.writingMode,glyphOffset:Sa,sectionIndex:Fr.sectionIndex,isSDF:mn,pixelOffsetTL:Us,pixelOffsetBR:Vs,minFontScaleX:jo,minFontScaleY:Hs})}}return ft}var Zc=function(C,B,J,he,xe,Te,Fe,qe,ft,pt){if(this.boxStartIndex=C.length,ft){var Ft=Te.top,tr=Te.bottom,Qt=Te.collisionPadding;Qt&&(Ft-=Qt[1],tr+=Qt[3]);var dr=tr-Ft;dr>0&&(dr=Math.max(10,dr),this.circleDiameter=dr)}else{var Fr=Te.top*Fe-qe,on=Te.bottom*Fe+qe,$r=Te.left*Fe-qe,kn=Te.right*Fe+qe,mn=Te.collisionPadding;if(mn&&($r-=mn[0]*Fe,Fr-=mn[1]*Fe,kn+=mn[2]*Fe,on+=mn[3]*Fe),pt){var Sn=new c($r,Fr),In=new c(kn,Fr),Gn=new c($r,on),oa=new c(kn,on),na=pt*Math.PI/180;Sn._rotate(na),In._rotate(na),Gn._rotate(na),oa._rotate(na),$r=Math.min(Sn.x,In.x,Gn.x,oa.x),kn=Math.max(Sn.x,In.x,Gn.x,oa.x),Fr=Math.min(Sn.y,In.y,Gn.y,oa.y),on=Math.max(Sn.y,In.y,Gn.y,oa.y)}C.emplaceBack(B.x,B.y,$r,Fr,kn,on,J,he,xe)}this.boxEndIndex=C.length},Zf=function(C,B){if(C===void 0&&(C=[]),B===void 0&&(B=x0),this.data=C,this.length=this.data.length,this.compare=B,this.length>0)for(var J=(this.length>>1)-1;J>=0;J--)this._down(J)};Zf.prototype.push=function(C){this.data.push(C),this.length++,this._up(this.length-1)},Zf.prototype.pop=function(){if(this.length!==0){var C=this.data[0],B=this.data.pop();return this.length--,this.length>0&&(this.data[0]=B,this._down(0)),C}},Zf.prototype.peek=function(){return this.data[0]},Zf.prototype._up=function(C){for(var B=this,J=B.data,he=B.compare,xe=J[C];C>0;){var Te=C-1>>1,Fe=J[Te];if(he(xe,Fe)>=0)break;J[C]=Fe,C=Te}J[C]=xe},Zf.prototype._down=function(C){for(var B=this,J=B.data,he=B.compare,xe=this.length>>1,Te=J[C];C<xe;){var Fe=(C<<1)+1,qe=J[Fe],ft=Fe+1;if(ft<this.length&&he(J[ft],qe)<0&&(Fe=ft,qe=J[ft]),he(qe,Te)>=0)break;J[C]=qe,C=Fe}J[C]=Te};function x0(E,C){return E<C?-1:E>C?1:0}function b0(E,C,B){C===void 0&&(C=1),B===void 0&&(B=!1);for(var J=1/0,he=1/0,xe=-1/0,Te=-1/0,Fe=E[0],qe=0;qe<Fe.length;qe++){var ft=Fe[qe];(!qe||ft.x<J)&&(J=ft.x),(!qe||ft.y<he)&&(he=ft.y),(!qe||ft.x>xe)&&(xe=ft.x),(!qe||ft.y>Te)&&(Te=ft.y)}var pt=xe-J,Ft=Te-he,tr=Math.min(pt,Ft),Qt=tr/2,dr=new Zf([],_0);if(tr===0)return new c(J,he);for(var Fr=J;Fr<xe;Fr+=tr)for(var on=he;on<Te;on+=tr)dr.push(new jf(Fr+Qt,on+Qt,Qt,E));for(var $r=T0(E),kn=dr.length;dr.length;){var mn=dr.pop();(mn.d>$r.d||!$r.d)&&($r=mn,B&&console.log("found best %d after %d probes",Math.round(1e4*mn.d)/1e4,kn)),!(mn.max-$r.d<=C)&&(Qt=mn.h/2,dr.push(new jf(mn.p.x-Qt,mn.p.y-Qt,Qt,E)),dr.push(new jf(mn.p.x+Qt,mn.p.y-Qt,Qt,E)),dr.push(new jf(mn.p.x-Qt,mn.p.y+Qt,Qt,E)),dr.push(new jf(mn.p.x+Qt,mn.p.y+Qt,Qt,E)),kn+=4)}return B&&(console.log("num probes: "+kn),console.log("best distance: "+$r.d)),$r.p}function _0(E,C){return C.max-E.max}function jf(E,C,B,J){this.p=new c(E,C),this.h=B,this.d=w0(this.p,J),this.max=this.d+this.h*Math.SQRT2}function w0(E,C){for(var B=!1,J=1/0,he=0;he<C.length;he++)for(var xe=C[he],Te=0,Fe=xe.length,qe=Fe-1;Te<Fe;qe=Te++){var ft=xe[Te],pt=xe[qe];ft.y>E.y!=pt.y>E.y&&E.x<(pt.x-ft.x)*(E.y-ft.y)/(pt.y-ft.y)+ft.x&&(B=!B),J=Math.min(J,_u(E,ft,pt))}return(B?1:-1)*Math.sqrt(J)}function T0(E){for(var C=0,B=0,J=0,he=E[0],xe=0,Te=he.length,Fe=Te-1;xe<Te;Fe=xe++){var qe=he[xe],ft=he[Fe],pt=qe.x*ft.y-ft.x*qe.y;B+=(qe.x+ft.x)*pt,J+=(qe.y+ft.y)*pt,C+=pt*3}return new jf(B/C,J/C,0,E)}var Kf=7,Lh=Number.POSITIVE_INFINITY;function zv(E,C){function B(he,xe){var Te=0,Fe=0;xe<0&&(xe=0);var qe=xe/Math.sqrt(2);switch(he){case"top-right":case"top-left":Fe=qe-Kf;break;case"bottom-right":case"bottom-left":Fe=-qe+Kf;break;case"bottom":Fe=-xe+Kf;break;case"top":Fe=xe-Kf;break}switch(he){case"top-right":case"bottom-right":Te=-qe;break;case"top-left":case"bottom-left":Te=qe;break;case"left":Te=xe;break;case"right":Te=-xe;break}return[Te,Fe]}function J(he,xe,Te){var Fe=0,qe=0;switch(xe=Math.abs(xe),Te=Math.abs(Te),he){case"top-right":case"top-left":case"top":qe=Te-Kf;break;case"bottom-right":case"bottom-left":case"bottom":qe=-Te+Kf;break}switch(he){case"top-right":case"bottom-right":case"right":Fe=-xe;break;case"top-left":case"bottom-left":case"left":Fe=xe;break}return[Fe,qe]}return C[1]!==Lh?J(E,C[0],C[1]):B(E,C[0])}function A0(E,C,B,J,he,xe,Te){E.createArrays();var Fe=512*E.overscaling;E.tilePixelRatio=Ba/Fe,E.compareText={},E.iconsNeedLinear=!1;var qe=E.layers[0].layout,ft=E.layers[0]._unevaluatedLayout._values,pt={};if(E.textSizeData.kind==="composite"){var Ft=E.textSizeData,tr=Ft.minZoom,Qt=Ft.maxZoom;pt.compositeTextSizes=[ft["text-size"].possiblyEvaluate(new si(tr),Te),ft["text-size"].possiblyEvaluate(new si(Qt),Te)]}if(E.iconSizeData.kind==="composite"){var dr=E.iconSizeData,Fr=dr.minZoom,on=dr.maxZoom;pt.compositeIconSizes=[ft["icon-size"].possiblyEvaluate(new si(Fr),Te),ft["icon-size"].possiblyEvaluate(new si(on),Te)]}pt.layoutTextSize=ft["text-size"].possiblyEvaluate(new si(E.zoom+1),Te),pt.layoutIconSize=ft["icon-size"].possiblyEvaluate(new si(E.zoom+1),Te),pt.textMaxSize=ft["text-size"].possiblyEvaluate(new si(18));for(var $r=qe.get("text-line-height")*vs,kn=qe.get("text-rotation-alignment")==="map"&&qe.get("symbol-placement")!=="point",mn=qe.get("text-keep-upright"),Sn=qe.get("text-size"),In=function(){var na=oa[Gn],Ra=qe.get("text-font").evaluate(na,{},Te).join(","),wa=Sn.evaluate(na,{},Te),Sa=pt.layoutTextSize.evaluate(na,{},Te),ti=pt.layoutIconSize.evaluate(na,{},Te),La={horizontal:{},vertical:void 0},Da=na.text,fi=[0,0];if(Da){var qa=Da.toString(),ki=qe.get("text-letter-spacing").evaluate(na,{},Te)*vs,Zi=Qr(qa)?ki:0,Ei=qe.get("text-anchor").evaluate(na,{},Te),Ci=qe.get("text-variable-anchor");if(!Ci){var Ti=qe.get("text-radial-offset").evaluate(na,{},Te);Ti?fi=zv(Ei,[Ti*vs,Lh]):fi=qe.get("text-offset").evaluate(na,{},Te).map(function(Qu){return Qu*vs})}var eo=kn?"center":qe.get("text-justify").evaluate(na,{},Te),ao=qe.get("symbol-placement"),Ao=ao==="point"?qe.get("text-max-width").evaluate(na,{},Te)*vs:0,Po=function(){E.allowVerticalPlacement&&Mr(qa)&&(La.vertical=Gc(Da,C,B,he,Ra,Ao,$r,Ei,"left",Zi,fi,El.vertical,!0,ao,Sa,wa))};if(!kn&&Ci){for(var es=eo==="auto"?Ci.map(function(Qu){return Ph(Qu)}):[eo],Go=!1,Ps=0;Ps<es.length;Ps++){var Ds=es[Ps];if(!La.horizontal[Ds])if(Go)La.horizontal[Ds]=La.horizontal[0];else{var ts=Gc(Da,C,B,he,Ra,Ao,$r,"center",Ds,Zi,fi,El.horizontal,!1,ao,Sa,wa);ts&&(La.horizontal[Ds]=ts,Go=ts.positionedLines.length===1)}}Po()}else{eo==="auto"&&(eo=Ph(Ei));var Us=Gc(Da,C,B,he,Ra,Ao,$r,Ei,eo,Zi,fi,El.horizontal,!1,ao,Sa,wa);Us&&(La.horizontal[eo]=Us),Po(),Mr(qa)&&kn&&mn&&(La.vertical=Gc(Da,C,B,he,Ra,Ao,$r,Ei,eo,Zi,fi,El.vertical,!1,ao,Sa,wa))}}var Vs=void 0,jo=!1;if(na.icon&&na.icon.name){var Hs=J[na.icon.name];Hs&&(Vs=p0(he[na.icon.name],qe.get("icon-offset").evaluate(na,{},Te),qe.get("icon-anchor").evaluate(na,{},Te)),jo=Hs.sdf,E.sdfIcons===void 0?E.sdfIcons=Hs.sdf:E.sdfIcons!==Hs.sdf&&O("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Hs.pixelRatio!==E.pixelRatio||qe.get("icon-rotate").constantOr(1)!==0)&&(E.iconsNeedLinear=!0))}var Cl=Ov(La.horizontal)||La.vertical;E.iconsInText=Cl?Cl.iconsInText:!1,(Cl||Vs)&&M0(E,na,La,Vs,J,pt,Sa,ti,fi,jo,Te)},Gn=0,oa=E.features;Gn<oa.length;Gn+=1)In();xe&&E.generateCollisionDebugBuffers()}function Ph(E){switch(E){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function M0(E,C,B,J,he,xe,Te,Fe,qe,ft,pt){var Ft=xe.textMaxSize.evaluate(C,{});Ft===void 0&&(Ft=Te);var tr=E.layers[0].layout,Qt=tr.get("icon-offset").evaluate(C,{},pt),dr=Ov(B.horizontal),Fr=24,on=Te/Fr,$r=E.tilePixelRatio*on,kn=E.tilePixelRatio*Ft/Fr,mn=E.tilePixelRatio*Fe,Sn=E.tilePixelRatio*tr.get("symbol-spacing"),In=tr.get("text-padding")*E.tilePixelRatio,Gn=tr.get("icon-padding")*E.tilePixelRatio,oa=tr.get("text-max-angle")/180*Math.PI,na=tr.get("text-rotation-alignment")==="map"&&tr.get("symbol-placement")!=="point",Ra=tr.get("icon-rotation-alignment")==="map"&&tr.get("symbol-placement")!=="point",wa=tr.get("symbol-placement"),Sa=Sn/2,ti=tr.get("icon-text-fit"),La;J&&ti!=="none"&&(E.allowVerticalPlacement&&B.vertical&&(La=Av(J,B.vertical,ti,tr.get("icon-text-fit-padding"),Qt,on)),dr&&(J=Av(J,dr,ti,tr.get("icon-text-fit-padding"),Qt,on)));var Da=function(ec,nu){nu.x<0||nu.x>=Ba||nu.y<0||nu.y>=Ba||S0(E,nu,ec,B,J,he,La,E.layers[0],E.collisionBoxArray,C.index,C.sourceLayerIndex,E.index,$r,In,na,qe,mn,Gn,Ra,Qt,C,xe,ft,pt,Te)};if(wa==="line")for(var fi=0,qa=Dv(C.geometry,0,0,Ba,Ba);fi<qa.length;fi+=1)for(var ki=qa[fi],Zi=y0(ki,Sn,oa,B.vertical||dr,J,Fr,kn,E.overscaling,Ba),Ei=0,Ci=Zi;Ei<Ci.length;Ei+=1){var Ti=Ci[Ei],eo=dr;(!eo||!k0(E,eo.text,Sa,Ti))&&Da(ki,Ti)}else if(wa==="line-center")for(var ao=0,Ao=C.geometry;ao<Ao.length;ao+=1){var Po=Ao[ao];if(Po.length>1){var es=g0(Po,oa,B.vertical||dr,J,Fr,kn);es&&Da(Po,es)}}else if(C.type==="Polygon")for(var Go=0,Ps=bh(C.geometry,0);Go<Ps.length;Go+=1){var Ds=Ps[Go],ts=b0(Ds,16);Da(Ds[0],new Wf(ts.x,ts.y,0))}else if(C.type==="LineString")for(var Us=0,Vs=C.geometry;Us<Vs.length;Us+=1){var jo=Vs[Us];Da(jo,new Wf(jo[0].x,jo[0].y,0))}else if(C.type==="Point")for(var Hs=0,Cl=C.geometry;Hs<Cl.length;Hs+=1)for(var Qu=Cl[Hs],vf=0,pf=Qu;vf<pf.length;vf+=1){var df=pf[vf];Da([df],new Wf(df.x,df.y,0))}}var wc=255,cf=wc*Au;function Fv(E,C,B,J,he,xe,Te,Fe,qe,ft,pt,Ft,tr,Qt,dr){var Fr=m0(C,B,Fe,he,xe,Te,J,E.allowVerticalPlacement),on=E.textSizeData,$r=null;on.kind==="source"?($r=[Au*he.layout.get("text-size").evaluate(Te,{})],$r[0]>cf&&O(E.layerIds[0]+': Value for "text-size" is >= '+wc+'. Reduce your "text-size".')):on.kind==="composite"&&($r=[Au*Qt.compositeTextSizes[0].evaluate(Te,{},dr),Au*Qt.compositeTextSizes[1].evaluate(Te,{},dr)],($r[0]>cf||$r[1]>cf)&&O(E.layerIds[0]+': Value for "text-size" is >= '+wc+'. Reduce your "text-size".')),E.addSymbols(E.text,Fr,$r,Fe,xe,Te,ft,C,qe.lineStartIndex,qe.lineLength,tr,dr);for(var kn=0,mn=pt;kn<mn.length;kn+=1){var Sn=mn[kn];Ft[Sn]=E.text.placedSymbolArray.length-1}return Fr.length*4}function Ov(E){for(var C in E)return E[C];return null}function S0(E,C,B,J,he,xe,Te,Fe,qe,ft,pt,Ft,tr,Qt,dr,Fr,on,$r,kn,mn,Sn,In,Gn,oa,na){var Ra,wa=E.addToLineVertexArray(C,B),Sa,ti,La,Da,fi=0,qa=0,ki=0,Zi=0,Ei=-1,Ci=-1,Ti={},eo=Re(""),ao=0,Ao=0;if(Fe._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Ra=Fe.layout.get("text-offset").evaluate(Sn,{},oa).map(function(Mc){return Mc*vs}),ao=Ra[0],Ao=Ra[1]):(ao=Fe.layout.get("text-radial-offset").evaluate(Sn,{},oa)*vs,Ao=Lh),E.allowVerticalPlacement&&J.vertical){var Po=Fe.layout.get("text-rotate").evaluate(Sn,{},oa),es=Po+90,Go=J.vertical;La=new Zc(qe,C,ft,pt,Ft,Go,tr,Qt,dr,es),Te&&(Da=new Zc(qe,C,ft,pt,Ft,Te,on,$r,dr,es))}if(he){var Ps=Fe.layout.get("icon-rotate").evaluate(Sn,{}),Ds=Fe.layout.get("icon-text-fit")!=="none",ts=Rv(he,Ps,Gn,Ds),Us=Te?Rv(Te,Ps,Gn,Ds):void 0;ti=new Zc(qe,C,ft,pt,Ft,he,on,$r,!1,Ps),fi=ts.length*4;var Vs=E.iconSizeData,jo=null;Vs.kind==="source"?(jo=[Au*Fe.layout.get("icon-size").evaluate(Sn,{})],jo[0]>cf&&O(E.layerIds[0]+': Value for "icon-size" is >= '+wc+'. Reduce your "icon-size".')):Vs.kind==="composite"&&(jo=[Au*In.compositeIconSizes[0].evaluate(Sn,{},oa),Au*In.compositeIconSizes[1].evaluate(Sn,{},oa)],(jo[0]>cf||jo[1]>cf)&&O(E.layerIds[0]+': Value for "icon-size" is >= '+wc+'. Reduce your "icon-size".')),E.addSymbols(E.icon,ts,jo,mn,kn,Sn,!1,C,wa.lineStartIndex,wa.lineLength,-1,oa),Ei=E.icon.placedSymbolArray.length-1,Us&&(qa=Us.length*4,E.addSymbols(E.icon,Us,jo,mn,kn,Sn,El.vertical,C,wa.lineStartIndex,wa.lineLength,-1,oa),Ci=E.icon.placedSymbolArray.length-1)}for(var Hs in J.horizontal){var Cl=J.horizontal[Hs];if(!Sa){eo=Re(Cl.text);var Qu=Fe.layout.get("text-rotate").evaluate(Sn,{},oa);Sa=new Zc(qe,C,ft,pt,Ft,Cl,tr,Qt,dr,Qu)}var vf=Cl.positionedLines.length===1;if(ki+=Fv(E,C,Cl,xe,Fe,dr,Sn,Fr,wa,J.vertical?El.horizontal:El.horizontalOnly,vf?Object.keys(J.horizontal):[Hs],Ti,Ei,In,oa),vf)break}J.vertical&&(Zi+=Fv(E,C,J.vertical,xe,Fe,dr,Sn,Fr,wa,El.vertical,["vertical"],Ti,Ci,In,oa));var pf=Sa?Sa.boxStartIndex:E.collisionBoxArray.length,df=Sa?Sa.boxEndIndex:E.collisionBoxArray.length,ec=La?La.boxStartIndex:E.collisionBoxArray.length,nu=La?La.boxEndIndex:E.collisionBoxArray.length,$c=ti?ti.boxStartIndex:E.collisionBoxArray.length,Oh=ti?ti.boxEndIndex:E.collisionBoxArray.length,qc=Da?Da.boxStartIndex:E.collisionBoxArray.length,Bh=Da?Da.boxEndIndex:E.collisionBoxArray.length,Gl=-1,tc=function(Mc,qv){return Mc&&Mc.circleDiameter?Math.max(Mc.circleDiameter,qv):qv};Gl=tc(Sa,Gl),Gl=tc(La,Gl),Gl=tc(ti,Gl),Gl=tc(Da,Gl);var eh=Gl>-1?1:0;eh&&(Gl*=na/vs),E.glyphOffsetArray.length>=Xi.MAX_GLYPHS&&O("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Sn.sortKey!==void 0&&E.addToSortKeyRanges(E.symbolInstances.length,Sn.sortKey),E.symbolInstances.emplaceBack(C.x,C.y,Ti.right>=0?Ti.right:-1,Ti.center>=0?Ti.center:-1,Ti.left>=0?Ti.left:-1,Ti.vertical||-1,Ei,Ci,eo,pf,df,ec,nu,$c,Oh,qc,Bh,ft,ki,Zi,fi,qa,eh,0,tr,ao,Ao,Gl)}function k0(E,C,B,J){var he=E.compareText;if(!(C in he))he[C]=[];else for(var xe=he[C],Te=xe.length-1;Te>=0;Te--)if(J.dist(xe[Te])<B)return!0;return he[C].push(J),!1}var E0=Vf.VectorTileFeature.types,C0=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function jc(E,C,B,J,he,xe,Te,Fe,qe,ft,pt,Ft,tr){var Qt=Fe?Math.min(cf,Math.round(Fe[0])):0,dr=Fe?Math.min(cf,Math.round(Fe[1])):0;E.emplaceBack(C,B,Math.round(J*32),Math.round(he*32),xe,Te,(Qt<<1)+(qe?1:0),dr,ft*16,pt*16,Ft*256,tr*256)}function Dh(E,C,B){E.emplaceBack(C.x,C.y,B),E.emplaceBack(C.x,C.y,B),E.emplaceBack(C.x,C.y,B),E.emplaceBack(C.x,C.y,B)}function L0(E){for(var C=0,B=E.sections;C<B.length;C+=1){var J=B[C];if(ra(J.text))return!0}return!1}var Jf=function(C){this.layoutVertexArray=new Bu,this.indexArray=new bu,this.programConfigurations=C,this.segments=new H,this.dynamicLayoutVertexArray=new ac,this.opacityVertexArray=new ic,this.placedSymbolArray=new sf};Jf.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Jf.prototype.upload=function(C,B,J,he){this.isEmpty()||(J&&(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,Ah.members),this.indexBuffer=C.createIndexBuffer(this.indexArray,B),this.dynamicLayoutVertexBuffer=C.createVertexBuffer(this.dynamicLayoutVertexArray,Pd.members,!0),this.opacityVertexBuffer=C.createVertexBuffer(this.opacityVertexArray,C0,!0),this.opacityVertexBuffer.itemSize=1),(J||he)&&this.programConfigurations.upload(C))},Jf.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Oe("SymbolBuffers",Jf);var Tc=function(C,B,J){this.layoutVertexArray=new C,this.layoutAttributes=B,this.indexArray=new J,this.segments=new H,this.collisionVertexArray=new $s};Tc.prototype.upload=function(C){this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=C.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=C.createVertexBuffer(this.collisionVertexArray,Dd.members,!0)},Tc.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Oe("CollisionBuffers",Tc);var Xi=function(C){this.collisionBoxArray=C.collisionBoxArray,this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(qe){return qe.id}),this.index=C.index,this.pixelRatio=C.pixelRatio,this.sourceLayerIndex=C.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ff([]),this.placementViewportMatrix=Ff([]);var B=this.layers[0],J=B._unevaluatedLayout._values;this.textSizeData=Ch(this.zoom,J["text-size"]),this.iconSizeData=Ch(this.zoom,J["icon-size"]);var he=this.layers[0].layout,xe=he.get("symbol-sort-key"),Te=he.get("symbol-z-order");this.sortFeaturesByKey=Te!=="viewport-y"&&xe.constantOr(1)!==void 0;var Fe=Te==="viewport-y"||Te==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=Fe&&(he.get("text-allow-overlap")||he.get("icon-allow-overlap")||he.get("text-ignore-placement")||he.get("icon-ignore-placement")),he.get("symbol-placement")==="point"&&(this.writingModes=he.get("text-writing-mode").map(function(qe){return El[qe]})),this.stateDependentLayerIds=this.layers.filter(function(qe){return qe.isStateDependent()}).map(function(qe){return qe.id}),this.sourceID=C.sourceID};Xi.prototype.createArrays=function(){this.text=new Jf(new ni(Ah.members,this.layers,this.zoom,function(C){return/^text/.test(C)})),this.icon=new Jf(new ni(Ah.members,this.layers,this.zoom,function(C){return/^icon/.test(C)})),this.glyphOffsetArray=new Vl,this.lineVertexArray=new Lc,this.symbolInstances=new Cc},Xi.prototype.calculateGlyphDependencies=function(C,B,J,he,xe){for(var Te=0;Te<C.length;Te++)if(B[C.charCodeAt(Te)]=!0,(J||he)&&xe){var Fe=mc[C.charAt(Te)];Fe&&(B[Fe.charCodeAt(0)]=!0)}},Xi.prototype.populate=function(C,B,J){var he=this.layers[0],xe=he.layout,Te=xe.get("text-font"),Fe=xe.get("text-field"),qe=xe.get("icon-image"),ft=(Fe.value.kind!=="constant"||Fe.value.value instanceof Hi&&!Fe.value.value.isEmpty()||Fe.value.value.toString().length>0)&&(Te.value.kind!=="constant"||Te.value.value.length>0),pt=qe.value.kind!=="constant"||!!qe.value.value||Object.keys(qe.parameters).length>0,Ft=xe.get("symbol-sort-key");if(this.features=[],!(!ft&&!pt)){for(var tr=B.iconDependencies,Qt=B.glyphDependencies,dr=B.availableImages,Fr=new si(this.zoom),on=0,$r=C;on<$r.length;on+=1){var kn=$r[on],mn=kn.feature,Sn=kn.id,In=kn.index,Gn=kn.sourceLayerIndex,oa=he._featureFilter.needGeometry,na={type:mn.type,id:Sn,properties:mn.properties,geometry:oa?Ui(mn):[]};if(!!he._featureFilter.filter(Fr,na,J)){oa||(na.geometry=Ui(mn));var Ra=void 0;if(ft){var wa=he.getValueAndResolveTokens("text-field",na,J,dr),Sa=Hi.factory(wa);L0(Sa)&&(this.hasRTLText=!0),(!this.hasRTLText||ho()==="unavailable"||this.hasRTLText&&Xa.isParsed())&&(Ra=zd(Sa,he,na))}var ti=void 0;if(pt){var La=he.getValueAndResolveTokens("icon-image",na,J,dr);La instanceof So?ti=La:ti=So.fromString(La)}if(!(!Ra&&!ti)){var Da=this.sortFeaturesByKey?Ft.evaluate(na,{},J):void 0,fi={id:Sn,text:Ra,icon:ti,index:In,sourceLayerIndex:Gn,geometry:Ui(mn),properties:mn.properties,type:E0[mn.type],sortKey:Da};if(this.features.push(fi),ti&&(tr[ti.name]=!0),Ra){var qa=Te.evaluate(na,{},J).join(","),ki=xe.get("text-rotation-alignment")==="map"&&xe.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(El.vertical)>=0;for(var Zi=0,Ei=Ra.sections;Zi<Ei.length;Zi+=1){var Ci=Ei[Zi];if(Ci.image)tr[Ci.image.name]=!0;else{var Ti=Mr(Ra.toString()),eo=Ci.fontStack||qa,ao=Qt[eo]=Qt[eo]||{};this.calculateGlyphDependencies(Ci.text,ao,ki,this.allowVerticalPlacement,Ti)}}}}}}xe.get("symbol-placement")==="line"&&(this.features=Fd(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ao,Po){return Ao.sortKey-Po.sortKey})}},Xi.prototype.update=function(C,B,J){!this.stateDependentLayers.length||(this.text.programConfigurations.updatePaintArrays(C,B,this.layers,J),this.icon.programConfigurations.updatePaintArrays(C,B,this.layers,J))},Xi.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Xi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Xi.prototype.upload=function(C){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(C),this.iconCollisionBox.upload(C)),this.text.upload(C,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(C,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Xi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Xi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Xi.prototype.addToLineVertexArray=function(C,B){var J=this.lineVertexArray.length;if(C.segment!==void 0){for(var he=C.dist(B[C.segment+1]),xe=C.dist(B[C.segment]),Te={},Fe=C.segment+1;Fe<B.length;Fe++)Te[Fe]={x:B[Fe].x,y:B[Fe].y,tileUnitDistanceFromAnchor:he},Fe<B.length-1&&(he+=B[Fe+1].dist(B[Fe]));for(var qe=C.segment||0;qe>=0;qe--)Te[qe]={x:B[qe].x,y:B[qe].y,tileUnitDistanceFromAnchor:xe},qe>0&&(xe+=B[qe-1].dist(B[qe]));for(var ft=0;ft<B.length;ft++){var pt=Te[ft];this.lineVertexArray.emplaceBack(pt.x,pt.y,pt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:J,lineLength:this.lineVertexArray.length-J}},Xi.prototype.addSymbols=function(C,B,J,he,xe,Te,Fe,qe,ft,pt,Ft,tr){for(var Qt=C.indexArray,dr=C.layoutVertexArray,Fr=C.segments.prepareSegment(4*B.length,dr,Qt,Te.sortKey),on=this.glyphOffsetArray.length,$r=Fr.vertexLength,kn=this.allowVerticalPlacement&&Fe===El.vertical?Math.PI/2:0,mn=Te.text&&Te.text.sections,Sn=0;Sn<B.length;Sn++){var In=B[Sn],Gn=In.tl,oa=In.tr,na=In.bl,Ra=In.br,wa=In.tex,Sa=In.pixelOffsetTL,ti=In.pixelOffsetBR,La=In.minFontScaleX,Da=In.minFontScaleY,fi=In.glyphOffset,qa=In.isSDF,ki=In.sectionIndex,Zi=Fr.vertexLength,Ei=fi[1];jc(dr,qe.x,qe.y,Gn.x,Ei+Gn.y,wa.x,wa.y,J,qa,Sa.x,Sa.y,La,Da),jc(dr,qe.x,qe.y,oa.x,Ei+oa.y,wa.x+wa.w,wa.y,J,qa,ti.x,Sa.y,La,Da),jc(dr,qe.x,qe.y,na.x,Ei+na.y,wa.x,wa.y+wa.h,J,qa,Sa.x,ti.y,La,Da),jc(dr,qe.x,qe.y,Ra.x,Ei+Ra.y,wa.x+wa.w,wa.y+wa.h,J,qa,ti.x,ti.y,La,Da),Dh(C.dynamicLayoutVertexArray,qe,kn),Qt.emplaceBack(Zi,Zi+1,Zi+2),Qt.emplaceBack(Zi+1,Zi+2,Zi+3),Fr.vertexLength+=4,Fr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(fi[0]),(Sn===B.length-1||ki!==B[Sn+1].sectionIndex)&&C.programConfigurations.populatePaintArrays(dr.length,Te,Te.index,{},tr,mn&&mn[ki])}C.placedSymbolArray.emplaceBack(qe.x,qe.y,on,this.glyphOffsetArray.length-on,$r,ft,pt,qe.segment,J?J[0]:0,J?J[1]:0,he[0],he[1],Fe,0,!1,0,Ft)},Xi.prototype._addCollisionDebugVertex=function(C,B,J,he,xe,Te){return B.emplaceBack(0,0),C.emplaceBack(J.x,J.y,he,xe,Math.round(Te.x),Math.round(Te.y))},Xi.prototype.addCollisionDebugVertices=function(C,B,J,he,xe,Te,Fe){var qe=xe.segments.prepareSegment(4,xe.layoutVertexArray,xe.indexArray),ft=qe.vertexLength,pt=xe.layoutVertexArray,Ft=xe.collisionVertexArray,tr=Fe.anchorX,Qt=Fe.anchorY;this._addCollisionDebugVertex(pt,Ft,Te,tr,Qt,new c(C,B)),this._addCollisionDebugVertex(pt,Ft,Te,tr,Qt,new c(J,B)),this._addCollisionDebugVertex(pt,Ft,Te,tr,Qt,new c(J,he)),this._addCollisionDebugVertex(pt,Ft,Te,tr,Qt,new c(C,he)),qe.vertexLength+=4;var dr=xe.indexArray;dr.emplaceBack(ft,ft+1),dr.emplaceBack(ft+1,ft+2),dr.emplaceBack(ft+2,ft+3),dr.emplaceBack(ft+3,ft),qe.primitiveLength+=4},Xi.prototype.addDebugCollisionBoxes=function(C,B,J,he){for(var xe=C;xe<B;xe++){var Te=this.collisionBoxArray.get(xe),Fe=Te.x1,qe=Te.y1,ft=Te.x2,pt=Te.y2;this.addCollisionDebugVertices(Fe,qe,ft,pt,he?this.textCollisionBox:this.iconCollisionBox,Te.anchorPoint,J)}},Xi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Tc(Pf,cv.members,bf),this.iconCollisionBox=new Tc(Pf,cv.members,bf);for(var C=0;C<this.symbolInstances.length;C++){var B=this.symbolInstances.get(C);this.addDebugCollisionBoxes(B.textBoxStartIndex,B.textBoxEndIndex,B,!0),this.addDebugCollisionBoxes(B.verticalTextBoxStartIndex,B.verticalTextBoxEndIndex,B,!0),this.addDebugCollisionBoxes(B.iconBoxStartIndex,B.iconBoxEndIndex,B,!1),this.addDebugCollisionBoxes(B.verticalIconBoxStartIndex,B.verticalIconBoxEndIndex,B,!1)}},Xi.prototype._deserializeCollisionBoxesForSymbol=function(C,B,J,he,xe,Te,Fe,qe,ft){for(var pt={},Ft=B;Ft<J;Ft++){var tr=C.get(Ft);pt.textBox={x1:tr.x1,y1:tr.y1,x2:tr.x2,y2:tr.y2,anchorPointX:tr.anchorPointX,anchorPointY:tr.anchorPointY},pt.textFeatureIndex=tr.featureIndex;break}for(var Qt=he;Qt<xe;Qt++){var dr=C.get(Qt);pt.verticalTextBox={x1:dr.x1,y1:dr.y1,x2:dr.x2,y2:dr.y2,anchorPointX:dr.anchorPointX,anchorPointY:dr.anchorPointY},pt.verticalTextFeatureIndex=dr.featureIndex;break}for(var Fr=Te;Fr<Fe;Fr++){var on=C.get(Fr);pt.iconBox={x1:on.x1,y1:on.y1,x2:on.x2,y2:on.y2,anchorPointX:on.anchorPointX,anchorPointY:on.anchorPointY},pt.iconFeatureIndex=on.featureIndex;break}for(var $r=qe;$r<ft;$r++){var kn=C.get($r);pt.verticalIconBox={x1:kn.x1,y1:kn.y1,x2:kn.x2,y2:kn.y2,anchorPointX:kn.anchorPointX,anchorPointY:kn.anchorPointY},pt.verticalIconFeatureIndex=kn.featureIndex;break}return pt},Xi.prototype.deserializeCollisionBoxes=function(C){this.collisionArrays=[];for(var B=0;B<this.symbolInstances.length;B++){var J=this.symbolInstances.get(B);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(C,J.textBoxStartIndex,J.textBoxEndIndex,J.verticalTextBoxStartIndex,J.verticalTextBoxEndIndex,J.iconBoxStartIndex,J.iconBoxEndIndex,J.verticalIconBoxStartIndex,J.verticalIconBoxEndIndex))}},Xi.prototype.hasTextData=function(){return this.text.segments.get().length>0},Xi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Xi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Xi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Xi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Xi.prototype.addIndicesForPlacedSymbol=function(C,B){for(var J=C.placedSymbolArray.get(B),he=J.vertexStartIndex+J.numGlyphs*4,xe=J.vertexStartIndex;xe<he;xe+=4)C.indexArray.emplaceBack(xe,xe+1,xe+2),C.indexArray.emplaceBack(xe+1,xe+2,xe+3)},Xi.prototype.getSortedSymbolIndexes=function(C){if(this.sortedAngle===C&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var B=Math.sin(C),J=Math.cos(C),he=[],xe=[],Te=[],Fe=0;Fe<this.symbolInstances.length;++Fe){Te.push(Fe);var qe=this.symbolInstances.get(Fe);he.push(Math.round(B*qe.anchorX+J*qe.anchorY)|0),xe.push(qe.featureIndex)}return Te.sort(function(ft,pt){return he[ft]-he[pt]||xe[pt]-xe[ft]}),Te},Xi.prototype.addToSortKeyRanges=function(C,B){var J=this.sortKeyRanges[this.sortKeyRanges.length-1];J&&J.sortKey===B?J.symbolInstanceEnd=C+1:this.sortKeyRanges.push({sortKey:B,symbolInstanceStart:C,symbolInstanceEnd:C+1})},Xi.prototype.sortFeatures=function(C){var B=this;if(!!this.sortFeaturesByY&&this.sortedAngle!==C&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(C),this.sortedAngle=C,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var J=0,he=this.symbolInstanceIndexes;J<he.length;J+=1){var xe=he[J],Te=this.symbolInstances.get(xe);this.featureSortOrder.push(Te.featureIndex),[Te.rightJustifiedTextSymbolIndex,Te.centerJustifiedTextSymbolIndex,Te.leftJustifiedTextSymbolIndex].forEach(function(Fe,qe,ft){Fe>=0&&ft.indexOf(Fe)===qe&&B.addIndicesForPlacedSymbol(B.text,Fe)}),Te.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,Te.verticalPlacedTextSymbolIndex),Te.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,Te.placedIconSymbolIndex),Te.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,Te.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Oe("SymbolBucket",Xi,{omit:["layers","collisionBoxArray","features","compareText"]}),Xi.MAX_GLYPHS=65535,Xi.addDynamicAttributes=Dh;function P0(E,C){return C.replace(/{([^{}]+)}/g,function(B,J){return J in E?String(E[J]):""})}var D0=new ji({"symbol-placement":new Ia(Vt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ia(Vt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ia(Vt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Za(Vt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ia(Vt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ia(Vt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ia(Vt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ia(Vt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ia(Vt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Za(Vt.layout_symbol["icon-size"]),"icon-text-fit":new Ia(Vt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ia(Vt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Za(Vt.layout_symbol["icon-image"]),"icon-rotate":new Za(Vt.layout_symbol["icon-rotate"]),"icon-padding":new Ia(Vt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ia(Vt.layout_symbol["icon-keep-upright"]),"icon-offset":new Za(Vt.layout_symbol["icon-offset"]),"icon-anchor":new Za(Vt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ia(Vt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ia(Vt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ia(Vt.layout_symbol["text-rotation-alignment"]),"text-field":new Za(Vt.layout_symbol["text-field"]),"text-font":new Za(Vt.layout_symbol["text-font"]),"text-size":new Za(Vt.layout_symbol["text-size"]),"text-max-width":new Za(Vt.layout_symbol["text-max-width"]),"text-line-height":new Ia(Vt.layout_symbol["text-line-height"]),"text-letter-spacing":new Za(Vt.layout_symbol["text-letter-spacing"]),"text-justify":new Za(Vt.layout_symbol["text-justify"]),"text-radial-offset":new Za(Vt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ia(Vt.layout_symbol["text-variable-anchor"]),"text-anchor":new Za(Vt.layout_symbol["text-anchor"]),"text-max-angle":new Ia(Vt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ia(Vt.layout_symbol["text-writing-mode"]),"text-rotate":new Za(Vt.layout_symbol["text-rotate"]),"text-padding":new Ia(Vt.layout_symbol["text-padding"]),"text-keep-upright":new Ia(Vt.layout_symbol["text-keep-upright"]),"text-transform":new Za(Vt.layout_symbol["text-transform"]),"text-offset":new Za(Vt.layout_symbol["text-offset"]),"text-allow-overlap":new Ia(Vt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ia(Vt.layout_symbol["text-ignore-placement"]),"text-optional":new Ia(Vt.layout_symbol["text-optional"])}),R0=new ji({"icon-opacity":new Za(Vt.paint_symbol["icon-opacity"]),"icon-color":new Za(Vt.paint_symbol["icon-color"]),"icon-halo-color":new Za(Vt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Za(Vt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Za(Vt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ia(Vt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ia(Vt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Za(Vt.paint_symbol["text-opacity"]),"text-color":new Za(Vt.paint_symbol["text-color"],{runtimeType:On,getOverride:function(E){return E.textColor},hasOverride:function(E){return!!E.textColor}}),"text-halo-color":new Za(Vt.paint_symbol["text-halo-color"]),"text-halo-width":new Za(Vt.paint_symbol["text-halo-width"]),"text-halo-blur":new Za(Vt.paint_symbol["text-halo-blur"]),"text-translate":new Ia(Vt.paint_symbol["text-translate"]),"text-translate-anchor":new Ia(Vt.paint_symbol["text-translate-anchor"])}),Rh={paint:R0,layout:D0},Qf=function(C){this.type=C.property.overrides?C.property.overrides.runtimeType:gr,this.defaultValue=C};Qf.prototype.evaluate=function(C){if(C.formattedSection){var B=this.defaultValue.property.overrides;if(B&&B.hasOverride(C.formattedSection))return B.getOverride(C.formattedSection)}return C.feature&&C.featureState?this.defaultValue.evaluate(C.feature,C.featureState):this.defaultValue.property.specification.default},Qf.prototype.eachChild=function(C){if(!this.defaultValue.isConstant()){var B=this.defaultValue.value;C(B._styleExpression.expression)}},Qf.prototype.outputDefined=function(){return!1},Qf.prototype.serialize=function(){return null},Oe("FormatSectionOverride",Qf,{omit:["defaultValue"]});var I0=function(E){function C(B){E.call(this,B,Rh)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.recalculate=function(J,he){if(E.prototype.recalculate.call(this,J,he),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var xe=this.layout.get("text-writing-mode");if(xe){for(var Te=[],Fe=0,qe=xe;Fe<qe.length;Fe+=1){var ft=qe[Fe];Te.indexOf(ft)<0&&Te.push(ft)}this.layout._values["text-writing-mode"]=Te}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},C.prototype.getValueAndResolveTokens=function(J,he,xe,Te){var Fe=this.layout.get(J).evaluate(he,{},xe,Te),qe=this._unevaluatedLayout._values[J];return!qe.isDataDriven()&&!bo(qe.value)&&Fe?P0(he.properties,Fe):Fe},C.prototype.createBucket=function(J){return new Xi(J)},C.prototype.queryRadius=function(){return 0},C.prototype.queryIntersectsFeature=function(){return!1},C.prototype._setPaintOverrides=function(){for(var J=0,he=Rh.paint.overridableProperties;J<he.length;J+=1){var xe=he[J];if(!!C.hasPaintOverride(this.layout,xe)){var Te=this.paint.get(xe),Fe=new Qf(Te),qe=new us(Fe,Te.property.specification),ft=null;Te.value.kind==="constant"||Te.value.kind==="source"?ft=new Ql("source",qe):ft=new fs("composite",qe,Te.value.zoomStops,Te.value._interpolationType),this.paint._values[xe]=new Wi(Te.property,ft,Te.parameters)}}},C.prototype._handleOverridablePaintPropertyUpdate=function(J,he,xe){return!this.layout||he.isDataDriven()||xe.isDataDriven()?!1:C.hasPaintOverride(this.layout,J)},C.hasPaintOverride=function(J,he){var xe=J.get("text-field"),Te=Rh.paint.properties[he],Fe=!1,qe=function(Ft){for(var tr=0,Qt=Ft;tr<Qt.length;tr+=1){var dr=Qt[tr];if(Te.overrides&&Te.overrides.hasOverride(dr)){Fe=!0;return}}};if(xe.value.kind==="constant"&&xe.value.value instanceof Hi)qe(xe.value.value.sections);else if(xe.value.kind==="source"){var ft=function(Ft){if(!Fe)if(Ft instanceof Qi&&Di(Ft.value)===da){var tr=Ft.value;qe(tr.sections)}else Ft instanceof rs?qe(Ft.sections):Ft.eachChild(ft)},pt=xe.value;pt._styleExpression&&ft(pt._styleExpression.expression)}return Fe},C}(bs),z0=new ji({"background-color":new Ia(Vt.paint_background["background-color"]),"background-pattern":new ro(Vt.paint_background["background-pattern"]),"background-opacity":new Ia(Vt.paint_background["background-opacity"])}),F0={paint:z0},O0=function(E){function C(B){E.call(this,B,F0)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(bs),B0=new ji({"raster-opacity":new Ia(Vt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ia(Vt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ia(Vt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ia(Vt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ia(Vt.paint_raster["raster-saturation"]),"raster-contrast":new Ia(Vt.paint_raster["raster-contrast"]),"raster-resampling":new Ia(Vt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ia(Vt.paint_raster["raster-fade-duration"])}),N0={paint:B0},U0=function(E){function C(B){E.call(this,B,N0)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(bs);function V0(E){var C=[],B=E.id;return B===void 0&&C.push({message:"layers."+B+': missing required property "id"'}),E.render===void 0&&C.push({message:"layers."+B+': missing required method "render"'}),E.renderingMode&&E.renderingMode!=="2d"&&E.renderingMode!=="3d"&&C.push({message:"layers."+B+': property "renderingMode" must be either "2d" or "3d"'}),C}var H0=function(E){function C(B){E.call(this,B,{}),this.implementation=B}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},C.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},C.prototype.recalculate=function(){},C.prototype.updateTransitions=function(){},C.prototype.hasTransition=function(){},C.prototype.serialize=function(){},C.prototype.onAdd=function(J){this.implementation.onAdd&&this.implementation.onAdd(J,J.painter.context.gl)},C.prototype.onRemove=function(J){this.implementation.onRemove&&this.implementation.onRemove(J,J.painter.context.gl)},C}(bs),G0={circle:mp,heatmap:wp,hillshade:Mp,fill:Jp,"fill-extrusion":gd,line:Cd,symbol:I0,background:O0,raster:U0};function Y0(E){return E.type==="custom"?new H0(E):new G0[E.type](E)}var Bv=self.HTMLImageElement,Nv=self.HTMLCanvasElement,Uv=self.HTMLVideoElement,Vv=self.ImageData,Kc=self.ImageBitmap,Mf=function(C,B,J,he){this.context=C,this.format=J,this.texture=C.gl.createTexture(),this.update(B,he)};Mf.prototype.update=function(C,B,J){var he=C.width,xe=C.height,Te=(!this.size||this.size[0]!==he||this.size[1]!==xe)&&!J,Fe=this,qe=Fe.context,ft=qe.gl;if(this.useMipmap=Boolean(B&&B.useMipmap),ft.bindTexture(ft.TEXTURE_2D,this.texture),qe.pixelStoreUnpackFlipY.set(!1),qe.pixelStoreUnpack.set(1),qe.pixelStoreUnpackPremultiplyAlpha.set(this.format===ft.RGBA&&(!B||B.premultiply!==!1)),Te)this.size=[he,xe],C instanceof Bv||C instanceof Nv||C instanceof Uv||C instanceof Vv||Kc&&C instanceof Kc?ft.texImage2D(ft.TEXTURE_2D,0,this.format,this.format,ft.UNSIGNED_BYTE,C):ft.texImage2D(ft.TEXTURE_2D,0,this.format,he,xe,0,this.format,ft.UNSIGNED_BYTE,C.data);else{var pt=J||{x:0,y:0},Ft=pt.x,tr=pt.y;C instanceof Bv||C instanceof Nv||C instanceof Uv||C instanceof Vv||Kc&&C instanceof Kc?ft.texSubImage2D(ft.TEXTURE_2D,0,Ft,tr,ft.RGBA,ft.UNSIGNED_BYTE,C):ft.texSubImage2D(ft.TEXTURE_2D,0,Ft,tr,he,xe,ft.RGBA,ft.UNSIGNED_BYTE,C.data)}this.useMipmap&&this.isSizePowerOfTwo()&&ft.generateMipmap(ft.TEXTURE_2D)},Mf.prototype.bind=function(C,B,J){var he=this,xe=he.context,Te=xe.gl;Te.bindTexture(Te.TEXTURE_2D,this.texture),J===Te.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()&&(J=Te.LINEAR),C!==this.filter&&(Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MAG_FILTER,C),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MIN_FILTER,J||C),this.filter=C),B!==this.wrap&&(Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_S,B),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_T,B),this.wrap=B)},Mf.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0},Mf.prototype.destroy=function(){var C=this.context,B=C.gl;B.deleteTexture(this.texture),this.texture=null};var Ih=function(C){var B=this;this._callback=C,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){B._triggered=!1,B._callback()})};Ih.prototype.trigger=function(){var C=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){C._triggered=!1,C._callback()},0))},Ih.prototype.remove=function(){delete this._channel,this._callback=function(){}};var $f=function(C,B,J){this.target=C,this.parent=B,this.mapId=J,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},T(["receive","process"],this),this.invoker=new Ih(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=K()?C:self};$f.prototype.send=function(C,B,J,he,xe){var Te=this;xe===void 0&&(xe=!1);var Fe=Math.round(Math.random()*1e18).toString(36).substring(0,10);J&&(this.callbacks[Fe]=J);var qe=re(this.globalScope)?void 0:[];return this.target.postMessage({id:Fe,type:C,hasCallback:!!J,targetMapId:he,mustQueue:xe,sourceMapId:this.mapId,data:Pt(B,qe)},qe),{cancel:function(){J&&delete Te.callbacks[Fe],Te.target.postMessage({id:Fe,type:"<cancel>",targetMapId:he,sourceMapId:Te.mapId})}}},$f.prototype.receive=function(C){var B=C.data,J=B.id;if(!!J&&!(B.targetMapId&&this.mapId!==B.targetMapId))if(B.type==="<cancel>"){delete this.tasks[J];var he=this.cancelCallbacks[J];delete this.cancelCallbacks[J],he&&he()}else K()||B.mustQueue?(this.tasks[J]=B,this.taskQueue.push(J),this.invoker.trigger()):this.processTask(J,B)},$f.prototype.process=function(){if(!!this.taskQueue.length){var C=this.taskQueue.shift(),B=this.tasks[C];delete this.tasks[C],this.taskQueue.length&&this.invoker.trigger(),B&&this.processTask(C,B)}},$f.prototype.processTask=function(C,B){var J=this;if(B.type==="<response>"){var he=this.callbacks[C];delete this.callbacks[C],he&&(B.error?he(jt(B.error)):he(null,jt(B.data)))}else{var xe=!1,Te=re(this.globalScope)?void 0:[],Fe=B.hasCallback?function(tr,Qt){xe=!0,delete J.cancelCallbacks[C],J.target.postMessage({id:C,type:"<response>",sourceMapId:J.mapId,error:tr?Pt(tr):null,data:Pt(Qt,Te)},Te)}:function(tr){xe=!0},qe=null,ft=jt(B.data);if(this.parent[B.type])qe=this.parent[B.type](B.sourceMapId,ft,Fe);else if(this.parent.getWorkerSource){var pt=B.type.split("."),Ft=this.parent.getWorkerSource(B.sourceMapId,pt[0],ft.source);qe=Ft[pt[1]](ft,Fe)}else Fe(new Error("Could not find function "+B.type));!xe&&qe&&qe.cancel&&(this.cancelCallbacks[C]=qe.cancel)}},$f.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};function W0(E,C,B){C=Math.pow(2,B)-C-1;var J=Hv(E*256,C*256,B),he=Hv((E+1)*256,(C+1)*256,B);return J[0]+","+J[1]+","+he[0]+","+he[1]}function Hv(E,C,B){var J=2*Math.PI*6378137/256/Math.pow(2,B),he=E*J-2*Math.PI*6378137/2,xe=C*J-2*Math.PI*6378137/2;return[he,xe]}var Vo=function(C,B){C&&(B?this.setSouthWest(C).setNorthEast(B):C.length===4?this.setSouthWest([C[0],C[1]]).setNorthEast([C[2],C[3]]):this.setSouthWest(C[0]).setNorthEast(C[1]))};Vo.prototype.setNorthEast=function(C){return this._ne=C instanceof vo?new vo(C.lng,C.lat):vo.convert(C),this},Vo.prototype.setSouthWest=function(C){return this._sw=C instanceof vo?new vo(C.lng,C.lat):vo.convert(C),this},Vo.prototype.extend=function(C){var B=this._sw,J=this._ne,he,xe;if(C instanceof vo)he=C,xe=C;else if(C instanceof Vo){if(he=C._sw,xe=C._ne,!he||!xe)return this}else{if(Array.isArray(C))if(C.length===4||C.every(Array.isArray)){var Te=C;return this.extend(Vo.convert(Te))}else{var Fe=C;return this.extend(vo.convert(Fe))}return this}return!B&&!J?(this._sw=new vo(he.lng,he.lat),this._ne=new vo(xe.lng,xe.lat)):(B.lng=Math.min(he.lng,B.lng),B.lat=Math.min(he.lat,B.lat),J.lng=Math.max(xe.lng,J.lng),J.lat=Math.max(xe.lat,J.lat)),this},Vo.prototype.getCenter=function(){return new vo((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Vo.prototype.getSouthWest=function(){return this._sw},Vo.prototype.getNorthEast=function(){return this._ne},Vo.prototype.getNorthWest=function(){return new vo(this.getWest(),this.getNorth())},Vo.prototype.getSouthEast=function(){return new vo(this.getEast(),this.getSouth())},Vo.prototype.getWest=function(){return this._sw.lng},Vo.prototype.getSouth=function(){return this._sw.lat},Vo.prototype.getEast=function(){return this._ne.lng},Vo.prototype.getNorth=function(){return this._ne.lat},Vo.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Vo.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Vo.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Vo.prototype.contains=function(C){var B=vo.convert(C),J=B.lng,he=B.lat,xe=this._sw.lat<=he&&he<=this._ne.lat,Te=this._sw.lng<=J&&J<=this._ne.lng;return this._sw.lng>this._ne.lng&&(Te=this._sw.lng>=J&&J>=this._ne.lng),xe&&Te},Vo.convert=function(C){return!C||C instanceof Vo?C:new Vo(C)};var Gv=63710088e-1,vo=function(C,B){if(isNaN(C)||isNaN(B))throw new Error("Invalid LngLat object: ("+C+", "+B+")");if(this.lng=+C,this.lat=+B,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};vo.prototype.wrap=function(){return new vo(y(this.lng,-180,180),this.lat)},vo.prototype.toArray=function(){return[this.lng,this.lat]},vo.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},vo.prototype.distanceTo=function(C){var B=Math.PI/180,J=this.lat*B,he=C.lat*B,xe=Math.sin(J)*Math.sin(he)+Math.cos(J)*Math.cos(he)*Math.cos((C.lng-this.lng)*B),Te=Gv*Math.acos(Math.min(xe,1));return Te},vo.prototype.toBounds=function(C){C===void 0&&(C=0);var B=40075017,J=360*C/B,he=J/Math.cos(Math.PI/180*this.lat);return new Vo(new vo(this.lng-he,this.lat-J),new vo(this.lng+he,this.lat+J))},vo.convert=function(C){if(C instanceof vo)return C;if(Array.isArray(C)&&(C.length===2||C.length===3))return new vo(Number(C[0]),Number(C[1]));if(!Array.isArray(C)&&typeof C=="object"&&C!==null)return new vo(Number("lng"in C?C.lng:C.lon),Number(C.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Yv=2*Math.PI*Gv;function Wv(E){return Yv*Math.cos(E*Math.PI/180)}function Xv(E){return(180+E)/360}function Zv(E){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+E*Math.PI/360)))/360}function jv(E,C){return E/Wv(C)}function X0(E){return E*360-180}function zh(E){var C=180-E*360;return 360/Math.PI*Math.atan(Math.exp(C*Math.PI/180))-90}function Z0(E,C){return E*Wv(zh(C))}function j0(E){return 1/Math.cos(E*Math.PI/180)}var Sf=function(C,B,J){J===void 0&&(J=0),this.x=+C,this.y=+B,this.z=+J};Sf.fromLngLat=function(C,B){B===void 0&&(B=0);var J=vo.convert(C);return new Sf(Xv(J.lng),Zv(J.lat),jv(B,J.lat))},Sf.prototype.toLngLat=function(){return new vo(X0(this.x),zh(this.y))},Sf.prototype.toAltitude=function(){return Z0(this.z,this.y)},Sf.prototype.meterInMercatorCoordinateUnits=function(){return 1/Yv*j0(zh(this.y))};var kf=function(C,B,J){this.z=C,this.x=B,this.y=J,this.key=Ac(0,C,C,B,J)};kf.prototype.equals=function(C){return this.z===C.z&&this.x===C.x&&this.y===C.y},kf.prototype.url=function(C,B){var J=W0(this.x,this.y,this.z),he=K0(this.z,this.x,this.y);return C[(this.x+this.y)%C.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(B==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",he).replace("{bbox-epsg-3857}",J)},kf.prototype.getTilePoint=function(C){var B=Math.pow(2,this.z);return new c((C.x*B-this.x)*Ba,(C.y*B-this.y)*Ba)},kf.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Kv=function(C,B){this.wrap=C,this.canonical=B,this.key=Ac(C,B.z,B.z,B.x,B.y)},Ho=function(C,B,J,he,xe){this.overscaledZ=C,this.wrap=B,this.canonical=new kf(J,+he,+xe),this.key=Ac(B,C,J,he,xe)};Ho.prototype.equals=function(C){return this.overscaledZ===C.overscaledZ&&this.wrap===C.wrap&&this.canonical.equals(C.canonical)},Ho.prototype.scaledTo=function(C){var B=this.canonical.z-C;return C>this.canonical.z?new Ho(C,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ho(C,this.wrap,C,this.canonical.x>>B,this.canonical.y>>B)},Ho.prototype.calculateScaledKey=function(C,B){var J=this.canonical.z-C;return C>this.canonical.z?Ac(this.wrap*+B,C,this.canonical.z,this.canonical.x,this.canonical.y):Ac(this.wrap*+B,C,C,this.canonical.x>>J,this.canonical.y>>J)},Ho.prototype.isChildOf=function(C){if(C.wrap!==this.wrap)return!1;var B=this.canonical.z-C.canonical.z;return C.overscaledZ===0||C.overscaledZ<this.overscaledZ&&C.canonical.x===this.canonical.x>>B&&C.canonical.y===this.canonical.y>>B},Ho.prototype.children=function(C){if(this.overscaledZ>=C)return[new Ho(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var B=this.canonical.z+1,J=this.canonical.x*2,he=this.canonical.y*2;return[new Ho(B,this.wrap,B,J,he),new Ho(B,this.wrap,B,J+1,he),new Ho(B,this.wrap,B,J,he+1),new Ho(B,this.wrap,B,J+1,he+1)]},Ho.prototype.isLessThan=function(C){return this.wrap<C.wrap?!0:this.wrap>C.wrap?!1:this.overscaledZ<C.overscaledZ?!0:this.overscaledZ>C.overscaledZ?!1:this.canonical.x<C.canonical.x?!0:this.canonical.x>C.canonical.x?!1:this.canonical.y<C.canonical.y},Ho.prototype.wrapped=function(){return new Ho(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ho.prototype.unwrapTo=function(C){return new Ho(this.overscaledZ,C,this.canonical.z,this.canonical.x,this.canonical.y)},Ho.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ho.prototype.toUnwrapped=function(){return new Kv(this.wrap,this.canonical)},Ho.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ho.prototype.getTilePoint=function(C){return this.canonical.getTilePoint(new Sf(C.x-this.wrap,C.y))};function Ac(E,C,B,J,he){E*=2,E<0&&(E=E*-1-1);var xe=1<<B;return(xe*xe*E+xe*he+J).toString(36)+B.toString(36)+C.toString(36)}function K0(E,C,B){for(var J="",he,xe=E;xe>0;xe--)he=1<<xe-1,J+=(C&he?1:0)+(B&he?2:0);return J}Oe("CanonicalTileID",kf),Oe("OverscaledTileID",Ho,{omit:["posMatrix"]});var Ku=function(C,B,J){if(this.uid=C,B.height!==B.width)throw new RangeError("DEM tiles must be square");if(J&&J!=="mapbox"&&J!=="terrarium")return O('"'+J+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=B.height;var he=this.dim=B.height-2;this.data=new Uint32Array(B.data.buffer),this.encoding=J||"mapbox";for(var xe=0;xe<he;xe++)this.data[this._idx(-1,xe)]=this.data[this._idx(0,xe)],this.data[this._idx(he,xe)]=this.data[this._idx(he-1,xe)],this.data[this._idx(xe,-1)]=this.data[this._idx(xe,0)],this.data[this._idx(xe,he)]=this.data[this._idx(xe,he-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(he,-1)]=this.data[this._idx(he-1,0)],this.data[this._idx(-1,he)]=this.data[this._idx(0,he-1)],this.data[this._idx(he,he)]=this.data[this._idx(he-1,he-1)]};Ku.prototype.get=function(C,B){var J=new Uint8Array(this.data.buffer),he=this._idx(C,B)*4,xe=this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox;return xe(J[he],J[he+1],J[he+2])},Ku.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ku.prototype._idx=function(C,B){if(C<-1||C>=this.dim+1||B<-1||B>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(B+1)*this.stride+(C+1)},Ku.prototype._unpackMapbox=function(C,B,J){return(C*256*256+B*256+J)/10-1e4},Ku.prototype._unpackTerrarium=function(C,B,J){return C*256+B+J/256-32768},Ku.prototype.getPixels=function(){return new tl({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ku.prototype.backfillBorder=function(C,B,J){if(this.dim!==C.dim)throw new Error("dem dimension mismatch");var he=B*this.dim,xe=B*this.dim+this.dim,Te=J*this.dim,Fe=J*this.dim+this.dim;switch(B){case-1:he=xe-1;break;case 1:xe=he+1;break}switch(J){case-1:Te=Fe-1;break;case 1:Fe=Te+1;break}for(var qe=-B*this.dim,ft=-J*this.dim,pt=Te;pt<Fe;pt++)for(var Ft=he;Ft<xe;Ft++)this.data[this._idx(Ft,pt)]=C.data[this._idx(Ft+qe,pt+ft)]},Oe("DEMData",Ku);function J0(E,C){var B={};if(!C)return B;for(var J=function(){var Te=xe[he],Fe=Te.layerIds.map(function(Ft){return C.getLayer(Ft)}).filter(Boolean);if(Fe.length!==0){Te.layers=Fe,Te.stateDependentLayerIds&&(Te.stateDependentLayers=Te.stateDependentLayerIds.map(function(Ft){return Fe.filter(function(tr){return tr.id===Ft})[0]}));for(var qe=0,ft=Fe;qe<ft.length;qe+=1){var pt=ft[qe];B[pt.id]=Te}}},he=0,xe=E;he<xe.length;he+=1)J();return B}var Jc=function(C){this._stringToNumber={},this._numberToString=[];for(var B=0;B<C.length;B++){var J=C[B];this._stringToNumber[J]=B,this._numberToString[B]=J}};Jc.prototype.encode=function(C){return this._stringToNumber[C]},Jc.prototype.decode=function(C){return this._numberToString[C]};var Qc=function(C,B,J,he,xe){this.type="Feature",this._vectorTileFeature=C,C._z=B,C._x=J,C._y=he,this.properties=C.properties,this.id=xe},Fh={geometry:{configurable:!0}};Fh.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Fh.geometry.set=function(E){this._geometry=E},Qc.prototype.toJSON=function(){var C={geometry:this.geometry};for(var B in this)B==="_geometry"||B==="_vectorTileFeature"||(C[B]=this[B]);return C},Object.defineProperties(Qc.prototype,Fh);var qf=function(){this.state={},this.stateChanges={},this.deletedStates={}};qf.prototype.updateState=function(C,B,J){var he=String(B);if(this.stateChanges[C]=this.stateChanges[C]||{},this.stateChanges[C][he]=this.stateChanges[C][he]||{},w(this.stateChanges[C][he],J),this.deletedStates[C]===null){this.deletedStates[C]={};for(var xe in this.state[C])xe!==he&&(this.deletedStates[C][xe]=null)}else{var Te=this.deletedStates[C]&&this.deletedStates[C][he]===null;if(Te){this.deletedStates[C][he]={};for(var Fe in this.state[C][he])J[Fe]||(this.deletedStates[C][he][Fe]=null)}else for(var qe in J){var ft=this.deletedStates[C]&&this.deletedStates[C][he]&&this.deletedStates[C][he][qe]===null;ft&&delete this.deletedStates[C][he][qe]}}},qf.prototype.removeFeatureState=function(C,B,J){var he=this.deletedStates[C]===null;if(!he){var xe=String(B);if(this.deletedStates[C]=this.deletedStates[C]||{},J&&B!==void 0)this.deletedStates[C][xe]!==null&&(this.deletedStates[C][xe]=this.deletedStates[C][xe]||{},this.deletedStates[C][xe][J]=null);else if(B!==void 0){var Te=this.stateChanges[C]&&this.stateChanges[C][xe];if(Te){this.deletedStates[C][xe]={};for(J in this.stateChanges[C][xe])this.deletedStates[C][xe][J]=null}else this.deletedStates[C][xe]=null}else this.deletedStates[C]=null}},qf.prototype.getState=function(C,B){var J=String(B),he=this.state[C]||{},xe=this.stateChanges[C]||{},Te=w({},he[J],xe[J]);if(this.deletedStates[C]===null)return{};if(this.deletedStates[C]){var Fe=this.deletedStates[C][B];if(Fe===null)return{};for(var qe in Fe)delete Te[qe]}return Te},qf.prototype.initializeTileState=function(C,B){C.setFeatureState(this.state,B)},qf.prototype.coalesceChanges=function(C,B){var J={};for(var he in this.stateChanges){this.state[he]=this.state[he]||{};var xe={};for(var Te in this.stateChanges[he])this.state[he][Te]||(this.state[he][Te]={}),w(this.state[he][Te],this.stateChanges[he][Te]),xe[Te]=this.state[he][Te];J[he]=xe}for(var Fe in this.deletedStates){this.state[Fe]=this.state[Fe]||{};var qe={};if(this.deletedStates[Fe]===null)for(var ft in this.state[Fe])qe[ft]={},this.state[Fe][ft]={};else for(var pt in this.deletedStates[Fe]){var Ft=this.deletedStates[Fe][pt]===null;if(Ft)this.state[Fe][pt]={};else for(var tr=0,Qt=Object.keys(this.deletedStates[Fe][pt]);tr<Qt.length;tr+=1){var dr=Qt[tr];delete this.state[Fe][pt][dr]}qe[pt]=this.state[Fe][pt]}J[Fe]=J[Fe]||{},w(J[Fe],qe)}if(this.stateChanges={},this.deletedStates={},Object.keys(J).length!==0)for(var Fr in C){var on=C[Fr];on.setFeatureState(J,B)}};var Ju=function(C,B){this.tileID=C,this.x=C.canonical.x,this.y=C.canonical.y,this.z=C.canonical.z,this.grid=new Do(Ba,16,0),this.grid3D=new Do(Ba,16,0),this.featureIndexArray=new uc,this.promoteId=B};Ju.prototype.insert=function(C,B,J,he,xe,Te){var Fe=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(J,he,xe);for(var qe=Te?this.grid3D:this.grid,ft=0;ft<B.length;ft++){for(var pt=B[ft],Ft=[1/0,1/0,-1/0,-1/0],tr=0;tr<pt.length;tr++){var Qt=pt[tr];Ft[0]=Math.min(Ft[0],Qt.x),Ft[1]=Math.min(Ft[1],Qt.y),Ft[2]=Math.max(Ft[2],Qt.x),Ft[3]=Math.max(Ft[3],Qt.y)}Ft[0]<Ba&&Ft[1]<Ba&&Ft[2]>=0&&Ft[3]>=0&&qe.insert(Fe,Ft[0],Ft[1],Ft[2],Ft[3])}},Ju.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Vf.VectorTile(new Uc(this.rawTileData)).layers,this.sourceLayerCoder=new Jc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ju.prototype.query=function(C,B,J,he){var xe=this;this.loadVTLayers();for(var Te=C.params||{},Fe=Ba/C.tileSize/C.scale,qe=Fu(Te.filter),ft=C.queryGeometry,pt=C.queryPadding*Fe,Ft=Qv(ft),tr=this.grid.query(Ft.minX-pt,Ft.minY-pt,Ft.maxX+pt,Ft.maxY+pt),Qt=Qv(C.cameraQueryGeometry),dr=this.grid3D.query(Qt.minX-pt,Qt.minY-pt,Qt.maxX+pt,Qt.maxY+pt,function(Gn,oa,na,Ra){return Hu(C.cameraQueryGeometry,Gn-pt,oa-pt,na+pt,Ra+pt)}),Fr=0,on=dr;Fr<on.length;Fr+=1){var $r=on[Fr];tr.push($r)}tr.sort(Q0);for(var kn={},mn,Sn=function(Gn){var oa=tr[Gn];if(oa!==mn){mn=oa;var na=xe.featureIndexArray.get(oa),Ra=null;xe.loadMatchingFeature(kn,na.bucketIndex,na.sourceLayerIndex,na.featureIndex,qe,Te.layers,Te.availableImages,B,J,he,function(wa,Sa,ti){return Ra||(Ra=Ui(wa)),Sa.queryIntersectsFeature(ft,wa,ti,Ra,xe.z,C.transform,Fe,C.pixelPosMatrix)})}},In=0;In<tr.length;In++)Sn(In);return kn},Ju.prototype.loadMatchingFeature=function(C,B,J,he,xe,Te,Fe,qe,ft,pt,Ft){var tr=this.bucketLayerIDs[B];if(!(Te&&!D(Te,tr))){var Qt=this.sourceLayerCoder.decode(J),dr=this.vtLayers[Qt],Fr=dr.feature(he);if(!!xe.filter(new si(this.tileID.overscaledZ),Fr))for(var on=this.getId(Fr,Qt),$r=0;$r<tr.length;$r++){var kn=tr[$r];if(!(Te&&Te.indexOf(kn)<0)){var mn=qe[kn];if(!!mn){var Sn={};on!==void 0&&pt&&(Sn=pt.getState(mn.sourceLayer||"_geojsonTileLayer",on));var In=ft[kn];In.paint=Jv(In.paint,mn.paint,Fr,Sn,Fe),In.layout=Jv(In.layout,mn.layout,Fr,Sn,Fe);var Gn=!Ft||Ft(Fr,mn,Sn);if(!!Gn){var oa=new Qc(Fr,this.z,this.x,this.y,on);oa.layer=In;var na=C[kn];na===void 0&&(na=C[kn]=[]),na.push({featureIndex:he,feature:oa,intersectionZ:Gn})}}}}}},Ju.prototype.lookupSymbolFeatures=function(C,B,J,he,xe,Te,Fe,qe){var ft={};this.loadVTLayers();for(var pt=Fu(xe),Ft=0,tr=C;Ft<tr.length;Ft+=1){var Qt=tr[Ft];this.loadMatchingFeature(ft,J,he,Qt,pt,Te,Fe,qe,B)}return ft},Ju.prototype.hasLayer=function(C){for(var B=0,J=this.bucketLayerIDs;B<J.length;B+=1)for(var he=J[B],xe=0,Te=he;xe<Te.length;xe+=1){var Fe=Te[xe];if(C===Fe)return!0}return!1},Ju.prototype.getId=function(C,B){var J=C.id;if(this.promoteId){var he=typeof this.promoteId=="string"?this.promoteId:this.promoteId[B];J=C.properties[he],typeof J=="boolean"&&(J=Number(J))}return J},Oe("FeatureIndex",Ju,{omit:["rawTileData","sourceLayerCoder"]});function Jv(E,C,B,J,he){return P(E,function(xe,Te){var Fe=C instanceof Ni?C.get(Te):null;return Fe&&Fe.evaluate?Fe.evaluate(B,J,he):Fe})}function Qv(E){for(var C=1/0,B=1/0,J=-1/0,he=-1/0,xe=0,Te=E;xe<Te.length;xe+=1){var Fe=Te[xe];C=Math.min(C,Fe.x),B=Math.min(B,Fe.y),J=Math.max(J,Fe.x),he=Math.max(he,Fe.y)}return{minX:C,minY:B,maxX:J,maxY:he}}function Q0(E,C){return C-E}var $0=3e4,qo=function(C,B){this.tileID=C,this.uid=b(),this.uses=0,this.tileSize=B,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};qo.prototype.registerFadeDuration=function(C){var B=C+this.timeAdded;B<Q.now()||this.fadeEndTime&&B<this.fadeEndTime||(this.fadeEndTime=B)},qo.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},qo.prototype.loadVectorData=function(C,B,J){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",!C){this.collisionBoxArray=new Vu;return}C.featureIndex&&(this.latestFeatureIndex=C.featureIndex,C.rawTileData?(this.latestRawTileData=C.rawTileData,this.latestFeatureIndex.rawTileData=C.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=C.collisionBoxArray,this.buckets=J0(C.buckets,B.style),this.hasSymbolBuckets=!1;for(var he in this.buckets){var xe=this.buckets[he];if(xe instanceof Xi)if(this.hasSymbolBuckets=!0,J)xe.justReloaded=!0;else break}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var Te in this.buckets){var Fe=this.buckets[Te];if(Fe instanceof Xi&&Fe.hasRTLText){this.hasRTLText=!0,Si();break}}this.queryPadding=0;for(var qe in this.buckets){var ft=this.buckets[qe];this.queryPadding=Math.max(this.queryPadding,B.style.getLayer(qe).queryRadius(ft))}C.imageAtlas&&(this.imageAtlas=C.imageAtlas),C.glyphAtlasImage&&(this.glyphAtlasImage=C.glyphAtlasImage)},qo.prototype.unloadVectorData=function(){for(var C in this.buckets)this.buckets[C].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},qo.prototype.getBucket=function(C){return this.buckets[C.id]},qo.prototype.upload=function(C){for(var B in this.buckets){var J=this.buckets[B];J.uploadPending()&&J.upload(C)}var he=C.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Mf(C,this.imageAtlas.image,he.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Mf(C,this.glyphAtlasImage,he.ALPHA),this.glyphAtlasImage=null)},qo.prototype.prepare=function(C){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(C,this.imageAtlasTexture)},qo.prototype.queryRenderedFeatures=function(C,B,J,he,xe,Te,Fe,qe,ft,pt){return!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData?{}:this.latestFeatureIndex.query({queryGeometry:he,cameraQueryGeometry:xe,scale:Te,tileSize:this.tileSize,pixelPosMatrix:pt,transform:qe,params:Fe,queryPadding:this.queryPadding*ft},C,B,J)},qo.prototype.querySourceFeatures=function(C,B){var J=this.latestFeatureIndex;if(!(!J||!J.rawTileData)){var he=J.loadVTLayers(),xe=B?B.sourceLayer:"",Te=he._geojsonTileLayer||he[xe];if(!!Te)for(var Fe=Fu(B&&B.filter),qe=this.tileID.canonical,ft=qe.z,pt=qe.x,Ft=qe.y,tr={z:ft,x:pt,y:Ft},Qt=0;Qt<Te.length;Qt++){var dr=Te.feature(Qt);if(Fe.filter(new si(this.tileID.overscaledZ),dr)){var Fr=J.getId(dr,xe),on=new Qc(dr,ft,pt,Ft,Fr);on.tile=tr,C.push(on)}}}},qo.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},qo.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},qo.prototype.setExpiryData=function(C){var B=this.expirationTime;if(C.cacheControl){var J=W(C.cacheControl);J["max-age"]&&(this.expirationTime=Date.now()+J["max-age"]*1e3)}else C.expires&&(this.expirationTime=new Date(C.expires).getTime());if(this.expirationTime){var he=Date.now(),xe=!1;if(this.expirationTime>he)xe=!1;else if(!B)xe=!0;else if(this.expirationTime<B)xe=!0;else{var Te=this.expirationTime-B;Te?this.expirationTime=he+Math.max(Te,$0):xe=!0}xe?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},qo.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},qo.prototype.setFeatureState=function(C,B){if(!(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(C).length===0)){var J=this.latestFeatureIndex.loadVTLayers();for(var he in this.buckets)if(!!B.style.hasLayer(he)){var xe=this.buckets[he],Te=xe.layers[0].sourceLayer||"_geojsonTileLayer",Fe=J[Te],qe=C[Te];if(!(!Fe||!qe||Object.keys(qe).length===0)){xe.update(qe,Fe,this.imageAtlas&&this.imageAtlas.patternPositions||{});var ft=B&&B.style&&B.style.getLayer(he);ft&&(this.queryPadding=Math.max(this.queryPadding,ft.queryRadius(xe)))}}}},qo.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},qo.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Q.now()},qo.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},qo.prototype.setHoldDuration=function(C){this.symbolFadeHoldUntil=Q.now()+C},qo.prototype.setDependencies=function(C,B){for(var J={},he=0,xe=B;he<xe.length;he+=1){var Te=xe[he];J[Te]=!0}this.dependencies[C]=J},qo.prototype.hasDependency=function(C,B){for(var J=0,he=C;J<he.length;J+=1){var xe=he[J],Te=this.dependencies[xe];if(Te)for(var Fe=0,qe=B;Fe<qe.length;Fe+=1){var ft=qe[Fe];if(Te[ft])return!0}}return!1};var q0=["type","source","source-layer","minzoom","maxzoom","filter","layout"],hf=self.performance,$v=function(C){this._marks={start:[C.url,"start"].join("#"),end:[C.url,"end"].join("#"),measure:C.url.toString()},hf.mark(this._marks.start)};$v.prototype.finish=function(){hf.mark(this._marks.end);var C=hf.getEntriesByName(this._marks.measure);return C.length===0&&(hf.measure(this._marks.measure,this._marks.start,this._marks.end),C=hf.getEntriesByName(this._marks.measure),hf.clearMarks(this._marks.start),hf.clearMarks(this._marks.end),hf.clearMeasures(this._marks.measure)),C},e.Actor=$f,e.AlphaImage=Af,e.CanonicalTileID=kf,e.CollisionBoxArray=Vu,e.Color=vi,e.DEMData=Ku,e.DataConstantProperty=Ia,e.DictionaryCoder=Jc,e.EXTENT=Ba,e.ErrorEvent=br,e.EvaluationParameters=si,e.Event=kr,e.Evented=Ar,e.FeatureIndex=Ju,e.FillBucket=wu,e.FillExtrusionBucket=Tu,e.ImageAtlas=bc,e.ImagePosition=Hc,e.LineBucket=rl,e.LngLat=vo,e.LngLatBounds=Vo,e.MercatorCoordinate=Sf,e.ONE_EM=vs,e.OverscaledTileID=Ho,e.Point=c,e.Point$1=c,e.Properties=ji,e.Protobuf=Uc,e.RGBAImage=tl,e.RequestManager=Ee,e.RequestPerformance=$v,e.ResourceType=at,e.SegmentVector=H,e.SourceFeatureState=qf,e.StructArrayLayout1ui2=of,e.StructArrayLayout2f1f2i16=xu,e.StructArrayLayout2i4=yf,e.StructArrayLayout3ui6=bu,e.StructArrayLayout4i8=Ou,e.SymbolBucket=Xi,e.Texture=Mf,e.Tile=qo,e.Transitionable=mo,e.Uniform1f=Ur,e.Uniform1i=Yr,e.Uniform2f=Jr,e.Uniform3f=hn,e.Uniform4f=Cn,e.UniformColor=Fn,e.UniformMatrix4f=qn,e.UnwrappedTileID=Kv,e.ValidationError=hr,e.WritingMode=El,e.ZoomHistory=qt,e.add=Bf,e.addDynamicAttributes=Dh,e.asyncAll=o,e.bezier=p,e.bindAll=T,e.browser=Q,e.cacheEntryPossiblyAdded=Xt,e.clamp=f,e.clearTileCache=ar,e.clipLine=Dv,e.clone=Rc,e.clone$1=I,e.clone$2=ch,e.collisionCircleLayout=Rd,e.config=ie,e.create=zf,e.create$1=wf,e.create$2=_f,e.createCommonjsModule=a,e.createExpression=Bl,e.createLayout=Io,e.createStyleLayer=Y0,e.cross=up,e.deepEqual=i,e.dot=lp,e.dot$1=pp,e.ease=v,e.emitValidationErrors=yo,e.endsWith=k,e.enforceCacheSizeLimit=Ht,e.evaluateSizeForFeature=Mv,e.evaluateSizeForZoom=Sv,e.evaluateVariableOffset=zv,e.evented=yi,e.extend=w,e.featureFilter=Fu,e.filterObject=z,e.fromRotation=If,e.getAnchorAlignment=Eh,e.getAnchorJustification=Ph,e.getArrayBuffer=lt,e.getImage=dt,e.getJSON=it,e.getRTLTextPluginStatus=ho,e.getReferrer=Zt,e.getVideo=Ct,e.identity=Ff,e.invert=lf,e.isChar=er,e.isMapboxURL=Pe,e.keysDifference=l,e.makeRequest=Je,e.mapObject=P,e.mercatorXfromLng=Xv,e.mercatorYfromLat=Zv,e.mercatorZfromAltitude=jv,e.mul=fh,e.multiply=uf,e.mvt=Vf,e.normalize=cc,e.number=lo,e.offscreenCanvasSupported=jr,e.ortho=uh,e.parseGlyphPBF=o0,e.pbf=Uc,e.performSymbolLayout=A0,e.perspective=fc,e.pick=_,e.plugin=Xa,e.polygonIntersectsPolygon=ii,e.postMapLoadEvent=St,e.postTurnstileEvent=Yt,e.potpack=yv,e.refProperties=q0,e.register=Oe,e.registerForPluginStateChange=zi,e.rotate=Cs,e.rotateX=el,e.rotateZ=Of,e.scale=qs,e.scale$1=vp,e.scale$2=vh,e.setCacheLimits=Vr,e.setRTLTextPlugin=fa,e.sphericalToCartesian=G,e.sqrLen=yp,e.styleSpec=Vt,e.sub=cp,e.symbolSize=d0,e.transformMat3=fp,e.transformMat4=Ic,e.translate=Lo,e.triggerPluginCompletionEvent=Pa,e.uniqueId=b,e.validateCustomStyleLayer=V0,e.validateLight=bi,e.validateStyle=wo,e.values=m,e.vectorTile=Vf,e.version=n,e.warnOnce=O,e.webpSupported=se,e.window=self,e.wrap=y}),M(["./shared"],function(e){function a($e){var Je=typeof $e;if(Je==="number"||Je==="boolean"||Je==="string"||$e===void 0||$e===null)return JSON.stringify($e);if(Array.isArray($e)){for(var it="[",lt=0,Tt=$e;lt<Tt.length;lt+=1){var Bt=Tt[lt];it+=a(Bt)+","}return it+"]"}for(var Ce=Object.keys($e).sort(),Me="{",nt=0;nt<Ce.length;nt++)Me+=JSON.stringify(Ce[nt])+":"+a($e[Ce[nt]])+",";return Me+"}"}function n($e){for(var Je="",it=0,lt=e.refProperties;it<lt.length;it+=1){var Tt=lt[it];Je+="/"+a($e[Tt])}return Je}function r($e,Je){for(var it={},lt=0;lt<$e.length;lt++){var Tt=Je&&Je[$e[lt].id]||n($e[lt]);Je&&(Je[$e[lt].id]=Tt);var Bt=it[Tt];Bt||(Bt=it[Tt]=[]),Bt.push($e[lt])}var Ce=[];for(var Me in it)Ce.push(it[Me]);return Ce}var t=function(Je){this.keyCache={},Je&&this.replace(Je)};t.prototype.replace=function(Je){this._layerConfigs={},this._layers={},this.update(Je,[])},t.prototype.update=function(Je,it){for(var lt=this,Tt=0,Bt=Je;Tt<Bt.length;Tt+=1){var Ce=Bt[Tt];this._layerConfigs[Ce.id]=Ce;var Me=this._layers[Ce.id]=e.createStyleLayer(Ce);Me._featureFilter=e.featureFilter(Me.filter),this.keyCache[Ce.id]&&delete this.keyCache[Ce.id]}for(var nt=0,st=it;nt<st.length;nt+=1){var ct=st[nt];delete this.keyCache[ct],delete this._layerConfigs[ct],delete this._layers[ct]}this.familiesBySource={};for(var At=r(e.values(this._layerConfigs),this.keyCache),dt=0,Ct=At;dt<Ct.length;dt+=1){var Gt=Ct[dt],rr=Gt.map(function(yr){return lt._layers[yr.id]}),kr=rr[0];if(kr.visibility!=="none"){var br=kr.source||"",Ar=this.familiesBySource[br];Ar||(Ar=this.familiesBySource[br]={});var Wr=kr.sourceLayer||"_geojsonTileLayer",nr=Ar[Wr];nr||(nr=Ar[Wr]=[]),nr.push(rr)}}};var c=1,s=function(Je){var it={},lt=[];for(var Tt in Je){var Bt=Je[Tt],Ce=it[Tt]={};for(var Me in Bt){var nt=Bt[+Me];if(!(!nt||nt.bitmap.width===0||nt.bitmap.height===0)){var st={x:0,y:0,w:nt.bitmap.width+2*c,h:nt.bitmap.height+2*c};lt.push(st),Ce[Me]={rect:st,metrics:nt.metrics}}}}var ct=e.potpack(lt),At=ct.w,dt=ct.h,Ct=new e.AlphaImage({width:At||1,height:dt||1});for(var Gt in Je){var rr=Je[Gt];for(var kr in rr){var br=rr[+kr];if(!(!br||br.bitmap.width===0||br.bitmap.height===0)){var Ar=it[Gt][kr].rect;e.AlphaImage.copy(br.bitmap,Ct,{x:0,y:0},{x:Ar.x+c,y:Ar.y+c},br.bitmap)}}}this.image=Ct,this.positions=it};e.register("GlyphAtlas",s);var i=function(Je){this.tileID=new e.OverscaledTileID(Je.tileID.overscaledZ,Je.tileID.wrap,Je.tileID.canonical.z,Je.tileID.canonical.x,Je.tileID.canonical.y),this.uid=Je.uid,this.zoom=Je.zoom,this.pixelRatio=Je.pixelRatio,this.tileSize=Je.tileSize,this.source=Je.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Je.showCollisionBoxes,this.collectResourceTiming=!!Je.collectResourceTiming,this.returnDependencies=!!Je.returnDependencies,this.promoteId=Je.promoteId};i.prototype.parse=function(Je,it,lt,Tt,Bt){var Ce=this;this.status="parsing",this.data=Je,this.collisionBoxArray=new e.CollisionBoxArray;var Me=new e.DictionaryCoder(Object.keys(Je.layers).sort()),nt=new e.FeatureIndex(this.tileID,this.promoteId);nt.bucketLayerIDs=[];var st={},ct={featureIndex:nt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:lt},At=it.familiesBySource[this.source];for(var dt in At){var Ct=Je.layers[dt];if(!!Ct){Ct.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+dt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Gt=Me.encode(dt),rr=[],kr=0;kr<Ct.length;kr++){var br=Ct.feature(kr),Ar=nt.getId(br,dt);rr.push({feature:br,id:Ar,index:kr,sourceLayerIndex:Gt})}for(var Wr=0,nr=At[dt];Wr<nr.length;Wr+=1){var yr=nr[Wr],Pr=yr[0];if(!(Pr.minzoom&&this.zoom<Math.floor(Pr.minzoom))&&!(Pr.maxzoom&&this.zoom>=Pr.maxzoom)&&Pr.visibility!=="none"){x(yr,this.zoom,lt);var Or=st[Pr.id]=Pr.createBucket({index:nt.bucketLayerIDs.length,layers:yr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Gt,sourceID:this.source});Or.populate(rr,ct,this.tileID.canonical),nt.bucketLayerIDs.push(yr.map(function(_r){return _r.id}))}}}}var Sr,tt,Lt,Wt,ir=e.mapObject(ct.glyphDependencies,function(_r){return Object.keys(_r).map(Number)});Object.keys(ir).length?Tt.send("getGlyphs",{uid:this.uid,stacks:ir},function(_r,Gr){Sr||(Sr=_r,tt=Gr,Er.call(Ce))}):tt={};var Ir=Object.keys(ct.iconDependencies);Ir.length?Tt.send("getImages",{icons:Ir,source:this.source,tileID:this.tileID,type:"icons"},function(_r,Gr){Sr||(Sr=_r,Lt=Gr,Er.call(Ce))}):Lt={};var Br=Object.keys(ct.patternDependencies);Br.length?Tt.send("getImages",{icons:Br,source:this.source,tileID:this.tileID,type:"patterns"},function(_r,Gr){Sr||(Sr=_r,Wt=Gr,Er.call(Ce))}):Wt={},Er.call(this);function Er(){if(Sr)return Bt(Sr);if(tt&&Lt&&Wt){var _r=new s(tt),Gr=new e.ImageAtlas(Lt,Wt);for(var wn in st){var cn=st[wn];cn instanceof e.SymbolBucket?(x(cn.layers,this.zoom,lt),e.performSymbolLayout(cn,tt,_r.positions,Lt,Gr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):cn.hasPattern&&(cn instanceof e.LineBucket||cn instanceof e.FillBucket||cn instanceof e.FillExtrusionBucket)&&(x(cn.layers,this.zoom,lt),cn.addFeatures(ct,this.tileID.canonical,Gr.patternPositions))}this.status="done",Bt(null,{buckets:e.values(st).filter(function(Bn){return!Bn.isEmpty()}),featureIndex:nt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:_r.image,imageAtlas:Gr,glyphMap:this.returnDependencies?tt:null,iconMap:this.returnDependencies?Lt:null,glyphPositions:this.returnDependencies?_r.positions:null})}}};function x($e,Je,it){for(var lt=new e.EvaluationParameters(Je),Tt=0,Bt=$e;Tt<Bt.length;Tt+=1){var Ce=Bt[Tt];Ce.recalculate(lt,it)}}function p($e,Je){var it=e.getArrayBuffer($e.request,function(lt,Tt,Bt,Ce){lt?Je(lt):Tt&&Je(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(Tt)),rawData:Tt,cacheControl:Bt,expires:Ce})});return function(){it.cancel(),Je()}}var v=function(Je,it,lt,Tt){this.actor=Je,this.layerIndex=it,this.availableImages=lt,this.loadVectorData=Tt||p,this.loading={},this.loaded={}};v.prototype.loadTile=function(Je,it){var lt=this,Tt=Je.uid;this.loading||(this.loading={});var Bt=Je&&Je.request&&Je.request.collectResourceTiming?new e.RequestPerformance(Je.request):!1,Ce=this.loading[Tt]=new i(Je);Ce.abort=this.loadVectorData(Je,function(Me,nt){if(delete lt.loading[Tt],Me||!nt)return Ce.status="done",lt.loaded[Tt]=Ce,it(Me);var st=nt.rawData,ct={};nt.expires&&(ct.expires=nt.expires),nt.cacheControl&&(ct.cacheControl=nt.cacheControl);var At={};if(Bt){var dt=Bt.finish();dt&&(At.resourceTiming=JSON.parse(JSON.stringify(dt)))}Ce.vectorTile=nt.vectorTile,Ce.parse(nt.vectorTile,lt.layerIndex,lt.availableImages,lt.actor,function(Ct,Gt){if(Ct||!Gt)return it(Ct);it(null,e.extend({rawTileData:st.slice(0)},Gt,ct,At))}),lt.loaded=lt.loaded||{},lt.loaded[Tt]=Ce})},v.prototype.reloadTile=function(Je,it){var lt=this,Tt=this.loaded,Bt=Je.uid,Ce=this;if(Tt&&Tt[Bt]){var Me=Tt[Bt];Me.showCollisionBoxes=Je.showCollisionBoxes;var nt=function(st,ct){var At=Me.reloadCallback;At&&(delete Me.reloadCallback,Me.parse(Me.vectorTile,Ce.layerIndex,lt.availableImages,Ce.actor,At)),it(st,ct)};Me.status==="parsing"?Me.reloadCallback=nt:Me.status==="done"&&(Me.vectorTile?Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,nt):nt())}},v.prototype.abortTile=function(Je,it){var lt=this.loading,Tt=Je.uid;lt&&lt[Tt]&&lt[Tt].abort&&(lt[Tt].abort(),delete lt[Tt]),it()},v.prototype.removeTile=function(Je,it){var lt=this.loaded,Tt=Je.uid;lt&&lt[Tt]&&delete lt[Tt],it()};var f=e.window.ImageBitmap,y=function(){this.loaded={}};y.prototype.loadTile=function(Je,it){var lt=Je.uid,Tt=Je.encoding,Bt=Je.rawImageData,Ce=f&&Bt instanceof f?this.getImageData(Bt):Bt,Me=new e.DEMData(lt,Ce,Tt);this.loaded=this.loaded||{},this.loaded[lt]=Me,it(null,Me)},y.prototype.getImageData=function(Je){(!this.offscreenCanvas||!this.offscreenCanvasContext)&&(this.offscreenCanvas=new OffscreenCanvas(Je.width,Je.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Je.width,this.offscreenCanvas.height=Je.height,this.offscreenCanvasContext.drawImage(Je,0,0,Je.width,Je.height);var it=this.offscreenCanvasContext.getImageData(-1,-1,Je.width+2,Je.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:it.width,height:it.height},it.data)},y.prototype.removeTile=function(Je){var it=this.loaded,lt=Je.uid;it&&it[lt]&&delete it[lt]};var o=m;function m($e,Je){var it=$e&&$e.type,lt;if(it==="FeatureCollection")for(lt=0;lt<$e.features.length;lt++)m($e.features[lt],Je);else if(it==="GeometryCollection")for(lt=0;lt<$e.geometries.length;lt++)m($e.geometries[lt],Je);else if(it==="Feature")m($e.geometry,Je);else if(it==="Polygon")l($e.coordinates,Je);else if(it==="MultiPolygon")for(lt=0;lt<$e.coordinates.length;lt++)l($e.coordinates[lt],Je);return $e}function l($e,Je){if($e.length!==0){w($e[0],Je);for(var it=1;it<$e.length;it++)w($e[it],!Je)}}function w($e,Je){for(var it=0,lt=0,Tt=$e.length,Bt=Tt-1;lt<Tt;Bt=lt++)it+=($e[lt][0]-$e[Bt][0])*($e[Bt][1]+$e[lt][1]);it>=0!=!!Je&&$e.reverse()}var _=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,h=function(Je){this._feature=Je,this.extent=e.EXTENT,this.type=Je.type,this.properties=Je.tags,"id"in Je&&!isNaN(Je.id)&&(this.id=parseInt(Je.id,10))};h.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Je=[],it=0,lt=this._feature.geometry;it<lt.length;it+=1){var Tt=lt[it];Je.push([new e.Point$1(Tt[0],Tt[1])])}return Je}else{for(var Bt=[],Ce=0,Me=this._feature.geometry;Ce<Me.length;Ce+=1){for(var nt=Me[Ce],st=[],ct=0,At=nt;ct<At.length;ct+=1){var dt=At[ct];st.push(new e.Point$1(dt[0],dt[1]))}Bt.push(st)}return Bt}},h.prototype.toGeoJSON=function(Je,it,lt){return _.call(this,Je,it,lt)};var b=function(Je){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=Je.length,this._features=Je};b.prototype.feature=function(Je){return new h(this._features[Je])};var u=e.vectorTile.VectorTileFeature,L=T;function T($e,Je){this.options=Je||{},this.features=$e,this.length=$e.length}T.prototype.feature=function($e){return new k(this.features[$e],this.options.extent)};function k($e,Je){this.id=typeof $e.id=="number"?$e.id:void 0,this.type=$e.type,this.rawGeometry=$e.type===1?[$e.geometry]:$e.geometry,this.properties=$e.tags,this.extent=Je||4096}k.prototype.loadGeometry=function(){var $e=this.rawGeometry;this.geometry=[];for(var Je=0;Je<$e.length;Je++){for(var it=$e[Je],lt=[],Tt=0;Tt<it.length;Tt++)lt.push(new e.Point$1(it[Tt][0],it[Tt][1]));this.geometry.push(lt)}return this.geometry},k.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var $e=this.geometry,Je=1/0,it=-1/0,lt=1/0,Tt=-1/0,Bt=0;Bt<$e.length;Bt++)for(var Ce=$e[Bt],Me=0;Me<Ce.length;Me++){var nt=Ce[Me];Je=Math.min(Je,nt.x),it=Math.max(it,nt.x),lt=Math.min(lt,nt.y),Tt=Math.max(Tt,nt.y)}return[Je,lt,it,Tt]},k.prototype.toGeoJSON=u.prototype.toGeoJSON;var P=R,z=R,I=O,D=L;function R($e){var Je=new e.pbf;return F($e,Je),Je.finish()}function O($e,Je){Je=Je||{};var it={};for(var lt in $e)it[lt]=new L($e[lt].features,Je),it[lt].name=lt,it[lt].version=Je.version,it[lt].extent=Je.extent;return R({layers:it})}function F($e,Je){for(var it in $e.layers)Je.writeMessage(3,N,$e.layers[it])}function N($e,Je){Je.writeVarintField(15,$e.version||1),Je.writeStringField(1,$e.name||""),Je.writeVarintField(5,$e.extent||4096);var it,lt={keys:[],values:[],keycache:{},valuecache:{}};for(it=0;it<$e.length;it++)lt.feature=$e.feature(it),Je.writeMessage(2,G,lt);var Tt=lt.keys;for(it=0;it<Tt.length;it++)Je.writeStringField(3,Tt[it]);var Bt=lt.values;for(it=0;it<Bt.length;it++)Je.writeMessage(4,ue,Bt[it])}function G($e,Je){var it=$e.feature;it.id!==void 0&&Je.writeVarintField(1,it.id),Je.writeMessage(2,K,$e),Je.writeVarintField(3,it.type),Je.writeMessage(4,re,it)}function K($e,Je){var it=$e.feature,lt=$e.keys,Tt=$e.values,Bt=$e.keycache,Ce=$e.valuecache;for(var Me in it.properties){var nt=Bt[Me];typeof nt>"u"&&(lt.push(Me),nt=lt.length-1,Bt[Me]=nt),Je.writeVarint(nt);var st=it.properties[Me],ct=typeof st;ct!=="string"&&ct!=="boolean"&&ct!=="number"&&(st=JSON.stringify(st));var At=ct+":"+st,dt=Ce[At];typeof dt>"u"&&(Tt.push(st),dt=Tt.length-1,Ce[At]=dt),Je.writeVarint(dt)}}function W($e,Je){return(Je<<3)+($e&7)}function Y($e){return $e<<1^$e>>31}function re($e,Je){for(var it=$e.loadGeometry(),lt=$e.type,Tt=0,Bt=0,Ce=it.length,Me=0;Me<Ce;Me++){var nt=it[Me],st=1;lt===1&&(st=nt.length),Je.writeVarint(W(1,st));for(var ct=lt===3?nt.length-1:nt.length,At=0;At<ct;At++){At===1&&lt!==1&&Je.writeVarint(W(2,ct-1));var dt=nt[At].x-Tt,Ct=nt[At].y-Bt;Je.writeVarint(Y(dt)),Je.writeVarint(Y(Ct)),Tt+=dt,Bt+=Ct}lt===3&&Je.writeVarint(W(7,1))}}function ue($e,Je){var it=typeof $e;it==="string"?Je.writeStringField(1,$e):it==="boolean"?Je.writeBooleanField(7,$e):it==="number"&&($e%1!==0?Je.writeDoubleField(3,$e):$e<0?Je.writeSVarintField(6,$e):Je.writeVarintField(5,$e))}P.fromVectorTileJs=z,P.fromGeojsonVt=I,P.GeoJSONWrapper=D;function j($e,Je,it,lt,Tt,Bt){if(!(Tt-lt<=it)){var Ce=lt+Tt>>1;q($e,Je,Ce,lt,Tt,Bt%2),j($e,Je,it,lt,Ce-1,Bt+1),j($e,Je,it,Ce+1,Tt,Bt+1)}}function q($e,Je,it,lt,Tt,Bt){for(;Tt>lt;){if(Tt-lt>600){var Ce=Tt-lt+1,Me=it-lt+1,nt=Math.log(Ce),st=.5*Math.exp(2*nt/3),ct=.5*Math.sqrt(nt*st*(Ce-st)/Ce)*(Me-Ce/2<0?-1:1),At=Math.max(lt,Math.floor(it-Me*st/Ce+ct)),dt=Math.min(Tt,Math.floor(it+(Ce-Me)*st/Ce+ct));q($e,Je,it,At,dt,Bt)}var Ct=Je[2*it+Bt],Gt=lt,rr=Tt;for(V($e,Je,lt,it),Je[2*Tt+Bt]>Ct&&V($e,Je,lt,Tt);Gt<rr;){for(V($e,Je,Gt,rr),Gt++,rr--;Je[2*Gt+Bt]<Ct;)Gt++;for(;Je[2*rr+Bt]>Ct;)rr--}Je[2*lt+Bt]===Ct?V($e,Je,lt,rr):(rr++,V($e,Je,rr,Tt)),rr<=it&&(lt=rr+1),it<=rr&&(Tt=rr-1)}}function V($e,Je,it,lt){U($e,it,lt),U(Je,2*it,2*lt),U(Je,2*it+1,2*lt+1)}function U($e,Je,it){var lt=$e[Je];$e[Je]=$e[it],$e[it]=lt}function $($e,Je,it,lt,Tt,Bt,Ce){for(var Me=[0,$e.length-1,0],nt=[],st,ct;Me.length;){var At=Me.pop(),dt=Me.pop(),Ct=Me.pop();if(dt-Ct<=Ce){for(var Gt=Ct;Gt<=dt;Gt++)st=Je[2*Gt],ct=Je[2*Gt+1],st>=it&&st<=Tt&&ct>=lt&&ct<=Bt&&nt.push($e[Gt]);continue}var rr=Math.floor((Ct+dt)/2);st=Je[2*rr],ct=Je[2*rr+1],st>=it&&st<=Tt&&ct>=lt&&ct<=Bt&&nt.push($e[rr]);var kr=(At+1)%2;(At===0?it<=st:lt<=ct)&&(Me.push(Ct),Me.push(rr-1),Me.push(kr)),(At===0?Tt>=st:Bt>=ct)&&(Me.push(rr+1),Me.push(dt),Me.push(kr))}return nt}function ne($e,Je,it,lt,Tt,Bt){for(var Ce=[0,$e.length-1,0],Me=[],nt=Tt*Tt;Ce.length;){var st=Ce.pop(),ct=Ce.pop(),At=Ce.pop();if(ct-At<=Bt){for(var dt=At;dt<=ct;dt++)X(Je[2*dt],Je[2*dt+1],it,lt)<=nt&&Me.push($e[dt]);continue}var Ct=Math.floor((At+ct)/2),Gt=Je[2*Ct],rr=Je[2*Ct+1];X(Gt,rr,it,lt)<=nt&&Me.push($e[Ct]);var kr=(st+1)%2;(st===0?it-Tt<=Gt:lt-Tt<=rr)&&(Ce.push(At),Ce.push(Ct-1),Ce.push(kr)),(st===0?it+Tt>=Gt:lt+Tt>=rr)&&(Ce.push(Ct+1),Ce.push(ct),Ce.push(kr))}return Me}function X($e,Je,it,lt){var Tt=$e-it,Bt=Je-lt;return Tt*Tt+Bt*Bt}var Q=function($e){return $e[0]},ie=function($e){return $e[1]},se=function(Je,it,lt,Tt,Bt){it===void 0&&(it=Q),lt===void 0&&(lt=ie),Tt===void 0&&(Tt=64),Bt===void 0&&(Bt=Float64Array),this.nodeSize=Tt,this.points=Je;for(var Ce=Je.length<65536?Uint16Array:Uint32Array,Me=this.ids=new Ce(Je.length),nt=this.coords=new Bt(Je.length*2),st=0;st<Je.length;st++)Me[st]=st,nt[2*st]=it(Je[st]),nt[2*st+1]=lt(Je[st]);j(Me,nt,Tt,0,Me.length-1,0)};se.prototype.range=function(Je,it,lt,Tt){return $(this.ids,this.coords,Je,it,lt,Tt,this.nodeSize)},se.prototype.within=function(Je,it,lt){return ne(this.ids,this.coords,Je,it,lt,this.nodeSize)};var ae={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function($e){return $e}},oe=function(Je){this.options=Ne(Object.create(ae),Je),this.trees=new Array(this.options.maxZoom+1)};oe.prototype.load=function(Je){var it=this.options,lt=it.log,Tt=it.minZoom,Bt=it.maxZoom,Ce=it.nodeSize;lt&&console.time("total time");var Me="prepare "+Je.length+" points";lt&&console.time(Me),this.points=Je;for(var nt=[],st=0;st<Je.length;st++)!Je[st].geometry||nt.push(ce(Je[st],st));this.trees[Bt+1]=new se(nt,we,ke,Ce,Float32Array),lt&&console.timeEnd(Me);for(var ct=Bt;ct>=Tt;ct--){var At=+Date.now();nt=this._cluster(nt,ct),this.trees[ct]=new se(nt,we,ke,Ce,Float32Array),lt&&console.log("z%d: %d clusters in %dms",ct,nt.length,+Date.now()-At)}return lt&&console.timeEnd("total time"),this},oe.prototype.getClusters=function(Je,it){var lt=((Je[0]+180)%360+360)%360-180,Tt=Math.max(-90,Math.min(90,Je[1])),Bt=Je[2]===180?180:((Je[2]+180)%360+360)%360-180,Ce=Math.max(-90,Math.min(90,Je[3]));if(Je[2]-Je[0]>=360)lt=-180,Bt=180;else if(lt>Bt){var Me=this.getClusters([lt,Tt,180,Ce],it),nt=this.getClusters([-180,Tt,Bt,Ce],it);return Me.concat(nt)}for(var st=this.trees[this._limitZoom(it)],ct=st.range(ge(lt),me(Ce),ge(Bt),me(Tt)),At=[],dt=0,Ct=ct;dt<Ct.length;dt+=1){var Gt=Ct[dt],rr=st.points[Gt];At.push(rr.numPoints?de(rr):this.points[rr.index])}return At},oe.prototype.getChildren=function(Je){var it=this._getOriginId(Je),lt=this._getOriginZoom(Je),Tt="No cluster with the specified id.",Bt=this.trees[lt];if(!Bt)throw new Error(Tt);var Ce=Bt.points[it];if(!Ce)throw new Error(Tt);for(var Me=this.options.radius/(this.options.extent*Math.pow(2,lt-1)),nt=Bt.within(Ce.x,Ce.y,Me),st=[],ct=0,At=nt;ct<At.length;ct+=1){var dt=At[ct],Ct=Bt.points[dt];Ct.parentId===Je&&st.push(Ct.numPoints?de(Ct):this.points[Ct.index])}if(st.length===0)throw new Error(Tt);return st},oe.prototype.getLeaves=function(Je,it,lt){it=it||10,lt=lt||0;var Tt=[];return this._appendLeaves(Tt,Je,it,lt,0),Tt},oe.prototype.getTile=function(Je,it,lt){var Tt=this.trees[this._limitZoom(Je)],Bt=Math.pow(2,Je),Ce=this.options,Me=Ce.extent,nt=Ce.radius,st=nt/Me,ct=(lt-st)/Bt,At=(lt+1+st)/Bt,dt={features:[]};return this._addTileFeatures(Tt.range((it-st)/Bt,ct,(it+1+st)/Bt,At),Tt.points,it,lt,Bt,dt),it===0&&this._addTileFeatures(Tt.range(1-st/Bt,ct,1,At),Tt.points,Bt,lt,Bt,dt),it===Bt-1&&this._addTileFeatures(Tt.range(0,ct,st/Bt,At),Tt.points,-1,lt,Bt,dt),dt.features.length?dt:null},oe.prototype.getClusterExpansionZoom=function(Je){for(var it=this._getOriginZoom(Je)-1;it<=this.options.maxZoom;){var lt=this.getChildren(Je);if(it++,lt.length!==1)break;Je=lt[0].properties.cluster_id}return it},oe.prototype._appendLeaves=function(Je,it,lt,Tt,Bt){for(var Ce=this.getChildren(it),Me=0,nt=Ce;Me<nt.length;Me+=1){var st=nt[Me],ct=st.properties;if(ct&&ct.cluster?Bt+ct.point_count<=Tt?Bt+=ct.point_count:Bt=this._appendLeaves(Je,ct.cluster_id,lt,Tt,Bt):Bt<Tt?Bt++:Je.push(st),Je.length===lt)break}return Bt},oe.prototype._addTileFeatures=function(Je,it,lt,Tt,Bt,Ce){for(var Me=0,nt=Je;Me<nt.length;Me+=1){var st=nt[Me],ct=it[st],At=ct.numPoints,dt={type:1,geometry:[[Math.round(this.options.extent*(ct.x*Bt-lt)),Math.round(this.options.extent*(ct.y*Bt-Tt))]],tags:At?ye(ct):this.points[ct.index].properties},Ct=void 0;At?Ct=ct.id:this.options.generateId?Ct=ct.index:this.points[ct.index].id&&(Ct=this.points[ct.index].id),Ct!==void 0&&(dt.id=Ct),Ce.features.push(dt)}},oe.prototype._limitZoom=function(Je){return Math.max(this.options.minZoom,Math.min(Je,this.options.maxZoom+1))},oe.prototype._cluster=function(Je,it){for(var lt=[],Tt=this.options,Bt=Tt.radius,Ce=Tt.extent,Me=Tt.reduce,nt=Bt/(Ce*Math.pow(2,it)),st=0;st<Je.length;st++){var ct=Je[st];if(!(ct.zoom<=it)){ct.zoom=it;for(var At=this.trees[it+1],dt=At.within(ct.x,ct.y,nt),Ct=ct.numPoints||1,Gt=ct.x*Ct,rr=ct.y*Ct,kr=Me&&Ct>1?this._map(ct,!0):null,br=(st<<5)+(it+1)+this.points.length,Ar=0,Wr=dt;Ar<Wr.length;Ar+=1){var nr=Wr[Ar],yr=At.points[nr];if(!(yr.zoom<=it)){yr.zoom=it;var Pr=yr.numPoints||1;Gt+=yr.x*Pr,rr+=yr.y*Pr,Ct+=Pr,yr.parentId=br,Me&&(kr||(kr=this._map(ct,!0)),Me(kr,this._map(yr)))}}Ct===1?lt.push(ct):(ct.parentId=br,lt.push(be(Gt/Ct,rr/Ct,br,Ct,kr)))}}return lt},oe.prototype._getOriginId=function(Je){return Je-this.points.length>>5},oe.prototype._getOriginZoom=function(Je){return(Je-this.points.length)%32},oe.prototype._map=function(Je,it){if(Je.numPoints)return it?Ne({},Je.properties):Je.properties;var lt=this.points[Je.index].properties,Tt=this.options.map(lt);return it&&Tt===lt?Ne({},Tt):Tt};function be($e,Je,it,lt,Tt){return{x:$e,y:Je,zoom:1/0,id:it,parentId:-1,numPoints:lt,properties:Tt}}function ce($e,Je){var it=$e.geometry.coordinates,lt=it[0],Tt=it[1];return{x:ge(lt),y:me(Tt),zoom:1/0,index:Je,parentId:-1}}function de($e){return{type:"Feature",id:$e.id,properties:ye($e),geometry:{type:"Point",coordinates:[Ee($e.x),Pe($e.y)]}}}function ye($e){var Je=$e.numPoints,it=Je>=1e4?Math.round(Je/1e3)+"k":Je>=1e3?Math.round(Je/100)/10+"k":Je;return Ne(Ne({},$e.properties),{cluster:!0,cluster_id:$e.id,point_count:Je,point_count_abbreviated:it})}function ge($e){return $e/360+.5}function me($e){var Je=Math.sin($e*Math.PI/180),it=.5-.25*Math.log((1+Je)/(1-Je))/Math.PI;return it<0?0:it>1?1:it}function Ee($e){return($e-.5)*360}function Pe($e){var Je=(180-$e*360)*Math.PI/180;return 360*Math.atan(Math.exp(Je))/Math.PI-90}function Ne($e,Je){for(var it in Je)$e[it]=Je[it];return $e}function we($e){return $e.x}function ke($e){return $e.y}function Xe($e,Je,it,lt){for(var Tt=lt,Bt=it-Je>>1,Ce=it-Je,Me,nt=$e[Je],st=$e[Je+1],ct=$e[it],At=$e[it+1],dt=Je+3;dt<it;dt+=3){var Ct=He($e[dt],$e[dt+1],nt,st,ct,At);if(Ct>Tt)Me=dt,Tt=Ct;else if(Ct===Tt){var Gt=Math.abs(dt-Bt);Gt<Ce&&(Me=dt,Ce=Gt)}}Tt>lt&&(Me-Je>3&&Xe($e,Je,Me,lt),$e[Me+2]=Tt,it-Me>3&&Xe($e,Me,it,lt))}function He($e,Je,it,lt,Tt,Bt){var Ce=Tt-it,Me=Bt-lt;if(Ce!==0||Me!==0){var nt=(($e-it)*Ce+(Je-lt)*Me)/(Ce*Ce+Me*Me);nt>1?(it=Tt,lt=Bt):nt>0&&(it+=Ce*nt,lt+=Me*nt)}return Ce=$e-it,Me=Je-lt,Ce*Ce+Me*Me}function Ie($e,Je,it,lt){var Tt={id:typeof $e>"u"?null:$e,type:Je,geometry:it,tags:lt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return De(Tt),Tt}function De($e){var Je=$e.geometry,it=$e.type;if(it==="Point"||it==="MultiPoint"||it==="LineString")Ge($e,Je);else if(it==="Polygon"||it==="MultiLineString")for(var lt=0;lt<Je.length;lt++)Ge($e,Je[lt]);else if(it==="MultiPolygon")for(lt=0;lt<Je.length;lt++)for(var Tt=0;Tt<Je[lt].length;Tt++)Ge($e,Je[lt][Tt])}function Ge($e,Je){for(var it=0;it<Je.length;it+=3)$e.minX=Math.min($e.minX,Je[it]),$e.minY=Math.min($e.minY,Je[it+1]),$e.maxX=Math.max($e.maxX,Je[it]),$e.maxY=Math.max($e.maxY,Je[it+1])}function ht($e,Je){var it=[];if($e.type==="FeatureCollection")for(var lt=0;lt<$e.features.length;lt++)Rt(it,$e.features[lt],Je,lt);else $e.type==="Feature"?Rt(it,$e,Je):Rt(it,{geometry:$e},Je);return it}function Rt($e,Je,it,lt){if(!!Je.geometry){var Tt=Je.geometry.coordinates,Bt=Je.geometry.type,Ce=Math.pow(it.tolerance/((1<<it.maxZoom)*it.extent),2),Me=[],nt=Je.id;if(it.promoteId?nt=Je.properties[it.promoteId]:it.generateId&&(nt=lt||0),Bt==="Point")Kt(Tt,Me);else if(Bt==="MultiPoint")for(var st=0;st<Tt.length;st++)Kt(Tt[st],Me);else if(Bt==="LineString")It(Tt,Me,Ce,!1);else if(Bt==="MultiLineString")if(it.lineMetrics){for(st=0;st<Tt.length;st++)Me=[],It(Tt[st],Me,Ce,!1),$e.push(Ie(nt,"LineString",Me,Je.properties));return}else Mt(Tt,Me,Ce,!1);else if(Bt==="Polygon")Mt(Tt,Me,Ce,!0);else if(Bt==="MultiPolygon")for(st=0;st<Tt.length;st++){var ct=[];Mt(Tt[st],ct,Ce,!0),Me.push(ct)}else if(Bt==="GeometryCollection"){for(st=0;st<Je.geometry.geometries.length;st++)Rt($e,{id:nt,geometry:Je.geometry.geometries[st],properties:Je.properties},it,lt);return}else throw new Error("Input data is not a valid GeoJSON object.");$e.push(Ie(nt,Bt,Me,Je.properties))}}function Kt($e,Je){Je.push(Yt($e[0])),Je.push(zt($e[1])),Je.push(0)}function It($e,Je,it,lt){for(var Tt,Bt,Ce=0,Me=0;Me<$e.length;Me++){var nt=Yt($e[Me][0]),st=zt($e[Me][1]);Je.push(nt),Je.push(st),Je.push(0),Me>0&&(lt?Ce+=(Tt*st-nt*Bt)/2:Ce+=Math.sqrt(Math.pow(nt-Tt,2)+Math.pow(st-Bt,2))),Tt=nt,Bt=st}var ct=Je.length-3;Je[2]=1,Xe(Je,0,ct,it),Je[ct+2]=1,Je.size=Math.abs(Ce),Je.start=0,Je.end=Je.size}function Mt($e,Je,it,lt){for(var Tt=0;Tt<$e.length;Tt++){var Bt=[];It($e[Tt],Bt,it,lt),Je.push(Bt)}}function Yt($e){return $e/360+.5}function zt($e){var Je=Math.sin($e*Math.PI/180),it=.5-.25*Math.log((1+Je)/(1-Je))/Math.PI;return it<0?0:it>1?1:it}function St($e,Je,it,lt,Tt,Bt,Ce,Me){if(it/=Je,lt/=Je,Bt>=it&&Ce<lt)return $e;if(Ce<it||Bt>=lt)return null;for(var nt=[],st=0;st<$e.length;st++){var ct=$e[st],At=ct.geometry,dt=ct.type,Ct=Tt===0?ct.minX:ct.minY,Gt=Tt===0?ct.maxX:ct.maxY;if(Ct>=it&&Gt<lt){nt.push(ct);continue}else if(Gt<it||Ct>=lt)continue;var rr=[];if(dt==="Point"||dt==="MultiPoint")Ye(At,rr,it,lt,Tt);else if(dt==="LineString")rt(At,rr,it,lt,Tt,!1,Me.lineMetrics);else if(dt==="MultiLineString")Ae(At,rr,it,lt,Tt,!1);else if(dt==="Polygon")Ae(At,rr,it,lt,Tt,!0);else if(dt==="MultiPolygon")for(var kr=0;kr<At.length;kr++){var br=[];Ae(At[kr],br,it,lt,Tt,!0),br.length&&rr.push(br)}if(rr.length){if(Me.lineMetrics&&dt==="LineString"){for(kr=0;kr<rr.length;kr++)nt.push(Ie(ct.id,dt,rr[kr],ct.tags));continue}(dt==="LineString"||dt==="MultiLineString")&&(rr.length===1?(dt="LineString",rr=rr[0]):dt="MultiLineString"),(dt==="Point"||dt==="MultiPoint")&&(dt=rr.length===3?"Point":"MultiPoint"),nt.push(Ie(ct.id,dt,rr,ct.tags))}}return nt.length?nt:null}function Ye($e,Je,it,lt,Tt){for(var Bt=0;Bt<$e.length;Bt+=3){var Ce=$e[Bt+Tt];Ce>=it&&Ce<=lt&&(Je.push($e[Bt]),Je.push($e[Bt+1]),Je.push($e[Bt+2]))}}function rt($e,Je,it,lt,Tt,Bt,Ce){for(var Me=Ve($e),nt=Tt===0?Ze:Qe,st=$e.start,ct,At,dt=0;dt<$e.length-3;dt+=3){var Ct=$e[dt],Gt=$e[dt+1],rr=$e[dt+2],kr=$e[dt+3],br=$e[dt+4],Ar=Tt===0?Ct:Gt,Wr=Tt===0?kr:br,nr=!1;Ce&&(ct=Math.sqrt(Math.pow(Ct-kr,2)+Math.pow(Gt-br,2))),Ar<it?Wr>it&&(At=nt(Me,Ct,Gt,kr,br,it),Ce&&(Me.start=st+ct*At)):Ar>lt?Wr<lt&&(At=nt(Me,Ct,Gt,kr,br,lt),Ce&&(Me.start=st+ct*At)):Ue(Me,Ct,Gt,rr),Wr<it&&Ar>=it&&(At=nt(Me,Ct,Gt,kr,br,it),nr=!0),Wr>lt&&Ar<=lt&&(At=nt(Me,Ct,Gt,kr,br,lt),nr=!0),!Bt&&nr&&(Ce&&(Me.end=st+ct*At),Je.push(Me),Me=Ve($e)),Ce&&(st+=ct)}var yr=$e.length-3;Ct=$e[yr],Gt=$e[yr+1],rr=$e[yr+2],Ar=Tt===0?Ct:Gt,Ar>=it&&Ar<=lt&&Ue(Me,Ct,Gt,rr),yr=Me.length-3,Bt&&yr>=3&&(Me[yr]!==Me[0]||Me[yr+1]!==Me[1])&&Ue(Me,Me[0],Me[1],Me[2]),Me.length&&Je.push(Me)}function Ve($e){var Je=[];return Je.size=$e.size,Je.start=$e.start,Je.end=$e.end,Je}function Ae($e,Je,it,lt,Tt,Bt){for(var Ce=0;Ce<$e.length;Ce++)rt($e[Ce],Je,it,lt,Tt,Bt,!1)}function Ue($e,Je,it,lt){$e.push(Je),$e.push(it),$e.push(lt)}function Ze($e,Je,it,lt,Tt,Bt){var Ce=(Bt-Je)/(lt-Je);return $e.push(Bt),$e.push(it+(Tt-it)*Ce),$e.push(1),Ce}function Qe($e,Je,it,lt,Tt,Bt){var Ce=(Bt-it)/(Tt-it);return $e.push(Je+(lt-Je)*Ce),$e.push(Bt),$e.push(1),Ce}function _t($e,Je){var it=Je.buffer/Je.extent,lt=$e,Tt=St($e,1,-1-it,it,0,-1,2,Je),Bt=St($e,1,1-it,2+it,0,-1,2,Je);return(Tt||Bt)&&(lt=St($e,1,-it,1+it,0,-1,2,Je)||[],Tt&&(lt=gt(Tt,1).concat(lt)),Bt&&(lt=lt.concat(gt(Bt,-1)))),lt}function gt($e,Je){for(var it=[],lt=0;lt<$e.length;lt++){var Tt=$e[lt],Bt=Tt.type,Ce;if(Bt==="Point"||Bt==="MultiPoint"||Bt==="LineString")Ce=wt(Tt.geometry,Je);else if(Bt==="MultiLineString"||Bt==="Polygon"){Ce=[];for(var Me=0;Me<Tt.geometry.length;Me++)Ce.push(wt(Tt.geometry[Me],Je))}else if(Bt==="MultiPolygon")for(Ce=[],Me=0;Me<Tt.geometry.length;Me++){for(var nt=[],st=0;st<Tt.geometry[Me].length;st++)nt.push(wt(Tt.geometry[Me][st],Je));Ce.push(nt)}it.push(Ie(Tt.id,Bt,Ce,Tt.tags))}return it}function wt($e,Je){var it=[];it.size=$e.size,$e.start!==void 0&&(it.start=$e.start,it.end=$e.end);for(var lt=0;lt<$e.length;lt+=3)it.push($e[lt]+Je,$e[lt+1],$e[lt+2]);return it}function Ut($e,Je){if($e.transformed)return $e;var it=1<<$e.z,lt=$e.x,Tt=$e.y,Bt,Ce,Me;for(Bt=0;Bt<$e.features.length;Bt++){var nt=$e.features[Bt],st=nt.geometry,ct=nt.type;if(nt.geometry=[],ct===1)for(Ce=0;Ce<st.length;Ce+=2)nt.geometry.push(Dt(st[Ce],st[Ce+1],Je,it,lt,Tt));else for(Ce=0;Ce<st.length;Ce++){var At=[];for(Me=0;Me<st[Ce].length;Me+=2)At.push(Dt(st[Ce][Me],st[Ce][Me+1],Je,it,lt,Tt));nt.geometry.push(At)}}return $e.transformed=!0,$e}function Dt($e,Je,it,lt,Tt,Bt){return[Math.round(it*($e*lt-Tt)),Math.round(it*(Je*lt-Bt))]}function Nt($e,Je,it,lt,Tt){for(var Bt=Je===Tt.maxZoom?0:Tt.tolerance/((1<<Je)*Tt.extent),Ce={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:it,y:lt,z:Je,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Me=0;Me<$e.length;Me++){Ce.numFeatures++,Xt(Ce,$e[Me],Bt,Tt);var nt=$e[Me].minX,st=$e[Me].minY,ct=$e[Me].maxX,At=$e[Me].maxY;nt<Ce.minX&&(Ce.minX=nt),st<Ce.minY&&(Ce.minY=st),ct>Ce.maxX&&(Ce.maxX=ct),At>Ce.maxY&&(Ce.maxY=At)}return Ce}function Xt($e,Je,it,lt){var Tt=Je.geometry,Bt=Je.type,Ce=[];if(Bt==="Point"||Bt==="MultiPoint")for(var Me=0;Me<Tt.length;Me+=3)Ce.push(Tt[Me]),Ce.push(Tt[Me+1]),$e.numPoints++,$e.numSimplified++;else if(Bt==="LineString")Ht(Ce,Tt,$e,it,!1,!1);else if(Bt==="MultiLineString"||Bt==="Polygon")for(Me=0;Me<Tt.length;Me++)Ht(Ce,Tt[Me],$e,it,Bt==="Polygon",Me===0);else if(Bt==="MultiPolygon")for(var nt=0;nt<Tt.length;nt++){var st=Tt[nt];for(Me=0;Me<st.length;Me++)Ht(Ce,st[Me],$e,it,!0,Me===0)}if(Ce.length){var ct=Je.tags||null;if(Bt==="LineString"&&lt.lineMetrics){ct={};for(var At in Je.tags)ct[At]=Je.tags[At];ct.mapbox_clip_start=Tt.start/Tt.size,ct.mapbox_clip_end=Tt.end/Tt.size}var dt={geometry:Ce,type:Bt==="Polygon"||Bt==="MultiPolygon"?3:Bt==="LineString"||Bt==="MultiLineString"?2:1,tags:ct};Je.id!==null&&(dt.id=Je.id),$e.features.push(dt)}}function Ht($e,Je,it,lt,Tt,Bt){var Ce=lt*lt;if(lt>0&&Je.size<(Tt?Ce:lt)){it.numPoints+=Je.length/3;return}for(var Me=[],nt=0;nt<Je.length;nt+=3)(lt===0||Je[nt+2]>Ce)&&(it.numSimplified++,Me.push(Je[nt]),Me.push(Je[nt+1])),it.numPoints++;Tt&&ar(Me,Bt),$e.push(Me)}function ar($e,Je){for(var it=0,lt=0,Tt=$e.length,Bt=Tt-2;lt<Tt;Bt=lt,lt+=2)it+=($e[lt]-$e[Bt])*($e[lt+1]+$e[Bt+1]);if(it>0===Je)for(lt=0,Tt=$e.length;lt<Tt/2;lt+=2){var Ce=$e[lt],Me=$e[lt+1];$e[lt]=$e[Tt-2-lt],$e[lt+1]=$e[Tt-1-lt],$e[Tt-2-lt]=Ce,$e[Tt-1-lt]=Me}}function Vr($e,Je){return new nn($e,Je)}function nn($e,Je){Je=this.options=at(Object.create(this.options),Je);var it=Je.debug;if(it&&console.time("preprocess data"),Je.maxZoom<0||Je.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Je.promoteId&&Je.generateId)throw new Error("promoteId and generateId cannot be used together.");var lt=ht($e,Je);this.tiles={},this.tileCoords=[],it&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Je.indexMaxZoom,Je.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),lt=_t(lt,Je),lt.length&&this.splitTile(lt,0,0,0),it&&(lt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}nn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},nn.prototype.splitTile=function($e,Je,it,lt,Tt,Bt,Ce){for(var Me=[$e,Je,it,lt],nt=this.options,st=nt.debug;Me.length;){lt=Me.pop(),it=Me.pop(),Je=Me.pop(),$e=Me.pop();var ct=1<<Je,At=jr(Je,it,lt),dt=this.tiles[At];if(!dt&&(st>1&&console.time("creation"),dt=this.tiles[At]=Nt($e,Je,it,lt,nt),this.tileCoords.push({z:Je,x:it,y:lt}),st)){st>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Je,it,lt,dt.numFeatures,dt.numPoints,dt.numSimplified),console.timeEnd("creation"));var Ct="z"+Je;this.stats[Ct]=(this.stats[Ct]||0)+1,this.total++}if(dt.source=$e,Tt){if(Je===nt.maxZoom||Je===Tt)continue;var Gt=1<<Tt-Je;if(it!==Math.floor(Bt/Gt)||lt!==Math.floor(Ce/Gt))continue}else if(Je===nt.indexMaxZoom||dt.numPoints<=nt.indexMaxPoints)continue;if(dt.source=null,$e.length!==0){st>1&&console.time("clipping");var rr=.5*nt.buffer/nt.extent,kr=.5-rr,br=.5+rr,Ar=1+rr,Wr,nr,yr,Pr,Or,Sr;Wr=nr=yr=Pr=null,Or=St($e,ct,it-rr,it+br,0,dt.minX,dt.maxX,nt),Sr=St($e,ct,it+kr,it+Ar,0,dt.minX,dt.maxX,nt),$e=null,Or&&(Wr=St(Or,ct,lt-rr,lt+br,1,dt.minY,dt.maxY,nt),nr=St(Or,ct,lt+kr,lt+Ar,1,dt.minY,dt.maxY,nt),Or=null),Sr&&(yr=St(Sr,ct,lt-rr,lt+br,1,dt.minY,dt.maxY,nt),Pr=St(Sr,ct,lt+kr,lt+Ar,1,dt.minY,dt.maxY,nt),Sr=null),st>1&&console.timeEnd("clipping"),Me.push(Wr||[],Je+1,it*2,lt*2),Me.push(nr||[],Je+1,it*2,lt*2+1),Me.push(yr||[],Je+1,it*2+1,lt*2),Me.push(Pr||[],Je+1,it*2+1,lt*2+1)}}},nn.prototype.getTile=function($e,Je,it){var lt=this.options,Tt=lt.extent,Bt=lt.debug;if($e<0||$e>24)return null;var Ce=1<<$e;Je=(Je%Ce+Ce)%Ce;var Me=jr($e,Je,it);if(this.tiles[Me])return Ut(this.tiles[Me],Tt);Bt>1&&console.log("drilling down to z%d-%d-%d",$e,Je,it);for(var nt=$e,st=Je,ct=it,At;!At&&nt>0;)nt--,st=Math.floor(st/2),ct=Math.floor(ct/2),At=this.tiles[jr(nt,st,ct)];return!At||!At.source?null:(Bt>1&&console.log("found parent tile z%d-%d-%d",nt,st,ct),Bt>1&&console.time("drilling down"),this.splitTile(At.source,nt,st,ct,$e,Je,it),Bt>1&&console.timeEnd("drilling down"),this.tiles[Me]?Ut(this.tiles[Me],Tt):null)};function jr($e,Je,it){return((1<<$e)*it+Je)*32+$e}function at($e,Je){for(var it in Je)$e[it]=Je[it];return $e}function $t($e,Je){var it=$e.tileID.canonical;if(!this._geoJSONIndex)return Je(null,null);var lt=this._geoJSONIndex.getTile(it.z,it.x,it.y);if(!lt)return Je(null,null);var Tt=new b(lt.features),Bt=P(Tt);(Bt.byteOffset!==0||Bt.byteLength!==Bt.buffer.byteLength)&&(Bt=new Uint8Array(Bt)),Je(null,{vectorTile:Tt,rawData:Bt.buffer})}var Zt=function($e){function Je(it,lt,Tt,Bt){$e.call(this,it,lt,Tt,$t),Bt&&(this.loadGeoJSON=Bt)}return $e&&(Je.__proto__=$e),Je.prototype=Object.create($e&&$e.prototype),Je.prototype.constructor=Je,Je.prototype.loadData=function(lt,Tt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Tt,this._pendingLoadDataParams=lt,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Je.prototype._loadData=function(){var lt=this;if(!(!this._pendingCallback||!this._pendingLoadDataParams)){var Tt=this._pendingCallback,Bt=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Ce=Bt&&Bt.request&&Bt.request.collectResourceTiming?new e.RequestPerformance(Bt.request):!1;this.loadGeoJSON(Bt,function(Me,nt){if(Me||!nt)return Tt(Me);if(typeof nt!="object")return Tt(new Error("Input data given to '"+Bt.source+"' is not a valid GeoJSON object."));o(nt,!0);try{lt._geoJSONIndex=Bt.cluster?new oe(ur(Bt)).load(nt.features):Vr(nt,Bt.geojsonVtOptions)}catch(At){return Tt(At)}lt.loaded={};var st={};if(Ce){var ct=Ce.finish();ct&&(st.resourceTiming={},st.resourceTiming[Bt.source]=JSON.parse(JSON.stringify(ct)))}Tt(null,st)})}},Je.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Je.prototype.reloadTile=function(lt,Tt){var Bt=this.loaded,Ce=lt.uid;return Bt&&Bt[Ce]?$e.prototype.reloadTile.call(this,lt,Tt):this.loadTile(lt,Tt)},Je.prototype.loadGeoJSON=function(lt,Tt){if(lt.request)e.getJSON(lt.request,Tt);else if(typeof lt.data=="string")try{return Tt(null,JSON.parse(lt.data))}catch{return Tt(new Error("Input data given to '"+lt.source+"' is not a valid GeoJSON object."))}else return Tt(new Error("Input data given to '"+lt.source+"' is not a valid GeoJSON object."))},Je.prototype.removeSource=function(lt,Tt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Tt()},Je.prototype.getClusterExpansionZoom=function(lt,Tt){try{Tt(null,this._geoJSONIndex.getClusterExpansionZoom(lt.clusterId))}catch(Bt){Tt(Bt)}},Je.prototype.getClusterChildren=function(lt,Tt){try{Tt(null,this._geoJSONIndex.getChildren(lt.clusterId))}catch(Bt){Tt(Bt)}},Je.prototype.getClusterLeaves=function(lt,Tt){try{Tt(null,this._geoJSONIndex.getLeaves(lt.clusterId,lt.limit,lt.offset))}catch(Bt){Tt(Bt)}},Je}(v);function ur($e){var Je=$e.superclusterOptions,it=$e.clusterProperties;if(!it||!Je)return Je;for(var lt={},Tt={},Bt={accumulated:null,zoom:0},Ce={properties:null},Me=Object.keys(it),nt=0,st=Me;nt<st.length;nt+=1){var ct=st[nt],At=it[ct],dt=At[0],Ct=At[1],Gt=e.createExpression(Ct),rr=e.createExpression(typeof dt=="string"?[dt,["accumulated"],["get",ct]]:dt);lt[ct]=Gt.value,Tt[ct]=rr.value}return Je.map=function(kr){Ce.properties=kr;for(var br={},Ar=0,Wr=Me;Ar<Wr.length;Ar+=1){var nr=Wr[Ar];br[nr]=lt[nr].evaluate(Bt,Ce)}return br},Je.reduce=function(kr,br){Ce.properties=br;for(var Ar=0,Wr=Me;Ar<Wr.length;Ar+=1){var nr=Wr[Ar];Bt.accumulated=kr[nr],kr[nr]=Tt[nr].evaluate(Bt,Ce)}},Je}var wr=function(Je){var it=this;this.self=Je,this.actor=new e.Actor(Je,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:v,geojson:Zt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(lt,Tt){if(it.workerSourceTypes[lt])throw new Error('Worker source with name "'+lt+'" already registered.');it.workerSourceTypes[lt]=Tt},this.self.registerRTLTextPlugin=function(lt){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=lt.applyArabicShaping,e.plugin.processBidirectionalText=lt.processBidirectionalText,e.plugin.processStyledBidirectionalText=lt.processStyledBidirectionalText}};return wr.prototype.setReferrer=function(Je,it){this.referrer=it},wr.prototype.setImages=function(Je,it,lt){this.availableImages[Je]=it;for(var Tt in this.workerSources[Je]){var Bt=this.workerSources[Je][Tt];for(var Ce in Bt)Bt[Ce].availableImages=it}lt()},wr.prototype.setLayers=function(Je,it,lt){this.getLayerIndex(Je).replace(it),lt()},wr.prototype.updateLayers=function(Je,it,lt){this.getLayerIndex(Je).update(it.layers,it.removedIds),lt()},wr.prototype.loadTile=function(Je,it,lt){this.getWorkerSource(Je,it.type,it.source).loadTile(it,lt)},wr.prototype.loadDEMTile=function(Je,it,lt){this.getDEMWorkerSource(Je,it.source).loadTile(it,lt)},wr.prototype.reloadTile=function(Je,it,lt){this.getWorkerSource(Je,it.type,it.source).reloadTile(it,lt)},wr.prototype.abortTile=function(Je,it,lt){this.getWorkerSource(Je,it.type,it.source).abortTile(it,lt)},wr.prototype.removeTile=function(Je,it,lt){this.getWorkerSource(Je,it.type,it.source).removeTile(it,lt)},wr.prototype.removeDEMTile=function(Je,it){this.getDEMWorkerSource(Je,it.source).removeTile(it)},wr.prototype.removeSource=function(Je,it,lt){if(!(!this.workerSources[Je]||!this.workerSources[Je][it.type]||!this.workerSources[Je][it.type][it.source])){var Tt=this.workerSources[Je][it.type][it.source];delete this.workerSources[Je][it.type][it.source],Tt.removeSource!==void 0?Tt.removeSource(it,lt):lt()}},wr.prototype.loadWorkerSource=function(Je,it,lt){try{this.self.importScripts(it.url),lt()}catch(Tt){lt(Tt.toString())}},wr.prototype.syncRTLPluginState=function(Je,it,lt){try{e.plugin.setState(it);var Tt=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&Tt!=null){this.self.importScripts(Tt);var Bt=e.plugin.isParsed(),Ce=Bt?void 0:new Error("RTL Text Plugin failed to import scripts from "+Tt);lt(Ce,Bt)}}catch(Me){lt(Me.toString())}},wr.prototype.getAvailableImages=function(Je){var it=this.availableImages[Je];return it||(it=[]),it},wr.prototype.getLayerIndex=function(Je){var it=this.layerIndexes[Je];return it||(it=this.layerIndexes[Je]=new t),it},wr.prototype.getWorkerSource=function(Je,it,lt){var Tt=this;if(this.workerSources[Je]||(this.workerSources[Je]={}),this.workerSources[Je][it]||(this.workerSources[Je][it]={}),!this.workerSources[Je][it][lt]){var Bt={send:function(Ce,Me,nt){Tt.actor.send(Ce,Me,nt,Je)}};this.workerSources[Je][it][lt]=new this.workerSourceTypes[it](Bt,this.getLayerIndex(Je),this.getAvailableImages(Je))}return this.workerSources[Je][it][lt]},wr.prototype.getDEMWorkerSource=function(Je,it){return this.demWorkerSources[Je]||(this.demWorkerSources[Je]={}),this.demWorkerSources[Je][it]||(this.demWorkerSources[Je][it]=new y),this.demWorkerSources[Je][it]},wr.prototype.enforceCacheSizeLimit=function(Je,it){e.enforceCacheSizeLimit(it)},typeof WorkerGlobalScope<"u"&&typeof e.window<"u"&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new wr(e.window)),wr}),M(["./shared"],function(e){var a=e.createCommonjsModule(function(fe){fe.exports?fe.exports=H:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=H,window.mapboxgl.notSupportedReason=ve);function H(Ur){return!ve(Ur)}function ve(Ur){if(!Z())return"not a browser";if(!pe())return"insufficent Array support";if(!Se())return"insufficient Function support";if(!Re())return"insufficient Object support";if(!je())return"insufficient JSON support";if(!ut())return"insufficient worker support";if(!Et())return"insufficient Uint8ClampedArray support";if(!Jt())return"insufficient ArrayBuffer support";if(!lr())return"insufficient Canvas/getImageData support";if(!Cr(Ur&&Ur.failIfMajorPerformanceCaveat))return"insufficient WebGL support"}function Z(){return typeof window<"u"&&typeof document<"u"}function pe(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}function Se(){return Function.prototype&&Function.prototype.bind}function Re(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}function je(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}function ut(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var Ur=new Blob([""],{type:"text/javascript"}),Jr=URL.createObjectURL(Ur),hn,Cn;try{Cn=new Worker(Jr),hn=!0}catch{hn=!1}return Cn&&Cn.terminate(),URL.revokeObjectURL(Jr),hn}function Et(){return"Uint8ClampedArray"in window}function Jt(){return ArrayBuffer.isView}function lr(){var Ur=document.createElement("canvas");Ur.width=Ur.height=1;var Jr=Ur.getContext("2d");if(!Jr)return!1;var hn=Jr.getImageData(0,0,1,1);return hn&&hn.width===Ur.width}var vr={};function Cr(Ur){return vr[Ur]===void 0&&(vr[Ur]=Yr(Ur)),vr[Ur]}H.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};function Hr(Ur){var Jr=document.createElement("canvas"),hn=Object.create(H.webGLContextAttributes);return hn.failIfMajorPerformanceCaveat=Ur,Jr.probablySupportsContext?Jr.probablySupportsContext("webgl",hn)||Jr.probablySupportsContext("experimental-webgl",hn):Jr.supportsContext?Jr.supportsContext("webgl",hn)||Jr.supportsContext("experimental-webgl",hn):Jr.getContext("webgl",hn)||Jr.getContext("experimental-webgl",hn)}function Yr(Ur){var Jr=Hr(Ur);if(!Jr)return!1;var hn=Jr.createShader(Jr.VERTEX_SHADER);return!hn||Jr.isContextLost()?!1:(Jr.shaderSource(hn,"void main() {}"),Jr.compileShader(hn),Jr.getShaderParameter(hn,Jr.COMPILE_STATUS)===!0)}}),n={};n.create=function(fe,H,ve){var Z=e.window.document.createElement(fe);return H!==void 0&&(Z.className=H),ve&&ve.appendChild(Z),Z},n.createNS=function(fe,H){var ve=e.window.document.createElementNS(fe,H);return ve};var r=e.window.document.documentElement.style;function t(fe){if(!r)return fe[0];for(var H=0;H<fe.length;H++)if(fe[H]in r)return fe[H];return fe[0]}var c=t(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),s;n.disableDrag=function(){r&&c&&(s=r[c],r[c]="none")},n.enableDrag=function(){r&&c&&(r[c]=s)};var i=t(["transform","WebkitTransform"]);n.setTransform=function(fe,H){fe.style[i]=H};var x=!1;try{var p=Object.defineProperty({},"passive",{get:function(){x=!0}});e.window.addEventListener("test",p,p),e.window.removeEventListener("test",p,p)}catch{x=!1}n.addEventListener=function(fe,H,ve,Z){Z===void 0&&(Z={}),"passive"in Z&&x?fe.addEventListener(H,ve,Z):fe.addEventListener(H,ve,Z.capture)},n.removeEventListener=function(fe,H,ve,Z){Z===void 0&&(Z={}),"passive"in Z&&x?fe.removeEventListener(H,ve,Z):fe.removeEventListener(H,ve,Z.capture)};var v=function(fe){fe.preventDefault(),fe.stopPropagation(),e.window.removeEventListener("click",v,!0)};n.suppressClick=function(){e.window.addEventListener("click",v,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",v,!0)},0)},n.mousePos=function(fe,H){var ve=fe.getBoundingClientRect();return new e.Point(H.clientX-ve.left-fe.clientLeft,H.clientY-ve.top-fe.clientTop)},n.touchPos=function(fe,H){for(var ve=fe.getBoundingClientRect(),Z=[],pe=0;pe<H.length;pe++)Z.push(new e.Point(H[pe].clientX-ve.left-fe.clientLeft,H[pe].clientY-ve.top-fe.clientTop));return Z},n.mouseButton=function(fe){return typeof e.window.InstallTrigger<"u"&&fe.button===2&&fe.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:fe.button},n.remove=function(fe){fe.parentNode&&fe.parentNode.removeChild(fe)};function f(fe,H,ve){var Z,pe,Se,Re=e.browser.devicePixelRatio>1?"@2x":"",je=e.getJSON(H.transformRequest(H.normalizeSpriteURL(fe,Re,".json"),e.ResourceType.SpriteJSON),function(Jt,lr){je=null,Se||(Se=Jt,Z=lr,Et())}),ut=e.getImage(H.transformRequest(H.normalizeSpriteURL(fe,Re,".png"),e.ResourceType.SpriteImage),function(Jt,lr){ut=null,Se||(Se=Jt,pe=lr,Et())});function Et(){if(Se)ve(Se);else if(Z&&pe){var Jt=e.browser.getImageData(pe),lr={};for(var vr in Z){var Cr=Z[vr],Hr=Cr.width,Yr=Cr.height,Ur=Cr.x,Jr=Cr.y,hn=Cr.sdf,Cn=Cr.pixelRatio,Fn=Cr.stretchX,Kn=Cr.stretchY,qn=Cr.content,Qn=new e.RGBAImage({width:Hr,height:Yr});e.RGBAImage.copy(Jt,Qn,{x:Ur,y:Jr},{x:0,y:0},{width:Hr,height:Yr}),lr[vr]={data:Qn,pixelRatio:Cn,sdf:hn,stretchX:Fn,stretchY:Kn,content:qn}}ve(null,lr)}}return{cancel:function(){je&&(je.cancel(),je=null),ut&&(ut.cancel(),ut=null)}}}function y(fe){var H=fe.userImage;if(H&&H.render){var ve=H.render();if(ve)return fe.data.replace(new Uint8Array(H.data.buffer)),!0}return!1}var o=1,m=function(fe){function H(){fe.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.isLoaded=function(){return this.loaded},H.prototype.setLoaded=function(Z){if(this.loaded!==Z&&(this.loaded=Z,Z)){for(var pe=0,Se=this.requestors;pe<Se.length;pe+=1){var Re=Se[pe],je=Re.ids,ut=Re.callback;this._notify(je,ut)}this.requestors=[]}},H.prototype.getImage=function(Z){return this.images[Z]},H.prototype.addImage=function(Z,pe){this._validate(Z,pe)&&(this.images[Z]=pe)},H.prototype._validate=function(Z,pe){var Se=!0;return this._validateStretch(pe.stretchX,pe.data&&pe.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+Z+'" has invalid "stretchX" value'))),Se=!1),this._validateStretch(pe.stretchY,pe.data&&pe.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+Z+'" has invalid "stretchY" value'))),Se=!1),this._validateContent(pe.content,pe)||(this.fire(new e.ErrorEvent(new Error('Image "'+Z+'" has invalid "content" value'))),Se=!1),Se},H.prototype._validateStretch=function(Z,pe){if(!Z)return!0;for(var Se=0,Re=0,je=Z;Re<je.length;Re+=1){var ut=je[Re];if(ut[0]<Se||ut[1]<ut[0]||pe<ut[1])return!1;Se=ut[1]}return!0},H.prototype._validateContent=function(Z,pe){return Z?!(Z.length!==4||Z[0]<0||pe.data.width<Z[0]||Z[1]<0||pe.data.height<Z[1]||Z[2]<0||pe.data.width<Z[2]||Z[3]<0||pe.data.height<Z[3]||Z[2]<Z[0]||Z[3]<Z[1]):!0},H.prototype.updateImage=function(Z,pe){var Se=this.images[Z];pe.version=Se.version+1,this.images[Z]=pe,this.updatedImages[Z]=!0},H.prototype.removeImage=function(Z){var pe=this.images[Z];delete this.images[Z],delete this.patterns[Z],pe.userImage&&pe.userImage.onRemove&&pe.userImage.onRemove()},H.prototype.listImages=function(){return Object.keys(this.images)},H.prototype.getImages=function(Z,pe){var Se=!0;if(!this.isLoaded())for(var Re=0,je=Z;Re<je.length;Re+=1){var ut=je[Re];this.images[ut]||(Se=!1)}this.isLoaded()||Se?this._notify(Z,pe):this.requestors.push({ids:Z,callback:pe})},H.prototype._notify=function(Z,pe){for(var Se={},Re=0,je=Z;Re<je.length;Re+=1){var ut=je[Re];this.images[ut]||this.fire(new e.Event("styleimagemissing",{id:ut}));var Et=this.images[ut];Et?Se[ut]={data:Et.data.clone(),pixelRatio:Et.pixelRatio,sdf:Et.sdf,version:Et.version,stretchX:Et.stretchX,stretchY:Et.stretchY,content:Et.content,hasRenderCallback:Boolean(Et.userImage&&Et.userImage.render)}:e.warnOnce('Image "'+ut+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}pe(null,Se)},H.prototype.getPixelSize=function(){var Z=this.atlasImage,pe=Z.width,Se=Z.height;return{width:pe,height:Se}},H.prototype.getPattern=function(Z){var pe=this.patterns[Z],Se=this.getImage(Z);if(!Se)return null;if(pe&&pe.position.version===Se.version)return pe.position;if(pe)pe.position.version=Se.version;else{var Re=Se.data.width+o*2,je=Se.data.height+o*2,ut={w:Re,h:je,x:0,y:0},Et=new e.ImagePosition(ut,Se);this.patterns[Z]={bin:ut,position:Et}}return this._updatePatternAtlas(),this.patterns[Z].position},H.prototype.bind=function(Z){var pe=Z.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(Z,this.atlasImage,pe.RGBA),this.atlasTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE)},H.prototype._updatePatternAtlas=function(){var Z=[];for(var pe in this.patterns)Z.push(this.patterns[pe].bin);var Se=e.potpack(Z),Re=Se.w,je=Se.h,ut=this.atlasImage;ut.resize({width:Re||1,height:je||1});for(var Et in this.patterns){var Jt=this.patterns[Et],lr=Jt.bin,vr=lr.x+o,Cr=lr.y+o,Hr=this.images[Et].data,Yr=Hr.width,Ur=Hr.height;e.RGBAImage.copy(Hr,ut,{x:0,y:0},{x:vr,y:Cr},{width:Yr,height:Ur}),e.RGBAImage.copy(Hr,ut,{x:0,y:Ur-1},{x:vr,y:Cr-1},{width:Yr,height:1}),e.RGBAImage.copy(Hr,ut,{x:0,y:0},{x:vr,y:Cr+Ur},{width:Yr,height:1}),e.RGBAImage.copy(Hr,ut,{x:Yr-1,y:0},{x:vr-1,y:Cr},{width:1,height:Ur}),e.RGBAImage.copy(Hr,ut,{x:0,y:0},{x:vr+Yr,y:Cr},{width:1,height:Ur})}this.dirty=!0},H.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},H.prototype.dispatchRenderCallbacks=function(Z){for(var pe=0,Se=Z;pe<Se.length;pe+=1){var Re=Se[pe];if(!this.callbackDispatchedThisFrame[Re]){this.callbackDispatchedThisFrame[Re]=!0;var je=this.images[Re],ut=y(je);ut&&this.updateImage(Re,je)}}},H}(e.Evented);function l(fe,H,ve,Z,pe){var Se=H*256,Re=Se+255,je=Z.transformRequest(Z.normalizeGlyphsURL(ve).replace("{fontstack}",fe).replace("{range}",Se+"-"+Re),e.ResourceType.Glyphs);e.getArrayBuffer(je,function(ut,Et){if(ut)pe(ut);else if(Et){for(var Jt={},lr=0,vr=e.parseGlyphPBF(Et);lr<vr.length;lr+=1){var Cr=vr[lr];Jt[Cr.id]=Cr}pe(null,Jt)}})}var w=b,_=b,h=1e20;function b(fe,H,ve,Z,pe,Se){this.fontSize=fe||24,this.buffer=H===void 0?3:H,this.cutoff=Z||.25,this.fontFamily=pe||"sans-serif",this.fontWeight=Se||"normal",this.radius=ve||8;var Re=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Re,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Re*Re),this.gridInner=new Float64Array(Re*Re),this.f=new Float64Array(Re),this.d=new Float64Array(Re),this.z=new Float64Array(Re+1),this.v=new Int16Array(Re),this.middle=Math.round(Re/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}b.prototype.draw=function(fe){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(fe,this.buffer,this.middle);for(var H=this.ctx.getImageData(0,0,this.size,this.size),ve=new Uint8ClampedArray(this.size*this.size),Z=0;Z<this.size*this.size;Z++){var pe=H.data[Z*4+3]/255;this.gridOuter[Z]=pe===1?0:pe===0?h:Math.pow(Math.max(0,.5-pe),2),this.gridInner[Z]=pe===1?h:pe===0?0:Math.pow(Math.max(0,pe-.5),2)}for(u(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),u(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),Z=0;Z<this.size*this.size;Z++){var Se=this.gridOuter[Z]-this.gridInner[Z];ve[Z]=Math.max(0,Math.min(255,Math.round(255-255*(Se/this.radius+this.cutoff))))}return ve};function u(fe,H,ve,Z,pe,Se,Re){for(var je=0;je<H;je++){for(var ut=0;ut<ve;ut++)Z[ut]=fe[ut*H+je];for(L(Z,pe,Se,Re,ve),ut=0;ut<ve;ut++)fe[ut*H+je]=pe[ut]}for(ut=0;ut<ve;ut++){for(je=0;je<H;je++)Z[je]=fe[ut*H+je];for(L(Z,pe,Se,Re,H),je=0;je<H;je++)fe[ut*H+je]=Math.sqrt(pe[je])}}function L(fe,H,ve,Z,pe){ve[0]=0,Z[0]=-h,Z[1]=+h;for(var Se=1,Re=0;Se<pe;Se++){for(var je=(fe[Se]+Se*Se-(fe[ve[Re]]+ve[Re]*ve[Re]))/(2*Se-2*ve[Re]);je<=Z[Re];)Re--,je=(fe[Se]+Se*Se-(fe[ve[Re]]+ve[Re]*ve[Re]))/(2*Se-2*ve[Re]);Re++,ve[Re]=Se,Z[Re]=je,Z[Re+1]=+h}for(Se=0,Re=0;Se<pe;Se++){for(;Z[Re+1]<Se;)Re++;H[Se]=(Se-ve[Re])*(Se-ve[Re])+fe[ve[Re]]}}w.default=_;var T=function(H,ve){this.requestManager=H,this.localIdeographFontFamily=ve,this.entries={}};T.prototype.setURL=function(H){this.url=H},T.prototype.getGlyphs=function(H,ve){var Z=this,pe=[];for(var Se in H)for(var Re=0,je=H[Se];Re<je.length;Re+=1){var ut=je[Re];pe.push({stack:Se,id:ut})}e.asyncAll(pe,function(Et,Jt){var lr=Et.stack,vr=Et.id,Cr=Z.entries[lr];Cr||(Cr=Z.entries[lr]={glyphs:{},requests:{},ranges:{}});var Hr=Cr.glyphs[vr];if(Hr!==void 0){Jt(null,{stack:lr,id:vr,glyph:Hr});return}if(Hr=Z._tinySDF(Cr,lr,vr),Hr){Cr.glyphs[vr]=Hr,Jt(null,{stack:lr,id:vr,glyph:Hr});return}var Yr=Math.floor(vr/256);if(Yr*256>65535){Jt(new Error("glyphs > 65535 not supported"));return}if(Cr.ranges[Yr]){Jt(null,{stack:lr,id:vr,glyph:Hr});return}var Ur=Cr.requests[Yr];Ur||(Ur=Cr.requests[Yr]=[],T.loadGlyphRange(lr,Yr,Z.url,Z.requestManager,function(Jr,hn){if(hn){for(var Cn in hn)Z._doesCharSupportLocalGlyph(+Cn)||(Cr.glyphs[+Cn]=hn[+Cn]);Cr.ranges[Yr]=!0}for(var Fn=0,Kn=Ur;Fn<Kn.length;Fn+=1){var qn=Kn[Fn];qn(Jr,hn)}delete Cr.requests[Yr]})),Ur.push(function(Jr,hn){Jr?Jt(Jr):hn&&Jt(null,{stack:lr,id:vr,glyph:hn[vr]||null})})},function(Et,Jt){if(Et)ve(Et);else if(Jt){for(var lr={},vr=0,Cr=Jt;vr<Cr.length;vr+=1){var Hr=Cr[vr],Yr=Hr.stack,Ur=Hr.id,Jr=Hr.glyph;(lr[Yr]||(lr[Yr]={}))[Ur]=Jr&&{id:Jr.id,bitmap:Jr.bitmap.clone(),metrics:Jr.metrics}}ve(null,lr)}})},T.prototype._doesCharSupportLocalGlyph=function(H){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](H)||e.isChar["Hangul Syllables"](H)||e.isChar.Hiragana(H)||e.isChar.Katakana(H))},T.prototype._tinySDF=function(H,ve,Z){var pe=this.localIdeographFontFamily;if(!!pe&&!!this._doesCharSupportLocalGlyph(Z)){var Se=H.tinySDF;if(!Se){var Re="400";/bold/i.test(ve)?Re="900":/medium/i.test(ve)?Re="500":/light/i.test(ve)&&(Re="200"),Se=H.tinySDF=new T.TinySDF(24,3,8,.25,pe,Re)}return{id:Z,bitmap:new e.AlphaImage({width:30,height:30},Se.draw(String.fromCharCode(Z))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},T.loadGlyphRange=l,T.TinySDF=w;var k=function(){this.specification=e.styleSpec.light.position};k.prototype.possiblyEvaluate=function(H,ve){return e.sphericalToCartesian(H.expression.evaluate(ve))},k.prototype.interpolate=function(H,ve,Z){return{x:e.number(H.x,ve.x,Z),y:e.number(H.y,ve.y,Z),z:e.number(H.z,ve.z,Z)}};var P=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new k,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),z="-transition",I=function(fe){function H(ve){fe.call(this),this._transitionable=new e.Transitionable(P),this.setLight(ve),this._transitioning=this._transitionable.untransitioned()}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getLight=function(){return this._transitionable.serialize()},H.prototype.setLight=function(Z,pe){if(pe===void 0&&(pe={}),!this._validate(e.validateLight,Z,pe))for(var Se in Z){var Re=Z[Se];e.endsWith(Se,z)?this._transitionable.setTransition(Se.slice(0,-z.length),Re):this._transitionable.setValue(Se,Re)}},H.prototype.updateTransitions=function(Z){this._transitioning=this._transitionable.transitioned(Z,this._transitioning)},H.prototype.hasTransition=function(){return this._transitioning.hasTransition()},H.prototype.recalculate=function(Z){this.properties=this._transitioning.possiblyEvaluate(Z)},H.prototype._validate=function(Z,pe,Se){return Se&&Se.validate===!1?!1:e.emitValidationErrors(this,Z.call(e.validateStyle,e.extend({value:pe,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},H}(e.Evented),D=function(H,ve){this.width=H,this.height=ve,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};D.prototype.getDash=function(H,ve){var Z=H.join(",")+String(ve);return this.dashEntry[Z]||(this.dashEntry[Z]=this.addDash(H,ve)),this.dashEntry[Z]},D.prototype.getDashRanges=function(H,ve,Z){var pe=H.length%2===1,Se=[],Re=pe?-H[H.length-1]*Z:0,je=H[0]*Z,ut=!0;Se.push({left:Re,right:je,isDash:ut,zeroLength:H[0]===0});for(var Et=H[0],Jt=1;Jt<H.length;Jt++){ut=!ut;var lr=H[Jt];Re=Et*Z,Et+=lr,je=Et*Z,Se.push({left:Re,right:je,isDash:ut,zeroLength:lr===0})}return Se},D.prototype.addRoundDash=function(H,ve,Z){for(var pe=ve/2,Se=-Z;Se<=Z;Se++)for(var Re=this.nextRow+Z+Se,je=this.width*Re,ut=0,Et=H[ut],Jt=0;Jt<this.width;Jt++){Jt/Et.right>1&&(Et=H[++ut]);var lr=Math.abs(Jt-Et.left),vr=Math.abs(Jt-Et.right),Cr=Math.min(lr,vr),Hr=void 0,Yr=Se/Z*(pe+1);if(Et.isDash){var Ur=pe-Math.abs(Yr);Hr=Math.sqrt(Cr*Cr+Ur*Ur)}else Hr=pe-Math.sqrt(Cr*Cr+Yr*Yr);this.data[je+Jt]=Math.max(0,Math.min(255,Hr+128))}},D.prototype.addRegularDash=function(H){for(var ve=H.length-1;ve>=0;--ve){var Z=H[ve],pe=H[ve+1];Z.zeroLength?H.splice(ve,1):pe&&pe.isDash===Z.isDash&&(pe.left=Z.left,H.splice(ve,1))}var Se=H[0],Re=H[H.length-1];Se.isDash===Re.isDash&&(Se.left=Re.left-this.width,Re.right=Se.right+this.width);for(var je=this.width*this.nextRow,ut=0,Et=H[ut],Jt=0;Jt<this.width;Jt++){Jt/Et.right>1&&(Et=H[++ut]);var lr=Math.abs(Jt-Et.left),vr=Math.abs(Jt-Et.right),Cr=Math.min(lr,vr),Hr=Et.isDash?Cr:-Cr;this.data[je+Jt]=Math.max(0,Math.min(255,Hr+128))}},D.prototype.addDash=function(H,ve){var Z=ve?7:0,pe=2*Z+1;if(this.nextRow+pe>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var Se=0,Re=0;Re<H.length;Re++)Se+=H[Re];if(Se!==0){var je=this.width/Se,ut=this.getDashRanges(H,this.width,je);ve?this.addRoundDash(ut,je,Z):this.addRegularDash(ut)}var Et={y:(this.nextRow+Z+.5)/this.height,height:2*Z/this.height,width:Se};return this.nextRow+=pe,this.dirty=!0,Et},D.prototype.bind=function(H){var ve=H.gl;this.texture?(ve.bindTexture(ve.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,ve.texSubImage2D(ve.TEXTURE_2D,0,0,0,this.width,this.height,ve.ALPHA,ve.UNSIGNED_BYTE,this.data))):(this.texture=ve.createTexture(),ve.bindTexture(ve.TEXTURE_2D,this.texture),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_S,ve.REPEAT),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_T,ve.REPEAT),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MAG_FILTER,ve.LINEAR),ve.texImage2D(ve.TEXTURE_2D,0,ve.ALPHA,this.width,this.height,0,ve.ALPHA,ve.UNSIGNED_BYTE,this.data))};var R=function fe(H,ve){this.workerPool=H,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var Z=this.workerPool.acquire(this.id),pe=0;pe<Z.length;pe++){var Se=Z[pe],Re=new fe.Actor(Se,ve,this.id);Re.name="Worker "+pe,this.actors.push(Re)}};R.prototype.broadcast=function(H,ve,Z){Z=Z||function(){},e.asyncAll(this.actors,function(pe,Se){pe.send(H,ve,Se)},Z)},R.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},R.prototype.remove=function(){this.actors.forEach(function(H){H.remove()}),this.actors=[],this.workerPool.release(this.id)},R.Actor=e.Actor;function O(fe,H,ve){var Z=function(pe,Se){if(pe)return ve(pe);if(Se){var Re=e.pick(e.extend(Se,fe),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);Se.vector_layers&&(Re.vectorLayers=Se.vector_layers,Re.vectorLayerIds=Re.vectorLayers.map(function(je){return je.id})),Re.tiles=H.canonicalizeTileset(Re,fe.url),ve(null,Re)}};return fe.url?e.getJSON(H.transformRequest(H.normalizeSourceURL(fe.url),e.ResourceType.Source),Z):e.browser.frame(function(){return Z(null,fe)})}var F=function(H,ve,Z){this.bounds=e.LngLatBounds.convert(this.validateBounds(H)),this.minzoom=ve||0,this.maxzoom=Z||24};F.prototype.validateBounds=function(H){return!Array.isArray(H)||H.length!==4?[-180,-90,180,90]:[Math.max(-180,H[0]),Math.max(-90,H[1]),Math.min(180,H[2]),Math.min(90,H[3])]},F.prototype.contains=function(H){var ve=Math.pow(2,H.z),Z={minX:Math.floor(e.mercatorXfromLng(this.bounds.getWest())*ve),minY:Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*ve),maxX:Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*ve),maxY:Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*ve)},pe=H.x>=Z.minX&&H.x<Z.maxX&&H.y>=Z.minY&&H.y<Z.maxY;return pe};var N=function(fe){function H(ve,Z,pe,Se){if(fe.call(this),this.id=ve,this.dispatcher=pe,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(Z,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},Z),this._collectResourceTiming=Z.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(Se)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.load=function(){var Z=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._requestManager,function(pe,Se){Z._tileJSONRequest=null,Z._loaded=!0,pe?Z.fire(new e.ErrorEvent(pe)):Se&&(e.extend(Z,Se),Se.bounds&&(Z.tileBounds=new F(Se.bounds,Z.minzoom,Z.maxzoom)),e.postTurnstileEvent(Se.tiles,Z.map._requestManager._customAccessToken),e.postMapLoadEvent(Se.tiles,Z.map._getMapId(),Z.map._requestManager._skuToken,Z.map._requestManager._customAccessToken),Z.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),Z.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},H.prototype.loaded=function(){return this._loaded},H.prototype.hasTile=function(Z){return!this.tileBounds||this.tileBounds.contains(Z.canonical)},H.prototype.onAdd=function(Z){this.map=Z,this.load()},H.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},H.prototype.serialize=function(){return e.extend({},this._options)},H.prototype.loadTile=function(Z,pe){var Se=this.map._requestManager.normalizeTileURL(Z.tileID.canonical.url(this.tiles,this.scheme)),Re={request:this.map._requestManager.transformRequest(Se,e.ResourceType.Tile),uid:Z.uid,tileID:Z.tileID,zoom:Z.tileID.overscaledZ,tileSize:this.tileSize*Z.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};Re.request.collectResourceTiming=this._collectResourceTiming,!Z.actor||Z.state==="expired"?(Z.actor=this.dispatcher.getActor(),Z.request=Z.actor.send("loadTile",Re,je.bind(this))):Z.state==="loading"?Z.reloadCallback=pe:Z.request=Z.actor.send("reloadTile",Re,je.bind(this));function je(ut,Et){if(delete Z.request,Z.aborted)return pe(null);if(ut&&ut.status!==404)return pe(ut);Et&&Et.resourceTiming&&(Z.resourceTiming=Et.resourceTiming),this.map._refreshExpiredTiles&&Et&&Z.setExpiryData(Et),Z.loadVectorData(Et,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),pe(null),Z.reloadCallback&&(this.loadTile(Z,Z.reloadCallback),Z.reloadCallback=null)}},H.prototype.abortTile=function(Z){Z.request&&(Z.request.cancel(),delete Z.request),Z.actor&&Z.actor.send("abortTile",{uid:Z.uid,type:this.type,source:this.id},void 0)},H.prototype.unloadTile=function(Z){Z.unloadVectorData(),Z.actor&&Z.actor.send("removeTile",{uid:Z.uid,type:this.type,source:this.id},void 0)},H.prototype.hasTransition=function(){return!1},H}(e.Evented),G=function(fe){function H(ve,Z,pe,Se){fe.call(this),this.id=ve,this.dispatcher=pe,this.setEventedParent(Se),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},Z),e.extend(this,e.pick(Z,["url","scheme","tileSize"]))}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.load=function(){var Z=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._requestManager,function(pe,Se){Z._tileJSONRequest=null,Z._loaded=!0,pe?Z.fire(new e.ErrorEvent(pe)):Se&&(e.extend(Z,Se),Se.bounds&&(Z.tileBounds=new F(Se.bounds,Z.minzoom,Z.maxzoom)),e.postTurnstileEvent(Se.tiles),e.postMapLoadEvent(Se.tiles,Z.map._getMapId(),Z.map._requestManager._skuToken),Z.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),Z.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},H.prototype.loaded=function(){return this._loaded},H.prototype.onAdd=function(Z){this.map=Z,this.load()},H.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},H.prototype.serialize=function(){return e.extend({},this._options)},H.prototype.hasTile=function(Z){return!this.tileBounds||this.tileBounds.contains(Z.canonical)},H.prototype.loadTile=function(Z,pe){var Se=this,Re=this.map._requestManager.normalizeTileURL(Z.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);Z.request=e.getImage(this.map._requestManager.transformRequest(Re,e.ResourceType.Tile),function(je,ut){if(delete Z.request,Z.aborted)Z.state="unloaded",pe(null);else if(je)Z.state="errored",pe(je);else if(ut){Se.map._refreshExpiredTiles&&Z.setExpiryData(ut),delete ut.cacheControl,delete ut.expires;var Et=Se.map.painter.context,Jt=Et.gl;Z.texture=Se.map.painter.getTileTexture(ut.width),Z.texture?Z.texture.update(ut,{useMipmap:!0}):(Z.texture=new e.Texture(Et,ut,Jt.RGBA,{useMipmap:!0}),Z.texture.bind(Jt.LINEAR,Jt.CLAMP_TO_EDGE,Jt.LINEAR_MIPMAP_NEAREST),Et.extTextureFilterAnisotropic&&Jt.texParameterf(Jt.TEXTURE_2D,Et.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Et.extTextureFilterAnisotropicMax)),Z.state="loaded",e.cacheEntryPossiblyAdded(Se.dispatcher),pe(null)}})},H.prototype.abortTile=function(Z,pe){Z.request&&(Z.request.cancel(),delete Z.request),pe()},H.prototype.unloadTile=function(Z,pe){Z.texture&&this.map.painter.saveTileTexture(Z.texture),pe()},H.prototype.hasTransition=function(){return!1},H}(e.Evented),K=function(fe){function H(ve,Z,pe,Se){fe.call(this,ve,Z,pe,Se),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},Z),this.encoding=Z.encoding||"mapbox"}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},H.prototype.loadTile=function(Z,pe){var Se=this.map._requestManager.normalizeTileURL(Z.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);Z.request=e.getImage(this.map._requestManager.transformRequest(Se,e.ResourceType.Tile),Re.bind(this)),Z.neighboringTiles=this._getNeighboringTiles(Z.tileID);function Re(ut,Et){if(delete Z.request,Z.aborted)Z.state="unloaded",pe(null);else if(ut)Z.state="errored",pe(ut);else if(Et){this.map._refreshExpiredTiles&&Z.setExpiryData(Et),delete Et.cacheControl,delete Et.expires;var Jt=e.window.ImageBitmap&&Et instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported(),lr=Jt?Et:e.browser.getImageData(Et,1),vr={uid:Z.uid,coord:Z.tileID,source:this.id,rawImageData:lr,encoding:this.encoding};(!Z.actor||Z.state==="expired")&&(Z.actor=this.dispatcher.getActor(),Z.actor.send("loadDEMTile",vr,je.bind(this)))}}function je(ut,Et){ut&&(Z.state="errored",pe(ut)),Et&&(Z.dem=Et,Z.needsHillshadePrepare=!0,Z.state="loaded",pe(null))}},H.prototype._getNeighboringTiles=function(Z){var pe=Z.canonical,Se=Math.pow(2,pe.z),Re=(pe.x-1+Se)%Se,je=pe.x===0?Z.wrap-1:Z.wrap,ut=(pe.x+1+Se)%Se,Et=pe.x+1===Se?Z.wrap+1:Z.wrap,Jt={};return Jt[new e.OverscaledTileID(Z.overscaledZ,je,pe.z,Re,pe.y).key]={backfilled:!1},Jt[new e.OverscaledTileID(Z.overscaledZ,Et,pe.z,ut,pe.y).key]={backfilled:!1},pe.y>0&&(Jt[new e.OverscaledTileID(Z.overscaledZ,je,pe.z,Re,pe.y-1).key]={backfilled:!1},Jt[new e.OverscaledTileID(Z.overscaledZ,Z.wrap,pe.z,pe.x,pe.y-1).key]={backfilled:!1},Jt[new e.OverscaledTileID(Z.overscaledZ,Et,pe.z,ut,pe.y-1).key]={backfilled:!1}),pe.y+1<Se&&(Jt[new e.OverscaledTileID(Z.overscaledZ,je,pe.z,Re,pe.y+1).key]={backfilled:!1},Jt[new e.OverscaledTileID(Z.overscaledZ,Z.wrap,pe.z,pe.x,pe.y+1).key]={backfilled:!1},Jt[new e.OverscaledTileID(Z.overscaledZ,Et,pe.z,ut,pe.y+1).key]={backfilled:!1}),Jt},H.prototype.unloadTile=function(Z){Z.demTexture&&this.map.painter.saveTileTexture(Z.demTexture),Z.fbo&&(Z.fbo.destroy(),delete Z.fbo),Z.dem&&delete Z.dem,delete Z.neighboringTiles,Z.state="unloaded",Z.actor&&Z.actor.send("removeDEMTile",{uid:Z.uid,source:this.id})},H}(G),W=function(fe){function H(ve,Z,pe,Se){fe.call(this),this.id=ve,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=pe.getActor(),this.setEventedParent(Se),this._data=Z.data,this._options=e.extend({},Z),this._collectResourceTiming=Z.collectResourceTiming,this._resourceTiming=[],Z.maxzoom!==void 0&&(this.maxzoom=Z.maxzoom),Z.type&&(this.type=Z.type),Z.attribution&&(this.attribution=Z.attribution),this.promoteId=Z.promoteId;var Re=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:Z.cluster||!1,geojsonVtOptions:{buffer:(Z.buffer!==void 0?Z.buffer:128)*Re,tolerance:(Z.tolerance!==void 0?Z.tolerance:.375)*Re,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:Z.lineMetrics||!1,generateId:Z.generateId||!1},superclusterOptions:{maxZoom:Z.clusterMaxZoom!==void 0?Math.min(Z.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(Z.clusterRadius||50)*Re,log:!1,generateId:Z.generateId||!1},clusterProperties:Z.clusterProperties},Z.workerOptions)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.load=function(){var Z=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(pe){if(pe){Z.fire(new e.ErrorEvent(pe));return}var Se={dataType:"source",sourceDataType:"metadata"};Z._collectResourceTiming&&Z._resourceTiming&&Z._resourceTiming.length>0&&(Se.resourceTiming=Z._resourceTiming,Z._resourceTiming=[]),Z.fire(new e.Event("data",Se))})},H.prototype.onAdd=function(Z){this.map=Z,this.load()},H.prototype.setData=function(Z){var pe=this;return this._data=Z,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(Se){if(Se){pe.fire(new e.ErrorEvent(Se));return}var Re={dataType:"source",sourceDataType:"content"};pe._collectResourceTiming&&pe._resourceTiming&&pe._resourceTiming.length>0&&(Re.resourceTiming=pe._resourceTiming,pe._resourceTiming=[]),pe.fire(new e.Event("data",Re))}),this},H.prototype.getClusterExpansionZoom=function(Z,pe){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:Z,source:this.id},pe),this},H.prototype.getClusterChildren=function(Z,pe){return this.actor.send("geojson.getClusterChildren",{clusterId:Z,source:this.id},pe),this},H.prototype.getClusterLeaves=function(Z,pe,Se,Re){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:Z,limit:pe,offset:Se},Re),this},H.prototype._updateWorkerData=function(Z){var pe=this;this._loaded=!1;var Se=e.extend({},this.workerOptions),Re=this._data;typeof Re=="string"?(Se.request=this.map._requestManager.transformRequest(e.browser.resolveURL(Re),e.ResourceType.Source),Se.request.collectResourceTiming=this._collectResourceTiming):Se.data=JSON.stringify(Re),this.actor.send(this.type+".loadData",Se,function(je,ut){pe._removed||ut&&ut.abandoned||(pe._loaded=!0,ut&&ut.resourceTiming&&ut.resourceTiming[pe.id]&&(pe._resourceTiming=ut.resourceTiming[pe.id].slice(0)),pe.actor.send(pe.type+".coalesce",{source:Se.source},null),Z(je))})},H.prototype.loaded=function(){return this._loaded},H.prototype.loadTile=function(Z,pe){var Se=this,Re=Z.actor?"reloadTile":"loadTile";Z.actor=this.actor;var je={type:this.type,uid:Z.uid,tileID:Z.tileID,zoom:Z.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};Z.request=this.actor.send(Re,je,function(ut,Et){return delete Z.request,Z.unloadVectorData(),Z.aborted?pe(null):ut?pe(ut):(Z.loadVectorData(Et,Se.map.painter,Re==="reloadTile"),pe(null))})},H.prototype.abortTile=function(Z){Z.request&&(Z.request.cancel(),delete Z.request),Z.aborted=!0},H.prototype.unloadTile=function(Z){Z.unloadVectorData(),this.actor.send("removeTile",{uid:Z.uid,type:this.type,source:this.id})},H.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},H.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},H.prototype.hasTransition=function(){return!1},H}(e.Evented),Y=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),re=function(fe){function H(ve,Z,pe,Se){fe.call(this),this.id=ve,this.dispatcher=pe,this.coordinates=Z.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(Se),this.options=Z}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.load=function(Z,pe){var Se=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(Re,je){Se._loaded=!0,Re?Se.fire(new e.ErrorEvent(Re)):je&&(Se.image=je,Z&&(Se.coordinates=Z),pe&&pe(),Se._finishLoading())})},H.prototype.loaded=function(){return this._loaded},H.prototype.updateImage=function(Z){var pe=this;return!this.image||!Z.url?this:(this.options.url=Z.url,this.load(Z.coordinates,function(){pe.texture=null}),this)},H.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},H.prototype.onAdd=function(Z){this.map=Z,this.load()},H.prototype.setCoordinates=function(Z){var pe=this;this.coordinates=Z;var Se=Z.map(e.MercatorCoordinate.fromLngLat);this.tileID=ue(Se),this.minzoom=this.maxzoom=this.tileID.z;var Re=Se.map(function(je){return pe.tileID.getTilePoint(je)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(Re[0].x,Re[0].y,0,0),this._boundsArray.emplaceBack(Re[1].x,Re[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(Re[3].x,Re[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(Re[2].x,Re[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},H.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||!this.image)){var Z=this.map.painter.context,pe=Z.gl;this.boundsBuffer||(this.boundsBuffer=Z.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(Z,this.image,pe.RGBA),this.texture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE));for(var Se in this.tiles){var Re=this.tiles[Se];Re.state!=="loaded"&&(Re.state="loaded",Re.texture=this.texture)}}},H.prototype.loadTile=function(Z,pe){this.tileID&&this.tileID.equals(Z.tileID.canonical)?(this.tiles[String(Z.tileID.wrap)]=Z,Z.buckets={},pe(null)):(Z.state="errored",pe(null))},H.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},H.prototype.hasTransition=function(){return!1},H}(e.Evented);function ue(fe){for(var H=1/0,ve=1/0,Z=-1/0,pe=-1/0,Se=0,Re=fe;Se<Re.length;Se+=1){var je=Re[Se];H=Math.min(H,je.x),ve=Math.min(ve,je.y),Z=Math.max(Z,je.x),pe=Math.max(pe,je.y)}var ut=Z-H,Et=pe-ve,Jt=Math.max(ut,Et),lr=Math.max(0,Math.floor(-Math.log(Jt)/Math.LN2)),vr=Math.pow(2,lr);return new e.CanonicalTileID(lr,Math.floor((H+Z)/2*vr),Math.floor((ve+pe)/2*vr))}var j=function(fe){function H(ve,Z,pe,Se){fe.call(this,ve,Z,pe,Se),this.roundZoom=!0,this.type="video",this.options=Z}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.load=function(){var Z=this;this._loaded=!1;var pe=this.options;this.urls=[];for(var Se=0,Re=pe.urls;Se<Re.length;Se+=1){var je=Re[Se];this.urls.push(this.map._requestManager.transformRequest(je,e.ResourceType.Source).url)}e.getVideo(this.urls,function(ut,Et){Z._loaded=!0,ut?Z.fire(new e.ErrorEvent(ut)):Et&&(Z.video=Et,Z.video.loop=!0,Z.video.addEventListener("playing",function(){Z.map.triggerRepaint()}),Z.map&&Z.video.play(),Z._finishLoading())})},H.prototype.pause=function(){this.video&&this.video.pause()},H.prototype.play=function(){this.video&&this.video.play()},H.prototype.seek=function(Z){if(this.video){var pe=this.video.seekable;Z<pe.start(0)||Z>pe.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+pe.start(0)+" and "+pe.end(0)+"-second mark."))):this.video.currentTime=Z}},H.prototype.getVideo=function(){return this.video},H.prototype.onAdd=function(Z){this.map||(this.map=Z,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},H.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var Z=this.map.painter.context,pe=Z.gl;this.boundsBuffer||(this.boundsBuffer=Z.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE),pe.texSubImage2D(pe.TEXTURE_2D,0,0,0,pe.RGBA,pe.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(Z,this.video,pe.RGBA),this.texture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE));for(var Se in this.tiles){var Re=this.tiles[Se];Re.state!=="loaded"&&(Re.state="loaded",Re.texture=this.texture)}}},H.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},H.prototype.hasTransition=function(){return this.video&&!this.video.paused},H}(re),q=function(fe){function H(ve,Z,pe,Se){fe.call(this,ve,Z,pe,Se),Z.coordinates?(!Array.isArray(Z.coordinates)||Z.coordinates.length!==4||Z.coordinates.some(function(Re){return!Array.isArray(Re)||Re.length!==2||Re.some(function(je){return typeof je!="number"})}))&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'missing required property "coordinates"'))),Z.animate&&typeof Z.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'optional "animate" property must be a boolean value'))),Z.canvas?typeof Z.canvas!="string"&&!(Z.canvas instanceof e.window.HTMLCanvasElement)&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'missing required property "canvas"'))),this.options=Z,this.animate=Z.animate!==void 0?Z.animate:!0}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.load=function(){if(this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()){this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading()},H.prototype.getCanvas=function(){return this.canvas},H.prototype.onAdd=function(Z){this.map=Z,this.load(),this.canvas&&this.animate&&this.play()},H.prototype.onRemove=function(){this.pause()},H.prototype.prepare=function(){var Z=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,Z=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,Z=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var pe=this.map.painter.context,Se=pe.gl;this.boundsBuffer||(this.boundsBuffer=pe.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(Z||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(pe,this.canvas,Se.RGBA,{premultiply:!0});for(var Re in this.tiles){var je=this.tiles[Re];je.state!=="loaded"&&(je.state="loaded",je.texture=this.texture)}}},H.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},H.prototype.hasTransition=function(){return this._playing},H.prototype._hasInvalidDimensions=function(){for(var Z=0,pe=[this.canvas.width,this.canvas.height];Z<pe.length;Z+=1){var Se=pe[Z];if(isNaN(Se)||Se<=0)return!0}return!1},H}(re),V={vector:N,raster:G,"raster-dem":K,geojson:W,video:j,image:re,canvas:q},U=function(fe,H,ve,Z){var pe=new V[H.type](fe,H,ve,Z);if(pe.id!==fe)throw new Error("Expected Source id to be "+fe+" instead of "+pe.id);return e.bindAll(["load","abort","unload","serialize","prepare"],pe),pe},$=function(fe){return V[fe]},ne=function(fe,H){V[fe]=H};function X(fe,H){var ve=e.identity([]);return e.translate(ve,ve,[1,1,0]),e.scale(ve,ve,[fe.width*.5,fe.height*.5,1]),e.multiply(ve,ve,fe.calculatePosMatrix(H.toUnwrapped()))}function Q(fe,H,ve){if(fe)for(var Z=0,pe=fe;Z<pe.length;Z+=1){var Se=pe[Z],Re=H[Se];if(Re&&Re.source===ve&&Re.type==="fill-extrusion")return!0}else for(var je in H){var ut=H[je];if(ut.source===ve&&ut.type==="fill-extrusion")return!0}return!1}function ie(fe,H,ve,Z,pe,Se){var Re=Q(pe&&pe.layers,H,fe.id),je=Se.maxPitchScaleFactor(),ut=fe.tilesIn(Z,je,Re);ut.sort(oe);for(var Et=[],Jt=0,lr=ut;Jt<lr.length;Jt+=1){var vr=lr[Jt];Et.push({wrappedTileID:vr.tileID.wrapped().key,queryResults:vr.tile.queryRenderedFeatures(H,ve,fe._state,vr.queryGeometry,vr.cameraQueryGeometry,vr.scale,pe,Se,je,X(fe.transform,vr.tileID))})}var Cr=be(Et);for(var Hr in Cr)Cr[Hr].forEach(function(Yr){var Ur=Yr.feature,Jr=fe.getFeatureState(Ur.layer["source-layer"],Ur.id);Ur.source=Ur.layer.source,Ur.layer["source-layer"]&&(Ur.sourceLayer=Ur.layer["source-layer"]),Ur.state=Jr});return Cr}function se(fe,H,ve,Z,pe,Se,Re){for(var je={},ut=Se.queryRenderedSymbols(Z),Et=[],Jt=0,lr=Object.keys(ut).map(Number);Jt<lr.length;Jt+=1){var vr=lr[Jt];Et.push(Re[vr])}Et.sort(oe);for(var Cr=function(){var hn=Yr[Hr],Cn=hn.featureIndex.lookupSymbolFeatures(ut[hn.bucketInstanceId],H,hn.bucketIndex,hn.sourceLayerIndex,pe.filter,pe.layers,pe.availableImages,fe);for(var Fn in Cn){var Kn=je[Fn]=je[Fn]||[],qn=Cn[Fn];qn.sort(function(ya,Ta){var Ca=hn.featureSortOrder;if(Ca){var Va=Ca.indexOf(ya.featureIndex),ni=Ca.indexOf(Ta.featureIndex);return ni-Va}else return Ta.featureIndex-ya.featureIndex});for(var Qn=0,ca=qn;Qn<ca.length;Qn+=1){var ba=ca[Qn];Kn.push(ba)}}},Hr=0,Yr=Et;Hr<Yr.length;Hr+=1)Cr();var Ur=function(hn){je[hn].forEach(function(Cn){var Fn=Cn.feature,Kn=fe[hn],qn=ve[Kn.source],Qn=qn.getFeatureState(Fn.layer["source-layer"],Fn.id);Fn.source=Fn.layer.source,Fn.layer["source-layer"]&&(Fn.sourceLayer=Fn.layer["source-layer"]),Fn.state=Qn})};for(var Jr in je)Ur(Jr);return je}function ae(fe,H){for(var ve=fe.getRenderableIds().map(function(ut){return fe.getTileByID(ut)}),Z=[],pe={},Se=0;Se<ve.length;Se++){var Re=ve[Se],je=Re.tileID.canonical.key;pe[je]||(pe[je]=!0,Re.querySourceFeatures(Z,H))}return Z}function oe(fe,H){var ve=fe.tileID,Z=H.tileID;return ve.overscaledZ-Z.overscaledZ||ve.canonical.y-Z.canonical.y||ve.wrap-Z.wrap||ve.canonical.x-Z.canonical.x}function be(fe){for(var H={},ve={},Z=0,pe=fe;Z<pe.length;Z+=1){var Se=pe[Z],Re=Se.queryResults,je=Se.wrappedTileID,ut=ve[je]=ve[je]||{};for(var Et in Re)for(var Jt=Re[Et],lr=ut[Et]=ut[Et]||{},vr=H[Et]=H[Et]||[],Cr=0,Hr=Jt;Cr<Hr.length;Cr+=1){var Yr=Hr[Cr];lr[Yr.featureIndex]||(lr[Yr.featureIndex]=!0,vr.push(Yr))}}return H}var ce=function(H,ve){this.max=H,this.onRemove=ve,this.reset()};ce.prototype.reset=function(){for(var H in this.data)for(var ve=0,Z=this.data[H];ve<Z.length;ve+=1){var pe=Z[ve];pe.timeout&&clearTimeout(pe.timeout),this.onRemove(pe.value)}return this.data={},this.order=[],this},ce.prototype.add=function(H,ve,Z){var pe=this,Se=H.wrapped().key;this.data[Se]===void 0&&(this.data[Se]=[]);var Re={value:ve,timeout:void 0};if(Z!==void 0&&(Re.timeout=setTimeout(function(){pe.remove(H,Re)},Z)),this.data[Se].push(Re),this.order.push(Se),this.order.length>this.max){var je=this._getAndRemoveByKey(this.order[0]);je&&this.onRemove(je)}return this},ce.prototype.has=function(H){return H.wrapped().key in this.data},ce.prototype.getAndRemove=function(H){return this.has(H)?this._getAndRemoveByKey(H.wrapped().key):null},ce.prototype._getAndRemoveByKey=function(H){var ve=this.data[H].shift();return ve.timeout&&clearTimeout(ve.timeout),this.data[H].length===0&&delete this.data[H],this.order.splice(this.order.indexOf(H),1),ve.value},ce.prototype.getByKey=function(H){var ve=this.data[H];return ve?ve[0].value:null},ce.prototype.get=function(H){if(!this.has(H))return null;var ve=this.data[H.wrapped().key][0];return ve.value},ce.prototype.remove=function(H,ve){if(!this.has(H))return this;var Z=H.wrapped().key,pe=ve===void 0?0:this.data[Z].indexOf(ve),Se=this.data[Z][pe];return this.data[Z].splice(pe,1),Se.timeout&&clearTimeout(Se.timeout),this.data[Z].length===0&&delete this.data[Z],this.onRemove(Se.value),this.order.splice(this.order.indexOf(Z),1),this},ce.prototype.setMaxSize=function(H){for(this.max=H;this.order.length>this.max;){var ve=this._getAndRemoveByKey(this.order[0]);ve&&this.onRemove(ve)}return this},ce.prototype.filter=function(H){var ve=[];for(var Z in this.data)for(var pe=0,Se=this.data[Z];pe<Se.length;pe+=1){var Re=Se[pe];H(Re.value)||ve.push(Re)}for(var je=0,ut=ve;je<ut.length;je+=1){var Et=ut[je];this.remove(Et.value.tileID,Et)}};var de=function(H,ve,Z){this.context=H;var pe=H.gl;this.buffer=pe.createBuffer(),this.dynamicDraw=Boolean(Z),this.context.unbindVAO(),H.bindElementBuffer.set(this.buffer),pe.bufferData(pe.ELEMENT_ARRAY_BUFFER,ve.arrayBuffer,this.dynamicDraw?pe.DYNAMIC_DRAW:pe.STATIC_DRAW),this.dynamicDraw||delete ve.arrayBuffer};de.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},de.prototype.updateData=function(H){var ve=this.context.gl;this.context.unbindVAO(),this.bind(),ve.bufferSubData(ve.ELEMENT_ARRAY_BUFFER,0,H.arrayBuffer)},de.prototype.destroy=function(){var H=this.context.gl;this.buffer&&(H.deleteBuffer(this.buffer),delete this.buffer)};var ye={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ge=function(H,ve,Z,pe){this.length=ve.length,this.attributes=Z,this.itemSize=ve.bytesPerElement,this.dynamicDraw=pe,this.context=H;var Se=H.gl;this.buffer=Se.createBuffer(),H.bindVertexBuffer.set(this.buffer),Se.bufferData(Se.ARRAY_BUFFER,ve.arrayBuffer,this.dynamicDraw?Se.DYNAMIC_DRAW:Se.STATIC_DRAW),this.dynamicDraw||delete ve.arrayBuffer};ge.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ge.prototype.updateData=function(H){var ve=this.context.gl;this.bind(),ve.bufferSubData(ve.ARRAY_BUFFER,0,H.arrayBuffer)},ge.prototype.enableAttributes=function(H,ve){for(var Z=0;Z<this.attributes.length;Z++){var pe=this.attributes[Z],Se=ve.attributes[pe.name];Se!==void 0&&H.enableVertexAttribArray(Se)}},ge.prototype.setVertexAttribPointers=function(H,ve,Z){for(var pe=0;pe<this.attributes.length;pe++){var Se=this.attributes[pe],Re=ve.attributes[Se.name];Re!==void 0&&H.vertexAttribPointer(Re,Se.components,H[ye[Se.type]],!1,this.itemSize,Se.offset+this.itemSize*(Z||0))}},ge.prototype.destroy=function(){var H=this.context.gl;this.buffer&&(H.deleteBuffer(this.buffer),delete this.buffer)};var me=function(H){this.gl=H.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};me.prototype.get=function(){return this.current},me.prototype.set=function(H){},me.prototype.getDefault=function(){return this.default},me.prototype.setDefault=function(){this.set(this.default)};var Ee=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return e.Color.transparent},H.prototype.set=function(Z){var pe=this.current;Z.r===pe.r&&Z.g===pe.g&&Z.b===pe.b&&Z.a===pe.a&&!this.dirty||(this.gl.clearColor(Z.r,Z.g,Z.b,Z.a),this.current=Z,this.dirty=!1)},H}(me),Pe=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return 1},H.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.clearDepth(Z),this.current=Z,this.dirty=!1)},H}(me),Ne=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return 0},H.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.clearStencil(Z),this.current=Z,this.dirty=!1)},H}(me),we=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return[!0,!0,!0,!0]},H.prototype.set=function(Z){var pe=this.current;Z[0]===pe[0]&&Z[1]===pe[1]&&Z[2]===pe[2]&&Z[3]===pe[3]&&!this.dirty||(this.gl.colorMask(Z[0],Z[1],Z[2],Z[3]),this.current=Z,this.dirty=!1)},H}(me),ke=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!0},H.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.depthMask(Z),this.current=Z,this.dirty=!1)},H}(me),Xe=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return 255},H.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.stencilMask(Z),this.current=Z,this.dirty=!1)},H}(me),He=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},H.prototype.set=function(Z){var pe=this.current;Z.func===pe.func&&Z.ref===pe.ref&&Z.mask===pe.mask&&!this.dirty||(this.gl.stencilFunc(Z.func,Z.ref,Z.mask),this.current=Z,this.dirty=!1)},H}(me),Ie=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){var Z=this.gl;return[Z.KEEP,Z.KEEP,Z.KEEP]},H.prototype.set=function(Z){var pe=this.current;Z[0]===pe[0]&&Z[1]===pe[1]&&Z[2]===pe[2]&&!this.dirty||(this.gl.stencilOp(Z[0],Z[1],Z[2]),this.current=Z,this.dirty=!1)},H}(me),De=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!1},H.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;Z?pe.enable(pe.STENCIL_TEST):pe.disable(pe.STENCIL_TEST),this.current=Z,this.dirty=!1}},H}(me),Ge=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return[0,1]},H.prototype.set=function(Z){var pe=this.current;Z[0]===pe[0]&&Z[1]===pe[1]&&!this.dirty||(this.gl.depthRange(Z[0],Z[1]),this.current=Z,this.dirty=!1)},H}(me),ht=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!1},H.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;Z?pe.enable(pe.DEPTH_TEST):pe.disable(pe.DEPTH_TEST),this.current=Z,this.dirty=!1}},H}(me),Rt=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return this.gl.LESS},H.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.depthFunc(Z),this.current=Z,this.dirty=!1)},H}(me),Kt=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!1},H.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;Z?pe.enable(pe.BLEND):pe.disable(pe.BLEND),this.current=Z,this.dirty=!1}},H}(me),It=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){var Z=this.gl;return[Z.ONE,Z.ZERO]},H.prototype.set=function(Z){var pe=this.current;Z[0]===pe[0]&&Z[1]===pe[1]&&!this.dirty||(this.gl.blendFunc(Z[0],Z[1]),this.current=Z,this.dirty=!1)},H}(me),Mt=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return e.Color.transparent},H.prototype.set=function(Z){var pe=this.current;Z.r===pe.r&&Z.g===pe.g&&Z.b===pe.b&&Z.a===pe.a&&!this.dirty||(this.gl.blendColor(Z.r,Z.g,Z.b,Z.a),this.current=Z,this.dirty=!1)},H}(me),Yt=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return this.gl.FUNC_ADD},H.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.blendEquation(Z),this.current=Z,this.dirty=!1)},H}(me),zt=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!1},H.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;Z?pe.enable(pe.CULL_FACE):pe.disable(pe.CULL_FACE),this.current=Z,this.dirty=!1}},H}(me),St=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return this.gl.BACK},H.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.cullFace(Z),this.current=Z,this.dirty=!1)},H}(me),Ye=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return this.gl.CCW},H.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.frontFace(Z),this.current=Z,this.dirty=!1)},H}(me),rt=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.useProgram(Z),this.current=Z,this.dirty=!1)},H}(me),Ve=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return this.gl.TEXTURE0},H.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.activeTexture(Z),this.current=Z,this.dirty=!1)},H}(me),Ae=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){var Z=this.gl;return[0,0,Z.drawingBufferWidth,Z.drawingBufferHeight]},H.prototype.set=function(Z){var pe=this.current;Z[0]===pe[0]&&Z[1]===pe[1]&&Z[2]===pe[2]&&Z[3]===pe[3]&&!this.dirty||(this.gl.viewport(Z[0],Z[1],Z[2],Z[3]),this.current=Z,this.dirty=!1)},H}(me),Ue=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.bindFramebuffer(pe.FRAMEBUFFER,Z),this.current=Z,this.dirty=!1}},H}(me),Ze=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.bindRenderbuffer(pe.RENDERBUFFER,Z),this.current=Z,this.dirty=!1}},H}(me),Qe=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.bindTexture(pe.TEXTURE_2D,Z),this.current=Z,this.dirty=!1}},H}(me),_t=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.bindBuffer(pe.ARRAY_BUFFER,Z),this.current=Z,this.dirty=!1}},H}(me),gt=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(Z){var pe=this.gl;pe.bindBuffer(pe.ELEMENT_ARRAY_BUFFER,Z),this.current=Z,this.dirty=!1},H}(me),wt=function(fe){function H(ve){fe.call(this,ve),this.vao=ve.extVertexArrayObject}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(Z){!this.vao||Z===this.current&&!this.dirty||(this.vao.bindVertexArrayOES(Z),this.current=Z,this.dirty=!1)},H}(me),Ut=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return 4},H.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.pixelStorei(pe.UNPACK_ALIGNMENT,Z),this.current=Z,this.dirty=!1}},H}(me),Dt=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!1},H.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.pixelStorei(pe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Z),this.current=Z,this.dirty=!1}},H}(me),Nt=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!1},H.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.pixelStorei(pe.UNPACK_FLIP_Y_WEBGL,Z),this.current=Z,this.dirty=!1}},H}(me),Xt=function(fe){function H(ve,Z){fe.call(this,ve),this.context=ve,this.parent=Z}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H}(me),Ht=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.setDirty=function(){this.dirty=!0},H.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){this.context.bindFramebuffer.set(this.parent);var pe=this.gl;pe.framebufferTexture2D(pe.FRAMEBUFFER,pe.COLOR_ATTACHMENT0,pe.TEXTURE_2D,Z,0),this.current=Z,this.dirty=!1}},H}(Xt),ar=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){this.context.bindFramebuffer.set(this.parent);var pe=this.gl;pe.framebufferRenderbuffer(pe.FRAMEBUFFER,pe.DEPTH_ATTACHMENT,pe.RENDERBUFFER,Z),this.current=Z,this.dirty=!1}},H}(Xt),Vr=function(H,ve,Z,pe){this.context=H,this.width=ve,this.height=Z;var Se=H.gl,Re=this.framebuffer=Se.createFramebuffer();this.colorAttachment=new Ht(H,Re),pe&&(this.depthAttachment=new ar(H,Re))};Vr.prototype.destroy=function(){var H=this.context.gl,ve=this.colorAttachment.get();if(ve&&H.deleteTexture(ve),this.depthAttachment){var Z=this.depthAttachment.get();Z&&H.deleteRenderbuffer(Z)}H.deleteFramebuffer(this.framebuffer)};var nn=519,jr=function(H,ve,Z){this.func=H,this.mask=ve,this.range=Z};jr.ReadOnly=!1,jr.ReadWrite=!0,jr.disabled=new jr(nn,jr.ReadOnly,[0,1]);var at=519,$t=7680,Zt=function(H,ve,Z,pe,Se,Re){this.test=H,this.ref=ve,this.mask=Z,this.fail=pe,this.depthFail=Se,this.pass=Re};Zt.disabled=new Zt({func:at,mask:0},0,0,$t,$t,$t);var ur=0,wr=1,$e=771,Je=function(H,ve,Z){this.blendFunction=H,this.blendColor=ve,this.mask=Z};Je.Replace=[wr,ur],Je.disabled=new Je(Je.Replace,e.Color.transparent,[!1,!1,!1,!1]),Je.unblended=new Je(Je.Replace,e.Color.transparent,[!0,!0,!0,!0]),Je.alphaBlended=new Je([wr,$e],e.Color.transparent,[!0,!0,!0,!0]);var it=1029,lt=2305,Tt=function(H,ve,Z){this.enable=H,this.mode=ve,this.frontFace=Z};Tt.disabled=new Tt(!1,it,lt),Tt.backCCW=new Tt(!0,it,lt);var Bt=function(H){this.gl=H,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ee(this),this.clearDepth=new Pe(this),this.clearStencil=new Ne(this),this.colorMask=new we(this),this.depthMask=new ke(this),this.stencilMask=new Xe(this),this.stencilFunc=new He(this),this.stencilOp=new Ie(this),this.stencilTest=new De(this),this.depthRange=new Ge(this),this.depthTest=new ht(this),this.depthFunc=new Rt(this),this.blend=new Kt(this),this.blendFunc=new It(this),this.blendColor=new Mt(this),this.blendEquation=new Yt(this),this.cullFace=new zt(this),this.cullFaceSide=new St(this),this.frontFace=new Ye(this),this.program=new rt(this),this.activeTexture=new Ve(this),this.viewport=new Ae(this),this.bindFramebuffer=new Ue(this),this.bindRenderbuffer=new Ze(this),this.bindTexture=new Qe(this),this.bindVertexBuffer=new _t(this),this.bindElementBuffer=new gt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new wt(this),this.pixelStoreUnpack=new Ut(this),this.pixelStoreUnpackPremultiplyAlpha=new Dt(this),this.pixelStoreUnpackFlipY=new Nt(this),this.extTextureFilterAnisotropic=H.getExtension("EXT_texture_filter_anisotropic")||H.getExtension("MOZ_EXT_texture_filter_anisotropic")||H.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=H.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=H.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(H.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=H.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=H.getExtension("EXT_disjoint_timer_query")};Bt.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Bt.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Bt.prototype.createIndexBuffer=function(H,ve){return new de(this,H,ve)},Bt.prototype.createVertexBuffer=function(H,ve,Z){return new ge(this,H,ve,Z)},Bt.prototype.createRenderbuffer=function(H,ve,Z){var pe=this.gl,Se=pe.createRenderbuffer();return this.bindRenderbuffer.set(Se),pe.renderbufferStorage(pe.RENDERBUFFER,H,ve,Z),this.bindRenderbuffer.set(null),Se},Bt.prototype.createFramebuffer=function(H,ve,Z){return new Vr(this,H,ve,Z)},Bt.prototype.clear=function(H){var ve=H.color,Z=H.depth,pe=this.gl,Se=0;ve&&(Se|=pe.COLOR_BUFFER_BIT,this.clearColor.set(ve),this.colorMask.set([!0,!0,!0,!0])),typeof Z<"u"&&(Se|=pe.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(Z),this.depthMask.set(!0)),pe.clear(Se)},Bt.prototype.setCullFace=function(H){H.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(H.mode),this.frontFace.set(H.frontFace))},Bt.prototype.setDepthMode=function(H){H.func===this.gl.ALWAYS&&!H.mask?this.depthTest.set(!1):(this.depthTest.set(!0),this.depthFunc.set(H.func),this.depthMask.set(H.mask),this.depthRange.set(H.range))},Bt.prototype.setStencilMode=function(H){H.test.func===this.gl.ALWAYS&&!H.mask?this.stencilTest.set(!1):(this.stencilTest.set(!0),this.stencilMask.set(H.mask),this.stencilOp.set([H.fail,H.depthFail,H.pass]),this.stencilFunc.set({func:H.test.func,ref:H.ref,mask:H.test.mask}))},Bt.prototype.setColorMode=function(H){e.deepEqual(H.blendFunction,Je.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(H.blendFunction),this.blendColor.set(H.blendColor)),this.colorMask.set(H.mask)},Bt.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ce=function(fe){function H(ve,Z,pe){var Se=this;fe.call(this),this.id=ve,this.dispatcher=pe,this.on("data",function(Re){Re.dataType==="source"&&Re.sourceDataType==="metadata"&&(Se._sourceLoaded=!0),Se._sourceLoaded&&!Se._paused&&Re.dataType==="source"&&Re.sourceDataType==="content"&&(Se.reload(),Se.transform&&Se.update(Se.transform))}),this.on("error",function(){Se._sourceErrored=!0}),this._source=U(ve,Z,pe,this),this._tiles={},this._cache=new ce(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.onAdd=function(Z){this.map=Z,this._maxTileCacheSize=Z?Z._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(Z)},H.prototype.onRemove=function(Z){this._source&&this._source.onRemove&&this._source.onRemove(Z)},H.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var Z in this._tiles){var pe=this._tiles[Z];if(pe.state!=="loaded"&&pe.state!=="errored")return!1}return!0},H.prototype.getSource=function(){return this._source},H.prototype.pause=function(){this._paused=!0},H.prototype.resume=function(){if(!!this._paused){var Z=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,Z&&this.reload(),this.transform&&this.update(this.transform)}},H.prototype._loadTile=function(Z,pe){return this._source.loadTile(Z,pe)},H.prototype._unloadTile=function(Z){if(this._source.unloadTile)return this._source.unloadTile(Z,function(){})},H.prototype._abortTile=function(Z){if(this._source.abortTile)return this._source.abortTile(Z,function(){})},H.prototype.serialize=function(){return this._source.serialize()},H.prototype.prepare=function(Z){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(var pe in this._tiles){var Se=this._tiles[pe];Se.upload(Z),Se.prepare(this.map.style.imageManager)}},H.prototype.getIds=function(){return e.values(this._tiles).map(function(Z){return Z.tileID}).sort(Me).map(function(Z){return Z.key})},H.prototype.getRenderableIds=function(Z){var pe=this,Se=[];for(var Re in this._tiles)this._isIdRenderable(Re,Z)&&Se.push(this._tiles[Re]);return Z?Se.sort(function(je,ut){var Et=je.tileID,Jt=ut.tileID,lr=new e.Point(Et.canonical.x,Et.canonical.y)._rotate(pe.transform.angle),vr=new e.Point(Jt.canonical.x,Jt.canonical.y)._rotate(pe.transform.angle);return Et.overscaledZ-Jt.overscaledZ||vr.y-lr.y||vr.x-lr.x}).map(function(je){return je.tileID.key}):Se.map(function(je){return je.tileID}).sort(Me).map(function(je){return je.key})},H.prototype.hasRenderableParent=function(Z){var pe=this.findLoadedParent(Z,0);return pe?this._isIdRenderable(pe.tileID.key):!1},H.prototype._isIdRenderable=function(Z,pe){return this._tiles[Z]&&this._tiles[Z].hasData()&&!this._coveredTiles[Z]&&(pe||!this._tiles[Z].holdingForFade())},H.prototype.reload=function(){if(this._paused){this._shouldReloadOnResume=!0;return}this._cache.reset();for(var Z in this._tiles)this._tiles[Z].state!=="errored"&&this._reloadTile(Z,"reloading")},H.prototype._reloadTile=function(Z,pe){var Se=this._tiles[Z];!Se||(Se.state!=="loading"&&(Se.state=pe),this._loadTile(Se,this._tileLoaded.bind(this,Se,Z,pe)))},H.prototype._tileLoaded=function(Z,pe,Se,Re){if(Re){Z.state="errored",Re.status!==404?this._source.fire(new e.ErrorEvent(Re,{tile:Z})):this.update(this.transform);return}Z.timeAdded=e.browser.now(),Se==="expired"&&(Z.refreshedUponExpiration=!0),this._setTileReloadTimer(pe,Z),this.getSource().type==="raster-dem"&&Z.dem&&this._backfillDEM(Z),this._state.initializeTileState(Z,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:Z,coord:Z.tileID}))},H.prototype._backfillDEM=function(Z){for(var pe=this.getRenderableIds(),Se=0;Se<pe.length;Se++){var Re=pe[Se];if(Z.neighboringTiles&&Z.neighboringTiles[Re]){var je=this.getTileByID(Re);ut(Z,je),ut(je,Z)}}function ut(Et,Jt){Et.needsHillshadePrepare=!0;var lr=Jt.tileID.canonical.x-Et.tileID.canonical.x,vr=Jt.tileID.canonical.y-Et.tileID.canonical.y,Cr=Math.pow(2,Et.tileID.canonical.z),Hr=Jt.tileID.key;lr===0&&vr===0||Math.abs(vr)>1||(Math.abs(lr)>1&&(Math.abs(lr+Cr)===1?lr+=Cr:Math.abs(lr-Cr)===1&&(lr-=Cr)),!(!Jt.dem||!Et.dem)&&(Et.dem.backfillBorder(Jt.dem,lr,vr),Et.neighboringTiles&&Et.neighboringTiles[Hr]&&(Et.neighboringTiles[Hr].backfilled=!0)))}},H.prototype.getTile=function(Z){return this.getTileByID(Z.key)},H.prototype.getTileByID=function(Z){return this._tiles[Z]},H.prototype._retainLoadedChildren=function(Z,pe,Se,Re){for(var je in this._tiles){var ut=this._tiles[je];if(!(Re[je]||!ut.hasData()||ut.tileID.overscaledZ<=pe||ut.tileID.overscaledZ>Se)){for(var Et=ut.tileID;ut&&ut.tileID.overscaledZ>pe+1;){var Jt=ut.tileID.scaledTo(ut.tileID.overscaledZ-1);ut=this._tiles[Jt.key],ut&&ut.hasData()&&(Et=Jt)}for(var lr=Et;lr.overscaledZ>pe;)if(lr=lr.scaledTo(lr.overscaledZ-1),Z[lr.key]){Re[Et.key]=Et;break}}}},H.prototype.findLoadedParent=function(Z,pe){if(Z.key in this._loadedParentTiles){var Se=this._loadedParentTiles[Z.key];return Se&&Se.tileID.overscaledZ>=pe?Se:null}for(var Re=Z.overscaledZ-1;Re>=pe;Re--){var je=Z.scaledTo(Re),ut=this._getLoadedTile(je);if(ut)return ut}},H.prototype._getLoadedTile=function(Z){var pe=this._tiles[Z.key];if(pe&&pe.hasData())return pe;var Se=this._cache.getByKey(Z.wrapped().key);return Se},H.prototype.updateCacheSize=function(Z){var pe=Math.ceil(Z.width/this._source.tileSize)+1,Se=Math.ceil(Z.height/this._source.tileSize)+1,Re=pe*Se,je=5,ut=Math.floor(Re*je),Et=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,ut):ut;this._cache.setMaxSize(Et)},H.prototype.handleWrapJump=function(Z){var pe=this._prevLng===void 0?Z:this._prevLng,Se=Z-pe,Re=Se/360,je=Math.round(Re);if(this._prevLng=Z,je){var ut={};for(var Et in this._tiles){var Jt=this._tiles[Et];Jt.tileID=Jt.tileID.unwrapTo(Jt.tileID.wrap+je),ut[Jt.tileID.key]=Jt}this._tiles=ut;for(var lr in this._timers)clearTimeout(this._timers[lr]),delete this._timers[lr];for(var vr in this._tiles){var Cr=this._tiles[vr];this._setTileReloadTimer(vr,Cr)}}},H.prototype.update=function(Z){var pe=this;if(this.transform=Z,!(!this._sourceLoaded||this._paused)){this.updateCacheSize(Z),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={};var Se;this.used?this._source.tileID?Se=Z.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(ya){return new e.OverscaledTileID(ya.canonical.z,ya.wrap,ya.canonical.z,ya.canonical.x,ya.canonical.y)}):(Se=Z.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(Se=Se.filter(function(ya){return pe._source.hasTile(ya)}))):Se=[];var Re=Z.coveringZoomLevel(this._source),je=Math.max(Re-H.maxOverzooming,this._source.minzoom),ut=Math.max(Re+H.maxUnderzooming,this._source.minzoom),Et=this._updateRetainedTiles(Se,Re);if(nt(this._source.type)){for(var Jt={},lr={},vr=Object.keys(Et),Cr=0,Hr=vr;Cr<Hr.length;Cr+=1){var Yr=Hr[Cr],Ur=Et[Yr],Jr=this._tiles[Yr];if(!(!Jr||Jr.fadeEndTime&&Jr.fadeEndTime<=e.browser.now())){var hn=this.findLoadedParent(Ur,je);hn&&(this._addTile(hn.tileID),Jt[hn.tileID.key]=hn.tileID),lr[Yr]=Ur}}this._retainLoadedChildren(lr,Re,ut,Et);for(var Cn in Jt)Et[Cn]||(this._coveredTiles[Cn]=!0,Et[Cn]=Jt[Cn])}for(var Fn in Et)this._tiles[Fn].clearFadeHold();for(var Kn=e.keysDifference(this._tiles,Et),qn=0,Qn=Kn;qn<Qn.length;qn+=1){var ca=Qn[qn],ba=this._tiles[ca];ba.hasSymbolBuckets&&!ba.holdingForFade()?ba.setHoldDuration(this.map._fadeDuration):(!ba.hasSymbolBuckets||ba.symbolFadeFinished())&&this._removeTile(ca)}this._updateLoadedParentTileCache()}},H.prototype.releaseSymbolFadeTiles=function(){for(var Z in this._tiles)this._tiles[Z].holdingForFade()&&this._removeTile(Z)},H.prototype._updateRetainedTiles=function(Z,pe){for(var Se={},Re={},je=Math.max(pe-H.maxOverzooming,this._source.minzoom),ut=Math.max(pe+H.maxUnderzooming,this._source.minzoom),Et={},Jt=0,lr=Z;Jt<lr.length;Jt+=1){var vr=lr[Jt],Cr=this._addTile(vr);Se[vr.key]=vr,!Cr.hasData()&&pe<this._source.maxzoom&&(Et[vr.key]=vr)}this._retainLoadedChildren(Et,pe,ut,Se);for(var Hr=0,Yr=Z;Hr<Yr.length;Hr+=1){var Ur=Yr[Hr],Jr=this._tiles[Ur.key];if(!Jr.hasData()){if(pe+1>this._source.maxzoom){var hn=Ur.children(this._source.maxzoom)[0],Cn=this.getTile(hn);if(!!Cn&&Cn.hasData()){Se[hn.key]=hn;continue}}else{var Fn=Ur.children(this._source.maxzoom);if(Se[Fn[0].key]&&Se[Fn[1].key]&&Se[Fn[2].key]&&Se[Fn[3].key])continue}for(var Kn=Jr.wasRequested(),qn=Ur.overscaledZ-1;qn>=je;--qn){var Qn=Ur.scaledTo(qn);if(Re[Qn.key]||(Re[Qn.key]=!0,Jr=this.getTile(Qn),!Jr&&Kn&&(Jr=this._addTile(Qn)),Jr&&(Se[Qn.key]=Qn,Kn=Jr.wasRequested(),Jr.hasData())))break}}}return Se},H.prototype._updateLoadedParentTileCache=function(){this._loadedParentTiles={};for(var Z in this._tiles){for(var pe=[],Se=void 0,Re=this._tiles[Z].tileID;Re.overscaledZ>0;){if(Re.key in this._loadedParentTiles){Se=this._loadedParentTiles[Re.key];break}pe.push(Re.key);var je=Re.scaledTo(Re.overscaledZ-1);if(Se=this._getLoadedTile(je),Se)break;Re=je}for(var ut=0,Et=pe;ut<Et.length;ut+=1){var Jt=Et[ut];this._loadedParentTiles[Jt]=Se}}},H.prototype._addTile=function(Z){var pe=this._tiles[Z.key];if(pe)return pe;pe=this._cache.getAndRemove(Z),pe&&(this._setTileReloadTimer(Z.key,pe),pe.tileID=Z,this._state.initializeTileState(pe,this.map?this.map.painter:null),this._cacheTimers[Z.key]&&(clearTimeout(this._cacheTimers[Z.key]),delete this._cacheTimers[Z.key],this._setTileReloadTimer(Z.key,pe)));var Se=Boolean(pe);return Se||(pe=new e.Tile(Z,this._source.tileSize*Z.overscaleFactor()),this._loadTile(pe,this._tileLoaded.bind(this,pe,Z.key,pe.state))),pe?(pe.uses++,this._tiles[Z.key]=pe,Se||this._source.fire(new e.Event("dataloading",{tile:pe,coord:pe.tileID,dataType:"source"})),pe):null},H.prototype._setTileReloadTimer=function(Z,pe){var Se=this;Z in this._timers&&(clearTimeout(this._timers[Z]),delete this._timers[Z]);var Re=pe.getExpiryTimeout();Re&&(this._timers[Z]=setTimeout(function(){Se._reloadTile(Z,"expired"),delete Se._timers[Z]},Re))},H.prototype._removeTile=function(Z){var pe=this._tiles[Z];!pe||(pe.uses--,delete this._tiles[Z],this._timers[Z]&&(clearTimeout(this._timers[Z]),delete this._timers[Z]),!(pe.uses>0)&&(pe.hasData()&&pe.state!=="reloading"?this._cache.add(pe.tileID,pe,pe.getExpiryTimeout()):(pe.aborted=!0,this._abortTile(pe),this._unloadTile(pe))))},H.prototype.clearTiles=function(){this._shouldReloadOnResume=!1,this._paused=!1;for(var Z in this._tiles)this._removeTile(Z);this._cache.reset()},H.prototype.tilesIn=function(Z,pe,Se){var Re=this,je=[],ut=this.transform;if(!ut)return je;for(var Et=Se?ut.getCameraQueryGeometry(Z):Z,Jt=Z.map(function(qn){return ut.pointCoordinate(qn)}),lr=Et.map(function(qn){return ut.pointCoordinate(qn)}),vr=this.getIds(),Cr=1/0,Hr=1/0,Yr=-1/0,Ur=-1/0,Jr=0,hn=lr;Jr<hn.length;Jr+=1){var Cn=hn[Jr];Cr=Math.min(Cr,Cn.x),Hr=Math.min(Hr,Cn.y),Yr=Math.max(Yr,Cn.x),Ur=Math.max(Ur,Cn.y)}for(var Fn=function(qn){var Qn=Re._tiles[vr[qn]];if(!Qn.holdingForFade()){var ca=Qn.tileID,ba=Math.pow(2,ut.zoom-Qn.tileID.overscaledZ),ya=pe*Qn.queryPadding*e.EXTENT/Qn.tileSize/ba,Ta=[ca.getTilePoint(new e.MercatorCoordinate(Cr,Hr)),ca.getTilePoint(new e.MercatorCoordinate(Yr,Ur))];if(Ta[0].x-ya<e.EXTENT&&Ta[0].y-ya<e.EXTENT&&Ta[1].x+ya>=0&&Ta[1].y+ya>=0){var Ca=Jt.map(function(ni){return ca.getTilePoint(ni)}),Va=lr.map(function(ni){return ca.getTilePoint(ni)});je.push({tile:Qn,tileID:ca,queryGeometry:Ca,cameraQueryGeometry:Va,scale:ba})}}},Kn=0;Kn<vr.length;Kn++)Fn(Kn);return je},H.prototype.getVisibleCoordinates=function(Z){for(var pe=this,Se=this.getRenderableIds(Z).map(function(Et){return pe._tiles[Et].tileID}),Re=0,je=Se;Re<je.length;Re+=1){var ut=je[Re];ut.posMatrix=this.transform.calculatePosMatrix(ut.toUnwrapped())}return Se},H.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(nt(this._source.type))for(var Z in this._tiles){var pe=this._tiles[Z];if(pe.fadeEndTime!==void 0&&pe.fadeEndTime>=e.browser.now())return!0}return!1},H.prototype.setFeatureState=function(Z,pe,Se){Z=Z||"_geojsonTileLayer",this._state.updateState(Z,pe,Se)},H.prototype.removeFeatureState=function(Z,pe,Se){Z=Z||"_geojsonTileLayer",this._state.removeFeatureState(Z,pe,Se)},H.prototype.getFeatureState=function(Z,pe){return Z=Z||"_geojsonTileLayer",this._state.getState(Z,pe)},H.prototype.setDependencies=function(Z,pe,Se){var Re=this._tiles[Z];Re&&Re.setDependencies(pe,Se)},H.prototype.reloadTilesForDependencies=function(Z,pe){for(var Se in this._tiles){var Re=this._tiles[Se];Re.hasDependency(Z,pe)&&this._reloadTile(Se,"reloading")}this._cache.filter(function(je){return!je.hasDependency(Z,pe)})},H}(e.Evented);Ce.maxOverzooming=10,Ce.maxUnderzooming=3;function Me(fe,H){var ve=Math.abs(fe.wrap*2)-+(fe.wrap<0),Z=Math.abs(H.wrap*2)-+(H.wrap<0);return fe.overscaledZ-H.overscaledZ||Z-ve||H.canonical.y-fe.canonical.y||H.canonical.x-fe.canonical.x}function nt(fe){return fe==="raster"||fe==="image"||fe==="video"}function st(){return new e.window.Worker(Dc.workerUrl)}var ct="mapboxgl_preloaded_worker_pool",At=function(){this.active={}};At.prototype.acquire=function(H){if(!this.workers)for(this.workers=[];this.workers.length<At.workerCount;)this.workers.push(new st);return this.active[H]=!0,this.workers.slice()},At.prototype.release=function(H){delete this.active[H],this.numActive()===0&&(this.workers.forEach(function(ve){ve.terminate()}),this.workers=null)},At.prototype.isPreloaded=function(){return!!this.active[ct]},At.prototype.numActive=function(){return Object.keys(this.active).length};var dt=Math.floor(e.browser.hardwareConcurrency/2);At.workerCount=Math.max(Math.min(dt,6),1);var Ct;function Gt(){return Ct||(Ct=new At),Ct}function rr(){var fe=Gt();fe.acquire(ct)}function kr(){var fe=Ct;fe&&(fe.isPreloaded()&&fe.numActive()===1?(fe.release(ct),Ct=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))}function br(fe,H){var ve={};for(var Z in fe)Z!=="ref"&&(ve[Z]=fe[Z]);return e.refProperties.forEach(function(pe){pe in H&&(ve[pe]=H[pe])}),ve}function Ar(fe){fe=fe.slice();for(var H=Object.create(null),ve=0;ve<fe.length;ve++)H[fe[ve].id]=fe[ve];for(var Z=0;Z<fe.length;Z++)"ref"in fe[Z]&&(fe[Z]=br(fe[Z],H[fe[Z].ref]));return fe}function Wr(){var fe={},H=e.styleSpec.$version;for(var ve in e.styleSpec.$root){var Z=e.styleSpec.$root[ve];if(Z.required){var pe=null;ve==="version"?pe=H:Z.type==="array"?pe=[]:pe={},pe!=null&&(fe[ve]=pe)}}return fe}var nr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function yr(fe,H,ve){ve.push({command:nr.addSource,args:[fe,H[fe]]})}function Pr(fe,H,ve){H.push({command:nr.removeSource,args:[fe]}),ve[fe]=!0}function Or(fe,H,ve,Z){Pr(fe,ve,Z),yr(fe,H,ve)}function Sr(fe,H,ve){var Z;for(Z in fe[ve])if(!!fe[ve].hasOwnProperty(Z)&&Z!=="data"&&!e.deepEqual(fe[ve][Z],H[ve][Z]))return!1;for(Z in H[ve])if(!!H[ve].hasOwnProperty(Z)&&Z!=="data"&&!e.deepEqual(fe[ve][Z],H[ve][Z]))return!1;return!0}function tt(fe,H,ve,Z){fe=fe||{},H=H||{};var pe;for(pe in fe)!fe.hasOwnProperty(pe)||H.hasOwnProperty(pe)||Pr(pe,ve,Z);for(pe in H)!H.hasOwnProperty(pe)||(fe.hasOwnProperty(pe)?e.deepEqual(fe[pe],H[pe])||(fe[pe].type==="geojson"&&H[pe].type==="geojson"&&Sr(fe,H,pe)?ve.push({command:nr.setGeoJSONSourceData,args:[pe,H[pe].data]}):Or(pe,H,ve,Z)):yr(pe,H,ve))}function Lt(fe,H,ve,Z,pe,Se){fe=fe||{},H=H||{};var Re;for(Re in fe)!fe.hasOwnProperty(Re)||e.deepEqual(fe[Re],H[Re])||ve.push({command:Se,args:[Z,Re,H[Re],pe]});for(Re in H)!H.hasOwnProperty(Re)||fe.hasOwnProperty(Re)||e.deepEqual(fe[Re],H[Re])||ve.push({command:Se,args:[Z,Re,H[Re],pe]})}function Wt(fe){return fe.id}function ir(fe,H){return fe[H.id]=H,fe}function Ir(fe,H,ve){fe=fe||[],H=H||[];var Z=fe.map(Wt),pe=H.map(Wt),Se=fe.reduce(ir,{}),Re=H.reduce(ir,{}),je=Z.slice(),ut=Object.create(null),Et,Jt,lr,vr,Cr,Hr,Yr;for(Et=0,Jt=0;Et<Z.length;Et++)lr=Z[Et],Re.hasOwnProperty(lr)?Jt++:(ve.push({command:nr.removeLayer,args:[lr]}),je.splice(je.indexOf(lr,Jt),1));for(Et=0,Jt=0;Et<pe.length;Et++)lr=pe[pe.length-1-Et],je[je.length-1-Et]!==lr&&(Se.hasOwnProperty(lr)?(ve.push({command:nr.removeLayer,args:[lr]}),je.splice(je.lastIndexOf(lr,je.length-Jt),1)):Jt++,Hr=je[je.length-Et],ve.push({command:nr.addLayer,args:[Re[lr],Hr]}),je.splice(je.length-Et,0,lr),ut[lr]=!0);for(Et=0;Et<pe.length;Et++)if(lr=pe[Et],vr=Se[lr],Cr=Re[lr],!(ut[lr]||e.deepEqual(vr,Cr))){if(!e.deepEqual(vr.source,Cr.source)||!e.deepEqual(vr["source-layer"],Cr["source-layer"])||!e.deepEqual(vr.type,Cr.type)){ve.push({command:nr.removeLayer,args:[lr]}),Hr=je[je.lastIndexOf(lr)+1],ve.push({command:nr.addLayer,args:[Cr,Hr]});continue}Lt(vr.layout,Cr.layout,ve,lr,null,nr.setLayoutProperty),Lt(vr.paint,Cr.paint,ve,lr,null,nr.setPaintProperty),e.deepEqual(vr.filter,Cr.filter)||ve.push({command:nr.setFilter,args:[lr,Cr.filter]}),(!e.deepEqual(vr.minzoom,Cr.minzoom)||!e.deepEqual(vr.maxzoom,Cr.maxzoom))&&ve.push({command:nr.setLayerZoomRange,args:[lr,Cr.minzoom,Cr.maxzoom]});for(Yr in vr)!vr.hasOwnProperty(Yr)||Yr==="layout"||Yr==="paint"||Yr==="filter"||Yr==="metadata"||Yr==="minzoom"||Yr==="maxzoom"||(Yr.indexOf("paint.")===0?Lt(vr[Yr],Cr[Yr],ve,lr,Yr.slice(6),nr.setPaintProperty):e.deepEqual(vr[Yr],Cr[Yr])||ve.push({command:nr.setLayerProperty,args:[lr,Yr,Cr[Yr]]}));for(Yr in Cr)!Cr.hasOwnProperty(Yr)||vr.hasOwnProperty(Yr)||Yr==="layout"||Yr==="paint"||Yr==="filter"||Yr==="metadata"||Yr==="minzoom"||Yr==="maxzoom"||(Yr.indexOf("paint.")===0?Lt(vr[Yr],Cr[Yr],ve,lr,Yr.slice(6),nr.setPaintProperty):e.deepEqual(vr[Yr],Cr[Yr])||ve.push({command:nr.setLayerProperty,args:[lr,Yr,Cr[Yr]]}))}}function Br(fe,H){if(!fe)return[{command:nr.setStyle,args:[H]}];var ve=[];try{if(!e.deepEqual(fe.version,H.version))return[{command:nr.setStyle,args:[H]}];e.deepEqual(fe.center,H.center)||ve.push({command:nr.setCenter,args:[H.center]}),e.deepEqual(fe.zoom,H.zoom)||ve.push({command:nr.setZoom,args:[H.zoom]}),e.deepEqual(fe.bearing,H.bearing)||ve.push({command:nr.setBearing,args:[H.bearing]}),e.deepEqual(fe.pitch,H.pitch)||ve.push({command:nr.setPitch,args:[H.pitch]}),e.deepEqual(fe.sprite,H.sprite)||ve.push({command:nr.setSprite,args:[H.sprite]}),e.deepEqual(fe.glyphs,H.glyphs)||ve.push({command:nr.setGlyphs,args:[H.glyphs]}),e.deepEqual(fe.transition,H.transition)||ve.push({command:nr.setTransition,args:[H.transition]}),e.deepEqual(fe.light,H.light)||ve.push({command:nr.setLight,args:[H.light]});var Z={},pe=[];tt(fe.sources,H.sources,pe,Z);var Se=[];fe.layers&&fe.layers.forEach(function(Re){Z[Re.source]?ve.push({command:nr.removeLayer,args:[Re.id]}):Se.push(Re)}),ve=ve.concat(pe),Ir(Se,H.layers,ve)}catch(Re){console.warn("Unable to compute style diff:",Re),ve=[{command:nr.setStyle,args:[H]}]}return ve}var Er=function(H,ve){this.reset(H,ve)};Er.prototype.reset=function(H,ve){this.points=H||[],this._distances=[0];for(var Z=1;Z<this.points.length;Z++)this._distances[Z]=this._distances[Z-1]+this.points[Z].dist(this.points[Z-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(ve||0,this.length*.5),this.paddedLength=this.length-this.padding*2},Er.prototype.lerp=function(H){if(this.points.length===1)return this.points[0];H=e.clamp(H,0,1);for(var ve=1,Z=this._distances[ve],pe=H*this.paddedLength+this.padding;Z<pe&&ve<this._distances.length;)Z=this._distances[++ve];var Se=ve-1,Re=this._distances[Se],je=Z-Re,ut=je>0?(pe-Re)/je:0;return this.points[Se].mult(1-ut).add(this.points[ve].mult(ut))};var _r=function(H,ve,Z){var pe=this.boxCells=[],Se=this.circleCells=[];this.xCellCount=Math.ceil(H/Z),this.yCellCount=Math.ceil(ve/Z);for(var Re=0;Re<this.xCellCount*this.yCellCount;Re++)pe.push([]),Se.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=H,this.height=ve,this.xScale=this.xCellCount/H,this.yScale=this.yCellCount/ve,this.boxUid=0,this.circleUid=0};_r.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},_r.prototype.insert=function(H,ve,Z,pe,Se){this._forEachCell(ve,Z,pe,Se,this._insertBoxCell,this.boxUid++),this.boxKeys.push(H),this.bboxes.push(ve),this.bboxes.push(Z),this.bboxes.push(pe),this.bboxes.push(Se)},_r.prototype.insertCircle=function(H,ve,Z,pe){this._forEachCell(ve-pe,Z-pe,ve+pe,Z+pe,this._insertCircleCell,this.circleUid++),this.circleKeys.push(H),this.circles.push(ve),this.circles.push(Z),this.circles.push(pe)},_r.prototype._insertBoxCell=function(H,ve,Z,pe,Se,Re){this.boxCells[Se].push(Re)},_r.prototype._insertCircleCell=function(H,ve,Z,pe,Se,Re){this.circleCells[Se].push(Re)},_r.prototype._query=function(H,ve,Z,pe,Se,Re){if(Z<0||H>this.width||pe<0||ve>this.height)return Se?!1:[];var je=[];if(H<=0&&ve<=0&&this.width<=Z&&this.height<=pe){if(Se)return!0;for(var ut=0;ut<this.boxKeys.length;ut++)je.push({key:this.boxKeys[ut],x1:this.bboxes[ut*4],y1:this.bboxes[ut*4+1],x2:this.bboxes[ut*4+2],y2:this.bboxes[ut*4+3]});for(var Et=0;Et<this.circleKeys.length;Et++){var Jt=this.circles[Et*3],lr=this.circles[Et*3+1],vr=this.circles[Et*3+2];je.push({key:this.circleKeys[Et],x1:Jt-vr,y1:lr-vr,x2:Jt+vr,y2:lr+vr})}return Re?je.filter(Re):je}else{var Cr={hitTest:Se,seenUids:{box:{},circle:{}}};return this._forEachCell(H,ve,Z,pe,this._queryCell,je,Cr,Re),Se?je.length>0:je}},_r.prototype._queryCircle=function(H,ve,Z,pe,Se){var Re=H-Z,je=H+Z,ut=ve-Z,Et=ve+Z;if(je<0||Re>this.width||Et<0||ut>this.height)return pe?!1:[];var Jt=[],lr={hitTest:pe,circle:{x:H,y:ve,radius:Z},seenUids:{box:{},circle:{}}};return this._forEachCell(Re,ut,je,Et,this._queryCellCircle,Jt,lr,Se),pe?Jt.length>0:Jt},_r.prototype.query=function(H,ve,Z,pe,Se){return this._query(H,ve,Z,pe,!1,Se)},_r.prototype.hitTest=function(H,ve,Z,pe,Se){return this._query(H,ve,Z,pe,!0,Se)},_r.prototype.hitTestCircle=function(H,ve,Z,pe){return this._queryCircle(H,ve,Z,!0,pe)},_r.prototype._queryCell=function(H,ve,Z,pe,Se,Re,je,ut){var Et=je.seenUids,Jt=this.boxCells[Se];if(Jt!==null)for(var lr=this.bboxes,vr=0,Cr=Jt;vr<Cr.length;vr+=1){var Hr=Cr[vr];if(!Et.box[Hr]){Et.box[Hr]=!0;var Yr=Hr*4;if(H<=lr[Yr+2]&&ve<=lr[Yr+3]&&Z>=lr[Yr+0]&&pe>=lr[Yr+1]&&(!ut||ut(this.boxKeys[Hr]))){if(je.hitTest)return Re.push(!0),!0;Re.push({key:this.boxKeys[Hr],x1:lr[Yr],y1:lr[Yr+1],x2:lr[Yr+2],y2:lr[Yr+3]})}}}var Ur=this.circleCells[Se];if(Ur!==null)for(var Jr=this.circles,hn=0,Cn=Ur;hn<Cn.length;hn+=1){var Fn=Cn[hn];if(!Et.circle[Fn]){Et.circle[Fn]=!0;var Kn=Fn*3;if(this._circleAndRectCollide(Jr[Kn],Jr[Kn+1],Jr[Kn+2],H,ve,Z,pe)&&(!ut||ut(this.circleKeys[Fn]))){if(je.hitTest)return Re.push(!0),!0;var qn=Jr[Kn],Qn=Jr[Kn+1],ca=Jr[Kn+2];Re.push({key:this.circleKeys[Fn],x1:qn-ca,y1:Qn-ca,x2:qn+ca,y2:Qn+ca})}}}},_r.prototype._queryCellCircle=function(H,ve,Z,pe,Se,Re,je,ut){var Et=je.circle,Jt=je.seenUids,lr=this.boxCells[Se];if(lr!==null)for(var vr=this.bboxes,Cr=0,Hr=lr;Cr<Hr.length;Cr+=1){var Yr=Hr[Cr];if(!Jt.box[Yr]){Jt.box[Yr]=!0;var Ur=Yr*4;if(this._circleAndRectCollide(Et.x,Et.y,Et.radius,vr[Ur+0],vr[Ur+1],vr[Ur+2],vr[Ur+3])&&(!ut||ut(this.boxKeys[Yr])))return Re.push(!0),!0}}var Jr=this.circleCells[Se];if(Jr!==null)for(var hn=this.circles,Cn=0,Fn=Jr;Cn<Fn.length;Cn+=1){var Kn=Fn[Cn];if(!Jt.circle[Kn]){Jt.circle[Kn]=!0;var qn=Kn*3;if(this._circlesCollide(hn[qn],hn[qn+1],hn[qn+2],Et.x,Et.y,Et.radius)&&(!ut||ut(this.circleKeys[Kn])))return Re.push(!0),!0}}},_r.prototype._forEachCell=function(H,ve,Z,pe,Se,Re,je,ut){for(var Et=this._convertToXCellCoord(H),Jt=this._convertToYCellCoord(ve),lr=this._convertToXCellCoord(Z),vr=this._convertToYCellCoord(pe),Cr=Et;Cr<=lr;Cr++)for(var Hr=Jt;Hr<=vr;Hr++){var Yr=this.xCellCount*Hr+Cr;if(Se.call(this,H,ve,Z,pe,Yr,Re,je,ut))return}},_r.prototype._convertToXCellCoord=function(H){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(H*this.xScale)))},_r.prototype._convertToYCellCoord=function(H){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(H*this.yScale)))},_r.prototype._circlesCollide=function(H,ve,Z,pe,Se,Re){var je=pe-H,ut=Se-ve,Et=Z+Re;return Et*Et>je*je+ut*ut},_r.prototype._circleAndRectCollide=function(H,ve,Z,pe,Se,Re,je){var ut=(Re-pe)/2,Et=Math.abs(H-(pe+ut));if(Et>ut+Z)return!1;var Jt=(je-Se)/2,lr=Math.abs(ve-(Se+Jt));if(lr>Jt+Z)return!1;if(Et<=ut||lr<=Jt)return!0;var vr=Et-ut,Cr=lr-Jt;return vr*vr+Cr*Cr<=Z*Z};function Gr(fe,H,ve,Z,pe){var Se=e.create();return H?(e.scale(Se,Se,[1/pe,1/pe,1]),ve||e.rotateZ(Se,Se,Z.angle)):e.multiply(Se,Z.labelPlaneMatrix,fe),Se}function wn(fe,H,ve,Z,pe){if(H){var Se=e.clone(fe);return e.scale(Se,Se,[pe,pe,1]),ve||e.rotateZ(Se,Se,-Z.angle),Se}else return Z.glCoordMatrix}function cn(fe,H){var ve=[fe.x,fe.y,0,1];Tr(ve,ve,H);var Z=ve[3];return{point:new e.Point(ve[0]/Z,ve[1]/Z),signedDistanceFromCamera:Z}}function Bn(fe,H){return .5+.5*(fe/H)}function En(fe,H){var ve=fe[0]/fe[3],Z=fe[1]/fe[3],pe=ve>=-H[0]&&ve<=H[0]&&Z>=-H[1]&&Z<=H[1];return pe}function Yn(fe,H,ve,Z,pe,Se,Re,je){var ut=Z?fe.textSizeData:fe.iconSizeData,Et=e.evaluateSizeForZoom(ut,ve.transform.zoom),Jt=[256/ve.width*2+1,256/ve.height*2+1],lr=Z?fe.text.dynamicLayoutVertexArray:fe.icon.dynamicLayoutVertexArray;lr.clear();for(var vr=fe.lineVertexArray,Cr=Z?fe.text.placedSymbolArray:fe.icon.placedSymbolArray,Hr=ve.transform.width/ve.transform.height,Yr=!1,Ur=0;Ur<Cr.length;Ur++){var Jr=Cr.get(Ur);if(Jr.hidden||Jr.writingMode===e.WritingMode.vertical&&!Yr){Wa(Jr.numGlyphs,lr);continue}Yr=!1;var hn=[Jr.anchorX,Jr.anchorY,0,1];if(e.transformMat4(hn,hn,H),!En(hn,Jt)){Wa(Jr.numGlyphs,lr);continue}var Cn=hn[3],Fn=Bn(ve.transform.cameraToCenterDistance,Cn),Kn=e.evaluateSizeForFeature(ut,Et,Jr),qn=Re?Kn/Fn:Kn*Fn,Qn=new e.Point(Jr.anchorX,Jr.anchorY),ca=cn(Qn,pe).point,ba={},ya=Ma(Jr,qn,!1,je,H,pe,Se,fe.glyphOffsetArray,vr,lr,ca,Qn,ba,Hr);Yr=ya.useVertical,(ya.notEnoughRoom||Yr||ya.needsFlipping&&Ma(Jr,qn,!0,je,H,pe,Se,fe.glyphOffsetArray,vr,lr,ca,Qn,ba,Hr).notEnoughRoom)&&Wa(Jr.numGlyphs,lr)}Z?fe.text.dynamicLayoutVertexBuffer.updateData(lr):fe.icon.dynamicLayoutVertexBuffer.updateData(lr)}function Hn(fe,H,ve,Z,pe,Se,Re,je,ut,Et,Jt){var lr=je.glyphStartIndex+je.numGlyphs,vr=je.lineStartIndex,Cr=je.lineStartIndex+je.lineLength,Hr=H.getoffsetX(je.glyphStartIndex),Yr=H.getoffsetX(lr-1),Ur=Ha(fe*Hr,ve,Z,pe,Se,Re,je.segment,vr,Cr,ut,Et,Jt);if(!Ur)return null;var Jr=Ha(fe*Yr,ve,Z,pe,Se,Re,je.segment,vr,Cr,ut,Et,Jt);return Jr?{first:Ur,last:Jr}:null}function pa(fe,H,ve,Z){if(fe===e.WritingMode.horizontal){var pe=Math.abs(ve.y-H.y),Se=Math.abs(ve.x-H.x)*Z;if(pe>Se)return{useVertical:!0}}return(fe===e.WritingMode.vertical?H.y<ve.y:H.x>ve.x)?{needsFlipping:!0}:null}function Ma(fe,H,ve,Z,pe,Se,Re,je,ut,Et,Jt,lr,vr,Cr){var Hr=H/24,Yr=fe.lineOffsetX*Hr,Ur=fe.lineOffsetY*Hr,Jr;if(fe.numGlyphs>1){var hn=fe.glyphStartIndex+fe.numGlyphs,Cn=fe.lineStartIndex,Fn=fe.lineStartIndex+fe.lineLength,Kn=Hn(Hr,je,Yr,Ur,ve,Jt,lr,fe,ut,Se,vr);if(!Kn)return{notEnoughRoom:!0};var qn=cn(Kn.first.point,Re).point,Qn=cn(Kn.last.point,Re).point;if(Z&&!ve){var ca=pa(fe.writingMode,qn,Qn,Cr);if(ca)return ca}Jr=[Kn.first];for(var ba=fe.glyphStartIndex+1;ba<hn-1;ba++)Jr.push(Ha(Hr*je.getoffsetX(ba),Yr,Ur,ve,Jt,lr,fe.segment,Cn,Fn,ut,Se,vr));Jr.push(Kn.last)}else{if(Z&&!ve){var ya=cn(lr,pe).point,Ta=fe.lineStartIndex+fe.segment+1,Ca=new e.Point(ut.getx(Ta),ut.gety(Ta)),Va=cn(Ca,pe),ni=Va.signedDistanceFromCamera>0?Va.point:ci(lr,Ca,ya,1,pe),Li=pa(fe.writingMode,ya,ni,Cr);if(Li)return Li}var ui=Ha(Hr*je.getoffsetX(fe.glyphStartIndex),Yr,Ur,ve,Jt,lr,fe.segment,fe.lineStartIndex,fe.lineStartIndex+fe.lineLength,ut,Se,vr);if(!ui)return{notEnoughRoom:!0};Jr=[ui]}for(var pi=0,Ba=Jr;pi<Ba.length;pi+=1){var Pi=Ba[pi];e.addDynamicAttributes(Et,Pi.point,Pi.angle)}return{}}function ci(fe,H,ve,Z,pe){var Se=cn(fe.add(fe.sub(H)._unit()),pe).point,Re=ve.sub(Se);return ve.add(Re._mult(Z/Re.mag()))}function Ha(fe,H,ve,Z,pe,Se,Re,je,ut,Et,Jt,lr){var vr=Z?fe-H:fe+H,Cr=vr>0?1:-1,Hr=0;Z&&(Cr*=-1,Hr=Math.PI),Cr<0&&(Hr+=Math.PI);for(var Yr=Cr>0?je+Re:je+Re+1,Ur=pe,Jr=pe,hn=0,Cn=0,Fn=Math.abs(vr),Kn=[];hn+Cn<=Fn;){if(Yr+=Cr,Yr<je||Yr>=ut)return null;if(Jr=Ur,Kn.push(Ur),Ur=lr[Yr],Ur===void 0){var qn=new e.Point(Et.getx(Yr),Et.gety(Yr)),Qn=cn(qn,Jt);if(Qn.signedDistanceFromCamera>0)Ur=lr[Yr]=Qn.point;else{var ca=Yr-Cr,ba=hn===0?Se:new e.Point(Et.getx(ca),Et.gety(ca));Ur=ci(ba,qn,Jr,Fn-hn+1,Jt)}}hn+=Cn,Cn=Jr.dist(Ur)}var ya=(Fn-hn)/Cn,Ta=Ur.sub(Jr),Ca=Ta.mult(ya)._add(Jr);Ca._add(Ta._unit()._perp()._mult(ve*Cr));var Va=Hr+Math.atan2(Ur.y-Jr.y,Ur.x-Jr.x);return Kn.push(Ca),{point:Ca,angle:Va,path:Kn}}var ja=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Wa(fe,H){for(var ve=0;ve<fe;ve++){var Z=H.length;H.resize(Z+4),H.float32.set(ja,Z*3)}}function Tr(fe,H,ve){var Z=H[0],pe=H[1];return fe[0]=ve[0]*Z+ve[4]*pe+ve[12],fe[1]=ve[1]*Z+ve[5]*pe+ve[13],fe[3]=ve[3]*Z+ve[7]*pe+ve[15],fe}var pn=100,fn=function(H,ve,Z){ve===void 0&&(ve=new _r(H.width+2*pn,H.height+2*pn,25)),Z===void 0&&(Z=new _r(H.width+2*pn,H.height+2*pn,25)),this.transform=H,this.grid=ve,this.ignoredGrid=Z,this.pitchfactor=Math.cos(H._pitch)*H.cameraToCenterDistance,this.screenRightBoundary=H.width+pn,this.screenBottomBoundary=H.height+pn,this.gridRightBoundary=H.width+2*pn,this.gridBottomBoundary=H.height+2*pn};fn.prototype.placeCollisionBox=function(H,ve,Z,pe,Se){var Re=this.projectAndGetPerspectiveRatio(pe,H.anchorPointX,H.anchorPointY),je=Z*Re.perspectiveRatio,ut=H.x1*je+Re.point.x,Et=H.y1*je+Re.point.y,Jt=H.x2*je+Re.point.x,lr=H.y2*je+Re.point.y;return!this.isInsideGrid(ut,Et,Jt,lr)||!ve&&this.grid.hitTest(ut,Et,Jt,lr,Se)?{box:[],offscreen:!1}:{box:[ut,Et,Jt,lr],offscreen:this.isOffscreen(ut,Et,Jt,lr)}},fn.prototype.placeCollisionCircles=function(H,ve,Z,pe,Se,Re,je,ut,Et,Jt,lr,vr,Cr){var Hr=[],Yr=new e.Point(ve.anchorX,ve.anchorY),Ur=cn(Yr,Re),Jr=Bn(this.transform.cameraToCenterDistance,Ur.signedDistanceFromCamera),hn=Jt?Se/Jr:Se*Jr,Cn=hn/e.ONE_EM,Fn=cn(Yr,je).point,Kn={},qn=ve.lineOffsetX*Cn,Qn=ve.lineOffsetY*Cn,ca=Hn(Cn,pe,qn,Qn,!1,Fn,Yr,ve,Z,je,Kn),ba=!1,ya=!1,Ta=!0;if(ca){for(var Ca=vr*.5*Jr+Cr,Va=new e.Point(-pn,-pn),ni=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),Li=new Er,ui=ca.first,pi=ca.last,Ba=[],Pi=ui.path.length-1;Pi>=1;Pi--)Ba.push(ui.path[Pi]);for(var Fi=1;Fi<pi.path.length;Fi++)Ba.push(pi.path[Fi]);var Ui=Ca*2.5;if(ut){var _i=Ba.map(function(ru){return cn(ru,ut)});_i.some(function(ru){return ru.signedDistanceFromCamera<=0})?Ba=[]:Ba=_i.map(function(ru){return ru.point})}var Ji=[];if(Ba.length>0){for(var ii=Ba[0].clone(),wi=Ba[0].clone(),To=1;To<Ba.length;To++)ii.x=Math.min(ii.x,Ba[To].x),ii.y=Math.min(ii.y,Ba[To].y),wi.x=Math.max(wi.x,Ba[To].x),wi.y=Math.max(wi.y,Ba[To].y);ii.x>=Va.x&&wi.x<=ni.x&&ii.y>=Va.y&&wi.y<=ni.y?Ji=[Ba]:wi.x<Va.x||ii.x>ni.x||wi.y<Va.y||ii.y>ni.y?Ji=[]:Ji=e.clipLine([Ba],Va.x,Va.y,ni.x,ni.y)}for(var No=0,Sl=Ji;No<Sl.length;No+=1){var kl=Sl[No];Li.reset(kl,Ca*.25);var $l=0;Li.length<=.5*Ca?$l=1:$l=Math.ceil(Li.paddedLength/Ui)+1;for(var ql=0;ql<$l;ql++){var _u=ql/Math.max($l-1,1),eu=Li.lerp(_u),Ns=eu.x+pn,Hu=eu.y+pn;Hr.push(Ns,Hu,Ca,0);var _s=Ns-Ca,cl=Hu-Ca,tu=Ns+Ca,Hl=Hu+Ca;if(Ta=Ta&&this.isOffscreen(_s,cl,tu,Hl),ya=ya||this.isInsideGrid(_s,cl,tu,Hl),!H&&this.grid.hitTestCircle(Ns,Hu,Ca,lr)&&(ba=!0,!Et))return{circles:[],offscreen:!1,collisionDetected:ba}}}}return{circles:!Et&&ba||!ya?[]:Hr,offscreen:Ta,collisionDetected:ba}},fn.prototype.queryRenderedSymbols=function(H){if(H.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var ve=[],Z=1/0,pe=1/0,Se=-1/0,Re=-1/0,je=0,ut=H;je<ut.length;je+=1){var Et=ut[je],Jt=new e.Point(Et.x+pn,Et.y+pn);Z=Math.min(Z,Jt.x),pe=Math.min(pe,Jt.y),Se=Math.max(Se,Jt.x),Re=Math.max(Re,Jt.y),ve.push(Jt)}for(var lr=this.grid.query(Z,pe,Se,Re).concat(this.ignoredGrid.query(Z,pe,Se,Re)),vr={},Cr={},Hr=0,Yr=lr;Hr<Yr.length;Hr+=1){var Ur=Yr[Hr],Jr=Ur.key;if(vr[Jr.bucketInstanceId]===void 0&&(vr[Jr.bucketInstanceId]={}),!vr[Jr.bucketInstanceId][Jr.featureIndex]){var hn=[new e.Point(Ur.x1,Ur.y1),new e.Point(Ur.x2,Ur.y1),new e.Point(Ur.x2,Ur.y2),new e.Point(Ur.x1,Ur.y2)];!e.polygonIntersectsPolygon(ve,hn)||(vr[Jr.bucketInstanceId][Jr.featureIndex]=!0,Cr[Jr.bucketInstanceId]===void 0&&(Cr[Jr.bucketInstanceId]=[]),Cr[Jr.bucketInstanceId].push(Jr.featureIndex))}}return Cr},fn.prototype.insertCollisionBox=function(H,ve,Z,pe,Se){var Re=ve?this.ignoredGrid:this.grid,je={bucketInstanceId:Z,featureIndex:pe,collisionGroupID:Se};Re.insert(je,H[0],H[1],H[2],H[3])},fn.prototype.insertCollisionCircles=function(H,ve,Z,pe,Se){for(var Re=ve?this.ignoredGrid:this.grid,je={bucketInstanceId:Z,featureIndex:pe,collisionGroupID:Se},ut=0;ut<H.length;ut+=4)Re.insertCircle(je,H[ut],H[ut+1],H[ut+2])},fn.prototype.projectAndGetPerspectiveRatio=function(H,ve,Z){var pe=[ve,Z,0,1];Tr(pe,pe,H);var Se=new e.Point((pe[0]/pe[3]+1)/2*this.transform.width+pn,(-pe[1]/pe[3]+1)/2*this.transform.height+pn);return{point:Se,perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/pe[3])}},fn.prototype.isOffscreen=function(H,ve,Z,pe){return Z<pn||H>=this.screenRightBoundary||pe<pn||ve>this.screenBottomBoundary},fn.prototype.isInsideGrid=function(H,ve,Z,pe){return Z>=0&&H<this.gridRightBoundary&&pe>=0&&ve<this.gridBottomBoundary},fn.prototype.getViewportMatrix=function(){var H=e.identity([]);return e.translate(H,H,[-pn,-pn,0]),H};function An(fe,H,ve){return H*(e.EXTENT/(fe.tileSize*Math.pow(2,ve-fe.tileID.overscaledZ)))}var Zn=function(H,ve,Z,pe){H?this.opacity=Math.max(0,Math.min(1,H.opacity+(H.placed?ve:-ve))):this.opacity=pe&&Z?1:0,this.placed=Z};Zn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var ua=function(H,ve,Z,pe,Se){this.text=new Zn(H?H.text:null,ve,Z,Se),this.icon=new Zn(H?H.icon:null,ve,pe,Se)};ua.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ea=function(H,ve,Z){this.text=H,this.icon=ve,this.skipFade=Z},Rn=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},Xn=function(H,ve,Z,pe,Se){this.bucketInstanceId=H,this.featureIndex=ve,this.sourceLayerIndex=Z,this.bucketIndex=pe,this.tileID=Se},Ua=function(H){this.crossSourceCollisions=H,this.maxGroupID=0,this.collisionGroups={}};Ua.prototype.get=function(H){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[H]){var ve=++this.maxGroupID;this.collisionGroups[H]={ID:ve,predicate:function(Z){return Z.collisionGroupID===ve}}}return this.collisionGroups[H]};function li(fe,H,ve,Z,pe){var Se=e.getAnchorAlignment(fe),Re=Se.horizontalAlign,je=Se.verticalAlign,ut=-(Re-.5)*H,Et=-(je-.5)*ve,Jt=e.evaluateVariableOffset(fe,Z);return new e.Point(ut+Jt[0]*pe,Et+Jt[1]*pe)}function Vt(fe,H,ve,Z,pe,Se){var Re=fe.x1,je=fe.x2,ut=fe.y1,Et=fe.y2,Jt=fe.anchorPointX,lr=fe.anchorPointY,vr=new e.Point(H,ve);return Z&&vr._rotate(pe?Se:-Se),{x1:Re+vr.x,y1:ut+vr.y,x2:je+vr.x,y2:Et+vr.y,anchorPointX:Jt,anchorPointY:lr}}var hr=function(H,ve,Z,pe){this.transform=H.clone(),this.collisionIndex=new fn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=ve,this.retainedQueryData={},this.collisionGroups=new Ua(Z),this.collisionCircleArrays={},this.prevPlacement=pe,pe&&(pe.prevPlacement=void 0),this.placedOrientations={}};hr.prototype.getBucketParts=function(H,ve,Z,pe){var Se=Z.getBucket(ve),Re=Z.latestFeatureIndex;if(!(!Se||!Re||ve.id!==Se.layerIds[0])){var je=Z.collisionBoxArray,ut=Se.layers[0].layout,Et=Math.pow(2,this.transform.zoom-Z.tileID.overscaledZ),Jt=Z.tileSize/e.EXTENT,lr=this.transform.calculatePosMatrix(Z.tileID.toUnwrapped()),vr=ut.get("text-pitch-alignment")==="map",Cr=ut.get("text-rotation-alignment")==="map",Hr=An(Z,1,this.transform.zoom),Yr=Gr(lr,vr,Cr,this.transform,Hr),Ur=null;if(vr){var Jr=wn(lr,vr,Cr,this.transform,Hr);Ur=e.multiply([],this.transform.labelPlaneMatrix,Jr)}this.retainedQueryData[Se.bucketInstanceId]=new Xn(Se.bucketInstanceId,Re,Se.sourceLayerIndex,Se.index,Z.tileID);var hn={bucket:Se,layout:ut,posMatrix:lr,textLabelPlaneMatrix:Yr,labelToScreenMatrix:Ur,scale:Et,textPixelRatio:Jt,holdingForFade:Z.holdingForFade(),collisionBoxArray:je,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(Se.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(Se.sourceID)};if(pe)for(var Cn=0,Fn=Se.sortKeyRanges;Cn<Fn.length;Cn+=1){var Kn=Fn[Cn],qn=Kn.sortKey,Qn=Kn.symbolInstanceStart,ca=Kn.symbolInstanceEnd;H.push({sortKey:qn,symbolInstanceStart:Qn,symbolInstanceEnd:ca,parameters:hn})}else H.push({symbolInstanceStart:0,symbolInstanceEnd:Se.symbolInstances.length,parameters:hn})}},hr.prototype.attemptAnchorPlacement=function(H,ve,Z,pe,Se,Re,je,ut,Et,Jt,lr,vr,Cr,Hr,Yr){var Ur=[vr.textOffset0,vr.textOffset1],Jr=li(H,Z,pe,Ur,Se),hn=this.collisionIndex.placeCollisionBox(Vt(ve,Jr.x,Jr.y,Re,je,this.transform.angle),lr,ut,Et,Jt.predicate);if(Yr){var Cn=this.collisionIndex.placeCollisionBox(Vt(Yr,Jr.x,Jr.y,Re,je,this.transform.angle),lr,ut,Et,Jt.predicate);if(Cn.box.length===0)return}if(hn.box.length>0){var Fn;return this.prevPlacement&&this.prevPlacement.variableOffsets[vr.crossTileID]&&this.prevPlacement.placements[vr.crossTileID]&&this.prevPlacement.placements[vr.crossTileID].text&&(Fn=this.prevPlacement.variableOffsets[vr.crossTileID].anchor),this.variableOffsets[vr.crossTileID]={textOffset:Ur,width:Z,height:pe,anchor:H,textBoxScale:Se,prevAnchor:Fn},this.markUsedJustification(Cr,H,vr,Hr),Cr.allowVerticalPlacement&&(this.markUsedOrientation(Cr,Hr,vr),this.placedOrientations[vr.crossTileID]=Hr),{shift:Jr,placedGlyphBoxes:hn}}},hr.prototype.placeLayerBucketPart=function(H,ve,Z){var pe=this,Se=H.parameters,Re=Se.bucket,je=Se.layout,ut=Se.posMatrix,Et=Se.textLabelPlaneMatrix,Jt=Se.labelToScreenMatrix,lr=Se.textPixelRatio,vr=Se.holdingForFade,Cr=Se.collisionBoxArray,Hr=Se.partiallyEvaluatedTextSize,Yr=Se.collisionGroup,Ur=je.get("text-optional"),Jr=je.get("icon-optional"),hn=je.get("text-allow-overlap"),Cn=je.get("icon-allow-overlap"),Fn=je.get("text-rotation-alignment")==="map",Kn=je.get("text-pitch-alignment")==="map",qn=je.get("icon-text-fit")!=="none",Qn=je.get("symbol-z-order")==="viewport-y",ca=hn&&(Cn||!Re.hasIconData()||Jr),ba=Cn&&(hn||!Re.hasTextData()||Ur);!Re.collisionArrays&&Cr&&Re.deserializeCollisionBoxes(Cr);var ya=function(ui,pi){if(!ve[ui.crossTileID]){if(vr){pe.placements[ui.crossTileID]=new ea(!1,!1,!1);return}var Ba=!1,Pi=!1,Fi=!0,Ui=null,_i={box:null,offscreen:null},Ji={box:null,offscreen:null},ii=null,wi=null,To=null,No=0,Sl=0,kl=0;pi.textFeatureIndex?No=pi.textFeatureIndex:ui.useRuntimeCollisionCircles&&(No=ui.featureIndex),pi.verticalTextFeatureIndex&&(Sl=pi.verticalTextFeatureIndex);var $l=pi.textBox;if($l){var ql=function(Lo){var qs=e.WritingMode.horizontal;if(Re.allowVerticalPlacement&&!Lo&&pe.prevPlacement){var el=pe.prevPlacement.placedOrientations[ui.crossTileID];el&&(pe.placedOrientations[ui.crossTileID]=el,qs=el,pe.markUsedOrientation(Re,qs,ui))}return qs},_u=function(Lo,qs){if(Re.allowVerticalPlacement&&ui.numVerticalGlyphVertices>0&&pi.verticalTextBox)for(var el=0,Of=Re.writingModes;el<Of.length;el+=1){var fc=Of[el];if(fc===e.WritingMode.vertical?(_i=qs(),Ji=_i):_i=Lo(),_i&&_i.box&&_i.box.length)break}else _i=Lo()};if(je.get("text-variable-anchor")){var _s=je.get("text-variable-anchor");if(pe.prevPlacement&&pe.prevPlacement.variableOffsets[ui.crossTileID]){var cl=pe.prevPlacement.variableOffsets[ui.crossTileID];_s.indexOf(cl.anchor)>0&&(_s=_s.filter(function(Lo){return Lo!==cl.anchor}),_s.unshift(cl.anchor))}var tu=function(Lo,qs,el){for(var Of=Lo.x2-Lo.x1,fc=Lo.y2-Lo.y1,uh=ui.textBoxScale,fh=qn&&!Cn?qs:null,Tf={box:[],offscreen:!1},ch=hn?_s.length*2:_s.length,Bf=0;Bf<ch;++Bf){var hh=_s[Bf%_s.length],vh=Bf>=_s.length,cc=pe.attemptAnchorPlacement(hh,Lo,Of,fc,uh,Fn,Kn,lr,ut,Yr,vh,ui,Re,el,fh);if(cc&&(Tf=cc.placedGlyphBoxes,Tf&&Tf.box&&Tf.box.length)){Ba=!0,Ui=cc.shift;break}}return Tf},Hl=function(){return tu($l,pi.iconBox,e.WritingMode.horizontal)},ru=function(){var Lo=pi.verticalTextBox,qs=_i&&_i.box&&_i.box.length;return Re.allowVerticalPlacement&&!qs&&ui.numVerticalGlyphVertices>0&&Lo?tu(Lo,pi.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}};_u(Hl,ru),_i&&(Ba=_i.box,Fi=_i.offscreen);var Rf=ql(_i&&_i.box);if(!Ba&&pe.prevPlacement){var Zu=pe.prevPlacement.variableOffsets[ui.crossTileID];Zu&&(pe.variableOffsets[ui.crossTileID]=Zu,pe.markUsedJustification(Re,Zu.anchor,ui,Rf))}}else{var eu=function(Lo,qs){var el=pe.collisionIndex.placeCollisionBox(Lo,hn,lr,ut,Yr.predicate);return el&&el.box&&el.box.length&&(pe.markUsedOrientation(Re,qs,ui),pe.placedOrientations[ui.crossTileID]=qs),el},Ns=function(){return eu($l,e.WritingMode.horizontal)},Hu=function(){var Lo=pi.verticalTextBox;return Re.allowVerticalPlacement&&ui.numVerticalGlyphVertices>0&&Lo?eu(Lo,e.WritingMode.vertical):{box:null,offscreen:null}};_u(Ns,Hu),ql(_i&&_i.box&&_i.box.length)}}if(ii=_i,Ba=ii&&ii.box&&ii.box.length>0,Fi=ii&&ii.offscreen,ui.useRuntimeCollisionCircles){var hs=Re.text.placedSymbolArray.get(ui.centerJustifiedTextSymbolIndex),_f=e.evaluateSizeForFeature(Re.textSizeData,Hr,hs),Cs=je.get("text-padding"),wf=ui.collisionCircleDiameter;wi=pe.collisionIndex.placeCollisionCircles(hn,hs,Re.lineVertexArray,Re.glyphOffsetArray,_f,ut,Et,Jt,Z,Kn,Yr.predicate,wf,Cs),Ba=hn||wi.circles.length>0&&!wi.collisionDetected,Fi=Fi&&wi.offscreen}if(pi.iconFeatureIndex&&(kl=pi.iconFeatureIndex),pi.iconBox){var If=function(Lo){var qs=qn&&Ui?Vt(Lo,Ui.x,Ui.y,Fn,Kn,pe.transform.angle):Lo;return pe.collisionIndex.placeCollisionBox(qs,Cn,lr,ut,Yr.predicate)};Ji&&Ji.box&&Ji.box.length&&pi.verticalIconBox?(To=If(pi.verticalIconBox),Pi=To.box.length>0):(To=If(pi.iconBox),Pi=To.box.length>0),Fi=Fi&&To.offscreen}var zf=Ur||ui.numHorizontalGlyphVertices===0&&ui.numVerticalGlyphVertices===0,Rc=Jr||ui.numIconVertices===0;if(!zf&&!Rc?Pi=Ba=Pi&&Ba:Rc?zf||(Pi=Pi&&Ba):Ba=Pi&&Ba,Ba&&ii&&ii.box&&(Ji&&Ji.box&&Sl?pe.collisionIndex.insertCollisionBox(ii.box,je.get("text-ignore-placement"),Re.bucketInstanceId,Sl,Yr.ID):pe.collisionIndex.insertCollisionBox(ii.box,je.get("text-ignore-placement"),Re.bucketInstanceId,No,Yr.ID)),Pi&&To&&pe.collisionIndex.insertCollisionBox(To.box,je.get("icon-ignore-placement"),Re.bucketInstanceId,kl,Yr.ID),wi&&(Ba&&pe.collisionIndex.insertCollisionCircles(wi.circles,je.get("text-ignore-placement"),Re.bucketInstanceId,No,Yr.ID),Z)){var Ff=Re.bucketInstanceId,lf=pe.collisionCircleArrays[Ff];lf===void 0&&(lf=pe.collisionCircleArrays[Ff]=new Rn);for(var uf=0;uf<wi.circles.length;uf+=4)lf.circles.push(wi.circles[uf+0]),lf.circles.push(wi.circles[uf+1]),lf.circles.push(wi.circles[uf+2]),lf.circles.push(wi.collisionDetected?1:0)}pe.placements[ui.crossTileID]=new ea(Ba||ca,Pi||ba,Fi||Re.justReloaded),ve[ui.crossTileID]=!0}};if(Qn)for(var Ta=Re.getSortedSymbolIndexes(this.transform.angle),Ca=Ta.length-1;Ca>=0;--Ca){var Va=Ta[Ca];ya(Re.symbolInstances.get(Va),Re.collisionArrays[Va])}else for(var ni=H.symbolInstanceStart;ni<H.symbolInstanceEnd;ni++)ya(Re.symbolInstances.get(ni),Re.collisionArrays[ni]);if(Z&&Re.bucketInstanceId in this.collisionCircleArrays){var Li=this.collisionCircleArrays[Re.bucketInstanceId];e.invert(Li.invProjMatrix,ut),Li.viewportMatrix=this.collisionIndex.getViewportMatrix()}Re.justReloaded=!1},hr.prototype.markUsedJustification=function(H,ve,Z,pe){var Se={left:Z.leftJustifiedTextSymbolIndex,center:Z.centerJustifiedTextSymbolIndex,right:Z.rightJustifiedTextSymbolIndex},Re;pe===e.WritingMode.vertical?Re=Z.verticalPlacedTextSymbolIndex:Re=Se[e.getAnchorJustification(ve)];for(var je=[Z.leftJustifiedTextSymbolIndex,Z.centerJustifiedTextSymbolIndex,Z.rightJustifiedTextSymbolIndex,Z.verticalPlacedTextSymbolIndex],ut=0,Et=je;ut<Et.length;ut+=1){var Jt=Et[ut];Jt>=0&&(Re>=0&&Jt!==Re?H.text.placedSymbolArray.get(Jt).crossTileID=0:H.text.placedSymbolArray.get(Jt).crossTileID=Z.crossTileID)}},hr.prototype.markUsedOrientation=function(H,ve,Z){for(var pe=ve===e.WritingMode.horizontal||ve===e.WritingMode.horizontalOnly?ve:0,Se=ve===e.WritingMode.vertical?ve:0,Re=[Z.leftJustifiedTextSymbolIndex,Z.centerJustifiedTextSymbolIndex,Z.rightJustifiedTextSymbolIndex],je=0,ut=Re;je<ut.length;je+=1){var Et=ut[je];H.text.placedSymbolArray.get(Et).placedOrientation=pe}Z.verticalPlacedTextSymbolIndex&&(H.text.placedSymbolArray.get(Z.verticalPlacedTextSymbolIndex).placedOrientation=Se)},hr.prototype.commit=function(H){this.commitTime=H,this.zoomAtLastRecencyCheck=this.transform.zoom;var ve=this.prevPlacement,Z=!1;this.prevZoomAdjustment=ve?ve.zoomAdjustment(this.transform.zoom):0;var pe=ve?ve.symbolFadeChange(H):1,Se=ve?ve.opacities:{},Re=ve?ve.variableOffsets:{},je=ve?ve.placedOrientations:{};for(var ut in this.placements){var Et=this.placements[ut],Jt=Se[ut];Jt?(this.opacities[ut]=new ua(Jt,pe,Et.text,Et.icon),Z=Z||Et.text!==Jt.text.placed||Et.icon!==Jt.icon.placed):(this.opacities[ut]=new ua(null,pe,Et.text,Et.icon,Et.skipFade),Z=Z||Et.text||Et.icon)}for(var lr in Se){var vr=Se[lr];if(!this.opacities[lr]){var Cr=new ua(vr,pe,!1,!1);Cr.isHidden()||(this.opacities[lr]=Cr,Z=Z||vr.text.placed||vr.icon.placed)}}for(var Hr in Re)!this.variableOffsets[Hr]&&this.opacities[Hr]&&!this.opacities[Hr].isHidden()&&(this.variableOffsets[Hr]=Re[Hr]);for(var Yr in je)!this.placedOrientations[Yr]&&this.opacities[Yr]&&!this.opacities[Yr].isHidden()&&(this.placedOrientations[Yr]=je[Yr]);Z?this.lastPlacementChangeTime=H:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=ve?ve.lastPlacementChangeTime:H)},hr.prototype.updateLayerOpacities=function(H,ve){for(var Z={},pe=0,Se=ve;pe<Se.length;pe+=1){var Re=Se[pe],je=Re.getBucket(H);je&&Re.latestFeatureIndex&&H.id===je.layerIds[0]&&this.updateBucketOpacities(je,Z,Re.collisionBoxArray)}},hr.prototype.updateBucketOpacities=function(H,ve,Z){var pe=this;H.hasTextData()&&H.text.opacityVertexArray.clear(),H.hasIconData()&&H.icon.opacityVertexArray.clear(),H.hasIconCollisionBoxData()&&H.iconCollisionBox.collisionVertexArray.clear(),H.hasTextCollisionBoxData()&&H.textCollisionBox.collisionVertexArray.clear();var Se=H.layers[0].layout,Re=new ua(null,0,!1,!1,!0),je=Se.get("text-allow-overlap"),ut=Se.get("icon-allow-overlap"),Et=Se.get("text-variable-anchor"),Jt=Se.get("text-rotation-alignment")==="map",lr=Se.get("text-pitch-alignment")==="map",vr=Se.get("icon-text-fit")!=="none",Cr=new ua(null,0,je&&(ut||!H.hasIconData()||Se.get("icon-optional")),ut&&(je||!H.hasTextData()||Se.get("text-optional")),!0);!H.collisionArrays&&Z&&(H.hasIconCollisionBoxData()||H.hasTextCollisionBoxData())&&H.deserializeCollisionBoxes(Z);for(var Hr=function(hn,Cn,Fn){for(var Kn=0;Kn<Cn/4;Kn++)hn.opacityVertexArray.emplaceBack(Fn)},Yr=function(hn){var Cn=H.symbolInstances.get(hn),Fn=Cn.numHorizontalGlyphVertices,Kn=Cn.numVerticalGlyphVertices,qn=Cn.crossTileID,Qn=ve[qn],ca=pe.opacities[qn];Qn?ca=Re:ca||(ca=Cr,pe.opacities[qn]=ca),ve[qn]=!0;var ba=Fn>0||Kn>0,ya=Cn.numIconVertices>0,Ta=pe.placedOrientations[Cn.crossTileID],Ca=Ta===e.WritingMode.vertical,Va=Ta===e.WritingMode.horizontal||Ta===e.WritingMode.horizontalOnly;if(ba){var ni=zr(ca.text),Li=Ca?gn:ni;Hr(H.text,Fn,Li);var ui=Va?gn:ni;Hr(H.text,Kn,ui);var pi=ca.text.isHidden();[Cn.rightJustifiedTextSymbolIndex,Cn.centerJustifiedTextSymbolIndex,Cn.leftJustifiedTextSymbolIndex].forEach(function(kl){kl>=0&&(H.text.placedSymbolArray.get(kl).hidden=pi||Ca?1:0)}),Cn.verticalPlacedTextSymbolIndex>=0&&(H.text.placedSymbolArray.get(Cn.verticalPlacedTextSymbolIndex).hidden=pi||Va?1:0);var Ba=pe.variableOffsets[Cn.crossTileID];Ba&&pe.markUsedJustification(H,Ba.anchor,Cn,Ta);var Pi=pe.placedOrientations[Cn.crossTileID];Pi&&(pe.markUsedJustification(H,"left",Cn,Pi),pe.markUsedOrientation(H,Pi,Cn))}if(ya){var Fi=zr(ca.icon),Ui=!(vr&&Cn.verticalPlacedIconSymbolIndex&&Ca);if(Cn.placedIconSymbolIndex>=0){var _i=Ui?Fi:gn;Hr(H.icon,Cn.numIconVertices,_i),H.icon.placedSymbolArray.get(Cn.placedIconSymbolIndex).hidden=ca.icon.isHidden()}if(Cn.verticalPlacedIconSymbolIndex>=0){var Ji=Ui?gn:Fi;Hr(H.icon,Cn.numVerticalIconVertices,Ji),H.icon.placedSymbolArray.get(Cn.verticalPlacedIconSymbolIndex).hidden=ca.icon.isHidden()}}if(H.hasIconCollisionBoxData()||H.hasTextCollisionBoxData()){var ii=H.collisionArrays[hn];if(ii){var wi=new e.Point(0,0);if(ii.textBox||ii.verticalTextBox){var To=!0;if(Et){var No=pe.variableOffsets[qn];No?(wi=li(No.anchor,No.width,No.height,No.textOffset,No.textBoxScale),Jt&&wi._rotate(lr?pe.transform.angle:-pe.transform.angle)):To=!1}ii.textBox&&rn(H.textCollisionBox.collisionVertexArray,ca.text.placed,!To||Ca,wi.x,wi.y),ii.verticalTextBox&&rn(H.textCollisionBox.collisionVertexArray,ca.text.placed,!To||Va,wi.x,wi.y)}var Sl=Boolean(!Va&&ii.verticalIconBox);ii.iconBox&&rn(H.iconCollisionBox.collisionVertexArray,ca.icon.placed,Sl,vr?wi.x:0,vr?wi.y:0),ii.verticalIconBox&&rn(H.iconCollisionBox.collisionVertexArray,ca.icon.placed,!Sl,vr?wi.x:0,vr?wi.y:0)}}},Ur=0;Ur<H.symbolInstances.length;Ur++)Yr(Ur);if(H.sortFeatures(this.transform.angle),this.retainedQueryData[H.bucketInstanceId]&&(this.retainedQueryData[H.bucketInstanceId].featureSortOrder=H.featureSortOrder),H.hasTextData()&&H.text.opacityVertexBuffer&&H.text.opacityVertexBuffer.updateData(H.text.opacityVertexArray),H.hasIconData()&&H.icon.opacityVertexBuffer&&H.icon.opacityVertexBuffer.updateData(H.icon.opacityVertexArray),H.hasIconCollisionBoxData()&&H.iconCollisionBox.collisionVertexBuffer&&H.iconCollisionBox.collisionVertexBuffer.updateData(H.iconCollisionBox.collisionVertexArray),H.hasTextCollisionBoxData()&&H.textCollisionBox.collisionVertexBuffer&&H.textCollisionBox.collisionVertexBuffer.updateData(H.textCollisionBox.collisionVertexArray),H.bucketInstanceId in this.collisionCircleArrays){var Jr=this.collisionCircleArrays[H.bucketInstanceId];H.placementInvProjMatrix=Jr.invProjMatrix,H.placementViewportMatrix=Jr.viewportMatrix,H.collisionCircleArray=Jr.circles,delete this.collisionCircleArrays[H.bucketInstanceId]}},hr.prototype.symbolFadeChange=function(H){return this.fadeDuration===0?1:(H-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},hr.prototype.zoomAdjustment=function(H){return Math.max(0,(this.transform.zoom-H)/1.5)},hr.prototype.hasTransitions=function(H){return this.stale||H-this.lastPlacementChangeTime<this.fadeDuration},hr.prototype.stillRecent=function(H,ve){var Z=this.zoomAtLastRecencyCheck===ve?1-this.zoomAdjustment(ve):1;return this.zoomAtLastRecencyCheck=ve,this.commitTime+this.fadeDuration*Z>H},hr.prototype.setStale=function(){this.stale=!0};function rn(fe,H,ve,Z,pe){fe.emplaceBack(H?1:0,ve?1:0,Z||0,pe||0),fe.emplaceBack(H?1:0,ve?1:0,Z||0,pe||0),fe.emplaceBack(H?1:0,ve?1:0,Z||0,pe||0),fe.emplaceBack(H?1:0,ve?1:0,Z||0,pe||0)}var vn=Math.pow(2,25),en=Math.pow(2,24),Tn=Math.pow(2,17),xn=Math.pow(2,16),un=Math.pow(2,9),gr=Math.pow(2,8),mr=Math.pow(2,1);function zr(fe){if(fe.opacity===0&&!fe.placed)return 0;if(fe.opacity===1&&fe.placed)return 4294967295;var H=fe.placed?1:0,ve=Math.floor(fe.opacity*127);return ve*vn+H*en+ve*Tn+H*xn+ve*un+H*gr+ve*mr+H}var gn=0,On=function(H){this._sortAcrossTiles=H.layout.get("symbol-z-order")!=="viewport-y"&&H.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};On.prototype.continuePlacement=function(H,ve,Z,pe,Se){for(var Re=this._bucketParts;this._currentTileIndex<H.length;){var je=H[this._currentTileIndex];if(ve.getBucketParts(Re,pe,je,this._sortAcrossTiles),this._currentTileIndex++,Se())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,Re.sort(function(Et,Jt){return Et.sortKey-Jt.sortKey}));this._currentPartIndex<Re.length;){var ut=Re[this._currentPartIndex];if(ve.placeLayerBucketPart(ut,this._seenCrossTileIDs,Z),this._currentPartIndex++,Se())return!0}return!1};var ta=function(H,ve,Z,pe,Se,Re,je){this.placement=new hr(H,Se,Re,je),this._currentPlacementIndex=ve.length-1,this._forceFullPlacement=Z,this._showCollisionBoxes=pe,this._done=!1};ta.prototype.isDone=function(){return this._done},ta.prototype.continuePlacement=function(H,ve,Z){for(var pe=this,Se=e.browser.now(),Re=function(){var lr=e.browser.now()-Se;return pe._forceFullPlacement?!1:lr>2};this._currentPlacementIndex>=0;){var je=H[this._currentPlacementIndex],ut=ve[je],Et=this.placement.collisionIndex.transform.zoom;if(ut.type==="symbol"&&(!ut.minzoom||ut.minzoom<=Et)&&(!ut.maxzoom||ut.maxzoom>Et)){this._inProgressLayer||(this._inProgressLayer=new On(ut));var Jt=this._inProgressLayer.continuePlacement(Z[ut.source],this.placement,this._showCollisionBoxes,ut,Re);if(Jt)return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ta.prototype.commit=function(H){return this.placement.commit(H),this.placement};var _n=512/e.EXTENT/2,jn=function(H,ve,Z){this.tileID=H,this.indexedSymbolInstances={},this.bucketInstanceId=Z;for(var pe=0;pe<ve.length;pe++){var Se=ve.get(pe),Re=Se.key;this.indexedSymbolInstances[Re]||(this.indexedSymbolInstances[Re]=[]),this.indexedSymbolInstances[Re].push({crossTileID:Se.crossTileID,coord:this.getScaledCoordinates(Se,H)})}};jn.prototype.getScaledCoordinates=function(H,ve){var Z=ve.canonical.z-this.tileID.canonical.z,pe=_n/Math.pow(2,Z);return{x:Math.floor((ve.canonical.x*e.EXTENT+H.anchorX)*pe),y:Math.floor((ve.canonical.y*e.EXTENT+H.anchorY)*pe)}},jn.prototype.findMatches=function(H,ve,Z){for(var pe=this.tileID.canonical.z<ve.canonical.z?1:Math.pow(2,this.tileID.canonical.z-ve.canonical.z),Se=0;Se<H.length;Se++){var Re=H.get(Se);if(!Re.crossTileID){var je=this.indexedSymbolInstances[Re.key];if(!!je)for(var ut=this.getScaledCoordinates(Re,ve),Et=0,Jt=je;Et<Jt.length;Et+=1){var lr=Jt[Et];if(Math.abs(lr.coord.x-ut.x)<=pe&&Math.abs(lr.coord.y-ut.y)<=pe&&!Z[lr.crossTileID]){Z[lr.crossTileID]=!0,Re.crossTileID=lr.crossTileID;break}}}}};var aa=function(){this.maxCrossTileID=0};aa.prototype.generate=function(){return++this.maxCrossTileID};var da=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};da.prototype.handleWrapJump=function(H){var ve=Math.round((H-this.lng)/360);if(ve!==0)for(var Z in this.indexes){var pe=this.indexes[Z],Se={};for(var Re in pe){var je=pe[Re];je.tileID=je.tileID.unwrapTo(je.tileID.wrap+ve),Se[je.tileID.key]=je}this.indexes[Z]=Se}this.lng=H},da.prototype.addBucket=function(H,ve,Z){if(this.indexes[H.overscaledZ]&&this.indexes[H.overscaledZ][H.key]){if(this.indexes[H.overscaledZ][H.key].bucketInstanceId===ve.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(H.overscaledZ,this.indexes[H.overscaledZ][H.key])}for(var pe=0;pe<ve.symbolInstances.length;pe++){var Se=ve.symbolInstances.get(pe);Se.crossTileID=0}this.usedCrossTileIDs[H.overscaledZ]||(this.usedCrossTileIDs[H.overscaledZ]={});var Re=this.usedCrossTileIDs[H.overscaledZ];for(var je in this.indexes){var ut=this.indexes[je];if(Number(je)>H.overscaledZ)for(var Et in ut){var Jt=ut[Et];Jt.tileID.isChildOf(H)&&Jt.findMatches(ve.symbolInstances,H,Re)}else{var lr=H.scaledTo(Number(je)),vr=ut[lr.key];vr&&vr.findMatches(ve.symbolInstances,H,Re)}}for(var Cr=0;Cr<ve.symbolInstances.length;Cr++){var Hr=ve.symbolInstances.get(Cr);Hr.crossTileID||(Hr.crossTileID=Z.generate(),Re[Hr.crossTileID]=!0)}return this.indexes[H.overscaledZ]===void 0&&(this.indexes[H.overscaledZ]={}),this.indexes[H.overscaledZ][H.key]=new jn(H,ve.symbolInstances,ve.bucketInstanceId),!0},da.prototype.removeBucketCrossTileIDs=function(H,ve){for(var Z in ve.indexedSymbolInstances)for(var pe=0,Se=ve.indexedSymbolInstances[Z];pe<Se.length;pe+=1){var Re=Se[pe];delete this.usedCrossTileIDs[H][Re.crossTileID]}},da.prototype.removeStaleBuckets=function(H){var ve=!1;for(var Z in this.indexes){var pe=this.indexes[Z];for(var Se in pe)H[pe[Se].bucketInstanceId]||(this.removeBucketCrossTileIDs(Z,pe[Se]),delete pe[Se],ve=!0)}return ve};var ma=function(){this.layerIndexes={},this.crossTileIDs=new aa,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ma.prototype.addLayer=function(H,ve,Z){var pe=this.layerIndexes[H.id];pe===void 0&&(pe=this.layerIndexes[H.id]=new da);var Se=!1,Re={};pe.handleWrapJump(Z);for(var je=0,ut=ve;je<ut.length;je+=1){var Et=ut[je],Jt=Et.getBucket(H);!Jt||H.id!==Jt.layerIds[0]||(Jt.bucketInstanceId||(Jt.bucketInstanceId=++this.maxBucketInstanceId),pe.addBucket(Et.tileID,Jt,this.crossTileIDs)&&(Se=!0),Re[Jt.bucketInstanceId]=!0)}return pe.removeStaleBuckets(Re)&&(Se=!0),Se},ma.prototype.pruneUnusedLayers=function(H){var ve={};H.forEach(function(pe){ve[pe]=!0});for(var Z in this.layerIndexes)ve[Z]||delete this.layerIndexes[Z]};var sa=function(fe,H){return e.emitValidationErrors(fe,H&&H.filter(function(ve){return ve.identifier!=="source.canvas"}))},Aa=e.pick(nr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),po=e.pick(nr,["setCenter","setZoom","setBearing","setPitch"]),zo=Wr(),Ko=function(fe){function H(ve,Z){var pe=this;Z===void 0&&(Z={}),fe.call(this),this.map=ve,this.dispatcher=new R(Gt(),this),this.imageManager=new m,this.imageManager.setEventedParent(this),this.glyphManager=new T(ve._requestManager,Z.localIdeographFontFamily),this.lineAtlas=new D(256,512),this.crossTileSymbolIndex=new ma,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var Se=this;this._rtlTextPluginCallback=H.registerForPluginStateChange(function(Re){var je={pluginStatus:Re.pluginStatus,pluginURL:Re.pluginURL};Se.dispatcher.broadcast("syncRTLPluginState",je,function(ut,Et){if(e.triggerPluginCompletionEvent(ut),Et){var Jt=Et.every(function(vr){return vr});if(Jt)for(var lr in Se.sourceCaches)Se.sourceCaches[lr].reload()}})}),this.on("data",function(Re){if(!(Re.dataType!=="source"||Re.sourceDataType!=="metadata")){var je=pe.sourceCaches[Re.sourceId];if(!!je){var ut=je.getSource();if(!(!ut||!ut.vectorLayerIds))for(var Et in pe._layers){var Jt=pe._layers[Et];Jt.source===ut.id&&pe._validateLayer(Jt)}}}})}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.loadURL=function(Z,pe){var Se=this;pe===void 0&&(pe={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var Re=typeof pe.validate=="boolean"?pe.validate:!e.isMapboxURL(Z);Z=this.map._requestManager.normalizeStyleURL(Z,pe.accessToken);var je=this.map._requestManager.transformRequest(Z,e.ResourceType.Style);this._request=e.getJSON(je,function(ut,Et){Se._request=null,ut?Se.fire(new e.ErrorEvent(ut)):Et&&Se._load(Et,Re)})},H.prototype.loadJSON=function(Z,pe){var Se=this;pe===void 0&&(pe={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){Se._request=null,Se._load(Z,pe.validate!==!1)})},H.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(zo,!1)},H.prototype._load=function(Z,pe){if(!(pe&&sa(this,e.validateStyle(Z)))){this._loaded=!0,this.stylesheet=Z;for(var Se in Z.sources)this.addSource(Se,Z.sources[Se],{validate:!1});Z.sprite?this._loadSprite(Z.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(Z.glyphs);var Re=Ar(this.stylesheet.layers);this._order=Re.map(function(Jt){return Jt.id}),this._layers={},this._serializedLayers={};for(var je=0,ut=Re;je<ut.length;je+=1){var Et=ut[je];Et=e.createStyleLayer(Et),Et.setEventedParent(this,{layer:{id:Et.id}}),this._layers[Et.id]=Et,this._serializedLayers[Et.id]=Et.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new I(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},H.prototype._loadSprite=function(Z){var pe=this;this._spriteRequest=f(Z,this.map._requestManager,function(Se,Re){if(pe._spriteRequest=null,Se)pe.fire(new e.ErrorEvent(Se));else if(Re)for(var je in Re)pe.imageManager.addImage(je,Re[je]);pe.imageManager.setLoaded(!0),pe._availableImages=pe.imageManager.listImages(),pe.dispatcher.broadcast("setImages",pe._availableImages),pe.fire(new e.Event("data",{dataType:"style"}))})},H.prototype._validateLayer=function(Z){var pe=this.sourceCaches[Z.source];if(!!pe){var Se=Z.sourceLayer;if(!!Se){var Re=pe.getSource();(Re.type==="geojson"||Re.vectorLayerIds&&Re.vectorLayerIds.indexOf(Se)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+Se+'" does not exist on source "'+Re.id+'" as specified by style layer "'+Z.id+'"')))}}},H.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var Z in this.sourceCaches)if(!this.sourceCaches[Z].loaded())return!1;return!!this.imageManager.isLoaded()},H.prototype._serializeLayers=function(Z){for(var pe=[],Se=0,Re=Z;Se<Re.length;Se+=1){var je=Re[Se],ut=this._layers[je];ut.type!=="custom"&&pe.push(ut.serialize())}return pe},H.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var Z in this.sourceCaches)if(this.sourceCaches[Z].hasTransition())return!0;for(var pe in this._layers)if(this._layers[pe].hasTransition())return!0;return!1},H.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},H.prototype.update=function(Z){if(!!this._loaded){var pe=this._changed;if(this._changed){var Se=Object.keys(this._updatedLayers),Re=Object.keys(this._removedLayers);(Se.length||Re.length)&&this._updateWorkerLayers(Se,Re);for(var je in this._updatedSources){var ut=this._updatedSources[je];ut==="reload"?this._reloadSource(je):ut==="clear"&&this._clearSource(je)}this._updateTilesForChangedImages();for(var Et in this._updatedPaintProps)this._layers[Et].updateTransitions(Z);this.light.updateTransitions(Z),this._resetUpdates()}for(var Jt in this.sourceCaches)this.sourceCaches[Jt].used=!1;for(var lr=0,vr=this._order;lr<vr.length;lr+=1){var Cr=vr[lr],Hr=this._layers[Cr];Hr.recalculate(Z,this._availableImages),!Hr.isHidden(Z.zoom)&&Hr.source&&(this.sourceCaches[Hr.source].used=!0)}this.light.recalculate(Z),this.z=Z.zoom,pe&&this.fire(new e.Event("data",{dataType:"style"}))}},H.prototype._updateTilesForChangedImages=function(){var Z=Object.keys(this._changedImages);if(Z.length){for(var pe in this.sourceCaches)this.sourceCaches[pe].reloadTilesForDependencies(["icons","patterns"],Z);this._changedImages={}}},H.prototype._updateWorkerLayers=function(Z,pe){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(Z),removedIds:pe})},H.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},H.prototype.setState=function(Z){var pe=this;if(this._checkLoaded(),sa(this,e.validateStyle(Z)))return!1;Z=e.clone$1(Z),Z.layers=Ar(Z.layers);var Se=Br(this.serialize(),Z).filter(function(je){return!(je.command in po)});if(Se.length===0)return!1;var Re=Se.filter(function(je){return!(je.command in Aa)});if(Re.length>0)throw new Error("Unimplemented: "+Re.map(function(je){return je.command}).join(", ")+".");return Se.forEach(function(je){je.command!=="setTransition"&&pe[je.command].apply(pe,je.args)}),this.stylesheet=Z,!0},H.prototype.addImage=function(Z,pe){if(this.getImage(Z))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(Z,pe),this._availableImages=this.imageManager.listImages(),this._changedImages[Z]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},H.prototype.updateImage=function(Z,pe){this.imageManager.updateImage(Z,pe)},H.prototype.getImage=function(Z){return this.imageManager.getImage(Z)},H.prototype.removeImage=function(Z){if(!this.getImage(Z))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(Z),this._availableImages=this.imageManager.listImages(),this._changedImages[Z]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},H.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},H.prototype.addSource=function(Z,pe,Se){var Re=this;if(Se===void 0&&(Se={}),this._checkLoaded(),this.sourceCaches[Z]!==void 0)throw new Error("There is already a source with this ID");if(!pe.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(pe).join(", ")+".");var je=["vector","raster","geojson","video","image"],ut=je.indexOf(pe.type)>=0;if(!(ut&&this._validate(e.validateStyle.source,"sources."+Z,pe,null,Se))){this.map&&this.map._collectResourceTiming&&(pe.collectResourceTiming=!0);var Et=this.sourceCaches[Z]=new Ce(Z,pe,this.dispatcher);Et.style=this,Et.setEventedParent(this,function(){return{isSourceLoaded:Re.loaded(),source:Et.serialize(),sourceId:Z}}),Et.onAdd(this.map),this._changed=!0}},H.prototype.removeSource=function(Z){if(this._checkLoaded(),this.sourceCaches[Z]===void 0)throw new Error("There is no source with this ID");for(var pe in this._layers)if(this._layers[pe].source===Z)return this.fire(new e.ErrorEvent(new Error('Source "'+Z+'" cannot be removed while layer "'+pe+'" is using it.')));var Se=this.sourceCaches[Z];delete this.sourceCaches[Z],delete this._updatedSources[Z],Se.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:Z})),Se.setEventedParent(null),Se.clearTiles(),Se.onRemove&&Se.onRemove(this.map),this._changed=!0},H.prototype.setGeoJSONSourceData=function(Z,pe){this._checkLoaded();var Se=this.sourceCaches[Z].getSource();Se.setData(pe),this._changed=!0},H.prototype.getSource=function(Z){return this.sourceCaches[Z]&&this.sourceCaches[Z].getSource()},H.prototype.addLayer=function(Z,pe,Se){Se===void 0&&(Se={}),this._checkLoaded();var Re=Z.id;if(this.getLayer(Re)){this.fire(new e.ErrorEvent(new Error('Layer with id "'+Re+'" already exists on this map')));return}var je;if(Z.type==="custom"){if(sa(this,e.validateCustomStyleLayer(Z)))return;je=e.createStyleLayer(Z)}else{if(typeof Z.source=="object"&&(this.addSource(Re,Z.source),Z=e.clone$1(Z),Z=e.extend(Z,{source:Re})),this._validate(e.validateStyle.layer,"layers."+Re,Z,{arrayIndex:-1},Se))return;je=e.createStyleLayer(Z),this._validateLayer(je),je.setEventedParent(this,{layer:{id:Re}}),this._serializedLayers[je.id]=je.serialize()}var ut=pe?this._order.indexOf(pe):this._order.length;if(pe&&ut===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+pe+'" does not exist on this map.')));return}if(this._order.splice(ut,0,Re),this._layerOrderChanged=!0,this._layers[Re]=je,this._removedLayers[Re]&&je.source&&je.type!=="custom"){var Et=this._removedLayers[Re];delete this._removedLayers[Re],Et.type!==je.type?this._updatedSources[je.source]="clear":(this._updatedSources[je.source]="reload",this.sourceCaches[je.source].pause())}this._updateLayer(je),je.onAdd&&je.onAdd(this.map)},H.prototype.moveLayer=function(Z,pe){this._checkLoaded(),this._changed=!0;var Se=this._layers[Z];if(!Se){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot be moved.")));return}if(Z!==pe){var Re=this._order.indexOf(Z);this._order.splice(Re,1);var je=pe?this._order.indexOf(pe):this._order.length;if(pe&&je===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+pe+'" does not exist on this map.')));return}this._order.splice(je,0,Z),this._layerOrderChanged=!0}},H.prototype.removeLayer=function(Z){this._checkLoaded();var pe=this._layers[Z];if(!pe){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot be removed.")));return}pe.setEventedParent(null);var Se=this._order.indexOf(Z);this._order.splice(Se,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[Z]=pe,delete this._layers[Z],delete this._serializedLayers[Z],delete this._updatedLayers[Z],delete this._updatedPaintProps[Z],pe.onRemove&&pe.onRemove(this.map)},H.prototype.getLayer=function(Z){return this._layers[Z]},H.prototype.hasLayer=function(Z){return Z in this._layers},H.prototype.setLayerZoomRange=function(Z,pe,Se){this._checkLoaded();var Re=this.getLayer(Z);if(!Re){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot have zoom extent.")));return}Re.minzoom===pe&&Re.maxzoom===Se||(pe!=null&&(Re.minzoom=pe),Se!=null&&(Re.maxzoom=Se),this._updateLayer(Re))},H.prototype.setFilter=function(Z,pe,Se){Se===void 0&&(Se={}),this._checkLoaded();var Re=this.getLayer(Z);if(!Re){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot be filtered.")));return}if(!e.deepEqual(Re.filter,pe)){if(pe==null){Re.filter=void 0,this._updateLayer(Re);return}this._validate(e.validateStyle.filter,"layers."+Re.id+".filter",pe,null,Se)||(Re.filter=e.clone$1(pe),this._updateLayer(Re))}},H.prototype.getFilter=function(Z){return e.clone$1(this.getLayer(Z).filter)},H.prototype.setLayoutProperty=function(Z,pe,Se,Re){Re===void 0&&(Re={}),this._checkLoaded();var je=this.getLayer(Z);if(!je){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot be styled.")));return}e.deepEqual(je.getLayoutProperty(pe),Se)||(je.setLayoutProperty(pe,Se,Re),this._updateLayer(je))},H.prototype.getLayoutProperty=function(Z,pe){var Se=this.getLayer(Z);if(!Se){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style.")));return}return Se.getLayoutProperty(pe)},H.prototype.setPaintProperty=function(Z,pe,Se,Re){Re===void 0&&(Re={}),this._checkLoaded();var je=this.getLayer(Z);if(!je){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot be styled.")));return}if(!e.deepEqual(je.getPaintProperty(pe),Se)){var ut=je.setPaintProperty(pe,Se,Re);ut&&this._updateLayer(je),this._changed=!0,this._updatedPaintProps[Z]=!0}},H.prototype.getPaintProperty=function(Z,pe){return this.getLayer(Z).getPaintProperty(pe)},H.prototype.setFeatureState=function(Z,pe){this._checkLoaded();var Se=Z.source,Re=Z.sourceLayer,je=this.sourceCaches[Se];if(je===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+Se+"' does not exist in the map's style.")));return}var ut=je.getSource().type;if(ut==="geojson"&&Re){this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if(ut==="vector"&&!Re){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}Z.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),je.setFeatureState(Re,Z.id,pe)},H.prototype.removeFeatureState=function(Z,pe){this._checkLoaded();var Se=Z.source,Re=this.sourceCaches[Se];if(Re===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+Se+"' does not exist in the map's style.")));return}var je=Re.getSource().type,ut=je==="vector"?Z.sourceLayer:void 0;if(je==="vector"&&!ut){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(pe&&typeof Z.id!="string"&&typeof Z.id!="number"){this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property.")));return}Re.removeFeatureState(ut,Z.id,pe)},H.prototype.getFeatureState=function(Z){this._checkLoaded();var pe=Z.source,Se=Z.sourceLayer,Re=this.sourceCaches[pe];if(Re===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+pe+"' does not exist in the map's style.")));return}var je=Re.getSource().type;if(je==="vector"&&!Se){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}return Z.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),Re.getFeatureState(Se,Z.id)},H.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},H.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(Z){return Z.serialize()}),layers:this._serializeLayers(this._order)},function(Z){return Z!==void 0})},H.prototype._updateLayer=function(Z){this._updatedLayers[Z.id]=!0,Z.source&&!this._updatedSources[Z.source]&&this.sourceCaches[Z.source].getSource().type!=="raster"&&(this._updatedSources[Z.source]="reload",this.sourceCaches[Z.source].pause()),this._changed=!0},H.prototype._flattenAndSortRenderedFeatures=function(Z){for(var pe=this,Se=function(Va){return pe._layers[Va].type==="fill-extrusion"},Re={},je=[],ut=this._order.length-1;ut>=0;ut--){var Et=this._order[ut];if(Se(Et)){Re[Et]=ut;for(var Jt=0,lr=Z;Jt<lr.length;Jt+=1){var vr=lr[Jt],Cr=vr[Et];if(Cr)for(var Hr=0,Yr=Cr;Hr<Yr.length;Hr+=1){var Ur=Yr[Hr];je.push(Ur)}}}}je.sort(function(Va,ni){return ni.intersectionZ-Va.intersectionZ});for(var Jr=[],hn=this._order.length-1;hn>=0;hn--){var Cn=this._order[hn];if(Se(Cn))for(var Fn=je.length-1;Fn>=0;Fn--){var Kn=je[Fn].feature;if(Re[Kn.layer.id]<hn)break;Jr.push(Kn),je.pop()}else for(var qn=0,Qn=Z;qn<Qn.length;qn+=1){var ca=Qn[qn],ba=ca[Cn];if(ba)for(var ya=0,Ta=ba;ya<Ta.length;ya+=1){var Ca=Ta[ya];Jr.push(Ca.feature)}}}return Jr},H.prototype.queryRenderedFeatures=function(Z,pe,Se){pe&&pe.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",pe.filter,null,pe);var Re={};if(pe&&pe.layers){if(!Array.isArray(pe.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var je=0,ut=pe.layers;je<ut.length;je+=1){var Et=ut[je],Jt=this._layers[Et];if(!Jt)return this.fire(new e.ErrorEvent(new Error("The layer '"+Et+"' does not exist in the map's style and cannot be queried for features."))),[];Re[Jt.source]=!0}}var lr=[];pe.availableImages=this._availableImages;for(var vr in this.sourceCaches)pe.layers&&!Re[vr]||lr.push(ie(this.sourceCaches[vr],this._layers,this._serializedLayers,Z,pe,Se));return this.placement&&lr.push(se(this._layers,this._serializedLayers,this.sourceCaches,Z,pe,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(lr)},H.prototype.querySourceFeatures=function(Z,pe){pe&&pe.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",pe.filter,null,pe);var Se=this.sourceCaches[Z];return Se?ae(Se,pe):[]},H.prototype.addSourceType=function(Z,pe,Se){if(H.getSourceType(Z))return Se(new Error('A source type called "'+Z+'" already exists.'));if(H.setSourceType(Z,pe),!pe.workerSourceURL)return Se(null,null);this.dispatcher.broadcast("loadWorkerSource",{name:Z,url:pe.workerSourceURL},Se)},H.prototype.getLight=function(){return this.light.getLight()},H.prototype.setLight=function(Z,pe){pe===void 0&&(pe={}),this._checkLoaded();var Se=this.light.getLight(),Re=!1;for(var je in Z)if(!e.deepEqual(Z[je],Se[je])){Re=!0;break}if(!!Re){var ut={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(Z,pe),this.light.updateTransitions(ut)}},H.prototype._validate=function(Z,pe,Se,Re,je){return je===void 0&&(je={}),je&&je.validate===!1?!1:sa(this,Z.call(e.validateStyle,e.extend({key:pe,style:this.serialize(),value:Se,styleSpec:e.styleSpec},Re)))},H.prototype._remove=function(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(var Z in this._layers){var pe=this._layers[Z];pe.setEventedParent(null)}for(var Se in this.sourceCaches)this.sourceCaches[Se].clearTiles(),this.sourceCaches[Se].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},H.prototype._clearSource=function(Z){this.sourceCaches[Z].clearTiles()},H.prototype._reloadSource=function(Z){this.sourceCaches[Z].resume(),this.sourceCaches[Z].reload()},H.prototype._updateSources=function(Z){for(var pe in this.sourceCaches)this.sourceCaches[pe].update(Z)},H.prototype._generateCollisionBoxes=function(){for(var Z in this.sourceCaches)this._reloadSource(Z)},H.prototype._updatePlacement=function(Z,pe,Se,Re,je){je===void 0&&(je=!1);for(var ut=!1,Et=!1,Jt={},lr=0,vr=this._order;lr<vr.length;lr+=1){var Cr=vr[lr],Hr=this._layers[Cr];if(Hr.type==="symbol"){if(!Jt[Hr.source]){var Yr=this.sourceCaches[Hr.source];Jt[Hr.source]=Yr.getRenderableIds(!0).map(function(qn){return Yr.getTileByID(qn)}).sort(function(qn,Qn){return Qn.tileID.overscaledZ-qn.tileID.overscaledZ||(qn.tileID.isLessThan(Qn.tileID)?-1:1)})}var Ur=this.crossTileSymbolIndex.addLayer(Hr,Jt[Hr.source],Z.center.lng);ut=ut||Ur}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),je=je||this._layerOrderChanged||Se===0,(je||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),Z.zoom))&&(this.pauseablePlacement=new ta(Z,this._order,je,pe,Se,Re,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Jt),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),Et=!0),ut&&this.pauseablePlacement.placement.setStale()),Et||ut)for(var Jr=0,hn=this._order;Jr<hn.length;Jr+=1){var Cn=hn[Jr],Fn=this._layers[Cn];Fn.type==="symbol"&&this.placement.updateLayerOpacities(Fn,Jt[Fn.source])}var Kn=!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now());return Kn},H.prototype._releaseSymbolFadeTiles=function(){for(var Z in this.sourceCaches)this.sourceCaches[Z].releaseSymbolFadeTiles()},H.prototype.getImages=function(Z,pe,Se){this.imageManager.getImages(pe.icons,Se),this._updateTilesForChangedImages();var Re=this.sourceCaches[pe.source];Re&&Re.setDependencies(pe.tileID.key,pe.type,pe.icons)},H.prototype.getGlyphs=function(Z,pe,Se){this.glyphManager.getGlyphs(pe.stacks,Se)},H.prototype.getResource=function(Z,pe,Se){return e.makeRequest(pe,Se)},H}(e.Evented);Ko.getSourceType=$,Ko.setSourceType=ne,Ko.registerForPluginStateChange=e.registerForPluginStateChange;var nl=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),pl=`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,Yl=`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`,vi=`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Gs="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}",Rs=`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Hi="uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}",So=`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,dl=`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`,ps="void main() {gl_FragColor=vec4(1.0);}",Di="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}",al=`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Qi=`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`,Oi=`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,io="uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}",$i="varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}",rs="attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}",Ys="varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",au="attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}",Jo="uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",iu="attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}",Is=`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ko=`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`,Mu=`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,zs=`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`,ws=`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ll=`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`,Su=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ku=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`,Ws=`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Pl=`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`,Ts=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Wl=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`,il=`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Xl="uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}",ou=`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Dl="uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}",Eu=`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Xs=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`,Zl=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Rl=`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`,ds=`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,yl=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`,jl=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,su=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`,lu=`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Il="uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}",Cu=`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,uu=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`,Qo=`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ol=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`,sl=`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Kl=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`,gs=Ri(pl,Yl),Eo=Ri(vi,Gs),zl=Ri(Rs,Hi),As=Ri(So,dl),Ms=Ri(ps,Di),lo=Ri(al,Qi),ml=Ri(Oi,io),xl=Ri($i,rs),Zs=Ri(Ys,au),ys=Ri(Jo,iu),bl=Ri(Is,ko),ll=Ri(Mu,zs),Fl=Ri(ws,Ll),_l=Ri(Su,ku),js=Ri(Ws,Pl),Lu=Ri(Ts,Wl),ns=Ri(il,Xl),Yu=Ri(ou,Dl),Jl=Ri(Eu,Xs),ul=Ri(Zl,Rl),wl=Ri(ds,yl),Ks=Ri(jl,su),Tl=Ri(lu,Il),fu=Ri(Cu,uu),cu=Ri(Qo,ol),Wu=Ri(sl,Kl);function Ri(fe,H){var ve=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,Z={};return fe=fe.replace(ve,function(pe,Se,Re,je,ut){return Z[ut]=!0,Se==="define"?`
#ifndef HAS_UNIFORM_u_`+ut+`
varying `+Re+" "+je+" "+ut+`;
#else
uniform `+Re+" "+je+" u_"+ut+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+ut+`
    `+Re+" "+je+" "+ut+" = u_"+ut+`;
#endif
`}),H=H.replace(ve,function(pe,Se,Re,je,ut){var Et=je==="float"?"vec2":"vec4",Jt=ut.match(/color/)?"color":Et;return Z[ut]?Se==="define"?`
#ifndef HAS_UNIFORM_u_`+ut+`
uniform lowp float u_`+ut+`_t;
attribute `+Re+" "+Et+" a_"+ut+`;
varying `+Re+" "+je+" "+ut+`;
#else
uniform `+Re+" "+je+" u_"+ut+`;
#endif
`:Jt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+ut+" = a_"+ut+`;
#else
    `+Re+" "+je+" "+ut+" = u_"+ut+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+ut+" = unpack_mix_"+Jt+"(a_"+ut+", u_"+ut+`_t);
#else
    `+Re+" "+je+" "+ut+" = u_"+ut+`;
#endif
`:Se==="define"?`
#ifndef HAS_UNIFORM_u_`+ut+`
uniform lowp float u_`+ut+`_t;
attribute `+Re+" "+Et+" a_"+ut+`;
#else
uniform `+Re+" "+je+" u_"+ut+`;
#endif
`:Jt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+Re+" "+je+" "+ut+" = a_"+ut+`;
#else
    `+Re+" "+je+" "+ut+" = u_"+ut+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+Re+" "+je+" "+ut+" = unpack_mix_"+Jt+"(a_"+ut+", u_"+ut+`_t);
#else
    `+Re+" "+je+" "+ut+" = u_"+ut+`;
#endif
`}),{fragmentSource:fe,vertexSource:H}}var fl=Object.freeze({__proto__:null,prelude:gs,background:Eo,backgroundPattern:zl,circle:As,clippingMask:Ms,heatmap:lo,heatmapTexture:ml,collisionBox:xl,collisionCircle:Zs,debug:ys,fill:bl,fillOutline:ll,fillOutlinePattern:Fl,fillPattern:_l,fillExtrusion:js,fillExtrusionPattern:Lu,hillshadePrepare:ns,hillshade:Yu,line:Jl,lineGradient:ul,linePattern:wl,lineSDF:Ks,raster:Tl,symbolIcon:fu,symbolSDF:cu,symbolTextAndIcon:Wu}),Js=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Js.prototype.bind=function(H,ve,Z,pe,Se,Re,je,ut){this.context=H;for(var Et=this.boundPaintVertexBuffers.length!==pe.length,Jt=0;!Et&&Jt<pe.length;Jt++)this.boundPaintVertexBuffers[Jt]!==pe[Jt]&&(Et=!0);var lr=!this.vao||this.boundProgram!==ve||this.boundLayoutVertexBuffer!==Z||Et||this.boundIndexBuffer!==Se||this.boundVertexOffset!==Re||this.boundDynamicVertexBuffer!==je||this.boundDynamicVertexBuffer2!==ut;!H.extVertexArrayObject||lr?this.freshBind(ve,Z,pe,Se,Re,je,ut):(H.bindVertexArrayOES.set(this.vao),je&&je.bind(),Se&&Se.dynamicDraw&&Se.bind(),ut&&ut.bind())},Js.prototype.freshBind=function(H,ve,Z,pe,Se,Re,je){var ut,Et=H.numAttributes,Jt=this.context,lr=Jt.gl;if(Jt.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Jt.extVertexArrayObject.createVertexArrayOES(),Jt.bindVertexArrayOES.set(this.vao),ut=0,this.boundProgram=H,this.boundLayoutVertexBuffer=ve,this.boundPaintVertexBuffers=Z,this.boundIndexBuffer=pe,this.boundVertexOffset=Se,this.boundDynamicVertexBuffer=Re,this.boundDynamicVertexBuffer2=je;else{ut=Jt.currentNumAttributes||0;for(var vr=Et;vr<ut;vr++)lr.disableVertexAttribArray(vr)}ve.enableAttributes(lr,H);for(var Cr=0,Hr=Z;Cr<Hr.length;Cr+=1){var Yr=Hr[Cr];Yr.enableAttributes(lr,H)}Re&&Re.enableAttributes(lr,H),je&&je.enableAttributes(lr,H),ve.bind(),ve.setVertexAttribPointers(lr,H,Se);for(var Ur=0,Jr=Z;Ur<Jr.length;Ur+=1){var hn=Jr[Ur];hn.bind(),hn.setVertexAttribPointers(lr,H,Se)}Re&&(Re.bind(),Re.setVertexAttribPointers(lr,H,Se)),pe&&pe.bind(),je&&(je.bind(),je.setVertexAttribPointers(lr,H,Se)),Jt.currentNumAttributes=Et},Js.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var $o=function(H,ve,Z,pe,Se){var Re=H.gl;this.program=Re.createProgram();var je=Z?Z.defines():[];Se&&je.push("#define OVERDRAW_INSPECTOR;");var ut=je.concat(gs.fragmentSource,ve.fragmentSource).join(`
`),Et=je.concat(gs.vertexSource,ve.vertexSource).join(`
`),Jt=Re.createShader(Re.FRAGMENT_SHADER);if(Re.isContextLost()){this.failedToCreate=!0;return}Re.shaderSource(Jt,ut),Re.compileShader(Jt),Re.attachShader(this.program,Jt);var lr=Re.createShader(Re.VERTEX_SHADER);if(Re.isContextLost()){this.failedToCreate=!0;return}Re.shaderSource(lr,Et),Re.compileShader(lr),Re.attachShader(this.program,lr);for(var vr=Z?Z.layoutAttributes:[],Cr=0;Cr<vr.length;Cr++)Re.bindAttribLocation(this.program,Cr,vr[Cr].name);Re.linkProgram(this.program),Re.deleteShader(lr),Re.deleteShader(Jt),this.numAttributes=Re.getProgramParameter(this.program,Re.ACTIVE_ATTRIBUTES),this.attributes={};for(var Hr={},Yr=0;Yr<this.numAttributes;Yr++){var Ur=Re.getActiveAttrib(this.program,Yr);Ur&&(this.attributes[Ur.name]=Re.getAttribLocation(this.program,Ur.name))}for(var Jr=Re.getProgramParameter(this.program,Re.ACTIVE_UNIFORMS),hn=0;hn<Jr;hn++){var Cn=Re.getActiveUniform(this.program,hn);Cn&&(Hr[Cn.name]=Re.getUniformLocation(this.program,Cn.name))}this.fixedUniforms=pe(H,Hr),this.binderUniforms=Z?Z.getUniforms(H,Hr):[]};$o.prototype.draw=function(H,ve,Z,pe,Se,Re,je,ut,Et,Jt,lr,vr,Cr,Hr,Yr,Ur){var Jr,hn=H.gl;if(!this.failedToCreate){H.program.set(this.program),H.setDepthMode(Z),H.setStencilMode(pe),H.setColorMode(Se),H.setCullFace(Re);for(var Cn in this.fixedUniforms)this.fixedUniforms[Cn].set(je[Cn]);Hr&&Hr.setUniforms(H,this.binderUniforms,vr,{zoom:Cr});for(var Fn=(Jr={},Jr[hn.LINES]=2,Jr[hn.TRIANGLES]=3,Jr[hn.LINE_STRIP]=1,Jr)[ve],Kn=0,qn=lr.get();Kn<qn.length;Kn+=1){var Qn=qn[Kn],ca=Qn.vaos||(Qn.vaos={}),ba=ca[ut]||(ca[ut]=new Js);ba.bind(H,this,Et,Hr?Hr.getPaintVertexBuffers():[],Jt,Qn.vertexOffset,Yr,Ur),hn.drawElements(ve,Qn.primitiveLength*Fn,hn.UNSIGNED_SHORT,Qn.primitiveOffset*Fn*2)}}};function as(fe,H,ve){var Z=1/An(ve,1,H.transform.tileZoom),pe=Math.pow(2,ve.tileID.overscaledZ),Se=ve.tileSize*Math.pow(2,H.transform.tileZoom)/pe,Re=Se*(ve.tileID.canonical.x+ve.tileID.wrap*pe),je=Se*ve.tileID.canonical.y;return{u_image:0,u_texsize:ve.imageAtlasTexture.size,u_scale:[Z,fe.fromScale,fe.toScale],u_fade:fe.t,u_pixel_coord_upper:[Re>>16,je>>16],u_pixel_coord_lower:[Re&65535,je&65535]}}function Al(fe,H,ve,Z){var pe=ve.imageManager.getPattern(fe.from.toString()),Se=ve.imageManager.getPattern(fe.to.toString()),Re=ve.imageManager.getPixelSize(),je=Re.width,ut=Re.height,Et=Math.pow(2,Z.tileID.overscaledZ),Jt=Z.tileSize*Math.pow(2,ve.transform.tileZoom)/Et,lr=Jt*(Z.tileID.canonical.x+Z.tileID.wrap*Et),vr=Jt*Z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:pe.tl,u_pattern_br_a:pe.br,u_pattern_tl_b:Se.tl,u_pattern_br_b:Se.br,u_texsize:[je,ut],u_mix:H.t,u_pattern_size_a:pe.displaySize,u_pattern_size_b:Se.displaySize,u_scale_a:H.fromScale,u_scale_b:H.toScale,u_tile_units_to_pixels:1/An(Z,1,ve.transform.tileZoom),u_pixel_coord_upper:[lr>>16,vr>>16],u_pixel_coord_lower:[lr&65535,vr&65535]}}var uo=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_lightpos:new e.Uniform3f(fe,H.u_lightpos),u_lightintensity:new e.Uniform1f(fe,H.u_lightintensity),u_lightcolor:new e.Uniform3f(fe,H.u_lightcolor),u_vertical_gradient:new e.Uniform1f(fe,H.u_vertical_gradient),u_opacity:new e.Uniform1f(fe,H.u_opacity)}},hu=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_lightpos:new e.Uniform3f(fe,H.u_lightpos),u_lightintensity:new e.Uniform1f(fe,H.u_lightintensity),u_lightcolor:new e.Uniform3f(fe,H.u_lightcolor),u_vertical_gradient:new e.Uniform1f(fe,H.u_vertical_gradient),u_height_factor:new e.Uniform1f(fe,H.u_height_factor),u_image:new e.Uniform1i(fe,H.u_image),u_texsize:new e.Uniform2f(fe,H.u_texsize),u_pixel_coord_upper:new e.Uniform2f(fe,H.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(fe,H.u_pixel_coord_lower),u_scale:new e.Uniform3f(fe,H.u_scale),u_fade:new e.Uniform1f(fe,H.u_fade),u_opacity:new e.Uniform1f(fe,H.u_opacity)}},is=function(fe,H,ve,Z){var pe=H.style.light,Se=pe.properties.get("position"),Re=[Se.x,Se.y,Se.z],je=e.create$1();pe.properties.get("anchor")==="viewport"&&e.fromRotation(je,-H.transform.angle),e.transformMat3(Re,Re,je);var ut=pe.properties.get("color");return{u_matrix:fe,u_lightpos:Re,u_lightintensity:pe.properties.get("intensity"),u_lightcolor:[ut.r,ut.g,ut.b],u_vertical_gradient:+ve,u_opacity:Z}},Fs=function(fe,H,ve,Z,pe,Se,Re){return e.extend(is(fe,H,ve,Z),as(Se,H,Re),{u_height_factor:-Math.pow(2,pe.overscaledZ)/Re.tileSize/8})},Os=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix)}},Ss=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_image:new e.Uniform1i(fe,H.u_image),u_texsize:new e.Uniform2f(fe,H.u_texsize),u_pixel_coord_upper:new e.Uniform2f(fe,H.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(fe,H.u_pixel_coord_lower),u_scale:new e.Uniform3f(fe,H.u_scale),u_fade:new e.Uniform1f(fe,H.u_fade)}},os=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_world:new e.Uniform2f(fe,H.u_world)}},Gi=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_world:new e.Uniform2f(fe,H.u_world),u_image:new e.Uniform1i(fe,H.u_image),u_texsize:new e.Uniform2f(fe,H.u_texsize),u_pixel_coord_upper:new e.Uniform2f(fe,H.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(fe,H.u_pixel_coord_lower),u_scale:new e.Uniform3f(fe,H.u_scale),u_fade:new e.Uniform1f(fe,H.u_fade)}},Co=function(fe){return{u_matrix:fe}},ss=function(fe,H,ve,Z){return e.extend(Co(fe),as(ve,H,Z))},vu=function(fe,H){return{u_matrix:fe,u_world:H}},Ol=function(fe,H,ve,Z,pe){return e.extend(ss(fe,H,ve,Z),{u_world:pe})},pu=function(fe,H){return{u_camera_to_center_distance:new e.Uniform1f(fe,H.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(fe,H.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(fe,H.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(fe,H.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(fe,H.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(fe,H.u_matrix)}},yt=function(fe,H,ve,Z){var pe=fe.transform,Se,Re;if(Z.paint.get("circle-pitch-alignment")==="map"){var je=An(ve,1,pe.zoom);Se=!0,Re=[je,je]}else Se=!1,Re=pe.pixelsToGLUnits;return{u_camera_to_center_distance:pe.cameraToCenterDistance,u_scale_with_map:+(Z.paint.get("circle-pitch-scale")==="map"),u_matrix:fe.translatePosMatrix(H.posMatrix,ve,Z.paint.get("circle-translate"),Z.paint.get("circle-translate-anchor")),u_pitch_with_map:+Se,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:Re}},Ot=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_camera_to_center_distance:new e.Uniform1f(fe,H.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(fe,H.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(fe,H.u_extrude_scale),u_overscale_factor:new e.Uniform1f(fe,H.u_overscale_factor)}},cr=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_inv_matrix:new e.UniformMatrix4f(fe,H.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(fe,H.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(fe,H.u_viewport_size)}},or=function(fe,H,ve){var Z=An(ve,1,H.zoom),pe=Math.pow(2,H.zoom-ve.tileID.overscaledZ),Se=ve.tileID.overscaleFactor();return{u_matrix:fe,u_camera_to_center_distance:H.cameraToCenterDistance,u_pixels_to_tile_units:Z,u_extrude_scale:[H.pixelsToGLUnits[0]/(Z*pe),H.pixelsToGLUnits[1]/(Z*pe)],u_overscale_factor:Se}},Rr=function(fe,H,ve){return{u_matrix:fe,u_inv_matrix:H,u_camera_to_center_distance:ve.cameraToCenterDistance,u_viewport_size:[ve.width,ve.height]}},tn=function(fe,H){return{u_color:new e.UniformColor(fe,H.u_color),u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_overlay:new e.Uniform1i(fe,H.u_overlay),u_overlay_scale:new e.Uniform1f(fe,H.u_overlay_scale)}},dn=function(fe,H,ve){return ve===void 0&&(ve=1),{u_matrix:fe,u_color:H,u_overlay:0,u_overlay_scale:ve}},Mn=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix)}},Ln=function(fe){return{u_matrix:fe}},Nn=function(fe,H){return{u_extrude_scale:new e.Uniform1f(fe,H.u_extrude_scale),u_intensity:new e.Uniform1f(fe,H.u_intensity),u_matrix:new e.UniformMatrix4f(fe,H.u_matrix)}},yn=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_world:new e.Uniform2f(fe,H.u_world),u_image:new e.Uniform1i(fe,H.u_image),u_color_ramp:new e.Uniform1i(fe,H.u_color_ramp),u_opacity:new e.Uniform1f(fe,H.u_opacity)}},zn=function(fe,H,ve,Z){return{u_matrix:fe,u_extrude_scale:An(H,1,ve),u_intensity:Z}},Pn=function(fe,H,ve,Z){var pe=e.create();e.ortho(pe,0,fe.width,fe.height,0,0,1);var Se=fe.context.gl;return{u_matrix:pe,u_world:[Se.drawingBufferWidth,Se.drawingBufferHeight],u_image:ve,u_color_ramp:Z,u_opacity:H.paint.get("heatmap-opacity")}},Vn=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_image:new e.Uniform1i(fe,H.u_image),u_latrange:new e.Uniform2f(fe,H.u_latrange),u_light:new e.Uniform2f(fe,H.u_light),u_shadow:new e.UniformColor(fe,H.u_shadow),u_highlight:new e.UniformColor(fe,H.u_highlight),u_accent:new e.UniformColor(fe,H.u_accent)}},$n=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_image:new e.Uniform1i(fe,H.u_image),u_dimension:new e.Uniform2f(fe,H.u_dimension),u_zoom:new e.Uniform1f(fe,H.u_zoom),u_maxzoom:new e.Uniform1f(fe,H.u_maxzoom),u_unpack:new e.Uniform4f(fe,H.u_unpack)}},za=function(fe,H,ve){var Z=ve.paint.get("hillshade-shadow-color"),pe=ve.paint.get("hillshade-highlight-color"),Se=ve.paint.get("hillshade-accent-color"),Re=ve.paint.get("hillshade-illumination-direction")*(Math.PI/180);ve.paint.get("hillshade-illumination-anchor")==="viewport"&&(Re-=fe.transform.angle);var je=!fe.options.moving;return{u_matrix:fe.transform.calculatePosMatrix(H.tileID.toUnwrapped(),je),u_image:0,u_latrange:Fa(fe,H.tileID),u_light:[ve.paint.get("hillshade-exaggeration"),Re],u_shadow:Z,u_highlight:pe,u_accent:Se}},Ea=function(fe,H,ve){var Z=H.stride,pe=e.create();return e.ortho(pe,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(pe,pe,[0,-e.EXTENT,0]),{u_matrix:pe,u_image:1,u_dimension:[Z,Z],u_zoom:fe.overscaledZ,u_maxzoom:ve,u_unpack:H.getUnpackVector()}};function Fa(fe,H){var ve=Math.pow(2,H.canonical.z),Z=H.canonical.y;return[new e.MercatorCoordinate(0,Z/ve).toLngLat().lat,new e.MercatorCoordinate(0,(Z+1)/ve).toLngLat().lat]}var Oa=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_ratio:new e.Uniform1f(fe,H.u_ratio),u_device_pixel_ratio:new e.Uniform1f(fe,H.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(fe,H.u_units_to_pixels)}},Jn=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_ratio:new e.Uniform1f(fe,H.u_ratio),u_device_pixel_ratio:new e.Uniform1f(fe,H.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(fe,H.u_units_to_pixels),u_image:new e.Uniform1i(fe,H.u_image)}},ha=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_texsize:new e.Uniform2f(fe,H.u_texsize),u_ratio:new e.Uniform1f(fe,H.u_ratio),u_device_pixel_ratio:new e.Uniform1f(fe,H.u_device_pixel_ratio),u_image:new e.Uniform1i(fe,H.u_image),u_units_to_pixels:new e.Uniform2f(fe,H.u_units_to_pixels),u_scale:new e.Uniform3f(fe,H.u_scale),u_fade:new e.Uniform1f(fe,H.u_fade)}},Ga=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_ratio:new e.Uniform1f(fe,H.u_ratio),u_device_pixel_ratio:new e.Uniform1f(fe,H.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(fe,H.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(fe,H.u_patternscale_a),u_patternscale_b:new e.Uniform2f(fe,H.u_patternscale_b),u_sdfgamma:new e.Uniform1f(fe,H.u_sdfgamma),u_image:new e.Uniform1i(fe,H.u_image),u_tex_y_a:new e.Uniform1f(fe,H.u_tex_y_a),u_tex_y_b:new e.Uniform1f(fe,H.u_tex_y_b),u_mix:new e.Uniform1f(fe,H.u_mix)}},Qa=function(fe,H,ve){var Z=fe.transform;return{u_matrix:oi(fe,H,ve),u_ratio:1/An(H,1,Z.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/Z.pixelsToGLUnits[0],1/Z.pixelsToGLUnits[1]]}},di=function(fe,H,ve){return e.extend(Qa(fe,H,ve),{u_image:0})},gi=function(fe,H,ve,Z){var pe=fe.transform,Se=Ai(H,pe);return{u_matrix:oi(fe,H,ve),u_texsize:H.imageAtlasTexture.size,u_ratio:1/An(H,1,pe.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[Se,Z.fromScale,Z.toScale],u_fade:Z.t,u_units_to_pixels:[1/pe.pixelsToGLUnits[0],1/pe.pixelsToGLUnits[1]]}},mi=function(fe,H,ve,Z,pe){var Se=fe.transform,Re=fe.lineAtlas,je=Ai(H,Se),ut=ve.layout.get("line-cap")==="round",Et=Re.getDash(Z.from,ut),Jt=Re.getDash(Z.to,ut),lr=Et.width*pe.fromScale,vr=Jt.width*pe.toScale;return e.extend(Qa(fe,H,ve),{u_patternscale_a:[je/lr,-Et.height/2],u_patternscale_b:[je/vr,-Jt.height/2],u_sdfgamma:Re.width/(Math.min(lr,vr)*256*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Et.y,u_tex_y_b:Jt.y,u_mix:pe.t})};function Ai(fe,H){return 1/An(fe,1,H.tileZoom)}function oi(fe,H,ve){return fe.translatePosMatrix(H.tileID.posMatrix,H,ve.paint.get("line-translate"),ve.paint.get("line-translate-anchor"))}var xo=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_tl_parent:new e.Uniform2f(fe,H.u_tl_parent),u_scale_parent:new e.Uniform1f(fe,H.u_scale_parent),u_buffer_scale:new e.Uniform1f(fe,H.u_buffer_scale),u_fade_t:new e.Uniform1f(fe,H.u_fade_t),u_opacity:new e.Uniform1f(fe,H.u_opacity),u_image0:new e.Uniform1i(fe,H.u_image0),u_image1:new e.Uniform1i(fe,H.u_image1),u_brightness_low:new e.Uniform1f(fe,H.u_brightness_low),u_brightness_high:new e.Uniform1f(fe,H.u_brightness_high),u_saturation_factor:new e.Uniform1f(fe,H.u_saturation_factor),u_contrast_factor:new e.Uniform1f(fe,H.u_contrast_factor),u_spin_weights:new e.Uniform3f(fe,H.u_spin_weights)}},to=function(fe,H,ve,Z,pe){return{u_matrix:fe,u_tl_parent:H,u_scale_parent:ve,u_buffer_scale:1,u_fade_t:Z.mix,u_opacity:Z.opacity*pe.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:pe.paint.get("raster-brightness-min"),u_brightness_high:pe.paint.get("raster-brightness-max"),u_saturation_factor:xi(pe.paint.get("raster-saturation")),u_contrast_factor:va(pe.paint.get("raster-contrast")),u_spin_weights:Ja(pe.paint.get("raster-hue-rotate"))}};function Ja(fe){fe*=Math.PI/180;var H=Math.sin(fe),ve=Math.cos(fe);return[(2*ve+1)/3,(-Math.sqrt(3)*H-ve+1)/3,(Math.sqrt(3)*H-ve+1)/3]}function va(fe){return fe>0?1/(1-fe):1+fe}function xi(fe){return fe>0?1-1/(1.001-fe):-fe}var fo=function(fe,H){return{u_is_size_zoom_constant:new e.Uniform1i(fe,H.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(fe,H.u_is_size_feature_constant),u_size_t:new e.Uniform1f(fe,H.u_size_t),u_size:new e.Uniform1f(fe,H.u_size),u_camera_to_center_distance:new e.Uniform1f(fe,H.u_camera_to_center_distance),u_pitch:new e.Uniform1f(fe,H.u_pitch),u_rotate_symbol:new e.Uniform1i(fe,H.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(fe,H.u_aspect_ratio),u_fade_change:new e.Uniform1f(fe,H.u_fade_change),u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(fe,H.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(fe,H.u_coord_matrix),u_is_text:new e.Uniform1i(fe,H.u_is_text),u_pitch_with_map:new e.Uniform1i(fe,H.u_pitch_with_map),u_texsize:new e.Uniform2f(fe,H.u_texsize),u_texture:new e.Uniform1i(fe,H.u_texture)}},go=function(fe,H){return{u_is_size_zoom_constant:new e.Uniform1i(fe,H.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(fe,H.u_is_size_feature_constant),u_size_t:new e.Uniform1f(fe,H.u_size_t),u_size:new e.Uniform1f(fe,H.u_size),u_camera_to_center_distance:new e.Uniform1f(fe,H.u_camera_to_center_distance),u_pitch:new e.Uniform1f(fe,H.u_pitch),u_rotate_symbol:new e.Uniform1i(fe,H.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(fe,H.u_aspect_ratio),u_fade_change:new e.Uniform1f(fe,H.u_fade_change),u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(fe,H.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(fe,H.u_coord_matrix),u_is_text:new e.Uniform1i(fe,H.u_is_text),u_pitch_with_map:new e.Uniform1i(fe,H.u_pitch_with_map),u_texsize:new e.Uniform2f(fe,H.u_texsize),u_texture:new e.Uniform1i(fe,H.u_texture),u_gamma_scale:new e.Uniform1f(fe,H.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(fe,H.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(fe,H.u_is_halo)}},ls=function(fe,H){return{u_is_size_zoom_constant:new e.Uniform1i(fe,H.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(fe,H.u_is_size_feature_constant),u_size_t:new e.Uniform1f(fe,H.u_size_t),u_size:new e.Uniform1f(fe,H.u_size),u_camera_to_center_distance:new e.Uniform1f(fe,H.u_camera_to_center_distance),u_pitch:new e.Uniform1f(fe,H.u_pitch),u_rotate_symbol:new e.Uniform1i(fe,H.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(fe,H.u_aspect_ratio),u_fade_change:new e.Uniform1f(fe,H.u_fade_change),u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(fe,H.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(fe,H.u_coord_matrix),u_is_text:new e.Uniform1i(fe,H.u_is_text),u_pitch_with_map:new e.Uniform1i(fe,H.u_pitch_with_map),u_texsize:new e.Uniform2f(fe,H.u_texsize),u_texsize_icon:new e.Uniform2f(fe,H.u_texsize_icon),u_texture:new e.Uniform1i(fe,H.u_texture),u_texture_icon:new e.Uniform1i(fe,H.u_texture_icon),u_gamma_scale:new e.Uniform1f(fe,H.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(fe,H.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(fe,H.u_is_halo)}},ks=function(fe,H,ve,Z,pe,Se,Re,je,ut,Et){var Jt=pe.transform;return{u_is_size_zoom_constant:+(fe==="constant"||fe==="source"),u_is_size_feature_constant:+(fe==="constant"||fe==="camera"),u_size_t:H?H.uSizeT:0,u_size:H?H.uSize:0,u_camera_to_center_distance:Jt.cameraToCenterDistance,u_pitch:Jt.pitch/360*2*Math.PI,u_rotate_symbol:+ve,u_aspect_ratio:Jt.width/Jt.height,u_fade_change:pe.options.fadeDuration?pe.symbolFadeChange:1,u_matrix:Se,u_label_plane_matrix:Re,u_coord_matrix:je,u_is_text:+ut,u_pitch_with_map:+Z,u_texsize:Et,u_texture:0}},Fo=function(fe,H,ve,Z,pe,Se,Re,je,ut,Et,Jt){var lr=pe.transform;return e.extend(ks(fe,H,ve,Z,pe,Se,Re,je,ut,Et),{u_gamma_scale:Z?Math.cos(lr._pitch)*lr.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+Jt})},Qs=function(fe,H,ve,Z,pe,Se,Re,je,ut,Et){return e.extend(Fo(fe,H,ve,Z,pe,Se,Re,je,!0,ut,!0),{u_texsize_icon:Et,u_texture_icon:1})},ms=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_opacity:new e.Uniform1f(fe,H.u_opacity),u_color:new e.UniformColor(fe,H.u_color)}},us=function(fe,H){return{u_matrix:new e.UniformMatrix4f(fe,H.u_matrix),u_opacity:new e.Uniform1f(fe,H.u_opacity),u_image:new e.Uniform1i(fe,H.u_image),u_pattern_tl_a:new e.Uniform2f(fe,H.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(fe,H.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(fe,H.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(fe,H.u_pattern_br_b),u_texsize:new e.Uniform2f(fe,H.u_texsize),u_mix:new e.Uniform1f(fe,H.u_mix),u_pattern_size_a:new e.Uniform2f(fe,H.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(fe,H.u_pattern_size_b),u_scale_a:new e.Uniform1f(fe,H.u_scale_a),u_scale_b:new e.Uniform1f(fe,H.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(fe,H.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(fe,H.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(fe,H.u_tile_units_to_pixels)}},bo=function(fe,H,ve){return{u_matrix:fe,u_opacity:H,u_color:ve}},Bl=function(fe,H,ve,Z,pe,Se){return e.extend(Al(Z,Se,ve,pe),{u_matrix:fe,u_opacity:H})},Ql={fillExtrusion:uo,fillExtrusionPattern:hu,fill:Os,fillPattern:Ss,fillOutline:os,fillOutlinePattern:Gi,circle:pu,collisionBox:Ot,collisionCircle:cr,debug:tn,clippingMask:Mn,heatmap:Nn,heatmapTexture:yn,hillshade:Vn,hillshadePrepare:$n,line:Oa,lineGradient:Jn,linePattern:ha,lineSDF:Ga,raster:xo,symbolIcon:fo,symbolSDF:go,symbolTextAndIcon:ls,background:ms,backgroundPattern:us},fs;function du(fe,H,ve,Z,pe,Se,Re){for(var je=fe.context,ut=je.gl,Et=fe.useProgram("collisionBox"),Jt=[],lr=0,vr=0,Cr=0;Cr<Z.length;Cr++){var Hr=Z[Cr],Yr=H.getTile(Hr),Ur=Yr.getBucket(ve);if(!!Ur){var Jr=Hr.posMatrix;(pe[0]!==0||pe[1]!==0)&&(Jr=fe.translatePosMatrix(Hr.posMatrix,Yr,pe,Se));var hn=Re?Ur.textCollisionBox:Ur.iconCollisionBox,Cn=Ur.collisionCircleArray;if(Cn.length>0){var Fn=e.create(),Kn=Jr;e.mul(Fn,Ur.placementInvProjMatrix,fe.transform.glCoordMatrix),e.mul(Fn,Fn,Ur.placementViewportMatrix),Jt.push({circleArray:Cn,circleOffset:vr,transform:Kn,invTransform:Fn}),lr+=Cn.length/4,vr=lr}!hn||Et.draw(je,ut.LINES,jr.disabled,Zt.disabled,fe.colorModeForRenderPass(),Tt.disabled,or(Jr,fe.transform,Yr),ve.id,hn.layoutVertexBuffer,hn.indexBuffer,hn.segments,null,fe.transform.zoom,null,null,hn.collisionVertexBuffer)}}if(!(!Re||!Jt.length)){var qn=fe.useProgram("collisionCircle"),Qn=new e.StructArrayLayout2f1f2i16;Qn.resize(lr*4),Qn._trim();for(var ca=0,ba=0,ya=Jt;ba<ya.length;ba+=1)for(var Ta=ya[ba],Ca=0;Ca<Ta.circleArray.length/4;Ca++){var Va=Ca*4,ni=Ta.circleArray[Va+0],Li=Ta.circleArray[Va+1],ui=Ta.circleArray[Va+2],pi=Ta.circleArray[Va+3];Qn.emplace(ca++,ni,Li,ui,pi,0),Qn.emplace(ca++,ni,Li,ui,pi,1),Qn.emplace(ca++,ni,Li,ui,pi,2),Qn.emplace(ca++,ni,Li,ui,pi,3)}(!fs||fs.length<lr*2)&&(fs=Nl(lr));for(var Ba=je.createIndexBuffer(fs,!0),Pi=je.createVertexBuffer(Qn,e.collisionCircleLayout.members,!0),Fi=0,Ui=Jt;Fi<Ui.length;Fi+=1){var _i=Ui[Fi],Ji=Rr(_i.transform,_i.invTransform,fe.transform);qn.draw(je,ut.TRIANGLES,jr.disabled,Zt.disabled,fe.colorModeForRenderPass(),Tt.disabled,Ji,ve.id,Pi,Ba,e.SegmentVector.simpleSegment(0,_i.circleOffset*2,_i.circleArray.length,_i.circleArray.length/2),null,fe.transform.zoom,null,null,null)}Pi.destroy(),Ba.destroy()}}function Nl(fe){var H=fe*2,ve=new e.StructArrayLayout3ui6;ve.resize(H),ve._trim();for(var Z=0;Z<H;Z++){var pe=Z*6;ve.uint16[pe+0]=Z*4+0,ve.uint16[pe+1]=Z*4+1,ve.uint16[pe+2]=Z*4+2,ve.uint16[pe+3]=Z*4+2,ve.uint16[pe+4]=Z*4+3,ve.uint16[pe+5]=Z*4+0}return ve}var gf=e.identity(new Float32Array(16));function Pu(fe,H,ve,Z,pe){if(fe.renderPass==="translucent"){var Se=Zt.disabled,Re=fe.colorModeForRenderPass(),je=ve.layout.get("text-variable-anchor");je&&Du(Z,fe,ve,H,ve.layout.get("text-rotation-alignment"),ve.layout.get("text-pitch-alignment"),pe),ve.paint.get("icon-opacity").constantOr(1)!==0&&Ru(fe,H,ve,Z,!1,ve.paint.get("icon-translate"),ve.paint.get("icon-translate-anchor"),ve.layout.get("icon-rotation-alignment"),ve.layout.get("icon-pitch-alignment"),ve.layout.get("icon-keep-upright"),Se,Re),ve.paint.get("text-opacity").constantOr(1)!==0&&Ru(fe,H,ve,Z,!0,ve.paint.get("text-translate"),ve.paint.get("text-translate-anchor"),ve.layout.get("text-rotation-alignment"),ve.layout.get("text-pitch-alignment"),ve.layout.get("text-keep-upright"),Se,Re),H.map.showCollisionBoxes&&(du(fe,H,ve,Z,ve.paint.get("text-translate"),ve.paint.get("text-translate-anchor"),!0),du(fe,H,ve,Z,ve.paint.get("icon-translate"),ve.paint.get("icon-translate-anchor"),!1))}}function gu(fe,H,ve,Z,pe,Se){var Re=e.getAnchorAlignment(fe),je=Re.horizontalAlign,ut=Re.verticalAlign,Et=-(je-.5)*H,Jt=-(ut-.5)*ve,lr=e.evaluateVariableOffset(fe,Z);return new e.Point((Et/pe+lr[0])*Se,(Jt/pe+lr[1])*Se)}function Du(fe,H,ve,Z,pe,Se,Re){for(var je=H.transform,ut=pe==="map",Et=Se==="map",Jt=0,lr=fe;Jt<lr.length;Jt+=1){var vr=lr[Jt],Cr=Z.getTile(vr),Hr=Cr.getBucket(ve);if(!(!Hr||!Hr.text||!Hr.text.segments.get().length)){var Yr=Hr.textSizeData,Ur=e.evaluateSizeForZoom(Yr,je.zoom),Jr=An(Cr,1,H.transform.zoom),hn=Gr(vr.posMatrix,Et,ut,H.transform,Jr),Cn=ve.layout.get("icon-text-fit")!=="none"&&Hr.hasIconData();if(Ur){var Fn=Math.pow(2,je.zoom-Cr.tileID.overscaledZ);Es(Hr,ut,Et,Re,e.symbolSize,je,hn,vr.posMatrix,Fn,Ur,Cn)}}}}function Es(fe,H,ve,Z,pe,Se,Re,je,ut,Et,Jt){var lr=fe.text.placedSymbolArray,vr=fe.text.dynamicLayoutVertexArray,Cr=fe.icon.dynamicLayoutVertexArray,Hr={};vr.clear();for(var Yr=0;Yr<lr.length;Yr++){var Ur=lr.get(Yr),Jr=fe.allowVerticalPlacement&&!Ur.placedOrientation,hn=!Ur.hidden&&Ur.crossTileID&&!Jr?Z[Ur.crossTileID]:null;if(!hn)Wa(Ur.numGlyphs,vr);else{var Cn=new e.Point(Ur.anchorX,Ur.anchorY),Fn=cn(Cn,ve?je:Re),Kn=Bn(Se.cameraToCenterDistance,Fn.signedDistanceFromCamera),qn=pe.evaluateSizeForFeature(fe.textSizeData,Et,Ur)*Kn/e.ONE_EM;ve&&(qn*=fe.tilePixelRatio/ut);for(var Qn=hn.width,ca=hn.height,ba=hn.anchor,ya=hn.textOffset,Ta=hn.textBoxScale,Ca=gu(ba,Qn,ca,ya,Ta,qn),Va=ve?cn(Cn.add(Ca),Re).point:Fn.point.add(H?Ca.rotate(-Se.angle):Ca),ni=fe.allowVerticalPlacement&&Ur.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Li=0;Li<Ur.numGlyphs;Li++)e.addDynamicAttributes(vr,Va,ni);Jt&&Ur.associatedIconIndex>=0&&(Hr[Ur.associatedIconIndex]={shiftedAnchor:Va,angle:ni})}}if(Jt){Cr.clear();for(var ui=fe.icon.placedSymbolArray,pi=0;pi<ui.length;pi++){var Ba=ui.get(pi);if(Ba.hidden)Wa(Ba.numGlyphs,Cr);else{var Pi=Hr[pi];if(!Pi)Wa(Ba.numGlyphs,Cr);else for(var Fi=0;Fi<Ba.numGlyphs;Fi++)e.addDynamicAttributes(Cr,Pi.shiftedAnchor,Pi.angle)}}fe.icon.dynamicLayoutVertexBuffer.updateData(Cr)}fe.text.dynamicLayoutVertexBuffer.updateData(vr)}function Xu(fe,H,ve){return ve.iconsInText&&H?"symbolTextAndIcon":fe?"symbolSDF":"symbolIcon"}function Ru(fe,H,ve,Z,pe,Se,Re,je,ut,Et,Jt,lr){for(var vr=fe.context,Cr=vr.gl,Hr=fe.transform,Yr=je==="map",Ur=ut==="map",Jr=Yr&&ve.layout.get("symbol-placement")!=="point",hn=Yr&&!Ur&&!Jr,Cn=ve.layout.get("symbol-sort-key").constantOr(1)!==void 0,Fn=fe.depthModeForSublayer(0,jr.ReadOnly),Kn=ve.layout.get("text-variable-anchor"),qn=[],Qn=0,ca=Z;Qn<ca.length;Qn+=1){var ba=ca[Qn],ya=H.getTile(ba),Ta=ya.getBucket(ve);if(!!Ta){var Ca=pe?Ta.text:Ta.icon;if(!(!Ca||!Ca.segments.get().length)){var Va=Ca.programConfigurations.get(ve.id),ni=pe||Ta.sdfIcons,Li=pe?Ta.textSizeData:Ta.iconSizeData,ui=Ur||Hr.pitch!==0,pi=fe.useProgram(Xu(ni,pe,Ta),Va),Ba=e.evaluateSizeForZoom(Li,Hr.zoom),Pi=void 0,Fi=[0,0],Ui=void 0,_i=void 0,Ji=null,ii=void 0;if(pe){if(Ui=ya.glyphAtlasTexture,_i=Cr.LINEAR,Pi=ya.glyphAtlasTexture.size,Ta.iconsInText){Fi=ya.imageAtlasTexture.size,Ji=ya.imageAtlasTexture;var wi=Li.kind==="composite"||Li.kind==="camera";ii=ui||fe.options.rotating||fe.options.zooming||wi?Cr.LINEAR:Cr.NEAREST}}else{var To=ve.layout.get("icon-size").constantOr(0)!==1||Ta.iconsNeedLinear;Ui=ya.imageAtlasTexture,_i=ni||fe.options.rotating||fe.options.zooming||To||ui?Cr.LINEAR:Cr.NEAREST,Pi=ya.imageAtlasTexture.size}var No=An(ya,1,fe.transform.zoom),Sl=Gr(ba.posMatrix,Ur,Yr,fe.transform,No),kl=wn(ba.posMatrix,Ur,Yr,fe.transform,No),$l=Kn&&Ta.hasTextData(),ql=ve.layout.get("icon-text-fit")!=="none"&&$l&&Ta.hasIconData();Jr&&Yn(Ta,ba.posMatrix,fe,pe,Sl,kl,Ur,Et);var _u=fe.translatePosMatrix(ba.posMatrix,ya,Se,Re),eu=Jr||pe&&Kn||ql?gf:Sl,Ns=fe.translatePosMatrix(kl,ya,Se,Re,!0),Hu=ni&&ve.paint.get(pe?"text-halo-width":"icon-halo-width").constantOr(1)!==0,_s=void 0;ni?Ta.iconsInText?_s=Qs(Li.kind,Ba,hn,Ur,fe,_u,eu,Ns,Pi,Fi):_s=Fo(Li.kind,Ba,hn,Ur,fe,_u,eu,Ns,pe,Pi,!0):_s=ks(Li.kind,Ba,hn,Ur,fe,_u,eu,Ns,pe,Pi);var cl={program:pi,buffers:Ca,uniformValues:_s,atlasTexture:Ui,atlasTextureIcon:Ji,atlasInterpolation:_i,atlasInterpolationIcon:ii,isSDF:ni,hasHalo:Hu};if(Cn)for(var tu=Ca.segments.get(),Hl=0,ru=tu;Hl<ru.length;Hl+=1){var Rf=ru[Hl];qn.push({segments:new e.SegmentVector([Rf]),sortKey:Rf.sortKey,state:cl})}else qn.push({segments:Ca.segments,sortKey:0,state:cl})}}}Cn&&qn.sort(function(If,zf){return If.sortKey-zf.sortKey});for(var Zu=0,hs=qn;Zu<hs.length;Zu+=1){var _f=hs[Zu],Cs=_f.state;if(vr.activeTexture.set(Cr.TEXTURE0),Cs.atlasTexture.bind(Cs.atlasInterpolation,Cr.CLAMP_TO_EDGE),Cs.atlasTextureIcon&&(vr.activeTexture.set(Cr.TEXTURE1),Cs.atlasTextureIcon&&Cs.atlasTextureIcon.bind(Cs.atlasInterpolationIcon,Cr.CLAMP_TO_EDGE)),Cs.isSDF){var wf=Cs.uniformValues;Cs.hasHalo&&(wf.u_is_halo=1,Iu(Cs.buffers,_f.segments,ve,fe,Cs.program,Fn,Jt,lr,wf)),wf.u_is_halo=0}Iu(Cs.buffers,_f.segments,ve,fe,Cs.program,Fn,Jt,lr,Cs.uniformValues)}}function Iu(fe,H,ve,Z,pe,Se,Re,je,ut){var Et=Z.context,Jt=Et.gl;pe.draw(Et,Jt.TRIANGLES,Se,Re,je,Tt.disabled,ut,ve.id,fe.layoutVertexBuffer,fe.indexBuffer,H,ve.paint,Z.transform.zoom,fe.programConfigurations.get(ve.id),fe.dynamicLayoutVertexBuffer,fe.opacityVertexBuffer)}function Oo(fe,H,ve,Z){if(fe.renderPass==="translucent"){var pe=ve.paint.get("circle-opacity"),Se=ve.paint.get("circle-stroke-width"),Re=ve.paint.get("circle-stroke-opacity"),je=ve.layout.get("circle-sort-key").constantOr(1)!==void 0;if(!(pe.constantOr(1)===0&&(Se.constantOr(1)===0||Re.constantOr(1)===0))){for(var ut=fe.context,Et=ut.gl,Jt=fe.depthModeForSublayer(0,jr.ReadOnly),lr=Zt.disabled,vr=fe.colorModeForRenderPass(),Cr=[],Hr=0;Hr<Z.length;Hr++){var Yr=Z[Hr],Ur=H.getTile(Yr),Jr=Ur.getBucket(ve);if(!!Jr){var hn=Jr.programConfigurations.get(ve.id),Cn=fe.useProgram("circle",hn),Fn=Jr.layoutVertexBuffer,Kn=Jr.indexBuffer,qn=yt(fe,Yr,Ur,ve),Qn={programConfiguration:hn,program:Cn,layoutVertexBuffer:Fn,indexBuffer:Kn,uniformValues:qn};if(je)for(var ca=Jr.segments.get(),ba=0,ya=ca;ba<ya.length;ba+=1){var Ta=ya[ba];Cr.push({segments:new e.SegmentVector([Ta]),sortKey:Ta.sortKey,state:Qn})}else Cr.push({segments:Jr.segments,sortKey:0,state:Qn})}}je&&Cr.sort(function(_i,Ji){return _i.sortKey-Ji.sortKey});for(var Ca=0,Va=Cr;Ca<Va.length;Ca+=1){var ni=Va[Ca],Li=ni.state,ui=Li.programConfiguration,pi=Li.program,Ba=Li.layoutVertexBuffer,Pi=Li.indexBuffer,Fi=Li.uniformValues,Ui=ni.segments;pi.draw(ut,Et.TRIANGLES,Jt,lr,vr,Tt.disabled,Fi,ve.id,Ba,Pi,Ui,ve.paint,fe.transform.zoom,ui)}}}}function zu(fe,H,ve,Z){if(ve.paint.get("heatmap-opacity")!==0)if(fe.renderPass==="offscreen"){var pe=fe.context,Se=pe.gl,Re=Zt.disabled,je=new Je([Se.ONE,Se.ONE],e.Color.transparent,[!0,!0,!0,!0]);tf(pe,fe,ve),pe.clear({color:e.Color.transparent});for(var ut=0;ut<Z.length;ut++){var Et=Z[ut];if(!H.hasRenderableParent(Et)){var Jt=H.getTile(Et),lr=Jt.getBucket(ve);if(!!lr){var vr=lr.programConfigurations.get(ve.id),Cr=fe.useProgram("heatmap",vr),Hr=fe.transform,Yr=Hr.zoom;Cr.draw(pe,Se.TRIANGLES,jr.disabled,Re,je,Tt.disabled,zn(Et.posMatrix,Jt,Yr,ve.paint.get("heatmap-intensity")),ve.id,lr.layoutVertexBuffer,lr.indexBuffer,lr.segments,ve.paint,fe.transform.zoom,vr)}}}pe.viewport.set([0,0,fe.width,fe.height])}else fe.renderPass==="translucent"&&(fe.context.setColorMode(fe.colorModeForRenderPass()),yu(fe,ve))}function tf(fe,H,ve){var Z=fe.gl;fe.activeTexture.set(Z.TEXTURE1),fe.viewport.set([0,0,H.width/4,H.height/4]);var pe=ve.heatmapFbo;if(pe)Z.bindTexture(Z.TEXTURE_2D,pe.colorAttachment.get()),fe.bindFramebuffer.set(pe.framebuffer);else{var Se=Z.createTexture();Z.bindTexture(Z.TEXTURE_2D,Se),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_S,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_T,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MAG_FILTER,Z.LINEAR),pe=ve.heatmapFbo=fe.createFramebuffer(H.width/4,H.height/4,!1),xs(fe,H,Se,pe)}}function xs(fe,H,ve,Z){var pe=fe.gl,Se=fe.extRenderToTextureHalfFloat?fe.extTextureHalfFloat.HALF_FLOAT_OES:pe.UNSIGNED_BYTE;pe.texImage2D(pe.TEXTURE_2D,0,pe.RGBA,H.width/4,H.height/4,0,pe.RGBA,Se,null),Z.colorAttachment.set(ve)}function yu(fe,H){var ve=fe.context,Z=ve.gl,pe=H.heatmapFbo;if(!!pe){ve.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,pe.colorAttachment.get()),ve.activeTexture.set(Z.TEXTURE1);var Se=H.colorRampTexture;Se||(Se=H.colorRampTexture=new e.Texture(ve,H.colorRamp,Z.RGBA)),Se.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),fe.useProgram("heatmapTexture").draw(ve,Z.TRIANGLES,jr.disabled,Zt.disabled,fe.colorModeForRenderPass(),Tt.disabled,Pn(fe,H,0,1),H.id,fe.viewportBuffer,fe.quadTriangleIndexBuffer,fe.viewportSegments,H.paint,fe.transform.zoom)}}function mu(fe,H,ve,Z){if(fe.renderPass==="translucent"){var pe=ve.paint.get("line-opacity"),Se=ve.paint.get("line-width");if(!(pe.constantOr(1)===0||Se.constantOr(1)===0)){var Re=fe.depthModeForSublayer(0,jr.ReadOnly),je=fe.colorModeForRenderPass(),ut=ve.paint.get("line-dasharray"),Et=ve.paint.get("line-pattern"),Jt=Et.constantOr(1),lr=ve.paint.get("line-gradient"),vr=ve.getCrossfadeParameters(),Cr=Jt?"linePattern":ut?"lineSDF":lr?"lineGradient":"line",Hr=fe.context,Yr=Hr.gl,Ur=!0;if(lr){Hr.activeTexture.set(Yr.TEXTURE0);var Jr=ve.gradientTexture;if(!ve.gradient)return;Jr||(Jr=ve.gradientTexture=new e.Texture(Hr,ve.gradient,Yr.RGBA)),Jr.bind(Yr.LINEAR,Yr.CLAMP_TO_EDGE)}for(var hn=0,Cn=Z;hn<Cn.length;hn+=1){var Fn=Cn[hn],Kn=H.getTile(Fn);if(!(Jt&&!Kn.patternsLoaded())){var qn=Kn.getBucket(ve);if(!!qn){var Qn=qn.programConfigurations.get(ve.id),ca=fe.context.program.get(),ba=fe.useProgram(Cr,Qn),ya=Ur||ba.program!==ca,Ta=Et.constantOr(null);if(Ta&&Kn.imageAtlas){var Ca=Kn.imageAtlas,Va=Ca.patternPositions[Ta.to.toString()],ni=Ca.patternPositions[Ta.from.toString()];Va&&ni&&Qn.setConstantPatternPositions(Va,ni)}var Li=Jt?gi(fe,Kn,ve,vr):ut?mi(fe,Kn,ve,ut,vr):lr?di(fe,Kn,ve):Qa(fe,Kn,ve);Jt?(Hr.activeTexture.set(Yr.TEXTURE0),Kn.imageAtlasTexture.bind(Yr.LINEAR,Yr.CLAMP_TO_EDGE),Qn.updatePaintBuffers(vr)):ut&&(ya||fe.lineAtlas.dirty)&&(Hr.activeTexture.set(Yr.TEXTURE0),fe.lineAtlas.bind(Hr)),ba.draw(Hr,Yr.TRIANGLES,Re,fe.stencilModeForClipping(Fn),je,Tt.disabled,Li,ve.id,qn.layoutVertexBuffer,qn.indexBuffer,qn.segments,ve.paint,fe.transform.zoom,Qn),Ur=!1}}}}}}function Fu(fe,H,ve,Z){var pe=ve.paint.get("fill-color"),Se=ve.paint.get("fill-opacity");if(Se.constantOr(1)!==0){var Re=fe.colorModeForRenderPass(),je=ve.paint.get("fill-pattern"),ut=fe.opaquePassEnabledForLayer()&&!je.constantOr(1)&&pe.constantOr(e.Color.transparent).a===1&&Se.constantOr(0)===1?"opaque":"translucent";if(fe.renderPass===ut){var Et=fe.depthModeForSublayer(1,fe.renderPass==="opaque"?jr.ReadWrite:jr.ReadOnly);ze(fe,H,ve,Z,Et,Re,!1)}if(fe.renderPass==="translucent"&&ve.paint.get("fill-antialias")){var Jt=fe.depthModeForSublayer(ve.getPaintProperty("fill-outline-color")?2:0,jr.ReadOnly);ze(fe,H,ve,Z,Jt,Re,!0)}}}function ze(fe,H,ve,Z,pe,Se,Re){var je=fe.context.gl,ut=ve.paint.get("fill-pattern"),Et=ut&&ut.constantOr(1),Jt=ve.getCrossfadeParameters(),lr,vr,Cr,Hr,Yr;Re?(vr=Et&&!ve.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",lr=je.LINES):(vr=Et?"fillPattern":"fill",lr=je.TRIANGLES);for(var Ur=0,Jr=Z;Ur<Jr.length;Ur+=1){var hn=Jr[Ur],Cn=H.getTile(hn);if(!(Et&&!Cn.patternsLoaded())){var Fn=Cn.getBucket(ve);if(!!Fn){var Kn=Fn.programConfigurations.get(ve.id),qn=fe.useProgram(vr,Kn);Et&&(fe.context.activeTexture.set(je.TEXTURE0),Cn.imageAtlasTexture.bind(je.LINEAR,je.CLAMP_TO_EDGE),Kn.updatePaintBuffers(Jt));var Qn=ut.constantOr(null);if(Qn&&Cn.imageAtlas){var ca=Cn.imageAtlas,ba=ca.patternPositions[Qn.to.toString()],ya=ca.patternPositions[Qn.from.toString()];ba&&ya&&Kn.setConstantPatternPositions(ba,ya)}var Ta=fe.translatePosMatrix(hn.posMatrix,Cn,ve.paint.get("fill-translate"),ve.paint.get("fill-translate-anchor"));if(!Re)Hr=Fn.indexBuffer,Yr=Fn.segments,Cr=Et?ss(Ta,fe,Jt,Cn):Co(Ta);else{Hr=Fn.indexBuffer2,Yr=Fn.segments2;var Ca=[je.drawingBufferWidth,je.drawingBufferHeight];Cr=vr==="fillOutlinePattern"&&Et?Ol(Ta,fe,Jt,Cn,Ca):vu(Ta,Ca)}qn.draw(fe.context,lr,pe,fe.stencilModeForClipping(hn),Se,Tt.disabled,Cr,ve.id,Fn.layoutVertexBuffer,Hr,Yr,ve.paint,fe.transform.zoom,Kn)}}}}function We(fe,H,ve,Z){var pe=ve.paint.get("fill-extrusion-opacity");if(pe!==0&&fe.renderPass==="translucent"){var Se=new jr(fe.context.gl.LEQUAL,jr.ReadWrite,fe.depthRangeFor3D);if(pe===1&&!ve.paint.get("fill-extrusion-pattern").constantOr(1)){var Re=fe.colorModeForRenderPass();et(fe,H,ve,Z,Se,Zt.disabled,Re)}else et(fe,H,ve,Z,Se,Zt.disabled,Je.disabled),et(fe,H,ve,Z,Se,fe.stencilModeFor3D(),fe.colorModeForRenderPass())}}function et(fe,H,ve,Z,pe,Se,Re){for(var je=fe.context,ut=je.gl,Et=ve.paint.get("fill-extrusion-pattern"),Jt=Et.constantOr(1),lr=ve.getCrossfadeParameters(),vr=ve.paint.get("fill-extrusion-opacity"),Cr=0,Hr=Z;Cr<Hr.length;Cr+=1){var Yr=Hr[Cr],Ur=H.getTile(Yr),Jr=Ur.getBucket(ve);if(!!Jr){var hn=Jr.programConfigurations.get(ve.id),Cn=fe.useProgram(Jt?"fillExtrusionPattern":"fillExtrusion",hn);Jt&&(fe.context.activeTexture.set(ut.TEXTURE0),Ur.imageAtlasTexture.bind(ut.LINEAR,ut.CLAMP_TO_EDGE),hn.updatePaintBuffers(lr));var Fn=Et.constantOr(null);if(Fn&&Ur.imageAtlas){var Kn=Ur.imageAtlas,qn=Kn.patternPositions[Fn.to.toString()],Qn=Kn.patternPositions[Fn.from.toString()];qn&&Qn&&hn.setConstantPatternPositions(qn,Qn)}var ca=fe.translatePosMatrix(Yr.posMatrix,Ur,ve.paint.get("fill-extrusion-translate"),ve.paint.get("fill-extrusion-translate-anchor")),ba=ve.paint.get("fill-extrusion-vertical-gradient"),ya=Jt?Fs(ca,fe,ba,vr,Yr,lr,Ur):is(ca,fe,ba,vr);Cn.draw(je,je.gl.TRIANGLES,pe,Se,Re,Tt.backCCW,ya,ve.id,Jr.layoutVertexBuffer,Jr.indexBuffer,Jr.segments,ve.paint,fe.transform.zoom,hn)}}}function ot(fe,H,ve,Z){if(!(fe.renderPass!=="offscreen"&&fe.renderPass!=="translucent")){for(var pe=fe.context,Se=H.getSource().maxzoom,Re=fe.depthModeForSublayer(0,jr.ReadOnly),je=fe.colorModeForRenderPass(),ut=fe.renderPass==="translucent"?fe.stencilConfigForOverlap(Z):[{},Z],Et=ut[0],Jt=ut[1],lr=0,vr=Jt;lr<vr.length;lr+=1){var Cr=vr[lr],Hr=H.getTile(Cr);Hr.needsHillshadePrepare&&fe.renderPass==="offscreen"?mt(fe,Hr,ve,Se,Re,Zt.disabled,je):fe.renderPass==="translucent"&&bt(fe,Hr,ve,Re,Et[Cr.overscaledZ],je)}pe.viewport.set([0,0,fe.width,fe.height])}}function bt(fe,H,ve,Z,pe,Se){var Re=fe.context,je=Re.gl,ut=H.fbo;if(!!ut){var Et=fe.useProgram("hillshade");Re.activeTexture.set(je.TEXTURE0),je.bindTexture(je.TEXTURE_2D,ut.colorAttachment.get());var Jt=za(fe,H,ve);Et.draw(Re,je.TRIANGLES,Z,pe,Se,Tt.disabled,Jt,ve.id,fe.rasterBoundsBuffer,fe.quadTriangleIndexBuffer,fe.rasterBoundsSegments)}}function mt(fe,H,ve,Z,pe,Se,Re){var je=fe.context,ut=je.gl,Et=H.dem;if(Et&&Et.data){var Jt=Et.dim,lr=Et.stride,vr=Et.getPixels();if(je.activeTexture.set(ut.TEXTURE1),je.pixelStoreUnpackPremultiplyAlpha.set(!1),H.demTexture=H.demTexture||fe.getTileTexture(lr),H.demTexture){var Cr=H.demTexture;Cr.update(vr,{premultiply:!1}),Cr.bind(ut.NEAREST,ut.CLAMP_TO_EDGE)}else H.demTexture=new e.Texture(je,vr,ut.RGBA,{premultiply:!1}),H.demTexture.bind(ut.NEAREST,ut.CLAMP_TO_EDGE);je.activeTexture.set(ut.TEXTURE0);var Hr=H.fbo;if(!Hr){var Yr=new e.Texture(je,{width:Jt,height:Jt,data:null},ut.RGBA);Yr.bind(ut.LINEAR,ut.CLAMP_TO_EDGE),Hr=H.fbo=je.createFramebuffer(Jt,Jt,!0),Hr.colorAttachment.set(Yr.texture)}je.bindFramebuffer.set(Hr.framebuffer),je.viewport.set([0,0,Jt,Jt]),fe.useProgram("hillshadePrepare").draw(je,ut.TRIANGLES,pe,Se,Re,Tt.disabled,Ea(H.tileID,Et,Z),ve.id,fe.rasterBoundsBuffer,fe.quadTriangleIndexBuffer,fe.rasterBoundsSegments),H.needsHillshadePrepare=!1}}function kt(fe,H,ve,Z){if(fe.renderPass==="translucent"&&ve.paint.get("raster-opacity")!==0&&!!Z.length)for(var pe=fe.context,Se=pe.gl,Re=H.getSource(),je=fe.useProgram("raster"),ut=fe.colorModeForRenderPass(),Et=Re instanceof re?[{},Z]:fe.stencilConfigForOverlap(Z),Jt=Et[0],lr=Et[1],vr=lr[lr.length-1].overscaledZ,Cr=!fe.options.moving,Hr=0,Yr=lr;Hr<Yr.length;Hr+=1){var Ur=Yr[Hr],Jr=fe.depthModeForSublayer(Ur.overscaledZ-vr,ve.paint.get("raster-opacity")===1?jr.ReadWrite:jr.ReadOnly,Se.LESS),hn=H.getTile(Ur),Cn=fe.transform.calculatePosMatrix(Ur.toUnwrapped(),Cr);hn.registerFadeDuration(ve.paint.get("raster-fade-duration"));var Fn=H.findLoadedParent(Ur,0),Kn=fr(hn,Fn,H,ve,fe.transform),qn=void 0,Qn=void 0,ca=ve.paint.get("raster-resampling")==="nearest"?Se.NEAREST:Se.LINEAR;pe.activeTexture.set(Se.TEXTURE0),hn.texture.bind(ca,Se.CLAMP_TO_EDGE,Se.LINEAR_MIPMAP_NEAREST),pe.activeTexture.set(Se.TEXTURE1),Fn?(Fn.texture.bind(ca,Se.CLAMP_TO_EDGE,Se.LINEAR_MIPMAP_NEAREST),qn=Math.pow(2,Fn.tileID.overscaledZ-hn.tileID.overscaledZ),Qn=[hn.tileID.canonical.x*qn%1,hn.tileID.canonical.y*qn%1]):hn.texture.bind(ca,Se.CLAMP_TO_EDGE,Se.LINEAR_MIPMAP_NEAREST);var ba=to(Cn,Qn||[0,0],qn||1,Kn,ve);Re instanceof re?je.draw(pe,Se.TRIANGLES,Jr,Zt.disabled,ut,Tt.disabled,ba,ve.id,Re.boundsBuffer,fe.quadTriangleIndexBuffer,Re.boundsSegments):je.draw(pe,Se.TRIANGLES,Jr,Jt[Ur.overscaledZ],ut,Tt.disabled,ba,ve.id,fe.rasterBoundsBuffer,fe.quadTriangleIndexBuffer,fe.rasterBoundsSegments)}}function fr(fe,H,ve,Z,pe){var Se=Z.paint.get("raster-fade-duration");if(Se>0){var Re=e.browser.now(),je=(Re-fe.timeAdded)/Se,ut=H?(Re-H.timeAdded)/Se:-1,Et=ve.getSource(),Jt=pe.coveringZoomLevel({tileSize:Et.tileSize,roundZoom:Et.roundZoom}),lr=!H||Math.abs(H.tileID.overscaledZ-Jt)>Math.abs(fe.tileID.overscaledZ-Jt),vr=lr&&fe.refreshedUponExpiration?1:e.clamp(lr?je:1-ut,0,1);return fe.refreshedUponExpiration&&je>=1&&(fe.refreshedUponExpiration=!1),H?{opacity:1,mix:1-vr}:{opacity:vr,mix:0}}else return{opacity:1,mix:0}}function pr(fe,H,ve){var Z=ve.paint.get("background-color"),pe=ve.paint.get("background-opacity");if(pe!==0){var Se=fe.context,Re=Se.gl,je=fe.transform,ut=je.tileSize,Et=ve.paint.get("background-pattern");if(!fe.isPatternMissing(Et)){var Jt=!Et&&Z.a===1&&pe===1&&fe.opaquePassEnabledForLayer()?"opaque":"translucent";if(fe.renderPass===Jt){var lr=Zt.disabled,vr=fe.depthModeForSublayer(0,Jt==="opaque"?jr.ReadWrite:jr.ReadOnly),Cr=fe.colorModeForRenderPass(),Hr=fe.useProgram(Et?"backgroundPattern":"background"),Yr=je.coveringTiles({tileSize:ut});Et&&(Se.activeTexture.set(Re.TEXTURE0),fe.imageManager.bind(fe.context));for(var Ur=ve.getCrossfadeParameters(),Jr=0,hn=Yr;Jr<hn.length;Jr+=1){var Cn=hn[Jr],Fn=fe.transform.calculatePosMatrix(Cn.toUnwrapped()),Kn=Et?Bl(Fn,pe,fe,Et,{tileID:Cn,tileSize:ut},Ur):bo(Fn,pe,Z);Hr.draw(Se,Re.TRIANGLES,vr,lr,Cr,Tt.disabled,Kn,ve.id,fe.tileExtentBuffer,fe.quadTriangleIndexBuffer,fe.tileExtentSegments)}}}}}var sr=new e.Color(1,0,0,1),xr=new e.Color(0,1,0,1),Dr=new e.Color(0,0,1,1),Xr=new e.Color(1,0,1,1),qr=new e.Color(0,1,1,1);function bn(fe){var H=fe.transform.padding,ve=3;Wn(fe,fe.transform.height-(H.top||0),ve,sr),Wn(fe,H.bottom||0,ve,xr),ga(fe,H.left||0,ve,Dr),ga(fe,fe.transform.width-(H.right||0),ve,Xr);var Z=fe.transform.centerPoint;Dn(fe,Z.x,fe.transform.height-Z.y,qr)}function Dn(fe,H,ve,Z){var pe=20,Se=2;xa(fe,H-Se/2,ve-pe/2,Se,pe,Z),xa(fe,H-pe/2,ve-Se/2,pe,Se,Z)}function Wn(fe,H,ve,Z){xa(fe,0,H+ve/2,fe.transform.width,ve,Z)}function ga(fe,H,ve,Z){xa(fe,H-ve/2,0,ve,fe.transform.height,Z)}function xa(fe,H,ve,Z,pe,Se){var Re=fe.context,je=Re.gl;je.enable(je.SCISSOR_TEST),je.scissor(H*e.browser.devicePixelRatio,ve*e.browser.devicePixelRatio,Z*e.browser.devicePixelRatio,pe*e.browser.devicePixelRatio),Re.clear({color:Se}),je.disable(je.SCISSOR_TEST)}function Ka(fe,H,ve){for(var Z=0;Z<ve.length;Z++)Ya(fe,H,ve[Z])}function Ya(fe,H,ve){var Z=fe.context,pe=Z.gl,Se=ve.posMatrix,Re=fe.useProgram("debug"),je=jr.disabled,ut=Zt.disabled,Et=fe.colorModeForRenderPass(),Jt="$debug";Z.activeTexture.set(pe.TEXTURE0),fe.emptyTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE),Re.draw(Z,pe.LINE_STRIP,je,ut,Et,Tt.disabled,dn(Se,e.Color.red),Jt,fe.debugBuffer,fe.tileBorderIndexBuffer,fe.debugSegments);var lr=H.getTileByID(ve.key).latestRawTileData,vr=lr&&lr.byteLength||0,Cr=Math.floor(vr/1024),Hr=H.getTile(ve).tileSize,Yr=512/Math.min(Hr,512)*(ve.overscaledZ/fe.transform.zoom)*.5,Ur=ve.canonical.toString();ve.overscaledZ!==ve.canonical.z&&(Ur+=" => "+ve.overscaledZ);var Jr=Ur+" "+Cr+"kb";ei(fe,Jr),Re.draw(Z,pe.TRIANGLES,je,ut,Je.alphaBlended,Tt.disabled,dn(Se,e.Color.transparent,Yr),Jt,fe.debugBuffer,fe.quadTriangleIndexBuffer,fe.debugSegments)}function ei(fe,H){fe.initDebugOverlayCanvas();var ve=fe.debugOverlayCanvas,Z=fe.context.gl,pe=fe.debugOverlayCanvas.getContext("2d");pe.clearRect(0,0,ve.width,ve.height),pe.shadowColor="white",pe.shadowBlur=2,pe.lineWidth=1.5,pe.strokeStyle="white",pe.textBaseline="top",pe.font="bold "+36+"px Open Sans, sans-serif",pe.fillText(H,5,5),pe.strokeText(H,5,5),fe.debugOverlayTexture.update(ve),fe.debugOverlayTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE)}function hi(fe,H,ve){var Z=fe.context,pe=ve.implementation;if(fe.renderPass==="offscreen"){var Se=pe.prerender;Se&&(fe.setCustomLayerDefaults(),Z.setColorMode(fe.colorModeForRenderPass()),Se.call(pe,Z.gl,fe.transform.customLayerMatrix()),Z.setDirty(),fe.setBaseState())}else if(fe.renderPass==="translucent"){fe.setCustomLayerDefaults(),Z.setColorMode(fe.colorModeForRenderPass()),Z.setStencilMode(Zt.disabled);var Re=pe.renderingMode==="3d"?new jr(fe.context.gl.LEQUAL,jr.ReadWrite,fe.depthRangeFor3D):fe.depthModeForSublayer(0,jr.ReadOnly);Z.setDepthMode(Re),pe.render(Z.gl,fe.transform.customLayerMatrix()),Z.setDirty(),fe.setBaseState(),Z.bindFramebuffer.set(null)}}var oo={symbol:Pu,circle:Oo,heatmap:zu,line:mu,fill:Fu,"fill-extrusion":We,hillshade:ot,raster:kt,background:pr,debug:Ka,custom:hi},ri=function(H,ve){this.context=new Bt(H),this.transform=ve,this._tileTextures={},this.setup(),this.numSublayers=Ce.maxUnderzooming+Ce.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ma,this.gpuTimers={}};ri.prototype.resize=function(H,ve){if(this.width=H*e.browser.devicePixelRatio,this.height=ve*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var Z=0,pe=this.style._order;Z<pe.length;Z+=1){var Se=pe[Z];this.style._layers[Se].resize()}},ri.prototype.setup=function(){var H=this.context,ve=new e.StructArrayLayout2i4;ve.emplaceBack(0,0),ve.emplaceBack(e.EXTENT,0),ve.emplaceBack(0,e.EXTENT),ve.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=H.createVertexBuffer(ve,nl.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Z=new e.StructArrayLayout2i4;Z.emplaceBack(0,0),Z.emplaceBack(e.EXTENT,0),Z.emplaceBack(0,e.EXTENT),Z.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=H.createVertexBuffer(Z,nl.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var pe=new e.StructArrayLayout4i8;pe.emplaceBack(0,0,0,0),pe.emplaceBack(e.EXTENT,0,e.EXTENT,0),pe.emplaceBack(0,e.EXTENT,0,e.EXTENT),pe.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=H.createVertexBuffer(pe,Y.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Se=new e.StructArrayLayout2i4;Se.emplaceBack(0,0),Se.emplaceBack(1,0),Se.emplaceBack(0,1),Se.emplaceBack(1,1),this.viewportBuffer=H.createVertexBuffer(Se,nl.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Re=new e.StructArrayLayout1ui2;Re.emplaceBack(0),Re.emplaceBack(1),Re.emplaceBack(3),Re.emplaceBack(2),Re.emplaceBack(0),this.tileBorderIndexBuffer=H.createIndexBuffer(Re);var je=new e.StructArrayLayout3ui6;je.emplaceBack(0,1,2),je.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=H.createIndexBuffer(je),this.emptyTexture=new e.Texture(H,{width:1,height:1,data:new Uint8Array([0,0,0,0])},H.gl.RGBA);var ut=this.context.gl;this.stencilClearMode=new Zt({func:ut.ALWAYS,mask:0},0,255,ut.ZERO,ut.ZERO,ut.ZERO)},ri.prototype.clearStencil=function(){var H=this.context,ve=H.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var Z=e.create();e.ortho(Z,0,this.width,this.height,0,0,1),e.scale(Z,Z,[ve.drawingBufferWidth,ve.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(H,ve.TRIANGLES,jr.disabled,this.stencilClearMode,Je.disabled,Tt.disabled,Ln(Z),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},ri.prototype._renderTileClippingMasks=function(H,ve){if(!(this.currentStencilSource===H.source||!H.isTileClipped()||!ve||!ve.length)){this.currentStencilSource=H.source;var Z=this.context,pe=Z.gl;this.nextStencilID+ve.length>256&&this.clearStencil(),Z.setColorMode(Je.disabled),Z.setDepthMode(jr.disabled);var Se=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var Re=0,je=ve;Re<je.length;Re+=1){var ut=je[Re],Et=this._tileClippingMaskIDs[ut.key]=this.nextStencilID++;Se.draw(Z,pe.TRIANGLES,jr.disabled,new Zt({func:pe.ALWAYS,mask:0},Et,255,pe.KEEP,pe.KEEP,pe.REPLACE),Je.disabled,Tt.disabled,Ln(ut.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},ri.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var H=this.nextStencilID++,ve=this.context.gl;return new Zt({func:ve.NOTEQUAL,mask:255},H,255,ve.KEEP,ve.KEEP,ve.REPLACE)},ri.prototype.stencilModeForClipping=function(H){var ve=this.context.gl;return new Zt({func:ve.EQUAL,mask:255},this._tileClippingMaskIDs[H.key],0,ve.KEEP,ve.KEEP,ve.REPLACE)},ri.prototype.stencilConfigForOverlap=function(H){var ve,Z=this.context.gl,pe=H.sort(function(Et,Jt){return Jt.overscaledZ-Et.overscaledZ}),Se=pe[pe.length-1].overscaledZ,Re=pe[0].overscaledZ-Se+1;if(Re>1){this.currentStencilSource=void 0,this.nextStencilID+Re>256&&this.clearStencil();for(var je={},ut=0;ut<Re;ut++)je[ut+Se]=new Zt({func:Z.GEQUAL,mask:255},ut+this.nextStencilID,255,Z.KEEP,Z.KEEP,Z.REPLACE);return this.nextStencilID+=Re,[je,pe]}return[(ve={},ve[Se]=Zt.disabled,ve),pe]},ri.prototype.colorModeForRenderPass=function(){var H=this.context.gl;if(this._showOverdrawInspector){var ve=8,Z=1/ve;return new Je([H.CONSTANT_COLOR,H.ONE],new e.Color(Z,Z,Z,0),[!0,!0,!0,!0])}else return this.renderPass==="opaque"?Je.unblended:Je.alphaBlended},ri.prototype.depthModeForSublayer=function(H,ve,Z){if(!this.opaquePassEnabledForLayer())return jr.disabled;var pe=1-((1+this.currentLayer)*this.numSublayers+H)*this.depthEpsilon;return new jr(Z||this.context.gl.LEQUAL,ve,[pe,pe])},ri.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},ri.prototype.render=function(H,ve){var Z=this;this.style=H,this.options=ve,this.lineAtlas=H.lineAtlas,this.imageManager=H.imageManager,this.glyphManager=H.glyphManager,this.symbolFadeChange=H.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var pe=this.style._order,Se=this.style.sourceCaches;for(var Re in Se){var je=Se[Re];je.used&&je.prepare(this.context)}var ut={},Et={},Jt={};for(var lr in Se){var vr=Se[lr];ut[lr]=vr.getVisibleCoordinates(),Et[lr]=ut[lr].slice().reverse(),Jt[lr]=vr.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Cr=0;Cr<pe.length;Cr++){var Hr=pe[Cr];if(this.style._layers[Hr].is3D()){this.opaquePassCutoff=Cr;break}}this.renderPass="offscreen";for(var Yr=0,Ur=pe;Yr<Ur.length;Yr+=1){var Jr=Ur[Yr],hn=this.style._layers[Jr];if(!(!hn.hasOffscreenPass()||hn.isHidden(this.transform.zoom))){var Cn=Et[hn.source];hn.type!=="custom"&&!Cn.length||this.renderLayer(this,Se[hn.source],hn,Cn)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:ve.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=ve.showOverdrawInspector,this.depthRangeFor3D=[0,1-(H._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=pe.length-1;this.currentLayer>=0;this.currentLayer--){var Fn=this.style._layers[pe[this.currentLayer]],Kn=Se[Fn.source],qn=ut[Fn.source];this._renderTileClippingMasks(Fn,qn),this.renderLayer(this,Kn,Fn,qn)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<pe.length;this.currentLayer++){var Qn=this.style._layers[pe[this.currentLayer]],ca=Se[Qn.source],ba=(Qn.type==="symbol"?Jt:Et)[Qn.source];this._renderTileClippingMasks(Qn,ut[Qn.source]),this.renderLayer(this,ca,Qn,ba)}if(this.options.showTileBoundaries){var ya,Ta,Ca=e.values(this.style._layers);Ca.forEach(function(Va){Va.source&&!Va.isHidden(Z.transform.zoom)&&(Va.source!==(Ta&&Ta.id)&&(Ta=Z.style.sourceCaches[Va.source]),(!ya||ya.getSource().maxzoom<Ta.getSource().maxzoom)&&(ya=Ta))}),ya&&oo.debug(this,ya,ya.getVisibleCoordinates())}this.options.showPadding&&bn(this),this.context.setDefault()},ri.prototype.renderLayer=function(H,ve,Z,pe){Z.isHidden(this.transform.zoom)||Z.type!=="background"&&Z.type!=="custom"&&!pe.length||(this.id=Z.id,this.gpuTimingStart(Z),oo[Z.type](H,ve,Z,pe,this.style.placement.variableOffsets),this.gpuTimingEnd())},ri.prototype.gpuTimingStart=function(H){if(!!this.options.gpuTiming){var ve=this.context.extTimerQuery,Z=this.gpuTimers[H.id];Z||(Z=this.gpuTimers[H.id]={calls:0,cpuTime:0,query:ve.createQueryEXT()}),Z.calls++,ve.beginQueryEXT(ve.TIME_ELAPSED_EXT,Z.query)}},ri.prototype.gpuTimingEnd=function(){if(!!this.options.gpuTiming){var H=this.context.extTimerQuery;H.endQueryEXT(H.TIME_ELAPSED_EXT)}},ri.prototype.collectGpuTimers=function(){var H=this.gpuTimers;return this.gpuTimers={},H},ri.prototype.queryGpuTimers=function(H){var ve={};for(var Z in H){var pe=H[Z],Se=this.context.extTimerQuery,Re=Se.getQueryObjectEXT(pe.query,Se.QUERY_RESULT_EXT)/(1e3*1e3);Se.deleteQueryEXT(pe.query),ve[Z]=Re}return ve},ri.prototype.translatePosMatrix=function(H,ve,Z,pe,Se){if(!Z[0]&&!Z[1])return H;var Re=Se?pe==="map"?this.transform.angle:0:pe==="viewport"?-this.transform.angle:0;if(Re){var je=Math.sin(Re),ut=Math.cos(Re);Z=[Z[0]*ut-Z[1]*je,Z[0]*je+Z[1]*ut]}var Et=[Se?Z[0]:An(ve,Z[0],this.transform.zoom),Se?Z[1]:An(ve,Z[1],this.transform.zoom),0],Jt=new Float32Array(16);return e.translate(Jt,H,Et),Jt},ri.prototype.saveTileTexture=function(H){var ve=this._tileTextures[H.size[0]];ve?ve.push(H):this._tileTextures[H.size[0]]=[H]},ri.prototype.getTileTexture=function(H){var ve=this._tileTextures[H];return ve&&ve.length>0?ve.pop():null},ri.prototype.isPatternMissing=function(H){if(!H)return!1;if(!H.from||!H.to)return!0;var ve=this.imageManager.getPattern(H.from.toString()),Z=this.imageManager.getPattern(H.to.toString());return!ve||!Z},ri.prototype.useProgram=function(H,ve){this.cache=this.cache||{};var Z=""+H+(ve?ve.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[Z]||(this.cache[Z]=new $o(this.context,fl[H],ve,Ql[H],this._showOverdrawInspector)),this.cache[Z]},ri.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},ri.prototype.setBaseState=function(){var H=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(H.FUNC_ADD)},ri.prototype.initDebugOverlayCanvas=function(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var H=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,H.RGBA)}},ri.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Yi=function(H,ve){this.points=H,this.planes=ve};Yi.fromInvProjectionMatrix=function(H,ve,Z){var pe=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]],Se=Math.pow(2,Z),Re=pe.map(function(Et){return e.transformMat4([],Et,H)}).map(function(Et){return e.scale$1([],Et,1/Et[3]/ve*Se)}),je=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],ut=je.map(function(Et){var Jt=e.sub([],Re[Et[0]],Re[Et[1]]),lr=e.sub([],Re[Et[2]],Re[Et[1]]),vr=e.normalize([],e.cross([],Jt,lr)),Cr=-e.dot(vr,Re[Et[1]]);return vr.concat(Cr)});return new Yi(Re,ut)};var co=function(H,ve){this.min=H,this.max=ve,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};co.prototype.quadrant=function(H){for(var ve=[H%2===0,H<2],Z=e.clone$2(this.min),pe=e.clone$2(this.max),Se=0;Se<ve.length;Se++)Z[Se]=ve[Se]?this.min[Se]:this.center[Se],pe[Se]=ve[Se]?this.center[Se]:this.max[Se];return pe[2]=this.max[2],new co(Z,pe)},co.prototype.distanceX=function(H){var ve=Math.max(Math.min(this.max[0],H[0]),this.min[0]);return ve-H[0]},co.prototype.distanceY=function(H){var ve=Math.max(Math.min(this.max[1],H[1]),this.min[1]);return ve-H[1]},co.prototype.intersects=function(H){for(var ve=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],Z=!0,pe=0;pe<H.planes.length;pe++){for(var Se=H.planes[pe],Re=0,je=0;je<ve.length;je++)Re+=e.dot$1(Se,ve[je])>=0;if(Re===0)return 0;Re!==ve.length&&(Z=!1)}if(Z)return 2;for(var ut=0;ut<3;ut++){for(var Et=Number.MAX_VALUE,Jt=-Number.MAX_VALUE,lr=0;lr<H.points.length;lr++){var vr=H.points[lr][ut]-this.min[ut];Et=Math.min(Et,vr),Jt=Math.max(Jt,vr)}if(Jt<0||Et>this.max[ut]-this.min[ut])return 0}return 1};var wo=function(H,ve,Z,pe){if(H===void 0&&(H=0),ve===void 0&&(ve=0),Z===void 0&&(Z=0),pe===void 0&&(pe=0),isNaN(H)||H<0||isNaN(ve)||ve<0||isNaN(Z)||Z<0||isNaN(pe)||pe<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=H,this.bottom=ve,this.left=Z,this.right=pe};wo.prototype.interpolate=function(H,ve,Z){return ve.top!=null&&H.top!=null&&(this.top=e.number(H.top,ve.top,Z)),ve.bottom!=null&&H.bottom!=null&&(this.bottom=e.number(H.bottom,ve.bottom,Z)),ve.left!=null&&H.left!=null&&(this.left=e.number(H.left,ve.left,Z)),ve.right!=null&&H.right!=null&&(this.right=e.number(H.right,ve.right,Z)),this},wo.prototype.getCenter=function(H,ve){var Z=e.clamp((this.left+H-this.right)/2,0,H),pe=e.clamp((this.top+ve-this.bottom)/2,0,ve);return new e.Point(Z,pe)},wo.prototype.equals=function(H){return this.top===H.top&&this.bottom===H.bottom&&this.left===H.left&&this.right===H.right},wo.prototype.clone=function(){return new wo(this.top,this.bottom,this.left,this.right)},wo.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var bi=function(H,ve,Z,pe,Se){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=Se===void 0?!0:Se,this._minZoom=H||0,this._maxZoom=ve||22,this._minPitch=Z==null?0:Z,this._maxPitch=pe==null?60:pe,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new wo,this._posMatrixCache={},this._alignedPosMatrixCache={}},Mi={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};bi.prototype.clone=function(){var H=new bi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return H.tileSize=this.tileSize,H.latRange=this.latRange,H.width=this.width,H.height=this.height,H._center=this._center,H.zoom=this.zoom,H.angle=this.angle,H._fov=this._fov,H._pitch=this._pitch,H._unmodified=this._unmodified,H._edgeInsets=this._edgeInsets.clone(),H._calcMatrices(),H},Mi.minZoom.get=function(){return this._minZoom},Mi.minZoom.set=function(fe){this._minZoom!==fe&&(this._minZoom=fe,this.zoom=Math.max(this.zoom,fe))},Mi.maxZoom.get=function(){return this._maxZoom},Mi.maxZoom.set=function(fe){this._maxZoom!==fe&&(this._maxZoom=fe,this.zoom=Math.min(this.zoom,fe))},Mi.minPitch.get=function(){return this._minPitch},Mi.minPitch.set=function(fe){this._minPitch!==fe&&(this._minPitch=fe,this.pitch=Math.max(this.pitch,fe))},Mi.maxPitch.get=function(){return this._maxPitch},Mi.maxPitch.set=function(fe){this._maxPitch!==fe&&(this._maxPitch=fe,this.pitch=Math.min(this.pitch,fe))},Mi.renderWorldCopies.get=function(){return this._renderWorldCopies},Mi.renderWorldCopies.set=function(fe){fe===void 0?fe=!0:fe===null&&(fe=!1),this._renderWorldCopies=fe},Mi.worldSize.get=function(){return this.tileSize*this.scale},Mi.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Mi.size.get=function(){return new e.Point(this.width,this.height)},Mi.bearing.get=function(){return-this.angle/Math.PI*180},Mi.bearing.set=function(fe){var H=-e.wrap(fe,-180,180)*Math.PI/180;this.angle!==H&&(this._unmodified=!1,this.angle=H,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Mi.pitch.get=function(){return this._pitch/Math.PI*180},Mi.pitch.set=function(fe){var H=e.clamp(fe,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==H&&(this._unmodified=!1,this._pitch=H,this._calcMatrices())},Mi.fov.get=function(){return this._fov/Math.PI*180},Mi.fov.set=function(fe){fe=Math.max(.01,Math.min(60,fe)),this._fov!==fe&&(this._unmodified=!1,this._fov=fe/180*Math.PI,this._calcMatrices())},Mi.zoom.get=function(){return this._zoom},Mi.zoom.set=function(fe){var H=Math.min(Math.max(fe,this.minZoom),this.maxZoom);this._zoom!==H&&(this._unmodified=!1,this._zoom=H,this.scale=this.zoomScale(H),this.tileZoom=Math.floor(H),this.zoomFraction=H-this.tileZoom,this._constrain(),this._calcMatrices())},Mi.center.get=function(){return this._center},Mi.center.set=function(fe){fe.lat===this._center.lat&&fe.lng===this._center.lng||(this._unmodified=!1,this._center=fe,this._constrain(),this._calcMatrices())},Mi.padding.get=function(){return this._edgeInsets.toJSON()},Mi.padding.set=function(fe){this._edgeInsets.equals(fe)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,fe,1),this._calcMatrices())},Mi.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},bi.prototype.isPaddingEqual=function(H){return this._edgeInsets.equals(H)},bi.prototype.interpolatePadding=function(H,ve,Z){this._unmodified=!1,this._edgeInsets.interpolate(H,ve,Z),this._constrain(),this._calcMatrices()},bi.prototype.coveringZoomLevel=function(H){var ve=(H.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/H.tileSize));return Math.max(0,ve)},bi.prototype.getVisibleUnwrappedCoordinates=function(H){var ve=[new e.UnwrappedTileID(0,H)];if(this._renderWorldCopies)for(var Z=this.pointCoordinate(new e.Point(0,0)),pe=this.pointCoordinate(new e.Point(this.width,0)),Se=this.pointCoordinate(new e.Point(this.width,this.height)),Re=this.pointCoordinate(new e.Point(0,this.height)),je=Math.floor(Math.min(Z.x,pe.x,Se.x,Re.x)),ut=Math.floor(Math.max(Z.x,pe.x,Se.x,Re.x)),Et=1,Jt=je-Et;Jt<=ut+Et;Jt++)Jt!==0&&ve.push(new e.UnwrappedTileID(Jt,H));return ve},bi.prototype.coveringTiles=function(H){var ve=this.coveringZoomLevel(H),Z=ve;if(H.minzoom!==void 0&&ve<H.minzoom)return[];H.maxzoom!==void 0&&ve>H.maxzoom&&(ve=H.maxzoom);var pe=e.MercatorCoordinate.fromLngLat(this.center),Se=Math.pow(2,ve),Re=[Se*pe.x,Se*pe.y,0],je=Yi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,ve),ut=H.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ut=ve);var Et=3,Jt=function(Ca){return{aabb:new co([Ca*Se,0,0],[(Ca+1)*Se,Se,0]),zoom:0,x:0,y:0,wrap:Ca,fullyVisible:!1}},lr=[],vr=[],Cr=ve,Hr=H.reparseOverscaled?Z:ve;if(this._renderWorldCopies)for(var Yr=1;Yr<=3;Yr++)lr.push(Jt(-Yr)),lr.push(Jt(Yr));for(lr.push(Jt(0));lr.length>0;){var Ur=lr.pop(),Jr=Ur.x,hn=Ur.y,Cn=Ur.fullyVisible;if(!Cn){var Fn=Ur.aabb.intersects(je);if(Fn===0)continue;Cn=Fn===2}var Kn=Ur.aabb.distanceX(Re),qn=Ur.aabb.distanceY(Re),Qn=Math.max(Math.abs(Kn),Math.abs(qn)),ca=Et+(1<<Cr-Ur.zoom)-2;if(Ur.zoom===Cr||Qn>ca&&Ur.zoom>=ut){vr.push({tileID:new e.OverscaledTileID(Ur.zoom===Cr?Hr:Ur.zoom,Ur.wrap,Ur.zoom,Jr,hn),distanceSq:e.sqrLen([Re[0]-.5-Jr,Re[1]-.5-hn])});continue}for(var ba=0;ba<4;ba++){var ya=(Jr<<1)+ba%2,Ta=(hn<<1)+(ba>>1);lr.push({aabb:Ur.aabb.quadrant(ba),zoom:Ur.zoom+1,x:ya,y:Ta,wrap:Ur.wrap,fullyVisible:Cn})}}return vr.sort(function(Ca,Va){return Ca.distanceSq-Va.distanceSq}).map(function(Ca){return Ca.tileID})},bi.prototype.resize=function(H,ve){this.width=H,this.height=ve,this.pixelsToGLUnits=[2/H,-2/ve],this._constrain(),this._calcMatrices()},Mi.unmodified.get=function(){return this._unmodified},bi.prototype.zoomScale=function(H){return Math.pow(2,H)},bi.prototype.scaleZoom=function(H){return Math.log(H)/Math.LN2},bi.prototype.project=function(H){var ve=e.clamp(H.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(H.lng)*this.worldSize,e.mercatorYfromLat(ve)*this.worldSize)},bi.prototype.unproject=function(H){return new e.MercatorCoordinate(H.x/this.worldSize,H.y/this.worldSize).toLngLat()},Mi.point.get=function(){return this.project(this.center)},bi.prototype.setLocationAtPoint=function(H,ve){var Z=this.pointCoordinate(ve),pe=this.pointCoordinate(this.centerPoint),Se=this.locationCoordinate(H),Re=new e.MercatorCoordinate(Se.x-(Z.x-pe.x),Se.y-(Z.y-pe.y));this.center=this.coordinateLocation(Re),this._renderWorldCopies&&(this.center=this.center.wrap())},bi.prototype.locationPoint=function(H){return this.coordinatePoint(this.locationCoordinate(H))},bi.prototype.pointLocation=function(H){return this.coordinateLocation(this.pointCoordinate(H))},bi.prototype.locationCoordinate=function(H){return e.MercatorCoordinate.fromLngLat(H)},bi.prototype.coordinateLocation=function(H){return H.toLngLat()},bi.prototype.pointCoordinate=function(H){var ve=0,Z=[H.x,H.y,0,1],pe=[H.x,H.y,1,1];e.transformMat4(Z,Z,this.pixelMatrixInverse),e.transformMat4(pe,pe,this.pixelMatrixInverse);var Se=Z[3],Re=pe[3],je=Z[0]/Se,ut=pe[0]/Re,Et=Z[1]/Se,Jt=pe[1]/Re,lr=Z[2]/Se,vr=pe[2]/Re,Cr=lr===vr?0:(ve-lr)/(vr-lr);return new e.MercatorCoordinate(e.number(je,ut,Cr)/this.worldSize,e.number(Et,Jt,Cr)/this.worldSize)},bi.prototype.coordinatePoint=function(H){var ve=[H.x*this.worldSize,H.y*this.worldSize,0,1];return e.transformMat4(ve,ve,this.pixelMatrix),new e.Point(ve[0]/ve[3],ve[1]/ve[3])},bi.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},bi.prototype.getMaxBounds=function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])},bi.prototype.setMaxBounds=function(H){H?(this.lngRange=[H.getWest(),H.getEast()],this.latRange=[H.getSouth(),H.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},bi.prototype.calculatePosMatrix=function(H,ve){ve===void 0&&(ve=!1);var Z=H.key,pe=ve?this._alignedPosMatrixCache:this._posMatrixCache;if(pe[Z])return pe[Z];var Se=H.canonical,Re=this.worldSize/this.zoomScale(Se.z),je=Se.x+Math.pow(2,Se.z)*H.wrap,ut=e.identity(new Float64Array(16));return e.translate(ut,ut,[je*Re,Se.y*Re,0]),e.scale(ut,ut,[Re/e.EXTENT,Re/e.EXTENT,1]),e.multiply(ut,ve?this.alignedProjMatrix:this.projMatrix,ut),pe[Z]=new Float32Array(ut),pe[Z]},bi.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},bi.prototype._constrain=function(){if(!(!this.center||!this.width||!this.height||this._constraining)){this._constraining=!0;var H=-90,ve=90,Z=-180,pe=180,Se,Re,je,ut,Et=this.size,Jt=this._unmodified;if(this.latRange){var lr=this.latRange;H=e.mercatorYfromLat(lr[1])*this.worldSize,ve=e.mercatorYfromLat(lr[0])*this.worldSize,Se=ve-H<Et.y?Et.y/(ve-H):0}if(this.lngRange){var vr=this.lngRange;Z=e.mercatorXfromLng(vr[0])*this.worldSize,pe=e.mercatorXfromLng(vr[1])*this.worldSize,Re=pe-Z<Et.x?Et.x/(pe-Z):0}var Cr=this.point,Hr=Math.max(Re||0,Se||0);if(Hr){this.center=this.unproject(new e.Point(Re?(pe+Z)/2:Cr.x,Se?(ve+H)/2:Cr.y)),this.zoom+=this.scaleZoom(Hr),this._unmodified=Jt,this._constraining=!1;return}if(this.latRange){var Yr=Cr.y,Ur=Et.y/2;Yr-Ur<H&&(ut=H+Ur),Yr+Ur>ve&&(ut=ve-Ur)}if(this.lngRange){var Jr=Cr.x,hn=Et.x/2;Jr-hn<Z&&(je=Z+hn),Jr+hn>pe&&(je=pe-hn)}(je!==void 0||ut!==void 0)&&(this.center=this.unproject(new e.Point(je!==void 0?je:Cr.x,ut!==void 0?ut:Cr.y))),this._unmodified=Jt,this._constraining=!1}},bi.prototype._calcMatrices=function(){if(!!this.height){var H=this._fov/2,ve=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(H)*this.height;var Z=Math.PI/2+this._pitch,pe=this._fov*(.5+ve.y/this.height),Se=Math.sin(pe)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-Z-pe,.01,Math.PI-.01)),Re=this.point,je=Re.x,ut=Re.y,Et=Math.cos(Math.PI/2-this._pitch)*Se+this.cameraToCenterDistance,Jt=Et*1.01,lr=this.height/50,vr=new Float64Array(16);e.perspective(vr,this._fov,this.width/this.height,lr,Jt),vr[8]=-ve.x*2/this.width,vr[9]=ve.y*2/this.height,e.scale(vr,vr,[1,-1,1]),e.translate(vr,vr,[0,0,-this.cameraToCenterDistance]),e.rotateX(vr,vr,this._pitch),e.rotateZ(vr,vr,this.angle),e.translate(vr,vr,[-je,-ut,0]),this.mercatorMatrix=e.scale([],vr,[this.worldSize,this.worldSize,this.worldSize]),e.scale(vr,vr,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=vr,this.invProjMatrix=e.invert([],this.projMatrix);var Cr=this.width%2/2,Hr=this.height%2/2,Yr=Math.cos(this.angle),Ur=Math.sin(this.angle),Jr=je-Math.round(je)+Yr*Cr+Ur*Hr,hn=ut-Math.round(ut)+Yr*Hr+Ur*Cr,Cn=new Float64Array(vr);if(e.translate(Cn,Cn,[Jr>.5?Jr-1:Jr,hn>.5?hn-1:hn,0]),this.alignedProjMatrix=Cn,vr=e.create(),e.scale(vr,vr,[this.width/2,-this.height/2,1]),e.translate(vr,vr,[1,-1,0]),this.labelPlaneMatrix=vr,vr=e.create(),e.scale(vr,vr,[1,-1,1]),e.translate(vr,vr,[-1,-1,0]),e.scale(vr,vr,[2/this.width,2/this.height,1]),this.glCoordMatrix=vr,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),vr=e.invert(new Float64Array(16),this.pixelMatrix),!vr)throw new Error("failed to invert matrix");this.pixelMatrixInverse=vr,this._posMatrixCache={},this._alignedPosMatrixCache={}}},bi.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var H=this.pointCoordinate(new e.Point(0,0)),ve=[H.x*this.worldSize,H.y*this.worldSize,0,1],Z=e.transformMat4(ve,ve,this.pixelMatrix);return Z[3]/this.cameraToCenterDistance},bi.prototype.getCameraPoint=function(){var H=this._pitch,ve=Math.tan(H)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,ve))},bi.prototype.getCameraQueryGeometry=function(H){var ve=this.getCameraPoint();if(H.length===1)return[H[0],ve];for(var Z=ve.x,pe=ve.y,Se=ve.x,Re=ve.y,je=0,ut=H;je<ut.length;je+=1){var Et=ut[je];Z=Math.min(Z,Et.x),pe=Math.min(pe,Et.y),Se=Math.max(Se,Et.x),Re=Math.max(Re,Et.y)}return[new e.Point(Z,pe),new e.Point(Se,pe),new e.Point(Se,Re),new e.Point(Z,Re),new e.Point(Z,pe)]},Object.defineProperties(bi.prototype,Mi);function cs(fe,H){var ve=!1,Z=null,pe=function(){Z=null,ve&&(fe(),Z=setTimeout(pe,H),ve=!1)};return function(){return ve=!0,Z||pe(),Z}}var yo=function(H){this._hashName=H&&encodeURIComponent(H),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=cs(this._updateHashUnthrottled.bind(this),30*1e3/100)};yo.prototype.addTo=function(H){return this._map=H,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},yo.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},yo.prototype.getHashString=function(H){var ve=this._map.getCenter(),Z=Math.round(this._map.getZoom()*100)/100,pe=Math.ceil((Z*Math.LN2+Math.log(512/360/.5))/Math.LN10),Se=Math.pow(10,pe),Re=Math.round(ve.lng*Se)/Se,je=Math.round(ve.lat*Se)/Se,ut=this._map.getBearing(),Et=this._map.getPitch(),Jt="";if(H?Jt+="/"+Re+"/"+je+"/"+Z:Jt+=Z+"/"+je+"/"+Re,(ut||Et)&&(Jt+="/"+Math.round(ut*10)/10),Et&&(Jt+="/"+Math.round(Et)),this._hashName){var lr=this._hashName,vr=!1,Cr=e.window.location.hash.slice(1).split("&").map(function(Hr){var Yr=Hr.split("=")[0];return Yr===lr?(vr=!0,Yr+"="+Jt):Hr}).filter(function(Hr){return Hr});return vr||Cr.push(lr+"="+Jt),"#"+Cr.join("&")}return"#"+Jt},yo.prototype._getCurrentHash=function(){var H=this,ve=e.window.location.hash.replace("#","");if(this._hashName){var Z;return ve.split("&").map(function(pe){return pe.split("=")}).forEach(function(pe){pe[0]===H._hashName&&(Z=pe)}),(Z&&Z[1]||"").split("/")}return ve.split("/")},yo.prototype._onHashChange=function(){var H=this._getCurrentHash();if(H.length>=3&&!H.some(function(Z){return isNaN(Z)})){var ve=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(H[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+H[2],+H[1]],zoom:+H[0],bearing:ve,pitch:+(H[4]||0)}),!0}return!1},yo.prototype._updateHashUnthrottled=function(){var H=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",H)}catch{}};var Do={linearity:.3,easing:e.bezier(0,0,.3,1)},Yo=e.extend({deceleration:2500,maxSpeed:1400},Do),le=e.extend({deceleration:20,maxSpeed:1400},Do),_e=e.extend({deceleration:1e3,maxSpeed:360},Do),Le=e.extend({deceleration:1e3,maxSpeed:90},Do),Be=function(H){this._map=H,this.clear()};Be.prototype.clear=function(){this._inertiaBuffer=[]},Be.prototype.record=function(H){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:H})},Be.prototype._drainInertiaBuffer=function(){for(var H=this._inertiaBuffer,ve=e.browser.now(),Z=160;H.length>0&&ve-H[0].time>Z;)H.shift()},Be.prototype._onMoveEnd=function(H){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var ve={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},Z=0,pe=this._inertiaBuffer;Z<pe.length;Z+=1){var Se=pe[Z],Re=Se.settings;ve.zoom+=Re.zoomDelta||0,ve.bearing+=Re.bearingDelta||0,ve.pitch+=Re.pitchDelta||0,Re.panDelta&&ve.pan._add(Re.panDelta),Re.around&&(ve.around=Re.around),Re.pinchAround&&(ve.pinchAround=Re.pinchAround)}var je=this._inertiaBuffer[this._inertiaBuffer.length-1],ut=je.time-this._inertiaBuffer[0].time,Et={};if(ve.pan.mag()){var Jt=Ke(ve.pan.mag(),ut,e.extend({},Yo,H||{}));Et.offset=ve.pan.mult(Jt.amount/ve.pan.mag()),Et.center=this._map.transform.center,Oe(Et,Jt)}if(ve.zoom){var lr=Ke(ve.zoom,ut,le);Et.zoom=this._map.transform.zoom+lr.amount,Oe(Et,lr)}if(ve.bearing){var vr=Ke(ve.bearing,ut,_e);Et.bearing=this._map.transform.bearing+e.clamp(vr.amount,-179,179),Oe(Et,vr)}if(ve.pitch){var Cr=Ke(ve.pitch,ut,Le);Et.pitch=this._map.transform.pitch+Cr.amount,Oe(Et,Cr)}if(Et.zoom||Et.bearing){var Hr=ve.pinchAround===void 0?ve.around:ve.pinchAround;Et.around=Hr?this._map.unproject(Hr):this._map.getCenter()}return this.clear(),e.extend(Et,{noMoveStart:!0})}};function Oe(fe,H){(!fe.duration||fe.duration<H.duration)&&(fe.duration=H.duration,fe.easing=H.easing)}function Ke(fe,H,ve){var Z=ve.maxSpeed,pe=ve.linearity,Se=ve.deceleration,Re=e.clamp(fe*pe/(H/1e3),-Z,Z),je=Math.abs(Re)/(Se*pe);return{easing:ve.easing,duration:je*1e3,amount:Re*(je/2)}}var xt=function(fe){function H(Z,pe,Se,Re){Re===void 0&&(Re={});var je=n.mousePos(pe.getCanvasContainer(),Se),ut=pe.unproject(je);fe.call(this,Z,e.extend({point:je,lngLat:ut,originalEvent:Se},Re)),this._defaultPrevented=!1,this.target=pe}fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H;var ve={defaultPrevented:{configurable:!0}};return H.prototype.preventDefault=function(){this._defaultPrevented=!0},ve.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(H.prototype,ve),H}(e.Event),vt=function(fe){function H(Z,pe,Se){var Re=Z==="touchend"?Se.changedTouches:Se.touches,je=n.touchPos(pe.getCanvasContainer(),Re),ut=je.map(function(lr){return pe.unproject(lr)}),Et=je.reduce(function(lr,vr,Cr,Hr){return lr.add(vr.div(Hr.length))},new e.Point(0,0)),Jt=pe.unproject(Et);fe.call(this,Z,{points:je,point:Et,lngLats:ut,lngLat:Jt,originalEvent:Se}),this._defaultPrevented=!1}fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H;var ve={defaultPrevented:{configurable:!0}};return H.prototype.preventDefault=function(){this._defaultPrevented=!0},ve.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(H.prototype,ve),H}(e.Event),Pt=function(fe){function H(Z,pe,Se){fe.call(this,Z,{originalEvent:Se}),this._defaultPrevented=!1}fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H;var ve={defaultPrevented:{configurable:!0}};return H.prototype.preventDefault=function(){this._defaultPrevented=!0},ve.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(H.prototype,ve),H}(e.Event),jt=function(H,ve){this._map=H,this._clickTolerance=ve.clickTolerance};jt.prototype.reset=function(){delete this._mousedownPos},jt.prototype.wheel=function(H){return this._firePreventable(new Pt(H.type,this._map,H))},jt.prototype.mousedown=function(H,ve){return this._mousedownPos=ve,this._firePreventable(new xt(H.type,this._map,H))},jt.prototype.mouseup=function(H){this._map.fire(new xt(H.type,this._map,H))},jt.prototype.click=function(H,ve){this._mousedownPos&&this._mousedownPos.dist(ve)>=this._clickTolerance||this._map.fire(new xt(H.type,this._map,H))},jt.prototype.dblclick=function(H){return this._firePreventable(new xt(H.type,this._map,H))},jt.prototype.mouseover=function(H){this._map.fire(new xt(H.type,this._map,H))},jt.prototype.mouseout=function(H){this._map.fire(new xt(H.type,this._map,H))},jt.prototype.touchstart=function(H){return this._firePreventable(new vt(H.type,this._map,H))},jt.prototype.touchmove=function(H){this._map.fire(new vt(H.type,this._map,H))},jt.prototype.touchend=function(H){this._map.fire(new vt(H.type,this._map,H))},jt.prototype.touchcancel=function(H){this._map.fire(new vt(H.type,this._map,H))},jt.prototype._firePreventable=function(H){if(this._map.fire(H),H.defaultPrevented)return{}},jt.prototype.isEnabled=function(){return!0},jt.prototype.isActive=function(){return!1},jt.prototype.enable=function(){},jt.prototype.disable=function(){};var qt=function(H){this._map=H};qt.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},qt.prototype.mousemove=function(H){this._map.fire(new xt(H.type,this._map,H))},qt.prototype.mousedown=function(){this._delayContextMenu=!0},qt.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new xt("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},qt.prototype.contextmenu=function(H){this._delayContextMenu?this._contextMenuEvent=H:this._map.fire(new xt(H.type,this._map,H)),this._map.listens("contextmenu")&&H.preventDefault()},qt.prototype.isEnabled=function(){return!0},qt.prototype.isActive=function(){return!1},qt.prototype.enable=function(){},qt.prototype.disable=function(){};var er=function(H,ve){this._map=H,this._el=H.getCanvasContainer(),this._container=H.getContainer(),this._clickTolerance=ve.clickTolerance||1};er.prototype.isEnabled=function(){return!!this._enabled},er.prototype.isActive=function(){return!!this._active},er.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},er.prototype.disable=function(){!this.isEnabled()||(this._enabled=!1)},er.prototype.mousedown=function(H,ve){!this.isEnabled()||!(H.shiftKey&&H.button===0)||(n.disableDrag(),this._startPos=this._lastPos=ve,this._active=!0)},er.prototype.mousemoveWindow=function(H,ve){if(!!this._active){var Z=ve;if(!(this._lastPos.equals(Z)||!this._box&&Z.dist(this._startPos)<this._clickTolerance)){var pe=this._startPos;this._lastPos=Z,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",H));var Se=Math.min(pe.x,Z.x),Re=Math.max(pe.x,Z.x),je=Math.min(pe.y,Z.y),ut=Math.max(pe.y,Z.y);n.setTransform(this._box,"translate("+Se+"px,"+je+"px)"),this._box.style.width=Re-Se+"px",this._box.style.height=ut-je+"px"}}},er.prototype.mouseupWindow=function(H,ve){var Z=this;if(!!this._active&&H.button===0){var pe=this._startPos,Se=ve;if(this.reset(),n.suppressClick(),pe.x===Se.x&&pe.y===Se.y)this._fireEvent("boxzoomcancel",H);else return this._map.fire(new e.Event("boxzoomend",{originalEvent:H})),{cameraAnimation:function(Re){return Re.fitScreenCoordinates(pe,Se,Z._map.getBearing(),{linear:!0})}}}},er.prototype.keydown=function(H){!this._active||H.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",H))},er.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},er.prototype._fireEvent=function(H,ve){return this._map.fire(new e.Event(H,{originalEvent:ve}))};function Mr(fe,H){for(var ve={},Z=0;Z<fe.length;Z++)ve[fe[Z].identifier]=H[Z];return ve}function Qr(fe){for(var H=new e.Point(0,0),ve=0,Z=fe;ve<Z.length;ve+=1){var pe=Z[ve];H._add(pe)}return H.div(fe.length)}var ln=500,Lr=500,Nr=30,Zr=function(H){this.reset(),this.numTouches=H.numTouches};Zr.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Zr.prototype.touchstart=function(H,ve,Z){(this.centroid||Z.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=H.timeStamp),Z.length===this.numTouches&&(this.centroid=Qr(ve),this.touches=Mr(Z,ve)))},Zr.prototype.touchmove=function(H,ve,Z){if(!(this.aborted||!this.centroid)){var pe=Mr(Z,ve);for(var Se in this.touches){var Re=this.touches[Se],je=pe[Se];(!je||je.dist(Re)>Nr)&&(this.aborted=!0)}}},Zr.prototype.touchend=function(H,ve,Z){if((!this.centroid||H.timeStamp-this.startTime>Lr)&&(this.aborted=!0),Z.length===0){var pe=!this.aborted&&this.centroid;if(this.reset(),pe)return pe}};var an=function(H){this.singleTap=new Zr(H),this.numTaps=H.numTaps,this.reset()};an.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},an.prototype.touchstart=function(H,ve,Z){this.singleTap.touchstart(H,ve,Z)},an.prototype.touchmove=function(H,ve,Z){this.singleTap.touchmove(H,ve,Z)},an.prototype.touchend=function(H,ve,Z){var pe=this.singleTap.touchend(H,ve,Z);if(pe){var Se=H.timeStamp-this.lastTime<ln,Re=!this.lastTap||this.lastTap.dist(pe)<Nr;if((!Se||!Re)&&this.reset(),this.count++,this.lastTime=H.timeStamp,this.lastTap=pe,this.count===this.numTaps)return this.reset(),pe}};var sn=function(){this._zoomIn=new an({numTouches:1,numTaps:2}),this._zoomOut=new an({numTouches:2,numTaps:1}),this.reset()};sn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},sn.prototype.touchstart=function(H,ve,Z){this._zoomIn.touchstart(H,ve,Z),this._zoomOut.touchstart(H,ve,Z)},sn.prototype.touchmove=function(H,ve,Z){this._zoomIn.touchmove(H,ve,Z),this._zoomOut.touchmove(H,ve,Z)},sn.prototype.touchend=function(H,ve,Z){var pe=this,Se=this._zoomIn.touchend(H,ve,Z),Re=this._zoomOut.touchend(H,ve,Z);if(Se)return this._active=!0,H.preventDefault(),setTimeout(function(){return pe.reset()},0),{cameraAnimation:function(je){return je.easeTo({duration:300,zoom:je.getZoom()+1,around:je.unproject(Se)},{originalEvent:H})}};if(Re)return this._active=!0,H.preventDefault(),setTimeout(function(){return pe.reset()},0),{cameraAnimation:function(je){return je.easeTo({duration:300,zoom:je.getZoom()-1,around:je.unproject(Re)},{originalEvent:H})}}},sn.prototype.touchcancel=function(){this.reset()},sn.prototype.enable=function(){this._enabled=!0},sn.prototype.disable=function(){this._enabled=!1,this.reset()},sn.prototype.isEnabled=function(){return this._enabled},sn.prototype.isActive=function(){return this._active};var Kr=0,Un=2,ra=function(H){this.reset(),this._clickTolerance=H.clickTolerance||1};ra.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},ra.prototype._correctButton=function(H,ve){return!1},ra.prototype._move=function(H,ve){return{}},ra.prototype.mousedown=function(H,ve){if(!this._lastPoint){var Z=n.mouseButton(H);!this._correctButton(H,Z)||(this._lastPoint=ve,this._eventButton=Z)}},ra.prototype.mousemoveWindow=function(H,ve){var Z=this._lastPoint;if(!!Z&&(H.preventDefault(),!(!this._moved&&ve.dist(Z)<this._clickTolerance)))return this._moved=!0,this._lastPoint=ve,this._move(Z,ve)},ra.prototype.mouseupWindow=function(H){var ve=n.mouseButton(H);ve===this._eventButton&&(this._moved&&n.suppressClick(),this.reset())},ra.prototype.enable=function(){this._enabled=!0},ra.prototype.disable=function(){this._enabled=!1,this.reset()},ra.prototype.isEnabled=function(){return this._enabled},ra.prototype.isActive=function(){return this._active};var _a=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.mousedown=function(Z,pe){fe.prototype.mousedown.call(this,Z,pe),this._lastPoint&&(this._active=!0)},H.prototype._correctButton=function(Z,pe){return pe===Kr&&!Z.ctrlKey},H.prototype._move=function(Z,pe){return{around:pe,panDelta:pe.sub(Z)}},H}(ra),ia=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype._correctButton=function(Z,pe){return pe===Kr&&Z.ctrlKey||pe===Un},H.prototype._move=function(Z,pe){var Se=.8,Re=(pe.x-Z.x)*Se;if(Re)return this._active=!0,{bearingDelta:Re}},H.prototype.contextmenu=function(Z){Z.preventDefault()},H}(ra),ka=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype._correctButton=function(Z,pe){return pe===Kr&&Z.ctrlKey||pe===Un},H.prototype._move=function(Z,pe){var Se=-.5,Re=(pe.y-Z.y)*Se;if(Re)return this._active=!0,{pitchDelta:Re}},H.prototype.contextmenu=function(Z){Z.preventDefault()},H}(ra),la=function(H){this._minTouches=1,this._clickTolerance=H.clickTolerance||1,this.reset()};la.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},la.prototype.touchstart=function(H,ve,Z){return this._calculateTransform(H,ve,Z)},la.prototype.touchmove=function(H,ve,Z){if(!!this._active)return H.preventDefault(),this._calculateTransform(H,ve,Z)},la.prototype.touchend=function(H,ve,Z){this._calculateTransform(H,ve,Z),this._active&&Z.length<this._minTouches&&this.reset()},la.prototype.touchcancel=function(){this.reset()},la.prototype._calculateTransform=function(H,ve,Z){Z.length>0&&(this._active=!0);var pe=Mr(Z,ve),Se=new e.Point(0,0),Re=new e.Point(0,0),je=0;for(var ut in pe){var Et=pe[ut],Jt=this._touches[ut];Jt&&(Se._add(Et),Re._add(Et.sub(Jt)),je++,pe[ut]=Et)}if(this._touches=pe,!(je<this._minTouches||!Re.mag())){var lr=Re.div(je);if(this._sum._add(lr),!(this._sum.mag()<this._clickTolerance)){var vr=Se.div(je);return{around:vr,panDelta:lr}}}},la.prototype.enable=function(){this._enabled=!0},la.prototype.disable=function(){this._enabled=!1,this.reset()},la.prototype.isEnabled=function(){return this._enabled},la.prototype.isActive=function(){return this._active};var Na=function(){this.reset()};Na.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Na.prototype._start=function(H){},Na.prototype._move=function(H,ve,Z){return{}},Na.prototype.touchstart=function(H,ve,Z){this._firstTwoTouches||Z.length<2||(this._firstTwoTouches=[Z[0].identifier,Z[1].identifier],this._start([ve[0],ve[1]]))},Na.prototype.touchmove=function(H,ve,Z){if(!!this._firstTwoTouches){H.preventDefault();var pe=this._firstTwoTouches,Se=pe[0],Re=pe[1],je=Pa(Z,ve,Se),ut=Pa(Z,ve,Re);if(!(!je||!ut)){var Et=this._aroundCenter?null:je.add(ut).div(2);return this._move([je,ut],Et,H)}}},Na.prototype.touchend=function(H,ve,Z){if(!!this._firstTwoTouches){var pe=this._firstTwoTouches,Se=pe[0],Re=pe[1],je=Pa(Z,ve,Se),ut=Pa(Z,ve,Re);je&&ut||(this._active&&n.suppressClick(),this.reset())}},Na.prototype.touchcancel=function(){this.reset()},Na.prototype.enable=function(H){this._enabled=!0,this._aroundCenter=!!H&&H.around==="center"},Na.prototype.disable=function(){this._enabled=!1,this.reset()},Na.prototype.isEnabled=function(){return this._enabled},Na.prototype.isActive=function(){return this._active};function Pa(fe,H,ve){for(var Z=0;Z<fe.length;Z++)if(fe[Z].identifier===ve)return H[Z]}var $a=.1;function yi(fe,H){return Math.log(fe/H)/Math.LN2}var ho=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.reset=function(){fe.prototype.reset.call(this),delete this._distance,delete this._startDistance},H.prototype._start=function(Z){this._startDistance=this._distance=Z[0].dist(Z[1])},H.prototype._move=function(Z,pe){var Se=this._distance;if(this._distance=Z[0].dist(Z[1]),!(!this._active&&Math.abs(yi(this._distance,this._startDistance))<$a))return this._active=!0,{zoomDelta:yi(this._distance,Se),pinchAround:pe}},H}(Na),zi=25;function fa(fe,H){return fe.angleWith(H)*180/Math.PI}var ai=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.reset=function(){fe.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},H.prototype._start=function(Z){this._startVector=this._vector=Z[0].sub(Z[1]),this._minDiameter=Z[0].dist(Z[1])},H.prototype._move=function(Z,pe){var Se=this._vector;if(this._vector=Z[0].sub(Z[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:fa(this._vector,Se),pinchAround:pe}},H.prototype._isBelowThreshold=function(Z){this._minDiameter=Math.min(this._minDiameter,Z.mag());var pe=Math.PI*this._minDiameter,Se=zi/pe*360,Re=fa(Z,this._startVector);return Math.abs(Re)<Se},H}(Na);function Xa(fe){return Math.abs(fe.y)>Math.abs(fe.x)}var Si=100,si=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.reset=function(){fe.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},H.prototype._start=function(Z){this._lastPoints=Z,Xa(Z[0].sub(Z[1]))&&(this._valid=!1)},H.prototype._move=function(Z,pe,Se){var Re=Z[0].sub(this._lastPoints[0]),je=Z[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(Re,je,Se.timeStamp),!!this._valid){this._lastPoints=Z,this._active=!0;var ut=(Re.y+je.y)/2,Et=-.5;return{pitchDelta:ut*Et}}},H.prototype.gestureBeginsVertically=function(Z,pe,Se){if(this._valid!==void 0)return this._valid;var Re=2,je=Z.mag()>=Re,ut=pe.mag()>=Re;if(!(!je&&!ut)){if(!je||!ut)return this._firstMove===void 0&&(this._firstMove=Se),Se-this._firstMove<Si?void 0:!1;var Et=Z.y>0==pe.y>0;return Xa(Z)&&Xa(pe)&&Et}},H}(Na),so={panStep:100,bearingStep:15,pitchStep:10},qi=function(){var H=so;this._panStep=H.panStep,this._bearingStep=H.bearingStep,this._pitchStep=H.pitchStep};qi.prototype.reset=function(){this._active=!1},qi.prototype.keydown=function(H){var ve=this;if(!(H.altKey||H.ctrlKey||H.metaKey)){var Z=0,pe=0,Se=0,Re=0,je=0;switch(H.keyCode){case 61:case 107:case 171:case 187:Z=1;break;case 189:case 109:case 173:Z=-1;break;case 37:H.shiftKey?pe=-1:(H.preventDefault(),Re=-1);break;case 39:H.shiftKey?pe=1:(H.preventDefault(),Re=1);break;case 38:H.shiftKey?Se=1:(H.preventDefault(),je=-1);break;case 40:H.shiftKey?Se=-1:(H.preventDefault(),je=1);break;default:return}return{cameraAnimation:function(ut){var Et=ut.getZoom();ut.easeTo({duration:300,easeId:"keyboardHandler",easing:mo,zoom:Z?Math.round(Et)+Z*(H.shiftKey?2:1):Et,bearing:ut.getBearing()+pe*ve._bearingStep,pitch:ut.getPitch()+Se*ve._pitchStep,offset:[-Re*ve._panStep,-je*ve._panStep],center:ut.getCenter()},{originalEvent:H})}}}},qi.prototype.enable=function(){this._enabled=!0},qi.prototype.disable=function(){this._enabled=!1,this.reset()},qi.prototype.isEnabled=function(){return this._enabled},qi.prototype.isActive=function(){return this._active};function mo(fe){return fe*(2-fe)}var Wo=4.000244140625,Bo=1/100,Xo=1/450,Wi=2,Ni=function(H,ve){this._map=H,this._el=H.getCanvasContainer(),this._handler=ve,this._delta=0,this._defaultZoomRate=Bo,this._wheelZoomRate=Xo,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Ni.prototype.setZoomRate=function(H){this._defaultZoomRate=H},Ni.prototype.setWheelZoomRate=function(H){this._wheelZoomRate=H},Ni.prototype.isEnabled=function(){return!!this._enabled},Ni.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ni.prototype.isZooming=function(){return!!this._zooming},Ni.prototype.enable=function(H){this.isEnabled()||(this._enabled=!0,this._aroundCenter=H&&H.around==="center")},Ni.prototype.disable=function(){!this.isEnabled()||(this._enabled=!1)},Ni.prototype.wheel=function(H){if(!!this.isEnabled()){var ve=H.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?H.deltaY*40:H.deltaY,Z=e.browser.now(),pe=Z-(this._lastWheelEventTime||0);this._lastWheelEventTime=Z,ve!==0&&ve%Wo===0?this._type="wheel":ve!==0&&Math.abs(ve)<4?this._type="trackpad":pe>400?(this._type=null,this._lastValue=ve,this._timeout=setTimeout(this._onTimeout,40,H)):this._type||(this._type=Math.abs(pe*ve)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,ve+=this._lastValue)),H.shiftKey&&ve&&(ve=ve/4),this._type&&(this._lastWheelEvent=H,this._delta-=ve,this._active||this._start(H)),H.preventDefault()}},Ni.prototype._onTimeout=function(H){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(H)},Ni.prototype._start=function(H){if(!!this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var ve=n.mousePos(this._el,H);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(ve)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ni.prototype.renderFrame=function(){return this._onScrollFrame()},Ni.prototype._onScrollFrame=function(){var H=this;if(!!this._frameId&&(this._frameId=null,!!this.isActive())){var ve=this._map.transform;if(this._delta!==0){var Z=this._type==="wheel"&&Math.abs(this._delta)>Wo?this._wheelZoomRate:this._defaultZoomRate,pe=Wi/(1+Math.exp(-Math.abs(this._delta*Z)));this._delta<0&&pe!==0&&(pe=1/pe);var Se=typeof this._targetZoom=="number"?ve.zoomScale(this._targetZoom):ve.scale;this._targetZoom=Math.min(ve.maxZoom,Math.max(ve.minZoom,ve.scaleZoom(Se*pe))),this._type==="wheel"&&(this._startZoom=ve.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var Re=typeof this._targetZoom=="number"?this._targetZoom:ve.zoom,je=this._startZoom,ut=this._easing,Et=!1,Jt;if(this._type==="wheel"&&je&&ut){var lr=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),vr=ut(lr);Jt=e.number(je,Re,vr),lr<1?this._frameId||(this._frameId=!0):Et=!0}else Jt=Re,Et=!0;return this._active=!0,Et&&(this._active=!1,this._finishTimeout=setTimeout(function(){H._zooming=!1,H._handler._triggerRenderFrame(),delete H._targetZoom,delete H._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Et,zoomDelta:Jt-ve.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ni.prototype._smoothOutEasing=function(H){var ve=e.ease;if(this._prevEase){var Z=this._prevEase,pe=(e.browser.now()-Z.start)/Z.duration,Se=Z.easing(pe+.01)-Z.easing(pe),Re=.27/Math.sqrt(Se*Se+1e-4)*.01,je=Math.sqrt(.27*.27-Re*Re);ve=e.bezier(Re,je,.25,1)}return this._prevEase={start:e.browser.now(),duration:H,easing:ve},ve},Ni.prototype.reset=function(){this._active=!1};var Ia=function(H,ve){this._clickZoom=H,this._tapZoom=ve};Ia.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ia.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ia.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ia.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Za=function(){this.reset()};Za.prototype.reset=function(){this._active=!1},Za.prototype.dblclick=function(H,ve){return H.preventDefault(),{cameraAnimation:function(Z){Z.easeTo({duration:300,zoom:Z.getZoom()+(H.shiftKey?-1:1),around:Z.unproject(ve)},{originalEvent:H})}}},Za.prototype.enable=function(){this._enabled=!0},Za.prototype.disable=function(){this._enabled=!1,this.reset()},Za.prototype.isEnabled=function(){return this._enabled},Za.prototype.isActive=function(){return this._active};var _o=function(){this._tap=new an({numTouches:1,numTaps:1}),this.reset()};_o.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},_o.prototype.touchstart=function(H,ve,Z){this._swipePoint||(this._tapTime&&H.timeStamp-this._tapTime>ln&&this.reset(),this._tapTime?Z.length>0&&(this._swipePoint=ve[0],this._swipeTouch=Z[0].identifier):this._tap.touchstart(H,ve,Z))},_o.prototype.touchmove=function(H,ve,Z){if(!this._tapTime)this._tap.touchmove(H,ve,Z);else if(this._swipePoint){if(Z[0].identifier!==this._swipeTouch)return;var pe=ve[0],Se=pe.y-this._swipePoint.y;return this._swipePoint=pe,H.preventDefault(),this._active=!0,{zoomDelta:Se/128}}},_o.prototype.touchend=function(H,ve,Z){if(this._tapTime)this._swipePoint&&Z.length===0&&this.reset();else{var pe=this._tap.touchend(H,ve,Z);pe&&(this._tapTime=H.timeStamp)}},_o.prototype.touchcancel=function(){this.reset()},_o.prototype.enable=function(){this._enabled=!0},_o.prototype.disable=function(){this._enabled=!1,this.reset()},_o.prototype.isEnabled=function(){return this._enabled},_o.prototype.isActive=function(){return this._active};var ro=function(H,ve,Z){this._el=H,this._mousePan=ve,this._touchPan=Z};ro.prototype.enable=function(H){this._inertiaOptions=H||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},ro.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},ro.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ro.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ro=function(H,ve,Z){this._pitchWithRotate=H.pitchWithRotate,this._mouseRotate=ve,this._mousePitch=Z};Ro.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ro.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ro.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ro.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ji=function(H,ve,Z,pe){this._el=H,this._touchZoom=ve,this._touchRotate=Z,this._tapDragZoom=pe,this._rotationDisabled=!1,this._enabled=!0};ji.prototype.enable=function(H){this._touchZoom.enable(H),this._rotationDisabled||this._touchRotate.enable(H),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ji.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ji.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ji.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ji.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ji.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Zo=function(fe){return fe.zoom||fe.drag||fe.pitch||fe.rotate},bs=function(fe){function H(){fe.apply(this,arguments)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H}(e.Event);function Ul(fe){return fe.panDelta&&fe.panDelta.mag()||fe.zoomDelta||fe.bearingDelta||fe.pitchDelta}var Ki=function(H,ve){this._map=H,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Be(H),this._bearingSnap=ve.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(ve),e.bindAll(["handleEvent","handleWindowEvent"],this);var Z=this._el;this._listeners=[[Z,"touchstart",{passive:!1}],[Z,"touchmove",{passive:!1}],[Z,"touchend",void 0],[Z,"touchcancel",void 0],[Z,"mousedown",void 0],[Z,"mousemove",void 0],[Z,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[Z,"mouseover",void 0],[Z,"mouseout",void 0],[Z,"dblclick",void 0],[Z,"click",void 0],[Z,"keydown",{capture:!1}],[Z,"keyup",void 0],[Z,"wheel",{passive:!1}],[Z,"contextmenu",void 0],[e.window,"blur",void 0]];for(var pe=0,Se=this._listeners;pe<Se.length;pe+=1){var Re=Se[pe],je=Re[0],ut=Re[1],Et=Re[2];n.addEventListener(je,ut,je===e.window.document?this.handleWindowEvent:this.handleEvent,Et)}};Ki.prototype.destroy=function(){for(var H=0,ve=this._listeners;H<ve.length;H+=1){var Z=ve[H],pe=Z[0],Se=Z[1],Re=Z[2];n.removeEventListener(pe,Se,pe===e.window.document?this.handleWindowEvent:this.handleEvent,Re)}},Ki.prototype._addDefaultHandlers=function(H){var ve=this._map,Z=ve.getCanvasContainer();this._add("mapEvent",new jt(ve,H));var pe=ve.boxZoom=new er(ve,H);this._add("boxZoom",pe);var Se=new sn,Re=new Za;ve.doubleClickZoom=new Ia(Re,Se),this._add("tapZoom",Se),this._add("clickZoom",Re);var je=new _o;this._add("tapDragZoom",je);var ut=ve.touchPitch=new si;this._add("touchPitch",ut);var Et=new ia(H),Jt=new ka(H);ve.dragRotate=new Ro(H,Et,Jt),this._add("mouseRotate",Et,["mousePitch"]),this._add("mousePitch",Jt,["mouseRotate"]);var lr=new _a(H),vr=new la(H);ve.dragPan=new ro(Z,lr,vr),this._add("mousePan",lr),this._add("touchPan",vr,["touchZoom","touchRotate"]);var Cr=new ai,Hr=new ho;ve.touchZoomRotate=new ji(Z,Hr,Cr,je),this._add("touchRotate",Cr,["touchPan","touchZoom"]),this._add("touchZoom",Hr,["touchPan","touchRotate"]);var Yr=ve.scrollZoom=new Ni(ve,this);this._add("scrollZoom",Yr,["mousePan"]);var Ur=ve.keyboard=new qi;this._add("keyboard",Ur),this._add("blockableMapEvent",new qt(ve));for(var Jr=0,hn=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Jr<hn.length;Jr+=1){var Cn=hn[Jr];H.interactive&&H[Cn]&&ve[Cn].enable(H[Cn])}},Ki.prototype._add=function(H,ve,Z){this._handlers.push({handlerName:H,handler:ve,allowed:Z}),this._handlersById[H]=ve},Ki.prototype.stop=function(){if(!this._updatingCamera){for(var H=0,ve=this._handlers;H<ve.length;H+=1){var Z=ve[H],pe=Z.handler;pe.reset()}this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Ki.prototype.isActive=function(){for(var H=0,ve=this._handlers;H<ve.length;H+=1){var Z=ve[H],pe=Z.handler;if(pe.isActive())return!0}return!1},Ki.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Ki.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Ki.prototype.isMoving=function(){return Boolean(Zo(this._eventsInProgress))||this.isZooming()},Ki.prototype._blockedByActive=function(H,ve,Z){for(var pe in H)if(pe!==Z&&(!ve||ve.indexOf(pe)<0))return!0;return!1},Ki.prototype.handleWindowEvent=function(H){this.handleEvent(H,H.type+"Window")},Ki.prototype._getMapTouches=function(H){for(var ve=[],Z=0,pe=H;Z<pe.length;Z+=1){var Se=pe[Z],Re=Se.target;this._el.contains(Re)&&ve.push(Se)}return ve},Ki.prototype.handleEvent=function(H,ve){if(H.type==="blur"){this.stop();return}this._updatingCamera=!0;for(var Z=H.type==="renderFrame"?void 0:H,pe={needsRenderFrame:!1},Se={},Re={},je=H.touches?this._getMapTouches(H.touches):void 0,ut=je?n.touchPos(this._el,je):n.mousePos(this._el,H),Et=0,Jt=this._handlers;Et<Jt.length;Et+=1){var lr=Jt[Et],vr=lr.handlerName,Cr=lr.handler,Hr=lr.allowed;if(!!Cr.isEnabled()){var Yr=void 0;this._blockedByActive(Re,Hr,vr)?Cr.reset():Cr[ve||H.type]&&(Yr=Cr[ve||H.type](H,ut,je),this.mergeHandlerResult(pe,Se,Yr,vr,Z),Yr&&Yr.needsRenderFrame&&this._triggerRenderFrame()),(Yr||Cr.isActive())&&(Re[vr]=Cr)}}var Ur={};for(var Jr in this._previousActiveHandlers)Re[Jr]||(Ur[Jr]=Z);this._previousActiveHandlers=Re,(Object.keys(Ur).length||Ul(pe))&&(this._changes.push([pe,Se,Ur]),this._triggerRenderFrame()),(Object.keys(Re).length||Ul(pe))&&this._map._stop(!0),this._updatingCamera=!1;var hn=pe.cameraAnimation;hn&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],hn(this._map))},Ki.prototype.mergeHandlerResult=function(H,ve,Z,pe,Se){if(!!Z){e.extend(H,Z);var Re={handlerName:pe,originalEvent:Z.originalEvent||Se};Z.zoomDelta!==void 0&&(ve.zoom=Re),Z.panDelta!==void 0&&(ve.drag=Re),Z.pitchDelta!==void 0&&(ve.pitch=Re),Z.bearingDelta!==void 0&&(ve.rotate=Re)}},Ki.prototype._applyChanges=function(){for(var H={},ve={},Z={},pe=0,Se=this._changes;pe<Se.length;pe+=1){var Re=Se[pe],je=Re[0],ut=Re[1],Et=Re[2];je.panDelta&&(H.panDelta=(H.panDelta||new e.Point(0,0))._add(je.panDelta)),je.zoomDelta&&(H.zoomDelta=(H.zoomDelta||0)+je.zoomDelta),je.bearingDelta&&(H.bearingDelta=(H.bearingDelta||0)+je.bearingDelta),je.pitchDelta&&(H.pitchDelta=(H.pitchDelta||0)+je.pitchDelta),je.around!==void 0&&(H.around=je.around),je.pinchAround!==void 0&&(H.pinchAround=je.pinchAround),je.noInertia&&(H.noInertia=je.noInertia),e.extend(ve,ut),e.extend(Z,Et)}this._updateMapTransform(H,ve,Z),this._changes=[]},Ki.prototype._updateMapTransform=function(H,ve,Z){var pe=this._map,Se=pe.transform;if(!Ul(H))return this._fireEvents(ve,Z);var Re=H.panDelta,je=H.zoomDelta,ut=H.bearingDelta,Et=H.pitchDelta,Jt=H.around,lr=H.pinchAround;lr!==void 0&&(Jt=lr),pe._stop(!0),Jt=Jt||pe.transform.centerPoint;var vr=Se.pointLocation(Re?Jt.sub(Re):Jt);ut&&(Se.bearing+=ut),Et&&(Se.pitch+=Et),je&&(Se.zoom+=je),Se.setLocationAtPoint(vr,Jt),this._map._update(),H.noInertia||this._inertia.record(H),this._fireEvents(ve,Z)},Ki.prototype._fireEvents=function(H,ve){var Z=this,pe=Zo(this._eventsInProgress),Se=Zo(H),Re={};for(var je in H){var ut=H[je],Et=ut.originalEvent;this._eventsInProgress[je]||(Re[je+"start"]=Et),this._eventsInProgress[je]=H[je]}!pe&&Se&&this._fireEvent("movestart",Se.originalEvent);for(var Jt in Re)this._fireEvent(Jt,Re[Jt]);H.rotate&&(this._bearingChanged=!0),Se&&this._fireEvent("move",Se.originalEvent);for(var lr in H){var vr=H[lr],Cr=vr.originalEvent;this._fireEvent(lr,Cr)}var Hr={},Yr;for(var Ur in this._eventsInProgress){var Jr=this._eventsInProgress[Ur],hn=Jr.handlerName,Cn=Jr.originalEvent;this._handlersById[hn].isActive()||(delete this._eventsInProgress[Ur],Yr=ve[hn]||Cn,Hr[Ur+"end"]=Yr)}for(var Fn in Hr)this._fireEvent(Fn,Hr[Fn]);var Kn=Zo(this._eventsInProgress);if((pe||Se)&&!Kn){this._updatingCamera=!0;var qn=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Qn=function(ca){return ca!==0&&-Z._bearingSnap<ca&&ca<Z._bearingSnap};qn?(Qn(qn.bearing||this._map.getBearing())&&(qn.bearing=0),this._map.easeTo(qn,{originalEvent:Yr})):(this._map.fire(new e.Event("moveend",{originalEvent:Yr})),Qn(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Ki.prototype._fireEvent=function(H,ve){this._map.fire(new e.Event(H,ve?{originalEvent:ve}:{}))},Ki.prototype._triggerRenderFrame=function(){var H=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(ve){delete H._frameId,H.handleEvent(new bs("renderFrame",{timeStamp:ve})),H._applyChanges()}))};var rf=function(fe){function H(ve,Z){fe.call(this),this._moving=!1,this._zooming=!1,this.transform=ve,this._bearingSnap=Z.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},H.prototype.setCenter=function(Z,pe){return this.jumpTo({center:Z},pe)},H.prototype.panBy=function(Z,pe,Se){return Z=e.Point.convert(Z).mult(-1),this.panTo(this.transform.center,e.extend({offset:Z},pe),Se)},H.prototype.panTo=function(Z,pe,Se){return this.easeTo(e.extend({center:Z},pe),Se)},H.prototype.getZoom=function(){return this.transform.zoom},H.prototype.setZoom=function(Z,pe){return this.jumpTo({zoom:Z},pe),this},H.prototype.zoomTo=function(Z,pe,Se){return this.easeTo(e.extend({zoom:Z},pe),Se)},H.prototype.zoomIn=function(Z,pe){return this.zoomTo(this.getZoom()+1,Z,pe),this},H.prototype.zoomOut=function(Z,pe){return this.zoomTo(this.getZoom()-1,Z,pe),this},H.prototype.getBearing=function(){return this.transform.bearing},H.prototype.setBearing=function(Z,pe){return this.jumpTo({bearing:Z},pe),this},H.prototype.getPadding=function(){return this.transform.padding},H.prototype.setPadding=function(Z,pe){return this.jumpTo({padding:Z},pe),this},H.prototype.rotateTo=function(Z,pe,Se){return this.easeTo(e.extend({bearing:Z},pe),Se)},H.prototype.resetNorth=function(Z,pe){return this.rotateTo(0,e.extend({duration:1e3},Z),pe),this},H.prototype.resetNorthPitch=function(Z,pe){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},Z),pe),this},H.prototype.snapToNorth=function(Z,pe){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(Z,pe):this},H.prototype.getPitch=function(){return this.transform.pitch},H.prototype.setPitch=function(Z,pe){return this.jumpTo({pitch:Z},pe),this},H.prototype.cameraForBounds=function(Z,pe){return Z=e.LngLatBounds.convert(Z),this._cameraForBoxAndBearing(Z.getNorthWest(),Z.getSouthEast(),0,pe)},H.prototype._cameraForBoxAndBearing=function(Z,pe,Se,Re){var je={top:0,bottom:0,right:0,left:0};if(Re=e.extend({padding:je,offset:[0,0],maxZoom:this.transform.maxZoom},Re),typeof Re.padding=="number"){var ut=Re.padding;Re.padding={top:ut,bottom:ut,right:ut,left:ut}}Re.padding=e.extend(je,Re.padding);var Et=this.transform,Jt=Et.padding,lr=Et.project(e.LngLat.convert(Z)),vr=Et.project(e.LngLat.convert(pe)),Cr=lr.rotate(-Se*Math.PI/180),Hr=vr.rotate(-Se*Math.PI/180),Yr=new e.Point(Math.max(Cr.x,Hr.x),Math.max(Cr.y,Hr.y)),Ur=new e.Point(Math.min(Cr.x,Hr.x),Math.min(Cr.y,Hr.y)),Jr=Yr.sub(Ur),hn=(Et.width-(Jt.left+Jt.right+Re.padding.left+Re.padding.right))/Jr.x,Cn=(Et.height-(Jt.top+Jt.bottom+Re.padding.top+Re.padding.bottom))/Jr.y;if(Cn<0||hn<0){e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}var Fn=Math.min(Et.scaleZoom(Et.scale*Math.min(hn,Cn)),Re.maxZoom),Kn=e.Point.convert(Re.offset),qn=(Re.padding.left-Re.padding.right)/2,Qn=(Re.padding.top-Re.padding.bottom)/2,ca=new e.Point(Kn.x+qn,Kn.y+Qn),ba=ca.mult(Et.scale/Et.zoomScale(Fn)),ya=Et.unproject(lr.add(vr).div(2).sub(ba));return{center:ya,zoom:Fn,bearing:Se}},H.prototype.fitBounds=function(Z,pe,Se){return this._fitInternal(this.cameraForBounds(Z,pe),pe,Se)},H.prototype.fitScreenCoordinates=function(Z,pe,Se,Re,je){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(Z)),this.transform.pointLocation(e.Point.convert(pe)),Se,Re),Re,je)},H.prototype._fitInternal=function(Z,pe,Se){return Z?(pe=e.extend(Z,pe),delete pe.padding,pe.linear?this.easeTo(pe,Se):this.flyTo(pe,Se)):this},H.prototype.jumpTo=function(Z,pe){this.stop();var Se=this.transform,Re=!1,je=!1,ut=!1;return"zoom"in Z&&Se.zoom!==+Z.zoom&&(Re=!0,Se.zoom=+Z.zoom),Z.center!==void 0&&(Se.center=e.LngLat.convert(Z.center)),"bearing"in Z&&Se.bearing!==+Z.bearing&&(je=!0,Se.bearing=+Z.bearing),"pitch"in Z&&Se.pitch!==+Z.pitch&&(ut=!0,Se.pitch=+Z.pitch),Z.padding!=null&&!Se.isPaddingEqual(Z.padding)&&(Se.padding=Z.padding),this.fire(new e.Event("movestart",pe)).fire(new e.Event("move",pe)),Re&&this.fire(new e.Event("zoomstart",pe)).fire(new e.Event("zoom",pe)).fire(new e.Event("zoomend",pe)),je&&this.fire(new e.Event("rotatestart",pe)).fire(new e.Event("rotate",pe)).fire(new e.Event("rotateend",pe)),ut&&this.fire(new e.Event("pitchstart",pe)).fire(new e.Event("pitch",pe)).fire(new e.Event("pitchend",pe)),this.fire(new e.Event("moveend",pe))},H.prototype.easeTo=function(Z,pe){var Se=this;this._stop(!1,Z.easeId),Z=e.extend({offset:[0,0],duration:500,easing:e.ease},Z),(Z.animate===!1||!Z.essential&&e.browser.prefersReducedMotion)&&(Z.duration=0);var Re=this.transform,je=this.getZoom(),ut=this.getBearing(),Et=this.getPitch(),Jt=this.getPadding(),lr="zoom"in Z?+Z.zoom:je,vr="bearing"in Z?this._normalizeBearing(Z.bearing,ut):ut,Cr="pitch"in Z?+Z.pitch:Et,Hr="padding"in Z?Z.padding:Re.padding,Yr=e.Point.convert(Z.offset),Ur=Re.centerPoint.add(Yr),Jr=Re.pointLocation(Ur),hn=e.LngLat.convert(Z.center||Jr);this._normalizeCenter(hn);var Cn=Re.project(Jr),Fn=Re.project(hn).sub(Cn),Kn=Re.zoomScale(lr-je),qn,Qn;Z.around&&(qn=e.LngLat.convert(Z.around),Qn=Re.locationPoint(qn));var ca={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||lr!==je,this._rotating=this._rotating||ut!==vr,this._pitching=this._pitching||Cr!==Et,this._padding=!Re.isPaddingEqual(Hr),this._easeId=Z.easeId,this._prepareEase(pe,Z.noMoveStart,ca),clearTimeout(this._easeEndTimeoutID),this._ease(function(ba){if(Se._zooming&&(Re.zoom=e.number(je,lr,ba)),Se._rotating&&(Re.bearing=e.number(ut,vr,ba)),Se._pitching&&(Re.pitch=e.number(Et,Cr,ba)),Se._padding&&(Re.interpolatePadding(Jt,Hr,ba),Ur=Re.centerPoint.add(Yr)),qn)Re.setLocationAtPoint(qn,Qn);else{var ya=Re.zoomScale(Re.zoom-je),Ta=lr>je?Math.min(2,Kn):Math.max(.5,Kn),Ca=Math.pow(Ta,1-ba),Va=Re.unproject(Cn.add(Fn.mult(ba*Ca)).mult(ya));Re.setLocationAtPoint(Re.renderWorldCopies?Va.wrap():Va,Ur)}Se._fireMoveEvents(pe)},function(ba){Se._afterEase(pe,ba)},Z),this},H.prototype._prepareEase=function(Z,pe,Se){Se===void 0&&(Se={}),this._moving=!0,!pe&&!Se.moving&&this.fire(new e.Event("movestart",Z)),this._zooming&&!Se.zooming&&this.fire(new e.Event("zoomstart",Z)),this._rotating&&!Se.rotating&&this.fire(new e.Event("rotatestart",Z)),this._pitching&&!Se.pitching&&this.fire(new e.Event("pitchstart",Z))},H.prototype._fireMoveEvents=function(Z){this.fire(new e.Event("move",Z)),this._zooming&&this.fire(new e.Event("zoom",Z)),this._rotating&&this.fire(new e.Event("rotate",Z)),this._pitching&&this.fire(new e.Event("pitch",Z))},H.prototype._afterEase=function(Z,pe){if(!(this._easeId&&pe&&this._easeId===pe)){delete this._easeId;var Se=this._zooming,Re=this._rotating,je=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,Se&&this.fire(new e.Event("zoomend",Z)),Re&&this.fire(new e.Event("rotateend",Z)),je&&this.fire(new e.Event("pitchend",Z)),this.fire(new e.Event("moveend",Z))}},H.prototype.flyTo=function(Z,pe){var Se=this;if(!Z.essential&&e.browser.prefersReducedMotion){var Re=e.pick(Z,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Re,pe)}this.stop(),Z=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},Z);var je=this.transform,ut=this.getZoom(),Et=this.getBearing(),Jt=this.getPitch(),lr=this.getPadding(),vr="zoom"in Z?e.clamp(+Z.zoom,je.minZoom,je.maxZoom):ut,Cr="bearing"in Z?this._normalizeBearing(Z.bearing,Et):Et,Hr="pitch"in Z?+Z.pitch:Jt,Yr="padding"in Z?Z.padding:je.padding,Ur=je.zoomScale(vr-ut),Jr=e.Point.convert(Z.offset),hn=je.centerPoint.add(Jr),Cn=je.pointLocation(hn),Fn=e.LngLat.convert(Z.center||Cn);this._normalizeCenter(Fn);var Kn=je.project(Cn),qn=je.project(Fn).sub(Kn),Qn=Z.curve,ca=Math.max(je.width,je.height),ba=ca/Ur,ya=qn.mag();if("minZoom"in Z){var Ta=e.clamp(Math.min(Z.minZoom,ut,vr),je.minZoom,je.maxZoom),Ca=ca/je.zoomScale(Ta-ut);Qn=Math.sqrt(Ca/ya*2)}var Va=Qn*Qn;function ni(ii){var wi=(ba*ba-ca*ca+(ii?-1:1)*Va*Va*ya*ya)/(2*(ii?ba:ca)*Va*ya);return Math.log(Math.sqrt(wi*wi+1)-wi)}function Li(ii){return(Math.exp(ii)-Math.exp(-ii))/2}function ui(ii){return(Math.exp(ii)+Math.exp(-ii))/2}function pi(ii){return Li(ii)/ui(ii)}var Ba=ni(0),Pi=function(ii){return ui(Ba)/ui(Ba+Qn*ii)},Fi=function(ii){return ca*((ui(Ba)*pi(Ba+Qn*ii)-Li(Ba))/Va)/ya},Ui=(ni(1)-Ba)/Qn;if(Math.abs(ya)<1e-6||!isFinite(Ui)){if(Math.abs(ca-ba)<1e-6)return this.easeTo(Z,pe);var _i=ba<ca?-1:1;Ui=Math.abs(Math.log(ba/ca))/Qn,Fi=function(){return 0},Pi=function(ii){return Math.exp(_i*Qn*ii)}}if("duration"in Z)Z.duration=+Z.duration;else{var Ji="screenSpeed"in Z?+Z.screenSpeed/Qn:+Z.speed;Z.duration=1e3*Ui/Ji}return Z.maxDuration&&Z.duration>Z.maxDuration&&(Z.duration=0),this._zooming=!0,this._rotating=Et!==Cr,this._pitching=Hr!==Jt,this._padding=!je.isPaddingEqual(Yr),this._prepareEase(pe,!1),this._ease(function(ii){var wi=ii*Ui,To=1/Pi(wi);je.zoom=ii===1?vr:ut+je.scaleZoom(To),Se._rotating&&(je.bearing=e.number(Et,Cr,ii)),Se._pitching&&(je.pitch=e.number(Jt,Hr,ii)),Se._padding&&(je.interpolatePadding(lr,Yr,ii),hn=je.centerPoint.add(Jr));var No=ii===1?Fn:je.unproject(Kn.add(qn.mult(Fi(wi))).mult(To));je.setLocationAtPoint(je.renderWorldCopies?No.wrap():No,hn),Se._fireMoveEvents(pe)},function(){return Se._afterEase(pe)},Z),this},H.prototype.isEasing=function(){return!!this._easeFrameId},H.prototype.stop=function(){return this._stop()},H.prototype._stop=function(Z,pe){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var Se=this._onEaseEnd;delete this._onEaseEnd,Se.call(this,pe)}if(!Z){var Re=this.handlers;Re&&Re.stop()}return this},H.prototype._ease=function(Z,pe,Se){Se.animate===!1||Se.duration===0?(Z(1),pe()):(this._easeStart=e.browser.now(),this._easeOptions=Se,this._onEaseFrame=Z,this._onEaseEnd=pe,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},H.prototype._renderFrameCallback=function(){var Z=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(Z)),Z<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},H.prototype._normalizeBearing=function(Z,pe){Z=e.wrap(Z,-180,180);var Se=Math.abs(Z-pe);return Math.abs(Z-360-pe)<Se&&(Z-=360),Math.abs(Z+360-pe)<Se&&(Z+=360),Z},H.prototype._normalizeCenter=function(Z){var pe=this.transform;if(!(!pe.renderWorldCopies||pe.lngRange)){var Se=Z.lng-pe.center.lng;Z.lng+=Se>180?-360:Se<-180?360:0}},H}(e.Evented),Ml=function(H){H===void 0&&(H={}),this.options=H,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Ml.prototype.getDefaultPosition=function(){return"bottom-right"},Ml.prototype.onAdd=function(H){var ve=this.options&&this.options.compact;return this._map=H,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),ve&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),ve===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ml.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ml.prototype._updateEditLink=function(){var H=this._editLink;H||(H=this._editLink=this._container.querySelector(".mapbox-improve-map"));var ve=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(H){var Z=ve.reduce(function(pe,Se,Re){return Se.value&&(pe+=Se.key+"="+Se.value+(Re<ve.length-1?"&":"")),pe},"?");H.href=e.config.FEEDBACK_URL+"/"+Z+(this._map._hash?this._map._hash.getHashString(!0):""),H.rel="noopener nofollow"}},Ml.prototype._updateData=function(H){H&&(H.sourceDataType==="metadata"||H.dataType==="style")&&(this._updateAttributions(),this._updateEditLink())},Ml.prototype._updateAttributions=function(){if(!!this._map.style){var H=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?H=H.concat(this.options.customAttribution.map(function(ut){return typeof ut!="string"?"":ut})):typeof this.options.customAttribution=="string"&&H.push(this.options.customAttribution)),this._map.style.stylesheet){var ve=this._map.style.stylesheet;this.styleOwner=ve.owner,this.styleId=ve.id}var Z=this._map.style.sourceCaches;for(var pe in Z){var Se=Z[pe];if(Se.used){var Re=Se.getSource();Re.attribution&&H.indexOf(Re.attribution)<0&&H.push(Re.attribution)}}H.sort(function(ut,Et){return ut.length-Et.length}),H=H.filter(function(ut,Et){for(var Jt=Et+1;Jt<H.length;Jt++)if(H[Jt].indexOf(ut)>=0)return!1;return!0});var je=H.join(" | ");je!==this._attribHTML&&(this._attribHTML=je,H.length?(this._innerContainer.innerHTML=je,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ml.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Bi=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};Bi.prototype.onAdd=function(H){this._map=H,this._container=n.create("div","mapboxgl-ctrl");var ve=n.create("a","mapboxgl-ctrl-logo");return ve.target="_blank",ve.rel="noopener nofollow",ve.href="https://www.mapbox.com/",ve.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),ve.setAttribute("rel","noopener nofollow"),this._container.appendChild(ve),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Bi.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Bi.prototype.getDefaultPosition=function(){return"bottom-left"},Bi.prototype._updateLogo=function(H){(!H||H.sourceDataType==="metadata")&&(this._container.style.display=this._logoRequired()?"block":"none")},Bi.prototype._logoRequired=function(){if(!!this._map.style){var H=this._map.style.sourceCaches;for(var ve in H){var Z=H[ve].getSource();if(Z.mapbox_logo)return!0}return!1}},Bi.prototype._updateCompact=function(){var H=this._container.children;if(H.length){var ve=H[0];this._map.getCanvasContainer().offsetWidth<250?ve.classList.add("mapboxgl-compact"):ve.classList.remove("mapboxgl-compact")}};var Io=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Io.prototype.add=function(H){var ve=++this._id,Z=this._queue;return Z.push({callback:H,id:ve,cancelled:!1}),ve},Io.prototype.remove=function(H){for(var ve=this._currentlyRunning,Z=ve?this._queue.concat(ve):this._queue,pe=0,Se=Z;pe<Se.length;pe+=1){var Re=Se[pe];if(Re.id===H){Re.cancelled=!0;return}}},Io.prototype.run=function(H){H===void 0&&(H=0);var ve=this._currentlyRunning=this._queue;this._queue=[];for(var Z=0,pe=ve;Z<pe.length;Z+=1){var Se=pe[Z];if(!Se.cancelled&&(Se.callback(H),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Io.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var lh={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Cf=e.window.HTMLImageElement,yf=e.window.HTMLElement,Ou=e.window.ImageBitmap,nf=-2,Lf=22,Bs=0,Bu=60,ac={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:nf,maxZoom:Lf,minPitch:Bs,maxPitch:Bu,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ic=function(fe){function H(Z){var pe=this;if(Z=e.extend({},ac,Z),Z.minZoom!=null&&Z.maxZoom!=null&&Z.minZoom>Z.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(Z.minPitch!=null&&Z.maxPitch!=null&&Z.minPitch>Z.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(Z.minPitch!=null&&Z.minPitch<Bs)throw new Error("minPitch must be greater than or equal to "+Bs);if(Z.maxPitch!=null&&Z.maxPitch>Bu)throw new Error("maxPitch must be less than or equal to "+Bu);var Se=new bi(Z.minZoom,Z.maxZoom,Z.minPitch,Z.maxPitch,Z.renderWorldCopies);if(fe.call(this,Se,Z),this._interactive=Z.interactive,this._maxTileCacheSize=Z.maxTileCacheSize,this._failIfMajorPerformanceCaveat=Z.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=Z.preserveDrawingBuffer,this._antialias=Z.antialias,this._trackResize=Z.trackResize,this._bearingSnap=Z.bearingSnap,this._refreshExpiredTiles=Z.refreshExpiredTiles,this._fadeDuration=Z.fadeDuration,this._crossSourceCollisions=Z.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=Z.collectResourceTiming,this._renderTaskQueue=new Io,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},lh,Z.locale),this._requestManager=new e.RequestManager(Z.transformRequest,Z.accessToken),typeof Z.container=="string"){if(this._container=e.window.document.getElementById(Z.container),!this._container)throw new Error("Container '"+Z.container+"' not found.")}else if(Z.container instanceof yf)this._container=Z.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(Z.maxBounds&&this.setMaxBounds(Z.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return pe._update(!1)}),this.on("moveend",function(){return pe._update(!1)}),this.on("zoom",function(){return pe._update(!0)}),typeof e.window<"u"&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Ki(this,Z);var Re=typeof Z.hash=="string"&&Z.hash||void 0;this._hash=Z.hash&&new yo(Re).addTo(this),(!this._hash||!this._hash._onHashChange())&&(this.jumpTo({center:Z.center,zoom:Z.zoom,bearing:Z.bearing,pitch:Z.pitch}),Z.bounds&&(this.resize(),this.fitBounds(Z.bounds,e.extend({},Z.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=Z.localIdeographFontFamily,Z.style&&this.setStyle(Z.style,{localIdeographFontFamily:Z.localIdeographFontFamily}),Z.attributionControl&&this.addControl(new Ml({customAttribution:Z.customAttribution})),this.addControl(new Bi,Z.logoPosition),this.on("style.load",function(){pe.transform.unmodified&&pe.jumpTo(pe.style.stylesheet)}),this.on("data",function(je){pe._update(je.dataType==="style"),pe.fire(new e.Event(je.dataType+"data",je))}),this.on("dataloading",function(je){pe.fire(new e.Event(je.dataType+"dataloading",je))})}fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H;var ve={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return H.prototype._getMapId=function(){return this._mapId},H.prototype.addControl=function(pe,Se){if(Se===void 0&&pe.getDefaultPosition&&(Se=pe.getDefaultPosition()),Se===void 0&&(Se="top-right"),!pe||!pe.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var Re=pe.onAdd(this);this._controls.push(pe);var je=this._controlPositions[Se];return Se.indexOf("bottom")!==-1?je.insertBefore(Re,je.firstChild):je.appendChild(Re),this},H.prototype.removeControl=function(pe){if(!pe||!pe.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var Se=this._controls.indexOf(pe);return Se>-1&&this._controls.splice(Se,1),pe.onRemove(this),this},H.prototype.resize=function(pe){var Se=this._containerDimensions(),Re=Se[0],je=Se[1];this._resizeCanvas(Re,je),this.transform.resize(Re,je),this.painter.resize(Re,je);var ut=!this._moving;return ut&&(this.stop(),this.fire(new e.Event("movestart",pe)).fire(new e.Event("move",pe))),this.fire(new e.Event("resize",pe)),ut&&this.fire(new e.Event("moveend",pe)),this},H.prototype.getBounds=function(){return this.transform.getBounds()},H.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},H.prototype.setMaxBounds=function(pe){return this.transform.setMaxBounds(e.LngLatBounds.convert(pe)),this._update()},H.prototype.setMinZoom=function(pe){if(pe=pe==null?nf:pe,pe>=nf&&pe<=this.transform.maxZoom)return this.transform.minZoom=pe,this._update(),this.getZoom()<pe&&this.setZoom(pe),this;throw new Error("minZoom must be between "+nf+" and the current maxZoom, inclusive")},H.prototype.getMinZoom=function(){return this.transform.minZoom},H.prototype.setMaxZoom=function(pe){if(pe=pe==null?Lf:pe,pe>=this.transform.minZoom)return this.transform.maxZoom=pe,this._update(),this.getZoom()>pe&&this.setZoom(pe),this;throw new Error("maxZoom must be greater than the current minZoom")},H.prototype.getMaxZoom=function(){return this.transform.maxZoom},H.prototype.setMinPitch=function(pe){if(pe=pe==null?Bs:pe,pe<Bs)throw new Error("minPitch must be greater than or equal to "+Bs);if(pe>=Bs&&pe<=this.transform.maxPitch)return this.transform.minPitch=pe,this._update(),this.getPitch()<pe&&this.setPitch(pe),this;throw new Error("minPitch must be between "+Bs+" and the current maxPitch, inclusive")},H.prototype.getMinPitch=function(){return this.transform.minPitch},H.prototype.setMaxPitch=function(pe){if(pe=pe==null?Bu:pe,pe>Bu)throw new Error("maxPitch must be less than or equal to "+Bu);if(pe>=this.transform.minPitch)return this.transform.maxPitch=pe,this._update(),this.getPitch()>pe&&this.setPitch(pe),this;throw new Error("maxPitch must be greater than the current minPitch")},H.prototype.getMaxPitch=function(){return this.transform.maxPitch},H.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},H.prototype.setRenderWorldCopies=function(pe){return this.transform.renderWorldCopies=pe,this._update()},H.prototype.project=function(pe){return this.transform.locationPoint(e.LngLat.convert(pe))},H.prototype.unproject=function(pe){return this.transform.pointLocation(e.Point.convert(pe))},H.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},H.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},H.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},H.prototype._createDelegatedListener=function(pe,Se,Re){var je=this,ut;if(pe==="mouseenter"||pe==="mouseover"){var Et=!1,Jt=function(Ur){var Jr=je.getLayer(Se)?je.queryRenderedFeatures(Ur.point,{layers:[Se]}):[];Jr.length?Et||(Et=!0,Re.call(je,new xt(pe,je,Ur.originalEvent,{features:Jr}))):Et=!1},lr=function(){Et=!1};return{layer:Se,listener:Re,delegates:{mousemove:Jt,mouseout:lr}}}else if(pe==="mouseleave"||pe==="mouseout"){var vr=!1,Cr=function(Ur){var Jr=je.getLayer(Se)?je.queryRenderedFeatures(Ur.point,{layers:[Se]}):[];Jr.length?vr=!0:vr&&(vr=!1,Re.call(je,new xt(pe,je,Ur.originalEvent)))},Hr=function(Ur){vr&&(vr=!1,Re.call(je,new xt(pe,je,Ur.originalEvent)))};return{layer:Se,listener:Re,delegates:{mousemove:Cr,mouseout:Hr}}}else{var Yr=function(Ur){var Jr=je.getLayer(Se)?je.queryRenderedFeatures(Ur.point,{layers:[Se]}):[];Jr.length&&(Ur.features=Jr,Re.call(je,Ur),delete Ur.features)};return{layer:Se,listener:Re,delegates:(ut={},ut[pe]=Yr,ut)}}},H.prototype.on=function(pe,Se,Re){if(Re===void 0)return fe.prototype.on.call(this,pe,Se);var je=this._createDelegatedListener(pe,Se,Re);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[pe]=this._delegatedListeners[pe]||[],this._delegatedListeners[pe].push(je);for(var ut in je.delegates)this.on(ut,je.delegates[ut]);return this},H.prototype.once=function(pe,Se,Re){if(Re===void 0)return fe.prototype.once.call(this,pe,Se);var je=this._createDelegatedListener(pe,Se,Re);for(var ut in je.delegates)this.once(ut,je.delegates[ut]);return this},H.prototype.off=function(pe,Se,Re){var je=this;if(Re===void 0)return fe.prototype.off.call(this,pe,Se);var ut=function(Et){for(var Jt=Et[pe],lr=0;lr<Jt.length;lr++){var vr=Jt[lr];if(vr.layer===Se&&vr.listener===Re){for(var Cr in vr.delegates)je.off(Cr,vr.delegates[Cr]);return Jt.splice(lr,1),je}}};return this._delegatedListeners&&this._delegatedListeners[pe]&&ut(this._delegatedListeners),this},H.prototype.queryRenderedFeatures=function(pe,Se){if(!this.style)return[];Se===void 0&&pe!==void 0&&!(pe instanceof e.Point)&&!Array.isArray(pe)&&(Se=pe,pe=void 0),Se=Se||{},pe=pe||[[0,0],[this.transform.width,this.transform.height]];var Re;if(pe instanceof e.Point||typeof pe[0]=="number")Re=[e.Point.convert(pe)];else{var je=e.Point.convert(pe[0]),ut=e.Point.convert(pe[1]);Re=[je,new e.Point(ut.x,je.y),ut,new e.Point(je.x,ut.y),je]}return this.style.queryRenderedFeatures(Re,Se,this.transform)},H.prototype.querySourceFeatures=function(pe,Se){return this.style.querySourceFeatures(pe,Se)},H.prototype.setStyle=function(pe,Se){return Se=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},Se),Se.diff!==!1&&Se.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&pe?(this._diffStyle(pe,Se),this):(this._localIdeographFontFamily=Se.localIdeographFontFamily,this._updateStyle(pe,Se))},H.prototype._getUIString=function(pe){var Se=this._locale[pe];if(Se==null)throw new Error("Missing UI string '"+pe+"'");return Se},H.prototype._updateStyle=function(pe,Se){if(this.style&&(this.style.setEventedParent(null),this.style._remove()),pe)this.style=new Ko(this,Se||{});else return delete this.style,this;return this.style.setEventedParent(this,{style:this.style}),typeof pe=="string"?this.style.loadURL(pe):this.style.loadJSON(pe),this},H.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ko(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},H.prototype._diffStyle=function(pe,Se){var Re=this;if(typeof pe=="string"){var je=this._requestManager.normalizeStyleURL(pe),ut=this._requestManager.transformRequest(je,e.ResourceType.Style);e.getJSON(ut,function(Et,Jt){Et?Re.fire(new e.ErrorEvent(Et)):Jt&&Re._updateDiff(Jt,Se)})}else typeof pe=="object"&&this._updateDiff(pe,Se)},H.prototype._updateDiff=function(pe,Se){try{this.style.setState(pe)&&this._update(!0)}catch(Re){e.warnOnce("Unable to perform style diff: "+(Re.message||Re.error||Re)+".  Rebuilding the style from scratch."),this._updateStyle(pe,Se)}},H.prototype.getStyle=function(){if(this.style)return this.style.serialize()},H.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},H.prototype.addSource=function(pe,Se){return this._lazyInitEmptyStyle(),this.style.addSource(pe,Se),this._update(!0)},H.prototype.isSourceLoaded=function(pe){var Se=this.style&&this.style.sourceCaches[pe];if(Se===void 0){this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+pe+"'")));return}return Se.loaded()},H.prototype.areTilesLoaded=function(){var pe=this.style&&this.style.sourceCaches;for(var Se in pe){var Re=pe[Se],je=Re._tiles;for(var ut in je){var Et=je[ut];if(!(Et.state==="loaded"||Et.state==="errored"))return!1}}return!0},H.prototype.addSourceType=function(pe,Se,Re){return this._lazyInitEmptyStyle(),this.style.addSourceType(pe,Se,Re)},H.prototype.removeSource=function(pe){return this.style.removeSource(pe),this._update(!0)},H.prototype.getSource=function(pe){return this.style.getSource(pe)},H.prototype.addImage=function(pe,Se,Re){Re===void 0&&(Re={});var je=Re.pixelRatio;je===void 0&&(je=1);var ut=Re.sdf;ut===void 0&&(ut=!1);var Et=Re.stretchX,Jt=Re.stretchY,lr=Re.content;this._lazyInitEmptyStyle();var vr=0;if(Se instanceof Cf||Ou&&Se instanceof Ou){var Cr=e.browser.getImageData(Se),Hr=Cr.width,Yr=Cr.height,Ur=Cr.data;this.style.addImage(pe,{data:new e.RGBAImage({width:Hr,height:Yr},Ur),pixelRatio:je,stretchX:Et,stretchY:Jt,content:lr,sdf:ut,version:vr})}else{if(Se.width===void 0||Se.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Jr=Se.width,hn=Se.height,Cn=Se.data,Fn=Se;this.style.addImage(pe,{data:new e.RGBAImage({width:Jr,height:hn},new Uint8Array(Cn)),pixelRatio:je,stretchX:Et,stretchY:Jt,content:lr,sdf:ut,version:vr,userImage:Fn}),Fn.onAdd&&Fn.onAdd(this,pe)}},H.prototype.updateImage=function(pe,Se){var Re=this.style.getImage(pe);if(!Re)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var je=Se instanceof Cf||Ou&&Se instanceof Ou?e.browser.getImageData(Se):Se,ut=je.width,Et=je.height,Jt=je.data;if(ut===void 0||Et===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(ut!==Re.data.width||Et!==Re.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var lr=!(Se instanceof Cf||Ou&&Se instanceof Ou);Re.data.replace(Jt,lr),this.style.updateImage(pe,Re)},H.prototype.hasImage=function(pe){return pe?!!this.style.getImage(pe):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},H.prototype.removeImage=function(pe){this.style.removeImage(pe)},H.prototype.loadImage=function(pe,Se){e.getImage(this._requestManager.transformRequest(pe,e.ResourceType.Image),Se)},H.prototype.listImages=function(){return this.style.listImages()},H.prototype.addLayer=function(pe,Se){return this._lazyInitEmptyStyle(),this.style.addLayer(pe,Se),this._update(!0)},H.prototype.moveLayer=function(pe,Se){return this.style.moveLayer(pe,Se),this._update(!0)},H.prototype.removeLayer=function(pe){return this.style.removeLayer(pe),this._update(!0)},H.prototype.getLayer=function(pe){return this.style.getLayer(pe)},H.prototype.setLayerZoomRange=function(pe,Se,Re){return this.style.setLayerZoomRange(pe,Se,Re),this._update(!0)},H.prototype.setFilter=function(pe,Se,Re){return Re===void 0&&(Re={}),this.style.setFilter(pe,Se,Re),this._update(!0)},H.prototype.getFilter=function(pe){return this.style.getFilter(pe)},H.prototype.setPaintProperty=function(pe,Se,Re,je){return je===void 0&&(je={}),this.style.setPaintProperty(pe,Se,Re,je),this._update(!0)},H.prototype.getPaintProperty=function(pe,Se){return this.style.getPaintProperty(pe,Se)},H.prototype.setLayoutProperty=function(pe,Se,Re,je){return je===void 0&&(je={}),this.style.setLayoutProperty(pe,Se,Re,je),this._update(!0)},H.prototype.getLayoutProperty=function(pe,Se){return this.style.getLayoutProperty(pe,Se)},H.prototype.setLight=function(pe,Se){return Se===void 0&&(Se={}),this._lazyInitEmptyStyle(),this.style.setLight(pe,Se),this._update(!0)},H.prototype.getLight=function(){return this.style.getLight()},H.prototype.setFeatureState=function(pe,Se){return this.style.setFeatureState(pe,Se),this._update()},H.prototype.removeFeatureState=function(pe,Se){return this.style.removeFeatureState(pe,Se),this._update()},H.prototype.getFeatureState=function(pe){return this.style.getFeatureState(pe)},H.prototype.getContainer=function(){return this._container},H.prototype.getCanvasContainer=function(){return this._canvasContainer},H.prototype.getCanvas=function(){return this._canvas},H.prototype._containerDimensions=function(){var pe=0,Se=0;return this._container&&(pe=this._container.clientWidth||400,Se=this._container.clientHeight||300),[pe,Se]},H.prototype._detectMissingCSS=function(){var pe=e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color");pe!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},H.prototype._setupContainer=function(){var pe=this._container;pe.classList.add("mapboxgl-map");var Se=this._missingCSSCanary=n.create("div","mapboxgl-canary",pe);Se.style.visibility="hidden",this._detectMissingCSS();var Re=this._canvasContainer=n.create("div","mapboxgl-canvas-container",pe);this._interactive&&Re.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",Re),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var je=this._containerDimensions();this._resizeCanvas(je[0],je[1]);var ut=this._controlContainer=n.create("div","mapboxgl-control-container",pe),Et=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Jt){Et[Jt]=n.create("div","mapboxgl-ctrl-"+Jt,ut)})},H.prototype._resizeCanvas=function(pe,Se){var Re=e.browser.devicePixelRatio||1;this._canvas.width=Re*pe,this._canvas.height=Re*Se,this._canvas.style.width=pe+"px",this._canvas.style.height=Se+"px"},H.prototype._setupPainter=function(){var pe=e.extend({},a.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),Se=this._canvas.getContext("webgl",pe)||this._canvas.getContext("experimental-webgl",pe);if(!Se){this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")));return}this.painter=new ri(Se,this.transform),e.webpSupported.testSupport(Se)},H.prototype._contextLost=function(pe){pe.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:pe}))},H.prototype._contextRestored=function(pe){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:pe}))},H.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},H.prototype._update=function(pe){return this.style?(this._styleDirty=this._styleDirty||pe,this._sourcesDirty=!0,this.triggerRepaint(),this):this},H.prototype._requestRenderFrame=function(pe){return this._update(),this._renderTaskQueue.add(pe)},H.prototype._cancelRenderFrame=function(pe){this._renderTaskQueue.remove(pe)},H.prototype._render=function(pe){var Se=this,Re,je=0,ut=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(Re=ut.createQueryEXT(),ut.beginQueryEXT(ut.TIME_ELAPSED_EXT,Re),je=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(pe),!this._removed){var Et=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Jt=this.transform.zoom,lr=e.browser.now();this.style.zoomHistory.update(Jt,lr);var vr=new e.EvaluationParameters(Jt,{now:lr,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Cr=vr.crossFadingFactor();(Cr!==1||Cr!==this._crossFadingFactor)&&(Et=!0,this._crossFadingFactor=Cr),this.style.update(vr)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||Et)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Hr=e.browser.now()-je;ut.endQueryEXT(ut.TIME_ELAPSED_EXT,Re),setTimeout(function(){var Jr=ut.getQueryObjectEXT(Re,ut.QUERY_RESULT_EXT)/1e6;ut.deleteQueryEXT(Re),Se.fire(new e.Event("gpu-timing-frame",{cpuTime:Hr,gpuTime:Jr}))},50)}if(this.listens("gpu-timing-layer")){var Yr=this.painter.collectGpuTimers();setTimeout(function(){var Jr=Se.painter.queryGpuTimers(Yr);Se.fire(new e.Event("gpu-timing-layer",{layerTimes:Jr}))},50)}var Ur=this._sourcesDirty||this._styleDirty||this._placementDirty;return Ur||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},H.prototype.remove=function(){this._hash&&this._hash.remove();for(var pe=0,Se=this._controls;pe<Se.length;pe+=1){var Re=Se[pe];Re.onRemove(this)}this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof e.window<"u"&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var je=this.painter.context.gl.getExtension("WEBGL_lose_context");je&&je.loseContext(),mf(this._canvasContainer),mf(this._controlContainer),mf(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},H.prototype.triggerRepaint=function(){var pe=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(Se){pe._frame=null,pe._render(Se)}))},H.prototype._onWindowOnline=function(){this._update()},H.prototype._onWindowResize=function(pe){this._trackResize&&this.resize({originalEvent:pe})._update()},ve.showTileBoundaries.get=function(){return!!this._showTileBoundaries},ve.showTileBoundaries.set=function(Z){this._showTileBoundaries!==Z&&(this._showTileBoundaries=Z,this._update())},ve.showPadding.get=function(){return!!this._showPadding},ve.showPadding.set=function(Z){this._showPadding!==Z&&(this._showPadding=Z,this._update())},ve.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},ve.showCollisionBoxes.set=function(Z){this._showCollisionBoxes!==Z&&(this._showCollisionBoxes=Z,Z?this.style._generateCollisionBoxes():this._update())},ve.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},ve.showOverdrawInspector.set=function(Z){this._showOverdrawInspector!==Z&&(this._showOverdrawInspector=Z,this._update())},ve.repaint.get=function(){return!!this._repaint},ve.repaint.set=function(Z){this._repaint!==Z&&(this._repaint=Z,this.triggerRepaint())},ve.vertices.get=function(){return!!this._vertices},ve.vertices.set=function(Z){this._vertices=Z,this._update()},H.prototype._setCacheLimits=function(pe,Se){e.setCacheLimits(pe,Se)},ve.version.get=function(){return e.version},Object.defineProperties(H.prototype,ve),H}(rf);function mf(fe){fe.parentNode&&fe.parentNode.removeChild(fe)}var Pf={showCompass:!0,showZoom:!0,visualizePitch:!1},xu=function(H){var ve=this;this.options=e.extend({},Pf,H),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(Z){return Z.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(Z){return ve._map.zoomIn({},{originalEvent:Z})}),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(Z){return ve._map.zoomOut({},{originalEvent:Z})}),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(Z){ve.options.visualizePitch?ve._map.resetNorthPitch({},{originalEvent:Z}):ve._map.resetNorth({},{originalEvent:Z})}),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};xu.prototype._updateZoomButtons=function(){var H=this._map.getZoom();this._zoomInButton.disabled=H===this._map.getMaxZoom(),this._zoomOutButton.disabled=H===this._map.getMinZoom()},xu.prototype._rotateCompassArrow=function(){var H=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=H},xu.prototype.onAdd=function(H){return this._map=H,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new $s(this._map,this._compass,this.options.visualizePitch)),this._container},xu.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},xu.prototype._createButton=function(H,ve){var Z=n.create("button",H,this._container);return Z.type="button",Z.addEventListener("click",ve),Z},xu.prototype._setButtonTitle=function(H,ve){var Z=this._map._getUIString("NavigationControl."+ve);H.title=Z,H.setAttribute("aria-label",Z)};var $s=function(H,ve,Z){Z===void 0&&(Z=!1),this._clickTolerance=10,this.element=ve,this.mouseRotate=new ia({clickTolerance:H.dragRotate._mouseRotate._clickTolerance}),this.map=H,Z&&(this.mousePitch=new ka({clickTolerance:H.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener(ve,"mousedown",this.mousedown),n.addEventListener(ve,"touchstart",this.touchstart,{passive:!1}),n.addEventListener(ve,"touchmove",this.touchmove),n.addEventListener(ve,"touchend",this.touchend),n.addEventListener(ve,"touchcancel",this.reset)};$s.prototype.down=function(H,ve){this.mouseRotate.mousedown(H,ve),this.mousePitch&&this.mousePitch.mousedown(H,ve),n.disableDrag()},$s.prototype.move=function(H,ve){var Z=this.map,pe=this.mouseRotate.mousemoveWindow(H,ve);if(pe&&pe.bearingDelta&&Z.setBearing(Z.getBearing()+pe.bearingDelta),this.mousePitch){var Se=this.mousePitch.mousemoveWindow(H,ve);Se&&Se.pitchDelta&&Z.setPitch(Z.getPitch()+Se.pitchDelta)}},$s.prototype.off=function(){var H=this.element;n.removeEventListener(H,"mousedown",this.mousedown),n.removeEventListener(H,"touchstart",this.touchstart,{passive:!1}),n.removeEventListener(H,"touchmove",this.touchmove),n.removeEventListener(H,"touchend",this.touchend),n.removeEventListener(H,"touchcancel",this.reset),this.offTemp()},$s.prototype.offTemp=function(){n.enableDrag(),n.removeEventListener(e.window,"mousemove",this.mousemove),n.removeEventListener(e.window,"mouseup",this.mouseup)},$s.prototype.mousedown=function(H){this.down(e.extend({},H,{ctrlKey:!0,preventDefault:function(){return H.preventDefault()}}),n.mousePos(this.element,H)),n.addEventListener(e.window,"mousemove",this.mousemove),n.addEventListener(e.window,"mouseup",this.mouseup)},$s.prototype.mousemove=function(H){this.move(H,n.mousePos(this.element,H))},$s.prototype.mouseup=function(H){this.mouseRotate.mouseupWindow(H),this.mousePitch&&this.mousePitch.mouseupWindow(H),this.offTemp()},$s.prototype.touchstart=function(H){H.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=n.touchPos(this.element,H.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return H.preventDefault()}},this._startPos))},$s.prototype.touchmove=function(H){H.targetTouches.length!==1?this.reset():(this._lastPos=n.touchPos(this.element,H.targetTouches)[0],this.move({preventDefault:function(){return H.preventDefault()}},this._lastPos))},$s.prototype.touchend=function(H){H.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},$s.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};function bu(fe,H,ve){if(fe=new e.LngLat(fe.lng,fe.lat),H){var Z=new e.LngLat(fe.lng-360,fe.lat),pe=new e.LngLat(fe.lng+360,fe.lat),Se=ve.locationPoint(fe).distSqr(H);ve.locationPoint(Z).distSqr(H)<Se?fe=Z:ve.locationPoint(pe).distSqr(H)<Se&&(fe=pe)}for(;Math.abs(fe.lng-ve.center.lng)>180;){var Re=ve.locationPoint(fe);if(Re.x>=0&&Re.y>=0&&Re.x<=ve.width&&Re.y<=ve.height)break;fe.lng>ve.center.lng?fe.lng-=360:fe.lng+=360}return fe}var xf={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Df(fe,H,ve){var Z=fe.classList;for(var pe in xf)Z.remove("mapboxgl-"+ve+"-anchor-"+pe);Z.add("mapboxgl-"+ve+"-anchor-"+H)}var af=function(fe){function H(ve,Z){var pe=this;if(fe.call(this),(ve instanceof e.window.HTMLElement||Z)&&(ve=e.extend({element:ve},Z)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=ve&&ve.anchor||"center",this._color=ve&&ve.color||"#3FB1CE",this._draggable=ve&&ve.draggable||!1,this._state="inactive",this._rotation=ve&&ve.rotation||0,this._rotationAlignment=ve&&ve.rotationAlignment||"auto",this._pitchAlignment=ve&&ve.pitchAlignment&&ve.pitchAlignment!=="auto"?ve.pitchAlignment:this._rotationAlignment,!ve||!ve.element){this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var Se=n.createNS("http://www.w3.org/2000/svg","svg");Se.setAttributeNS(null,"display","block"),Se.setAttributeNS(null,"height","41px"),Se.setAttributeNS(null,"width","27px"),Se.setAttributeNS(null,"viewBox","0 0 27 41");var Re=n.createNS("http://www.w3.org/2000/svg","g");Re.setAttributeNS(null,"stroke","none"),Re.setAttributeNS(null,"stroke-width","1"),Re.setAttributeNS(null,"fill","none"),Re.setAttributeNS(null,"fill-rule","evenodd");var je=n.createNS("http://www.w3.org/2000/svg","g");je.setAttributeNS(null,"fill-rule","nonzero");var ut=n.createNS("http://www.w3.org/2000/svg","g");ut.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ut.setAttributeNS(null,"fill","#000000");for(var Et=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}],Jt=0,lr=Et;Jt<lr.length;Jt+=1){var vr=lr[Jt],Cr=n.createNS("http://www.w3.org/2000/svg","ellipse");Cr.setAttributeNS(null,"opacity","0.04"),Cr.setAttributeNS(null,"cx","10.5"),Cr.setAttributeNS(null,"cy","5.80029008"),Cr.setAttributeNS(null,"rx",vr.rx),Cr.setAttributeNS(null,"ry",vr.ry),ut.appendChild(Cr)}var Hr=n.createNS("http://www.w3.org/2000/svg","g");Hr.setAttributeNS(null,"fill",this._color);var Yr=n.createNS("http://www.w3.org/2000/svg","path");Yr.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Hr.appendChild(Yr);var Ur=n.createNS("http://www.w3.org/2000/svg","g");Ur.setAttributeNS(null,"opacity","0.25"),Ur.setAttributeNS(null,"fill","#000000");var Jr=n.createNS("http://www.w3.org/2000/svg","path");Jr.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ur.appendChild(Jr);var hn=n.createNS("http://www.w3.org/2000/svg","g");hn.setAttributeNS(null,"transform","translate(6.0, 7.0)"),hn.setAttributeNS(null,"fill","#FFFFFF");var Cn=n.createNS("http://www.w3.org/2000/svg","g");Cn.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Fn=n.createNS("http://www.w3.org/2000/svg","circle");Fn.setAttributeNS(null,"fill","#000000"),Fn.setAttributeNS(null,"opacity","0.25"),Fn.setAttributeNS(null,"cx","5.5"),Fn.setAttributeNS(null,"cy","5.5"),Fn.setAttributeNS(null,"r","5.4999962");var Kn=n.createNS("http://www.w3.org/2000/svg","circle");Kn.setAttributeNS(null,"fill","#FFFFFF"),Kn.setAttributeNS(null,"cx","5.5"),Kn.setAttributeNS(null,"cy","5.5"),Kn.setAttributeNS(null,"r","5.4999962"),Cn.appendChild(Fn),Cn.appendChild(Kn),je.appendChild(ut),je.appendChild(Hr),je.appendChild(Ur),je.appendChild(hn),je.appendChild(Cn),Se.appendChild(je),this._element.appendChild(Se),this._offset=e.Point.convert(ve&&ve.offset||[0,-14])}else this._element=ve.element,this._offset=e.Point.convert(ve&&ve.offset||[0,0]);this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(qn){qn.preventDefault()}),this._element.addEventListener("mousedown",function(qn){qn.preventDefault()}),this._element.addEventListener("focus",function(){var qn=pe._map.getContainer();qn.scrollTop=0,qn.scrollLeft=0}),Df(this._element,this._anchor,"marker"),this._popup=null}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.addTo=function(Z){return this.remove(),this._map=Z,Z.getCanvasContainer().appendChild(this._element),Z.on("move",this._update),Z.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},H.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},H.prototype.getLngLat=function(){return this._lngLat},H.prototype.setLngLat=function(Z){return this._lngLat=e.LngLat.convert(Z),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},H.prototype.getElement=function(){return this._element},H.prototype.setPopup=function(Z){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),Z){if(!("offset"in Z.options)){var pe=38.1,Se=13.5,Re=Math.sqrt(Math.pow(Se,2)/2);Z.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-pe],"bottom-left":[Re,(pe-Se+Re)*-1],"bottom-right":[-Re,(pe-Se+Re)*-1],left:[Se,(pe-Se)*-1],right:[-Se,(pe-Se)*-1]}:this._offset}this._popup=Z,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},H.prototype._onKeyPress=function(Z){var pe=Z.code,Se=Z.charCode||Z.keyCode;(pe==="Space"||pe==="Enter"||Se===32||Se===13)&&this.togglePopup()},H.prototype._onMapClick=function(Z){var pe=Z.originalEvent.target,Se=this._element;this._popup&&(pe===Se||Se.contains(pe))&&this.togglePopup()},H.prototype.getPopup=function(){return this._popup},H.prototype.togglePopup=function(){var Z=this._popup;if(Z)Z.isOpen()?Z.remove():Z.addTo(this._map);else return this;return this},H.prototype._update=function(Z){if(!!this._map){this._map.transform.renderWorldCopies&&(this._lngLat=bu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var pe="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?pe="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(pe="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var Se="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?Se="rotateX(0deg)":this._pitchAlignment==="map"&&(Se="rotateX("+this._map.getPitch()+"deg)"),(!Z||Z.type==="moveend")&&(this._pos=this._pos.round()),n.setTransform(this._element,xf[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+Se+" "+pe)}},H.prototype.getOffset=function(){return this._offset},H.prototype.setOffset=function(Z){return this._offset=e.Point.convert(Z),this._update(),this},H.prototype._onMove=function(Z){this._pos=Z.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},H.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},H.prototype._addDragHandler=function(Z){this._element.contains(Z.originalEvent.target)&&(Z.preventDefault(),this._positionDelta=Z.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},H.prototype.setDraggable=function(Z){return this._draggable=!!Z,this._map&&(Z?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},H.prototype.isDraggable=function(){return this._draggable},H.prototype.setRotation=function(Z){return this._rotation=Z||0,this._update(),this},H.prototype.getRotation=function(){return this._rotation},H.prototype.setRotationAlignment=function(Z){return this._rotationAlignment=Z||"auto",this._update(),this},H.prototype.getRotationAlignment=function(){return this._rotationAlignment},H.prototype.setPitchAlignment=function(Z){return this._pitchAlignment=Z&&Z!=="auto"?Z:this._rotationAlignment,this._update(),this},H.prototype.getPitchAlignment=function(){return this._pitchAlignment},H}(e.Evented),oc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Nu;function bf(fe){Nu!==void 0?fe(Nu):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(H){Nu=H.state!=="denied",fe(Nu)}):(Nu=!!e.window.navigator.geolocation,fe(Nu))}var of=0,Uu=!1,sc=function(fe){function H(ve){fe.call(this),this.options=e.extend({},oc,ve),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.onAdd=function(Z){return this._map=Z,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),bf(this._setupUI),this._container},H.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,of=0,Uu=!1},H.prototype._isOutOfMapMaxBounds=function(Z){var pe=this._map.getMaxBounds(),Se=Z.coords;return pe&&(Se.longitude<pe.getWest()||Se.longitude>pe.getEast()||Se.latitude<pe.getSouth()||Se.latitude>pe.getNorth())},H.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break}},H.prototype._onSuccess=function(Z){if(!!this._map){if(this._isOutOfMapMaxBounds(Z)){this._setErrorState(),this.fire(new e.Event("outofmaxbounds",Z)),this._updateMarker(),this._finish();return}if(this.options.trackUserLocation)switch(this._lastKnownPosition=Z,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(Z),(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK")&&this._updateCamera(Z),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",Z)),this._finish()}},H.prototype._updateCamera=function(Z){var pe=new e.LngLat(Z.coords.longitude,Z.coords.latitude),Se=Z.coords.accuracy,Re=this._map.getBearing(),je=e.extend({bearing:Re},this.options.fitBoundsOptions);this._map.fitBounds(pe.toBounds(Se),je,{geolocateSource:!0})},H.prototype._updateMarker=function(Z){if(Z){var pe=new e.LngLat(Z.coords.longitude,Z.coords.latitude);this._accuracyCircleMarker.setLngLat(pe).addTo(this._map),this._userLocationDotMarker.setLngLat(pe).addTo(this._map),this._accuracy=Z.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},H.prototype._updateCircleRadius=function(){var Z=this._map._container.clientHeight/2,pe=this._map.unproject([0,Z]),Se=this._map.unproject([1,Z]),Re=pe.distanceTo(Se),je=Math.ceil(2*this._accuracy/Re);this._circleElement.style.width=je+"px",this._circleElement.style.height=je+"px"},H.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},H.prototype._onError=function(Z){if(!!this._map){if(this.options.trackUserLocation)if(Z.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var pe=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=pe,this._geolocateButton.setAttribute("aria-label",pe),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(Z.code===3&&Uu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",Z)),this._finish()}},H.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},H.prototype._setupUI=function(Z){var pe=this;if(this._container.addEventListener("contextmenu",function(je){return je.preventDefault()}),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",Z===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var Se=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=Se,this._geolocateButton.setAttribute("aria-label",Se)}else{var Re=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=Re,this._geolocateButton.setAttribute("aria-label",Re)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new af(this._dotElement),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new af({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(je){var ut=je.originalEvent&&je.originalEvent.type==="resize";!je.geolocateSource&&pe._watchState==="ACTIVE_LOCK"&&!ut&&(pe._watchState="BACKGROUND",pe._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),pe._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),pe.fire(new e.Event("trackuserlocationend")))})},H.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":of--,Uu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"));break}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");break}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),of++;var Z;of>1?(Z={maximumAge:6e5,timeout:0},Uu=!0):(Z=this.options.positionOptions,Uu=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,Z)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},H.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},H}(e.Evented),kc={maxWidth:100,unit:"metric"},Vu=function(H){this.options=e.extend({},kc,H),e.bindAll(["_onMove","setUnit"],this)};Vu.prototype.getDefaultPosition=function(){return"bottom-left"},Vu.prototype._onMove=function(){lc(this._map,this._container,this.options)},Vu.prototype.onAdd=function(H){return this._map=H,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",H.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Vu.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Vu.prototype.setUnit=function(H){this.options.unit=H,lc(this._map,this._container,this.options)};function lc(fe,H,ve){var Z=ve&&ve.maxWidth||100,pe=fe._container.clientHeight/2,Se=fe.unproject([0,pe]),Re=fe.unproject([Z,pe]),je=Se.distanceTo(Re);if(ve&&ve.unit==="imperial"){var ut=3.2808*je;if(ut>5280){var Et=ut/5280;sf(H,Z,Et,fe._getUIString("ScaleControl.Miles"))}else sf(H,Z,ut,fe._getUIString("ScaleControl.Feet"))}else if(ve&&ve.unit==="nautical"){var Jt=je/1852;sf(H,Z,Jt,fe._getUIString("ScaleControl.NauticalMiles"))}else je>=1e3?sf(H,Z,je/1e3,fe._getUIString("ScaleControl.Kilometers")):sf(H,Z,je,fe._getUIString("ScaleControl.Meters"))}function sf(fe,H,ve,Z){var pe=Cc(ve),Se=pe/ve;fe.style.width=H*Se+"px",fe.innerHTML=pe+"&nbsp;"+Z}function Ec(fe){var H=Math.pow(10,Math.ceil(-Math.log(fe)/Math.LN10));return Math.round(fe*H)/H}function Cc(fe){var H=Math.pow(10,(""+Math.floor(fe)).length-1),ve=fe/H;return ve=ve>=10?10:ve>=5?5:ve>=3?3:ve>=2?2:ve>=1?1:Ec(ve),H*ve}var Vl=function(H){this._fullscreen=!1,H&&H.container&&(H.container instanceof e.window.HTMLElement?this._container=H.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};Vl.prototype.onAdd=function(H){return this._map=H,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Vl.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Vl.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},Vl.prototype._setupUI=function(){var H=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",H).setAttribute("aria-hidden",!0),H.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Vl.prototype._updateTitle=function(){var H=this._getTitle();this._fullscreenButton.setAttribute("aria-label",H),this._fullscreenButton.title=H},Vl.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Vl.prototype._isFullscreen=function(){return this._fullscreen},Vl.prototype._changeIcon=function(){var H=e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement;H===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Vl.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Lc={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Pc=function(fe){function H(ve){fe.call(this),this.options=e.extend(Object.create(Lc),ve),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return fe&&(H.__proto__=fe),H.prototype=Object.create(fe&&fe.prototype),H.prototype.constructor=H,H.prototype.addTo=function(Z){return this._map&&this.remove(),this._map=Z,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},H.prototype.isOpen=function(){return!!this._map},H.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},H.prototype.getLngLat=function(){return this._lngLat},H.prototype.setLngLat=function(Z){return this._lngLat=e.LngLat.convert(Z),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},H.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},H.prototype.getElement=function(){return this._container},H.prototype.setText=function(Z){return this.setDOMContent(e.window.document.createTextNode(Z))},H.prototype.setHTML=function(Z){var pe=e.window.document.createDocumentFragment(),Se=e.window.document.createElement("body"),Re;for(Se.innerHTML=Z;Re=Se.firstChild,!!Re;)pe.appendChild(Re);return this.setDOMContent(pe)},H.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},H.prototype.setMaxWidth=function(Z){return this.options.maxWidth=Z,this._update(),this},H.prototype.setDOMContent=function(Z){return this._createContent(),this._content.appendChild(Z),this._update(),this},H.prototype.addClassName=function(Z){this._container&&this._container.classList.add(Z)},H.prototype.removeClassName=function(Z){this._container&&this._container.classList.remove(Z)},H.prototype.toggleClassName=function(Z){if(this._container)return this._container.classList.toggle(Z)},H.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},H.prototype._onMouseUp=function(Z){this._update(Z.point)},H.prototype._onMouseMove=function(Z){this._update(Z.point)},H.prototype._onDrag=function(Z){this._update(Z.point)},H.prototype._update=function(Z){var pe=this,Se=this._lngLat||this._trackPointer;if(!(!this._map||!Se||!this._content)&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Cr){return pe._container.classList.add(Cr)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=bu(this._lngLat,this._pos,this._map.transform)),!(this._trackPointer&&!Z))){var Re=this._pos=this._trackPointer&&Z?Z:this._map.project(this._lngLat),je=this.options.anchor,ut=uc(this.options.offset);if(!je){var Et=this._container.offsetWidth,Jt=this._container.offsetHeight,lr;Re.y+ut.bottom.y<Jt?lr=["top"]:Re.y>this._map.transform.height-Jt?lr=["bottom"]:lr=[],Re.x<Et/2?lr.push("left"):Re.x>this._map.transform.width-Et/2&&lr.push("right"),lr.length===0?je="bottom":je=lr.join("-")}var vr=Re.add(ut[je]).round();n.setTransform(this._container,xf[je]+" translate("+vr.x+"px,"+vr.y+"px)"),Df(this._container,je,"popup")}},H.prototype._onClose=function(){this.remove()},H}(e.Evented);function uc(fe){if(fe)if(typeof fe=="number"){var H=Math.round(Math.sqrt(.5*Math.pow(fe,2)));return{center:new e.Point(0,0),top:new e.Point(0,fe),"top-left":new e.Point(H,H),"top-right":new e.Point(-H,H),bottom:new e.Point(0,-fe),"bottom-left":new e.Point(H,-H),"bottom-right":new e.Point(-H,-H),left:new e.Point(fe,0),right:new e.Point(-fe,0)}}else if(fe instanceof e.Point||Array.isArray(fe)){var ve=e.Point.convert(fe);return{center:ve,top:ve,"top-left":ve,"top-right":ve,bottom:ve,"bottom-left":ve,"bottom-right":ve,left:ve,right:ve}}else return{center:e.Point.convert(fe.center||[0,0]),top:e.Point.convert(fe.top||[0,0]),"top-left":e.Point.convert(fe["top-left"]||[0,0]),"top-right":e.Point.convert(fe["top-right"]||[0,0]),bottom:e.Point.convert(fe.bottom||[0,0]),"bottom-left":e.Point.convert(fe["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(fe["bottom-right"]||[0,0]),left:e.Point.convert(fe.left||[0,0]),right:e.Point.convert(fe.right||[0,0])};else return uc(new e.Point(0,0))}var Dc={version:e.version,supported:a,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:ic,NavigationControl:xu,GeolocateControl:sc,AttributionControl:Ml,ScaleControl:Vu,FullscreenControl:Vl,Popup:Pc,Marker:af,Style:Ko,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:rr,clearPrewarmedResources:kr,get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(fe){e.config.ACCESS_TOKEN=fe},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(fe){e.config.API_URL=fe},get workerCount(){return At.workerCount},set workerCount(fe){At.workerCount=fe},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(fe){e.config.MAX_PARALLEL_IMAGE_REQUESTS=fe},clearStorage:function(H){e.clearTileCache(H)},workerUrl:""};return Dc}),S})},{}],240:[function(d,ee,te){ee.exports=Math.log2||function(A){return Math.log(A)*Math.LOG2E}},{}],241:[function(d,ee,te){ee.exports=g;var A=d("mouse-event");function g(S,M){M||(M=S,S=window);var e=0,a=0,n=0,r={shift:!1,alt:!1,control:!1,meta:!1},t=!1;function c(w){var _=!1;return"altKey"in w&&(_=_||w.altKey!==r.alt,r.alt=!!w.altKey),"shiftKey"in w&&(_=_||w.shiftKey!==r.shift,r.shift=!!w.shiftKey),"ctrlKey"in w&&(_=_||w.ctrlKey!==r.control,r.control=!!w.ctrlKey),"metaKey"in w&&(_=_||w.metaKey!==r.meta,r.meta=!!w.metaKey),_}function s(w,_){var h=A.x(_),b=A.y(_);"buttons"in _&&(w=_.buttons|0),(w!==e||h!==a||b!==n||c(_))&&(e=w|0,a=h||0,n=b||0,M&&M(e,a,n,r))}function i(w){s(0,w)}function x(){(e||a||n||r.shift||r.alt||r.meta||r.control)&&(a=n=0,e=0,r.shift=r.alt=r.control=r.meta=!1,M&&M(0,0,0,r))}function p(w){c(w)&&M&&M(e,a,n,r)}function v(w){A.buttons(w)===0?s(0,w):s(e,w)}function f(w){s(e|A.buttons(w),w)}function y(w){s(e&~A.buttons(w),w)}function o(){t||(t=!0,S.addEventListener("mousemove",v),S.addEventListener("mousedown",f),S.addEventListener("mouseup",y),S.addEventListener("mouseleave",i),S.addEventListener("mouseenter",i),S.addEventListener("mouseout",i),S.addEventListener("mouseover",i),S.addEventListener("blur",x),S.addEventListener("keyup",p),S.addEventListener("keydown",p),S.addEventListener("keypress",p),S!==window&&(window.addEventListener("blur",x),window.addEventListener("keyup",p),window.addEventListener("keydown",p),window.addEventListener("keypress",p)))}function m(){!t||(t=!1,S.removeEventListener("mousemove",v),S.removeEventListener("mousedown",f),S.removeEventListener("mouseup",y),S.removeEventListener("mouseleave",i),S.removeEventListener("mouseenter",i),S.removeEventListener("mouseout",i),S.removeEventListener("mouseover",i),S.removeEventListener("blur",x),S.removeEventListener("keyup",p),S.removeEventListener("keydown",p),S.removeEventListener("keypress",p),S!==window&&(window.removeEventListener("blur",x),window.removeEventListener("keyup",p),window.removeEventListener("keydown",p),window.removeEventListener("keypress",p)))}o();var l={element:S};return Object.defineProperties(l,{enabled:{get:function(){return t},set:function(w){w?o():m()},enumerable:!0},buttons:{get:function(){return e},enumerable:!0},x:{get:function(){return a},enumerable:!0},y:{get:function(){return n},enumerable:!0},mods:{get:function(){return r},enumerable:!0}}),l}},{"mouse-event":243}],242:[function(d,ee,te){var A={left:0,top:0};ee.exports=g;function g(M,e,a){e=e||M.currentTarget||M.srcElement,Array.isArray(a)||(a=[0,0]);var n=M.clientX||0,r=M.clientY||0,t=S(e);return a[0]=n-t.left,a[1]=r-t.top,a}function S(M){return M===window||M===document||M===document.body?A:M.getBoundingClientRect()}},{}],243:[function(d,ee,te){function A(e){if(typeof e=="object"){if("buttons"in e)return e.buttons;if("which"in e){var a=e.which;if(a===2)return 4;if(a===3)return 2;if(a>0)return 1<<a-1}else if("button"in e){var a=e.button;if(a===1)return 4;if(a===2)return 2;if(a>=0)return 1<<a}}return 0}te.buttons=A;function g(e){return e.target||e.srcElement||window}te.element=g;function S(e){if(typeof e=="object"){if("offsetX"in e)return e.offsetX;var a=g(e),n=a.getBoundingClientRect();return e.clientX-n.left}return 0}te.x=S;function M(e){if(typeof e=="object"){if("offsetY"in e)return e.offsetY;var a=g(e),n=a.getBoundingClientRect();return e.clientY-n.top}return 0}te.y=M},{}],244:[function(d,ee,te){var A=d("to-px");ee.exports=g;function g(S,M,e){typeof S=="function"&&(e=!!M,M=S,S=window);var a=A("ex",S),n=function(r){e&&r.preventDefault();var t=r.deltaX||0,c=r.deltaY||0,s=r.deltaZ||0,i=r.deltaMode,x=1;switch(i){case 1:x=a;break;case 2:x=window.innerHeight;break}if(t*=x,c*=x,s*=x,t||c||s)return M(t,c,s,r)};return S.addEventListener("wheel",n),n}},{"to-px":315}],245:[function(d,ee,te){(function(A,g){(function(){/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/(function(M,e,a){e[M]=e[M]||a(),typeof ee<"u"&&ee.exports&&(ee.exports=e[M])})("Promise",typeof A<"u"?A:this,function(){var M,e,a,n=Object.prototype.toString,r=typeof g<"u"?function(w){return g(w)}:setTimeout;try{Object.defineProperty({},"x",{}),M=function(w,_,h,b){return Object.defineProperty(w,_,{value:h,writable:!0,configurable:b!==!1})}}catch{M=function(_,h,b){return _[h]=b,_}}a=function(){var w,_,h;function b(u,L){this.fn=u,this.self=L,this.next=void 0}return{add:function(L,T){h=new b(L,T),_?_.next=h:w=h,_=h,h=void 0},drain:function(){var L=w;for(w=_=e=void 0;L;)L.fn.call(L.self),L=L.next}}}();function t(l,w){a.add(l,w),e||(e=r(a.drain))}function c(l){var w,_=typeof l;return l!=null&&(_=="object"||_=="function")&&(w=l.then),typeof w=="function"?w:!1}function s(){for(var l=0;l<this.chain.length;l++)i(this,this.state===1?this.chain[l].success:this.chain[l].failure,this.chain[l]);this.chain.length=0}function i(l,w,_){var h,b;try{w===!1?_.reject(l.msg):(w===!0?h=l.msg:h=w.call(void 0,l.msg),h===_.promise?_.reject(TypeError("Promise-chain cycle")):(b=c(h))?b.call(h,_.resolve,_.reject):_.resolve(h))}catch(u){_.reject(u)}}function x(l){var w,_=this;if(!_.triggered){_.triggered=!0,_.def&&(_=_.def);try{(w=c(l))?t(function(){var h=new f(_);try{w.call(l,function(){x.apply(h,arguments)},function(){p.apply(h,arguments)})}catch(b){p.call(h,b)}}):(_.msg=l,_.state=1,_.chain.length>0&&t(s,_))}catch(h){p.call(new f(_),h)}}}function p(l){var w=this;w.triggered||(w.triggered=!0,w.def&&(w=w.def),w.msg=l,w.state=2,w.chain.length>0&&t(s,w))}function v(l,w,_,h){for(var b=0;b<w.length;b++)(function(L){l.resolve(w[L]).then(function(k){_(L,k)},h)})(b)}function f(l){this.def=l,this.triggered=!1}function y(l){this.promise=l,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function o(l){if(typeof l!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var w=new y(this);this.then=function(h,b){var u={success:typeof h=="function"?h:!0,failure:typeof b=="function"?b:!1};return u.promise=new this.constructor(function(T,k){if(typeof T!="function"||typeof k!="function")throw TypeError("Not a function");u.resolve=T,u.reject=k}),w.chain.push(u),w.state!==0&&t(s,w),u.promise},this.catch=function(h){return this.then(void 0,h)};try{l.call(void 0,function(h){x.call(w,h)},function(h){p.call(w,h)})}catch(_){p.call(w,_)}}var m=M({},"constructor",o,!1);return o.prototype=m,M(m,"__NPO__",0,!1),M(o,"resolve",function(w){var _=this;return w&&typeof w=="object"&&w.__NPO__===1?w:new _(function(b,u){if(typeof b!="function"||typeof u!="function")throw TypeError("Not a function");b(w)})}),M(o,"reject",function(w){return new this(function(h,b){if(typeof h!="function"||typeof b!="function")throw TypeError("Not a function");b(w)})}),M(o,"all",function(w){var _=this;return n.call(w)!="[object Array]"?_.reject(TypeError("Not an array")):w.length===0?_.resolve([]):new _(function(b,u){if(typeof b!="function"||typeof u!="function")throw TypeError("Not a function");var L=w.length,T=Array(L),k=0;v(_,w,function(z,I){T[z]=I,++k===L&&b(T)},u)})}),M(o,"race",function(w){var _=this;return n.call(w)!="[object Array]"?_.reject(TypeError("Not an array")):new _(function(b,u){if(typeof b!="function"||typeof u!="function")throw TypeError("Not a function");v(_,w,function(T,k){b(k)},u)})}),o})}).call(this)}).call(this,typeof Mo<"u"?Mo:typeof self<"u"?self:typeof window<"u"?window:{},d("timers").setImmediate)},{timers:312}],246:[function(d,ee,te){var A=Math.PI,g=r(120);ee.exports=S;function S(t){for(var c,s=[],i=0,x=0,p=0,v=0,f=null,y=null,o=0,m=0,l=0,w=t.length;l<w;l++){var _=t[l],h=_[0];switch(h){case"M":p=_[1],v=_[2];break;case"A":_=a(o,m,_[1],_[2],r(_[3]),_[4],_[5],_[6],_[7]),_.unshift("C"),_.length>7&&(s.push(_.splice(0,7)),_.unshift("C"));break;case"S":var b=o,u=m;(c=="C"||c=="S")&&(b+=b-i,u+=u-x),_=["C",b,u,_[1],_[2],_[3],_[4]];break;case"T":c=="Q"||c=="T"?(f=o*2-f,y=m*2-y):(f=o,y=m),_=e(o,m,f,y,_[1],_[2]);break;case"Q":f=_[1],y=_[2],_=e(o,m,_[1],_[2],_[3],_[4]);break;case"L":_=M(o,m,_[1],_[2]);break;case"H":_=M(o,m,_[1],m);break;case"V":_=M(o,m,o,_[1]);break;case"Z":_=M(o,m,p,v);break}c=h,o=_[_.length-2],m=_[_.length-1],_.length>4?(i=_[_.length-4],x=_[_.length-3]):(i=o,x=m),s.push(_)}return s}function M(t,c,s,i){return["C",t,c,s,i,s,i]}function e(t,c,s,i,x,p){return["C",t/3+2/3*s,c/3+2/3*i,x/3+2/3*s,p/3+2/3*i,x,p]}function a(t,c,s,i,x,p,v,f,y,o){if(o)k=o[0],P=o[1],L=o[2],T=o[3];else{var m=n(t,c,-x);t=m.x,c=m.y,m=n(f,y,-x),f=m.x,y=m.y;var l=(t-f)/2,w=(c-y)/2,_=l*l/(s*s)+w*w/(i*i);_>1&&(_=Math.sqrt(_),s=_*s,i=_*i);var h=s*s,b=i*i,u=(p==v?-1:1)*Math.sqrt(Math.abs((h*b-h*w*w-b*l*l)/(h*w*w+b*l*l)));u==1/0&&(u=1);var L=u*s*w/i+(t+f)/2,T=u*-i*l/s+(c+y)/2,k=Math.asin(((c-T)/i).toFixed(9)),P=Math.asin(((y-T)/i).toFixed(9));k=t<L?A-k:k,P=f<L?A-P:P,k<0&&(k=A*2+k),P<0&&(P=A*2+P),v&&k>P&&(k=k-A*2),!v&&P>k&&(P=P-A*2)}if(Math.abs(P-k)>g){var z=P,I=f,D=y;P=k+g*(v&&P>k?1:-1),f=L+s*Math.cos(P),y=T+i*Math.sin(P);var R=a(f,y,s,i,x,0,v,I,D,[P,z,L,T])}var O=Math.tan((P-k)/4),F=4/3*s*O,N=4/3*i*O,G=[2*t-(t+F*Math.sin(k)),2*c-(c-N*Math.cos(k)),f+F*Math.sin(P),y-N*Math.cos(P),f,y];if(o)return G;R&&(G=G.concat(R));for(var K=0;K<G.length;){var W=n(G[K],G[K+1],x);G[K++]=W.x,G[K++]=W.y}return G}function n(t,c,s){return{x:t*Math.cos(s)-c*Math.sin(s),y:t*Math.sin(s)+c*Math.cos(s)}}function r(t){return t*(A/180)}},{}],247:[function(d,ee,te){var A=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;function M(a){if(a==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function e(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de",Object.getOwnPropertyNames(a)[0]==="5")return!1;for(var n={},r=0;r<10;r++)n["_"+String.fromCharCode(r)]=r;var t=Object.getOwnPropertyNames(n).map(function(s){return n[s]});if(t.join("")!=="0123456789")return!1;var c={};return"abcdefghijklmnopqrst".split("").forEach(function(s){c[s]=s}),Object.keys(Object.assign({},c)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}ee.exports=e()?Object.assign:function(a,n){for(var r,t=M(a),c,s=1;s<arguments.length;s++){r=Object(arguments[s]);for(var i in r)g.call(r,i)&&(t[i]=r[i]);if(A){c=A(r);for(var x=0;x<c.length;x++)S.call(r,c[x])&&(t[c[x]]=r[c[x]])}}return t}},{}],248:[function(d,ee,te){function A(M,e){if(typeof M!="string")return[M];var a=[M];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var n=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],r=e.escape||"___",t=!!e.flat;n.forEach(function(i){var x=new RegExp(["\\",i[0],"[^\\",i[0],"\\",i[1],"]*\\",i[1]].join("")),p=[];function v(f,y,o){var m=a.push(f.slice(i[0].length,-i[1].length))-1;return p.push(m),r+m+r}a.forEach(function(f,y){for(var o,m=0;f!=o;)if(o=f,f=f.replace(x,v),m++>1e4)throw Error("References have circular dependency. Please, check them.");a[y]=f}),p=p.reverse(),a=a.map(function(f){return p.forEach(function(y){f=f.replace(new RegExp("(\\"+r+y+"\\"+r+")","g"),i[0]+"$1"+i[1])}),f})});var c=new RegExp("\\"+r+"([0-9]+)\\"+r);function s(i,x,p){for(var v=[],f,y=0;f=c.exec(i);){if(y++>1e4)throw Error("Circular references in parenthesis");v.push(i.slice(0,f.index)),v.push(s(x[f[1]],x)),i=i.slice(f.index+f[0].length)}return v.push(i),v}return t?a:s(a[0],a)}function g(M,e){if(e&&e.flat){var a=e&&e.escape||"___",n=M[0],r;if(!n)return"";for(var t=new RegExp("\\"+a+"([0-9]+)\\"+a),c=0;n!=r;){if(c++>1e4)throw Error("Circular references in "+M);r=n,n=n.replace(t,s)}return n}return M.reduce(function i(x,p){return Array.isArray(p)&&(p=p.reduce(i,"")),x+p},"");function s(i,x){if(M[x]==null)throw Error("Reference "+x+"is undefined");return M[x]}}function S(M,e){return Array.isArray(M)?g(M,e):A(M,e)}S.parse=A,S.stringify=g,ee.exports=S},{}],249:[function(d,ee,te){var A=d("pick-by-alias");ee.exports=g;function g(S){var M;return arguments.length>1&&(S=arguments),typeof S=="string"?S=S.split(/\s/).map(parseFloat):typeof S=="number"&&(S=[S]),S.length&&typeof S[0]=="number"?S.length===1?M={width:S[0],height:S[0],x:0,y:0}:S.length===2?M={width:S[0],height:S[1],x:0,y:0}:M={x:S[0],y:S[1],width:S[2]-S[0]||0,height:S[3]-S[1]||0}:S&&(S=A(S,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),M={x:S.left||0,y:S.top||0},S.width==null?S.right?M.width=S.right-M.x:M.width=0:M.width=S.width,S.height==null?S.bottom?M.height=S.bottom-M.y:M.height=0:M.height=S.height),M}},{"pick-by-alias":253}],250:[function(d,ee,te){ee.exports=S;var A={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},g=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function S(a){var n=[];return a.replace(g,function(r,t,c){var s=t.toLowerCase();for(c=e(c),s=="m"&&c.length>2&&(n.push([t].concat(c.splice(0,2))),s="l",t=t=="m"?"l":"L");;){if(c.length==A[s])return c.unshift(t),n.push(c);if(c.length<A[s])throw new Error("malformed path data");n.push([t].concat(c.splice(0,A[s])))}}),n}var M=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function e(a){var n=a.match(M);return n?n.map(Number):[]}},{}],251:[function(d,ee,te){ee.exports=function(g,S){S||(S=[0,""]),g=String(g);var M=parseFloat(g,10);return S[0]=M,S[1]=g.match(/[\d.\-\+]*\s*(.*)/)[1]||"",S}},{}],252:[function(d,ee,te){(function(A){(function(){(function(){var g,S,M,e,a,n;typeof performance<"u"&&performance!==null&&performance.now?ee.exports=function(){return performance.now()}:typeof A<"u"&&A!==null&&A.hrtime?(ee.exports=function(){return(g()-a)/1e6},S=A.hrtime,g=function(){var r;return r=S(),r[0]*1e9+r[1]},e=g(),n=A.uptime()*1e9,a=e-n):Date.now?(ee.exports=function(){return Date.now()-M},M=Date.now()):(ee.exports=function(){return new Date().getTime()-M},M=new Date().getTime())}).call(this)}).call(this)}).call(this,d("_process"))},{_process:278}],253:[function(d,ee,te){ee.exports=function(M,e,a){var n={},r,t;if(typeof e=="string"&&(e=g(e)),Array.isArray(e)){var c={};for(t=0;t<e.length;t++)c[e[t]]=!0;e=c}for(r in e)e[r]=g(e[r]);var s={};for(r in e){var i=e[r];if(Array.isArray(i))for(t=0;t<i.length;t++){var x=i[t];if(a&&(s[x]=!0),x in M){if(n[r]=M[x],a)for(var p=t;p<i.length;p++)s[i[p]]=!0;break}}else r in M&&(e[r]&&(n[r]=M[r]),a&&(s[r]=!0))}if(a)for(r in M)s[r]||(n[r]=M[r]);return n};var A={};function g(S){return A[S]?A[S]:(typeof S=="string"&&(S=A[S]=S.split(/\s*,\s*|\s+/)),S)}},{}],254:[function(d,ee,te){ee.exports=function(g,S,M,e){var a=g[0],n=g[1],r=!1;M===void 0&&(M=0),e===void 0&&(e=S.length);for(var t=e-M,c=0,s=t-1;c<t;s=c++){var i=S[c+M][0],x=S[c+M][1],p=S[s+M][0],v=S[s+M][1],f=x>n!=v>n&&a<(p-i)*(n-x)/(v-x)+i;f&&(r=!r)}return r}},{}],255:[function(d,ee,te){/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var A=d("./lib/build-log"),g=d("./lib/epsilon"),S=d("./lib/intersecter"),M=d("./lib/segment-chainer"),e=d("./lib/segment-selector"),a=d("./lib/geojson"),n=!1,r=g(),t;t={buildLog:function(s){return s===!0?n=A():s===!1&&(n=!1),n===!1?!1:n.list},epsilon:function(s){return r.epsilon(s)},segments:function(s){var i=S(!0,r,n);return s.regions.forEach(i.addRegion),{segments:i.calculate(s.inverted),inverted:s.inverted}},combine:function(s,i){var x=S(!1,r,n);return{combined:x.calculate(s.segments,s.inverted,i.segments,i.inverted),inverted1:s.inverted,inverted2:i.inverted}},selectUnion:function(s){return{segments:e.union(s.combined,n),inverted:s.inverted1||s.inverted2}},selectIntersect:function(s){return{segments:e.intersect(s.combined,n),inverted:s.inverted1&&s.inverted2}},selectDifference:function(s){return{segments:e.difference(s.combined,n),inverted:s.inverted1&&!s.inverted2}},selectDifferenceRev:function(s){return{segments:e.differenceRev(s.combined,n),inverted:!s.inverted1&&s.inverted2}},selectXor:function(s){return{segments:e.xor(s.combined,n),inverted:s.inverted1!==s.inverted2}},polygon:function(s){return{regions:M(s.segments,r,n),inverted:s.inverted}},polygonFromGeoJSON:function(s){return a.toPolygon(t,s)},polygonToGeoJSON:function(s){return a.fromPolygon(t,r,s)},union:function(s,i){return c(s,i,t.selectUnion)},intersect:function(s,i){return c(s,i,t.selectIntersect)},difference:function(s,i){return c(s,i,t.selectDifference)},differenceRev:function(s,i){return c(s,i,t.selectDifferenceRev)},xor:function(s,i){return c(s,i,t.selectXor)}};function c(s,i,x){var p=t.segments(s),v=t.segments(i),f=t.combine(p,v),y=x(f);return t.polygon(y)}typeof window=="object"&&(window.PolyBool=t),ee.exports=t},{"./lib/build-log":256,"./lib/epsilon":257,"./lib/geojson":258,"./lib/intersecter":259,"./lib/segment-chainer":261,"./lib/segment-selector":262}],256:[function(d,ee,te){function A(){var g,S=0,M=!1;function e(a,n){return g.list.push({type:a,data:n?JSON.parse(JSON.stringify(n)):void 0}),g}return g={list:[],segmentId:function(){return S++},checkIntersection:function(a,n){return e("check",{seg1:a,seg2:n})},segmentChop:function(a,n){return e("div_seg",{seg:a,pt:n}),e("chop",{seg:a,pt:n})},statusRemove:function(a){return e("pop_seg",{seg:a})},segmentUpdate:function(a){return e("seg_update",{seg:a})},segmentNew:function(a,n){return e("new_seg",{seg:a,primary:n})},segmentRemove:function(a){return e("rem_seg",{seg:a})},tempStatus:function(a,n,r){return e("temp_status",{seg:a,above:n,below:r})},rewind:function(a){return e("rewind",{seg:a})},status:function(a,n,r){return e("status",{seg:a,above:n,below:r})},vert:function(a){return a===M?g:(M=a,e("vert",{x:a}))},log:function(a){return typeof a!="string"&&(a=JSON.stringify(a,!1,"  ")),e("log",{txt:a})},reset:function(){return e("reset")},selected:function(a){return e("selected",{segs:a})},chainStart:function(a){return e("chain_start",{seg:a})},chainRemoveHead:function(a,n){return e("chain_rem_head",{index:a,pt:n})},chainRemoveTail:function(a,n){return e("chain_rem_tail",{index:a,pt:n})},chainNew:function(a,n){return e("chain_new",{pt1:a,pt2:n})},chainMatch:function(a){return e("chain_match",{index:a})},chainClose:function(a){return e("chain_close",{index:a})},chainAddHead:function(a,n){return e("chain_add_head",{index:a,pt:n})},chainAddTail:function(a,n){return e("chain_add_tail",{index:a,pt:n})},chainConnect:function(a,n){return e("chain_con",{index1:a,index2:n})},chainReverse:function(a){return e("chain_rev",{index:a})},chainJoin:function(a,n){return e("chain_join",{index1:a,index2:n})},done:function(){return e("done")}},g}ee.exports=A},{}],257:[function(d,ee,te){function A(g){typeof g!="number"&&(g=1e-10);var S={epsilon:function(M){return typeof M=="number"&&(g=M),g},pointAboveOrOnLine:function(M,e,a){var n=e[0],r=e[1],t=a[0],c=a[1],s=M[0],i=M[1];return(t-n)*(i-r)-(c-r)*(s-n)>=-g},pointBetween:function(M,e,a){var n=M[1]-e[1],r=a[0]-e[0],t=M[0]-e[0],c=a[1]-e[1],s=t*r+n*c;if(s<g)return!1;var i=r*r+c*c;return!(s-i>-g)},pointsSameX:function(M,e){return Math.abs(M[0]-e[0])<g},pointsSameY:function(M,e){return Math.abs(M[1]-e[1])<g},pointsSame:function(M,e){return S.pointsSameX(M,e)&&S.pointsSameY(M,e)},pointsCompare:function(M,e){return S.pointsSameX(M,e)?S.pointsSameY(M,e)?0:M[1]<e[1]?-1:1:M[0]<e[0]?-1:1},pointsCollinear:function(M,e,a){var n=M[0]-e[0],r=M[1]-e[1],t=e[0]-a[0],c=e[1]-a[1];return Math.abs(n*c-t*r)<g},linesIntersect:function(M,e,a,n){var r=e[0]-M[0],t=e[1]-M[1],c=n[0]-a[0],s=n[1]-a[1],i=r*s-t*c;if(Math.abs(i)<g)return!1;var x=M[0]-a[0],p=M[1]-a[1],v=(c*p-s*x)/i,f=(r*p-t*x)/i,y={alongA:0,alongB:0,pt:[M[0]+v*r,M[1]+v*t]};return v<=-g?y.alongA=-2:v<g?y.alongA=-1:v-1<=-g?y.alongA=0:v-1<g?y.alongA=1:y.alongA=2,f<=-g?y.alongB=-2:f<g?y.alongB=-1:f-1<=-g?y.alongB=0:f-1<g?y.alongB=1:y.alongB=2,y},pointInsideRegion:function(M,e){for(var a=M[0],n=M[1],r=e[e.length-1][0],t=e[e.length-1][1],c=!1,s=0;s<e.length;s++){var i=e[s][0],x=e[s][1];x-n>g!=t-n>g&&(r-i)*(n-x)/(t-x)+i-a>g&&(c=!c),r=i,t=x}return c}};return S}ee.exports=A},{}],258:[function(d,ee,te){var A={toPolygon:function(g,S){function M(n){if(n.length<=0)return g.segments({inverted:!1,regions:[]});function r(s){var i=s.slice(0,s.length-1);return g.segments({inverted:!1,regions:[i]})}for(var t=r(n[0]),c=1;c<n.length;c++)t=g.selectDifference(g.combine(t,r(n[c])));return t}if(S.type==="Polygon")return g.polygon(M(S.coordinates));if(S.type==="MultiPolygon"){for(var e=g.segments({inverted:!1,regions:[]}),a=0;a<S.coordinates.length;a++)e=g.selectUnion(g.combine(e,M(S.coordinates[a])));return g.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(g,S,M){M=g.polygon(g.segments(M));function e(v,f){return S.pointInsideRegion([(v[0][0]+v[1][0])*.5,(v[0][1]+v[1][1])*.5],f)}function a(v){return{region:v,children:[]}}var n=a(null);function r(v,f){for(var y=0;y<v.children.length;y++){var o=v.children[y];if(e(f,o.region)){r(o,f);return}}for(var m=a(f),y=0;y<v.children.length;y++){var o=v.children[y];e(o.region,f)&&(m.children.push(o),v.children.splice(y,1),y--)}v.children.push(m)}for(var t=0;t<M.regions.length;t++){var c=M.regions[t];c.length<3||r(n,c)}function s(v,f){for(var y=0,o=v[v.length-1][0],m=v[v.length-1][1],l=[],w=0;w<v.length;w++){var _=v[w][0],h=v[w][1];l.push([_,h]),y+=h*o-_*m,o=_,m=h}var b=y<0;return b!==f&&l.reverse(),l.push([l[0][0],l[0][1]]),l}var i=[];function x(v){var f=[s(v.region,!1)];i.push(f);for(var y=0;y<v.children.length;y++)f.push(p(v.children[y]))}function p(v){for(var f=0;f<v.children.length;f++)x(v.children[f]);return s(v.region,!0)}for(var t=0;t<n.children.length;t++)x(n.children[t]);return i.length<=0?{type:"Polygon",coordinates:[]}:i.length==1?{type:"Polygon",coordinates:i[0]}:{type:"MultiPolygon",coordinates:i}}};ee.exports=A},{}],259:[function(d,ee,te){var A=d("./linked-list");function g(S,M,e){function a(y,o){return{id:e?e.segmentId():-1,start:y,end:o,myFill:{above:null,below:null},otherFill:null}}function n(y,o,m){return{id:e?e.segmentId():-1,start:y,end:o,myFill:{above:m.myFill.above,below:m.myFill.below},otherFill:null}}var r=A.create();function t(y,o,m,l,w,_){var h=M.pointsCompare(o,w);return h!==0?h:M.pointsSame(m,_)?0:y!==l?y?1:-1:M.pointAboveOrOnLine(m,l?w:_,l?_:w)?1:-1}function c(y,o){r.insertBefore(y,function(m){var l=t(y.isStart,y.pt,o,m.isStart,m.pt,m.other.pt);return l<0})}function s(y,o){var m=A.node({isStart:!0,pt:y.start,seg:y,primary:o,other:null,status:null});return c(m,y.end),m}function i(y,o,m){var l=A.node({isStart:!1,pt:o.end,seg:o,primary:m,other:y,status:null});y.other=l,c(l,y.pt)}function x(y,o){var m=s(y,o);return i(m,y,o),m}function p(y,o){e&&e.segmentChop(y.seg,o),y.other.remove(),y.seg.end=o,y.other.pt=o,c(y.other,y.pt)}function v(y,o){var m=n(o,y.seg.end,y.seg);return p(y,o),x(m,y.primary)}function f(y,o){var m=A.create();function l(O,F){var N=O.seg.start,G=O.seg.end,K=F.seg.start,W=F.seg.end;return M.pointsCollinear(N,K,W)?M.pointsCollinear(G,K,W)||M.pointAboveOrOnLine(G,K,W)?1:-1:M.pointAboveOrOnLine(N,K,W)?1:-1}function w(O){return m.findTransition(function(F){var N=l(O,F.ev);return N>0})}function _(O,F){var N=O.seg,G=F.seg,K=N.start,W=N.end,Y=G.start,re=G.end;e&&e.checkIntersection(N,G);var ue=M.linesIntersect(K,W,Y,re);if(ue===!1){if(!M.pointsCollinear(K,W,Y)||M.pointsSame(K,re)||M.pointsSame(W,Y))return!1;var j=M.pointsSame(K,Y),q=M.pointsSame(W,re);if(j&&q)return F;var V=!j&&M.pointBetween(K,Y,re),U=!q&&M.pointBetween(W,Y,re);if(j)return U?v(F,W):v(O,re),F;V&&(q||(U?v(F,W):v(O,re)),v(F,K))}else ue.alongA===0&&(ue.alongB===-1?v(O,Y):ue.alongB===0?v(O,ue.pt):ue.alongB===1&&v(O,re)),ue.alongB===0&&(ue.alongA===-1?v(F,K):ue.alongA===0?v(F,ue.pt):ue.alongA===1&&v(F,W));return!1}for(var h=[];!r.isEmpty();){var b=r.getHead();if(e&&e.vert(b.pt[0]),b.isStart){let O=function(){if(L){var F=_(b,L);if(F)return F}return T?_(b,T):!1};var R=O;e&&e.segmentNew(b.seg,b.primary);var u=w(b),L=u.before?u.before.ev:null,T=u.after?u.after.ev:null;e&&e.tempStatus(b.seg,L?L.seg:!1,T?T.seg:!1);var k=O();if(k){if(S){var P;b.seg.myFill.below===null?P=!0:P=b.seg.myFill.above!==b.seg.myFill.below,P&&(k.seg.myFill.above=!k.seg.myFill.above)}else k.seg.otherFill=b.seg.myFill;e&&e.segmentUpdate(k.seg),b.other.remove(),b.remove()}if(r.getHead()!==b){e&&e.rewind(b.seg);continue}if(S){var P;b.seg.myFill.below===null?P=!0:P=b.seg.myFill.above!==b.seg.myFill.below,T?b.seg.myFill.below=T.seg.myFill.above:b.seg.myFill.below=y,P?b.seg.myFill.above=!b.seg.myFill.below:b.seg.myFill.above=b.seg.myFill.below}else if(b.seg.otherFill===null){var z;T?b.primary===T.primary?z=T.seg.otherFill.above:z=T.seg.myFill.above:z=b.primary?o:y,b.seg.otherFill={above:z,below:z}}e&&e.status(b.seg,L?L.seg:!1,T?T.seg:!1),b.other.status=u.insert(A.node({ev:b}))}else{var I=b.status;if(I===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(m.exists(I.prev)&&m.exists(I.next)&&_(I.prev.ev,I.next.ev),e&&e.statusRemove(I.ev.seg),I.remove(),!b.primary){var D=b.seg.myFill;b.seg.myFill=b.seg.otherFill,b.seg.otherFill=D}h.push(b.seg)}r.getHead().remove()}return e&&e.done(),h}return S?{addRegion:function(y){for(var o,m=y[y.length-1],l=0;l<y.length;l++){o=m,m=y[l];var w=M.pointsCompare(o,m);w!==0&&x(a(w<0?o:m,w<0?m:o),!0)}},calculate:function(y){return f(y,!1)}}:{calculate:function(y,o,m,l){return y.forEach(function(w){x(n(w.start,w.end,w),!0)}),m.forEach(function(w){x(n(w.start,w.end,w),!1)}),f(o,l)}}}ee.exports=g},{"./linked-list":260}],260:[function(d,ee,te){var A={create:function(){var g={root:{root:!0,next:null},exists:function(S){return!(S===null||S===g.root)},isEmpty:function(){return g.root.next===null},getHead:function(){return g.root.next},insertBefore:function(S,M){for(var e=g.root,a=g.root.next;a!==null;){if(M(a)){S.prev=a.prev,S.next=a,a.prev.next=S,a.prev=S;return}e=a,a=a.next}e.next=S,S.prev=e,S.next=null},findTransition:function(S){for(var M=g.root,e=g.root.next;e!==null&&!S(e);)M=e,e=e.next;return{before:M===g.root?null:M,after:e,insert:function(a){return a.prev=M,a.next=e,M.next=a,e!==null&&(e.prev=a),a}}}};return g},node:function(g){return g.prev=null,g.next=null,g.remove=function(){g.prev.next=g.next,g.next&&(g.next.prev=g.prev),g.prev=null,g.next=null},g}};ee.exports=A},{}],261:[function(d,ee,te){function A(g,S,M){var e=[],a=[];return g.forEach(function(n){var r=n.start,t=n.end;if(S.pointsSame(r,t)){console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");return}M&&M.chainStart(n);var c={index:0,matches_head:!1,matches_pt1:!1},s={index:0,matches_head:!1,matches_pt1:!1},i=c;function x(z,I,D){return i.index=z,i.matches_head=I,i.matches_pt1=D,i===c?(i=s,!1):(i=null,!0)}for(var p=0;p<e.length;p++){var v=e[p],f=v[0];v[1];var y=v[v.length-1];if(v[v.length-2],S.pointsSame(f,r)){if(x(p,!0,!0))break}else if(S.pointsSame(f,t)){if(x(p,!0,!1))break}else if(S.pointsSame(y,r)){if(x(p,!1,!0))break}else if(S.pointsSame(y,t)&&x(p,!1,!1))break}if(i===c){e.push([r,t]),M&&M.chainNew(r,t);return}if(i===s){M&&M.chainMatch(c.index);var o=c.index,m=c.matches_pt1?t:r,l=c.matches_head,v=e[o],w=l?v[0]:v[v.length-1],_=l?v[1]:v[v.length-2],h=l?v[v.length-1]:v[0],b=l?v[v.length-2]:v[1];if(S.pointsCollinear(_,w,m)&&(l?(M&&M.chainRemoveHead(c.index,m),v.shift()):(M&&M.chainRemoveTail(c.index,m),v.pop()),w=_),S.pointsSame(h,m)){e.splice(o,1),S.pointsCollinear(b,h,w)&&(l?(M&&M.chainRemoveTail(c.index,w),v.pop()):(M&&M.chainRemoveHead(c.index,w),v.shift())),M&&M.chainClose(c.index),a.push(v);return}l?(M&&M.chainAddHead(c.index,m),v.unshift(m)):(M&&M.chainAddTail(c.index,m),v.push(m));return}function u(z){M&&M.chainReverse(z),e[z].reverse()}function L(z,I){var D=e[z],R=e[I],O=D[D.length-1],F=D[D.length-2],N=R[0],G=R[1];S.pointsCollinear(F,O,N)&&(M&&M.chainRemoveTail(z,O),D.pop(),O=F),S.pointsCollinear(O,N,G)&&(M&&M.chainRemoveHead(I,N),R.shift()),M&&M.chainJoin(z,I),e[z]=D.concat(R),e.splice(I,1)}var T=c.index,k=s.index;M&&M.chainConnect(T,k);var P=e[T].length<e[k].length;c.matches_head?s.matches_head?P?(u(T),L(T,k)):(u(k),L(k,T)):L(k,T):s.matches_head?L(T,k):P?(u(T),L(k,T)):(u(k),L(T,k))}),a}ee.exports=A},{}],262:[function(d,ee,te){function A(S,M,e){var a=[];return S.forEach(function(n){var r=(n.myFill.above?8:0)+(n.myFill.below?4:0)+(n.otherFill&&n.otherFill.above?2:0)+(n.otherFill&&n.otherFill.below?1:0);M[r]!==0&&a.push({id:e?e.segmentId():-1,start:n.start,end:n.end,myFill:{above:M[r]===1,below:M[r]===2},otherFill:null})}),e&&e.selected(a),a}var g={union:function(S,M){return A(S,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],M)},intersect:function(S,M){return A(S,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],M)},difference:function(S,M){return A(S,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],M)},differenceRev:function(S,M){return A(S,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],M)},xor:function(S,M){return A(S,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],M)}};ee.exports=g},{}],263:[function(d,ee,te){var A=d("stream").Transform,g=d("stream-parser");function S(){A.call(this,{readableObjectMode:!0})}S.prototype=Object.create(A.prototype),S.prototype.constructor=S,g(S.prototype),te.ParserStream=S,te.sliceEq=function(e,a,n){for(var r=a,t=0;t<n.length;)if(e[r++]!==n[t++])return!1;return!0},te.str2arr=function(e,a){var n=[],r=0;if(a&&a==="hex")for(;r<e.length;)n.push(parseInt(e.slice(r,r+2),16)),r+=2;else for(;r<e.length;r++)n.push(e.charCodeAt(r)&255);return n},te.readUInt16LE=function(e,a){return e[a]|e[a+1]<<8},te.readUInt16BE=function(e,a){return e[a+1]|e[a]<<8},te.readUInt32LE=function(e,a){return e[a]|e[a+1]<<8|e[a+2]<<16|e[a+3]*16777216},te.readUInt32BE=function(e,a){return e[a+3]|e[a+2]<<8|e[a+1]<<16|e[a]*16777216};function M(e,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||"",this.name=this.constructor.name,this.message=e,a&&(this.code=a),n&&(this.statusCode=n)}M.prototype=Object.create(Error.prototype),M.prototype.constructor=M,te.ProbeError=M},{stream:286,"stream-parser":302}],264:[function(d,ee,te){function A(M,e){var a=new Error(M);return a.code=e,a}function g(M){try{return decodeURIComponent(escape(M))}catch{return M}}function S(M,e,a){this.input=M.subarray(e,a),this.start=e;var n=String.fromCharCode.apply(null,this.input.subarray(0,4));if(n!=="II*\0"&&n!=="MM\0*")throw A("invalid TIFF signature","EBADDATA");this.big_endian=n[0]==="M"}S.prototype.each=function(M){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var a=this.ifds_to_read.shift();!a.offset||this.scan_ifd(a.id,a.offset,M)}},S.prototype.read_uint16=function(M){var e=this.input;if(M+2>e.length)throw A("unexpected EOF","EBADDATA");return this.big_endian?e[M]*256+e[M+1]:e[M]+e[M+1]*256},S.prototype.read_uint32=function(M){var e=this.input;if(M+4>e.length)throw A("unexpected EOF","EBADDATA");return this.big_endian?e[M]*16777216+e[M+1]*65536+e[M+2]*256+e[M+3]:e[M]+e[M+1]*256+e[M+2]*65536+e[M+3]*16777216},S.prototype.is_subifd_link=function(M,e){return M===0&&e===34665||M===0&&e===34853||M===34665&&e===40965},S.prototype.exif_format_length=function(M){switch(M){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},S.prototype.exif_format_read=function(M,e){var a;switch(M){case 1:case 2:return a=this.input[e],a;case 6:return a=this.input[e],a|(a&128)*33554430;case 3:return a=this.read_uint16(e),a;case 8:return a=this.read_uint16(e),a|(a&32768)*131070;case 4:return a=this.read_uint32(e),a;case 9:return a=this.read_uint32(e),a|0;case 5:case 10:case 11:case 12:return null;case 7:return null;default:return null}},S.prototype.scan_ifd=function(M,e,a){var n=this.read_uint16(e);e+=2;for(var r=0;r<n;r++){var t=this.read_uint16(e),c=this.read_uint16(e+2),s=this.read_uint32(e+4),i=this.exif_format_length(c),x=s*i,p=x<=4?e+8:this.read_uint32(e+8),v=!1;if(p+x>this.input.length)throw A("unexpected EOF","EBADDATA");for(var f=[],y=p,o=0;o<s;o++,y+=i){var m=this.exif_format_read(c,y);if(m===null){f=null;break}f.push(m)}Array.isArray(f)&&c===2&&(f=g(String.fromCharCode.apply(null,f)),f&&f[f.length-1]==="\0"&&(f=f.slice(0,-1))),this.is_subifd_link(M,t)&&Array.isArray(f)&&Number.isInteger(f[0])&&f[0]>0&&(this.ifds_to_read.push({id:t,offset:f[0]}),v=!0);var l={is_big_endian:this.big_endian,ifd:M,tag:t,format:c,count:s,entry_offset:e+this.start,data_length:x,data_offset:p+this.start,value:f,is_subifd_link:v};if(a(l)===!1){this.aborted=!0;return}e+=12}M===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},ee.exports.ExifParser=S,ee.exports.get_orientation=function(M){var e=0;try{return new S(M,0,M.length).each(function(a){if(a.ifd===0&&a.tag===274&&Array.isArray(a.value))return e=a.value[0],!1}),e}catch{return-1}}},{}],265:[function(d,ee,te){var A=d("./common").readUInt16BE,g=d("./common").readUInt32BE;function S(s,i){if(s.length<4+i)return null;var x=g(s,i);return s.length<x+i||x<8?null:{boxtype:String.fromCharCode.apply(null,s.slice(i+4,i+8)),data:s.slice(i+8,i+x),end:i+x}}ee.exports.unbox=S;function M(s,i){for(var x=0;;){var p=S(s,x);if(!p)break;switch(p.boxtype){case"ispe":i.sizes.push({width:g(p.data,4),height:g(p.data,8)});break;case"irot":i.transforms.push({type:"irot",value:p.data[0]&3});break;case"imir":i.transforms.push({type:"imir",value:p.data[0]&1});break}x=p.end}}function e(s,i,x){for(var p=0,v=0;v<x;v++)p=p*256+(s[i+v]||0);return p}function a(s,i){for(var x=s[4]>>4&15,p=s[4]&15,v=s[5]>>4&15,f=A(s,6),y=8,o=0;o<f;o++){var m=A(s,y);y+=2;var l=A(s,y);y+=2;var w=e(s,y,v);y+=v;var _=A(s,y);if(y+=2,l===0&&_===1){var h=e(s,y,x),b=e(s,y+x,p);i.item_loc[m]={length:b,offset:h+w}}y+=_*(x+p)}}function n(s,i){for(var x=A(s,4),p=6,v=0;v<x;v++){var f=S(s,p);if(!f)break;if(f.boxtype==="infe"){for(var y=A(f.data,4),o="",m=8;m<f.data.length&&f.data[m];m++)o+=String.fromCharCode(f.data[m]);i.item_inf[o]=y}p=f.end}}function r(s,i){for(var x=0;;){var p=S(s,x);if(!p)break;p.boxtype==="ipco"&&M(p.data,i),x=p.end}}function t(s,i){for(var x=4;;){var p=S(s,x);if(!p)break;p.boxtype==="iprp"&&r(p.data,i),p.boxtype==="iloc"&&a(p.data,i),p.boxtype==="iinf"&&n(p.data,i),x=p.end}}function c(s){var i=s.reduce(function(v,f){return v.width>f.width||v.width===f.width&&v.height>f.height?v:f}),x=s.reduce(function(v,f){return v.height>f.height||v.height===f.height&&v.width>f.width?v:f}),p;return i.width>x.height||i.width===x.height&&i.height>x.width?p=i:p=x,p}ee.exports.readSizeFromMeta=function(s){var i={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(t(s,i),!!i.sizes.length){var x=c(i.sizes),p=1;i.transforms.forEach(function(f){var y={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},o={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(f.type==="imir"&&(f.value===0?p=o[p]:(p=o[p],p=y[p],p=y[p])),f.type==="irot")for(var m=0;m<f.value;m++)p=y[p]});var v=null;return i.item_inf.Exif&&(v=i.item_loc[i.item_inf.Exif]),{width:x.width,height:x.height,orientation:i.transforms.length?p:null,variants:i.sizes,exif_location:v}}},ee.exports.getMimeType=function(s){var i=String.fromCharCode.apply(null,s.slice(0,4)),x={};x[i]=!0;for(var p=8;p<s.length;p+=4)x[String.fromCharCode.apply(null,s.slice(p,p+4))]=!0;if(!(!x.mif1&&!x.msf1&&!x.miaf))return i==="avif"||i==="avis"||i==="avio"?{type:"avif",mime:"image/avif"}:i==="heic"||i==="heix"?{type:"heic",mime:"image/heic"}:i==="hevc"||i==="hevx"?{type:"heic",mime:"image/heic-sequence"}:x.avif||x.avis?{type:"avif",mime:"image/avif"}:x.heic||x.heix||x.hevc||x.hevx||x.heis?x.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":263}],266:[function(d,ee,te){var A=d("../common").str2arr,g=d("../common").sliceEq,S=d("../common").readUInt32BE,M=d("../miaf_utils"),e=d("../exif_utils"),a=A("ftyp");ee.exports=function(n){if(!!g(n,4,a)){var r=M.unbox(n,0);if(!!r){var t=M.getMimeType(r.data);if(!!t){for(var c,s=r.end;;){var i=M.unbox(n,s);if(!i)break;if(s=i.end,i.boxtype==="mdat")return;if(i.boxtype==="meta"){c=i.data;break}}if(!!c){var x=M.readSizeFromMeta(c);if(!!x){var p={width:x.width,height:x.height,type:t.type,mime:t.mime,wUnits:"px",hUnits:"px"};if(x.variants.length>1&&(p.variants=x.variants),x.orientation&&(p.orientation=x.orientation),x.exif_location&&x.exif_location.offset+x.exif_location.length<=n.length){var v=S(n,x.exif_location.offset),f=n.slice(x.exif_location.offset+v+4,x.exif_location.offset+x.exif_location.length),y=e.get_orientation(f);y>0&&(p.orientation=y)}return p}}}}}}},{"../common":263,"../exif_utils":264,"../miaf_utils":265}],267:[function(d,ee,te){var A=d("../common").str2arr,g=d("../common").sliceEq,S=d("../common").readUInt16LE,M=A("BM");ee.exports=function(e){if(!(e.length<26)&&!!g(e,0,M))return{width:S(e,18),height:S(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":263}],268:[function(d,ee,te){var A=d("../common").str2arr,g=d("../common").sliceEq,S=d("../common").readUInt16LE,M=A("GIF87a"),e=A("GIF89a");ee.exports=function(a){if(!(a.length<10)&&!(!g(a,0,M)&&!g(a,0,e)))return{width:S(a,6),height:S(a,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":263}],269:[function(d,ee,te){var A=d("../common").readUInt16LE,g=0,S=1,M=16;ee.exports=function(e){var a=A(e,0),n=A(e,2),r=A(e,4);if(!(a!==g||n!==S||!r)){for(var t=[],c={width:0,height:0},s=0;s<r;s++){var i=e[6+M*s]||256,x=e[6+M*s+1]||256,p={width:i,height:x};t.push(p),(i>c.width||x>c.height)&&(c=p)}return{width:c.width,height:c.height,variants:t,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":263}],270:[function(d,ee,te){var A=d("../common").readUInt16BE,g=d("../common").str2arr,S=d("../common").sliceEq,M=d("../exif_utils"),e=g("Exif\0\0");ee.exports=function(a){if(!(a.length<2)&&!(a[0]!==255||a[1]!==216||a[2]!==255))for(var n=2;;){for(;;){if(a.length-n<2)return;if(a[n++]===255)break}for(var r=a[n++],t;r===255;)r=a[n++];if(208<=r&&r<=217||r===1)t=0;else if(192<=r&&r<=254){if(a.length-n<2)return;t=A(a,n)-2,n+=2}else return;if(r===217||r===218)return;var c;if(r===225&&t>=10&&S(a,n,e)&&(c=M.get_orientation(a.slice(n+6,n+t))),t>=5&&192<=r&&r<=207&&r!==196&&r!==200&&r!==204){if(a.length-n<t)return;var s={width:A(a,n+3),height:A(a,n+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return c>0&&(s.orientation=c),s}n+=t}}},{"../common":263,"../exif_utils":264}],271:[function(d,ee,te){var A=d("../common").str2arr,g=d("../common").sliceEq,S=d("../common").readUInt32BE,M=A(`\x89PNG\r

`),e=A("IHDR");ee.exports=function(a){if(!(a.length<24)&&!!g(a,0,M)&&!!g(a,12,e))return{width:S(a,16),height:S(a,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":263}],272:[function(d,ee,te){var A=d("../common").str2arr,g=d("../common").sliceEq,S=d("../common").readUInt32BE,M=A("8BPS\0");ee.exports=function(e){if(!(e.length<6+16)&&!!g(e,0,M))return{width:S(e,6+12),height:S(e,6+8),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":263}],273:[function(d,ee,te){function A(i){return i===32||i===9||i===13||i===10}function g(i){return typeof i=="number"&&isFinite(i)&&i>0}function S(i){var x=0,p=i.length;for(i[0]===239&&i[1]===187&&i[2]===191&&(x=3);x<p&&A(i[x]);)x++;return x===p?!1:i[x]===60}var M=/<[-_.:a-zA-Z0-9][^>]*>/,e=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,a=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,n=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,r=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,t=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function c(i){var x=i.match(a),p=i.match(n),v=i.match(r);return{width:x&&(x[1]||x[2]),height:p&&(p[1]||p[2]),viewbox:v&&(v[1]||v[2])}}function s(i){return t.test(i)?i.match(t)[0]:"px"}ee.exports=function(i){if(!!S(i)){for(var x="",p=0;p<i.length;p++)x+=String.fromCharCode(i[p]);var v=(x.match(M)||[""])[0];if(!!e.test(v)){var f=c(v),y=parseFloat(f.width),o=parseFloat(f.height);if(f.width&&f.height)return!g(y)||!g(o)?void 0:{width:y,height:o,type:"svg",mime:"image/svg+xml",wUnits:s(f.width),hUnits:s(f.height)};var m=(f.viewbox||"").split(" "),l={width:m[2],height:m[3]},w=parseFloat(l.width),_=parseFloat(l.height);if(!(!g(w)||!g(_))&&s(l.width)===s(l.height)){var h=w/_;return f.width?g(y)?{width:y,height:y/h,type:"svg",mime:"image/svg+xml",wUnits:s(f.width),hUnits:s(f.width)}:void 0:f.height?g(o)?{width:o*h,height:o,type:"svg",mime:"image/svg+xml",wUnits:s(f.height),hUnits:s(f.height)}:void 0:{width:w,height:_,type:"svg",mime:"image/svg+xml",wUnits:s(l.width),hUnits:s(l.height)}}}}}},{}],274:[function(d,ee,te){var A=d("../common").str2arr,g=d("../common").sliceEq,S=d("../common").readUInt16LE,M=d("../common").readUInt16BE,e=d("../common").readUInt32LE,a=d("../common").readUInt32BE,n=A("II*\0"),r=A("MM\0*");function t(i,x,p){return p?M(i,x):S(i,x)}function c(i,x,p){return p?a(i,x):e(i,x)}function s(i,x,p){var v=t(i,x+2,p),f=c(i,x+4,p);return f!==1||v!==3&&v!==4?null:v===3?t(i,x+8,p):c(i,x+8,p)}ee.exports=function(i){if(!(i.length<8)&&!(!g(i,0,n)&&!g(i,0,r))){var x=i[0]===77,p=c(i,4,x)-8;if(!(p<0)){var v=p+8;if(!(i.length-v<2)){var f=t(i,v+0,x)*12;if(!(f<=0)&&(v+=2,!(i.length-v<f))){var y,o,m,l;for(y=0;y<f;y+=12)l=t(i,v+y,x),l===256?o=s(i,v+y,x):l===257&&(m=s(i,v+y,x));if(o&&m)return{width:o,height:m,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}}}}}}},{"../common":263}],275:[function(d,ee,te){var A=d("../common").str2arr,g=d("../common").sliceEq,S=d("../common").readUInt16LE,M=d("../common").readUInt32LE,e=d("../exif_utils"),a=A("RIFF"),n=A("WEBP");function r(s,i){if(!(s[i+3]!==157||s[i+4]!==1||s[i+5]!==42))return{width:S(s,i+6)&16383,height:S(s,i+8)&16383,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function t(s,i){if(s[i]===47){var x=M(s,i+1);return{width:(x&16383)+1,height:(x>>14&16383)+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function c(s,i){return{width:(s[i+6]<<16|s[i+5]<<8|s[i+4])+1,height:(s[i+9]<<i|s[i+8]<<8|s[i+7])+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}ee.exports=function(s){if(!(s.length<16)&&!(!g(s,0,a)&&!g(s,8,n))){var i=12,x=null,p=0,v=M(s,4)+8;if(!(v>s.length)){for(;i+8<v;){if(s[i]===0){i++;continue}var f=String.fromCharCode.apply(null,s.slice(i,i+4)),y=M(s,i+4);f==="VP8 "&&y>=10?x=x||r(s,i+8):f==="VP8L"&&y>=9?x=x||t(s,i+8):f==="VP8X"&&y>=10?x=x||c(s,i+8):f==="EXIF"&&(p=e.get_orientation(s.slice(i+8,i+8+y)),i=1/0),i+=8+y}if(!!x)return p>0&&(x.orientation=p),x}}}},{"../common":263,"../exif_utils":264}],276:[function(d,ee,te){ee.exports={avif:d("./parse_sync/avif"),bmp:d("./parse_sync/bmp"),gif:d("./parse_sync/gif"),ico:d("./parse_sync/ico"),jpeg:d("./parse_sync/jpeg"),png:d("./parse_sync/png"),psd:d("./parse_sync/psd"),svg:d("./parse_sync/svg"),tiff:d("./parse_sync/tiff"),webp:d("./parse_sync/webp")}},{"./parse_sync/avif":266,"./parse_sync/bmp":267,"./parse_sync/gif":268,"./parse_sync/ico":269,"./parse_sync/jpeg":270,"./parse_sync/png":271,"./parse_sync/psd":272,"./parse_sync/svg":273,"./parse_sync/tiff":274,"./parse_sync/webp":275}],277:[function(d,ee,te){var A=d("./lib/parsers_sync");function g(S){for(var M=Object.keys(A),e=0;e<M.length;e++){var a=A[M[e]](S);if(a)return a}return null}ee.exports=function(M){return g(M)},ee.exports.parsers=A},{"./lib/parsers_sync":276}],278:[function(d,ee,te){var A=ee.exports={},g,S;function M(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?g=setTimeout:g=M}catch{g=M}try{typeof clearTimeout=="function"?S=clearTimeout:S=e}catch{S=e}})();function a(f){if(g===setTimeout)return setTimeout(f,0);if((g===M||!g)&&setTimeout)return g=setTimeout,setTimeout(f,0);try{return g(f,0)}catch{try{return g.call(null,f,0)}catch{return g.call(this,f,0)}}}function n(f){if(S===clearTimeout)return clearTimeout(f);if((S===e||!S)&&clearTimeout)return S=clearTimeout,clearTimeout(f);try{return S(f)}catch{try{return S.call(null,f)}catch{return S.call(this,f)}}}var r=[],t=!1,c,s=-1;function i(){!t||!c||(t=!1,c.length?r=c.concat(r):s=-1,r.length&&x())}function x(){if(!t){var f=a(i);t=!0;for(var y=r.length;y;){for(c=r,r=[];++s<y;)c&&c[s].run();s=-1,y=r.length}c=null,t=!1,n(f)}}A.nextTick=function(f){var y=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)y[o-1]=arguments[o];r.push(new p(f,y)),r.length===1&&!t&&a(x)};function p(f,y){this.fun=f,this.array=y}p.prototype.run=function(){this.fun.apply(null,this.array)},A.title="browser",A.browser=!0,A.env={},A.argv=[],A.version="",A.versions={};function v(){}A.on=v,A.addListener=v,A.once=v,A.off=v,A.removeListener=v,A.removeAllListeners=v,A.emit=v,A.prependListener=v,A.prependOnceListener=v,A.listeners=function(f){return[]},A.binding=function(f){throw new Error("process.binding is not supported")},A.cwd=function(){return"/"},A.chdir=function(f){throw new Error("process.chdir is not supported")},A.umask=function(){return 0}},{}],279:[function(d,ee,te){(function(A){(function(){for(var g=d("performance-now"),S=typeof window>"u"?A:window,M=["moz","webkit"],e="AnimationFrame",a=S["request"+e],n=S["cancel"+e]||S["cancelRequest"+e],r=0;!a&&r<M.length;r++)a=S[M[r]+"Request"+e],n=S[M[r]+"Cancel"+e]||S[M[r]+"CancelRequest"+e];if(!a||!n){var t=0,c=0,s=[],i=1e3/60;a=function(x){if(s.length===0){var p=g(),v=Math.max(0,i-(p-t));t=v+p,setTimeout(function(){var f=s.slice(0);s.length=0;for(var y=0;y<f.length;y++)if(!f[y].cancelled)try{f[y].callback(t)}catch(o){setTimeout(function(){throw o},0)}},Math.round(v))}return s.push({handle:++c,callback:x,cancelled:!1}),c},n=function(x){for(var p=0;p<s.length;p++)s[p].handle===x&&(s[p].cancelled=!0)}}ee.exports=function(x){return a.call(S,x)},ee.exports.cancel=function(){n.apply(S,arguments)},ee.exports.polyfill=function(x){x||(x=S),x.requestAnimationFrame=a,x.cancelAnimationFrame=n}}).call(this)}).call(this,typeof Mo<"u"?Mo:typeof self<"u"?self:typeof window<"u"?window:{})},{"performance-now":252}],280:[function(d,ee,te){var A=d("array-bounds"),g=d("color-normalize"),S=d("update-diff"),M=d("pick-by-alias"),e=d("object-assign"),a=d("flatten-vertex-data"),n=d("to-float32"),r=n.float32,t=n.fract32;ee.exports=s;var c=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]];function s(i,x){if(typeof i=="function"?(x||(x={}),x.regl=i):x=i,x.length&&(x.positions=x),i=x.regl,!i.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var p=i._gl,v,f,y,o,m,l,w={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},_=[];return o=i.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),f=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),y=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),m=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),l=i.buffer({usage:"static",type:"float",data:c}),L(x),v=i({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:i.prop("range"),lineWidth:i.prop("lineWidth"),capSize:i.prop("capSize"),opacity:i.prop("opacity"),scale:i.prop("scale"),translate:i.prop("translate"),scaleFract:i.prop("scaleFract"),translateFract:i.prop("translateFract"),viewport:function(k,P){return[P.viewport.x,P.viewport.y,k.viewportWidth,k.viewportHeight]}},attributes:{color:{buffer:o,offset:function(k,P){return P.offset*4},divisor:1},position:{buffer:f,offset:function(k,P){return P.offset*8},divisor:1},positionFract:{buffer:y,offset:function(k,P){return P.offset*8},divisor:1},error:{buffer:m,offset:function(k,P){return P.offset*16},divisor:1},direction:{buffer:l,stride:24,offset:0},lineOffset:{buffer:l,stride:24,offset:8},capOffset:{buffer:l,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:i.prop("viewport")},viewport:i.prop("viewport"),stencil:!1,instances:i.prop("count"),count:c.length}),e(h,{update:L,draw:b,destroy:T,regl:i,gl:p,canvas:p.canvas,groups:_}),h;function h(k){k?L(k):k===null&&T(),b()}function b(k){if(typeof k=="number")return u(k);k&&!Array.isArray(k)&&(k=[k]),i._refresh(),_.forEach(function(P,z){if(!!P){if(k&&(k[z]?P.draw=!0:P.draw=!1),!P.draw){P.draw=!0;return}u(z)}})}function u(k){typeof k=="number"&&(k=_[k]),k!=null&&(!(k&&k.count&&k.color&&k.opacity&&k.positions&&k.positions.length>1)||(k.scaleRatio=[k.scale[0]*k.viewport.width,k.scale[1]*k.viewport.height],v(k),k.after&&k.after(k)))}function L(k){if(!!k){k.length!=null?typeof k[0]=="number"&&(k=[{positions:k}]):Array.isArray(k)||(k=[k]);var P=0,z=0;if(h.groups=_=k.map(function(G,K){var W=_[K];if(G)typeof G=="function"?G={after:G}:typeof G[0]=="number"&&(G={positions:G});else return W;return G=M(G,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),W||(_[K]=W={id:K,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},G=e({},w,G)),S(W,G,[{lineWidth:function(Y){return+Y*.5},capSize:function(Y){return+Y*.5},opacity:parseFloat,errors:function(Y){return Y=a(Y),z+=Y.length,Y},positions:function(Y,re){return Y=a(Y,"float64"),re.count=Math.floor(Y.length/2),re.bounds=A(Y,2),re.offset=P,P+=re.count,Y}},{color:function(Y,re){var ue=re.count;if(Y||(Y="transparent"),!Array.isArray(Y)||typeof Y[0]=="number"){var j=Y;Y=Array(ue);for(var q=0;q<ue;q++)Y[q]=j}if(Y.length<ue)throw Error("Not enough colors");for(var V=new Uint8Array(ue*4),U=0;U<ue;U++){var $=g(Y[U],"uint8");V.set($,U*4)}return V},range:function(Y,re,ue){var j=re.bounds;return Y||(Y=j),re.scale=[1/(Y[2]-Y[0]),1/(Y[3]-Y[1])],re.translate=[-Y[0],-Y[1]],re.scaleFract=t(re.scale),re.translateFract=t(re.translate),Y},viewport:function(Y){var re;return Array.isArray(Y)?re={x:Y[0],y:Y[1],width:Y[2]-Y[0],height:Y[3]-Y[1]}:Y?(re={x:Y.x||Y.left||0,y:Y.y||Y.top||0},Y.right?re.width=Y.right-re.x:re.width=Y.w||Y.width||0,Y.bottom?re.height=Y.bottom-re.y:re.height=Y.h||Y.height||0):re={x:0,y:0,width:p.drawingBufferWidth,height:p.drawingBufferHeight},re}}]),W}),P||z){var I=_.reduce(function(G,K,W){return G+(K?K.count:0)},0),D=new Float64Array(I*2),R=new Uint8Array(I*4),O=new Float32Array(I*4);_.forEach(function(G,K){if(!!G){var W=G.positions,Y=G.count,re=G.offset,ue=G.color,j=G.errors;!Y||(R.set(ue,re*4),O.set(j,re*4),D.set(W,re*2))}});var F=r(D);f(F);var N=t(D,F);y(N),o(R),m(O)}}}function T(){f.destroy(),y.destroy(),o.destroy(),m.destroy(),l.destroy()}}},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":314,"update-diff":330}],281:[function(d,ee,te){var A=d("color-normalize"),g=d("array-bounds"),S=d("object-assign"),M=d("glslify"),e=d("pick-by-alias"),a=d("flatten-vertex-data"),n=d("earcut"),r=d("array-normalize"),t=d("to-float32"),c=t.float32,s=t.fract32,i=d("es6-weak-map"),x=d("parse-rect"),p=d("array-find-index");ee.exports=v;function v(f,y){if(!(this instanceof v))return new v(f,y);if(typeof f=="function"?(y||(y={}),y.regl=f):y=f,y.length&&(y.positions=y),f=y.regl,!f.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=f._gl,this.regl=f,this.passes=[],this.shaders=v.shaders.has(f)?v.shaders.get(f):v.shaders.set(f,v.createShaders(f)).get(f),this.update(y)}v.dashMult=2,v.maxPatternLength=256,v.precisionThreshold=3e6,v.maxPoints=1e4,v.maxLines=2048,v.shaders=new i,v.createShaders=function(f){var y=f.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),o={primitive:"triangle strip",instances:f.prop("count"),count:4,offset:0,uniforms:{miterMode:function(_,h){return h.join==="round"?2:1},miterLimit:f.prop("miterLimit"),scale:f.prop("scale"),scaleFract:f.prop("scaleFract"),translateFract:f.prop("translateFract"),translate:f.prop("translate"),thickness:f.prop("thickness"),dashTexture:f.prop("dashTexture"),opacity:f.prop("opacity"),pixelRatio:f.context("pixelRatio"),id:f.prop("id"),dashLength:f.prop("dashLength"),viewport:function(_,h){return[h.viewport.x,h.viewport.y,_.viewportWidth,_.viewportHeight]},depth:f.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(_,h){return!h.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:f.prop("viewport")},viewport:f.prop("viewport")},m=f(S({vert:M([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:M([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:y,divisor:0,stride:8,offset:0},lineTop:{buffer:y,divisor:0,stride:8,offset:4},aCoord:{buffer:f.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:f.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:f.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:f.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:f.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},o)),l;try{l=f(S({cull:{enable:!0,face:"back"},vert:M([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:M([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:y,divisor:0,stride:8,offset:0},lineTop:{buffer:y,divisor:0,stride:8,offset:4},aColor:{buffer:f.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:f.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:f.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:f.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:f.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:f.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},o))}catch{l=m}var w=f({primitive:"triangle",elements:function(_,h){return h.triangles},offset:0,vert:M([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:M([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:f.prop("scale"),color:f.prop("fill"),scaleFract:f.prop("scaleFract"),translateFract:f.prop("translateFract"),translate:f.prop("translate"),opacity:f.prop("opacity"),pixelRatio:f.context("pixelRatio"),id:f.prop("id"),viewport:function(_,h){return[h.viewport.x,h.viewport.y,_.viewportWidth,_.viewportHeight]}},attributes:{position:{buffer:f.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:f.prop("positionFractBuffer"),stride:8,offset:8}},blend:o.blend,depth:{enable:!1},scissor:o.scissor,stencil:o.stencil,viewport:o.viewport});return{fill:w,rect:m,miter:l}},v.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},v.prototype.render=function(){for(var f,y=[],o=arguments.length;o--;)y[o]=arguments[o];y.length&&(f=this).update.apply(f,y),this.draw()},v.prototype.draw=function(){for(var f=this,y=[],o=arguments.length;o--;)y[o]=arguments[o];return(y.length?y:this.passes).forEach(function(m,l){var w;if(m&&Array.isArray(m))return(w=f).draw.apply(w,m);typeof m=="number"&&(m=f.passes[m]),m&&m.count>1&&m.opacity&&(f.regl._refresh(),m.fill&&m.triangles&&m.triangles.length>2&&f.shaders.fill(m),m.thickness&&(m.scale[0]*m.viewport.width>v.precisionThreshold||m.scale[1]*m.viewport.height>v.precisionThreshold||m.join==="rect"||!m.join&&(m.thickness<=2||m.count>=v.maxPoints)?f.shaders.rect(m):f.shaders.miter(m)))}),this},v.prototype.update=function(f){var y=this;if(!!f){f.length!=null?typeof f[0]=="number"&&(f=[{positions:f}]):Array.isArray(f)||(f=[f]);var o=this,m=o.regl,l=o.gl;if(f.forEach(function(u,L){var T=y.passes[L];if(u!==void 0){if(u===null){y.passes[L]=null;return}if(typeof u[0]=="number"&&(u={positions:u}),u=e(u,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),T||(y.passes[L]=T={id:L,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:m.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:m.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:m.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:m.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},u=S({},v.defaults,u)),u.thickness!=null&&(T.thickness=parseFloat(u.thickness)),u.opacity!=null&&(T.opacity=parseFloat(u.opacity)),u.miterLimit!=null&&(T.miterLimit=parseFloat(u.miterLimit)),u.overlay!=null&&(T.overlay=!!u.overlay,L<v.maxLines&&(T.depth=2*(v.maxLines-1-L%v.maxLines)/v.maxLines-1)),u.join!=null&&(T.join=u.join),u.hole!=null&&(T.hole=u.hole),u.fill!=null&&(T.fill=u.fill?A(u.fill,"uint8"):null),u.viewport!=null&&(T.viewport=x(u.viewport)),T.viewport||(T.viewport=x([l.drawingBufferWidth,l.drawingBufferHeight])),u.close!=null&&(T.close=u.close),u.positions===null&&(u.positions=[]),u.positions){var k,P;if(u.positions.x&&u.positions.y){var z=u.positions.x,I=u.positions.y;P=T.count=Math.max(z.length,I.length),k=new Float64Array(P*2);for(var D=0;D<P;D++)k[D*2]=z[D],k[D*2+1]=I[D]}else k=a(u.positions,"float64"),P=T.count=Math.floor(k.length/2);var R=T.bounds=g(k,2);if(T.fill){for(var O=[],F={},N=0,G=0,K=0,W=T.count;G<W;G++){var Y=k[G*2],re=k[G*2+1];isNaN(Y)||isNaN(re)||Y==null||re==null?(Y=k[N*2],re=k[N*2+1],F[G]=N):N=G,O[K++]=Y,O[K++]=re}if(u.splitNull){T.count-1 in F||(F[T.count]=T.count-1);var ue=Object.keys(F).map(Number).sort(function(Ye,rt){return Ye-rt}),j=[],q=0,V=T.hole!=null?T.hole[0]:null;if(V!=null){var U=p(ue,function(Ye){return Ye>=V});ue=ue.slice(0,U),ue.push(V)}for(var $=function(Ye){var rt=O.slice(q*2,ue[Ye]*2).concat(V?O.slice(V*2):[]),Ve=(T.hole||[]).map(function(Ue){return Ue-V+(ue[Ye]-q)}),Ae=n(rt,Ve);Ae=Ae.map(function(Ue){return Ue+q+(Ue+q<ue[Ye]?0:V-ue[Ye])}),j.push.apply(j,Ae),q=ue[Ye]+1},ne=0;ne<ue.length;ne++)$(ne);for(var X=0,Q=j.length;X<Q;X++)F[j[X]]!=null&&(j[X]=F[j[X]]);T.triangles=j}else{for(var ie=n(O,T.hole||[]),se=0,ae=ie.length;se<ae;se++)F[ie[se]]!=null&&(ie[se]=F[ie[se]]);T.triangles=ie}}var oe=new Float64Array(k);r(oe,2,R);var be=new Float64Array(P*2+6);T.close?k[0]===k[P*2-2]&&k[1]===k[P*2-1]?(be[0]=oe[P*2-4],be[1]=oe[P*2-3]):(be[0]=oe[P*2-2],be[1]=oe[P*2-1]):(be[0]=oe[0],be[1]=oe[1]),be.set(oe,2),T.close?k[0]===k[P*2-2]&&k[1]===k[P*2-1]?(be[P*2+2]=oe[2],be[P*2+3]=oe[3],T.count-=1):(be[P*2+2]=oe[0],be[P*2+3]=oe[1],be[P*2+4]=oe[2],be[P*2+5]=oe[3]):(be[P*2+2]=oe[P*2-2],be[P*2+3]=oe[P*2-1],be[P*2+4]=oe[P*2-2],be[P*2+5]=oe[P*2-1]);var ce=c(be);T.positionBuffer(ce);var de=s(be,ce);T.positionFractBuffer(de)}if(u.range?T.range=u.range:T.range||(T.range=T.bounds),(u.range||u.positions)&&T.count){var ye=T.bounds,ge=ye[2]-ye[0],me=ye[3]-ye[1],Ee=T.range[2]-T.range[0],Pe=T.range[3]-T.range[1];T.scale=[ge/Ee,me/Pe],T.translate=[-T.range[0]/Ee+ye[0]/Ee||0,-T.range[1]/Pe+ye[1]/Pe||0],T.scaleFract=s(T.scale),T.translateFract=s(T.translate)}if(u.dashes){var Ne=0,we;if(!u.dashes||u.dashes.length<2)Ne=1,we=new Uint8Array([255,255,255,255,255,255,255,255]);else{Ne=0;for(var ke=0;ke<u.dashes.length;++ke)Ne+=u.dashes[ke];we=new Uint8Array(Ne*v.dashMult);for(var Xe=0,He=255,Ie=0;Ie<2;Ie++)for(var De=0;De<u.dashes.length;++De){for(var Ge=0,ht=u.dashes[De]*v.dashMult*.5;Ge<ht;++Ge)we[Xe++]=He;He^=255}}T.dashLength=Ne,T.dashTexture({channels:1,data:we,width:we.length,height:1,mag:"linear",min:"linear"},0,0)}if(u.color){var Rt=T.count,Kt=u.color;Kt||(Kt="transparent");var It=new Uint8Array(Rt*4+4);if(!Array.isArray(Kt)||typeof Kt[0]=="number")for(var Mt=A(Kt,"uint8"),Yt=0;Yt<Rt+1;Yt++)It.set(Mt,Yt*4);else{for(var zt=0;zt<Rt;zt++){var St=A(Kt[zt],"uint8");It.set(St,zt*4)}It.set(A(Kt[0],"uint8"),Rt*4)}T.colorBuffer({usage:"dynamic",type:"uint8",data:It})}}}),f.length<this.passes.length){for(var w=f.length;w<this.passes.length;w++){var _=this.passes[w];!_||(_.colorBuffer.destroy(),_.positionBuffer.destroy(),_.dashTexture.destroy())}this.passes.length=f.length}for(var h=[],b=0;b<this.passes.length;b++)this.passes[b]!==null&&h.push(this.passes[b]);return this.passes=h,this}},v.prototype.destroy=function(){return this.passes.forEach(function(f){f.colorBuffer.destroy(),f.positionBuffer.destroy(),f.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314}],282:[function(d,ee,te){function A(T,k){return M(T)||a(T,k)||n(T,k)||c()}function g(T){return S(T)||e(T)||n(T)||t()}function S(T){if(Array.isArray(T))return r(T)}function M(T){if(Array.isArray(T))return T}function e(T){if(typeof Symbol<"u"&&T[Symbol.iterator]!=null||T["@@iterator"]!=null)return Array.from(T)}function a(T,k){var P=T==null?null:typeof Symbol<"u"&&T[Symbol.iterator]||T["@@iterator"];if(P!=null){var z=[],I=!0,D=!1,R,O;try{for(P=P.call(T);!(I=(R=P.next()).done)&&(z.push(R.value),!(k&&z.length===k));I=!0);}catch(F){D=!0,O=F}finally{try{!I&&P.return!=null&&P.return()}finally{if(D)throw O}}return z}}function n(T,k){if(!!T){if(typeof T=="string")return r(T,k);var P=Object.prototype.toString.call(T).slice(8,-1);if(P==="Object"&&T.constructor&&(P=T.constructor.name),P==="Map"||P==="Set")return Array.from(T);if(P==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P))return r(T,k)}}function r(T,k){(k==null||k>T.length)&&(k=T.length);for(var P=0,z=new Array(k);P<k;P++)z[P]=T[P];return z}function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=d("color-normalize"),i=d("array-bounds"),x=d("color-id"),p=d("@plotly/point-cluster"),v=d("object-assign"),f=d("glslify"),y=d("pick-by-alias"),o=d("update-diff"),m=d("flatten-vertex-data"),l=d("is-iexplorer"),w=d("to-float32"),_=d("parse-rect"),h=b;function b(T,k){var P=this;if(!(this instanceof b))return new b(T,k);typeof T=="function"?(k||(k={}),k.regl=T):(k=T,T=null),k&&k.length&&(k.positions=k),T=k.regl;var z=T._gl,I,D=[],R={},O=[],F=[null],N=[null],G=255,K=100;this.tooManyColors=l,I=T.texture({data:new Uint8Array(G*4),width:G,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),v(this,{regl:T,gl:z,groups:O,markerCache:N,markerTextures:F,palette:D,paletteIds:R,paletteTexture:I,maxColors:G,maxSize:K,canvas:z.canvas}),this.update(k);var W={uniforms:{constPointSize:!!k.constPointSize,opacity:T.prop("opacity"),paletteSize:function(j,q){return[P.tooManyColors?0:G,I.height]},pixelRatio:T.context("pixelRatio"),scale:T.prop("scale"),scaleFract:T.prop("scaleFract"),translate:T.prop("translate"),translateFract:T.prop("translateFract"),markerTexture:T.prop("markerTexture"),paletteTexture:I},attributes:{x:function(j,q){return q.xAttr||{buffer:q.positionBuffer,stride:8,offset:0}},y:function(j,q){return q.yAttr||{buffer:q.positionBuffer,stride:8,offset:4}},xFract:function(j,q){return q.xAttr?{constant:[0,0]}:{buffer:q.positionFractBuffer,stride:8,offset:0}},yFract:function(j,q){return q.yAttr?{constant:[0,0]}:{buffer:q.positionFractBuffer,stride:8,offset:4}},size:function(j,q){return q.size.length?{buffer:q.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(q.size*255/P.maxSize)]}},borderSize:function(j,q){return q.borderSize.length?{buffer:q.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(q.borderSize*255/P.maxSize)]}},colorId:function(j,q){return q.color.length?{buffer:q.colorBuffer,stride:P.tooManyColors?8:4,offset:0}:{constant:P.tooManyColors?D.slice(q.color*4,q.color*4+4):[q.color]}},borderColorId:function(j,q){return q.borderColor.length?{buffer:q.colorBuffer,stride:P.tooManyColors?8:4,offset:P.tooManyColors?4:2}:{constant:P.tooManyColors?D.slice(q.borderColor*4,q.borderColor*4+4):[q.borderColor]}},isActive:function(j,q){return q.activation===!0?{constant:[1]}:q.activation?q.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:T.prop("viewport")},viewport:T.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:T.prop("elements"),count:T.prop("count"),offset:T.prop("offset"),primitive:"points"},Y=v({},W);Y.frag=f([`precision highp float;
#define GLSLIFY 1

uniform float opacity;
uniform sampler2D markerTexture;

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),Y.vert=f([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform sampler2D paletteTexture;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=T(Y);var re=v({},W);re.frag=f([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

uniform float opacity;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),re.vert=f([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 paletteSize, scale, scaleFract, translate, translateFract;
uniform sampler2D paletteTexture;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),l&&(re.frag=re.frag.replace("smoothstep","smoothStep"),Y.frag=Y.frag.replace("smoothstep","smoothStep")),this.drawCircle=T(re)}b.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},b.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},b.prototype.draw=function(){for(var T=this,k=arguments.length,P=new Array(k),z=0;z<k;z++)P[z]=arguments[z];var I=this.groups;if(P.length===1&&Array.isArray(P[0])&&(P[0][0]===null||Array.isArray(P[0][0]))&&(P=P[0]),this.regl._refresh(),P.length)for(var D=0;D<P.length;D++)this.drawItem(D,P[D]);else I.forEach(function(R,O){T.drawItem(O)});return this},b.prototype.drawItem=function(T,k){var P=this.groups,z=P[T];if(typeof k=="number"&&(T=k,z=P[k],k=null),!!(z&&z.count&&z.opacity)){z.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,z,k));for(var I=[],D=1;D<z.activation.length;D++)!z.activation[D]||z.activation[D]!==!0&&!z.activation[D].data.length||I.push.apply(I,g(this.getMarkerDrawOptions(D,z,k)));I.length&&this.drawMarker(I)}},b.prototype.getMarkerDrawOptions=function(T,k,P){var z=k.range,I=k.tree,D=k.viewport,R=k.activation,O=k.selectionBuffer,F=k.count;if(this.regl,!I)return P?[v({},k,{markerTexture:this.markerTextures[T],activation:R[T],count:P.length,elements:P,offset:0})]:[v({},k,{markerTexture:this.markerTextures[T],activation:R[T],offset:0})];var N=[],G=I.range(z,{lod:!0,px:[(z[2]-z[0])/D.width,(z[3]-z[1])/D.height]});if(P){for(var K=R[T],W=K.data,Y=new Uint8Array(F),re=0;re<P.length;re++){var ue=P[re];Y[ue]=W?W[ue]:1}O.subdata(Y)}for(var j=G.length;j--;){var q=A(G[j],2),V=q[0],U=q[1];N.push(v({},k,{markerTexture:this.markerTextures[T],activation:P?O:R[T],offset:V,count:U-V}))}return N},b.prototype.update=function(){for(var T=this,k=arguments.length,P=new Array(k),z=0;z<k;z++)P[z]=arguments[z];if(!!P.length){P.length===1&&Array.isArray(P[0])&&(P=P[0]);var I=this.groups,D=this.gl,R=this.regl,O=this.maxSize,F=this.maxColors,N=this.palette;this.groups=I=P.map(function(G,K){var W=I[K];if(G===void 0)return W;G===null?G={positions:null}:typeof G=="function"?G={ondraw:G}:typeof G[0]=="number"&&(G={positions:G}),G=y(G,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"}),G.positions===null&&(G.positions=[]),G.tooManyColors!=null&&(T.tooManyColors=G.tooManyColors),W||(I[K]=W={id:K,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:R.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},G=v({},b.defaults,G)),G.positions&&!("marker"in G)&&(G.marker=W.marker,delete W.marker),G.marker&&!("positions"in G)&&(G.positions=W.positions,delete W.positions);var Y=0,re=0;if(o(W,G,[{snap:!0,size:function(me,Ee){return me==null&&(me=b.defaults.size),Y+=me&&me.length?1:0,me},borderSize:function(me,Ee){return me==null&&(me=b.defaults.borderSize),Y+=me&&me.length?1:0,me},opacity:parseFloat,color:function(me,Ee){return me==null&&(me=b.defaults.color),me=T.updateColor(me),re++,me},borderColor:function(me,Ee){return me==null&&(me=b.defaults.borderColor),me=T.updateColor(me),re++,me},bounds:function(me,Ee,Pe){return"range"in Pe||(Pe.range=null),me},positions:function(me,Ee,Pe){var Ne=Ee.snap,we=Ee.positionBuffer,ke=Ee.positionFractBuffer,Xe=Ee.selectionBuffer;if(me.x||me.y)return me.x.length?Ee.xAttr={buffer:R.buffer(me.x),offset:0,stride:4,count:me.x.length}:Ee.xAttr={buffer:me.x.buffer,offset:me.x.offset*4||0,stride:(me.x.stride||1)*4,count:me.x.count},me.y.length?Ee.yAttr={buffer:R.buffer(me.y),offset:0,stride:4,count:me.y.length}:Ee.yAttr={buffer:me.y.buffer,offset:me.y.offset*4||0,stride:(me.y.stride||1)*4,count:me.y.count},Ee.count=Math.max(Ee.xAttr.count,Ee.yAttr.count),me;me=m(me,"float64");var He=Ee.count=Math.floor(me.length/2),Ie=Ee.bounds=He?i(me,2):null;if(!Pe.range&&!Ee.range&&(delete Ee.range,Pe.range=Ie),!Pe.marker&&!Ee.marker&&(delete Ee.marker,Pe.marker=null),Ne&&(Ne===!0||He>Ne)?Ee.tree=p(me,{bounds:Ie}):Ne&&Ne.length&&(Ee.tree=Ne),Ee.tree){var De={primitive:"points",usage:"static",data:Ee.tree,type:"uint32"};Ee.elements?Ee.elements(De):Ee.elements=R.elements(De)}var Ge=w.float32(me);we({data:Ge,usage:"dynamic"});var ht=w.fract32(me,Ge);return ke({data:ht,usage:"dynamic"}),Xe({data:new Uint8Array(He),type:"uint8",usage:"stream"}),me}},{marker:function(me,Ee,Pe){var Ne=Ee.activation;if(Ne.forEach(function(ht){return ht&&ht.destroy&&ht.destroy()}),Ne.length=0,!me||typeof me[0]=="number"){var we=T.addMarker(me);Ne[we]=!0}else{for(var ke=[],Xe=0,He=Math.min(me.length,Ee.count);Xe<He;Xe++){var Ie=T.addMarker(me[Xe]);ke[Ie]||(ke[Ie]=new Uint8Array(Ee.count)),ke[Ie][Xe]=1}for(var De=0;De<ke.length;De++)if(!!ke[De]){var Ge={data:ke[De],type:"uint8",usage:"static"};Ne[De]?Ne[De](Ge):Ne[De]=R.buffer(Ge),Ne[De].data=ke[De]}}return me},range:function(me,Ee,Pe){var Ne=Ee.bounds;if(!!Ne)return me||(me=Ne),Ee.scale=[1/(me[2]-me[0]),1/(me[3]-me[1])],Ee.translate=[-me[0],-me[1]],Ee.scaleFract=w.fract(Ee.scale),Ee.translateFract=w.fract(Ee.translate),me},viewport:function(me){var Ee=_(me||[D.drawingBufferWidth,D.drawingBufferHeight]);return Ee}}]),Y){var ue=W,j=ue.count,q=ue.size,V=ue.borderSize,U=ue.sizeBuffer,$=new Uint8Array(j*2);if(q.length||V.length)for(var ne=0;ne<j;ne++)$[ne*2]=Math.round((q[ne]==null?q:q[ne])*255/O),$[ne*2+1]=Math.round((V[ne]==null?V:V[ne])*255/O);U({data:$,usage:"dynamic"})}if(re){var X=W,Q=X.count,ie=X.color,se=X.borderColor,ae=X.colorBuffer,oe;if(T.tooManyColors){if(ie.length||se.length){oe=new Uint8Array(Q*8);for(var be=0;be<Q;be++){var ce=ie[be];oe[be*8]=N[ce*4],oe[be*8+1]=N[ce*4+1],oe[be*8+2]=N[ce*4+2],oe[be*8+3]=N[ce*4+3];var de=se[be];oe[be*8+4]=N[de*4],oe[be*8+5]=N[de*4+1],oe[be*8+6]=N[de*4+2],oe[be*8+7]=N[de*4+3]}}}else if(ie.length||se.length){oe=new Uint8Array(Q*4+2);for(var ye=0;ye<Q;ye++)ie[ye]!=null&&(oe[ye*4]=ie[ye]%F,oe[ye*4+1]=Math.floor(ie[ye]/F)),se[ye]!=null&&(oe[ye*4+2]=se[ye]%F,oe[ye*4+3]=Math.floor(se[ye]/F))}ae({data:oe||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return W})}},b.prototype.addMarker=function(T){var k=this.markerTextures,P=this.regl,z=this.markerCache,I=T==null?0:z.indexOf(T);if(I>=0)return I;var D;if(T instanceof Uint8Array||T instanceof Uint8ClampedArray)D=T;else{D=new Uint8Array(T.length);for(var R=0,O=T.length;R<O;R++)D[R]=T[R]*255}var F=Math.floor(Math.sqrt(D.length));return I=k.length,z.push(T),k.push(P.texture({channels:1,data:D,radius:F,mag:"linear",min:"linear"})),I},b.prototype.updateColor=function(T){var k=this.paletteIds,P=this.palette,z=this.maxColors;Array.isArray(T)||(T=[T]);var I=[];if(typeof T[0]=="number"){var D=[];if(Array.isArray(T))for(var R=0;R<T.length;R+=4)D.push(T.slice(R,R+4));else for(var O=0;O<T.length;O+=4)D.push(T.subarray(O,O+4));T=D}for(var F=0;F<T.length;F++){var N=T[F];N=s(N,"uint8");var G=x(N,!1);if(k[G]==null){var K=P.length;k[G]=Math.floor(K/4),P[K]=N[0],P[K+1]=N[1],P[K+2]=N[2],P[K+3]=N[3]}I[F]=k[G]}return!this.tooManyColors&&P.length>z*4&&(this.tooManyColors=!0),this.updatePalette(P),I.length===1?I[0]:I},b.prototype.updatePalette=function(T){if(!this.tooManyColors){var k=this.maxColors,P=this.paletteTexture,z=Math.ceil(T.length*.25/k);if(z>1){T=T.slice();for(var I=T.length*.25%k;I<z*k;I++)T.push(0,0,0,0)}P.height<z&&P.resize(k,z),P.subimage({width:Math.min(T.length*.25,k),height:z,data:T},0,0)}},b.prototype.destroy=function(){return this.groups.forEach(function(T){T.sizeBuffer.destroy(),T.positionBuffer.destroy(),T.positionFractBuffer.destroy(),T.colorBuffer.destroy(),T.activation.forEach(function(k){return k&&k.destroy&&k.destroy()}),T.selectionBuffer.destroy(),T.elements&&T.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(T){return T&&T.destroy&&T.destroy()}),this};var u=d("object-assign"),L=function(k,P){var z=new h(k,P),I=z.render.bind(z);return u(I,{render:I,update:z.update.bind(z),draw:z.draw.bind(z),destroy:z.destroy.bind(z),regl:z.regl,gl:z.gl,canvas:z.gl.canvas,groups:z.groups,markers:z.markerCache,palette:z.palette}),I};ee.exports=L},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314,"update-diff":330}],283:[function(d,ee,te){var A=d("regl-scatter2d"),g=d("pick-by-alias"),S=d("array-bounds"),M=d("raf"),e=d("array-range"),a=d("parse-rect"),n=d("flatten-vertex-data");ee.exports=r;function r(i,x){if(!(this instanceof r))return new r(i);this.traces=[],this.passes={},this.regl=i,this.scatter=A(i),this.canvas=this.scatter.canvas}r.prototype.render=function(){for(var i=this,x,p=[],v=arguments.length;v--;)p[v]=arguments[v];return p.length&&(x=this).update.apply(x,p),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=M(function(){i.draw(),i.dirty=!0,i.planned=null})):(this.draw(),this.dirty=!0,M(function(){i.dirty=!1})),this)},r.prototype.update=function(){for(var i,x=[],p=arguments.length;p--;)x[p]=arguments[p];if(!!x.length){for(var v=0;v<x.length;v++)this.updateItem(v,x[v]);this.traces=this.traces.filter(Boolean);for(var f=[],y=0,o=0;o<this.traces.length;o++){for(var m=this.traces[o],l=this.traces[o].passes,w=0;w<l.length;w++)f.push(this.passes[l[w]]);m.passOffset=y,y+=m.passes.length}return(i=this.scatter).update.apply(i,f),this}},r.prototype.updateItem=function(i,x){var p=this,v=p.regl;if(x===null)return this.traces[i]=null,this;if(!x)return this;var f=g(x,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),y=this.traces[i]||(this.traces[i]={id:i,buffer:v.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:a([v._gl.drawingBufferWidth,v._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(f.color!=null&&(y.color=f.color),f.size!=null&&(y.size=f.size),f.marker!=null&&(y.marker=f.marker),f.borderColor!=null&&(y.borderColor=f.borderColor),f.borderSize!=null&&(y.borderSize=f.borderSize),f.opacity!=null&&(y.opacity=f.opacity),f.viewport&&(y.viewport=a(f.viewport)),f.diagonal!=null&&(y.diagonal=f.diagonal),f.upper!=null&&(y.upper=f.upper),f.lower!=null&&(y.lower=f.lower),f.data){y.buffer(n(f.data)),y.columns=f.data.length,y.count=f.data[0].length,y.bounds=[];for(var o=0;o<y.columns;o++)y.bounds[o]=S(f.data[o],1)}var m;f.range&&(y.range=f.range,m=y.range&&typeof y.range[0]!="number"),f.domain&&(y.domain=f.domain);var l=!1;f.padding!=null&&(Array.isArray(f.padding)&&f.padding.length===y.columns&&typeof f.padding[f.padding.length-1]=="number"?(y.padding=f.padding.map(s),l=!0):y.padding=s(f.padding));var w=y.columns,_=y.count,h=y.viewport.width,b=y.viewport.height,u=y.viewport.x,L=y.viewport.y,T=h/w,k=b/w;y.passes=[];for(var P=0;P<w;P++)for(var z=0;z<w;z++)if(!(!y.diagonal&&z===P)&&!(!y.upper&&P>z)&&!(!y.lower&&P<z)){var I=t(y.id,P,z),D=this.passes[I]||(this.passes[I]={});if(f.data&&(f.transpose?D.positions={x:{buffer:y.buffer,offset:z,count:_,stride:w},y:{buffer:y.buffer,offset:P,count:_,stride:w}}:D.positions={x:{buffer:y.buffer,offset:z*_,count:_},y:{buffer:y.buffer,offset:P*_,count:_}},D.bounds=c(y.bounds,P,z)),f.domain||f.viewport||f.data){var R=l?c(y.padding,P,z):y.padding;if(y.domain){var O=c(y.domain,P,z),F=O[0],N=O[1],G=O[2],K=O[3];D.viewport=[u+F*h+R[0],L+N*b+R[1],u+G*h-R[2],L+K*b-R[3]]}else D.viewport=[u+z*T+T*R[0],L+P*k+k*R[1],u+(z+1)*T-T*R[2],L+(P+1)*k-k*R[3]]}f.color&&(D.color=y.color),f.size&&(D.size=y.size),f.marker&&(D.marker=y.marker),f.borderSize&&(D.borderSize=y.borderSize),f.borderColor&&(D.borderColor=y.borderColor),f.opacity&&(D.opacity=y.opacity),f.range&&(D.range=m?c(y.range,P,z):y.range||D.bounds),y.passes.push(I)}return this},r.prototype.draw=function(){for(var i,x=[],p=arguments.length;p--;)x[p]=arguments[p];if(!x.length)this.scatter.draw();else{for(var v=[],f=0;f<x.length;f++)if(typeof x[f]=="number"){var y=this.traces[x[f]],o=y.passes,m=y.passOffset;v.push.apply(v,e(m,m+o.length))}else if(x[f].length){var l=x[f],w=this.traces[f],_=w.passes,h=w.passOffset;_=_.map(function(b,u){v[h+u]=l})}(i=this.scatter).draw.apply(i,v)}return this},r.prototype.destroy=function(){return this.traces.forEach(function(i){i.buffer&&i.buffer.destroy&&i.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this};function t(i,x,p){var v=i.id!=null?i.id:i,f=x,y=p,o=v<<16|(f&255)<<8|y&255;return o}function c(i,x,p){var v,f,y,o,m=i[x],l=i[p];return m.length>2?(m[0],m[2],v=m[1],f=m[3]):m.length?(v=m[0],f=m[1]):(m.x,v=m.y,m.x+m.width,f=m.y+m.height),l.length>2?(y=l[0],o=l[2],l[1],l[3]):l.length?(y=l[0],o=l[1]):(y=l.x,l.y,o=l.x+l.width,l.y+l.height),[y,v,o,f]}function s(i){if(typeof i=="number")return[i,i,i,i];if(i.length===2)return[i[0],i[1],i[0],i[1]];var x=a(i);return[x.x,x.y,x.x+x.width,x.y+x.height]}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:279,"regl-scatter2d":282}],284:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?ee.exports=g():A.createREGL=g()})(this,function(){function A(at,$t){this.id=be++,this.type=at,this.data=$t}function g(at){if(at.length===0)return[];var $t=at.charAt(0),Zt=at.charAt(at.length-1);if(1<at.length&&$t===Zt&&($t==='"'||$t==="'"))return['"'+at.substr(1,at.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if($t=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(at))return g(at.substr(0,$t.index)).concat(g($t[1])).concat(g(at.substr($t.index+$t[0].length)));if($t=at.split("."),$t.length===1)return['"'+at.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(at=[],Zt=0;Zt<$t.length;++Zt)at=at.concat(g($t[Zt]));return at}function S(at){return"["+g(at).join("][")+"]"}function M(at,$t){if(typeof at=="function")return new A(0,at);if(typeof at=="number"||typeof at=="boolean")return new A(5,at);if(Array.isArray(at))return new A(6,at.map(function(Zt,ur){return M(Zt)}));if(at instanceof A)return at}function e(){var at={"":0},$t=[""];return{id:function(Zt){var ur=at[Zt];return ur||(ur=at[Zt]=$t.length,$t.push(Zt),ur)},str:function(Zt){return $t[Zt]}}}function a(at,$t,Zt){function ur(){var Je=window.innerWidth,it=window.innerHeight;at!==document.body&&(it=wr.getBoundingClientRect(),Je=it.right-it.left,it=it.bottom-it.top),wr.width=Zt*Je,wr.height=Zt*it}var wr=document.createElement("canvas");oe(wr.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),at.appendChild(wr),at===document.body&&(wr.style.position="absolute",oe(at.style,{margin:0,padding:0}));var $e;return at!==document.body&&typeof ResizeObserver=="function"?($e=new ResizeObserver(function(){setTimeout(ur)}),$e.observe(at)):window.addEventListener("resize",ur,!1),ur(),{canvas:wr,onDestroy:function(){$e?$e.disconnect():window.removeEventListener("resize",ur),at.removeChild(wr)}}}function n(at,$t){function Zt(ur){try{return at.getContext(ur,$t)}catch{return null}}return Zt("webgl")||Zt("experimental-webgl")||Zt("webgl-experimental")}function r(at){return typeof at=="string"?at.split():at}function t(at){return typeof at=="string"?document.querySelector(at):at}function c(at){var $t=at||{},Zt,ur,wr,$e;at={};var Je=[],it=[],lt=typeof window>"u"?1:window.devicePixelRatio,Tt=!1,Bt={},Ce=function(nt){},Me=function(){};if(typeof $t=="string"?Zt=document.querySelector($t):typeof $t=="object"&&(typeof $t.nodeName=="string"&&typeof $t.appendChild=="function"&&typeof $t.getBoundingClientRect=="function"?Zt=$t:typeof $t.drawArrays=="function"||typeof $t.drawElements=="function"?($e=$t,wr=$e.canvas):("gl"in $t?$e=$t.gl:"canvas"in $t?wr=t($t.canvas):"container"in $t&&(ur=t($t.container)),"attributes"in $t&&(at=$t.attributes),"extensions"in $t&&(Je=r($t.extensions)),"optionalExtensions"in $t&&(it=r($t.optionalExtensions)),"onDone"in $t&&(Ce=$t.onDone),"profile"in $t&&(Tt=!!$t.profile),"pixelRatio"in $t&&(lt=+$t.pixelRatio),"cachedCode"in $t&&(Bt=$t.cachedCode))),Zt&&(Zt.nodeName.toLowerCase()==="canvas"?wr=Zt:ur=Zt),!$e){if(!wr){if(Zt=a(ur||document.body,Ce,lt),!Zt)return null;wr=Zt.canvas,Me=Zt.onDestroy}at.premultipliedAlpha===void 0&&(at.premultipliedAlpha=!0),$e=n(wr,at)}return $e?{gl:$e,canvas:wr,container:ur,extensions:Je,optionalExtensions:it,pixelRatio:lt,profile:Tt,cachedCode:Bt,onDone:Ce,onDestroy:Me}:(Me(),Ce("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function s(at,$t){function Zt(Je){Je=Je.toLowerCase();var it;try{it=ur[Je]=at.getExtension(Je)}catch{}return!!it}for(var ur={},wr=0;wr<$t.extensions.length;++wr){var $e=$t.extensions[wr];if(!Zt($e))return $t.onDestroy(),$t.onDone('"'+$e+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return $t.optionalExtensions.forEach(Zt),{extensions:ur,restore:function(){Object.keys(ur).forEach(function(Je){if(ur[Je]&&!Zt(Je))throw Error("(regl): error restoring extension "+Je)})}}}function i(at,$t){for(var Zt=Array(at),ur=0;ur<at;++ur)Zt[ur]=$t(ur);return Zt}function x(at){var $t,Zt;return $t=(65535<at)<<4,at>>>=$t,Zt=(255<at)<<3,at>>>=Zt,$t|=Zt,Zt=(15<at)<<2,at>>>=Zt,$t|=Zt,Zt=(3<at)<<1,$t|Zt|at>>>Zt>>1}function p(){function at(ur){e:{for(var wr=16;268435456>=wr;wr*=16)if(ur<=wr){ur=wr;break e}ur=0}return wr=Zt[x(ur)>>2],0<wr.length?wr.pop():new ArrayBuffer(ur)}function $t(ur){Zt[x(ur.byteLength)>>2].push(ur)}var Zt=i(8,function(){return[]});return{alloc:at,free:$t,allocType:function(ur,wr){var $e=null;switch(ur){case 5120:$e=new Int8Array(at(wr),0,wr);break;case 5121:$e=new Uint8Array(at(wr),0,wr);break;case 5122:$e=new Int16Array(at(2*wr),0,wr);break;case 5123:$e=new Uint16Array(at(2*wr),0,wr);break;case 5124:$e=new Int32Array(at(4*wr),0,wr);break;case 5125:$e=new Uint32Array(at(4*wr),0,wr);break;case 5126:$e=new Float32Array(at(4*wr),0,wr);break;default:return null}return $e.length!==wr?$e.subarray(0,wr):$e},freeType:function(ur){$t(ur.buffer)}}}function v(at){return!!at&&typeof at=="object"&&Array.isArray(at.shape)&&Array.isArray(at.stride)&&typeof at.offset=="number"&&at.shape.length===at.stride.length&&(Array.isArray(at.data)||Ee(at.data))}function f(at,$t,Zt,ur,wr,$e){for(var Je=0;Je<$t;++Je)for(var it=at[Je],lt=0;lt<Zt;++lt)for(var Tt=it[lt],Bt=0;Bt<ur;++Bt)wr[$e++]=Tt[Bt]}function y(at,$t,Zt,ur,wr){for(var $e=1,Je=Zt+1;Je<$t.length;++Je)$e*=$t[Je];var it=$t[Zt];if($t.length-Zt===4){var lt=$t[Zt+1],Tt=$t[Zt+2];for($t=$t[Zt+3],Je=0;Je<it;++Je)f(at[Je],lt,Tt,$t,ur,wr),wr+=$e}else for(Je=0;Je<it;++Je)y(at[Je],$t,Zt+1,ur,wr),wr+=$e}function o(at){return we[Object.prototype.toString.call(at)]|0}function m(at,$t){for(var Zt=0;Zt<$t.length;++Zt)at[Zt]=$t[Zt]}function l(at,$t,Zt,ur,wr,$e,Je){for(var it=0,lt=0;lt<Zt;++lt)for(var Tt=0;Tt<ur;++Tt)at[it++]=$t[wr*lt+$e*Tt+Je]}function w(at,$t,Zt,ur){function wr(Ce){this.id=lt++,this.buffer=at.createBuffer(),this.type=Ce,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,Zt.profile&&(this.stats={size:0})}function $e(Ce,Me,nt){Ce.byteLength=Me.byteLength,at.bufferData(Ce.type,Me,nt)}function Je(Ce,Me,nt,st,ct,At){if(Ce.usage=nt,Array.isArray(Me)){if(Ce.dtype=st||5126,0<Me.length)if(Array.isArray(Me[0])){ct=Ie(Me);for(var dt=st=1;dt<ct.length;++dt)st*=ct[dt];Ce.dimension=st,Me=He(Me,ct,Ce.dtype),$e(Ce,Me,nt),At?Ce.persistentData=Me:ge.freeType(Me)}else typeof Me[0]=="number"?(Ce.dimension=ct,ct=ge.allocType(Ce.dtype,Me.length),m(ct,Me),$e(Ce,ct,nt),At?Ce.persistentData=ct:ge.freeType(ct)):Ee(Me[0])&&(Ce.dimension=Me[0].length,Ce.dtype=st||o(Me[0])||5126,Me=He(Me,[Me.length,Me[0].length],Ce.dtype),$e(Ce,Me,nt),At?Ce.persistentData=Me:ge.freeType(Me))}else if(Ee(Me))Ce.dtype=st||o(Me),Ce.dimension=ct,$e(Ce,Me,nt),At&&(Ce.persistentData=new Uint8Array(new Uint8Array(Me.buffer)));else if(v(Me)){ct=Me.shape;var Ct=Me.stride,dt=Me.offset,Gt=0,rr=0,kr=0,br=0;ct.length===1?(Gt=ct[0],rr=1,kr=Ct[0],br=0):ct.length===2&&(Gt=ct[0],rr=ct[1],kr=Ct[0],br=Ct[1]),Ce.dtype=st||o(Me.data)||5126,Ce.dimension=rr,ct=ge.allocType(Ce.dtype,Gt*rr),l(ct,Me.data,Gt,rr,kr,br,dt),$e(Ce,ct,nt),At?Ce.persistentData=ct:ge.freeType(ct)}else Me instanceof ArrayBuffer&&(Ce.dtype=5121,Ce.dimension=ct,$e(Ce,Me,nt),At&&(Ce.persistentData=new Uint8Array(new Uint8Array(Me))))}function it(Ce){$t.bufferCount--,ur(Ce),at.deleteBuffer(Ce.buffer),Ce.buffer=null,delete Tt[Ce.id]}var lt=0,Tt={};wr.prototype.bind=function(){at.bindBuffer(this.type,this.buffer)},wr.prototype.destroy=function(){it(this)};var Bt=[];return Zt.profile&&($t.getTotalBufferSize=function(){var Ce=0;return Object.keys(Tt).forEach(function(Me){Ce+=Tt[Me].stats.size}),Ce}),{create:function(Ce,Me,nt,st){function ct(dt){var Ct=35044,Gt=null,rr=0,kr=0,br=1;return Array.isArray(dt)||Ee(dt)||v(dt)||dt instanceof ArrayBuffer?Gt=dt:typeof dt=="number"?rr=dt|0:dt&&("data"in dt&&(Gt=dt.data),"usage"in dt&&(Ct=Xe[dt.usage]),"type"in dt&&(kr=ke[dt.type]),"dimension"in dt&&(br=dt.dimension|0),"length"in dt&&(rr=dt.length|0)),At.bind(),Gt?Je(At,Gt,Ct,kr,br,st):(rr&&at.bufferData(At.type,rr,Ct),At.dtype=kr||5121,At.usage=Ct,At.dimension=br,At.byteLength=rr),Zt.profile&&(At.stats.size=At.byteLength*De[At.dtype]),ct}$t.bufferCount++;var At=new wr(Me);return Tt[At.id]=At,nt||ct(Ce),ct._reglType="buffer",ct._buffer=At,ct.subdata=function(dt,Ct){var Gt=(Ct||0)|0,rr;if(At.bind(),Ee(dt)||dt instanceof ArrayBuffer)at.bufferSubData(At.type,Gt,dt);else if(Array.isArray(dt)){if(0<dt.length)if(typeof dt[0]=="number"){var kr=ge.allocType(At.dtype,dt.length);m(kr,dt),at.bufferSubData(At.type,Gt,kr),ge.freeType(kr)}else(Array.isArray(dt[0])||Ee(dt[0]))&&(rr=Ie(dt),kr=He(dt,rr,At.dtype),at.bufferSubData(At.type,Gt,kr),ge.freeType(kr))}else if(v(dt)){rr=dt.shape;var br=dt.stride,Ar=kr=0,Wr=0,nr=0;rr.length===1?(kr=rr[0],Ar=1,Wr=br[0],nr=0):rr.length===2&&(kr=rr[0],Ar=rr[1],Wr=br[0],nr=br[1]),rr=Array.isArray(dt.data)?At.dtype:o(dt.data),rr=ge.allocType(rr,kr*Ar),l(rr,dt.data,kr,Ar,Wr,nr,dt.offset),at.bufferSubData(At.type,Gt,rr),ge.freeType(rr)}return ct},Zt.profile&&(ct.stats=At.stats),ct.destroy=function(){it(At)},ct},createStream:function(Ce,Me){var nt=Bt.pop();return nt||(nt=new wr(Ce)),nt.bind(),Je(nt,Me,35040,0,1,!1),nt},destroyStream:function(Ce){Bt.push(Ce)},clear:function(){Pe(Tt).forEach(it),Bt.forEach(it)},getBuffer:function(Ce){return Ce&&Ce._buffer instanceof wr?Ce._buffer:null},restore:function(){Pe(Tt).forEach(function(Ce){Ce.buffer=at.createBuffer(),at.bindBuffer(Ce.type,Ce.buffer),at.bufferData(Ce.type,Ce.persistentData||Ce.byteLength,Ce.usage)})},_initBuffer:Je}}function _(at,$t,Zt,ur){function wr(Ce){this.id=lt++,it[this.id]=this,this.buffer=Ce,this.primType=4,this.type=this.vertCount=0}function $e(Ce,Me,nt,st,ct,At,dt){Ce.buffer.bind();var Ct;if(Me?((Ct=dt)||Ee(Me)&&(!v(Me)||Ee(Me.data))||(Ct=$t.oes_element_index_uint?5125:5123),Zt._initBuffer(Ce.buffer,Me,nt,Ct,3)):(at.bufferData(34963,At,nt),Ce.buffer.dtype=Ct||5121,Ce.buffer.usage=nt,Ce.buffer.dimension=3,Ce.buffer.byteLength=At),Ct=dt,!dt){switch(Ce.buffer.dtype){case 5121:case 5120:Ct=5121;break;case 5123:case 5122:Ct=5123;break;case 5125:case 5124:Ct=5125}Ce.buffer.dtype=Ct}Ce.type=Ct,Me=ct,0>Me&&(Me=Ce.buffer.byteLength,Ct===5123?Me>>=1:Ct===5125&&(Me>>=2)),Ce.vertCount=Me,Me=st,0>st&&(Me=4,st=Ce.buffer.dimension,st===1&&(Me=0),st===2&&(Me=1),st===3&&(Me=4)),Ce.primType=Me}function Je(Ce){ur.elementsCount--,delete it[Ce.id],Ce.buffer.destroy(),Ce.buffer=null}var it={},lt=0,Tt={uint8:5121,uint16:5123};$t.oes_element_index_uint&&(Tt.uint32=5125),wr.prototype.bind=function(){this.buffer.bind()};var Bt=[];return{create:function(Ce,Me){function nt(At){if(At)if(typeof At=="number")st(At),ct.primType=4,ct.vertCount=At|0,ct.type=5121;else{var dt=null,Ct=35044,Gt=-1,rr=-1,kr=0,br=0;Array.isArray(At)||Ee(At)||v(At)?dt=At:("data"in At&&(dt=At.data),"usage"in At&&(Ct=Xe[At.usage]),"primitive"in At&&(Gt=Ge[At.primitive]),"count"in At&&(rr=At.count|0),"type"in At&&(br=Tt[At.type]),"length"in At?kr=At.length|0:(kr=rr,br===5123||br===5122?kr*=2:(br===5125||br===5124)&&(kr*=4))),$e(ct,dt,Ct,Gt,rr,kr,br)}else st(),ct.primType=4,ct.vertCount=0,ct.type=5121;return nt}var st=Zt.create(null,34963,!0),ct=new wr(st._buffer);return ur.elementsCount++,nt(Ce),nt._reglType="elements",nt._elements=ct,nt.subdata=function(At,dt){return st.subdata(At,dt),nt},nt.destroy=function(){Je(ct)},nt},createStream:function(Ce){var Me=Bt.pop();return Me||(Me=new wr(Zt.create(null,34963,!0,!1)._buffer)),$e(Me,Ce,35040,-1,-1,0,0),Me},destroyStream:function(Ce){Bt.push(Ce)},getElements:function(Ce){return typeof Ce=="function"&&Ce._elements instanceof wr?Ce._elements:null},clear:function(){Pe(it).forEach(Je)}}}function h(at){for(var $t=ge.allocType(5123,at.length),Zt=0;Zt<at.length;++Zt)if(isNaN(at[Zt]))$t[Zt]=65535;else if(at[Zt]===1/0)$t[Zt]=31744;else if(at[Zt]===-1/0)$t[Zt]=64512;else{ht[0]=at[Zt];var $e=Rt[0],ur=$e>>>31<<15,wr=($e<<1>>>24)-127,$e=$e>>13&1023;$t[Zt]=-24>wr?ur:-14>wr?ur+($e+1024>>-14-wr):15<wr?ur+31744:ur+(wr+15<<10)+$e}return $t}function b(at){return Array.isArray(at)||Ee(at)}function u(at){return"[object "+at+"]"}function L(at){return Array.isArray(at)&&(at.length===0||typeof at[0]=="number")}function T(at){return!!(Array.isArray(at)&&at.length!==0&&b(at[0]))}function k(at){return Object.prototype.toString.call(at)}function P(at){if(!at)return!1;var $t=k(at);return 0<=Ae.indexOf($t)?!0:L(at)||T(at)||v(at)}function z(at,$t){at.type===36193?(at.data=h($t),ge.freeType($t)):at.data=$t}function I(at,$t,Zt,ur,wr,$e){if(at=typeof Ze[at]<"u"?Ze[at]:Mt[at]*Ue[$t],$e&&(at*=6),wr){for(ur=0;1<=Zt;)ur+=at*Zt*Zt,Zt/=2;return ur}return at*Zt*ur}function D(at,$t,Zt,ur,wr,$e,Je){function it(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function lt(Tr,pn){Tr.internalformat=pn.internalformat,Tr.format=pn.format,Tr.type=pn.type,Tr.compressed=pn.compressed,Tr.premultiplyAlpha=pn.premultiplyAlpha,Tr.flipY=pn.flipY,Tr.unpackAlignment=pn.unpackAlignment,Tr.colorSpace=pn.colorSpace,Tr.width=pn.width,Tr.height=pn.height,Tr.channels=pn.channels}function Tt(Tr,pn){if(typeof pn=="object"&&pn){"premultiplyAlpha"in pn&&(Tr.premultiplyAlpha=pn.premultiplyAlpha),"flipY"in pn&&(Tr.flipY=pn.flipY),"alignment"in pn&&(Tr.unpackAlignment=pn.alignment),"colorSpace"in pn&&(Tr.colorSpace=ir[pn.colorSpace]),"type"in pn&&(Tr.type=Ir[pn.type]);var fn=Tr.width,An=Tr.height,Zn=Tr.channels,ua=!1;"shape"in pn?(fn=pn.shape[0],An=pn.shape[1],pn.shape.length===3&&(Zn=pn.shape[2],ua=!0)):("radius"in pn&&(fn=An=pn.radius),"width"in pn&&(fn=pn.width),"height"in pn&&(An=pn.height),"channels"in pn&&(Zn=pn.channels,ua=!0)),Tr.width=fn|0,Tr.height=An|0,Tr.channels=Zn|0,fn=!1,"format"in pn&&(fn=pn.format,An=Tr.internalformat=Br[fn],Tr.format=Hn[An],fn in Ir&&!("type"in pn)&&(Tr.type=Ir[fn]),fn in Er&&(Tr.compressed=!0),fn=!0),!ua&&fn?Tr.channels=Mt[Tr.format]:ua&&!fn&&Tr.channels!==It[Tr.format]&&(Tr.format=Tr.internalformat=It[Tr.channels])}}function Bt(Tr){at.pixelStorei(37440,Tr.flipY),at.pixelStorei(37441,Tr.premultiplyAlpha),at.pixelStorei(37443,Tr.colorSpace),at.pixelStorei(3317,Tr.unpackAlignment)}function Ce(){it.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Me(Tr,pn){var fn=null;if(P(pn)?fn=pn:pn&&(Tt(Tr,pn),"x"in pn&&(Tr.xOffset=pn.x|0),"y"in pn&&(Tr.yOffset=pn.y|0),P(pn.data)&&(fn=pn.data)),pn.copy){var An=wr.viewportWidth,Zn=wr.viewportHeight;Tr.width=Tr.width||An-Tr.xOffset,Tr.height=Tr.height||Zn-Tr.yOffset,Tr.needsCopy=!0}else if(!fn)Tr.width=Tr.width||1,Tr.height=Tr.height||1,Tr.channels=Tr.channels||4;else if(Ee(fn))Tr.channels=Tr.channels||4,Tr.data=fn,"type"in pn||Tr.type!==5121||(Tr.type=we[Object.prototype.toString.call(fn)]|0);else if(L(fn)){switch(Tr.channels=Tr.channels||4,An=fn,Zn=An.length,Tr.type){case 5121:case 5123:case 5125:case 5126:Zn=ge.allocType(Tr.type,Zn),Zn.set(An),Tr.data=Zn;break;case 36193:Tr.data=h(An)}Tr.alignment=1,Tr.needsFree=!0}else if(v(fn)){An=fn.data,Array.isArray(An)||Tr.type!==5121||(Tr.type=we[Object.prototype.toString.call(An)]|0);var Zn=fn.shape,ua=fn.stride,ea,Rn,Xn,Ua;Zn.length===3?(Xn=Zn[2],Ua=ua[2]):Ua=Xn=1,ea=Zn[0],Rn=Zn[1],Zn=ua[0],ua=ua[1],Tr.alignment=1,Tr.width=ea,Tr.height=Rn,Tr.channels=Xn,Tr.format=Tr.internalformat=It[Xn],Tr.needsFree=!0,ea=Ua,fn=fn.offset,Xn=Tr.width,Ua=Tr.height,Rn=Tr.channels;for(var li=ge.allocType(Tr.type===36193?5126:Tr.type,Xn*Ua*Rn),Vt=0,hr=0;hr<Ua;++hr)for(var rn=0;rn<Xn;++rn)for(var vn=0;vn<Rn;++vn)li[Vt++]=An[Zn*rn+ua*hr+ea*vn+fn];z(Tr,li)}else if(k(fn)===Yt||k(fn)===zt||k(fn)===St)k(fn)===Yt||k(fn)===zt?Tr.element=fn:Tr.element=fn.canvas,Tr.width=Tr.element.width,Tr.height=Tr.element.height,Tr.channels=4;else if(k(fn)===Ye)Tr.element=fn,Tr.width=fn.width,Tr.height=fn.height,Tr.channels=4;else if(k(fn)===rt)Tr.element=fn,Tr.width=fn.naturalWidth,Tr.height=fn.naturalHeight,Tr.channels=4;else if(k(fn)===Ve)Tr.element=fn,Tr.width=fn.videoWidth,Tr.height=fn.videoHeight,Tr.channels=4;else if(T(fn)){for(An=Tr.width||fn[0].length,Zn=Tr.height||fn.length,ua=Tr.channels,ua=b(fn[0][0])?ua||fn[0][0].length:ua||1,ea=Ne.shape(fn),Xn=1,Ua=0;Ua<ea.length;++Ua)Xn*=ea[Ua];Xn=ge.allocType(Tr.type===36193?5126:Tr.type,Xn),Ne.flatten(fn,ea,"",Xn),z(Tr,Xn),Tr.alignment=1,Tr.width=An,Tr.height=Zn,Tr.channels=ua,Tr.format=Tr.internalformat=It[ua],Tr.needsFree=!0}}function nt(Tr,pn,fn,An,Zn){var ua=Tr.element,ea=Tr.data,Rn=Tr.internalformat,Xn=Tr.format,Ua=Tr.type,li=Tr.width,Vt=Tr.height;Bt(Tr),ua?at.texSubImage2D(pn,Zn,fn,An,Xn,Ua,ua):Tr.compressed?at.compressedTexSubImage2D(pn,Zn,fn,An,Rn,li,Vt,ea):Tr.needsCopy?(ur(),at.copyTexSubImage2D(pn,Zn,fn,An,Tr.xOffset,Tr.yOffset,li,Vt)):at.texSubImage2D(pn,Zn,fn,An,li,Vt,Xn,Ua,ea)}function st(){return pa.pop()||new Ce}function ct(Tr){Tr.needsFree&&ge.freeType(Tr.data),Ce.call(Tr),pa.push(Tr)}function At(){it.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function dt(Tr,pn,fn){var An=Tr.images[0]=st();Tr.mipmask=1,An.width=Tr.width=pn,An.height=Tr.height=fn,An.channels=Tr.channels=4}function Ct(Tr,pn){var fn=null;if(P(pn))fn=Tr.images[0]=st(),lt(fn,Tr),Me(fn,pn),Tr.mipmask=1;else if(Tt(Tr,pn),Array.isArray(pn.mipmap))for(var An=pn.mipmap,Zn=0;Zn<An.length;++Zn)fn=Tr.images[Zn]=st(),lt(fn,Tr),fn.width>>=Zn,fn.height>>=Zn,Me(fn,An[Zn]),Tr.mipmask|=1<<Zn;else fn=Tr.images[0]=st(),lt(fn,Tr),Me(fn,pn),Tr.mipmask=1;lt(Tr,Tr.images[0])}function Gt(Tr,pn){for(var fn=Tr.images,An=0;An<fn.length&&fn[An];++An){var Zn=fn[An],ua=pn,ea=An,Rn=Zn.element,Xn=Zn.data,Ua=Zn.internalformat,li=Zn.format,Vt=Zn.type,hr=Zn.width,rn=Zn.height;Bt(Zn),Rn?at.texImage2D(ua,ea,li,li,Vt,Rn):Zn.compressed?at.compressedTexImage2D(ua,ea,Ua,hr,rn,0,Xn):Zn.needsCopy?(ur(),at.copyTexImage2D(ua,ea,li,Zn.xOffset,Zn.yOffset,hr,rn,0)):at.texImage2D(ua,ea,li,hr,rn,0,li,Vt,Xn||null)}}function rr(){var Tr=Ma.pop()||new At;it.call(Tr);for(var pn=Tr.mipmask=0;16>pn;++pn)Tr.images[pn]=null;return Tr}function kr(Tr){for(var pn=Tr.images,fn=0;fn<pn.length;++fn)pn[fn]&&ct(pn[fn]),pn[fn]=null;Ma.push(Tr)}function br(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function Ar(Tr,pn){"min"in pn&&(Tr.minFilter=Wt[pn.min],0<=Kt.indexOf(Tr.minFilter)&&!("faces"in pn)&&(Tr.genMipmaps=!0)),"mag"in pn&&(Tr.magFilter=Lt[pn.mag]);var fn=Tr.wrapS,An=Tr.wrapT;if("wrap"in pn){var Zn=pn.wrap;typeof Zn=="string"?fn=An=tt[Zn]:Array.isArray(Zn)&&(fn=tt[Zn[0]],An=tt[Zn[1]])}else"wrapS"in pn&&(fn=tt[pn.wrapS]),"wrapT"in pn&&(An=tt[pn.wrapT]);if(Tr.wrapS=fn,Tr.wrapT=An,"anisotropic"in pn&&(Tr.anisotropic=pn.anisotropic),"mipmap"in pn){switch(fn=!1,typeof pn.mipmap){case"string":Tr.mipmapHint=Sr[pn.mipmap],fn=Tr.genMipmaps=!0;break;case"boolean":fn=Tr.genMipmaps=pn.mipmap;break;case"object":Tr.genMipmaps=!1,fn=!0}!fn||"min"in pn||(Tr.minFilter=9984)}}function Wr(Tr,pn){at.texParameteri(pn,10241,Tr.minFilter),at.texParameteri(pn,10240,Tr.magFilter),at.texParameteri(pn,10242,Tr.wrapS),at.texParameteri(pn,10243,Tr.wrapT),$t.ext_texture_filter_anisotropic&&at.texParameteri(pn,34046,Tr.anisotropic),Tr.genMipmaps&&(at.hint(33170,Tr.mipmapHint),at.generateMipmap(pn))}function nr(Tr){it.call(this),this.mipmask=0,this.internalformat=6408,this.id=ci++,this.refCount=1,this.target=Tr,this.texture=at.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new br,Je.profile&&(this.stats={size:0})}function yr(Tr){at.activeTexture(33984),at.bindTexture(Tr.target,Tr.texture)}function Pr(){var Tr=Wa[0];Tr?at.bindTexture(Tr.target,Tr.texture):at.bindTexture(3553,null)}function Or(Tr){var pn=Tr.texture,fn=Tr.unit,An=Tr.target;0<=fn&&(at.activeTexture(33984+fn),at.bindTexture(An,null),Wa[fn]=null),at.deleteTexture(pn),Tr.texture=null,Tr.params=null,Tr.pixels=null,Tr.refCount=0,delete Ha[Tr.id],$e.textureCount--}var Sr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},tt={repeat:10497,clamp:33071,mirror:33648},Lt={nearest:9728,linear:9729},Wt=oe({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Lt),ir={none:0,browser:37444},Ir={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Br={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Er={};$t.ext_srgb&&(Br.srgb=35904,Br.srgba=35906),$t.oes_texture_float&&(Ir.float32=Ir.float=5126),$t.oes_texture_half_float&&(Ir.float16=Ir["half float"]=36193),$t.webgl_depth_texture&&(oe(Br,{depth:6402,"depth stencil":34041}),oe(Ir,{uint16:5123,uint32:5125,"depth stencil":34042})),$t.webgl_compressed_texture_s3tc&&oe(Er,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),$t.webgl_compressed_texture_atc&&oe(Er,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),$t.webgl_compressed_texture_pvrtc&&oe(Er,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),$t.webgl_compressed_texture_etc1&&(Er["rgb etc1"]=36196);var _r=Array.prototype.slice.call(at.getParameter(34467));Object.keys(Er).forEach(function(Tr){var pn=Er[Tr];0<=_r.indexOf(pn)&&(Br[Tr]=pn)});var Gr=Object.keys(Br);Zt.textureFormats=Gr;var wn=[];Object.keys(Br).forEach(function(Tr){wn[Br[Tr]]=Tr});var cn=[];Object.keys(Ir).forEach(function(Tr){cn[Ir[Tr]]=Tr});var Bn=[];Object.keys(Lt).forEach(function(Tr){Bn[Lt[Tr]]=Tr});var En=[];Object.keys(Wt).forEach(function(Tr){En[Wt[Tr]]=Tr});var Yn=[];Object.keys(tt).forEach(function(Tr){Yn[tt[Tr]]=Tr});var Hn=Gr.reduce(function(Tr,pn){var fn=Br[pn];return fn===6409||fn===6406||fn===6409||fn===6410||fn===6402||fn===34041||$t.ext_srgb&&(fn===35904||fn===35906)?Tr[fn]=fn:fn===32855||0<=pn.indexOf("rgba")?Tr[fn]=6408:Tr[fn]=6407,Tr},{}),pa=[],Ma=[],ci=0,Ha={},ja=Zt.maxTextureUnits,Wa=Array(ja).map(function(){return null});return oe(nr.prototype,{bind:function(){this.bindCount+=1;var Tr=this.unit;if(0>Tr){for(var pn=0;pn<ja;++pn){var fn=Wa[pn];if(fn){if(0<fn.bindCount)continue;fn.unit=-1}Wa[pn]=this,Tr=pn;break}Je.profile&&$e.maxTextureUnits<Tr+1&&($e.maxTextureUnits=Tr+1),this.unit=Tr,at.activeTexture(33984+Tr),at.bindTexture(this.target,this.texture)}return Tr},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&Or(this)}}),Je.profile&&($e.getTotalTextureSize=function(){var Tr=0;return Object.keys(Ha).forEach(function(pn){Tr+=Ha[pn].stats.size}),Tr}),{create2D:function(Tr,pn){function fn(Zn,ua){var ea=An.texInfo;br.call(ea);var Rn=rr();return typeof Zn=="number"?typeof ua=="number"?dt(Rn,Zn|0,ua|0):dt(Rn,Zn|0,Zn|0):Zn?(Ar(ea,Zn),Ct(Rn,Zn)):dt(Rn,1,1),ea.genMipmaps&&(Rn.mipmask=(Rn.width<<1)-1),An.mipmask=Rn.mipmask,lt(An,Rn),An.internalformat=Rn.internalformat,fn.width=Rn.width,fn.height=Rn.height,yr(An),Gt(Rn,3553),Wr(ea,3553),Pr(),kr(Rn),Je.profile&&(An.stats.size=I(An.internalformat,An.type,Rn.width,Rn.height,ea.genMipmaps,!1)),fn.format=wn[An.internalformat],fn.type=cn[An.type],fn.mag=Bn[ea.magFilter],fn.min=En[ea.minFilter],fn.wrapS=Yn[ea.wrapS],fn.wrapT=Yn[ea.wrapT],fn}var An=new nr(3553);return Ha[An.id]=An,$e.textureCount++,fn(Tr,pn),fn.subimage=function(Zn,ua,ea,Rn){ua|=0,ea|=0,Rn|=0;var Xn=st();return lt(Xn,An),Xn.width=0,Xn.height=0,Me(Xn,Zn),Xn.width=Xn.width||(An.width>>Rn)-ua,Xn.height=Xn.height||(An.height>>Rn)-ea,yr(An),nt(Xn,3553,ua,ea,Rn),Pr(),ct(Xn),fn},fn.resize=function(Zn,ua){var ea=Zn|0,Rn=ua|0||ea;if(ea===An.width&&Rn===An.height)return fn;fn.width=An.width=ea,fn.height=An.height=Rn,yr(An);for(var Xn=0;An.mipmask>>Xn;++Xn){var Ua=ea>>Xn,li=Rn>>Xn;if(!Ua||!li)break;at.texImage2D(3553,Xn,An.format,Ua,li,0,An.format,An.type,null)}return Pr(),Je.profile&&(An.stats.size=I(An.internalformat,An.type,ea,Rn,!1,!1)),fn},fn._reglType="texture2d",fn._texture=An,Je.profile&&(fn.stats=An.stats),fn.destroy=function(){An.decRef()},fn},createCube:function(Tr,pn,fn,An,Zn,ua){function ea(Ua,li,Vt,hr,rn,vn){var en,Tn=Rn.texInfo;for(br.call(Tn),en=0;6>en;++en)Xn[en]=rr();if(typeof Ua=="number"||!Ua)for(Ua=Ua|0||1,en=0;6>en;++en)dt(Xn[en],Ua,Ua);else if(typeof Ua=="object")if(li)Ct(Xn[0],Ua),Ct(Xn[1],li),Ct(Xn[2],Vt),Ct(Xn[3],hr),Ct(Xn[4],rn),Ct(Xn[5],vn);else if(Ar(Tn,Ua),Tt(Rn,Ua),"faces"in Ua)for(Ua=Ua.faces,en=0;6>en;++en)lt(Xn[en],Rn),Ct(Xn[en],Ua[en]);else for(en=0;6>en;++en)Ct(Xn[en],Ua);for(lt(Rn,Xn[0]),Rn.mipmask=Tn.genMipmaps?(Xn[0].width<<1)-1:Xn[0].mipmask,Rn.internalformat=Xn[0].internalformat,ea.width=Xn[0].width,ea.height=Xn[0].height,yr(Rn),en=0;6>en;++en)Gt(Xn[en],34069+en);for(Wr(Tn,34067),Pr(),Je.profile&&(Rn.stats.size=I(Rn.internalformat,Rn.type,ea.width,ea.height,Tn.genMipmaps,!0)),ea.format=wn[Rn.internalformat],ea.type=cn[Rn.type],ea.mag=Bn[Tn.magFilter],ea.min=En[Tn.minFilter],ea.wrapS=Yn[Tn.wrapS],ea.wrapT=Yn[Tn.wrapT],en=0;6>en;++en)kr(Xn[en]);return ea}var Rn=new nr(34067);Ha[Rn.id]=Rn,$e.cubeCount++;var Xn=Array(6);return ea(Tr,pn,fn,An,Zn,ua),ea.subimage=function(Ua,li,Vt,hr,rn){Vt|=0,hr|=0,rn|=0;var vn=st();return lt(vn,Rn),vn.width=0,vn.height=0,Me(vn,li),vn.width=vn.width||(Rn.width>>rn)-Vt,vn.height=vn.height||(Rn.height>>rn)-hr,yr(Rn),nt(vn,34069+Ua,Vt,hr,rn),Pr(),ct(vn),ea},ea.resize=function(Ua){if(Ua|=0,Ua!==Rn.width){ea.width=Rn.width=Ua,ea.height=Rn.height=Ua,yr(Rn);for(var li=0;6>li;++li)for(var Vt=0;Rn.mipmask>>Vt;++Vt)at.texImage2D(34069+li,Vt,Rn.format,Ua>>Vt,Ua>>Vt,0,Rn.format,Rn.type,null);return Pr(),Je.profile&&(Rn.stats.size=I(Rn.internalformat,Rn.type,ea.width,ea.height,!1,!0)),ea}},ea._reglType="textureCube",ea._texture=Rn,Je.profile&&(ea.stats=Rn.stats),ea.destroy=function(){Rn.decRef()},ea},clear:function(){for(var Tr=0;Tr<ja;++Tr)at.activeTexture(33984+Tr),at.bindTexture(3553,null),Wa[Tr]=null;Pe(Ha).forEach(Or),$e.cubeCount=0,$e.textureCount=0},getTexture:function(Tr){return null},restore:function(){for(var Tr=0;Tr<ja;++Tr){var pn=Wa[Tr];pn&&(pn.bindCount=0,pn.unit=-1,Wa[Tr]=null)}Pe(Ha).forEach(function(fn){fn.texture=at.createTexture(),at.bindTexture(fn.target,fn.texture);for(var An=0;32>An;++An)if((fn.mipmask&1<<An)!==0)if(fn.target===3553)at.texImage2D(3553,An,fn.internalformat,fn.width>>An,fn.height>>An,0,fn.internalformat,fn.type,null);else for(var Zn=0;6>Zn;++Zn)at.texImage2D(34069+Zn,An,fn.internalformat,fn.width>>An,fn.height>>An,0,fn.internalformat,fn.type,null);Wr(fn.texInfo,fn.target)})},refresh:function(){for(var Tr=0;Tr<ja;++Tr){var pn=Wa[Tr];pn&&(pn.bindCount=0,pn.unit=-1,Wa[Tr]=null),at.activeTexture(33984+Tr),at.bindTexture(3553,null),at.bindTexture(34067,null)}}}}function R(at,$t,Zt,ur,wr,$e){function Je(nr,yr,Pr){this.target=nr,this.texture=yr,this.renderbuffer=Pr;var Or=nr=0;yr?(nr=yr.width,Or=yr.height):Pr&&(nr=Pr.width,Or=Pr.height),this.width=nr,this.height=Or}function it(nr){nr&&(nr.texture&&nr.texture._texture.decRef(),nr.renderbuffer&&nr.renderbuffer._renderbuffer.decRef())}function lt(nr,yr,Pr){nr&&(nr.texture?nr.texture._texture.refCount+=1:nr.renderbuffer._renderbuffer.refCount+=1)}function Tt(nr,yr){yr&&(yr.texture?at.framebufferTexture2D(36160,nr,yr.target,yr.texture._texture.texture,0):at.framebufferRenderbuffer(36160,nr,36161,yr.renderbuffer._renderbuffer.renderbuffer))}function Bt(nr){var yr=3553,Pr=null,Or=null,Sr=nr;return typeof nr=="object"&&(Sr=nr.data,"target"in nr&&(yr=nr.target|0)),nr=Sr._reglType,nr==="texture2d"||nr==="textureCube"?Pr=Sr:nr==="renderbuffer"&&(Or=Sr,yr=36161),new Je(yr,Pr,Or)}function Ce(nr,yr,Pr,Or,Sr){return Pr?(nr=ur.create2D({width:nr,height:yr,format:Or,type:Sr}),nr._texture.refCount=0,new Je(3553,nr,null)):(nr=wr.create({width:nr,height:yr,format:Or}),nr._renderbuffer.refCount=0,new Je(36161,null,nr))}function Me(nr){return nr&&(nr.texture||nr.renderbuffer)}function nt(nr,yr,Pr){nr&&(nr.texture?nr.texture.resize(yr,Pr):nr.renderbuffer&&nr.renderbuffer.resize(yr,Pr),nr.width=yr,nr.height=Pr)}function st(){this.id=Ar++,Wr[this.id]=this,this.framebuffer=at.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function ct(nr){nr.colorAttachments.forEach(it),it(nr.depthAttachment),it(nr.stencilAttachment),it(nr.depthStencilAttachment)}function At(nr){at.deleteFramebuffer(nr.framebuffer),nr.framebuffer=null,$e.framebufferCount--,delete Wr[nr.id]}function dt(nr){var yr;at.bindFramebuffer(36160,nr.framebuffer);var Pr=nr.colorAttachments;for(yr=0;yr<Pr.length;++yr)Tt(36064+yr,Pr[yr]);for(yr=Pr.length;yr<Zt.maxColorAttachments;++yr)at.framebufferTexture2D(36160,36064+yr,3553,null,0);at.framebufferTexture2D(36160,33306,3553,null,0),at.framebufferTexture2D(36160,36096,3553,null,0),at.framebufferTexture2D(36160,36128,3553,null,0),Tt(36096,nr.depthAttachment),Tt(36128,nr.stencilAttachment),Tt(33306,nr.depthStencilAttachment),at.checkFramebufferStatus(36160),at.isContextLost(),at.bindFramebuffer(36160,Gt.next?Gt.next.framebuffer:null),Gt.cur=Gt.next,at.getError()}function Ct(nr,yr){function Pr(Sr,tt){var Lt,Wt=0,ir=0,Ir=!0,Br=!0;Lt=null;var Er=!0,_r="rgba",Gr="uint8",wn=1,cn=null,Bn=null,En=null,Yn=!1;typeof Sr=="number"?(Wt=Sr|0,ir=tt|0||Wt):Sr?("shape"in Sr?(ir=Sr.shape,Wt=ir[0],ir=ir[1]):("radius"in Sr&&(Wt=ir=Sr.radius),"width"in Sr&&(Wt=Sr.width),"height"in Sr&&(ir=Sr.height)),("color"in Sr||"colors"in Sr)&&(Lt=Sr.color||Sr.colors),Lt||("colorCount"in Sr&&(wn=Sr.colorCount|0),"colorTexture"in Sr&&(Er=!!Sr.colorTexture,_r="rgba4"),"colorType"in Sr&&(Gr=Sr.colorType,!Er)&&(Gr==="half float"||Gr==="float16"?_r="rgba16f":(Gr==="float"||Gr==="float32")&&(_r="rgba32f")),"colorFormat"in Sr&&(_r=Sr.colorFormat,0<=rr.indexOf(_r)?Er=!0:0<=kr.indexOf(_r)&&(Er=!1))),("depthTexture"in Sr||"depthStencilTexture"in Sr)&&(Yn=!(!Sr.depthTexture&&!Sr.depthStencilTexture)),"depth"in Sr&&(typeof Sr.depth=="boolean"?Ir=Sr.depth:(cn=Sr.depth,Br=!1)),"stencil"in Sr&&(typeof Sr.stencil=="boolean"?Br=Sr.stencil:(Bn=Sr.stencil,Ir=!1)),"depthStencil"in Sr&&(typeof Sr.depthStencil=="boolean"?Ir=Br=Sr.depthStencil:(En=Sr.depthStencil,Br=Ir=!1))):Wt=ir=1;var Hn=null,pa=null,Ma=null,ci=null;if(Array.isArray(Lt))Hn=Lt.map(Bt);else if(Lt)Hn=[Bt(Lt)];else for(Hn=Array(wn),Lt=0;Lt<wn;++Lt)Hn[Lt]=Ce(Wt,ir,Er,_r,Gr);for(Wt=Wt||Hn[0].width,ir=ir||Hn[0].height,cn?pa=Bt(cn):Ir&&!Br&&(pa=Ce(Wt,ir,Yn,"depth","uint32")),Bn?Ma=Bt(Bn):Br&&!Ir&&(Ma=Ce(Wt,ir,!1,"stencil","uint8")),En?ci=Bt(En):!cn&&!Bn&&Br&&Ir&&(ci=Ce(Wt,ir,Yn,"depth stencil","depth stencil")),Ir=null,Lt=0;Lt<Hn.length;++Lt)lt(Hn[Lt]),Hn[Lt]&&Hn[Lt].texture&&(Br=gt[Hn[Lt].texture._texture.format]*wt[Hn[Lt].texture._texture.type],Ir===null&&(Ir=Br));return lt(pa),lt(Ma),lt(ci),ct(Or),Or.width=Wt,Or.height=ir,Or.colorAttachments=Hn,Or.depthAttachment=pa,Or.stencilAttachment=Ma,Or.depthStencilAttachment=ci,Pr.color=Hn.map(Me),Pr.depth=Me(pa),Pr.stencil=Me(Ma),Pr.depthStencil=Me(ci),Pr.width=Or.width,Pr.height=Or.height,dt(Or),Pr}var Or=new st;return $e.framebufferCount++,Pr(nr,yr),oe(Pr,{resize:function(Sr,tt){var Lt=Math.max(Sr|0,1),Wt=Math.max(tt|0||Lt,1);if(Lt===Or.width&&Wt===Or.height)return Pr;for(var ir=Or.colorAttachments,Ir=0;Ir<ir.length;++Ir)nt(ir[Ir],Lt,Wt);return nt(Or.depthAttachment,Lt,Wt),nt(Or.stencilAttachment,Lt,Wt),nt(Or.depthStencilAttachment,Lt,Wt),Or.width=Pr.width=Lt,Or.height=Pr.height=Wt,dt(Or),Pr},_reglType:"framebuffer",_framebuffer:Or,destroy:function(){At(Or),ct(Or)},use:function(Sr){Gt.setFBO({framebuffer:Pr},Sr)}})}var Gt={cur:null,next:null,dirty:!1,setFBO:null},rr=["rgba"],kr=["rgba4","rgb565","rgb5 a1"];$t.ext_srgb&&kr.push("srgba"),$t.ext_color_buffer_half_float&&kr.push("rgba16f","rgb16f"),$t.webgl_color_buffer_float&&kr.push("rgba32f");var br=["uint8"];$t.oes_texture_half_float&&br.push("half float","float16"),$t.oes_texture_float&&br.push("float","float32");var Ar=0,Wr={};return oe(Gt,{getFramebuffer:function(nr){return typeof nr=="function"&&nr._reglType==="framebuffer"&&(nr=nr._framebuffer,nr instanceof st)?nr:null},create:Ct,createCube:function(nr){function yr(Or){var Sr,tt={color:null},Lt=0,Wt=null;Sr="rgba";var ir="uint8",Ir=1;if(typeof Or=="number"?Lt=Or|0:Or?("shape"in Or?Lt=Or.shape[0]:("radius"in Or&&(Lt=Or.radius|0),"width"in Or?Lt=Or.width|0:"height"in Or&&(Lt=Or.height|0)),("color"in Or||"colors"in Or)&&(Wt=Or.color||Or.colors),Wt||("colorCount"in Or&&(Ir=Or.colorCount|0),"colorType"in Or&&(ir=Or.colorType),"colorFormat"in Or&&(Sr=Or.colorFormat)),"depth"in Or&&(tt.depth=Or.depth),"stencil"in Or&&(tt.stencil=Or.stencil),"depthStencil"in Or&&(tt.depthStencil=Or.depthStencil)):Lt=1,Wt)if(Array.isArray(Wt))for(Or=[],Sr=0;Sr<Wt.length;++Sr)Or[Sr]=Wt[Sr];else Or=[Wt];else for(Or=Array(Ir),Wt={radius:Lt,format:Sr,type:ir},Sr=0;Sr<Ir;++Sr)Or[Sr]=ur.createCube(Wt);for(tt.color=Array(Or.length),Sr=0;Sr<Or.length;++Sr)Ir=Or[Sr],Lt=Lt||Ir.width,tt.color[Sr]={target:34069,data:Or[Sr]};for(Sr=0;6>Sr;++Sr){for(Ir=0;Ir<Or.length;++Ir)tt.color[Ir].target=34069+Sr;0<Sr&&(tt.depth=Pr[0].depth,tt.stencil=Pr[0].stencil,tt.depthStencil=Pr[0].depthStencil),Pr[Sr]?Pr[Sr](tt):Pr[Sr]=Ct(tt)}return oe(yr,{width:Lt,height:Lt,color:Or})}var Pr=Array(6);return yr(nr),oe(yr,{faces:Pr,resize:function(Or){var Sr=Or|0;if(Sr===yr.width)return yr;var tt=yr.color;for(Or=0;Or<tt.length;++Or)tt[Or].resize(Sr);for(Or=0;6>Or;++Or)Pr[Or].resize(Sr);return yr.width=yr.height=Sr,yr},_reglType:"framebufferCube",destroy:function(){Pr.forEach(function(Or){Or.destroy()})}})},clear:function(){Pe(Wr).forEach(At)},restore:function(){Gt.cur=null,Gt.next=null,Gt.dirty=!0,Pe(Wr).forEach(function(nr){nr.framebuffer=at.createFramebuffer(),dt(nr)})}})}function O(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function F(at,$t,Zt,ur,wr,$e,Je){function it(dt){if(dt!==At.currentVAO){var Ct=$t.oes_vertex_array_object;dt?Ct.bindVertexArrayOES(dt.vao):Ct.bindVertexArrayOES(null),At.currentVAO=dt}}function lt(dt){if(dt!==At.currentVAO){if(dt)dt.bindAttrs();else{for(var Ct=$t.angle_instanced_arrays,Gt=0;Gt<nt.length;++Gt){var rr=nt[Gt];rr.buffer?(at.enableVertexAttribArray(Gt),rr.buffer.bind(),at.vertexAttribPointer(Gt,rr.size,rr.type,rr.normalized,rr.stride,rr.offfset),Ct&&rr.divisor&&Ct.vertexAttribDivisorANGLE(Gt,rr.divisor)):(at.disableVertexAttribArray(Gt),at.vertexAttrib4f(Gt,rr.x,rr.y,rr.z,rr.w))}Je.elements?at.bindBuffer(34963,Je.elements.buffer.buffer):at.bindBuffer(34963,null)}At.currentVAO=dt}}function Tt(){Pe(ct).forEach(function(dt){dt.destroy()})}function Bt(){this.id=++st,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var dt=$t.oes_vertex_array_object;this.vao=dt?dt.createVertexArrayOES():null,ct[this.id]=this,this.buffers=[]}function Ce(){$t.oes_vertex_array_object&&Pe(ct).forEach(function(dt){dt.refresh()})}var Me=Zt.maxAttributes,nt=Array(Me);for(Zt=0;Zt<Me;++Zt)nt[Zt]=new O;var st=0,ct={},At={Record:O,scope:{},state:nt,currentVAO:null,targetVAO:null,restore:$t.oes_vertex_array_object?Ce:function(){},createVAO:function(dt){function Ct(rr){var kr;Array.isArray(rr)?(kr=rr,Gt.elements&&Gt.ownsElements&&Gt.elements.destroy(),Gt.elements=null,Gt.ownsElements=!1,Gt.offset=0,Gt.count=0,Gt.instances=-1,Gt.primitive=4):(rr.elements?(kr=rr.elements,Gt.ownsElements?(typeof kr=="function"&&kr._reglType==="elements"?Gt.elements.destroy():Gt.elements(kr),Gt.ownsElements=!1):$e.getElements(rr.elements)?(Gt.elements=rr.elements,Gt.ownsElements=!1):(Gt.elements=$e.create(rr.elements),Gt.ownsElements=!0)):(Gt.elements=null,Gt.ownsElements=!1),kr=rr.attributes,Gt.offset=0,Gt.count=-1,Gt.instances=-1,Gt.primitive=4,Gt.elements&&(Gt.count=Gt.elements._elements.vertCount,Gt.primitive=Gt.elements._elements.primType),"offset"in rr&&(Gt.offset=rr.offset|0),"count"in rr&&(Gt.count=rr.count|0),"instances"in rr&&(Gt.instances=rr.instances|0),"primitive"in rr&&(Gt.primitive=Ge[rr.primitive])),rr={};var br=Gt.attributes;br.length=kr.length;for(var Ar=0;Ar<kr.length;++Ar){var Wr=kr[Ar],nr=br[Ar]=new O,yr=Wr.data||Wr;if(Array.isArray(yr)||Ee(yr)||v(yr)){var Pr;Gt.buffers[Ar]&&(Pr=Gt.buffers[Ar],Ee(yr)&&Pr._buffer.byteLength>=yr.byteLength?Pr.subdata(yr):(Pr.destroy(),Gt.buffers[Ar]=null)),Gt.buffers[Ar]||(Pr=Gt.buffers[Ar]=wr.create(Wr,34962,!1,!0)),nr.buffer=wr.getBuffer(Pr),nr.size=nr.buffer.dimension|0,nr.normalized=!1,nr.type=nr.buffer.dtype,nr.offset=0,nr.stride=0,nr.divisor=0,nr.state=1,rr[Ar]=1}else wr.getBuffer(Wr)?(nr.buffer=wr.getBuffer(Wr),nr.size=nr.buffer.dimension|0,nr.normalized=!1,nr.type=nr.buffer.dtype,nr.offset=0,nr.stride=0,nr.divisor=0,nr.state=1):wr.getBuffer(Wr.buffer)?(nr.buffer=wr.getBuffer(Wr.buffer),nr.size=(+Wr.size||nr.buffer.dimension)|0,nr.normalized=!!Wr.normalized||!1,nr.type="type"in Wr?ke[Wr.type]:nr.buffer.dtype,nr.offset=(Wr.offset||0)|0,nr.stride=(Wr.stride||0)|0,nr.divisor=(Wr.divisor||0)|0,nr.state=1):"x"in Wr&&(nr.x=+Wr.x||0,nr.y=+Wr.y||0,nr.z=+Wr.z||0,nr.w=+Wr.w||0,nr.state=2)}for(Pr=0;Pr<Gt.buffers.length;++Pr)!rr[Pr]&&Gt.buffers[Pr]&&(Gt.buffers[Pr].destroy(),Gt.buffers[Pr]=null);return Gt.refresh(),Ct}var Gt=new Bt;return ur.vaoCount+=1,Ct.destroy=function(){for(var rr=0;rr<Gt.buffers.length;++rr)Gt.buffers[rr]&&Gt.buffers[rr].destroy();Gt.buffers.length=0,Gt.ownsElements&&(Gt.elements.destroy(),Gt.elements=null,Gt.ownsElements=!1),Gt.destroy()},Ct._vao=Gt,Ct._reglType="vao",Ct(dt)},getVAO:function(dt){return typeof dt=="function"&&dt._vao?dt._vao:null},destroyBuffer:function(dt){for(var Ct=0;Ct<nt.length;++Ct){var Gt=nt[Ct];Gt.buffer===dt&&(at.disableVertexAttribArray(Ct),Gt.buffer=null)}},setVAO:$t.oes_vertex_array_object?it:lt,clear:$t.oes_vertex_array_object?Tt:function(){}};return Bt.prototype.bindAttrs=function(){for(var dt=$t.angle_instanced_arrays,Ct=this.attributes,Gt=0;Gt<Ct.length;++Gt){var rr=Ct[Gt];rr.buffer?(at.enableVertexAttribArray(Gt),at.bindBuffer(34962,rr.buffer.buffer),at.vertexAttribPointer(Gt,rr.size,rr.type,rr.normalized,rr.stride,rr.offset),dt&&rr.divisor&&dt.vertexAttribDivisorANGLE(Gt,rr.divisor)):(at.disableVertexAttribArray(Gt),at.vertexAttrib4f(Gt,rr.x,rr.y,rr.z,rr.w))}for(dt=Ct.length;dt<Me;++dt)at.disableVertexAttribArray(dt);(dt=$e.getElements(this.elements))?at.bindBuffer(34963,dt.buffer.buffer):at.bindBuffer(34963,null)},Bt.prototype.refresh=function(){var dt=$t.oes_vertex_array_object;dt&&(dt.bindVertexArrayOES(this.vao),this.bindAttrs(),At.currentVAO=null,dt.bindVertexArrayOES(null))},Bt.prototype.destroy=function(){if(this.vao){var dt=$t.oes_vertex_array_object;this===At.currentVAO&&(At.currentVAO=null,dt.bindVertexArrayOES(null)),dt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),ct[this.id]&&(delete ct[this.id],--ur.vaoCount)},At}function N(at,$t,Zt,ur){function wr(st,ct,At,dt){this.name=st,this.id=ct,this.location=At,this.info=dt}function $e(st,ct){for(var At=0;At<st.length;++At)if(st[At].id===ct.id){st[At].location=ct.location;return}st.push(ct)}function Je(st,ct,At){At=st===35632?Tt:Bt;var dt=At[ct];if(!dt){var Ct=$t.str(ct),dt=at.createShader(st);at.shaderSource(dt,Ct),at.compileShader(dt),At[ct]=dt}return dt}function it(st,ct){this.id=nt++,this.fragId=st,this.vertId=ct,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,ur.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function lt(st,ct,At){var dt;dt=Je(35632,st.fragId);var Ct=Je(35633,st.vertId);if(ct=st.program=at.createProgram(),at.attachShader(ct,dt),at.attachShader(ct,Ct),At)for(dt=0;dt<At.length;++dt)Ct=At[dt],at.bindAttribLocation(ct,Ct[0],Ct[1]);at.linkProgram(ct),Ct=at.getProgramParameter(ct,35718),ur.profile&&(st.stats.uniformsCount=Ct);var Gt=st.uniforms;for(dt=0;dt<Ct;++dt)if(At=at.getActiveUniform(ct,dt))if(1<At.size)for(var rr=0;rr<At.size;++rr){var kr=At.name.replace("[0]","["+rr+"]");$e(Gt,new wr(kr,$t.id(kr),at.getUniformLocation(ct,kr),At))}else $e(Gt,new wr(At.name,$t.id(At.name),at.getUniformLocation(ct,At.name),At));for(Ct=at.getProgramParameter(ct,35721),ur.profile&&(st.stats.attributesCount=Ct),st=st.attributes,dt=0;dt<Ct;++dt)(At=at.getActiveAttrib(ct,dt))&&$e(st,new wr(At.name,$t.id(At.name),at.getAttribLocation(ct,At.name),At))}var Tt={},Bt={},Ce={},Me=[],nt=0;return ur.profile&&(Zt.getMaxUniformsCount=function(){var st=0;return Me.forEach(function(ct){ct.stats.uniformsCount>st&&(st=ct.stats.uniformsCount)}),st},Zt.getMaxAttributesCount=function(){var st=0;return Me.forEach(function(ct){ct.stats.attributesCount>st&&(st=ct.stats.attributesCount)}),st}),{clear:function(){var st=at.deleteShader.bind(at);Pe(Tt).forEach(st),Tt={},Pe(Bt).forEach(st),Bt={},Me.forEach(function(ct){at.deleteProgram(ct.program)}),Me.length=0,Ce={},Zt.shaderCount=0},program:function(st,ct,At,dt){var Ct=Ce[ct];Ct||(Ct=Ce[ct]={});var Gt=Ct[st];if(Gt&&(Gt.refCount++,!dt))return Gt;var rr=new it(ct,st);return Zt.shaderCount++,lt(rr,At,dt),Gt||(Ct[st]=rr),Me.push(rr),oe(rr,{destroy:function(){if(rr.refCount--,0>=rr.refCount){at.deleteProgram(rr.program);var kr=Me.indexOf(rr);Me.splice(kr,1),Zt.shaderCount--}0>=Ct[rr.vertId].refCount&&(at.deleteShader(Bt[rr.vertId]),delete Bt[rr.vertId],delete Ce[rr.fragId][rr.vertId]),Object.keys(Ce[rr.fragId]).length||(at.deleteShader(Tt[rr.fragId]),delete Tt[rr.fragId],delete Ce[rr.fragId])}})},restore:function(){Tt={},Bt={};for(var st=0;st<Me.length;++st)lt(Me[st],null,Me[st].attributes.map(function(ct){return[ct.location,ct.name]}))},shader:Je,frag:-1,vert:-1}}function G(at,$t,Zt,ur,wr,$e,Je){function it(Tt){var Bt;Bt=$t.next===null?5121:$t.next.colorAttachments[0].texture._texture.type;var Ce=0,Me=0,nt=ur.framebufferWidth,st=ur.framebufferHeight,ct=null;return Ee(Tt)?ct=Tt:Tt&&(Ce=Tt.x|0,Me=Tt.y|0,nt=(Tt.width||ur.framebufferWidth-Ce)|0,st=(Tt.height||ur.framebufferHeight-Me)|0,ct=Tt.data||null),Zt(),Tt=nt*st*4,ct||(Bt===5121?ct=new Uint8Array(Tt):Bt===5126&&(ct=ct||new Float32Array(Tt))),at.pixelStorei(3333,4),at.readPixels(Ce,Me,nt,st,6408,Bt,ct),ct}function lt(Tt){var Bt;return $t.setFBO({framebuffer:Tt.framebuffer},function(){Bt=it(Tt)}),Bt}return function(Tt){return Tt&&"framebuffer"in Tt?lt(Tt):it(Tt)}}function K(at){for(var $t=Array(at.length>>2),ur=0;ur<$t.length;ur++)$t[ur]=0;for(ur=0;ur<8*at.length;ur+=8)$t[ur>>5]|=(at.charCodeAt(ur/8)&255)<<24-ur%32;var Zt=8*at.length;at=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225];var ur=Array(64),wr,$e,Je,it,lt,Tt,Bt,Ce,Me,nt,st;for($t[Zt>>5]|=128<<24-Zt%32,$t[(Zt+64>>9<<4)+15]=Zt,Ce=0;Ce<$t.length;Ce+=16){for(Zt=at[0],wr=at[1],$e=at[2],Je=at[3],it=at[4],lt=at[5],Tt=at[6],Bt=at[7],Me=0;64>Me;Me++){if(16>Me)ur[Me]=$t[Me+Ce];else{nt=Me,st=ur[Me-2],st=re(st,17)^re(st,19)^st>>>10,st=ue(st,ur[Me-7]);var ct;ct=ur[Me-15],ct=re(ct,7)^re(ct,18)^ct>>>3,ur[nt]=ue(ue(st,ct),ur[Me-16])}nt=it,nt=re(nt,6)^re(nt,11)^re(nt,25),nt=ue(ue(ue(ue(Bt,nt),it&lt^~it&Tt),Ut[Me]),ur[Me]),Bt=Zt,Bt=re(Bt,2)^re(Bt,13)^re(Bt,22),st=ue(Bt,Zt&wr^Zt&$e^wr&$e),Bt=Tt,Tt=lt,lt=it,it=ue(Je,nt),Je=$e,$e=wr,wr=Zt,Zt=ue(nt,st)}at[0]=ue(Zt,at[0]),at[1]=ue(wr,at[1]),at[2]=ue($e,at[2]),at[3]=ue(Je,at[3]),at[4]=ue(it,at[4]),at[5]=ue(lt,at[5]),at[6]=ue(Tt,at[6]),at[7]=ue(Bt,at[7])}for($t="",ur=0;ur<32*at.length;ur+=8)$t+=String.fromCharCode(at[ur>>5]>>>24-ur%32&255);return $t}function W(at){for(var $t="",Zt,ur=0;ur<at.length;ur++)Zt=at.charCodeAt(ur),$t+="0123456789abcdef".charAt(Zt>>>4&15)+"0123456789abcdef".charAt(Zt&15);return $t}function Y(at){for(var $t="",Zt=-1,ur,wr;++Zt<at.length;)ur=at.charCodeAt(Zt),wr=Zt+1<at.length?at.charCodeAt(Zt+1):0,55296<=ur&&56319>=ur&&56320<=wr&&57343>=wr&&(ur=65536+((ur&1023)<<10)+(wr&1023),Zt++),127>=ur?$t+=String.fromCharCode(ur):2047>=ur?$t+=String.fromCharCode(192|ur>>>6&31,128|ur&63):65535>=ur?$t+=String.fromCharCode(224|ur>>>12&15,128|ur>>>6&63,128|ur&63):2097151>=ur&&($t+=String.fromCharCode(240|ur>>>18&7,128|ur>>>12&63,128|ur>>>6&63,128|ur&63));return $t}function re(at,$t){return at>>>$t|at<<32-$t}function ue(at,$t){var Zt=(at&65535)+($t&65535);return(at>>16)+($t>>16)+(Zt>>16)<<16|Zt&65535}function j(at){return Array.prototype.slice.call(at)}function q(at){return j(at).join("")}function V(at){function $t(){var Bt=[],Ce=[];return oe(function(){Bt.push.apply(Bt,j(arguments))},{def:function(){var Me="v"+wr++;return Ce.push(Me),0<arguments.length&&(Bt.push(Me,"="),Bt.push.apply(Bt,j(arguments)),Bt.push(";")),Me},toString:function(){return q([0<Ce.length?"var "+Ce.join(",")+";":"",q(Bt)])}})}function Zt(){function Bt(ct,At){Me(ct,At,"=",Ce.def(ct,At),";")}var Ce=$t(),Me=$t(),nt=Ce.toString,st=Me.toString;return oe(function(){Ce.apply(Ce,j(arguments))},{def:Ce.def,entry:Ce,exit:Me,save:Bt,set:function(ct,At,dt){Bt(ct,At),Ce(ct,At,"=",dt,";")},toString:function(){return nt()+st()}})}var ur=at&&at.cache,wr=0,$e=[],Je=[],it=[],lt=$t(),Tt={};return{global:lt,link:function(Bt,Ce){var Me=Ce&&Ce.stable;if(!Me){for(var nt=0;nt<Je.length;++nt)if(Je[nt]===Bt&&!it[nt])return $e[nt]}return nt="g"+wr++,$e.push(nt),Je.push(Bt),it.push(Me),nt},block:$t,proc:function(Bt,Ce){function Me(){var At="a"+nt.length;return nt.push(At),At}var nt=[];Ce=Ce||0;for(var st=0;st<Ce;++st)Me();var st=Zt(),ct=st.toString;return Tt[Bt]=oe(st,{arg:Me,toString:function(){return q(["function(",nt.join(),"){",ct(),"}"])}})},scope:Zt,cond:function(){var Bt=q(arguments),Ce=Zt(),Me=Zt(),nt=Ce.toString,st=Me.toString;return oe(Ce,{then:function(){return Ce.apply(Ce,j(arguments)),this},else:function(){return Me.apply(Me,j(arguments)),this},toString:function(){var ct=st();return ct&&(ct="else{"+ct+"}"),q(["if(",Bt,"){",nt(),"}",ct])}})},compile:function(){var Bt=['"use strict";',lt,"return {"];Object.keys(Tt).forEach(function(nt){Bt.push('"',nt,'":',Tt[nt].toString(),",")}),Bt.push("}");var Ce=q(Bt).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Me;return ur&&(Me=W(K(Y(Ce))),ur[Me])?ur[Me].apply(null,Je):(Ce=Function.apply(null,$e.concat(Ce)),ur&&(ur[Me]=Ce),Ce.apply(null,Je))}}}function U(at){return Array.isArray(at)||Ee(at)||v(at)}function $(at){return at.sort(function($t,Zt){return $t==="viewport"?-1:Zt==="viewport"?1:$t<Zt?-1:1})}function ne(at,$t,Zt,ur){this.thisDep=at,this.contextDep=$t,this.propDep=Zt,this.append=ur}function X(at){return at&&!(at.thisDep||at.contextDep||at.propDep)}function Q(at){return new ne(!1,!1,!1,at)}function ie(at,$t){var Zt=at.type;if(Zt===0)return Zt=at.data.length,new ne(!0,1<=Zt,2<=Zt,$t);if(Zt===4)return Zt=at.data,new ne(Zt.thisDep,Zt.contextDep,Zt.propDep,$t);if(Zt===5)return new ne(!1,!1,!1,$t);if(Zt===6){for(var ur=Zt=!1,wr=!1,$e=0;$e<at.data.length;++$e){var Je=at.data[$e];Je.type===1?wr=!0:Je.type===2?ur=!0:Je.type===3?Zt=!0:Je.type===0?(Zt=!0,Je=Je.data,1<=Je&&(ur=!0),2<=Je&&(wr=!0)):Je.type===4&&(Zt=Zt||Je.data.thisDep,ur=ur||Je.data.contextDep,wr=wr||Je.data.propDep)}return new ne(Zt,ur,wr,$t)}return new ne(Zt===3,Zt===2,Zt===1,$t)}function se(at,$t,Zt,ur,wr,$e,Je,it,lt,Tt,Bt,Ce,Me,nt,st,ct){function At(Vt){return Vt.replace(".","_")}function dt(Vt,hr,rn){var vn=At(Vt);ua.push(Vt),Zn[vn]=An[vn]=!!rn,ea[vn]=hr}function Ct(Vt,hr,rn){var vn=At(Vt);ua.push(Vt),Array.isArray(rn)?(An[vn]=rn.slice(),Zn[vn]=rn.slice()):An[vn]=Zn[vn]=rn,Rn[vn]=hr}function Gt(){var Vt=V({cache:st}),hr=Vt.link,rn=Vt.global;Vt.id=li++,Vt.batchId="0";var vn=hr(Xn),en=Vt.shared={props:"a0"};Object.keys(Xn).forEach(function(mr){en[mr]=rn.def(vn,".",mr)});var Tn=Vt.next={},xn=Vt.current={};Object.keys(Rn).forEach(function(mr){Array.isArray(An[mr])&&(Tn[mr]=rn.def(en.next,".",mr),xn[mr]=rn.def(en.current,".",mr))});var un=Vt.constants={};Object.keys(Ua).forEach(function(mr){un[mr]=rn.def(JSON.stringify(Ua[mr]))}),Vt.invoke=function(mr,zr){switch(zr.type){case 0:var gn=["this",en.context,en.props,Vt.batchId];return mr.def(hr(zr.data),".call(",gn.slice(0,Math.max(zr.data.length+1,4)),")");case 1:return mr.def(en.props,zr.data);case 2:return mr.def(en.context,zr.data);case 3:return mr.def("this",zr.data);case 4:return zr.data.append(Vt,mr),zr.data.ref;case 5:return zr.data.toString();case 6:return zr.data.map(function(On){return Vt.invoke(mr,On)})}},Vt.attribCache={};var gr={};return Vt.scopeAttrib=function(mr){if(mr=$t.id(mr),mr in gr)return gr[mr];var zr=Tt.scope[mr];return zr||(zr=Tt.scope[mr]=new ja),gr[mr]=hr(zr)},Vt}function rr(Vt){var hr=Vt.static;Vt=Vt.dynamic;var rn;if("profile"in hr){var vn=!!hr.profile;rn=Q(function(Tn,xn){return vn}),rn.enable=vn}else if("profile"in Vt){var en=Vt.profile;rn=ie(en,function(Tn,xn){return Tn.invoke(xn,en)})}return rn}function kr(Vt,hr){var rn=Vt.static,vn=Vt.dynamic;if("framebuffer"in rn){var en=rn.framebuffer;return en?(en=it.getFramebuffer(en),Q(function(xn,un){var gr=xn.link(en),mr=xn.shared;return un.set(mr.framebuffer,".next",gr),mr=mr.context,un.set(mr,".framebufferWidth",gr+".width"),un.set(mr,".framebufferHeight",gr+".height"),gr})):Q(function(xn,un){var gr=xn.shared;return un.set(gr.framebuffer,".next","null"),gr=gr.context,un.set(gr,".framebufferWidth",gr+".drawingBufferWidth"),un.set(gr,".framebufferHeight",gr+".drawingBufferHeight"),"null"})}if("framebuffer"in vn){var Tn=vn.framebuffer;return ie(Tn,function(xn,un){var zr=xn.invoke(un,Tn),gr=xn.shared,mr=gr.framebuffer,zr=un.def(mr,".getFramebuffer(",zr,")");return un.set(mr,".next",zr),gr=gr.context,un.set(gr,".framebufferWidth",zr+"?"+zr+".width:"+gr+".drawingBufferWidth"),un.set(gr,".framebufferHeight",zr+"?"+zr+".height:"+gr+".drawingBufferHeight"),zr})}return null}function br(Vt,hr,rn){function vn(un){if(un in en){var gr=en[un];un=!0;var mr=gr.x|0,zr=gr.y|0,gn,On;return"width"in gr?gn=gr.width|0:un=!1,"height"in gr?On=gr.height|0:un=!1,new ne(!un&&hr&&hr.thisDep,!un&&hr&&hr.contextDep,!un&&hr&&hr.propDep,function(_n,jn){var aa=_n.shared.context,da=gn;"width"in gr||(da=jn.def(aa,".","framebufferWidth","-",mr));var ma=On;return"height"in gr||(ma=jn.def(aa,".","framebufferHeight","-",zr)),[mr,zr,da,ma]})}if(un in Tn){var ta=Tn[un];return un=ie(ta,function(_n,jn){var Aa=_n.invoke(jn,ta),aa=_n.shared.context,da=jn.def(Aa,".x|0"),ma=jn.def(Aa,".y|0"),sa=jn.def('"width" in ',Aa,"?",Aa,".width|0:","(",aa,".","framebufferWidth","-",da,")"),Aa=jn.def('"height" in ',Aa,"?",Aa,".height|0:","(",aa,".","framebufferHeight","-",ma,")");return[da,ma,sa,Aa]}),hr&&(un.thisDep=un.thisDep||hr.thisDep,un.contextDep=un.contextDep||hr.contextDep,un.propDep=un.propDep||hr.propDep),un}return hr?new ne(hr.thisDep,hr.contextDep,hr.propDep,function(_n,jn){var aa=_n.shared.context;return[0,0,jn.def(aa,".","framebufferWidth"),jn.def(aa,".","framebufferHeight")]}):null}var en=Vt.static,Tn=Vt.dynamic;if(Vt=vn("viewport")){var xn=Vt;Vt=new ne(Vt.thisDep,Vt.contextDep,Vt.propDep,function(un,gr){var mr=xn.append(un,gr),zr=un.shared.context;return gr.set(zr,".viewportWidth",mr[2]),gr.set(zr,".viewportHeight",mr[3]),mr})}return{viewport:Vt,scissor_box:vn("scissor.box")}}function Ar(Vt,hr){var rn=Vt.static;if(typeof rn.frag=="string"&&typeof rn.vert=="string"){if(0<Object.keys(hr.dynamic).length)return null;var rn=hr.static,vn=Object.keys(rn);if(0<vn.length&&typeof rn[vn[0]]=="number"){for(var en=[],Tn=0;Tn<vn.length;++Tn)en.push([rn[vn[Tn]]|0,vn[Tn]]);return en}}return null}function Wr(Vt,hr,rn){function vn(mr){if(mr in en){var zr=$t.id(en[mr]);return mr=Q(function(){return zr}),mr.id=zr,mr}if(mr in Tn){var gn=Tn[mr];return ie(gn,function(On,ta){var _n=On.invoke(ta,gn);return ta.def(On.shared.strings,".id(",_n,")")})}return null}var en=Vt.static,Tn=Vt.dynamic,xn=vn("frag"),un=vn("vert"),gr=null;return X(xn)&&X(un)?(gr=Bt.program(un.id,xn.id,null,rn),Vt=Q(function(mr,zr){return mr.link(gr)})):Vt=new ne(xn&&xn.thisDep||un&&un.thisDep,xn&&xn.contextDep||un&&un.contextDep,xn&&xn.propDep||un&&un.propDep,function(mr,zr){var gn=mr.shared.shader,On;On=xn?xn.append(mr,zr):zr.def(gn,".","frag");var ta;return ta=un?un.append(mr,zr):zr.def(gn,".","vert"),zr.def(gn+".program("+ta+","+On+")")}),{frag:xn,vert:un,progVar:Vt,program:gr}}function nr(Vt,hr){function rn(_n,jn){if(_n in vn){var aa=vn[_n]|0;return jn?Tn.offset=aa:Tn.instances=aa,Q(function(ma,sa){return jn&&(ma.OFFSET=aa),aa})}if(_n in en){var da=en[_n];return ie(da,function(ma,sa){var Aa=ma.invoke(sa,da);return jn&&(ma.OFFSET=Aa),Aa})}if(jn){if(gr)return Q(function(ma,sa){return ma.OFFSET=0});if(xn)return new ne(un.thisDep,un.contextDep,un.propDep,function(ma,sa){return sa.def(ma.shared.vao+".currentVAO?"+ma.shared.vao+".currentVAO.offset:0")})}else if(xn)return new ne(un.thisDep,un.contextDep,un.propDep,function(ma,sa){return sa.def(ma.shared.vao+".currentVAO?"+ma.shared.vao+".currentVAO.instances:-1")});return null}var vn=Vt.static,en=Vt.dynamic,Tn={},xn=!1,un=function(){if("vao"in vn){var _n=vn.vao;return _n!==null&&Tt.getVAO(_n)===null&&(_n=Tt.createVAO(_n)),xn=!0,Tn.vao=_n,Q(function(aa){var da=Tt.getVAO(_n);return da?aa.link(da):"null"})}if("vao"in en){xn=!0;var jn=en.vao;return ie(jn,function(aa,da){var ma=aa.invoke(da,jn);return da.def(aa.shared.vao+".getVAO("+ma+")")})}return null}(),gr=!1,mr=function(){if("elements"in vn){var _n=vn.elements;if(Tn.elements=_n,U(_n)){var jn=Tn.elements=$e.create(_n,!0),_n=$e.getElements(jn);gr=!0}else _n&&(_n=$e.getElements(_n),gr=!0);return jn=Q(function(da,ma){if(_n){var sa=da.link(_n);return da.ELEMENTS=sa}return da.ELEMENTS=null}),jn.value=_n,jn}if("elements"in en){gr=!0;var aa=en.elements;return ie(aa,function(da,ma){var sa=da.shared,po=sa.isBufferArgs,sa=sa.elements,zo=da.invoke(ma,aa),Aa=ma.def("null"),po=ma.def(po,"(",zo,")"),zo=da.cond(po).then(Aa,"=",sa,".createStream(",zo,");").else(Aa,"=",sa,".getElements(",zo,");");return ma.entry(zo),ma.exit(da.cond(po).then(sa,".destroyStream(",Aa,");")),da.ELEMENTS=Aa})}return xn?new ne(un.thisDep,un.contextDep,un.propDep,function(da,ma){return ma.def(da.shared.vao+".currentVAO?"+da.shared.elements+".getElements("+da.shared.vao+".currentVAO.elements):null")}):null}(),zr=rn("offset",!0),gn=function(){if("primitive"in vn){var _n=vn.primitive;return Tn.primitive=_n,Q(function(aa,da){return Ge[_n]})}if("primitive"in en){var jn=en.primitive;return ie(jn,function(aa,da){var ma=aa.constants.primTypes,sa=aa.invoke(da,jn);return da.def(ma,"[",sa,"]")})}return gr?X(mr)?mr.value?Q(function(aa,da){return da.def(aa.ELEMENTS,".primType")}):Q(function(){return 4}):new ne(mr.thisDep,mr.contextDep,mr.propDep,function(aa,da){var ma=aa.ELEMENTS;return da.def(ma,"?",ma,".primType:",4)}):xn?new ne(un.thisDep,un.contextDep,un.propDep,function(aa,da){return da.def(aa.shared.vao+".currentVAO?"+aa.shared.vao+".currentVAO.primitive:4")}):null}(),On=function(){if("count"in vn){var _n=vn.count|0;return Tn.count=_n,Q(function(){return _n})}if("count"in en){var jn=en.count;return ie(jn,function(aa,da){return aa.invoke(da,jn)})}return gr?X(mr)?mr?zr?new ne(zr.thisDep,zr.contextDep,zr.propDep,function(aa,da){return da.def(aa.ELEMENTS,".vertCount-",aa.OFFSET)}):Q(function(aa,da){return da.def(aa.ELEMENTS,".vertCount")}):Q(function(){return-1}):new ne(mr.thisDep||zr.thisDep,mr.contextDep||zr.contextDep,mr.propDep||zr.propDep,function(aa,da){var ma=aa.ELEMENTS;return aa.OFFSET?da.def(ma,"?",ma,".vertCount-",aa.OFFSET,":-1"):da.def(ma,"?",ma,".vertCount:-1")}):xn?new ne(un.thisDep,un.contextDep,un.propDep,function(aa,da){return da.def(aa.shared.vao,".currentVAO?",aa.shared.vao,".currentVAO.count:-1")}):null}(),ta=rn("instances",!1);return{elements:mr,primitive:gn,count:On,instances:ta,offset:zr,vao:un,vaoActive:xn,elementsActive:gr,static:Tn}}function yr(Vt,hr){var rn=Vt.static,vn=Vt.dynamic,en={};return ua.forEach(function(Tn){function xn(gr,mr){if(Tn in rn){var zr=gr(rn[Tn]);en[un]=Q(function(){return zr})}else if(Tn in vn){var gn=vn[Tn];en[un]=ie(gn,function(On,ta){return mr(On,ta,On.invoke(ta,gn))})}}var un=At(Tn);switch(Tn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return xn(function(gr){return gr},function(gr,mr,zr){return zr});case"depth.func":return xn(function(gr){return Ht[gr]},function(gr,mr,zr){return mr.def(gr.constants.compareFuncs,"[",zr,"]")});case"depth.range":return xn(function(gr){return gr},function(gr,mr,zr){return gr=mr.def("+",zr,"[0]"),mr=mr.def("+",zr,"[1]"),[gr,mr]});case"blend.func":return xn(function(gr){return[Xt["srcRGB"in gr?gr.srcRGB:gr.src],Xt["dstRGB"in gr?gr.dstRGB:gr.dst],Xt["srcAlpha"in gr?gr.srcAlpha:gr.src],Xt["dstAlpha"in gr?gr.dstAlpha:gr.dst]]},function(gr,mr,zr){function gn(jn,aa){return mr.def('"',jn,aa,'" in ',zr,"?",zr,".",jn,aa,":",zr,".",jn)}gr=gr.constants.blendFuncs;var On=gn("src","RGB"),_n=gn("dst","RGB"),On=mr.def(gr,"[",On,"]"),ta=mr.def(gr,"[",gn("src","Alpha"),"]"),_n=mr.def(gr,"[",_n,"]");return gr=mr.def(gr,"[",gn("dst","Alpha"),"]"),[On,_n,ta,gr]});case"blend.equation":return xn(function(gr){if(typeof gr=="string")return[Wa[gr],Wa[gr]];if(typeof gr=="object")return[Wa[gr.rgb],Wa[gr.alpha]]},function(gr,mr,zr){var gn=gr.constants.blendEquations,On=mr.def(),ta=mr.def();return gr=gr.cond("typeof ",zr,'==="string"'),gr.then(On,"=",ta,"=",gn,"[",zr,"];"),gr.else(On,"=",gn,"[",zr,".rgb];",ta,"=",gn,"[",zr,".alpha];"),mr(gr),[On,ta]});case"blend.color":return xn(function(gr){return i(4,function(mr){return+gr[mr]})},function(gr,mr,zr){return i(4,function(gn){return mr.def("+",zr,"[",gn,"]")})});case"stencil.mask":return xn(function(gr){return gr|0},function(gr,mr,zr){return mr.def(zr,"|0")});case"stencil.func":return xn(function(gr){return[Ht[gr.cmp||"keep"],gr.ref||0,"mask"in gr?gr.mask:-1]},function(gr,mr,zr){gr=mr.def('"cmp" in ',zr,"?",gr.constants.compareFuncs,"[",zr,".cmp]",":",7680);var gn=mr.def(zr,".ref|0");return mr=mr.def('"mask" in ',zr,"?",zr,".mask|0:-1"),[gr,gn,mr]});case"stencil.opFront":case"stencil.opBack":return xn(function(gr){return[Tn==="stencil.opBack"?1029:1028,ar[gr.fail||"keep"],ar[gr.zfail||"keep"],ar[gr.zpass||"keep"]]},function(gr,mr,zr){function gn(ta){return mr.def('"',ta,'" in ',zr,"?",On,"[",zr,".",ta,"]:",7680)}var On=gr.constants.stencilOps;return[Tn==="stencil.opBack"?1029:1028,gn("fail"),gn("zfail"),gn("zpass")]});case"polygonOffset.offset":return xn(function(gr){return[gr.factor|0,gr.units|0]},function(gr,mr,zr){return gr=mr.def(zr,".factor|0"),mr=mr.def(zr,".units|0"),[gr,mr]});case"cull.face":return xn(function(gr){var mr=0;return gr==="front"?mr=1028:gr==="back"&&(mr=1029),mr},function(gr,mr,zr){return mr.def(zr,'==="front"?',1028,":",1029)});case"lineWidth":return xn(function(gr){return gr},function(gr,mr,zr){return zr});case"frontFace":return xn(function(gr){return Vr[gr]},function(gr,mr,zr){return mr.def(zr+'==="cw"?2304:2305')});case"colorMask":return xn(function(gr){return gr.map(function(mr){return!!mr})},function(gr,mr,zr){return i(4,function(gn){return"!!"+zr+"["+gn+"]"})});case"sample.coverage":return xn(function(gr){return["value"in gr?gr.value:1,!!gr.invert]},function(gr,mr,zr){return gr=mr.def('"value" in ',zr,"?+",zr,".value:1"),mr=mr.def("!!",zr,".invert"),[gr,mr]})}}),en}function Pr(Vt,hr){var rn=Vt.static,vn=Vt.dynamic,en={};return Object.keys(rn).forEach(function(Tn){var xn=rn[Tn],un;if(typeof xn=="number"||typeof xn=="boolean")un=Q(function(){return xn});else if(typeof xn=="function"){var gr=xn._reglType;gr==="texture2d"||gr==="textureCube"?un=Q(function(mr){return mr.link(xn)}):(gr==="framebuffer"||gr==="framebufferCube")&&(un=Q(function(mr){return mr.link(xn.color[0])}))}else b(xn)&&(un=Q(function(mr){return mr.global.def("[",i(xn.length,function(zr){return xn[zr]}),"]")}));un.value=xn,en[Tn]=un}),Object.keys(vn).forEach(function(Tn){var xn=vn[Tn];en[Tn]=ie(xn,function(un,gr){return un.invoke(gr,xn)})}),en}function Or(Vt,hr){var rn=Vt.static,vn=Vt.dynamic,en={};return Object.keys(rn).forEach(function(Tn){var xn=rn[Tn],un=$t.id(Tn),gr=new ja;if(U(xn))gr.state=1,gr.buffer=wr.getBuffer(wr.create(xn,34962,!1,!0)),gr.type=0;else{var mr=wr.getBuffer(xn);if(mr)gr.state=1,gr.buffer=mr,gr.type=0;else if("constant"in xn){var zr=xn.constant;gr.buffer="null",gr.state=2,typeof zr=="number"?gr.x=zr:Dt.forEach(function(aa,da){da<zr.length&&(gr[aa]=zr[da])})}else{var mr=U(xn.buffer)?wr.getBuffer(wr.create(xn.buffer,34962,!1,!0)):wr.getBuffer(xn.buffer),gn=xn.offset|0,On=xn.stride|0,ta=xn.size|0,_n=!!xn.normalized,jn=0;"type"in xn&&(jn=ke[xn.type]),xn=xn.divisor|0,gr.buffer=mr,gr.state=1,gr.size=ta,gr.normalized=_n,gr.type=jn||mr.dtype,gr.offset=gn,gr.stride=On,gr.divisor=xn}}en[Tn]=Q(function(aa,da){var ma=aa.attribCache;if(un in ma)return ma[un];var sa={isStream:!1};return Object.keys(gr).forEach(function(Aa){sa[Aa]=gr[Aa]}),gr.buffer&&(sa.buffer=aa.link(gr.buffer),sa.type=sa.type||sa.buffer+".dtype"),ma[un]=sa})}),Object.keys(vn).forEach(function(Tn){var xn=vn[Tn];en[Tn]=ie(xn,function(un,gr){function mr(ma){gr(_n[ma],"=",zr,".",ma,"|0;")}var zr=un.invoke(gr,xn),ta=un.shared,gn=un.constants,On=ta.isBufferArgs,ta=ta.buffer,_n={isStream:gr.def(!1)},jn=new ja;jn.state=1,Object.keys(jn).forEach(function(ma){_n[ma]=gr.def(""+jn[ma])});var aa=_n.buffer,da=_n.type;return gr("if(",On,"(",zr,")){",_n.isStream,"=true;",aa,"=",ta,".createStream(",34962,",",zr,");",da,"=",aa,".dtype;","}else{",aa,"=",ta,".getBuffer(",zr,");","if(",aa,"){",da,"=",aa,".dtype;",'}else if("constant" in ',zr,"){",_n.state,"=",2,";","if(typeof "+zr+'.constant === "number"){',_n[Dt[0]],"=",zr,".constant;",Dt.slice(1).map(function(ma){return _n[ma]}).join("="),"=0;","}else{",Dt.map(function(ma,sa){return _n[ma]+"="+zr+".constant.length>"+sa+"?"+zr+".constant["+sa+"]:0;"}).join(""),"}}else{","if(",On,"(",zr,".buffer)){",aa,"=",ta,".createStream(",34962,",",zr,".buffer);","}else{",aa,"=",ta,".getBuffer(",zr,".buffer);","}",da,'="type" in ',zr,"?",gn.glTypes,"[",zr,".type]:",aa,".dtype;",_n.normalized,"=!!",zr,".normalized;"),mr("size"),mr("offset"),mr("stride"),mr("divisor"),gr("}}"),gr.exit("if(",_n.isStream,"){",ta,".destroyStream(",aa,");","}"),_n})}),en}function Sr(Vt){var hr=Vt.static,rn=Vt.dynamic,vn={};return Object.keys(hr).forEach(function(en){var Tn=hr[en];vn[en]=Q(function(xn,un){return typeof Tn=="number"||typeof Tn=="boolean"?""+Tn:xn.link(Tn)})}),Object.keys(rn).forEach(function(en){var Tn=rn[en];vn[en]=ie(Tn,function(xn,un){return xn.invoke(un,Tn)})}),vn}function tt(Vt,hr,rn,vn,en){function Tn(jn){var aa=un[jn];aa&&(mr[jn]=aa)}var xn=Ar(Vt,hr),On=kr(Vt),un=br(Vt,On),gr=nr(Vt),mr=yr(Vt),zr=Wr(Vt,en,xn);Tn("viewport"),Tn(At("scissor.box"));var gn=0<Object.keys(mr).length,On={framebuffer:On,draw:gr,shader:zr,state:mr,dirty:gn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(On.profile=rr(Vt),On.uniforms=Pr(rn),On.drawVAO=On.scopeVAO=gr.vao,!On.drawVAO&&zr.program&&!xn&&Zt.angle_instanced_arrays&&gr.static.elements){var ta=!0;if(Vt=zr.program.attributes.map(function(jn){return jn=hr.static[jn],ta=ta&&!!jn,jn}),ta&&0<Vt.length){var _n=Tt.getVAO(Tt.createVAO({attributes:Vt,elements:gr.static.elements}));On.drawVAO=new ne(null,null,null,function(jn,aa){return jn.link(_n)}),On.useVAO=!0}}return xn?On.useVAO=!0:On.attributes=Or(hr),On.context=Sr(vn),On}function Lt(Vt,hr,rn){var vn=Vt.shared.context,en=Vt.scope();Object.keys(rn).forEach(function(Tn){hr.save(vn,"."+Tn);var xn=rn[Tn].append(Vt,hr);Array.isArray(xn)?en(vn,".",Tn,"=[",xn.join(),"];"):en(vn,".",Tn,"=",xn,";")}),hr(en)}function Wt(Vt,hr,rn,vn){var un=Vt.shared,en=un.gl,Tn=un.framebuffer,xn;pn&&(xn=hr.def(un.extensions,".webgl_draw_buffers"));var gr=Vt.constants,un=gr.drawBuffer,gr=gr.backBuffer;Vt=rn?rn.append(Vt,hr):hr.def(Tn,".next"),vn||hr("if(",Vt,"!==",Tn,".cur){"),hr("if(",Vt,"){",en,".bindFramebuffer(",36160,",",Vt,".framebuffer);"),pn&&hr(xn,".drawBuffersWEBGL(",un,"[",Vt,".colorAttachments.length]);"),hr("}else{",en,".bindFramebuffer(",36160,",null);"),pn&&hr(xn,".drawBuffersWEBGL(",gr,");"),hr("}",Tn,".cur=",Vt,";"),vn||hr("}")}function ir(Vt,hr,rn){var vn=Vt.shared,en=vn.gl,Tn=Vt.current,xn=Vt.next,un=vn.current,gr=vn.next,mr=Vt.cond(un,".dirty");ua.forEach(function(zr){if(zr=At(zr),!(zr in rn.state)){var gn,On;if(zr in xn){gn=xn[zr],On=Tn[zr];var ta=i(An[zr].length,function(_n){return mr.def(gn,"[",_n,"]")});mr(Vt.cond(ta.map(function(_n,jn){return _n+"!=="+On+"["+jn+"]"}).join("||")).then(en,".",Rn[zr],"(",ta,");",ta.map(function(_n,jn){return On+"["+jn+"]="+_n}).join(";"),";"))}else gn=mr.def(gr,".",zr),ta=Vt.cond(gn,"!==",un,".",zr),mr(ta),zr in ea?ta(Vt.cond(gn).then(en,".enable(",ea[zr],");").else(en,".disable(",ea[zr],");"),un,".",zr,"=",gn,";"):ta(en,".",Rn[zr],"(",gn,");",un,".",zr,"=",gn,";")}}),Object.keys(rn.state).length===0&&mr(un,".dirty=false;"),hr(mr)}function Ir(Vt,hr,rn,vn){var en=Vt.shared,Tn=Vt.current,xn=en.current,un=en.gl,gr;$(Object.keys(rn)).forEach(function(mr){var zr=rn[mr];if(!vn||vn(zr)){var gn=zr.append(Vt,hr);if(ea[mr]){var On=ea[mr];X(zr)?(gr=Vt.link(gn,{stable:!0}),hr(Vt.cond(gr).then(un,".enable(",On,");").else(un,".disable(",On,");")),hr(xn,".",mr,"=",gr,";")):(hr(Vt.cond(gn).then(un,".enable(",On,");").else(un,".disable(",On,");")),hr(xn,".",mr,"=",gn,";"))}else if(b(gn)){var ta=Tn[mr];hr(un,".",Rn[mr],"(",gn,");",gn.map(function(_n,jn){return ta+"["+jn+"]="+_n}).join(";"),";")}else X(zr)?(gr=Vt.link(gn,{stable:!0}),hr(un,".",Rn[mr],"(",gr,");",xn,".",mr,"=",gr,";")):hr(un,".",Rn[mr],"(",gn,");",xn,".",mr,"=",gn,";")}})}function Br(Vt,hr){Tr&&(Vt.instancing=hr.def(Vt.shared.extensions,".angle_instanced_arrays"))}function Er(Vt,hr,rn,vn,en){function Tn(){return typeof performance>"u"?"Date.now()":"performance.now()"}function xn(jn){ta=hr.def(),jn(ta,"=",Tn(),";"),typeof en=="string"?jn(zr,".count+=",en,";"):jn(zr,".count++;"),nt&&(vn?(_n=hr.def(),jn(_n,"=",On,".getNumPendingQueries();")):jn(On,".beginQuery(",zr,");"))}function un(jn){jn(zr,".cpuTime+=",Tn(),"-",ta,";"),nt&&(vn?jn(On,".pushScopeStats(",_n,",",On,".getNumPendingQueries(),",zr,");"):jn(On,".endQuery();"))}function gr(jn){var aa=hr.def(gn,".profile");hr(gn,".profile=",jn,";"),hr.exit(gn,".profile=",aa,";")}var mr=Vt.shared,zr=Vt.stats,gn=mr.current,On=mr.timer;rn=rn.profile;var ta,_n;if(rn){if(X(rn)){rn.enable?(xn(hr),un(hr.exit),gr("true")):gr("false");return}rn=rn.append(Vt,hr),gr(rn)}else rn=hr.def(gn,".profile");mr=Vt.block(),xn(mr),hr("if(",rn,"){",mr,"}"),Vt=Vt.block(),un(Vt),hr.exit("if(",rn,"){",Vt,"}")}function _r(Vt,hr,rn,vn,en){function Tn(gr){switch(gr){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function xn(gr,mr,zr){function gn(){hr("if(!",jn,".buffer){",ta,".enableVertexAttribArray(",_n,");}");var sa=zr.type,Aa;Aa=zr.size?hr.def(zr.size,"||",mr):mr,hr("if(",jn,".type!==",sa,"||",jn,".size!==",Aa,"||",ma.map(function(po){return jn+"."+po+"!=="+zr[po]}).join("||"),"){",ta,".bindBuffer(",34962,",",aa,".buffer);",ta,".vertexAttribPointer(",[_n,Aa,sa,zr.normalized,zr.stride,zr.offset],");",jn,".type=",sa,";",jn,".size=",Aa,";",ma.map(function(po){return jn+"."+po+"="+zr[po]+";"}).join(""),"}"),Tr&&(sa=zr.divisor,hr("if(",jn,".divisor!==",sa,"){",Vt.instancing,".vertexAttribDivisorANGLE(",[_n,sa],");",jn,".divisor=",sa,";}"))}function On(){hr("if(",jn,".buffer){",ta,".disableVertexAttribArray(",_n,");",jn,".buffer=null;","}if(",Dt.map(function(sa,Aa){return jn+"."+sa+"!=="+da[Aa]}).join("||"),"){",ta,".vertexAttrib4f(",_n,",",da,");",Dt.map(function(sa,Aa){return jn+"."+sa+"="+da[Aa]+";"}).join(""),"}")}var ta=un.gl,_n=hr.def(gr,".location"),jn=hr.def(un.attributes,"[",_n,"]");gr=zr.state;var aa=zr.buffer,da=[zr.x,zr.y,zr.z,zr.w],ma=["buffer","normalized","offset","stride"];gr===1?gn():gr===2?On():(hr("if(",gr,"===",1,"){"),gn(),hr("}else{"),On(),hr("}"))}var un=Vt.shared;vn.forEach(function(gr){var mr=gr.name,zr=rn.attributes[mr],gn;if(zr){if(!en(zr))return;gn=zr.append(Vt,hr)}else{if(!en(nn))return;var On=Vt.scopeAttrib(mr);gn={},Object.keys(new ja).forEach(function(ta){gn[ta]=hr.def(On,".",ta)})}xn(Vt.link(gr),Tn(gr.info.type),gn)})}function Gr(Vt,hr,rn,vn,en,Tn){for(var xn=Vt.shared,un=xn.gl,gr,mr=0;mr<vn.length;++mr){var ta=vn[mr],zr=ta.name,gn=ta.info.type,On=rn.uniforms[zr],ta=Vt.link(ta)+".location",_n;if(On){if(!en(On))continue;if(X(On)){if(zr=On.value,gn===35678||gn===35680)gn=Vt.link(zr._texture||zr.color[0]._texture),hr(un,".uniform1i(",ta,",",gn+".bind());"),hr.exit(gn,".unbind();");else if(gn===35674||gn===35675||gn===35676)zr=Vt.global.def("new Float32Array(["+Array.prototype.slice.call(zr)+"])"),On=2,gn===35675?On=3:gn===35676&&(On=4),hr(un,".uniformMatrix",On,"fv(",ta,",false,",zr,");");else{switch(gn){case 5126:gr="1f";break;case 35664:gr="2f";break;case 35665:gr="3f";break;case 35666:gr="4f";break;case 35670:gr="1i";break;case 5124:gr="1i";break;case 35671:gr="2i";break;case 35667:gr="2i";break;case 35672:gr="3i";break;case 35668:gr="3i";break;case 35673:gr="4i";break;case 35669:gr="4i"}hr(un,".uniform",gr,"(",ta,",",b(zr)?Array.prototype.slice.call(zr):zr,");")}continue}else _n=On.append(Vt,hr)}else{if(!en(nn))continue;_n=hr.def(xn.uniforms,"[",$t.id(zr),"]")}switch(gn===35678?hr("if(",_n,"&&",_n,'._reglType==="framebuffer"){',_n,"=",_n,".color[0];","}"):gn===35680&&hr("if(",_n,"&&",_n,'._reglType==="framebufferCube"){',_n,"=",_n,".color[0];","}"),zr=1,gn){case 35678:case 35680:gn=hr.def(_n,"._texture"),hr(un,".uniform1i(",ta,",",gn,".bind());"),hr.exit(gn,".unbind();");continue;case 5124:case 35670:gr="1i";break;case 35667:case 35671:gr="2i",zr=2;break;case 35668:case 35672:gr="3i",zr=3;break;case 35669:case 35673:gr="4i",zr=4;break;case 5126:gr="1f";break;case 35664:gr="2f",zr=2;break;case 35665:gr="3f",zr=3;break;case 35666:gr="4f",zr=4;break;case 35674:gr="Matrix2fv";break;case 35675:gr="Matrix3fv";break;case 35676:gr="Matrix4fv"}if(gr.charAt(0)==="M"){hr(un,".uniform",gr,"(",ta,",");var ta=Math.pow(gn-35674+2,2),jn=Vt.global.def("new Float32Array(",ta,")");Array.isArray(_n)?hr("false,(",i(ta,function(ma){return jn+"["+ma+"]="+_n[ma]}),",",jn,")"):hr("false,(Array.isArray(",_n,")||",_n," instanceof Float32Array)?",_n,":(",i(ta,function(ma){return jn+"["+ma+"]="+_n+"["+ma+"]"}),",",jn,")"),hr(");")}else{if(1<zr){for(var gn=[],aa=[],On=0;On<zr;++On)Array.isArray(_n)?aa.push(_n[On]):aa.push(hr.def(_n+"["+On+"]")),Tn&&gn.push(hr.def());Tn&&hr("if(!",Vt.batchId,"||",gn.map(function(da,ma){return da+"!=="+aa[ma]}).join("||"),"){",gn.map(function(da,ma){return da+"="+aa[ma]+";"}).join("")),hr(un,".uniform",gr,"(",ta,",",aa.join(","),");")}else Tn&&(gn=hr.def(),hr("if(!",Vt.batchId,"||",gn,"!==",_n,"){",gn,"=",_n,";")),hr(un,".uniform",gr,"(",ta,",",_n,");");Tn&&hr("}")}}}function wn(Vt,hr,rn,vn){function en(sa){var Aa=zr[sa];return Aa?Aa.contextDep&&vn.contextDynamic||Aa.propDep?Aa.append(Vt,rn):Aa.append(Vt,hr):hr.def(mr,".",sa)}function Tn(){function sa(){rn(aa,".drawElementsInstancedANGLE(",[On,_n,da,ta+"<<(("+da+"-5121)>>1)",jn],");")}function Aa(){rn(aa,".drawArraysInstancedANGLE(",[On,ta,_n,jn],");")}gn&&gn!=="null"?ma?sa():(rn("if(",gn,"){"),sa(),rn("}else{"),Aa(),rn("}")):Aa()}function xn(){function sa(){rn(gr+".drawElements("+[On,_n,da,ta+"<<(("+da+"-5121)>>1)"]+");")}function Aa(){rn(gr+".drawArrays("+[On,ta,_n]+");")}gn&&gn!=="null"?ma?sa():(rn("if(",gn,"){"),sa(),rn("}else{"),Aa(),rn("}")):Aa()}var un=Vt.shared,gr=un.gl,mr=un.draw,zr=vn.draw,gn=function(){var sa=zr.elements,Aa=hr;return sa?((sa.contextDep&&vn.contextDynamic||sa.propDep)&&(Aa=rn),sa=sa.append(Vt,Aa),zr.elementsActive&&Aa("if("+sa+")"+gr+".bindBuffer(34963,"+sa+".buffer.buffer);")):(sa=Aa.def(),Aa(sa,"=",mr,".","elements",";","if(",sa,"){",gr,".bindBuffer(",34963,",",sa,".buffer.buffer);}","else if(",un.vao,".currentVAO){",sa,"=",Vt.shared.elements+".getElements("+un.vao,".currentVAO.elements);",fn?"":"if("+sa+")"+gr+".bindBuffer(34963,"+sa+".buffer.buffer);","}")),sa}(),On=en("primitive"),ta=en("offset"),_n=function(){var sa=zr.count,Aa=hr;return sa?((sa.contextDep&&vn.contextDynamic||sa.propDep)&&(Aa=rn),sa=sa.append(Vt,Aa)):sa=Aa.def(mr,".","count"),sa}();if(typeof _n=="number"){if(_n===0)return}else rn("if(",_n,"){"),rn.exit("}");var jn,aa;Tr&&(jn=en("instances"),aa=Vt.instancing);var da=gn+".type",ma=zr.elements&&X(zr.elements)&&!zr.vaoActive;Tr&&(typeof jn!="number"||0<=jn)?typeof jn=="string"?(rn("if(",jn,">0){"),Tn(),rn("}else if(",jn,"<0){"),xn(),rn("}")):Tn():xn()}function cn(Vt,hr,rn,vn,en){return hr=Gt(),en=hr.proc("body",en),Tr&&(hr.instancing=en.def(hr.shared.extensions,".angle_instanced_arrays")),Vt(hr,en,rn,vn),hr.compile().body}function Bn(Vt,hr,rn,vn){Br(Vt,hr),rn.useVAO?rn.drawVAO?hr(Vt.shared.vao,".setVAO(",rn.drawVAO.append(Vt,hr),");"):hr(Vt.shared.vao,".setVAO(",Vt.shared.vao,".targetVAO);"):(hr(Vt.shared.vao,".setVAO(null);"),_r(Vt,hr,rn,vn.attributes,function(){return!0})),Gr(Vt,hr,rn,vn.uniforms,function(){return!0},!1),wn(Vt,hr,hr,rn)}function En(Vt,hr){var rn=Vt.proc("draw",1);Br(Vt,rn),Lt(Vt,rn,hr.context),Wt(Vt,rn,hr.framebuffer),ir(Vt,rn,hr),Ir(Vt,rn,hr.state),Er(Vt,rn,hr,!1,!0);var vn=hr.shader.progVar.append(Vt,rn);if(rn(Vt.shared.gl,".useProgram(",vn,".program);"),hr.shader.program)Bn(Vt,rn,hr,hr.shader.program);else{rn(Vt.shared.vao,".setVAO(null);");var en=Vt.global.def("{}"),Tn=rn.def(vn,".id"),xn=rn.def(en,"[",Tn,"]");rn(Vt.cond(xn).then(xn,".call(this,a0);").else(xn,"=",en,"[",Tn,"]=",Vt.link(function(un){return cn(Bn,Vt,hr,un,1)}),"(",vn,");",xn,".call(this,a0);"))}0<Object.keys(hr.state).length&&rn(Vt.shared.current,".dirty=true;"),Vt.shared.vao&&rn(Vt.shared.vao,".setVAO(null);")}function Yn(Vt,hr,rn,vn){function en(){return!0}Vt.batchId="a1",Br(Vt,hr),_r(Vt,hr,rn,vn.attributes,en),Gr(Vt,hr,rn,vn.uniforms,en,!1),wn(Vt,hr,hr,rn)}function Hn(Vt,hr,rn,vn){function en(gn){return gn.contextDep&&xn||gn.propDep}function Tn(gn){return!en(gn)}Br(Vt,hr);var xn=rn.contextDep,un=hr.def(),gr=hr.def();Vt.shared.props=gr,Vt.batchId=un;var mr=Vt.scope(),zr=Vt.scope();hr(mr.entry,"for(",un,"=0;",un,"<","a1",";++",un,"){",gr,"=","a0","[",un,"];",zr,"}",mr.exit),rn.needsContext&&Lt(Vt,zr,rn.context),rn.needsFramebuffer&&Wt(Vt,zr,rn.framebuffer),Ir(Vt,zr,rn.state,en),rn.profile&&en(rn.profile)&&Er(Vt,zr,rn,!1,!0),vn?(rn.useVAO?rn.drawVAO?en(rn.drawVAO)?zr(Vt.shared.vao,".setVAO(",rn.drawVAO.append(Vt,zr),");"):mr(Vt.shared.vao,".setVAO(",rn.drawVAO.append(Vt,mr),");"):mr(Vt.shared.vao,".setVAO(",Vt.shared.vao,".targetVAO);"):(mr(Vt.shared.vao,".setVAO(null);"),_r(Vt,mr,rn,vn.attributes,Tn),_r(Vt,zr,rn,vn.attributes,en)),Gr(Vt,mr,rn,vn.uniforms,Tn,!1),Gr(Vt,zr,rn,vn.uniforms,en,!0),wn(Vt,mr,zr,rn)):(hr=Vt.global.def("{}"),vn=rn.shader.progVar.append(Vt,zr),gr=zr.def(vn,".id"),mr=zr.def(hr,"[",gr,"]"),zr(Vt.shared.gl,".useProgram(",vn,".program);","if(!",mr,"){",mr,"=",hr,"[",gr,"]=",Vt.link(function(gn){return cn(Yn,Vt,rn,gn,2)}),"(",vn,");}",mr,".call(this,a0[",un,"],",un,");"))}function pa(Vt,hr){function rn(mr){return mr.contextDep&&en||mr.propDep}var vn=Vt.proc("batch",2);Vt.batchId="0",Br(Vt,vn);var en=!1,Tn=!0;Object.keys(hr.context).forEach(function(mr){en=en||hr.context[mr].propDep}),en||(Lt(Vt,vn,hr.context),Tn=!1);var xn=hr.framebuffer,un=!1;if(xn?(xn.propDep?en=un=!0:xn.contextDep&&en&&(un=!0),un||Wt(Vt,vn,xn)):Wt(Vt,vn,null),hr.state.viewport&&hr.state.viewport.propDep&&(en=!0),ir(Vt,vn,hr),Ir(Vt,vn,hr.state,function(mr){return!rn(mr)}),hr.profile&&rn(hr.profile)||Er(Vt,vn,hr,!1,"a1"),hr.contextDep=en,hr.needsContext=Tn,hr.needsFramebuffer=un,Tn=hr.shader.progVar,Tn.contextDep&&en||Tn.propDep)Hn(Vt,vn,hr,null);else if(Tn=Tn.append(Vt,vn),vn(Vt.shared.gl,".useProgram(",Tn,".program);"),hr.shader.program)Hn(Vt,vn,hr,hr.shader.program);else{vn(Vt.shared.vao,".setVAO(null);");var xn=Vt.global.def("{}"),un=vn.def(Tn,".id"),gr=vn.def(xn,"[",un,"]");vn(Vt.cond(gr).then(gr,".call(this,a0,a1);").else(gr,"=",xn,"[",un,"]=",Vt.link(function(gn){return cn(Hn,Vt,hr,gn,2)}),"(",Tn,");",gr,".call(this,a0,a1);"))}0<Object.keys(hr.state).length&&vn(Vt.shared.current,".dirty=true;"),Vt.shared.vao&&vn(Vt.shared.vao,".setVAO(null);")}function Ma(Vt,hr){function rn(un){var gr=hr.shader[un];gr&&(gr=gr.append(Vt,vn),isNaN(gr)?vn.set(en.shader,"."+un,gr):vn.set(en.shader,"."+un,Vt.link(gr,{stable:!0})))}var vn=Vt.proc("scope",3);Vt.batchId="a2";var en=Vt.shared,Tn=en.current;if(Lt(Vt,vn,hr.context),hr.framebuffer&&hr.framebuffer.append(Vt,vn),$(Object.keys(hr.state)).forEach(function(un){var gr=hr.state[un],mr=gr.append(Vt,vn);b(mr)?mr.forEach(function(zr,gn){isNaN(zr)?vn.set(Vt.next[un],"["+gn+"]",zr):vn.set(Vt.next[un],"["+gn+"]",Vt.link(zr,{stable:!0}))}):X(gr)?vn.set(en.next,"."+un,Vt.link(mr,{stable:!0})):vn.set(en.next,"."+un,mr)}),Er(Vt,vn,hr,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(un){var gr=hr.draw[un];gr&&(gr=gr.append(Vt,vn),isNaN(gr)?vn.set(en.draw,"."+un,gr):vn.set(en.draw,"."+un,Vt.link(gr),{stable:!0}))}),Object.keys(hr.uniforms).forEach(function(un){var gr=hr.uniforms[un].append(Vt,vn);Array.isArray(gr)&&(gr="["+gr.map(function(mr){return isNaN(mr)?mr:Vt.link(mr,{stable:!0})})+"]"),vn.set(en.uniforms,"["+Vt.link($t.id(un),{stable:!0})+"]",gr)}),Object.keys(hr.attributes).forEach(function(un){var gr=hr.attributes[un].append(Vt,vn),mr=Vt.scopeAttrib(un);Object.keys(new ja).forEach(function(zr){vn.set(mr,"."+zr,gr[zr])})}),hr.scopeVAO){var xn=hr.scopeVAO.append(Vt,vn);isNaN(xn)?vn.set(en.vao,".targetVAO",xn):vn.set(en.vao,".targetVAO",Vt.link(xn,{stable:!0}))}rn("vert"),rn("frag"),0<Object.keys(hr.state).length&&(vn(Tn,".dirty=true;"),vn.exit(Tn,".dirty=true;")),vn("a1(",Vt.shared.context,",a0,",Vt.batchId,");")}function ci(Vt){if(typeof Vt=="object"&&!b(Vt)){for(var hr=Object.keys(Vt),rn=0;rn<hr.length;++rn)if(ce.isDynamic(Vt[hr[rn]]))return!0;return!1}}function Ha(Vt,hr,rn){function vn(gn,On){xn.forEach(function(ta){var _n=en[ta];ce.isDynamic(_n)&&(_n=gn.invoke(On,_n),On(zr,".",ta,"=",_n,";"))})}var en=hr.static[rn];if(en&&ci(en)){var Tn=Vt.global,xn=Object.keys(en),un=!1,gr=!1,mr=!1,zr=Vt.global.def("{}");xn.forEach(function(gn){var On=en[gn];if(ce.isDynamic(On))typeof On=="function"&&(On=en[gn]=ce.unbox(On)),gn=ie(On,null),un=un||gn.thisDep,mr=mr||gn.propDep,gr=gr||gn.contextDep;else{switch(Tn(zr,".",gn,"="),typeof On){case"number":Tn(On);break;case"string":Tn('"',On,'"');break;case"object":Array.isArray(On)&&Tn("[",On.join(),"]");break;default:Tn(Vt.link(On))}Tn(";")}}),hr.dynamic[rn]=new ce.DynamicVariable(4,{thisDep:un,contextDep:gr,propDep:mr,ref:zr,append:vn}),delete hr.static[rn]}}var ja=Tt.Record,Wa={add:32774,subtract:32778,"reverse subtract":32779};Zt.ext_blend_minmax&&(Wa.min=32775,Wa.max=32776);var Tr=Zt.angle_instanced_arrays,pn=Zt.webgl_draw_buffers,fn=Zt.oes_vertex_array_object,An={dirty:!0,profile:ct.profile},Zn={},ua=[],ea={},Rn={};dt("dither",3024),dt("blend.enable",3042),Ct("blend.color","blendColor",[0,0,0,0]),Ct("blend.equation","blendEquationSeparate",[32774,32774]),Ct("blend.func","blendFuncSeparate",[1,0,1,0]),dt("depth.enable",2929,!0),Ct("depth.func","depthFunc",513),Ct("depth.range","depthRange",[0,1]),Ct("depth.mask","depthMask",!0),Ct("colorMask","colorMask",[!0,!0,!0,!0]),dt("cull.enable",2884),Ct("cull.face","cullFace",1029),Ct("frontFace","frontFace",2305),Ct("lineWidth","lineWidth",1),dt("polygonOffset.enable",32823),Ct("polygonOffset.offset","polygonOffset",[0,0]),dt("sample.alpha",32926),dt("sample.enable",32928),Ct("sample.coverage","sampleCoverage",[1,!1]),dt("stencil.enable",2960),Ct("stencil.mask","stencilMask",-1),Ct("stencil.func","stencilFunc",[519,0,-1]),Ct("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),Ct("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),dt("scissor.enable",3089),Ct("scissor.box","scissor",[0,0,at.drawingBufferWidth,at.drawingBufferHeight]),Ct("viewport","viewport",[0,0,at.drawingBufferWidth,at.drawingBufferHeight]);var Xn={gl:at,context:Me,strings:$t,next:Zn,current:An,draw:Ce,elements:$e,buffer:wr,shader:Bt,attributes:Tt.state,vao:Tt,uniforms:lt,framebuffer:it,extensions:Zt,timer:nt,isBufferArgs:U},Ua={primTypes:Ge,compareFuncs:Ht,blendFuncs:Xt,blendEquations:Wa,stencilOps:ar,glTypes:ke,orientationType:Vr};pn&&(Ua.backBuffer=[1029],Ua.drawBuffer=i(ur.maxDrawbuffers,function(Vt){return Vt===0?[0]:i(Vt,function(hr){return 36064+hr})}));var li=0;return{next:Zn,current:An,procs:function(){var Vt=Gt(),hr=Vt.proc("poll"),rn=Vt.proc("refresh"),vn=Vt.block();hr(vn),rn(vn);var gr=Vt.shared,en=gr.gl,Tn=gr.next,xn=gr.current;vn(xn,".dirty=false;"),Wt(Vt,hr),Wt(Vt,rn,null,!0);var un;Tr&&(un=Vt.link(Tr)),Zt.oes_vertex_array_object&&rn(Vt.link(Zt.oes_vertex_array_object),".bindVertexArrayOES(null);");var gr=rn.def(gr.attributes),mr=rn.def(0),zr=Vt.cond(mr,".buffer");zr.then(en,".enableVertexAttribArray(i);",en,".bindBuffer(",34962,",",mr,".buffer.buffer);",en,".vertexAttribPointer(i,",mr,".size,",mr,".type,",mr,".normalized,",mr,".stride,",mr,".offset);").else(en,".disableVertexAttribArray(i);",en,".vertexAttrib4f(i,",mr,".x,",mr,".y,",mr,".z,",mr,".w);",mr,".buffer=null;");var gn=Vt.link(ur.maxAttributes,{stable:!0});return rn("for(var i=0;i<",gn,";++i){",mr,"=",gr,"[i];",zr,"}"),Tr&&rn("for(var i=0;i<",gn,";++i){",un,".vertexAttribDivisorANGLE(i,",gr,"[i].divisor);","}"),rn(Vt.shared.vao,".currentVAO=null;",Vt.shared.vao,".setVAO(",Vt.shared.vao,".targetVAO);"),Object.keys(ea).forEach(function(On){var ta=ea[On],_n=vn.def(Tn,".",On),jn=Vt.block();jn("if(",_n,"){",en,".enable(",ta,")}else{",en,".disable(",ta,")}",xn,".",On,"=",_n,";"),rn(jn),hr("if(",_n,"!==",xn,".",On,"){",jn,"}")}),Object.keys(Rn).forEach(function(On){var ta=Rn[On],_n=An[On],jn,aa,da=Vt.block();da(en,".",ta,"("),b(_n)?(ta=_n.length,jn=Vt.global.def(Tn,".",On),aa=Vt.global.def(xn,".",On),da(i(ta,function(ma){return jn+"["+ma+"]"}),");",i(ta,function(ma){return aa+"["+ma+"]="+jn+"["+ma+"];"}).join("")),hr("if(",i(ta,function(ma){return jn+"["+ma+"]!=="+aa+"["+ma+"]"}).join("||"),"){",da,"}")):(jn=vn.def(Tn,".",On),aa=vn.def(xn,".",On),da(jn,");",xn,".",On,"=",jn,";"),hr("if(",jn,"!==",aa,"){",da,"}")),rn(da)}),Vt.compile()}(),compile:function(Vt,hr,rn,vn,en){var Tn=Gt();Tn.stats=Tn.link(en),Object.keys(hr.static).forEach(function(un){Ha(Tn,hr,un)}),Nt.forEach(function(un){Ha(Tn,Vt,un)});var xn=tt(Vt,hr,rn,vn,Tn);return xn.shader.program&&(xn.shader.program.attributes.sort(function(un,gr){return un.name<gr.name?-1:1}),xn.shader.program.uniforms.sort(function(un,gr){return un.name<gr.name?-1:1})),En(Tn,xn),Ma(Tn,xn),pa(Tn,xn),oe(Tn.compile(),{destroy:function(){xn.shader.program.destroy()}})}}}function ae(at,$t){for(var Zt=0;Zt<at.length;++Zt)if(at[Zt]===$t)return Zt;return-1}var oe=function(at,$t){for(var Zt=Object.keys($t),ur=0;ur<Zt.length;++ur)at[Zt[ur]]=$t[Zt[ur]];return at},be=0,ce={DynamicVariable:A,define:function(at,$t){return new A(at,S($t+""))},isDynamic:function(at){return typeof at=="function"&&!at._reglType||at instanceof A},unbox:M,accessor:S},de={next:typeof requestAnimationFrame=="function"?function(at){return requestAnimationFrame(at)}:function(at){return setTimeout(at,16)},cancel:typeof cancelAnimationFrame=="function"?function(at){return cancelAnimationFrame(at)}:clearTimeout},ye=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date},ge=p();ge.zero=p();var me=function(at,$t){var Zt=1;$t.ext_texture_filter_anisotropic&&(Zt=at.getParameter(34047));var ur=1,wr=1;$t.webgl_draw_buffers&&(ur=at.getParameter(34852),wr=at.getParameter(36063));var $e=!!$t.oes_texture_float;if($e){$e=at.createTexture(),at.bindTexture(3553,$e),at.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var Je=at.createFramebuffer();if(at.bindFramebuffer(36160,Je),at.framebufferTexture2D(36160,36064,3553,$e,0),at.bindTexture(3553,null),at.checkFramebufferStatus(36160)!==36053)$e=!1;else{at.viewport(0,0,1,1),at.clearColor(1,0,0,1),at.clear(16384);var it=ge.allocType(5126,4);at.readPixels(0,0,1,1,6408,5126,it),at.getError()?$e=!1:(at.deleteFramebuffer(Je),at.deleteTexture($e),$e=it[0]===1),ge.freeType(it)}}return it=!0,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(it=at.createTexture(),Je=ge.allocType(5121,36),at.activeTexture(33984),at.bindTexture(34067,it),at.texImage2D(34069,0,6408,3,3,0,6408,5121,Je),ge.freeType(Je),at.bindTexture(34067,null),at.deleteTexture(it),it=!at.getError()),{colorBits:[at.getParameter(3410),at.getParameter(3411),at.getParameter(3412),at.getParameter(3413)],depthBits:at.getParameter(3414),stencilBits:at.getParameter(3415),subpixelBits:at.getParameter(3408),extensions:Object.keys($t).filter(function(lt){return!!$t[lt]}),maxAnisotropic:Zt,maxDrawbuffers:ur,maxColorAttachments:wr,pointSizeDims:at.getParameter(33901),lineWidthDims:at.getParameter(33902),maxViewportDims:at.getParameter(3386),maxCombinedTextureUnits:at.getParameter(35661),maxCubeMapSize:at.getParameter(34076),maxRenderbufferSize:at.getParameter(34024),maxTextureUnits:at.getParameter(34930),maxTextureSize:at.getParameter(3379),maxAttributes:at.getParameter(34921),maxVertexUniforms:at.getParameter(36347),maxVertexTextureUnits:at.getParameter(35660),maxVaryingVectors:at.getParameter(36348),maxFragmentUniforms:at.getParameter(36349),glsl:at.getParameter(35724),renderer:at.getParameter(7937),vendor:at.getParameter(7936),version:at.getParameter(7938),readFloat:$e,npotTextureCube:it}},Ee=function(at){return at instanceof Uint8Array||at instanceof Uint16Array||at instanceof Uint32Array||at instanceof Int8Array||at instanceof Int16Array||at instanceof Int32Array||at instanceof Float32Array||at instanceof Float64Array||at instanceof Uint8ClampedArray},Pe=function(at){return Object.keys(at).map(function($t){return at[$t]})},Ne={shape:function(at){for(var $t=[];at.length;at=at[0])$t.push(at.length);return $t},flatten:function(at,$t,Zt,ur){var wr=1;if($t.length)for(var $e=0;$e<$t.length;++$e)wr*=$t[$e];else wr=0;switch(Zt=ur||ge.allocType(Zt,wr),$t.length){case 0:break;case 1:for(ur=$t[0],$t=0;$t<ur;++$t)Zt[$t]=at[$t];break;case 2:for(ur=$t[0],$t=$t[1],$e=wr=0;$e<ur;++$e)for(var Je=at[$e],it=0;it<$t;++it)Zt[wr++]=Je[it];break;case 3:f(at,$t[0],$t[1],$t[2],Zt,0);break;default:y(at,$t,0,Zt,0)}return Zt}},we={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ke={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Xe={dynamic:35048,stream:35040,static:35044},He=Ne.flatten,Ie=Ne.shape,De=[];De[5120]=1,De[5122]=2,De[5124]=4,De[5121]=1,De[5123]=2,De[5125]=4,De[5126]=4;var Ge={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ht=new Float32Array(1),Rt=new Uint32Array(ht.buffer),Kt=[9984,9986,9985,9987],It=[0,6409,6410,6407,6408],Mt={};Mt[6409]=Mt[6406]=Mt[6402]=1,Mt[34041]=Mt[6410]=2,Mt[6407]=Mt[35904]=3,Mt[6408]=Mt[35906]=4;var Yt=u("HTMLCanvasElement"),zt=u("OffscreenCanvas"),St=u("CanvasRenderingContext2D"),Ye=u("ImageBitmap"),rt=u("HTMLImageElement"),Ve=u("HTMLVideoElement"),Ae=Object.keys(we).concat([Yt,zt,St,Ye,rt,Ve]),Ue=[];Ue[5121]=1,Ue[5126]=4,Ue[36193]=2,Ue[5123]=2,Ue[5125]=4;var Ze=[];Ze[32854]=2,Ze[32855]=2,Ze[36194]=2,Ze[34041]=4,Ze[33776]=.5,Ze[33777]=.5,Ze[33778]=1,Ze[33779]=1,Ze[35986]=.5,Ze[35987]=1,Ze[34798]=1,Ze[35840]=.5,Ze[35841]=.25,Ze[35842]=.5,Ze[35843]=.25,Ze[36196]=.5;var Qe=[];Qe[32854]=2,Qe[32855]=2,Qe[36194]=2,Qe[33189]=2,Qe[36168]=1,Qe[34041]=4,Qe[35907]=4,Qe[34836]=16,Qe[34842]=8,Qe[34843]=6;var _t=function(at,$t,Zt,ur,wr){function $e(Ce){this.id=Tt++,this.refCount=1,this.renderbuffer=Ce,this.format=32854,this.height=this.width=0,wr.profile&&(this.stats={size:0})}function Je(Ce){var Me=Ce.renderbuffer;at.bindRenderbuffer(36161,null),at.deleteRenderbuffer(Me),Ce.renderbuffer=null,Ce.refCount=0,delete Bt[Ce.id],ur.renderbufferCount--}var it={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};$t.ext_srgb&&(it.srgba=35907),$t.ext_color_buffer_half_float&&(it.rgba16f=34842,it.rgb16f=34843),$t.webgl_color_buffer_float&&(it.rgba32f=34836);var lt=[];Object.keys(it).forEach(function(Ce){lt[it[Ce]]=Ce});var Tt=0,Bt={};return $e.prototype.decRef=function(){0>=--this.refCount&&Je(this)},wr.profile&&(ur.getTotalRenderbufferSize=function(){var Ce=0;return Object.keys(Bt).forEach(function(Me){Ce+=Bt[Me].stats.size}),Ce}),{create:function(Ce,Me){function nt(ct,At){var dt=0,Ct=0,Gt=32854;if(typeof ct=="object"&&ct?("shape"in ct?(Ct=ct.shape,dt=Ct[0]|0,Ct=Ct[1]|0):("radius"in ct&&(dt=Ct=ct.radius|0),"width"in ct&&(dt=ct.width|0),"height"in ct&&(Ct=ct.height|0)),"format"in ct&&(Gt=it[ct.format])):typeof ct=="number"?(dt=ct|0,Ct=typeof At=="number"?At|0:dt):ct||(dt=Ct=1),dt!==st.width||Ct!==st.height||Gt!==st.format)return nt.width=st.width=dt,nt.height=st.height=Ct,st.format=Gt,at.bindRenderbuffer(36161,st.renderbuffer),at.renderbufferStorage(36161,Gt,dt,Ct),wr.profile&&(st.stats.size=Qe[st.format]*st.width*st.height),nt.format=lt[st.format],nt}var st=new $e(at.createRenderbuffer());return Bt[st.id]=st,ur.renderbufferCount++,nt(Ce,Me),nt.resize=function(ct,At){var dt=ct|0,Ct=At|0||dt;return dt===st.width&&Ct===st.height||(nt.width=st.width=dt,nt.height=st.height=Ct,at.bindRenderbuffer(36161,st.renderbuffer),at.renderbufferStorage(36161,st.format,dt,Ct),wr.profile&&(st.stats.size=Qe[st.format]*st.width*st.height)),nt},nt._reglType="renderbuffer",nt._renderbuffer=st,wr.profile&&(nt.stats=st.stats),nt.destroy=function(){st.decRef()},nt},clear:function(){Pe(Bt).forEach(Je)},restore:function(){Pe(Bt).forEach(function(Ce){Ce.renderbuffer=at.createRenderbuffer(),at.bindRenderbuffer(36161,Ce.renderbuffer),at.renderbufferStorage(36161,Ce.format,Ce.width,Ce.height)}),at.bindRenderbuffer(36161,null)}}},gt=[];gt[6408]=4,gt[6407]=3;var wt=[];wt[5121]=1,wt[5126]=4,wt[36193]=2;var Ut=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Dt=["x","y","z","w"],Nt="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Xt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ht={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ar={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Vr={cw:2304,ccw:2305},nn=new ne(!1,!1,!1,function(){}),jr=function(at,$t){function Zt(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function ur(Bt,Ce,Me){var nt=Je.pop()||new Zt;nt.startQueryIndex=Bt,nt.endQueryIndex=Ce,nt.sum=0,nt.stats=Me,it.push(nt)}if(!$t.ext_disjoint_timer_query)return null;var wr=[],$e=[],Je=[],it=[],lt=[],Tt=[];return{beginQuery:function(Bt){var Ce=wr.pop()||$t.ext_disjoint_timer_query.createQueryEXT();$t.ext_disjoint_timer_query.beginQueryEXT(35007,Ce),$e.push(Ce),ur($e.length-1,$e.length,Bt)},endQuery:function(){$t.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:ur,update:function(){var Bt,Ce;if(Bt=$e.length,Bt!==0){Tt.length=Math.max(Tt.length,Bt+1),lt.length=Math.max(lt.length,Bt+1),lt[0]=0;var Me=Tt[0]=0;for(Ce=Bt=0;Ce<$e.length;++Ce){var nt=$e[Ce];$t.ext_disjoint_timer_query.getQueryObjectEXT(nt,34919)?(Me+=$t.ext_disjoint_timer_query.getQueryObjectEXT(nt,34918),wr.push(nt)):$e[Bt++]=nt,lt[Ce+1]=Me,Tt[Ce+1]=Bt}for($e.length=Bt,Ce=Bt=0;Ce<it.length;++Ce){var Me=it[Ce],st=Me.startQueryIndex,nt=Me.endQueryIndex;Me.sum+=lt[nt]-lt[st],st=Tt[st],nt=Tt[nt],nt===st?(Me.stats.gpuTime+=Me.sum/1e6,Je.push(Me)):(Me.startQueryIndex=st,Me.endQueryIndex=nt,it[Bt++]=Me)}it.length=Bt}},getNumPendingQueries:function(){return $e.length},clear:function(){wr.push.apply(wr,$e);for(var Bt=0;Bt<wr.length;Bt++)$t.ext_disjoint_timer_query.deleteQueryEXT(wr[Bt]);$e.length=0,wr.length=0},restore:function(){$e.length=0,wr.length=0}}};return function(at){function $t(){if(Er.length===0)Gt&&Gt.update(),cn=null;else{cn=de.next($t),Bt();for(var En=Er.length-1;0<=En;--En){var Yn=Er[En];Yn&&Yn(br,null,0)}nt.flush(),Gt&&Gt.update()}}function Zt(){!cn&&0<Er.length&&(cn=de.next($t))}function ur(){cn&&(de.cancel($t),cn=null)}function wr(En){En.preventDefault(),ur(),_r.forEach(function(Yn){Yn()})}function $e(En){nt.getError(),ct.restore(),Or.restore(),nr.restore(),Sr.restore(),tt.restore(),Lt.restore(),Pr.restore(),Gt&&Gt.restore(),Wt.procs.refresh(),Zt(),Gr.forEach(function(Yn){Yn()})}function Je(En){function Yn(An,Zn){var ua={},ea={};return Object.keys(An).forEach(function(Rn){var Xn=An[Rn];if(ce.isDynamic(Xn))ea[Rn]=ce.unbox(Xn,Rn);else{if(Zn&&Array.isArray(Xn)){for(var Ua=0;Ua<Xn.length;++Ua)if(ce.isDynamic(Xn[Ua])){ea[Rn]=ce.unbox(Xn,Rn);return}}ua[Rn]=Xn}}),{dynamic:ea,static:ua}}function Hn(An){for(;fn.length<An;)fn.push(null);return fn}var pa=Yn(En.context||{},!0),Ma=Yn(En.uniforms||{},!0),ci=Yn(En.attributes||{},!1);En=Yn(function(An){function Zn(ea){if(ea in ua){var Rn=ua[ea];delete ua[ea],Object.keys(Rn).forEach(function(Xn){ua[ea+"."+Xn]=Rn[Xn]})}}var ua=oe({},An);return delete ua.uniforms,delete ua.attributes,delete ua.context,delete ua.vao,"stencil"in ua&&ua.stencil.op&&(ua.stencil.opBack=ua.stencil.opFront=ua.stencil.op,delete ua.stencil.op),Zn("blend"),Zn("depth"),Zn("cull"),Zn("stencil"),Zn("polygonOffset"),Zn("scissor"),Zn("sample"),"vao"in An&&(ua.vao=An.vao),ua}(En),!1);var Ha={gpuTime:0,cpuTime:0,count:0},ja=Wt.compile(En,ci,Ma,pa,Ha),Wa=ja.draw,Tr=ja.batch,pn=ja.scope,fn=[];return oe(function(An,Zn){var ua;if(typeof An=="function")return pn.call(this,null,An,0);if(typeof Zn=="function")if(typeof An=="number")for(ua=0;ua<An;++ua)pn.call(this,null,Zn,ua);else if(Array.isArray(An))for(ua=0;ua<An.length;++ua)pn.call(this,An[ua],Zn,ua);else return pn.call(this,An,Zn,0);else if(typeof An=="number"){if(0<An)return Tr.call(this,Hn(An|0),An|0)}else if(Array.isArray(An)){if(An.length)return Tr.call(this,An,An.length)}else return Wa.call(this,An)},{stats:Ha,destroy:function(){ja.destroy()}})}function it(En,Yn){var Hn=0;Wt.procs.poll();var pa=Yn.color;pa&&(nt.clearColor(+pa[0]||0,+pa[1]||0,+pa[2]||0,+pa[3]||0),Hn|=16384),"depth"in Yn&&(nt.clearDepth(+Yn.depth),Hn|=256),"stencil"in Yn&&(nt.clearStencil(Yn.stencil|0),Hn|=1024),nt.clear(Hn)}function lt(En){return Er.push(En),Zt(),{cancel:function(){function Yn(){var pa=ae(Er,Yn);Er[pa]=Er[Er.length-1],--Er.length,0>=Er.length&&ur()}var Hn=ae(Er,En);Er[Hn]=Yn}}}function Tt(){var En=Ir.viewport,Yn=Ir.scissor_box;En[0]=En[1]=Yn[0]=Yn[1]=0,br.viewportWidth=br.framebufferWidth=br.drawingBufferWidth=En[2]=Yn[2]=nt.drawingBufferWidth,br.viewportHeight=br.framebufferHeight=br.drawingBufferHeight=En[3]=Yn[3]=nt.drawingBufferHeight}function Bt(){br.tick+=1,br.time=Me(),Tt(),Wt.procs.poll()}function Ce(){Sr.refresh(),Tt(),Wt.procs.refresh(),Gt&&Gt.update()}function Me(){return(ye()-rr)/1e3}if(at=c(at),!at)return null;var nt=at.gl,st=nt.getContextAttributes();nt.isContextLost();var ct=s(nt,at);if(!ct)return null;var ir=e(),At={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},dt=at.cachedCode||{},Ct=ct.extensions,Gt=jr(nt,Ct),rr=ye(),Ar=nt.drawingBufferWidth,kr=nt.drawingBufferHeight,br={tick:0,time:0,viewportWidth:Ar,viewportHeight:kr,framebufferWidth:Ar,framebufferHeight:kr,drawingBufferWidth:Ar,drawingBufferHeight:kr,pixelRatio:at.pixelRatio},Ar={elements:null,primitive:4,count:-1,offset:0,instances:-1},Wr=me(nt,Ct),nr=w(nt,At,at,function(En){return Pr.destroyBuffer(En)}),yr=_(nt,Ct,nr,At),Pr=F(nt,Ct,Wr,At,nr,yr,Ar),Or=N(nt,ir,At,at),Sr=D(nt,Ct,Wr,function(){Wt.procs.poll()},br,At,at),tt=_t(nt,Ct,Wr,At,at),Lt=R(nt,Ct,Wr,Sr,tt,At),Wt=se(nt,ir,Ct,Wr,nr,yr,Sr,Lt,{},Pr,Or,Ar,br,Gt,dt,at),ir=G(nt,Lt,Wt.procs.poll,br),Ir=Wt.next,Br=nt.canvas,Er=[],_r=[],Gr=[],wn=[at.onDestroy],cn=null;Br&&(Br.addEventListener("webglcontextlost",wr,!1),Br.addEventListener("webglcontextrestored",$e,!1));var Bn=Lt.setFBO=Je({framebuffer:ce.define.call(null,1,"framebuffer")});return Ce(),st=oe(Je,{clear:function(En){if("framebuffer"in En)if(En.framebuffer&&En.framebuffer_reglType==="framebufferCube")for(var Yn=0;6>Yn;++Yn)Bn(oe({framebuffer:En.framebuffer.faces[Yn]},En),it);else Bn(En,it);else it(null,En)},prop:ce.define.bind(null,1),context:ce.define.bind(null,2),this:ce.define.bind(null,3),draw:Je({}),buffer:function(En){return nr.create(En,34962,!1,!1)},elements:function(En){return yr.create(En,!1)},texture:Sr.create2D,cube:Sr.createCube,renderbuffer:tt.create,framebuffer:Lt.create,framebufferCube:Lt.createCube,vao:Pr.createVAO,attributes:st,frame:lt,on:function(En,Yn){var Hn;switch(En){case"frame":return lt(Yn);case"lost":Hn=_r;break;case"restore":Hn=Gr;break;case"destroy":Hn=wn}return Hn.push(Yn),{cancel:function(){for(var pa=0;pa<Hn.length;++pa)if(Hn[pa]===Yn){Hn[pa]=Hn[Hn.length-1],Hn.pop();break}}}},limits:Wr,hasExtension:function(En){return 0<=Wr.extensions.indexOf(En.toLowerCase())},read:ir,destroy:function(){Er.length=0,ur(),Br&&(Br.removeEventListener("webglcontextlost",wr),Br.removeEventListener("webglcontextrestored",$e)),Or.clear(),Lt.clear(),tt.clear(),Pr.clear(),Sr.clear(),yr.clear(),nr.clear(),Gt&&Gt.clear(),wn.forEach(function(En){En()})},_gl:nt,_refresh:Ce,poll:function(){Bt(),Gt&&Gt.update()},now:Me,stats:At,getCachedCode:function(){return dt},preloadCachedCode:function(En){Object.entries(En).forEach(function(Yn){dt[Yn[0]]=Yn[1]})}}),at.onDone(null,st),st}})},{}],285:[function(d,ee,te){var A=d("buffer"),g=A.Buffer;function S(e,a){for(var n in e)a[n]=e[n]}g.from&&g.alloc&&g.allocUnsafe&&g.allocUnsafeSlow?ee.exports=A:(S(A,te),te.Buffer=M);function M(e,a,n){return g(e,a,n)}M.prototype=Object.create(g.prototype),S(g,M),M.from=function(e,a,n){if(typeof e=="number")throw new TypeError("Argument must not be a number");return g(e,a,n)},M.alloc=function(e,a,n){if(typeof e!="number")throw new TypeError("Argument must be a number");var r=g(e);return a!==void 0?typeof n=="string"?r.fill(a,n):r.fill(a):r.fill(0),r},M.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return g(e)},M.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return A.SlowBuffer(e)}},{buffer:85}],286:[function(d,ee,te){ee.exports=S;var A=d("events").EventEmitter,g=d("inherits");g(S,A),S.Readable=d("readable-stream/lib/_stream_readable.js"),S.Writable=d("readable-stream/lib/_stream_writable.js"),S.Duplex=d("readable-stream/lib/_stream_duplex.js"),S.Transform=d("readable-stream/lib/_stream_transform.js"),S.PassThrough=d("readable-stream/lib/_stream_passthrough.js"),S.finished=d("readable-stream/lib/internal/streams/end-of-stream.js"),S.pipeline=d("readable-stream/lib/internal/streams/pipeline.js"),S.Stream=S;function S(){A.call(this)}S.prototype.pipe=function(M,e){var a=this;function n(p){M.writable&&M.write(p)===!1&&a.pause&&a.pause()}a.on("data",n);function r(){a.readable&&a.resume&&a.resume()}M.on("drain",r),!M._isStdio&&(!e||e.end!==!1)&&(a.on("end",c),a.on("close",s));var t=!1;function c(){t||(t=!0,M.end())}function s(){t||(t=!0,typeof M.destroy=="function"&&M.destroy())}function i(p){if(x(),A.listenerCount(this,"error")===0)throw p}a.on("error",i),M.on("error",i);function x(){a.removeListener("data",n),M.removeListener("drain",r),a.removeListener("end",c),a.removeListener("close",s),a.removeListener("error",i),M.removeListener("error",i),a.removeListener("end",x),a.removeListener("close",x),M.removeListener("close",x)}return a.on("end",x),a.on("close",x),M.on("close",x),M.emit("pipe",a),M}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":288,"readable-stream/lib/_stream_passthrough.js":289,"readable-stream/lib/_stream_readable.js":290,"readable-stream/lib/_stream_transform.js":291,"readable-stream/lib/_stream_writable.js":292,"readable-stream/lib/internal/streams/end-of-stream.js":296,"readable-stream/lib/internal/streams/pipeline.js":298}],287:[function(d,ee,te){function A(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t}var g={};function S(r,t,c){c||(c=Error);function s(x,p,v){return typeof t=="string"?t:t(x,p,v)}var i=function(x){A(p,x);function p(v,f,y){return x.call(this,s(v,f,y))||this}return p}(c);i.prototype.name=c.name,i.prototype.code=r,g[r]=i}function M(r,t){if(Array.isArray(r)){var c=r.length;return r=r.map(function(s){return String(s)}),c>2?"one of ".concat(t," ").concat(r.slice(0,c-1).join(", "),", or ")+r[c-1]:c===2?"one of ".concat(t," ").concat(r[0]," or ").concat(r[1]):"of ".concat(t," ").concat(r[0])}else return"of ".concat(t," ").concat(String(r))}function e(r,t,c){return r.substr(!c||c<0?0:+c,t.length)===t}function a(r,t,c){return(c===void 0||c>r.length)&&(c=r.length),r.substring(c-t.length,c)===t}function n(r,t,c){return typeof c!="number"&&(c=0),c+t.length>r.length?!1:r.indexOf(t,c)!==-1}S("ERR_INVALID_OPT_VALUE",function(r,t){return'The value "'+t+'" is invalid for option "'+r+'"'},TypeError),S("ERR_INVALID_ARG_TYPE",function(r,t,c){var s;typeof t=="string"&&e(t,"not ")?(s="must not be",t=t.replace(/^not /,"")):s="must be";var i;if(a(r," argument"))i="The ".concat(r," ").concat(s," ").concat(M(t,"type"));else{var x=n(r,".")?"property":"argument";i='The "'.concat(r,'" ').concat(x," ").concat(s," ").concat(M(t,"type"))}return i+=". Received type ".concat(typeof c),i},TypeError),S("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),S("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"}),S("ERR_STREAM_PREMATURE_CLOSE","Premature close"),S("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"}),S("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),S("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),S("ERR_STREAM_WRITE_AFTER_END","write after end"),S("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),S("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError),S("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),ee.exports.codes=g},{}],288:[function(d,ee,te){(function(A){(function(){var g=Object.keys||function(s){var i=[];for(var x in s)i.push(x);return i};ee.exports=r;var S=d("./_stream_readable"),M=d("./_stream_writable");d("inherits")(r,S);for(var e=g(M.prototype),a=0;a<e.length;a++){var n=e[a];r.prototype[n]||(r.prototype[n]=M.prototype[n])}function r(s){if(!(this instanceof r))return new r(s);S.call(this,s),M.call(this,s),this.allowHalfOpen=!0,s&&(s.readable===!1&&(this.readable=!1),s.writable===!1&&(this.writable=!1),s.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",t)))}Object.defineProperty(r.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(r.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(r.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function t(){this._writableState.ended||A.nextTick(c,this)}function c(s){s.end()}Object.defineProperty(r.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(i){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=i,this._writableState.destroyed=i)}})}).call(this)}).call(this,d("_process"))},{"./_stream_readable":290,"./_stream_writable":292,_process:278,inherits:231}],289:[function(d,ee,te){ee.exports=g;var A=d("./_stream_transform");d("inherits")(g,A);function g(S){if(!(this instanceof g))return new g(S);A.call(this,S)}g.prototype._transform=function(S,M,e){e(null,S)}},{"./_stream_transform":291,inherits:231}],290:[function(d,ee,te){(function(A,g){(function(){ee.exports=k;var S;k.ReadableState=T,d("events").EventEmitter;var M=function(ie,se){return ie.listeners(se).length},e=d("./internal/streams/stream"),a=d("buffer").Buffer,n=g.Uint8Array||function(){};function r(Q){return a.from(Q)}function t(Q){return a.isBuffer(Q)||Q instanceof n}var c=d("util"),s;c&&c.debuglog?s=c.debuglog("stream"):s=function(){};var i=d("./internal/streams/buffer_list"),x=d("./internal/streams/destroy"),p=d("./internal/streams/state"),v=p.getHighWaterMark,f=d("../errors").codes,y=f.ERR_INVALID_ARG_TYPE,o=f.ERR_STREAM_PUSH_AFTER_EOF,m=f.ERR_METHOD_NOT_IMPLEMENTED,l=f.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,w,_,h;d("inherits")(k,e);var b=x.errorOrDestroy,u=["error","close","destroy","pause","resume"];function L(Q,ie,se){if(typeof Q.prependListener=="function")return Q.prependListener(ie,se);!Q._events||!Q._events[ie]?Q.on(ie,se):Array.isArray(Q._events[ie])?Q._events[ie].unshift(se):Q._events[ie]=[se,Q._events[ie]]}function T(Q,ie,se){S=S||d("./_stream_duplex"),Q=Q||{},typeof se!="boolean"&&(se=ie instanceof S),this.objectMode=!!Q.objectMode,se&&(this.objectMode=this.objectMode||!!Q.readableObjectMode),this.highWaterMark=v(this,Q,"readableHighWaterMark",se),this.buffer=new i,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Q.emitClose!==!1,this.autoDestroy=!!Q.autoDestroy,this.destroyed=!1,this.defaultEncoding=Q.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Q.encoding&&(w||(w=d("string_decoder/").StringDecoder),this.decoder=new w(Q.encoding),this.encoding=Q.encoding)}function k(Q){if(S=S||d("./_stream_duplex"),!(this instanceof k))return new k(Q);var ie=this instanceof S;this._readableState=new T(Q,this,ie),this.readable=!0,Q&&(typeof Q.read=="function"&&(this._read=Q.read),typeof Q.destroy=="function"&&(this._destroy=Q.destroy)),e.call(this)}Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(ie){!this._readableState||(this._readableState.destroyed=ie)}}),k.prototype.destroy=x.destroy,k.prototype._undestroy=x.undestroy,k.prototype._destroy=function(Q,ie){ie(Q)},k.prototype.push=function(Q,ie){var se=this._readableState,ae;return se.objectMode?ae=!0:typeof Q=="string"&&(ie=ie||se.defaultEncoding,ie!==se.encoding&&(Q=a.from(Q,ie),ie=""),ae=!0),P(this,Q,ie,!1,ae)},k.prototype.unshift=function(Q){return P(this,Q,null,!0,!1)};function P(Q,ie,se,ae,oe){s("readableAddChunk",ie);var be=Q._readableState;if(ie===null)be.reading=!1,F(Q,be);else{var ce;if(oe||(ce=I(be,ie)),ce)b(Q,ce);else if(be.objectMode||ie&&ie.length>0)if(typeof ie!="string"&&!be.objectMode&&Object.getPrototypeOf(ie)!==a.prototype&&(ie=r(ie)),ae)be.endEmitted?b(Q,new l):z(Q,be,ie,!0);else if(be.ended)b(Q,new o);else{if(be.destroyed)return!1;be.reading=!1,be.decoder&&!se?(ie=be.decoder.write(ie),be.objectMode||ie.length!==0?z(Q,be,ie,!1):K(Q,be)):z(Q,be,ie,!1)}else ae||(be.reading=!1,K(Q,be))}return!be.ended&&(be.length<be.highWaterMark||be.length===0)}function z(Q,ie,se,ae){ie.flowing&&ie.length===0&&!ie.sync?(ie.awaitDrain=0,Q.emit("data",se)):(ie.length+=ie.objectMode?1:se.length,ae?ie.buffer.unshift(se):ie.buffer.push(se),ie.needReadable&&N(Q)),K(Q,ie)}function I(Q,ie){var se;return!t(ie)&&typeof ie!="string"&&ie!==void 0&&!Q.objectMode&&(se=new y("chunk",["string","Buffer","Uint8Array"],ie)),se}k.prototype.isPaused=function(){return this._readableState.flowing===!1},k.prototype.setEncoding=function(Q){w||(w=d("string_decoder/").StringDecoder);var ie=new w(Q);this._readableState.decoder=ie,this._readableState.encoding=this._readableState.decoder.encoding;for(var se=this._readableState.buffer.head,ae="";se!==null;)ae+=ie.write(se.data),se=se.next;return this._readableState.buffer.clear(),ae!==""&&this._readableState.buffer.push(ae),this._readableState.length=ae.length,this};var D=1073741824;function R(Q){return Q>=D?Q=D:(Q--,Q|=Q>>>1,Q|=Q>>>2,Q|=Q>>>4,Q|=Q>>>8,Q|=Q>>>16,Q++),Q}function O(Q,ie){return Q<=0||ie.length===0&&ie.ended?0:ie.objectMode?1:Q!==Q?ie.flowing&&ie.length?ie.buffer.head.data.length:ie.length:(Q>ie.highWaterMark&&(ie.highWaterMark=R(Q)),Q<=ie.length?Q:ie.ended?ie.length:(ie.needReadable=!0,0))}k.prototype.read=function(Q){s("read",Q),Q=parseInt(Q,10);var ie=this._readableState,se=Q;if(Q!==0&&(ie.emittedReadable=!1),Q===0&&ie.needReadable&&((ie.highWaterMark!==0?ie.length>=ie.highWaterMark:ie.length>0)||ie.ended))return s("read: emitReadable",ie.length,ie.ended),ie.length===0&&ie.ended?$(this):N(this),null;if(Q=O(Q,ie),Q===0&&ie.ended)return ie.length===0&&$(this),null;var ae=ie.needReadable;s("need readable",ae),(ie.length===0||ie.length-Q<ie.highWaterMark)&&(ae=!0,s("length less than watermark",ae)),ie.ended||ie.reading?(ae=!1,s("reading or ended",ae)):ae&&(s("do read"),ie.reading=!0,ie.sync=!0,ie.length===0&&(ie.needReadable=!0),this._read(ie.highWaterMark),ie.sync=!1,ie.reading||(Q=O(se,ie)));var oe;return Q>0?oe=U(Q,ie):oe=null,oe===null?(ie.needReadable=ie.length<=ie.highWaterMark,Q=0):(ie.length-=Q,ie.awaitDrain=0),ie.length===0&&(ie.ended||(ie.needReadable=!0),se!==Q&&ie.ended&&$(this)),oe!==null&&this.emit("data",oe),oe};function F(Q,ie){if(s("onEofChunk"),!ie.ended){if(ie.decoder){var se=ie.decoder.end();se&&se.length&&(ie.buffer.push(se),ie.length+=ie.objectMode?1:se.length)}ie.ended=!0,ie.sync?N(Q):(ie.needReadable=!1,ie.emittedReadable||(ie.emittedReadable=!0,G(Q)))}}function N(Q){var ie=Q._readableState;s("emitReadable",ie.needReadable,ie.emittedReadable),ie.needReadable=!1,ie.emittedReadable||(s("emitReadable",ie.flowing),ie.emittedReadable=!0,A.nextTick(G,Q))}function G(Q){var ie=Q._readableState;s("emitReadable_",ie.destroyed,ie.length,ie.ended),!ie.destroyed&&(ie.length||ie.ended)&&(Q.emit("readable"),ie.emittedReadable=!1),ie.needReadable=!ie.flowing&&!ie.ended&&ie.length<=ie.highWaterMark,V(Q)}function K(Q,ie){ie.readingMore||(ie.readingMore=!0,A.nextTick(W,Q,ie))}function W(Q,ie){for(;!ie.reading&&!ie.ended&&(ie.length<ie.highWaterMark||ie.flowing&&ie.length===0);){var se=ie.length;if(s("maybeReadMore read 0"),Q.read(0),se===ie.length)break}ie.readingMore=!1}k.prototype._read=function(Q){b(this,new m("_read()"))},k.prototype.pipe=function(Q,ie){var se=this,ae=this._readableState;switch(ae.pipesCount){case 0:ae.pipes=Q;break;case 1:ae.pipes=[ae.pipes,Q];break;default:ae.pipes.push(Q);break}ae.pipesCount+=1,s("pipe count=%d opts=%j",ae.pipesCount,ie);var oe=(!ie||ie.end!==!1)&&Q!==A.stdout&&Q!==A.stderr,be=oe?de:ke;ae.endEmitted?A.nextTick(be):se.once("end",be),Q.on("unpipe",ce);function ce(Xe,He){s("onunpipe"),Xe===se&&He&&He.hasUnpiped===!1&&(He.hasUnpiped=!0,me())}function de(){s("onend"),Q.end()}var ye=Y(se);Q.on("drain",ye);var ge=!1;function me(){s("cleanup"),Q.removeListener("close",Ne),Q.removeListener("finish",we),Q.removeListener("drain",ye),Q.removeListener("error",Pe),Q.removeListener("unpipe",ce),se.removeListener("end",de),se.removeListener("end",ke),se.removeListener("data",Ee),ge=!0,ae.awaitDrain&&(!Q._writableState||Q._writableState.needDrain)&&ye()}se.on("data",Ee);function Ee(Xe){s("ondata");var He=Q.write(Xe);s("dest.write",He),He===!1&&((ae.pipesCount===1&&ae.pipes===Q||ae.pipesCount>1&&X(ae.pipes,Q)!==-1)&&!ge&&(s("false write response, pause",ae.awaitDrain),ae.awaitDrain++),se.pause())}function Pe(Xe){s("onerror",Xe),ke(),Q.removeListener("error",Pe),M(Q,"error")===0&&b(Q,Xe)}L(Q,"error",Pe);function Ne(){Q.removeListener("finish",we),ke()}Q.once("close",Ne);function we(){s("onfinish"),Q.removeListener("close",Ne),ke()}Q.once("finish",we);function ke(){s("unpipe"),se.unpipe(Q)}return Q.emit("pipe",se),ae.flowing||(s("pipe resume"),se.resume()),Q};function Y(Q){return function(){var se=Q._readableState;s("pipeOnDrain",se.awaitDrain),se.awaitDrain&&se.awaitDrain--,se.awaitDrain===0&&M(Q,"data")&&(se.flowing=!0,V(Q))}}k.prototype.unpipe=function(Q){var ie=this._readableState,se={hasUnpiped:!1};if(ie.pipesCount===0)return this;if(ie.pipesCount===1)return Q&&Q!==ie.pipes?this:(Q||(Q=ie.pipes),ie.pipes=null,ie.pipesCount=0,ie.flowing=!1,Q&&Q.emit("unpipe",this,se),this);if(!Q){var ae=ie.pipes,oe=ie.pipesCount;ie.pipes=null,ie.pipesCount=0,ie.flowing=!1;for(var be=0;be<oe;be++)ae[be].emit("unpipe",this,{hasUnpiped:!1});return this}var ce=X(ie.pipes,Q);return ce===-1?this:(ie.pipes.splice(ce,1),ie.pipesCount-=1,ie.pipesCount===1&&(ie.pipes=ie.pipes[0]),Q.emit("unpipe",this,se),this)},k.prototype.on=function(Q,ie){var se=e.prototype.on.call(this,Q,ie),ae=this._readableState;return Q==="data"?(ae.readableListening=this.listenerCount("readable")>0,ae.flowing!==!1&&this.resume()):Q==="readable"&&!ae.endEmitted&&!ae.readableListening&&(ae.readableListening=ae.needReadable=!0,ae.flowing=!1,ae.emittedReadable=!1,s("on readable",ae.length,ae.reading),ae.length?N(this):ae.reading||A.nextTick(ue,this)),se},k.prototype.addListener=k.prototype.on,k.prototype.removeListener=function(Q,ie){var se=e.prototype.removeListener.call(this,Q,ie);return Q==="readable"&&A.nextTick(re,this),se},k.prototype.removeAllListeners=function(Q){var ie=e.prototype.removeAllListeners.apply(this,arguments);return(Q==="readable"||Q===void 0)&&A.nextTick(re,this),ie};function re(Q){var ie=Q._readableState;ie.readableListening=Q.listenerCount("readable")>0,ie.resumeScheduled&&!ie.paused?ie.flowing=!0:Q.listenerCount("data")>0&&Q.resume()}function ue(Q){s("readable nexttick read 0"),Q.read(0)}k.prototype.resume=function(){var Q=this._readableState;return Q.flowing||(s("resume"),Q.flowing=!Q.readableListening,j(this,Q)),Q.paused=!1,this};function j(Q,ie){ie.resumeScheduled||(ie.resumeScheduled=!0,A.nextTick(q,Q,ie))}function q(Q,ie){s("resume",ie.reading),ie.reading||Q.read(0),ie.resumeScheduled=!1,Q.emit("resume"),V(Q),ie.flowing&&!ie.reading&&Q.read(0)}k.prototype.pause=function(){return s("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(s("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function V(Q){var ie=Q._readableState;for(s("flow",ie.flowing);ie.flowing&&Q.read()!==null;);}k.prototype.wrap=function(Q){var ie=this,se=this._readableState,ae=!1;Q.on("end",function(){if(s("wrapped end"),se.decoder&&!se.ended){var ce=se.decoder.end();ce&&ce.length&&ie.push(ce)}ie.push(null)}),Q.on("data",function(ce){if(s("wrapped data"),se.decoder&&(ce=se.decoder.write(ce)),!(se.objectMode&&ce==null)&&!(!se.objectMode&&(!ce||!ce.length))){var de=ie.push(ce);de||(ae=!0,Q.pause())}});for(var oe in Q)this[oe]===void 0&&typeof Q[oe]=="function"&&(this[oe]=function(de){return function(){return Q[de].apply(Q,arguments)}}(oe));for(var be=0;be<u.length;be++)Q.on(u[be],this.emit.bind(this,u[be]));return this._read=function(ce){s("wrapped _read",ce),ae&&(ae=!1,Q.resume())},this},typeof Symbol=="function"&&(k.prototype[Symbol.asyncIterator]=function(){return _===void 0&&(_=d("./internal/streams/async_iterator")),_(this)}),Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(k.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(k.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(ie){this._readableState&&(this._readableState.flowing=ie)}}),k._fromList=U,Object.defineProperty(k.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function U(Q,ie){if(ie.length===0)return null;var se;return ie.objectMode?se=ie.buffer.shift():!Q||Q>=ie.length?(ie.decoder?se=ie.buffer.join(""):ie.buffer.length===1?se=ie.buffer.first():se=ie.buffer.concat(ie.length),ie.buffer.clear()):se=ie.buffer.consume(Q,ie.decoder),se}function $(Q){var ie=Q._readableState;s("endReadable",ie.endEmitted),ie.endEmitted||(ie.ended=!0,A.nextTick(ne,ie,Q))}function ne(Q,ie){if(s("endReadableNT",Q.endEmitted,Q.length),!Q.endEmitted&&Q.length===0&&(Q.endEmitted=!0,ie.readable=!1,ie.emit("end"),Q.autoDestroy)){var se=ie._writableState;(!se||se.autoDestroy&&se.finished)&&ie.destroy()}}typeof Symbol=="function"&&(k.from=function(Q,ie){return h===void 0&&(h=d("./internal/streams/from")),h(k,Q,ie)});function X(Q,ie){for(var se=0,ae=Q.length;se<ae;se++)if(Q[se]===ie)return se;return-1}}).call(this)}).call(this,d("_process"),typeof Mo<"u"?Mo:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/async_iterator":293,"./internal/streams/buffer_list":294,"./internal/streams/destroy":295,"./internal/streams/from":297,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,events:84,inherits:231,"string_decoder/":301,util:83}],291:[function(d,ee,te){ee.exports=r;var A=d("../errors").codes,g=A.ERR_METHOD_NOT_IMPLEMENTED,S=A.ERR_MULTIPLE_CALLBACK,M=A.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=A.ERR_TRANSFORM_WITH_LENGTH_0,a=d("./_stream_duplex");d("inherits")(r,a);function n(s,i){var x=this._transformState;x.transforming=!1;var p=x.writecb;if(p===null)return this.emit("error",new S);x.writechunk=null,x.writecb=null,i!=null&&this.push(i),p(s);var v=this._readableState;v.reading=!1,(v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}function r(s){if(!(this instanceof r))return new r(s);a.call(this,s),this._transformState={afterTransform:n.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,s&&(typeof s.transform=="function"&&(this._transform=s.transform),typeof s.flush=="function"&&(this._flush=s.flush)),this.on("prefinish",t)}function t(){var s=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(i,x){c(s,i,x)}):c(this,null,null)}r.prototype.push=function(s,i){return this._transformState.needTransform=!1,a.prototype.push.call(this,s,i)},r.prototype._transform=function(s,i,x){x(new g("_transform()"))},r.prototype._write=function(s,i,x){var p=this._transformState;if(p.writecb=x,p.writechunk=s,p.writeencoding=i,!p.transforming){var v=this._readableState;(p.needTransform||v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}},r.prototype._read=function(s){var i=this._transformState;i.writechunk!==null&&!i.transforming?(i.transforming=!0,this._transform(i.writechunk,i.writeencoding,i.afterTransform)):i.needTransform=!0},r.prototype._destroy=function(s,i){a.prototype._destroy.call(this,s,function(x){i(x)})};function c(s,i,x){if(i)return s.emit("error",i);if(x!=null&&s.push(x),s._writableState.length)throw new e;if(s._transformState.transforming)throw new M;return s.push(null)}},{"../errors":287,"./_stream_duplex":288,inherits:231}],292:[function(d,ee,te){(function(A,g){(function(){ee.exports=T;function S(V){var U=this;this.next=null,this.entry=null,this.finish=function(){q(U,V)}}var M;T.WritableState=u;var e={deprecate:d("util-deprecate")},a=d("./internal/streams/stream"),n=d("buffer").Buffer,r=g.Uint8Array||function(){};function t(V){return n.from(V)}function c(V){return n.isBuffer(V)||V instanceof r}var s=d("./internal/streams/destroy"),i=d("./internal/streams/state"),x=i.getHighWaterMark,p=d("../errors").codes,v=p.ERR_INVALID_ARG_TYPE,f=p.ERR_METHOD_NOT_IMPLEMENTED,y=p.ERR_MULTIPLE_CALLBACK,o=p.ERR_STREAM_CANNOT_PIPE,m=p.ERR_STREAM_DESTROYED,l=p.ERR_STREAM_NULL_VALUES,w=p.ERR_STREAM_WRITE_AFTER_END,_=p.ERR_UNKNOWN_ENCODING,h=s.errorOrDestroy;d("inherits")(T,a);function b(){}function u(V,U,$){M=M||d("./_stream_duplex"),V=V||{},typeof $!="boolean"&&($=U instanceof M),this.objectMode=!!V.objectMode,$&&(this.objectMode=this.objectMode||!!V.writableObjectMode),this.highWaterMark=x(this,V,"writableHighWaterMark",$),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var ne=V.decodeStrings===!1;this.decodeStrings=!ne,this.defaultEncoding=V.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(X){F(U,X)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=V.emitClose!==!1,this.autoDestroy=!!V.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new S(this)}u.prototype.getBuffer=function(){for(var U=this.bufferedRequest,$=[];U;)$.push(U),U=U.next;return $},function(){try{Object.defineProperty(u.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var L;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(L=Function.prototype[Symbol.hasInstance],Object.defineProperty(T,Symbol.hasInstance,{value:function(U){return L.call(this,U)?!0:this!==T?!1:U&&U._writableState instanceof u}})):L=function(U){return U instanceof this};function T(V){M=M||d("./_stream_duplex");var U=this instanceof M;if(!U&&!L.call(T,this))return new T(V);this._writableState=new u(V,this,U),this.writable=!0,V&&(typeof V.write=="function"&&(this._write=V.write),typeof V.writev=="function"&&(this._writev=V.writev),typeof V.destroy=="function"&&(this._destroy=V.destroy),typeof V.final=="function"&&(this._final=V.final)),a.call(this)}T.prototype.pipe=function(){h(this,new o)};function k(V,U){var $=new w;h(V,$),A.nextTick(U,$)}function P(V,U,$,ne){var X;return $===null?X=new l:typeof $!="string"&&!U.objectMode&&(X=new v("chunk",["string","Buffer"],$)),X?(h(V,X),A.nextTick(ne,X),!1):!0}T.prototype.write=function(V,U,$){var ne=this._writableState,X=!1,Q=!ne.objectMode&&c(V);return Q&&!n.isBuffer(V)&&(V=t(V)),typeof U=="function"&&($=U,U=null),Q?U="buffer":U||(U=ne.defaultEncoding),typeof $!="function"&&($=b),ne.ending?k(this,$):(Q||P(this,ne,V,$))&&(ne.pendingcb++,X=I(this,ne,Q,V,U,$)),X},T.prototype.cork=function(){this._writableState.corked++},T.prototype.uncork=function(){var V=this._writableState;V.corked&&(V.corked--,!V.writing&&!V.corked&&!V.bufferProcessing&&V.bufferedRequest&&K(this,V))},T.prototype.setDefaultEncoding=function(U){if(typeof U=="string"&&(U=U.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((U+"").toLowerCase())>-1))throw new _(U);return this._writableState.defaultEncoding=U,this},Object.defineProperty(T.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function z(V,U,$){return!V.objectMode&&V.decodeStrings!==!1&&typeof U=="string"&&(U=n.from(U,$)),U}Object.defineProperty(T.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function I(V,U,$,ne,X,Q){if(!$){var ie=z(U,ne,X);ne!==ie&&($=!0,X="buffer",ne=ie)}var se=U.objectMode?1:ne.length;U.length+=se;var ae=U.length<U.highWaterMark;if(ae||(U.needDrain=!0),U.writing||U.corked){var oe=U.lastBufferedRequest;U.lastBufferedRequest={chunk:ne,encoding:X,isBuf:$,callback:Q,next:null},oe?oe.next=U.lastBufferedRequest:U.bufferedRequest=U.lastBufferedRequest,U.bufferedRequestCount+=1}else D(V,U,!1,se,ne,X,Q);return ae}function D(V,U,$,ne,X,Q,ie){U.writelen=ne,U.writecb=ie,U.writing=!0,U.sync=!0,U.destroyed?U.onwrite(new m("write")):$?V._writev(X,U.onwrite):V._write(X,Q,U.onwrite),U.sync=!1}function R(V,U,$,ne,X){--U.pendingcb,$?(A.nextTick(X,ne),A.nextTick(ue,V,U),V._writableState.errorEmitted=!0,h(V,ne)):(X(ne),V._writableState.errorEmitted=!0,h(V,ne),ue(V,U))}function O(V){V.writing=!1,V.writecb=null,V.length-=V.writelen,V.writelen=0}function F(V,U){var $=V._writableState,ne=$.sync,X=$.writecb;if(typeof X!="function")throw new y;if(O($),U)R(V,$,ne,U,X);else{var Q=W($)||V.destroyed;!Q&&!$.corked&&!$.bufferProcessing&&$.bufferedRequest&&K(V,$),ne?A.nextTick(N,V,$,Q,X):N(V,$,Q,X)}}function N(V,U,$,ne){$||G(V,U),U.pendingcb--,ne(),ue(V,U)}function G(V,U){U.length===0&&U.needDrain&&(U.needDrain=!1,V.emit("drain"))}function K(V,U){U.bufferProcessing=!0;var $=U.bufferedRequest;if(V._writev&&$&&$.next){var ne=U.bufferedRequestCount,X=new Array(ne),Q=U.corkedRequestsFree;Q.entry=$;for(var ie=0,se=!0;$;)X[ie]=$,$.isBuf||(se=!1),$=$.next,ie+=1;X.allBuffers=se,D(V,U,!0,U.length,X,"",Q.finish),U.pendingcb++,U.lastBufferedRequest=null,Q.next?(U.corkedRequestsFree=Q.next,Q.next=null):U.corkedRequestsFree=new S(U),U.bufferedRequestCount=0}else{for(;$;){var ae=$.chunk,oe=$.encoding,be=$.callback,ce=U.objectMode?1:ae.length;if(D(V,U,!1,ce,ae,oe,be),$=$.next,U.bufferedRequestCount--,U.writing)break}$===null&&(U.lastBufferedRequest=null)}U.bufferedRequest=$,U.bufferProcessing=!1}T.prototype._write=function(V,U,$){$(new f("_write()"))},T.prototype._writev=null,T.prototype.end=function(V,U,$){var ne=this._writableState;return typeof V=="function"?($=V,V=null,U=null):typeof U=="function"&&($=U,U=null),V!=null&&this.write(V,U),ne.corked&&(ne.corked=1,this.uncork()),ne.ending||j(this,ne,$),this},Object.defineProperty(T.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function W(V){return V.ending&&V.length===0&&V.bufferedRequest===null&&!V.finished&&!V.writing}function Y(V,U){V._final(function($){U.pendingcb--,$&&h(V,$),U.prefinished=!0,V.emit("prefinish"),ue(V,U)})}function re(V,U){!U.prefinished&&!U.finalCalled&&(typeof V._final=="function"&&!U.destroyed?(U.pendingcb++,U.finalCalled=!0,A.nextTick(Y,V,U)):(U.prefinished=!0,V.emit("prefinish")))}function ue(V,U){var $=W(U);if($&&(re(V,U),U.pendingcb===0&&(U.finished=!0,V.emit("finish"),U.autoDestroy))){var ne=V._readableState;(!ne||ne.autoDestroy&&ne.endEmitted)&&V.destroy()}return $}function j(V,U,$){U.ending=!0,ue(V,U),$&&(U.finished?A.nextTick($):V.once("finish",$)),U.ended=!0,V.writable=!1}function q(V,U,$){var ne=V.entry;for(V.entry=null;ne;){var X=ne.callback;U.pendingcb--,X($),ne=ne.next}U.corkedRequestsFree.next=V}Object.defineProperty(T.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(U){!this._writableState||(this._writableState.destroyed=U)}}),T.prototype.destroy=s.destroy,T.prototype._undestroy=s.undestroy,T.prototype._destroy=function(V,U){U(V)}}).call(this)}).call(this,d("_process"),typeof Mo<"u"?Mo:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/destroy":295,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,inherits:231,"util-deprecate":331}],293:[function(d,ee,te){(function(A){(function(){var g;function S(m,l,w){return l in m?Object.defineProperty(m,l,{value:w,enumerable:!0,configurable:!0,writable:!0}):m[l]=w,m}var M=d("./end-of-stream"),e=Symbol("lastResolve"),a=Symbol("lastReject"),n=Symbol("error"),r=Symbol("ended"),t=Symbol("lastPromise"),c=Symbol("handlePromise"),s=Symbol("stream");function i(m,l){return{value:m,done:l}}function x(m){var l=m[e];if(l!==null){var w=m[s].read();w!==null&&(m[t]=null,m[e]=null,m[a]=null,l(i(w,!1)))}}function p(m){A.nextTick(x,m)}function v(m,l){return function(w,_){m.then(function(){if(l[r]){w(i(void 0,!0));return}l[c](w,_)},_)}}var f=Object.getPrototypeOf(function(){}),y=Object.setPrototypeOf((g={get stream(){return this[s]},next:function(){var l=this,w=this[n];if(w!==null)return Promise.reject(w);if(this[r])return Promise.resolve(i(void 0,!0));if(this[s].destroyed)return new Promise(function(u,L){A.nextTick(function(){l[n]?L(l[n]):u(i(void 0,!0))})});var _=this[t],h;if(_)h=new Promise(v(_,this));else{var b=this[s].read();if(b!==null)return Promise.resolve(i(b,!1));h=new Promise(this[c])}return this[t]=h,h}},S(g,Symbol.asyncIterator,function(){return this}),S(g,"return",function(){var l=this;return new Promise(function(w,_){l[s].destroy(null,function(h){if(h){_(h);return}w(i(void 0,!0))})})}),g),f),o=function(l){var w,_=Object.create(y,(w={},S(w,s,{value:l,writable:!0}),S(w,e,{value:null,writable:!0}),S(w,a,{value:null,writable:!0}),S(w,n,{value:null,writable:!0}),S(w,r,{value:l._readableState.endEmitted,writable:!0}),S(w,c,{value:function(b,u){var L=_[s].read();L?(_[t]=null,_[e]=null,_[a]=null,b(i(L,!1))):(_[e]=b,_[a]=u)},writable:!0}),w));return _[t]=null,M(l,function(h){if(h&&h.code!=="ERR_STREAM_PREMATURE_CLOSE"){var b=_[a];b!==null&&(_[t]=null,_[e]=null,_[a]=null,b(h)),_[n]=h;return}var u=_[e];u!==null&&(_[t]=null,_[e]=null,_[a]=null,u(i(void 0,!0))),_[r]=!0}),l.on("readable",p.bind(null,_)),_};ee.exports=o}).call(this)}).call(this,d("_process"))},{"./end-of-stream":296,_process:278}],294:[function(d,ee,te){function A(x,p){var v=Object.keys(x);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(x);p&&(f=f.filter(function(y){return Object.getOwnPropertyDescriptor(x,y).enumerable})),v.push.apply(v,f)}return v}function g(x){for(var p=1;p<arguments.length;p++){var v=arguments[p]!=null?arguments[p]:{};p%2?A(Object(v),!0).forEach(function(f){S(x,f,v[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(v)):A(Object(v)).forEach(function(f){Object.defineProperty(x,f,Object.getOwnPropertyDescriptor(v,f))})}return x}function S(x,p,v){return p in x?Object.defineProperty(x,p,{value:v,enumerable:!0,configurable:!0,writable:!0}):x[p]=v,x}function M(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function e(x,p){for(var v=0;v<p.length;v++){var f=p[v];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(x,f.key,f)}}function a(x,p,v){return p&&e(x.prototype,p),v&&e(x,v),x}var n=d("buffer"),r=n.Buffer,t=d("util"),c=t.inspect,s=c&&c.custom||"inspect";function i(x,p,v){r.prototype.copy.call(x,p,v)}ee.exports=function(){function x(){M(this,x),this.head=null,this.tail=null,this.length=0}return a(x,[{key:"push",value:function(v){var f={data:v,next:null};this.length>0?this.tail.next=f:this.head=f,this.tail=f,++this.length}},{key:"unshift",value:function(v){var f={data:v,next:this.head};this.length===0&&(this.tail=f),this.head=f,++this.length}},{key:"shift",value:function(){if(this.length!==0){var v=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,v}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(v){if(this.length===0)return"";for(var f=this.head,y=""+f.data;f=f.next;)y+=v+f.data;return y}},{key:"concat",value:function(v){if(this.length===0)return r.alloc(0);for(var f=r.allocUnsafe(v>>>0),y=this.head,o=0;y;)i(y.data,f,o),o+=y.data.length,y=y.next;return f}},{key:"consume",value:function(v,f){var y;return v<this.head.data.length?(y=this.head.data.slice(0,v),this.head.data=this.head.data.slice(v)):v===this.head.data.length?y=this.shift():y=f?this._getString(v):this._getBuffer(v),y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(v){var f=this.head,y=1,o=f.data;for(v-=o.length;f=f.next;){var m=f.data,l=v>m.length?m.length:v;if(l===m.length?o+=m:o+=m.slice(0,v),v-=l,v===0){l===m.length?(++y,f.next?this.head=f.next:this.head=this.tail=null):(this.head=f,f.data=m.slice(l));break}++y}return this.length-=y,o}},{key:"_getBuffer",value:function(v){var f=r.allocUnsafe(v),y=this.head,o=1;for(y.data.copy(f),v-=y.data.length;y=y.next;){var m=y.data,l=v>m.length?m.length:v;if(m.copy(f,f.length-v,0,l),v-=l,v===0){l===m.length?(++o,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=m.slice(l));break}++o}return this.length-=o,f}},{key:s,value:function(v,f){return c(this,g({},f,{depth:0,customInspect:!1}))}}]),x}()},{buffer:85,util:83}],295:[function(d,ee,te){(function(A){(function(){function g(r,t){var c=this,s=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return s||i?(t?t(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,A.nextTick(a,this,r)):A.nextTick(a,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(x){!t&&x?c._writableState?c._writableState.errorEmitted?A.nextTick(M,c):(c._writableState.errorEmitted=!0,A.nextTick(S,c,x)):A.nextTick(S,c,x):t?(A.nextTick(M,c),t(x)):A.nextTick(M,c)}),this)}function S(r,t){a(r,t),M(r)}function M(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function e(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function a(r,t){r.emit("error",t)}function n(r,t){var c=r._readableState,s=r._writableState;c&&c.autoDestroy||s&&s.autoDestroy?r.destroy(t):r.emit("error",t)}ee.exports={destroy:g,undestroy:e,errorOrDestroy:n}}).call(this)}).call(this,d("_process"))},{_process:278}],296:[function(d,ee,te){var A=d("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function g(a){var n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,t=new Array(r),c=0;c<r;c++)t[c]=arguments[c];a.apply(this,t)}}}function S(){}function M(a){return a.setHeader&&typeof a.abort=="function"}function e(a,n,r){if(typeof n=="function")return e(a,null,n);n||(n={}),r=g(r||S);var t=n.readable||n.readable!==!1&&a.readable,c=n.writable||n.writable!==!1&&a.writable,s=function(){a.writable||x()},i=a._writableState&&a._writableState.finished,x=function(){c=!1,i=!0,t||r.call(a)},p=a._readableState&&a._readableState.endEmitted,v=function(){t=!1,p=!0,c||r.call(a)},f=function(l){r.call(a,l)},y=function(){var l;if(t&&!p)return(!a._readableState||!a._readableState.ended)&&(l=new A),r.call(a,l);if(c&&!i)return(!a._writableState||!a._writableState.ended)&&(l=new A),r.call(a,l)},o=function(){a.req.on("finish",x)};return M(a)?(a.on("complete",x),a.on("abort",y),a.req?o():a.on("request",o)):c&&!a._writableState&&(a.on("end",s),a.on("close",s)),a.on("end",v),a.on("finish",x),n.error!==!1&&a.on("error",f),a.on("close",y),function(){a.removeListener("complete",x),a.removeListener("abort",y),a.removeListener("request",o),a.req&&a.req.removeListener("finish",x),a.removeListener("end",s),a.removeListener("close",s),a.removeListener("finish",x),a.removeListener("end",v),a.removeListener("error",f),a.removeListener("close",y)}}ee.exports=e},{"../../../errors":287}],297:[function(d,ee,te){ee.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],298:[function(d,ee,te){var A;function g(x){var p=!1;return function(){p||(p=!0,x.apply(void 0,arguments))}}var S=d("../../../errors").codes,M=S.ERR_MISSING_ARGS,e=S.ERR_STREAM_DESTROYED;function a(x){if(x)throw x}function n(x){return x.setHeader&&typeof x.abort=="function"}function r(x,p,v,f){f=g(f);var y=!1;x.on("close",function(){y=!0}),A===void 0&&(A=d("./end-of-stream")),A(x,{readable:p,writable:v},function(m){if(m)return f(m);y=!0,f()});var o=!1;return function(m){if(!y&&!o){if(o=!0,n(x))return x.abort();if(typeof x.destroy=="function")return x.destroy();f(m||new e("pipe"))}}}function t(x){x()}function c(x,p){return x.pipe(p)}function s(x){return!x.length||typeof x[x.length-1]!="function"?a:x.pop()}function i(){for(var x=arguments.length,p=new Array(x),v=0;v<x;v++)p[v]=arguments[v];var f=s(p);if(Array.isArray(p[0])&&(p=p[0]),p.length<2)throw new M("streams");var y,o=p.map(function(m,l){var w=l<p.length-1,_=l>0;return r(m,w,_,function(h){y||(y=h),h&&o.forEach(t),!w&&(o.forEach(t),f(y))})});return p.reduce(c)}ee.exports=i},{"../../../errors":287,"./end-of-stream":296}],299:[function(d,ee,te){var A=d("../../../errors").codes.ERR_INVALID_OPT_VALUE;function g(M,e,a){return M.highWaterMark!=null?M.highWaterMark:e?M[a]:null}function S(M,e,a,n){var r=g(e,n,a);if(r!=null){if(!(isFinite(r)&&Math.floor(r)===r)||r<0){var t=n?a:"highWaterMark";throw new A(t,r)}return Math.floor(r)}return M.objectMode?16:16*1024}ee.exports={getHighWaterMark:S}},{"../../../errors":287}],300:[function(d,ee,te){ee.exports=d("events").EventEmitter},{events:84}],301:[function(d,ee,te){var A=d("safe-buffer").Buffer,g=A.isEncoding||function(o){switch(o=""+o,o&&o.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function S(o){if(!o)return"utf8";for(var m;;)switch(o){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return o;default:if(m)return;o=(""+o).toLowerCase(),m=!0}}function M(o){var m=S(o);if(typeof m!="string"&&(A.isEncoding===g||!g(o)))throw new Error("Unknown encoding: "+o);return m||o}te.StringDecoder=e;function e(o){this.encoding=M(o);var m;switch(this.encoding){case"utf16le":this.text=i,this.end=x,m=4;break;case"utf8":this.fillLast=t,m=4;break;case"base64":this.text=p,this.end=v,m=3;break;default:this.write=f,this.end=y;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=A.allocUnsafe(m)}e.prototype.write=function(o){if(o.length===0)return"";var m,l;if(this.lastNeed){if(m=this.fillLast(o),m===void 0)return"";l=this.lastNeed,this.lastNeed=0}else l=0;return l<o.length?m?m+this.text(o,l):this.text(o,l):m||""},e.prototype.end=s,e.prototype.text=c,e.prototype.fillLast=function(o){if(this.lastNeed<=o.length)return o.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);o.copy(this.lastChar,this.lastTotal-this.lastNeed,0,o.length),this.lastNeed-=o.length};function a(o){return o<=127?0:o>>5===6?2:o>>4===14?3:o>>3===30?4:o>>6===2?-1:-2}function n(o,m,l){var w=m.length-1;if(w<l)return 0;var _=a(m[w]);return _>=0?(_>0&&(o.lastNeed=_-1),_):--w<l||_===-2?0:(_=a(m[w]),_>=0?(_>0&&(o.lastNeed=_-2),_):--w<l||_===-2?0:(_=a(m[w]),_>=0?(_>0&&(_===2?_=0:o.lastNeed=_-3),_):0))}function r(o,m,l){if((m[0]&192)!==128)return o.lastNeed=0,"\uFFFD";if(o.lastNeed>1&&m.length>1){if((m[1]&192)!==128)return o.lastNeed=1,"\uFFFD";if(o.lastNeed>2&&m.length>2&&(m[2]&192)!==128)return o.lastNeed=2,"\uFFFD"}}function t(o){var m=this.lastTotal-this.lastNeed,l=r(this,o);if(l!==void 0)return l;if(this.lastNeed<=o.length)return o.copy(this.lastChar,m,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);o.copy(this.lastChar,m,0,o.length),this.lastNeed-=o.length}function c(o,m){var l=n(this,o,m);if(!this.lastNeed)return o.toString("utf8",m);this.lastTotal=l;var w=o.length-(l-this.lastNeed);return o.copy(this.lastChar,0,w),o.toString("utf8",m,w)}function s(o){var m=o&&o.length?this.write(o):"";return this.lastNeed?m+"\uFFFD":m}function i(o,m){if((o.length-m)%2===0){var l=o.toString("utf16le",m);if(l){var w=l.charCodeAt(l.length-1);if(w>=55296&&w<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=o[o.length-2],this.lastChar[1]=o[o.length-1],l.slice(0,-1)}return l}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=o[o.length-1],o.toString("utf16le",m,o.length-1)}function x(o){var m=o&&o.length?this.write(o):"";if(this.lastNeed){var l=this.lastTotal-this.lastNeed;return m+this.lastChar.toString("utf16le",0,l)}return m}function p(o,m){var l=(o.length-m)%3;return l===0?o.toString("base64",m):(this.lastNeed=3-l,this.lastTotal=3,l===1?this.lastChar[0]=o[o.length-1]:(this.lastChar[0]=o[o.length-2],this.lastChar[1]=o[o.length-1]),o.toString("base64",m,o.length-l))}function v(o){var m=o&&o.length?this.write(o):"";return this.lastNeed?m+this.lastChar.toString("base64",0,3-this.lastNeed):m}function f(o){return o.toString(this.encoding)}function y(o){return o&&o.length?this.write(o):""}},{"safe-buffer":285}],302:[function(d,ee,te){(function(A,g){(function(){var S=d("assert"),M=d("debug")("stream-parser");ee.exports=t;var e=-1,a=0,n=1,r=2;function t(l){var w=l&&typeof l._transform=="function",_=l&&typeof l._write=="function";if(!w&&!_)throw new Error("must pass a Writable or Transform stream in");M("extending Parser into stream"),l._bytes=s,l._skipBytes=i,w&&(l._passthrough=x),w?l._transform=v:l._write=p}function c(l){M("initializing parser stream"),l._parserBytesLeft=0,l._parserBuffers=[],l._parserBuffered=0,l._parserState=e,l._parserCallback=null,typeof l.push=="function"&&(l._parserOutput=l.push.bind(l)),l._parserInit=!0}function s(l,w){S(!this._parserCallback,'there is already a "callback" set!'),S(isFinite(l)&&l>0,'can only buffer a finite number of bytes > 0, got "'+l+'"'),this._parserInit||c(this),M("buffering %o bytes",l),this._parserBytesLeft=l,this._parserCallback=w,this._parserState=a}function i(l,w){S(!this._parserCallback,'there is already a "callback" set!'),S(l>0,'can only skip > 0 bytes, got "'+l+'"'),this._parserInit||c(this),M("skipping %o bytes",l),this._parserBytesLeft=l,this._parserCallback=w,this._parserState=n}function x(l,w){S(!this._parserCallback,'There is already a "callback" set!'),S(l>0,'can only pass through > 0 bytes, got "'+l+'"'),this._parserInit||c(this),M("passing through %o bytes",l),this._parserBytesLeft=l,this._parserCallback=w,this._parserState=r}function p(l,w,_){this._parserInit||c(this),M("write(%o bytes)",l.length),typeof w=="function"&&(_=w),o(this,l,null,_)}function v(l,w,_){this._parserInit||c(this),M("transform(%o bytes)",l.length),typeof w!="function"&&(w=this._parserOutput),o(this,l,w,_)}function f(l,w,_,h){return l._parserBytesLeft<=0?h(new Error("got data but not currently parsing anything")):w.length<=l._parserBytesLeft?function(){return y(l,w,_,h)}:function(){var b=w.slice(0,l._parserBytesLeft);return y(l,b,_,function(u){if(u)return h(u);if(w.length>b.length)return function(){return f(l,w.slice(b.length),_,h)}})}}function y(l,w,_,h){if(l._parserBytesLeft-=w.length,M("%o bytes left for stream piece",l._parserBytesLeft),l._parserState===a?(l._parserBuffers.push(w),l._parserBuffered+=w.length):l._parserState===r&&_(w),l._parserBytesLeft===0){var b=l._parserCallback;if(b&&l._parserState===a&&l._parserBuffers.length>1&&(w=g.concat(l._parserBuffers,l._parserBuffered)),l._parserState!==a&&(w=null),l._parserCallback=null,l._parserBuffered=0,l._parserState=e,l._parserBuffers.splice(0),b){var u=[];w&&u.push(w),_&&u.push(_);var L=b.length>u.length;L&&u.push(m(h));var T=b.apply(l,u);if(!L||h===T)return h}}else return h}var o=m(f);function m(l){return function(){for(var w=l.apply(this,arguments);typeof w=="function";)w=w();return w}}}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{_process:278,assert:75,buffer:85,debug:303}],303:[function(d,ee,te){(function(A){(function(){te=ee.exports=d("./debug"),te.log=M,te.formatArgs=S,te.save=e,te.load=a,te.useColors=g,te.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:n(),te.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function g(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}te.formatters.j=function(r){try{return JSON.stringify(r)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}};function S(r){var t=this.useColors;if(r[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+r[0]+(t?"%c ":" ")+"+"+te.humanize(this.diff),!!t){var c="color: "+this.color;r.splice(1,0,c,"color: inherit");var s=0,i=0;r[0].replace(/%[a-zA-Z%]/g,function(x){x!=="%%"&&(s++,x==="%c"&&(i=s))}),r.splice(i,0,c)}}function M(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function e(r){try{r==null?te.storage.removeItem("debug"):te.storage.debug=r}catch{}}function a(){var r;try{r=te.storage.debug}catch{}return!r&&typeof A<"u"&&"env"in A&&(r=A.env.DEBUG),r}te.enable(a());function n(){try{return window.localStorage}catch{}}}).call(this)}).call(this,d("_process"))},{"./debug":304,_process:278}],304:[function(d,ee,te){te=ee.exports=S.debug=S.default=S,te.coerce=n,te.disable=e,te.enable=M,te.enabled=a,te.humanize=d("ms"),te.names=[],te.skips=[],te.formatters={};var A;function g(r){var t=0,c;for(c in r)t=(t<<5)-t+r.charCodeAt(c),t|=0;return te.colors[Math.abs(t)%te.colors.length]}function S(r){function t(){if(!!t.enabled){var c=t,s=+new Date,i=s-(A||s);c.diff=i,c.prev=A,c.curr=s,A=s;for(var x=new Array(arguments.length),p=0;p<x.length;p++)x[p]=arguments[p];x[0]=te.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");var v=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,function(y,o){if(y==="%%")return y;v++;var m=te.formatters[o];if(typeof m=="function"){var l=x[v];y=m.call(c,l),x.splice(v,1),v--}return y}),te.formatArgs.call(c,x);var f=t.log||te.log||console.log.bind(console);f.apply(c,x)}}return t.namespace=r,t.enabled=te.enabled(r),t.useColors=te.useColors(),t.color=g(r),typeof te.init=="function"&&te.init(t),t}function M(r){te.save(r),te.names=[],te.skips=[];for(var t=(typeof r=="string"?r:"").split(/[\s,]+/),c=t.length,s=0;s<c;s++)!t[s]||(r=t[s].replace(/\*/g,".*?"),r[0]==="-"?te.skips.push(new RegExp("^"+r.substr(1)+"$")):te.names.push(new RegExp("^"+r+"$")))}function e(){te.enable("")}function a(r){var t,c;for(t=0,c=te.skips.length;t<c;t++)if(te.skips[t].test(r))return!1;for(t=0,c=te.names.length;t<c;t++)if(te.names[t].test(r))return!0;return!1}function n(r){return r instanceof Error?r.stack||r.message:r}},{ms:305}],305:[function(d,ee,te){var A=1e3,g=A*60,S=g*60,M=S*24,e=M*365.25;ee.exports=function(c,s){s=s||{};var i=typeof c;if(i==="string"&&c.length>0)return a(c);if(i==="number"&&isNaN(c)===!1)return s.long?r(c):n(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))};function a(c){if(c=String(c),!(c.length>100)){var s=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(c);if(!!s){var i=parseFloat(s[1]),x=(s[2]||"ms").toLowerCase();switch(x){case"years":case"year":case"yrs":case"yr":case"y":return i*e;case"days":case"day":case"d":return i*M;case"hours":case"hour":case"hrs":case"hr":case"h":return i*S;case"minutes":case"minute":case"mins":case"min":case"m":return i*g;case"seconds":case"second":case"secs":case"sec":case"s":return i*A;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}function n(c){return c>=M?Math.round(c/M)+"d":c>=S?Math.round(c/S)+"h":c>=g?Math.round(c/g)+"m":c>=A?Math.round(c/A)+"s":c+"ms"}function r(c){return t(c,M,"day")||t(c,S,"hour")||t(c,g,"minute")||t(c,A,"second")||c+" ms"}function t(c,s,i){if(!(c<s))return c<s*1.5?Math.floor(c/s)+" "+i:Math.ceil(c/s)+" "+i+"s"}},{}],306:[function(d,ee,te){var A=d("parenthesis");ee.exports=function(S,M,e){if(S==null)throw Error("First argument should be a string");if(M==null)throw Error("Separator should be a string or a RegExp");e?(typeof e=="string"||Array.isArray(e))&&(e={ignore:e}):e={},e.escape==null&&(e.escape=!0),e.ignore==null?e.ignore=["[]","()","{}","<>",'""',"''","``","\u201C\u201D","\xAB\xBB"]:(typeof e.ignore=="string"&&(e.ignore=[e.ignore]),e.ignore=e.ignore.map(function(x){return x.length===1&&(x=x+x),x}));var a=A.parse(S,{flat:!0,brackets:e.ignore}),n=a[0],r=n.split(M);if(e.escape){for(var t=[],c=0;c<r.length;c++){var s=r[c],i=r[c+1];s[s.length-1]==="\\"&&s[s.length-2]!=="\\"?(t.push(s+M+i),c++):t.push(s)}r=t}for(var c=0;c<r.length;c++)a[0]=r[c],r[c]=A.stringify(a,{flat:!0});return r}},{parenthesis:248}],307:[function(d,ee,te){ee.exports=A;function A(g){for(var S=g.length,M=new Array(S),e=new Array(S),a=new Array(S),n=new Array(S),r=new Array(S),t=new Array(S),c=0;c<S;++c)M[c]=-1,e[c]=0,a[c]=!1,n[c]=0,r[c]=-1,t[c]=[];var s=0,i=[],x=[];function p(o){var m=[o],l=[o];for(M[o]=e[o]=s,a[o]=!0,s+=1;l.length>0;){o=l[l.length-1];var w=g[o];if(n[o]<w.length){for(var _=n[o];_<w.length;++_){var h=w[_];if(M[h]<0){M[h]=e[h]=s,a[h]=!0,s+=1,m.push(h),l.push(h);break}else a[h]&&(e[o]=Math.min(e[o],e[h])|0);r[h]>=0&&t[o].push(r[h])}n[o]=_}else{if(e[o]===M[o]){for(var b=[],u=[],L=0,_=m.length-1;_>=0;--_){var T=m[_];if(a[T]=!1,b.push(T),u.push(t[T]),L+=t[T].length,r[T]=i.length,T===o){m.length=_;break}}i.push(b);for(var k=new Array(L),_=0;_<u.length;_++)for(var P=0;P<u[_].length;P++)k[--L]=u[_][P];x.push(k)}l.pop()}}}for(var c=0;c<S;++c)M[c]<0&&p(c);for(var v,c=0;c<x.length;c++){var f=x[c];if(f.length!==0){f.sort(function(m,l){return m-l}),v=[f[0]];for(var y=1;y<f.length;y++)f[y]!==f[y-1]&&v.push(f[y]);x[c]=v}}return{components:i,adjacencyList:x}}},{}],308:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var A=function(){function r(t,c){var s=[],i=!0,x=!1,p=void 0;try{for(var v=t[Symbol.iterator](),f;!(i=(f=v.next()).done)&&(s.push(f.value),!(c&&s.length===c));i=!0);}catch(y){x=!0,p=y}finally{try{!i&&v.return&&v.return()}finally{if(x)throw p}}return s}return function(t,c){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=Math.PI*2,S=function(t,c,s,i,x,p,v){var f=t.x,y=t.y;f*=c,y*=s;var o=i*f-x*y,m=x*f+i*y;return{x:o+p,y:m+v}},M=function(t,c){var s=c===1.5707963267948966?.551915024494:c===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(c/4),i=Math.cos(t),x=Math.sin(t),p=Math.cos(t+c),v=Math.sin(t+c);return[{x:i-x*s,y:x+i*s},{x:p+v*s,y:v-p*s},{x:p,y:v}]},e=function(t,c,s,i){var x=t*i-c*s<0?-1:1,p=t*s+c*i;return p>1&&(p=1),p<-1&&(p=-1),x*Math.acos(p)},a=function(t,c,s,i,x,p,v,f,y,o,m,l){var w=Math.pow(x,2),_=Math.pow(p,2),h=Math.pow(m,2),b=Math.pow(l,2),u=w*_-w*b-_*h;u<0&&(u=0),u/=w*b+_*h,u=Math.sqrt(u)*(v===f?-1:1);var L=u*x/p*l,T=u*-p/x*m,k=o*L-y*T+(t+s)/2,P=y*L+o*T+(c+i)/2,z=(m-L)/x,I=(l-T)/p,D=(-m-L)/x,R=(-l-T)/p,O=e(1,0,z,I),F=e(z,I,D,R);return f===0&&F>0&&(F-=g),f===1&&F<0&&(F+=g),[k,P,O,F]},n=function(t){var c=t.px,s=t.py,i=t.cx,x=t.cy,p=t.rx,v=t.ry,f=t.xAxisRotation,y=f===void 0?0:f,o=t.largeArcFlag,m=o===void 0?0:o,l=t.sweepFlag,w=l===void 0?0:l,_=[];if(p===0||v===0)return[];var h=Math.sin(y*g/360),b=Math.cos(y*g/360),u=b*(c-i)/2+h*(s-x)/2,L=-h*(c-i)/2+b*(s-x)/2;if(u===0&&L===0)return[];p=Math.abs(p),v=Math.abs(v);var T=Math.pow(u,2)/Math.pow(p,2)+Math.pow(L,2)/Math.pow(v,2);T>1&&(p*=Math.sqrt(T),v*=Math.sqrt(T));var k=a(c,s,i,x,p,v,m,w,h,b,u,L),P=A(k,4),z=P[0],I=P[1],D=P[2],R=P[3],O=Math.abs(R)/(g/4);Math.abs(1-O)<1e-7&&(O=1);var F=Math.max(Math.ceil(O),1);R/=F;for(var N=0;N<F;N++)_.push(M(D,R)),D+=R;return _.map(function(G){var K=S(G[0],p,v,b,h,z,I),W=K.x,Y=K.y,re=S(G[1],p,v,b,h,z,I),ue=re.x,j=re.y,q=S(G[2],p,v,b,h,z,I),V=q.x,U=q.y;return{x1:W,y1:Y,x2:ue,y2:j,x:V,y:U}})};te.default=n,ee.exports=te.default},{}],309:[function(d,ee,te){var A=d("parse-svg-path"),g=d("abs-svg-path"),S=d("normalize-svg-path"),M=d("is-svg-path"),e=d("assert");ee.exports=a;function a(n){if(Array.isArray(n)&&n.length===1&&typeof n[0]=="string"&&(n=n[0]),typeof n=="string"&&(e(M(n),"String is not an SVG path."),n=A(n)),e(Array.isArray(n),"Argument should be a string or an array of path segments."),n=g(n),n=S(n),!n.length)return[0,0,0,0];for(var r=[1/0,1/0,-1/0,-1/0],t=0,c=n.length;t<c;t++)for(var s=n[t].slice(1),i=0;i<s.length;i+=2)s[i+0]<r[0]&&(r[0]=s[i+0]),s[i+1]<r[1]&&(r[1]=s[i+1]),s[i+0]>r[2]&&(r[2]=s[i+0]),s[i+1]>r[3]&&(r[3]=s[i+1]);return r}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":310,"parse-svg-path":250}],310:[function(d,ee,te){ee.exports=g;var A=d("svg-arc-to-cubic-bezier");function g(e){for(var a,n=[],r=0,t=0,c=0,s=0,i=null,x=null,p=0,v=0,f=0,y=e.length;f<y;f++){var o=e[f],m=o[0];switch(m){case"M":c=o[1],s=o[2];break;case"A":var l=A({px:p,py:v,cx:o[6],cy:o[7],rx:o[1],ry:o[2],xAxisRotation:o[3],largeArcFlag:o[4],sweepFlag:o[5]});if(!l.length)continue;for(var w=0,_;w<l.length;w++)_=l[w],o=["C",_.x1,_.y1,_.x2,_.y2,_.x,_.y],w<l.length-1&&n.push(o);break;case"S":var h=p,b=v;(a=="C"||a=="S")&&(h+=h-r,b+=b-t),o=["C",h,b,o[1],o[2],o[3],o[4]];break;case"T":a=="Q"||a=="T"?(i=p*2-i,x=v*2-x):(i=p,x=v),o=M(p,v,i,x,o[1],o[2]);break;case"Q":i=o[1],x=o[2],o=M(p,v,o[1],o[2],o[3],o[4]);break;case"L":o=S(p,v,o[1],o[2]);break;case"H":o=S(p,v,o[1],v);break;case"V":o=S(p,v,p,o[1]);break;case"Z":o=S(p,v,c,s);break}a=m,p=o[o.length-2],v=o[o.length-1],o.length>4?(r=o[o.length-4],t=o[o.length-3]):(r=p,t=v),n.push(o)}return n}function S(e,a,n,r){return["C",e,a,n,r,n,r]}function M(e,a,n,r,t,c){return["C",e/3+2/3*n,a/3+2/3*r,t/3+2/3*n,c/3+2/3*r,t,c]}},{"svg-arc-to-cubic-bezier":308}],311:[function(d,ee,te){var A=d("svg-path-bounds"),g=d("parse-svg-path"),S=d("draw-svg-path"),M=d("is-svg-path"),e=d("bitmap-sdf"),a=document.createElement("canvas"),n=a.getContext("2d");ee.exports=r;function r(s,i){if(!M(s))throw Error("Argument should be valid svg path string");i||(i={});var x,p;i.shape?(x=i.shape[0],p=i.shape[1]):(x=a.width=i.w||i.width||200,p=a.height=i.h||i.height||200);var v=Math.min(x,p),f=i.stroke||0,y=i.viewbox||i.viewBox||A(s),o=[x/(y[2]-y[0]),p/(y[3]-y[1])],m=Math.min(o[0]||0,o[1]||0)/2;if(n.fillStyle="black",n.fillRect(0,0,x,p),n.fillStyle="white",f&&(typeof f!="number"&&(f=1),f>0?n.strokeStyle="white":n.strokeStyle="black",n.lineWidth=Math.abs(f)),n.translate(x*.5,p*.5),n.scale(m,m),c()){var l=new Path2D(s);n.fill(l),f&&n.stroke(l)}else{var w=g(s);S(n,w),n.fill(),f&&n.stroke()}n.setTransform(1,0,0,1,0,0);var _=e(n,{cutoff:i.cutoff!=null?i.cutoff:.5,radius:i.radius!=null?i.radius:v*.5});return _}var t;function c(){if(t!=null)return t;var s=document.createElement("canvas").getContext("2d");if(s.canvas.width=s.canvas.height=1,!window.Path2D)return t=!1;var i=new Path2D("M0,0h1v1h-1v-1Z");s.fillStyle="black",s.fill(i);var x=s.getImageData(0,0,1,1);return t=x&&x.data&&x.data[3]===255}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":309}],312:[function(d,ee,te){(function(A,g){(function(){var S=d("process/browser.js").nextTick,M=Function.prototype.apply,e=Array.prototype.slice,a={},n=0;te.setTimeout=function(){return new r(M.call(setTimeout,window,arguments),clearTimeout)},te.setInterval=function(){return new r(M.call(setInterval,window,arguments),clearInterval)},te.clearTimeout=te.clearInterval=function(t){t.close()};function r(t,c){this._id=t,this._clearFn=c}r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},te.enroll=function(t,c){clearTimeout(t._idleTimeoutId),t._idleTimeout=c},te.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},te._unrefActive=te.active=function(t){clearTimeout(t._idleTimeoutId);var c=t._idleTimeout;c>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},c))},te.setImmediate=typeof A=="function"?A:function(t){var c=n++,s=arguments.length<2?!1:e.call(arguments,1);return a[c]=!0,S(function(){a[c]&&(s?t.apply(null,s):t.call(null),te.clearImmediate(c))}),c},te.clearImmediate=typeof g=="function"?g:function(t){delete a[t]}}).call(this)}).call(this,d("timers").setImmediate,d("timers").clearImmediate)},{"process/browser.js":278,timers:312}],313:[function(d,ee,te){(function(A){var g=/^\s+/,S=/\s+$/,M=0,e=A.round,a=A.min,n=A.max,r=A.random;function t(X,Q){if(X=X||"",Q=Q||{},X instanceof t)return X;if(!(this instanceof t))return new t(X,Q);var ie=c(X);this._originalInput=X,this._r=ie.r,this._g=ie.g,this._b=ie.b,this._a=ie.a,this._roundA=e(100*this._a)/100,this._format=Q.format||ie.format,this._gradientType=Q.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=ie.ok,this._tc_id=M++}t.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var X=this.toRgb();return(X.r*299+X.g*587+X.b*114)/1e3},getLuminance:function(){var X=this.toRgb(),Q,ie,se,ae,oe,be;return Q=X.r/255,ie=X.g/255,se=X.b/255,Q<=.03928?ae=Q/12.92:ae=A.pow((Q+.055)/1.055,2.4),ie<=.03928?oe=ie/12.92:oe=A.pow((ie+.055)/1.055,2.4),se<=.03928?be=se/12.92:be=A.pow((se+.055)/1.055,2.4),.2126*ae+.7152*oe+.0722*be},setAlpha:function(X){return this._a=F(X),this._roundA=e(100*this._a)/100,this},toHsv:function(){var X=p(this._r,this._g,this._b);return{h:X.h*360,s:X.s,v:X.v,a:this._a}},toHsvString:function(){var X=p(this._r,this._g,this._b),Q=e(X.h*360),ie=e(X.s*100),se=e(X.v*100);return this._a==1?"hsv("+Q+", "+ie+"%, "+se+"%)":"hsva("+Q+", "+ie+"%, "+se+"%, "+this._roundA+")"},toHsl:function(){var X=i(this._r,this._g,this._b);return{h:X.h*360,s:X.s,l:X.l,a:this._a}},toHslString:function(){var X=i(this._r,this._g,this._b),Q=e(X.h*360),ie=e(X.s*100),se=e(X.l*100);return this._a==1?"hsl("+Q+", "+ie+"%, "+se+"%)":"hsla("+Q+", "+ie+"%, "+se+"%, "+this._roundA+")"},toHex:function(X){return f(this._r,this._g,this._b,X)},toHexString:function(X){return"#"+this.toHex(X)},toHex8:function(X){return y(this._r,this._g,this._b,this._a,X)},toHex8String:function(X){return"#"+this.toHex8(X)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(N(this._r,255)*100)+"%",g:e(N(this._g,255)*100)+"%",b:e(N(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(N(this._r,255)*100)+"%, "+e(N(this._g,255)*100)+"%, "+e(N(this._b,255)*100)+"%)":"rgba("+e(N(this._r,255)*100)+"%, "+e(N(this._g,255)*100)+"%, "+e(N(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:R[f(this._r,this._g,this._b,!0)]||!1},toFilter:function(X){var Q="#"+o(this._r,this._g,this._b,this._a),ie=Q,se=this._gradientType?"GradientType = 1, ":"";if(X){var ae=t(X);ie="#"+o(ae._r,ae._g,ae._b,ae._a)}return"progid:DXImageTransform.Microsoft.gradient("+se+"startColorstr="+Q+",endColorstr="+ie+")"},toString:function(X){var Q=!!X;X=X||this._format;var ie=!1,se=this._a<1&&this._a>=0,ae=!Q&&se&&(X==="hex"||X==="hex6"||X==="hex3"||X==="hex4"||X==="hex8"||X==="name");return ae?X==="name"&&this._a===0?this.toName():this.toRgbString():(X==="rgb"&&(ie=this.toRgbString()),X==="prgb"&&(ie=this.toPercentageRgbString()),(X==="hex"||X==="hex6")&&(ie=this.toHexString()),X==="hex3"&&(ie=this.toHexString(!0)),X==="hex4"&&(ie=this.toHex8String(!0)),X==="hex8"&&(ie=this.toHex8String()),X==="name"&&(ie=this.toName()),X==="hsl"&&(ie=this.toHslString()),X==="hsv"&&(ie=this.toHsvString()),ie||this.toHexString())},clone:function(){return t(this.toString())},_applyModification:function(X,Q){var ie=X.apply(null,[this].concat([].slice.call(Q)));return this._r=ie._r,this._g=ie._g,this._b=ie._b,this.setAlpha(ie._a),this},lighten:function(){return this._applyModification(_,arguments)},brighten:function(){return this._applyModification(h,arguments)},darken:function(){return this._applyModification(b,arguments)},desaturate:function(){return this._applyModification(m,arguments)},saturate:function(){return this._applyModification(l,arguments)},greyscale:function(){return this._applyModification(w,arguments)},spin:function(){return this._applyModification(u,arguments)},_applyCombination:function(X,Q){return X.apply(null,[this].concat([].slice.call(Q)))},analogous:function(){return this._applyCombination(z,arguments)},complement:function(){return this._applyCombination(L,arguments)},monochromatic:function(){return this._applyCombination(I,arguments)},splitcomplement:function(){return this._applyCombination(P,arguments)},triad:function(){return this._applyCombination(T,arguments)},tetrad:function(){return this._applyCombination(k,arguments)}},t.fromRatio=function(X,Q){if(typeof X=="object"){var ie={};for(var se in X)X.hasOwnProperty(se)&&(se==="a"?ie[se]=X[se]:ie[se]=ue(X[se]));X=ie}return t(X,Q)};function c(X){var Q={r:0,g:0,b:0},ie=1,se=null,ae=null,oe=null,be=!1,ce=!1;return typeof X=="string"&&(X=$(X)),typeof X=="object"&&(U(X.r)&&U(X.g)&&U(X.b)?(Q=s(X.r,X.g,X.b),be=!0,ce=String(X.r).substr(-1)==="%"?"prgb":"rgb"):U(X.h)&&U(X.s)&&U(X.v)?(se=ue(X.s),ae=ue(X.v),Q=v(X.h,se,ae),be=!0,ce="hsv"):U(X.h)&&U(X.s)&&U(X.l)&&(se=ue(X.s),oe=ue(X.l),Q=x(X.h,se,oe),be=!0,ce="hsl"),X.hasOwnProperty("a")&&(ie=X.a)),ie=F(ie),{ok:be,format:X.format||ce,r:a(255,n(Q.r,0)),g:a(255,n(Q.g,0)),b:a(255,n(Q.b,0)),a:ie}}function s(X,Q,ie){return{r:N(X,255)*255,g:N(Q,255)*255,b:N(ie,255)*255}}function i(X,Q,ie){X=N(X,255),Q=N(Q,255),ie=N(ie,255);var se=n(X,Q,ie),ae=a(X,Q,ie),oe,be,ce=(se+ae)/2;if(se==ae)oe=be=0;else{var de=se-ae;switch(be=ce>.5?de/(2-se-ae):de/(se+ae),se){case X:oe=(Q-ie)/de+(Q<ie?6:0);break;case Q:oe=(ie-X)/de+2;break;case ie:oe=(X-Q)/de+4;break}oe/=6}return{h:oe,s:be,l:ce}}function x(X,Q,ie){var se,ae,oe;X=N(X,360),Q=N(Q,100),ie=N(ie,100);function be(ye,ge,me){return me<0&&(me+=1),me>1&&(me-=1),me<1/6?ye+(ge-ye)*6*me:me<1/2?ge:me<2/3?ye+(ge-ye)*(2/3-me)*6:ye}if(Q===0)se=ae=oe=ie;else{var ce=ie<.5?ie*(1+Q):ie+Q-ie*Q,de=2*ie-ce;se=be(de,ce,X+1/3),ae=be(de,ce,X),oe=be(de,ce,X-1/3)}return{r:se*255,g:ae*255,b:oe*255}}function p(X,Q,ie){X=N(X,255),Q=N(Q,255),ie=N(ie,255);var se=n(X,Q,ie),ae=a(X,Q,ie),oe,be,ce=se,de=se-ae;if(be=se===0?0:de/se,se==ae)oe=0;else{switch(se){case X:oe=(Q-ie)/de+(Q<ie?6:0);break;case Q:oe=(ie-X)/de+2;break;case ie:oe=(X-Q)/de+4;break}oe/=6}return{h:oe,s:be,v:ce}}function v(X,Q,ie){X=N(X,360)*6,Q=N(Q,100),ie=N(ie,100);var se=A.floor(X),ae=X-se,oe=ie*(1-Q),be=ie*(1-ae*Q),ce=ie*(1-(1-ae)*Q),de=se%6,ye=[ie,be,oe,oe,ce,ie][de],ge=[ce,ie,ie,be,oe,oe][de],me=[oe,oe,ce,ie,ie,be][de];return{r:ye*255,g:ge*255,b:me*255}}function f(X,Q,ie,se){var ae=[re(e(X).toString(16)),re(e(Q).toString(16)),re(e(ie).toString(16))];return se&&ae[0].charAt(0)==ae[0].charAt(1)&&ae[1].charAt(0)==ae[1].charAt(1)&&ae[2].charAt(0)==ae[2].charAt(1)?ae[0].charAt(0)+ae[1].charAt(0)+ae[2].charAt(0):ae.join("")}function y(X,Q,ie,se,ae){var oe=[re(e(X).toString(16)),re(e(Q).toString(16)),re(e(ie).toString(16)),re(j(se))];return ae&&oe[0].charAt(0)==oe[0].charAt(1)&&oe[1].charAt(0)==oe[1].charAt(1)&&oe[2].charAt(0)==oe[2].charAt(1)&&oe[3].charAt(0)==oe[3].charAt(1)?oe[0].charAt(0)+oe[1].charAt(0)+oe[2].charAt(0)+oe[3].charAt(0):oe.join("")}function o(X,Q,ie,se){var ae=[re(j(se)),re(e(X).toString(16)),re(e(Q).toString(16)),re(e(ie).toString(16))];return ae.join("")}t.equals=function(X,Q){return!X||!Q?!1:t(X).toRgbString()==t(Q).toRgbString()},t.random=function(){return t.fromRatio({r:r(),g:r(),b:r()})};function m(X,Q){Q=Q===0?0:Q||10;var ie=t(X).toHsl();return ie.s-=Q/100,ie.s=G(ie.s),t(ie)}function l(X,Q){Q=Q===0?0:Q||10;var ie=t(X).toHsl();return ie.s+=Q/100,ie.s=G(ie.s),t(ie)}function w(X){return t(X).desaturate(100)}function _(X,Q){Q=Q===0?0:Q||10;var ie=t(X).toHsl();return ie.l+=Q/100,ie.l=G(ie.l),t(ie)}function h(X,Q){Q=Q===0?0:Q||10;var ie=t(X).toRgb();return ie.r=n(0,a(255,ie.r-e(255*-(Q/100)))),ie.g=n(0,a(255,ie.g-e(255*-(Q/100)))),ie.b=n(0,a(255,ie.b-e(255*-(Q/100)))),t(ie)}function b(X,Q){Q=Q===0?0:Q||10;var ie=t(X).toHsl();return ie.l-=Q/100,ie.l=G(ie.l),t(ie)}function u(X,Q){var ie=t(X).toHsl(),se=(ie.h+Q)%360;return ie.h=se<0?360+se:se,t(ie)}function L(X){var Q=t(X).toHsl();return Q.h=(Q.h+180)%360,t(Q)}function T(X){var Q=t(X).toHsl(),ie=Q.h;return[t(X),t({h:(ie+120)%360,s:Q.s,l:Q.l}),t({h:(ie+240)%360,s:Q.s,l:Q.l})]}function k(X){var Q=t(X).toHsl(),ie=Q.h;return[t(X),t({h:(ie+90)%360,s:Q.s,l:Q.l}),t({h:(ie+180)%360,s:Q.s,l:Q.l}),t({h:(ie+270)%360,s:Q.s,l:Q.l})]}function P(X){var Q=t(X).toHsl(),ie=Q.h;return[t(X),t({h:(ie+72)%360,s:Q.s,l:Q.l}),t({h:(ie+216)%360,s:Q.s,l:Q.l})]}function z(X,Q,ie){Q=Q||6,ie=ie||30;var se=t(X).toHsl(),ae=360/ie,oe=[t(X)];for(se.h=(se.h-(ae*Q>>1)+720)%360;--Q;)se.h=(se.h+ae)%360,oe.push(t(se));return oe}function I(X,Q){Q=Q||6;for(var ie=t(X).toHsv(),se=ie.h,ae=ie.s,oe=ie.v,be=[],ce=1/Q;Q--;)be.push(t({h:se,s:ae,v:oe})),oe=(oe+ce)%1;return be}t.mix=function(X,Q,ie){ie=ie===0?0:ie||50;var se=t(X).toRgb(),ae=t(Q).toRgb(),oe=ie/100,be={r:(ae.r-se.r)*oe+se.r,g:(ae.g-se.g)*oe+se.g,b:(ae.b-se.b)*oe+se.b,a:(ae.a-se.a)*oe+se.a};return t(be)},t.readability=function(X,Q){var ie=t(X),se=t(Q);return(A.max(ie.getLuminance(),se.getLuminance())+.05)/(A.min(ie.getLuminance(),se.getLuminance())+.05)},t.isReadable=function(X,Q,ie){var se=t.readability(X,Q),ae,oe;switch(oe=!1,ae=ne(ie),ae.level+ae.size){case"AAsmall":case"AAAlarge":oe=se>=4.5;break;case"AAlarge":oe=se>=3;break;case"AAAsmall":oe=se>=7;break}return oe},t.mostReadable=function(X,Q,ie){var se=null,ae=0,oe,be,ce,de;ie=ie||{},be=ie.includeFallbackColors,ce=ie.level,de=ie.size;for(var ye=0;ye<Q.length;ye++)oe=t.readability(X,Q[ye]),oe>ae&&(ae=oe,se=t(Q[ye]));return t.isReadable(X,se,{level:ce,size:de})||!be?se:(ie.includeFallbackColors=!1,t.mostReadable(X,["#fff","#000"],ie))};var D=t.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},R=t.hexNames=O(D);function O(X){var Q={};for(var ie in X)X.hasOwnProperty(ie)&&(Q[X[ie]]=ie);return Q}function F(X){return X=parseFloat(X),(isNaN(X)||X<0||X>1)&&(X=1),X}function N(X,Q){W(X)&&(X="100%");var ie=Y(X);return X=a(Q,n(0,parseFloat(X))),ie&&(X=parseInt(X*Q,10)/100),A.abs(X-Q)<1e-6?1:X%Q/parseFloat(Q)}function G(X){return a(1,n(0,X))}function K(X){return parseInt(X,16)}function W(X){return typeof X=="string"&&X.indexOf(".")!=-1&&parseFloat(X)===1}function Y(X){return typeof X=="string"&&X.indexOf("%")!=-1}function re(X){return X.length==1?"0"+X:""+X}function ue(X){return X<=1&&(X=X*100+"%"),X}function j(X){return A.round(parseFloat(X)*255).toString(16)}function q(X){return K(X)/255}var V=function(){var X="[-\\+]?\\d+%?",Q="[-\\+]?\\d*\\.\\d+%?",ie="(?:"+Q+")|(?:"+X+")",se="[\\s|\\(]+("+ie+")[,|\\s]+("+ie+")[,|\\s]+("+ie+")\\s*\\)?",ae="[\\s|\\(]+("+ie+")[,|\\s]+("+ie+")[,|\\s]+("+ie+")[,|\\s]+("+ie+")\\s*\\)?";return{CSS_UNIT:new RegExp(ie),rgb:new RegExp("rgb"+se),rgba:new RegExp("rgba"+ae),hsl:new RegExp("hsl"+se),hsla:new RegExp("hsla"+ae),hsv:new RegExp("hsv"+se),hsva:new RegExp("hsva"+ae),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function U(X){return!!V.CSS_UNIT.exec(X)}function $(X){X=X.replace(g,"").replace(S,"").toLowerCase();var Q=!1;if(D[X])X=D[X],Q=!0;else if(X=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var ie;return(ie=V.rgb.exec(X))?{r:ie[1],g:ie[2],b:ie[3]}:(ie=V.rgba.exec(X))?{r:ie[1],g:ie[2],b:ie[3],a:ie[4]}:(ie=V.hsl.exec(X))?{h:ie[1],s:ie[2],l:ie[3]}:(ie=V.hsla.exec(X))?{h:ie[1],s:ie[2],l:ie[3],a:ie[4]}:(ie=V.hsv.exec(X))?{h:ie[1],s:ie[2],v:ie[3]}:(ie=V.hsva.exec(X))?{h:ie[1],s:ie[2],v:ie[3],a:ie[4]}:(ie=V.hex8.exec(X))?{r:K(ie[1]),g:K(ie[2]),b:K(ie[3]),a:q(ie[4]),format:Q?"name":"hex8"}:(ie=V.hex6.exec(X))?{r:K(ie[1]),g:K(ie[2]),b:K(ie[3]),format:Q?"name":"hex"}:(ie=V.hex4.exec(X))?{r:K(ie[1]+""+ie[1]),g:K(ie[2]+""+ie[2]),b:K(ie[3]+""+ie[3]),a:q(ie[4]+""+ie[4]),format:Q?"name":"hex8"}:(ie=V.hex3.exec(X))?{r:K(ie[1]+""+ie[1]),g:K(ie[2]+""+ie[2]),b:K(ie[3]+""+ie[3]),format:Q?"name":"hex"}:!1}function ne(X){var Q,ie;return X=X||{level:"AA",size:"small"},Q=(X.level||"AA").toUpperCase(),ie=(X.size||"small").toLowerCase(),Q!=="AA"&&Q!=="AAA"&&(Q="AA"),ie!=="small"&&ie!=="large"&&(ie="small"),{level:Q,size:ie}}typeof ee<"u"&&ee.exports?ee.exports=t:window.tinycolor=t})(Math)},{}],314:[function(d,ee,te){ee.exports=S,ee.exports.float32=ee.exports.float=S,ee.exports.fract32=ee.exports.fract=g;var A=new Float32Array(1);function g(M,e){if(M.length){if(M instanceof Float32Array)return new Float32Array(M.length);e instanceof Float32Array||(e=S(M));for(var a=0,n=e.length;a<n;a++)e[a]=M[a]-e[a];return e}return S(M-S(M))}function S(M){return M.length?M instanceof Float32Array?M:new Float32Array(M):(A[0]=M,A[0])}},{}],315:[function(d,ee,te){var A=d("parse-unit");ee.exports=e;var g=96;function S(a,n){var r=A(getComputedStyle(a).getPropertyValue(n));return r[0]*e(r[1],a)}function M(a,n){var r=document.createElement("div");r.style["font-size"]="128"+a,n.appendChild(r);var t=S(r,"font-size")/128;return n.removeChild(r),t}function e(a,n){switch(n=n||document.body,a=(a||"px").trim().toLowerCase(),(n===window||n===document)&&(n=document.body),a){case"%":return n.clientHeight/100;case"ch":case"ex":return M(a,n);case"em":return S(n,"font-size");case"rem":return S(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return g;case"cm":return g/2.54;case"mm":return g/25.4;case"pt":return g/72;case"pc":return g/6}return 1}},{"parse-unit":251}],316:[function(d,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.topojson=A.topojson||{}))})(this,function(A){function g(l){return l}function S(l){if(l==null)return g;var w,_,h=l.scale[0],b=l.scale[1],u=l.translate[0],L=l.translate[1];return function(T,k){k||(w=_=0);var P=2,z=T.length,I=new Array(z);for(I[0]=(w+=T[0])*h+u,I[1]=(_+=T[1])*b+L;P<z;)I[P]=T[P],++P;return I}}function M(l){var w=S(l.transform),_,h=1/0,b=h,u=-h,L=-h;function T(P){P=w(P),P[0]<h&&(h=P[0]),P[0]>u&&(u=P[0]),P[1]<b&&(b=P[1]),P[1]>L&&(L=P[1])}function k(P){switch(P.type){case"GeometryCollection":P.geometries.forEach(k);break;case"Point":T(P.coordinates);break;case"MultiPoint":P.coordinates.forEach(T);break}}l.arcs.forEach(function(P){for(var z=-1,I=P.length,D;++z<I;)D=w(P[z],z),D[0]<h&&(h=D[0]),D[0]>u&&(u=D[0]),D[1]<b&&(b=D[1]),D[1]>L&&(L=D[1])});for(_ in l.objects)k(l.objects[_]);return[h,b,u,L]}function e(l,w){for(var _,h=l.length,b=h-w;b<--h;)_=l[b],l[b++]=l[h],l[h]=_}function a(l,w){return typeof w=="string"&&(w=l.objects[w]),w.type==="GeometryCollection"?{type:"FeatureCollection",features:w.geometries.map(function(_){return n(l,_)})}:n(l,w)}function n(l,w){var _=w.id,h=w.bbox,b=w.properties==null?{}:w.properties,u=r(l,w);return _==null&&h==null?{type:"Feature",properties:b,geometry:u}:h==null?{type:"Feature",id:_,properties:b,geometry:u}:{type:"Feature",id:_,bbox:h,properties:b,geometry:u}}function r(l,w){var _=S(l.transform),h=l.arcs;function b(z,I){I.length&&I.pop();for(var D=h[z<0?~z:z],R=0,O=D.length;R<O;++R)I.push(_(D[R],R));z<0&&e(I,O)}function u(z){return _(z)}function L(z){for(var I=[],D=0,R=z.length;D<R;++D)b(z[D],I);return I.length<2&&I.push(I[0]),I}function T(z){for(var I=L(z);I.length<4;)I.push(I[0]);return I}function k(z){return z.map(T)}function P(z){var I=z.type,D;switch(I){case"GeometryCollection":return{type:I,geometries:z.geometries.map(P)};case"Point":D=u(z.coordinates);break;case"MultiPoint":D=z.coordinates.map(u);break;case"LineString":D=L(z.arcs);break;case"MultiLineString":D=z.arcs.map(L);break;case"Polygon":D=k(z.arcs);break;case"MultiPolygon":D=z.arcs.map(k);break;default:return null}return{type:I,coordinates:D}}return P(w)}function t(l,w){var _={},h={},b={},u=[],L=-1;w.forEach(function(P,z){var I=l.arcs[P<0?~P:P],D;I.length<3&&!I[1][0]&&!I[1][1]&&(D=w[++L],w[L]=P,w[z]=D)}),w.forEach(function(P){var z=T(P),I=z[0],D=z[1],R,O;if(R=b[I])if(delete b[R.end],R.push(P),R.end=D,O=h[D]){delete h[O.start];var F=O===R?R:R.concat(O);h[F.start=R.start]=b[F.end=O.end]=F}else h[R.start]=b[R.end]=R;else if(R=h[D])if(delete h[R.start],R.unshift(P),R.start=I,O=b[I]){delete b[O.end];var N=O===R?R:O.concat(R);h[N.start=O.start]=b[N.end=R.end]=N}else h[R.start]=b[R.end]=R;else R=[P],h[R.start=I]=b[R.end=D]=R});function T(P){var z=l.arcs[P<0?~P:P],I=z[0],D;return l.transform?(D=[0,0],z.forEach(function(R){D[0]+=R[0],D[1]+=R[1]})):D=z[z.length-1],P<0?[D,I]:[I,D]}function k(P,z){for(var I in P){var D=P[I];delete z[D.start],delete D.start,delete D.end,D.forEach(function(R){_[R<0?~R:R]=1}),u.push(D)}}return k(b,h),k(h,b),w.forEach(function(P){_[P<0?~P:P]||u.push([P])}),u}function c(l){return r(l,s.apply(this,arguments))}function s(l,w,_){var h,b,u;if(arguments.length>1)h=i(l,w,_);else for(b=0,h=new Array(u=l.arcs.length);b<u;++b)h[b]=b;return{type:"MultiLineString",arcs:t(l,h)}}function i(l,w,_){var h=[],b=[],u;function L(I){var D=I<0?~I:I;(b[D]||(b[D]=[])).push({i:I,g:u})}function T(I){I.forEach(L)}function k(I){I.forEach(T)}function P(I){I.forEach(k)}function z(I){switch(u=I,I.type){case"GeometryCollection":I.geometries.forEach(z);break;case"LineString":T(I.arcs);break;case"MultiLineString":case"Polygon":k(I.arcs);break;case"MultiPolygon":P(I.arcs);break}}return z(w),b.forEach(_==null?function(I){h.push(I[0].i)}:function(I){_(I[0].g,I[I.length-1].g)&&h.push(I[0].i)}),h}function x(l){for(var w=-1,_=l.length,h,b=l[_-1],u=0;++w<_;)h=b,b=l[w],u+=h[0]*b[1]-h[1]*b[0];return Math.abs(u)}function p(l){return r(l,v.apply(this,arguments))}function v(l,w){var _={},h=[],b=[];w.forEach(u);function u(k){switch(k.type){case"GeometryCollection":k.geometries.forEach(u);break;case"Polygon":L(k.arcs);break;case"MultiPolygon":k.arcs.forEach(L);break}}function L(k){k.forEach(function(P){P.forEach(function(z){(_[z=z<0?~z:z]||(_[z]=[])).push(k)})}),h.push(k)}function T(k){return x(r(l,{type:"Polygon",arcs:[k]}).coordinates[0])}return h.forEach(function(k){if(!k._){var P=[],z=[k];for(k._=1,b.push(P);k=z.pop();)P.push(k),k.forEach(function(I){I.forEach(function(D){_[D<0?~D:D].forEach(function(R){R._||(R._=1,z.push(R))})})})}}),h.forEach(function(k){delete k._}),{type:"MultiPolygon",arcs:b.map(function(k){var P=[],z;if(k.forEach(function(F){F.forEach(function(N){N.forEach(function(G){_[G<0?~G:G].length<2&&P.push(G)})})}),P=t(l,P),(z=P.length)>1)for(var I=1,D=T(P[0]),R,O;I<z;++I)(R=T(P[I]))>D&&(O=P[0],P[0]=P[I],P[I]=O,D=R);return P}).filter(function(k){return k.length>0})}}function f(l,w){for(var _=0,h=l.length;_<h;){var b=_+h>>>1;l[b]<w?_=b+1:h=b}return _}function y(l){var w={},_=l.map(function(){return[]});function h(F,N){F.forEach(function(G){G<0&&(G=~G);var K=w[G];K?K.push(N):w[G]=[N]})}function b(F,N){F.forEach(function(G){h(G,N)})}function u(F,N){F.type==="GeometryCollection"?F.geometries.forEach(function(G){u(G,N)}):F.type in L&&L[F.type](F.arcs,N)}var L={LineString:h,MultiLineString:b,Polygon:b,MultiPolygon:function(F,N){F.forEach(function(G){b(G,N)})}};l.forEach(u);for(var T in w)for(var k=w[T],P=k.length,z=0;z<P;++z)for(var I=z+1;I<P;++I){var D=k[z],R=k[I],O;(O=_[D])[T=f(O,R)]!==R&&O.splice(T,0,R),(O=_[R])[T=f(O,D)]!==D&&O.splice(T,0,D)}return _}function o(l){if(l==null)return g;var w,_,h=l.scale[0],b=l.scale[1],u=l.translate[0],L=l.translate[1];return function(T,k){k||(w=_=0);var P=2,z=T.length,I=new Array(z),D=Math.round((T[0]-u)/h),R=Math.round((T[1]-L)/b);for(I[0]=D-w,w=D,I[1]=R-_,_=R;P<z;)I[P]=T[P],++P;return I}}function m(l,w){if(l.transform)throw new Error("already quantized");if(!w||!w.scale){if(!((L=Math.floor(w))>=2))throw new Error("n must be \u22652");k=l.bbox||M(l);var _=k[0],h=k[1],b=k[2],u=k[3],L;w={scale:[b-_?(b-_)/(L-1):1,u-h?(u-h)/(L-1):1],translate:[_,h]}}else k=l.bbox;var T=o(w),k,P,z=l.objects,I={};function D(F){return T(F)}function R(F){var N;switch(F.type){case"GeometryCollection":N={type:"GeometryCollection",geometries:F.geometries.map(R)};break;case"Point":N={type:"Point",coordinates:D(F.coordinates)};break;case"MultiPoint":N={type:"MultiPoint",coordinates:F.coordinates.map(D)};break;default:return F}return F.id!=null&&(N.id=F.id),F.bbox!=null&&(N.bbox=F.bbox),F.properties!=null&&(N.properties=F.properties),N}function O(F){var N=0,G=1,K=F.length,W,Y=new Array(K);for(Y[0]=T(F[0],0);++N<K;)((W=T(F[N],N))[0]||W[1])&&(Y[G++]=W);return G===1&&(Y[G++]=[0,0]),Y.length=G,Y}for(P in z)I[P]=R(z[P]);return{type:"Topology",bbox:k,transform:w,objects:I,arcs:l.arcs.map(O)}}A.bbox=M,A.feature=a,A.merge=p,A.mergeArcs=v,A.mesh=c,A.meshArcs=s,A.neighbors=y,A.quantize=m,A.transform=S,A.untransform=o,Object.defineProperty(A,"__esModule",{value:!0})})},{}],317:[function(d,ee,te){var A=d("../prototype/is");ee.exports=function(g){if(typeof g!="function"||!hasOwnProperty.call(g,"length"))return!1;try{if(typeof g.length!="number"||typeof g.call!="function"||typeof g.apply!="function")return!1}catch{return!1}return!A(g)}},{"../prototype/is":324}],318:[function(d,ee,te){var A=d("../value/is"),g=d("../object/is"),S=d("../string/coerce"),M=d("./to-short-string"),e=function(a,n){return a.replace("%v",M(n))};ee.exports=function(a,n,r){if(!g(r))throw new TypeError(e(n,a));if(!A(a)){if("default"in r)return r.default;if(r.isOptional)return null}var t=S(r.errorMessage);throw A(t)||(t=n),new TypeError(e(t,a))}},{"../object/is":321,"../string/coerce":325,"../value/is":327,"./to-short-string":320}],319:[function(d,ee,te){ee.exports=function(A){try{return A.toString()}catch{try{return String(A)}catch{return null}}}},{}],320:[function(d,ee,te){var A=d("./safe-to-string"),g=/[\n\r\u2028\u2029]/g;ee.exports=function(S){var M=A(S);return M===null?"<Non-coercible to string value>":(M.length>100&&(M=M.slice(0,99)+"\u2026"),M=M.replace(g,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}),M)}},{"./safe-to-string":319}],321:[function(d,ee,te){var A=d("../value/is"),g={object:!0,function:!0,undefined:!0};ee.exports=function(S){return A(S)?hasOwnProperty.call(g,typeof S):!1}},{"../value/is":327}],322:[function(d,ee,te){var A=d("../lib/resolve-exception"),g=d("./is");ee.exports=function(S){return g(S)?S:A(S,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":318,"./is":323}],323:[function(d,ee,te){var A=d("../function/is"),g=/^\s*class[\s{/}]/,S=Function.prototype.toString;ee.exports=function(M){return!(!A(M)||g.test(S.call(M)))}},{"../function/is":317}],324:[function(d,ee,te){var A=d("../object/is");ee.exports=function(g){if(!A(g))return!1;try{return g.constructor?g.constructor.prototype===g:!1}catch{return!1}}},{"../object/is":321}],325:[function(d,ee,te){var A=d("../value/is"),g=d("../object/is"),S=Object.prototype.toString;ee.exports=function(M){if(!A(M))return null;if(g(M)){var e=M.toString;if(typeof e!="function"||e===S)return null}try{return""+M}catch{return null}}},{"../object/is":321,"../value/is":327}],326:[function(d,ee,te){var A=d("../lib/resolve-exception"),g=d("./is");ee.exports=function(S){return g(S)?S:A(S,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":318,"./is":327}],327:[function(d,ee,te){var A=void 0;ee.exports=function(g){return g!==A&&g!==null}},{}],328:[function(d,ee,te){(function(A){(function(){var g=d("bit-twiddle"),S=d("dup"),M=d("buffer").Buffer;A.__TYPEDARRAY_POOL||(A.__TYPEDARRAY_POOL={UINT8:S([32,0]),UINT16:S([32,0]),UINT32:S([32,0]),BIGUINT64:S([32,0]),INT8:S([32,0]),INT16:S([32,0]),INT32:S([32,0]),BIGINT64:S([32,0]),FLOAT:S([32,0]),DOUBLE:S([32,0]),DATA:S([32,0]),UINT8C:S([32,0]),BUFFER:S([32,0])});var e=typeof Uint8ClampedArray<"u",a=typeof BigUint64Array<"u",n=typeof BigInt64Array<"u",r=A.__TYPEDARRAY_POOL;r.UINT8C||(r.UINT8C=S([32,0])),r.BIGUINT64||(r.BIGUINT64=S([32,0])),r.BIGINT64||(r.BIGINT64=S([32,0])),r.BUFFER||(r.BUFFER=S([32,0]));var t=r.DATA,c=r.BUFFER;te.free=function(k){if(M.isBuffer(k))c[g.log2(k.length)].push(k);else{if(Object.prototype.toString.call(k)!=="[object ArrayBuffer]"&&(k=k.buffer),!k)return;var P=k.length||k.byteLength,z=g.log2(P)|0;t[z].push(k)}};function s(T){if(!!T){var k=T.length||T.byteLength,P=g.log2(k);t[P].push(T)}}function i(T){s(T.buffer)}te.freeUint8=te.freeUint16=te.freeUint32=te.freeBigUint64=te.freeInt8=te.freeInt16=te.freeInt32=te.freeBigInt64=te.freeFloat32=te.freeFloat=te.freeFloat64=te.freeDouble=te.freeUint8Clamped=te.freeDataView=i,te.freeArrayBuffer=s,te.freeBuffer=function(k){c[g.log2(k.length)].push(k)},te.malloc=function(k,P){if(P===void 0||P==="arraybuffer")return x(k);switch(P){case"uint8":return p(k);case"uint16":return v(k);case"uint32":return f(k);case"int8":return y(k);case"int16":return o(k);case"int32":return m(k);case"float":case"float32":return l(k);case"double":case"float64":return w(k);case"uint8_clamped":return _(k);case"bigint64":return b(k);case"biguint64":return h(k);case"buffer":return L(k);case"data":case"dataview":return u(k);default:return null}return null};function x(k){var k=g.nextPow2(k),P=g.log2(k),z=t[P];return z.length>0?z.pop():new ArrayBuffer(k)}te.mallocArrayBuffer=x;function p(T){return new Uint8Array(x(T),0,T)}te.mallocUint8=p;function v(T){return new Uint16Array(x(2*T),0,T)}te.mallocUint16=v;function f(T){return new Uint32Array(x(4*T),0,T)}te.mallocUint32=f;function y(T){return new Int8Array(x(T),0,T)}te.mallocInt8=y;function o(T){return new Int16Array(x(2*T),0,T)}te.mallocInt16=o;function m(T){return new Int32Array(x(4*T),0,T)}te.mallocInt32=m;function l(T){return new Float32Array(x(4*T),0,T)}te.mallocFloat32=te.mallocFloat=l;function w(T){return new Float64Array(x(8*T),0,T)}te.mallocFloat64=te.mallocDouble=w;function _(T){return e?new Uint8ClampedArray(x(T),0,T):p(T)}te.mallocUint8Clamped=_;function h(T){return a?new BigUint64Array(x(8*T),0,T):null}te.mallocBigUint64=h;function b(T){return n?new BigInt64Array(x(8*T),0,T):null}te.mallocBigInt64=b;function u(T){return new DataView(x(T),0,T)}te.mallocDataView=u;function L(T){T=g.nextPow2(T);var k=g.log2(T),P=c[k];return P.length>0?P.pop():new M(T)}te.mallocBuffer=L,te.clearCache=function(){for(var k=0;k<32;++k)r.UINT8[k].length=0,r.UINT16[k].length=0,r.UINT32[k].length=0,r.INT8[k].length=0,r.INT16[k].length=0,r.INT32[k].length=0,r.FLOAT[k].length=0,r.DOUBLE[k].length=0,r.BIGUINT64[k].length=0,r.BIGINT64[k].length=0,r.UINT8C[k].length=0,t[k].length=0,c[k].length=0}}).call(this)}).call(this,typeof Mo<"u"?Mo:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],329:[function(d,ee,te){var A=/[\'\"]/;ee.exports=function(S){return S?(A.test(S.charAt(0))&&(S=S.substr(1)),A.test(S.charAt(S.length-1))&&(S=S.substr(0,S.length-1)),S):""}},{}],330:[function(d,ee,te){ee.exports=function(g,S,M){Array.isArray(M)||(M=[].slice.call(arguments,2));for(var e=0,a=M.length;e<a;e++){var n=M[e];for(var r in n)if(!(S[r]!==void 0&&!Array.isArray(S[r])&&g[r]===S[r])&&r in S){var t;if(n[r]===!0)t=S[r];else{if(n[r]===!1)continue;if(typeof n[r]=="function"&&(t=n[r](S[r],g,S),t===void 0))continue}g[r]=t}}return g}},{}],331:[function(d,ee,te){(function(A){(function(){ee.exports=g;function g(M,e){if(S("noDeprecation"))return M;var a=!1;function n(){if(!a){if(S("throwDeprecation"))throw new Error(e);S("traceDeprecation")?console.trace(e):console.warn(e),a=!0}return M.apply(this,arguments)}return n}function S(M){try{if(!A.localStorage)return!1}catch{return!1}var e=A.localStorage[M];return e==null?!1:String(e).toLowerCase()==="true"}}).call(this)}).call(this,typeof Mo<"u"?Mo:typeof self<"u"?self:typeof window<"u"?window:{})},{}],332:[function(d,ee,te){var A=d("get-canvas-context");ee.exports=function(S){return A("webgl",S)}},{"get-canvas-context":194}],333:[function(d,ee,te){var A=d("../main"),g=d("object-assign"),S=A.instance();function M(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}M.prototype=new A.baseCalendar,g(M.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(x,p){if(typeof x=="string"){var v=x.match(a);return v?v[0]:""}var f=this._validateYear(x),y=x.month(),o=""+this.toChineseMonth(f,y);return p&&o.length<2&&(o="0"+o),this.isIntercalaryMonth(f,y)&&(o+="i"),o},monthNames:function(x){if(typeof x=="string"){var p=x.match(n);return p?p[0]:""}var v=this._validateYear(x),f=x.month(),y=this.toChineseMonth(v,f),o=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][y-1];return this.isIntercalaryMonth(v,f)&&(o="\u95F0"+o),o},monthNamesShort:function(x){if(typeof x=="string"){var p=x.match(r);return p?p[0]:""}var v=this._validateYear(x),f=x.month(),y=this.toChineseMonth(v,f),o=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][y-1];return this.isIntercalaryMonth(v,f)&&(o="\u95F0"+o),o},parseMonth:function(x,p){x=this._validateYear(x);var v=parseInt(p),f;if(isNaN(v))p[0]==="\u95F0"&&(f=!0,p=p.substring(1)),p[p.length-1]==="\u6708"&&(p=p.substring(0,p.length-1)),v=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(p);else{var y=p[p.length-1];f=y==="i"||y==="I"}var o=this.toMonthIndex(x,v,f);return o},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(x,p){if(x.year&&(x=x.year()),typeof x!="number"||x<1888||x>2111)throw p.replace(/\{0\}/,this.local.name);return x},toMonthIndex:function(x,p,v){var f=this.intercalaryMonth(x),y=v&&p!==f;if(y||p<1||p>12)throw A.local.invalidMonth.replace(/\{0\}/,this.local.name);var o;return f?!v&&p<=f?o=p-1:o=p:o=p-1,o},toChineseMonth:function(x,p){x.year&&(x=x.year(),p=x.month());var v=this.intercalaryMonth(x),f=v?12:11;if(p<0||p>f)throw A.local.invalidMonth.replace(/\{0\}/,this.local.name);var y;return v?p<v?y=p+1:y=p:y=p+1,y},intercalaryMonth:function(x){x=this._validateYear(x);var p=t[x-t[0]],v=p>>13;return v},isIntercalaryMonth:function(x,p){x.year&&(x=x.year(),p=x.month());var v=this.intercalaryMonth(x);return!!v&&v===p},leapYear:function(x){return this.intercalaryMonth(x)!==0},weekOfYear:function(x,p,v){var f=this._validateYear(x,A.local.invalidyear),y=c[f-c[0]],o=y>>9&4095,m=y>>5&15,l=y&31,w;w=S.newDate(o,m,l),w.add(4-(w.dayOfWeek()||7),"d");var _=this.toJD(x,p,v)-w.toJD();return 1+Math.floor(_/7)},monthsInYear:function(x){return this.leapYear(x)?13:12},daysInMonth:function(x,p){x.year&&(p=x.month(),x=x.year()),x=this._validateYear(x);var v=t[x-t[0]],f=v>>13,y=f?12:11;if(p>y)throw A.local.invalidMonth.replace(/\{0\}/,this.local.name);var o=v&1<<12-p?30:29;return o},weekDay:function(x,p,v){return(this.dayOfWeek(x,p,v)||7)<6},toJD:function(x,p,v){var f=this._validate(x,o,v,A.local.invalidDate);x=this._validateYear(f.year()),p=f.month(),v=f.day();var y=this.isIntercalaryMonth(x,p),o=this.toChineseMonth(x,p),m=i(x,o,v,y);return S.toJD(m.year,m.month,m.day)},fromJD:function(x){var p=S.fromJD(x),v=s(p.year(),p.month(),p.day()),f=this.toMonthIndex(v.year,v.month,v.isIntercalary);return this.newDate(v.year,f,v.day)},fromString:function(x){var p=x.match(e),v=this._validateYear(+p[1]),f=+p[2],y=!!p[3],o=this.toMonthIndex(v,f,y),m=+p[4];return this.newDate(v,o,m)},add:function(x,p,v){var f=x.year(),y=x.month(),o=this.isIntercalaryMonth(f,y),m=this.toChineseMonth(f,y),l=Object.getPrototypeOf(M.prototype).add.call(this,x,p,v);if(v==="y"){var w=l.year(),_=l.month(),h=this.isIntercalaryMonth(w,m),b=o&&h?this.toMonthIndex(w,m,!0):this.toMonthIndex(w,m,!1);b!==_&&l.month(b)}return l}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,a=/^\d?\d[iI]?/m,n=/^闰?十?[一二三四五六七八九]?月/m,r=/^闰?十?[一二三四五六七八九]?/m;A.calendars.chinese=M;var t=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],c=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904];function s(x,p,v,f){var y,o;if(typeof x=="object")y=x,o=p||{};else{var m=typeof x=="number"&&x>=1888&&x<=2111;if(!m)throw new Error("Solar year outside range 1888-2111");var l=typeof p=="number"&&p>=1&&p<=12;if(!l)throw new Error("Solar month outside range 1 - 12");var w=typeof v=="number"&&v>=1&&v<=31;if(!w)throw new Error("Solar day outside range 1 - 31");y={year:x,month:p,day:v},o=f||{}}var _=c[y.year-c[0]],h=y.year<<9|y.month<<5|y.day;o.year=h>=_?y.year:y.year-1,_=c[o.year-c[0]];var b=_>>9&4095,u=_>>5&15,L=_&31,T,k=new Date(b,u-1,L),P=new Date(y.year,y.month-1,y.day);T=Math.round((P-k)/(24*3600*1e3));var z=t[o.year-t[0]],I;for(I=0;I<13;I++){var D=z&1<<12-I?30:29;if(T<D)break;T-=D}var R=z>>13;return!R||I<R?(o.isIntercalary=!1,o.month=1+I):I===R?(o.isIntercalary=!0,o.month=I):(o.isIntercalary=!1,o.month=I),o.day=1+T,o}function i(x,p,v,f,y){var o,m;if(typeof x=="object")m=x,o=p||{};else{var l=typeof x=="number"&&x>=1888&&x<=2111;if(!l)throw new Error("Lunar year outside range 1888-2111");var w=typeof p=="number"&&p>=1&&p<=12;if(!w)throw new Error("Lunar month outside range 1 - 12");var _=typeof v=="number"&&v>=1&&v<=30;if(!_)throw new Error("Lunar day outside range 1 - 30");var h;typeof f=="object"?(h=!1,o=f):(h=!!f,o=y||{}),m={year:x,month:p,day:v,isIntercalary:h}}var b;b=m.day-1;var u=t[m.year-t[0]],L=u>>13,T;L&&(m.month>L||m.isIntercalary)?T=m.month:T=m.month-1;for(var k=0;k<T;k++){var P=u&1<<12-k?30:29;b+=P}var z=c[m.year-c[0]],I=z>>9&4095,D=z>>5&15,R=z&31,O=new Date(I,D-1,R+b);return o.year=O.getFullYear(),o.month=1+O.getMonth(),o.day=O.getDate(),o}},{"../main":347,"object-assign":247}],334:[function(d,ee,te){var A=d("../main"),g=d("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var e=this._validate(a,this.minMonth,this.minDay,A.local.invalidYear),a=e.year()+(e.year()<0?1:0);return a%4===3||a%4===-1},monthsInYear:function(M){return this._validate(M,this.minMonth,this.minDay,A.local.invalidYear||A.regionalOptions[""].invalidYear),13},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(M,e){var a=this._validate(M,e,this.minDay,A.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===13&&this.leapYear(a.year())?1:0)},weekDay:function(M,e,a){return(this.dayOfWeek(M,e,a)||7)<6},toJD:function(M,e,a){var n=this._validate(M,e,a,A.local.invalidDate);return M=n.year(),M<0&&M++,n.day()+(n.month()-1)*30+(M-1)*365+Math.floor(M/4)+this.jdEpoch-1},fromJD:function(M){var e=Math.floor(M)+.5-this.jdEpoch,a=Math.floor((e-Math.floor((e+366)/1461))/365)+1;a<=0&&a--,e=Math.floor(M)+.5-this.newDate(a,1,1).toJD();var n=Math.floor(e/30)+1,r=e-(n-1)*30+1;return this.newDate(a,n,r)}}),A.calendars.coptic=S},{"../main":347,"object-assign":247}],335:[function(d,ee,te){var A=d("../main"),g=d("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,A.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,A.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,A.local.invalidYear),400},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/8)+1},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,A.local.invalidMonth);return this.daysPerMonth[n.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate);return(r.day()+1)%8},weekDay:function(e,a,n){var r=this.dayOfWeek(e,a,n);return r>=2&&r<=6},extraInfo:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate);return{century:M[Math.floor((r.year()-1)/100)+1]||""}},toJD:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate);return e=r.year()+(r.year()<0?1:0),a=r.month(),n=r.day(),n+(a>1?16:0)+(a>2?(a-2)*32:0)+(e-1)*400+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var a=Math.floor(e/400)+1;e-=(a-1)*400,e+=e>15?16:0;var n=Math.floor(e/32)+1,r=e-(n-1)*32+1;return this.newDate(a<=0?a-1:a,n,r)}});var M={20:"Fruitbat",21:"Anchovy"};A.calendars.discworld=S},{"../main":347,"object-assign":247}],336:[function(d,ee,te){var A=d("../main"),g=d("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var e=this._validate(a,this.minMonth,this.minDay,A.local.invalidYear),a=e.year()+(e.year()<0?1:0);return a%4===3||a%4===-1},monthsInYear:function(M){return this._validate(M,this.minMonth,this.minDay,A.local.invalidYear||A.regionalOptions[""].invalidYear),13},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(M,e){var a=this._validate(M,e,this.minDay,A.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===13&&this.leapYear(a.year())?1:0)},weekDay:function(M,e,a){return(this.dayOfWeek(M,e,a)||7)<6},toJD:function(M,e,a){var n=this._validate(M,e,a,A.local.invalidDate);return M=n.year(),M<0&&M++,n.day()+(n.month()-1)*30+(M-1)*365+Math.floor(M/4)+this.jdEpoch-1},fromJD:function(M){var e=Math.floor(M)+.5-this.jdEpoch,a=Math.floor((e-Math.floor((e+366)/1461))/365)+1;a<=0&&a--,e=Math.floor(M)+.5-this.newDate(a,1,1).toJD();var n=Math.floor(e/30)+1,r=e-(n-1)*30+1;return this.newDate(a,n,r)}}),A.calendars.ethiopian=S},{"../main":347,"object-assign":247}],337:[function(d,ee,te){var A=d("../main"),g=d("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,A.local.invalidYear);return this._leapYear(a.year())},_leapYear:function(e){return e=e<0?e+1:e,M(e*7+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,A.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,A.local.invalidYear);return e=a.year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,a){return e.year&&(a=e.month(),e=e.year()),this._validate(e,a,this.minDay,A.local.invalidMonth),a===12&&this.leapYear(e)||a===8&&M(this.daysInYear(e),10)===5?30:a===9&&M(this.daysInYear(e),10)===3?29:this.daysPerMonth[a-1]},weekDay:function(e,a,n){return this.dayOfWeek(e,a,n)!==6},extraInfo:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate);return{yearType:(this.leapYear(r)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(r)%10-3]}},toJD:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate);e=r.year(),a=r.month(),n=r.day();var t=e<=0?e+1:e,c=this.jdEpoch+this._delay1(t)+this._delay2(t)+n+1;if(a<7){for(var s=7;s<=this.monthsInYear(e);s++)c+=this.daysInMonth(e,s);for(var s=1;s<a;s++)c+=this.daysInMonth(e,s)}else for(var s=7;s<a;s++)c+=this.daysInMonth(e,s);return c},_delay1:function(e){var a=Math.floor((235*e-234)/19),n=12084+13753*a,r=a*29+Math.floor(n/25920);return M(3*(r+1),7)<3&&r++,r},_delay2:function(e){var a=this._delay1(e-1),n=this._delay1(e),r=this._delay1(e+1);return r-n===356?2:n-a===382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var a=Math.floor((e-this.jdEpoch)*98496/35975351)-1;e>=this.toJD(a===-1?1:a+1,7,1);)a++;for(var n=e<this.toJD(a,1,1)?7:1;e>this.toJD(a,n,this.daysInMonth(a,n));)n++;var r=e-this.toJD(a,n,1)+1;return this.newDate(a,n,r)}});function M(e,a){return e-a*Math.floor(e/a)}A.calendars.hebrew=S},{"../main":347,"object-assign":247}],338:[function(d,ee,te){var A=d("../main"),g=d("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(M){var e=this._validate(M,this.minMonth,this.minDay,A.local.invalidYear);return(e.year()*11+14)%30<11},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(M){return this.leapYear(M)?355:354},daysInMonth:function(M,e){var a=this._validate(M,e,this.minDay,A.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===12&&this.leapYear(a.year())?1:0)},weekDay:function(M,e,a){return this.dayOfWeek(M,e,a)!==5},toJD:function(M,e,a){var n=this._validate(M,e,a,A.local.invalidDate);return M=n.year(),e=n.month(),a=n.day(),M=M<=0?M+1:M,a+Math.ceil(29.5*(e-1))+(M-1)*354+Math.floor((3+11*M)/30)+this.jdEpoch-1},fromJD:function(M){M=Math.floor(M)+.5;var e=Math.floor((30*(M-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var a=Math.min(12,Math.ceil((M-29-this.toJD(e,1,1))/29.5)+1),n=M-this.toJD(e,a,1)+1;return this.newDate(e,a,n)}}),A.calendars.islamic=S},{"../main":347,"object-assign":247}],339:[function(d,ee,te){var A=d("../main"),g=d("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var e=this._validate(a,this.minMonth,this.minDay,A.local.invalidYear),a=e.year()<0?e.year()+1:e.year();return a%4===0},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(4-(n.dayOfWeek()||7),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(M,e){var a=this._validate(M,e,this.minDay,A.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===2&&this.leapYear(a.year())?1:0)},weekDay:function(M,e,a){return(this.dayOfWeek(M,e,a)||7)<6},toJD:function(M,e,a){var n=this._validate(M,e,a,A.local.invalidDate);return M=n.year(),e=n.month(),a=n.day(),M<0&&M++,e<=2&&(M--,e+=12),Math.floor(365.25*(M+4716))+Math.floor(30.6001*(e+1))+a-1524.5},fromJD:function(M){var e=Math.floor(M+.5),a=e+1524,n=Math.floor((a-122.1)/365.25),r=Math.floor(365.25*n),t=Math.floor((a-r)/30.6001),c=t-Math.floor(t<14?1:13),s=n-Math.floor(c>2?4716:4715),i=a-r-Math.floor(30.6001*t);return s<=0&&s--,this.newDate(s,c,i)}}),A.calendars.julian=S},{"../main":347,"object-assign":247}],340:[function(d,ee,te){var A=d("../main"),g=d("object-assign");function S(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(a){return this._validate(a,this.minMonth,this.minDay,A.local.invalidYear),!1},formatYear:function(a){var n=this._validate(a,this.minMonth,this.minDay,A.local.invalidYear);a=n.year();var r=Math.floor(a/400);a=a%400,a+=a<0?400:0;var t=Math.floor(a/20);return r+"."+t+"."+a%20},forYear:function(a){if(a=a.split("."),a.length<3)throw"Invalid Mayan year";for(var n=0,r=0;r<a.length;r++){var t=parseInt(a[r],10);if(Math.abs(t)>19||r>0&&t<0)throw"Invalid Mayan year";n=n*20+t}return n},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,A.local.invalidYear),18},weekOfYear:function(a,n,r){return this._validate(a,n,r,A.local.invalidDate),0},daysInYear:function(a){return this._validate(a,this.minMonth,this.minDay,A.local.invalidYear),360},daysInMonth:function(a,n){return this._validate(a,n,this.minDay,A.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(a,n,r){var t=this._validate(a,n,r,A.local.invalidDate);return t.day()},weekDay:function(a,n,r){return this._validate(a,n,r,A.local.invalidDate),!0},extraInfo:function(a,n,r){var t=this._validate(a,n,r,A.local.invalidDate),c=t.toJD(),s=this._toHaab(c),i=this._toTzolkin(c);return{haabMonthName:this.local.haabMonths[s[0]-1],haabMonth:s[0],haabDay:s[1],tzolkinDayName:this.local.tzolkinMonths[i[0]-1],tzolkinDay:i[0],tzolkinTrecena:i[1]}},_toHaab:function(a){a-=this.jdEpoch;var n=M(a+8+(18-1)*20,365);return[Math.floor(n/20)+1,M(n,20)]},_toTzolkin:function(a){return a-=this.jdEpoch,[e(a+20,20),e(a+4,13)]},toJD:function(a,n,r){var t=this._validate(a,n,r,A.local.invalidDate);return t.day()+t.month()*20+t.year()*360+this.jdEpoch},fromJD:function(a){a=Math.floor(a)+.5-this.jdEpoch;var n=Math.floor(a/360);a=a%360,a+=a<0?360:0;var r=Math.floor(a/20),t=a%20;return this.newDate(n,r,t)}});function M(a,n){return a-n*Math.floor(a/n)}function e(a,n){return M(a-1,n)+1}A.calendars.mayan=S},{"../main":347,"object-assign":247}],341:[function(d,ee,te){var A=d("../main"),g=d("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar;var M=A.instance("gregorian");g(S.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,A.local.invalidYear||A.regionalOptions[""].invalidYear);return M.leapYear(a.year()+(a.year()<1?1:0)+1469)},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(1-(r.dayOfWeek()||7),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,A.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return(this.dayOfWeek(e,a,n)||7)<6},toJD:function(t,a,n){var r=this._validate(t,a,n,A.local.invalidMonth),t=r.year();t<0&&t++;for(var c=r.day(),s=1;s<r.month();s++)c+=this.daysPerMonth[s-1];return c+M.toJD(t+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var a=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(a+1,1,1);)a++;for(var n=e-Math.floor(this.toJD(a,1,1)+.5)+1,r=1;n>this.daysInMonth(a,r);)n-=this.daysInMonth(a,r),r++;return this.newDate(a,r,n)}}),A.calendars.nanakshahi=S},{"../main":347,"object-assign":247}],342:[function(d,ee,te){var A=d("../main"),g=d("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(M){return this.daysInYear(M)!==this.daysPerYear},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(M){var e=this._validate(M,this.minMonth,this.minDay,A.local.invalidYear);if(M=e.year(),typeof this.NEPALI_CALENDAR_DATA[M]>"u")return this.daysPerYear;for(var a=0,n=this.minMonth;n<=12;n++)a+=this.NEPALI_CALENDAR_DATA[M][n];return a},daysInMonth:function(M,e){return M.year&&(e=M.month(),M=M.year()),this._validate(M,e,this.minDay,A.local.invalidMonth),typeof this.NEPALI_CALENDAR_DATA[M]>"u"?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[M][e]},weekDay:function(M,e,a){return this.dayOfWeek(M,e,a)!==6},toJD:function(M,e,a){var n=this._validate(M,e,a,A.local.invalidDate);M=n.year(),e=n.month(),a=n.day();var r=A.instance(),t=0,c=e,s=M;this._createMissingCalendarData(M);var i=M-(c>9||c===9&&a>=this.NEPALI_CALENDAR_DATA[s][0]?56:57);for(e!==9&&(t=a,c--);c!==9;)c<=0&&(c=12,s--),t+=this.NEPALI_CALENDAR_DATA[s][c],c--;return e===9?(t+=a-this.NEPALI_CALENDAR_DATA[s][0],t<0&&(t+=r.daysInYear(i))):t+=this.NEPALI_CALENDAR_DATA[s][9]-this.NEPALI_CALENDAR_DATA[s][0],r.newDate(i,1,1).add(t,"d").toJD()},fromJD:function(M){var e=A.instance(),a=e.fromJD(M),n=a.year(),r=a.dayOfYear(),t=n+56;this._createMissingCalendarData(t);for(var c=9,s=this.NEPALI_CALENDAR_DATA[t][0],i=this.NEPALI_CALENDAR_DATA[t][c]-s+1;r>i;)c++,c>12&&(c=1,t++),i+=this.NEPALI_CALENDAR_DATA[t][c];var x=this.NEPALI_CALENDAR_DATA[t][c]-(i-r);return this.newDate(t,c,x)},_createMissingCalendarData:function(M){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var a=M-1;a<M+2;a++)typeof this.NEPALI_CALENDAR_DATA[a]>"u"&&(this.NEPALI_CALENDAR_DATA[a]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),A.calendars.nepali=S},{"../main":347,"object-assign":247}],343:[function(d,ee,te){var A=d("../main"),g=d("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,A.local.invalidYear);return((a.year()-(a.year()>0?474:473))%2820+474+38)*682%2816<682},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-((r.dayOfWeek()+1)%7),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,A.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return this.dayOfWeek(e,a,n)!==5},toJD:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate);e=r.year(),a=r.month(),n=r.day();var t=e-(e>=0?474:473),c=474+M(t,2820);return n+(a<=7?(a-1)*31:(a-1)*30+6)+Math.floor((c*682-110)/2816)+(c-1)*365+Math.floor(t/2820)*1029983+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e)+.5;var a=e-this.toJD(475,1,1),n=Math.floor(a/1029983),r=M(a,1029983),t=2820;if(r!==1029982){var c=Math.floor(r/366),s=M(r,366);t=Math.floor((2134*c+2816*s+2815)/1028522)+c+1}var i=t+2820*n+474;i=i<=0?i-1:i;var x=e-this.toJD(i,1,1)+1,p=x<=186?Math.ceil(x/31):Math.ceil((x-6)/30),v=e-this.toJD(i,p,1)+1;return this.newDate(i,p,v)}});function M(e,a){return e-a*Math.floor(e/a)}A.calendars.persian=S,A.calendars.jalali=S},{"../main":347,"object-assign":247}],344:[function(d,ee,te){var A=d("../main"),g=d("object-assign"),S=A.instance();function M(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}M.prototype=new A.baseCalendar,g(M.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(n){var a=this._validate(n,this.minMonth,this.minDay,A.local.invalidYear),n=this._t2gYear(a.year());return S.leapYear(n)},weekOfYear:function(t,a,n){var r=this._validate(t,this.minMonth,this.minDay,A.local.invalidYear),t=this._t2gYear(r.year());return S.weekOfYear(t,r.month(),r.day())},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,A.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return(this.dayOfWeek(e,a,n)||7)<6},toJD:function(t,a,n){var r=this._validate(t,a,n,A.local.invalidDate),t=this._t2gYear(r.year());return S.toJD(t,r.month(),r.day())},fromJD:function(e){var a=S.fromJD(e),n=this._g2tYear(a.year());return this.newDate(n,a.month(),a.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),A.calendars.taiwan=M},{"../main":347,"object-assign":247}],345:[function(d,ee,te){var A=d("../main"),g=d("object-assign"),S=A.instance();function M(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}M.prototype=new A.baseCalendar,g(M.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(n){var a=this._validate(n,this.minMonth,this.minDay,A.local.invalidYear),n=this._t2gYear(a.year());return S.leapYear(n)},weekOfYear:function(t,a,n){var r=this._validate(t,this.minMonth,this.minDay,A.local.invalidYear),t=this._t2gYear(r.year());return S.weekOfYear(t,r.month(),r.day())},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,A.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return(this.dayOfWeek(e,a,n)||7)<6},toJD:function(t,a,n){var r=this._validate(t,a,n,A.local.invalidDate),t=this._t2gYear(r.year());return S.toJD(t,r.month(),r.day())},fromJD:function(e){var a=S.fromJD(e),n=this._g2tYear(a.year());return this.newDate(n,a.month(),a.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),A.calendars.thai=M},{"../main":347,"object-assign":247}],346:[function(d,ee,te){var A=d("../main"),g=d("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,A.local.invalidYear);return this.daysInYear(a.year())===355},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var a=0,n=1;n<=12;n++)a+=this.daysInMonth(e,n);return a},daysInMonth:function(e,a){for(var n=this._validate(e,a,this.minDay,A.local.invalidMonth),r=n.toJD()-24e5+.5,t=0,c=0;c<M.length;c++){if(M[c]>r)return M[t]-M[t-1];t++}return 30},weekDay:function(e,a,n){return this.dayOfWeek(e,a,n)!==5},toJD:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate),t=12*(r.year()-1)+r.month()-15292,c=r.day()+M[t-1]-1;return c+24e5-.5},fromJD:function(e){for(var a=e-24e5+.5,n=0,r=0;r<M.length&&!(M[r]>a);r++)n++;var t=n+15292,c=Math.floor((t-1)/12),s=c+1,i=t-12*c,x=a-M[n-1]+1;return this.newDate(s,i,x)},isValid:function(e,a,n){var r=A.baseCalendar.prototype.isValid.apply(this,arguments);return r&&(e=e.year!=null?e.year:e,r=e>=1276&&e<=1500),r},_validate:function(e,a,n,r){var t=A.baseCalendar.prototype._validate.apply(this,arguments);if(t.year<1276||t.year>1500)throw r.replace(/\{0\}/,this.local.name);return t}}),A.calendars.ummalqura=S;var M=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":347,"object-assign":247}],347:[function(d,ee,te){var A=d("object-assign");function g(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}A(g.prototype,{instance:function(r,t){r=(r||"gregorian").toLowerCase(),t=t||"";var c=this._localCals[r+"-"+t];if(!c&&this.calendars[r]&&(c=new this.calendars[r](t),this._localCals[r+"-"+t]=c),!c)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,r);return c},newDate:function(r,t,c,s,i){return s=(r!=null&&r.year?r.calendar():typeof s=="string"?this.instance(s,i):s)||this.instance(),s.newDate(r,t,c)},substituteDigits:function(r){return function(t){return(t+"").replace(/[0-9]/g,function(c){return r[c]})}},substituteChineseDigits:function(r,t){return function(c){for(var s="",i=0;c>0;){var x=c%10;s=(x===0?"":r[x]+t[i])+s,i++,c=Math.floor(c/10)}return s.indexOf(r[1]+t[1])===0&&(s=s.substr(1)),s||r[0]}}});function S(r,t,c,s){if(this._calendar=r,this._year=t,this._month=c,this._day=s,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function M(r,t){return r=""+r,"000000".substring(0,t-r.length)+r}A(S.prototype,{newDate:function(r,t,c){return this._calendar.newDate(r==null?this:r,t,c)},year:function(r){return arguments.length===0?this._year:this.set(r,"y")},month:function(r){return arguments.length===0?this._month:this.set(r,"m")},day:function(r){return arguments.length===0?this._day:this.set(r,"d")},date:function(r,t,c){if(!this._calendar.isValid(r,t,c))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=r,this._month=t,this._day=c,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(r,t){return this._calendar.add(this,r,t)},set:function(r,t){return this._calendar.set(this,r,t)},compareTo:function(r){if(this._calendar.name!==r._calendar.name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,r._calendar.local.name);var t=this._year!==r._year?this._year-r._year:this._month!==r._month?this.monthOfYear()-r.monthOfYear():this._day-r._day;return t===0?0:t<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(r){return this._calendar.fromJD(r)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(r){return this._calendar.fromJSDate(r)},toString:function(){return(this.year()<0?"-":"")+M(Math.abs(this.year()),4)+"-"+M(this.month(),2)+"-"+M(this.day(),2)}});function e(){this.shortYearCutoff="+10"}A(e.prototype,{_validateLevel:0,newDate:function(r,t,c){return r==null?this.today():(r.year&&(this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate),c=r.day(),t=r.month(),r=r.year()),new S(this,r,t,c))},today:function(){return this.fromJSDate(new Date)},epoch:function(r){var t=this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return t.year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(r){var t=this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return(t.year()<0?"-":"")+M(Math.abs(t.year()),4)},monthsInYear:function(r){return this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear),12},monthOfYear:function(r,t){var c=this._validate(r,t,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return(c.month()+this.monthsInYear(c)-this.firstMonth)%this.monthsInYear(c)+this.minMonth},fromMonthOfYear:function(r,t){var c=(t+this.firstMonth-2*this.minMonth)%this.monthsInYear(r)+this.minMonth;return this._validate(r,c,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth),c},daysInYear:function(r){var t=this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return this.leapYear(t)?366:365},dayOfYear:function(r,t,c){var s=this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate);return s.toJD()-this.newDate(s.year(),this.fromMonthOfYear(s.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(r,t,c){var s=this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(s))+2)%this.daysInWeek()},extraInfo:function(r,t,c){return this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate),{}},add:function(r,t,c){return this._validate(r,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate),this._correctAdd(r,this._add(r,t,c),t,c)},_add:function(r,t,c){if(this._validateLevel++,c==="d"||c==="w"){var s=r.toJD()+t*(c==="w"?this.daysInWeek():1),i=r.calendar().fromJD(s);return this._validateLevel--,[i.year(),i.month(),i.day()]}try{var x=r.year()+(c==="y"?t:0),p=r.monthOfYear()+(c==="m"?t:0),i=r.day(),v=function(o){for(;p<o.minMonth;)x--,p+=o.monthsInYear(x);for(var m=o.monthsInYear(x);p>m-1+o.minMonth;)x++,p-=m,m=o.monthsInYear(x)};c==="y"?(r.month()!==this.fromMonthOfYear(x,p)&&(p=this.newDate(x,r.month(),this.minDay).monthOfYear()),p=Math.min(p,this.monthsInYear(x)),i=Math.min(i,this.daysInMonth(x,this.fromMonthOfYear(x,p)))):c==="m"&&(v(this),i=Math.min(i,this.daysInMonth(x,this.fromMonthOfYear(x,p))));var f=[x,this.fromMonthOfYear(x,p),i];return this._validateLevel--,f}catch(y){throw this._validateLevel--,y}},_correctAdd:function(r,t,c,s){if(!this.hasYearZero&&(s==="y"||s==="m")&&(t[0]===0||r.year()>0!=t[0]>0)){var i={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[s],x=c<0?-1:1;t=this._add(r,c*i[0]+x*i[1],i[2])}return r.date(t[0],t[1],t[2])},set:function(r,t,c){this._validate(r,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate);var s=c==="y"?t:r.year(),i=c==="m"?t:r.month(),x=c==="d"?t:r.day();return(c==="y"||c==="m")&&(x=Math.min(x,this.daysInMonth(s,i))),r.date(s,i,x)},isValid:function(r,t,c){this._validateLevel++;var s=this.hasYearZero||r!==0;if(s){var i=this.newDate(r,t,this.minDay);s=t>=this.minMonth&&t-this.minMonth<this.monthsInYear(i)&&c>=this.minDay&&c-this.minDay<this.daysInMonth(i)}return this._validateLevel--,s},toJSDate:function(r,t,c){var s=this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate);return n.instance().fromJD(this.toJD(s)).toJSDate()},fromJSDate:function(r){return this.fromJD(n.instance().fromJSDate(r).toJD())},_validate:function(r,t,c,s){if(r.year){if(this._validateLevel===0&&this.name!==r.calendar().name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,r.calendar().local.name);return r}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(r,t,c))throw s.replace(/\{0\}/,this.local.name);var i=this.newDate(r,t,c);return this._validateLevel--,i}catch(x){throw this._validateLevel--,x}}});function a(r){this.local=this.regionalOptions[r]||this.regionalOptions[""]}a.prototype=new e,A(a.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(c){var t=this._validate(c,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear),c=t.year()+(t.year()<0?1:0);return c%4===0&&(c%100!==0||c%400===0)},weekOfYear:function(r,t,c){var s=this.newDate(r,t,c);return s.add(4-(s.dayOfWeek()||7),"d"),Math.floor((s.dayOfYear()-1)/7)+1},daysInMonth:function(r,t){var c=this._validate(r,t,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return this.daysPerMonth[c.month()-1]+(c.month()===2&&this.leapYear(c.year())?1:0)},weekDay:function(r,t,c){return(this.dayOfWeek(r,t,c)||7)<6},toJD:function(r,t,c){var s=this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate);r=s.year(),t=s.month(),c=s.day(),r<0&&r++,t<3&&(t+=12,r--);var i=Math.floor(r/100),x=2-i+Math.floor(i/4);return Math.floor(365.25*(r+4716))+Math.floor(30.6001*(t+1))+c+x-1524.5},fromJD:function(r){var t=Math.floor(r+.5),c=Math.floor((t-186721625e-2)/36524.25);c=t+1+c-Math.floor(c/4);var s=c+1524,i=Math.floor((s-122.1)/365.25),x=Math.floor(365.25*i),p=Math.floor((s-x)/30.6001),v=s-x-Math.floor(p*30.6001),f=p-(p>13.5?13:1),y=i-(f>2.5?4716:4715);return y<=0&&y--,this.newDate(y,f,v)},toJSDate:function(r,t,c){var s=this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate),i=new Date(s.year(),s.month()-1,s.day());return i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),i.setHours(i.getHours()>12?i.getHours()+2:0),i},fromJSDate:function(r){return this.newDate(r.getFullYear(),r.getMonth()+1,r.getDate())}});var n=ee.exports=new g;n.cdate=S,n.baseCalendar=e,n.calendars.gregorian=a},{"object-assign":247}],348:[function(d,ee,te){var A=d("object-assign"),g=d("./main");A(g.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),g.local=g.regionalOptions[""],A(g.cdate.prototype,{formatDate:function(S,M){return typeof S!="string"&&(M=S,S=""),this._calendar.formatDate(S||"",this,M)}}),A(g.baseCalendar.prototype,{UNIX_EPOCH:g.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:24*60*60,TICKS_EPOCH:g.instance().jdEpoch,TICKS_PER_DAY:24*60*60*1e7,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(S,M,e){if(typeof S!="string"&&(e=M,M=S,S=""),!M)return"";if(M.calendar()!==this)throw g.local.invalidFormat||g.regionalOptions[""].invalidFormat;S=S||this.local.dateFormat,e=e||{};var a=e.dayNamesShort||this.local.dayNamesShort,n=e.dayNames||this.local.dayNames,r=e.monthNumbers||this.local.monthNumbers,t=e.monthNamesShort||this.local.monthNamesShort,c=e.monthNames||this.local.monthNames;e.calculateWeek||this.local.calculateWeek;for(var s=function(_,h){for(var b=1;w+b<S.length&&S.charAt(w+b)===_;)b++;return w+=b-1,Math.floor(b/(h||1))>1},i=function(_,h,b,u){var L=""+h;if(s(_,u))for(;L.length<b;)L="0"+L;return L},x=function(_,h,b,u){return s(_)?u[h]:b[h]},p=this,v=function(_){return typeof r=="function"?r.call(p,_,s("m")):o(i("m",_.month(),2))},f=function(_,h){return h?typeof c=="function"?c.call(p,_):c[_.month()-p.minMonth]:typeof t=="function"?t.call(p,_):t[_.month()-p.minMonth]},y=this.local.digits,o=function(_){return e.localNumbers&&y?y(_):_},m="",l=!1,w=0;w<S.length;w++)if(l)S.charAt(w)==="'"&&!s("'")?l=!1:m+=S.charAt(w);else switch(S.charAt(w)){case"d":m+=o(i("d",M.day(),2));break;case"D":m+=x("D",M.dayOfWeek(),a,n);break;case"o":m+=i("o",M.dayOfYear(),3);break;case"w":m+=i("w",M.weekOfYear(),2);break;case"m":m+=v(M);break;case"M":m+=f(M,s("M"));break;case"y":m+=s("y",2)?M.year():(M.year()%100<10?"0":"")+M.year()%100;break;case"Y":s("Y",2),m+=M.formatYear();break;case"J":m+=M.toJD();break;case"@":m+=(M.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":m+=(M.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":s("'")?m+="'":l=!0;break;default:m+=S.charAt(w)}return m},parseDate:function(S,M,e){if(M==null)throw g.local.invalidArguments||g.regionalOptions[""].invalidArguments;if(M=typeof M=="object"?M.toString():M+"",M==="")return null;S=S||this.local.dateFormat,e=e||{};var a=e.shortYearCutoff||this.shortYearCutoff;a=typeof a!="string"?a:this.today().year()%100+parseInt(a,10);for(var n=e.dayNamesShort||this.local.dayNamesShort,r=e.dayNames||this.local.dayNames,t=e.parseMonth||this.local.parseMonth,c=e.monthNumbers||this.local.monthNumbers,s=e.monthNamesShort||this.local.monthNamesShort,i=e.monthNames||this.local.monthNames,x=-1,p=-1,v=-1,f=-1,y=-1,o=!1,m=!1,l=function(I,D){for(var R=1;k+R<S.length&&S.charAt(k+R)===I;)R++;return k+=R-1,Math.floor(R/(D||1))>1},w=function(I,D){var R=l(I,D),O=[2,3,R?4:2,R?4:2,10,11,20]["oyYJ@!".indexOf(I)+1],F=new RegExp("^-?\\d{1,"+O+"}"),N=M.substring(T).match(F);if(!N)throw(g.local.missingNumberAt||g.regionalOptions[""].missingNumberAt).replace(/\{0\}/,T);return T+=N[0].length,parseInt(N[0],10)},_=this,h=function(){if(typeof c=="function"){l("m");var I=c.call(_,M.substring(T));return T+=I.length,I}return w("m")},b=function(I,D,R,O){for(var F=l(I,O)?R:D,N=0;N<F.length;N++)if(M.substr(T,F[N].length).toLowerCase()===F[N].toLowerCase())return T+=F[N].length,N+_.minMonth;throw(g.local.unknownNameAt||g.regionalOptions[""].unknownNameAt).replace(/\{0\}/,T)},u=function(){if(typeof i=="function"){var I=l("M")?i.call(_,M.substring(T)):s.call(_,M.substring(T));return T+=I.length,I}return b("M",s,i)},L=function(){if(M.charAt(T)!==S.charAt(k))throw(g.local.unexpectedLiteralAt||g.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,T);T++},T=0,k=0;k<S.length;k++)if(m)S.charAt(k)==="'"&&!l("'")?m=!1:L();else switch(S.charAt(k)){case"d":f=w("d");break;case"D":b("D",n,r);break;case"o":y=w("o");break;case"w":w("w");break;case"m":v=h();break;case"M":v=u();break;case"y":var P=k;o=!l("y",2),k=P,p=w("y",2);break;case"Y":p=w("Y",2);break;case"J":x=w("J")+.5,M.charAt(T)==="."&&(T++,w("J"));break;case"@":x=w("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":x=w("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":T=M.length;break;case"'":l("'")?L():m=!0;break;default:L()}if(T<M.length)throw g.local.unexpectedText||g.regionalOptions[""].unexpectedText;if(p===-1?p=this.today().year():p<100&&o&&(p+=a===-1?1900:this.today().year()-this.today().year()%100-(p<=a?0:100)),typeof v=="string"&&(v=t.call(this,p,v)),y>-1){v=1,f=y;for(var z=this.daysInMonth(p,v);f>z;z=this.daysInMonth(p,v))v++,f-=z}return x>-1?this.fromJD(x):this.newDate(p,v,f)},determineDate:function(S,M,e,a,n){e&&typeof e!="object"&&(n=a,a=e,e=null),typeof a!="string"&&(n=a,a="");var r=this,t=function(c){try{return r.parseDate(a,c,n)}catch{}c=c.toLowerCase();for(var s=(c.match(/^c/)&&e?e.newDate():null)||r.today(),i=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,x=i.exec(c);x;)s.add(parseInt(x[1],10),x[2]||"d"),x=i.exec(c);return s};return M=M?M.newDate():null,S=S==null?M:typeof S=="string"?t(S):typeof S=="number"?isNaN(S)||S===1/0||S===-1/0?M:r.today().add(S,"d"):r.newDate(S),S}})},{"./main":347,"object-assign":247}],349:[function(d,ee,te){ee.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],350:[function(d,ee,te){var A=d("./arrow_paths"),g=d("../../plots/font_attributes"),S=d("../../plots/cartesian/constants"),M=d("../../plot_api/plot_template").templatedArray;d("../../constants/axis_placeable_objects"),ee.exports=M("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:g({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:A.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:A.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",S.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",S.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",S.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",S.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:g({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/font_attributes":594,"./arrow_paths":349}],351:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axes"),S=d("./draw").draw;ee.exports=function(n){var r=n._fullLayout,t=A.filterVisible(r.annotations);if(t.length&&n._fullData.length)return A.syncOrAsync([S,M],n)};function M(a){var n=a._fullLayout;A.filterVisible(n.annotations).forEach(function(r){var t=g.getFromId(a,r.xref),c=g.getFromId(a,r.yref),s=g.getRefType(r.xref),i=g.getRefType(r.yref);r._extremes={},s==="range"&&e(r,t),i==="range"&&e(r,c)})}function e(a,n){var r=n._id,t=r.charAt(0),c=a[t],s=a["a"+t],i=a[t+"ref"],x=a["a"+t+"ref"],p=a["_"+t+"padplus"],v=a["_"+t+"padminus"],f={x:1,y:-1}[t]*a[t+"shift"],y=3*a.arrowsize*a.arrowwidth||0,o=y+f,m=y-f,l=3*a.startarrowsize*a.arrowwidth||0,w=l+f,_=l-f,h;if(x===i){var b=g.findExtremes(n,[n.r2c(c)],{ppadplus:o,ppadminus:m}),u=g.findExtremes(n,[n.r2c(s)],{ppadplus:Math.max(p,w),ppadminus:Math.max(v,_)});h={min:[b.min[0],u.min[0]],max:[b.max[0],u.max[0]]}}else w=s?w+s:w,_=s?_-s:_,h=g.findExtremes(n,[n.r2c(c)],{ppadplus:Math.max(p,o,w),ppadminus:Math.max(v,m,_)});a._extremes[r]=h}},{"../../lib":515,"../../plots/cartesian/axes":566,"./draw":356}],352:[function(d,ee,te){var A=d("../../lib"),g=d("../../registry"),S=d("../../plot_api/plot_template").arrayEditor;ee.exports={hasClickToShow:M,onClick:e};function M(r,t){var c=a(r,t);return c.on.length>0||c.explicitOff.length>0}function e(r,t){var c=a(r,t),s=c.on,i=c.off.concat(c.explicitOff),x={},p=r._fullLayout.annotations,v,f;if(!!(s.length||i.length)){for(v=0;v<s.length;v++)f=S(r.layout,"annotations",p[s[v]]),f.modifyItem("visible",!0),A.extendFlat(x,f.getUpdateObj());for(v=0;v<i.length;v++)f=S(r.layout,"annotations",p[i[v]]),f.modifyItem("visible",!1),A.extendFlat(x,f.getUpdateObj());return g.call("update",r,{},x)}}function a(r,t){var c=r._fullLayout.annotations,s=[],i=[],x=[],p=(t||[]).length,v,f,y,o,m,l,w,_;for(v=0;v<c.length;v++)if(y=c[v],o=y.clicktoshow,o){for(f=0;f<p;f++)if(m=t[f],l=m.xaxis,w=m.yaxis,l._id===y.xref&&w._id===y.yref&&l.d2r(m.x)===n(y._xclick,l)&&w.d2r(m.y)===n(y._yclick,w)){y.visible?o==="onout"?_=i:_=x:_=s,_.push(v);break}f===p&&y.visible&&o==="onout"&&i.push(v)}return{on:s,off:i,explicitOff:x}}function n(r,t){return t.type==="log"?t.l2r(r):t.d2r(r)}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647}],353:[function(d,ee,te){var A=d("../../lib"),g=d("../color");ee.exports=function(M,e,a,n){n("opacity");var r=n("bgcolor"),t=n("bordercolor"),c=g.opacity(t);n("borderpad");var s=n("borderwidth"),i=n("showarrow");n("text",i?" ":a._dfltTitle.annotation),n("textangle"),A.coerceFont(n,"font",a.font),n("width"),n("align");var x=n("height");if(x&&n("valign"),i){var p=n("arrowside"),v,f;p.indexOf("end")!==-1&&(v=n("arrowhead"),f=n("arrowsize")),p.indexOf("start")!==-1&&(n("startarrowhead",v),n("startarrowsize",f)),n("arrowcolor",c?e.bordercolor:g.defaultLine),n("arrowwidth",(c&&s||1)*2),n("standoff"),n("startstandoff")}var y=n("hovertext"),o=a.hoverlabel||{};if(y){var m=n("hoverlabel.bgcolor",o.bgcolor||(g.opacity(r)?g.rgb(r):g.defaultLine)),l=n("hoverlabel.bordercolor",o.bordercolor||g.contrast(m));A.coerceFont(n,"hoverlabel.font",{family:o.font.family,size:o.font.size,color:o.font.color||l})}n("captureevents",!!y)}},{"../../lib":515,"../color":367}],354:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib/to_log_range");ee.exports=function(M,e,a,n){e=e||{};var r=a==="log"&&e.type==="linear",t=a==="linear"&&e.type==="log";if(!(r||t))return;var c=M._fullLayout.annotations,s=e._id.charAt(0),i,x;function p(f){var y=i[f],o=null;r?o=g(y,e.range):o=Math.pow(10,y),A(o)||(o=null),n(x+f,o)}for(var v=0;v<c.length;v++)i=c[v],x="annotations["+v+"].",i[s+"ref"]===e._id&&p(s),i["a"+s+"ref"]===e._id&&p("a"+s)}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],355:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axes"),S=d("../../plots/array_container_defaults"),M=d("./common_defaults"),e=d("./attributes");ee.exports=function(r,t){S(r,t,{name:"annotations",handleItemDefaults:a})};function a(n,r,t){function c(L,T){return A.coerce(n,r,e,L,T)}var s=c("visible"),i=c("clicktoshow");if(!!(s||i)){M(n,r,t,c);for(var x=r.showarrow,p=["x","y"],v=[-10,-30],f={_fullLayout:t},y=0;y<2;y++){var o=p[y],m=g.coerceRef(n,r,f,o,"","paper");if(m!=="paper"){var l=g.getFromId(f,m);l._annIndices.push(r._index)}if(g.coercePosition(r,f,c,m,o,.5),x){var w="a"+o,_=g.coerceRef(n,r,f,w,"pixel",["pixel","paper"]);_!=="pixel"&&_!==m&&(_=r[w]="pixel");var h=_==="pixel"?v[y]:.4;g.coercePosition(r,f,c,_,w,h)}c(o+"anchor"),c(o+"shift")}if(A.noneOrAll(n,r,["x","y"]),x&&A.noneOrAll(n,r,["ax","ay"]),i){var b=c("xclick"),u=c("yclick");r._xclick=b===void 0?r.x:g.cleanPosition(b,f,r.xref),r._yclick=u===void 0?r.y:g.cleanPosition(u,f,r.yref)}}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":350,"./common_defaults":353}],356:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../registry"),S=d("../../plots/plots"),M=d("../../lib"),e=M.strTranslate,a=d("../../plots/cartesian/axes"),n=d("../color"),r=d("../drawing"),t=d("../fx"),c=d("../../lib/svg_text_utils"),s=d("../../lib/setcursor"),i=d("../dragelement"),x=d("../../plot_api/plot_template").arrayEditor,p=d("./draw_arrow_head");ee.exports={draw:v,drawOne:f,drawRaw:o};function v(m){var l=m._fullLayout;l._infolayer.selectAll(".annotation").remove();for(var w=0;w<l.annotations.length;w++)l.annotations[w].visible&&f(m,w);return S.previousPromises(m)}function f(m,l){var w=m._fullLayout,_=w.annotations[l]||{},h=a.getFromId(m,_.xref),b=a.getFromId(m,_.yref);h&&h.setScale(),b&&b.setScale(),o(m,_,l,!1,h,b)}function y(m,l,w,_,h){var b=h[w],u=h[w+"ref"],L=w.indexOf("y")!==-1,T=a.getRefType(u)==="domain",k=L?_.h:_.w;return m?T?b+(L?-l:l)/m._length:m.p2r(m.r2p(b)+l):b+(L?-l:l)/k}function o(m,l,w,_,h,b){var u=m._fullLayout,L=m._fullLayout._size,T=m._context.edits,k,P;_?(k="annotation-"+_,P=_+".annotations"):(k="annotation",P="annotations");var z=x(m.layout,P,l),I=z.modifyBase,D=z.modifyItem,R=z.getUpdateObj;u._infolayer.selectAll("."+k+'[data-index="'+w+'"]').remove();var O="clip"+u._uid+"_ann"+w;if(!l._input||l.visible===!1){A.selectAll("#"+O).remove();return}var F={x:{},y:{}},N=+l.textangle||0,G=u._infolayer.append("g").classed(k,!0).attr("data-index",String(w)).style("opacity",l.opacity),K=G.append("g").classed("annotation-text-g",!0),W=T[l.showarrow?"annotationTail":"annotationPosition"],Y=l.captureevents||T.annotationText||W;function re(oe){var be={index:w,annotation:l._input,fullAnnotation:l,event:oe};return _&&(be.subplotId=_),be}var ue=K.append("g").style("pointer-events",Y?"all":null).call(s,"pointer").on("click",function(){m._dragging=!1,m.emit("plotly_clickannotation",re(A.event))});l.hovertext&&ue.on("mouseover",function(){var oe=l.hoverlabel,be=oe.font,ce=this.getBoundingClientRect(),de=m.getBoundingClientRect();t.loneHover({x0:ce.left-de.left,x1:ce.right-de.left,y:(ce.top+ce.bottom)/2-de.top,text:l.hovertext,color:oe.bgcolor,borderColor:oe.bordercolor,fontFamily:be.family,fontSize:be.size,fontColor:be.color},{container:u._hoverlayer.node(),outerContainer:u._paper.node(),gd:m})}).on("mouseout",function(){t.loneUnhover(u._hoverlayer.node())});var j=l.borderwidth,q=l.borderpad,V=j+q,U=ue.append("rect").attr("class","bg").style("stroke-width",j+"px").call(n.stroke,l.bordercolor).call(n.fill,l.bgcolor),$=l.width||l.height,ne=u._topclips.selectAll("#"+O).data($?[0]:[]);ne.enter().append("clipPath").classed("annclip",!0).attr("id",O).append("rect"),ne.exit().remove();var X=l.font,Q=u._meta?M.templateString(l.text,u._meta):l.text,ie=ue.append("text").classed("annotation-text",!0).text(Q);function se(oe){return oe.call(r.font,X).attr({"text-anchor":{left:"start",right:"end"}[l.align]||"middle"}),c.convertToTspans(oe,m,ae),oe}function ae(){var oe=ie.selectAll("a");if(oe.size()===1&&oe.text()===ie.text()){var be=ue.insert("a",":first-child").attr({"xlink:xlink:href":oe.attr("xlink:href"),"xlink:xlink:show":oe.attr("xlink:show")}).style({cursor:"pointer"});be.node().appendChild(U.node())}var ce=ue.select(".annotation-text-math-group"),de=!ce.empty(),ye=r.bBox((de?ce:ie).node()),ge=ye.width,me=ye.height,Ee=l.width||ge,Pe=l.height||me,Ne=Math.round(Ee+2*V),we=Math.round(Pe+2*V);function ke($t,Zt){return Zt==="auto"&&($t<1/3?Zt="left":$t>2/3?Zt="right":Zt="center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[Zt]}for(var Xe=!1,He=["x","y"],Ie=0;Ie<He.length;Ie++){var De=He[Ie],Ge=l[De+"ref"]||De,ht=l["a"+De+"ref"],Rt={x:h,y:b}[De],Kt=(N+(De==="x"?0:-90))*Math.PI/180,It=Ne*Math.cos(Kt),Mt=we*Math.sin(Kt),Yt=Math.abs(It)+Math.abs(Mt),zt=l[De+"anchor"],St=l[De+"shift"]*(De==="x"?1:-1),Ye=F[De],rt,Ve,Ae,Ue,Ze,Qe=a.getRefType(Ge);if(Rt&&Qe!=="domain"){var _t=Rt.r2fraction(l[De]);(_t<0||_t>1)&&(ht===Ge?(_t=Rt.r2fraction(l["a"+De]),(_t<0||_t>1)&&(Xe=!0)):Xe=!0),rt=Rt._offset+Rt.r2p(l[De]),Ue=.5}else{var gt=Qe==="domain";De==="x"?(Ae=l[De],rt=gt?Rt._offset+Rt._length*Ae:rt=L.l+L.w*Ae):(Ae=1-l[De],rt=gt?Rt._offset+Rt._length*Ae:rt=L.t+L.h*Ae),Ue=l.showarrow?.5:Ae}if(l.showarrow){Ye.head=rt;var wt=l["a"+De];if(Ze=It*ke(.5,l.xanchor)-Mt*ke(.5,l.yanchor),ht===Ge){var Ut=a.getRefType(ht);Ut==="domain"?(De==="y"&&(wt=1-wt),Ye.tail=Rt._offset+Rt._length*wt):Ut==="paper"?De==="y"?(wt=1-wt,Ye.tail=L.t+L.h*wt):Ye.tail=L.l+L.w*wt:Ye.tail=Rt._offset+Rt.r2p(wt),Ve=Ze}else Ye.tail=rt+wt,Ve=Ze+wt;Ye.text=Ye.tail+Ze;var Dt=u[De==="x"?"width":"height"];if(Ge==="paper"&&(Ye.head=M.constrain(Ye.head,1,Dt-1)),ht==="pixel"){var Nt=-Math.max(Ye.tail-3,Ye.text),Xt=Math.min(Ye.tail+3,Ye.text)-Dt;Nt>0?(Ye.tail+=Nt,Ye.text+=Nt):Xt>0&&(Ye.tail-=Xt,Ye.text-=Xt)}Ye.tail+=St,Ye.head+=St}else Ze=Yt*ke(Ue,zt),Ve=Ze,Ye.text=rt+Ze;Ye.text+=St,Ze+=St,Ve+=St,l["_"+De+"padplus"]=Yt/2+Ve,l["_"+De+"padminus"]=Yt/2-Ve,l["_"+De+"size"]=Yt,l["_"+De+"shift"]=Ze}if(Xe){ue.remove();return}var Ht=0,ar=0;if(l.align!=="left"&&(Ht=(Ee-ge)*(l.align==="center"?.5:1)),l.valign!=="top"&&(ar=(Pe-me)*(l.valign==="middle"?.5:1)),de)ce.select("svg").attr({x:V+Ht-1,y:V+ar}).call(r.setClipUrl,$?O:null,m);else{var Vr=V+ar-ye.top,nn=V+Ht-ye.left;ie.call(c.positionText,nn,Vr).call(r.setClipUrl,$?O:null,m)}ne.select("rect").call(r.setRect,V,V,Ee,Pe),U.call(r.setRect,j/2,j/2,Ne-j,we-j),ue.call(r.setTranslate,Math.round(F.x.text-Ne/2),Math.round(F.y.text-we/2)),K.attr({transform:"rotate("+N+","+F.x.text+","+F.y.text+")"});var jr=function($t,Zt){G.selectAll(".annotation-arrow-g").remove();var ur=F.x.head,wr=F.y.head,$e=F.x.tail+$t,Je=F.y.tail+Zt,it=F.x.text+$t,lt=F.y.text+Zt,Tt=M.rotationXYMatrix(N,it,lt),Bt=M.apply2DTransform(Tt),Ce=M.apply2DTransform2(Tt),Me=+U.attr("width"),nt=+U.attr("height"),st=it-.5*Me,ct=st+Me,At=lt-.5*nt,dt=At+nt,Ct=[[st,At,st,dt],[st,dt,ct,dt],[ct,dt,ct,At],[ct,At,st,At]].map(Ce);if(!Ct.reduce(function(tt,Lt){return tt^!!M.segmentsIntersect(ur,wr,ur+1e6,wr+1e6,Lt[0],Lt[1],Lt[2],Lt[3])},!1)){Ct.forEach(function(tt){var Lt=M.segmentsIntersect($e,Je,ur,wr,tt[0],tt[1],tt[2],tt[3]);Lt&&($e=Lt.x,Je=Lt.y)});var Gt=l.arrowwidth,rr=l.arrowcolor,kr=l.arrowside,br=G.append("g").style({opacity:n.opacity(rr)}).classed("annotation-arrow-g",!0),Ar=br.append("path").attr("d","M"+$e+","+Je+"L"+ur+","+wr).style("stroke-width",Gt+"px").call(n.stroke,n.rgb(rr));if(p(Ar,kr,l),T.annotationPosition&&Ar.node().parentNode&&!_){var Wr=ur,nr=wr;if(l.standoff){var yr=Math.sqrt(Math.pow(ur-$e,2)+Math.pow(wr-Je,2));Wr+=l.standoff*($e-ur)/yr,nr+=l.standoff*(Je-wr)/yr}var Pr=br.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+($e-Wr)+","+(Je-nr),transform:e(Wr,nr)}).style("stroke-width",Gt+6+"px").call(n.stroke,"rgba(0,0,0,0)").call(n.fill,"rgba(0,0,0,0)"),Or,Sr;i.init({element:Pr.node(),gd:m,prepFn:function(){var tt=r.getTranslate(ue);Or=tt.x,Sr=tt.y,h&&h.autorange&&I(h._name+".autorange",!0),b&&b.autorange&&I(b._name+".autorange",!0)},moveFn:function(tt,Lt){var Wt=Bt(Or,Sr),ir=Wt[0]+tt,Ir=Wt[1]+Lt;ue.call(r.setTranslate,ir,Ir),D("x",y(h,tt,"x",L,l)),D("y",y(b,Lt,"y",L,l)),l.axref===l.xref&&D("ax",y(h,tt,"ax",L,l)),l.ayref===l.yref&&D("ay",y(b,Lt,"ay",L,l)),br.attr("transform",e(tt,Lt)),K.attr({transform:"rotate("+N+","+ir+","+Ir+")"})},doneFn:function(){g.call("_guiRelayout",m,R());var tt=document.querySelector(".js-notes-box-panel");tt&&tt.redraw(tt.selectedObj)}})}}};if(l.showarrow&&jr(0,0),W){var at;i.init({element:ue.node(),gd:m,prepFn:function(){at=K.attr("transform")},moveFn:function($t,Zt){var ur="pointer";if(l.showarrow)l.axref===l.xref?D("ax",y(h,$t,"ax",L,l)):D("ax",l.ax+$t),l.ayref===l.yref?D("ay",y(b,Zt,"ay",L.w,l)):D("ay",l.ay+Zt),jr($t,Zt);else{if(_)return;var wr,$e;if(h)wr=y(h,$t,"x",L,l);else{var Je=l._xsize/L.w,it=l.x+(l._xshift-l.xshift)/L.w-Je/2;wr=i.align(it+$t/L.w,Je,0,1,l.xanchor)}if(b)$e=y(b,Zt,"y",L,l);else{var lt=l._ysize/L.h,Tt=l.y-(l._yshift+l.yshift)/L.h-lt/2;$e=i.align(Tt-Zt/L.h,lt,0,1,l.yanchor)}D("x",wr),D("y",$e),(!h||!b)&&(ur=i.getCursor(h?.5:wr,b?.5:$e,l.xanchor,l.yanchor))}K.attr({transform:e($t,Zt)+at}),s(ue,ur)},clickFn:function($t,Zt){l.captureevents&&m.emit("plotly_clickannotation",re(Zt))},doneFn:function(){s(ue),g.call("_guiRelayout",m,R());var $t=document.querySelector(".js-notes-box-panel");$t&&$t.redraw($t.selectedObj)}})}}T.annotationText?ie.call(c.makeEditable,{delegate:ue,gd:m}).call(se).on("edit",function(oe){l.text=oe,this.call(se),D("text",oe),h&&h.autorange&&I(h._name+".autorange",!0),b&&b.autorange&&I(b._name+".autorange",!0),g.call("_guiRelayout",m,R())}):ie.call(se)}},{"../../lib":515,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../fx":407,"./draw_arrow_head":357,"@plotly/d3":58}],357:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../color"),S=d("./arrow_paths"),M=d("../../lib"),e=M.strScale,a=M.strRotate,n=M.strTranslate;ee.exports=function(t,c,s){var i=t.node(),x=S[s.arrowhead||0],p=S[s.startarrowhead||0],v=(s.arrowwidth||1)*(s.arrowsize||1),f=(s.arrowwidth||1)*(s.startarrowsize||1),y=c.indexOf("start")>=0,o=c.indexOf("end")>=0,m=x.backoff*v+s.standoff,l=p.backoff*f+s.startstandoff,w,_,h,b;if(i.nodeName==="line"){w={x:+t.attr("x1"),y:+t.attr("y1")},_={x:+t.attr("x2"),y:+t.attr("y2")};var u=w.x-_.x,L=w.y-_.y;if(h=Math.atan2(L,u),b=h+Math.PI,m&&l&&m+l>Math.sqrt(u*u+L*L)){K();return}if(m){if(m*m>u*u+L*L){K();return}var T=m*Math.cos(h),k=m*Math.sin(h);_.x+=T,_.y+=k,t.attr({x2:_.x,y2:_.y})}if(l){if(l*l>u*u+L*L){K();return}var P=l*Math.cos(h),z=l*Math.sin(h);w.x-=P,w.y-=z,t.attr({x1:w.x,y1:w.y})}}else if(i.nodeName==="path"){var I=i.getTotalLength(),D="";if(I<m+l){K();return}var R=i.getPointAtLength(0),O=i.getPointAtLength(.1);h=Math.atan2(R.y-O.y,R.x-O.x),w=i.getPointAtLength(Math.min(l,I)),D="0px,"+l+"px,";var F=i.getPointAtLength(I),N=i.getPointAtLength(I-.1);b=Math.atan2(F.y-N.y,F.x-N.x),_=i.getPointAtLength(Math.max(0,I-m));var G=D?l+m:m;D+=I-G+"px,"+I+"px",t.style("stroke-dasharray",D)}function K(){t.style("stroke-dasharray","0px,100px")}function W(Y,re,ue,j){!Y.path||(Y.noRotate&&(ue=0),A.select(i.parentNode).append("path").attr({class:t.attr("class"),d:Y.path,transform:n(re.x,re.y)+a(ue*180/Math.PI)+e(j)}).style({fill:g.rgb(s.arrowcolor),"stroke-width":0}))}y&&W(p,w,h,f),o&&W(x,_,b,v)}},{"../../lib":515,"../color":367,"./arrow_paths":349,"@plotly/d3":58}],358:[function(d,ee,te){var A=d("./draw"),g=d("./click");ee.exports={moduleType:"component",name:"annotations",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),includeBasePlot:d("../../plots/cartesian/include_components")("annotations"),calcAutorange:d("./calc_autorange"),draw:A.draw,drawOne:A.drawOne,drawRaw:A.drawRaw,hasClickToShow:g.hasClickToShow,onClick:g.onClick,convertCoords:d("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":350,"./calc_autorange":351,"./click":352,"./convert_coords":354,"./defaults":355,"./draw":356}],359:[function(d,ee,te){var A=d("../annotations/attributes"),g=d("../../plot_api/edit_types").overrideAll,S=d("../../plot_api/plot_template").templatedArray;ee.exports=g(S("annotation",{visible:A.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:A.xanchor,xshift:A.xshift,yanchor:A.yanchor,yshift:A.yshift,text:A.text,textangle:A.textangle,font:A.font,width:A.width,height:A.height,opacity:A.opacity,align:A.align,valign:A.valign,bgcolor:A.bgcolor,bordercolor:A.bordercolor,borderpad:A.borderpad,borderwidth:A.borderwidth,showarrow:A.showarrow,arrowcolor:A.arrowcolor,arrowhead:A.arrowhead,startarrowhead:A.startarrowhead,arrowside:A.arrowside,arrowsize:A.arrowsize,startarrowsize:A.startarrowsize,arrowwidth:A.arrowwidth,standoff:A.standoff,startstandoff:A.startstandoff,hovertext:A.hovertext,hoverlabel:A.hoverlabel,captureevents:A.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../annotations/attributes":350}],360:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axes");ee.exports=function(e){for(var a=e.fullSceneLayout,n=a.annotations,r=0;r<n.length;r++)S(n[r],e);e.fullLayout._infolayer.selectAll(".annotation-"+e.id).remove()};function S(M,e){var a=e.fullSceneLayout,n=a.domain,r=e.fullLayout._size,t={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};M._xa={},A.extendFlat(M._xa,t),g.setConvert(M._xa),M._xa._offset=r.l+n.x[0]*r.w,M._xa.l2p=function(){return .5*(1+M._pdata[0]/M._pdata[3])*r.w*(n.x[1]-n.x[0])},M._ya={},A.extendFlat(M._ya,t),g.setConvert(M._ya),M._ya._offset=r.t+(1-n.y[1])*r.h,M._ya.l2p=function(){return .5*(1-M._pdata[1]/M._pdata[3])*r.h*(n.y[1]-n.y[0])}}},{"../../lib":515,"../../plots/cartesian/axes":566}],361:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axes"),S=d("../../plots/array_container_defaults"),M=d("../annotations/common_defaults"),e=d("./attributes");ee.exports=function(r,t,c){S(r,t,{name:"annotations",handleItemDefaults:a,fullLayout:c.fullLayout})};function a(n,r,t,c){function s(p,v){return A.coerce(n,r,e,p,v)}function i(p){var v=p+"axis",f={_fullLayout:{}};return f._fullLayout[v]=t[v],g.coercePosition(r,f,s,p,p,.5)}var x=s("visible");!x||(M(n,r,c.fullLayout,s),i("x"),i("y"),i("z"),A.noneOrAll(n,r,["x","y","z"]),r.xref="x",r.yref="y",r.zref="z",s("xanchor"),s("yanchor"),s("xshift"),s("yshift"),r.showarrow&&(r.axref="pixel",r.ayref="pixel",s("ax",-10),s("ay",-30),A.noneOrAll(n,r,["ax","ay"])))}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../annotations/common_defaults":353,"./attributes":359}],362:[function(d,ee,te){var A=d("../annotations/draw").drawRaw,g=d("../../plots/gl3d/project"),S=["x","y","z"];ee.exports=function(e){for(var a=e.fullSceneLayout,n=e.dataScale,r=a.annotations,t=0;t<r.length;t++){for(var c=r[t],s=!1,i=0;i<3;i++){var x=S[i],p=c[x],v=a[x+"axis"],f=v.r2fraction(p);if(f<0||f>1){s=!0;break}}s?e.fullLayout._infolayer.select(".annotation-"+e.id+'[data-index="'+t+'"]').remove():(c._pdata=g(e.glplot.cameraParams,[a.xaxis.r2l(c.x)*n[0],a.yaxis.r2l(c.y)*n[1],a.zaxis.r2l(c.z)*n[2]]),A(e.graphDiv,c,t,e.id,c._xa,c._ya))}}},{"../../plots/gl3d/project":616,"../annotations/draw":356}],363:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib");ee.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:d("./attributes")}}},layoutAttributes:d("./attributes"),handleDefaults:d("./defaults"),includeBasePlot:S,convert:d("./convert"),draw:d("./draw")};function S(M,e){var a=A.subplotsRegistry.gl3d;if(!!a)for(var n=a.attrRegex,r=Object.keys(M),t=0;t<r.length;t++){var c=r[t];n.test(c)&&(M[c].annotations||[]).length&&(g.pushUnique(e._basePlotModules,a),g.pushUnique(e._subplots.gl3d,c))}}},{"../../lib":515,"../../registry":647,"./attributes":359,"./convert":360,"./defaults":361,"./draw":362}],364:[function(d,ee,te){ee.exports=d("world-calendars/dist/main"),d("world-calendars/dist/plus"),d("world-calendars/dist/calendars/chinese"),d("world-calendars/dist/calendars/coptic"),d("world-calendars/dist/calendars/discworld"),d("world-calendars/dist/calendars/ethiopian"),d("world-calendars/dist/calendars/hebrew"),d("world-calendars/dist/calendars/islamic"),d("world-calendars/dist/calendars/julian"),d("world-calendars/dist/calendars/mayan"),d("world-calendars/dist/calendars/nanakshahi"),d("world-calendars/dist/calendars/nepali"),d("world-calendars/dist/calendars/persian"),d("world-calendars/dist/calendars/taiwan"),d("world-calendars/dist/calendars/thai"),d("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":333,"world-calendars/dist/calendars/coptic":334,"world-calendars/dist/calendars/discworld":335,"world-calendars/dist/calendars/ethiopian":336,"world-calendars/dist/calendars/hebrew":337,"world-calendars/dist/calendars/islamic":338,"world-calendars/dist/calendars/julian":339,"world-calendars/dist/calendars/mayan":340,"world-calendars/dist/calendars/nanakshahi":341,"world-calendars/dist/calendars/nepali":342,"world-calendars/dist/calendars/persian":343,"world-calendars/dist/calendars/taiwan":344,"world-calendars/dist/calendars/thai":345,"world-calendars/dist/calendars/ummalqura":346,"world-calendars/dist/main":347,"world-calendars/dist/plus":348}],365:[function(d,ee,te){var A=d("./calendars"),g=d("../../lib"),S=d("../../constants/numerical"),M=S.EPOCHJD,e=S.ONEDAY,a={valType:"enumerated",values:g.sortObjectKeys(A.calendars),editType:"calc",dflt:"gregorian"},n=function(h,b,u,L){var T={};return T[u]=a,g.coerce(h,b,T,u,L)},r=function(h,b,u,L){for(var T=0;T<u.length;T++)n(h,b,u[T]+"calendar",L.calendar)},t={chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},c={chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},s={chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},i="##",x={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:i,w:i,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}};function p(h,b,u){for(var L=Math.floor((b+.05)/e)+M,T=f(u).fromJD(L),k=0,P,z,I,D,R;(k=h.indexOf("%",k))!==-1;)P=h.charAt(k+1),P==="0"||P==="-"||P==="_"?(I=3,z=h.charAt(k+2),P==="_"&&(P="-")):(z=P,P="0",I=2),D=x[z],D?(D===i?R=i:R=T.formatDate(D[P]),h=h.substr(0,k)+R+h.substr(k+I),k+=R.length):k+=I;return h}var v={};function f(h){var b=v[h];return b||(b=v[h]=A.instance(h),b)}function y(h){return g.extendFlat({},a,{description:h})}function o(h){return"Sets the calendar system to use with `"+h+"` date data."}var m={xcalendar:y(o("x"))},l=g.extendFlat({},m,{ycalendar:y(o("y"))}),w=g.extendFlat({},l,{zcalendar:y(o("z"))}),_=y(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));ee.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:l,bar:l,box:l,heatmap:l,contour:l,histogram:l,histogram2d:l,histogram2dcontour:l,scatter3d:w,surface:w,mesh3d:w,scattergl:l,ohlc:m,candlestick:m},layout:{calendar:y(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:_},yaxis:{calendar:_},scene:{xaxis:{calendar:_},yaxis:{calendar:_},zaxis:{calendar:_}},polar:{radialaxis:{calendar:_}}},transforms:{filter:{valuecalendar:y(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:y(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:a,handleDefaults:n,handleTraceDefaults:r,CANONICAL_SUNDAY:c,CANONICAL_TICK:t,DFLTRANGE:s,getCal:f,worldCalFmt:p}},{"../../constants/numerical":491,"../../lib":515,"./calendars":364}],366:[function(d,ee,te){te.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],te.defaultLine="#444",te.lightLine="#eee",te.background="#fff",te.borderLine="#BEC8D9",te.lightFraction=100*(14-4)/(15-4)},{}],367:[function(d,ee,te){var A=d("tinycolor2"),g=d("fast-isnumeric"),S=d("../../lib/array").isTypedArray,M=ee.exports={},e=d("./attributes");M.defaults=e.defaults;var a=M.defaultLine=e.defaultLine;M.lightLine=e.lightLine;var n=M.background=e.background;M.tinyRGB=function(t){var c=t.toRgb();return"rgb("+Math.round(c.r)+", "+Math.round(c.g)+", "+Math.round(c.b)+")"},M.rgb=function(t){return M.tinyRGB(A(t))},M.opacity=function(t){return t?A(t).getAlpha():0},M.addOpacity=function(t,c){var s=A(t).toRgb();return"rgba("+Math.round(s.r)+", "+Math.round(s.g)+", "+Math.round(s.b)+", "+c+")"},M.combine=function(t,c){var s=A(t).toRgb();if(s.a===1)return A(t).toRgbString();var i=A(c||n).toRgb(),x=i.a===1?i:{r:255*(1-i.a)+i.r*i.a,g:255*(1-i.a)+i.g*i.a,b:255*(1-i.a)+i.b*i.a},p={r:x.r*(1-s.a)+s.r*s.a,g:x.g*(1-s.a)+s.g*s.a,b:x.b*(1-s.a)+s.b*s.a};return A(p).toRgbString()},M.contrast=function(t,c,s){var i=A(t);i.getAlpha()!==1&&(i=A(M.combine(t,n)));var x=i.isDark()?c?i.lighten(c):n:s?i.darken(s):a;return x.toString()},M.stroke=function(t,c){var s=A(c);t.style({stroke:M.tinyRGB(s),"stroke-opacity":s.getAlpha()})},M.fill=function(t,c){var s=A(c);t.style({fill:M.tinyRGB(s),"fill-opacity":s.getAlpha()})},M.clean=function(t){if(!(!t||typeof t!="object")){var c=Object.keys(t),s,i,x,p;for(s=0;s<c.length;s++)if(x=c[s],p=t[x],x.substr(x.length-5)==="color")if(Array.isArray(p))for(i=0;i<p.length;i++)p[i]=r(p[i]);else t[x]=r(p);else if(x.substr(x.length-10)==="colorscale"&&Array.isArray(p))for(i=0;i<p.length;i++)Array.isArray(p[i])&&(p[i][1]=r(p[i][1]));else if(Array.isArray(p)){var v=p[0];if(!Array.isArray(v)&&v&&typeof v=="object")for(i=0;i<p.length;i++)M.clean(p[i])}else p&&typeof p=="object"&&!S(p)&&M.clean(p)}};function r(t){if(g(t)||typeof t!="string")return t;var c=t.trim();if(c.substr(0,3)!=="rgb")return t;var s=c.match(/^rgba?\s*\(([^()]*)\)$/);if(!s)return t;var i=s[1].trim().split(/\s*[\s,]\s*/),x=c.charAt(3)==="a"&&i.length===4;if(!x&&i.length!==3)return t;for(var p=0;p<i.length;p++){if(!i[p].length||(i[p]=Number(i[p]),!(i[p]>=0)))return t;if(p===3)i[p]>1&&(i[p]=1);else if(i[p]>=1)return t}var v=Math.round(i[0]*255)+", "+Math.round(i[1]*255)+", "+Math.round(i[2]*255);return x?"rgba("+v+", "+i[3]+")":"rgb("+v+")"}},{"../../lib/array":497,"./attributes":366,"fast-isnumeric":190,tinycolor2:313}],368:[function(d,ee,te){var A=d("../../plots/cartesian/layout_attributes"),g=d("../../plots/font_attributes"),S=d("../../lib/extend").extendFlat,M=d("../../plot_api/edit_types").overrideAll;ee.exports=M({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:A.linecolor,outlinewidth:A.linewidth,bordercolor:A.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:A.tickmode,nticks:A.nticks,tick0:A.tick0,dtick:A.dtick,tickvals:A.tickvals,ticktext:A.ticktext,ticks:S({},A.ticks,{dflt:""}),ticklabeloverflow:S({},A.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:A.ticklen,tickwidth:A.tickwidth,tickcolor:A.tickcolor,ticklabelstep:A.ticklabelstep,showticklabels:A.showticklabels,tickfont:g({}),tickangle:A.tickangle,tickformat:A.tickformat,tickformatstops:A.tickformatstops,tickprefix:A.tickprefix,showtickprefix:A.showtickprefix,ticksuffix:A.ticksuffix,showticksuffix:A.showticksuffix,separatethousands:A.separatethousands,exponentformat:A.exponentformat,minexponent:A.minexponent,showexponent:A.showexponent,title:{text:{valType:"string"},font:g({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:g({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],369:[function(d,ee,te){ee.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],370:[function(d,ee,te){var A=d("../../lib"),g=d("../../plot_api/plot_template"),S=d("../../plots/cartesian/tick_value_defaults"),M=d("../../plots/cartesian/tick_mark_defaults"),e=d("../../plots/cartesian/tick_label_defaults"),a=d("../../plots/cartesian/prefix_suffix_defaults"),n=d("./attributes");ee.exports=function(t,c,s){var i=g.newContainer(c,"colorbar"),x=t.colorbar||{};function p(T,k){return A.coerce(x,i,n,T,k)}var v=s.margin||{t:0,b:0,l:0,r:0},f=s.width-v.l-v.r,y=s.height-v.t-v.b,o=p("orientation"),m=o==="v",l=p("thicknessmode");p("thickness",l==="fraction"?30/(m?f:y):30);var w=p("lenmode");p("len",w==="fraction"?1:m?y:f),p("x",m?1.02:.5),p("xanchor",m?"left":"center"),p("xpad"),p("y",m?.5:1.02),p("yanchor",m?"middle":"bottom"),p("ypad"),A.noneOrAll(x,i,["x","y"]),p("outlinecolor"),p("outlinewidth"),p("bordercolor"),p("borderwidth"),p("bgcolor");var _=A.coerce(x,i,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:m?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");p("ticklabeloverflow",_.indexOf("inside")!==-1?"hide past domain":"hide past div"),S(x,i,p,"linear");var h=s.font,b={outerTicks:!1,font:h};_.indexOf("inside")!==-1&&(b.bgColor="black"),a(x,i,p,"linear",b),e(x,i,p,"linear",b),M(x,i,p,"linear",b),p("title.text",s._dfltTitle.colorbar);var u=i.tickfont,L=A.extendFlat({},u,{color:h.color,size:A.bigFont(u.size)});A.coerceFont(p,"title.font",L),p("title.side",m?"top":"right")}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"./attributes":368}],371:[function(d,ee,te){var A=d("@plotly/d3"),g=d("tinycolor2"),S=d("../../plots/plots"),M=d("../../registry"),e=d("../../plots/cartesian/axes"),a=d("../dragelement"),n=d("../../lib"),r=n.strTranslate,t=d("../../lib/extend").extendFlat,c=d("../../lib/setcursor"),s=d("../drawing"),i=d("../color"),x=d("../titles"),p=d("../../lib/svg_text_utils"),v=d("../colorscale/helpers").flipScale,f=d("../../plots/cartesian/axis_defaults"),y=d("../../plots/cartesian/position_defaults"),o=d("../../plots/cartesian/layout_attributes"),m=d("../../constants/alignment"),l=m.LINE_SPACING,w=m.FROM_TL,_=m.FROM_BR,h=d("./constants").cn;function b(z){var I=z._fullLayout,D=I._infolayer.selectAll("g."+h.colorbar).data(u(z),function(R){return R._id});D.enter().append("g").attr("class",function(R){return R._id}).classed(h.colorbar,!0),D.each(function(R){var O=A.select(this);n.ensureSingle(O,"rect",h.cbbg),n.ensureSingle(O,"g",h.cbfills),n.ensureSingle(O,"g",h.cblines),n.ensureSingle(O,"g",h.cbaxis,function(N){N.classed(h.crisp,!0)}),n.ensureSingle(O,"g",h.cbtitleunshift,function(N){N.append("g").classed(h.cbtitle,!0)}),n.ensureSingle(O,"rect",h.cboutline);var F=L(O,R,z);F&&F.then&&(z._promises||[]).push(F),z._context.edits.colorbarPosition&&T(O,R,z)}),D.exit().each(function(R){S.autoMargin(z,R._id)}).remove(),D.order()}function u(z){var I=z._fullLayout,D=z.calcdata,R=[],O,F,N,G;function K(X){return t(X,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function W(){typeof G.calc=="function"?G.calc(z,N,O):(O._fillgradient=F.reversescale?v(F.colorscale):F.colorscale,O._zrange=[F[G.min],F[G.max]])}for(var Y=0;Y<D.length;Y++){var re=D[Y];N=re[0].trace;var ue=N._module.colorbar;if(N.visible===!0&&ue)for(var j=Array.isArray(ue),q=j?ue:[ue],V=0;V<q.length;V++){G=q[V];var U=G.container;F=U?N[U]:N,F&&F.showscale&&(O=K(F.colorbar),O._id="cb"+N.uid+(j&&U?"-"+U:""),O._traceIndex=N.index,O._propPrefix=(U?U+".":"")+"colorbar.",O._meta=N._meta,W(),R.push(O))}}for(var $ in I._colorAxes)if(F=I[$],F.showscale){var ne=I._colorAxes[$];O=K(F.colorbar),O._id="cb"+$,O._propPrefix=$+".colorbar.",O._meta=I._meta,G={min:"cmin",max:"cmax"},ne[0]!=="heatmap"&&(N=ne[1],G.calc=N._module.colorbar.calc),W(),R.push(O)}return R}function L(z,I,D){var R=I.orientation==="v",O=I.len,F=I.lenmode,N=I.thickness,G=I.thicknessmode,K=I.outlinewidth,W=I.borderwidth,Y=I.bgcolor,re=I.xanchor,ue=I.yanchor,j=I.xpad,q=I.ypad,V=I.x,U=R?I.y:1-I.y,$=D._fullLayout,ne=$._size,X=I._fillcolor,Q=I._line,ie=I.title,se=ie.side,ae=I._zrange||A.extent((typeof X=="function"?X:Q.color).domain()),oe=typeof Q.color=="function"?Q.color:function(){return Q.color},be=typeof X=="function"?X:function(){return X},ce=I._levels,de=k(D,I,ae),ye=de.fill,ge=de.line,me=Math.round(N*(G==="fraction"?R?ne.w:ne.h:1)),Ee=me/(R?ne.w:ne.h),Pe=Math.round(O*(F==="fraction"?R?ne.h:ne.w:1)),Ne=Pe/(R?ne.h:ne.w),we=Math.round(R?V*ne.w+j:U*ne.h+q),ke={center:.5,right:1}[re]||0,Xe={top:1,middle:.5}[ue]||0,He=R?V-ke*Ee:U-Xe*Ee,Ie=R?U-Xe*Ne:V-ke*Ne,De=Math.round(R?ne.h*(1-Ie):ne.w*Ie);I._lenFrac=Ne,I._thickFrac=Ee,I._uFrac=He,I._vFrac=Ie;var Ge=I._axis=P(D,I,ae);Ge.position=Ee+(R?V+j/ne.w:U+q/ne.h);var ht=["top","bottom"].indexOf(se)!==-1;if(R&&ht&&(Ge.title.side=se,Ge.titlex=V+j/ne.w,Ge.titley=Ie+(ie.side==="top"?Ne-q/ne.h:q/ne.h)),!R&&!ht&&(Ge.title.side=se,Ge.titley=U+q/ne.h,Ge.titlex=Ie+j/ne.w),Q.color&&I.tickmode==="auto"){Ge.tickmode="linear",Ge.tick0=ce.start;var Rt=ce.size,Kt=n.constrain(Pe/50,4,15)+1,It=(ae[1]-ae[0])/((I.nticks||Kt)*Rt);if(It>1){var Mt=Math.pow(10,Math.floor(Math.log(It)/Math.LN10));Rt*=Mt*n.roundUp(It/Mt,[2,5,10]),(Math.abs(ce.start)/ce.size+1e-6)%1<2e-6&&(Ge.tick0=0)}Ge.dtick=Rt}Ge.domain=R?[Ie+q/ne.h,Ie+Ne-q/ne.h]:[Ie+j/ne.w,Ie+Ne-j/ne.w],Ge.setScale(),z.attr("transform",r(Math.round(ne.l),Math.round(ne.t)));var Yt=z.select("."+h.cbtitleunshift).attr("transform",r(-Math.round(ne.l),-Math.round(ne.t))),zt=Ge.ticklabelposition,St=Ge.title.font.size,Ye=z.select("."+h.cbaxis),rt,Ve=0,Ae=0;function Ue(wt,Ut){var Dt={propContainer:Ge,propName:I._propPrefix+"title",traceIndex:I._traceIndex,_meta:I._meta,placeholder:$._dfltTitle.colorbar,containerGroup:z.select("."+h.cbtitle)},Nt=wt.charAt(0)==="h"?wt.substr(1):"h"+wt;z.selectAll("."+Nt+",."+Nt+"-math-group").remove(),x.draw(D,wt,t(Dt,Ut||{}))}function Ze(){if(R&&ht||!R&&!ht){var wt,Ut;se==="top"&&(wt=j+ne.l+ne.w*V,Ut=q+ne.t+ne.h*(1-Ie-Ne)+3+St*.75),se==="bottom"&&(wt=j+ne.l+ne.w*V,Ut=q+ne.t+ne.h*(1-Ie)-3-St*.25),se==="right"&&(Ut=q+ne.t+ne.h*U+3+St*.75,wt=j+ne.l+ne.w*Ie),Ue(Ge._id+"title",{attributes:{x:wt,y:Ut,"text-anchor":R?"start":"middle"}})}}function Qe(){if(R&&!ht||!R&&ht){var wt=Ge.position||0,Ut=Ge._offset+Ge._length/2,Dt,Nt;if(se==="right")Nt=Ut,Dt=ne.l+ne.w*wt+10+St*(Ge.showticklabels?1:.5);else if(Dt=Ut,se==="bottom"&&(Nt=ne.t+ne.h*wt+10+(zt.indexOf("inside")===-1?Ge.tickfont.size:0)+(Ge.ticks!=="intside"&&I.ticklen||0)),se==="top"){var Xt=ie.text.split("<br>").length;Nt=ne.t+ne.h*wt+10-me-l*St*Xt}Ue((R?"h":"v")+Ge._id+"title",{avoid:{selection:A.select(D).selectAll("g."+Ge._id+"tick"),side:se,offsetTop:R?0:ne.t,offsetLeft:R?ne.l:0,maxShift:R?$.width:$.height},attributes:{x:Dt,y:Nt,"text-anchor":"middle"},transform:{rotate:R?-90:0,offset:0}})}}function _t(){if(!R&&!ht||R&&ht){var wt=z.select("."+h.cbtitle),Ut=wt.select("text"),Dt=[-K/2,K/2],Nt=wt.select(".h"+Ge._id+"title-math-group").node(),Xt=15.6;Ut.node()&&(Xt=parseInt(Ut.node().style.fontSize,10)*l);var Ht;if(Nt?(Ht=s.bBox(Nt),Ae=Ht.width,Ve=Ht.height,Ve>Xt&&(Dt[1]-=(Ve-Xt)/2)):Ut.node()&&!Ut.classed(h.jsPlaceholder)&&(Ht=s.bBox(Ut.node()),Ae=Ht.width,Ve=Ht.height),R){if(Ve){if(Ve+=5,se==="top")Ge.domain[1]-=Ve/ne.h,Dt[1]*=-1;else{Ge.domain[0]+=Ve/ne.h;var ar=p.lineCount(Ut);Dt[1]+=(1-ar)*Xt}wt.attr("transform",r(Dt[0],Dt[1])),Ge.setScale()}}else Ae&&(se==="right"&&(Ge.domain[0]+=(Ae+St/2)/ne.w),wt.attr("transform",r(Dt[0],Dt[1])),Ge.setScale())}z.selectAll("."+h.cbfills+",."+h.cblines).attr("transform",R?r(0,Math.round(ne.h*(1-Ge.domain[1]))):r(Math.round(ne.w*Ge.domain[0]),0)),Ye.attr("transform",R?r(0,Math.round(-ne.t)):r(Math.round(-ne.l),0));var Vr=z.select("."+h.cbfills).selectAll("rect."+h.cbfill).attr("style","").data(ye);Vr.enter().append("rect").classed(h.cbfill,!0).style("stroke","none"),Vr.exit().remove();var nn=ae.map(Ge.c2p).map(Math.round).sort(function(ur,wr){return ur-wr});Vr.each(function(ur,wr){var $e=[wr===0?ae[0]:(ye[wr]+ye[wr-1])/2,wr===ye.length-1?ae[1]:(ye[wr]+ye[wr+1])/2].map(Ge.c2p).map(Math.round);R&&($e[1]=n.constrain($e[1]+($e[1]>$e[0])?1:-1,nn[0],nn[1]));var Je=A.select(this).attr(R?"x":"y",we).attr(R?"y":"x",A.min($e)).attr(R?"width":"height",Math.max(me,2)).attr(R?"height":"width",Math.max(A.max($e)-A.min($e),2));if(I._fillgradient)s.gradient(Je,D,I._id,R?"vertical":"horizontalreversed",I._fillgradient,"fill");else{var it=be(ur).replace("e-","");Je.attr("fill",g(it).toHexString())}});var jr=z.select("."+h.cblines).selectAll("path."+h.cbline).data(Q.color&&Q.width?ge:[]);jr.enter().append("path").classed(h.cbline,!0),jr.exit().remove(),jr.each(function(ur){var wr=we,$e=Math.round(Ge.c2p(ur))+Q.width/2%1;A.select(this).attr("d","M"+(R?wr+","+$e:$e+","+wr)+(R?"h":"v")+me).call(s.lineGroupStyle,Q.width,oe(ur),Q.dash)}),Ye.selectAll("g."+Ge._id+"tick,path").remove();var at=we+me+(K||0)/2-(I.ticks==="outside"?1:0),$t=e.calcTicks(Ge),Zt=e.getTickSigns(Ge)[2];return e.drawTicks(D,Ge,{vals:Ge.ticks==="inside"?e.clipEnds(Ge,$t):$t,layer:Ye,path:e.makeTickPath(Ge,at,Zt),transFn:e.makeTransTickFn(Ge)}),e.drawLabels(D,Ge,{vals:$t,layer:Ye,transFn:e.makeTransTickLabelFn(Ge),labelFns:e.makeLabelFns(Ge,at)})}function gt(){var wt,Ut=me+K/2;zt.indexOf("inside")===-1&&(wt=s.bBox(Ye.node()),Ut+=R?wt.width:wt.height),rt=Yt.select("text");var Dt=0,Nt=R&&se==="top",Xt=!R&&se==="right",Ht=0;if(rt.node()&&!rt.classed(h.jsPlaceholder)){var ar,Vr=Yt.select(".h"+Ge._id+"title-math-group").node();Vr&&(R&&ht||!R&&!ht)?(wt=s.bBox(Vr),Dt=wt.width,ar=wt.height):(wt=s.bBox(Yt.node()),Dt=wt.right-ne.l-(R?we:De),ar=wt.bottom-ne.t-(R?De:we),!R&&se==="top"&&(Ut+=wt.height,Ht=wt.height)),Xt&&(rt.attr("transform",r(Dt/2+St/2,0)),Dt*=2),Ut=Math.max(Ut,R?Dt:ar)}var nn=(R?j:q)*2+Ut+W+K/2,jr=0;!R&&ie.text&&ue==="bottom"&&U<=0&&(jr=nn/2,nn+=jr,Ht+=jr),$._hColorbarMoveTitle=jr,$._hColorbarMoveCBTitle=Ht;var at=W+K;z.select("."+h.cbbg).attr("x",(R?we:De)-at/2-(R?j:0)).attr("y",(R?De:we)-(R?Pe:q+Ht-jr)).attr(R?"width":"height",Math.max(nn-jr,2)).attr(R?"height":"width",Math.max(Pe+at,2)).call(i.fill,Y).call(i.stroke,I.bordercolor).style("stroke-width",W);var $t=Xt?Math.max(Dt-10,0):0;if(z.selectAll("."+h.cboutline).attr("x",(R?we:De+j)+$t).attr("y",(R?De+q-Pe:we)+(Nt?Ve:0)).attr(R?"width":"height",Math.max(me,2)).attr(R?"height":"width",Math.max(Pe-(R?2*q+Ve:2*j+$t),2)).call(i.stroke,I.outlinecolor).style({fill:"none","stroke-width":K}),z.attr("transform",r(ne.l-(R?ke*nn:0),ne.t-(R?0:(1-Xe)*nn-Ht))),!R&&(W||g(Y).getAlpha()&&!g.equals($.paper_bgcolor,Y))){var Zt=Ye.selectAll("text"),ur=Zt[0].length,wr=z.select("."+h.cbbg).node(),$e=s.bBox(wr),Je=s.getTranslate(z),it=2;Zt.each(function(st,ct){var At=0,dt=ur-1;if(ct===At||ct===dt){var Ct=s.bBox(this),Gt=s.getTranslate(this),rr;if(ct===dt){var kr=Ct.right+Gt.x,br=$e.right+Je.x+De-W-it+V;rr=br-kr,rr>0&&(rr=0)}else if(ct===At){var Ar=Ct.left+Gt.x,Wr=$e.left+Je.x+De+W+it;rr=Wr-Ar,rr<0&&(rr=0)}rr&&(ur<3?this.setAttribute("transform","translate("+rr+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var lt={},Tt=w[re],Bt=_[re],Ce=w[ue],Me=_[ue],nt=nn-me;R?(F==="pixels"?(lt.y=U,lt.t=Pe*Ce,lt.b=Pe*Me):(lt.t=lt.b=0,lt.yt=U+O*Ce,lt.yb=U-O*Me),G==="pixels"?(lt.x=V,lt.l=nn*Tt,lt.r=nn*Bt):(lt.l=nt*Tt,lt.r=nt*Bt,lt.xl=V-N*Tt,lt.xr=V+N*Bt)):(F==="pixels"?(lt.x=V,lt.l=Pe*Tt,lt.r=Pe*Bt):(lt.l=lt.r=0,lt.xl=V+O*Tt,lt.xr=V-O*Bt),G==="pixels"?(lt.y=1-U,lt.t=nn*Ce,lt.b=nn*Me):(lt.t=nt*Ce,lt.b=nt*Me,lt.yt=U-N*Ce,lt.yb=U+N*Me)),S.autoMargin(D,I._id,lt)}return n.syncOrAsync([S.previousPromises,Ze,_t,Qe,S.previousPromises,gt],D)}function T(z,I,D){var R=I.orientation==="v",O=D._fullLayout,F=O._size,N,G,K;a.init({element:z.node(),gd:D,prepFn:function(){N=z.attr("transform"),c(z)},moveFn:function(W,Y){z.attr("transform",N+r(W,Y)),G=a.align((R?I._uFrac:I._vFrac)+W/F.w,R?I._thickFrac:I._lenFrac,0,1,I.xanchor),K=a.align((R?I._vFrac:1-I._uFrac)-Y/F.h,R?I._lenFrac:I._thickFrac,0,1,I.yanchor);var re=a.getCursor(G,K,I.xanchor,I.yanchor);c(z,re)},doneFn:function(){if(c(z),G!==void 0&&K!==void 0){var W={};W[I._propPrefix+"x"]=G,W[I._propPrefix+"y"]=K,I._traceIndex!==void 0?M.call("_guiRestyle",D,W,I._traceIndex):M.call("_guiRelayout",D,W)}}})}function k(z,I,D){var R=I._levels,O=[],F=[],N,G,K=R.end+R.size/100,W=R.size,Y=1.001*D[0]-.001*D[1],re=1.001*D[1]-.001*D[0];for(G=0;G<1e5&&(N=R.start+G*W,!(W>0?N>=K:N<=K));G++)N>Y&&N<re&&O.push(N);if(I._fillgradient)F=[0];else if(typeof I._fillcolor=="function"){var ue=I._filllevels;if(ue)for(K=ue.end+ue.size/100,W=ue.size,G=0;G<1e5&&(N=ue.start+G*W,!(W>0?N>=K:N<=K));G++)N>D[0]&&N<D[1]&&F.push(N);else F=O.map(function(j){return j-R.size/2}),F.push(F[F.length-1]+R.size)}else I._fillcolor&&typeof I._fillcolor=="string"&&(F=[0]);return R.size<0&&(O.reverse(),F.reverse()),{line:O,fill:F}}function P(z,I,D){var R=z._fullLayout,O=I.orientation==="v",F={type:"linear",range:D,tickmode:I.tickmode,nticks:I.nticks,tick0:I.tick0,dtick:I.dtick,tickvals:I.tickvals,ticktext:I.ticktext,ticks:I.ticks,ticklen:I.ticklen,tickwidth:I.tickwidth,tickcolor:I.tickcolor,showticklabels:I.showticklabels,ticklabelposition:I.ticklabelposition,ticklabeloverflow:I.ticklabeloverflow,ticklabelstep:I.ticklabelstep,tickfont:I.tickfont,tickangle:I.tickangle,tickformat:I.tickformat,exponentformat:I.exponentformat,minexponent:I.minexponent,separatethousands:I.separatethousands,showexponent:I.showexponent,showtickprefix:I.showtickprefix,tickprefix:I.tickprefix,showticksuffix:I.showticksuffix,ticksuffix:I.ticksuffix,title:I.title,showline:!0,anchor:"free",side:O?"right":"bottom",position:1},N=O?"y":"x",G={type:"linear",_id:N+I._id},K={letter:N,font:R.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:R.calendar};function W(Y,re){return n.coerce(F,G,o,Y,re)}return f(F,G,W,K,R),y(F,G,W,K),G}ee.exports={draw:b}},{"../../constants/alignment":483,"../../lib":515,"../../lib/extend":505,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"../../plots/plots":628,"../../registry":647,"../color":367,"../colorscale/helpers":378,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":369,"@plotly/d3":58,tinycolor2:313}],372:[function(d,ee,te){var A=d("../../lib");ee.exports=function(S){return A.isPlainObject(S.colorbar)}},{"../../lib":515}],373:[function(d,ee,te){ee.exports={moduleType:"component",name:"colorbar",attributes:d("./attributes"),supplyDefaults:d("./defaults"),draw:d("./draw").draw,hasColorbar:d("./has_colorbar")}},{"./attributes":368,"./defaults":370,"./draw":371,"./has_colorbar":372}],374:[function(d,ee,te){var A=d("../colorbar/attributes"),g=d("../../lib/regex").counter,S=d("../../lib/sort_object_keys"),M=d("./scales.js").scales;S(M),ee.exports=function(a,n){a=a||"",n=n||{};var r=n.cLetter||"c";"onlyIfNumerical"in n?n.onlyIfNumerical:Boolean(a);var t="noScale"in n?n.noScale:a==="marker.line",c="showScaleDflt"in n?n.showScaleDflt:r==="z",s=typeof n.colorscaleDflt=="string"?M[n.colorscaleDflt]:null,i=n.editTypeOverride||"",x;"colorAttr"in n?(x=n.colorAttr,n.colorAttr):x={z:"z",c:"color"}[r];var p=r+"auto",v=r+"min",f=r+"max",y=r+"mid",o={};o[v]=o[f]=void 0;var m={};m[p]=!1;var l={};return x==="color"&&(l.color={valType:"color",arrayOk:!0,editType:i||"style"},n.anim&&(l.color.anim=!0)),l[p]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:o},l[v]={valType:"number",dflt:null,editType:i||"plot",impliedEdits:m},l[f]={valType:"number",dflt:null,editType:i||"plot",impliedEdits:m},l[y]={valType:"number",dflt:null,editType:"calc",impliedEdits:o},l.colorscale={valType:"colorscale",editType:"calc",dflt:s,impliedEdits:{autocolorscale:!1}},l.autocolorscale={valType:"boolean",dflt:n.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},l.reversescale={valType:"boolean",dflt:!1,editType:"plot"},t||(l.showscale={valType:"boolean",dflt:c,editType:"calc"},l.colorbar=A),n.noColorAxis||(l.coloraxis={valType:"subplotid",regex:g("coloraxis"),dflt:null,editType:"calc"}),l}},{"../../lib/regex":532,"../../lib/sort_object_keys":538,"../colorbar/attributes":368,"./scales.js":382}],375:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib"),S=d("./helpers").extractOpts;ee.exports=function(e,a,n){var r=e._fullLayout,t=n.vals,c=n.containerStr,s=c?g.nestedProperty(a,c).get():a,i=S(s),x=i.auto!==!1,p=i.min,v=i.max,f=i.mid,y=function(){return g.aggNums(Math.min,null,t)},o=function(){return g.aggNums(Math.max,null,t)};if(p===void 0?p=y():x&&(s._colorAx&&A(p)?p=Math.min(p,y()):p=y()),v===void 0?v=o():x&&(s._colorAx&&A(v)?v=Math.max(v,o()):v=o()),x&&f!==void 0&&(v-f>f-p?p=f-(v-f):v-f<f-p&&(v=f+(f-p))),p===v&&(p-=.5,v+=.5),i._sync("min",p),i._sync("max",v),i.autocolorscale){var m;p*v<0?m=r.colorscale.diverging:p>=0?m=r.colorscale.sequential:m=r.colorscale.sequentialminus,i._sync("colorscale",m)}}},{"../../lib":515,"./helpers":378,"fast-isnumeric":190}],376:[function(d,ee,te){var A=d("../../lib"),g=d("./helpers").hasColorscale,S=d("./helpers").extractOpts;ee.exports=function(e,a){function n(p,v){var f=p["_"+v];f!==void 0&&(p[v]=f)}function r(p,v){var f=v.container?A.nestedProperty(p,v.container).get():p;if(f)if(f.coloraxis)f._colorAx=a[f.coloraxis];else{var y=S(f),o=y.auto;(o||y.min===void 0)&&n(f,v.min),(o||y.max===void 0)&&n(f,v.max),y.autocolorscale&&n(f,"colorscale")}}for(var t=0;t<e.length;t++){var c=e[t],s=c._module.colorbar;if(s)if(Array.isArray(s))for(var i=0;i<s.length;i++)r(c,s[i]);else r(c,s);g(c,"marker.line")&&r(c,{container:"marker.line",min:"cmin",max:"cmax"})}for(var x in a._colorAxes)r(a[x],{min:"cmin",max:"cmax"})}},{"../../lib":515,"./helpers":378}],377:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib"),S=d("../colorbar/has_colorbar"),M=d("../colorbar/defaults"),e=d("./scales").isValid,a=d("../../registry").traceIs;function n(r,t){var c=t.slice(0,t.length-1);return t?g.nestedProperty(r,c).get()||{}:r}ee.exports=function r(t,c,s,i,x){var p=x.prefix,v=x.cLetter,f="_module"in c,y=n(t,p),o=n(c,p),m=n(c._template||{},p)||{},l=function(){return delete t.coloraxis,delete c.coloraxis,r(t,c,s,i,x)};if(f){var w=s._colorAxes||{},_=i(p+"coloraxis");if(_){var h=a(c,"contour")&&g.nestedProperty(c,"contours.coloring").get()||"heatmap",b=w[_];b?(b[2].push(l),b[0]!==h&&(b[0]=!1,g.warn(["Ignoring coloraxis:",_,"setting","as it is linked to incompatible colorscales."].join(" ")))):w[_]=[h,c,[l]];return}}var u=y[v+"min"],L=y[v+"max"],T=A(u)&&A(L)&&u<L,k=i(p+v+"auto",!T);k?i(p+v+"mid"):(i(p+v+"min"),i(p+v+"max"));var P=y.colorscale,z=m.colorscale,I;if(P!==void 0&&(I=!e(P)),z!==void 0&&(I=!e(z)),i(p+"autocolorscale",I),i(p+"colorscale"),i(p+"reversescale"),p!=="marker.line."){var D;p&&f&&(D=S(y));var R=i(p+"showscale",D);R&&(p&&m&&(o._template=m),M(y,o,s))}}},{"../../lib":515,"../../registry":647,"../colorbar/defaults":370,"../colorbar/has_colorbar":372,"./scales":382,"fast-isnumeric":190}],378:[function(d,ee,te){var A=d("@plotly/d3"),g=d("tinycolor2"),S=d("fast-isnumeric"),M=d("../../lib"),e=d("../color"),a=d("./scales").isValid;function n(f,y,o){var m=y?M.nestedProperty(f,y).get()||{}:f,l=m[o||"color"],w=!1;if(M.isArrayOrTypedArray(l)){for(var _=0;_<l.length;_++)if(S(l[_])){w=!0;break}}return M.isPlainObject(m)&&(w||m.showscale===!0||S(m.cmin)&&S(m.cmax)||a(m.colorscale)||M.isPlainObject(m.colorbar))}var r=["showscale","autocolorscale","colorscale","reversescale","colorbar"],t=["min","max","mid","auto"];function c(f){var y=f._colorAx,o=y||f,m={},l,w,_;for(w=0;w<r.length;w++)_=r[w],m[_]=o[_];if(y)for(l="c",w=0;w<t.length;w++)_=t[w],m[_]=o["c"+_];else{var h;for(w=0;w<t.length;w++){if(_=t[w],h="c"+_,h in o){m[_]=o[h];continue}h="z"+_,h in o&&(m[_]=o[h])}l=h.charAt(0)}return m._sync=function(b,u){var L=t.indexOf(b)!==-1?l+b:b;o[L]=o["_"+L]=u},m}function s(f){for(var y=c(f),o=y.min,m=y.max,l=y.reversescale?i(y.colorscale):y.colorscale,w=l.length,_=new Array(w),h=new Array(w),b=0;b<w;b++){var u=l[b];_[b]=o+u[0]*(m-o),h[b]=u[1]}return{domain:_,range:h}}function i(f){for(var y=f.length,o=new Array(y),m=y-1,l=0;m>=0;m--,l++){var w=f[m];o[l]=[1-w[0],w[1]]}return o}function x(f,y){y=y||{};for(var o=f.domain,m=f.range,l=m.length,w=new Array(l),_=0;_<l;_++){var h=g(m[_]).toRgb();w[_]=[h.r,h.g,h.b,h.a]}var b=A.scale.linear().domain(o).range(w).clamp(!0),u=y.noNumericCheck,L=y.returnArray,T;return u&&L?T=b:u?T=function(k){return v(b(k))}:L?T=function(k){return S(k)?b(k):g(k).isValid()?k:e.defaultLine}:T=function(k){return S(k)?v(b(k)):g(k).isValid()?k:e.defaultLine},T.domain=b.domain,T.range=function(){return m},T}function p(f,y){return x(s(f),y)}function v(f){var y={r:f[0],g:f[1],b:f[2],a:f[3]};return g(y).toRgbString()}ee.exports={hasColorscale:n,extractOpts:c,extractScale:s,flipScale:i,makeColorScaleFunc:x,makeColorScaleFuncFromTrace:p}},{"../../lib":515,"../color":367,"./scales":382,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],379:[function(d,ee,te){var A=d("./scales"),g=d("./helpers");ee.exports={moduleType:"component",name:"colorscale",attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyLayoutDefaults:d("./layout_defaults"),handleDefaults:d("./defaults"),crossTraceDefaults:d("./cross_trace_defaults"),calc:d("./calc"),scales:A.scales,defaultScale:A.defaultScale,getScale:A.get,isValidScale:A.isValid,hasColorscale:g.hasColorscale,extractOpts:g.extractOpts,extractScale:g.extractScale,flipScale:g.flipScale,makeColorScaleFunc:g.makeColorScaleFunc,makeColorScaleFuncFromTrace:g.makeColorScaleFuncFromTrace}},{"./attributes":374,"./calc":375,"./cross_trace_defaults":376,"./defaults":377,"./helpers":378,"./layout_attributes":380,"./layout_defaults":381,"./scales":382}],380:[function(d,ee,te){var A=d("../../lib/extend").extendFlat,g=d("./attributes"),S=d("./scales").scales;ee.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:S.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:S.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:S.RdBu,editType:"calc"}},coloraxis:A({_isSubplotObj:!0,editType:"calc"},g("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":505,"./attributes":374,"./scales":382}],381:[function(d,ee,te){var A=d("../../lib"),g=d("../../plot_api/plot_template"),S=d("./layout_attributes"),M=d("./defaults");ee.exports=function(a,n){function r(f,y){return A.coerce(a,n,S,f,y)}r("colorscale.sequential"),r("colorscale.sequentialminus"),r("colorscale.diverging");var t=n._colorAxes,c,s;function i(f,y){return A.coerce(c,s,S.coloraxis,f,y)}for(var x in t){var p=t[x];if(p[0])c=a[x]||{},s=g.newContainer(n,x,"coloraxis"),s._name=x,M(c,s,n,i,{prefix:"",cLetter:"c"});else{for(var v=0;v<p[2].length;v++)p[2][v]();delete n._colorAxes[x]}}}},{"../../lib":515,"../../plot_api/plot_template":555,"./defaults":377,"./layout_attributes":380}],382:[function(d,ee,te){var A=d("tinycolor2"),g={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},S=g.RdBu;function M(n,r){if(r||(r=S),!n)return r;function t(){try{n=g[n]||JSON.parse(n)}catch{n=r}}return typeof n=="string"&&(t(),typeof n=="string"&&t()),e(n)?n:r}function e(n){var r=0;if(!Array.isArray(n)||n.length<2||!n[0]||!n[n.length-1]||+n[0][0]!=0||+n[n.length-1][0]!=1)return!1;for(var t=0;t<n.length;t++){var c=n[t];if(c.length!==2||+c[0]<r||!A(c[1]).isValid())return!1;r=+c[0]}return!0}function a(n){return g[n]!==void 0?!0:e(n)}ee.exports={scales:g,defaultScale:S,get:M,isValid:a}},{tinycolor2:313}],383:[function(d,ee,te){ee.exports=function(g,S,M,e,a){var n=(g-M)/(e-M),r=n+S/(e-M),t=(n+r)/2;return a==="left"||a==="bottom"?n:a==="center"||a==="middle"?t:a==="right"||a==="top"?r:n<2/3-t?n:r>4/3-t?r:t}},{}],384:[function(d,ee,te){var A=d("../../lib"),g=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];ee.exports=function(M,e,a,n){return a==="left"?M=0:a==="center"?M=1:a==="right"?M=2:M=A.constrain(Math.floor(M*3),0,2),n==="bottom"?e=0:n==="middle"?e=1:n==="top"?e=2:e=A.constrain(Math.floor(e*3),0,2),g[e][M]}},{"../../lib":515}],385:[function(d,ee,te){te.selectMode=function(A){return A==="lasso"||A==="select"},te.drawMode=function(A){return A==="drawclosedpath"||A==="drawopenpath"||A==="drawline"||A==="drawrect"||A==="drawcircle"},te.openMode=function(A){return A==="drawline"||A==="drawopenpath"},te.rectMode=function(A){return A==="select"||A==="drawline"||A==="drawrect"||A==="drawcircle"},te.freeMode=function(A){return A==="lasso"||A==="drawclosedpath"||A==="drawopenpath"},te.selectingOrDrawing=function(A){return te.freeMode(A)||te.rectMode(A)}},{}],386:[function(d,ee,te){var A=d("mouse-event-offset"),g=d("has-hover"),S=d("has-passive-events"),M=d("../../lib").removeElement,e=d("../../plots/cartesian/constants"),a=ee.exports={};a.align=d("./align"),a.getCursor=d("./cursor");var n=d("./unhover");a.unhover=n.wrapped,a.unhoverRaw=n.raw,a.init=function(s){var i=s.gd,x=1,p=i._context.doubleClickDelay,v=s.element,f,y,o,m,l,w,_,h;i._mouseDownTime||(i._mouseDownTime=0),v.style.pointerEvents="all",v.onmousedown=L,S?(v._ontouchstart&&v.removeEventListener("touchstart",v._ontouchstart),v._ontouchstart=L,v.addEventListener("touchstart",L,{passive:!1})):v.ontouchstart=L;function b(P,z,I){return Math.abs(P)<I&&(P=0),Math.abs(z)<I&&(z=0),[P,z]}var u=s.clampFn||b;function L(P){i._dragged=!1,i._dragging=!0;var z=t(P);f=z[0],y=z[1],_=P.target,w=P,h=P.buttons===2||P.ctrlKey,typeof P.clientX>"u"&&typeof P.clientY>"u"&&(P.clientX=f,P.clientY=y),o=new Date().getTime(),o-i._mouseDownTime<p?x+=1:(x=1,i._mouseDownTime=o),s.prepFn&&s.prepFn(P,f,y),g&&!h?(l=r(),l.style.cursor=window.getComputedStyle(v).cursor):g||(l=document,m=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(v).cursor),document.addEventListener("mouseup",k),document.addEventListener("touchend",k),s.dragmode!==!1&&(P.preventDefault(),document.addEventListener("mousemove",T),document.addEventListener("touchmove",T,{passive:!1}))}function T(P){P.preventDefault();var z=t(P),I=s.minDrag||e.MINDRAG,D=u(z[0]-f,z[1]-y,I),R=D[0],O=D[1];(R||O)&&(i._dragged=!0,a.unhover(i,P)),i._dragged&&s.moveFn&&!h&&(i._dragdata={element:v,dx:R,dy:O},s.moveFn(R,O))}function k(P){if(delete i._dragdata,s.dragmode!==!1&&(P.preventDefault(),document.removeEventListener("mousemove",T),document.removeEventListener("touchmove",T)),document.removeEventListener("mouseup",k),document.removeEventListener("touchend",k),g?M(l):m&&(l.documentElement.style.cursor=m,m=null),!i._dragging){i._dragged=!1;return}if(i._dragging=!1,new Date().getTime()-i._mouseDownTime>p&&(x=Math.max(x-1,1)),i._dragged)s.doneFn&&s.doneFn();else if(s.clickFn&&s.clickFn(x,w),!h){var z;try{z=new MouseEvent("click",P)}catch{var I=t(P);z=document.createEvent("MouseEvents"),z.initMouseEvent("click",P.bubbles,P.cancelable,P.view,P.detail,P.screenX,P.screenY,I[0],I[1],P.ctrlKey,P.altKey,P.shiftKey,P.metaKey,P.button,P.relatedTarget)}_.dispatchEvent(z)}i._dragging=!1,i._dragged=!1}};function r(){var c=document.createElement("div");c.className="dragcover";var s=c.style;return s.position="fixed",s.left=0,s.right=0,s.top=0,s.bottom=0,s.zIndex=999999999,s.background="none",document.body.appendChild(c),c}a.coverSlip=r;function t(c){return A(c.changedTouches?c.changedTouches[0]:c,document.body)}},{"../../lib":515,"../../plots/cartesian/constants":573,"./align":383,"./cursor":384,"./unhover":387,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],387:[function(d,ee,te){var A=d("../../lib/events"),g=d("../../lib/throttle"),S=d("../../lib/dom").getGraphDiv,M=d("../fx/constants"),e=ee.exports={};e.wrapped=function(a,n,r){a=S(a),a._fullLayout&&g.clear(a._fullLayout._uid+M.HOVERID),e.raw(a,n,r)},e.raw=function(n,r){var t=n._fullLayout,c=n._hoverdata;r||(r={}),!(r.target&&!n._dragged&&A.triggerHandler(n,"plotly_beforehover",r)===!1)&&(t._hoverlayer.selectAll("g").remove(),t._hoverlayer.selectAll("line").remove(),t._hoverlayer.selectAll("circle").remove(),n._hoverdata=void 0,r.target&&c&&n.emit("plotly_unhover",{event:r,points:c}))}},{"../../lib/dom":503,"../../lib/events":504,"../../lib/throttle":542,"../fx/constants":401}],388:[function(d,ee,te){te.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},te.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],389:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=g.numberFormat,M=d("fast-isnumeric"),e=d("tinycolor2"),a=d("../../registry"),n=d("../color"),r=d("../colorscale"),t=g.strTranslate,c=d("../../lib/svg_text_utils"),s=d("../../constants/xmlns_namespaces"),i=d("../../constants/alignment"),x=i.LINE_SPACING,p=d("../../constants/interactions").DESELECTDIM,v=d("../../traces/scatter/subtypes"),f=d("../../traces/scatter/make_bubble_size_func"),y=d("../../components/fx/helpers").appendArrayPointValue,o=ee.exports={};o.font=function(ge,me,Ee,Pe){g.isPlainObject(me)&&(Pe=me.color,Ee=me.size,me=me.family),me&&ge.style("font-family",me),Ee+1&&ge.style("font-size",Ee+"px"),Pe&&ge.call(n.fill,Pe)},o.setPosition=function(ge,me,Ee){ge.attr("x",me).attr("y",Ee)},o.setSize=function(ge,me,Ee){ge.attr("width",me).attr("height",Ee)},o.setRect=function(ge,me,Ee,Pe,Ne){ge.call(o.setPosition,me,Ee).call(o.setSize,Pe,Ne)},o.translatePoint=function(ge,me,Ee,Pe){var Ne=Ee.c2p(ge.x),we=Pe.c2p(ge.y);if(M(Ne)&&M(we)&&me.node())me.node().nodeName==="text"?me.attr("x",Ne).attr("y",we):me.attr("transform",t(Ne,we));else return!1;return!0},o.translatePoints=function(ge,me,Ee){ge.each(function(Pe){var Ne=A.select(this);o.translatePoint(Pe,Ne,me,Ee)})},o.hideOutsideRangePoint=function(ge,me,Ee,Pe,Ne,we){me.attr("display",Ee.isPtWithinRange(ge,Ne)&&Pe.isPtWithinRange(ge,we)?null:"none")},o.hideOutsideRangePoints=function(ge,me){if(!!me._hasClipOnAxisFalse){var Ee=me.xaxis,Pe=me.yaxis;ge.each(function(Ne){var we=Ne[0].trace,ke=we.xcalendar,Xe=we.ycalendar,He=a.traceIs(we,"bar-like")?".bartext":".point,.textpoint";ge.selectAll(He).each(function(Ie){o.hideOutsideRangePoint(Ie,A.select(this),Ee,Pe,ke,Xe)})})}},o.crispRound=function(ge,me,Ee){return!me||!M(me)?Ee||0:ge._context.staticPlot?me:me<1?1:Math.round(me)},o.singleLineStyle=function(ge,me,Ee,Pe,Ne){me.style("fill","none");var we=(((ge||[])[0]||{}).trace||{}).line||{},ke=Ee||we.width||0,Xe=Ne||we.dash||"";n.stroke(me,Pe||we.color),o.dashLine(me,Xe,ke)},o.lineGroupStyle=function(ge,me,Ee,Pe){ge.style("fill","none").each(function(Ne){var we=(((Ne||[])[0]||{}).trace||{}).line||{},ke=me||we.width||0,Xe=Pe||we.dash||"";A.select(this).call(n.stroke,Ee||we.color).call(o.dashLine,Xe,ke)})},o.dashLine=function(ge,me,Ee){Ee=+Ee||0,me=o.dashStyle(me,Ee),ge.style({"stroke-dasharray":me,"stroke-width":Ee+"px"})},o.dashStyle=function(ge,me){me=+me||1;var Ee=Math.max(me,3);return ge==="solid"?ge="":ge==="dot"?ge=Ee+"px,"+Ee+"px":ge==="dash"?ge=3*Ee+"px,"+3*Ee+"px":ge==="longdash"?ge=5*Ee+"px,"+5*Ee+"px":ge==="dashdot"?ge=3*Ee+"px,"+Ee+"px,"+Ee+"px,"+Ee+"px":ge==="longdashdot"&&(ge=5*Ee+"px,"+2*Ee+"px,"+Ee+"px,"+2*Ee+"px"),ge};function m(ge,me,Ee){var Pe=me.fillpattern,Ne=Pe&&o.getPatternAttr(Pe.shape,0,"");if(Ne){var we=o.getPatternAttr(Pe.bgcolor,0,null),ke=o.getPatternAttr(Pe.fgcolor,0,null),Xe=Pe.fgopacity,He=o.getPatternAttr(Pe.size,0,8),Ie=o.getPatternAttr(Pe.solidity,0,.3),De=me.uid;o.pattern(ge,"point",Ee,De,Ne,He,Ie,void 0,Pe.fillmode,we,ke,Xe)}else me.fillcolor&&ge.call(n.fill,me.fillcolor)}o.singleFillStyle=function(ge,me){var Ee=A.select(ge.node()),Pe=Ee.data(),Ne=((Pe[0]||[])[0]||{}).trace||{};m(ge,Ne,me)},o.fillGroupStyle=function(ge,me){ge.style("stroke-width",0).each(function(Ee){var Pe=A.select(this);Ee[0].trace&&m(Pe,Ee[0].trace,me)})};var l=d("./symbol_defs");o.symbolNames=[],o.symbolFuncs=[],o.symbolBackOffs=[],o.symbolNeedLines={},o.symbolNoDot={},o.symbolNoFill={},o.symbolList=[],Object.keys(l).forEach(function(ge){var me=l[ge],Ee=me.n;o.symbolList.push(Ee,String(Ee),ge,Ee+100,String(Ee+100),ge+"-open"),o.symbolNames[Ee]=ge,o.symbolFuncs[Ee]=me.f,o.symbolBackOffs[Ee]=me.backoff||0,me.needLine&&(o.symbolNeedLines[Ee]=!0),me.noDot?o.symbolNoDot[Ee]=!0:o.symbolList.push(Ee+200,String(Ee+200),ge+"-dot",Ee+300,String(Ee+300),ge+"-open-dot"),me.noFill&&(o.symbolNoFill[Ee]=!0)});var w=o.symbolNames.length,_="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";o.symbolNumber=function(ge){if(M(ge))ge=+ge;else if(typeof ge=="string"){var me=0;ge.indexOf("-open")>0&&(me=100,ge=ge.replace("-open","")),ge.indexOf("-dot")>0&&(me+=200,ge=ge.replace("-dot","")),ge=o.symbolNames.indexOf(ge),ge>=0&&(ge+=me)}return ge%100>=w||ge>=400?0:Math.floor(Math.max(ge,0))};function h(ge,me,Ee,Pe){var Ne=ge%100;return o.symbolFuncs[Ne](me,Ee,Pe)+(ge>=200?_:"")}var b={x1:1,x2:0,y1:0,y2:0},u={x1:0,x2:0,y1:1,y2:0},L=S("~f"),T={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:b},horizontalreversed:{node:"linearGradient",attrs:b,reversed:!0},vertical:{node:"linearGradient",attrs:u},verticalreversed:{node:"linearGradient",attrs:u,reversed:!0}};o.gradient=function(ge,me,Ee,Pe,Ne,we){for(var ke=Ne.length,Xe=T[Pe],He=new Array(ke),Ie=0;Ie<ke;Ie++)Xe.reversed?He[ke-1-Ie]=[L((1-Ne[Ie][0])*100),Ne[Ie][1]]:He[Ie]=[L(Ne[Ie][0]*100),Ne[Ie][1]];var De=me._fullLayout,Ge="g"+De._uid+"-"+Ee,ht=De._defs.select(".gradients").selectAll("#"+Ge).data([Pe+He.join(";")],g.identity);ht.exit().remove(),ht.enter().append(Xe.node).each(function(){var Rt=A.select(this);Xe.attrs&&Rt.attr(Xe.attrs),Rt.attr("id",Ge);var Kt=Rt.selectAll("stop").data(He);Kt.exit().remove(),Kt.enter().append("stop"),Kt.each(function(It){var Mt=e(It[1]);A.select(this).attr({offset:It[0]+"%","stop-color":n.tinyRGB(Mt),"stop-opacity":Mt.getAlpha()})})}),ge.style(we,q(Ge,me)).style(we+"-opacity",null),ge.classed("gradient_filled",!0)},o.pattern=function(ge,me,Ee,Pe,Ne,we,ke,Xe,He,Ie,De,Ge){var ht=me==="legend";Xe&&(He==="overlay"?(Ie=Xe,De=n.contrast(Ie)):(Ie=void 0,De=Xe));var Rt=Ee._fullLayout,Kt="p"+Rt._uid+"-"+Pe,It,Mt,Yt=function(wt,Ut,Dt,Nt,Xt){return Nt+(Xt-Nt)*(wt-Ut)/(Dt-Ut)},zt,St,Ye,rt,Ve={},Ae=e(De),Ue=n.tinyRGB(Ae),Ze=Ae.getAlpha(),Qe=Ge*Ze;switch(Ne){case"/":It=we*Math.sqrt(2),Mt=we*Math.sqrt(2),zt="M-"+It/4+","+Mt/4+"l"+It/2+",-"+Mt/2+"M0,"+Mt+"L"+It+",0M"+It/4*3+","+Mt/4*5+"l"+It/2+",-"+Mt/2,St=ke*we,rt="path",Ve={d:zt,opacity:Qe,stroke:Ue,"stroke-width":St+"px"};break;case"\\":It=we*Math.sqrt(2),Mt=we*Math.sqrt(2),zt="M"+It/4*3+",-"+Mt/4+"l"+It/2+","+Mt/2+"M0,0L"+It+","+Mt+"M-"+It/4+","+Mt/4*3+"l"+It/2+","+Mt/2,St=ke*we,rt="path",Ve={d:zt,opacity:Qe,stroke:Ue,"stroke-width":St+"px"};break;case"x":It=we*Math.sqrt(2),Mt=we*Math.sqrt(2),zt="M-"+It/4+","+Mt/4+"l"+It/2+",-"+Mt/2+"M0,"+Mt+"L"+It+",0M"+It/4*3+","+Mt/4*5+"l"+It/2+",-"+Mt/2+"M"+It/4*3+",-"+Mt/4+"l"+It/2+","+Mt/2+"M0,0L"+It+","+Mt+"M-"+It/4+","+Mt/4*3+"l"+It/2+","+Mt/2,St=we-we*Math.sqrt(1-ke),rt="path",Ve={d:zt,opacity:Qe,stroke:Ue,"stroke-width":St+"px"};break;case"|":It=we,Mt=we,rt="path",zt="M"+It/2+",0L"+It/2+","+Mt,St=ke*we,rt="path",Ve={d:zt,opacity:Qe,stroke:Ue,"stroke-width":St+"px"};break;case"-":It=we,Mt=we,rt="path",zt="M0,"+Mt/2+"L"+It+","+Mt/2,St=ke*we,rt="path",Ve={d:zt,opacity:Qe,stroke:Ue,"stroke-width":St+"px"};break;case"+":It=we,Mt=we,rt="path",zt="M"+It/2+",0L"+It/2+","+Mt+"M0,"+Mt/2+"L"+It+","+Mt/2,St=we-we*Math.sqrt(1-ke),rt="path",Ve={d:zt,opacity:Qe,stroke:Ue,"stroke-width":St+"px"};break;case".":It=we,Mt=we,ke<Math.PI/4?Ye=Math.sqrt(ke*we*we/Math.PI):Ye=Yt(ke,Math.PI/4,1,we/2,we/Math.sqrt(2)),rt="circle",Ve={cx:It/2,cy:Mt/2,r:Ye,opacity:Qe,fill:Ue};break}var _t=[Ne||"noSh",Ie||"noBg",De||"noFg",we,ke].join(";"),gt=Rt._defs.select(".patterns").selectAll("#"+Kt).data([_t],g.identity);gt.exit().remove(),gt.enter().append("pattern").each(function(){var wt=A.select(this);if(wt.attr({id:Kt,width:It+"px",height:Mt+"px",patternUnits:"userSpaceOnUse",patternTransform:ht?"scale(0.8)":""}),Ie){var Ut=e(Ie),Dt=n.tinyRGB(Ut),Nt=Ut.getAlpha(),Xt=wt.selectAll("rect").data([0]);Xt.exit().remove(),Xt.enter().append("rect").attr({width:It+"px",height:Mt+"px",fill:Dt,"fill-opacity":Nt})}var Ht=wt.selectAll(rt).data([0]);Ht.exit().remove(),Ht.enter().append(rt).attr(Ve)}),ge.style("fill",q(Kt,Ee)).style("fill-opacity",null),ge.classed("pattern_filled",!0)},o.initGradients=function(ge){var me=ge._fullLayout,Ee=g.ensureSingle(me._defs,"g","gradients");Ee.selectAll("linearGradient,radialGradient").remove(),A.select(ge).selectAll(".gradient_filled").classed("gradient_filled",!1)},o.initPatterns=function(ge){var me=ge._fullLayout,Ee=g.ensureSingle(me._defs,"g","patterns");Ee.selectAll("pattern").remove(),A.select(ge).selectAll(".pattern_filled").classed("pattern_filled",!1)},o.getPatternAttr=function(ge,me,Ee){return ge&&g.isArrayOrTypedArray(ge)?me<ge.length?ge[me]:Ee:ge},o.pointStyle=function(ge,me,Ee){if(!!ge.size()){var Pe=o.makePointStyleFns(me);ge.each(function(Ne){o.singlePointStyle(Ne,A.select(this),me,Pe,Ee)})}},o.singlePointStyle=function(ge,me,Ee,Pe,Ne){var we=Ee.marker,ke=we.line;if(me.style("opacity",Pe.selectedOpacityFn?Pe.selectedOpacityFn(ge):ge.mo===void 0?we.opacity:ge.mo),Pe.ms2mrc){var Xe;ge.ms==="various"||we.size==="various"?Xe=3:Xe=Pe.ms2mrc(ge.ms),ge.mrc=Xe,Pe.selectedSizeFn&&(Xe=ge.mrc=Pe.selectedSizeFn(ge));var He=o.symbolNumber(ge.mx||we.symbol)||0;ge.om=He%200>=100;var Ie=ye(ge,Ee),De=$(ge,Ee);me.attr("d",h(He,Xe,Ie,De))}var Ge=!1,ht,Rt,Kt;if(ge.so)Kt=ke.outlierwidth,Rt=ke.outliercolor,ht=we.outliercolor;else{var It=(ke||{}).width;Kt=(ge.mlw+1||It+1||(ge.trace?(ge.trace.marker.line||{}).width:0)+1)-1||0,"mlc"in ge?Rt=ge.mlcc=Pe.lineScale(ge.mlc):g.isArrayOrTypedArray(ke.color)?Rt=n.defaultLine:Rt=ke.color,g.isArrayOrTypedArray(we.color)&&(ht=n.defaultLine,Ge=!0),"mc"in ge?ht=ge.mcc=Pe.markerScale(ge.mc):ht=we.color||"rgba(0,0,0,0)",Pe.selectedColorFn&&(ht=Pe.selectedColorFn(ge))}if(ge.om)me.call(n.stroke,ht).style({"stroke-width":(Kt||1)+"px",fill:"none"});else{me.style("stroke-width",(ge.isBlank?0:Kt)+"px");var Mt=we.gradient,Yt=ge.mgt;Yt?Ge=!0:Yt=Mt&&Mt.type,g.isArrayOrTypedArray(Yt)&&(Yt=Yt[0],T[Yt]||(Yt=0));var zt=we.pattern,St=zt&&o.getPatternAttr(zt.shape,ge.i,"");if(Yt&&Yt!=="none"){var Ye=ge.mgc;Ye?Ge=!0:Ye=Mt.color;var rt=Ee.uid;Ge&&(rt+="-"+ge.i),o.gradient(me,Ne,rt,Yt,[[0,Ye],[1,ht]],"fill")}else if(St){var Ve=o.getPatternAttr(zt.bgcolor,ge.i,null),Ae=o.getPatternAttr(zt.fgcolor,ge.i,null),Ue=zt.fgopacity,Ze=o.getPatternAttr(zt.size,ge.i,8),Qe=o.getPatternAttr(zt.solidity,ge.i,.3),_t=ge.mcc||g.isArrayOrTypedArray(zt.shape)||g.isArrayOrTypedArray(zt.bgcolor)||g.isArrayOrTypedArray(zt.size)||g.isArrayOrTypedArray(zt.solidity),gt=Ee.uid;_t&&(gt+="-"+ge.i),o.pattern(me,"point",Ne,gt,St,Ze,Qe,ge.mcc,zt.fillmode,Ve,Ae,Ue)}else n.fill(me,ht);Kt&&n.stroke(me,Rt)}},o.makePointStyleFns=function(ge){var me={},Ee=ge.marker;return me.markerScale=o.tryColorscale(Ee,""),me.lineScale=o.tryColorscale(Ee,"line"),a.traceIs(ge,"symbols")&&(me.ms2mrc=v.isBubble(ge)?f(ge):function(){return(Ee.size||6)/2}),ge.selectedpoints&&g.extendFlat(me,o.makeSelectedPointStyleFns(ge)),me},o.makeSelectedPointStyleFns=function(ge){var me={},Ee=ge.selected||{},Pe=ge.unselected||{},Ne=ge.marker||{},we=Ee.marker||{},ke=Pe.marker||{},Xe=Ne.opacity,He=we.opacity,Ie=ke.opacity,De=He!==void 0,Ge=Ie!==void 0;(g.isArrayOrTypedArray(Xe)||De||Ge)&&(me.selectedOpacityFn=function(Ye){var rt=Ye.mo===void 0?Ne.opacity:Ye.mo;return Ye.selected?De?He:rt:Ge?Ie:p*rt});var ht=Ne.color,Rt=we.color,Kt=ke.color;(Rt||Kt)&&(me.selectedColorFn=function(Ye){var rt=Ye.mcc||ht;return Ye.selected?Rt||rt:Kt||rt});var It=Ne.size,Mt=we.size,Yt=ke.size,zt=Mt!==void 0,St=Yt!==void 0;return a.traceIs(ge,"symbols")&&(zt||St)&&(me.selectedSizeFn=function(Ye){var rt=Ye.mrc||It/2;return Ye.selected?zt?Mt/2:rt:St?Yt/2:rt}),me},o.makeSelectedTextStyleFns=function(ge){var me={},Ee=ge.selected||{},Pe=ge.unselected||{},Ne=ge.textfont||{},we=Ee.textfont||{},ke=Pe.textfont||{},Xe=Ne.color,He=we.color,Ie=ke.color;return me.selectedTextColorFn=function(De){var Ge=De.tc||Xe;return De.selected?He||Ge:Ie||(He?Ge:n.addOpacity(Ge,p))},me},o.selectedPointStyle=function(ge,me){if(!(!ge.size()||!me.selectedpoints)){var Ee=o.makeSelectedPointStyleFns(me),Pe=me.marker||{},Ne=[];Ee.selectedOpacityFn&&Ne.push(function(we,ke){we.style("opacity",Ee.selectedOpacityFn(ke))}),Ee.selectedColorFn&&Ne.push(function(we,ke){n.fill(we,Ee.selectedColorFn(ke))}),Ee.selectedSizeFn&&Ne.push(function(we,ke){var Xe=ke.mx||Pe.symbol||0,He=Ee.selectedSizeFn(ke);we.attr("d",h(o.symbolNumber(Xe),He,ye(ke,me),$(ke,me))),ke.mrc2=He}),Ne.length&&ge.each(function(we){for(var ke=A.select(this),Xe=0;Xe<Ne.length;Xe++)Ne[Xe](ke,we)})}},o.tryColorscale=function(ge,me){var Ee=me?g.nestedProperty(ge,me).get():ge;if(Ee){var Pe=Ee.color;if((Ee.colorscale||Ee._colorAx)&&g.isArrayOrTypedArray(Pe))return r.makeColorScaleFuncFromTrace(Ee)}return g.identity};var k={start:1,end:-1,middle:0,bottom:1,top:-1};function P(ge,me,Ee,Pe,Ne){var we=A.select(ge.node().parentNode),ke=me.indexOf("top")!==-1?"top":me.indexOf("bottom")!==-1?"bottom":"middle",Xe=me.indexOf("left")!==-1?"end":me.indexOf("right")!==-1?"start":"middle",He=Pe?Pe/.8+1:0,Ie=(c.lineCount(ge)-1)*x+1,De=k[Xe]*He,Ge=Ee*.75+k[ke]*He+(k[ke]-1)*Ie*Ee/2;ge.attr("text-anchor",Xe),Ne||we.attr("transform",t(De,Ge))}function z(ge,me){var Ee=ge.ts||me.textfont.size;return M(Ee)&&Ee>0?Ee:0}o.textPointStyle=function(ge,me,Ee){if(!!ge.size()){var Pe;if(me.selectedpoints){var Ne=o.makeSelectedTextStyleFns(me);Pe=Ne.selectedTextColorFn}var we=me.texttemplate,ke=Ee._fullLayout;ge.each(function(Xe){var He=A.select(this),Ie=we?g.extractOption(Xe,me,"txt","texttemplate"):g.extractOption(Xe,me,"tx","text");if(!Ie&&Ie!==0){He.remove();return}if(we){var De=me._module.formatLabels,Ge=De?De(Xe,me,ke):{},ht={};y(ht,me,Xe.i);var Rt=me._meta||{};Ie=g.texttemplateString(Ie,Ge,ke._d3locale,ht,Xe,Rt)}var Kt=Xe.tp||me.textposition,It=z(Xe,me),Mt=Pe?Pe(Xe):Xe.tc||me.textfont.color;He.call(o.font,Xe.tf||me.textfont.family,It,Mt).text(Ie).call(c.convertToTspans,Ee).call(P,Kt,It,Xe.mrc)})}},o.selectedTextStyle=function(ge,me){if(!(!ge.size()||!me.selectedpoints)){var Ee=o.makeSelectedTextStyleFns(me);ge.each(function(Pe){var Ne=A.select(this),we=Ee.selectedTextColorFn(Pe),ke=Pe.tp||me.textposition,Xe=z(Pe,me);n.fill(Ne,we);var He=a.traceIs(me,"bar-like");P(Ne,ke,Xe,Pe.mrc2||Pe.mrc,He)})}};var I=.5;o.smoothopen=function(ge,me){if(ge.length<3)return"M"+ge.join("L");var Ee="M"+ge[0],Pe=[],Ne;for(Ne=1;Ne<ge.length-1;Ne++)Pe.push(G(ge[Ne-1],ge[Ne],ge[Ne+1],me));for(Ee+="Q"+Pe[0][0]+" "+ge[1],Ne=2;Ne<ge.length-1;Ne++)Ee+="C"+Pe[Ne-2][1]+" "+Pe[Ne-1][0]+" "+ge[Ne];return Ee+="Q"+Pe[ge.length-3][1]+" "+ge[ge.length-1],Ee},o.smoothclosed=function(ge,me){if(ge.length<3)return"M"+ge.join("L")+"Z";var Ee="M"+ge[0],Pe=ge.length-1,Ne=[G(ge[Pe],ge[0],ge[1],me)],we;for(we=1;we<Pe;we++)Ne.push(G(ge[we-1],ge[we],ge[we+1],me));for(Ne.push(G(ge[Pe-1],ge[Pe],ge[0],me)),we=1;we<=Pe;we++)Ee+="C"+Ne[we-1][1]+" "+Ne[we][0]+" "+ge[we];return Ee+="C"+Ne[Pe][1]+" "+Ne[0][0]+" "+ge[0]+"Z",Ee};var D,R;function O(ge,me,Ee){return Ee&&(ge=Y(ge)),me?N(ge[1]):F(ge[0])}function F(ge){var me=A.round(ge,2);return D=me,me}function N(ge){var me=A.round(ge,2);return R=me,me}function G(ge,me,Ee,Pe){var Ne=ge[0]-me[0],we=ge[1]-me[1],ke=Ee[0]-me[0],Xe=Ee[1]-me[1],He=Math.pow(Ne*Ne+we*we,I/2),Ie=Math.pow(ke*ke+Xe*Xe,I/2),De=(Ie*Ie*Ne-He*He*ke)*Pe,Ge=(Ie*Ie*we-He*He*Xe)*Pe,ht=3*Ie*(He+Ie),Rt=3*He*(He+Ie);return[[F(me[0]+(ht&&De/ht)),N(me[1]+(ht&&Ge/ht))],[F(me[0]-(Rt&&De/Rt)),N(me[1]-(Rt&&Ge/Rt))]]}var K={hv:function(ge,me,Ee){return"H"+F(me[0])+"V"+O(me,1,Ee)},vh:function(ge,me,Ee){return"V"+N(me[1])+"H"+O(me,0,Ee)},hvh:function(ge,me,Ee){return"H"+F((ge[0]+me[0])/2)+"V"+N(me[1])+"H"+O(me,0,Ee)},vhv:function(ge,me,Ee){return"V"+N((ge[1]+me[1])/2)+"H"+F(me[0])+"V"+O(me,1,Ee)}},W=function(ge,me,Ee){return"L"+O(me,0,Ee)+","+O(me,1,Ee)};o.steps=function(ge){var me=K[ge]||W;return function(Ee){for(var Pe="M"+F(Ee[0][0])+","+N(Ee[0][1]),Ne=Ee.length,we=1;we<Ne;we++)Pe+=me(Ee[we-1],Ee[we],we===Ne-1);return Pe}};function Y(ge,me){var Ee=ge.backoff,Pe=ge.trace,Ne=ge.d,we=ge.i;if(Ee&&Pe&&Pe.marker&&Pe.marker.angle%360===0&&Pe.line&&Pe.line.shape!=="spline"){var ke=g.isArrayOrTypedArray(Ee),Xe=ge,He=me?me[0]:D||0,Ie=me?me[1]:R||0,De=Xe[0],Ge=Xe[1],ht=De-He,Rt=Ge-Ie,Kt=Math.atan2(Rt,ht),It=ke?Ee[we]:Ee;if(It==="auto"){var Mt=Xe.i;Pe.type==="scatter"&&Mt--;var Yt=Xe.marker;It=Yt?o.symbolBackOffs[o.symbolNumber(Yt.symbol)]*Yt.size:0,It+=o.getMarkerStandoff(Ne[Mt],Pe)||0}var zt=De-It*Math.cos(Kt),St=Ge-It*Math.sin(Kt);(zt<=De&&zt>=He||zt>=De&&zt<=He)&&(St<=Ge&&St>=Ie||St>=Ge&&St<=Ie)&&(ge=[zt,St])}return ge}o.applyBackoff=Y,o.makeTester=function(){var ge=g.ensureSingleById(A.select("body"),"svg","js-plotly-tester",function(Ee){Ee.attr(s.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),me=g.ensureSingle(ge,"path","js-reference-point",function(Ee){Ee.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});o.tester=ge,o.testref=me},o.savedBBoxes={};var re=0,ue=1e4;o.bBox=function(ge,me,Ee){Ee||(Ee=j(ge));var Pe;if(Ee){if(Pe=o.savedBBoxes[Ee],Pe)return g.extendFlat({},Pe)}else if(ge.childNodes.length===1){var Ne=ge.childNodes[0];if(Ee=j(Ne),Ee){var we=+Ne.getAttribute("x")||0,ke=+Ne.getAttribute("y")||0,Xe=Ne.getAttribute("transform");if(!Xe){var He=o.bBox(Ne,!1,Ee);return we&&(He.left+=we,He.right+=we),ke&&(He.top+=ke,He.bottom+=ke),He}if(Ee+="~"+we+"~"+ke+"~"+Xe,Pe=o.savedBBoxes[Ee],Pe)return g.extendFlat({},Pe)}}var Ie,De;me?Ie=ge:(De=o.tester.node(),Ie=ge.cloneNode(!0),De.appendChild(Ie)),A.select(Ie).attr("transform",null).call(c.positionText,0,0);var Ge=Ie.getBoundingClientRect(),ht=o.testref.node().getBoundingClientRect();me||De.removeChild(Ie);var Rt={height:Ge.height,width:Ge.width,left:Ge.left-ht.left,top:Ge.top-ht.top,right:Ge.right-ht.left,bottom:Ge.bottom-ht.top};return re>=ue&&(o.savedBBoxes={},re=0),Ee&&(o.savedBBoxes[Ee]=Rt),re++,g.extendFlat({},Rt)};function j(ge){var me=ge.getAttribute("data-unformatted");if(me!==null)return me+ge.getAttribute("data-math")+ge.getAttribute("text-anchor")+ge.getAttribute("style")}o.setClipUrl=function(ge,me,Ee){ge.attr("clip-path",q(me,Ee))};function q(ge,me){if(!ge)return null;var Ee=me._context,Pe=Ee._exportedPlot?"":Ee._baseUrl||"";return Pe?"url('"+Pe+"#"+ge+"')":"url(#"+ge+")"}o.getTranslate=function(ge){var me=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,Ee=ge.attr?"attr":"getAttribute",Pe=ge[Ee]("transform")||"",Ne=Pe.replace(me,function(we,ke,Xe){return[ke,Xe].join(" ")}).split(" ");return{x:+Ne[0]||0,y:+Ne[1]||0}},o.setTranslate=function(ge,me,Ee){var Pe=/(\btranslate\(.*?\);?)/,Ne=ge.attr?"attr":"getAttribute",we=ge.attr?"attr":"setAttribute",ke=ge[Ne]("transform")||"";return me=me||0,Ee=Ee||0,ke=ke.replace(Pe,"").trim(),ke+=t(me,Ee),ke=ke.trim(),ge[we]("transform",ke),ke},o.getScale=function(ge){var me=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,Ee=ge.attr?"attr":"getAttribute",Pe=ge[Ee]("transform")||"",Ne=Pe.replace(me,function(we,ke,Xe){return[ke,Xe].join(" ")}).split(" ");return{x:+Ne[0]||1,y:+Ne[1]||1}},o.setScale=function(ge,me,Ee){var Pe=/(\bscale\(.*?\);?)/,Ne=ge.attr?"attr":"getAttribute",we=ge.attr?"attr":"setAttribute",ke=ge[Ne]("transform")||"";return me=me||1,Ee=Ee||1,ke=ke.replace(Pe,"").trim(),ke+="scale("+me+","+Ee+")",ke=ke.trim(),ge[we]("transform",ke),ke};var V=/\s*sc.*/;o.setPointGroupScale=function(ge,me,Ee){if(me=me||1,Ee=Ee||1,!!ge){var Pe=me===1&&Ee===1?"":"scale("+me+","+Ee+")";ge.each(function(){var Ne=(this.getAttribute("transform")||"").replace(V,"");Ne+=Pe,Ne=Ne.trim(),this.setAttribute("transform",Ne)})}};var U=/translate\([^)]*\)\s*$/;o.setTextPointsScale=function(ge,me,Ee){!ge||ge.each(function(){var Pe,Ne=A.select(this),we=Ne.select("text");if(!!we.node()){var ke=parseFloat(we.attr("x")||0),Xe=parseFloat(we.attr("y")||0),He=(Ne.attr("transform")||"").match(U);me===1&&Ee===1?Pe=[]:Pe=[t(ke,Xe),"scale("+me+","+Ee+")",t(-ke,-Xe)],He&&Pe.push(He),Ne.attr("transform",Pe.join(""))}})};function $(ge,me){var Ee;return ge&&(Ee=ge.mf),Ee===void 0&&(Ee=me.marker&&me.marker.standoff||0),!me._geo&&!me._xA?-Ee:Ee}o.getMarkerStandoff=$;var ne=Math.atan2,X=Math.cos,Q=Math.sin;function ie(ge,me){var Ee=me[0],Pe=me[1];return[Ee*X(ge)-Pe*Q(ge),Ee*Q(ge)+Pe*X(ge)]}var se,ae,oe,be,ce,de;function ye(ge,me){var Ee=ge.ma;Ee===void 0&&(Ee=me.marker.angle||0);var Pe,Ne,we=me.marker.angleref;if(we==="previous"||we==="north"){if(me._geo){var ke=me._geo.project(ge.lonlat);Pe=ke[0],Ne=ke[1]}else{var Xe=me._xA,He=me._yA;if(Xe&&He)Pe=Xe.c2p(ge.x),Ne=He.c2p(ge.y);else return 90}if(me._geo){var Ie=ge.lonlat[0],De=ge.lonlat[1],Ge=me._geo.project([Ie,De+1e-5]),ht=me._geo.project([Ie+1e-5,De]),Rt=ne(ht[1]-Ne,ht[0]-Pe),Kt=ne(Ge[1]-Ne,Ge[0]-Pe),It;if(we==="north")It=Ee/180*Math.PI;else if(we==="previous"){var Mt=Ie/180*Math.PI,Yt=De/180*Math.PI,zt=se/180*Math.PI,St=ae/180*Math.PI,Ye=zt-Mt,rt=X(St)*Q(Ye),Ve=Q(St)*X(Yt)-X(St)*Q(Yt)*X(Ye);It=-ne(rt,Ve)-Math.PI,se=Ie,ae=De}var Ae=ie(Rt,[X(It),0]),Ue=ie(Kt,[Q(It),0]);Ee=ne(Ae[1]+Ue[1],Ae[0]+Ue[0])/Math.PI*180,we==="previous"&&!(de===me.uid&&ge.i===ce+1)&&(Ee=null)}if(we==="previous"&&!me._geo)if(de===me.uid&&ge.i===ce+1&&M(Pe)&&M(Ne)){var Ze=Pe-oe,Qe=Ne-be,_t=me.line&&me.line.shape||"",gt=_t.slice(_t.length-1);gt==="h"&&(Qe=0),gt==="v"&&(Ze=0),Ee+=ne(Qe,Ze)/Math.PI*180+90}else Ee=null}return oe=Pe,be=Ne,ce=ge.i,de=me.uid,Ee}o.getMarkerAngle=ye},{"../../components/fx/helpers":403,"../../constants/alignment":483,"../../constants/interactions":490,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../registry":647,"../../traces/scatter/make_bubble_size_func":953,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale":379,"./symbol_defs":390,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],390:[function(d,ee,te){var A=d("parse-svg-path"),g=d("@plotly/d3").round,S="M0,0Z",M=Math.sqrt(2),e=Math.sqrt(3),a=Math.PI,n=Math.cos,r=Math.sin;ee.exports={circle:{n:0,f:function(v,f,y){if(t(f))return S;var o=g(v,2),m="M"+o+",0A"+o+","+o+" 0 1,1 0,-"+o+"A"+o+","+o+" 0 0,1 "+o+",0Z";return y?p(f,y,m):m}},square:{n:1,f:function(v,f,y){if(t(f))return S;var o=g(v,2);return p(f,y,"M"+o+","+o+"H-"+o+"V-"+o+"H"+o+"Z")}},diamond:{n:2,f:function(v,f,y){if(t(f))return S;var o=g(v*1.3,2);return p(f,y,"M"+o+",0L0,"+o+"L-"+o+",0L0,-"+o+"Z")}},cross:{n:3,f:function(v,f,y){if(t(f))return S;var o=g(v*.4,2),m=g(v*1.2,2);return p(f,y,"M"+m+","+o+"H"+o+"V"+m+"H-"+o+"V"+o+"H-"+m+"V-"+o+"H-"+o+"V-"+m+"H"+o+"V-"+o+"H"+m+"Z")}},x:{n:4,f:function(v,f,y){if(t(f))return S;var o=g(v*.8/M,2),m="l"+o+","+o,l="l"+o+",-"+o,w="l-"+o+",-"+o,_="l-"+o+","+o;return p(f,y,"M0,"+o+m+l+w+l+w+_+w+_+m+_+m+"Z")}},"triangle-up":{n:5,f:function(v,f,y){if(t(f))return S;var o=g(v*2/e,2),m=g(v/2,2),l=g(v,2);return p(f,y,"M-"+o+","+m+"H"+o+"L0,-"+l+"Z")}},"triangle-down":{n:6,f:function(v,f,y){if(t(f))return S;var o=g(v*2/e,2),m=g(v/2,2),l=g(v,2);return p(f,y,"M-"+o+",-"+m+"H"+o+"L0,"+l+"Z")}},"triangle-left":{n:7,f:function(v,f,y){if(t(f))return S;var o=g(v*2/e,2),m=g(v/2,2),l=g(v,2);return p(f,y,"M"+m+",-"+o+"V"+o+"L-"+l+",0Z")}},"triangle-right":{n:8,f:function(v,f,y){if(t(f))return S;var o=g(v*2/e,2),m=g(v/2,2),l=g(v,2);return p(f,y,"M-"+m+",-"+o+"V"+o+"L"+l+",0Z")}},"triangle-ne":{n:9,f:function(v,f,y){if(t(f))return S;var o=g(v*.6,2),m=g(v*1.2,2);return p(f,y,"M-"+m+",-"+o+"H"+o+"V"+m+"Z")}},"triangle-se":{n:10,f:function(v,f,y){if(t(f))return S;var o=g(v*.6,2),m=g(v*1.2,2);return p(f,y,"M"+o+",-"+m+"V"+o+"H-"+m+"Z")}},"triangle-sw":{n:11,f:function(v,f,y){if(t(f))return S;var o=g(v*.6,2),m=g(v*1.2,2);return p(f,y,"M"+m+","+o+"H-"+o+"V-"+m+"Z")}},"triangle-nw":{n:12,f:function(v,f,y){if(t(f))return S;var o=g(v*.6,2),m=g(v*1.2,2);return p(f,y,"M-"+o+","+m+"V-"+o+"H"+m+"Z")}},pentagon:{n:13,f:function(v,f,y){if(t(f))return S;var o=g(v*.951,2),m=g(v*.588,2),l=g(-v,2),w=g(v*-.309,2),_=g(v*.809,2);return p(f,y,"M"+o+","+w+"L"+m+","+_+"H-"+m+"L-"+o+","+w+"L0,"+l+"Z")}},hexagon:{n:14,f:function(v,f,y){if(t(f))return S;var o=g(v,2),m=g(v/2,2),l=g(v*e/2,2);return p(f,y,"M"+l+",-"+m+"V"+m+"L0,"+o+"L-"+l+","+m+"V-"+m+"L0,-"+o+"Z")}},hexagon2:{n:15,f:function(v,f,y){if(t(f))return S;var o=g(v,2),m=g(v/2,2),l=g(v*e/2,2);return p(f,y,"M-"+m+","+l+"H"+m+"L"+o+",0L"+m+",-"+l+"H-"+m+"L-"+o+",0Z")}},octagon:{n:16,f:function(v,f,y){if(t(f))return S;var o=g(v*.924,2),m=g(v*.383,2);return p(f,y,"M-"+m+",-"+o+"H"+m+"L"+o+",-"+m+"V"+m+"L"+m+","+o+"H-"+m+"L-"+o+","+m+"V-"+m+"Z")}},star:{n:17,f:function(v,f,y){if(t(f))return S;var o=v*1.4,m=g(o*.225,2),l=g(o*.951,2),w=g(o*.363,2),_=g(o*.588,2),h=g(-o,2),b=g(o*-.309,2),u=g(o*.118,2),L=g(o*.809,2),T=g(o*.382,2);return p(f,y,"M"+m+","+b+"H"+l+"L"+w+","+u+"L"+_+","+L+"L0,"+T+"L-"+_+","+L+"L-"+w+","+u+"L-"+l+","+b+"H-"+m+"L0,"+h+"Z")}},hexagram:{n:18,f:function(v,f,y){if(t(f))return S;var o=g(v*.66,2),m=g(v*.38,2),l=g(v*.76,2);return p(f,y,"M-"+l+",0l-"+m+",-"+o+"h"+l+"l"+m+",-"+o+"l"+m+","+o+"h"+l+"l-"+m+","+o+"l"+m+","+o+"h-"+l+"l-"+m+","+o+"l-"+m+",-"+o+"h-"+l+"Z")}},"star-triangle-up":{n:19,f:function(v,f,y){if(t(f))return S;var o=g(v*e*.8,2),m=g(v*.8,2),l=g(v*1.6,2),w=g(v*4,2),_="A "+w+","+w+" 0 0 1 ";return p(f,y,"M-"+o+","+m+_+o+","+m+_+"0,-"+l+_+"-"+o+","+m+"Z")}},"star-triangle-down":{n:20,f:function(v,f,y){if(t(f))return S;var o=g(v*e*.8,2),m=g(v*.8,2),l=g(v*1.6,2),w=g(v*4,2),_="A "+w+","+w+" 0 0 1 ";return p(f,y,"M"+o+",-"+m+_+"-"+o+",-"+m+_+"0,"+l+_+o+",-"+m+"Z")}},"star-square":{n:21,f:function(v,f,y){if(t(f))return S;var o=g(v*1.1,2),m=g(v*2,2),l="A "+m+","+m+" 0 0 1 ";return p(f,y,"M-"+o+",-"+o+l+"-"+o+","+o+l+o+","+o+l+o+",-"+o+l+"-"+o+",-"+o+"Z")}},"star-diamond":{n:22,f:function(v,f,y){if(t(f))return S;var o=g(v*1.4,2),m=g(v*1.9,2),l="A "+m+","+m+" 0 0 1 ";return p(f,y,"M-"+o+",0"+l+"0,"+o+l+o+",0"+l+"0,-"+o+l+"-"+o+",0Z")}},"diamond-tall":{n:23,f:function(v,f,y){if(t(f))return S;var o=g(v*.7,2),m=g(v*1.4,2);return p(f,y,"M0,"+m+"L"+o+",0L0,-"+m+"L-"+o+",0Z")}},"diamond-wide":{n:24,f:function(v,f,y){if(t(f))return S;var o=g(v*1.4,2),m=g(v*.7,2);return p(f,y,"M0,"+m+"L"+o+",0L0,-"+m+"L-"+o+",0Z")}},hourglass:{n:25,f:function(v,f,y){if(t(f))return S;var o=g(v,2);return p(f,y,"M"+o+","+o+"H-"+o+"L"+o+",-"+o+"H-"+o+"Z")},noDot:!0},bowtie:{n:26,f:function(v,f,y){if(t(f))return S;var o=g(v,2);return p(f,y,"M"+o+","+o+"V-"+o+"L-"+o+","+o+"V-"+o+"Z")},noDot:!0},"circle-cross":{n:27,f:function(v,f,y){if(t(f))return S;var o=g(v,2);return p(f,y,"M0,"+o+"V-"+o+"M"+o+",0H-"+o+"M"+o+",0A"+o+","+o+" 0 1,1 0,-"+o+"A"+o+","+o+" 0 0,1 "+o+",0Z")},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(v,f,y){if(t(f))return S;var o=g(v,2),m=g(v/M,2);return p(f,y,"M"+m+","+m+"L-"+m+",-"+m+"M"+m+",-"+m+"L-"+m+","+m+"M"+o+",0A"+o+","+o+" 0 1,1 0,-"+o+"A"+o+","+o+" 0 0,1 "+o+",0Z")},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(v,f,y){if(t(f))return S;var o=g(v,2);return p(f,y,"M0,"+o+"V-"+o+"M"+o+",0H-"+o+"M"+o+","+o+"H-"+o+"V-"+o+"H"+o+"Z")},needLine:!0,noDot:!0},"square-x":{n:30,f:function(v,f,y){if(t(f))return S;var o=g(v,2);return p(f,y,"M"+o+","+o+"L-"+o+",-"+o+"M"+o+",-"+o+"L-"+o+","+o+"M"+o+","+o+"H-"+o+"V-"+o+"H"+o+"Z")},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(v,f,y){if(t(f))return S;var o=g(v*1.3,2);return p(f,y,"M"+o+",0L0,"+o+"L-"+o+",0L0,-"+o+"ZM0,-"+o+"V"+o+"M-"+o+",0H"+o)},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(v,f,y){if(t(f))return S;var o=g(v*1.3,2),m=g(v*.65,2);return p(f,y,"M"+o+",0L0,"+o+"L-"+o+",0L0,-"+o+"ZM-"+m+",-"+m+"L"+m+","+m+"M-"+m+","+m+"L"+m+",-"+m)},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(v,f,y){if(t(f))return S;var o=g(v*1.4,2);return p(f,y,"M0,"+o+"V-"+o+"M"+o+",0H-"+o)},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(v,f,y){if(t(f))return S;var o=g(v,2);return p(f,y,"M"+o+","+o+"L-"+o+",-"+o+"M"+o+",-"+o+"L-"+o+","+o)},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(v,f,y){if(t(f))return S;var o=g(v*1.2,2),m=g(v*.85,2);return p(f,y,"M0,"+o+"V-"+o+"M"+o+",0H-"+o+"M"+m+","+m+"L-"+m+",-"+m+"M"+m+",-"+m+"L-"+m+","+m)},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(v,f,y){if(t(f))return S;var o=g(v/2,2),m=g(v,2);return p(f,y,"M"+o+","+m+"V-"+m+"M"+(o-m)+",-"+m+"V"+m+"M"+m+","+o+"H-"+m+"M-"+m+","+(o-m)+"H"+m)},needLine:!0,noFill:!0},"y-up":{n:37,f:function(v,f,y){if(t(f))return S;var o=g(v*1.2,2),m=g(v*1.6,2),l=g(v*.8,2);return p(f,y,"M-"+o+","+l+"L0,0M"+o+","+l+"L0,0M0,-"+m+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(v,f,y){if(t(f))return S;var o=g(v*1.2,2),m=g(v*1.6,2),l=g(v*.8,2);return p(f,y,"M-"+o+",-"+l+"L0,0M"+o+",-"+l+"L0,0M0,"+m+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(v,f,y){if(t(f))return S;var o=g(v*1.2,2),m=g(v*1.6,2),l=g(v*.8,2);return p(f,y,"M"+l+","+o+"L0,0M"+l+",-"+o+"L0,0M-"+m+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(v,f,y){if(t(f))return S;var o=g(v*1.2,2),m=g(v*1.6,2),l=g(v*.8,2);return p(f,y,"M-"+l+","+o+"L0,0M-"+l+",-"+o+"L0,0M"+m+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(v,f,y){if(t(f))return S;var o=g(v*1.4,2);return p(f,y,"M"+o+",0H-"+o)},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(v,f,y){if(t(f))return S;var o=g(v*1.4,2);return p(f,y,"M0,"+o+"V-"+o)},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(v,f,y){if(t(f))return S;var o=g(v,2);return p(f,y,"M"+o+",-"+o+"L-"+o+","+o)},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(v,f,y){if(t(f))return S;var o=g(v,2);return p(f,y,"M"+o+","+o+"L-"+o+",-"+o)},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(v,f,y){if(t(f))return S;var o=g(v,2),m=g(v*2,2);return p(f,y,"M0,0L-"+o+","+m+"H"+o+"Z")},backoff:1,noDot:!0},"arrow-down":{n:46,f:function(v,f,y){if(t(f))return S;var o=g(v,2),m=g(v*2,2);return p(f,y,"M0,0L-"+o+",-"+m+"H"+o+"Z")},noDot:!0},"arrow-left":{n:47,f:function(v,f,y){if(t(f))return S;var o=g(v*2,2),m=g(v,2);return p(f,y,"M0,0L"+o+",-"+m+"V"+m+"Z")},noDot:!0},"arrow-right":{n:48,f:function(v,f,y){if(t(f))return S;var o=g(v*2,2),m=g(v,2);return p(f,y,"M0,0L-"+o+",-"+m+"V"+m+"Z")},noDot:!0},"arrow-bar-up":{n:49,f:function(v,f,y){if(t(f))return S;var o=g(v,2),m=g(v*2,2);return p(f,y,"M-"+o+",0H"+o+"M0,0L-"+o+","+m+"H"+o+"Z")},backoff:1,needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(v,f,y){if(t(f))return S;var o=g(v,2),m=g(v*2,2);return p(f,y,"M-"+o+",0H"+o+"M0,0L-"+o+",-"+m+"H"+o+"Z")},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(v,f,y){if(t(f))return S;var o=g(v*2,2),m=g(v,2);return p(f,y,"M0,-"+m+"V"+m+"M0,0L"+o+",-"+m+"V"+m+"Z")},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(v,f,y){if(t(f))return S;var o=g(v*2,2),m=g(v,2);return p(f,y,"M0,-"+m+"V"+m+"M0,0L-"+o+",-"+m+"V"+m+"Z")},needLine:!0,noDot:!0},arrow:{n:53,f:function(v,f,y){if(t(f))return S;var o=a/2.5,m=2*v*n(o),l=2*v*r(o);return p(f,y,"M0,0L"+-m+","+l+"L"+m+","+l+"Z")},backoff:.9,noDot:!0},"arrow-wide":{n:54,f:function(v,f,y){if(t(f))return S;var o=a/4,m=2*v*n(o),l=2*v*r(o);return p(f,y,"M0,0L"+-m+","+l+"A "+2*v+","+2*v+" 0 0 1 "+m+","+l+"Z")},backoff:.4,noDot:!0}};function t(v){return v===null}var c,s,i,x;function p(v,f,y){if((!v||v%360===0)&&!f)return y;if(i===v&&x===f&&c===y)return s;i=v,x=f,c=y;function o(I,D){var R=n(I),O=r(I),F=D[0],N=D[1]+(f||0);return[F*R-N*O,F*O+N*R]}for(var m=v/180*a,l=0,w=0,_=A(y),h="",b=0;b<_.length;b++){var u=_[b],L=u[0],T=l,k=w;if(L==="M"||L==="L")l=+u[1],w=+u[2];else if(L==="m"||L==="l")l+=+u[1],w+=+u[2];else if(L==="H")l=+u[1];else if(L==="h")l+=+u[1];else if(L==="V")w=+u[1];else if(L==="v")w+=+u[1];else if(L==="A"){l=+u[1],w=+u[2];var P=o(m,[+u[6],+u[7]]);u[6]=P[0],u[7]=P[1],u[3]=+u[3]+v}(L==="H"||L==="V")&&(L="L"),(L==="h"||L==="v")&&(L="l"),(L==="m"||L==="l")&&(l-=T,w-=k);var z=o(m,[l,w]);(L==="H"||L==="V")&&(L="L"),(L==="M"||L==="L"||L==="m"||L==="l")&&(u[1]=z[0],u[2]=z[1]),u[0]=L,h+=u[0]+u.slice(1).join(",")}return s=h,h}},{"@plotly/d3":58,"parse-svg-path":250}],391:[function(d,ee,te){ee.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],392:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../registry"),S=d("../../plots/cartesian/axes"),M=d("../../lib"),e=d("./compute_error");ee.exports=function(r){for(var t=r.calcdata,c=0;c<t.length;c++){var s=t[c],i=s[0].trace;if(i.visible===!0&&g.traceIs(i,"errorBarsOK")){var x=S.getFromId(r,i.xaxis),p=S.getFromId(r,i.yaxis);a(s,i,x,"x"),a(s,i,p,"y")}}};function a(n,r,t,c){var s=r["error_"+c]||{},i=s.visible&&["linear","log"].indexOf(t.type)!==-1,x=[];if(!!i){for(var p=e(s),v=0;v<n.length;v++){var f=n[v],y=f.i;if(y===void 0)y=v;else if(y===null)continue;var o=f[c];if(!!A(t.c2l(o))){var m=p(o,y);if(A(m[0])&&A(m[1])){var l=f[c+"s"]=o-m[0],w=f[c+"h"]=o+m[1];x.push(l,w)}}}var _=t._id,h=r._extremes[_],b=S.findExtremes(t,x,M.extendFlat({tozero:h.opts.tozero},{padded:!0}));h.min=h.min.concat(b.min),h.max=h.max.concat(b.max)}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./compute_error":393,"fast-isnumeric":190}],393:[function(d,ee,te){ee.exports=function(S){var M=S.type,e=S.symmetric;if(M==="data"){var a=S.array||[];if(e)return function(s,i){var x=+a[i];return[x,x]};var n=S.arrayminus||[];return function(s,i){var x=+a[i],p=+n[i];return!isNaN(x)||!isNaN(p)?[p||0,x||0]:[NaN,NaN]}}else{var r=A(M,S.value),t=A(M,S.valueminus);return e||S.valueminus===void 0?function(s){var i=r(s);return[i,i]}:function(s){return[t(s),r(s)]}}};function A(g,S){if(g==="percent")return function(M){return Math.abs(M*S/100)};if(g==="constant")return function(){return Math.abs(S)};if(g==="sqrt")return function(M){return Math.sqrt(Math.abs(M))}}},{}],394:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../registry"),S=d("../../lib"),M=d("../../plot_api/plot_template"),e=d("./attributes");ee.exports=function(a,n,r,t){var c="error_"+t.axis,s=M.newContainer(n,c),i=a[c]||{};function x(l,w){return S.coerce(i,s,e,l,w)}var p=i.array!==void 0||i.value!==void 0||i.type==="sqrt",v=x("visible",p);if(v!==!1){var f=x("type","array"in i?"data":"percent"),y=!0;f!=="sqrt"&&(y=x("symmetric",!((f==="data"?"arrayminus":"valueminus")in i))),f==="data"?(x("array"),x("traceref"),y||(x("arrayminus"),x("tracerefminus"))):(f==="percent"||f==="constant")&&(x("value"),y||x("valueminus"));var o="copy_"+t.inherit+"style";if(t.inherit){var m=n["error_"+t.inherit];(m||{}).visible&&x(o,!(i.color||A(i.thickness)||A(i.width)))}(!t.inherit||!s[o])&&(x("color",r),x("thickness"),x("width",g.traceIs(n,"gl3d")?0:4))}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"./attributes":391,"fast-isnumeric":190}],395:[function(d,ee,te){var A=d("../../lib"),g=d("../../plot_api/edit_types").overrideAll,S=d("./attributes"),M={error_x:A.extendFlat({},S),error_y:A.extendFlat({},S)};delete M.error_x.copy_zstyle,delete M.error_y.copy_zstyle,delete M.error_y.copy_ystyle;var e={error_x:A.extendFlat({},S),error_y:A.extendFlat({},S),error_z:A.extendFlat({},S)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,ee.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:M,bar:M,histogram:M,scatter3d:g(e,"calc","nested"),scattergl:g(M,"calc","nested")}},supplyDefaults:d("./defaults"),calc:d("./calc"),makeComputeError:d("./compute_error"),plot:d("./plot"),style:d("./style"),hoverInfo:a};function a(n,r,t){(r.error_y||{}).visible&&(t.yerr=n.yh-n.y,r.error_y.symmetric||(t.yerrneg=n.y-n.ys)),(r.error_x||{}).visible&&(t.xerr=n.xh-n.x,r.error_x.symmetric||(t.xerrneg=n.x-n.xs))}},{"../../lib":515,"../../plot_api/edit_types":548,"./attributes":391,"./calc":392,"./compute_error":393,"./defaults":394,"./plot":396,"./style":397}],396:[function(d,ee,te){var A=d("@plotly/d3"),g=d("fast-isnumeric"),S=d("../drawing"),M=d("../../traces/scatter/subtypes");ee.exports=function(n,r,t,c){var s,i=t.xaxis,x=t.yaxis,p=c&&c.duration>0;r.each(function(v){var f=v[0].trace,y=f.error_x||{},o=f.error_y||{},m;f.ids&&(m=function(h){return h.id});var l=M.hasMarkers(f)&&f.marker.maxdisplayed>0;!o.visible&&!y.visible&&(v=[]);var w=A.select(this).selectAll("g.errorbar").data(v,m);if(w.exit().remove(),!!v.length){y.visible||w.selectAll("path.xerror").remove(),o.visible||w.selectAll("path.yerror").remove(),w.style("opacity",1);var _=w.enter().append("g").classed("errorbar",!0);p&&_.style("opacity",0).transition().duration(c.duration).style("opacity",1),S.setClipUrl(w,t.layerClipId,n),w.each(function(h){var b=A.select(this),u=e(h,i,x);if(!(l&&!h.vis)){var L,T=b.select("path.yerror");if(o.visible&&g(u.x)&&g(u.yh)&&g(u.ys)){var k=o.width;L="M"+(u.x-k)+","+u.yh+"h"+2*k+"m-"+k+",0V"+u.ys,u.noYS||(L+="m-"+k+",0h"+2*k),s=!T.size(),s?T=b.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0):p&&(T=T.transition().duration(c.duration).ease(c.easing)),T.attr("d",L)}else T.remove();var P=b.select("path.xerror");if(y.visible&&g(u.y)&&g(u.xh)&&g(u.xs)){var z=(y.copy_ystyle?o:y).width;L="M"+u.xh+","+(u.y-z)+"v"+2*z+"m0,-"+z+"H"+u.xs,u.noXS||(L+="m0,-"+z+"v"+2*z),s=!P.size(),s?P=b.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0):p&&(P=P.transition().duration(c.duration).ease(c.easing)),P.attr("d",L)}else P.remove()}})}})};function e(a,n,r){var t={x:n.c2p(a.x),y:r.c2p(a.y)};return a.yh!==void 0&&(t.yh=r.c2p(a.yh),t.ys=r.c2p(a.ys),g(t.ys)||(t.noYS=!0,t.ys=r.c2p(a.ys,!0))),a.xh!==void 0&&(t.xh=n.c2p(a.xh),t.xs=n.c2p(a.xs),g(t.xs)||(t.noXS=!0,t.xs=n.c2p(a.xs,!0))),t}},{"../../traces/scatter/subtypes":961,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],397:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../color");ee.exports=function(M){M.each(function(e){var a=e[0].trace,n=a.error_y||{},r=a.error_x||{},t=A.select(this);t.selectAll("path.yerror").style("stroke-width",n.thickness+"px").call(g.stroke,n.color),r.copy_ystyle&&(r=n),t.selectAll("path.xerror").style("stroke-width",r.thickness+"px").call(g.stroke,r.color)})}},{"../color":367,"@plotly/d3":58}],398:[function(d,ee,te){var A=d("../../plots/font_attributes"),g=d("./layout_attributes").hoverlabel,S=d("../../lib/extend").extendFlat;ee.exports={hoverlabel:{bgcolor:S({},g.bgcolor,{arrayOk:!0}),bordercolor:S({},g.bordercolor,{arrayOk:!0}),font:A({arrayOk:!0,editType:"none"}),align:S({},g.align,{arrayOk:!0}),namelength:S({},g.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":505,"../../plots/font_attributes":594,"./layout_attributes":408}],399:[function(d,ee,te){var A=d("../../lib"),g=d("../../registry");ee.exports=function(e){var a=e.calcdata,n=e._fullLayout;function r(x){return function(p){return A.coerceHoverinfo({hoverinfo:p},{_module:x._module},n)}}for(var t=0;t<a.length;t++){var c=a[t],s=c[0].trace;if(!g.traceIs(s,"pie-like")){var i=g.traceIs(s,"2dMap")?S:A.fillArray;i(s.hoverinfo,c,"hi",r(s)),s.hovertemplate&&i(s.hovertemplate,c,"ht"),s.hoverlabel&&(i(s.hoverlabel.bgcolor,c,"hbg"),i(s.hoverlabel.bordercolor,c,"hbc"),i(s.hoverlabel.font.size,c,"hts"),i(s.hoverlabel.font.color,c,"htc"),i(s.hoverlabel.font.family,c,"htf"),i(s.hoverlabel.namelength,c,"hnl"),i(s.hoverlabel.align,c,"hta"))}}};function S(M,e,a,n){n=n||A.identity,Array.isArray(M)&&(e[0][a]=n(M))}},{"../../lib":515,"../../registry":647}],400:[function(d,ee,te){var A=d("../../registry"),g=d("./hover").hover;ee.exports=function(M,e,a){var n=A.getComponentMethod("annotations","onClick")(M,M._hoverdata);a!==void 0&&g(M,e,a,!0);function r(){M.emit("plotly_click",{points:M._hoverdata,event:e})}M._hoverdata&&e&&e.target&&(n&&n.then?n.then(r):r(),e.stopImmediatePropagation&&e.stopImmediatePropagation())}},{"../../registry":647,"./hover":404}],401:[function(d,ee,te){ee.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],402:[function(d,ee,te){var A=d("../../lib"),g=d("./attributes"),S=d("./hoverlabel_defaults");ee.exports=function(e,a,n,r){function t(s,i){return A.coerce(e,a,g,s,i)}var c=A.extendFlat({},r.hoverlabel);a.hovertemplate&&(c.namelength=-1),S(e,a,t,c)}},{"../../lib":515,"./attributes":398,"./hoverlabel_defaults":405}],403:[function(d,ee,te){var A=d("../../lib");te.getSubplot=function(n){return n.subplot||n.xaxis+n.yaxis||n.geo},te.isTraceInSubplots=function(n,r){if(n.type==="splom"){for(var t=n.xaxes||[],c=n.yaxes||[],s=0;s<t.length;s++)for(var i=0;i<c.length;i++)if(r.indexOf(t[s]+c[i])!==-1)return!0;return!1}return r.indexOf(te.getSubplot(n))!==-1},te.flat=function(n,r){for(var t=new Array(n.length),c=0;c<n.length;c++)t[c]=r;return t},te.p2c=function(n,r){for(var t=new Array(n.length),c=0;c<n.length;c++)t[c]=n[c].p2c(r);return t},te.getDistanceFunction=function(n,r,t,c){return n==="closest"?c||te.quadrature(r,t):n.charAt(0)==="x"?r:t},te.getClosest=function(n,r,t){if(t.index!==!1)t.index>=0&&t.index<n.length?t.distance=0:t.index=!1;else for(var c=0;c<n.length;c++){var s=r(n[c]);s<=t.distance&&(t.index=c,t.distance=s)}return t},te.inbox=function(n,r,t){return n*r<0||n===0?t:1/0},te.quadrature=function(n,r){return function(t){var c=n(t),s=r(t);return Math.sqrt(c*c+s*s)}},te.makeEventData=function(n,r,t){var c="index"in n?n.index:n.pointNumber,s={data:r._input,fullData:r,curveNumber:r.index,pointNumber:c};if(r._indexToPoints){var i=r._indexToPoints[c];i.length===1?s.pointIndex=i[0]:s.pointIndices=i}else s.pointIndex=c;return r._module.eventData?s=r._module.eventData(s,n,r,t,c):("xVal"in n?s.x=n.xVal:"x"in n&&(s.x=n.x),"yVal"in n?s.y=n.yVal:"y"in n&&(s.y=n.y),n.xa&&(s.xaxis=n.xa),n.ya&&(s.yaxis=n.ya),n.zLabelVal!==void 0&&(s.z=n.zLabelVal)),te.appendArrayPointValue(s,r,c),s},te.appendArrayPointValue=function(n,r,t){var c=r._arrayAttrs;if(!!c)for(var s=0;s<c.length;s++){var i=c[s],x=S(i);if(n[x]===void 0){var p=A.nestedProperty(r,i).get(),v=M(p,t);v!==void 0&&(n[x]=v)}}},te.appendArrayMultiPointValues=function(n,r,t){var c=r._arrayAttrs;if(!!c)for(var s=0;s<c.length;s++){var i=c[s],x=S(i);if(n[x]===void 0){for(var p=A.nestedProperty(r,i).get(),v=new Array(t.length),f=0;f<t.length;f++)v[f]=M(p,t[f]);n[x]=v}}};var g={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function S(n){return g[n]||n}function M(n,r){if(Array.isArray(r)){if(Array.isArray(n)&&Array.isArray(n[r[0]]))return n[r[0]][r[1]]}else return n[r]}var e={x:!0,y:!0},a={"x unified":!0,"y unified":!0};te.isUnifiedHover=function(n){return typeof n!="string"?!1:!!a[n]},te.isXYhover=function(n){return typeof n!="string"?!1:!!e[n]}},{"../../lib":515}],404:[function(d,ee,te){var A=d("@plotly/d3"),g=d("fast-isnumeric"),S=d("tinycolor2"),M=d("../../lib"),e=M.strTranslate,a=M.strRotate,n=d("../../lib/events"),r=d("../../lib/svg_text_utils"),t=d("../../lib/override_cursor"),c=d("../drawing"),s=d("../color"),i=d("../dragelement"),x=d("../../plots/cartesian/axes"),p=d("../../registry"),v=d("./helpers"),f=d("./constants"),y=d("../legend/defaults"),o=d("../legend/draw"),m=f.YANGLE,l=Math.PI*m/180,w=1/Math.sin(l),_=Math.cos(l),h=Math.sin(l),b=f.HOVERARROWSIZE,u=f.HOVERTEXTPAD,L={box:!0,ohlc:!0,violin:!0,candlestick:!0},T={scatter:!0,scattergl:!0,splom:!0};te.hover=function(U,$,ne,X){U=M.getGraphDiv(U);var Q=$.target;M.throttle(U._fullLayout._uid+f.HOVERID,f.HOVERMINTIME,function(){k(U,$,ne,X,Q)})},te.loneHover=function(U,$){var ne=!0;Array.isArray(U)||(ne=!1,U=[U]);var X=$.gd,Q=ue(X),ie=j(X),se=U.map(function(me){var Ee=me._x0||me.x0||me.x||0,Pe=me._x1||me.x1||me.x||0,Ne=me._y0||me.y0||me.y||0,we=me._y1||me.y1||me.y||0,ke=me.eventData;if(ke){var Xe=Math.min(Ee,Pe),He=Math.max(Ee,Pe),Ie=Math.min(Ne,we),De=Math.max(Ne,we),Ge=me.trace;if(p.traceIs(Ge,"gl3d")){var ht=X._fullLayout[Ge.scene]._scene.container,Rt=ht.offsetLeft,Kt=ht.offsetTop;Xe+=Rt,He+=Rt,Ie+=Kt,De+=Kt}ke.bbox={x0:Xe+ie,x1:He+ie,y0:Ie+Q,y1:De+Q},$.inOut_bbox&&$.inOut_bbox.push(ke.bbox)}else ke=!1;return{color:me.color||s.defaultLine,x0:me.x0||me.x||0,x1:me.x1||me.x||0,y0:me.y0||me.y||0,y1:me.y1||me.y||0,xLabel:me.xLabel,yLabel:me.yLabel,zLabel:me.zLabel,text:me.text,name:me.name,idealAlign:me.idealAlign,borderColor:me.borderColor,fontFamily:me.fontFamily,fontSize:me.fontSize,fontColor:me.fontColor,nameLength:me.nameLength,textAlign:me.textAlign,trace:me.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:me.hovertemplate||!1,hovertemplateLabels:me.hovertemplateLabels||!1,eventData:ke}}),ae=!1,oe=I(se,{gd:X,hovermode:"closest",rotateLabels:ae,bgColor:$.bgColor||s.background,container:A.select($.container),outerContainer:$.outerContainer||$.container}),be=5,ce=0,de=0;oe.sort(function(me,Ee){return me.y0-Ee.y0}).each(function(me,Ee){var Pe=me.y0-me.by/2;Pe-be<ce?me.offset=ce-Pe+be:me.offset=0,ce=Pe+me.by+me.offset,Ee===$.anchorIndex&&(de=me.offset)}).each(function(me){me.offset-=de});var ye=X._fullLayout._invScaleX,ge=X._fullLayout._invScaleY;return O(oe,ae,ye,ge),ne?oe:oe.node()};function k(V,U,$,ne,X){$||($="xy");var Q=Array.isArray($)?$:[$],ie=V._fullLayout,se=ie._plots||[],ae=se[$],oe=ie._has("cartesian");if(ae){var be=ae.overlays.map(function(ir){return ir.id});Q=Q.concat(be)}for(var ce=Q.length,de=new Array(ce),ye=new Array(ce),ge=!1,me=0;me<ce;me++){var Ee=Q[me];if(se[Ee])ge=!0,de[me]=se[Ee].xaxis,ye[me]=se[Ee].yaxis;else if(ie[Ee]&&ie[Ee]._subplot){var Pe=ie[Ee]._subplot;de[me]=Pe.xaxis,ye[me]=Pe.yaxis}else{M.warn("Unrecognized subplot: "+Ee);return}}var Ne=U.hovermode||ie.hovermode;if(Ne&&!ge&&(Ne="closest"),["x","y","closest","x unified","y unified"].indexOf(Ne)===-1||!V.calcdata||V.querySelector(".zoombox")||V._dragging)return i.unhoverRaw(V,U);var we=ie.hoverdistance;we===-1&&(we=1/0);var ke=ie.spikedistance;ke===-1&&(ke=1/0);var Xe=[],He=[],Ie,De,Ge,ht,Rt,Kt,It,Mt,Yt,zt,St,Ye,rt,Ve={hLinePoint:null,vLinePoint:null},Ae=!1;if(Array.isArray(U))for(Ne="array",Ge=0;Ge<U.length;Ge++)Rt=V.calcdata[U[Ge].curveNumber||0],Rt&&(Kt=Rt[0].trace,Rt[0].trace.hoverinfo!=="skip"&&(He.push(Rt),Kt.orientation==="h"&&(Ae=!0)));else{for(ht=0;ht<V.calcdata.length;ht++)Rt=V.calcdata[ht],Kt=Rt[0].trace,Kt.hoverinfo!=="skip"&&v.isTraceInSubplots(Kt,Q)&&(He.push(Rt),Kt.orientation==="h"&&(Ae=!0));var Ue=!X,Ze,Qe;if(Ue)"xpx"in U?Ze=U.xpx:Ze=de[0]._length/2,"ypx"in U?Qe=U.ypx:Qe=ye[0]._length/2;else{if(n.triggerHandler(V,"plotly_beforehover",U)===!1)return;var _t=X.getBoundingClientRect();Ze=U.clientX-_t.left,Qe=U.clientY-_t.top,ie._calcInverseTransform(V);var gt=M.apply3DTransform(ie._invTransform)(Ze,Qe);if(Ze=gt[0],Qe=gt[1],Ze<0||Ze>de[0]._length||Qe<0||Qe>ye[0]._length)return i.unhoverRaw(V,U)}if(U.pointerX=Ze+de[0]._offset,U.pointerY=Qe+ye[0]._offset,"xval"in U?Ie=v.flat(Q,U.xval):Ie=v.p2c(de,Ze),"yval"in U?De=v.flat(Q,U.yval):De=v.p2c(ye,Qe),!g(Ie[0])||!g(De[0]))return M.warn("Fx.hover failed",U,V),i.unhoverRaw(V,U)}var wt=1/0;function Ut(ir,Ir){for(ht=0;ht<He.length;ht++)if(Rt=He[ht],!(!Rt||!Rt[0]||!Rt[0].trace)&&(Kt=Rt[0].trace,!(Kt.visible!==!0||Kt._length===0)&&["carpet","contourcarpet"].indexOf(Kt._module.name)===-1)){if(Kt.type==="splom"?(Mt=0,It=Q[Mt]):(It=v.getSubplot(Kt),Mt=Q.indexOf(It)),Yt=Ne,v.isUnifiedHover(Yt)&&(Yt=Yt.charAt(0)),Ye={cd:Rt,trace:Kt,xa:de[Mt],ya:ye[Mt],maxHoverDistance:we,maxSpikeDistance:ke,index:!1,distance:Math.min(wt,we),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:s.defaultLine,name:Kt.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},ie[It]&&(Ye.subplot=ie[It]._subplot),ie._splomScenes&&ie._splomScenes[Kt.uid]&&(Ye.scene=ie._splomScenes[Kt.uid]),rt=Xe.length,Yt==="array"){var Br=U[ht];"pointNumber"in Br?(Ye.index=Br.pointNumber,Yt="closest"):(Yt="","xval"in Br&&(zt=Br.xval,Yt="x"),"yval"in Br&&(St=Br.yval,Yt=Yt?"closest":"y"))}else ir!==void 0&&Ir!==void 0?(zt=ir,St=Ir):(zt=Ie[Mt],St=De[Mt]);if(we!==0)if(Kt._module&&Kt._module.hoverPoints){var Er=Kt._module.hoverPoints(Ye,zt,St,Yt,{finiteRange:!0,hoverLayer:ie._hoverlayer});if(Er)for(var _r,Gr=0;Gr<Er.length;Gr++)_r=Er[Gr],g(_r.x0)&&g(_r.y0)&&Xe.push(F(_r,Ne))}else M.log("Unrecognized trace type in hover:",Kt);if(Ne==="closest"&&Xe.length>rt&&(Xe.splice(0,rt),wt=Xe[0].distance),oe&&ke!==0&&Xe.length===0){Ye.distance=ke,Ye.index=!1;var wn=Kt._module.hoverPoints(Ye,zt,St,"closest",{hoverLayer:ie._hoverlayer});if(wn&&(wn=wn.filter(function(pa){return pa.spikeDistance<=ke})),wn&&wn.length){var cn,Bn=wn.filter(function(pa){return pa.xa.showspikes&&pa.xa.spikesnap!=="hovered data"});if(Bn.length){var En=Bn[0];g(En.x0)&&g(En.y0)&&(cn=Nt(En),(!Ve.vLinePoint||Ve.vLinePoint.spikeDistance>cn.spikeDistance)&&(Ve.vLinePoint=cn))}var Yn=wn.filter(function(pa){return pa.ya.showspikes&&pa.ya.spikesnap!=="hovered data"});if(Yn.length){var Hn=Yn[0];g(Hn.x0)&&g(Hn.y0)&&(cn=Nt(Hn),(!Ve.hLinePoint||Ve.hLinePoint.spikeDistance>cn.spikeDistance)&&(Ve.hLinePoint=cn))}}}}}Ut();function Dt(ir,Ir,Br){for(var Er=null,_r=1/0,Gr,wn=0;wn<ir.length;wn++)Gr=ir[wn].spikeDistance,Br&&wn===0&&(Gr=-1/0),Gr<=_r&&Gr<=Ir&&(Er=ir[wn],_r=Gr);return Er}function Nt(ir){return ir?{xa:ir.xa,ya:ir.ya,x:ir.xSpike!==void 0?ir.xSpike:(ir.x0+ir.x1)/2,y:ir.ySpike!==void 0?ir.ySpike:(ir.y0+ir.y1)/2,distance:ir.distance,spikeDistance:ir.spikeDistance,curveNumber:ir.trace.index,color:ir.color,pointNumber:ir.index}:null}var Xt={fullLayout:ie,container:ie._hoverlayer,event:U},Ht=V._spikepoints,ar={vLinePoint:Ve.vLinePoint,hLinePoint:Ve.hLinePoint};V._spikepoints=ar;var Vr=function(){Xe.sort(function(ir,Ir){return ir.distance-Ir.distance}),Xe=Y(Xe,Ne)};Vr();var nn=Ne.charAt(0),jr=(nn==="x"||nn==="y")&&Xe[0]&&T[Xe[0].trace.type];if(oe&&ke!==0&&Xe.length!==0){var at=Xe.filter(function(ir){return ir.ya.showspikes}),$t=Dt(at,ke,jr);Ve.hLinePoint=Nt($t);var Zt=Xe.filter(function(ir){return ir.xa.showspikes}),ur=Dt(Zt,ke,jr);Ve.vLinePoint=Nt(ur)}if(Xe.length===0){var wr=i.unhoverRaw(V,U);return oe&&(Ve.hLinePoint!==null||Ve.vLinePoint!==null)&&K(Ht)&&N(V,Ve,Xt),wr}if(oe&&K(Ht)&&N(V,Ve,Xt),v.isXYhover(Yt)&&Xe[0].length!==0&&Xe[0].trace.type!=="splom"){var $e=Xe[0];L[$e.trace.type]?Xe=Xe.filter(function(ir){return ir.trace.index===$e.trace.index}):Xe=[$e];var Je=Xe.length,it=re("x",$e,ie),lt=re("y",$e,ie);Ut(it,lt);var Tt=[],Bt={},Ce=0,Me=function(ir){var Ir=L[ir.trace.type]?P(ir):ir.trace.index;if(!Bt[Ir])Ce++,Bt[Ir]=Ce,Tt.push(ir);else{var Br=Bt[Ir]-1,Er=Tt[Br];Br>0&&Math.abs(ir.distance)<Math.abs(Er.distance)&&(Tt[Br]=ir)}},nt;for(nt=0;nt<Je;nt++)Me(Xe[nt]);for(nt=Xe.length-1;nt>Je-1;nt--)Me(Xe[nt]);Xe=Tt,Vr()}var st=V._hoverdata,ct=[],At=ue(V),dt=j(V);for(Ge=0;Ge<Xe.length;Ge++){var Ct=Xe[Ge],Gt=v.makeEventData(Ct,Ct.trace,Ct.cd);if(Ct.hovertemplate!==!1){var rr=!1;Ct.cd[Ct.index]&&Ct.cd[Ct.index].ht&&(rr=Ct.cd[Ct.index].ht),Ct.hovertemplate=rr||Ct.trace.hovertemplate||!1}if(Ct.xa&&Ct.ya){var kr=Ct.x0+Ct.xa._offset,br=Ct.x1+Ct.xa._offset,Ar=Ct.y0+Ct.ya._offset,Wr=Ct.y1+Ct.ya._offset,nr=Math.min(kr,br),yr=Math.max(kr,br),Pr=Math.min(Ar,Wr),Or=Math.max(Ar,Wr);Gt.bbox={x0:nr+dt,x1:yr+dt,y0:Pr+At,y1:Or+At}}Ct.eventData=[Gt],ct.push(Gt)}V._hoverdata=ct;var Sr=Ne==="y"&&(He.length>1||Xe.length>1)||Ne==="closest"&&Ae&&Xe.length>1,tt=s.combine(ie.plot_bgcolor||s.background,ie.paper_bgcolor),Lt=I(Xe,{gd:V,hovermode:Ne,rotateLabels:Sr,bgColor:tt,container:ie._hoverlayer,outerContainer:ie._paper.node(),commonLabelOpts:ie.hoverlabel,hoverdistance:ie.hoverdistance});if(v.isUnifiedHover(Ne)||(R(Lt,Sr?"xa":"ya",ie),O(Lt,Sr,ie._invScaleX,ie._invScaleY)),X&&X.tagName){var Wt=p.getComponentMethod("annotations","hasClickToShow")(V,ct);t(A.select(X),Wt?"pointer":"")}!X||ne||!G(V,U,st)||(st&&V.emit("plotly_unhover",{event:U,points:st}),V.emit("plotly_hover",{event:U,points:V._hoverdata,xaxes:de,yaxes:ye,xvals:Ie,yvals:De}))}function P(V){return[V.trace.index,V.index,V.x0,V.y0,V.name,V.attr,V.xa?V.xa._id:"",V.ya?V.ya._id:""].join(",")}var z=/<extra>([\s\S]*)<\/extra>/;function I(V,U){var $=U.gd,ne=$._fullLayout,X=U.hovermode,Q=U.rotateLabels,ie=U.bgColor,se=U.container,ae=U.outerContainer,oe=U.commonLabelOpts||{};if(V.length===0)return[[]];var be=U.fontFamily||f.HOVERFONT,ce=U.fontSize||f.HOVERFONTSIZE,de=V[0],ye=de.xa,ge=de.ya,me=X.charAt(0),Ee=me+"Label",Pe=de[Ee];if(Pe===void 0&&ye.type==="multicategory")for(var Ne=0;Ne<V.length&&(Pe=V[Ne][Ee],Pe===void 0);Ne++);var we=q($,ae),ke=we.top,Xe=we.width,He=we.height,Ie=Pe!==void 0&&de.distance<=U.hoverdistance&&(X==="x"||X==="y");if(Ie){var De=!0,Ge,ht;for(Ge=0;Ge<V.length;Ge++)if(De&&V[Ge].zLabel===void 0&&(De=!1),ht=V[Ge].hoverinfo||V[Ge].trace.hoverinfo,ht){var Rt=Array.isArray(ht)?ht:ht.split("+");if(Rt.indexOf("all")===-1&&Rt.indexOf(X)===-1){Ie=!1;break}}De&&(Ie=!1)}var Kt=se.selectAll("g.axistext").data(Ie?[0]:[]);if(Kt.enter().append("g").classed("axistext",!0),Kt.exit().remove(),Kt.each(function(){var $e=A.select(this),Je=M.ensureSingle($e,"path","",function(yr){yr.style({"stroke-width":"1px"})}),it=M.ensureSingle($e,"text","",function(yr){yr.attr("data-notex",1)}),lt=oe.bgcolor||s.defaultLine,Tt=oe.bordercolor||s.contrast(lt),Bt=s.contrast(lt),Ce={family:oe.font.family||be,size:oe.font.size||ce,color:oe.font.color||Bt};Je.style({fill:lt,stroke:Tt}),it.text(Pe).call(c.font,Ce).call(r.positionText,0,0).call(r.convertToTspans,$),$e.attr("transform","");var Me=q($,it.node()),nt,st;if(X==="x"){var ct=ye.side==="top"?"-":"";it.attr("text-anchor","middle").call(r.positionText,0,ye.side==="top"?ke-Me.bottom-b-u:ke-Me.top+b+u),nt=ye._offset+(de.x0+de.x1)/2,st=ge._offset+(ye.side==="top"?0:ge._length);var At=Me.width/2+u;nt<At?(nt=At,Je.attr("d","M-"+(At-b)+",0L-"+(At-b*2)+","+ct+b+"H"+(u+Me.width/2)+"v"+ct+(u*2+Me.height)+"H-"+At+"V"+ct+b+"Z")):nt>ne.width-At?(nt=ne.width-At,Je.attr("d","M"+(At-b)+",0L"+At+","+ct+b+"v"+ct+(u*2+Me.height)+"H-"+At+"V"+ct+b+"H"+(At-b*2)+"Z")):Je.attr("d","M0,0L"+b+","+ct+b+"H"+(u+Me.width/2)+"v"+ct+(u*2+Me.height)+"H-"+(u+Me.width/2)+"V"+ct+b+"H-"+b+"Z")}else{var dt,Ct,Gt;ge.side==="right"?(dt="start",Ct=1,Gt="",nt=ye._offset+ye._length):(dt="end",Ct=-1,Gt="-",nt=ye._offset),st=ge._offset+(de.y0+de.y1)/2,it.attr("text-anchor",dt),Je.attr("d","M0,0L"+Gt+b+","+b+"V"+(u+Me.height/2)+"h"+Gt+(u*2+Me.width)+"V-"+(u+Me.height/2)+"H"+Gt+b+"V-"+b+"Z");var rr=Me.height/2,kr=ke-Me.top-rr,br="clip"+ne._uid+"commonlabel"+ge._id,Ar;if(nt<Me.width+2*u+b){Ar="M-"+(b+u)+"-"+rr+"h-"+(Me.width-u)+"V"+rr+"h"+(Me.width-u)+"Z";var Wr=Me.width-nt+u;r.positionText(it,Wr,kr),dt==="end"&&it.selectAll("tspan").each(function(){var yr=A.select(this),Pr=c.tester.append("text").text(yr.text()).call(c.font,Ce),Or=q($,Pr.node());Math.round(Or.width)<Math.round(Me.width)&&yr.attr("x",Wr-Or.width),Pr.remove()})}else r.positionText(it,Ct*(u+b),kr),Ar=null;var nr=ne._topclips.selectAll("#"+br).data(Ar?[0]:[]);nr.enter().append("clipPath").attr("id",br).append("path"),nr.exit().remove(),nr.select("path").attr("d",Ar),c.setClipUrl(it,Ar?br:null,$)}$e.attr("transform",e(nt,st))}),v.isUnifiedHover(X)){se.selectAll("g.hovertext").remove();var It=V.filter(function($e){return $e.hoverinfo!=="none"});if(It.length===0)return;var Mt=ne.hoverlabel,Yt=Mt.font,zt={showlegend:!0,legend:{title:{text:Pe,font:Yt},font:Yt,bgcolor:Mt.bgcolor,bordercolor:Mt.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:ne.legend?ne.legend.traceorder:void 0,orientation:"v"}},St={font:Yt};y(zt,St,$._fullData);var Ye=St.legend;Ye.entries=[];for(var rt=0;rt<It.length;rt++){var Ve=It[rt];if(Ve.hoverinfo!=="none"){var Ae=D(Ve,!0,X,ne,Pe),Ue=Ae[0],Ze=Ae[1];Ve.name=Ze,Ze!==""?Ve.text=Ze+" : "+Ue:Ve.text=Ue;var Qe=Ve.cd[Ve.index];Qe&&(Qe.mc&&(Ve.mc=Qe.mc),Qe.mcc&&(Ve.mc=Qe.mcc),Qe.mlc&&(Ve.mlc=Qe.mlc),Qe.mlcc&&(Ve.mlc=Qe.mlcc),Qe.mlw&&(Ve.mlw=Qe.mlw),Qe.mrc&&(Ve.mrc=Qe.mrc),Qe.dir&&(Ve.dir=Qe.dir)),Ve._distinct=!0,Ye.entries.push([Ve])}}Ye.entries.sort(function($e,Je){return $e[0].trace.index-Je[0].trace.index}),Ye.layer=se,Ye._inHover=!0,Ye._groupTitleFont=Mt.grouptitlefont,o($,Ye);var _t=se.select("g.legend"),gt=q($,_t.node()),wt=gt.width+2*u,Ut=gt.height+2*u,Dt=It[0],Nt=(Dt.x0+Dt.x1)/2,Xt=(Dt.y0+Dt.y1)/2,Ht=!(p.traceIs(Dt.trace,"bar-like")||p.traceIs(Dt.trace,"box-violin")),ar,Vr;me==="y"?Ht?(Vr=Xt-u,ar=Xt+u):(Vr=Math.min.apply(null,It.map(function($e){return Math.min($e.y0,$e.y1)})),ar=Math.max.apply(null,It.map(function($e){return Math.max($e.y0,$e.y1)}))):Vr=ar=M.mean(It.map(function($e){return($e.y0+$e.y1)/2}))-Ut/2;var nn,jr;me==="x"?Ht?(nn=Nt+u,jr=Nt-u):(nn=Math.max.apply(null,It.map(function($e){return Math.max($e.x0,$e.x1)})),jr=Math.min.apply(null,It.map(function($e){return Math.min($e.x0,$e.x1)}))):nn=jr=M.mean(It.map(function($e){return($e.x0+$e.x1)/2}))-wt/2;var at=ye._offset,$t=ge._offset;ar+=$t,nn+=at,jr+=at-wt,Vr+=$t-Ut;var Zt,ur;return nn+wt<Xe&&nn>=0?Zt=nn:jr+wt<Xe&&jr>=0?Zt=jr:at+wt<Xe?Zt=at:nn-Nt<Nt-jr+wt?Zt=Xe-wt:Zt=0,Zt+=u,ar+Ut<He&&ar>=0?ur=ar:Vr+Ut<He&&Vr>=0?ur=Vr:$t+Ut<He?ur=$t:ar-Xt<Xt-Vr+Ut?ur=He-Ut:ur=0,ur+=u,_t.attr("transform",e(Zt-1,ur-1)),_t}var wr=se.selectAll("g.hovertext").data(V,function($e){return P($e)});return wr.enter().append("g").classed("hovertext",!0).each(function(){var $e=A.select(this);$e.append("rect").call(s.fill,s.addOpacity(ie,.8)),$e.append("text").classed("name",!0),$e.append("path").style("stroke-width","1px"),$e.append("text").classed("nums",!0).call(c.font,be,ce)}),wr.exit().remove(),wr.each(function($e){var Je=A.select(this).attr("transform",""),it=$e.color;Array.isArray(it)&&(it=it[$e.eventData[0].pointNumber]);var lt=$e.bgcolor||it,Tt=s.combine(s.opacity(lt)?lt:s.defaultLine,ie),Bt=s.combine(s.opacity(it)?it:s.defaultLine,ie),Ce=$e.borderColor||s.contrast(Tt),Me=D($e,Ie,X,ne,Pe,Je),nt=Me[0],st=Me[1],ct=Je.select("text.nums").call(c.font,$e.fontFamily||be,$e.fontSize||ce,$e.fontColor||Ce).text(nt).attr("data-notex",1).call(r.positionText,0,0).call(r.convertToTspans,$),At=Je.select("text.name"),dt=0,Ct=0;if(st&&st!==nt){At.call(c.font,$e.fontFamily||be,$e.fontSize||ce,Bt).text(st).attr("data-notex",1).call(r.positionText,0,0).call(r.convertToTspans,$);var Gt=q($,At.node());dt=Gt.width+2*u,Ct=Gt.height+2*u}else At.remove(),Je.select("rect").remove();Je.select("path").style({fill:Tt,stroke:Ce});var rr=$e.xa._offset+($e.x0+$e.x1)/2,kr=$e.ya._offset+($e.y0+$e.y1)/2,br=Math.abs($e.x1-$e.x0),Ar=Math.abs($e.y1-$e.y0),Wr=q($,ct.node()),nr=Wr.width/ne._invScaleX,yr=Wr.height/ne._invScaleY;$e.ty0=(ke-Wr.top)/ne._invScaleY,$e.bx=nr+2*u,$e.by=Math.max(yr+2*u,Ct),$e.anchor="start",$e.txwidth=nr,$e.tx2width=dt,$e.offset=0;var Pr=(nr+b+u+dt)*ne._invScaleX,Or,Sr;if(Q)$e.pos=rr,Or=kr+Ar/2+Pr<=He,Sr=kr-Ar/2-Pr>=0,($e.idealAlign==="top"||!Or)&&Sr?(kr-=Ar/2,$e.anchor="end"):Or?(kr+=Ar/2,$e.anchor="start"):$e.anchor="middle";else if($e.pos=kr,Or=rr+br/2+Pr<=Xe,Sr=rr-br/2-Pr>=0,($e.idealAlign==="left"||!Or)&&Sr)rr-=br/2,$e.anchor="end";else if(Or)rr+=br/2,$e.anchor="start";else{$e.anchor="middle";var tt=Pr/2,Lt=rr+tt-Xe,Wt=rr-tt;Lt>0&&(rr-=Lt),Wt<0&&(rr+=-Wt)}ct.attr("text-anchor",$e.anchor),dt&&At.attr("text-anchor",$e.anchor),Je.attr("transform",e(rr,kr)+(Q?a(m):""))}),wr}function D(V,U,$,ne,X,Q){var ie="",se="";V.nameOverride!==void 0&&(V.name=V.nameOverride),V.name&&(V.trace._meta&&(V.name=M.templateString(V.name,V.trace._meta)),ie=W(V.name,V.nameLength));var ae=$.charAt(0),oe=ae==="x"?"y":"x";V.zLabel!==void 0?(V.xLabel!==void 0&&(se+="x: "+V.xLabel+"<br>"),V.yLabel!==void 0&&(se+="y: "+V.yLabel+"<br>"),V.trace.type!=="choropleth"&&V.trace.type!=="choroplethmapbox"&&(se+=(se?"z: ":"")+V.zLabel)):U&&V[ae+"Label"]===X?se=V[oe+"Label"]||"":V.xLabel===void 0?V.yLabel!==void 0&&V.trace.type!=="scattercarpet"&&(se=V.yLabel):V.yLabel===void 0?se=V.xLabel:se="("+V.xLabel+", "+V.yLabel+")",(V.text||V.text===0)&&!Array.isArray(V.text)&&(se+=(se?"<br>":"")+V.text),V.extraText!==void 0&&(se+=(se?"<br>":"")+V.extraText),Q&&se===""&&!V.hovertemplate&&(ie===""&&Q.remove(),se=ie);var be=V.hovertemplate||!1;if(be){var ce=V.hovertemplateLabels||V;V[ae+"Label"]!==X&&(ce[ae+"other"]=ce[ae+"Val"],ce[ae+"otherLabel"]=ce[ae+"Label"]),se=M.hovertemplateString(be,ce,ne._d3locale,V.eventData[0]||{},V.trace._meta),se=se.replace(z,function(de,ye){return ie=W(ye,V.nameLength),""})}return[se,ie]}function R(V,U,$){var ne=0,X=1,Q=V.size(),ie=new Array(Q),se=0;V.each(function(Ie){var De=Ie[U],Ge=De._id.charAt(0)==="x",ht=De.range;se===0&&ht&&ht[0]>ht[1]!==Ge&&(X=-1),ie[se++]=[{datum:Ie,traceIndex:Ie.trace.index,dp:0,pos:Ie.pos,posref:Ie.posref,size:Ie.by*(Ge?w:1)/2,pmin:0,pmax:Ge?$.width:$.height}]}),ie.sort(function(Ie,De){return Ie[0].posref-De[0].posref||X*(De[0].traceIndex-Ie[0].traceIndex)});var ae,oe,be,ce,de,ye,ge;function me(Ie){var De=Ie[0],Ge=Ie[Ie.length-1];if(oe=De.pmin-De.pos-De.dp+De.size,be=Ge.pos+Ge.dp+Ge.size-De.pmax,oe>.01){for(de=Ie.length-1;de>=0;de--)Ie[de].dp+=oe;ae=!1}if(!(be<.01)){if(oe<-.01){for(de=Ie.length-1;de>=0;de--)Ie[de].dp-=be;ae=!1}if(!!ae){var ht=0;for(ce=0;ce<Ie.length;ce++)ye=Ie[ce],ye.pos+ye.dp+ye.size>De.pmax&&ht++;for(ce=Ie.length-1;ce>=0&&!(ht<=0);ce--)ye=Ie[ce],ye.pos>De.pmax-1&&(ye.del=!0,ht--);for(ce=0;ce<Ie.length&&!(ht<=0);ce++)if(ye=Ie[ce],ye.pos<De.pmin+1)for(ye.del=!0,ht--,be=ye.size*2,de=Ie.length-1;de>=0;de--)Ie[de].dp-=be;for(ce=Ie.length-1;ce>=0&&!(ht<=0);ce--)ye=Ie[ce],ye.pos+ye.dp+ye.size>De.pmax&&(ye.del=!0,ht--)}}}for(;!ae&&ne<=Q;){for(ne++,ae=!0,ce=0;ce<ie.length-1;){var Ee=ie[ce],Pe=ie[ce+1],Ne=Ee[Ee.length-1],we=Pe[0];if(oe=Ne.pos+Ne.dp+Ne.size-we.pos-we.dp+we.size,oe>.01&&Ne.pmin===we.pmin&&Ne.pmax===we.pmax){for(de=Pe.length-1;de>=0;de--)Pe[de].dp+=oe;for(Ee.push.apply(Ee,Pe),ie.splice(ce+1,1),ge=0,de=Ee.length-1;de>=0;de--)ge+=Ee[de].dp;for(be=ge/Ee.length,de=Ee.length-1;de>=0;de--)Ee[de].dp-=be;ae=!1}else ce++}ie.forEach(me)}for(ce=ie.length-1;ce>=0;ce--){var ke=ie[ce];for(de=ke.length-1;de>=0;de--){var Xe=ke[de],He=Xe.datum;He.offset=Xe.dp,He.del=Xe.del}}}function O(V,U,$,ne){var X=function(ie){return ie*$},Q=function(ie){return ie*ne};V.each(function(ie){var se=A.select(this);if(ie.del)return se.remove();var ae=se.select("text.nums"),oe=ie.anchor,be=oe==="end"?-1:1,ce={start:1,end:-1,middle:0}[oe],de=ce*(b+u),ye=de+ce*(ie.txwidth+u),ge=0,me=ie.offset,Ee=oe==="middle";Ee&&(de-=ie.tx2width/2,ye+=ie.txwidth/2+u),U&&(me*=-h,ge=ie.offset*_),se.select("path").attr("d",Ee?"M-"+X(ie.bx/2+ie.tx2width/2)+","+Q(me-ie.by/2)+"h"+X(ie.bx)+"v"+Q(ie.by)+"h-"+X(ie.bx)+"Z":"M0,0L"+X(be*b+ge)+","+Q(b+me)+"v"+Q(ie.by/2-b)+"h"+X(be*ie.bx)+"v-"+Q(ie.by)+"H"+X(be*b+ge)+"V"+Q(me-b)+"Z");var Pe=ge+de,Ne=me+ie.ty0-ie.by/2+u,we=ie.textAlign||"auto";we!=="auto"&&(we==="left"&&oe!=="start"?(ae.attr("text-anchor","start"),Pe=Ee?-ie.bx/2-ie.tx2width/2+u:-ie.bx-u):we==="right"&&oe!=="end"&&(ae.attr("text-anchor","end"),Pe=Ee?ie.bx/2-ie.tx2width/2-u:ie.bx+u)),ae.call(r.positionText,X(Pe),Q(Ne)),ie.tx2width&&(se.select("text.name").call(r.positionText,X(ye+ce*u+ge),Q(me+ie.ty0-ie.by/2+u)),se.select("rect").call(c.setRect,X(ye+(ce-1)*ie.tx2width/2+ge),Q(me-ie.by/2-1),X(ie.tx2width),Q(ie.by+2)))})}function F(V,U){var $=V.index,ne=V.trace||{},X=V.cd[0],Q=V.cd[$]||{};function ie(de){return de||g(de)&&de===0}var se=Array.isArray($)?function(de,ye){var ge=M.castOption(X,$,de);return ie(ge)?ge:M.extractOption({},ne,"",ye)}:function(de,ye){return M.extractOption(Q,ne,de,ye)};function ae(de,ye,ge){var me=se(ye,ge);ie(me)&&(V[de]=me)}if(ae("hoverinfo","hi","hoverinfo"),ae("bgcolor","hbg","hoverlabel.bgcolor"),ae("borderColor","hbc","hoverlabel.bordercolor"),ae("fontFamily","htf","hoverlabel.font.family"),ae("fontSize","hts","hoverlabel.font.size"),ae("fontColor","htc","hoverlabel.font.color"),ae("nameLength","hnl","hoverlabel.namelength"),ae("textAlign","hta","hoverlabel.align"),V.posref=U==="y"||U==="closest"&&ne.orientation==="h"?V.xa._offset+(V.x0+V.x1)/2:V.ya._offset+(V.y0+V.y1)/2,V.x0=M.constrain(V.x0,0,V.xa._length),V.x1=M.constrain(V.x1,0,V.xa._length),V.y0=M.constrain(V.y0,0,V.ya._length),V.y1=M.constrain(V.y1,0,V.ya._length),V.xLabelVal!==void 0&&(V.xLabel="xLabel"in V?V.xLabel:x.hoverLabelText(V.xa,V.xLabelVal,ne.xhoverformat),V.xVal=V.xa.c2d(V.xLabelVal)),V.yLabelVal!==void 0&&(V.yLabel="yLabel"in V?V.yLabel:x.hoverLabelText(V.ya,V.yLabelVal,ne.yhoverformat),V.yVal=V.ya.c2d(V.yLabelVal)),V.zLabelVal!==void 0&&V.zLabel===void 0&&(V.zLabel=String(V.zLabelVal)),!isNaN(V.xerr)&&!(V.xa.type==="log"&&V.xerr<=0)){var oe=x.tickText(V.xa,V.xa.c2l(V.xerr),"hover").text;V.xerrneg!==void 0?V.xLabel+=" +"+oe+" / -"+x.tickText(V.xa,V.xa.c2l(V.xerrneg),"hover").text:V.xLabel+=" \xB1 "+oe,U==="x"&&(V.distance+=1)}if(!isNaN(V.yerr)&&!(V.ya.type==="log"&&V.yerr<=0)){var be=x.tickText(V.ya,V.ya.c2l(V.yerr),"hover").text;V.yerrneg!==void 0?V.yLabel+=" +"+be+" / -"+x.tickText(V.ya,V.ya.c2l(V.yerrneg),"hover").text:V.yLabel+=" \xB1 "+be,U==="y"&&(V.distance+=1)}var ce=V.hoverinfo||V.trace.hoverinfo;return ce&&ce!=="all"&&(ce=Array.isArray(ce)?ce:ce.split("+"),ce.indexOf("x")===-1&&(V.xLabel=void 0),ce.indexOf("y")===-1&&(V.yLabel=void 0),ce.indexOf("z")===-1&&(V.zLabel=void 0),ce.indexOf("text")===-1&&(V.text=void 0),ce.indexOf("name")===-1&&(V.name=void 0)),V}function N(V,U,$){var ne=$.container,X=$.fullLayout,Q=X._size,ie=$.event,se=!!U.hLinePoint,ae=!!U.vLinePoint,oe,be;if(ne.selectAll(".spikeline").remove(),!!(ae||se)){var ce=s.combine(X.plot_bgcolor,X.paper_bgcolor);if(se){var de=U.hLinePoint,ye,ge;oe=de&&de.xa,be=de&&de.ya;var me=be.spikesnap;me==="cursor"?(ye=ie.pointerX,ge=ie.pointerY):(ye=oe._offset+de.x,ge=be._offset+de.y);var Ee=S.readability(de.color,ce)<1.5?s.contrast(ce):de.color,Pe=be.spikemode,Ne=be.spikethickness,we=be.spikecolor||Ee,ke=x.getPxPosition(V,be),Xe,He;if(Pe.indexOf("toaxis")!==-1||Pe.indexOf("across")!==-1){if(Pe.indexOf("toaxis")!==-1&&(Xe=ke,He=ye),Pe.indexOf("across")!==-1){var Ie=be._counterDomainMin,De=be._counterDomainMax;be.anchor==="free"&&(Ie=Math.min(Ie,be.position),De=Math.max(De,be.position)),Xe=Q.l+Ie*Q.w,He=Q.l+De*Q.w}ne.insert("line",":first-child").attr({x1:Xe,x2:He,y1:ge,y2:ge,"stroke-width":Ne,stroke:we,"stroke-dasharray":c.dashStyle(be.spikedash,Ne)}).classed("spikeline",!0).classed("crisp",!0),ne.insert("line",":first-child").attr({x1:Xe,x2:He,y1:ge,y2:ge,"stroke-width":Ne+2,stroke:ce}).classed("spikeline",!0).classed("crisp",!0)}Pe.indexOf("marker")!==-1&&ne.insert("circle",":first-child").attr({cx:ke+(be.side!=="right"?Ne:-Ne),cy:ge,r:Ne,fill:we}).classed("spikeline",!0)}if(ae){var Ge=U.vLinePoint,ht,Rt;oe=Ge&&Ge.xa,be=Ge&&Ge.ya;var Kt=oe.spikesnap;Kt==="cursor"?(ht=ie.pointerX,Rt=ie.pointerY):(ht=oe._offset+Ge.x,Rt=be._offset+Ge.y);var It=S.readability(Ge.color,ce)<1.5?s.contrast(ce):Ge.color,Mt=oe.spikemode,Yt=oe.spikethickness,zt=oe.spikecolor||It,St=x.getPxPosition(V,oe),Ye,rt;if(Mt.indexOf("toaxis")!==-1||Mt.indexOf("across")!==-1){if(Mt.indexOf("toaxis")!==-1&&(Ye=St,rt=Rt),Mt.indexOf("across")!==-1){var Ve=oe._counterDomainMin,Ae=oe._counterDomainMax;oe.anchor==="free"&&(Ve=Math.min(Ve,oe.position),Ae=Math.max(Ae,oe.position)),Ye=Q.t+(1-Ae)*Q.h,rt=Q.t+(1-Ve)*Q.h}ne.insert("line",":first-child").attr({x1:ht,x2:ht,y1:Ye,y2:rt,"stroke-width":Yt,stroke:zt,"stroke-dasharray":c.dashStyle(oe.spikedash,Yt)}).classed("spikeline",!0).classed("crisp",!0),ne.insert("line",":first-child").attr({x1:ht,x2:ht,y1:Ye,y2:rt,"stroke-width":Yt+2,stroke:ce}).classed("spikeline",!0).classed("crisp",!0)}Mt.indexOf("marker")!==-1&&ne.insert("circle",":first-child").attr({cx:ht,cy:St-(oe.side!=="top"?Yt:-Yt),r:Yt,fill:zt}).classed("spikeline",!0)}}}function G(V,U,$){if(!$||$.length!==V._hoverdata.length)return!0;for(var ne=$.length-1;ne>=0;ne--){var X=$[ne],Q=V._hoverdata[ne];if(X.curveNumber!==Q.curveNumber||String(X.pointNumber)!==String(Q.pointNumber)||String(X.pointNumbers)!==String(Q.pointNumbers))return!0}return!1}function K(V,U){return!U||U.vLinePoint!==V._spikepoints.vLinePoint||U.hLinePoint!==V._spikepoints.hLinePoint}function W(V,U){return r.plainText(V||"",{len:U,allowedTags:["br","sub","sup","b","i","em"]})}function Y(V,U){for(var $=U.charAt(0),ne=[],X=[],Q=[],ie=0;ie<V.length;ie++){var se=V[ie];p.traceIs(se.trace,"bar-like")||p.traceIs(se.trace,"box-violin")?Q.push(se):se.trace[$+"period"]?X.push(se):ne.push(se)}return ne.concat(X).concat(Q)}function re(V,U,$){var ne=U[V+"a"],X=U[V+"Val"],Q=U.cd[0];if(ne.type==="category"||ne.type==="multicategory")X=ne._categoriesMap[X];else if(ne.type==="date"){var ie=U.trace[V+"periodalignment"];if(ie){var se=U.cd[U.index],ae=se[V+"Start"];ae===void 0&&(ae=se[V]);var oe=se[V+"End"];oe===void 0&&(oe=se[V]);var be=oe-ae;ie==="end"?X+=be:ie==="middle"&&(X+=be/2)}X=ne.d2c(X)}return Q&&Q.t&&Q.t.posLetter===ne._id&&($.boxmode==="group"||$.violinmode==="group")&&(X+=Q.t.dPos),X}function ue(V){return V.offsetTop+V.clientTop}function j(V){return V.offsetLeft+V.clientLeft}function q(V,U){var $=V._fullLayout,ne=U.getBoundingClientRect(),X=ne.x,Q=ne.y,ie=X+ne.width,se=Q+ne.height,ae=M.apply3DTransform($._invTransform)(X,Q),oe=M.apply3DTransform($._invTransform)(ie,se),be=ae[0],ce=ae[1],de=oe[0],ye=oe[1];return{x:be,y:ce,width:de-be,height:ye-ce,top:Math.min(ce,ye),left:Math.min(be,de),right:Math.max(be,de),bottom:Math.max(ce,ye)}}},{"../../lib":515,"../../lib/events":504,"../../lib/override_cursor":526,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../legend/defaults":419,"../legend/draw":420,"./constants":401,"./helpers":403,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],405:[function(d,ee,te){var A=d("../../lib"),g=d("../color"),S=d("./helpers").isUnifiedHover;ee.exports=function(e,a,n,r){r=r||{};var t=a.legend;function c(s){r.font[s]||(r.font[s]=t?a.legend.font[s]:a.font[s])}a&&S(a.hovermode)&&(r.font||(r.font={}),c("size"),c("family"),c("color"),t?(r.bgcolor||(r.bgcolor=g.combine(a.legend.bgcolor,a.paper_bgcolor)),r.bordercolor||(r.bordercolor=a.legend.bordercolor)):r.bgcolor||(r.bgcolor=a.paper_bgcolor)),n("hoverlabel.bgcolor",r.bgcolor),n("hoverlabel.bordercolor",r.bordercolor),n("hoverlabel.namelength",r.namelength),A.coerceFont(n,"hoverlabel.font",r.font),n("hoverlabel.align",r.align)}},{"../../lib":515,"../color":367,"./helpers":403}],406:[function(d,ee,te){var A=d("../../lib"),g=d("./layout_attributes");ee.exports=function(M,e){function a(n,r){return e[n]!==void 0?e[n]:A.coerce(M,e,g,n,r)}return a("clickmode"),a("hovermode")}},{"../../lib":515,"./layout_attributes":408}],407:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=d("../dragelement"),M=d("./helpers"),e=d("./layout_attributes"),a=d("./hover");ee.exports={moduleType:"component",name:"fx",constants:d("./constants"),schema:{layout:e},attributes:d("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:d("./layout_global_defaults"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),getDistanceFunction:M.getDistanceFunction,getClosest:M.getClosest,inbox:M.inbox,quadrature:M.quadrature,appendArrayPointValue:M.appendArrayPointValue,castHoverOption:r,castHoverinfo:t,hover:a.hover,unhover:S.unhover,loneHover:a.loneHover,loneUnhover:n,click:d("./click")};function n(c){var s=g.isD3Selection(c)?c:A.select(c);s.selectAll("g.hovertext").remove(),s.selectAll(".spikeline").remove()}function r(c,s,i){return g.castOption(c,s,"hoverlabel."+i)}function t(c,s,i){function x(p){return g.coerceHoverinfo({hoverinfo:p},{_module:c._module},s)}return g.castOption(c,i,"hoverinfo",x)}},{"../../lib":515,"../dragelement":386,"./attributes":398,"./calc":399,"./click":400,"./constants":401,"./defaults":402,"./helpers":403,"./hover":404,"./layout_attributes":408,"./layout_defaults":409,"./layout_global_defaults":410,"@plotly/d3":58}],408:[function(d,ee,te){var A=d("./constants"),g=d("../../plots/font_attributes"),S=g({editType:"none"});S.family.dflt=A.HOVERFONT,S.size.dflt=A.HOVERFONTSIZE,ee.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:S,grouptitlefont:g({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":594,"./constants":401}],409:[function(d,ee,te){var A=d("../../lib"),g=d("./layout_attributes"),S=d("./hovermode_defaults"),M=d("./hoverlabel_defaults");ee.exports=function(a,n){function r(p,v){return A.coerce(a,n,g,p,v)}var t=S(a,n);t&&(r("hoverdistance"),r("spikedistance"));var c=r("dragmode");c==="select"&&r("selectdirection");var s=n._has("mapbox"),i=n._has("geo"),x=n._basePlotModules.length;n.dragmode==="zoom"&&((s||i)&&x===1||s&&i&&x===2)&&(n.dragmode="pan"),M(a,n,r),A.coerceFont(r,"hoverlabel.grouptitlefont",n.hoverlabel.font)}},{"../../lib":515,"./hoverlabel_defaults":405,"./hovermode_defaults":406,"./layout_attributes":408}],410:[function(d,ee,te){var A=d("../../lib"),g=d("./hoverlabel_defaults"),S=d("./layout_attributes");ee.exports=function(e,a){function n(r,t){return A.coerce(e,a,S,r,t)}g(e,a,n)}},{"../../lib":515,"./hoverlabel_defaults":405,"./layout_attributes":408}],411:[function(d,ee,te){var A=d("../../lib"),g=d("../../lib/regex").counter,S=d("../../plots/domain").attributes,M=d("../../plots/cartesian/constants").idRegex,e=d("../../plot_api/plot_template"),a={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[g("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[M.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[M.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:S({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function n(i,x,p){var v=x[p+"axes"],f=Object.keys((i._splomAxes||{})[p]||{});if(Array.isArray(v))return v;if(f.length)return f}function r(i,x){var p=i.grid||{},v=n(x,p,"x"),f=n(x,p,"y");if(!i.grid&&!v&&!f)return;var y=Array.isArray(p.subplots)&&Array.isArray(p.subplots[0]),o=Array.isArray(v),m=Array.isArray(f),l=o&&v!==p.xaxes&&m&&f!==p.yaxes,w,_;y?(w=p.subplots.length,_=p.subplots[0].length):(m&&(w=f.length),o&&(_=v.length));var h=e.newContainer(x,"grid");function b(O,F){return A.coerce(p,h,a,O,F)}var u=b("rows",w),L=b("columns",_);if(!(u*L>1)){delete x.grid;return}if(!y&&!o&&!m){var T=b("pattern")==="independent";T&&(y=!0)}h._hasSubplotGrid=y;var k=b("roworder"),P=k==="top to bottom",z=y?.2:.1,I=y?.3:.1,D,R;l&&x._splomGridDflt&&(D=x._splomGridDflt.xside,R=x._splomGridDflt.yside),h._domains={x:t("x",b,z,D,L),y:t("y",b,I,R,u,P)}}function t(i,x,p,v,f,y){var o=x(i+"gap",p),m=x("domain."+i);x(i+"side",v);for(var l=new Array(f),w=m[0],_=(m[1]-w)/(f-o),h=_*(1-o),b=0;b<f;b++){var u=w+_*b;l[y?f-1-b:b]=[u,u+h]}return l}function c(i,x){var p=x.grid;if(!(!p||!p._domains)){var v=i.grid||{},f=x._subplots,y=p._hasSubplotGrid,o=p.rows,m=p.columns,l=p.pattern==="independent",w,_,h,b,u,L,T,k=p._axisMap={};if(y){var P=v.subplots||[];L=p.subplots=new Array(o);var z=1;for(w=0;w<o;w++){var I=L[w]=new Array(m),D=P[w]||[];for(_=0;_<m;_++)if(l?(u=z===1?"xy":"x"+z+"y"+z,z++):u=D[_],I[_]="",f.cartesian.indexOf(u)!==-1){if(T=u.indexOf("y"),h=u.slice(0,T),b=u.slice(T),k[h]!==void 0&&k[h]!==_||k[b]!==void 0&&k[b]!==w)continue;I[_]=u,k[h]=_,k[b]=w}}}else{var R=n(x,v,"x"),O=n(x,v,"y");p.xaxes=s(R,f.xaxis,m,k,"x"),p.yaxes=s(O,f.yaxis,o,k,"y")}var F=p._anchors={},N=p.roworder==="top to bottom";for(var G in k){var K=G.charAt(0),W=p[K+"side"],Y,re,ue;if(W.length<8)F[G]="free";else if(K==="x"){if(W.charAt(0)==="t"===N?(Y=0,re=1,ue=o):(Y=o-1,re=-1,ue=-1),y){var j=k[G];for(w=Y;w!==ue;w+=re)if(u=L[w][j],!!u&&(T=u.indexOf("y"),u.slice(0,T)===G)){F[G]=u.slice(T);break}}else for(w=Y;w!==ue;w+=re)if(b=p.yaxes[w],f.cartesian.indexOf(G+b)!==-1){F[G]=b;break}}else if(W.charAt(0)==="l"?(Y=0,re=1,ue=m):(Y=m-1,re=-1,ue=-1),y){var q=k[G];for(w=Y;w!==ue;w+=re)if(u=L[q][w],!!u&&(T=u.indexOf("y"),u.slice(T)===G)){F[G]=u.slice(0,T);break}}else for(w=Y;w!==ue;w+=re)if(h=p.xaxes[w],f.cartesian.indexOf(h+G)!==-1){F[G]=h;break}}}}function s(i,x,p,v,f){var y=new Array(p),o;function m(l,w){x.indexOf(w)!==-1&&v[w]===void 0?(y[l]=w,v[w]=l):y[l]=""}if(Array.isArray(i))for(o=0;o<p;o++)m(o,i[o]);else for(m(0,f),o=1;o<p;o++)m(o,f+(o+1));return y}ee.exports={moduleType:"component",name:"grid",schema:{layout:{grid:a}},layoutAttributes:a,sizeDefaults:r,contentDefaults:c}},{"../../lib":515,"../../lib/regex":532,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/domain":593}],412:[function(d,ee,te){var A=d("../../plots/cartesian/constants"),g=d("../../plot_api/plot_template").templatedArray;d("../../constants/axis_placeable_objects"),ee.exports=g("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",A.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",A.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573}],413:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib/to_log_range");ee.exports=function(M,e,a,n){e=e||{};var r=a==="log"&&e.type==="linear",t=a==="linear"&&e.type==="log";if(!!(r||t)){for(var c=M._fullLayout.images,s=e._id.charAt(0),i,x,p=0;p<c.length;p++)if(i=c[p],x="images["+p+"].",i[s+"ref"]===e._id){var v=i[s],f=i["size"+s],y=null,o=null;if(r){y=g(v,e.range);var m=f/Math.pow(10,y)/2;o=2*Math.log(m+Math.sqrt(1+m*m))/Math.LN10}else y=Math.pow(10,v),o=y*(Math.pow(10,f/2)-Math.pow(10,-f/2));A(y)?A(o)||(o=null):(y=null,o=null),n(x+s,y),n(x+"size"+s,o)}}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],414:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axes"),S=d("../../plots/array_container_defaults"),M=d("./attributes"),e="images";ee.exports=function(r,t){var c={name:e,handleItemDefaults:a};S(r,t,c)};function a(n,r,t){function c(m,l){return A.coerce(n,r,M,m,l)}var s=c("source"),i=c("visible",!!s);if(!i)return r;c("layer"),c("xanchor"),c("yanchor"),c("sizex"),c("sizey"),c("sizing"),c("opacity");for(var x={_fullLayout:t},p=["x","y"],v=0;v<2;v++){var f=p[v],y=g.coerceRef(n,r,x,f,"paper",void 0);if(y!=="paper"){var o=g.getFromId(x,y);o._imgIndices.push(r._index)}g.coercePosition(r,x,c,y,f,0)}return r}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":412}],415:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../drawing"),S=d("../../plots/cartesian/axes"),M=d("../../plots/cartesian/axis_ids"),e=d("../../constants/xmlns_namespaces");ee.exports=function(n){var r=n._fullLayout,t=[],c={},s=[],i,x;for(x=0;x<r.images.length;x++){var p=r.images[x];if(p.visible)if(p.layer==="below"&&p.xref!=="paper"&&p.yref!=="paper"){i=M.ref2id(p.xref)+M.ref2id(p.yref);var v=r._plots[i];if(!v){s.push(p);continue}v.mainplot&&(i=v.mainplot.id),c[i]||(c[i]=[]),c[i].push(p)}else p.layer==="above"?t.push(p):s.push(p)}var f={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}};function y(b){var u=A.select(this);if(this._imgSrc!==b.source)if(u.attr("xmlns",e.svg),b.source&&b.source.slice(0,5)==="data:")u.attr("xlink:href",b.source),this._imgSrc=b.source;else{var L=new Promise(function(T){var k=new Image;this.img=k,k.setAttribute("crossOrigin","anonymous"),k.onerror=P,k.onload=function(){var z=document.createElement("canvas");z.width=this.width,z.height=this.height;var I=z.getContext("2d",{willReadFrequently:!0});I.drawImage(this,0,0);var D=z.toDataURL("image/png");u.attr("xlink:href",D),T()},u.on("error",P),k.src=b.source,this._imgSrc=b.source;function P(){u.remove(),T()}}.bind(this));n._promises.push(L)}}function o(b){var u=A.select(this),L=S.getFromId(n,b.xref),T=S.getFromId(n,b.yref),k=S.getRefType(b.xref)==="domain",P=S.getRefType(b.yref)==="domain",z=r._size,I,D;L!==void 0?I=typeof b.xref=="string"&&k?L._length*b.sizex:Math.abs(L.l2p(b.sizex)-L.l2p(0)):I=b.sizex*z.w,T!==void 0?D=typeof b.yref=="string"&&P?T._length*b.sizey:Math.abs(T.l2p(b.sizey)-T.l2p(0)):D=b.sizey*z.h;var R=I*f.x[b.xanchor].offset,O=D*f.y[b.yanchor].offset,F=f.x[b.xanchor].sizing+f.y[b.yanchor].sizing,N,G;switch(L!==void 0?N=typeof b.xref=="string"&&k?L._length*b.x+L._offset:L.r2p(b.x)+L._offset:N=b.x*z.w+z.l,N+=R,T!==void 0?G=typeof b.yref=="string"&&P?T._length*(1-b.y)+T._offset:T.r2p(b.y)+T._offset:G=z.h-b.y*z.h+z.t,G+=O,b.sizing){case"fill":F+=" slice";break;case"stretch":F="none";break}u.attr({x:N,y:G,width:I,height:D,preserveAspectRatio:F,opacity:b.opacity});var K=L&&S.getRefType(b.xref)!=="domain"?L._id:"",W=T&&S.getRefType(b.yref)!=="domain"?T._id:"",Y=K+W;g.setClipUrl(u,Y?"clip"+r._uid+Y:null,n)}var m=r._imageLowerLayer.selectAll("image").data(s),l=r._imageUpperLayer.selectAll("image").data(t);m.enter().append("image"),l.enter().append("image"),m.exit().remove(),l.exit().remove(),m.each(function(b){y.bind(this)(b),o.bind(this)(b)}),l.each(function(b){y.bind(this)(b),o.bind(this)(b)});var w=Object.keys(r._plots);for(x=0;x<w.length;x++){i=w[x];var _=r._plots[i];if(!!_.imagelayer){var h=_.imagelayer.selectAll("image").data(c[i]||[]);h.enter().append("image"),h.exit().remove(),h.each(function(b){y.bind(this)(b),o.bind(this)(b)})}}}},{"../../constants/xmlns_namespaces":492,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../drawing":389,"@plotly/d3":58}],416:[function(d,ee,te){ee.exports={moduleType:"component",name:"images",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),includeBasePlot:d("../../plots/cartesian/include_components")("images"),draw:d("./draw"),convertCoords:d("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":412,"./convert_coords":413,"./defaults":414,"./draw":415}],417:[function(d,ee,te){var A=d("../../plots/font_attributes"),g=d("../color/attributes");ee.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:g.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:A({editType:"legend"}),grouptitlefont:A({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},entrywidth:{valType:"number",min:0,editType:"legend"},entrywidthmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels",editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:A({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":594,"../color/attributes":366}],418:[function(d,ee,te){ee.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],419:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib"),S=d("../../plot_api/plot_template"),M=d("../../plots/attributes"),e=d("./attributes"),a=d("../../plots/layout_attributes"),n=d("./helpers");ee.exports=function(t,c,s){var i=t.legend||{},x=S.newContainer(c,"legend");function p(D,R){return g.coerce(i,x,e,D,R)}for(var v,f=function(D,R){var O=v._input,F=v;return g.coerce(O,F,M,D,R)},y=c.font||{},o=g.coerceFont(p,"grouptitlefont",g.extendFlat({},y,{size:Math.round(y.size*1.1)})),m=0,l=!1,w="normal",_=0;_<s.length;_++)v=s[_],v.visible&&((v.showlegend||v._dfltShowLegend&&!(v._module&&v._module.attributes&&v._module.attributes.showlegend&&v._module.attributes.showlegend.dflt===!1))&&(m++,v.showlegend&&(l=!0,(A.traceIs(v,"pie-like")||v._input.showlegend===!0)&&m++),g.coerceFont(f,"legendgrouptitle.font",o)),(A.traceIs(v,"bar")&&c.barmode==="stack"||["tonextx","tonexty"].indexOf(v.fill)!==-1)&&(w=n.isGrouped({traceorder:w})?"grouped+reversed":"reversed"),v.legendgroup!==void 0&&v.legendgroup!==""&&(w=n.isReversed({traceorder:w})?"reversed+grouped":"grouped"));var h=g.coerce(t,c,a,"showlegend",l&&m>1);if(h===!1&&(c.legend=void 0),!(h===!1&&!i.uirevision)&&(p("uirevision",c.uirevision),h!==!1)){p("bgcolor",c.paper_bgcolor),p("bordercolor"),p("borderwidth");var b=g.coerceFont(p,"font",c.font),u=p("orientation"),L=u==="h",T,k,P;L?(T=0,A.getComponentMethod("rangeslider","isVisible")(t.xaxis)?(k=1.1,P="bottom"):(k=-.1,P="top")):(T=1.02,k=1,P="auto"),p("traceorder",w),n.isGrouped(c.legend)&&p("tracegroupgap"),p("entrywidth"),p("entrywidthmode"),p("itemsizing"),p("itemwidth"),p("itemclick"),p("itemdoubleclick"),p("groupclick"),p("x",T),p("xanchor"),p("y",k),p("yanchor",P),p("valign"),g.noneOrAll(i,x,["x","y"]);var z=p("title.text");if(z){p("title.side",L?"left":"top");var I=g.extendFlat({},b,{size:g.bigFont(b.size)});g.coerceFont(p,"title.font",I)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/layout_attributes":619,"../../registry":647,"./attributes":417,"./helpers":423}],420:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=d("../../plots/plots"),M=d("../../registry"),e=d("../../lib/events"),a=d("../dragelement"),n=d("../drawing"),r=d("../color"),t=d("../../lib/svg_text_utils"),c=d("./handle_click"),s=d("./constants"),i=d("../../constants/alignment"),x=i.LINE_SPACING,p=i.FROM_TL,v=i.FROM_BR,f=d("./get_legend_data"),y=d("./style"),o=d("./helpers"),m=1;ee.exports=function(O,F){return F||(F=O._fullLayout.legend||{}),l(O,F)};function l(R,O){var F=R._fullLayout,N="legend"+F._uid,G,K=O._inHover;if(K?(G=O.layer,N+="-hover"):G=F._infolayer,!!G){R._legendMouseDownTime||(R._legendMouseDownTime=0);var W;if(K){if(!O.entries)return;W=f(O.entries,O)}else{if(!R.calcdata)return;W=F.showlegend&&f(R.calcdata,O)}var Y=F.hiddenlabels||[];if(!K&&(!F.showlegend||!W.length))return G.selectAll(".legend").remove(),F._topdefs.select("#"+N).remove(),S.autoMargin(R,"legend");var re=g.ensureSingle(G,"g","legend",function(Q){K||Q.attr("pointer-events","all")}),ue=g.ensureSingleById(F._topdefs,"clipPath",N,function(Q){Q.append("rect")}),j=g.ensureSingle(re,"rect","bg",function(Q){Q.attr("shape-rendering","crispEdges")});j.call(r.stroke,O.bordercolor).call(r.fill,O.bgcolor).style("stroke-width",O.borderwidth+"px");var q=g.ensureSingle(re,"g","scrollbox"),V=O.title;if(O._titleWidth=0,O._titleHeight=0,V.text){var U=g.ensureSingle(q,"text","legendtitletext");U.attr("text-anchor","start").call(n.font,V.font).text(V.text),L(U,q,R,O,m)}else q.selectAll(".legendtitletext").remove();var $=g.ensureSingle(re,"rect","scrollbar",function(Q){Q.attr(s.scrollBarEnterAttrs).call(r.fill,s.scrollBarColor)}),ne=q.selectAll("g.groups").data(W);ne.enter().append("g").attr("class","groups"),ne.exit().remove();var X=ne.selectAll("g.traces").data(g.identity);X.enter().append("g").attr("class","traces"),X.exit().remove(),X.style("opacity",function(Q){var ie=Q[0].trace;return M.traceIs(ie,"pie-like")?Y.indexOf(Q[0].label)!==-1?.5:1:ie.visible==="legendonly"?.5:1}).each(function(){A.select(this).call(h,R,O)}).call(y,R,O).each(function(){K||A.select(this).call(u,R)}),g.syncOrAsync([S.previousPromises,function(){return P(R,ne,X,O)},function(){var Q=F._size,ie=O.borderwidth;if(!K){var se=z(R);if(se)return;var ae=Q.l+Q.w*O.x-p[I(O)]*O._width,oe=Q.t+Q.h*(1-O.y)-p[D(O)]*O._effHeight;if(F.margin.autoexpand){var be=ae,ce=oe;ae=g.constrain(ae,0,F.width-O._width),oe=g.constrain(oe,0,F.height-O._effHeight),ae!==be&&g.log("Constrain legend.x to make legend fit inside graph"),oe!==ce&&g.log("Constrain legend.y to make legend fit inside graph")}n.setTranslate(re,ae,oe)}if($.on(".drag",null),re.on("wheel",null),K||O._height<=O._maxHeight||R._context.staticPlot){var de=O._effHeight;K&&(de=O._height),j.attr({width:O._width-ie,height:de-ie,x:ie/2,y:ie/2}),n.setTranslate(q,0,0),ue.select("rect").attr({width:O._width-2*ie,height:de-2*ie,x:ie,y:ie}),n.setClipUrl(q,N,R),n.setRect($,0,0,0,0),delete O._scrollY}else{var ye=Math.max(s.scrollBarMinHeight,O._effHeight*O._effHeight/O._height),ge=O._effHeight-ye-2*s.scrollBarMargin,me=O._height-O._effHeight,Ee=ge/me,Pe=Math.min(O._scrollY||0,me);j.attr({width:O._width-2*ie+s.scrollBarWidth+s.scrollBarMargin,height:O._effHeight-ie,x:ie/2,y:ie/2}),ue.select("rect").attr({width:O._width-2*ie+s.scrollBarWidth+s.scrollBarMargin,height:O._effHeight-2*ie,x:ie,y:ie+Pe}),n.setClipUrl(q,N,R),Ge(Pe,ye,Ee),re.on("wheel",function(){Pe=g.constrain(O._scrollY+A.event.deltaY/ge*me,0,me),Ge(Pe,ye,Ee),Pe!==0&&Pe!==me&&A.event.preventDefault()});var Ne,we,ke,Xe=function(Mt,Yt,zt){var St=(zt-Yt)/Ee+Mt;return g.constrain(St,0,me)},He=function(Mt,Yt,zt){var St=(Yt-zt)/Ee+Mt;return g.constrain(St,0,me)},Ie=A.behavior.drag().on("dragstart",function(){var Mt=A.event.sourceEvent;Mt.type==="touchstart"?Ne=Mt.changedTouches[0].clientY:Ne=Mt.clientY,ke=Pe}).on("drag",function(){var Mt=A.event.sourceEvent;Mt.buttons===2||Mt.ctrlKey||(Mt.type==="touchmove"?we=Mt.changedTouches[0].clientY:we=Mt.clientY,Pe=Xe(ke,Ne,we),Ge(Pe,ye,Ee))});$.call(Ie);var De=A.behavior.drag().on("dragstart",function(){var Mt=A.event.sourceEvent;Mt.type==="touchstart"&&(Ne=Mt.changedTouches[0].clientY,ke=Pe)}).on("drag",function(){var Mt=A.event.sourceEvent;Mt.type==="touchmove"&&(we=Mt.changedTouches[0].clientY,Pe=He(ke,Ne,we),Ge(Pe,ye,Ee))});q.call(De)}function Ge(Mt,Yt,zt){O._scrollY=R._fullLayout.legend._scrollY=Mt,n.setTranslate(q,0,-Mt),n.setRect($,O._width,s.scrollBarMargin+Mt*zt,s.scrollBarWidth,Yt),ue.select("rect").attr("y",ie+Mt)}if(R._context.edits.legendPosition){var ht,Rt,Kt,It;re.classed("cursor-move",!0),a.init({element:re.node(),gd:R,prepFn:function(){var Mt=n.getTranslate(re);Kt=Mt.x,It=Mt.y},moveFn:function(Mt,Yt){var zt=Kt+Mt,St=It+Yt;n.setTranslate(re,zt,St),ht=a.align(zt,0,Q.l,Q.l+Q.w,O.xanchor),Rt=a.align(St,0,Q.t+Q.h,Q.t,O.yanchor)},doneFn:function(){ht!==void 0&&Rt!==void 0&&M.call("_guiRelayout",R,{"legend.x":ht,"legend.y":Rt})},clickFn:function(Mt,Yt){var zt=G.selectAll("g.traces").filter(function(){var St=this.getBoundingClientRect();return Yt.clientX>=St.left&&Yt.clientX<=St.right&&Yt.clientY>=St.top&&Yt.clientY<=St.bottom});zt.size()>0&&_(R,re,zt,Mt,Yt)}})}}],R)}}function w(R,O,F){var N=R[0],G=N.width,K=O.entrywidthmode,W=N.trace.legendwidth||O.entrywidth;return K==="fraction"?O._maxWidth*W:F+(W||G)}function _(R,O,F,N,G){var K=F.data()[0][0].trace,W={event:G,node:F.node(),curveNumber:K.index,expandedIndex:K._expandedIndex,data:R.data,layout:R.layout,frames:R._transitionData._frames,config:R._context,fullData:R._fullData,fullLayout:R._fullLayout};K._group&&(W.group=K._group),M.traceIs(K,"pie-like")&&(W.label=F.datum()[0].label);var Y=e.triggerHandler(R,"plotly_legendclick",W);if(Y!==!1){if(N===1)O._clickTimeout=setTimeout(function(){!R._fullLayout||c(F,R,N)},R._context.doubleClickDelay);else if(N===2){O._clickTimeout&&clearTimeout(O._clickTimeout),R._legendMouseDownTime=0;var re=e.triggerHandler(R,"plotly_legenddoubleclick",W);re!==!1&&c(F,R,N)}}}function h(R,O,F){var N=R.data()[0][0],G=N.trace,K=M.traceIs(G,"pie-like"),W=!F._inHover&&O._context.edits.legendText&&!K,Y=F._maxNameLength,re,ue;N.groupTitle?(re=N.groupTitle.text,ue=N.groupTitle.font):(ue=F.font,F.entries?re=N.text:(re=K?N.label:G.name,G._meta&&(re=g.templateString(re,G._meta))));var j=g.ensureSingle(R,"text","legendtext");j.attr("text-anchor","start").call(n.font,ue).text(W?b(re,Y):re);var q=F.itemwidth+s.itemGap*2;t.positionText(j,q,0),W?j.call(t.makeEditable,{gd:O,text:re}).call(L,R,O,F).on("edit",function(V){this.text(b(V,Y)).call(L,R,O,F);var U=N.trace._fullInput||{},$={};if(M.hasTransform(U,"groupby")){var ne=M.getTransformIndices(U,"groupby"),X=ne[ne.length-1],Q=g.keyedContainer(U,"transforms["+X+"].styles","target","value.name");Q.set(N.trace._group,V),$=Q.constructUpdate()}else $.name=V;return M.call("_guiRestyle",O,$,G.index)}):L(j,R,O,F)}function b(R,O){var F=Math.max(4,O);if(R&&R.trim().length>=F/2)return R;R=R||"";for(var N=F-R.length;N>0;N--)R+=" ";return R}function u(R,O){var F=O._context.doubleClickDelay,N,G=1,K=g.ensureSingle(R,"rect","legendtoggle",function(W){O._context.staticPlot||W.style("cursor","pointer").attr("pointer-events","all"),W.call(r.fill,"rgba(0,0,0,0)")});O._context.staticPlot||(K.on("mousedown",function(){N=new Date().getTime(),N-O._legendMouseDownTime<F?G+=1:(G=1,O._legendMouseDownTime=N)}),K.on("mouseup",function(){if(!(O._dragged||O._editing)){var W=O._fullLayout.legend;new Date().getTime()-O._legendMouseDownTime>F&&(G=Math.max(G-1,1)),_(O,W,R,G,A.event)}}))}function L(R,O,F,N,G){N._inHover&&R.attr("data-notex",!0),t.convertToTspans(R,F,function(){T(O,F,N,G)})}function T(R,O,F,N){var G=R.data()[0][0];if(!F._inHover&&G&&!G.trace.showlegend){R.remove();return}var K=R.select("g[class*=math-group]"),W=K.node();F||(F=O._fullLayout.legend);var Y=F.borderwidth,re;N===m?re=F.title.font:G.groupTitle?re=G.groupTitle.font:re=F.font;var ue=re.size*x,j,q;if(W){var V=n.bBox(W);j=V.height,q=V.width,N===m?n.setTranslate(K,Y,Y+j*.75):n.setTranslate(K,0,j*.25)}else{var U=R.select(N===m?".legendtitletext":".legendtext"),$=t.lineCount(U),ne=U.node();if(j=ue*$,q=ne?n.bBox(ne).width:0,N===m)F.title.side==="left"&&(q+=s.itemGap*2),t.positionText(U,Y+s.titlePad,Y+ue);else{var X=s.itemGap*2+F.itemwidth;G.groupTitle&&(X=s.itemGap,q-=F.itemwidth),t.positionText(U,X,-ue*(($-1)/2-.3))}}N===m?(F._titleWidth=q,F._titleHeight=j):(G.lineHeight=ue,G.height=Math.max(j,16)+3,G.width=q)}function k(R){var O=0,F=0,N=R.title.side;return N&&(N.indexOf("left")!==-1&&(O=R._titleWidth),N.indexOf("top")!==-1&&(F=R._titleHeight)),[O,F]}function P(R,O,F,N){var G=R._fullLayout;N||(N=G.legend);var K=G._size,W=o.isVertical(N),Y=o.isGrouped(N),re=N.entrywidthmode==="fraction",ue=N.borderwidth,j=2*ue,q=s.itemGap,V=N.itemwidth+q*2,U=2*(ue+q),$=D(N),ne=N.y<0||N.y===0&&$==="top",X=N.y>1||N.y===1&&$==="bottom",Q=N.tracegroupgap,ie={};N._maxHeight=Math.max(ne||X?G.height/2:K.h,30);var se=0;N._width=0,N._height=0;var ae=k(N);if(W)F.each(function(Kt){var It=Kt[0].height;n.setTranslate(this,ue+ae[0],ue+ae[1]+N._height+It/2+q),N._height+=It,N._width=Math.max(N._width,Kt[0].width)}),se=V+N._width,N._width+=q+V+j,N._height+=U,Y&&(O.each(function(Kt,It){n.setTranslate(this,0,It*N.tracegroupgap)}),N._height+=(N._lgroupsLength-1)*N.tracegroupgap);else{var oe=I(N),be=N.x<0||N.x===0&&oe==="right",ce=N.x>1||N.x===1&&oe==="left",de=X||ne,ye=G.width/2;N._maxWidth=Math.max(be?de&&oe==="left"?K.l+K.w:ye:ce?de&&oe==="right"?K.r+K.w:ye:K.w,2*V);var ge=0,me=0;F.each(function(Kt){var It=w(Kt,N,V);ge=Math.max(ge,It),me+=It}),se=null;var Ee=0;if(Y){var Pe=0,Ne=0,we=0;O.each(function(){var Kt=0,It=0;A.select(this).selectAll("g.traces").each(function(Yt){var zt=w(Yt,N,V),St=Yt[0].height;n.setTranslate(this,ae[0],ae[1]+ue+q+St/2+It),It+=St,Kt=Math.max(Kt,zt),ie[Yt[0].trace.legendgroup]=Kt});var Mt=Kt+q;Ne>0&&Mt+ue+Ne>N._maxWidth?(Ee=Math.max(Ee,Ne),Ne=0,we+=Pe+Q,Pe=It):Pe=Math.max(Pe,It),n.setTranslate(this,Ne,we),Ne+=Mt}),N._width=Math.max(Ee,Ne)+ue,N._height=we+Pe+U}else{var ke=F.size(),Xe=me+j+(ke-1)*q<N._maxWidth,He=0,Ie=0,De=0,Ge=0;F.each(function(Kt){var It=Kt[0].height,Mt=w(Kt,N,V),Yt=Xe?Mt:ge;re||(Yt+=q),Yt+ue+Ie-q>=N._maxWidth&&(Ee=Math.max(Ee,Ge),Ie=0,De+=He,N._height+=He,He=0),n.setTranslate(this,ae[0]+ue+Ie,ae[1]+ue+De+It/2+q),Ge=Ie+Mt+q,Ie+=Yt,He=Math.max(He,It)}),Xe?(N._width=Ie+j,N._height=He+U):(N._width=Math.max(Ee,Ge)+j,N._height+=He+U)}}N._width=Math.ceil(Math.max(N._width+ae[0],N._titleWidth+2*(ue+s.titlePad))),N._height=Math.ceil(Math.max(N._height+ae[1],N._titleHeight+2*(ue+s.itemGap))),N._effHeight=Math.min(N._height,N._maxHeight);var ht=R._context.edits,Rt=ht.legendText||ht.legendPosition;F.each(function(Kt){var It=A.select(this).select(".legendtoggle"),Mt=Kt[0].height,Yt=Kt[0].trace.legendgroup,zt=w(Kt,N,V);Y&&Yt!==""&&(zt=ie[Yt]);var St=Rt?V:se||zt;!W&&!re&&(St+=q/2),n.setRect(It,0,-Mt/2,St,Mt)})}function z(R){var O=R._fullLayout,F=O.legend,N=I(F),G=D(F);return S.autoMargin(R,"legend",{x:F.x,y:F.y,l:F._width*p[N],r:F._width*v[N],b:F._effHeight*v[G],t:F._effHeight*p[G]})}function I(R){return g.isRightAnchor(R)?"right":g.isCenterAnchor(R)?"center":"left"}function D(R){return g.isBottomAnchor(R)?"bottom":g.isMiddleAnchor(R)?"middle":"top"}},{"../../constants/alignment":483,"../../lib":515,"../../lib/events":504,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":418,"./get_legend_data":421,"./handle_click":422,"./helpers":423,"./style":425,"@plotly/d3":58}],421:[function(d,ee,te){var A=d("../../registry"),g=d("./helpers");ee.exports=function(M,e){var a=e._inHover,n=g.isGrouped(e),r=g.isReversed(e),t={},c=[],s=!1,i={},x=0,p=0,v,f;function y(O,F){if(O===""||!g.isGrouped(e)){var N="~~i"+x;c.push(N),t[N]=[F],x++}else c.indexOf(O)===-1?(c.push(O),s=!0,t[O]=[F]):t[O].push(F)}for(v=0;v<M.length;v++){var o=M[v],m=o[0],l=m.trace,w=l.legendgroup;if(!(!a&&(!l.visible||!l.showlegend)))if(A.traceIs(l,"pie-like"))for(i[w]||(i[w]={}),f=0;f<o.length;f++){var _=o[f].label;i[w][_]||(y(w,{label:_,color:o[f].color,i:o[f].i,trace:l,pts:o[f].pts}),i[w][_]=!0,p=Math.max(p,(_||"").length))}else y(w,m),p=Math.max(p,(l.name||"").length)}if(!c.length)return[];var h=!s||!n,b=[];for(v=0;v<c.length;v++){var u=t[c[v]];h?b.push(u[0]):b.push(u)}for(h&&(b=[b]),v=0;v<b.length;v++){var L=1/0;for(f=0;f<b[v].length;f++){var T=b[v][f].trace.legendrank;L>T&&(L=T)}b[v][0]._groupMinRank=L,b[v][0]._preGroupSort=v}var k=function(O,F){return O[0]._groupMinRank-F[0]._groupMinRank||O[0]._preGroupSort-F[0]._preGroupSort},P=function(O,F){return O.trace.legendrank-F.trace.legendrank||O._preSort-F._preSort};for(b.forEach(function(O,F){O[0]._preGroupSort=F}),b.sort(k),v=0;v<b.length;v++){b[v].forEach(function(O,F){O._preSort=F}),b[v].sort(P);var z=b[v][0].trace,I=null;for(f=0;f<b[v].length;f++){var D=b[v][f].trace.legendgrouptitle;if(D&&D.text){I=D,a&&(D.font=e._groupTitleFont);break}}if(r&&b[v].reverse(),I){var R=!1;for(f=0;f<b[v].length;f++)if(A.traceIs(b[v][f].trace,"pie-like")){R=!0;break}b[v].unshift({i:-1,groupTitle:I,noClick:R,trace:{showlegend:z.showlegend,legendgroup:z.legendgroup,visible:e.groupclick==="toggleitem"?!0:z.visible}})}for(f=0;f<b[v].length;f++)b[v][f]=[b[v][f]]}return e._lgroupsLength=b.length,e._maxNameLength=p,b}},{"../../registry":647,"./helpers":423}],422:[function(d,ee,te){var A=d("../../lib"),g=d("../../registry"),S=!0;ee.exports=function(e,a,n){var r=a._fullLayout;if(a._dragged||a._editing)return;var t=r.legend.itemclick,c=r.legend.itemdoubleclick,s=r.legend.groupclick;n===1&&t==="toggle"&&c==="toggleothers"&&S&&a.data&&a._context.showTips&&A.notifier(A._(a,"Double-click on legend to isolate one trace"),"long"),S=!1;var i;if(n===1?i=t:n===2&&(i=c),!i)return;var x=s==="togglegroup",p=r.hiddenlabels?r.hiddenlabels.slice():[],v=e.data()[0][0];if(v.groupTitle&&v.noClick)return;var f=a._fullData,y=v.trace,o=y.legendgroup,m,l,w,_,h,b,u={},L=[],T=[],k=[];function P(q,V,U){var $=L.indexOf(q),ne=u[V];return ne||(ne=u[V]=[]),L.indexOf(q)===-1&&(L.push(q),$=L.length-1),ne[$]=U,$}function z(q,V){if(!(v.groupTitle&&!x)){var U=q._fullInput;if(g.hasTransform(U,"groupby")){var $=T[U.index];if(!$){var ne=g.getTransformIndices(U,"groupby"),X=ne[ne.length-1];$=A.keyedContainer(U,"transforms["+X+"].styles","target","value.visible"),T[U.index]=$}var Q=$.get(q._group);Q===void 0&&(Q=!0),Q!==!1&&$.set(q._group,V),k[U.index]=P(U.index,"visible",U.visible!==!1)}else{var ie=U.visible===!1?!1:V;P(U.index,"visible",ie)}}}if(g.traceIs(y,"pie-like")){var I=v.label,D=p.indexOf(I);i==="toggle"?D===-1?p.push(I):p.splice(D,1):i==="toggleothers"&&(p=[],a.calcdata[0].forEach(function(q){I!==q.label&&p.push(q.label)}),a._fullLayout.hiddenlabels&&a._fullLayout.hiddenlabels.length===p.length&&D===-1&&(p=[])),g.call("_guiRelayout",a,"hiddenlabels",p)}else{var R=o&&o.length,O=[],F;if(R)for(m=0;m<f.length;m++)F=f[m],!!F.visible&&F.legendgroup===o&&O.push(m);if(i==="toggle"){var N;switch(y.visible){case!0:N="legendonly";break;case!1:N=!1;break;case"legendonly":N=!0;break}if(R)if(x)for(m=0;m<f.length;m++)f[m].visible!==!1&&f[m].legendgroup===o&&z(f[m],N);else z(y,N);else z(y,N)}else if(i==="toggleothers"){var G,K,W,Y,re=!0;for(m=0;m<f.length;m++)if(G=f[m]===y,W=f[m].showlegend!==!0,!(G||W)&&(K=R&&f[m].legendgroup===o,!K&&f[m].visible===!0&&!g.traceIs(f[m],"notLegendIsolatable"))){re=!1;break}for(m=0;m<f.length;m++)if(f[m].visible!==!1&&!g.traceIs(f[m],"notLegendIsolatable"))switch(y.visible){case"legendonly":z(f[m],!0);break;case!0:Y=re?!0:"legendonly",G=f[m]===y,W=f[m].showlegend!==!0&&!f[m].legendgroup,K=G||R&&f[m].legendgroup===o,z(f[m],K||W?!0:Y);break}}for(m=0;m<T.length;m++)if(w=T[m],!!w){var ue=w.constructUpdate(),j=Object.keys(ue);for(l=0;l<j.length;l++)_=j[l],b=u[_]=u[_]||[],b[k[m]]=ue[_]}for(h=Object.keys(u),m=0;m<h.length;m++)for(_=h[m],l=0;l<L.length;l++)u[_].hasOwnProperty(l)||(u[_][l]=void 0);g.call("_guiRestyle",a,u,L)}}},{"../../lib":515,"../../registry":647}],423:[function(d,ee,te){te.isGrouped=function(g){return(g.traceorder||"").indexOf("grouped")!==-1},te.isVertical=function(g){return g.orientation!=="h"},te.isReversed=function(g){return(g.traceorder||"").indexOf("reversed")!==-1}},{}],424:[function(d,ee,te){ee.exports={moduleType:"component",name:"legend",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),draw:d("./draw"),style:d("./style")}},{"./attributes":417,"./defaults":419,"./draw":420,"./style":425}],425:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../registry"),S=d("../../lib"),M=S.strTranslate,e=d("../drawing"),a=d("../color"),n=d("../colorscale/helpers").extractOpts,r=d("../../traces/scatter/subtypes"),t=d("../../traces/pie/style_one"),c=d("../../traces/pie/helpers").castOption,s=d("./constants"),i=12,x=5,p=2,v=10,f=5;ee.exports=function(w,_,h){var b=_._fullLayout;h||(h=b.legend);var u=h.itemsizing==="constant",L=h.itemwidth,T=(L+s.itemGap*2)/2,k=M(T,0),P=function(j,q,V,U){var $;if(j+1)$=j;else if(q&&q.width>0)$=q.width;else return 0;return u?U:Math.min($,V)};w.each(function(j){var q=A.select(this),V=S.ensureSingle(q,"g","layers");V.style("opacity",j[0].trace.opacity);var U=h.valign,$=j[0].lineHeight,ne=j[0].height;if(U==="middle"||!$||!ne)V.attr("transform",null);else{var X={top:1,bottom:-1}[U],Q=X*(.5*($-ne+3));V.attr("transform",M(0,Q))}var ie=V.selectAll("g.legendfill").data([j]);ie.enter().append("g").classed("legendfill",!0);var se=V.selectAll("g.legendlines").data([j]);se.enter().append("g").classed("legendlines",!0);var ae=V.selectAll("g.legendsymbols").data([j]);ae.enter().append("g").classed("legendsymbols",!0),ae.selectAll("g.legendpoints").data([j]).enter().append("g").classed("legendpoints",!0)}).each(ue).each(D).each(O).each(R).each(N).each(Y).each(W).each(z).each(I).each(G).each(K);function z(j){var q=o(j),V=q.showFill,U=q.showLine,$=q.showGradientLine,ne=q.showGradientFill,X=q.anyFill,Q=q.anyLine,ie=j[0],se=ie.trace,ae,oe,be=n(se),ce=be.colorscale,de=be.reversescale,ye=function(ke){if(ke.size())if(V)e.fillGroupStyle(ke,_);else{var Xe="legendfill-"+se.uid;e.gradient(ke,_,Xe,y(de),ce,"fill")}},ge=function(ke){if(ke.size()){var Xe="legendline-"+se.uid;e.lineGroupStyle(ke),e.gradient(ke,_,Xe,y(de),ce,"stroke")}},me=r.hasMarkers(se)||!X?"M5,0":Q?"M5,-2":"M5,-3",Ee=A.select(this),Pe=Ee.select(".legendfill").selectAll("path").data(V||ne?[j]:[]);if(Pe.enter().append("path").classed("js-fill",!0),Pe.exit().remove(),Pe.attr("d",me+"h"+L+"v6h-"+L+"z").call(ye),U||$){var Ne=P(void 0,se.line,v,x);oe=S.minExtend(se,{line:{width:Ne}}),ae=[S.minExtend(ie,{trace:oe})]}var we=Ee.select(".legendlines").selectAll("path").data(U||$?[ae]:[]);we.enter().append("path").classed("js-line",!0),we.exit().remove(),we.attr("d",me+($?"l"+L+",0.0001":"h"+L)).call(U?e.lineGroupStyle:ge)}function I(j){var q=o(j),V=q.anyFill,U=q.anyLine,$=q.showLine,ne=q.showMarker,X=j[0],Q=X.trace,ie=!ne&&!U&&!V&&r.hasText(Q),se,ae;function oe(Pe,Ne,we,ke){var Xe=S.nestedProperty(Q,Pe).get(),He=S.isArrayOrTypedArray(Xe)&&Ne?Ne(Xe):Xe;if(u&&He&&ke!==void 0&&(He=ke),we){if(He<we[0])return we[0];if(He>we[1])return we[1]}return He}function be(Pe){return X._distinct&&X.index&&Pe[X.index]?Pe[X.index]:Pe[0]}if(ne||ie||$){var ce={},de={};if(ne){ce.mc=oe("marker.color",be),ce.mx=oe("marker.symbol",be),ce.mo=oe("marker.opacity",S.mean,[.2,1]),ce.mlc=oe("marker.line.color",be),ce.mlw=oe("marker.line.width",S.mean,[0,5],p),de.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var ye=oe("marker.size",S.mean,[2,16],i);ce.ms=ye,de.marker.size=ye}$&&(de.line={width:oe("line.width",be,[0,10],x)}),ie&&(ce.tx="Aa",ce.tp=oe("textposition",be),ce.ts=10,ce.tc=oe("textfont.color",be),ce.tf=oe("textfont.family",be)),se=[S.minExtend(X,ce)],ae=S.minExtend(Q,de),ae.selectedpoints=null,ae.texttemplate=null}var ge=A.select(this).select("g.legendpoints"),me=ge.selectAll("path.scatterpts").data(ne?se:[]);me.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",k),me.exit().remove(),me.call(e.pointStyle,ae,_),ne&&(se[0].mrc=3);var Ee=ge.selectAll("g.pointtext").data(ie?se:[]);Ee.enter().append("g").classed("pointtext",!0).append("text").attr("transform",k),Ee.exit().remove(),Ee.selectAll("text").call(e.textPointStyle,ae,_)}function D(j){var q=j[0].trace,V=q.type==="waterfall";if(j[0]._distinct&&V){var U=j[0].trace[j[0].dir].marker;return j[0].mc=U.color,j[0].mlw=U.line.width,j[0].mlc=U.line.color,F(j,this,"waterfall")}var $=[];q.visible&&V&&($=j[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var ne=A.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data($);ne.enter().append("path").classed("legendwaterfall",!0).attr("transform",k).style("stroke-miterlimit",1),ne.exit().remove(),ne.each(function(X){var Q=A.select(this),ie=q[X[0]].marker,se=P(void 0,ie.line,f,p);Q.attr("d",X[1]).style("stroke-width",se+"px").call(a.fill,ie.color),se&&Q.call(a.stroke,ie.line.color)})}function R(j){F(j,this)}function O(j){F(j,this,"funnel")}function F(j,q,V){var U=j[0].trace,$=U.marker||{},ne=$.line||{},X=V?U.visible&&U.type===V:g.traceIs(U,"bar"),Q=A.select(q).select("g.legendpoints").selectAll("path.legend"+V).data(X?[j]:[]);Q.enter().append("path").classed("legend"+V,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",k),Q.exit().remove(),Q.each(function(ie){var se=A.select(this),ae=ie[0],oe=P(ae.mlw,$.line,f,p);se.style("stroke-width",oe+"px");var be=ae.mcc;if(!h._inHover&&"mc"in ae){var ce=n($),de=ce.mid;de===void 0&&(de=(ce.max+ce.min)/2),be=e.tryColorscale($,"")(de)}var ye=be||ae.mc||$.color,ge=$.pattern,me=ge&&e.getPatternAttr(ge.shape,0,"");if(me){var Ee=e.getPatternAttr(ge.bgcolor,0,null),Pe=e.getPatternAttr(ge.fgcolor,0,null),Ne=ge.fgopacity,we=m(ge.size,8,10),ke=m(ge.solidity,.5,1),Xe="legend-"+U.uid;se.call(e.pattern,"legend",_,Xe,me,we,ke,be,ge.fillmode,Ee,Pe,Ne)}else se.call(a.fill,ye);oe&&a.stroke(se,ae.mlc||ne.color)})}function N(j){var q=j[0].trace,V=A.select(this).select("g.legendpoints").selectAll("path.legendbox").data(q.visible&&g.traceIs(q,"box-violin")?[j]:[]);V.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",k),V.exit().remove(),V.each(function(){var U=A.select(this);if((q.boxpoints==="all"||q.points==="all")&&a.opacity(q.fillcolor)===0&&a.opacity((q.line||{}).color)===0){var $=S.minExtend(q,{marker:{size:u?i:S.constrain(q.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});V.call(e.pointStyle,$,_)}else{var ne=P(void 0,q.line,f,p);U.style("stroke-width",ne+"px").call(a.fill,q.fillcolor),ne&&a.stroke(U,q.line.color)}})}function G(j){var q=j[0].trace,V=A.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(q.visible&&q.type==="candlestick"?[j,j]:[]);V.enter().append("path").classed("legendcandle",!0).attr("d",function(U,$){return $?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",k).style("stroke-miterlimit",1),V.exit().remove(),V.each(function(U,$){var ne=A.select(this),X=q[$?"increasing":"decreasing"],Q=P(void 0,X.line,f,p);ne.style("stroke-width",Q+"px").call(a.fill,X.fillcolor),Q&&a.stroke(ne,X.line.color)})}function K(j){var q=j[0].trace,V=A.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(q.visible&&q.type==="ohlc"?[j,j]:[]);V.enter().append("path").classed("legendohlc",!0).attr("d",function(U,$){return $?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",k).style("stroke-miterlimit",1),V.exit().remove(),V.each(function(U,$){var ne=A.select(this),X=q[$?"increasing":"decreasing"],Q=P(void 0,X.line,f,p);ne.style("fill","none").call(e.dashLine,X.line.dash,Q),Q&&a.stroke(ne,X.line.color)})}function W(j){re(j,this,"pie")}function Y(j){re(j,this,"funnelarea")}function re(j,q,V){var U=j[0],$=U.trace,ne=V?$.visible&&$.type===V:g.traceIs($,V),X=A.select(q).select("g.legendpoints").selectAll("path.legend"+V).data(ne?[j]:[]);if(X.enter().append("path").classed("legend"+V,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",k),X.exit().remove(),X.size()){var Q=($.marker||{}).line,ie=P(c(Q.width,U.pts),Q,f,p),se=S.minExtend($,{marker:{line:{width:ie}}});se.marker.line.color=Q.color;var ae=S.minExtend(U,{trace:se});t(X,ae,se)}}function ue(j){var q=j[0].trace,V,U=[];if(q.visible)switch(q.type){case"histogram2d":case"heatmap":U=[["M-15,-2V4H15V-2Z"]],V=!0;break;case"choropleth":case"choroplethmapbox":U=[["M-6,-6V6H6V-6Z"]],V=!0;break;case"densitymapbox":U=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],V="radial";break;case"cone":U=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],V=!1;break;case"streamtube":U=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],V=!1;break;case"surface":U=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],V=!0;break;case"mesh3d":U=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],V=!1;break;case"volume":U=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],V=!0;break;case"isosurface":U=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],V=!1;break}var $=A.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(U);$.enter().append("path").classed("legend3dandfriends",!0).attr("transform",k).style("stroke-miterlimit",1),$.exit().remove(),$.each(function(ne,X){var Q=A.select(this),ie=n(q),se=ie.colorscale,ae=ie.reversescale,oe=function(ye){if(ye.size()){var ge="legendfill-"+q.uid;e.gradient(ye,_,ge,y(ae,V==="radial"),se,"fill")}},be;if(se){if(!V){var de=se.length;be=X===0?se[ae?de-1:0][1]:X===1?se[ae?0:de-1][1]:se[Math.floor((de-1)/2)][1]}}else{var ce=q.vertexcolor||q.facecolor||q.color;be=S.isArrayOrTypedArray(ce)?ce[X]||ce[0]:ce}Q.attr("d",ne[0]),be?Q.call(a.fill,be):Q.call(oe)})}};function y(l,w){var _=w?"radial":"horizontal";return _+(l?"":"reversed")}function o(l){var w=l[0].trace,_=w.contours,h=r.hasLines(w),b=r.hasMarkers(w),u=w.visible&&w.fill&&w.fill!=="none",L=!1,T=!1;if(_){var k=_.coloring;k==="lines"?L=!0:h=k==="none"||k==="heatmap"||_.showlines,_.type==="constraint"?u=_._operation!=="=":(k==="fill"||k==="heatmap")&&(T=!0)}return{showMarker:b,showLine:h,showFill:u,showGradientLine:L,showGradientFill:T,anyLine:h||L,anyFill:u||T}}function m(l,w,_){return l&&S.isArrayOrTypedArray(l)?w:l>_?_:l}},{"../../lib":515,"../../registry":647,"../../traces/pie/helpers":915,"../../traces/pie/style_one":921,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale/helpers":378,"../drawing":389,"./constants":418,"@plotly/d3":58}],426:[function(d,ee,te){d("./constants"),ee.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":428}],427:[function(d,ee,te){var A=d("../../registry"),g=d("../../plots/plots"),S=d("../../plots/cartesian/axis_ids"),M=d("../../fonts/ploticon"),e=d("../shapes/draw").eraseActiveShape,a=d("../../lib"),n=a._,r=ee.exports={};r.toImage={name:"toImage",title:function(l){var w=l._context.toImageButtonOptions||{},_=w.format||"png";return _==="png"?n(l,"Download plot as a png"):n(l,"Download plot")},icon:M.camera,click:function(l){var w=l._context.toImageButtonOptions,_={format:w.format||"png"};a.notifier(n(l,"Taking snapshot - this may take a few seconds"),"long"),_.format!=="svg"&&a.isIE()&&(a.notifier(n(l,"IE only supports svg.  Changing format to svg."),"long"),_.format="svg"),["filename","width","height","scale"].forEach(function(h){h in w&&(_[h]=w[h])}),A.call("downloadImage",l,_).then(function(h){a.notifier(n(l,"Snapshot succeeded")+" - "+h,"long")}).catch(function(){a.notifier(n(l,"Sorry, there was a problem downloading your snapshot!"),"long")})}},r.sendDataToCloud={name:"sendDataToCloud",title:function(l){return n(l,"Edit in Chart Studio")},icon:M.disk,click:function(l){g.sendDataToCloud(l)}},r.editInChartStudio={name:"editInChartStudio",title:function(l){return n(l,"Edit in Chart Studio")},icon:M.pencil,click:function(l){g.sendDataToCloud(l)}},r.zoom2d={name:"zoom2d",_cat:"zoom",title:function(l){return n(l,"Zoom")},attr:"dragmode",val:"zoom",icon:M.zoombox,click:t},r.pan2d={name:"pan2d",_cat:"pan",title:function(l){return n(l,"Pan")},attr:"dragmode",val:"pan",icon:M.pan,click:t},r.select2d={name:"select2d",_cat:"select",title:function(l){return n(l,"Box Select")},attr:"dragmode",val:"select",icon:M.selectbox,click:t},r.lasso2d={name:"lasso2d",_cat:"lasso",title:function(l){return n(l,"Lasso Select")},attr:"dragmode",val:"lasso",icon:M.lasso,click:t},r.drawclosedpath={name:"drawclosedpath",title:function(l){return n(l,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:M.drawclosedpath,click:t},r.drawopenpath={name:"drawopenpath",title:function(l){return n(l,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:M.drawopenpath,click:t},r.drawline={name:"drawline",title:function(l){return n(l,"Draw line")},attr:"dragmode",val:"drawline",icon:M.drawline,click:t},r.drawrect={name:"drawrect",title:function(l){return n(l,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:M.drawrect,click:t},r.drawcircle={name:"drawcircle",title:function(l){return n(l,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:M.drawcircle,click:t},r.eraseshape={name:"eraseshape",title:function(l){return n(l,"Erase active shape")},icon:M.eraseshape,click:e},r.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(l){return n(l,"Zoom in")},attr:"zoom",val:"in",icon:M.zoom_plus,click:t},r.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(l){return n(l,"Zoom out")},attr:"zoom",val:"out",icon:M.zoom_minus,click:t},r.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(l){return n(l,"Autoscale")},attr:"zoom",val:"auto",icon:M.autoscale,click:t},r.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(l){return n(l,"Reset axes")},attr:"zoom",val:"reset",icon:M.home,click:t},r.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(l){return n(l,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:M.tooltip_basic,gravity:"ne",click:t},r.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(l){return n(l,"Compare data on hover")},attr:"hovermode",val:function(l){return l._fullLayout._isHoriz?"y":"x"},icon:M.tooltip_compare,gravity:"ne",click:t};function t(l,w){var _=w.currentTarget,h=_.getAttribute("data-attr"),b=_.getAttribute("data-val")||!0,u=l._fullLayout,L={},T=S.list(l,null,!0),k=u._cartesianSpikesEnabled,P,z;if(h==="zoom"){var I=b==="in"?.5:2,D=(1+I)/2,R=(1-I)/2,O;for(z=0;z<T.length;z++)if(P=T[z],!P.fixedrange)if(O=P._name,b==="auto")L[O+".autorange"]=!0;else if(b==="reset"){if(P._rangeInitial===void 0)L[O+".autorange"]=!0;else{var F=P._rangeInitial.slice();L[O+".range[0]"]=F[0],L[O+".range[1]"]=F[1]}P._showSpikeInitial!==void 0&&(L[O+".showspikes"]=P._showSpikeInitial,k==="on"&&!P._showSpikeInitial&&(k="off"))}else{var N=[P.r2l(P.range[0]),P.r2l(P.range[1])],G=[D*N[0]+R*N[1],D*N[1]+R*N[0]];L[O+".range[0]"]=P.l2r(G[0]),L[O+".range[1]"]=P.l2r(G[1])}}else h==="hovermode"&&(b==="x"||b==="y")&&(b=u._isHoriz?"y":"x",_.setAttribute("data-val",b)),L[h]=b;u._cartesianSpikesEnabled=k,A.call("_guiRelayout",l,L)}r.zoom3d={name:"zoom3d",_cat:"zoom",title:function(l){return n(l,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:M.zoombox,click:c},r.pan3d={name:"pan3d",_cat:"pan",title:function(l){return n(l,"Pan")},attr:"scene.dragmode",val:"pan",icon:M.pan,click:c},r.orbitRotation={name:"orbitRotation",title:function(l){return n(l,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:M["3d_rotate"],click:c},r.tableRotation={name:"tableRotation",title:function(l){return n(l,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:M["z-axis"],click:c};function c(l,w){for(var _=w.currentTarget,h=_.getAttribute("data-attr"),b=_.getAttribute("data-val")||!0,u=l._fullLayout._subplots.gl3d||[],L={},T=h.split("."),k=0;k<u.length;k++)L[u[k]+"."+T[1]]=b;var P=b==="pan"?b:"zoom";L.dragmode=P,A.call("_guiRelayout",l,L)}r.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(l){return n(l,"Reset camera to default")},attr:"resetDefault",icon:M.home,click:s},r.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(l){return n(l,"Reset camera to last save")},attr:"resetLastSave",icon:M.movie,click:s};function s(l,w){for(var _=w.currentTarget,h=_.getAttribute("data-attr"),b=h==="resetLastSave",u=h==="resetDefault",L=l._fullLayout,T=L._subplots.gl3d||[],k={},P=0;P<T.length;P++){var z=T[P],I=z+".camera",D=z+".aspectratio",R=z+".aspectmode",O=L[z]._scene,F;b?(k[I+".up"]=O.viewInitial.up,k[I+".eye"]=O.viewInitial.eye,k[I+".center"]=O.viewInitial.center,F=!0):u&&(k[I+".up"]=null,k[I+".eye"]=null,k[I+".center"]=null,F=!0),F&&(k[D+".x"]=O.viewInitial.aspectratio.x,k[D+".y"]=O.viewInitial.aspectratio.y,k[D+".z"]=O.viewInitial.aspectratio.z,k[R]=O.viewInitial.aspectmode)}A.call("_guiRelayout",l,k)}r.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(l){return n(l,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:M.tooltip_basic,gravity:"ne",click:x};function i(l,w){var _=w.currentTarget,h=_._previousVal,b=l._fullLayout,u=b._subplots.gl3d||[],L=["xaxis","yaxis","zaxis"],T={},k={};if(h)k=h,_._previousVal=null;else{for(var P=0;P<u.length;P++){var z=u[P],I=b[z],D=z+".hovermode";T[D]=I.hovermode,k[D]=!1;for(var R=0;R<3;R++){var O=L[R],F=z+"."+O+".showspikes";k[F]=!1,T[F]=I[O].showspikes}}_._previousVal=T}return k}function x(l,w){var _=i(l,w);A.call("_guiRelayout",l,_)}r.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(l){return n(l,"Zoom in")},attr:"zoom",val:"in",icon:M.zoom_plus,click:p},r.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(l){return n(l,"Zoom out")},attr:"zoom",val:"out",icon:M.zoom_minus,click:p},r.resetGeo={name:"resetGeo",_cat:"reset",title:function(l){return n(l,"Reset")},attr:"reset",val:null,icon:M.autoscale,click:p},r.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(l){return n(l,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:M.tooltip_basic,gravity:"ne",click:f};function p(l,w){for(var _=w.currentTarget,h=_.getAttribute("data-attr"),b=_.getAttribute("data-val")||!0,u=l._fullLayout,L=u._subplots.geo||[],T=0;T<L.length;T++){var k=L[T],P=u[k];if(h==="zoom"){var z=P.projection.scale,I=b==="in"?2*z:.5*z;A.call("_guiRelayout",l,k+".projection.scale",I)}}h==="reset"&&m(l,"geo")}r.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(l){return n(l,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:M.tooltip_basic,gravity:"ne",click:f},r.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(l){return n(l,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:M.tooltip_basic,gravity:"ne",click:f};function v(l){var w=l._fullLayout;return w.hovermode?!1:w._has("cartesian")?w._isHoriz?"y":"x":"closest"}function f(l){var w=v(l);A.call("_guiRelayout",l,"hovermode",w)}r.resetViewSankey={name:"resetSankeyGroup",title:function(l){return n(l,"Reset view")},icon:M.home,click:function(l){for(var w={"node.groups":[],"node.x":[],"node.y":[]},_=0;_<l._fullData.length;_++){var h=l._fullData[_]._viewInitial;w["node.groups"].push(h.node.groups.slice()),w["node.x"].push(h.node.x.slice()),w["node.y"].push(h.node.y.slice())}A.call("restyle",l,w)}},r.toggleHover={name:"toggleHover",title:function(l){return n(l,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:M.tooltip_basic,gravity:"ne",click:function(l,w){var _=i(l,w);_.hovermode=v(l),A.call("_guiRelayout",l,_)}},r.resetViews={name:"resetViews",title:function(l){return n(l,"Reset views")},icon:M.home,click:function(l,w){var _=w.currentTarget;_.setAttribute("data-attr","zoom"),_.setAttribute("data-val","reset"),t(l,w),_.setAttribute("data-attr","resetLastSave"),s(l,w),m(l,"geo"),m(l,"mapbox")}},r.toggleSpikelines={name:"toggleSpikelines",title:function(l){return n(l,"Toggle Spike Lines")},icon:M.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(l){var w=l._fullLayout,_=w._cartesianSpikesEnabled;w._cartesianSpikesEnabled=_==="on"?"off":"on",A.call("_guiRelayout",l,y(l))}};function y(l){for(var w=l._fullLayout,_=w._cartesianSpikesEnabled==="on",h=S.list(l,null,!0),b={},u=0;u<h.length;u++){var L=h[u];b[L._name+".showspikes"]=_?!0:L._showSpikeInitial}return b}r.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(l){return n(l,"Reset view")},attr:"reset",icon:M.home,click:function(l){m(l,"mapbox")}},r.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(l){return n(l,"Zoom in")},attr:"zoom",val:"in",icon:M.zoom_plus,click:o},r.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(l){return n(l,"Zoom out")},attr:"zoom",val:"out",icon:M.zoom_minus,click:o};function o(l,w){for(var _=w.currentTarget,h=_.getAttribute("data-val"),b=l._fullLayout,u=b._subplots.mapbox||[],L=1.05,T={},k=0;k<u.length;k++){var P=u[k],z=b[P].zoom,I=h==="in"?L*z:z/L;T[P+".zoom"]=I}A.call("_guiRelayout",l,T)}function m(l,w){for(var _=l._fullLayout,h=_._subplots[w]||[],b={},u=0;u<h.length;u++)for(var L=h[u],T=_[L]._subplot,k=T.viewInitial,P=Object.keys(k),z=0;z<P.length;z++){var I=P[z];b[L+"."+I]=k[I]}A.call("_guiRelayout",l,b)}},{"../../fonts/ploticon":494,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../shapes/draw":462}],428:[function(d,ee,te){var A=d("./buttons"),g=Object.keys(A),S=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],M=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(S),e=[],a=function(n){if(M.indexOf(n._cat||n.name)===-1){var r=n.name,t=(n._cat||n.name).toLowerCase();e.indexOf(r)===-1&&e.push(r),e.indexOf(t)===-1&&e.push(t)}};g.forEach(function(n){a(A[n])}),e.sort(),ee.exports={DRAW_MODES:S,backButtons:M,foreButtons:e}},{"./buttons":427}],429:[function(d,ee,te){var A=d("../../lib"),g=d("../color"),S=d("../../plot_api/plot_template"),M=d("./attributes");ee.exports=function(a,n){var r=a.modebar||{},t=S.newContainer(n,"modebar");function c(i,x){return A.coerce(r,t,M,i,x)}c("orientation"),c("bgcolor",g.addOpacity(n.paper_bgcolor,.5));var s=g.contrast(g.rgb(n.modebar.bgcolor));c("color",g.addOpacity(s,.3)),c("activecolor",g.addOpacity(s,.7)),c("uirevision",n.uirevision),c("add"),c("remove")}},{"../../lib":515,"../../plot_api/plot_template":555,"../color":367,"./attributes":426}],430:[function(d,ee,te){ee.exports={moduleType:"component",name:"modebar",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),manage:d("./manage")}},{"./attributes":426,"./defaults":429,"./manage":431}],431:[function(d,ee,te){var A=d("../../plots/cartesian/axis_ids"),g=d("../../traces/scatter/subtypes"),S=d("../../registry"),M=d("../fx/helpers").isUnifiedHover,e=d("./modebar"),a=d("./buttons"),n=d("./constants").DRAW_MODES,r=d("../../lib").extendDeep;ee.exports=function(f){var y=f._fullLayout,o=f._context,m=y._modeBar;if(!o.displayModeBar&&!o.watermark){m&&(m.destroy(),delete y._modeBar);return}if(!Array.isArray(o.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(o.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var l=o.modeBarButtons,w;Array.isArray(l)&&l.length?w=p(l):!o.displayModeBar&&o.watermark?w=[]:w=t(f),m?m.update(f,w):y._modeBar=e(f,w)};function t(v){var f=v._fullLayout,y=v._fullData,o=v._context;function m(X,Q){if(typeof Q=="string"){if(Q.toLowerCase()===X.toLowerCase())return!0}else{var ie=Q.name,se=Q._cat||Q.name;if(ie===X||se===X.toLowerCase())return!0}return!1}var l=f.modebar.add;typeof l=="string"&&(l=[l]);var w=f.modebar.remove;typeof w=="string"&&(w=[w]);var _=o.modeBarButtonsToAdd.concat(l.filter(function(X){for(var Q=0;Q<o.modeBarButtonsToRemove.length;Q++)if(m(X,o.modeBarButtonsToRemove[Q]))return!1;return!0})),h=o.modeBarButtonsToRemove.concat(w.filter(function(X){for(var Q=0;Q<o.modeBarButtonsToAdd.length;Q++)if(m(X,o.modeBarButtonsToAdd[Q]))return!1;return!0})),b=f._has("cartesian"),u=f._has("gl3d"),L=f._has("geo"),T=f._has("pie"),k=f._has("funnelarea"),P=f._has("gl2d"),z=f._has("ternary"),I=f._has("mapbox"),D=f._has("polar"),R=f._has("smith"),O=f._has("sankey"),F=c(f),N=M(f.hovermode),G=[];function K(X){if(!!X.length){for(var Q=[],ie=0;ie<X.length;ie++){for(var se=X[ie],ae=a[se],oe=ae.name.toLowerCase(),be=(ae._cat||ae.name).toLowerCase(),ce=!1,de=0;de<h.length;de++){var ye=h[de].toLowerCase();if(ye===oe||ye===be){ce=!0;break}}ce||Q.push(a[se])}G.push(Q)}}var W=["toImage"];o.showEditInChartStudio?W.push("editInChartStudio"):o.showSendToCloud&&W.push("sendDataToCloud"),K(W);var Y=[],re=[],ue=[],j=[];(b||P||T||k||z)+L+u+I+D+R>1?(re=["toggleHover"],ue=["resetViews"]):L?(Y=["zoomInGeo","zoomOutGeo"],re=["hoverClosestGeo"],ue=["resetGeo"]):u?(re=["hoverClosest3d"],ue=["resetCameraDefault3d","resetCameraLastSave3d"]):I?(Y=["zoomInMapbox","zoomOutMapbox"],re=["toggleHover"],ue=["resetViewMapbox"]):P?re=["hoverClosestGl2d"]:T?re=["hoverClosestPie"]:O?(re=["hoverClosestCartesian","hoverCompareCartesian"],ue=["resetViewSankey"]):re=["toggleHover"],b&&(re=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(i(y)||N)&&(re=[]),(b||P)&&!F&&(Y=["zoomIn2d","zoomOut2d","autoScale2d"],ue[0]!=="resetViews"&&(ue=["resetScale2d"])),u?j=["zoom3d","pan3d","orbitRotation","tableRotation"]:(b||P)&&!F||z?j=["zoom2d","pan2d"]:I||L?j=["pan2d"]:D&&(j=["zoom2d"]),s(y)&&j.push("select2d","lasso2d");var q=[],V=function(X){q.indexOf(X)===-1&&re.indexOf(X)!==-1&&q.push(X)};if(Array.isArray(_)){for(var U=[],$=0;$<_.length;$++){var ne=_[$];typeof ne=="string"?(ne=ne.toLowerCase(),n.indexOf(ne)!==-1?(f._has("mapbox")||f._has("cartesian"))&&j.push(ne):ne==="togglespikelines"?V("toggleSpikelines"):ne==="togglehover"?V("toggleHover"):ne==="hovercompare"?V("hoverCompareCartesian"):ne==="hoverclosest"?(V("hoverClosestCartesian"),V("hoverClosestGeo"),V("hoverClosest3d"),V("hoverClosestGl2d"),V("hoverClosestPie")):ne==="v1hovermode"&&(V("toggleHover"),V("hoverClosestCartesian"),V("hoverCompareCartesian"),V("hoverClosestGeo"),V("hoverClosest3d"),V("hoverClosestGl2d"),V("hoverClosestPie"))):U.push(ne)}_=U}return K(j),K(Y.concat(ue)),K(q),x(G,_)}function c(v){for(var f=A.list({_fullLayout:v},null,!0),y=0;y<f.length;y++)if(!f[y].fixedrange)return!1;return!0}function s(v){for(var f=!1,y=0;y<v.length&&!f;y++){var o=v[y];!o._module||!o._module.selectPoints||(S.traceIs(o,"scatter-like")?(g.hasMarkers(o)||g.hasText(o))&&(f=!0):S.traceIs(o,"box-violin")?(o.boxpoints==="all"||o.points==="all")&&(f=!0):f=!0)}return f}function i(v){for(var f=0;f<v.length;f++)if(!S.traceIs(v[f],"noHover"))return!1;return!0}function x(v,f){if(f.length)if(Array.isArray(f[0]))for(var y=0;y<f.length;y++)v.push(f[y]);else v.push(f);return v}function p(v){for(var f=r([],v),y=0;y<f.length;y++)for(var o=f[y],m=0;m<o.length;m++){var l=o[m];if(typeof l=="string")if(a[l]!==void 0)f[y][m]=a[l];else throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "))}return f}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../../traces/scatter/subtypes":961,"../fx/helpers":403,"./buttons":427,"./constants":428,"./modebar":432}],432:[function(d,ee,te){var A=d("@plotly/d3"),g=d("fast-isnumeric"),S=d("../../lib"),M=d("../../fonts/ploticon"),e=d("../../version").version,a=new DOMParser;function n(s){this.container=s.container,this.element=document.createElement("div"),this.update(s.graphInfo,s.buttons),this.container.appendChild(this.element)}var r=n.prototype;r.update=function(s,i){this.graphInfo=s;var x=this.graphInfo._context,p=this.graphInfo._fullLayout,v="modebar-"+p._uid;this.element.setAttribute("id",v),this._uid=v,this.element.className="modebar",x.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),p.modebar.orientation==="v"&&(this.element.className+=" vertical",i=i.reverse());var f=p.modebar,y=x.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";S.deleteRelatedStyleRule(v),S.addRelatedStyleRule(v,y+"#"+v+" .modebar-group","background-color: "+f.bgcolor),S.addRelatedStyleRule(v,"#"+v+" .modebar-btn .icon path","fill: "+f.color),S.addRelatedStyleRule(v,"#"+v+" .modebar-btn:hover .icon path","fill: "+f.activecolor),S.addRelatedStyleRule(v,"#"+v+" .modebar-btn.active .icon path","fill: "+f.activecolor);var o=!this.hasButtons(i),m=this.hasLogo!==x.displaylogo,l=this.locale!==x.locale;if(this.locale=x.locale,(o||m||l)&&(this.removeAllButtons(),this.updateButtons(i),x.watermark||x.displaylogo)){var w=this.getLogo();x.watermark&&(w.className=w.className+" watermark"),p.modebar.orientation==="v"?this.element.insertBefore(w,this.element.childNodes[0]):this.element.appendChild(w),this.hasLogo=!0}this.updateActiveButton()},r.updateButtons=function(s){var i=this;this.buttons=s,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(x){var p=i.createGroup();x.forEach(function(v){var f=v.name;if(!f)throw new Error("must provide button 'name' in button config");if(i.buttonsNames.indexOf(f)!==-1)throw new Error("button name '"+f+"' is taken");i.buttonsNames.push(f);var y=i.createButton(v);i.buttonElements.push(y),p.appendChild(y)}),i.element.appendChild(p)})},r.createGroup=function(){var s=document.createElement("div");return s.className="modebar-group",s},r.createButton=function(s){var i=this,x=document.createElement("a");x.setAttribute("rel","tooltip"),x.className="modebar-btn";var p=s.title;p===void 0?p=s.name:typeof p=="function"&&(p=p(this.graphInfo)),(p||p===0)&&x.setAttribute("data-title",p),s.attr!==void 0&&x.setAttribute("data-attr",s.attr);var v=s.val;v!==void 0&&(typeof v=="function"&&(v=v(this.graphInfo)),x.setAttribute("data-val",v));var f=s.click;if(typeof f!="function")throw new Error("must provide button 'click' function in button config");x.addEventListener("click",function(o){s.click(i.graphInfo,o),i.updateActiveButton(o.currentTarget)}),x.setAttribute("data-toggle",s.toggle||!1),s.toggle&&A.select(x).classed("active",!0);var y=s.icon;return typeof y=="function"?x.appendChild(y()):x.appendChild(this.createIcon(y||M.question)),x.setAttribute("data-gravity",s.gravity||"n"),x},r.createIcon=function(s){var i=g(s.height)?Number(s.height):s.ascent-s.descent,x="http://www.w3.org/2000/svg",p;if(s.path){p=document.createElementNS(x,"svg"),p.setAttribute("viewBox",[0,0,s.width,i].join(" ")),p.setAttribute("class","icon");var v=document.createElementNS(x,"path");v.setAttribute("d",s.path),s.transform?v.setAttribute("transform",s.transform):s.ascent!==void 0&&v.setAttribute("transform","matrix(1 0 0 -1 0 "+s.ascent+")"),p.appendChild(v)}if(s.svg){var f=a.parseFromString(s.svg,"application/xml");p=f.childNodes[0]}return p.setAttribute("height","1em"),p.setAttribute("width","1em"),p},r.updateActiveButton=function(s){var i=this.graphInfo._fullLayout,x=s!==void 0?s.getAttribute("data-attr"):null;this.buttonElements.forEach(function(p){var v=p.getAttribute("data-val")||!0,f=p.getAttribute("data-attr"),y=p.getAttribute("data-toggle")==="true",o=A.select(p);if(y)f===x&&o.classed("active",!o.classed("active"));else{var m=f===null?f:S.nestedProperty(i,f).get();o.classed("active",m===v)}})},r.hasButtons=function(s){var i=this.buttons;if(!i||s.length!==i.length)return!1;for(var x=0;x<s.length;++x){if(s[x].length!==i[x].length)return!1;for(var p=0;p<s[x].length;p++)if(s[x][p].name!==i[x][p].name)return!1}return!0};function t(s){return s+" (v"+e+")"}r.getLogo=function(){var s=this.createGroup(),i=document.createElement("a");return i.href="https://plotly.com/",i.target="_blank",i.setAttribute("data-title",t(S._(this.graphInfo,"Produced with Plotly.js"))),i.className="modebar-btn plotlyjsicon modebar-btn--logo",i.appendChild(this.createIcon(M.newplotlylogo)),s.appendChild(i),s},r.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},r.destroy=function(){S.removeElement(this.container.querySelector(".modebar")),S.deleteRelatedStyleRule(this._uid)};function c(s,i){var x=s._fullLayout,p=new n({graphInfo:s,container:x._modebardiv.node(),buttons:i});return x._privateplot&&A.select(p.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),p}ee.exports=c},{"../../fonts/ploticon":494,"../../lib":515,"../../version":1132,"@plotly/d3":58,"fast-isnumeric":190}],433:[function(d,ee,te){var A=d("../../plots/font_attributes"),g=d("../color/attributes"),S=d("../../plot_api/plot_template").templatedArray,M=S("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});ee.exports={visible:{valType:"boolean",editType:"plot"},buttons:M,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:A({editType:"plot"}),bgcolor:{valType:"color",dflt:g.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:g.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../color/attributes":366}],434:[function(d,ee,te){ee.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],435:[function(d,ee,te){var A=d("../../lib"),g=d("../color"),S=d("../../plot_api/plot_template"),M=d("../../plots/array_container_defaults"),e=d("./attributes"),a=d("./constants");ee.exports=function(c,s,i,x,p){var v=c.rangeselector||{},f=S.newContainer(s,"rangeselector");function y(_,h){return A.coerce(v,f,e,_,h)}var o=M(v,f,{name:"buttons",handleItemDefaults:n,calendar:p}),m=y("visible",o.length>0);if(m){var l=r(s,i,x);y("x",l[0]),y("y",l[1]),A.noneOrAll(c,s,["x","y"]),y("xanchor"),y("yanchor"),A.coerceFont(y,"font",i.font);var w=y("bgcolor");y("activecolor",g.contrast(w,a.lightAmount,a.darkAmount)),y("bordercolor"),y("borderwidth")}};function n(t,c,s,i){var x=i.calendar;function p(y,o){return A.coerce(t,c,e.buttons,y,o)}var v=p("visible");if(v){var f=p("step");f!=="all"&&(x&&x!=="gregorian"&&(f==="month"||f==="year")?c.stepmode="backward":p("stepmode"),p("count")),p("label")}}function r(t,c,s){for(var i=s.filter(function(f){return c[f].anchor===t._id}),x=0,p=0;p<i.length;p++){var v=c[i[p]].domain;v&&(x=Math.max(v[1],x))}return[t.domain[0],x+a.yPad]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../color":367,"./attributes":433,"./constants":434}],436:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../registry"),S=d("../../plots/plots"),M=d("../color"),e=d("../drawing"),a=d("../../lib"),n=a.strTranslate,r=d("../../lib/svg_text_utils"),t=d("../../plots/cartesian/axis_ids"),c=d("../../constants/alignment"),s=c.LINE_SPACING,i=c.FROM_TL,x=c.FROM_BR,p=d("./constants"),v=d("./get_update_object");ee.exports=function(u){var L=u._fullLayout,T=L._infolayer.selectAll(".rangeselector").data(f(u),y);T.enter().append("g").classed("rangeselector",!0),T.exit().remove(),T.style({cursor:"pointer","pointer-events":"all"}),T.each(function(k){var P=A.select(this),z=k,I=z.rangeselector,D=P.selectAll("g.button").data(a.filterVisible(I.buttons));D.enter().append("g").classed("button",!0),D.exit().remove(),D.each(function(R){var O=A.select(this),F=v(z,R);R._isActive=o(z,R,F),O.call(m,I,R),O.call(w,I,R,u),O.on("click",function(){u._dragged||g.call("_guiRelayout",u,F)}),O.on("mouseover",function(){R._isHovered=!0,O.call(m,I,R)}),O.on("mouseout",function(){R._isHovered=!1,O.call(m,I,R)})}),h(u,D,I,z._name,P)})};function f(b){for(var u=t.list(b,"x",!0),L=[],T=0;T<u.length;T++){var k=u[T];k.rangeselector&&k.rangeselector.visible&&L.push(k)}return L}function y(b){return b._id}function o(b,u,L){if(u.step==="all")return b.autorange===!0;var T=Object.keys(L);return b.range[0]===L[T[0]]&&b.range[1]===L[T[1]]}function m(b,u,L){var T=a.ensureSingle(b,"rect","selector-rect",function(k){k.attr("shape-rendering","crispEdges")});T.attr({rx:p.rx,ry:p.ry}),T.call(M.stroke,u.bordercolor).call(M.fill,l(u,L)).style("stroke-width",u.borderwidth+"px")}function l(b,u){return u._isActive||u._isHovered?b.activecolor:b.bgcolor}function w(b,u,L,T){function k(z){r.convertToTspans(z,T)}var P=a.ensureSingle(b,"text","selector-text",function(z){z.attr("text-anchor","middle")});P.call(e.font,u.font).text(_(L,T._fullLayout._meta)).call(k)}function _(b,u){return b.label?u?a.templateString(b.label,u):b.label:b.step==="all"?"all":b.count+b.step.charAt(0)}function h(b,u,L,T,k){var P=0,z=0,I=L.borderwidth;u.each(function(){var G=A.select(this),K=G.select(".selector-text"),W=L.font.size*s,Y=Math.max(W*r.lineCount(K),16)+3;z=Math.max(z,Y)}),u.each(function(){var G=A.select(this),K=G.select(".selector-rect"),W=G.select(".selector-text"),Y=W.node()&&e.bBox(W.node()).width,re=L.font.size*s,ue=r.lineCount(W),j=Math.max(Y+10,p.minButtonWidth);G.attr("transform",n(I+P,I)),K.attr({x:0,y:0,width:j,height:z}),r.positionText(W,j/2,z/2-(ue-1)*re/2+3),P+=j+5});var D=b._fullLayout._size,R=D.l+D.w*L.x,O=D.t+D.h*(1-L.y),F="left";a.isRightAnchor(L)&&(R-=P,F="right"),a.isCenterAnchor(L)&&(R-=P/2,F="center");var N="top";a.isBottomAnchor(L)&&(O-=z,N="bottom"),a.isMiddleAnchor(L)&&(O-=z/2,N="middle"),P=Math.ceil(P),z=Math.ceil(z),R=Math.round(R),O=Math.round(O),S.autoMargin(b,T+"-range-selector",{x:L.x,y:L.y,l:P*i[F],r:P*x[F],b:z*x[N],t:z*i[N]}),k.attr("transform",n(R,O))}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"./constants":434,"./get_update_object":437,"@plotly/d3":58}],437:[function(d,ee,te){var A=d("d3-time"),g=d("../../lib").titleCase;ee.exports=function(e,a){var n=e._name,r={};if(a.step==="all")r[n+".autorange"]=!0;else{var t=S(e,a);r[n+".range[0]"]=t[0],r[n+".range[1]"]=t[1]}return r};function S(M,e){var a=M.range,n=new Date(M.r2l(a[1])),r=e.step,t=A["utc"+g(r)],c=e.count,s;switch(e.stepmode){case"backward":s=M.l2r(+t.offset(n,-c));break;case"todate":var i=t.offset(n,-c);s=M.l2r(+t.ceil(i));break}var x=a[1];return[s,x]}},{"../../lib":515,"d3-time":122}],438:[function(d,ee,te){ee.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:d("./attributes")}}},layoutAttributes:d("./attributes"),handleDefaults:d("./defaults"),draw:d("./draw")}},{"./attributes":433,"./defaults":435,"./draw":436}],439:[function(d,ee,te){var A=d("../color/attributes");ee.exports={bgcolor:{valType:"color",dflt:A.background,editType:"plot"},bordercolor:{valType:"color",dflt:A.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":366}],440:[function(d,ee,te){var A=d("../../plots/cartesian/axis_ids").list,g=d("../../plots/cartesian/autorange").getAutoRange,S=d("./constants");ee.exports=function(e){for(var a=A(e,"x",!0),n=0;n<a.length;n++){var r=a[n],t=r[S.name];t&&t.visible&&t.autorange&&(t._input.autorange=!0,t._input.range=t.range=g(e,r))}}},{"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"./constants":441}],441:[function(d,ee,te){ee.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],442:[function(d,ee,te){var A=d("../../lib"),g=d("../../plot_api/plot_template"),S=d("../../plots/cartesian/axis_ids"),M=d("./attributes"),e=d("./oppaxis_attributes");ee.exports=function(n,r,t){var c=n[t],s=r[t];if(!(c.rangeslider||r._requestRangeslider[s._id]))return;A.isPlainObject(c.rangeslider)||(c.rangeslider={});var i=c.rangeslider,x=g.newContainer(s,"rangeslider");function p(T,k){return A.coerce(i,x,M,T,k)}var v,f;function y(T,k){return A.coerce(v,f,e,T,k)}var o=p("visible");if(!!o){p("bgcolor",r.plot_bgcolor),p("bordercolor"),p("borderwidth"),p("thickness"),p("autorange",!s.isValidRange(i.range)),p("range");var m=r._subplots;if(m)for(var l=m.cartesian.filter(function(T){return T.substr(0,T.indexOf("y"))===S.name2id(t)}).map(function(T){return T.substr(T.indexOf("y"),T.length)}),w=A.simpleMap(l,S.id2name),_=0;_<w.length;_++){var h=w[_];v=i[h]||{},f=g.newContainer(x,h,"yaxis");var b=r[h],u;v.range&&b.isValidRange(v.range)&&(u="fixed");var L=y("rangemode",u);L!=="match"&&y("range",b.range.slice())}x._input=i}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_ids":570,"./attributes":439,"./oppaxis_attributes":446}],443:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../registry"),S=d("../../plots/plots"),M=d("../../lib"),e=M.strTranslate,a=d("../drawing"),n=d("../color"),r=d("../titles"),t=d("../../plots/cartesian"),c=d("../../plots/cartesian/axis_ids"),s=d("../dragelement"),i=d("../../lib/setcursor"),x=d("./constants");ee.exports=function(b){for(var u=b._fullLayout,L=u._rangeSliderData,T=0;T<L.length;T++){var k=L[T][x.name];k._clipId=k._id+"-"+u._uid}function P(I){return I._name}var z=u._infolayer.selectAll("g."+x.containerClassName).data(L,P);z.exit().each(function(I){var D=I[x.name];u._topdefs.select("#"+D._clipId).remove()}).remove(),L.length!==0&&(z.enter().append("g").classed(x.containerClassName,!0).attr("pointer-events","all"),z.each(function(I){var D=A.select(this),R=I[x.name],O=u[c.id2name(I.anchor)],F=R[c.id2name(I.anchor)];if(R.range){var N=M.simpleMap(R.range,I.r2l),G=M.simpleMap(I.range,I.r2l),K;G[0]<G[1]?K=[Math.min(N[0],G[0]),Math.max(N[1],G[1])]:K=[Math.max(N[0],G[0]),Math.min(N[1],G[1])],R.range=R._input.range=M.simpleMap(K,I.l2r)}I.cleanRange("rangeslider.range");var W=u._size,Y=I.domain;R._width=W.w*(Y[1]-Y[0]);var re=Math.round(W.l+W.w*Y[0]),ue=Math.round(W.t+W.h*(1-I._counterDomainMin)+(I.side==="bottom"?I._depth:0)+R._offsetShift+x.extraPad);D.attr("transform",e(re,ue)),R._rl=M.simpleMap(R.range,I.r2l);var j=R._rl[0],q=R._rl[1],V=q-j;if(R.p2d=function(be){return be/R._width*V+j},R.d2p=function(be){return(be-j)/V*R._width},I.rangebreaks){var U=I.locateBreaks(j,q);if(U.length){var $,ne,X=0;for($=0;$<U.length;$++)ne=U[$],X+=ne.max-ne.min;var Q=R._width/(q-j-X),ie=[-Q*j];for($=0;$<U.length;$++)ne=U[$],ie.push(ie[ie.length-1]-Q*(ne.max-ne.min));for(R.d2p=function(be){for(var ce=ie[0],de=0;de<U.length;de++){var ye=U[de];if(be>=ye.max)ce=ie[de+1];else if(be<ye.min)break}return ce+Q*be},$=0;$<U.length;$++)ne=U[$],ne.pmin=R.d2p(ne.min),ne.pmax=R.d2p(ne.max);R.p2d=function(be){for(var ce=ie[0],de=0;de<U.length;de++){var ye=U[de];if(be>=ye.pmax)ce=ie[de+1];else if(be<ye.pmin)break}return(be-ce)/Q}}}if(F.rangemode!=="match"){var se=O.r2l(F.range[0]),ae=O.r2l(F.range[1]),oe=ae-se;R.d2pOppAxis=function(be){return(be-se)/oe*R._height}}D.call(y,b,I,R).call(o,b,I,R).call(m,b,I,R).call(w,b,I,R,F).call(_,b,I,R).call(h,b,I,R),p(D,b,I,R),f(D,b,I,R,O,F),I.side==="bottom"&&r.draw(b,I._id+"title",{propContainer:I,propName:I._name+".title",placeholder:u._dfltTitle.x,attributes:{x:I._offset+I._length/2,y:ue+R._height+R._offsetShift+10+1.5*I.title.font.size,"text-anchor":"middle"}})}))};function p(b,u,L,T){if(u._context.staticPlot)return;var k=b.select("rect."+x.slideBoxClassName).node(),P=b.select("rect."+x.grabAreaMinClassName).node(),z=b.select("rect."+x.grabAreaMaxClassName).node();function I(){var D=A.event,R=D.target,O=D.clientX||D.touches[0].clientX,F=O-b.node().getBoundingClientRect().left,N=T.d2p(L._rl[0]),G=T.d2p(L._rl[1]),K=s.coverSlip();this.addEventListener("touchmove",W),this.addEventListener("touchend",Y),K.addEventListener("mousemove",W),K.addEventListener("mouseup",Y);function W(re){var ue=re.clientX||re.touches[0].clientX,j=+ue-O,q,V,U;switch(R){case k:U="ew-resize",q=N+j,V=G+j;break;case P:U="col-resize",q=N+j,V=G;break;case z:U="col-resize",q=N,V=G+j;break;default:U="ew-resize",q=F,V=F+j;break}if(V<q){var $=V;V=q,q=$}T._pixelMin=q,T._pixelMax=V,i(A.select(K),U),v(b,u,L,T)}function Y(){K.removeEventListener("mousemove",W),K.removeEventListener("mouseup",Y),this.removeEventListener("touchmove",W),this.removeEventListener("touchend",Y),M.removeElement(K)}}b.on("mousedown",I),b.on("touchstart",I)}function v(b,u,L,T){function k(I){return L.l2r(M.constrain(I,T._rl[0],T._rl[1]))}var P=k(T.p2d(T._pixelMin)),z=k(T.p2d(T._pixelMax));window.requestAnimationFrame(function(){g.call("_guiRelayout",u,L._name+".range",[P,z])})}function f(b,u,L,T,k,P){var z=x.handleWidth/2;function I(re){return M.constrain(re,0,T._width)}function D(re){return M.constrain(re,0,T._height)}function R(re){return M.constrain(re,-z,T._width+z)}var O=I(T.d2p(L._rl[0])),F=I(T.d2p(L._rl[1]));if(b.select("rect."+x.slideBoxClassName).attr("x",O).attr("width",F-O),b.select("rect."+x.maskMinClassName).attr("width",O),b.select("rect."+x.maskMaxClassName).attr("x",F).attr("width",T._width-F),P.rangemode!=="match"){var N=T._height-D(T.d2pOppAxis(k._rl[1])),G=T._height-D(T.d2pOppAxis(k._rl[0]));b.select("rect."+x.maskMinOppAxisClassName).attr("x",O).attr("height",N).attr("width",F-O),b.select("rect."+x.maskMaxOppAxisClassName).attr("x",O).attr("y",G).attr("height",T._height-G).attr("width",F-O),b.select("rect."+x.slideBoxClassName).attr("y",N).attr("height",G-N)}var K=.5,W=Math.round(R(O-z))-K,Y=Math.round(R(F-z))+K;b.select("g."+x.grabberMinClassName).attr("transform",e(W,K)),b.select("g."+x.grabberMaxClassName).attr("transform",e(Y,K))}function y(b,u,L,T){var k=M.ensureSingle(b,"rect",x.bgClassName,function(D){D.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),P=T.borderwidth%2===0?T.borderwidth:T.borderwidth-1,z=-T._offsetShift,I=a.crispRound(u,T.borderwidth);k.attr({width:T._width+P,height:T._height+P,transform:e(z,z),"stroke-width":I}).call(n.stroke,T.bordercolor).call(n.fill,T.bgcolor)}function o(b,u,L,T){var k=u._fullLayout,P=M.ensureSingleById(k._topdefs,"clipPath",T._clipId,function(z){z.append("rect").attr({x:0,y:0})});P.select("rect").attr({width:T._width,height:T._height})}function m(b,u,L,T){var k=u.calcdata,P=b.selectAll("g."+x.rangePlotClassName).data(L._subplotsWith,M.identity);P.enter().append("g").attr("class",function(I){return x.rangePlotClassName+" "+I}).call(a.setClipUrl,T._clipId,u),P.order(),P.exit().remove();var z;P.each(function(I,D){var R=A.select(this),O=D===0,F=c.getFromId(u,I,"y"),N=F._name,G=T[N],K={data:[],layout:{xaxis:{type:L.type,domain:[0,1],range:T.range.slice(),calendar:L.calendar},width:T._width,height:T._height,margin:{t:0,b:0,l:0,r:0}},_context:u._context};L.rangebreaks&&(K.layout.xaxis.rangebreaks=L.rangebreaks),K.layout[N]={type:F.type,domain:[0,1],range:G.rangemode!=="match"?G.range.slice():F.range.slice(),calendar:F.calendar},F.rangebreaks&&(K.layout[N].rangebreaks=F.rangebreaks),S.supplyDefaults(K);var W=K._fullLayout.xaxis,Y=K._fullLayout[N];W.clearCalc(),W.setScale(),Y.clearCalc(),Y.setScale();var re={id:I,plotgroup:R,xaxis:W,yaxis:Y,isRangePlot:!0};O?z=re:(re.mainplot="xy",re.mainplotinfo=z),t.rangePlot(u,re,l(k,I))})}function l(b,u){for(var L=[],T=0;T<b.length;T++){var k=b[T],P=k[0].trace;P.xaxis+P.yaxis===u&&L.push(k)}return L}function w(b,u,L,T,k){var P=M.ensureSingle(b,"rect",x.maskMinClassName,function(R){R.attr({x:0,y:0,"shape-rendering":"crispEdges"})});P.attr("height",T._height).call(n.fill,x.maskColor);var z=M.ensureSingle(b,"rect",x.maskMaxClassName,function(R){R.attr({y:0,"shape-rendering":"crispEdges"})});if(z.attr("height",T._height).call(n.fill,x.maskColor),k.rangemode!=="match"){var I=M.ensureSingle(b,"rect",x.maskMinOppAxisClassName,function(R){R.attr({y:0,"shape-rendering":"crispEdges"})});I.attr("width",T._width).call(n.fill,x.maskOppAxisColor);var D=M.ensureSingle(b,"rect",x.maskMaxOppAxisClassName,function(R){R.attr({y:0,"shape-rendering":"crispEdges"})});D.attr("width",T._width).style("border-top",x.maskOppBorder).call(n.fill,x.maskOppAxisColor)}}function _(b,u,L,T){if(!u._context.staticPlot){var k=M.ensureSingle(b,"rect",x.slideBoxClassName,function(P){P.attr({y:0,cursor:x.slideBoxCursor,"shape-rendering":"crispEdges"})});k.attr({height:T._height,fill:x.slideBoxFill})}}function h(b,u,L,T){var k=M.ensureSingle(b,"g",x.grabberMinClassName),P=M.ensureSingle(b,"g",x.grabberMaxClassName),z={x:0,width:x.handleWidth,rx:x.handleRadius,fill:n.background,stroke:n.defaultLine,"stroke-width":x.handleStrokeWidth,"shape-rendering":"crispEdges"},I={y:Math.round(T._height/4),height:Math.round(T._height/2)},D=M.ensureSingle(k,"rect",x.handleMinClassName,function(G){G.attr(z)});D.attr(I);var R=M.ensureSingle(P,"rect",x.handleMaxClassName,function(G){G.attr(z)});R.attr(I);var O={width:x.grabAreaWidth,x:0,y:0,fill:x.grabAreaFill,cursor:u._context.staticPlot?void 0:x.grabAreaCursor},F=M.ensureSingle(k,"rect",x.grabAreaMinClassName,function(G){G.attr(O)});F.attr("height",T._height);var N=M.ensureSingle(P,"rect",x.grabAreaMaxClassName,function(G){G.attr(O)});N.attr("height",T._height)}},{"../../lib":515,"../../lib/setcursor":536,"../../plots/cartesian":578,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":441,"@plotly/d3":58}],444:[function(d,ee,te){var A=d("../../plots/cartesian/axis_ids"),g=d("../../lib/svg_text_utils"),S=d("./constants"),M=d("../../constants/alignment").LINE_SPACING,e=S.name;function a(n){var r=n&&n[e];return r&&r.visible}te.isVisible=a,te.makeData=function(n){var r=A.list({_fullLayout:n},"x",!0),t=n.margin,c=[];if(!n._has("gl2d"))for(var s=0;s<r.length;s++){var i=r[s];if(a(i)){c.push(i);var x=i[e];x._id=e+i._id,x._height=(n.height-t.b-t.t)*x.thickness,x._offsetShift=Math.floor(x.borderwidth/2)}}n._rangeSliderData=c},te.autoMarginOpts=function(n,r){var t=n._fullLayout,c=r[e],s=r._id.charAt(0),i=0,x=0;if(r.side==="bottom"&&(i=r._depth,r.title.text!==t._dfltTitle[s])){x=1.5*r.title.font.size+10+c._offsetShift;var p=(r.title.text.match(g.BR_TAG_ALL)||[]).length;x+=p*r.title.font.size*M}return{x:0,y:r._counterDomainMin,l:0,r:0,t:0,b:c._height+i+Math.max(t.margin.b,x),pad:S.extraPad+c._offsetShift*2}}},{"../../constants/alignment":483,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"./constants":441}],445:[function(d,ee,te){var A=d("../../lib"),g=d("./attributes"),S=d("./oppaxis_attributes"),M=d("./helpers");ee.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:A.extendFlat({},g,{yaxis:S})}}},layoutAttributes:d("./attributes"),handleDefaults:d("./defaults"),calcAutorange:d("./calc_autorange"),draw:d("./draw"),isVisible:M.isVisible,makeData:M.makeData,autoMarginOpts:M.autoMarginOpts}},{"../../lib":515,"./attributes":439,"./calc_autorange":440,"./defaults":442,"./draw":443,"./helpers":444,"./oppaxis_attributes":446}],446:[function(d,ee,te){ee.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],447:[function(d,ee,te){var A=d("../annotations/attributes"),g=d("../../traces/scatter/attributes").line,S=d("../drawing/attributes").dash,M=d("../../lib/extend").extendFlat,e=d("../../plot_api/edit_types").overrideAll,a=d("../../plot_api/plot_template").templatedArray;d("../../constants/axis_placeable_objects"),ee.exports=e(a("selection",{type:{valType:"enumerated",values:["rect","path"]},xref:M({},A.xref,{}),yref:M({},A.yref,{}),x0:{valType:"any"},x1:{valType:"any"},y0:{valType:"any"},y1:{valType:"any"},path:{valType:"string",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:.7,editType:"arraydraw"},line:{color:g.color,width:M({},g.width,{min:1,dflt:1}),dash:M({},S,{dflt:"dot"})}}),"arraydraw","from-root")},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],448:[function(d,ee,te){ee.exports={BENDPX:1.5,MINSELECT:12,SELECTDELAY:100,SELECTID:"-select"}},{}],449:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axes"),S=d("../../plots/array_container_defaults"),M=d("./attributes"),e=d("../shapes/helpers");ee.exports=function(r,t){S(r,t,{name:"selections",handleItemDefaults:a});for(var c=t.selections,s=0;s<c.length;s++){var i=c[s];!i||i.path===void 0&&(i.x0===void 0||i.x1===void 0||i.y0===void 0||i.y1===void 0)&&(t.selections[s]=null)}};function a(n,r,t){function c(P,z){return A.coerce(n,r,M,P,z)}var s=c("path"),i=s?"path":"rect",x=c("type",i),p=x!=="path";p&&delete r.path,c("opacity"),c("line.color"),c("line.width"),c("line.dash");for(var v=["x","y"],f=0;f<2;f++){var y=v[f],o={_fullLayout:t},m,l,w,_=g.coerceRef(n,r,o,y);if(m=g.getFromId(o,_),m._selectionIndices.push(r._index),w=e.rangeToShapePosition(m),l=e.shapePositionToRange(m),p){var h=y+"0",b=y+"1",u=n[h],L=n[b];n[h]=l(n[h],!0),n[b]=l(n[b],!0),g.coercePosition(r,o,c,_,h),g.coercePosition(r,o,c,_,b);var T=r[h],k=r[b];T!==void 0&&k!==void 0&&(r[h]=w(T),r[b]=w(k),n[h]=u,n[b]=L)}}p&&A.noneOrAll(n,r,["x0","x1","y0","y1"])}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../shapes/helpers":469,"./attributes":447}],450:[function(d,ee,te){var A=d("../shapes/draw_newshape/helpers").readPaths,g=d("../shapes/display_outlines"),S=d("../shapes/handle_outline").clearOutlineControllers,M=d("../color"),e=d("../drawing"),a=d("../../plot_api/plot_template").arrayEditor,n=d("../shapes/helpers"),r=n.getPathString;ee.exports={draw:t,drawOne:s,activateLastSelection:p};function t(f){var y=f._fullLayout;S(f),y._selectionLayer.selectAll("path").remove();for(var o in y._plots){var m=y._plots[o].selectionLayer;m&&m.selectAll("path").remove()}for(var l=0;l<y.selections.length;l++)s(f,l)}function c(f){return f._context.editSelection}function s(f,y){f._fullLayout._paperdiv.selectAll('.selectionlayer [data-index="'+y+'"]').remove();var o=n.makeSelectionsOptionsAndPlotinfo(f,y),m=o.options,l=o.plotinfo;if(!m._input)return;w(f._fullLayout._selectionLayer);function w(_){var h=r(f,m),b={"data-index":y,"fill-rule":"evenodd",d:h},u=m.opacity,L="rgba(0,0,0,0)",T=m.line.color||M.contrast(f._fullLayout.plot_bgcolor),k=m.line.width,P=m.line.dash;k||(k=5,P="solid");var z=c(f)&&f._fullLayout._activeSelectionIndex===y;z&&(L=f._fullLayout.activeselection.fillcolor,u=f._fullLayout.activeselection.opacity);for(var I=[],D=1;D>=0;D--){var R=_.append("path").attr(b).style("opacity",D?.1:u).call(M.stroke,T).call(M.fill,L).call(e.dashLine,D?"solid":P,D?4+k:k);if(i(R,f,m),z){var O=a(f.layout,"selections",m);R.style({cursor:"move"});var F={element:R.node(),plotinfo:l,gd:f,editHelpers:O,isActiveSelection:!0},N=A(h,f);g(N,R,F)}else R.style("pointer-events",D?"all":"none");I[D]=R}var G=I[0],K=I[1];K.node().addEventListener("click",function(){return x(f,G)})}}function i(f,y,o){var m=o.xref+o.yref;e.setClipUrl(f,"clip"+y._fullLayout._uid+m,y)}function x(f,y){if(!!c(f)){var o=y.node(),m=+o.getAttribute("data-index");if(m>=0){if(m===f._fullLayout._activeSelectionIndex){v(f);return}f._fullLayout._activeSelectionIndex=m,f._fullLayout._deactivateSelection=v,t(f)}}}function p(f){if(!!c(f)){var y=f._fullLayout.selections.length-1;f._fullLayout._activeSelectionIndex=y,f._fullLayout._deactivateSelection=v,t(f)}}function v(f){if(!!c(f)){var y=f._fullLayout._activeSelectionIndex;y>=0&&(S(f),delete f._fullLayout._activeSelectionIndex,t(f))}}},{"../../plot_api/plot_template":555,"../color":367,"../drawing":389,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/handle_outline":468,"../shapes/helpers":469}],451:[function(d,ee,te){var A=d("../../drawing/attributes").dash,g=d("../../../lib/extend").extendFlat;ee.exports={newselection:{mode:{valType:"enumerated",values:["immediate","gradual"],dflt:"immediate",editType:"none"},line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:1,dflt:1,editType:"none"},dash:g({},A,{dflt:"dot",editType:"none"}),editType:"none"},editType:"none"},activeselection:{fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],452:[function(d,ee,te){ee.exports=function(g,S,M){M("newselection.mode");var e=M("newselection.line.width");e&&(M("newselection.line.color"),M("newselection.line.dash")),M("activeselection.fillcolor"),M("activeselection.opacity")}},{}],453:[function(d,ee,te){var A=d("../../dragelement/helpers"),g=A.selectMode,S=d("../../shapes/handle_outline"),M=S.clearOutline,e=d("../../shapes/draw_newshape/helpers"),a=e.readPaths,n=e.writePaths,r=e.fixDatesForPaths;ee.exports=function(c,s){if(!!c.length){var i=c[0][0];if(!!i){var x=i.getAttribute("d"),p=s.gd,v=p._fullLayout.newselection,f=s.plotinfo,y=f.xaxis,o=f.yaxis,m=s.isActiveSelection,l=s.dragmode,w=(p.layout||{}).selections||[];if(!g(l)&&m!==void 0){var _=p._fullLayout._activeSelectionIndex;if(_<w.length)switch(p._fullLayout.selections[_].type){case"rect":l="select";break;case"path":l="lasso";break}}var h=a(x,p,f,m),b={xref:y._id,yref:o._id,opacity:v.opacity,line:{color:v.line.color,width:v.line.width,dash:v.line.dash}},u;h.length===1&&(u=h[0]),u&&u.length===5&&l==="select"?(b.type="rect",b.x0=u[0][1],b.y0=u[0][2],b.x1=u[2][1],b.y1=u[2][2]):(b.type="path",y&&o&&r(h,y,o),b.path=n(h),u=null),M(p);for(var L=s.editHelpers,T=(L||{}).modifyItem,k=[],P=0;P<w.length;P++){var z=p._fullLayout.selections[P];if(!z){k[P]=z;continue}if(k[P]=z._input,m!==void 0&&P===p._fullLayout._activeSelectionIndex){var I=b;switch(z.type){case"rect":T("x0",I.x0),T("x1",I.x1),T("y0",I.y0),T("y1",I.y1);break;case"path":T("path",I.path);break}}}return m===void 0?(k.push(b),k):L?L.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../shapes/draw_newshape/helpers":466,"../../shapes/handle_outline":468}],454:[function(d,ee,te){var A=d("../../lib").strTranslate;function g(a,n){switch(a.type){case"log":return a.p2d(n);case"date":return a.p2r(n,0,a.calendar);default:return a.p2r(n)}}function S(a,n){switch(a.type){case"log":return a.d2p(n);case"date":return a.r2p(n,0,a.calendar);default:return a.r2p(n)}}function M(a){var n=a._id.charAt(0)==="y"?1:0;return function(r){return g(a,r[n])}}function e(a){return A(a.xaxis._offset,a.yaxis._offset)}ee.exports={p2r:g,r2p:S,axValue:M,getTransform:e}},{"../../lib":515}],455:[function(d,ee,te){var A=d("./draw"),g=d("./select");ee.exports={moduleType:"component",name:"selections",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),supplyDrawNewSelectionDefaults:d("./draw_newselection/defaults"),includeBasePlot:d("../../plots/cartesian/include_components")("selections"),draw:A.draw,drawOne:A.drawOne,reselect:g.reselect,prepSelect:g.prepSelect,clearOutline:g.clearOutline,clearSelectionsCache:g.clearSelectionsCache,selectOnClick:g.selectOnClick}},{"../../plots/cartesian/include_components":577,"./attributes":447,"./defaults":449,"./draw":450,"./draw_newselection/defaults":452,"./select":456}],456:[function(d,ee,te){var A=d("polybooljs"),g=d("point-in-polygon/nested"),S=d("../../registry"),M=d("../drawing").dashStyle,e=d("../color"),a=d("../fx"),n=d("../fx/helpers").makeEventData,r=d("../dragelement/helpers"),t=r.freeMode,c=r.rectMode,s=r.drawMode,i=r.openMode,x=r.selectMode,p=d("../shapes/helpers"),v=d("../shapes/constants"),f=d("../shapes/display_outlines"),y=d("../shapes/handle_outline").clearOutline,o=d("../shapes/draw_newshape/helpers"),m=o.handleEllipse,l=o.readPaths,w=d("../shapes/draw_newshape/newshapes"),_=d("./draw_newselection/newselections"),h=d("./draw").activateLastSelection,b=d("../../lib"),u=b.sorterAsc,L=d("../../lib/polygon"),T=d("../../lib/throttle"),k=d("../../plots/cartesian/axis_ids").getFromId,P=d("../../lib/clear_gl_canvases"),z=d("../../plot_api/subroutines").redrawReglTraces,I=d("./constants"),D=I.MINSELECT,R=L.filter,O=L.tester,F=d("./helpers"),N=F.p2r,G=F.axValue,K=F.getTransform;function W(Ye){return Ye.subplot!==void 0}function Y(Ye,rt,Ve,Ae,Ue){var Ze=!W(Ae),Qe=t(Ue),_t=c(Ue),gt=i(Ue),wt=s(Ue),Ut=x(Ue),Dt=Ue==="drawline",Nt=Ue==="drawcircle",Xt=Dt||Nt,Ht=Ae.gd,ar=Ht._fullLayout,Vr=Ut&&ar.newselection.mode==="immediate"&&Ze,nn=ar._zoomlayer,jr=Ae.element.getBoundingClientRect(),at=Ae.plotinfo,$t=K(at),Zt=rt-jr.left,ur=Ve-jr.top;ar._calcInverseTransform(Ht);var wr=b.apply3DTransform(ar._invTransform)(Zt,ur);Zt=wr[0],ur=wr[1];var $e=ar._invScaleX,Je=ar._invScaleY,it=Zt,lt=ur,Tt="M"+Zt+","+ur,Bt=Ae.xaxes[0],Ce=Ae.yaxes[0],Me=Bt._length,nt=Ce._length,st=Ye.altKey&&!(s(Ue)&&gt),ct,At,dt,Ct,Gt,rr,kr;U(Ye,Ht,Ae),Qe&&(ct=R([[Zt,ur]],I.BENDPX));var br=nn.selectAll("path.select-outline-"+at.id).data([1]),Ar=wt?ar.newshape:ar.newselection,Wr=wt&&!gt?Ar.fillcolor:"rgba(0,0,0,0)",nr=Ar.line.color||(Ze?e.contrast(Ht._fullLayout.plot_bgcolor):"#7f7f7f");br.enter().append("path").attr("class","select-outline select-outline-"+at.id).style({opacity:wt?Ar.opacity/2:1,"stroke-dasharray":M(Ar.line.dash,Ar.line.width),"stroke-width":Ar.line.width+"px","shape-rendering":"crispEdges"}).call(e.stroke,nr).call(e.fill,Wr).attr("fill-rule","evenodd").classed("cursor-move",!!wt).attr("transform",$t).attr("d",Tt+"Z");var yr=nn.append("path").attr("class","zoombox-corners").style({fill:e.background,stroke:e.defaultLine,"stroke-width":1}).attr("transform",$t).attr("d","M0,0Z"),Pr=ar._uid+I.SELECTID,Or=[],Sr=ie(Ht,Ae.xaxes,Ae.yaxes,Ae.subplot);Vr&&!Ye.shiftKey&&(Ae._clearSubplotSelections=function(){if(!!Ze){var Lt=Bt._id,Wt=Ce._id;He(Ht,Lt,Wt,Sr);for(var ir=(Ht.layout||{}).selections||[],Ir=[],Br=!1,Er=0;Er<ir.length;Er++){var _r=ar.selections[Er];_r.xref!==Lt||_r.yref!==Wt?Ir.push(ir[Er]):Br=!0}Br&&(Ht._fullLayout._noEmitSelectedAtStart=!0,S.call("_guiRelayout",Ht,{selections:Ir}))}});var tt=Mt(Ae);Ae.moveFn=function(Lt,Wt){Ae._clearSubplotSelections&&(Ae._clearSubplotSelections(),Ae._clearSubplotSelections=void 0),it=Math.max(0,Math.min(Me,$e*Lt+Zt)),lt=Math.max(0,Math.min(nt,Je*Wt+ur));var ir=Math.abs(it-Zt),Ir=Math.abs(lt-ur);if(_t){var Br,Er,_r;if(Ut){var Gr=ar.selectdirection;switch(Gr==="any"?Ir<Math.min(ir*.6,D)?Br="h":ir<Math.min(Ir*.6,D)?Br="v":Br="d":Br=Gr,Br){case"h":Er=Nt?nt/2:0,_r=nt;break;case"v":Er=Nt?Me/2:0,_r=Me;break}}if(wt)switch(ar.newshape.drawdirection){case"vertical":Br="h",Er=Nt?nt/2:0,_r=nt;break;case"horizontal":Br="v",Er=Nt?Me/2:0,_r=Me;break;case"ortho":ir<Ir?(Br="h",Er=ur,_r=lt):(Br="v",Er=Zt,_r=it);break;default:Br="d"}Br==="h"?(Ct=Xt?m(Nt,[it,Er],[it,_r]):[[Zt,Er],[Zt,_r],[it,_r],[it,Er]],Ct.xmin=Xt?it:Math.min(Zt,it),Ct.xmax=Xt?it:Math.max(Zt,it),Ct.ymin=Math.min(Er,_r),Ct.ymax=Math.max(Er,_r),yr.attr("d","M"+Ct.xmin+","+(ur-D)+"h-4v"+2*D+"h4ZM"+(Ct.xmax-1)+","+(ur-D)+"h4v"+2*D+"h-4Z")):Br==="v"?(Ct=Xt?m(Nt,[Er,lt],[_r,lt]):[[Er,ur],[Er,lt],[_r,lt],[_r,ur]],Ct.xmin=Math.min(Er,_r),Ct.xmax=Math.max(Er,_r),Ct.ymin=Xt?lt:Math.min(ur,lt),Ct.ymax=Xt?lt:Math.max(ur,lt),yr.attr("d","M"+(Zt-D)+","+Ct.ymin+"v-4h"+2*D+"v4ZM"+(Zt-D)+","+(Ct.ymax-1)+"v4h"+2*D+"v-4Z")):Br==="d"&&(Ct=Xt?m(Nt,[Zt,ur],[it,lt]):[[Zt,ur],[Zt,lt],[it,lt],[it,ur]],Ct.xmin=Math.min(Zt,it),Ct.xmax=Math.max(Zt,it),Ct.ymin=Math.min(ur,lt),Ct.ymax=Math.max(ur,lt),yr.attr("d","M0,0Z"))}else Qe&&(ct.addPt([it,lt]),Ct=ct.filtered);if(Ae.selectionDefs&&Ae.selectionDefs.length?(dt=me(Ae.mergedPolygons,Ct,st),Ct.subtract=st,At=V(Ae.selectionDefs.concat([Ct]))):(dt=[Ct],At=O(Ct)),f(Pe(dt,gt),br,Ae),Ut){var wn=we(Ht,!1),cn=wn.eventData?wn.eventData.points.slice():[];wn=we(Ht,!1,At,Sr,Ae),At=wn.selectionTesters,kr=wn.eventData;var Bn;ct?Bn=ct.filtered:Bn=Rt(dt),T.throttle(Pr,I.SELECTDELAY,function(){Or=Ne(At,Sr);for(var En=Or.slice(),Yn=0;Yn<cn.length;Yn++){for(var Hn=cn[Yn],pa=!1,Ma=0;Ma<En.length;Ma++)if(En[Ma].curveNumber===Hn.curveNumber&&En[Ma].pointNumber===Hn.pointNumber){pa=!0;break}pa||En.push(Hn)}En.length&&(kr||(kr={}),kr.points=En),tt(kr,Bn),Yt(Ht,kr)})}},Ae.clickFn=function(Lt,Wt){if(yr.remove(),Ht._fullLayout._activeShapeIndex>=0){Ht._fullLayout._deactivateShape(Ht);return}if(!wt){var ir=ar.clickmode;T.done(Pr).then(function(){if(T.clear(Pr),Lt===2){for(br.remove(),Gt=0;Gt<Sr.length;Gt++)rr=Sr[Gt],rr._module.selectPoints(rr,!1);if(ye(Ht,Sr),X(Ae),St(Ht),Sr.length){var Ir=Sr[0].xaxis,Br=Sr[0].yaxis;if(Ir&&Br){for(var Er=[],_r=Ht._fullLayout.selections,Gr=0;Gr<_r.length;Gr++){var wn=_r[Gr];!wn||(wn.xref!==Ir._id||wn.yref!==Br._id)&&Er.push(wn)}Er.length<_r.length&&(Ht._fullLayout._noEmitSelectedAtStart=!0,S.call("_guiRelayout",Ht,{selections:Er}))}}}else ir.indexOf("select")>-1&&re(Wt,Ht,Ae.xaxes,Ae.yaxes,Ae.subplot,Ae,br),ir==="event"&&zt(Ht,void 0);a.click(Ht,Wt)}).catch(b.error)}},Ae.doneFn=function(){yr.remove(),T.done(Pr).then(function(){T.clear(Pr),!Vr&&Ct&&Ae.selectionDefs&&(Ct.subtract=st,Ae.selectionDefs.push(Ct),Ae.mergedPolygons.length=0,[].push.apply(Ae.mergedPolygons,dt)),(Vr||wt)&&X(Ae,Vr),Ae.doneFnCompleted&&Ae.doneFnCompleted(Or),Ut&&zt(Ht,kr)}).catch(b.error)}}function re(Ye,rt,Ve,Ae,Ue,Ze,Qe){var _t=rt._hoverdata,gt=rt._fullLayout,wt=gt.clickmode,Ut=wt.indexOf("event")>-1,Dt=[],Nt,Xt,Ht,ar,Vr,nn,jr,at,$t,Zt;if(ae(_t)){U(Ye,rt,Ze),Nt=ie(rt,Ve,Ae,Ue);var ur=oe(_t,Nt),wr=ur.pointNumbers.length>0;if(wr?ce(Nt,ur):de(Nt)&&(jr=be(ur))){for(Qe&&Qe.remove(),Zt=0;Zt<Nt.length;Zt++)Xt=Nt[Zt],Xt._module.selectPoints(Xt,!1);ye(rt,Nt),X(Ze),Ut&&St(rt)}else{at=Ye.shiftKey&&(jr!==void 0?jr:be(ur)),Ht=ue(ur.pointNumber,ur.searchInfo,at);var $e=Ze.selectionDefs.concat([Ht]);for(ar=V($e),Zt=0;Zt<Nt.length;Zt++)if(Vr=Nt[Zt]._module.selectPoints(Nt[Zt],ar),nn=Ee(Vr,Nt[Zt]),Dt.length)for(var Je=0;Je<nn.length;Je++)Dt.push(nn[Je]);else Dt=nn;if($t={points:Dt},ye(rt,Nt,$t),Ht&&Ze&&Ze.selectionDefs.push(Ht),Qe){var it=Ze.mergedPolygons,lt=i(Ze.dragmode);f(Pe(it,lt),Qe,Ze)}Ut&&zt(rt,$t)}}}function ue(Ye,rt,Ve){return{pointNumber:Ye,searchInfo:rt,subtract:!!Ve}}function j(Ye){return"pointNumber"in Ye&&"searchInfo"in Ye}function q(Ye){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(rt,Ve,Ae,Ue){var Ze=Ye.searchInfo.cd[0].trace._expandedIndex,Qe=Ue.cd[0].trace._expandedIndex;return Qe===Ze&&Ae===Ye.pointNumber},isRect:!1,degenerate:!1,subtract:!!Ye.subtract}}function V(Ye){if(!Ye.length)return;for(var rt=[],Ve=j(Ye[0])?0:Ye[0][0][0],Ae=Ve,Ue=j(Ye[0])?0:Ye[0][0][1],Ze=Ue,Qe=0;Qe<Ye.length;Qe++)if(j(Ye[Qe]))rt.push(q(Ye[Qe]));else{var _t=O(Ye[Qe]);_t.subtract=!!Ye[Qe].subtract,rt.push(_t),Ve=Math.min(Ve,_t.xmin),Ae=Math.max(Ae,_t.xmax),Ue=Math.min(Ue,_t.ymin),Ze=Math.max(Ze,_t.ymax)}function gt(wt,Ut,Dt,Nt){for(var Xt=!1,Ht=0;Ht<rt.length;Ht++)rt[Ht].contains(wt,Ut,Dt,Nt)&&(Xt=!rt[Ht].subtract);return Xt}return{xmin:Ve,xmax:Ae,ymin:Ue,ymax:Ze,pts:[],contains:gt,isRect:!1,degenerate:!1}}function U(Ye,rt,Ve){var Ae=rt._fullLayout,Ue=Ve.plotinfo,Ze=Ve.dragmode,Qe=Ae._lastSelectedSubplot&&Ae._lastSelectedSubplot===Ue.id,_t=(Ye.shiftKey||Ye.altKey)&&!(s(Ze)&&i(Ze));Qe&&_t&&Ue.selection&&Ue.selection.selectionDefs&&!Ve.selectionDefs?(Ve.selectionDefs=Ue.selection.selectionDefs,Ve.mergedPolygons=Ue.selection.mergedPolygons):(!_t||!Ue.selection)&&X(Ve),Qe||(y(rt),Ae._lastSelectedSubplot=Ue.id)}function $(Ye){return Ye._fullLayout._activeShapeIndex>=0}function ne(Ye){return Ye._fullLayout._activeSelectionIndex>=0}function X(Ye,rt){var Ve=Ye.dragmode,Ae=Ye.plotinfo,Ue=Ye.gd;$(Ue)&&Ue._fullLayout._deactivateShape(Ue),ne(Ue)&&Ue._fullLayout._deactivateSelection(Ue);var Ze=Ue._fullLayout,Qe=Ze._zoomlayer,_t=s(Ve),gt=x(Ve);if(_t||gt){var wt=Qe.selectAll(".select-outline-"+Ae.id);if(wt&&Ue._fullLayout._outlining){var Ut;_t&&(Ut=w(wt,Ye)),Ut&&S.call("_guiRelayout",Ue,{shapes:Ut});var Dt;gt&&!W(Ye)&&(Dt=_(wt,Ye)),Dt&&(Ue._fullLayout._noEmitSelectedAtStart=!0,S.call("_guiRelayout",Ue,{selections:Dt}).then(function(){rt&&h(Ue)})),Ue._fullLayout._outlining=!1}}Ae.selection={},Ae.selection.selectionDefs=Ye.selectionDefs=[],Ae.selection.mergedPolygons=Ye.mergedPolygons=[]}function Q(Ye){return Ye._id}function ie(Ye,rt,Ve,Ae){if(!Ye.calcdata)return[];var Ue=[],Ze=rt.map(Q),Qe=Ve.map(Q),_t,gt,wt;for(wt=0;wt<Ye.calcdata.length;wt++)if(_t=Ye.calcdata[wt],gt=_t[0].trace,!(gt.visible!==!0||!gt._module||!gt._module.selectPoints))if(W({subplot:Ae})&&(gt.subplot===Ae||gt.geo===Ae))Ue.push(se(gt._module,_t,rt[0],Ve[0]));else if(gt.type==="splom"){if(gt._xaxes[Ze[0]]&&gt._yaxes[Qe[0]]){var Ut=se(gt._module,_t,rt[0],Ve[0]);Ut.scene=Ye._fullLayout._splomScenes[gt.uid],Ue.push(Ut)}}else if(gt.type==="sankey"){var Dt=se(gt._module,_t,rt[0],Ve[0]);Ue.push(Dt)}else{if(Ze.indexOf(gt.xaxis)===-1||Qe.indexOf(gt.yaxis)===-1)continue;Ue.push(se(gt._module,_t,k(Ye,gt.xaxis),k(Ye,gt.yaxis)))}return Ue}function se(Ye,rt,Ve,Ae){return{_module:Ye,cd:rt,xaxis:Ve,yaxis:Ae}}function ae(Ye){return Ye&&Array.isArray(Ye)&&Ye[0].hoverOnBox!==!0}function oe(Ye,rt){var Ve=Ye[0],Ae=-1,Ue=[],Ze,Qe;for(Qe=0;Qe<rt.length;Qe++)if(Ze=rt[Qe],Ve.fullData._expandedIndex===Ze.cd[0].trace._expandedIndex){if(Ve.hoverOnBox===!0)break;Ve.pointNumber!==void 0?Ae=Ve.pointNumber:Ve.binNumber!==void 0&&(Ae=Ve.binNumber,Ue=Ve.pointNumbers);break}return{pointNumber:Ae,pointNumbers:Ue,searchInfo:Ze}}function be(Ye){var rt=Ye.searchInfo.cd[0].trace,Ve=Ye.pointNumber,Ae=Ye.pointNumbers,Ue=Ae.length>0,Ze=Ue?Ae[0]:Ve;return rt.selectedpoints?rt.selectedpoints.indexOf(Ze)>-1:!1}function ce(Ye,rt){var Ve=[],Ae,Ue,Ze,Qe;for(Qe=0;Qe<Ye.length;Qe++)Ae=Ye[Qe],Ae.cd[0].trace.selectedpoints&&Ae.cd[0].trace.selectedpoints.length>0&&Ve.push(Ae);if(Ve.length===1&&(Ze=Ve[0]===rt.searchInfo,Ze&&(Ue=rt.searchInfo.cd[0].trace,Ue.selectedpoints.length===rt.pointNumbers.length))){for(Qe=0;Qe<rt.pointNumbers.length;Qe++)if(Ue.selectedpoints.indexOf(rt.pointNumbers[Qe])<0)return!1;return!0}return!1}function de(Ye){var rt=0,Ve,Ae,Ue;for(Ue=0;Ue<Ye.length;Ue++)if(Ve=Ye[Ue],Ae=Ve.cd[0].trace,Ae.selectedpoints&&(Ae.selectedpoints.length>1||(rt+=Ae.selectedpoints.length,rt>1)))return!1;return rt===1}function ye(Ye,rt,Ve){var Ae;for(Ae=0;Ae<rt.length;Ae++){var Ue=rt[Ae].cd[0].trace._fullInput,Ze=Ye._fullLayout._tracePreGUI[Ue.uid]||{};Ze.selectedpoints===void 0&&(Ze.selectedpoints=Ue._input.selectedpoints||null)}var Qe;if(Ve){var _t=Ve.points||[];for(Ae=0;Ae<rt.length;Ae++)Qe=rt[Ae].cd[0].trace,Qe._input.selectedpoints=Qe._fullInput.selectedpoints=[],Qe._fullInput!==Qe&&(Qe.selectedpoints=[]);for(var gt=0;gt<_t.length;gt++){var wt=_t[gt],Ut=wt.data,Dt=wt.fullData,Nt=wt.pointIndex,Xt=wt.pointIndices;Xt?([].push.apply(Ut.selectedpoints,Xt),Qe._fullInput!==Qe&&[].push.apply(Dt.selectedpoints,Xt)):(Ut.selectedpoints.push(Nt),Qe._fullInput!==Qe&&Dt.selectedpoints.push(Nt))}}else for(Ae=0;Ae<rt.length;Ae++)Qe=rt[Ae].cd[0].trace,delete Qe.selectedpoints,delete Qe._input.selectedpoints,Qe._fullInput!==Qe&&delete Qe._fullInput.selectedpoints;ge(Ye,rt)}function ge(Ye,rt){for(var Ve=!1,Ae=0;Ae<rt.length;Ae++){var Ue=rt[Ae],Ze=Ue.cd;S.traceIs(Ze[0].trace,"regl")&&(Ve=!0);var Qe=Ue._module,_t=Qe.styleOnSelect||Qe.style;_t&&(_t(Ye,Ze,Ze[0].node3),Ze[0].nodeRangePlot3&&_t(Ye,Ze,Ze[0].nodeRangePlot3))}Ve&&(P(Ye),z(Ye))}function me(Ye,rt,Ve){for(var Ae=Ve?A.difference:A.union,Ue=Ae({regions:Ye},{regions:[rt]}),Ze=Ue.regions.reverse(),Qe=0;Qe<Ze.length;Qe++){var _t=Ze[Qe];_t.subtract=Ge(_t,Ze.slice(0,Qe))}return Ze}function Ee(Ye,rt){if(Array.isArray(Ye))for(var Ve=rt.cd,Ae=rt.cd[0].trace,Ue=0;Ue<Ye.length;Ue++)Ye[Ue]=n(Ye[Ue],Ae,Ve);return Ye}function Pe(Ye,rt){for(var Ve=[],Ae=0;Ae<Ye.length;Ae++){Ve[Ae]=[];for(var Ue=0;Ue<Ye[Ae].length;Ue++){Ve[Ae][Ue]=[],Ve[Ae][Ue][0]=Ue?"L":"M";for(var Ze=0;Ze<Ye[Ae][Ue].length;Ze++)Ve[Ae][Ue].push(Ye[Ae][Ue][Ze])}rt||Ve[Ae].push(["Z",Ve[Ae][0][1],Ve[Ae][0][2]])}return Ve}function Ne(Ye,rt){for(var Ve=[],Ae,Ue,Ze=0;Ze<rt.length;Ze++){var Qe=rt[Ze];Ue=Qe._module.selectPoints(Qe,Ye),Ae=Ee(Ue,Qe),Ve=Ve.concat(Ae)}return Ve}function we(Ye,rt,Ve,Ae,Ue){var Ze=!!Ae,Qe,_t,gt;Ue&&(Qe=Ue.plotinfo,_t=Ue.xaxes[0]._id,gt=Ue.yaxes[0]._id);var wt=[],Ut=[],Dt=De(Ye),Nt=Ye._fullLayout;if(Qe){var Xt=Nt._zoomlayer,Ht=Nt.dragmode,ar=s(Ht),Vr=x(Ht);if(ar||Vr){var nn=k(Ye,_t,"x"),jr=k(Ye,gt,"y");if(nn&&jr){var at=Xt.selectAll(".select-outline-"+Qe.id);if(at&&Ye._fullLayout._outlining&&at.length){for(var $t=at[0][0],Zt=$t.getAttribute("d"),ur=l(Zt,Ye,Qe),wr=[],$e=0;$e<ur.length;$e++){for(var Je=ur[$e],it=[],lt=0;lt<Je.length;lt++)it.push([ht(nn,Je[lt][1]),ht(jr,Je[lt][2])]);it.xref=_t,it.yref=gt,it.subtract=Ge(it,wr),wr.push(it)}Dt=Dt.concat(wr)}}}}var Tt=_t&&gt?[_t+gt]:Nt._subplots.cartesian;ke(Ye);for(var Bt={},Ce=0;Ce<Tt.length;Ce++){var Me=Tt[Ce],nt=Me.indexOf("y"),st=Me.slice(0,nt),ct=Me.slice(nt),At=_t&&gt?Ve:void 0;if(At=Ie(Dt,st,ct,At),At){var dt=Ae;if(!Ze){var Ct=k(Ye,st,"x"),Gt=k(Ye,ct,"y");dt=ie(Ye,[Ct],[Gt],Me);for(var rr=0;rr<dt.length;rr++){var kr=dt[rr],br=kr.cd[0],Ar=br.trace;if(kr._module.name==="scattergl"&&!br.t.xpx){var Wr=Ar.x,nr=Ar.y,yr=Ar._length;br.t.xpx=[],br.t.ypx=[];for(var Pr=0;Pr<yr;Pr++)br.t.xpx[Pr]=Ct.c2p(Wr[Pr]),br.t.ypx[Pr]=Gt.c2p(nr[Pr])}kr._module.name==="splom"&&(Bt[Ar.uid]||(Bt[Ar.uid]=!0))}}var Or=Ne(At,dt);wt=wt.concat(Or),Ut=Ut.concat(dt)}}var Sr={points:wt};ye(Ye,Ut,Sr);var tt=Nt.clickmode,Lt=tt.indexOf("event")>-1&&rt;if(!Qe&&rt){var Wt=De(Ye,!0);if(Wt.length){var ir=Wt[0].xref,Ir=Wt[0].yref;if(ir&&Ir){var Br=Rt(Wt),Er=It([k(Ye,ir,"x"),k(Ye,Ir,"y")]);Er(Sr,Br)}}Ye._fullLayout._noEmitSelectedAtStart?Ye._fullLayout._noEmitSelectedAtStart=!1:Lt&&zt(Ye,Sr),Nt._reselect=!1}if(!Qe&&Nt._deselect){var _r=Nt._deselect;_t=_r.xref,gt=_r.yref,Xe(_t,gt,Ut)||He(Ye,_t,gt,Ae),Lt&&(Sr.points.length?zt(Ye,Sr):St(Ye)),Nt._deselect=!1}return{eventData:Sr,selectionTesters:Ve}}function ke(Ye){var rt=Ye.calcdata;if(!!rt)for(var Ve=0;Ve<rt.length;Ve++){var Ae=rt[Ve][0],Ue=Ae.trace,Ze=Ye._fullLayout._splomScenes;if(Ze){var Qe=Ze[Ue.uid];Qe&&(Qe.selectBatch=[])}}}function Xe(Ye,rt,Ve){for(var Ae=0;Ae<Ve.length;Ae++){var Ue=Ve[Ae];if(Ue.xaxis&&Ue.xaxis._id===Ye&&Ue.yaxis&&Ue.yaxis._id===rt)return!0}return!1}function He(Ye,rt,Ve,Ae){Ae=ie(Ye,[k(Ye,rt,"x")],[k(Ye,Ve,"y")],rt+Ve);for(var Ue=0;Ue<Ae.length;Ue++){var Ze=Ae[Ue];Ze._module.selectPoints(Ze,!1)}ye(Ye,Ae)}function Ie(Ye,rt,Ve,Ae){for(var Ue,Ze=0;Ze<Ye.length;Ze++){var Qe=Ye[Ze];if(!(rt!==Qe.xref||Ve!==Qe.yref))if(Ue){var _t=!!Qe.subtract;Ue=me(Ue,Qe,_t),Ae=V(Ue)}else Ue=[Qe],Ae=O(Qe)}return Ae}function De(Ye,rt){for(var Ve=[],Ae=Ye._fullLayout,Ue=Ae.selections,Ze=Ue.length,Qe=0;Qe<Ze;Qe++)if(!(rt&&Qe!==Ae._activeSelectionIndex)){var _t=Ue[Qe];if(!!_t){var gt=_t.xref,wt=_t.yref,Ut=k(Ye,gt,"x"),Dt=k(Ye,wt,"y"),Nt,Xt,Ht,ar,Vr;if(_t.type==="rect"){Vr=[];var nn=ht(Ut,_t.x0),jr=ht(Ut,_t.x1),at=ht(Dt,_t.y0),$t=ht(Dt,_t.y1);Vr=[[nn,at],[nn,$t],[jr,$t],[jr,at]],Nt=Math.min(nn,jr),Xt=Math.max(nn,jr),Ht=Math.min(at,$t),ar=Math.max(at,$t),Vr.xmin=Nt,Vr.xmax=Xt,Vr.ymin=Ht,Vr.ymax=ar,Vr.xref=gt,Vr.yref=wt,Vr.subtract=!1,Vr.isRect=!0,Ve.push(Vr)}else if(_t.type==="path")for(var Zt=_t.path.split("Z"),ur=[],wr=0;wr<Zt.length;wr++){var $e=Zt[wr];if(!!$e){$e+="Z";var Je=p.extractPathCoords($e,v.paramIsX,"raw"),it=p.extractPathCoords($e,v.paramIsY,"raw");Nt=1/0,Xt=-1/0,Ht=1/0,ar=-1/0,Vr=[];for(var lt=0;lt<Je.length;lt++){var Tt=ht(Ut,Je[lt]),Bt=ht(Dt,it[lt]);Vr.push([Tt,Bt]),Nt=Math.min(Tt,Nt),Xt=Math.max(Tt,Xt),Ht=Math.min(Bt,Ht),ar=Math.max(Bt,ar)}Vr.xmin=Nt,Vr.xmax=Xt,Vr.ymin=Ht,Vr.ymax=ar,Vr.xref=gt,Vr.yref=wt,Vr.subtract=Ge(Vr,ur),ur.push(Vr),Ve.push(Vr)}}}}return Ve}function Ge(Ye,rt){for(var Ve=!1,Ae=0;Ae<rt.length;Ae++)for(var Ue=rt[Ae],Ze=0;Ze<Ye.length;Ze++)if(g(Ye[Ze],Ue)){Ve=!Ve;break}return Ve}function ht(Ye,rt){return Ye.type==="date"&&(rt=rt.replace("_"," ")),Ye.type==="log"?Ye.c2p(rt):Ye.r2p(rt,null,Ye.calendar)}function Rt(Ye){for(var rt=Ye.length,Ve=[],Ae=0;Ae<rt;Ae++){var Ue=Ye[Ae];Ve=Ve.concat(Ue),Ve=Ve.concat([Ue[0]])}return Kt(Ve)}function Kt(Ye){return Ye.isRect=Ye.length===5&&Ye[0][0]===Ye[4][0]&&Ye[0][1]===Ye[4][1]&&Ye[0][0]===Ye[1][0]&&Ye[2][0]===Ye[3][0]&&Ye[0][1]===Ye[3][1]&&Ye[1][1]===Ye[2][1]||Ye[0][1]===Ye[1][1]&&Ye[2][1]===Ye[3][1]&&Ye[0][0]===Ye[3][0]&&Ye[1][0]===Ye[2][0],Ye.isRect&&(Ye.xmin=Math.min(Ye[0][0],Ye[2][0]),Ye.xmax=Math.max(Ye[0][0],Ye[2][0]),Ye.ymin=Math.min(Ye[0][1],Ye[2][1]),Ye.ymax=Math.max(Ye[0][1],Ye[2][1])),Ye}function It(Ye){return function(rt,Ve){for(var Ae,Ue,Ze=0;Ze<Ye.length;Ze++){var Qe=Ye[Ze],_t=Qe._id,gt=_t.charAt(0);if(Ve.isRect){Ae||(Ae={});var wt=Ve[gt+"min"],Ut=Ve[gt+"max"];wt!==void 0&&Ut!==void 0&&(Ae[_t]=[N(Qe,wt),N(Qe,Ut)].sort(u))}else Ue||(Ue={}),Ue[_t]=Ve.map(G(Qe))}Ae&&(rt.range=Ae),Ue&&(rt.lassoPoints=Ue)}}function Mt(Ye){var rt=Ye.plotinfo;return rt.fillRangeItems||It(Ye.xaxes.concat(Ye.yaxes))}function Yt(Ye,rt){Ye.emit("plotly_selecting",rt)}function zt(Ye,rt){rt&&(rt.selections=(Ye.layout||{}).selections||[]),Ye.emit("plotly_selected",rt)}function St(Ye){Ye.emit("plotly_deselect",null)}ee.exports={reselect:we,prepSelect:Y,clearOutline:y,clearSelectionsCache:X,selectOnClick:re}},{"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/polygon":527,"../../lib/throttle":542,"../../plot_api/subroutines":556,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../color":367,"../dragelement/helpers":385,"../drawing":389,"../fx":407,"../fx/helpers":403,"../shapes/constants":459,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/draw_newshape/newshapes":467,"../shapes/handle_outline":468,"../shapes/helpers":469,"./constants":448,"./draw":450,"./draw_newselection/newselections":453,"./helpers":454,"point-in-polygon/nested":254,polybooljs:255}],457:[function(d,ee,te){var A=d("../annotations/attributes"),g=d("../../traces/scatter/attributes").line,S=d("../drawing/attributes").dash,M=d("../../lib/extend").extendFlat,e=d("../../plot_api/plot_template").templatedArray;d("../../constants/axis_placeable_objects"),ee.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:M({},A.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:M({},A.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:M({},g.color,{editType:"arraydraw"}),width:M({},g.width,{editType:"calc+arraydraw"}),dash:M({},S,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],458:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axes"),S=d("./constants"),M=d("./helpers");ee.exports=function(c){var s=c._fullLayout,i=A.filterVisible(s.shapes);if(!(!i.length||!c._fullData.length))for(var x=0;x<i.length;x++){var p=i[x];p._extremes={};var v,f,y=g.getRefType(p.xref),o=g.getRefType(p.yref);if(p.xref!=="paper"&&y!=="domain"){var m=p.xsizemode==="pixel"?p.xanchor:p.x0,l=p.xsizemode==="pixel"?p.xanchor:p.x1;v=g.getFromId(c,p.xref),f=r(v,m,l,p.path,S.paramIsX),f&&(p._extremes[v._id]=g.findExtremes(v,f,e(p)))}if(p.yref!=="paper"&&o!=="domain"){var w=p.ysizemode==="pixel"?p.yanchor:p.y0,_=p.ysizemode==="pixel"?p.yanchor:p.y1;v=g.getFromId(c,p.yref),f=r(v,w,_,p.path,S.paramIsY),f&&(p._extremes[v._id]=g.findExtremes(v,f,a(p)))}}};function e(t){return n(t.line.width,t.xsizemode,t.x0,t.x1,t.path,!1)}function a(t){return n(t.line.width,t.ysizemode,t.y0,t.y1,t.path,!0)}function n(t,c,s,i,x,p){var v=t/2,f=p;if(c==="pixel"){var y=x?M.extractPathCoords(x,p?S.paramIsY:S.paramIsX):[s,i],o=A.aggNums(Math.max,null,y),m=A.aggNums(Math.min,null,y),l=m<0?Math.abs(m)+v:v,w=o>0?o+v:v;return{ppad:v,ppadplus:f?l:w,ppadminus:f?w:l}}else return{ppad:v}}function r(t,c,s,i,x){var p=t.type==="category"||t.type==="multicategory"?t.r2c:t.d2c;if(c!==void 0)return[p(c),p(s)];if(!!i){var v=1/0,f=-1/0,y=i.match(S.segmentRE),o,m,l,w,_;for(t.type==="date"&&(p=M.decodeDate(p)),o=0;o<y.length;o++)m=y[o],l=x[m.charAt(0)].drawn,l!==void 0&&(w=y[o].substr(1).match(S.paramRE),!(!w||w.length<l)&&(_=p(w[l]),_<v&&(v=_),_>f&&(f=_)));if(f>=v)return[v,f]}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459,"./helpers":469}],459:[function(d,ee,te){ee.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],460:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axes"),S=d("../../plots/array_container_defaults"),M=d("./attributes"),e=d("./helpers");ee.exports=function(r,t){S(r,t,{name:"shapes",handleItemDefaults:a})};function a(n,r,t){function c(G,K){return A.coerce(n,r,M,G,K)}var s=c("visible");if(!!s){var i=c("path"),x=i?"path":"rect",p=c("type",x),v=p!=="path";v&&delete r.path,c("editable"),c("layer"),c("opacity"),c("fillcolor"),c("fillrule");var f=c("line.width");f&&(c("line.color"),c("line.dash"));for(var y=c("xsizemode"),o=c("ysizemode"),m=["x","y"],l=0;l<2;l++){var w=m[l],_=w+"anchor",h=w==="x"?y:o,b={_fullLayout:t},u,L,T,k=g.coerceRef(n,r,b,w,void 0,"paper"),P=g.getRefType(k);if(P==="range"?(u=g.getFromId(b,k),u._shapeIndices.push(r._index),T=e.rangeToShapePosition(u),L=e.shapePositionToRange(u)):L=T=A.identity,v){var z=.25,I=.75,D=w+"0",R=w+"1",O=n[D],F=n[R];n[D]=L(n[D],!0),n[R]=L(n[R],!0),h==="pixel"?(c(D,0),c(R,10)):(g.coercePosition(r,b,c,k,D,z),g.coercePosition(r,b,c,k,R,I)),r[D]=T(r[D]),r[R]=T(r[R]),n[D]=O,n[R]=F}if(h==="pixel"){var N=n[_];n[_]=L(n[_],!0),g.coercePosition(r,b,c,k,_,.25),r[_]=T(r[_]),n[_]=N}}v&&A.noneOrAll(n,r,["x0","x1","y0","y1"])}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":457,"./helpers":469}],461:[function(d,ee,te){var A=d("../../lib"),g=A.strTranslate,S=d("../dragelement"),M=d("../dragelement/helpers"),e=M.drawMode,a=M.selectMode,n=d("../../registry"),r=d("../color"),t=d("./draw_newshape/constants"),c=t.i000,s=t.i090,i=t.i180,x=t.i270,p=d("./handle_outline"),v=p.clearOutlineControllers,f=d("./draw_newshape/helpers"),y=f.pointsOnRectangle,o=f.pointsOnEllipse,m=f.writePaths,l=d("./draw_newshape/newshapes"),w=d("../selections/draw_newselection/newselections");ee.exports=function u(L,T,k,P){P||(P=0);var z=k.gd;function I(){u(L,T,k,P++),o(L[0])&&D({redrawing:!0})}function D(ce){var de={};k.isActiveShape!==void 0&&(k.isActiveShape=!1,de=l(T,k)),k.isActiveSelection!==void 0&&(k.isActiveSelection=!1,de=w(T,k),z._fullLayout._reselect=!0),Object.keys(de).length&&n.call((ce||{}).redrawing?"relayout":"_guiRelayout",z,de)}var R=z._fullLayout,O=R._zoomlayer,F=k.dragmode,N=e(F),G=a(F);(N||G)&&(z._fullLayout._outlining=!0),v(z),T.attr("d",m(L));var K,W,Y,re,ue;if(!P&&(k.isActiveShape||k.isActiveSelection)){ue=_([],L);var j=O.append("g").attr("class","outline-controllers");X(j),be()}function q(ce){Y=+ce.srcElement.getAttribute("data-i"),re=+ce.srcElement.getAttribute("data-j"),K[Y][re].moveFn=V}function V(ce,de){if(!!L.length){var ye=ue[Y][re][1],ge=ue[Y][re][2],me=L[Y],Ee=me.length;if(y(me)){var Pe=ce,Ne=de;if(k.isActiveSelection){var we=h(me,re);we[1]===me[re][1]?Ne=0:Pe=0}for(var ke=0;ke<Ee;ke++)if(ke!==re){var Xe=me[ke];Xe[1]===me[re][1]&&(Xe[1]=ye+Pe),Xe[2]===me[re][2]&&(Xe[2]=ge+Ne)}if(me[re][1]=ye+Pe,me[re][2]=ge+Ne,!y(me))for(var He=0;He<Ee;He++)for(var Ie=0;Ie<me[He].length;Ie++)me[He][Ie]=ue[Y][He][Ie]}else me[re][1]=ye+ce,me[re][2]=ge+de;I()}}function U(){D()}function $(){if(!!L.length&&!!L[Y]&&!!L[Y].length){for(var ce=[],de=0;de<L[Y].length;de++)de!==re&&ce.push(L[Y][de]);ce.length>1&&!(ce.length===2&&ce[1][0]==="Z")&&(re===0&&(ce[0][0]="M"),L[Y]=ce,I(),D())}}function ne(ce,de){if(ce===2){Y=+de.srcElement.getAttribute("data-i"),re=+de.srcElement.getAttribute("data-j");var ye=L[Y];!y(ye)&&!o(ye)&&$()}}function X(ce){K=[];for(var de=0;de<L.length;de++){var ye=L[de],ge=y(ye),me=!ge&&o(ye);K[de]=[];for(var Ee=ye.length,Pe=0;Pe<Ee;Pe++)if(ye[Pe][0]!=="Z"&&!(me&&Pe!==c&&Pe!==s&&Pe!==i&&Pe!==x)){var Ne=ge&&k.isActiveSelection,we;Ne&&(we=h(ye,Pe));var ke=ye[Pe][1],Xe=ye[Pe][2],He=ce.append(Ne?"rect":"circle").attr("data-i",de).attr("data-j",Pe).style({fill:r.background,stroke:r.defaultLine,"stroke-width":1,"shape-rendering":"crispEdges"});if(Ne){var Ie=we[1]-ke,De=we[2]-Xe,Ge=De?5:Math.max(Math.min(25,Math.abs(Ie)-5),5),ht=Ie?5:Math.max(Math.min(25,Math.abs(De)-5),5);He.classed(De?"cursor-ew-resize":"cursor-ns-resize",!0).attr("width",Ge).attr("height",ht).attr("x",ke-Ge/2).attr("y",Xe-ht/2).attr("transform",g(Ie/2,De/2))}else He.classed("cursor-grab",!0).attr("r",5).attr("cx",ke).attr("cy",Xe);K[de][Pe]={element:He.node(),gd:z,prepFn:q,doneFn:U,clickFn:ne},S.init(K[de][Pe])}}}function Q(ce,de){if(!!L.length)for(var ye=0;ye<L.length;ye++)for(var ge=0;ge<L[ye].length;ge++)for(var me=0;me+2<L[ye][ge].length;me+=2)L[ye][ge][me+1]=ue[ye][ge][me+1]+ce,L[ye][ge][me+2]=ue[ye][ge][me+2]+de}function ie(ce,de){Q(ce,de),I()}function se(ce){Y=+ce.srcElement.getAttribute("data-i"),Y||(Y=0),W[Y].moveFn=ie}function ae(){D()}function oe(ce){ce===2&&b(z)}function be(){if(W=[],!!L.length){var ce=0;W[ce]={element:T[0][0],gd:z,prepFn:se,doneFn:ae,clickFn:oe},S.init(W[ce])}}};function _(u,L){for(var T=0;T<L.length;T++){var k=L[T];u[T]=[];for(var P=0;P<k.length;P++){u[T][P]=[];for(var z=0;z<k[P].length;z++)u[T][P][z]=k[P][z]}}return u}function h(u,L){var T=u[L][1],k=u[L][2],P=u.length,z,I,D;return z=(L+1)%P,I=u[z][1],D=u[z][2],I===T&&D===k&&(z=(L+2)%P,I=u[z][1],D=u[z][2]),[z,I,D]}function b(u){if(!!a(u._fullLayout.dragmode)){v(u);var L=u._fullLayout._activeSelectionIndex,T=(u.layout||{}).selections||[];if(L<T.length){for(var k=[],P=0;P<T.length;P++)P!==L&&k.push(T[P]);delete u._fullLayout._activeSelectionIndex;var z=u._fullLayout.selections[L];u._fullLayout._deselect={xref:z.xref,yref:z.yref},n.call("_guiRelayout",u,{selections:k})}}}},{"../../lib":515,"../../registry":647,"../color":367,"../dragelement":386,"../dragelement/helpers":385,"../selections/draw_newselection/newselections":453,"./draw_newshape/constants":464,"./draw_newshape/helpers":466,"./draw_newshape/newshapes":467,"./handle_outline":468}],462:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib"),S=d("../../plots/cartesian/axes"),M=d("./draw_newshape/helpers").readPaths,e=d("./display_outlines"),a=d("./handle_outline").clearOutlineControllers,n=d("../color"),r=d("../drawing"),t=d("../../plot_api/plot_template").arrayEditor,c=d("../dragelement"),s=d("../../lib/setcursor"),i=d("./constants"),x=d("./helpers"),p=x.getPathString;ee.exports={draw:v,drawOne:o,eraseActiveShape:b};function v(u){var L=u._fullLayout;L._shapeUpperLayer.selectAll("path").remove(),L._shapeLowerLayer.selectAll("path").remove();for(var T in L._plots){var k=L._plots[T].shapelayer;k&&k.selectAll("path").remove()}for(var P=0;P<L.shapes.length;P++)L.shapes[P].visible&&o(u,P)}function f(u){return!!u._fullLayout._outlining}function y(u){return!u._context.edits.shapePosition}function o(u,L){u._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+L+'"]').remove();var T=x.makeShapesOptionsAndPlotinfo(u,L),k=T.options,P=T.plotinfo;if(!k._input||k.visible===!1)return;if(k.layer!=="below")I(u._fullLayout._shapeUpperLayer);else if(k.xref==="paper"||k.yref==="paper")I(u._fullLayout._shapeLowerLayer);else if(P._hadPlotinfo){var z=P.mainplotinfo||P;I(z.shapelayer)}else I(u._fullLayout._shapeLowerLayer);function I(D){var R=p(u,k),O={"data-index":L,"fill-rule":k.fillrule,d:R},F=k.opacity,N=k.fillcolor,G=k.line.width?k.line.color:"rgba(0,0,0,0)",K=k.line.width,W=k.line.dash;!K&&k.editable===!0&&(K=5,W="solid");var Y=R[R.length-1]!=="Z",re=y(u)&&k.editable&&u._fullLayout._activeShapeIndex===L;re&&(N=Y?"rgba(0,0,0,0)":u._fullLayout.activeshape.fillcolor,F=u._fullLayout.activeshape.opacity);var ue=D.append("path").attr(O).style("opacity",F).call(n.stroke,G).call(n.fill,N).call(r.dashLine,W,K);m(ue,u,k);var j;if((re||u._context.edits.shapePosition)&&(j=t(u.layout,"shapes",k)),re){ue.style({cursor:"move"});var q={element:ue.node(),plotinfo:P,gd:u,editHelpers:j,isActiveShape:!0},V=M(R,u);e(V,ue,q)}else u._context.edits.shapePosition?l(u,ue,k,L,D,j):k.editable===!0&&ue.style("pointer-events",Y||n.opacity(N)*F<=.5?"stroke":"all");ue.node().addEventListener("click",function(){return _(u,ue)})}}function m(u,L,T){var k=(T.xref+T.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");r.setClipUrl(u,k?"clip"+L._fullLayout._uid+k:null,L)}function l(u,L,T,k,P,z){var I=10,D=10,R=T.xsizemode==="pixel",O=T.ysizemode==="pixel",F=T.type==="line",N=T.type==="path",G=z.modifyItem,K,W,Y,re,ue,j,q,V,U,$,ne,X,Q,ie,se,ae=S.getFromId(u,T.xref),oe=S.getRefType(T.xref),be=S.getFromId(u,T.yref),ce=S.getRefType(T.yref),de=x.getDataToPixel(u,ae,!1,oe),ye=x.getDataToPixel(u,be,!0,ce),ge=x.getPixelToData(u,ae,!1,oe),me=x.getPixelToData(u,be,!0,ce),Ee=we(),Pe={element:Ee.node(),gd:u,prepFn:He,doneFn:Ie,clickFn:De},Ne;c.init(Pe),Ee.node().onmousemove=Xe;function we(){return F?ke():L}function ke(){var Mt=10,Yt=Math.max(T.line.width,Mt),zt=P.append("g").attr("data-index",k);zt.append("path").attr("d",L.attr("d")).style({cursor:"move","stroke-width":Yt,"stroke-opacity":"0"});var St={"fill-opacity":"0"},Ye=Math.max(Yt/2,Mt);return zt.append("circle").attr({"data-line-point":"start-point",cx:R?de(T.xanchor)+T.x0:de(T.x0),cy:O?ye(T.yanchor)-T.y0:ye(T.y0),r:Ye}).style(St).classed("cursor-grab",!0),zt.append("circle").attr({"data-line-point":"end-point",cx:R?de(T.xanchor)+T.x1:de(T.x1),cy:O?ye(T.yanchor)-T.y1:ye(T.y1),r:Ye}).style(St).classed("cursor-grab",!0),zt}function Xe(Mt){if(f(u)){Ne=null;return}if(F)Mt.target.tagName==="path"?Ne="move":Ne=Mt.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var Yt=Pe.element.getBoundingClientRect(),zt=Yt.right-Yt.left,St=Yt.bottom-Yt.top,Ye=Mt.clientX-Yt.left,rt=Mt.clientY-Yt.top,Ve=!N&&zt>I&&St>D&&!Mt.shiftKey?c.getCursor(Ye/zt,1-rt/St):"move";s(L,Ve),Ne=Ve.split("-")[0]}}function He(Mt){f(u)||(R&&(ue=de(T.xanchor)),O&&(j=ye(T.yanchor)),T.type==="path"?se=T.path:(K=R?T.x0:de(T.x0),W=O?T.y0:ye(T.y0),Y=R?T.x1:de(T.x1),re=O?T.y1:ye(T.y1)),K<Y?(U=K,Q="x0",$=Y,ie="x1"):(U=Y,Q="x1",$=K,ie="x0"),!O&&W<re||O&&W>re?(q=W,ne="y0",V=re,X="y1"):(q=re,ne="y1",V=W,X="y0"),Xe(Mt),Rt(P,T),It(L,T,u),Pe.moveFn=Ne==="move"?Ge:ht,Pe.altKey=Mt.altKey)}function Ie(){f(u)||(s(L),Kt(P),m(L,u,T),A.call("_guiRelayout",u,z.getUpdateObj()))}function De(){f(u)||Kt(P)}function Ge(Mt,Yt){if(T.type==="path"){var zt=function(rt){return rt},St=zt,Ye=zt;R?G("xanchor",T.xanchor=ge(ue+Mt)):(St=function(Ve){return ge(de(Ve)+Mt)},ae&&ae.type==="date"&&(St=x.encodeDate(St))),O?G("yanchor",T.yanchor=me(j+Yt)):(Ye=function(Ve){return me(ye(Ve)+Yt)},be&&be.type==="date"&&(Ye=x.encodeDate(Ye))),G("path",T.path=w(se,St,Ye))}else R?G("xanchor",T.xanchor=ge(ue+Mt)):(G("x0",T.x0=ge(K+Mt)),G("x1",T.x1=ge(Y+Mt))),O?G("yanchor",T.yanchor=me(j+Yt)):(G("y0",T.y0=me(W+Yt)),G("y1",T.y1=me(re+Yt)));L.attr("d",p(u,T)),Rt(P,T)}function ht(Mt,Yt){if(N){var zt=function(Ht){return Ht},St=zt,Ye=zt;R?G("xanchor",T.xanchor=ge(ue+Mt)):(St=function(ar){return ge(de(ar)+Mt)},ae&&ae.type==="date"&&(St=x.encodeDate(St))),O?G("yanchor",T.yanchor=me(j+Yt)):(Ye=function(ar){return me(ye(ar)+Yt)},be&&be.type==="date"&&(Ye=x.encodeDate(Ye))),G("path",T.path=w(se,St,Ye))}else if(F){if(Ne==="resize-over-start-point"){var rt=K+Mt,Ve=O?W-Yt:W+Yt;G("x0",T.x0=R?rt:ge(rt)),G("y0",T.y0=O?Ve:me(Ve))}else if(Ne==="resize-over-end-point"){var Ae=Y+Mt,Ue=O?re-Yt:re+Yt;G("x1",T.x1=R?Ae:ge(Ae)),G("y1",T.y1=O?Ue:me(Ue))}}else{var Ze=function(Ht){return Ne.indexOf(Ht)!==-1},Qe=Ze("n"),_t=Ze("s"),gt=Ze("w"),wt=Ze("e"),Ut=Qe?q+Yt:q,Dt=_t?V+Yt:V,Nt=gt?U+Mt:U,Xt=wt?$+Mt:$;O&&(Qe&&(Ut=q-Yt),_t&&(Dt=V-Yt)),(!O&&Dt-Ut>D||O&&Ut-Dt>D)&&(G(ne,T[ne]=O?Ut:me(Ut)),G(X,T[X]=O?Dt:me(Dt))),Xt-Nt>I&&(G(Q,T[Q]=R?Nt:ge(Nt)),G(ie,T[ie]=R?Xt:ge(Xt)))}L.attr("d",p(u,T)),Rt(P,T)}function Rt(Mt,Yt){(R||O)&&zt();function zt(){var St=Yt.type!=="path",Ye=Mt.selectAll(".visual-cue").data([0]),rt=1;Ye.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":rt}).classed("visual-cue",!0);var Ve=de(R?Yt.xanchor:g.midRange(St?[Yt.x0,Yt.x1]:x.extractPathCoords(Yt.path,i.paramIsX))),Ae=ye(O?Yt.yanchor:g.midRange(St?[Yt.y0,Yt.y1]:x.extractPathCoords(Yt.path,i.paramIsY)));if(Ve=x.roundPositionForSharpStrokeRendering(Ve,rt),Ae=x.roundPositionForSharpStrokeRendering(Ae,rt),R&&O){var Ue="M"+(Ve-1-rt)+","+(Ae-1-rt)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";Ye.attr("d",Ue)}else if(R){var Ze="M"+(Ve-1-rt)+","+(Ae-9-rt)+"v18 h2 v-18 Z";Ye.attr("d",Ze)}else{var Qe="M"+(Ve-9-rt)+","+(Ae-1-rt)+"h18 v2 h-18 Z";Ye.attr("d",Qe)}}}function Kt(Mt){Mt.selectAll(".visual-cue").remove()}function It(Mt,Yt,zt){var St=Yt.xref,Ye=Yt.yref,rt=S.getFromId(zt,St),Ve=S.getFromId(zt,Ye),Ae="";St!=="paper"&&!rt.autorange&&(Ae+=St),Ye!=="paper"&&!Ve.autorange&&(Ae+=Ye),r.setClipUrl(Mt,Ae?"clip"+zt._fullLayout._uid+Ae:null,zt)}}function w(u,L,T){return u.replace(i.segmentRE,function(k){var P=0,z=k.charAt(0),I=i.paramIsX[z],D=i.paramIsY[z],R=i.numParams[z],O=k.substr(1).replace(i.paramRE,function(F){return P>=R||(I[P]?F=L(F):D[P]&&(F=T(F)),P++),F});return z+O})}function _(u,L){if(!!y(u)){var T=L.node(),k=+T.getAttribute("data-index");if(k>=0){if(k===u._fullLayout._activeShapeIndex){h(u);return}u._fullLayout._activeShapeIndex=k,u._fullLayout._deactivateShape=h,v(u)}}}function h(u){if(!!y(u)){var L=u._fullLayout._activeShapeIndex;L>=0&&(a(u),delete u._fullLayout._activeShapeIndex,v(u))}}function b(u){if(!!y(u)){a(u);var L=u._fullLayout._activeShapeIndex,T=(u.layout||{}).shapes||[];if(L<T.length){for(var k=[],P=0;P<T.length;P++)P!==L&&k.push(T[P]);delete u._fullLayout._activeShapeIndex,A.call("_guiRelayout",u,{shapes:k})}}}},{"../../lib":515,"../../lib/setcursor":536,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":459,"./display_outlines":461,"./draw_newshape/helpers":466,"./handle_outline":468,"./helpers":469}],463:[function(d,ee,te){var A=d("../../drawing/attributes").dash,g=d("../../../lib/extend").extendFlat;ee.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:g({},A,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],464:[function(d,ee,te){var A=32;ee.exports={CIRCLE_SIDES:A,i000:0,i090:A/4,i180:A/2,i270:A/4*3,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],465:[function(d,ee,te){var A=d("../../color");ee.exports=function(S,M,e){e("newshape.drawdirection"),e("newshape.layer"),e("newshape.fillcolor"),e("newshape.fillrule"),e("newshape.opacity");var a=e("newshape.line.width");if(a){var n=(S||{}).plot_bgcolor||"#FFF";e("newshape.line.color",A.contrast(n)),e("newshape.line.dash")}e("activeshape.fillcolor"),e("activeshape.opacity")}},{"../../color":367}],466:[function(d,ee,te){var A=d("parse-svg-path"),g=d("./constants"),S=g.CIRCLE_SIDES,M=g.SQRT2,e=d("../../selections/helpers"),a=e.p2r,n=e.r2p,r=[0,3,4,5,6,1,2],t=[0,3,4,1,2];te.writePaths=function(i){var x=i.length;if(!x)return"M0,0Z";for(var p="",v=0;v<x;v++)for(var f=i[v].length,y=0;y<f;y++){var o=i[v][y][0];if(o==="Z")p+="Z";else for(var m=i[v][y].length,l=0;l<m;l++){var w=l;o==="Q"||o==="S"?w=t[l]:o==="C"&&(w=r[l]),p+=i[v][y][w],l>0&&l<m-1&&(p+=",")}}return p},te.readPaths=function(i,x,p,v){var f=A(i),y=[],o=-1,m=function(){o++,y[o]=[]},l,w=0,_=0,h,b,u=function(){h=w,b=_};u();for(var L=0;L<f.length;L++){var T=[],k,P,z,I,D=f[L][0],R=D;switch(D){case"M":m(),w=+f[L][1],_=+f[L][2],T.push([R,w,_]),u();break;case"Q":case"S":k=+f[L][1],z=+f[L][2],w=+f[L][3],_=+f[L][4],T.push([R,w,_,k,z]);break;case"C":k=+f[L][1],z=+f[L][2],P=+f[L][3],I=+f[L][4],w=+f[L][5],_=+f[L][6],T.push([R,w,_,k,z,P,I]);break;case"T":case"L":w=+f[L][1],_=+f[L][2],T.push([R,w,_]);break;case"H":R="L",w=+f[L][1],T.push([R,w,_]);break;case"V":R="L",_=+f[L][1],T.push([R,w,_]);break;case"A":R="L";var O=+f[L][1],F=+f[L][2];+f[L][4]||(O=-O,F=-F);var N=w-O,G=_;for(l=1;l<=S/2;l++){var K=2*Math.PI*l/S;T.push([R,N+O*Math.cos(K),G+F*Math.sin(K)])}break;case"Z":(w!==h||_!==b)&&(w=h,_=b,T.push([R,w,_]));break}for(var W=(p||{}).domain,Y=x._fullLayout._size,re=p&&p.xsizemode==="pixel",ue=p&&p.ysizemode==="pixel",j=v===!1,q=0;q<T.length;q++){for(l=0;l+2<7;l+=2){var V=T[q][l+1],U=T[q][l+2];V===void 0||U===void 0||(w=V,_=U,p&&(p.xaxis&&p.xaxis.p2r?(j&&(V-=p.xaxis._offset),re?V=n(p.xaxis,p.xanchor)+V:V=a(p.xaxis,V)):(j&&(V-=Y.l),W?V=W.x[0]+V/Y.w:V=V/Y.w),p.yaxis&&p.yaxis.p2r?(j&&(U-=p.yaxis._offset),ue?U=n(p.yaxis,p.yanchor)-U:U=a(p.yaxis,U)):(j&&(U-=Y.t),W?U=W.y[1]-U/Y.h:U=1-U/Y.h)),T[q][l+1]=V,T[q][l+2]=U)}y[o].push(T[q].slice())}}return y};function c(i,x){return Math.abs(i-x)<=1e-6}function s(i,x){var p=x[1]-i[1],v=x[2]-i[2];return Math.sqrt(p*p+v*v)}te.pointsOnRectangle=function(i){var x=i.length;if(x!==5)return!1;for(var p=1;p<3;p++){var v=i[0][p]-i[1][p],f=i[3][p]-i[2][p];if(!c(v,f))return!1;var y=i[0][p]-i[3][p],o=i[1][p]-i[2][p];if(!c(y,o))return!1}return!c(i[0][1],i[1][1])&&!c(i[0][1],i[3][1])?!1:!!(s(i[0],i[1])*s(i[0],i[3]))},te.pointsOnEllipse=function(i){var x=i.length;if(x!==S+1)return!1;x=S;for(var p=0;p<x;p++){var v=(x*2-p)%x,f=(x/2+v)%x,y=(x/2+p)%x;if(!c(s(i[p],i[y]),s(i[v],i[f])))return!1}return!0},te.handleEllipse=function(i,x,p){if(!i)return[x,p];var v=te.ellipseOver({x0:x[0],y0:x[1],x1:p[0],y1:p[1]}),f=(v.x1+v.x0)/2,y=(v.y1+v.y0)/2,o=(v.x1-v.x0)/2,m=(v.y1-v.y0)/2;o||(o=m=m/M),m||(m=o=o/M);for(var l=[],w=0;w<S;w++){var _=w*2*Math.PI/S;l.push([f+o*Math.cos(_),y+m*Math.sin(_)])}return l},te.ellipseOver=function(i){var x=i.x0,p=i.y0,v=i.x1,f=i.y1,y=v-x,o=f-p;x-=y,p-=o;var m=(x+v)/2,l=(p+f)/2,w=M;return y*=w,o*=w,{x0:m-y,y0:l-o,x1:m+y,y1:l+o}},te.fixDatesForPaths=function(i,x,p){var v=x.type==="date",f=p.type==="date";if(!v&&!f)return i;for(var y=0;y<i.length;y++)for(var o=0;o<i[y].length;o++)for(var m=0;m+2<i[y][o].length;m+=2)v&&(i[y][o][m+1]=i[y][o][m+1].replace(" ","_")),f&&(i[y][o][m+2]=i[y][o][m+2].replace(" ","_"));return i}},{"../../selections/helpers":454,"./constants":464,"parse-svg-path":250}],467:[function(d,ee,te){var A=d("../../dragelement/helpers"),g=A.drawMode,S=A.openMode,M=d("./constants"),e=M.i000,a=M.i090,n=M.i180,r=M.i270,t=M.cos45,c=M.sin45,s=d("../../selections/helpers"),i=s.p2r,x=s.r2p,p=d(".././handle_outline"),v=p.clearOutline,f=d("./helpers"),y=f.readPaths,o=f.writePaths,m=f.ellipseOver,l=f.fixDatesForPaths;ee.exports=function(_,h){if(!!_.length){var b=_[0][0];if(!!b){var u=b.getAttribute("d"),L=h.gd,T=L._fullLayout.newshape,k=h.plotinfo,P=k.xaxis,z=k.yaxis,I=!!k.domain||!k.xaxis,D=!!k.domain||!k.yaxis,R=h.isActiveShape,O=h.dragmode,F=(L.layout||{}).shapes||[];if(!g(O)&&R!==void 0){var N=L._fullLayout._activeShapeIndex;if(N<F.length)switch(L._fullLayout.shapes[N].type){case"rect":O="drawrect";break;case"circle":O="drawcircle";break;case"line":O="drawline";break;case"path":var G=F[N].path||"";G[G.length-1]==="Z"?O="drawclosedpath":O="drawopenpath";break}}var K=S(O),W=y(u,L,k,R),Y={editable:!0,xref:I?"paper":P._id,yref:D?"paper":z._id,layer:T.layer,opacity:T.opacity,line:{color:T.line.color,width:T.line.width,dash:T.line.dash}};K||(Y.fillcolor=T.fillcolor,Y.fillrule=T.fillrule);var re;if(W.length===1&&(re=W[0]),re&&re.length===5&&O==="drawrect")Y.type="rect",Y.x0=re[0][1],Y.y0=re[0][2],Y.x1=re[2][1],Y.y1=re[2][2];else if(re&&O==="drawline")Y.type="line",Y.x0=re[0][1],Y.y0=re[0][2],Y.x1=re[1][1],Y.y1=re[1][2];else if(re&&O==="drawcircle"){Y.type="circle";var ue=re[e][1],j=re[a][1],q=re[n][1],V=re[r][1],U=re[e][2],$=re[a][2],ne=re[n][2],X=re[r][2],Q=k.xaxis&&(k.xaxis.type==="date"||k.xaxis.type==="log"),ie=k.yaxis&&(k.yaxis.type==="date"||k.yaxis.type==="log");Q&&(ue=x(k.xaxis,ue),j=x(k.xaxis,j),q=x(k.xaxis,q),V=x(k.xaxis,V)),ie&&(U=x(k.yaxis,U),$=x(k.yaxis,$),ne=x(k.yaxis,ne),X=x(k.yaxis,X));var se=(j+V)/2,ae=(U+ne)/2,oe=(V-j+q-ue)/2,be=(X-$+ne-U)/2,ce=m({x0:se,y0:ae,x1:se+oe*t,y1:ae+be*c});Q&&(ce.x0=i(k.xaxis,ce.x0),ce.x1=i(k.xaxis,ce.x1)),ie&&(ce.y0=i(k.yaxis,ce.y0),ce.y1=i(k.yaxis,ce.y1)),Y.x0=ce.x0,Y.y0=ce.y0,Y.x1=ce.x1,Y.y1=ce.y1}else Y.type="path",P&&z&&l(W,P,z),Y.path=o(W),re=null;v(L);for(var de=h.editHelpers,ye=(de||{}).modifyItem,ge=[],me=0;me<F.length;me++){var Ee=L._fullLayout.shapes[me];if(ge[me]=Ee._input,R!==void 0&&me===L._fullLayout._activeShapeIndex){var Pe=Y;switch(Ee.type){case"line":case"rect":case"circle":ye("x0",Pe.x0),ye("x1",Pe.x1),ye("y0",Pe.y0),ye("y1",Pe.y1);break;case"path":ye("path",Pe.path);break}}}return R===void 0?(ge.push(Y),ge):de?de.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../selections/helpers":454,".././handle_outline":468,"./constants":464,"./helpers":466}],468:[function(d,ee,te){function A(S){var M=S._fullLayout._zoomlayer;M&&M.selectAll(".outline-controllers").remove()}function g(S){var M=S._fullLayout._zoomlayer;M&&M.selectAll(".select-outline").remove(),S._fullLayout._outlining=!1}ee.exports={clearOutlineControllers:A,clearOutline:g}},{}],469:[function(d,ee,te){var A=d("./constants"),g=d("../../lib"),S=d("../../plots/cartesian/axes");te.rangeToShapePosition=function(e){return e.type==="log"?e.r2d:function(a){return a}},te.shapePositionToRange=function(e){return e.type==="log"?e.d2r:function(a){return a}},te.decodeDate=function(e){return function(a){return a.replace&&(a=a.replace("_"," ")),e(a)}},te.encodeDate=function(e){return function(a){return e(a).replace(" ","_")}},te.extractPathCoords=function(e,a,n){var r=[],t=e.match(A.segmentRE);return t.forEach(function(c){var s=a[c.charAt(0)].drawn;if(s!==void 0){var i=c.substr(1).match(A.paramRE);if(!(!i||i.length<s)){var x=i[s],p=n?x:g.cleanNumber(x);r.push(p)}}}),r},te.getDataToPixel=function(e,a,n,r){var t=e._fullLayout._size,c;if(a)if(r==="domain")c=function(i){return a._length*(n?1-i:i)+a._offset};else{var s=te.shapePositionToRange(a);c=function(i){return a._offset+a.r2p(s(i,!0))},a.type==="date"&&(c=te.decodeDate(c))}else n?c=function(i){return t.t+t.h*(1-i)}:c=function(i){return t.l+t.w*i};return c},te.getPixelToData=function(e,a,n,r){var t=e._fullLayout._size,c;if(a)if(r==="domain")c=function(i){var x=(i-a._offset)/a._length;return n?1-x:x};else{var s=te.rangeToShapePosition(a);c=function(i){return s(a.p2r(i-a._offset))}}else n?c=function(i){return 1-(i-t.t)/t.h}:c=function(i){return(i-t.l)/t.w};return c},te.roundPositionForSharpStrokeRendering=function(e,a){var n=Math.round(a%2)===1,r=Math.round(e);return n?r+.5:r},te.makeShapesOptionsAndPlotinfo=function(e,a){var n=e._fullLayout.shapes[a]||{},r=e._fullLayout._plots[n.xref+n.yref],t=!!r;return t?r._hadPlotinfo=!0:(r={},n.xref&&n.xref!=="paper"&&(r.xaxis=e._fullLayout[n.xref+"axis"]),n.yref&&n.yref!=="paper"&&(r.yaxis=e._fullLayout[n.yref+"axis"])),r.xsizemode=n.xsizemode,r.ysizemode=n.ysizemode,r.xanchor=n.xanchor,r.yanchor=n.yanchor,{options:n,plotinfo:r}},te.makeSelectionsOptionsAndPlotinfo=function(e,a){var n=e._fullLayout.selections[a]||{},r=e._fullLayout._plots[n.xref+n.yref],t=!!r;return t?r._hadPlotinfo=!0:(r={},n.xref&&(r.xaxis=e._fullLayout[n.xref+"axis"]),n.yref&&(r.yaxis=e._fullLayout[n.yref+"axis"])),{options:n,plotinfo:r}},te.getPathString=function(e,a){var n=a.type,r=S.getRefType(a.xref),t=S.getRefType(a.yref),c=S.getFromId(e,a.xref),s=S.getFromId(e,a.yref),i=e._fullLayout._size,x,p,v,f,y,o,m,l;if(c?r==="domain"?p=function(z){return c._offset+c._length*z}:(x=te.shapePositionToRange(c),p=function(z){return c._offset+c.r2p(x(z,!0))}):p=function(z){return i.l+i.w*z},s?t==="domain"?f=function(z){return s._offset+s._length*(1-z)}:(v=te.shapePositionToRange(s),f=function(z){return s._offset+s.r2p(v(z,!0))}):f=function(z){return i.t+i.h*(1-z)},n==="path")return c&&c.type==="date"&&(p=te.decodeDate(p)),s&&s.type==="date"&&(f=te.decodeDate(f)),M(a,p,f);if(a.xsizemode==="pixel"){var w=p(a.xanchor);y=w+a.x0,o=w+a.x1}else y=p(a.x0),o=p(a.x1);if(a.ysizemode==="pixel"){var _=f(a.yanchor);m=_-a.y0,l=_-a.y1}else m=f(a.y0),l=f(a.y1);if(n==="line")return"M"+y+","+m+"L"+o+","+l;if(n==="rect")return"M"+y+","+m+"H"+o+"V"+l+"H"+y+"Z";var h=(y+o)/2,b=(m+l)/2,u=Math.abs(h-y),L=Math.abs(b-m),T="A"+u+","+L,k=h+u+","+b,P=h+","+(b-L);return"M"+k+T+" 0 1,1 "+P+T+" 0 0,1 "+k+"Z"};function M(e,a,n){var r=e.path,t=e.xsizemode,c=e.ysizemode,s=e.xanchor,i=e.yanchor;return r.replace(A.segmentRE,function(x){var p=0,v=x.charAt(0),f=A.paramIsX[v],y=A.paramIsY[v],o=A.numParams[v],m=x.substr(1).replace(A.paramRE,function(l){return f[p]?t==="pixel"?l=a(s)+Number(l):l=a(l):y[p]&&(c==="pixel"?l=n(i)-Number(l):l=n(l)),p++,p>o&&(l="X"),l});return p>o&&(m=m.replace(/[\s,]*X.*/,""),g.log("Ignoring extra params in segment "+x)),v+m})}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459}],470:[function(d,ee,te){var A=d("./draw");ee.exports={moduleType:"component",name:"shapes",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),supplyDrawNewShapeDefaults:d("./draw_newshape/defaults"),includeBasePlot:d("../../plots/cartesian/include_components")("shapes"),calcAutorange:d("./calc_autorange"),draw:A.draw,drawOne:A.drawOne}},{"../../plots/cartesian/include_components":577,"./attributes":457,"./calc_autorange":458,"./defaults":460,"./draw":462,"./draw_newshape/defaults":465}],471:[function(d,ee,te){var A=d("../../plots/font_attributes"),g=d("../../plots/pad_attributes"),S=d("../../lib/extend").extendDeepAll,M=d("../../plot_api/edit_types").overrideAll,e=d("../../plots/animation_attributes"),a=d("../../plot_api/plot_template").templatedArray,n=d("./constants"),r=a("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});ee.exports=M(a("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:r,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:S(g({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:A({})},font:A({}),activebgcolor:{valType:"color",dflt:n.gripBgActiveColor},bgcolor:{valType:"color",dflt:n.railBgColor},bordercolor:{valType:"color",dflt:n.railBorderColor},borderwidth:{valType:"number",min:0,dflt:n.railBorderWidth},ticklen:{valType:"number",min:0,dflt:n.tickLength},tickcolor:{valType:"color",dflt:n.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:n.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/animation_attributes":560,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"./constants":472}],472:[function(d,ee,te){ee.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],473:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/array_container_defaults"),S=d("./attributes"),M=d("./constants"),e=M.name,a=S.steps;ee.exports=function(c,s){g(c,s,{name:e,handleItemDefaults:n})};function n(t,c,s){function i(l,w){return A.coerce(t,c,S,l,w)}for(var x=g(t,c,{name:"steps",handleItemDefaults:r}),p=0,v=0;v<x.length;v++)x[v].visible&&p++;var f;if(p<2?f=c.visible=!1:f=i("visible"),!!f){c._stepCount=p;var y=c._visibleSteps=A.filterVisible(x),o=i("active");(x[o]||{}).visible||(c.active=y[0]._index),i("x"),i("y"),A.noneOrAll(t,c,["x","y"]),i("xanchor"),i("yanchor"),i("len"),i("lenmode"),i("pad.t"),i("pad.r"),i("pad.b"),i("pad.l"),A.coerceFont(i,"font",s.font);var m=i("currentvalue.visible");m&&(i("currentvalue.xanchor"),i("currentvalue.prefix"),i("currentvalue.suffix"),i("currentvalue.offset"),A.coerceFont(i,"currentvalue.font",c.font)),i("transition.duration"),i("transition.easing"),i("bgcolor"),i("activebgcolor"),i("bordercolor"),i("borderwidth"),i("ticklen"),i("tickwidth"),i("tickcolor"),i("minorticklen")}}function r(t,c){function s(p,v){return A.coerce(t,c,a,p,v)}var i;if(t.method!=="skip"&&!Array.isArray(t.args)?i=c.visible=!1:i=s("visible"),i){s("method"),s("args");var x=s("label","step-"+c._index);s("value",x),s("execute")}}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":471,"./constants":472}],474:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../plots/plots"),S=d("../color"),M=d("../drawing"),e=d("../../lib"),a=e.strTranslate,n=d("../../lib/svg_text_utils"),r=d("../../plot_api/plot_template").arrayEditor,t=d("./constants"),c=d("../../constants/alignment"),s=c.LINE_SPACING,i=c.FROM_TL,x=c.FROM_BR;ee.exports=function(O){var F=O._fullLayout,N=v(F,O),G=F._infolayer.selectAll("g."+t.containerClassName).data(N.length>0?[0]:[]);G.enter().append("g").classed(t.containerClassName,!0).style("cursor","ew-resize");function K(ue){ue._commandObserver&&(ue._commandObserver.remove(),delete ue._commandObserver),g.autoMargin(O,p(ue))}if(G.exit().each(function(){A.select(this).selectAll("g."+t.groupClassName).each(K)}).remove(),N.length!==0){var W=G.selectAll("g."+t.groupClassName).data(N,f);W.enter().append("g").classed(t.groupClassName,!0),W.exit().each(K).remove();for(var Y=0;Y<N.length;Y++){var re=N[Y];y(O,re)}W.each(function(ue){var j=A.select(this);T(ue),g.manageCommandObserver(O,ue,ue._visibleSteps,function(q){var V=j.data()[0];V.active!==q.index&&(V._dragging||b(O,j,V,q.index,!1,!0))}),o(O,A.select(this),ue)})}};function p(R){return t.autoMarginIdRoot+R._index}function v(R,O){for(var F=R[t.name],N=[],G=0;G<F.length;G++){var K=F[G];!K.visible||(K._gd=O,N.push(K))}return N}function f(R){return R._index}function y(R,O){var F=M.tester.selectAll("g."+t.labelGroupClass).data(O._visibleSteps);F.enter().append("g").classed(t.labelGroupClass,!0);var N=0,G=0;F.each(function($){var ne=A.select(this),X=w(ne,{step:$},O),Q=X.node();if(Q){var ie=M.bBox(Q);G=Math.max(G,ie.height),N=Math.max(N,ie.width)}}),F.remove();var K=O._dims={};K.inputAreaWidth=Math.max(t.railWidth,t.gripHeight);var W=R._fullLayout._size;K.lx=W.l+W.w*O.x,K.ly=W.t+W.h*(1-O.y),O.lenmode==="fraction"?K.outerLength=Math.round(W.w*O.len):K.outerLength=O.len,K.inputAreaStart=0,K.inputAreaLength=Math.round(K.outerLength-O.pad.l-O.pad.r);var Y=K.inputAreaLength-2*t.stepInset,re=Y/(O._stepCount-1),ue=N+t.labelPadding;if(K.labelStride=Math.max(1,Math.ceil(ue/re)),K.labelHeight=G,K.currentValueMaxWidth=0,K.currentValueHeight=0,K.currentValueTotalHeight=0,K.currentValueMaxLines=1,O.currentvalue.visible){var j=M.tester.append("g");F.each(function($){var ne=m(j,O,$.label),X=ne.node()&&M.bBox(ne.node())||{width:0,height:0},Q=n.lineCount(ne);K.currentValueMaxWidth=Math.max(K.currentValueMaxWidth,Math.ceil(X.width)),K.currentValueHeight=Math.max(K.currentValueHeight,Math.ceil(X.height)),K.currentValueMaxLines=Math.max(K.currentValueMaxLines,Q)}),K.currentValueTotalHeight=K.currentValueHeight+O.currentvalue.offset,j.remove()}K.height=K.currentValueTotalHeight+t.tickOffset+O.ticklen+t.labelOffset+K.labelHeight+O.pad.t+O.pad.b;var q="left";e.isRightAnchor(O)&&(K.lx-=K.outerLength,q="right"),e.isCenterAnchor(O)&&(K.lx-=K.outerLength/2,q="center");var V="top";e.isBottomAnchor(O)&&(K.ly-=K.height,V="bottom"),e.isMiddleAnchor(O)&&(K.ly-=K.height/2,V="middle"),K.outerLength=Math.ceil(K.outerLength),K.height=Math.ceil(K.height),K.lx=Math.round(K.lx),K.ly=Math.round(K.ly);var U={y:O.y,b:K.height*x[V],t:K.height*i[V]};O.lenmode==="fraction"?(U.l=0,U.xl=O.x-O.len*i[q],U.r=0,U.xr=O.x+O.len*x[q]):(U.x=O.x,U.l=K.outerLength*i[q],U.r=K.outerLength*x[q]),g.autoMargin(R,p(O),U)}function o(R,O,F){(F.steps[F.active]||{}).visible||(F.active=F._visibleSteps[0]._index),O.call(m,F).call(D,F).call(_,F).call(L,F).call(I,R,F).call(l,R,F);var N=F._dims;M.setTranslate(O,N.lx+F.pad.l,N.ly+F.pad.t),O.call(k,F,!1),O.call(m,F)}function m(R,O,F){if(!!O.currentvalue.visible){var N=O._dims,G,K;switch(O.currentvalue.xanchor){case"right":G=N.inputAreaLength-t.currentValueInset-N.currentValueMaxWidth,K="left";break;case"center":G=N.inputAreaLength*.5,K="middle";break;default:G=t.currentValueInset,K="left"}var W=e.ensureSingle(R,"text",t.labelClass,function(V){V.attr({"text-anchor":K,"data-notex":1})}),Y=O.currentvalue.prefix?O.currentvalue.prefix:"";if(typeof F=="string")Y+=F;else{var re=O.steps[O.active].label,ue=O._gd._fullLayout._meta;ue&&(re=e.templateString(re,ue)),Y+=re}O.currentvalue.suffix&&(Y+=O.currentvalue.suffix),W.call(M.font,O.currentvalue.font).text(Y).call(n.convertToTspans,O._gd);var j=n.lineCount(W),q=(N.currentValueMaxLines+1-j)*O.currentvalue.font.size*s;return n.positionText(W,G,q),W}}function l(R,O,F){var N=e.ensureSingle(R,"rect",t.gripRectClass,function(G){G.call(u,O,R,F).style("pointer-events","all")});N.attr({width:t.gripWidth,height:t.gripHeight,rx:t.gripRadius,ry:t.gripRadius}).call(S.stroke,F.bordercolor).call(S.fill,F.bgcolor).style("stroke-width",F.borderwidth+"px")}function w(R,O,F){var N=e.ensureSingle(R,"text",t.labelClass,function(W){W.attr({"text-anchor":"middle","data-notex":1})}),G=O.step.label,K=F._gd._fullLayout._meta;return K&&(G=e.templateString(G,K)),N.call(M.font,F.font).text(G).call(n.convertToTspans,F._gd),N}function _(R,O){var F=e.ensureSingle(R,"g",t.labelsClass),N=O._dims,G=F.selectAll("g."+t.labelGroupClass).data(N.labelSteps);G.enter().append("g").classed(t.labelGroupClass,!0),G.exit().remove(),G.each(function(K){var W=A.select(this);W.call(w,K,O),M.setTranslate(W,P(O,K.fraction),t.tickOffset+O.ticklen+O.font.size*s+t.labelOffset+N.currentValueTotalHeight)})}function h(R,O,F,N,G){var K=Math.round(N*(F._stepCount-1)),W=F._visibleSteps[K]._index;W!==F.active&&b(R,O,F,W,!0,G)}function b(R,O,F,N,G,K){var W=F.active;F.active=N,r(R.layout,t.name,F).applyUpdate("active",N);var Y=F.steps[F.active];O.call(k,F,K),O.call(m,F),R.emit("plotly_sliderchange",{slider:F,step:F.steps[F.active],interaction:G,previousActive:W}),Y&&Y.method&&G&&(O._nextMethod?(O._nextMethod.step=Y,O._nextMethod.doCallback=G,O._nextMethod.doTransition=K):(O._nextMethod={step:Y,doCallback:G,doTransition:K},O._nextMethodRaf=window.requestAnimationFrame(function(){var re=O._nextMethod.step;!re.method||(re.execute&&g.executeAPICommand(R,re.method,re.args),O._nextMethod=null,O._nextMethodRaf=null)})))}function u(R,O,F){var N=F.node(),G=A.select(O);function K(){return F.data()[0]}function W(){var Y=K();O.emit("plotly_sliderstart",{slider:Y});var re=F.select("."+t.gripRectClass);A.event.stopPropagation(),A.event.preventDefault(),re.call(S.fill,Y.activebgcolor);var ue=z(Y,A.mouse(N)[0]);h(O,F,Y,ue,!0),Y._dragging=!0;function j(){var V=K(),U=z(V,A.mouse(N)[0]);h(O,F,V,U,!1)}G.on("mousemove",j),G.on("touchmove",j);function q(){var V=K();V._dragging=!1,re.call(S.fill,V.bgcolor),G.on("mouseup",null),G.on("mousemove",null),G.on("touchend",null),G.on("touchmove",null),O.emit("plotly_sliderend",{slider:V,step:V.steps[V.active]})}G.on("mouseup",q),G.on("touchend",q)}R.on("mousedown",W),R.on("touchstart",W)}function L(R,O){var F=R.selectAll("rect."+t.tickRectClass).data(O._visibleSteps),N=O._dims;F.enter().append("rect").classed(t.tickRectClass,!0),F.exit().remove(),F.attr({width:O.tickwidth+"px","shape-rendering":"crispEdges"}),F.each(function(G,K){var W=K%N.labelStride===0,Y=A.select(this);Y.attr({height:W?O.ticklen:O.minorticklen}).call(S.fill,O.tickcolor),M.setTranslate(Y,P(O,K/(O._stepCount-1))-.5*O.tickwidth,(W?t.tickOffset:t.minorTickOffset)+N.currentValueTotalHeight)})}function T(R){var O=R._dims;O.labelSteps=[];for(var F=R._stepCount,N=0;N<F;N+=O.labelStride)O.labelSteps.push({fraction:N/(F-1),step:R._visibleSteps[N]})}function k(R,O,F){for(var N=R.select("rect."+t.gripRectClass),G=0,K=0;K<O._stepCount;K++)if(O._visibleSteps[K]._index===O.active){G=K;break}var W=P(O,G/(O._stepCount-1));if(!O._invokingCommand){var Y=N;F&&O.transition.duration>0&&(Y=Y.transition().duration(O.transition.duration).ease(O.transition.easing)),Y.attr("transform",a(W-t.gripWidth*.5,O._dims.currentValueTotalHeight))}}function P(R,O){var F=R._dims;return F.inputAreaStart+t.stepInset+(F.inputAreaLength-2*t.stepInset)*Math.min(1,Math.max(0,O))}function z(R,O){var F=R._dims;return Math.min(1,Math.max(0,(O-t.stepInset-F.inputAreaStart)/(F.inputAreaLength-2*t.stepInset-2*F.inputAreaStart)))}function I(R,O,F){var N=F._dims,G=e.ensureSingle(R,"rect",t.railTouchRectClass,function(K){K.call(u,O,R,F).style("pointer-events","all")});G.attr({width:N.inputAreaLength,height:Math.max(N.inputAreaWidth,t.tickOffset+F.ticklen+N.labelHeight)}).call(S.fill,F.bgcolor).attr("opacity",0),M.setTranslate(G,0,N.currentValueTotalHeight)}function D(R,O){var F=O._dims,N=F.inputAreaLength-t.railInset*2,G=e.ensureSingle(R,"rect",t.railRectClass);G.attr({width:N,height:t.railWidth,rx:t.railRadius,ry:t.railRadius,"shape-rendering":"crispEdges"}).call(S.stroke,O.bordercolor).call(S.fill,O.bgcolor).style("stroke-width",O.borderwidth+"px"),M.setTranslate(G,t.railInset,(F.inputAreaWidth-t.railWidth)*.5+F.currentValueTotalHeight)}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":472,"@plotly/d3":58}],475:[function(d,ee,te){var A=d("./constants");ee.exports={moduleType:"component",name:A.name,layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),draw:d("./draw")}},{"./attributes":471,"./constants":472,"./defaults":473,"./draw":474}],476:[function(d,ee,te){var A=d("@plotly/d3"),g=d("fast-isnumeric"),S=d("../../plots/plots"),M=d("../../registry"),e=d("../../lib"),a=e.strTranslate,n=d("../drawing"),r=d("../color"),t=d("../../lib/svg_text_utils"),c=d("../../constants/interactions"),s=d("../../constants/alignment").OPPOSITE_SIDE,i=/ [XY][0-9]* /;function x(p,v,f){var y=f.propContainer,o=f.propName,m=f.placeholder,l=f.traceIndex,w=f.avoid||{},_=f.attributes,h=f.transform,b=f.containerGroup,u=p._fullLayout,L=1,T=!1,k=y.title,P=(k&&k.text?k.text:"").trim(),z=k&&k.font?k.font:{},I=z.family,D=z.size,R=z.color,O;o==="title.text"?O="titleText":o.indexOf("axis")!==-1?O="axisTitleText":o.indexOf("colorbar"!==-1)&&(O="colorbarTitleText");var F=p._context.edits[O];P===""?L=0:P.replace(i," % ")===m.replace(i," % ")&&(L=.2,T=!0,F||(P="")),f._meta?P=e.templateString(P,f._meta):u._meta&&(P=e.templateString(P,u._meta));var N=P||F,G;b||(b=e.ensureSingle(u._infolayer,"g","g-"+v),G=u._hColorbarMoveTitle);var K=b.selectAll("text").data(N?[0]:[]);if(K.enter().append("text"),K.text(P).attr("class",v),K.exit().remove(),!N)return b;function W(j){e.syncOrAsync([Y,re],j)}function Y(j){var q;return!h&&G&&(h={}),h?(q="",h.rotate&&(q+="rotate("+[h.rotate,_.x,_.y]+")"),(h.offset||G)&&(q+=a(0,(h.offset||0)-(G||0)))):q=null,j.attr("transform",q),j.style({"font-family":I,"font-size":A.round(D,2)+"px",fill:r.rgb(R),opacity:L*r.opacity(R),"font-weight":S.fontWeight}).attr(_).call(t.convertToTspans,p),S.previousPromises(p)}function re(j){var q=A.select(j.node().parentNode);if(w&&w.selection&&w.side&&P){q.attr("transform",null);var V=s[w.side],U=w.side==="left"||w.side==="top"?-1:1,$=g(w.pad)?w.pad:2,ne=n.bBox(q.node()),X={left:0,top:0,right:u.width,bottom:u.height},Q=w.maxShift||U*(X[w.side]-ne[w.side]),ie=0;if(Q<0)ie=Q;else{var se=w.offsetLeft||0,ae=w.offsetTop||0;ne.left-=se,ne.right-=se,ne.top-=ae,ne.bottom-=ae,w.selection.each(function(){var be=n.bBox(this);e.bBoxIntersect(ne,be,$)&&(ie=Math.max(ie,U*(be[w.side]-ne[V])+$))}),ie=Math.min(Q,ie)}if(ie>0||Q<0){var oe={left:[-ie,0],right:[ie,0],top:[0,-ie],bottom:[0,ie]}[w.side];q.attr("transform",a(oe[0],oe[1]))}}}K.call(W);function ue(){L=0,T=!0,K.text(m).on("mouseover.opacity",function(){A.select(this).transition().duration(c.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){A.select(this).transition().duration(c.HIDE_PLACEHOLDER).style("opacity",0)})}return F&&(P?K.on(".opacity",null):ue(),K.call(t.makeEditable,{gd:p}).on("edit",function(j){l!==void 0?M.call("_guiRestyle",p,o,j,l):M.call("_guiRelayout",p,o,j)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(W)}).on("input",function(j){this.text(j||" ").call(t.positionText,_.x,_.y)})),K.classed("js-placeholder",T),b}ee.exports={draw:x}},{"../../constants/alignment":483,"../../constants/interactions":490,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],477:[function(d,ee,te){var A=d("../../plots/font_attributes"),g=d("../color/attributes"),S=d("../../lib/extend").extendFlat,M=d("../../plot_api/edit_types").overrideAll,e=d("../../plots/pad_attributes"),a=d("../../plot_api/plot_template").templatedArray,n=a("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});ee.exports=M(a("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:n,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:S(e({editType:"arraydraw"}),{}),font:A({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:g.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"../color/attributes":366}],478:[function(d,ee,te){ee.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],479:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/array_container_defaults"),S=d("./attributes"),M=d("./constants"),e=M.name,a=S.buttons;ee.exports=function(c,s){var i={name:e,handleItemDefaults:n};g(c,s,i)};function n(t,c,s){function i(v,f){return A.coerce(t,c,S,v,f)}var x=g(t,c,{name:"buttons",handleItemDefaults:r}),p=i("visible",x.length>0);!p||(i("active"),i("direction"),i("type"),i("showactive"),i("x"),i("y"),A.noneOrAll(t,c,["x","y"]),i("xanchor"),i("yanchor"),i("pad.t"),i("pad.r"),i("pad.b"),i("pad.l"),A.coerceFont(i,"font",s.font),i("bgcolor",s.paper_bgcolor),i("bordercolor"),i("borderwidth"))}function r(t,c){function s(x,p){return A.coerce(t,c,a,x,p)}var i=s("visible",t.method==="skip"||Array.isArray(t.args));i&&(s("method"),s("args"),s("args2"),s("label"),s("execute"))}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":477,"./constants":478}],480:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../plots/plots"),S=d("../color"),M=d("../drawing"),e=d("../../lib"),a=d("../../lib/svg_text_utils"),n=d("../../plot_api/plot_template").arrayEditor,r=d("../../constants/alignment").LINE_SPACING,t=d("./constants"),c=d("./scrollbox");ee.exports=function(z){var I=z._fullLayout,D=e.filterVisible(I[t.name]);function R(re){g.autoMargin(z,L(re))}var O=I._menulayer.selectAll("g."+t.containerClassName).data(D.length>0?[0]:[]);if(O.enter().append("g").classed(t.containerClassName,!0).style("cursor","pointer"),O.exit().each(function(){A.select(this).selectAll("g."+t.headerGroupClassName).each(R)}).remove(),D.length!==0){var F=O.selectAll("g."+t.headerGroupClassName).data(D,s);F.enter().append("g").classed(t.headerGroupClassName,!0);for(var N=e.ensureSingle(O,"g",t.dropdownButtonGroupClassName,function(re){re.style("pointer-events","all")}),G=0;G<D.length;G++){var K=D[G];u(z,K)}var W="updatemenus"+I._uid,Y=new c(z,N,W);F.enter().size()&&(N.node().parentNode.appendChild(N.node()),N.call(k)),F.exit().each(function(re){N.call(k),R(re)}).remove(),F.each(function(re){var ue=A.select(this),j=re.type==="dropdown"?N:null;g.manageCommandObserver(z,re,re.buttons,function(q){p(z,re,re.buttons[q.index],ue,j,Y,q.index,!0)}),re.type==="dropdown"?(v(z,ue,N,Y,re),x(N,re)&&f(z,ue,N,Y,re)):f(z,ue,null,null,re)})}};function s(P){return P._index}function i(P){return+P.attr(t.menuIndexAttrName)==-1}function x(P,z){return+P.attr(t.menuIndexAttrName)===z._index}function p(P,z,I,D,R,O,F,N){z.active=F,n(P.layout,t.name,z).applyUpdate("active",F),z.type==="buttons"?f(P,D,null,null,z):z.type==="dropdown"&&(R.attr(t.menuIndexAttrName,"-1"),v(P,D,R,O,z),N||f(P,D,R,O,z))}function v(P,z,I,D,R){var O=e.ensureSingle(z,"g",t.headerClassName,function(re){re.style("pointer-events","all")}),F=R._dims,N=R.active,G=R.buttons[N]||t.blankHeaderOpts,K={y:R.pad.t,yPad:0,x:R.pad.l,xPad:0,index:0},W={width:F.headerWidth,height:F.headerHeight};O.call(m,R,G,P).call(T,R,K,W);var Y=e.ensureSingle(z,"text",t.headerArrowClassName,function(re){re.attr("text-anchor","end").call(M.font,R.font).text(t.arrowSymbol[R.direction])});Y.attr({x:F.headerWidth-t.arrowOffsetX+R.pad.l,y:F.headerHeight/2+t.textOffsetY+R.pad.t}),O.on("click",function(){I.call(k,String(x(I,R)?-1:R._index)),f(P,z,I,D,R)}),O.on("mouseover",function(){O.call(h)}),O.on("mouseout",function(){O.call(b,R)}),M.setTranslate(z,F.lx,F.ly)}function f(P,z,I,D,R){I||(I=z,I.attr("pointer-events","all"));var O=!i(I)||R.type==="buttons"?R.buttons:[],F=R.type==="dropdown"?t.dropdownButtonClassName:t.buttonClassName,N=I.selectAll("g."+F).data(e.filterVisible(O)),G=N.enter().append("g").classed(F,!0),K=N.exit();R.type==="dropdown"?(G.attr("opacity","0").transition().attr("opacity","1"),K.transition().attr("opacity","0").remove()):K.remove();var W=0,Y=0,re=R._dims,ue=["up","down"].indexOf(R.direction)!==-1;R.type==="dropdown"&&(ue?Y=re.headerHeight+t.gapButtonHeader:W=re.headerWidth+t.gapButtonHeader),R.type==="dropdown"&&R.direction==="up"&&(Y=-t.gapButtonHeader+t.gapButton-re.openHeight),R.type==="dropdown"&&R.direction==="left"&&(W=-t.gapButtonHeader+t.gapButton-re.openWidth);var j={x:re.lx+W+R.pad.l,y:re.ly+Y+R.pad.t,yPad:t.gapButton,xPad:t.gapButton,index:0},q={l:j.x+R.borderwidth,t:j.y+R.borderwidth};N.each(function(V,U){var $=A.select(this);$.call(m,R,V,P).call(T,R,j),$.on("click",function(){A.event.defaultPrevented||(V.execute&&(V.args2&&R.active===U?(p(P,R,V,z,I,D,-1),g.executeAPICommand(P,V.method,V.args2)):(p(P,R,V,z,I,D,U),g.executeAPICommand(P,V.method,V.args))),P.emit("plotly_buttonclicked",{menu:R,button:V,active:R.active}))}),$.on("mouseover",function(){$.call(h)}),$.on("mouseout",function(){$.call(b,R),N.call(_,R)})}),N.call(_,R),ue?(q.w=Math.max(re.openWidth,re.headerWidth),q.h=j.y-q.t):(q.w=j.x-q.l,q.h=Math.max(re.openHeight,re.headerHeight)),q.direction=R.direction,D&&(N.size()?y(P,z,I,D,R,q):o(D))}function y(P,z,I,D,R,O){var F=R.direction,N=F==="up"||F==="down",G=R._dims,K=R.active,W,Y,re;if(N)for(Y=0,re=0;re<K;re++)Y+=G.heights[re]+t.gapButton;else for(W=0,re=0;re<K;re++)W+=G.widths[re]+t.gapButton;D.enable(O,W,Y),D.hbar&&D.hbar.attr("opacity","0").transition().attr("opacity","1"),D.vbar&&D.vbar.attr("opacity","0").transition().attr("opacity","1")}function o(P){var z=!!P.hbar,I=!!P.vbar;z&&P.hbar.transition().attr("opacity","0").each("end",function(){z=!1,I||P.disable()}),I&&P.vbar.transition().attr("opacity","0").each("end",function(){I=!1,z||P.disable()})}function m(P,z,I,D){P.call(l,z).call(w,z,I,D)}function l(P,z){var I=e.ensureSingle(P,"rect",t.itemRectClassName,function(D){D.attr({rx:t.rx,ry:t.ry,"shape-rendering":"crispEdges"})});I.call(S.stroke,z.bordercolor).call(S.fill,z.bgcolor).style("stroke-width",z.borderwidth+"px")}function w(P,z,I,D){var R=e.ensureSingle(P,"text",t.itemTextClassName,function(N){N.attr({"text-anchor":"start","data-notex":1})}),O=I.label,F=D._fullLayout._meta;F&&(O=e.templateString(O,F)),R.call(M.font,z.font).text(O).call(a.convertToTspans,D)}function _(P,z){var I=z.active;P.each(function(D,R){var O=A.select(this);R===I&&z.showactive&&O.select("rect."+t.itemRectClassName).call(S.fill,t.activeColor)})}function h(P){P.select("rect."+t.itemRectClassName).call(S.fill,t.hoverColor)}function b(P,z){P.select("rect."+t.itemRectClassName).call(S.fill,z.bgcolor)}function u(P,z){var I=z._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},D=M.tester.selectAll("g."+t.dropdownButtonClassName).data(e.filterVisible(z.buttons));D.enter().append("g").classed(t.dropdownButtonClassName,!0);var R=["up","down"].indexOf(z.direction)!==-1;D.each(function(W,Y){var re=A.select(this);re.call(m,z,W,P);var ue=re.select("."+t.itemTextClassName),j=ue.node()&&M.bBox(ue.node()).width,q=Math.max(j+t.textPadX,t.minWidth),V=z.font.size*r,U=a.lineCount(ue),$=Math.max(V*U,t.minHeight)+t.textOffsetY;$=Math.ceil($),q=Math.ceil(q),I.widths[Y]=q,I.heights[Y]=$,I.height1=Math.max(I.height1,$),I.width1=Math.max(I.width1,q),R?(I.totalWidth=Math.max(I.totalWidth,q),I.openWidth=I.totalWidth,I.totalHeight+=$+t.gapButton,I.openHeight+=$+t.gapButton):(I.totalWidth+=q+t.gapButton,I.openWidth+=q+t.gapButton,I.totalHeight=Math.max(I.totalHeight,$),I.openHeight=I.totalHeight)}),R?I.totalHeight-=t.gapButton:I.totalWidth-=t.gapButton,I.headerWidth=I.width1+t.arrowPadX,I.headerHeight=I.height1,z.type==="dropdown"&&(R?(I.width1+=t.arrowPadX,I.totalHeight=I.height1):I.totalWidth=I.width1,I.totalWidth+=t.arrowPadX),D.remove();var O=I.totalWidth+z.pad.l+z.pad.r,F=I.totalHeight+z.pad.t+z.pad.b,N=P._fullLayout._size;I.lx=N.l+N.w*z.x,I.ly=N.t+N.h*(1-z.y);var G="left";e.isRightAnchor(z)&&(I.lx-=O,G="right"),e.isCenterAnchor(z)&&(I.lx-=O/2,G="center");var K="top";e.isBottomAnchor(z)&&(I.ly-=F,K="bottom"),e.isMiddleAnchor(z)&&(I.ly-=F/2,K="middle"),I.totalWidth=Math.ceil(I.totalWidth),I.totalHeight=Math.ceil(I.totalHeight),I.lx=Math.round(I.lx),I.ly=Math.round(I.ly),g.autoMargin(P,L(z),{x:z.x,y:z.y,l:O*({right:1,center:.5}[G]||0),r:O*({left:1,center:.5}[G]||0),b:F*({top:1,middle:.5}[K]||0),t:F*({bottom:1,middle:.5}[K]||0)})}function L(P){return t.autoMarginIdRoot+P._index}function T(P,z,I,D){D=D||{};var R=P.select("."+t.itemRectClassName),O=P.select("."+t.itemTextClassName),F=z.borderwidth,N=I.index,G=z._dims;M.setTranslate(P,F+I.x,F+I.y);var K=["up","down"].indexOf(z.direction)!==-1,W=D.height||(K?G.heights[N]:G.height1);R.attr({x:0,y:0,width:D.width||(K?G.width1:G.widths[N]),height:W});var Y=z.font.size*r,re=a.lineCount(O),ue=(re-1)*Y/2;a.positionText(O,t.textOffsetX,W/2-ue+t.textOffsetY),K?I.y+=G.heights[N]+I.yPad:I.x+=G.widths[N]+I.xPad,I.index++}function k(P,z){P.attr(t.menuIndexAttrName,z||"-1").selectAll("g."+t.dropdownButtonClassName).remove()}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":478,"./scrollbox":482,"@plotly/d3":58}],481:[function(d,ee,te){arguments[4][475][0].apply(te,arguments)},{"./attributes":477,"./constants":478,"./defaults":479,"./draw":480,dup:475}],482:[function(d,ee,te){ee.exports=e;var A=d("@plotly/d3"),g=d("../color"),S=d("../drawing"),M=d("../../lib");function e(a,n,r){this.gd=a,this.container=n,this.id=r,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(n,r,t){var c=this.gd._fullLayout,s=c.width,i=c.height;this.position=n;var x=this.position.l,p=this.position.w,v=this.position.t,f=this.position.h,y=this.position.direction,o=y==="down",m=y==="left",l=y==="right",w=y==="up",_=p,h=f,b,u,L,T;!o&&!m&&!l&&!w&&(this.position.direction="down",o=!0);var k=o||w;k?(b=x,u=b+_,o?(L=v,T=Math.min(L+h,i),h=T-L):(T=v+h,L=Math.max(T-h,0),h=T-L)):(L=v,T=L+h,m?(u=x+_,b=Math.max(u-_,0),_=u-b):(b=x,u=Math.min(b+_,s),_=u-b)),this._box={l:b,t:L,w:_,h};var P=p>_,z=e.barLength+2*e.barPad,I=e.barWidth+2*e.barPad,D=x,R=v+f;R+I>i&&(R=i-I);var O=this.container.selectAll("rect.scrollbar-horizontal").data(P?[0]:[]);O.exit().on(".drag",null).remove(),O.enter().append("rect").classed("scrollbar-horizontal",!0).call(g.fill,e.barColor),P?(this.hbar=O.attr({rx:e.barRadius,ry:e.barRadius,x:D,y:R,width:z,height:I}),this._hbarXMin=D+z/2,this._hbarTranslateMax=_-z):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var F=f>h,N=e.barWidth+2*e.barPad,G=e.barLength+2*e.barPad,K=x+p,W=v;K+N>s&&(K=s-N);var Y=this.container.selectAll("rect.scrollbar-vertical").data(F?[0]:[]);Y.exit().on(".drag",null).remove(),Y.enter().append("rect").classed("scrollbar-vertical",!0).call(g.fill,e.barColor),F?(this.vbar=Y.attr({rx:e.barRadius,ry:e.barRadius,x:K,y:W,width:N,height:G}),this._vbarYMin=W+G/2,this._vbarTranslateMax=h-G):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var re=this.id,ue=b-.5,j=F?u+N+.5:u+.5,q=L-.5,V=P?T+I+.5:T+.5,U=c._topdefs.selectAll("#"+re).data(P||F?[0]:[]);if(U.exit().remove(),U.enter().append("clipPath").attr("id",re).append("rect"),P||F?(this._clipRect=U.select("rect").attr({x:Math.floor(ue),y:Math.floor(q),width:Math.ceil(j)-Math.floor(ue),height:Math.ceil(V)-Math.floor(q)}),this.container.call(S.setClipUrl,re,this.gd),this.bg.attr({x,y:v,width:p,height:f})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(S.setClipUrl,null),delete this._clipRect),P||F){var $=A.behavior.drag().on("dragstart",function(){A.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call($);var ne=A.behavior.drag().on("dragstart",function(){A.event.sourceEvent.preventDefault(),A.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));P&&this.hbar.on(".drag",null).call(ne),F&&this.vbar.on(".drag",null).call(ne)}this.setTranslate(r,t)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(S.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var n=this.translateX,r=this.translateY;this.hbar&&(n-=A.event.dx),this.vbar&&(r-=A.event.dy),this.setTranslate(n,r)},e.prototype._onBoxWheel=function(){var n=this.translateX,r=this.translateY;this.hbar&&(n+=A.event.deltaY),this.vbar&&(r+=A.event.deltaY),this.setTranslate(n,r)},e.prototype._onBarDrag=function(){var n=this.translateX,r=this.translateY;if(this.hbar){var t=n+this._hbarXMin,c=t+this._hbarTranslateMax,s=M.constrain(A.event.x,t,c),i=(s-t)/(c-t),x=this.position.w-this._box.w;n=i*x}if(this.vbar){var p=r+this._vbarYMin,v=p+this._vbarTranslateMax,f=M.constrain(A.event.y,p,v),y=(f-p)/(v-p),o=this.position.h-this._box.h;r=y*o}this.setTranslate(n,r)},e.prototype.setTranslate=function(n,r){var t=this.position.w-this._box.w,c=this.position.h-this._box.h;if(n=M.constrain(n||0,0,t),r=M.constrain(r||0,0,c),this.translateX=n,this.translateY=r,this.container.call(S.setTranslate,this._box.l-this.position.l-n,this._box.t-this.position.t-r),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+n-.5),y:Math.floor(this.position.t+r-.5)}),this.hbar){var s=n/t;this.hbar.call(S.setTranslate,n+s*this._hbarTranslateMax,r)}if(this.vbar){var i=r/c;this.vbar.call(S.setTranslate,n,r+i*this._vbarTranslateMax)}}},{"../../lib":515,"../color":367,"../drawing":389,"@plotly/d3":58}],483:[function(d,ee,te){ee.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],484:[function(d,ee,te){ee.exports={axisRefDescription:function(A,g,S){return["If set to a",A,"axis id (e.g. *"+A+"* or","*"+A+"2*), the `"+A+"` position refers to a",A,"coordinate. If set to *paper*, the `"+A+"`","position refers to the distance from the",g,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",g,"("+S+"). If set to a",A,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",g,"of the domain of that axis: e.g.,","*"+A+"2 domain* refers to the domain of the second",A," axis and a",A,"position of 0.5 refers to the","point between the",g,"and the",S,"of the domain of the","second",A,"axis."].join(" ")}}},{}],485:[function(d,ee,te){ee.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],486:[function(d,ee,te){ee.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],487:[function(d,ee,te){ee.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],488:[function(d,ee,te){ee.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],489:[function(d,ee,te){ee.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],490:[function(d,ee,te){ee.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],491:[function(d,ee,te){ee.exports={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE*1e-4,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:1-1e-6,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],492:[function(d,ee,te){te.xmlns="http://www.w3.org/2000/xmlns/",te.svg="http://www.w3.org/2000/svg",te.xlink="http://www.w3.org/1999/xlink",te.svgAttrs={xmlns:te.svg,"xmlns:xlink":te.xlink}},{}],493:[function(d,ee,te){te.version=d("./version").version,d("native-promise-only"),d("../build/plotcss");for(var A=d("./registry"),g=te.register=A.register,S=d("./plot_api"),M=Object.keys(S),e=0;e<M.length;e++){var a=M[e];a.charAt(0)!=="_"&&(te[a]=S[a]),g({moduleType:"apiMethod",name:a,fn:S[a]})}g(d("./traces/scatter")),g([d("./components/legend"),d("./components/fx"),d("./components/annotations"),d("./components/annotations3d"),d("./components/selections"),d("./components/shapes"),d("./components/images"),d("./components/updatemenus"),d("./components/sliders"),d("./components/rangeslider"),d("./components/rangeselector"),d("./components/grid"),d("./components/errorbars"),d("./components/colorscale"),d("./components/colorbar"),d("./components/modebar")]),g([d("./locale-en"),d("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(g(window.PlotlyLocales),delete window.PlotlyLocales),te.Icons=d("./fonts/ploticon");var n=d("./components/fx"),r=d("./plots/plots");te.Plots={resize:r.resize,graphJson:r.graphJson,sendDataToCloud:r.sendDataToCloud},te.Fx={hover:n.hover,unhover:n.unhover,loneHover:n.loneHover,loneUnhover:n.loneUnhover},te.Snapshot=d("./snapshot"),te.PlotSchema=d("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":358,"./components/annotations3d":363,"./components/colorbar":373,"./components/colorscale":379,"./components/errorbars":395,"./components/fx":407,"./components/grid":411,"./components/images":416,"./components/legend":424,"./components/modebar":430,"./components/rangeselector":438,"./components/rangeslider":445,"./components/selections":455,"./components/shapes":470,"./components/sliders":475,"./components/updatemenus":481,"./fonts/ploticon":494,"./locale-en":546,"./locale-en-us":545,"./plot_api":550,"./plot_api/plot_schema":554,"./plots/plots":628,"./registry":647,"./snapshot":652,"./traces/scatter":948,"./version":1132,"native-promise-only":245}],494:[function(d,ee,te){ee.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:["<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'>","<defs>"," <style>","  .cls-0{fill:#000;}","  .cls-1{fill:#FFF;}","  .cls-2{fill:#F26;}","  .cls-3{fill:#D69;}","  .cls-4{fill:#BAC;}","  .cls-5{fill:#9EF;}"," </style>","</defs>"," <title>plotly-logomark</title>"," <g id='symbol'>","  <rect class='cls-0' x='0' y='0' width='132' height='132' rx='18' ry='18'/>","  <circle class='cls-5' cx='102' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='54' r='6'/>","  <circle class='cls-3' cx='54' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='54' r='6'/>","  <path class='cls-1' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/>","  <path class='cls-1' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/>","  <path class='cls-1' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/>","  <path class='cls-1' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/>"," </g>","</svg>"].join("")}}},{}],495:[function(d,ee,te){te.isLeftAnchor=function(g){return g.xanchor==="left"||g.xanchor==="auto"&&g.x<=1/3},te.isCenterAnchor=function(g){return g.xanchor==="center"||g.xanchor==="auto"&&g.x>1/3&&g.x<2/3},te.isRightAnchor=function(g){return g.xanchor==="right"||g.xanchor==="auto"&&g.x>=2/3},te.isTopAnchor=function(g){return g.yanchor==="top"||g.yanchor==="auto"&&g.y>=2/3},te.isMiddleAnchor=function(g){return g.yanchor==="middle"||g.yanchor==="auto"&&g.y>1/3&&g.y<2/3},te.isBottomAnchor=function(g){return g.yanchor==="bottom"||g.yanchor==="auto"&&g.y<=1/3}},{}],496:[function(d,ee,te){var A=d("./mod"),g=A.mod,S=A.modHalf,M=Math.PI,e=2*M;function a(y){return y/180*M}function n(y){return y/M*180}function r(y){return Math.abs(y[1]-y[0])>e-1e-14}function t(y,o){return S(o-y,e)}function c(y,o){return Math.abs(t(y,o))}function s(y,o){if(r(o))return!0;var m,l;o[0]<o[1]?(m=o[0],l=o[1]):(m=o[1],l=o[0]),m=g(m,e),l=g(l,e),m>l&&(l+=e);var w=g(y,e),_=w+e;return w>=m&&w<=l||_>=m&&_<=l}function i(y,o,m,l){if(!s(o,l))return!1;var w,_;return m[0]<m[1]?(w=m[0],_=m[1]):(w=m[1],_=m[0]),y>=w&&y<=_}function x(y,o,m,l,w,_,h){w=w||0,_=_||0;var b=r([m,l]),u,L,T,k,P;b?(u=0,L=M,T=e):m<l?(u=m,T=l):(u=l,T=m),y<o?(k=y,P=o):(k=o,P=y);function z(O,F){return[O*Math.cos(F)+w,_-O*Math.sin(F)]}var I=Math.abs(T-u)<=M?0:1;function D(O,F,N){return"A"+[O,O]+" "+[0,I,N]+" "+z(O,F)}var R;return b?k===null?R="M"+z(P,u)+D(P,L,0)+D(P,T,0)+"Z":R="M"+z(k,u)+D(k,L,0)+D(k,T,0)+"ZM"+z(P,u)+D(P,L,1)+D(P,T,1)+"Z":k===null?(R="M"+z(P,u)+D(P,T,0),h&&(R+="L0,0Z")):R="M"+z(k,u)+"L"+z(P,u)+D(P,T,0)+"L"+z(k,T)+D(k,u,1)+"Z",R}function p(y,o,m,l,w){return x(null,y,o,m,l,w,0)}function v(y,o,m,l,w){return x(null,y,o,m,l,w,1)}function f(y,o,m,l,w,_){return x(y,o,m,l,w,_,1)}ee.exports={deg2rad:a,rad2deg:n,angleDelta:t,angleDist:c,isFullCircle:r,isAngleInsideSector:s,isPtInsideSector:i,pathArc:p,pathSector:v,pathAnnulus:f}},{"./mod":522}],497:[function(d,ee,te){var A=Array.isArray,g=ArrayBuffer,S=DataView;function M(r){return g.isView(r)&&!(r instanceof S)}te.isTypedArray=M;function e(r){return A(r)||M(r)}te.isArrayOrTypedArray=e;function a(r){return!e(r[0])}te.isArray1D=a,te.ensureArray=function(r,t){return A(r)||(r=[]),r.length=t,r},te.concat=function(){var r=[],t=!0,c=0,s,i,x,p,v,f,y,o;for(x=0;x<arguments.length;x++)p=arguments[x],f=p.length,f&&(i?r.push(p):(i=p,v=f),A(p)?s=!1:(t=!1,c?s!==p.constructor&&(s=!1):s=p.constructor),c+=f);if(!c)return[];if(!r.length)return i;if(t)return i.concat.apply(i,r);if(s){for(y=new s(c),y.set(i),x=0;x<r.length;x++)p=r[x],y.set(p,v),v+=p.length;return y}for(y=new Array(c),o=0;o<i.length;o++)y[o]=i[o];for(x=0;x<r.length;x++){for(p=r[x],o=0;o<p.length;o++)y[v+o]=p[o];v+=o}return y},te.maxRowLength=function(r){return n(r,Math.max,0)},te.minRowLength=function(r){return n(r,Math.min,1/0)};function n(r,t,c){if(e(r))if(e(r[0])){for(var s=c,i=0;i<r.length;i++)s=t(s,r[i].length);return s}else return r.length;return 0}},{}],498:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../constants/numerical").BADNUM,S=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;ee.exports=function(e){return typeof e=="string"&&(e=e.replace(S,"")),A(e)?Number(e):g}},{"../constants/numerical":491,"fast-isnumeric":190}],499:[function(d,ee,te){ee.exports=function(g){var S=g._fullLayout;S._glcanvas&&S._glcanvas.size()&&S._glcanvas.each(function(M){M.regl&&M.regl.clear({color:!0,depth:!0})})}},{}],500:[function(d,ee,te){ee.exports=function(g){g._responsiveChartHandler&&(window.removeEventListener("resize",g._responsiveChartHandler),delete g._responsiveChartHandler)}},{}],501:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("tinycolor2"),S=d("../plots/attributes"),M=d("../components/colorscale/scales"),e=d("../components/color"),a=d("../constants/interactions").DESELECTDIM,n=d("./nested_property"),r=d("./regex").counter,t=d("./mod").modHalf,c=d("./array").isArrayOrTypedArray;te.valObjectMeta={data_array:{coerceFunction:function(i,x,p){c(i)?x.set(i):p!==void 0&&x.set(p)}},enumerated:{coerceFunction:function(i,x,p,v){v.coerceNumber&&(i=+i),v.values.indexOf(i)===-1?x.set(p):x.set(i)},validateFunction:function(i,x){x.coerceNumber&&(i=+i);for(var p=x.values,v=0;v<p.length;v++){var f=String(p[v]);if(f.charAt(0)==="/"&&f.charAt(f.length-1)==="/"){var y=new RegExp(f.substr(1,f.length-2));if(y.test(i))return!0}else if(i===p[v])return!0}return!1}},boolean:{coerceFunction:function(i,x,p){i===!0||i===!1?x.set(i):x.set(p)}},number:{coerceFunction:function(i,x,p,v){!A(i)||v.min!==void 0&&i<v.min||v.max!==void 0&&i>v.max?x.set(p):x.set(+i)}},integer:{coerceFunction:function(i,x,p,v){i%1||!A(i)||v.min!==void 0&&i<v.min||v.max!==void 0&&i>v.max?x.set(p):x.set(+i)}},string:{coerceFunction:function(i,x,p,v){if(typeof i!="string"){var f=typeof i=="number";v.strict===!0||!f?x.set(p):x.set(String(i))}else v.noBlank&&!i?x.set(p):x.set(i)}},color:{coerceFunction:function(i,x,p){g(i).isValid()?x.set(i):x.set(p)}},colorlist:{coerceFunction:function(i,x,p){function v(f){return g(f).isValid()}!Array.isArray(i)||!i.length?x.set(p):i.every(v)?x.set(i):x.set(p)}},colorscale:{coerceFunction:function(i,x,p){x.set(M.get(i,p))}},angle:{coerceFunction:function(i,x,p){i==="auto"?x.set("auto"):A(i)?x.set(t(+i,360)):x.set(p)}},subplotid:{coerceFunction:function(i,x,p,v){var f=v.regex||r(p);if(typeof i=="string"&&f.test(i)){x.set(i);return}x.set(p)},validateFunction:function(i,x){var p=x.dflt;return i===p?!0:typeof i!="string"?!1:!!r(p).test(i)}},flaglist:{coerceFunction:function(i,x,p,v){if((v.extras||[]).indexOf(i)!==-1){x.set(i);return}if(typeof i!="string"){x.set(p);return}for(var f=i.split("+"),y=0;y<f.length;){var o=f[y];v.flags.indexOf(o)===-1||f.indexOf(o)<y?f.splice(y,1):y++}f.length?x.set(f.join("+")):x.set(p)}},any:{coerceFunction:function(i,x,p){i===void 0?x.set(p):x.set(i)}},info_array:{coerceFunction:function(i,x,p,v){function f(z,I,D){var R,O={set:function(F){R=F}};return D===void 0&&(D=I.dflt),te.valObjectMeta[I.valType].coerceFunction(z,O,D,I),R}var y=v.dimensions===2||v.dimensions==="1-2"&&Array.isArray(i)&&Array.isArray(i[0]);if(!Array.isArray(i)){x.set(p);return}var o=v.items,m=[],l=Array.isArray(o),w=l&&y&&Array.isArray(o[0]),_=y&&l&&!w,h=l&&!_?o.length:i.length,b,u,L,T,k,P;if(p=Array.isArray(p)?p:[],y)for(b=0;b<h;b++)for(m[b]=[],L=Array.isArray(i[b])?i[b]:[],_?k=o.length:l?k=o[b].length:k=L.length,u=0;u<k;u++)_?T=o[u]:l?T=o[b][u]:T=o,P=f(L[u],T,(p[b]||[])[u]),P!==void 0&&(m[b][u]=P);else for(b=0;b<h;b++)P=f(i[b],l?o[b]:o,p[b]),P!==void 0&&(m[b]=P);x.set(m)},validateFunction:function(i,x){if(!Array.isArray(i))return!1;var p=x.items,v=Array.isArray(p),f=x.dimensions===2;if(!x.freeLength&&i.length!==p.length)return!1;for(var y=0;y<i.length;y++)if(f){if(!Array.isArray(i[y])||!x.freeLength&&i[y].length!==p[y].length)return!1;for(var o=0;o<i[y].length;o++)if(!s(i[y][o],v?p[y][o]:p))return!1}else if(!s(i[y],v?p[y]:p))return!1;return!0}}},te.coerce=function(i,x,p,v,f){var y=n(p,v).get(),o=n(i,v),m=n(x,v),l=o.get(),w=x._template;if(l===void 0&&w&&(l=n(w,v).get(),w=0),f===void 0&&(f=y.dflt),y.arrayOk&&c(l))return m.set(l),l;var _=te.valObjectMeta[y.valType].coerceFunction;_(l,m,f,y);var h=m.get();return w&&h===f&&!s(l,y)&&(l=n(w,v).get(),_(l,m,f,y),h=m.get()),h},te.coerce2=function(i,x,p,v,f){var y=n(i,v),o=te.coerce(i,x,p,v,f),m=y.get();return m!=null?o:!1},te.coerceFont=function(i,x,p){var v={};return p=p||{},v.family=i(x+".family",p.family),v.size=i(x+".size",p.size),v.color=i(x+".color",p.color),v},te.coercePattern=function(i,x,p,v){var f=i(x+".shape");if(f){i(x+".solidity"),i(x+".size");var y=i(x+".fillmode"),o=y==="overlay";if(!v){var m=i(x+".bgcolor",o?p:void 0);i(x+".fgcolor",o?e.contrast(m):p)}i(x+".fgopacity",o?.5:1)}},te.coerceHoverinfo=function(i,x,p){var v=x._module.attributes,f=v.hoverinfo?v:S,y=f.hoverinfo,o;if(p._dataLength===1){var m=y.dflt==="all"?y.flags.slice():y.dflt.split("+");m.splice(m.indexOf("name"),1),o=m.join("+")}return te.coerce(i,x,f,"hoverinfo",o)},te.coerceSelectionMarkerOpacity=function(i,x){if(!!i.marker){var p=i.marker.opacity;if(p!==void 0){var v,f;!c(p)&&!i.selected&&!i.unselected&&(v=p,f=a*p),x("selected.marker.opacity",v),x("unselected.marker.opacity",f)}}};function s(i,x){var p=te.valObjectMeta[x.valType];if(x.arrayOk&&c(i))return!0;if(p.validateFunction)return p.validateFunction(i,x);var v={},f=v,y={set:function(o){f=o}};return p.coerceFunction(i,y,v,x),f!==v}te.validate=s},{"../components/color":367,"../components/colorscale/scales":382,"../constants/interactions":490,"../plots/attributes":562,"./array":497,"./mod":522,"./nested_property":523,"./regex":532,"fast-isnumeric":190,tinycolor2:313}],502:[function(d,ee,te){var A=d("d3-time-format").timeFormat,g=d("fast-isnumeric"),S=d("./loggers"),M=d("./mod").mod,e=d("../constants/numerical"),a=e.BADNUM,n=e.ONEDAY,r=e.ONEHOUR,t=e.ONEMIN,c=e.ONESEC,s=e.EPOCHJD,i=d("../registry"),x=d("d3-time-format").utcFormat,p=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,v=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,f=new Date().getFullYear()-70;function y(R){return R&&i.componentsRegistry.calendars&&typeof R=="string"&&R!=="gregorian"}te.dateTick0=function(R,O){var F=o(R,!!O);if(O<2)return F;var N=te.dateTime2ms(F,R);return N+=n*(O-1),te.ms2DateTime(N,0,R)};function o(R,O){return y(R)?O?i.getComponentMethod("calendars","CANONICAL_SUNDAY")[R]:i.getComponentMethod("calendars","CANONICAL_TICK")[R]:O?"2000-01-02":"2000-01-01"}te.dfltRange=function(R){return y(R)?i.getComponentMethod("calendars","DFLTRANGE")[R]:["2000-01-01","2001-01-01"]},te.isJSDate=function(R){return typeof R=="object"&&R!==null&&typeof R.getTime=="function"};var m,l;te.dateTime2ms=function(R,O){if(te.isJSDate(R)){var F=R.getTimezoneOffset()*t,N=(R.getUTCMinutes()-R.getMinutes())*t+(R.getUTCSeconds()-R.getSeconds())*c+(R.getUTCMilliseconds()-R.getMilliseconds());if(N){var G=3*t;F=F-G/2+M(N-F+G/2,G)}return R=Number(R)-F,R>=m&&R<=l?R:a}if(typeof R!="string"&&typeof R!="number")return a;R=String(R);var K=y(O),W=R.charAt(0);K&&(W==="G"||W==="g")&&(R=R.substr(1),O="");var Y=K&&O.substr(0,7)==="chinese",re=R.match(Y?v:p);if(!re)return a;var ue=re[1],j=re[3]||"1",q=Number(re[5]||1),V=Number(re[7]||0),U=Number(re[9]||0),$=Number(re[11]||0);if(K){if(ue.length===2)return a;ue=Number(ue);var ne;try{var X=i.getComponentMethod("calendars","getCal")(O);if(Y){var Q=j.charAt(j.length-1)==="i";j=parseInt(j,10),ne=X.newDate(ue,X.toMonthIndex(ue,j,Q),q)}else ne=X.newDate(ue,Number(j),q)}catch{return a}return ne?(ne.toJD()-s)*n+V*r+U*t+$*c:a}ue.length===2?ue=(Number(ue)+2e3-f)%100+f:ue=Number(ue),j-=1;var ie=new Date(Date.UTC(2e3,j,q,V,U));return ie.setUTCFullYear(ue),ie.getUTCMonth()!==j||ie.getUTCDate()!==q?a:ie.getTime()+$*c},m=te.MIN_MS=te.dateTime2ms("-9999"),l=te.MAX_MS=te.dateTime2ms("9999-12-31 23:59:59.9999"),te.isDateTime=function(R,O){return te.dateTime2ms(R,O)!==a};function w(R,O){return String(R+Math.pow(10,O)).substr(1)}var _=90*n,h=3*r,b=5*t;te.ms2DateTime=function(R,O,F){if(typeof R!="number"||!(R>=m&&R<=l))return a;O||(O=0);var N=Math.floor(M(R+.05,1)*10),G=Math.round(R-N/10),K,W,Y,re,ue,j;if(y(F)){var q=Math.floor(G/n)+s,V=Math.floor(M(R,n));try{K=i.getComponentMethod("calendars","getCal")(F).fromJD(q).formatDate("yyyy-mm-dd")}catch{K=x("G%Y-%m-%d")(new Date(G))}if(K.charAt(0)==="-")for(;K.length<11;)K="-0"+K.substr(1);else for(;K.length<10;)K="0"+K;W=O<_?Math.floor(V/r):0,Y=O<_?Math.floor(V%r/t):0,re=O<h?Math.floor(V%t/c):0,ue=O<b?V%c*10+N:0}else j=new Date(G),K=x("%Y-%m-%d")(j),W=O<_?j.getUTCHours():0,Y=O<_?j.getUTCMinutes():0,re=O<h?j.getUTCSeconds():0,ue=O<b?j.getUTCMilliseconds()*10+N:0;return u(K,W,Y,re,ue)},te.ms2DateTimeLocal=function(R){if(!(R>=m+n&&R<=l-n))return a;var O=Math.floor(M(R+.05,1)*10),F=new Date(Math.round(R-O/10)),N=A("%Y-%m-%d")(F),G=F.getHours(),K=F.getMinutes(),W=F.getSeconds(),Y=F.getUTCMilliseconds()*10+O;return u(N,G,K,W,Y)};function u(R,O,F,N,G){if((O||F||N||G)&&(R+=" "+w(O,2)+":"+w(F,2),(N||G)&&(R+=":"+w(N,2),G))){for(var K=4;G%10===0;)K-=1,G/=10;R+="."+w(G,K)}return R}te.cleanDate=function(R,O,F){if(R===a)return O;if(te.isJSDate(R)||typeof R=="number"&&isFinite(R)){if(y(F))return S.error("JS Dates and milliseconds are incompatible with world calendars",R),O;if(R=te.ms2DateTimeLocal(+R),!R&&O!==void 0)return O}else if(!te.isDateTime(R,F))return S.error("unrecognized date",R),O;return R};var L=/%\d?f/g,T=/%h/g,k={1:"1",2:"1",3:"2",4:"2"};function P(R,O,F,N){R=R.replace(L,function(K){var W=Math.min(+K.charAt(1)||6,6),Y=(O/1e3%1+2).toFixed(W).substr(2).replace(/0+$/,"")||"0";return Y});var G=new Date(Math.floor(O+.05));if(R=R.replace(T,function(){return k[F("%q")(G)]}),y(N))try{R=i.getComponentMethod("calendars","worldCalFmt")(R,O,N)}catch{return"Invalid"}return F(R)(G)}var z=[59,59.9,59.99,59.999,59.9999];function I(R,O){var F=M(R+.05,n),N=w(Math.floor(F/r),2)+":"+w(M(Math.floor(F/t),60),2);if(O!=="M"){g(O)||(O=0);var G=Math.min(M(R/c,60),z[O]),K=(100+G).toFixed(O).substr(1);O>0&&(K=K.replace(/0+$/,"").replace(/[\.]$/,"")),N+=":"+K}return N}te.formatDate=function(R,O,F,N,G,K){if(G=y(G)&&G,!O)if(F==="y")O=K.year;else if(F==="m")O=K.month;else if(F==="d")O=K.dayMonth+`
`+K.year;else return I(R,F)+`
`+P(K.dayMonthYear,R,N,G);return P(O,R,N,G)};var D=3*n;te.incrementMonth=function(R,O,F){F=y(F)&&F;var N=M(R,n);if(R=Math.round(R-N),F)try{var G=Math.round(R/n)+s,K=i.getComponentMethod("calendars","getCal")(F),W=K.fromJD(G);return O%12?K.add(W,O,"m"):K.add(W,O/12,"y"),(W.toJD()-s)*n+N}catch{S.error("invalid ms "+R+" in calendar "+F)}var Y=new Date(R+D);return Y.setUTCMonth(Y.getUTCMonth()+O)+N-D},te.findExactDates=function(R,O){for(var F=0,N=0,G=0,K=0,W,Y,re=y(O)&&i.getComponentMethod("calendars","getCal")(O),ue=0;ue<R.length;ue++){if(Y=R[ue],!g(Y)){K++;continue}if(!(Y%n))if(re)try{W=re.fromJD(Y/n+s),W.day()===1?W.month()===1?F++:N++:G++}catch{}else W=new Date(Y),W.getUTCDate()===1?W.getUTCMonth()===0?F++:N++:G++}N+=F,G+=N;var j=R.length-K;return{exactYears:F/j,exactMonths:N/j,exactDays:G/j}}},{"../constants/numerical":491,"../registry":647,"./loggers":519,"./mod":522,"d3-time-format":120,"fast-isnumeric":190}],503:[function(d,ee,te){var A=d("@plotly/d3"),g=d("./loggers"),S=d("./matrix"),M=d("gl-mat4");function e(f){var y;if(typeof f=="string"){if(y=document.getElementById(f),y===null)throw new Error("No DOM element with id '"+f+"' exists on the page.");return y}else if(f==null)throw new Error("DOM element provided is null or undefined");return f}function a(f){var y=A.select(f);return y.node()instanceof HTMLElement&&y.size()&&y.classed("js-plotly-plot")}function n(f){var y=f&&f.parentNode;y&&y.removeChild(f)}function r(f,y){t("global",f,y)}function t(f,y,o){var m="plotly.js-style-"+f,l=document.getElementById(m);l||(l=document.createElement("style"),l.setAttribute("id",m),l.appendChild(document.createTextNode("")),document.head.appendChild(l));var w=l.sheet;w.insertRule?w.insertRule(y+"{"+o+"}",0):w.addRule?w.addRule(y,o,0):g.warn("addStyleRule failed")}function c(f){var y="plotly.js-style-"+f,o=document.getElementById(y);o&&n(o)}function s(f){var y=x(f),o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return y.forEach(function(m){var l=i(m);if(l){var w=S.convertCssMatrix(l);o=M.multiply(o,o,w)}}),o}function i(f){var y=window.getComputedStyle(f,null),o=y.getPropertyValue("-webkit-transform")||y.getPropertyValue("-moz-transform")||y.getPropertyValue("-ms-transform")||y.getPropertyValue("-o-transform")||y.getPropertyValue("transform");return o==="none"?null:o.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(m){return+m})}function x(f){for(var y=[];p(f);)y.push(f),f=f.parentNode;return y}function p(f){return f&&(f instanceof Element||f instanceof HTMLElement)}function v(f,y){return f&&y&&f.x===y.x&&f.y===y.y&&f.top===y.top&&f.left===y.left&&f.right===y.right&&f.bottom===y.bottom}ee.exports={getGraphDiv:e,isPlotDiv:a,removeElement:n,addStyleRule:r,addRelatedStyleRule:t,deleteRelatedStyleRule:c,getFullTransformMatrix:s,getElementTransformMatrix:i,getElementAndAncestors:x,equalDomRects:v}},{"./loggers":519,"./matrix":521,"@plotly/d3":58,"gl-mat4":210}],504:[function(d,ee,te){var A=d("events").EventEmitter,g={init:function(S){if(S._ev instanceof A)return S;var M=new A,e=new A;return S._ev=M,S._internalEv=e,S.on=M.on.bind(M),S.once=M.once.bind(M),S.removeListener=M.removeListener.bind(M),S.removeAllListeners=M.removeAllListeners.bind(M),S._internalOn=e.on.bind(e),S._internalOnce=e.once.bind(e),S._removeInternalListener=e.removeListener.bind(e),S._removeAllInternalListeners=e.removeAllListeners.bind(e),S.emit=function(a,n){typeof jQuery<"u"&&jQuery(S).trigger(a,n),M.emit(a,n),e.emit(a,n)},S},triggerHandler:function(S,M,e){var a,n;typeof jQuery<"u"&&(a=jQuery(S).triggerHandler(M,e));var r=S._ev;if(!r)return a;var t=r._events[M];if(!t)return a;function c(i){if(i.listener){if(r.removeListener(M,i.listener),!i.fired)return i.fired=!0,i.listener.apply(r,[e])}else return i.apply(r,[e])}t=Array.isArray(t)?t:[t];var s;for(s=0;s<t.length-1;s++)c(t[s]);return n=c(t[s]),a!==void 0?a:n},purge:function(S){return delete S._ev,delete S.on,delete S.once,delete S.removeListener,delete S.removeAllListeners,delete S.emit,delete S._ev,delete S._internalEv,delete S._internalOn,delete S._internalOnce,delete S._removeInternalListener,delete S._removeAllInternalListeners,S}};ee.exports=g},{events:84}],505:[function(d,ee,te){var A=d("./is_plain_object.js"),g=Array.isArray;function S(e,a){var n,r;for(n=0;n<e.length;n++){if(r=e[n],r!==null&&typeof r=="object")return!1;r!==void 0&&(a[n]=r)}return!0}te.extendFlat=function(){return M(arguments,!1,!1,!1)},te.extendDeep=function(){return M(arguments,!0,!1,!1)},te.extendDeepAll=function(){return M(arguments,!0,!0,!1)},te.extendDeepNoArrays=function(){return M(arguments,!0,!1,!0)};function M(e,a,n,r){var t=e[0],c=e.length,s,i,x,p,v,f,y;if(c===2&&g(t)&&g(e[1])&&t.length===0){if(y=S(e[1],t),y)return t;t.splice(0,t.length)}for(var o=1;o<c;o++){s=e[o];for(i in s)x=t[i],p=s[i],r&&g(p)?t[i]=p:a&&p&&(A(p)||(v=g(p)))?(v?(v=!1,f=x&&g(x)?x:[]):f=x&&A(x)?x:{},t[i]=M([f,p],a,n,r)):(typeof p<"u"||n)&&(t[i]=p)}return t}},{"./is_plain_object.js":516}],506:[function(d,ee,te){ee.exports=function(g){for(var S={},M=[],e=0,a=0;a<g.length;a++){var n=g[a];S[n]!==1&&(S[n]=1,M[e++]=n)}return M}},{}],507:[function(d,ee,te){ee.exports=function(e){for(var a=S(e)?g:A,n=[],r=0;r<e.length;r++){var t=e[r];a(t)&&n.push(t)}return n};function A(M){return M.visible===!0}function g(M){var e=M[0].trace;return e.visible===!0&&e._length!==0}function S(M){return Array.isArray(M)&&Array.isArray(M[0])&&M[0][0]&&M[0][0].trace}},{}],508:[function(d,ee,te){var A=d("@plotly/d3"),g=d("country-regex"),S=d("@turf/area"),M=d("@turf/centroid"),e=d("@turf/bbox"),a=d("./identity"),n=d("./loggers"),r=d("./is_plain_object"),t=d("./nested_property"),c=d("./polygon"),s=Object.keys(g),i={"ISO-3":a,"USA-states":a,"country names":x};function x(w){for(var _=0;_<s.length;_++){var h=s[_],b=new RegExp(g[h]);if(b.test(w.trim().toLowerCase()))return h}return n.log("Unrecognized country name: "+w+"."),!1}function p(w,_,h){if(!_||typeof _!="string")return!1;var b=i[w](_),u,L,T;if(b){if(w==="USA-states")for(u=[],T=0;T<h.length;T++)L=h[T],L.properties&&L.properties.gu&&L.properties.gu==="USA"&&u.push(L);else u=h;for(T=0;T<u.length;T++)if(L=u[T],L.id===b)return L;n.log(["Location with id",b,"does not have a matching topojson feature at this resolution."].join(" "))}return!1}function v(w){var _=w.geometry,h=_.coordinates,b=w.id,u=[],L,T,k,P;function z(I){for(var D=0;D<I.length-1;D++)if(I[D][0]>0&&I[D+1][0]<0)return D;return null}switch(b==="RUS"||b==="FJI"?L=function(I){var D;if(z(I)===null)D=I;else for(D=new Array(I.length),P=0;P<I.length;P++)D[P]=[I[P][0]<0?I[P][0]+360:I[P][0],I[P][1]];u.push(c.tester(D))}:b==="ATA"?L=function(I){var D=z(I);if(D===null)return u.push(c.tester(I));var R=new Array(I.length+1),O=0;for(P=0;P<I.length;P++)P>D?R[O++]=[I[P][0]+360,I[P][1]]:P===D?(R[O++]=I[P],R[O++]=[I[P][0],-90]):R[O++]=I[P];var F=c.tester(R);F.pts.pop(),u.push(F)}:L=function(I){u.push(c.tester(I))},_.type){case"MultiPolygon":for(T=0;T<h.length;T++)for(k=0;k<h[T].length;k++)L(h[T][k]);break;case"Polygon":for(T=0;T<h.length;T++)L(h[T]);break}return u}function f(w){var _=w.geojson,h=window.PlotlyGeoAssets||{},b=typeof _=="string"?h[_]:_;return r(b)?b:(n.error("Oops ... something went wrong when fetching "+_),!1)}function y(w){var _=w[0].trace,h=f(_);if(!h)return!1;var b={},u=[],L;for(L=0;L<_._length;L++){var T=w[L];(T.loc||T.loc===0)&&(b[T.loc]=T)}function k(I){var D=t(I,_.featureidkey||"id").get(),R=b[D];if(R){var O=I.geometry;if(O.type==="Polygon"||O.type==="MultiPolygon"){var F={type:"Feature",id:D,geometry:O,properties:{}};F.properties.ct=o(F),R.fIn=I,R.fOut=F,u.push(F)}else n.log(["Location",R.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete b[D]}switch(h.type){case"FeatureCollection":var P=h.features;for(L=0;L<P.length;L++)k(P[L]);break;case"Feature":k(h);break;default:return n.warn(["Invalid GeoJSON type",(h.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var z in b)n.log(["Location *"+z+"*","does not have a matching feature with id-key","*"+_.featureidkey+"*."].join(" "));return u}function o(w){var _=w.geometry,h;if(_.type==="MultiPolygon")for(var b=_.coordinates,u=0,L=0;L<b.length;L++){var T={type:"Polygon",coordinates:b[L]},k=S.default(T);k>u&&(u=k,h=T)}else h=_;return M.default(h).geometry.coordinates}function m(w){var _=window.PlotlyGeoAssets||{},h=[];function b(P){return new Promise(function(z,I){A.json(P,function(D,R){if(D){delete _[P];var O=D.status===404?'GeoJSON at URL "'+P+'" does not exist.':"Unexpected error while fetching from "+P;return I(new Error(O))}return _[P]=R,z(R)})})}function u(P){return new Promise(function(z,I){var D=0,R=setInterval(function(){if(_[P]&&_[P]!=="pending")return clearInterval(R),z(_[P]);if(D>100)return clearInterval(R),I("Unexpected error while fetching from "+P);D++},50)})}for(var L=0;L<w.length;L++){var T=w[L][0].trace,k=T.geojson;typeof k=="string"&&(_[k]?_[k]==="pending"&&h.push(u(k)):(_[k]="pending",h.push(b(k))))}return h}function l(w){return e.default(w)}ee.exports={locationToFeature:p,feature2polygons:v,getTraceGeojson:f,extractTraceFeature:y,fetchTraceGeoData:m,computeBbox:l}},{"./identity":513,"./is_plain_object":516,"./loggers":519,"./nested_property":523,"./polygon":527,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],509:[function(d,ee,te){var A=d("../constants/numerical").BADNUM;te.calcTraceToLineCoords=function(g){for(var S=g[0].trace,M=S.connectgaps,e=[],a=[],n=0;n<g.length;n++){var r=g[n],t=r.lonlat;t[0]!==A?a.push(t):!M&&a.length>0&&(e.push(a),a=[])}return a.length>0&&e.push(a),e},te.makeLine=function(g){return g.length===1?{type:"LineString",coordinates:g[0]}:{type:"MultiLineString",coordinates:g}},te.makePolygon=function(g){if(g.length===1)return{type:"Polygon",coordinates:g};for(var S=new Array(g.length),M=0;M<g.length;M++)S[M]=[g[M]];return{type:"MultiPolygon",coordinates:S}},te.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":491}],510:[function(d,ee,te){var A=d("./mod").mod;te.segmentsIntersect=g;function g(n,r,t,c,s,i,x,p){var v=t-n,f=s-n,y=x-s,o=c-r,m=i-r,l=p-i,w=v*l-y*o;if(w===0)return null;var _=(f*l-y*m)/w,h=(f*o-v*m)/w;return h<0||h>1||_<0||_>1?null:{x:n+v*_,y:r+o*_}}te.segmentDistance=function(r,t,c,s,i,x,p,v){if(g(r,t,c,s,i,x,p,v))return 0;var f=c-r,y=s-t,o=p-i,m=v-x,l=f*f+y*y,w=o*o+m*m,_=Math.min(S(f,y,l,i-r,x-t),S(f,y,l,p-r,v-t),S(o,m,w,r-i,t-x),S(o,m,w,c-i,s-x));return Math.sqrt(_)};function S(n,r,t,c,s){var i=c*n+s*r;if(i<0)return c*c+s*s;if(i>t){var x=c-n,p=s-r;return x*x+p*p}else{var v=c*r-s*n;return v*v/t}}var M,e,a;te.getTextLocation=function(r,t,c,s){if((r!==e||s!==a)&&(M={},e=r,a=s),M[c])return M[c];var i=r.getPointAtLength(A(c-s/2,t)),x=r.getPointAtLength(A(c+s/2,t)),p=Math.atan((x.y-i.y)/(x.x-i.x)),v=r.getPointAtLength(A(c,t)),f=(v.x*4+i.x+x.x)/6,y=(v.y*4+i.y+x.y)/6,o={x:f,y,theta:p};return M[c]=o,o},te.clearLocationCache=function(){e=null},te.getVisibleSegment=function(r,t,c){var s=t.left,i=t.right,x=t.top,p=t.bottom,v=0,f=r.getTotalLength(),y=f,o,m;function l(_){var h=r.getPointAtLength(_);_===0?o=h:_===f&&(m=h);var b=h.x<s?s-h.x:h.x>i?h.x-i:0,u=h.y<x?x-h.y:h.y>p?h.y-p:0;return Math.sqrt(b*b+u*u)}for(var w=l(v);w;){if(v+=w+c,v>y)return;w=l(v)}for(w=l(y);w;){if(y-=w+c,v>y)return;w=l(y)}return{min:v,max:y,len:y-v,total:f,isClosed:v===0&&y===f&&Math.abs(o.x-m.x)<.1&&Math.abs(o.y-m.y)<.1}},te.findPointOnPath=function(r,t,c,s){s=s||{};for(var i=s.pathLength||r.getTotalLength(),x=s.tolerance||.001,p=s.iterationLimit||30,v=r.getPointAtLength(0)[c]>r.getPointAtLength(i)[c]?-1:1,f=0,y=0,o=i,m,l,w;f<p;){if(m=(y+o)/2,l=r.getPointAtLength(m),w=l[c]-t,Math.abs(w)<x)return l;v*w>0?o=m:y=m,f++}return l}},{"./mod":522}],511:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("tinycolor2"),S=d("color-normalize"),M=d("../components/colorscale"),e=d("../components/color/attributes").defaultLine,a=d("./array").isArrayOrTypedArray,n=S(e),r=1;function t(p,v){var f=p;return f[3]*=v,f}function c(p){if(A(p))return n;var v=S(p);return v.length?v:n}function s(p){return A(p)?p:r}function i(p,v,f){var y=p.color,o=a(y),m=a(v),l=M.extractOpts(p),w=[],_,h,b,u,L;if(l.colorscale!==void 0?_=M.makeColorScaleFuncFromTrace(p):_=c,o?h=function(k,P){return k[P]===void 0?n:S(_(k[P]))}:h=c,m?b=function(k,P){return k[P]===void 0?r:s(k[P])}:b=s,o||m)for(var T=0;T<f;T++)u=h(y,T),L=b(v,T),w[T]=t(u,L);else w=t(S(y),v);return w}function x(p){var v=M.extractOpts(p),f=v.colorscale;return v.reversescale&&(f=M.flipScale(v.colorscale)),f.map(function(y){var o=y[0],m=g(y[1]),l=m.toRgb();return{index:o,rgb:[l.r,l.g,l.b,l.a]}})}ee.exports={formatColor:i,parseColorScale:x}},{"../components/color/attributes":366,"../components/colorscale":379,"./array":497,"color-normalize":89,"fast-isnumeric":190,tinycolor2:313}],512:[function(d,ee,te){var A=d("./identity");function g(S){return[S]}ee.exports={keyFun:function(S){return S.key},repeat:g,descend:A,wrap:g,unwrap:function(S){return S[0]}}},{"./identity":513}],513:[function(d,ee,te){ee.exports=function(g){return g}},{}],514:[function(d,ee,te){ee.exports=function(g,S){if(!S)return g;var M=1/Math.abs(S),e=M>1?(M*g+M*S)/M:g+S,a=String(e).length;if(a>16){var n=String(S).length,r=String(g).length;if(a>=r+n){var t=parseFloat(e).toPrecision(12);t.indexOf("e+")===-1&&(e=+t)}}return e}},{}],515:[function(d,ee,te){var A=d("@plotly/d3"),g=d("d3-time-format").utcFormat,S=d("d3-format").format,M=d("fast-isnumeric"),e=d("../constants/numerical"),a=e.FP_SAFE,n=-a,r=e.BADNUM,t=ee.exports={};t.adjustFormat=function(j){return!j||/^\d[.]\df/.test(j)||/[.]\d%/.test(j)?j:j==="0.f"?"~f":/^\d%/.test(j)?"~%":/^\ds/.test(j)?"~s":!/^[~,.0$]/.test(j)&&/[&fps]/.test(j)?"~"+j:j};var c={};t.warnBadFormat=function(ue){var j=String(ue);c[j]||(c[j]=1,t.warn('encountered bad format: "'+j+'"'))},t.noFormat=function(ue){return String(ue)},t.numberFormat=function(ue){var j;try{j=S(t.adjustFormat(ue))}catch{return t.warnBadFormat(ue),t.noFormat}return j},t.nestedProperty=d("./nested_property"),t.keyedContainer=d("./keyed_container"),t.relativeAttr=d("./relative_attr"),t.isPlainObject=d("./is_plain_object"),t.toLogRange=d("./to_log_range"),t.relinkPrivateKeys=d("./relink_private");var s=d("./array");t.isTypedArray=s.isTypedArray,t.isArrayOrTypedArray=s.isArrayOrTypedArray,t.isArray1D=s.isArray1D,t.ensureArray=s.ensureArray,t.concat=s.concat,t.maxRowLength=s.maxRowLength,t.minRowLength=s.minRowLength;var i=d("./mod");t.mod=i.mod,t.modHalf=i.modHalf;var x=d("./coerce");t.valObjectMeta=x.valObjectMeta,t.coerce=x.coerce,t.coerce2=x.coerce2,t.coerceFont=x.coerceFont,t.coercePattern=x.coercePattern,t.coerceHoverinfo=x.coerceHoverinfo,t.coerceSelectionMarkerOpacity=x.coerceSelectionMarkerOpacity,t.validate=x.validate;var p=d("./dates");t.dateTime2ms=p.dateTime2ms,t.isDateTime=p.isDateTime,t.ms2DateTime=p.ms2DateTime,t.ms2DateTimeLocal=p.ms2DateTimeLocal,t.cleanDate=p.cleanDate,t.isJSDate=p.isJSDate,t.formatDate=p.formatDate,t.incrementMonth=p.incrementMonth,t.dateTick0=p.dateTick0,t.dfltRange=p.dfltRange,t.findExactDates=p.findExactDates,t.MIN_MS=p.MIN_MS,t.MAX_MS=p.MAX_MS;var v=d("./search");t.findBin=v.findBin,t.sorterAsc=v.sorterAsc,t.sorterDes=v.sorterDes,t.distinctVals=v.distinctVals,t.roundUp=v.roundUp,t.sort=v.sort,t.findIndexOfMin=v.findIndexOfMin,t.sortObjectKeys=d("./sort_object_keys");var f=d("./stats");t.aggNums=f.aggNums,t.len=f.len,t.mean=f.mean,t.median=f.median,t.midRange=f.midRange,t.variance=f.variance,t.stdev=f.stdev,t.interp=f.interp;var y=d("./matrix");t.init2dArray=y.init2dArray,t.transposeRagged=y.transposeRagged,t.dot=y.dot,t.translationMatrix=y.translationMatrix,t.rotationMatrix=y.rotationMatrix,t.rotationXYMatrix=y.rotationXYMatrix,t.apply3DTransform=y.apply3DTransform,t.apply2DTransform=y.apply2DTransform,t.apply2DTransform2=y.apply2DTransform2,t.convertCssMatrix=y.convertCssMatrix,t.inverseTransformMatrix=y.inverseTransformMatrix;var o=d("./angles");t.deg2rad=o.deg2rad,t.rad2deg=o.rad2deg,t.angleDelta=o.angleDelta,t.angleDist=o.angleDist,t.isFullCircle=o.isFullCircle,t.isAngleInsideSector=o.isAngleInsideSector,t.isPtInsideSector=o.isPtInsideSector,t.pathArc=o.pathArc,t.pathSector=o.pathSector,t.pathAnnulus=o.pathAnnulus;var m=d("./anchor_utils");t.isLeftAnchor=m.isLeftAnchor,t.isCenterAnchor=m.isCenterAnchor,t.isRightAnchor=m.isRightAnchor,t.isTopAnchor=m.isTopAnchor,t.isMiddleAnchor=m.isMiddleAnchor,t.isBottomAnchor=m.isBottomAnchor;var l=d("./geometry2d");t.segmentsIntersect=l.segmentsIntersect,t.segmentDistance=l.segmentDistance,t.getTextLocation=l.getTextLocation,t.clearLocationCache=l.clearLocationCache,t.getVisibleSegment=l.getVisibleSegment,t.findPointOnPath=l.findPointOnPath;var w=d("./extend");t.extendFlat=w.extendFlat,t.extendDeep=w.extendDeep,t.extendDeepAll=w.extendDeepAll,t.extendDeepNoArrays=w.extendDeepNoArrays;var _=d("./loggers");t.log=_.log,t.warn=_.warn,t.error=_.error;var h=d("./regex");t.counterRegex=h.counter;var b=d("./throttle");t.throttle=b.throttle,t.throttleDone=b.done,t.clearThrottle=b.clear;var u=d("./dom");t.getGraphDiv=u.getGraphDiv,t.isPlotDiv=u.isPlotDiv,t.removeElement=u.removeElement,t.addStyleRule=u.addStyleRule,t.addRelatedStyleRule=u.addRelatedStyleRule,t.deleteRelatedStyleRule=u.deleteRelatedStyleRule,t.getFullTransformMatrix=u.getFullTransformMatrix,t.getElementTransformMatrix=u.getElementTransformMatrix,t.getElementAndAncestors=u.getElementAndAncestors,t.equalDomRects=u.equalDomRects,t.clearResponsive=d("./clear_responsive"),t.preserveDrawingBuffer=d("./preserve_drawing_buffer"),t.makeTraceGroups=d("./make_trace_groups"),t._=d("./localize"),t.notifier=d("./notifier"),t.filterUnique=d("./filter_unique"),t.filterVisible=d("./filter_visible"),t.pushUnique=d("./push_unique"),t.increment=d("./increment"),t.cleanNumber=d("./clean_number"),t.ensureNumber=function(j){return M(j)?(j=Number(j),j>a||j<n?r:j):r},t.isIndex=function(ue,j){return j!==void 0&&ue>=j?!1:M(ue)&&ue>=0&&ue%1===0},t.noop=d("./noop"),t.identity=d("./identity"),t.repeat=function(ue,j){for(var q=new Array(j),V=0;V<j;V++)q[V]=ue;return q},t.swapAttrs=function(ue,j,q,V){q||(q="x"),V||(V="y");for(var U=0;U<j.length;U++){var $=j[U],ne=t.nestedProperty(ue,$.replace("?",q)),X=t.nestedProperty(ue,$.replace("?",V)),Q=ne.get();ne.set(X.get()),X.set(Q)}},t.raiseToTop=function(j){j.parentNode.appendChild(j)},t.cancelTransition=function(ue){return ue.transition().duration(0)},t.constrain=function(ue,j,q){return j>q?Math.max(q,Math.min(j,ue)):Math.max(j,Math.min(q,ue))},t.bBoxIntersect=function(ue,j,q){return q=q||0,ue.left<=j.right+q&&j.left<=ue.right+q&&ue.top<=j.bottom+q&&j.top<=ue.bottom+q},t.simpleMap=function(ue,j,q,V,U){for(var $=ue.length,ne=new Array($),X=0;X<$;X++)ne[X]=j(ue[X],q,V,U);return ne},t.randstr=function ue(j,q,V,U){if(V||(V=16),q===void 0&&(q=24),q<=0)return"0";var $=Math.log(Math.pow(2,q))/Math.log(V),ne="",X,Q,ie;for(X=2;$===1/0;X*=2)$=Math.log(Math.pow(2,q/X))/Math.log(V)*X;var se=$-Math.floor($);for(X=0;X<Math.floor($);X++)ie=Math.floor(Math.random()*V).toString(V),ne=ie+ne;se&&(Q=Math.pow(V,se),ie=Math.floor(Math.random()*Q).toString(V),ne=ie+ne);var ae=parseInt(ne,V);return j&&j[ne]||ae!==1/0&&ae>=Math.pow(2,q)?U>10?(t.warn("randstr failed uniqueness"),ne):ue(j,q,V,(U||0)+1):ne},t.OptionControl=function(ue,j){ue||(ue={}),j||(j="opt");var q={};return q.optionList=[],q._newoption=function(V){V[j]=ue,q[V.name]=V,q.optionList.push(V)},q["_"+j]=ue,q},t.smooth=function(ue,j){if(j=Math.round(j)||0,j<2)return ue;var q=ue.length,V=2*q,U=2*j-1,$=new Array(U),ne=new Array(q),X,Q,ie,se;for(X=0;X<U;X++)$[X]=(1-Math.cos(Math.PI*(X+1)/j))/(2*j);for(X=0;X<q;X++){for(se=0,Q=0;Q<U;Q++)ie=X+Q+1-j,ie<-q?ie-=V*Math.round(ie/V):ie>=V&&(ie-=V*Math.floor(ie/V)),ie<0?ie=-1-ie:ie>=q&&(ie=V-1-ie),se+=ue[ie]*$[Q];ne[X]=se}return ne},t.syncOrAsync=function(ue,j,q){var V,U;function $(){return t.syncOrAsync(ue,j,q)}for(;ue.length;)if(U=ue.splice(0,1)[0],V=U(j),V&&V.then)return V.then($);return q&&q(j)},t.stripTrailingSlash=function(ue){return ue.substr(-1)==="/"?ue.substr(0,ue.length-1):ue},t.noneOrAll=function(ue,j,q){if(!!ue){var V=!1,U=!0,$,ne;for($=0;$<q.length;$++)ne=ue[q[$]],ne!=null?V=!0:U=!1;if(V&&!U)for($=0;$<q.length;$++)ue[q[$]]=j[q[$]]}},t.mergeArray=function(ue,j,q,V){var U=typeof V=="function";if(t.isArrayOrTypedArray(ue))for(var $=Math.min(ue.length,j.length),ne=0;ne<$;ne++){var X=ue[ne];j[ne][q]=U?V(X):X}},t.mergeArrayCastPositive=function(ue,j,q){return t.mergeArray(ue,j,q,function(V){var U=+V;return isFinite(U)&&U>0?U:0})},t.fillArray=function(ue,j,q,V){if(V=V||t.identity,t.isArrayOrTypedArray(ue))for(var U=0;U<j.length;U++)j[U][q]=V(ue[U])},t.castOption=function(ue,j,q,V){V=V||t.identity;var U=t.nestedProperty(ue,q).get();return t.isArrayOrTypedArray(U)?Array.isArray(j)&&t.isArrayOrTypedArray(U[j[0]])?V(U[j[0]][j[1]]):V(U[j]):U},t.extractOption=function(ue,j,q,V){if(q in ue)return ue[q];var U=t.nestedProperty(j,V).get();if(!Array.isArray(U))return U};function L(ue){var j={};for(var q in ue)for(var V=ue[q],U=0;U<V.length;U++)j[V[U]]=+q;return j}t.tagSelected=function(ue,j,q){var V=j.selectedpoints,U=j._indexToPoints,$;U&&($=L(U));function ne(ae){return ae!==void 0&&ae<ue.length}for(var X=0;X<V.length;X++){var Q=V[X];if(t.isIndex(Q)||t.isArrayOrTypedArray(Q)&&t.isIndex(Q[0])&&t.isIndex(Q[1])){var ie=$?$[Q]:Q,se=q?q[ie]:ie;ne(se)&&(ue[se].selected=1)}}},t.selIndices2selPoints=function(ue){var j=ue.selectedpoints,q=ue._indexToPoints;if(q){for(var V=L(q),U=[],$=0;$<j.length;$++){var ne=j[$];if(t.isIndex(ne)){var X=V[ne];t.isIndex(X)&&U.push(X)}}return U}else return j},t.getTargetArray=function(ue,j){var q=j.target;if(typeof q=="string"&&q){var V=t.nestedProperty(ue,q).get();return Array.isArray(V)?V:!1}else if(Array.isArray(q))return q;return!1},t.minExtend=function(ue,j){var q={};typeof j!="object"&&(j={});var V=3,U=Object.keys(ue),$,ne,X;for($=0;$<U.length;$++)ne=U[$],X=ue[ne],!(ne.charAt(0)==="_"||typeof X=="function")&&(ne==="module"?q[ne]=X:Array.isArray(X)?ne==="colorscale"?q[ne]=X.slice():q[ne]=X.slice(0,V):t.isTypedArray(X)?q[ne]=X.subarray(0,V):X&&typeof X=="object"?q[ne]=t.minExtend(ue[ne],j[ne]):q[ne]=X);for(U=Object.keys(j),$=0;$<U.length;$++)ne=U[$],X=j[ne],(typeof X!="object"||!(ne in q)||typeof q[ne]!="object")&&(q[ne]=X);return q},t.titleCase=function(ue){return ue.charAt(0).toUpperCase()+ue.substr(1)},t.containsAny=function(ue,j){for(var q=0;q<j.length;q++)if(ue.indexOf(j[q])!==-1)return!0;return!1},t.isIE=function(){return typeof window.navigator.msSaveBlob<"u"};var T=/Version\/[\d\.]+.*Safari/;t.isSafari=function(){return T.test(window.navigator.userAgent)};var k=/iPad|iPhone|iPod/;t.isIOS=function(){return k.test(window.navigator.userAgent)};var P=/Firefox\/(\d+)\.\d+/;t.getFirefoxVersion=function(){var ue=P.exec(window.navigator.userAgent);if(ue&&ue.length===2){var j=parseInt(ue[1]);if(!isNaN(j))return j}return null},t.isD3Selection=function(ue){return ue instanceof A.selection},t.ensureSingle=function(ue,j,q,V){var U=ue.select(j+(q?"."+q:""));if(U.size())return U;var $=ue.append(j);return q&&$.classed(q,!0),V&&$.call(V),$},t.ensureSingleById=function(ue,j,q,V){var U=ue.select(j+"#"+q);if(U.size())return U;var $=ue.append(j).attr("id",q);return V&&$.call(V),$},t.objectFromPath=function(ue,j){for(var q=ue.split("."),V,U=V={},$=0;$<q.length;$++){var ne=q[$],X=null,Q=q[$].match(/(.*)\[([0-9]+)\]/);Q?(ne=Q[1],X=Q[2],V=V[ne]=[],$===q.length-1?V[X]=j:V[X]={},V=V[X]):($===q.length-1?V[ne]=j:V[ne]={},V=V[ne])}return U};var z=/^([^\[\.]+)\.(.+)?/,I=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;t.expandObjectPaths=function(ue){var j,q,V,U,$,ne,X;if(typeof ue=="object"&&!Array.isArray(ue))for(q in ue)ue.hasOwnProperty(q)&&((j=q.match(z))?(U=ue[q],V=j[1],delete ue[q],ue[V]=t.extendDeepNoArrays(ue[V]||{},t.objectFromPath(q,t.expandObjectPaths(U))[V])):(j=q.match(I))?(U=ue[q],V=j[1],$=parseInt(j[2]),delete ue[q],ue[V]=ue[V]||[],j[3]==="."?(X=j[4],ne=ue[V][$]=ue[V][$]||{},t.extendDeepNoArrays(ne,t.objectFromPath(X,t.expandObjectPaths(U)))):ue[V][$]=t.expandObjectPaths(U)):ue[q]=t.expandObjectPaths(ue[q]));return ue},t.numSeparate=function(ue,j,q){if(q||(q=!1),typeof j!="string"||j.length===0)throw new Error("Separator string required for formatting!");typeof ue=="number"&&(ue=String(ue));var V=/(\d+)(\d{3})/,U=j.charAt(0),$=j.charAt(1),ne=ue.split("."),X=ne[0],Q=ne.length>1?U+ne[1]:"";if($&&(ne.length>1||X.length>4||q))for(;V.test(X);)X=X.replace(V,"$1"+$+"$2");return X+Q},t.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var D=/^\w*$/;t.templateString=function(ue,j){var q={};return ue.replace(t.TEMPLATE_STRING_REGEX,function(V,U){var $;return D.test(U)?$=j[U]:(q[U]=q[U]||t.nestedProperty(j,U).get,$=q[U]()),t.isValidTextValue($)?$:""})};var R={max:10,count:0,name:"hovertemplate"};t.hovertemplateString=function(){return N.apply(R,arguments)};var O={max:10,count:0,name:"texttemplate"};t.texttemplateString=function(){return N.apply(O,arguments)};var F=/^[:|\|]/;function N(ue,j,q){var V=this,U=arguments;j||(j={});var $={};return ue.replace(t.TEMPLATE_STRING_REGEX,function(ne,X,Q){var ie=X==="xother"||X==="yother",se=X==="_xother"||X==="_yother",ae=X==="_xother_"||X==="_yother_",oe=X==="xother_"||X==="yother_",be=ie||se||oe||ae,ce=X;(se||ae)&&(ce=ce.substring(1)),(oe||ae)&&(ce=ce.substring(0,ce.length-1));var de;if(be){if(de=j[ce],de===void 0)return""}else{var ye,ge;for(ge=3;ge<U.length;ge++)if(ye=U[ge],!!ye){if(ye.hasOwnProperty(ce)){de=ye[ce];break}if(D.test(ce)||(de=t.nestedProperty(ye,ce).get(),de=$[ce]||t.nestedProperty(ye,ce).get(),de&&($[ce]=de)),de!==void 0)break}}if(de===void 0&&V)return V.count<V.max&&(t.warn("Variable '"+ce+"' in "+V.name+" could not be found!"),de=ne),V.count===V.max&&t.warn("Too many "+V.name+" warnings - additional warnings will be suppressed"),V.count++,ne;if(Q){var me;if(Q[0]===":"&&(me=q?q.numberFormat:t.numberFormat,de=me(Q.replace(F,""))(de)),Q[0]==="|"){me=q?q.timeFormat:g;var Ee=t.dateTime2ms(de);de=t.formatDate(Ee,Q.replace(F,""),!1,me)}}else{var Pe=ce+"Label";j.hasOwnProperty(Pe)&&(de=j[Pe])}return be&&(de="("+de+")",(se||ae)&&(de=" "+de),(oe||ae)&&(de=de+" ")),de})}var G=48,K=57;t.subplotSort=function(ue,j){for(var q=Math.min(ue.length,j.length)+1,V=0,U=0,$=0;$<q;$++){var ne=ue.charCodeAt($)||0,X=j.charCodeAt($)||0,Q=ne>=G&&ne<=K,ie=X>=G&&X<=K;if(Q&&(V=10*V+ne-G),ie&&(U=10*U+X-G),!Q||!ie){if(V!==U)return V-U;if(ne!==X)return ne-X}}return U-V};var W=2e9;t.seedPseudoRandom=function(){W=2e9},t.pseudoRandom=function(){var ue=W;return W=(69069*W+1)%4294967296,Math.abs(W-ue)<429496729?t.pseudoRandom():W/4294967296},t.fillText=function(ue,j,q){var V=Array.isArray(q)?function(ne){q.push(ne)}:function(ne){q.text=ne},U=t.extractOption(ue,j,"htx","hovertext");if(t.isValidTextValue(U))return V(U);var $=t.extractOption(ue,j,"tx","text");if(t.isValidTextValue($))return V($)},t.isValidTextValue=function(ue){return ue||ue===0},t.formatPercent=function(ue,j){j=j||0;for(var q=(Math.round(100*ue*Math.pow(10,j))*Math.pow(.1,j)).toFixed(j)+"%",V=0;V<j;V++)q.indexOf(".")!==-1&&(q=q.replace("0%","%"),q=q.replace(".%","%"));return q},t.isHidden=function(ue){var j=window.getComputedStyle(ue).display;return!j||j==="none"},t.strTranslate=function(ue,j){return ue||j?"translate("+ue+","+j+")":""},t.strRotate=function(ue){return ue?"rotate("+ue+")":""},t.strScale=function(ue){return ue!==1?"scale("+ue+")":""},t.getTextTransform=function(ue){var j=ue.noCenter,q=ue.textX,V=ue.textY,U=ue.targetX,$=ue.targetY,ne=ue.anchorX||0,X=ue.anchorY||0,Q=ue.rotate,ie=ue.scale;return ie?ie>1&&(ie=1):ie=0,t.strTranslate(U-ie*(q+ne),$-ie*(V+X))+t.strScale(ie)+(Q?"rotate("+Q+(j?"":" "+q+" "+V)+")":"")},t.setTransormAndDisplay=function(ue,j){ue.attr("transform",t.getTextTransform(j)),ue.style("display",j.scale?null:"none")},t.ensureUniformFontSize=function(ue,j){var q=t.extendFlat({},j);return q.size=Math.max(j.size,ue._fullLayout.uniformtext.minsize||0),q},t.join2=function(ue,j,q){var V=ue.length;return V>1?ue.slice(0,-1).join(j)+q+ue[V-1]:ue.join(j)},t.bigFont=function(ue){return Math.round(1.2*ue)};var Y=t.getFirefoxVersion(),re=Y!==null&&Y<86;t.getPositionFromD3Event=function(){return re?[A.event.layerX,A.event.layerY]:[A.event.offsetX,A.event.offsetY]}},{"../constants/numerical":491,"./anchor_utils":495,"./angles":496,"./array":497,"./clean_number":498,"./clear_responsive":500,"./coerce":501,"./dates":502,"./dom":503,"./extend":505,"./filter_unique":506,"./filter_visible":507,"./geometry2d":510,"./identity":513,"./increment":514,"./is_plain_object":516,"./keyed_container":517,"./localize":518,"./loggers":519,"./make_trace_groups":520,"./matrix":521,"./mod":522,"./nested_property":523,"./noop":524,"./notifier":525,"./preserve_drawing_buffer":529,"./push_unique":530,"./regex":532,"./relative_attr":533,"./relink_private":534,"./search":535,"./sort_object_keys":538,"./stats":539,"./throttle":542,"./to_log_range":543,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],516:[function(d,ee,te){ee.exports=function(g){return window&&window.process&&window.process.versions?Object.prototype.toString.call(g)==="[object Object]":Object.prototype.toString.call(g)==="[object Object]"&&Object.getPrototypeOf(g).hasOwnProperty("hasOwnProperty")}},{}],517:[function(d,ee,te){var A=d("./nested_property"),g=/^\w*$/,S=0,M=1,e=2,a=3,n=4;ee.exports=function(t,c,s,i){s=s||"name",i=i||"value";var x,p,v,f={};c&&c.length?(v=A(t,c),p=v.get()):p=t,c=c||"";var y={};if(p)for(x=0;x<p.length;x++)y[p[x][s]]=x;var o=g.test(i),m={set:function(l,w){var _=w===null?n:S;if(!p){if(!v||_===n)return;p=[],v.set(p)}var h=y[l];if(h===void 0){if(_===n)return;_=_|a,h=p.length,y[l]=h}else w!==(o?p[h][i]:A(p[h],i).get())&&(_=_|e);var b=p[h]=p[h]||{};return b[s]=l,o?b[i]=w:A(b,i).set(w),w!==null&&(_=_&~n),f[h]=f[h]|_,m},get:function(l){if(!!p){var w=y[l];if(w!==void 0)return o?p[w][i]:A(p[w],i).get()}},rename:function(l,w){var _=y[l];return _===void 0||(f[_]=f[_]|M,y[w]=_,delete y[l],p[_][s]=w),m},remove:function(l){var w=y[l];if(w===void 0)return m;var _=p[w];if(Object.keys(_).length>2)return f[w]=f[w]|e,m.set(l,null);if(o){for(x=w;x<p.length;x++)f[x]=f[x]|a;for(x=w;x<p.length;x++)y[p[x][s]]--;p.splice(w,1),delete y[l]}else A(_,i).set(null),f[w]=f[w]|e|n;return m},constructUpdate:function(){for(var l,w,_={},h=Object.keys(f),b=0;b<h.length;b++)w=h[b],l=c+"["+w+"]",p[w]?(f[w]&M&&(_[l+"."+s]=p[w][s]),f[w]&e&&(o?_[l+"."+i]=f[w]&n?null:p[w][i]:_[l+"."+i]=f[w]&n?null:A(p[w],i).get())):_[l]=null;return _}};return m}},{"./nested_property":523}],518:[function(d,ee,te){var A=d("../registry");ee.exports=function(S,M){for(var e=S._context.locale,a=0;a<2;a++){for(var n=S._context.locales,r=0;r<2;r++){var t=(n[e]||{}).dictionary;if(t){var c=t[M];if(c)return c}n=A.localeRegistry}var s=e.split("-")[0];if(s===e)break;e=s}return M}},{"../registry":647}],519:[function(d,ee,te){var A=d("../plot_api/plot_config").dfltConfig,g=d("./notifier"),S=ee.exports={};S.log=function(){var M;if(A.logging>1){var e=["LOG:"];for(M=0;M<arguments.length;M++)e.push(arguments[M]);console.trace.apply(console,e)}if(A.notifyOnLogging>1){var a=[];for(M=0;M<arguments.length;M++)a.push(arguments[M]);g(a.join("<br>"),"long")}},S.warn=function(){var M;if(A.logging>0){var e=["WARN:"];for(M=0;M<arguments.length;M++)e.push(arguments[M]);console.trace.apply(console,e)}if(A.notifyOnLogging>0){var a=[];for(M=0;M<arguments.length;M++)a.push(arguments[M]);g(a.join("<br>"),"stick")}},S.error=function(){var M;if(A.logging>0){var e=["ERROR:"];for(M=0;M<arguments.length;M++)e.push(arguments[M]);console.error.apply(console,e)}if(A.notifyOnLogging>0){var a=[];for(M=0;M<arguments.length;M++)a.push(arguments[M]);g(a.join("<br>"),"stick")}}},{"../plot_api/plot_config":553,"./notifier":525}],520:[function(d,ee,te){var A=d("@plotly/d3");ee.exports=function(S,M,e){var a=S.selectAll("g."+e.replace(/\s/g,".")).data(M,function(r){return r[0].trace.uid});a.exit().remove(),a.enter().append("g").attr("class",e),a.order();var n=S.classed("rangeplot")?"nodeRangePlot3":"node3";return a.each(function(r){r[0][n]=A.select(this)}),a}},{"@plotly/d3":58}],521:[function(d,ee,te){var A=d("gl-mat4");te.init2dArray=function(g,S){for(var M=new Array(g),e=0;e<g;e++)M[e]=new Array(S);return M},te.transposeRagged=function(g){var S=0,M=g.length,e,a;for(e=0;e<M;e++)S=Math.max(S,g[e].length);var n=new Array(S);for(e=0;e<S;e++)for(n[e]=new Array(M),a=0;a<M;a++)n[e][a]=g[a][e];return n},te.dot=function(g,S){if(!(g.length&&S.length)||g.length!==S.length)return null;var M=g.length,e,a;if(g[0].length)for(e=new Array(M),a=0;a<M;a++)e[a]=te.dot(g[a],S);else if(S[0].length){var n=te.transposeRagged(S);for(e=new Array(n.length),a=0;a<n.length;a++)e[a]=te.dot(g,n[a])}else for(e=0,a=0;a<M;a++)e+=g[a]*S[a];return e},te.translationMatrix=function(g,S){return[[1,0,g],[0,1,S],[0,0,1]]},te.rotationMatrix=function(g){var S=g*Math.PI/180;return[[Math.cos(S),-Math.sin(S),0],[Math.sin(S),Math.cos(S),0],[0,0,1]]},te.rotationXYMatrix=function(g,S,M){return te.dot(te.dot(te.translationMatrix(S,M),te.rotationMatrix(g)),te.translationMatrix(-S,-M))},te.apply3DTransform=function(g){return function(){var S=arguments,M=arguments.length===1?S[0]:[S[0],S[1],S[2]||0];return te.dot(g,[M[0],M[1],M[2],1]).slice(0,3)}},te.apply2DTransform=function(g){return function(){var S=arguments;S.length===3&&(S=S[0]);var M=arguments.length===1?S[0]:[S[0],S[1]];return te.dot(g,[M[0],M[1],1]).slice(0,2)}},te.apply2DTransform2=function(g){var S=te.apply2DTransform(g);return function(M){return S(M.slice(0,2)).concat(S(M.slice(2,4)))}},te.convertCssMatrix=function(g){if(g){var S=g.length;if(S===16)return g;if(S===6)return[g[0],g[1],0,0,g[2],g[3],0,0,0,0,1,0,g[4],g[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},te.inverseTransformMatrix=function(g){var S=[];return A.invert(S,g),[[S[0],S[1],S[2],S[3]],[S[4],S[5],S[6],S[7]],[S[8],S[9],S[10],S[11]],[S[12],S[13],S[14],S[15]]]}},{"gl-mat4":210}],522:[function(d,ee,te){function A(S,M){var e=S%M;return e<0?e+M:e}function g(S,M){return Math.abs(S)>M/2?S-Math.round(S/M)*M:S}ee.exports={mod:A,modHalf:g}},{}],523:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("./array").isArrayOrTypedArray;ee.exports=function(i,x){if(A(x))x=String(x);else if(typeof x!="string"||x.substr(x.length-4)==="[-1]")throw"bad property string";for(var p=0,v=x.split("."),f,y,o;p<v.length;){if(f=String(v[p]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/),f){if(f[1])v[p]=f[1];else if(p===0)v.splice(0,1);else throw"bad property string";for(y=f[2].substr(1,f[2].length-2).split("]["),o=0;o<y.length;o++)p++,v.splice(p,0,Number(y[o]))}p++}return typeof i!="object"?c(i,x,v):{set:a(i,v,x),get:S(i,v),astr:x,parts:v,obj:i}};function S(s,i){return function(){var x=s,p,v,f,y,o;for(y=0;y<i.length-1;y++){if(p=i[y],p===-1){for(v=!0,f=[],o=0;o<x.length;o++)f[o]=S(x[o],i.slice(y+1))(),f[o]!==f[0]&&(v=!1);return v?f[0]:f}if(typeof p=="number"&&!g(x)||(x=x[p],typeof x!="object"||x===null))return}if(!(typeof x!="object"||x===null)&&(f=x[i[y]],f!==null))return f}}var M=/(^|\.)args\[/;function e(s,i){return s===void 0||s===null&&!i.match(M)}function a(s,i,x){return function(p){var v=s,f="",y=e(p,x),o,m;for(m=0;m<i.length-1;m++){if(o=i[m],typeof o=="number"&&!g(v))throw"array index but container is not an array";if(o===-1){if(y=!r(v,i.slice(m+1),p,x),y)break;return}if(!t(v,o,i[m+1],y))break;if(v=v[o],typeof v!="object"||v===null)throw"container is not an object";f=n(f,o)}if(y){if(m===i.length-1&&(delete v[i[m]],Array.isArray(v)&&+i[m]===v.length-1))for(;v.length&&v[v.length-1]===void 0;)v.pop()}else v[i[m]]=p}}function n(s,i){var x=i;return A(i)?x="["+i+"]":s&&(x="."+i),s+x}function r(s,i,x,p){var v=g(x),f=!0,y=x,o=p.replace("-1",0),m=v?!1:e(x,o),l=i[0],w;for(w=0;w<s.length;w++)o=p.replace("-1",w),v&&(y=x[w%x.length],m=e(y,o)),m&&(f=!1),t(s,w,l,m)&&a(s[w],i,p.replace("-1",w))(y);return f}function t(s,i,x,p){if(s[i]===void 0){if(p)return!1;typeof x=="number"?s[i]=[]:s[i]={}}return!0}function c(s,i,x){return{set:function(){throw"bad container"},get:function(){},astr:i,parts:x,obj:s}}},{"./array":497,"fast-isnumeric":190}],524:[function(d,ee,te){ee.exports=function(){}},{}],525:[function(d,ee,te){var A=d("@plotly/d3"),g=d("fast-isnumeric"),S=[];ee.exports=function(M,e){if(S.indexOf(M)!==-1)return;S.push(M);var a=1e3;g(e)?a=e:e==="long"&&(a=3e3);var n=A.select("body").selectAll(".plotly-notifier").data([0]);n.enter().append("div").classed("plotly-notifier",!0);var r=n.selectAll(".notifier-note").data(S);function t(c){c.duration(700).style("opacity",0).each("end",function(s){var i=S.indexOf(s);i!==-1&&S.splice(i,1),A.select(this).remove()})}r.enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(c){var s=A.select(this);s.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){s.transition().call(t)});for(var i=s.append("p"),x=c.split(/<br\s*\/?>/g),p=0;p<x.length;p++)p&&i.append("br"),i.append("span").text(x[p]);e==="stick"?s.transition().duration(350).style("opacity",1):s.transition().duration(700).style("opacity",1).transition().delay(a).call(t)})}},{"@plotly/d3":58,"fast-isnumeric":190}],526:[function(d,ee,te){var A=d("./setcursor"),g="data-savedcursor",S="!!";ee.exports=function(e,a){var n=e.attr(g);if(a){if(!n){for(var r=(e.attr("class")||"").split(" "),t=0;t<r.length;t++){var c=r[t];c.indexOf("cursor-")===0&&e.attr(g,c.substr(7)).classed(c,!1)}e.attr(g)||e.attr(g,S)}A(e,a)}else n&&(e.attr(g,null),n===S?A(e):A(e,n))}},{"./setcursor":536}],527:[function(d,ee,te){var A=d("./matrix").dot,g=d("../constants/numerical").BADNUM,S=ee.exports={};S.tester=function(e){var a=e.slice(),n=a[0][0],r=n,t=a[0][1],c=t,s;for((a[a.length-1][0]!==a[0][0]||a[a.length-1][1]!==a[0][1])&&a.push(a[0]),s=1;s<a.length;s++)n=Math.min(n,a[s][0]),r=Math.max(r,a[s][0]),t=Math.min(t,a[s][1]),c=Math.max(c,a[s][1]);var i=!1,x;a.length===5&&(a[0][0]===a[1][0]?a[2][0]===a[3][0]&&a[0][1]===a[3][1]&&a[1][1]===a[2][1]&&(i=!0,x=function(o){return o[0]===a[0][0]}):a[0][1]===a[1][1]&&a[2][1]===a[3][1]&&a[0][0]===a[3][0]&&a[1][0]===a[2][0]&&(i=!0,x=function(o){return o[1]===a[0][1]}));function p(o,m){var l=o[0],w=o[1];return!(l===g||l<n||l>r||w===g||w<t||w>c||m&&x(o))}function v(o,m){var l=o[0],w=o[1];if(l===g||l<n||l>r||w===g||w<t||w>c)return!1;var _=a.length,h=a[0][0],b=a[0][1],u=0,L,T,k,P,z;for(L=1;L<_;L++)if(T=h,k=b,h=a[L][0],b=a[L][1],P=Math.min(T,h),!(l<P||l>Math.max(T,h)||w>Math.max(k,b)))if(w<Math.min(k,b))l!==P&&u++;else{if(h===T?z=w:z=k+(l-T)*(b-k)/(h-T),w===z)return!(L===1&&m);w<=z&&l!==P&&u++}return u%2===1}var f=!0,y=a[0];for(s=1;s<a.length;s++)if(y[0]!==a[s][0]||y[1]!==a[s][1]){f=!1;break}return{xmin:n,xmax:r,ymin:t,ymax:c,pts:a,contains:i?p:v,isRect:i,degenerate:f}},S.isSegmentBent=function(e,a,n,r){var t=e[a],c=[e[n][0]-t[0],e[n][1]-t[1]],s=A(c,c),i=Math.sqrt(s),x=[-c[1]/i,c[0]/i],p,v,f;for(p=a+1;p<n;p++)if(v=[e[p][0]-t[0],e[p][1]-t[1]],f=A(v,c),f<0||f>s||Math.abs(A(v,x))>r)return!0;return!1},S.filter=function(e,a){var n=[e[0]],r=0,t=0;function c(i){e.push(i);var x=n.length,p=r;n.splice(t+1);for(var v=p+1;v<e.length;v++)(v===e.length-1||S.isSegmentBent(e,p,v+1,a))&&(n.push(e[v]),n.length<x-2&&(r=v,t=n.length-1),p=v)}if(e.length>1){var s=e.pop();c(s)}return{addPt:c,raw:e,filtered:n}}},{"../constants/numerical":491,"./matrix":521}],528:[function(d,ee,te){(function(A){(function(){var g=d("./show_no_webgl_msg"),S=d("regl");ee.exports=function(e,a,n){var r=e._fullLayout,t=!0;return r._glcanvas.each(function(c){if(c.regl){c.regl.preloadCachedCode(n);return}if(!(c.pick&&!r._has("parcoords"))){try{c.regl=S({canvas:this,attributes:{antialias:!c.pick,preserveDrawingBuffer:!0},pixelRatio:e._context.plotGlPixelRatio||A.devicePixelRatio,extensions:a||[],cachedCode:n||{}})}catch{t=!1}c.regl||(t=!1),t&&this.addEventListener("webglcontextlost",function(s){e&&e.emit&&e.emit("plotly_webglcontextlost",{event:s,layer:c.key})},!1)}}),t||g({container:r._glcontainer.node()}),t}}).call(this)}).call(this,typeof Mo<"u"?Mo:typeof self<"u"?self:typeof window<"u"?window:{})},{"./show_no_webgl_msg":537,regl:284}],529:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("is-mobile");ee.exports=function(e){var a;if(e&&e.hasOwnProperty("userAgent")?a=e.userAgent:a=S(),typeof a!="string")return!0;var n=g({ua:{headers:{"user-agent":a}},tablet:!0,featureDetect:!1});if(!n)for(var r=a.split(" "),t=1;t<r.length;t++){var c=r[t];if(c.indexOf("Safari")!==-1)for(var s=t-1;s>-1;s--){var i=r[s];if(i.substr(0,8)==="Version/"){var x=i.substr(8).split(".")[0];if(A(x)&&(x=+x),x>=13)return!0}}}return n};function S(){var M;return typeof navigator<"u"&&(M=navigator.userAgent),M&&M.headers&&typeof M.headers["user-agent"]=="string"&&(M=M.headers["user-agent"]),M}},{"fast-isnumeric":190,"is-mobile":234}],530:[function(d,ee,te){ee.exports=function(g,S){if(S instanceof RegExp){for(var M=S.toString(),e=0;e<g.length;e++)if(g[e]instanceof RegExp&&g[e].toString()===M)return g;g.push(S)}else(S||S===0)&&g.indexOf(S)===-1&&g.push(S);return g}},{}],531:[function(d,ee,te){var A=d("../lib"),g=d("../plot_api/plot_config").dfltConfig;function S(e,a){for(var n=[],r,t=0;t<a.length;t++)r=a[t],r===e?n[t]=r:typeof r=="object"?n[t]=Array.isArray(r)?A.extendDeep([],r):A.extendDeepAll({},r):n[t]=r;return n}var M={};M.add=function(e,a,n,r,t){var c,s;if(e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},s=e.undoQueue.index,e.autoplay){e.undoQueue.inSequence||(e.autoplay=!1);return}!e.undoQueue.sequence||e.undoQueue.beginSequence?(c={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},e.undoQueue.queue.splice(s,e.undoQueue.queue.length-s,c),e.undoQueue.index+=1):c=e.undoQueue.queue[s-1],e.undoQueue.beginSequence=!1,c&&(c.undo.calls.unshift(a),c.undo.args.unshift(n),c.redo.calls.push(r),c.redo.args.push(t)),e.undoQueue.queue.length>g.queueLength&&(e.undoQueue.queue.shift(),e.undoQueue.index--)},M.startSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!0,e.undoQueue.beginSequence=!0},M.stopSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!1,e.undoQueue.beginSequence=!1},M.undo=function(a){var n,r;if(!(a.undoQueue===void 0||isNaN(a.undoQueue.index)||a.undoQueue.index<=0)){for(a.undoQueue.index--,n=a.undoQueue.queue[a.undoQueue.index],a.undoQueue.inSequence=!0,r=0;r<n.undo.calls.length;r++)M.plotDo(a,n.undo.calls[r],n.undo.args[r]);a.undoQueue.inSequence=!1,a.autoplay=!1}},M.redo=function(a){var n,r;if(!(a.undoQueue===void 0||isNaN(a.undoQueue.index)||a.undoQueue.index>=a.undoQueue.queue.length)){for(n=a.undoQueue.queue[a.undoQueue.index],a.undoQueue.inSequence=!0,r=0;r<n.redo.calls.length;r++)M.plotDo(a,n.redo.calls[r],n.redo.args[r]);a.undoQueue.inSequence=!1,a.autoplay=!1,a.undoQueue.index++}},M.plotDo=function(e,a,n){e.autoplay=!0,n=S(e,n),a.apply(null,n)},ee.exports=M},{"../lib":515,"../plot_api/plot_config":553}],532:[function(d,ee,te){te.counter=function(A,g,S,M){var e=(g||"")+(S?"":"$"),a=M===!1?"":"^";return A==="xy"?new RegExp(a+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(a+A+"([2-9]|[1-9][0-9]+)?"+e)}},{}],533:[function(d,ee,te){var A=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,g=/^[^\.\[\]]+$/;ee.exports=function(S,M){for(;M;){var e=S.match(A);if(e)S=e[1];else if(S.match(g))S="";else throw new Error("bad relativeAttr call:"+[S,M]);if(M.charAt(0)==="^")M=M.slice(1);else break}return S&&M.charAt(0)!=="["?S+"."+M:S+M}},{}],534:[function(d,ee,te){var A=d("./array").isArrayOrTypedArray,g=d("./is_plain_object");ee.exports=function S(M,e){for(var a in e){var n=e[a],r=M[a];if(r!==n)if(a.charAt(0)==="_"||typeof n=="function"){if(a in M)continue;M[a]=n}else if(A(n)&&A(r)&&g(n[0])){if(a==="customdata"||a==="ids")continue;for(var t=Math.min(n.length,r.length),c=0;c<t;c++)r[c]!==n[c]&&g(n[c])&&g(r[c])&&S(r[c],n[c])}else g(n)&&g(r)&&(S(r,n),Object.keys(r).length||delete M[a])}}},{"./array":497,"./is_plain_object":516}],535:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("./loggers"),S=d("./identity"),M=d("../constants/numerical").BADNUM,e=1e-9;te.findBin=function(c,s,i){if(A(s.start))return i?Math.ceil((c-s.start)/s.size-e)-1:Math.floor((c-s.start)/s.size+e);var x=0,p=s.length,v=0,f=p>1?(s[p-1]-s[0])/(p-1):1,y,o;for(f>=0?o=i?a:n:o=i?t:r,c+=f*e*(i?-1:1)*(f>=0?1:-1);x<p&&v++<100;)y=Math.floor((x+p)/2),o(s[y],c)?x=y+1:p=y;return v>90&&g.log("Long binary search..."),x-1};function a(c,s){return c<s}function n(c,s){return c<=s}function r(c,s){return c>s}function t(c,s){return c>=s}te.sorterAsc=function(c,s){return c-s},te.sorterDes=function(c,s){return s-c},te.distinctVals=function(c){var s=c.slice();s.sort(te.sorterAsc);var i;for(i=s.length-1;i>-1&&s[i]===M;i--);for(var x=s[i]-s[0]||1,p=x/(i||1)/1e4,v=[],f,y=0;y<=i;y++){var o=s[y],m=o-f;f===void 0?(v.push(o),f=o):m>p&&(x=Math.min(x,m),v.push(o),f=o)}return{vals:v,minDiff:x}},te.roundUp=function(c,s,i){for(var x=0,p=s.length-1,v,f=0,y=i?0:1,o=i?1:0,m=i?Math.ceil:Math.floor;x<p&&f++<100;)v=m((x+p)/2),s[v]<=c?x=v+y:p=v-o;return s[x]},te.sort=function(c,s){for(var i=0,x=0,p=1;p<c.length;p++){var v=s(c[p],c[p-1]);if(v<0?i=1:v>0&&(x=1),i&&x)return c.sort(s)}return x?c:c.reverse()},te.findIndexOfMin=function(c,s){s=s||S;for(var i=1/0,x,p=0;p<c.length;p++){var v=s(c[p]);v<i&&(i=v,x=p)}return x}},{"../constants/numerical":491,"./identity":513,"./loggers":519,"fast-isnumeric":190}],536:[function(d,ee,te){ee.exports=function(g,S){(g.attr("class")||"").split(" ").forEach(function(M){M.indexOf("cursor-")===0&&g.classed(M,!1)}),S&&g.classed("cursor-"+S,!0)}},{}],537:[function(d,ee,te){var A=d("../components/color"),g=function(){};ee.exports=function(M){for(var e in M)typeof M[e]=="function"&&(M[e]=g);M.destroy=function(){M.container.parentNode.removeChild(M.container)};var a=document.createElement("div");a.className="no-webgl",a.style.cursor="pointer",a.style.fontSize="24px",a.style.color=A.defaults[0],a.style.position="absolute",a.style.left=a.style.top="0px",a.style.width=a.style.height="100%",a.style["background-color"]=A.lightLine,a.style["z-index"]=30;var n=document.createElement("p");return n.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",n.style.position="relative",n.style.top="50%",n.style.left="50%",n.style.height="30%",n.style.width="50%",n.style.margin="-15% 0 0 -25%",a.appendChild(n),M.container.appendChild(a),M.container.style.background="#FFFFFF",M.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":367}],538:[function(d,ee,te){ee.exports=function(g){return Object.keys(g).sort()}},{}],539:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("./array").isArrayOrTypedArray;te.aggNums=function(S,M,e,a){var n,r;if((!a||a>e.length)&&(a=e.length),A(M)||(M=!1),g(e[0])){for(r=new Array(a),n=0;n<a;n++)r[n]=te.aggNums(S,M,e[n]);e=r}for(n=0;n<a;n++)A(M)?A(e[n])&&(M=S(+M,+e[n])):M=e[n];return M},te.len=function(S){return te.aggNums(function(M){return M+1},0,S)},te.mean=function(S,M){return M||(M=te.len(S)),te.aggNums(function(e,a){return e+a},0,S)/M},te.midRange=function(S){if(!(S===void 0||S.length===0))return(te.aggNums(Math.max,null,S)+te.aggNums(Math.min,null,S))/2},te.variance=function(S,M,e){return M||(M=te.len(S)),A(e)||(e=te.mean(S,M)),te.aggNums(function(a,n){return a+Math.pow(n-e,2)},0,S)/M},te.stdev=function(S,M,e){return Math.sqrt(te.variance(S,M,e))},te.median=function(S){var M=S.slice().sort();return te.interp(M,.5)},te.interp=function(S,M){if(!A(M))throw"n should be a finite number";if(M=M*S.length-.5,M<0)return S[0];if(M>S.length-1)return S[S.length-1];var e=M%1;return e*S[Math.ceil(M)]+(1-e)*S[Math.floor(M)]}},{"./array":497,"fast-isnumeric":190}],540:[function(d,ee,te){var A=d("color-normalize");function g(S){return S?A(S):[0,0,0,1]}ee.exports=g},{"color-normalize":89}],541:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../lib"),S=g.strTranslate,M=d("../constants/xmlns_namespaces"),e=d("../constants/alignment").LINE_SPACING,a=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;te.convertToTspans=function(F,N,G){var K=F.text(),W=!F.attr("data-notex")&&N&&N._context.typesetMath&&typeof MathJax<"u"&&K.match(a),Y=A.select(F.node().parentNode);if(Y.empty())return;var re=F.attr("class")?F.attr("class").split(" ")[0]:"text";re+="-math",Y.selectAll("svg."+re).remove(),Y.selectAll("g."+re+"-group").remove(),F.style("display",null).attr({"data-unformatted":K,"data-math":"N"});function ue(){Y.empty()||(re=F.attr("class")+"-math",Y.select("svg."+re).remove()),F.text("").style("white-space","pre");var j=I(F.node(),K);j&&F.style("pointer-events","all"),te.positionText(F),G&&G.call(F)}return W?(N&&N._promises||[]).push(new Promise(function(j){F.style("display","none");var q=parseInt(F.node().style.fontSize,10),V={fontSize:q};s(W[2],V,function(U,$,ne){Y.selectAll("svg."+re).remove(),Y.selectAll("g."+re+"-group").remove();var X=U&&U.select("svg");if(!X||!X.node()){ue(),j();return}var Q=Y.append("g").classed(re+"-group",!0).attr({"pointer-events":"none","data-unformatted":K,"data-math":"Y"});Q.node().appendChild(X.node()),$&&$.node()&&X.node().insertBefore($.node().cloneNode(!0),X.node().firstChild);var ie=ne.width,se=ne.height;X.attr({class:re,height:se,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var ae=F.node().style.fill||"black",oe=X.select("g");oe.attr({fill:ae,stroke:ae});var be=oe.node().getBoundingClientRect(),ce=be.width,de=be.height;(ce>ie||de>se)&&(X.style("overflow","hidden"),be=X.node().getBoundingClientRect(),ce=be.width,de=be.height);var ye=+F.attr("x"),ge=+F.attr("y"),me=q||F.node().getBoundingClientRect().height,Ee=-me/4;if(re[0]==="y")Q.attr({transform:"rotate("+[-90,ye,ge]+")"+S(-ce/2,Ee-de/2)});else if(re[0]==="l")ge=Ee-de/2;else if(re[0]==="a"&&re.indexOf("atitle")!==0)ye=0,ge=Ee;else{var Pe=F.attr("text-anchor");ye=ye-ce*(Pe==="middle"?.5:Pe==="end"?1:0),ge=ge+Ee-de/2}X.attr({x:ye,y:ge}),G&&G.call(F,Q),j(Q)})})):ue(),F};var n=/(<|&lt;|&#60;)/g,r=/(>|&gt;|&#62;)/g;function t(F){return F.replace(n,"\\lt ").replace(r,"\\gt ")}var c=[["$","$"],["\\(","\\)"]];function s(F,N,G){var K=parseInt((MathJax.version||"").split(".")[0]);if(K!==2&&K!==3){g.warn("No MathJax version:",MathJax.version);return}var W,Y,re,ue,j=function(){return Y=g.extendDeepAll({},MathJax.Hub.config),re=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:c},displayAlign:"left"})},q=function(){Y=g.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=c},V=function(){if(W=MathJax.Hub.config.menuSettings.renderer,W!=="SVG")return MathJax.Hub.setRenderer("SVG")},U=function(){W=MathJax.config.startup.output,W!=="svg"&&(MathJax.config.startup.output="svg")},$=function(){var ae="math-output-"+g.randstr({},64);ue=A.select("body").append("div").attr({id:ae}).style({visibility:"hidden",position:"absolute","font-size":N.fontSize+"px"}).text(t(F));var oe=ue.node();return K===2?MathJax.Hub.Typeset(oe):MathJax.typeset([oe])},ne=function(){var ae=ue.select(K===2?".MathJax_SVG":".MathJax"),oe=!ae.empty()&&ue.select("svg").node();if(!oe)g.log("There was an error in the tex syntax.",F),G();else{var be=oe.getBoundingClientRect(),ce;K===2?ce=A.select("body").select("#MathJax_SVG_glyphs"):ce=ae.select("defs"),G(ae,ce,be)}ue.remove()},X=function(){if(W!=="SVG")return MathJax.Hub.setRenderer(W)},Q=function(){W!=="svg"&&(MathJax.config.startup.output=W)},ie=function(){return re!==void 0&&(MathJax.Hub.processSectionDelay=re),MathJax.Hub.Config(Y)},se=function(){MathJax.config=Y};K===2?MathJax.Hub.Queue(j,V,$,ne,X,ie):K===3&&(q(),U(),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){$(),ne(),Q(),se()}))}var i={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},x={sub:"0.3em",sup:"-0.6em"},p={sub:"-0.21em",sup:"0.42em"},v="\u200B",f=["http:","https:","mailto:","",void 0,":"],y=te.NEWLINES=/(\r\n?|\n)/g,o=/(<[^<>]*>)/,m=/<(\/?)([^ >]*)(\s+(.*))?>/i,l=/<br(\s+.*)?>/i;te.BR_TAG_ALL=/<br(\s+.*)?>/gi;var w=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,_=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,h=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,b=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function u(F,N){if(!F)return null;var G=F.match(N),K=G&&(G[3]||G[4]);return K&&P(K)}var L=/(^|;)\s*color:/;te.plainText=function(F,N){N=N||{};for(var G=N.len!==void 0&&N.len!==-1?N.len:1/0,K=N.allowedTags!==void 0?N.allowedTags:["br"],W="...",Y=W.length,re=F.split(o),ue=[],j="",q=0,V=0;V<re.length;V++){var U=re[V],$=U.match(m),ne=$&&$[2].toLowerCase();if(ne)K.indexOf(ne)!==-1&&(ue.push(U),j=ne);else{var X=U.length;if(q+X<G)ue.push(U),q+=X;else if(q<G){var Q=G-q;j&&(j!=="br"||Q<=Y||X<=Y)&&ue.pop(),G>Y?ue.push(U.substr(0,Q-Y)+W):ue.push(U.substr(0,Q));break}j=""}}return ue.join("")};var T={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},k=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function P(F){return F.replace(k,function(N,G){var K;return G.charAt(0)==="#"?K=z(G.charAt(1)==="x"?parseInt(G.substr(2),16):parseInt(G.substr(1),10)):K=T[G],K||N})}te.convertEntities=P;function z(F){if(!(F>1114111)){var N=String.fromCodePoint;if(N)return N(F);var G=String.fromCharCode;return F<=65535?G(F):G((F>>10)+55232,F%1024+56320)}}function I(F,N){N=N.replace(y," ");var G=!1,K=[],W,Y=-1;function re(){Y++;var de=document.createElementNS(M.svg,"tspan");A.select(de).attr({class:"line",dy:Y*e+"em"}),F.appendChild(de),W=de;var ye=K;if(K=[{node:de}],ye.length>1)for(var ge=1;ge<ye.length;ge++)ue(ye[ge])}function ue(de){var ye=de.type,ge={},me;if(ye==="a"){me="a";var Ee=de.target,Pe=de.href,Ne=de.popup;Pe&&(ge={"xlink:xlink:show":Ee==="_blank"||Ee.charAt(0)!=="_"?"new":"replace",target:Ee,"xlink:xlink:href":Pe},Ne&&(ge.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Ne+'");return false;'))}else me="tspan";de.style&&(ge.style=de.style);var we=document.createElementNS(M.svg,me);if(ye==="sup"||ye==="sub"){j(W,v),W.appendChild(we);var ke=document.createElementNS(M.svg,"tspan");j(ke,v),A.select(ke).attr("dy",p[ye]),ge.dy=x[ye],W.appendChild(we),W.appendChild(ke)}else W.appendChild(we);A.select(we).attr(ge),W=de.node=we,K.push(de)}function j(de,ye){de.appendChild(document.createTextNode(ye))}function q(de){if(K.length===1){g.log("Ignoring unexpected end tag </"+de+">.",N);return}var ye=K.pop();de!==ye.type&&g.log("Start tag <"+ye.type+"> doesnt match end tag <"+de+">. Pretending it did match.",N),W=K[K.length-1].node}var V=l.test(N);V?re():(W=F,K=[{node:F}]);for(var U=N.split(o),$=0;$<U.length;$++){var ne=U[$],X=ne.match(m),Q=X&&X[2].toLowerCase(),ie=i[Q];if(Q==="br")re();else if(ie===void 0)j(W,P(ne));else if(X[1])q(Q);else{var se=X[4],ae={type:Q},oe=u(se,w);if(oe?(oe=oe.replace(L,"$1 fill:"),ie&&(oe+=";"+ie)):ie&&(oe=ie),oe&&(ae.style=oe),Q==="a"){G=!0;var be=u(se,_);if(be){var ce=D(be);ce&&(ae.href=ce,ae.target=u(se,h)||"_blank",ae.popup=u(se,b))}}ue(ae)}}return G}function D(F){var N=encodeURI(decodeURI(F)),G=document.createElement("a"),K=document.createElement("a");G.href=F,K.href=N;var W=G.protocol,Y=K.protocol;return f.indexOf(W)!==-1&&f.indexOf(Y)!==-1?N:""}te.sanitizeHTML=function(N){N=N.replace(y," ");for(var G=document.createElement("p"),K=G,W=[],Y=N.split(o),re=0;re<Y.length;re++){var ue=Y[re],j=ue.match(m),q=j&&j[2].toLowerCase();if(q in i)if(j[1])W.length&&(K=W.pop());else{var V=j[4],U=u(V,w),$=U?{style:U}:{};if(q==="a"){var ne=u(V,_);if(ne){var X=D(ne);if(X){$.href=X;var Q=u(V,h);Q&&($.target=Q)}}}var ie=document.createElement(q);K.appendChild(ie),A.select(ie).attr($),K=ie,W.push(ie)}else K.appendChild(document.createTextNode(P(ue)))}var se="innerHTML";return G[se]},te.lineCount=function(N){return N.selectAll("tspan.line").size()||1},te.positionText=function(N,G,K){return N.each(function(){var W=A.select(this);function Y(j,q){return q===void 0?(q=W.attr(j),q===null&&(W.attr(j,0),q=0)):W.attr(j,q),q}var re=Y("x",G),ue=Y("y",K);this.nodeName==="text"&&W.selectAll("tspan.line").attr({x:re,y:ue})})};function R(F,N,G){var K=G.horizontalAlign,W=G.verticalAlign||"top",Y=F.node().getBoundingClientRect(),re=N.node().getBoundingClientRect(),ue,j,q;return W==="bottom"?j=function(){return Y.bottom-ue.height}:W==="middle"?j=function(){return Y.top+(Y.height-ue.height)/2}:j=function(){return Y.top},K==="right"?q=function(){return Y.right-ue.width}:K==="center"?q=function(){return Y.left+(Y.width-ue.width)/2}:q=function(){return Y.left},function(){ue=this.node().getBoundingClientRect();var V=q()-re.left,U=j()-re.top,$=G.gd||{};if(G.gd){$._fullLayout._calcInverseTransform($);var ne=g.apply3DTransform($._fullLayout._invTransform)(V,U);V=ne[0],U=ne[1]}return this.style({top:U+"px",left:V+"px","z-index":1e3}),this}}var O="1px ";te.makeTextShadow=function(F){var N=O,G=O,K=O;return N+G+K+F+", -"+N+"-"+G+K+F+", "+N+"-"+G+K+F+", -"+N+G+K+F},te.makeEditable=function(F,N){var G=N.gd,K=N.delegate,W=A.dispatch("edit","input","cancel"),Y=K||F;if(F.style({"pointer-events":K?"none":"all"}),F.size()!==1)throw new Error("boo");function re(){j(),F.style({opacity:0});var q=Y.attr("class"),V;q?V="."+q.split(" ")[0]+"-math-group":V="[class*=-math-group]",V&&A.select(F.node().parentNode).select(V).style({opacity:0})}function ue(q){var V=q.node(),U=document.createRange();U.selectNodeContents(V);var $=window.getSelection();$.removeAllRanges(),$.addRange(U),V.focus()}function j(){var q=A.select(G),V=q.select(".svg-container"),U=V.append("div"),$=F.node().style,ne=parseFloat($.fontSize||12),X=N.text;X===void 0&&(X=F.attr("data-unformatted")),U.classed("plugin-editable editable",!0).style({position:"absolute","font-family":$.fontFamily||"Arial","font-size":ne,color:N.fill||$.fill||"black",opacity:1,"background-color":N.background||"transparent",outline:"#ffffff33 1px solid",margin:[-ne/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(X).call(R(F,V,N)).on("blur",function(){G._editing=!1,F.text(this.textContent).style({opacity:1});var Q=A.select(this).attr("class"),ie;Q?ie="."+Q.split(" ")[0]+"-math-group":ie="[class*=-math-group]",ie&&A.select(F.node().parentNode).select(ie).style({opacity:0});var se=this.textContent;A.select(this).transition().duration(0).remove(),A.select(document).on("mouseup",null),W.edit.call(F,se)}).on("focus",function(){var Q=this;G._editing=!0,A.select(document).on("mouseup",function(){if(A.event.target===Q)return!1;document.activeElement===U.node()&&U.node().blur()})}).on("keyup",function(){A.event.which===27?(G._editing=!1,F.style({opacity:1}),A.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),W.cancel.call(F,this.textContent)):(W.input.call(F,this.textContent),A.select(this).call(R(F,V,N)))}).on("keydown",function(){A.event.which===13&&this.blur()}).call(ue)}return N.immediate?re():Y.on("click",re),A.rebind(F,W,"on")}},{"../constants/alignment":483,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],542:[function(d,ee,te){var A={};te.throttle=function(M,e,a){var n=A[M],r=Date.now();if(!n){for(var t in A)A[t].ts<r-6e4&&delete A[t];n=A[M]={ts:0,timer:null}}g(n);function c(){a(),n.ts=Date.now(),n.onDone&&(n.onDone(),n.onDone=null)}if(r>n.ts+e){c();return}n.timer=setTimeout(function(){c(),n.timer=null},e)},te.done=function(S){var M=A[S];return!M||!M.timer?Promise.resolve():new Promise(function(e){var a=M.onDone;M.onDone=function(){a&&a(),e(),M.onDone=null}})},te.clear=function(S){if(S)g(A[S]),delete A[S];else for(var M in A)te.clear(M)};function g(S){S&&S.timer!==null&&(clearTimeout(S.timer),S.timer=null)}},{}],543:[function(d,ee,te){var A=d("fast-isnumeric");ee.exports=function(S,M){if(S>0)return Math.log(S)/Math.LN10;var e=Math.log(Math.min(M[0],M[1]))/Math.LN10;return A(e)||(e=Math.log(Math.max(M[0],M[1]))/Math.LN10-6),e}},{"fast-isnumeric":190}],544:[function(d,ee,te){var A=ee.exports={},g=d("../plots/geo/constants").locationmodeToLayer,S=d("topojson-client").feature;A.getTopojsonName=function(M){return[M.scope.replace(/ /g,"-"),"_",M.resolution.toString(),"m"].join("")},A.getTopojsonPath=function(M,e){return M+e+".json"},A.getTopojsonFeatures=function(M,e){var a=g[M.locationmode],n=e.objects[a];return S(e,n).features}},{"../plots/geo/constants":596,"topojson-client":316}],545:[function(d,ee,te){ee.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],546:[function(d,ee,te){ee.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],547:[function(d,ee,te){var A=d("../registry");ee.exports=function(S){for(var M=A.layoutArrayContainers,e=A.layoutArrayRegexes,a=S.split("[")[0],n,r,t=0;t<e.length;t++)if(r=S.match(e[t]),r&&r.index===0){n=r[0];break}if(n||(n=M[M.indexOf(a)]),!n)return!1;var c=S.substr(n.length);return c?(r=c.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/),r?{array:n,index:Number(r[1]),property:r[3]||""}:!1):{array:n,index:"",property:""}}},{"../registry":647}],548:[function(d,ee,te){var A=d("../lib"),g=A.extendFlat,S=A.isPlainObject,M={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},a=M.flags.slice().concat(["fullReplot"]),n=e.flags.slice().concat("layoutReplot");ee.exports={traces:M,layout:e,traceFlags:function(){return r(a)},layoutFlags:function(){return r(n)},update:function(s,i){var x=i.editType;if(x&&x!=="none")for(var p=x.split("+"),v=0;v<p.length;v++)s[p[v]]=!0},overrideAll:t};function r(s){for(var i={},x=0;x<s.length;x++)i[s[x]]=!1;return i}function t(s,i,x){var p=g({},s);for(var v in p){var f=p[v];S(f)&&(p[v]=c(f,i,x,v))}return x==="from-root"&&(p.editType=i),p}function c(s,i,x,p){if(s.valType){var v=g({},s);if(v.editType=i,Array.isArray(s.items)){v.items=new Array(s.items.length);for(var f=0;f<s.items.length;f++)v.items[f]=c(s.items[f],i)}return v}else return t(s,i,p.charAt(0)==="_"?"nested":"from-root")}},{"../lib":515}],549:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("gl-mat4/fromQuat"),S=d("../registry"),M=d("../lib"),e=d("../plots/plots"),a=d("../plots/cartesian/axis_ids"),n=d("../components/color"),r=a.cleanId,t=a.getFromTrace,c=S.traceIs;te.clearPromiseQueue=function(l){Array.isArray(l._promises)&&l._promises.length>0&&M.log("Clearing previous rejected promises from queue."),l._promises=[]},te.cleanLayout=function(l){var w,_;l||(l={}),l.xaxis1&&(l.xaxis||(l.xaxis=l.xaxis1),delete l.xaxis1),l.yaxis1&&(l.yaxis||(l.yaxis=l.yaxis1),delete l.yaxis1),l.scene1&&(l.scene||(l.scene=l.scene1),delete l.scene1);var h=(e.subplotsRegistry.cartesian||{}).attrRegex,b=(e.subplotsRegistry.polar||{}).attrRegex,u=(e.subplotsRegistry.ternary||{}).attrRegex,L=(e.subplotsRegistry.gl3d||{}).attrRegex,T=Object.keys(l);for(w=0;w<T.length;w++){var k=T[w];if(h&&h.test(k)){var P=l[k];P.anchor&&P.anchor!=="free"&&(P.anchor=r(P.anchor)),P.overlaying&&(P.overlaying=r(P.overlaying)),P.type||(P.isdate?P.type="date":P.islog?P.type="log":P.isdate===!1&&P.islog===!1&&(P.type="linear")),(P.autorange==="withzero"||P.autorange==="tozero")&&(P.autorange=!0,P.rangemode="tozero"),delete P.islog,delete P.isdate,delete P.categories,f(P,"domain")&&delete P.domain,P.autotick!==void 0&&(P.tickmode===void 0&&(P.tickmode=P.autotick?"auto":"linear"),delete P.autotick),i(P)}else if(b&&b.test(k)){var z=l[k];i(z.radialaxis)}else if(u&&u.test(k)){var I=l[k];i(I.aaxis),i(I.baxis),i(I.caxis)}else if(L&&L.test(k)){var D=l[k],R=D.cameraposition;if(Array.isArray(R)&&R[0].length===4){var O=R[0],F=R[1],N=R[2],G=g([],O),K=[];for(_=0;_<3;++_)K[_]=F[_]+N*G[2+4*_];D.camera={eye:{x:K[0],y:K[1],z:K[2]},center:{x:F[0],y:F[1],z:F[2]},up:{x:0,y:0,z:1}},delete D.cameraposition}i(D.xaxis),i(D.yaxis),i(D.zaxis)}}var W=Array.isArray(l.annotations)?l.annotations.length:0;for(w=0;w<W;w++){var Y=l.annotations[w];!M.isPlainObject(Y)||(Y.ref&&(Y.ref==="paper"?(Y.xref="paper",Y.yref="paper"):Y.ref==="data"&&(Y.xref="x",Y.yref="y"),delete Y.ref),s(Y,"xref"),s(Y,"yref"))}var re=Array.isArray(l.shapes)?l.shapes.length:0;for(w=0;w<re;w++){var ue=l.shapes[w];!M.isPlainObject(ue)||(s(ue,"xref"),s(ue,"yref"))}var j=Array.isArray(l.images)?l.images.length:0;for(w=0;w<j;w++){var q=l.images[w];!M.isPlainObject(q)||(s(q,"xref"),s(q,"yref"))}var V=l.legend;return V&&(V.x>3?(V.x=1.02,V.xanchor="left"):V.x<-2&&(V.x=-.02,V.xanchor="right"),V.y>3?(V.y=1.02,V.yanchor="bottom"):V.y<-2&&(V.y=-.02,V.yanchor="top")),i(l),l.dragmode==="rotate"&&(l.dragmode="orbit"),n.clean(l),l.template&&l.template.layout&&te.cleanLayout(l.template.layout),l};function s(l,w){var _=l[w],h=w.charAt(0);_&&_!=="paper"&&(l[w]=r(_,h,!0))}function i(l){l&&((typeof l.title=="string"||typeof l.title=="number")&&(l.title={text:l.title}),w("titlefont","font"),w("titleposition","position"),w("titleside","side"),w("titleoffset","offset"));function w(_,h){var b=l[_],u=l.title&&l.title[h];b&&!u&&(l.title||(l.title={}),l.title[h]=l[_],delete l[_])}}te.cleanData=function(l){for(var w=0;w<l.length;w++){var _=l[w],h;if(_.type==="histogramy"&&"xbins"in _&&!("ybins"in _)&&(_.ybins=_.xbins,delete _.xbins),_.error_y&&"opacity"in _.error_y){var b=n.defaults,u=_.error_y.color||(c(_,"bar")?n.defaultLine:b[w%b.length]);_.error_y.color=n.addOpacity(n.rgb(u),n.opacity(u)*_.error_y.opacity),delete _.error_y.opacity}if("bardir"in _&&(_.bardir==="h"&&(c(_,"bar")||_.type.substr(0,9)==="histogram")&&(_.orientation="h",te.swapXYData(_)),delete _.bardir),_.type==="histogramy"&&te.swapXYData(_),(_.type==="histogramx"||_.type==="histogramy")&&(_.type="histogram"),"scl"in _&&!("colorscale"in _)&&(_.colorscale=_.scl,delete _.scl),"reversescl"in _&&!("reversescale"in _)&&(_.reversescale=_.reversescl,delete _.reversescl),_.xaxis&&(_.xaxis=r(_.xaxis,"x")),_.yaxis&&(_.yaxis=r(_.yaxis,"y")),c(_,"gl3d")&&_.scene&&(_.scene=e.subplotsRegistry.gl3d.cleanId(_.scene)),!c(_,"pie-like")&&!c(_,"bar-like"))if(Array.isArray(_.textposition))for(h=0;h<_.textposition.length;h++)_.textposition[h]=v(_.textposition[h]);else _.textposition&&(_.textposition=v(_.textposition));var L=S.getModule(_);if(L&&L.colorbar){var T=L.colorbar.container,k=T?_[T]:_;k&&k.colorscale&&(k.colorscale==="YIGnBu"&&(k.colorscale="YlGnBu"),k.colorscale==="YIOrRd"&&(k.colorscale="YlOrRd"))}if(_.type==="surface"&&M.isPlainObject(_.contours)){var P=["x","y","z"];for(h=0;h<P.length;h++){var z=_.contours[P[h]];!M.isPlainObject(z)||(z.highlightColor&&(z.highlightcolor=z.highlightColor,delete z.highlightColor),z.highlightWidth&&(z.highlightwidth=z.highlightWidth,delete z.highlightWidth))}}if(_.type==="candlestick"||_.type==="ohlc"){var I=(_.increasing||{}).showlegend!==!1,D=(_.decreasing||{}).showlegend!==!1,R=x(_.increasing),O=x(_.decreasing);if(R!==!1&&O!==!1){var F=p(R,O,I,D);F&&(_.name=F)}else(R||O)&&!_.name&&(_.name=R||O)}if(Array.isArray(_.transforms)){var N=_.transforms;for(h=0;h<N.length;h++){var G=N[h];if(!!M.isPlainObject(G))switch(G.type){case"filter":G.filtersrc&&(G.target=G.filtersrc,delete G.filtersrc),G.calendar&&(G.valuecalendar||(G.valuecalendar=G.calendar),delete G.calendar);break;case"groupby":if(G.styles=G.styles||G.style,G.styles&&!Array.isArray(G.styles)){var K=G.styles,W=Object.keys(K);G.styles=[];for(var Y=0;Y<W.length;Y++)G.styles.push({target:W[Y],value:K[W[Y]]})}break}}}f(_,"line")&&delete _.line,"marker"in _&&(f(_.marker,"line")&&delete _.marker.line,f(_,"marker")&&delete _.marker),n.clean(_),_.autobinx&&(delete _.autobinx,delete _.xbins),_.autobiny&&(delete _.autobiny,delete _.ybins),i(_),_.colorbar&&i(_.colorbar),_.marker&&_.marker.colorbar&&i(_.marker.colorbar),_.line&&_.line.colorbar&&i(_.line.colorbar),_.aaxis&&i(_.aaxis),_.baxis&&i(_.baxis)}};function x(l){if(!M.isPlainObject(l))return!1;var w=l.name;return delete l.name,delete l.showlegend,(typeof w=="string"||typeof w=="number")&&String(w)}function p(l,w,_,h){if(_&&!h)return l;if(h&&!_||!l.trim())return w;if(!w.trim())return l;var b=Math.min(l.length,w.length),u;for(u=0;u<b&&l.charAt(u)===w.charAt(u);u++);var L=l.substr(0,u);return L.trim()}function v(l){var w="middle",_="center";return typeof l=="string"&&(l.indexOf("top")!==-1?w="top":l.indexOf("bottom")!==-1&&(w="bottom"),l.indexOf("left")!==-1?_="left":l.indexOf("right")!==-1&&(_="right")),w+" "+_}function f(l,w){return w in l&&typeof l[w]=="object"&&Object.keys(l[w]).length===0}te.swapXYData=function(l){var w;if(M.swapAttrs(l,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(l.z)&&Array.isArray(l.z[0])&&(l.transpose?delete l.transpose:l.transpose=!0),l.error_x&&l.error_y){var _=l.error_y,h="copy_ystyle"in _?_.copy_ystyle:!(_.color||_.thickness||_.width);M.swapAttrs(l,["error_?.copy_ystyle"]),h&&M.swapAttrs(l,["error_?.color","error_?.thickness","error_?.width"])}if(typeof l.hoverinfo=="string"){var b=l.hoverinfo.split("+");for(w=0;w<b.length;w++)b[w]==="x"?b[w]="y":b[w]==="y"&&(b[w]="x");l.hoverinfo=b.join("+")}},te.coerceTraceIndices=function(l,w){if(A(w))return[w];if(!Array.isArray(w)||!w.length)return l.data.map(function(b,u){return u});if(Array.isArray(w)){for(var _=[],h=0;h<w.length;h++)M.isIndex(w[h],l.data.length)?_.push(w[h]):M.warn("trace index (",w[h],") is not a number or is out of bounds");return _}return w},te.manageArrayContainers=function(l,w,_){var h=l.obj,b=l.parts,u=b.length,L=b[u-1],T=A(L);if(T&&w===null){var k=b.slice(0,u-1).join("."),P=M.nestedProperty(h,k).get();P.splice(L,1)}else T&&l.get()===void 0&&l.get()===void 0&&(_[l.astr]=null),l.set(w)};var y=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function o(l){var w=l.search(y);if(w>0)return l.substr(0,w)}te.hasParent=function(l,w){for(var _=o(w);_;){if(_ in l)return!0;_=o(_)}return!1};var m=["x","y","z"];te.clearAxisTypes=function(l,w,_){for(var h=0;h<w.length;h++)for(var b=l._fullData[h],u=0;u<3;u++){var L=t(l,b,m[u]);if(L&&L.type!=="log"){var T=L._name,k=L._id.substr(1);if(k.substr(0,5)==="scene"){if(_[k]!==void 0)continue;T=k+"."+T}var P=T+".type";_[T]===void 0&&_[P]===void 0&&M.nestedProperty(l.layout,P).set(null)}}}},{"../components/color":367,"../lib":515,"../plots/cartesian/axis_ids":570,"../plots/plots":628,"../registry":647,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],550:[function(d,ee,te){var A=d("./plot_api");te._doPlot=A._doPlot,te.newPlot=A.newPlot,te.restyle=A.restyle,te.relayout=A.relayout,te.redraw=A.redraw,te.update=A.update,te._guiRestyle=A._guiRestyle,te._guiRelayout=A._guiRelayout,te._guiUpdate=A._guiUpdate,te._storeDirectGUIEdit=A._storeDirectGUIEdit,te.react=A.react,te.extendTraces=A.extendTraces,te.prependTraces=A.prependTraces,te.addTraces=A.addTraces,te.deleteTraces=A.deleteTraces,te.moveTraces=A.moveTraces,te.purge=A.purge,te.addFrames=A.addFrames,te.deleteFrames=A.deleteFrames,te.animate=A.animate,te.setPlotConfig=A.setPlotConfig,te.toImage=d("./to_image"),te.validate=d("./validate"),te.downloadImage=d("../snapshot/download");var g=d("./template_api");te.makeTemplate=g.makeTemplate,te.validateTemplate=g.validateTemplate},{"../snapshot/download":649,"./plot_api":552,"./template_api":557,"./to_image":558,"./validate":559}],551:[function(d,ee,te){var A=d("../lib/is_plain_object"),g=d("../lib/noop"),S=d("../lib/loggers"),M=d("../lib/search").sorterAsc,e=d("../registry");te.containerArrayMatch=d("./container_array_match");var a=te.isAddVal=function(t){return t==="add"||A(t)},n=te.isRemoveVal=function(t){return t===null||t==="remove"};te.applyContainerArrayChanges=function(t,c,s,i,x){var p=c.astr,v=e.getComponentMethod(p,"supplyLayoutDefaults"),f=e.getComponentMethod(p,"draw"),y=e.getComponentMethod(p,"drawOne"),o=i.replot||i.recalc||v===g||f===g,m=t.layout,l=t._fullLayout;if(s[""]){Object.keys(s).length>1&&S.warn("Full array edits are incompatible with other edits",p);var w=s[""][""];if(n(w))c.set(null);else if(Array.isArray(w))c.set(w);else return S.warn("Unrecognized full array edit value",p,w),!0;return o?!1:(v(m,l),f(t),!0)}var _=Object.keys(s).map(Number).sort(M),h=c.get(),b=h||[],u=x(l,p).get(),L=[],T=-1,k=b.length,P,z,I,D,R,O,F,N;for(P=0;P<_.length;P++){if(I=_[P],D=s[I],R=Object.keys(D),O=D[""],F=a(O),I<0||I>b.length-(F?0:1)){S.warn("index out of range",p,I);continue}if(O!==void 0)R.length>1&&S.warn("Insertion & removal are incompatible with edits to the same index.",p,I),n(O)?L.push(I):F?(O==="add"&&(O={}),b.splice(I,0,O),u&&u.splice(I,0,{})):S.warn("Unrecognized full object edit value",p,I,O),T===-1&&(T=I);else for(z=0;z<R.length;z++)N=p+"["+I+"].",x(b[I],R[z],N).set(D[R[z]])}for(P=L.length-1;P>=0;P--)b.splice(L[P],1),u&&u.splice(L[P],1);if(b.length?h||c.set(b):c.set(null),o)return!1;if(v(m,l),y!==g){var G;if(T===-1)G=_;else{for(k=Math.max(b.length,k),G=[],P=0;P<_.length&&(I=_[P],!(I>=T));P++)G.push(I);for(P=T;P<k;P++)G.push(P)}for(P=0;P<G.length;P++)y(t,G[P])}else f(t);return!0}},{"../lib/is_plain_object":516,"../lib/loggers":519,"../lib/noop":524,"../lib/search":535,"../registry":647,"./container_array_match":547}],552:[function(d,ee,te){var A=d("@plotly/d3"),g=d("fast-isnumeric"),S=d("has-hover"),M=d("../lib"),e=M.nestedProperty,a=d("../lib/events"),n=d("../lib/queue"),r=d("../registry"),t=d("./plot_schema"),c=d("../plots/plots"),s=d("../plots/cartesian/axes"),i=d("../components/drawing"),x=d("../components/color"),p=d("../plots/cartesian/graph_interact").initInteractions,v=d("../constants/xmlns_namespaces"),f=d("../components/selections").clearOutline,y=d("./plot_config").dfltConfig,o=d("./manage_arrays"),m=d("./helpers"),l=d("./subroutines"),w=d("./edit_types"),_=d("../plots/cartesian/constants").AX_NAME_PATTERN,h=0,b=5;function u(Ae,Ue,Ze,Qe){var _t;if(Ae=M.getGraphDiv(Ae),a.init(Ae),M.isPlainObject(Ue)){var gt=Ue;Ue=gt.data,Ze=gt.layout,Qe=gt.config,_t=gt.frames}var wt=a.triggerHandler(Ae,"plotly_beforeplot",[Ue,Ze,Qe]);if(wt===!1)return Promise.reject();!Ue&&!Ze&&!M.isPlotDiv(Ae)&&M.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",Ae);function Ut(){if(_t)return te.addFrames(Ae,_t)}z(Ae,Qe),Ze||(Ze={}),A.select(Ae).classed("js-plotly-plot",!0),i.makeTester(),Array.isArray(Ae._promises)||(Ae._promises=[]);var Dt=(Ae.data||[]).length===0&&Array.isArray(Ue);Array.isArray(Ue)&&(m.cleanData(Ue),Dt?Ae.data=Ue:Ae.data.push.apply(Ae.data,Ue),Ae.empty=!1),(!Ae.layout||Dt)&&(Ae.layout=m.cleanLayout(Ze)),c.supplyDefaults(Ae);var Nt=Ae._fullLayout,Xt=Nt._has("cartesian");Nt._replotting=!0,(Dt||Nt._shouldCreateBgLayer)&&(Ve(Ae),Nt._shouldCreateBgLayer&&delete Nt._shouldCreateBgLayer),i.initGradients(Ae),i.initPatterns(Ae),Dt&&s.saveShowSpikeInitial(Ae);var Ht=!Ae.calcdata||Ae.calcdata.length!==(Ae._fullData||[]).length;Ht&&c.doCalcdata(Ae);for(var ar=0;ar<Ae.calcdata.length;ar++)Ae.calcdata[ar][0].trace=Ae._fullData[ar];Ae._context.responsive?Ae._responsiveChartHandler||(Ae._responsiveChartHandler=function(){M.isHidden(Ae)||c.resize(Ae)},window.addEventListener("resize",Ae._responsiveChartHandler)):M.clearResponsive(Ae);var Vr=M.extendFlat({},Nt._size),nn=0;function jr(){for(var lt=Nt._basePlotModules,Tt=0;Tt<lt.length;Tt++)lt[Tt].drawFramework&&lt[Tt].drawFramework(Ae);!Nt._glcanvas&&Nt._has("gl")&&(Nt._glcanvas=Nt._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(nt){return nt.key}),Nt._glcanvas.enter().append("canvas").attr("class",function(nt){return"gl-canvas gl-canvas-"+nt.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var Bt=Ae._context.plotGlPixelRatio;if(Nt._glcanvas){Nt._glcanvas.attr("width",Nt.width*Bt).attr("height",Nt.height*Bt).style("width",Nt.width+"px").style("height",Nt.height+"px");var Ce=Nt._glcanvas.data()[0].regl;if(Ce&&(Math.floor(Nt.width*Bt)!==Ce._gl.drawingBufferWidth||Math.floor(Nt.height*Bt)!==Ce._gl.drawingBufferHeight)){var Me="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(nn)M.error(Me);else return M.log(Me+" Clearing graph and plotting again."),c.cleanPlot([],{},Ae._fullData,Nt),c.supplyDefaults(Ae),Nt=Ae._fullLayout,c.doCalcdata(Ae),nn++,jr()}}return Nt.modebar.orientation==="h"?Nt._modebardiv.style("height",null).style("width","100%"):Nt._modebardiv.style("width",null).style("height",Nt.height+"px"),c.previousPromises(Ae)}function at(){if(c.clearAutoMarginIds(Ae),l.drawMarginPushers(Ae),s.allowAutoMargin(Ae),Nt._has("pie"))for(var lt=Ae._fullData,Tt=0;Tt<lt.length;Tt++){var Bt=lt[Tt];Bt.type==="pie"&&Bt.automargin&&c.allowAutoMargin(Ae,"pie."+Bt.uid+".automargin")}return c.doAutoMargin(Ae),c.previousPromises(Ae)}function $t(){if(!!c.didMarginChange(Vr,Nt._size))return M.syncOrAsync([at,l.layoutStyles],Ae)}function Zt(){if(!Ht){ur();return}return M.syncOrAsync([r.getComponentMethod("shapes","calcAutorange"),r.getComponentMethod("annotations","calcAutorange"),ur],Ae)}function ur(){Ae._transitioning||(l.doAutoRangeAndConstraints(Ae),Dt&&s.saveRangeInitial(Ae),r.getComponentMethod("rangeslider","calcAutorange")(Ae))}function wr(){return s.draw(Ae,Dt?"":"redraw")}var $e=[c.previousPromises,Ut,jr,at,$t];Xt&&$e.push(Zt),$e.push(l.layoutStyles),Xt&&$e.push(wr,function(Tt){Tt._fullLayout._insideTickLabelsAutorange&&ae(Tt,Tt._fullLayout._insideTickLabelsAutorange).then(function(){Tt._fullLayout._insideTickLabelsAutorange=void 0})}),$e.push(l.drawData,l.finalDraw,p,c.addLinks,c.rehover,c.redrag,c.reselect,c.doAutoMargin,Je,c.previousPromises);function Je(lt){lt._fullLayout._insideTickLabelsAutorange&&Dt&&s.saveRangeInitial(lt,!0)}var it=M.syncOrAsync($e,Ae);return(!it||!it.then)&&(it=Promise.resolve()),it.then(function(){return L(Ae),Ae})}function L(Ae){var Ue=Ae._fullLayout;Ue._redrawFromAutoMarginCount?Ue._redrawFromAutoMarginCount--:Ae.emit("plotly_afterplot")}function T(Ae){return M.extendFlat(y,Ae)}function k(Ae,Ue){try{Ae._fullLayout._paper.style("background",Ue)}catch(Ze){M.error(Ze)}}function P(Ae,Ue){var Ze=x.combine(Ue,"white");k(Ae,Ze)}function z(Ae,Ue){if(!Ae._context){Ae._context=M.extendDeep({},y);var Ze=A.select("base");Ae._context._baseUrl=Ze.size()&&Ze.attr("href")?window.location.href.split("#")[0]:""}var Qe=Ae._context,_t,gt,wt;if(Ue){for(gt=Object.keys(Ue),_t=0;_t<gt.length;_t++)wt=gt[_t],!(wt==="editable"||wt==="edits")&&wt in Qe&&(wt==="setBackground"&&Ue[wt]==="opaque"?Qe[wt]=P:Qe[wt]=Ue[wt]);Ue.plot3dPixelRatio&&!Qe.plotGlPixelRatio&&(Qe.plotGlPixelRatio=Qe.plot3dPixelRatio);var Ut=Ue.editable;if(Ut!==void 0)for(Qe.editable=Ut,gt=Object.keys(Qe.edits),_t=0;_t<gt.length;_t++)Qe.edits[gt[_t]]=Ut;if(Ue.edits)for(gt=Object.keys(Ue.edits),_t=0;_t<gt.length;_t++)wt=gt[_t],wt in Qe.edits&&(Qe.edits[wt]=Ue.edits[wt]);Qe._exportedPlot=Ue._exportedPlot}Qe.staticPlot&&(Qe.editable=!1,Qe.edits={},Qe.autosizable=!1,Qe.scrollZoom=!1,Qe.doubleClick=!1,Qe.showTips=!1,Qe.showLink=!1,Qe.displayModeBar=!1),Qe.displayModeBar==="hover"&&!S&&(Qe.displayModeBar=!0),(Qe.setBackground==="transparent"||typeof Qe.setBackground!="function")&&(Qe.setBackground=k),Qe._hasZeroHeight=Qe._hasZeroHeight||Ae.clientHeight===0,Qe._hasZeroWidth=Qe._hasZeroWidth||Ae.clientWidth===0;var Dt=Qe.scrollZoom,Nt=Qe._scrollZoom={};if(Dt===!0)Nt.cartesian=1,Nt.gl3d=1,Nt.geo=1,Nt.mapbox=1;else if(typeof Dt=="string"){var Xt=Dt.split("+");for(_t=0;_t<Xt.length;_t++)Nt[Xt[_t]]=1}else Dt!==!1&&(Nt.gl3d=1,Nt.geo=1,Nt.mapbox=1)}function I(Ae){if(Ae=M.getGraphDiv(Ae),!M.isPlotDiv(Ae))throw new Error("This element is not a Plotly plot: "+Ae);return m.cleanData(Ae.data),m.cleanLayout(Ae.layout),Ae.calcdata=void 0,te._doPlot(Ae).then(function(){return Ae.emit("plotly_redraw"),Ae})}function D(Ae,Ue,Ze,Qe){return Ae=M.getGraphDiv(Ae),c.cleanPlot([],{},Ae._fullData||[],Ae._fullLayout||{}),c.purge(Ae),te._doPlot(Ae,Ue,Ze,Qe)}function R(Ae,Ue){var Ze=Ue+1,Qe=[],_t,gt;for(_t=0;_t<Ae.length;_t++)gt=Ae[_t],gt<0?Qe.push(Ze+gt):Qe.push(gt);return Qe}function O(Ae,Ue,Ze){var Qe,_t;for(Qe=0;Qe<Ue.length;Qe++){if(_t=Ue[Qe],_t!==parseInt(_t,10))throw new Error("all values in "+Ze+" must be integers");if(_t>=Ae.data.length||_t<-Ae.data.length)throw new Error(Ze+" must be valid indices for gd.data.");if(Ue.indexOf(_t,Qe+1)>-1||_t>=0&&Ue.indexOf(-Ae.data.length+_t)>-1||_t<0&&Ue.indexOf(Ae.data.length+_t)>-1)throw new Error("each index in "+Ze+" must be unique.")}}function F(Ae,Ue,Ze){if(!Array.isArray(Ae.data))throw new Error("gd.data must be an array.");if(typeof Ue>"u")throw new Error("currentIndices is a required argument.");if(Array.isArray(Ue)||(Ue=[Ue]),O(Ae,Ue,"currentIndices"),typeof Ze<"u"&&!Array.isArray(Ze)&&(Ze=[Ze]),typeof Ze<"u"&&O(Ae,Ze,"newIndices"),typeof Ze<"u"&&Ue.length!==Ze.length)throw new Error("current and new indices must be of equal length.")}function N(Ae,Ue,Ze){var Qe,_t;if(!Array.isArray(Ae.data))throw new Error("gd.data must be an array.");if(typeof Ue>"u")throw new Error("traces must be defined.");for(Array.isArray(Ue)||(Ue=[Ue]),Qe=0;Qe<Ue.length;Qe++)if(_t=Ue[Qe],typeof _t!="object"||Array.isArray(_t)||_t===null)throw new Error("all values in traces array must be non-array objects");if(typeof Ze<"u"&&!Array.isArray(Ze)&&(Ze=[Ze]),typeof Ze<"u"&&Ze.length!==Ue.length)throw new Error("if indices is specified, traces.length must equal indices.length")}function G(Ae,Ue,Ze,Qe){var _t=M.isPlainObject(Qe);if(!Array.isArray(Ae.data))throw new Error("gd.data must be an array");if(!M.isPlainObject(Ue))throw new Error("update must be a key:value object");if(typeof Ze>"u")throw new Error("indices must be an integer or array of integers");O(Ae,Ze,"indices");for(var gt in Ue){if(!Array.isArray(Ue[gt])||Ue[gt].length!==Ze.length)throw new Error("attribute "+gt+" must be an array of length equal to indices array length");if(_t&&(!(gt in Qe)||!Array.isArray(Qe[gt])||Qe[gt].length!==Ue[gt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}function K(Ae,Ue,Ze,Qe){var _t=M.isPlainObject(Qe),gt=[],wt,Ut,Dt,Nt,Xt;Array.isArray(Ze)||(Ze=[Ze]),Ze=R(Ze,Ae.data.length-1);for(var Ht in Ue)for(var ar=0;ar<Ze.length;ar++){if(wt=Ae.data[Ze[ar]],Dt=e(wt,Ht),Ut=Dt.get(),Nt=Ue[Ht][ar],!M.isArrayOrTypedArray(Nt))throw new Error("attribute: "+Ht+" index: "+ar+" must be an array");if(!M.isArrayOrTypedArray(Ut))throw new Error("cannot extend missing or non-array attribute: "+Ht);if(Ut.constructor!==Nt.constructor)throw new Error("cannot extend array with an array of a different type: "+Ht);Xt=_t?Qe[Ht][ar]:Qe,g(Xt)||(Xt=-1),gt.push({prop:Dt,target:Ut,insert:Nt,maxp:Math.floor(Xt)})}return gt}function W(Ae,Ue,Ze,Qe,_t){G(Ae,Ue,Ze,Qe);for(var gt=K(Ae,Ue,Ze,Qe),wt={},Ut={},Dt=0;Dt<gt.length;Dt++){var Nt=gt[Dt].prop,Xt=gt[Dt].maxp,Ht=_t(gt[Dt].target,gt[Dt].insert,Xt);Nt.set(Ht[0]),Array.isArray(wt[Nt.astr])||(wt[Nt.astr]=[]),wt[Nt.astr].push(Ht[1]),Array.isArray(Ut[Nt.astr])||(Ut[Nt.astr]=[]),Ut[Nt.astr].push(gt[Dt].target.length)}return{update:wt,maxPoints:Ut}}function Y(Ae,Ue){var Ze=new Ae.constructor(Ae.length+Ue.length);return Ze.set(Ae),Ze.set(Ue,Ae.length),Ze}function re(Ae,Ue,Ze,Qe){Ae=M.getGraphDiv(Ae);function _t(Dt,Nt,Xt){var Ht,ar;if(M.isTypedArray(Dt))if(Xt<0){var Vr=new Dt.constructor(0),nn=Y(Dt,Nt);Xt<0?(Ht=nn,ar=Vr):(Ht=Vr,ar=nn)}else if(Ht=new Dt.constructor(Xt),ar=new Dt.constructor(Dt.length+Nt.length-Xt),Xt===Nt.length)Ht.set(Nt),ar.set(Dt);else if(Xt<Nt.length){var jr=Nt.length-Xt;Ht.set(Nt.subarray(jr)),ar.set(Dt),ar.set(Nt.subarray(0,jr),Dt.length)}else{var at=Xt-Nt.length,$t=Dt.length-at;Ht.set(Dt.subarray($t)),Ht.set(Nt,at),ar.set(Dt.subarray(0,$t))}else Ht=Dt.concat(Nt),ar=Xt>=0&&Xt<Ht.length?Ht.splice(0,Ht.length-Xt):[];return[Ht,ar]}var gt=W(Ae,Ue,Ze,Qe,_t),wt=te.redraw(Ae),Ut=[Ae,gt.update,Ze,gt.maxPoints];return n.add(Ae,te.prependTraces,Ut,re,arguments),wt}function ue(Ae,Ue,Ze,Qe){Ae=M.getGraphDiv(Ae);function _t(Dt,Nt,Xt){var Ht,ar;if(M.isTypedArray(Dt))if(Xt<=0){var Vr=new Dt.constructor(0),nn=Y(Nt,Dt);Xt<0?(Ht=nn,ar=Vr):(Ht=Vr,ar=nn)}else if(Ht=new Dt.constructor(Xt),ar=new Dt.constructor(Dt.length+Nt.length-Xt),Xt===Nt.length)Ht.set(Nt),ar.set(Dt);else if(Xt<Nt.length){var jr=Nt.length-Xt;Ht.set(Nt.subarray(0,jr)),ar.set(Nt.subarray(jr)),ar.set(Dt,jr)}else{var at=Xt-Nt.length;Ht.set(Nt),Ht.set(Dt.subarray(0,at),Nt.length),ar.set(Dt.subarray(at))}else Ht=Nt.concat(Dt),ar=Xt>=0&&Xt<Ht.length?Ht.splice(Xt,Ht.length):[];return[Ht,ar]}var gt=W(Ae,Ue,Ze,Qe,_t),wt=te.redraw(Ae),Ut=[Ae,gt.update,Ze,gt.maxPoints];return n.add(Ae,te.extendTraces,Ut,ue,arguments),wt}function j(Ae,Ue,Ze){Ae=M.getGraphDiv(Ae);var Qe=[],_t=te.deleteTraces,gt=j,wt=[Ae,Qe],Ut=[Ae,Ue],Dt,Nt;for(N(Ae,Ue,Ze),Array.isArray(Ue)||(Ue=[Ue]),Ue=Ue.map(function(Xt){return M.extendFlat({},Xt)}),m.cleanData(Ue),Dt=0;Dt<Ue.length;Dt++)Ae.data.push(Ue[Dt]);for(Dt=0;Dt<Ue.length;Dt++)Qe.push(-Ue.length+Dt);if(typeof Ze>"u")return Nt=te.redraw(Ae),n.add(Ae,_t,wt,gt,Ut),Nt;Array.isArray(Ze)||(Ze=[Ze]);try{F(Ae,Qe,Ze)}catch(Xt){throw Ae.data.splice(Ae.data.length-Ue.length,Ue.length),Xt}return n.startSequence(Ae),n.add(Ae,_t,wt,gt,Ut),Nt=te.moveTraces(Ae,Qe,Ze),n.stopSequence(Ae),Nt}function q(Ae,Ue){Ae=M.getGraphDiv(Ae);var Ze=[],Qe=te.addTraces,_t=q,gt=[Ae,Ze,Ue],wt=[Ae,Ue],Ut,Dt;if(typeof Ue>"u")throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Ue)||(Ue=[Ue]),O(Ae,Ue,"indices"),Ue=R(Ue,Ae.data.length-1),Ue.sort(M.sorterDes),Ut=0;Ut<Ue.length;Ut+=1)Dt=Ae.data.splice(Ue[Ut],1)[0],Ze.push(Dt);var Nt=te.redraw(Ae);return n.add(Ae,Qe,gt,_t,wt),Nt}function V(Ae,Ue,Ze){Ae=M.getGraphDiv(Ae);var Qe=[],_t=[],gt=V,wt=V,Ut=[Ae,Ze,Ue],Dt=[Ae,Ue,Ze],Nt;if(F(Ae,Ue,Ze),Ue=Array.isArray(Ue)?Ue:[Ue],typeof Ze>"u")for(Ze=[],Nt=0;Nt<Ue.length;Nt++)Ze.push(-Ue.length+Nt);for(Ze=Array.isArray(Ze)?Ze:[Ze],Ue=R(Ue,Ae.data.length-1),Ze=R(Ze,Ae.data.length-1),Nt=0;Nt<Ae.data.length;Nt++)Ue.indexOf(Nt)===-1&&Qe.push(Ae.data[Nt]);for(Nt=0;Nt<Ue.length;Nt++)_t.push({newIndex:Ze[Nt],trace:Ae.data[Ue[Nt]]});for(_t.sort(function(Ht,ar){return Ht.newIndex-ar.newIndex}),Nt=0;Nt<_t.length;Nt+=1)Qe.splice(_t[Nt].newIndex,0,_t[Nt].trace);Ae.data=Qe;var Xt=te.redraw(Ae);return n.add(Ae,gt,Ut,wt,Dt),Xt}function U(Ae,Ue,Ze,Qe){Ae=M.getGraphDiv(Ae),m.clearPromiseQueue(Ae);var _t={};if(typeof Ue=="string")_t[Ue]=Ze;else if(M.isPlainObject(Ue))_t=M.extendFlat({},Ue),Qe===void 0&&(Qe=Ze);else return M.warn("Restyle fail.",Ue,Ze,Qe),Promise.reject();Object.keys(_t).length&&(Ae.changed=!0);var gt=m.coerceTraceIndices(Ae,Qe),wt=ie(Ae,_t,gt),Ut=wt.flags;Ut.calc&&(Ae.calcdata=void 0),Ut.clearAxisTypes&&m.clearAxisTypes(Ae,gt,{});var Dt=[];Ut.fullReplot?Dt.push(te._doPlot):(Dt.push(c.previousPromises),c.supplyDefaults(Ae),Ut.markerSize&&(c.doCalcdata(Ae),be(Dt)),Ut.style&&Dt.push(l.doTraceStyle),Ut.colorbars&&Dt.push(l.doColorBars),Dt.push(L)),Dt.push(c.rehover,c.redrag,c.reselect),n.add(Ae,U,[Ae,wt.undoit,wt.traces],U,[Ae,wt.redoit,wt.traces]);var Nt=M.syncOrAsync(Dt,Ae);return(!Nt||!Nt.then)&&(Nt=Promise.resolve()),Nt.then(function(){return Ae.emit("plotly_restyle",wt.eventData),Ae})}function $(Ae){return Ae===void 0?null:Ae}function ne(Ae,Ue){return Ue?function(Ze,Qe,_t){var gt=e(Ze,Qe),wt=gt.set;return gt.set=function(Ut){var Dt=(_t||"")+Qe;X(Dt,gt.get(),Ut,Ae),wt(Ut)},gt}:e}function X(Ae,Ue,Ze,Qe){if(Array.isArray(Ue)||Array.isArray(Ze))for(var _t=Array.isArray(Ue)?Ue:[],gt=Array.isArray(Ze)?Ze:[],wt=Math.max(_t.length,gt.length),Ut=0;Ut<wt;Ut++)X(Ae+"["+Ut+"]",_t[Ut],gt[Ut],Qe);else if(M.isPlainObject(Ue)||M.isPlainObject(Ze)){var Dt=M.isPlainObject(Ue)?Ue:{},Nt=M.isPlainObject(Ze)?Ze:{},Xt=M.extendFlat({},Dt,Nt);for(var Ht in Xt)X(Ae+"."+Ht,Dt[Ht],Nt[Ht],Qe)}else Qe[Ae]===void 0&&(Qe[Ae]=$(Ue))}function Q(Ae,Ue,Ze){for(var Qe in Ze){var _t=e(Ae,Qe);X(Qe,_t.get(),Ze[Qe],Ue)}}function ie(Ae,Ue,Ze){var Qe=Ae._fullLayout,_t=Ae._fullData,gt=Ae.data,wt=Qe._guiEditing,Ut=ne(Qe._preGUI,wt),Dt=M.extendDeepAll({},Ue),Nt;se(Ue);var Xt=w.traceFlags(),Ht={},ar={},Vr;function nn(){return Ze.map(function(){})}function jr(Wt){var ir=s.id2name(Wt);Vr.indexOf(ir)===-1&&Vr.push(ir)}function at(Wt){return"LAYOUT"+Wt+".autorange"}function $t(Wt){return"LAYOUT"+Wt+".range"}function Zt(Wt){for(var ir=Wt;ir<_t.length;ir++)if(_t[ir]._input===gt[Wt])return _t[ir]}function ur(Wt,ir,Ir){if(Array.isArray(Wt)){Wt.forEach(function(Gr){ur(Gr,ir,Ir)});return}if(!(Wt in Ue||m.hasParent(Ue,Wt))){var Br;if(Wt.substr(0,6)==="LAYOUT")Br=Ut(Ae.layout,Wt.replace("LAYOUT",""));else{var Er=Ze[Ir],_r=Qe._tracePreGUI[Zt(Er)._fullInput.uid];Br=ne(_r,wt)(gt[Er],Wt)}Wt in ar||(ar[Wt]=nn()),ar[Wt][Ir]===void 0&&(ar[Wt][Ir]=$(Br.get())),ir!==void 0&&Br.set(ir)}}function wr(Wt){return function(ir){return _t[ir][Wt]}}function $e(Wt){return function(ir,Ir){return ir===!1?_t[Ze[Ir]][Wt]:null}}for(var Je in Ue){if(m.hasParent(Ue,Je))throw new Error("cannot set "+Je+" and a parent attribute simultaneously");var it=Ue[Je],lt,Tt,Bt,Ce,Me,nt;if((Je==="autobinx"||Je==="autobiny")&&(Je=Je.charAt(Je.length-1)+"bins",Array.isArray(it)?it=it.map($e(Je)):it===!1?it=Ze.map(wr(Je)):it=null),Ht[Je]=it,Je.substr(0,6)==="LAYOUT"){Bt=Ut(Ae.layout,Je.replace("LAYOUT","")),ar[Je]=[$(Bt.get())],Bt.set(Array.isArray(it)?it[0]:it),Xt.calc=!0;continue}for(ar[Je]=nn(),Nt=0;Nt<Ze.length;Nt++){lt=gt[Ze[Nt]],Tt=Zt(Ze[Nt]);var st=Qe._tracePreGUI[Tt._fullInput.uid];if(Bt=ne(st,wt)(lt,Je),Ce=Bt.get(),Me=Array.isArray(it)?it[Nt%it.length]:it,Me!==void 0){var ct=Bt.parts[Bt.parts.length-1],At=Je.substr(0,Je.length-ct.length-1),dt=At?At+".":"",Ct=At?e(Tt,At).get():Tt;if(nt=t.getTraceValObject(Tt,Bt.parts),nt&&nt.impliedEdits&&Me!==null)for(var Gt in nt.impliedEdits)ur(M.relativeAttr(Je,Gt),nt.impliedEdits[Gt],Nt);else if((ct==="thicknessmode"||ct==="lenmode")&&Ce!==Me&&(Me==="fraction"||Me==="pixels")&&Ct){var rr=Qe._size,kr=Ct.orient,br=kr==="top"||kr==="bottom";if(ct==="thicknessmode"){var Ar=br?rr.h:rr.w;ur(dt+"thickness",Ct.thickness*(Me==="fraction"?1/Ar:Ar),Nt)}else{var Wr=br?rr.w:rr.h;ur(dt+"len",Ct.len*(Me==="fraction"?1/Wr:Wr),Nt)}}else if(Je==="type"&&(Me==="pie"!=(Ce==="pie")||Me==="funnelarea"!=(Ce==="funnelarea"))){var nr="x",yr="y";(Me==="bar"||Ce==="bar")&&lt.orientation==="h"&&(nr="y",yr="x"),M.swapAttrs(lt,["?","?src"],"labels",nr),M.swapAttrs(lt,["d?","?0"],"label",nr),M.swapAttrs(lt,["?","?src"],"values",yr),Ce==="pie"||Ce==="funnelarea"?(e(lt,"marker.color").set(e(lt,"marker.colors").get()),Qe._pielayer.selectAll("g.trace").remove()):r.traceIs(lt,"cartesian")&&e(lt,"marker.colors").set(e(lt,"marker.color").get())}ar[Je][Nt]=$(Ce);var Pr=["swapxy","swapxyaxes","orientation","orientationaxes"];if(Pr.indexOf(Je)!==-1){if(Je==="orientation"){Bt.set(Me);var Or=lt.x&&!lt.y?"h":"v";if((Bt.get()||Or)===Tt.orientation)continue}else Je==="orientationaxes"&&(lt.orientation={v:"h",h:"v"}[Tt.orientation]);m.swapXYData(lt),Xt.calc=Xt.clearAxisTypes=!0}else c.dataArrayContainers.indexOf(Bt.parts[0])!==-1?(m.manageArrayContainers(Bt,Me,ar),Xt.calc=!0):(nt?nt.arrayOk&&!r.traceIs(Tt,"regl")&&(M.isArrayOrTypedArray(Me)||M.isArrayOrTypedArray(Ce))?Xt.calc=!0:w.update(Xt,nt):Xt.calc=!0,Bt.set(Me))}}if(["swapxyaxes","orientationaxes"].indexOf(Je)!==-1&&s.swap(Ae,Ze),Je==="orientationaxes"){var Sr=e(Ae.layout,"hovermode"),tt=Sr.get();tt==="x"?Sr.set("y"):tt==="y"?Sr.set("x"):tt==="x unified"?Sr.set("y unified"):tt==="y unified"&&Sr.set("x unified")}if(["orientation","type"].indexOf(Je)!==-1){for(Vr=[],Nt=0;Nt<Ze.length;Nt++){var Lt=gt[Ze[Nt]];r.traceIs(Lt,"cartesian")&&(jr(Lt.xaxis||"x"),jr(Lt.yaxis||"y"))}ur(Vr.map(at),!0,0),ur(Vr.map($t),[0,1],0)}}return(Xt.calc||Xt.plot)&&(Xt.fullReplot=!0),{flags:Xt,undoit:ar,redoit:Ht,traces:Ze,eventData:M.extendDeepNoArrays([],[Dt,Ze])}}function se(Ae){var Ue=M.counterRegex("axis",".title",!1,!1),Ze=/colorbar\.title$/,Qe=Object.keys(Ae),_t,gt,wt;for(_t=0;_t<Qe.length;_t++)gt=Qe[_t],wt=Ae[gt],(gt==="title"||Ue.test(gt)||Ze.test(gt))&&(typeof wt=="string"||typeof wt=="number")?Ut(gt,gt.replace("title","title.text")):gt.indexOf("titlefont")>-1&&gt.indexOf("grouptitlefont")===-1?Ut(gt,gt.replace("titlefont","title.font")):gt.indexOf("titleposition")>-1?Ut(gt,gt.replace("titleposition","title.position")):gt.indexOf("titleside")>-1?Ut(gt,gt.replace("titleside","title.side")):gt.indexOf("titleoffset")>-1&&Ut(gt,gt.replace("titleoffset","title.offset"));function Ut(Dt,Nt){Ae[Nt]=Ae[Dt],delete Ae[Dt]}}function ae(Ae,Ue,Ze){Ae=M.getGraphDiv(Ae),m.clearPromiseQueue(Ae);var Qe={};if(typeof Ue=="string")Qe[Ue]=Ze;else if(M.isPlainObject(Ue))Qe=M.extendFlat({},Ue);else return M.warn("Relayout fail.",Ue,Ze),Promise.reject();Object.keys(Qe).length&&(Ae.changed=!0);var _t=ge(Ae,Qe),gt=_t.flags;gt.calc&&(Ae.calcdata=void 0);var wt=[c.previousPromises];gt.layoutReplot?wt.push(l.layoutReplot):Object.keys(Qe).length&&(oe(Ae,gt,_t)||c.supplyDefaults(Ae),gt.legend&&wt.push(l.doLegend),gt.layoutstyle&&wt.push(l.layoutStyles),gt.axrange&&be(wt,_t.rangesAltered),gt.ticks&&wt.push(l.doTicksRelayout),gt.modebar&&wt.push(l.doModeBar),gt.camera&&wt.push(l.doCamera),gt.colorbars&&wt.push(l.doColorBars),wt.push(L)),wt.push(c.rehover,c.redrag,c.reselect),n.add(Ae,ae,[Ae,_t.undoit],ae,[Ae,_t.redoit]);var Ut=M.syncOrAsync(wt,Ae);return(!Ut||!Ut.then)&&(Ut=Promise.resolve(Ae)),Ut.then(function(){return Ae.emit("plotly_relayout",_t.eventData),Ae})}function oe(Ae,Ue,Ze){var Qe=Ae._fullLayout;if(!Ue.axrange)return!1;for(var _t in Ue)if(_t!=="axrange"&&Ue[_t])return!1;for(var gt in Ze.rangesAltered){var wt=s.id2name(gt),Ut=Ae.layout[wt],Dt=Qe[wt];if(Dt.autorange=Ut.autorange,Ut.range&&(Dt.range=Ut.range.slice()),Dt.cleanRange(),Dt._matchGroup){for(var Nt in Dt._matchGroup)if(Nt!==gt){var Xt=Qe[s.id2name(Nt)];Xt.autorange=Dt.autorange,Xt.range=Dt.range.slice(),Xt._input.range=Dt.range.slice()}}}return!0}function be(Ae,Ue){var Ze=Ue?function(Qe){var _t=[],gt=!0;for(var wt in Ue){var Ut=s.getFromId(Qe,wt);if(_t.push(wt),(Ut.ticklabelposition||"").indexOf("inside")!==-1&&Ut._anchorAxis&&_t.push(Ut._anchorAxis._id),Ut._matchGroup)for(var Dt in Ut._matchGroup)Ue[Dt]||_t.push(Dt)}return s.draw(Qe,_t,{skipTitle:gt})}:function(Qe){return s.draw(Qe,"redraw")};Ae.push(f,l.doAutoRangeAndConstraints,Ze,l.drawData,l.finalDraw)}var ce=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,de=/^[xyz]axis[0-9]*\.autorange$/,ye=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function ge(Ae,Ue){var Ze=Ae.layout,Qe=Ae._fullLayout,_t=Qe._guiEditing,gt=ne(Qe._preGUI,_t),wt=Object.keys(Ue),Ut=s.list(Ae),Dt=M.extendDeepAll({},Ue),Nt={},Xt,Ht,ar;for(se(Ue),wt=Object.keys(Ue),Ht=0;Ht<wt.length;Ht++)if(wt[Ht].indexOf("allaxes")===0){for(ar=0;ar<Ut.length;ar++){var Vr=Ut[ar]._id.substr(1),nn=Vr.indexOf("scene")!==-1?Vr+".":"",jr=wt[Ht].replace("allaxes",nn+Ut[ar]._name);Ue[jr]||(Ue[jr]=Ue[wt[Ht]])}delete Ue[wt[Ht]]}var at=w.layoutFlags(),$t={},Zt={};function ur(Er,_r){if(Array.isArray(Er)){Er.forEach(function(wn){ur(wn,_r)});return}if(!(Er in Ue||m.hasParent(Ue,Er))){var Gr=gt(Ze,Er);Er in Zt||(Zt[Er]=$(Gr.get())),_r!==void 0&&Gr.set(_r)}}var wr={},$e;function Je(Er){var _r=s.name2id(Er.split(".")[0]);return wr[_r]=1,_r}for(var it in Ue){if(m.hasParent(Ue,it))throw new Error("cannot set "+it+" and a parent attribute simultaneously");for(var lt=gt(Ze,it),Tt=Ue[it],Bt=lt.parts.length,Ce=Bt-1;Ce>0&&typeof lt.parts[Ce]!="string";)Ce--;var Me=lt.parts[Ce],nt=lt.parts[Ce-1]+"."+Me,st=lt.parts.slice(0,Ce).join("."),ct=e(Ae.layout,st).get(),At=e(Qe,st).get(),dt=lt.get();if(Tt!==void 0){$t[it]=Tt,Zt[it]=Me==="reverse"?Tt:$(dt);var Ct=t.getLayoutValObject(Qe,lt.parts);if(Ct&&Ct.impliedEdits&&Tt!==null)for(var Gt in Ct.impliedEdits)ur(M.relativeAttr(it,Gt),Ct.impliedEdits[Gt]);if(["width","height"].indexOf(it)!==-1)if(Tt){ur("autosize",null);var rr=it==="height"?"width":"height";ur(rr,Qe[rr])}else Qe[it]=Ae._initialAutoSize[it];else if(it==="autosize")ur("width",Tt?null:Qe.width),ur("height",Tt?null:Qe.height);else if(nt.match(ce))Je(nt),e(Qe,st+"._inputRange").set(null);else if(nt.match(de)){Je(nt),e(Qe,st+"._inputRange").set(null);var kr=e(Qe,st).get();kr._inputDomain&&(kr._input.domain=kr._inputDomain.slice())}else nt.match(ye)&&e(Qe,st+"._inputDomain").set(null);if(Me==="type"){$e=ct;var br=At.type==="linear"&&Tt==="log",Ar=At.type==="log"&&Tt==="linear";if(br||Ar){if(!$e||!$e.range)ur(st+".autorange",!0);else if(At.autorange)br&&($e.range=$e.range[1]>$e.range[0]?[1,2]:[2,1]);else{var Wr=$e.range[0],nr=$e.range[1];br?(Wr<=0&&nr<=0&&ur(st+".autorange",!0),Wr<=0?Wr=nr/1e6:nr<=0&&(nr=Wr/1e6),ur(st+".range[0]",Math.log(Wr)/Math.LN10),ur(st+".range[1]",Math.log(nr)/Math.LN10)):(ur(st+".range[0]",Math.pow(10,Wr)),ur(st+".range[1]",Math.pow(10,nr)))}Array.isArray(Qe._subplots.polar)&&Qe._subplots.polar.length&&Qe[lt.parts[0]]&&lt.parts[1]==="radialaxis"&&delete Qe[lt.parts[0]]._subplot.viewInitial["radialaxis.range"],r.getComponentMethod("annotations","convertCoords")(Ae,At,Tt,ur),r.getComponentMethod("images","convertCoords")(Ae,At,Tt,ur)}else ur(st+".autorange",!0),ur(st+".range",null);e(Qe,st+"._inputRange").set(null)}else if(Me.match(_)){var yr=e(Qe,it).get(),Pr=(Tt||{}).type;(!Pr||Pr==="-")&&(Pr="linear"),r.getComponentMethod("annotations","convertCoords")(Ae,yr,Pr,ur),r.getComponentMethod("images","convertCoords")(Ae,yr,Pr,ur)}var Or=o.containerArrayMatch(it);if(Or){Xt=Or.array,Ht=Or.index;var Sr=Or.property,tt=Ct||{editType:"calc"};Ht!==""&&Sr===""&&(o.isAddVal(Tt)?Zt[it]=null:o.isRemoveVal(Tt)?Zt[it]=(e(Ze,Xt).get()||[])[Ht]:M.warn("unrecognized full object value",Ue)),w.update(at,tt),Nt[Xt]||(Nt[Xt]={});var Lt=Nt[Xt][Ht];Lt||(Lt=Nt[Xt][Ht]={}),Lt[Sr]=Tt,delete Ue[it]}else Me==="reverse"?(ct.range?ct.range.reverse():(ur(st+".autorange",!0),ct.range=[1,0]),At.autorange?at.calc=!0:at.plot=!0):(it==="dragmode"&&(Tt===!1&&dt!==!1||Tt!==!1&&dt===!1)||Qe._has("scatter-like")&&Qe._has("regl")&&it==="dragmode"&&(Tt==="lasso"||Tt==="select")&&!(dt==="lasso"||dt==="select")||Qe._has("gl2d")?at.plot=!0:Ct?w.update(at,Ct):at.calc=!0,lt.set(Tt))}}for(Xt in Nt){var Wt=o.applyContainerArrayChanges(Ae,gt(Ze,Xt),Nt[Xt],at,gt);Wt||(at.plot=!0)}for(var ir in wr){$e=s.getFromId(Ae,ir);var Ir=$e&&$e._constraintGroup;if(Ir){at.calc=!0;for(var Br in Ir)wr[Br]||(s.getFromId(Ae,Br)._constraintShrinkable=!0)}}return(me(Ae)||Ue.height||Ue.width)&&(at.plot=!0),(at.plot||at.calc)&&(at.layoutReplot=!0),{flags:at,rangesAltered:wr,undoit:Zt,redoit:$t,eventData:Dt}}function me(Ae){var Ue=Ae._fullLayout,Ze=Ue.width,Qe=Ue.height;return Ae.layout.autosize&&c.plotAutoSize(Ae,Ae.layout,Ue),Ue.width!==Ze||Ue.height!==Qe}function Ee(Ae,Ue,Ze,Qe){Ae=M.getGraphDiv(Ae),m.clearPromiseQueue(Ae),M.isPlainObject(Ue)||(Ue={}),M.isPlainObject(Ze)||(Ze={}),Object.keys(Ue).length&&(Ae.changed=!0),Object.keys(Ze).length&&(Ae.changed=!0);var _t=m.coerceTraceIndices(Ae,Qe),gt=ie(Ae,M.extendFlat({},Ue),_t),wt=gt.flags,Ut=ge(Ae,M.extendFlat({},Ze)),Dt=Ut.flags;(wt.calc||Dt.calc)&&(Ae.calcdata=void 0),wt.clearAxisTypes&&m.clearAxisTypes(Ae,_t,Ze);var Nt=[];Dt.layoutReplot?Nt.push(l.layoutReplot):wt.fullReplot?Nt.push(te._doPlot):(Nt.push(c.previousPromises),oe(Ae,Dt,Ut)||c.supplyDefaults(Ae),wt.style&&Nt.push(l.doTraceStyle),(wt.colorbars||Dt.colorbars)&&Nt.push(l.doColorBars),Dt.legend&&Nt.push(l.doLegend),Dt.layoutstyle&&Nt.push(l.layoutStyles),Dt.axrange&&be(Nt,Ut.rangesAltered),Dt.ticks&&Nt.push(l.doTicksRelayout),Dt.modebar&&Nt.push(l.doModeBar),Dt.camera&&Nt.push(l.doCamera),Nt.push(L)),Nt.push(c.rehover,c.redrag,c.reselect),n.add(Ae,Ee,[Ae,gt.undoit,Ut.undoit,gt.traces],Ee,[Ae,gt.redoit,Ut.redoit,gt.traces]);var Xt=M.syncOrAsync(Nt,Ae);return(!Xt||!Xt.then)&&(Xt=Promise.resolve(Ae)),Xt.then(function(){return Ae.emit("plotly_update",{data:gt.eventData,layout:Ut.eventData}),Ae})}function Pe(Ae){return function(Ze){Ze._fullLayout._guiEditing=!0;var Qe=Ae.apply(null,arguments);return Ze._fullLayout._guiEditing=!1,Qe}}var Ne=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],we=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function ke(Ae,Ue){for(var Ze=0;Ze<Ue.length;Ze++){var Qe=Ue[Ze],_t=Ae.match(Qe.pattern);if(_t){var gt=_t[1]||"";return{head:gt,tail:Ae.substr(gt.length+1),attr:Qe.attr}}}}function Xe(Ae,Ue){var Ze=e(Ue,Ae).get();if(Ze!==void 0)return Ze;var Qe=Ae.split(".");for(Qe.pop();Qe.length>1;)if(Qe.pop(),Ze=e(Ue,Qe.join(".")+".uirevision").get(),Ze!==void 0)return Ze;return Ue.uirevision}function He(Ae,Ue){for(var Ze=0;Ze<Ue.length;Ze++)if(Ue[Ze]._fullInput.uid===Ae)return Ze;return-1}function Ie(Ae,Ue,Ze){for(var Qe=0;Qe<Ue.length;Qe++)if(Ue[Qe].uid===Ae)return Qe;return!Ue[Ze]||Ue[Ze].uid?-1:Ze}function De(Ae,Ue){var Ze=M.isPlainObject(Ae),Qe=Array.isArray(Ae);return Ze||Qe?(Ze&&M.isPlainObject(Ue)||Qe&&Array.isArray(Ue))&&JSON.stringify(Ae)===JSON.stringify(Ue):Ae===Ue}function Ge(Ae,Ue,Ze,Qe){var _t=Qe._preGUI,gt,wt,Ut,Dt,Nt,Xt,Ht,ar,Vr,nn,jr=[],at={},$t={};for(gt in _t){if(Nt=ke(gt,Ne),Nt){if(Vr=Nt.head,nn=Nt.tail,wt=Nt.attr||Vr+".uirevision",Ut=e(Qe,wt).get(),Dt=Ut&&Xe(wt,Ue),Dt&&Dt===Ut){if(Xt=_t[gt],Xt===null&&(Xt=void 0),Ht=e(Ue,gt),ar=Ht.get(),De(ar,Xt)){ar===void 0&&nn==="autorange"&&jr.push(Vr),Ht.set($(e(Qe,gt).get()));continue}else if(nn==="autorange"||nn.substr(0,6)==="range["){var Zt=_t[Vr+".range[0]"],ur=_t[Vr+".range[1]"],wr=_t[Vr+".autorange"];if(wr||wr===null&&Zt===null&&ur===null){if(!(Vr in at)){var $e=e(Ue,Vr).get();at[Vr]=$e&&($e.autorange||$e.autorange!==!1&&(!$e.range||$e.range.length!==2))}if(at[Vr]){Ht.set($(e(Qe,gt).get()));continue}}}}}else M.warn("unrecognized GUI edit: "+gt);delete _t[gt],Nt&&Nt.tail.substr(0,6)==="range["&&($t[Nt.head]=1)}for(var Je=0;Je<jr.length;Je++){var it=jr[Je];if($t[it]){var lt=e(Ue,it).get();lt&&delete lt.autorange}}var Tt=Qe._tracePreGUI;for(var Bt in Tt){var Ce=Tt[Bt],Me=null,nt;for(gt in Ce){if(!Me){var st=He(Bt,Ze);if(st<0){delete Tt[Bt];break}var ct=Ze[st];nt=ct._fullInput;var At=Ie(Bt,Ae,nt.index);if(At<0){delete Tt[Bt];break}Me=Ae[At]}if(Nt=ke(gt,we),Nt){if(Nt.attr?(Ut=e(Qe,Nt.attr).get(),Dt=Ut&&Xe(Nt.attr,Ue)):(Ut=nt.uirevision,Dt=Me.uirevision,Dt===void 0&&(Dt=Ue.uirevision)),Dt&&Dt===Ut&&(Xt=Ce[gt],Xt===null&&(Xt=void 0),Ht=e(Me,gt),ar=Ht.get(),De(ar,Xt))){Ht.set($(e(nt,gt).get()));continue}}else M.warn("unrecognized GUI edit: "+gt+" in trace uid "+Bt);delete Ce[gt]}}}function ht(Ae,Ue,Ze,Qe){var _t,gt;function wt(){return te.addFrames(Ae,_t)}Ae=M.getGraphDiv(Ae),m.clearPromiseQueue(Ae);var Ut=Ae._fullData,Dt=Ae._fullLayout;if(!M.isPlotDiv(Ae)||!Ut||!Dt)gt=te.newPlot(Ae,Ue,Ze,Qe);else{if(M.isPlainObject(Ue)){var Nt=Ue;Ue=Nt.data,Ze=Nt.layout,Qe=Nt.config,_t=Nt.frames}var Xt=!1;if(Qe){var Ht=M.extendDeep({},Ae._context);Ae._context=void 0,z(Ae,Qe),Xt=Mt(Ht,Ae._context)}Ae.data=Ue||[],m.cleanData(Ae.data),Ae.layout=Ze||{},m.cleanLayout(Ae.layout),Ge(Ae.data,Ae.layout,Ut,Dt),c.supplyDefaults(Ae,{skipUpdateCalc:!0});var ar=Ae._fullData,Vr=Ae._fullLayout,nn=Vr.datarevision===void 0,jr=Vr.transition,at=Kt(Ae,Dt,Vr,nn,jr),$t=at.newDataRevision,Zt=Rt(Ae,Ut,ar,nn,jr,$t);if(me(Ae)&&(at.layoutReplot=!0),Zt.calc||at.calc){Ae.calcdata=void 0;for(var ur=Object.getOwnPropertyNames(Vr),wr=0;wr<ur.length;wr++){var $e=ur[wr],Je=$e.substring(0,5);if(Je==="xaxis"||Je==="yaxis"){var it=Vr[$e]._emptyCategories;it&&it()}}}else c.supplyDefaultsUpdateCalc(Ae.calcdata,ar);var lt=[];if(_t&&(Ae._transitionData={},c.createTransitionData(Ae),lt.push(wt)),Vr.transition&&!Xt&&(Zt.anim||at.anim))at.ticks&&lt.push(l.doTicksRelayout),c.doCalcdata(Ae),l.doAutoRangeAndConstraints(Ae),lt.push(function(){return c.transitionFromReact(Ae,Zt,at,Dt)});else if(Zt.fullReplot||at.layoutReplot||Xt)Ae._fullLayout._skipDefaults=!0,lt.push(te._doPlot);else{for(var Tt in at.arrays){var Bt=at.arrays[Tt];if(Bt.length){var Ce=r.getComponentMethod(Tt,"drawOne");if(Ce!==M.noop)for(var Me=0;Me<Bt.length;Me++)Ce(Ae,Bt[Me]);else{var nt=r.getComponentMethod(Tt,"draw");if(nt===M.noop)throw new Error("cannot draw components: "+Tt);nt(Ae)}}}lt.push(c.previousPromises),Zt.style&&lt.push(l.doTraceStyle),(Zt.colorbars||at.colorbars)&&lt.push(l.doColorBars),at.legend&&lt.push(l.doLegend),at.layoutstyle&&lt.push(l.layoutStyles),at.axrange&&be(lt),at.ticks&&lt.push(l.doTicksRelayout),at.modebar&&lt.push(l.doModeBar),at.camera&&lt.push(l.doCamera),lt.push(L)}lt.push(c.rehover,c.redrag,c.reselect),gt=M.syncOrAsync(lt,Ae),(!gt||!gt.then)&&(gt=Promise.resolve(Ae))}return gt.then(function(){return Ae.emit("plotly_react",{data:Ue,layout:Ze}),Ae})}function Rt(Ae,Ue,Ze,Qe,_t,gt){var wt=Ue.length===Ze.length;if(!_t&&!wt)return{fullReplot:!0,calc:!0};var Ut=w.traceFlags();Ut.arrays={},Ut.nChanges=0,Ut.nChangesAnim=0;var Dt,Nt;function Xt(Vr){var nn=t.getTraceValObject(Nt,Vr);return!Nt._module.animatable&&nn.anim&&(nn.anim=!1),nn}var Ht={getValObject:Xt,flags:Ut,immutable:Qe,transition:_t,newDataRevision:gt,gd:Ae},ar={};for(Dt=0;Dt<Ue.length;Dt++)if(Ze[Dt]){if(Nt=Ze[Dt]._fullInput,c.hasMakesDataTransform(Nt)&&(Nt=Ze[Dt]),ar[Nt.uid])continue;ar[Nt.uid]=1,It(Ue[Dt]._fullInput,Nt,[],Ht)}return(Ut.calc||Ut.plot)&&(Ut.fullReplot=!0),_t&&Ut.nChanges&&Ut.nChangesAnim&&(Ut.anim=Ut.nChanges===Ut.nChangesAnim&&wt?"all":"some"),Ut}function Kt(Ae,Ue,Ze,Qe,_t){var gt=w.layoutFlags();gt.arrays={},gt.rangesAltered={},gt.nChanges=0,gt.nChangesAnim=0;function wt(Dt){return t.getLayoutValObject(Ze,Dt)}var Ut={getValObject:wt,flags:gt,immutable:Qe,transition:_t,gd:Ae};return It(Ue,Ze,[],Ut),(gt.plot||gt.calc)&&(gt.layoutReplot=!0),_t&&gt.nChanges&&gt.nChangesAnim&&(gt.anim=gt.nChanges===gt.nChangesAnim?"all":"some"),gt}function It(Ae,Ue,Ze,Qe){var _t,gt,wt,Ut=Qe.getValObject,Dt=Qe.flags,Nt=Qe.immutable,Xt=Qe.inArray,Ht=Qe.arrayIndex;function ar(){var st=_t.editType;if(Xt&&st.indexOf("arraydraw")!==-1){M.pushUnique(Dt.arrays[Xt],Ht);return}w.update(Dt,_t),st!=="none"&&Dt.nChanges++,Qe.transition&&_t.anim&&Dt.nChangesAnim++,(ce.test(wt)||de.test(wt))&&(Dt.rangesAltered[Ze[0]]=1),ye.test(wt)&&e(Ue,"_inputDomain").set(null),gt==="datarevision"&&(Dt.newDataRevision=1)}function Vr(st){return st.valType==="data_array"||st.arrayOk}for(gt in Ae){if(Dt.calc&&!Qe.transition)return;var nn=Ae[gt],jr=Ue[gt],at=Ze.concat(gt);if(wt=at.join("."),!(gt.charAt(0)==="_"||typeof nn=="function"||nn===jr)){if((gt==="tick0"||gt==="dtick")&&Ze[0]!=="geo"){var $t=Ue.tickmode;if($t==="auto"||$t==="array"||!$t)continue}if(!(gt==="range"&&Ue.autorange)&&!((gt==="zmin"||gt==="zmax")&&Ue.type==="contourcarpet")&&(_t=Ut(at),!!_t&&!(_t._compareAsJSON&&JSON.stringify(nn)===JSON.stringify(jr)))){var Zt=_t.valType,ur,wr=Vr(_t),$e=Array.isArray(nn),Je=Array.isArray(jr);if($e&&Je){var it="_input_"+gt,lt=Ae[it],Tt=Ue[it];if(Array.isArray(lt)&&lt===Tt)continue}if(jr===void 0)wr&&$e?Dt.calc=!0:ar();else if(_t._isLinkedToArray){var Bt=[],Ce=!1;Xt||(Dt.arrays[gt]=Bt);var Me=Math.min(nn.length,jr.length),nt=Math.max(nn.length,jr.length);if(Me!==nt)if(_t.editType==="arraydraw")Ce=!0;else{ar();continue}for(ur=0;ur<Me;ur++)It(nn[ur],jr[ur],at.concat(ur),M.extendFlat({inArray:gt,arrayIndex:ur},Qe));if(Ce)for(ur=Me;ur<nt;ur++)Bt.push(ur)}else!Zt&&M.isPlainObject(nn)?It(nn,jr,at,Qe):wr?$e&&Je?(Nt&&(Dt.calc=!0),(Nt||Qe.newDataRevision)&&ar()):$e!==Je?Dt.calc=!0:ar():$e&&Je?(nn.length!==jr.length||String(nn)!==String(jr))&&ar():ar()}}}for(gt in Ue)if(!(gt in Ae||gt.charAt(0)==="_"||typeof Ue[gt]=="function"))if(_t=Ut(Ze.concat(gt)),Vr(_t)&&Array.isArray(Ue[gt])){Dt.calc=!0;return}else ar()}function Mt(Ae,Ue){var Ze;for(Ze in Ae)if(Ze.charAt(0)!=="_"){var Qe=Ae[Ze],_t=Ue[Ze];if(Qe!==_t)if(M.isPlainObject(Qe)&&M.isPlainObject(_t)){if(Mt(Qe,_t))return!0}else if(Array.isArray(Qe)&&Array.isArray(_t)){if(Qe.length!==_t.length)return!0;for(var gt=0;gt<Qe.length;gt++)if(Qe[gt]!==_t[gt])if(M.isPlainObject(Qe[gt])&&M.isPlainObject(_t[gt])){if(Mt(Qe[gt],_t[gt]))return!0}else return!0}else return!0}}function Yt(Ae,Ue,Ze){if(Ae=M.getGraphDiv(Ae),!M.isPlotDiv(Ae))throw new Error("This element is not a Plotly plot: "+Ae+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var Qe=Ae._transitionData;Qe._frameQueue||(Qe._frameQueue=[]),Ze=c.supplyAnimationDefaults(Ze);var _t=Ze.transition,gt=Ze.frame;Qe._frameWaitingCnt===void 0&&(Qe._frameWaitingCnt=0);function wt(Nt){return Array.isArray(_t)?Nt>=_t.length?_t[0]:_t[Nt]:_t}function Ut(Nt){return Array.isArray(gt)?Nt>=gt.length?gt[0]:gt[Nt]:gt}function Dt(Nt,Xt){var Ht=0;return function(){if(Nt&&++Ht===Xt)return Nt()}}return new Promise(function(Nt,Xt){function Ht(){if(Qe._frameQueue.length!==0){for(;Qe._frameQueue.length;){var Me=Qe._frameQueue.pop();Me.onInterrupt&&Me.onInterrupt()}Ae.emit("plotly_animationinterrupted",[])}}function ar(Me){if(Me.length!==0){for(var nt=0;nt<Me.length;nt++){var st;Me[nt].type==="byname"?st=c.computeFrame(Ae,Me[nt].name):st=Me[nt].data;var ct=Ut(nt),At=wt(nt);At.duration=Math.min(At.duration,ct.duration);var dt={frame:st,name:Me[nt].name,frameOpts:ct,transitionOpts:At};nt===Me.length-1&&(dt.onComplete=Dt(Nt,2),dt.onInterrupt=Xt),Qe._frameQueue.push(dt)}Ze.mode==="immediate"&&(Qe._lastFrameAt=-1/0),Qe._animationRaf||jr()}}function Vr(){Ae.emit("plotly_animated"),window.cancelAnimationFrame(Qe._animationRaf),Qe._animationRaf=null}function nn(){Qe._currentFrame&&Qe._currentFrame.onComplete&&Qe._currentFrame.onComplete();var Me=Qe._currentFrame=Qe._frameQueue.shift();if(Me){var nt=Me.name?Me.name.toString():null;Ae._fullLayout._currentFrame=nt,Qe._lastFrameAt=Date.now(),Qe._timeToNext=Me.frameOpts.duration,c.transition(Ae,Me.frame.data,Me.frame.layout,m.coerceTraceIndices(Ae,Me.frame.traces),Me.frameOpts,Me.transitionOpts).then(function(){Me.onComplete&&Me.onComplete()}),Ae.emit("plotly_animatingframe",{name:nt,frame:Me.frame,animation:{frame:Me.frameOpts,transition:Me.transitionOpts}})}else Vr()}function jr(){Ae.emit("plotly_animating"),Qe._lastFrameAt=-1/0,Qe._timeToNext=0,Qe._runningTransitions=0,Qe._currentFrame=null;var Me=function(){Qe._animationRaf=window.requestAnimationFrame(Me),Date.now()-Qe._lastFrameAt>Qe._timeToNext&&nn()};Me()}var at=0;function $t(Me){return Array.isArray(_t)?at>=_t.length?Me.transitionOpts=_t[at]:Me.transitionOpts=_t[0]:Me.transitionOpts=_t,at++,Me}var Zt,ur,wr=[],$e=Ue==null,Je=Array.isArray(Ue),it=!$e&&!Je&&M.isPlainObject(Ue);if(it)wr.push({type:"object",data:$t(M.extendFlat({},Ue))});else if($e||["string","number"].indexOf(typeof Ue)!==-1)for(Zt=0;Zt<Qe._frames.length;Zt++)ur=Qe._frames[Zt],!!ur&&($e||String(ur.group)===String(Ue))&&wr.push({type:"byname",name:String(ur.name),data:$t({name:ur.name})});else if(Je)for(Zt=0;Zt<Ue.length;Zt++){var lt=Ue[Zt];["number","string"].indexOf(typeof lt)!==-1?(lt=String(lt),wr.push({type:"byname",name:lt,data:$t({name:lt})})):M.isPlainObject(lt)&&wr.push({type:"object",data:$t(M.extendFlat({},lt))})}for(Zt=0;Zt<wr.length;Zt++)if(ur=wr[Zt],ur.type==="byname"&&!Qe._frameHash[ur.data.name]){M.warn('animate failure: frame not found: "'+ur.data.name+'"'),Xt();return}["next","immediate"].indexOf(Ze.mode)!==-1&&Ht(),Ze.direction==="reverse"&&wr.reverse();var Tt=Ae._fullLayout._currentFrame;if(Tt&&Ze.fromcurrent){var Bt=-1;for(Zt=0;Zt<wr.length;Zt++)if(ur=wr[Zt],ur.type==="byname"&&ur.name===Tt){Bt=Zt;break}if(Bt>0&&Bt<wr.length-1){var Ce=[];for(Zt=0;Zt<wr.length;Zt++)ur=wr[Zt],(wr[Zt].type!=="byname"||Zt>Bt)&&Ce.push(ur);wr=Ce}}wr.length>0?ar(wr):(Ae.emit("plotly_animated"),Nt())})}function zt(Ae,Ue,Ze){if(Ae=M.getGraphDiv(Ae),Ue==null)return Promise.resolve();if(!M.isPlotDiv(Ae))throw new Error("This element is not a Plotly plot: "+Ae+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var Qe,_t,gt,wt,Ut=Ae._transitionData._frames,Dt=Ae._transitionData._frameHash;if(!Array.isArray(Ue))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+Ue);var Nt=Ut.length+Ue.length*2,Xt=[],Ht={};for(Qe=Ue.length-1;Qe>=0;Qe--)if(!!M.isPlainObject(Ue[Qe])){var ar=Ue[Qe].name,Vr=(Dt[ar]||Ht[ar]||{}).name,nn=Ue[Qe].name,jr=Dt[Vr]||Ht[Vr];Vr&&nn&&typeof nn=="number"&&jr&&h<b&&(h++,M.warn('addFrames: overwriting frame "'+(Dt[Vr]||Ht[Vr]).name+'" with a frame whose name of type "number" also equates to "'+Vr+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),h===b&&M.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),Ht[ar]={name:ar},Xt.push({frame:c.supplyFrameDefaults(Ue[Qe]),index:Ze&&Ze[Qe]!==void 0&&Ze[Qe]!==null?Ze[Qe]:Nt+Qe})}Xt.sort(function(it,lt){return it.index>lt.index?-1:it.index<lt.index?1:0});var at=[],$t=[],Zt=Ut.length;for(Qe=Xt.length-1;Qe>=0;Qe--){if(_t=Xt[Qe].frame,typeof _t.name=="number"&&M.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!_t.name)for(;Dt[_t.name="frame "+Ae._transitionData._counter++];);if(Dt[_t.name]){for(gt=0;gt<Ut.length&&(Ut[gt]||{}).name!==_t.name;gt++);at.push({type:"replace",index:gt,value:_t}),$t.unshift({type:"replace",index:gt,value:Ut[gt]})}else wt=Math.max(0,Math.min(Xt[Qe].index,Zt)),at.push({type:"insert",index:wt,value:_t}),$t.unshift({type:"delete",index:wt}),Zt++}var ur=c.modifyFrames,wr=c.modifyFrames,$e=[Ae,$t],Je=[Ae,at];return n&&n.add(Ae,ur,$e,wr,Je),c.modifyFrames(Ae,at)}function St(Ae,Ue){if(Ae=M.getGraphDiv(Ae),!M.isPlotDiv(Ae))throw new Error("This element is not a Plotly plot: "+Ae);var Ze,Qe,_t=Ae._transitionData._frames,gt=[],wt=[];if(!Ue)for(Ue=[],Ze=0;Ze<_t.length;Ze++)Ue.push(Ze);for(Ue=Ue.slice(),Ue.sort(),Ze=Ue.length-1;Ze>=0;Ze--)Qe=Ue[Ze],gt.push({type:"delete",index:Qe}),wt.unshift({type:"insert",index:Qe,value:_t[Qe]});var Ut=c.modifyFrames,Dt=c.modifyFrames,Nt=[Ae,wt],Xt=[Ae,gt];return n&&n.add(Ae,Ut,Nt,Dt,Xt),c.modifyFrames(Ae,gt)}function Ye(Ae){Ae=M.getGraphDiv(Ae);var Ue=Ae._fullLayout||{},Ze=Ae._fullData||[];return c.cleanPlot([],{},Ze,Ue),c.purge(Ae),a.purge(Ae),Ue._container&&Ue._container.remove(),delete Ae._context,Ae}function rt(Ae){var Ue=Ae._fullLayout,Ze=Ae.getBoundingClientRect();if(!M.equalDomRects(Ze,Ue._lastBBox)){var Qe=Ue._invTransform=M.inverseTransformMatrix(M.getFullTransformMatrix(Ae));Ue._invScaleX=Math.sqrt(Qe[0][0]*Qe[0][0]+Qe[0][1]*Qe[0][1]+Qe[0][2]*Qe[0][2]),Ue._invScaleY=Math.sqrt(Qe[1][0]*Qe[1][0]+Qe[1][1]*Qe[1][1]+Qe[1][2]*Qe[1][2]),Ue._lastBBox=Ze}}function Ve(Ae){var Ue=A.select(Ae),Ze=Ae._fullLayout;if(Ze._calcInverseTransform=rt,Ze._calcInverseTransform(Ae),Ze._container=Ue.selectAll(".plot-container").data([0]),Ze._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),Ze._paperdiv=Ze._container.selectAll(".svg-container").data([0]),Ze._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),Ze._glcontainer=Ze._paperdiv.selectAll(".gl-container").data([{}]),Ze._glcontainer.enter().append("div").classed("gl-container",!0),Ze._paperdiv.selectAll(".main-svg").remove(),Ze._paperdiv.select(".modebar-container").remove(),Ze._paper=Ze._paperdiv.insert("svg",":first-child").classed("main-svg",!0),Ze._toppaper=Ze._paperdiv.append("svg").classed("main-svg",!0),Ze._modebardiv=Ze._paperdiv.append("div"),delete Ze._modeBar,Ze._hoverpaper=Ze._paperdiv.append("svg").classed("main-svg",!0),!Ze._uid){var Qe={};A.selectAll("defs").each(function(){this.id&&(Qe[this.id.split("-")[1]]=1)}),Ze._uid=M.randstr(Qe)}Ze._paperdiv.selectAll(".main-svg").attr(v.svgAttrs),Ze._defs=Ze._paper.append("defs").attr("id","defs-"+Ze._uid),Ze._clips=Ze._defs.append("g").classed("clips",!0),Ze._topdefs=Ze._toppaper.append("defs").attr("id","topdefs-"+Ze._uid),Ze._topclips=Ze._topdefs.append("g").classed("clips",!0),Ze._bgLayer=Ze._paper.append("g").classed("bglayer",!0),Ze._draggers=Ze._paper.append("g").classed("draglayer",!0);var _t=Ze._paper.append("g").classed("layer-below",!0);Ze._imageLowerLayer=_t.append("g").classed("imagelayer",!0),Ze._shapeLowerLayer=_t.append("g").classed("shapelayer",!0),Ze._cartesianlayer=Ze._paper.append("g").classed("cartesianlayer",!0),Ze._polarlayer=Ze._paper.append("g").classed("polarlayer",!0),Ze._smithlayer=Ze._paper.append("g").classed("smithlayer",!0),Ze._ternarylayer=Ze._paper.append("g").classed("ternarylayer",!0),Ze._geolayer=Ze._paper.append("g").classed("geolayer",!0),Ze._funnelarealayer=Ze._paper.append("g").classed("funnelarealayer",!0),Ze._pielayer=Ze._paper.append("g").classed("pielayer",!0),Ze._iciclelayer=Ze._paper.append("g").classed("iciclelayer",!0),Ze._treemaplayer=Ze._paper.append("g").classed("treemaplayer",!0),Ze._sunburstlayer=Ze._paper.append("g").classed("sunburstlayer",!0),Ze._indicatorlayer=Ze._toppaper.append("g").classed("indicatorlayer",!0),Ze._glimages=Ze._paper.append("g").classed("glimages",!0);var gt=Ze._toppaper.append("g").classed("layer-above",!0);Ze._imageUpperLayer=gt.append("g").classed("imagelayer",!0),Ze._shapeUpperLayer=gt.append("g").classed("shapelayer",!0),Ze._selectionLayer=Ze._toppaper.append("g").classed("selectionlayer",!0),Ze._infolayer=Ze._toppaper.append("g").classed("infolayer",!0),Ze._menulayer=Ze._toppaper.append("g").classed("menulayer",!0),Ze._zoomlayer=Ze._toppaper.append("g").classed("zoomlayer",!0),Ze._hoverlayer=Ze._hoverpaper.append("g").classed("hoverlayer",!0),Ze._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),Ae.emit("plotly_framework")}te.animate=Yt,te.addFrames=zt,te.deleteFrames=St,te.addTraces=j,te.deleteTraces=q,te.extendTraces=re,te.moveTraces=V,te.prependTraces=ue,te.newPlot=D,te._doPlot=u,te.purge=Ye,te.react=ht,te.redraw=I,te.relayout=ae,te.restyle=U,te.setPlotConfig=T,te.update=Ee,te._guiRelayout=Pe(ae),te._guiRestyle=Pe(U),te._guiUpdate=Pe(Ee),te._storeDirectGUIEdit=Q},{"../components/color":367,"../components/drawing":389,"../components/selections":455,"../constants/xmlns_namespaces":492,"../lib":515,"../lib/events":504,"../lib/queue":531,"../plots/cartesian/axes":566,"../plots/cartesian/constants":573,"../plots/cartesian/graph_interact":576,"../plots/plots":628,"../registry":647,"./edit_types":548,"./helpers":549,"./manage_arrays":551,"./plot_config":553,"./plot_schema":554,"./subroutines":556,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],553:[function(d,ee,te){var A={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},editSelection:{valType:"boolean",dflt:!0},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},g={};function S(M,e){for(var a in M){var n=M[a];n.valType?e[a]=n.dflt:(e[a]||(e[a]={}),S(n,e[a]))}}S(A,g),ee.exports={configAttributes:A,dfltConfig:g}},{}],554:[function(d,ee,te){var A=d("../registry"),g=d("../lib"),S=d("../plots/attributes"),M=d("../plots/layout_attributes"),e=d("../plots/frame_attributes"),a=d("../plots/animation_attributes"),n=d("./plot_config").configAttributes,r=d("./edit_types"),t=g.extendDeepAll,c=g.isPlainObject,s=g.isArrayOrTypedArray,i=g.nestedProperty,x=g.valObjectMeta,p="_isSubplotObj",v="_isLinkedToArray",f="_arrayAttrRegexps",y="_deprecated",o=[p,v,f,y];te.IS_SUBPLOT_OBJ=p,te.IS_LINKED_TO_ARRAY=v,te.DEPRECATED=y,te.UNDERSCORE_ATTRS=o,te.get=function(){var D={};A.allTypes.forEach(function(O){D[O]=_(O)});var R={};return Object.keys(A.transformsRegistry).forEach(function(O){R[O]=b(O)}),{defs:{valObjects:x,metaKeys:o.concat(["description","role","editType","impliedEdits"]),editType:{traces:r.traces,layout:r.layout},impliedEdits:{}},traces:D,layout:h(),transforms:R,frames:u(),animation:L(a),config:L(n)}},te.crawl=function(D,R,O,F){var N=O||0;F=F||"",Object.keys(D).forEach(function(G){var K=D[G];if(o.indexOf(G)===-1){var W=(F?F+".":"")+G;R(K,G,D,N,W),!te.isValObject(K)&&c(K)&&G!=="impliedEdits"&&te.crawl(K,R,N+1,W)}})},te.isValObject=function(D){return D&&D.valType!==void 0},te.findArrayAttributes=function(D){var R=[],O=[],F=[],N,G;function K(q,V,U,$){O=O.slice(0,$).concat([V]),F=F.slice(0,$).concat([q&&q._isLinkedToArray]);var ne=q&&(q.valType==="data_array"||q.arrayOk===!0)&&!(O[$-1]==="colorbar"&&(V==="ticktext"||V==="tickvals"));!ne||W(N,0,"")}function W(q,V,U){var $=q[O[V]],ne=U+O[V];if(V===O.length-1)s($)&&R.push(G+ne);else if(F[V]){if(Array.isArray($))for(var X=0;X<$.length;X++)c($[X])&&W($[X],V+1,ne+"["+X+"].")}else c($)&&W($,V+1,ne+".")}N=D,G="",te.crawl(S,K),D._module&&D._module.attributes&&te.crawl(D._module.attributes,K);var Y=D.transforms;if(Y)for(var re=0;re<Y.length;re++){var ue=Y[re],j=ue._module;j&&(G="transforms["+re+"].",N=ue,te.crawl(j.attributes,K))}return R},te.getTraceValObject=function(D,R){var O=R[0],F=1,N,G;if(O==="transforms"){if(R.length===1)return S.transforms;var K=D.transforms;if(!Array.isArray(K)||!K.length)return!1;var W=R[1];if(!w(W)||W>=K.length)return!1;N=(A.transformsRegistry[K[W].type]||{}).attributes,G=N&&N[R[2]],F=3}else{var Y=D._module;if(Y||(Y=(A.modules[D.type||S.type.dflt]||{})._module),!Y)return!1;if(N=Y.attributes,G=N&&N[O],!G){var re=Y.basePlotModule;re&&re.attributes&&(G=re.attributes[O])}G||(G=S[O])}return l(G,R,F)},te.getLayoutValObject=function(D,R){var O=m(D,R[0]);return l(O,R,1)};function m(D,R){var O,F,N,G,K=D._basePlotModules;if(K){var W;for(O=0;O<K.length;O++){if(N=K[O],N.attrRegex&&N.attrRegex.test(R)){if(N.layoutAttrOverrides)return N.layoutAttrOverrides;!W&&N.layoutAttributes&&(W=N.layoutAttributes)}var Y=N.baseLayoutAttrOverrides;if(Y&&R in Y)return Y[R]}if(W)return W}var re=D._modules;if(re){for(O=0;O<re.length;O++)if(G=re[O].layoutAttributes,G&&R in G)return G[R]}for(F in A.componentsRegistry){if(N=A.componentsRegistry[F],N.name==="colorscale"&&R.indexOf("coloraxis")===0)return N.layoutAttributes[R];if(!N.schema&&R===N.name)return N.layoutAttributes}return R in M?M[R]:!1}function l(D,R,O){if(!D)return!1;if(D._isLinkedToArray){if(w(R[O]))O++;else if(O<R.length)return!1}for(;O<R.length;O++){var F=D[R[O]];if(c(F))D=F;else break;if(O===R.length-1)break;if(D._isLinkedToArray){if(O++,!w(R[O]))return!1}else if(D.valType==="info_array"){O++;var N=R[O];if(!w(N))return!1;var G=D.items;if(Array.isArray(G)){if(N>=G.length)return!1;if(D.dimensions===2){if(O++,R.length===O)return D;var K=R[O];if(!w(K))return!1;D=G[N][K]}else D=G[N]}else D=G}}return D}function w(D){return D===Math.round(D)&&D>=0}function _(D){var R,O;R=A.modules[D]._module,O=R.basePlotModule;var F={};F.type=null;var N=t({},S),G=t({},R.attributes);te.crawl(G,function(Y,re,ue,j,q){i(N,q).set(void 0),Y===void 0&&i(G,q).set(void 0)}),t(F,N),A.traceIs(D,"noOpacity")&&delete F.opacity,A.traceIs(D,"showLegend")||(delete F.showlegend,delete F.legendgroup),A.traceIs(D,"noHover")&&(delete F.hoverinfo,delete F.hoverlabel),R.selectPoints||delete F.selectedpoints,t(F,G),O.attributes&&t(F,O.attributes),F.type=D;var K={meta:R.meta||{},categories:R.categories||{},animatable:Boolean(R.animatable),type:D,attributes:L(F)};if(R.layoutAttributes){var W={};t(W,R.layoutAttributes),K.layoutAttributes=L(W)}return R.animatable||te.crawl(K,function(Y){te.isValObject(Y)&&"anim"in Y&&delete Y.anim}),K}function h(){var D={},R,O;t(D,M);for(R in A.subplotsRegistry)if(O=A.subplotsRegistry[R],!!O.layoutAttributes)if(Array.isArray(O.attr))for(var F=0;F<O.attr.length;F++)z(D,O,O.attr[F]);else{var N=O.attr==="subplot"?O.name:O.attr;z(D,O,N)}for(R in A.componentsRegistry){O=A.componentsRegistry[R];var G=O.schema;if(G&&(G.subplots||G.layout)){var K=G.subplots;if(K&&K.xaxis&&!K.yaxis)for(var W in K.xaxis)delete D.yaxis[W]}else O.name==="colorscale"?t(D,O.layoutAttributes):O.layoutAttributes&&I(D,O.layoutAttributes,O.name)}return{layoutAttributes:L(D)}}function b(D){var R=A.transformsRegistry[D],O=t({},R.attributes);return Object.keys(A.componentsRegistry).forEach(function(F){var N=A.componentsRegistry[F];N.schema&&N.schema.transforms&&N.schema.transforms[D]&&Object.keys(N.schema.transforms[D]).forEach(function(G){I(O,N.schema.transforms[D][G],G)})}),{attributes:L(O)}}function u(){var D={frames:t({},e)};return L(D),D.frames}function L(D){return T(D),k(D),P(D),D}function T(D){function R(F){return{valType:"string",editType:"none"}}function O(F,N,G){te.isValObject(F)?(F.arrayOk===!0||F.valType==="data_array")&&(G[N+"src"]=R()):c(F)&&(F.role="object")}te.crawl(D,O)}function k(D){function R(O,F,N){if(!!O){var G=O[v];!G||(delete O[v],N[F]={items:{}},N[F].items[G]=O,N[F].role="object")}}te.crawl(D,R)}function P(D){function R(O){for(var F in O)if(c(O[F]))R(O[F]);else if(Array.isArray(O[F]))for(var N=0;N<O[F].length;N++)R(O[F][N]);else O[F]instanceof RegExp&&(O[F]=O[F].toString())}R(D)}function z(D,R,O){var F=i(D,O),N=t({},R.layoutAttributes);N[p]=!0,F.set(N)}function I(D,R,O){var F=i(D,O);F.set(t(F.get()||{},R))}},{"../lib":515,"../plots/animation_attributes":560,"../plots/attributes":562,"../plots/frame_attributes":595,"../plots/layout_attributes":619,"../registry":647,"./edit_types":548,"./plot_config":553}],555:[function(d,ee,te){var A=d("../lib"),g=d("../plots/attributes"),S="templateitemname",M={name:{valType:"string",editType:"none"}};M[S]={valType:"string",editType:"calc"},te.templatedArray=function(n,r){return r._isLinkedToArray=n,r.name=M.name,r[S]=M[S],r},te.traceTemplater=function(n){var r={},t,c;for(t in n)c=n[t],Array.isArray(c)&&c.length&&(r[t]=0);function s(i){t=A.coerce(i,{},g,"type");var x={type:t,_template:null};if(t in r){c=n[t];var p=r[t]%c.length;r[t]++,x._template=c[p]}return x}return{newTrace:s}},te.newContainer=function(n,r,t){var c=n._template,s=c&&(c[r]||t&&c[t]);A.isPlainObject(s)||(s=null);var i=n[r]={_template:s};return i},te.arrayTemplater=function(n,r,t){var c=n._template,s=c&&c[a(r)],i=c&&c[r];(!Array.isArray(i)||!i.length)&&(i=[]);var x={};function p(f){var y={name:f.name,_input:f},o=y[S]=f[S];if(!e(o))return y._template=s,y;for(var m=0;m<i.length;m++){var l=i[m];if(l.name===o)return x[o]=1,y._template=l,y}return y[t]=f[t]||!1,y._template=!1,y}function v(){for(var f=[],y=0;y<i.length;y++){var o=i[y],m=o.name;if(e(m)&&!x[m]){var l={_template:o,name:m,_input:{_templateitemname:m}};l[S]=o[S],f.push(l),x[m]=1}}return f}return{newItem:p,defaultItems:v}};function e(n){return n&&typeof n=="string"}function a(n){var r=n.length-1;return n.charAt(r)!=="s"&&A.warn("bad argument to arrayDefaultKey: "+n),n.substr(0,n.length-1)+"defaults"}te.arrayDefaultKey=a,te.arrayEditor=function(n,r,t){var c=(A.nestedProperty(n,r).get()||[]).length,s=t._index,i=s>=c&&(t._input||{})._templateitemname;i&&(s=c);var x=r+"["+s+"]",p;function v(){p={},i&&(p[x]={},p[x][S]=i)}v();function f(l,w){p[l]=w}function y(l,w){i?A.nestedProperty(p[x],l).set(w):p[x+"."+l]=w}function o(){var l=p;return v(),l}function m(l,w){l&&y(l,w);var _=o();for(var h in _)A.nestedProperty(n,h).set(_[h])}return{modifyBase:f,modifyItem:y,getUpdateObj:o,applyUpdate:m}}},{"../lib":515,"../plots/attributes":562}],556:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../registry"),S=d("../plots/plots"),M=d("../lib"),e=d("../lib/clear_gl_canvases"),a=d("../components/color"),n=d("../components/drawing"),r=d("../components/titles"),t=d("../components/modebar"),c=d("../plots/cartesian/axes"),s=d("../constants/alignment"),i=d("../plots/cartesian/constraints"),x=i.enforce,p=i.clean,v=d("../plots/cartesian/autorange").doAutoRange,f="start",y="middle",o="end";te.layoutStyles=function(k){return M.syncOrAsync([S.doAutoMargin,l],k)};function m(k,P,z){for(var I=0;I<z.length;I++){var D=z[I][0],R=z[I][1];if(!(D[0]>=k[1]||D[1]<=k[0])&&R[0]<P[1]&&R[1]>P[0])return!0}return!1}function l(k){var P=k._fullLayout,z=P._size,I=z.p,D=c.list(k,"",!0),R,O,F,N,G,K;if(P._paperdiv.style({width:k._context.responsive&&P.autosize&&!k._context._hasZeroWidth&&!k.layout.width?"100%":P.width+"px",height:k._context.responsive&&P.autosize&&!k._context._hasZeroHeight&&!k.layout.height?"100%":P.height+"px"}).selectAll(".main-svg").call(n.setSize,P.width,P.height),k._context.setBackground(k,P.paper_bgcolor),te.drawMainTitle(k),t.manage(k),!P._has("cartesian"))return S.previousPromises(k);function W(Mt,Yt,zt){var St=Mt._lw/2;if(Mt._id.charAt(0)==="x"){if(Yt){if(zt==="top")return Yt._offset-I-St}else return z.t+z.h*(1-(Mt.position||0))+St%1;return Yt._offset+Yt._length+I+St}if(Yt){if(zt==="right")return Yt._offset+Yt._length+I+St}else return z.l+z.w*(Mt.position||0)+St%1;return Yt._offset-I-St}for(R=0;R<D.length;R++){N=D[R];var Y=N._anchorAxis;N._linepositions={},N._lw=n.crispRound(k,N.linewidth,1),N._mainLinePosition=W(N,Y,N.side),N._mainMirrorPosition=N.mirror&&Y?W(N,Y,s.OPPOSITE_SIDE[N.side]):null}var re=[],ue=[],j=[],q=a.opacity(P.paper_bgcolor)===1&&a.opacity(P.plot_bgcolor)===1&&P.paper_bgcolor===P.plot_bgcolor;for(O in P._plots)if(F=P._plots[O],F.mainplot)F.bg&&F.bg.remove(),F.bg=void 0;else{var V=F.xaxis.domain,U=F.yaxis.domain,$=F.plotgroup;if(m(V,U,j)){var ne=$.node(),X=F.bg=M.ensureSingle($,"rect","bg");ne.insertBefore(X.node(),ne.childNodes[0]),ue.push(O)}else $.select("rect.bg").remove(),j.push([V,U]),q||(re.push(O),ue.push(O))}var Q=P._bgLayer.selectAll(".bg").data(re);for(Q.enter().append("rect").classed("bg",!0),Q.exit().remove(),Q.each(function(Mt){P._plots[Mt].bg=A.select(this)}),R=0;R<ue.length;R++)F=P._plots[ue[R]],G=F.xaxis,K=F.yaxis,F.bg&&G._offset!==void 0&&K._offset!==void 0&&F.bg.call(n.setRect,G._offset-I,K._offset-I,G._length+2*I,K._length+2*I).call(a.fill,P.plot_bgcolor).style("stroke-width",0);if(!P._hasOnlyLargeSploms)for(O in P._plots){F=P._plots[O],G=F.xaxis,K=F.yaxis;var ie=F.clipId="clip"+P._uid+O+"plot",se=M.ensureSingleById(P._clips,"clipPath",ie,function(Mt){Mt.classed("plotclip",!0).append("rect")});F.clipRect=se.select("rect").attr({width:G._length,height:K._length}),n.setTranslate(F.plot,G._offset,K._offset);var ae,oe;F._hasClipOnAxisFalse?(ae=null,oe=ie):(ae=ie,oe=null),n.setClipUrl(F.plot,ae,k),F.layerClipId=oe}var be,ce,de,ye,ge,me,Ee,Pe,Ne,we,ke,Xe,He;function Ie(Mt){return"M"+be+","+Mt+"H"+ce}function De(Mt){return"M"+G._offset+","+Mt+"h"+G._length}function Ge(Mt){return"M"+Mt+","+Pe+"V"+Ee}function ht(Mt){return"M"+Mt+","+K._offset+"v"+K._length}function Rt(Mt,Yt,zt){if(!Mt.showline||O!==Mt._mainSubplot)return"";if(!Mt._anchorAxis)return zt(Mt._mainLinePosition);var St=Yt(Mt._mainLinePosition);return Mt.mirror&&(St+=Yt(Mt._mainMirrorPosition)),St}for(O in P._plots){F=P._plots[O],G=F.xaxis,K=F.yaxis;var Kt="M0,0";w(G,O)&&(ge=h(G,"left",K,D),be=G._offset-(ge?I+ge:0),me=h(G,"right",K,D),ce=G._offset+G._length+(me?I+me:0),de=W(G,K,"bottom"),ye=W(G,K,"top"),He=!G._anchorAxis||O!==G._mainSubplot,He&&(G.mirror==="allticks"||G.mirror==="all")&&(G._linepositions[O]=[de,ye]),Kt=Rt(G,Ie,De),He&&G.showline&&(G.mirror==="all"||G.mirror==="allticks")&&(Kt+=Ie(de)+Ie(ye)),F.xlines.style("stroke-width",G._lw+"px").call(a.stroke,G.showline?G.linecolor:"rgba(0,0,0,0)")),F.xlines.attr("d",Kt);var It="M0,0";w(K,O)&&(ke=h(K,"bottom",G,D),Ee=K._offset+K._length+(ke?I:0),Xe=h(K,"top",G,D),Pe=K._offset-(Xe?I:0),Ne=W(K,G,"left"),we=W(K,G,"right"),He=!K._anchorAxis||O!==K._mainSubplot,He&&(K.mirror==="allticks"||K.mirror==="all")&&(K._linepositions[O]=[Ne,we]),It=Rt(K,Ge,ht),He&&K.showline&&(K.mirror==="all"||K.mirror==="allticks")&&(It+=Ge(Ne)+Ge(we)),F.ylines.style("stroke-width",K._lw+"px").call(a.stroke,K.showline?K.linecolor:"rgba(0,0,0,0)")),F.ylines.attr("d",It)}return c.makeClipPaths(k),S.previousPromises(k)}function w(k,P){return(k.ticks||k.showline)&&(P===k._mainSubplot||k.mirror==="all"||k.mirror==="allticks")}function _(k,P,z){if(!z.showline||!z._lw)return!1;if(z.mirror==="all"||z.mirror==="allticks")return!0;var I=z._anchorAxis;if(!I)return!1;var D=s.FROM_BL[P];return z.side===P?I.domain[D]===k.domain[D]:z.mirror&&I.domain[1-D]===k.domain[1-D]}function h(k,P,z,I){if(_(k,P,z))return z._lw;for(var D=0;D<I.length;D++){var R=I[D];if(R._mainAxis===z._mainAxis&&_(k,P,R))return R._lw}return 0}te.drawMainTitle=function(k){var P=k._fullLayout,z=L(P),I=T(P);r.draw(k,"gtitle",{propContainer:P,propName:"title.text",placeholder:P._dfltTitle.plot,attributes:{x:b(P,z),y:u(P,I),"text-anchor":z,dy:I}})};function b(k,P){var z=k.title,I=k._size,D=0;switch(P===f?D=z.pad.l:P===o&&(D=-z.pad.r),z.xref){case"paper":return I.l+I.w*z.x+D;case"container":default:return k.width*z.x+D}}function u(k,P){var z=k.title,I=k._size,D=0;if(P==="0em"||!P?D=-z.pad.b:P===s.CAP_SHIFT+"em"&&(D=z.pad.t),z.y==="auto")return I.t/2;switch(z.yref){case"paper":return I.t+I.h-I.h*z.y+D;case"container":default:return k.height-k.height*z.y+D}}function L(k){var P=k.title,z=y;return M.isRightAnchor(P)?z=o:M.isLeftAnchor(P)&&(z=f),z}function T(k){var P=k.title,z="0em";return M.isTopAnchor(P)?z=s.CAP_SHIFT+"em":M.isMiddleAnchor(P)&&(z=s.MID_SHIFT+"em"),z}te.doTraceStyle=function(k){var P=k.calcdata,z=[],I;for(I=0;I<P.length;I++){var D=P[I],R=D[0]||{},O=R.trace||{},F=O._module||{},N=F.arraysToCalcdata;N&&N(D,O);var G=F.editStyle;G&&z.push({fn:G,cd0:R})}if(z.length){for(I=0;I<z.length;I++){var K=z[I];K.fn(k,K.cd0)}e(k),te.redrawReglTraces(k)}return S.style(k),g.getComponentMethod("legend","draw")(k),S.previousPromises(k)},te.doColorBars=function(k){return g.getComponentMethod("colorbar","draw")(k),S.previousPromises(k)},te.layoutReplot=function(k){var P=k.layout;return k.layout=void 0,g.call("_doPlot",k,"",P)},te.doLegend=function(k){return g.getComponentMethod("legend","draw")(k),S.previousPromises(k)},te.doTicksRelayout=function(k){return c.draw(k,"redraw"),k._fullLayout._hasOnlyLargeSploms&&(g.subplotsRegistry.splom.updateGrid(k),e(k),te.redrawReglTraces(k)),te.drawMainTitle(k),S.previousPromises(k)},te.doModeBar=function(k){var P=k._fullLayout;t.manage(k);for(var z=0;z<P._basePlotModules.length;z++){var I=P._basePlotModules[z].updateFx;I&&I(k)}return S.previousPromises(k)},te.doCamera=function(k){for(var P=k._fullLayout,z=P._subplots.gl3d,I=0;I<z.length;I++){var D=P[z[I]],R=D._scene;R.setViewport(D)}},te.drawData=function(k){var P=k._fullLayout;e(k);for(var z=P._basePlotModules,I=0;I<z.length;I++)z[I].plot(k);return te.redrawReglTraces(k),S.style(k),g.getComponentMethod("selections","draw")(k),g.getComponentMethod("shapes","draw")(k),g.getComponentMethod("annotations","draw")(k),g.getComponentMethod("images","draw")(k),P._replotting=!1,S.previousPromises(k)},te.redrawReglTraces=function(k){var P=k._fullLayout;if(P._has("regl")){var z=k._fullData,I=[],D=[],R,O;for(P._hasOnlyLargeSploms&&P._splomGrid.draw(),R=0;R<z.length;R++){var F=z[R];F.visible===!0&&F._length!==0&&(F.type==="splom"?P._splomScenes[F.uid].draw():F.type==="scattergl"?M.pushUnique(I,F.xaxis+F.yaxis):F.type==="scatterpolargl"&&M.pushUnique(D,F.subplot))}for(R=0;R<I.length;R++)O=P._plots[I[R]],O._scene&&O._scene.draw();for(R=0;R<D.length;R++)O=P[D[R]]._subplot,O._scene&&O._scene.draw()}},te.doAutoRangeAndConstraints=function(k){for(var P=c.list(k,"",!0),z,I={},D=0;D<P.length;D++)if(z=P[D],!I[z._id]){I[z._id]=1,p(k,z),v(k,z);var R=z._matchGroup;if(R)for(var O in R){var F=c.getFromId(k,O);v(k,F,z.range),I[O]=1}}x(k)},te.finalDraw=function(k){g.getComponentMethod("rangeslider","draw")(k),g.getComponentMethod("rangeselector","draw")(k)},te.drawMarginPushers=function(k){g.getComponentMethod("legend","draw")(k),g.getComponentMethod("rangeselector","draw")(k),g.getComponentMethod("sliders","draw")(k),g.getComponentMethod("updatemenus","draw")(k),g.getComponentMethod("colorbar","draw")(k)}},{"../components/color":367,"../components/drawing":389,"../components/modebar":430,"../components/titles":476,"../constants/alignment":483,"../lib":515,"../lib/clear_gl_canvases":499,"../plots/cartesian/autorange":565,"../plots/cartesian/axes":566,"../plots/cartesian/constraints":574,"../plots/plots":628,"../registry":647,"@plotly/d3":58}],557:[function(d,ee,te){var A=d("../lib"),g=A.isPlainObject,S=d("./plot_schema"),M=d("../plots/plots"),e=d("../plots/attributes"),a=d("./plot_template"),n=d("./plot_config").dfltConfig;te.makeTemplate=function(f){f=A.isPlainObject(f)?f:A.getGraphDiv(f),f=A.extendDeep({_context:n},{data:f.data,layout:f.layout}),M.supplyDefaults(f);var y=f.data||[],o=f.layout||{};o._basePlotModules=f._fullLayout._basePlotModules,o._modules=f._fullLayout._modules;var m={data:{},layout:{}};y.forEach(function(P){var z={};c(P,z,i.bind(null,P));var I=A.coerce(P,{},e,"type"),D=m.data[I];D||(D=m.data[I]=[]),D.push(z)}),c(o,m.layout,s.bind(null,o)),delete m.layout.template;var l=o.template;if(g(l)){var w=l.layout,_,h,b,u,L,T;g(w)&&r(w,m.layout);var k=l.data;if(g(k)){for(h in m.data)if(b=k[h],Array.isArray(b)){for(L=m.data[h],T=L.length,u=b.length,_=0;_<T;_++)r(b[_%u],L[_]);for(_=T;_<u;_++)L.push(A.extendDeep({},b[_]))}for(h in k)h in m.data||(m.data[h]=A.extendDeep([],k[h]))}}return m};function r(f,y){f=A.extendDeep({},f);var o=Object.keys(f).sort(),m,l;function w(L,T,k){if(g(T)&&g(L))r(L,T);else if(Array.isArray(T)&&Array.isArray(L)){var P=a.arrayTemplater({_template:f},k);for(l=0;l<T.length;l++){var z=T[l],I=P.newItem(z)._template;I&&r(I,z)}var D=P.defaultItems();for(l=0;l<D.length;l++)T.push(D[l]._template);for(l=0;l<T.length;l++)delete T[l].templateitemname}}for(m=0;m<o.length;m++){var _=o[m],h=f[_];if(_ in y?w(h,y[_],_):y[_]=h,t(_)===_)for(var b in y){var u=t(b);b!==u&&u===_&&!(b in f)&&w(h,y[b],_)}}}function t(f){return f.replace(/[0-9]+$/,"")}function c(f,y,o,m,l){var w=l&&o(l);for(var _ in f){var h=f[_],b=x(f,_,m),u=x(f,_,l),L=o(u);if(!L){var T=t(_);T!==_&&(u=x(f,T,l),L=o(u))}if(!(w&&w===L)&&!(!L||L._noTemplating||L.valType==="data_array"||L.arrayOk&&Array.isArray(h)))if(!L.valType&&g(h))c(h,y,o,b,u);else if(L._isLinkedToArray&&Array.isArray(h))for(var k=!1,P=0,z={},I=0;I<h.length;I++){var D=h[I];if(g(D)){var R=D.name;if(R)z[R]||(c(D,y,o,x(h,P,b),x(h,P,u)),P++,z[R]=1);else if(!k){var O=a.arrayDefaultKey(_),F=x(f,O,m),N=x(h,P,b);c(D,y,o,N,x(h,P,u));var G=A.nestedProperty(y,N),K=A.nestedProperty(y,F);K.set(G.get()),G.set(null),k=!0}}}else{var W=A.nestedProperty(y,b);W.set(h)}}}function s(f,y){return S.getLayoutValObject(f,A.nestedProperty({},y).parts)}function i(f,y){return S.getTraceValObject(f,A.nestedProperty({},y).parts)}function x(f,y,o){var m;return o?Array.isArray(f)?m=o+"["+y+"]":m=o+"."+y:m=y,m}te.validateTemplate=function(f,y){var o=A.extendDeep({},{_context:n,data:f.data,layout:f.layout}),m=o.layout||{};g(y)||(y=m.template||{});var l=y.layout,w=y.data,_=[];o.layout=m,o.layout.template=y,M.supplyDefaults(o);var h=o._fullLayout,b=o._fullData,u={};function L(F,N){for(var G in F)if(G.charAt(0)!=="_"&&g(F[G])){var K=t(G),W=[],Y;for(Y=0;Y<N.length;Y++)W.push(x(F,G,N[Y])),K!==G&&W.push(x(F,K,N[Y]));for(Y=0;Y<W.length;Y++)u[W[Y]]=1;L(F[G],W)}}function T(F,N){for(var G in F)if(G.indexOf("defaults")===-1&&g(F[G])){var K=x(F,G,N);u[K]?T(F[G],K):_.push({code:"unused",path:K})}}if(g(l)?(L(h,["layout"]),T(l,"layout")):_.push({code:"layout"}),!g(w))_.push({code:"data"});else{for(var k={},P,z=0;z<b.length;z++){var I=b[z];P=I.type,k[P]=(k[P]||0)+1,I._fullInput._template||_.push({code:"missing",index:I._fullInput.index,traceType:P})}for(P in w){var D=w[P].length,R=k[P]||0;D>R?_.push({code:"unused",traceType:P,templateCount:D,dataCount:R}):R>D&&_.push({code:"reused",traceType:P,templateCount:D,dataCount:R})}}function O(F,N){for(var G in F)if(G.charAt(0)!=="_"){var K=F[G],W=x(F,G,N);g(K)?(Array.isArray(F)&&K._template===!1&&K.templateitemname&&_.push({code:"missing",path:W,templateitemname:K.templateitemname}),O(K,W)):Array.isArray(K)&&p(K)&&O(K,W)}}if(O({data:b,layout:h},""),_.length)return _.map(v)};function p(f){for(var y=0;y<f.length;y++)if(g(f[y]))return!0}function v(f){var y;switch(f.code){case"data":y="The template has no key data.";break;case"layout":y="The template has no key layout.";break;case"missing":f.path?y="There are no templates for item "+f.path+" with name "+f.templateitemname:y="There are no templates for trace "+f.index+", of type "+f.traceType+".";break;case"unused":f.path?y="The template item at "+f.path+" was not used in constructing the plot.":f.dataCount?y="Some of the templates of type "+f.traceType+" were not used. The template has "+f.templateCount+" traces, the data only has "+f.dataCount+" of this type.":y="The template has "+f.templateCount+" traces of type "+f.traceType+" but there are none in the data.";break;case"reused":y="Some of the templates of type "+f.traceType+" were used more than once. The template has "+f.templateCount+" traces, the data has "+f.dataCount+" of this type.";break}return f.msg=y,f}},{"../lib":515,"../plots/attributes":562,"../plots/plots":628,"./plot_config":553,"./plot_schema":554,"./plot_template":555}],558:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("./plot_api"),S=d("../plots/plots"),M=d("../lib"),e=d("../snapshot/helpers"),a=d("../snapshot/tosvg"),n=d("../snapshot/svgtoimg"),r=d("../version").version,t={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};function c(s,i){i=i||{};var x,p,v,f;M.isPlainObject(s)?(x=s.data||[],p=s.layout||{},v=s.config||{},f={}):(s=M.getGraphDiv(s),x=M.extendDeep([],s.data),p=M.extendDeep({},s.layout),v=s._context,f=s._fullLayout||{});function y(R){return!(R in i)||M.validate(i[R],t[R])}if(!y("width")&&i.width!==null||!y("height")&&i.height!==null)throw new Error("Height and width should be pixel values.");if(!y("format"))throw new Error("Export format is not "+M.join2(t.format.values,", "," or ")+".");var o={};function m(R,O){return M.coerce(i,o,t,R,O)}var l=m("format"),w=m("width"),_=m("height"),h=m("scale"),b=m("setBackground"),u=m("imageDataOnly"),L=document.createElement("div");L.style.position="absolute",L.style.left="-5000px",document.body.appendChild(L);var T=M.extendFlat({},p);w?T.width=w:i.width===null&&A(f.width)&&(T.width=f.width),_?T.height=_:i.height===null&&A(f.height)&&(T.height=f.height);var k=M.extendFlat({},v,{_exportedPlot:!0,staticPlot:!0,setBackground:b}),P=e.getRedrawFunc(L);function z(){return new Promise(function(R){setTimeout(R,e.getDelay(L._fullLayout))})}function I(){return new Promise(function(R,O){var F=a(L,l,h),N=L._fullLayout.width,G=L._fullLayout.height;function K(){g.purge(L),document.body.removeChild(L)}if(l==="full-json"){var W=S.graphJson(L,!1,"keepdata","object",!0,!0);return W.version=r,W=JSON.stringify(W),K(),R(u?W:e.encodeJSON(W))}if(K(),l==="svg")return R(u?F:e.encodeSVG(F));var Y=document.createElement("canvas");Y.id=M.randstr(),n({format:l,width:N,height:G,scale:h,canvas:Y,svg:F,promise:!0}).then(R).catch(O)})}function D(R){return u?R.replace(e.IMAGE_URL_PREFIX,""):R}return new Promise(function(R,O){g.newPlot(L,x,T,k).then(P).then(z).then(I).then(function(F){R(D(F))}).catch(function(F){O(F)})})}ee.exports=c},{"../lib":515,"../plots/plots":628,"../snapshot/helpers":651,"../snapshot/svgtoimg":653,"../snapshot/tosvg":655,"../version":1132,"./plot_api":552,"fast-isnumeric":190}],559:[function(d,ee,te){var A=d("../lib"),g=d("../plots/plots"),S=d("./plot_schema"),M=d("./plot_config").dfltConfig,e=A.isPlainObject,a=Array.isArray,n=A.isArrayOrTypedArray;ee.exports=function(m,l){m===void 0&&(m=[]),l===void 0&&(l={});var w=S.get(),_=[],h={_context:A.extendFlat({},M)},b,u;a(m)?(h.data=A.extendDeep([],m),b=m):(h.data=[],b=[],_.push(i("array","data"))),e(l)?(h.layout=A.extendDeep({},l),u=l):(h.layout={},u={},arguments.length>1&&_.push(i("object","layout"))),g.supplyDefaults(h);for(var L=h._fullData,T=b.length,k=0;k<T;k++){var P=b[k],z=["data",k];if(!e(P)){_.push(i("object",z));continue}var I=L[k],D=I.type,R=w.traces[D].attributes;R.type={valType:"enumerated",values:[D]},I.visible===!1&&P.visible!==!1&&_.push(i("invisible",z)),r(P,I,R,_,z);var O=P.transforms,F=I.transforms;if(O){a(O)||_.push(i("array",z,["transforms"])),z.push("transforms");for(var N=0;N<O.length;N++){var G=["transforms",N],K=O[N].type;if(!e(O[N])){_.push(i("object",z,G));continue}var W=w.transforms[K]?w.transforms[K].attributes:{};W.type={valType:"enumerated",values:Object.keys(w.transforms)},r(O[N],F[N],W,_,z,G)}}}var Y=h._fullLayout,re=t(w,L);return r(u,Y,re,_,"layout"),_.length===0?void 0:_};function r(o,m,l,w,_,h){h=h||[];for(var b=Object.keys(o),u=0;u<b.length;u++){var L=b[u];if(L!=="transforms"){var T=h.slice();T.push(L);var k=o[L],P=m[L],z=p(l,L),I=(z||{}).valType,D=I==="info_array",R=I==="colorscale",O=(z||{}).items;if(!x(l,L))w.push(i("schema",_,T));else if(e(k)&&e(P)&&I!=="any")r(k,P,z,w,_,T);else if(D&&a(k)){k.length>P.length&&w.push(i("unused",_,T.concat(P.length)));var F=P.length,N=Array.isArray(O);N&&(F=Math.min(F,O.length));var G,K,W,Y,re;if(z.dimensions===2)for(K=0;K<F;K++)if(a(k[K])){k[K].length>P[K].length&&w.push(i("unused",_,T.concat(K,P[K].length)));var ue=P[K].length;for(G=0;G<(N?Math.min(ue,O[K].length):ue);G++)W=N?O[K][G]:O,Y=k[K][G],re=P[K][G],A.validate(Y,W)?re!==Y&&re!==+Y&&w.push(i("dynamic",_,T.concat(K,G),Y,re)):w.push(i("value",_,T.concat(K,G),Y))}else w.push(i("array",_,T.concat(K),k[K]));else for(K=0;K<F;K++)W=N?O[K]:O,Y=k[K],re=P[K],A.validate(Y,W)?re!==Y&&re!==+Y&&w.push(i("dynamic",_,T.concat(K),Y,re)):w.push(i("value",_,T.concat(K),Y))}else if(z.items&&!D&&a(k)){var j=O[Object.keys(O)[0]],q=[],V,U;for(V=0;V<P.length;V++){var $=P[V]._index||V;if(U=T.slice(),U.push($),e(k[$])&&e(P[V])){q.push($);var ne=k[$],X=P[V];e(ne)&&ne.visible!==!1&&X.visible===!1?w.push(i("invisible",_,U)):r(ne,X,j,w,_,U)}}for(V=0;V<k.length;V++)U=T.slice(),U.push(V),e(k[V])?q.indexOf(V)===-1&&w.push(i("unused",_,U)):w.push(i("object",_,U,k[V]))}else!e(k)&&e(P)?w.push(i("object",_,T,k)):!n(k)&&n(P)&&!D&&!R?w.push(i("array",_,T,k)):L in m?A.validate(k,z)?z.valType==="enumerated"&&(z.coerceNumber&&k!==+P||k!==P)&&w.push(i("dynamic",_,T,k,P)):w.push(i("value",_,T,k)):w.push(i("unused",_,T,k))}}return w}function t(o,m){for(var l=o.layout.layoutAttributes,w=0;w<m.length;w++){var _=m[w],h=o.traces[_.type],b=h.layoutAttributes;b&&(_.subplot?A.extendFlat(l[h.attributes.subplot.dflt],b):A.extendFlat(l,b))}return l}var c={object:function(o,m){var l;return o==="layout"&&m===""?l="The layout argument":o[0]==="data"&&m===""?l="Trace "+o[1]+" in the data argument":l=s(o)+"key "+m,l+" must be linked to an object container"},array:function(o,m){var l;return o==="data"?l="The data argument":l=s(o)+"key "+m,l+" must be linked to an array container"},schema:function(o,m){return s(o)+"key "+m+" is not part of the schema"},unused:function(o,m,l){var w=e(l)?"container":"key";return s(o)+w+" "+m+" did not get coerced"},dynamic:function(o,m,l,w){return[s(o)+"key",m,"(set to '"+l+"')","got reset to","'"+w+"'","during defaults."].join(" ")},invisible:function(o,m){return(m?s(o)+"item "+m:"Trace "+o[1])+" got defaulted to be not visible"},value:function(o,m,l){return[s(o)+"key "+m,"is set to an invalid value ("+l+")"].join(" ")}};function s(o){return a(o)?"In data trace "+o[1]+", ":"In "+o+", "}function i(o,m,l,w,_){l=l||"";var h,b;a(m)?(h=m[0],b=m[1]):(h=m,b=null);var u=y(l),L=c[o](m,u,w,_);return A.log(L),{code:o,container:h,trace:b,path:l,astr:u,msg:L}}function x(o,m){var l=f(m),w=l.keyMinusId,_=l.id;return w in o&&o[w]._isSubplotObj&&_?!0:m in o}function p(o,m){if(m in o)return o[m];var l=f(m);return o[l.keyMinusId]}var v=A.counterRegex("([a-z]+)");function f(o){var m=o.match(v);return{keyMinusId:m&&m[1],id:m&&m[2]}}function y(o){if(!a(o))return String(o);for(var m="",l=0;l<o.length;l++){var w=o[l];typeof w=="number"?m=m.substr(0,m.length-1)+"["+w+"]":m+=w,l<o.length-1&&(m+=".")}return m}},{"../lib":515,"../plots/plots":628,"./plot_config":553,"./plot_schema":554}],560:[function(d,ee,te){ee.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],561:[function(d,ee,te){var A=d("../lib"),g=d("../plot_api/plot_template");ee.exports=function(M,e,a){var n=a.name,r=a.inclusionAttr||"visible",t=e[n],c=A.isArrayOrTypedArray(M[n])?M[n]:[],s=e[n]=[],i=g.arrayTemplater(e,n,r),x,p;for(x=0;x<c.length;x++){var v=c[x];A.isPlainObject(v)?p=i.newItem(v):(p=i.newItem({}),p[r]=!1),p._index=x,p[r]!==!1&&a.handleItemDefaults(v,p,e,a),s.push(p)}var f=i.defaultItems();for(x=0;x<f.length;x++)p=f[x],p._index=s.length,a.handleItemDefaults({},p,e,a,{}),s.push(p);if(A.isArrayOrTypedArray(t)){var y=Math.min(t.length,s.length);for(x=0;x<y;x++)A.relinkPrivateKeys(s[x],t[x])}return s}},{"../lib":515,"../plot_api/plot_template":555}],562:[function(d,ee,te){var A=d("./font_attributes"),g=d("../components/fx/attributes");ee.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:A({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},legendwidth:{valType:"number",min:0,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:g.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":398,"./font_attributes":594}],563:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib"),S=g.dateTime2ms,M=g.incrementMonth,e=d("../../constants/numerical"),a=e.ONEAVGMONTH;ee.exports=function(r,t,c,s){if(t.type!=="date")return{vals:s};var i=r[c+"periodalignment"];if(!i)return{vals:s};var x=r[c+"period"],p;if(A(x)){if(x=+x,x<=0)return{vals:s}}else if(typeof x=="string"&&x.charAt(0)==="M"){var v=+x.substring(1);if(v>0&&Math.round(v)===v)p=v;else return{vals:s}}for(var f=t.calendar,y=i==="start",o=i==="end",m=r[c+"period0"],l=S(m,f)||0,w=[],_=[],h=[],b=s.length,u=0;u<b;u++){var L=s[u],T,k,P;if(p){for(T=Math.round((L-l)/(p*a)),P=M(l,p*T,f);P>L;)P=M(P,-p,f);for(;P<=L;)P=M(P,p,f);k=M(P,-p,f)}else{for(T=Math.round((L-l)/x),P=l+T*x;P>L;)P-=x;for(;P<=L;)P+=x;k=P-x}w[u]=y?k:o?P:(k+P)/2,_[u]=k,h[u]=P}return{vals:w,starts:_,ends:h}}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],564:[function(d,ee,te){ee.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],565:[function(d,ee,te){var A=d("@plotly/d3"),g=d("fast-isnumeric"),S=d("../../lib"),M=d("../../constants/numerical").FP_SAFE,e=d("../../registry"),a=d("../../components/drawing"),n=d("./axis_ids"),r=n.getFromId,t=n.isLinked;ee.exports={getAutoRange:c,makePadFn:i,doAutoRange:f,findExtremes:y,concatExtremes:v};function c(b,u){var L,T,k=[],P=b._fullLayout,z=i(P,u,0),I=i(P,u,1),D=v(b,u),R=D.min,O=D.max;if(R.length===0||O.length===0)return S.simpleMap(u.range,u.r2l);var F=R[0].val,N=O[0].val;for(L=1;L<R.length&&F===N;L++)F=Math.min(F,R[L].val);for(L=1;L<O.length&&F===N;L++)N=Math.max(N,O[L].val);var G=!1;if(u.range){var K=S.simpleMap(u.range,u.r2l);G=K[1]<K[0]}u.autorange==="reversed"&&(G=!0,u.autorange=!0);var W=u.rangemode,Y=W==="tozero",re=W==="nonnegative",ue=u._length,j=ue/10,q=0,V,U,$,ne,X,Q;for(L=0;L<R.length;L++)for(V=R[L],T=0;T<O.length;T++)U=O[T],Q=U.val-V.val-s(u,V.val,U.val),Q>0&&(X=ue-z(V)-I(U),X>j?Q/X>q&&($=V,ne=U,q=Q/X):Q/ue>q&&($={val:V.val,nopad:1},ne={val:U.val,nopad:1},q=Q/ue));function ie(ce,de){return Math.max(ce,I(de))}if(F===N){var se=F-1,ae=F+1;if(Y)if(F===0)k=[0,1];else{var oe=(F>0?O:R).reduce(ie,0),be=F/(1-Math.min(.5,oe/ue));k=F>0?[0,be]:[be,0]}else re?k=[Math.max(0,se),Math.max(1,ae)]:k=[se,ae]}else Y?($.val>=0&&($={val:0,nopad:1}),ne.val<=0&&(ne={val:0,nopad:1})):re&&($.val-q*z($)<0&&($={val:0,nopad:1}),ne.val<=0&&(ne={val:1,nopad:1})),q=(ne.val-$.val-s(u,V.val,U.val))/(ue-z($)-I(ne)),k=[$.val-q*z($),ne.val+q*I(ne)];return G&&k.reverse(),S.simpleMap(k,u.l2r||Number)}function s(b,u,L){var T=0;if(b.rangebreaks)for(var k=b.locateBreaks(u,L),P=0;P<k.length;P++){var z=k[P];T+=z.max-z.min}return T}function i(b,u,L){var T=.05*u._length,k=u._anchorAxis||{};if((u.ticklabelposition||"").indexOf("inside")!==-1||(k.ticklabelposition||"").indexOf("inside")!==-1){var P=u.autorange==="reversed";if(!P){var z=S.simpleMap(u.range,u.r2l);P=z[1]<z[0]}P&&(L=!L)}var I=0;return t(b,u._id)||(I=p(b,u,L)),T=Math.max(I,T),u.constrain==="domain"&&u._inputDomain&&(T*=(u._inputDomain[1]-u._inputDomain[0])/(u.domain[1]-u.domain[0])),function(R){return R.nopad?0:R.pad+(R.extrapad?T:I)}}var x=3;function p(b,u,L){var T=0,k=u._id.charAt(0)==="x";for(var P in b._plots){var z=b._plots[P];if(!(u._id!==z.xaxis._id&&u._id!==z.yaxis._id)){var I=(k?z.yaxis:z.xaxis)||{};if((I.ticklabelposition||"").indexOf("inside")!==-1&&(!L&&(I.side==="left"||I.side==="bottom")||L&&(I.side==="top"||I.side==="right"))){if(I._vals){var D=S.deg2rad(I._tickAngles[I._id+"tick"]||0),R=Math.abs(Math.cos(D)),O=Math.abs(Math.sin(D));if(!I._vals[0].bb){var F=I._id+"tick",N=I._selections[F];N.each(function(ue){var j=A.select(this),q=j.select(".text-math-group");q.empty()&&(ue.bb=a.bBox(j.node()))})}for(var G=0;G<I._vals.length;G++){var K=I._vals[G],W=K.bb;if(W){var Y=2*x+W.width,re=2*x+W.height;T=Math.max(T,k?Math.max(Y*R,re*O):Math.max(re*R,Y*O))}}}I.ticks==="inside"&&I.ticklabelposition==="inside"&&(T+=I.ticklen||0)}}}return T}function v(b,u,L){var T=u._id,k=b._fullData,P=b._fullLayout,z=[],I=[],D,R,O;function F(Y,re){for(D=0;D<re.length;D++){var ue=Y[re[D]],j=(ue._extremes||{})[T];if(ue.visible===!0&&j){for(R=0;R<j.min.length;R++)O=j.min[R],o(z,O.val,O.pad,{extrapad:O.extrapad});for(R=0;R<j.max.length;R++)O=j.max[R],m(I,O.val,O.pad,{extrapad:O.extrapad})}}}if(F(k,u._traceIndices),F(P.annotations||[],u._annIndices||[]),F(P.shapes||[],u._shapeIndices||[]),u._matchGroup&&!L){for(var N in u._matchGroup)if(N!==u._id){var G=r(b,N),K=v(b,G,!0),W=u._length/G._length;for(R=0;R<K.min.length;R++)O=K.min[R],o(z,O.val,O.pad*W,{extrapad:O.extrapad});for(R=0;R<K.max.length;R++)O=K.max[R],m(I,O.val,O.pad*W,{extrapad:O.extrapad})}}return{min:z,max:I}}function f(b,u,L){if(u.setScale(),u.autorange){u.range=L?L.slice():c(b,u),u._r=u.range.slice(),u._rl=S.simpleMap(u._r,u.r2l);var T=u._input,k={};k[u._attr+".range"]=u.range,k[u._attr+".autorange"]=u.autorange,e.call("_storeDirectGUIEdit",b.layout,b._fullLayout._preGUI,k),T.range=u.range.slice(),T.autorange=u.autorange}var P=u._anchorAxis;if(P&&P.rangeslider){var z=P.rangeslider[u._name];z&&z.rangemode==="auto"&&(z.range=c(b,u)),P._input.rangeslider[u._name]=S.extendFlat({},z)}}function y(b,u,L){L||(L={}),b._m||b.setScale();var T=[],k=[],P=u.length,z=L.padded||!1,I=L.tozero&&(b.type==="linear"||b.type==="-"),D=b.type==="log",R=!1,O=L.vpadLinearized||!1,F,N,G,K,W,Y,re,ue,j;function q(se){if(Array.isArray(se))return R=!0,function(oe){return Math.max(Number(se[oe]||0),0)};var ae=Math.max(Number(se||0),0);return function(){return ae}}var V=q((b._m>0?L.ppadplus:L.ppadminus)||L.ppad||0),U=q((b._m>0?L.ppadminus:L.ppadplus)||L.ppad||0),$=q(L.vpadplus||L.vpad),ne=q(L.vpadminus||L.vpad);if(!R){if(ue=1/0,j=-1/0,D)for(F=0;F<P;F++)N=u[F],N<ue&&N>0&&(ue=N),N>j&&N<M&&(j=N);else for(F=0;F<P;F++)N=u[F],N<ue&&N>-M&&(ue=N),N>j&&N<M&&(j=N);u=[ue,j],P=2}var X={tozero:I,extrapad:z};function Q(se){G=u[se],g(G)&&(Y=V(se),re=U(se),O?(K=b.c2l(G)-ne(se),W=b.c2l(G)+$(se)):(ue=G-ne(se),j=G+$(se),D&&ue<j/10&&(ue=j/10),K=b.c2l(ue),W=b.c2l(j)),I&&(K=Math.min(0,K),W=Math.max(0,W)),w(K)&&o(T,K,re,X),w(W)&&m(k,W,Y,X))}var ie=Math.min(6,P);for(F=0;F<ie;F++)Q(F);for(F=P-1;F>=ie;F--)Q(F);return{min:T,max:k,opts:L}}function o(b,u,L,T){l(b,u,L,T,_)}function m(b,u,L,T){l(b,u,L,T,h)}function l(b,u,L,T,k){for(var P=T.tozero,z=T.extrapad,I=!0,D=0;D<b.length&&I;D++){var R=b[D];if(k(R.val,u)&&R.pad>=L&&(R.extrapad||!z)){I=!1;break}else k(u,R.val)&&R.pad<=L&&(z||!R.extrapad)&&(b.splice(D,1),D--)}if(I){var O=P&&u===0;b.push({val:u,pad:O?0:L,extrapad:O?!1:z})}}function w(b){return g(b)&&Math.abs(b)<M}function _(b,u){return b<=u}function h(b,u){return b>=u}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../../registry":647,"./axis_ids":570,"@plotly/d3":58,"fast-isnumeric":190}],566:[function(d,ee,te){var A=d("@plotly/d3"),g=d("fast-isnumeric"),S=d("../../plots/plots"),M=d("../../registry"),e=d("../../lib"),a=e.strTranslate,n=d("../../lib/svg_text_utils"),r=d("../../components/titles"),t=d("../../components/color"),c=d("../../components/drawing"),s=d("./layout_attributes"),i=d("./clean_ticks"),x=d("../../constants/numerical"),p=x.ONEMAXYEAR,v=x.ONEAVGYEAR,f=x.ONEMINYEAR,y=x.ONEMAXQUARTER,o=x.ONEAVGQUARTER,m=x.ONEMINQUARTER,l=x.ONEMAXMONTH,w=x.ONEAVGMONTH,_=x.ONEMINMONTH,h=x.ONEWEEK,b=x.ONEDAY,u=b/2,L=x.ONEHOUR,T=x.ONEMIN,k=x.ONESEC,P=x.MINUS_SIGN,z=x.BADNUM,I={K:"zeroline"},D={K:"gridline",L:"path"},R={K:"minor-gridline",L:"path"},O={K:"tick",L:"path"},F={K:"tick",L:"text"},N={width:["x","r","l","xl","xr"],height:["y","t","b","yt","yb"],right:["r","xr"],left:["l","xl"],top:["t","yt"],bottom:["b","yb"]},G=d("../../constants/alignment"),K=G.MID_SHIFT,W=G.CAP_SHIFT,Y=G.LINE_SPACING,re=G.OPPOSITE_SIDE,ue=3,j=ee.exports={};j.setConvert=d("./set_convert");var q=d("./axis_autotype"),V=d("./axis_ids"),U=V.idSort,$=V.isLinked;j.id2name=V.id2name,j.name2id=V.name2id,j.cleanId=V.cleanId,j.list=V.list,j.listIds=V.listIds,j.getFromId=V.getFromId,j.getFromTrace=V.getFromTrace;var ne=d("./autorange");j.getAutoRange=ne.getAutoRange,j.findExtremes=ne.findExtremes;var X=1e-4;function Q(Ce){var Me=(Ce[1]-Ce[0])*X;return[Ce[0]-Me,Ce[1]+Me]}j.coerceRef=function(Ce,Me,nt,st,ct,At){var dt=st.charAt(st.length-1),Ct=nt._fullLayout._subplots[dt+"axis"],Gt=st+"ref",rr={};return ct||(ct=Ct[0]||(typeof At=="string"?At:At[0])),At||(At=ct),Ct=Ct.concat(Ct.map(function(kr){return kr+" domain"})),rr[Gt]={valType:"enumerated",values:Ct.concat(At?typeof At=="string"?[At]:At:[]),dflt:ct},e.coerce(Ce,Me,rr,Gt)},j.getRefType=function(Ce){return Ce===void 0?Ce:Ce==="paper"?"paper":Ce==="pixel"?"pixel":/( domain)$/.test(Ce)?"domain":"range"},j.coercePosition=function(Ce,Me,nt,st,ct,At){var dt,Ct,Gt=j.getRefType(st);if(Gt!=="range")dt=e.ensureNumber,Ct=nt(ct,At);else{var rr=j.getFromId(Me,st);At=rr.fraction2r(At),Ct=nt(ct,At),dt=rr.cleanPos}Ce[ct]=dt(Ct)},j.cleanPosition=function(Ce,Me,nt){var st=nt==="paper"||nt==="pixel"?e.ensureNumber:j.getFromId(Me,nt).cleanPos;return st(Ce)},j.redrawComponents=function(Ce,Me){Me=Me||j.listIds(Ce);var nt=Ce._fullLayout;function st(ct,At,dt,Ct){for(var Gt=M.getComponentMethod(ct,At),rr={},kr=0;kr<Me.length;kr++)for(var br=nt[j.id2name(Me[kr])],Ar=br[dt],Wr=0;Wr<Ar.length;Wr++){var nr=Ar[Wr];if(!rr[nr]&&(Gt(Ce,nr),rr[nr]=1,Ct))return}}st("annotations","drawOne","_annIndices"),st("shapes","drawOne","_shapeIndices"),st("images","draw","_imgIndices",!0),st("selections","drawOne","_selectionIndices")};var ie=j.getDataConversions=function(Ce,Me,nt,st){var ct,At=nt==="x"||nt==="y"||nt==="z"?nt:st;if(Array.isArray(At)){if(ct={type:q(st,void 0,{autotypenumbers:Ce._fullLayout.autotypenumbers}),_categories:[]},j.setConvert(ct),ct.type==="category")for(var dt=0;dt<st.length;dt++)ct.d2c(st[dt])}else ct=j.getFromTrace(Ce,Me,At);return ct?{d2c:ct.d2c,c2d:ct.c2d}:At==="ids"?{d2c:ae,c2d:ae}:{d2c:se,c2d:se}};function se(Ce){return+Ce}function ae(Ce){return String(Ce)}j.getDataToCoordFunc=function(Ce,Me,nt,st){return ie(Ce,Me,nt,st).d2c},j.counterLetter=function(Ce){var Me=Ce.charAt(0);if(Me==="x")return"y";if(Me==="y")return"x"},j.minDtick=function(Ce,Me,nt,st){["log","category","multicategory"].indexOf(Ce.type)!==-1||!st?Ce._minDtick=0:Ce._minDtick===void 0?(Ce._minDtick=Me,Ce._forceTick0=nt):Ce._minDtick&&((Ce._minDtick/Me+1e-6)%1<2e-6&&((nt-Ce._forceTick0)/Me%1+1.000001)%1<2e-6?(Ce._minDtick=Me,Ce._forceTick0=nt):((Me/Ce._minDtick+1e-6)%1>2e-6||((nt-Ce._forceTick0)/Ce._minDtick%1+1.000001)%1>2e-6)&&(Ce._minDtick=0))},j.saveRangeInitial=function(Ce,Me){for(var nt=j.list(Ce,"",!0),st=!1,ct=0;ct<nt.length;ct++){var At=nt[ct],dt=At._rangeInitial===void 0,Ct=dt||!(At.range[0]===At._rangeInitial[0]&&At.range[1]===At._rangeInitial[1]);(dt&&At.autorange===!1||Me&&Ct)&&(At._rangeInitial=At.range.slice(),st=!0)}return st},j.saveShowSpikeInitial=function(Ce,Me){for(var nt=j.list(Ce,"",!0),st=!1,ct="on",At=0;At<nt.length;At++){var dt=nt[At],Ct=dt._showSpikeInitial===void 0,Gt=Ct||dt.showspikes!==dt._showspikes;(Ct||Me&&Gt)&&(dt._showSpikeInitial=dt.showspikes,st=!0),ct==="on"&&!dt.showspikes&&(ct="off")}return Ce._fullLayout._cartesianSpikesEnabled=ct,st},j.autoBin=function(Ce,Me,nt,st,ct,At){var dt=e.aggNums(Math.min,null,Ce),Ct=e.aggNums(Math.max,null,Ce);if(Me.type==="category"||Me.type==="multicategory")return{start:dt-.5,end:Ct+.5,size:Math.max(1,Math.round(At)||1),_dataSpan:Ct-dt};ct||(ct=Me.calendar);var Gt;if(Me.type==="log"?Gt={type:"linear",range:[dt,Ct]}:Gt={type:Me.type,range:e.simpleMap([dt,Ct],Me.c2r,0,ct),calendar:ct},j.setConvert(Gt),At=At&&i.dtick(At,Gt.type),At)Gt.dtick=At,Gt.tick0=i.tick0(void 0,Gt.type,ct);else{var rr;if(nt)rr=(Ct-dt)/nt;else{var kr=e.distinctVals(Ce),br=Math.pow(10,Math.floor(Math.log(kr.minDiff)/Math.LN10)),Ar=br*e.roundUp(kr.minDiff/br,[.9,1.9,4.9,9.9],!0);rr=Math.max(Ar,2*e.stdev(Ce)/Math.pow(Ce.length,st?.25:.4)),g(rr)||(rr=1)}j.autoTicks(Gt,rr)}var Wr=Gt.dtick,nr=j.tickIncrement(j.tickFirst(Gt),Wr,"reverse",ct),yr,Pr;if(typeof Wr=="number")nr=oe(nr,Ce,Gt,dt,Ct),Pr=1+Math.floor((Ct-nr)/Wr),yr=nr+Pr*Wr;else for(Gt.dtick.charAt(0)==="M"&&(nr=be(nr,Ce,Wr,dt,ct)),yr=nr,Pr=0;yr<=Ct;)yr=j.tickIncrement(yr,Wr,!1,ct),Pr++;return{start:Me.c2r(nr,0,ct),end:Me.c2r(yr,0,ct),size:Wr,_dataSpan:Ct-dt}};function oe(Ce,Me,nt,st,ct){var At=0,dt=0,Ct=0,Gt=0;function rr(Wr){return(1+(Wr-Ce)*100/nt.dtick)%100<2}for(var kr=0;kr<Me.length;kr++)Me[kr]%1===0?Ct++:g(Me[kr])||Gt++,rr(Me[kr])&&At++,rr(Me[kr]+nt.dtick/2)&&dt++;var br=Me.length-Gt;if(Ct===br&&nt.type!=="date")nt.dtick<1?Ce=st-.5*nt.dtick:(Ce-=.5,Ce+nt.dtick<st&&(Ce+=nt.dtick));else if(dt<br*.1&&(At>br*.3||rr(st)||rr(ct))){var Ar=nt.dtick/2;Ce+=Ce+Ar<st?Ar:-Ar}return Ce}function be(Ce,Me,nt,st,ct){var At=e.findExactDates(Me,ct),dt=.8;if(At.exactDays>dt){var Ct=Number(nt.substr(1));At.exactYears>dt&&Ct%12===0?Ce=j.tickIncrement(Ce,"M6","reverse")+b*1.5:At.exactMonths>dt?Ce=j.tickIncrement(Ce,"M1","reverse")+b*15.5:Ce-=u;var Gt=j.tickIncrement(Ce,nt);if(Gt<=st)return Gt}return Ce}j.prepMinorTicks=function(Ce,Me,nt){if(!Me.minor.dtick){delete Ce.dtick;var st=Me.dtick&&g(Me._tmin),ct;if(st){var At=j.tickIncrement(Me._tmin,Me.dtick,!0);ct=[Me._tmin,At*.99+Me._tmin*.01]}else{var dt=e.simpleMap(Me.range,Me.r2l);ct=[dt[0],.8*dt[0]+.2*dt[1]]}if(Ce.range=e.simpleMap(ct,Me.l2r),Ce._isMinor=!0,j.prepTicks(Ce,nt),st){var Ct=g(Me.dtick),Gt=g(Ce.dtick),rr=Ct?Me.dtick:+Me.dtick.substring(1),kr=Gt?Ce.dtick:+Ce.dtick.substring(1);Ct&&Gt?ce(rr,kr)?rr===2*h&&kr===2*b&&(Ce.dtick=h):rr===2*h&&kr===3*b?Ce.dtick=h:rr===h&&!(Me._input.minor||{}).nticks?Ce.dtick=b:de(rr/kr,2.5)?Ce.dtick=rr/2:Ce.dtick=rr:String(Me.dtick).charAt(0)==="M"?Gt?Ce.dtick="M1":ce(rr,kr)?rr>=12&&kr===2&&(Ce.dtick="M3"):Ce.dtick=Me.dtick:String(Ce.dtick).charAt(0)==="L"?String(Me.dtick).charAt(0)==="L"?ce(rr,kr)||(Ce.dtick=de(rr/kr,2.5)?Me.dtick/2:Me.dtick):Ce.dtick="D1":Ce.dtick==="D2"&&+Me.dtick>1&&(Ce.dtick=1)}Ce.range=Me.range}Me.minor._tick0Init===void 0&&(Ce.tick0=Me.tick0)};function ce(Ce,Me){return Math.abs((Ce/Me+.5)%1-.5)<.001}function de(Ce,Me){return Math.abs(Ce/Me-1)<.001}j.prepTicks=function(Ce,Me){var nt=e.simpleMap(Ce.range,Ce.r2l,void 0,void 0,Me);if(Ce.tickmode==="auto"||!Ce.dtick){var st=Ce.nticks,ct;st||(Ce.type==="category"||Ce.type==="multicategory"?(ct=Ce.tickfont?e.bigFont(Ce.tickfont.size||12):15,st=Ce._length/ct):(ct=Ce._id.charAt(0)==="y"?40:80,st=e.constrain(Ce._length/ct,4,9)+1),Ce._name==="radialaxis"&&(st*=2)),Ce.minor&&Ce.minor.tickmode!=="array"||Ce.tickmode==="array"&&(st*=100),Ce._roughDTick=Math.abs(nt[1]-nt[0])/st,j.autoTicks(Ce,Ce._roughDTick),Ce._minDtick>0&&Ce.dtick<Ce._minDtick*2&&(Ce.dtick=Ce._minDtick,Ce.tick0=Ce.l2r(Ce._forceTick0))}Ce.ticklabelmode==="period"&&ge(Ce),Ce.tick0||(Ce.tick0=Ce.type==="date"?"2000-01-01":0),Ce.type==="date"&&Ce.dtick<.1&&(Ce.dtick=.1),Ge(Ce)};function ye(Ce){return+Ce.substring(1)}function ge(Ce){var Me;function nt(){return!(g(Ce.dtick)||Ce.dtick.charAt(0)!=="M")}var st=nt(),ct=j.getTickFormat(Ce);if(ct){var At=Ce._dtickInit!==Ce.dtick;/%[fLQsSMX]/.test(ct)||(/%[HI]/.test(ct)?(Me=L,At&&!st&&Ce.dtick<L&&(Ce.dtick=L)):/%p/.test(ct)?(Me=u,At&&!st&&Ce.dtick<u&&(Ce.dtick=u)):/%[Aadejuwx]/.test(ct)?(Me=b,At&&!st&&Ce.dtick<b&&(Ce.dtick=b)):/%[UVW]/.test(ct)?(Me=h,At&&!st&&Ce.dtick<h&&(Ce.dtick=h)):/%[Bbm]/.test(ct)?(Me=w,At&&(st?ye(Ce.dtick)<1:Ce.dtick<_)&&(Ce.dtick="M1")):/%[q]/.test(ct)?(Me=o,At&&(st?ye(Ce.dtick)<3:Ce.dtick<m)&&(Ce.dtick="M3")):/%[Yy]/.test(ct)&&(Me=v,At&&(st?ye(Ce.dtick)<12:Ce.dtick<f)&&(Ce.dtick="M12")))}st=nt(),st&&Ce.tick0===Ce._dowTick0&&(Ce.tick0=Ce._rawTick0),Ce._definedDelta=Me}function me(Ce,Me,nt){for(var st=0;st<Ce.length;st++){var ct=Ce[st].value,At=st,dt=st+1;st<Ce.length-1?(At=st,dt=st+1):st>0?(At=st-1,dt=st):(At=st,dt=st);var Ct=Ce[At].value,Gt=Ce[dt].value,rr=Math.abs(Gt-Ct),kr=nt||rr,br=0;kr>=f?rr>=f&&rr<=p?br=rr:br=v:nt===o&&kr>=m?rr>=m&&rr<=y?br=rr:br=o:kr>=_?rr>=_&&rr<=l?br=rr:br=w:nt===h&&kr>=h?br=h:kr>=b?br=b:nt===u&&kr>=u?br=u:nt===L&&kr>=L&&(br=L);var Ar;br>=rr&&(br=rr,Ar=!0);var Wr=ct+br;if(Me.rangebreaks&&br>0){for(var nr=84,yr=0,Pr=0;Pr<nr;Pr++){var Or=(Pr+.5)/nr;Me.maskBreaks(ct*(1-Or)+Or*Wr)!==z&&yr++}br*=yr/nr,br||(Ce[st].drop=!0),Ar&&rr>h&&(br=rr)}(br>0||st===0)&&(Ce[st].periodX=ct+br/2)}}j.calcTicks=function(Me,nt){for(var st=Me.type,ct=Me.calendar,At=Me.ticklabelstep,dt=Me.ticklabelmode==="period",Ct=e.simpleMap(Me.range,Me.r2l,void 0,void 0,nt),Gt=Ct[1]<Ct[0],rr=Math.min(Ct[0],Ct[1]),kr=Math.max(Ct[0],Ct[1]),br=Math.max(1e3,Me._length||0),Ar=[],Wr=[],nr=[],yr=[],Pr=Me.minor&&(Me.minor.ticks||Me.minor.showgrid),Or=1;Or>=(Pr?0:1);Or--){var Sr=!Or;Or?(Me._dtickInit=Me.dtick,Me._tick0Init=Me.tick0):(Me.minor._dtickInit=Me.minor.dtick,Me.minor._tick0Init=Me.minor.tick0);var tt=Or?Me:e.extendFlat({},Me,Me.minor);if(Sr?j.prepMinorTicks(tt,Me,nt):j.prepTicks(tt,nt),tt.tickmode==="array"){Or?(nr=[],Ar=Ee(Me)):(yr=[],Wr=Ee(Me));continue}var Lt=Q(Ct),Wt=Lt[0],ir=Lt[1],Ir=g(tt.dtick),Br=st==="log"&&!(Ir||tt.dtick.charAt(0)==="L"),Er=j.tickFirst(tt,nt);if(Or){if(Me._tmin=Er,Er<Wt!==Gt)break;(st==="category"||st==="multicategory")&&(ir=Gt?Math.max(-.5,ir):Math.min(Me._categories.length-.5,ir))}var _r=null,Gr=Er,wn;if(Or){var cn;Ir?cn=Me.dtick:st==="date"?typeof Me.dtick=="string"&&Me.dtick.charAt(0)==="M"&&(cn=w*Me.dtick.substring(1)):cn=Me._roughDTick,wn=Math.round((Me.r2l(Gr)-Me.r2l(Me.tick0))/cn)-1}var Bn=tt.dtick;for(tt.rangebreaks&&tt._tick0Init!==tt.tick0&&(Gr=lt(Gr,Me),Gt||(Gr=j.tickIncrement(Gr,Bn,!Gt,ct))),Or&&dt&&(Gr=j.tickIncrement(Gr,Bn,!Gt,ct),wn--);Gt?Gr>=ir:Gr<=ir;Gr=j.tickIncrement(Gr,Bn,Gt,ct)){if(Or&&wn++,tt.rangebreaks&&!Gt){if(Gr<Wt)continue;if(tt.maskBreaks(Gr)===z&&lt(Gr,tt)>=kr)break}if(nr.length>br||Gr===_r)break;_r=Gr;var En={value:Gr};Or?(Br&&Gr!==(Gr|0)&&(En.simpleLabel=!0),At>1&&wn%At&&(En.skipLabel=!0),nr.push(En)):(En.minor=!0,yr.push(En))}}if(Pr){var Yn=Me.minor.ticks==="inside"&&Me.ticks==="outside"||Me.minor.ticks==="outside"&&Me.ticks==="inside";if(!Yn){for(var Hn=nr.map(function(Vt){return Vt.value}),pa=[],Ma=0;Ma<yr.length;Ma++){var ci=yr[Ma],Ha=ci.value;if(Hn.indexOf(Ha)===-1){for(var ja=!1,Wa=0;!ja&&Wa<nr.length;Wa++)1e7+nr[Wa].value===1e7+Ha&&(ja=!0);ja||pa.push(ci)}}yr=pa}}dt&&me(nr,Me,Me._definedDelta);var Tr;if(Me.rangebreaks){var pn=Me._id.charAt(0)==="y",fn=1;Me.tickmode==="auto"&&(fn=Me.tickfont?Me.tickfont.size:12);var An=NaN;for(Tr=nr.length-1;Tr>-1;Tr--){if(nr[Tr].drop){nr.splice(Tr,1);continue}nr[Tr].value=lt(nr[Tr].value,Me);var Zn=Me.c2p(nr[Tr].value);(pn?An>Zn-fn:An<Zn+fn)?nr.splice(Gt?Tr+1:Tr,1):An=Zn}}it(Me)&&Math.abs(Ct[1]-Ct[0])===360&&nr.pop(),Me._tmax=(nr[nr.length-1]||{}).value,Me._prevDateHead="",Me._inCalcTicks=!0;var ua,ea=function(Vt){Vt.text="",Me._prevDateHead=ua};nr=nr.concat(yr);var Rn,Xn;for(Tr=0;Tr<nr.length;Tr++){var Ua=nr[Tr].minor,li=nr[Tr].value;Ua?Wr.push({x:li,minor:!0}):(ua=Me._prevDateHead,Rn=j.tickText(Me,li,!1,nr[Tr].simpleLabel),Xn=nr[Tr].periodX,Xn!==void 0&&(Rn.periodX=Xn,(Xn>kr||Xn<rr)&&(Xn>kr&&(Rn.periodX=kr),Xn<rr&&(Rn.periodX=rr),ea(Rn))),nr[Tr].skipLabel&&ea(Rn),Ar.push(Rn))}return Ar=Ar.concat(Wr),Me._inCalcTicks=!1,dt&&Ar.length&&(Ar[0].noTick=!0),Ar};function Ee(Ce){var Me=e.simpleMap(Ce.range,Ce.r2l),nt=Q(Me),st=Math.min(nt[0],nt[1]),ct=Math.max(nt[0],nt[1]),At=Ce.type==="category"?Ce.d2l_noadd:Ce.d2l;Ce.type==="log"&&String(Ce.dtick).charAt(0)!=="L"&&(Ce.dtick="L"+Math.pow(10,Math.floor(Math.min(Ce.range[0],Ce.range[1]))-1));for(var dt=[],Ct=0;Ct<=1;Ct++)if(!(Ct&&!Ce.minor)){var Gt=Ct?Ce.minor.tickvals:Ce.tickvals,rr=Ct?[]:Ce.ticktext;if(!!Gt){Array.isArray(rr)||(rr=[]);for(var kr=0;kr<Gt.length;kr++){var br=At(Gt[kr]);if(br>st&&br<ct){var Ar=rr[kr]===void 0?j.tickText(Ce,br):ht(Ce,br,String(rr[kr]));Ct&&(Ar.minor=!0,Ar.text=""),dt.push(Ar)}}}}return Ce.rangebreaks&&(dt=dt.filter(function(Wr){return Ce.maskBreaks(Wr.x)!==z})),dt}var Pe=[2,5,10],Ne=[1,2,3,6,12],we=[1,2,5,10,15,30],ke=[1,2,3,7,14],Xe=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],He=[-.301,0,.301,.699,1],Ie=[15,30,45,90,180];function De(Ce,Me,nt){return Me*e.roundUp(Ce/Me,nt)}j.autoTicks=function(Ce,Me,nt){var st;function ct(br){return Math.pow(br,Math.floor(Math.log(Me)/Math.LN10))}if(Ce.type==="date"){Ce.tick0=e.dateTick0(Ce.calendar,0);var At=2*Me;if(At>v)Me/=v,st=ct(10),Ce.dtick="M"+12*De(Me,st,Pe);else if(At>w)Me/=w,Ce.dtick="M"+De(Me,1,Ne);else if(At>b){if(Ce.dtick=De(Me,b,Ce._hasDayOfWeekBreaks?[1,2,7,14]:ke),!nt){var dt=j.getTickFormat(Ce),Ct=Ce.ticklabelmode==="period";Ct&&(Ce._rawTick0=Ce.tick0),/%[uVW]/.test(dt)?Ce.tick0=e.dateTick0(Ce.calendar,2):Ce.tick0=e.dateTick0(Ce.calendar,1),Ct&&(Ce._dowTick0=Ce.tick0)}}else At>L?Ce.dtick=De(Me,L,Ne):At>T?Ce.dtick=De(Me,T,we):At>k?Ce.dtick=De(Me,k,we):(st=ct(10),Ce.dtick=De(Me,st,Pe))}else if(Ce.type==="log"){Ce.tick0=0;var Gt=e.simpleMap(Ce.range,Ce.r2l);if(Ce._isMinor&&(Me*=1.5),Me>.7)Ce.dtick=Math.ceil(Me);else if(Math.abs(Gt[1]-Gt[0])<1){var rr=1.5*Math.abs((Gt[1]-Gt[0])/Me);Me=Math.abs(Math.pow(10,Gt[1])-Math.pow(10,Gt[0]))/rr,st=ct(10),Ce.dtick="L"+De(Me,st,Pe)}else Ce.dtick=Me>.3?"D2":"D1"}else Ce.type==="category"||Ce.type==="multicategory"?(Ce.tick0=0,Ce.dtick=Math.ceil(Math.max(Me,1))):it(Ce)?(Ce.tick0=0,st=1,Ce.dtick=De(Me,st,Ie)):(Ce.tick0=0,st=ct(10),Ce.dtick=De(Me,st,Pe));if(Ce.dtick===0&&(Ce.dtick=1),!g(Ce.dtick)&&typeof Ce.dtick!="string"){var kr=Ce.dtick;throw Ce.dtick=1,"ax.dtick error: "+String(kr)}};function Ge(Ce){var Me=Ce.dtick;if(Ce._tickexponent=0,!g(Me)&&typeof Me!="string"&&(Me=1),(Ce.type==="category"||Ce.type==="multicategory")&&(Ce._tickround=null),Ce.type==="date"){var nt=Ce.r2l(Ce.tick0),st=Ce.l2r(nt).replace(/(^-|i)/g,""),ct=st.length;if(String(Me).charAt(0)==="M")ct>10||st.substr(5)!=="01-01"?Ce._tickround="d":Ce._tickround=+Me.substr(1)%12===0?"y":"m";else if(Me>=b&&ct<=10||Me>=b*15)Ce._tickround="d";else if(Me>=T&&ct<=16||Me>=L)Ce._tickround="M";else if(Me>=k&&ct<=19||Me>=T)Ce._tickround="S";else{var At=Ce.l2r(nt+Me).replace(/^-/,"").length;Ce._tickround=Math.max(ct,At)-20,Ce._tickround<0&&(Ce._tickround=4)}}else if(g(Me)||Me.charAt(0)==="L"){var dt=Ce.range.map(Ce.r2d||Number);g(Me)||(Me=Number(Me.substr(1))),Ce._tickround=2-Math.floor(Math.log(Me)/Math.LN10+.01);var Ct=Math.max(Math.abs(dt[0]),Math.abs(dt[1])),Gt=Math.floor(Math.log(Ct)/Math.LN10+.01),rr=Ce.minexponent===void 0?3:Ce.minexponent;Math.abs(Gt)>rr&&(rt(Ce.exponentformat)&&!Ve(Gt)?Ce._tickexponent=3*Math.round((Gt-1)/3):Ce._tickexponent=Gt)}else Ce._tickround=null}j.tickIncrement=function(Ce,Me,nt,st){var ct=nt?-1:1;if(g(Me))return e.increment(Ce,ct*Me);var At=Me.charAt(0),dt=ct*Number(Me.substr(1));if(At==="M")return e.incrementMonth(Ce,dt,st);if(At==="L")return Math.log(Math.pow(10,Ce)+dt)/Math.LN10;if(At==="D"){var Ct=Me==="D2"?He:Xe,Gt=Ce+ct*.01,rr=e.roundUp(e.mod(Gt,1),Ct,nt);return Math.floor(Gt)+Math.log(A.round(Math.pow(10,rr),1))/Math.LN10}throw"unrecognized dtick "+String(Me)},j.tickFirst=function(Ce,Me){var nt=Ce.r2l||Number,st=e.simpleMap(Ce.range,nt,void 0,void 0,Me),ct=st[1]<st[0],At=ct?Math.floor:Math.ceil,dt=Q(st)[0],Ct=Ce.dtick,Gt=nt(Ce.tick0);if(g(Ct)){var rr=At((dt-Gt)/Ct)*Ct+Gt;return(Ce.type==="category"||Ce.type==="multicategory")&&(rr=e.constrain(rr,0,Ce._categories.length-1)),rr}var kr=Ct.charAt(0),br=Number(Ct.substr(1));if(kr==="M"){for(var Ar=0,Wr=Gt,nr,yr,Pr;Ar<10;){if(nr=j.tickIncrement(Wr,Ct,ct,Ce.calendar),(nr-dt)*(Wr-dt)<=0)return ct?Math.min(Wr,nr):Math.max(Wr,nr);yr=(dt-(Wr+nr)/2)/(nr-Wr),Pr=kr+(Math.abs(Math.round(yr))||1)*br,Wr=j.tickIncrement(Wr,Pr,yr<0?!ct:ct,Ce.calendar),Ar++}return e.error("tickFirst did not converge",Ce),Wr}else{if(kr==="L")return Math.log(At((Math.pow(10,dt)-Gt)/br)*br+Gt)/Math.LN10;if(kr==="D"){var Or=Ct==="D2"?He:Xe,Sr=e.roundUp(e.mod(dt,1),Or,ct);return Math.floor(dt)+Math.log(A.round(Math.pow(10,Sr),1))/Math.LN10}else throw"unrecognized dtick "+String(Ct)}},j.tickText=function(Ce,Me,nt,st){var ct=ht(Ce,Me),At=Ce.tickmode==="array",dt=nt||At,Ct=Ce.type,Gt=Ct==="category"?Ce.d2l_noadd:Ce.d2l,rr;if(At&&Array.isArray(Ce.ticktext)){var kr=e.simpleMap(Ce.range,Ce.r2l),br=(Math.abs(kr[1]-kr[0])-(Ce._lBreaks||0))/1e4;for(rr=0;rr<Ce.ticktext.length&&!(Math.abs(Me-Gt(Ce.tickvals[rr]))<br);rr++);if(rr<Ce.ticktext.length)return ct.text=String(Ce.ticktext[rr]),ct}function Ar(yr){if(yr===void 0)return!0;if(nt)return yr==="none";var Pr={first:Ce._tmin,last:Ce._tmax}[yr];return yr!=="all"&&Me!==Pr}var Wr=nt?"never":Ce.exponentformat!=="none"&&Ar(Ce.showexponent)?"hide":"";if(Ct==="date"?Rt(Ce,ct,nt,dt):Ct==="log"?Kt(Ce,ct,nt,dt,Wr):Ct==="category"?It(Ce,ct):Ct==="multicategory"?Mt(Ce,ct,nt):it(Ce)?zt(Ce,ct,nt,dt,Wr):Yt(Ce,ct,nt,dt,Wr),st||(Ce.tickprefix&&!Ar(Ce.showtickprefix)&&(ct.text=Ce.tickprefix+ct.text),Ce.ticksuffix&&!Ar(Ce.showticksuffix)&&(ct.text+=Ce.ticksuffix)),Ce.tickson==="boundaries"||Ce.showdividers){var nr=function(yr){var Pr=Ce.l2p(yr);return Pr>=0&&Pr<=Ce._length?yr:null};ct.xbnd=[nr(ct.x-.5),nr(ct.x+Ce.dtick-.5)]}return ct},j.hoverLabelText=function(Ce,Me,nt){nt&&(Ce=e.extendFlat({},Ce,{hoverformat:nt}));var st=Array.isArray(Me)?Me[0]:Me,ct=Array.isArray(Me)?Me[1]:void 0;if(ct!==void 0&&ct!==st)return j.hoverLabelText(Ce,st,nt)+" - "+j.hoverLabelText(Ce,ct,nt);var At=Ce.type==="log"&&st<=0,dt=j.tickText(Ce,Ce.c2l(At?-st:st),"hover").text;return At?st===0?"0":P+dt:dt};function ht(Ce,Me,nt){var st=Ce.tickfont||{};return{x:Me,dx:0,dy:0,text:nt||"",fontSize:st.size,font:st.family,fontColor:st.color}}function Rt(Ce,Me,nt,st){var ct=Ce._tickround,At=nt&&Ce.hoverformat||j.getTickFormat(Ce);st&&(g(ct)?ct=4:ct={y:"m",m:"d",d:"M",M:"S",S:4}[ct]);var dt=e.formatDate(Me.x,At,ct,Ce._dateFormat,Ce.calendar,Ce._extraFormat),Ct,Gt=dt.indexOf(`
`);if(Gt!==-1&&(Ct=dt.substr(Gt+1),dt=dt.substr(0,Gt)),st&&(dt==="00:00:00"||dt==="00:00"?(dt=Ct,Ct=""):dt.length===8&&(dt=dt.replace(/:00$/,""))),Ct)if(nt)ct==="d"?dt+=", "+Ct:dt=Ct+(dt?", "+dt:"");else if(!Ce._inCalcTicks||Ce._prevDateHead!==Ct)Ce._prevDateHead=Ct,dt+="<br>"+Ct;else{var rr=Tt(Ce),kr=Ce._trueSide||Ce.side;(!rr&&kr==="top"||rr&&kr==="bottom")&&(dt+="<br> ")}Me.text=dt}function Kt(Ce,Me,nt,st,ct){var At=Ce.dtick,dt=Me.x,Ct=Ce.tickformat,Gt=typeof At=="string"&&At.charAt(0);if(ct==="never"&&(ct=""),st&&Gt!=="L"&&(At="L3",Gt="L"),Ct||Gt==="L")Me.text=Ae(Math.pow(10,dt),Ce,ct,st);else if(g(At)||Gt==="D"&&e.mod(dt+.01,1)<.1){var rr=Math.round(dt),kr=Math.abs(rr),br=Ce.exponentformat;br==="power"||rt(br)&&Ve(rr)?(rr===0?Me.text=1:rr===1?Me.text="10":Me.text="10<sup>"+(rr>1?"":P)+kr+"</sup>",Me.fontSize*=1.25):(br==="e"||br==="E")&&kr>2?Me.text="1"+br+(rr>0?"+":P)+kr:(Me.text=Ae(Math.pow(10,dt),Ce,"","fakehover"),At==="D1"&&Ce._id.charAt(0)==="y"&&(Me.dy-=Me.fontSize/6))}else if(Gt==="D")Me.text=String(Math.round(Math.pow(10,e.mod(dt,1)))),Me.fontSize*=.75;else throw"unrecognized dtick "+String(At);if(Ce.dtick==="D1"){var Ar=String(Me.text).charAt(0);(Ar==="0"||Ar==="1")&&(Ce._id.charAt(0)==="y"?Me.dx-=Me.fontSize/4:(Me.dy+=Me.fontSize/2,Me.dx+=(Ce.range[1]>Ce.range[0]?1:-1)*Me.fontSize*(dt<0?.5:.25)))}}function It(Ce,Me){var nt=Ce._categories[Math.round(Me.x)];nt===void 0&&(nt=""),Me.text=String(nt)}function Mt(Ce,Me,nt){var st=Math.round(Me.x),ct=Ce._categories[st]||[],At=ct[1]===void 0?"":String(ct[1]),dt=ct[0]===void 0?"":String(ct[0]);nt?Me.text=dt+" - "+At:(Me.text=At,Me.text2=dt)}function Yt(Ce,Me,nt,st,ct){ct==="never"?ct="":Ce.showexponent==="all"&&Math.abs(Me.x/Ce.dtick)<1e-6&&(ct="hide"),Me.text=Ae(Me.x,Ce,ct,st)}function zt(Ce,Me,nt,st,ct){if(Ce.thetaunit==="radians"&&!nt){var At=Me.x/180;if(At===0)Me.text="0";else{var dt=St(At);if(dt[1]>=100)Me.text=Ae(e.deg2rad(Me.x),Ce,ct,st);else{var Ct=Me.x<0;dt[1]===1?dt[0]===1?Me.text="\u03C0":Me.text=dt[0]+"\u03C0":Me.text=["<sup>",dt[0],"</sup>","\u2044","<sub>",dt[1],"</sub>","\u03C0"].join(""),Ct&&(Me.text=P+Me.text)}}}else Me.text=Ae(Me.x,Ce,ct,st)}function St(Ce){function Me(Ct,Gt){return Math.abs(Ct-Gt)<=1e-6}function nt(Ct,Gt){return Me(Gt,0)?Ct:nt(Gt,Ct%Gt)}function st(Ct){for(var Gt=1;!Me(Math.round(Ct*Gt)/Gt,Ct);)Gt*=10;return Gt}var ct=st(Ce),At=Ce*ct,dt=Math.abs(nt(At,ct));return[Math.round(At/dt),Math.round(ct/dt)]}var Ye=["f","p","n","\u03BC","m","","k","M","G","T"];function rt(Ce){return Ce==="SI"||Ce==="B"}function Ve(Ce){return Ce>14||Ce<-15}function Ae(Ce,Me,nt,st){var ct=Ce<0,At=Me._tickround,dt=nt||Me.exponentformat||"B",Ct=Me._tickexponent,Gt=j.getTickFormat(Me),rr=Me.separatethousands;if(st){var kr={exponentformat:dt,minexponent:Me.minexponent,dtick:Me.showexponent==="none"?Me.dtick:g(Ce)&&Math.abs(Ce)||1,range:Me.showexponent==="none"?Me.range.map(Me.r2d):[0,Ce||1]};Ge(kr),At=(Number(kr._tickround)||0)+4,Ct=kr._tickexponent,Me.hoverformat&&(Gt=Me.hoverformat)}if(Gt)return Me._numFormat(Gt)(Ce).replace(/-/g,P);var br=Math.pow(10,-At)/2;if(dt==="none"&&(Ct=0),Ce=Math.abs(Ce),Ce<br)Ce="0",ct=!1;else{if(Ce+=br,Ct&&(Ce*=Math.pow(10,-Ct),At+=Ct),At===0)Ce=String(Math.floor(Ce));else if(At<0){Ce=String(Math.round(Ce)),Ce=Ce.substr(0,Ce.length+At);for(var Ar=At;Ar<0;Ar++)Ce+="0"}else{Ce=String(Ce);var Wr=Ce.indexOf(".")+1;Wr&&(Ce=Ce.substr(0,Wr+At).replace(/\.?0+$/,""))}Ce=e.numSeparate(Ce,Me._separators,rr)}if(Ct&&dt!=="hide"){rt(dt)&&Ve(Ct)&&(dt="power");var nr;Ct<0?nr=P+-Ct:dt!=="power"?nr="+"+Ct:nr=String(Ct),dt==="e"||dt==="E"?Ce+=dt+nr:dt==="power"?Ce+="\xD710<sup>"+nr+"</sup>":dt==="B"&&Ct===9?Ce+="B":rt(dt)&&(Ce+=Ye[Ct/3+5])}return ct?P+Ce:Ce}j.getTickFormat=function(Ce){var Me;function nt(Gt){return typeof Gt!="string"?Gt:Number(Gt.replace("M",""))*w}function st(Gt,rr){var kr=["L","D"];if(typeof Gt==typeof rr){if(typeof Gt=="number")return Gt-rr;var br=kr.indexOf(Gt.charAt(0)),Ar=kr.indexOf(rr.charAt(0));return br===Ar?Number(Gt.replace(/(L|D)/g,""))-Number(rr.replace(/(L|D)/g,"")):br-Ar}else return typeof Gt=="number"?1:-1}function ct(Gt,rr,kr){var br=kr||function(nr){return nr},Ar=rr[0],Wr=rr[1];return(!Ar&&typeof Ar!="number"||br(Ar)<=br(Gt))&&(!Wr&&typeof Wr!="number"||br(Wr)>=br(Gt))}function At(Gt,rr){var kr=rr[0]===null,br=rr[1]===null,Ar=st(Gt,rr[0])>=0,Wr=st(Gt,rr[1])<=0;return(kr||Ar)&&(br||Wr)}var dt,Ct;if(Ce.tickformatstops&&Ce.tickformatstops.length>0)switch(Ce.type){case"date":case"linear":{for(Me=0;Me<Ce.tickformatstops.length;Me++)if(Ct=Ce.tickformatstops[Me],Ct.enabled&&ct(Ce.dtick,Ct.dtickrange,nt)){dt=Ct;break}break}case"log":{for(Me=0;Me<Ce.tickformatstops.length;Me++)if(Ct=Ce.tickformatstops[Me],Ct.enabled&&At(Ce.dtick,Ct.dtickrange)){dt=Ct;break}break}}return dt?dt.value:Ce.tickformat},j.getSubplots=function(Ce,Me){var nt=Ce._fullLayout._subplots,st=nt.cartesian.concat(nt.gl2d||[]),ct=Me?j.findSubplotsWithAxis(st,Me):st;return ct.sort(function(At,dt){var Ct=At.substr(1).split("y"),Gt=dt.substr(1).split("y");return Ct[0]===Gt[0]?+Ct[1]-+Gt[1]:+Ct[0]-+Gt[0]}),ct},j.findSubplotsWithAxis=function(Ce,Me){for(var nt=new RegExp(Me._id.charAt(0)==="x"?"^"+Me._id+"y":Me._id+"$"),st=[],ct=0;ct<Ce.length;ct++){var At=Ce[ct];nt.test(At)&&st.push(At)}return st},j.makeClipPaths=function(Ce){var Me=Ce._fullLayout;if(!Me._hasOnlyLargeSploms){var nt={_offset:0,_length:Me.width,_id:""},st={_offset:0,_length:Me.height,_id:""},ct=j.list(Ce,"x",!0),At=j.list(Ce,"y",!0),dt=[],Ct,Gt;for(Ct=0;Ct<ct.length;Ct++)for(dt.push({x:ct[Ct],y:st}),Gt=0;Gt<At.length;Gt++)Ct===0&&dt.push({x:nt,y:At[Gt]}),dt.push({x:ct[Ct],y:At[Gt]});var rr=Me._clips.selectAll(".axesclip").data(dt,function(kr){return kr.x._id+kr.y._id});rr.enter().append("clipPath").classed("axesclip",!0).attr("id",function(kr){return"clip"+Me._uid+kr.x._id+kr.y._id}).append("rect"),rr.exit().remove(),rr.each(function(kr){A.select(this).select("rect").attr({x:kr.x._offset||0,y:kr.y._offset||0,width:kr.x._length||1,height:kr.y._length||1})})}},j.draw=function(Ce,Me,nt){var st=Ce._fullLayout;Me==="redraw"&&st._paper.selectAll("g.subplot").each(function(At){var dt=At[0],Ct=st._plots[dt];if(Ct){var Gt=Ct.xaxis,rr=Ct.yaxis;Ct.xaxislayer.selectAll("."+Gt._id+"tick").remove(),Ct.yaxislayer.selectAll("."+rr._id+"tick").remove(),Ct.xaxislayer.selectAll("."+Gt._id+"tick2").remove(),Ct.yaxislayer.selectAll("."+rr._id+"tick2").remove(),Ct.xaxislayer.selectAll("."+Gt._id+"divider").remove(),Ct.yaxislayer.selectAll("."+rr._id+"divider").remove(),Ct.minorGridlayer&&Ct.minorGridlayer.selectAll("path").remove(),Ct.gridlayer&&Ct.gridlayer.selectAll("path").remove(),Ct.zerolinelayer&&Ct.zerolinelayer.selectAll("path").remove(),st._infolayer.select(".g-"+Gt._id+"title").remove(),st._infolayer.select(".g-"+rr._id+"title").remove()}});var ct=!Me||Me==="redraw"?j.listIds(Ce):Me;return e.syncOrAsync(ct.map(function(At){return function(){if(!!At){var dt=j.getFromId(Ce,At),Ct=j.drawOne(Ce,dt,nt);return dt._r=dt.range.slice(),dt._rl=e.simpleMap(dt._r,dt.r2l),Ct}}}))},j.drawOne=function(Ce,Me,nt){nt=nt||{};var st,ct,At;Me.setScale();var dt=Ce._fullLayout,Ct=Me._id,Gt=Ct.charAt(0),rr=j.counterLetter(Ct),kr=dt._plots[Me._mainSubplot];if(!kr)return;var br=kr[Gt+"axislayer"],Ar=Me._mainLinePosition,Wr=Me._mainMirrorPosition,nr=Me._vals=j.calcTicks(Me),yr=[Me.mirror,Ar,Wr].join("_");for(st=0;st<nr.length;st++)nr[st].axInfo=yr;Me._selections={},Me._tickAngles&&(Me._prevTickAngles=Me._tickAngles),Me._tickAngles={},Me._depth=null;var Pr={};function Or(Vt){var hr=Ct+(Vt||"tick");return Pr[hr]||(Pr[hr]=gt(Me,hr)),Pr[hr]}if(!!Me.visible){var Sr=j.makeTransTickFn(Me),tt=j.makeTransTickLabelFn(Me),Lt,Wt,ir=Me.ticks==="inside",Ir=Me.ticks==="outside";if(Me.tickson==="boundaries"){var Br=Ze(Me,nr);Wt=j.clipEnds(Me,Br),Lt=ir?Wt:Br}else Wt=j.clipEnds(Me,nr),Lt=ir&&Me.ticklabelmode!=="period"?Wt:nr;var Er=Me._gridVals=Wt,_r=_t(Me,nr);if(!dt._hasOnlyLargeSploms){var Gr=Me._subplotsWith,wn={};for(st=0;st<Gr.length;st++){ct=Gr[st],At=dt._plots[ct];var cn=At[rr+"axis"],Bn=cn._mainAxis._id;if(!wn[Bn]){wn[Bn]=1;var En=Gt==="x"?"M0,"+cn._offset+"v"+cn._length:"M"+cn._offset+",0h"+cn._length;j.drawGrid(Ce,Me,{vals:Er,counterAxis:cn,layer:At.gridlayer.select("."+Ct),minorLayer:At.minorGridlayer.select("."+Ct),path:En,transFn:Sr}),j.drawZeroLine(Ce,Me,{counterAxis:cn,layer:At.zerolinelayer,path:En,transFn:Sr})}}}var Yn,Hn=j.getTickSigns(Me),pa=j.getTickSigns(Me,"minor");if(Me.ticks||Me.minor&&Me.minor.ticks){var Ma=j.makeTickPath(Me,Ar,Hn[2]),ci=j.makeTickPath(Me,Ar,pa[2],{minor:!0}),Ha,ja,Wa,Tr;if(Me._anchorAxis&&Me.mirror&&Me.mirror!==!0?(Ha=j.makeTickPath(Me,Wr,Hn[3]),ja=j.makeTickPath(Me,Wr,pa[3],{minor:!0}),Wa=Ma+Ha,Tr=ci+ja):(Ha="",ja="",Wa=Ma,Tr=ci),Me.showdividers&&Ir&&Me.tickson==="boundaries"){var pn={};for(st=0;st<_r.length;st++)pn[_r[st].x]=1;Yn=function(Vt){return pn[Vt.x]?Ha:Wa}}else Yn=function(Vt){return Vt.minor?Tr:Wa}}if(j.drawTicks(Ce,Me,{vals:Lt,layer:br,path:Yn,transFn:Sr}),Me.mirror==="allticks"){var fn=Object.keys(Me._linepositions||{});for(st=0;st<fn.length;st++){ct=fn[st],At=dt._plots[ct];var An=Me._linepositions[ct]||[],Zn=An[0],ua=An[1],ea=An[2],Rn=j.makeTickPath(Me,Zn,ea?Hn[0]:pa[0],{minor:ea})+j.makeTickPath(Me,ua,ea?Hn[1]:pa[1],{minor:ea});j.drawTicks(Ce,Me,{vals:Lt,layer:At[Gt+"axislayer"],path:Rn,transFn:Sr})}}var Xn=[];if(Xn.push(function(){return j.drawLabels(Ce,Me,{vals:nr,layer:br,plotinfo:At,transFn:tt,labelFns:j.makeLabelFns(Me,Ar)})}),Me.type==="multicategory"){var Ua={x:2,y:10}[Gt];Xn.push(function(){var Vt={x:"height",y:"width"}[Gt],hr=Or()[Vt]+Ua+(Me._tickAngles[Ct+"tick"]?Me.tickfont.size*Y:0);return j.drawLabels(Ce,Me,{vals:Qe(Me,nr),layer:br,cls:Ct+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:Sr,labelFns:j.makeLabelFns(Me,Ar+hr*Hn[4])})}),Xn.push(function(){return Me._depth=Hn[4]*(Or("tick2")[Me.side]-Ar),Nt(Ce,Me,{vals:_r,layer:br,path:j.makeTickPath(Me,Ar,Hn[4],{len:Me._depth}),transFn:Sr})})}else Me.title.hasOwnProperty("standoff")&&Xn.push(function(){Me._depth=Hn[4]*(Or()[Me.side]-Ar)});var li=M.getComponentMethod("rangeslider","isVisible")(Me);return Xn.push(function(){var Vt=Me.side.charAt(0),hr=re[Me.side].charAt(0),rn=j.getPxPosition(Ce,Me),vn=Ir?Me.ticklen:0,en,Tn,xn,un;if((Me.automargin||li)&&(Me.type==="multicategory"?en=Or("tick2"):(en=Or(),Gt==="x"&&Vt==="b"&&(Me._depth=Math.max(en.width>0?en.bottom-rn:0,vn)))),Me.automargin){Tn={x:0,y:0,r:0,l:0,t:0,b:0};var gr=[0,1];if(Gt==="x"){if(Vt==="b"?Tn[Vt]=Me._depth:(Tn[Vt]=Me._depth=Math.max(en.width>0?rn-en.top:0,vn),gr.reverse()),en.width>0){var mr=en.right-(Me._offset+Me._length);mr>0&&(Tn.xr=1,Tn.r=mr);var zr=Me._offset-en.left;zr>0&&(Tn.xl=0,Tn.l=zr)}}else if(Vt==="l"?Tn[Vt]=Me._depth=Math.max(en.height>0?rn-en.left:0,vn):(Tn[Vt]=Me._depth=Math.max(en.height>0?en.right-rn:0,vn),gr.reverse()),en.height>0){var gn=en.bottom-(Me._offset+Me._length);gn>0&&(Tn.yb=0,Tn.b=gn);var On=Me._offset-en.top;On>0&&(Tn.yt=1,Tn.t=On)}Tn[rr]=Me.anchor==="free"?Me.position:Me._anchorAxis.domain[gr[0]],Me.title.text!==dt._dfltTitle[Gt]&&(Tn[Vt]+=Xt(Me)+(Me.title.standoff||0)),Me.mirror&&Me.anchor!=="free"&&(xn={x:0,y:0,r:0,l:0,t:0,b:0},xn[hr]=Me.linewidth,Me.mirror&&Me.mirror!==!0&&(xn[hr]+=vn),Me.mirror===!0||Me.mirror==="ticks"?xn[rr]=Me._anchorAxis.domain[gr[1]]:(Me.mirror==="all"||Me.mirror==="allticks")&&(xn[rr]=[Me._counterDomainMin,Me._counterDomainMax][gr[1]]))}li&&(un=M.getComponentMethod("rangeslider","autoMarginOpts")(Ce,Me)),typeof Me.automargin=="string"&&(Ue(Tn,Me.automargin),Ue(xn,Me.automargin)),S.autoMargin(Ce,at(Me),Tn),S.autoMargin(Ce,$t(Me),xn),S.autoMargin(Ce,Zt(Me),un)}),!nt.skipTitle&&!(li&&Me.side==="bottom")&&Xn.push(function(){return Ht(Ce,Me)}),e.syncOrAsync(Xn)}};function Ue(Ce,Me){if(!!Ce){var nt=Object.keys(N).reduce(function(st,ct){return Me.indexOf(ct)!==-1&&N[ct].forEach(function(At){st[At]=1}),st},{});Object.keys(Ce).forEach(function(st){nt[st]||(st.length===1?Ce[st]=0:delete Ce[st])})}}function Ze(Ce,Me){var nt=[],st,ct=function(At,dt){var Ct=At.xbnd[dt];Ct!==null&&nt.push(e.extendFlat({},At,{x:Ct}))};if(Me.length){for(st=0;st<Me.length;st++)ct(Me[st],0);ct(Me[st-1],1)}return nt}function Qe(Ce,Me){for(var nt=[],st={},ct=0;ct<Me.length;ct++){var At=Me[ct];st[At.text2]?st[At.text2].push(At.x):st[At.text2]=[At.x]}for(var dt in st)nt.push(ht(Ce,e.interp(st[dt],.5),dt));return nt}function _t(Ce,Me){var nt=[],st,ct,At=Me.length&&Me[Me.length-1].x<Me[0].x,dt=function(Gt,rr){var kr=Gt.xbnd[rr];kr!==null&&nt.push(e.extendFlat({},Gt,{x:kr}))};if(Ce.showdividers&&Me.length){for(st=0;st<Me.length;st++){var Ct=Me[st];Ct.text2!==ct&&dt(Ct,At?1:0),ct=Ct.text2}dt(Me[st-1],At?0:1)}return nt}function gt(Ce,Me){var nt,st,ct,At;return Ce._selections[Me].size()?(nt=1/0,st=-1/0,ct=1/0,At=-1/0,Ce._selections[Me].each(function(){var dt=jr(this),Ct=c.bBox(dt.node().parentNode);nt=Math.min(nt,Ct.top),st=Math.max(st,Ct.bottom),ct=Math.min(ct,Ct.left),At=Math.max(At,Ct.right)})):(nt=0,st=0,ct=0,At=0),{top:nt,bottom:st,left:ct,right:At,height:st-nt,width:At-ct}}j.getTickSigns=function(Ce,Me){var nt=Ce._id.charAt(0),st={x:"top",y:"right"}[nt],ct=Ce.side===st?1:-1,At=[-1,1,ct,-ct],dt=Me?(Ce.minor||{}).ticks:Ce.ticks;return dt!=="inside"==(nt==="x")&&(At=At.map(function(Ct){return-Ct})),Ce.side&&At.push({l:-1,t:-1,r:1,b:1}[Ce.side.charAt(0)]),At},j.makeTransTickFn=function(Ce){return Ce._id.charAt(0)==="x"?function(Me){return a(Ce._offset+Ce.l2p(Me.x),0)}:function(Me){return a(0,Ce._offset+Ce.l2p(Me.x))}},j.makeTransTickLabelFn=function(Ce){var Me=Ut(Ce),nt=Me[0],st=Me[1];return Ce._id.charAt(0)==="x"?function(ct){return a(nt+Ce._offset+Ce.l2p(wt(ct)),st)}:function(ct){return a(st,nt+Ce._offset+Ce.l2p(wt(ct)))}};function wt(Ce){return Ce.periodX!==void 0?Ce.periodX:Ce.x}function Ut(Ce){var Me=Ce.ticklabelposition||"",nt=function(Wr){return Me.indexOf(Wr)!==-1},st=nt("top"),ct=nt("left"),At=nt("right"),dt=nt("bottom"),Ct=nt("inside"),Gt=dt||ct||st||At;if(!Gt&&!Ct)return[0,0];var rr=Ce.side,kr=Gt?(Ce.tickwidth||0)/2:0,br=ue,Ar=Ce.tickfont?Ce.tickfont.size:12;return(dt||st)&&(kr+=Ar*W,br+=(Ce.linewidth||0)/2),(ct||At)&&(kr+=(Ce.linewidth||0)/2,br+=ue),Ct&&rr==="top"&&(br-=Ar*(1-W)),(ct||st)&&(kr=-kr),(rr==="bottom"||rr==="right")&&(br=-br),[Gt?kr:0,Ct?br:0]}j.makeTickPath=function(Ce,Me,nt,st){st||(st={});var ct=st.minor;if(ct&&!Ce.minor)return"";var At=st.len!==void 0?st.len:ct?Ce.minor.ticklen:Ce.ticklen,dt=Ce._id.charAt(0),Ct=(Ce.linewidth||1)/2;return dt==="x"?"M0,"+(Me+Ct*nt)+"v"+At*nt:"M"+(Me+Ct*nt)+",0h"+At*nt},j.makeLabelFns=function(Ce,Me,nt){var st=Ce.ticklabelposition||"",ct=function(wn){return st.indexOf(wn)!==-1},At=ct("top"),dt=ct("left"),Ct=ct("right"),Gt=ct("bottom"),rr=Gt||dt||At||Ct,kr=ct("inside"),br=st==="inside"&&Ce.ticks==="inside"||!kr&&Ce.ticks==="outside"&&Ce.tickson!=="boundaries",Ar=0,Wr=0,nr=br?Ce.ticklen:0;if(kr?nr*=-1:rr&&(nr=0),br&&(Ar+=nr,nt)){var yr=e.deg2rad(nt);Ar=nr*Math.cos(yr)+1,Wr=nr*Math.sin(yr)}Ce.showticklabels&&(br||Ce.showline)&&(Ar+=.2*Ce.tickfont.size),Ar+=(Ce.linewidth||1)/2*(kr?-1:1);var Pr={labelStandoff:Ar,labelShift:Wr},Or,Sr,tt,Lt,Wt=0,ir=Ce.side,Ir=Ce._id.charAt(0),Br=Ce.tickangle,Er;if(Ir==="x")Er=!kr&&ir==="bottom"||kr&&ir==="top",Lt=Er?1:-1,kr&&(Lt*=-1),Or=Wr*Lt,Sr=Me+Ar*Lt,tt=Er?1:-.2,Math.abs(Br)===90&&(kr?tt+=K:Br===-90&&ir==="bottom"?tt=W:Br===90&&ir==="top"?tt=K:tt=.5,Wt=K/2*(Br/90)),Pr.xFn=function(wn){return wn.dx+Or+Wt*wn.fontSize},Pr.yFn=function(wn){return wn.dy+Sr+wn.fontSize*tt},Pr.anchorFn=function(wn,cn){if(rr){if(dt)return"end";if(Ct)return"start"}return!g(cn)||cn===0||cn===180?"middle":cn*Lt<0!==kr?"end":"start"},Pr.heightFn=function(wn,cn,Bn){return cn<-60||cn>60?-.5*Bn:Ce.side==="top"!==kr?-Bn:0};else if(Ir==="y"){if(Er=!kr&&ir==="left"||kr&&ir==="right",Lt=Er?1:-1,kr&&(Lt*=-1),Or=Ar,Sr=Wr*Lt,tt=0,!kr&&Math.abs(Br)===90&&(Br===-90&&ir==="left"||Br===90&&ir==="right"?tt=W:tt=.5),kr){var _r=g(Br)?+Br:0;if(_r!==0){var Gr=e.deg2rad(_r);Wt=Math.abs(Math.sin(Gr))*W*Lt,tt=0}}Pr.xFn=function(wn){return wn.dx+Me-(Or+wn.fontSize*tt)*Lt+Wt*wn.fontSize},Pr.yFn=function(wn){return wn.dy+Sr+wn.fontSize*K},Pr.anchorFn=function(wn,cn){return g(cn)&&Math.abs(cn)===90?"middle":Er?"end":"start"},Pr.heightFn=function(wn,cn,Bn){return Ce.side==="right"&&(cn*=-1),cn<-30?-Bn:cn<30?-.5*Bn:0}}return Pr};function Dt(Ce){return[Ce.text,Ce.x,Ce.axInfo,Ce.font,Ce.fontSize,Ce.fontColor].join("_")}j.drawTicks=function(Ce,Me,nt){nt=nt||{};var st=Me._id+"tick",ct=[].concat(Me.minor&&Me.minor.ticks?nt.vals.filter(function(dt){return dt.minor&&!dt.noTick}):[]).concat(Me.ticks?nt.vals.filter(function(dt){return!dt.minor&&!dt.noTick}):[]),At=nt.layer.selectAll("path."+st).data(ct,Dt);At.exit().remove(),At.enter().append("path").classed(st,1).classed("ticks",1).classed("crisp",nt.crisp!==!1).each(function(dt){return t.stroke(A.select(this),dt.minor?Me.minor.tickcolor:Me.tickcolor)}).style("stroke-width",function(dt){return c.crispRound(Ce,dt.minor?Me.minor.tickwidth:Me.tickwidth,1)+"px"}).attr("d",nt.path).style("display",null),Bt(Me,[O]),At.attr("transform",nt.transFn)},j.drawGrid=function(Ce,Me,nt){nt=nt||{};var st=Me._id+"grid",ct=Me.minor&&Me.minor.showgrid,At=ct?nt.vals.filter(function(Or){return Or.minor}):[],dt=Me.showgrid?nt.vals.filter(function(Or){return!Or.minor}):[],Ct=nt.counterAxis;if(Ct&&j.shouldShowZeroLine(Ce,Me,Ct))for(var Gt=Me.tickmode==="array",rr=0;rr<dt.length;rr++){var kr=dt[rr].x;if(Gt?!kr:Math.abs(kr)<Me.dtick/100)if(dt=dt.slice(0,rr).concat(dt.slice(rr+1)),Gt)rr--;else break}Me._gw=c.crispRound(Ce,Me.gridwidth,1);for(var br=ct?c.crispRound(Ce,Me.minor.gridwidth,1):0,Ar=nt.layer,Wr=nt.minorLayer,nr=1;nr>=0;nr--){var yr=nr?Ar:Wr;if(!!yr){var Pr=yr.selectAll("path."+st).data(nr?dt:At,Dt);Pr.exit().remove(),Pr.enter().append("path").classed(st,1).classed("crisp",nt.crisp!==!1),Pr.attr("transform",nt.transFn).attr("d",nt.path).each(function(Or){return t.stroke(A.select(this),Or.minor?Me.minor.gridcolor:Me.gridcolor||"#ddd")}).style("stroke-dasharray",function(Or){return c.dashStyle(Or.minor?Me.minor.griddash:Me.griddash,Or.minor?Me.minor.gridwidth:Me.gridwidth)}).style("stroke-width",function(Or){return(Or.minor?br:Me._gw)+"px"}).style("display",null),typeof nt.path=="function"&&Pr.attr("d",nt.path)}}Bt(Me,[D,R])},j.drawZeroLine=function(Ce,Me,nt){nt=nt||nt;var st=Me._id+"zl",ct=j.shouldShowZeroLine(Ce,Me,nt.counterAxis),At=nt.layer.selectAll("path."+st).data(ct?[{x:0,id:Me._id}]:[]);At.exit().remove(),At.enter().append("path").classed(st,1).classed("zl",1).classed("crisp",nt.crisp!==!1).each(function(){nt.layer.selectAll("path").sort(function(dt,Ct){return U(dt.id,Ct.id)})}),At.attr("transform",nt.transFn).attr("d",nt.path).call(t.stroke,Me.zerolinecolor||t.defaultLine).style("stroke-width",c.crispRound(Ce,Me.zerolinewidth,Me._gw||1)+"px").style("display",null),Bt(Me,[I])},j.drawLabels=function(Ce,Me,nt){nt=nt||{};var st=Ce._fullLayout,ct=Me._id,At=ct.charAt(0),dt=nt.cls||ct+"tick",Ct=nt.vals.filter(function(Lt){return Lt.text}),Gt=nt.labelFns,rr=nt.secondary?0:Me.tickangle,kr=(Me._prevTickAngles||{})[dt],br=nt.layer.selectAll("g."+dt).data(Me.showticklabels?Ct:[],Dt),Ar=[];br.enter().append("g").classed(dt,1).append("text").attr("text-anchor","middle").each(function(Lt){var Wt=A.select(this),ir=Ce._promises.length;Wt.call(n.positionText,Gt.xFn(Lt),Gt.yFn(Lt)).call(c.font,Lt.font,Lt.fontSize,Lt.fontColor).text(Lt.text).call(n.convertToTspans,Ce),Ce._promises[ir]?Ar.push(Ce._promises.pop().then(function(){Wr(Wt,rr)})):Wr(Wt,rr)}),Bt(Me,[F]),br.exit().remove(),nt.repositionOnUpdate&&br.each(function(Lt){A.select(this).select("text").call(n.positionText,Gt.xFn(Lt),Gt.yFn(Lt))});function Wr(Lt,Wt){Lt.each(function(ir){var Ir=A.select(this),Br=Ir.select(".text-math-group"),Er=Gt.anchorFn(ir,Wt),_r=nt.transFn.call(Ir.node(),ir)+(g(Wt)&&+Wt!=0?" rotate("+Wt+","+Gt.xFn(ir)+","+(Gt.yFn(ir)-ir.fontSize/2)+")":""),Gr=n.lineCount(Ir),wn=Y*ir.fontSize,cn=Gt.heightFn(ir,g(Wt)?+Wt:0,(Gr-1)*wn);if(cn&&(_r+=a(0,cn)),Br.empty()){var Bn=Ir.select("text");Bn.attr({transform:_r,"text-anchor":Er}),Bn.style("opacity",1),Me._adjustTickLabelsOverflow&&Me._adjustTickLabelsOverflow()}else{var En=c.bBox(Br.node()).width,Yn=En*{end:-.5,start:.5}[Er];Br.attr("transform",_r+a(Yn,0))}})}Me._adjustTickLabelsOverflow=function(){var Lt=Me.ticklabeloverflow;if(!(!Lt||Lt==="allow")){var Wt=Lt.indexOf("hide")!==-1,ir=Me._id.charAt(0)==="x",Ir=0,Br=ir?Ce._fullLayout.width:Ce._fullLayout.height;if(Lt.indexOf("domain")!==-1){var Er=e.simpleMap(Me.range,Me.r2l);Ir=Me.l2p(Er[0])+Me._offset,Br=Me.l2p(Er[1])+Me._offset}var _r=Math.min(Ir,Br),Gr=Math.max(Ir,Br),wn=Me.side,cn=1/0,Bn=-1/0;br.each(function(pa){var Ma=A.select(this),ci=Ma.select(".text-math-group");if(ci.empty()){var Ha=c.bBox(Ma.node()),ja=0;ir?(Ha.right>Gr||Ha.left<_r)&&(ja=1):(Ha.bottom>Gr||Ha.top+(Me.tickangle?0:pa.fontSize/4)<_r)&&(ja=1);var Wa=Ma.select("text");ja?Wt&&Wa.style("opacity",0):(Wa.style("opacity",1),wn==="bottom"||wn==="right"?cn=Math.min(cn,ir?Ha.top:Ha.left):cn=-1/0,wn==="top"||wn==="left"?Bn=Math.max(Bn,ir?Ha.bottom:Ha.right):Bn=1/0)}});for(var En in st._plots){var Yn=st._plots[En];if(!(Me._id!==Yn.xaxis._id&&Me._id!==Yn.yaxis._id)){var Hn=ir?Yn.yaxis:Yn.xaxis;Hn&&(Hn["_visibleLabelMin_"+Me._id]=cn,Hn["_visibleLabelMax_"+Me._id]=Bn)}}}},Me._hideCounterAxisInsideTickLabels=function(Lt){var Wt=Me._id.charAt(0)==="x",ir=[];for(var Ir in st._plots){var Br=st._plots[Ir];Me._id!==Br.xaxis._id&&Me._id!==Br.yaxis._id||ir.push(Wt?Br.yaxis:Br.xaxis)}ir.forEach(function(Er,_r){Er&&Tt(Er)&&(Lt||[I,R,D,O,F]).forEach(function(Gr){var wn=Gr.K==="tick"&&Gr.L==="text"&&Me.ticklabelmode==="period",cn=st._plots[Me._mainSubplot],Bn;Gr.K===I.K?Bn=cn.zerolinelayer.selectAll("."+Me._id+"zl"):Gr.K===R.K?Bn=cn.minorGridlayer.selectAll("."+Me._id):Gr.K===D.K?Bn=cn.gridlayer.selectAll("."+Me._id):Bn=cn[Me._id.charAt(0)+"axislayer"],Bn.each(function(){var En=A.select(this);Gr.L&&(En=En.selectAll(Gr.L)),En.each(function(Yn){var Hn=Me.l2p(wn?wt(Yn):Yn.x)+Me._offset,pa=A.select(this);Hn<Me["_visibleLabelMax_"+Er._id]&&Hn>Me["_visibleLabelMin_"+Er._id]?pa.style("display","none"):Gr.K==="tick"&&!_r&&pa.style("display",null)})})})})},Wr(br,kr+1?kr:rr);function nr(){return Ar.length&&Promise.all(Ar)}var yr=null;function Pr(){if(Wr(br,rr),Ct.length&&At==="x"&&!g(rr)&&(Me.type!=="log"||String(Me.dtick).charAt(0)!=="D")){yr=0;var Lt=0,Wt=[],ir;if(br.each(function(Ha){Lt=Math.max(Lt,Ha.fontSize);var ja=Me.l2p(Ha.x),Wa=jr(this),Tr=c.bBox(Wa.node());Wt.push({top:0,bottom:10,height:10,left:ja-Tr.width/2,right:ja+Tr.width/2+2,width:Tr.width+2})}),(Me.tickson==="boundaries"||Me.showdividers)&&!nt.secondary){var Ir=2;for(Me.ticks&&(Ir+=Me.tickwidth/2),ir=0;ir<Wt.length;ir++){var Br=Ct[ir].xbnd,Er=Wt[ir];if(Br[0]!==null&&Er.left-Me.l2p(Br[0])<Ir||Br[1]!==null&&Me.l2p(Br[1])-Er.right<Ir){yr=90;break}}}else{var _r=Ct.length,Gr=Math.abs((Ct[_r-1].x-Ct[0].x)*Me._m)/(_r-1),wn=Me.ticklabelposition||"",cn=function(Ha){return wn.indexOf(Ha)!==-1},Bn=cn("top"),En=cn("left"),Yn=cn("right"),Hn=cn("bottom"),pa=Hn||En||Bn||Yn,Ma=pa?(Me.tickwidth||0)+2*ue:0,ci=Gr<Lt*2.5||Me.type==="multicategory"||Me._name==="realaxis";for(ir=0;ir<Wt.length-1;ir++)if(e.bBoxIntersect(Wt[ir],Wt[ir+1],Ma)){yr=ci?90:30;break}}yr&&Wr(br,yr)}}Me._selections&&(Me._selections[dt]=br);var Or=[nr];Me.automargin&&st._redrawFromAutoMarginCount&&kr===90?(yr=90,Or.push(function(){Wr(br,kr)})):Or.push(Pr),Me._tickAngles&&Or.push(function(){Me._tickAngles[dt]=yr===null?g(rr)?rr:0:yr});var Sr=Me._anchorAxis;Sr&&Sr.autorange&&Tt(Me)&&!$(st,Me._id)&&(st._insideTickLabelsAutorange||(st._insideTickLabelsAutorange={}),st._insideTickLabelsAutorange[Sr._name+".autorange"]=Sr.autorange,Or.push(function(){br.each(function(Wt,ir){var Ir=jr(this),Br=Ir.select(".text-math-group");Br.empty()&&(Me._vals[ir].bb=c.bBox(Ir.node()))})}));var tt=e.syncOrAsync(Or);return tt&&tt.then&&Ce._promises.push(tt),tt};function Nt(Ce,Me,nt){var st=Me._id+"divider",ct=nt.vals,At=nt.layer.selectAll("path."+st).data(ct,Dt);At.exit().remove(),At.enter().insert("path",":first-child").classed(st,1).classed("crisp",1).call(t.stroke,Me.dividercolor).style("stroke-width",c.crispRound(Ce,Me.dividerwidth,1)+"px"),At.attr("transform",nt.transFn).attr("d",nt.path)}j.getPxPosition=function(Ce,Me){var nt=Ce._fullLayout._size,st=Me._id.charAt(0),ct=Me.side,At;if(Me.anchor!=="free"?At=Me._anchorAxis:st==="x"?At={_offset:nt.t+(1-(Me.position||0))*nt.h,_length:0}:st==="y"&&(At={_offset:nt.l+(Me.position||0)*nt.w,_length:0}),ct==="top"||ct==="left")return At._offset;if(ct==="bottom"||ct==="right")return At._offset+At._length};function Xt(Ce){var Me=Ce.title.font.size,nt=(Ce.title.text.match(n.BR_TAG_ALL)||[]).length;return Ce.title.hasOwnProperty("standoff")?nt?Me*(W+nt*Y):Me*W:nt?Me*(nt+1)*Y:Me}function Ht(Ce,Me){var nt=Ce._fullLayout,st=Me._id,ct=st.charAt(0),At=Me.title.font.size,dt;if(Me.title.hasOwnProperty("standoff"))dt=Me._depth+Me.title.standoff+Xt(Me);else{var Ct=Tt(Me);if(Me.type==="multicategory")dt=Me._depth;else{var Gt=1.5*At;Ct&&(Gt=.5*At,Me.ticks==="outside"&&(Gt+=Me.ticklen)),dt=10+Gt+(Me.linewidth?Me.linewidth-1:0)}Ct||(ct==="x"?dt+=Me.side==="top"?At*(Me.showticklabels?1:0):At*(Me.showticklabels?1.5:.5):dt+=Me.side==="right"?At*(Me.showticklabels?1:.5):At*(Me.showticklabels?.5:0))}var rr=j.getPxPosition(Ce,Me),kr,br,Ar;ct==="x"?(br=Me._offset+Me._length/2,Ar=Me.side==="top"?rr-dt:rr+dt):(Ar=Me._offset+Me._length/2,br=Me.side==="right"?rr+dt:rr-dt,kr={rotate:"-90",offset:0});var Wr;if(Me.type!=="multicategory"){var nr=Me._selections[Me._id+"tick"];if(Wr={selection:nr,side:Me.side},nr&&nr.node()&&nr.node().parentNode){var yr=c.getTranslate(nr.node().parentNode);Wr.offsetLeft=yr.x,Wr.offsetTop=yr.y}Me.title.hasOwnProperty("standoff")&&(Wr.pad=0)}return r.draw(Ce,st+"title",{propContainer:Me,propName:Me._name+".title.text",placeholder:nt._dfltTitle[ct],avoid:Wr,transform:kr,attributes:{x:br,y:Ar,"text-anchor":"middle"}})}j.shouldShowZeroLine=function(Ce,Me,nt){var st=e.simpleMap(Me.range,Me.r2l);return st[0]*st[1]<=0&&Me.zeroline&&(Me.type==="linear"||Me.type==="-")&&!(Me.rangebreaks&&Me.maskBreaks(0)===z)&&(ar(Me,0)||!Vr(Ce,Me,nt,st)||nn(Ce,Me))},j.clipEnds=function(Ce,Me){return Me.filter(function(nt){return ar(Ce,nt.x)})};function ar(Ce,Me){var nt=Ce.l2p(Me);return nt>1&&nt<Ce._length-1}function Vr(Ce,Me,nt,st){var ct=nt._mainAxis;if(!ct)return;var At=Ce._fullLayout,dt=Me._id.charAt(0),Ct=j.counterLetter(Me._id),Gt=Me._offset+(Math.abs(st[0])<Math.abs(st[1])==(dt==="x")?0:Me._length);function rr(nr){if(!nr.showline||!nr.linewidth)return!1;var yr=Math.max((nr.linewidth+Me.zerolinewidth)/2,1);function Pr(tt){return typeof tt=="number"&&Math.abs(tt-Gt)<yr}if(Pr(nr._mainLinePosition)||Pr(nr._mainMirrorPosition))return!0;var Or=nr._linepositions||{};for(var Sr in Or)if(Pr(Or[Sr][0])||Pr(Or[Sr][1]))return!0}var kr=At._plots[nt._mainSubplot];if(!(kr.mainplotinfo||kr).overlays.length)return rr(nt);for(var br=j.list(Ce,Ct),Ar=0;Ar<br.length;Ar++){var Wr=br[Ar];if(Wr._mainAxis===ct&&rr(Wr))return!0}}function nn(Ce,Me){for(var nt=Ce._fullData,st=Me._mainSubplot,ct=Me._id.charAt(0),At=0;At<nt.length;At++){var dt=nt[At];if(dt.visible===!0&&dt.xaxis+dt.yaxis===st&&(M.traceIs(dt,"bar-like")&&dt.orientation==={x:"h",y:"v"}[ct]||dt.fill&&dt.fill.charAt(dt.fill.length-1)===ct))return!0}return!1}function jr(Ce){var Me=A.select(Ce),nt=Me.select(".text-math-group");return nt.empty()?Me.select("text"):nt}j.allowAutoMargin=function(Ce){for(var Me=j.list(Ce,"",!0),nt=0;nt<Me.length;nt++){var st=Me[nt];st.automargin&&(S.allowAutoMargin(Ce,at(st)),st.mirror&&S.allowAutoMargin(Ce,$t(st))),M.getComponentMethod("rangeslider","isVisible")(st)&&S.allowAutoMargin(Ce,Zt(st))}};function at(Ce){return Ce._id+".automargin"}function $t(Ce){return at(Ce)+".mirror"}function Zt(Ce){return Ce._id+".rangeslider"}j.swap=function(Ce,Me){for(var nt=ur(Ce,Me),st=0;st<nt.length;st++)$e(Ce,nt[st].x,nt[st].y)};function ur(Ce,Me){var nt=[],st,ct;for(st=0;st<Me.length;st++){var At=[],dt=Ce._fullData[Me[st]].xaxis,Ct=Ce._fullData[Me[st]].yaxis;if(!(!dt||!Ct)){for(ct=0;ct<nt.length;ct++)(nt[ct].x.indexOf(dt)!==-1||nt[ct].y.indexOf(Ct)!==-1)&&At.push(ct);if(!At.length){nt.push({x:[dt],y:[Ct]});continue}var Gt=nt[At[0]],rr;if(At.length>1)for(ct=1;ct<At.length;ct++)rr=nt[At[ct]],wr(Gt.x,rr.x),wr(Gt.y,rr.y);wr(Gt.x,[dt]),wr(Gt.y,[Ct])}}return nt}function wr(Ce,Me){for(var nt=0;nt<Me.length;nt++)Ce.indexOf(Me[nt])===-1&&Ce.push(Me[nt])}function $e(Ce,Me,nt){var st=[],ct=[],At=Ce.layout,dt,Ct;for(dt=0;dt<Me.length;dt++)st.push(j.getFromId(Ce,Me[dt]));for(dt=0;dt<nt.length;dt++)ct.push(j.getFromId(Ce,nt[dt]));var Gt=Object.keys(s),rr=["anchor","domain","overlaying","position","side","tickangle","editType"],kr=["linear","log"];for(dt=0;dt<Gt.length;dt++){var br=Gt[dt],Ar=st[0][br],Wr=ct[0][br],nr=!0,yr=!1,Pr=!1;if(!(br.charAt(0)==="_"||typeof Ar=="function"||rr.indexOf(br)!==-1)){for(Ct=1;Ct<st.length&&nr;Ct++){var Or=st[Ct][br];br==="type"&&kr.indexOf(Ar)!==-1&&kr.indexOf(Or)!==-1&&Ar!==Or?yr=!0:Or!==Ar&&(nr=!1)}for(Ct=1;Ct<ct.length&&nr;Ct++){var Sr=ct[Ct][br];br==="type"&&kr.indexOf(Wr)!==-1&&kr.indexOf(Sr)!==-1&&Wr!==Sr?Pr=!0:ct[Ct][br]!==Wr&&(nr=!1)}nr&&(yr&&(At[st[0]._name].type="linear"),Pr&&(At[ct[0]._name].type="linear"),Je(At,br,st,ct,Ce._fullLayout._dfltTitle))}}for(dt=0;dt<Ce._fullLayout.annotations.length;dt++){var tt=Ce._fullLayout.annotations[dt];Me.indexOf(tt.xref)!==-1&&nt.indexOf(tt.yref)!==-1&&e.swapAttrs(At.annotations[dt],["?"])}}function Je(Ce,Me,nt,st,ct){var At=e.nestedProperty,dt=At(Ce[nt[0]._name],Me).get(),Ct=At(Ce[st[0]._name],Me).get(),Gt;for(Me==="title"&&(dt&&dt.text===ct.x&&(dt.text=ct.y),Ct&&Ct.text===ct.y&&(Ct.text=ct.x)),Gt=0;Gt<nt.length;Gt++)At(Ce,nt[Gt]._name+"."+Me).set(Ct);for(Gt=0;Gt<st.length;Gt++)At(Ce,st[Gt]._name+"."+Me).set(dt)}function it(Ce){return Ce._id==="angularaxis"}function lt(Ce,Me){for(var nt=Me._rangebreaks.length,st=0;st<nt;st++){var ct=Me._rangebreaks[st];if(Ce>=ct.min&&Ce<ct.max)return ct.max}return Ce}function Tt(Ce){return(Ce.ticklabelposition||"").indexOf("inside")!==-1}function Bt(Ce,Me){Tt(Ce._anchorAxis||{})&&Ce._hideCounterAxisInsideTickLabels&&Ce._hideCounterAxisInsideTickLabels(Me)}},{"../../components/color":367,"../../components/drawing":389,"../../components/titles":476,"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"./autorange":565,"./axis_autotype":567,"./axis_ids":570,"./clean_ticks":572,"./layout_attributes":579,"./set_convert":585,"@plotly/d3":58,"fast-isnumeric":190}],567:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib"),S=d("../../constants/numerical").BADNUM,M=g.isArrayOrTypedArray,e=g.isDateTime,a=g.cleanNumber,n=Math.round;ee.exports=function(v,f,y){var o=v,m=y.noMultiCategory;if(M(o)&&!o.length)return"-";if(!m&&x(o))return"multicategory";if(m&&Array.isArray(o[0])){for(var l=[],w=0;w<o.length;w++)if(M(o[w]))for(var _=0;_<o[w].length;_++)l.push(o[w][_]);o=l}if(c(o,f))return"date";var h=y.autotypenumbers!=="strict";return i(o,h)?"category":t(o,h)?"linear":"-"};function r(p,v){return v?A(p):typeof p=="number"}function t(p,v){for(var f=p.length,y=0;y<f;y++)if(r(p[y],v))return!0;return!1}function c(p,v){for(var f=p.length,y=s(f),o=0,m=0,l={},w=0;w<f;w+=y){var _=n(w),h=p[_],b=String(h);l[b]||(l[b]=1,e(h,v)&&o++,A(h)&&m++)}return o>m*2}function s(p){return Math.max(1,(p-1)/1e3)}function i(p,v){for(var f=p.length,y=s(f),o=0,m=0,l={},w=0;w<f;w+=y){var _=n(w),h=p[_],b=String(h);if(!l[b]){l[b]=1;var u=typeof h;u==="boolean"?m++:(v?a(h)!==S:u==="number")?o++:u==="string"&&m++}}return m>o*2}function x(p){return M(p[0])&&M(p[1])}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],568:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../registry"),S=d("../../lib"),M=d("../../plot_api/plot_template"),e=d("../array_container_defaults"),a=d("./layout_attributes"),n=d("./tick_value_defaults"),r=d("./tick_mark_defaults"),t=d("./tick_label_defaults"),c=d("./prefix_suffix_defaults"),s=d("./category_order_defaults"),i=d("./line_grid_defaults"),x=d("./set_convert"),p=d("./constants").WEEKDAY_PATTERN,v=d("./constants").HOUR_PATTERN;ee.exports=function(l,w,_,h,b){var u=h.letter,L=h.font||{},T=h.splomStash||{},k=_("visible",!h.visibleDflt),P=w._template||{},z=w.type||P.type||"-",I;if(z==="date"){var D=g.getComponentMethod("calendars","handleDefaults");D(l,w,"calendar",h.calendar),h.noTicklabelmode||(I=_("ticklabelmode"))}var R="";(!h.noTicklabelposition||z==="multicategory")&&(R=S.coerce(l,w,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:I==="period"?["outside","inside"]:u==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),h.noTicklabeloverflow||_("ticklabeloverflow",R.indexOf("inside")!==-1?"hide past domain":z==="category"||z==="multicategory"?"allow":"hide past div"),x(w,b);var O=!w.isValidRange(l.range);O&&h.reverseDflt&&(O="reversed");var F=_("autorange",O);F&&(z==="linear"||z==="-")&&_("rangemode"),_("range"),w.cleanRange(),s(l,w,_,h),z!=="category"&&!h.noHover&&_("hoverformat");var N=_("color"),G=N!==a.color.dflt?N:L.color,K=T.label||b._dfltTitle[u];if(c(l,w,_,z,h),!k)return w;_("title.text",K),S.coerceFont(_,"title.font",{family:L.family,size:S.bigFont(L.size),color:G}),n(l,w,_,z);var W=h.hasMinor;if(W&&(M.newContainer(w,"minor"),n(l,w,_,z,{isMinor:!0})),t(l,w,_,z,h),r(l,w,_,h),W){var Y=h.isMinor;h.isMinor=!0,r(l,w,_,h),h.isMinor=Y}i(l,w,_,{dfltColor:N,bgColor:h.bgColor,showGrid:h.showGrid,hasMinor:W,attributes:a}),W&&!w.minor.ticks&&!w.minor.showgrid&&delete w.minor,(w.showline||w.ticks)&&_("mirror"),h.automargin&&_("automargin");var re=z==="multicategory";if(!h.noTickson&&(z==="category"||re)&&(w.ticks||w.showgrid)){var ue;re&&(ue="boundaries");var j=_("tickson",ue);j==="boundaries"&&delete w.ticklabelposition}if(re){var q=_("showdividers");q&&(_("dividercolor"),_("dividerwidth"))}if(z==="date")if(e(l,w,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:f}),!w.rangebreaks.length)delete w.rangebreaks;else{for(var V=0;V<w.rangebreaks.length;V++)if(w.rangebreaks[V].pattern===p){w._hasDayOfWeekBreaks=!0;break}if(x(w,b),b._has("scattergl")||b._has("splom"))for(var U=0;U<h.data.length;U++){var $=h.data[U];($.type==="scattergl"||$.type==="splom")&&($.visible=!1,S.warn($.type+" traces do not work on axes with rangebreaks. Setting trace "+$.index+" to `visible: false`."))}}return w};function f(m,l,w){function _(I,D){return S.coerce(m,l,a.rangebreaks,I,D)}var h=_("enabled");if(h){var b=_("bounds");if(b&&b.length>=2){var u="",L,T;if(b.length===2){for(L=0;L<2;L++)if(T=o(b[L]),T){u=p;break}}var k=_("pattern",u);if(k===p)for(L=0;L<2;L++)T=o(b[L]),T&&(l.bounds[L]=b[L]=T-1);if(k)for(L=0;L<2;L++)switch(T=b[L],k){case p:if(!A(T)){l.enabled=!1;return}if(T=+T,T!==Math.floor(T)||T<0||T>=7){l.enabled=!1;return}l.bounds[L]=b[L]=T;break;case v:if(!A(T)){l.enabled=!1;return}if(T=+T,T<0||T>24){l.enabled=!1;return}l.bounds[L]=b[L]=T;break}if(w.autorange===!1){var P=w.range;if(P[0]<P[1]){if(b[0]<P[0]&&b[1]>P[1]){l.enabled=!1;return}}else if(b[0]>P[0]&&b[1]<P[1]){l.enabled=!1;return}}}else{var z=_("values");if(z&&z.length)_("dvalue");else{l.enabled=!1;return}}}}var y={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function o(m){if(typeof m=="string")return y[m.substr(0,3).toLowerCase()]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../array_container_defaults":561,"./category_order_defaults":571,"./constants":573,"./layout_attributes":579,"./line_grid_defaults":581,"./prefix_suffix_defaults":583,"./set_convert":585,"./tick_label_defaults":587,"./tick_mark_defaults":588,"./tick_value_defaults":589,"fast-isnumeric":190}],569:[function(d,ee,te){var A=d("../../constants/docs"),g=A.FORMAT_LINK,S=A.DATE_FORMAT_LINK;function M(n,r){return{valType:"string",dflt:"",editType:"none",description:(r?e:a)("hover text",n)+["By default the values are formatted using "+(r?"generic number format":"`"+n+"axis.hoverformat`")+"."].join(" ")}}function e(n,r){return["Sets the "+n+" formatting rule"+(r?"for `"+r+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+g+"."].join(" ")}function a(n,r){return e(n,r)+[" And for dates see: "+S+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}ee.exports={axisHoverFormat:M,descriptionOnlyNumbers:e,descriptionWithDates:a}},{"../../constants/docs":486}],570:[function(d,ee,te){var A=d("../../registry"),g=d("./constants");te.id2name=function(e){if(!(typeof e!="string"||!e.match(g.AX_ID_PATTERN))){var a=e.split(" ")[0].substr(1);return a==="1"&&(a=""),e.charAt(0)+"axis"+a}},te.name2id=function(e){if(!!e.match(g.AX_NAME_PATTERN)){var a=e.substr(5);return a==="1"&&(a=""),e.charAt(0)+a}},te.cleanId=function(e,a,n){var r=/( domain)$/.test(e);if(!(typeof e!="string"||!e.match(g.AX_ID_PATTERN))&&!(a&&e.charAt(0)!==a)&&!(r&&!n)){var t=e.split(" ")[0].substr(1).replace(/^0+/,"");return t==="1"&&(t=""),e.charAt(0)+t+(r&&n?" domain":"")}},te.list=function(M,e,a){var n=M._fullLayout;if(!n)return[];var r=te.listIds(M,e),t=new Array(r.length),c;for(c=0;c<r.length;c++){var s=r[c];t[c]=n[s.charAt(0)+"axis"+s.substr(1)]}if(!a){var i=n._subplots.gl3d||[];for(c=0;c<i.length;c++){var x=n[i[c]];e?t.push(x[e+"axis"]):t.push(x.xaxis,x.yaxis,x.zaxis)}}return t},te.listIds=function(M,e){var a=M._fullLayout;if(!a)return[];var n=a._subplots;return e?n[e+"axis"]:n.xaxis.concat(n.yaxis)},te.getFromId=function(M,e,a){var n=M._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),a==="x"?e=e.replace(/y[0-9]*/,""):a==="y"&&(e=e.replace(/x[0-9]*/,"")),n[te.id2name(e)]},te.getFromTrace=function(M,e,a){var n=M._fullLayout,r=null;if(A.traceIs(e,"gl3d")){var t=e.scene;t.substr(0,5)==="scene"&&(r=n[t][a+"axis"])}else r=te.getFromId(M,e[a+"axis"]||a);return r},te.idSort=function(M,e){var a=M.charAt(0),n=e.charAt(0);return a!==n?a>n?1:-1:+(M.substr(1)||1)-+(e.substr(1)||1)},te.ref2id=function(M){return/^[xyz]/.test(M)?M.split(" ")[0]:!1};function S(M,e){if(e&&e.length){for(var a=0;a<e.length;a++)if(e[a][M])return!0}return!1}te.isLinked=function(M,e){return S(e,M._axisMatchGroups)||S(e,M._axisConstraintGroups)}},{"../../registry":647,"./constants":573}],571:[function(d,ee,te){function A(g,S){var M=S.dataAttr||g._id.charAt(0),e={},a,n,r;if(S.axData)a=S.axData;else for(a=[],n=0;n<S.data.length;n++){var t=S.data[n];t[M+"axis"]===g._id&&a.push(t)}for(n=0;n<a.length;n++){var c=a[n][M];for(r=0;r<c.length;r++){var s=c[r];s!=null&&(e[s]=1)}}return Object.keys(e)}ee.exports=function(S,M,e,a){if(M.type==="category"){var n=S.categoryarray,r=Array.isArray(n)&&n.length>0,t;r&&(t="array");var c=e("categoryorder",t),s;c==="array"&&(s=e("categoryarray")),!r&&c==="array"&&(c=M.categoryorder="trace"),c==="trace"?M._initialCategories=[]:c==="array"?M._initialCategories=s.slice():(s=A(M,a).sort(),c==="category ascending"?M._initialCategories=s:c==="category descending"&&(M._initialCategories=s.reverse()))}}},{}],572:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib"),S=d("../../constants/numerical"),M=S.ONEDAY,e=S.ONEWEEK;te.dtick=function(a,n){var r=n==="log",t=n==="date",c=n==="category",s=t?M:1;if(!a)return s;if(A(a))return a=Number(a),a<=0?s:c?Math.max(1,Math.round(a)):t?Math.max(.1,a):a;if(typeof a!="string"||!(t||r))return s;var i=a.charAt(0),x=a.substr(1);return x=A(x)?Number(x):0,x<=0||!(t&&i==="M"&&x===Math.round(x)||r&&i==="L"||r&&i==="D"&&(x===1||x===2))?s:a},te.tick0=function(a,n,r,t){if(n==="date")return g.cleanDate(a,g.dateTick0(r,t%e===0?1:0));if(!(t==="D1"||t==="D2"))return A(a)?Number(a):0}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],573:[function(d,ee,te){var A=d("../../lib/regex").counter;ee.exports={idRegex:{x:A("x","( domain)?"),y:A("y","( domain)?")},attrRegex:A("[xy]axis"),xAxisMatch:A("xaxis"),yAxisMatch:A("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINZOOM:20,DRAGGERSIZE:20,REDRAWDELAY:50,DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":532}],574:[function(d,ee,te){var A=d("../../lib"),g=d("./autorange"),S=d("./axis_ids").id2name,M=d("./layout_attributes"),e=d("./scale_zoom"),a=d("./set_convert"),n=d("../../constants/numerical").ALMOST_EQUAL,r=d("../../constants/alignment").FROM_BL;te.handleDefaults=function(f,y,o){var m=o.axIds,l=o.axHasImage,w=y._axisConstraintGroups=[],_=y._axisMatchGroups=[],h,b,u,L,T,k,P,z;for(h=0;h<m.length;h++)L=S(m[h]),T=f[L],k=y[L],t(T,k,{axIds:m,layoutOut:y,hasImage:l[L]});function I(Y,re){for(h=0;h<Y.length;h++){b=Y[h];for(u in b)y[S(u)][re]=b}}for(I(_,"_matchGroup"),h=0;h<w.length;h++){b=w[h];for(u in b)if(k=y[S(u)],k.fixedrange){for(var D in b){var R=S(D);(f[R]||{}).fixedrange===!1&&A.warn("fixedrange was specified as false for axis "+R+" but was overridden because another axis in its constraint group has fixedrange true"),y[R].fixedrange=!0}break}}for(h=0;h<w.length;){b=w[h];for(u in b){k=y[S(u)],k._matchGroup&&Object.keys(k._matchGroup).length===Object.keys(b).length&&(w.splice(h,1),h--);break}h++}I(w,"_constraintGroup");var O=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],F=!1,N=!1;function G(){z=k[P],P==="rangebreaks"&&(N=k._hasDayOfWeekBreaks)}for(h=0;h<_.length;h++){b=_[h];for(var K=0;K<O.length;K++){P=O[K],z=null;var W;for(u in b)if(L=S(u),T=f[L],k=y[L],P in k){if(!k.matches&&(W=k,P in T)){G();break}z===null&&P in T&&G()}if(P==="range"&&z&&(F=!0),P==="autorange"&&z===null&&F&&(z=!1),z===null&&P in W&&(z=W[P]),z!==null)for(u in b)k=y[S(u)],k[P]=P==="range"?z.slice():z,P==="rangebreaks"&&(k._hasDayOfWeekBreaks=N,a(k,y))}}};function t(f,y,o){var m=o.axIds,l=o.layoutOut,w=o.hasImage,_=l._axisConstraintGroups,h=l._axisMatchGroups,b=y._id,u=b.charAt(0),L=((l._splomAxes||{})[u]||{})[b]||{},T=y._id,k=T.charAt(0)==="x";y._matchGroup=null,y._constraintGroup=null;function P(q,V){return A.coerce(f,y,M,q,V)}P("constrain",w?"domain":"range"),A.coerce(f,y,{constraintoward:{valType:"enumerated",values:k?["left","center","right"]:["bottom","middle","top"],dflt:k?"center":"middle"}},"constraintoward");var z=y.type,I,D,R=[];for(I=0;I<m.length;I++)if(D=m[I],D!==T){var O=l[S(D)];O.type===z&&R.push(D)}var F=s(_,T);if(F){var N=[];for(I=0;I<R.length;I++)D=R[I],F[D]||N.push(D);R=N}var G=R.length,K,W;G&&(f.matches||L.matches)&&(K=A.coerce(f,y,{matches:{valType:"enumerated",values:R,dflt:R.indexOf(L.matches)!==-1?L.matches:void 0}},"matches"));var Y=w&&!k?y.anchor:void 0;if(G&&!K&&(f.scaleanchor||Y)&&(W=A.coerce(f,y,{scaleanchor:{valType:"enumerated",values:R}},"scaleanchor",Y)),K){y._matchGroup=i(h,T,K,1);var re=l[S(K)],ue=c(l,y)/c(l,re);k!==(K.charAt(0)==="x")&&(ue=(k?"x":"y")+ue),i(_,T,K,ue)}else f.matches&&m.indexOf(f.matches)!==-1&&A.warn("ignored "+y._name+'.matches: "'+f.matches+'" to avoid an infinite loop');if(W){var j=P("scaleratio");j||(j=y.scaleratio=1),i(_,T,W,j)}else f.scaleanchor&&m.indexOf(f.scaleanchor)!==-1&&A.warn("ignored "+y._name+'.scaleanchor: "'+f.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function c(f,y){var o=y.domain;return o||(o=f[S(y.overlaying)].domain),o[1]-o[0]}function s(f,y){for(var o=0;o<f.length;o++)if(f[o][y])return f[o];return null}function i(f,y,o,m){var l,w,_,h,b,u=s(f,y);u===null?(u={},u[y]=1,b=f.length,f.push(u)):b=f.indexOf(u);var L=Object.keys(u);for(l=0;l<f.length;l++)if(_=f[l],l!==b&&_[o]){var T=_[o];for(w=0;w<L.length;w++)h=L[w],_[h]=x(T,x(m,u[h]));f.splice(b,1);return}if(m!==1)for(w=0;w<L.length;w++){var k=L[w];u[k]=x(m,u[k])}u[o]=1}function x(f,y){var o="",m="",l,w;typeof f=="string"&&(o=f.match(/^[xy]*/)[0],l=o.length,f=+f.substr(l)),typeof y=="string"&&(m=y.match(/^[xy]*/)[0],w=m.length,y=+y.substr(w));var _=f*y;return!l&&!w?_:!l||!w||o.charAt(0)===m.charAt(0)?o+m+f*y:l===w?_:(l>w?o.substr(w):m.substr(l))+_}function p(f,y){for(var o=y._size,m=o.h/o.w,l={},w=Object.keys(f),_=0;_<w.length;_++){var h=w[_],b=f[h];if(typeof b=="string"){var u=b.match(/^[xy]*/)[0],L=u.length;b=+b.substr(L);for(var T=u.charAt(0)==="y"?m:1/m,k=0;k<L;k++)b*=T}l[h]=b}return l}te.enforce=function(y){var o=y._fullLayout,m=o._axisConstraintGroups||[],l,w,_,h,b,u,L,T;for(l=0;l<m.length;l++){_=p(m[l],o);var k=Object.keys(_),P=1/0,z=0,I=1/0,D={},R={},O=!1;for(w=0;w<k.length;w++)h=k[w],R[h]=b=o[S(h)],b._inputDomain?b.domain=b._inputDomain.slice():b._inputDomain=b.domain.slice(),b._inputRange||(b._inputRange=b.range.slice()),b.setScale(),D[h]=u=Math.abs(b._m)/_[h],P=Math.min(P,u),(b.constrain==="domain"||!b._constraintShrinkable)&&(I=Math.min(I,u)),delete b._constraintShrinkable,z=Math.max(z,u),b.constrain==="domain"&&(O=!0);if(!(P>n*z&&!O)){for(w=0;w<k.length;w++)if(h=k[w],u=D[h],b=R[h],L=b.constrain,u!==I||L==="domain")if(T=u/I,L==="range")e(b,T);else{var F=b._inputDomain,N=(b.domain[1]-b.domain[0])/(F[1]-F[0]),G=(b.r2l(b.range[1])-b.r2l(b.range[0]))/(b.r2l(b._inputRange[1])-b.r2l(b._inputRange[0]));if(T/=N,T*G<1){b.domain=b._input.domain=F.slice(),e(b,T);continue}if(G<1&&(b.range=b._input.range=b._inputRange.slice(),T*=G),b.autorange){var K=b.r2l(b.range[0]),W=b.r2l(b.range[1]),Y=(K+W)/2,re=Y,ue=Y,j=Math.abs(W-Y),q=Y-j*T*1.0001,V=Y+j*T*1.0001,U=g.makePadFn(o,b,0),$=g.makePadFn(o,b,1);v(b,T);var ne=Math.abs(b._m),X=g.concatExtremes(y,b),Q=X.min,ie=X.max,se,ae;for(ae=0;ae<Q.length;ae++)se=Q[ae].val-U(Q[ae])/ne,se>q&&se<re&&(re=se);for(ae=0;ae<ie.length;ae++)se=ie[ae].val+$(ie[ae])/ne,se<V&&se>ue&&(ue=se);var oe=(ue-re)/(2*j);T/=oe,re=b.l2r(re),ue=b.l2r(ue),b.range=b._input.range=K<W?[re,ue]:[ue,re]}v(b,T)}}}},te.getAxisGroup=function(y,o){for(var m=y._axisMatchGroups,l=0;l<m.length;l++){var w=m[l];if(w[o])return"g"+l}return o},te.clean=function(y,o){if(o._inputDomain){for(var m=!1,l=o._id,w=y._fullLayout._axisConstraintGroups,_=0;_<w.length;_++)if(w[_][l]){m=!0;break}(!m||o.constrain!=="domain")&&(o._input.domain=o.domain=o._inputDomain,delete o._inputDomain)}};function v(f,y){var o=f._inputDomain,m=r[f.constraintoward],l=o[0]+(o[1]-o[0])*m;f.domain=f._input.domain=[l+(o[0]-l)/y,l+(o[1]-l)/y],f.setScale()}},{"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"./autorange":565,"./axis_ids":570,"./layout_attributes":579,"./scale_zoom":584,"./set_convert":585}],575:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=g.numberFormat,M=d("tinycolor2"),e=d("has-passive-events"),a=d("../../registry"),n=g.strTranslate,r=d("../../lib/svg_text_utils"),t=d("../../components/color"),c=d("../../components/drawing"),s=d("../../components/fx"),i=d("./axes"),x=d("../../lib/setcursor"),p=d("../../components/dragelement"),v=d("../../components/dragelement/helpers"),f=v.selectingOrDrawing,y=v.freeMode,o=d("../../constants/alignment").FROM_TL,m=d("../../lib/clear_gl_canvases"),l=d("../../plot_api/subroutines").redrawReglTraces,w=d("../plots"),_=d("./axis_ids").getFromId,h=d("../../components/selections").prepSelect,b=d("../../components/selections").clearOutline,u=d("../../components/selections").selectOnClick,L=d("./scale_zoom"),T=d("./constants"),k=T.MINDRAG,P=T.MINZOOM,z=!0;function I(se,ae,oe,be,ce,de,ye,ge){var me=se._fullLayout._zoomlayer,Ee=ye+ge==="nsew",Pe=(ye+ge).length===1,Ne,we,ke,Xe,He,Ie,De,Ge,ht,Rt,Kt,It,Mt,Yt,zt,St,Ye,rt,Ve,Ae,Ue,Ze,Qe;function _t(){if(Ne=ae.xaxis,we=ae.yaxis,ht=Ne._length,Rt=we._length,De=Ne._offset,Ge=we._offset,ke={},ke[Ne._id]=Ne,Xe={},Xe[we._id]=we,ye&&ge)for(var br=ae.overlays,Ar=0;Ar<br.length;Ar++){var Wr=br[Ar].xaxis;ke[Wr._id]=Wr;var nr=br[Ar].yaxis;Xe[nr._id]=nr}He=ie(ke),Ie=ie(Xe),Mt=O(He,ge),Yt=O(Ie,ye),zt=!Yt&&!Mt,It=X(se,se._fullLayout._axisMatchGroups,ke,Xe),Kt=X(se,se._fullLayout._axisConstraintGroups,ke,Xe,It);var yr=Kt.isSubplotConstrained||It.isSubplotConstrained;St=ge||yr,Ye=ye||yr;var Pr=se._fullLayout;rt=Pr._has("scattergl"),Ve=Pr._has("splom"),Ae=Pr._has("svg")}_t();var gt=W(Yt+Mt,se._fullLayout.dragmode,Ee),wt=R(ae,ye+ge+"drag",gt,oe,be,ce,de);if(zt&&!Ee)return wt.onmousedown=null,wt.style.pointerEvents="none",wt;var Ut={element:wt,gd:se,plotinfo:ae};Ut.prepFn=function(br,Ar,Wr){var nr=Ut.dragmode,yr=se._fullLayout.dragmode;yr!==nr&&(Ut.dragmode=yr),_t(),Ze=se._fullLayout._invScaleX,Qe=se._fullLayout._invScaleY,zt||(Ee?br.shiftKey?yr==="pan"?yr="zoom":f(yr)||(yr="pan"):br.ctrlKey&&(yr="pan"):yr="pan"),y(yr)?Ut.minDrag=1:Ut.minDrag=void 0,f(yr)?(Ut.xaxes=He,Ut.yaxes=Ie,h(br,Ar,Wr,Ut,yr)):(Ut.clickFn=Nt,f(nr)&&Dt(),zt||(yr==="zoom"?(Ut.moveFn=$e,Ut.doneFn=it,Ut.minDrag=1,wr(br,Ar,Wr)):yr==="pan"&&(Ut.moveFn=nt,Ut.doneFn=dt))),se._fullLayout._redrag=function(){var Pr=se._dragdata;if(Pr&&Pr.element===wt){var Or=se._fullLayout.dragmode;f(Or)||(_t(),Ct([0,0,ht,Rt]),Ut.moveFn(Pr.dx,Pr.dy))}}};function Dt(){Ut.plotinfo.selection=!1,b(se)}function Nt(br,Ar){var Wr=Ut.gd;if(Wr._fullLayout._activeShapeIndex>=0){Wr._fullLayout._deactivateShape(Wr);return}var nr=Wr._fullLayout.clickmode;if(q(Wr),br===2&&!Pe&&At(),Ee)nr.indexOf("select")>-1&&u(Ar,Wr,He,Ie,ae.id,Ut),nr.indexOf("event")>-1&&s.click(Wr,Ar,ae.id);else if(br===1&&Pe){var yr=ye?we:Ne,Pr=ye==="s"||ge==="w"?0:1,Or=yr._name+".range["+Pr+"]",Sr=F(yr,Pr),tt="left",Lt="middle";if(yr.fixedrange)return;ye?(Lt=ye==="n"?"top":"bottom",yr.side==="right"&&(tt="right")):ge==="e"&&(tt="right"),Wr._context.showAxisRangeEntryBoxes&&A.select(wt).call(r.makeEditable,{gd:Wr,immediate:!0,background:Wr._fullLayout.paper_bgcolor,text:String(Sr),fill:yr.tickfont?yr.tickfont.color:"#444",horizontalAlign:tt,verticalAlign:Lt}).on("edit",function(Wt){var ir=yr.d2r(Wt);ir!==void 0&&a.call("_guiRelayout",Wr,Or,ir)})}}p.init(Ut);var Xt,Ht,ar,Vr,nn,jr,at,$t,Zt,ur;function wr(br,Ar,Wr){var nr=wt.getBoundingClientRect();Xt=Ar-nr.left,Ht=Wr-nr.top,se._fullLayout._calcInverseTransform(se);var yr=g.apply3DTransform(se._fullLayout._invTransform)(Xt,Ht);Xt=yr[0],Ht=yr[1],ar={l:Xt,r:Xt,w:0,t:Ht,b:Ht,h:0},Vr=se._hmpixcount?se._hmlumcount/se._hmpixcount:M(se._fullLayout.plot_bgcolor).getLuminance(),nn="M0,0H"+ht+"V"+Rt+"H0V0",jr=!1,at="xy",ur=!1,$t=Y(me,Vr,De,Ge,nn),Zt=re(me,De,Ge)}function $e(br,Ar){if(se._transitioningWithDuration)return!1;var Wr=Math.max(0,Math.min(ht,Ze*br+Xt)),nr=Math.max(0,Math.min(Rt,Qe*Ar+Ht)),yr=Math.abs(Wr-Xt),Pr=Math.abs(nr-Ht);ar.l=Math.min(Xt,Wr),ar.r=Math.max(Xt,Wr),ar.t=Math.min(Ht,nr),ar.b=Math.max(Ht,nr);function Or(){at="",ar.r=ar.l,ar.t=ar.b,Zt.attr("d","M0,0Z")}if(Kt.isSubplotConstrained)yr>P||Pr>P?(at="xy",yr/ht>Pr/Rt?(Pr=yr*Rt/ht,Ht>nr?ar.t=Ht-Pr:ar.b=Ht+Pr):(yr=Pr*ht/Rt,Xt>Wr?ar.l=Xt-yr:ar.r=Xt+yr),Zt.attr("d",ne(ar))):Or();else if(It.isSubplotConstrained)if(yr>P||Pr>P){at="xy";var Sr=Math.min(ar.l/ht,(Rt-ar.b)/Rt),tt=Math.max(ar.r/ht,(Rt-ar.t)/Rt);ar.l=Sr*ht,ar.r=tt*ht,ar.b=(1-Sr)*Rt,ar.t=(1-tt)*Rt,Zt.attr("d",ne(ar))}else Or();else!Yt||Pr<Math.min(Math.max(yr*.6,k),P)?yr<k||!Mt?Or():(ar.t=0,ar.b=Rt,at="x",Zt.attr("d",U(ar,Ht))):!Mt||yr<Math.min(Pr*.6,P)?(ar.l=0,ar.r=ht,at="y",Zt.attr("d",$(ar,Xt))):(at="xy",Zt.attr("d",ne(ar)));ar.w=ar.r-ar.l,ar.h=ar.b-ar.t,at&&(ur=!0),se._dragged=ur,ue($t,Zt,ar,nn,jr,Vr),Je(),se.emit("plotly_relayouting",Ue),jr=!0}function Je(){Ue={},(at==="xy"||at==="x")&&(N(He,ar.l/ht,ar.r/ht,Ue,Kt.xaxes),st("x",Ue)),(at==="xy"||at==="y")&&(N(Ie,(Rt-ar.b)/Rt,(Rt-ar.t)/Rt,Ue,Kt.yaxes),st("y",Ue))}function it(){Je(),q(se),dt(),V(se)}var lt=[0,0,ht,Rt],Tt=null,Bt=T.REDRAWDELAY,Ce=ae.mainplot?se._fullLayout._plots[ae.mainplot]:ae;function Me(br){if(!se._context._scrollZoom.cartesian&&!se._fullLayout._enablescrollzoom)return;if(Dt(),se._transitioningWithDuration){br.preventDefault(),br.stopPropagation();return}_t(),clearTimeout(Tt);var Ar=-br.deltaY;if(isFinite(Ar)||(Ar=br.wheelDelta/10),!isFinite(Ar)){g.log("Did not find wheel motion attributes: ",br);return}var Wr=Math.exp(-Math.min(Math.max(Ar,-20),20)/200),nr=Ce.draglayer.select(".nsewdrag").node().getBoundingClientRect(),yr=(br.clientX-nr.left)/nr.width,Pr=(nr.bottom-br.clientY)/nr.height,Or;function Sr(tt,Lt,Wt){if(tt.fixedrange)return;var ir=g.simpleMap(tt.range,tt.r2l),Ir=ir[0]+(ir[1]-ir[0])*Lt;function Br(Er){return tt.l2r(Ir+(Er-Ir)*Wt)}tt.range=ir.map(Br)}if(St){for(ge||(yr=.5),Or=0;Or<He.length;Or++)Sr(He[Or],yr,Wr);st("x"),lt[2]*=Wr,lt[0]+=lt[2]*yr*(1/Wr-1)}if(Ye){for(ye||(Pr=.5),Or=0;Or<Ie.length;Or++)Sr(Ie[Or],Pr,Wr);st("y"),lt[3]*=Wr,lt[1]+=lt[3]*(1-Pr)*(1/Wr-1)}Ct(lt),ct(),se.emit("plotly_relayouting",Ue),Tt=setTimeout(function(){!se._fullLayout||(lt=[0,0,ht,Rt],dt())},Bt),br.preventDefault()}ye.length*ge.length!==1&&Q(wt,Me);function nt(br,Ar){if(br=br*Ze,Ar=Ar*Qe,se._transitioningWithDuration)return;if(se._fullLayout._replotting=!0,Mt==="ew"||Yt==="ns"){var Wr=Mt?-br:0,nr=Yt?-Ar:0;if(It.isSubplotConstrained){if(Mt&&Yt){var yr=(br/ht-Ar/Rt)/2;br=yr*ht,Ar=-yr*Rt,Wr=-br,nr=-Ar}Yt?Wr=-nr*ht/Rt:nr=-Wr*Rt/ht}Mt&&(G(He,br),st("x")),Yt&&(G(Ie,Ar),st("y")),Ct([Wr,nr,ht,Rt]),ct(),se.emit("plotly_relayouting",Ue);return}function Pr(Br,Er,_r){for(var Gr=1-Er,wn,cn,Bn=0;Bn<Br.length;Bn++){var En=Br[Bn];if(!En.fixedrange){wn=En,cn=En._rl[Gr]+(En._rl[Er]-En._rl[Gr])/K(_r/En._length);var Yn=En.l2r(cn);Yn!==!1&&Yn!==void 0&&(En.range[Er]=Yn)}}return wn._length*(wn._rl[Er]-cn)/(wn._rl[Er]-wn._rl[Gr])}var Or=Mt==="w"==(Yt==="n")?1:-1;if(Mt&&Yt&&(Kt.isSubplotConstrained||It.isSubplotConstrained)){var Sr=(br/ht+Or*Ar/Rt)/2;br=Sr*ht,Ar=Or*Sr*Rt}var tt,Lt;if(Mt==="w"?br=Pr(He,0,br):Mt==="e"?br=Pr(He,1,-br):Mt||(br=0),Yt==="n"?Ar=Pr(Ie,1,Ar):Yt==="s"?Ar=Pr(Ie,0,-Ar):Yt||(Ar=0),tt=Mt==="w"?br:0,Lt=Yt==="n"?Ar:0,Kt.isSubplotConstrained&&!It.isSubplotConstrained||It.isSubplotConstrained&&Mt&&Yt&&Or>0){var Wt;if(It.isSubplotConstrained||!Mt&&Yt.length===1){for(Wt=0;Wt<He.length;Wt++)He[Wt].range=He[Wt]._r.slice(),L(He[Wt],1-Ar/Rt);br=Ar*ht/Rt,tt=br/2}if(It.isSubplotConstrained||!Yt&&Mt.length===1){for(Wt=0;Wt<Ie.length;Wt++)Ie[Wt].range=Ie[Wt]._r.slice(),L(Ie[Wt],1-br/ht);Ar=br*Rt/ht,Lt=Ar/2}}(!It.isSubplotConstrained||!Yt)&&st("x"),(!It.isSubplotConstrained||!Mt)&&st("y");var ir=ht-br,Ir=Rt-Ar;It.isSubplotConstrained&&!(Mt&&Yt)&&(Mt?(Lt=tt?0:br*Rt/ht,Ir=ir*Rt/ht):(tt=Lt?0:Ar*ht/Rt,ir=Ir*ht/Rt)),Ct([tt,Lt,ir,Ir]),ct(),se.emit("plotly_relayouting",Ue)}function st(br,Ar){for(var Wr=It.isSubplotConstrained?{x:Ie,y:He}[br]:It[br+"axes"],nr=It.isSubplotConstrained?{x:He,y:Ie}[br]:[],yr=0;yr<Wr.length;yr++){var Pr=Wr[yr],Or=Pr._id,Sr=It.xLinks[Or]||It.yLinks[Or],tt=nr[0]||ke[Sr]||Xe[Sr];tt&&(Ar?(Ar[Pr._name+".range[0]"]=Ar[tt._name+".range[0]"],Ar[Pr._name+".range[1]"]=Ar[tt._name+".range[1]"]):Pr.range=tt.range.slice())}}function ct(){var br=[],Ar;function Wr(Pr){for(Ar=0;Ar<Pr.length;Ar++)Pr[Ar].fixedrange||br.push(Pr[Ar]._id)}for(St&&(Wr(He),Wr(Kt.xaxes),Wr(It.xaxes)),Ye&&(Wr(Ie),Wr(Kt.yaxes),Wr(It.yaxes)),Ue={},Ar=0;Ar<br.length;Ar++){var nr=br[Ar],yr=_(se,nr);i.drawOne(se,yr,{skipTitle:!0}),Ue[yr._name+".range[0]"]=yr.range[0],Ue[yr._name+".range[1]"]=yr.range[1]}i.redrawComponents(se,br)}function At(){if(!se._transitioningWithDuration){var br=se._context.doubleClick,Ar=[];Mt&&(Ar=Ar.concat(He)),Yt&&(Ar=Ar.concat(Ie)),It.xaxes&&(Ar=Ar.concat(It.xaxes)),It.yaxes&&(Ar=Ar.concat(It.yaxes));var Wr={},nr,yr,Pr;if(br==="reset+autosize"){for(br="autosize",yr=0;yr<Ar.length;yr++)if(nr=Ar[yr],nr._rangeInitial&&(nr.range[0]!==nr._rangeInitial[0]||nr.range[1]!==nr._rangeInitial[1])||!nr._rangeInitial&&!nr.autorange){br="reset";break}}if(br==="autosize")for(yr=0;yr<Ar.length;yr++)nr=Ar[yr],nr.fixedrange||(Wr[nr._name+".autorange"]=!0);else if(br==="reset")for((Mt||Kt.isSubplotConstrained)&&(Ar=Ar.concat(Kt.xaxes)),Yt&&!Kt.isSubplotConstrained&&(Ar=Ar.concat(Kt.yaxes)),Kt.isSubplotConstrained&&(Mt?Yt||(Ar=Ar.concat(Ie)):Ar=Ar.concat(He)),yr=0;yr<Ar.length;yr++)nr=Ar[yr],nr.fixedrange||(nr._rangeInitial?(Pr=nr._rangeInitial,Wr[nr._name+".range[0]"]=Pr[0],Wr[nr._name+".range[1]"]=Pr[1]):Wr[nr._name+".autorange"]=!0);se.emit("plotly_doubleclick",null),a.call("_guiRelayout",se,Wr)}}function dt(){Ct([0,0,ht,Rt]),g.syncOrAsync([w.previousPromises,function(){se._fullLayout._replotting=!1,a.call("_guiRelayout",se,Ue)}],se)}function Ct(br){var Ar=se._fullLayout,Wr=Ar._plots,nr=Ar._subplots.cartesian,yr,Pr,Or,Sr;if(Ve&&a.subplotsRegistry.splom.drag(se),rt){for(yr=0;yr<nr.length;yr++)if(Pr=Wr[nr[yr]],Or=Pr.xaxis,Sr=Pr.yaxis,Pr._scene){var tt=g.simpleMap(Or.range,Or.r2l),Lt=g.simpleMap(Sr.range,Sr.r2l);Pr._scene.update({range:[tt[0],Lt[0],tt[1],Lt[1]]})}}if((Ve||rt)&&(m(se),l(se)),Ae){var Wt=br[2]/Ne._length,ir=br[3]/we._length;for(yr=0;yr<nr.length;yr++){Pr=Wr[nr[yr]],Or=Pr.xaxis,Sr=Pr.yaxis;var Ir=(St||It.isSubplotConstrained)&&!Or.fixedrange&&ke[Or._id],Br=(Ye||It.isSubplotConstrained)&&!Sr.fixedrange&&Xe[Sr._id],Er,_r,Gr,wn;if(Ir?(Er=Wt,Gr=ge||It.isSubplotConstrained?br[0]:kr(Or,Er)):It.xaHash[Or._id]?(Er=Wt,Gr=br[0]*Or._length/Ne._length):It.yaHash[Or._id]?(Er=ir,Gr=Yt==="ns"?-br[1]*Or._length/we._length:kr(Or,Er,{n:"top",s:"bottom"}[Yt])):(Er=Gt(Or,Wt,ir),Gr=rr(Or,Er)),Br?(_r=ir,wn=ye||It.isSubplotConstrained?br[1]:kr(Sr,_r)):It.yaHash[Sr._id]?(_r=ir,wn=br[1]*Sr._length/we._length):It.xaHash[Sr._id]?(_r=Wt,wn=Mt==="ew"?-br[0]*Sr._length/Ne._length:kr(Sr,_r,{e:"right",w:"left"}[Mt])):(_r=Gt(Sr,Wt,ir),wn=rr(Sr,_r)),!(!Er&&!_r)){Er||(Er=1),_r||(_r=1);var cn=Or._offset-Gr/Er,Bn=Sr._offset-wn/_r;Pr.clipRect.call(c.setTranslate,Gr,wn).call(c.setScale,Er,_r),Pr.plot.call(c.setTranslate,cn,Bn).call(c.setScale,1/Er,1/_r),(Er!==Pr.xScaleFactor||_r!==Pr.yScaleFactor)&&(c.setPointGroupScale(Pr.zoomScalePts,Er,_r),c.setTextPointsScale(Pr.zoomScaleTxt,Er,_r)),c.hideOutsideRangePoints(Pr.clipOnAxisFalseTraces,Pr),Pr.xScaleFactor=Er,Pr.yScaleFactor=_r}}}}function Gt(br,Ar,Wr){return br.fixedrange?0:St&&Kt.xaHash[br._id]?Ar:Ye&&(Kt.isSubplotConstrained?Kt.xaHash:Kt.yaHash)[br._id]?Wr:0}function rr(br,Ar){return Ar?(br.range=br._r.slice(),L(br,Ar),kr(br,Ar)):0}function kr(br,Ar,Wr){return br._length*(1-Ar)*o[Wr||br.constraintoward||"middle"]}return wt}function D(se,ae,oe,be){var ce=g.ensureSingle(se.draglayer,ae,oe,function(de){de.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",se.id)});return ce.call(x,be),ce.node()}function R(se,ae,oe,be,ce,de,ye){var ge=D(se,"rect",ae,oe);return A.select(ge).call(c.setRect,be,ce,de,ye),ge}function O(se,ae){for(var oe=0;oe<se.length;oe++)if(!se[oe].fixedrange)return ae;return""}function F(se,ae){var oe=se.range[ae],be=Math.abs(oe-se.range[1-ae]),ce;return se.type==="date"?oe:se.type==="log"?(ce=Math.ceil(Math.max(0,-Math.log(be)/Math.LN10))+3,S("."+ce+"g")(Math.pow(10,oe))):(ce=Math.floor(Math.log(Math.abs(oe))/Math.LN10)-Math.floor(Math.log(be)/Math.LN10)+4,S("."+String(ce)+"g")(oe))}function N(se,ae,oe,be,ce){for(var de=0;de<se.length;de++){var ye=se[de];if(!ye.fixedrange)if(ye.rangebreaks){var ge=ye._id.charAt(0)==="y",me=ge?1-ae:ae,Ee=ge?1-oe:oe;be[ye._name+".range[0]"]=ye.l2r(ye.p2l(me*ye._length)),be[ye._name+".range[1]"]=ye.l2r(ye.p2l(Ee*ye._length))}else{var Pe=ye._rl[0],Ne=ye._rl[1]-Pe;be[ye._name+".range[0]"]=ye.l2r(Pe+Ne*ae),be[ye._name+".range[1]"]=ye.l2r(Pe+Ne*oe)}}if(ce&&ce.length){var we=(ae+(1-oe))/2;N(ce,we,1-we,be,[])}}function G(se,ae){for(var oe=0;oe<se.length;oe++){var be=se[oe];if(!be.fixedrange)if(be.rangebreaks){var ce=0,de=be._length,ye=be.p2l(ce+ae)-be.p2l(ce),ge=be.p2l(de+ae)-be.p2l(de),me=(ye+ge)/2;be.range=[be.l2r(be._rl[0]-me),be.l2r(be._rl[1]-me)]}else be.range=[be.l2r(be._rl[0]-ae/be._m),be.l2r(be._rl[1]-ae/be._m)]}}function K(se){return 1-(se>=0?Math.min(se,.9):1/(1/Math.max(se,-.3)+3.222))}function W(se,ae,oe){return se?se==="nsew"?oe?"":ae==="pan"?"move":"crosshair":se.toLowerCase()+"-resize":"pointer"}function Y(se,ae,oe,be,ce){return se.append("path").attr("class","zoombox").style({fill:ae>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",n(oe,be)).attr("d",ce+"Z")}function re(se,ae,oe){return se.append("path").attr("class","zoombox-corners").style({fill:t.background,stroke:t.defaultLine,"stroke-width":1,opacity:0}).attr("transform",n(ae,oe)).attr("d","M0,0Z")}function ue(se,ae,oe,be,ce,de){se.attr("d",be+"M"+oe.l+","+oe.t+"v"+oe.h+"h"+oe.w+"v-"+oe.h+"h-"+oe.w+"Z"),j(se,ae,ce,de)}function j(se,ae,oe,be){oe||(se.transition().style("fill",be>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ae.transition().style("opacity",1).duration(200))}function q(se){A.select(se).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function V(se){z&&se.data&&se._context.showTips&&(g.notifier(g._(se,"Double-click to zoom back out"),"long"),z=!1)}function U(se,ae){return"M"+(se.l-.5)+","+(ae-P-.5)+"h-3v"+(2*P+1)+"h3ZM"+(se.r+.5)+","+(ae-P-.5)+"h3v"+(2*P+1)+"h-3Z"}function $(se,ae){return"M"+(ae-P-.5)+","+(se.t-.5)+"v-3h"+(2*P+1)+"v3ZM"+(ae-P-.5)+","+(se.b+.5)+"v3h"+(2*P+1)+"v-3Z"}function ne(se){var ae=Math.floor(Math.min(se.b-se.t,se.r-se.l,P)/2);return"M"+(se.l-3.5)+","+(se.t-.5+ae)+"h3v"+-ae+"h"+ae+"v-3h-"+(ae+3)+"ZM"+(se.r+3.5)+","+(se.t-.5+ae)+"h-3v"+-ae+"h"+-ae+"v-3h"+(ae+3)+"ZM"+(se.r+3.5)+","+(se.b+.5-ae)+"h-3v"+ae+"h"+-ae+"v3h"+(ae+3)+"ZM"+(se.l-3.5)+","+(se.b+.5-ae)+"h3v"+ae+"h"+ae+"v3h-"+(ae+3)+"Z"}function X(se,ae,oe,be,ce){for(var de=!1,ye={},ge={},me,Ee,Pe,Ne,we=(ce||{}).xaHash,ke=(ce||{}).yaHash,Xe=0;Xe<ae.length;Xe++){var He=ae[Xe];for(me in oe)if(He[me]){for(Pe in He)!(ce&&(we[Pe]||ke[Pe]))&&!(Pe.charAt(0)==="x"?oe:be)[Pe]&&(ye[Pe]=me);for(Ee in be)!(ce&&(we[Ee]||ke[Ee]))&&He[Ee]&&(de=!0)}for(Ee in be)if(He[Ee])for(Ne in He)!(ce&&(we[Ne]||ke[Ne]))&&!(Ne.charAt(0)==="x"?oe:be)[Ne]&&(ge[Ne]=Ee)}de&&(g.extendFlat(ye,ge),ge={});var Ie={},De=[];for(Pe in ye){var Ge=_(se,Pe);De.push(Ge),Ie[Ge._id]=Ge}var ht={},Rt=[];for(Ne in ge){var Kt=_(se,Ne);Rt.push(Kt),ht[Kt._id]=Kt}return{xaHash:Ie,yaHash:ht,xaxes:De,yaxes:Rt,xLinks:ye,yLinks:ge,isSubplotConstrained:de}}function Q(se,ae){if(!e)se.onwheel!==void 0?se.onwheel=ae:se.onmousewheel!==void 0?se.onmousewheel=ae:se.isAddedWheelEvent||(se.isAddedWheelEvent=!0,se.addEventListener("wheel",ae,{passive:!1}));else{var oe=se.onwheel!==void 0?"wheel":"mousewheel";se._onwheel&&se.removeEventListener(oe,se._onwheel),se._onwheel=ae,se.addEventListener(oe,ae,{passive:!1})}}function ie(se){var ae=[];for(var oe in se)ae.push(se[oe]);return ae}ee.exports={makeDragBox:I,makeDragger:D,makeRectDragger:R,makeZoombox:Y,makeCorners:re,updateZoombox:ue,xyCorners:ne,transitionZoombox:j,removeZoombox:q,showDoubleClickNotifier:V,attachWheelEventHandler:Q}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/subroutines":556,"../../registry":647,"../plots":628,"./axes":566,"./axis_ids":570,"./constants":573,"./scale_zoom":584,"@plotly/d3":58,"has-passive-events":229,tinycolor2:313}],576:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/fx"),S=d("../../components/dragelement"),M=d("../../lib/setcursor"),e=d("./dragbox").makeDragBox,a=d("./constants").DRAGGERSIZE;te.initInteractions=function(r){var t=r._fullLayout;if(r._context.staticPlot){A.select(r).selectAll(".drag").remove();return}if(!(!t._has("cartesian")&&!t._has("splom"))){var c=Object.keys(t._plots||{}).sort(function(i,x){if((t._plots[i].mainplot&&!0)===(t._plots[x].mainplot&&!0)){var p=i.split("y"),v=x.split("y");return p[0]===v[0]?Number(p[1]||1)-Number(v[1]||1):Number(p[0]||1)-Number(v[0]||1)}return t._plots[i].mainplot?1:-1});c.forEach(function(i){var x=t._plots[i],p=x.xaxis,v=x.yaxis;if(!x.mainplot){var f=e(r,x,p._offset,v._offset,p._length,v._length,"ns","ew");f.onmousemove=function(m){r._fullLayout._rehover=function(){r._fullLayout._hoversubplot===i&&r._fullLayout._plots[i]&&g.hover(r,m,i)},g.hover(r,m,i),r._fullLayout._lasthover=f,r._fullLayout._hoversubplot=i},f.onmouseout=function(m){r._dragging||(r._fullLayout._hoversubplot=null,S.unhover(r,m))},r._context.showAxisDragHandles&&(e(r,x,p._offset-a,v._offset-a,a,a,"n","w"),e(r,x,p._offset+p._length,v._offset-a,a,a,"n","e"),e(r,x,p._offset-a,v._offset+v._length,a,a,"s","w"),e(r,x,p._offset+p._length,v._offset+v._length,a,a,"s","e"))}if(r._context.showAxisDragHandles){if(i===p._mainSubplot){var y=p._mainLinePosition;p.side==="top"&&(y-=a),e(r,x,p._offset+p._length*.1,y,p._length*.8,a,"","ew"),e(r,x,p._offset,y,p._length*.1,a,"","w"),e(r,x,p._offset+p._length*.9,y,p._length*.1,a,"","e")}if(i===v._mainSubplot){var o=v._mainLinePosition;v.side!=="right"&&(o-=a),e(r,x,o,v._offset+v._length*.1,a,v._length*.8,"ns",""),e(r,x,o,v._offset+v._length*.9,a,v._length*.1,"s",""),e(r,x,o,v._offset,a,v._length*.1,"n","")}}});var s=t._hoverlayer.node();s.onmousemove=function(i){i.target=r._fullLayout._lasthover,g.hover(r,i,t._hoversubplot)},s.onclick=function(i){i.target=r._fullLayout._lasthover,g.click(r,i)},s.onmousedown=function(i){r._fullLayout._lasthover.onmousedown(i)},te.updateFx(r)}},te.updateFx=function(n){var r=n._fullLayout,t=r.dragmode==="pan"?"move":"crosshair";M(r._draggers,t)}},{"../../components/dragelement":386,"../../components/fx":407,"../../lib/setcursor":536,"./constants":573,"./dragbox":575,"@plotly/d3":58}],577:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib"),S=d("./axis_ids");ee.exports=function(e){return function(n,r){var t=n[e];if(!!Array.isArray(t))for(var c=A.subplotsRegistry.cartesian,s=c.idRegex,i=r._subplots,x=i.xaxis,p=i.yaxis,v=i.cartesian,f=r._has("cartesian")||r._has("gl2d"),y=0;y<t.length;y++){var o=t[y];if(!!g.isPlainObject(o)){var m=S.cleanId(o.xref,"x",!1),l=S.cleanId(o.yref,"y",!1),w=s.x.test(m),_=s.y.test(l);if(w||_){f||g.pushUnique(r._basePlotModules,c);var h=!1;w&&x.indexOf(m)===-1&&(x.push(m),h=!0),_&&p.indexOf(l)===-1&&(p.push(l),h=!0),h&&w&&_&&v.push(m+l)}}}}}},{"../../lib":515,"../../registry":647,"./axis_ids":570}],578:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../registry"),S=d("../../lib"),M=d("../plots"),e=d("../../components/drawing"),a=d("../get_data").getModuleCalcData,n=d("./axis_ids"),r=d("./constants"),t=d("../../constants/xmlns_namespaces"),c=S.ensureSingle;function s(y,o,m){return S.ensureSingle(y,o,m,function(l){l.datum(m)})}te.name="cartesian",te.attr=["xaxis","yaxis"],te.idRoot=["x","y"],te.idRegex=r.idRegex,te.attrRegex=r.attrRegex,te.attributes=d("./attributes"),te.layoutAttributes=d("./layout_attributes"),te.supplyLayoutDefaults=d("./layout_defaults"),te.transitionAxes=d("./transition_axes"),te.finalizeSubplots=function(y,o){var m=o._subplots,l=m.xaxis,w=m.yaxis,_=m.cartesian,h=_.concat(m.gl2d||[]),b={},u={},L,T,k;for(L=0;L<h.length;L++){var P=h[L].split("y");b[P[0]]=1,u["y"+P[1]]=1}for(L=0;L<l.length;L++)T=l[L],b[T]||(k=(y[n.id2name(T)]||{}).anchor,r.idRegex.y.test(k)||(k="y"),_.push(T+k),h.push(T+k),u[k]||(u[k]=1,S.pushUnique(w,k)));for(L=0;L<w.length;L++)k=w[L],u[k]||(T=(y[n.id2name(k)]||{}).anchor,r.idRegex.x.test(T)||(T="x"),_.push(T+k),h.push(T+k),b[T]||(b[T]=1,S.pushUnique(l,T)));if(!h.length){T="",k="";for(var z in y)if(r.attrRegex.test(z)){var I=z.charAt(0);I==="x"?(!T||+z.substr(5)<+T.substr(5))&&(T=z):(!k||+z.substr(5)<+k.substr(5))&&(k=z)}T=T?n.name2id(T):"x",k=k?n.name2id(k):"y",l.push(T),w.push(k),_.push(T+k)}},te.plot=function(y,o,m,l){var w=y._fullLayout,_=w._subplots.cartesian,h=y.calcdata,b;if(!Array.isArray(o))for(o=[],b=0;b<h.length;b++)o.push(b);for(b=0;b<_.length;b++){for(var u=_[b],L=w._plots[u],T=[],k,P=0;P<h.length;P++){var z=h[P],I=z[0].trace;I.xaxis+I.yaxis===u&&((o.indexOf(I.index)!==-1||I.carpet)&&(k&&k[0].trace.xaxis+k[0].trace.yaxis===u&&["tonextx","tonexty","tonext"].indexOf(I.fill)!==-1&&T.indexOf(k)===-1&&T.push(k),T.push(z)),k=z)}i(y,L,T,m,l)}};function i(y,o,m,l,w){for(var _=r.traceLayerClasses,h=y._fullLayout,b=h._modules,u,L,T,k=[],P=[],z=0;z<b.length;z++){u=b[z];var I=u.name,D=g.modules[I].categories;if(D.svg){var R=u.layerName||I+"layer",O=u.plot;L=a(m,O),T=L[0],m=L[1],T.length&&k.push({i:_.indexOf(R),className:R,plotMethod:O,cdModule:T}),D.zoomScale&&P.push("."+R)}}k.sort(function(G,K){return G.i-K.i});var F=o.plot.selectAll("g.mlayer").data(k,function(G){return G.className});if(F.enter().append("g").attr("class",function(G){return G.className}).classed("mlayer",!0).classed("rangeplot",o.isRangePlot),F.exit().remove(),F.order(),F.each(function(G){var K=A.select(this),W=G.className;G.plotMethod(y,o,G.cdModule,K,l,w),r.clipOnAxisFalseQuery.indexOf("."+W)===-1&&e.setClipUrl(K,o.layerClipId,y)}),h._has("scattergl")&&(u=g.getModule("scattergl"),T=a(m,u)[0],u.plot(y,o,T)),!y._context.staticPlot&&(o._hasClipOnAxisFalse&&(o.clipOnAxisFalseTraces=o.plot.selectAll(r.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),P.length)){var N=o.plot.selectAll(P.join(",")).selectAll(".trace");o.zoomScalePts=N.selectAll("path.point"),o.zoomScaleTxt=N.selectAll(".textpoint")}}te.clean=function(y,o,m,l){var w=l._plots||{},_=o._plots||{},h=l._subplots||{},b,u,L;if(l._hasOnlyLargeSploms&&!o._hasOnlyLargeSploms)for(L in w)b=w[L],b.plotgroup&&b.plotgroup.remove();var T=l._has&&l._has("gl"),k=o._has&&o._has("gl");if(T&&!k)for(L in w)b=w[L],b._scene&&b._scene.destroy();if(h.xaxis&&h.yaxis){var P=n.listIds({_fullLayout:l});for(u=0;u<P.length;u++){var z=P[u];o[n.id2name(z)]||l._infolayer.selectAll(".g-"+z+"title").remove()}}var I=l._has&&l._has("cartesian"),D=o._has&&o._has("cartesian");if(I&&!D)v(l._cartesianlayer.selectAll(".subplot"),l),l._defs.selectAll(".axesclip").remove(),delete l._axisConstraintGroups,delete l._axisMatchGroups;else if(h.cartesian)for(u=0;u<h.cartesian.length;u++){var R=h.cartesian[u];if(!_[R]){var O="."+R+",."+R+"-x,."+R+"-y";l._cartesianlayer.selectAll(O).remove(),f(R,l)}}},te.drawFramework=function(y){var o=y._fullLayout,m=x(y),l=o._cartesianlayer.selectAll(".subplot").data(m,String);l.enter().append("g").attr("class",function(w){return"subplot "+w[0]}),l.order(),l.exit().call(v,o),l.each(function(w){var _=w[0],h=o._plots[_];h.plotgroup=A.select(this),p(y,h),h.draglayer=c(o._draggers,"g",_)})},te.rangePlot=function(y,o,m){p(y,o),i(y,o,m),M.style(y)};function x(y){var o=y._fullLayout,m=o._subplots.cartesian,l=m.length,w,_,h,b,u,L,T=[],k=[];for(w=0;w<l;w++){h=m[w],b=o._plots[h],u=b.xaxis,L=b.yaxis;var P=u._mainAxis,z=L._mainAxis,I=P._id+z._id,D=o._plots[I];b.overlays=[],I!==h&&D?(b.mainplot=I,b.mainplotinfo=D,k.push(h)):(b.mainplot=void 0,b.mainplotinfo=void 0,T.push(h))}for(w=0;w<k.length;w++)h=k[w],b=o._plots[h],b.mainplotinfo.overlays.push(b);var R=T.concat(k),O=new Array(l);for(w=0;w<l;w++){h=R[w],b=o._plots[h],u=b.xaxis,L=b.yaxis;var F=[h,u.layer,L.layer,u.overlaying||"",L.overlaying||""];for(_=0;_<b.overlays.length;_++)F.push(b.overlays[_].id);O[w]=F}return O}function p(y,o){var m=o.plotgroup,l=o.id,w=r.layerValue2layerClass[o.xaxis.layer],_=r.layerValue2layerClass[o.yaxis.layer],h=y._fullLayout._hasOnlyLargeSploms;if(o.mainplot){var u=o.mainplotinfo,L=u.plotgroup,T=l+"-x",k=l+"-y";o.minorGridlayer=u.minorGridlayer,o.gridlayer=u.gridlayer,o.zerolinelayer=u.zerolinelayer,c(u.overlinesBelow,"path",T),c(u.overlinesBelow,"path",k),c(u.overaxesBelow,"g",T),c(u.overaxesBelow,"g",k),o.plot=c(u.overplot,"g",l),c(u.overlinesAbove,"path",T),c(u.overlinesAbove,"path",k),c(u.overaxesAbove,"g",T),c(u.overaxesAbove,"g",k),o.xlines=L.select(".overlines-"+w).select("."+T),o.ylines=L.select(".overlines-"+_).select("."+k),o.xaxislayer=L.select(".overaxes-"+w).select("."+T),o.yaxislayer=L.select(".overaxes-"+_).select("."+k)}else if(h)o.xlines=c(m,"path","xlines-above"),o.ylines=c(m,"path","ylines-above"),o.xaxislayer=c(m,"g","xaxislayer-above"),o.yaxislayer=c(m,"g","yaxislayer-above");else{var b=c(m,"g","layer-subplot");o.shapelayer=c(b,"g","shapelayer"),o.imagelayer=c(b,"g","imagelayer"),o.minorGridlayer=c(m,"g","minor-gridlayer"),o.gridlayer=c(m,"g","gridlayer"),o.zerolinelayer=c(m,"g","zerolinelayer"),c(m,"path","xlines-below"),c(m,"path","ylines-below"),o.overlinesBelow=c(m,"g","overlines-below"),c(m,"g","xaxislayer-below"),c(m,"g","yaxislayer-below"),o.overaxesBelow=c(m,"g","overaxes-below"),o.plot=c(m,"g","plot"),o.overplot=c(m,"g","overplot"),o.xlines=c(m,"path","xlines-above"),o.ylines=c(m,"path","ylines-above"),o.overlinesAbove=c(m,"g","overlines-above"),c(m,"g","xaxislayer-above"),c(m,"g","yaxislayer-above"),o.overaxesAbove=c(m,"g","overaxes-above"),o.xlines=m.select(".xlines-"+w),o.ylines=m.select(".ylines-"+_),o.xaxislayer=m.select(".xaxislayer-"+w),o.yaxislayer=m.select(".yaxislayer-"+_)}h||(s(o.minorGridlayer,"g",o.xaxis._id),s(o.minorGridlayer,"g",o.yaxis._id),o.minorGridlayer.selectAll("g").map(function(P){return P[0]}).sort(n.idSort),s(o.gridlayer,"g",o.xaxis._id),s(o.gridlayer,"g",o.yaxis._id),o.gridlayer.selectAll("g").map(function(P){return P[0]}).sort(n.idSort)),o.xlines.style("fill","none").classed("crisp",!0),o.ylines.style("fill","none").classed("crisp",!0)}function v(y,o){if(!!y){var m={};y.each(function(u){var L=u[0],T=A.select(this);T.remove(),f(L,o),m[L]=!0});for(var l in o._plots)for(var w=o._plots[l],_=w.overlays||[],h=0;h<_.length;h++){var b=_[h];m[b.id]&&b.plot.selectAll(".trace").remove()}}}function f(y,o){o._draggers.selectAll("g."+y).remove(),o._defs.select("#clip"+o._uid+y+"plot").remove()}te.toSVG=function(y){var o=y._fullLayout._glimages,m=A.select(y).selectAll(".svg-container"),l=m.filter(function(_,h){return h===m.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function w(){var _=this,h=_.toDataURL("image/png"),b=o.append("svg:image");b.attr({xmlns:t.svg,"xlink:href":h,preserveAspectRatio:"none",x:0,y:0,width:_.style.width,height:_.style.height})}l.each(w)},te.updateFx=d("./graph_interact").updateFx},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../registry":647,"../get_data":602,"../plots":628,"./attributes":564,"./axis_ids":570,"./constants":573,"./graph_interact":576,"./layout_attributes":579,"./layout_defaults":580,"./transition_axes":590,"@plotly/d3":58}],579:[function(d,ee,te){var A=d("../font_attributes"),g=d("../../components/color/attributes"),S=d("../../components/drawing/attributes").dash,M=d("../../lib/extend").extendFlat,e=d("../../plot_api/plot_template").templatedArray,a=d("../../plots/cartesian/axis_format_attributes").descriptionWithDates,n=d("../../constants/numerical").ONEDAY,r=d("./constants"),t=r.HOUR_PATTERN,c=r.WEEKDAY_PATTERN,s={valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}};function i(b){return{valType:"integer",min:0,dflt:b?5:0,editType:"ticks"}}var x={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},p={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},v={valType:"data_array",editType:"ticks"},f={valType:"enumerated",values:["outside","inside",""],editType:"ticks"};function y(b){var u={valType:"number",min:0,editType:"ticks"};return b||(u.dflt=5),u}function o(b){var u={valType:"number",min:0,editType:"ticks"};return b||(u.dflt=1),u}var m={valType:"color",dflt:g.defaultLine,editType:"ticks"},l={valType:"color",dflt:g.lightLine,editType:"ticks"};function w(b){var u={valType:"number",min:0,editType:"ticks"};return b||(u.dflt=1),u}var _=M({},S,{editType:"ticks"}),h={valType:"boolean",editType:"ticks"};ee.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:g.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:A({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[c,t,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:n},editType:"calc"}),tickmode:s,nticks:i(),tick0:x,dtick:p,ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:v,ticktext:{valType:"data_array",editType:"ticks"},ticks:f,tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:y(),tickwidth:o(),tickcolor:m,showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"flaglist",flags:["height","width","left","right","top","bottom"],extras:[!0,!1],dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:M({},S,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:A({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:a("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:a("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:g.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:h,gridcolor:l,gridwidth:w(),griddash:_,zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:g.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:g.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},minor:{tickmode:s,nticks:i("minor"),tick0:x,dtick:p,tickvals:v,ticks:f,ticklen:y("minor"),tickwidth:o("minor"),tickcolor:m,gridcolor:l,gridwidth:w("minor"),griddash:_,showgrid:h,editType:"ticks"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:A({editType:"ticks"})}}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../constants/numerical":491,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../font_attributes":594,"./constants":573}],580:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/color"),S=d("../../components/fx/helpers").isUnifiedHover,M=d("../../components/fx/hovermode_defaults"),e=d("../../plot_api/plot_template"),a=d("../layout_attributes"),n=d("./layout_attributes"),r=d("./type_defaults"),t=d("./axis_defaults"),c=d("./constraints"),s=d("./position_defaults"),i=d("./axis_ids"),x=i.id2name,p=i.name2id,v=d("./constants").AX_ID_PATTERN,f=d("../../registry"),y=f.traceIs,o=f.getComponentMethod;function m(l,w,_){Array.isArray(l[w])?l[w].push(_):l[w]=[_]}ee.exports=function(w,_,h){var b=_.autotypenumbers,u={},L={},T={},k={},P={},z={},I={},D={},R={},O={},F,N;for(F=0;F<h.length;F++){var G=h[F];if(!(!y(G,"cartesian")&&!y(G,"gl2d"))){var K;if(G.xaxis)K=x(G.xaxis),m(u,K,G);else if(G.xaxes)for(N=0;N<G.xaxes.length;N++)m(u,x(G.xaxes[N]),G);var W;if(G.yaxis)W=x(G.yaxis),m(u,W,G);else if(G.yaxes)for(N=0;N<G.yaxes.length;N++)m(u,x(G.yaxes[N]),G);if(G.type==="funnel"?G.orientation==="h"?(K&&(L[K]=!0),W&&(I[W]=!0)):W&&(T[W]=!0):G.type==="image"?(W&&(D[W]=!0),K&&(D[K]=!0)):(W&&(P[W]=!0,z[W]=!0),(!y(G,"carpet")||G.type==="carpet"&&!G._cheater)&&K&&(k[K]=!0)),G.type==="carpet"&&G._cheater&&K&&(L[K]=!0),y(G,"2dMap")&&(R[K]=!0,R[W]=!0),y(G,"oriented")){var Y=G.orientation==="h"?W:K;O[Y]=!0}}}var re=_._subplots,ue=re.xaxis,j=re.yaxis,q=A.simpleMap(ue,x),V=A.simpleMap(j,x),U=q.concat(V),$=g.background;ue.length&&j.length&&($=A.coerce(w,_,a,"plot_bgcolor"));var ne=g.combine($,_.paper_bgcolor),X,Q,ie,se,ae;function oe(){var Ve=u[X]||[];ae._traceIndices=Ve.map(function(Ae){return Ae._expandedIndex}),ae._annIndices=[],ae._shapeIndices=[],ae._selectionIndices=[],ae._imgIndices=[],ae._subplotsWith=[],ae._counterAxes=[],ae._name=ae._attr=X,ae._id=Q}function be(Ve,Ae){return A.coerce(se,ae,n,Ve,Ae)}function ce(Ve,Ae){return A.coerce2(se,ae,n,Ve,Ae)}function de(Ve){return Ve==="x"?j:ue}function ye(Ve,Ae){for(var Ue=Ve==="x"?q:V,Ze=[],Qe=0;Qe<Ue.length;Qe++){var _t=Ue[Qe];_t!==Ae&&!(w[_t]||{}).overlaying&&Ze.push(p(_t))}return Ze}var ge={x:de("x"),y:de("y")},me=ge.x.concat(ge.y),Ee={},Pe=[];function Ne(){var Ve=se.matches;v.test(Ve)&&me.indexOf(Ve)===-1&&(Ee[Ve]=se.type,Pe=Object.keys(Ee))}var we=M(w,_),ke=S(we);for(F=0;F<U.length;F++){X=U[F],Q=p(X),ie=X.charAt(0),A.isPlainObject(w[X])||(w[X]={}),se=w[X],ae=e.newContainer(_,X,ie+"axis"),oe();var Xe=ie==="x"&&!k[X]&&L[X]||ie==="y"&&!P[X]&&T[X],He=ie==="y"&&(!z[X]&&I[X]||D[X]),Ie={hasMinor:!0,letter:ie,font:_.font,outerTicks:R[X],showGrid:!O[X],data:u[X]||[],bgColor:ne,calendar:_.calendar,automargin:!0,visibleDflt:Xe,reverseDflt:He,autotypenumbersDflt:b,splomStash:((_._splomAxes||{})[ie]||{})[Q]};be("uirevision",_.uirevision),r(se,ae,be,Ie),t(se,ae,be,Ie,_);var De=ke&&ie===we.charAt(0),Ge=ce("spikecolor",ke?ae.color:void 0),ht=ce("spikethickness",ke?1.5:void 0),Rt=ce("spikedash",ke?"dot":void 0),Kt=ce("spikemode",ke?"across":void 0),It=ce("spikesnap"),Mt=be("showspikes",!!De||!!Ge||!!ht||!!Rt||!!Kt||!!It);Mt||(delete ae.spikecolor,delete ae.spikethickness,delete ae.spikedash,delete ae.spikemode,delete ae.spikesnap),s(se,ae,be,{letter:ie,counterAxes:ge[ie],overlayableAxes:ye(ie,X),grid:_.grid}),be("title.standoff"),Ne(),ae._input=se}for(F=0;F<Pe.length;){Q=Pe[F++],X=x(Q),ie=X.charAt(0),A.isPlainObject(w[X])||(w[X]={}),se=w[X],ae=e.newContainer(_,X,ie+"axis"),oe();var Yt={letter:ie,font:_.font,outerTicks:R[X],showGrid:!O[X],data:[],bgColor:ne,calendar:_.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:b,splomStash:((_._splomAxes||{})[ie]||{})[Q]};be("uirevision",_.uirevision),ae.type=Ee[Q]||"linear",t(se,ae,be,Yt,_),s(se,ae,be,{letter:ie,counterAxes:ge[ie],overlayableAxes:ye(ie,X),grid:_.grid}),be("fixedrange"),Ne(),ae._input=se}var zt=o("rangeslider","handleDefaults"),St=o("rangeselector","handleDefaults");for(F=0;F<q.length;F++)X=q[F],se=w[X],ae=_[X],zt(w,_,X),ae.type==="date"&&St(se,ae,_,V,ae.calendar),be("fixedrange");for(F=0;F<V.length;F++){X=V[F],se=w[X],ae=_[X];var Ye=_[x(ae.anchor)],rt=o("rangeslider","isVisible")(Ye);be("fixedrange",rt)}c.handleDefaults(w,_,{axIds:me.concat(Pe).sort(i.idSort),axHasImage:D})}},{"../../components/color":367,"../../components/fx/helpers":403,"../../components/fx/hovermode_defaults":406,"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../layout_attributes":619,"./axis_defaults":568,"./axis_ids":570,"./constants":573,"./constraints":574,"./layout_attributes":579,"./position_defaults":582,"./type_defaults":591}],581:[function(d,ee,te){var A=d("tinycolor2").mix,g=d("../../components/color/attributes"),S=d("../../lib");ee.exports=function(e,a,n,r){r=r||{};var t=r.dfltColor;function c(T,k){return S.coerce2(e,a,r.attributes,T,k)}var s=c("linecolor",t),i=c("linewidth"),x=n("showline",r.showLine||!!s||!!i);x||(delete a.linecolor,delete a.linewidth);var p=A(t,r.bgColor,r.blend||g.lightFraction).toRgbString(),v=c("gridcolor",p),f=c("gridwidth"),y=c("griddash"),o=n("showgrid",r.showGrid||!!v||!!f||!!y);if(o||(delete a.gridcolor,delete a.gridwidth,delete a.griddash),r.hasMinor){var m=A(a.gridcolor,r.bgColor,67).toRgbString(),l=c("minor.gridcolor",m),w=c("minor.gridwidth",a.gridwidth||1),_=c("minor.griddash",a.griddash||"solid"),h=n("minor.showgrid",!!l||!!w||!!_);h||(delete a.minor.gridcolor,delete a.minor.gridwidth,delete a.minor.griddash)}if(!r.noZeroLine){var b=c("zerolinecolor",t),u=c("zerolinewidth"),L=n("zeroline",r.showGrid||!!b||!!u);L||(delete a.zerolinecolor,delete a.zerolinewidth)}}},{"../../components/color/attributes":366,"../../lib":515,tinycolor2:313}],582:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib");ee.exports=function(M,e,a,n){var r=n.counterAxes||[],t=n.overlayableAxes||[],c=n.letter,s=n.grid,i,x,p,v;s&&(x=s._domains[c][s._axisMap[e._id]],i=s._anchors[e._id],x&&(p=s[c+"side"].split(" ")[0],v=s.domain[c][p==="right"||p==="top"?1:0])),x=x||[0,1],i=i||(A(M.position)?"free":r[0]||"free"),p=p||(c==="x"?"bottom":"left"),v=v||0;var f=g.coerce(M,e,{anchor:{valType:"enumerated",values:["free"].concat(r),dflt:i}},"anchor");f==="free"&&a("position",v),g.coerce(M,e,{side:{valType:"enumerated",values:c==="x"?["bottom","top"]:["left","right"],dflt:p}},"side");var y=!1;if(t.length&&(y=g.coerce(M,e,{overlaying:{valType:"enumerated",values:[!1].concat(t),dflt:!1}},"overlaying")),!y){var o=a("domain",x);o[0]>o[1]-1/4096&&(e.domain=x),g.noneOrAll(M.domain,e.domain,x)}return a("layer"),e}},{"../../lib":515,"fast-isnumeric":190}],583:[function(d,ee,te){var A=d("./show_dflt");ee.exports=function(S,M,e,a,n){n||(n={});var r=n.tickSuffixDflt,t=A(S),c=e("tickprefix");c&&e("showtickprefix",t);var s=e("ticksuffix",r);s&&e("showticksuffix",t)}},{"./show_dflt":586}],584:[function(d,ee,te){var A=d("../../constants/alignment").FROM_BL;ee.exports=function(S,M,e){e===void 0&&(e=A[S.constraintoward||"center"]);var a=[S.r2l(S.range[0]),S.r2l(S.range[1])],n=a[0]+(a[1]-a[0])*e;S.range=S._input.range=[S.l2r(n+(a[0]-n)*M),S.l2r(n+(a[1]-n)*M)],S.setScale()}},{"../../constants/alignment":483}],585:[function(d,ee,te){var A=d("@plotly/d3"),g=d("d3-time-format").utcFormat,S=d("../../lib"),M=S.numberFormat,e=d("fast-isnumeric"),a=S.cleanNumber,n=S.ms2DateTime,r=S.dateTime2ms,t=S.ensureNumber,c=S.isArrayOrTypedArray,s=d("../../constants/numerical"),i=s.FP_SAFE,x=s.BADNUM,p=s.LOG_CLIP,v=s.ONEWEEK,f=s.ONEDAY,y=s.ONEHOUR,o=s.ONEMIN,m=s.ONESEC,l=d("./axis_ids"),w=d("./constants"),_=w.HOUR_PATTERN,h=w.WEEKDAY_PATTERN;function b(L){return Math.pow(10,L)}function u(L){return L!=null}ee.exports=function(T,k){k=k||{};var P=T._id||"x",z=P.charAt(0);function I(U,$){if(U>0)return Math.log(U)/Math.LN10;if(U<=0&&$&&T.range&&T.range.length===2){var ne=T.range[0],X=T.range[1];return .5*(ne+X-2*p*Math.abs(ne-X))}else return x}function D(U,$,ne,X){if((X||{}).msUTC&&e(U))return+U;var Q=r(U,ne||T.calendar);if(Q===x)if(e(U)){U=+U;var ie=Math.floor(S.mod(U+.05,1)*10),se=Math.round(U-ie/10);Q=r(new Date(se))+ie/10}else return x;return Q}function R(U,$,ne){return n(U,$,ne||T.calendar)}function O(U){return T._categories[Math.round(U)]}function F(U){if(u(U)){if(T._categoriesMap===void 0&&(T._categoriesMap={}),T._categoriesMap[U]!==void 0)return T._categoriesMap[U];T._categories.push(typeof U=="number"?String(U):U);var $=T._categories.length-1;return T._categoriesMap[U]=$,$}return x}function N(U,$){for(var ne=new Array($),X=0;X<$;X++){var Q=(U[0]||[])[X],ie=(U[1]||[])[X];ne[X]=G([Q,ie])}return ne}function G(U){if(T._categoriesMap)return T._categoriesMap[U]}function K(U){var $=G(U);if($!==void 0)return $;if(e(U))return+U}function W(U){return e(U)?+U:G(U)}function Y(U,$,ne){return A.round(ne+$*U,2)}function re(U,$,ne){return(U-ne)/$}var ue=function($){return e($)?Y($,T._m,T._b):x},j=function(U){return re(U,T._m,T._b)};if(T.rangebreaks){var q=z==="y";ue=function(U){if(!e(U))return x;var $=T._rangebreaks.length;if(!$)return Y(U,T._m,T._b);var ne=q;T.range[0]>T.range[1]&&(ne=!ne);for(var X=ne?-1:1,Q=X*U,ie=0,se=0;se<$;se++){var ae=X*T._rangebreaks[se].min,oe=X*T._rangebreaks[se].max;if(Q<ae)break;if(Q>oe)ie=se+1;else{ie=Q<(ae+oe)/2?se:se+1;break}}var be=T._B[ie]||0;return isFinite(be)?Y(U,T._m2,be):0},j=function(U){var $=T._rangebreaks.length;if(!$)return re(U,T._m,T._b);for(var ne=0,X=0;X<$&&!(U<T._rangebreaks[X].pmin);X++)U>T._rangebreaks[X].pmax&&(ne=X+1);return re(U,T._m2,T._B[ne])}}T.c2l=T.type==="log"?I:t,T.l2c=T.type==="log"?b:t,T.l2p=ue,T.p2l=j,T.c2p=T.type==="log"?function(U,$){return ue(I(U,$))}:ue,T.p2c=T.type==="log"?function(U){return b(j(U))}:j,["linear","-"].indexOf(T.type)!==-1?(T.d2r=T.r2d=T.d2c=T.r2c=T.d2l=T.r2l=a,T.c2d=T.c2r=T.l2d=T.l2r=t,T.d2p=T.r2p=function(U){return T.l2p(a(U))},T.p2d=T.p2r=j,T.cleanPos=t):T.type==="log"?(T.d2r=T.d2l=function(U,$){return I(a(U),$)},T.r2d=T.r2c=function(U){return b(a(U))},T.d2c=T.r2l=a,T.c2d=T.l2r=t,T.c2r=I,T.l2d=b,T.d2p=function(U,$){return T.l2p(T.d2r(U,$))},T.p2d=function(U){return b(j(U))},T.r2p=function(U){return T.l2p(a(U))},T.p2r=j,T.cleanPos=t):T.type==="date"?(T.d2r=T.r2d=S.identity,T.d2c=T.r2c=T.d2l=T.r2l=D,T.c2d=T.c2r=T.l2d=T.l2r=R,T.d2p=T.r2p=function(U,$,ne){return T.l2p(D(U,0,ne))},T.p2d=T.p2r=function(U,$,ne){return R(j(U),$,ne)},T.cleanPos=function(U){return S.cleanDate(U,x,T.calendar)}):T.type==="category"?(T.d2c=T.d2l=F,T.r2d=T.c2d=T.l2d=O,T.d2r=T.d2l_noadd=K,T.r2c=function(U){var $=W(U);return $!==void 0?$:T.fraction2r(.5)},T.l2r=T.c2r=t,T.r2l=W,T.d2p=function(U){return T.l2p(T.r2c(U))},T.p2d=function(U){return O(j(U))},T.r2p=T.d2p,T.p2r=j,T.cleanPos=function(U){return typeof U=="string"&&U!==""?U:t(U)}):T.type==="multicategory"&&(T.r2d=T.c2d=T.l2d=O,T.d2r=T.d2l_noadd=K,T.r2c=function(U){var $=K(U);return $!==void 0?$:T.fraction2r(.5)},T.r2c_just_indices=G,T.l2r=T.c2r=t,T.r2l=K,T.d2p=function(U){return T.l2p(T.r2c(U))},T.p2d=function(U){return O(j(U))},T.r2p=T.d2p,T.p2r=j,T.cleanPos=function(U){return Array.isArray(U)||typeof U=="string"&&U!==""?U:t(U)},T.setupMultiCategory=function(U){var $=T._traceIndices,ne,X,Q=T._matchGroup;if(Q&&T._categories.length===0){for(var ie in Q)if(ie!==P){var se=k[l.id2name(ie)];$=$.concat(se._traceIndices)}}var ae=[[0,{}],[0,{}]],oe=[];for(ne=0;ne<$.length;ne++){var be=U[$[ne]];if(z in be){var ce=be[z],de=be._length||S.minRowLength(ce);if(c(ce[0])&&c(ce[1]))for(X=0;X<de;X++){var ye=ce[0][X],ge=ce[1][X];u(ye)&&u(ge)&&(oe.push([ye,ge]),ye in ae[0][1]||(ae[0][1][ye]=ae[0][0]++),ge in ae[1][1]||(ae[1][1][ge]=ae[1][0]++))}}}for(oe.sort(function(me,Ee){var Pe=ae[0][1],Ne=Pe[me[0]]-Pe[Ee[0]];if(Ne)return Ne;var we=ae[1][1];return we[me[1]]-we[Ee[1]]}),ne=0;ne<oe.length;ne++)F(oe[ne])}),T.fraction2r=function(U){var $=T.r2l(T.range[0]),ne=T.r2l(T.range[1]);return T.l2r($+U*(ne-$))},T.r2fraction=function(U){var $=T.r2l(T.range[0]),ne=T.r2l(T.range[1]);return(T.r2l(U)-$)/(ne-$)},T.cleanRange=function(U,$){$||($={}),U||(U="range");var ne=S.nestedProperty(T,U).get(),X,Q;if(T.type==="date"?Q=S.dfltRange(T.calendar):z==="y"?Q=w.DFLTRANGEY:T._name==="realaxis"?Q=[0,1]:Q=$.dfltRange||w.DFLTRANGEX,Q=Q.slice(),(T.rangemode==="tozero"||T.rangemode==="nonnegative")&&(Q[0]=0),!ne||ne.length!==2){S.nestedProperty(T,U).set(Q);return}for(T.type==="date"&&!T.autorange&&(ne[0]=S.cleanDate(ne[0],x,T.calendar),ne[1]=S.cleanDate(ne[1],x,T.calendar)),X=0;X<2;X++)if(T.type==="date"){if(!S.isDateTime(ne[X],T.calendar)){T[U]=Q;break}if(T.r2l(ne[0])===T.r2l(ne[1])){var ie=S.constrain(T.r2l(ne[0]),S.MIN_MS+1e3,S.MAX_MS-1e3);ne[0]=T.l2r(ie-1e3),ne[1]=T.l2r(ie+1e3);break}}else{if(!e(ne[X]))if(e(ne[1-X]))ne[X]=ne[1-X]*(X?10:.1);else{T[U]=Q;break}if(ne[X]<-i?ne[X]=-i:ne[X]>i&&(ne[X]=i),ne[0]===ne[1]){var se=Math.max(1,Math.abs(ne[0]*1e-6));ne[0]-=se,ne[1]+=se}}},T.setScale=function(U){var $=k._size;if(T.overlaying){var ne=l.getFromId({_fullLayout:k},T.overlaying);T.domain=ne.domain}var X=U&&T._r?"_r":"range",Q=T.calendar;T.cleanRange(X);var ie=T.r2l(T[X][0],Q),se=T.r2l(T[X][1],Q),ae=z==="y";if(ae?(T._offset=$.t+(1-T.domain[1])*$.h,T._length=$.h*(T.domain[1]-T.domain[0]),T._m=T._length/(ie-se),T._b=-T._m*se):(T._offset=$.l+T.domain[0]*$.w,T._length=$.w*(T.domain[1]-T.domain[0]),T._m=T._length/(se-ie),T._b=-T._m*ie),T._rangebreaks=[],T._lBreaks=0,T._m2=0,T._B=[],T.rangebreaks){var oe,be;if(T._rangebreaks=T.locateBreaks(Math.min(ie,se),Math.max(ie,se)),T._rangebreaks.length){for(oe=0;oe<T._rangebreaks.length;oe++)be=T._rangebreaks[oe],T._lBreaks+=Math.abs(be.max-be.min);var ce=ae;ie>se&&(ce=!ce),ce&&T._rangebreaks.reverse();var de=ce?-1:1;for(T._m2=de*T._length/(Math.abs(se-ie)-T._lBreaks),T._B.push(-T._m2*(ae?se:ie)),oe=0;oe<T._rangebreaks.length;oe++)be=T._rangebreaks[oe],T._B.push(T._B[T._B.length-1]-de*T._m2*(be.max-be.min));for(oe=0;oe<T._rangebreaks.length;oe++)be=T._rangebreaks[oe],be.pmin=ue(be.min),be.pmax=ue(be.max)}}if(!isFinite(T._m)||!isFinite(T._b)||T._length<0)throw k._replotting=!1,new Error("Something went wrong with axis scaling")},T.maskBreaks=function(U){var $=T.rangebreaks||[],ne,X,Q,ie,se;$._cachedPatterns||($._cachedPatterns=$.map(function(Pe){return Pe.enabled&&Pe.bounds?S.simpleMap(Pe.bounds,Pe.pattern?a:T.d2c):null})),$._cachedValues||($._cachedValues=$.map(function(Pe){return Pe.enabled&&Pe.values?S.simpleMap(Pe.values,T.d2c).sort(S.sorterAsc):null}));for(var ae=0;ae<$.length;ae++){var oe=$[ae];if(oe.enabled){if(oe.bounds){var be=oe.pattern;switch(ne=$._cachedPatterns[ae],X=ne[0],Q=ne[1],be){case h:se=new Date(U),ie=se.getUTCDay(),X>Q&&(Q+=7,ie<X&&(ie+=7));break;case _:se=new Date(U);var ce=se.getUTCHours(),de=se.getUTCMinutes(),ye=se.getUTCSeconds(),ge=se.getUTCMilliseconds();ie=ce+(de/60+ye/3600+ge/36e5),X>Q&&(Q+=24,ie<X&&(ie+=24));break;case"":ie=U;break}if(ie>=X&&ie<Q)return x}else for(var me=$._cachedValues[ae],Ee=0;Ee<me.length;Ee++)if(X=me[Ee],Q=X+oe.dvalue,U>=X&&U<Q)return x}}return U},T.locateBreaks=function(U,$){var ne,X,Q,ie,se=[];if(!T.rangebreaks)return se;var ae=T.rangebreaks.slice().sort(function(we,ke){return we.pattern===h&&ke.pattern===_?-1:ke.pattern===h&&we.pattern===_?1:0}),oe=function(we,ke){if(we=S.constrain(we,U,$),ke=S.constrain(ke,U,$),we!==ke){for(var Xe=!0,He=0;He<se.length;He++){var Ie=se[He];we<Ie.max&&ke>=Ie.min&&(we<Ie.min&&(Ie.min=we),ke>Ie.max&&(Ie.max=ke),Xe=!1)}Xe&&se.push({min:we,max:ke})}};for(ne=0;ne<ae.length;ne++){var be=ae[ne];if(be.enabled)if(be.bounds){var ce=U,de=$;be.pattern&&(ce=Math.floor(ce)),X=S.simpleMap(be.bounds,be.pattern?a:T.r2l),Q=X[0],ie=X[1];var ye=new Date(ce),ge,me;switch(be.pattern){case h:me=v,ge=((ie<Q?7:0)+(ie-Q))*f,ce+=Q*f-(ye.getUTCDay()*f+ye.getUTCHours()*y+ye.getUTCMinutes()*o+ye.getUTCSeconds()*m+ye.getUTCMilliseconds());break;case _:me=f,ge=((ie<Q?24:0)+(ie-Q))*y,ce+=Q*y-(ye.getUTCHours()*y+ye.getUTCMinutes()*o+ye.getUTCSeconds()*m+ye.getUTCMilliseconds());break;default:ce=Math.min(X[0],X[1]),de=Math.max(X[0],X[1]),me=de-ce,ge=me}for(var Ee=ce;Ee<de;Ee+=me)oe(Ee,Ee+ge)}else for(var Pe=S.simpleMap(be.values,T.d2c),Ne=0;Ne<Pe.length;Ne++)Q=Pe[Ne],ie=Q+be.dvalue,oe(Q,ie)}return se.sort(function(we,ke){return we.min-ke.min}),se},T.makeCalcdata=function(U,$,ne){var X,Q,ie,se,ae=T.type,oe=ae==="date"&&U[$+"calendar"];if($ in U){if(X=U[$],se=U._length||S.minRowLength(X),S.isTypedArray(X)&&(ae==="linear"||ae==="log")){if(se===X.length)return X;if(X.subarray)return X.subarray(0,se)}if(ae==="multicategory")return N(X,se);for(Q=new Array(se),ie=0;ie<se;ie++)Q[ie]=T.d2c(X[ie],0,oe,ne)}else{var be=$+"0"in U?T.d2c(U[$+"0"],0,oe):0,ce=U["d"+$]?Number(U["d"+$]):1;for(X=U[{x:"y",y:"x"}[$]],se=U._length||X.length,Q=new Array(se),ie=0;ie<se;ie++)Q[ie]=be+ie*ce}if(T.rangebreaks)for(ie=0;ie<se;ie++)Q[ie]=T.maskBreaks(Q[ie]);return Q},T.isValidRange=function(U){return Array.isArray(U)&&U.length===2&&e(T.r2l(U[0]))&&e(T.r2l(U[1]))},T.isPtWithinRange=function(U,$){var ne=T.c2l(U[z],null,$),X=T.r2l(T.range[0]),Q=T.r2l(T.range[1]);return X<Q?X<=ne&&ne<=Q:Q<=ne&&ne<=X},T._emptyCategories=function(){T._categories=[],T._categoriesMap={}},T.clearCalc=function(){var U=T._matchGroup;if(U){var $=null,ne=null;for(var X in U){var Q=k[l.id2name(X)];if(Q._categories){$=Q._categories,ne=Q._categoriesMap;break}}$&&ne?(T._categories=$,T._categoriesMap=ne):T._emptyCategories()}else T._emptyCategories();if(T._initialCategories)for(var ie=0;ie<T._initialCategories.length;ie++)F(T._initialCategories[ie])},T.sortByInitialCategories=function(){var U=[];if(T._emptyCategories(),T._initialCategories)for(var $=0;$<T._initialCategories.length;$++)F(T._initialCategories[$]);U=U.concat(T._traceIndices);var ne=T._matchGroup;for(var X in ne)if(P!==X){var Q=k[l.id2name(X)];Q._categories=T._categories,Q._categoriesMap=T._categoriesMap,U=U.concat(Q._traceIndices)}return U};var V=k._d3locale;T.type==="date"&&(T._dateFormat=V?V.timeFormat:g,T._extraFormat=k._extraFormat),T._separators=k.separators,T._numFormat=V?V.numberFormat:M,delete T._minDtick,delete T._forceTick0}},{"../../constants/numerical":491,"../../lib":515,"./axis_ids":570,"./constants":573,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],586:[function(d,ee,te){ee.exports=function(g){var S=["showexponent","showtickprefix","showticksuffix"],M=S.filter(function(a){return g[a]!==void 0}),e=function(a){return g[a]===g[M[0]]};if(M.every(e)||M.length===1)return g[M[0]]}},{}],587:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/color").contrast,S=d("./layout_attributes"),M=d("./show_dflt"),e=d("../array_container_defaults");ee.exports=function(r,t,c,s,i){i||(i={});var x=M(r),p=c("showticklabels");if(p){var v=i.font||{},f=t.color,y=t.ticklabelposition||"",o=y.indexOf("inside")!==-1?g(i.bgColor):f&&f!==S.color.dflt?f:v.color;if(A.coerceFont(c,"tickfont",{family:v.family,size:v.size,color:o}),!i.noTicklabelstep&&s!=="multicategory"&&s!=="log"&&c("ticklabelstep"),i.noAng||c("tickangle"),s!=="category"){var m=c("tickformat");e(r,t,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:a}),t.tickformatstops.length||delete t.tickformatstops,!i.noExp&&!m&&s!=="date"&&(c("showexponent",x),c("exponentformat"),c("minexponent"),c("separatethousands"))}}};function a(n,r){function t(s,i){return A.coerce(n,r,S.tickformatstops,s,i)}var c=t("enabled");c&&(t("dtickrange"),t("value"))}},{"../../components/color":367,"../../lib":515,"../array_container_defaults":561,"./layout_attributes":579,"./show_dflt":586}],588:[function(d,ee,te){var A=d("../../lib"),g=d("./layout_attributes");ee.exports=function(M,e,a,n){var r=n.isMinor,t=r?M.minor||{}:M,c=r?e.minor:e,s=r?g.minor:g,i=r?"minor.":"",x=A.coerce2(t,c,s,"ticklen",r?(e.ticklen||5)*.6:void 0),p=A.coerce2(t,c,s,"tickwidth",r?e.tickwidth||1:void 0),v=A.coerce2(t,c,s,"tickcolor",(r?e.tickcolor:void 0)||c.color),f=a(i+"ticks",!r&&n.outerTicks||x||p||v?"outside":"");f||(delete c.ticklen,delete c.tickwidth,delete c.tickcolor)}},{"../../lib":515,"./layout_attributes":579}],589:[function(d,ee,te){var A=d("./clean_ticks"),g=d("../../lib").isArrayOrTypedArray;ee.exports=function(M,e,a,n,r){r||(r={});var t=r.isMinor,c=t?M.minor||{}:M,s=t?e.minor:e,i=t?"minor.":"";function x(w){var _=c[w];return _!==void 0?_:(s._template||{})[w]}var p=x("tick0"),v=x("dtick"),f=x("tickvals"),y=g(f)?"array":v?"linear":"auto",o=a(i+"tickmode",y);if(o==="auto")a(i+"nticks");else if(o==="linear"){var m=s.dtick=A.dtick(v,n);s.tick0=A.tick0(p,n,e.calendar,m)}else if(n!=="multicategory"){var l=a(i+"tickvals");l===void 0?s.tickmode="auto":t||a("ticktext")}}},{"../../lib":515,"./clean_ticks":572}],590:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../registry"),S=d("../../lib"),M=d("../../components/drawing"),e=d("./axes");ee.exports=function(n,r,t,c){var s=n._fullLayout;if(r.length===0){e.redrawComponents(n);return}function i(_){var h=_.xaxis,b=_.yaxis;s._defs.select("#"+_.clipId+"> rect").call(M.setTranslate,0,0).call(M.setScale,1,1),_.plot.call(M.setTranslate,h._offset,b._offset).call(M.setScale,1,1);var u=_.plot.selectAll(".scatterlayer .trace");u.selectAll(".point").call(M.setPointGroupScale,1,1),u.selectAll(".textpoint").call(M.setTextPointsScale,1,1),u.call(M.hideOutsideRangePoints,_)}function x(_,h){var b=_.plotinfo,u=b.xaxis,L=b.yaxis,T=u._length,k=L._length,P=!!_.xr1,z=!!_.yr1,I=[];if(P){var D=S.simpleMap(_.xr0,u.r2l),R=S.simpleMap(_.xr1,u.r2l),O=D[1]-D[0],F=R[1]-R[0];I[0]=(D[0]*(1-h)+h*R[0]-D[0])/(D[1]-D[0])*T,I[2]=T*(1-h+h*F/O),u.range[0]=u.l2r(D[0]*(1-h)+h*R[0]),u.range[1]=u.l2r(D[1]*(1-h)+h*R[1])}else I[0]=0,I[2]=T;if(z){var N=S.simpleMap(_.yr0,L.r2l),G=S.simpleMap(_.yr1,L.r2l),K=N[1]-N[0],W=G[1]-G[0];I[1]=(N[1]*(1-h)+h*G[1]-N[1])/(N[0]-N[1])*k,I[3]=k*(1-h+h*W/K),L.range[0]=u.l2r(N[0]*(1-h)+h*G[0]),L.range[1]=L.l2r(N[1]*(1-h)+h*G[1])}else I[1]=0,I[3]=k;e.drawOne(n,u,{skipTitle:!0}),e.drawOne(n,L,{skipTitle:!0}),e.redrawComponents(n,[u._id,L._id]);var Y=P?T/I[2]:1,re=z?k/I[3]:1,ue=P?I[0]:0,j=z?I[1]:0,q=P?I[0]/I[2]*T:0,V=z?I[1]/I[3]*k:0,U=u._offset-q,$=L._offset-V;b.clipRect.call(M.setTranslate,ue,j).call(M.setScale,1/Y,1/re),b.plot.call(M.setTranslate,U,$).call(M.setScale,Y,re),M.setPointGroupScale(b.zoomScalePts,1/Y,1/re),M.setTextPointsScale(b.zoomScaleTxt,1/Y,1/re)}var p;c&&(p=c());function v(){for(var _={},h=0;h<r.length;h++){var b=r[h],u=b.plotinfo.xaxis,L=b.plotinfo.yaxis;b.xr1&&(_[u._name+".range"]=b.xr1.slice()),b.yr1&&(_[L._name+".range"]=b.yr1.slice())}return p&&p(),g.call("relayout",n,_).then(function(){for(var T=0;T<r.length;T++)i(r[T].plotinfo)})}function f(){for(var _={},h=0;h<r.length;h++){var b=r[h],u=b.plotinfo.xaxis,L=b.plotinfo.yaxis;b.xr0&&(_[u._name+".range"]=b.xr0.slice()),b.yr0&&(_[L._name+".range"]=b.yr0.slice())}return g.call("relayout",n,_).then(function(){for(var T=0;T<r.length;T++)i(r[T].plotinfo)})}var y,o,m,l=A.ease(t.easing);n._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(m),m=null,f()});function w(){o=Date.now();for(var _=Math.min(1,(o-y)/t.duration),h=l(_),b=0;b<r.length;b++)x(r[b],h);o-y>t.duration?(v(),m=window.cancelAnimationFrame(w)):m=window.requestAnimationFrame(w)}return y=Date.now(),m=window.requestAnimationFrame(w),Promise.resolve()}},{"../../components/drawing":389,"../../lib":515,"../../registry":647,"./axes":566,"@plotly/d3":58}],591:[function(d,ee,te){var A=d("../../registry").traceIs,g=d("./axis_autotype");ee.exports=function(r,t,c,s){c("autotypenumbers",s.autotypenumbersDflt);var i=c("type",(s.splomStash||{}).type);i==="-"&&(S(t,s.data),t.type==="-"?t.type="linear":r.type=t.type)};function S(n,r){if(n.type==="-"){var t=n._id,c=t.charAt(0),s;t.indexOf("scene")!==-1&&(t=c);var i=M(r,t,c);if(!!i){if(i.type==="histogram"&&c==={v:"y",h:"x"}[i.orientation||"v"]){n.type="linear";return}var x=c+"calendar",p=i[x],v={noMultiCategory:!A(i,"cartesian")||A(i,"noMultiCategory")};if(i.type==="box"&&i._hasPreCompStats&&c==={h:"x",v:"y"}[i.orientation||"v"]&&(v.noMultiCategory=!0),v.autotypenumbers=n.autotypenumbers,a(i,c)){var f=e(i),y=[];for(s=0;s<r.length;s++){var o=r[s];!A(o,"box-violin")||(o[c+"axis"]||c)!==t||(o[f]!==void 0?y.push(o[f][0]):o.name!==void 0?y.push(o.name):y.push("text"),o[x]!==p&&(p=void 0))}n.type=g(y,p,v)}else if(i.type==="splom"){var m=i.dimensions,l=m[i._axesDim[t]];l.visible&&(n.type=g(l.values,p,v))}else n.type=g(i[c]||[i[c+"0"]],p,v)}}}function M(n,r,t){for(var c=0;c<n.length;c++){var s=n[c];if(s.type==="splom"&&s._length>0&&(s["_"+t+"axes"]||{})[r])return s;if((s[t+"axis"]||t)===r){if(a(s,t))return s;if((s[t]||[]).length||s[t+"0"])return s}}}function e(n){return{v:"x",h:"y"}[n.orientation||"v"]}function a(n,r){var t=e(n),c=A(n,"box-violin"),s=A(n._fullInput||{},"candlestick");return c&&!s&&r===t&&n[t]===void 0&&n[t+"0"]===void 0}},{"../../registry":647,"./axis_autotype":567}],592:[function(d,ee,te){var A=d("../registry"),g=d("../lib");te.manageCommandObserver=function(r,t,c,s){var i={},x=!0;t&&t._commandObserver&&(i=t._commandObserver),i.cache||(i.cache={}),i.lookupTable={};var p=te.hasSimpleAPICommandBindings(r,c,i.lookupTable);if(t&&t._commandObserver){if(p)return i;if(t._commandObserver.remove)return t._commandObserver.remove(),t._commandObserver=null,i}if(p){S(r,p,i.cache),i.check=function(){if(!!x){var o=S(r,p,i.cache);return o.changed&&s&&i.lookupTable[o.value]!==void 0&&(i.disable(),Promise.resolve(s({value:o.value,type:p.type,prop:p.prop,traces:p.traces,index:i.lookupTable[o.value]})).then(i.enable,i.enable)),o.changed}};for(var v=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],f=0;f<v.length;f++)r._internalOn(v[f],i.check);i.remove=function(){for(var y=0;y<v.length;y++)r._removeInternalListener(v[y],i.check)}}else g.log("Unable to automatically bind plot updates to API command"),i.lookupTable={},i.remove=function(){};return i.disable=function(){x=!1},i.enable=function(){x=!0},t&&(t._commandObserver=i),i},te.hasSimpleAPICommandBindings=function(r,t,c){var s,i=t.length,x;for(s=0;s<i;s++){var p,v=t[s],f=v.method,y=v.args;if(Array.isArray(y)||(y=[]),!f)return!1;var o=te.computeAPICommandBindings(r,f,y);if(o.length!==1)return!1;if(!x)x=o[0],Array.isArray(x.traces)&&x.traces.sort();else{if(p=o[0],p.type!==x.type||p.prop!==x.prop)return!1;if(Array.isArray(x.traces))if(Array.isArray(p.traces)){p.traces.sort();for(var m=0;m<x.traces.length;m++)if(x.traces[m]!==p.traces[m])return!1}else return!1;else if(p.prop!==x.prop)return!1}p=o[0];var l=p.value;if(Array.isArray(l))if(l.length===1)l=l[0];else return!1;c&&(c[l]=s)}return x};function S(r,t,c){var s,i,x,p=!1;if(t.type==="data")s=r._fullData[t.traces!==null?t.traces[0]:0];else if(t.type==="layout")s=r._fullLayout;else return!1;return i=g.nestedProperty(s,t.prop).get(),x=c[t.type]=c[t.type]||{},x.hasOwnProperty(t.prop)&&x[t.prop]!==i&&(p=!0),x[t.prop]=i,{changed:p,value:i}}te.executeAPICommand=function(r,t,c){if(t==="skip")return Promise.resolve();var s=A.apiMethodRegistry[t],i=[r];Array.isArray(c)||(c=[]);for(var x=0;x<c.length;x++)i.push(c[x]);return s.apply(null,i).catch(function(p){return g.warn("API call to Plotly."+t+" rejected.",p),Promise.reject(p)})},te.computeAPICommandBindings=function(r,t,c){var s;switch(Array.isArray(c)||(c=[]),t){case"restyle":s=a(r,c);break;case"relayout":s=e(r,c);break;case"update":s=a(r,[c[0],c[2]]).concat(e(r,[c[1]]));break;case"animate":s=M(r,c);break;default:s=[]}return s};function M(r,t){return Array.isArray(t[0])&&t[0].length===1&&["string","number"].indexOf(typeof t[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:t[0][0].toString()}]:[]}function e(r,t){var c=[],s=t[0],i={};if(typeof s=="string")i[s]=t[1];else if(g.isPlainObject(s))i=s;else return c;return n(i,function(x,p,v){c.push({type:"layout",prop:x,value:v})},"",0),c}function a(r,t){var c,s,i,x,p=[];if(s=t[0],i=t[1],c=t[2],x={},typeof s=="string")x[s]=i;else if(g.isPlainObject(s))x=s,c===void 0&&(c=i);else return p;return c===void 0&&(c=null),n(x,function(v,f,y){var o,m;if(Array.isArray(y)){m=y.slice();var l=Math.min(m.length,r.data.length);c&&(l=Math.min(l,c.length)),o=[];for(var w=0;w<l;w++)o[w]=c?c[w]:w}else m=y,o=c?c.slice():null;if(o===null)Array.isArray(m)&&(m=m[0]);else if(Array.isArray(o)){if(!Array.isArray(m)){var _=m;m=[];for(var h=0;h<o.length;h++)m[h]=_}m.length=Math.min(o.length,m.length)}p.push({type:"data",prop:v,traces:o,value:m})},"",0),p}function n(r,t,c,s){Object.keys(r).forEach(function(i){var x=r[i];if(i[0]!=="_"){var p=c+(s>0?".":"")+i;g.isPlainObject(x)?n(x,t,p,s+1):t(p,i,x)}})}},{"../lib":515,"../registry":647}],593:[function(d,ee,te){var A=d("../lib/extend").extendFlat;te.attributes=function(g,S){g=g||{},S=S||{};var M={valType:"info_array",editType:g.editType,items:[{valType:"number",min:0,max:1,editType:g.editType},{valType:"number",min:0,max:1,editType:g.editType}],dflt:[0,1]};g.name&&g.name+"",g.trace,S.description&&""+S.description;var e={x:A({},M,{}),y:A({},M,{}),editType:g.editType};return g.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:g.editType},e.column={valType:"integer",min:0,dflt:0,editType:g.editType}),e},te.defaults=function(g,S,M,e){var a=e&&e.x||[0,1],n=e&&e.y||[0,1],r=S.grid;if(r){var t=M("domain.column");t!==void 0&&(t<r.columns?a=r._domains.x[t]:delete g.domain.column);var c=M("domain.row");c!==void 0&&(c<r.rows?n=r._domains.y[c]:delete g.domain.row)}var s=M("domain.x",a),i=M("domain.y",n);s[0]<s[1]||(g.domain.x=a.slice()),i[0]<i[1]||(g.domain.y=n.slice())}},{"../lib/extend":505}],594:[function(d,ee,te){ee.exports=function(A){var g=A.editType,S=A.colorEditType;S===void 0&&(S=g);var M={family:{valType:"string",noBlank:!0,strict:!0,editType:g},size:{valType:"number",min:1,editType:g},color:{valType:"color",editType:S},editType:g};return A.autoSize&&(M.size.dflt="auto"),A.autoColor&&(M.color.dflt="auto"),A.arrayOk&&(M.family.arrayOk=!0,M.size.arrayOk=!0,M.color.arrayOk=!0),M}},{}],595:[function(d,ee,te){ee.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],596:[function(d,ee,te){te.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},te.axesNames=["lonaxis","lataxis"],te.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},te.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},te.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},te.clipPad=.001,te.precision=.1,te.landColor="#F0DC82",te.waterColor="#3399FF",te.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},te.sphereSVG={type:"Sphere"},te.fillLayers={ocean:1,land:1,lakes:1},te.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},te.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],te.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],te.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],597:[function(d,ee,te){var A=d("@plotly/d3"),g=d("d3-geo"),S=g.geoPath,M=g.geoDistance,e=d("d3-geo-projection"),a=d("../../registry"),n=d("../../lib"),r=n.strTranslate,t=d("../../components/color"),c=d("../../components/drawing"),s=d("../../components/fx"),i=d("../plots"),x=d("../cartesian/axes"),p=d("../cartesian/autorange").getAutoRange,v=d("../../components/dragelement"),f=d("../../components/selections").prepSelect,y=d("../../components/selections").clearOutline,o=d("../../components/selections").selectOnClick,m=d("./zoom"),l=d("./constants"),w=d("../../lib/geo_location_utils"),_=d("../../lib/topojson_utils"),h=d("topojson-client").feature;function b(P){this.id=P.id,this.graphDiv=P.graphDiv,this.container=P.container,this.topojsonURL=P.topojsonURL,this.isStatic=P.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var u=b.prototype;ee.exports=function(z){return new b(z)},u.plot=function(P,z,I,D){var R=this;if(D)return R.update(P,z,!0);R._geoCalcData=P,R._fullLayout=z;var O=z[this.id],F=[],N=!1;for(var G in l.layerNameToAdjective)if(G!=="frame"&&O["show"+G]){N=!0;break}for(var K=!1,W=0;W<P.length;W++){var Y=P[0][0].trace;Y._geo=R,Y.locationmode&&(N=!0);var re=Y.marker;if(re){var ue=re.angle,j=re.angleref;(ue||j==="north"||j==="previous")&&(K=!0)}}if(this._hasMarkerAngles=K,N){var q=_.getTopojsonName(O);(R.topojson===null||q!==R.topojsonName)&&(R.topojsonName=q,PlotlyGeoAssets.topojson[R.topojsonName]===void 0&&F.push(R.fetchTopojson()))}F=F.concat(w.fetchTraceGeoData(P)),I.push(new Promise(function(V,U){Promise.all(F).then(function(){R.topojson=PlotlyGeoAssets.topojson[R.topojsonName],R.update(P,z),V()}).catch(U)}))},u.fetchTopojson=function(){var P=this,z=_.getTopojsonPath(P.topojsonURL,P.topojsonName);return new Promise(function(I,D){A.json(z,function(R,O){if(R)return R.status===404?D(new Error(["plotly.js could not find topojson file at",z+".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):D(new Error(["unexpected error while fetching topojson file at",z].join(" ")));PlotlyGeoAssets.topojson[P.topojsonName]=O,I()})})},u.update=function(P,z,I){var D=z[this.id];this.hasChoropleth=!1;for(var R=0;R<P.length;R++){var O=P[R],F=O[0].trace;F.type==="choropleth"&&(this.hasChoropleth=!0),F.visible===!0&&F._length>0&&F._module.calcGeoJSON(O,z)}if(!I){var N=this.updateProjection(P,z);if(N)return;(!this.viewInitial||this.scope!==D.scope)&&this.saveViewInitial(D)}this.scope=D.scope,this.updateBaseLayers(z,D),this.updateDims(z,D),this.updateFx(z,D),i.generalUpdatePerTraceModule(this.graphDiv,this,P,D);var G=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=G.selectAll(".point"),this.dataPoints.text=G.selectAll("text"),this.dataPaths.line=G.selectAll(".js-line");var K=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=K.selectAll("path"),this._render()},u.updateProjection=function(P,z){var I=this.graphDiv,D=z[this.id],R=z._size,O=D.domain,F=D.projection,N=D.lonaxis,G=D.lataxis,K=N._ax,W=G._ax,Y=this.projection=L(D),re=[[R.l+R.w*O.x[0],R.t+R.h*(1-O.y[1])],[R.l+R.w*O.x[1],R.t+R.h*(1-O.y[0])]],ue=D.center||{},j=F.rotation||{},q=N.range||[],V=G.range||[];if(D.fitbounds){K._length=re[1][0]-re[0][0],W._length=re[1][1]-re[0][1],K.range=p(I,K),W.range=p(I,W);var U=(K.range[0]+K.range[1])/2,$=(W.range[0]+W.range[1])/2;if(D._isScoped)ue={lon:U,lat:$};else if(D._isClipped){ue={lon:U,lat:$},j={lon:U,lat:$,roll:j.roll};var ne=F.type,X=l.lonaxisSpan[ne]/2||180,Q=l.lataxisSpan[ne]/2||90;q=[U-X,U+X],V=[$-Q,$+Q]}else ue={lon:U,lat:$},j={lon:U,lat:j.lat,roll:j.roll}}Y.center([ue.lon-j.lon,ue.lat-j.lat]).rotate([-j.lon,-j.lat,j.roll]).parallels(F.parallels);var ie=k(q,V);Y.fitExtent(re,ie);var se=this.bounds=Y.getBounds(ie),ae=this.fitScale=Y.scale(),oe=Y.translate();if(D.fitbounds){var be=Y.getBounds(k(K.range,W.range)),ce=Math.min((se[1][0]-se[0][0])/(be[1][0]-be[0][0]),(se[1][1]-se[0][1])/(be[1][1]-be[0][1]));isFinite(ce)?Y.scale(ce*ae):n.warn("Something went wrong during"+this.id+"fitbounds computations.")}else Y.scale(F.scale*ae);var de=this.midPt=[(se[0][0]+se[1][0])/2,(se[0][1]+se[1][1])/2];if(Y.translate([oe[0]+(de[0]-oe[0]),oe[1]+(de[1]-oe[1])]).clipExtent(se),D._isAlbersUsa){var ye=Y([ue.lon,ue.lat]),ge=Y.translate();Y.translate([ge[0]-(ye[0]-ge[0]),ge[1]-(ye[1]-ge[1])])}},u.updateBaseLayers=function(P,z){var I=this,D=I.topojson,R=I.layers,O=I.basePaths;function F(re){return re==="lonaxis"||re==="lataxis"}function N(re){return Boolean(l.lineLayers[re])}function G(re){return Boolean(l.fillLayers[re])}var K=this.hasChoropleth?l.layersForChoropleth:l.layers,W=K.filter(function(re){return N(re)||G(re)?z["show"+re]:F(re)?z[re].showgrid:!0}),Y=I.framework.selectAll(".layer").data(W,String);Y.exit().each(function(re){delete R[re],delete O[re],A.select(this).remove()}),Y.enter().append("g").attr("class",function(re){return"layer "+re}).each(function(re){var ue=R[re]=A.select(this);re==="bg"?I.bgRect=ue.append("rect").style("pointer-events","all"):F(re)?O[re]=ue.append("path").style("fill","none"):re==="backplot"?ue.append("g").classed("choroplethlayer",!0):re==="frontplot"?ue.append("g").classed("scatterlayer",!0):N(re)?O[re]=ue.append("path").style("fill","none").style("stroke-miterlimit",2):G(re)&&(O[re]=ue.append("path").style("stroke","none"))}),Y.order(),Y.each(function(re){var ue=O[re],j=l.layerNameToAdjective[re];re==="frame"?ue.datum(l.sphereSVG):N(re)||G(re)?ue.datum(h(D,D.objects[re])):F(re)&&ue.datum(T(re,z,P)).call(t.stroke,z[re].gridcolor).call(c.dashLine,z[re].griddash,z[re].gridwidth),N(re)?ue.call(t.stroke,z[j+"color"]).call(c.dashLine,"",z[j+"width"]):G(re)&&ue.call(t.fill,z[j+"color"])})},u.updateDims=function(P,z){var I=this.bounds,D=(z.framewidth||0)/2,R=I[0][0]-D,O=I[0][1]-D,F=I[1][0]-R+D,N=I[1][1]-O+D;c.setRect(this.clipRect,R,O,F,N),this.bgRect.call(c.setRect,R,O,F,N).call(t.fill,z.bgcolor),this.xaxis._offset=R,this.xaxis._length=F,this.yaxis._offset=O,this.yaxis._length=N},u.updateFx=function(P,z){var I=this,D=I.graphDiv,R=I.bgRect,O=P.dragmode,F=P.clickmode;if(I.isStatic)return;function N(){var Y=I.viewInitial,re={};for(var ue in Y)re[I.id+"."+ue]=Y[ue];a.call("_guiRelayout",D,re),D.emit("plotly_doubleclick",null)}function G(Y){return I.projection.invert([Y[0]+I.xaxis._offset,Y[1]+I.yaxis._offset])}var K=function(Y,re){if(re.isRect){var ue=Y.range={};ue[I.id]=[G([re.xmin,re.ymin]),G([re.xmax,re.ymax])]}else{var j=Y.lassoPoints={};j[I.id]=re.map(G)}},W={element:I.bgRect.node(),gd:D,plotinfo:{id:I.id,xaxis:I.xaxis,yaxis:I.yaxis,fillRangeItems:K},xaxes:[I.xaxis],yaxes:[I.yaxis],subplot:I.id,clickFn:function(Y){Y===2&&y(D)}};O==="pan"?(R.node().onmousedown=null,R.call(m(I,z)),R.on("dblclick.zoom",N),D._context._scrollZoom.geo||R.on("wheel.zoom",null)):(O==="select"||O==="lasso")&&(R.on(".zoom",null),W.prepFn=function(Y,re,ue){f(Y,re,ue,W,O)},v.init(W)),R.on("mousemove",function(){var Y=I.projection.invert(n.getPositionFromD3Event());if(!Y)return v.unhover(D,A.event);I.xaxis.p2c=function(){return Y[0]},I.yaxis.p2c=function(){return Y[1]},s.hover(D,A.event,I.id)}),R.on("mouseout",function(){D._dragging||v.unhover(D,A.event)}),R.on("click",function(){O!=="select"&&O!=="lasso"&&(F.indexOf("select")>-1&&o(A.event,D,[I.xaxis],[I.yaxis],I.id,W),F.indexOf("event")>-1&&s.click(D,A.event))})},u.makeFramework=function(){var P=this,z=P.graphDiv,I=z._fullLayout,D="clip"+I._uid+P.id;P.clipDef=I._clips.append("clipPath").attr("id",D),P.clipRect=P.clipDef.append("rect"),P.framework=A.select(P.container).append("g").attr("class","geo "+P.id).call(c.setClipUrl,D,z),P.project=function(R){var O=P.projection(R);return O?[O[0]-P.xaxis._offset,O[1]-P.yaxis._offset]:[null,null]},P.xaxis={_id:"x",c2p:function(R){return P.project(R)[0]}},P.yaxis={_id:"y",c2p:function(R){return P.project(R)[1]}},P.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},x.setConvert(P.mockAxis,I)},u.saveViewInitial=function(P){var z=P.center||{},I=P.projection,D=I.rotation||{};this.viewInitial={fitbounds:P.fitbounds,"projection.scale":I.scale};var R;P._isScoped?R={"center.lon":z.lon,"center.lat":z.lat}:P._isClipped?R={"projection.rotation.lon":D.lon,"projection.rotation.lat":D.lat}:R={"center.lon":z.lon,"center.lat":z.lat,"projection.rotation.lon":D.lon},n.extendFlat(this.viewInitial,R)},u.render=function(P){this._hasMarkerAngles&&P?this.plot(this._geoCalcData,this._fullLayout,[],!0):this._render()},u._render=function(){var P=this.projection,z=P.getPath(),I;function D(O){var F=P(O.lonlat);return F?r(F[0],F[1]):null}function R(O){return P.isLonLatOverEdges(O.lonlat)?"none":null}for(I in this.basePaths)this.basePaths[I].attr("d",z);for(I in this.dataPaths)this.dataPaths[I].attr("d",function(O){return z(O.geojson)});for(I in this.dataPoints)this.dataPoints[I].attr("display",R).attr("transform",D)};function L(P){var z=P.projection,I=z.type,D=l.projNames[I];D="geo"+n.titleCase(D);for(var R=g[D]||e[D],O=R(),F=P._isSatellite?Math.acos(1/z.distance)*180/Math.PI:P._isClipped?l.lonaxisSpan[I]/2:null,N=["center","rotate","parallels","clipExtent"],G=function(Y){return Y?O:[]},K=0;K<N.length;K++){var W=N[K];typeof O[W]!="function"&&(O[W]=G)}return O.isLonLatOverEdges=function(Y){if(O(Y)===null)return!0;if(F){var re=O.rotate(),ue=M(Y,[-re[0],-re[1]]),j=F*Math.PI/180;return ue>j}else return!1},O.getPath=function(){return S().projection(O)},O.getBounds=function(Y){return O.getPath().bounds(Y)},O.precision(l.precision),P._isSatellite&&O.tilt(z.tilt).distance(z.distance),F&&O.clipAngle(F-l.clipPad),O}function T(P,z,I){var D=1e-6,R=2.5,O=z[P],F=l.scopeDefaults[z.scope],N,G,K;P==="lonaxis"?(N=F.lonaxisRange,G=F.lataxisRange,K=function($,ne){return[$,ne]}):P==="lataxis"&&(N=F.lataxisRange,G=F.lonaxisRange,K=function($,ne){return[ne,$]});var W={type:"linear",range:[N[0],N[1]-D],tick0:O.tick0,dtick:O.dtick};x.setConvert(W,I);var Y=x.calcTicks(W);!z.isScoped&&P==="lonaxis"&&Y.pop();for(var re=Y.length,ue=new Array(re),j=0;j<re;j++)for(var q=Y[j].x,V=ue[j]=[],U=G[0];U<G[1]+R;U+=R)V.push(K(q,U));return{type:"MultiLineString",coordinates:ue}}function k(P,z){var I=l.clipPad,D=P[0]+I,R=P[1]-I,O=z[0]+I,F=z[1]-I;D>0&&R<0&&(R+=360);var N=(R-D)/4;return{type:"Polygon",coordinates:[[[D,O],[D,F],[D+N,F],[D+2*N,F],[D+3*N,F],[R,F],[R,O],[R-N,O],[R-2*N,O],[R-3*N,O],[D,O]]]}}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../registry":647,"../cartesian/autorange":565,"../cartesian/axes":566,"../plots":628,"./constants":596,"./zoom":601,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":316}],598:[function(d,ee,te){var A=d("../../plots/get_data").getSubplotCalcData,g=d("../../lib").counterRegex,S=d("./geo"),M="geo",e=g(M),a={};a[M]={valType:"subplotid",dflt:M,editType:"calc"};function n(c){for(var s=c._fullLayout,i=c.calcdata,x=s._subplots[M],p=0;p<x.length;p++){var v=x[p],f=A(i,M,v),y=s[v],o=y._subplot;o||(o=S({id:v,graphDiv:c,container:s._geolayer.node(),topojsonURL:c._context.topojsonURL,staticPlot:c._context.staticPlot}),s[v]._subplot=o),o.plot(f,s,c._promises)}}function r(c,s,i,x){for(var p=x._subplots[M]||[],v=0;v<p.length;v++){var f=p[v],y=x[f]._subplot;!s[f]&&!!y&&(y.framework.remove(),y.clipDef.remove())}}function t(c){for(var s=c._fullLayout,i=s._subplots[M],x=0;x<i.length;x++){var p=s[i[x]],v=p._subplot;v.updateFx(s,p)}}ee.exports={attr:M,name:M,idRoot:M,idRegex:e,attrRegex:e,attributes:a,layoutAttributes:d("./layout_attributes"),supplyLayoutDefaults:d("./layout_defaults"),plot:n,updateFx:t,clean:r}},{"../../lib":515,"../../plots/get_data":602,"./geo":597,"./layout_attributes":599,"./layout_defaults":600}],599:[function(d,ee,te){var A=d("../../components/color/attributes"),g=d("../domain").attributes,S=d("../../components/drawing/attributes").dash,M=d("./constants"),e=d("../../plot_api/edit_types").overrideAll,a=d("../../lib/sort_object_keys"),n={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:A.lightLine},gridwidth:{valType:"number",min:0,dflt:1},griddash:S},r=ee.exports=e({domain:g({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:a(M.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:a(M.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:A.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:M.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:M.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:M.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:M.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:A.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:A.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:A.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:A.background},lonaxis:n,lataxis:n},"plot","from-root");r.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../domain":593,"./constants":596}],600:[function(d,ee,te){var A=d("../../lib"),g=d("../subplot_defaults"),S=d("../get_data").getSubplotData,M=d("./constants"),e=d("./layout_attributes"),a=M.axesNames;ee.exports=function(t,c,s){g(t,c,s,{type:"geo",attributes:e,handleDefaults:n,fullData:s,partition:"y"})};function n(r,t,c,s){var i=S(s.fullData,"geo",s.id),x=i.map(function(V){return V._expandedIndex}),p=c("resolution"),v=c("scope"),f=M.scopeDefaults[v],y=c("projection.type",f.projType),o=t._isAlbersUsa=y==="albers usa";o&&(v=t.scope="usa");var m=t._isScoped=v!=="world",l=t._isSatellite=y==="satellite",w=t._isConic=y.indexOf("conic")!==-1||y==="albers",_=t._isClipped=!!M.lonaxisSpan[y];if(r.visible===!1){var h=A.extendDeep({},t._template);h.showcoastlines=!1,h.showcountries=!1,h.showframe=!1,h.showlakes=!1,h.showland=!1,h.showocean=!1,h.showrivers=!1,h.showsubunits=!1,h.lonaxis&&(h.lonaxis.showgrid=!1),h.lataxis&&(h.lataxis.showgrid=!1),t._template=h}for(var b=c("visible"),u,L=0;L<a.length;L++){var T=a[L],k=[30,10][L],P;if(m)P=f[T+"Range"];else{var z=M[T+"Span"],I=(z[y]||z["*"])/2,D=c("projection.rotation."+T.substr(0,3),f.projRotate[L]);P=[D-I,D+I]}var R=c(T+".range",P);c(T+".tick0"),c(T+".dtick",k),u=c(T+".showgrid",b?void 0:!1),u&&(c(T+".gridcolor"),c(T+".gridwidth"),c(T+".griddash")),t[T]._ax={type:"linear",_id:T.slice(0,3),_traceIndices:x,setScale:A.identity,c2l:A.identity,r2l:A.identity,autorange:!0,range:R.slice(),_m:1,_input:{}}}var O=t.lonaxis.range,F=t.lataxis.range,N=O[0],G=O[1];N>0&&G<0&&(G+=360);var K=(N+G)/2,W;if(!o){var Y=m?f.projRotate:[K,0,0];W=c("projection.rotation.lon",Y[0]),c("projection.rotation.lat",Y[1]),c("projection.rotation.roll",Y[2]),u=c("showcoastlines",!m&&b),u&&(c("coastlinecolor"),c("coastlinewidth")),u=c("showocean",b?void 0:!1),u&&c("oceancolor")}var re,ue;if(o?(re=-96.6,ue=38.7):(re=m?K:W,ue=(F[0]+F[1])/2),c("center.lon",re),c("center.lat",ue),l&&(c("projection.tilt"),c("projection.distance")),w){var j=f.projParallels||[0,60];c("projection.parallels",j)}c("projection.scale"),u=c("showland",b?void 0:!1),u&&c("landcolor"),u=c("showlakes",b?void 0:!1),u&&c("lakecolor"),u=c("showrivers",b?void 0:!1),u&&(c("rivercolor"),c("riverwidth")),u=c("showcountries",m&&v!=="usa"&&b),u&&(c("countrycolor"),c("countrywidth")),(v==="usa"||v==="north america"&&p===50)&&(c("showsubunits",b),c("subunitcolor"),c("subunitwidth")),m||(u=c("showframe",b),u&&(c("framecolor"),c("framewidth"))),c("bgcolor");var q=c("fitbounds");q&&(delete t.projection.scale,m?(delete t.center.lon,delete t.center.lat):_?(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon,delete t.projection.rotation.lat,delete t.lonaxis.range,delete t.lataxis.range):(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon))}},{"../../lib":515,"../get_data":602,"../subplot_defaults":641,"./constants":596,"./layout_attributes":599}],601:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=d("../../registry"),M=Math.PI/180,e=180/Math.PI,a={cursor:"pointer"},n={cursor:"auto"};function r(T,k){var P=T.projection,z;return k._isScoped?z=s:k._isClipped?z=x:z=i,z(T,P)}ee.exports=r;function t(T,k){return A.behavior.zoom().translate(k.translate()).scale(k.scale())}function c(T,k,P){var z=T.id,I=T.graphDiv,D=I.layout,R=D[z],O=I._fullLayout,F=O[z],N={},G={};function K(W,Y){N[z+"."+W]=g.nestedProperty(R,W).get(),S.call("_storeDirectGUIEdit",D,O._preGUI,N);var re=g.nestedProperty(F,W);re.get()!==Y&&(re.set(Y),g.nestedProperty(R,W).set(Y),G[z+"."+W]=Y)}P(K),K("projection.scale",k.scale()/T.fitScale),K("fitbounds",!1),I.emit("plotly_relayout",G)}function s(T,k){var P=t(T,k);function z(){A.select(this).style(a)}function I(){k.scale(A.event.scale).translate(A.event.translate),T.render(!0);var O=k.invert(T.midPt);T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.center.lon":O[0],"geo.center.lat":O[1]})}function D(O){var F=k.invert(T.midPt);O("center.lon",F[0]),O("center.lat",F[1])}function R(){A.select(this).style(n),c(T,k,D)}return P.on("zoomstart",z).on("zoom",I).on("zoomend",R),P}function i(T,k){var P=t(T,k),z=2,I,D,R,O,F,N,G,K,W;function Y(U){return k.invert(U)}function re(U){var $=Y(U);if(!$)return!0;var ne=k($);return Math.abs(ne[0]-U[0])>z||Math.abs(ne[1]-U[1])>z}function ue(){A.select(this).style(a),I=A.mouse(this),D=k.rotate(),R=k.translate(),O=D,F=Y(I)}function j(){if(N=A.mouse(this),re(I)){P.scale(k.scale()),P.translate(k.translate());return}k.scale(A.event.scale),k.translate([R[0],A.event.translate[1]]),F?Y(N)&&(K=Y(N),G=[O[0]+(K[0]-F[0]),D[1],D[2]],k.rotate(G),O=G):(I=N,F=Y(I)),W=!0,T.render(!0);var U=k.rotate(),$=k.invert(T.midPt);T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.center.lon":$[0],"geo.center.lat":$[1],"geo.projection.rotation.lon":-U[0]})}function q(){A.select(this).style(n),W&&c(T,k,V)}function V(U){var $=k.rotate(),ne=k.invert(T.midPt);U("projection.rotation.lon",-$[0]),U("center.lon",ne[0]),U("center.lat",ne[1])}return P.on("zoomstart",ue).on("zoom",j).on("zoomend",q),P}function x(T,k){k.rotate(),k.scale();var P=t(T,k),z=L(P,"zoomstart","zoom","zoomend"),I=0,D=P.on,R;P.on("zoomstart",function(){A.select(this).style(a);var K=A.mouse(this),W=k.rotate(),Y=W,re=k.translate(),ue=v(W);R=p(k,K),D.call(P,"zoom",function(){var j=A.mouse(this);if(k.scale(A.event.scale),!R)K=j,R=p(k,K);else if(p(k,j)){k.rotate(W).translate(re);var q=p(k,j),V=y(R,q),U=_(f(ue,V)),$=o(U,R,Y);(!isFinite($[0])||!isFinite($[1])||!isFinite($[2]))&&($=Y),k.rotate($),Y=$}F(z.of(this,arguments))}),O(z.of(this,arguments))}).on("zoomend",function(){A.select(this).style(n),D.call(P,"zoom",null),N(z.of(this,arguments)),c(T,k,G)}).on("zoom.redraw",function(){T.render(!0);var K=k.rotate();T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.projection.rotation.lon":-K[0],"geo.projection.rotation.lat":-K[1]})});function O(K){I++||K({type:"zoomstart"})}function F(K){K({type:"zoom"})}function N(K){--I||K({type:"zoomend"})}function G(K){var W=k.rotate();K("projection.rotation.lon",-W[0]),K("projection.rotation.lat",-W[1])}return A.rebind(P,z,"on")}function p(T,k){var P=T.invert(k);return P&&isFinite(P[0])&&isFinite(P[1])&&h(P)}function v(T){var k=.5*T[0]*M,P=.5*T[1]*M,z=.5*T[2]*M,I=Math.sin(k),D=Math.cos(k),R=Math.sin(P),O=Math.cos(P),F=Math.sin(z),N=Math.cos(z);return[D*O*N+I*R*F,I*O*N-D*R*F,D*R*N+I*O*F,D*O*F-I*R*N]}function f(T,k){var P=T[0],z=T[1],I=T[2],D=T[3],R=k[0],O=k[1],F=k[2],N=k[3];return[P*R-z*O-I*F-D*N,P*O+z*R+I*N-D*F,P*F-z*N+I*R+D*O,P*N+z*F-I*O+D*R]}function y(T,k){if(!(!T||!k)){var P=u(T,k),z=Math.sqrt(b(P,P)),I=.5*Math.acos(Math.max(-1,Math.min(1,b(T,k)))),D=Math.sin(I)/z;return z&&[Math.cos(I),P[2]*D,-P[1]*D,P[0]*D]}}function o(T,k,P){var z=w(k,2,T[0]);z=w(z,1,T[1]),z=w(z,0,T[2]-P[2]);var I=k[0],D=k[1],R=k[2],O=z[0],F=z[1],N=z[2],G=Math.atan2(D,I)*e,K=Math.sqrt(I*I+D*D),W,Y;Math.abs(F)>K?(Y=(F>0?90:-90)-G,W=0):(Y=Math.asin(F/K)*e-G,W=Math.sqrt(K*K-F*F));var re=180-Y-2*G,ue=(Math.atan2(N,O)-Math.atan2(R,W))*e,j=(Math.atan2(N,O)-Math.atan2(R,-W))*e,q=m(P[0],P[1],Y,ue),V=m(P[0],P[1],re,j);return q<=V?[Y,ue,P[2]]:[re,j,P[2]]}function m(T,k,P,z){var I=l(P-T),D=l(z-k);return Math.sqrt(I*I+D*D)}function l(T){return(T%360+540)%360-180}function w(T,k,P){var z=P*M,I=T.slice(),D=k===0?1:0,R=k===2?1:2,O=Math.cos(z),F=Math.sin(z);return I[D]=T[D]*O-T[R]*F,I[R]=T[R]*O+T[D]*F,I}function _(T){return[Math.atan2(2*(T[0]*T[1]+T[2]*T[3]),1-2*(T[1]*T[1]+T[2]*T[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(T[0]*T[2]-T[3]*T[1]))))*e,Math.atan2(2*(T[0]*T[3]+T[1]*T[2]),1-2*(T[2]*T[2]+T[3]*T[3]))*e]}function h(T){var k=T[0]*M,P=T[1]*M,z=Math.cos(P);return[z*Math.cos(k),z*Math.sin(k),Math.sin(P)]}function b(T,k){for(var P=0,z=0,I=T.length;z<I;++z)P+=T[z]*k[z];return P}function u(T,k){return[T[1]*k[2]-T[2]*k[1],T[2]*k[0]-T[0]*k[2],T[0]*k[1]-T[1]*k[0]]}function L(T){for(var k=0,P=arguments.length,z=[];++k<P;)z.push(arguments[k]);var I=A.dispatch.apply(null,z);return I.of=function(D,R){return function(O){var F;try{F=O.sourceEvent=A.event,O.target=T,A.event=O,I[O.type].apply(D,R)}finally{A.event=F}}},I}},{"../../lib":515,"../../registry":647,"@plotly/d3":58}],602:[function(d,ee,te){var A=d("../registry"),g=d("./cartesian/constants").SUBPLOT_PATTERN;te.getSubplotCalcData=function(S,M,e){var a=A.subplotsRegistry[M];if(!a)return[];for(var n=a.attr,r=[],t=0;t<S.length;t++){var c=S[t],s=c[0].trace;s[n]===e&&r.push(c)}return r},te.getModuleCalcData=function(S,M){var e=[],a=[],n;if(typeof M=="string"?n=A.getModule(M).plot:typeof M=="function"?n=M:n=M.plot,!n)return[e,S];for(var r=0;r<S.length;r++){var t=S[r],c=t[0].trace;c.visible!==!0||c._length===0||(c._module.plot===n?e.push(t):a.push(t))}return[e,a]},te.getSubplotData=function(M,e,a){if(!A.subplotsRegistry[e])return[];var n=A.subplotsRegistry[e].attr,r=[],t,c,s;if(e==="gl2d"){var i=a.match(g);c="x"+i[1],s="y"+i[2]}for(var x=0;x<M.length;x++)t=M[x],e==="gl2d"&&A.traceIs(t,"gl2d")?t[n[0]]===c&&t[n[1]]===s&&r.push(t):t[n]===a&&r.push(t);return r}},{"../registry":647,"./cartesian/constants":573}],603:[function(d,ee,te){var A=d("mouse-change"),g=d("mouse-wheel"),S=d("mouse-event-offset"),M=d("../cartesian/constants"),e=d("has-passive-events");ee.exports=n;function a(r,t){this.element=r,this.plot=t,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}function n(r){var t=r.mouseContainer,c=r.glplot,s=new a(t,c);function i(){r.xaxis.autorange=!1,r.yaxis.autorange=!1}function x(){for(var v=r.graphDiv._fullLayout._axisConstraintGroups,f=r.xaxis._id,y=r.yaxis._id,o=0;o<v.length;o++)if(v[o][f]!==-1){if(v[o][y]!==-1)return!0;break}return!1}s.mouseListener=A(t,p),t.addEventListener("touchstart",function(v){var f=S(v.changedTouches[0],t);p(0,f[0],f[1]),p(1,f[0],f[1]),v.preventDefault()},e?{passive:!1}:!1),t.addEventListener("touchmove",function(v){v.preventDefault();var f=S(v.changedTouches[0],t);p(1,f[0],f[1]),v.preventDefault()},e?{passive:!1}:!1),t.addEventListener("touchend",function(v){p(0,s.lastPos[0],s.lastPos[1]),v.preventDefault()},e?{passive:!1}:!1);function p(v,f,y){var o=r.calcDataBox(),m=c.viewBox,l=s.lastPos[0],w=s.lastPos[1],_=M.MINDRAG*c.pixelRatio,h=M.MINZOOM*c.pixelRatio,b,u;f*=c.pixelRatio,y*=c.pixelRatio,y=m[3]-m[1]-y;function L(D,R,O){var F=Math.min(R,O),N=Math.max(R,O);F!==N?(o[D]=F,o[D+2]=N,s.dataBox=o,r.setRanges(o)):(r.selectBox.selectBox=[0,0,1,1],r.glplot.setDirty())}switch(r.fullLayout.dragmode){case"zoom":if(v){var T=f/(m[2]-m[0])*(o[2]-o[0])+o[0],k=y/(m[3]-m[1])*(o[3]-o[1])+o[1];s.boxInited||(s.boxStart[0]=T,s.boxStart[1]=k,s.dragStart[0]=f,s.dragStart[1]=y),s.boxEnd[0]=T,s.boxEnd[1]=k,s.boxInited=!0,!s.boxEnabled&&(s.boxStart[0]!==s.boxEnd[0]||s.boxStart[1]!==s.boxEnd[1])&&(s.boxEnabled=!0);var P=Math.abs(s.dragStart[0]-f)<h,z=Math.abs(s.dragStart[1]-y)<h;if(x()&&!(P&&z)){b=s.boxEnd[0]-s.boxStart[0],u=s.boxEnd[1]-s.boxStart[1];var I=(o[3]-o[1])/(o[2]-o[0]);Math.abs(b*I)>Math.abs(u)?(s.boxEnd[1]=s.boxStart[1]+Math.abs(b)*I*(u>=0?1:-1),s.boxEnd[1]<o[1]?(s.boxEnd[1]=o[1],s.boxEnd[0]=s.boxStart[0]+(o[1]-s.boxStart[1])/Math.abs(I)):s.boxEnd[1]>o[3]&&(s.boxEnd[1]=o[3],s.boxEnd[0]=s.boxStart[0]+(o[3]-s.boxStart[1])/Math.abs(I))):(s.boxEnd[0]=s.boxStart[0]+Math.abs(u)/I*(b>=0?1:-1),s.boxEnd[0]<o[0]?(s.boxEnd[0]=o[0],s.boxEnd[1]=s.boxStart[1]+(o[0]-s.boxStart[0])*Math.abs(I)):s.boxEnd[0]>o[2]&&(s.boxEnd[0]=o[2],s.boxEnd[1]=s.boxStart[1]+(o[2]-s.boxStart[0])*Math.abs(I)))}else P&&(s.boxEnd[0]=s.boxStart[0]),z&&(s.boxEnd[1]=s.boxStart[1])}else s.boxEnabled?(b=s.boxStart[0]!==s.boxEnd[0],u=s.boxStart[1]!==s.boxEnd[1],b||u?(b&&(L(0,s.boxStart[0],s.boxEnd[0]),r.xaxis.autorange=!1),u&&(L(1,s.boxStart[1],s.boxEnd[1]),r.yaxis.autorange=!1),r.relayoutCallback()):r.glplot.setDirty(),s.boxEnabled=!1,s.boxInited=!1):s.boxInited&&(s.boxInited=!1);break;case"pan":s.boxEnabled=!1,s.boxInited=!1,v?(s.panning||(s.dragStart[0]=f,s.dragStart[1]=y),Math.abs(s.dragStart[0]-f)<_&&(f=s.dragStart[0]),Math.abs(s.dragStart[1]-y)<_&&(y=s.dragStart[1]),b=(l-f)*(o[2]-o[0])/(c.viewBox[2]-c.viewBox[0]),u=(w-y)*(o[3]-o[1])/(c.viewBox[3]-c.viewBox[1]),o[0]+=b,o[2]+=b,o[1]+=u,o[3]+=u,r.setRanges(o),s.panning=!0,s.lastInputTime=Date.now(),i(),r.cameraChanged(),r.handleAnnotations()):s.panning&&(s.panning=!1,r.relayoutCallback());break}s.lastPos[0]=f,s.lastPos[1]=y}return s.wheelListener=g(t,function(v,f){if(!r.scrollZoom)return!1;var y=r.calcDataBox(),o=c.viewBox,m=s.lastPos[0],l=s.lastPos[1],w=Math.exp(5*f/(o[3]-o[1])),_=m/(o[2]-o[0])*(y[2]-y[0])+y[0],h=l/(o[3]-o[1])*(y[3]-y[1])+y[1];return y[0]=(y[0]-_)*w+_,y[2]=(y[2]-_)*w+_,y[1]=(y[1]-h)*w+h,y[3]=(y[3]-h)*w+h,r.setRanges(y),s.lastInputTime=Date.now(),i(),r.cameraChanged(),r.handleAnnotations(),r.relayoutCallback(),!0},!0),s}},{"../cartesian/constants":573,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],604:[function(d,ee,te){var A=d("../cartesian/axes"),g=d("../../lib/str2rgbarray");function S(n){this.scene=n,this.gl=n.gl,this.pixelRatio=n.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var M=S.prototype,e=["xaxis","yaxis"];M.merge=function(n){this.titleEnable=!1,this.backgroundColor=g(n.plot_bgcolor);var r,t,c,s,i,x,p,v,f,y,o;for(y=0;y<2;++y){r=e[y];var m=r.charAt(0);for(t=n[this.scene[r]._name],c=t.title.text===this.scene.fullLayout._dfltTitle[m]?"":t.title.text,o=0;o<=2;o+=2)this.labelEnable[y+o]=!1,this.labels[y+o]=c,this.labelColor[y+o]=g(t.title.font.color),this.labelFont[y+o]=t.title.font.family,this.labelSize[y+o]=t.title.font.size,this.labelPad[y+o]=this.getLabelPad(r,t),this.tickEnable[y+o]=!1,this.tickColor[y+o]=g((t.tickfont||{}).color),this.tickAngle[y+o]=t.tickangle==="auto"?0:Math.PI*-t.tickangle/180,this.tickPad[y+o]=this.getTickPad(t),this.tickMarkLength[y+o]=0,this.tickMarkWidth[y+o]=t.tickwidth||0,this.tickMarkColor[y+o]=g(t.tickcolor),this.borderLineEnable[y+o]=!1,this.borderLineColor[y+o]=g(t.linecolor),this.borderLineWidth[y+o]=t.linewidth||0;p=this.hasSharedAxis(t),i=this.hasAxisInDfltPos(r,t)&&!p,x=this.hasAxisInAltrPos(r,t)&&!p,s=t.mirror||!1,v=p?String(s).indexOf("all")!==-1:!!s,f=p?s==="allticks":String(s).indexOf("ticks")!==-1,i?this.labelEnable[y]=!0:x&&(this.labelEnable[y+2]=!0),i?this.tickEnable[y]=t.showticklabels:x&&(this.tickEnable[y+2]=t.showticklabels),(i||v)&&(this.borderLineEnable[y]=t.showline),(x||v)&&(this.borderLineEnable[y+2]=t.showline),(i||f)&&(this.tickMarkLength[y]=this.getTickMarkLength(t)),(x||f)&&(this.tickMarkLength[y+2]=this.getTickMarkLength(t)),this.gridLineEnable[y]=t.showgrid,this.gridLineColor[y]=g(t.gridcolor),this.gridLineWidth[y]=t.gridwidth,this.zeroLineEnable[y]=t.zeroline,this.zeroLineColor[y]=g(t.zerolinecolor),this.zeroLineWidth[y]=t.zerolinewidth}},M.hasSharedAxis=function(n){var r=this.scene,t=r.fullLayout._subplots.gl2d,c=A.findSubplotsWithAxis(t,n);return c.indexOf(r.id)!==0},M.hasAxisInDfltPos=function(n,r){var t=r.side;if(n==="xaxis")return t==="bottom";if(n==="yaxis")return t==="left"},M.hasAxisInAltrPos=function(n,r){var t=r.side;if(n==="xaxis")return t==="top";if(n==="yaxis")return t==="right"},M.getLabelPad=function(n,r){var t=1.5,c=r.title.font.size,s=r.showticklabels;if(n==="xaxis")return r.side==="top"?-10+c*(t+(s?1:0)):-10+c*(t+(s?.5:0));if(n==="yaxis")return r.side==="right"?10+c*(t+(s?1:.5)):10+c*(t+(s?.5:0))},M.getTickPad=function(n){return n.ticks==="outside"?10+n.ticklen:15},M.getTickMarkLength=function(n){if(!n.ticks)return 0;var r=n.ticklen;return n.ticks==="inside"?-r:r};function a(n){return new S(n)}ee.exports=a},{"../../lib/str2rgbarray":540,"../cartesian/axes":566}],605:[function(d,ee,te){var A=d("../../plot_api/edit_types").overrideAll,g=d("./scene2d"),S=d("../layout_attributes"),M=d("../../constants/xmlns_namespaces"),e=d("../cartesian/constants"),a=d("../cartesian"),n=d("../../components/fx/layout_attributes"),r=d("../get_data").getSubplotData;te.name="gl2d",te.attr=["xaxis","yaxis"],te.idRoot=["x","y"],te.idRegex=e.idRegex,te.attrRegex=e.attrRegex,te.attributes=d("../cartesian/attributes"),te.supplyLayoutDefaults=function(t,c,s){c._has("cartesian")||a.supplyLayoutDefaults(t,c,s)},te.layoutAttrOverrides=A(a.layoutAttributes,"plot","from-root"),te.baseLayoutAttrOverrides=A({plot_bgcolor:S.plot_bgcolor,hoverlabel:n.hoverlabel},"plot","nested"),te.plot=function(c){for(var s=c._fullLayout,i=c._fullData,x=s._subplots.gl2d,p=0;p<x.length;p++){var v=x[p],f=s._plots[v],y=r(i,"gl2d",v),o=f._scene2d;o===void 0&&(o=new g({id:v,graphDiv:c,container:c.querySelector(".gl-container"),staticPlot:c._context.staticPlot,plotGlPixelRatio:c._context.plotGlPixelRatio},s),f._scene2d=o),o.plot(y,c.calcdata,s,c.layout)}},te.clean=function(t,c,s,i){for(var x=i._subplots.gl2d||[],p=0;p<x.length;p++){var v=x[p],f=i._plots[v];if(!!f._scene2d){var y=r(t,"gl2d",v);y.length===0&&(f._scene2d.destroy(),delete i._plots[v])}}a.clean.apply(this,arguments)},te.drawFramework=function(t){t._context.staticPlot||a.drawFramework(t)},te.toSVG=function(t){for(var c=t._fullLayout,s=c._subplots.gl2d,i=0;i<s.length;i++){var x=c._plots[s[i]],p=x._scene2d,v=p.toImage("png"),f=c._glimages.append("svg:image");f.attr({xmlns:M.svg,"xlink:href":v,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),p.destroy()}},te.updateFx=function(t){for(var c=t._fullLayout,s=c._subplots.gl2d,i=0;i<s.length;i++){var x=c._plots[s[i]]._scene2d;x.updateFx(c.dragmode)}}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../plot_api/edit_types":548,"../cartesian":578,"../cartesian/attributes":564,"../cartesian/constants":573,"../get_data":602,"../layout_attributes":619,"./scene2d":606}],606:[function(d,ee,te){var A=d("../../registry"),g=d("../../plots/cartesian/axes"),S=d("../../components/fx"),M=d("../../../stackgl_modules").gl_plot2d,e=d("../../../stackgl_modules").gl_spikes2d,a=d("../../../stackgl_modules").gl_select_box,n=d("webgl-context"),r=d("./convert"),t=d("./camera"),c=d("../../lib/show_no_webgl_msg"),s=d("../cartesian/constraints"),i=s.enforce,x=s.clean,p=d("../cartesian/autorange").doAutoRange,v=d("../../components/dragelement/helpers"),f=v.drawMode,y=v.selectMode,o=["xaxis","yaxis"],m,l,w=d("../cartesian/constants").SUBPLOT_PATTERN;function _(u,L){this.container=u.container,this.graphDiv=u.graphDiv,this.pixelRatio=u.plotGlPixelRatio||window.devicePixelRatio,this.id=u.id,this.staticPlot=!!u.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(L),this.makeFramework(),!this.stopped&&(this.glplotOptions=r(this),this.glplotOptions.merge(L),this.glplot=M(this.glplotOptions),this.camera=t(this),this.traces={},this.spikes=e(this.glplot),this.selectBox=a(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}ee.exports=_;var h=_.prototype;h.makeFramework=function(){if(this.staticPlot){if(!l&&(m=document.createElement("canvas"),l=n({canvas:m,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}),!l))throw new Error("Error creating static canvas/context for image server");this.canvas=m,this.gl=l}else{var u=this.container.querySelector(".gl-canvas-focus"),L=n({canvas:u,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!L){c(this),this.stopped=!0;return}this.canvas=u,this.gl=L}var T=this.canvas;T.style.width="100%",T.style.height="100%",T.style.position="absolute",T.style.top="0px",T.style.left="0px",T.style["pointer-events"]="none",this.updateSize(T);var k=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");k.style.position="absolute",k.style.top=k.style.left="0px",k.style.width=k.style.height="100%",k.style["z-index"]=20,k.style["pointer-events"]="none";var P=this.mouseContainer=document.createElement("div");P.style.position="absolute",P.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var z=this.container;z.appendChild(k),z.appendChild(P);var I=this;P.addEventListener("mouseout",function(){I.isMouseOver=!1,I.unhover()}),P.addEventListener("mouseover",function(){I.isMouseOver=!0})},h.toImage=function(u){u||(u="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(m),this.updateSize(this.canvas);var L=this.glplot.gl,T=L.drawingBufferWidth,k=L.drawingBufferHeight;L.clearColor(1,1,1,0),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),L.bindFramebuffer(L.FRAMEBUFFER,null);var P=new Uint8Array(T*k*4);L.readPixels(0,0,T,k,L.RGBA,L.UNSIGNED_BYTE,P);for(var z=0,I=k-1;z<I;++z,--I)for(var D=0;D<T;++D)for(var R=0;R<4;++R){var O=P[4*(T*z+D)+R];P[4*(T*z+D)+R]=P[4*(T*I+D)+R],P[4*(T*I+D)+R]=O}var F=document.createElement("canvas");F.width=T,F.height=k;var N=F.getContext("2d",{willReadFrequently:!0}),G=N.createImageData(T,k);G.data.set(P),N.putImageData(G,0,0);var K;switch(u){case"jpeg":K=F.toDataURL("image/jpeg");break;case"webp":K=F.toDataURL("image/webp");break;default:K=F.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(m),K},h.updateSize=function(u){u||(u=this.canvas);var L=this.pixelRatio,T=this.fullLayout,k=T.width,P=T.height,z=Math.ceil(L*k)|0,I=Math.ceil(L*P)|0;return(u.width!==z||u.height!==I)&&(u.width=z,u.height=I),u},h.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var u=[g.calcTicks(this.xaxis),g.calcTicks(this.yaxis)],L=0;L<2;++L)for(var T=0;T<u[L].length;++T)u[L][T].text=u[L][T].text+"";return u};function b(u,L){for(var T=0;T<2;++T){var k=u[T],P=L[T];if(k.length!==P.length)return!0;for(var z=0;z<k.length;++z)if(k[z].x!==P[z].x)return!0}return!1}h.updateRefs=function(u){this.fullLayout=u;var L=this.id.match(w),T="xaxis"+L[1],k="yaxis"+L[2];this.xaxis=this.fullLayout[T],this.yaxis=this.fullLayout[k]},h.relayoutCallback=function(){var u=this.graphDiv,L=this.xaxis,T=this.yaxis,k=u.layout,P={},z=P[L._name+".range"]=L.range.slice(),I=P[T._name+".range"]=T.range.slice();P[L._name+".autorange"]=L.autorange,P[T._name+".autorange"]=T.autorange,A.call("_storeDirectGUIEdit",u.layout,u._fullLayout._preGUI,P);var D=k[L._name];D.range=z,D.autorange=L.autorange;var R=k[T._name];R.range=I,R.autorange=T.autorange,P.lastInputTime=this.camera.lastInputTime,u.emit("plotly_relayout",P)},h.cameraChanged=function(){var u=this.camera;this.glplot.setDataBox(this.calcDataBox());var L=this.computeTickMarks(),T=this.glplotOptions.ticks;b(L,T)&&(this.glplotOptions.ticks=L,this.glplotOptions.dataBox=u.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},h.handleAnnotations=function(){for(var u=this.graphDiv,L=this.fullLayout.annotations,T=0;T<L.length;T++){var k=L[T];k.xref===this.xaxis._id&&k.yref===this.yaxis._id&&A.getComponentMethod("annotations","drawOne")(u,T)}},h.destroy=function(){if(!!this.glplot){var u=this.traces;u&&Object.keys(u).map(function(L){u[L].dispose(),delete u[L]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},h.plot=function(u,L,T){var k=this.glplot;this.updateRefs(T),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(u,L),this.updateFx(T.dragmode);var P=T.width,z=T.height;this.updateSize(this.canvas);var I=this.glplotOptions;I.merge(T),I.screenBox=[0,0,P,z];var D={_fullLayout:{_axisConstraintGroups:T._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:T._size}};x(D,this.xaxis),x(D,this.yaxis);var R=T._size,O=this.xaxis.domain,F=this.yaxis.domain;I.viewBox=[R.l+O[0]*R.w,R.b+F[0]*R.h,P-R.r-(1-O[1])*R.w,z-R.t-(1-F[1])*R.h],this.mouseContainer.style.width=R.w*(O[1]-O[0])+"px",this.mouseContainer.style.height=R.h*(F[1]-F[0])+"px",this.mouseContainer.height=R.h*(F[1]-F[0]),this.mouseContainer.style.left=R.l+O[0]*R.w+"px",this.mouseContainer.style.top=R.t+(1-F[1])*R.h+"px";var N,G;for(G=0;G<2;++G)N=this[o[G]],N._length=I.viewBox[G+2]-I.viewBox[G],p(this.graphDiv,N),N.setScale();i(D),I.ticks=this.computeTickMarks(),I.dataBox=this.calcDataBox(),I.merge(T),k.update(I),this.glplot.draw()},h.calcDataBox=function(){var u=this.xaxis,L=this.yaxis,T=u.range,k=L.range,P=u.r2l,z=L.r2l;return[P(T[0]),z(k[0]),P(T[1]),z(k[1])]},h.setRanges=function(u){var L=this.xaxis,T=this.yaxis,k=L.l2r,P=T.l2r;L.range=[k(u[0]),k(u[2])],T.range=[P(u[1]),P(u[3])]},h.updateTraces=function(u,L){var T=Object.keys(this.traces),k,P,z;this.fullData=u;e:for(k=0;k<T.length;k++){var I=T[k],D=this.traces[I];for(P=0;P<u.length;P++)if(z=u[P],z.uid===I&&z.type===D.type)continue e;D.dispose(),delete this.traces[I]}for(k=0;k<u.length;k++){z=u[k];var R=L[k],O=this.traces[z.uid];O?O.update(z,R):(O=z._module.plot(this,z,R),this.traces[z.uid]=O)}this.glplot.objects.sort(function(F,N){return F._trace.index-N._trace.index})},h.updateFx=function(u){y(u)||f(u)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),u==="pan"?this.mouseContainer.style.cursor="move":u==="zoom"?this.mouseContainer.style.cursor="crosshair":this.mouseContainer.style.cursor=null},h.emitPointAction=function(u,L){for(var T=u.trace.uid,k=u.pointIndex,P,z=0;z<this.fullData.length;z++)this.fullData[z].uid===T&&(P=this.fullData[z]);var I={x:u.traceCoord[0],y:u.traceCoord[1],curveNumber:P.index,pointNumber:k,data:P._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};S.appendArrayPointValue(I,P,k),this.graphDiv.emit(L,{points:[I]})},h.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var u=this.glplot,L=this.camera,T=L.mouseListener,k=this.lastButtonState===1&&T.buttons===0,P=this.fullLayout;this.lastButtonState=T.buttons,this.cameraChanged();var z=T.x*u.pixelRatio,I=this.canvas.height-u.pixelRatio*T.y,D;if(L.boxEnabled&&P.dragmode==="zoom"){this.selectBox.enabled=!0;for(var R=this.selectBox.selectBox=[Math.min(L.boxStart[0],L.boxEnd[0]),Math.min(L.boxStart[1],L.boxEnd[1]),Math.max(L.boxStart[0],L.boxEnd[0]),Math.max(L.boxStart[1],L.boxEnd[1])],O=0;O<2;O++)L.boxStart[O]===L.boxEnd[O]&&(R[O]=u.dataBox[O],R[O+2]=u.dataBox[O+2]);u.setDirty()}else if(!L.panning&&this.isMouseOver){this.selectBox.enabled=!1;var F=P._size,N=this.xaxis.domain,G=this.yaxis.domain;D=u.pick(z/u.pixelRatio+F.l+N[0]*F.w,I/u.pixelRatio-(F.t+(1-G[1])*F.h));var K=D&&D.object._trace.handlePick(D);if(K&&k&&this.emitPointAction(K,"plotly_click"),D&&D.object._trace.hoverinfo!=="skip"&&P.hovermode&&K&&(!this.lastPickResult||this.lastPickResult.traceUid!==K.trace.uid||this.lastPickResult.dataCoord[0]!==K.dataCoord[0]||this.lastPickResult.dataCoord[1]!==K.dataCoord[1])){var W=K;this.lastPickResult={traceUid:K.trace?K.trace.uid:null,dataCoord:K.dataCoord.slice()},this.spikes.update({center:D.dataCoord}),W.screenCoord=[((u.viewBox[2]-u.viewBox[0])*(D.dataCoord[0]-u.dataBox[0])/(u.dataBox[2]-u.dataBox[0])+u.viewBox[0])/u.pixelRatio,(this.canvas.height-(u.viewBox[3]-u.viewBox[1])*(D.dataCoord[1]-u.dataBox[1])/(u.dataBox[3]-u.dataBox[1])-u.viewBox[1])/u.pixelRatio],this.emitPointAction(K,"plotly_hover");var Y=this.fullData[W.trace.index]||{},re=W.pointIndex,ue=S.castHoverinfo(Y,P,re);if(ue&&ue!=="all"){var j=ue.split("+");j.indexOf("x")===-1&&(W.traceCoord[0]=void 0),j.indexOf("y")===-1&&(W.traceCoord[1]=void 0),j.indexOf("z")===-1&&(W.traceCoord[2]=void 0),j.indexOf("text")===-1&&(W.textLabel=void 0),j.indexOf("name")===-1&&(W.name=void 0)}S.loneHover({x:W.screenCoord[0],y:W.screenCoord[1],xLabel:this.hoverFormatter("xaxis",W.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",W.traceCoord[1]),zLabel:W.traceCoord[2],text:W.textLabel,name:W.name,color:S.castHoverOption(Y,re,"bgcolor")||W.color,borderColor:S.castHoverOption(Y,re,"bordercolor"),fontFamily:S.castHoverOption(Y,re,"font.family"),fontSize:S.castHoverOption(Y,re,"font.size"),fontColor:S.castHoverOption(Y,re,"font.color"),nameLength:S.castHoverOption(Y,re,"namelength"),textAlign:S.castHoverOption(Y,re,"align")},{container:this.svgContainer,gd:this.graphDiv})}}D||this.unhover(),u.draw()}},h.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),S.loneUnhover(this.svgContainer))},h.hoverFormatter=function(u,L){if(L!==void 0){var T=this[u];return g.tickText(T,T.c2l(L),"hover").text}}},{"../../../stackgl_modules":1133,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../lib/show_no_webgl_msg":537,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/constants":573,"../cartesian/constraints":574,"./camera":603,"./convert":604,"webgl-context":332}],607:[function(d,ee,te){var A=d("../../plot_api/edit_types").overrideAll,g=d("../../components/fx/layout_attributes"),S=d("./scene"),M=d("../get_data").getSubplotData,e=d("../../lib"),a=d("../../constants/xmlns_namespaces"),n="gl3d",r="scene";te.name=n,te.attr=r,te.idRoot=r,te.idRegex=te.attrRegex=e.counterRegex("scene"),te.attributes=d("./layout/attributes"),te.layoutAttributes=d("./layout/layout_attributes"),te.baseLayoutAttrOverrides=A({hoverlabel:g.hoverlabel},"plot","nested"),te.supplyLayoutDefaults=d("./layout/defaults"),te.plot=function(c){for(var s=c._fullLayout,i=c._fullData,x=s._subplots[n],p=0;p<x.length;p++){var v=x[p],f=M(i,n,v),y=s[v],o=y.camera,m=y._scene;m||(m=new S({id:v,graphDiv:c,container:c.querySelector(".gl-container"),staticPlot:c._context.staticPlot,plotGlPixelRatio:c._context.plotGlPixelRatio,camera:o},s),y._scene=m),m.viewInitial||(m.viewInitial={up:{x:o.up.x,y:o.up.y,z:o.up.z},eye:{x:o.eye.x,y:o.eye.y,z:o.eye.z},center:{x:o.center.x,y:o.center.y,z:o.center.z}}),m.plot(f,s,c.layout)}},te.clean=function(t,c,s,i){for(var x=i._subplots[n]||[],p=0;p<x.length;p++){var v=x[p];!c[v]&&!!i[v]._scene&&(i[v]._scene.destroy(),i._infolayer&&i._infolayer.selectAll(".annotation-"+v).remove())}},te.toSVG=function(t){for(var c=t._fullLayout,s=c._subplots[n],i=c._size,x=0;x<s.length;x++){var p=c[s[x]],v=p.domain,f=p._scene,y=f.toImage("png"),o=c._glimages.append("svg:image");o.attr({xmlns:a.svg,"xlink:href":y,x:i.l+i.w*v.x[0],y:i.t+i.h*(1-v.y[1]),width:i.w*(v.x[1]-v.x[0]),height:i.h*(v.y[1]-v.y[0]),preserveAspectRatio:"none"}),f.destroy()}},te.cleanId=function(c){if(!!c.match(/^scene[0-9]*$/)){var s=c.substr(5);return s==="1"&&(s=""),r+s}},te.updateFx=function(t){for(var c=t._fullLayout,s=c._subplots[n],i=0;i<s.length;i++){var x=c[s[i]]._scene;x.updateFx(c.dragmode,c.hovermode)}}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../plot_api/edit_types":548,"../get_data":602,"./layout/attributes":608,"./layout/defaults":612,"./layout/layout_attributes":613,"./scene":617}],608:[function(d,ee,te){ee.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],609:[function(d,ee,te){var A=d("../../../components/color"),g=d("../../cartesian/layout_attributes"),S=d("../../../lib/extend").extendFlat,M=d("../../../plot_api/edit_types").overrideAll;ee.exports=M({visible:g.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:A.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:g.color,categoryorder:g.categoryorder,categoryarray:g.categoryarray,title:{text:g.title.text,font:g.title.font},type:S({},g.type,{values:["-","linear","log","date","category"]}),autotypenumbers:g.autotypenumbers,autorange:g.autorange,rangemode:g.rangemode,range:S({},g.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:g.tickmode,nticks:g.nticks,tick0:g.tick0,dtick:g.dtick,tickvals:g.tickvals,ticktext:g.ticktext,ticks:g.ticks,mirror:g.mirror,ticklen:g.ticklen,tickwidth:g.tickwidth,tickcolor:g.tickcolor,showticklabels:g.showticklabels,tickfont:g.tickfont,tickangle:g.tickangle,tickprefix:g.tickprefix,showtickprefix:g.showtickprefix,ticksuffix:g.ticksuffix,showticksuffix:g.showticksuffix,showexponent:g.showexponent,exponentformat:g.exponentformat,minexponent:g.minexponent,separatethousands:g.separatethousands,tickformat:g.tickformat,tickformatstops:g.tickformatstops,hoverformat:g.hoverformat,showline:g.showline,linecolor:g.linecolor,linewidth:g.linewidth,showgrid:g.showgrid,gridcolor:S({},g.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:g.gridwidth,zeroline:g.zeroline,zerolinecolor:g.zerolinecolor,zerolinewidth:g.zerolinewidth,_deprecated:{title:g._deprecated.title,titlefont:g._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":367,"../../../lib/extend":505,"../../../plot_api/edit_types":548,"../../cartesian/layout_attributes":579}],610:[function(d,ee,te){var A=d("tinycolor2").mix,g=d("../../../lib"),S=d("../../../plot_api/plot_template"),M=d("./axis_attributes"),e=d("../../cartesian/type_defaults"),a=d("../../cartesian/axis_defaults"),n=["xaxis","yaxis","zaxis"],r=100*(204-68)/(255-68);ee.exports=function(c,s,i){var x,p;function v(o,m){return g.coerce(x,p,M,o,m)}for(var f=0;f<n.length;f++){var y=n[f];x=c[y]||{},p=S.newContainer(s,y),p._id=y[0]+i.scene,p._name=y,e(x,p,v,i),a(x,p,v,{font:i.font,letter:y[0],data:i.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelstep:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:i.bgColor,calendar:i.calendar},i.fullLayout),v("gridcolor",A(p.color,i.bgColor,r).toRgbString()),v("title.text",y[0]),p.setScale=g.noop,v("showspikes")&&(v("spikesides"),v("spikethickness"),v("spikecolor",p.color)),v("showaxeslabels"),v("showbackground")&&v("backgroundcolor")}}},{"../../../lib":515,"../../../plot_api/plot_template":555,"../../cartesian/axis_defaults":568,"../../cartesian/type_defaults":591,"./axis_attributes":609,tinycolor2:313}],611:[function(d,ee,te){var A=d("../../../lib/str2rgbarray"),g=d("../../../lib"),S=["xaxis","yaxis","zaxis"];function M(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}var e=M.prototype;e.merge=function(n,r){for(var t=this,c=0;c<3;++c){var s=r[S[c]];if(!s.visible){t.tickEnable[c]=!1,t.labelEnable[c]=!1,t.lineEnable[c]=!1,t.lineTickEnable[c]=!1,t.gridEnable[c]=!1,t.zeroEnable[c]=!1,t.backgroundEnable[c]=!1;continue}t.labels[c]=n._meta?g.templateString(s.title.text,n._meta):s.title.text,"font"in s.title&&(s.title.font.color&&(t.labelColor[c]=A(s.title.font.color)),s.title.font.family&&(t.labelFont[c]=s.title.font.family),s.title.font.size&&(t.labelSize[c]=s.title.font.size)),"showline"in s&&(t.lineEnable[c]=s.showline),"linecolor"in s&&(t.lineColor[c]=A(s.linecolor)),"linewidth"in s&&(t.lineWidth[c]=s.linewidth),"showgrid"in s&&(t.gridEnable[c]=s.showgrid),"gridcolor"in s&&(t.gridColor[c]=A(s.gridcolor)),"gridwidth"in s&&(t.gridWidth[c]=s.gridwidth),s.type==="log"?t.zeroEnable[c]=!1:"zeroline"in s&&(t.zeroEnable[c]=s.zeroline),"zerolinecolor"in s&&(t.zeroLineColor[c]=A(s.zerolinecolor)),"zerolinewidth"in s&&(t.zeroLineWidth[c]=s.zerolinewidth),"ticks"in s&&!!s.ticks?t.lineTickEnable[c]=!0:t.lineTickEnable[c]=!1,"ticklen"in s&&(t.lineTickLength[c]=t._defaultLineTickLength[c]=s.ticklen),"tickcolor"in s&&(t.lineTickColor[c]=A(s.tickcolor)),"tickwidth"in s&&(t.lineTickWidth[c]=s.tickwidth),"tickangle"in s&&(t.tickAngle[c]=s.tickangle==="auto"?-3600:Math.PI*-s.tickangle/180),"showticklabels"in s&&(t.tickEnable[c]=s.showticklabels),"tickfont"in s&&(s.tickfont.color&&(t.tickColor[c]=A(s.tickfont.color)),s.tickfont.family&&(t.tickFont[c]=s.tickfont.family),s.tickfont.size&&(t.tickSize[c]=s.tickfont.size)),"mirror"in s?["ticks","all","allticks"].indexOf(s.mirror)!==-1?(t.lineTickMirror[c]=!0,t.lineMirror[c]=!0):s.mirror===!0?(t.lineTickMirror[c]=!1,t.lineMirror[c]=!0):(t.lineTickMirror[c]=!1,t.lineMirror[c]=!1):t.lineMirror[c]=!1,"showbackground"in s&&s.showbackground!==!1?(t.backgroundEnable[c]=!0,t.backgroundColor[c]=A(s.backgroundcolor)):t.backgroundEnable[c]=!1}};function a(n,r){var t=new M;return t.merge(n,r),t}ee.exports=a},{"../../../lib":515,"../../../lib/str2rgbarray":540}],612:[function(d,ee,te){var A=d("../../../lib"),g=d("../../../components/color"),S=d("../../../registry"),M=d("../../subplot_defaults"),e=d("./axis_defaults"),a=d("./layout_attributes"),n=d("../../get_data").getSubplotData,r="gl3d";ee.exports=function(s,i,x){var p=i._basePlotModules.length>1;function v(f){if(!p){var y=A.validate(s[f],a[f]);if(y)return s[f]}}M(s,i,x,{type:r,attributes:a,handleDefaults:t,fullLayout:i,font:i.font,fullData:x,getDfltFromLayout:v,autotypenumbersDflt:i.autotypenumbers,paper_bgcolor:i.paper_bgcolor,calendar:i.calendar})};function t(c,s,i,x){for(var p=i("bgcolor"),v=g.combine(p,x.paper_bgcolor),f=["up","center","eye"],y=0;y<f.length;y++)i("camera."+f[y]+".x"),i("camera."+f[y]+".y"),i("camera."+f[y]+".z");i("camera.projection.type");var o=!!i("aspectratio.x")&&!!i("aspectratio.y")&&!!i("aspectratio.z"),m=o?"manual":"auto",l=i("aspectmode",m);o||(c.aspectratio=s.aspectratio={x:1,y:1,z:1},l==="manual"&&(s.aspectmode="auto"),c.aspectmode=s.aspectmode);var w=n(x.fullData,r,x.id);e(c,s,{font:x.font,scene:x.id,data:w,bgColor:v,calendar:x.calendar,autotypenumbersDflt:x.autotypenumbersDflt,fullLayout:x.fullLayout}),S.getComponentMethod("annotations3d","handleDefaults")(c,s,x);var _=x.getDfltFromLayout("dragmode");if(_!==!1&&!_)if(_="orbit",c.camera&&c.camera.up){var h=c.camera.up.x,b=c.camera.up.y,u=c.camera.up.z;u!==0&&(!h||!b||!u||u/Math.sqrt(h*h+b*b+u*u)>.999)&&(_="turntable")}else _="turntable";i("dragmode",_),i("hovermode",x.getDfltFromLayout("hovermode"))}},{"../../../components/color":367,"../../../lib":515,"../../../registry":647,"../../get_data":602,"../../subplot_defaults":641,"./axis_defaults":610,"./layout_attributes":613}],613:[function(d,ee,te){var A=d("./axis_attributes"),g=d("../../domain").attributes,S=d("../../../lib/extend").extendFlat,M=d("../../../lib").counterRegex;function e(a,n,r){return{x:{valType:"number",dflt:a,editType:"camera"},y:{valType:"number",dflt:n,editType:"camera"},z:{valType:"number",dflt:r,editType:"camera"},editType:"camera"}}ee.exports={_arrayAttrRegexps:[M("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:S(e(0,0,1),{}),center:S(e(0,0,0),{}),eye:S(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:g({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:A,yaxis:A,zaxis:A,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":515,"../../../lib/extend":505,"../../domain":593,"./axis_attributes":609}],614:[function(d,ee,te){var A=d("../../../lib/str2rgbarray"),g=["xaxis","yaxis","zaxis"];function S(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}var M=S.prototype;M.merge=function(a){for(var n=0;n<3;++n){var r=a[g[n]];if(!r.visible){this.enabled[n]=!1,this.drawSides[n]=!1;continue}this.enabled[n]=r.showspikes,this.colors[n]=A(r.spikecolor),this.drawSides[n]=r.spikesides,this.lineWidth[n]=r.spikethickness}};function e(a){var n=new S;return n.merge(a),n}ee.exports=e},{"../../../lib/str2rgbarray":540}],615:[function(d,ee,te){ee.exports=e;var A=d("../../cartesian/axes"),g=d("../../../lib"),S=["xaxis","yaxis","zaxis"];function M(a){for(var n=new Array(3),r=0;r<3;++r){for(var t=a[r],c=new Array(t.length),s=0;s<t.length;++s)c[s]=t[s].x;n[r]=c}return n}function e(a){for(var n=a.axesOptions,r=a.glplot.axesPixels,t=a.fullSceneLayout,c=[[],[],[]],s=0;s<3;++s){var i=t[S[s]];if(i._length=(r[s].hi-r[s].lo)*r[s].pixelsPerDataUnit/a.dataScale[s],Math.abs(i._length)===1/0||isNaN(i._length))c[s]=[];else{i._input_range=i.range.slice(),i.range[0]=r[s].lo/a.dataScale[s],i.range[1]=r[s].hi/a.dataScale[s],i._m=1/(a.dataScale[s]*r[s].pixelsPerDataUnit),i.range[0]===i.range[1]&&(i.range[0]-=1,i.range[1]+=1);var x=i.tickmode;if(i.tickmode==="auto"){i.tickmode="linear";var p=i.nticks||g.constrain(i._length/40,4,9);A.autoTicks(i,Math.abs(i.range[1]-i.range[0])/p)}for(var v=A.calcTicks(i,{msUTC:!0}),f=0;f<v.length;++f)v[f].x=v[f].x*a.dataScale[s],i.type==="date"&&(v[f].text=v[f].text.replace(/\<br\>/g," "));c[s]=v,i.tickmode=x}}n.ticks=c;for(var s=0;s<3;++s){.5*(a.glplot.bounds[0][s]+a.glplot.bounds[1][s]);for(var f=0;f<2;++f)n.bounds[f][s]=a.glplot.bounds[f][s]}a.contourLevels=M(c)}},{"../../../lib":515,"../../cartesian/axes":566}],616:[function(d,ee,te){function A(S,M){var e=[0,0,0,0],a,n;for(a=0;a<4;++a)for(n=0;n<4;++n)e[n]+=S[4*a+n]*M[a];return e}function g(S,M){var e=A(S.projection,A(S.view,A(S.model,[M[0],M[1],M[2],1])));return e}ee.exports=g},{}],617:[function(d,ee,te){var A=d("../../../stackgl_modules").gl_plot3d,g=A.createCamera,S=A.createScene,M=d("webgl-context"),e=d("has-passive-events"),a=d("../../registry"),n=d("../../lib"),r=n.preserveDrawingBuffer(),t=d("../../plots/cartesian/axes"),c=d("../../components/fx"),s=d("../../lib/str2rgbarray"),i=d("../../lib/show_no_webgl_msg"),x=d("./project"),p=d("./layout/convert"),v=d("./layout/spikes"),f=d("./layout/tick_marks"),y,o;function m(P,z){var I=document.createElement("div"),D=P.container;this.graphDiv=P.graphDiv;var R=document.createElementNS("http://www.w3.org/2000/svg","svg");R.style.position="absolute",R.style.top=R.style.left="0px",R.style.width=R.style.height="100%",R.style["z-index"]=20,R.style["pointer-events"]="none",I.appendChild(R),this.svgContainer=R,I.id=P.id,I.style.position="absolute",I.style.top=I.style.left="0px",I.style.width=I.style.height="100%",D.appendChild(I),this.fullLayout=z,this.id=P.id||"scene",this.fullSceneLayout=z[this.id],this.plotArgs=[[],{},{}],this.axesOptions=p(z,z[this.id]),this.spikeOptions=v(z[this.id]),this.container=I,this.staticMode=!!P.staticPlot,this.pixelRatio=this.pixelRatio||P.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=a.getComponentMethod("annotations3d","convert"),this.drawAnnotations=a.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var l=m.prototype;l.prepareOptions=function(){var P=this,z={canvas:P.canvas,gl:P.gl,glOptions:{preserveDrawingBuffer:r,premultipliedAlpha:!0,antialias:!0},container:P.container,axes:P.axesOptions,spikes:P.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:P.camera,pixelRatio:P.pixelRatio};if(P.staticMode){if(!o&&(y=document.createElement("canvas"),o=M({canvas:y,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}),!o))throw new Error("error creating static canvas/context for image server");z.gl=o,z.canvas=y}return z};var w=!0;l.tryCreatePlot=function(){var P=this,z=P.prepareOptions(),I=!0;try{P.glplot=S(z)}catch{if(P.staticMode||!w||r)I=!1;else{n.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{r=z.glOptions.preserveDrawingBuffer=!0,P.glplot=S(z)}catch{r=z.glOptions.preserveDrawingBuffer=!1,I=!1}}}return w=!1,I},l.initializeGLCamera=function(){var P=this,z=P.fullSceneLayout.camera,I=z.projection.type==="orthographic";P.camera=g(P.container,{center:[z.center.x,z.center.y,z.center.z],eye:[z.eye.x,z.eye.y,z.eye.z],up:[z.up.x,z.up.y,z.up.z],_ortho:I,zoomMin:.01,zoomMax:100,mode:"orbit"})},l.initializeGLPlot=function(){var P=this;P.initializeGLCamera();var z=P.tryCreatePlot();if(!z)return i(P);P.traces={},P.make4thDimension();var I=P.graphDiv,D=I.layout,R=function(){var F={};return P.isCameraChanged(D)&&(F[P.id+".camera"]=P.getCamera()),P.isAspectChanged(D)&&(F[P.id+".aspectratio"]=P.glplot.getAspectratio(),D[P.id].aspectmode!=="manual"&&(P.fullSceneLayout.aspectmode=D[P.id].aspectmode=F[P.id+".aspectmode"]="manual")),F},O=function(F){if(F.fullSceneLayout.dragmode!==!1){var N=R();F.saveLayout(D),F.graphDiv.emit("plotly_relayout",N)}};return P.glplot.canvas&&(P.glplot.canvas.addEventListener("mouseup",function(){O(P)}),P.glplot.canvas.addEventListener("wheel",function(F){if(I._context._scrollZoom.gl3d){if(P.camera._ortho){var N=F.deltaX>F.deltaY?1.1:.9090909090909091,G=P.glplot.getAspectratio();P.glplot.setAspectratio({x:N*G.x,y:N*G.y,z:N*G.z})}O(P)}},e?{passive:!1}:!1),P.glplot.canvas.addEventListener("mousemove",function(){if(P.fullSceneLayout.dragmode!==!1&&P.camera.mouseListener.buttons!==0){var F=R();P.graphDiv.emit("plotly_relayouting",F)}}),P.staticMode||P.glplot.canvas.addEventListener("webglcontextlost",function(F){I&&I.emit&&I.emit("plotly_webglcontextlost",{event:F,layer:P.id})},!1)),P.glplot.oncontextloss=function(){P.recoverContext()},P.glplot.onrender=function(){P.render()},!0},l.render=function(){var P=this,z=P.graphDiv,I,D=P.svgContainer,R=P.container.getBoundingClientRect();z._fullLayout._calcInverseTransform(z);var O=z._fullLayout._invScaleX,F=z._fullLayout._invScaleY,N=R.width*O,G=R.height*F;D.setAttributeNS(null,"viewBox","0 0 "+N+" "+G),D.setAttributeNS(null,"width",N),D.setAttributeNS(null,"height",G),f(P),P.glplot.axes.update(P.axesOptions);for(var K=Object.keys(P.traces),W=null,Y=P.glplot.selection,re=0;re<K.length;++re)I=P.traces[K[re]],I.data.hoverinfo!=="skip"&&I.handlePick(Y)&&(W=I),I.setContourLevels&&I.setContourLevels();function ue(be,ce,de){var ye=P.fullSceneLayout[be+"axis"];return ye.type!=="log"&&(ce=ye.d2l(ce)),t.hoverLabelText(ye,ce,de)}if(W!==null){var j=x(P.glplot.cameraParams,Y.dataCoordinate);I=W.data;var q=z._fullData[I.index],V=Y.index,U={xLabel:ue("x",Y.traceCoordinate[0],I.xhoverformat),yLabel:ue("y",Y.traceCoordinate[1],I.yhoverformat),zLabel:ue("z",Y.traceCoordinate[2],I.zhoverformat)},$=c.castHoverinfo(q,P.fullLayout,V),ne=($||"").split("+"),X=$&&$==="all";!q.hovertemplate&&!X&&(ne.indexOf("x")===-1&&(U.xLabel=void 0),ne.indexOf("y")===-1&&(U.yLabel=void 0),ne.indexOf("z")===-1&&(U.zLabel=void 0),ne.indexOf("text")===-1&&(Y.textLabel=void 0),ne.indexOf("name")===-1&&(W.name=void 0));var Q,ie=[];I.type==="cone"||I.type==="streamtube"?(U.uLabel=ue("x",Y.traceCoordinate[3],I.uhoverformat),(X||ne.indexOf("u")!==-1)&&ie.push("u: "+U.uLabel),U.vLabel=ue("y",Y.traceCoordinate[4],I.vhoverformat),(X||ne.indexOf("v")!==-1)&&ie.push("v: "+U.vLabel),U.wLabel=ue("z",Y.traceCoordinate[5],I.whoverformat),(X||ne.indexOf("w")!==-1)&&ie.push("w: "+U.wLabel),U.normLabel=Y.traceCoordinate[6].toPrecision(3),(X||ne.indexOf("norm")!==-1)&&ie.push("norm: "+U.normLabel),I.type==="streamtube"&&(U.divergenceLabel=Y.traceCoordinate[7].toPrecision(3),(X||ne.indexOf("divergence")!==-1)&&ie.push("divergence: "+U.divergenceLabel)),Y.textLabel&&ie.push(Y.textLabel),Q=ie.join("<br>")):I.type==="isosurface"||I.type==="volume"?(U.valueLabel=t.hoverLabelText(P._mockAxis,P._mockAxis.d2l(Y.traceCoordinate[3]),I.valuehoverformat),ie.push("value: "+U.valueLabel),Y.textLabel&&ie.push(Y.textLabel),Q=ie.join("<br>")):Q=Y.textLabel;var se={x:Y.traceCoordinate[0],y:Y.traceCoordinate[1],z:Y.traceCoordinate[2],data:q._input,fullData:q,curveNumber:q.index,pointNumber:V};c.appendArrayPointValue(se,q,V),I._module.eventData&&(se=q._module.eventData(se,Y,q,{},V));var ae={points:[se]};if(P.fullSceneLayout.hovermode){var oe=[];c.loneHover({trace:q,x:(.5+.5*j[0]/j[3])*N,y:(.5-.5*j[1]/j[3])*G,xLabel:U.xLabel,yLabel:U.yLabel,zLabel:U.zLabel,text:Q,name:W.name,color:c.castHoverOption(q,V,"bgcolor")||W.color,borderColor:c.castHoverOption(q,V,"bordercolor"),fontFamily:c.castHoverOption(q,V,"font.family"),fontSize:c.castHoverOption(q,V,"font.size"),fontColor:c.castHoverOption(q,V,"font.color"),nameLength:c.castHoverOption(q,V,"namelength"),textAlign:c.castHoverOption(q,V,"align"),hovertemplate:n.castOption(q,V,"hovertemplate"),hovertemplateLabels:n.extendFlat({},se,U),eventData:[se]},{container:D,gd:z,inOut_bbox:oe}),se.bbox=oe[0]}Y.buttons&&Y.distance<5?z.emit("plotly_click",ae):z.emit("plotly_hover",ae),this.oldEventData=ae}else c.loneUnhover(D),this.oldEventData&&z.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;P.drawAnnotations(P)},l.recoverContext=function(){var P=this;P.glplot.dispose();var z=function(){if(P.glplot.gl.isContextLost()){requestAnimationFrame(z);return}if(!P.initializeGLPlot()){n.error("Catastrophic and unrecoverable WebGL error. Context lost.");return}P.plot.apply(P,P.plotArgs)};requestAnimationFrame(z)};var _=["xaxis","yaxis","zaxis"];function h(P,z,I){for(var D=P.fullSceneLayout,R=0;R<3;R++){var O=_[R],F=O.charAt(0),N=D[O],G=z[F],K=z[F+"calendar"],W=z["_"+F+"length"];if(!n.isArrayOrTypedArray(G))I[0][R]=Math.min(I[0][R],0),I[1][R]=Math.max(I[1][R],W-1);else for(var Y,re=0;re<(W||G.length);re++)if(n.isArrayOrTypedArray(G[re]))for(var ue=0;ue<G[re].length;++ue)Y=N.d2l(G[re][ue],0,K),!isNaN(Y)&&isFinite(Y)&&(I[0][R]=Math.min(I[0][R],Y),I[1][R]=Math.max(I[1][R],Y));else Y=N.d2l(G[re],0,K),!isNaN(Y)&&isFinite(Y)&&(I[0][R]=Math.min(I[0][R],Y),I[1][R]=Math.max(I[1][R],Y))}}function b(P,z){for(var I=P.fullSceneLayout,D=I.annotations||[],R=0;R<3;R++)for(var O=_[R],F=O.charAt(0),N=I[O],G=0;G<D.length;G++){var K=D[G];if(K.visible){var W=N.r2l(K[F]);!isNaN(W)&&isFinite(W)&&(z[0][R]=Math.min(z[0][R],W),z[1][R]=Math.max(z[1][R],W))}}}l.plot=function(P,z,I){var D=this;if(D.plotArgs=[P,z,I],D.glplot.contextLost)return;var R,O,F,N,G,K,W=z[D.id],Y=I[D.id];D.fullLayout=z,D.fullSceneLayout=W,D.axesOptions.merge(z,W),D.spikeOptions.merge(W),D.setViewport(W),D.updateFx(W.dragmode,W.hovermode),D.camera.enableWheel=D.graphDiv._context._scrollZoom.gl3d,D.glplot.setClearColor(s(W.bgcolor)),D.setConvert(G),P?Array.isArray(P)||(P=[P]):P=[];var re=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(F=0;F<P.length;++F)R=P[F],!(R.visible!==!0||R._length===0)&&h(this,R,re);b(this,re);var ue=[1,1,1];for(N=0;N<3;++N)re[1][N]===re[0][N]?ue[N]=1:ue[N]=1/(re[1][N]-re[0][N]);for(D.dataScale=ue,D.convertAnnotations(this),F=0;F<P.length;++F)R=P[F],!(R.visible!==!0||R._length===0)&&(O=D.traces[R.uid],O?O.data.type===R.type?O.update(R):(O.dispose(),O=R._module.plot(this,R),D.traces[R.uid]=O):(O=R._module.plot(this,R),D.traces[R.uid]=O),O.name=R.name);var j=Object.keys(D.traces);e:for(F=0;F<j.length;++F){for(N=0;N<P.length;++N)if(P[N].uid===j[F]&&P[N].visible===!0&&P[N]._length!==0)continue e;O=D.traces[j[F]],O.dispose(),delete D.traces[j[F]]}D.glplot.objects.sort(function(ke,Xe){return ke._trace.data.index-Xe._trace.data.index});var q=[[0,0,0],[0,0,0]],V={};for(F=0;F<3;++F){if(G=W[_[F]],K=G.type,K in V?(V[K].acc*=ue[F],V[K].count+=1):V[K]={acc:ue[F],count:1},G.autorange){q[0][F]=1/0,q[1][F]=-1/0;var U=D.glplot.objects,$=D.fullSceneLayout.annotations||[],ne=G._name.charAt(0);for(N=0;N<U.length;N++){var X=U[N],Q=X.bounds,ie=X._trace.data._pad||0;X.constructor.name==="ErrorBars"&&G._lowerLogErrorBound?q[0][F]=Math.min(q[0][F],G._lowerLogErrorBound):q[0][F]=Math.min(q[0][F],Q[0][F]/ue[F]-ie),q[1][F]=Math.max(q[1][F],Q[1][F]/ue[F]+ie)}for(N=0;N<$.length;N++){var se=$[N];if(se.visible){var ae=G.r2l(se[ne]);q[0][F]=Math.min(q[0][F],ae),q[1][F]=Math.max(q[1][F],ae)}}if("rangemode"in G&&G.rangemode==="tozero"&&(q[0][F]=Math.min(q[0][F],0),q[1][F]=Math.max(q[1][F],0)),q[0][F]>q[1][F])q[0][F]=-1,q[1][F]=1;else{var oe=q[1][F]-q[0][F];q[0][F]-=oe/32,q[1][F]+=oe/32}if(G.autorange==="reversed"){var be=q[0][F];q[0][F]=q[1][F],q[1][F]=be}}else{var ce=G.range;q[0][F]=G.r2l(ce[0]),q[1][F]=G.r2l(ce[1])}q[0][F]===q[1][F]&&(q[0][F]-=1,q[1][F]+=1),D.glplot.setBounds(F,{min:q[0][F]*ue[F],max:q[1][F]*ue[F]})}var de,ye=W.aspectmode;if(ye==="cube")de=[1,1,1];else if(ye==="manual"){var ge=W.aspectratio;de=[ge.x,ge.y,ge.z]}else if(ye==="auto"||ye==="data"){var me=[1,1,1];for(F=0;F<3;++F){G=W[_[F]],K=G.type;var Ee=V[K];me[F]=Math.pow(Ee.acc,1/Ee.count)/ue[F]}ye==="data"||Math.max.apply(null,me)/Math.min.apply(null,me)<=4?de=me:de=[1,1,1]}else throw new Error("scene.js aspectRatio was not one of the enumerated types");W.aspectratio.x=Y.aspectratio.x=de[0],W.aspectratio.y=Y.aspectratio.y=de[1],W.aspectratio.z=Y.aspectratio.z=de[2],D.glplot.setAspectratio(W.aspectratio),D.viewInitial.aspectratio||(D.viewInitial.aspectratio={x:W.aspectratio.x,y:W.aspectratio.y,z:W.aspectratio.z}),D.viewInitial.aspectmode||(D.viewInitial.aspectmode=W.aspectmode);var Pe=W.domain||null,Ne=z._size||null;if(Pe&&Ne){var we=D.container.style;we.position="absolute",we.left=Ne.l+Pe.x[0]*Ne.w+"px",we.top=Ne.t+(1-Pe.y[1])*Ne.h+"px",we.width=Ne.w*(Pe.x[1]-Pe.x[0])+"px",we.height=Ne.h*(Pe.y[1]-Pe.y[0])+"px"}D.glplot.redraw()},l.destroy=function(){var P=this;!P.glplot||(P.camera.mouseListener.enabled=!1,P.container.removeEventListener("wheel",P.camera.wheelListener),P.camera=null,P.glplot.dispose(),P.container.parentNode.removeChild(P.container),P.glplot=null)};function u(P){return[[P.eye.x,P.eye.y,P.eye.z],[P.center.x,P.center.y,P.center.z],[P.up.x,P.up.y,P.up.z]]}function L(P){return{up:{x:P.up[0],y:P.up[1],z:P.up[2]},center:{x:P.center[0],y:P.center[1],z:P.center[2]},eye:{x:P.eye[0],y:P.eye[1],z:P.eye[2]},projection:{type:P._ortho===!0?"orthographic":"perspective"}}}l.getCamera=function(){var P=this;return P.camera.view.recalcMatrix(P.camera.view.lastT()),L(P.camera)},l.setViewport=function(P){var z=this,I=P.camera;z.camera.lookAt.apply(this,u(I)),z.glplot.setAspectratio(P.aspectratio);var D=I.projection.type==="orthographic",R=z.camera._ortho;D!==R&&(z.glplot.redraw(),z.glplot.clearRGBA(),z.glplot.dispose(),z.initializeGLPlot())},l.isCameraChanged=function(P){var z=this,I=z.getCamera(),D=n.nestedProperty(P,z.id+".camera"),R=D.get();function O(K,W,Y,re){var ue=["up","center","eye"],j=["x","y","z"];return W[ue[Y]]&&K[ue[Y]][j[re]]===W[ue[Y]][j[re]]}var F=!1;if(R===void 0)F=!0;else{for(var N=0;N<3;N++)for(var G=0;G<3;G++)if(!O(I,R,N,G)){F=!0;break}(!R.projection||I.projection&&I.projection.type!==R.projection.type)&&(F=!0)}return F},l.isAspectChanged=function(P){var z=this,I=z.glplot.getAspectratio(),D=n.nestedProperty(P,z.id+".aspectratio"),R=D.get();return R===void 0||R.x!==I.x||R.y!==I.y||R.z!==I.z},l.saveLayout=function(P){var z=this,I=z.fullLayout,D,R,O,F,N,G,K=z.isCameraChanged(P),W=z.isAspectChanged(P),Y=K||W;if(Y){var re={};if(K&&(D=z.getCamera(),R=n.nestedProperty(P,z.id+".camera"),O=R.get(),re[z.id+".camera"]=O),W&&(F=z.glplot.getAspectratio(),N=n.nestedProperty(P,z.id+".aspectratio"),G=N.get(),re[z.id+".aspectratio"]=G),a.call("_storeDirectGUIEdit",P,I._preGUI,re),K){R.set(D);var ue=n.nestedProperty(I,z.id+".camera");ue.set(D)}if(W){N.set(F);var j=n.nestedProperty(I,z.id+".aspectratio");j.set(F),z.glplot.redraw()}}return Y},l.updateFx=function(P,z){var I=this,D=I.camera;if(D)if(P==="orbit")D.mode="orbit",D.keyBindingMode="rotate";else if(P==="turntable"){D.up=[0,0,1],D.mode="turntable",D.keyBindingMode="rotate";var R=I.graphDiv,O=R._fullLayout,F=I.fullSceneLayout.camera,N=F.up.x,G=F.up.y,K=F.up.z;if(K/Math.sqrt(N*N+G*G+K*K)<.999){var W=I.id+".camera.up",Y={x:0,y:0,z:1},re={};re[W]=Y;var ue=R.layout;a.call("_storeDirectGUIEdit",ue,O._preGUI,re),F.up=Y,n.nestedProperty(ue,W).set(Y)}}else D.keyBindingMode=P;I.fullSceneLayout.hovermode=z};function T(P,z,I){for(var D=0,R=I-1;D<R;++D,--R)for(var O=0;O<z;++O)for(var F=0;F<4;++F){var N=4*(z*D+O)+F,G=4*(z*R+O)+F,K=P[N];P[N]=P[G],P[G]=K}}function k(P,z,I){for(var D=0;D<I;++D)for(var R=0;R<z;++R){var O=4*(z*D+R),F=P[O+3];if(F>0)for(var N=255/F,G=0;G<3;++G)P[O+G]=Math.min(N*P[O+G],255)}}l.toImage=function(P){var z=this;P||(P="png"),z.staticMode&&z.container.appendChild(y),z.glplot.redraw();var I=z.glplot.gl,D=I.drawingBufferWidth,R=I.drawingBufferHeight;I.bindFramebuffer(I.FRAMEBUFFER,null);var O=new Uint8Array(D*R*4);I.readPixels(0,0,D,R,I.RGBA,I.UNSIGNED_BYTE,O),T(O,D,R),k(O,D,R);var F=document.createElement("canvas");F.width=D,F.height=R;var N=F.getContext("2d",{willReadFrequently:!0}),G=N.createImageData(D,R);G.data.set(O),N.putImageData(G,0,0);var K;switch(P){case"jpeg":K=F.toDataURL("image/jpeg");break;case"webp":K=F.toDataURL("image/webp");break;default:K=F.toDataURL("image/png")}return z.staticMode&&z.container.removeChild(y),K},l.setConvert=function(){for(var P=this,z=0;z<3;z++){var I=P.fullSceneLayout[_[z]];t.setConvert(I,P.fullLayout),I.setScale=n.noop}},l.make4thDimension=function(){var P=this,z=P.graphDiv,I=z._fullLayout;P._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},t.setConvert(P._mockAxis,I)},ee.exports=m},{"../../../stackgl_modules":1133,"../../components/fx":407,"../../lib":515,"../../lib/show_no_webgl_msg":537,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../../registry":647,"./layout/convert":611,"./layout/spikes":614,"./layout/tick_marks":615,"./project":616,"has-passive-events":229,"webgl-context":332}],618:[function(d,ee,te){ee.exports=function(g,S,M,e){e=e||g.length;for(var a=new Array(e),n=0;n<e;n++)a[n]=[g[n],S[n],M[n]];return a}},{}],619:[function(d,ee,te){var A=d("./font_attributes"),g=d("./animation_attributes"),S=d("../components/color/attributes"),M=d("../components/shapes/draw_newshape/attributes"),e=d("../components/selections/draw_newselection/attributes"),a=d("./pad_attributes"),n=d("../lib/extend").extendFlat,r=A({editType:"calc"});r.family.dflt='"Open Sans", verdana, arial, sans-serif',r.size.dflt=12,r.color.dflt=S.defaultLine,ee.exports={font:r,title:{text:{valType:"string",editType:"layoutstyle"},font:A({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:n(a({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},minreducedwidth:{valType:"number",min:2,dflt:64,editType:"plot"},minreducedheight:{valType:"number",min:2,dflt:64,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:S.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:S.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:S.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:M.newshape,activeshape:M.activeshape,newselection:e.newselection,activeselection:e.activeselection,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:n({},g.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:A({editType:"layoutstyle"})}}},{"../components/color/attributes":366,"../components/selections/draw_newselection/attributes":451,"../components/shapes/draw_newshape/attributes":463,"../lib/extend":505,"./animation_attributes":560,"./font_attributes":594,"./pad_attributes":627}],620:[function(d,ee,te){var A=d("../../lib/sort_object_keys"),g="1.10.1",S='\xA9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',M=['\xA9 <a target="_blank" href="https://carto.com/">Carto</a>',S].join(" "),e=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),a=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),n={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:S,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:M,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:M,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:e,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:e,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:a,tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},r=A(n);ee.exports={requiredVersion:g,styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:n,styleValuesNonMapbox:r,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@"+g+"."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",r.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{"../../lib/sort_object_keys":538}],621:[function(d,ee,te){var A=d("../../lib");ee.exports=function(S,M){var e=S.split(" "),a=e[0],n=e[1],r=A.isArrayOrTypedArray(M)?A.mean(M):M,t=.5+r/100,c=1.5+r/100,s=["",""],i=[0,0];switch(a){case"top":s[0]="top",i[1]=-c;break;case"bottom":s[0]="bottom",i[1]=c;break}switch(n){case"left":s[1]="right",i[0]=-t;break;case"right":s[1]="left",i[0]=t;break}var x;return s[0]&&s[1]?x=s.join("-"):s[0]?x=s[0]:s[1]?x=s[1]:x="center",{anchor:x,offset:i}}},{"../../lib":515}],622:[function(d,ee,te){var A=d("mapbox-gl/dist/mapbox-gl-unminified"),g=d("../../lib"),S=g.strTranslate,M=g.strScale,e=d("../../plots/get_data").getSubplotCalcData,a=d("../../constants/xmlns_namespaces"),n=d("@plotly/d3"),r=d("../../components/drawing"),t=d("../../lib/svg_text_utils"),c=d("./mapbox"),s="mapbox",i=te.constants=d("./constants");te.name=s,te.attr="subplot",te.idRoot=s,te.idRegex=te.attrRegex=g.counterRegex(s),te.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},te.layoutAttributes=d("./layout_attributes"),te.supplyLayoutDefaults=d("./layout_defaults"),te.plot=function(f){var y=f._fullLayout,o=f.calcdata,m=y._subplots[s];if(A.version!==i.requiredVersion)throw new Error(i.wrongVersionErrorMsg);var l=x(f,m);A.accessToken=l;for(var w=0;w<m.length;w++){var _=m[w],h=e(o,s,_),b=y[_],u=b._subplot;u||(u=new c(f,_),y[_]._subplot=u),u.viewInitial||(u.viewInitial={center:g.extendFlat({},b.center),zoom:b.zoom,bearing:b.bearing,pitch:b.pitch}),u.plot(h,y,f._promises)}},te.clean=function(v,f,y,o){for(var m=o._subplots[s]||[],l=0;l<m.length;l++){var w=m[l];!f[w]&&!!o[w]._subplot&&o[w]._subplot.destroy()}},te.toSVG=function(v){for(var f=v._fullLayout,y=f._subplots[s],o=f._size,m=0;m<y.length;m++){var l=f[y[m]],w=l.domain,_=l._subplot,h=_.toImage("png"),b=f._glimages.append("svg:image");b.attr({xmlns:a.svg,"xlink:href":h,x:o.l+o.w*w.x[0],y:o.t+o.h*(1-w.y[1]),width:o.w*(w.x[1]-w.x[0]),height:o.h*(w.y[1]-w.y[0]),preserveAspectRatio:"none"});var u=n.select(l._subplot.div),L=u.select(".mapboxgl-ctrl-logo").node().offsetParent===null;if(!L){var T=f._glimages.append("g");T.attr("transform",S(o.l+o.w*w.x[0]+10,o.t+o.h*(1-w.y[0])-31)),T.append("path").attr("d",i.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),T.append("path").attr("d",i.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),T.append("path").attr("d",i.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),T.append("polygon").attr("points",i.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var k=u.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),P=f._glimages.append("g"),z=P.append("text");z.text(k).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":k});var I=r.bBox(z.node()),D=o.w*(w.x[1]-w.x[0]);if(I.width>D/2){var R=k.split("|").join("<br>");z.text(R).attr("data-unformatted",R).call(t.convertToTspans,v),I=r.bBox(z.node())}z.attr("transform",S(-3,-I.height+8)),P.insert("rect",".static-attribution").attr({x:-I.width-6,y:-I.height-3,width:I.width+6,height:I.height+3,fill:"rgba(255, 255, 255, 0.75)"});var O=1;I.width+6>D&&(O=D/(I.width+6));var F=[o.l+o.w*w.x[1],o.t+o.h*(1-w.y[0])];P.attr("transform",S(F[0],F[1])+M(O))}};function x(v,f){var y=v._fullLayout,o=v._context;if(o.mapboxAccessToken==="")return"";for(var m=[],l=[],w=!1,_=!1,h=0;h<f.length;h++){var b=y[f[h]],u=b.accesstoken;p(b.style)&&(u?g.pushUnique(m,u):(p(b._input.style)&&(g.error("Uses Mapbox map style, but did not set an access token."),w=!0),_=!0)),u&&g.pushUnique(l,u)}if(_){var L=w?i.noAccessTokenErrorMsg:i.missingStyleErrorMsg;throw g.error(L),new Error(L)}return m.length?(m.length>1&&g.warn(i.multipleTokensErrorMsg),m[0]):(l.length&&g.log(["Listed mapbox access token(s)",l.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}function p(v){return typeof v=="string"&&(i.styleValuesMapbox.indexOf(v)!==-1||v.indexOf("mapbox://")===0)}te.updateFx=function(v){for(var f=v._fullLayout,y=f._subplots[s],o=0;o<y.length;o++){var m=f[y[o]]._subplot;m.updateFx(f)}}},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/get_data":602,"./constants":620,"./layout_attributes":624,"./layout_defaults":625,"./mapbox":626,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],623:[function(d,ee,te){var A=d("../../lib"),g=d("../../lib/svg_text_utils").sanitizeHTML,S=d("./convert_text_opts"),M=d("./constants");function e(c,s){this.subplot=c,this.uid=c.uid+"-"+s,this.index=s,this.idSource="source-"+this.uid,this.idLayer=M.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var a=e.prototype;a.update=function(s){this.visible?this.needsNewImage(s)?this.updateImage(s):this.needsNewSource(s)?(this.removeLayer(),this.updateSource(s),this.updateLayer(s)):this.needsNewLayer(s)?this.updateLayer(s):this.updateStyle(s):(this.updateSource(s),this.updateLayer(s)),this.visible=n(s)},a.needsNewImage=function(c){var s=this.subplot.map;return s.getSource(this.idSource)&&this.sourceType==="image"&&c.sourcetype==="image"&&(this.source!==c.source||JSON.stringify(this.coordinates)!==JSON.stringify(c.coordinates))},a.needsNewSource=function(c){return this.sourceType!==c.sourcetype||JSON.stringify(this.source)!==JSON.stringify(c.source)||this.layerType!==c.type},a.needsNewLayer=function(c){return this.layerType!==c.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},a.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},a.updateImage=function(c){var s=this.subplot.map;s.getSource(this.idSource).updateImage({url:c.source,coordinates:c.coordinates});var i=this.findFollowingMapboxLayerId(this.lookupBelow());i!==null&&this.subplot.map.moveLayer(this.idLayer,i)},a.updateSource=function(c){var s=this.subplot.map;if(s.getSource(this.idSource)&&s.removeSource(this.idSource),this.sourceType=c.sourcetype,this.source=c.source,!!n(c)){var i=t(c);s.addSource(this.idSource,i)}},a.findFollowingMapboxLayerId=function(c){if(c==="traces")for(var s=this.subplot.getMapLayers(),i=0;i<s.length;i++){var x=s[i].id;if(typeof x=="string"&&x.indexOf(M.traceLayerPrefix)===0){c=x;break}}return c},a.updateLayer=function(c){var s=this.subplot,i=r(c),x=this.lookupBelow(),p=this.findFollowingMapboxLayerId(x);this.removeLayer(),n(c)&&s.addLayer({id:this.idLayer,source:this.idSource,"source-layer":c.sourcelayer||"",type:c.type,minzoom:c.minzoom,maxzoom:c.maxzoom,layout:i.layout,paint:i.paint},p),this.layerType=c.type,this.below=x},a.updateStyle=function(c){if(n(c)){var s=r(c);this.subplot.setOptions(this.idLayer,"setLayoutProperty",s.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",s.paint)}},a.removeLayer=function(){var c=this.subplot.map;c.getLayer(this.idLayer)&&c.removeLayer(this.idLayer)},a.dispose=function(){var c=this.subplot.map;c.getLayer(this.idLayer)&&c.removeLayer(this.idLayer),c.getSource(this.idSource)&&c.removeSource(this.idSource)};function n(c){if(!c.visible)return!1;var s=c.source;if(Array.isArray(s)&&s.length>0){for(var i=0;i<s.length;i++)if(typeof s[i]!="string"||s[i].length===0)return!1;return!0}return A.isPlainObject(s)||typeof s=="string"&&s.length>0}function r(c){var s={},i={};switch(c.type){case"circle":A.extendFlat(i,{"circle-radius":c.circle.radius,"circle-color":c.color,"circle-opacity":c.opacity});break;case"line":A.extendFlat(i,{"line-width":c.line.width,"line-color":c.color,"line-opacity":c.opacity,"line-dasharray":c.line.dash});break;case"fill":A.extendFlat(i,{"fill-color":c.color,"fill-outline-color":c.fill.outlinecolor,"fill-opacity":c.opacity});break;case"symbol":var x=c.symbol,p=S(x.textposition,x.iconsize);A.extendFlat(s,{"icon-image":x.icon+"-15","icon-size":x.iconsize/10,"text-field":x.text,"text-size":x.textfont.size,"text-anchor":p.anchor,"text-offset":p.offset,"symbol-placement":x.placement}),A.extendFlat(i,{"icon-color":c.color,"text-color":x.textfont.color,"text-opacity":c.opacity});break;case"raster":A.extendFlat(i,{"raster-fade-duration":0,"raster-opacity":c.opacity});break}return{layout:s,paint:i}}function t(c){var s=c.sourcetype,i=c.source,x={type:s},p;return s==="geojson"?p="data":s==="vector"?p=typeof i=="string"?"url":"tiles":s==="raster"?(p="tiles",x.tileSize=256):s==="image"&&(p="url",x.coordinates=c.coordinates),x[p]=i,c.sourceattribution&&(x.attribution=g(c.sourceattribution)),x}ee.exports=function(s,i,x){var p=new e(s,i);return p.update(x),p}},{"../../lib":515,"../../lib/svg_text_utils":541,"./constants":620,"./convert_text_opts":621}],624:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/color").defaultLine,S=d("../domain").attributes,M=d("../font_attributes"),e=d("../../traces/scatter/attributes").textposition,a=d("../../plot_api/edit_types").overrideAll,n=d("../../plot_api/plot_template").templatedArray,r=d("./constants"),t=M({});t.family.dflt="Open Sans Regular, Arial Unicode MS Regular";var c=ee.exports=a({_arrayAttrRegexps:[A.counterRegex("mapbox",".layers",!0)],domain:S({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:r.styleValuesMapbox.concat(r.styleValuesNonMapbox),dflt:r.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},bounds:{west:{valType:"number"},east:{valType:"number"},south:{valType:"number"},north:{valType:"number"}},layers:n("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:g},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:g}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:t,textposition:A.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root");c.uirevision={valType:"any",editType:"none"}},{"../../components/color":367,"../../lib":515,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../domain":593,"../font_attributes":594,"./constants":620}],625:[function(d,ee,te){var A=d("../../lib"),g=d("../subplot_defaults"),S=d("../array_container_defaults"),M=d("./layout_attributes");ee.exports=function(r,t,c){g(r,t,c,{type:"mapbox",attributes:M,handleDefaults:e,partition:"y",accessToken:t._mapboxAccessToken})};function e(n,r,t,c){t("accesstoken",c.accessToken),t("style"),t("center.lon"),t("center.lat"),t("zoom"),t("bearing"),t("pitch");var s=t("bounds.west"),i=t("bounds.east"),x=t("bounds.south"),p=t("bounds.north");(s===void 0||i===void 0||x===void 0||p===void 0)&&delete r.bounds,S(n,r,{name:"layers",handleItemDefaults:a}),r._input=n}function a(n,r){function t(v,f){return A.coerce(n,r,M.layers,v,f)}var c=t("visible");if(c){var s=t("sourcetype"),i=s==="raster"||s==="image";t("source"),t("sourceattribution"),s==="vector"&&t("sourcelayer"),s==="image"&&t("coordinates");var x;i&&(x="raster");var p=t("type",x);i&&p!=="raster"&&(p=r.type="raster",A.log("Source types *raster* and *image* must drawn *raster* layer type.")),t("below"),t("color"),t("opacity"),t("minzoom"),t("maxzoom"),p==="circle"&&t("circle.radius"),p==="line"&&(t("line.width"),t("line.dash")),p==="fill"&&t("fill.outlinecolor"),p==="symbol"&&(t("symbol.icon"),t("symbol.iconsize"),t("symbol.text"),A.coerceFont(t,"symbol.textfont"),t("symbol.textposition"),t("symbol.placement"))}}},{"../../lib":515,"../array_container_defaults":561,"../subplot_defaults":641,"./layout_attributes":624}],626:[function(d,ee,te){var A=d("mapbox-gl/dist/mapbox-gl-unminified"),g=d("../../lib"),S=d("../../lib/geo_location_utils"),M=d("../../registry"),e=d("../cartesian/axes"),a=d("../../components/dragelement"),n=d("../../components/fx"),r=d("../../components/dragelement/helpers"),t=r.drawMode,c=r.selectMode,s=d("../../components/selections").prepSelect,i=d("../../components/selections").clearOutline,x=d("../../components/selections").clearSelectionsCache,p=d("../../components/selections").selectOnClick,v=d("./constants"),f=d("./layers");function y(h,b){this.id=b,this.gd=h;var u=h._fullLayout,L=h._context;this.container=u._glcontainer.node(),this.isStatic=L.staticPlot,this.uid=u._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(u),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var o=y.prototype;o.plot=function(h,b,u){var L=this,T=b[L.id];L.map&&T.accesstoken!==L.accessToken&&(L.map.remove(),L.map=null,L.styleObj=null,L.traceHash={},L.layerList=[]);var k;L.map?k=new Promise(function(P,z){L.updateMap(h,b,P,z)}):k=new Promise(function(P,z){L.createMap(h,b,P,z)}),u.push(k)},o.createMap=function(h,b,u,L){var T=this,k=b[T.id],P=T.styleObj=l(k.style);T.accessToken=k.accesstoken;var z=k.bounds,I=z?[[z.west,z.south],[z.east,z.north]]:null,D=T.map=new A.Map({container:T.div,style:P.style,center:_(k.center),zoom:k.zoom,bearing:k.bearing,pitch:k.pitch,maxBounds:I,interactive:!T.isStatic,preserveDrawingBuffer:T.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new A.AttributionControl({compact:!0}));D._canvas.style.left="0px",D._canvas.style.top="0px",T.rejectOnError(L),T.isStatic||T.initFx(h,b);var R=[];R.push(new Promise(function(O){D.once("load",O)})),R=R.concat(S.fetchTraceGeoData(h)),Promise.all(R).then(function(){T.fillBelowLookup(h,b),T.updateData(h),T.updateLayout(b),T.resolveOnRender(u)}).catch(L)},o.updateMap=function(h,b,u,L){var T=this,k=T.map,P=b[this.id];T.rejectOnError(L);var z=[],I=l(P.style);JSON.stringify(T.styleObj)!==JSON.stringify(I)&&(T.styleObj=I,k.setStyle(I.style),T.traceHash={},z.push(new Promise(function(D){k.once("styledata",D)}))),z=z.concat(S.fetchTraceGeoData(h)),Promise.all(z).then(function(){T.fillBelowLookup(h,b),T.updateData(h),T.updateLayout(b),T.resolveOnRender(u)}).catch(L)},o.fillBelowLookup=function(h,b){var u=b[this.id],L=u.layers,T,k,P=this.belowLookup={},z=!1;for(T=0;T<h.length;T++){var I=h[T][0].trace,D=I._module;typeof I.below=="string"?k=I.below:D.getBelow&&(k=D.getBelow(I,this)),k===""&&(z=!0),P["trace-"+I.uid]=k||""}for(T=0;T<L.length;T++){var R=L[T];typeof R.below=="string"?k=R.below:z?k="traces":k="",P["layout-"+T]=k}var O={},F,N;for(F in P)k=P[F],O[k]?O[k].push(F):O[k]=[F];for(k in O){var G=O[k];if(G.length>1)for(T=0;T<G.length;T++)F=G[T],F.indexOf("trace-")===0?(N=F.split("trace-")[1],this.traceHash[N]&&(this.traceHash[N].below=null)):F.indexOf("layout-")===0&&(N=F.split("layout-")[1],this.layerList[N]&&(this.layerList[N].below=null))}};var m={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};o.updateData=function(h){var b=this.traceHash,u,L,T,k,P=h.slice().sort(function(O,F){return m[O[0].trace.type]-m[F[0].trace.type]});for(T=0;T<P.length;T++){var z=P[T];L=z[0].trace,u=b[L.uid];var I=!1;u&&(u.type===L.type?(u.update(z),I=!0):u.dispose()),!I&&L._module&&(b[L.uid]=L._module.plot(this,z))}var D=Object.keys(b);e:for(T=0;T<D.length;T++){var R=D[T];for(k=0;k<h.length;k++)if(L=h[k][0].trace,R===L.uid)continue e;u=b[R],u.dispose(),delete b[R]}},o.updateLayout=function(h){var b=this.map,u=h[this.id];!this.dragging&&!this.wheeling&&(b.setCenter(_(u.center)),b.setZoom(u.zoom),b.setBearing(u.bearing),b.setPitch(u.pitch)),this.updateLayers(h),this.updateFramework(h),this.updateFx(h),this.map.resize(),this.gd._context._scrollZoom.mapbox?b.scrollZoom.enable():b.scrollZoom.disable()},o.resolveOnRender=function(h){var b=this.map;b.on("render",function u(){b.loaded()&&(b.off("render",u),setTimeout(h,10))})},o.rejectOnError=function(h){var b=this.map;function u(){h(new Error(v.mapOnErrorMsg))}b.once("error",u),b.once("style.error",u),b.once("source.error",u),b.once("tile.error",u),b.once("layer.error",u)},o.createFramework=function(h){var b=this,u=b.div=document.createElement("div");u.id=b.uid,u.style.position="absolute",b.container.appendChild(u),b.xaxis={_id:"x",c2p:function(L){return b.project(L).x}},b.yaxis={_id:"y",c2p:function(L){return b.project(L).y}},b.updateFramework(h),b.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(b.mockAxis,h)},o.initFx=function(h,b){var u=this,L=u.gd,T=u.map;T.on("moveend",function(z){if(!!u.map){var I=L._fullLayout;if(z.originalEvent||u.wheeling){var D=I[u.id];M.call("_storeDirectGUIEdit",L.layout,I._preGUI,u.getViewEdits(D));var R=u.getView();D._input.center=D.center=R.center,D._input.zoom=D.zoom=R.zoom,D._input.bearing=D.bearing=R.bearing,D._input.pitch=D.pitch=R.pitch,L.emit("plotly_relayout",u.getViewEditsWithDerived(R))}z.originalEvent&&z.originalEvent.type==="mouseup"?u.dragging=!1:u.wheeling&&(u.wheeling=!1),I._rehover&&I._rehover()}}),T.on("wheel",function(){u.wheeling=!0}),T.on("mousemove",function(z){var I=u.div.getBoundingClientRect(),D=[z.originalEvent.offsetX,z.originalEvent.offsetY];z.target.getBoundingClientRect=function(){return I},u.xaxis.p2c=function(){return T.unproject(D).lng},u.yaxis.p2c=function(){return T.unproject(D).lat},L._fullLayout._rehover=function(){L._fullLayout._hoversubplot===u.id&&L._fullLayout[u.id]&&n.hover(L,z,u.id)},n.hover(L,z,u.id),L._fullLayout._hoversubplot=u.id});function k(){n.loneUnhover(b._hoverlayer)}T.on("dragstart",function(){u.dragging=!0,k()}),T.on("zoomstart",k),T.on("mouseout",function(){L._fullLayout._hoversubplot=null});function P(){var z=u.getView();L.emit("plotly_relayouting",u.getViewEditsWithDerived(z))}T.on("drag",P),T.on("zoom",P),T.on("dblclick",function(){var z=L._fullLayout[u.id];M.call("_storeDirectGUIEdit",L.layout,L._fullLayout._preGUI,u.getViewEdits(z));var I=u.viewInitial;T.setCenter(_(I.center)),T.setZoom(I.zoom),T.setBearing(I.bearing),T.setPitch(I.pitch);var D=u.getView();z._input.center=z.center=D.center,z._input.zoom=z.zoom=D.zoom,z._input.bearing=z.bearing=D.bearing,z._input.pitch=z.pitch=D.pitch,L.emit("plotly_doubleclick",null),L.emit("plotly_relayout",u.getViewEditsWithDerived(D))}),u.clearOutline=function(){x(u.dragOptions),i(u.dragOptions.gd)},u.onClickInPanFn=function(z){return function(I){var D=L._fullLayout.clickmode;D.indexOf("select")>-1&&p(I.originalEvent,L,[u.xaxis],[u.yaxis],u.id,z),D.indexOf("event")>-1&&n.click(L,I.originalEvent)}}},o.updateFx=function(h){var b=this,u=b.map,L=b.gd;if(b.isStatic)return;function T(I){var D=b.map.unproject(I);return[D.lng,D.lat]}var k=h.dragmode,P;P=function(I,D){if(D.isRect){var R=I.range={};R[b.id]=[T([D.xmin,D.ymin]),T([D.xmax,D.ymax])]}else{var O=I.lassoPoints={};O[b.id]=D.map(T)}};var z=b.dragOptions;b.dragOptions=g.extendDeep(z||{},{dragmode:h.dragmode,element:b.div,gd:L,plotinfo:{id:b.id,domain:h[b.id].domain,xaxis:b.xaxis,yaxis:b.yaxis,fillRangeItems:P},xaxes:[b.xaxis],yaxes:[b.yaxis],subplot:b.id}),u.off("click",b.onClickInPanHandler),c(k)||t(k)?(u.dragPan.disable(),u.on("zoomstart",b.clearOutline),b.dragOptions.prepFn=function(I,D,R){s(I,D,R,b.dragOptions,k)},a.init(b.dragOptions)):(u.dragPan.enable(),u.off("zoomstart",b.clearOutline),b.div.onmousedown=null,b.div.ontouchstart=null,b.div.removeEventListener("touchstart",b.div._ontouchstart),b.onClickInPanHandler=b.onClickInPanFn(b.dragOptions),u.on("click",b.onClickInPanHandler))},o.updateFramework=function(h){var b=h[this.id].domain,u=h._size,L=this.div.style;L.width=u.w*(b.x[1]-b.x[0])+"px",L.height=u.h*(b.y[1]-b.y[0])+"px",L.left=u.l+b.x[0]*u.w+"px",L.top=u.t+(1-b.y[1])*u.h+"px",this.xaxis._offset=u.l+b.x[0]*u.w,this.xaxis._length=u.w*(b.x[1]-b.x[0]),this.yaxis._offset=u.t+(1-b.y[1])*u.h,this.yaxis._length=u.h*(b.y[1]-b.y[0])},o.updateLayers=function(h){var b=h[this.id],u=b.layers,L=this.layerList,T;if(u.length!==L.length){for(T=0;T<L.length;T++)L[T].dispose();for(L=this.layerList=[],T=0;T<u.length;T++)L.push(f(this,T,u[T]))}else for(T=0;T<u.length;T++)L[T].update(u[T])},o.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},o.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},o.setOptions=function(h,b,u){for(var L in u)this.map[b](h,L,u[L])},o.getMapLayers=function(){return this.map.getStyle().layers},o.addLayer=function(h,b){var u=this.map;if(typeof b=="string"){if(b===""){u.addLayer(h,b);return}for(var L=this.getMapLayers(),T=0;T<L.length;T++)if(b===L[T].id){u.addLayer(h,b);return}g.warn(["Trying to add layer with *below* value",b,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}u.addLayer(h)},o.project=function(h){return this.map.project(new A.LngLat(h[0],h[1]))},o.getView=function(){var h=this.map,b=h.getCenter(),u=b.lng,L=b.lat,T={lon:u,lat:L},k=h.getCanvas(),P=parseInt(k.style.width),z=parseInt(k.style.height);return{center:T,zoom:h.getZoom(),bearing:h.getBearing(),pitch:h.getPitch(),_derived:{coordinates:[h.unproject([0,0]).toArray(),h.unproject([P,0]).toArray(),h.unproject([P,z]).toArray(),h.unproject([0,z]).toArray()]}}},o.getViewEdits=function(h){for(var b=this.id,u=["center","zoom","bearing","pitch"],L={},T=0;T<u.length;T++){var k=u[T];L[b+"."+k]=h[k]}return L},o.getViewEditsWithDerived=function(h){var b=this.id,u=this.getViewEdits(h);return u[b+"._derived"]=h._derived,u};function l(h){var b={};return g.isPlainObject(h)?(b.id=h.id,b.style=h):typeof h=="string"?(b.id=h,v.styleValuesMapbox.indexOf(h)!==-1?b.style=w(h):v.stylesNonMapbox[h]?b.style=v.stylesNonMapbox[h]:b.style=h):(b.id=v.styleValueDflt,b.style=w(v.styleValueDflt)),b.transition={duration:0,delay:0},b}function w(h){return v.styleUrlPrefix+h+"-"+v.styleUrlSuffix}function _(h){return[h.lon,h.lat]}ee.exports=y},{"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../registry":647,"../cartesian/axes":566,"./constants":620,"./layers":623,"mapbox-gl/dist/mapbox-gl-unminified":239}],627:[function(d,ee,te){ee.exports=function(A){var g=A.editType;return{t:{valType:"number",dflt:0,editType:g},r:{valType:"number",dflt:0,editType:g},b:{valType:"number",dflt:0,editType:g},l:{valType:"number",dflt:0,editType:g},editType:g}}},{}],628:[function(d,ee,te){var A=d("@plotly/d3"),g=d("d3-time-format").timeFormatLocale,S=d("d3-format").formatLocale,M=d("fast-isnumeric"),e=d("../registry"),a=d("../plot_api/plot_schema"),n=d("../plot_api/plot_template"),r=d("../lib"),t=d("../components/color"),c=d("../constants/numerical").BADNUM,s=d("./cartesian/axis_ids"),i=d("../components/shapes/handle_outline").clearOutline,x=d("./animation_attributes"),p=d("./frame_attributes"),v=d("../plots/get_data").getModuleCalcData,f=r.relinkPrivateKeys,y=r._,o=ee.exports={};r.extendFlat(o,e),o.attributes=d("./attributes"),o.attributes.type.values=o.allTypes,o.fontAttrs=d("./font_attributes"),o.layoutAttributes=d("./layout_attributes"),o.fontWeight="normal";var m=o.transformsRegistry,l=d("./command");o.executeAPICommand=l.executeAPICommand,o.computeAPICommandBindings=l.computeAPICommandBindings,o.manageCommandObserver=l.manageCommandObserver,o.hasSimpleAPICommandBindings=l.hasSimpleAPICommandBindings,o.redrawText=function(j){return j=r.getGraphDiv(j),new Promise(function(q){setTimeout(function(){!j._fullLayout||(e.getComponentMethod("annotations","draw")(j),e.getComponentMethod("legend","draw")(j),e.getComponentMethod("colorbar","draw")(j),q(o.previousPromises(j)))},300)})},o.resize=function(j){j=r.getGraphDiv(j);var q,V=new Promise(function(U,$){(!j||r.isHidden(j))&&$(new Error("Resize must be passed a displayed plot div element.")),j._redrawTimer&&clearTimeout(j._redrawTimer),j._resolveResize&&(q=j._resolveResize),j._resolveResize=U,j._redrawTimer=setTimeout(function(){if(!j.layout||j.layout.width&&j.layout.height||r.isHidden(j)){U(j);return}delete j.layout.width,delete j.layout.height;var ne=j.changed;j.autoplay=!0,e.call("relayout",j,{autosize:!0}).then(function(){j.changed=ne,j._resolveResize===U&&(delete j._resolveResize,U(j))})},100)});return q&&q(V),V},o.previousPromises=function(j){if((j._promises||[]).length)return Promise.all(j._promises).then(function(){j._promises=[]})},o.addLinks=function(j){if(!(!j._context.showLink&&!j._context.showSources)){var q=j._fullLayout,V=r.ensureSingle(q._paper,"text","js-plot-link-container",function(ie){ie.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:t.defaultLine,"pointer-events":"all"}).each(function(){var se=A.select(this);se.append("tspan").classed("js-link-to-tool",!0),se.append("tspan").classed("js-link-spacer",!0),se.append("tspan").classed("js-sourcelinks",!0)})}),U=V.node(),$={y:q._paper.attr("height")-9};document.body.contains(U)&&U.getComputedTextLength()>=q.width-20?($["text-anchor"]="start",$.x=5):($["text-anchor"]="end",$.x=q._paper.attr("width")-7),V.attr($);var ne=V.select(".js-link-to-tool"),X=V.select(".js-link-spacer"),Q=V.select(".js-sourcelinks");j._context.showSources&&j._context.showSources(j),j._context.showLink&&w(j,ne),X.text(ne.text()&&Q.text()?" - ":"")}};function w(j,q){q.text("");var V=q.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(j._context.linkText+" "+String.fromCharCode(187));if(j._context.sendData)V.on("click",function(){o.sendDataToCloud(j)});else{var U=window.location.pathname.split("/"),$=window.location.search;V.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+U[2].split(".")[0]+"/"+U[1]+$})}}o.sendDataToCloud=function(j){var q=(window.PLOTLYENV||{}).BASE_URL||j._context.plotlyServerURL;if(!!q){j.emit("plotly_beforeexport");var V=A.select(j).append("div").attr("id","hiddenform").style("display","none"),U=V.append("form").attr({action:q+"/external",method:"post",target:"_blank"}),$=U.append("input").attr({type:"text",name:"data"});return $.node().value=o.graphJson(j,!1,"keepdata"),U.node().submit(),V.remove(),j.emit("plotly_afterexport"),!1}};var _=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],h=["year","month","dayMonth","dayMonthYear"];o.supplyDefaults=function(j,q){var V=q&&q.skipUpdateCalc,U=j._fullLayout||{};if(U._skipDefaults){delete U._skipDefaults;return}var $=j._fullLayout={},ne=j.layout||{},X=j._fullData||[],Q=j._fullData=[],ie=j.data||[],se=j.calcdata||[],ae=j._context||{},oe;j._transitionData||o.createTransitionData(j),$._dfltTitle={plot:y(j,"Click to enter Plot title"),x:y(j,"Click to enter X axis title"),y:y(j,"Click to enter Y axis title"),colorbar:y(j,"Click to enter Colorscale title"),annotation:y(j,"new text")},$._traceWord=y(j,"trace");var be=L(j,_);if($._mapboxAccessToken=ae.mapboxAccessToken,U._initialAutoSizeIsDone){var ce=U.width,de=U.height;o.supplyLayoutGlobalDefaults(ne,$,be),ne.width||($.width=ce),ne.height||($.height=de),o.sanitizeMargins($)}else{o.supplyLayoutGlobalDefaults(ne,$,be);var ye=!ne.width||!ne.height,ge=$.autosize,me=ae.autosizable,Ee=ye&&(ge||me);Ee?o.plotAutoSize(j,ne,$):ye&&o.sanitizeMargins($),!ge&&ye&&(ne.width=$.width,ne.height=$.height)}$._d3locale=T(be,$.separators),$._extraFormat=L(j,h),$._initialAutoSizeIsDone=!0,$._dataLength=ie.length,$._modules=[],$._visibleModules=[],$._basePlotModules=[];var Pe=$._subplots=u(),Ne=$._splomAxes={x:{},y:{}},we=$._splomSubplots={};$._splomGridDflt={},$._scatterStackOpts={},$._firstScatter={},$._alignmentOpts={},$._colorAxes={},$._requestRangeslider={},$._traceUids=b(X,ie),$._globalTransforms=(j._context||{}).globalTransforms,o.supplyDataDefaults(ie,Q,ne,$);var ke=Object.keys(Ne.x),Xe=Object.keys(Ne.y);if(ke.length>1&&Xe.length>1){for(e.getComponentMethod("grid","sizeDefaults")(ne,$),oe=0;oe<ke.length;oe++)r.pushUnique(Pe.xaxis,ke[oe]);for(oe=0;oe<Xe.length;oe++)r.pushUnique(Pe.yaxis,Xe[oe]);for(var He in we)r.pushUnique(Pe.cartesian,He)}if($._has=o._hasPlotType.bind($),X.length===Q.length)for(oe=0;oe<Q.length;oe++)f(Q[oe],X[oe]);o.supplyLayoutModuleDefaults(ne,$,Q,j._transitionData);var Ie=$._visibleModules,De=[];for(oe=0;oe<Ie.length;oe++){var Ge=Ie[oe].crossTraceDefaults;Ge&&r.pushUnique(De,Ge)}for(oe=0;oe<De.length;oe++)De[oe](Q,$);$._hasOnlyLargeSploms=$._basePlotModules.length===1&&$._basePlotModules[0].name==="splom"&&ke.length>15&&Xe.length>15&&$.shapes.length===0&&$.images.length===0,o.linkSubplots(Q,$,X,U),o.cleanPlot(Q,$,X,U);var ht=!!(U._has&&U._has("gl2d")),Rt=!!($._has&&$._has("gl2d")),Kt=!!(U._has&&U._has("cartesian")),It=!!($._has&&$._has("cartesian")),Mt=Kt||ht,Yt=It||Rt;Mt&&!Yt?U._bgLayer.remove():Yt&&!Mt&&($._shouldCreateBgLayer=!0),U._zoomlayer&&!j._dragging&&i({_fullLayout:U}),k(Q,$),f($,U),e.getComponentMethod("colorscale","crossTraceDefaults")(Q,$),$._preGUI||($._preGUI={}),$._tracePreGUI||($._tracePreGUI={});var zt=$._tracePreGUI,St={},Ye;for(Ye in zt)St[Ye]="old";for(oe=0;oe<Q.length;oe++)Ye=Q[oe]._fullInput.uid,St[Ye]||(zt[Ye]={}),St[Ye]="new";for(Ye in St)St[Ye]==="old"&&delete zt[Ye];R($),e.getComponentMethod("rangeslider","makeData")($),!V&&se.length===Q.length&&o.supplyDefaultsUpdateCalc(se,Q)},o.supplyDefaultsUpdateCalc=function(j,q){for(var V=0;V<q.length;V++){var U=q[V],$=(j[V]||[])[0];if($&&$.trace){var ne=$.trace;if(ne._hasCalcTransform){var X=ne._arrayAttrs,Q,ie,se;for(Q=0;Q<X.length;Q++)ie=X[Q],se=r.nestedProperty(ne,ie).get().slice(),r.nestedProperty(U,ie).set(se)}$.trace=U}}};function b(j,q){var V=q.length,U=[],$,ne;for($=0;$<j.length;$++){var X=j[$]._fullInput;X!==ne&&U.push(X),ne=X}var Q=U.length,ie=new Array(V),se={};function ae(ce,de){ie[de]=ce,se[ce]=1}function oe(ce,de){if(ce&&typeof ce=="string"&&!se[ce])return ae(ce,de),!0}for($=0;$<V;$++){var be=q[$].uid;typeof be=="number"&&(be=String(be)),!oe(be,$)&&($<Q&&oe(U[$].uid,$)||ae(r.randstr(se),$))}return ie}function u(){var j=e.collectableSubplotTypes,q={},V,U;if(!j){j=[];var $=e.subplotsRegistry;for(var ne in $){var X=$[ne],Q=X.attr;if(Q&&(j.push(ne),Array.isArray(Q)))for(U=0;U<Q.length;U++)r.pushUnique(j,Q[U])}}for(V=0;V<j.length;V++)q[j[V]]=[];return q}function L(j,q){var V=j._context.locale;V||(V="en-US");var U=!1,$={};function ne(oe){for(var be=!0,ce=0;ce<q.length;ce++){var de=q[ce];$[de]||(oe[de]?$[de]=oe[de]:be=!1)}be&&(U=!0)}for(var X=0;X<2;X++){for(var Q=j._context.locales,ie=0;ie<2;ie++){var se=(Q[V]||{}).format;if(se&&(ne(se),U))break;Q=e.localeRegistry}var ae=V.split("-")[0];if(U||ae===V)break;V=ae}return U||ne(e.localeRegistry.en.format),$}function T(j,q){return j.decimal=q.charAt(0),j.thousands=q.charAt(1),{numberFormat:function(V){try{V=S(j).format(r.adjustFormat(V))}catch{return r.warnBadFormat(V),r.noFormat}return V},timeFormat:g(j).utcFormat}}function k(j,q){var V,U=[];q.meta&&(V=q._meta={meta:q.meta,layout:{meta:q.meta}});for(var $=0;$<j.length;$++){var ne=j[$];ne.meta?U[ne.index]=ne._meta={meta:ne.meta}:q.meta&&(ne._meta={meta:q.meta}),q.meta&&(ne._meta.layout={meta:q.meta})}U.length&&(V||(V=q._meta={}),V.data=U)}o.createTransitionData=function(j){j._transitionData||(j._transitionData={}),j._transitionData._frames||(j._transitionData._frames=[]),j._transitionData._frameHash||(j._transitionData._frameHash={}),j._transitionData._counter||(j._transitionData._counter=0),j._transitionData._interruptCallbacks||(j._transitionData._interruptCallbacks=[])},o._hasPlotType=function(j){var q,V=this._basePlotModules||[];for(q=0;q<V.length;q++)if(V[q].name===j)return!0;var U=this._modules||[];for(q=0;q<U.length;q++){var $=U[q].name;if($===j)return!0;var ne=e.modules[$];if(ne&&ne.categories[j])return!0}return!1},o.cleanPlot=function(j,q,V,U){var $,ne,X=U._basePlotModules||[];for($=0;$<X.length;$++){var Q=X[$];Q.clean&&Q.clean(j,q,V,U)}var ie=U._has&&U._has("gl"),se=q._has&&q._has("gl");ie&&!se&&U._glcontainer!==void 0&&(U._glcontainer.selectAll(".gl-canvas").remove(),U._glcontainer.selectAll(".no-webgl").remove(),U._glcanvas=null);var ae=!!U._infolayer;e:for($=0;$<V.length;$++){var oe=V[$],be=oe.uid;for(ne=0;ne<j.length;ne++){var ce=j[ne];if(be===ce.uid)continue e}ae&&U._infolayer.select(".cb"+be).remove()}},o.linkSubplots=function(j,q,V,U){var $,ne,X=U._plots||{},Q=q._plots={},ie=q._subplots,se={_fullData:j,_fullLayout:q},ae=ie.cartesian.concat(ie.gl2d||[]);for($=0;$<ae.length;$++){var oe=ae[$],be=X[oe],ce=s.getFromId(se,oe,"x"),de=s.getFromId(se,oe,"y"),ye;for(be?ye=Q[oe]=be:(ye=Q[oe]={},ye.id=oe),ce._counterAxes.push(de._id),de._counterAxes.push(ce._id),ce._subplotsWith.push(oe),de._subplotsWith.push(oe),ye.xaxis=ce,ye.yaxis=de,ye._hasClipOnAxisFalse=!1,ne=0;ne<j.length;ne++){var ge=j[ne];if(ge.xaxis===ye.xaxis._id&&ge.yaxis===ye.yaxis._id&&ge.cliponaxis===!1){ye._hasClipOnAxisFalse=!0;break}}}var me=s.list(se,null,!0),Ee;for($=0;$<me.length;$++){Ee=me[$];var Pe=null;Ee.overlaying&&(Pe=s.getFromId(se,Ee.overlaying),Pe&&Pe.overlaying&&(Ee.overlaying=!1,Pe=null)),Ee._mainAxis=Pe||Ee,Pe&&(Ee.domain=Pe.domain.slice()),Ee._anchorAxis=Ee.anchor==="free"?null:s.getFromId(se,Ee.anchor)}for($=0;$<me.length;$++)if(Ee=me[$],Ee._counterAxes.sort(s.idSort),Ee._subplotsWith.sort(r.subplotSort),Ee._mainSubplot=P(Ee,q),Ee._counterAxes.length&&(Ee.spikemode&&Ee.spikemode.indexOf("across")!==-1||Ee.automargin&&Ee.mirror&&Ee.anchor!=="free"||e.getComponentMethod("rangeslider","isVisible")(Ee))){var Ne=1,we=0;for(ne=0;ne<Ee._counterAxes.length;ne++){var ke=s.getFromId(se,Ee._counterAxes[ne]);Ne=Math.min(Ne,ke.domain[0]),we=Math.max(we,ke.domain[1])}Ne<we&&(Ee._counterDomainMin=Ne,Ee._counterDomainMax=we)}};function P(j,q){var V={_fullLayout:q},U=j._id.charAt(0)==="x",$=j._mainAxis._anchorAxis,ne="",X="",Q="";if($&&(Q=$._mainAxis._id,ne=U?j._id+Q:Q+j._id),!ne||!q._plots[ne]){ne="";for(var ie=j._counterAxes,se=0;se<ie.length;se++){var ae=ie[se],oe=U?j._id+ae:ae+j._id;X||(X=oe);var be=s.getFromId(V,ae);if(Q&&be.overlaying===Q){ne=oe;break}}}return ne||X}o.clearExpandedTraceDefaultColors=function(j){var q,V,U;function $(X,Q,ie,se){V[se]=Q,V.length=se+1,X.valType==="color"&&X.dflt===void 0&&q.push(V.join("."))}for(V=[],q=j._module._colorAttrs,q||(j._module._colorAttrs=q=[],a.crawl(j._module.attributes,$)),U=0;U<q.length;U++){var ne=r.nestedProperty(j,"_input."+q[U]);ne.get()||r.nestedProperty(j,q[U]).set(null)}},o.supplyDataDefaults=function(j,q,V,U){var $=U._modules,ne=U._visibleModules,X=U._basePlotModules,Q=0,ie=0,se,ae,oe;U._transformModules=[];function be(Xe){q.push(Xe);var He=Xe._module;!He||(r.pushUnique($,He),Xe.visible===!0&&r.pushUnique(ne,He),r.pushUnique(X,Xe._module.basePlotModule),Q++,Xe._input.visible!==!1&&ie++)}var ce={},de=[],ye=(V.template||{}).data||{},ge=n.traceTemplater(ye);for(se=0;se<j.length;se++){if(oe=j[se],ae=ge.newTrace(oe),ae.uid=U._traceUids[se],o.supplyTraceDefaults(oe,ae,ie,U,se),ae.index=se,ae._input=oe,ae._expandedIndex=Q,ae.transforms&&ae.transforms.length)for(var me=oe.visible!==!1&&ae.visible===!1,Ee=I(ae,q,V,U),Pe=0;Pe<Ee.length;Pe++){var Ne=Ee[Pe],we={_template:ae._template,type:ae.type,uid:ae.uid+Pe};me&&Ne.visible===!1&&delete Ne.visible,o.supplyTraceDefaults(Ne,we,Q,U,se),f(we,Ne),we.index=se,we._input=oe,we._fullInput=ae,we._expandedIndex=Q,we._expandedInput=Ne,be(we)}else ae._fullInput=ae,ae._expandedInput=ae,be(ae);e.traceIs(ae,"carpetAxis")&&(ce[ae.carpet]=ae),e.traceIs(ae,"carpetDependent")&&de.push(se)}for(se=0;se<de.length;se++)if(ae=q[de[se]],!!ae.visible){var ke=ce[ae.carpet];if(ae._carpet=ke,!ke||!ke.visible){ae.visible=!1;continue}ae.xaxis=ke.xaxis,ae.yaxis=ke.yaxis}},o.supplyAnimationDefaults=function(j){j=j||{};var q,V={};function U($,ne){return r.coerce(j||{},V,x,$,ne)}if(U("mode"),U("direction"),U("fromcurrent"),Array.isArray(j.frame))for(V.frame=[],q=0;q<j.frame.length;q++)V.frame[q]=o.supplyAnimationFrameDefaults(j.frame[q]||{});else V.frame=o.supplyAnimationFrameDefaults(j.frame||{});if(Array.isArray(j.transition))for(V.transition=[],q=0;q<j.transition.length;q++)V.transition[q]=o.supplyAnimationTransitionDefaults(j.transition[q]||{});else V.transition=o.supplyAnimationTransitionDefaults(j.transition||{});return V},o.supplyAnimationFrameDefaults=function(j){var q={};function V(U,$){return r.coerce(j||{},q,x.frame,U,$)}return V("duration"),V("redraw"),q},o.supplyAnimationTransitionDefaults=function(j){var q={};function V(U,$){return r.coerce(j||{},q,x.transition,U,$)}return V("duration"),V("easing"),q},o.supplyFrameDefaults=function(j){var q={};function V(U,$){return r.coerce(j,q,p,U,$)}return V("group"),V("name"),V("traces"),V("baseframe"),V("data"),V("layout"),q},o.supplyTraceDefaults=function(j,q,V,U,$){var ne=U.colorway||t.defaults,X=ne[V%ne.length],Q;function ie(Ee,Pe){return r.coerce(j,q,o.attributes,Ee,Pe)}var se=ie("visible");ie("type"),ie("name",U._traceWord+" "+$),ie("uirevision",U.uirevision);var ae=o.getModule(q);if(q._module=ae,ae){var oe=ae.basePlotModule,be=oe.attr,ce=oe.attributes;if(be&&ce){var de=U._subplots,ye="";if(se||oe.name!=="gl2d"){if(Array.isArray(be))for(Q=0;Q<be.length;Q++){var ge=be[Q],me=r.coerce(j,q,ce,ge);de[ge]&&r.pushUnique(de[ge],me),ye+=me}else ye=r.coerce(j,q,ce,be);de[oe.name]&&r.pushUnique(de[oe.name],ye)}}}return se&&(ie("customdata"),ie("ids"),ie("meta"),e.traceIs(q,"showLegend")?(r.coerce(j,q,ae.attributes.showlegend?ae.attributes:o.attributes,"showlegend"),ie("legendwidth"),ie("legendgroup"),ie("legendgrouptitle.text"),ie("legendrank"),q._dfltShowLegend=!0):q._dfltShowLegend=!1,ae&&ae.supplyDefaults(j,q,X,U),e.traceIs(q,"noOpacity")||ie("opacity"),e.traceIs(q,"notLegendIsolatable")&&(q.visible=!!q.visible),e.traceIs(q,"noHover")||(q.hovertemplate||r.coerceHoverinfo(j,q,U),q.type!=="parcats"&&e.getComponentMethod("fx","supplyDefaults")(j,q,X,U)),ae&&ae.selectPoints&&ie("selectedpoints"),o.supplyTransformDefaults(j,q,U)),q};function z(j){var q=j.transforms;if(Array.isArray(q)&&q.length)for(var V=0;V<q.length;V++){var U=q[V],$=U._module||m[U.type];if($&&$.makesData)return!0}return!1}o.hasMakesDataTransform=z,o.supplyTransformDefaults=function(j,q,V){if(!!(q._length||z(j))){var U=V._globalTransforms||[],$=V._transformModules||[];if(!(!Array.isArray(j.transforms)&&U.length===0))for(var ne=j.transforms||[],X=U.concat(ne),Q=q.transforms=[],ie=0;ie<X.length;ie++){var se=X[ie],ae=se.type,oe=m[ae],be,ce=!(se._module&&se._module===oe),de=oe&&typeof oe.transform=="function";oe||r.warn("Unrecognized transform type "+ae+"."),oe&&oe.supplyDefaults&&(ce||de)?(be=oe.supplyDefaults(se,q,V,j),be.type=ae,be._module=oe,r.pushUnique($,oe)):be=r.extendFlat({},se),Q.push(be)}}};function I(j,q,V,U){for(var $=j.transforms,ne=[j],X=0;X<$.length;X++){var Q=$[X],ie=m[Q.type];ie&&ie.transform&&(ne=ie.transform(ne,{transform:Q,fullTrace:j,fullData:q,layout:V,fullLayout:U,transformIndex:X}))}return ne}o.supplyLayoutGlobalDefaults=function(j,q,V){function U(se,ae){return r.coerce(j,q,o.layoutAttributes,se,ae)}var $=j.template;r.isPlainObject($)&&(q.template=$,q._template=$.layout,q._dataTemplate=$.data),U("autotypenumbers");var ne=r.coerceFont(U,"font"),X=ne.size;r.coerceFont(U,"title.font",r.extendFlat({},ne,{size:Math.round(X*1.4)})),U("title.text",q._dfltTitle.plot),U("title.xref"),U("title.yref"),U("title.x"),U("title.y"),U("title.xanchor"),U("title.yanchor"),U("title.pad.t"),U("title.pad.r"),U("title.pad.b"),U("title.pad.l");var Q=U("uniformtext.mode");Q&&U("uniformtext.minsize"),U("autosize",!(j.width&&j.height)),U("width"),U("height"),U("minreducedwidth"),U("minreducedheight"),U("margin.l"),U("margin.r"),U("margin.t"),U("margin.b"),U("margin.pad"),U("margin.autoexpand"),j.width&&j.height&&o.sanitizeMargins(q),e.getComponentMethod("grid","sizeDefaults")(j,q),U("paper_bgcolor"),U("separators",V.decimal+V.thousands),U("hidesources"),U("colorway"),U("datarevision");var ie=U("uirevision");U("editrevision",ie),U("selectionrevision",ie),e.getComponentMethod("modebar","supplyLayoutDefaults")(j,q),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(j,q,U),e.getComponentMethod("selections","supplyDrawNewSelectionDefaults")(j,q,U),U("meta"),r.isPlainObject(j.transition)&&(U("transition.duration"),U("transition.easing"),U("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(j,q,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(j,q,U)};function D(j){return typeof j=="string"&&j.substr(j.length-2)==="px"&&parseFloat(j)}o.plotAutoSize=function(q,V,U){var $=q._context||{},ne=$.frameMargins,X,Q,ie=r.isPlotDiv(q);if(ie&&q.emit("plotly_autosize"),$.fillFrame)X=window.innerWidth,Q=window.innerHeight,document.body.style.overflow="hidden";else{var se=ie?window.getComputedStyle(q):{};if(X=D(se.width)||D(se.maxWidth)||U.width,Q=D(se.height)||D(se.maxHeight)||U.height,M(ne)&&ne>0){var ae=1-2*ne;X=Math.round(ae*X),Q=Math.round(ae*Q)}}var oe=o.layoutAttributes.width.min,be=o.layoutAttributes.height.min;X<oe&&(X=oe),Q<be&&(Q=be);var ce=!V.width&&Math.abs(U.width-X)>1,de=!V.height&&Math.abs(U.height-Q)>1;(de||ce)&&(ce&&(U.width=X),de&&(U.height=Q)),q._initialAutoSize||(q._initialAutoSize={width:X,height:Q}),o.sanitizeMargins(U)},o.supplyLayoutModuleDefaults=function(j,q,V,U){var $=e.componentsRegistry,ne=q._basePlotModules,X,Q,ie,se=e.subplotsRegistry.cartesian;for(X in $)ie=$[X],ie.includeBasePlot&&ie.includeBasePlot(j,q);ne.length||ne.push(se),q._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(j,q),se.finalizeSubplots(j,q));for(var ae in q._subplots)q._subplots[ae].sort(r.subplotSort);for(Q=0;Q<ne.length;Q++)ie=ne[Q],ie.supplyLayoutDefaults&&ie.supplyLayoutDefaults(j,q,V);var oe=q._modules;for(Q=0;Q<oe.length;Q++)ie=oe[Q],ie.supplyLayoutDefaults&&ie.supplyLayoutDefaults(j,q,V);var be=q._transformModules;for(Q=0;Q<be.length;Q++)ie=be[Q],ie.supplyLayoutDefaults&&ie.supplyLayoutDefaults(j,q,V,U);for(X in $)ie=$[X],ie.supplyLayoutDefaults&&ie.supplyLayoutDefaults(j,q,V)},o.purge=function(j){var q=j._fullLayout||{};q._glcontainer!==void 0&&(q._glcontainer.selectAll(".gl-canvas").remove(),q._glcontainer.remove(),q._glcanvas=null),q._modeBar&&q._modeBar.destroy(),j._transitionData&&(j._transitionData._interruptCallbacks&&(j._transitionData._interruptCallbacks.length=0),j._transitionData._animationRaf&&window.cancelAnimationFrame(j._transitionData._animationRaf)),r.clearThrottle(),r.clearResponsive(j),delete j.data,delete j.layout,delete j._fullData,delete j._fullLayout,delete j.calcdata,delete j.empty,delete j.fid,delete j.undoqueue,delete j.undonum,delete j.autoplay,delete j.changed,delete j._promises,delete j._redrawTimer,delete j._hmlumcount,delete j._hmpixcount,delete j._transitionData,delete j._transitioning,delete j._initialAutoSize,delete j._transitioningWithDuration,delete j._dragging,delete j._dragged,delete j._dragdata,delete j._hoverdata,delete j._snapshotInProgress,delete j._editing,delete j._mouseDownTime,delete j._legendMouseDownTime,j.removeAllListeners&&j.removeAllListeners()},o.style=function(j){var q=j._fullLayout._visibleModules,V=[],U;for(U=0;U<q.length;U++){var $=q[U];$.style&&r.pushUnique(V,$.style)}for(U=0;U<V.length;U++)V[U](j)},o.sanitizeMargins=function(j){if(!(!j||!j.margin)){var q=j.width,V=j.height,U=j.margin,$=q-(U.l+U.r),ne=V-(U.t+U.b),X;$<0&&(X=(q-1)/(U.l+U.r),U.l=Math.floor(X*U.l),U.r=Math.floor(X*U.r)),ne<0&&(X=(V-1)/(U.t+U.b),U.t=Math.floor(X*U.t),U.b=Math.floor(X*U.b))}},o.clearAutoMarginIds=function(j){j._fullLayout._pushmarginIds={}},o.allowAutoMargin=function(j,q){j._fullLayout._pushmarginIds[q]=1};function R(j){var q=j.margin;if(!j._size){var V=j._size={l:Math.round(q.l),r:Math.round(q.r),t:Math.round(q.t),b:Math.round(q.b),p:Math.round(q.pad)};V.w=Math.round(j.width)-V.l-V.r,V.h=Math.round(j.height)-V.t-V.b}j._pushmargin||(j._pushmargin={}),j._pushmarginIds||(j._pushmarginIds={})}var O=2,F=2;o.autoMargin=function(j,q,V){var U=j._fullLayout,$=U.width,ne=U.height,X=U.margin,Q=U.minreducedwidth,ie=U.minreducedheight,se=r.constrain($-X.l-X.r,O,Q),ae=r.constrain(ne-X.t-X.b,F,ie),oe=Math.max(0,$-se),be=Math.max(0,ne-ae),ce=U._pushmargin,de=U._pushmarginIds;if(X.autoexpand!==!1){if(!V)delete ce[q],delete de[q];else{var ye=V.pad;if(ye===void 0&&(ye=Math.min(12,X.l,X.r,X.t,X.b)),oe){var ge=(V.l+V.r)/oe;ge>1&&(V.l/=ge,V.r/=ge)}if(be){var me=(V.t+V.b)/be;me>1&&(V.t/=me,V.b/=me)}var Ee=V.xl!==void 0?V.xl:V.x,Pe=V.xr!==void 0?V.xr:V.x,Ne=V.yt!==void 0?V.yt:V.y,we=V.yb!==void 0?V.yb:V.y;ce[q]={l:{val:Ee,size:V.l+ye},r:{val:Pe,size:V.r+ye},b:{val:we,size:V.b+ye},t:{val:Ne,size:V.t+ye}},de[q]=1}if(!U._replotting)return o.doAutoMargin(j)}},o.doAutoMargin=function(j){var q=j._fullLayout,V=q.width,U=q.height;q._size||(q._size={}),R(q);var $=q._size,ne=q.margin,X=r.extendFlat({},$),Q=ne.l,ie=ne.r,se=ne.t,ae=ne.b,oe=q._pushmargin,be=q._pushmarginIds,ce=q.minreducedwidth,de=q.minreducedheight;if(q.margin.autoexpand!==!1){for(var ye in oe)be[ye]||delete oe[ye];oe.base={l:{val:0,size:Q},r:{val:1,size:ie},t:{val:1,size:se},b:{val:0,size:ae}};for(var ge in oe){var me=oe[ge].l||{},Ee=oe[ge].b||{},Pe=me.val,Ne=me.size,we=Ee.val,ke=Ee.size;for(var Xe in oe){if(M(Ne)&&oe[Xe].r){var He=oe[Xe].r.val,Ie=oe[Xe].r.size;if(He>Pe){var De=(Ne*He+(Ie-V)*Pe)/(He-Pe),Ge=(Ie*(1-Pe)+(Ne-V)*(1-He))/(He-Pe);De+Ge>Q+ie&&(Q=De,ie=Ge)}}if(M(ke)&&oe[Xe].t){var ht=oe[Xe].t.val,Rt=oe[Xe].t.size;if(ht>we){var Kt=(ke*ht+(Rt-U)*we)/(ht-we),It=(Rt*(1-we)+(ke-U)*(1-ht))/(ht-we);Kt+It>ae+se&&(ae=Kt,se=It)}}}}}var Mt=r.constrain(V-ne.l-ne.r,O,ce),Yt=r.constrain(U-ne.t-ne.b,F,de),zt=Math.max(0,V-Mt),St=Math.max(0,U-Yt);if(zt){var Ye=(Q+ie)/zt;Ye>1&&(Q/=Ye,ie/=Ye)}if(St){var rt=(ae+se)/St;rt>1&&(ae/=rt,se/=rt)}if($.l=Math.round(Q),$.r=Math.round(ie),$.t=Math.round(se),$.b=Math.round(ae),$.p=Math.round(ne.pad),$.w=Math.round(V)-$.l-$.r,$.h=Math.round(U)-$.t-$.b,!q._replotting&&o.didMarginChange(X,$)){"_redrawFromAutoMarginCount"in q?q._redrawFromAutoMarginCount++:q._redrawFromAutoMarginCount=1;var Ve=3*(1+Object.keys(be).length);if(q._redrawFromAutoMarginCount<Ve)return e.call("_doPlot",j);q._size=X,r.warn("Too many auto-margin redraws.")}N(j)};function N(j){var q=s.list(j,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(V){for(var U=0;U<q.length;U++){var $=q[U][V];$&&$()}})}var G=["l","r","t","b","p","w","h"];o.didMarginChange=function(j,q){for(var V=0;V<G.length;V++){var U=G[V],$=j[U],ne=q[U];if(!M($)||Math.abs(ne-$)>1)return!0}return!1},o.graphJson=function(j,q,V,U,$,ne){($&&q&&!j._fullData||$&&!q&&!j._fullLayout)&&o.supplyDefaults(j);var X=$?j._fullData:j.data,Q=$?j._fullLayout:j.layout,ie=(j._transitionData||{})._frames;function se(be,ce){if(typeof be=="function")return ce?"_function_":null;if(r.isPlainObject(be)){var de={},ye;return Object.keys(be).sort().forEach(function(ge){if(["_","["].indexOf(ge.charAt(0))===-1){if(typeof be[ge]=="function"){ce&&(de[ge]="_function");return}if(V==="keepdata"){if(ge.substr(ge.length-3)==="src")return}else if(V==="keepstream"){if(ye=be[ge+"src"],typeof ye=="string"&&ye.indexOf(":")>0&&!r.isPlainObject(be.stream))return}else if(V!=="keepall"&&(ye=be[ge+"src"],typeof ye=="string"&&ye.indexOf(":")>0))return;de[ge]=se(be[ge],ce)}}),de}return Array.isArray(be)?be.map(function(ge){return se(ge,ce)}):r.isTypedArray(be)?r.simpleMap(be,r.identity):r.isJSDate(be)?r.ms2DateTimeLocal(+be):be}var ae={data:(X||[]).map(function(be){var ce=se(be);return q&&delete ce.fit,ce})};if(!q&&(ae.layout=se(Q),$)){var oe=Q._size;ae.layout.computed={margin:{b:oe.b,l:oe.l,r:oe.r,t:oe.t}}}return ie&&(ae.frames=se(ie)),ne&&(ae.config=se(j._context,!0)),U==="object"?ae:JSON.stringify(ae)},o.modifyFrames=function(j,q){var V,U,$,ne=j._transitionData._frames,X=j._transitionData._frameHash;for(V=0;V<q.length;V++)switch(U=q[V],U.type){case"replace":$=U.value;var Q=(ne[U.index]||{}).name,ie=$.name;ne[U.index]=X[ie]=$,ie!==Q&&(delete X[Q],X[ie]=$);break;case"insert":$=U.value,X[$.name]=$,ne.splice(U.index,0,$);break;case"delete":$=ne[U.index],delete X[$.name],ne.splice(U.index,1);break}return Promise.resolve()},o.computeFrame=function(j,q){var V=j._transitionData._frameHash,U,$,ne,X;if(!q)throw new Error("computeFrame must be given a string frame name");var Q=V[q.toString()];if(!Q)return!1;for(var ie=[Q],se=[Q.name];Q.baseframe&&(Q=V[Q.baseframe.toString()])&&se.indexOf(Q.name)===-1;)ie.push(Q),se.push(Q.name);for(var ae={};Q=ie.pop();)if(Q.layout&&(ae.layout=o.extendLayout(ae.layout,Q.layout)),Q.data){if(ae.data||(ae.data=[]),$=Q.traces,!$)for($=[],U=0;U<Q.data.length;U++)$[U]=U;for(ae.traces||(ae.traces=[]),U=0;U<Q.data.length;U++)ne=$[U],ne!=null&&(X=ae.traces.indexOf(ne),X===-1&&(X=ae.data.length,ae.traces[X]=ne),ae.data[X]=o.extendTrace(ae.data[X],Q.data[U]))}return ae},o.recomputeFrameHash=function(j){for(var q=j._transitionData._frameHash={},V=j._transitionData._frames,U=0;U<V.length;U++){var $=V[U];$&&$.name&&(q[$.name]=$)}},o.extendObjectWithContainers=function(j,q,V){var U,$,ne,X,Q,ie,se,ae,oe=r.extendDeepNoArrays({},q||{}),be=r.expandObjectPaths(oe),ce={};if(V&&V.length)for(ne=0;ne<V.length;ne++)U=r.nestedProperty(be,V[ne]),$=U.get(),$===void 0?r.nestedProperty(ce,V[ne]).set(null):(U.set(null),r.nestedProperty(ce,V[ne]).set($));if(j=r.extendDeepNoArrays(j||{},be),V&&V.length){for(ne=0;ne<V.length;ne++)if(Q=r.nestedProperty(ce,V[ne]),se=Q.get(),!!se){for(ie=r.nestedProperty(j,V[ne]),ae=ie.get(),Array.isArray(ae)||(ae=[],ie.set(ae)),X=0;X<se.length;X++){var de=se[X];de===null?ae[X]=null:ae[X]=o.extendObjectWithContainers(ae[X],de)}ie.set(ae)}}return j},o.dataArrayContainers=["transforms","dimensions"],o.layoutArrayContainers=e.layoutArrayContainers,o.extendTrace=function(j,q){return o.extendObjectWithContainers(j,q,o.dataArrayContainers)},o.extendLayout=function(j,q){return o.extendObjectWithContainers(j,q,o.layoutArrayContainers)},o.transition=function(j,q,V,U,$,ne){var X={redraw:$.redraw},Q={},ie=[];return X.prepareFn=function(){for(var se=Array.isArray(q)?q.length:0,ae=U.slice(0,se),oe=0;oe<ae.length;oe++){var be=ae[oe],ce=j._fullData[be],de=ce._module;if(!!de){if(de.animatable){var ye=de.basePlotModule.name;Q[ye]||(Q[ye]=[]),Q[ye].push(be)}j.data[ae[oe]]=o.extendTrace(j.data[ae[oe]],q[oe])}}var ge=r.expandObjectPaths(r.extendDeepNoArrays({},V)),me=/^[xy]axis[0-9]*$/;for(var Ee in ge)!me.test(Ee)||delete ge[Ee].range;o.extendLayout(j.layout,ge),delete j.calcdata,o.supplyDefaults(j),o.doCalcdata(j);var Pe=r.expandObjectPaths(V);if(Pe){var Ne=j._fullLayout._plots;for(var we in Ne){var ke=Ne[we],Xe=ke.xaxis,He=ke.yaxis,Ie=Xe.range.slice(),De=He.range.slice(),Ge=null,ht=null,Rt=null,Kt=null;Array.isArray(Pe[Xe._name+".range"])?Ge=Pe[Xe._name+".range"].slice():Array.isArray((Pe[Xe._name]||{}).range)&&(Ge=Pe[Xe._name].range.slice()),Array.isArray(Pe[He._name+".range"])?ht=Pe[He._name+".range"].slice():Array.isArray((Pe[He._name]||{}).range)&&(ht=Pe[He._name].range.slice()),Ie&&Ge&&(Xe.r2l(Ie[0])!==Xe.r2l(Ge[0])||Xe.r2l(Ie[1])!==Xe.r2l(Ge[1]))&&(Rt={xr0:Ie,xr1:Ge}),De&&ht&&(He.r2l(De[0])!==He.r2l(ht[0])||He.r2l(De[1])!==He.r2l(ht[1]))&&(Kt={yr0:De,yr1:ht}),(Rt||Kt)&&ie.push(r.extendFlat({plotinfo:ke},Rt,Kt))}}return Promise.resolve()},X.runFn=function(se){var ae,oe=j._fullLayout._basePlotModules,be=ie.length,ce;if(V)for(ce=0;ce<oe.length;ce++)oe[ce].transitionAxes&&oe[ce].transitionAxes(j,ie,ne,se);be?(ae=r.extendFlat({},ne),ae.duration=0,delete Q.cartesian):ae=ne;for(var de in Q){var ye=Q[de],ge=j._fullData[ye[0]]._module;ge.basePlotModule.plot(j,ye,ae,se)}},K(j,ne,X)},o.transitionFromReact=function(j,q,V,U){var $=j._fullLayout,ne=$.transition,X={},Q=[];return X.prepareFn=function(){var ie=$._plots;X.redraw=!1,q.anim==="some"&&(X.redraw=!0),V.anim==="some"&&(X.redraw=!0);for(var se in ie){var ae=ie[se],oe=ae.xaxis,be=ae.yaxis,ce=U[oe._name].range.slice(),de=U[be._name].range.slice(),ye=oe.range.slice(),ge=be.range.slice();oe.setScale(),be.setScale();var me=null,Ee=null;(oe.r2l(ce[0])!==oe.r2l(ye[0])||oe.r2l(ce[1])!==oe.r2l(ye[1]))&&(me={xr0:ce,xr1:ye}),(be.r2l(de[0])!==be.r2l(ge[0])||be.r2l(de[1])!==be.r2l(ge[1]))&&(Ee={yr0:de,yr1:ge}),(me||Ee)&&Q.push(r.extendFlat({plotinfo:ae},me,Ee))}return Promise.resolve()},X.runFn=function(ie){for(var se=j._fullData,ae=j._fullLayout,oe=ae._basePlotModules,be,ce,de,ye=[],ge=0;ge<se.length;ge++)ye.push(ge);function me(){if(!!j._fullLayout)for(var Pe=0;Pe<oe.length;Pe++)oe[Pe].transitionAxes&&oe[Pe].transitionAxes(j,Q,be,ie)}function Ee(){if(!!j._fullLayout)for(var Pe=0;Pe<oe.length;Pe++)oe[Pe].plot(j,de,ce,ie)}Q.length&&q.anim?ne.ordering==="traces first"?(be=r.extendFlat({},ne,{duration:0}),de=ye,ce=ne,setTimeout(me,ne.duration),Ee()):(be=ne,de=null,ce=r.extendFlat({},ne,{duration:0}),setTimeout(Ee,be.duration),me()):Q.length?(be=ne,me()):q.anim&&(de=ye,ce=ne,Ee())},K(j,ne,X)};function K(j,q,V){var U=!1;function $(oe){var be=Promise.resolve();if(!oe)return be;for(;oe.length;)be=be.then(oe.shift());return be}function ne(oe){if(!!oe)for(;oe.length;)oe.shift()}function X(){return j.emit("plotly_transitioning",[]),new Promise(function(oe){j._transitioning=!0,q.duration>0&&(j._transitioningWithDuration=!0),j._transitionData._interruptCallbacks.push(function(){U=!0}),V.redraw&&j._transitionData._interruptCallbacks.push(function(){return e.call("redraw",j)}),j._transitionData._interruptCallbacks.push(function(){j.emit("plotly_transitioninterrupted",[])});var be=0,ce=0;function de(){return be++,function(){ce++,!U&&ce===be&&Q(oe)}}V.runFn(de),setTimeout(de())})}function Q(oe){if(!!j._transitionData)return ne(j._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(V.redraw)return e.call("redraw",j)}).then(function(){j._transitioning=!1,j._transitioningWithDuration=!1,j.emit("plotly_transitioned",[])}).then(oe)}function ie(){if(!!j._transitionData)return j._transitioning=!1,$(j._transitionData._interruptCallbacks)}var se=[o.previousPromises,ie,V.prepareFn,o.rehover,o.reselect,X],ae=r.syncOrAsync(se,j);return(!ae||!ae.then)&&(ae=Promise.resolve()),ae.then(function(){return j})}o.doCalcdata=function(j,q){var V=s.list(j),U=j._fullData,$=j._fullLayout,ne,X,Q,ie,se=new Array(U.length),ae=(j.calcdata||[]).slice();for(j.calcdata=se,$._numBoxes=0,$._numViolins=0,$._violinScaleGroupStats={},j._hmpixcount=0,j._hmlumcount=0,$._piecolormap={},$._sunburstcolormap={},$._treemapcolormap={},$._iciclecolormap={},$._funnelareacolormap={},Q=0;Q<U.length;Q++)if(Array.isArray(q)&&q.indexOf(Q)===-1){se[Q]=ae[Q];continue}for(Q=0;Q<U.length;Q++)ne=U[Q],ne._arrayAttrs=a.findArrayAttributes(ne),ne._extremes={};var oe=$._subplots.polar||[];for(Q=0;Q<oe.length;Q++)V.push($[oe[Q]].radialaxis,$[oe[Q]].angularaxis);for(var be in $._colorAxes){var ce=$[be];ce.cauto!==!1&&(delete ce.cmin,delete ce.cmax)}var de=!1;function ye(Ee){if(ne=U[Ee],X=ne._module,ne.visible===!0&&ne.transforms){if(X&&X.calc){var Pe=X.calc(j,ne);Pe[0]&&Pe[0].t&&Pe[0].t._scene&&delete Pe[0].t._scene.dirty}for(ie=0;ie<ne.transforms.length;ie++){var Ne=ne.transforms[ie];X=m[Ne.type],X&&X.calcTransform&&(ne._hasCalcTransform=!0,de=!0,X.calcTransform(j,ne,Ne))}}}function ge(Ee,Pe){if(ne=U[Ee],X=ne._module,!!X.isContainer===Pe){var Ne=[];if(ne.visible===!0&&ne._length!==0){delete ne._indexToPoints;var we=ne.transforms||[];for(ie=we.length-1;ie>=0;ie--)if(we[ie].enabled){ne._indexToPoints=we[ie]._indexToPoints;break}X&&X.calc&&(Ne=X.calc(j,ne))}(!Array.isArray(Ne)||!Ne[0])&&(Ne=[{x:c,y:c}]),Ne[0].t||(Ne[0].t={}),Ne[0].trace=ne,se[Ee]=Ne}}for(re(V,U,$),Q=0;Q<U.length;Q++)ge(Q,!0);for(Q=0;Q<U.length;Q++)ye(Q);for(de&&re(V,U,$),Q=0;Q<U.length;Q++)ge(Q,!0);for(Q=0;Q<U.length;Q++)ge(Q,!1);ue(j);var me=Y(V,j);if(me.length){for($._numBoxes=0,$._numViolins=0,Q=0;Q<me.length;Q++)ge(me[Q],!0);for(Q=0;Q<me.length;Q++)ge(me[Q],!1);ue(j)}e.getComponentMethod("fx","calc")(j),e.getComponentMethod("errorbars","calc")(j)};var W=/(total|sum|min|max|mean|median) (ascending|descending)/;function Y(j,q){var V=[],U,$,ne,X,Q;function ie(Mt,Yt,zt){var St=Yt._id.charAt(0);if(Mt==="histogram2dcontour"){var Ye=Yt._counterAxes[0],rt=s.getFromId(q,Ye),Ve=St==="x"||Ye==="x"&&rt.type==="category",Ae=St==="y"||Ye==="y"&&rt.type==="category";return function(Ue,Ze){return Ue===0||Ze===0||Ve&&Ue===zt[Ze].length-1||Ae&&Ze===zt.length-1?-1:(St==="y"?Ze:Ue)-1}}else return function(Ue,Ze){return St==="y"?Ze:Ue}}var se={min:function(Mt){return r.aggNums(Math.min,null,Mt)},max:function(Mt){return r.aggNums(Math.max,null,Mt)},sum:function(Mt){return r.aggNums(function(Yt,zt){return Yt+zt},null,Mt)},total:function(Mt){return r.aggNums(function(Yt,zt){return Yt+zt},null,Mt)},mean:function(Mt){return r.mean(Mt)},median:function(Mt){return r.median(Mt)}};for(U=0;U<j.length;U++){var ae=j[U];if(ae.type==="category"){var oe=ae.categoryorder.match(W);if(oe){var be=oe[1],ce=oe[2],de=ae._id.charAt(0),ye=de==="x",ge=[];for($=0;$<ae._categories.length;$++)ge.push([ae._categories[$],[]]);for($=0;$<ae._traceIndices.length;$++){var me=ae._traceIndices[$],Ee=q._fullData[me];if(Ee.visible===!0){var Pe=Ee.type;e.traceIs(Ee,"histogram")&&(delete Ee._xautoBinFinished,delete Ee._yautoBinFinished);var Ne=Pe==="splom",we=Pe==="scattergl",ke=q.calcdata[me];for(ne=0;ne<ke.length;ne++){var Xe=ke[ne],He,Ie;if(Ne){var De=Ee._axesDim[ae._id];if(!ye){var Ge=Ee._diag[De][0];Ge&&(ae=q._fullLayout[s.id2name(Ge)])}var ht=Xe.trace.dimensions[De].values;for(X=0;X<ht.length;X++)for(He=ae._categoriesMap[ht[X]],Q=0;Q<Xe.trace.dimensions.length;Q++)if(Q!==De){var Rt=Xe.trace.dimensions[Q];ge[He][1].push(Rt.values[X])}}else if(we){for(X=0;X<Xe.t.x.length;X++)ye?(He=Xe.t.x[X],Ie=Xe.t.y[X]):(He=Xe.t.y[X],Ie=Xe.t.x[X]),ge[He][1].push(Ie);Xe.t&&Xe.t._scene&&delete Xe.t._scene.dirty}else if(Xe.hasOwnProperty("z")){Ie=Xe.z;var Kt=ie(Ee.type,ae,Ie);for(X=0;X<Ie.length;X++)for(Q=0;Q<Ie[X].length;Q++)He=Kt(Q,X),He+1&&ge[He][1].push(Ie[X][Q])}else for(He=Xe.p,He===void 0&&(He=Xe[de]),Ie=Xe.s,Ie===void 0&&(Ie=Xe.v),Ie===void 0&&(Ie=ye?Xe.y:Xe.x),Array.isArray(Ie)||(Ie===void 0?Ie=[]:Ie=[Ie]),X=0;X<Ie.length;X++)ge[He][1].push(Ie[X])}}}ae._categoriesValue=ge;var It=[];for($=0;$<ge.length;$++)It.push([ge[$][0],se[be](ge[$][1])]);It.sort(function(Mt,Yt){return Mt[1]-Yt[1]}),ae._categoriesAggregatedValue=It,ae._initialCategories=It.map(function(Mt){return Mt[0]}),ce==="descending"&&ae._initialCategories.reverse(),V=V.concat(ae.sortByInitialCategories())}}}return V}function re(j,q,V){var U={};function $(ie){ie.clearCalc(),ie.type==="multicategory"&&ie.setupMultiCategory(q),U[ie._id]=1}r.simpleMap(j,$);for(var ne=V._axisMatchGroups||[],X=0;X<ne.length;X++)for(var Q in ne[X])U[Q]||$(V[s.id2name(Q)])}function ue(j){var q=j._fullLayout,V=q._visibleModules,U={},$,ne,X;for(ne=0;ne<V.length;ne++){var Q=V[ne],ie=Q.crossTraceCalc;if(ie){var se=Q.basePlotModule.name;U[se]?r.pushUnique(U[se],ie):U[se]=[ie]}}for(X in U){var ae=U[X],oe=q._subplots[X];if(Array.isArray(oe))for($=0;$<oe.length;$++){var be=oe[$],ce=X==="cartesian"?q._plots[be]:q[be];for(ne=0;ne<ae.length;ne++)ae[ne](j,ce,be)}else for(ne=0;ne<ae.length;ne++)ae[ne](j)}}o.rehover=function(j){j._fullLayout._rehover&&j._fullLayout._rehover()},o.redrag=function(j){j._fullLayout._redrag&&j._fullLayout._redrag()},o.reselect=function(j){var q=j._fullLayout,V=(j.layout||{}).selections,U=q._previousSelections;q._previousSelections=V;var $=q._reselect||JSON.stringify(V)!==JSON.stringify(U);e.getComponentMethod("selections","reselect")(j,$)},o.generalUpdatePerTraceModule=function(j,q,V,U){var $=q.traceHash,ne={},X;for(X=0;X<V.length;X++){var Q=V[X],ie=Q[0].trace;ie.visible&&(ne[ie.type]=ne[ie.type]||[],ne[ie.type].push(Q))}for(var se in $)if(!ne[se]){var ae=$[se][0],oe=ae[0].trace;oe.visible=!1,ne[se]=[ae]}for(var be in ne){var ce=ne[be],de=ce[0][0].trace._module;de.plot(j,q,r.filterVisible(ce),U)}q.traceHash=ne},o.plotBasePlot=function(j,q,V,U,$){var ne=e.getModule(j),X=v(q.calcdata,ne)[0];ne.plot(q,X,U,$)},o.cleanBasePlot=function(j,q,V,U,$){var ne=$._has&&$._has(j),X=V._has&&V._has(j);ne&&!X&&$["_"+j+"layer"].selectAll("g.trace").remove()}},{"../components/color":367,"../components/shapes/handle_outline":468,"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plot_api/plot_template":555,"../plots/get_data":602,"../registry":647,"./animation_attributes":560,"./attributes":562,"./cartesian/axis_ids":570,"./command":592,"./font_attributes":594,"./frame_attributes":595,"./layout_attributes":619,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],629:[function(d,ee,te){ee.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],630:[function(d,ee,te){var A=d("../../lib"),g=d("../../lib/polygon").tester,S=A.findIndexOfMin,M=A.isAngleInsideSector,e=A.angleDelta,a=A.angleDist;function n(m,l,w,_,h){if(!M(l,_))return!1;var b,u;w[0]<w[1]?(b=w[0],u=w[1]):(b=w[1],u=w[0]);var L=g(i(b,_[0],_[1],h)),T=g(i(u,_[0],_[1],h)),k=[m*Math.cos(l),m*Math.sin(l)];return T.contains(k)&&!L.contains(k)}function r(m,l,w,_){var h,b,u=_[0],L=_[1],T=v(Math.sin(l)-Math.sin(m)),k=v(Math.cos(l)-Math.cos(m)),P=Math.tan(w),z=v(1/P),I=T/k,D=L-I*u;return z?T&&k?(h=D/(P-I),b=P*h):k?(h=L*z,b=L):(h=u,b=u*P):T&&k?(h=0,b=D):k?(h=0,b=L):h=b=NaN,[h,b]}function t(m,l,w,_){var h=-l*w,b=l*l+1,u=2*(l*h-w),L=h*h+w*w-m*m,T=Math.sqrt(u*u-4*b*L),k=(-u+T)/(2*b),P=(-u-T)/(2*b);return[[k,l*k+h+_],[P,l*P+h+_]]}function c(m,l){var w=l.length,_=new Array(w+1),h;for(h=0;h<w;h++){var b=l[h];_[h]=[m*Math.cos(b),m*Math.sin(b)]}return _[h]=_[0].slice(),_}function s(m,l,w,_){var h=_.length,b=[],u,L;function T(N){return[m*Math.cos(N),m*Math.sin(N)]}function k(N,G,K){return r(N,G,K,T(N))}function P(N){return A.mod(N,h)}function z(N){return M(N,[l,w])}var I=S(_,function(N){return z(N)?a(N,l):1/0}),D=k(_[I],_[P(I-1)],l);for(b.push(D),u=I,L=0;L<h;u++,L++){var R=_[P(u)];if(!z(R))break;b.push(T(R))}var O=S(_,function(N){return z(N)?a(N,w):1/0}),F=k(_[O],_[P(O+1)],w);return b.push(F),b.push([0,0]),b.push(b[0].slice()),b}function i(m,l,w,_){return A.isFullCircle([l,w])?c(m,_):s(m,l,w,_)}function x(m,l,w,_){for(var h=1/0,b=1/0,u=i(m,l,w,_),L=0;L<u.length;L++){var T=u[L];h=Math.min(h,T[0]),b=Math.min(b,-T[1])}return[h,b]}function p(m,l){var w=function(b){var u=e(b,m);return u>0?u:1/0},_=S(l,w),h=A.mod(_+1,l.length);return[l[_],l[h]]}function v(m){return Math.abs(m)>1e-10?m:0}function f(m,l,w){l=l||0,w=w||0;for(var _=m.length,h=new Array(_),b=0;b<_;b++){var u=m[b];h[b]=[l+u[0],w-u[1]]}return h}function y(m,l,w,_,h,b){var u=i(m,l,w,_);return"M"+f(u,h,b).join("L")}function o(m,l,w,_,h,b,u){var L,T;m<l?(L=m,T=l):(L=l,T=m);var k=f(i(L,w,_,h),b,u),P=f(i(T,w,_,h),b,u);return"M"+P.reverse().join("L")+"M"+k.join("L")}ee.exports={isPtInsidePolygon:n,findPolygonOffset:x,findEnclosingVertexAngles:p,findIntersectionXY:r,findXYatLength:t,clampTiny:v,pathPolygon:y,pathPolygonAnnulus:o}},{"../../lib":515,"../../lib/polygon":527}],631:[function(d,ee,te){var A=d("../get_data").getSubplotCalcData,g=d("../../lib").counterRegex,S=d("./polar"),M=d("./constants"),e=M.attr,a=M.name,n=g(a),r={};r[e]={valType:"subplotid",dflt:a,editType:"calc"};function t(s){for(var i=s._fullLayout,x=s.calcdata,p=i._subplots[a],v=0;v<p.length;v++){var f=p[v],y=A(x,a,f),o=i[f]._subplot;o||(o=S(s,f),i[f]._subplot=o),o.plot(y,i,s._promises)}}function c(s,i,x,p){for(var v=p._subplots[a]||[],f=p._has&&p._has("gl"),y=i._has&&i._has("gl"),o=f&&!y,m=0;m<v.length;m++){var l=v[m],w=p[l]._subplot;if(!i[l]&&!!w){w.framework.remove(),w.layers["radial-axis-title"].remove();for(var _ in w.clipPaths)w.clipPaths[_].remove()}o&&w._scene&&(w._scene.destroy(),w._scene=null)}}ee.exports={attr:e,name:a,idRoot:a,idRegex:n,attrRegex:n,attributes:r,layoutAttributes:d("./layout_attributes"),supplyLayoutDefaults:d("./layout_defaults"),plot:t,clean:c,toSVG:d("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"./constants":629,"./layout_attributes":632,"./layout_defaults":633,"./polar":634}],632:[function(d,ee,te){var A=d("../../components/color/attributes"),g=d("../cartesian/layout_attributes"),S=d("../domain").attributes,M=d("../../lib").extendFlat,e=d("../../plot_api/edit_types").overrideAll,a=e({color:g.color,showline:M({},g.showline,{dflt:!0}),linecolor:g.linecolor,linewidth:g.linewidth,showgrid:M({},g.showgrid,{dflt:!0}),gridcolor:g.gridcolor,gridwidth:g.gridwidth,griddash:g.griddash},"plot","from-root"),n=e({tickmode:g.tickmode,nticks:g.nticks,tick0:g.tick0,dtick:g.dtick,tickvals:g.tickvals,ticktext:g.ticktext,ticks:g.ticks,ticklen:g.ticklen,tickwidth:g.tickwidth,tickcolor:g.tickcolor,ticklabelstep:g.ticklabelstep,showticklabels:g.showticklabels,showtickprefix:g.showtickprefix,tickprefix:g.tickprefix,showticksuffix:g.showticksuffix,ticksuffix:g.ticksuffix,showexponent:g.showexponent,exponentformat:g.exponentformat,minexponent:g.minexponent,separatethousands:g.separatethousands,tickfont:g.tickfont,tickangle:g.tickangle,tickformat:g.tickformat,tickformatstops:g.tickformatstops,layer:g.layer},"plot","from-root"),r={visible:M({},g.visible,{dflt:!0}),type:M({},g.type,{values:["-","linear","log","date","category"]}),autotypenumbers:g.autotypenumbers,autorange:M({},g.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:M({},g.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:g.categoryorder,categoryarray:g.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:M({},g.title.text,{editType:"plot",dflt:""}),font:M({},g.title.font,{editType:"plot"}),editType:"plot"},hoverformat:g.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:g._deprecated.title,titlefont:g._deprecated.titlefont}};M(r,a,n);var t={visible:M({},g.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:g.autotypenumbers,categoryorder:g.categoryorder,categoryarray:g.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:g.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};M(t,a,n),ee.exports={domain:S({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:A.background},radialaxis:r,angularaxis:t,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],633:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/color"),S=d("../../plot_api/plot_template"),M=d("../subplot_defaults"),e=d("../get_data").getSubplotData,a=d("../cartesian/tick_value_defaults"),n=d("../cartesian/tick_mark_defaults"),r=d("../cartesian/tick_label_defaults"),t=d("../cartesian/prefix_suffix_defaults"),c=d("../cartesian/category_order_defaults"),s=d("../cartesian/line_grid_defaults"),i=d("../cartesian/axis_autotype"),x=d("./layout_attributes"),p=d("./set_convert"),v=d("./constants"),f=v.axisNames;function y(m,l,w,_){var h=w("bgcolor");_.bgColor=g.combine(h,_.paper_bgcolor);var b=w("sector");w("hole");var u=e(_.fullData,v.name,_.id),L=_.layoutOut,T;function k(j,q){return w(T+"."+j,q)}for(var P=0;P<f.length;P++){T=f[P],A.isPlainObject(m[T])||(m[T]={});var z=m[T],I=S.newContainer(l,T);I._id=I._name=T,I._attr=_.id+"."+T,I._traceIndices=u.map(function(j){return j._expandedIndex});var D=v.axisName2dataArray[T],R=o(z,I,k,u,D,_);c(z,I,k,{axData:u,dataAttr:D});var O=k("visible");switch(p(I,l,L),k("uirevision",l.uirevision),I._m=1,T){case"radialaxis":var F=k("autorange",!I.isValidRange(z.range));z.autorange=F,F&&(R==="linear"||R==="-")&&k("rangemode"),F==="reversed"&&(I._m=-1),k("range"),I.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if(R==="date"){A.log("Polar plots do not support date angular axes yet.");for(var N=0;N<u.length;N++)u[N].visible=!1;R=z.type=I.type="linear"}k(R==="linear"?"thetaunit":"period");var G=k("direction");k("rotation",{counterclockwise:0,clockwise:90}[G]);break}if(t(z,I,k,I.type,{tickSuffixDflt:I.thetaunit==="degrees"?"\xB0":void 0}),O){var K,W,Y,re,ue=_.font||{};K=k("color"),W=K===z.color?K:ue.color,Y=ue.size,re=ue.family,a(z,I,k,I.type),r(z,I,k,I.type,{font:{color:W,size:Y,family:re}}),n(z,I,k,{outerTicks:!0}),s(z,I,k,{dfltColor:K,bgColor:_.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:x[T]}),k("layer"),T==="radialaxis"&&(k("side"),k("angle",b[0]),k("title.text"),A.coerceFont(k,"title.font",{color:W,size:A.bigFont(Y),family:re}))}R!=="category"&&k("hoverformat"),I._input=z}l.angularaxis.type==="category"&&w("gridshape")}function o(m,l,w,_,h,b){var u=w("autotypenumbers",b.autotypenumbersDflt),L=w("type");if(L==="-"){for(var T,k=0;k<_.length;k++)if(_[k].visible){T=_[k];break}T&&T[h]&&(l.type=i(T[h],"gregorian",{noMultiCategory:!0,autotypenumbers:u})),l.type==="-"?l.type="linear":m.type=l.type}return l.type}ee.exports=function(l,w,_){M(l,w,_,{type:v.name,attributes:x,handleDefaults:y,font:w.font,autotypenumbersDflt:w.autotypenumbers,paper_bgcolor:w.paper_bgcolor,fullData:_,layoutOut:w})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/axis_autotype":567,"../cartesian/category_order_defaults":571,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../get_data":602,"../subplot_defaults":641,"./constants":629,"./layout_attributes":632,"./set_convert":635}],634:[function(d,ee,te){var A=d("@plotly/d3"),g=d("tinycolor2"),S=d("../../registry"),M=d("../../lib"),e=M.strRotate,a=M.strTranslate,n=d("../../components/color"),r=d("../../components/drawing"),t=d("../plots"),c=d("../../plots/cartesian/axes"),s=d("../cartesian/set_convert"),i=d("./set_convert"),x=d("../cartesian/autorange").doAutoRange,p=d("../cartesian/dragbox"),v=d("../../components/dragelement"),f=d("../../components/fx"),y=d("../../components/titles"),o=d("../../components/selections").prepSelect,m=d("../../components/selections").selectOnClick,l=d("../../components/selections").clearOutline,w=d("../../lib/setcursor"),_=d("../../lib/clear_gl_canvases"),h=d("../../plot_api/subroutines").redrawReglTraces,b=d("../../constants/alignment").MID_SHIFT,u=d("./constants"),L=d("./helpers"),T=d("../smith/helpers"),k=T.smith,P=T.reactanceArc,z=T.resistanceArc,I=T.smithTransform,D=M._,R=M.mod,O=M.deg2rad,F=M.rad2deg;function N(ue,j,q){this.isSmith=q||!1,this.id=j,this.gd=ue,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var V=ue._fullLayout,U="clip"+V._uid+j;this.clipIds.forTraces=U+"-for-traces",this.clipPaths.forTraces=V._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=V["_"+(q?"smith":"polar")+"layer"].append("g").attr("class",j),this.getHole=function($){return this.isSmith?0:$.hole},this.getSector=function($){return this.isSmith?[0,360]:$.sector},this.getRadial=function($){return this.isSmith?$.realaxis:$.radialaxis},this.getAngular=function($){return this.isSmith?$.imaginaryaxis:$.angularaxis},q||(this.radialTickLayout=null,this.angularTickLayout=null)}var G=N.prototype;ee.exports=function(j,q,V){return new N(j,q,V)},G.plot=function(ue,j){for(var q=this,V=j[q.id],U=!1,$=0;$<ue.length;$++){var ne=ue[$][0].trace;if(ne.cliponaxis===!1){U=!0;break}}q._hasClipOnAxisFalse=U,q.updateLayers(j,V),q.updateLayout(j,V),t.generalUpdatePerTraceModule(q.gd,q,ue,V),q.updateFx(j,V),q.isSmith&&(delete V.realaxis.range,delete V.imaginaryaxis.range)},G.updateLayers=function(ue,j){var q=this,V=q.isSmith,U=q.layers,$=q.getRadial(j),ne=q.getAngular(j),X=u.layerNames,Q=X.indexOf("frontplot"),ie=X.slice(0,Q),se=ne.layer==="below traces",ae=$.layer==="below traces";se&&ie.push("angular-line"),ae&&ie.push("radial-line"),se&&ie.push("angular-axis"),ae&&ie.push("radial-axis"),ie.push("frontplot"),se||ie.push("angular-line"),ae||ie.push("radial-line"),se||ie.push("angular-axis"),ae||ie.push("radial-axis");var oe=(V?"smith":"polar")+"sublayer",be=q.framework.selectAll("."+oe).data(ie,String);be.enter().append("g").attr("class",function(ce){return oe+" "+ce}).each(function(ce){var de=U[ce]=A.select(this);switch(ce){case"frontplot":V||de.append("g").classed("barlayer",!0),de.append("g").classed("scatterlayer",!0);break;case"backplot":de.append("g").classed("maplayer",!0);break;case"plotbg":U.bg=de.append("path");break;case"radial-grid":de.style("fill","none");break;case"angular-grid":de.style("fill","none");break;case"radial-line":de.append("line").style("fill","none");break;case"angular-line":de.append("path").style("fill","none");break}}),be.order()},G.updateLayout=function(ue,j){var q=this,V=q.layers,U=ue._size,$=q.getRadial(j),ne=q.getAngular(j),X=j.domain.x,Q=j.domain.y;q.xOffset=U.l+U.w*X[0],q.yOffset=U.t+U.h*(1-Q[1]);var ie=q.xLength=U.w*(X[1]-X[0]),se=q.yLength=U.h*(Q[1]-Q[0]),ae=q.getSector(j);q.sectorInRad=ae.map(O);var oe=q.sectorBBox=W(ae),be=oe[2]-oe[0],ce=oe[3]-oe[1],de=se/ie,ye=Math.abs(ce/be),ge,me,Ee,Pe,Ne;de>ye?(ge=ie,me=ie*ye,Ne=(se-me)/U.h/2,Ee=[X[0],X[1]],Pe=[Q[0]+Ne,Q[1]-Ne]):(ge=se/ye,me=se,Ne=(ie-ge)/U.w/2,Ee=[X[0]+Ne,X[1]-Ne],Pe=[Q[0],Q[1]]),q.xLength2=ge,q.yLength2=me,q.xDomain2=Ee,q.yDomain2=Pe;var we=q.xOffset2=U.l+U.w*Ee[0],ke=q.yOffset2=U.t+U.h*(1-Pe[1]),Xe=q.radius=ge/be,He=q.innerRadius=q.getHole(j)*Xe,Ie=q.cx=we-Xe*oe[0],De=q.cy=ke+Xe*oe[3],Ge=q.cxx=Ie-we,ht=q.cyy=De-ke,Rt=$.side,Kt;Rt==="counterclockwise"?(Kt=Rt,Rt="top"):Rt==="clockwise"&&(Kt=Rt,Rt="bottom"),q.radialAxis=q.mockAxis(ue,j,$,{_id:"x",side:Rt,_trueSide:Kt,domain:[He/U.w,Xe/U.w]}),q.angularAxis=q.mockAxis(ue,j,ne,{side:"right",domain:[0,Math.PI],autorange:!1}),q.doAutoRange(ue,j),q.updateAngularAxis(ue,j),q.updateRadialAxis(ue,j),q.updateRadialAxisTitle(ue,j),q.xaxis=q.mockCartesianAxis(ue,j,{_id:"x",domain:Ee}),q.yaxis=q.mockCartesianAxis(ue,j,{_id:"y",domain:Pe});var It=q.pathSubplot();q.clipPaths.forTraces.select("path").attr("d",It).attr("transform",a(Ge,ht)),V.frontplot.attr("transform",a(we,ke)).call(r.setClipUrl,q._hasClipOnAxisFalse?null:q.clipIds.forTraces,q.gd),V.bg.attr("d",It).attr("transform",a(Ie,De)).call(n.fill,j.bgcolor)},G.mockAxis=function(ue,j,q,V){var U=M.extendFlat({},q,V);return i(U,j,ue),U},G.mockCartesianAxis=function(ue,j,q){var V=this,U=V.isSmith,$=q._id,ne=M.extendFlat({type:"linear"},q);s(ne,ue);var X={x:[0,2],y:[1,3]};return ne.setRange=function(){var Q=V.sectorBBox,ie=X[$],se=V.radialAxis._rl,ae=(se[1]-se[0])/(1-V.getHole(j));ne.range=[Q[ie[0]]*ae,Q[ie[1]]*ae]},ne.isPtWithinRange=$==="x"&&!U?function(Q){return V.isPtInside(Q)}:function(){return!0},ne.setRange(),ne.setScale(),ne},G.doAutoRange=function(ue,j){var q=this,V=q.gd,U=q.radialAxis,$=q.getRadial(j);x(V,U);var ne=U.range;$.range=ne.slice(),$._input.range=ne.slice(),U._rl=[U.r2l(ne[0],null,"gregorian"),U.r2l(ne[1],null,"gregorian")]},G.updateRadialAxis=function(ue,j){var q=this,V=q.gd,U=q.layers,$=q.radius,ne=q.innerRadius,X=q.cx,Q=q.cy,ie=q.getRadial(j),se=R(q.getSector(j)[0],360),ae=q.radialAxis,oe=ne<$,be=q.isSmith;be||(q.fillViewInitialKey("radialaxis.angle",ie.angle),q.fillViewInitialKey("radialaxis.range",ae.range.slice()),ae.setGeometry()),ae.tickangle==="auto"&&se>90&&se<=270&&(ae.tickangle=180);var ce=be?function(Xe){var He=I(q,k([Xe.x,0]));return a(He[0]-X,He[1]-Q)}:function(Xe){return a(ae.l2p(Xe.x)+ne,0)},de=be?function(Xe){return z(q,Xe.x,-1/0,1/0)}:function(Xe){return q.pathArc(ae.r2p(Xe.x)+ne)},ye=K(ie);if(q.radialTickLayout!==ye&&(U["radial-axis"].selectAll(".xtick").remove(),q.radialTickLayout=ye),oe){ae.setScale();var ge=0,me=be?(ae.tickvals||[]).filter(function(Xe){return Xe>=0}).map(function(Xe){return c.tickText(ae,Xe,!0,!1)}):c.calcTicks(ae),Ee=be?me:c.clipEnds(ae,me),Pe=c.getTickSigns(ae)[2];be&&((ae.ticks==="top"&&ae.side==="bottom"||ae.ticks==="bottom"&&ae.side==="top")&&(Pe=-Pe),ae.ticks==="top"&&ae.side==="top"&&(ge=-ae.ticklen),ae.ticks==="bottom"&&ae.side==="bottom"&&(ge=ae.ticklen)),c.drawTicks(V,ae,{vals:me,layer:U["radial-axis"],path:c.makeTickPath(ae,0,Pe),transFn:ce,crisp:!1}),c.drawGrid(V,ae,{vals:Ee,layer:U["radial-grid"],path:de,transFn:M.noop,crisp:!1}),c.drawLabels(V,ae,{vals:me,layer:U["radial-axis"],transFn:ce,labelFns:c.makeLabelFns(ae,ge)})}var Ne=q.radialAxisAngle=q.vangles?F(Y(O(ie.angle),q.vangles)):ie.angle,we=a(X,Q),ke=we+e(-Ne);re(U["radial-axis"],oe&&(ie.showticklabels||ie.ticks),{transform:ke}),re(U["radial-grid"],oe&&ie.showgrid,{transform:be?"":we}),re(U["radial-line"].select("line"),oe&&ie.showline,{x1:be?-$:ne,y1:0,x2:$,y2:0,transform:ke}).attr("stroke-width",ie.linewidth).call(n.stroke,ie.linecolor)},G.updateRadialAxisTitle=function(ue,j,q){if(!this.isSmith){var V=this,U=V.gd,$=V.radius,ne=V.cx,X=V.cy,Q=V.getRadial(j),ie=V.id+"title",se=0;if(Q.title){var ae=r.bBox(V.layers["radial-axis"].node()).height,oe=Q.title.font.size,be=Q.side;se=be==="top"?oe:be==="counterclockwise"?-(ae+oe*.4):ae+oe*.8}var ce=q!==void 0?q:V.radialAxisAngle,de=O(ce),ye=Math.cos(de),ge=Math.sin(de),me=ne+$/2*ye+se*ge,Ee=X-$/2*ge+se*ye;V.layers["radial-axis-title"]=y.draw(U,ie,{propContainer:Q,propName:V.id+".radialaxis.title",placeholder:D(U,"Click to enter radial axis title"),attributes:{x:me,y:Ee,"text-anchor":"middle"},transform:{rotate:-ce}})}},G.updateAngularAxis=function(ue,j){var q=this,V=q.gd,U=q.layers,$=q.radius,ne=q.innerRadius,X=q.cx,Q=q.cy,ie=q.getAngular(j),se=q.angularAxis,ae=q.isSmith;ae||(q.fillViewInitialKey("angularaxis.rotation",ie.rotation),se.setGeometry(),se.setScale());var oe=ae?function(He){var Ie=I(q,k([0,He.x]));return Math.atan2(Ie[0]-X,Ie[1]-Q)-Math.PI/2}:function(He){return se.t2g(He.x)};se.type==="linear"&&se.thetaunit==="radians"&&(se.tick0=F(se.tick0),se.dtick=F(se.dtick));var be=function(He){return a(X+$*Math.cos(He),Q-$*Math.sin(He))},ce=ae?function(He){var Ie=I(q,k([0,He.x]));return a(Ie[0],Ie[1])}:function(He){return be(oe(He))},de=ae?function(He){var Ie=I(q,k([0,He.x])),De=Math.atan2(Ie[0]-X,Ie[1]-Q)-Math.PI/2;return a(Ie[0],Ie[1])+e(-F(De))}:function(He){var Ie=oe(He);return be(Ie)+e(-F(Ie))},ye=ae?function(He){return P(q,He.x,0,1/0)}:function(He){var Ie=oe(He),De=Math.cos(Ie),Ge=Math.sin(Ie);return"M"+[X+ne*De,Q-ne*Ge]+"L"+[X+$*De,Q-$*Ge]},ge=c.makeLabelFns(se,0),me=ge.labelStandoff,Ee={};Ee.xFn=function(He){var Ie=oe(He);return Math.cos(Ie)*me},Ee.yFn=function(He){var Ie=oe(He),De=Math.sin(Ie)>0?.2:1;return-Math.sin(Ie)*(me+He.fontSize*De)+Math.abs(Math.cos(Ie))*(He.fontSize*b)},Ee.anchorFn=function(He){var Ie=oe(He),De=Math.cos(Ie);return Math.abs(De)<.1?"middle":De>0?"start":"end"},Ee.heightFn=function(He,Ie,De){var Ge=oe(He);return-.5*(1+Math.sin(Ge))*De};var Pe=K(ie);q.angularTickLayout!==Pe&&(U["angular-axis"].selectAll("."+se._id+"tick").remove(),q.angularTickLayout=Pe);var Ne=ae?[1/0].concat(se.tickvals||[]).map(function(He){return c.tickText(se,He,!0,!1)}):c.calcTicks(se);ae&&(Ne[0].text="\u221E",Ne[0].fontSize*=1.75);var we;if(j.gridshape==="linear"?(we=Ne.map(oe),M.angleDelta(we[0],we[1])<0&&(we=we.slice().reverse())):we=null,q.vangles=we,se.type==="category"&&(Ne=Ne.filter(function(He){return M.isAngleInsideSector(oe(He),q.sectorInRad)})),se.visible){var ke=se.ticks==="inside"?-1:1,Xe=(se.linewidth||1)/2;c.drawTicks(V,se,{vals:Ne,layer:U["angular-axis"],path:"M"+ke*Xe+",0h"+ke*se.ticklen,transFn:de,crisp:!1}),c.drawGrid(V,se,{vals:Ne,layer:U["angular-grid"],path:ye,transFn:M.noop,crisp:!1}),c.drawLabels(V,se,{vals:Ne,layer:U["angular-axis"],repositionOnUpdate:!0,transFn:ce,labelFns:Ee})}re(U["angular-line"].select("path"),ie.showline,{d:q.pathSubplot(),transform:a(X,Q)}).attr("stroke-width",ie.linewidth).call(n.stroke,ie.linecolor)},G.updateFx=function(ue,j){if(!this.gd._context.staticPlot){var q=!this.isSmith;q&&(this.updateAngularDrag(ue),this.updateRadialDrag(ue,j,0),this.updateRadialDrag(ue,j,1)),this.updateHoverAndMainDrag(ue)}},G.updateHoverAndMainDrag=function(ue){var j=this,q=j.isSmith,V=j.gd,U=j.layers,$=ue._zoomlayer,ne=u.MINZOOM,X=u.OFFEDGE,Q=j.radius,ie=j.innerRadius,se=j.cx,ae=j.cy,oe=j.cxx,be=j.cyy,ce=j.sectorInRad,de=j.vangles,ye=j.radialAxis,ge=L.clampTiny,me=L.findXYatLength,Ee=L.findEnclosingVertexAngles,Pe=u.cornerHalfWidth,Ne=u.cornerLen/2,we,ke,Xe=p.makeDragger(U,"path","maindrag",ue.dragmode===!1?"none":"crosshair");A.select(Xe).attr("d",j.pathSubplot()).attr("transform",a(se,ae)),Xe.onmousemove=function(Xt){f.hover(V,Xt,j.id),V._fullLayout._lasthover=Xe,V._fullLayout._hoversubplot=j.id},Xe.onmouseout=function(Xt){V._dragging||v.unhover(V,Xt)};var He={element:Xe,gd:V,subplot:j.id,plotinfo:{id:j.id,xaxis:j.xaxis,yaxis:j.yaxis},xaxes:[j.xaxis],yaxes:[j.yaxis]},Ie,De,Ge,ht,Rt,Kt,It,Mt,Yt;function zt(Xt,Ht){return Math.sqrt(Xt*Xt+Ht*Ht)}function St(Xt,Ht){return zt(Xt-oe,Ht-be)}function Ye(Xt,Ht){return Math.atan2(be-Ht,Xt-oe)}function rt(Xt,Ht){return[Xt*Math.cos(Ht),Xt*Math.sin(-Ht)]}function Ve(Xt,Ht){if(Xt===0)return j.pathSector(2*Pe);var ar=Ne/Xt,Vr=Ht-ar,nn=Ht+ar,jr=Math.max(0,Math.min(Xt,Q)),at=jr-Pe,$t=jr+Pe;return"M"+rt(at,Vr)+"A"+[at,at]+" 0,0,0 "+rt(at,nn)+"L"+rt($t,nn)+"A"+[$t,$t]+" 0,0,1 "+rt($t,Vr)+"Z"}function Ae(Xt,Ht,ar){if(Xt===0)return j.pathSector(2*Pe);var Vr=rt(Xt,Ht),nn=rt(Xt,ar),jr=ge((Vr[0]+nn[0])/2),at=ge((Vr[1]+nn[1])/2),$t,Zt;if(jr&&at){var ur=at/jr,wr=-1/ur,$e=me(Pe,ur,jr,at);$t=me(Ne,wr,$e[0][0],$e[0][1]),Zt=me(Ne,wr,$e[1][0],$e[1][1])}else{var Je,it;at?(Je=Ne,it=Pe):(Je=Pe,it=Ne),$t=[[jr-Je,at-it],[jr+Je,at-it]],Zt=[[jr-Je,at+it],[jr+Je,at+it]]}return"M"+$t.join("L")+"L"+Zt.reverse().join("L")+"Z"}function Ue(){Ge=null,ht=null,Rt=j.pathSubplot(),Kt=!1;var Xt=V._fullLayout[j.id];It=g(Xt.bgcolor).getLuminance(),Mt=p.makeZoombox($,It,se,ae,Rt),Mt.attr("fill-rule","evenodd"),Yt=p.makeCorners($,se,ae),l(V)}function Ze(Xt,Ht){return Ht=Math.max(Math.min(Ht,Q),ie),Xt<X?Xt=0:Q-Xt<X?Xt=Q:Ht<X?Ht=0:Q-Ht<X&&(Ht=Q),Math.abs(Ht-Xt)>ne?(Xt<Ht?(Ge=Xt,ht=Ht):(Ge=Ht,ht=Xt),!0):(Ge=null,ht=null,!1)}function Qe(Xt,Ht){Xt=Xt||Rt,Ht=Ht||"M0,0Z",Mt.attr("d",Xt),Yt.attr("d",Ht),p.transitionZoombox(Mt,Yt,Kt,It),Kt=!0;var ar={};Dt(ar),V.emit("plotly_relayouting",ar)}function _t(Xt,Ht){Xt=Xt*we,Ht=Ht*ke;var ar=Ie+Xt,Vr=De+Ht,nn=St(Ie,De),jr=Math.min(St(ar,Vr),Q),at=Ye(Ie,De),$t,Zt;Ze(nn,jr)&&($t=Rt+j.pathSector(ht),Ge&&($t+=j.pathSector(Ge)),Zt=Ve(Ge,at)+Ve(ht,at)),Qe($t,Zt)}function gt(Xt,Ht,ar,Vr){var nn=L.findIntersectionXY(ar,Vr,ar,[Xt-oe,be-Ht]);return zt(nn[0],nn[1])}function wt(Xt,Ht){var ar=Ie+Xt,Vr=De+Ht,nn=Ye(Ie,De),jr=Ye(ar,Vr),at=Ee(nn,de),$t=Ee(jr,de),Zt=gt(Ie,De,at[0],at[1]),ur=Math.min(gt(ar,Vr,$t[0],$t[1]),Q),wr,$e;Ze(Zt,ur)&&(wr=Rt+j.pathSector(ht),Ge&&(wr+=j.pathSector(Ge)),$e=[Ae(Ge,at[0],at[1]),Ae(ht,at[0],at[1])].join(" ")),Qe(wr,$e)}function Ut(){if(p.removeZoombox(V),!(Ge===null||ht===null)){var Xt={};Dt(Xt),p.showDoubleClickNotifier(V),S.call("_guiRelayout",V,Xt)}}function Dt(Xt){var Ht=ye._rl,ar=(Ht[1]-Ht[0])/(1-ie/Q)/Q,Vr=[Ht[0]+(Ge-ie)*ar,Ht[0]+(ht-ie)*ar];Xt[j.id+".radialaxis.range"]=Vr}function Nt(Xt,Ht){var ar=V._fullLayout.clickmode;if(p.removeZoombox(V),Xt===2){var Vr={};for(var nn in j.viewInitial)Vr[j.id+"."+nn]=j.viewInitial[nn];V.emit("plotly_doubleclick",null),S.call("_guiRelayout",V,Vr)}ar.indexOf("select")>-1&&Xt===1&&m(Ht,V,[j.xaxis],[j.yaxis],j.id,He),ar.indexOf("event")>-1&&f.click(V,Ht,j.id)}He.prepFn=function(Xt,Ht,ar){var Vr=V._fullLayout.dragmode,nn=Xe.getBoundingClientRect();V._fullLayout._calcInverseTransform(V);var jr=V._fullLayout._invTransform;we=V._fullLayout._invScaleX,ke=V._fullLayout._invScaleY;var at=M.apply3DTransform(jr)(Ht-nn.left,ar-nn.top);if(Ie=at[0],De=at[1],de){var $t=L.findPolygonOffset(Q,ce[0],ce[1],de);Ie+=oe+$t[0],De+=be+$t[1]}switch(Vr){case"zoom":He.clickFn=Nt,q||(de?He.moveFn=wt:He.moveFn=_t,He.doneFn=Ut,Ue());break;case"select":case"lasso":o(Xt,Ht,ar,He,Vr);break}},v.init(He)},G.updateRadialDrag=function(ue,j,q){var V=this,U=V.gd,$=V.layers,ne=V.radius,X=V.innerRadius,Q=V.cx,ie=V.cy,se=V.radialAxis,ae=u.radialDragBoxSize,oe=ae/2;if(!se.visible)return;var be=O(V.radialAxisAngle),ce=se._rl,de=ce[0],ye=ce[1],ge=ce[q],me=.75*(ce[1]-ce[0])/(1-V.getHole(j))/ne,Ee,Pe,Ne;q?(Ee=Q+(ne+oe)*Math.cos(be),Pe=ie-(ne+oe)*Math.sin(be),Ne="radialdrag"):(Ee=Q+(X-oe)*Math.cos(be),Pe=ie-(X-oe)*Math.sin(be),Ne="radialdrag-inner");var we=p.makeRectDragger($,Ne,"crosshair",-oe,-oe,ae,ae),ke={element:we,gd:U};ue.dragmode===!1&&(ke.dragmode=!1),re(A.select(we),se.visible&&X<ne,{transform:a(Ee,Pe)});var Xe,He,Ie;function De(It,Mt){if(Xe)Xe(It,Mt);else{var Yt=[It,-Mt],zt=[Math.cos(be),Math.sin(be)],St=Math.abs(M.dot(Yt,zt)/Math.sqrt(M.dot(Yt,Yt)));isNaN(St)||(Xe=St<.5?Rt:Kt)}var Ye={};Ge(Ye),U.emit("plotly_relayouting",Ye)}function Ge(It){He!==null?It[V.id+".radialaxis.angle"]=He:Ie!==null&&(It[V.id+".radialaxis.range["+q+"]"]=Ie)}function ht(){He!==null?S.call("_guiRelayout",U,V.id+".radialaxis.angle",He):Ie!==null&&S.call("_guiRelayout",U,V.id+".radialaxis.range["+q+"]",Ie)}function Rt(It,Mt){if(q!==0){var Yt=Ee+It,zt=Pe+Mt;He=Math.atan2(ie-zt,Yt-Q),V.vangles&&(He=Y(He,V.vangles)),He=F(He);var St=a(Q,ie)+e(-He);$["radial-axis"].attr("transform",St),$["radial-line"].select("line").attr("transform",St);var Ye=V.gd._fullLayout,rt=Ye[V.id];V.updateRadialAxisTitle(Ye,rt,He)}}function Kt(It,Mt){var Yt=M.dot([It,-Mt],[Math.cos(be),Math.sin(be)]);if(Ie=ge-me*Yt,me>0!=(q?Ie>de:Ie<ye)){Ie=null;return}var zt=U._fullLayout,St=zt[V.id];se.range[q]=Ie,se._rl[q]=Ie,V.updateRadialAxis(zt,St),V.xaxis.setRange(),V.xaxis.setScale(),V.yaxis.setRange(),V.yaxis.setScale();var Ye=!1;for(var rt in V.traceHash){var Ve=V.traceHash[rt],Ae=M.filterVisible(Ve),Ue=Ve[0][0].trace._module;Ue.plot(U,V,Ae,St),S.traceIs(rt,"gl")&&Ae.length&&(Ye=!0)}Ye&&(_(U),h(U))}ke.prepFn=function(){Xe=null,He=null,Ie=null,ke.moveFn=De,ke.doneFn=ht,l(U)},ke.clampFn=function(It,Mt){return Math.sqrt(It*It+Mt*Mt)<u.MINDRAG&&(It=0,Mt=0),[It,Mt]},v.init(ke)},G.updateAngularDrag=function(ue){var j=this,q=j.gd,V=j.layers,U=j.radius,$=j.angularAxis,ne=j.cx,X=j.cy,Q=j.cxx,ie=j.cyy,se=u.angularDragBoxSize,ae=p.makeDragger(V,"path","angulardrag",ue.dragmode===!1?"none":"move"),oe={element:ae,gd:q};ue.dragmode===!1?oe.dragmode=!1:A.select(ae).attr("d",j.pathAnnulus(U,U+se)).attr("transform",a(ne,X)).call(w,"move");function be(Ie,De){return Math.atan2(ie+se-De,Ie-Q-se)}var ce=V.frontplot.select(".scatterlayer").selectAll(".trace"),de=ce.selectAll(".point"),ye=ce.selectAll(".textpoint"),ge,me,Ee,Pe,Ne,we;function ke(Ie,De){var Ge=j.gd._fullLayout,ht=Ge[j.id],Rt=ge+Ie*ue._invScaleX,Kt=me+De*ue._invScaleY,It=be(Rt,Kt),Mt=F(It-we);if(Pe=Ee+Mt,V.frontplot.attr("transform",a(j.xOffset2,j.yOffset2)+e([-Mt,Q,ie])),j.vangles){Ne=j.radialAxisAngle+Mt;var Yt=a(ne,X)+e(-Mt),zt=a(ne,X)+e(-Ne);V.bg.attr("transform",Yt),V["radial-grid"].attr("transform",Yt),V["radial-axis"].attr("transform",zt),V["radial-line"].select("line").attr("transform",zt),j.updateRadialAxisTitle(Ge,ht,Ne)}else j.clipPaths.forTraces.select("path").attr("transform",a(Q,ie)+e(Mt));de.each(function(){var Ze=A.select(this),Qe=r.getTranslate(Ze);Ze.attr("transform",a(Qe.x,Qe.y)+e([Mt]))}),ye.each(function(){var Ze=A.select(this),Qe=Ze.select("text"),_t=r.getTranslate(Ze);Ze.attr("transform",e([Mt,Qe.attr("x"),Qe.attr("y")])+a(_t.x,_t.y))}),$.rotation=M.modHalf(Pe,360),j.updateAngularAxis(Ge,ht),j._hasClipOnAxisFalse&&!M.isFullCircle(j.sectorInRad)&&ce.call(r.hideOutsideRangePoints,j);var St=!1;for(var Ye in j.traceHash)if(S.traceIs(Ye,"gl")){var rt=j.traceHash[Ye],Ve=M.filterVisible(rt),Ae=rt[0][0].trace._module;Ae.plot(q,j,Ve,ht),Ve.length&&(St=!0)}St&&(_(q),h(q));var Ue={};Xe(Ue),q.emit("plotly_relayouting",Ue)}function Xe(Ie){Ie[j.id+".angularaxis.rotation"]=Pe,j.vangles&&(Ie[j.id+".radialaxis.angle"]=Ne)}function He(){ye.select("text").attr("transform",null);var Ie={};Xe(Ie),S.call("_guiRelayout",q,Ie)}oe.prepFn=function(Ie,De,Ge){var ht=ue[j.id];Ee=ht.angularaxis.rotation;var Rt=ae.getBoundingClientRect();ge=De-Rt.left,me=Ge-Rt.top,q._fullLayout._calcInverseTransform(q);var Kt=M.apply3DTransform(ue._invTransform)(ge,me);ge=Kt[0],me=Kt[1],we=be(ge,me),oe.moveFn=ke,oe.doneFn=He,l(q)},j.vangles&&!M.isFullCircle(j.sectorInRad)&&(oe.prepFn=M.noop,w(A.select(ae),null)),v.init(oe)},G.isPtInside=function(ue){if(this.isSmith)return!0;var j=this.sectorInRad,q=this.vangles,V=this.angularAxis.c2g(ue.theta),U=this.radialAxis,$=U.c2l(ue.r),ne=U._rl,X=q?L.isPtInsidePolygon:M.isPtInsideSector;return X($,V,ne,j,q)},G.pathArc=function(ue){var j=this.sectorInRad,q=this.vangles,V=q?L.pathPolygon:M.pathArc;return V(ue,j[0],j[1],q)},G.pathSector=function(ue){var j=this.sectorInRad,q=this.vangles,V=q?L.pathPolygon:M.pathSector;return V(ue,j[0],j[1],q)},G.pathAnnulus=function(ue,j){var q=this.sectorInRad,V=this.vangles,U=V?L.pathPolygonAnnulus:M.pathAnnulus;return U(ue,j,q[0],q[1],V)},G.pathSubplot=function(){var ue=this.innerRadius,j=this.radius;return ue?this.pathAnnulus(ue,j):this.pathSector(j)},G.fillViewInitialKey=function(ue,j){ue in this.viewInitial||(this.viewInitial[ue]=j)};function K(ue){var j=ue.ticks+String(ue.ticklen)+String(ue.showticklabels);return"side"in ue&&(j+=ue.side),j}function W(ue){var j=ue[0],q=ue[1],V=q-j,U=R(j,360),$=U+V,ne=Math.cos(O(U)),X=Math.sin(O(U)),Q=Math.cos(O($)),ie=Math.sin(O($)),se,ae,oe,be;return U<=90&&$>=90||U>90&&$>=450?be=1:X<=0&&ie<=0?be=0:be=Math.max(X,ie),U<=180&&$>=180||U>180&&$>=540?se=-1:ne>=0&&Q>=0?se=0:se=Math.min(ne,Q),U<=270&&$>=270||U>270&&$>=630?ae=-1:X>=0&&ie>=0?ae=0:ae=Math.min(X,ie),$>=360?oe=1:ne<=0&&Q<=0?oe=0:oe=Math.max(ne,Q),[se,ae,oe,be]}function Y(ue,j){var q=function(U){return M.angleDist(ue,U)},V=M.findIndexOfMin(j,q);return j[V]}function re(ue,j,q){return j?(ue.attr("display",null),ue.attr(q)):ue&&ue.attr("display","none"),ue}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../plot_api/subroutines":556,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/dragbox":575,"../cartesian/set_convert":585,"../plots":628,"../smith/helpers":637,"./constants":629,"./helpers":630,"./set_convert":635,"@plotly/d3":58,tinycolor2:313}],635:[function(d,ee,te){var A=d("../../lib"),g=d("../cartesian/set_convert"),S=A.deg2rad,M=A.rad2deg;ee.exports=function(c,s,i){switch(g(c,i),c._id){case"x":case"radialaxis":e(c,s);break;case"angularaxis":r(c,s);break}};function e(t,c){var s=c._subplot;t.setGeometry=function(){var i=t._rl[0],x=t._rl[1],p=s.innerRadius,v=(s.radius-p)/(x-i),f=p/v,y=i>x?function(o){return o<=0}:function(o){return o>=0};t.c2g=function(o){var m=t.c2l(o)-i;return(y(m)?m:0)+f},t.g2c=function(o){return t.l2c(o+i-f)},t.g2p=function(o){return o*v},t.c2p=function(o){return t.g2p(t.c2g(o))}}}function a(t,c){return c==="degrees"?S(t):t}function n(t,c){return c==="degrees"?M(t):t}function r(t,c){var s=t.type;if(s==="linear"){var i=t.d2c,x=t.c2d;t.d2c=function(p,v){return a(i(p),v)},t.c2d=function(p,v){return x(n(p,v))}}t.makeCalcdata=function(p,v){var f=p[v],y=p._length,o,m,l=function(u){return t.d2c(u,p.thetaunit)};if(f){if(A.isTypedArray(f)&&s==="linear"){if(y===f.length)return f;if(f.subarray)return f.subarray(0,y)}for(o=new Array(y),m=0;m<y;m++)o[m]=l(f[m])}else{var w=v+"0",_="d"+v,h=w in p?l(p[w]):0,b=p[_]?l(p[_]):(t.period||2*Math.PI)/y;for(o=new Array(y),m=0;m<y;m++)o[m]=h+m*b}return o},t.setGeometry=function(){var p=c.sector,v=p.map(S),f={clockwise:-1,counterclockwise:1}[t.direction],y=S(t.rotation),o=function(L){return f*L+y},m=function(L){return(L-y)/f},l,w,_,h;switch(s){case"linear":w=l=A.identity,h=S,_=M,t.range=A.isFullCircle(v)?[p[0],p[0]+360]:v.map(m).map(M);break;case"category":var b=t._categories.length,u=t.period?Math.max(t.period,b):b;u===0&&(u=1),w=h=function(L){return L*2*Math.PI/u},l=_=function(L){return L*u/Math.PI/2},t.range=[0,u];break}t.c2g=function(L){return o(w(L))},t.g2c=function(L){return l(m(L))},t.t2g=function(L){return o(h(L))},t.g2t=function(L){return _(m(L))}}}},{"../../lib":515,"../cartesian/set_convert":585}],636:[function(d,ee,te){ee.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],637:[function(d,ee,te){function A(n){return n<0?-1:n>0?1:0}function g(n){var r=n[0],t=n[1];if(!isFinite(r)||!isFinite(t))return[1,0];var c=(r+1)*(r+1)+t*t;return[(r*r+t*t-1)/c,2*t/c]}function S(n,r){var t=r[0],c=r[1];return[t*n.radius+n.cx,-c*n.radius+n.cy]}function M(n,r){return r*n.radius}function e(n,r,t,c){var s=S(n,g([t,r])),i=s[0],x=s[1],p=S(n,g([c,r])),v=p[0],f=p[1];if(r===0)return["M"+i+","+x,"L"+v+","+f].join(" ");var y=M(n,1/Math.abs(r));return["M"+i+","+x,"A"+y+","+y+" 0 0,"+(r<0?1:0)+" "+v+","+f].join(" ")}function a(n,r,t,c){var s=M(n,1/(r+1)),i=S(n,g([r,t])),x=i[0],p=i[1],v=S(n,g([r,c])),f=v[0],y=v[1];if(A(t)!==A(c)){var o=S(n,g([r,0])),m=o[0],l=o[1];return["M"+x+","+p,"A"+s+","+s+" 0 0,"+(0<t?0:1)+" "+m+","+l,"A"+s+","+s+" 0 0,"+(c<0?0:1)+f+","+y].join(" ")}return["M"+x+","+p,"A"+s+","+s+" 0 0,"+(c<t?0:1)+" "+f+","+y].join(" ")}ee.exports={smith:g,reactanceArc:e,resistanceArc:a,smithTransform:S}},{}],638:[function(d,ee,te){var A=d("../get_data").getSubplotCalcData,g=d("../../lib").counterRegex,S=d("../polar/polar"),M=d("./constants"),e=M.attr,a=M.name,n=g(a),r={};r[e]={valType:"subplotid",dflt:a,editType:"calc"};function t(s){for(var i=s._fullLayout,x=s.calcdata,p=i._subplots[a],v=0;v<p.length;v++){var f=p[v],y=A(x,a,f),o=i[f]._subplot;o||(o=S(s,f,!0),i[f]._subplot=o),o.plot(y,i,s._promises)}}function c(s,i,x,p){for(var v=p._subplots[a]||[],f=0;f<v.length;f++){var y=v[f],o=p[y]._subplot;if(!i[y]&&!!o){o.framework.remove();for(var m in o.clipPaths)o.clipPaths[m].remove()}}}ee.exports={attr:e,name:a,idRoot:a,idRegex:n,attrRegex:n,attributes:r,layoutAttributes:d("./layout_attributes"),supplyLayoutDefaults:d("./layout_defaults"),plot:t,clean:c,toSVG:d("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"../polar/polar":634,"./constants":636,"./layout_attributes":639,"./layout_defaults":640}],639:[function(d,ee,te){var A=d("../../components/color/attributes"),g=d("../cartesian/layout_attributes"),S=d("../domain").attributes,M=d("../../lib").extendFlat,e=d("../../plot_api/edit_types").overrideAll,a=e({color:g.color,showline:M({},g.showline,{dflt:!0}),linecolor:g.linecolor,linewidth:g.linewidth,showgrid:M({},g.showgrid,{dflt:!0}),gridcolor:g.gridcolor,gridwidth:g.gridwidth,griddash:g.griddash},"plot","from-root"),n=e({ticklen:g.ticklen,tickwidth:M({},g.tickwidth,{dflt:2}),tickcolor:g.tickcolor,showticklabels:g.showticklabels,showtickprefix:g.showtickprefix,tickprefix:g.tickprefix,showticksuffix:g.showticksuffix,ticksuffix:g.ticksuffix,tickfont:g.tickfont,tickformat:g.tickformat,hoverformat:g.hoverformat,layer:g.layer},"plot","from-root"),r=M({visible:M({},g.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:M({},g.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},a,n),t=M({visible:M({},g.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:g.ticks,editType:"calc"},a,n);ee.exports={domain:S({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:A.background},realaxis:r,imaginaryaxis:t,editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],640:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/color"),S=d("../../plot_api/plot_template"),M=d("../subplot_defaults"),e=d("../get_data").getSubplotData,a=d("../cartesian/prefix_suffix_defaults"),n=d("../cartesian/tick_label_defaults"),r=d("../cartesian/line_grid_defaults"),t=d("../cartesian/set_convert"),c=d("./layout_attributes"),s=d("./constants"),i=s.axisNames,x=v(function(f){return f.slice().reverse().map(function(y){return-y}).concat([0]).concat(f)},String);function p(f,y,o,m){var l=o("bgcolor");m.bgColor=g.combine(l,m.paper_bgcolor);var w=e(m.fullData,s.name,m.id),_=m.layoutOut,h;function b(G,K){return o(h+"."+G,K)}for(var u=0;u<i.length;u++){h=i[u],A.isPlainObject(f[h])||(f[h]={});var L=f[h],T=S.newContainer(y,h);T._id=T._name=h,T._attr=m.id+"."+h,T._traceIndices=w.map(function(G){return G._expandedIndex});var k=b("visible");if(T.type="linear",t(T,_),a(L,T,b,T.type),k){var P=h==="realaxis";if(P&&b("side"),P)b("tickvals");else{var z=x(y.realaxis.tickvals||c.realaxis.tickvals.dflt);b("tickvals",z)}var I,D,R,O,F=m.font||{};k&&(I=b("color"),D=I===L.color?I:F.color,R=F.size,O=F.family),n(L,T,b,T.type,{noTicklabelstep:!0,noAng:!P,noExp:!0,font:{color:D,size:R,family:O}}),A.coerce2(f,y,c,h+".ticklen"),A.coerce2(f,y,c,h+".tickwidth"),A.coerce2(f,y,c,h+".tickcolor",y.color);var N=b("ticks");N||(delete y[h].ticklen,delete y[h].tickwidth,delete y[h].tickcolor),r(L,T,b,{dfltColor:I,bgColor:m.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:c[h]}),b("layer")}b("hoverformat"),delete T.type,T._input=L}}ee.exports=function(y,o,m){M(y,o,m,{noUirevision:!0,type:s.name,attributes:c,handleDefaults:p,font:o.font,paper_bgcolor:o.paper_bgcolor,fullData:m,layoutOut:o})};function v(f,y){var o={};return function(m){var l=y?y(m):m;if(l in o)return o[l];var w=f(m);return o[l]=w,w}}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/set_convert":585,"../cartesian/tick_label_defaults":587,"../get_data":602,"../subplot_defaults":641,"./constants":636,"./layout_attributes":639}],641:[function(d,ee,te){var A=d("../lib"),g=d("../plot_api/plot_template"),S=d("./domain").defaults;ee.exports=function(e,a,n,r){var t=r.type,c=r.attributes,s=r.handleDefaults,i=r.partition||"x",x=a._subplots[t],p=x.length,v=p&&x[0].replace(/\d+$/,""),f,y;function o(_,h){return A.coerce(f,y,c,_,h)}for(var m=0;m<p;m++){var l=x[m];e[l]?f=e[l]:f=e[l]={},y=g.newContainer(a,l,v),r.noUirevision||o("uirevision",a.uirevision);var w={};w[i]=[m/p,(m+1)/p],S(y,a,o,w),r.id=l,s(f,y,o,r)}}},{"../lib":515,"../plot_api/plot_template":555,"./domain":593}],642:[function(d,ee,te){var A=d("../constants/docs");A.FORMAT_LINK,A.DATE_FORMAT_LINK;function g(S){var M=S.description?" "+S.description:"",e=S.keys||[];if(e.length>0){for(var a=[],n=0;n<e.length;n++)a[n]="`"+e[n]+"`";M=M+"Finally, the template string has access to ",e.length===1?M="variable "+a[0]:M="variables "+a.slice(0,-1).join(", ")+" and "+a.slice(-1)+"."}return M}te.hovertemplateAttrs=function(S,M){S=S||{},M=M||{},g(M);var e={valType:"string",dflt:"",editType:S.editType||"none"};return S.arrayOk!==!1&&(e.arrayOk=!0),e},te.texttemplateAttrs=function(S,M){S=S||{},M=M||{},g(M);var e={valType:"string",dflt:"",editType:S.editType||"calc"};return S.arrayOk!==!1&&(e.arrayOk=!0),e}},{"../constants/docs":486}],643:[function(d,ee,te){var A=d("./ternary"),g=d("../../plots/get_data").getSubplotCalcData,S=d("../../lib").counterRegex,M="ternary";te.name=M;var e=te.attr="subplot";te.idRoot=M,te.idRegex=te.attrRegex=S(M);var a=te.attributes={};a[e]={valType:"subplotid",dflt:"ternary",editType:"calc"},te.layoutAttributes=d("./layout_attributes"),te.supplyLayoutDefaults=d("./layout_defaults"),te.plot=function(r){for(var t=r._fullLayout,c=r.calcdata,s=t._subplots[M],i=0;i<s.length;i++){var x=s[i],p=g(c,M,x),v=t[x]._subplot;v||(v=new A({id:x,graphDiv:r,container:t._ternarylayer.node()},t),t[x]._subplot=v),v.plot(p,t,r._promises)}},te.clean=function(n,r,t,c){for(var s=c._subplots[M]||[],i=0;i<s.length;i++){var x=s[i],p=c[x]._subplot;!r[x]&&!!p&&(p.plotContainer.remove(),p.clipDef.remove(),p.clipDefRelative.remove(),p.layers["a-title"].remove(),p.layers["b-title"].remove(),p.layers["c-title"].remove())}}},{"../../lib":515,"../../plots/get_data":602,"./layout_attributes":644,"./layout_defaults":645,"./ternary":646}],644:[function(d,ee,te){var A=d("../../components/color/attributes"),g=d("../domain").attributes,S=d("../cartesian/layout_attributes"),M=d("../../plot_api/edit_types").overrideAll,e=d("../../lib/extend").extendFlat,a={title:{text:S.title.text,font:S.title.font},color:S.color,tickmode:S.tickmode,nticks:e({},S.nticks,{dflt:6,min:1}),tick0:S.tick0,dtick:S.dtick,tickvals:S.tickvals,ticktext:S.ticktext,ticks:S.ticks,ticklen:S.ticklen,tickwidth:S.tickwidth,tickcolor:S.tickcolor,ticklabelstep:S.ticklabelstep,showticklabels:S.showticklabels,showtickprefix:S.showtickprefix,tickprefix:S.tickprefix,showticksuffix:S.showticksuffix,ticksuffix:S.ticksuffix,showexponent:S.showexponent,exponentformat:S.exponentformat,minexponent:S.minexponent,separatethousands:S.separatethousands,tickfont:S.tickfont,tickangle:S.tickangle,tickformat:S.tickformat,tickformatstops:S.tickformatstops,hoverformat:S.hoverformat,showline:e({},S.showline,{dflt:!0}),linecolor:S.linecolor,linewidth:S.linewidth,showgrid:e({},S.showgrid,{dflt:!0}),gridcolor:S.gridcolor,gridwidth:S.gridwidth,griddash:S.griddash,layer:S.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:S._deprecated.title,titlefont:S._deprecated.titlefont}},n=ee.exports=M({domain:g({name:"ternary"}),bgcolor:{valType:"color",dflt:A.background},sum:{valType:"number",dflt:1,min:0},aaxis:a,baxis:a,caxis:a},"plot","from-root");n.uirevision={valType:"any",editType:"none"},n.aaxis.uirevision=n.baxis.uirevision=n.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],645:[function(d,ee,te){var A=d("../../components/color"),g=d("../../plot_api/plot_template"),S=d("../../lib"),M=d("../subplot_defaults"),e=d("../cartesian/tick_label_defaults"),a=d("../cartesian/prefix_suffix_defaults"),n=d("../cartesian/tick_mark_defaults"),r=d("../cartesian/tick_value_defaults"),t=d("../cartesian/line_grid_defaults"),c=d("./layout_attributes"),s=["aaxis","baxis","caxis"];ee.exports=function(v,f,y){M(v,f,y,{type:"ternary",attributes:c,handleDefaults:i,font:f.font,paper_bgcolor:f.paper_bgcolor})};function i(p,v,f,y){var o=f("bgcolor"),m=f("sum");y.bgColor=A.combine(o,y.paper_bgcolor);for(var l,w,_,h=0;h<s.length;h++)l=s[h],w=p[l]||{},_=g.newContainer(v,l),_._name=l,x(w,_,y,v);var b=v.aaxis,u=v.baxis,L=v.caxis;b.min+u.min+L.min>=m&&(b.min=0,u.min=0,L.min=0,p.aaxis&&delete p.aaxis.min,p.baxis&&delete p.baxis.min,p.caxis&&delete p.caxis.min)}function x(p,v,f,y){var o=c[v._name];function m(T,k){return S.coerce(p,v,o,T,k)}m("uirevision",y.uirevision),v.type="linear";var l=m("color"),w=l!==o.color.dflt?l:f.font.color,_=v._name,h=_.charAt(0).toUpperCase(),b="Component "+h,u=m("title.text",b);v._hovertitle=u===b?u:h,S.coerceFont(m,"title.font",{family:f.font.family,size:S.bigFont(f.font.size),color:w}),m("min"),r(p,v,m,"linear"),a(p,v,m,"linear"),e(p,v,m,"linear"),n(p,v,m,{outerTicks:!0});var L=m("showticklabels");L&&(S.coerceFont(m,"tickfont",{family:f.font.family,size:f.font.size,color:w}),m("tickangle"),m("tickformat")),t(p,v,m,{dfltColor:l,bgColor:f.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:o}),m("hoverformat"),m("layer")}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../subplot_defaults":641,"./layout_attributes":644}],646:[function(d,ee,te){var A=d("@plotly/d3"),g=d("tinycolor2"),S=d("../../registry"),M=d("../../lib"),e=M.strTranslate,a=M._,n=d("../../components/color"),r=d("../../components/drawing"),t=d("../cartesian/set_convert"),c=d("../../lib/extend").extendFlat,s=d("../plots"),i=d("../cartesian/axes"),x=d("../../components/dragelement"),p=d("../../components/fx"),v=d("../../components/dragelement/helpers"),f=v.freeMode,y=v.rectMode,o=d("../../components/titles"),m=d("../../components/selections").prepSelect,l=d("../../components/selections").selectOnClick,w=d("../../components/selections").clearOutline,_=d("../../components/selections").clearSelectionsCache,h=d("../cartesian/constants");function b(F,N){this.id=F.id,this.graphDiv=F.graphDiv,this.init(N),this.makeFramework(N),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}ee.exports=b;var u=b.prototype;u.init=function(F){this.container=F._ternarylayer,this.defs=F._defs,this.layoutId=F._uid,this.traceHash={},this.layers={}},u.plot=function(F,N){var G=this,K=N[G.id],W=N._size;G._hasClipOnAxisFalse=!1;for(var Y=0;Y<F.length;Y++){var re=F[Y][0].trace;if(re.cliponaxis===!1){G._hasClipOnAxisFalse=!0;break}}G.updateLayers(K),G.adjustLayout(K,W),s.generalUpdatePerTraceModule(G.graphDiv,G,F,K),G.layers.plotbg.select("path").call(n.fill,K.bgcolor)},u.makeFramework=function(F){var N=this,G=N.graphDiv,K=F[N.id],W=N.clipId="clip"+N.layoutId+N.id,Y=N.clipIdRelative="clip-relative"+N.layoutId+N.id;N.clipDef=M.ensureSingleById(F._clips,"clipPath",W,function(re){re.append("path").attr("d","M0,0Z")}),N.clipDefRelative=M.ensureSingleById(F._clips,"clipPath",Y,function(re){re.append("path").attr("d","M0,0Z")}),N.plotContainer=M.ensureSingle(N.container,"g",N.id),N.updateLayers(K),r.setClipUrl(N.layers.backplot,W,G),r.setClipUrl(N.layers.grids,W,G)},u.updateLayers=function(F){var N=this,G=N.layers,K=["draglayer","plotbg","backplot","grids"];F.aaxis.layer==="below traces"&&K.push("aaxis","aline"),F.baxis.layer==="below traces"&&K.push("baxis","bline"),F.caxis.layer==="below traces"&&K.push("caxis","cline"),K.push("frontplot"),F.aaxis.layer==="above traces"&&K.push("aaxis","aline"),F.baxis.layer==="above traces"&&K.push("baxis","bline"),F.caxis.layer==="above traces"&&K.push("caxis","cline");var W=N.plotContainer.selectAll("g.toplevel").data(K,String),Y=["agrid","bgrid","cgrid"];W.enter().append("g").attr("class",function(re){return"toplevel "+re}).each(function(re){var ue=A.select(this);G[re]=ue,re==="frontplot"?ue.append("g").classed("scatterlayer",!0):re==="backplot"?ue.append("g").classed("maplayer",!0):re==="plotbg"?ue.append("path").attr("d","M0,0Z"):re==="aline"||re==="bline"||re==="cline"?ue.append("path"):re==="grids"&&Y.forEach(function(j){G[j]=ue.append("g").classed("grid "+j,!0)})}),W.order()};var L=Math.sqrt(4/3);u.adjustLayout=function(F,N){var G=this,K=F.domain,W=(K.x[0]+K.x[1])/2,Y=(K.y[0]+K.y[1])/2,re=K.x[1]-K.x[0],ue=K.y[1]-K.y[0],j=re*N.w,q=ue*N.h,V=F.sum,U=F.aaxis.min,$=F.baxis.min,ne=F.caxis.min,X,Q,ie,se,ae,oe;j>L*q?(se=q,ie=se*L):(ie=j,se=ie/L),ae=re*ie/j,oe=ue*se/q,X=N.l+N.w*W-ie/2,Q=N.t+N.h*(1-Y)-se/2,G.x0=X,G.y0=Q,G.w=ie,G.h=se,G.sum=V,G.xaxis={type:"linear",range:[U+2*ne-V,V-U-2*$],domain:[W-ae/2,W+ae/2],_id:"x"},t(G.xaxis,G.graphDiv._fullLayout),G.xaxis.setScale(),G.xaxis.isPtWithinRange=function(ke){return ke.a>=G.aaxis.range[0]&&ke.a<=G.aaxis.range[1]&&ke.b>=G.baxis.range[1]&&ke.b<=G.baxis.range[0]&&ke.c>=G.caxis.range[1]&&ke.c<=G.caxis.range[0]},G.yaxis={type:"linear",range:[U,V-$-ne],domain:[Y-oe/2,Y+oe/2],_id:"y"},t(G.yaxis,G.graphDiv._fullLayout),G.yaxis.setScale(),G.yaxis.isPtWithinRange=function(){return!0};var be=G.yaxis.domain[0],ce=G.aaxis=c({},F.aaxis,{range:[U,V-$-ne],side:"left",tickangle:(+F.aaxis.tickangle||0)-30,domain:[be,be+oe*L],anchor:"free",position:0,_id:"y",_length:ie});t(ce,G.graphDiv._fullLayout),ce.setScale();var de=G.baxis=c({},F.baxis,{range:[V-U-ne,$],side:"bottom",domain:G.xaxis.domain,anchor:"free",position:0,_id:"x",_length:ie});t(de,G.graphDiv._fullLayout),de.setScale();var ye=G.caxis=c({},F.caxis,{range:[V-U-$,ne],side:"right",tickangle:(+F.caxis.tickangle||0)+30,domain:[be,be+oe*L],anchor:"free",position:0,_id:"y",_length:ie});t(ye,G.graphDiv._fullLayout),ye.setScale();var ge="M"+X+","+(Q+se)+"h"+ie+"l-"+ie/2+",-"+se+"Z";G.clipDef.select("path").attr("d",ge),G.layers.plotbg.select("path").attr("d",ge);var me="M0,"+se+"h"+ie+"l-"+ie/2+",-"+se+"Z";G.clipDefRelative.select("path").attr("d",me);var Ee=e(X,Q);G.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Ee),G.clipDefRelative.select("path").attr("transform",null);var Pe=e(X-de._offset,Q+se);G.layers.baxis.attr("transform",Pe),G.layers.bgrid.attr("transform",Pe);var Ne=e(X+ie/2,Q)+"rotate(30)"+e(0,-ce._offset);G.layers.aaxis.attr("transform",Ne),G.layers.agrid.attr("transform",Ne);var we=e(X+ie/2,Q)+"rotate(-30)"+e(0,-ye._offset);G.layers.caxis.attr("transform",we),G.layers.cgrid.attr("transform",we),G.drawAxes(!0),G.layers.aline.select("path").attr("d",ce.showline?"M"+X+","+(Q+se)+"l"+ie/2+",-"+se:"M0,0").call(n.stroke,ce.linecolor||"#000").style("stroke-width",(ce.linewidth||0)+"px"),G.layers.bline.select("path").attr("d",de.showline?"M"+X+","+(Q+se)+"h"+ie:"M0,0").call(n.stroke,de.linecolor||"#000").style("stroke-width",(de.linewidth||0)+"px"),G.layers.cline.select("path").attr("d",ye.showline?"M"+(X+ie/2)+","+Q+"l"+ie/2+","+se:"M0,0").call(n.stroke,ye.linecolor||"#000").style("stroke-width",(ye.linewidth||0)+"px"),G.graphDiv._context.staticPlot||G.initInteractions(),r.setClipUrl(G.layers.frontplot,G._hasClipOnAxisFalse?null:G.clipId,G.graphDiv)},u.drawAxes=function(F){var N=this,G=N.graphDiv,K=N.id.substr(7)+"title",W=N.layers,Y=N.aaxis,re=N.baxis,ue=N.caxis;if(N.drawAx(Y),N.drawAx(re),N.drawAx(ue),F){var j=Math.max(Y.showticklabels?Y.tickfont.size/2:0,(ue.showticklabels?ue.tickfont.size*.75:0)+(ue.ticks==="outside"?ue.ticklen*.87:0)),q=(re.showticklabels?re.tickfont.size:0)+(re.ticks==="outside"?re.ticklen:0)+3;W["a-title"]=o.draw(G,"a"+K,{propContainer:Y,propName:N.id+".aaxis.title",placeholder:a(G,"Click to enter Component A title"),attributes:{x:N.x0+N.w/2,y:N.y0-Y.title.font.size/3-j,"text-anchor":"middle"}}),W["b-title"]=o.draw(G,"b"+K,{propContainer:re,propName:N.id+".baxis.title",placeholder:a(G,"Click to enter Component B title"),attributes:{x:N.x0-q,y:N.y0+N.h+re.title.font.size*.83+q,"text-anchor":"middle"}}),W["c-title"]=o.draw(G,"c"+K,{propContainer:ue,propName:N.id+".caxis.title",placeholder:a(G,"Click to enter Component C title"),attributes:{x:N.x0+N.w+q,y:N.y0+N.h+ue.title.font.size*.83+q,"text-anchor":"middle"}})}},u.drawAx=function(F){var N=this,G=N.graphDiv,K=F._name,W=K.charAt(0),Y=F._id,re=N.layers[K],ue=30,j=W+"tickLayout",q=T(F);N[j]!==q&&(re.selectAll("."+Y+"tick").remove(),N[j]=q),F.setScale();var V=i.calcTicks(F),U=i.clipEnds(F,V),$=i.makeTransTickFn(F),ne=i.getTickSigns(F)[2],X=M.deg2rad(ue),Q=ne*(F.linewidth||1)/2,ie=ne*F.ticklen,se=N.w,ae=N.h,oe=W==="b"?"M0,"+Q+"l"+Math.sin(X)*ie+","+Math.cos(X)*ie:"M"+Q+",0l"+Math.cos(X)*ie+","+-Math.sin(X)*ie,be={a:"M0,0l"+ae+",-"+se/2,b:"M0,0l-"+se/2+",-"+ae,c:"M0,0l-"+ae+","+se/2}[W];i.drawTicks(G,F,{vals:F.ticks==="inside"?U:V,layer:re,path:oe,transFn:$,crisp:!1}),i.drawGrid(G,F,{vals:U,layer:N.layers[W+"grid"],path:be,transFn:$,crisp:!1}),i.drawLabels(G,F,{vals:V,layer:re,transFn:$,labelFns:i.makeLabelFns(F,0,ue)})};function T(F){return F.ticks+String(F.ticklen)+String(F.showticklabels)}var k=h.MINZOOM/2+.87,P="m-0.87,.5h"+k+"v3h-"+(k+5.2)+"l"+(k/2+2.6)+",-"+(k*.87+4.5)+"l2.6,1.5l-"+k/2+","+k*.87+"Z",z="m0.87,.5h-"+k+"v3h"+(k+5.2)+"l-"+(k/2+2.6)+",-"+(k*.87+4.5)+"l-2.6,1.5l"+k/2+","+k*.87+"Z",I="m0,1l"+k/2+","+k*.87+"l2.6,-1.5l-"+(k/2+2.6)+",-"+(k*.87+4.5)+"l-"+(k/2+2.6)+","+(k*.87+4.5)+"l2.6,1.5l"+k/2+",-"+k*.87+"Z",D="m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z",R=!0;u.clearOutline=function(){_(this.dragOptions),w(this.dragOptions.gd)},u.initInteractions=function(){var F=this,N=F.layers.plotbg.select("path").node(),G=F.graphDiv,K=G._fullLayout._zoomlayer,W,Y;this.dragOptions={element:N,gd:G,plotinfo:{id:F.id,domain:G._fullLayout[F.id].domain,xaxis:F.xaxis,yaxis:F.yaxis},subplot:F.id,prepFn:function(Pe,Ne,we){F.dragOptions.xaxes=[F.xaxis],F.dragOptions.yaxes=[F.yaxis],W=G._fullLayout._invScaleX,Y=G._fullLayout._invScaleY;var ke=F.dragOptions.dragmode=G._fullLayout.dragmode;f(ke)?F.dragOptions.minDrag=1:F.dragOptions.minDrag=void 0,ke==="zoom"?(F.dragOptions.moveFn=de,F.dragOptions.clickFn=se,F.dragOptions.doneFn=ye,ae(Pe,Ne,we)):ke==="pan"?(F.dragOptions.moveFn=me,F.dragOptions.clickFn=se,F.dragOptions.doneFn=Ee,ge(),F.clearOutline(G)):(y(ke)||f(ke))&&m(Pe,Ne,we,F.dragOptions,ke)}};var re,ue,j,q,V,U,$,ne,X,Q;function ie(Pe){var Ne={};return Ne[F.id+".aaxis.min"]=Pe.a,Ne[F.id+".baxis.min"]=Pe.b,Ne[F.id+".caxis.min"]=Pe.c,Ne}function se(Pe,Ne){var we=G._fullLayout.clickmode;O(G),Pe===2&&(G.emit("plotly_doubleclick",null),S.call("_guiRelayout",G,ie({a:0,b:0,c:0}))),we.indexOf("select")>-1&&Pe===1&&l(Ne,G,[F.xaxis],[F.yaxis],F.id,F.dragOptions),we.indexOf("event")>-1&&p.click(G,Ne,F.id)}function ae(Pe,Ne,we){var ke=N.getBoundingClientRect();re=Ne-ke.left,ue=we-ke.top,G._fullLayout._calcInverseTransform(G);var Xe=G._fullLayout._invTransform,He=M.apply3DTransform(Xe)(re,ue);re=He[0],ue=He[1],j={a:F.aaxis.range[0],b:F.baxis.range[1],c:F.caxis.range[1]},V=j,q=F.aaxis.range[1]-j.a,U=g(F.graphDiv._fullLayout[F.id].bgcolor).getLuminance(),$="M0,"+F.h+"L"+F.w/2+", 0L"+F.w+","+F.h+"Z",ne=!1,X=K.append("path").attr("class","zoombox").attr("transform",e(F.x0,F.y0)).style({fill:U>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",$),Q=K.append("path").attr("class","zoombox-corners").attr("transform",e(F.x0,F.y0)).style({fill:n.background,stroke:n.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),F.clearOutline(G)}function oe(Pe,Ne){return 1-Ne/F.h}function be(Pe,Ne){return 1-(Pe+(F.h-Ne)/Math.sqrt(3))/F.w}function ce(Pe,Ne){return(Pe-(F.h-Ne)/Math.sqrt(3))/F.w}function de(Pe,Ne){var we=re+Pe*W,ke=ue+Ne*Y,Xe=Math.max(0,Math.min(1,oe(re,ue),oe(we,ke))),He=Math.max(0,Math.min(1,be(re,ue),be(we,ke))),Ie=Math.max(0,Math.min(1,ce(re,ue),ce(we,ke))),De=(Xe/2+Ie)*F.w,Ge=(1-Xe/2-He)*F.w,ht=(De+Ge)/2,Rt=Ge-De,Kt=(1-Xe)*F.h,It=Kt-Rt/L;Rt<h.MINZOOM?(V=j,X.attr("d",$),Q.attr("d","M0,0Z")):(V={a:j.a+Xe*q,b:j.b+He*q,c:j.c+Ie*q},X.attr("d",$+"M"+De+","+Kt+"H"+Ge+"L"+ht+","+It+"L"+De+","+Kt+"Z"),Q.attr("d","M"+re+","+ue+D+"M"+De+","+Kt+P+"M"+Ge+","+Kt+z+"M"+ht+","+It+I)),ne||(X.transition().style("fill",U>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),Q.transition().style("opacity",1).duration(200),ne=!0),G.emit("plotly_relayouting",ie(V))}function ye(){O(G),V!==j&&(S.call("_guiRelayout",G,ie(V)),R&&G.data&&G._context.showTips&&(M.notifier(a(G,"Double-click to zoom back out"),"long"),R=!1))}function ge(){j={a:F.aaxis.range[0],b:F.baxis.range[1],c:F.caxis.range[1]},V=j}function me(Pe,Ne){var we=Pe/F.xaxis._m,ke=Ne/F.yaxis._m;V={a:j.a-ke,b:j.b+(we+ke)/2,c:j.c-(we-ke)/2};var Xe=[V.a,V.b,V.c].sort(M.sorterAsc),He={a:Xe.indexOf(V.a),b:Xe.indexOf(V.b),c:Xe.indexOf(V.c)};Xe[0]<0&&(Xe[1]+Xe[0]/2<0?(Xe[2]+=Xe[0]+Xe[1],Xe[0]=Xe[1]=0):(Xe[2]+=Xe[0]/2,Xe[1]+=Xe[0]/2,Xe[0]=0),V={a:Xe[He.a],b:Xe[He.b],c:Xe[He.c]},Ne=(j.a-V.a)*F.yaxis._m,Pe=(j.c-V.c-j.b+V.b)*F.xaxis._m);var Ie=e(F.x0+Pe,F.y0+Ne);F.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Ie);var De=e(-Pe,-Ne);F.clipDefRelative.select("path").attr("transform",De),F.aaxis.range=[V.a,F.sum-V.b-V.c],F.baxis.range=[F.sum-V.a-V.c,V.b],F.caxis.range=[F.sum-V.a-V.b,V.c],F.drawAxes(!1),F._hasClipOnAxisFalse&&F.plotContainer.select(".scatterlayer").selectAll(".trace").call(r.hideOutsideRangePoints,F),G.emit("plotly_relayouting",ie(V))}function Ee(){S.call("_guiRelayout",G,ie(V))}N.onmousemove=function(Pe){p.hover(G,Pe,F.id),G._fullLayout._lasthover=N,G._fullLayout._hoversubplot=F.id},N.onmouseout=function(Pe){G._dragging||x.unhover(G,Pe)},x.init(this.dragOptions)};function O(F){A.select(F).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../lib":515,"../../lib/extend":505,"../../registry":647,"../cartesian/axes":566,"../cartesian/constants":573,"../cartesian/set_convert":585,"../plots":628,"@plotly/d3":58,tinycolor2:313}],647:[function(d,ee,te){var A=d("./lib/loggers"),g=d("./lib/noop"),S=d("./lib/push_unique"),M=d("./lib/is_plain_object"),e=d("./lib/dom").addStyleRule,a=d("./lib/extend"),n=d("./plots/attributes"),r=d("./plots/layout_attributes"),t=a.extendFlat,c=a.extendDeepAll;te.modules={},te.allCategories={},te.allTypes=[],te.subplotsRegistry={},te.transformsRegistry={},te.componentsRegistry={},te.layoutArrayContainers=[],te.layoutArrayRegexes=[],te.traceLayoutAttributes={},te.localeRegistry={},te.apiMethodRegistry={},te.collectableSubplotTypes=null,te.register=function(_){if(te.collectableSubplotTypes=null,_)_&&!Array.isArray(_)&&(_=[_]);else throw new Error("No argument passed to Plotly.register.");for(var h=0;h<_.length;h++){var b=_[h];if(!b)throw new Error("Invalid module was attempted to be registered!");switch(b.moduleType){case"trace":s(b);break;case"transform":p(b);break;case"component":x(b);break;case"locale":v(b);break;case"apiMethod":var u=b.name;te.apiMethodRegistry[u]=b.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},te.getModule=function(w){var _=te.modules[l(w)];return _?_._module:!1},te.traceIs=function(w,_){if(w=l(w),w==="various")return!1;var h=te.modules[w];return h||(w&&A.log("Unrecognized trace type "+w+"."),h=te.modules[n.type.dflt]),!!h.categories[_]},te.getTransformIndices=function(w,_){for(var h=[],b=w.transforms||[],u=0;u<b.length;u++)b[u].type===_&&h.push(u);return h},te.hasTransform=function(w,_){for(var h=w.transforms||[],b=0;b<h.length;b++)if(h[b].type===_)return!0;return!1},te.getComponentMethod=function(w,_){var h=te.componentsRegistry[w];return h&&h[_]||g},te.call=function(){var w=arguments[0],_=[].slice.call(arguments,1);return te.apiMethodRegistry[w].apply(null,_)};function s(w){var _=w.name,h=w.categories,b=w.meta;if(te.modules[_]){A.log("Type "+_+" already registered");return}te.subplotsRegistry[w.basePlotModule.name]||i(w.basePlotModule);for(var u={},L=0;L<h.length;L++)u[h[L]]=!0,te.allCategories[h[L]]=!0;te.modules[_]={_module:w,categories:u},b&&Object.keys(b).length&&(te.modules[_].meta=b),te.allTypes.push(_);for(var T in te.componentsRegistry)y(T,_);w.layoutAttributes&&t(te.traceLayoutAttributes,w.layoutAttributes);var k=w.basePlotModule,P=k.name;if(P==="mapbox"){var z=k.constants.styleRules;for(var I in z)e(".js-plotly-plot .plotly .mapboxgl-"+I,z[I])}(P==="geo"||P==="mapbox")&&window.PlotlyGeoAssets===void 0&&(window.PlotlyGeoAssets={topojson:{}})}function i(w){var _=w.name;if(te.subplotsRegistry[_]){A.log("Plot type "+_+" already registered.");return}f(w),te.subplotsRegistry[_]=w;for(var h in te.componentsRegistry)m(h,w.name)}function x(w){if(typeof w.name!="string")throw new Error("Component module *name* must be a string.");var _=w.name;te.componentsRegistry[_]=w,w.layoutAttributes&&(w.layoutAttributes._isLinkedToArray&&S(te.layoutArrayContainers,_),f(w));for(var h in te.modules)y(_,h);for(var b in te.subplotsRegistry)m(_,b);for(var u in te.transformsRegistry)o(_,u);w.schema&&w.schema.layout&&c(r,w.schema.layout)}function p(w){if(typeof w.name!="string")throw new Error("Transform module *name* must be a string.");var _="Transform module "+w.name,h=typeof w.transform=="function",b=typeof w.calcTransform=="function";if(!h&&!b)throw new Error(_+" is missing a *transform* or *calcTransform* method.");h&&b&&A.log([_+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),M(w.attributes)||A.log(_+" registered without an *attributes* object."),typeof w.supplyDefaults!="function"&&A.log(_+" registered without a *supplyDefaults* method."),te.transformsRegistry[w.name]=w;for(var u in te.componentsRegistry)o(u,w.name)}function v(w){var _=w.name,h=_.split("-")[0],b=w.dictionary,u=w.format,L=b&&Object.keys(b).length,T=u&&Object.keys(u).length,k=te.localeRegistry,P=k[_];if(P||(k[_]=P={}),h!==_){var z=k[h];z||(k[h]=z={}),L&&z.dictionary===P.dictionary&&(z.dictionary=b),T&&z.format===P.format&&(z.format=u)}L&&(P.dictionary=b),T&&(P.format=u)}function f(w){if(w.layoutAttributes){var _=w.layoutAttributes._arrayAttrRegexps;if(_)for(var h=0;h<_.length;h++)S(te.layoutArrayRegexes,_[h])}}function y(w,_){var h=te.componentsRegistry[w].schema;if(!(!h||!h.traces)){var b=h.traces[_];b&&c(te.modules[_]._module.attributes,b)}}function o(w,_){var h=te.componentsRegistry[w].schema;if(!(!h||!h.transforms)){var b=h.transforms[_];b&&c(te.transformsRegistry[_].attributes,b)}}function m(w,_){var h=te.componentsRegistry[w].schema;if(!(!h||!h.subplots)){var b=te.subplotsRegistry[_],u=b.layoutAttributes,L=b.attr==="subplot"?b.name:b.attr;Array.isArray(L)&&(L=L[0]);var T=h.subplots[L];u&&T&&c(u,T)}}function l(w){return typeof w=="object"&&(w=w.type),w}},{"./lib/dom":503,"./lib/extend":505,"./lib/is_plain_object":516,"./lib/loggers":519,"./lib/noop":524,"./lib/push_unique":530,"./plots/attributes":562,"./plots/layout_attributes":619}],648:[function(d,ee,te){var A=d("../registry"),g=d("../lib"),S=g.extendFlat,M=g.extendDeep;function e(n){var r;switch(n){case"themes__thumb":r={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":r={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:r={}}return r}function a(n){var r=["xaxis","yaxis","zaxis"];return r.indexOf(n.slice(0,5))>-1}ee.exports=function(r,t){var c,s=r.data,i=r.layout,x=M([],s),p=M({},i,e(t.tileClass)),v=r._context||{};if(t.width&&(p.width=t.width),t.height&&(p.height=t.height),t.tileClass==="thumbnail"||t.tileClass==="themes__thumb"){p.annotations=[];var f=Object.keys(p);for(c=0;c<f.length;c++)a(f[c])&&(p[f[c]].title={text:""});for(c=0;c<x.length;c++){var y=x[c];y.showscale=!1,y.marker&&(y.marker.showscale=!1),A.traceIs(y,"pie-like")&&(y.textposition="none")}}if(Array.isArray(t.annotations))for(c=0;c<t.annotations.length;c++)p.annotations.push(t.annotations[c]);var o=Object.keys(p).filter(function(h){return h.match(/^scene\d*$/)});if(o.length){var m={};for(t.tileClass==="thumbnail"&&(m={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),c=0;c<o.length;c++){var l=p[o[c]];l.xaxis||(l.xaxis={}),l.yaxis||(l.yaxis={}),l.zaxis||(l.zaxis={}),S(l.xaxis,m),S(l.yaxis,m),S(l.zaxis,m),l._scene=null}}var w=document.createElement("div");t.tileClass&&(w.className=t.tileClass);var _={gd:w,td:w,layout:p,data:x,config:{staticPlot:t.staticPlot===void 0?!0:t.staticPlot,plotGlPixelRatio:t.plotGlPixelRatio===void 0?2:t.plotGlPixelRatio,displaylogo:t.displaylogo||!1,showLink:t.showLink||!1,showTips:t.showTips||!1,mapboxAccessToken:v.mapboxAccessToken}};return t.setBackground!=="transparent"&&(_.config.setBackground=t.setBackground||"opaque"),_.gd.defaultLayout=e(t.tileClass),_}},{"../lib":515,"../registry":647}],649:[function(d,ee,te){var A=d("../lib"),g=d("../plot_api/to_image"),S=d("./filesaver"),M=d("./helpers");function e(a,n){var r;return A.isPlainObject(a)||(r=A.getGraphDiv(a)),n=n||{},n.format=n.format||"png",n.width=n.width||null,n.height=n.height||null,n.imageDataOnly=!0,new Promise(function(t,c){r&&r._snapshotInProgress&&c(new Error("Snapshotting already in progress.")),A.isIE()&&n.format!=="svg"&&c(new Error(M.MSG_IE_BAD_FORMAT)),r&&(r._snapshotInProgress=!0);var s=g(a,n),i=n.filename||a.fn||"newplot";i+="."+n.format.replace("-","."),s.then(function(x){return r&&(r._snapshotInProgress=!1),S(x,i,n.format)}).then(function(x){t(x)}).catch(function(x){r&&(r._snapshotInProgress=!1),c(x)})})}ee.exports=e},{"../lib":515,"../plot_api/to_image":558,"./filesaver":650,"./helpers":651}],650:[function(d,ee,te){var A=d("../lib"),g=d("./helpers");function S(M,e,a){var n=document.createElement("a"),r="download"in n,t=new Promise(function(c,s){var i,x;if(A.isIE())return i=g.createBlob(M,"svg"),window.navigator.msSaveBlob(i,e),i=null,c(e);if(r)return i=g.createBlob(M,a),x=g.createObjectURL(i),n.href=x,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),g.revokeObjectURL(x),i=null,c(e);if(A.isSafari()){var p=a==="svg"?",":";base64,";return g.octetStream(p+encodeURIComponent(M)),c(e)}s(new Error("download error"))});return t}ee.exports=S},{"../lib":515,"./helpers":651}],651:[function(d,ee,te){var A=d("../registry");te.getDelay=function(M){return M._has&&(M._has("gl3d")||M._has("gl2d")||M._has("mapbox"))?500:0},te.getRedrawFunc=function(M){return function(){A.getComponentMethod("colorbar","draw")(M)}},te.encodeSVG=function(M){return"data:image/svg+xml,"+encodeURIComponent(M)},te.encodeJSON=function(M){return"data:application/json,"+encodeURIComponent(M)};var g=window.URL||window.webkitURL;te.createObjectURL=function(M){return g.createObjectURL(M)},te.revokeObjectURL=function(M){return g.revokeObjectURL(M)},te.createBlob=function(M,e){if(e==="svg")return new window.Blob([M],{type:"image/svg+xml;charset=utf-8"});if(e==="full-json")return new window.Blob([M],{type:"application/json;charset=utf-8"});var a=S(window.atob(M));return new window.Blob([a],{type:"image/"+e})},te.octetStream=function(M){document.location.href="data:application/octet-stream"+M};function S(M){for(var e=M.length,a=new ArrayBuffer(e),n=new Uint8Array(a),r=0;r<e;r++)n[r]=M.charCodeAt(r);return a}te.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,te.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":647}],652:[function(d,ee,te){var A=d("./helpers"),g={getDelay:A.getDelay,getRedrawFunc:A.getRedrawFunc,clone:d("./cloneplot"),toSVG:d("./tosvg"),svgToImg:d("./svgtoimg"),toImage:d("./toimage"),downloadImage:d("./download")};ee.exports=g},{"./cloneplot":648,"./download":649,"./helpers":651,"./svgtoimg":653,"./toimage":654,"./tosvg":655}],653:[function(d,ee,te){var A=d("../lib"),g=d("events").EventEmitter,S=d("./helpers");function M(e){var a=e.emitter||new g,n=new Promise(function(r,t){var c=window.Image,s=e.svg,i=e.format||"png";if(A.isIE()&&i!=="svg"){var x=new Error(S.MSG_IE_BAD_FORMAT);return t(x),e.promise?n:a.emit("error",x)}var p=e.canvas,v=e.scale||1,f=e.width||300,y=e.height||150,o=v*f,m=v*y,l=p.getContext("2d",{willReadFrequently:!0}),w=new c,_,h;i==="svg"||A.isSafari()?h=S.encodeSVG(s):(_=S.createBlob(s,"svg"),h=S.createObjectURL(_)),p.width=o,p.height=m,w.onload=function(){var b;switch(_=null,S.revokeObjectURL(h),i!=="svg"&&l.drawImage(w,0,0,o,m),i){case"jpeg":b=p.toDataURL("image/jpeg");break;case"png":b=p.toDataURL("image/png");break;case"webp":b=p.toDataURL("image/webp");break;case"svg":b=h;break;default:var u="Image format is not jpeg, png, svg or webp.";if(t(new Error(u)),!e.promise)return a.emit("error",u)}r(b),e.promise||a.emit("success",b)},w.onerror=function(b){if(_=null,S.revokeObjectURL(h),t(b),!e.promise)return a.emit("error",b)},w.src=h});return e.promise?n:a}ee.exports=M},{"../lib":515,"./helpers":651,events:84}],654:[function(d,ee,te){var A=d("events").EventEmitter,g=d("../registry"),S=d("../lib"),M=d("./helpers"),e=d("./cloneplot"),a=d("./tosvg"),n=d("./svgtoimg");function r(t,c){var s=new A,i=e(t,{format:"png"}),x=i.gd;x.style.position="absolute",x.style.left="-5000px",document.body.appendChild(x);function p(){var f=M.getDelay(x._fullLayout);setTimeout(function(){var y=a(x),o=document.createElement("canvas");o.id=S.randstr(),s=n({format:c.format,width:x._fullLayout.width,height:x._fullLayout.height,canvas:o,emitter:s,svg:y}),s.clean=function(){x&&document.body.removeChild(x)}},f)}var v=M.getRedrawFunc(x);return g.call("_doPlot",x,i.data,i.layout,i.config).then(v).then(p).catch(function(f){s.emit("error",f)}),s}ee.exports=r},{"../lib":515,"../registry":647,"./cloneplot":648,"./helpers":651,"./svgtoimg":653,"./tosvg":655,events:84}],655:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../lib"),S=d("../components/drawing"),M=d("../components/color"),e=d("../constants/xmlns_namespaces"),a=/"/g,n="TOBESTRIPPED",r=new RegExp('("'+n+")|("+n+'")',"g");function t(s){var i=A.select("body").append("div").style({display:"none"}).html(""),x=s.replace(/(&[^;]*;)/gi,function(p){return p==="&lt;"?"&#60;":p==="&rt;"?"&#62;":p.indexOf("<")!==-1||p.indexOf(">")!==-1?"":i.html(p).text()});return i.remove(),x}function c(s){return s.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}ee.exports=function(i,x,p){var v=i._fullLayout,f=v._paper,y=v._toppaper,o=v.width,m=v.height,l;f.insert("rect",":first-child").call(S.setRect,0,0,o,m).call(M.fill,v.paper_bgcolor);var w=v._basePlotModules||[];for(l=0;l<w.length;l++){var _=w[l];_.toSVG&&_.toSVG(i)}if(y){var h=y.node().childNodes,b=Array.prototype.slice.call(h);for(l=0;l<b.length;l++){var u=b[l];u.childNodes.length&&f.node().appendChild(u)}}v._draggers&&v._draggers.remove(),f.node().style.background="",f.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var T=A.select(this);if(this.style.visibility==="hidden"||this.style.display==="none"){T.remove();return}else T.style({visibility:null,display:null});var k=this.style.fontFamily;k&&k.indexOf('"')!==-1&&T.style("font-family",k.replace(a,n))}),f.selectAll(".gradient_filled,.pattern_filled").each(function(){var T=A.select(this),k=this.style.fill;k&&k.indexOf("url(")!==-1&&T.style("fill",k.replace(a,n));var P=this.style.stroke;P&&P.indexOf("url(")!==-1&&T.style("stroke",P.replace(a,n))}),(x==="pdf"||x==="eps")&&f.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),f.node().setAttributeNS(e.xmlns,"xmlns",e.svg),f.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),x==="svg"&&p&&(f.attr("width",p*o),f.attr("height",p*m),f.attr("viewBox","0 0 "+o+" "+m));var L=new window.XMLSerializer().serializeToString(f.node());return L=t(L),L=c(L),L=L.replace(r,"'"),g.isIE()&&(L=L.replace(/"/gi,"'"),L=L.replace(/(\('#)([^']*)('\))/gi,'("#$2")'),L=L.replace(/(\\')/gi,'"')),L}},{"../components/color":367,"../components/drawing":389,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],656:[function(d,ee,te){var A=d("../../lib");ee.exports=function(S,M){for(var e=0;e<S.length;e++)S[e].i=e;A.mergeArray(M.text,S,"tx"),A.mergeArray(M.hovertext,S,"htx");var a=M.marker;if(a){A.mergeArray(a.opacity,S,"mo",!0),A.mergeArray(a.color,S,"mc");var n=a.line;n&&(A.mergeArray(n.color,S,"mlc"),A.mergeArrayCastPositive(n.width,S,"mlw"))}}},{"../../lib":515}],657:[function(d,ee,te){var A=d("../scatter/attributes"),g=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../../plots/template_attributes").texttemplateAttrs,e=d("../../components/colorscale/attributes"),a=d("../../plots/font_attributes"),n=d("./constants"),r=d("../../components/drawing/attributes").pattern,t=d("../../lib/extend").extendFlat,c=a({editType:"calc",arrayOk:!0,colorEditType:"style"}),s=A.marker,i=s.line,x=t({},i.width,{dflt:0}),p=t({width:x,editType:"calc"},e("marker.line")),v=t({line:p,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:r});ee.exports={x:A.x,x0:A.x0,dx:A.dx,y:A.y,y0:A.y0,dy:A.dy,xperiod:A.xperiod,yperiod:A.yperiod,xperiod0:A.xperiod0,yperiod0:A.yperiod0,xperiodalignment:A.xperiodalignment,yperiodalignment:A.yperiodalignment,xhoverformat:g("x"),yhoverformat:g("y"),text:A.text,texttemplate:M({editType:"plot"},{keys:n.eventDataKeys}),hovertext:A.hovertext,hovertemplate:S({},{keys:n.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:t({},c,{}),insidetextfont:t({},c,{}),outsidetextfont:t({},c,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:t({},A.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:v,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:A.selected.marker.opacity,color:A.selected.marker.color,editType:"style"},textfont:A.selected.textfont,editType:"style"},unselected:{marker:{opacity:A.unselected.marker.opacity,color:A.unselected.marker.color,editType:"style"},textfont:A.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936,"./constants":659}],658:[function(d,ee,te){var A=d("../../plots/cartesian/axes"),g=d("../../plots/cartesian/align_period"),S=d("../../components/colorscale/helpers").hasColorscale,M=d("../../components/colorscale/calc"),e=d("./arrays_to_calcdata"),a=d("../scatter/calc_selection");ee.exports=function(r,t){var c=A.getFromId(r,t.xaxis||"x"),s=A.getFromId(r,t.yaxis||"y"),i,x,p,v,f,y,o={msUTC:!!(t.base||t.base===0)};t.orientation==="h"?(i=c.makeCalcdata(t,"x",o),p=s.makeCalcdata(t,"y"),v=g(t,s,"y",p),f=!!t.yperiodalignment,y="y"):(i=s.makeCalcdata(t,"y",o),p=c.makeCalcdata(t,"x"),v=g(t,c,"x",p),f=!!t.xperiodalignment,y="x"),x=v.vals;for(var m=Math.min(x.length,i.length),l=new Array(m),w=0;w<m;w++)l[w]={p:x[w],s:i[w]},f&&(l[w].orig_p=p[w],l[w][y+"End"]=v.ends[w],l[w][y+"Start"]=v.starts[w]),t.ids&&(l[w].id=String(t.ids[w]));return S(t,"marker")&&M(r,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),S(t,"marker.line")&&M(r,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(l,t),a(l,t),l}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":656}],659:[function(d,ee,te){ee.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],660:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib").isArrayOrTypedArray,S=d("../../constants/numerical").BADNUM,M=d("../../registry"),e=d("../../plots/cartesian/axes"),a=d("../../plots/cartesian/constraints").getAxisGroup,n=d("./sieve.js");function r(L,T){for(var k=T.xaxis,P=T.yaxis,z=L._fullLayout,I=L._fullData,D=L.calcdata,R=[],O=[],F=0;F<I.length;F++){var N=I[F];if(N.visible===!0&&M.traceIs(N,"bar")&&N.xaxis===k._id&&N.yaxis===P._id&&(N.orientation==="h"?R.push(D[F]):O.push(D[F]),N._computePh))for(var G=L.calcdata[F],K=0;K<G.length;K++)typeof G[K].ph0=="function"&&(G[K].ph0=G[K].ph0()),typeof G[K].ph1=="function"&&(G[K].ph1=G[K].ph1())}var W={xCat:k.type==="category"||k.type==="multicategory",yCat:P.type==="category"||P.type==="multicategory",mode:z.barmode,norm:z.barnorm,gap:z.bargap,groupgap:z.bargroupgap};t(L,k,P,O,W),t(L,P,k,R,W)}function t(L,T,k,P,z){if(!!P.length){var I,D,R,O,F;switch(c(k,P),z.mode){case"overlay":s(T,k,P,z);break;case"group":for(I=[],D=[],R=0;R<P.length;R++)O=P[R],F=O[0].trace,F.offset===void 0?D.push(O):I.push(O);D.length&&i(L,T,k,D,z),I.length&&s(T,k,I,z);break;case"stack":case"relative":for(I=[],D=[],R=0;R<P.length;R++)O=P[R],F=O[0].trace,F.base===void 0?D.push(O):I.push(O);D.length&&x(L,T,k,D,z),I.length&&s(T,k,I,z);break}b(P,T)}}function c(L,T){var k,P;for(k=0;k<T.length;k++){var z=T[k],I=z[0].trace,D=I.type==="funnel"?I._base:I.base,R,O=I.orientation==="h"?I.xcalendar:I.ycalendar,F=L.type==="category"||L.type==="multicategory"?function(){return null}:L.d2c;if(g(D)){for(P=0;P<Math.min(D.length,z.length);P++)R=F(D[P],0,O),A(R)?(z[P].b=+R,z[P].hasB=1):z[P].b=0;for(;P<z.length;P++)z[P].b=0}else{R=F(D,0,O);var N=A(R);for(R=N?R:0,P=0;P<z.length;P++)z[P].b=R,N&&(z[P].hasB=1)}}}function s(L,T,k,P){for(var z=0;z<k.length;z++){var I=k[z],D=new n([I],{posAxis:L,sepNegVal:!1,overlapNoMerge:!P.norm});p(L,D,P),P.norm?(w(D),h(T,D,P)):m(T,D)}}function i(L,T,k,P,z){var I=new n(P,{posAxis:T,sepNegVal:!1,overlapNoMerge:!z.norm});v(L,T,I,z),_(I,T),z.norm?(w(I),h(k,I,z)):m(k,I)}function x(L,T,k,P,z){var I=new n(P,{posAxis:T,sepNegVal:z.mode==="relative",overlapNoMerge:!(z.norm||z.mode==="stack"||z.mode==="relative")});p(T,I,z),l(k,I,z);for(var D=0;D<P.length;D++)for(var R=P[D],O=0;O<R.length;O++){var F=R[O];if(F.s!==S){var N=F.b+F.s===I.get(F.p,F.s);N&&(F._outmost=!0)}}z.norm&&h(k,I,z)}function p(L,T,k){for(var P=T.minDiff,z=T.traces,I=P*(1-k.gap),D=I,R=D*(1-(k.groupgap||0)),O=-R/2,F=0;F<z.length;F++){var N=z[F],G=N[0].t;G.barwidth=R,G.poffset=O,G.bargroupwidth=I,G.bardelta=P}T.binWidth=z[0][0].t.barwidth/100,f(T),y(L,T),o(L,T)}function v(L,T,k,P){for(var z=L._fullLayout,I=k.positions,D=k.distinctPositions,R=k.minDiff,O=k.traces,F=O.length,N=I.length!==D.length,G=R*(1-P.gap),K=a(z,T._id)+O[0][0].trace.orientation,W=z._alignmentOpts[K]||{},Y=0;Y<F;Y++){var re=O[Y],ue=re[0].trace,j=W[ue.alignmentgroup]||{},q=Object.keys(j.offsetGroups||{}).length,V;q?V=G/q:V=N?G/F:G;var U=V*(1-(P.groupgap||0)),$;q?$=((2*ue._offsetIndex+1-q)*V-U)/2:$=N?((2*Y+1-F)*V-U)/2:-U/2;var ne=re[0].t;ne.barwidth=U,ne.poffset=$,ne.bargroupwidth=G,ne.bardelta=R}k.binWidth=O[0][0].t.barwidth/100,f(k),y(T,k),o(T,k,N)}function f(L){var T=L.traces,k,P;for(k=0;k<T.length;k++){var z=T[k],I=z[0],D=I.trace,R=I.t,O=D._offset||D.offset,F=R.poffset,N;if(g(O)){for(N=Array.prototype.slice.call(O,0,z.length),P=0;P<N.length;P++)A(N[P])||(N[P]=F);for(P=N.length;P<z.length;P++)N.push(F);R.poffset=N}else O!==void 0&&(R.poffset=O);var G=D._width||D.width,K=R.barwidth;if(g(G)){var W=Array.prototype.slice.call(G,0,z.length);for(P=0;P<W.length;P++)A(W[P])||(W[P]=K);for(P=W.length;P<z.length;P++)W.push(K);if(R.barwidth=W,O===void 0){for(N=[],P=0;P<z.length;P++)N.push(F+(K-W[P])/2);R.poffset=N}}else G!==void 0&&(R.barwidth=G,O===void 0&&(R.poffset=F+(K-G)/2))}}function y(L,T){for(var k=T.traces,P=u(L),z=0;z<k.length;z++)for(var I=k[z],D=I[0].t,R=D.poffset,O=Array.isArray(R),F=D.barwidth,N=Array.isArray(F),G=0;G<I.length;G++){var K=I[G],W=K.w=N?F[G]:F;K[P]=K.p+(O?R[G]:R)+W/2}}function o(L,T,k){var P=T.traces,z=T.minDiff,I=z/2;e.minDtick(L,T.minDiff,T.distinctPositions[0],k);for(var D=0;D<P.length;D++){var R=P[D],O=R[0],F=O.trace,N=[],G,K,W,Y;for(Y=0;Y<R.length;Y++)G=R[Y],K=G.p-I,W=G.p+I,N.push(K,W);if(F.width||F.offset){var re=O.t,ue=re.poffset,j=re.barwidth,q=Array.isArray(ue),V=Array.isArray(j);for(Y=0;Y<R.length;Y++){G=R[Y];var U=q?ue[Y]:ue,$=V?j[Y]:j;K=G.p+U,W=K+$,N.push(K,W)}}F._extremes[L._id]=e.findExtremes(L,N,{padded:!1})}}function m(L,T){for(var k=T.traces,P=u(L),z=0;z<k.length;z++){for(var I=k[z],D=I[0].trace,R=[],O=!1,F=0;F<I.length;F++){var N=I[F],G=N.b,K=G+N.s;N[P]=K,R.push(K),N.hasB&&R.push(G),(!N.hasB||!N.b)&&(O=!0)}D._extremes[L._id]=e.findExtremes(L,R,{tozero:O,padded:!0})}}function l(L,T,k){var P=u(L),z=T.traces,I,D,R,O,F,N;for(O=0;O<z.length;O++)if(I=z[O],D=I[0].trace,D.type==="funnel")for(F=0;F<I.length;F++)N=I[F],N.s!==S&&T.put(N.p,-.5*N.s);for(O=0;O<z.length;O++){I=z[O],D=I[0].trace,R=D.type==="funnel";var G=[];for(F=0;F<I.length;F++)if(N=I[F],N.s!==S){var K;R?K=N.s:K=N.s+N.b;var W=T.put(N.p,K),Y=W+K;N.b=W,N[P]=Y,k.norm||(G.push(Y),N.hasB&&G.push(W))}k.norm||(D._extremes[L._id]=e.findExtremes(L,G,{tozero:!0,padded:!0}))}}function w(L){for(var T=L.traces,k=0;k<T.length;k++)for(var P=T[k],z=0;z<P.length;z++){var I=P[z];I.s!==S&&L.put(I.p,I.b+I.s)}}function _(L,T){for(var k=L.traces,P=0;P<k.length;P++){var z=k[P],I=z[0].trace;if(I.base===void 0)for(var D=new n([z],{posAxis:T,sepNegVal:!0,overlapNoMerge:!0}),R=0;R<z.length;R++){var O=z[R];if(O.p!==S){var F=D.put(O.p,O.b+O.s);F&&(O.b=F)}}}}function h(L,T,k){var P=T.traces,z=u(L),I=k.norm==="fraction"?1:100,D=I/1e9,R=L.l2c(L.c2l(0)),O=k.mode==="stack"?I:R;function F($){return A(L.c2l($))&&($<R-D||$>O+D||!A(R))}for(var N=0;N<P.length;N++){for(var G=P[N],K=G[0].trace,W=[],Y=!1,re=!1,ue=0;ue<G.length;ue++){var j=G[ue];if(j.s!==S){var q=Math.abs(I/T.get(j.p,j.s));j.b*=q,j.s*=q;var V=j.b,U=V+j.s;j[z]=U,W.push(U),re=re||F(U),j.hasB&&(W.push(V),re=re||F(V)),(!j.hasB||!j.b)&&(Y=!0)}}K._extremes[L._id]=e.findExtremes(L,W,{tozero:Y,padded:re})}}function b(L,T){var k=u(T),P={},z,I,D,R=1/0,O=-1/0;for(z=0;z<L.length;z++)for(D=L[z],I=0;I<D.length;I++){var F=D[I].p;A(F)&&(R=Math.min(R,F),O=Math.max(O,F))}var N=1e4/(O-R),G=P.round=function(q){return String(Math.round(N*(q-R)))};for(z=0;z<L.length;z++){D=L[z],D[0].t.extents=P;var K=D[0].t.poffset,W=Array.isArray(K);for(I=0;I<D.length;I++){var Y=D[I],re=Y[k]-Y.w/2;if(A(re)){var ue=Y[k]+Y.w/2,j=G(Y.p);P[j]?P[j]=[Math.min(re,P[j][0]),Math.max(ue,P[j][1])]:P[j]=[re,ue]}Y.p0=Y.p+(W?K[I]:K),Y.p1=Y.p0+Y.w,Y.s0=Y.b,Y.s1=Y.s0+Y.s}}}function u(L){return L._id.charAt(0)}ee.exports={crossTraceCalc:r,setGroupPositions:t}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574,"../../registry":647,"./sieve.js":670,"fast-isnumeric":190}],661:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/color"),S=d("../../registry"),M=d("../scatter/xy_defaults"),e=d("../scatter/period_defaults"),a=d("./style_defaults"),n=d("../../plots/cartesian/constraints").getAxisGroup,r=d("./attributes"),t=A.coerceFont;function c(p,v,f,y){function o(h,b){return A.coerce(p,v,r,h,b)}var m=M(p,v,y,o);if(!m){v.visible=!1;return}e(p,v,y,o),o("xhoverformat"),o("yhoverformat"),o("orientation",v.x&&!v.y?"h":"v"),o("base"),o("offset"),o("width"),o("text"),o("hovertext"),o("hovertemplate");var l=o("textposition");x(p,v,y,o,l,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),a(p,v,o,f,y);var w=(v.marker.line||{}).color,_=S.getComponentMethod("errorbars","supplyDefaults");_(p,v,w||g.defaultLine,{axis:"y"}),_(p,v,w||g.defaultLine,{axis:"x",inherit:"y"}),A.coerceSelectionMarkerOpacity(v,o)}function s(p,v,f,y){var o=v.orientation,m=v[{v:"x",h:"y"}[o]+"axis"],l=n(f,m)+o,w=f._alignmentOpts||{},_=y("alignmentgroup"),h=w[l];h||(h=w[l]={});var b=h[_];b?b.traces.push(v):b=h[_]={traces:[v],alignmentIndex:Object.keys(h).length,offsetGroups:{}};var u=y("offsetgroup"),L=b.offsetGroups,T=L[u];u&&(T||(T=L[u]={offsetIndex:Object.keys(L).length}),v._offsetIndex=T.offsetIndex)}function i(p,v){var f,y;function o(l){return A.coerce(y._input,y,r,l)}if(v.barmode==="group")for(var m=0;m<p.length;m++)y=p[m],y.type==="bar"&&(f=y._input,s(f,y,v,o))}function x(p,v,f,y,o,m){m=m||{};var l=m.moduleHasSelected!==!1,w=m.moduleHasUnselected!==!1,_=m.moduleHasConstrain!==!1,h=m.moduleHasCliponaxis!==!1,b=m.moduleHasTextangle!==!1,u=m.moduleHasInsideanchor!==!1,L=!!m.hasPathbar,T=Array.isArray(o)||o==="auto",k=T||o==="inside",P=T||o==="outside";if(k||P){var z=t(y,"textfont",f.font),I=A.extendFlat({},z),D=p.textfont&&p.textfont.color,R=!D;if(R&&delete I.color,t(y,"insidetextfont",I),L){var O=A.extendFlat({},z);R&&delete O.color,t(y,"pathbar.textfont",O)}P&&t(y,"outsidetextfont",z),l&&y("selected.textfont.color"),w&&y("unselected.textfont.color"),_&&y("constraintext"),h&&y("cliponaxis"),b&&y("textangle"),y("texttemplate")}k&&u&&y("insidetextanchor")}ee.exports={supplyDefaults:c,crossTraceDefaults:i,handleGroupingDefaults:s,handleText:x}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/constraints":574,"../../registry":647,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":657,"./style_defaults":672}],662:[function(d,ee,te){ee.exports=function(g,S,M){return g.x="xVal"in S?S.xVal:S.x,g.y="yVal"in S?S.yVal:S.y,S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),M.orientation==="h"?(g.label=g.y,g.value=g.x):(g.label=g.x,g.value=g.y),g}},{}],663:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("tinycolor2"),S=d("../../lib").isArrayOrTypedArray;te.coerceString=function(M,e,a){if(typeof e=="string"){if(e||!M.noBlank)return e}else if((typeof e=="number"||e===!0)&&!M.strict)return String(e);return a!==void 0?a:M.dflt},te.coerceNumber=function(M,e,a){if(A(e)){e=+e;var n=M.min,r=M.max,t=n!==void 0&&e<n||r!==void 0&&e>r;if(!t)return e}return a!==void 0?a:M.dflt},te.coerceColor=function(M,e,a){return g(e).isValid()?e:a!==void 0?a:M.dflt},te.coerceEnumerated=function(M,e,a){return M.coerceNumber&&(e=+e),M.values.indexOf(e)!==-1?e:a!==void 0?a:M.dflt},te.getValue=function(M,e){var a;return Array.isArray(M)?e<M.length&&(a=M[e]):a=M,a},te.getLineWidth=function(M,e){var a=0<e.mlw?e.mlw:S(M.marker.line.width)?0:M.marker.line.width;return a}},{"../../lib":515,"fast-isnumeric":190,tinycolor2:313}],664:[function(d,ee,te){var A=d("../../components/fx"),g=d("../../registry"),S=d("../../components/color"),M=d("../../lib").fillText,e=d("./helpers").getLineWidth,a=d("../../plots/cartesian/axes").hoverLabelText,n=d("../../constants/numerical").BADNUM;function r(s,i,x,p,v){var f=t(s,i,x,p,v);if(f){var y=f.cd,o=y[0].trace,m=y[f.index];return f.color=c(o,m),g.getComponentMethod("errorbars","hoverInfo")(m,o,f),[f]}}function t(s,i,x,p,v){var f=s.cd,y=f[0].trace,o=f[0].t,m=p==="closest",l=y.type==="waterfall",w=s.maxHoverDistance,_=s.maxSpikeDistance,h,b,u,L,T,k,P;y.orientation==="h"?(h=x,b=i,u="y",L="x",T=ue,k=W):(h=i,b=x,u="x",L="y",k=ue,T=W);var z=y[u+"period"],I=m||z;function D(ae){return O(ae,-1)}function R(ae){return O(ae,1)}function O(ae,oe){var be=ae.w;return ae[u]+oe*be/2}function F(ae){return ae[u+"End"]-ae[u+"Start"]}var N=m?D:z?function(ae){return ae.p-F(ae)/2}:function(ae){return Math.min(D(ae),ae.p-o.bardelta/2)},G=m?R:z?function(ae){return ae.p+F(ae)/2}:function(ae){return Math.max(R(ae),ae.p+o.bardelta/2)};function K(ae,oe,be){return v.finiteRange&&(be=0),A.inbox(ae-h,oe-h,be+Math.min(1,Math.abs(oe-ae)/P)-1)}function W(ae){return K(N(ae),G(ae),w)}function Y(ae){return K(D(ae),R(ae),_)}function re(ae){var oe=ae[L];if(l){var be=Math.abs(ae.rawS)||0;b>0?oe+=be:b<0&&(oe-=be)}return oe}function ue(ae){var oe=b,be=ae.b,ce=re(ae);return A.inbox(be-oe,ce-oe,w+(ce-oe)/(ce-be)-1)}function j(ae){var oe=b,be=ae.b,ce=re(ae);return A.inbox(be-oe,ce-oe,_+(ce-oe)/(ce-be)-1)}var q=s[u+"a"],V=s[L+"a"];P=Math.abs(q.r2c(q.range[1])-q.r2c(q.range[0]));function U(ae){return(T(ae)+k(ae))/2}var $=A.getDistanceFunction(p,T,k,U);if(A.getClosest(f,$,s),s.index!==!1&&f[s.index].p!==n){I||(N=function(ae){return Math.min(D(ae),ae.p-o.bargroupwidth/2)},G=function(ae){return Math.max(R(ae),ae.p+o.bargroupwidth/2)});var ne=s.index,X=f[ne],Q=y.base?X.b+X.s:X.s;s[L+"0"]=s[L+"1"]=V.c2p(X[L],!0),s[L+"LabelVal"]=Q;var ie=o.extents[o.extents.round(X.p)];s[u+"0"]=q.c2p(m?N(X):ie[0],!0),s[u+"1"]=q.c2p(m?G(X):ie[1],!0);var se=X.orig_p!==void 0;return s[u+"LabelVal"]=se?X.orig_p:X.p,s.labelLabel=a(q,s[u+"LabelVal"],y[u+"hoverformat"]),s.valueLabel=a(V,s[L+"LabelVal"],y[L+"hoverformat"]),s.baseLabel=a(V,X.b,y[L+"hoverformat"]),s.spikeDistance=(j(X)+Y(X))/2,s[u+"Spike"]=q.c2p(X.p,!0),M(X,y,s),s.hovertemplate=y.hovertemplate,s}}function c(s,i){var x=i.mcc||s.marker.color,p=i.mlcc||s.marker.line.color,v=e(s,i);if(S.opacity(x))return x;if(S.opacity(p)&&v)return p}ee.exports={hoverPoints:r,hoverOnBars:t,getTraceColor:c}},{"../../components/color":367,"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./helpers":663}],665:[function(d,ee,te){ee.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults").supplyDefaults,crossTraceDefaults:d("./defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc").crossTraceCalc,colorbar:d("../scatter/marker_colorbar"),arraysToCalcdata:d("./arrays_to_calcdata"),plot:d("./plot").plot,style:d("./style").style,styleOnSelect:d("./style").styleOnSelect,hoverPoints:d("./hover").hoverPoints,eventData:d("./event_data"),selectPoints:d("./select"),moduleType:"trace",name:"bar",basePlotModule:d("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"./arrays_to_calcdata":656,"./attributes":657,"./calc":658,"./cross_trace_calc":660,"./defaults":661,"./event_data":662,"./hover":664,"./layout_attributes":666,"./layout_defaults":667,"./plot":668,"./select":669,"./style":671}],666:[function(d,ee,te){ee.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],667:[function(d,ee,te){var A=d("../../registry"),g=d("../../plots/cartesian/axes"),S=d("../../lib"),M=d("./layout_attributes");ee.exports=function(e,a,n){function r(o,m){return S.coerce(e,a,M,o,m)}for(var t=!1,c=!1,s=!1,i={},x=r("barmode"),p=0;p<n.length;p++){var v=n[p];if(A.traceIs(v,"bar")&&v.visible)t=!0;else continue;if(x==="group"){var f=v.xaxis+v.yaxis;i[f]&&(s=!0),i[f]=!0}if(v.visible&&v.type==="histogram"){var y=g.getFromId({_fullLayout:a},v[v.orientation==="v"?"xaxis":"yaxis"]);y.type!=="category"&&(c=!0)}}if(!t){delete a.barmode;return}x!=="overlay"&&r("barnorm"),r("bargap",c&&!s?0:.2),r("bargroupgap")}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./layout_attributes":666}],668:[function(d,ee,te){var A=d("@plotly/d3"),g=d("fast-isnumeric"),S=d("../../lib"),M=d("../../lib/svg_text_utils"),e=d("../../components/color"),a=d("../../components/drawing"),n=d("../../registry"),r=d("../../plots/cartesian/axes").tickText,t=d("./uniform_text"),c=t.recordMinTextSize,s=t.clearMinTextSize,i=d("./style"),x=d("./helpers"),p=d("./constants"),v=d("./attributes"),f=v.text,y=v.textposition,o=d("../../components/fx/helpers").appendArrayPointValue,m=p.TEXTPAD;function l(N){return N.id}function w(N){if(N.ids)return l}function _(N,G){return N<G?1:-1}function h(N,G,K,W){var Y=[],re=[],ue=W?G:K,j=W?K:G;return Y[0]=ue.c2p(N.s0,!0),re[0]=j.c2p(N.p0,!0),Y[1]=ue.c2p(N.s1,!0),re[1]=j.c2p(N.p1,!0),W?[Y,re]:[re,Y]}function b(N,G,K,W){if(!G.uniformtext.mode&&u(K)){var Y;return W&&(Y=W()),N.transition().duration(K.duration).ease(K.easing).each("end",function(){Y&&Y()}).each("interrupt",function(){Y&&Y()})}else return N}function u(N){return N&&N.duration>0}function L(N,G,K,W,Y,re){var ue=G.xaxis,j=G.yaxis,q=N._fullLayout;Y||(Y={mode:q.barmode,norm:q.barmode,gap:q.bargap,groupgap:q.bargroupgap},s("bar",q));var V=S.makeTraceGroups(W,K,"trace bars").each(function(U){var $=A.select(this),ne=U[0].trace,X=ne.type==="waterfall",Q=ne.type==="funnel",ie=ne.type==="bar",se=ie||Q,ae=0;X&&ne.connector.visible&&ne.connector.mode==="between"&&(ae=ne.connector.line.width/2);var oe=ne.orientation==="h",be=u(Y),ce=S.ensureSingle($,"g","points"),de=w(ne),ye=ce.selectAll("g.point").data(S.identity,de);ye.enter().append("g").classed("point",!0),ye.exit().remove(),ye.each(function(me,Ee){var Pe=A.select(this),Ne=h(me,ue,j,oe),we=Ne[0][0],ke=Ne[0][1],Xe=Ne[1][0],He=Ne[1][1],Ie=(oe?ke-we:He-Xe)===0;Ie&&se&&x.getLineWidth(ne,me)&&(Ie=!1),Ie||(Ie=!g(we)||!g(ke)||!g(Xe)||!g(He)),me.isBlank=Ie,Ie&&(oe?ke=we:He=Xe),ae&&!Ie&&(oe?(we-=_(we,ke)*ae,ke+=_(we,ke)*ae):(Xe-=_(Xe,He)*ae,He+=_(Xe,He)*ae));var De,Ge;if(ne.type==="waterfall"){if(!Ie){var ht=ne[me.dir].marker;De=ht.line.width,Ge=ht.color}}else De=x.getLineWidth(ne,me),Ge=me.mc||ne.marker.color;function Rt(St){var Ye=A.round(De/2%1,2);return Y.gap===0&&Y.groupgap===0?A.round(Math.round(St)-Ye,2):St}function Kt(St,Ye,rt){return rt&&St===Ye?St:Math.abs(St-Ye)>=2?Rt(St):St>Ye?Math.ceil(St):Math.floor(St)}if(!N._context.staticPlot){var It=e.opacity(Ge),Mt=It<1||De>.01?Rt:Kt;we=Mt(we,ke,oe),ke=Mt(ke,we,oe),Xe=Mt(Xe,He,!oe),He=Mt(He,Xe,!oe)}var Yt=b(S.ensureSingle(Pe,"path"),q,Y,re);if(Yt.style("vector-effect","non-scaling-stroke").attr("d",isNaN((ke-we)*(He-Xe))||Ie&&N._context.staticPlot?"M0,0Z":"M"+we+","+Xe+"V"+He+"H"+ke+"V"+Xe+"Z").call(a.setClipUrl,G.layerClipId,N),!q.uniformtext.mode&&be){var zt=a.makePointStyleFns(ne);a.singlePointStyle(me,Yt,ne,zt,N)}T(N,G,Pe,U,Ee,we,ke,Xe,He,Y,re),G.layerClipId&&a.hideOutsideRangePoint(me,Pe.select("text"),ue,j,ne.xcalendar,ne.ycalendar)});var ge=ne.cliponaxis===!1;a.setClipUrl($,ge?null:G.layerClipId,N)});n.getComponentMethod("errorbars","plot")(N,V,G,Y)}function T(N,G,K,W,Y,re,ue,j,q,V,U){var $=G.xaxis,ne=G.yaxis,X=N._fullLayout,Q;function ie(Ye,rt,Ve){var Ae=S.ensureSingle(Ye,"text").text(rt).attr({class:"bartext bartext-"+Q,"text-anchor":"middle","data-notex":1}).call(a.font,Ve).call(M.convertToTspans,N);return Ae}var se=W[0].trace,ae=se.orientation==="h",oe=D(X,W,Y,$,ne);Q=R(se,Y);var be=V.mode==="stack"||V.mode==="relative",ce=W[Y],de=!be||ce._outmost;if(!oe||Q==="none"||(ce.isBlank||re===ue||j===q)&&(Q==="auto"||Q==="inside")){K.select("text").remove();return}var ye=X.font,ge=i.getBarColor(W[Y],se),me=i.getInsideTextFont(se,Y,ye,ge),Ee=i.getOutsideTextFont(se,Y,ye),Pe=K.datum();ae?$.type==="log"&&Pe.s0<=0&&($.range[0]<$.range[1]?re=0:re=$._length):ne.type==="log"&&Pe.s0<=0&&(ne.range[0]<ne.range[1]?j=ne._length:j=0);var Ne=Math.abs(ue-re)-2*m,we=Math.abs(q-j)-2*m,ke,Xe,He,Ie,De;if(Q==="outside"&&!de&&!ce.hasB&&(Q="inside"),Q==="auto")if(de){Q="inside",De=S.ensureUniformFontSize(N,me),ke=ie(K,oe,De),Xe=a.bBox(ke.node()),He=Xe.width,Ie=Xe.height;var Ge=He>0&&Ie>0,ht=He<=Ne&&Ie<=we,Rt=He<=we&&Ie<=Ne,Kt=ae?Ne>=He*(we/Ie):we>=Ie*(Ne/He);Ge&&(ht||Rt||Kt)?Q="inside":(Q="outside",ke.remove(),ke=null)}else Q="inside";if(!ke){De=S.ensureUniformFontSize(N,Q==="outside"?Ee:me),ke=ie(K,oe,De);var It=ke.attr("transform");if(ke.attr("transform",""),Xe=a.bBox(ke.node()),He=Xe.width,Ie=Xe.height,ke.attr("transform",It),He<=0||Ie<=0){ke.remove();return}}var Mt=se.textangle,Yt,zt;Q==="outside"?(zt=se.constraintext==="both"||se.constraintext==="outside",Yt=I(re,ue,j,q,Xe,{isHorizontal:ae,constrained:zt,angle:Mt})):(zt=se.constraintext==="both"||se.constraintext==="inside",Yt=z(re,ue,j,q,Xe,{isHorizontal:ae,constrained:zt,angle:Mt,anchor:se.insidetextanchor})),Yt.fontSize=De.size,c(se.type==="histogram"?"bar":se.type,Yt,X),ce.transform=Yt;var St=b(ke,X,V,U);S.setTransormAndDisplay(St,Yt)}function k(N){return N==="auto"?0:N}function P(N,G){var K=Math.PI/180*G,W=Math.abs(Math.sin(K)),Y=Math.abs(Math.cos(K));return{x:N.width*Y+N.height*W,y:N.width*W+N.height*Y}}function z(N,G,K,W,Y,re){var ue=!!re.isHorizontal,j=!!re.constrained,q=re.angle||0,V=re.anchor||"end",U=V==="end",$=V==="start",ne=re.leftToRight||0,X=(ne+1)/2,Q=1-X,ie=Y.width,se=Y.height,ae=Math.abs(G-N),oe=Math.abs(W-K),be=ae>2*m&&oe>2*m?m:0;ae-=2*be,oe-=2*be;var ce=k(q);q==="auto"&&!(ie<=ae&&se<=oe)&&(ie>ae||se>oe)&&(!(ie>oe||se>ae)||ie<se!=ae<oe)&&(ce+=90);var de=P(Y,ce),ye=1;j&&(ye=Math.min(1,ae/de.x,oe/de.y));var ge=Y.left*Q+Y.right*X,me=(Y.top+Y.bottom)/2,Ee=(N+m)*Q+(G-m)*X,Pe=(K+W)/2,Ne=0,we=0;if($||U){var ke=(ue?de.x:de.y)/2,Xe=ue?_(N,G):_(K,W);ue?$?(Ee=N+Xe*be,Ne=-Xe*ke):(Ee=G-Xe*be,Ne=Xe*ke):$?(Pe=K+Xe*be,we=-Xe*ke):(Pe=W-Xe*be,we=Xe*ke)}return{textX:ge,textY:me,targetX:Ee,targetY:Pe,anchorX:Ne,anchorY:we,scale:ye,rotate:ce}}function I(N,G,K,W,Y,re){var ue=!!re.isHorizontal,j=!!re.constrained,q=re.angle||0,V=Y.width,U=Y.height,$=Math.abs(G-N),ne=Math.abs(W-K),X;ue?X=ne>2*m?m:0:X=$>2*m?m:0;var Q=1;j&&(Q=ue?Math.min(1,ne/U):Math.min(1,$/V));var ie=k(q),se=P(Y,ie),ae=(ue?se.x:se.y)/2,oe=(Y.left+Y.right)/2,be=(Y.top+Y.bottom)/2,ce=(N+G)/2,de=(K+W)/2,ye=0,ge=0,me=ue?_(G,N):_(K,W);return ue?(ce=G-me*X,ye=me*ae):(de=W+me*X,ge=-me*ae),{textX:oe,textY:be,targetX:ce,targetY:de,anchorX:ye,anchorY:ge,scale:Q,rotate:ie}}function D(N,G,K,W,Y){var re=G[0].trace,ue=re.texttemplate,j;return ue?j=O(N,G,K,W,Y):re.textinfo?j=F(G,K,W,Y):j=x.getValue(re.text,K),x.coerceString(f,j)}function R(N,G){var K=x.getValue(N.textposition,G);return x.coerceEnumerated(y,K)}function O(N,G,K,W,Y){var re=G[0].trace,ue=S.castOption(re,K,"texttemplate");if(!ue)return"";var j=re.type==="histogram",q=re.type==="waterfall",V=re.type==="funnel",U=re.orientation==="h",$,ne,X,Q;U?($="y",ne=Y,X="x",Q=W):($="x",ne=W,X="y",Q=Y);function ie(ye){return r(ne,ne.c2l(ye),!0).text}function se(ye){return r(Q,Q.c2l(ye),!0).text}var ae=G[K],oe={};oe.label=ae.p,oe.labelLabel=oe[$+"Label"]=ie(ae.p);var be=S.castOption(re,ae.i,"text");(be===0||be)&&(oe.text=be),oe.value=ae.s,oe.valueLabel=oe[X+"Label"]=se(ae.s);var ce={};o(ce,re,ae.i),(j||ce.x===void 0)&&(ce.x=U?oe.value:oe.label),(j||ce.y===void 0)&&(ce.y=U?oe.label:oe.value),(j||ce.xLabel===void 0)&&(ce.xLabel=U?oe.valueLabel:oe.labelLabel),(j||ce.yLabel===void 0)&&(ce.yLabel=U?oe.labelLabel:oe.valueLabel),q&&(oe.delta=+ae.rawS||ae.s,oe.deltaLabel=se(oe.delta),oe.final=ae.v,oe.finalLabel=se(oe.final),oe.initial=oe.final-oe.delta,oe.initialLabel=se(oe.initial)),V&&(oe.value=ae.s,oe.valueLabel=se(oe.value),oe.percentInitial=ae.begR,oe.percentInitialLabel=S.formatPercent(ae.begR),oe.percentPrevious=ae.difR,oe.percentPreviousLabel=S.formatPercent(ae.difR),oe.percentTotal=ae.sumR,oe.percenTotalLabel=S.formatPercent(ae.sumR));var de=S.castOption(re,ae.i,"customdata");return de&&(oe.customdata=de),S.texttemplateString(ue,oe,N._d3locale,ce,oe,re._meta||{})}function F(N,G,K,W){var Y=N[0].trace,re=Y.orientation==="h",ue=Y.type==="waterfall",j=Y.type==="funnel";function q(de){var ye=re?W:K;return r(ye,de,!0).text}function V(de){var ye=re?K:W;return r(ye,+de,!0).text}var U=Y.textinfo,$=N[G],ne=U.split("+"),X=[],Q,ie=function(de){return ne.indexOf(de)!==-1};if(ie("label")&&X.push(q(N[G].p)),ie("text")&&(Q=S.castOption(Y,$.i,"text"),(Q===0||Q)&&X.push(Q)),ue){var se=+$.rawS||$.s,ae=$.v,oe=ae-se;ie("initial")&&X.push(V(oe)),ie("delta")&&X.push(V(se)),ie("final")&&X.push(V(ae))}if(j){ie("value")&&X.push(V($.s));var be=0;ie("percent initial")&&be++,ie("percent previous")&&be++,ie("percent total")&&be++;var ce=be>1;ie("percent initial")&&(Q=S.formatPercent($.begR),ce&&(Q+=" of initial"),X.push(Q)),ie("percent previous")&&(Q=S.formatPercent($.difR),ce&&(Q+=" of previous"),X.push(Q)),ie("percent total")&&(Q=S.formatPercent($.sumR),ce&&(Q+=" of total"),X.push(Q))}return X.join("<br>")}ee.exports={plot:L,toMoveInsideBar:z}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx/helpers":403,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"./attributes":657,"./constants":659,"./helpers":663,"./style":671,"./uniform_text":673,"@plotly/d3":58,"fast-isnumeric":190}],669:[function(d,ee,te){ee.exports=function(S,M){var e=S.cd,a=S.xaxis,n=S.yaxis,r=e[0].trace,t=r.type==="funnel",c=r.orientation==="h",s=[],i;if(M===!1)for(i=0;i<e.length;i++)e[i].selected=0;else for(i=0;i<e.length;i++){var x=e[i],p="ct"in x?x.ct:A(x,a,n,c,t);M.contains(p,!1,i,S)?(s.push({pointNumber:i,x:a.c2d(x.x),y:n.c2d(x.y)}),x.selected=1):x.selected=0}return s};function A(g,S,M,e,a){var n=S.c2p(e?g.s0:g.p0,!0),r=S.c2p(e?g.s1:g.p1,!0),t=M.c2p(e?g.p0:g.s0,!0),c=M.c2p(e?g.p1:g.s1,!0);return a?[(n+r)/2,(t+c)/2]:e?[r,(t+c)/2]:[(n+r)/2,c]}},{}],670:[function(d,ee,te){ee.exports=S;var A=d("../../lib").distinctVals,g=d("../../constants/numerical").BADNUM;function S(M,e){this.traces=M,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var a=1/0,n=[],r=0;r<M.length;r++){for(var t=M[r],c=0;c<t.length;c++){var s=t[c];s.p!==g&&n.push(s.p)}t[0]&&t[0].width1&&(a=Math.min(t[0].width1,a))}this.positions=n;var i=A(n);this.distinctPositions=i.vals,i.vals.length===1&&a!==1/0?this.minDiff=a:this.minDiff=Math.min(i.minDiff,a);var x=(e.posAxis||{}).type;(x==="category"||x==="multicategory")&&(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}S.prototype.put=function(e,a){var n=this.getLabel(e,a),r=this.bins[n]||0;return this.bins[n]=r+a,r},S.prototype.get=function(e,a){var n=this.getLabel(e,a);return this.bins[n]||0},S.prototype.getLabel=function(e,a){var n=a<0&&this.sepNegVal?"v":"^",r=this.overlapNoMerge?e:Math.round(e/this.binWidth);return n+r}},{"../../constants/numerical":491,"../../lib":515}],671:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/color"),S=d("../../components/drawing"),M=d("../../lib"),e=d("../../registry"),a=d("./uniform_text").resizeText,n=d("./attributes"),r=n.textfont,t=n.insidetextfont,c=n.outsidetextfont,s=d("./helpers");function i(b){var u=A.select(b).selectAll("g.barlayer").selectAll("g.trace");a(b,u,"bar");var L=u.size(),T=b._fullLayout;u.style("opacity",function(k){return k[0].trace.opacity}).each(function(k){(T.barmode==="stack"&&L>1||T.bargap===0&&T.bargroupgap===0&&!k[0].trace.marker.line.width)&&A.select(this).attr("shape-rendering","crispEdges")}),u.selectAll("g.points").each(function(k){var P=A.select(this),z=k[0].trace;x(P,z,b)}),e.getComponentMethod("errorbars","style")(u)}function x(b,u,L){S.pointStyle(b.selectAll("path"),u,L),p(b,u,L)}function p(b,u,L){b.selectAll("text").each(function(T){var k=A.select(this),P=M.ensureUniformFontSize(L,o(k,T,u,L));S.font(k,P)})}function v(b,u,L){var T=u[0].trace;T.selectedpoints?f(L,T,b):(x(L,T,b),e.getComponentMethod("errorbars","style")(L))}function f(b,u,L){S.selectedPointStyle(b.selectAll("path"),u),y(b.selectAll("text"),u,L)}function y(b,u,L){b.each(function(T){var k=A.select(this),P;if(T.selected){P=M.ensureUniformFontSize(L,o(k,T,u,L));var z=u.selected.textfont&&u.selected.textfont.color;z&&(P.color=z),S.font(k,P)}else S.selectedTextStyle(k,u)})}function o(b,u,L,T){var k=T._fullLayout.font,P=L.textfont;if(b.classed("bartext-inside")){var z=h(u,L);P=l(L,u.i,k,z)}else b.classed("bartext-outside")&&(P=w(L,u.i,k));return P}function m(b,u,L){return _(r,b.textfont,u,L)}function l(b,u,L,T){var k=m(b,u,L),P=b._input.textfont===void 0||b._input.textfont.color===void 0||Array.isArray(b.textfont.color)&&b.textfont.color[u]===void 0;return P&&(k={color:g.contrast(T),family:k.family,size:k.size}),_(t,b.insidetextfont,u,k)}function w(b,u,L){var T=m(b,u,L);return _(c,b.outsidetextfont,u,T)}function _(b,u,L,T){u=u||{};var k=s.getValue(u.family,L),P=s.getValue(u.size,L),z=s.getValue(u.color,L);return{family:s.coerceString(b.family,k,T.family),size:s.coerceNumber(b.size,P,T.size),color:s.coerceColor(b.color,z,T.color)}}function h(b,u){return u.type==="waterfall"?u[b.dir].marker.color:b.mcc||b.mc||u.marker.color}ee.exports={style:i,styleTextPoints:p,styleOnSelect:v,getInsideTextFont:l,getOutsideTextFont:w,getBarColor:h,resizeText:a}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../registry":647,"./attributes":657,"./helpers":663,"./uniform_text":673,"@plotly/d3":58}],672:[function(d,ee,te){var A=d("../../components/color"),g=d("../../components/colorscale/helpers").hasColorscale,S=d("../../components/colorscale/defaults"),M=d("../../lib").coercePattern;ee.exports=function(a,n,r,t,c){var s=r("marker.color",t),i=g(a,"marker");i&&S(a,n,c,r,{prefix:"marker.",cLetter:"c"}),r("marker.line.color",A.defaultLine),g(a,"marker.line")&&S(a,n,c,r,{prefix:"marker.line.",cLetter:"c"}),r("marker.line.width"),r("marker.opacity"),M(r,"marker.pattern",s,i),r("selected.marker.color"),r("unselected.marker.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],673:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib");function S(n,r,t){var c=n._fullLayout,s=c["_"+t+"Text_minsize"];if(s){var i=c.uniformtext.mode==="hide",x;switch(t){case"funnelarea":case"pie":case"sunburst":x="g.slice";break;case"treemap":case"icicle":x="g.slice, g.pathbar";break;default:x="g.points > g.point"}r.selectAll(x).each(function(p){var v=p.transform;if(v){v.scale=i&&v.hide?0:s/v.fontSize;var f=A.select(this).select("text");g.setTransormAndDisplay(f,v)}})}}function M(n,r,t){if(t.uniformtext.mode){var c=a(n),s=t.uniformtext.minsize,i=r.scale*r.fontSize;r.hide=i<s,t[c]=t[c]||1/0,r.hide||(t[c]=Math.min(t[c],Math.max(i,s)))}}function e(n,r){var t=a(n);r[t]=void 0}function a(n){return"_"+n+"Text_minsize"}ee.exports={recordMinTextSize:M,clearMinTextSize:e,resizeText:S}},{"../../lib":515,"@plotly/d3":58}],674:[function(d,ee,te){var A=d("../../plots/template_attributes").hovertemplateAttrs,g=d("../../lib/extend").extendFlat,S=d("../scatterpolar/attributes"),M=d("../bar/attributes");ee.exports={r:S.r,theta:S.theta,r0:S.r0,dr:S.dr,theta0:S.theta0,dtheta:S.dtheta,thetaunit:S.thetaunit,base:g({},M.base,{}),offset:g({},M.offset,{}),width:g({},M.width,{}),text:g({},M.text,{}),hovertext:g({},M.hovertext,{}),marker:M.marker,hoverinfo:S.hoverinfo,hovertemplate:A(),selected:M.selected,unselected:M.unselected}},{"../../lib/extend":505,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatterpolar/attributes":1011}],675:[function(d,ee,te){var A=d("../../components/colorscale/helpers").hasColorscale,g=d("../../components/colorscale/calc"),S=d("../bar/arrays_to_calcdata"),M=d("../bar/cross_trace_calc").setGroupPositions,e=d("../scatter/calc_selection"),a=d("../../registry").traceIs,n=d("../../lib").extendFlat;function r(c,s){for(var i=c._fullLayout,x=s.subplot,p=i[x].radialaxis,v=i[x].angularaxis,f=p.makeCalcdata(s,"r"),y=v.makeCalcdata(s,"theta"),o=s._length,m=new Array(o),l=f,w=y,_=0;_<o;_++)m[_]={p:w[_],s:l[_]};function h(b){var u=s[b];u!==void 0&&(s["_"+b]=Array.isArray(u)?v.makeCalcdata(s,b):v.d2c(u,s.thetaunit))}return v.type==="linear"&&(h("width"),h("offset")),A(s,"marker")&&g(c,s,{vals:s.marker.color,containerStr:"marker",cLetter:"c"}),A(s,"marker.line")&&g(c,s,{vals:s.marker.line.color,containerStr:"marker.line",cLetter:"c"}),S(m,s),e(m,s),m}function t(c,s,i){for(var x=c.calcdata,p=[],v=0;v<x.length;v++){var f=x[v],y=f[0].trace;y.visible===!0&&a(y,"bar")&&y.subplot===i&&p.push(f)}var o=n({},s.radialaxis,{_id:"x"}),m=s.angularaxis;M(c,m,o,p,{mode:s.barmode,norm:s.barnorm,gap:s.bargap,groupgap:s.bargroupgap})}ee.exports={calc:r,crossTraceCalc:t}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../lib":515,"../../registry":647,"../bar/arrays_to_calcdata":656,"../bar/cross_trace_calc":660,"../scatter/calc_selection":938}],676:[function(d,ee,te){var A=d("../../lib"),g=d("../scatterpolar/defaults").handleRThetaDefaults,S=d("../bar/style_defaults"),M=d("./attributes");ee.exports=function(a,n,r,t){function c(i,x){return A.coerce(a,n,M,i,x)}var s=g(a,n,t,c);if(!s){n.visible=!1;return}c("thetaunit"),c("base"),c("offset"),c("width"),c("text"),c("hovertext"),c("hovertemplate"),S(a,n,c,r,t),A.coerceSelectionMarkerOpacity(n,c)}},{"../../lib":515,"../bar/style_defaults":672,"../scatterpolar/defaults":1013,"./attributes":674}],677:[function(d,ee,te){var A=d("../../components/fx"),g=d("../../lib"),S=d("../bar/hover").getTraceColor,M=g.fillText,e=d("../scatterpolar/hover").makeHoverPointText,a=d("../../plots/polar/helpers").isPtInsidePolygon;ee.exports=function(r,t,c){var s=r.cd,i=s[0].trace,x=r.subplot,p=x.radialAxis,v=x.angularAxis,f=x.vangles,y=f?a:g.isPtInsideSector,o=r.maxHoverDistance,m=v._period||2*Math.PI,l=Math.abs(p.g2p(Math.sqrt(t*t+c*c))),w=Math.atan2(c,t);p.range[0]>p.range[1]&&(w+=Math.PI);var _=function(L){return y(l,w,[L.rp0,L.rp1],[L.thetag0,L.thetag1],f)?o+Math.min(1,Math.abs(L.thetag1-L.thetag0)/m)-1+(L.rp1-l)/(L.rp1-L.rp0)-1:1/0};if(A.getClosest(s,_,r),r.index!==!1){var h=r.index,b=s[h];r.x0=r.x1=b.ct[0],r.y0=r.y1=b.ct[1];var u=g.extendFlat({},b,{r:b.s,theta:b.p});return M(b,i,r),e(u,i,x,r),r.hovertemplate=i.hovertemplate,r.color=S(i,b),r.xLabelVal=r.yLabelVal=void 0,b.s<0&&(r.idealAlign="left"),[r]}}},{"../../components/fx":407,"../../lib":515,"../../plots/polar/helpers":630,"../bar/hover":664,"../scatterpolar/hover":1015}],678:[function(d,ee,te){ee.exports={moduleType:"trace",name:"barpolar",basePlotModule:d("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("../scatterpolar/format_labels"),style:d("../bar/style").style,styleOnSelect:d("../bar/style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("../bar/select"),meta:{}}},{"../../plots/polar":631,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"../scatterpolar/format_labels":1014,"./attributes":674,"./calc":675,"./defaults":676,"./hover":677,"./layout_attributes":679,"./layout_defaults":680,"./plot":681}],679:[function(d,ee,te){ee.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],680:[function(d,ee,te){var A=d("../../lib"),g=d("./layout_attributes");ee.exports=function(S,M,e){var a={},n;function r(s,i){return A.coerce(S[n]||{},M[n],g,s,i)}for(var t=0;t<e.length;t++){var c=e[t];c.type==="barpolar"&&c.visible===!0&&(n=c.subplot,a[n]||(r("barmode"),r("bargap"),a[n]=1))}}},{"../../lib":515,"./layout_attributes":679}],681:[function(d,ee,te){var A=d("@plotly/d3"),g=d("fast-isnumeric"),S=d("../../lib"),M=d("../../components/drawing"),e=d("../../plots/polar/helpers");ee.exports=function(r,t,c){var s=t.xaxis,i=t.yaxis,x=t.radialAxis,p=t.angularAxis,v=a(t),f=t.layers.frontplot.select("g.barlayer");S.makeTraceGroups(f,c,"trace bars").each(function(){var y=A.select(this),o=S.ensureSingle(y,"g","points"),m=o.selectAll("g.point").data(S.identity);m.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),m.exit().remove(),m.each(function(l){var w=A.select(this),_=l.rp0=x.c2p(l.s0),h=l.rp1=x.c2p(l.s1),b=l.thetag0=p.c2g(l.p0),u=l.thetag1=p.c2g(l.p1),L;if(!g(_)||!g(h)||!g(b)||!g(u)||_===h||b===u)L="M0,0Z";else{var T=x.c2g(l.s1),k=(b+u)/2;l.ct=[s.c2p(T*Math.cos(k)),i.c2p(T*Math.sin(k))],L=v(_,h,b,u)}S.ensureSingle(w,"path").attr("d",L)}),M.setClipUrl(y,t._hasClipOnAxisFalse?t.clipIds.forTraces:null,r)})};function a(n){var r=n.cxx,t=n.cyy;return n.vangles?function(c,s,i,x){var p,v;S.angleDelta(i,x)>0?(p=i,v=x):(p=x,v=i);var f=e.findEnclosingVertexAngles(p,n.vangles)[0],y=e.findEnclosingVertexAngles(v,n.vangles)[1],o=[f,(p+v)/2,y];return e.pathPolygonAnnulus(c,s,p,v,o,r,t)}:function(c,s,i,x){return S.pathAnnulus(c,s,i,x,r,t)}}},{"../../components/drawing":389,"../../lib":515,"../../plots/polar/helpers":630,"@plotly/d3":58,"fast-isnumeric":190}],682:[function(d,ee,te){var A=d("../scatter/attributes"),g=d("../bar/attributes"),S=d("../../components/color/attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../lib/extend").extendFlat,n=A.marker,r=n.line;ee.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:A.xperiod,yperiod:A.yperiod,xperiod0:A.xperiod0,yperiod0:A.yperiod0,xperiodalignment:A.xperiodalignment,yperiodalignment:A.yperiodalignment,xhoverformat:M("x"),yhoverformat:M("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:a({},n.symbol,{arrayOk:!1,editType:"plot"}),opacity:a({},n.opacity,{arrayOk:!1,dflt:1,editType:"style"}),angle:a({},n.angle,{arrayOk:!1,editType:"calc"}),size:a({},n.size,{arrayOk:!1,editType:"calc"}),color:a({},n.color,{arrayOk:!1,editType:"style"}),line:{color:a({},r.color,{arrayOk:!1,dflt:S.defaultLine,editType:"style"}),width:a({},r.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:A.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:g.offsetgroup,alignmentgroup:g.alignmentgroup,selected:{marker:A.selected.marker,editType:"style"},unselected:{marker:A.unselected.marker,editType:"style"},text:a({},A.text,{}),hovertext:a({},A.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936}],683:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../plots/cartesian/axes"),S=d("../../plots/cartesian/align_period"),M=d("../../lib"),e=d("../../constants/numerical").BADNUM,a=M._;ee.exports=function(w,_){var h=w._fullLayout,b=g.getFromId(w,_.xaxis||"x"),u=g.getFromId(w,_.yaxis||"y"),L=[],T=_.type==="violin"?"_numViolins":"_numBoxes",k,P,z,I,D,R,O;_.orientation==="h"?(z=b,I="x",D=u,R="y",O=!!_.yperiodalignment):(z=u,I="y",D=b,R="x",O=!!_.xperiodalignment);var F=n(_,R,D,h[T]),N=F[0],G=F[1],K=M.distinctVals(N,D),W=K.vals,Y=K.minDiff/2,re,ue,j,q,V,U,$=(_.boxpoints||_.points)==="all"?M.identity:function(It){return It.v<re.lf||It.v>re.uf};if(_._hasPreCompStats){var ne=_[I],X=function(It){return z.d2c((_[It]||[])[k])},Q=1/0,ie=-1/0;for(k=0;k<_._length;k++){var se=N[k];if(!!A(se)){if(re={},re.pos=re[R]=se,O&&G&&(re.orig_p=G[k]),re.q1=X("q1"),re.med=X("median"),re.q3=X("q3"),ue=[],ne&&M.isArrayOrTypedArray(ne[k]))for(P=0;P<ne[k].length;P++)U=z.d2c(ne[k][P]),U!==e&&(V={v:U,i:[k,P]},s(V,_,[k,P]),ue.push(V));if(re.pts=ue.sort(x),j=re[I]=ue.map(p),q=j.length,re.med!==e&&re.q1!==e&&re.q3!==e&&re.med>=re.q1&&re.q3>=re.med){var ae=X("lowerfence");re.lf=ae!==e&&ae<=re.q1?ae:v(re,j,q);var oe=X("upperfence");re.uf=oe!==e&&oe>=re.q3?oe:f(re,j,q);var be=X("mean");re.mean=be!==e?be:q?M.mean(j,q):(re.q1+re.q3)/2;var ce=X("sd");re.sd=be!==e&&ce>=0?ce:q?M.stdev(j,q,re.mean):re.q3-re.q1,re.lo=y(re),re.uo=o(re);var de=X("notchspan");de=de!==e&&de>0?de:m(re,q),re.ln=re.med-de,re.un=re.med+de;var ye=re.lf,ge=re.uf;_.boxpoints&&j.length&&(ye=Math.min(ye,j[0]),ge=Math.max(ge,j[q-1])),_.notched&&(ye=Math.min(ye,re.ln),ge=Math.max(ge,re.un)),re.min=ye,re.max=ge}else{M.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+re.q1,"median = "+re.med,"q3 = "+re.q3].join(`
`));var me;re.med!==e?me=re.med:re.q1!==e?re.q3!==e?me=(re.q1+re.q3)/2:me=re.q1:re.q3!==e?me=re.q3:me=0,re.med=me,re.q1=re.q3=me,re.lf=re.uf=me,re.mean=re.sd=me,re.ln=re.un=me,re.min=re.max=me}Q=Math.min(Q,re.min),ie=Math.max(ie,re.max),re.pts2=ue.filter($),L.push(re)}}_._extremes[z._id]=g.findExtremes(z,[Q,ie],{padded:!0})}else{var Ee=z.makeCalcdata(_,I),Pe=r(W,Y),Ne=W.length,we=t(Ne);for(k=0;k<_._length;k++)if(U=Ee[k],!!A(U)){var ke=M.findBin(N[k],Pe);ke>=0&&ke<Ne&&(V={v:U,i:k},s(V,_,k),we[ke].push(V))}var Xe=1/0,He=-1/0,Ie=_.quartilemethod,De=Ie==="exclusive",Ge=Ie==="inclusive";for(k=0;k<Ne;k++)if(we[k].length>0){if(re={},re.pos=re[R]=W[k],ue=re.pts=we[k].sort(x),j=re[I]=ue.map(p),q=j.length,re.min=j[0],re.max=j[q-1],re.mean=M.mean(j,q),re.sd=M.stdev(j,q,re.mean),re.med=M.interp(j,.5),q%2&&(De||Ge)){var ht,Rt;De?(ht=j.slice(0,q/2),Rt=j.slice(q/2+1)):Ge&&(ht=j.slice(0,q/2+1),Rt=j.slice(q/2)),re.q1=M.interp(ht,.5),re.q3=M.interp(Rt,.5)}else re.q1=M.interp(j,.25),re.q3=M.interp(j,.75);re.lf=v(re,j,q),re.uf=f(re,j,q),re.lo=y(re),re.uo=o(re);var Kt=m(re,q);re.ln=re.med-Kt,re.un=re.med+Kt,Xe=Math.min(Xe,re.ln),He=Math.max(He,re.un),re.pts2=ue.filter($),L.push(re)}_._extremes[z._id]=g.findExtremes(z,_.notched?Ee.concat([Xe,He]):Ee,{padded:!0})}return i(L,_),L.length>0?(L[0].t={num:h[T],dPos:Y,posLetter:R,valLetter:I,labels:{med:a(w,"median:"),min:a(w,"min:"),q1:a(w,"q1:"),q3:a(w,"q3:"),max:a(w,"max:"),mean:_.boxmean==="sd"?a(w,"mean \xB1 \u03C3:"):a(w,"mean:"),lf:a(w,"lower fence:"),uf:a(w,"upper fence:")}},h[T]++,L):[{t:{empty:!0}}]};function n(l,w,_,h){var b=w in l,u=w+"0"in l,L="d"+w in l;if(b||u&&L){var T=_.makeCalcdata(l,w),k=S(l,_,w,T).vals;return[k,T]}var P;u?P=l[w+"0"]:"name"in l&&(_.type==="category"||A(l.name)&&["linear","log"].indexOf(_.type)!==-1||M.isDateTime(l.name)&&_.type==="date")?P=l.name:P=h;for(var z=_.type==="multicategory"?_.r2c_just_indices(P):_.d2c(P,0,l[w+"calendar"]),I=l._length,D=new Array(I),R=0;R<I;R++)D[R]=z;return[D]}function r(l,w){for(var _=l.length,h=new Array(_+1),b=0;b<_;b++)h[b]=l[b]-w;return h[_]=l[_-1]+w,h}function t(l){for(var w=new Array(l),_=0;_<l;_++)w[_]=[];return w}var c={text:"tx",hovertext:"htx"};function s(l,w,_){for(var h in c)M.isArrayOrTypedArray(w[h])&&(Array.isArray(_)?M.isArrayOrTypedArray(w[h][_[0]])&&(l[c[h]]=w[h][_[0]][_[1]]):l[c[h]]=w[h][_])}function i(l,w){if(M.isArrayOrTypedArray(w.selectedpoints))for(var _=0;_<l.length;_++){for(var h=l[_].pts||[],b={},u=0;u<h.length;u++)b[h[u].i]=u;M.tagSelected(h,w,b)}}function x(l,w){return l.v-w.v}function p(l){return l.v}function v(l,w,_){return _===0?l.q1:Math.min(l.q1,w[Math.min(M.findBin(2.5*l.q1-1.5*l.q3,w,!0)+1,_-1)])}function f(l,w,_){return _===0?l.q3:Math.max(l.q3,w[Math.max(M.findBin(2.5*l.q3-1.5*l.q1,w),0)])}function y(l){return 4*l.q1-3*l.q3}function o(l){return 4*l.q3-3*l.q1}function m(l,w){return w===0?0:1.57*(l.q3-l.q1)/Math.sqrt(w)}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"fast-isnumeric":190}],684:[function(d,ee,te){var A=d("../../plots/cartesian/axes"),g=d("../../lib"),S=d("../../plots/cartesian/constraints").getAxisGroup,M=["v","h"];function e(n,r){for(var t=n.calcdata,c=r.xaxis,s=r.yaxis,i=0;i<M.length;i++){for(var x=M[i],p=x==="h"?s:c,v=[],f=0;f<t.length;f++){var y=t[f],o=y[0].t,m=y[0].trace;m.visible===!0&&(m.type==="box"||m.type==="candlestick")&&!o.empty&&(m.orientation||"v")===x&&m.xaxis===c._id&&m.yaxis===s._id&&v.push(f)}a("box",n,v,p)}}function a(n,r,t,c){var s=r.calcdata,i=r._fullLayout,x=c._id,p=x.charAt(0),v,f,y,o=[],m=0;for(v=0;v<t.length;v++)for(y=s[t[v]],f=0;f<y.length;f++)o.push(c.c2l(y[f].pos,!0)),m+=(y[f].pts2||[]).length;if(!!o.length){var l=g.distinctVals(o);(c.type==="category"||c.type==="multicategory")&&(l.minDiff=1);var w=l.minDiff/2;A.minDtick(c,l.minDiff,l.vals[0],!0);var _=n==="violin"?"_numViolins":"_numBoxes",h=i[_],b=i[n+"mode"]==="group"&&h>1,u=1-i[n+"gap"],L=1-i[n+"groupgap"];for(v=0;v<t.length;v++){y=s[t[v]];var T=y[0].trace,k=y[0].t,P=T.width,z=T.side,I,D,R,O;if(P)I=D=O=P/2,R=0;else if(I=w,b){var F=S(i,c._id)+T.orientation,N=i._alignmentOpts[F]||{},G=N[T.alignmentgroup]||{},K=Object.keys(G.offsetGroups||{}).length,W=K||h,Y=K?T._offsetIndex:k.num;D=I*u*L/W,R=2*I*(-.5+(Y+.5)/W)*u,O=I*u/W}else D=I*u*L,R=0,O=I;k.dPos=I,k.bPos=R,k.bdPos=D,k.wHover=O;var re,ue,j=R+D,q,V,U,$,ne,X,Q=Boolean(P),ie=(T.boxpoints||T.points)&&m>0;if(z==="positive"?(re=I*(P?1:.5),q=j,ue=q=R):z==="negative"?(re=q=R,ue=I*(P?1:.5),V=j):(re=ue=I,q=V=j),ie){var se=T.pointpos,ae=T.jitter,oe=T.marker.size/2,be=0;se+ae>=0&&(be=j*(se+ae),be>re?(Q=!0,ne=oe,U=be):be>q&&(ne=oe,U=re)),be<=re&&(U=re);var ce=0;se-ae<=0&&(ce=-j*(se-ae),ce>ue?(Q=!0,X=oe,$=ce):ce>V&&(X=oe,$=ue)),ce<=ue&&($=ue)}else U=re,$=ue;var de=new Array(y.length);for(f=0;f<y.length;f++)de[f]=y[f].pos;T._extremes[x]=A.findExtremes(c,de,{padded:Q,vpadminus:$,vpadplus:U,vpadLinearized:!0,ppadminus:{x:X,y:ne}[p],ppadplus:{x:ne,y:X}[p]})}}}ee.exports={crossTraceCalc:e,setPositionOffset:a}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574}],685:[function(d,ee,te){var A=d("../../lib"),g=d("../../registry"),S=d("../../components/color"),M=d("../scatter/period_defaults"),e=d("../bar/defaults").handleGroupingDefaults,a=d("../../plots/cartesian/axis_autotype"),n=d("./attributes");function r(i,x,p,v){function f(b,u){return A.coerce(i,x,n,b,u)}if(t(i,x,f,v),x.visible!==!1){M(i,x,v,f),f("xhoverformat"),f("yhoverformat");var y=x._hasPreCompStats;y&&(f("lowerfence"),f("upperfence")),f("line.color",(i.marker||{}).color||p),f("line.width"),f("fillcolor",S.addOpacity(x.line.color,.5));var o=!1;if(y){var m=f("mean"),l=f("sd");m&&m.length&&(o=!0,l&&l.length&&(o="sd"))}f("boxmean",o),f("whiskerwidth"),f("width"),f("quartilemethod");var w=!1;if(y){var _=f("notchspan");_&&_.length&&(w=!0)}else A.validate(i.notchwidth,n.notchwidth)&&(w=!0);var h=f("notched",w);h&&f("notchwidth"),c(i,x,f,{prefix:"box"})}}function t(i,x,p,v){function f(K){var W=0;return K&&K.length&&(W+=1,A.isArrayOrTypedArray(K[0])&&K[0].length&&(W+=1)),W}function y(K){return A.validate(i[K],n[K])}var o=p("y"),m=p("x"),l;if(x.type==="box"){var w=p("q1"),_=p("median"),h=p("q3");x._hasPreCompStats=w&&w.length&&_&&_.length&&h&&h.length,l=Math.min(A.minRowLength(w),A.minRowLength(_),A.minRowLength(h))}var b=f(o),u=f(m),L=b&&A.minRowLength(o),T=u&&A.minRowLength(m),k=v.calendar,P={autotypenumbers:v.autotypenumbers},z,I;if(x._hasPreCompStats)switch(String(u)+String(b)){case"00":var D=y("x0")||y("dx"),R=y("y0")||y("dy");R&&!D?z="h":z="v",I=l;break;case"10":z="v",I=Math.min(l,T);break;case"20":z="h",I=Math.min(l,m.length);break;case"01":z="h",I=Math.min(l,L);break;case"02":z="v",I=Math.min(l,o.length);break;case"12":z="v",I=Math.min(l,T,o.length);break;case"21":z="h",I=Math.min(l,m.length,L);break;case"11":I=0;break;case"22":var O=!1,F;for(F=0;F<m.length;F++)if(a(m[F],k,P)==="category"){O=!0;break}if(O)z="v",I=Math.min(l,T,o.length);else{for(F=0;F<o.length;F++)if(a(o[F],k,P)==="category"){O=!0;break}O?(z="h",I=Math.min(l,m.length,L)):(z="v",I=Math.min(l,T,o.length))}break}else b>0?(z="v",u>0?I=Math.min(T,L):I=Math.min(L)):u>0?(z="h",I=Math.min(T)):I=0;if(!I){x.visible=!1;return}x._length=I;var N=p("orientation",z);x._hasPreCompStats?N==="v"&&u===0?(p("x0",0),p("dx",1)):N==="h"&&b===0&&(p("y0",0),p("dy",1)):N==="v"&&u===0?p("x0"):N==="h"&&b===0&&p("y0");var G=g.getComponentMethod("calendars","handleTraceDefaults");G(i,x,["x","y"],v)}function c(i,x,p,v){var f=v.prefix,y=A.coerce2(i,x,n,"marker.outliercolor"),o=p("marker.line.outliercolor"),m="outliers";x._hasPreCompStats?m="all":(y||o)&&(m="suspectedoutliers");var l=p(f+"points",m);l?(p("jitter",l==="all"?.3:0),p("pointpos",l==="all"?-1.5:0),p("marker.symbol"),p("marker.opacity"),p("marker.size"),p("marker.angle"),p("marker.color",x.line.color),p("marker.line.color"),p("marker.line.width"),l==="suspectedoutliers"&&(p("marker.line.outliercolor",x.marker.color),p("marker.line.outlierwidth")),p("selected.marker.color"),p("unselected.marker.color"),p("selected.marker.size"),p("unselected.marker.size"),p("text"),p("hovertext")):delete x.marker;var w=p("hoveron");(w==="all"||w.indexOf("points")!==-1)&&p("hovertemplate"),A.coerceSelectionMarkerOpacity(x,p)}function s(i,x){var p,v;function f(m){return A.coerce(v._input,v,n,m)}for(var y=0;y<i.length;y++){v=i[y];var o=v.type;(o==="box"||o==="violin")&&(p=v._input,x[o+"mode"]==="group"&&e(p,v,x,f))}}ee.exports={supplyDefaults:r,crossTraceDefaults:s,handleSampleDefaults:t,handlePointsDefaults:c}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../registry":647,"../bar/defaults":661,"../scatter/period_defaults":956,"./attributes":682}],686:[function(d,ee,te){ee.exports=function(g,S){return S.hoverOnBox&&(g.hoverOnBox=S.hoverOnBox),"xVal"in S&&(g.x=S.xVal),"yVal"in S&&(g.y=S.yVal),S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),g}},{}],687:[function(d,ee,te){var A=d("../../plots/cartesian/axes"),g=d("../../lib"),S=d("../../components/fx"),M=d("../../components/color"),e=g.fillText;function a(t,c,s,i){var x=t.cd,p=x[0].trace,v=p.hoveron,f=[],y;return v.indexOf("boxes")!==-1&&(f=f.concat(n(t,c,s,i))),v.indexOf("points")!==-1&&(y=r(t,c,s)),i==="closest"?y?[y]:f:(y&&f.push(y),f)}function n(t,c,s,i){var x=t.cd,p=t.xa,v=t.ya,f=x[0].trace,y=x[0].t,o=f.type==="violin",m,l,w,_,h,b,u,L,T,k,P,z=y.bdPos,I,D,R=y.wHover,O=function(ce){return w.c2l(ce.pos)+y.bPos-w.c2l(b)};o&&f.side!=="both"?(f.side==="positive"&&(T=function(ce){var de=O(ce);return S.inbox(de,de+R,k)},I=z,D=0),f.side==="negative"&&(T=function(ce){var de=O(ce);return S.inbox(de-R,de,k)},I=0,D=z)):(T=function(ce){var de=O(ce);return S.inbox(de-R,de+R,k)},I=D=z);var F;o?F=function(ce){return S.inbox(ce.span[0]-h,ce.span[1]-h,k)}:F=function(ce){return S.inbox(ce.min-h,ce.max-h,k)},f.orientation==="h"?(h=c,b=s,u=F,L=T,m="y",w=v,l="x",_=p):(h=s,b=c,u=T,L=F,m="x",w=p,l="y",_=v);var N=Math.min(1,z/Math.abs(w.r2c(w.range[1])-w.r2c(w.range[0])));k=t.maxHoverDistance-N,P=t.maxSpikeDistance-N;function G(ce){return(u(ce)+L(ce))/2}var K=S.getDistanceFunction(i,u,L,G);if(S.getClosest(x,K,t),t.index===!1)return[];var W=x[t.index],Y=f.line.color,re=(f.marker||{}).color;M.opacity(Y)&&f.line.width?t.color=Y:M.opacity(re)&&f.boxpoints?t.color=re:t.color=f.fillcolor,t[m+"0"]=w.c2p(W.pos+y.bPos-D,!0),t[m+"1"]=w.c2p(W.pos+y.bPos+I,!0),t[m+"LabelVal"]=W.orig_p!==void 0?W.orig_p:W.pos;var ue=m+"Spike";t.spikeDistance=G(W)*P/k,t[ue]=w.c2p(W.pos,!0);var j=f.boxmean||(f.meanline||{}).visible,q=f.boxpoints||f.points,V=q&&j?["max","uf","q3","med","mean","q1","lf","min"]:q&&!j?["max","uf","q3","med","q1","lf","min"]:!q&&j?["max","q3","med","mean","q1","min"]:["max","q3","med","q1","min"],U=_.range[1]<_.range[0];f.orientation===(U?"v":"h")&&V.reverse();for(var $=t.spikeDistance,ne=t[ue],X=[],Q=0;Q<V.length;Q++){var ie=V[Q];if(ie in W){var se=W[ie],ae=_.c2p(se,!0),oe=g.extendFlat({},t);oe.attr=ie,oe[l+"0"]=oe[l+"1"]=ae,oe[l+"LabelVal"]=se,oe[l+"Label"]=(y.labels?y.labels[ie]+" ":"")+A.hoverLabelText(_,se,f[l+"hoverformat"]),oe.hoverOnBox=!0,ie==="mean"&&"sd"in W&&f.boxmean==="sd"&&(oe[l+"err"]=W.sd),oe.hovertemplate=!1,X.push(oe)}}t.name="",t.spikeDistance=void 0,t[ue]=void 0;for(var be=0;be<X.length;be++)X[be].attr!=="med"?(X[be].name="",X[be].spikeDistance=void 0,X[be][ue]=void 0):(X[be].spikeDistance=$,X[be][ue]=ne);return X}function r(t,c,s){for(var i=t.cd,x=t.xa,p=t.ya,v=i[0].trace,f=x.c2p(c),y=p.c2p(s),o,m=function(F){var N=Math.max(3,F.mrc||0);return Math.max(Math.abs(x.c2p(F.x)-f)-N,1-3/N)},l=function(F){var N=Math.max(3,F.mrc||0);return Math.max(Math.abs(p.c2p(F.y)-y)-N,1-3/N)},w=S.quadrature(m,l),_=!1,h,b,u=0;u<i.length;u++){h=i[u];for(var L=0;L<(h.pts||[]).length;L++){b=h.pts[L];var T=w(b);T<=t.distance&&(t.distance=T,_=[u,L])}}if(!_)return!1;h=i[_[0]],b=h.pts[_[1]];var k=x.c2p(b.x,!0),P=p.c2p(b.y,!0),z=b.mrc||1;o=g.extendFlat({},t,{index:b.i,color:(v.marker||{}).color,name:v.name,x0:k-z,x1:k+z,y0:P-z,y1:P+z,spikeDistance:t.distance,hovertemplate:v.hovertemplate});var I=h.orig_p,D=I!==void 0?I:h.pos,R;v.orientation==="h"?(R=p,o.xLabelVal=b.x,o.yLabelVal=D):(R=x,o.xLabelVal=D,o.yLabelVal=b.y);var O=R._id.charAt(0);return o[O+"Spike"]=R.c2p(h.pos,!0),e(b,v,o),o}ee.exports={hoverPoints:a,hoverOnBoxes:n,hoverOnPoints:r}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],688:[function(d,ee,te){ee.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults").supplyDefaults,crossTraceDefaults:d("./defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults").supplyLayoutDefaults,calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc").crossTraceCalc,plot:d("./plot").plot,style:d("./style").style,styleOnSelect:d("./style").styleOnSelect,hoverPoints:d("./hover").hoverPoints,eventData:d("./event_data"),selectPoints:d("./select"),moduleType:"trace",name:"box",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./attributes":682,"./calc":683,"./cross_trace_calc":684,"./defaults":685,"./event_data":686,"./hover":687,"./layout_attributes":689,"./layout_defaults":690,"./plot":691,"./select":692,"./style":693}],689:[function(d,ee,te){ee.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],690:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib"),S=d("./layout_attributes");function M(a,n,r,t,c){for(var s=c+"Layout",i=!1,x=0;x<r.length;x++){var p=r[x];if(A.traceIs(p,s)){i=!0;break}}!i||(t(c+"mode"),t(c+"gap"),t(c+"groupgap"))}function e(a,n,r){function t(c,s){return g.coerce(a,n,S,c,s)}M(a,n,r,t,"box")}ee.exports={supplyLayoutDefaults:e,_supply:M}},{"../../lib":515,"../../registry":647,"./layout_attributes":689}],691:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=d("../../components/drawing"),M=5,e=.01;function a(c,s,i,x){var p=s.xaxis,v=s.yaxis;g.makeTraceGroups(x,i,"trace boxes").each(function(f){var y=A.select(this),o=f[0],m=o.t,l=o.trace;if(m.wdPos=m.bdPos*l.whiskerwidth,l.visible!==!0||m.empty){y.remove();return}var w,_;l.orientation==="h"?(w=v,_=p):(w=p,_=v),n(y,{pos:w,val:_},l,m),r(y,{x:p,y:v},l,m),t(y,{pos:w,val:_},l,m)})}function n(c,s,i,x){var p=i.orientation==="h",v=s.val,f=s.pos,y=!!f.rangebreaks,o=x.bPos,m=x.wdPos||0,l=x.bPosPxOffset||0,w=i.whiskerwidth||0,_=i.notched||!1,h=_?1-2*i.notchwidth:1,b,u;Array.isArray(x.bdPos)?(b=x.bdPos[0],u=x.bdPos[1]):(b=x.bdPos,u=x.bdPos);var L=c.selectAll("path.box").data(i.type!=="violin"||i.box.visible?g.identity:[]);L.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),L.exit().remove(),L.each(function(T){if(T.empty)return"M0,0Z";var k=f.c2l(T.pos+o,!0),P=f.l2p(k-b)+l,z=f.l2p(k+u)+l,I=y?(P+z)/2:f.l2p(k)+l,D=i.whiskerwidth,R=y?P*D+(1-D)*I:f.l2p(k-m)+l,O=y?z*D+(1-D)*I:f.l2p(k+m)+l,F=f.l2p(k-b*h)+l,N=f.l2p(k+u*h)+l,G=v.c2p(T.q1,!0),K=v.c2p(T.q3,!0),W=g.constrain(v.c2p(T.med,!0),Math.min(G,K)+1,Math.max(G,K)-1),Y=T.lf===void 0||i.boxpoints===!1,re=v.c2p(Y?T.min:T.lf,!0),ue=v.c2p(Y?T.max:T.uf,!0),j=v.c2p(T.ln,!0),q=v.c2p(T.un,!0);p?A.select(this).attr("d","M"+W+","+F+"V"+N+"M"+G+","+P+"V"+z+(_?"H"+j+"L"+W+","+N+"L"+q+","+z:"")+"H"+K+"V"+P+(_?"H"+q+"L"+W+","+F+"L"+j+","+P:"")+"ZM"+G+","+I+"H"+re+"M"+K+","+I+"H"+ue+(w===0?"":"M"+re+","+R+"V"+O+"M"+ue+","+R+"V"+O)):A.select(this).attr("d","M"+F+","+W+"H"+N+"M"+P+","+G+"H"+z+(_?"V"+j+"L"+N+","+W+"L"+z+","+q:"")+"V"+K+"H"+P+(_?"V"+q+"L"+F+","+W+"L"+P+","+j:"")+"ZM"+I+","+G+"V"+re+"M"+I+","+K+"V"+ue+(w===0?"":"M"+R+","+re+"H"+O+"M"+R+","+ue+"H"+O))})}function r(c,s,i,x){var p=s.x,v=s.y,f=x.bdPos,y=x.bPos,o=i.boxpoints||i.points;g.seedPseudoRandom();var m=function(_){return _.forEach(function(h){h.t=x,h.trace=i}),_},l=c.selectAll("g.points").data(o?m:[]);l.enter().append("g").attr("class","points"),l.exit().remove();var w=l.selectAll("path").data(function(_){var h,b=_.pts2,u=Math.max((_.max-_.min)/10,_.q3-_.q1),L=u*1e-9,T=u*e,k=[],P=0,z;if(i.jitter){if(u===0)for(P=1,k=new Array(b.length),h=0;h<b.length;h++)k[h]=1;else for(h=0;h<b.length;h++){var I=Math.max(0,h-M),D=b[I].v,R=Math.min(b.length-1,h+M),O=b[R].v;o!=="all"&&(b[h].v<_.lf?O=Math.min(O,_.lf):D=Math.max(D,_.uf));var F=Math.sqrt(T*(R-I)/(O-D+L))||0;F=g.constrain(Math.abs(F),0,1),k.push(F),P=Math.max(F,P)}z=i.jitter*2/(P||1)}for(h=0;h<b.length;h++){var N=b[h],G=N.v,K=i.jitter?z*k[h]*(g.pseudoRandom()-.5):0,W=_.pos+y+f*(i.pointpos+K);i.orientation==="h"?(N.y=W,N.x=G):(N.x=W,N.y=G),o==="suspectedoutliers"&&G<_.uo&&G>_.lo&&(N.so=!0)}return b});w.enter().append("path").classed("point",!0),w.exit().remove(),w.call(S.translatePoints,p,v)}function t(c,s,i,x){var p=s.val,v=s.pos,f=!!v.rangebreaks,y=x.bPos,o=x.bPosPxOffset||0,m=i.boxmean||(i.meanline||{}).visible,l,w;Array.isArray(x.bdPos)?(l=x.bdPos[0],w=x.bdPos[1]):(l=x.bdPos,w=x.bdPos);var _=c.selectAll("path.mean").data(i.type==="box"&&i.boxmean||i.type==="violin"&&i.box.visible&&i.meanline.visible?g.identity:[]);_.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),_.exit().remove(),_.each(function(h){var b=v.c2l(h.pos+y,!0),u=v.l2p(b-l)+o,L=v.l2p(b+w)+o,T=f?(u+L)/2:v.l2p(b)+o,k=p.c2p(h.mean,!0),P=p.c2p(h.mean-h.sd,!0),z=p.c2p(h.mean+h.sd,!0);i.orientation==="h"?A.select(this).attr("d","M"+k+","+u+"V"+L+(m==="sd"?"m0,0L"+P+","+T+"L"+k+","+u+"L"+z+","+T+"Z":"")):A.select(this).attr("d","M"+u+","+k+"H"+L+(m==="sd"?"m0,0L"+T+","+P+"L"+u+","+k+"L"+T+","+z+"Z":""))})}ee.exports={plot:a,plotBoxAndWhiskers:n,plotPoints:r,plotBoxMean:t}},{"../../components/drawing":389,"../../lib":515,"@plotly/d3":58}],692:[function(d,ee,te){ee.exports=function(g,S){var M=g.cd,e=g.xaxis,a=g.yaxis,n=[],r,t;if(S===!1)for(r=0;r<M.length;r++)for(t=0;t<(M[r].pts||[]).length;t++)M[r].pts[t].selected=0;else for(r=0;r<M.length;r++)for(t=0;t<(M[r].pts||[]).length;t++){var c=M[r].pts[t],s=e.c2p(c.x),i=a.c2p(c.y);S.contains([s,i],null,c.i,g)?(n.push({pointNumber:c.i,x:e.c2d(c.x),y:a.c2d(c.y)}),c.selected=1):c.selected=0}return n}},{}],693:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/color"),S=d("../../components/drawing");function M(a,n,r){var t=r||A.select(a).selectAll("g.trace.boxes");t.style("opacity",function(c){return c[0].trace.opacity}),t.each(function(c){var s=A.select(this),i=c[0].trace,x=i.line.width;function p(y,o,m,l){y.style("stroke-width",o+"px").call(g.stroke,m).call(g.fill,l)}var v=s.selectAll("path.box");if(i.type==="candlestick")v.each(function(y){if(!y.empty){var o=A.select(this),m=i[y.dir];p(o,m.line.width,m.line.color,m.fillcolor),o.style("opacity",i.selectedpoints&&!y.selected?.3:1)}});else{p(v,x,i.line.color,i.fillcolor),s.selectAll("path.mean").style({"stroke-width":x,"stroke-dasharray":2*x+"px,"+x+"px"}).call(g.stroke,i.line.color);var f=s.selectAll("path.point");S.pointStyle(f,i,a)}})}function e(a,n,r){var t=n[0].trace,c=r.selectAll("path.point");t.selectedpoints?S.selectedPointStyle(c,t):S.pointStyle(c,t,a)}ee.exports={style:M,styleOnSelect:e}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],694:[function(d,ee,te){var A=d("../../lib").extendFlat,g=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../ohlc/attributes"),M=d("../box/attributes");function e(a){return{line:{color:A({},M.line.color,{dflt:a}),width:M.line.width,editType:"style"},fillcolor:M.fillcolor,editType:"style"}}ee.exports={xperiod:S.xperiod,xperiod0:S.xperiod0,xperiodalignment:S.xperiodalignment,xhoverformat:g("x"),yhoverformat:g("y"),x:S.x,open:S.open,high:S.high,low:S.low,close:S.close,line:{width:A({},M.line.width,{}),editType:"style"},increasing:e(S.increasing.line.color.dflt),decreasing:e(S.decreasing.line.color.dflt),text:S.text,hovertext:S.hovertext,whiskerwidth:A({},M.whiskerwidth,{dflt:0}),hoverlabel:S.hoverlabel}},{"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682,"../ohlc/attributes":881}],695:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axes"),S=d("../../plots/cartesian/align_period"),M=d("../ohlc/calc").calcCommon;ee.exports=function(a,n){var r=a._fullLayout,t=g.getFromId(a,n.xaxis),c=g.getFromId(a,n.yaxis),s=t.makeCalcdata(n,"x"),i=S(n,t,"x",s).vals,x=M(a,n,s,i,c,e);return x.length?(A.extendFlat(x[0].t,{num:r._numBoxes,dPos:A.distinctVals(i).minDiff/2,posLetter:"x",valLetter:"y"}),r._numBoxes++,x):[{t:{empty:!0}}]};function e(a,n,r,t){return{min:r,q1:Math.min(a,t),med:t,q3:Math.max(a,t),max:n}}},{"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../ohlc/calc":882}],696:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/color"),S=d("../ohlc/ohlc_defaults"),M=d("../scatter/period_defaults"),e=d("./attributes");ee.exports=function(r,t,c,s){function i(p,v){return A.coerce(r,t,e,p,v)}var x=S(r,t,i,s);if(!x){t.visible=!1;return}M(r,t,s,i,{x:!0}),i("xhoverformat"),i("yhoverformat"),i("line.width"),a(r,t,i,"increasing"),a(r,t,i,"decreasing"),i("text"),i("hovertext"),i("whiskerwidth"),s._requestRangeslider[t.xaxis]=!0};function a(n,r,t,c){var s=t(c+".line.color");t(c+".line.width",r.line.width),t(c+".fillcolor",g.addOpacity(s,.5))}},{"../../components/color":367,"../../lib":515,"../ohlc/ohlc_defaults":886,"../scatter/period_defaults":956,"./attributes":694}],697:[function(d,ee,te){ee.exports={moduleType:"trace",name:"candlestick",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:d("./attributes"),layoutAttributes:d("../box/layout_attributes"),supplyLayoutDefaults:d("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:d("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("../box/plot").plot,layerName:"boxlayer",style:d("../box/style").style,hoverPoints:d("../ohlc/hover").hoverPoints,selectPoints:d("../ohlc/select")}},{"../../plots/cartesian":578,"../box/cross_trace_calc":684,"../box/layout_attributes":689,"../box/layout_defaults":690,"../box/plot":691,"../box/style":693,"../ohlc/hover":884,"../ohlc/select":888,"./attributes":694,"./calc":695,"./defaults":696}],698:[function(d,ee,te){var A=d("./axis_defaults"),g=d("../../plot_api/plot_template");ee.exports=function(e,a,n,r,t){var c=r("a");c||(r("da"),r("a0"));var s=r("b");s||(r("db"),r("b0")),S(e,a,n,t)};function S(M,e,a,n){var r=["aaxis","baxis"];r.forEach(function(t){var c=t.charAt(0),s=M[t]||{},i=g.newContainer(e,t),x={noTicklabelstep:!0,tickfont:"x",id:c+"axis",letter:c,font:e.font,name:t,data:M[c],calendar:e.calendar,dfltColor:n,bgColor:a.paper_bgcolor,autotypenumbersDflt:a.autotypenumbers,fullLayout:a};A(s,i,x),i._categories=i._categories||[],!M[t]&&s.type!=="-"&&(M[t]={type:s.type})})}},{"../../plot_api/plot_template":555,"./axis_defaults":703}],699:[function(d,ee,te){var A=d("../../lib").isArrayOrTypedArray;ee.exports=function(S){return g(S,0)};function g(S,M){if(!A(S)||M>=10)return null;for(var e=1/0,a=-1/0,n=S.length,r=0;r<n;r++){var t=S[r];if(A(t)){var c=g(t,M+1);c&&(e=Math.min(c[0],e),a=Math.max(c[1],a))}else e=Math.min(t,e),a=Math.max(t,a)}return[e,a]}},{"../../lib":515}],700:[function(d,ee,te){var A=d("../../plots/font_attributes"),g=d("./axis_attributes"),S=d("../../components/color/attributes"),M=A({editType:"calc"});M.family.dflt='"Open Sans", verdana, arial, sans-serif',M.size.dflt=12,M.color.dflt=S.defaultLine,ee.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:g,baxis:g,font:M,color:{valType:"color",dflt:S.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":366,"../../plots/font_attributes":594,"./axis_attributes":702}],701:[function(d,ee,te){var A=d("../../lib").isArrayOrTypedArray;ee.exports=function(g,S,M,e){var a,n,r,t,c,s,i,x,p,v,f,y,o,m=A(M)?"a":"b",l=m==="a"?g.aaxis:g.baxis,w=l.smoothing,_=m==="a"?g.a2i:g.b2j,h=m==="a"?M:e,b=m==="a"?e:M,u=m==="a"?S.a.length:S.b.length,L=m==="a"?S.b.length:S.a.length,T=Math.floor(m==="a"?g.b2j(b):g.a2i(b)),k=m==="a"?function(Y){return g.evalxy([],Y,T)}:function(Y){return g.evalxy([],T,Y)};w&&(r=Math.max(0,Math.min(L-2,T)),t=T-r,n=m==="a"?function(Y,re){return g.dxydi([],Y,r,re,t)}:function(Y,re){return g.dxydj([],r,Y,t,re)});var P=_(h[0]),z=_(h[1]),I=P<z?1:-1,D=(z-P)*1e-8,R=I>0?Math.floor:Math.ceil,O=I>0?Math.ceil:Math.floor,F=I>0?Math.min:Math.max,N=I>0?Math.max:Math.min,G=R(P+D),K=O(z-D);i=k(P);var W=[[i]];for(a=G;a*I<K*I;a+=I)c=[],f=N(P,a),y=F(z,a+I),o=y-f,s=Math.max(0,Math.min(u-2,Math.floor(.5*(f+y)))),x=k(y),w&&(p=n(s,f-s),v=n(s,y-s),c.push([i[0]+p[0]/3*o,i[1]+p[1]/3*o]),c.push([x[0]-v[0]/3*o,x[1]-v[1]/3*o])),c.push(x),W.push(c),i=x;return W}},{"../../lib":515}],702:[function(d,ee,te){var A=d("../../plots/font_attributes"),g=d("../../components/color/attributes"),S=d("../../plots/cartesian/layout_attributes"),M=d("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=d("../../plot_api/edit_types").overrideAll,a=d("../../components/drawing/attributes").dash,n=d("../../lib/extend").extendFlat;ee.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:A({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:S.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:A({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:M("tick label")},tickformatstops:e(S.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:g.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},griddash:n({},a,{editType:"calc"}),showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgriddash:n({},a,{editType:"calc"}),minorgridcolor:{valType:"color",dflt:g.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:A({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],703:[function(d,ee,te){var A=d("./attributes"),g=d("../../components/color").addOpacity,S=d("../../registry"),M=d("../../lib"),e=d("../../plots/cartesian/tick_value_defaults"),a=d("../../plots/cartesian/tick_label_defaults"),n=d("../../plots/cartesian/prefix_suffix_defaults"),r=d("../../plots/cartesian/category_order_defaults"),t=d("../../plots/cartesian/set_convert"),c=d("../../plots/cartesian/axis_autotype");ee.exports=function(x,p,v){var f=v.letter,y=v.font||{},o=A[f+"axis"];function m(G,K){return M.coerce(x,p,o,G,K)}function l(G,K){return M.coerce2(x,p,o,G,K)}v.name&&(p._name=v.name,p._id=v.name),m("autotypenumbers",v.autotypenumbersDflt);var w=m("type");if(w==="-"&&(v.data&&s(p,v.data),p.type==="-"?p.type="linear":w=x.type=p.type),m("smoothing"),m("cheatertype"),m("showticklabels"),m("labelprefix",f+" = "),m("labelsuffix"),m("showtickprefix"),m("showticksuffix"),m("separatethousands"),m("tickformat"),m("exponentformat"),m("minexponent"),m("showexponent"),m("categoryorder"),m("tickmode"),m("tickvals"),m("ticktext"),m("tick0"),m("dtick"),p.tickmode==="array"&&(m("arraytick0"),m("arraydtick")),m("labelpadding"),p._hovertitle=f,w==="date"){var _=S.getComponentMethod("calendars","handleDefaults");_(x,p,"calendar",v.calendar)}t(p,v.fullLayout),p.c2p=M.identity;var h=m("color",v.dfltColor),b=h===x.color?h:y.color,u=m("title.text");u&&(M.coerceFont(m,"title.font",{family:y.family,size:M.bigFont(y.size),color:b}),m("title.offset")),m("tickangle");var L=m("autorange",!p.isValidRange(x.range));L&&m("rangemode"),m("range"),p.cleanRange(),m("fixedrange"),e(x,p,m,w),n(x,p,m,w,v),a(x,p,m,w,v),r(x,p,m,{data:v.data,dataAttr:f});var T=l("gridcolor",g(h,.3)),k=l("gridwidth"),P=l("griddash"),z=m("showgrid");z||(delete p.gridcolor,delete p.gridwidth,delete p.griddash);var I=l("startlinecolor",h),D=l("startlinewidth",k),R=m("startline",p.showgrid||!!I||!!D);R||(delete p.startlinecolor,delete p.startlinewidth);var O=l("endlinecolor",h),F=l("endlinewidth",k),N=m("endline",p.showgrid||!!O||!!F);return N||(delete p.endlinecolor,delete p.endlinewidth),z?(m("minorgridcount"),m("minorgridwidth",k),m("minorgriddash",P),m("minorgridcolor",g(T,.06)),p.minorgridcount||(delete p.minorgridwidth,delete p.minorgriddash,delete p.minorgridcolor)):(delete p.gridcolor,delete p.gridwidth,delete p.griddash),p.showticklabels==="none"&&(delete p.tickfont,delete p.tickangle,delete p.showexponent,delete p.exponentformat,delete p.minexponent,delete p.tickformat,delete p.showticksuffix,delete p.showtickprefix),p.showticksuffix||delete p.ticksuffix,p.showtickprefix||delete p.tickprefix,m("tickmode"),p};function s(i,x){if(i.type==="-"){var p=i._id,v=p.charAt(0),f=v+"calendar",y=i[f];i.type=c(x,y,{autotypenumbers:i.autotypenumbers})}}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../plots/cartesian/category_order_defaults":571,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/set_convert":585,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_value_defaults":589,"../../registry":647,"./attributes":700}],704:[function(d,ee,te){var A=d("../../plots/cartesian/axes"),g=d("../../lib").isArray1D,S=d("./cheater_basis"),M=d("./array_minmax"),e=d("./calc_gridlines"),a=d("./calc_labels"),n=d("./calc_clippath"),r=d("../heatmap/clean_2d_array"),t=d("./smooth_fill_2d_array"),c=d("../heatmap/convert_column_xyz"),s=d("./set_convert");ee.exports=function(x,p){var v=A.getFromId(x,p.xaxis),f=A.getFromId(x,p.yaxis),y=p.aaxis,o=p.baxis,m=p.x,l=p.y,w=[];m&&g(m)&&w.push("x"),l&&g(l)&&w.push("y"),w.length&&c(p,y,o,"a","b",w);var _=p._a=p._a||p.a,h=p._b=p._b||p.b;m=p._x||p.x,l=p._y||p.y;var b={};if(p._cheater){var u=y.cheatertype==="index"?_.length:_,L=o.cheatertype==="index"?h.length:h;m=S(u,L,p.cheaterslope)}p._x=m=r(m),p._y=l=r(l),t(m,_,h),t(l,_,h),s(p),p.setScale();var T=M(m),k=M(l),P=.5*(T[1]-T[0]),z=.5*(T[1]+T[0]),I=.5*(k[1]-k[0]),D=.5*(k[1]+k[0]),R=1.3;return T=[z-P*R,z+P*R],k=[D-I*R,D+I*R],p._extremes[v._id]=A.findExtremes(v,T,{padded:!0}),p._extremes[f._id]=A.findExtremes(f,k,{padded:!0}),e(p,"a","b"),e(p,"b","a"),a(p,y),a(p,o),b.clipsegments=n(p._xctrl,p._yctrl,y,o),b.x=m,b.y=l,b.a=_,b.b=h,[b]}},{"../../lib":515,"../../plots/cartesian/axes":566,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"./array_minmax":699,"./calc_clippath":705,"./calc_gridlines":706,"./calc_labels":707,"./cheater_basis":709,"./set_convert":722,"./smooth_fill_2d_array":723}],705:[function(d,ee,te){ee.exports=function(g,S,M,e){var a,n,r,t=[],c=!!M.smoothing,s=!!e.smoothing,i=g[0].length-1,x=g.length-1;for(a=0,n=[],r=[];a<=i;a++)n[a]=g[0][a],r[a]=S[0][a];for(t.push({x:n,y:r,bicubic:c}),a=0,n=[],r=[];a<=x;a++)n[a]=g[a][i],r[a]=S[a][i];for(t.push({x:n,y:r,bicubic:s}),a=i,n=[],r=[];a>=0;a--)n[i-a]=g[x][a],r[i-a]=S[x][a];for(t.push({x:n,y:r,bicubic:c}),a=x,n=[],r=[];a>=0;a--)n[x-a]=g[a][0],r[x-a]=S[a][0];return t.push({x:n,y:r,bicubic:s}),t}},{}],706:[function(d,ee,te){var A=d("../../plots/cartesian/axes"),g=d("../../lib/extend").extendFlat;ee.exports=function(M,e,a){var n,r,t,c,s,i,x,p,v,f,y,o,m,l,w=M["_"+e],_=M[e+"axis"],h=_._gridlines=[],b=_._minorgridlines=[],u=_._boundarylines=[],L=M["_"+a],T=M[a+"axis"];_.tickmode==="array"&&(_.tickvals=w.slice());var k=M._xctrl,P=M._yctrl,z=k[0].length,I=k.length,D=M._a.length,R=M._b.length;A.prepTicks(_),_.tickmode==="array"&&delete _.tickvals;var O=_.smoothing?3:1;function F(G){var K,W,Y,re,ue,j,q,V,U,$,ne,X,Q=[],ie=[],se={};if(e==="b")for(W=M.b2j(G),Y=Math.floor(Math.max(0,Math.min(R-2,W))),re=W-Y,se.length=R,se.crossLength=D,se.xy=function(ae){return M.evalxy([],ae,W)},se.dxy=function(ae,oe){return M.dxydi([],ae,Y,oe,re)},K=0;K<D;K++)j=Math.min(D-2,K),q=K-j,V=M.evalxy([],K,W),T.smoothing&&K>0&&(U=M.dxydi([],K-1,Y,0,re),Q.push(ue[0]+U[0]/3),ie.push(ue[1]+U[1]/3),$=M.dxydi([],K-1,Y,1,re),Q.push(V[0]-$[0]/3),ie.push(V[1]-$[1]/3)),Q.push(V[0]),ie.push(V[1]),ue=V;else for(K=M.a2i(G),j=Math.floor(Math.max(0,Math.min(D-2,K))),q=K-j,se.length=D,se.crossLength=R,se.xy=function(ae){return M.evalxy([],K,ae)},se.dxy=function(ae,oe){return M.dxydj([],j,ae,q,oe)},W=0;W<R;W++)Y=Math.min(R-2,W),re=W-Y,V=M.evalxy([],K,W),T.smoothing&&W>0&&(ne=M.dxydj([],j,W-1,q,0),Q.push(ue[0]+ne[0]/3),ie.push(ue[1]+ne[1]/3),X=M.dxydj([],j,W-1,q,1),Q.push(V[0]-X[0]/3),ie.push(V[1]-X[1]/3)),Q.push(V[0]),ie.push(V[1]),ue=V;return se.axisLetter=e,se.axis=_,se.crossAxis=T,se.value=G,se.constvar=a,se.index=p,se.x=Q,se.y=ie,se.smoothing=T.smoothing,se}function N(G){var K,W,Y,re,ue,j=[],q=[],V={};if(V.length=w.length,V.crossLength=L.length,e==="b")for(Y=Math.max(0,Math.min(R-2,G)),ue=Math.min(1,Math.max(0,G-Y)),V.xy=function(U){return M.evalxy([],U,G)},V.dxy=function(U,$){return M.dxydi([],U,Y,$,ue)},K=0;K<z;K++)j[K]=k[G*O][K],q[K]=P[G*O][K];else for(W=Math.max(0,Math.min(D-2,G)),re=Math.min(1,Math.max(0,G-W)),V.xy=function(U){return M.evalxy([],G,U)},V.dxy=function(U,$){return M.dxydj([],W,U,re,$)},K=0;K<I;K++)j[K]=k[K][G*O],q[K]=P[K][G*O];return V.axisLetter=e,V.axis=_,V.crossAxis=T,V.value=w[G],V.constvar=a,V.index=G,V.x=j,V.y=q,V.smoothing=T.smoothing,V}if(_.tickmode==="array"){for(c=5e-15,s=[Math.floor((w.length-1-_.arraytick0)/_.arraydtick*(1+c)),Math.ceil(-_.arraytick0/_.arraydtick/(1+c))].sort(function(G,K){return G-K}),i=s[0]-1,x=s[1]+1,p=i;p<x;p++)r=_.arraytick0+_.arraydtick*p,!(r<0||r>w.length-1)&&h.push(g(N(r),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(p=i;p<x;p++)if(t=_.arraytick0+_.arraydtick*p,y=Math.min(t+_.arraydtick,w.length-1),!(t<0||t>w.length-1)&&!(y<0||y>w.length-1))for(o=w[t],m=w[y],n=0;n<_.minorgridcount;n++)l=y-t,!(l<=0)&&(f=o+(m-o)*(n+1)/(_.minorgridcount+1)*(_.arraydtick/l),!(f<w[0]||f>w[w.length-1])&&b.push(g(F(f),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash})));_.startline&&u.push(g(N(0),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&u.push(g(N(w.length-1),{color:_.endlinecolor,width:_.endlinewidth}))}else{for(c=5e-15,s=[Math.floor((w[w.length-1]-_.tick0)/_.dtick*(1+c)),Math.ceil((w[0]-_.tick0)/_.dtick/(1+c))].sort(function(G,K){return G-K}),i=s[0],x=s[1],p=i;p<=x;p++)v=_.tick0+_.dtick*p,h.push(g(F(v),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(p=i-1;p<x+1;p++)for(v=_.tick0+_.dtick*p,n=0;n<_.minorgridcount;n++)f=v+_.dtick*(n+1)/(_.minorgridcount+1),!(f<w[0]||f>w[w.length-1])&&b.push(g(F(f),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash}));_.startline&&u.push(g(F(w[0]),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&u.push(g(F(w[w.length-1]),{color:_.endlinecolor,width:_.endlinewidth}))}}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],707:[function(d,ee,te){var A=d("../../plots/cartesian/axes"),g=d("../../lib/extend").extendFlat;ee.exports=function(M,e){var a,n,r,t,c,s=e._labels=[],i=e._gridlines;for(a=0;a<i.length;a++)c=i[a],["start","both"].indexOf(e.showticklabels)!==-1&&(n=A.tickText(e,c.value),g(n,{prefix:r,suffix:t,endAnchor:!0,xy:c.xy(0),dxy:c.dxy(0,0),axis:c.axis,length:c.crossAxis.length,font:c.axis.tickfont,isFirst:a===0,isLast:a===i.length-1}),s.push(n)),["end","both"].indexOf(e.showticklabels)!==-1&&(n=A.tickText(e,c.value),g(n,{endAnchor:!1,xy:c.xy(c.crossLength-1),dxy:c.dxy(c.crossLength-2,1),axis:c.axis,length:c.crossAxis.length,font:c.axis.tickfont,isFirst:a===0,isLast:a===i.length-1}),s.push(n))}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],708:[function(d,ee,te){var A=.5;ee.exports=function(S,M,e,a){var n=S[0]-M[0],r=S[1]-M[1],t=e[0]-M[0],c=e[1]-M[1],s=Math.pow(n*n+r*r,A/2),i=Math.pow(t*t+c*c,A/2),x=(i*i*n-s*s*t)*a,p=(i*i*r-s*s*c)*a,v=i*(s+i)*3,f=s*(s+i)*3;return[[M[0]+(v&&x/v),M[1]+(v&&p/v)],[M[0]-(f&&x/f),M[1]-(f&&p/f)]]}},{}],709:[function(d,ee,te){var A=d("../../lib").isArrayOrTypedArray;ee.exports=function(g,S,M){var e,a,n,r,t,c,s=[],i=A(g)?g.length:g,x=A(S)?S.length:S,p=A(g)?g:null,v=A(S)?S:null;p&&(n=(p.length-1)/(p[p.length-1]-p[0])/(i-1)),v&&(r=(v.length-1)/(v[v.length-1]-v[0])/(x-1));var f,y=1/0,o=-1/0;for(a=0;a<x;a++)for(s[a]=[],c=v?(v[a]-v[0])*r:a/(x-1),e=0;e<i;e++)t=p?(p[e]-p[0])*n:e/(i-1),f=t-c*M,y=Math.min(f,y),o=Math.max(f,o),s[a][e]=f;var m=1/(o-y),l=-y*m;for(a=0;a<x;a++)for(e=0;e<i;e++)s[a][e]=m*s[a][e]+l;return s}},{"../../lib":515}],710:[function(d,ee,te){var A=d("./catmull_rom"),g=d("../../lib").ensureArray;function S(M,e,a){var n=-.5*a[0]+1.5*e[0],r=-.5*a[1]+1.5*e[1];return[(2*n+M[0])/3,(2*r+M[1])/3]}ee.exports=function(e,a,n,r,t,c){var s,i,x,p,v,f,y,o,m,l,w=n[0].length,_=n.length,h=t?3*w-2:w,b=c?3*_-2:_;for(e=g(e,b),a=g(a,b),x=0;x<b;x++)e[x]=g(e[x],h),a[x]=g(a[x],h);for(i=0,p=0;i<_;i++,p+=c?3:1)for(v=e[p],f=a[p],y=n[i],o=r[i],s=0,x=0;s<w;s++,x+=t?3:1)v[x]=y[s],f[x]=o[s];if(t)for(i=0,p=0;i<_;i++,p+=c?3:1){for(s=1,x=3;s<w-1;s++,x+=3)m=A([n[i][s-1],r[i][s-1]],[n[i][s],r[i][s]],[n[i][s+1],r[i][s+1]],t),e[p][x-1]=m[0][0],a[p][x-1]=m[0][1],e[p][x+1]=m[1][0],a[p][x+1]=m[1][1];l=S([e[p][0],a[p][0]],[e[p][2],a[p][2]],[e[p][3],a[p][3]]),e[p][1]=l[0],a[p][1]=l[1],l=S([e[p][h-1],a[p][h-1]],[e[p][h-3],a[p][h-3]],[e[p][h-4],a[p][h-4]]),e[p][h-2]=l[0],a[p][h-2]=l[1]}if(c)for(x=0;x<h;x++){for(p=3;p<b-3;p+=3)m=A([e[p-3][x],a[p-3][x]],[e[p][x],a[p][x]],[e[p+3][x],a[p+3][x]],c),e[p-1][x]=m[0][0],a[p-1][x]=m[0][1],e[p+1][x]=m[1][0],a[p+1][x]=m[1][1];l=S([e[0][x],a[0][x]],[e[2][x],a[2][x]],[e[3][x],a[3][x]]),e[1][x]=l[0],a[1][x]=l[1],l=S([e[b-1][x],a[b-1][x]],[e[b-3][x],a[b-3][x]],[e[b-4][x],a[b-4][x]]),e[b-2][x]=l[0],a[b-2][x]=l[1]}if(t&&c)for(p=1;p<b;p+=(p+1)%3===0?2:1){for(x=3;x<h-3;x+=3)m=A([e[p][x-3],a[p][x-3]],[e[p][x],a[p][x]],[e[p][x+3],a[p][x+3]],t),e[p][x-1]=.5*(e[p][x-1]+m[0][0]),a[p][x-1]=.5*(a[p][x-1]+m[0][1]),e[p][x+1]=.5*(e[p][x+1]+m[1][0]),a[p][x+1]=.5*(a[p][x+1]+m[1][1]);l=S([e[p][0],a[p][0]],[e[p][2],a[p][2]],[e[p][3],a[p][3]]),e[p][1]=.5*(e[p][1]+l[0]),a[p][1]=.5*(a[p][1]+l[1]),l=S([e[p][h-1],a[p][h-1]],[e[p][h-3],a[p][h-3]],[e[p][h-4],a[p][h-4]]),e[p][h-2]=.5*(e[p][h-2]+l[0]),a[p][h-2]=.5*(a[p][h-2]+l[1])}return[e,a]}},{"../../lib":515,"./catmull_rom":708}],711:[function(d,ee,te){ee.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],712:[function(d,ee,te){ee.exports=function(A,g,S){return g&&S?function(M,e,a,n,r){M||(M=[]);var t,c,s,i,x,p;e*=3,a*=3;var v=n*n,f=1-n,y=f*f,o=f*n*2,m=-3*y,l=3*(y-o),w=3*(o-v),_=3*v,h=r*r,b=h*r,u=1-r,L=u*u,T=L*u;for(p=0;p<A.length;p++)x=A[p],t=m*x[a][e]+l*x[a][e+1]+w*x[a][e+2]+_*x[a][e+3],c=m*x[a+1][e]+l*x[a+1][e+1]+w*x[a+1][e+2]+_*x[a+1][e+3],s=m*x[a+2][e]+l*x[a+2][e+1]+w*x[a+2][e+2]+_*x[a+2][e+3],i=m*x[a+3][e]+l*x[a+3][e+1]+w*x[a+3][e+2]+_*x[a+3][e+3],M[p]=T*t+3*(L*r*c+u*h*s)+b*i;return M}:g?function(M,e,a,n,r){M||(M=[]);var t,c,s,i;e*=3;var x=n*n,p=1-n,v=p*p,f=p*n*2,y=-3*v,o=3*(v-f),m=3*(f-x),l=3*x,w=1-r;for(s=0;s<A.length;s++)i=A[s],t=y*i[a][e]+o*i[a][e+1]+m*i[a][e+2]+l*i[a][e+3],c=y*i[a+1][e]+o*i[a+1][e+1]+m*i[a+1][e+2]+l*i[a+1][e+3],M[s]=w*t+r*c;return M}:S?function(M,e,a,n,r){M||(M=[]);var t,c,s,i,x,p;a*=3;var v=r*r,f=v*r,y=1-r,o=y*y,m=o*y;for(x=0;x<A.length;x++)p=A[x],t=p[a][e+1]-p[a][e],c=p[a+1][e+1]-p[a+1][e],s=p[a+2][e+1]-p[a+2][e],i=p[a+3][e+1]-p[a+3][e],M[x]=m*t+3*(o*r*c+y*v*s)+f*i;return M}:function(M,e,a,n,r){M||(M=[]);var t,c,s,i,x=1-r;for(s=0;s<A.length;s++)i=A[s],t=i[a][e+1]-i[a][e],c=i[a+1][e+1]-i[a+1][e],M[s]=x*t+r*c;return M}}},{}],713:[function(d,ee,te){ee.exports=function(A,g,S){return g&&S?function(M,e,a,n,r){M||(M=[]);var t,c,s,i,x,p;e*=3,a*=3;var v=n*n,f=v*n,y=1-n,o=y*y,m=o*y,l=r*r,w=1-r,_=w*w,h=w*r*2,b=-3*_,u=3*(_-h),L=3*(h-l),T=3*l;for(p=0;p<A.length;p++)x=A[p],t=b*x[a][e]+u*x[a+1][e]+L*x[a+2][e]+T*x[a+3][e],c=b*x[a][e+1]+u*x[a+1][e+1]+L*x[a+2][e+1]+T*x[a+3][e+1],s=b*x[a][e+2]+u*x[a+1][e+2]+L*x[a+2][e+2]+T*x[a+3][e+2],i=b*x[a][e+3]+u*x[a+1][e+3]+L*x[a+2][e+3]+T*x[a+3][e+3],M[p]=m*t+3*(o*n*c+y*v*s)+f*i;return M}:g?function(M,e,a,n,r){M||(M=[]);var t,c,s,i,x,p;e*=3;var v=r*r,f=v*r,y=1-r,o=y*y,m=o*y;for(x=0;x<A.length;x++)p=A[x],t=p[a+1][e]-p[a][e],c=p[a+1][e+1]-p[a][e+1],s=p[a+1][e+2]-p[a][e+2],i=p[a+1][e+3]-p[a][e+3],M[x]=m*t+3*(o*r*c+y*v*s)+f*i;return M}:S?function(M,e,a,n,r){M||(M=[]);var t,c,s,i;a*=3;var x=1-n,p=r*r,v=1-r,f=v*v,y=v*r*2,o=-3*f,m=3*(f-y),l=3*(y-p),w=3*p;for(s=0;s<A.length;s++)i=A[s],t=o*i[a][e]+m*i[a+1][e]+l*i[a+2][e]+w*i[a+3][e],c=o*i[a][e+1]+m*i[a+1][e+1]+l*i[a+2][e+1]+w*i[a+3][e+1],M[s]=x*t+n*c;return M}:function(M,e,a,n,r){M||(M=[]);var t,c,s,i,x=1-n;for(s=0;s<A.length;s++)i=A[s],t=i[a+1][e]-i[a][e],c=i[a+1][e+1]-i[a][e+1],M[s]=x*t+n*c;return M}}},{}],714:[function(d,ee,te){ee.exports=function(A,g,S,M,e){var a=g-2,n=S-2;return M&&e?function(r,t,c){r||(r=[]);var s,i,x,p,v,f,y=Math.max(0,Math.min(Math.floor(t),a)),o=Math.max(0,Math.min(Math.floor(c),n)),m=Math.max(0,Math.min(1,t-y)),l=Math.max(0,Math.min(1,c-o));y*=3,o*=3;var w=m*m,_=w*m,h=1-m,b=h*h,u=b*h,L=l*l,T=L*l,k=1-l,P=k*k,z=P*k;for(f=0;f<A.length;f++)v=A[f],s=u*v[o][y]+3*(b*m*v[o][y+1]+h*w*v[o][y+2])+_*v[o][y+3],i=u*v[o+1][y]+3*(b*m*v[o+1][y+1]+h*w*v[o+1][y+2])+_*v[o+1][y+3],x=u*v[o+2][y]+3*(b*m*v[o+2][y+1]+h*w*v[o+2][y+2])+_*v[o+2][y+3],p=u*v[o+3][y]+3*(b*m*v[o+3][y+1]+h*w*v[o+3][y+2])+_*v[o+3][y+3],r[f]=z*s+3*(P*l*i+k*L*x)+T*p;return r}:M?function(r,t,c){r||(r=[]);var s=Math.max(0,Math.min(Math.floor(t),a)),i=Math.max(0,Math.min(Math.floor(c),n)),x=Math.max(0,Math.min(1,t-s)),p=Math.max(0,Math.min(1,c-i)),v,f,y,o,m,l;s*=3;var w=x*x,_=w*x,h=1-x,b=h*h,u=b*h,L=1-p;for(m=0;m<A.length;m++)l=A[m],v=L*l[i][s]+p*l[i+1][s],f=L*l[i][s+1]+p*l[i+1][s+1],y=L*l[i][s+2]+p*l[i+1][s+1],o=L*l[i][s+3]+p*l[i+1][s+1],r[m]=u*v+3*(b*x*f+h*w*y)+_*o;return r}:e?function(r,t,c){r||(r=[]);var s=Math.max(0,Math.min(Math.floor(t),a)),i=Math.max(0,Math.min(Math.floor(c),n)),x=Math.max(0,Math.min(1,t-s)),p=Math.max(0,Math.min(1,c-i)),v,f,y,o,m,l;i*=3;var w=p*p,_=w*p,h=1-p,b=h*h,u=b*h,L=1-x;for(m=0;m<A.length;m++)l=A[m],v=L*l[i][s]+x*l[i][s+1],f=L*l[i+1][s]+x*l[i+1][s+1],y=L*l[i+2][s]+x*l[i+2][s+1],o=L*l[i+3][s]+x*l[i+3][s+1],r[m]=u*v+3*(b*p*f+h*w*y)+_*o;return r}:function(r,t,c){r||(r=[]);var s=Math.max(0,Math.min(Math.floor(t),a)),i=Math.max(0,Math.min(Math.floor(c),n)),x=Math.max(0,Math.min(1,t-s)),p=Math.max(0,Math.min(1,c-i)),v,f,y,o,m=1-p,l=1-x;for(y=0;y<A.length;y++)o=A[y],v=l*o[i][s]+x*o[i][s+1],f=l*o[i+1][s]+x*o[i+1][s+1],r[y]=m*v+p*f;return r}}},{}],715:[function(d,ee,te){var A=d("../../lib"),g=d("./xy_defaults"),S=d("./ab_defaults"),M=d("./attributes"),e=d("../../components/color/attributes");ee.exports=function(n,r,t,c){function s(p,v){return A.coerce(n,r,M,p,v)}r._clipPathId="clip"+r.uid+"carpet";var i=s("color",e.defaultLine);if(A.coerceFont(s,"font"),s("carpet"),S(n,r,c,s,i),!r.a||!r.b){r.visible=!1;return}r.a.length<3&&(r.aaxis.smoothing=0),r.b.length<3&&(r.baxis.smoothing=0);var x=g(n,r,s);x||(r.visible=!1),r._cheater&&s("cheaterslope")}},{"../../components/color/attributes":366,"../../lib":515,"./ab_defaults":698,"./attributes":700,"./xy_defaults":724}],716:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),plot:d("./plot"),calc:d("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"./attributes":700,"./calc":704,"./defaults":715,"./plot":721}],717:[function(d,ee,te){ee.exports=function(A,g){for(var S=A._fullData.length,M,e=0;e<S;e++){var a=A._fullData[e];if(a.index!==g.index&&a.type==="carpet"&&(M||(M=a),a.carpet===g.carpet))return a}return M}},{}],718:[function(d,ee,te){ee.exports=function(g,S,M){if(g.length===0)return"";var e,a=[],n=M?3:1;for(e=0;e<g.length;e+=n)a.push(g[e]+","+S[e]),M&&e<g.length-n&&(a.push("C"),a.push([g[e+1]+","+S[e+1],g[e+2]+","+S[e+2]+" "].join(" ")));return a.join(M?"":"L")}},{}],719:[function(d,ee,te){var A=d("../../lib").isArrayOrTypedArray;ee.exports=function(S,M,e){var a;for(A(S)?S.length>M.length&&(S=S.slice(0,M.length)):S=[],a=0;a<M.length;a++)S[a]=e(M[a]);return S}},{"../../lib":515}],720:[function(d,ee,te){ee.exports=function(g,S,M,e,a,n){var r=a[0]*g.dpdx(S),t=a[1]*g.dpdy(M),c=1,s=1;if(n){var i=Math.sqrt(a[0]*a[0]+a[1]*a[1]),x=Math.sqrt(n[0]*n[0]+n[1]*n[1]),p=(a[0]*n[0]+a[1]*n[1])/i/x;s=Math.max(0,p)}var v=Math.atan2(t,r)*180/Math.PI;return v<-90?(v+=180,c=-c):v>90&&(v-=180,c=-c),{angle:v,flip:c,p:g.c2p(e,S,M),offsetMultplier:s}}},{}],721:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/drawing"),S=d("./map_1d_array"),M=d("./makepath"),e=d("./orient_text"),a=d("../../lib/svg_text_utils"),n=d("../../lib"),r=n.strRotate,t=n.strTranslate,c=d("../../constants/alignment");ee.exports=function(m,l,w,_){var h=l.xaxis,b=l.yaxis,u=m._fullLayout,L=u._clips;n.makeTraceGroups(_,w,"trace").each(function(T){var k=A.select(this),P=T[0],z=P.trace,I=z.aaxis,D=z.baxis,R=n.ensureSingle(k,"g","minorlayer"),O=n.ensureSingle(k,"g","majorlayer"),F=n.ensureSingle(k,"g","boundarylayer"),N=n.ensureSingle(k,"g","labellayer");k.style("opacity",z.opacity),i(h,b,O,I,"a",I._gridlines),i(h,b,O,D,"b",D._gridlines),i(h,b,R,I,"a",I._minorgridlines),i(h,b,R,D,"b",D._minorgridlines),i(h,b,F,I,"a-boundary",I._boundarylines),i(h,b,F,D,"b-boundary",D._boundarylines);var G=x(m,h,b,z,P,N,I._labels,"a-label"),K=x(m,h,b,z,P,N,D._labels,"b-label");p(m,N,z,P,h,b,G,K),s(z,P,L,h,b)})};function s(o,m,l,w,_){var h,b,u,L,T=l.select("#"+o._clipPathId);T.size()||(T=l.append("clipPath").classed("carpetclip",!0));var k=n.ensureSingle(T,"path","carpetboundary"),P=m.clipsegments,z=[];for(L=0;L<P.length;L++)h=P[L],b=S([],h.x,w.c2p),u=S([],h.y,_.c2p),z.push(M(b,u,h.bicubic));var I="M"+z.join("L")+"Z";T.attr("id",o._clipPathId),k.attr("d",I)}function i(o,m,l,w,_,h){var b="const-"+_+"-lines",u=l.selectAll("."+b).data(h);u.enter().append("path").classed(b,!0).style("vector-effect","non-scaling-stroke"),u.each(function(L){var T=L,k=T.x,P=T.y,z=S([],k,o.c2p),I=S([],P,m.c2p),D="M"+M(z,I,T.smoothing),R=A.select(this);R.attr("d",D).style("stroke-width",T.width).style("stroke",T.color).style("stroke-dasharray",g.dashStyle(T.dash,T.width)).style("fill","none")}),u.exit().remove()}function x(o,m,l,w,_,h,b,u){var L=h.selectAll("text."+u).data(b);L.enter().append("text").classed(u,!0);var T=0,k={};return L.each(function(P,z){var I;if(P.axis.tickangle==="auto")I=e(w,m,l,P.xy,P.dxy);else{var D=(P.axis.tickangle+180)*Math.PI/180;I=e(w,m,l,P.xy,[Math.cos(D),Math.sin(D)])}z||(k={angle:I.angle,flip:I.flip});var R=(P.endAnchor?-1:1)*I.flip,O=A.select(this).attr({"text-anchor":R>0?"start":"end","data-notex":1}).call(g.font,P.font).text(P.text).call(a.convertToTspans,o),F=g.bBox(this);O.attr("transform",t(I.p[0],I.p[1])+r(I.angle)+t(P.axis.labelpadding*R,F.height*.3)),T=Math.max(T,F.width+P.axis.labelpadding)}),L.exit().remove(),k.maxExtent=T,k}function p(o,m,l,w,_,h,b,u){var L,T,k,P,z=n.aggNums(Math.min,null,l.a),I=n.aggNums(Math.max,null,l.a),D=n.aggNums(Math.min,null,l.b),R=n.aggNums(Math.max,null,l.b);L=.5*(z+I),T=D,k=l.ab2xy(L,T,!0),P=l.dxyda_rough(L,T),b.angle===void 0&&n.extendFlat(b,e(l,_,h,k,l.dxydb_rough(L,T))),y(o,m,l,w,k,P,l.aaxis,_,h,b,"a-title"),L=z,T=.5*(D+R),k=l.ab2xy(L,T,!0),P=l.dxydb_rough(L,T),u.angle===void 0&&n.extendFlat(u,e(l,_,h,k,l.dxyda_rough(L,T))),y(o,m,l,w,k,P,l.baxis,_,h,u,"b-title")}var v=c.LINE_SPACING,f=(1-c.MID_SHIFT)/v+1;function y(o,m,l,w,_,h,b,u,L,T,k){var P=[];b.title.text&&P.push(b.title.text);var z=m.selectAll("text."+k).data(P),I=T.maxExtent;z.enter().append("text").classed(k,!0),z.each(function(){var D=e(l,u,L,_,h);["start","both"].indexOf(b.showticklabels)===-1&&(I=0);var R=b.title.font.size;I+=R+b.title.offset;var O=T.angle+(T.flip<0?180:0),F=(O-D.angle+450)%360,N=F>90&&F<270,G=A.select(this);G.text(b.title.text).call(a.convertToTspans,o),N&&(I=(-a.lineCount(G)+f)*v*R-I),G.attr("transform",t(D.p[0],D.p[1])+r(D.angle)+t(0,I)).attr("text-anchor","middle").call(g.font,b.title.font)}),z.exit().remove()}},{"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"./makepath":718,"./map_1d_array":719,"./orient_text":720,"@plotly/d3":58}],722:[function(d,ee,te){var A=d("./constants"),g=d("../../lib/search").findBin,S=d("./compute_control_points"),M=d("./create_spline_evaluator"),e=d("./create_i_derivative_evaluator"),a=d("./create_j_derivative_evaluator");ee.exports=function(r){var t=r._a,c=r._b,s=t.length,i=c.length,x=r.aaxis,p=r.baxis,v=t[0],f=t[s-1],y=c[0],o=c[i-1],m=t[t.length-1]-t[0],l=c[c.length-1]-c[0],w=m*A.RELATIVE_CULL_TOLERANCE,_=l*A.RELATIVE_CULL_TOLERANCE;v-=w,f+=w,y-=_,o+=_,r.isVisible=function(h,b){return h>v&&h<f&&b>y&&b<o},r.isOccluded=function(h,b){return h<v||h>f||b<y||b>o},r.setScale=function(){var h=r._x,b=r._y,u=S(r._xctrl,r._yctrl,h,b,x.smoothing,p.smoothing);r._xctrl=u[0],r._yctrl=u[1],r.evalxy=M([r._xctrl,r._yctrl],s,i,x.smoothing,p.smoothing),r.dxydi=e([r._xctrl,r._yctrl],x.smoothing,p.smoothing),r.dxydj=a([r._xctrl,r._yctrl],x.smoothing,p.smoothing)},r.i2a=function(h){var b=Math.max(0,Math.floor(h[0]),s-2),u=h[0]-b;return(1-u)*t[b]+u*t[b+1]},r.j2b=function(h){var b=Math.max(0,Math.floor(h[1]),s-2),u=h[1]-b;return(1-u)*c[b]+u*c[b+1]},r.ij2ab=function(h){return[r.i2a(h[0]),r.j2b(h[1])]},r.a2i=function(h){var b=Math.max(0,Math.min(g(h,t),s-2)),u=t[b],L=t[b+1];return Math.max(0,Math.min(s-1,b+(h-u)/(L-u)))},r.b2j=function(h){var b=Math.max(0,Math.min(g(h,c),i-2)),u=c[b],L=c[b+1];return Math.max(0,Math.min(i-1,b+(h-u)/(L-u)))},r.ab2ij=function(h){return[r.a2i(h[0]),r.b2j(h[1])]},r.i2c=function(h,b){return r.evalxy([],h,b)},r.ab2xy=function(h,b,u){if(!u&&(h<t[0]||h>t[s-1]|b<c[0]||b>c[i-1]))return[!1,!1];var L=r.a2i(h),T=r.b2j(b),k=r.evalxy([],L,T);if(u){var P=0,z=0,I=[],D,R,O,F;h<t[0]?(D=0,R=0,P=(h-t[0])/(t[1]-t[0])):h>t[s-1]?(D=s-2,R=1,P=(h-t[s-1])/(t[s-1]-t[s-2])):(D=Math.max(0,Math.min(s-2,Math.floor(L))),R=L-D),b<c[0]?(O=0,F=0,z=(b-c[0])/(c[1]-c[0])):b>c[i-1]?(O=i-2,F=1,z=(b-c[i-1])/(c[i-1]-c[i-2])):(O=Math.max(0,Math.min(i-2,Math.floor(T))),F=T-O),P&&(r.dxydi(I,D,O,R,F),k[0]+=I[0]*P,k[1]+=I[1]*P),z&&(r.dxydj(I,D,O,R,F),k[0]+=I[0]*z,k[1]+=I[1]*z)}return k},r.c2p=function(h,b,u){return[b.c2p(h[0]),u.c2p(h[1])]},r.p2x=function(h,b,u){return[b.p2c(h[0]),u.p2c(h[1])]},r.dadi=function(h){var b=Math.max(0,Math.min(t.length-2,h));return t[b+1]-t[b]},r.dbdj=function(h){var b=Math.max(0,Math.min(c.length-2,h));return c[b+1]-c[b]},r.dxyda=function(h,b,u,L){var T=r.dxydi(null,h,b,u,L),k=r.dadi(h,u);return[T[0]/k,T[1]/k]},r.dxydb=function(h,b,u,L){var T=r.dxydj(null,h,b,u,L),k=r.dbdj(b,L);return[T[0]/k,T[1]/k]},r.dxyda_rough=function(h,b,u){var L=m*(u||.1),T=r.ab2xy(h+L,b,!0),k=r.ab2xy(h-L,b,!0);return[(T[0]-k[0])*.5/L,(T[1]-k[1])*.5/L]},r.dxydb_rough=function(h,b,u){var L=l*(u||.1),T=r.ab2xy(h,b+L,!0),k=r.ab2xy(h,b-L,!0);return[(T[0]-k[0])*.5/L,(T[1]-k[1])*.5/L]},r.dpdx=function(h){return h._m},r.dpdy=function(h){return h._m}}},{"../../lib/search":535,"./compute_control_points":710,"./constants":711,"./create_i_derivative_evaluator":712,"./create_j_derivative_evaluator":713,"./create_spline_evaluator":714}],723:[function(d,ee,te){var A=d("../../lib");ee.exports=function(S,M,e){var a,n,r,t=[],c=[],s=S[0].length,i=S.length;function x(W,Y){var re=0,ue,j=0;return W>0&&(ue=S[Y][W-1])!==void 0&&(j++,re+=ue),W<s-1&&(ue=S[Y][W+1])!==void 0&&(j++,re+=ue),Y>0&&(ue=S[Y-1][W])!==void 0&&(j++,re+=ue),Y<i-1&&(ue=S[Y+1][W])!==void 0&&(j++,re+=ue),re/Math.max(1,j)}var p=0;for(a=0;a<s;a++)for(n=0;n<i;n++)S[n][a]===void 0&&(t.push(a),c.push(n),S[n][a]=x(a,n)),p=Math.max(p,Math.abs(S[n][a]));if(!t.length)return S;var v,f,y,o,m,l,w,_,h,b,u,L=1e-5,T=0,k=100,P=0,z=t.length;do{for(T=0,r=0;r<z;r++){a=t[r],n=c[r];var I=0,D=0,R,O,F,N,G,K;a===0?(G=Math.min(s-1,2),F=M[G],N=M[1],R=S[n][G],O=S[n][1],D+=O+(O-R)*(M[0]-N)/(N-F),I++):a===s-1&&(G=Math.max(0,s-3),F=M[G],N=M[s-2],R=S[n][G],O=S[n][s-2],D+=O+(O-R)*(M[s-1]-N)/(N-F),I++),(a===0||a===s-1)&&n>0&&n<i-1&&(v=e[n+1]-e[n],f=e[n]-e[n-1],D+=(f*S[n+1][a]+v*S[n-1][a])/(f+v),I++),n===0?(K=Math.min(i-1,2),F=e[K],N=e[1],R=S[K][a],O=S[1][a],D+=O+(O-R)*(e[0]-N)/(N-F),I++):n===i-1&&(K=Math.max(0,i-3),F=e[K],N=e[i-2],R=S[K][a],O=S[i-2][a],D+=O+(O-R)*(e[i-1]-N)/(N-F),I++),(n===0||n===i-1)&&a>0&&a<s-1&&(v=M[a+1]-M[a],f=M[a]-M[a-1],D+=(f*S[n][a+1]+v*S[n][a-1])/(f+v),I++),I?D/=I:(y=M[a+1]-M[a],o=M[a]-M[a-1],m=e[n+1]-e[n],l=e[n]-e[n-1],w=y*o*(y+o),_=m*l*(m+l),D=(w*(l*S[n+1][a]+m*S[n-1][a])+_*(o*S[n][a+1]+y*S[n][a-1]))/(_*(o+y)+w*(l+m))),h=D-S[n][a],b=h/p,T+=b*b,u=I?0:.85,S[n][a]+=h*(1+u)}T=Math.sqrt(T)}while(P++<k&&T>L);return A.log("Smoother converged to",T,"after",P,"iterations"),S}},{"../../lib":515}],724:[function(d,ee,te){var A=d("../../lib").isArray1D;ee.exports=function(S,M,e){var a=e("x"),n=a&&a.length,r=e("y"),t=r&&r.length;if(!n&&!t)return!1;if(M._cheater=!a,(!n||A(a))&&(!t||A(r))){var c=n?a.length:1/0;t&&(c=Math.min(c,r.length)),M.a&&M.a.length&&(c=Math.min(c,M.a.length)),M.b&&M.b.length&&(c=Math.min(c,M.b.length)),M._length=c}else M._length=null;return!0}},{"../../lib":515}],725:[function(d,ee,te){var A=d("../../plots/template_attributes").hovertemplateAttrs,g=d("../scattergeo/attributes"),S=d("../../components/colorscale/attributes"),M=d("../../plots/attributes"),e=d("../../components/color/attributes").defaultLine,a=d("../../lib/extend").extendFlat,n=g.marker.line;ee.exports=a({locations:{valType:"data_array",editType:"calc"},locationmode:g.locationmode,z:{valType:"data_array",editType:"calc"},geojson:a({},g.geojson,{}),featureidkey:g.featureidkey,text:a({},g.text,{}),hovertext:a({},g.hovertext,{}),marker:{line:{color:a({},n.color,{dflt:e}),width:a({},n.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:g.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:g.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:a({},M.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:A(),showlegend:a({},M.showlegend,{dflt:!1})},S("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattergeo/attributes":978}],726:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../constants/numerical").BADNUM,S=d("../../components/colorscale/calc"),M=d("../scatter/arrays_to_calcdata"),e=d("../scatter/calc_selection");function a(n){return n&&typeof n=="string"}ee.exports=function(r,t){var c=t._length,s=new Array(c),i;t.geojson?i=function(y){return a(y)||A(y)}:i=a;for(var x=0;x<c;x++){var p=s[x]={},v=t.locations[x],f=t.z[x];i(v)&&A(f)?(p.loc=v,p.z=f):(p.loc=null,p.z=g),p.index=x}return M(s,t),S(r,t,{vals:t.z,containerStr:"",cLetter:"z"}),e(s,t),s}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"fast-isnumeric":190}],727:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/colorscale/defaults"),S=d("./attributes");ee.exports=function(e,a,n,r){function t(f,y){return A.coerce(e,a,S,f,y)}var c=t("locations"),s=t("z");if(!(c&&c.length&&A.isArrayOrTypedArray(s)&&s.length)){a.visible=!1;return}a._length=Math.min(c.length,s.length);var i=t("geojson"),x;(typeof i=="string"&&i!==""||A.isPlainObject(i))&&(x="geojson-id");var p=t("locationmode",x);p==="geojson-id"&&t("featureidkey"),t("text"),t("hovertext"),t("hovertemplate");var v=t("marker.line.width");v&&t("marker.line.color"),t("marker.opacity"),g(e,a,r,t,{prefix:"",cLetter:"z"}),A.coerceSelectionMarkerOpacity(a,t)}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":725}],728:[function(d,ee,te){ee.exports=function(g,S,M,e,a){g.location=S.location,g.z=S.z;var n=e[a];return n.fIn&&n.fIn.properties&&(g.properties=n.fIn.properties),g.ct=n.ct,g}},{}],729:[function(d,ee,te){var A=d("../../plots/cartesian/axes"),g=d("./attributes"),S=d("../../lib").fillText;ee.exports=function(a,n,r){var t=a.cd,c=t[0].trace,s=a.subplot,i,x,p,v,f=[n,r],y=[n+360,r];for(x=0;x<t.length;x++)if(i=t[x],v=!1,i._polygons){for(p=0;p<i._polygons.length;p++)i._polygons[p].contains(f)&&(v=!v),i._polygons[p].contains(y)&&(v=!v);if(v)break}if(!(!v||!i))return a.x0=a.x1=a.xa.c2p(i.ct),a.y0=a.y1=a.ya.c2p(i.ct),a.index=i.index,a.location=i.loc,a.z=i.z,a.zLabel=A.tickText(s.mockAxis,s.mockAxis.c2l(i.z),"hover").text,a.hovertemplate=i.hovertemplate,M(a,c,i),[a]};function M(e,a,n){if(!a.hovertemplate){var r=n.hi||a.hoverinfo,t=String(n.loc),c=r==="all"?g.hoverinfo.flags:r.split("+"),s=c.indexOf("name")!==-1,i=c.indexOf("location")!==-1,x=c.indexOf("z")!==-1,p=c.indexOf("text")!==-1,v=!s&&i,f=[];v?e.nameOverride=t:(s&&(e.nameOverride=a.name),i&&f.push(t)),x&&f.push(e.zLabel),p&&S(n,a,f),e.extraText=f.join("<br>")}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./attributes":725}],730:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../heatmap/colorbar"),calc:d("./calc"),calcGeoJSON:d("./plot").calcGeoJSON,plot:d("./plot").plot,style:d("./style").style,styleOnSelect:d("./style").styleOnSelect,hoverPoints:d("./hover"),eventData:d("./event_data"),selectPoints:d("./select"),moduleType:"trace",name:"choropleth",basePlotModule:d("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":598,"../heatmap/colorbar":804,"./attributes":725,"./calc":726,"./defaults":727,"./event_data":728,"./hover":729,"./plot":731,"./select":732,"./style":733}],731:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=d("../../lib/geo_location_utils"),M=d("../../lib/topojson_utils").getTopojsonFeatures,e=d("../../plots/cartesian/autorange").findExtremes,a=d("./style").style;function n(t,c,s){var i=c.layers.backplot.select(".choroplethlayer");g.makeTraceGroups(i,s,"trace choropleth").each(function(x){var p=A.select(this),v=p.selectAll("path.choroplethlocation").data(g.identity);v.enter().append("path").classed("choroplethlocation",!0),v.exit().remove(),a(t,x)})}function r(t,c){for(var s=t[0].trace,i=c[s.geo],x=i._subplot,p=s.locationmode,v=s._length,f=p==="geojson-id"?S.extractTraceFeature(t):M(s,x.topojson),y=[],o=[],m=0;m<v;m++){var l=t[m],w=p==="geojson-id"?l.fOut:S.locationToFeature(p,l.loc,f);if(w){l.geojson=w,l.ct=w.properties.ct,l._polygons=S.feature2polygons(w);var _=S.computeBbox(w);y.push(_[0],_[2]),o.push(_[1],_[3])}else l.geojson=null}if(i.fitbounds==="geojson"&&p==="geojson-id"){var h=S.computeBbox(S.getTraceGeojson(s));y=[h[0],h[2]],o=[h[1],h[3]]}var b={padded:!0};s._extremes.lon=e(i.lonaxis._ax,y,b),s._extremes.lat=e(i.lataxis._ax,o,b)}ee.exports={calcGeoJSON:r,plot:n}},{"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"./style":733,"@plotly/d3":58}],732:[function(d,ee,te){ee.exports=function(g,S){var M=g.cd,e=g.xaxis,a=g.yaxis,n=[],r,t,c,s,i;if(S===!1)for(r=0;r<M.length;r++)M[r].selected=0;else for(r=0;r<M.length;r++)t=M[r],c=t.ct,c&&(s=e.c2p(c),i=a.c2p(c),S.contains([s,i],null,r,g)?(n.push({pointNumber:r,lon:c[0],lat:c[1]}),t.selected=1):t.selected=0);return n}},{}],733:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/color"),S=d("../../components/drawing"),M=d("../../components/colorscale");function e(r,t){t&&a(r,t)}function a(r,t){var c=t[0].trace,s=t[0].node3,i=s.selectAll(".choroplethlocation"),x=c.marker||{},p=x.line||{},v=M.makeColorScaleFuncFromTrace(c);i.each(function(f){A.select(this).attr("fill",v(f.z)).call(g.stroke,f.mlc||p.color).call(S.dashLine,"",f.mlw||p.width||0).style("opacity",x.opacity)}),S.selectedPointStyle(i,c)}function n(r,t){var c=t[0].node3,s=t[0].trace;s.selectedpoints?S.selectedPointStyle(c.selectAll(".choroplethlocation"),s):a(r,t)}ee.exports={style:e,styleOnSelect:n}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"@plotly/d3":58}],734:[function(d,ee,te){var A=d("../choropleth/attributes"),g=d("../../components/colorscale/attributes"),S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../../plots/attributes"),e=d("../../lib/extend").extendFlat;ee.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},A.featureidkey,{}),below:{valType:"string",editType:"plot"},text:A.text,hovertext:A.hovertext,marker:{line:{color:e({},A.marker.line.color,{editType:"plot"}),width:e({},A.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},A.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},A.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},A.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:A.hoverinfo,hovertemplate:S({},{keys:["properties"]}),showlegend:e({},M.showlegend,{dflt:!1})},g("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../choropleth/attributes":725}],735:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib"),S=d("../../components/colorscale"),M=d("../../components/drawing"),e=d("../../lib/geojson_utils").makeBlank,a=d("../../lib/geo_location_utils");function n(t){var c=t[0].trace,s=c.visible===!0&&c._length!==0,i={layout:{visibility:"none"},paint:{}},x={layout:{visibility:"none"},paint:{}},p=c._opts={fill:i,line:x,geojson:e()};if(!s)return p;var v=a.extractTraceFeature(t);if(!v)return p;var f=S.makeColorScaleFuncFromTrace(c),y=c.marker,o=y.line||{},m;g.isArrayOrTypedArray(y.opacity)&&(m=function(T){var k=T.mo;return A(k)?+g.constrain(k,0,1):0});var l;g.isArrayOrTypedArray(o.color)&&(l=function(T){return T.mlc});var w;g.isArrayOrTypedArray(o.width)&&(w=function(T){return T.mlw});for(var _=0;_<t.length;_++){var h=t[_],b=h.fOut;if(b){var u=b.properties;u.fc=f(h.z),m&&(u.mo=m(h)),l&&(u.mlc=l(h)),w&&(u.mlw=w(h)),h.ct=u.ct,h._polygons=a.feature2polygons(b)}}var L=m?{type:"identity",property:"mo"}:y.opacity;return g.extendFlat(i.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":L}),g.extendFlat(x.paint,{"line-color":l?{type:"identity",property:"mlc"}:o.color,"line-width":w?{type:"identity",property:"mlw"}:o.width,"line-opacity":L}),i.layout.visibility="visible",x.layout.visibility="visible",p.geojson={type:"FeatureCollection",features:v},r(t),p}function r(t){var c=t[0].trace,s=c._opts,i;if(c.selectedpoints){for(var x=M.makeSelectedPointStyleFns(c),p=0;p<t.length;p++){var v=t[p];v.fOut&&(v.fOut.properties.mo2=x.selectedOpacityFn(v))}i={type:"identity",property:"mo2"}}else i=g.isArrayOrTypedArray(c.marker.opacity)?{type:"identity",property:"mo"}:c.marker.opacity;return g.extendFlat(s.fill.paint,{"fill-opacity":i}),g.extendFlat(s.line.paint,{"line-opacity":i}),s}ee.exports={convert:n,convertOnSelect:r}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"fast-isnumeric":190}],736:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/colorscale/defaults"),S=d("./attributes");ee.exports=function(e,a,n,r){function t(p,v){return A.coerce(e,a,S,p,v)}var c=t("locations"),s=t("z"),i=t("geojson");if(!A.isArrayOrTypedArray(c)||!c.length||!A.isArrayOrTypedArray(s)||!s.length||!(typeof i=="string"&&i!==""||A.isPlainObject(i))){a.visible=!1;return}t("featureidkey"),a._length=Math.min(c.length,s.length),t("below"),t("text"),t("hovertext"),t("hovertemplate");var x=t("marker.line.width");x&&t("marker.line.color"),t("marker.opacity"),g(e,a,r,t,{prefix:"",cLetter:"z"}),A.coerceSelectionMarkerOpacity(a,t)}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":734}],737:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../heatmap/colorbar"),calc:d("../choropleth/calc"),plot:d("./plot"),hoverPoints:d("../choropleth/hover"),eventData:d("../choropleth/event_data"),selectPoints:d("../choropleth/select"),styleOnSelect:function(A,g){if(g){var S=g[0].trace;S._glTrace.updateOnSelect(g)}},getBelow:function(A,g){for(var S=g.getMapLayers(),M=S.length-2;M>=0;M--){var e=S[M].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var a=M+1;a<S.length;a++)if(e=S[a].id,typeof e=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:d("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":622,"../choropleth/calc":726,"../choropleth/event_data":728,"../choropleth/hover":729,"../choropleth/select":732,"../heatmap/colorbar":804,"./attributes":734,"./defaults":736,"./plot":738}],738:[function(d,ee,te){var A=d("./convert").convert,g=d("./convert").convertOnSelect,S=d("../../plots/mapbox/constants").traceLayerPrefix;function M(a,n){this.type="choroplethmapbox",this.subplot=a,this.uid=n,this.sourceId="source-"+n,this.layerList=[["fill",S+n+"-fill"],["line",S+n+"-line"]],this.below=null}var e=M.prototype;e.update=function(a){this._update(A(a)),a[0].trace._glTrace=this},e.updateOnSelect=function(a){this._update(g(a))},e._update=function(a){var n=this.subplot,r=this.layerList,t=n.belowLookup["trace-"+this.uid];n.map.getSource(this.sourceId).setData(a.geojson),t!==this.below&&(this._removeLayers(),this._addLayers(a,t),this.below=t);for(var c=0;c<r.length;c++){var s=r[c],i=s[0],x=s[1],p=a[i];n.setOptions(x,"setLayoutProperty",p.layout),p.layout.visibility==="visible"&&n.setOptions(x,"setPaintProperty",p.paint)}},e._addLayers=function(a,n){for(var r=this.subplot,t=this.layerList,c=this.sourceId,s=0;s<t.length;s++){var i=t[s],x=i[0],p=a[x];r.addLayer({type:x,id:i[1],source:c,layout:p.layout,paint:p.paint},n)}},e._removeLayers=function(){for(var a=this.subplot.map,n=this.layerList,r=n.length-1;r>=0;r--)a.removeLayer(n[r][1])},e.dispose=function(){var a=this.subplot.map;this._removeLayers(),a.removeSource(this.sourceId)},ee.exports=function(n,r){var t=r[0].trace,c=new M(n,t.uid),s=c.sourceId,i=A(r),x=c.below=n.belowLookup["trace-"+t.uid];return n.map.addSource(s,{type:"geojson",data:i.geojson}),c._addLayers(i,x),r[0].trace._glTrace=c,c}},{"../../plots/mapbox/constants":620,"./convert":735}],739:[function(d,ee,te){var A=d("../../components/colorscale/attributes"),g=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../mesh3d/attributes"),e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:S({editType:"calc"},{keys:["norm"]}),uhoverformat:g("u",1),vhoverformat:g("v",1),whoverformat:g("w",1),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),showlegend:a({},e.showlegend,{dflt:!1})};a(n,A("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));var r=["opacity","lightposition","lighting"];r.forEach(function(t){n[t]=M[t]}),n.hoverinfo=a({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,ee.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],740:[function(d,ee,te){var A=d("../../components/colorscale/calc");ee.exports=function(S,M){for(var e=M.u,a=M.v,n=M.w,r=Math.min(M.x.length,M.y.length,M.z.length,e.length,a.length,n.length),t=-1/0,c=1/0,s=0;s<r;s++){var i=e[s],x=a[s],p=n[s],v=Math.sqrt(i*i+x*x+p*p);t=Math.max(t,v),c=Math.min(c,v)}M._len=r,M._normMax=t,A(S,M,{vals:[c,t],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],741:[function(d,ee,te){var A=d("../../../stackgl_modules").gl_cone3d,g=d("../../../stackgl_modules").gl_cone3d.createConeMesh,S=d("../../lib").simpleMap,M=d("../../lib/gl_format_color").parseColorScale,e=d("../../components/colorscale").extractOpts,a=d("../../plots/gl3d/zip3");function n(p,v){this.scene=p,this.uid=v,this.mesh=null,this.data=null}var r=n.prototype;r.handlePick=function(p){if(p.object===this.mesh){var v=p.index=p.data.index,f=this.data.x[v],y=this.data.y[v],o=this.data.z[v],m=this.data.u[v],l=this.data.v[v],w=this.data.w[v];p.traceCoordinate=[f,y,o,m,l,w,Math.sqrt(m*m+l*l+w*w)];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[v]!==void 0?p.textLabel=_[v]:_&&(p.textLabel=_),!0}};var t={xaxis:0,yaxis:1,zaxis:2},c={tip:1,tail:0,cm:.25,center:.5},s={tip:1,tail:1,cm:.75,center:.5};function i(p,v){var f=p.fullSceneLayout,y=p.dataScale,o={};function m(h,b){var u=f[b],L=y[t[b]];return S(h,function(T){return u.d2l(T)*L})}o.vectors=a(m(v.u,"xaxis"),m(v.v,"yaxis"),m(v.w,"zaxis"),v._len),o.positions=a(m(v.x,"xaxis"),m(v.y,"yaxis"),m(v.z,"zaxis"),v._len);var l=e(v);o.colormap=M(v),o.vertexIntensityBounds=[l.min/v._normMax,l.max/v._normMax],o.coneOffset=c[v.anchor],v.sizemode==="scaled"?o.coneSize=v.sizeref||.5:o.coneSize=v.sizeref&&v._normMax?v.sizeref/v._normMax:.5;var w=A(o),_=v.lightposition;return w.lightPosition=[_.x,_.y,_.z],w.ambient=v.lighting.ambient,w.diffuse=v.lighting.diffuse,w.specular=v.lighting.specular,w.roughness=v.lighting.roughness,w.fresnel=v.lighting.fresnel,w.opacity=v.opacity,v._pad=s[v.anchor]*w.vectorScale*w.coneScale*v._normMax,w}r.update=function(p){this.data=p;var v=i(this.scene,p);this.mesh.update(v)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function x(p,v){var f=p.glplot.gl,y=i(p,v),o=g(f,y),m=new n(p,v.uid);return m.mesh=o,m.data=v,o._trace=m,p.glplot.add(o),m}ee.exports=x},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],742:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/colorscale/defaults"),S=d("./attributes");ee.exports=function(e,a,n,r){function t(f,y){return A.coerce(e,a,S,f,y)}var c=t("u"),s=t("v"),i=t("w"),x=t("x"),p=t("y"),v=t("z");if(!c||!c.length||!s||!s.length||!i||!i.length||!x||!x.length||!p||!p.length||!v||!v.length){a.visible=!1;return}t("sizeref"),t("sizemode"),t("anchor"),t("lighting.ambient"),t("lighting.diffuse"),t("lighting.specular"),t("lighting.roughness"),t("lighting.fresnel"),t("lightposition.x"),t("lightposition.y"),t("lightposition.z"),g(e,a,r,t,{prefix:"",cLetter:"c"}),t("text"),t("hovertext"),t("hovertemplate"),t("uhoverformat"),t("vhoverformat"),t("whoverformat"),t("xhoverformat"),t("yhoverformat"),t("zhoverformat"),a._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":739}],743:[function(d,ee,te){ee.exports={moduleType:"trace",name:"cone",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:d("./calc"),plot:d("./convert"),eventData:function(A,g){return A.norm=g.traceCoordinate[6],A},meta:{}}},{"../../plots/gl3d":607,"./attributes":739,"./calc":740,"./convert":741,"./defaults":742}],744:[function(d,ee,te){var A=d("../heatmap/attributes"),g=d("../scatter/attributes"),S=d("../../plots/cartesian/axis_format_attributes"),M=S.axisHoverFormat,e=S.descriptionOnlyNumbers,a=d("../../components/colorscale/attributes"),n=d("../../components/drawing/attributes").dash,r=d("../../plots/font_attributes"),t=d("../../lib/extend").extendFlat,c=d("../../constants/filter_ops"),s=c.COMPARISON_OPS2,i=c.INTERVAL_OPS,x=g.line;ee.exports=t({z:A.z,x:A.x,x0:A.x0,dx:A.dx,y:A.y,y0:A.y0,dy:A.dy,xperiod:A.xperiod,yperiod:A.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:A.xperiodalignment,yperiodalignment:A.yperiodalignment,text:A.text,hovertext:A.hovertext,transpose:A.transpose,xtype:A.xtype,ytype:A.ytype,xhoverformat:M("x"),yhoverformat:M("y"),zhoverformat:M("z",1),hovertemplate:A.hovertemplate,texttemplate:t({},A.texttemplate,{}),textfont:t({},A.textfont,{}),hoverongaps:A.hoverongaps,connectgaps:t({},A.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:r({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(s).concat(i),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:t({},x.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:n,smoothing:t({},x.smoothing,{}),editType:"plot"}},a("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../constants/filter_ops":487,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../heatmap/attributes":801,"../scatter/attributes":936}],745:[function(d,ee,te){var A=d("../../components/colorscale"),g=d("../heatmap/calc"),S=d("./set_contours"),M=d("./end_plus");ee.exports=function(a,n){var r=g(a,n),t=r[0].z;S(n,t);var c=n.contours,s=A.extractOpts(n),i;if(c.coloring==="heatmap"&&s.auto&&n.autocontour===!1){var x=c.start,p=M(c),v=c.size||1,f=Math.floor((p-x)/v)+1;isFinite(v)||(v=1,f=1);var y=x-v/2,o=y+f*v;i=[y,o]}else i=t;return A.calc(a,n,{vals:i,cLetter:"z"}),r}},{"../../components/colorscale":379,"../heatmap/calc":802,"./end_plus":755,"./set_contours":763}],746:[function(d,ee,te){ee.exports=function(A,g){var S=A[0],M=S.z,e;switch(g.type){case"levels":var a=Math.min(M[0][0],M[0][1]);for(e=0;e<A.length;e++){var n=A[e];n.prefixBoundary=!n.edgepaths.length&&(a>n.level||n.starts.length&&a===n.level)}break;case"constraint":if(S.prefixBoundary=!1,S.edgepaths.length)return;var r=S.x.length,t=S.y.length,c=-1/0,s=1/0;for(e=0;e<t;e++)s=Math.min(s,M[e][0]),s=Math.min(s,M[e][r-1]),c=Math.max(c,M[e][0]),c=Math.max(c,M[e][r-1]);for(e=1;e<r-1;e++)s=Math.min(s,M[0][e]),s=Math.min(s,M[t-1][e]),c=Math.max(c,M[0][e]),c=Math.max(c,M[t-1][e]);var i=g.value,x,p;switch(g._operation){case">":i>c&&(S.prefixBoundary=!0);break;case"<":(i<s||S.starts.length&&i===s)&&(S.prefixBoundary=!0);break;case"[]":x=Math.min(i[0],i[1]),p=Math.max(i[0],i[1]),(p<s||x>c||S.starts.length&&p===s)&&(S.prefixBoundary=!0);break;case"][":x=Math.min(i[0],i[1]),p=Math.max(i[0],i[1]),x<s&&p>c&&(S.prefixBoundary=!0);break}break}}},{}],747:[function(d,ee,te){var A=d("../../components/colorscale"),g=d("./make_color_map"),S=d("./end_plus");function M(e,a,n){var r=a.contours,t=a.line,c=r.size||1,s=r.coloring,i=g(a,{isColorbar:!0});if(s==="heatmap"){var x=A.extractOpts(a);n._fillgradient=x.reversescale?A.flipScale(x.colorscale):x.colorscale,n._zrange=[x.min,x.max]}else s==="fill"&&(n._fillcolor=i);n._line={color:s==="lines"?i:t.color,width:r.showlines!==!1?t.width:0,dash:t.dash},n._levels={start:r.start,end:S(r),size:c}}ee.exports={min:"zmin",max:"zmax",calc:M}},{"../../components/colorscale":379,"./end_plus":755,"./make_color_map":760}],748:[function(d,ee,te){ee.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],749:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("./label_defaults"),S=d("../../components/color"),M=S.addOpacity,e=S.opacity,a=d("../../constants/filter_ops"),n=a.CONSTRAINT_REDUCTION,r=a.COMPARISON_OPS2;ee.exports=function(s,i,x,p,v,f){var y=i.contours,o,m,l,w=x("contours.operation");if(y._operation=n[w],t(x,y),w==="="?o=y.showlines=!0:(o=x("contours.showlines"),l=x("fillcolor",M((s.line||{}).color||v,.5))),o){var _=l&&e(l)?M(i.fillcolor,1):v;m=x("line.color",_),x("line.width",2),x("line.dash")}x("line.smoothing"),g(x,p,m,f)};function t(c,s){var i;r.indexOf(s.operation)===-1?(c("contours.value",[0,1]),Array.isArray(s.value)?s.value.length>2?s.value=s.value.slice(2):s.length===0?s.value=[0,1]:s.length<2?(i=parseFloat(s.value[0]),s.value=[i,i+1]):s.value=[parseFloat(s.value[0]),parseFloat(s.value[1])]:A(s.value)&&(i=parseFloat(s.value),s.value=[i,i+1])):(c("contours.value",0),A(s.value)||(Array.isArray(s.value)?s.value=parseFloat(s.value[0]):s.value=0))}},{"../../components/color":367,"../../constants/filter_ops":487,"./label_defaults":759,"fast-isnumeric":190}],750:[function(d,ee,te){var A=d("../../constants/filter_ops"),g=d("fast-isnumeric");ee.exports={"[]":M("[]"),"][":M("]["),">":e(">"),"<":e("<"),"=":e("=")};function S(a,n){var r=Array.isArray(n),t;function c(s){return g(s)?+s:null}return A.COMPARISON_OPS2.indexOf(a)!==-1?t=c(r?n[0]:n):A.INTERVAL_OPS.indexOf(a)!==-1?t=r?[c(n[0]),c(n[1])]:[c(n),c(n)]:A.SET_OPS.indexOf(a)!==-1&&(t=r?n.map(c):[c(n)]),t}function M(a){return function(n){n=S(a,n);var r=Math.min(n[0],n[1]),t=Math.max(n[0],n[1]);return{start:r,end:t,size:t-r}}}function e(a){return function(n){return n=S(a,n),{start:n,end:1/0,size:1/0}}}},{"../../constants/filter_ops":487,"fast-isnumeric":190}],751:[function(d,ee,te){ee.exports=function(g,S,M,e){var a=e("contours.start"),n=e("contours.end"),r=a===!1||n===!1,t=M("contours.size"),c;r?c=S.autocontour=!0:c=M("autocontour",!1),(c||!t)&&M("ncontours")}},{}],752:[function(d,ee,te){var A=d("../../lib");ee.exports=function(S,M){var e,a,n,r=function(s){return s.reverse()},t=function(s){return s};switch(M){case"=":case"<":return S;case">":for(S.length!==1&&A.warn("Contour data invalid for the specified inequality operation."),a=S[0],e=0;e<a.edgepaths.length;e++)a.edgepaths[e]=r(a.edgepaths[e]);for(e=0;e<a.paths.length;e++)a.paths[e]=r(a.paths[e]);for(e=0;e<a.starts.length;e++)a.starts[e]=r(a.starts[e]);return S;case"][":var c=r;r=t,t=c;case"[]":for(S.length!==2&&A.warn("Contour data invalid for the specified inequality range operation."),a=g(S[0]),n=g(S[1]),e=0;e<a.edgepaths.length;e++)a.edgepaths[e]=r(a.edgepaths[e]);for(e=0;e<a.paths.length;e++)a.paths[e]=r(a.paths[e]);for(e=0;e<a.starts.length;e++)a.starts[e]=r(a.starts[e]);for(;n.edgepaths.length;)a.edgepaths.push(t(n.edgepaths.shift()));for(;n.paths.length;)a.paths.push(t(n.paths.shift()));for(;n.starts.length;)a.starts.push(t(n.starts.shift()));return[a]}};function g(S){return A.extendFlat({},S,{edgepaths:A.extendDeep([],S.edgepaths),paths:A.extendDeep([],S.paths),starts:A.extendDeep([],S.starts)})}},{"../../lib":515}],753:[function(d,ee,te){var A=d("../../lib"),g=d("../heatmap/xyz_defaults"),S=d("../scatter/period_defaults"),M=d("./constraint_defaults"),e=d("./contours_defaults"),a=d("./style_defaults"),n=d("../heatmap/label_defaults"),r=d("./attributes");ee.exports=function(c,s,i,x){function p(o,m){return A.coerce(c,s,r,o,m)}function v(o){return A.coerce2(c,s,r,o)}var f=g(c,s,p,x);if(!f){s.visible=!1;return}S(c,s,x,p),p("xhoverformat"),p("yhoverformat"),p("text"),p("hovertext"),p("hoverongaps"),p("hovertemplate");var y=p("contours.type")==="constraint";p("connectgaps",A.isArray1D(s.z)),y?M(c,s,p,x,i):(e(c,s,p,v),a(c,s,p,x)),s.contours&&s.contours.coloring==="heatmap"&&n(p,x)}},{"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/xyz_defaults":816,"../scatter/period_defaults":956,"./attributes":744,"./constraint_defaults":749,"./contours_defaults":751,"./style_defaults":765}],754:[function(d,ee,te){var A=d("../../lib"),g=d("./constraint_mapping"),S=d("./end_plus");ee.exports=function(e,a,n){for(var r=e.type==="constraint"?g[e._operation](e.value):e,t=r.size,c=[],s=S(r),i=n.trace._carpetTrace,x=i?{xaxis:i.aaxis,yaxis:i.baxis,x:n.a,y:n.b}:{xaxis:a.xaxis,yaxis:a.yaxis,x:n.x,y:n.y},p=r.start;p<s;p+=t)if(c.push(A.extendFlat({level:p,crossings:{},starts:[],edgepaths:[],paths:[],z:n.z,smoothing:n.trace.line.smoothing},x)),c.length>1e3){A.warn("Too many contours, clipping at 1000",e);break}return c}},{"../../lib":515,"./constraint_mapping":750,"./end_plus":755}],755:[function(d,ee,te){ee.exports=function(g){return g.end+g.size/1e6}},{}],756:[function(d,ee,te){var A=d("../../lib"),g=d("./constants");ee.exports=function(t,c,s){var i,x,p,v,f;for(c=c||.01,s=s||.01,p=0;p<t.length;p++){for(v=t[p],f=0;f<v.starts.length;f++)x=v.starts[f],e(v,x,"edge",c,s);for(i=0;Object.keys(v.crossings).length&&i<1e4;)i++,x=Object.keys(v.crossings)[0].split(",").map(Number),e(v,x,void 0,c,s);i===1e4&&A.log("Infinite loop in contour?")}};function S(r,t,c,s){return Math.abs(r[0]-t[0])<c&&Math.abs(r[1]-t[1])<s}function M(r,t){var c=r[2]-t[2],s=r[3]-t[3];return Math.sqrt(c*c+s*s)}function e(r,t,c,s,i){var x=t.join(","),p=r.crossings[x],v=a(p,c,t),f=[n(r,t,[-v[0],-v[1]])],y=r.z.length,o=r.z[0].length,m=t.slice(),l=v.slice(),w;for(w=0;w<1e4;w++){if(p>20?(p=g.CHOOSESADDLE[p][(v[0]||v[1])<0?0:1],r.crossings[x]=g.SADDLEREMAINDER[p]):delete r.crossings[x],v=g.NEWDELTA[p],!v){A.log("Found bad marching index:",p,t,r.level);break}f.push(n(r,t,v)),t[0]+=v[0],t[1]+=v[1],x=t.join(","),S(f[f.length-1],f[f.length-2],s,i)&&f.pop();var _=v[0]&&(t[0]<0||t[0]>o-2)||v[1]&&(t[1]<0||t[1]>y-2),h=t[0]===m[0]&&t[1]===m[1]&&v[0]===l[0]&&v[1]===l[1];if(h||c&&_)break;p=r.crossings[x]}w===1e4&&A.log("Infinite loop in contour?");var b=S(f[0],f[f.length-1],s,i),u=0,L=.2*r.smoothing,T=[],k=0,P,z,I,D,R,O,F,N,G,K,W;for(w=1;w<f.length;w++)F=M(f[w],f[w-1]),u+=F,T.push(F);var Y=u/T.length*L;function re(q){return f[q%f.length]}for(w=f.length-2;w>=k;w--)if(P=T[w],P<Y){for(I=0,z=w-1;z>=k&&P+T[z]<Y;z--)P+=T[z];if(b&&w===f.length-2)for(I=0;I<z&&P+T[I]<Y;I++)P+=T[I];R=w-z+I+1,O=Math.floor((w+z+I+2)/2),!b&&w===f.length-2?D=f[f.length-1]:!b&&z===-1?D=f[0]:R%2?D=re(O):D=[(re(O)[0]+re(O+1)[0])/2,(re(O)[1]+re(O+1)[1])/2],f.splice(z+1,w-z+1,D),w=z+1,I&&(k=I),b&&(w===f.length-2?f[I]=f[f.length-1]:w===0&&(f[f.length-1]=f[0]))}for(f.splice(0,k),w=0;w<f.length;w++)f[w].length=2;if(!(f.length<2))if(b)f.pop(),r.paths.push(f);else{c||A.log("Unclosed interior contour?",r.level,m.join(","),f.join("L"));var ue=!1;for(N=0;N<r.edgepaths.length;N++)if(K=r.edgepaths[N],!ue&&S(K[0],f[f.length-1],s,i)){f.pop(),ue=!0;var j=!1;for(G=0;G<r.edgepaths.length;G++)if(W=r.edgepaths[G],S(W[W.length-1],f[0],s,i)){j=!0,f.shift(),r.edgepaths.splice(N,1),G===N?r.paths.push(f.concat(W)):(G>N&&G--,r.edgepaths[G]=W.concat(f,K));break}j||(r.edgepaths[N]=f.concat(K))}for(N=0;N<r.edgepaths.length&&!ue;N++)K=r.edgepaths[N],S(K[K.length-1],f[0],s,i)&&(f.shift(),r.edgepaths[N]=K.concat(f),ue=!0);ue||r.edgepaths.push(f)}}function a(r,t,c){var s=0,i=0;return r>20&&t?r===208||r===1114?s=c[0]===0?1:-1:i=c[1]===0?1:-1:g.BOTTOMSTART.indexOf(r)!==-1?i=1:g.LEFTSTART.indexOf(r)!==-1?s=1:g.TOPSTART.indexOf(r)!==-1?i=-1:s=-1,[s,i]}function n(r,t,c){var s=t[0]+Math.max(c[0],0),i=t[1]+Math.max(c[1],0),x=r.z[i][s],p=r.xaxis,v=r.yaxis;if(c[1]){var f=(r.level-x)/(r.z[i][s+1]-x),y=(f!==1?(1-f)*p.c2l(r.x[s]):0)+(f!==0?f*p.c2l(r.x[s+1]):0);return[p.c2p(p.l2c(y),!0),v.c2p(r.y[i],!0),s+f,i]}else{var o=(r.level-x)/(r.z[i+1][s]-x),m=(o!==1?(1-o)*v.c2l(r.y[i]):0)+(o!==0?o*v.c2l(r.y[i+1]):0);return[p.c2p(r.x[s],!0),v.c2p(v.l2c(m),!0),s,i+o]}}},{"../../lib":515,"./constants":748}],757:[function(d,ee,te){var A=d("../../components/color"),g=d("../heatmap/hover");ee.exports=function(M,e,a,n,r){r||(r={}),r.isContour=!0;var t=g(M,e,a,n,r);return t&&t.forEach(function(c){var s=c.trace;s.contours.type==="constraint"&&(s.fillcolor&&A.opacity(s.fillcolor)?c.color=A.addOpacity(s.fillcolor,1):s.contours.showlines&&A.opacity(s.line.color)&&(c.color=A.addOpacity(s.line.color,1)))}),t}},{"../../components/color":367,"../heatmap/hover":808}],758:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot").plot,style:d("./style"),colorbar:d("./colorbar"),hoverPoints:d("./hover"),moduleType:"trace",name:"contour",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":744,"./calc":745,"./colorbar":747,"./defaults":753,"./hover":757,"./plot":762,"./style":764}],759:[function(d,ee,te){var A=d("../../lib");ee.exports=function(S,M,e,a){a||(a={});var n=S("contours.showlabels");if(n){var r=M.font;A.coerceFont(S,"contours.labelfont",{family:r.family,size:r.size,color:e}),S("contours.labelformat")}a.hasHover!==!1&&S("zhoverformat")}},{"../../lib":515}],760:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/colorscale"),S=d("./end_plus");ee.exports=function(e){var a=e.contours,n=a.start,r=S(a),t=a.size||1,c=Math.floor((r-n)/t)+1,s=a.coloring==="lines"?0:1,i=g.extractOpts(e);isFinite(t)||(t=1,c=1);var x=i.reversescale?g.flipScale(i.colorscale):i.colorscale,p=x.length,v=new Array(p),f=new Array(p),y,o;if(a.coloring==="heatmap"){var m=i.min,l=i.max;for(o=0;o<p;o++)y=x[o],v[o]=y[0]*(l-m)+m,f[o]=y[1];var w=A.extent([m,l,a.start,a.start+t*(c-1)]),_=w[m<l?0:1],h=w[m<l?1:0];_!==m&&(v.splice(0,0,_),f.splice(0,0,f[0])),h!==l&&(v.push(h),f.push(f[f.length-1]))}else for(o=0;o<p;o++)y=x[o],v[o]=(y[0]*(c+s-1)-s/2)*t+n,f[o]=y[1];return g.makeColorScaleFunc({domain:v,range:f},{noNumericCheck:!0})}},{"../../components/colorscale":379,"./end_plus":755,"@plotly/d3":58}],761:[function(d,ee,te){var A=d("./constants");ee.exports=function(M){var e=M[0].z,a=e.length,n=e[0].length,r=a===2||n===2,t,c,s,i,x,p,v,f,y;for(c=0;c<a-1;c++)for(i=[],c===0&&(i=i.concat(A.BOTTOMSTART)),c===a-2&&(i=i.concat(A.TOPSTART)),t=0;t<n-1;t++)for(s=i.slice(),t===0&&(s=s.concat(A.LEFTSTART)),t===n-2&&(s=s.concat(A.RIGHTSTART)),x=t+","+c,p=[[e[c][t],e[c][t+1]],[e[c+1][t],e[c+1][t+1]]],y=0;y<M.length;y++)f=M[y],v=g(f.level,p),v&&(f.crossings[x]=v,s.indexOf(v)!==-1&&(f.starts.push([t,c]),r&&s.indexOf(v,s.indexOf(v)+1)!==-1&&f.starts.push([t,c])))};function g(S,M){var e=(M[0][0]>S?0:1)+(M[0][1]>S?0:2)+(M[1][1]>S?0:4)+(M[1][0]>S?0:8);if(e===5||e===10){var a=(M[0][0]+M[0][1]+M[1][0]+M[1][1])/4;return S>a?e===5?713:1114:e===5?104:208}return e===15?0:e}},{"./constants":748}],762:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=d("../../components/drawing"),M=d("../../components/colorscale"),e=d("../../lib/svg_text_utils"),a=d("../../plots/cartesian/axes"),n=d("../../plots/cartesian/set_convert"),r=d("../heatmap/plot"),t=d("./make_crossings"),c=d("./find_all_paths"),s=d("./empty_pathinfo"),i=d("./convert_to_constraints"),x=d("./close_boundaries"),p=d("./constants"),v=p.LABELOPTIMIZER;te.plot=function(b,u,L,T){var k=u.xaxis,P=u.yaxis;g.makeTraceGroups(T,L,"contour").each(function(z){var I=A.select(this),D=z[0],R=D.trace,O=D.x,F=D.y,N=R.contours,G=s(N,u,D),K=g.ensureSingle(I,"g","heatmapcoloring"),W=[];N.coloring==="heatmap"&&(W=[z]),r(b,u,W,K),t(G),c(G);var Y=k.c2p(O[0],!0),re=k.c2p(O[O.length-1],!0),ue=P.c2p(F[0],!0),j=P.c2p(F[F.length-1],!0),q=[[Y,j],[re,j],[re,ue],[Y,ue]],V=G;N.type==="constraint"&&(V=i(G,N._operation)),f(I,q,N),y(I,V,q,N),m(I,G,b,D,N),w(I,u,b,D,q)})};function f(h,b,u){var L=g.ensureSingle(h,"g","contourbg"),T=L.selectAll("path").data(u.coloring==="fill"?[0]:[]);T.enter().append("path"),T.exit().remove(),T.attr("d","M"+b.join("L")+"Z").style("stroke","none")}function y(h,b,u,L){var T=L.coloring==="fill"||L.type==="constraint"&&L._operation!=="=",k="M"+u.join("L")+"Z";T&&x(b,L);var P=g.ensureSingle(h,"g","contourfill"),z=P.selectAll("path").data(T?b:[]);z.enter().append("path"),z.exit().remove(),z.each(function(I){var D=(I.prefixBoundary?k:"")+o(I,u);D?A.select(this).attr("d",D).style("stroke","none"):A.select(this).remove()})}function o(h,b){var u="",L=0,T=h.edgepaths.map(function(Y,re){return re}),k=!0,P,z,I,D,R,O;function F(Y){return Math.abs(Y[1]-b[0][1])<.01}function N(Y){return Math.abs(Y[1]-b[2][1])<.01}function G(Y){return Math.abs(Y[0]-b[0][0])<.01}function K(Y){return Math.abs(Y[0]-b[2][0])<.01}for(;T.length;){for(O=S.smoothopen(h.edgepaths[L],h.smoothing),u+=k?O:O.replace(/^M/,"L"),T.splice(T.indexOf(L),1),P=h.edgepaths[L][h.edgepaths[L].length-1],D=-1,I=0;I<4;I++){if(!P){g.log("Missing end?",L,h);break}for(F(P)&&!K(P)?z=b[1]:G(P)?z=b[0]:N(P)?z=b[3]:K(P)&&(z=b[2]),R=0;R<h.edgepaths.length;R++){var W=h.edgepaths[R][0];Math.abs(P[0]-z[0])<.01?Math.abs(P[0]-W[0])<.01&&(W[1]-P[1])*(z[1]-W[1])>=0&&(z=W,D=R):Math.abs(P[1]-z[1])<.01?Math.abs(P[1]-W[1])<.01&&(W[0]-P[0])*(z[0]-W[0])>=0&&(z=W,D=R):g.log("endpt to newendpt is not vert. or horz.",P,z,W)}if(P=z,D>=0)break;u+="L"+z}if(D===h.edgepaths.length){g.log("unclosed perimeter path");break}L=D,k=T.indexOf(L)===-1,k&&(L=T[0],u+="Z")}for(L=0;L<h.paths.length;L++)u+=S.smoothclosed(h.paths[L],h.smoothing);return u}function m(h,b,u,L,T){var k=g.ensureSingle(h,"g","contourlines"),P=T.showlines!==!1,z=T.showlabels,I=P&&z,D=te.createLines(k,P||z,b),R=te.createLineClip(k,I,u,L.trace.uid),O=h.selectAll("g.contourlabels").data(z?[0]:[]);if(O.exit().remove(),O.enter().append("g").classed("contourlabels",!0),z){var F=[],N=[];g.clearLocationCache();var G=te.labelFormatter(u,L),K=S.tester.append("text").attr("data-notex",1).call(S.font,T.labelfont),W=b[0].xaxis,Y=b[0].yaxis,re=W._length,ue=Y._length,j=W.range,q=Y.range,V=g.aggNums(Math.min,null,L.x),U=g.aggNums(Math.max,null,L.x),$=g.aggNums(Math.min,null,L.y),ne=g.aggNums(Math.max,null,L.y),X=Math.max(W.c2p(V,!0),0),Q=Math.min(W.c2p(U,!0),re),ie=Math.max(Y.c2p(ne,!0),0),se=Math.min(Y.c2p($,!0),ue),ae={};j[0]<j[1]?(ae.left=X,ae.right=Q):(ae.left=Q,ae.right=X),q[0]<q[1]?(ae.top=ie,ae.bottom=se):(ae.top=se,ae.bottom=ie),ae.middle=(ae.top+ae.bottom)/2,ae.center=(ae.left+ae.right)/2,F.push([[ae.left,ae.top],[ae.right,ae.top],[ae.right,ae.bottom],[ae.left,ae.bottom]]);var oe=Math.sqrt(re*re+ue*ue),be=p.LABELDISTANCE*oe/Math.max(1,b.length/p.LABELINCREASE);D.each(function(ce){var de=te.calcTextOpts(ce.level,G,K,u);A.select(this).selectAll("path").each(function(){var ye=this,ge=g.getVisibleSegment(ye,ae,de.height/2);if(!!ge&&!(ge.len<(de.width+de.height)*p.LABELMIN))for(var me=Math.min(Math.ceil(ge.len/be),p.LABELMAX),Ee=0;Ee<me;Ee++){var Pe=te.findBestTextLocation(ye,ge,de,N,ae);if(!Pe)break;te.addLabelData(Pe,de,N,F)}})}),K.remove(),te.drawLabels(O,N,u,R,I?F:null)}z&&!P&&D.remove()}te.createLines=function(h,b,u){var L=u[0].smoothing,T=h.selectAll("g.contourlevel").data(b?u:[]);if(T.exit().remove(),T.enter().append("g").classed("contourlevel",!0),b){var k=T.selectAll("path.openline").data(function(z){return z.pedgepaths||z.edgepaths});k.exit().remove(),k.enter().append("path").classed("openline",!0),k.attr("d",function(z){return S.smoothopen(z,L)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var P=T.selectAll("path.closedline").data(function(z){return z.ppaths||z.paths});P.exit().remove(),P.enter().append("path").classed("closedline",!0),P.attr("d",function(z){return S.smoothclosed(z,L)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return T},te.createLineClip=function(h,b,u,L){var T=u._fullLayout._clips,k=b?"clipline"+L:null,P=T.selectAll("#"+k).data(b?[0]:[]);return P.exit().remove(),P.enter().append("clipPath").classed("contourlineclip",!0).attr("id",k),S.setClipUrl(h,k,u),P},te.labelFormatter=function(h,b){var u=h._fullLayout,L=b.trace,T=L.contours,k={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(T.labelformat)k.tickformat=T.labelformat,n(k,u);else{var P=M.extractOpts(L);if(P&&P.colorbar&&P.colorbar._axis)k=P.colorbar._axis;else{if(T.type==="constraint"){var z=T.value;Array.isArray(z)?k.range=[z[0],z[z.length-1]]:k.range=[z,z]}else k.range=[T.start,T.end],k.nticks=(T.end-T.start)/T.size;k.range[0]===k.range[1]&&(k.range[1]+=k.range[0]||1),k.nticks||(k.nticks=1e3),n(k,u),a.prepTicks(k),k._tmin=null,k._tmax=null}}return function(I){return a.tickText(k,I).text}},te.calcTextOpts=function(h,b,u,L){var T=b(h);u.text(T).call(e.convertToTspans,L);var k=u.node(),P=S.bBox(k,!0);return{text:T,width:P.width,height:P.height,fontSize:+k.style["font-size"].replace("px",""),level:h,dy:(P.top+P.bottom)/2}},te.findBestTextLocation=function(h,b,u,L,T){var k=u.width,P,z,I,D,R;b.isClosed?(z=b.len/v.INITIALSEARCHPOINTS,P=b.min+z/2,I=b.max):(z=(b.len-k)/(v.INITIALSEARCHPOINTS+1),P=b.min+z+k/2,I=b.max-(z+k)/2);for(var O=1/0,F=0;F<v.ITERATIONS;F++){for(var N=P;N<I;N+=z){var G=g.getTextLocation(h,b.total,N,k),K=l(G,u,L,T);K<O&&(O=K,R=G,D=N)}if(O>v.MAXCOST*2)break;F&&(z/=2),P=D-z/2,I=P+z*1.5}if(O<=v.MAXCOST)return R};function l(h,b,u,L){var T=b.width/2,k=b.height/2,P=h.x,z=h.y,I=h.theta,D=Math.cos(I)*T,R=Math.sin(I)*T,O=(P>L.center?L.right-P:P-L.left)/(D+Math.abs(Math.sin(I)*k)),F=(z>L.middle?L.bottom-z:z-L.top)/(Math.abs(R)+Math.cos(I)*k);if(O<1||F<1)return 1/0;var N=v.EDGECOST*(1/(O-1)+1/(F-1));N+=v.ANGLECOST*I*I;for(var G=P-D,K=z-R,W=P+D,Y=z+R,re=0;re<u.length;re++){var ue=u[re],j=Math.cos(ue.theta)*ue.width/2,q=Math.sin(ue.theta)*ue.width/2,V=g.segmentDistance(G,K,W,Y,ue.x-j,ue.y-q,ue.x+j,ue.y+q)*2/(b.height+ue.height),U=ue.level===b.level,$=U?v.SAMELEVELDISTANCE:1;if(V<=$)return 1/0;var ne=v.NEIGHBORCOST*(U?v.SAMELEVELFACTOR:1);N+=ne/(V-$)}return N}te.addLabelData=function(h,b,u,L){var T=b.fontSize,k=b.width+T/3,P=Math.max(0,b.height-T/3),z=h.x,I=h.y,D=h.theta,R=Math.sin(D),O=Math.cos(D),F=function(G,K){return[z+G*O-K*R,I+G*R+K*O]},N=[F(-k/2,-P/2),F(-k/2,P/2),F(k/2,P/2),F(k/2,-P/2)];u.push({text:b.text,x:z,y:I,dy:b.dy,theta:D,level:b.level,width:k,height:P}),L.push(N)},te.drawLabels=function(h,b,u,L,T){var k=h.selectAll("text").data(b,function(D){return D.text+","+D.x+","+D.y+","+D.theta});if(k.exit().remove(),k.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(D){var R=D.x+Math.sin(D.theta)*D.dy,O=D.y-Math.cos(D.theta)*D.dy;A.select(this).text(D.text).attr({x:R,y:O,transform:"rotate("+180*D.theta/Math.PI+" "+R+" "+O+")"}).call(e.convertToTspans,u)}),T){for(var P="",z=0;z<T.length;z++)P+="M"+T[z].join("L")+"Z";var I=g.ensureSingle(L,"path","");I.attr("d",P)}};function w(h,b,u,L,T){var k=L.trace,P=u._fullLayout._clips,z="clip"+k.uid,I=P.selectAll("#"+z).data(k.connectgaps?[]:[0]);if(I.enter().append("clipPath").classed("contourclip",!0).attr("id",z),I.exit().remove(),k.connectgaps===!1){var D={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:b.xaxis,yaxis:b.yaxis,x:L.x,y:L.y,z:_(L),smoothing:0};t([D]),c([D]),x([D],{type:"levels"});var R=g.ensureSingle(I,"path","");R.attr("d",(D.prefixBoundary?"M"+T.join("L")+"Z":"")+o(D,T))}else z=null;S.setClipUrl(h,z,u)}function _(h){var b=h.trace._emptypoints,u=[],L=h.z.length,T=h.z[0].length,k,P=[],z;for(k=0;k<T;k++)P.push(1);for(k=0;k<L;k++)u.push(P.slice());for(k=0;k<b.length;k++)z=b[k],u[z[0]][z[1]]=0;return h.zmask=u,u}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/set_convert":585,"../heatmap/plot":813,"./close_boundaries":746,"./constants":748,"./convert_to_constraints":752,"./empty_pathinfo":754,"./find_all_paths":756,"./make_crossings":761,"@plotly/d3":58}],763:[function(d,ee,te){var A=d("../../plots/cartesian/axes"),g=d("../../lib");ee.exports=function(e,a){var n=e.contours;if(e.autocontour){var r=e.zmin,t=e.zmax;(e.zauto||r===void 0)&&(r=g.aggNums(Math.min,null,a)),(e.zauto||t===void 0)&&(t=g.aggNums(Math.max,null,a));var c=S(r,t,e.ncontours);n.size=c.dtick,n.start=A.tickFirst(c),c.range.reverse(),n.end=A.tickFirst(c),n.start===r&&(n.start+=n.size),n.end===t&&(n.end-=n.size),n.start>n.end&&(n.start=n.end=(n.start+n.end)/2),e._input.contours||(e._input.contours={}),g.extendFlat(e._input.contours,{start:n.start,end:n.end,size:n.size}),e._input.autocontour=!0}else if(n.type!=="constraint"){var s=n.start,i=n.end,x=e._input.contours;if(s>i&&(n.start=x.start=i,i=n.end=x.end=s,s=n.start),!(n.size>0)){var p;s===i?p=1:p=S(s,i,e.ncontours).dtick,x.size=n.size=p}}};function S(M,e,a){var n={type:"linear",range:[M,e]};return A.autoTicks(n,(e-M)/(a||15)),n}},{"../../lib":515,"../../plots/cartesian/axes":566}],764:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/drawing"),S=d("../heatmap/style"),M=d("./make_color_map");ee.exports=function(a){var n=A.select(a).selectAll("g.contour");n.style("opacity",function(r){return r[0].trace.opacity}),n.each(function(r){var t=A.select(this),c=r[0].trace,s=c.contours,i=c.line,x=s.size||1,p=s.start,v=s.type==="constraint",f=!v&&s.coloring==="lines",y=!v&&s.coloring==="fill",o=f||y?M(c):null;t.selectAll("g.contourlevel").each(function(w){A.select(this).selectAll("path").call(g.lineGroupStyle,i.width,f?o(w.level):i.color,i.dash)});var m=s.labelfont;if(t.selectAll("g.contourlabels text").each(function(w){g.font(A.select(this),{family:m.family,size:m.size,color:m.color||(f?o(w.level):i.color)})}),v)t.selectAll("g.contourfill path").style("fill",c.fillcolor);else if(y){var l;t.selectAll("g.contourfill path").style("fill",function(w){return l===void 0&&(l=w.level),o(w.level+.5*x)}),l===void 0&&(l=p),t.selectAll("g.contourbg path").style("fill",o(l-.5*x))}}),S(a)}},{"../../components/drawing":389,"../heatmap/style":814,"./make_color_map":760,"@plotly/d3":58}],765:[function(d,ee,te){var A=d("../../components/colorscale/defaults"),g=d("./label_defaults");ee.exports=function(M,e,a,n,r){var t=a("contours.coloring"),c,s="";t==="fill"&&(c=a("contours.showlines")),c!==!1&&(t!=="lines"&&(s=a("line.color","#000")),a("line.width",.5),a("line.dash")),t!=="none"&&(M.showlegend!==!0&&(e.showlegend=!1),e._dfltShowLegend=!1,A(M,e,n,a,{prefix:"",cLetter:"z"})),a("line.smoothing"),g(a,n,s,r)}},{"../../components/colorscale/defaults":377,"./label_defaults":759}],766:[function(d,ee,te){var A=d("../heatmap/attributes"),g=d("../contour/attributes"),S=d("../../components/colorscale/attributes"),M=d("../../lib/extend").extendFlat,e=g.contours;ee.exports=M({carpet:{valType:"string",editType:"calc"},z:A.z,a:A.x,a0:A.x0,da:A.dx,b:A.y,b0:A.y0,db:A.dy,text:A.text,hovertext:A.hovertext,transpose:A.transpose,atype:A.xtype,btype:A.ytype,fillcolor:g.fillcolor,autocontour:g.autocontour,ncontours:g.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:g.line.color,width:g.line.width,dash:g.line.dash,smoothing:g.line.smoothing,editType:"plot"},transforms:void 0},S("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../contour/attributes":744,"../heatmap/attributes":801}],767:[function(d,ee,te){var A=d("../../components/colorscale/calc"),g=d("../../lib"),S=d("../heatmap/convert_column_xyz"),M=d("../heatmap/clean_2d_array"),e=d("../heatmap/interp2d"),a=d("../heatmap/find_empties"),n=d("../heatmap/make_bound_array"),r=d("./defaults"),t=d("../carpet/lookup_carpetid"),c=d("../contour/set_contours");ee.exports=function(x,p){var v=p._carpetTrace=t(x,p);if(!(!v||!v.visible||v.visible==="legendonly")){if(!p.a||!p.b){var f=x.data[v.index],y=x.data[p.index];y.a||(y.a=f.a),y.b||(y.b=f.b),r(y,p,p._defaultColor,x._fullLayout)}var o=s(x,p);return c(p,p._z),o}};function s(i,x){var p=x._carpetTrace,v=p.aaxis,f=p.baxis,y,o,m,l,w,_,h;v._minDtick=0,f._minDtick=0,g.isArray1D(x.z)&&S(x,v,f,"a","b",["z"]),y=x._a=x._a||x.a,l=x._b=x._b||x.b,y=y?v.makeCalcdata(x,"_a"):[],l=l?f.makeCalcdata(x,"_b"):[],o=x.a0||0,m=x.da||1,w=x.b0||0,_=x.db||1,h=x._z=M(x._z||x.z,x.transpose),x._emptypoints=a(h),e(h,x._emptypoints);var b=g.maxRowLength(h),u=x.xtype==="scaled"?"":y,L=n(x,u,o,m,b,v),T=x.ytype==="scaled"?"":l,k=n(x,T,w,_,h.length,f),P={a:L,b:k,z:h};return x.contours.type==="levels"&&x.contours.coloring!=="none"&&A(i,x,{vals:h,containerStr:"",cLetter:"z"}),[P]}},{"../../components/colorscale/calc":375,"../../lib":515,"../carpet/lookup_carpetid":717,"../contour/set_contours":763,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"../heatmap/find_empties":807,"../heatmap/interp2d":810,"../heatmap/make_bound_array":812,"./defaults":768}],768:[function(d,ee,te){var A=d("../../lib"),g=d("../heatmap/xyz_defaults"),S=d("./attributes"),M=d("../contour/constraint_defaults"),e=d("../contour/contours_defaults"),a=d("../contour/style_defaults");ee.exports=function(r,t,c,s){function i(f,y){return A.coerce(r,t,S,f,y)}function x(f){return A.coerce2(r,t,S,f)}if(i("carpet"),r.a&&r.b){var p=g(r,t,i,s,"a","b");if(!p){t.visible=!1;return}i("text");var v=i("contours.type")==="constraint";v?M(r,t,i,s,c,{hasHover:!1}):(e(r,t,i,x),a(r,t,i,s,{hasHover:!1}))}else t._defaultColor=c,t._length=null}},{"../../lib":515,"../contour/constraint_defaults":749,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/xyz_defaults":816,"./attributes":766}],769:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../contour/colorbar"),calc:d("./calc"),plot:d("./plot"),style:d("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"../contour/colorbar":747,"../contour/style":764,"./attributes":766,"./calc":767,"./defaults":768,"./plot":770}],770:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../carpet/map_1d_array"),S=d("../carpet/makepath"),M=d("../../components/drawing"),e=d("../../lib"),a=d("../contour/make_crossings"),n=d("../contour/find_all_paths"),r=d("../contour/plot"),t=d("../contour/constants"),c=d("../contour/convert_to_constraints"),s=d("../contour/empty_pathinfo"),i=d("../contour/close_boundaries"),x=d("../carpet/lookup_carpetid"),p=d("../carpet/axis_aligned_line");ee.exports=function(u,L,T,k){var P=L.xaxis,z=L.yaxis;e.makeTraceGroups(k,T,"contour").each(function(I){var D=A.select(this),R=I[0],O=R.trace,F=O._carpetTrace=x(u,O),N=u.calcdata[F.index][0];if(!F.visible||F.visible==="legendonly")return;var G=R.a,K=R.b,W=O.contours,Y=s(W,L,R),re=W.type==="constraint",ue=W._operation,j=re?ue==="="?"lines":"fill":W.coloring;function q(be){var ce=F.ab2xy(be[0],be[1],!0);return[P.c2p(ce[0]),z.c2p(ce[1])]}var V=[[G[0],K[K.length-1]],[G[G.length-1],K[K.length-1]],[G[G.length-1],K[0]],[G[0],K[0]]];a(Y);var U=(G[G.length-1]-G[0])*1e-8,$=(K[K.length-1]-K[0])*1e-8;n(Y,U,$);var ne=Y;W.type==="constraint"&&(ne=c(Y,ue)),v(Y,q);var X,Q,ie,se,ae=[];for(se=N.clipsegments.length-1;se>=0;se--)X=N.clipsegments[se],Q=g([],X.x,P.c2p),ie=g([],X.y,z.c2p),Q.reverse(),ie.reverse(),ae.push(S(Q,ie,X.bicubic));var oe="M"+ae.join("L")+"Z";w(D,N.clipsegments,P,z,re,j),_(O,D,P,z,ne,V,q,F,N,j,oe),f(D,Y,u,R,W,L,F),M.setClipUrl(D,F._clipPathId,u)})};function v(b,u){var L,T,k,P,z,I,D,R,O;for(L=0;L<b.length;L++){for(P=b[L],z=P.pedgepaths=[],I=P.ppaths=[],T=0;T<P.edgepaths.length;T++){for(O=P.edgepaths[T],D=[],k=0;k<O.length;k++)D[k]=u(O[k]);z.push(D)}for(T=0;T<P.paths.length;T++){for(O=P.paths[T],R=[],k=0;k<O.length;k++)R[k]=u(O[k]);I.push(R)}}}function f(b,u,L,T,k,P,z){var I=e.ensureSingle(b,"g","contourlines"),D=k.showlines!==!1,R=k.showlabels,O=D&&R,F=r.createLines(I,D||R,u),N=r.createLineClip(I,O,L,T.trace.uid),G=b.selectAll("g.contourlabels").data(R?[0]:[]);if(G.exit().remove(),G.enter().append("g").classed("contourlabels",!0),R){var K=P.xaxis,W=P.yaxis,Y=K._length,re=W._length,ue=[[[0,0],[Y,0],[Y,re],[0,re]]],j=[];e.clearLocationCache();var q=r.labelFormatter(L,T),V=M.tester.append("text").attr("data-notex",1).call(M.font,k.labelfont),U={left:0,right:Y,center:Y/2,top:0,bottom:re,middle:re/2},$=Math.sqrt(Y*Y+re*re),ne=t.LABELDISTANCE*$/Math.max(1,u.length/t.LABELINCREASE);F.each(function(X){var Q=r.calcTextOpts(X.level,q,V,L);A.select(this).selectAll("path").each(function(ie){var se=this,ae=e.getVisibleSegment(se,U,Q.height/2);if(!!ae&&(y(se,ie,X,ae,z,Q.height),!(ae.len<(Q.width+Q.height)*t.LABELMIN)))for(var oe=Math.min(Math.ceil(ae.len/ne),t.LABELMAX),be=0;be<oe;be++){var ce=r.findBestTextLocation(se,ae,Q,j,U);if(!ce)break;r.addLabelData(ce,Q,j,ue)}})}),V.remove(),r.drawLabels(G,j,L,N,O?ue:null)}R&&!D&&F.remove()}function y(b,u,L,T,k,P){for(var z,I=0;I<L.pedgepaths.length;I++)u===L.pedgepaths[I]&&(z=L.edgepaths[I]);if(!z)return;var D=k.a[0],R=k.a[k.a.length-1],O=k.b[0],F=k.b[k.b.length-1];function N(re,ue){var j=0,q,V=.1;return(Math.abs(re[0]-D)<V||Math.abs(re[0]-R)<V)&&(q=m(k.dxydb_rough(re[0],re[1],V)),j=Math.max(j,P*l(ue,q)/2)),(Math.abs(re[1]-O)<V||Math.abs(re[1]-F)<V)&&(q=m(k.dxyda_rough(re[0],re[1],V)),j=Math.max(j,P*l(ue,q)/2)),j}var G=o(b,0,1),K=o(b,T.total,T.total-1),W=N(z[0],G),Y=T.total-N(z[z.length-1],K);T.min<W&&(T.min=W),T.max>Y&&(T.max=Y),T.len=T.max-T.min}function o(b,u,L){var T=b.getPointAtLength(u),k=b.getPointAtLength(L),P=k.x-T.x,z=k.y-T.y,I=Math.sqrt(P*P+z*z);return[P/I,z/I]}function m(b){var u=Math.sqrt(b[0]*b[0]+b[1]*b[1]);return[b[0]/u,b[1]/u]}function l(b,u){var L=Math.abs(b[0]*u[0]+b[1]*u[1]),T=Math.sqrt(1-L*L);return T/L}function w(b,u,L,T,k,P){var z,I,D,R,O=e.ensureSingle(b,"g","contourbg"),F=O.selectAll("path").data(P==="fill"&&!k?[0]:[]);F.enter().append("path"),F.exit().remove();var N=[];for(R=0;R<u.length;R++)z=u[R],I=g([],z.x,L.c2p),D=g([],z.y,T.c2p),N.push(S(I,D,z.bicubic));F.attr("d","M"+N.join("L")+"Z").style("stroke","none")}function _(b,u,L,T,k,P,z,I,D,R,O){var F=R==="fill";F&&i(k,b.contours);var N=e.ensureSingle(u,"g","contourfill"),G=N.selectAll("path").data(F?k:[]);G.enter().append("path"),G.exit().remove(),G.each(function(K){var W=(K.prefixBoundary?O:"")+h(b,K,P,z,I,D,L,T);W?A.select(this).attr("d",W).style("stroke","none"):A.select(this).remove()})}function h(b,u,L,T,k,P,z,I){var D,R="",O=u.edgepaths.map(function(ie,se){return se}),F=!0,N,G,K,W,Y,re,ue=Math.abs(L[0][0]-L[2][0])*1e-4,j=Math.abs(L[0][1]-L[2][1])*1e-4;function q(ie){return Math.abs(ie[1]-L[0][1])<j}function V(ie){return Math.abs(ie[1]-L[2][1])<j}function U(ie){return Math.abs(ie[0]-L[0][0])<ue}function $(ie){return Math.abs(ie[0]-L[2][0])<ue}function ne(ie,se){var ae,oe,be,ce,de="";for(q(ie)&&!$(ie)||V(ie)&&!U(ie)?(ce=k.aaxis,be=p(k,P,[ie[0],se[0]],.5*(ie[1]+se[1]))):(ce=k.baxis,be=p(k,P,.5*(ie[0]+se[0]),[ie[1],se[1]])),ae=1;ae<be.length;ae++)for(de+=ce.smoothing?"C":"L",oe=0;oe<be[ae].length;oe++){var ye=be[ae][oe];de+=[z.c2p(ye[0]),I.c2p(ye[1])]+" "}return de}for(D=0,N=null;O.length;){var X=u.edgepaths[D][0];for(N&&(R+=ne(N,X)),re=M.smoothopen(u.edgepaths[D].map(T),u.smoothing),R+=F?re:re.replace(/^M/,"L"),O.splice(O.indexOf(D),1),N=u.edgepaths[D][u.edgepaths[D].length-1],W=-1,K=0;K<4;K++){if(!N){e.log("Missing end?",D,u);break}for(q(N)&&!$(N)?G=L[1]:U(N)?G=L[0]:V(N)?G=L[3]:$(N)&&(G=L[2]),Y=0;Y<u.edgepaths.length;Y++){var Q=u.edgepaths[Y][0];Math.abs(N[0]-G[0])<ue?Math.abs(N[0]-Q[0])<ue&&(Q[1]-N[1])*(G[1]-Q[1])>=0&&(G=Q,W=Y):Math.abs(N[1]-G[1])<j?Math.abs(N[1]-Q[1])<j&&(Q[0]-N[0])*(G[0]-Q[0])>=0&&(G=Q,W=Y):e.log("endpt to newendpt is not vert. or horz.",N,G,Q)}if(W>=0)break;R+=ne(N,G),N=G}if(W===u.edgepaths.length){e.log("unclosed perimeter path");break}D=W,F=O.indexOf(D)===-1,F&&(D=O[0],R+=ne(N,G)+"Z",N=null)}for(D=0;D<u.paths.length;D++)R+=M.smoothclosed(u.paths[D].map(T),u.smoothing);return R}},{"../../components/drawing":389,"../../lib":515,"../carpet/axis_aligned_line":701,"../carpet/lookup_carpetid":717,"../carpet/makepath":718,"../carpet/map_1d_array":719,"../contour/close_boundaries":746,"../contour/constants":748,"../contour/convert_to_constraints":752,"../contour/empty_pathinfo":754,"../contour/find_all_paths":756,"../contour/make_crossings":761,"../contour/plot":762,"@plotly/d3":58}],771:[function(d,ee,te){var A=d("../../components/colorscale/attributes"),g=d("../../plots/template_attributes").hovertemplateAttrs,S=d("../../plots/attributes"),M=d("../scattermapbox/attributes"),e=d("../../lib/extend").extendFlat;ee.exports=e({lon:M.lon,lat:M.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:M.text,hovertext:M.hovertext,hoverinfo:e({},S.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:g(),showlegend:e({},S.showlegend,{dflt:!1})},A("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattermapbox/attributes":1002}],772:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib").isArrayOrTypedArray,S=d("../../constants/numerical").BADNUM,M=d("../../components/colorscale/calc"),e=d("../../lib")._;ee.exports=function(n,r){for(var t=r._length,c=new Array(t),s=r.z,i=g(s)&&s.length,x=0;x<t;x++){var p=c[x]={},v=r.lon[x],f=r.lat[x];if(p.lonlat=A(v)&&A(f)?[+v,+f]:[S,S],i){var y=s[x];p.z=A(y)?y:S}}return M(n,r,{vals:i?s:[0,1],containerStr:"",cLetter:"z"}),t&&(c[0].t={labels:{lat:e(n,"lat:")+" ",lon:e(n,"lon:")+" "}}),c}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],773:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib"),S=d("../../components/color"),M=d("../../components/colorscale"),e=d("../../constants/numerical").BADNUM,a=d("../../lib/geojson_utils").makeBlank;ee.exports=function(r){var t=r[0].trace,c=t.visible===!0&&t._length!==0,s={layout:{visibility:"none"},paint:{}},i=t._opts={heatmap:s,geojson:a()};if(!c)return i;var x=[],p,v=t.z,f=t.radius,y=g.isArrayOrTypedArray(v)&&v.length,o=g.isArrayOrTypedArray(f);for(p=0;p<r.length;p++){var m=r[p],l=m.lonlat;if(l[0]!==e){var w={};if(y){var _=m.z;w.z=_!==e?_:0}o&&(w.r=A(f[p])&&f[p]>0?+f[p]:0),x.push({type:"Feature",geometry:{type:"Point",coordinates:l},properties:w})}}var h=M.extractOpts(t),b=h.reversescale?M.flipScale(h.colorscale):h.colorscale,u=b[0][1],L=S.opacity(u)<1?u:S.addOpacity(u,0),T=["interpolate",["linear"],["heatmap-density"],0,L];for(p=1;p<b.length;p++)T.push(b[p][0],b[p][1]);var k=["interpolate",["linear"],["get","z"],h.min,0,h.max,1];return g.extendFlat(i.heatmap.paint,{"heatmap-weight":y?k:1/(h.max-h.min),"heatmap-color":T,"heatmap-radius":o?{type:"identity",property:"r"}:t.radius,"heatmap-opacity":t.opacity}),i.geojson={type:"FeatureCollection",features:x},i.heatmap.layout.visibility="visible",i}},{"../../components/color":367,"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"fast-isnumeric":190}],774:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/colorscale/defaults"),S=d("./attributes");ee.exports=function(e,a,n,r){function t(x,p){return A.coerce(e,a,S,x,p)}var c=t("lon")||[],s=t("lat")||[],i=Math.min(c.length,s.length);if(!i){a.visible=!1;return}a._length=i,t("z"),t("radius"),t("below"),t("text"),t("hovertext"),t("hovertemplate"),g(e,a,r,t,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":771}],775:[function(d,ee,te){ee.exports=function(g,S){return g.lon=S.lon,g.lat=S.lat,g.z=S.z,g}},{}],776:[function(d,ee,te){var A=d("../../plots/cartesian/axes"),g=d("../scattermapbox/hover").hoverPoints,S=d("../scattermapbox/hover").getExtraText;ee.exports=function(e,a,n){var r=g(e,a,n);if(!!r){var t=r[0],c=t.cd,s=c[0].trace,i=c[t.index];if(delete t.color,"z"in i){var x=t.subplot.mockAxis;t.z=i.z,t.zLabel=A.tickText(x,x.c2l(i.z),"hover").text}return t.extraText=S(s,i,c[0].t.labels),[t]}}},{"../../plots/cartesian/axes":566,"../scattermapbox/hover":1007}],777:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../heatmap/colorbar"),formatLabels:d("../scattermapbox/format_labels"),calc:d("./calc"),plot:d("./plot"),hoverPoints:d("./hover"),eventData:d("./event_data"),getBelow:function(A,g){for(var S=g.getMapLayers(),M=0;M<S.length;M++){var e=S[M],a=e.id;if(e.type==="symbol"&&typeof a=="string"&&a.indexOf("plotly-")===-1)return a}},moduleType:"trace",name:"densitymapbox",basePlotModule:d("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":622,"../heatmap/colorbar":804,"../scattermapbox/format_labels":1006,"./attributes":771,"./calc":772,"./defaults":774,"./event_data":775,"./hover":776,"./plot":778}],778:[function(d,ee,te){var A=d("./convert"),g=d("../../plots/mapbox/constants").traceLayerPrefix;function S(e,a){this.type="densitymapbox",this.subplot=e,this.uid=a,this.sourceId="source-"+a,this.layerList=[["heatmap",g+a+"-heatmap"]],this.below=null}var M=S.prototype;M.update=function(e){var a=this.subplot,n=this.layerList,r=A(e),t=a.belowLookup["trace-"+this.uid];a.map.getSource(this.sourceId).setData(r.geojson),t!==this.below&&(this._removeLayers(),this._addLayers(r,t),this.below=t);for(var c=0;c<n.length;c++){var s=n[c],i=s[0],x=s[1],p=r[i];a.setOptions(x,"setLayoutProperty",p.layout),p.layout.visibility==="visible"&&a.setOptions(x,"setPaintProperty",p.paint)}},M._addLayers=function(e,a){for(var n=this.subplot,r=this.layerList,t=this.sourceId,c=0;c<r.length;c++){var s=r[c],i=s[0],x=e[i];n.addLayer({type:i,id:s[1],source:t,layout:x.layout,paint:x.paint},a)}},M._removeLayers=function(){for(var e=this.subplot.map,a=this.layerList,n=a.length-1;n>=0;n--)e.removeLayer(a[n][1])},M.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},ee.exports=function(a,n){var r=n[0].trace,t=new S(a,r.uid),c=t.sourceId,s=A(n),i=t.below=a.belowLookup["trace-"+r.uid];return a.map.addSource(c,{type:"geojson",data:s.geojson}),t._addLayers(s,i),t}},{"../../plots/mapbox/constants":620,"./convert":773}],779:[function(d,ee,te){var A=d("../../lib");ee.exports=function(S,M){for(var e=0;e<S.length;e++)S[e].i=e;A.mergeArray(M.text,S,"tx"),A.mergeArray(M.hovertext,S,"htx");var a=M.marker;if(a){A.mergeArray(a.opacity,S,"mo"),A.mergeArray(a.color,S,"mc");var n=a.line;n&&(A.mergeArray(n.color,S,"mlc"),A.mergeArrayCastPositive(n.width,S,"mlw"))}}},{"../../lib":515}],780:[function(d,ee,te){var A=d("../bar/attributes"),g=d("../scatter/attributes").line,S=d("../../plots/attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/template_attributes").texttemplateAttrs,n=d("./constants"),r=d("../../lib/extend").extendFlat,t=d("../../components/color");ee.exports={x:A.x,x0:A.x0,dx:A.dx,y:A.y,y0:A.y0,dy:A.dy,xperiod:A.xperiod,yperiod:A.yperiod,xperiod0:A.xperiod0,yperiod0:A.yperiod0,xperiodalignment:A.xperiodalignment,yperiodalignment:A.yperiodalignment,xhoverformat:M("x"),yhoverformat:M("y"),hovertext:A.hovertext,hovertemplate:e({},{keys:n.eventDataKeys}),hoverinfo:r({},S.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:a({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),text:A.text,textposition:A.textposition,insidetextanchor:r({},A.insidetextanchor,{dflt:"middle"}),textangle:r({},A.textangle,{dflt:0}),textfont:A.textfont,insidetextfont:A.insidetextfont,outsidetextfont:A.outsidetextfont,constraintext:A.constraintext,cliponaxis:A.cliponaxis,orientation:r({},A.orientation,{}),offset:r({},A.offset,{arrayOk:!1}),width:r({},A.width,{arrayOk:!1}),marker:c(),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:r({},g.color,{dflt:t.defaultLine}),width:r({},g.width,{dflt:0,editType:"plot"}),dash:g.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:A.offsetgroup,alignmentgroup:A.alignmentgroup};function c(){var s=r({},A.marker);return delete s.pattern,s}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":782}],781:[function(d,ee,te){var A=d("../../plots/cartesian/axes"),g=d("../../plots/cartesian/align_period"),S=d("./arrays_to_calcdata"),M=d("../scatter/calc_selection"),e=d("../../constants/numerical").BADNUM;ee.exports=function(r,t){var c=A.getFromId(r,t.xaxis||"x"),s=A.getFromId(r,t.yaxis||"y"),i,x,p,v,f,y,o,m;t.orientation==="h"?(i=c.makeCalcdata(t,"x"),p=s.makeCalcdata(t,"y"),v=g(t,s,"y",p),f=!!t.yperiodalignment,y="y"):(i=s.makeCalcdata(t,"y"),p=c.makeCalcdata(t,"x"),v=g(t,c,"x",p),f=!!t.xperiodalignment,y="x"),x=v.vals;var l=Math.min(x.length,i.length),w=new Array(l);for(t._base=[],o=0;o<l;o++){i[o]<0&&(i[o]=e);var _=!1;i[o]!==e&&o+1<l&&i[o+1]!==e&&(_=!0),m=w[o]={p:x[o],s:i[o],cNext:_},t._base[o]=-.5*m.s,f&&(w[o].orig_p=p[o],w[o][y+"End"]=v.ends[o],w[o][y+"Start"]=v.starts[o]),t.ids&&(m.id=String(t.ids[o])),o===0&&(w[0].vTotal=0),w[0].vTotal+=a(m.s),m.begR=a(m.s)/a(w[0].s)}var h;for(o=0;o<l;o++)m=w[o],m.s!==e&&(m.sumR=m.s/w[0].vTotal,m.difR=h!==void 0?m.s/h:1,h=m.s);return S(w,t),M(w,t),w};function a(n){return n===e?0:n}},{"../../constants/numerical":491,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":779}],782:[function(d,ee,te){ee.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],783:[function(d,ee,te){var A=d("../bar/cross_trace_calc").setGroupPositions;ee.exports=function(S,M){var e=S._fullLayout,a=S._fullData,n=S.calcdata,r=M.xaxis,t=M.yaxis,c=[],s=[],i=[],x,p;for(p=0;p<a.length;p++){var v=a[p],f=v.orientation==="h";v.visible===!0&&v.xaxis===r._id&&v.yaxis===t._id&&v.type==="funnel"&&(x=n[p],f?i.push(x):s.push(x),c.push(x))}var y={mode:e.funnelmode,norm:e.funnelnorm,gap:e.funnelgap,groupgap:e.funnelgroupgap};for(A(S,r,t,s,y),A(S,t,r,i,y),p=0;p<c.length;p++){x=c[p];for(var o=0;o<x.length;o++)o+1<x.length&&(x[o].nextP0=x[o+1].p0,x[o].nextS0=x[o+1].s0,x[o].nextP1=x[o+1].p1,x[o].nextS1=x[o+1].s1)}}},{"../bar/cross_trace_calc":660}],784:[function(d,ee,te){var A=d("../../lib"),g=d("../bar/defaults").handleGroupingDefaults,S=d("../bar/defaults").handleText,M=d("../scatter/xy_defaults"),e=d("../scatter/period_defaults"),a=d("./attributes"),n=d("../../components/color");function r(s,i,x,p){function v(_,h){return A.coerce(s,i,a,_,h)}var f=M(s,i,p,v);if(!f){i.visible=!1;return}e(s,i,p,v),v("xhoverformat"),v("yhoverformat"),v("orientation",i.y&&!i.x?"v":"h"),v("offset"),v("width");var y=v("text");v("hovertext"),v("hovertemplate");var o=v("textposition");S(s,i,p,v,o,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),i.textposition!=="none"&&!i.texttemplate&&v("textinfo",Array.isArray(y)?"text+value":"value");var m=v("marker.color",x);v("marker.line.color",n.defaultLine),v("marker.line.width");var l=v("connector.visible");if(l){v("connector.fillcolor",t(m));var w=v("connector.line.width");w&&(v("connector.line.color"),v("connector.line.dash"))}}function t(s){var i=A.isArrayOrTypedArray(s)?"#000":s;return n.addOpacity(i,.5*n.opacity(i))}function c(s,i){var x,p;function v(y){return A.coerce(p._input,p,a,y)}if(i.funnelmode==="group")for(var f=0;f<s.length;f++)p=s[f],x=p._input,g(x,p,i,v)}ee.exports={supplyDefaults:r,crossTraceDefaults:c}},{"../../components/color":367,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":780}],785:[function(d,ee,te){ee.exports=function(g,S){return g.x="xVal"in S?S.xVal:S.x,g.y="yVal"in S?S.yVal:S.y,"percentInitial"in S&&(g.percentInitial=S.percentInitial),"percentPrevious"in S&&(g.percentPrevious=S.percentPrevious),"percentTotal"in S&&(g.percentTotal=S.percentTotal),S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),g}},{}],786:[function(d,ee,te){var A=d("../../components/color").opacity,g=d("../bar/hover").hoverOnBars,S=d("../../lib").formatPercent;ee.exports=function(a,n,r,t,c){var s=g(a,n,r,t,c);if(!!s){var i=s.cd,x=i[0].trace,p=x.orientation==="h",v=s.index,f=i[v],y=p?"x":"y";s[y+"LabelVal"]=f.s,s.percentInitial=f.begR,s.percentInitialLabel=S(f.begR,1),s.percentPrevious=f.difR,s.percentPreviousLabel=S(f.difR,1),s.percentTotal=f.sumR,s.percentTotalLabel=S(f.sumR,1);var o=f.hi||x.hoverinfo,m=[];if(o&&o!=="none"&&o!=="skip"){var l=o==="all",w=o.split("+"),_=function(h){return l||w.indexOf(h)!==-1};_("percent initial")&&m.push(s.percentInitialLabel+" of initial"),_("percent previous")&&m.push(s.percentPreviousLabel+" of previous"),_("percent total")&&m.push(s.percentTotalLabel+" of total")}return s.extraText=m.join("<br>"),s.color=M(x,f),[s]}};function M(e,a){var n=e.marker,r=a.mc||n.color,t=a.mlc||n.line.color,c=a.mlw||n.line.width;if(A(r))return r;if(A(t)&&c)return t}},{"../../components/color":367,"../../lib":515,"../bar/hover":664}],787:[function(d,ee,te){ee.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults").supplyDefaults,crossTraceDefaults:d("./defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc"),plot:d("./plot"),style:d("./style").style,hoverPoints:d("./hover"),eventData:d("./event_data"),selectPoints:d("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:d("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":780,"./calc":781,"./cross_trace_calc":783,"./defaults":784,"./event_data":785,"./hover":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(d,ee,te){ee.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],789:[function(d,ee,te){var A=d("../../lib"),g=d("./layout_attributes");ee.exports=function(S,M,e){var a=!1;function n(c,s){return A.coerce(S,M,g,c,s)}for(var r=0;r<e.length;r++){var t=e[r];if(t.visible&&t.type==="funnel"){a=!0;break}}a&&(n("funnelmode"),n("funnelgap",.2),n("funnelgroupgap"))}},{"../../lib":515,"./layout_attributes":788}],790:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=d("../../components/drawing"),M=d("../../constants/numerical").BADNUM,e=d("../bar/plot"),a=d("../bar/uniform_text").clearMinTextSize;ee.exports=function(s,i,x,p){var v=s._fullLayout;a("funnel",v),n(s,i,x,p),r(s,i,x,p),e.plot(s,i,x,p,{mode:v.funnelmode,norm:v.funnelmode,gap:v.funnelgap,groupgap:v.funnelgroupgap})};function n(c,s,i,x){var p=s.xaxis,v=s.yaxis;g.makeTraceGroups(x,i,"trace bars").each(function(f){var y=A.select(this),o=f[0].trace,m=g.ensureSingle(y,"g","regions");if(!o.connector||!o.connector.visible){m.remove();return}var l=o.orientation==="h",w=m.selectAll("g.region").data(g.identity);w.enter().append("g").classed("region",!0),w.exit().remove();var _=w.size();w.each(function(h,b){if(!(b!==_-1&&!h.cNext)){var u=t(h,p,v,l),L=u[0],T=u[1],k="";L[0]!==M&&T[0]!==M&&L[1]!==M&&T[1]!==M&&L[2]!==M&&T[2]!==M&&L[3]!==M&&T[3]!==M&&(l?k+="M"+L[0]+","+T[1]+"L"+L[2]+","+T[2]+"H"+L[3]+"L"+L[1]+","+T[1]+"Z":k+="M"+L[1]+","+T[1]+"L"+L[2]+","+T[3]+"V"+T[2]+"L"+L[1]+","+T[0]+"Z"),k===""&&(k="M0,0Z"),g.ensureSingle(A.select(this),"path").attr("d",k).call(S.setClipUrl,s.layerClipId,c)}})})}function r(c,s,i,x){var p=s.xaxis,v=s.yaxis;g.makeTraceGroups(x,i,"trace bars").each(function(f){var y=A.select(this),o=f[0].trace,m=g.ensureSingle(y,"g","lines");if(!o.connector||!o.connector.visible||!o.connector.line.width){m.remove();return}var l=o.orientation==="h",w=m.selectAll("g.line").data(g.identity);w.enter().append("g").classed("line",!0),w.exit().remove();var _=w.size();w.each(function(h,b){if(!(b!==_-1&&!h.cNext)){var u=t(h,p,v,l),L=u[0],T=u[1],k="";L[3]!==void 0&&T[3]!==void 0&&(l?(k+="M"+L[0]+","+T[1]+"L"+L[2]+","+T[2],k+="M"+L[1]+","+T[1]+"L"+L[3]+","+T[2]):(k+="M"+L[1]+","+T[1]+"L"+L[2]+","+T[3],k+="M"+L[1]+","+T[0]+"L"+L[2]+","+T[2])),k===""&&(k="M0,0Z"),g.ensureSingle(A.select(this),"path").attr("d",k).call(S.setClipUrl,s.layerClipId,c)}})})}function t(c,s,i,x){var p=[],v=[],f=x?s:i,y=x?i:s;return p[0]=f.c2p(c.s0,!0),v[0]=y.c2p(c.p0,!0),p[1]=f.c2p(c.s1,!0),v[1]=y.c2p(c.p1,!0),p[2]=f.c2p(c.nextS0,!0),v[2]=y.c2p(c.nextP0,!0),p[3]=f.c2p(c.nextS1,!0),v[3]=y.c2p(c.nextP1,!0),x?[p,v]:[v,p]}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],791:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/drawing"),S=d("../../components/color"),M=d("../../constants/interactions").DESELECTDIM,e=d("../bar/style"),a=d("../bar/uniform_text").resizeText,n=e.styleTextPoints;function r(t,c,s){var i=s||A.select(t).selectAll("g.funnellayer").selectAll("g.trace");a(t,i,"funnel"),i.style("opacity",function(x){return x[0].trace.opacity}),i.each(function(x){var p=A.select(this),v=x[0].trace;p.selectAll(".point > path").each(function(f){if(!f.isBlank){var y=v.marker;A.select(this).call(S.fill,f.mc||y.color).call(S.stroke,f.mlc||y.line.color).call(g.dashLine,y.line.dash,f.mlw||y.line.width).style("opacity",v.selectedpoints&&!f.selected?M:1)}}),n(p,v,t),p.selectAll(".regions").each(function(){A.select(this).selectAll("path").style("stroke-width",0).call(S.fill,v.connector.fillcolor)}),p.selectAll(".lines").each(function(){var f=v.connector.line;g.lineGroupStyle(A.select(this).selectAll("path"),f.width,f.color,f.dash)})})}ee.exports={style:r}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],792:[function(d,ee,te){var A=d("../pie/attributes"),g=d("../../plots/attributes"),S=d("../../plots/domain").attributes,M=d("../../plots/template_attributes").hovertemplateAttrs,e=d("../../plots/template_attributes").texttemplateAttrs,a=d("../../lib/extend").extendFlat;ee.exports={labels:A.labels,label0:A.label0,dlabel:A.dlabel,values:A.values,marker:{colors:A.marker.colors,line:{color:a({},A.marker.line.color,{dflt:null}),width:a({},A.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:A.text,hovertext:A.hovertext,scalegroup:a({},A.scalegroup,{}),textinfo:a({},A.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:a({},g.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:M({},{keys:["label","color","value","text","percent"]}),textposition:a({},A.textposition,{values:["inside","none"],dflt:"inside"}),textfont:A.textfont,insidetextfont:A.insidetextfont,title:{text:A.title.text,font:A.title.font,position:a({},A.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:S({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910}],793:[function(d,ee,te){var A=d("../../plots/plots");te.name="funnelarea",te.plot=function(g,S,M,e){A.plotBasePlot(te.name,g,S,M,e)},te.clean=function(g,S,M,e){A.cleanBasePlot(te.name,g,S,M,e)}},{"../../plots/plots":628}],794:[function(d,ee,te){var A=d("../pie/calc");function g(M,e){return A.calc(M,e)}function S(M){A.crossTraceCalc(M,{type:"funnelarea"})}ee.exports={calc:g,crossTraceCalc:S}},{"../pie/calc":912}],795:[function(d,ee,te){var A=d("../../lib"),g=d("./attributes"),S=d("../../plots/domain").defaults,M=d("../bar/defaults").handleText,e=d("../pie/defaults").handleLabelsAndValues;ee.exports=function(n,r,t,c){function s(_,h){return A.coerce(n,r,g,_,h)}var i=s("labels"),x=s("values"),p=e(i,x),v=p.len;if(r._hasLabels=p.hasLabels,r._hasValues=p.hasValues,!r._hasLabels&&r._hasValues&&(s("label0"),s("dlabel")),!v){r.visible=!1;return}r._length=v;var f=s("marker.line.width");f&&s("marker.line.color",c.paper_bgcolor),s("marker.colors"),s("scalegroup");var y=s("text"),o=s("texttemplate"),m;if(o||(m=s("textinfo",Array.isArray(y)?"text+percent":"percent")),s("hovertext"),s("hovertemplate"),o||m&&m!=="none"){var l=s("textposition");M(n,r,c,s,l,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}S(r,c,s);var w=s("title.text");w&&(s("title.position"),A.coerceFont(s,"title.font",c.font)),s("aspectratio"),s("baseratio")}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"../pie/defaults":913,"./attributes":792}],796:[function(d,ee,te){ee.exports={moduleType:"trace",name:"funnelarea",basePlotModule:d("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot"),style:d("./style"),styleOne:d("../pie/style_one"),meta:{}}},{"../pie/style_one":921,"./attributes":792,"./base_plot":793,"./calc":794,"./defaults":795,"./layout_attributes":797,"./layout_defaults":798,"./plot":799,"./style":800}],797:[function(d,ee,te){var A=d("../pie/layout_attributes").hiddenlabels;ee.exports={hiddenlabels:A,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":917}],798:[function(d,ee,te){var A=d("../../lib"),g=d("./layout_attributes");ee.exports=function(M,e){function a(n,r){return A.coerce(M,e,g,n,r)}a("hiddenlabels"),a("funnelareacolorway",e.colorway),a("extendfunnelareacolors")}},{"../../lib":515,"./layout_attributes":797}],799:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/drawing"),S=d("../../lib"),M=S.strScale,e=S.strTranslate,a=d("../../lib/svg_text_utils"),n=d("../bar/plot"),r=n.toMoveInsideBar,t=d("../bar/uniform_text"),c=t.recordMinTextSize,s=t.clearMinTextSize,i=d("../pie/helpers"),x=d("../pie/plot"),p=x.attachFxHandlers,v=x.determineInsideTextFont,f=x.layoutAreas,y=x.prerenderTitles,o=x.positionTitleOutside,m=x.formatSliceLabel;ee.exports=function(b,u){var L=b._context.staticPlot,T=b._fullLayout;s("funnelarea",T),y(u,b),f(u,T._size),S.makeTraceGroups(T._funnelarealayer,u,"trace").each(function(k){var P=A.select(this),z=k[0],I=z.trace;_(k),P.each(function(){var D=A.select(this).selectAll("g.slice").data(k);D.enter().append("g").classed("slice",!0),D.exit().remove(),D.each(function(O,F){if(O.hidden){A.select(this).selectAll("path,g").remove();return}O.pointNumber=O.i,O.curveNumber=I.index;var N=z.cx,G=z.cy,K=A.select(this),W=K.selectAll("path.surface").data([O]);W.enter().append("path").classed("surface",!0).style({"pointer-events":L?"none":"all"}),K.call(p,b,k);var Y="M"+(N+O.TR[0])+","+(G+O.TR[1])+l(O.TR,O.BR)+l(O.BR,O.BL)+l(O.BL,O.TL)+"Z";W.attr("d",Y),m(b,O,z);var re=i.castOption(I.textposition,O.pts),ue=K.selectAll("g.slicetext").data(O.text&&re!=="none"?[0]:[]);ue.enter().append("g").classed("slicetext",!0),ue.exit().remove(),ue.each(function(){var j=S.ensureSingle(A.select(this),"text","",function(ie){ie.attr("data-notex",1)}),q=S.ensureUniformFontSize(b,v(I,O,T.font));j.text(O.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(g.font,q).call(a.convertToTspans,b);var V=g.bBox(j.node()),U,$,ne,X=Math.min(O.BL[1],O.BR[1])+G,Q=Math.max(O.TL[1],O.TR[1])+G;$=Math.max(O.TL[0],O.BL[0])+N,ne=Math.min(O.TR[0],O.BR[0])+N,U=r($,ne,X,Q,V,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"}),U.fontSize=q.size,c(I.type,U,T),k[F].transform=U,S.setTransormAndDisplay(j,U)})});var R=A.select(this).selectAll("g.titletext").data(I.title.text?[0]:[]);R.enter().append("g").classed("titletext",!0),R.exit().remove(),R.each(function(){var O=S.ensureSingle(A.select(this),"text","",function(G){G.attr("data-notex",1)}),F=I.title.text;I._meta&&(F=S.templateString(F,I._meta)),O.text(F).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(g.font,I.title.font).call(a.convertToTspans,b);var N=o(z,T._size);O.attr("transform",e(N.x,N.y)+M(Math.min(1,N.scale))+e(N.tx,N.ty))})})})};function l(h,b){var u=b[0]-h[0],L=b[1]-h[1];return"l"+u+","+L}function w(h,b){return[.5*(h[0]+b[0]),.5*(h[1]+b[1])]}function _(h){if(!h.length)return;var b=h[0],u=b.trace,L=u.aspectratio,T=u.baseratio;T>.999&&(T=.999);var k=Math.pow(T,2),P=b.vTotal,z=P*k/(1-k),I=P,D=z/P;function R(){var se=Math.sqrt(D);return{x:se,y:-se}}function O(){var se=R();return[se.x,se.y]}var F,N=[];N.push(O());var G,K;for(G=h.length-1;G>-1;G--)if(K=h[G],!K.hidden){var W=K.v/I;D+=W,N.push(O())}var Y=1/0,re=-1/0;for(G=0;G<N.length;G++)F=N[G],Y=Math.min(Y,F[1]),re=Math.max(re,F[1]);for(G=0;G<N.length;G++)N[G][1]-=(re+Y)/2;var ue=N[N.length-1][0],j=b.r,q=(re-Y)/2,V=j/ue,U=j/q*L;for(b.r=U*q,G=0;G<N.length;G++)N[G][0]*=V,N[G][1]*=U;F=N[0];var $=[-F[0],F[1]],ne=[F[0],F[1]],X=0;for(G=h.length-1;G>-1;G--)if(K=h[G],!K.hidden){X+=1;var Q=N[X][0],ie=N[X][1];K.TL=[-Q,ie],K.TR=[Q,ie],K.BL=$,K.BR=ne,K.pxmid=w(K.TR,K.BR),$=K.TL,ne=K.TR}}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/plot":668,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"@plotly/d3":58}],800:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../pie/style_one"),S=d("../bar/uniform_text").resizeText;ee.exports=function(e){var a=e._fullLayout._funnelarealayer.selectAll(".trace");S(e,a,"funnelarea"),a.each(function(n){var r=n[0],t=r.trace,c=A.select(this);c.style({opacity:t.opacity}),c.selectAll("path.surface").each(function(s){A.select(this).call(g,s,t)})})}},{"../bar/uniform_text":673,"../pie/style_one":921,"@plotly/d3":58}],801:[function(d,ee,te){var A=d("../scatter/attributes"),g=d("../../plots/attributes"),S=d("../../plots/font_attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/template_attributes").texttemplateAttrs,n=d("../../components/colorscale/attributes"),r=d("../../lib/extend").extendFlat;ee.exports=r({z:{valType:"data_array",editType:"calc"},x:r({},A.x,{impliedEdits:{xtype:"array"}}),x0:r({},A.x0,{impliedEdits:{xtype:"scaled"}}),dx:r({},A.dx,{impliedEdits:{xtype:"scaled"}}),y:r({},A.y,{impliedEdits:{ytype:"array"}}),y0:r({},A.y0,{impliedEdits:{ytype:"scaled"}}),dy:r({},A.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:r({},A.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:r({},A.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:r({},A.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:r({},A.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:r({},A.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:r({},A.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:M("x"),yhoverformat:M("y"),zhoverformat:M("z",1),hovertemplate:e(),texttemplate:a({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:S({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:r({},g.showlegend,{dflt:!1})},{transforms:void 0},n("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936}],802:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib"),S=d("../../plots/cartesian/axes"),M=d("../../plots/cartesian/align_period"),e=d("../histogram2d/calc"),a=d("../../components/colorscale/calc"),n=d("./convert_column_xyz"),r=d("./clean_2d_array"),t=d("./interp2d"),c=d("./find_empties"),s=d("./make_bound_array"),i=d("../../constants/numerical").BADNUM;ee.exports=function(f,y){var o=S.getFromId(f,y.xaxis||"x"),m=S.getFromId(f,y.yaxis||"y"),l=A.traceIs(y,"contour"),w=A.traceIs(y,"histogram"),_=A.traceIs(y,"gl2d"),h=l?"best":y.zsmooth,b,u,L,T,k,P,z,I,D,R,O;if(o._minDtick=0,m._minDtick=0,w)O=e(f,y),T=O.orig_x,b=O.x,u=O.x0,L=O.dx,I=O.orig_y,k=O.y,P=O.y0,z=O.dy,D=O.z;else{var F=y.z;g.isArray1D(F)?(n(y,o,m,"x","y",["z"]),b=y._x,k=y._y,F=y._z):(T=y.x?o.makeCalcdata(y,"x"):[],I=y.y?m.makeCalcdata(y,"y"):[],b=M(y,o,"x",T).vals,k=M(y,m,"y",I).vals,y._x=b,y._y=k),u=y.x0,L=y.dx,P=y.y0,z=y.dy,D=r(F,y,o,m)}(o.rangebreaks||m.rangebreaks)&&(D=p(b,k,D),w||(b=x(b),k=x(k),y._x=b,y._y=k)),!w&&(l||y.connectgaps)&&(y._emptypoints=c(D),t(D,y._emptypoints));function N(ne){h=y._input.zsmooth=y.zsmooth=!1,g.warn('cannot use zsmooth: "fast": '+ne)}if(h==="fast"){if(o.type==="log"||m.type==="log")N("log axis found");else if(!w){if(b.length){var G=(b[b.length-1]-b[0])/(b.length-1),K=Math.abs(G/100);for(R=0;R<b.length-1;R++)if(Math.abs(b[R+1]-b[R]-G)>K){N("x scale is not linear");break}}if(k.length&&h==="fast"){var W=(k[k.length-1]-k[0])/(k.length-1),Y=Math.abs(W/100);for(R=0;R<k.length-1;R++)if(Math.abs(k[R+1]-k[R]-W)>Y){N("y scale is not linear");break}}}}var re=g.maxRowLength(D),ue=y.xtype==="scaled"?"":b,j=s(y,ue,u,L,re,o),q=y.ytype==="scaled"?"":k,V=s(y,q,P,z,D.length,m);_||(y._extremes[o._id]=S.findExtremes(o,j),y._extremes[m._id]=S.findExtremes(m,V));var U={x:j,y:V,z:D,text:y._text||y.text,hovertext:y._hovertext||y.hovertext};if(y.xperiodalignment&&T&&(U.orig_x=T),y.yperiodalignment&&I&&(U.orig_y=I),ue&&ue.length===j.length-1&&(U.xCenter=ue),q&&q.length===V.length-1&&(U.yCenter=q),w&&(U.xRanges=O.xRanges,U.yRanges=O.yRanges,U.pts=O.pts),l||a(f,y,{vals:D,cLetter:"z"}),l&&y.contours&&y.contours.coloring==="heatmap"){var $={type:y.type==="contour"?"heatmap":"histogram2d",xcalendar:y.xcalendar,ycalendar:y.ycalendar};U.xfill=s($,ue,u,L,re,o),U.yfill=s($,q,P,z,D.length,m)}return[U]};function x(v){for(var f=[],y=v.length,o=0;o<y;o++){var m=v[o];m!==i&&f.push(m)}return f}function p(v,f,y){for(var o=[],m=-1,l=0;l<y.length;l++)if(f[l]!==i){m++,o[m]=[];for(var w=0;w<y[l].length;w++)v[w]!==i&&o[m].push(y[l][w])}return o}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../../registry":647,"../histogram2d/calc":835,"./clean_2d_array":803,"./convert_column_xyz":805,"./find_empties":807,"./interp2d":810,"./make_bound_array":812}],803:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib"),S=d("../../constants/numerical").BADNUM;ee.exports=function(e,a,n,r){var t,c,s,i,x,p;function v(w){if(!!A(w))return+w}if(a&&a.transpose){for(t=0,x=0;x<e.length;x++)t=Math.max(t,e[x].length);if(t===0)return!1;s=function(w){return w.length},i=function(w,_,h){return(w[h]||[])[_]}}else t=e.length,s=function(w,_){return w[_].length},i=function(w,_,h){return(w[_]||[])[h]};var f=function(w,_,h){return _===S||h===S?S:i(w,_,h)};function y(w){if(a&&a.type!=="carpet"&&a.type!=="contourcarpet"&&w&&w.type==="category"&&a["_"+w._id.charAt(0)].length){var _=w._id.charAt(0),h={},b=a["_"+_+"CategoryMap"]||a[_];for(x=0;x<b.length;x++)h[b[x]]=x;return function(u){var L=h[w._categories[u]];return L+1?L:S}}else return g.identity}var o=y(n),m=y(r);r&&r.type==="category"&&(t=r._categories.length);var l=new Array(t);for(x=0;x<t;x++)for(n&&n.type==="category"?c=n._categories.length:c=s(e,x),l[x]=new Array(c),p=0;p<c;p++)l[x][p]=v(f(e,m(x),o(p)));return l}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],804:[function(d,ee,te){ee.exports={min:"zmin",max:"zmax"}},{}],805:[function(d,ee,te){var A=d("../../lib"),g=d("../../constants/numerical").BADNUM,S=d("../../plots/cartesian/align_period");ee.exports=function(e,a,n,r,t,c){var s=e._length,i=a.makeCalcdata(e,r),x=n.makeCalcdata(e,t);i=S(e,a,r,i).vals,x=S(e,n,t,x).vals;var p=e.text,v=p!==void 0&&A.isArray1D(p),f=e.hovertext,y=f!==void 0&&A.isArray1D(f),o,m,l=A.distinctVals(i),w=l.vals,_=A.distinctVals(x),h=_.vals,b=[],u,L,T=h.length,k=w.length;for(o=0;o<c.length;o++)b[o]=A.init2dArray(T,k);v&&(u=A.init2dArray(T,k)),y&&(L=A.init2dArray(T,k));var P=A.init2dArray(T,k);for(o=0;o<s;o++)if(i[o]!==g&&x[o]!==g){var z=A.findBin(i[o]+l.minDiff/2,w),I=A.findBin(x[o]+_.minDiff/2,h);for(m=0;m<c.length;m++){var D=c[m],R=e[D],O=b[m];O[I][z]=R[o],P[I][z]=o}v&&(u[I][z]=p[o]),y&&(L[I][z]=f[o])}for(e["_"+r]=w,e["_"+t]=h,m=0;m<c.length;m++)e["_"+c[m]]=b[m];v&&(e._text=u),y&&(e._hovertext=L),a&&a.type==="category"&&(e["_"+r+"CategoryMap"]=w.map(function(F){return a._categories[F]})),n&&n.type==="category"&&(e["_"+t+"CategoryMap"]=h.map(function(F){return n._categories[F]})),e._after2before=P}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563}],806:[function(d,ee,te){var A=d("../../lib"),g=d("./xyz_defaults"),S=d("./label_defaults"),M=d("../scatter/period_defaults"),e=d("./style_defaults"),a=d("../../components/colorscale/defaults"),n=d("./attributes");ee.exports=function(t,c,s,i){function x(v,f){return A.coerce(t,c,n,v,f)}var p=g(t,c,x,i);if(!p){c.visible=!1;return}M(t,c,i,x),x("xhoverformat"),x("yhoverformat"),x("text"),x("hovertext"),x("hovertemplate"),S(x,i),e(t,c,x,i),x("hoverongaps"),x("connectgaps",A.isArray1D(c.z)&&c.zsmooth!==!1),a(t,c,i,x,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"../scatter/period_defaults":956,"./attributes":801,"./label_defaults":811,"./style_defaults":815,"./xyz_defaults":816}],807:[function(d,ee,te){var A=d("../../lib").maxRowLength;ee.exports=function(S){var M=[],e={},a=[],n=S[0],r=[],t=[0,0,0],c=A(S),s,i,x,p,v,f,y,o;for(i=0;i<S.length;i++)for(s=r,r=n,n=S[i+1]||[],x=0;x<c;x++)r[x]===void 0&&(f=(r[x-1]!==void 0?1:0)+(r[x+1]!==void 0?1:0)+(s[x]!==void 0?1:0)+(n[x]!==void 0?1:0),f?(i===0&&f++,x===0&&f++,i===S.length-1&&f++,x===r.length-1&&f++,f<4&&(e[[i,x]]=[i,x,f]),M.push([i,x,f])):a.push([i,x]));for(;a.length;){for(y={},o=!1,v=a.length-1;v>=0;v--)p=a[v],i=p[0],x=p[1],f=((e[[i-1,x]]||t)[2]+(e[[i+1,x]]||t)[2]+(e[[i,x-1]]||t)[2]+(e[[i,x+1]]||t)[2])/20,f&&(y[p]=[i,x,f],a.splice(v,1),o=!0);if(!o)throw"findEmpties iterated with no new neighbors";for(p in y)e[p]=y[p],M.push(y[p])}return M.sort(function(m,l){return l[2]-m[2]})}},{"../../lib":515}],808:[function(d,ee,te){var A=d("../../components/fx"),g=d("../../lib"),S=d("../../plots/cartesian/axes"),M=d("../../components/colorscale").extractOpts;ee.exports=function(a,n,r,t,c){c||(c={});var s=c.isContour,i=a.cd[0],x=i.trace,p=a.xa,v=a.ya,f=i.x,y=i.y,o=i.z,m=i.xCenter,l=i.yCenter,w=i.zmask,_=x.zhoverformat,h=f,b=y,u,L,T,k;if(a.index!==!1){try{T=Math.round(a.index[1]),k=Math.round(a.index[0])}catch{g.error("Error hovering on heatmap, pointNumber must be [row,col], found:",a.index);return}if(T<0||T>=o[0].length||k<0||k>o.length)return}else{if(A.inbox(n-f[0],n-f[f.length-1],0)>0||A.inbox(r-y[0],r-y[y.length-1],0)>0)return;if(s){var P;for(h=[2*f[0]-f[1]],P=1;P<f.length;P++)h.push((f[P]+f[P-1])/2);for(h.push([2*f[f.length-1]-f[f.length-2]]),b=[2*y[0]-y[1]],P=1;P<y.length;P++)b.push((y[P]+y[P-1])/2);b.push([2*y[y.length-1]-y[y.length-2]])}T=Math.max(0,Math.min(h.length-2,g.findBin(n,h))),k=Math.max(0,Math.min(b.length-2,g.findBin(r,b)))}var z=p.c2p(f[T]),I=p.c2p(f[T+1]),D=v.c2p(y[k]),R=v.c2p(y[k+1]),O,F;s?(O=i.orig_x||f,F=i.orig_y||y,I=z,u=O[T],R=D,L=F[k]):(O=i.orig_x||m||f,F=i.orig_y||l||y,u=m?O[T]:(O[T]+O[T+1])/2,L=l?F[k]:(F[k]+F[k+1])/2,p&&p.type==="category"&&(u=f[T]),v&&v.type==="category"&&(L=y[k]),x.zsmooth&&(z=I=p.c2p(u),D=R=v.c2p(L)));var N=o[k][T];if(w&&!w[k][T]&&(N=void 0),!(N===void 0&&!x.hoverongaps)){var G;Array.isArray(i.hovertext)&&Array.isArray(i.hovertext[k])?G=i.hovertext[k][T]:Array.isArray(i.text)&&Array.isArray(i.text[k])&&(G=i.text[k][T]);var K=M(x),W={type:"linear",range:[K.min,K.max],hoverformat:_,_separators:p._separators,_numFormat:p._numFormat},Y=S.tickText(W,N,"hover").text;return[g.extendFlat(a,{index:x._after2before?x._after2before[k][T]:[k,T],distance:a.maxHoverDistance,spikeDistance:a.maxSpikeDistance,x0:z,x1:I,y0:D,y1:R,xLabelVal:u,yLabelVal:L,zLabelVal:N,zLabel:Y,text:G})]}}},{"../../components/colorscale":379,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],809:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),colorbar:d("./colorbar"),style:d("./style"),hoverPoints:d("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":801,"./calc":802,"./colorbar":804,"./defaults":806,"./hover":808,"./plot":813,"./style":814}],810:[function(d,ee,te){var A=d("../../lib"),g=.01,S=[[-1,0],[1,0],[0,-1],[0,1]];function M(a){return .5-.25*Math.min(1,a*.5)}ee.exports=function(n,r){var t=1,c;for(e(n,r),c=0;c<r.length&&!(r[c][2]<4);c++);for(r=r.slice(c),c=0;c<100&&t>g;c++)t=e(n,r,M(t));return t>g&&A.log("interp2d didn't converge quickly",t),n};function e(a,n,r){var t=0,c,s,i,x,p,v,f,y,o,m,l,w,_;for(x=0;x<n.length;x++){for(c=n[x],s=c[0],i=c[1],l=a[s][i],m=0,o=0,p=0;p<4;p++)v=S[p],f=a[s+v[0]],f&&(y=f[i+v[1]],y!==void 0&&(m===0?w=_=y:(w=Math.min(w,y),_=Math.max(_,y)),o++,m+=y));if(o===0)throw"iterateInterp2d order is wrong: no defined neighbors";a[s][i]=m/o,l===void 0?o<4&&(t=1):(a[s][i]=(1+r)*a[s][i]-r*l,_>w&&(t=Math.max(t,Math.abs(a[s][i]-l)/(_-w))))}return t}},{"../../lib":515}],811:[function(d,ee,te){var A=d("../../lib");ee.exports=function(S,M){S("texttemplate");var e=A.extendFlat({},M.font,{color:"auto",size:"auto"});A.coerceFont(S,"textfont",e)}},{"../../lib":515}],812:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib").isArrayOrTypedArray;ee.exports=function(M,e,a,n,r,t){var c=[],s=A.traceIs(M,"contour"),i=A.traceIs(M,"histogram"),x=A.traceIs(M,"gl2d"),p,v,f,y=g(e)&&e.length>1;if(y&&!i&&t.type!=="category"){var o=e.length;if(o<=r){if(s||x)c=e.slice(0,r);else if(r===1)c=[e[0]-.5,e[0]+.5];else{for(c=[1.5*e[0]-.5*e[1]],f=1;f<o;f++)c.push((e[f-1]+e[f])*.5);c.push(1.5*e[o-1]-.5*e[o-2])}if(o<r){var m=c[c.length-1],l=m-c[c.length-2];for(f=o;f<r;f++)m+=l,c.push(m)}}else return s?e.slice(0,r):e.slice(0,r+1)}else{var w=M[t._id.charAt(0)+"calendar"];if(i)p=t.r2c(a,0,w);else if(g(e)&&e.length===1)p=e[0];else if(a===void 0)p=0;else{var _=t.type==="log"?t.d2c:t.r2c;p=_(a,0,w)}for(v=n||1,f=s||x?0:-.5;f<r;f++)c.push(p+v*f)}return c}},{"../../lib":515,"../../registry":647}],813:[function(d,ee,te){var A=d("@plotly/d3"),g=d("tinycolor2"),S=d("../../registry"),M=d("../../components/drawing"),e=d("../../plots/cartesian/axes"),a=d("../../lib"),n=d("../../lib/svg_text_utils"),r=d("../scatter/format_labels"),t=d("../../components/color"),c=d("../../components/colorscale").extractOpts,s=d("../../components/colorscale").makeColorScaleFuncFromTrace,i=d("../../constants/xmlns_namespaces"),x=d("../../constants/alignment"),p=x.LINE_SPACING,v="heatmap-label";function f(w){return w.selectAll("g."+v)}function y(w){f(w).remove()}ee.exports=function(w,_,h,b){var u=_.xaxis,L=_.yaxis;a.makeTraceGroups(b,h,"hm").each(function(T){var k=A.select(this),P=T[0],z=P.trace,I=z.xgap||0,D=z.ygap||0,R=P.z,O=P.x,F=P.y,N=P.xCenter,G=P.yCenter,K=S.traceIs(z,"contour"),W=K?"best":z.zsmooth,Y=R.length,re=a.maxRowLength(R),ue=!1,j=!1,q,V,U,$,ne,X,Q,ie;for(X=0;q===void 0&&X<O.length-1;)q=u.c2p(O[X]),X++;for(X=O.length-1;V===void 0&&X>0;)V=u.c2p(O[X]),X--;for(V<q&&(U=V,V=q,q=U,ue=!0),X=0;$===void 0&&X<F.length-1;)$=L.c2p(F[X]),X++;for(X=F.length-1;ne===void 0&&X>0;)ne=L.c2p(F[X]),X--;if(ne<$&&(U=$,$=ne,ne=U,j=!0),K&&(N=O,G=F,O=P.xfill,F=P.yfill),W!=="fast"){var se=W==="best"?0:.5;q=Math.max(-se*u._length,q),V=Math.min((1+se)*u._length,V),$=Math.max(-se*L._length,$),ne=Math.min((1+se)*L._length,ne)}var ae=Math.round(V-q),oe=Math.round(ne-$),be=ae<=0||oe<=0;if(be){var ce=k.selectAll("image").data([]);ce.exit().remove(),y(k);return}var de,ye;W==="fast"?(de=re,ye=Y):(de=ae,ye=oe);var ge=document.createElement("canvas");ge.width=de,ge.height=ye;var me=ge.getContext("2d"),Ee=s(z,{noNumericCheck:!0,returnArray:!0}),Pe,Ne;W==="fast"?(Pe=ue?function(Er){return re-1-Er}:a.identity,Ne=j?function(Er){return Y-1-Er}:a.identity):(Pe=function(Er){return a.constrain(Math.round(u.c2p(O[Er])-q),0,ae)},Ne=function(Er){return a.constrain(Math.round(L.c2p(F[Er])-$),0,oe)});var we=Ne(0),ke=[we,we],Xe=ue?0:1,He=j?0:1,Ie=0,De=0,Ge=0,ht=0,Rt,Kt,It,Mt,Yt;function zt(Er,_r){if(Er!==void 0){var Gr=Ee(Er);return Gr[0]=Math.round(Gr[0]),Gr[1]=Math.round(Gr[1]),Gr[2]=Math.round(Gr[2]),Ie+=_r,De+=Gr[0]*_r,Ge+=Gr[1]*_r,ht+=Gr[2]*_r,Gr}return[0,0,0,0]}function St(Er,_r,Gr,wn){var cn=Er[Gr.bin0];if(cn===void 0)return zt(void 0,1);var Bn=Er[Gr.bin1],En=_r[Gr.bin0],Yn=_r[Gr.bin1],Hn=Bn-cn||0,pa=En-cn||0,Ma;return Bn===void 0?Yn===void 0?Ma=0:En===void 0?Ma=2*(Yn-cn):Ma=(2*Yn-En-cn)*2/3:Yn===void 0?En===void 0?Ma=0:Ma=(2*cn-Bn-En)*2/3:En===void 0?Ma=(2*Yn-Bn-cn)*2/3:Ma=Yn+cn-Bn-En,zt(cn+Gr.frac*Hn+wn.frac*(pa+Gr.frac*Ma))}if(W){var Ye=0,rt;try{rt=new Uint8Array(ae*oe*4)}catch{rt=new Array(ae*oe*4)}if(W==="best"){var Ve=N||O,Ae=G||F,Ue=new Array(Ve.length),Ze=new Array(Ae.length),Qe=new Array(ae),_t=N?m:o,gt=G?m:o,wt,Ut,Dt;for(X=0;X<Ve.length;X++)Ue[X]=Math.round(u.c2p(Ve[X])-q);for(X=0;X<Ae.length;X++)Ze[X]=Math.round(L.c2p(Ae[X])-$);for(X=0;X<ae;X++)Qe[X]=_t(X,Ue);for(Q=0;Q<oe;Q++)for(wt=gt(Q,Ze),Ut=R[wt.bin0],Dt=R[wt.bin1],X=0;X<ae;X++,Ye+=4)Yt=St(Ut,Dt,Qe[X],wt),l(rt,Ye,Yt)}else for(Q=0;Q<Y;Q++)for(Mt=R[Q],ke=Ne(Q),X=0;X<ae;X++)Yt=zt(Mt[X],1),Ye=(ke*ae+Pe(X))*4,l(rt,Ye,Yt);var Nt=me.createImageData(ae,oe);try{Nt.data.set(rt)}catch{var Xt=Nt.data,Ht=Xt.length;for(Q=0;Q<Ht;Q++)Xt[Q]=rt[Q]}me.putImageData(Nt,0,0)}else{var ar=Math.floor(I/2),Vr=Math.floor(D/2);for(Q=0;Q<Y;Q++)if(Mt=R[Q],ke.reverse(),ke[He]=Ne(Q+1),!(ke[0]===ke[1]||ke[0]===void 0||ke[1]===void 0))for(Kt=Pe(0),Rt=[Kt,Kt],X=0;X<re;X++)Rt.reverse(),Rt[Xe]=Pe(X+1),!(Rt[0]===Rt[1]||Rt[0]===void 0||Rt[1]===void 0)&&(It=Mt[X],Yt=zt(It,(Rt[1]-Rt[0])*(ke[1]-ke[0])),me.fillStyle="rgba("+Yt.join(",")+")",me.fillRect(Rt[0]+ar,ke[0]+Vr,Rt[1]-Rt[0]-I,ke[1]-ke[0]-D))}De=Math.round(De/Ie),Ge=Math.round(Ge/Ie),ht=Math.round(ht/Ie);var nn=g("rgb("+De+","+Ge+","+ht+")");w._hmpixcount=(w._hmpixcount||0)+Ie,w._hmlumcount=(w._hmlumcount||0)+Ie*nn.getLuminance();var jr=k.selectAll("image").data(T);jr.enter().append("svg:image").attr({xmlns:i.svg,preserveAspectRatio:"none"}),jr.attr({height:oe,width:ae,x:q,y:$,"xlink:href":ge.toDataURL("image/png")}),y(k);var at=z.texttemplate;if(at){var $t=c(z),Zt={type:"linear",range:[$t.min,$t.max],_separators:u._separators,_numFormat:u._numFormat},ur=z.type==="histogram2dcontour",wr=z.type==="contour",$e=wr?1:0,Je=wr?Y-1:Y,it=wr?1:0,lt=wr?re-1:re,Tt=[];for(X=$e;X<Je;X++){var Bt;if(wr)Bt=P.y[X];else if(ur){if(X===0||X===Y-1)continue;Bt=P.y[X]}else if(P.yCenter)Bt=P.yCenter[X];else{if(X+1===Y&&P.y[X+1]===void 0)continue;Bt=(P.y[X]+P.y[X+1])/2}var Ce=Math.round(L.c2p(Bt));if(!(0>Ce||Ce>L._length))for(Q=it;Q<lt;Q++){var Me;if(wr)Me=P.x[Q];else if(ur){if(Q===0||Q===re-1)continue;Me=P.x[Q]}else if(P.xCenter)Me=P.xCenter[Q];else{if(Q+1===re&&P.x[Q+1]===void 0)continue;Me=(P.x[Q]+P.x[Q+1])/2}var nt=Math.round(u.c2p(Me));if(!(0>nt||nt>u._length)){var st=r({x:Me,y:Bt},z,w._fullLayout);st.x=Me,st.y=Bt;var ct=P.z[X][Q];ct===void 0?(st.z="",st.zLabel=""):(st.z=ct,st.zLabel=e.tickText(Zt,ct,"hover").text);var At=P.text&&P.text[X]&&P.text[X][Q];(At===void 0||At===!1)&&(At=""),st.text=At;var dt=a.texttemplateString(at,st,w._fullLayout._d3locale,st,z._meta||{});if(!!dt){var Ct=dt.split("<br>"),Gt=Ct.length,rr=0;for(ie=0;ie<Gt;ie++)rr=Math.max(rr,Ct[ie].length);Tt.push({l:Gt,c:rr,t:dt,x:nt,y:Ce,z:ct})}}}}var kr=z.textfont,br=kr.family,Ar=kr.size,Wr=w._fullLayout.font.size;if(!Ar||Ar==="auto"){var nr=1/0,yr=1/0,Pr=0,Or=0;for(ie=0;ie<Tt.length;ie++){var Sr=Tt[ie];if(Pr=Math.max(Pr,Sr.l),Or=Math.max(Or,Sr.c),ie<Tt.length-1){var tt=Tt[ie+1],Lt=Math.abs(tt.x-Sr.x),Wt=Math.abs(tt.y-Sr.y);Lt&&(nr=Math.min(nr,Lt)),Wt&&(yr=Math.min(yr,Wt))}}!isFinite(nr)||!isFinite(yr)?Ar=Wr:(nr-=I,yr-=D,nr/=Or,yr/=Pr,nr/=p/2,yr/=p,Ar=Math.min(Math.floor(nr),Math.floor(yr),Wr))}if(Ar<=0||!isFinite(Ar))return;var ir=function(Er){return Er.x},Ir=function(Er){return Er.y-Ar*(Er.l*p/2-1)},Br=f(k).data(Tt);Br.enter().append("g").classed(v,1).append("text").attr("text-anchor","middle").each(function(Er){var _r=A.select(this),Gr=kr.color;(!Gr||Gr==="auto")&&(Gr=t.contrast("rgba("+Ee(Er.z).join()+")")),_r.attr("data-notex",1).call(n.positionText,ir(Er),Ir(Er)).call(M.font,br,Ar,Gr).text(Er.t).call(n.convertToTspans,w)})}})};function o(w,_){var h=_.length-2,b=a.constrain(a.findBin(w,_),0,h),u=_[b],L=_[b+1],T=a.constrain(b+(w-u)/(L-u)-.5,0,h),k=Math.round(T),P=Math.abs(T-k);return!T||T===h||!P?{bin0:k,bin1:k,frac:0}:{bin0:k,frac:P,bin1:Math.round(k+P/(T-k))}}function m(w,_){var h=_.length-1,b=a.constrain(a.findBin(w,_),0,h),u=_[b],L=_[b+1],T=(w-u)/(L-u)||0;return T<=0?{bin0:b,bin1:b,frac:0}:T<.5?{bin0:b,bin1:b+1,frac:T}:{bin0:b+1,bin1:b,frac:1-T}}function l(w,_,h){w[_]=h[0],w[_+1]=h[1],w[_+2]=h[2],w[_+3]=Math.round(h[3]*255)}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"../../constants/alignment":483,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../scatter/format_labels":945,"@plotly/d3":58,tinycolor2:313}],814:[function(d,ee,te){var A=d("@plotly/d3");ee.exports=function(S){A.select(S).selectAll(".hm image").style("opacity",function(M){return M.trace.opacity})}},{"@plotly/d3":58}],815:[function(d,ee,te){ee.exports=function(g,S,M){var e=M("zsmooth");e===!1&&(M("xgap"),M("ygap")),M("zhoverformat")}},{}],816:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib"),S=d("../../registry");ee.exports=function(n,r,t,c,s,i){var x=t("z");s=s||"x",i=i||"y";var p,v;if(x===void 0||!x.length)return 0;if(g.isArray1D(n.z)){p=t(s),v=t(i);var f=g.minRowLength(p),y=g.minRowLength(v);if(f===0||y===0)return 0;r._length=Math.min(f,y,x.length)}else{if(p=M(s,t),v=M(i,t),!e(x))return 0;t("transpose"),r._length=null}if(n.type==="heatmapgl")return!0;var o=S.getComponentMethod("calendars","handleTraceDefaults");return o(n,r,[s,i],c),!0};function M(a,n){var r=n(a),t=r?n(a+"type","array"):"scaled";return t==="scaled"&&(n(a+"0"),n("d"+a)),r}function e(a){for(var n=!0,r=!1,t=!1,c,s=0;s<a.length;s++){if(c=a[s],!g.isArrayOrTypedArray(c)){n=!1;break}c.length>0&&(r=!0);for(var i=0;i<c.length;i++)if(A(c[i])){t=!0;break}}return n&&r&&t}},{"../../lib":515,"../../registry":647,"fast-isnumeric":190}],817:[function(d,ee,te){for(var A=d("../heatmap/attributes"),g=d("../../components/colorscale/attributes"),S=d("../../lib/extend").extendFlat,M=d("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],a={},n=0;n<e.length;n++){var r=e[n];a[r]=A[r]}a.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},S(a,g("",{cLetter:"z",autoColorDflt:!1})),ee.exports=M(a,"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../heatmap/attributes":801}],818:[function(d,ee,te){var A=d("../../../stackgl_modules").gl_heatmap2d,g=d("../../plots/cartesian/axes"),S=d("../../lib/str2rgbarray");function M(r,t){this.scene=r,this.uid=t,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=A(r.glplot,this.options),this.heatmap._trace=this}var e=M.prototype;e.handlePick=function(r){var t=this.options,c=t.shape,s=r.pointId,i=s%c[0],x=Math.floor(s/c[0]),p=s;return{trace:this,dataCoord:r.dataCoord,traceCoord:[t.x[i],t.y[x],t.z[p]],textLabel:this.textLabels[s],name:this.name,pointIndex:[x,i],hoverinfo:this.hoverinfo}},e.update=function(r,t){var c=t[0];this.index=r.index,this.name=r.name,this.hoverinfo=r.hoverinfo;var s=c.z;this.options.z=[].concat.apply([],s);var i=s[0].length,x=s.length;this.options.shape=[i,x],this.options.x=c.x,this.options.y=c.y,this.options.zsmooth=r.zsmooth;var p=a(r);this.options.colorLevels=p.colorLevels,this.options.colorValues=p.colorValues,this.textLabels=[].concat.apply([],r.text),this.heatmap.update(this.options);var v=this.scene.xaxis,f=this.scene.yaxis,y,o;r.zsmooth===!1&&(y={ppad:c.x[1]-c.x[0]},o={ppad:c.y[1]-c.y[0]}),r._extremes[v._id]=g.findExtremes(v,c.x,y),r._extremes[f._id]=g.findExtremes(f,c.y,o)},e.dispose=function(){this.heatmap.dispose()};function a(r){for(var t=r.colorscale,c=r.zmin,s=r.zmax,i=t.length,x=new Array(i),p=new Array(4*i),v=0;v<i;v++){var f=t[v],y=S(f[1]);x[v]=c+f[0]*(s-c);for(var o=0;o<4;o++)p[4*v+o]=y[o]}return{colorLevels:x,colorValues:p}}function n(r,t,c){var s=new M(r,t.uid);return s.update(t,c),s}ee.exports=n},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566}],819:[function(d,ee,te){var A=d("../../lib"),g=d("../heatmap/xyz_defaults"),S=d("../../components/colorscale/defaults"),M=d("./attributes");ee.exports=function(a,n,r,t){function c(i,x){return A.coerce(a,n,M,i,x)}var s=g(a,n,c,t);if(!s){n.visible=!1;return}c("text"),c("zsmooth"),S(a,n,t,c,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/xyz_defaults":816,"./attributes":817}],820:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../heatmap/colorbar"),calc:d("../heatmap/calc"),plot:d("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:d("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":605,"../heatmap/calc":802,"../heatmap/colorbar":804,"./attributes":817,"./convert":818,"./defaults":819}],821:[function(d,ee,te){var A=d("../bar/attributes"),g=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../../plots/template_attributes").texttemplateAttrs,e=d("../../plots/font_attributes"),a=d("./bin_attributes"),n=d("./constants"),r=d("../../lib/extend").extendFlat;ee.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:g("x"),yhoverformat:g("y"),text:r({},A.text,{}),hovertext:r({},A.hovertext,{}),orientation:A.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:a("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:a("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:S({},{keys:n.eventDataKeys}),texttemplate:M({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:r({},A.textposition,{arrayOk:!1}),textfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:A.insidetextanchor,textangle:A.textangle,cliponaxis:A.cliponaxis,constraintext:A.constraintext,marker:A.marker,offsetgroup:A.offsetgroup,alignmentgroup:A.alignmentgroup,selected:A.selected,unselected:A.unselected,_deprecated:{bardir:A._deprecated.bardir}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../bar/attributes":657,"./bin_attributes":823,"./constants":827}],822:[function(d,ee,te){ee.exports=function(g,S){for(var M=g.length,e=0,a=0;a<M;a++)S[a]?(g[a]/=S[a],e+=g[a]):g[a]=null;return e}},{}],823:[function(d,ee,te){ee.exports=function(g,S){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],824:[function(d,ee,te){var A=d("fast-isnumeric");ee.exports={count:function(g,S,M){return M[g]++,1},sum:function(g,S,M,e){var a=e[S];return A(a)?(a=Number(a),M[g]+=a,a):0},avg:function(g,S,M,e,a){var n=e[S];return A(n)&&(n=Number(n),M[g]+=n,a[g]++),0},min:function(g,S,M,e){var a=e[S];if(A(a))if(a=Number(a),A(M[g])){if(M[g]>a){var n=a-M[g];return M[g]=a,n}}else return M[g]=a,a;return 0},max:function(g,S,M,e){var a=e[S];if(A(a))if(a=Number(a),A(M[g])){if(M[g]<a){var n=a-M[g];return M[g]=a,n}}else return M[g]=a,a;return 0}}},{"fast-isnumeric":190}],825:[function(d,ee,te){var A=d("../../constants/numerical"),g=A.ONEAVGYEAR,S=A.ONEAVGMONTH,M=A.ONEDAY,e=A.ONEHOUR,a=A.ONEMIN,n=A.ONESEC,r=d("../../plots/cartesian/axes").tickIncrement;ee.exports=function(p,v,f,y,o){var m=-1.1*v,l=-.1*v,w=p-l,_=f[0],h=f[1],b=Math.min(t(_+l,_+w,y,o),t(h+l,h+w,y,o)),u=Math.min(t(_+m,_+l,y,o),t(h+m,h+l,y,o)),L,T;if(b>u&&u<Math.abs(h-_)/4e3?(L=b,T=!1):(L=Math.min(b,u),T=!0),y.type==="date"&&L>M){var k=L===g?1:6,P=L===g?"M12":"M1";return function(z,I){var D=y.c2d(z,g,o),R=D.indexOf("-",k);R>0&&(D=D.substr(0,R));var O=y.d2c(D,0,o);if(O<z){var F=r(O,P,!1,o);(O+F)/2<z+p&&(O=F)}return I&&T?r(O,P,!0,o):O}}return function(z,I){var D=L*Math.round(z/L);return D+L/10<z&&D+L*.9<z+p&&(D+=L),I&&T&&(D-=L),D}};function t(x,p,v,f){if(x*p<=0)return 1/0;for(var y=Math.abs(p-x),o=v.type==="date",m=c(y,o),l=0;l<10;l++){var w=c(m*80,o);if(m===w)break;if(s(w,x,p,o,v,f))m=w;else break}return m}function c(x,p){return p&&x>n?x>M?x>g*1.1?g:x>S*1.1?S:M:x>e?e:x>a?a:n:Math.pow(10,Math.floor(Math.log(x)/Math.LN10))}function s(x,p,v,f,y,o){if(f&&x>M){var m=i(p,y,o),l=i(v,y,o),w=x===g?0:1;return m[w]!==l[w]}return Math.floor(v/x)-Math.floor(p/x)>.1}function i(x,p,v){var f=p.c2d(x,g,v).split("-");return f[0]===""&&(f.unshift(),f[0]="-"+f[0]),f}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566}],826:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib"),S=d("../../registry"),M=d("../../plots/cartesian/axes"),e=d("../bar/arrays_to_calcdata"),a=d("./bin_functions"),n=d("./norm_functions"),r=d("./average"),t=d("./bin_label_vals");function c(v,f){var y=[],o=[],m=f.orientation==="h",l=M.getFromId(v,m?f.yaxis:f.xaxis),w=m?"y":"x",_={x:"y",y:"x"}[w],h=f[w+"calendar"],b=f.cumulative,u,L=s(v,f,l,w),T=L[0],k=L[1],P=typeof T.size=="string",z=[],I=P?z:T,D=[],R=[],O=[],F=0,N=f.histnorm,G=f.histfunc,K=N.indexOf("density")!==-1,W,Y,re;b.enabled&&K&&(N=N.replace(/ ?density$/,""),K=!1);var ue=G==="max"||G==="min",j=ue?null:0,q=a.count,V=n[N],U=!1,$=function(Ne){return l.r2c(Ne,0,h)},ne;for(g.isArrayOrTypedArray(f[_])&&G!=="count"&&(ne=f[_],U=G==="avg",q=a[G]),u=$(T.start),Y=$(T.end)+(u-M.tickIncrement(u,T.size,!1,h))/1e6;u<Y&&y.length<1e6&&(W=M.tickIncrement(u,T.size,!1,h),y.push((u+W)/2),o.push(j),O.push([]),z.push(u),K&&D.push(1/(W-u)),U&&R.push(0),!(W<=u));)u=W;z.push(u),!P&&l.type==="date"&&(I={start:$(I.start),end:$(I.end),size:I.size}),v._fullLayout._roundFnOpts||(v._fullLayout._roundFnOpts={});var X=f["_"+w+"bingroup"],Q={leftGap:1/0,rightGap:1/0};X&&(v._fullLayout._roundFnOpts[X]||(v._fullLayout._roundFnOpts[X]=Q),Q=v._fullLayout._roundFnOpts[X]);var ie=o.length,se=!0,ae=Q.leftGap,oe=Q.rightGap,be={};for(u=0;u<k.length;u++){var ce=k[u];re=g.findBin(ce,I),re>=0&&re<ie&&(F+=q(re,u,o,ne,R),se&&O[re].length&&ce!==k[O[re][0]]&&(se=!1),O[re].push(u),be[u]=re,ae=Math.min(ae,ce-z[re]),oe=Math.min(oe,z[re+1]-ce))}Q.leftGap=ae,Q.rightGap=oe;var de;se||(de=function(Ne,we){return function(){var ke=v._fullLayout._roundFnOpts[X];return t(ke.leftGap,ke.rightGap,z,l,h)(Ne,we)}}),U&&(F=r(o,R)),V&&V(o,F,D),b.enabled&&p(o,b.direction,b.currentbin);var ye=Math.min(y.length,o.length),ge=[],me=0,Ee=ye-1;for(u=0;u<ye;u++)if(o[u]){me=u;break}for(u=ye-1;u>=me;u--)if(o[u]){Ee=u;break}for(u=me;u<=Ee;u++)if(A(y[u])&&A(o[u])){var Pe={p:y[u],s:o[u],b:0};b.enabled||(Pe.pts=O[u],se?Pe.ph0=Pe.ph1=O[u].length?k[O[u][0]]:y[u]:(f._computePh=!0,Pe.ph0=de(z[u]),Pe.ph1=de(z[u+1],!0))),ge.push(Pe)}return ge.length===1&&(ge[0].width1=M.tickIncrement(ge[0].p,T.size,!1,h)-ge[0].p),e(ge,f),g.isArrayOrTypedArray(f.selectedpoints)&&g.tagSelected(ge,f,be),ge}function s(v,f,y,o,m){var l=o+"bins",w=v._fullLayout,_=f["_"+o+"bingroup"],h=w._histogramBinOpts[_],b=w.barmode==="overlay",u,L,T,k,P,z,I,D=function(ce){return y.r2c(ce,0,k)},R=function(ce){return y.c2r(ce,0,k)},O=y.type==="date"?function(ce){return ce||ce===0?g.cleanDate(ce,null,k):null}:function(ce){return A(ce)?Number(ce):null};function F(ce,de,ye){de[ce+"Found"]?(de[ce]=O(de[ce]),de[ce]===null&&(de[ce]=ye[ce])):(z[ce]=de[ce]=ye[ce],g.nestedProperty(L[0],l+"."+ce).set(ye[ce]))}if(f["_"+o+"autoBinFinished"])delete f["_"+o+"autoBinFinished"];else{L=h.traces;var N=[],G=!0,K=!1,W=!1;for(u=0;u<L.length;u++)if(T=L[u],T.visible){var Y=h.dirs[u];P=T["_"+Y+"pos0"]=y.makeCalcdata(T,Y),N=g.concat(N,P),delete T["_"+o+"autoBinFinished"],f.visible===!0&&(G?G=!1:(delete T._autoBin,T["_"+o+"autoBinFinished"]=1),S.traceIs(T,"2dMap")&&(K=!0),T.type==="histogram2dcontour"&&(W=!0))}k=L[0][o+"calendar"];var re=M.autoBin(N,y,h.nbins,K,k,h.sizeFound&&h.size),ue=L[0]._autoBin={};if(z=ue[h.dirs[0]]={},W&&(h.size||(re.start=R(M.tickIncrement(D(re.start),re.size,!0,k))),h.end===void 0&&(re.end=R(M.tickIncrement(D(re.end),re.size,!1,k)))),b&&!S.traceIs(f,"2dMap")&&re._dataSpan===0&&y.type!=="category"&&y.type!=="multicategory"){if(m)return[re,P,!0];re=i(v,f,y,o,l)}I=T.cumulative||{},I.enabled&&I.currentbin!=="include"&&(I.direction==="decreasing"?re.start=R(M.tickIncrement(D(re.start),re.size,!0,k)):re.end=R(M.tickIncrement(D(re.end),re.size,!1,k))),h.size=re.size,h.sizeFound||(z.size=re.size,g.nestedProperty(L[0],l+".size").set(re.size)),F("start",h,re),F("end",h,re)}P=f["_"+o+"pos0"],delete f["_"+o+"pos0"];var j=f._input[l]||{},q=g.extendFlat({},h),V=h.start,U=y.r2l(j.start),$=U!==void 0;if((h.startFound||$)&&U!==y.r2l(V)){var ne=$?U:g.aggNums(Math.min,null,P),X={type:y.type==="category"||y.type==="multicategory"?"linear":y.type,r2l:y.r2l,dtick:h.size,tick0:V,calendar:k,range:[ne,M.tickIncrement(ne,h.size,!1,k)].map(y.l2r)},Q=M.tickFirst(X);Q>y.r2l(ne)&&(Q=M.tickIncrement(Q,h.size,!0,k)),q.start=y.l2r(Q),$||g.nestedProperty(f,l+".start").set(q.start)}var ie=h.end,se=y.r2l(j.end),ae=se!==void 0;if((h.endFound||ae)&&se!==y.r2l(ie)){var oe=ae?se:g.aggNums(Math.max,null,P);q.end=y.l2r(oe),ae||g.nestedProperty(f,l+".start").set(q.end)}var be="autobin"+o;return f._input[be]===!1&&(f._input[l]=g.extendFlat({},f[l]||{}),delete f._input[be],delete f[be]),[q,P]}function i(v,f,y,o,m){var l=v._fullLayout,w=x(v,f),_=!1,h=1/0,b=[f],u,L,T;for(u=0;u<w.length;u++)if(L=w[u],L===f)_=!0;else if(!_)T=l._histogramBinOpts[L["_"+o+"bingroup"]],h=Math.min(h,T.size||L[m].size);else{var k=s(v,L,y,o,!0),P=k[0],z=k[2];L["_"+o+"autoBinFinished"]=1,L["_"+o+"pos0"]=k[1],z?b.push(L):h=Math.min(h,P.size)}var I=new Array(b.length);for(u=0;u<b.length;u++)for(var D=b[u]["_"+o+"pos0"],R=0;R<D.length;R++)if(D[R]!==void 0){I[u]=D[R];break}for(isFinite(h)||(h=g.distinctVals(I).minDiff),u=0;u<b.length;u++){L=b[u];var O=L[o+"calendar"],F={start:y.c2r(I[u]-h/2,0,O),end:y.c2r(I[u]+h/2,0,O),size:h};L._input[m]=L[m]=F,T=l._histogramBinOpts[L["_"+o+"bingroup"]],T&&g.extendFlat(T,F)}return f[m]}function x(v,f){for(var y=f.xaxis,o=f.yaxis,m=f.orientation,l=[],w=v._fullData,_=0;_<w.length;_++){var h=w[_];h.type==="histogram"&&h.visible===!0&&h.orientation===m&&h.xaxis===y&&h.yaxis===o&&l.push(h)}return l}function p(v,f,y){var o,m,l;function w(h){l=v[h],v[h]/=2}function _(h){m=v[h],v[h]=l+m/2,l+=m}if(y==="half")if(f==="increasing")for(w(0),o=1;o<v.length;o++)_(o);else for(w(v.length-1),o=v.length-2;o>=0;o--)_(o);else if(f==="increasing"){for(o=1;o<v.length;o++)v[o]+=v[o-1];y==="exclude"&&(v.unshift(0),v.pop())}else{for(o=v.length-2;o>=0;o--)v[o]+=v[o+1];y==="exclude"&&(v.push(0),v.shift())}}ee.exports={calc:c,calcAllAutoBins:s}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"../bar/arrays_to_calcdata":656,"./average":822,"./bin_functions":824,"./bin_label_vals":825,"./norm_functions":833,"fast-isnumeric":190}],827:[function(d,ee,te){ee.exports={eventDataKeys:["binNumber"]}},{}],828:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axis_ids"),S=d("../../registry").traceIs,M=d("../bar/defaults").handleGroupingDefaults,e=A.nestedProperty,a=d("../../plots/cartesian/constraints").getAxisGroup,n=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],r=["x","y"];ee.exports=function(c,s){var i=s._histogramBinOpts={},x=[],p={},v=[],f,y,o,m,l,w,_;function h(W,Y){return A.coerce(f._input,f,f._module.attributes,W,Y)}function b(W){return W.orientation==="v"?"x":"y"}function u(W,Y){var re=g.getFromTrace({_fullLayout:s},W,Y);return re.type}function L(W,Y,re){var ue=W.uid+"__"+re;Y||(Y=ue);var j=u(W,re),q=W[re+"calendar"]||"",V=i[Y],U=!0;V&&(j===V.axType&&q===V.calendar?(U=!1,V.traces.push(W),V.dirs.push(re)):(Y=ue,j!==V.axType&&A.warn(["Attempted to group the bins of trace",W.index,"set on a","type:"+j,"axis","with bins on","type:"+V.axType,"axis."].join(" ")),q!==V.calendar&&A.warn(["Attempted to group the bins of trace",W.index,"set with a",q,"calendar","with bins",V.calendar?"on a "+V.calendar+" calendar":"w/o a set calendar"].join(" ")))),U&&(i[Y]={traces:[W],dirs:[re],axType:j,calendar:W[re+"calendar"]||""}),W["_"+re+"bingroup"]=Y}for(l=0;l<c.length;l++)f=c[l],S(f,"histogram")&&(x.push(f),delete f._xautoBinFinished,delete f._yautoBinFinished,S(f,"2dMap")||M(f._input,f,s,h));var T=s._alignmentOpts||{};for(l=0;l<x.length;l++){if(f=x[l],o="",!S(f,"2dMap")){if(m=b(f),s.barmode==="group"&&f.alignmentgroup){var k=f[m+"axis"],P=a(s,k)+f.orientation;(T[P]||{})[f.alignmentgroup]&&(o=P)}!o&&s.barmode!=="overlay"&&(o=a(s,f.xaxis)+a(s,f.yaxis)+b(f))}o?(p[o]||(p[o]=[]),p[o].push(f)):v.push(f)}for(o in p){if(y=p[o],y.length===1){v.push(y[0]);continue}var z=!1;for(y.length&&(f=y[0],z=h("bingroup")),o=z||o,l=0;l<y.length;l++){f=y[l];var I=f._input.bingroup;I&&I!==o&&A.warn(["Trace",f.index,"must match","within bingroup",o+".","Ignoring its bingroup:",I,"setting."].join(" ")),f.bingroup=o,L(f,o,b(f))}}for(l=0;l<v.length;l++){f=v[l];var D=h("bingroup");if(S(f,"2dMap"))for(_=0;_<2;_++){m=r[_];var R=h(m+"bingroup",D?D+"__"+m:null);L(f,R,m)}else L(f,D,b(f))}for(o in i){var O=i[o];for(y=O.traces,w=0;w<n.length;w++){var F=n[w],N=F.name,G,K;if(!(N==="nbins"&&O.sizeFound)){for(l=0;l<y.length;l++){if(f=y[l],m=O.dirs[l],G=F.aStr[m],e(f._input,G).get()!==void 0){O[N]=h(G),O[N+"Found"]=!0;break}K=(f._autoBin||{})[m]||{},K[N]&&e(f,G).set(K[N])}if(N==="start"||N==="end")for(;l<y.length;l++)f=y[l],f["_"+m+"bingroup"]&&(K=(f._autoBin||{})[m]||{},h(G,K[N]));N==="nbins"&&!O.sizeFound&&!O.nbinsFound&&(f=y[0],O[N]=h(G))}}}}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/cartesian/constraints":574,"../../registry":647,"../bar/defaults":661}],829:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib"),S=d("../../components/color"),M=d("../bar/defaults").handleText,e=d("../bar/style_defaults"),a=d("./attributes");ee.exports=function(r,t,c,s){function i(u,L){return g.coerce(r,t,a,u,L)}var x=i("x"),p=i("y"),v=i("cumulative.enabled");v&&(i("cumulative.direction"),i("cumulative.currentbin")),i("text");var f=i("textposition");M(r,t,s,i,f,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),i("hovertext"),i("hovertemplate"),i("xhoverformat"),i("yhoverformat");var y=i("orientation",p&&!x?"h":"v"),o=y==="v"?"x":"y",m=y==="v"?"y":"x",l=x&&p?Math.min(g.minRowLength(x)&&g.minRowLength(p)):g.minRowLength(t[o]||[]);if(!l){t.visible=!1;return}t._length=l;var w=A.getComponentMethod("calendars","handleTraceDefaults");w(r,t,["x","y"],s);var _=t[m];_&&i("histfunc"),i("histnorm"),i("autobin"+o),e(r,t,i,c,s),g.coerceSelectionMarkerOpacity(t,i);var h=(t.marker.line||{}).color,b=A.getComponentMethod("errorbars","supplyDefaults");b(r,t,h||S.defaultLine,{axis:"y"}),b(r,t,h||S.defaultLine,{axis:"x",inherit:"y"})}},{"../../components/color":367,"../../lib":515,"../../registry":647,"../bar/defaults":661,"../bar/style_defaults":672,"./attributes":821}],830:[function(d,ee,te){ee.exports=function(g,S,M,e,a){if(g.x="xVal"in S?S.xVal:S.x,g.y="yVal"in S?S.yVal:S.y,"zLabelVal"in S&&(g.z=S.zLabelVal),S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),!(M.cumulative||{}).enabled){var n=Array.isArray(a)?e[0].pts[a[0]][a[1]]:e[a].pts;g.pointNumbers=n,g.binNumber=g.pointNumber,delete g.pointNumber,delete g.pointIndex;var r;if(M._indexToPoints){r=[];for(var t=0;t<n.length;t++)r=r.concat(M._indexToPoints[n[t]])}else r=n;g.pointIndices=r}return g}},{}],831:[function(d,ee,te){var A=d("../bar/hover").hoverPoints,g=d("../../plots/cartesian/axes").hoverLabelText;ee.exports=function(M,e,a,n,r){var t=A(M,e,a,n,r);if(!!t){M=t[0];var c=M.cd[M.index],s=M.cd[0].trace;if(!s.cumulative.enabled){var i=s.orientation==="h"?"y":"x";M[i+"Label"]=g(M[i+"a"],[c.ph0,c.ph1],s[i+"hoverformat"])}return t}}},{"../../plots/cartesian/axes":566,"../bar/hover":664}],832:[function(d,ee,te){ee.exports={attributes:d("./attributes"),layoutAttributes:d("../bar/layout_attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("./cross_trace_defaults"),supplyLayoutDefaults:d("../bar/layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("../bar/cross_trace_calc").crossTraceCalc,plot:d("../bar/plot").plot,layerName:"barlayer",style:d("../bar/style").style,styleOnSelect:d("../bar/style").styleOnSelect,colorbar:d("../scatter/marker_colorbar"),hoverPoints:d("./hover"),selectPoints:d("../bar/select"),eventData:d("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:d("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../bar/cross_trace_calc":660,"../bar/layout_attributes":666,"../bar/layout_defaults":667,"../bar/plot":668,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"./attributes":821,"./calc":826,"./cross_trace_defaults":828,"./defaults":829,"./event_data":830,"./hover":831}],833:[function(d,ee,te){ee.exports={percent:function(A,g){for(var S=A.length,M=100/g,e=0;e<S;e++)A[e]*=M},probability:function(A,g){for(var S=A.length,M=0;M<S;M++)A[M]/=g},density:function(A,g,S,M){var e=A.length;M=M||1;for(var a=0;a<e;a++)A[a]*=S[a]*M},"probability density":function(A,g,S,M){var e=A.length;M&&(g/=M);for(var a=0;a<e;a++)A[a]*=S[a]/g}}},{}],834:[function(d,ee,te){var A=d("../histogram/attributes"),g=d("../histogram/bin_attributes"),S=d("../heatmap/attributes"),M=d("../../plots/attributes"),e=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,a=d("../../plots/template_attributes").hovertemplateAttrs,n=d("../../plots/template_attributes").texttemplateAttrs,r=d("../../components/colorscale/attributes"),t=d("../../lib/extend").extendFlat;ee.exports=t({x:A.x,y:A.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:A.histnorm,histfunc:A.histfunc,nbinsx:A.nbinsx,xbins:g("x"),nbinsy:A.nbinsy,ybins:g("y"),autobinx:A.autobinx,autobiny:A.autobiny,bingroup:t({},A.bingroup,{}),xbingroup:t({},A.bingroup,{}),ybingroup:t({},A.bingroup,{}),xgap:S.xgap,ygap:S.ygap,zsmooth:S.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:a({},{keys:"z"}),texttemplate:n({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:S.textfont,showlegend:t({},M.showlegend,{dflt:!1})},r("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../heatmap/attributes":801,"../histogram/attributes":821,"../histogram/bin_attributes":823}],835:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axes"),S=d("../histogram/bin_functions"),M=d("../histogram/norm_functions"),e=d("../histogram/average"),a=d("../histogram/bin_label_vals"),n=d("../histogram/calc").calcAllAutoBins;ee.exports=function(i,x){var p=g.getFromId(i,x.xaxis),v=g.getFromId(i,x.yaxis),f=x.xcalendar,y=x.ycalendar,o=function(Ye){return p.r2c(Ye,0,f)},m=function(Ye){return v.r2c(Ye,0,y)},l=function(Ye){return p.c2r(Ye,0,f)},w=function(Ye){return v.c2r(Ye,0,y)},_,h,b,u,L=n(i,x,p,"x"),T=L[0],k=L[1],P=n(i,x,v,"y"),z=P[0],I=P[1],D=x._length;k.length>D&&k.splice(D,k.length-D),I.length>D&&I.splice(D,I.length-D);var R=[],O=[],F=[],N=typeof T.size=="string",G=typeof z.size=="string",K=[],W=[],Y=N?K:T,re=G?W:z,ue=0,j=[],q=[],V=x.histnorm,U=x.histfunc,$=V.indexOf("density")!==-1,ne=U==="max"||U==="min",X=ne?null:0,Q=S.count,ie=M[V],se=!1,ae=[],oe=[],be="z"in x?x.z:"marker"in x&&Array.isArray(x.marker.color)?x.marker.color:"";be&&U!=="count"&&(se=U==="avg",Q=S[U]);var ce=T.size,de=o(T.start),ye=o(T.end)+(de-g.tickIncrement(de,ce,!1,f))/1e6;for(_=de;_<ye;_=g.tickIncrement(_,ce,!1,f))O.push(X),K.push(_),se&&F.push(0);K.push(_);var ge=O.length,me=(_-de)/ge,Ee=l(de+me/2),Pe=z.size,Ne=m(z.start),we=m(z.end)+(Ne-g.tickIncrement(Ne,Pe,!1,y))/1e6;for(_=Ne;_<we;_=g.tickIncrement(_,Pe,!1,y)){R.push(O.slice()),W.push(_);var ke=new Array(ge);for(h=0;h<ge;h++)ke[h]=[];q.push(ke),se&&j.push(F.slice())}W.push(_);var Xe=R.length,He=(_-Ne)/Xe,Ie=w(Ne+He/2);$&&(ae=r(O.length,Y,me,N),oe=r(R.length,re,He,G)),!N&&p.type==="date"&&(Y=t(o,Y)),!G&&v.type==="date"&&(re=t(m,re));var De=!0,Ge=!0,ht=new Array(ge),Rt=new Array(Xe),Kt=1/0,It=1/0,Mt=1/0,Yt=1/0;for(_=0;_<D;_++){var zt=k[_],St=I[_];b=A.findBin(zt,Y),u=A.findBin(St,re),b>=0&&b<ge&&u>=0&&u<Xe&&(ue+=Q(b,_,R[u],be,j[u]),q[u][b].push(_),De&&(ht[b]===void 0?ht[b]=zt:ht[b]!==zt&&(De=!1)),Ge&&(Rt[u]===void 0?Rt[u]=St:Rt[u]!==St&&(Ge=!1)),Kt=Math.min(Kt,zt-K[b]),It=Math.min(It,K[b+1]-zt),Mt=Math.min(Mt,St-W[u]),Yt=Math.min(Yt,W[u+1]-St))}if(se)for(u=0;u<Xe;u++)ue+=e(R[u],j[u]);if(ie)for(u=0;u<Xe;u++)ie(R[u],ue,ae,oe[u]);return{x:k,xRanges:c(K,De&&ht,Kt,It,p,f),x0:Ee,dx:me,y:I,yRanges:c(W,Ge&&Rt,Mt,Yt,v,y),y0:Ie,dy:He,z:R,pts:q}};function r(s,i,x,p){var v=new Array(s),f;if(p)for(f=0;f<s;f++)v[f]=1/(i[f+1]-i[f]);else{var y=1/x;for(f=0;f<s;f++)v[f]=y}return v}function t(s,i){return{start:s(i.start),end:s(i.end),size:i.size}}function c(s,i,x,p,v,f){var y,o=s.length-1,m=new Array(o),l=a(x,p,s,v,f);for(y=0;y<o;y++){var w=(i||[])[y];m[y]=w===void 0?[l(s[y]),l(s[y+1],!0)]:[w,w]}return m}},{"../../lib":515,"../../plots/cartesian/axes":566,"../histogram/average":822,"../histogram/bin_functions":824,"../histogram/bin_label_vals":825,"../histogram/calc":826,"../histogram/norm_functions":833}],836:[function(d,ee,te){var A=d("../../lib"),g=d("./sample_defaults"),S=d("../heatmap/style_defaults"),M=d("../../components/colorscale/defaults"),e=d("../heatmap/label_defaults"),a=d("./attributes");ee.exports=function(r,t,c,s){function i(x,p){return A.coerce(r,t,a,x,p)}g(r,t,i,s),t.visible!==!1&&(S(r,t,i,s),M(r,t,s,i,{prefix:"",cLetter:"z"}),i("hovertemplate"),e(i,s),i("xhoverformat"),i("yhoverformat"))}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/style_defaults":815,"./attributes":834,"./sample_defaults":839}],837:[function(d,ee,te){var A=d("../heatmap/hover"),g=d("../../plots/cartesian/axes").hoverLabelText;ee.exports=function(M,e,a,n,r){var t=A(M,e,a,n,r);if(!!t){M=t[0];var c=M.index,s=c[0],i=c[1],x=M.cd[0],p=x.trace,v=x.xRanges[i],f=x.yRanges[s];return M.xLabel=g(M.xa,[v[0],v[1]],p.xhoverformat),M.yLabel=g(M.ya,[f[0],f[1]],p.yhoverformat),t}}},{"../../plots/cartesian/axes":566,"../heatmap/hover":808}],838:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("../histogram/cross_trace_defaults"),calc:d("../heatmap/calc"),plot:d("../heatmap/plot"),layerName:"heatmaplayer",colorbar:d("../heatmap/colorbar"),style:d("../heatmap/style"),hoverPoints:d("./hover"),eventData:d("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../heatmap/calc":802,"../heatmap/colorbar":804,"../heatmap/plot":813,"../heatmap/style":814,"../histogram/cross_trace_defaults":828,"../histogram/event_data":830,"./attributes":834,"./defaults":836,"./hover":837}],839:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib");ee.exports=function(M,e,a,n){var r=a("x"),t=a("y"),c=g.minRowLength(r),s=g.minRowLength(t);if(!c||!s){e.visible=!1;return}e._length=Math.min(c,s);var i=A.getComponentMethod("calendars","handleTraceDefaults");i(M,e,["x","y"],n);var x=a("z")||a("marker.color");x&&a("histfunc"),a("histnorm"),a("autobinx"),a("autobiny")}},{"../../lib":515,"../../registry":647}],840:[function(d,ee,te){var A=d("../histogram2d/attributes"),g=d("../contour/attributes"),S=d("../../components/colorscale/attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../lib/extend").extendFlat;ee.exports=e({x:A.x,y:A.y,z:A.z,marker:A.marker,histnorm:A.histnorm,histfunc:A.histfunc,nbinsx:A.nbinsx,xbins:A.xbins,nbinsy:A.nbinsy,ybins:A.ybins,autobinx:A.autobinx,autobiny:A.autobiny,bingroup:A.bingroup,xbingroup:A.xbingroup,ybingroup:A.ybingroup,autocontour:g.autocontour,ncontours:g.ncontours,contours:g.contours,line:{color:g.line.color,width:e({},g.line.width,{dflt:.5}),dash:g.line.dash,smoothing:g.line.smoothing,editType:"plot"},xhoverformat:M("x"),yhoverformat:M("y"),zhoverformat:M("z",1),hovertemplate:A.hovertemplate,texttemplate:g.texttemplate,textfont:g.textfont},S("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../contour/attributes":744,"../histogram2d/attributes":834}],841:[function(d,ee,te){var A=d("../../lib"),g=d("../histogram2d/sample_defaults"),S=d("../contour/contours_defaults"),M=d("../contour/style_defaults"),e=d("../heatmap/label_defaults"),a=d("./attributes");ee.exports=function(r,t,c,s){function i(p,v){return A.coerce(r,t,a,p,v)}function x(p){return A.coerce2(r,t,a,p)}g(r,t,i,s),t.visible!==!1&&(S(r,t,i,x),M(r,t,i,s),i("xhoverformat"),i("yhoverformat"),i("hovertemplate"),t.contours&&t.contours.coloring==="heatmap"&&e(i,s))}},{"../../lib":515,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/label_defaults":811,"../histogram2d/sample_defaults":839,"./attributes":840}],842:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("../histogram/cross_trace_defaults"),calc:d("../contour/calc"),plot:d("../contour/plot").plot,layerName:"contourlayer",style:d("../contour/style"),colorbar:d("../contour/colorbar"),hoverPoints:d("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../contour/calc":745,"../contour/colorbar":747,"../contour/hover":757,"../contour/plot":762,"../contour/style":764,"../histogram/cross_trace_defaults":828,"./attributes":840,"./defaults":841}],843:[function(d,ee,te){var A=d("../../plots/template_attributes").hovertemplateAttrs,g=d("../../plots/template_attributes").texttemplateAttrs,S=d("../../components/colorscale/attributes"),M=d("../../plots/domain").attributes,e=d("../pie/attributes"),a=d("../sunburst/attributes"),n=d("../treemap/attributes"),r=d("../treemap/constants"),t=d("../../lib/extend").extendFlat;ee.exports={labels:a.labels,parents:a.parents,values:a.values,branchvalues:a.branchvalues,count:a.count,level:a.level,maxdepth:a.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:n.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:t({colors:a.marker.colors,line:a.marker.line,editType:"calc"},S("marker",{colorAttr:"colors",anim:!1})),leaf:a.leaf,pathbar:n.pathbar,text:e.text,textinfo:a.textinfo,texttemplate:g({editType:"plot"},{keys:r.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:a.hoverinfo,hovertemplate:A({},{keys:r.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:n.outsidetextfont,textposition:n.textposition,sort:e.sort,root:a.root,domain:M({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"../treemap/attributes":1084,"../treemap/constants":1087}],844:[function(d,ee,te){var A=d("../../plots/plots");te.name="icicle",te.plot=function(g,S,M,e){A.plotBasePlot(te.name,g,S,M,e)},te.clean=function(g,S,M,e){A.cleanBasePlot(te.name,g,S,M,e)}},{"../../plots/plots":628}],845:[function(d,ee,te){var A=d("../sunburst/calc");te.calc=function(g,S){return A.calc(g,S)},te.crossTraceCalc=function(g){return A._runCrossTraceCalc("icicle",g)}},{"../sunburst/calc":1060}],846:[function(d,ee,te){var A=d("../../lib"),g=d("./attributes"),S=d("../../components/color"),M=d("../../plots/domain").defaults,e=d("../bar/defaults").handleText,a=d("../bar/constants").TEXTPAD,n=d("../../components/colorscale"),r=n.hasColorscale,t=n.handleDefaults;ee.exports=function(s,i,x,p){function v(b,u){return A.coerce(s,i,g,b,u)}var f=v("labels"),y=v("parents");if(!f||!f.length||!y||!y.length){i.visible=!1;return}var o=v("values");o&&o.length?v("branchvalues"):v("count"),v("level"),v("maxdepth"),v("tiling.orientation"),v("tiling.flip"),v("tiling.pad");var m=v("text");v("texttemplate"),i.texttemplate||v("textinfo",Array.isArray(m)?"text+label":"label"),v("hovertext"),v("hovertemplate");var l=v("pathbar.visible"),w="auto";e(s,i,p,v,w,{hasPathbar:l,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),v("textposition");var _=v("marker.line.width");_&&v("marker.line.color",p.paper_bgcolor),v("marker.colors");var h=i._hasColorscale=r(s,"marker","colors")||(s.marker||{}).coloraxis;h&&t(s,i,p,v,{prefix:"marker.",cLetter:"c"}),v("leaf.opacity",h?1:.7),i._hovered={marker:{line:{width:2,color:S.contrast(p.paper_bgcolor)}}},l&&(v("pathbar.thickness",i.pathbar.textfont.size+2*a),v("pathbar.side"),v("pathbar.edgeshape")),v("sort"),v("root.color"),M(i,p,v),i._length=null}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":843}],847:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=d("../../components/drawing"),M=d("../../lib/svg_text_utils"),e=d("./partition"),a=d("./style").styleOne,n=d("../treemap/constants"),r=d("../sunburst/helpers"),t=d("../sunburst/fx"),c=d("../sunburst/plot").formatSliceLabel,s=!1;ee.exports=function(x,p,v,f,y){var o=y.width,m=y.height,l=y.viewX,w=y.viewY,_=y.pathSlice,h=y.toMoveInsideSlice,b=y.strTransform,u=y.hasTransition,L=y.handleSlicesExit,T=y.makeUpdateSliceInterpolator,k=y.makeUpdateTextInterpolator,P=y.prevEntry,z={},I=x._context.staticPlot,D=x._fullLayout,R=p[0],O=R.trace,F=O.textposition.indexOf("left")!==-1,N=O.textposition.indexOf("right")!==-1,G=O.textposition.indexOf("bottom")!==-1,K=e(v,[o,m],{flipX:O.tiling.flip.indexOf("x")>-1,flipY:O.tiling.flip.indexOf("y")>-1,orientation:O.tiling.orientation,pad:{inner:O.tiling.pad},maxDepth:O._maxDepth}),W=K.descendants(),Y=1/0,re=-1/0;W.forEach(function(U){var $=U.depth;$>=O._maxDepth?(U.x0=U.x1=(U.x0+U.x1)/2,U.y0=U.y1=(U.y0+U.y1)/2):(Y=Math.min(Y,$),re=Math.max(re,$))}),f=f.data(W,r.getPtId),O._maxVisibleLayers=isFinite(re)?re-Y+1:0,f.enter().append("g").classed("slice",!0),L(f,s,z,[o,m],_),f.order();var ue=null;if(u&&P){var j=r.getPtId(P);f.each(function(U){ue===null&&r.getPtId(U)===j&&(ue={x0:U.x0,x1:U.x1,y0:U.y0,y1:U.y1})})}var q=function(){return ue||{x0:0,x1:o,y0:0,y1:m}},V=f;return u&&(V=V.transition().each("end",function(){var U=A.select(this);r.setSliceCursor(U,x,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),V.each(function(U){U._x0=l(U.x0),U._x1=l(U.x1),U._y0=w(U.y0),U._y1=w(U.y1),U._hoverX=l(U.x1-O.tiling.pad),U._hoverY=w(G?U.y1-O.tiling.pad/2:U.y0+O.tiling.pad/2);var $=A.select(this),ne=g.ensureSingle($,"path","surface",function(se){se.style("pointer-events",I?"none":"all")});u?ne.transition().attrTween("d",function(se){var ae=T(se,s,q(),[o,m],{orientation:O.tiling.orientation,flipX:O.tiling.flip.indexOf("x")>-1,flipY:O.tiling.flip.indexOf("y")>-1});return function(oe){return _(ae(oe))}}):ne.attr("d",_),$.call(t,v,x,p,{styleOne:a,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(r.setSliceCursor,x,{isTransitioning:x._transitioning}),ne.call(a,U,O,{hovered:!1}),U.x0===U.x1||U.y0===U.y1?U._text="":U._text=c(U,v,O,p,D)||"";var X=g.ensureSingle($,"g","slicetext"),Q=g.ensureSingle(X,"text","",function(se){se.attr("data-notex",1)}),ie=g.ensureUniformFontSize(x,r.determineTextFont(O,U,D.font));Q.text(U._text||" ").classed("slicetext",!0).attr("text-anchor",N?"end":F?"start":"middle").call(S.font,ie).call(M.convertToTspans,x),U.textBB=S.bBox(Q.node()),U.transform=h(U,{fontSize:ie.size}),U.transform.fontSize=ie.size,u?Q.transition().attrTween("transform",function(se){var ae=k(se,s,q(),[o,m]);return function(oe){return b(ae(oe))}}):Q.attr("transform",b(U))}),ue}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"../treemap/constants":1087,"./partition":851,"./style":853,"@plotly/d3":58}],848:[function(d,ee,te){ee.exports={moduleType:"trace",name:"icicle",basePlotModule:d("./base_plot"),categories:[],animatable:!0,attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot"),style:d("./style").style,colorbar:d("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":843,"./base_plot":844,"./calc":845,"./defaults":846,"./layout_attributes":849,"./layout_defaults":850,"./plot":852,"./style":853}],849:[function(d,ee,te){ee.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],850:[function(d,ee,te){var A=d("../../lib"),g=d("./layout_attributes");ee.exports=function(M,e){function a(n,r){return A.coerce(M,e,g,n,r)}a("iciclecolorway",e.colorway),a("extendiciclecolors")}},{"../../lib":515,"./layout_attributes":849}],851:[function(d,ee,te){var A=d("d3-hierarchy"),g=d("../treemap/flip_tree");ee.exports=function(M,e,a){var n=a.flipX,r=a.flipY,t=a.orientation==="h",c=a.maxDepth,s=e[0],i=e[1];c&&(s=(M.height+1)*e[0]/Math.min(M.height+1,c),i=(M.height+1)*e[1]/Math.min(M.height+1,c));var x=A.partition().padding(a.pad.inner).size(t?[e[1],s]:[e[0],i])(M);return(t||n||r)&&g(x,e,{swapXY:t,flipX:n,flipY:r}),x}},{"../treemap/flip_tree":1092,"d3-hierarchy":115}],852:[function(d,ee,te){var A=d("../treemap/draw"),g=d("./draw_descendants");ee.exports=function(M,e,a,n){return A(M,e,a,n,{type:"icicle",drawDescendants:g})}},{"../treemap/draw":1089,"./draw_descendants":847}],853:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/color"),S=d("../../lib"),M=d("../bar/uniform_text").resizeText;function e(n){var r=n._fullLayout._iciclelayer.selectAll(".trace");M(n,r,"icicle"),r.each(function(t){var c=A.select(this),s=t[0],i=s.trace;c.style("opacity",i.opacity),c.selectAll("path.surface").each(function(x){A.select(this).call(a,x,i)})})}function a(n,r,t){var c=r.data.data,s=!r.children,i=c.i,x=S.castOption(t,i,"marker.line.color")||g.defaultLine,p=S.castOption(t,i,"marker.line.width")||0;n.style("stroke-width",p).call(g.fill,c.color).call(g.stroke,x).style("opacity",s?t.leaf.opacity:null)}ee.exports={style:e,styleOne:a}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],854:[function(d,ee,te){for(var A=d("../../plots/attributes"),g=d("../../plots/template_attributes").hovertemplateAttrs,S=d("../../lib/extend").extendFlat,M=d("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],a=[],n=[],r=0;r<e.length;r++){var t=M[e[r]];a.push("For the `"+e[r]+"` colormodel, it is ["+(t.zminDflt||t.min).join(", ")+"]."),n.push("For the `"+e[r]+"` colormodel, it is ["+(t.zmaxDflt||t.max).join(", ")+"].")}ee.exports=S({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:S({},A.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:g({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"./constants":856}],855:[function(d,ee,te){var A=d("../../lib"),g=d("./constants"),S=d("fast-isnumeric"),M=d("../../plots/cartesian/axes"),e=d("../../lib").maxRowLength,a=d("./helpers").getImageSize;ee.exports=function(s,i){var x,p;if(i._hasZ)x=i.z.length,p=e(i.z);else if(i._hasSource){var v=a(i.source);x=v.height,p=v.width}var f=M.getFromId(s,i.xaxis||"x"),y=M.getFromId(s,i.yaxis||"y"),o=f.d2c(i.x0)-i.dx/2,m=y.d2c(i.y0)-i.dy/2,l,w=[o,o+p*i.dx],_=[m,m+x*i.dy];if(f&&f.type==="log")for(l=0;l<p;l++)w.push(o+l*i.dx);if(y&&y.type==="log")for(l=0;l<x;l++)_.push(m+l*i.dy);i._extremes[f._id]=M.findExtremes(f,w),i._extremes[y._id]=M.findExtremes(y,_),i._scaler=t(i);var h={x0:o,y0:m,z:i.z,w:p,h:x};return[h]};function n(c,s,i,x){return function(p){return A.constrain((p-c)*s,i,x)}}function r(c,s){return function(i){return A.constrain(i,c,s)}}function t(c){var s=g.colormodel[c.colormodel],i=s.colormodel||c.colormodel,x=i.length;c._sArray=[];for(var p=0;p<x;p++)s.min[p]!==c.zmin[p]||s.max[p]!==c.zmax[p]?c._sArray.push(n(c.zmin[p],(s.max[p]-s.min[p])/(c.zmax[p]-c.zmin[p]),s.min[p],s.max[p])):c._sArray.push(r(s.min[p],s.max[p]));return function(v){for(var f=v.slice(0,x),y=0;y<x;y++){var o=f[y];if(!S(o))return!1;f[y]=c._sArray[y](o)}return f}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":856,"./helpers":859,"fast-isnumeric":190}],856:[function(d,ee,te){ee.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(A){return A.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(A){return A.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(A){return A.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(A){var g=A.slice(0,3);return g[1]=g[1]+"%",g[2]=g[2]+"%",g},suffix:["\xB0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(A){var g=A.slice(0,4);return g[1]=g[1]+"%",g[2]=g[2]+"%",g},suffix:["\xB0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],857:[function(d,ee,te){var A=d("../../lib"),g=d("./attributes"),S=d("./constants"),M=d("../../snapshot/helpers").IMAGE_URL_PREFIX;ee.exports=function(a,n){function r(s,i){return A.coerce(a,n,g,s,i)}r("source"),n.source&&!n.source.match(M)&&delete n.source,n._hasSource=!!n.source;var t=r("z");if(n._hasZ=!(t===void 0||!t.length||!t[0]||!t[0].length),!n._hasZ&&!n._hasSource){n.visible=!1;return}r("x0"),r("y0"),r("dx"),r("dy");var c;n._hasZ?(r("colormodel","rgb"),c=S.colormodel[n.colormodel],r("zmin",c.zminDflt||c.min),r("zmax",c.zmaxDflt||c.max)):n._hasSource&&(n.colormodel="rgba256",c=S.colormodel[n.colormodel],n.zmin=c.zminDflt,n.zmax=c.zmaxDflt),r("zsmooth"),r("text"),r("hovertext"),r("hovertemplate"),n._length=null}},{"../../lib":515,"../../snapshot/helpers":651,"./attributes":854,"./constants":856}],858:[function(d,ee,te){ee.exports=function(g,S){return"xVal"in S&&(g.x=S.xVal),"yVal"in S&&(g.y=S.yVal),S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),g.color=S.color,g.colormodel=S.trace.colormodel,g.z||(g.z=S.color),g}},{}],859:[function(d,ee,te){var A=d("probe-image-size/sync"),g=d("../../snapshot/helpers").IMAGE_URL_PREFIX,S=d("buffer/").Buffer;te.getImageSize=function(M){var e=M.replace(g,""),a=new S(e,"base64");return A(a)}},{"../../snapshot/helpers":651,"buffer/":85,"probe-image-size/sync":277}],860:[function(d,ee,te){var A=d("../../components/fx"),g=d("../../lib"),S=d("./constants");ee.exports=function(e,a,n){var r=e.cd[0],t=r.trace,c=e.xa,s=e.ya;if(!(A.inbox(a-r.x0,a-(r.x0+r.w*t.dx),0)>0||A.inbox(n-r.y0,n-(r.y0+r.h*t.dy),0)>0)){var i=Math.floor((a-r.x0)/t.dx),x=Math.floor(Math.abs(n-r.y0)/t.dy),p;if(t._hasZ?p=r.z[x][i]:t._hasSource&&(p=t._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(i,x,1,1).data),!!p){var v=r.hi||t.hoverinfo,f;if(v){var y=v.split("+");y.indexOf("all")!==-1&&(y=["color"]),y.indexOf("color")!==-1&&(f=!0)}var o=S.colormodel[t.colormodel],m=o.colormodel||t.colormodel,l=m.length,w=t._scaler(p),_=o.suffix,h=[];(t.hovertemplate||f)&&(h.push("["+[w[0]+_[0],w[1]+_[1],w[2]+_[2]].join(", ")),l===4&&h.push(", "+w[3]+_[3]),h.push("]"),h=h.join(""),e.extraText=m.toUpperCase()+": "+h);var b;Array.isArray(t.hovertext)&&Array.isArray(t.hovertext[x])?b=t.hovertext[x][i]:Array.isArray(t.text)&&Array.isArray(t.text[x])&&(b=t.text[x][i]);var u=s.c2p(r.y0+(x+.5)*t.dy),L=r.x0+(i+.5)*t.dx,T=r.y0+(x+.5)*t.dy,k="["+p.slice(0,t.colormodel.length).join(", ")+"]";return[g.extendFlat(e,{index:[x,i],x0:c.c2p(r.x0+i*t.dx),x1:c.c2p(r.x0+(i+1)*t.dx),y0:u,y1:u,color:w,xVal:L,xLabelVal:L,yVal:T,yLabelVal:T,zLabelVal:k,text:b,hovertemplateLabels:{zLabel:k,colorLabel:h,"color[0]Label":w[0]+_[0],"color[1]Label":w[1]+_[1],"color[2]Label":w[2]+_[2],"color[3]Label":w[3]+_[3]}})]}}}},{"../../components/fx":407,"../../lib":515,"./constants":856}],861:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),style:d("./style"),hoverPoints:d("./hover"),eventData:d("./event_data"),moduleType:"trace",name:"image",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":578,"./attributes":854,"./calc":855,"./defaults":857,"./event_data":858,"./hover":860,"./plot":862,"./style":863}],862:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=g.strTranslate,M=d("../../constants/xmlns_namespaces"),e=d("./constants"),a=g.isIOS()||g.isSafari()||g.isIE();ee.exports=function(r,t,c,s){var i=t.xaxis,x=t.yaxis,p=!(a||r._context._exportedPlot);g.makeTraceGroups(s,c,"im").each(function(v){var f=A.select(this),y=v[0],o=y.trace,m=(o.zsmooth==="fast"||o.zsmooth===!1&&p)&&!o._hasZ&&o._hasSource&&i.type==="linear"&&x.type==="linear";o._realImage=m;var l=y.z,w=y.x0,_=y.y0,h=y.w,b=y.h,u=o.dx,L=o.dy,T,k,P,z,I,D;for(D=0;T===void 0&&D<h;)T=i.c2p(w+D*u),D++;for(D=h;k===void 0&&D>0;)k=i.c2p(w+D*u),D--;for(D=0;z===void 0&&D<b;)z=x.c2p(_+D*L),D++;for(D=b;I===void 0&&D>0;)I=x.c2p(_+D*L),D--;if(k<T&&(P=k,k=T,T=P),I<z&&(P=z,z=I,I=P),!m){var R=.5;T=Math.max(-R*i._length,T),k=Math.min((1+R)*i._length,k),z=Math.max(-R*x._length,z),I=Math.min((1+R)*x._length,I)}var O=Math.round(k-T),F=Math.round(I-z),N=O<=0||F<=0;if(N){var G=f.selectAll("image").data([]);G.exit().remove();return}function K(ne){var X=document.createElement("canvas");X.width=O,X.height=F;var Q=X.getContext("2d",{willReadFrequently:!0}),ie=function(Pe){return g.constrain(Math.round(i.c2p(w+Pe*u)-T),0,O)},se=function(Pe){return g.constrain(Math.round(x.c2p(_+Pe*L)-z),0,F)},ae=e.colormodel[o.colormodel],oe=ae.colormodel||o.colormodel,be=ae.fmt,ce;for(D=0;D<y.w;D++){var de=ie(D),ye=ie(D+1);if(!(ye===de||isNaN(ye)||isNaN(de)))for(var ge=0;ge<y.h;ge++){var me=se(ge),Ee=se(ge+1);Ee===me||isNaN(Ee)||isNaN(me)||!ne(D,ge)||(ce=o._scaler(ne(D,ge)),ce?Q.fillStyle=oe+"("+be(ce).join(",")+")":Q.fillStyle="rgba(0,0,0,0)",Q.fillRect(de,me,ye-de,Ee-me))}}return X}var W=f.selectAll("image").data([v]);W.enter().append("svg:image").attr({xmlns:M.svg,preserveAspectRatio:"none"}),W.exit().remove();var Y=o.zsmooth===!1?e.pixelatedStyle:"";if(m){var re=g.simpleMap(i.range,i.r2l),ue=g.simpleMap(x.range,x.r2l),j=re[1]<re[0],q=ue[1]>ue[0];if(j||q){var V=T+O/2,U=z+F/2;Y+="transform:"+S(V+"px",U+"px")+"scale("+(j?-1:1)+","+(q?-1:1)+")"+S(-V+"px",-U+"px")+";"}}W.attr("style",Y);var $=new Promise(function(ne){if(o._hasZ)ne();else if(o._hasSource)if(o._canvas&&o._canvas.el.width===h&&o._canvas.el.height===b&&o._canvas.source===o.source)ne();else{var X=document.createElement("canvas");X.width=h,X.height=b;var Q=X.getContext("2d",{willReadFrequently:!0});o._image=o._image||new Image;var ie=o._image;ie.onload=function(){Q.drawImage(ie,0,0),o._canvas={el:X,source:o.source},ne()},ie.setAttribute("src",o.source)}}).then(function(){var ne,X;if(o._hasZ)X=K(function(se,ae){return l[ae][se]}),ne=X.toDataURL("image/png");else if(o._hasSource)if(m)ne=o.source;else{var Q=o._canvas.el.getContext("2d",{willReadFrequently:!0}),ie=Q.getImageData(0,0,h,b).data;X=K(function(se,ae){var oe=4*(ae*h+se);return[ie[oe],ie[oe+1],ie[oe+2],ie[oe+3]]}),ne=X.toDataURL("image/png")}W.attr({"xlink:href":ne,height:F,width:O,x:T,y:z})});r._promises.push($)})}},{"../../constants/xmlns_namespaces":492,"../../lib":515,"./constants":856,"@plotly/d3":58}],863:[function(d,ee,te){var A=d("@plotly/d3");ee.exports=function(S){A.select(S).selectAll(".im image").style("opacity",function(M){return M[0].trace.opacity})}},{"@plotly/d3":58}],864:[function(d,ee,te){var A=d("../../lib/extend").extendFlat,g=d("../../lib/extend").extendDeep,S=d("../../plot_api/edit_types").overrideAll,M=d("../../plots/font_attributes"),e=d("../../components/color/attributes"),a=d("../../plots/domain").attributes,n=d("../../plots/cartesian/layout_attributes"),r=d("../../plot_api/plot_template").templatedArray,t=d("../../constants/delta.js"),c=d("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,s=M({editType:"plot",colorEditType:"plot"}),i={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},x={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},p=r("step",g({},i,{range:x}));ee.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:a({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:A({},s,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:c("value")},font:A({},s,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:c("value")},increasing:{symbol:{valType:"string",dflt:t.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:t.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:t.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:t.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:A({},s,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:g({},i,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:S({range:x,visible:A({},n.visible,{dflt:!0}),tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:A({},n.ticks,{dflt:"outside"}),ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,ticklabelstep:n.ticklabelstep,showticklabels:n.showticklabels,tickfont:M({}),tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,tickprefix:n.tickprefix,showtickprefix:n.showtickprefix,ticksuffix:n.ticksuffix,showticksuffix:n.showticksuffix,separatethousands:n.separatethousands,exponentformat:n.exponentformat,minexponent:n.minexponent,showexponent:n.showexponent,editType:"plot"},"plot"),steps:p,threshold:{line:{color:A({},i.line.color,{}),width:A({},i.line.width,{dflt:1}),editType:"plot"},thickness:A({},i.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":366,"../../constants/delta.js":485,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],865:[function(d,ee,te){var A=d("../../plots/plots");te.name="indicator",te.plot=function(g,S,M,e){A.plotBasePlot(te.name,g,S,M,e)},te.clean=function(g,S,M,e){A.cleanBasePlot(te.name,g,S,M,e)}},{"../../plots/plots":628}],866:[function(d,ee,te){function A(g,S){var M=[],e=S.value;typeof S._lastValue!="number"&&(S._lastValue=S.value);var a=S._lastValue,n=a;return S._hasDelta&&typeof S.delta.reference=="number"&&(n=S.delta.reference),M[0]={y:e,lastY:a,delta:e-n,relativeDelta:(e-n)/n},M}ee.exports={calc:A}},{}],867:[function(d,ee,te){ee.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],868:[function(d,ee,te){var A=d("../../lib"),g=d("./attributes"),S=d("../../plots/domain").defaults,M=d("../../plot_api/plot_template"),e=d("../../plots/array_container_defaults"),a=d("./constants.js"),n=d("../../plots/cartesian/tick_value_defaults"),r=d("../../plots/cartesian/tick_mark_defaults"),t=d("../../plots/cartesian/tick_label_defaults"),c=d("../../plots/cartesian/prefix_suffix_defaults");function s(x,p,v,f){function y(D,R){return A.coerce(x,p,g,D,R)}S(p,f,y),y("mode"),p._hasNumber=p.mode.indexOf("number")!==-1,p._hasDelta=p.mode.indexOf("delta")!==-1,p._hasGauge=p.mode.indexOf("gauge")!==-1;var o=y("value");p._range=[0,typeof o=="number"?1.5*o:1];var m=new Array(2),l;p._hasNumber&&(y("number.valueformat"),y("number.font.color",f.font.color),y("number.font.family",f.font.family),y("number.font.size"),p.number.font.size===void 0&&(p.number.font.size=a.defaultNumberFontSize,m[0]=!0),y("number.prefix"),y("number.suffix"),l=p.number.font.size);var w;p._hasDelta&&(y("delta.font.color",f.font.color),y("delta.font.family",f.font.family),y("delta.font.size"),p.delta.font.size===void 0&&(p.delta.font.size=(p._hasNumber?.5:1)*(l||a.defaultNumberFontSize),m[1]=!0),y("delta.reference",p.value),y("delta.relative"),y("delta.valueformat",p.delta.relative?"2%":""),y("delta.increasing.symbol"),y("delta.increasing.color"),y("delta.decreasing.symbol"),y("delta.decreasing.color"),y("delta.position"),y("delta.prefix"),y("delta.suffix"),w=p.delta.font.size),p._scaleNumbers=(!p._hasNumber||m[0])&&(!p._hasDelta||m[1])||!1,y("title.font.color",f.font.color),y("title.font.family",f.font.family),y("title.font.size",.25*(l||w||a.defaultNumberFontSize)),y("title.text");var _,h,b,u;function L(D,R){return A.coerce(_,h,g.gauge,D,R)}function T(D,R){return A.coerce(b,u,g.gauge.axis,D,R)}if(p._hasGauge){_=x.gauge,_||(_={}),h=M.newContainer(p,"gauge"),L("shape");var k=p._isBullet=p.gauge.shape==="bullet";k||y("title.align","center");var P=p._isAngular=p.gauge.shape==="angular";P||y("align","center"),L("bgcolor",f.paper_bgcolor),L("borderwidth"),L("bordercolor"),L("bar.color"),L("bar.line.color"),L("bar.line.width");var z=a.valueThickness*(p.gauge.shape==="bullet"?.5:1);L("bar.thickness",z),e(_,h,{name:"steps",handleItemDefaults:i}),L("threshold.value"),L("threshold.thickness"),L("threshold.line.width"),L("threshold.line.color"),b={},_&&(b=_.axis||{}),u=M.newContainer(h,"axis"),T("visible"),p._range=T("range",p._range);var I={outerTicks:!0};n(b,u,T,"linear"),c(b,u,T,"linear",I),t(b,u,T,"linear",I),r(b,u,T,I)}else y("title.align","center"),y("align","center"),p._isAngular=p._isBullet=!1;p._length=null}function i(x,p){function v(f,y){return A.coerce(x,p,g.gauge.steps,f,y)}v("color"),v("line.color"),v("line.width"),v("range"),v("thickness")}ee.exports={supplyDefaults:s}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"../../plots/domain":593,"./attributes":864,"./constants.js":867}],869:[function(d,ee,te){ee.exports={moduleType:"trace",name:"indicator",basePlotModule:d("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,calc:d("./calc").calc,plot:d("./plot"),meta:{}}},{"./attributes":864,"./base_plot":865,"./calc":866,"./defaults":868,"./plot":870}],870:[function(d,ee,te){var A=d("@plotly/d3"),g=d("d3-interpolate").interpolate,S=d("d3-interpolate").interpolateNumber,M=d("../../lib"),e=M.strScale,a=M.strTranslate,n=M.rad2deg,r=d("../../constants/alignment").MID_SHIFT,t=d("../../components/drawing"),c=d("./constants"),s=d("../../lib/svg_text_utils"),i=d("../../plots/cartesian/axes"),x=d("../../plots/cartesian/axis_defaults"),p=d("../../plots/cartesian/position_defaults"),v=d("../../plots/cartesian/layout_attributes"),f=d("../../components/color"),y={left:"start",center:"middle",right:"end"},o={left:0,center:.5,right:1},m=/[yzafpnµmkMGTPEZY]/;function l(I){return I&&I.duration>0}ee.exports=function(D,R,O,F){var N=D._fullLayout,G;l(O)&&F&&(G=F()),M.makeTraceGroups(N._indicatorlayer,R,"trace").each(function(K){var W=K[0],Y=W.trace,re=A.select(this),ue=Y._hasGauge,j=Y._isAngular,q=Y._isBullet,V=Y.domain,U={w:N._size.w*(V.x[1]-V.x[0]),h:N._size.h*(V.y[1]-V.y[0]),l:N._size.l+N._size.w*V.x[0],r:N._size.r+N._size.w*(1-V.x[1]),t:N._size.t+N._size.h*(1-V.y[1]),b:N._size.b+N._size.h*V.y[0]},$=U.l+U.w/2,ne=U.t+U.h/2,X=Math.min(U.w/2,U.h),Q=c.innerRadius*X,ie,se,ae,oe=Y.align||"center";if(se=ne,!ue)ie=U.l+o[oe]*U.w,ae=function(we){return T(we,U.w,U.h)};else if(j&&(ie=$,se=ne+X/2,ae=function(we){return k(we,.9*Q)}),q){var be=c.bulletPadding,ce=1-c.bulletNumberDomainSize+be;ie=U.l+(ce+(1-ce)*o[oe])*U.w,ae=function(we){return T(we,(c.bulletNumberDomainSize-be)*U.w,U.h)}}h(D,re,K,{numbersX:ie,numbersY:se,numbersScaler:ae,transitionOpts:O,onComplete:G});var de,ye;ue&&(de={range:Y.gauge.axis.range,color:Y.gauge.bgcolor,line:{color:Y.gauge.bordercolor,width:0},thickness:1},ye={range:Y.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:Y.gauge.bordercolor,width:Y.gauge.borderwidth},thickness:1});var ge=re.selectAll("g.angular").data(j?K:[]);ge.exit().remove();var me=re.selectAll("g.angularaxis").data(j?K:[]);me.exit().remove(),j&&_(D,re,K,{radius:X,innerRadius:Q,gauge:ge,layer:me,size:U,gaugeBg:de,gaugeOutline:ye,transitionOpts:O,onComplete:G});var Ee=re.selectAll("g.bullet").data(q?K:[]);Ee.exit().remove();var Pe=re.selectAll("g.bulletaxis").data(q?K:[]);Pe.exit().remove(),q&&w(D,re,K,{gauge:Ee,layer:Pe,size:U,gaugeBg:de,gaugeOutline:ye,transitionOpts:O,onComplete:G});var Ne=re.selectAll("text.title").data(K);Ne.exit().remove(),Ne.enter().append("text").classed("title",!0),Ne.attr("text-anchor",function(){return q?y.right:y[Y.title.align]}).text(Y.title.text).call(t.font,Y.title.font).call(s.convertToTspans,D),Ne.attr("transform",function(){var we=U.l+U.w*o[Y.title.align],ke,Xe=c.titlePadding,He=t.bBox(Ne.node());if(ue){if(j)if(Y.gauge.axis.visible){var Ie=t.bBox(me.node());ke=Ie.top-Xe-He.bottom}else ke=U.t+U.h/2-X/2-He.bottom-Xe;q&&(ke=se-(He.top+He.bottom)/2,we=U.l-c.bulletPadding*U.w)}else ke=Y._numbersTop-Xe-He.bottom;return a(we,ke)})})};function w(I,D,R,O){var F=R[0].trace,N=O.gauge,G=O.layer,K=O.gaugeBg,W=O.gaugeOutline,Y=O.size,re=F.domain,ue=O.transitionOpts,j=O.onComplete,q,V,U,$,ne;N.enter().append("g").classed("bullet",!0),N.attr("transform",a(Y.l,Y.t)),G.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),G.selectAll("g.xbulletaxistick,path,text").remove();var X=Y.h,Q=F.gauge.bar.thickness*X,ie=re.x[0],se=re.x[0]+(re.x[1]-re.x[0])*(F._hasNumber||F._hasDelta?1-c.bulletNumberDomainSize:1);q=L(I,F.gauge.axis),q._id="xbulletaxis",q.domain=[ie,se],q.setScale(),V=i.calcTicks(q),U=i.makeTransTickFn(q),$=i.getTickSigns(q)[2],ne=Y.t+Y.h,q.visible&&(i.drawTicks(I,q,{vals:q.ticks==="inside"?i.clipEnds(q,V):V,layer:G,path:i.makeTickPath(q,ne,$),transFn:U}),i.drawLabels(I,q,{vals:V,layer:G,transFn:U,labelFns:i.makeLabelFns(q,ne)}));function ae(me){me.attr("width",function(Ee){return Math.max(0,q.c2p(Ee.range[1])-q.c2p(Ee.range[0]))}).attr("x",function(Ee){return q.c2p(Ee.range[0])}).attr("y",function(Ee){return .5*(1-Ee.thickness)*X}).attr("height",function(Ee){return Ee.thickness*X})}var oe=[K].concat(F.gauge.steps),be=N.selectAll("g.bg-bullet").data(oe);be.enter().append("g").classed("bg-bullet",!0).append("rect"),be.select("rect").call(ae).call(b),be.exit().remove();var ce=N.selectAll("g.value-bullet").data([F.gauge.bar]);ce.enter().append("g").classed("value-bullet",!0).append("rect"),ce.select("rect").attr("height",Q).attr("y",(X-Q)/2).call(b),l(ue)?ce.select("rect").transition().duration(ue.duration).ease(ue.easing).each("end",function(){j&&j()}).each("interrupt",function(){j&&j()}).attr("width",Math.max(0,q.c2p(Math.min(F.gauge.axis.range[1],R[0].y)))):ce.select("rect").attr("width",typeof R[0].y=="number"?Math.max(0,q.c2p(Math.min(F.gauge.axis.range[1],R[0].y))):0),ce.exit().remove();var de=R.filter(function(){return F.gauge.threshold.value||F.gauge.threshold.value===0}),ye=N.selectAll("g.threshold-bullet").data(de);ye.enter().append("g").classed("threshold-bullet",!0).append("line"),ye.select("line").attr("x1",q.c2p(F.gauge.threshold.value)).attr("x2",q.c2p(F.gauge.threshold.value)).attr("y1",(1-F.gauge.threshold.thickness)/2*X).attr("y2",(1-(1-F.gauge.threshold.thickness)/2)*X).call(f.stroke,F.gauge.threshold.line.color).style("stroke-width",F.gauge.threshold.line.width),ye.exit().remove();var ge=N.selectAll("g.gauge-outline").data([W]);ge.enter().append("g").classed("gauge-outline",!0).append("rect"),ge.select("rect").call(ae).call(b),ge.exit().remove()}function _(I,D,R,O){var F=R[0].trace,N=O.size,G=O.radius,K=O.innerRadius,W=O.gaugeBg,Y=O.gaugeOutline,re=[N.l+N.w/2,N.t+N.h/2+G/2],ue=O.gauge,j=O.layer,q=O.transitionOpts,V=O.onComplete,U=Math.PI/2;function $(De){var Ge=F.gauge.axis.range[0],ht=F.gauge.axis.range[1],Rt=(De-Ge)/(ht-Ge)*Math.PI-U;return Rt<-U?-U:Rt>U?U:Rt}function ne(De){return A.svg.arc().innerRadius((K+G)/2-De/2*(G-K)).outerRadius((K+G)/2+De/2*(G-K)).startAngle(-U)}function X(De){De.attr("d",function(Ge){return ne(Ge.thickness).startAngle($(Ge.range[0])).endAngle($(Ge.range[1]))()})}var Q,ie,se,ae;ue.enter().append("g").classed("angular",!0),ue.attr("transform",a(re[0],re[1])),j.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),j.selectAll("g.xangularaxistick,path,text").remove(),Q=L(I,F.gauge.axis),Q.type="linear",Q.range=F.gauge.axis.range,Q._id="xangularaxis",Q.ticklabeloverflow="allow",Q.setScale();var oe=function(De){return(Q.range[0]-De.x)/(Q.range[1]-Q.range[0])*Math.PI+Math.PI},be={},ce=i.makeLabelFns(Q,0),de=ce.labelStandoff;be.xFn=function(De){var Ge=oe(De);return Math.cos(Ge)*de},be.yFn=function(De){var Ge=oe(De),ht=Math.sin(Ge)>0?.2:1;return-Math.sin(Ge)*(de+De.fontSize*ht)+Math.abs(Math.cos(Ge))*(De.fontSize*r)},be.anchorFn=function(De){var Ge=oe(De),ht=Math.cos(Ge);return Math.abs(ht)<.1?"middle":ht>0?"start":"end"},be.heightFn=function(De,Ge,ht){var Rt=oe(De);return-.5*(1+Math.sin(Rt))*ht};var ye=function(De){return a(re[0]+G*Math.cos(De),re[1]-G*Math.sin(De))};se=function(De){return ye(oe(De))};var ge=function(De){var Ge=oe(De);return ye(Ge)+"rotate("+-n(Ge)+")"};if(ie=i.calcTicks(Q),ae=i.getTickSigns(Q)[2],Q.visible){ae=Q.ticks==="inside"?-1:1;var me=(Q.linewidth||1)/2;i.drawTicks(I,Q,{vals:ie,layer:j,path:"M"+ae*me+",0h"+ae*Q.ticklen,transFn:ge}),i.drawLabels(I,Q,{vals:ie,layer:j,transFn:se,labelFns:be})}var Ee=[W].concat(F.gauge.steps),Pe=ue.selectAll("g.bg-arc").data(Ee);Pe.enter().append("g").classed("bg-arc",!0).append("path"),Pe.select("path").call(X).call(b),Pe.exit().remove();var Ne=ne(F.gauge.bar.thickness),we=ue.selectAll("g.value-arc").data([F.gauge.bar]);we.enter().append("g").classed("value-arc",!0).append("path");var ke=we.select("path");l(q)?(ke.transition().duration(q.duration).ease(q.easing).each("end",function(){V&&V()}).each("interrupt",function(){V&&V()}).attrTween("d",u(Ne,$(R[0].lastY),$(R[0].y))),F._lastValue=R[0].y):ke.attr("d",typeof R[0].y=="number"?Ne.endAngle($(R[0].y)):"M0,0Z"),ke.call(b),we.exit().remove(),Ee=[];var Xe=F.gauge.threshold.value;(Xe||Xe===0)&&Ee.push({range:[Xe,Xe],color:F.gauge.threshold.color,line:{color:F.gauge.threshold.line.color,width:F.gauge.threshold.line.width},thickness:F.gauge.threshold.thickness});var He=ue.selectAll("g.threshold-arc").data(Ee);He.enter().append("g").classed("threshold-arc",!0).append("path"),He.select("path").call(X).call(b),He.exit().remove();var Ie=ue.selectAll("g.gauge-outline").data([Y]);Ie.enter().append("g").classed("gauge-outline",!0).append("path"),Ie.select("path").call(X).call(b),Ie.exit().remove()}function h(I,D,R,O){var F=R[0].trace,N=O.numbersX,G=O.numbersY,K=F.align||"center",W=y[K],Y=O.transitionOpts,re=O.onComplete,ue=M.ensureSingle(D,"g","numbers"),j,q,V,U=[];F._hasNumber&&U.push("number"),F._hasDelta&&(U.push("delta"),F.delta.position==="left"&&U.reverse());var $=ue.selectAll("text").data(U);$.enter().append("text"),$.attr("text-anchor",function(){return W}).attr("class",function(ye){return ye}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),$.exit().remove();function ne(ye,ge,me,Ee){if(ye.match("s")&&me>=0!=Ee>=0&&!ge(me).slice(-1).match(m)&&!ge(Ee).slice(-1).match(m)){var Pe=ye.slice().replace("s","f").replace(/\d+/,function(we){return parseInt(we)-1}),Ne=L(I,{tickformat:Pe});return function(we){return Math.abs(we)<1?i.tickText(Ne,we).text:ge(we)}}else return ge}function X(){var ye=L(I,{tickformat:F.number.valueformat},F._range);ye.setScale(),i.prepTicks(ye);var ge=function(we){return i.tickText(ye,we).text},me=F.number.suffix,Ee=F.number.prefix,Pe=ue.select("text.number");function Ne(){var we=typeof R[0].y=="number"?Ee+ge(R[0].y)+me:"-";Pe.text(we).call(t.font,F.number.font).call(s.convertToTspans,I)}return l(Y)?Pe.transition().duration(Y.duration).ease(Y.easing).each("end",function(){Ne(),re&&re()}).each("interrupt",function(){Ne(),re&&re()}).attrTween("text",function(){var we=A.select(this),ke=S(R[0].lastY,R[0].y);F._lastValue=R[0].y;var Xe=ne(F.number.valueformat,ge,R[0].lastY,R[0].y);return function(He){we.text(Ee+Xe(ke(He))+me)}}):Ne(),j=P(Ee+ge(R[0].y)+me,F.number.font,W,I),Pe}function Q(){var ye=L(I,{tickformat:F.delta.valueformat},F._range);ye.setScale(),i.prepTicks(ye);var ge=function(He){return i.tickText(ye,He).text},me=F.delta.suffix,Ee=F.delta.prefix,Pe=function(He){var Ie=F.delta.relative?He.relativeDelta:He.delta;return Ie},Ne=function(He,Ie){return He===0||typeof He!="number"||isNaN(He)?"-":(He>0?F.delta.increasing.symbol:F.delta.decreasing.symbol)+Ee+Ie(He)+me},we=function(He){return He.delta>=0?F.delta.increasing.color:F.delta.decreasing.color};F._deltaLastValue===void 0&&(F._deltaLastValue=Pe(R[0]));var ke=ue.select("text.delta");ke.call(t.font,F.delta.font).call(f.fill,we({delta:F._deltaLastValue}));function Xe(){ke.text(Ne(Pe(R[0]),ge)).call(f.fill,we(R[0])).call(s.convertToTspans,I)}return l(Y)?ke.transition().duration(Y.duration).ease(Y.easing).tween("text",function(){var He=A.select(this),Ie=Pe(R[0]),De=F._deltaLastValue,Ge=ne(F.delta.valueformat,ge,De,Ie),ht=S(De,Ie);return F._deltaLastValue=Ie,function(Rt){He.text(Ne(ht(Rt),Ge)),He.call(f.fill,we({delta:ht(Rt)}))}}).each("end",function(){Xe(),re&&re()}).each("interrupt",function(){Xe(),re&&re()}):Xe(),q=P(Ne(Pe(R[0]),ge),F.delta.font,W,I),ke}var ie=F.mode+F.align,se;if(F._hasDelta&&(se=Q(),ie+=F.delta.position+F.delta.font.size+F.delta.font.family+F.delta.valueformat,ie+=F.delta.increasing.symbol+F.delta.decreasing.symbol,V=q),F._hasNumber&&(X(),ie+=F.number.font.size+F.number.font.family+F.number.valueformat+F.number.suffix+F.number.prefix,V=j),F._hasDelta&&F._hasNumber){var ae=[(j.left+j.right)/2,(j.top+j.bottom)/2],oe=[(q.left+q.right)/2,(q.top+q.bottom)/2],be,ce,de=.75*F.delta.font.size;F.delta.position==="left"&&(be=z(F,"deltaPos",0,-1*(j.width*o[F.align]+q.width*(1-o[F.align])+de),ie,Math.min),ce=ae[1]-oe[1],V={width:j.width+q.width+de,height:Math.max(j.height,q.height),left:q.left+be,right:j.right,top:Math.min(j.top,q.top+ce),bottom:Math.max(j.bottom,q.bottom+ce)}),F.delta.position==="right"&&(be=z(F,"deltaPos",0,j.width*(1-o[F.align])+q.width*o[F.align]+de,ie,Math.max),ce=ae[1]-oe[1],V={width:j.width+q.width+de,height:Math.max(j.height,q.height),left:j.left,right:q.right+be,top:Math.min(j.top,q.top+ce),bottom:Math.max(j.bottom,q.bottom+ce)}),F.delta.position==="bottom"&&(be=null,ce=q.height,V={width:Math.max(j.width,q.width),height:j.height+q.height,left:Math.min(j.left,q.left),right:Math.max(j.right,q.right),top:j.bottom-j.height,bottom:j.bottom+q.height}),F.delta.position==="top"&&(be=null,ce=j.top,V={width:Math.max(j.width,q.width),height:j.height+q.height,left:Math.min(j.left,q.left),right:Math.max(j.right,q.right),top:j.bottom-j.height-q.height,bottom:j.bottom}),se.attr({dx:be,dy:ce})}(F._hasNumber||F._hasDelta)&&ue.attr("transform",function(){var ye=O.numbersScaler(V);ie+=ye[2];var ge=z(F,"numbersScale",1,ye[0],ie,Math.min),me;F._scaleNumbers||(ge=1),F._isAngular?me=G-ge*V.bottom:me=G-ge*(V.top+V.bottom)/2,F._numbersTop=ge*V.top+me;var Ee=V[K];K==="center"&&(Ee=(V.left+V.right)/2);var Pe=N-ge*Ee;return Pe=z(F,"numbersTranslate",0,Pe,ie,Math.max),a(Pe,me)+e(ge)})}function b(I){I.each(function(D){f.stroke(A.select(this),D.line.color)}).each(function(D){f.fill(A.select(this),D.color)}).style("stroke-width",function(D){return D.line.width})}function u(I,D,R){return function(){var O=g(D,R);return function(F){return I.endAngle(O(F))()}}}function L(I,D,R){var O=I._fullLayout,F=M.extendFlat({type:"linear",ticks:"outside",range:R,showline:!0},D),N={type:"linear",_id:"x"+D._id},G={letter:"x",font:O.font,noHover:!0,noTickson:!0};function K(W,Y){return M.coerce(F,N,v,W,Y)}return x(F,N,K,G,O),p(F,N,K,G),N}function T(I,D,R){var O=Math.min(D/I.width,R/I.height);return[O,I,D+"x"+R]}function k(I,D){var R=Math.sqrt(I.width/2*(I.width/2)+I.height*I.height),O=D/R;return[O,I,D]}function P(I,D,R,O){var F=document.createElementNS("http://www.w3.org/2000/svg","text"),N=A.select(F);return N.text(I).attr("x",0).attr("y",0).attr("text-anchor",R).attr("data-unformatted",I).call(s.convertToTspans,O).call(t.font,D),t.bBox(N.node())}function z(I,D,R,O,F,N){var G="_cache"+D;I[G]&&I[G].key===F||(I[G]={key:F,value:R});var K=M.aggNums(N,null,[I[G].value,O],2);return I[G].value=K,K}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"./constants":867,"@plotly/d3":58,"d3-interpolate":116}],871:[function(d,ee,te){var A=d("../../components/colorscale/attributes"),g=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../mesh3d/attributes"),e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat,n=d("../../plot_api/edit_types").overrideAll;function r(s){return{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}}function t(s){return{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}}var c=ee.exports=n(a({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:r(),y:r(),z:r()},caps:{x:t(),y:t(),z:t()},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:S(),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),valuehoverformat:g("value",1),showlegend:a({},e.showlegend,{dflt:!1})},A("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:M.opacity,lightposition:M.lightposition,lighting:M.lighting,flatshading:M.flatshading,contour:M.contour,hoverinfo:a({},e.hoverinfo)}),"calc","nested");c.flatshading.dflt=!0,c.lighting.facenormalsepsilon.dflt=0,c.x.editType=c.y.editType=c.z.editType=c.value.editType="calc+clearAxisTypes",c.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],872:[function(d,ee,te){var A=d("../../components/colorscale/calc"),g=d("../streamtube/calc").processGrid,S=d("../streamtube/calc").filter;ee.exports=function(e,a){a._len=Math.min(a.x.length,a.y.length,a.z.length,a.value.length),a._x=S(a.x,a._len),a._y=S(a.y,a._len),a._z=S(a.z,a._len),a._value=S(a.value,a._len);var n=g(a);a._gridFill=n.fill,a._Xs=n.Xs,a._Ys=n.Ys,a._Zs=n.Zs,a._len=n.len;for(var r=1/0,t=-1/0,c=0;c<a._len;c++){var s=a._value[c];r=Math.min(r,s),t=Math.max(t,s)}a._minValues=r,a._maxValues=t,a._vMin=a.isomin===void 0||a.isomin===null?r:a.isomin,a._vMax=a.isomax===void 0||a.isomin===null?t:a.isomax,A(e,a,{vals:[a._vMin,a._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375,"../streamtube/calc":1054}],873:[function(d,ee,te){var A=d("../../../stackgl_modules").gl_mesh3d,g=d("../../lib/gl_format_color").parseColorScale,S=d("../../lib/str2rgbarray"),M=d("../../components/colorscale").extractOpts,e=d("../../plots/gl3d/zip3"),a=function(i,x){for(var p=x.length-1;p>0;p--){var v=Math.min(x[p],x[p-1]),f=Math.max(x[p],x[p-1]);if(f>v&&v<i&&i<=f)return{id:p,distRatio:(f-i)/(f-v)}}return{id:0,distRatio:0}};function n(i,x,p){this.scene=i,this.uid=p,this.mesh=x,this.name="",this.data=null,this.showContour=!1}var r=n.prototype;r.handlePick=function(i){if(i.object===this.mesh){var x=i.data.index,p=this.data._meshX[x],v=this.data._meshY[x],f=this.data._meshZ[x],y=this.data._Ys.length,o=this.data._Zs.length,m=a(p,this.data._Xs).id,l=a(v,this.data._Ys).id,w=a(f,this.data._Zs).id,_=i.index=w+o*l+o*y*m;i.traceCoordinate=[this.data._meshX[_],this.data._meshY[_],this.data._meshZ[_],this.data._value[_]];var h=this.data.hovertext||this.data.text;return Array.isArray(h)&&h[_]!==void 0?i.textLabel=h[_]:h&&(i.textLabel=h),!0}},r.update=function(i){var x=this.scene,p=x.fullSceneLayout;this.data=c(i);function v(l,w,_,h){return w.map(function(b){return l.d2l(b,0,h)*_})}var f=e(v(p.xaxis,i._meshX,x.dataScale[0],i.xcalendar),v(p.yaxis,i._meshY,x.dataScale[1],i.ycalendar),v(p.zaxis,i._meshZ,x.dataScale[2],i.zcalendar)),y=e(i._meshI,i._meshJ,i._meshK),o={positions:f,cells:y,lightPosition:[i.lightposition.x,i.lightposition.y,i.lightposition.z],ambient:i.lighting.ambient,diffuse:i.lighting.diffuse,specular:i.lighting.specular,roughness:i.lighting.roughness,fresnel:i.lighting.fresnel,vertexNormalsEpsilon:i.lighting.vertexnormalsepsilon,faceNormalsEpsilon:i.lighting.facenormalsepsilon,opacity:i.opacity,contourEnable:i.contour.show,contourColor:S(i.contour.color).slice(0,3),contourWidth:i.contour.width,useFacetNormals:i.flatshading},m=M(i);o.vertexIntensity=i._meshIntensity,o.vertexIntensityBounds=[m.min,m.max],o.colormap=g(i),this.mesh.update(o)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var t=["xyz","xzy","yxz","yzx","zxy","zyx"];function c(i){i._meshI=[],i._meshJ=[],i._meshK=[];var x=i.surface.show,p=i.spaceframe.show,v=i.surface.fill,f=i.spaceframe.fill,y=!1,o=!1,m=0,l,w,_=i._Xs,h=i._Ys,b=i._Zs,u=_.length,L=h.length,T=b.length,k=t.indexOf(i._gridFill.replace(/-/g,"").replace(/\+/g,"")),P=function(zt,St,Ye){switch(k){case 5:return Ye+T*St+T*L*zt;case 4:return Ye+T*zt+T*u*St;case 3:return St+L*Ye+L*T*zt;case 2:return St+L*zt+L*u*Ye;case 1:return zt+u*Ye+u*T*St;default:return zt+u*St+u*L*Ye}},z=i._minValues,I=i._maxValues,D=i._vMin,R=i._vMax,O,F,N,G;function K(zt,St,Ye){for(var rt=G.length,Ve=w;Ve<rt;Ve++)if(zt===O[Ve]&&St===F[Ve]&&Ye===N[Ve])return Ve;return-1}function W(){w=l}function Y(){O=[],F=[],N=[],G=[],l=0,W()}function re(zt,St,Ye,rt){return O.push(zt),F.push(St),N.push(Ye),G.push(rt),l++,l-1}function ue(zt,St,Ye){return i._meshI.push(zt),i._meshJ.push(St),i._meshK.push(Ye),m++,m-1}function j(zt,St,Ye){for(var rt=[],Ve=0;Ve<zt.length;Ve++)rt[Ve]=(zt[Ve]+St[Ve]+Ye[Ve])/3;return rt}function q(zt,St,Ye){for(var rt=[],Ve=0;Ve<zt.length;Ve++)rt[Ve]=zt[Ve]*(1-Ye)+Ye*St[Ve];return rt}var V;function U(zt){V=zt}function $(zt,St){var Ye=zt[0],rt=zt[1],Ve=zt[2],Ae=j(Ye,rt,Ve),Ue=Math.sqrt(1-V),Ze=q(Ae,Ye,Ue),Qe=q(Ae,rt,Ue),_t=q(Ae,Ve,Ue),gt=St[0],wt=St[1],Ut=St[2];return{xyzv:[[Ye,rt,Qe],[Qe,Ze,Ye],[rt,Ve,_t],[_t,Qe,rt],[Ve,Ye,Ze],[Ze,_t,Ve]],abc:[[gt,wt,-1],[-1,-1,gt],[wt,Ut,-1],[-1,-1,wt],[Ut,gt,-1],[-1,-1,Ut]]}}function ne(zt,St){return zt==="all"||zt===null?!0:zt.indexOf(St)>-1}function X(zt,St){return zt===null?St:zt}function Q(zt,St,Ye){W();var rt=[St],Ve=[Ye];if(V>=1)rt=[St],Ve=[Ye];else if(V>0){var Ae=$(St,Ye);rt=Ae.xyzv,Ve=Ae.abc}for(var Ue=0;Ue<rt.length;Ue++){St=rt[Ue],Ye=Ve[Ue];for(var Ze=[],Qe=0;Qe<3;Qe++){var _t=St[Qe][0],gt=St[Qe][1],wt=St[Qe][2],Ut=St[Qe][3],Dt=Ye[Qe]>-1?Ye[Qe]:K(_t,gt,wt);Dt>-1?Ze[Qe]=Dt:Ze[Qe]=re(_t,gt,wt,X(zt,Ut))}ue(Ze[0],Ze[1],Ze[2])}}function ie(zt,St,Ye){var rt=function(Ve,Ae,Ue){Q(zt,[St[Ve],St[Ae],St[Ue]],[Ye[Ve],Ye[Ae],Ye[Ue]])};rt(0,1,2),rt(2,3,0)}function se(zt,St,Ye){var rt=function(Ve,Ae,Ue){Q(zt,[St[Ve],St[Ae],St[Ue]],[Ye[Ve],Ye[Ae],Ye[Ue]])};rt(0,1,2),rt(3,0,1),rt(2,3,0),rt(1,2,3)}function ae(zt,St,Ye,rt){var Ve=zt[3];Ve<Ye&&(Ve=Ye),Ve>rt&&(Ve=rt);for(var Ae=(zt[3]-Ve)/(zt[3]-St[3]+1e-9),Ue=[],Ze=0;Ze<4;Ze++)Ue[Ze]=(1-Ae)*zt[Ze]+Ae*St[Ze];return Ue}function oe(zt,St,Ye){return zt>=St&&zt<=Ye}function be(zt){var St=.001*(R-D);return zt>=D-St&&zt<=R+St}function ce(zt){for(var St=[],Ye=0;Ye<4;Ye++){var rt=zt[Ye];St.push([i._x[rt],i._y[rt],i._z[rt],i._value[rt]])}return St}var de=3;function ye(zt,St,Ye,rt,Ve,Ae){Ae||(Ae=1),Ye=[-1,-1,-1];var Ue=!1,Ze=[oe(St[0][3],rt,Ve),oe(St[1][3],rt,Ve),oe(St[2][3],rt,Ve)];if(!Ze[0]&&!Ze[1]&&!Ze[2])return!1;var Qe=function(gt,wt,Ut){return be(wt[0][3])&&be(wt[1][3])&&be(wt[2][3])?(Q(gt,wt,Ut),!0):Ae<de?ye(gt,wt,Ut,D,R,++Ae):!1};if(Ze[0]&&Ze[1]&&Ze[2])return Qe(zt,St,Ye)||Ue;var _t=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(gt){if(Ze[gt[0]]&&Ze[gt[1]]&&!Ze[gt[2]]){var wt=St[gt[0]],Ut=St[gt[1]],Dt=St[gt[2]],Nt=ae(Dt,wt,rt,Ve),Xt=ae(Dt,Ut,rt,Ve);Ue=Qe(zt,[Xt,Nt,wt],[-1,-1,Ye[gt[0]]])||Ue,Ue=Qe(zt,[wt,Ut,Xt],[Ye[gt[0]],Ye[gt[1]],-1])||Ue,_t=!0}}),_t||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(gt){if(Ze[gt[0]]&&!Ze[gt[1]]&&!Ze[gt[2]]){var wt=St[gt[0]],Ut=St[gt[1]],Dt=St[gt[2]],Nt=ae(Ut,wt,rt,Ve),Xt=ae(Dt,wt,rt,Ve);Ue=Qe(zt,[Xt,Nt,wt],[-1,-1,Ye[gt[0]]])||Ue,_t=!0}}),Ue}function ge(zt,St,Ye,rt){var Ve=!1,Ae=ce(St),Ue=[oe(Ae[0][3],Ye,rt),oe(Ae[1][3],Ye,rt),oe(Ae[2][3],Ye,rt),oe(Ae[3][3],Ye,rt)];if(!Ue[0]&&!Ue[1]&&!Ue[2]&&!Ue[3])return Ve;if(Ue[0]&&Ue[1]&&Ue[2]&&Ue[3])return o&&(Ve=se(zt,Ae,St)||Ve),Ve;var Ze=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(Qe){if(Ue[Qe[0]]&&Ue[Qe[1]]&&Ue[Qe[2]]&&!Ue[Qe[3]]){var _t=Ae[Qe[0]],gt=Ae[Qe[1]],wt=Ae[Qe[2]],Ut=Ae[Qe[3]];if(o)Ve=Q(zt,[_t,gt,wt],[St[Qe[0]],St[Qe[1]],St[Qe[2]]])||Ve;else{var Dt=ae(Ut,_t,Ye,rt),Nt=ae(Ut,gt,Ye,rt),Xt=ae(Ut,wt,Ye,rt);Ve=Q(null,[Dt,Nt,Xt],[-1,-1,-1])||Ve}Ze=!0}}),Ze||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(Qe){if(Ue[Qe[0]]&&Ue[Qe[1]]&&!Ue[Qe[2]]&&!Ue[Qe[3]]){var _t=Ae[Qe[0]],gt=Ae[Qe[1]],wt=Ae[Qe[2]],Ut=Ae[Qe[3]],Dt=ae(wt,_t,Ye,rt),Nt=ae(wt,gt,Ye,rt),Xt=ae(Ut,gt,Ye,rt),Ht=ae(Ut,_t,Ye,rt);o?(Ve=Q(zt,[_t,Ht,Dt],[St[Qe[0]],-1,-1])||Ve,Ve=Q(zt,[gt,Nt,Xt],[St[Qe[1]],-1,-1])||Ve):Ve=ie(null,[Dt,Nt,Xt,Ht],[-1,-1,-1,-1])||Ve,Ze=!0}}),Ze)||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(Qe){if(Ue[Qe[0]]&&!Ue[Qe[1]]&&!Ue[Qe[2]]&&!Ue[Qe[3]]){var _t=Ae[Qe[0]],gt=Ae[Qe[1]],wt=Ae[Qe[2]],Ut=Ae[Qe[3]],Dt=ae(gt,_t,Ye,rt),Nt=ae(wt,_t,Ye,rt),Xt=ae(Ut,_t,Ye,rt);o?(Ve=Q(zt,[_t,Dt,Nt],[St[Qe[0]],-1,-1])||Ve,Ve=Q(zt,[_t,Nt,Xt],[St[Qe[0]],-1,-1])||Ve,Ve=Q(zt,[_t,Xt,Dt],[St[Qe[0]],-1,-1])||Ve):Ve=Q(null,[Dt,Nt,Xt],[-1,-1,-1])||Ve,Ze=!0}}),Ve}function me(zt,St,Ye,rt,Ve,Ae,Ue,Ze,Qe,_t,gt){var wt=!1;return y&&(ne(zt,"A")&&(wt=ge(null,[St,Ye,rt,Ae],_t,gt)||wt),ne(zt,"B")&&(wt=ge(null,[Ye,rt,Ve,Qe],_t,gt)||wt),ne(zt,"C")&&(wt=ge(null,[Ye,Ae,Ue,Qe],_t,gt)||wt),ne(zt,"D")&&(wt=ge(null,[rt,Ae,Ze,Qe],_t,gt)||wt),ne(zt,"E")&&(wt=ge(null,[Ye,rt,Ae,Qe],_t,gt)||wt)),o&&(wt=ge(zt,[Ye,rt,Ae,Qe],_t,gt)||wt),wt}function Ee(zt,St,Ye,rt,Ve,Ae,Ue,Ze){return[Ze[0]===!0?!0:ye(zt,ce([St,Ye,rt]),[St,Ye,rt],Ae,Ue),Ze[1]===!0?!0:ye(zt,ce([rt,Ve,St]),[rt,Ve,St],Ae,Ue)]}function Pe(zt,St,Ye,rt,Ve,Ae,Ue,Ze,Qe){return Ze?Ee(zt,St,Ye,Ve,rt,Ae,Ue,Qe):Ee(zt,Ye,Ve,rt,St,Ae,Ue,Qe)}function Ne(zt,St,Ye,rt,Ve,Ae,Ue){var Ze=!1,Qe,_t,gt,wt,Ut=function(){Ze=ye(zt,[Qe,_t,gt],[-1,-1,-1],Ve,Ae)||Ze,Ze=ye(zt,[gt,wt,Qe],[-1,-1,-1],Ve,Ae)||Ze},Dt=Ue[0],Nt=Ue[1],Xt=Ue[2];return Dt&&(Qe=q(ce([P(St,Ye-0,rt-0)])[0],ce([P(St-1,Ye-0,rt-0)])[0],Dt),_t=q(ce([P(St,Ye-0,rt-1)])[0],ce([P(St-1,Ye-0,rt-1)])[0],Dt),gt=q(ce([P(St,Ye-1,rt-1)])[0],ce([P(St-1,Ye-1,rt-1)])[0],Dt),wt=q(ce([P(St,Ye-1,rt-0)])[0],ce([P(St-1,Ye-1,rt-0)])[0],Dt),Ut()),Nt&&(Qe=q(ce([P(St-0,Ye,rt-0)])[0],ce([P(St-0,Ye-1,rt-0)])[0],Nt),_t=q(ce([P(St-0,Ye,rt-1)])[0],ce([P(St-0,Ye-1,rt-1)])[0],Nt),gt=q(ce([P(St-1,Ye,rt-1)])[0],ce([P(St-1,Ye-1,rt-1)])[0],Nt),wt=q(ce([P(St-1,Ye,rt-0)])[0],ce([P(St-1,Ye-1,rt-0)])[0],Nt),Ut()),Xt&&(Qe=q(ce([P(St-0,Ye-0,rt)])[0],ce([P(St-0,Ye-0,rt-1)])[0],Xt),_t=q(ce([P(St-0,Ye-1,rt)])[0],ce([P(St-0,Ye-1,rt-1)])[0],Xt),gt=q(ce([P(St-1,Ye-1,rt)])[0],ce([P(St-1,Ye-1,rt-1)])[0],Xt),wt=q(ce([P(St-1,Ye-0,rt)])[0],ce([P(St-1,Ye-0,rt-1)])[0],Xt),Ut()),Ze}function we(zt,St,Ye,rt,Ve,Ae,Ue,Ze,Qe,_t,gt,wt){var Ut=zt;return wt?(y&&zt==="even"&&(Ut=null),me(Ut,St,Ye,rt,Ve,Ae,Ue,Ze,Qe,_t,gt)):(y&&zt==="odd"&&(Ut=null),me(Ut,Qe,Ze,Ue,Ae,Ve,rt,Ye,St,_t,gt))}function ke(zt,St,Ye,rt,Ve){for(var Ae=[],Ue=0,Ze=0;Ze<St.length;Ze++)for(var Qe=St[Ze],_t=1;_t<T;_t++)for(var gt=1;gt<L;gt++)Ae.push(Pe(zt,P(Qe,gt-1,_t-1),P(Qe,gt-1,_t),P(Qe,gt,_t-1),P(Qe,gt,_t),Ye,rt,(Qe+gt+_t)%2,Ve&&Ve[Ue]?Ve[Ue]:[])),Ue++;return Ae}function Xe(zt,St,Ye,rt,Ve){for(var Ae=[],Ue=0,Ze=0;Ze<St.length;Ze++)for(var Qe=St[Ze],_t=1;_t<u;_t++)for(var gt=1;gt<T;gt++)Ae.push(Pe(zt,P(_t-1,Qe,gt-1),P(_t,Qe,gt-1),P(_t-1,Qe,gt),P(_t,Qe,gt),Ye,rt,(_t+Qe+gt)%2,Ve&&Ve[Ue]?Ve[Ue]:[])),Ue++;return Ae}function He(zt,St,Ye,rt,Ve){for(var Ae=[],Ue=0,Ze=0;Ze<St.length;Ze++)for(var Qe=St[Ze],_t=1;_t<L;_t++)for(var gt=1;gt<u;gt++)Ae.push(Pe(zt,P(gt-1,_t-1,Qe),P(gt-1,_t,Qe),P(gt,_t-1,Qe),P(gt,_t,Qe),Ye,rt,(gt+_t+Qe)%2,Ve&&Ve[Ue]?Ve[Ue]:[])),Ue++;return Ae}function Ie(zt,St,Ye){for(var rt=1;rt<T;rt++)for(var Ve=1;Ve<L;Ve++)for(var Ae=1;Ae<u;Ae++)we(zt,P(Ae-1,Ve-1,rt-1),P(Ae-1,Ve-1,rt),P(Ae-1,Ve,rt-1),P(Ae-1,Ve,rt),P(Ae,Ve-1,rt-1),P(Ae,Ve-1,rt),P(Ae,Ve,rt-1),P(Ae,Ve,rt),St,Ye,(Ae+Ve+rt)%2)}function De(zt,St,Ye){o=!0,Ie(zt,St,Ye),o=!1}function Ge(zt,St,Ye){y=!0,Ie(zt,St,Ye),y=!1}function ht(zt,St,Ye,rt,Ve,Ae){for(var Ue=[],Ze=0,Qe=0;Qe<St.length;Qe++)for(var _t=St[Qe],gt=1;gt<T;gt++)for(var wt=1;wt<L;wt++)Ue.push(Ne(zt,_t,wt,gt,Ye,rt,Ve[Qe],Ae&&Ae[Ze]?Ae[Ze]:[])),Ze++;return Ue}function Rt(zt,St,Ye,rt,Ve,Ae){for(var Ue=[],Ze=0,Qe=0;Qe<St.length;Qe++)for(var _t=St[Qe],gt=1;gt<u;gt++)for(var wt=1;wt<T;wt++)Ue.push(Ne(zt,gt,_t,wt,Ye,rt,Ve[Qe],Ae&&Ae[Ze]?Ae[Ze]:[])),Ze++;return Ue}function Kt(zt,St,Ye,rt,Ve,Ae){for(var Ue=[],Ze=0,Qe=0;Qe<St.length;Qe++)for(var _t=St[Qe],gt=1;gt<L;gt++)for(var wt=1;wt<u;wt++)Ue.push(Ne(zt,wt,gt,_t,Ye,rt,Ve[Qe],Ae&&Ae[Ze]?Ae[Ze]:[])),Ze++;return Ue}function It(zt,St){for(var Ye=[],rt=zt;rt<St;rt++)Ye.push(rt);return Ye}function Mt(){for(var zt=0;zt<u;zt++)for(var St=0;St<L;St++)for(var Ye=0;Ye<T;Ye++){var rt=P(zt,St,Ye);re(i._x[rt],i._y[rt],i._z[rt],i._value[rt])}}function Yt(){Y(),Mt();var zt=null;if(p&&f&&(U(f),De(zt,D,R)),x&&v){U(v);for(var St=i.surface.pattern,Ye=i.surface.count,rt=0;rt<Ye;rt++){var Ve=Ye===1?.5:rt/(Ye-1),Ae=(1-Ve)*D+Ve*R,Ue=Math.abs(Ae-z),Ze=Math.abs(Ae-I),Qe=Ue>Ze?[z,Ae]:[Ae,I];Ge(St,Qe[0],Qe[1])}}var _t=[[Math.min(D,I),Math.max(D,I)],[Math.min(z,R),Math.max(z,R)]];["x","y","z"].forEach(function(gt){for(var wt=[],Ut=0;Ut<_t.length;Ut++){var Dt=0,Nt=_t[Ut][0],Xt=_t[Ut][1],Ht=i.slices[gt];if(Ht.show&&Ht.fill){U(Ht.fill);var ar=[],Vr=[],nn=[];if(Ht.locations.length)for(var jr=0;jr<Ht.locations.length;jr++){var at=a(Ht.locations[jr],gt==="x"?_:gt==="y"?h:b);at.distRatio===0?ar.push(at.id):at.id>0&&(Vr.push(at.id),gt==="x"?nn.push([at.distRatio,0,0]):gt==="y"?nn.push([0,at.distRatio,0]):nn.push([0,0,at.distRatio]))}else gt==="x"?ar=It(1,u-1):gt==="y"?ar=It(1,L-1):ar=It(1,T-1);Vr.length>0&&(gt==="x"?wt[Dt]=ht(zt,Vr,Nt,Xt,nn,wt[Dt]):gt==="y"?wt[Dt]=Rt(zt,Vr,Nt,Xt,nn,wt[Dt]):wt[Dt]=Kt(zt,Vr,Nt,Xt,nn,wt[Dt]),Dt++),ar.length>0&&(gt==="x"?wt[Dt]=ke(zt,ar,Nt,Xt,wt[Dt]):gt==="y"?wt[Dt]=Xe(zt,ar,Nt,Xt,wt[Dt]):wt[Dt]=He(zt,ar,Nt,Xt,wt[Dt]),Dt++)}var $t=i.caps[gt];$t.show&&$t.fill&&(U($t.fill),gt==="x"?wt[Dt]=ke(zt,[0,u-1],Nt,Xt,wt[Dt]):gt==="y"?wt[Dt]=Xe(zt,[0,L-1],Nt,Xt,wt[Dt]):wt[Dt]=He(zt,[0,T-1],Nt,Xt,wt[Dt]),Dt++)}}),m===0&&Y(),i._meshX=O,i._meshY=F,i._meshZ=N,i._meshIntensity=G,i._Xs=_,i._Ys=h,i._Zs=b}return Yt(),i}function s(i,x){var p=i.glplot.gl,v=A({gl:p}),f=new n(i,v,x.uid);return v._trace=f,f.update(x),i.glplot.add(v),f}ee.exports={findNearestOnAxis:a,generateIsoMeshes:c,createIsosurfaceTrace:s}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],874:[function(d,ee,te){var A=d("../../lib"),g=d("../../registry"),S=d("./attributes"),M=d("../../components/colorscale/defaults");function e(n,r,t,c){function s(i,x){return A.coerce(n,r,S,i,x)}a(n,r,t,c,s)}function a(n,r,t,c,s){var i=s("isomin"),x=s("isomax");x!=null&&i!==void 0&&i!==null&&i>x&&(r.isomin=null,r.isomax=null);var p=s("x"),v=s("y"),f=s("z"),y=s("value");if(!p||!p.length||!v||!v.length||!f||!f.length||!y||!y.length){r.visible=!1;return}var o=g.getComponentMethod("calendars","handleTraceDefaults");o(n,r,["x","y","z"],c),s("valuehoverformat"),["x","y","z"].forEach(function(_){s(_+"hoverformat");var h="caps."+_,b=s(h+".show");b&&s(h+".fill");var u="slices."+_,L=s(u+".show");L&&(s(u+".fill"),s(u+".locations"))});var m=s("spaceframe.show");m&&s("spaceframe.fill");var l=s("surface.show");l&&(s("surface.count"),s("surface.fill"),s("surface.pattern"));var w=s("contour.show");w&&(s("contour.color"),s("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(_){s(_)}),M(n,r,c,s,{prefix:"",cLetter:"c"}),r._length=null}ee.exports={supplyDefaults:e,supplyIsoDefaults:a}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":871}],875:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,calc:d("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:d("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":871,"./calc":872,"./convert":873,"./defaults":874}],876:[function(d,ee,te){var A=d("../../components/colorscale/attributes"),g=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../surface/attributes"),e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat;ee.exports=a({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:S({editType:"calc"}),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},A("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:M.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:a({},M.contours.x.show,{}),color:M.contours.x.color,width:M.contours.x.width,editType:"calc"},lightposition:{x:a({},M.lightposition.x,{dflt:1e5}),y:a({},M.lightposition.y,{dflt:1e5}),z:a({},M.lightposition.z,{dflt:0}),editType:"calc"},lighting:a({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},M.lighting),hoverinfo:a({},e.hoverinfo,{editType:"calc"}),showlegend:a({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../surface/attributes":1070}],877:[function(d,ee,te){var A=d("../../components/colorscale/calc");ee.exports=function(S,M){M.intensity&&A(S,M,{vals:M.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],878:[function(d,ee,te){var A=d("../../../stackgl_modules").gl_mesh3d,g=d("../../../stackgl_modules").delaunay_triangulate,S=d("../../../stackgl_modules").alpha_shape,M=d("../../../stackgl_modules").convex_hull,e=d("../../lib/gl_format_color").parseColorScale,a=d("../../lib/str2rgbarray"),n=d("../../components/colorscale").extractOpts,r=d("../../plots/gl3d/zip3");function t(y,o,m){this.scene=y,this.uid=m,this.mesh=o,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var c=t.prototype;c.handlePick=function(y){if(y.object===this.mesh){var o=y.index=y.data.index;y.data._cellCenter?y.traceCoordinate=y.data.dataCoordinate:y.traceCoordinate=[this.data.x[o],this.data.y[o],this.data.z[o]];var m=this.data.hovertext||this.data.text;return Array.isArray(m)&&m[o]!==void 0?y.textLabel=m[o]:m&&(y.textLabel=m),!0}};function s(y){for(var o=[],m=y.length,l=0;l<m;l++)o[l]=a(y[l]);return o}function i(y,o,m,l){for(var w=[],_=o.length,h=0;h<_;h++)w[h]=y.d2l(o[h],0,l)*m;return w}function x(y){for(var o=[],m=y.length,l=0;l<m;l++)o[l]=Math.round(y[l]);return o}function p(y,o){for(var m=["x","y","z"].indexOf(y),l=[],w=o.length,_=0;_<w;_++)l[_]=[o[_][(m+1)%3],o[_][(m+2)%3]];return g(l)}function v(y,o){for(var m=y.length,l=0;l<m;l++)if(y[l]<=-.5||y[l]>=o-.5)return!1;return!0}c.update=function(y){var o=this.scene,m=o.fullSceneLayout;this.data=y;var l=y.x.length,w=r(i(m.xaxis,y.x,o.dataScale[0],y.xcalendar),i(m.yaxis,y.y,o.dataScale[1],y.ycalendar),i(m.zaxis,y.z,o.dataScale[2],y.zcalendar)),_;if(y.i&&y.j&&y.k){if(y.i.length!==y.j.length||y.j.length!==y.k.length||!v(y.i,l)||!v(y.j,l)||!v(y.k,l))return;_=r(x(y.i),x(y.j),x(y.k))}else y.alphahull===0?_=M(w):y.alphahull>0?_=S(y.alphahull,w):_=p(y.delaunayaxis,w);var h={positions:w,cells:_,lightPosition:[y.lightposition.x,y.lightposition.y,y.lightposition.z],ambient:y.lighting.ambient,diffuse:y.lighting.diffuse,specular:y.lighting.specular,roughness:y.lighting.roughness,fresnel:y.lighting.fresnel,vertexNormalsEpsilon:y.lighting.vertexnormalsepsilon,faceNormalsEpsilon:y.lighting.facenormalsepsilon,opacity:y.opacity,contourEnable:y.contour.show,contourColor:a(y.contour.color).slice(0,3),contourWidth:y.contour.width,useFacetNormals:y.flatshading};if(y.intensity){var b=n(y);this.color="#fff";var u=y.intensitymode;h[u+"Intensity"]=y.intensity,h[u+"IntensityBounds"]=[b.min,b.max],h.colormap=e(y)}else y.vertexcolor?(this.color=y.vertexcolor[0],h.vertexColors=s(y.vertexcolor)):y.facecolor?(this.color=y.facecolor[0],h.cellColors=s(y.facecolor)):(this.color=y.color,h.meshColor=a(y.color));this.mesh.update(h)},c.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function f(y,o){var m=y.glplot.gl,l=A({gl:m}),w=new t(y,l,o.uid);return l._trace=w,w.update(o),y.glplot.add(l),w}ee.exports=f},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],879:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib"),S=d("../../components/colorscale/defaults"),M=d("./attributes");ee.exports=function(a,n,r,t){function c(v,f){return g.coerce(a,n,M,v,f)}function s(v){var f=v.map(function(y){var o=c(y);return o&&g.isArrayOrTypedArray(o)?o:null});return f.every(function(y){return y&&y.length===f[0].length})&&f}var i=s(["x","y","z"]);if(!i){n.visible=!1;return}if(s(["i","j","k"]),n.i&&(!n.j||!n.k)||n.j&&(!n.k||!n.i)||n.k&&(!n.i||!n.j)){n.visible=!1;return}var x=A.getComponentMethod("calendars","handleTraceDefaults");x(a,n,["x","y","z"],t),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(v){c(v)});var p=c("contour.show");p&&(c("contour.color"),c("contour.width")),"intensity"in a?(c("intensity"),c("intensitymode"),S(a,n,t,c,{prefix:"",cLetter:"c"})):(n.showscale=!1,"facecolor"in a?c("facecolor"):"vertexcolor"in a?c("vertexcolor"):c("color",r)),c("text"),c("hovertext"),c("hovertemplate"),c("xhoverformat"),c("yhoverformat"),c("zhoverformat"),n._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":876}],880:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:d("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":876,"./calc":877,"./convert":878,"./defaults":879}],881:[function(d,ee,te){var A=d("../../lib").extendFlat,g=d("../scatter/attributes"),S=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../components/drawing/attributes").dash,e=d("../../components/fx/attributes"),a=d("../../constants/delta.js"),n=a.INCREASING.COLOR,r=a.DECREASING.COLOR,t=g.line;function c(s){return{line:{color:A({},t.color,{dflt:s}),width:t.width,dash:M,editType:"style"},editType:"style"}}ee.exports={xperiod:g.xperiod,xperiod0:g.xperiod0,xperiodalignment:g.xperiodalignment,xhoverformat:S("x"),yhoverformat:S("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:A({},t.width,{}),dash:A({},M,{}),editType:"style"},increasing:c(n),decreasing:c(r),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:A({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":388,"../../components/fx/attributes":398,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936}],882:[function(d,ee,te){var A=d("../../lib"),g=A._,S=d("../../plots/cartesian/axes"),M=d("../../plots/cartesian/align_period"),e=d("../../constants/numerical").BADNUM;function a(c,s){var i=S.getFromId(c,s.xaxis),x=S.getFromId(c,s.yaxis),p=t(c,i,s),v=s._minDiff;s._minDiff=null;var f=s._origX;s._origX=null;var y=s._xcalc;s._xcalc=null;var o=r(c,s,f,y,x,n);return s._extremes[i._id]=S.findExtremes(i,y,{vpad:v/2}),o.length?(A.extendFlat(o[0].t,{wHover:v/2,tickLen:p}),o):[{t:{empty:!0}}]}function n(c,s,i,x){return{o:c,h:s,l:i,c:x}}function r(c,s,i,x,p,v){for(var f=p.makeCalcdata(s,"open"),y=p.makeCalcdata(s,"high"),o=p.makeCalcdata(s,"low"),m=p.makeCalcdata(s,"close"),l=Array.isArray(s.text),w=Array.isArray(s.hovertext),_=!0,h=null,b=!!s.xperiodalignment,u=[],L=0;L<x.length;L++){var T=x[L],k=f[L],P=y[L],z=o[L],I=m[L];if(T!==e&&k!==e&&P!==e&&z!==e&&I!==e){I===k?h!==null&&I!==h&&(_=I>h):_=I>k,h=I;var D=v(k,P,z,I);D.pos=T,D.yc=(k+I)/2,D.i=L,D.dir=_?"increasing":"decreasing",D.x=D.pos,D.y=[z,P],b&&(D.orig_p=i[L]),l&&(D.tx=s.text[L]),w&&(D.htx=s.hovertext[L]),u.push(D)}else u.push({pos:T,empty:!0})}return s._extremes[p._id]=S.findExtremes(p,A.concat(o,y),{padded:!0}),u.length&&(u[0].t={labels:{open:g(c,"open:")+" ",high:g(c,"high:")+" ",low:g(c,"low:")+" ",close:g(c,"close:")+" "}}),u}function t(c,s,i){var x=i._minDiff;if(!x){var p=c._fullData,v=[];x=1/0;var f;for(f=0;f<p.length;f++){var y=p[f];if(y.type==="ohlc"&&y.visible===!0&&y.xaxis===s._id){v.push(y);var o=s.makeCalcdata(y,"x");y._origX=o;var m=M(i,s,"x",o).vals;y._xcalc=m;var l=A.distinctVals(m).minDiff;l&&isFinite(l)&&(x=Math.min(x,l))}}for(x===1/0&&(x=1),f=0;f<v.length;f++)v[f]._minDiff=x}return x*i.tickwidth}ee.exports={calc:a,calcCommon:r}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566}],883:[function(d,ee,te){var A=d("../../lib"),g=d("./ohlc_defaults"),S=d("../scatter/period_defaults"),M=d("./attributes");ee.exports=function(n,r,t,c){function s(x,p){return A.coerce(n,r,M,x,p)}var i=g(n,r,s,c);if(!i){r.visible=!1;return}S(n,r,c,s,{x:!0}),s("xhoverformat"),s("yhoverformat"),s("line.width"),s("line.dash"),e(n,r,s,"increasing"),e(n,r,s,"decreasing"),s("text"),s("hovertext"),s("tickwidth"),c._requestRangeslider[r.xaxis]=!0};function e(a,n,r,t){r(t+".line.color"),r(t+".line.width",n.line.width),r(t+".line.dash",n.line.dash)}},{"../../lib":515,"../scatter/period_defaults":956,"./attributes":881,"./ohlc_defaults":886}],884:[function(d,ee,te){var A=d("../../plots/cartesian/axes"),g=d("../../lib"),S=d("../../components/fx"),M=d("../../components/color"),e=d("../../lib").fillText,a=d("../../constants/delta.js"),n={increasing:a.INCREASING.SYMBOL,decreasing:a.DECREASING.SYMBOL};function r(i,x,p,v){var f=i.cd,y=f[0].trace;return y.hoverlabel.split?c(i,x,p,v):s(i,x,p,v)}function t(i,x,p,v){var f=i.cd,y=i.xa,o=f[0].trace,m=f[0].t,l=o.type,w=l==="ohlc"?"l":"min",_=l==="ohlc"?"h":"max",h,b,u=m.bPos||0,L=function(K){return K.pos+u-x},T=m.bdPos||m.tickLen,k=m.wHover,P=Math.min(1,T/Math.abs(y.r2c(y.range[1])-y.r2c(y.range[0])));h=i.maxHoverDistance-P,b=i.maxSpikeDistance-P;function z(K){var W=L(K);return S.inbox(W-k,W+k,h)}function I(K){var W=K[w],Y=K[_];return W===Y||S.inbox(W-p,Y-p,h)}function D(K){return(z(K)+I(K))/2}var R=S.getDistanceFunction(v,z,I,D);if(S.getClosest(f,R,i),i.index===!1)return null;var O=f[i.index];if(O.empty)return null;var F=O.dir,N=o[F],G=N.line.color;return M.opacity(G)&&N.line.width?i.color=G:i.color=N.fillcolor,i.x0=y.c2p(O.pos+u-T,!0),i.x1=y.c2p(O.pos+u+T,!0),i.xLabelVal=O.orig_p!==void 0?O.orig_p:O.pos,i.spikeDistance=D(O)*b/h,i.xSpike=y.c2p(O.pos,!0),i}function c(i,x,p,v){var f=i.cd,y=i.ya,o=f[0].trace,m=f[0].t,l=[],w=t(i,x,p,v);if(!w)return[];var _=w.index,h=f[_],b=h.hi||o.hoverinfo,u=b.split("+"),L=b==="all",T=L||u.indexOf("y")!==-1;if(!T)return[];for(var k=["high","open","close","low"],P={},z=0;z<k.length;z++){var I=k[z],D=o[I][w.index],R=y.c2p(D,!0),O;D in P?(O=P[D],O.yLabel+="<br>"+m.labels[I]+A.hoverLabelText(y,D,o.yhoverformat)):(O=g.extendFlat({},w),O.y0=O.y1=R,O.yLabelVal=D,O.yLabel=m.labels[I]+A.hoverLabelText(y,D,o.yhoverformat),O.name="",l.push(O),P[D]=O)}return l}function s(i,x,p,v){var f=i.cd,y=i.ya,o=f[0].trace,m=f[0].t,l=t(i,x,p,v);if(!l)return[];var w=l.index,_=f[w],h=l.index=_.i,b=_.dir;function u(D){return m.labels[D]+A.hoverLabelText(y,o[D][h],o.yhoverformat)}var L=_.hi||o.hoverinfo,T=L.split("+"),k=L==="all",P=k||T.indexOf("y")!==-1,z=k||T.indexOf("text")!==-1,I=P?[u("open"),u("high"),u("low"),u("close")+"  "+n[b]]:[];return z&&e(_,o,I),l.extraText=I.join("<br>"),l.y0=l.y1=y.c2p(_.yc,!0),[l]}ee.exports={hoverPoints:r,hoverSplit:c,hoverOnPoints:s}},{"../../components/color":367,"../../components/fx":407,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axes":566}],885:[function(d,ee,te){ee.exports={moduleType:"trace",name:"ohlc",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc").calc,plot:d("./plot"),style:d("./style"),hoverPoints:d("./hover").hoverPoints,selectPoints:d("./select")}},{"../../plots/cartesian":578,"./attributes":881,"./calc":882,"./defaults":883,"./hover":884,"./plot":887,"./select":888,"./style":889}],886:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib");ee.exports=function(M,e,a,n){var r=a("x"),t=a("open"),c=a("high"),s=a("low"),i=a("close");a("hoverlabel.split");var x=A.getComponentMethod("calendars","handleTraceDefaults");if(x(M,e,["x"],n),!!(t&&c&&s&&i)){var p=Math.min(t.length,c.length,s.length,i.length);return r&&(p=Math.min(p,g.minRowLength(r))),e._length=p,p}}},{"../../lib":515,"../../registry":647}],887:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib");ee.exports=function(M,e,a,n){var r=e.yaxis,t=e.xaxis,c=!!t.rangebreaks;g.makeTraceGroups(n,a,"trace ohlc").each(function(s){var i=A.select(this),x=s[0],p=x.t,v=x.trace;if(v.visible!==!0||p.empty){i.remove();return}var f=p.tickLen,y=i.selectAll("path").data(g.identity);y.enter().append("path"),y.exit().remove(),y.attr("d",function(o){if(o.empty)return"M0,0Z";var m=t.c2p(o.pos-f,!0),l=t.c2p(o.pos+f,!0),w=c?(m+l)/2:t.c2p(o.pos,!0),_=r.c2p(o.o,!0),h=r.c2p(o.h,!0),b=r.c2p(o.l,!0),u=r.c2p(o.c,!0);return"M"+m+","+_+"H"+w+"M"+w+","+h+"V"+b+"M"+l+","+u+"H"+w})})}},{"../../lib":515,"@plotly/d3":58}],888:[function(d,ee,te){ee.exports=function(g,S){var M=g.cd,e=g.xaxis,a=g.yaxis,n=[],r,t=M[0].t.bPos||0;if(S===!1)for(r=0;r<M.length;r++)M[r].selected=0;else for(r=0;r<M.length;r++){var c=M[r];S.contains([e.c2p(c.pos+t),a.c2p(c.yc)],null,c.i,g)?(n.push({pointNumber:c.i,x:e.c2d(c.pos),y:a.c2d(c.yc)}),c.selected=1):c.selected=0}return n}},{}],889:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/drawing"),S=d("../../components/color");ee.exports=function(e,a,n){var r=n||A.select(e).selectAll("g.ohlclayer").selectAll("g.trace");r.style("opacity",function(t){return t[0].trace.opacity}),r.each(function(t){var c=t[0].trace;A.select(this).selectAll("path").each(function(s){if(!s.empty){var i=c[s.dir].line;A.select(this).style("fill","none").call(S.stroke,i.color).call(g.dashLine,i.dash,i.width).style("opacity",c.selectedpoints&&!s.selected?.3:1)}})})}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],890:[function(d,ee,te){var A=d("../../lib/extend").extendFlat,g=d("../../plots/attributes"),S=d("../../plots/font_attributes"),M=d("../../components/colorscale/attributes"),e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/domain").attributes,n=A({editType:"calc"},M("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});ee.exports={domain:a({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:A({},g.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:S({editType:"calc"}),tickfont:S({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:n,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],891:[function(d,ee,te){var A=d("../../plots/get_data").getModuleCalcData,g=d("./plot"),S="parcats";te.name=S,te.plot=function(M,e,a,n){var r=A(M.calcdata,S);if(r.length){var t=r[0];g(M,t,a,n)}},te.clean=function(M,e,a,n){var r=n._has&&n._has("parcats"),t=e._has&&e._has("parcats");r&&!t&&n._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":602,"./plot":896}],892:[function(d,ee,te){var A=d("../../lib/gup").wrap,g=d("../../components/colorscale/helpers").hasColorscale,S=d("../../components/colorscale/calc"),M=d("../../lib/filter_unique.js"),e=d("../../components/drawing"),a=d("../../lib"),n=d("fast-isnumeric");ee.exports=function(m,l){var w=a.filterVisible(l.dimensions);if(w.length===0)return[];var _=w.map(function(j){var q;if(j.categoryorder==="trace")q=null;else if(j.categoryorder==="array")q=j.categoryarray;else{q=M(j.values);for(var V=!0,U=0;U<q.length;U++)if(!n(q[U])){V=!1;break}q.sort(V?a.sorterAsc:void 0),j.categoryorder==="category descending"&&(q=q.reverse())}return p(j.values,q)}),h,b,u;a.isArrayOrTypedArray(l.counts)?h=l.counts:h=[l.counts],v(w),w.forEach(function(j,q){f(j,_[q])});var L=l.line,T;L?(g(l,"line")&&S(m,l,{vals:l.line.color,containerStr:"line",cLetter:"c"}),T=e.tryColorscale(L)):T=a.identity;function k(j){var q,V;return a.isArrayOrTypedArray(L.color)?(q=L.color[j%L.color.length],V=q):q=L.color,{color:T(q),rawColor:V}}var P=w[0].values.length,z={},I=_.map(function(j){return j.inds});u=0;var D,R;for(D=0;D<P;D++){var O=[];for(R=0;R<I.length;R++)O.push(I[R][D]);b=h[D%h.length],u+=b;var F=k(D),N=O+"-"+F.rawColor;z[N]===void 0&&(z[N]=i(O,F.color,F.rawColor)),x(z[N],D,b)}var G=w.map(function(j,q){return t(q,j._index,j._displayindex,j.label,u)});for(D=0;D<P;D++)for(b=h[D%h.length],R=0;R<G.length;R++){var K=G[R].containerInd,W=_[R].inds[D],Y=G[R].categories;if(Y[W]===void 0){var re=l.dimensions[K]._categoryarray[W],ue=l.dimensions[K]._ticktext[W];Y[W]=c(R,W,re,ue)}s(Y[W],D,b)}return A(r(G,z,u))};function r(o,m,l){var w=o.map(function(_){return _.categories.length}).reduce(function(_,h){return Math.max(_,h)});return{dimensions:o,paths:m,trace:void 0,maxCats:w,count:l}}function t(o,m,l,w,_){return{dimensionInd:o,containerInd:m,displayInd:l,dimensionLabel:w,count:_,categories:[],dragX:null}}function c(o,m,l,w){return{dimensionInd:o,categoryInd:m,categoryValue:l,displayInd:m,categoryLabel:w,valueInds:[],count:0,dragY:null}}function s(o,m,l){o.valueInds.push(m),o.count+=l}function i(o,m,l){return{categoryInds:o,color:m,rawColor:l,valueInds:[],count:0}}function x(o,m,l){o.valueInds.push(m),o.count+=l}function p(o,m){m==null?m=[]:m=m.map(function(T){return T});var l={},w={},_=[];m.forEach(function(T,k){l[T]=0,w[T]=k});for(var h=0;h<o.length;h++){var b=o[h],u;l[b]===void 0?(l[b]=1,u=m.push(b)-1,w[b]=u):(l[b]++,u=w[b]),_.push(u)}var L=m.map(function(T){return l[T]});return{uniqueValues:m,uniqueCounts:L,inds:_}}function v(o){var m=o.map(function(w){return w.displayindex}),l;if(y(m))for(l=0;l<o.length;l++)o[l]._displayindex=o[l].displayindex;else for(l=0;l<o.length;l++)o[l]._displayindex=l}function f(o,m){o._categoryarray=m.uniqueValues,o.ticktext===null||o.ticktext===void 0?o._ticktext=[]:o._ticktext=o.ticktext.slice();for(var l=o._ticktext.length;l<m.uniqueValues.length;l++)o._ticktext.push(m.uniqueValues[l])}function y(o){for(var m=new Array(o.length),l=0;l<o.length;l++){if(o[l]<0||o[l]>=o.length||m[o[l]]!==void 0)return!1;m[o[l]]=!0}return!0}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../components/drawing":389,"../../lib":515,"../../lib/filter_unique.js":506,"../../lib/gup":512,"fast-isnumeric":190}],893:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/colorscale/helpers").hasColorscale,S=d("../../components/colorscale/defaults"),M=d("../../plots/domain").defaults,e=d("../../plots/array_container_defaults"),a=d("./attributes"),n=d("../parcoords/merge_length");function r(c,s,i,x,p){p("line.shape"),p("line.hovertemplate");var v=p("line.color",x.colorway[0]);if(g(c,"line")&&A.isArrayOrTypedArray(v)){if(v.length)return p("line.colorscale"),S(c,s,x,p,{prefix:"line.",cLetter:"c"}),v.length;s.line.color=i}return 1/0}function t(c,s){function i(m,l){return A.coerce(c,s,a.dimensions,m,l)}var x=i("values"),p=i("visible");if(x&&x.length||(p=s.visible=!1),p){i("label"),i("displayindex",s._index);var v=c.categoryarray,f=Array.isArray(v)&&v.length>0,y;f&&(y="array");var o=i("categoryorder",y);o==="array"?(i("categoryarray"),i("ticktext")):(delete c.categoryarray,delete c.ticktext),!f&&o==="array"&&(s.categoryorder="trace")}}ee.exports=function(s,i,x,p){function v(l,w){return A.coerce(s,i,a,l,w)}var f=e(s,i,{name:"dimensions",handleItemDefaults:t}),y=r(s,i,x,p,v);M(i,p,v),(!Array.isArray(f)||!f.length)&&(i.visible=!1),n(i,f,"values",y),v("hoveron"),v("hovertemplate"),v("arrangement"),v("bundlecolors"),v("sortpaths"),v("counts");var o={family:p.font.family,size:Math.round(p.font.size),color:p.font.color};A.coerceFont(v,"labelfont",o);var m={family:p.font.family,size:Math.round(p.font.size/1.2),color:p.font.color};A.coerceFont(v,"tickfont",m)}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/domain":593,"../parcoords/merge_length":907,"./attributes":890}],894:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:d("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":890,"./base_plot":891,"./calc":892,"./defaults":893,"./plot":896}],895:[function(d,ee,te){var A=d("@plotly/d3"),g=d("d3-interpolate").interpolateNumber,S=d("../../plot_api/plot_api"),M=d("../../components/fx"),e=d("../../lib"),a=e.strTranslate,n=d("../../components/drawing"),r=d("tinycolor2"),t=d("../../lib/svg_text_utils");function c(U,$,ne,X){var Q=$._context.staticPlot,ie=U.map(re.bind(0,$,ne)),se=X.selectAll("g.parcatslayer").data([null]);se.enter().append("g").attr("class","parcatslayer").style("pointer-events",Q?"none":"all");var ae=se.selectAll("g.trace.parcats").data(ie,s),oe=ae.enter().append("g").attr("class","trace parcats");ae.attr("transform",function(ke){return a(ke.x,ke.y)}),oe.append("g").attr("class","paths");var be=ae.select("g.paths"),ce=be.selectAll("path.path").data(function(ke){return ke.paths},s);ce.attr("fill",function(ke){return ke.model.color});var de=ce.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(ke){return ke.model.color}).attr("fill-opacity",0);m(de),ce.attr("d",function(ke){return ke.svgD}),de.empty()||ce.sort(x),ce.exit().remove(),ce.on("mouseover",p).on("mouseout",v).on("click",o),oe.append("g").attr("class","dimensions");var ye=ae.select("g.dimensions"),ge=ye.selectAll("g.dimension").data(function(ke){return ke.dimensions},s);ge.enter().append("g").attr("class","dimension"),ge.attr("transform",function(ke){return a(ke.x,0)}),ge.exit().remove();var me=ge.selectAll("g.category").data(function(ke){return ke.categories},s),Ee=me.enter().append("g").attr("class","category");me.attr("transform",function(ke){return a(0,ke.y)}),Ee.append("rect").attr("class","catrect").attr("pointer-events","none"),me.select("rect.catrect").attr("fill","none").attr("width",function(ke){return ke.width}).attr("height",function(ke){return ke.height}),_(Ee);var Pe=me.selectAll("rect.bandrect").data(function(ke){return ke.bands},s);Pe.each(function(){e.raiseToTop(this)}),Pe.attr("fill",function(ke){return ke.color});var Ne=Pe.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(ke){return ke.color}).attr("fill-opacity",0);Pe.attr("fill",function(ke){return ke.color}).attr("width",function(ke){return ke.width}).attr("height",function(ke){return ke.height}).attr("y",function(ke){return ke.y}).attr("cursor",function(ke){return ke.parcatsViewModel.arrangement==="fixed"?"default":ke.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),b(Ne),Pe.exit().remove(),Ee.append("text").attr("class","catlabel").attr("pointer-events","none");var we=$._fullLayout.paper_bgcolor;me.select("text.catlabel").attr("text-anchor",function(ke){return i(ke)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",t.makeTextShadow(we)).style("fill","rgb(0, 0, 0)").attr("x",function(ke){return i(ke)?ke.width+5:-5}).attr("y",function(ke){return ke.height/2}).text(function(ke){return ke.model.categoryLabel}).each(function(ke){n.font(A.select(this),ke.parcatsViewModel.categorylabelfont),t.convertToTspans(A.select(this),$)}),Ee.append("text").attr("class","dimlabel"),me.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(ke){return ke.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(ke){return ke.width/2}).attr("y",-5).text(function(ke,Xe){return Xe===0?ke.parcatsViewModel.model.dimensions[ke.model.dimensionInd].dimensionLabel:null}).each(function(ke){n.font(A.select(this),ke.parcatsViewModel.labelfont)}),me.selectAll("rect.bandrect").on("mouseover",R).on("mouseout",O),me.exit().remove(),ge.call(A.behavior.drag().origin(function(ke){return{x:ke.x,y:0}}).on("dragstart",F).on("drag",N).on("dragend",G)),ae.each(function(ke){ke.traceSelection=A.select(this),ke.pathSelection=A.select(this).selectAll("g.paths").selectAll("path.path"),ke.dimensionSelection=A.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),ae.exit().remove()}ee.exports=function(U,$,ne,X){c(ne,U,X,$)};function s(U){return U.key}function i(U){var $=U.parcatsViewModel.dimensions.length,ne=U.parcatsViewModel.dimensions[$-1].model.dimensionInd;return U.model.dimensionInd===ne}function x(U,$){return U.model.rawColor>$.model.rawColor?1:U.model.rawColor<$.model.rawColor?-1:0}function p(U){if(!U.parcatsViewModel.dragDimension&&U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){e.raiseToTop(this),l(A.select(this));var $=f(U),ne=y(U);if(U.parcatsViewModel.graphDiv.emit("plotly_hover",{points:$,event:A.event,constraints:ne}),U.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var X=A.mouse(this)[0],Q=U.parcatsViewModel.graphDiv,ie=U.parcatsViewModel.trace,se=Q._fullLayout,ae=se._paperdiv.node().getBoundingClientRect(),oe=U.parcatsViewModel.graphDiv.getBoundingClientRect(),be,ce,de;for(de=0;de<U.leftXs.length-1;de++)if(U.leftXs[de]+U.dimWidths[de]-2<=X&&X<=U.leftXs[de+1]+2){var ye=U.parcatsViewModel.dimensions[de],ge=U.parcatsViewModel.dimensions[de+1];be=(ye.x+ye.width+ge.x)/2,ce=(U.topYs[de]+U.topYs[de+1]+U.height)/2;break}var me=U.parcatsViewModel.x+be,Ee=U.parcatsViewModel.y+ce,Pe=r.mostReadable(U.model.color,["black","white"]),Ne=U.model.count,we=Ne/U.parcatsViewModel.model.count,ke={countLabel:Ne,probabilityLabel:we.toFixed(3)},Xe=[];U.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Xe.push(["Count:",ke.countLabel].join(" ")),U.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&Xe.push(["P:",ke.probabilityLabel].join(" "));var He=Xe.join("<br>"),Ie=A.mouse(Q)[0];M.loneHover({trace:ie,x:me-ae.left+oe.left,y:Ee-ae.top+oe.top,text:He,color:U.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:Pe,idealAlign:Ie<me?"right":"left",hovertemplate:(ie.line||{}).hovertemplate,hovertemplateLabels:ke,eventData:[{data:ie._input,fullData:ie,count:Ne,probability:we}]},{container:se._hoverlayer.node(),outerContainer:se._paper.node(),gd:Q})}}}function v(U){if(!U.parcatsViewModel.dragDimension&&(m(A.select(this)),M.loneUnhover(U.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),U.parcatsViewModel.pathSelection.sort(x),U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var $=f(U),ne=y(U);U.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:$,event:A.event,constraints:ne})}}function f(U){for(var $=[],ne=K(U.parcatsViewModel),X=0;X<U.model.valueInds.length;X++){var Q=U.model.valueInds[X];$.push({curveNumber:ne,pointNumber:Q})}return $}function y(U){for(var $={},ne=U.parcatsViewModel.model.dimensions,X=0;X<ne.length;X++){var Q=ne[X],ie=Q.categories[U.model.categoryInds[X]];$[Q.containerInd]=ie.categoryValue}return U.model.rawColor!==void 0&&($.color=U.model.rawColor),$}function o(U){if(U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var $=f(U),ne=y(U);U.parcatsViewModel.graphDiv.emit("plotly_click",{points:$,event:A.event,constraints:ne})}}function m(U){U.attr("fill",function($){return $.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function l(U){U.attr("fill-opacity",.8).attr("stroke",function($){return r.mostReadable($.model.color,["black","white"])}).attr("stroke-width",.3)}function w(U){U.select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}function _(U){U.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function h(U){U.attr("stroke","black").attr("stroke-width",1.5)}function b(U){U.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function u(U){var $=U.parcatsViewModel.pathSelection,ne=U.categoryViewModel.model.dimensionInd,X=U.categoryViewModel.model.categoryInd;return $.filter(function(Q){return Q.model.categoryInds[ne]===X&&Q.model.color===U.color})}function L(U){var $=A.select(U.parentNode).selectAll("rect.bandrect");$.each(function(ne){var X=u(ne);l(X),X.each(function(){e.raiseToTop(this)})}),w(A.select(U.parentNode))}function T(U){var $=A.select(U).datum(),ne=u($);l(ne),ne.each(function(){e.raiseToTop(this)}),A.select(U.parentNode).selectAll("rect.bandrect").filter(function(X){return X.color===$.color}).each(function(){e.raiseToTop(this),h(A.select(this))})}function k(U,$,ne){var X=A.select(U).datum(),Q=X.categoryViewModel.model,ie=X.parcatsViewModel.graphDiv,se=A.select(U.parentNode).selectAll("rect.bandrect"),ae=[];se.each(function(be){var ce=u(be);ce.each(function(de){Array.prototype.push.apply(ae,f(de))})});var oe={};oe[Q.dimensionInd]=Q.categoryValue,ie.emit($,{points:ae,event:ne,constraints:oe})}function P(U,$,ne){var X=A.select(U).datum(),Q=X.categoryViewModel.model,ie=X.parcatsViewModel.graphDiv,se=u(X),ae=[];se.each(function(be){Array.prototype.push.apply(ae,f(be))});var oe={};oe[Q.dimensionInd]=Q.categoryValue,X.rawColor!==void 0&&(oe.color=X.rawColor),ie.emit($,{points:ae,event:ne,constraints:oe})}function z(U,$,ne){U._fullLayout._calcInverseTransform(U);var X=U._fullLayout._invScaleX,Q=U._fullLayout._invScaleY,ie=A.select(ne.parentNode).select("rect.catrect"),se=ie.node().getBoundingClientRect(),ae=ie.datum(),oe=ae.parcatsViewModel,be=oe.model.dimensions[ae.model.dimensionInd],ce=oe.trace,de=se.top+se.height/2,ye,ge;oe.dimensions.length>1&&be.displayInd===oe.dimensions.length-1?(ye=se.left,ge="left"):(ye=se.left+se.width,ge="right");var me=ae.model.count,Ee=ae.model.categoryLabel,Pe=me/ae.parcatsViewModel.model.count,Ne={countLabel:me,categoryLabel:Ee,probabilityLabel:Pe.toFixed(3)},we=[];ae.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&we.push(["Count:",Ne.countLabel].join(" ")),ae.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&we.push(["P("+Ne.categoryLabel+"):",Ne.probabilityLabel].join(" "));var ke=we.join("<br>");return{trace:ce,x:X*(ye-$.left),y:Q*(de-$.top),text:ke,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:ge,hovertemplate:ce.hovertemplate,hovertemplateLabels:Ne,eventData:[{data:ce._input,fullData:ce,count:me,category:Ee,probability:Pe}]}}function I(U,$,ne){var X=[];return A.select(ne.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){var Q=this;X.push(z(U,$,Q))}),X}function D(U,$,ne){U._fullLayout._calcInverseTransform(U);var X=U._fullLayout._invScaleX,Q=U._fullLayout._invScaleY,ie=ne.getBoundingClientRect(),se=A.select(ne).datum(),ae=se.categoryViewModel,oe=ae.parcatsViewModel,be=oe.model.dimensions[ae.model.dimensionInd],ce=oe.trace,de=ie.y+ie.height/2,ye,ge;oe.dimensions.length>1&&be.displayInd===oe.dimensions.length-1?(ye=ie.left,ge="left"):(ye=ie.left+ie.width,ge="right");var me=ae.model.categoryLabel,Ee=se.parcatsViewModel.model.count,Pe=0;se.categoryViewModel.bands.forEach(function(Rt){Rt.color===se.color&&(Pe+=Rt.count)});var Ne=ae.model.count,we=0;oe.pathSelection.each(function(Rt){Rt.model.color===se.color&&(we+=Rt.model.count)});var ke=Pe/Ee,Xe=Pe/we,He=Pe/Ne,Ie={countLabel:Ee,categoryLabel:me,probabilityLabel:ke.toFixed(3)},De=[];ae.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&De.push(["Count:",Ie.countLabel].join(" ")),ae.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(De.push("P(color \u2229 "+me+"): "+Ie.probabilityLabel),De.push("P("+me+" | color): "+Xe.toFixed(3)),De.push("P(color | "+me+"): "+He.toFixed(3)));var Ge=De.join("<br>"),ht=r.mostReadable(se.color,["black","white"]);return{trace:ce,x:X*(ye-$.left),y:Q*(de-$.top),text:Ge,color:se.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:ht,fontSize:10,idealAlign:ge,hovertemplate:ce.hovertemplate,hovertemplateLabels:Ie,eventData:[{data:ce._input,fullData:ce,category:me,count:Ee,probability:ke,categorycount:Ne,colorcount:we,bandcolorcount:Pe}]}}function R(U){if(!U.parcatsViewModel.dragDimension&&U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var $=A.mouse(this)[1];if($<-1)return;var ne=U.parcatsViewModel.graphDiv,X=ne._fullLayout,Q=X._paperdiv.node().getBoundingClientRect(),ie=U.parcatsViewModel.hoveron,se=this;if(ie==="color"?(T(se),P(se,"plotly_hover",A.event)):(L(se),k(se,"plotly_hover",A.event)),U.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var ae;ie==="category"?ae=z(ne,Q,se):ie==="color"?ae=D(ne,Q,se):ie==="dimension"&&(ae=I(ne,Q,se)),ae&&M.loneHover(ae,{container:X._hoverlayer.node(),outerContainer:X._paper.node(),gd:ne})}}}function O(U){var $=U.parcatsViewModel;if(!$.dragDimension&&(m($.pathSelection),_($.dimensionSelection.selectAll("g.category")),b($.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),M.loneUnhover($.graphDiv._fullLayout._hoverlayer.node()),$.pathSelection.sort(x),$.hoverinfoItems.indexOf("skip")===-1)){var ne=U.parcatsViewModel.hoveron,X=this;ne==="color"?P(X,"plotly_unhover",A.event):k(X,"plotly_unhover",A.event)}}function F(U){U.parcatsViewModel.arrangement!=="fixed"&&(U.dragDimensionDisplayInd=U.model.displayInd,U.initialDragDimensionDisplayInds=U.parcatsViewModel.model.dimensions.map(function($){return $.displayInd}),U.dragHasMoved=!1,U.dragCategoryDisplayInd=null,A.select(this).selectAll("g.category").select("rect.catrect").each(function($){var ne=A.mouse(this)[0],X=A.mouse(this)[1];-2<=ne&&ne<=$.width+2&&-2<=X&&X<=$.height+2&&(U.dragCategoryDisplayInd=$.model.displayInd,U.initialDragCategoryDisplayInds=U.model.categories.map(function(Q){return Q.displayInd}),$.model.dragY=$.y,e.raiseToTop(this.parentNode),A.select(this.parentNode).selectAll("rect.bandrect").each(function(Q){Q.y<X&&X<=Q.y+Q.height&&(U.potentialClickBand=this)}))}),U.parcatsViewModel.dragDimension=U,M.loneUnhover(U.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function N(U){if(U.parcatsViewModel.arrangement!=="fixed"&&(U.dragHasMoved=!0,U.dragDimensionDisplayInd!==null)){var $=U.dragDimensionDisplayInd,ne=$-1,X=$+1,Q=U.parcatsViewModel.dimensions[$];if(U.dragCategoryDisplayInd!==null){var ie=Q.categories[U.dragCategoryDisplayInd];ie.model.dragY+=A.event.dy;var se=ie.model.dragY,ae=ie.model.displayInd,oe=Q.categories,be=oe[ae-1],ce=oe[ae+1];be!==void 0&&se<be.y+be.height/2&&(ie.model.displayInd=be.model.displayInd,be.model.displayInd=ae),ce!==void 0&&se+ie.height>ce.y+ce.height/2&&(ie.model.displayInd=ce.model.displayInd,ce.model.displayInd=ae),U.dragCategoryDisplayInd=ie.model.displayInd}if(U.dragCategoryDisplayInd===null||U.parcatsViewModel.arrangement==="freeform"){Q.model.dragX=A.event.x;var de=U.parcatsViewModel.dimensions[ne],ye=U.parcatsViewModel.dimensions[X];de!==void 0&&Q.model.dragX<de.x+de.width&&(Q.model.displayInd=de.model.displayInd,de.model.displayInd=$),ye!==void 0&&Q.model.dragX+Q.width>ye.x&&(Q.model.displayInd=ye.model.displayInd,ye.model.displayInd=U.dragDimensionDisplayInd),U.dragDimensionDisplayInd=Q.model.displayInd}q(U.parcatsViewModel),j(U.parcatsViewModel),Y(U.parcatsViewModel),W(U.parcatsViewModel)}}function G(U){if(U.parcatsViewModel.arrangement!=="fixed"&&U.dragDimensionDisplayInd!==null){A.select(this).selectAll("text").attr("font-weight","normal");var $={},ne=K(U.parcatsViewModel),X=U.parcatsViewModel.model.dimensions.map(function(ye){return ye.displayInd}),Q=U.initialDragDimensionDisplayInds.some(function(ye,ge){return ye!==X[ge]});Q&&X.forEach(function(ye,ge){var me=U.parcatsViewModel.model.dimensions[ge].containerInd;$["dimensions["+me+"].displayindex"]=ye});var ie=!1;if(U.dragCategoryDisplayInd!==null){var se=U.model.categories.map(function(ye){return ye.displayInd});if(ie=U.initialDragCategoryDisplayInds.some(function(ye,ge){return ye!==se[ge]}),ie){var ae=U.model.categories.slice().sort(function(ye,ge){return ye.displayInd-ge.displayInd}),oe=ae.map(function(ye){return ye.categoryValue}),be=ae.map(function(ye){return ye.categoryLabel});$["dimensions["+U.model.containerInd+"].categoryarray"]=[oe],$["dimensions["+U.model.containerInd+"].ticktext"]=[be],$["dimensions["+U.model.containerInd+"].categoryorder"]="array"}}if(U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!U.dragHasMoved&&U.potentialClickBand&&(U.parcatsViewModel.hoveron==="color"?P(U.potentialClickBand,"plotly_click",A.event.sourceEvent):k(U.potentialClickBand,"plotly_click",A.event.sourceEvent)),U.model.dragX=null,U.dragCategoryDisplayInd!==null){var ce=U.parcatsViewModel.dimensions[U.dragDimensionDisplayInd].categories[U.dragCategoryDisplayInd];ce.model.dragY=null,U.dragCategoryDisplayInd=null}U.dragDimensionDisplayInd=null,U.parcatsViewModel.dragDimension=null,U.dragHasMoved=null,U.potentialClickBand=null,q(U.parcatsViewModel),j(U.parcatsViewModel);var de=A.transition().duration(300).ease("cubic-in-out");de.each(function(){Y(U.parcatsViewModel,!0),W(U.parcatsViewModel,!0)}).each("end",function(){(Q||ie)&&S.restyle(U.parcatsViewModel.graphDiv,$,[ne])})}}function K(U){for(var $,ne=U.graphDiv._fullData,X=0;X<ne.length;X++)if(U.key===ne[X].uid){$=X;break}return $}function W(U,$){$===void 0&&($=!1);function ne(X){return $?X.transition():X}U.pathSelection.data(function(X){return X.paths},s),ne(U.pathSelection).attr("d",function(X){return X.svgD})}function Y(U,$){$===void 0&&($=!1);function ne(oe){return $?oe.transition():oe}U.dimensionSelection.data(function(oe){return oe.dimensions},s);var X=U.dimensionSelection.selectAll("g.category").data(function(oe){return oe.categories},s);ne(U.dimensionSelection).attr("transform",function(oe){return a(oe.x,0)}),ne(X).attr("transform",function(oe){return a(0,oe.y)});var Q=X.select(".dimlabel");Q.text(function(oe,be){return be===0?oe.parcatsViewModel.model.dimensions[oe.model.dimensionInd].dimensionLabel:null});var ie=X.select(".catlabel");ie.attr("text-anchor",function(oe){return i(oe)?"start":"end"}).attr("x",function(oe){return i(oe)?oe.width+5:-5}).each(function(oe){var be,ce;i(oe)?(be=oe.width+5,ce="start"):(be=-5,ce="end"),A.select(this).selectAll("tspan").attr("x",be).attr("text-anchor",ce)});var se=X.selectAll("rect.bandrect").data(function(oe){return oe.bands},s),ae=se.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(oe){return oe.color}).attr("fill-opacity",0);se.attr("fill",function(oe){return oe.color}).attr("width",function(oe){return oe.width}).attr("height",function(oe){return oe.height}).attr("y",function(oe){return oe.y}),b(ae),se.each(function(){e.raiseToTop(this)}),se.exit().remove()}function re(U,$,ne){var X=ne[0],Q=$.margin||{l:80,r:80,t:100,b:80},ie=X.trace,se=ie.domain,ae=$.width,oe=$.height,be=Math.floor(ae*(se.x[1]-se.x[0])),ce=Math.floor(oe*(se.y[1]-se.y[0])),de=se.x[0]*ae+Q.l,ye=$.height-se.y[1]*$.height+Q.t,ge=ie.line.shape,me;ie.hoverinfo==="all"?me=["count","probability"]:me=(ie.hoverinfo||"").split("+");var Ee={trace:ie,key:ie.uid,model:X,x:de,y:ye,width:be,height:ce,hoveron:ie.hoveron,hoverinfoItems:me,arrangement:ie.arrangement,bundlecolors:ie.bundlecolors,sortpaths:ie.sortpaths,labelfont:ie.labelfont,categorylabelfont:ie.tickfont,pathShape:ge,dragDimension:null,margin:Q,paths:[],dimensions:[],graphDiv:U,traceSelection:null,pathSelection:null,dimensionSelection:null};return X.dimensions&&(q(Ee),j(Ee)),Ee}function ue(U,$,ne,X,Q){var ie=[],se=[],ae,oe;for(oe=0;oe<ne.length-1;oe++)ae=g(ne[oe]+U[oe],U[oe+1]),ie.push(ae(Q)),se.push(ae(1-Q));var be="M "+U[0]+","+$[0];for(be+="l"+ne[0]+",0 ",oe=1;oe<ne.length;oe++)be+="C"+ie[oe-1]+","+$[oe-1]+" "+se[oe-1]+","+$[oe]+" "+U[oe]+","+$[oe],be+="l"+ne[oe]+",0 ";for(be+="l0,"+X+" ",be+="l -"+ne[ne.length-1]+",0 ",oe=ne.length-2;oe>=0;oe--)be+="C"+se[oe]+","+($[oe+1]+X)+" "+ie[oe]+","+($[oe]+X)+" "+(U[oe]+ne[oe])+","+($[oe]+X),be+="l-"+ne[oe]+",0 ";return be+="Z",be}function j(U){var $=U.dimensions,ne=U.model,X=$.map(function(Mt){return Mt.categories.map(function(Yt){return Yt.y})}),Q=U.model.dimensions.map(function(Mt){return Mt.categories.map(function(Yt){return Yt.displayInd})}),ie=U.model.dimensions.map(function(Mt){return Mt.displayInd}),se=U.dimensions.map(function(Mt){return Mt.model.dimensionInd}),ae=$.map(function(Mt){return Mt.x}),oe=$.map(function(Mt){return Mt.width}),be=[];for(var ce in ne.paths)ne.paths.hasOwnProperty(ce)&&be.push(ne.paths[ce]);function de(Mt){var Yt=Mt.categoryInds.map(function(St,Ye){return Q[Ye][St]}),zt=se.map(function(St){return Yt[St]});return zt}be.sort(function(Mt,Yt){var zt=de(Mt),St=de(Yt);return U.sortpaths==="backward"&&(zt.reverse(),St.reverse()),zt.push(Mt.valueInds[0]),St.push(Yt.valueInds[0]),U.bundlecolors&&(zt.unshift(Mt.rawColor),St.unshift(Yt.rawColor)),zt<St?-1:zt>St?1:0});for(var ye=new Array(be.length),ge=$[0].model.count,me=$[0].categories.map(function(Mt){return Mt.height}).reduce(function(Mt,Yt){return Mt+Yt}),Ee=0;Ee<be.length;Ee++){var Pe=be[Ee],Ne;ge>0?Ne=me*(Pe.count/ge):Ne=0;for(var we=new Array(X.length),ke=0;ke<Pe.categoryInds.length;ke++){var Xe=Pe.categoryInds[ke],He=Q[ke][Xe],Ie=ie[ke];we[Ie]=X[Ie][He],X[Ie][He]+=Ne;var De=U.dimensions[Ie].categories[He],Ge=De.bands.length,ht=De.bands[Ge-1];if(ht===void 0||Pe.rawColor!==ht.rawColor){var Rt=ht===void 0?0:ht.y+ht.height;De.bands.push({key:Rt,color:Pe.color,rawColor:Pe.rawColor,height:Ne,width:De.width,count:Pe.count,y:Rt,categoryViewModel:De,parcatsViewModel:U})}else{var Kt=De.bands[Ge-1];Kt.height+=Ne,Kt.count+=Pe.count}}var It;U.pathShape==="hspline"?It=ue(ae,we,oe,Ne,.5):It=ue(ae,we,oe,Ne,0),ye[Ee]={key:Pe.valueInds[0],model:Pe,height:Ne,leftXs:ae,topYs:we,dimWidths:oe,svgD:It,parcatsViewModel:U}}U.paths=ye}function q(U){var $=U.model.dimensions.map(function(se){return{displayInd:se.displayInd,dimensionInd:se.dimensionInd}});$.sort(function(se,ae){return se.displayInd-ae.displayInd});var ne=[];for(var X in $){var Q=$[X].dimensionInd,ie=U.model.dimensions[Q];ne.push(V(U,ie))}U.dimensions=ne}function V(U,$){var ne=40,X=16,Q=U.model.dimensions.length,ie=$.displayInd,se,ae,oe;Q>1?se=(U.width-2*ne-X)/(Q-1):se=0,ae=ne,oe=ae+se*ie;var be=[],ce=U.model.maxCats,de=$.categories.length,ye=8,ge=$.count,me=U.height-ye*(ce-1),Ee,Pe,Ne,we,ke,Xe=(ce-de)*ye/2,He=$.categories.map(function(Ie){return{displayInd:Ie.displayInd,categoryInd:Ie.categoryInd}});for(He.sort(function(Ie,De){return Ie.displayInd-De.displayInd}),ke=0;ke<de;ke++)we=He[ke].categoryInd,Pe=$.categories[we],ge>0?Ee=Pe.count/ge*me:Ee=0,Ne={key:Pe.valueInds[0],model:Pe,width:X,height:Ee,y:Pe.dragY!==null?Pe.dragY:Xe,bands:[],parcatsViewModel:U},Xe=Xe+Ee+ye,be.push(Ne);return{key:$.dimensionInd,x:$.dragX!==null?$.dragX:oe,y:0,width:X,model:$,categories:be,parcatsViewModel:U,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}},{"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_api":552,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:313}],896:[function(d,ee,te){var A=d("./parcats");ee.exports=function(S,M,e,a){var n=S._fullLayout,r=n._paper,t=n._size;A(S,r,M,{width:t.w,height:t.h,margin:{t:t.t,r:t.r,b:t.b,l:t.l}},e,a)}},{"./parcats":895}],897:[function(d,ee,te){var A=d("../../components/colorscale/attributes"),g=d("../../plots/cartesian/layout_attributes"),S=d("../../plots/font_attributes"),M=d("../../plots/domain").attributes,e=d("../../lib/extend").extendFlat,a=d("../../plot_api/plot_template").templatedArray;ee.exports={domain:M({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:S({editType:"plot"}),tickfont:S({editType:"plot"}),rangefont:S({editType:"plot"}),dimensions:a("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},g.tickvals,{editType:"plot"}),ticktext:e({},g.ticktext,{editType:"plot"}),tickformat:e({},g.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},A("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"})),unselected:{line:{color:{valType:"color",dflt:"#7f7f7f",editType:"plot"},opacity:{valType:"number",min:0,max:1,dflt:"auto",editType:"plot"},editType:"plot"},editType:"plot"}}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],898:[function(d,ee,te){var A=d("./constants"),g=d("@plotly/d3"),S=d("../../lib/gup").keyFun,M=d("../../lib/gup").repeat,e=d("../../lib").sorterAsc,a=d("../../lib").strTranslate,n=A.bar.snapRatio;function r(G,K){return G*(1-n)+K*n}var t=A.bar.snapClose;function c(G,K){return G*(1-t)+K*t}function s(G,K,W,Y){if(i(W,Y))return W;var re=G?-1:1,ue=0,j=K.length-1;if(re<0){var q=ue;ue=j,j=q}for(var V=K[ue],U=V,$=ue;re*$<re*j;$+=re){var ne=$+re,X=K[ne];if(re*W<re*c(V,X))return r(V,U);if(re*W<re*X||ne===j)return r(X,V);U=V,V=X}}function i(G,K){for(var W=0;W<K.length;W++)if(G>=K[W][0]&&G<=K[W][1])return!0;return!1}function x(G){G.attr("x",-A.bar.captureWidth/2).attr("width",A.bar.captureWidth)}function p(G){G.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function v(G){if(!G.brush.filterSpecified)return"0,"+G.height;for(var K=f(G.brush.filter.getConsolidated(),G.height),W=[0],Y,re,ue,j=K.length?K[0][0]:null,q=0;q<K.length;q++)Y=K[q],re=Y[1]-Y[0],W.push(j),W.push(re),ue=q+1,ue<K.length&&(j=K[ue][0]-Y[1]);return W.push(G.height),W}function f(G,K){return G.map(function(W){return W.map(function(Y){return Math.max(0,Y*K)}).sort(e)})}function y(G,K){var W=A.bar.handleHeight;if(!(K>G[1]+W||K<G[0]-W))return K>=.9*G[1]+.1*G[0]?"n":K<=.9*G[0]+.1*G[1]?"s":"ns"}function o(){g.select(document.body).style("cursor",null)}function m(G){G.attr("stroke-dasharray",v)}function l(G,K){var W=g.select(G).selectAll(".highlight, .highlight-shadow"),Y=K?W.transition().duration(A.bar.snapDuration).each("end",K):W;m(Y)}function w(G,K){var W=G.brush,Y=W.filterSpecified,re=NaN,ue={},j;if(Y){var q=G.height,V=W.filter.getConsolidated(),U=f(V,q),$=NaN,ne=NaN,X=NaN;for(j=0;j<=U.length;j++){var Q=U[j];if(Q&&Q[0]<=K&&K<=Q[1]){$=j;break}else if(ne=j?j-1:NaN,Q&&Q[0]>K){X=j;break}}if(re=$,isNaN(re)&&(isNaN(ne)||isNaN(X)?re=isNaN(ne)?X:ne:re=K-U[ne][1]<U[X][0]-K?ne:X),!isNaN(re)){var ie=U[re],se=y(ie,K);se&&(ue.interval=V[re],ue.intervalPix=ie,ue.region=se)}}if(G.ordinal&&!ue.region){var ae=G.unitTickvals,oe=G.unitToPaddedPx.invert(K);for(j=0;j<ae.length;j++){var be=[ae[Math.max(j-1,0)]*.25+ae[j]*.75,ae[Math.min(j+1,ae.length-1)]*.25+ae[j]*.75];if(oe>=be[0]&&oe<=be[1]){ue.clickableOrdinalRange=be;break}}}return ue}function _(G,K){g.event.sourceEvent.stopPropagation();var W=K.height-g.mouse(G)[1]-2*A.verticalPadding,Y=K.unitToPaddedPx.invert(W),re=K.brush,ue=w(K,W),j=ue.interval,q=re.svgBrush;if(q.wasDragged=!1,q.grabbingBar=ue.region==="ns",q.grabbingBar){var V=j.map(K.unitToPaddedPx);q.grabPoint=W-V[0]-A.verticalPadding,q.barLength=V[1]-V[0]}q.clickableOrdinalRange=ue.clickableOrdinalRange,q.stayingIntervals=K.multiselect&&re.filterSpecified?re.filter.getConsolidated():[],j&&(q.stayingIntervals=q.stayingIntervals.filter(function(U){return U[0]!==j[0]&&U[1]!==j[1]})),q.startExtent=ue.region?j[ue.region==="s"?1:0]:Y,K.parent.inBrushDrag=!0,q.brushStartCallback()}function h(G,K){g.event.sourceEvent.stopPropagation();var W=K.height-g.mouse(G)[1]-2*A.verticalPadding,Y=K.brush.svgBrush;Y.wasDragged=!0,Y._dragging=!0,Y.grabbingBar?Y.newExtent=[W-Y.grabPoint,W+Y.barLength-Y.grabPoint].map(K.unitToPaddedPx.invert):Y.newExtent=[Y.startExtent,K.unitToPaddedPx.invert(W)].sort(e),K.brush.filterSpecified=!0,Y.extent=Y.stayingIntervals.concat([Y.newExtent]),Y.brushCallback(K),l(G.parentNode)}function b(G,K){var W=K.brush,Y=W.filter,re=W.svgBrush;re._dragging||(u(G,K),h(G,K),K.brush.svgBrush.wasDragged=!1),re._dragging=!1;var ue=g.event;ue.sourceEvent.stopPropagation();var j=re.grabbingBar;if(re.grabbingBar=!1,re.grabLocation=void 0,K.parent.inBrushDrag=!1,o(),!re.wasDragged){re.wasDragged=void 0,re.clickableOrdinalRange?W.filterSpecified&&K.multiselect?re.extent.push(re.clickableOrdinalRange):(re.extent=[re.clickableOrdinalRange],W.filterSpecified=!0):j?(re.extent=re.stayingIntervals,re.extent.length===0&&I(W)):I(W),re.brushCallback(K),l(G.parentNode),re.brushEndCallback(W.filterSpecified?Y.getConsolidated():[]);return}var q=function(){Y.set(Y.getConsolidated())};if(K.ordinal){var V=K.unitTickvals;V[V.length-1]<V[0]&&V.reverse(),re.newExtent=[s(0,V,re.newExtent[0],re.stayingIntervals),s(1,V,re.newExtent[1],re.stayingIntervals)];var U=re.newExtent[1]>re.newExtent[0];re.extent=re.stayingIntervals.concat(U?[re.newExtent]:[]),re.extent.length||I(W),re.brushCallback(K),U?l(G.parentNode,q):(q(),l(G.parentNode))}else q();re.brushEndCallback(W.filterSpecified?Y.getConsolidated():[])}function u(G,K){var W=K.height-g.mouse(G)[1]-2*A.verticalPadding,Y=w(K,W),re="crosshair";Y.clickableOrdinalRange?re="pointer":Y.region&&(re=Y.region+"-resize"),g.select(document.body).style("cursor",re)}function L(G){G.on("mousemove",function(K){g.event.preventDefault(),K.parent.inBrushDrag||u(this,K)}).on("mouseleave",function(K){K.parent.inBrushDrag||o()}).call(g.behavior.drag().on("dragstart",function(K){_(this,K)}).on("drag",function(K){h(this,K)}).on("dragend",function(K){b(this,K)}))}function T(G,K){return G[0]-K[0]}function k(G,K,W){var Y=W._context.staticPlot,re=G.selectAll(".background").data(M);re.enter().append("rect").classed("background",!0).call(x).call(p).style("pointer-events",Y?"none":"auto").attr("transform",a(0,A.verticalPadding)),re.call(L).attr("height",function(q){return q.height-A.verticalPadding});var ue=G.selectAll(".highlight-shadow").data(M);ue.enter().append("line").classed("highlight-shadow",!0).attr("x",-A.bar.width/2).attr("stroke-width",A.bar.width+A.bar.strokeWidth).attr("stroke",K).attr("opacity",A.bar.strokeOpacity).attr("stroke-linecap","butt"),ue.attr("y1",function(q){return q.height}).call(m);var j=G.selectAll(".highlight").data(M);j.enter().append("line").classed("highlight",!0).attr("x",-A.bar.width/2).attr("stroke-width",A.bar.width-A.bar.strokeWidth).attr("stroke",A.bar.fillColor).attr("opacity",A.bar.fillOpacity).attr("stroke-linecap","butt"),j.attr("y1",function(q){return q.height}).call(m)}function P(G,K,W){var Y=G.selectAll("."+A.cn.axisBrush).data(M,S);Y.enter().append("g").classed(A.cn.axisBrush,!0),k(Y,K,W)}function z(G){return G.svgBrush.extent.map(function(K){return K.slice()})}function I(G){G.filterSpecified=!1,G.svgBrush.extent=[[-1/0,1/0]]}function D(G){return function(W){var Y=W.brush,re=z(Y),ue=re.slice();Y.filter.set(ue),G()}}function R(G){for(var K=G.slice(),W=[],Y,re=K.shift();re;){for(Y=re.slice();(re=K.shift())&&re[0]<=Y[1];)Y[1]=Math.max(Y[1],re[1]);W.push(Y)}return W.length===1&&W[0][0]>W[0][1]&&(W=[]),W}function O(){var G=[],K,W;return{set:function(Y){G=Y.map(function(re){return re.slice().sort(e)}).sort(T),G.length===1&&G[0][0]===-1/0&&G[0][1]===1/0&&(G=[[0,-1]]),K=R(G),W=G.reduce(function(re,ue){return[Math.min(re[0],ue[0]),Math.max(re[1],ue[1])]},[1/0,-1/0])},get:function(){return G.slice()},getConsolidated:function(){return K},getBounds:function(){return W}}}function F(G,K,W,Y,re,ue){var j=O();return j.set(W),{filter:j,filterSpecified:K,svgBrush:{extent:[],brushStartCallback:Y,brushCallback:D(re),brushEndCallback:ue}}}function N(G,K){if(Array.isArray(G[0])?(G=G.map(function(Y){return Y.sort(e)}),K.multiselect?G=R(G.sort(T)):G=[G[0]]):G=[G.sort(e)],K.tickvals){var W=K.tickvals.slice().sort(e);if(G=G.map(function(Y){var re=[s(0,W,Y[0],[]),s(1,W,Y[1],[])];if(re[1]>re[0])return re}).filter(function(Y){return Y}),!G.length)return}return G.length>1?G:G[0]}ee.exports={makeBrush:F,ensureAxisBrush:P,cleanRanges:N}},{"../../lib":515,"../../lib/gup":512,"./constants":902,"@plotly/d3":58}],899:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:d("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":897,"./base_plot":900,"./calc":901,"./defaults":903}],900:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../plots/get_data").getModuleCalcData,S=d("./plot"),M=d("../../constants/xmlns_namespaces");te.name="parcoords",te.plot=function(e){var a=g(e.calcdata,"parcoords")[0];a.length&&S(e,a)},te.clean=function(e,a,n,r){var t=r._has&&r._has("parcoords"),c=a._has&&a._has("parcoords");t&&!c&&(r._paperdiv.selectAll(".parcoords").remove(),r._glimages.selectAll("*").remove())},te.toSVG=function(e){var a=e._fullLayout._glimages,n=A.select(e).selectAll(".svg-container"),r=n.filter(function(c,s){return s===n.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function t(){var c=this,s=c.toDataURL("image/png"),i=a.append("svg:image");i.attr({xmlns:M.svg,"xlink:href":s,preserveAspectRatio:"none",x:0,y:0,width:c.style.width,height:c.style.height})}r.each(t),window.setTimeout(function(){A.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":492,"../../plots/get_data":602,"./plot":909,"@plotly/d3":58}],901:[function(d,ee,te){var A=d("../../lib").isArrayOrTypedArray,g=d("../../components/colorscale"),S=d("../../lib/gup").wrap;ee.exports=function(a,n){var r,t;return g.hasColorscale(n,"line")&&A(n.line.color)?(r=n.line.color,t=g.extractOpts(n.line).colorscale,g.calc(a,n,{vals:r,containerStr:"line",cLetter:"c"})):(r=M(n._length),t=[[0,n.line.color],[1,n.line.color]]),S({lineColor:r,cscale:t})};function M(e){for(var a=new Array(e),n=0;n<e;n++)a[n]=.5;return a}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512}],902:[function(d,ee,te){ee.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],903:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/colorscale/helpers").hasColorscale,S=d("../../components/colorscale/defaults"),M=d("../../plots/domain").defaults,e=d("../../plots/array_container_defaults"),a=d("../../plots/cartesian/axes"),n=d("./attributes"),r=d("./axisbrush"),t=d("./constants").maxDimensionCount,c=d("./merge_length");function s(x,p,v,f,y){var o=y("line.color",v);if(g(x,"line")&&A.isArrayOrTypedArray(o)){if(o.length)return y("line.colorscale"),S(x,p,f,y,{prefix:"line.",cLetter:"c"}),o.length;p.line.color=v}return 1/0}function i(x,p,v,f){function y(_,h){return A.coerce(x,p,n.dimensions,_,h)}var o=y("values"),m=y("visible");if(o&&o.length||(m=p.visible=!1),m){y("label"),y("tickvals"),y("ticktext"),y("tickformat");var l=y("range");p._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:l},a.setConvert(p._ax,f.layout),y("multiselect");var w=y("constraintrange");w&&(p.constraintrange=r.cleanRanges(w,p))}}ee.exports=function(p,v,f,y){function o(h,b){return A.coerce(p,v,n,h,b)}var m=p.dimensions;Array.isArray(m)&&m.length>t&&(A.log("parcoords traces support up to "+t+" dimensions at the moment"),m.splice(t));var l=e(p,v,{name:"dimensions",layout:y,handleItemDefaults:i}),w=s(p,v,f,y,o);M(v,y,o),(!Array.isArray(l)||!l.length)&&(v.visible=!1),c(v,l,"values",w);var _={family:y.font.family,size:Math.round(y.font.size/1.2),color:y.font.color};A.coerceFont(o,"labelfont",_),A.coerceFont(o,"tickfont",_),A.coerceFont(o,"rangefont",_),o("labelangle"),o("labelside"),o("unselected.line.color"),o("unselected.line.opacity")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../../plots/domain":593,"./attributes":897,"./axisbrush":898,"./constants":902,"./merge_length":907}],904:[function(d,ee,te){var A=d("../../lib").isTypedArray;te.convertTypedArray=function(g){return A(g)?Array.prototype.slice.call(g):g},te.isOrdinal=function(g){return!!g.tickvals},te.isVisible=function(g){return g.visible||!("visible"in g)}},{"../../lib":515}],905:[function(d,ee,te){var A=d("./base_index");A.plot=d("./plot"),ee.exports=A},{"./base_index":899,"./plot":909}],906:[function(d,ee,te){var A=d("glslify"),g=A([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;
uniform sampler2D maskTexture, palette;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(maskTexture,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),S=A([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),M=d("./constants").maxDimensionCount,e=d("../../lib"),a=1e-6,n=2048,r=new Uint8Array(4),t=new Uint8Array(4),c={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function s(u){u.read({x:0,y:0,width:1,height:1,data:r})}function i(u,L,T,k,P){var z=u._gl;z.enable(z.SCISSOR_TEST),z.scissor(L,T,k,P),u.clear({color:[0,0,0,0],depth:1})}function x(u,L,T,k,P,z){var I=z.key;function D(R){var O=Math.min(k,P-R*k);R===0&&(window.cancelAnimationFrame(T.currentRafs[I]),delete T.currentRafs[I],i(u,z.scissorX,z.scissorY,z.scissorWidth,z.viewBoxSize[1])),!T.clearOnly&&(z.count=2*O,z.offset=2*R*k,L(z),R*k+O<P&&(T.currentRafs[I]=window.requestAnimationFrame(function(){D(R+1)})),T.drawCompleted=!1)}T.drawCompleted||(s(u),T.drawCompleted=!0),D(0)}function p(u){return Math.max(a,Math.min(1-a,u))}function v(u,L){for(var T=new Array(256),k=0;k<256;k++)T[k]=u(k/255).concat(L);return T}function f(u,L){return(u>>>8*L)%256/255}function y(u,L,T){for(var k=new Array(u*(M+4)),P=0,z=0;z<u;z++){for(var I=0;I<M;I++)k[P++]=I<L.length?L[I].paddedUnitValues[z]:.5;k[P++]=f(z,2),k[P++]=f(z,1),k[P++]=f(z,0),k[P++]=p(T[z])}return k}function o(u,L,T){for(var k=new Array(L*8),P=0,z=0;z<L;z++)for(var I=0;I<2;I++)for(var D=0;D<4;D++){var R=u*4+D,O=T[z*64+R];R===63&&I===0&&(O*=-1),k[P++]=O}return k}function m(u){var L="0"+u;return L.substr(L.length-2)}function l(u){return u<M?"p"+m(u+1)+"_"+m(u+4):"colors"}function w(u,L,T){for(var k=0;k<=M;k+=4)u[l(k)](o(k/4,L,T))}function _(u){for(var L={},T=0;T<=M;T+=4)L[l(T)]=u.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return L}function h(u,L,T,k,P,z,I,D,R,O,F,N,G,K){for(var W=[[],[]],Y=0;Y<64;Y++)W[0][Y]=Y===P?1:0,W[1][Y]=Y===z?1:0;I*=K,D*=K,R*=K,O*=K;var re=u.lines.canvasOverdrag*K,ue=u.domain,j=u.canvasWidth*K,q=u.canvasHeight*K,V=u.pad.l*K,U=u.pad.b*K,$=u.layoutHeight*K,ne=u.layoutWidth*K,X=u.deselectedLines.color,Q=u.deselectedLines.opacity,ie=e.extendFlat({key:F,resolution:[j,q],viewBoxPos:[I+re,D],viewBoxSize:[R,O],i0:P,i1:z,dim0A:W[0].slice(0,16),dim0B:W[0].slice(16,32),dim0C:W[0].slice(32,48),dim0D:W[0].slice(48,64),dim1A:W[1].slice(0,16),dim1B:W[1].slice(16,32),dim1C:W[1].slice(32,48),dim1D:W[1].slice(48,64),drwLayer:N,contextColor:[X[0]/255,X[1]/255,X[2]/255,Q!=="auto"?X[3]*Q:Math.max(1/255,Math.pow(1/u.lines.color.length,1/3))],scissorX:(k===L?0:I+re)+(V-re)+ne*ue.x[0],scissorWidth:(k===T?j-I+re:R+.5)+(k===L?I+re:0),scissorY:D+U+$*ue.y[0],scissorHeight:O,viewportX:V-re+ne*ue.x[0],viewportY:U+$*ue.y[0],viewportWidth:j,viewportHeight:q},G);return ie}function b(u){var L=n-1,T=Math.max(0,Math.floor(u[0]*L),0),k=Math.min(L,Math.ceil(u[1]*L),L);return[Math.min(T,k),Math.max(T,k)]}ee.exports=function(u,L){var T=L.context,k=L.pick,P=L.regl,z=P._gl,I=z.getParameter(z.ALIASED_LINE_WIDTH_RANGE),D=Math.max(I[0],Math.min(I[1],L.viewModel.plotGlPixelRatio)),R={currentRafs:{},drawCompleted:!0,clearOnly:!1},O,F,N,G,K=_(P),W,Y=P.texture(c),re=[];j(L);var ue=P({profile:!1,blend:{enable:T,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!T,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:P.prop("scissorX"),y:P.prop("scissorY"),width:P.prop("scissorWidth"),height:P.prop("scissorHeight")}},viewport:{x:P.prop("viewportX"),y:P.prop("viewportY"),width:P.prop("viewportWidth"),height:P.prop("viewportHeight")},dither:!1,vert:g,frag:S,primitive:"lines",lineWidth:D,attributes:K,uniforms:{resolution:P.prop("resolution"),viewBoxPos:P.prop("viewBoxPos"),viewBoxSize:P.prop("viewBoxSize"),dim0A:P.prop("dim0A"),dim1A:P.prop("dim1A"),dim0B:P.prop("dim0B"),dim1B:P.prop("dim1B"),dim0C:P.prop("dim0C"),dim1C:P.prop("dim1C"),dim0D:P.prop("dim0D"),dim1D:P.prop("dim1D"),loA:P.prop("loA"),hiA:P.prop("hiA"),loB:P.prop("loB"),hiB:P.prop("hiB"),loC:P.prop("loC"),hiC:P.prop("hiC"),loD:P.prop("loD"),hiD:P.prop("hiD"),palette:Y,contextColor:P.prop("contextColor"),maskTexture:P.prop("maskTexture"),drwLayer:P.prop("drwLayer"),maskHeight:P.prop("maskHeight")},offset:P.prop("offset"),count:P.prop("count")});function j(X){O=X.model,F=X.viewModel,N=F.dimensions.slice(),G=N[0]?N[0].values.length:0;var Q=O.lines,ie=k?Q.color.map(function(ae,oe){return oe/Q.color.length}):Q.color,se=y(G,N,ie);w(K,G,se),!T&&!k&&(Y=P.texture(e.extendFlat({data:v(O.unitToColor,255)},c)))}function q(X){var Q,ie,se,ae=[[],[]];for(se=0;se<64;se++){var oe=!X&&se<N.length?N[se].brush.filter.getBounds():[-1/0,1/0];ae[0][se]=oe[0],ae[1][se]=oe[1]}var be=n*8,ce=new Array(be);for(Q=0;Q<be;Q++)ce[Q]=255;if(!X)for(Q=0;Q<N.length;Q++){var de=Q%8,ye=(Q-de)/8,ge=Math.pow(2,de),me=N[Q],Ee=me.brush.filter.get();if(!(Ee.length<2)){var Pe=b(Ee[0])[1];for(ie=1;ie<Ee.length;ie++){var Ne=b(Ee[ie]);for(se=Pe+1;se<Ne[0];se++)ce[se*8+ye]&=~ge;Pe=Math.max(Pe,Ne[1])}}}var we={shape:[8,n],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:ce};return W?W(we):W=P.texture(we),{maskTexture:W,maskHeight:n,loA:ae[0].slice(0,16),loB:ae[0].slice(16,32),loC:ae[0].slice(32,48),loD:ae[0].slice(48,64),hiA:ae[1].slice(0,16),hiB:ae[1].slice(16,32),hiC:ae[1].slice(32,48),hiD:ae[1].slice(48,64)}}function V(X,Q,ie){var se=X.length,ae,oe,be,ce=1/0,de=-1/0;for(ae=0;ae<se;ae++)X[ae].dim0.canvasX<ce&&(ce=X[ae].dim0.canvasX,oe=ae),X[ae].dim1.canvasX>de&&(de=X[ae].dim1.canvasX,be=ae);se===0&&i(P,0,0,O.canvasWidth,O.canvasHeight);var ye=q(T);for(ae=0;ae<se;ae++){var ge=X[ae],me=ge.dim0.crossfilterDimensionIndex,Ee=ge.dim1.crossfilterDimensionIndex,Pe=ge.canvasX,Ne=ge.canvasY,we=Pe+ge.panelSizeX,ke=ge.plotGlPixelRatio;if(Q||!re[me]||re[me][0]!==Pe||re[me][1]!==we){re[me]=[Pe,we];var Xe=h(O,oe,be,ae,me,Ee,Pe,Ne,ge.panelSizeX,ge.panelSizeY,ge.dim0.crossfilterDimensionIndex,T?0:k?2:1,ye,ke);R.clearOnly=ie;var He=Q?O.lines.blockLineCount:G;x(P,ue,R,He,G,Xe)}}}function U(X,Q){return P.read({x:X,y:Q,width:1,height:1,data:t}),t}function $(X,Q,ie,se){var ae=new Uint8Array(4*ie*se);return P.read({x:X,y:Q,width:ie,height:se,data:ae}),ae}function ne(){u.style["pointer-events"]="none",Y.destroy(),W&&W.destroy();for(var X in K)K[X].destroy()}return{render:V,readPixel:U,readPixels:$,destroy:ne,update:j}}},{"../../lib":515,"./constants":902,glslify:227}],907:[function(d,ee,te){ee.exports=function(A,g,S,M){M||(M=1/0);var e,a;for(e=0;e<g.length;e++)a=g[e],a.visible&&(M=Math.min(M,a[S].length));for(M===1/0&&(M=0),A._length=M,e=0;e<g.length;e++)a=g[e],a.visible&&(a._length=M);return M}},{}],908:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=g.numberFormat,M=d("color-rgba"),e=d("../../plots/cartesian/axes"),a=g.strRotate,n=g.strTranslate,r=d("../../lib/svg_text_utils"),t=d("../../components/drawing"),c=d("../../components/colorscale"),s=d("../../lib/gup"),i=s.keyFun,x=s.repeat,p=s.unwrap,v=d("./helpers"),f=d("./constants"),y=d("./axisbrush"),o=d("./lines");function m(W,Y,re){return g.aggNums(W,null,Y,re)}function l(W,Y){return _(m(Math.min,W,Y),m(Math.max,W,Y))}function w(W){var Y=W.range;return Y?_(Y[0],Y[1]):l(W.values,W._length)}function _(W,Y){return(isNaN(W)||!isFinite(W))&&(W=0),(isNaN(Y)||!isFinite(Y))&&(Y=0),W===Y&&(W===0?(W-=1,Y+=1):(W*=.9,Y*=1.1)),[W,Y]}function h(W,Y){return Y?function(re,ue){var j=Y[ue];return j==null?W(re):j}:W}function b(W,Y,re,ue,j){var q=w(re);return ue?A.scale.ordinal().domain(ue.map(h(S(re.tickformat),j))).range(ue.map(function(V){var U=(V-q[0])/(q[1]-q[0]);return W-Y+U*(2*Y-W)})):A.scale.linear().domain(q).range([W-Y,Y])}function u(W,Y){return A.scale.linear().range([Y,W-Y])}function L(W,Y){return A.scale.linear().domain(w(W)).range([Y,1-Y])}function T(W){if(!!W.tickvals){var Y=w(W);return A.scale.ordinal().domain(W.tickvals).range(W.tickvals.map(function(re){return(re-Y[0])/(Y[1]-Y[0])}))}}function k(W){var Y=W.map(function(q){return q[0]}),re=W.map(function(q){var V=M(q[1]);return A.rgb("rgb("+V[0]+","+V[1]+","+V[2]+")")}),ue=function(q){return function(V){return V[q]}},j="rgb".split("").map(function(q){return A.scale.linear().clamp(!0).domain(Y).range(re.map(ue(q)))});return function(q){return j.map(function(V){return V(q)})}}function P(W){return W.dimensions.some(function(Y){return Y.brush.filterSpecified})}function z(W,Y,re){var ue=p(Y),j=ue.trace,q=v.convertTypedArray(ue.lineColor),V=j.line,U={color:M(j.unselected.line.color),opacity:j.unselected.line.opacity},$=c.extractOpts(V),ne=$.reversescale?c.flipScale(ue.cscale):ue.cscale,X=j.domain,Q=j.dimensions,ie=W.width,se=j.labelangle,ae=j.labelside,oe=j.labelfont,be=j.tickfont,ce=j.rangefont,de=g.extendDeepNoArrays({},V,{color:q.map(A.scale.linear().domain(w({values:q,range:[$.min,$.max],_length:j._length}))),blockLineCount:f.blockLineCount,canvasOverdrag:f.overdrag*f.canvasPixelRatio}),ye=Math.floor(ie*(X.x[1]-X.x[0])),ge=Math.floor(W.height*(X.y[1]-X.y[0])),me=W.margin||{l:80,r:80,t:100,b:80},Ee=ye,Pe=ge;return{key:re,colCount:Q.filter(v.isVisible).length,dimensions:Q,tickDistance:f.tickDistance,unitToColor:k(ne),lines:de,deselectedLines:U,labelAngle:se,labelSide:ae,labelFont:oe,tickFont:be,rangeFont:ce,layoutWidth:ie,layoutHeight:W.height,domain:X,translateX:X.x[0]*ie,translateY:W.height-X.y[1]*W.height,pad:me,canvasWidth:Ee*f.canvasPixelRatio+2*de.canvasOverdrag,canvasHeight:Pe*f.canvasPixelRatio,width:Ee,height:Pe,canvasPixelRatio:f.canvasPixelRatio}}function I(W,Y,re){var ue=re.width,j=re.height,q=re.dimensions,V=re.canvasPixelRatio,U=function(ie){return ue*ie/Math.max(1,re.colCount-1)},$=f.verticalPadding/j,ne=u(j,f.verticalPadding),X={key:re.key,xScale:U,model:re,inBrushDrag:!1},Q={};return X.dimensions=q.filter(v.isVisible).map(function(ie,se){var ae=L(ie,$),oe=Q[ie.label];Q[ie.label]=(oe||0)+1;var be=ie.label+(oe?"__"+oe:""),ce=ie.constraintrange,de=ce&&ce.length;de&&!Array.isArray(ce[0])&&(ce=[ce]);var ye=de?ce.map(function(Ie){return Ie.map(ae)}):[[-1/0,1/0]],ge=function(){var Ie=X;Ie.focusLayer&&Ie.focusLayer.render(Ie.panels,!0);var De=P(Ie);!W.contextShown()&&De?(Ie.contextLayer&&Ie.contextLayer.render(Ie.panels,!0),W.contextShown(!0)):W.contextShown()&&!De&&(Ie.contextLayer&&Ie.contextLayer.render(Ie.panels,!0,!0),W.contextShown(!1))},me=ie.values;me.length>ie._length&&(me=me.slice(0,ie._length));var Ee=ie.tickvals,Pe;function Ne(Ie,De){return{val:Ie,text:Pe[De]}}function we(Ie,De){return Ie.val-De.val}if(Array.isArray(Ee)&&Ee.length){Pe=ie.ticktext,!Array.isArray(Pe)||!Pe.length?Pe=Ee.map(S(ie.tickformat)):Pe.length>Ee.length?Pe=Pe.slice(0,Ee.length):Ee.length>Pe.length&&(Ee=Ee.slice(0,Pe.length));for(var ke=1;ke<Ee.length;ke++)if(Ee[ke]<Ee[ke-1]){for(var Xe=Ee.map(Ne).sort(we),He=0;He<Ee.length;He++)Ee[He]=Xe[He].val,Pe[He]=Xe[He].text;break}}else Ee=void 0;return me=v.convertTypedArray(me),{key:be,label:ie.label,tickFormat:ie.tickformat,tickvals:Ee,ticktext:Pe,ordinal:v.isOrdinal(ie),multiselect:ie.multiselect,xIndex:se,crossfilterDimensionIndex:se,visibleIndex:ie._index,height:j,values:me,paddedUnitValues:me.map(ae),unitTickvals:Ee&&Ee.map(ae),xScale:U,x:U(se),canvasX:U(se)*V,unitToPaddedPx:ne,domainScale:b(j,f.verticalPadding,ie,Ee,Pe),ordinalScale:T(ie),parent:X,model:re,brush:y.makeBrush(W,de,ye,function(){W.linePickActive(!1)},ge,function(Ie){if(X.focusLayer.render(X.panels,!0),X.pickLayer&&X.pickLayer.render(X.panels,!0),W.linePickActive(!0),Y&&Y.filterChanged){var De=ae.invert,Ge=Ie.map(function(ht){return ht.map(De).sort(g.sorterAsc)}).sort(function(ht,Rt){return ht[0]-Rt[0]});Y.filterChanged(X.key,ie._index,Ge)}})}}),X}function D(W){W.classed(f.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function R(){var W=!0,Y=!1;return{linePickActive:function(re){return arguments.length?W=!!re:W},contextShown:function(re){return arguments.length?Y=!!re:Y}}}function O(W,Y){var re=Y==="top"?1:-1,ue=W*Math.PI/180,j=Math.sin(ue),q=Math.cos(ue);return{dir:re,dx:j,dy:q,degrees:W}}function F(W,Y,re){for(var ue=Y.panels||(Y.panels=[]),j=W.data(),q=0;q<j.length-1;q++){var V=ue[q]||(ue[q]={}),U=j[q],$=j[q+1];V.dim0=U,V.dim1=$,V.canvasX=U.canvasX,V.panelSizeX=$.canvasX-U.canvasX,V.panelSizeY=Y.model.canvasHeight,V.y=0,V.canvasY=0,V.plotGlPixelRatio=re}}function N(W){for(var Y=0;Y<W.length;Y++)for(var re=0;re<W[Y].length;re++)for(var ue=W[Y][re].trace,j=ue.dimensions,q=0;q<j.length;q++){var V=j[q].values,U=j[q]._ax;U&&(U.range?U.range=_(U.range[0],U.range[1]):U.range=l(V,ue._length),U.dtick||(U.dtick=.01*(Math.abs(U.range[1]-U.range[0])||1)),U.tickformat=j[q].tickformat,e.calcTicks(U),U.cleanRange())}}function G(W,Y){return e.tickText(W._ax,Y,!1).text}function K(W,Y){if(W.ordinal)return"";var re=W.domainScale.domain(),ue=re[Y?re.length-1:0];return G(W.model.dimensions[W.visibleIndex],ue)}ee.exports=function(Y,re,ue,j){var q=Y._context.staticPlot,V=Y._fullLayout,U=V._toppaper,$=V._glcontainer,ne=Y._context.plotGlPixelRatio,X=Y._fullLayout.paper_bgcolor;N(re);var Q=R(),ie=re.filter(function(He){return p(He).trace.visible}).map(z.bind(0,ue)).map(I.bind(0,Q,j));$.each(function(He,Ie){return g.extendFlat(He,ie[Ie])});var se=$.selectAll(".gl-canvas").each(function(He){He.viewModel=ie[0],He.viewModel.plotGlPixelRatio=ne,He.viewModel.paperColor=X,He.model=He.viewModel?He.viewModel.model:null}),ae=null,oe=se.filter(function(He){return He.pick});oe.style("pointer-events",q?"none":"auto").on("mousemove",function(He){if(Q.linePickActive()&&He.lineLayer&&j&&j.hover){var Ie=A.event,De=this.width,Ge=this.height,ht=A.mouse(this),Rt=ht[0],Kt=ht[1];if(Rt<0||Kt<0||Rt>=De||Kt>=Ge)return;var It=He.lineLayer.readPixel(Rt,Ge-1-Kt),Mt=It[3]!==0,Yt=Mt?It[2]+256*(It[1]+256*It[0]):null,zt={x:Rt,y:Kt,clientX:Ie.clientX,clientY:Ie.clientY,dataIndex:He.model.key,curveNumber:Yt};Yt!==ae&&(Mt?j.hover(zt):j.unhover&&j.unhover(zt),ae=Yt)}}),se.style("opacity",function(He){return He.pick?0:1}),U.style("background","rgba(255, 255, 255, 0)");var be=U.selectAll("."+f.cn.parcoords).data(ie,i);be.exit().remove(),be.enter().append("g").classed(f.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),be.attr("transform",function(He){return n(He.model.translateX,He.model.translateY)});var ce=be.selectAll("."+f.cn.parcoordsControlView).data(x,i);ce.enter().append("g").classed(f.cn.parcoordsControlView,!0),ce.attr("transform",function(He){return n(He.model.pad.l,He.model.pad.t)});var de=ce.selectAll("."+f.cn.yAxis).data(function(He){return He.dimensions},i);de.enter().append("g").classed(f.cn.yAxis,!0),ce.each(function(He){F(de,He,ne)}),se.each(function(He){if(He.viewModel){!He.lineLayer||j?He.lineLayer=o(this,He):He.lineLayer.update(He),(He.key||He.key===0)&&(He.viewModel[He.key]=He.lineLayer);var Ie=!He.context||j;He.lineLayer.render(He.viewModel.panels,Ie)}}),de.attr("transform",function(He){return n(He.xScale(He.xIndex),0)}),de.call(A.behavior.drag().origin(function(He){return He}).on("drag",function(He){var Ie=He.parent;Q.linePickActive(!1),He.x=Math.max(-f.overdrag,Math.min(He.model.width+f.overdrag,A.event.x)),He.canvasX=He.x*He.model.canvasPixelRatio,de.sort(function(De,Ge){return De.x-Ge.x}).each(function(De,Ge){De.xIndex=Ge,De.x=He===De?De.x:De.xScale(De.xIndex),De.canvasX=De.x*De.model.canvasPixelRatio}),F(de,Ie,ne),de.filter(function(De){return Math.abs(He.xIndex-De.xIndex)!==0}).attr("transform",function(De){return n(De.xScale(De.xIndex),0)}),A.select(this).attr("transform",n(He.x,0)),de.each(function(De,Ge,ht){ht===He.parent.key&&(Ie.dimensions[Ge]=De)}),Ie.contextLayer&&Ie.contextLayer.render(Ie.panels,!1,!P(Ie)),Ie.focusLayer.render&&Ie.focusLayer.render(Ie.panels)}).on("dragend",function(He){var Ie=He.parent;He.x=He.xScale(He.xIndex),He.canvasX=He.x*He.model.canvasPixelRatio,F(de,Ie,ne),A.select(this).attr("transform",function(De){return n(De.x,0)}),Ie.contextLayer&&Ie.contextLayer.render(Ie.panels,!1,!P(Ie)),Ie.focusLayer&&Ie.focusLayer.render(Ie.panels),Ie.pickLayer&&Ie.pickLayer.render(Ie.panels,!0),Q.linePickActive(!0),j&&j.axesMoved&&j.axesMoved(Ie.key,Ie.dimensions.map(function(De){return De.crossfilterDimensionIndex}))})),de.exit().remove();var ye=de.selectAll("."+f.cn.axisOverlays).data(x,i);ye.enter().append("g").classed(f.cn.axisOverlays,!0),ye.selectAll("."+f.cn.axis).remove();var ge=ye.selectAll("."+f.cn.axis).data(x,i);ge.enter().append("g").classed(f.cn.axis,!0),ge.each(function(He){var Ie=He.model.height/He.model.tickDistance,De=He.domainScale,Ge=De.domain();A.select(this).call(A.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Ie,He.tickFormat).tickValues(He.ordinal?Ge:null).tickFormat(function(ht){return v.isOrdinal(He)?ht:G(He.model.dimensions[He.visibleIndex],ht)}).scale(De)),t.font(ge.selectAll("text"),He.model.tickFont)}),ge.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),ge.selectAll("text").style("text-shadow",r.makeTextShadow(X)).style("cursor","default");var me=ye.selectAll("."+f.cn.axisHeading).data(x,i);me.enter().append("g").classed(f.cn.axisHeading,!0);var Ee=me.selectAll("."+f.cn.axisTitle).data(x,i);Ee.enter().append("text").classed(f.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events",q?"none":"auto"),Ee.text(function(He){return He.label}).each(function(He){var Ie=A.select(this);t.font(Ie,He.model.labelFont),r.convertToTspans(Ie,Y)}).attr("transform",function(He){var Ie=O(He.model.labelAngle,He.model.labelSide),De=f.axisTitleOffset;return(Ie.dir>0?"":n(0,2*De+He.model.height))+a(Ie.degrees)+n(-De*Ie.dx,-De*Ie.dy)}).attr("text-anchor",function(He){var Ie=O(He.model.labelAngle,He.model.labelSide),De=Math.abs(Ie.dx),Ge=Math.abs(Ie.dy);return 2*De>Ge?Ie.dir*Ie.dx<0?"start":"end":"middle"});var Pe=ye.selectAll("."+f.cn.axisExtent).data(x,i);Pe.enter().append("g").classed(f.cn.axisExtent,!0);var Ne=Pe.selectAll("."+f.cn.axisExtentTop).data(x,i);Ne.enter().append("g").classed(f.cn.axisExtentTop,!0),Ne.attr("transform",n(0,-f.axisExtentOffset));var we=Ne.selectAll("."+f.cn.axisExtentTopText).data(x,i);we.enter().append("text").classed(f.cn.axisExtentTopText,!0).call(D),we.text(function(He){return K(He,!0)}).each(function(He){t.font(A.select(this),He.model.rangeFont)});var ke=Pe.selectAll("."+f.cn.axisExtentBottom).data(x,i);ke.enter().append("g").classed(f.cn.axisExtentBottom,!0),ke.attr("transform",function(He){return n(0,He.model.height+f.axisExtentOffset)});var Xe=ke.selectAll("."+f.cn.axisExtentBottomText).data(x,i);Xe.enter().append("text").classed(f.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(D),Xe.text(function(He){return K(He,!1)}).each(function(He){t.font(A.select(this),He.model.rangeFont)}),y.ensureAxisBrush(ye,X,Y)}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"./axisbrush":898,"./constants":902,"./helpers":904,"./lines":906,"@plotly/d3":58,"color-rgba":91}],909:[function(d,ee,n){var A=d("./parcoords"),g=d("../../lib/prepare_regl"),S=d("./helpers").isVisible,M={};function e(r,t,c){var s=t.indexOf(c),i=r.indexOf(s);return i===-1&&(i+=t.length),i}function a(r,t){return function(s,i){return e(r,t,s)-e(r,t,i)}}var n=ee.exports=function(t,c){var s=t._fullLayout,i=g(t,[],M);if(!!i){var x={},p={},v={},f={},y=s._size;c.forEach(function(_,h){var b=_[0].trace;v[h]=b.index;var u=f[h]=b._fullInput.index;x[h]=t.data[u].dimensions,p[h]=t.data[u].dimensions.slice()});var o=function(_,h,b){var u=p[_][h],L=b.map(function(D){return D.slice()}),T="dimensions["+h+"].constraintrange",k=s._tracePreGUI[t._fullData[v[_]]._fullInput.uid];if(k[T]===void 0){var P=u.constraintrange;k[T]=P||null}var z=t._fullData[v[_]].dimensions[h];L.length?(L.length===1&&(L=L[0]),u.constraintrange=L,z.constraintrange=L.slice(),L=[L]):(delete u.constraintrange,delete z.constraintrange,L=null);var I={};I[T]=L,t.emit("plotly_restyle",[I,[f[_]]])},m=function(_){t.emit("plotly_hover",_)},l=function(_){t.emit("plotly_unhover",_)},w=function(_,h){var b=a(h,p[_].filter(S));x[_].sort(b),p[_].filter(function(u){return!S(u)}).sort(function(u){return p[_].indexOf(u)}).forEach(function(u){x[_].splice(x[_].indexOf(u),1),x[_].splice(p[_].indexOf(u),0,u)}),t.emit("plotly_restyle",[{dimensions:[x[_]]},[f[_]]])};A(t,c,{width:y.w,height:y.h,margin:{t:y.t,r:y.r,b:y.b,l:y.l}},{filterChanged:o,hover:m,unhover:l,axesMoved:w})}};n.reglPrecompiled=M},{"../../lib/prepare_regl":528,"./helpers":904,"./parcoords":908}],910:[function(d,ee,te){var A=d("../../plots/attributes"),g=d("../../plots/domain").attributes,S=d("../../plots/font_attributes"),M=d("../../components/color/attributes"),e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/template_attributes").texttemplateAttrs,n=d("../../lib/extend").extendFlat,r=S({editType:"plot",arrayOk:!0,colorEditType:"plot"});ee.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:M.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:n({},A.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:a({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:n({},r,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:n({},r,{}),outsidetextfont:n({},r,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:n({},r,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:g({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:n({},r,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],911:[function(d,ee,te){var A=d("../../plots/plots");te.name="pie",te.plot=function(g,S,M,e){A.plotBasePlot(te.name,g,S,M,e)},te.clean=function(g,S,M,e){A.cleanBasePlot(te.name,g,S,M,e)}},{"../../plots/plots":628}],912:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("tinycolor2"),S=d("../../components/color"),M={};function e(t,c){var s=[],i=t._fullLayout,x=i.hiddenlabels||[],p=c.labels,v=c.marker.colors||[],f=c.values,y=c._length,o=c._hasValues&&y,m,l;if(c.dlabel)for(p=new Array(y),m=0;m<y;m++)p[m]=String(c.label0+m*c.dlabel);var w={},_=a(i["_"+c.type+"colormap"]),h=0,b=!1;for(m=0;m<y;m++){var u,L,T;if(o){if(u=f[m],!A(u))continue;u=+u}else u=1;L=p[m],(L===void 0||L==="")&&(L=m),L=String(L);var k=w[L];k===void 0?(w[L]=s.length,T=x.indexOf(L)!==-1,T||(h+=u),s.push({v:u,label:L,color:_(v[m],L),i:m,pts:[m],hidden:T})):(b=!0,l=s[k],l.v+=u,l.pts.push(m),l.hidden||(h+=u),l.color===!1&&v[m]&&(l.color=_(v[m],L)))}s=s.filter(function(z){return z.v>=0});var P=c.type==="funnelarea"?b:c.sort;return P&&s.sort(function(z,I){return I.v-z.v}),s[0]&&(s[0].vTotal=h),s}function a(t){return function(s,i){return!s||(s=g(s),!s.isValid())?!1:(s=S.addOpacity(s,s.getAlpha()),t[i]||(t[i]=s),s)}}function n(t,c){var s=(c||{}).type;s||(s="pie");var i=t._fullLayout,x=t.calcdata,p=i[s+"colorway"],v=i["_"+s+"colormap"];i["extend"+s+"colors"]&&(p=r(p,M));for(var f=0,y=0;y<x.length;y++){var o=x[y],m=o[0].trace.type;if(m===s)for(var l=0;l<o.length;l++){var w=o[l];w.color===!1&&(v[w.label]?w.color=v[w.label]:(v[w.label]=w.color=p[f%p.length],f++))}}}function r(t,c){var s,i=JSON.stringify(t),x=c[i];if(!x){for(x=t.slice(),s=0;s<t.length;s++)x.push(g(t[s]).lighten(20).toHexString());for(s=0;s<t.length;s++)x.push(g(t[s]).darken(20).toHexString());c[i]=x}return x}ee.exports={calc:e,crossTraceCalc:n,makePullColorFn:a,generateExtendedColors:r}},{"../../components/color":367,"fast-isnumeric":190,tinycolor2:313}],913:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib"),S=d("./attributes"),M=d("../../plots/domain").defaults,e=d("../bar/defaults").handleText;function a(r,t){var c=Array.isArray(r),s=g.isArrayOrTypedArray(t),i=Math.min(c?r.length:1/0,s?t.length:1/0);if(isFinite(i)||(i=0),i&&s){for(var x,p=0;p<i;p++){var v=t[p];if(A(v)&&v>0){x=!0;break}}x||(i=0)}return{hasLabels:c,hasValues:s,len:i}}function n(r,t,c,s){function i(T,k){return g.coerce(r,t,S,T,k)}var x=i("labels"),p=i("values"),v=a(x,p),f=v.len;if(t._hasLabels=v.hasLabels,t._hasValues=v.hasValues,!t._hasLabels&&t._hasValues&&(i("label0"),i("dlabel")),!f){t.visible=!1;return}t._length=f;var y=i("marker.line.width");y&&i("marker.line.color"),i("marker.colors"),i("scalegroup");var o=i("text"),m=i("texttemplate"),l;if(m||(l=i("textinfo",Array.isArray(o)?"text+percent":"percent")),i("hovertext"),i("hovertemplate"),m||l&&l!=="none"){var w=i("textposition");e(r,t,s,i,w,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1});var _=Array.isArray(w)||w==="auto",h=_||w==="outside";h&&i("automargin"),(w==="inside"||w==="auto"||Array.isArray(w))&&i("insidetextorientation")}M(t,s,i);var b=i("hole"),u=i("title.text");if(u){var L=i("title.position",b?"middle center":"top center");!b&&L==="middle center"&&(t.title.position="top center"),g.coerceFont(i,"title.font",s.font)}i("sort"),i("direction"),i("rotation"),i("pull")}ee.exports={handleLabelsAndValues:a,supplyDefaults:n}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":910,"fast-isnumeric":190}],914:[function(d,ee,te){var A=d("../../components/fx/helpers").appendArrayMultiPointValues;ee.exports=function(S,M){var e={curveNumber:M.index,pointNumbers:S.pts,data:M._input,fullData:M,label:S.label,color:S.color,value:S.v,percent:S.percent,text:S.text,bbox:S.bbox,v:S.v};return S.pts.length===1&&(e.pointNumber=e.i=S.pts[0]),A(e,M,S.pts),M.type==="funnelarea"&&(delete e.v,delete e.i),e}},{"../../components/fx/helpers":403}],915:[function(d,ee,te){var A=d("../../lib");function g(S){return S.indexOf("e")!==-1?S.replace(/[.]?0+e/,"e"):S.indexOf(".")!==-1?S.replace(/[.]?0+$/,""):S}te.formatPiePercent=function(M,e){var a=g((M*100).toPrecision(3));return A.numSeparate(a,e)+"%"},te.formatPieValue=function(M,e){var a=g(M.toPrecision(10));return A.numSeparate(a,e)},te.getFirstFilled=function(M,e){if(!!Array.isArray(M))for(var a=0;a<e.length;a++){var n=M[e[a]];if(n||n===0||n==="")return n}},te.castOption=function(M,e){if(Array.isArray(M))return te.getFirstFilled(M,e);if(M)return M},te.getRotationAngle=function(S){return(S==="auto"?0:S)*Math.PI/180}},{"../../lib":515}],916:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,supplyLayoutDefaults:d("./layout_defaults"),layoutAttributes:d("./layout_attributes"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot").plot,style:d("./style"),styleOne:d("./style_one"),moduleType:"trace",name:"pie",basePlotModule:d("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":910,"./base_plot":911,"./calc":912,"./defaults":913,"./layout_attributes":917,"./layout_defaults":918,"./plot":919,"./style":920,"./style_one":921}],917:[function(d,ee,te){ee.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],918:[function(d,ee,te){var A=d("../../lib"),g=d("./layout_attributes");ee.exports=function(M,e){function a(n,r){return A.coerce(M,e,g,n,r)}a("hiddenlabels"),a("piecolorway",e.colorway),a("extendpiecolors")}},{"../../lib":515,"./layout_attributes":917}],919:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../plots/plots"),S=d("../../components/fx"),M=d("../../components/color"),e=d("../../components/drawing"),a=d("../../lib"),n=a.strScale,r=a.strTranslate,t=d("../../lib/svg_text_utils"),c=d("../bar/uniform_text"),s=c.recordMinTextSize,i=c.clearMinTextSize,x=d("../bar/constants").TEXTPAD,p=d("./helpers"),v=d("./event_data"),f=d("../../lib").isValidTextValue;function y(q,V){var U=q._context.staticPlot,$=q._fullLayout,ne=$._size;i("pie",$),_(V,q),K(V,ne);var X=a.makeTraceGroups($._pielayer,V,"trace").each(function(Q){var ie=A.select(this),se=Q[0],ae=se.trace;Y(Q),ie.attr("stroke-linejoin","round"),ie.each(function(){var oe=A.select(this).selectAll("g.slice").data(Q);oe.enter().append("g").classed("slice",!0),oe.exit().remove();var be=[[[],[]],[[],[]]],ce=!1;oe.each(function(we,ke){if(we.hidden){A.select(this).selectAll("path,g").remove();return}we.pointNumber=we.i,we.curveNumber=ae.index,be[we.pxmid[1]<0?0:1][we.pxmid[0]<0?0:1].push(we);var Xe=se.cx,He=se.cy,Ie=A.select(this),De=Ie.selectAll("path.surface").data([we]);if(De.enter().append("path").classed("surface",!0).style({"pointer-events":U?"none":"all"}),Ie.call(m,q,Q),ae.pull){var Ge=+p.castOption(ae.pull,we.pts)||0;Ge>0&&(Xe+=Ge*we.pxmid[0],He+=Ge*we.pxmid[1])}we.cxFinal=Xe,we.cyFinal=He;function ht(St,Ye,rt,Ve){var Ae=Ve*(Ye[0]-St[0]),Ue=Ve*(Ye[1]-St[1]);return"a"+Ve*se.r+","+Ve*se.r+" 0 "+we.largeArc+(rt?" 1 ":" 0 ")+Ae+","+Ue}var Rt=ae.hole;if(we.v===se.vTotal){var Kt="M"+(Xe+we.px0[0])+","+(He+we.px0[1])+ht(we.px0,we.pxmid,!0,1)+ht(we.pxmid,we.px0,!0,1)+"Z";Rt?De.attr("d","M"+(Xe+Rt*we.px0[0])+","+(He+Rt*we.px0[1])+ht(we.px0,we.pxmid,!1,Rt)+ht(we.pxmid,we.px0,!1,Rt)+"Z"+Kt):De.attr("d",Kt)}else{var It=ht(we.px0,we.px1,!0,1);if(Rt){var Mt=1-Rt;De.attr("d","M"+(Xe+Rt*we.px1[0])+","+(He+Rt*we.px1[1])+ht(we.px1,we.px0,!1,Rt)+"l"+Mt*we.px0[0]+","+Mt*we.px0[1]+It+"Z")}else De.attr("d","M"+Xe+","+He+"l"+we.px0[0]+","+we.px0[1]+It+"Z")}ue(q,we,se);var Yt=p.castOption(ae.textposition,we.pts),zt=Ie.selectAll("g.slicetext").data(we.text&&Yt!=="none"?[0]:[]);zt.enter().append("g").classed("slicetext",!0),zt.exit().remove(),zt.each(function(){var St=a.ensureSingle(A.select(this),"text","",function(_t){_t.attr("data-notex",1)}),Ye=a.ensureUniformFontSize(q,Yt==="outside"?l(ae,we,$.font):w(ae,we,$.font));St.text(we.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,Ye).call(t.convertToTspans,q);var rt=e.bBox(St.node()),Ve;if(Yt==="outside")Ve=I(rt,we);else if(Ve=h(rt,we,se),Yt==="auto"&&Ve.scale<1){var Ae=a.ensureUniformFontSize(q,ae.outsidetextfont);St.call(e.font,Ae),rt=e.bBox(St.node()),Ve=I(rt,we)}var Ue=Ve.textPosAngle,Ze=Ue===void 0?we.pxmid:re(se.r,Ue);if(Ve.targetX=Xe+Ze[0]*Ve.rCenter+(Ve.x||0),Ve.targetY=He+Ze[1]*Ve.rCenter+(Ve.y||0),j(Ve,rt),Ve.outside){var Qe=Ve.targetY;we.yLabelMin=Qe-rt.height/2,we.yLabelMid=Qe,we.yLabelMax=Qe+rt.height/2,we.labelExtraX=0,we.labelExtraY=0,ce=!0}Ve.fontSize=Ye.size,s(ae.type,Ve,$),Q[ke].transform=Ve,a.setTransormAndDisplay(St,Ve)})});var de=A.select(this).selectAll("g.titletext").data(ae.title.text?[0]:[]);if(de.enter().append("g").classed("titletext",!0),de.exit().remove(),de.each(function(){var we=a.ensureSingle(A.select(this),"text","",function(He){He.attr("data-notex",1)}),ke=ae.title.text;ae._meta&&(ke=a.templateString(ke,ae._meta)),we.text(ke).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,ae.title.font).call(t.convertToTspans,q);var Xe;ae.title.position==="middle center"?Xe=D(se):Xe=R(se,ne),we.attr("transform",r(Xe.x,Xe.y)+n(Math.min(1,Xe.scale))+r(Xe.tx,Xe.ty))}),ce&&G(be,ae),o(oe,ae),ce&&ae.automargin){var ye=e.bBox(ie.node()),ge=ae.domain,me=ne.w*(ge.x[1]-ge.x[0]),Ee=ne.h*(ge.y[1]-ge.y[0]),Pe=(.5*me-se.r)/ne.w,Ne=(.5*Ee-se.r)/ne.h;g.autoMargin(q,"pie."+ae.uid+".automargin",{xl:ge.x[0]-Pe,xr:ge.x[1]+Pe,yb:ge.y[0]-Ne,yt:ge.y[1]+Ne,l:Math.max(se.cx-se.r-ye.left,0),r:Math.max(ye.right-(se.cx+se.r),0),b:Math.max(ye.bottom-(se.cy+se.r),0),t:Math.max(se.cy-se.r-ye.top,0),pad:5})}})});setTimeout(function(){X.selectAll("tspan").each(function(){var Q=A.select(this);Q.attr("dy")&&Q.attr("dy",Q.attr("dy"))})},0)}function o(q,V){q.each(function(U){var $=A.select(this);if(!U.labelExtraX&&!U.labelExtraY){$.select("path.textline").remove();return}var ne=$.select("g.slicetext text");U.transform.targetX+=U.labelExtraX,U.transform.targetY+=U.labelExtraY,a.setTransormAndDisplay(ne,U.transform);var X=U.cxFinal+U.pxmid[0],Q=U.cyFinal+U.pxmid[1],ie="M"+X+","+Q,se=(U.yLabelMax-U.yLabelMin)*(U.pxmid[0]<0?-1:1)/4;if(U.labelExtraX){var ae=U.labelExtraX*U.pxmid[1]/U.pxmid[0],oe=U.yLabelMid+U.labelExtraY-(U.cyFinal+U.pxmid[1]);Math.abs(ae)>Math.abs(oe)?ie+="l"+oe*U.pxmid[0]/U.pxmid[1]+","+oe+"H"+(X+U.labelExtraX+se):ie+="l"+U.labelExtraX+","+ae+"v"+(oe-ae)+"h"+se}else ie+="V"+(U.yLabelMid+U.labelExtraY)+"h"+se;a.ensureSingle($,"path","textline").call(M.stroke,V.outsidetextfont.color).attr({"stroke-width":Math.min(2,V.outsidetextfont.size/8),d:ie,fill:"none"})})}function m(q,V,U){var $=U[0],ne=$.cx,X=$.cy,Q=$.trace,ie=Q.type==="funnelarea";"_hasHoverLabel"in Q||(Q._hasHoverLabel=!1),"_hasHoverEvent"in Q||(Q._hasHoverEvent=!1),q.on("mouseover",function(se){var ae=V._fullLayout,oe=V._fullData[Q.index];if(!(V._dragging||ae.hovermode===!1)){var be=oe.hoverinfo;if(Array.isArray(be)&&(be=S.castHoverinfo({hoverinfo:[p.castOption(be,se.pts)],_module:Q._module},ae,0)),be==="all"&&(be="label+text+value+percent+name"),oe.hovertemplate||be!=="none"&&be!=="skip"&&be){var ce=se.rInscribed||0,de=ne+se.pxmid[0]*(1-ce),ye=X+se.pxmid[1]*(1-ce),ge=ae.separators,me=[];if(be&&be.indexOf("label")!==-1&&me.push(se.label),se.text=p.castOption(oe.hovertext||oe.text,se.pts),be&&be.indexOf("text")!==-1){var Ee=se.text;a.isValidTextValue(Ee)&&me.push(Ee)}se.value=se.v,se.valueLabel=p.formatPieValue(se.v,ge),be&&be.indexOf("value")!==-1&&me.push(se.valueLabel),se.percent=se.v/$.vTotal,se.percentLabel=p.formatPiePercent(se.percent,ge),be&&be.indexOf("percent")!==-1&&me.push(se.percentLabel);var Pe=oe.hoverlabel,Ne=Pe.font,we=[];S.loneHover({trace:Q,x0:de-ce*$.r,x1:de+ce*$.r,y:ye,_x0:ie?ne+se.TL[0]:de-ce*$.r,_x1:ie?ne+se.TR[0]:de+ce*$.r,_y0:ie?X+se.TL[1]:ye-ce*$.r,_y1:ie?X+se.BL[1]:ye+ce*$.r,text:me.join("<br>"),name:oe.hovertemplate||be.indexOf("name")!==-1?oe.name:void 0,idealAlign:se.pxmid[0]<0?"left":"right",color:p.castOption(Pe.bgcolor,se.pts)||se.color,borderColor:p.castOption(Pe.bordercolor,se.pts),fontFamily:p.castOption(Ne.family,se.pts),fontSize:p.castOption(Ne.size,se.pts),fontColor:p.castOption(Ne.color,se.pts),nameLength:p.castOption(Pe.namelength,se.pts),textAlign:p.castOption(Pe.align,se.pts),hovertemplate:p.castOption(oe.hovertemplate,se.pts),hovertemplateLabels:se,eventData:[v(se,oe)]},{container:ae._hoverlayer.node(),outerContainer:ae._paper.node(),gd:V,inOut_bbox:we}),se.bbox=we[0],Q._hasHoverLabel=!0}Q._hasHoverEvent=!0,V.emit("plotly_hover",{points:[v(se,oe)],event:A.event})}}),q.on("mouseout",function(se){var ae=V._fullLayout,oe=V._fullData[Q.index],be=A.select(this).datum();Q._hasHoverEvent&&(se.originalEvent=A.event,V.emit("plotly_unhover",{points:[v(be,oe)],event:A.event}),Q._hasHoverEvent=!1),Q._hasHoverLabel&&(S.loneUnhover(ae._hoverlayer.node()),Q._hasHoverLabel=!1)}),q.on("click",function(se){var ae=V._fullLayout,oe=V._fullData[Q.index];V._dragging||ae.hovermode===!1||(V._hoverdata=[v(se,oe)],S.click(V,A.event))})}function l(q,V,U){var $=p.castOption(q.outsidetextfont.color,V.pts)||p.castOption(q.textfont.color,V.pts)||U.color,ne=p.castOption(q.outsidetextfont.family,V.pts)||p.castOption(q.textfont.family,V.pts)||U.family,X=p.castOption(q.outsidetextfont.size,V.pts)||p.castOption(q.textfont.size,V.pts)||U.size;return{color:$,family:ne,size:X}}function w(q,V,U){var $=p.castOption(q.insidetextfont.color,V.pts);!$&&q._input.textfont&&($=p.castOption(q._input.textfont.color,V.pts));var ne=p.castOption(q.insidetextfont.family,V.pts)||p.castOption(q.textfont.family,V.pts)||U.family,X=p.castOption(q.insidetextfont.size,V.pts)||p.castOption(q.textfont.size,V.pts)||U.size;return{color:$||M.contrast(V.color),family:ne,size:X}}function _(q,V){for(var U,$,ne=0;ne<q.length;ne++)if(U=q[ne][0],$=U.trace,$.title.text){var X=$.title.text;$._meta&&(X=a.templateString(X,$._meta));var Q=e.tester.append("text").attr("data-notex",1).text(X).call(e.font,$.title.font).call(t.convertToTspans,V),ie=e.bBox(Q.node(),!0);U.titleBox={width:ie.width,height:ie.height},Q.remove()}}function h(q,V,U){var $=U.r||V.rpx1,ne=V.rInscribed,X=V.startangle===V.stopangle;if(X)return{rCenter:1-ne,scale:0,rotate:0,textPosAngle:0};var Q=V.ring,ie=Q===1&&Math.abs(V.startangle-V.stopangle)===Math.PI*2,se=V.halfangle,ae=V.midangle,oe=U.trace.insidetextorientation,be=oe==="horizontal",ce=oe==="tangential",de=oe==="radial",ye=oe==="auto",ge=[],me;if(!ye){var Ee=function(Ie,De){if(b(V,Ie)){var Ge=Math.abs(Ie-V.startangle),ht=Math.abs(Ie-V.stopangle),Rt=Ge<ht?Ge:ht;De==="tan"?me=L(q,$,Q,Rt,0):me=u(q,$,Q,Rt,Math.PI/2),me.textPosAngle=Ie,ge.push(me)}},Pe;if(be||ce){for(Pe=4;Pe>=-4;Pe-=2)Ee(Math.PI*Pe,"tan");for(Pe=4;Pe>=-4;Pe-=2)Ee(Math.PI*(Pe+1),"tan")}if(be||de){for(Pe=4;Pe>=-4;Pe-=2)Ee(Math.PI*(Pe+1.5),"rad");for(Pe=4;Pe>=-4;Pe-=2)Ee(Math.PI*(Pe+.5),"rad")}}if(ie||ye||be){var Ne=Math.sqrt(q.width*q.width+q.height*q.height);if(me={scale:ne*$*2/Ne,rCenter:1-ne,rotate:0},me.textPosAngle=(V.startangle+V.stopangle)/2,me.scale>=1)return me;ge.push(me)}(ye||de)&&(me=u(q,$,Q,se,ae),me.textPosAngle=(V.startangle+V.stopangle)/2,ge.push(me)),(ye||ce)&&(me=L(q,$,Q,se,ae),me.textPosAngle=(V.startangle+V.stopangle)/2,ge.push(me));for(var we=0,ke=0,Xe=0;Xe<ge.length;Xe++){var He=ge[Xe].scale;if(ke<He&&(ke=He,we=Xe),!ye&&ke>=1)break}return ge[we]}function b(q,V){var U=q.startangle,$=q.stopangle;return U>V&&V>$||U<V&&V<$}function u(q,V,U,$,ne){V=Math.max(0,V-2*x);var X=q.width/q.height,Q=P(X,$,V,U);return{scale:Q*2/q.height,rCenter:T(X,Q/V),rotate:k(ne)}}function L(q,V,U,$,ne){V=Math.max(0,V-2*x);var X=q.height/q.width,Q=P(X,$,V,U);return{scale:Q*2/q.width,rCenter:T(X,Q/V),rotate:k(ne+Math.PI/2)}}function T(q,V){return Math.cos(V)-q*V}function k(q){return(180/Math.PI*q+720)%180-90}function P(q,V,U,$){var ne=q+1/(2*Math.tan(V));return U*Math.min(1/(Math.sqrt(ne*ne+.5)+ne),$/(Math.sqrt(q*q+$/2)+q))}function z(q,V){return q.v===V.vTotal&&!V.trace.hole?1:Math.min(1/(1+1/Math.sin(q.halfangle)),q.ring/2)}function I(q,V){var U=V.pxmid[0],$=V.pxmid[1],ne=q.width/2,X=q.height/2;return U<0&&(ne*=-1),$<0&&(X*=-1),{scale:1,rCenter:1,rotate:0,x:ne+Math.abs(X)*(ne>0?1:-1)/2,y:X/(1+U*U/($*$)),outside:!0}}function D(q){var V=Math.sqrt(q.titleBox.width*q.titleBox.width+q.titleBox.height*q.titleBox.height);return{x:q.cx,y:q.cy,scale:q.trace.hole*q.r*2/V,tx:0,ty:-q.titleBox.height/2+q.trace.title.font.size}}function R(q,V){var U=1,$=1,ne,X=q.trace,Q={x:q.cx,y:q.cy},ie={tx:0,ty:0};ie.ty+=X.title.font.size,ne=N(X),X.title.position.indexOf("top")!==-1?(Q.y-=(1+ne)*q.r,ie.ty-=q.titleBox.height):X.title.position.indexOf("bottom")!==-1&&(Q.y+=(1+ne)*q.r);var se=O(q.r,q.trace.aspectratio),ae=V.w*(X.domain.x[1]-X.domain.x[0])/2;return X.title.position.indexOf("left")!==-1?(ae=ae+se,Q.x-=(1+ne)*se,ie.tx+=q.titleBox.width/2):X.title.position.indexOf("center")!==-1?ae*=2:X.title.position.indexOf("right")!==-1&&(ae=ae+se,Q.x+=(1+ne)*se,ie.tx-=q.titleBox.width/2),U=ae/q.titleBox.width,$=F(q,V)/q.titleBox.height,{x:Q.x,y:Q.y,scale:Math.min(U,$),tx:ie.tx,ty:ie.ty}}function O(q,V){return q/(V===void 0?1:V)}function F(q,V){var U=q.trace,$=V.h*(U.domain.y[1]-U.domain.y[0]);return Math.min(q.titleBox.height,$/2)}function N(q){var V=q.pull;if(!V)return 0;var U;if(Array.isArray(V))for(V=0,U=0;U<q.pull.length;U++)q.pull[U]>V&&(V=q.pull[U]);return V}function G(q,V){var U,$,ne,X,Q,ie,se,ae,oe,be,ce,de,ye;function ge(Ne,we){return Ne.pxmid[1]-we.pxmid[1]}function me(Ne,we){return we.pxmid[1]-Ne.pxmid[1]}function Ee(Ne,we){we||(we={});var ke=we.labelExtraY+($?we.yLabelMax:we.yLabelMin),Xe=$?Ne.yLabelMin:Ne.yLabelMax,He=$?Ne.yLabelMax:Ne.yLabelMin,Ie=Ne.cyFinal+Q(Ne.px0[1],Ne.px1[1]),De=ke-Xe,Ge,ht,Rt,Kt,It,Mt;if(De*se>0&&(Ne.labelExtraY=De),!!Array.isArray(V.pull))for(ht=0;ht<be.length;ht++)Rt=be[ht],!(Rt===Ne||(p.castOption(V.pull,Ne.pts)||0)>=(p.castOption(V.pull,Rt.pts)||0))&&((Ne.pxmid[1]-Rt.pxmid[1])*se>0?(Kt=Rt.cyFinal+Q(Rt.px0[1],Rt.px1[1]),De=Kt-Xe-Ne.labelExtraY,De*se>0&&(Ne.labelExtraY+=De)):(He+Ne.labelExtraY-Ie)*se>0&&(Ge=3*ie*Math.abs(ht-be.indexOf(Ne)),It=Rt.cxFinal+X(Rt.px0[0],Rt.px1[0]),Mt=It+Ge-(Ne.cxFinal+Ne.pxmid[0])-Ne.labelExtraX,Mt*ie>0&&(Ne.labelExtraX+=Mt)))}for($=0;$<2;$++)for(ne=$?ge:me,Q=$?Math.max:Math.min,se=$?1:-1,U=0;U<2;U++){for(X=U?Math.max:Math.min,ie=U?1:-1,ae=q[$][U],ae.sort(ne),oe=q[1-$][U],be=oe.concat(ae),de=[],ce=0;ce<ae.length;ce++)ae[ce].yLabelMid!==void 0&&de.push(ae[ce]);for(ye=!1,ce=0;$&&ce<oe.length;ce++)if(oe[ce].yLabelMid!==void 0){ye=oe[ce];break}for(ce=0;ce<de.length;ce++){var Pe=ce&&de[ce-1];ye&&!ce&&(Pe=ye),Ee(de[ce],Pe)}}}function K(q,V){for(var U=[],$=0;$<q.length;$++){var ne=q[$][0],X=ne.trace,Q=X.domain,ie=V.w*(Q.x[1]-Q.x[0]),se=V.h*(Q.y[1]-Q.y[0]);X.title.text&&X.title.position!=="middle center"&&(se-=F(ne,V));var ae=ie/2,oe=se/2;X.type==="funnelarea"&&!X.scalegroup&&(oe/=X.aspectratio),ne.r=Math.min(ae,oe)/(1+N(X)),ne.cx=V.l+V.w*(X.domain.x[1]+X.domain.x[0])/2,ne.cy=V.t+V.h*(1-X.domain.y[0])-se/2,X.title.text&&X.title.position.indexOf("bottom")!==-1&&(ne.cy-=F(ne,V)),X.scalegroup&&U.indexOf(X.scalegroup)===-1&&U.push(X.scalegroup)}W(q,U)}function W(q,V){for(var U,$,ne,X=0;X<V.length;X++){var Q=1/0,ie=V[X];for($=0;$<q.length;$++)if(U=q[$][0],ne=U.trace,ne.scalegroup===ie){var se;if(ne.type==="pie")se=U.r*U.r;else if(ne.type==="funnelarea"){var ae,oe;ne.aspectratio>1?(ae=U.r,oe=ae/ne.aspectratio):(oe=U.r,ae=oe*ne.aspectratio),ae*=(1+ne.baseratio)/2,se=ae*oe}Q=Math.min(Q,se/U.vTotal)}for($=0;$<q.length;$++)if(U=q[$][0],ne=U.trace,ne.scalegroup===ie){var be=Q*U.vTotal;ne.type==="funnelarea"&&(be/=(1+ne.baseratio)/2,be/=ne.aspectratio),U.r=Math.sqrt(be)}}}function Y(q){var V=q[0],U=V.r,$=V.trace,ne=p.getRotationAngle($.rotation),X=2*Math.PI/V.vTotal,Q="px0",ie="px1",se,ae,oe;if($.direction==="counterclockwise"){for(se=0;se<q.length&&q[se].hidden;se++);if(se===q.length)return;ne+=X*q[se].v,X*=-1,Q="px1",ie="px0"}for(oe=re(U,ne),se=0;se<q.length;se++)ae=q[se],!ae.hidden&&(ae[Q]=oe,ae.startangle=ne,ne+=X*ae.v/2,ae.pxmid=re(U,ne),ae.midangle=ne,ne+=X*ae.v/2,oe=re(U,ne),ae.stopangle=ne,ae[ie]=oe,ae.largeArc=ae.v>V.vTotal/2?1:0,ae.halfangle=Math.PI*Math.min(ae.v/V.vTotal,.5),ae.ring=1-$.hole,ae.rInscribed=z(ae,V))}function re(q,V){return[q*Math.sin(V),-q*Math.cos(V)]}function ue(q,V,U){var $=q._fullLayout,ne=U.trace,X=ne.texttemplate,Q=ne.textinfo;if(!X&&Q&&Q!=="none"){var ie=Q.split("+"),se=function(we){return ie.indexOf(we)!==-1},ae=se("label"),oe=se("text"),be=se("value"),ce=se("percent"),de=$.separators,ye;if(ye=ae?[V.label]:[],oe){var ge=p.getFirstFilled(ne.text,V.pts);f(ge)&&ye.push(ge)}be&&ye.push(p.formatPieValue(V.v,de)),ce&&ye.push(p.formatPiePercent(V.v/U.vTotal,de)),V.text=ye.join("<br>")}function me(we){return{label:we.label,value:we.v,valueLabel:p.formatPieValue(we.v,$.separators),percent:we.v/U.vTotal,percentLabel:p.formatPiePercent(we.v/U.vTotal,$.separators),color:we.color,text:we.text,customdata:a.castOption(ne,we.i,"customdata")}}if(X){var Ee=a.castOption(ne,V.i,"texttemplate");if(!Ee)V.text="";else{var Pe=me(V),Ne=p.getFirstFilled(ne.text,V.pts);(f(Ne)||Ne==="")&&(Pe.text=Ne),V.text=a.texttemplateString(Ee,Pe,q._fullLayout._d3locale,Pe,ne._meta||{})}}}function j(q,V){var U=q.rotate*Math.PI/180,$=Math.cos(U),ne=Math.sin(U),X=(V.left+V.right)/2,Q=(V.top+V.bottom)/2;q.textX=X*$-Q*ne,q.textY=X*ne+Q*$,q.noCenter=!0}ee.exports={plot:y,formatSliceLabel:ue,transformInsideText:h,determineInsideTextFont:w,positionTitleOutside:R,prerenderTitles:_,layoutAreas:K,attachFxHandlers:m,computeTransform:j}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../bar/constants":659,"../bar/uniform_text":673,"./event_data":914,"./helpers":915,"@plotly/d3":58}],920:[function(d,ee,te){var A=d("@plotly/d3"),g=d("./style_one"),S=d("../bar/uniform_text").resizeText;ee.exports=function(e){var a=e._fullLayout._pielayer.selectAll(".trace");S(e,a,"pie"),a.each(function(n){var r=n[0],t=r.trace,c=A.select(this);c.style({opacity:t.opacity}),c.selectAll("path.surface").each(function(s){A.select(this).call(g,s,t)})})}},{"../bar/uniform_text":673,"./style_one":921,"@plotly/d3":58}],921:[function(d,ee,te){var A=d("../../components/color"),g=d("./helpers").castOption;ee.exports=function(M,e,a){var n=a.marker.line,r=g(n.color,e.pts)||A.defaultLine,t=g(n.width,e.pts)||0;M.style("stroke-width",t).call(A.fill,e.color).call(A.stroke,r)}},{"../../components/color":367,"./helpers":915}],922:[function(d,ee,te){var A=d("../scatter/attributes");ee.exports={x:A.x,y:A.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:A.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":936}],923:[function(d,ee,te){var A=d("../../../stackgl_modules").gl_pointcloud2d,g=d("../../lib/str2rgbarray"),S=d("../../plots/cartesian/autorange").findExtremes,M=d("../scatter/get_trace_color");function e(r,t){this.scene=r,this.uid=t,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=A(r.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var a=e.prototype;a.handlePick=function(r){var t=this.idToIndex[r.pointId];return{trace:this,dataCoord:r.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[t*2],this.pickXYData[t*2+1]]:[this.pickXData[t],this.pickYData[t]],textLabel:Array.isArray(this.textLabels)?this.textLabels[t]:this.textLabels,color:this.color,name:this.name,pointIndex:t,hoverinfo:this.hoverinfo}},a.update=function(r){this.index=r.index,this.textLabels=r.text,this.name=r.name,this.hoverinfo=r.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(r),this.color=M(r,{})},a.updateFast=function(r){var t=this.xData=this.pickXData=r.x,c=this.yData=this.pickYData=r.y,s=this.pickXYData=r.xy,i=r.xbounds&&r.ybounds,x=r.indices,p,v,f,y=this.bounds,o,m,l;if(s){if(f=s,p=s.length>>>1,i)y[0]=r.xbounds[0],y[2]=r.xbounds[1],y[1]=r.ybounds[0],y[3]=r.ybounds[1];else for(l=0;l<p;l++)o=f[l*2],m=f[l*2+1],o<y[0]&&(y[0]=o),o>y[2]&&(y[2]=o),m<y[1]&&(y[1]=m),m>y[3]&&(y[3]=m);if(x)v=x;else for(v=new Int32Array(p),l=0;l<p;l++)v[l]=l}else for(p=t.length,f=new Float32Array(2*p),v=new Int32Array(p),l=0;l<p;l++)o=t[l],m=c[l],v[l]=l,f[l*2]=o,f[l*2+1]=m,o<y[0]&&(y[0]=o),o>y[2]&&(y[2]=o),m<y[1]&&(y[1]=m),m>y[3]&&(y[3]=m);this.idToIndex=v,this.pointcloudOptions.idToIndex=v,this.pointcloudOptions.positions=f;var w=g(r.marker.color),_=g(r.marker.border.color),h=r.opacity*r.marker.opacity;w[3]*=h,this.pointcloudOptions.color=w;var b=r.marker.blend;if(b===null){var u=100;b=t.length<u||c.length<u}this.pointcloudOptions.blend=b,_[3]*=h,this.pointcloudOptions.borderColor=_;var L=r.marker.sizemin,T=Math.max(r.marker.sizemax,r.marker.sizemin);this.pointcloudOptions.sizeMin=L,this.pointcloudOptions.sizeMax=T,this.pointcloudOptions.areaRatio=r.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var k=this.scene.xaxis,P=this.scene.yaxis,z=T/2||.5;r._extremes[k._id]=S(k,[y[0],y[2]],{ppad:z}),r._extremes[P._id]=S(P,[y[1],y[3]],{ppad:z})},a.dispose=function(){this.pointcloud.dispose()};function n(r,t){var c=new e(r,t.uid);return c.update(t),c}ee.exports=n},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/autorange":565,"../scatter/get_trace_color":946}],924:[function(d,ee,te){var A=d("../../lib"),g=d("./attributes");ee.exports=function(M,e,a){function n(r,t){return A.coerce(M,e,g,r,t)}n("x"),n("y"),n("xbounds"),n("ybounds"),M.xy&&M.xy instanceof Float32Array&&(e.xy=M.xy),M.indices&&M.indices instanceof Int32Array&&(e.indices=M.indices),n("text"),n("marker.color",a),n("marker.opacity"),n("marker.blend"),n("marker.sizemin"),n("marker.sizemax"),n("marker.border.color",a),n("marker.border.arearatio"),e._length=null}},{"../../lib":515,"./attributes":922}],925:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("../scatter3d/calc"),plot:d("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:d("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":605,"../scatter3d/calc":965,"./attributes":922,"./convert":923,"./defaults":924}],926:[function(d,ee,te){var A=d("../../plots/font_attributes"),g=d("../../plots/attributes"),S=d("../../components/color/attributes"),M=d("../../components/fx/attributes"),e=d("../../plots/domain").attributes,a=d("../../plots/template_attributes").hovertemplateAttrs,n=d("../../components/colorscale/attributes"),r=d("../../plot_api/plot_template").templatedArray,t=d("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,c=d("../../lib/extend").extendFlat,s=d("../../plot_api/edit_types").overrideAll,i=ee.exports=s({hoverinfo:c({},g.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:M.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:t("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:A({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:S.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:M.hoverlabel,hovertemplate:a({},{keys:["value","label"]})},link:{arrowlen:{valType:"number",min:0,dflt:0},label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:S.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:M.hoverlabel,hovertemplate:a({},{keys:["value","label"]}),colorscales:r("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:c(n().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested");i.transforms=void 0},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../components/fx/attributes":398,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],927:[function(d,ee,te){var A=d("../../plot_api/edit_types").overrideAll,g=d("../../plots/get_data").getModuleCalcData,S=d("./plot"),M=d("../../components/fx/layout_attributes"),e=d("../../lib/setcursor"),a=d("../../components/dragelement"),n=d("../../components/selections").prepSelect,r=d("../../lib"),t=d("../../registry"),c="sankey";te.name=c,te.baseLayoutAttrOverrides=A({hoverlabel:M.hoverlabel},"plot","nested"),te.plot=function(i){var x=g(i.calcdata,c)[0];S(i,x),te.updateFx(i)},te.clean=function(i,x,p,v){var f=v._has&&v._has(c),y=x._has&&x._has(c);f&&!y&&(v._paperdiv.selectAll(".sankey").remove(),v._paperdiv.selectAll(".bgsankey").remove())},te.updateFx=function(i){for(var x=0;x<i._fullData.length;x++)s(i,x)};function s(i,x){var p=i._fullData[x],v=i._fullLayout,f=v.dragmode,y=v.dragmode==="pan"?"move":"crosshair",o=p._bgRect;if(!!o&&!(f==="pan"||f==="zoom")){e(o,y);var m={_id:"x",c2p:r.identity,_offset:p._sankey.translateX,_length:p._sankey.width},l={_id:"y",c2p:r.identity,_offset:p._sankey.translateY,_length:p._sankey.height},w={gd:i,element:o.node(),plotinfo:{id:x,xaxis:m,yaxis:l,fillRangeItems:r.noop},subplot:x,xaxes:[m],yaxes:[l],doneFnCompleted:function(_){var h=i._fullData[x],b,u=h.node.groups.slice(),L=[];function T(I){for(var D=h._sankey.graph.nodes,R=0;R<D.length;R++)if(D[R].pointNumber===I)return D[R]}for(var k=0;k<_.length;k++){var P=T(_[k].pointNumber);if(!!P)if(P.group){for(var z=0;z<P.childrenNodes.length;z++)L.push(P.childrenNodes[z].pointNumber);u[P.pointNumber-h.node._count]=!1}else L.push(P.pointNumber)}b=u.filter(Boolean).concat([L]),t.call("_guiRestyle",i,{"node.groups":[b]},x)}};w.prepFn=function(_,h,b){n(_,h,b,w,f)},a.init(w)}}},{"../../components/dragelement":386,"../../components/fx/layout_attributes":408,"../../components/selections":455,"../../lib":515,"../../lib/setcursor":536,"../../plot_api/edit_types":548,"../../plots/get_data":602,"../../registry":647,"./plot":932}],928:[function(d,ee,te){var A=d("strongly-connected-components"),g=d("../../lib"),S=d("../../lib/gup").wrap,M=g.isArrayOrTypedArray,e=g.isIndex,a=d("../../components/colorscale");function n(t){var c=t.node,s=t.link,i=[],x=M(s.color),p=M(s.customdata),v={},f={},y=s.colorscales.length,o;for(o=0;o<y;o++){var m=s.colorscales[o],l=a.extractScale(m,{cLetter:"c"}),w=a.makeColorScaleFunc(l);f[m.label]=w}var _=0;for(o=0;o<s.value.length;o++)s.source[o]>_&&(_=s.source[o]),s.target[o]>_&&(_=s.target[o]);var h=_+1;t.node._count=h;var b,u=t.node.groups,L={};for(o=0;o<u.length;o++){var T=u[o];for(b=0;b<T.length;b++){var k=T[b],P=h+o;L.hasOwnProperty(k)?g.warn("Node "+k+" is already part of a group."):L[k]=P}}var z={source:[],target:[]};for(o=0;o<s.value.length;o++){var I=s.value[o],D=s.source[o],R=s.target[o];if(!!(I>0&&e(D,h)&&e(R,h))&&!(L.hasOwnProperty(D)&&L.hasOwnProperty(R)&&L[D]===L[R])){L.hasOwnProperty(R)&&(R=L[R]),L.hasOwnProperty(D)&&(D=L[D]),D=+D,R=+R,v[D]=v[R]=!0;var O="";s.label&&s.label[o]&&(O=s.label[o]);var F=null;O&&f.hasOwnProperty(O)&&(F=f[O]),i.push({pointNumber:o,label:O,color:x?s.color[o]:s.color,customdata:p?s.customdata[o]:s.customdata,concentrationscale:F,source:D,target:R,value:+I}),z.source.push(D),z.target.push(R)}}var N=h+u.length,G=M(c.color),K=M(c.customdata),W=[];for(o=0;o<N;o++)if(!!v[o]){var Y=c.label[o];W.push({group:o>h-1,childrenNodes:[],pointNumber:o,label:Y,color:G?c.color[o]:c.color,customdata:K?c.customdata[o]:c.customdata})}var re=!1;return r(N,z.source,z.target)&&(re=!0),{circular:re,links:i,nodes:W,groups:u,groupLookup:L}}function r(t,c,s){for(var i=g.init2dArray(t,0),x=0;x<Math.min(c.length,s.length);x++)if(g.isIndex(c[x],t)&&g.isIndex(s[x],t)){if(c[x]===s[x])return!0;i[c[x]].push(s[x])}var p=A(i);return p.components.some(function(v){return v.length>1})}ee.exports=function(c,s){var i=n(s);return S({circular:i.circular,_nodes:i.nodes,_links:i.links,_groups:i.groups,_groupLookup:i.groupLookup})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512,"strongly-connected-components":307}],929:[function(d,ee,te){ee.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],930:[function(d,ee,te){var A=d("../../lib"),g=d("./attributes"),S=d("../../components/color"),M=d("tinycolor2"),e=d("../../plots/domain").defaults,a=d("../../components/fx/hoverlabel_defaults"),n=d("../../plot_api/plot_template"),r=d("../../plots/array_container_defaults");ee.exports=function(s,i,x,p){function v(T,k){return A.coerce(s,i,g,T,k)}var f=A.extendDeep(p.hoverlabel,s.hoverlabel),y=s.node,o=n.newContainer(i,"node");function m(T,k){return A.coerce(y,o,g.node,T,k)}m("label"),m("groups"),m("x"),m("y"),m("pad"),m("thickness"),m("line.color"),m("line.width"),m("hoverinfo",s.hoverinfo),a(y,o,m,f),m("hovertemplate");var l=p.colorway,w=function(T){return l[T%l.length]};m("color",o.label.map(function(T,k){return S.addOpacity(w(k),.8)})),m("customdata");var _=s.link||{},h=n.newContainer(i,"link");function b(T,k){return A.coerce(_,h,g.link,T,k)}b("label"),b("arrowlen"),b("source"),b("target"),b("value"),b("line.color"),b("line.width"),b("hoverinfo",s.hoverinfo),a(_,h,b,f),b("hovertemplate");var u=M(p.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";b("color",A.repeat(u,h.value.length)),b("customdata"),r(_,h,{name:"colorscales",handleItemDefaults:t}),e(i,p,v),v("orientation"),v("valueformat"),v("valuesuffix");var L;o.x.length&&o.y.length&&(L="freeform"),v("arrangement",L),A.coerceFont(v,"textfont",A.extendFlat({},p.font)),i._length=null};function t(c,s){function i(x,p){return A.coerce(c,s,g.link.colorscales,x,p)}i("label"),i("cmin"),i("cmax"),i("colorscale")}},{"../../components/color":367,"../../components/fx/hoverlabel_defaults":405,"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/domain":593,"./attributes":926,tinycolor2:313}],931:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),moduleType:"trace",name:"sankey",basePlotModule:d("./base_plot"),selectPoints:d("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":926,"./base_plot":927,"./calc":928,"./defaults":930,"./plot":932,"./select.js":934}],932:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=g.numberFormat,M=d("./render"),e=d("../../components/fx"),a=d("../../components/color"),n=d("./constants").cn,r=g._;function t(l){return l!==""}function c(l,w){return l.filter(function(_){return _.key===w.traceId})}function s(l,w){A.select(l).select("path").style("fill-opacity",w),A.select(l).select("rect").style("fill-opacity",w)}function i(l){A.select(l).select("text.name").style("fill","black")}function x(l){return function(w){return l.node.sourceLinks.indexOf(w.link)!==-1||l.node.targetLinks.indexOf(w.link)!==-1}}function p(l){return function(w){return w.node.sourceLinks.indexOf(l.link)!==-1||w.node.targetLinks.indexOf(l.link)!==-1}}function v(l,w,_){w&&_&&c(_,w).selectAll("."+n.sankeyLink).filter(x(w)).call(y.bind(0,w,_,!1))}function f(l,w,_){w&&_&&c(_,w).selectAll("."+n.sankeyLink).filter(x(w)).call(o.bind(0,w,_,!1))}function y(l,w,_,h){var b=h.datum().link.label;h.style("fill-opacity",function(u){if(!u.link.concentrationscale)return .4}),b&&c(w,l).selectAll("."+n.sankeyLink).filter(function(u){return u.link.label===b}).style("fill-opacity",function(u){if(!u.link.concentrationscale)return .4}),_&&c(w,l).selectAll("."+n.sankeyNode).filter(p(l)).call(v)}function o(l,w,_,h){var b=h.datum().link.label;h.style("fill-opacity",function(u){return u.tinyColorAlpha}),b&&c(w,l).selectAll("."+n.sankeyLink).filter(function(u){return u.link.label===b}).style("fill-opacity",function(u){return u.tinyColorAlpha}),_&&c(w,l).selectAll(n.sankeyNode).filter(p(l)).call(f)}function m(l,w){var _=l.hoverlabel||{},h=g.nestedProperty(_,w).get();return Array.isArray(h)?!1:h}ee.exports=function(w,_){for(var h=w._fullLayout,b=h._paper,u=h._size,L=0;L<w._fullData.length;L++)if(!!w._fullData[L].visible&&w._fullData[L].type===n.sankey&&!w._fullData[L]._viewInitial){var T=w._fullData[L].node;w._fullData[L]._viewInitial={node:{groups:T.groups.slice(),x:T.x.slice(),y:T.y.slice()}}}var k=function(re,ue){var j=ue.link;j.originalEvent=A.event,w._hoverdata=[j],e.click(w,{target:!0})},P=function(re,ue,j){w._fullLayout.hovermode!==!1&&(A.select(re).call(y.bind(0,ue,j,!0)),ue.link.trace.link.hoverinfo!=="skip"&&(ue.link.fullData=ue.link.trace,w.emit("plotly_hover",{event:A.event,points:[ue.link]})))},z=r(w,"source:")+" ",I=r(w,"target:")+" ",D=r(w,"concentration:")+" ",R=r(w,"incoming flow count:")+" ",O=r(w,"outgoing flow count:")+" ",F=function(re,ue){if(w._fullLayout.hovermode===!1)return;var j=ue.link.trace.link;if(j.hoverinfo==="none"||j.hoverinfo==="skip")return;var q=[];function V(se){var ae,oe;se.circular?(ae=(se.circularPathData.leftInnerExtent+se.circularPathData.rightInnerExtent)/2,oe=se.circularPathData.verticalFullExtent):(ae=(se.source.x1+se.target.x0)/2,oe=(se.y0+se.y1)/2);var be=[ae,oe];return se.trace.orientation==="v"&&be.reverse(),be[0]+=ue.parent.translateX,be[1]+=ue.parent.translateY,be}for(var U=0,$=0;$<ue.flow.links.length;$++){var ne=ue.flow.links[$];if(!(w._fullLayout.hovermode==="closest"&&ue.link.pointNumber!==ne.pointNumber)){ue.link.pointNumber===ne.pointNumber&&(U=$),ne.fullData=ne.trace,j=ue.link.trace.link;var X=V(ne),Q={valueLabel:S(ue.valueFormat)(ne.value)+ue.valueSuffix};q.push({x:X[0],y:X[1],name:Q.valueLabel,text:[ne.label||"",z+ne.source.label,I+ne.target.label,ne.concentrationscale?D+S("%0.2f")(ne.flow.labelConcentration):""].filter(t).join("<br>"),color:m(j,"bgcolor")||a.addOpacity(ne.color,1),borderColor:m(j,"bordercolor"),fontFamily:m(j,"font.family"),fontSize:m(j,"font.size"),fontColor:m(j,"font.color"),nameLength:m(j,"namelength"),textAlign:m(j,"align"),idealAlign:A.event.x<X[0]?"right":"left",hovertemplate:j.hovertemplate,hovertemplateLabels:Q,eventData:[ne]})}}var ie=e.loneHover(q,{container:h._hoverlayer.node(),outerContainer:h._paper.node(),gd:w,anchorIndex:U});ie.each(function(){var se=this;ue.link.concentrationscale||s(se,.65),i(se)})},N=function(re,ue,j){w._fullLayout.hovermode!==!1&&(A.select(re).call(o.bind(0,ue,j,!0)),ue.link.trace.link.hoverinfo!=="skip"&&(ue.link.fullData=ue.link.trace,w.emit("plotly_unhover",{event:A.event,points:[ue.link]})),e.loneUnhover(h._hoverlayer.node()))},G=function(re,ue,j){var q=ue.node;q.originalEvent=A.event,w._hoverdata=[q],A.select(re).call(f,ue,j),e.click(w,{target:!0})},K=function(re,ue,j){w._fullLayout.hovermode!==!1&&(A.select(re).call(v,ue,j),ue.node.trace.node.hoverinfo!=="skip"&&(ue.node.fullData=ue.node.trace,w.emit("plotly_hover",{event:A.event,points:[ue.node]})))},W=function(re,ue){if(w._fullLayout.hovermode!==!1){var j=ue.node.trace.node;if(!(j.hoverinfo==="none"||j.hoverinfo==="skip")){var q=A.select(re).select("."+n.nodeRect),V=w._fullLayout._paperdiv.node().getBoundingClientRect(),U=q.node().getBoundingClientRect(),$=U.left-2-V.left,ne=U.right+2-V.left,X=U.top+U.height/4-V.top,Q={valueLabel:S(ue.valueFormat)(ue.node.value)+ue.valueSuffix};ue.node.fullData=ue.node.trace,w._fullLayout._calcInverseTransform(w);var ie=w._fullLayout._invScaleX,se=w._fullLayout._invScaleY,ae=e.loneHover({x0:ie*$,x1:ie*ne,y:se*X,name:S(ue.valueFormat)(ue.node.value)+ue.valueSuffix,text:[ue.node.label,R+ue.node.targetLinks.length,O+ue.node.sourceLinks.length].filter(t).join("<br>"),color:m(j,"bgcolor")||ue.tinyColorHue,borderColor:m(j,"bordercolor"),fontFamily:m(j,"font.family"),fontSize:m(j,"font.size"),fontColor:m(j,"font.color"),nameLength:m(j,"namelength"),textAlign:m(j,"align"),idealAlign:"left",hovertemplate:j.hovertemplate,hovertemplateLabels:Q,eventData:[ue.node]},{container:h._hoverlayer.node(),outerContainer:h._paper.node(),gd:w});s(ae,.85),i(ae)}}},Y=function(re,ue,j){w._fullLayout.hovermode!==!1&&(A.select(re).call(f,ue,j),ue.node.trace.node.hoverinfo!=="skip"&&(ue.node.fullData=ue.node.trace,w.emit("plotly_unhover",{event:A.event,points:[ue.node]})),e.loneUnhover(h._hoverlayer.node()))};M(w,b,_,{width:u.w,height:u.h,margin:{t:u.t,r:u.r,b:u.b,l:u.l}},{linkEvents:{hover:P,follow:F,unhover:N,select:k},nodeEvents:{hover:K,follow:W,unhover:Y,select:G}})}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"./constants":929,"./render":933,"@plotly/d3":58}],933:[function(d,ee,te){var A=d("d3-force"),g=d("d3-interpolate").interpolateNumber,S=d("@plotly/d3"),M=d("@plotly/d3-sankey"),e=d("@plotly/d3-sankey-circular"),a=d("./constants"),n=d("tinycolor2"),r=d("../../components/color"),t=d("../../components/drawing"),c=d("../../lib"),s=c.strTranslate,i=c.strRotate,x=d("../../lib/gup"),p=x.keyFun,v=x.repeat,f=x.unwrap,y=d("../../lib/svg_text_utils"),o=d("../../registry"),m=d("../../constants/alignment"),l=m.CAP_SHIFT,w=m.LINE_SPACING,_=3;function h(V,U,$){var ne=f(U),X=ne.trace,Q=X.domain,ie=X.orientation==="h",se=X.node.pad,ae=X.node.thickness,oe=V.width*(Q.x[1]-Q.x[0]),be=V.height*(Q.y[1]-Q.y[0]),ce=ne._nodes,de=ne._links,ye=ne.circular,ge;ye?ge=e.sankeyCircular().circularLinkGap(0):ge=M.sankey(),ge.iterations(a.sankeyIterations).size(ie?[oe,be]:[be,oe]).nodeWidth(ae).nodePadding(se).nodeId(function(It){return It.pointNumber}).nodes(ce).links(de);var me=ge();ge.nodePadding()<se&&c.warn("node.pad was reduced to ",ge.nodePadding()," to fit within the figure.");var Ee,Pe,Ne;for(var we in ne._groupLookup){var ke=parseInt(ne._groupLookup[we]),Xe;for(Ee=0;Ee<me.nodes.length;Ee++)if(me.nodes[Ee].pointNumber===ke){Xe=me.nodes[Ee];break}if(!!Xe){var He={pointNumber:parseInt(we),x0:Xe.x0,x1:Xe.x1,y0:Xe.y0,y1:Xe.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};me.nodes.unshift(He),Xe.childrenNodes.unshift(He)}}function Ie(){for(Ee=0;Ee<me.nodes.length;Ee++){var It=me.nodes[Ee],Mt={},Yt,zt;for(Pe=0;Pe<It.targetLinks.length;Pe++)zt=It.targetLinks[Pe],Yt=zt.source.pointNumber+":"+zt.target.pointNumber,Mt.hasOwnProperty(Yt)||(Mt[Yt]=[]),Mt[Yt].push(zt);var St=Object.keys(Mt);for(Pe=0;Pe<St.length;Pe++){Yt=St[Pe];var Ye=Mt[Yt],rt=0,Ve={};for(Ne=0;Ne<Ye.length;Ne++)zt=Ye[Ne],Ve[zt.label]||(Ve[zt.label]=0),Ve[zt.label]+=zt.value,rt+=zt.value;for(Ne=0;Ne<Ye.length;Ne++)zt=Ye[Ne],zt.flow={value:rt,labelConcentration:Ve[zt.label]/rt,concentration:zt.value/rt,links:Ye},zt.concentrationscale&&(zt.color=n(zt.concentrationscale(zt.flow.labelConcentration)))}var Ae=0;for(Pe=0;Pe<It.sourceLinks.length;Pe++)Ae+=It.sourceLinks[Pe].value;for(Pe=0;Pe<It.sourceLinks.length;Pe++)zt=It.sourceLinks[Pe],zt.concentrationOut=zt.value/Ae;var Ue=0;for(Pe=0;Pe<It.targetLinks.length;Pe++)Ue+=It.targetLinks[Pe].value;for(Pe=0;Pe<It.targetLinks.length;Pe++)zt=It.targetLinks[Pe],zt.concenrationIn=zt.value/Ue}}Ie();function De(It){It.forEach(function(Mt){var Yt,zt,St=0,Ye=Mt.length,rt;for(Mt.sort(function(Ve,Ae){return Ve.y0-Ae.y0}),rt=0;rt<Ye;++rt)Yt=Mt[rt],Yt.y0>=St||(zt=St-Yt.y0,zt>1e-6&&(Yt.y0+=zt,Yt.y1+=zt)),St=Yt.y1+se})}function Ge(It){var Mt=It.map(function(Ae,Ue){return{x0:Ae.x0,index:Ue}}).sort(function(Ae,Ue){return Ae.x0-Ue.x0}),Yt=[],zt=-1,St,Ye=-1/0,rt;for(Ee=0;Ee<Mt.length;Ee++){var Ve=It[Mt[Ee].index];Ve.x0>Ye+ae&&(zt+=1,St=Ve.x0),Ye=Ve.x0,Yt[zt]||(Yt[zt]=[]),Yt[zt].push(Ve),rt=St-Ve.x0,Ve.x0+=rt,Ve.x1+=rt}return Yt}if(X.node.x.length&&X.node.y.length){for(Ee=0;Ee<Math.min(X.node.x.length,X.node.y.length,me.nodes.length);Ee++)if(X.node.x[Ee]&&X.node.y[Ee]){var ht=[X.node.x[Ee]*oe,X.node.y[Ee]*be];me.nodes[Ee].x0=ht[0]-ae/2,me.nodes[Ee].x1=ht[0]+ae/2;var Rt=me.nodes[Ee].y1-me.nodes[Ee].y0;me.nodes[Ee].y0=ht[1]-Rt/2,me.nodes[Ee].y1=ht[1]+Rt/2}if(X.arrangement==="snap"){ce=me.nodes;var Kt=Ge(ce);De(Kt)}ge.update(me)}return{circular:ye,key:$,trace:X,guid:c.randstr(),horizontal:ie,width:oe,height:be,nodePad:X.node.pad,nodeLineColor:X.node.line.color,nodeLineWidth:X.node.line.width,linkLineColor:X.link.line.color,linkLineWidth:X.link.line.width,linkArrowLength:X.link.arrowlen,valueFormat:X.valueformat,valueSuffix:X.valuesuffix,textFont:X.textfont,translateX:Q.x[0]*V.width+V.margin.l,translateY:V.height-Q.y[1]*V.height+V.margin.t,dragParallel:ie?be:oe,dragPerpendicular:ie?oe:be,arrangement:X.arrangement,sankey:ge,graph:me,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function b(V,U,$){var ne=n(U.color),X=U.source.label+"|"+U.target.label,Q=X+"__"+$;return U.trace=V.trace,U.curveNumber=V.trace.index,{circular:V.circular,key:Q,traceId:V.key,pointNumber:U.pointNumber,link:U,tinyColorHue:r.tinyRGB(ne),tinyColorAlpha:ne.getAlpha(),linkPath:L,linkLineColor:V.linkLineColor,linkLineWidth:V.linkLineWidth,linkArrowLength:V.linkArrowLength,valueFormat:V.valueFormat,valueSuffix:V.valueSuffix,sankey:V.sankey,parent:V,interactionState:V.interactionState,flow:U.flow}}function u(V,U){var $="",ne=V.width/2,X=V.circularPathData;return V.circularLinkType==="top"?$="M "+(X.targetX-U)+" "+(X.targetY+ne)+" L"+(X.rightInnerExtent-U)+" "+(X.targetY+ne)+"A"+(X.rightLargeArcRadius+ne)+" "+(X.rightSmallArcRadius+ne)+" 0 0 1 "+(X.rightFullExtent-ne-U)+" "+(X.targetY-X.rightSmallArcRadius)+"L"+(X.rightFullExtent-ne-U)+" "+X.verticalRightInnerExtent+"A"+(X.rightLargeArcRadius+ne)+" "+(X.rightLargeArcRadius+ne)+" 0 0 1 "+(X.rightInnerExtent-U)+" "+(X.verticalFullExtent-ne)+"L"+X.leftInnerExtent+" "+(X.verticalFullExtent-ne)+"A"+(X.leftLargeArcRadius+ne)+" "+(X.leftLargeArcRadius+ne)+" 0 0 1 "+(X.leftFullExtent+ne)+" "+X.verticalLeftInnerExtent+"L"+(X.leftFullExtent+ne)+" "+(X.sourceY-X.leftSmallArcRadius)+"A"+(X.leftLargeArcRadius+ne)+" "+(X.leftSmallArcRadius+ne)+" 0 0 1 "+X.leftInnerExtent+" "+(X.sourceY+ne)+"L"+X.sourceX+" "+(X.sourceY+ne)+"L"+X.sourceX+" "+(X.sourceY-ne)+"L"+X.leftInnerExtent+" "+(X.sourceY-ne)+"A"+(X.leftLargeArcRadius-ne)+" "+(X.leftSmallArcRadius-ne)+" 0 0 0 "+(X.leftFullExtent-ne)+" "+(X.sourceY-X.leftSmallArcRadius)+"L"+(X.leftFullExtent-ne)+" "+X.verticalLeftInnerExtent+"A"+(X.leftLargeArcRadius-ne)+" "+(X.leftLargeArcRadius-ne)+" 0 0 0 "+X.leftInnerExtent+" "+(X.verticalFullExtent+ne)+"L"+(X.rightInnerExtent-U)+" "+(X.verticalFullExtent+ne)+"A"+(X.rightLargeArcRadius-ne)+" "+(X.rightLargeArcRadius-ne)+" 0 0 0 "+(X.rightFullExtent+ne-U)+" "+X.verticalRightInnerExtent+"L"+(X.rightFullExtent+ne-U)+" "+(X.targetY-X.rightSmallArcRadius)+"A"+(X.rightLargeArcRadius-ne)+" "+(X.rightSmallArcRadius-ne)+" 0 0 0 "+(X.rightInnerExtent-U)+" "+(X.targetY-ne)+"L"+(X.targetX-U)+" "+(X.targetY-ne)+(U>0?"L"+X.targetX+" "+X.targetY:"")+"Z":$="M "+(X.targetX-U)+" "+(X.targetY-ne)+" L"+(X.rightInnerExtent-U)+" "+(X.targetY-ne)+"A"+(X.rightLargeArcRadius+ne)+" "+(X.rightSmallArcRadius+ne)+" 0 0 0 "+(X.rightFullExtent-ne-U)+" "+(X.targetY+X.rightSmallArcRadius)+"L"+(X.rightFullExtent-ne-U)+" "+X.verticalRightInnerExtent+"A"+(X.rightLargeArcRadius+ne)+" "+(X.rightLargeArcRadius+ne)+" 0 0 0 "+(X.rightInnerExtent-U)+" "+(X.verticalFullExtent+ne)+"L"+X.leftInnerExtent+" "+(X.verticalFullExtent+ne)+"A"+(X.leftLargeArcRadius+ne)+" "+(X.leftLargeArcRadius+ne)+" 0 0 0 "+(X.leftFullExtent+ne)+" "+X.verticalLeftInnerExtent+"L"+(X.leftFullExtent+ne)+" "+(X.sourceY+X.leftSmallArcRadius)+"A"+(X.leftLargeArcRadius+ne)+" "+(X.leftSmallArcRadius+ne)+" 0 0 0 "+X.leftInnerExtent+" "+(X.sourceY-ne)+"L"+X.sourceX+" "+(X.sourceY-ne)+"L"+X.sourceX+" "+(X.sourceY+ne)+"L"+X.leftInnerExtent+" "+(X.sourceY+ne)+"A"+(X.leftLargeArcRadius-ne)+" "+(X.leftSmallArcRadius-ne)+" 0 0 1 "+(X.leftFullExtent-ne)+" "+(X.sourceY+X.leftSmallArcRadius)+"L"+(X.leftFullExtent-ne)+" "+X.verticalLeftInnerExtent+"A"+(X.leftLargeArcRadius-ne)+" "+(X.leftLargeArcRadius-ne)+" 0 0 1 "+X.leftInnerExtent+" "+(X.verticalFullExtent-ne)+"L"+(X.rightInnerExtent-U)+" "+(X.verticalFullExtent-ne)+"A"+(X.rightLargeArcRadius-ne)+" "+(X.rightLargeArcRadius-ne)+" 0 0 1 "+(X.rightFullExtent+ne-U)+" "+X.verticalRightInnerExtent+"L"+(X.rightFullExtent+ne-U)+" "+(X.targetY+X.rightSmallArcRadius)+"A"+(X.rightLargeArcRadius-ne)+" "+(X.rightSmallArcRadius-ne)+" 0 0 1 "+(X.rightInnerExtent-U)+" "+(X.targetY+ne)+"L"+(X.targetX-U)+" "+(X.targetY+ne)+(U>0?"L"+X.targetX+" "+X.targetY:"")+"Z",$}function L(){var V=.5;function U($){var ne=$.linkArrowLength;if($.link.circular)return u($.link,ne);var X=Math.abs(($.link.target.x0-$.link.source.x1)/2);ne>X&&(ne=X);var Q=$.link.source.x1,ie=$.link.target.x0-ne,se=g(Q,ie),ae=se(V),oe=se(1-V),be=$.link.y0-$.link.width/2,ce=$.link.y0+$.link.width/2,de=$.link.y1-$.link.width/2,ye=$.link.y1+$.link.width/2,ge="M"+Q+","+be,me="C"+ae+","+be+" "+oe+","+de+" "+ie+","+de,Ee="C"+oe+","+ye+" "+ae+","+ce+" "+Q+","+ce,Pe=ne>0?"L"+(ie+ne)+","+(de+$.link.width/2):"";return Pe+="L"+ie+","+ye,ge+me+Pe+Ee+"Z"}return U}function T(V,U){var $=n(U.color),ne=a.nodePadAcross,X=V.nodePad/2;U.dx=U.x1-U.x0,U.dy=U.y1-U.y0;var Q=U.dx,ie=Math.max(.5,U.dy),se="node_"+U.pointNumber;return U.group&&(se=c.randstr()),U.trace=V.trace,U.curveNumber=V.trace.index,{index:U.pointNumber,key:se,partOfGroup:U.partOfGroup||!1,group:U.group,traceId:V.key,trace:V.trace,node:U,nodePad:V.nodePad,nodeLineColor:V.nodeLineColor,nodeLineWidth:V.nodeLineWidth,textFont:V.textFont,size:V.horizontal?V.height:V.width,visibleWidth:Math.ceil(Q),visibleHeight:ie,zoneX:-ne,zoneY:-X,zoneWidth:Q+2*ne,zoneHeight:ie+2*X,labelY:V.horizontal?U.dy/2+1:U.dx/2+1,left:U.originalLayer===1,sizeAcross:V.width,forceLayouts:V.forceLayouts,horizontal:V.horizontal,darkBackground:$.getBrightness()<=128,tinyColorHue:r.tinyRGB($),tinyColorAlpha:$.getAlpha(),valueFormat:V.valueFormat,valueSuffix:V.valueSuffix,sankey:V.sankey,graph:V.graph,arrangement:V.arrangement,uniqueNodeLabelPathId:[V.guid,V.key,se].join("_"),interactionState:V.interactionState,figure:V}}function k(V){V.attr("transform",function(U){return s(U.node.x0.toFixed(3),U.node.y0.toFixed(3))})}function P(V){V.call(k)}function z(V,U){V.call(P),U.attr("d",L())}function I(V){V.attr("width",function(U){return U.node.x1-U.node.x0}).attr("height",function(U){return U.visibleHeight})}function D(V){return V.link.width>1||V.linkLineWidth>0}function R(V){var U=s(V.translateX,V.translateY);return U+(V.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function O(V,U,$){V.on(".basic",null).on("mouseover.basic",function(ne){!ne.interactionState.dragInProgress&&!ne.partOfGroup&&($.hover(this,ne,U),ne.interactionState.hovered=[this,ne])}).on("mousemove.basic",function(ne){!ne.interactionState.dragInProgress&&!ne.partOfGroup&&($.follow(this,ne),ne.interactionState.hovered=[this,ne])}).on("mouseout.basic",function(ne){!ne.interactionState.dragInProgress&&!ne.partOfGroup&&($.unhover(this,ne,U),ne.interactionState.hovered=!1)}).on("click.basic",function(ne){ne.interactionState.hovered&&($.unhover(this,ne,U),ne.interactionState.hovered=!1),!ne.interactionState.dragInProgress&&!ne.partOfGroup&&$.select(this,ne,U)})}function F(V,U,$,ne){var X=S.behavior.drag().origin(function(Q){return{x:Q.node.x0+Q.visibleWidth/2,y:Q.node.y0+Q.visibleHeight/2}}).on("dragstart",function(Q){if(Q.arrangement!=="fixed"&&(c.ensureSingle(ne._fullLayout._infolayer,"g","dragcover",function(se){ne._fullLayout._dragCover=se}),c.raiseToTop(this),Q.interactionState.dragInProgress=Q.node,re(Q.node),Q.interactionState.hovered&&($.nodeEvents.unhover.apply(0,Q.interactionState.hovered),Q.interactionState.hovered=!1),Q.arrangement==="snap")){var ie=Q.traceId+"|"+Q.key;Q.forceLayouts[ie]?Q.forceLayouts[ie].alpha(1):N(V,ie,Q),G(V,U,Q,ie,ne)}}).on("drag",function(Q){if(Q.arrangement!=="fixed"){var ie=S.event.x,se=S.event.y;Q.arrangement==="snap"?(Q.node.x0=ie-Q.visibleWidth/2,Q.node.x1=ie+Q.visibleWidth/2,Q.node.y0=se-Q.visibleHeight/2,Q.node.y1=se+Q.visibleHeight/2):(Q.arrangement==="freeform"&&(Q.node.x0=ie-Q.visibleWidth/2,Q.node.x1=ie+Q.visibleWidth/2),se=Math.max(0,Math.min(Q.size-Q.visibleHeight/2,se)),Q.node.y0=se-Q.visibleHeight/2,Q.node.y1=se+Q.visibleHeight/2),re(Q.node),Q.arrangement!=="snap"&&(Q.sankey.update(Q.graph),z(V.filter(ue(Q)),U))}}).on("dragend",function(Q){if(Q.arrangement!=="fixed"){Q.interactionState.dragInProgress=!1;for(var ie=0;ie<Q.node.childrenNodes.length;ie++)Q.node.childrenNodes[ie].x=Q.node.x,Q.node.childrenNodes[ie].y=Q.node.y;Q.arrangement!=="snap"&&W(Q,ne)}});V.on(".drag",null).call(X)}function N(V,U,$,ne){j($.graph.nodes);var X=$.graph.nodes.filter(function(Q){return Q.originalX===$.node.originalX}).filter(function(Q){return!Q.partOfGroup});$.forceLayouts[U]=A.forceSimulation(X).alphaDecay(0).force("collide",A.forceCollide().radius(function(Q){return Q.dy/2+$.nodePad/2}).strength(1).iterations(a.forceIterations)).force("constrain",K(V,U,X,$)).stop()}function G(V,U,$,ne,X){window.requestAnimationFrame(function Q(){var ie;for(ie=0;ie<a.forceTicksPerFrame;ie++)$.forceLayouts[ne].tick();var se=$.graph.nodes;if(q(se),$.sankey.update($.graph),z(V.filter(ue($)),U),$.forceLayouts[ne].alpha()>0)window.requestAnimationFrame(Q);else{var ae=$.node.originalX;$.node.x0=ae-$.visibleWidth/2,$.node.x1=ae+$.visibleWidth/2,W($,X)}})}function K(V,U,$,ne){return function(){for(var Q=0,ie=0;ie<$.length;ie++){var se=$[ie];se===ne.interactionState.dragInProgress?(se.x=se.lastDraggedX,se.y=se.lastDraggedY):(se.vx=(se.originalX-se.x)/a.forceTicksPerFrame,se.y=Math.min(ne.size-se.dy/2,Math.max(se.dy/2,se.y))),Q=Math.max(Q,Math.abs(se.vx),Math.abs(se.vy))}!ne.interactionState.dragInProgress&&Q<.1&&ne.forceLayouts[U].alpha()>0&&ne.forceLayouts[U].alpha(0)}}function W(V,U){for(var $=[],ne=[],X=0;X<V.graph.nodes.length;X++){var Q=(V.graph.nodes[X].x0+V.graph.nodes[X].x1)/2,ie=(V.graph.nodes[X].y0+V.graph.nodes[X].y1)/2;$.push(Q/V.figure.width),ne.push(ie/V.figure.height)}o.call("_guiRestyle",U,{"node.x":[$],"node.y":[ne]},V.trace.index).then(function(){U._fullLayout._dragCover&&U._fullLayout._dragCover.remove()})}function Y(V){var U=[],$;for($=0;$<V.length;$++)V[$].originalX=(V[$].x0+V[$].x1)/2,V[$].originalY=(V[$].y0+V[$].y1)/2,U.indexOf(V[$].originalX)===-1&&U.push(V[$].originalX);for(U.sort(function(ne,X){return ne-X}),$=0;$<V.length;$++)V[$].originalLayerIndex=U.indexOf(V[$].originalX),V[$].originalLayer=V[$].originalLayerIndex/(U.length-1)}function re(V){V.lastDraggedX=V.x0+V.dx/2,V.lastDraggedY=V.y0+V.dy/2}function ue(V){return function(U){return U.node.originalX===V.node.originalX}}function j(V){for(var U=0;U<V.length;U++)V[U].y=(V[U].y0+V[U].y1)/2,V[U].x=(V[U].x0+V[U].x1)/2}function q(V){for(var U=0;U<V.length;U++)V[U].y0=V[U].y-V[U].dy/2,V[U].y1=V[U].y0+V[U].dy,V[U].x0=V[U].x-V[U].dx/2,V[U].x1=V[U].x0+V[U].dx}ee.exports=function(V,U,$,ne,X){var Q=V._context.staticPlot,ie=!1;c.ensureSingle(V._fullLayout._infolayer,"g","first-render",function(){ie=!0});var se=V._fullLayout._dragCover,ae=$.filter(function(Ee){return f(Ee).trace.visible}).map(h.bind(null,ne)),oe=U.selectAll("."+a.cn.sankey).data(ae,p);oe.exit().remove(),oe.enter().append("g").classed(a.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events",Q?"none":"auto").attr("transform",R),oe.each(function(Ee,Pe){V._fullData[Pe]._sankey=Ee;var Ne="bgsankey-"+Ee.trace.uid+"-"+Pe;c.ensureSingle(V._fullLayout._draggers,"rect",Ne),V._fullData[Pe]._bgRect=S.select("."+Ne),V._fullData[Pe]._bgRect.style("pointer-events",Q?"none":"all").attr("width",Ee.width).attr("height",Ee.height).attr("x",Ee.translateX).attr("y",Ee.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),oe.transition().ease(a.ease).duration(a.duration).attr("transform",R);var be=oe.selectAll("."+a.cn.sankeyLinks).data(v,p);be.enter().append("g").classed(a.cn.sankeyLinks,!0).style("fill","none");var ce=be.selectAll("."+a.cn.sankeyLink).data(function(Ee){var Pe=Ee.graph.links;return Pe.filter(function(Ne){return Ne.value}).map(b.bind(null,Ee))},p);ce.enter().append("path").classed(a.cn.sankeyLink,!0).call(O,oe,X.linkEvents),ce.style("stroke",function(Ee){return D(Ee)?r.tinyRGB(n(Ee.linkLineColor)):Ee.tinyColorHue}).style("stroke-opacity",function(Ee){return D(Ee)?r.opacity(Ee.linkLineColor):Ee.tinyColorAlpha}).style("fill",function(Ee){return Ee.tinyColorHue}).style("fill-opacity",function(Ee){return Ee.tinyColorAlpha}).style("stroke-width",function(Ee){return D(Ee)?Ee.linkLineWidth:1}).attr("d",L()),ce.style("opacity",function(){return V._context.staticPlot||ie||se?1:0}).transition().ease(a.ease).duration(a.duration).style("opacity",1),ce.exit().transition().ease(a.ease).duration(a.duration).style("opacity",0).remove();var de=oe.selectAll("."+a.cn.sankeyNodeSet).data(v,p);de.enter().append("g").classed(a.cn.sankeyNodeSet,!0),de.style("cursor",function(Ee){switch(Ee.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var ye=de.selectAll("."+a.cn.sankeyNode).data(function(Ee){var Pe=Ee.graph.nodes;return Y(Pe),Pe.map(T.bind(null,Ee))},p);ye.enter().append("g").classed(a.cn.sankeyNode,!0).call(k).style("opacity",function(Ee){return(V._context.staticPlot||ie)&&!Ee.partOfGroup?1:0}),ye.call(O,oe,X.nodeEvents).call(F,ce,X,V),ye.transition().ease(a.ease).duration(a.duration).call(k).style("opacity",function(Ee){return Ee.partOfGroup?0:1}),ye.exit().transition().ease(a.ease).duration(a.duration).style("opacity",0).remove();var ge=ye.selectAll("."+a.cn.nodeRect).data(v);ge.enter().append("rect").classed(a.cn.nodeRect,!0).call(I),ge.style("stroke-width",function(Ee){return Ee.nodeLineWidth}).style("stroke",function(Ee){return r.tinyRGB(n(Ee.nodeLineColor))}).style("stroke-opacity",function(Ee){return r.opacity(Ee.nodeLineColor)}).style("fill",function(Ee){return Ee.tinyColorHue}).style("fill-opacity",function(Ee){return Ee.tinyColorAlpha}),ge.transition().ease(a.ease).duration(a.duration).call(I);var me=ye.selectAll("."+a.cn.nodeLabel).data(v);me.enter().append("text").classed(a.cn.nodeLabel,!0).style("cursor","default"),me.attr("data-notex",1).text(function(Ee){return Ee.node.label}).each(function(Ee){var Pe=S.select(this);t.font(Pe,Ee.textFont),y.convertToTspans(Pe,V)}).style("text-shadow",y.makeTextShadow(V._fullLayout.paper_bgcolor)).attr("text-anchor",function(Ee){return Ee.horizontal&&Ee.left?"end":"start"}).attr("transform",function(Ee){var Pe=S.select(this),Ne=y.lineCount(Pe),we=Ee.textFont.size*((Ne-1)*w-l),ke=Ee.nodeLineWidth/2+_,Xe=((Ee.horizontal?Ee.visibleHeight:Ee.visibleWidth)-we)/2;Ee.horizontal&&(Ee.left?ke=-ke:ke+=Ee.visibleWidth);var He=Ee.horizontal?"":"scale(-1,1)"+i(90);return s(Ee.horizontal?ke:Xe,Ee.horizontal?Xe:ke)+He}),me.transition().ease(a.ease).duration(a.duration)}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../registry":647,"./constants":929,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:313}],934:[function(d,ee,te){ee.exports=function(g,S){for(var M=g.cd,e=[],a=M[0].trace,n=a._sankey.graph.nodes,r=0;r<n.length;r++){var t=n[r];if(!t.partOfGroup){var c=[(t.x0+t.x1)/2,(t.y0+t.y1)/2];a.orientation==="v"&&c.reverse(),S&&S.contains(c,!1,r,g)&&e.push({pointNumber:t.pointNumber})}}return e}},{}],935:[function(d,ee,te){var A=d("../../lib");ee.exports=function(S,M){for(var e=0;e<S.length;e++)S[e].i=e;A.mergeArray(M.text,S,"tx"),A.mergeArray(M.texttemplate,S,"txt"),A.mergeArray(M.hovertext,S,"htx"),A.mergeArray(M.customdata,S,"data"),A.mergeArray(M.textposition,S,"tp"),M.textfont&&(A.mergeArrayCastPositive(M.textfont.size,S,"ts"),A.mergeArray(M.textfont.color,S,"tc"),A.mergeArray(M.textfont.family,S,"tf"));var a=M.marker;if(a){A.mergeArrayCastPositive(a.size,S,"ms"),A.mergeArrayCastPositive(a.opacity,S,"mo"),A.mergeArray(a.symbol,S,"mx"),A.mergeArray(a.angle,S,"ma"),A.mergeArray(a.standoff,S,"mf"),A.mergeArray(a.color,S,"mc");var n=a.line;a.line&&(A.mergeArray(n.color,S,"mlc"),A.mergeArrayCastPositive(n.width,S,"mlw"));var r=a.gradient;r&&r.type!=="none"&&(A.mergeArray(r.type,S,"mgt"),A.mergeArray(r.color,S,"mgc"))}}},{"../../lib":515}],936:[function(d,ee,te){var A=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,g=d("../../plots/template_attributes").texttemplateAttrs,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../../components/colorscale/attributes"),e=d("../../plots/font_attributes"),a=d("../../components/drawing/attributes").dash,n=d("../../components/drawing/attributes").pattern,r=d("../../components/drawing"),t=d("./constants"),c=d("../../lib/extend").extendFlat;function s(p){return{valType:"any",dflt:0,editType:"calc"}}function i(p){return{valType:"any",editType:"calc"}}function x(p){return{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"}}ee.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:s(),yperiod:s(),xperiod0:i(),yperiod0:i(),xperiodalignment:x(),yperiodalignment:x(),xhoverformat:A("x"),yhoverformat:A("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:g({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:S({},{keys:t.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:c({},a,{editType:"style"}),backoff:{valType:"number",min:0,dflt:"auto",arrayOk:!0,editType:"plot"},simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},fillpattern:n,marker:c({symbol:{valType:"enumerated",values:r.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},angle:{valType:"angle",dflt:0,arrayOk:!0,editType:"plot",anim:!1},angleref:{valType:"enumerated",values:["previous","up"],dflt:"up",editType:"plot",anim:!1},standoff:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"plot",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:c({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},M("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},M("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":374,"../../components/drawing":389,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"./constants":940}],937:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib"),S=d("../../plots/cartesian/axes"),M=d("../../plots/cartesian/align_period"),e=d("../../constants/numerical").BADNUM,a=d("./subtypes"),n=d("./colorscale_calc"),r=d("./arrays_to_calcdata"),t=d("./calc_selection");function c(f,y){var o=f._fullLayout,m=y._xA=S.getFromId(f,y.xaxis||"x","x"),l=y._yA=S.getFromId(f,y.yaxis||"y","y"),w=m.makeCalcdata(y,"x"),_=l.makeCalcdata(y,"y"),h=M(y,m,"x",w),b=M(y,l,"y",_),u=h.vals,L=b.vals,T=y._length,k=new Array(T),P=y.ids,z=v(y,o,m,l),I=!1,D,R,O,F,N,G;x(o,y);var K="x",W="y",Y;if(z)g.pushUnique(z.traceIndices,y._expandedIndex),D=z.orientation==="v",D?(W="s",Y="x"):(K="s",Y="y"),N=z.stackgaps==="interpolate";else{var re=i(y,T);s(f,y,m,l,u,L,re)}var ue=!!y.xperiodalignment,j=!!y.yperiodalignment;for(R=0;R<T;R++){var q=k[R]={},V=A(u[R]),U=A(L[R]);V&&U?(q[K]=u[R],q[W]=L[R],ue&&(q.orig_x=w[R],q.xEnd=h.ends[R],q.xStart=h.starts[R]),j&&(q.orig_y=_[R],q.yEnd=b.ends[R],q.yStart=b.starts[R])):z&&(D?V:U)?(q[Y]=D?u[R]:L[R],q.gap=!0,N?(q.s=e,I=!0):q.s=0):q[K]=q[W]=e,P&&(q.id=String(P[R]))}if(r(k,y),n(f,y),t(k,y),z){for(R=0;R<k.length;)k[R][Y]===e?k.splice(R,1):R++;if(g.sort(k,function(Q,ie){return Q[Y]-ie[Y]||Q.i-ie.i}),I){for(R=0;R<k.length-1&&k[R].gap;)R++;for(G=k[R].s,G||(G=k[R].s=0),O=0;O<R;O++)k[O].s=G;for(F=k.length-1;F>R&&k[F].gap;)F--;for(G=k[F].s,O=k.length-1;O>F;O--)k[O].s=G;for(;R<F;)if(R++,k[R].gap){for(O=R+1;k[O].gap;)O++;for(var $=k[R-1][Y],ne=k[R-1].s,X=(k[O].s-ne)/(k[O][Y]-$);R<O;)k[R].s=ne+(k[R][Y]-$)*X,R++}}}return k}function s(f,y,o,m,l,w,_){var h=y._length,b=f._fullLayout,u=o._id,L=m._id,T=b._firstScatter[p(y)]===y.uid,k=(v(y,b,o,m)||{}).orientation,P=y.fill;o._minDtick=0,m._minDtick=0;var z={padded:!0},I={padded:!0};_&&(z.ppad=I.ppad=_);var D=h<2||l[0]!==l[h-1]||w[0]!==w[h-1];D&&(P==="tozerox"||P==="tonextx"&&(T||k==="h"))?z.tozero=!0:!(y.error_y||{}).visible&&(P==="tonexty"||P==="tozeroy"||!a.hasMarkers(y)&&!a.hasText(y))&&(z.padded=!1,z.ppad=0),D&&(P==="tozeroy"||P==="tonexty"&&(T||k==="v"))?I.tozero=!0:(P==="tonextx"||P==="tozerox")&&(I.padded=!1),u&&(y._extremes[u]=S.findExtremes(o,l,z)),L&&(y._extremes[L]=S.findExtremes(m,w,I))}function i(f,y){if(!!a.hasMarkers(f)){var o=f.marker,m=1.6*(f.marker.sizeref||1),l;if(f.marker.sizemode==="area"?l=function(u){return Math.max(Math.sqrt((u||0)/m),3)}:l=function(u){return Math.max((u||0)/m,3)},g.isArrayOrTypedArray(o.size)){var w={type:"linear"};S.setConvert(w);for(var _=w.makeCalcdata(f.marker,"size"),h=new Array(y),b=0;b<y;b++)h[b]=l(_[b]);return h}else return l(o.size)}}function x(f,y){var o=p(y),m=f._firstScatter;m[o]||(m[o]=y.uid)}function p(f){var y=f.stackgroup;return f.xaxis+f.yaxis+f.type+(y?"-"+y:"")}function v(f,y,o,m){var l=f.stackgroup;if(!!l){var w=y._scatterStackOpts[o._id+m._id][l],_=w.orientation==="v"?m:o;if(_.type==="linear"||_.type==="log")return w}}ee.exports={calc:c,calcMarkerSize:i,calcAxisExpansion:s,setFirstScatter:x,getStackOpts:v}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"./arrays_to_calcdata":935,"./calc_selection":938,"./colorscale_calc":939,"./subtypes":961,"fast-isnumeric":190}],938:[function(d,ee,te){var A=d("../../lib");ee.exports=function(S,M){A.isArrayOrTypedArray(M.selectedpoints)&&A.tagSelected(S,M)}},{"../../lib":515}],939:[function(d,ee,te){var A=d("../../components/colorscale/helpers").hasColorscale,g=d("../../components/colorscale/calc"),S=d("./subtypes");ee.exports=function(e,a){S.hasLines(a)&&A(a,"line")&&g(e,a,{vals:a.line.color,containerStr:"line",cLetter:"c"}),S.hasMarkers(a)&&(A(a,"marker")&&g(e,a,{vals:a.marker.color,containerStr:"marker",cLetter:"c"}),A(a,"marker.line")&&g(e,a,{vals:a.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"./subtypes":961}],940:[function(d,ee,te){ee.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],941:[function(d,ee,te){var A=d("./calc");ee.exports=function(e,a){var n=a.xaxis,r=a.yaxis,t=n._id+r._id,c=e._fullLayout._scatterStackOpts[t];if(!!c){var s=e.calcdata,i,x,p,v,f,y,o,m,l,w,_,h,b,u,L;for(var T in c){w=c[T];var k=w.traceIndices;if(!!k.length){for(_=w.stackgaps==="interpolate",h=w.groupnorm,w.orientation==="v"?(b="x",u="y"):(b="y",u="x"),L=new Array(k.length),i=0;i<L.length;i++)L[i]=!1;y=s[k[0]];var P=new Array(y.length);for(i=0;i<y.length;i++)P[i]=y[i][b];for(i=1;i<k.length;i++){for(f=s[k[i]],x=p=0;x<f.length;x++){for(o=f[x][b];o>P[p]&&p<P.length;p++)g(f,x,P[p],i,L,_,b),x++;if(o!==P[p]){for(v=0;v<i;v++)g(s[k[v]],p,o,v,L,_,b);P.splice(p,0,o)}p++}for(;p<P.length;p++)g(f,x,P[p],i,L,_,b),x++}var z=P.length;for(x=0;x<y.length;x++){for(m=y[x][u]=y[x].s,i=1;i<k.length;i++)f=s[k[i]],f[0].trace._rawLength=f[0].trace._length,f[0].trace._length=z,m+=f[x].s,f[x][u]=m;if(h)for(l=(h==="fraction"?m:m/100)||1,i=0;i<k.length;i++){var I=s[k[i]][x];I[u]/=l,I.sNorm=I.s/l}}for(i=0;i<k.length;i++){f=s[k[i]];var D=f[0].trace,R=A.calcMarkerSize(D,D._rawLength),O=Array.isArray(R);if(R&&L[i]||O){var F=R;for(R=new Array(z),x=0;x<z;x++)R[x]=f[x].gap?0:O?F[f[x].i]:F}var N=new Array(z),G=new Array(z);for(x=0;x<z;x++)N[x]=f[x].x,G[x]=f[x].y;A.calcAxisExpansion(e,D,n,r,N,G,R),f[0].t.orientation=w.orientation}}}}};function g(M,e,a,n,r,t,c){r[n]=!0;var s={i:null,gap:!0,s:0};if(s[c]=a,M.splice(e,0,s),e&&a===M[e-1][c]){var i=M[e-1];s.s=i.s,s.i=i.i,s.gap=i.gap}else t&&(s.s=S(M,e,a,c));e||(M[0].t=M[1].t,M[0].trace=M[1].trace,delete M[1].t,delete M[1].trace)}function S(M,e,a,n){var r=M[e-1],t=M[e+1];return t?r?r.s+(t.s-r.s)*(a-r[n])/(t[n]-r[n]):t.s:r.s}},{"./calc":937}],942:[function(d,ee,te){ee.exports=function(g){for(var S=0;S<g.length;S++){var M=g[S];if(M.type==="scatter"){var e=M.fill;if(!(e==="none"||e==="toself")&&(M.opacity=void 0,e==="tonexty"||e==="tonextx"))for(var a=S-1;a>=0;a--){var n=g[a];if(n.type==="scatter"&&n.xaxis===M.xaxis&&n.yaxis===M.yaxis){n.opacity=void 0;break}}}}}},{}],943:[function(d,ee,te){var A=d("../../lib"),g=d("../../registry"),S=d("./attributes"),M=d("./constants"),e=d("./subtypes"),a=d("./xy_defaults"),n=d("./period_defaults"),r=d("./stack_defaults"),t=d("./marker_defaults"),c=d("./line_defaults"),s=d("./line_shape_defaults"),i=d("./text_defaults"),x=d("./fillcolor_defaults"),p=d("../../lib").coercePattern;ee.exports=function(f,y,o,m){function l(k,P){return A.coerce(f,y,S,k,P)}var w=a(f,y,m,l);if(w||(y.visible=!1),!!y.visible){n(f,y,m,l),l("xhoverformat"),l("yhoverformat");var _=r(f,y,m,l),h=!_&&w<M.PTS_LINESONLY?"lines+markers":"lines";l("text"),l("hovertext"),l("mode",h),e.hasLines(y)&&(c(f,y,o,m,l,{backoff:!0}),s(f,y,l),l("connectgaps"),l("line.simplify")),e.hasMarkers(y)&&t(f,y,o,m,l,{gradient:!0}),e.hasText(y)&&(l("texttemplate"),i(f,y,m,l));var b=[];(e.hasMarkers(y)||e.hasText(y))&&(l("cliponaxis"),l("marker.maxdisplayed"),b.push("points")),l("fill",_?_.fillDflt:"none"),y.fill!=="none"&&(x(f,y,o,l),e.hasLines(y)||s(f,y,l),p(l,"fillpattern",y.fillcolor,!1));var u=(y.line||{}).color,L=(y.marker||{}).color;(y.fill==="tonext"||y.fill==="toself")&&b.push("fills"),l("hoveron",b.join("+")||"points"),y.hoveron!=="fills"&&l("hovertemplate");var T=g.getComponentMethod("errorbars","supplyDefaults");T(f,y,u||L||o,{axis:"y"}),T(f,y,u||L||o,{axis:"x",inherit:"y"}),A.coerceSelectionMarkerOpacity(y,l)}}},{"../../lib":515,"../../registry":647,"./attributes":936,"./constants":940,"./fillcolor_defaults":944,"./line_defaults":949,"./line_shape_defaults":951,"./marker_defaults":955,"./period_defaults":956,"./stack_defaults":959,"./subtypes":961,"./text_defaults":962,"./xy_defaults":963}],944:[function(d,ee,te){var A=d("../../components/color"),g=d("../../lib").isArrayOrTypedArray;ee.exports=function(M,e,a,n){var r=!1;if(e.marker){var t=e.marker.color,c=(e.marker.line||{}).color;t&&!g(t)?r=t:c&&!g(c)&&(r=c)}n("fillcolor",A.addOpacity((e.line||{}).color||r||a,.5))}},{"../../components/color":367,"../../lib":515}],945:[function(d,ee,te){var A=d("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n={_fullLayout:e},r=A.getFromTrace(n,M,"x"),t=A.getFromTrace(n,M,"y");return a.xLabel=A.tickText(r,r.c2l(S.x),!0).text,a.yLabel=A.tickText(t,t.c2l(S.y),!0).text,a}},{"../../plots/cartesian/axes":566}],946:[function(d,ee,te){var A=d("../../components/color"),g=d("./subtypes");ee.exports=function(M,e){var a,n;if(M.mode==="lines")return a=M.line.color,a&&A.opacity(a)?a:M.fillcolor;if(M.mode==="none")return M.fill?M.fillcolor:"";var r=e.mcc||(M.marker||{}).color,t=e.mlcc||((M.marker||{}).line||{}).color;return n=r&&A.opacity(r)?r:t&&A.opacity(t)&&(e.mlw||((M.marker||{}).line||{}).width)?t:"",n?A.opacity(n)<.3?A.addOpacity(n,.3):n:(a=(M.line||{}).color,a&&A.opacity(a)&&g.hasLines(M)&&M.line.width?a:M.fillcolor)}},{"../../components/color":367,"./subtypes":961}],947:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/fx"),S=d("../../registry"),M=d("./get_trace_color"),e=d("../../components/color"),a=A.fillText;ee.exports=function(r,t,c,s){var i=r.cd,x=i[0].trace,p=r.xa,v=r.ya,f=p.c2p(t),y=v.c2p(c),o=[f,y],m=x.hoveron||"",l=x.mode.indexOf("markers")!==-1?3:.5,w=!!x.xperiodalignment,_=!!x.yperiodalignment;if(m.indexOf("points")!==-1){var h=function(ae){if(w){var oe=p.c2p(ae.xStart),be=p.c2p(ae.xEnd);return f>=Math.min(oe,be)&&f<=Math.max(oe,be)?0:1/0}var ce=Math.max(3,ae.mrc||0),de=1-1/ce,ye=Math.abs(p.c2p(ae.x)-f);return ye<ce?de*ye/ce:ye-ce+de},b=function(ae){if(_){var oe=v.c2p(ae.yStart),be=v.c2p(ae.yEnd);return y>=Math.min(oe,be)&&y<=Math.max(oe,be)?0:1/0}var ce=Math.max(3,ae.mrc||0),de=1-1/ce,ye=Math.abs(v.c2p(ae.y)-y);return ye<ce?de*ye/ce:ye-ce+de},u=function(ae){var oe=Math.max(l,ae.mrc||0),be=p.c2p(ae.x)-f,ce=v.c2p(ae.y)-y;return Math.max(Math.sqrt(be*be+ce*ce)-oe,1-l/oe)},L=g.getDistanceFunction(s,h,b,u);if(g.getClosest(i,L,r),r.index!==!1){var T=i[r.index],k=p.c2p(T.x,!0),P=v.c2p(T.y,!0),z=T.mrc||1;r.index=T.i;var I=i[0].t.orientation,D=I&&(T.sNorm||T.s),R=I==="h"?D:T.orig_x!==void 0?T.orig_x:T.x,O=I==="v"?D:T.orig_y!==void 0?T.orig_y:T.y;return A.extendFlat(r,{color:M(x,T),x0:k-z,x1:k+z,xLabelVal:R,y0:P-z,y1:P+z,yLabelVal:O,spikeDistance:u(T),hovertemplate:x.hovertemplate}),a(T,x,r),S.getComponentMethod("errorbars","hoverInfo")(T,x,r),[r]}}if(m.indexOf("fills")!==-1&&x._polygons){var F=x._polygons,N=[],G=!1,K=1/0,W=-1/0,Y=1/0,re=-1/0,ue,j,q,V,U,$,ne,X,Q;for(ue=0;ue<F.length;ue++)q=F[ue],q.contains(o)&&(G=!G,N.push(q),Y=Math.min(Y,q.ymin),re=Math.max(re,q.ymax));if(G){Y=Math.max(Y,0),re=Math.min(re,v._length);var ie=(Y+re)/2;for(ue=0;ue<N.length;ue++)for(V=N[ue].pts,j=1;j<V.length;j++)X=V[j-1][1],Q=V[j][1],X>ie!=Q>=ie&&($=V[j-1][0],ne=V[j][0],Q-X&&(U=$+(ne-$)*(ie-X)/(Q-X),K=Math.min(K,U),W=Math.max(W,U)));K=Math.max(K,0),W=Math.min(W,p._length);var se=e.defaultLine;return e.opacity(x.fillcolor)?se=x.fillcolor:e.opacity((x.line||{}).color)&&(se=x.line.color),A.extendFlat(r,{distance:r.maxHoverDistance,x0:K,x1:W,y0:ie,y1:ie,color:se,hovertemplate:!1}),delete r.index,x.text&&!Array.isArray(x.text)?r.text=String(x.text):r.text=x.name,[r]}}}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../registry":647,"./get_trace_color":946}],948:[function(d,ee,te){var A=d("./subtypes");ee.exports={hasLines:A.hasLines,hasMarkers:A.hasMarkers,hasText:A.hasText,isBubble:A.isBubble,attributes:d("./attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("./cross_trace_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./cross_trace_calc"),arraysToCalcdata:d("./arrays_to_calcdata"),plot:d("./plot"),colorbar:d("./marker_colorbar"),formatLabels:d("./format_labels"),style:d("./style").style,styleOnSelect:d("./style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./arrays_to_calcdata":935,"./attributes":936,"./calc":937,"./cross_trace_calc":941,"./cross_trace_defaults":942,"./defaults":943,"./format_labels":945,"./hover":947,"./marker_colorbar":954,"./plot":957,"./select":958,"./style":960,"./subtypes":961}],949:[function(d,ee,te){var A=d("../../lib").isArrayOrTypedArray,g=d("../../components/colorscale/helpers").hasColorscale,S=d("../../components/colorscale/defaults");ee.exports=function(e,a,n,r,t,c){c||(c={});var s=(e.marker||{}).color;if(t("line.color",n),g(e,"line"))S(e,a,r,t,{prefix:"line.",cLetter:"c"});else{var i=(A(s)?!1:s)||n;t("line.color",i)}t("line.width"),c.noDash||t("line.dash"),c.backoff&&t("line.backoff")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],950:[function(d,ee,te){var A=d("../../components/drawing"),g=d("../../constants/numerical"),S=g.BADNUM,M=g.LOG_CLIP,e=M+.5,a=M-.5,n=d("../../lib"),r=n.segmentsIntersect,t=n.constrain,c=d("./constants");ee.exports=function(i,x){var p=x.trace||{},v=x.xaxis,f=x.yaxis,y=v.type==="log",o=f.type==="log",m=v._length,l=f._length,w=x.backoff,_=p.marker,h=x.connectGaps,b=x.baseTolerance,u=x.shape,L=u==="linear",T=p.fill&&p.fill!=="none",k=[],P=c.minTolerance,z=i.length,I=new Array(z),D=0,R,O,F,N,G,K,W,Y,re,ue,j,q,V,U,$,ne;function X(wt){var Ut=i[wt];if(!Ut)return!1;var Dt=x.linearized?v.l2p(Ut.x):v.c2p(Ut.x),Nt=x.linearized?f.l2p(Ut.y):f.c2p(Ut.y);if(Dt===S){if(y&&(Dt=v.c2p(Ut.x,!0)),Dt===S)return!1;o&&Nt===S&&(Dt*=Math.abs(v._m*l*(v._m>0?e:a)/(f._m*m*(f._m>0?e:a)))),Dt*=1e3}if(Nt===S){if(o&&(Nt=f.c2p(Ut.y,!0)),Nt===S)return!1;Nt*=1e3}return[Dt,Nt]}function Q(wt,Ut,Dt,Nt){var Xt=Dt-wt,Ht=Nt-Ut,ar=.5-wt,Vr=.5-Ut,nn=Xt*Xt+Ht*Ht,jr=Xt*ar+Ht*Vr;if(jr>0&&jr<nn){var at=ar*Ht-Vr*Xt;if(at*at<nn)return!0}}var ie,se;function ae(wt,Ut){var Dt=wt[0]/m,Nt=wt[1]/l,Xt=Math.max(0,-Dt,Dt-1,-Nt,Nt-1);return Xt&&ie!==void 0&&Q(Dt,Nt,ie,se)&&(Xt=0),Xt&&Ut&&Q(Dt,Nt,Ut[0]/m,Ut[1]/l)&&(Xt=0),(1+c.toleranceGrowth*Xt)*b}function oe(wt,Ut){var Dt=wt[0]-Ut[0],Nt=wt[1]-Ut[1];return Math.sqrt(Dt*Dt+Nt*Nt)}var be=c.maxScreensAway,ce=-m*be,de=m*(1+be),ye=-l*be,ge=l*(1+be),me=[[ce,ye,de,ye],[de,ye,de,ge],[de,ge,ce,ge],[ce,ge,ce,ye]],Ee,Pe,Ne,we,ke,Xe;function He(wt,Ut){for(var Dt=[],Nt=0,Xt=0;Xt<4;Xt++){var Ht=me[Xt],ar=r(wt[0],wt[1],Ut[0],Ut[1],Ht[0],Ht[1],Ht[2],Ht[3]);ar&&(!Nt||Math.abs(ar.x-Dt[0][0])>1||Math.abs(ar.y-Dt[0][1])>1)&&(ar=[ar.x,ar.y],Nt&&oe(ar,wt)<oe(Dt[0],wt)?Dt.unshift(ar):Dt.push(ar),Nt++)}return Dt}function Ie(wt){if(wt[0]<ce||wt[0]>de||wt[1]<ye||wt[1]>ge)return[t(wt[0],ce,de),t(wt[1],ye,ge)]}function De(wt,Ut){if(wt[0]===Ut[0]&&(wt[0]===ce||wt[0]===de)||wt[1]===Ut[1]&&(wt[1]===ye||wt[1]===ge))return!0}function Ge(wt,Ut){var Dt=[],Nt=Ie(wt),Xt=Ie(Ut);return Nt&&Xt&&De(Nt,Xt)||(Nt&&Dt.push(Nt),Xt&&Dt.push(Xt)),Dt}function ht(wt,Ut,Dt){return function(Nt,Xt){var Ht=Ie(Nt),ar=Ie(Xt),Vr=[];if(Ht&&ar&&De(Ht,ar))return Vr;Ht&&Vr.push(Ht),ar&&Vr.push(ar);var nn=2*n.constrain((Nt[wt]+Xt[wt])/2,Ut,Dt)-((Ht||Nt)[wt]+(ar||Xt)[wt]);if(nn){var jr;Ht&&ar?jr=nn>0==Ht[wt]>ar[wt]?Ht:ar:jr=Ht||ar,jr[wt]+=nn}return Vr}}var Rt;u==="linear"||u==="spline"?Rt=He:u==="hv"||u==="vh"?Rt=Ge:u==="hvh"?Rt=ht(0,ce,de):u==="vhv"&&(Rt=ht(1,ye,ge));function Kt(wt,Ut){var Dt=Ut[0]-wt[0],Nt=(Ut[1]-wt[1])/Dt,Xt=(wt[1]*Ut[0]-Ut[1]*wt[0])/Dt;return Xt>0?[Nt>0?ce:de,ge]:[Nt>0?de:ce,ye]}function It(wt){var Ut=wt[0],Dt=wt[1],Nt=Ut===I[D-1][0],Xt=Dt===I[D-1][1];if(!(Nt&&Xt))if(D>1){var Ht=Ut===I[D-2][0],ar=Dt===I[D-2][1];Nt&&(Ut===ce||Ut===de)&&Ht?ar?D--:I[D-1]=wt:Xt&&(Dt===ye||Dt===ge)&&ar?Ht?D--:I[D-1]=wt:I[D++]=wt}else I[D++]=wt}function Mt(wt){I[D-1][0]!==wt[0]&&I[D-1][1]!==wt[1]&&It([Ne,we]),It(wt),ke=null,Ne=we=0}var Yt=n.isArrayOrTypedArray(_);function zt(wt){if(wt&&w&&(wt.i=R,wt.d=i,wt.trace=p,wt.marker=Yt?_[wt.i]:_,wt.backoff=w),ie=wt[0]/m,se=wt[1]/l,Ee=wt[0]<ce?ce:wt[0]>de?de:0,Pe=wt[1]<ye?ye:wt[1]>ge?ge:0,Ee||Pe){if(!D)I[D++]=[Ee||wt[0],Pe||wt[1]];else if(ke){var Ut=Rt(ke,wt);Ut.length>1&&(Mt(Ut[0]),I[D++]=Ut[1])}else Xe=Rt(I[D-1],wt)[0],I[D++]=Xe;var Dt=I[D-1];Ee&&Pe&&(Dt[0]!==Ee||Dt[1]!==Pe)?(ke&&(Ne!==Ee&&we!==Pe?It(Ne&&we?Kt(ke,wt):[Ne||Ee,we||Pe]):Ne&&we&&It([Ne,we])),It([Ee,Pe])):Ne-Ee&&we-Pe&&It([Ee||Ne,Pe||we]),ke=wt,Ne=Ee,we=Pe}else ke&&Mt(Rt(ke,wt)[0]),I[D++]=wt}for(R=0;R<z;R++)if(O=X(R),!!O){for(D=0,ke=null,zt(O),R++;R<z;R++){if(N=X(R),!N){if(h)continue;break}if(!L||!x.simplify){zt(N);continue}var St=X(R+1);if(ue=oe(N,O),!(!(T&&(D===0||D===z-1))&&ue<ae(N,St)*P)){for(Y=[(N[0]-O[0])/ue,(N[1]-O[1])/ue],G=O,j=ue,q=U=$=0,W=!1,F=N,R++;R<i.length;R++){if(K=St,St=X(R+1),!K){if(h)continue;break}if(re=[K[0]-O[0],K[1]-O[1]],ne=re[0]*Y[1]-re[1]*Y[0],U=Math.min(U,ne),$=Math.max($,ne),$-U>ae(K,St))break;F=K,V=re[0]*Y[0]+re[1]*Y[1],V>j?(j=V,N=K,W=!1):V<q&&(q=V,G=K,W=!0)}if(W?(zt(N),F!==G&&zt(G)):(G!==O&&zt(G),F!==N&&zt(N)),zt(F),R>=i.length||!K)break;zt(K),O=K}}ke&&It([Ne||ke[0],we||ke[1]]),k.push(I.slice(0,D))}var Ye=u.slice(u.length-1);if(w&&Ye!=="h"&&Ye!=="v"){for(var rt=!1,Ve=-1,Ae=[],Ue=0;Ue<k.length;Ue++)for(var Ze=0;Ze<k[Ue].length-1;Ze++){var Qe=k[Ue][Ze],_t=k[Ue][Ze+1],gt=A.applyBackoff(_t,Qe);(gt[0]!==_t[0]||gt[1]!==_t[1])&&(rt=!0),Ae[Ve+1]||(Ve++,Ae[Ve]=[Qe,[gt[0],gt[1]]])}return rt?Ae:k}return k}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"./constants":940}],951:[function(d,ee,te){ee.exports=function(g,S,M){var e=M("line.shape");e==="spline"&&M("line.smoothing")}},{}],952:[function(d,ee,te){var A={tonextx:1,tonexty:1,tonext:1};ee.exports=function(S,M,e){var a,n,r,t,c,s={},i=!1,x=-1,p=0,v=-1;for(n=0;n<e.length;n++)a=e[n][0].trace,r=a.stackgroup||"",r?r in s?c=s[r]:(c=s[r]=p,p++):a.fill in A&&v>=0?c=v:(c=v=p,p++),c<x&&(i=!0),a._groupIndex=x=c;var f=e.slice();i&&f.sort(function(o,m){var l=o[0].trace,w=m[0].trace;return l._groupIndex-w._groupIndex||l.index-w.index});var y={};for(n=0;n<f.length;n++)a=f[n][0].trace,r=a.stackgroup||"",a.visible===!0?(a._nexttrace=null,a.fill in A&&(t=y[r],a._prevtrace=t||null,t&&(t._nexttrace=a)),a._ownfill=a.fill&&(a.fill.substr(0,6)==="tozero"||a.fill==="toself"||a.fill.substr(0,2)==="to"&&!a._prevtrace),y[r]=a):a._prevtrace=a._nexttrace=a._ownfill=null;return f}},{}],953:[function(d,ee,te){var A=d("fast-isnumeric");ee.exports=function(S,M){M||(M=2);var e=S.marker,a=e.sizeref||1,n=e.sizemin||0,r=e.sizemode==="area"?function(t){return Math.sqrt(t/a)}:function(t){return t/a};return function(t){var c=r(t/M);return A(c)&&c>0?Math.max(c,n):0}}},{"fast-isnumeric":190}],954:[function(d,ee,te){ee.exports={container:"marker",min:"cmin",max:"cmax"}},{}],955:[function(d,ee,te){var A=d("../../components/color"),g=d("../../components/colorscale/helpers").hasColorscale,S=d("../../components/colorscale/defaults"),M=d("./subtypes");ee.exports=function(a,n,r,t,c,s){var i=M.isBubble(a),x=(a.line||{}).color,p;if(s=s||{},x&&(r=x),c("marker.symbol"),c("marker.opacity",i?.7:1),c("marker.size"),s.noAngle||(c("marker.angle"),s.noAngleRef||c("marker.angleref"),s.noStandOff||c("marker.standoff")),c("marker.color",r),g(a,"marker")&&S(a,n,t,c,{prefix:"marker.",cLetter:"c"}),s.noSelect||(c("selected.marker.color"),c("unselected.marker.color"),c("selected.marker.size"),c("unselected.marker.size")),s.noLine||(x&&!Array.isArray(x)&&n.marker.color!==x?p=x:i?p=A.background:p=A.defaultLine,c("marker.line.color",p),g(a,"marker.line")&&S(a,n,t,c,{prefix:"marker.line.",cLetter:"c"}),c("marker.line.width",i?1:0)),i&&(c("marker.sizeref"),c("marker.sizemin"),c("marker.sizemode")),s.gradient){var v=c("marker.gradient.type");v!=="none"&&c("marker.gradient.color")}}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"./subtypes":961}],956:[function(d,ee,te){var A=d("../../lib").dateTick0,g=d("../../constants/numerical"),S=g.ONEWEEK;function M(e,a){return e%S===0?A(a,1):A(a,0)}ee.exports=function(a,n,r,t,c){if(c||(c={x:!0,y:!0}),c.x){var s=t("xperiod");s&&(t("xperiod0",M(s,n.xcalendar)),t("xperiodalignment"))}if(c.y){var i=t("yperiod");i&&(t("yperiod0",M(i,n.ycalendar)),t("yperiodalignment"))}}},{"../../constants/numerical":491,"../../lib":515}],957:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../registry"),S=d("../../lib"),M=S.ensureSingle,e=S.identity,a=d("../../components/drawing"),n=d("./subtypes"),r=d("./line_points"),t=d("./link_traces"),c=d("../../lib/polygon").tester;ee.exports=function(v,f,y,o,m,l){var w,_,h=!m,b=!!m&&m.duration>0,u=t(v,f,y);if(w=o.selectAll("g.trace").data(u,function(T){return T[0].trace.uid}),w.enter().append("g").attr("class",function(T){return"trace scatter trace"+T[0].trace.uid}).style("stroke-miterlimit",2),w.order(),s(v,w,f),b){l&&(_=l());var L=A.transition().duration(m.duration).ease(m.easing).each("end",function(){_&&_()}).each("interrupt",function(){_&&_()});L.each(function(){o.selectAll("g.trace").each(function(T,k){i(v,k,f,T,u,this,m)})})}else w.each(function(T,k){i(v,k,f,T,u,this,m)});h&&w.exit().remove(),o.selectAll("path:not([d])").remove()};function s(p,v,f){v.each(function(y){var o=M(A.select(this),"g","fills");a.setClipUrl(o,f.layerClipId,p);var m=y[0].trace,l=[];m._ownfill&&l.push("_ownFill"),m._nexttrace&&l.push("_nextFill");var w=o.selectAll("g").data(l,e);w.enter().append("g"),w.exit().each(function(_){m[_]=null}).remove(),w.order().each(function(_){m[_]=M(A.select(this),"path","js-fill")})})}function i(p,v,f,y,o,m,l){var w;x(p,v,f,y,o);var _=!!l&&l.duration>0;function h(Ne){return _?Ne.transition():Ne}var b=f.xaxis,u=f.yaxis,L=y[0].trace,T=L.line,k=A.select(m),P=M(k,"g","errorbars"),z=M(k,"g","lines"),I=M(k,"g","points"),D=M(k,"g","text");if(g.getComponentMethod("errorbars","plot")(p,P,f,l),L.visible!==!0)return;h(k).style("opacity",L.opacity);var R,O,F=L.fill.charAt(L.fill.length-1);F!=="x"&&F!=="y"&&(F=""),y[0][f.isRangePlot?"nodeRangePlot3":"node3"]=k;var N="",G=[],K=L._prevtrace;K&&(N=K._prevRevpath||"",O=K._nextFill,G=K._polygons);var W,Y,re="",ue="",j,q,V,U,$,ne,X,Q=[],ie=S.noop;if(R=L._ownFill,n.hasLines(L)||L.fill!=="none"){for(O&&O.datum(y),["hv","vh","hvh","vhv"].indexOf(T.shape)!==-1?(j=a.steps(T.shape),q=a.steps(T.shape.split("").reverse().join(""))):T.shape==="spline"?j=q=function(Ne){var we=Ne[Ne.length-1];return Ne.length>1&&Ne[0][0]===we[0]&&Ne[0][1]===we[1]?a.smoothclosed(Ne.slice(1),T.smoothing):a.smoothopen(Ne,T.smoothing)}:j=q=function(Ne){return"M"+Ne.join("L")},V=function(Ne){return q(Ne.reverse())},Q=r(y,{xaxis:b,yaxis:u,trace:L,connectGaps:L.connectgaps,baseTolerance:Math.max(T.width||1,3)/4,shape:T.shape,backoff:T.backoff,simplify:T.simplify,fill:L.fill}),X=L._polygons=new Array(Q.length),w=0;w<Q.length;w++)L._polygons[w]=c(Q[w]);Q.length&&(U=Q[0][0],$=Q[Q.length-1],ne=$[$.length-1]),ie=function(Ne){return function(we){if(W=j(we),Y=V(we),re?F?(re+="L"+W.substr(1),ue=Y+("L"+ue.substr(1))):(re+="Z"+W,ue=Y+"Z"+ue):(re=W,ue=Y),n.hasLines(L)&&we.length>1){var ke=A.select(this);if(ke.datum(y),Ne)h(ke.style("opacity",0).attr("d",W).call(a.lineGroupStyle)).style("opacity",1);else{var Xe=h(ke);Xe.attr("d",W),a.singleLineStyle(y,Xe)}}}}}var se=z.selectAll(".js-line").data(Q);h(se.exit()).style("opacity",0).remove(),se.each(ie(!1)),se.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(a.lineGroupStyle).each(ie(!0)),a.setClipUrl(se,f.layerClipId,p);function ae(Ne){h(Ne).attr("d","M0,0Z")}Q.length?(R?(R.datum(y),U&&ne&&(F?(F==="y"?U[1]=ne[1]=u.c2p(0,!0):F==="x"&&(U[0]=ne[0]=b.c2p(0,!0)),h(R).attr("d","M"+ne+"L"+U+"L"+re.substr(1)).call(a.singleFillStyle,p)):h(R).attr("d",re+"Z").call(a.singleFillStyle,p))):O&&(L.fill.substr(0,6)==="tonext"&&re&&N?(L.fill==="tonext"?h(O).attr("d",re+"Z"+N+"Z").call(a.singleFillStyle,p):h(O).attr("d",re+"L"+N.substr(1)+"Z").call(a.singleFillStyle,p),L._polygons=L._polygons.concat(G)):(ae(O),L._polygons=null)),L._prevRevpath=ue,L._prevPolygons=X):(R?ae(R):O&&ae(O),L._polygons=L._prevRevpath=L._prevPolygons=null);function oe(Ne){return Ne.filter(function(we){return!we.gap&&we.vis})}function be(Ne){return Ne.filter(function(we){return we.vis})}function ce(Ne){return Ne.filter(function(we){return!we.gap})}function de(Ne){return Ne.id}function ye(Ne){if(Ne.ids)return de}function ge(){return!1}function me(Ne,we,ke){var Xe,He,Ie,De=ke[0].trace,Ge=n.hasMarkers(De),ht=n.hasText(De),Rt=ye(De),Kt=ge,It=ge;if(Ge||ht){var Mt=e,Yt=De.stackgroup,zt=Yt&&p._fullLayout._scatterStackOpts[b._id+u._id][Yt].stackgaps==="infer zero";De.marker.maxdisplayed||De._needsCull?Mt=zt?be:oe:Yt&&!zt&&(Mt=ce),Ge&&(Kt=Mt),ht&&(It=Mt)}He=Ne.selectAll("path.point"),Xe=He.data(Kt,Rt);var St=Xe.enter().append("path").classed("point",!0);_&&St.call(a.pointStyle,De,p).call(a.translatePoints,b,u).style("opacity",0).transition().style("opacity",1),Xe.order();var Ye;Ge&&(Ye=a.makePointStyleFns(De)),Xe.each(function(rt){var Ve=A.select(this),Ae=h(Ve);Ie=a.translatePoint(rt,Ae,b,u),Ie?(a.singlePointStyle(rt,Ae,De,Ye,p),f.layerClipId&&a.hideOutsideRangePoint(rt,Ae,b,u,De.xcalendar,De.ycalendar),De.customdata&&Ve.classed("plotly-customdata",rt.data!==null&&rt.data!==void 0)):Ae.remove()}),_?Xe.exit().transition().style("opacity",0).remove():Xe.exit().remove(),He=we.selectAll("g"),Xe=He.data(It,Rt),Xe.enter().append("g").classed("textpoint",!0).append("text"),Xe.order(),Xe.each(function(rt){var Ve=A.select(this),Ae=h(Ve.select("text"));Ie=a.translatePoint(rt,Ae,b,u),Ie?f.layerClipId&&a.hideOutsideRangePoint(rt,Ve,b,u,De.xcalendar,De.ycalendar):Ve.remove()}),Xe.selectAll("text").call(a.textPointStyle,De,p).each(function(rt){var Ve=b.c2p(rt.x),Ae=u.c2p(rt.y);A.select(this).selectAll("tspan.line").each(function(){h(A.select(this)).attr({x:Ve,y:Ae})})}),Xe.exit().remove()}I.datum(y),D.datum(y),me(I,D,y);var Ee=L.cliponaxis===!1,Pe=Ee?null:f.layerClipId;a.setClipUrl(I,Pe,p),a.setClipUrl(D,Pe,p)}function x(p,v,f,y,o){var m=f.xaxis,l=f.yaxis,w=A.extent(S.simpleMap(m.range,m.r2c)),_=A.extent(S.simpleMap(l.range,l.r2c)),h=y[0].trace;if(!!n.hasMarkers(h)){var b=h.marker.maxdisplayed;if(b!==0){var u=y.filter(function(P){return P.x>=w[0]&&P.x<=w[1]&&P.y>=_[0]&&P.y<=_[1]}),L=Math.ceil(u.length/b),T=0;o.forEach(function(P,z){var I=P[0].trace;n.hasMarkers(I)&&I.marker.maxdisplayed>0&&z<v&&T++});var k=Math.round(T*L/3+Math.floor(T/3)*L/7.1);y.forEach(function(P){delete P.vis}),u.forEach(function(P,z){Math.round((z+k)%L)===0&&(P.vis=!0)})}}}},{"../../components/drawing":389,"../../lib":515,"../../lib/polygon":527,"../../registry":647,"./line_points":950,"./link_traces":952,"./subtypes":961,"@plotly/d3":58}],958:[function(d,ee,te){var A=d("./subtypes");ee.exports=function(S,M){var e=S.cd,a=S.xaxis,n=S.yaxis,r=[],t=e[0].trace,c,s,i,x,p=!A.hasMarkers(t)&&!A.hasText(t);if(p)return[];if(M===!1)for(c=0;c<e.length;c++)e[c].selected=0;else for(c=0;c<e.length;c++)s=e[c],i=a.c2p(s.x),x=n.c2p(s.y),s.i!==null&&M.contains([i,x],!1,c,S)?(r.push({pointNumber:s.i,x:a.c2d(s.x),y:n.c2d(s.y)}),s.selected=1):s.selected=0;return r}},{"./subtypes":961}],959:[function(d,ee,te){var A=["orientation","groupnorm","stackgaps"];ee.exports=function(S,M,e,a){var n=e._scatterStackOpts,r=a("stackgroup");if(r){var t=M.xaxis+M.yaxis,c=n[t];c||(c=n[t]={});var s=c[r],i=!1;s?s.traces.push(M):(s=c[r]={traceIndices:[],traces:[M]},i=!0);for(var x={orientation:M.x&&!M.y?"h":"v"},p=0;p<A.length;p++){var v=A[p],f=v+"Found";if(!s[f]){var y=S[v]!==void 0,o=v==="orientation";if((y||i)&&(s[v]=a(v,x[v]),o&&(s.fillDflt=s[v]==="h"?"tonextx":"tonexty"),y&&(s[f]=!0,!i&&(delete s.traces[0][v],o))))for(var m=0;m<s.traces.length-1;m++){var l=s.traces[m];l._input.fill!==l.fill&&(l.fill=s.fillDflt)}}}return s}}},{}],960:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/drawing"),S=d("../../registry");function M(r){var t=A.select(r).selectAll("g.trace.scatter");t.style("opacity",function(c){return c[0].trace.opacity}),t.selectAll("g.points").each(function(c){var s=A.select(this),i=c.trace||c[0].trace;e(s,i,r)}),t.selectAll("g.text").each(function(c){var s=A.select(this),i=c.trace||c[0].trace;a(s,i,r)}),t.selectAll("g.trace path.js-line").call(g.lineGroupStyle),t.selectAll("g.trace path.js-fill").call(g.fillGroupStyle,r),S.getComponentMethod("errorbars","style")(t)}function e(r,t,c){g.pointStyle(r.selectAll("path.point"),t,c)}function a(r,t,c){g.textPointStyle(r.selectAll("text"),t,c)}function n(r,t,c){var s=t[0].trace;s.selectedpoints?(g.selectedPointStyle(c.selectAll("path.point"),s),g.selectedTextStyle(c.selectAll("text"),s)):(e(c,s,r),a(c,s,r))}ee.exports={style:M,stylePoints:e,styleText:a,styleOnSelect:n}},{"../../components/drawing":389,"../../registry":647,"@plotly/d3":58}],961:[function(d,ee,te){var A=d("../../lib");ee.exports={hasLines:function(g){return g.visible&&g.mode&&g.mode.indexOf("lines")!==-1},hasMarkers:function(g){return g.visible&&(g.mode&&g.mode.indexOf("markers")!==-1||g.type==="splom")},hasText:function(g){return g.visible&&g.mode&&g.mode.indexOf("text")!==-1},isBubble:function(g){return A.isPlainObject(g.marker)&&A.isArrayOrTypedArray(g.marker.size)}}},{"../../lib":515}],962:[function(d,ee,te){var A=d("../../lib");ee.exports=function(g,S,M,e,a){a=a||{},e("textposition"),A.coerceFont(e,"textfont",M.font),a.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":515}],963:[function(d,ee,te){var A=d("../../lib"),g=d("../../registry");ee.exports=function(M,e,a,n){var r=n("x"),t=n("y"),c,s=g.getComponentMethod("calendars","handleTraceDefaults");if(s(M,e,["x","y"],a),r){var i=A.minRowLength(r);t?c=Math.min(i,A.minRowLength(t)):(c=i,n("y0"),n("dy"))}else{if(!t)return 0;c=A.minRowLength(t),n("x0"),n("dx")}return e._length=c,c}},{"../../lib":515,"../../registry":647}],964:[function(d,ee,te){var A=d("../scatter/attributes"),g=d("../../components/colorscale/attributes"),S=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../plots/template_attributes").hovertemplateAttrs,e=d("../../plots/template_attributes").texttemplateAttrs,a=d("../../plots/attributes"),n=d("../../constants/gl3d_dashes"),r=d("../../constants/gl3d_markers"),t=d("../../lib/extend").extendFlat,c=d("../../plot_api/edit_types").overrideAll,s=d("../../lib/sort_object_keys"),i=A.line,x=A.marker,p=x.line,v=t({width:i.width,dash:{valType:"enumerated",values:s(n),dflt:"solid"}},g("line"));function f(o){return{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var y=ee.exports=c({x:A.x,y:A.y,z:{valType:"data_array"},text:t({},A.text,{}),texttemplate:e({},{}),hovertext:t({},A.hovertext,{}),hovertemplate:M(),xhoverformat:S("x"),yhoverformat:S("y"),zhoverformat:S("z"),mode:t({},A.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:f(),y:f(),z:f()},connectgaps:A.connectgaps,line:v,marker:t({symbol:{valType:"enumerated",values:s(r),dflt:"circle",arrayOk:!0},size:t({},x.size,{dflt:8}),sizeref:x.sizeref,sizemin:x.sizemin,sizemode:x.sizemode,opacity:t({},x.opacity,{arrayOk:!1}),colorbar:x.colorbar,line:t({width:t({},p.width,{arrayOk:!1})},g("marker.line"))},g("marker")),textposition:t({},A.textposition,{dflt:"top center"}),textfont:{color:A.textfont.color,size:A.textfont.size,family:t({},A.textfont.family,{arrayOk:!1})},opacity:a.opacity,hoverinfo:t({},a.hoverinfo)},"calc","nested");y.x.editType=y.y.editType=y.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":374,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../scatter/attributes":936}],965:[function(d,ee,te){var A=d("../scatter/arrays_to_calcdata"),g=d("../scatter/colorscale_calc");ee.exports=function(M,e){var a=[{x:!1,y:!1,trace:e,t:{}}];return A(a,e),g(M,e),a}},{"../scatter/arrays_to_calcdata":935,"../scatter/colorscale_calc":939}],966:[function(d,ee,te){var A=d("../../registry");function g(e,a,n,r){if(!a||!a.visible)return null;for(var t=A.getComponentMethod("errorbars","makeComputeError")(a),c=new Array(e.length),s=0;s<e.length;s++){var i=t(+e[s],s);if(r.type==="log"){var x=r.c2l(e[s]),p=e[s]-i[0],v=e[s]+i[1];if(c[s]=[(r.c2l(p,!0)-x)*n,(r.c2l(v,!0)-x)*n],p>0){var f=r.c2l(p);r._lowerLogErrorBound||(r._lowerLogErrorBound=f),r._lowerErrorBound=Math.min(r._lowerLogErrorBound,f)}}else c[s]=[-i[0]*n,i[1]*n]}return c}function S(e){for(var a=0;a<e.length;a++)if(e[a])return e[a].length;return 0}function M(e,a,n){var r=[g(e.x,e.error_x,a[0],n.xaxis),g(e.y,e.error_y,a[1],n.yaxis),g(e.z,e.error_z,a[2],n.zaxis)],t=S(r);if(t===0)return null;for(var c=new Array(t),s=0;s<t;s++){for(var i=[[0,0,0],[0,0,0]],x=0;x<3;x++)if(r[x])for(var p=0;p<2;p++)i[p][x]=r[x][s][p];c[s]=i}return c}ee.exports=M},{"../../registry":647}],967:[function(d,ee,te){var A=d("../../../stackgl_modules").gl_line3d,g=d("../../../stackgl_modules").gl_scatter3d,S=d("../../../stackgl_modules").gl_error3d,M=d("../../../stackgl_modules").gl_mesh3d,e=d("../../../stackgl_modules").delaunay_triangulate,a=d("../../lib"),n=d("../../lib/str2rgbarray"),r=d("../../lib/gl_format_color").formatColor,t=d("../scatter/make_bubble_size_func"),c=d("../../constants/gl3d_dashes"),s=d("../../constants/gl3d_markers"),i=d("../../plots/cartesian/axes"),x=d("../../components/fx/helpers").appendArrayPointValue,p=d("./calc_errors");function v(P,z){this.scene=P,this.uid=z,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var f=v.prototype;f.handlePick=function(P){if(P.object&&(P.object===this.linePlot||P.object===this.delaunayMesh||P.object===this.textMarkers||P.object===this.scatterPlot)){var z=P.index=P.data.index;return P.object.highlight&&P.object.highlight(null),this.scatterPlot&&(P.object=this.scatterPlot,this.scatterPlot.highlight(P.data)),P.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[z]||this.textLabels[z]===0)&&(P.textLabel=this.textLabels[z]):P.textLabel=this.textLabels),P.traceCoordinate=[this.data.x[z],this.data.y[z],this.data.z[z]],!0}};function y(P,z,I){var D=(I+1)%3,R=(I+2)%3,O=[],F=[],N;for(N=0;N<P.length;++N){var G=P[N];isNaN(G[D])||!isFinite(G[D])||isNaN(G[R])||!isFinite(G[R])||(O.push([G[D],G[R]]),F.push(N))}var K=e(O);for(N=0;N<K.length;++N)for(var W=K[N],Y=0;Y<W.length;++Y)W[Y]=F[W[Y]];return{positions:P,cells:K,meshColor:z}}function o(P){for(var z=[0,0,0],I=[[0,0,0],[0,0,0],[0,0,0]],D=[1,1,1],R=0;R<3;R++){var O=P[R];O&&O.copy_zstyle!==!1&&P[2].visible!==!1&&(O=P[2]),!(!O||!O.visible)&&(z[R]=O.width/2,I[R]=n(O.color),D[R]=O.thickness)}return{capSize:z,color:I,lineWidth:D}}function m(P){return P==null?0:P.indexOf("left")>-1?-1:P.indexOf("right")>-1?1:0}function l(P){return P==null?0:P.indexOf("top")>-1?-1:P.indexOf("bottom")>-1?1:0}function w(P){var z=0,I=0,D=[z,I];if(Array.isArray(P))for(var R=0;R<P.length;R++)D[R]=[z,I],P[R]&&(D[R][0]=m(P[R]),D[R][1]=l(P[R]));else D[0]=m(P),D[1]=l(P);return D}function _(P,z){return z(P*4)}function h(P){return s[P]}function b(P,z,I,D,R){var O=null;if(a.isArrayOrTypedArray(P)){O=[];for(var F=0;F<z;F++)P[F]===void 0?O[F]=D:O[F]=I(P[F],R)}else O=I(P,a.identity);return O}function u(P,z){var I=[],D=P.fullSceneLayout,R=P.dataScale,O=D.xaxis,F=D.yaxis,N=D.zaxis,G=z.marker,K=z.line,W=z.x||[],Y=z.y||[],re=z.z||[],ue=W.length,j=z.xcalendar,q=z.ycalendar,V=z.zcalendar,U,$,ne,X,Q,ie;for(Q=0;Q<ue;Q++)U=O.d2l(W[Q],0,j)*R[0],$=F.d2l(Y[Q],0,q)*R[1],ne=N.d2l(re[Q],0,V)*R[2],I[Q]=[U,$,ne];if(Array.isArray(z.text))ie=z.text;else if(z.text!==void 0)for(ie=new Array(ue),Q=0;Q<ue;Q++)ie[Q]=z.text;function se(He,Ie){var De=D[He];return i.tickText(De,De.d2l(Ie),!0).text}var ae=z.texttemplate;if(ae){var oe=P.fullLayout,be=oe._d3locale,ce=Array.isArray(ae),de=ce?Math.min(ae.length,ue):ue,ye=ce?function(He){return ae[He]}:function(){return ae};for(ie=new Array(de),Q=0;Q<de;Q++){var ge={x:W[Q],y:Y[Q],z:re[Q]},me={xLabel:se("xaxis",W[Q]),yLabel:se("yaxis",Y[Q]),zLabel:se("zaxis",re[Q])},Ee={};x(Ee,z,Q);var Pe=z._meta||{};ie[Q]=a.texttemplateString(ye(Q),me,be,Ee,ge,Pe)}}if(X={position:I,mode:z.mode,text:ie},"line"in z&&(X.lineColor=r(K,1,ue),X.lineWidth=K.width,X.lineDashes=K.dash),"marker"in z){var Ne=t(z);X.scatterColor=r(G,1,ue),X.scatterSize=b(G.size,ue,_,20,Ne),X.scatterMarker=b(G.symbol,ue,h,"\u25CF"),X.scatterLineWidth=G.line.width,X.scatterLineColor=r(G.line,1,ue),X.scatterAngle=0}"textposition"in z&&(X.textOffset=w(z.textposition),X.textColor=r(z.textfont,1,ue),X.textSize=b(z.textfont.size,ue,a.identity,12),X.textFont=z.textfont.family,X.textAngle=0);var we=["x","y","z"];for(X.project=[!1,!1,!1],X.projectScale=[1,1,1],X.projectOpacity=[1,1,1],Q=0;Q<3;++Q){var ke=z.projection[we[Q]];(X.project[Q]=ke.show)&&(X.projectOpacity[Q]=ke.opacity,X.projectScale[Q]=ke.scale)}X.errorBounds=p(z,R,D);var Xe=o([z.error_x,z.error_y,z.error_z]);return X.errorColor=Xe.color,X.errorLineWidth=Xe.lineWidth,X.errorCapSize=Xe.capSize,X.delaunayAxis=z.surfaceaxis,X.delaunayColor=n(z.surfacecolor),X}function L(P){if(a.isArrayOrTypedArray(P)){var z=P[0];return a.isArrayOrTypedArray(z)&&(P=z),"rgb("+P.slice(0,3).map(function(I){return Math.round(I*255)})+")"}return null}function T(P){return a.isArrayOrTypedArray(P)?P.length===4&&typeof P[0]=="number"?L(P):P.map(L):null}f.update=function(P){var z=this.scene.glplot.gl,I,D,R,O,F=c.solid;this.data=P;var N=u(this.scene,P);"mode"in N&&(this.mode=N.mode),"lineDashes"in N&&N.lineDashes in c&&(F=c[N.lineDashes]),this.color=T(N.scatterColor)||T(N.lineColor),this.dataPoints=N.position,I={gl:this.scene.glplot.gl,position:N.position,color:N.lineColor,lineWidth:N.lineWidth||1,dashes:F[0],dashScale:F[1],opacity:P.opacity,connectGaps:P.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(I):(this.linePlot=A(I),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var G=P.opacity;if(P.marker&&P.marker.opacity&&(G*=P.marker.opacity),D={gl:this.scene.glplot.gl,position:N.position,color:N.scatterColor,size:N.scatterSize,glyph:N.scatterMarker,opacity:G,orthographic:!0,lineWidth:N.scatterLineWidth,lineColor:N.scatterLineColor,project:N.project,projectScale:N.projectScale,projectOpacity:N.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(D):(this.scatterPlot=g(D),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),O={gl:this.scene.glplot.gl,position:N.position,glyph:N.text,color:N.textColor,size:N.textSize,angle:N.textAngle,alignment:N.textOffset,font:N.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:P.opacity},this.textLabels=P.hovertext||P.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(O):(this.textMarkers=g(O),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),R={gl:this.scene.glplot.gl,position:N.position,color:N.errorColor,error:N.errorBounds,lineWidth:N.errorLineWidth,capSize:N.errorCapSize,opacity:P.opacity},this.errorBars?N.errorBounds?this.errorBars.update(R):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):N.errorBounds&&(this.errorBars=S(R),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),N.delaunayAxis>=0){var K=y(N.position,N.delaunayColor,N.delaunayAxis);K.opacity=P.opacity,this.delaunayMesh?this.delaunayMesh.update(K):(K.gl=z,this.delaunayMesh=M(K),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},f.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())};function k(P,z){var I=new v(P,z.uid);return I.update(z),I}ee.exports=k},{"../../../stackgl_modules":1133,"../../components/fx/helpers":403,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../scatter/make_bubble_size_func":953,"./calc_errors":966}],968:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib"),S=d("../scatter/subtypes"),M=d("../scatter/marker_defaults"),e=d("../scatter/line_defaults"),a=d("../scatter/text_defaults"),n=d("./attributes");ee.exports=function(c,s,i,x){function p(_,h){return g.coerce(c,s,n,_,h)}var v=r(c,s,p,x);if(!v){s.visible=!1;return}p("text"),p("hovertext"),p("hovertemplate"),p("xhoverformat"),p("yhoverformat"),p("zhoverformat"),p("mode"),S.hasLines(s)&&(p("connectgaps"),e(c,s,i,x,p)),S.hasMarkers(s)&&M(c,s,i,x,p,{noSelect:!0,noAngle:!0}),S.hasText(s)&&(p("texttemplate"),a(c,s,x,p,{noSelect:!0}));var f=(s.line||{}).color,y=(s.marker||{}).color;p("surfaceaxis")>=0&&p("surfacecolor",f||y);for(var o=["x","y","z"],m=0;m<3;++m){var l="projection."+o[m];p(l+".show")&&(p(l+".opacity"),p(l+".scale"))}var w=A.getComponentMethod("errorbars","supplyDefaults");w(c,s,f||y||i,{axis:"z"}),w(c,s,f||y||i,{axis:"y",inherit:"z"}),w(c,s,f||y||i,{axis:"x",inherit:"z"})};function r(t,c,s,i){var x=0,p=s("x"),v=s("y"),f=s("z"),y=A.getComponentMethod("calendars","handleTraceDefaults");return y(t,c,["x","y","z"],i),p&&v&&f&&(x=Math.min(p.length,v.length,f.length),c._length=c._xlength=c._ylength=c._zlength=x),x}},{"../../lib":515,"../../registry":647,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":964}],969:[function(d,ee,te){ee.exports={plot:d("./convert"),attributes:d("./attributes"),markerSymbols:d("../../constants/gl3d_markers"),supplyDefaults:d("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:d("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":489,"../../plots/gl3d":607,"./attributes":964,"./calc":965,"./convert":967,"./defaults":968}],970:[function(d,ee,te){var A=d("../scatter/attributes"),g=d("../../plots/attributes"),S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../../plots/template_attributes").texttemplateAttrs,e=d("../../components/colorscale/attributes"),a=d("../../lib/extend").extendFlat,n=A.marker,r=A.line,t=n.line;ee.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:a({},A.mode,{dflt:"markers"}),text:a({},A.text,{}),texttemplate:M({editType:"plot"},{keys:["a","b","text"]}),hovertext:a({},A.hovertext,{}),line:{color:r.color,width:r.width,dash:r.dash,backoff:r.backoff,shape:a({},r.shape,{values:["linear","spline"]}),smoothing:r.smoothing,editType:"calc"},connectgaps:A.connectgaps,fill:a({},A.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:A.fillcolor,marker:a({symbol:n.symbol,opacity:n.opacity,maxdisplayed:n.maxdisplayed,angle:n.angle,angleref:n.angleref,standoff:n.standoff,size:n.size,sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,line:a({width:t.width,editType:"calc"},e("marker.line")),gradient:n.gradient,editType:"calc"},e("marker")),textfont:A.textfont,textposition:A.textposition,selected:A.selected,unselected:A.unselected,hoverinfo:a({},g.hoverinfo,{flags:["a","b","text","name"]}),hoveron:A.hoveron,hovertemplate:S()}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],971:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../scatter/colorscale_calc"),S=d("../scatter/arrays_to_calcdata"),M=d("../scatter/calc_selection"),e=d("../scatter/calc").calcMarkerSize,a=d("../carpet/lookup_carpetid");ee.exports=function(r,t){var c=t._carpetTrace=a(r,t);if(!(!c||!c.visible||c.visible==="legendonly")){var s;t.xaxis=c.xaxis,t.yaxis=c.yaxis;var i=t._length,x=new Array(i),p,v,f=!1;for(s=0;s<i;s++)if(p=t.a[s],v=t.b[s],A(p)&&A(v)){var y=c.ab2xy(+p,+v,!0),o=c.isVisible(+p,+v);o||(f=!0),x[s]={x:y[0],y:y[1],a:p,b:v,vis:o}}else x[s]={x:!1,y:!1};return t._needsCull=f,x[0].carpet=c,x[0].trace=t,e(t,i),g(r,t),S(x,t),M(x,t),x}}},{"../carpet/lookup_carpetid":717,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],972:[function(d,ee,te){var A=d("../../lib"),g=d("../scatter/constants"),S=d("../scatter/subtypes"),M=d("../scatter/marker_defaults"),e=d("../scatter/line_defaults"),a=d("../scatter/line_shape_defaults"),n=d("../scatter/text_defaults"),r=d("../scatter/fillcolor_defaults"),t=d("./attributes");ee.exports=function(s,i,x,p){function v(_,h){return A.coerce(s,i,t,_,h)}v("carpet"),i.xaxis="x",i.yaxis="y";var f=v("a"),y=v("b"),o=Math.min(f.length,y.length);if(!o){i.visible=!1;return}i._length=o,v("text"),v("texttemplate"),v("hovertext");var m=o<g.PTS_LINESONLY?"lines+markers":"lines";v("mode",m),S.hasLines(i)&&(e(s,i,x,p,v,{backoff:!0}),a(s,i,v),v("connectgaps")),S.hasMarkers(i)&&M(s,i,x,p,v,{gradient:!0}),S.hasText(i)&&n(s,i,p,v);var l=[];(S.hasMarkers(i)||S.hasText(i))&&(v("marker.maxdisplayed"),l.push("points")),v("fill"),i.fill!=="none"&&(r(s,i,x,v),S.hasLines(i)||a(s,i,v)),(i.fill==="tonext"||i.fill==="toself")&&l.push("fills");var w=v("hoveron",l.join("+")||"points");w!=="fills"&&v("hovertemplate"),A.coerceSelectionMarkerOpacity(i,v)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":970}],973:[function(d,ee,te){ee.exports=function(g,S,M,e,a){var n=e[a];return g.a=n.a,g.b=n.b,g.y=n.y,g}},{}],974:[function(d,ee,te){ee.exports=function(g,S){var M={},e=S._carpet,a=e.ab2ij([g.a,g.b]),n=Math.floor(a[0]),r=a[0]-n,t=Math.floor(a[1]),c=a[1]-t,s=e.evalxy([],n,t,r,c);return M.yLabel=s[1].toFixed(3),M}},{}],975:[function(d,ee,te){var A=d("../scatter/hover"),g=d("../../lib").fillText;ee.exports=function(M,e,a,n){var r=A(M,e,a,n);if(!r||r[0].index===!1)return;var t=r[0];if(t.index===void 0){var c=1-t.y0/M.ya._length,s=M.xa._length,i=s*c/2,x=s-i;return t.x0=Math.max(Math.min(t.x0,x),i),t.x1=Math.max(Math.min(t.x1,x),i),r}var p=t.cd[t.index];t.a=p.a,t.b=p.b,t.xLabelVal=void 0,t.yLabelVal=void 0;var v=t.trace,f=v._carpet,y=v._module.formatLabels(p,v);t.yLabel=y.yLabel,delete t.text;var o=[];function m(_,h){var b;_.labelprefix&&_.labelprefix.length>0?b=_.labelprefix.replace(/ = $/,""):b=_._hovertitle,o.push(b+": "+h.toFixed(3)+_.labelsuffix)}if(!v.hovertemplate){var l=p.hi||v.hoverinfo,w=l.split("+");w.indexOf("all")!==-1&&(w=["a","b","text"]),w.indexOf("a")!==-1&&m(f.aaxis,p.a),w.indexOf("b")!==-1&&m(f.baxis,p.b),o.push("y: "+t.yLabel),w.indexOf("text")!==-1&&g(p,v,o),t.extraText=o.join("<br>")}return r}},{"../../lib":515,"../scatter/hover":947}],976:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),plot:d("./plot"),style:d("../scatter/style").style,styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("../scatter/select"),eventData:d("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:d("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":970,"./calc":971,"./defaults":972,"./event_data":973,"./format_labels":974,"./hover":975,"./plot":977}],977:[function(d,ee,te){var A=d("../scatter/plot"),g=d("../../plots/cartesian/axes"),S=d("../../components/drawing");ee.exports=function(e,a,n,r){var t,c,s,i=n[0][0].carpet,x=g.getFromId(e,i.xaxis||"x"),p=g.getFromId(e,i.yaxis||"y"),v={xaxis:x,yaxis:p,plot:a.plot};for(t=0;t<n.length;t++)c=n[t][0].trace,c._xA=x,c._yA=p;for(A(e,v,n,r),t=0;t<n.length;t++)c=n[t][0].trace,s=r.selectAll("g.trace"+c.uid+" .js-line"),S.setClipUrl(s,n[t][0].carpet._clipPathId,e)}},{"../../components/drawing":389,"../../plots/cartesian/axes":566,"../scatter/plot":957}],978:[function(d,ee,te){var A=d("../../plots/template_attributes").hovertemplateAttrs,g=d("../../plots/template_attributes").texttemplateAttrs,S=d("../scatter/attributes"),M=d("../../plots/attributes"),e=d("../../components/colorscale/attributes"),a=d("../../components/drawing/attributes").dash,n=d("../../lib/extend").extendFlat,r=d("../../plot_api/edit_types").overrideAll,t=S.marker,c=S.line,s=t.line;ee.exports=r({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:n({},S.mode,{dflt:"markers"}),text:n({},S.text,{}),texttemplate:g({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:n({},S.hovertext,{}),textfont:S.textfont,textposition:S.textposition,line:{color:c.color,width:c.width,dash:a},connectgaps:S.connectgaps,marker:n({symbol:t.symbol,opacity:t.opacity,angle:t.angle,angleref:n({},t.angleref,{values:["previous","up","north"]}),standoff:t.standoff,size:t.size,sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,colorbar:t.colorbar,line:n({width:s.width},e("marker.line")),gradient:t.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:S.fillcolor,selected:S.selected,unselected:S.unselected,hoverinfo:n({},M.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:A()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],979:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../constants/numerical").BADNUM,S=d("../scatter/colorscale_calc"),M=d("../scatter/arrays_to_calcdata"),e=d("../scatter/calc_selection"),a=d("../../lib")._;function n(r){return r&&typeof r=="string"}ee.exports=function(t,c){var s=Array.isArray(c.locations),i=s?c.locations.length:c._length,x=new Array(i),p;c.geojson?p=function(l){return n(l)||A(l)}:p=n;for(var v=0;v<i;v++){var f=x[v]={};if(s){var y=c.locations[v];f.loc=p(y)?y:null}else{var o=c.lon[v],m=c.lat[v];A(o)&&A(m)?f.lonlat=[+o,+m]:f.lonlat=[g,g]}}return M(x,c),S(t,c),e(x,c),i&&(x[0].t={labels:{lat:a(t,"lat:")+" ",lon:a(t,"lon:")+" "}}),x}},{"../../constants/numerical":491,"../../lib":515,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],980:[function(d,ee,te){var A=d("../../lib"),g=d("../scatter/subtypes"),S=d("../scatter/marker_defaults"),M=d("../scatter/line_defaults"),e=d("../scatter/text_defaults"),a=d("../scatter/fillcolor_defaults"),n=d("./attributes");ee.exports=function(t,c,s,i){function x(w,_){return A.coerce(t,c,n,w,_)}var p=x("locations"),v;if(p&&p.length){var f=x("geojson"),y;(typeof f=="string"&&f!==""||A.isPlainObject(f))&&(y="geojson-id");var o=x("locationmode",y);o==="geojson-id"&&x("featureidkey"),v=p.length}else{var m=x("lon")||[],l=x("lat")||[];v=Math.min(m.length,l.length)}if(!v){c.visible=!1;return}c._length=v,x("text"),x("hovertext"),x("hovertemplate"),x("mode"),g.hasLines(c)&&(M(t,c,s,i,x),x("connectgaps")),g.hasMarkers(c)&&S(t,c,s,i,x,{gradient:!0}),g.hasText(c)&&(x("texttemplate"),e(t,c,i,x)),x("fill"),c.fill!=="none"&&a(t,c,s,x),A.coerceSelectionMarkerOpacity(c,x)}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":978}],981:[function(d,ee,te){ee.exports=function(g,S,M,e,a){g.lon=S.lon,g.lat=S.lat,g.location=S.loc?S.loc:null;var n=e[a];return n.fIn&&n.fIn.properties&&(g.properties=n.fIn.properties),g}},{}],982:[function(d,ee,te){var A=d("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n=e[M.geo]._subplot,r=n.mockAxis,t=S.lonlat;return a.lonLabel=A.tickText(r,r.c2l(t[0]),!0).text,a.latLabel=A.tickText(r,r.c2l(t[1]),!0).text,a}},{"../../plots/cartesian/axes":566}],983:[function(d,ee,te){var A=d("../../components/fx"),g=d("../../constants/numerical").BADNUM,S=d("../scatter/get_trace_color"),M=d("../../lib").fillText,e=d("./attributes");ee.exports=function(r,t,c){var s=r.cd,i=s[0].trace,x=r.xa,p=r.ya,v=r.subplot,f=v.projection.isLonLatOverEdges,y=v.project;function o(u){var L=u.lonlat;if(L[0]===g||f(L))return 1/0;var T=y(L),k=y([t,c]),P=Math.abs(T[0]-k[0]),z=Math.abs(T[1]-k[1]),I=Math.max(3,u.mrc||0);return Math.max(Math.sqrt(P*P+z*z)-I,1-3/I)}if(A.getClosest(s,o,r),r.index!==!1){var m=s[r.index],l=m.lonlat,w=[x.c2p(l),p.c2p(l)],_=m.mrc||1;r.x0=w[0]-_,r.x1=w[0]+_,r.y0=w[1]-_,r.y1=w[1]+_,r.loc=m.loc,r.lon=l[0],r.lat=l[1];var h={};h[i.geo]={_subplot:v};var b=i._module.formatLabels(m,i,h);return r.lonLabel=b.lonLabel,r.latLabel=b.latLabel,r.color=S(i,m),r.extraText=a(i,m,r,s[0].t.labels),r.hovertemplate=i.hovertemplate,[r]}};function a(n,r,t,c){if(n.hovertemplate)return;var s=r.hi||n.hoverinfo,i=s==="all"?e.hoverinfo.flags:s.split("+"),x=i.indexOf("location")!==-1&&Array.isArray(n.locations),p=i.indexOf("lon")!==-1,v=i.indexOf("lat")!==-1,f=i.indexOf("text")!==-1,y=[];function o(m){return m+"\xB0"}return x?y.push(r.loc):p&&v?y.push("("+o(t.latLabel)+", "+o(t.lonLabel)+")"):p?y.push(c.lon+o(t.lonLabel)):v&&y.push(c.lat+o(t.latLabel)),f&&M(r,n,y),y.join("<br>")}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946,"./attributes":978}],984:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),calcGeoJSON:d("./plot").calcGeoJSON,plot:d("./plot").plot,style:d("./style"),styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover"),eventData:d("./event_data"),selectPoints:d("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:d("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":598,"../scatter/marker_colorbar":954,"../scatter/style":960,"./attributes":978,"./calc":979,"./defaults":980,"./event_data":981,"./format_labels":982,"./hover":983,"./plot":985,"./select":986,"./style":987}],985:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=d("../../lib/topojson_utils").getTopojsonFeatures,M=d("../../lib/geojson_utils"),e=d("../../lib/geo_location_utils"),a=d("../../plots/cartesian/autorange").findExtremes,n=d("../../constants/numerical").BADNUM,r=d("../scatter/calc").calcMarkerSize,t=d("../scatter/subtypes"),c=d("./style");function s(x,p,v){var f=p.layers.frontplot.select(".scatterlayer"),y=g.makeTraceGroups(f,v,"trace scattergeo");function o(m,l){m.lonlat[0]===n&&A.select(l).remove()}y.selectAll("*").remove(),y.each(function(m){var l=A.select(this),w=m[0].trace;if(t.hasLines(w)||w.fill!=="none"){var _=M.calcTraceToLineCoords(m),h=w.fill!=="none"?M.makePolygon(_):M.makeLine(_);l.selectAll("path.js-line").data([{geojson:h,trace:w}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}t.hasMarkers(w)&&l.selectAll("path.point").data(g.identity).enter().append("path").classed("point",!0).each(function(b){o(b,this)}),t.hasText(w)&&l.selectAll("g").data(g.identity).enter().append("g").append("text").each(function(b){o(b,this)}),c(x,m)})}function i(x,p){var v=x[0].trace,f=p[v.geo],y=f._subplot,o=v._length,m,l;if(Array.isArray(v.locations)){var w=v.locationmode,_=w==="geojson-id"?e.extractTraceFeature(x):S(v,y.topojson);for(m=0;m<o;m++){l=x[m];var h=w==="geojson-id"?l.fOut:e.locationToFeature(w,l.loc,_);l.lonlat=h?h.properties.ct:[n,n]}}var b={padded:!0},u,L;if(f.fitbounds==="geojson"&&v.locationmode==="geojson-id"){var T=e.computeBbox(e.getTraceGeojson(v));u=[T[0],T[2]],L=[T[1],T[3]]}else{for(u=new Array(o),L=new Array(o),m=0;m<o;m++)l=x[m],u[m]=l.lonlat[0],L[m]=l.lonlat[1];b.ppad=r(v,o)}v._extremes.lon=a(f.lonaxis._ax,u,b),v._extremes.lat=a(f.lataxis._ax,L,b)}ee.exports={calcGeoJSON:i,plot:s}},{"../../constants/numerical":491,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"../scatter/calc":937,"../scatter/subtypes":961,"./style":987,"@plotly/d3":58}],986:[function(d,ee,te){var A=d("../scatter/subtypes"),g=d("../../constants/numerical").BADNUM;ee.exports=function(M,e){var a=M.cd,n=M.xaxis,r=M.yaxis,t=[],c=a[0].trace,s,i,x,p,v,f=!A.hasMarkers(c)&&!A.hasText(c);if(f)return[];if(e===!1)for(v=0;v<a.length;v++)a[v].selected=0;else for(v=0;v<a.length;v++)s=a[v],i=s.lonlat,i[0]!==g&&(x=n.c2p(i),p=r.c2p(i),e.contains([x,p],null,v,M)?(t.push({pointNumber:v,lon:i[0],lat:i[1]}),s.selected=1):s.selected=0);return t}},{"../../constants/numerical":491,"../scatter/subtypes":961}],987:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/drawing"),S=d("../../components/color"),M=d("../scatter/style"),e=M.stylePoints,a=M.styleText;ee.exports=function(t,c){c&&n(t,c)};function n(r,t){var c=t[0].trace,s=t[0].node3;s.style("opacity",t[0].trace.opacity),e(s,c,r),a(s,c,r),s.selectAll("path.js-line").style("fill","none").each(function(i){var x=A.select(this),p=i.trace,v=p.line||{};x.call(S.stroke,v.color).call(g.dashLine,v.dash||"",v.width||0),p.fill!=="none"&&x.call(S.fill,p.fillcolor)})}},{"../../components/color":367,"../../components/drawing":389,"../scatter/style":960,"@plotly/d3":58}],988:[function(d,ee,te){var A=d("../../plots/attributes"),g=d("../scatter/attributes"),S=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../components/colorscale/attributes"),e=d("../../lib/sort_object_keys"),a=d("../../lib/extend").extendFlat,n=d("../../plot_api/edit_types").overrideAll,r=d("./constants").DASHES,t=g.line,c=g.marker,s=c.line,i=ee.exports=n({x:g.x,x0:g.x0,dx:g.dx,y:g.y,y0:g.y0,dy:g.dy,xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,xhoverformat:S("x"),yhoverformat:S("y"),text:g.text,hovertext:g.hovertext,textposition:g.textposition,textfont:g.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:t.color,width:t.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(r),dflt:"solid"}},marker:a({},M("marker"),{symbol:c.symbol,angle:c.angle,size:c.size,sizeref:c.sizeref,sizemin:c.sizemin,sizemode:c.sizemode,opacity:c.opacity,colorbar:c.colorbar,line:a({},M("marker.line"),{width:s.width})}),connectgaps:g.connectgaps,fill:a({},g.fill,{dflt:"none"}),fillcolor:g.fillcolor,selected:{marker:g.selected.marker,textfont:g.selected.textfont},unselected:{marker:g.unselected.marker,textfont:g.unselected.textfont},opacity:A.opacity},"calc","nested");i.x.editType=i.y.editType=i.x0.editType=i.y0.editType="calc+clearAxisTypes",i.hovertemplate=g.hovertemplate,i.texttemplate=g.texttemplate},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936,"./constants":991}],989:[function(d,ee,te){var A=d("./hover");ee.exports={moduleType:"trace",name:"scattergl",basePlotModule:d("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("../scatter/cross_trace_defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),hoverPoints:A.hoverPoints,selectPoints:d("./select"),meta:{}}},{"../../plots/cartesian":578,"../scatter/cross_trace_defaults":942,"../scatter/marker_colorbar":954,"./attributes":988,"./calc":990,"./defaults":993,"./format_labels":995,"./hover":997,"./select":1001}],990:[function(d,ee,te){var A=d("@plotly/point-cluster"),g=d("../../lib"),S=d("../../plots/cartesian/axis_ids"),M=d("../../plots/cartesian/autorange").findExtremes,e=d("../../plots/cartesian/align_period"),a=d("../scatter/calc"),n=a.calcMarkerSize,r=a.calcAxisExpansion,t=a.setFirstScatter,c=d("../scatter/colorscale_calc"),s=d("./convert"),i=d("./scene_update"),x=d("../../constants/numerical").BADNUM,p=d("./constants").TOO_MANY_POINTS;ee.exports=function(o,m){var l=o._fullLayout,w=m._xA=S.getFromId(o,m.xaxis,"x"),_=m._yA=S.getFromId(o,m.yaxis,"y"),h=l._plots[m.xaxis+m.yaxis],b=m._length,u=b>=p,L=b*2,T={},k,P=w.makeCalcdata(m,"x"),z=_.makeCalcdata(m,"y"),I=e(m,w,"x",P),D=e(m,_,"y",z),R=I.vals,O=D.vals;m._x=R,m._y=O,m.xperiodalignment&&(m._origX=P,m._xStarts=I.starts,m._xEnds=I.ends),m.yperiodalignment&&(m._origY=z,m._yStarts=D.starts,m._yEnds=D.ends);var F=new Array(L),N=new Array(b);for(k=0;k<b;k++)F[k*2]=R[k]===x?NaN:R[k],F[k*2+1]=O[k]===x?NaN:O[k],N[k]=k;if(w.type==="log")for(k=0;k<L;k+=2)F[k]=w.c2l(F[k]);if(_.type==="log")for(k=1;k<L;k+=2)F[k]=_.c2l(F[k]);u&&w.type!=="log"&&_.type!=="log"?T.tree=A(F):T.ids=N,c(o,m);var G=f(o,h,m,F,R,O),K=i(o,h);t(l,m);var W;return u?G.marker&&(W=G.marker.sizeAvg||Math.max(G.marker.size,3)):W=n(m,b),r(o,m,w,_,R,O,W),G.errorX&&v(m,w,G.errorX),G.errorY&&v(m,_,G.errorY),G.fill&&!K.fill2d&&(K.fill2d=!0),G.marker&&!K.scatter2d&&(K.scatter2d=!0),G.line&&!K.line2d&&(K.line2d=!0),(G.errorX||G.errorY)&&!K.error2d&&(K.error2d=!0),G.text&&!K.glText&&(K.glText=!0),G.marker&&(G.marker.snap=b),K.lineOptions.push(G.line),K.errorXOptions.push(G.errorX),K.errorYOptions.push(G.errorY),K.fillOptions.push(G.fill),K.markerOptions.push(G.marker),K.markerSelectedOptions.push(G.markerSel),K.markerUnselectedOptions.push(G.markerUnsel),K.textOptions.push(G.text),K.textSelectedOptions.push(G.textSel),K.textUnselectedOptions.push(G.textUnsel),K.selectBatch.push([]),K.unselectBatch.push([]),T._scene=K,T.index=K.count,T.x=R,T.y=O,T.positions=F,K.count++,[{x:!1,y:!1,t:T,trace:m}]};function v(y,o,m){var l=y._extremes[o._id],w=M(o,m._bnds,{padded:!0});l.min=l.min.concat(w.min),l.max=l.max.concat(w.max)}function f(y,o,m,l,w,_){var h=s.style(y,m);if(h.marker&&(h.marker.positions=l),h.line&&l.length>1&&g.extendFlat(h.line,s.linePositions(y,m,l)),h.errorX||h.errorY){var b=s.errorBarPositions(y,m,l,w,_);h.errorX&&g.extendFlat(h.errorX,b.x),h.errorY&&g.extendFlat(h.errorY,b.y)}return h.text&&(g.extendFlat(h.text,{positions:l},s.textPosition(y,m,h.text,h.marker)),g.extendFlat(h.textSel,{positions:l},s.textPosition(y,m,h.text,h.markerSel)),g.extendFlat(h.textUnsel,{positions:l},s.textPosition(y,m,h.text,h.markerUnsel))),h}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"./constants":991,"./convert":992,"./scene_update":1e3,"@plotly/point-cluster":59}],991:[function(d,ee,te){var A=20;ee.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:A,SYMBOL_STROKE:A/20,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],992:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("svg-path-sdf"),S=d("color-normalize"),M=d("../../registry"),e=d("../../lib"),a=d("../../components/drawing"),n=d("../../plots/cartesian/axis_ids"),r=d("../../lib/gl_format_color").formatColor,t=d("../scatter/subtypes"),c=d("../scatter/make_bubble_size_func"),s=d("./helpers"),i=d("./constants"),x=d("../../constants/interactions").DESELECTDIM,p={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},v=d("../../components/fx/helpers").appendArrayPointValue;function f(I,D){var R,O={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},F=I._context.plotGlPixelRatio;if(D.visible!==!0)return O;if(t.hasText(D)&&(O.text=y(I,D),O.textSel=l(I,D,D.selected),O.textUnsel=l(I,D,D.unselected)),t.hasMarkers(D)&&(O.marker=o(I,D),O.markerSel=m(I,D,D.selected),O.markerUnsel=m(I,D,D.unselected),!D.unselected&&e.isArrayOrTypedArray(D.marker.opacity))){var N=D.marker.opacity;for(O.markerUnsel.opacity=new Array(N.length),R=0;R<N.length;R++)O.markerUnsel.opacity[R]=x*N[R]}if(t.hasLines(D)){O.line={overlay:!0,thickness:D.line.width*F,color:D.line.color,opacity:D.opacity};var G=(i.DASHES[D.line.dash]||[1]).slice();for(R=0;R<G.length;++R)G[R]*=D.line.width*F;O.line.dashes=G}return D.error_x&&D.error_x.visible&&(O.errorX=w(D,D.error_x,F)),D.error_y&&D.error_y.visible&&(O.errorY=w(D,D.error_y,F)),!!D.fill&&D.fill!=="none"&&(O.fill={closed:!0,fill:D.fillcolor,thickness:0}),O}function y(I,D){var R=I._fullLayout,O=D._length,F=D.textfont,N=D.textposition,G=Array.isArray(N)?N:[N],K=F.color,W=F.size,Y=F.family,re={},ue,j=I._context.plotGlPixelRatio,q=D.texttemplate;if(q){re.text=[];var V=R._d3locale,U=Array.isArray(q),$=U?Math.min(q.length,O):O,ne=U?function(be){return q[be]}:function(){return q};for(ue=0;ue<$;ue++){var X={i:ue},Q=D._module.formatLabels(X,D,R),ie={};v(ie,D,ue);var se=D._meta||{};re.text.push(e.texttemplateString(ne(ue),Q,V,ie,X,se))}}else Array.isArray(D.text)&&D.text.length<O?re.text=D.text.slice():re.text=D.text;if(Array.isArray(re.text))for(ue=re.text.length;ue<O;ue++)re.text[ue]="";for(re.opacity=D.opacity,re.font={},re.align=[],re.baseline=[],ue=0;ue<G.length;ue++){var ae=G[ue].split(/\s+/);switch(ae[1]){case"left":re.align.push("right");break;case"right":re.align.push("left");break;default:re.align.push(ae[1])}switch(ae[0]){case"top":re.baseline.push("bottom");break;case"bottom":re.baseline.push("top");break;default:re.baseline.push(ae[0])}}if(Array.isArray(K))for(re.color=new Array(O),ue=0;ue<O;ue++)re.color[ue]=K[ue];else re.color=K;if(e.isArrayOrTypedArray(W)||Array.isArray(Y))for(re.font=new Array(O),ue=0;ue<O;ue++){var oe=re.font[ue]={};oe.size=(e.isTypedArray(W)?W[ue]:Array.isArray(W)?A(W[ue])?W[ue]:0:W)*j,oe.family=Array.isArray(Y)?Y[ue]:Y}else re.font={size:W*j,family:Y};return re}function o(I,D){var R=D._length,O=D.marker,F={},N,G=e.isArrayOrTypedArray(O.symbol),K=e.isArrayOrTypedArray(O.angle),W=e.isArrayOrTypedArray(O.color),Y=e.isArrayOrTypedArray(O.line.color),re=e.isArrayOrTypedArray(O.opacity),ue=e.isArrayOrTypedArray(O.size),j=e.isArrayOrTypedArray(O.line.width),q;if(G||(q=s.isOpenSymbol(O.symbol)),G||W||Y||re||K){F.symbols=new Array(R),F.angles=new Array(R),F.colors=new Array(R),F.borderColors=new Array(R);var V=O.symbol,U=O.angle,$=r(O,O.opacity,R),ne=r(O.line,O.opacity,R);if(!Array.isArray(ne[0])){var X=ne;for(ne=Array(R),N=0;N<R;N++)ne[N]=X}if(!Array.isArray($[0])){var Q=$;for($=Array(R),N=0;N<R;N++)$[N]=Q}if(!Array.isArray(V)){var ie=V;for(V=Array(R),N=0;N<R;N++)V[N]=ie}if(!Array.isArray(U)){var se=U;for(U=Array(R),N=0;N<R;N++)U[N]=se}for(F.symbols=V,F.angles=U,F.colors=$,F.borderColors=ne,N=0;N<R;N++)G&&(q=s.isOpenSymbol(O.symbol[N])),q&&(ne[N]=$[N].slice(),$[N]=$[N].slice(),$[N][3]=0);for(F.opacity=D.opacity,F.markers=new Array(R),N=0;N<R;N++)F.markers[N]=T({mx:F.symbols[N],ma:F.angles[N]},D)}else q?(F.color=S(O.color,"uint8"),F.color[3]=0,F.borderColor=S(O.color,"uint8")):(F.color=S(O.color,"uint8"),F.borderColor=S(O.line.color,"uint8")),F.opacity=D.opacity*O.opacity,F.marker=T({mx:O.symbol,ma:O.angle},D);var ae=1,oe=c(D,ae),be;if(ue||j){var ce=F.sizes=new Array(R),de=F.borderSizes=new Array(R),ye=0,ge;if(ue){for(N=0;N<R;N++)ce[N]=oe(O.size[N]),ye+=ce[N];ge=ye/R}else for(be=oe(O.size),N=0;N<R;N++)ce[N]=be;if(j)for(N=0;N<R;N++)de[N]=O.line.width[N];else for(be=O.line.width,N=0;N<R;N++)de[N]=be;F.sizeAvg=ge}else F.size=oe(O&&O.size||10),F.borderSizes=oe(O.line.width);return F}function m(I,D,R){var O=D.marker,F={};return R&&(R.marker&&R.marker.symbol?F=o(I,e.extendFlat({},O,R.marker)):R.marker&&(R.marker.size&&(F.size=R.marker.size),R.marker.color&&(F.colors=R.marker.color),R.marker.opacity!==void 0&&(F.opacity=R.marker.opacity))),F}function l(I,D,R){var O={};if(!R)return O;if(R.textfont){var F={opacity:1,text:D.text,texttemplate:D.texttemplate,textposition:D.textposition,textfont:e.extendFlat({},D.textfont)};R.textfont&&e.extendFlat(F.textfont,R.textfont),O=y(I,F)}return O}function w(I,D,R){var O={capSize:D.width*2*R,lineWidth:D.thickness*R,color:D.color};return D.copy_ystyle&&(O=I.error_y),O}var _=i.SYMBOL_SDF_SIZE,h=i.SYMBOL_SIZE,b=i.SYMBOL_STROKE,u={},L=a.symbolFuncs[0](h*.05);function T(I,D){var R=I.mx;if(R==="circle")return null;var O,F,N=a.symbolNumber(R),G=a.symbolFuncs[N%100],K=!!a.symbolNoDot[N%100],W=!!a.symbolNoFill[N%100],Y=s.isDotSymbol(R);if(I.ma&&(R+="_"+I.ma),u[R])return u[R];var re=a.getMarkerAngle(I,D);return Y&&!K?O=G(h*1.1,re)+L:O=G(h,re),F=g(O,{w:_,h:_,viewBox:[-h,-h,h,h],stroke:W?b:-b}),u[R]=F,F||null}function k(I,D,R){var O=R.length,F=O/2,N,G;if(t.hasLines(D)&&F)if(D.line.shape==="hv"){for(N=[],G=0;G<F-1;G++)isNaN(R[G*2])||isNaN(R[G*2+1])?N.push(NaN,NaN,NaN,NaN):(N.push(R[G*2],R[G*2+1]),!isNaN(R[G*2+2])&&!isNaN(R[G*2+3])?N.push(R[G*2+2],R[G*2+1]):N.push(NaN,NaN));N.push(R[O-2],R[O-1])}else if(D.line.shape==="hvh"){for(N=[],G=0;G<F-1;G++)if(isNaN(R[G*2])||isNaN(R[G*2+1])||isNaN(R[G*2+2])||isNaN(R[G*2+3]))!isNaN(R[G*2])&&!isNaN(R[G*2+1])?N.push(R[G*2],R[G*2+1]):N.push(NaN,NaN),N.push(NaN,NaN);else{var K=(R[G*2]+R[G*2+2])/2;N.push(R[G*2],R[G*2+1],K,R[G*2+1],K,R[G*2+3])}N.push(R[O-2],R[O-1])}else if(D.line.shape==="vhv"){for(N=[],G=0;G<F-1;G++)if(isNaN(R[G*2])||isNaN(R[G*2+1])||isNaN(R[G*2+2])||isNaN(R[G*2+3]))!isNaN(R[G*2])&&!isNaN(R[G*2+1])?N.push(R[G*2],R[G*2+1]):N.push(NaN,NaN),N.push(NaN,NaN);else{var W=(R[G*2+1]+R[G*2+3])/2;N.push(R[G*2],R[G*2+1],R[G*2],W,R[G*2+2],W)}N.push(R[O-2],R[O-1])}else if(D.line.shape==="vh"){for(N=[],G=0;G<F-1;G++)isNaN(R[G*2])||isNaN(R[G*2+1])?N.push(NaN,NaN,NaN,NaN):(N.push(R[G*2],R[G*2+1]),!isNaN(R[G*2+2])&&!isNaN(R[G*2+3])?N.push(R[G*2],R[G*2+3]):N.push(NaN,NaN));N.push(R[O-2],R[O-1])}else N=R;var Y=!1;for(G=0;G<N.length;G++)if(isNaN(N[G])){Y=!0;break}var re=Y||N.length>i.TOO_MANY_POINTS||t.hasMarkers(D)?"rect":"round";if(Y&&D.connectgaps){var ue=N[0],j=N[1];for(G=0;G<N.length;G+=2)isNaN(N[G])||isNaN(N[G+1])?(N[G]=ue,N[G+1]=j):(ue=N[G],j=N[G+1])}return{join:re,positions:N}}function P(I,D,R,O,F){var N=M.getComponentMethod("errorbars","makeComputeError"),G=n.getFromId(I,D.xaxis,"x"),K=n.getFromId(I,D.yaxis,"y"),W=R.length/2,Y={};function re(ue,j){var q=j._id.charAt(0),V=D["error_"+q];if(V&&V.visible&&(j.type==="linear"||j.type==="log")){for(var U=N(V),$={x:0,y:1}[q],ne={x:[0,1,2,3],y:[2,3,0,1]}[q],X=new Float64Array(4*W),Q=1/0,ie=-1/0,se=0,ae=0;se<W;se++,ae+=4){var oe=ue[se];if(A(oe)){var be=R[se*2+$],ce=U(oe,se),de=ce[0],ye=ce[1];if(A(de)&&A(ye)){var ge=oe-de,me=oe+ye;X[ae+ne[0]]=be-j.c2l(ge),X[ae+ne[1]]=j.c2l(me)-be,X[ae+ne[2]]=0,X[ae+ne[3]]=0,Q=Math.min(Q,oe-de),ie=Math.max(ie,oe+ye)}}}Y[q]={positions:R,errors:X,_bnds:[Q,ie]}}}return re(O,G),re(F,K),Y}function z(I,D,R,O){var F=D._length,N={},G;if(t.hasMarkers(D)){var K=R.font,W=R.align,Y=R.baseline;for(N.offset=new Array(F),G=0;G<F;G++){var re=O.sizes?O.sizes[G]:O.size,ue=Array.isArray(K)?K[G].size:K.size,j=Array.isArray(W)?W.length>1?W[G]:W[0]:W,q=Array.isArray(Y)?Y.length>1?Y[G]:Y[0]:Y,V=p[j],U=p[q],$=re?re/.8+1:0,ne=-U*$-U*.5;N.offset[G]=[V*$/ue,ne/ue]}}return N}ee.exports={style:f,markerStyle:o,markerSelection:m,linePositions:k,errorBarPositions:P,textPosition:z}},{"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/interactions":490,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"./constants":991,"./helpers":996,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":311}],993:[function(d,ee,te){var A=d("../../lib"),g=d("../../registry"),S=d("./helpers"),M=d("./attributes"),e=d("../scatter/constants"),a=d("../scatter/subtypes"),n=d("../scatter/xy_defaults"),r=d("../scatter/period_defaults"),t=d("../scatter/marker_defaults"),c=d("../scatter/line_defaults"),s=d("../scatter/fillcolor_defaults"),i=d("../scatter/text_defaults");ee.exports=function(p,v,f,y){function o(L,T){return A.coerce(p,v,M,L,T)}var m=p.marker?S.isOpenSymbol(p.marker.symbol):!1,l=a.isBubble(p),w=n(p,v,y,o);if(!w){v.visible=!1;return}r(p,v,y,o),o("xhoverformat"),o("yhoverformat");var _=w<e.PTS_LINESONLY?"lines+markers":"lines";o("text"),o("hovertext"),o("hovertemplate"),o("mode",_),a.hasLines(v)&&(o("connectgaps"),c(p,v,f,y,o),o("line.shape")),a.hasMarkers(v)&&(t(p,v,f,y,o,{noAngleRef:!0,noStandOff:!0}),o("marker.line.width",m||l?1:0)),a.hasText(v)&&(o("texttemplate"),i(p,v,y,o));var h=(v.line||{}).color,b=(v.marker||{}).color;o("fill"),v.fill!=="none"&&s(p,v,f,o);var u=g.getComponentMethod("errorbars","supplyDefaults");u(p,v,h||b||f,{axis:"y"}),u(p,v,h||b||f,{axis:"x",inherit:"y"}),A.coerceSelectionMarkerOpacity(v,o)}},{"../../lib":515,"../../registry":647,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/period_defaults":956,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatter/xy_defaults":963,"./attributes":988,"./helpers":996}],994:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/color"),S=d("../../constants/interactions").DESELECTDIM;function M(e){var a=e[0],n=a.trace,r=a.t,t=r._scene,c=r.index,s=t.selectBatch[c],i=t.unselectBatch[c],x=t.textOptions[c],p=t.textSelectedOptions[c]||{},v=t.textUnselectedOptions[c]||{},f=A.extendFlat({},x),y,o;if(s.length||i.length){var m=p.color,l=v.color,w=x.color,_=Array.isArray(w);for(f.color=new Array(n._length),y=0;y<s.length;y++)o=s[y],f.color[o]=m||(_?w[o]:w);for(y=0;y<i.length;y++){o=i[y];var h=_?w[o]:w;f.color[o]=l||(m?h:g.addOpacity(h,S))}}t.glText[c].update(f)}ee.exports={styleTextSelection:M}},{"../../components/color":367,"../../constants/interactions":490,"../../lib":515}],995:[function(d,ee,te){var A=d("../scatter/format_labels");ee.exports=function(S,M,e){var a=S.i;return"x"in S||(S.x=M._x[a]),"y"in S||(S.y=M._y[a]),A(S,M,e)}},{"../scatter/format_labels":945}],996:[function(d,ee,te){var A=d("./constants");te.isOpenSymbol=function(g){return typeof g=="string"?A.OPEN_RE.test(g):g%200>100},te.isDotSymbol=function(g){return typeof g=="string"?A.DOT_RE.test(g):g>200}},{"./constants":991}],997:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib"),S=d("../scatter/get_trace_color");function M(a,n,r,t){var c=a.cd,s=c[0].t,i=c[0].trace,x=a.xa,p=a.ya,v=s.x,f=s.y,y=x.c2p(n),o=p.c2p(r),m=a.distance,l;if(s.tree){var w=x.p2c(y-m),_=x.p2c(y+m),h=p.p2c(o-m),b=p.p2c(o+m);t==="x"?l=s.tree.range(Math.min(w,_),Math.min(p._rl[0],p._rl[1]),Math.max(w,_),Math.max(p._rl[0],p._rl[1])):l=s.tree.range(Math.min(w,_),Math.min(h,b),Math.max(w,_),Math.max(h,b))}else l=s.ids;var u,L,T,k,P,z,I,D,R,O=m;if(t==="x"){var F=!!i.xperiodalignment,N=!!i.yperiodalignment;for(P=0;P<l.length;P++){if(u=l[P],T=v[u],z=Math.abs(x.c2p(T)-y),F){var G=x.c2p(i._xStarts[u]),K=x.c2p(i._xEnds[u]);z=y>=Math.min(G,K)&&y<=Math.max(G,K)?0:1/0}if(z<O){if(O=z,k=f[u],I=p.c2p(k)-o,N){var W=p.c2p(i._yStarts[u]),Y=p.c2p(i._yEnds[u]);I=o>=Math.min(W,Y)&&o<=Math.max(W,Y)?0:1/0}R=Math.sqrt(z*z+I*I),L=l[P]}}}else for(P=l.length-1;P>-1;P--)u=l[P],T=v[u],k=f[u],z=x.c2p(T)-y,I=p.c2p(k)-o,D=Math.sqrt(z*z+I*I),D<O&&(O=R=D,L=u);return a.index=L,a.distance=O,a.dxy=R,L===void 0?[a]:[e(a,v,f,i)]}function e(a,n,r,t){var c=a.xa,s=a.ya,i=a.distance,x=a.dxy,p=a.index,v={pointNumber:p,x:n[p],y:r[p]};v.tx=Array.isArray(t.text)?t.text[p]:t.text,v.htx=Array.isArray(t.hovertext)?t.hovertext[p]:t.hovertext,v.data=Array.isArray(t.customdata)?t.customdata[p]:t.customdata,v.tp=Array.isArray(t.textposition)?t.textposition[p]:t.textposition;var f=t.textfont;f&&(v.ts=g.isArrayOrTypedArray(f.size)?f.size[p]:f.size,v.tc=Array.isArray(f.color)?f.color[p]:f.color,v.tf=Array.isArray(f.family)?f.family[p]:f.family);var y=t.marker;y&&(v.ms=g.isArrayOrTypedArray(y.size)?y.size[p]:y.size,v.mo=g.isArrayOrTypedArray(y.opacity)?y.opacity[p]:y.opacity,v.mx=g.isArrayOrTypedArray(y.symbol)?y.symbol[p]:y.symbol,v.ma=g.isArrayOrTypedArray(y.angle)?y.angle[p]:y.angle,v.mc=g.isArrayOrTypedArray(y.color)?y.color[p]:y.color);var o=y&&y.line;o&&(v.mlc=Array.isArray(o.color)?o.color[p]:o.color,v.mlw=g.isArrayOrTypedArray(o.width)?o.width[p]:o.width);var m=y&&y.gradient;m&&m.type!=="none"&&(v.mgt=Array.isArray(m.type)?m.type[p]:m.type,v.mgc=Array.isArray(m.color)?m.color[p]:m.color);var l=c.c2p(v.x,!0),w=s.c2p(v.y,!0),_=v.mrc||1,h=t.hoverlabel;h&&(v.hbg=Array.isArray(h.bgcolor)?h.bgcolor[p]:h.bgcolor,v.hbc=Array.isArray(h.bordercolor)?h.bordercolor[p]:h.bordercolor,v.hts=g.isArrayOrTypedArray(h.font.size)?h.font.size[p]:h.font.size,v.htc=Array.isArray(h.font.color)?h.font.color[p]:h.font.color,v.htf=Array.isArray(h.font.family)?h.font.family[p]:h.font.family,v.hnl=g.isArrayOrTypedArray(h.namelength)?h.namelength[p]:h.namelength);var b=t.hoverinfo;b&&(v.hi=Array.isArray(b)?b[p]:b);var u=t.hovertemplate;u&&(v.ht=Array.isArray(u)?u[p]:u);var L={};L[a.index]=v;var T=t._origX,k=t._origY,P=g.extendFlat({},a,{color:S(t,v),x0:l-_,x1:l+_,xLabelVal:T?T[p]:v.x,y0:w-_,y1:w+_,yLabelVal:k?k[p]:v.y,cd:L,distance:i,spikeDistance:x,hovertemplate:v.ht});return v.htx?P.text=v.htx:v.tx?P.text=v.tx:t.text&&(P.text=t.text),g.fillText(v,t,P),A.getComponentMethod("errorbars","hoverInfo")(v,t,P),P}ee.exports={hoverPoints:M,calcHover:e}},{"../../lib":515,"../../registry":647,"../scatter/get_trace_color":946}],998:[function(d,ee,te){arguments[4][905][0].apply(te,arguments)},{"./base_index":989,"./plot":999,dup:905}],999:[function(d,ee,x){var A=d("regl-scatter2d"),g=d("regl-line2d"),S=d("regl-error2d"),M=d("gl-text"),e=d("../../lib"),a=d("../../components/dragelement/helpers").selectMode,n=d("../../lib/prepare_regl"),r=d("../scatter/subtypes"),t=d("../scatter/link_traces"),c=d("./edit_style").styleTextSelection,s={};function i(p,v,f,y){var o=p._size,m=p.width*y,l=p.height*y,w=o.l*y,_=o.b*y,h=o.r*y,b=o.t*y,u=o.w*y,L=o.h*y;return[w+v.domain[0]*u,_+f.domain[0]*L,m-h-(1-v.domain[1])*u,l-b-(1-f.domain[1])*L]}var x=ee.exports=function(v,f,y){if(!!y.length){var o=v._fullLayout,m=f._scene,l=f.xaxis,w=f.yaxis,_,h;if(!!m){var b=n(v,["ANGLE_instanced_arrays","OES_element_index_uint"],s);if(!b){m.init();return}var u=m.count,L=o._glcanvas.data()[0].regl;if(t(v,f,y),m.dirty){if(m.error2d===!0&&(m.error2d=S(L)),m.line2d===!0&&(m.line2d=g(L)),m.scatter2d===!0&&(m.scatter2d=A(L)),m.fill2d===!0&&(m.fill2d=g(L)),m.glText===!0)for(m.glText=new Array(u),_=0;_<u;_++)m.glText[_]=new M(L);if(m.glText){if(u>m.glText.length){var T=u-m.glText.length;for(_=0;_<T;_++)m.glText.push(new M(L))}else if(u<m.glText.length){var k=m.glText.length-u,P=m.glText.splice(u,k);P.forEach(function(X){X.destroy()})}for(_=0;_<u;_++)m.glText[_].update(m.textOptions[_])}if(m.line2d&&(m.line2d.update(m.lineOptions),m.lineOptions=m.lineOptions.map(function(X){if(X&&X.positions){for(var Q=X.positions,ie=0;ie<Q.length&&(isNaN(Q[ie])||isNaN(Q[ie+1]));)ie+=2;for(var se=Q.length-2;se>ie&&(isNaN(Q[se])||isNaN(Q[se+1]));)se-=2;X.positions=Q.slice(ie,se+2)}return X}),m.line2d.update(m.lineOptions)),m.error2d){var z=(m.errorXOptions||[]).concat(m.errorYOptions||[]);m.error2d.update(z)}m.scatter2d&&m.scatter2d.update(m.markerOptions),m.fillOrder=e.repeat(null,u),m.fill2d&&(m.fillOptions=m.fillOptions.map(function(X,Q){var ie=y[Q];if(!(!X||!ie||!ie[0]||!ie[0].trace)){var se=ie[0],ae=se.trace,oe=se.t,be=m.lineOptions[Q],ce,de,ye=[];ae._ownfill&&ye.push(Q),ae._nexttrace&&ye.push(Q+1),ye.length&&(m.fillOrder[Q]=ye);var ge=[],me=be&&be.positions||oe.positions,Ee,Pe;if(ae.fill==="tozeroy"){for(Ee=0;Ee<me.length&&isNaN(me[Ee+1]);)Ee+=2;for(Pe=me.length-2;Pe>Ee&&isNaN(me[Pe+1]);)Pe-=2;me[Ee+1]!==0&&(ge=[me[Ee],0]),ge=ge.concat(me.slice(Ee,Pe+2)),me[Pe+1]!==0&&(ge=ge.concat([me[Pe],0]))}else if(ae.fill==="tozerox"){for(Ee=0;Ee<me.length&&isNaN(me[Ee]);)Ee+=2;for(Pe=me.length-2;Pe>Ee&&isNaN(me[Pe]);)Pe-=2;me[Ee]!==0&&(ge=[0,me[Ee+1]]),ge=ge.concat(me.slice(Ee,Pe+2)),me[Pe]!==0&&(ge=ge.concat([0,me[Pe+1]]))}else if(ae.fill==="toself"||ae.fill==="tonext"){for(ge=[],ce=0,X.splitNull=!0,de=0;de<me.length;de+=2)(isNaN(me[de])||isNaN(me[de+1]))&&(ge=ge.concat(me.slice(ce,de)),ge.push(me[ce],me[ce+1]),ge.push(null,null),ce=de+2);ge=ge.concat(me.slice(ce)),ce&&ge.push(me[ce],me[ce+1])}else{var Ne=ae._nexttrace;if(Ne){var we=m.lineOptions[Q+1];if(we){var ke=we.positions;if(ae.fill==="tonexty"){for(ge=me.slice(),Q=Math.floor(ke.length/2);Q--;){var Xe=ke[Q*2],He=ke[Q*2+1];isNaN(Xe)||isNaN(He)||ge.push(Xe,He)}X.fill=Ne.fillcolor}}}}if(ae._prevtrace&&ae._prevtrace.fill==="tonext"){var Ie=m.lineOptions[Q-1].positions,De=ge.length/2;ce=De;var Ge=[ce];for(de=0;de<Ie.length;de+=2)(isNaN(Ie[de])||isNaN(Ie[de+1]))&&(Ge.push(de/2+De+1),ce=de+2);ge=ge.concat(Ie),X.hole=Ge}return X.fillmode=ae.fill,X.opacity=ae.opacity,X.positions=ge,X}}),m.fill2d.update(m.fillOptions))}var I=o.dragmode,D=a(I),R=o.clickmode.indexOf("select")>-1;for(_=0;_<u;_++){var O=y[_][0],F=O.trace,N=O.t,G=N.index,K=F._length,W=N.x,Y=N.y;if(F.selectedpoints||D||R){if(D||(D=!0),F.selectedpoints){var re=m.selectBatch[G]=e.selIndices2selPoints(F),ue={};for(h=0;h<re.length;h++)ue[re[h]]=1;var j=[];for(h=0;h<K;h++)ue[h]||j.push(h);m.unselectBatch[G]=j}var q=N.xpx=new Array(K),V=N.ypx=new Array(K);for(h=0;h<K;h++)q[h]=l.c2p(W[h]),V[h]=w.c2p(Y[h])}else N.xpx=N.ypx=null}if(D){if(m.select2d||(m.select2d=A(o._glcanvas.data()[1].regl)),m.scatter2d){var U=new Array(u);for(_=0;_<u;_++)U[_]=m.selectBatch[_].length||m.unselectBatch[_].length?m.markerUnselectedOptions[_]:{};m.scatter2d.update(U)}m.select2d&&(m.select2d.update(m.markerOptions),m.select2d.update(m.markerSelectedOptions)),m.glText&&y.forEach(function(X){var Q=((X||[])[0]||{}).trace||{};r.hasText(Q)&&c(X)})}else m.scatter2d&&m.scatter2d.update(m.markerOptions);var $={viewport:i(o,l,w,v._context.plotGlPixelRatio),range:[(l._rl||l.range)[0],(w._rl||w.range)[0],(l._rl||l.range)[1],(w._rl||w.range)[1]]},ne=e.repeat($,m.count);m.fill2d&&m.fill2d.update(ne),m.line2d&&m.line2d.update(ne),m.error2d&&m.error2d.update(ne.concat(ne)),m.scatter2d&&m.scatter2d.update(ne),m.select2d&&m.select2d.update(ne),m.glText&&m.glText.forEach(function(X){X.update($)})}}};x.reglPrecompiled=s},{"../../components/dragelement/helpers":385,"../../lib":515,"../../lib/prepare_regl":528,"../scatter/link_traces":952,"../scatter/subtypes":961,"./edit_style":994,"gl-text":225,"regl-error2d":280,"regl-line2d":281,"regl-scatter2d":282}],1e3:[function(d,ee,te){var A=d("../../lib");ee.exports=function(S,M){var e=M._scene,a={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},n={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return M._scene||(e=M._scene={},e.init=function(){A.extendFlat(e,n,a)},e.init(),e.update=function(t){var c=A.repeat(t,e.count);if(e.fill2d&&e.fill2d.update(c),e.scatter2d&&e.scatter2d.update(c),e.line2d&&e.line2d.update(c),e.error2d&&e.error2d.update(c.concat(c)),e.select2d&&e.select2d.update(c),e.glText)for(var s=0;s<e.count;s++)e.glText[s].update(t)},e.draw=function(){for(var t=e.count,c=e.fill2d,s=e.error2d,i=e.line2d,x=e.scatter2d,p=e.glText,v=e.select2d,f=e.selectBatch,y=e.unselectBatch,o=0;o<t;o++){if(c&&e.fillOrder[o]&&c.draw(e.fillOrder[o]),i&&e.lineOptions[o]&&i.draw(o),s&&(e.errorXOptions[o]&&s.draw(o),e.errorYOptions[o]&&s.draw(o+t)),x&&e.markerOptions[o])if(y[o].length){var m=A.repeat([],e.count);m[o]=y[o],x.draw(m)}else f[o].length||x.draw(o);p[o]&&e.textOptions[o]&&p[o].render()}v&&v.draw(f),e.dirty=!1},e.destroy=function(){e.fill2d&&e.fill2d.destroy&&e.fill2d.destroy(),e.scatter2d&&e.scatter2d.destroy&&e.scatter2d.destroy(),e.error2d&&e.error2d.destroy&&e.error2d.destroy(),e.line2d&&e.line2d.destroy&&e.line2d.destroy(),e.select2d&&e.select2d.destroy&&e.select2d.destroy(),e.glText&&e.glText.forEach(function(t){t.destroy&&t.destroy()}),e.lineOptions=null,e.fillOptions=null,e.markerOptions=null,e.markerSelectedOptions=null,e.markerUnselectedOptions=null,e.errorXOptions=null,e.errorYOptions=null,e.textOptions=null,e.textSelectedOptions=null,e.textUnselectedOptions=null,e.selectBatch=null,e.unselectBatch=null,M._scene=null}),e.dirty||A.extendFlat(e,a),e}},{"../../lib":515}],1001:[function(d,ee,te){var A=d("../scatter/subtypes"),g=d("./edit_style").styleTextSelection;ee.exports=function(M,e){var a=M.cd,n=M.xaxis,r=M.yaxis,t=[],c=a[0].trace,s=a[0].t,i=c._length,x=s.x,p=s.y,v=s._scene,f=s.index;if(!v)return t;var y=A.hasText(c),o=A.hasMarkers(c),m=!o&&!y;if(c.visible!==!0||m)return t;var l=[],w=[];if(e!==!1&&!e.degenerate)for(var _=0;_<i;_++)e.contains([s.xpx[_],s.ypx[_]],!1,_,M)?(l.push(_),t.push({pointNumber:_,x:n.c2d(x[_]),y:r.c2d(p[_])})):w.push(_);if(o){var h=v.scatter2d;if(!l.length&&!w.length){var b=new Array(v.count);b[f]=v.markerOptions[f],h.update.apply(h,b)}else if(!v.selectBatch[f].length&&!v.unselectBatch[f].length){var u=new Array(v.count);u[f]=v.markerUnselectedOptions[f],h.update.apply(h,u)}}return v.selectBatch[f]=l,v.unselectBatch[f]=w,y&&g(a),t}},{"../scatter/subtypes":961,"./edit_style":994}],1002:[function(d,ee,te){var A=d("../../plots/template_attributes").hovertemplateAttrs,g=d("../../plots/template_attributes").texttemplateAttrs,S=d("../scattergeo/attributes"),M=d("../scatter/attributes"),e=d("../../plots/mapbox/layout_attributes"),a=d("../../plots/attributes"),n=d("../../components/colorscale/attributes"),r=d("../../lib/extend").extendFlat,t=d("../../plot_api/edit_types").overrideAll,c=d("../../plots/mapbox/layout_attributes"),s=S.line,i=S.marker;ee.exports=t({lon:S.lon,lat:S.lat,cluster:{enabled:{valType:"boolean"},maxzoom:r({},c.layers.maxzoom,{}),step:{valType:"number",arrayOk:!0,dflt:-1,min:-1},size:{valType:"number",arrayOk:!0,dflt:20,min:0},color:{valType:"color",arrayOk:!0},opacity:r({},i.opacity,{dflt:1})},mode:r({},M.mode,{dflt:"markers"}),text:r({},M.text,{}),texttemplate:g({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:r({},M.hovertext,{}),line:{color:s.color,width:s.width},connectgaps:M.connectgaps,marker:r({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:i.opacity,size:i.size,sizeref:i.sizeref,sizemin:i.sizemin,sizemode:i.sizemode},n("marker")),fill:S.fill,fillcolor:M.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:M.selected.marker},unselected:{marker:M.unselected.marker},hoverinfo:r({},a.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:A()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/mapbox/layout_attributes":624,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergeo/attributes":978}],1003:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../lib"),S=d("../../constants/numerical").BADNUM,M=d("../../lib/geojson_utils"),e=d("../../components/colorscale"),a=d("../../components/drawing"),n=d("../scatter/make_bubble_size_func"),r=d("../scatter/subtypes"),t=d("../../plots/mapbox/convert_text_opts"),c=d("../../components/fx/helpers").appendArrayPointValue,s=d("../../lib/svg_text_utils").NEWLINES,i=d("../../lib/svg_text_utils").BR_TAG_ALL;ee.exports=function(w,_){var h=_[0].trace,b=h.visible===!0&&h._length!==0,u=h.fill!=="none",L=r.hasLines(h),T=r.hasMarkers(h),k=r.hasText(h),P=T&&h.marker.symbol==="circle",z=T&&h.marker.symbol!=="circle",I=h.cluster&&h.cluster.enabled,D=x("fill"),R=x("line"),O=x("circle"),F=x("symbol"),N={fill:D,line:R,circle:O,symbol:F};if(!b)return N;var G;if((u||L)&&(G=M.calcTraceToLineCoords(_)),u&&(D.geojson=M.makePolygon(G),D.layout.visibility="visible",g.extendFlat(D.paint,{"fill-color":h.fillcolor})),L&&(R.geojson=M.makeLine(G),R.layout.visibility="visible",g.extendFlat(R.paint,{"line-width":h.line.width,"line-color":h.line.color,"line-opacity":h.opacity})),P){var K=p(_);O.geojson=K.geojson,O.layout.visibility="visible",I&&(O.filter=["!",["has","point_count"]],N.cluster={type:"circle",filter:["has","point_count"],layout:{visibility:"visible"},paint:{"circle-color":m(h.cluster.color,h.cluster.step),"circle-radius":m(h.cluster.size,h.cluster.step),"circle-opacity":m(h.cluster.opacity,h.cluster.step)}},N.clusterCount={type:"symbol",filter:["has","point_count"],paint:{},layout:{"text-field":"{point_count_abbreviated}","text-font":["Open Sans Regular","Arial Unicode MS Regular"],"text-size":12}}),g.extendFlat(O.paint,{"circle-color":K.mcc,"circle-radius":K.mrc,"circle-opacity":K.mo})}if(P&&I&&(O.filter=["!",["has","point_count"]]),(z||k)&&(F.geojson=v(_,w),g.extendFlat(F.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),z&&(g.extendFlat(F.layout,{"icon-size":h.marker.size/10}),"angle"in h.marker&&h.marker.angle!=="auto"&&g.extendFlat(F.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),F.layout["icon-allow-overlap"]=h.marker.allowoverlap,g.extendFlat(F.paint,{"icon-opacity":h.opacity*h.marker.opacity,"icon-color":h.marker.color})),k)){var W=(h.marker||{}).size,Y=t(h.textposition,W);g.extendFlat(F.layout,{"text-size":h.textfont.size,"text-anchor":Y.anchor,"text-offset":Y.offset}),g.extendFlat(F.paint,{"text-color":h.textfont.color,"text-opacity":h.opacity})}return N};function x(l){return{type:l,geojson:M.makeBlank(),layout:{visibility:"none"},filter:null,paint:{}}}function p(l){var w=l[0].trace,_=w.marker,h=w.selectedpoints,b=g.isArrayOrTypedArray(_.color),u=g.isArrayOrTypedArray(_.size),L=g.isArrayOrTypedArray(_.opacity),T;function k(W){return w.opacity*W}function P(W){return W/2}var z;b&&(e.hasColorscale(w,"marker")?z=e.makeColorScaleFuncFromTrace(_):z=g.identity);var I;u&&(I=n(w));var D;L&&(D=function(W){var Y=A(W)?+g.constrain(W,0,1):0;return k(Y)});var R=[];for(T=0;T<l.length;T++){var O=l[T],F=O.lonlat;if(!o(F)){var N={};z&&(N.mcc=O.mcc=z(O.mc)),I&&(N.mrc=O.mrc=I(O.ms)),D&&(N.mo=D(O.mo)),h&&(N.selected=O.selected||0),R.push({type:"Feature",id:T+1,geometry:{type:"Point",coordinates:F},properties:N})}}var G;if(h)for(G=a.makeSelectedPointStyleFns(w),T=0;T<R.length;T++){var K=R[T].properties;G.selectedOpacityFn&&(K.mo=k(G.selectedOpacityFn(K))),G.selectedColorFn&&(K.mcc=G.selectedColorFn(K)),G.selectedSizeFn&&(K.mrc=G.selectedSizeFn(K))}return{geojson:{type:"FeatureCollection",features:R},mcc:b||G&&G.selectedColorFn?{type:"identity",property:"mcc"}:_.color,mrc:u||G&&G.selectedSizeFn?{type:"identity",property:"mrc"}:P(_.size),mo:L||G&&G.selectedOpacityFn?{type:"identity",property:"mo"}:k(_.opacity)}}function v(l,w){for(var _=w._fullLayout,h=l[0].trace,b=h.marker||{},u=b.symbol,L=b.angle,T=u!=="circle"?f(u):y,k=L!=="auto"?f(L,!0):y,P=r.hasText(h)?f(h.text):y,z=[],I=0;I<l.length;I++){var D=l[I];if(!o(D.lonlat)){var R=h.texttemplate,O;if(R){var F=Array.isArray(R)?R[I]||"":R,N=h._module.formatLabels(D,h,_),G={};c(G,h,D.i);var K=h._meta||{};O=g.texttemplateString(F,N,_._d3locale,G,D,K)}else O=P(I);O&&(O=O.replace(s,"").replace(i,`
`)),z.push({type:"Feature",geometry:{type:"Point",coordinates:D.lonlat},properties:{symbol:T(I),angle:k(I),text:O}})}}return{type:"FeatureCollection",features:z}}function f(l,w){return g.isArrayOrTypedArray(l)?w?function(_){return A(l[_])?+l[_]:0}:function(_){return l[_]}:l?function(){return l}:y}function y(){return""}function o(l){return l[0]===S}function m(l,w){var _;if(g.isArrayOrTypedArray(l)&&g.isArrayOrTypedArray(w)){_=["step",["get","point_count"],l[0]];for(var h=1;h<l.length;h++)_.push(w[h-1],l[h])}else _=l;return _}},{"../../components/colorscale":379,"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"../../lib/svg_text_utils":541,"../../plots/mapbox/convert_text_opts":621,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"fast-isnumeric":190}],1004:[function(d,ee,te){var A=d("../../lib"),g=d("../scatter/subtypes"),S=d("../scatter/marker_defaults"),M=d("../scatter/line_defaults"),e=d("../scatter/text_defaults"),a=d("../scatter/fillcolor_defaults"),n=d("./attributes");ee.exports=function(c,s,i,x){function p(b,u){return A.coerce(c,s,n,b,u)}function v(b,u){return A.coerce2(c,s,n,b,u)}var f=r(c,s,p);if(!f){s.visible=!1;return}if(p("text"),p("texttemplate"),p("hovertext"),p("hovertemplate"),p("mode"),p("below"),g.hasLines(s)&&(M(c,s,i,x,p,{noDash:!0}),p("connectgaps")),g.hasMarkers(s)){S(c,s,i,x,p,{noLine:!0,noAngle:!0}),p("marker.allowoverlap"),p("marker.angle");var y=s.marker;y.symbol!=="circle"&&(A.isArrayOrTypedArray(y.size)&&(y.size=y.size[0]),A.isArrayOrTypedArray(y.color)&&(y.color=y.color[0]))}var o=v("cluster.maxzoom"),m=v("cluster.step"),l=v("cluster.color",s.marker&&s.marker.color||i),w=v("cluster.size"),_=v("cluster.opacity"),h=o!==!1||m!==!1||l!==!1||w!==!1||_!==!1;p("cluster.enabled",h),g.hasText(s)&&e(c,s,x,p,{noSelect:!0}),p("fill"),s.fill!=="none"&&a(c,s,i,p),A.coerceSelectionMarkerOpacity(s,p)};function r(t,c,s){var i=s("lon")||[],x=s("lat")||[],p=Math.min(i.length,x.length);return c._length=p,p}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1002}],1005:[function(d,ee,te){ee.exports=function(g,S){return g.lon=S.lon,g.lat=S.lat,g}},{}],1006:[function(d,ee,te){var A=d("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n=e[M.subplot]._subplot,r=n.mockAxis,t=S.lonlat;return a.lonLabel=A.tickText(r,r.c2l(t[0]),!0).text,a.latLabel=A.tickText(r,r.c2l(t[1]),!0).text,a}},{"../../plots/cartesian/axes":566}],1007:[function(d,ee,te){var A=d("../../components/fx"),g=d("../../lib"),S=d("../scatter/get_trace_color"),M=g.fillText,e=d("../../constants/numerical").BADNUM,a=d("../../plots/mapbox/constants").traceLayerPrefix;function n(t,c,s){var i=t.cd,x=i[0].trace,p=t.xa,v=t.ya,f=t.subplot,y=[],o=a+x.uid+"-circle",m=x.cluster&&x.cluster.enabled;if(m){var l=f.map.queryRenderedFeatures(null,{layers:[o]});y=l.map(function(R){return R.id})}var w=c>=0?Math.floor((c+180)/360):Math.ceil((c-180)/360),_=w*360,h=c-_;function b(R){var O=R.lonlat;if(O[0]===e||m&&y.indexOf(R.i+1)===-1)return 1/0;var F=g.modHalf(O[0],360),N=O[1],G=f.project([F,N]),K=G.x-p.c2p([h,N]),W=G.y-v.c2p([F,s]),Y=Math.max(3,R.mrc||0);return Math.max(Math.sqrt(K*K+W*W)-Y,1-3/Y)}if(A.getClosest(i,b,t),t.index!==!1){var u=i[t.index],L=u.lonlat,T=[g.modHalf(L[0],360)+_,L[1]],k=p.c2p(T),P=v.c2p(T),z=u.mrc||1;t.x0=k-z,t.x1=k+z,t.y0=P-z,t.y1=P+z;var I={};I[x.subplot]={_subplot:f};var D=x._module.formatLabels(u,x,I);return t.lonLabel=D.lonLabel,t.latLabel=D.latLabel,t.color=S(x,u),t.extraText=r(x,u,i[0].t.labels),t.hovertemplate=x.hovertemplate,[t]}}function r(t,c,s){if(t.hovertemplate)return;var i=c.hi||t.hoverinfo,x=i.split("+"),p=x.indexOf("all")!==-1,v=x.indexOf("lon")!==-1,f=x.indexOf("lat")!==-1,y=c.lonlat,o=[];function m(l){return l+"\xB0"}return p||v&&f?o.push("("+m(y[1])+", "+m(y[0])+")"):v?o.push(s.lon+m(y[0])):f&&o.push(s.lat+m(y[1])),(p||x.indexOf("text")!==-1)&&M(c,t,o),o.join("<br>")}ee.exports={hoverPoints:n,getExtraText:r}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/mapbox/constants":620,"../scatter/get_trace_color":946}],1008:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("../scattergeo/calc"),plot:d("./plot"),hoverPoints:d("./hover").hoverPoints,eventData:d("./event_data"),selectPoints:d("./select"),styleOnSelect:function(A,g){if(g){var S=g[0].trace;S._glTrace.update(g)}},moduleType:"trace",name:"scattermapbox",basePlotModule:d("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":622,"../scatter/marker_colorbar":954,"../scattergeo/calc":979,"./attributes":1002,"./defaults":1004,"./event_data":1005,"./format_labels":1006,"./hover":1007,"./plot":1009,"./select":1010}],1009:[function(d,ee,te){var A=d("../../lib"),g=d("./convert"),S=d("../../plots/mapbox/constants").traceLayerPrefix,M={cluster:["cluster","clusterCount","circle"],nonCluster:["fill","line","circle","symbol"]};function e(n,r,t){this.type="scattermapbox",this.subplot=n,this.uid=r,this.clusterEnabled=t,this.sourceIds={fill:"source-"+r+"-fill",line:"source-"+r+"-line",circle:"source-"+r+"-circle",symbol:"source-"+r+"-symbol",cluster:"source-"+r+"-circle",clusterCount:"source-"+r+"-circle"},this.layerIds={fill:S+r+"-fill",line:S+r+"-line",circle:S+r+"-circle",symbol:S+r+"-symbol",cluster:S+r+"-cluster",clusterCount:S+r+"-cluster-count"},this.below=null}var a=e.prototype;a.addSource=function(n,r,t){var c={type:"geojson",data:r.geojson};t&&t.enabled&&A.extendFlat(c,{cluster:!0,clusterMaxZoom:t.maxzoom}),this.subplot.map.addSource(this.sourceIds[n],c)},a.setSourceData=function(n,r){this.subplot.map.getSource(this.sourceIds[n]).setData(r.geojson)},a.addLayer=function(n,r,t){var c={type:r.type,id:this.layerIds[n],source:this.sourceIds[n],layout:r.layout,paint:r.paint};r.filter&&(c.filter=r.filter),this.subplot.addLayer(c,t)},a.update=function(r){var t=r[0].trace,c=this.subplot,s=c.map,i=g(c.gd,r),x=c.belowLookup["trace-"+this.uid],p,v,f,y=!!(t.cluster&&t.cluster.enabled),o=!!this.clusterEnabled;if(x!==this.below){var m=M.nonCluster;for(p=m.length-1;p>=0;p--)v=m[p],s.removeLayer(this.layerIds[v]);for(p=0;p<m.length;p++)v=m[p],f=i[v],this.addLayer(v,f,x);this.below=x}else if(y&&!o){for(p=M.nonCluster.length-1;p>=0;p--)v=M.nonCluster[p],s.removeLayer(this.layerIds[v]),s.removeSource(this.sourceIds[v]);for(this.addSource("circle",i.circle,t.cluster),p=0;p<M.cluster.length;p++)v=M.cluster[p],f=i[v],this.addLayer(v,f,x);this.clusterEnabled=y}else if(!y&&o){for(p=0;p<M.cluster.length;p++)v=M.cluster[p],s.removeLayer(this.layerIds[v]);for(s.removeSource(this.sourceIds.circle),p=0;p<M.nonCluster.length;p++)v=M.nonCluster[p],f=i[v],this.addSource(v,f,t.cluster),this.addLayer(v,f,x);this.clusterEnabled=y}r[0].trace._glTrace=this},a.dispose=function(){for(var r=this.subplot.map,t=this.clusterEnabled?M.cluster:M.nonCluster,c=t.length-1;c>=0;c--){var s=t[c];r.removeLayer(this.layerIds[s]),r.removeSource(this.sourceIds[s])}},ee.exports=function(r,t){var c=t[0].trace,s=c.cluster&&c.cluster.enabled,i=new e(r,c.uid,s),x=g(r.gd,t),p=i.below=r.belowLookup["trace-"+c.uid],v,f,y;if(s)for(i.addSource("circle",x.circle,c.cluster),v=0;v<M.cluster.length;v++)f=M.cluster[v],y=x[f],i.addLayer(f,y,p);else for(v=0;v<M.nonCluster.length;v++)f=M.nonCluster[v],y=x[f],i.addSource(f,y,c.cluster),i.addLayer(f,y,p);return t[0].trace._glTrace=i,i}},{"../../lib":515,"../../plots/mapbox/constants":620,"./convert":1003}],1010:[function(d,ee,te){var A=d("../../lib"),g=d("../scatter/subtypes"),S=d("../../constants/numerical").BADNUM;ee.exports=function(e,a){var n=e.cd,r=e.xaxis,t=e.yaxis,c=[],s=n[0].trace,i;if(!g.hasMarkers(s))return[];if(a===!1)for(i=0;i<n.length;i++)n[i].selected=0;else for(i=0;i<n.length;i++){var x=n[i],p=x.lonlat;if(p[0]!==S){var v=[A.modHalf(p[0],360),p[1]],f=[r.c2p(v),t.c2p(v)];a.contains(f,null,i,e)?(c.push({pointNumber:i,lon:p[0],lat:p[1]}),x.selected=1):x.selected=0}}return c}},{"../../constants/numerical":491,"../../lib":515,"../scatter/subtypes":961}],1011:[function(d,ee,te){var A=d("../../plots/template_attributes").hovertemplateAttrs,g=d("../../plots/template_attributes").texttemplateAttrs,S=d("../../lib/extend").extendFlat,M=d("../scatter/attributes"),e=d("../../plots/attributes"),a=M.line;ee.exports={mode:M.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:M.text,texttemplate:g({editType:"plot"},{keys:["r","theta","text"]}),hovertext:M.hovertext,line:{color:a.color,width:a.width,dash:a.dash,backoff:a.backoff,shape:S({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:M.connectgaps,marker:M.marker,cliponaxis:S({},M.cliponaxis,{dflt:!1}),textposition:M.textposition,textfont:M.textfont,fill:S({},M.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:M.fillcolor,hoverinfo:S({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:M.hoveron,hovertemplate:A(),selected:M.selected,unselected:M.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1012:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../constants/numerical").BADNUM,S=d("../../plots/cartesian/axes"),M=d("../scatter/colorscale_calc"),e=d("../scatter/arrays_to_calcdata"),a=d("../scatter/calc_selection"),n=d("../scatter/calc").calcMarkerSize;ee.exports=function(t,c){for(var s=t._fullLayout,i=c.subplot,x=s[i].radialaxis,p=s[i].angularaxis,v=x.makeCalcdata(c,"r"),f=p.makeCalcdata(c,"theta"),y=c._length,o=new Array(y),m=0;m<y;m++){var l=v[m],w=f[m],_=o[m]={};A(l)&&A(w)?(_.r=l,_.theta=w):_.r=g}var h=n(c,y);return c._extremes.x=S.findExtremes(x,v,{ppad:h}),M(t,c),e(o,c),a(o,c),o}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1013:[function(d,ee,te){var A=d("../../lib"),g=d("../scatter/subtypes"),S=d("../scatter/marker_defaults"),M=d("../scatter/line_defaults"),e=d("../scatter/line_shape_defaults"),a=d("../scatter/text_defaults"),n=d("../scatter/fillcolor_defaults"),r=d("../scatter/constants").PTS_LINESONLY,t=d("./attributes");function c(i,x,p,v){function f(m,l){return A.coerce(i,x,t,m,l)}var y=s(i,x,v,f);if(!y){x.visible=!1;return}f("thetaunit"),f("mode",y<r?"lines+markers":"lines"),f("text"),f("hovertext"),x.hoveron!=="fills"&&f("hovertemplate"),g.hasLines(x)&&(M(i,x,p,v,f,{backoff:!0}),e(i,x,f),f("connectgaps")),g.hasMarkers(x)&&S(i,x,p,v,f,{gradient:!0}),g.hasText(x)&&(f("texttemplate"),a(i,x,v,f));var o=[];(g.hasMarkers(x)||g.hasText(x))&&(f("cliponaxis"),f("marker.maxdisplayed"),o.push("points")),f("fill"),x.fill!=="none"&&(n(i,x,p,f),g.hasLines(x)||e(i,x,f)),(x.fill==="tonext"||x.fill==="toself")&&o.push("fills"),f("hoveron",o.join("+")||"points"),A.coerceSelectionMarkerOpacity(x,f)}function s(i,x,p,v){var f=v("r"),y=v("theta"),o;if(f)y?o=Math.min(f.length,y.length):(o=f.length,v("theta0"),v("dtheta"));else{if(!y)return 0;o=x.theta.length,v("r0"),v("dr")}return x._length=o,o}ee.exports={handleRThetaDefaults:s,supplyDefaults:c}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1011}],1014:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axes");ee.exports=function(M,e,a){var n={},r=a[e.subplot]._subplot,t,c;r?(t=r.radialAxis,c=r.angularAxis):(r=a[e.subplot],t=r.radialaxis,c=r.angularaxis);var s=t.c2l(M.r);n.rLabel=g.tickText(t,s,!0).text;var i=c.thetaunit==="degrees"?A.rad2deg(M.theta):M.theta;return n.thetaLabel=g.tickText(c,i,!0).text,n}},{"../../lib":515,"../../plots/cartesian/axes":566}],1015:[function(d,ee,te){var A=d("../scatter/hover");function g(M,e,a,n){var r=A(M,e,a,n);if(!(!r||r[0].index===!1)){var t=r[0];if(t.index===void 0)return r;var c=M.subplot,s=t.cd[t.index],i=t.trace;if(!!c.isPtInside(s))return t.xLabelVal=void 0,t.yLabelVal=void 0,S(s,i,c,t),t.hovertemplate=i.hovertemplate,r}}function S(M,e,a,n){var r=a.radialAxis,t=a.angularAxis;r._hovertitle="r",t._hovertitle="\u03B8";var c={};c[e.subplot]={_subplot:a};var s=e._module.formatLabels(M,e,c);n.rLabel=s.rLabel,n.thetaLabel=s.thetaLabel;var i=M.hi||e.hoverinfo,x=[];function p(f,y){x.push(f._hovertitle+": "+y)}if(!e.hovertemplate){var v=i.split("+");v.indexOf("all")!==-1&&(v=["r","theta","text"]),v.indexOf("r")!==-1&&p(r,n.rLabel),v.indexOf("theta")!==-1&&p(t,n.thetaLabel),v.indexOf("text")!==-1&&n.text&&(x.push(n.text),delete n.text),n.extraText=x.join("<br>")}}ee.exports={hoverPoints:g,makeHoverPointText:S}},{"../scatter/hover":947}],1016:[function(d,ee,te){ee.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:d("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),plot:d("./plot"),style:d("../scatter/style").style,styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover").hoverPoints,selectPoints:d("../scatter/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1011,"./calc":1012,"./defaults":1013,"./format_labels":1014,"./hover":1015,"./plot":1017}],1017:[function(d,ee,te){var A=d("../scatter/plot"),g=d("../../constants/numerical").BADNUM;ee.exports=function(M,e,a){for(var n=e.layers.frontplot.select("g.scatterlayer"),r=e.xaxis,t=e.yaxis,c={xaxis:r,yaxis:t,plot:e.framework,layerClipId:e._hasClipOnAxisFalse?e.clipIds.forTraces:null},s=e.radialAxis,i=e.angularAxis,x=0;x<a.length;x++)for(var p=a[x],v=0;v<p.length;v++){v===0&&(p[0].trace._xA=r,p[0].trace._yA=t);var f=p[v],y=f.r;if(y===g)f.x=f.y=g;else{var o=s.c2g(y),m=i.c2g(f.theta);f.x=o*Math.cos(m),f.y=o*Math.sin(m)}}A(M,c,a,n)}},{"../../constants/numerical":491,"../scatter/plot":957}],1018:[function(d,ee,te){var A=d("../scatterpolar/attributes"),g=d("../scattergl/attributes"),S=d("../../plots/template_attributes").texttemplateAttrs;ee.exports={mode:A.mode,r:A.r,theta:A.theta,r0:A.r0,dr:A.dr,theta0:A.theta0,dtheta:A.dtheta,thetaunit:A.thetaunit,text:A.text,texttemplate:S({editType:"plot"},{keys:["r","theta","text"]}),hovertext:A.hovertext,hovertemplate:A.hovertemplate,line:g.line,connectgaps:g.connectgaps,marker:g.marker,fill:g.fill,fillcolor:g.fillcolor,textposition:g.textposition,textfont:g.textfont,hoverinfo:A.hoverinfo,selected:A.selected,unselected:A.unselected}},{"../../plots/template_attributes":642,"../scattergl/attributes":988,"../scatterpolar/attributes":1011}],1019:[function(d,ee,te){ee.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:d("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),hoverPoints:d("./hover").hoverPoints,selectPoints:d("../scattergl/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scattergl/select":1001,"./attributes":1018,"./calc":1020,"./defaults":1021,"./format_labels":1022,"./hover":1023}],1020:[function(d,ee,te){var A=d("../scatter/colorscale_calc"),g=d("../scatter/calc").calcMarkerSize,S=d("../scattergl/convert"),M=d("../../plots/cartesian/axes"),e=d("../scattergl/constants").TOO_MANY_POINTS;ee.exports=function(n,r){var t=n._fullLayout,c=r.subplot,s=t[c].radialaxis,i=t[c].angularaxis,x=r._r=s.makeCalcdata(r,"r"),p=r._theta=i.makeCalcdata(r,"theta"),v=r._length,f={};v<x.length&&(x=x.slice(0,v)),v<p.length&&(p=p.slice(0,v)),f.r=x,f.theta=p,A(n,r);var y=f.opts=S.style(n,r),o;return v<e?o=g(r,v):y.marker&&(o=2*(y.marker.sizeAvg||Math.max(y.marker.size,3))),r._extremes.x=M.findExtremes(s,x,{ppad:o}),[{x:!1,y:!1,t:f,trace:r}]}},{"../../plots/cartesian/axes":566,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992}],1021:[function(d,ee,te){var A=d("../../lib"),g=d("../scatter/subtypes"),S=d("../scatterpolar/defaults").handleRThetaDefaults,M=d("../scatter/marker_defaults"),e=d("../scatter/line_defaults"),a=d("../scatter/text_defaults"),n=d("../scatter/fillcolor_defaults"),r=d("../scatter/constants").PTS_LINESONLY,t=d("./attributes");ee.exports=function(s,i,x,p){function v(y,o){return A.coerce(s,i,t,y,o)}var f=S(s,i,p,v);if(!f){i.visible=!1;return}v("thetaunit"),v("mode",f<r?"lines+markers":"lines"),v("text"),v("hovertext"),i.hoveron!=="fills"&&v("hovertemplate"),g.hasLines(i)&&(e(s,i,x,p,v),v("connectgaps")),g.hasMarkers(i)&&M(s,i,x,p,v,{noAngleRef:!0,noStandOff:!0}),g.hasText(i)&&(v("texttemplate"),a(s,i,p,v)),v("fill"),i.fill!=="none"&&n(s,i,x,v),A.coerceSelectionMarkerOpacity(i,v)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatterpolar/defaults":1013,"./attributes":1018}],1022:[function(d,ee,te){var A=d("../scatterpolar/format_labels");ee.exports=function(S,M,e){var a=S.i;return"r"in S||(S.r=M._r[a]),"theta"in S||(S.theta=M._theta[a]),A(S,M,e)}},{"../scatterpolar/format_labels":1014}],1023:[function(d,ee,te){var A=d("../scattergl/hover"),g=d("../scatterpolar/hover").makeHoverPointText;function S(M,e,a,n){var r=M.cd,t=r[0].t,c=t.r,s=t.theta,i=A.hoverPoints(M,e,a,n);if(!(!i||i[0].index===!1)){var x=i[0];if(x.index===void 0)return i;var p=M.subplot,v=x.cd[x.index],f=x.trace;if(v.r=c[x.index],v.theta=s[x.index],!!p.isPtInside(v))return x.xLabelVal=void 0,x.yLabelVal=void 0,g(v,f,p,x),i}}ee.exports={hoverPoints:S}},{"../scattergl/hover":997,"../scatterpolar/hover":1015}],1024:[function(d,ee,te){arguments[4][905][0].apply(te,arguments)},{"./base_index":1019,"./plot":1025,dup:905}],1025:[function(d,ee,te){var A=d("@plotly/point-cluster"),g=d("fast-isnumeric"),S=d("../scattergl/plot"),M=d("../scattergl/scene_update"),e=d("../scattergl/convert"),a=d("../../lib"),n=d("../scattergl/constants").TOO_MANY_POINTS,r={};ee.exports=function(c,s,i){if(!!i.length){var x=s.radialAxis,p=s.angularAxis,v=M(c,s);return i.forEach(function(f){if(!(!f||!f[0]||!f[0].trace)){var y=f[0],o=y.trace,m=y.t,l=o._length,w=m.r,_=m.theta,h=m.opts,b,u=w.slice(),L=_.slice();for(b=0;b<w.length;b++)s.isPtInside({r:w[b],theta:_[b]})||(u[b]=NaN,L[b]=NaN);var T=new Array(l*2),k=Array(l),P=Array(l);for(b=0;b<l;b++){var z=u[b],I,D;if(g(z)){var R=x.c2g(z),O=p.c2g(L[b],o.thetaunit);I=R*Math.cos(O),D=R*Math.sin(O)}else I=D=NaN;k[b]=T[b*2]=I,P[b]=T[b*2+1]=D}m.tree=A(T),h.marker&&l>=n&&(h.marker.cluster=m.tree),h.marker&&(h.markerSel.positions=h.markerUnsel.positions=h.marker.positions=T),h.line&&T.length>1&&a.extendFlat(h.line,e.linePositions(c,o,T)),h.text&&(a.extendFlat(h.text,{positions:T},e.textPosition(c,o,h.text,h.marker)),a.extendFlat(h.textSel,{positions:T},e.textPosition(c,o,h.text,h.markerSel)),a.extendFlat(h.textUnsel,{positions:T},e.textPosition(c,o,h.text,h.markerUnsel))),h.fill&&!v.fill2d&&(v.fill2d=!0),h.marker&&!v.scatter2d&&(v.scatter2d=!0),h.line&&!v.line2d&&(v.line2d=!0),h.text&&!v.glText&&(v.glText=!0),v.lineOptions.push(h.line),v.fillOptions.push(h.fill),v.markerOptions.push(h.marker),v.markerSelectedOptions.push(h.markerSel),v.markerUnselectedOptions.push(h.markerUnsel),v.textOptions.push(h.text),v.textSelectedOptions.push(h.textSel),v.textUnselectedOptions.push(h.textUnsel),v.selectBatch.push([]),v.unselectBatch.push([]),m.x=k,m.y=P,m.rawx=k,m.rawy=P,m.r=w,m.theta=_,m.positions=T,m._scene=v,m.index=v.count,v.count++}}),S(c,s,i)}},ee.exports.reglPrecompiled=r},{"../../lib":515,"../scattergl/constants":991,"../scattergl/convert":992,"../scattergl/plot":999,"../scattergl/scene_update":1e3,"@plotly/point-cluster":59,"fast-isnumeric":190}],1026:[function(d,ee,te){var A=d("../../plots/template_attributes").hovertemplateAttrs,g=d("../../plots/template_attributes").texttemplateAttrs,S=d("../../lib/extend").extendFlat,M=d("../scatter/attributes"),e=d("../../plots/attributes"),a=M.line;ee.exports={mode:M.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:M.text,texttemplate:g({editType:"plot"},{keys:["real","imag","text"]}),hovertext:M.hovertext,line:{color:a.color,width:a.width,dash:a.dash,backoff:a.backoff,shape:S({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:M.connectgaps,marker:M.marker,cliponaxis:S({},M.cliponaxis,{dflt:!1}),textposition:M.textposition,textfont:M.textfont,fill:S({},M.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:M.fillcolor,hoverinfo:S({},e.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:M.hoveron,hovertemplate:A(),selected:M.selected,unselected:M.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1027:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../../constants/numerical").BADNUM,S=d("../scatter/colorscale_calc"),M=d("../scatter/arrays_to_calcdata"),e=d("../scatter/calc_selection"),a=d("../scatter/calc").calcMarkerSize;ee.exports=function(r,t){for(var c=r._fullLayout,s=t.subplot,i=c[s].realaxis,x=c[s].imaginaryaxis,p=i.makeCalcdata(t,"real"),v=x.makeCalcdata(t,"imag"),f=t._length,y=new Array(f),o=0;o<f;o++){var m=p[o],l=v[o],w=y[o]={};A(m)&&A(l)?(w.real=m,w.imag=l):w.real=g}return a(t,f),S(r,t),M(y,t),e(y,t),y}},{"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1028:[function(d,ee,te){var A=d("../../lib"),g=d("../scatter/subtypes"),S=d("../scatter/marker_defaults"),M=d("../scatter/line_defaults"),e=d("../scatter/line_shape_defaults"),a=d("../scatter/text_defaults"),n=d("../scatter/fillcolor_defaults"),r=d("../scatter/constants").PTS_LINESONLY,t=d("./attributes");ee.exports=function(i,x,p,v){function f(m,l){return A.coerce(i,x,t,m,l)}var y=c(i,x,v,f);if(!y){x.visible=!1;return}f("mode",y<r?"lines+markers":"lines"),f("text"),f("hovertext"),x.hoveron!=="fills"&&f("hovertemplate"),g.hasLines(x)&&(M(i,x,p,v,f,{backoff:!0}),e(i,x,f),f("connectgaps")),g.hasMarkers(x)&&S(i,x,p,v,f,{gradient:!0}),g.hasText(x)&&(f("texttemplate"),a(i,x,v,f));var o=[];(g.hasMarkers(x)||g.hasText(x))&&(f("cliponaxis"),f("marker.maxdisplayed"),o.push("points")),f("fill"),x.fill!=="none"&&(n(i,x,p,f),g.hasLines(x)||e(i,x,f)),(x.fill==="tonext"||x.fill==="toself")&&o.push("fills"),f("hoveron",o.join("+")||"points"),A.coerceSelectionMarkerOpacity(x,f)};function c(s,i,x,p){var v=p("real"),f=p("imag"),y;return v&&f&&(y=Math.min(v.length,f.length)),i._length=y,y}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1026}],1029:[function(d,ee,te){var A=d("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n=e[M.subplot]._subplot;return a.realLabel=A.tickText(n.radialAxis,S.real,!0).text,a.imagLabel=A.tickText(n.angularAxis,S.imag,!0).text,a}},{"../../plots/cartesian/axes":566}],1030:[function(d,ee,te){var A=d("../scatter/hover");function g(M,e,a,n){var r=A(M,e,a,n);if(!(!r||r[0].index===!1)){var t=r[0];if(t.index===void 0)return r;var c=M.subplot,s=t.cd[t.index],i=t.trace;if(!!c.isPtInside(s))return t.xLabelVal=void 0,t.yLabelVal=void 0,S(s,i,c,t),t.hovertemplate=i.hovertemplate,r}}function S(M,e,a,n){var r=a.radialAxis,t=a.angularAxis;r._hovertitle="real",t._hovertitle="imag";var c={};c[e.subplot]={_subplot:a};var s=e._module.formatLabels(M,e,c);n.realLabel=s.realLabel,n.imagLabel=s.imagLabel;var i=M.hi||e.hoverinfo,x=[];function p(f,y){x.push(f._hovertitle+": "+y)}if(!e.hovertemplate){var v=i.split("+");v.indexOf("all")!==-1&&(v=["real","imag","text"]),v.indexOf("real")!==-1&&p(r,n.realLabel),v.indexOf("imag")!==-1&&p(t,n.imagLabel),v.indexOf("text")!==-1&&n.text&&(x.push(n.text),delete n.text),n.extraText=x.join("<br>")}}ee.exports={hoverPoints:g,makeHoverPointText:S}},{"../scatter/hover":947}],1031:[function(d,ee,te){ee.exports={moduleType:"trace",name:"scattersmith",basePlotModule:d("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),plot:d("./plot"),style:d("../scatter/style").style,styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover").hoverPoints,selectPoints:d("../scatter/select"),meta:{}}},{"../../plots/smith":638,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1026,"./calc":1027,"./defaults":1028,"./format_labels":1029,"./hover":1030,"./plot":1032}],1032:[function(d,ee,te){var A=d("../scatter/plot"),g=d("../../constants/numerical").BADNUM,S=d("../../plots/smith/helpers"),M=S.smith;ee.exports=function(a,n,r){for(var t=n.layers.frontplot.select("g.scatterlayer"),c=n.xaxis,s=n.yaxis,i={xaxis:c,yaxis:s,plot:n.framework,layerClipId:n._hasClipOnAxisFalse?n.clipIds.forTraces:null},x=0;x<r.length;x++)for(var p=r[x],v=0;v<p.length;v++){v===0&&(p[0].trace._xA=c,p[0].trace._yA=s);var f=p[v],y=f.real;if(y===g)f.x=f.y=g;else{var o=M([y,f.imag]);f.x=o[0],f.y=o[1]}}A(a,i,r,t)}},{"../../constants/numerical":491,"../../plots/smith/helpers":637,"../scatter/plot":957}],1033:[function(d,ee,te){var A=d("../../plots/template_attributes").hovertemplateAttrs,g=d("../../plots/template_attributes").texttemplateAttrs,S=d("../scatter/attributes"),M=d("../../plots/attributes"),e=d("../../components/colorscale/attributes"),a=d("../../components/drawing/attributes").dash,n=d("../../lib/extend").extendFlat,r=S.marker,t=S.line,c=r.line;ee.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:n({},S.mode,{dflt:"markers"}),text:n({},S.text,{}),texttemplate:g({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:n({},S.hovertext,{}),line:{color:t.color,width:t.width,dash:a,backoff:t.backoff,shape:n({},t.shape,{values:["linear","spline"]}),smoothing:t.smoothing,editType:"calc"},connectgaps:S.connectgaps,cliponaxis:S.cliponaxis,fill:n({},S.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:S.fillcolor,marker:n({symbol:r.symbol,opacity:r.opacity,angle:r.angle,angleref:r.angleref,standoff:r.standoff,maxdisplayed:r.maxdisplayed,size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,line:n({width:c.width,editType:"calc"},e("marker.line")),gradient:r.gradient,editType:"calc"},e("marker")),textfont:S.textfont,textposition:S.textposition,selected:S.selected,unselected:S.unselected,hoverinfo:n({},M.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:S.hoveron,hovertemplate:A()}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1034:[function(d,ee,te){var A=d("fast-isnumeric"),g=d("../scatter/colorscale_calc"),S=d("../scatter/arrays_to_calcdata"),M=d("../scatter/calc_selection"),e=d("../scatter/calc").calcMarkerSize,a=["a","b","c"],n={a:["b","c"],b:["a","c"],c:["a","b"]};ee.exports=function(t,c){var s=t._fullLayout[c.subplot],i=s.sum,x=c.sum||i,p={a:c.a,b:c.b,c:c.c},v,f,y,o,m,l;for(v=0;v<a.length;v++)if(y=a[v],!p[y]){for(m=p[n[y][0]],l=p[n[y][1]],o=new Array(m.length),f=0;f<m.length;f++)o[f]=x-m[f]-l[f];p[y]=o}var w=c._length,_=new Array(w),h,b,u,L,T,k;for(v=0;v<w;v++)h=p.a[v],b=p.b[v],u=p.c[v],A(h)&&A(b)&&A(u)?(h=+h,b=+b,u=+u,L=i/(h+b+u),L!==1&&(h*=L,b*=L,u*=L),k=h,T=u-b,_[v]={x:T,y:k,a:h,b,c:u}):_[v]={x:!1,y:!1};return e(c,w),g(t,c),S(_,c),M(_,c),_}},{"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1035:[function(d,ee,te){var A=d("../../lib"),g=d("../scatter/constants"),S=d("../scatter/subtypes"),M=d("../scatter/marker_defaults"),e=d("../scatter/line_defaults"),a=d("../scatter/line_shape_defaults"),n=d("../scatter/text_defaults"),r=d("../scatter/fillcolor_defaults"),t=d("./attributes");ee.exports=function(s,i,x,p){function v(_,h){return A.coerce(s,i,t,_,h)}var f=v("a"),y=v("b"),o=v("c"),m;if(f?(m=f.length,y?(m=Math.min(m,y.length),o&&(m=Math.min(m,o.length))):o?m=Math.min(m,o.length):m=0):y&&o&&(m=Math.min(y.length,o.length)),!m){i.visible=!1;return}i._length=m,v("sum"),v("text"),v("hovertext"),i.hoveron!=="fills"&&v("hovertemplate");var l=m<g.PTS_LINESONLY?"lines+markers":"lines";v("mode",l),S.hasLines(i)&&(e(s,i,x,p,v,{backoff:!0}),a(s,i,v),v("connectgaps")),S.hasMarkers(i)&&M(s,i,x,p,v,{gradient:!0}),S.hasText(i)&&(v("texttemplate"),n(s,i,p,v));var w=[];(S.hasMarkers(i)||S.hasText(i))&&(v("cliponaxis"),v("marker.maxdisplayed"),w.push("points")),v("fill"),i.fill!=="none"&&(r(s,i,x,v),S.hasLines(i)||a(s,i,v)),(i.fill==="tonext"||i.fill==="toself")&&w.push("fills"),v("hoveron",w.join("+")||"points"),A.coerceSelectionMarkerOpacity(i,v)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1033}],1036:[function(d,ee,te){ee.exports=function(g,S,M,e,a){if(S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),e[a]){var n=e[a];g.a=n.a,g.b=n.b,g.c=n.c}else g.a=S.a,g.b=S.b,g.c=S.c;return g}},{}],1037:[function(d,ee,te){var A=d("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n=e[M.subplot]._subplot;return a.aLabel=A.tickText(n.aaxis,S.a,!0).text,a.bLabel=A.tickText(n.baxis,S.b,!0).text,a.cLabel=A.tickText(n.caxis,S.c,!0).text,a}},{"../../plots/cartesian/axes":566}],1038:[function(d,ee,te){var A=d("../scatter/hover");ee.exports=function(S,M,e,a){var n=A(S,M,e,a);if(!n||n[0].index===!1)return;var r=n[0];if(r.index===void 0){var t=1-r.y0/S.ya._length,c=S.xa._length,s=c*t/2,i=c-s;return r.x0=Math.max(Math.min(r.x0,i),s),r.x1=Math.max(Math.min(r.x1,i),s),n}var x=r.cd[r.index],p=r.trace,v=r.subplot;r.a=x.a,r.b=x.b,r.c=x.c,r.xLabelVal=void 0,r.yLabelVal=void 0;var f={};f[p.subplot]={_subplot:v};var y=p._module.formatLabels(x,p,f);r.aLabel=y.aLabel,r.bLabel=y.bLabel,r.cLabel=y.cLabel;var o=x.hi||p.hoverinfo,m=[];function l(_,h){m.push(_._hovertitle+": "+h)}if(!p.hovertemplate){var w=o.split("+");w.indexOf("all")!==-1&&(w=["a","b","c"]),w.indexOf("a")!==-1&&l(v.aaxis,r.aLabel),w.indexOf("b")!==-1&&l(v.baxis,r.bLabel),w.indexOf("c")!==-1&&l(v.caxis,r.cLabel)}return r.extraText=m.join("<br>"),r.hovertemplate=p.hovertemplate,n}},{"../scatter/hover":947}],1039:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),plot:d("./plot"),style:d("../scatter/style").style,styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("../scatter/select"),eventData:d("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:d("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":643,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1033,"./calc":1034,"./defaults":1035,"./event_data":1036,"./format_labels":1037,"./hover":1038,"./plot":1040}],1040:[function(d,ee,te){var A=d("../scatter/plot");ee.exports=function(S,M,e){var a=M.plotContainer;a.select(".scatterlayer").selectAll("*").remove();for(var n=M.xaxis,r=M.yaxis,t={xaxis:n,yaxis:r,plot:a,layerClipId:M._hasClipOnAxisFalse?M.clipIdRelative:null},c=M.layers.frontplot.select("g.scatterlayer"),s=0;s<e.length;s++){var i=e[s];i.length&&(i[0].trace._xA=n,i[0].trace._yA=r)}A(S,t,e,c)}},{"../scatter/plot":957}],1041:[function(d,ee,te){var A=d("../scatter/attributes"),g=d("../../components/colorscale/attributes"),S=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../plots/template_attributes").hovertemplateAttrs,e=d("../scattergl/attributes"),a=d("../../plots/cartesian/constants").idRegex,n=d("../../plot_api/plot_template").templatedArray,r=d("../../lib/extend").extendFlat,t=A.marker,c=t.line,s=r(g("marker.line",{editTypeOverride:"calc"}),{width:r({},c.width,{editType:"calc"}),editType:"calc"}),i=r(g("marker"),{symbol:t.symbol,angle:t.angle,size:r({},t.size,{editType:"markerSize"}),sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,opacity:t.opacity,colorbar:t.colorbar,line:s,editType:"calc"});i.color.editType=i.cmin.editType=i.cmax.editType="style";function x(p){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:a[p],editType:"plot"}}}ee.exports={dimensions:n("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:r({},e.text,{}),hovertext:r({},e.hovertext,{}),hovertemplate:M(),xhoverformat:S("x"),yhoverformat:S("y"),marker:i,xaxes:x("x"),yaxes:x("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/constants":573,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergl/attributes":988}],1042:[function(d,ee,te){var A=d("../../registry"),g=d("../../components/grid");ee.exports={moduleType:"trace",name:"splom",categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),calc:d("./calc"),plot:d("./plot"),hoverPoints:d("./hover").hoverPoints,selectPoints:d("./select"),editStyle:d("./edit_style"),meta:{}},A.register(g)},{"../../components/grid":411,"../../registry":647,"../scatter/marker_colorbar":954,"./attributes":1041,"./calc":1044,"./defaults":1045,"./edit_style":1046,"./hover":1048,"./plot":1050,"./select":1052}],1043:[function(d,ee,te){var A=d("regl-line2d"),g=d("../../registry"),S=d("../../lib/prepare_regl"),M=d("../../plots/get_data").getModuleCalcData,e=d("../../plots/cartesian"),a=d("../../plots/cartesian/axis_ids").getFromId,n=d("../../plots/cartesian/axes").shouldShowZeroLine,r="splom",t={};function c(f){var y=f._fullLayout,o=g.getModule(r),m=M(f.calcdata,o)[0],l=S(f,["ANGLE_instanced_arrays","OES_element_index_uint"],t);!l||(y._hasOnlyLargeSploms&&x(f),o.plot(f,{},m))}function s(f){var y=f.calcdata,o=f._fullLayout;o._hasOnlyLargeSploms&&x(f);for(var m=0;m<y.length;m++){var l=y[m][0],w=l.trace,_=o._splomScenes[w.uid];w.type==="splom"&&_&&_.matrix&&i(f,w,_)}}function i(f,y,o){for(var m=o.matrixOptions.data.length,l=y._visibleDims,w=o.viewOpts.ranges=new Array(m),_=0;_<l.length;_++){var h=l[_],b=w[_]=new Array(4),u=a(f,y._diag[h][0]);u&&(b[0]=u.r2l(u.range[0]),b[2]=u.r2l(u.range[1]));var L=a(f,y._diag[h][1]);L&&(b[1]=L.r2l(L.range[0]),b[3]=L.r2l(L.range[1]))}o.selectBatch.length||o.unselectBatch.length?o.matrix.update({ranges:w},{ranges:w}):o.matrix.update({ranges:w})}function x(f){var y=f._fullLayout,o=y._glcanvas.data()[0].regl,m=y._splomGrid;m||(m=y._splomGrid=A(o)),m.update(p(f))}function p(f){var y=f._context.plotGlPixelRatio,o=f._fullLayout,m=o._size,l=[0,0,o.width*y,o.height*y],w={},_;function h(K,W,Y,re,ue,j){Y*=y,re*=y,ue*=y,j*=y;var q=W[K+"color"],V=W[K+"width"],U=String(q+V);U in w?w[U].data.push(NaN,NaN,Y,re,ue,j):w[U]={data:[Y,re,ue,j],join:"rect",thickness:V*y,color:q,viewport:l,range:l,overlay:!1}}for(_ in o._splomSubplots){var b=o._plots[_],u=b.xaxis,L=b.yaxis,T=u._gridVals,k=L._gridVals,P=u._offset,z=u._length,I=L._length,D=m.b+L.domain[0]*m.h,R=-L._m,O=-R*L.r2l(L.range[0],L.calendar),F,N;if(u.showgrid)for(_=0;_<T.length;_++)F=P+u.l2p(T[_].x),h("grid",u,F,D,F,D+I);if(L.showgrid)for(_=0;_<k.length;_++)N=D+O+R*k[_].x,h("grid",L,P,N,P+z,N);n(f,u,L)&&(F=P+u.l2p(0),h("zeroline",u,F,D,F,D+I)),n(f,L,u)&&(N=D+O+0,h("zeroline",L,P,N,P+z,N))}var G=[];for(_ in w)G.push(w[_]);return G}function v(f,y,o,m){var l={},w;if(m._splomScenes){for(w=0;w<f.length;w++){var _=f[w];_.type==="splom"&&(l[_.uid]=1)}for(w=0;w<o.length;w++){var h=o[w];if(!l[h.uid]){var b=m._splomScenes[h.uid];b&&b.destroy&&b.destroy(),m._splomScenes[h.uid]=null,delete m._splomScenes[h.uid]}}}Object.keys(m._splomScenes||{}).length===0&&delete m._splomScenes,m._splomGrid&&!y._hasOnlyLargeSploms&&m._hasOnlyLargeSploms&&(m._splomGrid.destroy(),m._splomGrid=null,delete m._splomGrid),e.clean(f,y,o,m)}ee.exports={name:r,attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:c,drag:s,updateGrid:x,clean:v,updateFx:e.updateFx,toSVG:e.toSVG,reglPrecompiled:t}},{"../../lib/prepare_regl":528,"../../plots/cartesian":578,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../../plots/get_data":602,"../../registry":647,"regl-line2d":281}],1044:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axis_ids"),S=d("../scatter/calc").calcMarkerSize,M=d("../scatter/calc").calcAxisExpansion,e=d("../scatter/colorscale_calc"),a=d("../scattergl/convert").markerSelection,n=d("../scattergl/convert").markerStyle,r=d("./scene_update"),t=d("../../constants/numerical").BADNUM,c=d("../scattergl/constants").TOO_MANY_POINTS;ee.exports=function(i,x){var p=x.dimensions,v=x._length,f={},y=f.cdata=[],o=f.data=[],m=x._visibleDims=[],l,w,_,h,b;function u(z,I){for(var D=z.makeCalcdata({v:I.values,vcalendar:x.calendar},"v"),R=0;R<D.length;R++)D[R]=D[R]===t?NaN:D[R];y.push(D),o.push(z.type==="log"?A.simpleMap(D,z.c2l):D)}for(l=0;l<p.length;l++)if(_=p[l],_.visible){if(h=g.getFromId(i,x._diag[l][0]),b=g.getFromId(i,x._diag[l][1]),h&&b&&h.type!==b.type){A.log("Skipping splom dimension "+l+" with conflicting axis types");continue}h?(u(h,_),b&&b.type==="category"&&(b._categories=h._categories.slice())):u(b,_),m.push(l)}e(i,x),A.extendFlat(f,n(i,x));var L=y.length,T=L*v>c,k;for(T?k=f.sizeAvg||Math.max(f.size,3):k=S(x,v),w=0;w<m.length;w++)l=m[w],_=p[l],h=g.getFromId(i,x._diag[l][0])||{},b=g.getFromId(i,x._diag[l][1])||{},M(i,x,h,b,y[w],y[w],k);var P=r(i,x);return P.matrix||(P.matrix=!0),P.matrixOptions=f,P.selectedOptions=a(i,x,x.selected),P.unselectedOptions=a(i,x,x.unselected),[{x:!1,y:!1,t:{},trace:x}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992,"./scene_update":1051}],1045:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/array_container_defaults"),S=d("./attributes"),M=d("../scatter/subtypes"),e=d("../scatter/marker_defaults"),a=d("../parcoords/merge_length"),n=d("../scattergl/helpers").isOpenSymbol;ee.exports=function(s,i,x,p){function v(h,b){return A.coerce(s,i,S,h,b)}var f=g(s,i,{name:"dimensions",handleItemDefaults:r}),y=v("diagonal.visible"),o=v("showupperhalf"),m=v("showlowerhalf"),l=a(i,f,"values");if(!l||!y&&!o&&!m){i.visible=!1;return}v("text"),v("hovertext"),v("hovertemplate"),v("xhoverformat"),v("yhoverformat"),e(s,i,x,p,v,{noAngleRef:!0,noStandOff:!0});var w=n(i.marker.symbol),_=M.isBubble(i);v("marker.line.width",w||_?1:0),t(s,i,p,v),A.coerceSelectionMarkerOpacity(i,v)};function r(c,s){function i(p,v){return A.coerce(c,s,S.dimensions,p,v)}i("label");var x=i("values");x&&x.length?i("visible"):s.visible=!1,i("axis.type"),i("axis.matches")}function t(c,s,i,x){var p=s.dimensions,v=p.length,f=s.showupperhalf,y=s.showlowerhalf,o=s.diagonal.visible,m,l,w=new Array(v),_=new Array(v);for(m=0;m<v;m++){var h=m?m+1:"";w[m]="x"+h,_[m]="y"+h}var b=x("xaxes",w),u=x("yaxes",_),L=s._diag=new Array(v);s._xaxes={},s._yaxes={};var T=[],k=[];function P(K,W,Y,re){if(!!K){var ue=K.charAt(0),j=i._splomAxes[ue];if(s["_"+ue+"axes"][K]=1,re.push(K),!(K in j)){var q=j[K]={};Y&&(q.label=Y.label||"",Y.visible&&Y.axis&&(Y.axis.type&&(q.type=Y.axis.type),Y.axis.matches&&(q.matches=W)))}}}var z=!o&&!y,I=!o&&!f;for(s._axesDim={},m=0;m<v;m++){var D=p[m],R=m===0,O=m===v-1,F=R&&z||O&&I?void 0:b[m],N=R&&I||O&&z?void 0:u[m];P(F,N,D,T),P(N,F,D,k),L[m]=[F,N],s._axesDim[F]=m,s._axesDim[N]=m}for(m=0;m<T.length;m++)for(l=0;l<k.length;l++){var G=T[m]+k[l];(m>l&&f||m<l&&y||m===l&&(o||!y||!f))&&(i._splomSubplots[G]=1)}(!y||!o&&f&&y)&&(i._splomGridDflt.xside="bottom",i._splomGridDflt.yside="left")}},{"../../lib":515,"../../plots/array_container_defaults":561,"../parcoords/merge_length":907,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scattergl/helpers":996,"./attributes":1041}],1046:[function(d,ee,te){var A=d("../../lib"),g=d("../scatter/colorscale_calc"),S=d("../scattergl/convert").markerStyle;ee.exports=function(e,a){var n=a.trace,r=e._fullLayout._splomScenes[n.uid];if(r){g(e,n),A.extendFlat(r.matrixOptions,S(e,n));var t=A.extendFlat({},r.matrixOptions,r.viewOpts);r.matrix.update(t,null)}}},{"../../lib":515,"../scatter/colorscale_calc":939,"../scattergl/convert":992}],1047:[function(d,ee,te){te.getDimIndex=function(g,S){for(var M=S._id,e=M.charAt(0),a={x:0,y:1}[e],n=g._visibleDims,r=0;r<n.length;r++){var t=n[r];if(g._diag[t][a]===M)return r}return!1}},{}],1048:[function(d,ee,te){var A=d("./helpers"),g=d("../scattergl/hover").calcHover;function S(M,e,a){var n=M.cd,r=n[0].trace,t=M.scene,c=t.matrixOptions.cdata,s=M.xa,i=M.ya,x=s.c2p(e),p=i.c2p(a),v=M.distance,f=A.getDimIndex(r,s),y=A.getDimIndex(r,i);if(f===!1||y===!1)return[M];for(var o=c[f],m=c[y],l,w,_=v,h=0;h<o.length;h++){var b=o[h],u=m[h],L=s.c2p(b)-x,T=i.c2p(u)-p,k=Math.sqrt(L*L+T*T);k<_&&(_=w=k,l=h)}return M.index=l,M.distance=_,M.dxy=w,l===void 0?[M]:[g(M,o,m,r)]}ee.exports={hoverPoints:S}},{"../scattergl/hover":997,"./helpers":1047}],1049:[function(d,ee,te){var A=d("./base_index");A.basePlotModule=d("./base_plot"),ee.exports=A},{"./base_index":1042,"./base_plot":1043}],1050:[function(d,ee,te){var A=d("regl-splom"),g=d("../../lib"),S=d("../../plots/cartesian/axis_ids"),M=d("../../components/dragelement/helpers").selectMode;ee.exports=function(n,r,t){if(!!t.length)for(var c=0;c<t.length;c++)e(n,t[c][0])};function e(a,n){var r=a._fullLayout,t=r._size,c=n.trace,s=n.t,i=r._splomScenes[c.uid],x=i.matrixOptions,p=x.cdata,v=r._glcanvas.data()[0].regl,f=r.dragmode,y,o,m,l,w;if(p.length!==0){x.lower=c.showupperhalf,x.upper=c.showlowerhalf,x.diagonal=c.diagonal.visible;var _=c._visibleDims,h=p.length,b=i.viewOpts={};for(b.ranges=new Array(h),b.domains=new Array(h),w=0;w<_.length;w++){m=_[w];var u=b.ranges[w]=new Array(4),L=b.domains[w]=new Array(4);y=S.getFromId(a,c._diag[m][0]),y&&(u[0]=y._rl[0],u[2]=y._rl[1],L[0]=y.domain[0],L[2]=y.domain[1]),o=S.getFromId(a,c._diag[m][1]),o&&(u[1]=o._rl[0],u[3]=o._rl[1],L[1]=o.domain[0],L[3]=o.domain[1])}var T=a._context.plotGlPixelRatio,k=t.l*T,P=t.b*T,z=t.w*T,I=t.h*T;b.viewport=[k,P,z+k,I+P],i.matrix===!0&&(i.matrix=A(v));var D=r.clickmode.indexOf("select")>-1,R=M(f)||!!c.selectedpoints||D,O=!0;if(R){var F=c._length;if(c.selectedpoints){i.selectBatch=c.selectedpoints;var N=c.selectedpoints,G={};for(m=0;m<N.length;m++)G[N[m]]=!0;var K=[];for(m=0;m<F;m++)G[m]||K.push(m);i.unselectBatch=K}var W=s.xpx=new Array(h),Y=s.ypx=new Array(h);for(w=0;w<_.length;w++){if(m=_[w],y=S.getFromId(a,c._diag[m][0]),y)for(W[w]=new Array(F),l=0;l<F;l++)W[w][l]=y.c2p(p[w][l]);if(o=S.getFromId(a,c._diag[m][1]),o)for(Y[w]=new Array(F),l=0;l<F;l++)Y[w][l]=o.c2p(p[w][l])}if(i.selectBatch.length||i.unselectBatch.length){var re=g.extendFlat({},x,i.unselectedOptions,b),ue=g.extendFlat({},x,i.selectedOptions,b);i.matrix.update(re,ue),O=!1}}else s.xpx=s.ypx=null;if(O){var j=g.extendFlat({},x,b);i.matrix.update(j,null)}}}},{"../../components/dragelement/helpers":385,"../../lib":515,"../../plots/cartesian/axis_ids":570,"regl-splom":283}],1051:[function(d,ee,te){var A=d("../../lib");ee.exports=function(S,M){var e=S._fullLayout,a=M.uid,n=e._splomScenes;n||(n=e._splomScenes={});var r={dirty:!0,selectBatch:[],unselectBatch:[]},t={matrix:!1,selectBatch:[],unselectBatch:[]},c=n[M.uid];return c||(c=n[a]=A.extendFlat({},r,t),c.draw=function(){c.matrix&&c.matrix.draw&&(c.selectBatch.length||c.unselectBatch.length?c.matrix.draw(c.unselectBatch,c.selectBatch):c.matrix.draw()),c.dirty=!1},c.destroy=function(){c.matrix&&c.matrix.destroy&&c.matrix.destroy(),c.matrixOptions=null,c.selectBatch=null,c.unselectBatch=null,c=null}),c.dirty||A.extendFlat(c,r),c}},{"../../lib":515}],1052:[function(d,ee,te){var A=d("../../lib"),g=A.pushUnique,S=d("../scatter/subtypes"),M=d("./helpers");ee.exports=function(a,n){var r=a.cd,t=r[0].trace,c=r[0].t,s=a.scene,i=s.matrixOptions.cdata,x=a.xaxis,p=a.yaxis,v=[];if(!s)return v;var f=!S.hasMarkers(t)&&!S.hasText(t);if(t.visible!==!0||f)return v;var y=M.getDimIndex(t,x),o=M.getDimIndex(t,p);if(y===!1||o===!1)return v;var m=c.xpx[y],l=c.ypx[o],w=i[y],_=i[o],h=(a.scene.selectBatch||[]).slice(),b=[];if(n!==!1&&!n.degenerate)for(var u=0;u<w.length;u++)n.contains([m[u],l[u]],null,u,a)?(v.push({pointNumber:u,x:w[u],y:_[u]}),g(h,u)):h.indexOf(u)!==-1?g(h,u):b.push(u);var L=s.matrixOptions;return!h.length&&!b.length?s.matrix.update(L,null):!s.selectBatch.length&&!s.unselectBatch.length&&s.matrix.update(s.unselectedOptions,A.extendFlat({},L,s.selectedOptions,s.viewOpts)),s.selectBatch=h,s.unselectBatch=b,v}},{"../../lib":515,"../scatter/subtypes":961,"./helpers":1047}],1053:[function(d,ee,te){var A=d("../../components/colorscale/attributes"),g=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../mesh3d/attributes"),e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:S({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:g("u",1),vhoverformat:g("v",1),whoverformat:g("w",1),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),showlegend:a({},e.showlegend,{dflt:!1})};a(n,A("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));var r=["opacity","lightposition","lighting"];r.forEach(function(t){n[t]=M[t]}),n.hoverinfo=a({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,ee.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],1054:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/colorscale/calc");function S(n,r){r._len=Math.min(r.u.length,r.v.length,r.w.length,r.x.length,r.y.length,r.z.length),r._u=a(r.u,r._len),r._v=a(r.v,r._len),r._w=a(r.w,r._len),r._x=a(r.x,r._len),r._y=a(r.y,r._len),r._z=a(r.z,r._len);var t=M(r);r._gridFill=t.fill,r._Xs=t.Xs,r._Ys=t.Ys,r._Zs=t.Zs,r._len=t.len;var c=0,s,i,x;r.starts&&(s=a(r.starts.x||[]),i=a(r.starts.y||[]),x=a(r.starts.z||[]),c=Math.min(s.length,i.length,x.length)),r._startsX=s||[],r._startsY=i||[],r._startsZ=x||[];var p=0,v=1/0,f;for(f=0;f<r._len;f++){var y=r._u[f],o=r._v[f],m=r._w[f],l=Math.sqrt(y*y+o*o+m*m);p=Math.max(p,l),v=Math.min(v,l)}for(g(n,r,{vals:[v,p],containerStr:"",cLetter:"c"}),f=0;f<c;f++){var w=s[f];t.xMax=Math.max(t.xMax,w),t.xMin=Math.min(t.xMin,w);var _=i[f];t.yMax=Math.max(t.yMax,_),t.yMin=Math.min(t.yMin,_);var h=x[f];t.zMax=Math.max(t.zMax,h),t.zMin=Math.min(t.zMin,h)}r._slen=c,r._normMax=p,r._xbnds=[t.xMin,t.xMax],r._ybnds=[t.yMin,t.yMax],r._zbnds=[t.zMin,t.zMax]}function M(n){var r=n._x,t=n._y,c=n._z,s=n._len,i,x,p,v=-1/0,f=1/0,y=-1/0,o=1/0,m=-1/0,l=1/0,w="",_,h,b,u,L,T,k,P,z;for(s&&(u=r[0],T=t[0],P=c[0]),s>1&&(L=r[s-1],k=t[s-1],z=c[s-1]),i=0;i<s;i++)v=Math.max(v,r[i]),f=Math.min(f,r[i]),y=Math.max(y,t[i]),o=Math.min(o,t[i]),m=Math.max(m,c[i]),l=Math.min(l,c[i]),!_&&r[i]!==u&&(_=!0,w+="x"),!h&&t[i]!==T&&(h=!0,w+="y"),!b&&c[i]!==P&&(b=!0,w+="z");_||(w+="x"),h||(w+="y"),b||(w+="z");var I=e(n._x),D=e(n._y),R=e(n._z);w=w.replace("x",(u>L?"-":"+")+"x"),w=w.replace("y",(T>k?"-":"+")+"y"),w=w.replace("z",(P>z?"-":"+")+"z");var O=function(){s=0,I=[],D=[],R=[]};(!s||s<I.length*D.length*R.length)&&O();var F=function(ae){return ae==="x"?r:ae==="y"?t:c},N=function(ae){return ae==="x"?I:ae==="y"?D:R},G=function(ae){return ae[s-1]<ae[0]?-1:1},K=F(w[1]),W=F(w[3]),Y=F(w[5]),re=N(w[1]).length,ue=N(w[3]).length,j=N(w[5]).length,q=!1,V=function(ae,oe,be){return re*(ue*ae+oe)+be},U=G(F(w[1])),$=G(F(w[3])),ne=G(F(w[5]));for(i=0;i<j-1;i++){for(x=0;x<ue-1;x++){for(p=0;p<re-1;p++){var X=V(i,x,p),Q=V(i,x,p+1),ie=V(i,x+1,p),se=V(i+1,x,p);if((!(K[X]*U<K[Q]*U)||!(W[X]*$<W[ie]*$)||!(Y[X]*ne<Y[se]*ne))&&(q=!0),q)break}if(q)break}if(q)break}return q&&(A.warn("Encountered arbitrary coordinates! Unable to input data grid."),O()),{xMin:f,yMin:o,zMin:l,xMax:v,yMax:y,zMax:m,Xs:I,Ys:D,Zs:R,len:s,fill:w}}function e(n){return A.distinctVals(n).vals}function a(n,r){if(r===void 0&&(r=n.length),A.isTypedArray(n))return n.subarray(0,r);for(var t=[],c=0;c<r;c++)t[c]=+n[c];return t}ee.exports={calc:S,filter:a,processGrid:M}},{"../../components/colorscale/calc":375,"../../lib":515}],1055:[function(d,ee,te){var A=d("../../../stackgl_modules").gl_streamtube3d,g=A.createTubeMesh,S=d("../../lib"),M=d("../../lib/gl_format_color").parseColorScale,e=d("../../components/colorscale").extractOpts,a=d("../../plots/gl3d/zip3"),n={xaxis:0,yaxis:1,zaxis:2};function r(p,v){this.scene=p,this.uid=v,this.mesh=null,this.data=null}var t=r.prototype;t.handlePick=function(p){var v=this.scene.fullSceneLayout,f=this.scene.dataScale;function y(l,w){var _=v[w],h=f[n[w]];return _.l2c(l)/h}if(p.object===this.mesh){var o=p.data.position,m=p.data.velocity;return p.traceCoordinate=[y(o[0],"xaxis"),y(o[1],"yaxis"),y(o[2],"zaxis"),y(m[0],"xaxis"),y(m[1],"yaxis"),y(m[2],"zaxis"),p.data.intensity*this.data._normMax,p.data.divergence],p.textLabel=this.data.hovertext||this.data.text,!0}};function c(p){var v=p.length,f;return v>2?f=p.slice(1,v-1):v===2?f=[(p[0]+p[1])/2]:f=p,f}function s(p){var v=p.length;return v===1?[.5,.5]:[p[1]-p[0],p[v-1]-p[v-2]]}function i(p,v){var f=p.fullSceneLayout,y=p.dataScale,o=v._len,m={};function l(ue,j){var q=f[j],V=y[n[j]];return S.simpleMap(ue,function(U){return q.d2l(U)*V})}if(m.vectors=a(l(v._u,"xaxis"),l(v._v,"yaxis"),l(v._w,"zaxis"),o),!o)return{positions:[],cells:[]};var w=l(v._Xs,"xaxis"),_=l(v._Ys,"yaxis"),h=l(v._Zs,"zaxis");m.meshgrid=[w,_,h],m.gridFill=v._gridFill;var b=v._slen;if(b)m.startingPositions=a(l(v._startsX,"xaxis"),l(v._startsY,"yaxis"),l(v._startsZ,"zaxis"));else{for(var u=_[0],L=c(w),T=c(h),k=new Array(L.length*T.length),P=0,z=0;z<L.length;z++)for(var I=0;I<T.length;I++)k[P++]=[L[z],u,T[I]];m.startingPositions=k}m.colormap=M(v),m.tubeSize=v.sizeref,m.maxLength=v.maxdisplayed;var D=l(v._xbnds,"xaxis"),R=l(v._ybnds,"yaxis"),O=l(v._zbnds,"zaxis"),F=s(w),N=s(_),G=s(h),K=[[D[0]-F[0],R[0]-N[0],O[0]-G[0]],[D[1]+F[1],R[1]+N[1],O[1]+G[1]]],W=A(m,K),Y=e(v);W.vertexIntensityBounds=[Y.min/v._normMax,Y.max/v._normMax];var re=v.lightposition;return W.lightPosition=[re.x,re.y,re.z],W.ambient=v.lighting.ambient,W.diffuse=v.lighting.diffuse,W.specular=v.lighting.specular,W.roughness=v.lighting.roughness,W.fresnel=v.lighting.fresnel,W.opacity=v.opacity,v._pad=W.tubeScale*v.sizeref*2,W}t.update=function(p){this.data=p;var v=i(this.scene,p);this.mesh.update(v)},t.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function x(p,v){var f=p.glplot.gl,y=i(p,v),o=g(f,y),m=new r(p,v.uid);return m.mesh=o,m.data=v,o._trace=m,p.glplot.add(o),m}ee.exports=x},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],1056:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/colorscale/defaults"),S=d("./attributes");ee.exports=function(e,a,n,r){function t(f,y){return A.coerce(e,a,S,f,y)}var c=t("u"),s=t("v"),i=t("w"),x=t("x"),p=t("y"),v=t("z");if(!c||!c.length||!s||!s.length||!i||!i.length||!x||!x.length||!p||!p.length||!v||!v.length){a.visible=!1;return}t("starts.x"),t("starts.y"),t("starts.z"),t("maxdisplayed"),t("sizeref"),t("lighting.ambient"),t("lighting.diffuse"),t("lighting.specular"),t("lighting.roughness"),t("lighting.fresnel"),t("lightposition.x"),t("lightposition.y"),t("lightposition.z"),g(e,a,r,t,{prefix:"",cLetter:"c"}),t("text"),t("hovertext"),t("hovertemplate"),t("uhoverformat"),t("vhoverformat"),t("whoverformat"),t("xhoverformat"),t("yhoverformat"),t("zhoverformat"),a._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":1053}],1057:[function(d,ee,te){ee.exports={moduleType:"trace",name:"streamtube",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:d("./calc").calc,plot:d("./convert"),eventData:function(A,g){return A.tubex=A.x,A.tubey=A.y,A.tubez=A.z,A.tubeu=g.traceCoordinate[3],A.tubev=g.traceCoordinate[4],A.tubew=g.traceCoordinate[5],A.norm=g.traceCoordinate[6],A.divergence=g.traceCoordinate[7],delete A.x,delete A.y,delete A.z,A},meta:{}}},{"../../plots/gl3d":607,"./attributes":1053,"./calc":1054,"./convert":1055,"./defaults":1056}],1058:[function(d,ee,te){var A=d("../../plots/attributes"),g=d("../../plots/template_attributes").hovertemplateAttrs,S=d("../../plots/template_attributes").texttemplateAttrs,M=d("../../components/colorscale/attributes"),e=d("../../plots/domain").attributes,a=d("../pie/attributes"),n=d("./constants"),r=d("../../lib/extend").extendFlat;ee.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:r({colors:{valType:"data_array",editType:"calc"},line:{color:r({},a.marker.line.color,{dflt:null}),width:r({},a.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},M("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:a.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:S({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:a.hovertext,hoverinfo:r({},A.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:g({},{keys:n.eventDataKeys}),textfont:a.textfont,insidetextorientation:a.insidetextorientation,insidetextfont:a.insidetextfont,outsidetextfont:r({},a.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:a.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"./constants":1061}],1059:[function(d,ee,te){var A=d("../../plots/plots");te.name="sunburst",te.plot=function(g,S,M,e){A.plotBasePlot(te.name,g,S,M,e)},te.clean=function(g,S,M,e){A.cleanBasePlot(te.name,g,S,M,e)}},{"../../plots/plots":628}],1060:[function(d,ee,te){var A=d("d3-hierarchy"),g=d("fast-isnumeric"),S=d("../../lib"),M=d("../../components/colorscale").makeColorScaleFuncFromTrace,e=d("../pie/calc").makePullColorFn,a=d("../pie/calc").generateExtendedColors,n=d("../../components/colorscale").calc,r=d("../../constants/numerical").ALMOST_EQUAL,t={},c={},s={};te.calc=function(x,p){var v=x._fullLayout,f=p.ids,y=S.isArrayOrTypedArray(f),o=p.labels,m=p.parents,l=p.values,w=S.isArrayOrTypedArray(l),_=[],h={},b={},u=function(U,$){h[U]?h[U].push($):h[U]=[$],b[$]=1},L=function(U){return U||typeof U=="number"},T=function(U){return!w||g(l[U])&&l[U]>=0},k,P,z;y?(k=Math.min(f.length,m.length),P=function(U){return L(f[U])&&T(U)},z=function(U){return String(f[U])}):(k=Math.min(o.length,m.length),P=function(U){return L(o[U])&&T(U)},z=function(U){return String(o[U])}),w&&(k=Math.min(k,l.length));for(var I=0;I<k;I++)if(P(I)){var D=z(I),R=L(m[I])?String(m[I]):"",O={i:I,id:D,pid:R,label:L(o[I])?String(o[I]):""};w&&(O.v=+l[I]),_.push(O),u(R,D)}if(h[""]){if(h[""].length>1){for(var G=S.randstr(),K=0;K<_.length;K++)_[K].pid===""&&(_[K].pid=G);_.unshift({hasMultipleRoots:!0,id:G,pid:"",label:""})}}else{var F=[],N;for(N in h)b[N]||F.push(N);if(F.length===1)N=F[0],_.unshift({hasImpliedRoot:!0,id:N,pid:"",label:N});else return S.warn(["Multiple implied roots, cannot build",p.type,"hierarchy of",p.name+".","These roots include:",F.join(", ")].join(" "))}var W;try{W=A.stratify().id(function(U){return U.id}).parentId(function(U){return U.pid})(_)}catch(U){return S.warn(["Failed to build",p.type,"hierarchy of",p.name+".","Error:",U.message].join(" "))}var Y=A.hierarchy(W),re=!1;if(w)switch(p.branchvalues){case"remainder":Y.sum(function(U){return U.data.v});break;case"total":Y.each(function(U){var $=U.data.data,ne=$.v;if(U.children){var X=U.children.reduce(function(Q,ie){return Q+ie.data.data.v},0);if(($.hasImpliedRoot||$.hasMultipleRoots)&&(ne=X),ne<X*r)return re=!0,S.warn(["Total value for node",U.data.data.id,"of",p.name,"is smaller than the sum of its children.",`
parent value =`,ne,`
children sum =`,X].join(" "))}U.value=ne});break}else i(Y,p,{branches:p.count.indexOf("branches")!==-1,leaves:p.count.indexOf("leaves")!==-1});if(!re){p.sort&&Y.sort(function(U,$){return $.value-U.value});var ue,j,q=p.marker.colors||[],V=!!q.length;return p._hasColorscale?(V||(q=w?p.values:p._values),n(x,p,{vals:q,containerStr:"marker",cLetter:"c"}),j=M(p.marker)):ue=e(v["_"+p.type+"colormap"]),Y.each(function(U){var $=U.data.data;$.color=p._hasColorscale?j(q[$.i]):ue(q[$.i],$.id)}),_[0].hierarchy=Y,_}},te._runCrossTraceCalc=function(x,p){var v=p._fullLayout,f=p.calcdata,y=v[x+"colorway"],o=v["_"+x+"colormap"];v["extend"+x+"colors"]&&(y=a(y,x==="icicle"?s:x==="treemap"?c:t));var m=0,l;function w(u){var L=u.data.data,T=L.id;L.color===!1&&(o[T]?L.color=o[T]:u.parent?u.parent.parent?L.color=u.parent.data.data.color:(o[T]=L.color=y[m%y.length],m++):L.color=l)}for(var _=0;_<f.length;_++){var h=f[_],b=h[0];b.trace.type===x&&b.hierarchy&&(l=b.trace.root.color,b.hierarchy.each(w))}},te.crossTraceCalc=function(x){return te._runCrossTraceCalc("sunburst",x)};function i(x,p,v){var f=0,y=x.children;if(y){for(var o=y.length,m=0;m<o;m++)f+=i(y[m],p,v);v.branches&&f++}else v.leaves&&f++;return x.value=x.data.data.value=f,p._values||(p._values=[]),p._values[x.data.data.i]=f,f}},{"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../pie/calc":912,"d3-hierarchy":115,"fast-isnumeric":190}],1061:[function(d,ee,te){ee.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1062:[function(d,ee,te){var A=d("../../lib"),g=d("./attributes"),S=d("../../plots/domain").defaults,M=d("../bar/defaults").handleText,e=d("../../components/colorscale"),a=e.hasColorscale,n=e.handleDefaults;ee.exports=function(t,c,s,i){function x(w,_){return A.coerce(t,c,g,w,_)}var p=x("labels"),v=x("parents");if(!p||!p.length||!v||!v.length){c.visible=!1;return}var f=x("values");f&&f.length?x("branchvalues"):x("count"),x("level"),x("maxdepth");var y=x("marker.line.width");y&&x("marker.line.color",i.paper_bgcolor),x("marker.colors");var o=c._hasColorscale=a(t,"marker","colors")||(t.marker||{}).coloraxis;o&&n(t,c,i,x,{prefix:"marker.",cLetter:"c"}),x("leaf.opacity",o?1:.7);var m=x("text");x("texttemplate"),c.texttemplate||x("textinfo",Array.isArray(m)?"text+label":"label"),x("hovertext"),x("hovertemplate");var l="auto";M(t,c,i,x,l,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),x("insidetextorientation"),x("sort"),x("rotation"),x("root.color"),S(c,i,x),c._length=null}},{"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":1058}],1063:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../registry"),S=d("../../components/fx/helpers").appendArrayPointValue,M=d("../../components/fx"),e=d("../../lib"),a=d("../../lib/events"),n=d("./helpers"),r=d("../pie/helpers"),t=r.formatPieValue;ee.exports=function(i,x,p,v,f){var y=v[0],o=y.trace,m=y.hierarchy,l=o.type==="sunburst",w=o.type==="treemap"||o.type==="icicle";"_hasHoverLabel"in o||(o._hasHoverLabel=!1),"_hasHoverEvent"in o||(o._hasHoverEvent=!1);var _=function(u){var L=p._fullLayout;if(!(p._dragging||L.hovermode===!1)){var T=p._fullData[o.index],k=u.data.data,P=k.i,z=n.isHierarchyRoot(u),I=n.getParent(m,u),D=n.getValue(u),R=function(Q){return e.castOption(T,P,Q)},O=R("hovertemplate"),F=M.castHoverinfo(T,L,P),N=L.separators,G;if(O||F&&F!=="none"&&F!=="skip"){var K,W;l&&(K=y.cx+u.pxmid[0]*(1-u.rInscribed),W=y.cy+u.pxmid[1]*(1-u.rInscribed)),w&&(K=u._hoverX,W=u._hoverY);var Y={},re=[],ue=[],j=function(Q){return re.indexOf(Q)!==-1};F&&(re=F==="all"?T._module.attributes.hoverinfo.flags:F.split("+")),Y.label=k.label,j("label")&&Y.label&&ue.push(Y.label),k.hasOwnProperty("v")&&(Y.value=k.v,Y.valueLabel=t(Y.value,N),j("value")&&ue.push(Y.valueLabel)),Y.currentPath=u.currentPath=n.getPath(u.data),j("current path")&&!z&&ue.push(Y.currentPath);var q,V=[],U=function(){V.indexOf(q)===-1&&(ue.push(q),V.push(q))};Y.percentParent=u.percentParent=D/n.getValue(I),Y.parent=u.parentString=n.getPtLabel(I),j("percent parent")&&(q=n.formatPercent(Y.percentParent,N)+" of "+Y.parent,U()),Y.percentEntry=u.percentEntry=D/n.getValue(x),Y.entry=u.entry=n.getPtLabel(x),j("percent entry")&&!z&&!u.onPathbar&&(q=n.formatPercent(Y.percentEntry,N)+" of "+Y.entry,U()),Y.percentRoot=u.percentRoot=D/n.getValue(m),Y.root=u.root=n.getPtLabel(m),j("percent root")&&!z&&(q=n.formatPercent(Y.percentRoot,N)+" of "+Y.root,U()),Y.text=R("hovertext")||R("text"),j("text")&&(q=Y.text,e.isValidTextValue(q)&&ue.push(q)),G=[c(u,T,f.eventDataKeys)];var $={trace:T,y:W,_x0:u._x0,_x1:u._x1,_y0:u._y0,_y1:u._y1,text:ue.join("<br>"),name:O||j("name")?T.name:void 0,color:R("hoverlabel.bgcolor")||k.color,borderColor:R("hoverlabel.bordercolor"),fontFamily:R("hoverlabel.font.family"),fontSize:R("hoverlabel.font.size"),fontColor:R("hoverlabel.font.color"),nameLength:R("hoverlabel.namelength"),textAlign:R("hoverlabel.align"),hovertemplate:O,hovertemplateLabels:Y,eventData:G};l&&($.x0=K-u.rInscribed*u.rpx1,$.x1=K+u.rInscribed*u.rpx1,$.idealAlign=u.pxmid[0]<0?"left":"right"),w&&($.x=K,$.idealAlign=K<0?"left":"right");var ne=[];M.loneHover($,{container:L._hoverlayer.node(),outerContainer:L._paper.node(),gd:p,inOut_bbox:ne}),G[0].bbox=ne[0],o._hasHoverLabel=!0}if(w){var X=i.select("path.surface");f.styleOne(X,u,T,{hovered:!0})}o._hasHoverEvent=!0,p.emit("plotly_hover",{points:G||[c(u,T,f.eventDataKeys)],event:A.event})}},h=function(u){var L=p._fullLayout,T=p._fullData[o.index],k=A.select(this).datum();if(o._hasHoverEvent&&(u.originalEvent=A.event,p.emit("plotly_unhover",{points:[c(k,T,f.eventDataKeys)],event:A.event}),o._hasHoverEvent=!1),o._hasHoverLabel&&(M.loneUnhover(L._hoverlayer.node()),o._hasHoverLabel=!1),w){var P=i.select("path.surface");f.styleOne(P,k,T,{hovered:!1})}},b=function(u){var L=p._fullLayout,T=p._fullData[o.index],k=l&&(n.isHierarchyRoot(u)||n.isLeaf(u)),P=n.getPtId(u),z=n.isEntry(u)?n.findEntryWithChild(m,P):n.findEntryWithLevel(m,P),I=n.getPtId(z),D={points:[c(u,T,f.eventDataKeys)],event:A.event};k||(D.nextLevel=I);var R=a.triggerHandler(p,"plotly_"+o.type+"click",D);if(R!==!1&&L.hovermode&&(p._hoverdata=[c(u,T,f.eventDataKeys)],M.click(p,A.event)),!k&&R!==!1&&!p._dragging&&!p._transitioning){g.call("_storeDirectGUIEdit",T,L._tracePreGUI[T.uid],{level:T.level});var O={data:[{level:I}],traces:[o.index]},F={frame:{redraw:!1,duration:f.transitionTime},transition:{duration:f.transitionTime,easing:f.transitionEasing},mode:"immediate",fromcurrent:!0};M.loneUnhover(L._hoverlayer.node()),g.call("animate",p,O,F)}};i.on("mouseover",_),i.on("mouseout",h),i.on("click",b)};function c(s,i,x){for(var p=s.data.data,v={curveNumber:i.index,pointNumber:p.i,data:i._input,fullData:i},f=0;f<x.length;f++){var y=x[f];y in s&&(v[y]=s[y])}return"parentString"in s&&!n.isHierarchyRoot(s)&&(v.parent=s.parentString),S(v,i,p.i),v}},{"../../components/fx":407,"../../components/fx/helpers":403,"../../lib":515,"../../lib/events":504,"../../registry":647,"../pie/helpers":915,"./helpers":1064,"@plotly/d3":58}],1064:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/color"),S=d("../../lib/setcursor"),M=d("../pie/helpers");te.findEntryWithLevel=function(r,t){var c;return t&&r.eachAfter(function(s){if(te.getPtId(s)===t)return c=s.copy()}),c||r},te.findEntryWithChild=function(r,t){var c;return r.eachAfter(function(s){for(var i=s.children||[],x=0;x<i.length;x++){var p=i[x];if(te.getPtId(p)===t)return c=s.copy()}}),c||r},te.isEntry=function(r){return!r.parent},te.isLeaf=function(r){return!r.children},te.getPtId=function(r){return r.data.data.id},te.getPtLabel=function(r){return r.data.data.label},te.getValue=function(r){return r.value},te.isHierarchyRoot=function(r){return n(r)===""},te.setSliceCursor=function(r,t,c){var s=c.isTransitioning;if(!s){var i=r.datum();s=c.hideOnRoot&&te.isHierarchyRoot(i)||c.hideOnLeaves&&te.isLeaf(i)}S(r,s?null:"pointer")};function e(r,t,c){return{color:te.getOutsideTextFontKey("color",r,t,c),family:te.getOutsideTextFontKey("family",r,t,c),size:te.getOutsideTextFontKey("size",r,t,c)}}function a(r,t,c,s){var i=(s||{}).onPathbar,x=t.data.data,p=x.i,v=A.castOption(r,p,(i?"pathbar.textfont":"insidetextfont")+".color");return!v&&r._input.textfont&&(v=A.castOption(r._input,p,"textfont.color")),{color:v||g.contrast(x.color),family:te.getInsideTextFontKey("family",r,t,c,s),size:te.getInsideTextFontKey("size",r,t,c,s)}}te.getInsideTextFontKey=function(r,t,c,s,i){var x=(i||{}).onPathbar,p=x?"pathbar.textfont":"insidetextfont",v=c.data.data.i;return A.castOption(t,v,p+"."+r)||A.castOption(t,v,"textfont."+r)||s.size},te.getOutsideTextFontKey=function(r,t,c,s){var i=c.data.data.i;return A.castOption(t,i,"outsidetextfont."+r)||A.castOption(t,i,"textfont."+r)||s.size},te.isOutsideText=function(r,t){return!r._hasColorscale&&te.isHierarchyRoot(t)},te.determineTextFont=function(r,t,c,s){return te.isOutsideText(r,t)?e(r,t,c):a(r,t,c,s)},te.hasTransition=function(r){return!!(r&&r.duration>0)},te.getMaxDepth=function(r){return r.maxdepth>=0?r.maxdepth:1/0},te.isHeader=function(r,t){return!(te.isLeaf(r)||r.depth===t._maxDepth-1)};function n(r){return r.data.data.pid}te.getParent=function(r,t){return te.findEntryWithLevel(r,n(t))},te.listPath=function(r,t){var c=r.parent;if(!c)return[];var s=t?[c.data[t]]:[c];return te.listPath(c,t).concat(s)},te.getPath=function(r){return te.listPath(r,"label").join("/")+"/"},te.formatValue=M.formatPieValue,te.formatPercent=function(r,t){var c=A.formatPercent(r,0);return c==="0%"&&(c=M.formatPiePercent(r,t)),c}},{"../../components/color":367,"../../lib":515,"../../lib/setcursor":536,"../pie/helpers":915}],1065:[function(d,ee,te){ee.exports={moduleType:"trace",name:"sunburst",basePlotModule:d("./base_plot"),categories:[],animatable:!0,attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot").plot,style:d("./style").style,colorbar:d("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1058,"./base_plot":1059,"./calc":1060,"./defaults":1062,"./layout_attributes":1066,"./layout_defaults":1067,"./plot":1068,"./style":1069}],1066:[function(d,ee,te){ee.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1067:[function(d,ee,te){var A=d("../../lib"),g=d("./layout_attributes");ee.exports=function(M,e){function a(n,r){return A.coerce(M,e,g,n,r)}a("sunburstcolorway",e.colorway),a("extendsunburstcolors")}},{"../../lib":515,"./layout_attributes":1066}],1068:[function(d,ee,te){var A=d("@plotly/d3"),g=d("d3-hierarchy"),S=d("d3-interpolate").interpolate,M=d("../../components/drawing"),e=d("../../lib"),a=d("../../lib/svg_text_utils"),n=d("../bar/uniform_text"),r=n.recordMinTextSize,t=n.clearMinTextSize,c=d("../pie/plot"),s=d("../pie/helpers").getRotationAngle,i=c.computeTransform,x=c.transformInsideText,p=d("./style").styleOne,v=d("../bar/style").resizeText,f=d("./fx"),y=d("./constants"),o=d("./helpers");te.plot=function(b,u,L,T){var k=b._fullLayout,P=k._sunburstlayer,z,I,D=!L,R=!k.uniformtext.mode&&o.hasTransition(L);if(t("sunburst",k),z=P.selectAll("g.trace.sunburst").data(u,function(F){return F[0].trace.uid}),z.enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),z.order(),R){T&&(I=T());var O=A.transition().duration(L.duration).ease(L.easing).each("end",function(){I&&I()}).each("interrupt",function(){I&&I()});O.each(function(){P.selectAll("g.trace").each(function(F){m(b,F,this,L)})})}else z.each(function(F){m(b,F,this,L)}),k.uniformtext.mode&&v(b,k._sunburstlayer.selectAll(".trace"),"sunburst");D&&z.exit().remove()};function m(b,u,L,T){var k=b._context.staticPlot,P=b._fullLayout,z=!P.uniformtext.mode&&o.hasTransition(T),I=A.select(L),D=I.selectAll("g.slice"),R=u[0],O=R.trace,F=R.hierarchy,N=o.findEntryWithLevel(F,O.level),G=o.getMaxDepth(O),K=P._size,W=O.domain,Y=K.w*(W.x[1]-W.x[0]),re=K.h*(W.y[1]-W.y[0]),ue=.5*Math.min(Y,re),j=R.cx=K.l+K.w*(W.x[1]+W.x[0])/2,q=R.cy=K.t+K.h*(1-W.y[0])-re/2;if(!N)return D.remove();var V=null,U={};z&&D.each(function(ke){U[o.getPtId(ke)]={rpx0:ke.rpx0,rpx1:ke.rpx1,x0:ke.x0,x1:ke.x1,transform:ke.transform},!V&&o.isEntry(ke)&&(V=ke)});var $=l(N).descendants(),ne=N.height+1,X=0,Q=G;R.hasMultipleRoots&&o.isHierarchyRoot(N)&&($=$.slice(1),ne-=1,X=1,Q+=1),$=$.filter(function(ke){return ke.y1<=Q});var ie=s(O.rotation);ie&&$.forEach(function(ke){ke.x0+=ie,ke.x1+=ie});var se=Math.min(ne,G),ae=function(ke){return(ke-X)/se*ue},oe=function(ke,Xe){return[ke*Math.cos(Xe),-ke*Math.sin(Xe)]},be=function(ke){return e.pathAnnulus(ke.rpx0,ke.rpx1,ke.x0,ke.x1,j,q)},ce=function(ke){return j+_(ke)[0]*(ke.transform.rCenter||0)+(ke.transform.x||0)},de=function(ke){return q+_(ke)[1]*(ke.transform.rCenter||0)+(ke.transform.y||0)};D=D.data($,o.getPtId),D.enter().append("g").classed("slice",!0),z?D.exit().transition().each(function(){var ke=A.select(this),Xe=ke.select("path.surface");Xe.transition().attrTween("d",function(Ie){var De=Ee(Ie);return function(Ge){return be(De(Ge))}});var He=ke.select("g.slicetext");He.attr("opacity",0)}).remove():D.exit().remove(),D.order();var ye=null;if(z&&V){var ge=o.getPtId(V);D.each(function(ke){ye===null&&o.getPtId(ke)===ge&&(ye=ke.x1)})}var me=D;z&&(me=me.transition().each("end",function(){var ke=A.select(this);o.setSliceCursor(ke,b,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),me.each(function(ke){var Xe=A.select(this),He=e.ensureSingle(Xe,"path","surface",function(Kt){Kt.style("pointer-events",k?"none":"all")});ke.rpx0=ae(ke.y0),ke.rpx1=ae(ke.y1),ke.xmid=(ke.x0+ke.x1)/2,ke.pxmid=oe(ke.rpx1,ke.xmid),ke.midangle=-(ke.xmid-Math.PI/2),ke.startangle=-(ke.x0-Math.PI/2),ke.stopangle=-(ke.x1-Math.PI/2),ke.halfangle=.5*Math.min(e.angleDelta(ke.x0,ke.x1)||Math.PI,Math.PI),ke.ring=1-ke.rpx0/ke.rpx1,ke.rInscribed=w(ke),z?He.transition().attrTween("d",function(Kt){var It=Pe(Kt);return function(Mt){return be(It(Mt))}}):He.attr("d",be),Xe.call(f,N,b,u,{eventDataKeys:y.eventDataKeys,transitionTime:y.CLICK_TRANSITION_TIME,transitionEasing:y.CLICK_TRANSITION_EASING}).call(o.setSliceCursor,b,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:b._transitioning}),He.call(p,ke,O);var Ie=e.ensureSingle(Xe,"g","slicetext"),De=e.ensureSingle(Ie,"text","",function(Kt){Kt.attr("data-notex",1)}),Ge=e.ensureUniformFontSize(b,o.determineTextFont(O,ke,P.font));De.text(te.formatSliceLabel(ke,N,O,u,P)).classed("slicetext",!0).attr("text-anchor","middle").call(M.font,Ge).call(a.convertToTspans,b);var ht=M.bBox(De.node());ke.transform=x(ht,ke,R),ke.transform.targetX=ce(ke),ke.transform.targetY=de(ke);var Rt=function(Kt,It){var Mt=Kt.transform;return i(Mt,It),Mt.fontSize=Ge.size,r(O.type,Mt,P),e.getTextTransform(Mt)};z?De.transition().attrTween("transform",function(Kt){var It=Ne(Kt);return function(Mt){return Rt(It(Mt),ht)}}):De.attr("transform",Rt(ke,ht))});function Ee(ke){var Xe=o.getPtId(ke),He=U[Xe],Ie=U[o.getPtId(N)],De;if(Ie){var Ge=(ke.x1>Ie.x1?2*Math.PI:0)+ie;De=ke.rpx1<Ie.rpx1?{x0:ke.x0,x1:ke.x1,rpx0:0,rpx1:0}:{x0:Ge,x1:Ge,rpx0:ke.rpx0,rpx1:ke.rpx1}}else{var ht,Rt=o.getPtId(ke.parent);D.each(function(zt){if(o.getPtId(zt)===Rt)return ht=zt});var Kt=ht.children,It;Kt.forEach(function(zt,St){if(o.getPtId(zt)===Xe)return It=St});var Mt=Kt.length,Yt=S(ht.x0,ht.x1);De={rpx0:ue,rpx1:ue,x0:Yt(It/Mt),x1:Yt((It+1)/Mt)}}return S(He,De)}function Pe(ke){var Xe=U[o.getPtId(ke)],He,Ie={x0:ke.x0,x1:ke.x1,rpx0:ke.rpx0,rpx1:ke.rpx1};if(Xe)He=Xe;else if(V)if(ke.parent)if(ye){var De=(ke.x1>ye?2*Math.PI:0)+ie;He={x0:De,x1:De}}else He={rpx0:ue,rpx1:ue},e.extendFlat(He,we(ke));else He={rpx0:0,rpx1:0};else He={x0:ie,x1:ie};return S(He,Ie)}function Ne(ke){var Xe=U[o.getPtId(ke)],He,Ie=ke.transform;if(Xe)He=Xe;else if(He={rpx1:ke.rpx1,transform:{textPosAngle:Ie.textPosAngle,scale:0,rotate:Ie.rotate,rCenter:Ie.rCenter,x:Ie.x,y:Ie.y}},V)if(ke.parent)if(ye){var De=ke.x1>ye?2*Math.PI:0;He.x0=He.x1=De}else e.extendFlat(He,we(ke));else He.x0=He.x1=ie;else He.x0=He.x1=ie;var Ge=S(He.transform.textPosAngle,ke.transform.textPosAngle),ht=S(He.rpx1,ke.rpx1),Rt=S(He.x0,ke.x0),Kt=S(He.x1,ke.x1),It=S(He.transform.scale,Ie.scale),Mt=S(He.transform.rotate,Ie.rotate),Yt=Ie.rCenter===0?3:He.transform.rCenter===0?1/3:1,zt=S(He.transform.rCenter,Ie.rCenter),St=function(Ye){return zt(Math.pow(Ye,Yt))};return function(Ye){var rt=ht(Ye),Ve=Rt(Ye),Ae=Kt(Ye),Ue=St(Ye),Ze=oe(rt,(Ve+Ae)/2),Qe=Ge(Ye),_t={pxmid:Ze,rpx1:rt,transform:{textPosAngle:Qe,rCenter:Ue,x:Ie.x,y:Ie.y}};return r(O.type,Ie,P),{transform:{targetX:ce(_t),targetY:de(_t),scale:It(Ye),rotate:Mt(Ye),rCenter:Ue}}}}function we(ke){var Xe=ke.parent,He=U[o.getPtId(Xe)],Ie={};if(He){var De=Xe.children,Ge=De.indexOf(ke),ht=De.length,Rt=S(He.x0,He.x1);Ie.x0=Rt(Ge/ht),Ie.x1=Rt(Ge/ht)}else Ie.x0=Ie.x1=0;return Ie}}function l(b){return g.partition().size([2*Math.PI,b.height+1])(b)}te.formatSliceLabel=function(b,u,L,T,k){var P=L.texttemplate,z=L.textinfo;if(!P&&(!z||z==="none"))return"";var I=k.separators,D=T[0],R=b.data.data,O=D.hierarchy,F=o.isHierarchyRoot(b),N=o.getParent(O,b),G=o.getValue(b);if(!P){var K=z.split("+"),W=function(X){return K.indexOf(X)!==-1},Y=[],re;if(W("label")&&R.label&&Y.push(R.label),R.hasOwnProperty("v")&&W("value")&&Y.push(o.formatValue(R.v,I)),!F){W("current path")&&Y.push(o.getPath(b.data));var ue=0;W("percent parent")&&ue++,W("percent entry")&&ue++,W("percent root")&&ue++;var j=ue>1;if(ue){var q,V=function(X){re=o.formatPercent(q,I),j&&(re+=" of "+X),Y.push(re)};W("percent parent")&&!F&&(q=G/o.getValue(N),V("parent")),W("percent entry")&&(q=G/o.getValue(u),V("entry")),W("percent root")&&(q=G/o.getValue(O),V("root"))}}return W("text")&&(re=e.castOption(L,R.i,"text"),e.isValidTextValue(re)&&Y.push(re)),Y.join("<br>")}var U=e.castOption(L,R.i,"texttemplate");if(!U)return"";var $={};R.label&&($.label=R.label),R.hasOwnProperty("v")&&($.value=R.v,$.valueLabel=o.formatValue(R.v,I)),$.currentPath=o.getPath(b.data),F||($.percentParent=G/o.getValue(N),$.percentParentLabel=o.formatPercent($.percentParent,I),$.parent=o.getPtLabel(N)),$.percentEntry=G/o.getValue(u),$.percentEntryLabel=o.formatPercent($.percentEntry,I),$.entry=o.getPtLabel(u),$.percentRoot=G/o.getValue(O),$.percentRootLabel=o.formatPercent($.percentRoot,I),$.root=o.getPtLabel(O),R.hasOwnProperty("color")&&($.color=R.color);var ne=e.castOption(L,R.i,"text");return(e.isValidTextValue(ne)||ne==="")&&($.text=ne),$.customdata=e.castOption(L,R.i,"customdata"),e.texttemplateString(U,$,k._d3locale,$,L._meta||{})};function w(b){return b.rpx0===0&&e.isFullCircle([b.x0,b.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(b.halfangle)),b.ring/2))}function _(b){return h(b.rpx1,b.transform.textPosAngle)}function h(b,u){return[b*Math.sin(u),-b*Math.cos(u)]}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/style":671,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"./constants":1061,"./fx":1063,"./helpers":1064,"./style":1069,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1069:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/color"),S=d("../../lib"),M=d("../bar/uniform_text").resizeText;function e(n){var r=n._fullLayout._sunburstlayer.selectAll(".trace");M(n,r,"sunburst"),r.each(function(t){var c=A.select(this),s=t[0],i=s.trace;c.style("opacity",i.opacity),c.selectAll("path.surface").each(function(x){A.select(this).call(a,x,i)})})}function a(n,r,t){var c=r.data.data,s=!r.children,i=c.i,x=S.castOption(t,i,"marker.line.color")||g.defaultLine,p=S.castOption(t,i,"marker.line.width")||0;n.style("stroke-width",p).call(g.fill,c.color).call(g.stroke,x).style("opacity",s?t.leaf.opacity:null)}ee.exports={style:e,styleOne:a}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],1070:[function(d,ee,te){var A=d("../../components/color"),g=d("../../components/colorscale/attributes"),S=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../plots/template_attributes").hovertemplateAttrs,e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat,n=d("../../plot_api/edit_types").overrideAll;function r(s){return{valType:"boolean",dflt:!1}}function t(s){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:r(),y:r(),z:r()},color:{valType:"color",dflt:A.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:A.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var c=ee.exports=n(a({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:M(),xhoverformat:S("x"),yhoverformat:S("y"),zhoverformat:S("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},g("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:t(),y:t(),z:t()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:a({},g.zauto,{}),zmin:a({},g.zmin,{}),zmax:a({},g.zmax,{})},hoverinfo:a({},e.hoverinfo),showlegend:a({},e.showlegend,{dflt:!1})}),"calc","nested");c.x.editType=c.y.editType=c.z.editType="calc+clearAxisTypes",c.transforms=void 0},{"../../components/color":367,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642}],1071:[function(d,ee,te){var A=d("../../components/colorscale/calc");ee.exports=function(S,M){M.surfacecolor?A(S,M,{vals:M.surfacecolor,containerStr:"",cLetter:"c"}):A(S,M,{vals:M.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],1072:[function(d,ee,te){var A=d("../../../stackgl_modules").gl_surface3d,g=d("../../../stackgl_modules").ndarray,S=d("../../../stackgl_modules").ndarray_linear_interpolate.d2,M=d("../heatmap/interp2d"),e=d("../heatmap/find_empties"),a=d("../../lib").isArrayOrTypedArray,n=d("../../lib/gl_format_color").parseColorScale,r=d("../../lib/str2rgbarray"),t=d("../../components/colorscale").extractOpts;function c(T,k,P){this.scene=T,this.uid=P,this.surface=k,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var s=c.prototype;s.getXat=function(T,k,P,z){var I=a(this.data.x)?a(this.data.x[0])?this.data.x[k][T]:this.data.x[T]:T;return P===void 0?I:z.d2l(I,0,P)},s.getYat=function(T,k,P,z){var I=a(this.data.y)?a(this.data.y[0])?this.data.y[k][T]:this.data.y[k]:k;return P===void 0?I:z.d2l(I,0,P)},s.getZat=function(T,k,P,z){var I=this.data.z[k][T];return I===null&&this.data.connectgaps&&this.data._interpolatedZ&&(I=this.data._interpolatedZ[k][T]),P===void 0?I:z.d2l(I,0,P)},s.handlePick=function(T){if(T.object===this.surface){var k=(T.data.index[0]-1)/this.dataScaleX-1,P=(T.data.index[1]-1)/this.dataScaleY-1,z=Math.max(Math.min(Math.round(k),this.data.z[0].length-1),0),I=Math.max(Math.min(Math.round(P),this.data._ylength-1),0);T.index=[z,I],T.traceCoordinate=[this.getXat(z,I),this.getYat(z,I),this.getZat(z,I)],T.dataCoordinate=[this.getXat(z,I,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(z,I,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(z,I,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var D=0;D<3;D++){var R=T.dataCoordinate[D];R!=null&&(T.dataCoordinate[D]*=this.scene.dataScale[D])}var O=this.data.hovertext||this.data.text;return Array.isArray(O)&&O[I]&&O[I][z]!==void 0?T.textLabel=O[I][z]:O?T.textLabel=O:T.textLabel="",T.data.dataCoordinate=T.dataCoordinate.slice(),this.surface.highlight(T.data),this.scene.glplot.spikes.position=T.dataCoordinate,!0}};function i(T){var k=T[0].rgb,P=T[T.length-1].rgb;return k[0]===P[0]&&k[1]===P[1]&&k[2]===P[2]&&k[3]===P[3]}var x=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function p(T,k){if(T<k)return 0;for(var P=0;Math.floor(T%k)===0;)T/=k,P++;return P}function v(T){for(var k=[],P=0;P<x.length;P++){var z=x[P];k.push(p(T,z))}return k}function f(T){for(var k=v(T),P=T,z=0;z<x.length;z++)if(k[z]>0){P=x[z];break}return P}function y(T,k){if(!(T<1||k<1)){for(var P=v(T),z=v(k),I=1,D=0;D<x.length;D++)I*=Math.pow(x[D],Math.max(P[D],z[D]));return I}}function o(T){if(T.length!==0){for(var k=1,P=0;P<T.length;P++)k=y(k,T[P]);return k}}s.calcXnums=function(T){var k,P=[];for(k=1;k<T;k++){var z=this.getXat(k-1,0),I=this.getXat(k,0);I!==z&&z!==void 0&&z!==null&&I!==void 0&&I!==null?P[k-1]=Math.abs(I-z):P[k-1]=0}var D=0;for(k=1;k<T;k++)D+=P[k-1];for(k=1;k<T;k++)P[k-1]===0?P[k-1]=1:P[k-1]=Math.round(D/P[k-1]);return P},s.calcYnums=function(T){var k,P=[];for(k=1;k<T;k++){var z=this.getYat(0,k-1),I=this.getYat(0,k);I!==z&&z!==void 0&&z!==null&&I!==void 0&&I!==null?P[k-1]=Math.abs(I-z):P[k-1]=0}var D=0;for(k=1;k<T;k++)D+=P[k-1];for(k=1;k<T;k++)P[k-1]===0?P[k-1]=1:P[k-1]=Math.round(D/P[k-1]);return P};var m=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],l=m[9],w=m[13];s.estimateScale=function(T,k){for(var P=k===0?this.calcXnums(T):this.calcYnums(T),z=1+o(P);z<l;)z*=2;for(;z>w;)z--,z/=f(z),z++,z<l&&(z=w);var I=Math.round(z/T);return I>1?I:1};function _(T,k,P){var z=P[8]+P[2]*k[0]+P[5]*k[1];return T[0]=(P[6]+P[0]*k[0]+P[3]*k[1])/z,T[1]=(P[7]+P[1]*k[0]+P[4]*k[1])/z,T}function h(T,k,P){return b(T,k,_,P),T}function b(T,k,P,z){for(var I=[0,0],D=T.shape[0],R=T.shape[1],O=0;O<D;O++)for(var F=0;F<R;F++)P(I,[O,F],z),T.set(O,F,S(k,I[0],I[1]));return T}s.refineCoords=function(T){for(var k=this.dataScaleX,P=this.dataScaleY,z=T[0].shape[0],I=T[0].shape[1],D=Math.floor(T[0].shape[0]*k+1)|0,R=Math.floor(T[0].shape[1]*P+1)|0,O=1+z+1,F=1+I+1,N=g(new Float32Array(O*F),[O,F]),G=[1/k,0,0,0,1/P,0,0,0,1],K=0;K<T.length;++K){this.surface.padField(N,T[K]);var W=g(new Float32Array(D*R),[D,R]);h(W,N,G),T[K]=W}};function u(T,k){for(var P=!1,z=0;z<T.length;z++)if(k===T[z]){P=!0;break}P===!1&&T.push(k)}s.setContourLevels=function(){var T=[[],[],[]],k=[!1,!1,!1],P=!1,z,I,D;for(z=0;z<3;++z)if(this.showContour[z]&&(P=!0,this.contourSize[z]>0&&this.contourStart[z]!==null&&this.contourEnd[z]!==null&&this.contourEnd[z]>this.contourStart[z]))for(k[z]=!0,I=this.contourStart[z];I<this.contourEnd[z];I+=this.contourSize[z])D=I*this.scene.dataScale[z],u(T[z],D);if(P){var R=[[],[],[]];for(z=0;z<3;++z)this.showContour[z]&&(R[z]=k[z]?T[z]:this.scene.contourLevels[z]);this.surface.update({levels:R})}},s.update=function(T){var k=this.scene,P=k.fullSceneLayout,z=this.surface,I=n(T),D=k.dataScale,R=T.z[0].length,O=T._ylength,F=k.contourLevels;this.data=T;var N,G,K,W,Y=[];for(N=0;N<3;N++)for(Y[N]=[],G=0;G<R;G++)Y[N][G]=[];for(G=0;G<R;G++)for(K=0;K<O;K++)Y[0][G][K]=this.getXat(G,K,T.xcalendar,P.xaxis),Y[1][G][K]=this.getYat(G,K,T.ycalendar,P.yaxis),Y[2][G][K]=this.getZat(G,K,T.zcalendar,P.zaxis);if(T.connectgaps)for(T._emptypoints=e(Y[2]),M(Y[2],T._emptypoints),T._interpolatedZ=[],G=0;G<R;G++)for(T._interpolatedZ[G]=[],K=0;K<O;K++)T._interpolatedZ[G][K]=Y[2][G][K];for(N=0;N<3;N++)for(G=0;G<R;G++)for(K=0;K<O;K++)W=Y[N][G][K],W==null?Y[N][G][K]=NaN:W=Y[N][G][K]*=D[N];for(N=0;N<3;N++)for(G=0;G<R;G++)for(K=0;K<O;K++)W=Y[N][G][K],W!=null&&(this.minValues[N]>W&&(this.minValues[N]=W),this.maxValues[N]<W&&(this.maxValues[N]=W));for(N=0;N<3;N++)this.objectOffset[N]=.5*(this.minValues[N]+this.maxValues[N]);for(N=0;N<3;N++)for(G=0;G<R;G++)for(K=0;K<O;K++)W=Y[N][G][K],W!=null&&(Y[N][G][K]-=this.objectOffset[N]);var re=[g(new Float32Array(R*O),[R,O]),g(new Float32Array(R*O),[R,O]),g(new Float32Array(R*O),[R,O])];for(N=0;N<3;N++)for(G=0;G<R;G++)for(K=0;K<O;K++)re[N].set(G,K,Y[N][G][K]);Y=[];var ue={colormap:I,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!T.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:T.opacityscale,opacity:T.opacity},j=t(T);if(ue.intensityBounds=[j.min,j.max],T.surfacecolor){var q=g(new Float32Array(R*O),[R,O]);for(G=0;G<R;G++)for(K=0;K<O;K++)q.set(G,K,T.surfacecolor[K][G]);re.push(q)}else ue.intensityBounds[0]*=D[2],ue.intensityBounds[1]*=D[2];(w<re[0].shape[0]||w<re[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(re[0].shape[0],0),this.dataScaleY=this.estimateScale(re[0].shape[1],1),(this.dataScaleX!==1||this.dataScaleY!==1)&&this.refineCoords(re)),T.surfacecolor&&(ue.intensity=re.pop());var V=[!0,!0,!0],U=["x","y","z"];for(N=0;N<3;++N){var $=T.contours[U[N]];V[N]=$.highlight,ue.showContour[N]=$.show||$.highlight,ue.showContour[N]&&(ue.contourProject[N]=[$.project.x,$.project.y,$.project.z],$.show?(this.showContour[N]=!0,ue.levels[N]=F[N],z.highlightColor[N]=ue.contourColor[N]=r($.color),$.usecolormap?z.highlightTint[N]=ue.contourTint[N]=0:z.highlightTint[N]=ue.contourTint[N]=1,ue.contourWidth[N]=$.width,this.contourStart[N]=$.start,this.contourEnd[N]=$.end,this.contourSize[N]=$.size):(this.showContour[N]=!1,this.contourStart[N]=null,this.contourEnd[N]=null,this.contourSize[N]=0),$.highlight&&(ue.dynamicColor[N]=r($.highlightcolor),ue.dynamicWidth[N]=$.highlightwidth))}i(I)&&(ue.vertexColor=!0),ue.objectOffset=this.objectOffset,ue.coords=re,z.update(ue),z.visible=T.visible,z.enableDynamic=V,z.enableHighlight=V,z.snapToData=!0,"lighting"in T&&(z.ambientLight=T.lighting.ambient,z.diffuseLight=T.lighting.diffuse,z.specularLight=T.lighting.specular,z.roughness=T.lighting.roughness,z.fresnel=T.lighting.fresnel),"lightposition"in T&&(z.lightPosition=[T.lightposition.x,T.lightposition.y,T.lightposition.z])},s.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()};function L(T,k){var P=T.glplot.gl,z=A({gl:P}),I=new c(T,z,k.uid);return z._trace=I,I.update(k),T.glplot.add(z),I}ee.exports=L},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../heatmap/find_empties":807,"../heatmap/interp2d":810}],1073:[function(d,ee,te){var A=d("../../registry"),g=d("../../lib"),S=d("../../components/colorscale/defaults"),M=d("./attributes"),e=.1;function a(s,i){for(var x=[],p=32,v=0;v<p;v++){var f=v/(p-1),y=i+(1-i)*(1-Math.pow(Math.sin(s*f*Math.PI),2));x.push([f,Math.max(0,Math.min(1,y))])}return x}function n(s){var i=0;if(!Array.isArray(s)||s.length<2||!s[0]||!s[s.length-1]||+s[0][0]!=0||+s[s.length-1][0]!=1)return!1;for(var x=0;x<s.length;x++){var p=s[x];if(p.length!==2||+p[0]<i)return!1;i=+p[0]}return!0}function r(s,i,x,p){var v,f;function y(T,k){return g.coerce(s,i,M,T,k)}var o=y("x"),m=y("y"),l=y("z");if(!l||!l.length||(o?o.length<1:!1)||(m?m.length<1:!1)){i.visible=!1;return}i._xlength=Array.isArray(o)&&g.isArrayOrTypedArray(o[0])?l.length:l[0].length,i._ylength=l.length;var w=A.getComponentMethod("calendars","handleTraceDefaults");w(s,i,["x","y","z"],p),y("text"),y("hovertext"),y("hovertemplate"),y("xhoverformat"),y("yhoverformat"),y("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(T){y(T)});var _=y("surfacecolor"),h=["x","y","z"];for(v=0;v<3;++v){var b="contours."+h[v],u=y(b+".show"),L=y(b+".highlight");if(u||L)for(f=0;f<3;++f)y(b+".project."+h[f]);u&&(y(b+".color"),y(b+".width"),y(b+".usecolormap")),L&&(y(b+".highlightcolor"),y(b+".highlightwidth")),y(b+".start"),y(b+".end"),y(b+".size")}_||(c(s,"zmin","cmin"),c(s,"zmax","cmax"),c(s,"zauto","cauto")),S(s,i,p,y,{prefix:"",cLetter:"c"}),t(s,i,p,y),i._length=null}function t(s,i,x,p){var v=p("opacityscale");v==="max"?i.opacityscale=[[0,e],[1,1]]:v==="min"?i.opacityscale=[[0,1],[1,e]]:v==="extremes"?i.opacityscale=a(1,e):n(v)||(i.opacityscale=void 0)}function c(s,i,x){i in s&&!(x in s)&&(s[x]=s[i])}ee.exports={supplyDefaults:r,opacityscaleDefaults:t}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":1070}],1074:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:d("./calc"),plot:d("./convert"),moduleType:"trace",name:"surface",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":1070,"./calc":1071,"./convert":1072,"./defaults":1073}],1075:[function(d,ee,te){var A=d("../../components/annotations/attributes"),g=d("../../lib/extend").extendFlat,S=d("../../plot_api/edit_types").overrideAll,M=d("../../plots/font_attributes"),e=d("../../plots/domain").attributes,a=d("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,n=ee.exports=S({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:a("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:g({},A.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:g({},M({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:a("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:g({},A.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:g({},M({arrayOk:!0}))}},"calc","from-root");n.transforms=void 0},{"../../components/annotations/attributes":350,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594}],1076:[function(d,ee,te){var A=d("../../plots/get_data").getModuleCalcData,g=d("./plot"),S="table";te.name=S,te.plot=function(M){var e=A(M.calcdata,S)[0];e.length&&g(M,e)},te.clean=function(M,e,a,n){var r=n._has&&n._has(S),t=e._has&&e._has(S);r&&!t&&n._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":602,"./plot":1083}],1077:[function(d,ee,te){var A=d("../../lib/gup").wrap;ee.exports=function(){return A({})}},{"../../lib/gup":512}],1078:[function(d,ee,te){ee.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1079:[function(d,ee,te){var A=d("./constants"),g=d("../../lib/extend").extendFlat,S=d("fast-isnumeric");ee.exports=function(x,p){var v=a(p.cells.values),f=function(G){return G.slice(p.header.values.length,G.length)},y=a(p.header.values);y.length&&!y[0].length&&(y[0]=[""],y=a(y));var o=y.concat(f(v).map(function(){return n((y[0]||[""]).length)})),m=p.domain,l=Math.floor(x._fullLayout._size.w*(m.x[1]-m.x[0])),w=Math.floor(x._fullLayout._size.h*(m.y[1]-m.y[0])),_=p.header.values.length?o[0].map(function(){return p.header.height}):[A.emptyHeaderHeight],h=v.length?v[0].map(function(){return p.cells.height}):[],b=_.reduce(e,0),u=w-b,L=u+A.uplift,T=c(h,L),k=c(_,b),P=t(k,[]),z=t(T,P),I={},D=p._fullInput.columnorder.concat(f(v.map(function(G,K){return K}))),R=o.map(function(G,K){var W=Array.isArray(p.columnwidth)?p.columnwidth[Math.min(K,p.columnwidth.length-1)]:p.columnwidth;return S(W)?Number(W):1}),O=R.reduce(e,0);R=R.map(function(G){return G/O*l});var F=Math.max(M(p.header.line.width),M(p.cells.line.width)),N={key:p.uid+x._context.staticPlot,translateX:m.x[0]*x._fullLayout._size.w,translateY:x._fullLayout._size.h*(1-m.y[1]),size:x._fullLayout._size,width:l,maxLineWidth:F,height:w,columnOrder:D,groupHeight:w,rowBlocks:z,headerRowBlocks:P,scrollY:0,cells:g({},p.cells,{values:v}),headerCells:g({},p.header,{values:o}),gdColumns:o.map(function(G){return G[0]}),gdColumnsOriginalOrder:o.map(function(G){return G[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:o.map(function(G,K){var W=I[G];I[G]=(W||0)+1;var Y=G+"__"+I[G];return{key:Y,label:G,specIndex:K,xIndex:D[K],xScale:r,x:void 0,calcdata:void 0,columnWidth:R[K]}})};return N.columns.forEach(function(G){G.calcdata=N,G.x=r(G)}),N};function M(i){if(Array.isArray(i)){for(var x=0,p=0;p<i.length;p++)x=Math.max(x,M(i[p]));return x}return i}function e(i,x){return i+x}function a(i){var x=i.slice(),p=1/0,v=0,f;for(f=0;f<x.length;f++)Array.isArray(x[f])||(x[f]=[x[f]]),p=Math.min(p,x[f].length),v=Math.max(v,x[f].length);if(p!==v)for(f=0;f<x.length;f++){var y=v-x[f].length;y&&(x[f]=x[f].concat(n(y)))}return x}function n(i){for(var x=new Array(i),p=0;p<i;p++)x[p]="";return x}function r(i){return i.calcdata.columns.reduce(function(x,p){return p.xIndex<i.xIndex?x+p.columnWidth:x},0)}function t(i,x){var p=Object.keys(i);return p.map(function(v){return g({},i[v],{auxiliaryBlocks:x})})}function c(i,x){for(var p={},v,f=0,y=0,o=s(),m=0,l=0,w=0;w<i.length;w++)v=i[w],o.rows.push({rowIndex:w,rowHeight:v}),y+=v,(y>=x||w===i.length-1)&&(p[f]=o,o.key=l++,o.firstRowIndex=m,o.lastRowIndex=w,o=s(),f+=y,m=w+1,y=0);return p}function s(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}},{"../../lib/extend":505,"./constants":1078,"fast-isnumeric":190}],1080:[function(d,ee,te){var A=d("../../lib/extend").extendFlat;te.splitToPanels=function(S){var M=[0,0],e=A({},S,{key:"header",type:"header",page:0,prevPages:M,currentRepaint:[null,null],dragHandle:!0,values:S.calcdata.headerCells.values[S.specIndex],rowBlocks:S.calcdata.headerRowBlocks,calcdata:A({},S.calcdata,{cells:S.calcdata.headerCells})}),a=A({},S,{key:"cells1",type:"cells",page:0,prevPages:M,currentRepaint:[null,null],dragHandle:!1,values:S.calcdata.cells.values[S.specIndex],rowBlocks:S.calcdata.rowBlocks}),n=A({},S,{key:"cells2",type:"cells",page:1,prevPages:M,currentRepaint:[null,null],dragHandle:!1,values:S.calcdata.cells.values[S.specIndex],rowBlocks:S.calcdata.rowBlocks});return[a,n,e]},te.splitToCells=function(S){var M=g(S);return(S.values||[]).slice(M[0],M[1]).map(function(e,a){var n=typeof e=="string"&&e.match(/[<$&> ]/)?"_keybuster_"+Math.random():"";return{keyWithinBlock:a+n,key:M[0]+a,column:S,calcdata:S.calcdata,page:S.page,rowBlocks:S.rowBlocks,value:e}})};function g(S){var M=S.rowBlocks[S.page],e=M?M.rows[0].rowIndex:0,a=M?e+M.rows.length:0;return[e,a]}},{"../../lib/extend":505}],1081:[function(d,ee,te){var A=d("../../lib"),g=d("./attributes"),S=d("../../plots/domain").defaults;function M(e,a){for(var n=e.columnorder||[],r=e.header.values.length,t=n.slice(0,r),c=t.slice().sort(function(x,p){return x-p}),s=t.map(function(x){return c.indexOf(x)}),i=s.length;i<r;i++)s.push(i);a("columnorder",s)}ee.exports=function(a,n,r,t){function c(s,i){return A.coerce(a,n,g,s,i)}S(n,t,c),c("columnwidth"),c("header.values"),c("header.format"),c("header.align"),c("header.prefix"),c("header.suffix"),c("header.height"),c("header.line.width"),c("header.line.color"),c("header.fill.color"),A.coerceFont(c,"header.font",A.extendFlat({},t.font)),M(n,c),c("cells.values"),c("cells.format"),c("cells.align"),c("cells.prefix"),c("cells.suffix"),c("cells.height"),c("cells.line.width"),c("cells.line.color"),c("cells.fill.color"),A.coerceFont(c,"cells.font",A.extendFlat({},t.font)),n._length=null}},{"../../lib":515,"../../plots/domain":593,"./attributes":1075}],1082:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),moduleType:"trace",name:"table",basePlotModule:d("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1075,"./base_plot":1076,"./calc":1077,"./defaults":1081,"./plot":1083}],1083:[function(d,ee,te){var A=d("./constants"),g=d("@plotly/d3"),S=d("../../lib"),M=S.numberFormat,e=d("../../lib/gup"),a=d("../../components/drawing"),n=d("../../lib/svg_text_utils"),r=d("../../lib").raiseToTop,t=d("../../lib").strTranslate,c=d("../../lib").cancelTransition,s=d("./data_preparation_helper"),i=d("./data_split_helpers"),x=d("../../components/color");ee.exports=function(ie,se){var ae=!ie._context.staticPlot,oe=ie._fullLayout._paper.selectAll("."+A.cn.table).data(se.map(function(Ie){var De=e.unwrap(Ie),Ge=De.trace;return s(ie,Ge)}),e.keyFun);oe.exit().remove(),oe.enter().append("g").classed(A.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),oe.attr("width",function(Ie){return Ie.width+Ie.size.l+Ie.size.r}).attr("height",function(Ie){return Ie.height+Ie.size.t+Ie.size.b}).attr("transform",function(Ie){return t(Ie.translateX,Ie.translateY)});var be=oe.selectAll("."+A.cn.tableControlView).data(e.repeat,e.keyFun),ce=be.enter().append("g").classed(A.cn.tableControlView,!0).style("box-sizing","content-box");if(ae){var de="onwheel"in document?"wheel":"mousewheel";ce.on("mousemove",function(Ie){be.filter(function(De){return Ie===De}).call(o,ie)}).on(de,function(Ie){if(!Ie.scrollbarState.wheeling){Ie.scrollbarState.wheeling=!0;var De=Ie.scrollY+g.event.deltaY,Ge=W(ie,be,null,De)(Ie);Ge||(g.event.stopPropagation(),g.event.preventDefault()),Ie.scrollbarState.wheeling=!1}}).call(o,ie,!0)}be.attr("transform",function(Ie){return t(Ie.size.l,Ie.size.t)});var ye=be.selectAll("."+A.cn.scrollBackground).data(e.repeat,e.keyFun);ye.enter().append("rect").classed(A.cn.scrollBackground,!0).attr("fill","none"),ye.attr("width",function(Ie){return Ie.width}).attr("height",function(Ie){return Ie.height}),be.each(function(Ie){a.setClipUrl(g.select(this),v(ie,Ie),ie)});var ge=be.selectAll("."+A.cn.yColumn).data(function(Ie){return Ie.columns},e.keyFun);ge.enter().append("g").classed(A.cn.yColumn,!0),ge.exit().remove(),ge.attr("transform",function(Ie){return t(Ie.x,0)}),ae&&ge.call(g.behavior.drag().origin(function(Ie){var De=g.select(this);return R(De,Ie,-A.uplift),r(this),Ie.calcdata.columnDragInProgress=!0,o(be.filter(function(Ge){return Ie.calcdata.key===Ge.key}),ie),Ie}).on("drag",function(Ie){var De=g.select(this),Ge=function(Kt){return(Ie===Kt?g.event.x:Kt.x)+Kt.columnWidth/2};Ie.x=Math.max(-A.overdrag,Math.min(Ie.calcdata.width+A.overdrag-Ie.columnWidth,g.event.x));var ht=y(ge).filter(function(Kt){return Kt.calcdata.key===Ie.calcdata.key}),Rt=ht.sort(function(Kt,It){return Ge(Kt)-Ge(It)});Rt.forEach(function(Kt,It){Kt.xIndex=It,Kt.x=Ie===Kt?Kt.x:Kt.xScale(Kt)}),ge.filter(function(Kt){return Ie!==Kt}).transition().ease(A.transitionEase).duration(A.transitionDuration).attr("transform",function(Kt){return t(Kt.x,0)}),De.call(c).attr("transform",t(Ie.x,-A.uplift))}).on("dragend",function(Ie){var De=g.select(this),Ge=Ie.calcdata;Ie.x=Ie.xScale(Ie),Ie.calcdata.columnDragInProgress=!1,R(De,Ie,0),I(ie,Ge,Ge.columns.map(function(ht){return ht.xIndex}))})),ge.each(function(Ie){a.setClipUrl(g.select(this),f(ie,Ie),ie)});var me=ge.selectAll("."+A.cn.columnBlock).data(i.splitToPanels,e.keyFun);me.enter().append("g").classed(A.cn.columnBlock,!0).attr("id",function(Ie){return Ie.key}),me.style("cursor",function(Ie){return Ie.dragHandle?"ew-resize":Ie.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var Ee=me.filter(F),Pe=me.filter(O);ae&&Pe.call(g.behavior.drag().origin(function(Ie){return g.event.stopPropagation(),Ie}).on("drag",W(ie,be,-1)).on("dragend",function(){})),m(ie,be,Ee,me),m(ie,be,Pe,me);var Ne=be.selectAll("."+A.cn.scrollAreaClip).data(e.repeat,e.keyFun);Ne.enter().append("clipPath").classed(A.cn.scrollAreaClip,!0).attr("id",function(Ie){return v(ie,Ie)});var we=Ne.selectAll("."+A.cn.scrollAreaClipRect).data(e.repeat,e.keyFun);we.enter().append("rect").classed(A.cn.scrollAreaClipRect,!0).attr("x",-A.overdrag).attr("y",-A.uplift).attr("fill","none"),we.attr("width",function(Ie){return Ie.width+2*A.overdrag}).attr("height",function(Ie){return Ie.height+A.uplift});var ke=ge.selectAll("."+A.cn.columnBoundary).data(e.repeat,e.keyFun);ke.enter().append("g").classed(A.cn.columnBoundary,!0);var Xe=ge.selectAll("."+A.cn.columnBoundaryClippath).data(e.repeat,e.keyFun);Xe.enter().append("clipPath").classed(A.cn.columnBoundaryClippath,!0),Xe.attr("id",function(Ie){return f(ie,Ie)});var He=Xe.selectAll("."+A.cn.columnBoundaryRect).data(e.repeat,e.keyFun);He.enter().append("rect").classed(A.cn.columnBoundaryRect,!0).attr("fill","none"),He.attr("width",function(Ie){return Ie.columnWidth+2*p(Ie)}).attr("height",function(Ie){return Ie.calcdata.height+2*p(Ie)+A.uplift}).attr("x",function(Ie){return-p(Ie)}).attr("y",function(Ie){return-p(Ie)}),K(null,Pe,be)};function p(Q){return Math.ceil(Q.calcdata.maxLineWidth/2)}function v(Q,ie){return"clip"+Q._fullLayout._uid+"_scrollAreaBottomClip_"+ie.key}function f(Q,ie){return"clip"+Q._fullLayout._uid+"_columnBoundaryClippath_"+ie.calcdata.key+"_"+ie.specIndex}function y(Q){return[].concat.apply([],Q.map(function(ie){return ie})).map(function(ie){return ie.__data__})}function o(Q,ie,se){function ae(ge){var me=ge.rowBlocks;return V(me,me.length-1)+(me.length?U(me[me.length-1],1/0):1)}var oe=Q.selectAll("."+A.cn.scrollbarKit).data(e.repeat,e.keyFun);oe.enter().append("g").classed(A.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),oe.each(function(ge){var me=ge.scrollbarState;me.totalHeight=ae(ge),me.scrollableAreaHeight=ge.groupHeight-N(ge),me.currentlyVisibleHeight=Math.min(me.totalHeight,me.scrollableAreaHeight),me.ratio=me.currentlyVisibleHeight/me.totalHeight,me.barLength=Math.max(me.ratio*me.currentlyVisibleHeight,A.goldenRatio*A.scrollbarWidth),me.barWiggleRoom=me.currentlyVisibleHeight-me.barLength,me.wiggleRoom=Math.max(0,me.totalHeight-me.scrollableAreaHeight),me.topY=me.barWiggleRoom===0?0:ge.scrollY/me.wiggleRoom*me.barWiggleRoom,me.bottomY=me.topY+me.barLength,me.dragMultiplier=me.wiggleRoom/me.barWiggleRoom}).attr("transform",function(ge){var me=ge.width+A.scrollbarWidth/2+A.scrollbarOffset;return t(me,N(ge))});var be=oe.selectAll("."+A.cn.scrollbar).data(e.repeat,e.keyFun);be.enter().append("g").classed(A.cn.scrollbar,!0);var ce=be.selectAll("."+A.cn.scrollbarSlider).data(e.repeat,e.keyFun);ce.enter().append("g").classed(A.cn.scrollbarSlider,!0),ce.attr("transform",function(ge){return t(0,ge.scrollbarState.topY||0)});var de=ce.selectAll("."+A.cn.scrollbarGlyph).data(e.repeat,e.keyFun);de.enter().append("line").classed(A.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",A.scrollbarWidth).attr("stroke-linecap","round").attr("y1",A.scrollbarWidth/2),de.attr("y2",function(ge){return ge.scrollbarState.barLength-A.scrollbarWidth/2}).attr("stroke-opacity",function(ge){return ge.columnDragInProgress||!ge.scrollbarState.barWiggleRoom||se?0:.4}),de.transition().delay(0).duration(0),de.transition().delay(A.scrollbarHideDelay).duration(A.scrollbarHideDuration).attr("stroke-opacity",0);var ye=be.selectAll("."+A.cn.scrollbarCaptureZone).data(e.repeat,e.keyFun);ye.enter().append("line").classed(A.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",A.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(ge){var me=g.event.y,Ee=this.getBoundingClientRect(),Pe=ge.scrollbarState,Ne=me-Ee.top,we=g.scale.linear().domain([0,Pe.scrollableAreaHeight]).range([0,Pe.totalHeight]).clamp(!0);Pe.topY<=Ne&&Ne<=Pe.bottomY||W(ie,Q,null,we(Ne-Pe.barLength/2))(ge)}).call(g.behavior.drag().origin(function(ge){return g.event.stopPropagation(),ge.scrollbarState.scrollbarScrollInProgress=!0,ge}).on("drag",W(ie,Q)).on("dragend",function(){})),ye.attr("y2",function(ge){return ge.scrollbarState.scrollableAreaHeight}),ie._context.staticPlot&&(de.remove(),ye.remove())}function m(Q,ie,se,ae){var oe=l(se),be=w(oe);u(be);var ce=_(be);T(ce);var de=b(be),ye=h(de);L(ye),k(ye,ie,ae,Q),q(be)}function l(Q){var ie=Q.selectAll("."+A.cn.columnCells).data(e.repeat,e.keyFun);return ie.enter().append("g").classed(A.cn.columnCells,!0),ie.exit().remove(),ie}function w(Q){var ie=Q.selectAll("."+A.cn.columnCell).data(i.splitToCells,function(se){return se.keyWithinBlock});return ie.enter().append("g").classed(A.cn.columnCell,!0),ie.exit().remove(),ie}function _(Q){var ie=Q.selectAll("."+A.cn.cellRect).data(e.repeat,function(se){return se.keyWithinBlock});return ie.enter().append("rect").classed(A.cn.cellRect,!0),ie}function h(Q){var ie=Q.selectAll("."+A.cn.cellText).data(e.repeat,function(se){return se.keyWithinBlock});return ie.enter().append("text").classed(A.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){g.event.stopPropagation()}),ie}function b(Q){var ie=Q.selectAll("."+A.cn.cellTextHolder).data(e.repeat,function(se){return se.keyWithinBlock});return ie.enter().append("g").classed(A.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),ie}function u(Q){Q.each(function(ie,se){var ae=ie.calcdata.cells.font,oe=ie.column.specIndex,be={size:D(ae.size,oe,se),color:D(ae.color,oe,se),family:D(ae.family,oe,se)};ie.rowNumber=ie.key,ie.align=D(ie.calcdata.cells.align,oe,se),ie.cellBorderWidth=D(ie.calcdata.cells.line.width,oe,se),ie.font=be})}function L(Q){Q.each(function(ie){a.font(g.select(this),ie.font)})}function T(Q){Q.attr("width",function(ie){return ie.column.columnWidth}).attr("stroke-width",function(ie){return ie.cellBorderWidth}).each(function(ie){var se=g.select(this);x.stroke(se,D(ie.calcdata.cells.line.color,ie.column.specIndex,ie.rowNumber)),x.fill(se,D(ie.calcdata.cells.fill.color,ie.column.specIndex,ie.rowNumber))})}function k(Q,ie,se,ae){Q.text(function(oe){var be=oe.column.specIndex,ce=oe.rowNumber,de=oe.value,ye=typeof de=="string",ge=ye&&de.match(/<br>/i),me=!ye||ge;oe.mayHaveMarkup=ye&&de.match(/[<&>]/);var Ee=P(de);oe.latex=Ee;var Pe=Ee?"":D(oe.calcdata.cells.prefix,be,ce)||"",Ne=Ee?"":D(oe.calcdata.cells.suffix,be,ce)||"",we=Ee?null:D(oe.calcdata.cells.format,be,ce)||null,ke=Pe+(we?M(we)(oe.value):oe.value)+Ne,Xe;oe.wrappingNeeded=!oe.wrapped&&!me&&!Ee&&(Xe=z(ke)),oe.cellHeightMayIncrease=ge||Ee||oe.mayHaveMarkup||(Xe===void 0?z(ke):Xe),oe.needsConvertToTspans=oe.mayHaveMarkup||oe.wrappingNeeded||oe.latex;var He;if(oe.wrappingNeeded){var Ie=A.wrapSplitCharacter===" "?ke.replace(/<a href=/ig,"<a_href="):ke,De=Ie.split(A.wrapSplitCharacter),Ge=A.wrapSplitCharacter===" "?De.map(function(ht){return ht.replace(/<a_href=/ig,"<a href=")}):De;oe.fragments=Ge.map(function(ht){return{text:ht,width:null}}),oe.fragments.push({fragment:A.wrapSpacer,width:null}),He=Ge.join(A.lineBreaker)+A.lineBreaker+A.wrapSpacer}else delete oe.fragments,He=ke;return He}).attr("dy",function(oe){return oe.needsConvertToTspans?0:"0.75em"}).each(function(oe){var be=this,ce=g.select(be),de=oe.wrappingNeeded?re:ue;oe.needsConvertToTspans?n.convertToTspans(ce,ae,de(se,be,ie,ae,oe)):g.select(be.parentNode).attr("transform",function(ye){return t(j(ye),A.cellPad)}).attr("text-anchor",function(ye){return{left:"start",center:"middle",right:"end"}[ye.align]})})}function P(Q){return typeof Q=="string"&&Q.match(A.latexCheck)}function z(Q){return Q.indexOf(A.wrapSplitCharacter)!==-1}function I(Q,ie,se){var ae=ie.gdColumnsOriginalOrder;ie.gdColumns.sort(function(oe,be){return se[ae.indexOf(oe)]-se[ae.indexOf(be)]}),ie.columnorder=se,Q.emit("plotly_restyle")}function D(Q,ie,se){if(Array.isArray(Q)){var ae=Q[Math.min(ie,Q.length-1)];return Array.isArray(ae)?ae[Math.min(se,ae.length-1)]:ae}else return Q}function R(Q,ie,se){Q.transition().ease(A.releaseTransitionEase).duration(A.releaseTransitionDuration).attr("transform",t(ie.x,se))}function O(Q){return Q.type==="cells"}function F(Q){return Q.type==="header"}function N(Q){var ie=Q.rowBlocks.length?Q.rowBlocks[0].auxiliaryBlocks:[];return ie.reduce(function(se,ae){return se+U(ae,1/0)},0)}function G(Q,ie,se){for(var ae=[],oe=0,be=0;be<Q.length;be++){for(var ce=Q[be],de=ce.rows,ye=0,ge=0;ge<de.length;ge++)ye+=de[ge].rowHeight;ce.allRowsHeight=ye;var me=oe+ye,Ee=ie,Pe=Ee+se;Ee<me&&Pe>oe&&ae.push(be),oe+=ye}return ae}function K(Q,ie,se){var ae=y(ie)[0];if(ae!==void 0){var oe=ae.rowBlocks,be=ae.calcdata,ce=V(oe,oe.length),de=ae.calcdata.groupHeight-N(ae),ye=be.scrollY=Math.max(0,Math.min(ce-de,be.scrollY)),ge=G(oe,ye,de);ge.length===1&&(ge[0]===oe.length-1?ge.unshift(ge[0]-1):ge.push(ge[0]+1)),ge[0]%2&&ge.reverse(),ie.each(function(me,Ee){me.page=ge[Ee],me.scrollY=ye}),ie.attr("transform",function(me){var Ee=V(me.rowBlocks,me.page)-me.scrollY;return t(0,Ee)}),Q&&(Y(Q,se,ie,ge,ae.prevPages,ae,0),Y(Q,se,ie,ge,ae.prevPages,ae,1),o(se,Q))}}function W(Q,ie,se,ae){return function(be){var ce=be.calcdata?be.calcdata:be,de=ie.filter(function(Ee){return ce.key===Ee.key}),ye=se||ce.scrollbarState.dragMultiplier,ge=ce.scrollY;ce.scrollY=ae===void 0?ce.scrollY+ye*g.event.dy:ae;var me=de.selectAll("."+A.cn.yColumn).selectAll("."+A.cn.columnBlock).filter(O);return K(Q,me,de),ce.scrollY===ge}}function Y(Q,ie,se,ae,oe,be,ce){var de=ae[ce]!==oe[ce];de&&(clearTimeout(be.currentRepaint[ce]),be.currentRepaint[ce]=setTimeout(function(){var ye=se.filter(function(ge,me){return me===ce&&ae[me]!==oe[me]});m(Q,ie,ye,se),oe[ce]=ae[ce]}))}function re(Q,ie,se,ae){return function(){var be=g.select(ie.parentNode);be.each(function(ce){var de=ce.fragments;be.selectAll("tspan.line").each(function(ke,Xe){de[Xe].width=this.getComputedTextLength()});var ye=de[de.length-1].width,ge=de.slice(0,-1),me=[],Ee,Pe,Ne=0,we=ce.column.columnWidth-2*A.cellPad;for(ce.value="";ge.length;)Ee=ge.shift(),Pe=Ee.width+ye,Ne+Pe>we&&(ce.value+=me.join(A.wrapSpacer)+A.lineBreaker,me=[],Ne=0),me.push(Ee.text),Ne+=Pe;Ne&&(ce.value+=me.join(A.wrapSpacer)),ce.wrapped=!0}),be.selectAll("tspan.line").remove(),k(be.select("."+A.cn.cellText),se,Q,ae),g.select(ie.parentNode.parentNode).call(q)}}function ue(Q,ie,se,ae,oe){return function(){if(!oe.settledY){var ce=g.select(ie.parentNode),de=ne(oe),ye=oe.key-de.firstRowIndex,ge=de.rows[ye].rowHeight,me=oe.cellHeightMayIncrease?ie.parentNode.getBoundingClientRect().height+2*A.cellPad:ge,Ee=Math.max(me,ge),Pe=Ee-de.rows[ye].rowHeight;Pe&&(de.rows[ye].rowHeight=Ee,Q.selectAll("."+A.cn.columnCell).call(q),K(null,Q.filter(O),0),o(se,ae,!0)),ce.attr("transform",function(){var Ne=this,we=Ne.parentNode,ke=we.getBoundingClientRect(),Xe=g.select(Ne.parentNode).select("."+A.cn.cellRect).node().getBoundingClientRect(),He=Ne.transform.baseVal.consolidate(),Ie=Xe.top-ke.top+(He?He.matrix.f:A.cellPad);return t(j(oe,g.select(Ne.parentNode).select("."+A.cn.cellTextHolder).node().getBoundingClientRect().width),Ie)}),oe.settledY=!0}}}function j(Q,ie){switch(Q.align){case"left":return A.cellPad;case"right":return Q.column.columnWidth-(ie||0)-A.cellPad;case"center":return(Q.column.columnWidth-(ie||0))/2;default:return A.cellPad}}function q(Q){Q.attr("transform",function(ie){var se=ie.rowBlocks[0].auxiliaryBlocks.reduce(function(ce,de){return ce+U(de,1/0)},0),ae=ne(ie),oe=U(ae,ie.key),be=oe+se;return t(0,be)}).selectAll("."+A.cn.cellRect).attr("height",function(ie){return X(ne(ie),ie.key).rowHeight})}function V(Q,ie){for(var se=0,ae=ie-1;ae>=0;ae--)se+=$(Q[ae]);return se}function U(Q,ie){for(var se=0,ae=0;ae<Q.rows.length&&Q.rows[ae].rowIndex<ie;ae++)se+=Q.rows[ae].rowHeight;return se}function $(Q){var ie=Q.allRowsHeight;if(ie!==void 0)return ie;for(var se=0,ae=0;ae<Q.rows.length;ae++)se+=Q.rows[ae].rowHeight;return Q.allRowsHeight=se,se}function ne(Q){return Q.rowBlocks[Q.page]}function X(Q,ie){return Q.rows[ie-Q.firstRowIndex]}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"./constants":1078,"./data_preparation_helper":1079,"./data_split_helpers":1080,"@plotly/d3":58}],1084:[function(d,ee,te){var A=d("../../plots/template_attributes").hovertemplateAttrs,g=d("../../plots/template_attributes").texttemplateAttrs,S=d("../../components/colorscale/attributes"),M=d("../../plots/domain").attributes,e=d("../pie/attributes"),a=d("../sunburst/attributes"),n=d("./constants"),r=d("../../lib/extend").extendFlat;ee.exports={labels:a.labels,parents:a.parents,values:a.values,branchvalues:a.branchvalues,count:a.count,level:a.level,maxdepth:a.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:r({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:a.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:a.marker.line,editType:"calc"},S("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:r({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:a.textinfo,texttemplate:g({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:a.hoverinfo,hovertemplate:A({},{keys:n.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:r({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:a.root,domain:M({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"./constants":1087}],1085:[function(d,ee,te){var A=d("../../plots/plots");te.name="treemap",te.plot=function(g,S,M,e){A.plotBasePlot(te.name,g,S,M,e)},te.clean=function(g,S,M,e){A.cleanBasePlot(te.name,g,S,M,e)}},{"../../plots/plots":628}],1086:[function(d,ee,te){var A=d("../sunburst/calc");te.calc=function(g,S){return A.calc(g,S)},te.crossTraceCalc=function(g){return A._runCrossTraceCalc("treemap",g)}},{"../sunburst/calc":1060}],1087:[function(d,ee,te){ee.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1088:[function(d,ee,te){var A=d("../../lib"),g=d("./attributes"),S=d("../../components/color"),M=d("../../plots/domain").defaults,e=d("../bar/defaults").handleText,a=d("../bar/constants").TEXTPAD,n=d("../../components/colorscale"),r=n.hasColorscale,t=n.handleDefaults;ee.exports=function(s,i,x,p){function v(k,P){return A.coerce(s,i,g,k,P)}var f=v("labels"),y=v("parents");if(!f||!f.length||!y||!y.length){i.visible=!1;return}var o=v("values");o&&o.length?v("branchvalues"):v("count"),v("level"),v("maxdepth");var m=v("tiling.packing");m==="squarify"&&v("tiling.squarifyratio"),v("tiling.flip"),v("tiling.pad");var l=v("text");v("texttemplate"),i.texttemplate||v("textinfo",Array.isArray(l)?"text+label":"label"),v("hovertext"),v("hovertemplate");var w=v("pathbar.visible"),_="auto";e(s,i,p,v,_,{hasPathbar:w,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),v("textposition");var h=i.textposition.indexOf("bottom")!==-1,b=v("marker.line.width");b&&v("marker.line.color",p.paper_bgcolor);var u=v("marker.colors"),L=i._hasColorscale=r(s,"marker","colors")||(s.marker||{}).coloraxis;L?t(s,i,p,v,{prefix:"marker.",cLetter:"c"}):v("marker.depthfade",!(u||[]).length);var T=i.textfont.size*2;v("marker.pad.t",h?T/4:T),v("marker.pad.l",T/4),v("marker.pad.r",T/4),v("marker.pad.b",h?T:T/4),i._hovered={marker:{line:{width:2,color:S.contrast(p.paper_bgcolor)}}},w&&(v("pathbar.thickness",i.pathbar.textfont.size+2*a),v("pathbar.side"),v("pathbar.edgeshape")),v("sort"),v("root.color"),M(i,p,v),i._length=null}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":1084}],1089:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../sunburst/helpers"),S=d("../bar/uniform_text"),M=S.clearMinTextSize,e=d("../bar/style").resizeText,a=d("./plot_one");ee.exports=function(r,t,c,s,i){var x=i.type,p=i.drawDescendants,v=r._fullLayout,f=v["_"+x+"layer"],y,o,m=!c;if(M(x,v),y=f.selectAll("g.trace."+x).data(t,function(w){return w[0].trace.uid}),y.enter().append("g").classed("trace",!0).classed(x,!0),y.order(),!v.uniformtext.mode&&g.hasTransition(c)){s&&(o=s());var l=A.transition().duration(c.duration).ease(c.easing).each("end",function(){o&&o()}).each("interrupt",function(){o&&o()});l.each(function(){f.selectAll("g.trace").each(function(w){a(r,w,this,c,p)})})}else y.each(function(w){a(r,w,this,c,p)}),v.uniformtext.mode&&e(r,f.selectAll(".trace"),x);m&&y.exit().remove()}},{"../bar/style":671,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./plot_one":1098,"@plotly/d3":58}],1090:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=d("../../components/drawing"),M=d("../../lib/svg_text_utils"),e=d("./partition"),a=d("./style").styleOne,n=d("./constants"),r=d("../sunburst/helpers"),t=d("../sunburst/fx"),c=!0;ee.exports=function(i,x,p,v,f){var y=f.barDifY,o=f.width,m=f.height,l=f.viewX,w=f.viewY,_=f.pathSlice,h=f.toMoveInsideSlice,b=f.strTransform,u=f.hasTransition,L=f.handleSlicesExit,T=f.makeUpdateSliceInterpolator,k=f.makeUpdateTextInterpolator,P={},z=i._context.staticPlot,I=i._fullLayout,D=x[0],R=D.trace,O=D.hierarchy,F=o/R._entryDepth,N=r.listPath(p.data,"id"),G=e(O.copy(),[o,m],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();G=G.filter(function(W){var Y=N.indexOf(W.data.id);return Y===-1?!1:(W.x0=F*Y,W.x1=F*(Y+1),W.y0=y,W.y1=y+m,W.onPathbar=!0,!0)}),G.reverse(),v=v.data(G,r.getPtId),v.enter().append("g").classed("pathbar",!0),L(v,c,P,[o,m],_),v.order();var K=v;u&&(K=K.transition().each("end",function(){var W=A.select(this);r.setSliceCursor(W,i,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),K.each(function(W){W._x0=l(W.x0),W._x1=l(W.x1),W._y0=w(W.y0),W._y1=w(W.y1),W._hoverX=l(W.x1-Math.min(o,m)/2),W._hoverY=w(W.y1-m/2);var Y=A.select(this),re=g.ensureSingle(Y,"path","surface",function(V){V.style("pointer-events",z?"none":"all")});u?re.transition().attrTween("d",function(V){var U=T(V,c,P,[o,m]);return function($){return _(U($))}}):re.attr("d",_),Y.call(t,p,i,x,{styleOne:a,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(r.setSliceCursor,i,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:i._transitioning}),re.call(a,W,R,{hovered:!1}),W._text=(r.getPtLabel(W)||"").split("<br>").join(" ")||"";var ue=g.ensureSingle(Y,"g","slicetext"),j=g.ensureSingle(ue,"text","",function(V){V.attr("data-notex",1)}),q=g.ensureUniformFontSize(i,r.determineTextFont(R,W,I.font,{onPathbar:!0}));j.text(W._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(S.font,q).call(M.convertToTspans,i),W.textBB=S.bBox(j.node()),W.transform=h(W,{fontSize:q.size,onPathbar:!0}),W.transform.fontSize=q.size,u?j.transition().attrTween("transform",function(V){var U=k(V,c,P,[o,m]);return function($){return b(U($))}}):j.attr("transform",b(W))})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1091:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=d("../../components/drawing"),M=d("../../lib/svg_text_utils"),e=d("./partition"),a=d("./style").styleOne,n=d("./constants"),r=d("../sunburst/helpers"),t=d("../sunburst/fx"),c=d("../sunburst/plot").formatSliceLabel,s=!1;ee.exports=function(x,p,v,f,y){var o=y.width,m=y.height,l=y.viewX,w=y.viewY,_=y.pathSlice,h=y.toMoveInsideSlice,b=y.strTransform,u=y.hasTransition,L=y.handleSlicesExit,T=y.makeUpdateSliceInterpolator,k=y.makeUpdateTextInterpolator,P=y.prevEntry,z={},I=x._context.staticPlot,D=x._fullLayout,R=p[0],O=R.trace,F=O.textposition.indexOf("left")!==-1,N=O.textposition.indexOf("right")!==-1,G=O.textposition.indexOf("bottom")!==-1,K=!G&&!O.marker.pad.t||G&&!O.marker.pad.b,W=e(v,[o,m],{packing:O.tiling.packing,squarifyratio:O.tiling.squarifyratio,flipX:O.tiling.flip.indexOf("x")>-1,flipY:O.tiling.flip.indexOf("y")>-1,pad:{inner:O.tiling.pad,top:O.marker.pad.t,left:O.marker.pad.l,right:O.marker.pad.r,bottom:O.marker.pad.b}}),Y=W.descendants(),re=1/0,ue=-1/0;Y.forEach(function($){var ne=$.depth;ne>=O._maxDepth?($.x0=$.x1=($.x0+$.x1)/2,$.y0=$.y1=($.y0+$.y1)/2):(re=Math.min(re,ne),ue=Math.max(ue,ne))}),f=f.data(Y,r.getPtId),O._maxVisibleLayers=isFinite(ue)?ue-re+1:0,f.enter().append("g").classed("slice",!0),L(f,s,z,[o,m],_),f.order();var j=null;if(u&&P){var q=r.getPtId(P);f.each(function($){j===null&&r.getPtId($)===q&&(j={x0:$.x0,x1:$.x1,y0:$.y0,y1:$.y1})})}var V=function(){return j||{x0:0,x1:o,y0:0,y1:m}},U=f;return u&&(U=U.transition().each("end",function(){var $=A.select(this);r.setSliceCursor($,x,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),U.each(function($){var ne=r.isHeader($,O);$._x0=l($.x0),$._x1=l($.x1),$._y0=w($.y0),$._y1=w($.y1),$._hoverX=l($.x1-O.marker.pad.r),$._hoverY=w(G?$.y1-O.marker.pad.b/2:$.y0+O.marker.pad.t/2);var X=A.select(this),Q=g.ensureSingle(X,"path","surface",function(oe){oe.style("pointer-events",I?"none":"all")});u?Q.transition().attrTween("d",function(oe){var be=T(oe,s,V(),[o,m]);return function(ce){return _(be(ce))}}):Q.attr("d",_),X.call(t,v,x,p,{styleOne:a,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(r.setSliceCursor,x,{isTransitioning:x._transitioning}),Q.call(a,$,O,{hovered:!1}),$.x0===$.x1||$.y0===$.y1?$._text="":ne?$._text=K?"":r.getPtLabel($)||"":$._text=c($,v,O,p,D)||"";var ie=g.ensureSingle(X,"g","slicetext"),se=g.ensureSingle(ie,"text","",function(oe){oe.attr("data-notex",1)}),ae=g.ensureUniformFontSize(x,r.determineTextFont(O,$,D.font));se.text($._text||" ").classed("slicetext",!0).attr("text-anchor",N?"end":F||ne?"start":"middle").call(S.font,ae).call(M.convertToTspans,x),$.textBB=S.bBox(se.node()),$.transform=h($,{fontSize:ae.size,isHeader:ne}),$.transform.fontSize=ae.size,u?se.transition().attrTween("transform",function(oe){var be=k(oe,s,V(),[o,m]);return function(ce){return b(be(ce))}}):se.attr("transform",b($))}),j}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1092:[function(d,ee,te){ee.exports=function A(g,S,M){var e;M.swapXY&&(e=g.x0,g.x0=g.y0,g.y0=e,e=g.x1,g.x1=g.y1,g.y1=e),M.flipX&&(e=g.x0,g.x0=S[0]-g.x1,g.x1=S[0]-e),M.flipY&&(e=g.y0,g.y0=S[1]-g.y1,g.y1=S[1]-e);var a=g.children;if(a)for(var n=0;n<a.length;n++)A(a[n],S,M)}},{}],1093:[function(d,ee,te){ee.exports={moduleType:"trace",name:"treemap",basePlotModule:d("./base_plot"),categories:[],animatable:!0,attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot"),style:d("./style").style,colorbar:d("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1084,"./base_plot":1085,"./calc":1086,"./defaults":1088,"./layout_attributes":1094,"./layout_defaults":1095,"./plot":1097,"./style":1099}],1094:[function(d,ee,te){ee.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1095:[function(d,ee,te){var A=d("../../lib"),g=d("./layout_attributes");ee.exports=function(M,e){function a(n,r){return A.coerce(M,e,g,n,r)}a("treemapcolorway",e.colorway),a("extendtreemapcolors")}},{"../../lib":515,"./layout_attributes":1094}],1096:[function(d,ee,te){var A=d("d3-hierarchy"),g=d("./flip_tree");ee.exports=function(e,a,n){var r=n.flipX,t=n.flipY,c=n.packing==="dice-slice",s=n.pad[t?"bottom":"top"],i=n.pad[r?"right":"left"],x=n.pad[r?"left":"right"],p=n.pad[t?"top":"bottom"],v;c&&(v=i,i=s,s=v,v=x,x=p,p=v);var f=A.treemap().tile(S(n.packing,n.squarifyratio)).paddingInner(n.pad.inner).paddingLeft(i).paddingRight(x).paddingTop(s).paddingBottom(p).size(c?[a[1],a[0]]:a)(e);return(c||r||t)&&g(f,a,{swapXY:c,flipX:r,flipY:t}),f};function S(M,e){switch(M){case"squarify":return A.treemapSquarify.ratio(e);case"binary":return A.treemapBinary;case"dice":return A.treemapDice;case"slice":return A.treemapSlice;default:return A.treemapSliceDice}}},{"./flip_tree":1092,"d3-hierarchy":115}],1097:[function(d,ee,te){var A=d("./draw"),g=d("./draw_descendants");ee.exports=function(M,e,a,n){return A(M,e,a,n,{type:"treemap",drawDescendants:g})}},{"./draw":1089,"./draw_descendants":1091}],1098:[function(d,ee,te){var A=d("@plotly/d3"),g=d("d3-interpolate").interpolate,S=d("../sunburst/helpers"),M=d("../../lib"),e=d("../bar/constants").TEXTPAD,a=d("../bar/plot"),n=a.toMoveInsideBar,r=d("../bar/uniform_text"),t=r.recordMinTextSize,c=d("./constants"),s=d("./draw_ancestors");function i(x){return S.isHierarchyRoot(x)?"":S.getPtId(x)}ee.exports=function(p,v,f,y,o){var m=p._fullLayout,l=v[0],w=l.trace,_=w.type,h=_==="icicle",b=l.hierarchy,u=S.findEntryWithLevel(b,w.level),L=A.select(f),T=L.selectAll("g.pathbar"),k=L.selectAll("g.slice");if(!u){T.remove(),k.remove();return}var P=S.isHierarchyRoot(u),z=!m.uniformtext.mode&&S.hasTransition(y),I=S.getMaxDepth(w),D=function(Ge){return Ge.data.depth-u.data.depth<I},R=m._size,O=w.domain,F=R.w*(O.x[1]-O.x[0]),N=R.h*(O.y[1]-O.y[0]),G=F,K=w.pathbar.thickness,W=w.marker.line.width+c.gapWithPathbar,Y=w.pathbar.visible?w.pathbar.side.indexOf("bottom")>-1?N+W:-(K+W):0,re={x0:G,x1:G,y0:Y,y1:Y+K},ue=function(Ge,ht,Rt){var Kt=w.tiling.pad,It=function(St){return St-Kt<=ht.x0},Mt=function(St){return St+Kt>=ht.x1},Yt=function(St){return St-Kt<=ht.y0},zt=function(St){return St+Kt>=ht.y1};return Ge.x0===ht.x0&&Ge.x1===ht.x1&&Ge.y0===ht.y0&&Ge.y1===ht.y1?{x0:Ge.x0,x1:Ge.x1,y0:Ge.y0,y1:Ge.y1}:{x0:It(Ge.x0-Kt)?0:Mt(Ge.x0-Kt)?Rt[0]:Ge.x0,x1:It(Ge.x1+Kt)?0:Mt(Ge.x1+Kt)?Rt[0]:Ge.x1,y0:Yt(Ge.y0-Kt)?0:zt(Ge.y0-Kt)?Rt[1]:Ge.y0,y1:Yt(Ge.y1+Kt)?0:zt(Ge.y1+Kt)?Rt[1]:Ge.y1}},j=null,q={},V={},U=null,$=function(Ge,ht){return ht?q[i(Ge)]:V[i(Ge)]},ne=function(Ge,ht,Rt,Kt){if(ht)return q[i(b)]||re;var It=V[w.level]||Rt;return D(Ge)?ue(Ge,It,Kt):{}};l.hasMultipleRoots&&P&&I++,w._maxDepth=I,w._backgroundColor=m.paper_bgcolor,w._entryDepth=u.data.depth,w._atRootLevel=P;var X=-F/2+R.l+R.w*(O.x[1]+O.x[0])/2,Q=-N/2+R.t+R.h*(1-(O.y[1]+O.y[0])/2),ie=function(Ge){return X+Ge},se=function(Ge){return Q+Ge},ae=se(0),oe=ie(0),be=function(Ge){return oe+Ge},ce=function(Ge){return ae+Ge};function de(Ge,ht){return Ge+","+ht}var ye=be(0),ge=function(Ge){Ge.x=Math.max(ye,Ge.x)},me=w.pathbar.edgeshape,Ee=function(Ge){var ht=be(Math.max(Math.min(Ge.x0,Ge.x0),0)),Rt=be(Math.min(Math.max(Ge.x1,Ge.x1),G)),Kt=ce(Ge.y0),It=ce(Ge.y1),Mt=K/2,Yt={},zt={};Yt.x=ht,zt.x=Rt,Yt.y=zt.y=(Kt+It)/2;var St={x:ht,y:Kt},Ye={x:Rt,y:Kt},rt={x:Rt,y:It},Ve={x:ht,y:It};return me===">"?(St.x-=Mt,Ye.x-=Mt,rt.x-=Mt,Ve.x-=Mt):me==="/"?(rt.x-=Mt,Ve.x-=Mt,Yt.x-=Mt/2,zt.x-=Mt/2):me==="\\"?(St.x-=Mt,Ye.x-=Mt,Yt.x-=Mt/2,zt.x-=Mt/2):me==="<"&&(Yt.x-=Mt,zt.x-=Mt),ge(St),ge(Ve),ge(Yt),ge(Ye),ge(rt),ge(zt),"M"+de(St.x,St.y)+"L"+de(Ye.x,Ye.y)+"L"+de(zt.x,zt.y)+"L"+de(rt.x,rt.y)+"L"+de(Ve.x,Ve.y)+"L"+de(Yt.x,Yt.y)+"Z"},Pe=function(Ge){var ht=ie(Ge.x0),Rt=ie(Ge.x1),Kt=se(Ge.y0),It=se(Ge.y1),Mt=Rt-ht,Yt=It-Kt;if(!Mt||!Yt)return"";var zt=0,St=Mt>2*zt&&Yt>2*zt?zt:0,Ye=function(rt,Ve){return St?"a"+de(St,St)+" 0 0 1 "+de(rt,Ve):""};return"M"+de(ht,Kt+St)+Ye(St,-St)+"L"+de(Rt-St,Kt)+Ye(St,St)+"L"+de(Rt,It-St)+Ye(-St,St)+"L"+de(ht+St,It)+Ye(-St,-St)+"Z"},Ne=function(Ge,ht){var Rt=Ge.x0,Kt=Ge.x1,It=Ge.y0,Mt=Ge.y1,Yt=Ge.textBB,zt=function(wt){return w.textposition.indexOf(wt)!==-1},St=zt("bottom"),Ye=zt("top")||ht.isHeader&&!St,rt=Ye?"start":St?"end":"middle",Ve=zt("right"),Ae=zt("left")||ht.onPathbar,Ue=Ae?-1:Ve?1:0,Ze=w[h?"tiling":"marker"].pad;if(ht.isHeader){if(Rt+=(h?Ze:Ze.l)-e,Kt-=(h?Ze:Ze.r)-e,Rt>=Kt){var Qe=(Rt+Kt)/2;Rt=Qe,Kt=Qe}var _t;St?(_t=Mt-(h?Ze:Ze.b),It<_t&&_t<Mt&&(It=_t)):(_t=It+(h?Ze:Ze.t),It<_t&&_t<Mt&&(Mt=_t))}var gt=n(Rt,Kt,It,Mt,Yt,{isHorizontal:!1,constrained:!0,angle:0,anchor:rt,leftToRight:Ue});return gt.fontSize=ht.fontSize,gt.targetX=ie(gt.targetX),gt.targetY=se(gt.targetY),isNaN(gt.targetX)||isNaN(gt.targetY)?{}:(Rt!==Kt&&It!==Mt&&t(w.type,gt,m),{scale:gt.scale,rotate:gt.rotate,textX:gt.textX,textY:gt.textY,anchorX:gt.anchorX,anchorY:gt.anchorY,targetX:gt.targetX,targetY:gt.targetY})},we=function(Ge,ht){for(var Rt,Kt=0,It=Ge;!Rt&&Kt<I;)Kt++,It=It.parent,It?Rt=$(It,ht):Kt=I;return Rt||{}},ke=function(Ge,ht,Rt,Kt){var It=$(Ge,ht),Mt;if(ht)Mt=re;else{var Yt=$(u,ht);Yt?Mt=ue(Ge,Yt,Kt):Mt={}}return g(It,Mt)},Xe=function(Ge,ht,Rt,Kt,It){var Mt=$(Ge,ht),Yt;if(Mt)Yt=Mt;else if(ht)Yt=re;else if(j)if(Ge.parent){var zt=U||Rt;zt&&!ht?Yt=ue(Ge,zt,Kt):(Yt={},M.extendFlat(Yt,we(Ge,ht)))}else Yt=M.extendFlat({},Ge),h&&(It.orientation==="h"?It.flipX?Yt.x0=Ge.x1:Yt.x1=0:It.flipY?Yt.y0=Ge.y1:Yt.y1=0);else Yt={};return g(Yt,{x0:Ge.x0,x1:Ge.x1,y0:Ge.y0,y1:Ge.y1})},He=function(Ge,ht,Rt,Kt){var It=$(Ge,ht),Mt={},Yt=ne(Ge,ht,Rt,Kt);M.extendFlat(Mt,{transform:Ne({x0:Yt.x0,x1:Yt.x1,y0:Yt.y0,y1:Yt.y1,textBB:Ge.textBB,_text:Ge._text},{isHeader:S.isHeader(Ge,w)})}),It?Mt=It:Ge.parent&&M.extendFlat(Mt,we(Ge,ht));var zt=Ge.transform;return Ge.x0!==Ge.x1&&Ge.y0!==Ge.y1&&t(w.type,zt,m),g(Mt,{transform:{scale:zt.scale,rotate:zt.rotate,textX:zt.textX,textY:zt.textY,anchorX:zt.anchorX,anchorY:zt.anchorY,targetX:zt.targetX,targetY:zt.targetY}})},Ie=function(Ge,ht,Rt,Kt,It){var Mt=Kt[0],Yt=Kt[1];z?Ge.exit().transition().each(function(){var zt=A.select(this),St=zt.select("path.surface");St.transition().attrTween("d",function(rt){var Ve=ke(rt,ht,Rt,[Mt,Yt]);return function(Ae){return It(Ve(Ae))}});var Ye=zt.select("g.slicetext");Ye.attr("opacity",0)}).remove():Ge.exit().remove()},De=function(Ge){var ht=Ge.transform;return Ge.x0!==Ge.x1&&Ge.y0!==Ge.y1&&t(w.type,ht,m),M.getTextTransform({textX:ht.textX,textY:ht.textY,anchorX:ht.anchorX,anchorY:ht.anchorY,targetX:ht.targetX,targetY:ht.targetY,scale:ht.scale,rotate:ht.rotate})};z&&(T.each(function(Ge){q[i(Ge)]={x0:Ge.x0,x1:Ge.x1,y0:Ge.y0,y1:Ge.y1},Ge.transform&&(q[i(Ge)].transform={textX:Ge.transform.textX,textY:Ge.transform.textY,anchorX:Ge.transform.anchorX,anchorY:Ge.transform.anchorY,targetX:Ge.transform.targetX,targetY:Ge.transform.targetY,scale:Ge.transform.scale,rotate:Ge.transform.rotate})}),k.each(function(Ge){V[i(Ge)]={x0:Ge.x0,x1:Ge.x1,y0:Ge.y0,y1:Ge.y1},Ge.transform&&(V[i(Ge)].transform={textX:Ge.transform.textX,textY:Ge.transform.textY,anchorX:Ge.transform.anchorX,anchorY:Ge.transform.anchorY,targetX:Ge.transform.targetX,targetY:Ge.transform.targetY,scale:Ge.transform.scale,rotate:Ge.transform.rotate}),!j&&S.isEntry(Ge)&&(j=Ge)})),U=o(p,v,u,k,{width:F,height:N,viewX:ie,viewY:se,pathSlice:Pe,toMoveInsideSlice:Ne,prevEntry:j,makeUpdateSliceInterpolator:Xe,makeUpdateTextInterpolator:He,handleSlicesExit:Ie,hasTransition:z,strTransform:De}),w.pathbar.visible?s(p,v,u,T,{barDifY:Y,width:G,height:K,viewX:be,viewY:ce,pathSlice:Ee,toMoveInsideSlice:Ne,makeUpdateSliceInterpolator:Xe,makeUpdateTextInterpolator:He,handleSlicesExit:Ie,hasTransition:z,strTransform:De}):T.remove()}},{"../../lib":515,"../bar/constants":659,"../bar/plot":668,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./constants":1087,"./draw_ancestors":1090,"@plotly/d3":58,"d3-interpolate":116}],1099:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/color"),S=d("../../lib"),M=d("../sunburst/helpers"),e=d("../bar/uniform_text").resizeText;function a(r){var t=r._fullLayout._treemaplayer.selectAll(".trace");e(r,t,"treemap"),t.each(function(c){var s=A.select(this),i=c[0],x=i.trace;s.style("opacity",x.opacity),s.selectAll("path.surface").each(function(p){A.select(this).call(n,p,x,{hovered:!1})})})}function n(r,t,c,s){var i=(s||{}).hovered,x=t.data.data,p=x.i,v,f,y=x.color,o=M.isHierarchyRoot(t),m=1;if(i)v=c._hovered.marker.line.color,f=c._hovered.marker.line.width;else if(o&&y===c.root.color)m=100,v="rgba(0,0,0,0)",f=0;else if(v=S.castOption(c,p,"marker.line.color")||g.defaultLine,f=S.castOption(c,p,"marker.line.width")||0,!c._hasColorscale&&!t.onPathbar){var l=c.marker.depthfade;if(l){var w=g.combine(g.addOpacity(c._backgroundColor,.75),y),_;if(l===!0){var h=M.getMaxDepth(c);isFinite(h)?M.isLeaf(t)?_=0:_=c._maxVisibleLayers-(t.data.depth-c._entryDepth):_=t.data.height+1}else _=t.data.depth-c._entryDepth,c._atRootLevel||_++;if(_>0)for(var b=0;b<_;b++){var u=.5*b/_;y=g.combine(g.addOpacity(w,u),y)}}}r.style("stroke-width",f).call(g.fill,y).call(g.stroke,v).style("opacity",m)}ee.exports={style:a,styleOne:n}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"../sunburst/helpers":1064,"@plotly/d3":58}],1100:[function(d,ee,te){var A=d("../box/attributes"),g=d("../../lib/extend").extendFlat,S=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat;ee.exports={y:A.y,x:A.x,x0:A.x0,y0:A.y0,xhoverformat:S("x"),yhoverformat:S("y"),name:g({},A.name,{}),orientation:g({},A.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:A.fillcolor,points:g({},A.boxpoints,{}),jitter:g({},A.jitter,{}),pointpos:g({},A.pointpos,{}),width:g({},A.width,{}),marker:A.marker,text:A.text,hovertext:A.hovertext,hovertemplate:A.hovertemplate,quartilemethod:A.quartilemethod,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:A.offsetgroup,alignmentgroup:A.alignmentgroup,selected:A.selected,unselected:A.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682}],1101:[function(d,ee,te){var A=d("../../lib"),g=d("../../plots/cartesian/axes"),S=d("../box/calc"),M=d("./helpers"),e=d("../../constants/numerical").BADNUM;ee.exports=function(c,s){var i=S(c,s);if(i[0].t.empty)return i;for(var x=c._fullLayout,p=g.getFromId(c,s[s.orientation==="h"?"xaxis":"yaxis"]),v=1/0,f=-1/0,y=0,o=0,m=0;m<i.length;m++){var l=i[m],w=l.pts.map(M.extractVal),_=l.bandwidth=n(s,l,w),h=l.span=r(s,l,p,_);if(l.min===l.max&&_===0)h=l.span=[l.min,l.max],l.density=[{v:1,t:h[0]}],l.bandwidth=_,y=Math.max(y,1);else{var b=h[1]-h[0],u=Math.ceil(b/(_/3)),L=b/u;if(!isFinite(L)||!isFinite(u))return A.error("Something went wrong with computing the violin span"),i[0].t.empty=!0,i;var T=M.makeKDE(l,s,w);l.density=new Array(u);for(var k=0,P=h[0];P<h[1]+L/2;k++,P+=L){var z=T(P);l.density[k]={v:z,t:P},y=Math.max(y,z)}}o=Math.max(o,w.length),v=Math.min(v,h[0]),f=Math.max(f,h[1])}var I=g.findExtremes(p,[v,f],{padded:!0});if(s._extremes[p._id]=I,s.width)i[0].t.maxKDE=y;else{var D=x._violinScaleGroupStats,R=s.scalegroup,O=D[R];O?(O.maxKDE=Math.max(O.maxKDE,y),O.maxCount=Math.max(O.maxCount,o)):D[R]={maxKDE:y,maxCount:o}}return i[0].t.labels.kde=A._(c,"kde:"),i};function a(t,c,s){var i=Math.min(c,s/1.349);return 1.059*i*Math.pow(t,-.2)}function n(t,c,s){var i=c.max-c.min;if(!i)return t.bandwidth?t.bandwidth:0;if(t.bandwidth)return Math.max(t.bandwidth,i/1e4);var x=s.length,p=A.stdev(s,x-1,c.mean);return Math.max(a(x,p,c.q3-c.q1),i/100)}function r(t,c,s,i){var x=t.spanmode,p=t.span||[],v=[c.min,c.max],f=[c.min-2*i,c.max+2*i],y;function o(l){var w=p[l],_=s.type==="multicategory"?s.r2c(w):s.d2c(w,0,t[c.valLetter+"calendar"]);return _===e?f[l]:_}x==="soft"?y=f:x==="hard"?y=v:y=[o(0),o(1)];var m={type:"linear",range:y};return g.setConvert(m),m.cleanRange(),y}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../box/calc":683,"./helpers":1104}],1102:[function(d,ee,te){var A=d("../box/cross_trace_calc").setPositionOffset,g=["v","h"];ee.exports=function(M,e){for(var a=M.calcdata,n=e.xaxis,r=e.yaxis,t=0;t<g.length;t++){for(var c=g[t],s=c==="h"?r:n,i=[],x=0;x<a.length;x++){var p=a[x],v=p[0].t,f=p[0].trace;f.visible===!0&&f.type==="violin"&&!v.empty&&f.orientation===c&&f.xaxis===n._id&&f.yaxis===r._id&&i.push(x)}A("violin",M,i,s)}}},{"../box/cross_trace_calc":684}],1103:[function(d,ee,te){var A=d("../../lib"),g=d("../../components/color"),S=d("../box/defaults"),M=d("./attributes");ee.exports=function(a,n,r,t){function c(L,T){return A.coerce(a,n,M,L,T)}function s(L,T){return A.coerce2(a,n,M,L,T)}if(S.handleSampleDefaults(a,n,c,t),n.visible!==!1){c("bandwidth"),c("side");var i=c("width");i||(c("scalegroup",n.name),c("scalemode"));var x=c("span"),p;Array.isArray(x)&&(p="manual"),c("spanmode",p);var v=c("line.color",(a.marker||{}).color||r),f=c("line.width"),y=c("fillcolor",g.addOpacity(n.line.color,.5));S.handlePointsDefaults(a,n,c,{prefix:""});var o=s("box.width"),m=s("box.fillcolor",y),l=s("box.line.color",v),w=s("box.line.width",f),_=c("box.visible",Boolean(o||m||l||w));_||(n.box={visible:!1});var h=s("meanline.color",v),b=s("meanline.width",f),u=c("meanline.visible",Boolean(h||b));u||(n.meanline={visible:!1}),c("quartilemethod")}}},{"../../components/color":367,"../../lib":515,"../box/defaults":685,"./attributes":1100}],1104:[function(d,ee,te){var A=d("../../lib"),g={gaussian:function(S){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*S*S)}};te.makeKDE=function(S,M,e){var a=e.length,n=g.gaussian,r=S.bandwidth,t=1/(a*r);return function(c){for(var s=0,i=0;i<a;i++)s+=n((c-e[i])/r);return t*s}},te.getPositionOnKdePath=function(S,M,e){var a,n;M.orientation==="h"?(a="y",n="x"):(a="x",n="y");var r=A.findPointOnPath(S.path,e,n,{pathLength:S.pathLength}),t=S.posCenterPx,c=r[a],s=M.side==="both"?2*t-c:t;return[c,s]},te.getKdeValue=function(S,M,e){var a=S.pts.map(te.extractVal),n=te.makeKDE(S,M,a);return n(e)/S.posDensityScale},te.extractVal=function(S){return S.v}},{"../../lib":515}],1105:[function(d,ee,te){var A=d("../../components/color"),g=d("../../lib"),S=d("../../plots/cartesian/axes"),M=d("../box/hover"),e=d("./helpers");ee.exports=function(n,r,t,c,s){s||(s={});var i=s.hoverLayer,x=n.cd,p=x[0].trace,v=p.hoveron,f=v.indexOf("violins")!==-1,y=v.indexOf("kde")!==-1,o=[],m,l;if(f||y){var w=M.hoverOnBoxes(n,r,t,c);if(y&&w.length>0){var _=n.xa,h=n.ya,b,u,L,T,k;p.orientation==="h"?(k=r,b="y",L=h,u="x",T=_):(k=t,b="x",L=_,u="y",T=h);var P=x[n.index];if(k>=P.span[0]&&k<=P.span[1]){var z=g.extendFlat({},n),I=T.c2p(k,!0),D=e.getKdeValue(P,p,k),R=e.getPositionOnKdePath(P,p,I),O=L._offset,F=L._length;z[b+"0"]=R[0],z[b+"1"]=R[1],z[u+"0"]=z[u+"1"]=I,z[u+"Label"]=u+": "+S.hoverLabelText(T,k,p[u+"hoverformat"])+", "+x[0].t.labels.kde+" "+D.toFixed(3);for(var N=0,G=0;G<w.length;G++)if(w[G].attr==="med"){N=G;break}z.spikeDistance=w[N].spikeDistance;var K=b+"Spike";z[K]=w[N][K],w[N].spikeDistance=void 0,w[N][K]=void 0,z.hovertemplate=!1,o.push(z),l={},l[b+"1"]=g.constrain(O+R[0],O,O+F),l[b+"2"]=g.constrain(O+R[1],O,O+F),l[u+"1"]=l[u+"2"]=T._offset+I}}f&&(o=o.concat(w))}v.indexOf("points")!==-1&&(m=M.hoverOnPoints(n,r,t));var W=i.selectAll(".violinline-"+p.uid).data(l?[0]:[]);return W.enter().append("line").classed("violinline-"+p.uid,!0).attr("stroke-width",1.5),W.exit().remove(),W.attr(l).call(A.stroke,n.color),c==="closest"?m?[m]:o:(m&&o.push(m),o)}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axes":566,"../box/hover":687,"./helpers":1104}],1106:[function(d,ee,te){ee.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc"),plot:d("./plot"),style:d("./style"),styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("../box/select"),moduleType:"trace",name:"violin",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../box/defaults":685,"../box/select":692,"../scatter/style":960,"./attributes":1100,"./calc":1101,"./cross_trace_calc":1102,"./defaults":1103,"./hover":1105,"./layout_attributes":1107,"./layout_defaults":1108,"./plot":1109,"./style":1110}],1107:[function(d,ee,te){var A=d("../box/layout_attributes"),g=d("../../lib").extendFlat;ee.exports={violinmode:g({},A.boxmode,{}),violingap:g({},A.boxgap,{}),violingroupgap:g({},A.boxgroupgap,{})}},{"../../lib":515,"../box/layout_attributes":689}],1108:[function(d,ee,te){var A=d("../../lib"),g=d("./layout_attributes"),S=d("../box/layout_defaults");ee.exports=function(e,a,n){function r(t,c){return A.coerce(e,a,g,t,c)}S._supply(e,a,n,r,"violin")}},{"../../lib":515,"../box/layout_defaults":690,"./layout_attributes":1107}],1109:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=d("../../components/drawing"),M=d("../box/plot"),e=d("../scatter/line_points"),a=d("./helpers");ee.exports=function(r,t,c,s){var i=r._fullLayout,x=t.xaxis,p=t.yaxis;function v(f,y){var o=e(f,{xaxis:x,yaxis:p,trace:y,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return S.smoothopen(o[0],1)}g.makeTraceGroups(s,c,"trace violins").each(function(f){var y=A.select(this),o=f[0],m=o.t,l=o.trace;if(l.visible!==!0||m.empty){y.remove();return}var w=m.bPos,_=m.bdPos,h=t[m.valLetter+"axis"],b=t[m.posLetter+"axis"],u=l.side==="both",L=u||l.side==="positive",T=u||l.side==="negative",k=y.selectAll("path.violin").data(g.identity);k.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),k.exit().remove(),k.each(function(N){var G=A.select(this),K=N.density,W=K.length,Y=b.c2l(N.pos+w,!0),re=b.l2p(Y),ue;if(l.width)ue=m.maxKDE/_;else{var j=i._violinScaleGroupStats[l.scalegroup];ue=l.scalemode==="count"?j.maxKDE/_*(j.maxCount/N.pts.length):j.maxKDE/_}var q,V,U,$,ne,X,Q;if(L){for(X=new Array(W),$=0;$<W;$++)Q=X[$]={},Q[m.posLetter]=Y+K[$].v/ue,Q[m.valLetter]=h.c2l(K[$].t,!0);q=v(X,l)}if(T){for(X=new Array(W),ne=0,$=W-1;ne<W;ne++,$--)Q=X[ne]={},Q[m.posLetter]=Y-K[$].v/ue,Q[m.valLetter]=h.c2l(K[$].t,!0);V=v(X,l)}if(u)U=q+"L"+V.substr(1)+"Z";else{var ie=[re,h.c2p(K[0].t)],se=[re,h.c2p(K[W-1].t)];l.orientation==="h"&&(ie.reverse(),se.reverse()),L?U="M"+ie+"L"+q.substr(1)+"L"+se:U="M"+se+"L"+V.substr(1)+"L"+ie}G.attr("d",U),N.posCenterPx=re,N.posDensityScale=ue*_,N.path=G.node(),N.pathLength=N.path.getTotalLength()/(u?2:1)});var P=l.box,z=P.width,I=(P.line||{}).width,D,R;u?(D=_*z,R=0):L?(D=[0,_*z/2],R=I*{x:1,y:-1}[m.posLetter]):(D=[_*z/2,0],R=I*{x:-1,y:1}[m.posLetter]),M.plotBoxAndWhiskers(y,{pos:b,val:h},l,{bPos:w,bdPos:D,bPosPxOffset:R}),M.plotBoxMean(y,{pos:b,val:h},l,{bPos:w,bdPos:D,bPosPxOffset:R});var O;!l.box.visible&&l.meanline.visible&&(O=g.identity);var F=y.selectAll("path.meanline").data(O||[]);F.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),F.exit().remove(),F.each(function(N){var G=h.c2p(N.mean,!0),K=a.getPositionOnKdePath(N,l,G);A.select(this).attr("d",l.orientation==="h"?"M"+G+","+K[0]+"V"+K[1]:"M"+K[0]+","+G+"H"+K[1])}),M.plotPoints(y,{x,y:p},l,m)})}},{"../../components/drawing":389,"../../lib":515,"../box/plot":691,"../scatter/line_points":950,"./helpers":1104,"@plotly/d3":58}],1110:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/color"),S=d("../scatter/style").stylePoints;ee.exports=function(e){var a=A.select(e).selectAll("g.trace.violins");a.style("opacity",function(n){return n[0].trace.opacity}),a.each(function(n){var r=n[0].trace,t=A.select(this),c=r.box||{},s=c.line||{},i=r.meanline||{},x=i.width;t.selectAll("path.violin").style("stroke-width",r.line.width+"px").call(g.stroke,r.line.color).call(g.fill,r.fillcolor),t.selectAll("path.box").style("stroke-width",s.width+"px").call(g.stroke,s.color).call(g.fill,c.fillcolor);var p={"stroke-width":x+"px","stroke-dasharray":2*x+"px,"+x+"px"};t.selectAll("path.mean").style(p).call(g.stroke,i.color),t.selectAll("path.meanline").style(p).call(g.stroke,i.color),S(t,r,e)})}},{"../../components/color":367,"../scatter/style":960,"@plotly/d3":58}],1111:[function(d,ee,te){var A=d("../../components/colorscale/attributes"),g=d("../isosurface/attributes"),S=d("../surface/attributes"),M=d("../../plots/attributes"),e=d("../../lib/extend").extendFlat,a=d("../../plot_api/edit_types").overrideAll,n=ee.exports=a(e({x:g.x,y:g.y,z:g.z,value:g.value,isomin:g.isomin,isomax:g.isomax,surface:g.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:g.slices,caps:g.caps,text:g.text,hovertext:g.hovertext,xhoverformat:g.xhoverformat,yhoverformat:g.yhoverformat,zhoverformat:g.zhoverformat,valuehoverformat:g.valuehoverformat,hovertemplate:g.hovertemplate},A("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:g.colorbar,opacity:g.opacity,opacityscale:S.opacityscale,lightposition:g.lightposition,lighting:g.lighting,flatshading:g.flatshading,contour:g.contour,hoverinfo:e({},M.hoverinfo),showlegend:e({},M.showlegend,{dflt:!1})}),"calc","nested");n.x.editType=n.y.editType=n.z.editType=n.value.editType="calc+clearAxisTypes",n.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../isosurface/attributes":871,"../surface/attributes":1070}],1112:[function(d,ee,te){var A=d("../../../stackgl_modules").gl_mesh3d,g=d("../../lib/gl_format_color").parseColorScale,S=d("../../lib/str2rgbarray"),M=d("../../components/colorscale").extractOpts,e=d("../../plots/gl3d/zip3"),a=d("../isosurface/convert").findNearestOnAxis,n=d("../isosurface/convert").generateIsoMeshes;function r(s,i,x){this.scene=s,this.uid=x,this.mesh=i,this.name="",this.data=null,this.showContour=!1}var t=r.prototype;t.handlePick=function(s){if(s.object===this.mesh){var i=s.data.index,x=this.data._meshX[i],p=this.data._meshY[i],v=this.data._meshZ[i],f=this.data._Ys.length,y=this.data._Zs.length,o=a(x,this.data._Xs).id,m=a(p,this.data._Ys).id,l=a(v,this.data._Zs).id,w=s.index=l+y*m+y*f*o;s.traceCoordinate=[this.data._meshX[w],this.data._meshY[w],this.data._meshZ[w],this.data._value[w]];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[w]!==void 0?s.textLabel=_[w]:_&&(s.textLabel=_),!0}},t.update=function(s){var i=this.scene,x=i.fullSceneLayout;this.data=n(s);function p(m,l,w,_){return l.map(function(h){return m.d2l(h,0,_)*w})}var v=e(p(x.xaxis,s._meshX,i.dataScale[0],s.xcalendar),p(x.yaxis,s._meshY,i.dataScale[1],s.ycalendar),p(x.zaxis,s._meshZ,i.dataScale[2],s.zcalendar)),f=e(s._meshI,s._meshJ,s._meshK),y={positions:v,cells:f,lightPosition:[s.lightposition.x,s.lightposition.y,s.lightposition.z],ambient:s.lighting.ambient,diffuse:s.lighting.diffuse,specular:s.lighting.specular,roughness:s.lighting.roughness,fresnel:s.lighting.fresnel,vertexNormalsEpsilon:s.lighting.vertexnormalsepsilon,faceNormalsEpsilon:s.lighting.facenormalsepsilon,opacity:s.opacity,opacityscale:s.opacityscale,contourEnable:s.contour.show,contourColor:S(s.contour.color).slice(0,3),contourWidth:s.contour.width,useFacetNormals:s.flatshading},o=M(s);y.vertexIntensity=s._meshIntensity,y.vertexIntensityBounds=[o.min,o.max],y.colormap=g(s),this.mesh.update(y)},t.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function c(s,i){var x=s.glplot.gl,p=A({gl:x}),v=new r(s,p,i.uid);return p._trace=v,v.update(i),s.glplot.add(p),v}ee.exports=c},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618,"../isosurface/convert":873}],1113:[function(d,ee,te){var A=d("../../lib"),g=d("./attributes"),S=d("../isosurface/defaults").supplyIsoDefaults,M=d("../surface/defaults").opacityscaleDefaults;ee.exports=function(a,n,r,t){function c(s,i){return A.coerce(a,n,g,s,i)}S(a,n,r,t,c),M(a,n,t,c)}},{"../../lib":515,"../isosurface/defaults":874,"../surface/defaults":1073,"./attributes":1111}],1114:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:d("./convert"),moduleType:"trace",name:"volume",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"../isosurface/calc":872,"./attributes":1111,"./convert":1112,"./defaults":1113}],1115:[function(d,ee,te){var A=d("../bar/attributes"),g=d("../scatter/attributes").line,S=d("../../plots/attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/template_attributes").texttemplateAttrs,n=d("./constants"),r=d("../../lib/extend").extendFlat,t=d("../../components/color");function c(s){return{marker:{color:r({},A.marker.color,{arrayOk:!1,editType:"style"}),line:{color:r({},A.marker.line.color,{arrayOk:!1,editType:"style"}),width:r({},A.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}ee.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:A.x,x0:A.x0,dx:A.dx,y:A.y,y0:A.y0,dy:A.dy,xperiod:A.xperiod,yperiod:A.yperiod,xperiod0:A.xperiod0,yperiod0:A.yperiod0,xperiodalignment:A.xperiodalignment,yperiodalignment:A.yperiodalignment,xhoverformat:M("x"),yhoverformat:M("y"),hovertext:A.hovertext,hovertemplate:e({},{keys:n.eventDataKeys}),hoverinfo:r({},S.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:a({editType:"plot"},{keys:n.eventDataKeys.concat(["label"])}),text:A.text,textposition:A.textposition,insidetextanchor:A.insidetextanchor,textangle:A.textangle,textfont:A.textfont,insidetextfont:A.insidetextfont,outsidetextfont:A.outsidetextfont,constraintext:A.constraintext,cliponaxis:A.cliponaxis,orientation:A.orientation,offset:A.offset,width:A.width,increasing:c(),decreasing:c(),totals:c(),connector:{line:{color:r({},g.color,{dflt:t.defaultLine}),width:r({},g.width,{editType:"plot"}),dash:g.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:A.offsetgroup,alignmentgroup:A.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":1117}],1116:[function(d,ee,te){var A=d("../../plots/cartesian/axes"),g=d("../../plots/cartesian/align_period"),S=d("../../lib").mergeArray,M=d("../scatter/calc_selection"),e=d("../../constants/numerical").BADNUM;function a(r){return r==="a"||r==="absolute"}function n(r){return r==="t"||r==="total"}ee.exports=function(t,c){var s=A.getFromId(t,c.xaxis||"x"),i=A.getFromId(t,c.yaxis||"y"),x,p,v,f,y,o;c.orientation==="h"?(x=s.makeCalcdata(c,"x"),v=i.makeCalcdata(c,"y"),f=g(c,i,"y",v),y=!!c.yperiodalignment,o="y"):(x=i.makeCalcdata(c,"y"),v=s.makeCalcdata(c,"x"),f=g(c,s,"x",v),y=!!c.xperiodalignment,o="x"),p=f.vals;for(var m=Math.min(p.length,x.length),l=new Array(m),w=0,_,h=!1,b=0;b<m;b++){var u=x[b]||0,L=!1;(x[b]!==e||n(c.measure[b])||a(c.measure[b]))&&b+1<m&&(x[b+1]!==e||n(c.measure[b+1])||a(c.measure[b+1]))&&(L=!0);var T=l[b]={i:b,p:p[b],s:u,rawS:u,cNext:L};a(c.measure[b])?(w=T.s,T.isSum=!0,T.dir="totals",T.s=w):n(c.measure[b])?(T.isSum=!0,T.dir="totals",T.s=w):(T.isSum=!1,T.dir=T.rawS<0?"decreasing":"increasing",_=T.s,T.s=w+_,w+=_),T.dir==="totals"&&(h=!0),y&&(l[b].orig_p=v[b],l[b][o+"End"]=f.ends[b],l[b][o+"Start"]=f.starts[b]),c.ids&&(T.id=String(c.ids[b])),T.v=(c.base||0)+w}return l.length&&(l[0].hasTotals=h),S(c.text,l,"tx"),S(c.hovertext,l,"htx"),M(l,c),l}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938}],1117:[function(d,ee,te){ee.exports={eventDataKeys:["initial","delta","final"]}},{}],1118:[function(d,ee,te){var A=d("../bar/cross_trace_calc").setGroupPositions;ee.exports=function(S,M){var e=S._fullLayout,a=S._fullData,n=S.calcdata,r=M.xaxis,t=M.yaxis,c=[],s=[],i=[],x,p;for(p=0;p<a.length;p++){var v=a[p];v.visible===!0&&v.xaxis===r._id&&v.yaxis===t._id&&v.type==="waterfall"&&(x=n[p],v.orientation==="h"?i.push(x):s.push(x),c.push(x))}var f={mode:e.waterfallmode,norm:e.waterfallnorm,gap:e.waterfallgap,groupgap:e.waterfallgroupgap};for(A(S,r,t,s,f),A(S,t,r,i,f),p=0;p<c.length;p++){x=c[p];for(var y=0;y<x.length;y++){var o=x[y];o.isSum===!1&&(o.s0+=y===0?0:x[y-1].s),y+1<x.length&&(x[y].nextP0=x[y+1].p0,x[y].nextS0=x[y+1].s0)}}}},{"../bar/cross_trace_calc":660}],1119:[function(d,ee,te){var A=d("../../lib"),g=d("../bar/defaults").handleGroupingDefaults,S=d("../bar/defaults").handleText,M=d("../scatter/xy_defaults"),e=d("../scatter/period_defaults"),a=d("./attributes"),n=d("../../components/color"),r=d("../../constants/delta.js"),t=r.INCREASING.COLOR,c=r.DECREASING.COLOR,s="#4499FF";function i(v,f,y){v(f+".marker.color",y),v(f+".marker.line.color",n.defaultLine),v(f+".marker.line.width")}function x(v,f,y,o){function m(b,u){return A.coerce(v,f,a,b,u)}var l=M(v,f,o,m);if(!l){f.visible=!1;return}e(v,f,o,m),m("xhoverformat"),m("yhoverformat"),m("measure"),m("orientation",f.x&&!f.y?"h":"v"),m("base"),m("offset"),m("width"),m("text"),m("hovertext"),m("hovertemplate");var w=m("textposition");S(v,f,o,m,w,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),f.textposition!=="none"&&(m("texttemplate"),f.texttemplate||m("textinfo")),i(m,"increasing",t),i(m,"decreasing",c),i(m,"totals",s);var _=m("connector.visible");if(_){m("connector.mode");var h=m("connector.line.width");h&&(m("connector.line.color"),m("connector.line.dash"))}}function p(v,f){var y,o;function m(w){return A.coerce(o._input,o,a,w)}if(f.waterfallmode==="group")for(var l=0;l<v.length;l++)o=v[l],y=o._input,g(y,o,f,m)}ee.exports={supplyDefaults:x,crossTraceDefaults:p}},{"../../components/color":367,"../../constants/delta.js":485,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":1115}],1120:[function(d,ee,te){ee.exports=function(g,S){return g.x="xVal"in S?S.xVal:S.x,g.y="yVal"in S?S.yVal:S.y,"initial"in S&&(g.initial=S.initial),"delta"in S&&(g.delta=S.delta),"final"in S&&(g.final=S.final),S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),g}},{}],1121:[function(d,ee,te){var A=d("../../plots/cartesian/axes").hoverLabelText,g=d("../../components/color").opacity,S=d("../bar/hover").hoverOnBars,M=d("../../constants/delta.js"),e={increasing:M.INCREASING.SYMBOL,decreasing:M.DECREASING.SYMBOL};ee.exports=function(r,t,c,s,i){var x=S(r,t,c,s,i);if(!x)return;var p=x.cd,v=p[0].trace,f=v.orientation==="h",y=f?"x":"y",o=f?r.xa:r.ya;function m(P){return A(o,P,v[y+"hoverformat"])}var l=x.index,w=p[l],_=w.isSum?w.b+w.s:w.rawS;if(!w.isSum){x.initial=w.b+w.s-_,x.delta=_,x.final=x.initial+x.delta;var h=m(Math.abs(x.delta));x.deltaLabel=_<0?"("+h+")":h,x.finalLabel=m(x.final),x.initialLabel=m(x.initial)}var b=w.hi||v.hoverinfo,u=[];if(b&&b!=="none"&&b!=="skip"){var L=b==="all",T=b.split("+"),k=function(P){return L||T.indexOf(P)!==-1};w.isSum||(k("final")&&(f?!k("x"):!k("y"))&&u.push(x.finalLabel),k("delta")&&(_<0?u.push(x.deltaLabel+" "+e.decreasing):u.push(x.deltaLabel+" "+e.increasing)),k("initial")&&u.push("Initial: "+x.initialLabel))}return u.length&&(x.extraText=u.join("<br>")),x.color=a(v,w),[x]};function a(n,r){var t=n[r.dir].marker,c=t.color,s=t.line.color,i=t.line.width;if(g(c))return c;if(g(s)&&i)return s}},{"../../components/color":367,"../../constants/delta.js":485,"../../plots/cartesian/axes":566,"../bar/hover":664}],1122:[function(d,ee,te){ee.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults").supplyDefaults,crossTraceDefaults:d("./defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc"),plot:d("./plot"),style:d("./style").style,hoverPoints:d("./hover"),eventData:d("./event_data"),selectPoints:d("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:d("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":1115,"./calc":1116,"./cross_trace_calc":1118,"./defaults":1119,"./event_data":1120,"./hover":1121,"./layout_attributes":1123,"./layout_defaults":1124,"./plot":1125,"./style":1126}],1123:[function(d,ee,te){ee.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1124:[function(d,ee,te){var A=d("../../lib"),g=d("./layout_attributes");ee.exports=function(S,M,e){var a=!1;function n(c,s){return A.coerce(S,M,g,c,s)}for(var r=0;r<e.length;r++){var t=e[r];if(t.visible&&t.type==="waterfall"){a=!0;break}}a&&(n("waterfallmode"),n("waterfallgap",.2),n("waterfallgroupgap"))}},{"../../lib":515,"./layout_attributes":1123}],1125:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../lib"),S=d("../../components/drawing"),M=d("../../constants/numerical").BADNUM,e=d("../bar/plot"),a=d("../bar/uniform_text").clearMinTextSize;ee.exports=function(c,s,i,x){var p=c._fullLayout;a("waterfall",p),e.plot(c,s,i,x,{mode:p.waterfallmode,norm:p.waterfallmode,gap:p.waterfallgap,groupgap:p.waterfallgroupgap}),n(c,s,i,x)};function n(t,c,s,i){var x=c.xaxis,p=c.yaxis;g.makeTraceGroups(i,s,"trace bars").each(function(v){var f=A.select(this),y=v[0].trace,o=g.ensureSingle(f,"g","lines");if(!y.connector||!y.connector.visible){o.remove();return}var m=y.orientation==="h",l=y.connector.mode,w=o.selectAll("g.line").data(g.identity);w.enter().append("g").classed("line",!0),w.exit().remove();var _=w.size();w.each(function(h,b){if(!(b!==_-1&&!h.cNext)){var u=r(h,x,p,m),L=u[0],T=u[1],k="";L[0]!==M&&T[0]!==M&&L[1]!==M&&T[1]!==M&&(l==="spanning"&&!h.isSum&&b>0&&(m?k+="M"+L[0]+","+T[1]+"V"+T[0]:k+="M"+L[1]+","+T[0]+"H"+L[0]),l!=="between"&&(h.isSum||b<_-1)&&(m?k+="M"+L[1]+","+T[0]+"V"+T[1]:k+="M"+L[0]+","+T[1]+"H"+L[1]),L[2]!==M&&T[2]!==M&&(m?k+="M"+L[1]+","+T[1]+"V"+T[2]:k+="M"+L[1]+","+T[1]+"H"+L[2])),k===""&&(k="M0,0Z"),g.ensureSingle(A.select(this),"path").attr("d",k).call(S.setClipUrl,c.layerClipId,t)}})})}function r(t,c,s,i){var x=[],p=[],v=i?c:s,f=i?s:c;return x[0]=v.c2p(t.s0,!0),p[0]=f.c2p(t.p0,!0),x[1]=v.c2p(t.s1,!0),p[1]=f.c2p(t.p1,!0),x[2]=v.c2p(t.nextS0,!0),p[2]=f.c2p(t.nextP0,!0),i?[x,p]:[p,x]}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],1126:[function(d,ee,te){var A=d("@plotly/d3"),g=d("../../components/drawing"),S=d("../../components/color"),M=d("../../constants/interactions").DESELECTDIM,e=d("../bar/style"),a=d("../bar/uniform_text").resizeText,n=e.styleTextPoints;function r(t,c,s){var i=s||A.select(t).selectAll("g.waterfalllayer").selectAll("g.trace");a(t,i,"waterfall"),i.style("opacity",function(x){return x[0].trace.opacity}),i.each(function(x){var p=A.select(this),v=x[0].trace;p.selectAll(".point > path").each(function(f){if(!f.isBlank){var y=v[f.dir].marker;A.select(this).call(S.fill,y.color).call(S.stroke,y.line.color).call(g.dashLine,y.line.dash,y.line.width).style("opacity",v.selectedpoints&&!f.selected?M:1)}}),n(p,v,t),p.selectAll(".lines").each(function(){var f=v.connector.line;g.lineGroupStyle(A.select(this).selectAll("path"),f.width,f.color,f.dash)})})}ee.exports={style:r}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],1127:[function(d,ee,te){var A=d("../plots/cartesian/axes"),g=d("../lib"),S=d("../plot_api/plot_schema"),M=d("./helpers").pointsAccessorFunction,e=d("../constants/numerical").BADNUM;te.moduleType="transform",te.name="aggregate";var a=te.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},n=a.aggregations;te.supplyDefaults=function(x,p){var v={},f;function y(P,z){return g.coerce(x,v,a,P,z)}var o=y("enabled");if(!o)return v;var m=S.findArrayAttributes(p),l={};for(f=0;f<m.length;f++)l[m[f]]=1;var w=y("groups");if(!Array.isArray(w)){if(!l[w])return v.enabled=!1,v;l[w]=0}var _=x.aggregations||[],h=v.aggregations=new Array(_.length),b;function u(P,z){return g.coerce(_[f],b,n,P,z)}for(f=0;f<_.length;f++){b={_index:f};var L=u("target"),T=u("func"),k=u("enabled");k&&L&&(l[L]||T==="count"&&l[L]===void 0)?(T==="stddev"&&u("funcmode"),l[L]=0,h[f]=b):h[f]={enabled:!1,_index:f}}for(f=0;f<m.length;f++)l[m[f]]&&h.push({target:m[f],func:n.func.dflt,enabled:!0,_index:-1});return v},te.calcTransform=function(x,p,v){if(!!v.enabled){var f=v.groups,y=g.getTargetArray(p,{target:f});if(!!y){var o,m,l,w,_={},h={},b=[],u=M(p.transforms,v),L=y.length;for(p._length&&(L=Math.min(L,p._length)),o=0;o<L;o++)m=y[o],l=_[m],l===void 0?(_[m]=b.length,w=[o],b.push(w),h[_[m]]=u(o)):(b[l].push(o),h[_[m]]=(h[_[m]]||[]).concat(u(o)));v._indexToPoints=h;var T=v.aggregations;for(o=0;o<T.length;o++)r(x,p,b,T[o]);typeof f=="string"&&r(x,p,b,{target:f,func:"first",enabled:!0}),p._length=b.length}}};function r(x,p,v,f){if(!!f.enabled){for(var y=f.target,o=g.nestedProperty(p,y),m=o.get(),l=A.getDataConversions(x,p,y,m),w=t(f,l),_=new Array(v.length),h=0;h<v.length;h++)_[h]=w(m,v[h]);o.set(_),f.func==="count"&&g.pushUnique(p._arrayAttrs,y)}}function t(x,p){var v=x.func,f=p.d2c,y=p.c2d;switch(v){case"count":return c;case"first":return s;case"last":return i;case"sum":return function(o,m){for(var l=0,w=0;w<m.length;w++){var _=f(o[m[w]]);_!==e&&(l+=_)}return y(l)};case"avg":return function(o,m){for(var l=0,w=0,_=0;_<m.length;_++){var h=f(o[m[_]]);h!==e&&(l+=h,w++)}return w?y(l/w):e};case"min":return function(o,m){for(var l=1/0,w=0;w<m.length;w++){var _=f(o[m[w]]);_!==e&&(l=Math.min(l,_))}return l===1/0?e:y(l)};case"max":return function(o,m){for(var l=-1/0,w=0;w<m.length;w++){var _=f(o[m[w]]);_!==e&&(l=Math.max(l,_))}return l===-1/0?e:y(l)};case"range":return function(o,m){for(var l=1/0,w=-1/0,_=0;_<m.length;_++){var h=f(o[m[_]]);h!==e&&(l=Math.min(l,h),w=Math.max(w,h))}return w===-1/0||l===1/0?e:y(w-l)};case"change":return function(o,m){var l=f(o[m[0]]),w=f(o[m[m.length-1]]);return l===e||w===e?e:y(w-l)};case"median":return function(o,m){for(var l=[],w=0;w<m.length;w++){var _=f(o[m[w]]);_!==e&&l.push(_)}if(!l.length)return e;l.sort(g.sorterAsc);var h=(l.length-1)/2;return y((l[Math.floor(h)]+l[Math.ceil(h)])/2)};case"mode":return function(o,m){for(var l={},w=0,_=e,h=0;h<m.length;h++){var b=f(o[m[h]]);if(b!==e){var u=l[b]=(l[b]||0)+1;u>w&&(w=u,_=b)}}return w?y(_):e};case"rms":return function(o,m){for(var l=0,w=0,_=0;_<m.length;_++){var h=f(o[m[_]]);h!==e&&(l+=h*h,w++)}return w?y(Math.sqrt(l/w)):e};case"stddev":return function(o,m){var l=0,w=0,_=1,h=e,b;for(b=0;b<m.length&&h===e;b++)h=f(o[m[b]]);if(h===e)return e;for(;b<m.length;b++){var u=f(o[m[b]]);if(u!==e){var L=u-h;l+=L,w+=L*L,_++}}var T=x.funcmode==="sample"?_-1:_;return T?Math.sqrt((w-l*l/_)/T):0}}}function c(x,p){return p.length}function s(x,p){return x[p[0]]}function i(x,p){return x[p[p.length-1]]}},{"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plots/cartesian/axes":566,"./helpers":1130}],1128:[function(d,ee,te){var A=d("../lib"),g=d("../registry"),S=d("../plots/cartesian/axes"),M=d("./helpers").pointsAccessorFunction,e=d("../constants/filter_ops"),a=e.COMPARISON_OPS,n=e.INTERVAL_OPS,r=e.SET_OPS;te.moduleType="transform",te.name="filter",te.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(a).concat(n).concat(r),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},te.supplyDefaults=function(c){var s={};function i(f,y){return A.coerce(c,s,te.attributes,f,y)}var x=i("enabled");if(x){var p=i("target");if(A.isArrayOrTypedArray(p)&&p.length===0)return s.enabled=!1,s;i("preservegaps"),i("operation"),i("value");var v=g.getComponentMethod("calendars","handleDefaults");v(c,s,"valuecalendar",null),v(c,s,"targetcalendar",null)}return s},te.calcTransform=function(c,s,i){if(!i.enabled)return;var x=A.getTargetArray(s,i);if(!x)return;var p=i.target,v=x.length;s._length&&(v=Math.min(v,s._length));var f=i.targetcalendar,y=s._arrayAttrs,o=i.preservegaps;if(typeof p=="string"){var m=A.nestedProperty(s,p+"calendar").get();m&&(f=m)}var l=S.getDataToCoordFunc(c,s,p,x),w=t(i,l,f),_={},h={},b=0;function u(I,D){for(var R=0;R<y.length;R++){var O=A.nestedProperty(s,y[R]);I(O,D)}}var L,T;o?(L=function(I){_[I.astr]=A.extendDeep([],I.get()),I.set(new Array(v))},T=function(I,D){var R=_[I.astr][D];I.get()[D]=R}):(L=function(I){_[I.astr]=A.extendDeep([],I.get()),I.set([])},T=function(I,D){var R=_[I.astr][D];I.get().push(R)}),u(L);for(var k=M(s.transforms,i),P=0;P<v;P++){var z=w(x[P]);z?(u(T,P),h[b++]=k(P)):o&&b++}i._indexToPoints=h,s._length=b};function t(c,s,i){var x=c.operation,p=c.value,v=Array.isArray(p);function f(l){return l.indexOf(x)!==-1}var y=function(l){return s(l,0,c.valuecalendar)},o=function(l){return s(l,0,i)},m;switch(f(a)?m=y(v?p[0]:p):f(n)?m=v?[y(p[0]),y(p[1])]:[y(p),y(p)]:f(r)&&(m=v?p.map(y):[y(p)]),x){case"=":return function(l){return o(l)===m};case"!=":return function(l){return o(l)!==m};case"<":return function(l){return o(l)<m};case"<=":return function(l){return o(l)<=m};case">":return function(l){return o(l)>m};case">=":return function(l){return o(l)>=m};case"[]":return function(l){var w=o(l);return w>=m[0]&&w<=m[1]};case"()":return function(l){var w=o(l);return w>m[0]&&w<m[1]};case"[)":return function(l){var w=o(l);return w>=m[0]&&w<m[1]};case"(]":return function(l){var w=o(l);return w>m[0]&&w<=m[1]};case"][":return function(l){var w=o(l);return w<=m[0]||w>=m[1]};case")(":return function(l){var w=o(l);return w<m[0]||w>m[1]};case"](":return function(l){var w=o(l);return w<=m[0]||w>m[1]};case")[":return function(l){var w=o(l);return w<m[0]||w>=m[1]};case"{}":return function(l){return m.indexOf(o(l))!==-1};case"}{":return function(l){return m.indexOf(o(l))===-1}}}},{"../constants/filter_ops":487,"../lib":515,"../plots/cartesian/axes":566,"../registry":647,"./helpers":1130}],1129:[function(d,ee,te){var A=d("../lib"),g=d("../plot_api/plot_schema"),S=d("../plots/plots"),M=d("./helpers").pointsAccessorFunction;te.moduleType="transform",te.name="groupby",te.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},te.supplyDefaults=function(a,n,r){var t,c={};function s(y,o){return A.coerce(a,c,te.attributes,y,o)}var i=s("enabled");if(!i)return c;s("groups"),s("nameformat",r._dataLength>1?"%{group} (%{trace})":"%{group}");var x=a.styles,p=c.styles=[];if(x)for(t=0;t<x.length;t++){var v=p[t]={};A.coerce(x[t],p[t],te.attributes.styles,"target");var f=A.coerce(x[t],p[t],te.attributes.styles,"value");A.isPlainObject(f)?v.value=A.extendDeep({},f):f&&delete v.value}return c},te.transform=function(a,n){var r,t,c,s=[];for(t=0;t<a.length;t++)for(r=e(a[t],n),c=0;c<r.length;c++)s.push(r[c]);return s};function e(a,n){var r,t,c,s,i,x,p,v,f,y,o=n.transform,m=n.transformIndex,l=a.transforms[m].groups,w=M(a.transforms,o);if(!A.isArrayOrTypedArray(l)||l.length===0)return[a];var _=A.filterUnique(l),h=new Array(_.length),b=l.length,u=g.findArrayAttributes(a),L=o.styles||[],T={};for(r=0;r<L.length;r++)T[L[r].target]=L[r].value;o.styles&&(y=A.keyedContainer(o,"styles","target","value.name"));var k={},P={};for(r=0;r<_.length;r++){x=_[r],k[x]=r,P[x]=0,p=h[r]=A.extendDeepNoArrays({},a),p._group=x,p.transforms[m]._indexToPoints={};var z=null;for(y&&(z=y.get(x)),z||z===""?p.name=z:p.name=A.templateString(o.nameformat,{trace:a.name,group:x}),v=p.transforms,p.transforms=[],t=0;t<v.length;t++)p.transforms[t]=A.extendDeepNoArrays({},v[t]);for(t=0;t<u.length;t++)A.nestedProperty(p,u[t]).set([])}for(c=0;c<u.length;c++){for(s=u[c],t=0,f=[];t<_.length;t++)f[t]=A.nestedProperty(h[t],s).get();for(i=A.nestedProperty(a,s).get(),t=0;t<b;t++)f[k[l[t]]].push(i[t])}for(t=0;t<b;t++){p=h[k[l[t]]];var I=p.transforms[m]._indexToPoints;I[P[l[t]]]=w(t),P[l[t]]++}for(r=0;r<_.length;r++)x=_[r],p=h[r],S.clearExpandedTraceDefaultColors(p),p=A.extendDeepNoArrays(p,T[x]||{});return h}},{"../lib":515,"../plot_api/plot_schema":554,"../plots/plots":628,"./helpers":1130}],1130:[function(d,ee,te){te.pointsAccessorFunction=function(A,g){for(var S,M,e=0;e<A.length&&(S=A[e],S!==g);e++)!S._indexToPoints||S.enabled===!1||(M=S._indexToPoints);var a=M?function(n){return M[n]}:function(n){return[n]};return a}},{}],1131:[function(d,ee,te){var A=d("../lib"),g=d("../plots/cartesian/axes"),S=d("./helpers").pointsAccessorFunction,M=d("../constants/numerical").BADNUM;te.moduleType="transform",te.name="sort",te.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},te.supplyDefaults=function(n){var r={};function t(s,i){return A.coerce(n,r,te.attributes,s,i)}var c=t("enabled");return c&&(t("target"),t("order")),r},te.calcTransform=function(n,r,t){if(!!t.enabled){var c=A.getTargetArray(r,t);if(!!c){var s=t.target,i=c.length;r._length&&(i=Math.min(i,r._length));var x=r._arrayAttrs,p=g.getDataToCoordFunc(n,r,s,c),v=e(t,c,p,i),f=S(r.transforms,t),y={},o,m;for(o=0;o<x.length;o++){var l=A.nestedProperty(r,x[o]),w=l.get(),_=new Array(i);for(m=0;m<i;m++)_[m]=w[v[m]];l.set(_)}for(m=0;m<i;m++)y[m]=f(v[m]);t._indexToPoints=y,r._length=i}}};function e(n,r,t,c){var s=new Array(c),i=new Array(c),x;for(x=0;x<c;x++)s[x]={v:r[x],i:x};for(s.sort(a(n,t)),x=0;x<c;x++)i[x]=s[x].i;return i}function a(n,r){switch(n.order){case"ascending":return function(t,c){var s=r(t.v),i=r(c.v);return s===M?1:i===M?-1:s-i};case"descending":return function(t,c){var s=r(t.v),i=r(c.v);return s===M?1:i===M?-1:i-s}}}},{"../constants/numerical":491,"../lib":515,"../plots/cartesian/axes":566,"./helpers":1130}],1132:[function(d,ee,te){te.version="2.16.3"},{}],1133:[function(d,ee,te){(function(A){(function(){(function(g){if(typeof te=="object"&&typeof ee<"u")ee.exports=g();else{var S;typeof window<"u"?S=window:typeof A<"u"?S=A:typeof self<"u"?S=self:S=this,S.stackgl=g()}})(function(){return function(){function g(S,M,e){function a(t,c){if(!M[t]){if(!S[t]){var s=typeof d=="function"&&d;if(!c&&s)return s(t,!0);if(n)return n(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var x=M[t]={exports:{}};S[t][0].call(x.exports,function(p){var v=S[t][1][p];return a(v||p)},x,x.exports,g,S,M,e)}return M[t].exports}for(var n=typeof d=="function"&&d,r=0;r<e.length;r++)a(e[r]);return a}return g}()({1:[function(g,S,M){M.byteLength=i,M.toByteArray=p,M.fromByteArray=y;for(var e=[],a=[],n=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,c=r.length;t<c;++t)e[t]=r[t],a[r.charCodeAt(t)]=t;a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63;function s(o){var m=o.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=o.indexOf("=");l===-1&&(l=m);var w=l===m?0:4-l%4;return[l,w]}function i(o){var m=s(o),l=m[0],w=m[1];return(l+w)*3/4-w}function x(o,m,l){return(m+l)*3/4-l}function p(o){var m,l=s(o),w=l[0],_=l[1],h=new n(x(o,w,_)),b=0,u=_>0?w-4:w,L;for(L=0;L<u;L+=4)m=a[o.charCodeAt(L)]<<18|a[o.charCodeAt(L+1)]<<12|a[o.charCodeAt(L+2)]<<6|a[o.charCodeAt(L+3)],h[b++]=m>>16&255,h[b++]=m>>8&255,h[b++]=m&255;return _===2&&(m=a[o.charCodeAt(L)]<<2|a[o.charCodeAt(L+1)]>>4,h[b++]=m&255),_===1&&(m=a[o.charCodeAt(L)]<<10|a[o.charCodeAt(L+1)]<<4|a[o.charCodeAt(L+2)]>>2,h[b++]=m>>8&255,h[b++]=m&255),h}function v(o){return e[o>>18&63]+e[o>>12&63]+e[o>>6&63]+e[o&63]}function f(o,m,l){for(var w,_=[],h=m;h<l;h+=3)w=(o[h]<<16&16711680)+(o[h+1]<<8&65280)+(o[h+2]&255),_.push(v(w));return _.join("")}function y(o){for(var m,l=o.length,w=l%3,_=[],h=16383,b=0,u=l-w;b<u;b+=h)_.push(f(o,b,b+h>u?u:b+h));return w===1?(m=o[l-1],_.push(e[m>>2]+e[m<<4&63]+"==")):w===2&&(m=(o[l-2]<<8)+o[l-1],_.push(e[m>>10]+e[m>>4&63]+e[m<<2&63]+"=")),_.join("")}},{}],2:[function(g,S,M){},{}],3:[function(g,S,M){(function(e){(function(){var a=g("base64-js"),n=g("ieee754");M.Buffer=s,M.SlowBuffer=w,M.INSPECT_MAX_BYTES=50;var r=2147483647;M.kMaxLength=r,s.TYPED_ARRAY_SUPPORT=t(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function t(){try{var ce=new Uint8Array(1);return ce.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},ce.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(!!s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(!!s.isBuffer(this))return this.byteOffset}});function c(ce){if(ce>r)throw new RangeError('The value "'+ce+'" is invalid for option "size"');var de=new Uint8Array(ce);return de.__proto__=s.prototype,de}function s(ce,de,ye){if(typeof ce=="number"){if(typeof de=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(ce)}return i(ce,de,ye)}typeof Symbol<"u"&&Symbol.species!=null&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192;function i(ce,de,ye){if(typeof ce=="string")return f(ce,de);if(ArrayBuffer.isView(ce))return y(ce);if(ce==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ce);if(oe(ce,ArrayBuffer)||ce&&oe(ce.buffer,ArrayBuffer))return o(ce,de,ye);if(typeof ce=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ge=ce.valueOf&&ce.valueOf();if(ge!=null&&ge!==ce)return s.from(ge,de,ye);var me=m(ce);if(me)return me;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ce[Symbol.toPrimitive]=="function")return s.from(ce[Symbol.toPrimitive]("string"),de,ye);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ce)}s.from=function(ce,de,ye){return i(ce,de,ye)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array;function x(ce){if(typeof ce!="number")throw new TypeError('"size" argument must be of type number');if(ce<0)throw new RangeError('The value "'+ce+'" is invalid for option "size"')}function p(ce,de,ye){return x(ce),ce<=0?c(ce):de!==void 0?typeof ye=="string"?c(ce).fill(de,ye):c(ce).fill(de):c(ce)}s.alloc=function(ce,de,ye){return p(ce,de,ye)};function v(ce){return x(ce),c(ce<0?0:l(ce)|0)}s.allocUnsafe=function(ce){return v(ce)},s.allocUnsafeSlow=function(ce){return v(ce)};function f(ce,de){if((typeof de!="string"||de==="")&&(de="utf8"),!s.isEncoding(de))throw new TypeError("Unknown encoding: "+de);var ye=_(ce,de)|0,ge=c(ye),me=ge.write(ce,de);return me!==ye&&(ge=ge.slice(0,me)),ge}function y(ce){for(var de=ce.length<0?0:l(ce.length)|0,ye=c(de),ge=0;ge<de;ge+=1)ye[ge]=ce[ge]&255;return ye}function o(ce,de,ye){if(de<0||ce.byteLength<de)throw new RangeError('"offset" is outside of buffer bounds');if(ce.byteLength<de+(ye||0))throw new RangeError('"length" is outside of buffer bounds');var ge;return de===void 0&&ye===void 0?ge=new Uint8Array(ce):ye===void 0?ge=new Uint8Array(ce,de):ge=new Uint8Array(ce,de,ye),ge.__proto__=s.prototype,ge}function m(ce){if(s.isBuffer(ce)){var de=l(ce.length)|0,ye=c(de);return ye.length===0||ce.copy(ye,0,0,de),ye}if(ce.length!==void 0)return typeof ce.length!="number"||be(ce.length)?c(0):y(ce);if(ce.type==="Buffer"&&Array.isArray(ce.data))return y(ce.data)}function l(ce){if(ce>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return ce|0}function w(ce){return+ce!=ce&&(ce=0),s.alloc(+ce)}s.isBuffer=function(de){return de!=null&&de._isBuffer===!0&&de!==s.prototype},s.compare=function(de,ye){if(oe(de,Uint8Array)&&(de=s.from(de,de.offset,de.byteLength)),oe(ye,Uint8Array)&&(ye=s.from(ye,ye.offset,ye.byteLength)),!s.isBuffer(de)||!s.isBuffer(ye))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(de===ye)return 0;for(var ge=de.length,me=ye.length,Ee=0,Pe=Math.min(ge,me);Ee<Pe;++Ee)if(de[Ee]!==ye[Ee]){ge=de[Ee],me=ye[Ee];break}return ge<me?-1:me<ge?1:0},s.isEncoding=function(de){switch(String(de).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(de,ye){if(!Array.isArray(de))throw new TypeError('"list" argument must be an Array of Buffers');if(de.length===0)return s.alloc(0);var ge;if(ye===void 0)for(ye=0,ge=0;ge<de.length;++ge)ye+=de[ge].length;var me=s.allocUnsafe(ye),Ee=0;for(ge=0;ge<de.length;++ge){var Pe=de[ge];if(oe(Pe,Uint8Array)&&(Pe=s.from(Pe)),!s.isBuffer(Pe))throw new TypeError('"list" argument must be an Array of Buffers');Pe.copy(me,Ee),Ee+=Pe.length}return me};function _(ce,de){if(s.isBuffer(ce))return ce.length;if(ArrayBuffer.isView(ce)||oe(ce,ArrayBuffer))return ce.byteLength;if(typeof ce!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ce);var ye=ce.length,ge=arguments.length>2&&arguments[2]===!0;if(!ge&&ye===0)return 0;for(var me=!1;;)switch(de){case"ascii":case"latin1":case"binary":return ye;case"utf8":case"utf-8":return X(ce).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ye*2;case"hex":return ye>>>1;case"base64":return se(ce).length;default:if(me)return ge?-1:X(ce).length;de=(""+de).toLowerCase(),me=!0}}s.byteLength=_;function h(ce,de,ye){var ge=!1;if((de===void 0||de<0)&&(de=0),de>this.length||((ye===void 0||ye>this.length)&&(ye=this.length),ye<=0)||(ye>>>=0,de>>>=0,ye<=de))return"";for(ce||(ce="utf8");;)switch(ce){case"hex":return W(this,de,ye);case"utf8":case"utf-8":return O(this,de,ye);case"ascii":return G(this,de,ye);case"latin1":case"binary":return K(this,de,ye);case"base64":return R(this,de,ye);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,de,ye);default:if(ge)throw new TypeError("Unknown encoding: "+ce);ce=(ce+"").toLowerCase(),ge=!0}}s.prototype._isBuffer=!0;function b(ce,de,ye){var ge=ce[de];ce[de]=ce[ye],ce[ye]=ge}s.prototype.swap16=function(){var de=this.length;if(de%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var ye=0;ye<de;ye+=2)b(this,ye,ye+1);return this},s.prototype.swap32=function(){var de=this.length;if(de%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var ye=0;ye<de;ye+=4)b(this,ye,ye+3),b(this,ye+1,ye+2);return this},s.prototype.swap64=function(){var de=this.length;if(de%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var ye=0;ye<de;ye+=8)b(this,ye,ye+7),b(this,ye+1,ye+6),b(this,ye+2,ye+5),b(this,ye+3,ye+4);return this},s.prototype.toString=function(){var de=this.length;return de===0?"":arguments.length===0?O(this,0,de):h.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(de){if(!s.isBuffer(de))throw new TypeError("Argument must be a Buffer");return this===de?!0:s.compare(this,de)===0},s.prototype.inspect=function(){var de="",ye=M.INSPECT_MAX_BYTES;return de=this.toString("hex",0,ye).replace(/(.{2})/g,"$1 ").trim(),this.length>ye&&(de+=" ... "),"<Buffer "+de+">"},s.prototype.compare=function(de,ye,ge,me,Ee){if(oe(de,Uint8Array)&&(de=s.from(de,de.offset,de.byteLength)),!s.isBuffer(de))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof de);if(ye===void 0&&(ye=0),ge===void 0&&(ge=de?de.length:0),me===void 0&&(me=0),Ee===void 0&&(Ee=this.length),ye<0||ge>de.length||me<0||Ee>this.length)throw new RangeError("out of range index");if(me>=Ee&&ye>=ge)return 0;if(me>=Ee)return-1;if(ye>=ge)return 1;if(ye>>>=0,ge>>>=0,me>>>=0,Ee>>>=0,this===de)return 0;for(var Pe=Ee-me,Ne=ge-ye,we=Math.min(Pe,Ne),ke=this.slice(me,Ee),Xe=de.slice(ye,ge),He=0;He<we;++He)if(ke[He]!==Xe[He]){Pe=ke[He],Ne=Xe[He];break}return Pe<Ne?-1:Ne<Pe?1:0};function u(ce,de,ye,ge,me){if(ce.length===0)return-1;if(typeof ye=="string"?(ge=ye,ye=0):ye>2147483647?ye=2147483647:ye<-2147483648&&(ye=-2147483648),ye=+ye,be(ye)&&(ye=me?0:ce.length-1),ye<0&&(ye=ce.length+ye),ye>=ce.length){if(me)return-1;ye=ce.length-1}else if(ye<0)if(me)ye=0;else return-1;if(typeof de=="string"&&(de=s.from(de,ge)),s.isBuffer(de))return de.length===0?-1:L(ce,de,ye,ge,me);if(typeof de=="number")return de=de&255,typeof Uint8Array.prototype.indexOf=="function"?me?Uint8Array.prototype.indexOf.call(ce,de,ye):Uint8Array.prototype.lastIndexOf.call(ce,de,ye):L(ce,[de],ye,ge,me);throw new TypeError("val must be string, number or Buffer")}function L(ce,de,ye,ge,me){var Ee=1,Pe=ce.length,Ne=de.length;if(ge!==void 0&&(ge=String(ge).toLowerCase(),ge==="ucs2"||ge==="ucs-2"||ge==="utf16le"||ge==="utf-16le")){if(ce.length<2||de.length<2)return-1;Ee=2,Pe/=2,Ne/=2,ye/=2}function we(De,Ge){return Ee===1?De[Ge]:De.readUInt16BE(Ge*Ee)}var ke;if(me){var Xe=-1;for(ke=ye;ke<Pe;ke++)if(we(ce,ke)===we(de,Xe===-1?0:ke-Xe)){if(Xe===-1&&(Xe=ke),ke-Xe+1===Ne)return Xe*Ee}else Xe!==-1&&(ke-=ke-Xe),Xe=-1}else for(ye+Ne>Pe&&(ye=Pe-Ne),ke=ye;ke>=0;ke--){for(var He=!0,Ie=0;Ie<Ne;Ie++)if(we(ce,ke+Ie)!==we(de,Ie)){He=!1;break}if(He)return ke}return-1}s.prototype.includes=function(de,ye,ge){return this.indexOf(de,ye,ge)!==-1},s.prototype.indexOf=function(de,ye,ge){return u(this,de,ye,ge,!0)},s.prototype.lastIndexOf=function(de,ye,ge){return u(this,de,ye,ge,!1)};function T(ce,de,ye,ge){ye=Number(ye)||0;var me=ce.length-ye;ge?(ge=Number(ge),ge>me&&(ge=me)):ge=me;var Ee=de.length;ge>Ee/2&&(ge=Ee/2);for(var Pe=0;Pe<ge;++Pe){var Ne=parseInt(de.substr(Pe*2,2),16);if(be(Ne))return Pe;ce[ye+Pe]=Ne}return Pe}function k(ce,de,ye,ge){return ae(X(de,ce.length-ye),ce,ye,ge)}function P(ce,de,ye,ge){return ae(Q(de),ce,ye,ge)}function z(ce,de,ye,ge){return P(ce,de,ye,ge)}function I(ce,de,ye,ge){return ae(se(de),ce,ye,ge)}function D(ce,de,ye,ge){return ae(ie(de,ce.length-ye),ce,ye,ge)}s.prototype.write=function(de,ye,ge,me){if(ye===void 0)me="utf8",ge=this.length,ye=0;else if(ge===void 0&&typeof ye=="string")me=ye,ge=this.length,ye=0;else if(isFinite(ye))ye=ye>>>0,isFinite(ge)?(ge=ge>>>0,me===void 0&&(me="utf8")):(me=ge,ge=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Ee=this.length-ye;if((ge===void 0||ge>Ee)&&(ge=Ee),de.length>0&&(ge<0||ye<0)||ye>this.length)throw new RangeError("Attempt to write outside buffer bounds");me||(me="utf8");for(var Pe=!1;;)switch(me){case"hex":return T(this,de,ye,ge);case"utf8":case"utf-8":return k(this,de,ye,ge);case"ascii":return P(this,de,ye,ge);case"latin1":case"binary":return z(this,de,ye,ge);case"base64":return I(this,de,ye,ge);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,de,ye,ge);default:if(Pe)throw new TypeError("Unknown encoding: "+me);me=(""+me).toLowerCase(),Pe=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function R(ce,de,ye){return de===0&&ye===ce.length?a.fromByteArray(ce):a.fromByteArray(ce.slice(de,ye))}function O(ce,de,ye){ye=Math.min(ce.length,ye);for(var ge=[],me=de;me<ye;){var Ee=ce[me],Pe=null,Ne=Ee>239?4:Ee>223?3:Ee>191?2:1;if(me+Ne<=ye){var we,ke,Xe,He;switch(Ne){case 1:Ee<128&&(Pe=Ee);break;case 2:we=ce[me+1],(we&192)===128&&(He=(Ee&31)<<6|we&63,He>127&&(Pe=He));break;case 3:we=ce[me+1],ke=ce[me+2],(we&192)===128&&(ke&192)===128&&(He=(Ee&15)<<12|(we&63)<<6|ke&63,He>2047&&(He<55296||He>57343)&&(Pe=He));break;case 4:we=ce[me+1],ke=ce[me+2],Xe=ce[me+3],(we&192)===128&&(ke&192)===128&&(Xe&192)===128&&(He=(Ee&15)<<18|(we&63)<<12|(ke&63)<<6|Xe&63,He>65535&&He<1114112&&(Pe=He))}}Pe===null?(Pe=65533,Ne=1):Pe>65535&&(Pe-=65536,ge.push(Pe>>>10&1023|55296),Pe=56320|Pe&1023),ge.push(Pe),me+=Ne}return N(ge)}var F=4096;function N(ce){var de=ce.length;if(de<=F)return String.fromCharCode.apply(String,ce);for(var ye="",ge=0;ge<de;)ye+=String.fromCharCode.apply(String,ce.slice(ge,ge+=F));return ye}function G(ce,de,ye){var ge="";ye=Math.min(ce.length,ye);for(var me=de;me<ye;++me)ge+=String.fromCharCode(ce[me]&127);return ge}function K(ce,de,ye){var ge="";ye=Math.min(ce.length,ye);for(var me=de;me<ye;++me)ge+=String.fromCharCode(ce[me]);return ge}function W(ce,de,ye){var ge=ce.length;(!de||de<0)&&(de=0),(!ye||ye<0||ye>ge)&&(ye=ge);for(var me="",Ee=de;Ee<ye;++Ee)me+=ne(ce[Ee]);return me}function Y(ce,de,ye){for(var ge=ce.slice(de,ye),me="",Ee=0;Ee<ge.length;Ee+=2)me+=String.fromCharCode(ge[Ee]+ge[Ee+1]*256);return me}s.prototype.slice=function(de,ye){var ge=this.length;de=~~de,ye=ye===void 0?ge:~~ye,de<0?(de+=ge,de<0&&(de=0)):de>ge&&(de=ge),ye<0?(ye+=ge,ye<0&&(ye=0)):ye>ge&&(ye=ge),ye<de&&(ye=de);var me=this.subarray(de,ye);return me.__proto__=s.prototype,me};function re(ce,de,ye){if(ce%1!==0||ce<0)throw new RangeError("offset is not uint");if(ce+de>ye)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUIntLE=function(de,ye,ge){de=de>>>0,ye=ye>>>0,ge||re(de,ye,this.length);for(var me=this[de],Ee=1,Pe=0;++Pe<ye&&(Ee*=256);)me+=this[de+Pe]*Ee;return me},s.prototype.readUIntBE=function(de,ye,ge){de=de>>>0,ye=ye>>>0,ge||re(de,ye,this.length);for(var me=this[de+--ye],Ee=1;ye>0&&(Ee*=256);)me+=this[de+--ye]*Ee;return me},s.prototype.readUInt8=function(de,ye){return de=de>>>0,ye||re(de,1,this.length),this[de]},s.prototype.readUInt16LE=function(de,ye){return de=de>>>0,ye||re(de,2,this.length),this[de]|this[de+1]<<8},s.prototype.readUInt16BE=function(de,ye){return de=de>>>0,ye||re(de,2,this.length),this[de]<<8|this[de+1]},s.prototype.readUInt32LE=function(de,ye){return de=de>>>0,ye||re(de,4,this.length),(this[de]|this[de+1]<<8|this[de+2]<<16)+this[de+3]*16777216},s.prototype.readUInt32BE=function(de,ye){return de=de>>>0,ye||re(de,4,this.length),this[de]*16777216+(this[de+1]<<16|this[de+2]<<8|this[de+3])},s.prototype.readIntLE=function(de,ye,ge){de=de>>>0,ye=ye>>>0,ge||re(de,ye,this.length);for(var me=this[de],Ee=1,Pe=0;++Pe<ye&&(Ee*=256);)me+=this[de+Pe]*Ee;return Ee*=128,me>=Ee&&(me-=Math.pow(2,8*ye)),me},s.prototype.readIntBE=function(de,ye,ge){de=de>>>0,ye=ye>>>0,ge||re(de,ye,this.length);for(var me=ye,Ee=1,Pe=this[de+--me];me>0&&(Ee*=256);)Pe+=this[de+--me]*Ee;return Ee*=128,Pe>=Ee&&(Pe-=Math.pow(2,8*ye)),Pe},s.prototype.readInt8=function(de,ye){return de=de>>>0,ye||re(de,1,this.length),this[de]&128?(255-this[de]+1)*-1:this[de]},s.prototype.readInt16LE=function(de,ye){de=de>>>0,ye||re(de,2,this.length);var ge=this[de]|this[de+1]<<8;return ge&32768?ge|4294901760:ge},s.prototype.readInt16BE=function(de,ye){de=de>>>0,ye||re(de,2,this.length);var ge=this[de+1]|this[de]<<8;return ge&32768?ge|4294901760:ge},s.prototype.readInt32LE=function(de,ye){return de=de>>>0,ye||re(de,4,this.length),this[de]|this[de+1]<<8|this[de+2]<<16|this[de+3]<<24},s.prototype.readInt32BE=function(de,ye){return de=de>>>0,ye||re(de,4,this.length),this[de]<<24|this[de+1]<<16|this[de+2]<<8|this[de+3]},s.prototype.readFloatLE=function(de,ye){return de=de>>>0,ye||re(de,4,this.length),n.read(this,de,!0,23,4)},s.prototype.readFloatBE=function(de,ye){return de=de>>>0,ye||re(de,4,this.length),n.read(this,de,!1,23,4)},s.prototype.readDoubleLE=function(de,ye){return de=de>>>0,ye||re(de,8,this.length),n.read(this,de,!0,52,8)},s.prototype.readDoubleBE=function(de,ye){return de=de>>>0,ye||re(de,8,this.length),n.read(this,de,!1,52,8)};function ue(ce,de,ye,ge,me,Ee){if(!s.isBuffer(ce))throw new TypeError('"buffer" argument must be a Buffer instance');if(de>me||de<Ee)throw new RangeError('"value" argument is out of bounds');if(ye+ge>ce.length)throw new RangeError("Index out of range")}s.prototype.writeUIntLE=function(de,ye,ge,me){if(de=+de,ye=ye>>>0,ge=ge>>>0,!me){var Ee=Math.pow(2,8*ge)-1;ue(this,de,ye,ge,Ee,0)}var Pe=1,Ne=0;for(this[ye]=de&255;++Ne<ge&&(Pe*=256);)this[ye+Ne]=de/Pe&255;return ye+ge},s.prototype.writeUIntBE=function(de,ye,ge,me){if(de=+de,ye=ye>>>0,ge=ge>>>0,!me){var Ee=Math.pow(2,8*ge)-1;ue(this,de,ye,ge,Ee,0)}var Pe=ge-1,Ne=1;for(this[ye+Pe]=de&255;--Pe>=0&&(Ne*=256);)this[ye+Pe]=de/Ne&255;return ye+ge},s.prototype.writeUInt8=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,1,255,0),this[ye]=de&255,ye+1},s.prototype.writeUInt16LE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,2,65535,0),this[ye]=de&255,this[ye+1]=de>>>8,ye+2},s.prototype.writeUInt16BE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,2,65535,0),this[ye]=de>>>8,this[ye+1]=de&255,ye+2},s.prototype.writeUInt32LE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,4,4294967295,0),this[ye+3]=de>>>24,this[ye+2]=de>>>16,this[ye+1]=de>>>8,this[ye]=de&255,ye+4},s.prototype.writeUInt32BE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,4,4294967295,0),this[ye]=de>>>24,this[ye+1]=de>>>16,this[ye+2]=de>>>8,this[ye+3]=de&255,ye+4},s.prototype.writeIntLE=function(de,ye,ge,me){if(de=+de,ye=ye>>>0,!me){var Ee=Math.pow(2,8*ge-1);ue(this,de,ye,ge,Ee-1,-Ee)}var Pe=0,Ne=1,we=0;for(this[ye]=de&255;++Pe<ge&&(Ne*=256);)de<0&&we===0&&this[ye+Pe-1]!==0&&(we=1),this[ye+Pe]=(de/Ne>>0)-we&255;return ye+ge},s.prototype.writeIntBE=function(de,ye,ge,me){if(de=+de,ye=ye>>>0,!me){var Ee=Math.pow(2,8*ge-1);ue(this,de,ye,ge,Ee-1,-Ee)}var Pe=ge-1,Ne=1,we=0;for(this[ye+Pe]=de&255;--Pe>=0&&(Ne*=256);)de<0&&we===0&&this[ye+Pe+1]!==0&&(we=1),this[ye+Pe]=(de/Ne>>0)-we&255;return ye+ge},s.prototype.writeInt8=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,1,127,-128),de<0&&(de=255+de+1),this[ye]=de&255,ye+1},s.prototype.writeInt16LE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,2,32767,-32768),this[ye]=de&255,this[ye+1]=de>>>8,ye+2},s.prototype.writeInt16BE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,2,32767,-32768),this[ye]=de>>>8,this[ye+1]=de&255,ye+2},s.prototype.writeInt32LE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,4,2147483647,-2147483648),this[ye]=de&255,this[ye+1]=de>>>8,this[ye+2]=de>>>16,this[ye+3]=de>>>24,ye+4},s.prototype.writeInt32BE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,4,2147483647,-2147483648),de<0&&(de=4294967295+de+1),this[ye]=de>>>24,this[ye+1]=de>>>16,this[ye+2]=de>>>8,this[ye+3]=de&255,ye+4};function j(ce,de,ye,ge,me,Ee){if(ye+ge>ce.length)throw new RangeError("Index out of range");if(ye<0)throw new RangeError("Index out of range")}function q(ce,de,ye,ge,me){return de=+de,ye=ye>>>0,me||j(ce,de,ye,4),n.write(ce,de,ye,ge,23,4),ye+4}s.prototype.writeFloatLE=function(de,ye,ge){return q(this,de,ye,!0,ge)},s.prototype.writeFloatBE=function(de,ye,ge){return q(this,de,ye,!1,ge)};function V(ce,de,ye,ge,me){return de=+de,ye=ye>>>0,me||j(ce,de,ye,8),n.write(ce,de,ye,ge,52,8),ye+8}s.prototype.writeDoubleLE=function(de,ye,ge){return V(this,de,ye,!0,ge)},s.prototype.writeDoubleBE=function(de,ye,ge){return V(this,de,ye,!1,ge)},s.prototype.copy=function(de,ye,ge,me){if(!s.isBuffer(de))throw new TypeError("argument should be a Buffer");if(ge||(ge=0),!me&&me!==0&&(me=this.length),ye>=de.length&&(ye=de.length),ye||(ye=0),me>0&&me<ge&&(me=ge),me===ge||de.length===0||this.length===0)return 0;if(ye<0)throw new RangeError("targetStart out of bounds");if(ge<0||ge>=this.length)throw new RangeError("Index out of range");if(me<0)throw new RangeError("sourceEnd out of bounds");me>this.length&&(me=this.length),de.length-ye<me-ge&&(me=de.length-ye+ge);var Ee=me-ge;if(this===de&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(ye,ge,me);else if(this===de&&ge<ye&&ye<me)for(var Pe=Ee-1;Pe>=0;--Pe)de[Pe+ye]=this[Pe+ge];else Uint8Array.prototype.set.call(de,this.subarray(ge,me),ye);return Ee},s.prototype.fill=function(de,ye,ge,me){if(typeof de=="string"){if(typeof ye=="string"?(me=ye,ye=0,ge=this.length):typeof ge=="string"&&(me=ge,ge=this.length),me!==void 0&&typeof me!="string")throw new TypeError("encoding must be a string");if(typeof me=="string"&&!s.isEncoding(me))throw new TypeError("Unknown encoding: "+me);if(de.length===1){var Ee=de.charCodeAt(0);(me==="utf8"&&Ee<128||me==="latin1")&&(de=Ee)}}else typeof de=="number"&&(de=de&255);if(ye<0||this.length<ye||this.length<ge)throw new RangeError("Out of range index");if(ge<=ye)return this;ye=ye>>>0,ge=ge===void 0?this.length:ge>>>0,de||(de=0);var Pe;if(typeof de=="number")for(Pe=ye;Pe<ge;++Pe)this[Pe]=de;else{var Ne=s.isBuffer(de)?de:s.from(de,me),we=Ne.length;if(we===0)throw new TypeError('The value "'+de+'" is invalid for argument "value"');for(Pe=0;Pe<ge-ye;++Pe)this[Pe+ye]=Ne[Pe%we]}return this};var U=/[^+/0-9A-Za-z-_]/g;function $(ce){if(ce=ce.split("=")[0],ce=ce.trim().replace(U,""),ce.length<2)return"";for(;ce.length%4!==0;)ce=ce+"=";return ce}function ne(ce){return ce<16?"0"+ce.toString(16):ce.toString(16)}function X(ce,de){de=de||1/0;for(var ye,ge=ce.length,me=null,Ee=[],Pe=0;Pe<ge;++Pe){if(ye=ce.charCodeAt(Pe),ye>55295&&ye<57344){if(!me){if(ye>56319){(de-=3)>-1&&Ee.push(239,191,189);continue}else if(Pe+1===ge){(de-=3)>-1&&Ee.push(239,191,189);continue}me=ye;continue}if(ye<56320){(de-=3)>-1&&Ee.push(239,191,189),me=ye;continue}ye=(me-55296<<10|ye-56320)+65536}else me&&(de-=3)>-1&&Ee.push(239,191,189);if(me=null,ye<128){if((de-=1)<0)break;Ee.push(ye)}else if(ye<2048){if((de-=2)<0)break;Ee.push(ye>>6|192,ye&63|128)}else if(ye<65536){if((de-=3)<0)break;Ee.push(ye>>12|224,ye>>6&63|128,ye&63|128)}else if(ye<1114112){if((de-=4)<0)break;Ee.push(ye>>18|240,ye>>12&63|128,ye>>6&63|128,ye&63|128)}else throw new Error("Invalid code point")}return Ee}function Q(ce){for(var de=[],ye=0;ye<ce.length;++ye)de.push(ce.charCodeAt(ye)&255);return de}function ie(ce,de){for(var ye,ge,me,Ee=[],Pe=0;Pe<ce.length&&!((de-=2)<0);++Pe)ye=ce.charCodeAt(Pe),ge=ye>>8,me=ye%256,Ee.push(me),Ee.push(ge);return Ee}function se(ce){return a.toByteArray($(ce))}function ae(ce,de,ye,ge){for(var me=0;me<ge&&!(me+ye>=de.length||me>=ce.length);++me)de[me+ye]=ce[me];return me}function oe(ce,de){return ce instanceof de||ce!=null&&ce.constructor!=null&&ce.constructor.name!=null&&ce.constructor.name===de.name}function be(ce){return ce!==ce}}).call(this)}).call(this,g("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(g,S,M){M.read=function(e,a,n,r,t){var c,s,i=t*8-r-1,x=(1<<i)-1,p=x>>1,v=-7,f=n?t-1:0,y=n?-1:1,o=e[a+f];for(f+=y,c=o&(1<<-v)-1,o>>=-v,v+=i;v>0;c=c*256+e[a+f],f+=y,v-=8);for(s=c&(1<<-v)-1,c>>=-v,v+=r;v>0;s=s*256+e[a+f],f+=y,v-=8);if(c===0)c=1-p;else{if(c===x)return s?NaN:(o?-1:1)*(1/0);s=s+Math.pow(2,r),c=c-p}return(o?-1:1)*s*Math.pow(2,c-r)},M.write=function(e,a,n,r,t,c){var s,i,x,p=c*8-t-1,v=(1<<p)-1,f=v>>1,y=t===23?Math.pow(2,-24)-Math.pow(2,-77):0,o=r?0:c-1,m=r?1:-1,l=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(i=isNaN(a)?1:0,s=v):(s=Math.floor(Math.log(a)/Math.LN2),a*(x=Math.pow(2,-s))<1&&(s--,x*=2),s+f>=1?a+=y/x:a+=y*Math.pow(2,1-f),a*x>=2&&(s++,x/=2),s+f>=v?(i=0,s=v):s+f>=1?(i=(a*x-1)*Math.pow(2,t),s=s+f):(i=a*Math.pow(2,f-1)*Math.pow(2,t),s=0));t>=8;e[n+o]=i&255,o+=m,i/=256,t-=8);for(s=s<<t|i,p+=t;p>0;e[n+o]=s&255,o+=m,s/=256,p-=8);e[n+o-m]|=l*128}},{}],5:[function(g,S,M){var e=S.exports={},a,n;function r(){throw new Error("setTimeout has not been defined")}function t(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?a=setTimeout:a=r}catch{a=r}try{typeof clearTimeout=="function"?n=clearTimeout:n=t}catch{n=t}})();function c(l){if(a===setTimeout)return setTimeout(l,0);if((a===r||!a)&&setTimeout)return a=setTimeout,setTimeout(l,0);try{return a(l,0)}catch{try{return a.call(null,l,0)}catch{return a.call(this,l,0)}}}function s(l){if(n===clearTimeout)return clearTimeout(l);if((n===t||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(l);try{return n(l)}catch{try{return n.call(null,l)}catch{return n.call(this,l)}}}var i=[],x=!1,p,v=-1;function f(){!x||!p||(x=!1,p.length?i=p.concat(i):v=-1,i.length&&y())}function y(){if(!x){var l=c(f);x=!0;for(var w=i.length;w;){for(p=i,i=[];++v<w;)p&&p[v].run();v=-1,w=i.length}p=null,x=!1,s(l)}}e.nextTick=function(l){var w=new Array(arguments.length-1);if(arguments.length>1)for(var _=1;_<arguments.length;_++)w[_-1]=arguments[_];i.push(new o(l,w)),i.length===1&&!x&&c(y)};function o(l,w){this.fun=l,this.array=w}o.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={};function m(){}e.on=m,e.addListener=m,e.once=m,e.off=m,e.removeListener=m,e.removeAllListeners=m,e.emit=m,e.prependListener=m,e.prependOnceListener=m,e.listeners=function(l){return[]},e.binding=function(l){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(l){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],6:[function(g,S,M){S.exports={alpha_shape:g("alpha-shape"),convex_hull:g("convex-hull"),delaunay_triangulate:g("delaunay-triangulate"),gl_cone3d:g("gl-cone3d"),gl_error3d:g("gl-error3d"),gl_heatmap2d:g("gl-heatmap2d"),gl_line3d:g("gl-line3d"),gl_mesh3d:g("gl-mesh3d"),gl_plot2d:g("gl-plot2d"),gl_plot3d:g("gl-plot3d"),gl_pointcloud2d:g("gl-pointcloud2d"),gl_scatter3d:g("gl-scatter3d"),gl_select_box:g("gl-select-box"),gl_spikes2d:g("gl-spikes2d"),gl_streamtube3d:g("gl-streamtube3d"),gl_surface3d:g("gl-surface3d"),ndarray:g("ndarray"),ndarray_linear_interpolate:g("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(g,S,M){S.exports=c;var e=g("turntable-camera-controller"),a=g("orbit-camera-controller"),n=g("matrix-camera-controller");function r(s,i){this._controllerNames=Object.keys(s),this._controllerList=this._controllerNames.map(function(x){return s[x]}),this._mode=i,this._active=s[i],this._active||(this._mode="turntable",this._active=s.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var t=r.prototype;t.flush=function(s){for(var i=this._controllerList,x=0;x<i.length;++x)i[x].flush(s)},t.idle=function(s){for(var i=this._controllerList,x=0;x<i.length;++x)i[x].idle(s)},t.lookAt=function(s,i,x,p){for(var v=this._controllerList,f=0;f<v.length;++f)v[f].lookAt(s,i,x,p)},t.rotate=function(s,i,x,p){for(var v=this._controllerList,f=0;f<v.length;++f)v[f].rotate(s,i,x,p)},t.pan=function(s,i,x,p){for(var v=this._controllerList,f=0;f<v.length;++f)v[f].pan(s,i,x,p)},t.translate=function(s,i,x,p){for(var v=this._controllerList,f=0;f<v.length;++f)v[f].translate(s,i,x,p)},t.setMatrix=function(s,i){for(var x=this._controllerList,p=0;p<x.length;++p)x[p].setMatrix(s,i)},t.setDistanceLimits=function(s,i){for(var x=this._controllerList,p=0;p<x.length;++p)x[p].setDistanceLimits(s,i)},t.setDistance=function(s,i){for(var x=this._controllerList,p=0;p<x.length;++p)x[p].setDistance(s,i)},t.recalcMatrix=function(s){this._active.recalcMatrix(s)},t.getDistance=function(s){return this._active.getDistance(s)},t.getDistanceLimits=function(s){return this._active.getDistanceLimits(s)},t.lastT=function(){return this._active.lastT()},t.setMode=function(s){if(s!==this._mode){var i=this._controllerNames.indexOf(s);if(!(i<0)){var x=this._active,p=this._controllerList[i],v=Math.max(x.lastT(),p.lastT());x.recalcMatrix(v),p.setMatrix(v,x.computedMatrix),this._active=p,this._mode=s,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},t.getMode=function(){return this._mode};function c(s){s=s||{};var i=s.eye||[0,0,1],x=s.center||[0,0,0],p=s.up||[0,1,0],v=s.distanceLimits||[0,1/0],f=s.mode||"turntable",y=e(),o=a(),m=n();return y.setDistanceLimits(v[0],v[1]),y.lookAt(0,i,x,p),o.setDistanceLimits(v[0],v[1]),o.lookAt(0,i,x,p),m.setDistanceLimits(v[0],v[1]),m.lookAt(0,i,x,p),new r({turntable:y,orbit:o,matrix:m},f)}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(g,S,M){var e=typeof WeakMap>"u"?g("weak-map"):WeakMap,a=g("gl-buffer"),n=g("gl-vao"),r=new e;function t(c){var s=r.get(c),i=s&&(s._triangleBuffer.handle||s._triangleBuffer.buffer);if(!i||!c.isBuffer(i)){var x=a(c,new Float32Array([-1,-1,-1,4,4,-1]));s=n(c,[{buffer:x,type:c.FLOAT,size:2}]),s._triangleBuffer=x,r.set(c,s)}s.bind(),c.drawArrays(c.TRIANGLES,0,3),s.unbind()}S.exports=t},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(g,S,M){var e=g("pad-left");S.exports=a;function a(n,r,t){r=typeof r=="number"?r:1,t=t||": ";var c=n.split(/\r?\n/),s=String(c.length+r-1).length;return c.map(function(i,x){var p=x+r,v=String(p).length,f=e(p,s-v);return f+t+i}).join(`
`)}},{"pad-left":264}],10:[function(g,S,M){S.exports=n;var e=g("robust-orientation");function a(r,t){for(var c=new Array(t+1),s=0;s<r.length;++s)c[s]=r[s];for(var s=0;s<=r.length;++s){for(var i=r.length;i<=t;++i){for(var x=new Array(t),p=0;p<t;++p)x[p]=Math.pow(i+1-s,p);c[i]=x}var v=e.apply(void 0,c);if(v)return!0}return!1}function n(r){var t=r.length;if(t===0)return[];if(t===1)return[0];for(var c=r[0].length,s=[r[0]],i=[0],x=1;x<t;++x){if(s.push(r[x]),!a(s,c)){s.pop();continue}if(i.push(x),i.length===c+1)return i}return i}},{"robust-orientation":284}],11:[function(g,S,M){S.exports=n;var e=g("delaunay-triangulate"),a=g("circumradius");function n(r,t){return e(t).filter(function(c){for(var s=new Array(c.length),i=0;i<c.length;++i)s[i]=t[c[i]];return a(s)*r<1})}},{circumradius:49,"delaunay-triangulate":63}],12:[function(g,S,M){S.exports=n;var e=g("alpha-complex"),a=g("simplicial-complex-boundary");function n(r,t){return a(e(r,t))}},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(g,S,M){S.exports=function(a){return atob(a)}},{}],14:[function(g,S,M){S.exports=n;var e=g("robust-linear-solve");function a(r){for(var t=0,c=0;c<r.length;++c)t+=r[c];return t}function n(r,t){for(var c=t.length,s=new Array(c+1),i=0;i<c;++i){for(var x=new Array(c+1),p=0;p<=c;++p)x[p]=r[p][i];s[i]=x}s[c]=new Array(c+1);for(var i=0;i<=c;++i)s[c][i]=1;for(var v=new Array(c+1),i=0;i<c;++i)v[i]=t[i];v[c]=1;var f=e(s,v),y=a(f[c+1]);y===0&&(y=1);for(var o=new Array(c+1),i=0;i<=c;++i)o[i]=a(f[i])/y;return o}},{"robust-linear-solve":283}],15:[function(g,S,M){var e=g("./lib/rationalize");S.exports=a;function a(n,r){return e(n[0].mul(r[1]).add(r[0].mul(n[1])),n[1].mul(r[1]))}},{"./lib/rationalize":25}],16:[function(g,S,M){S.exports=e;function e(a,n){return a[0].mul(n[1]).cmp(n[0].mul(a[1]))}},{}],17:[function(g,S,M){var e=g("./lib/rationalize");S.exports=a;function a(n,r){return e(n[0].mul(r[1]),n[1].mul(r[0]))}},{"./lib/rationalize":25}],18:[function(g,S,M){var e=g("./is-rat"),a=g("./lib/is-bn"),n=g("./lib/num-to-bn"),r=g("./lib/str-to-bn"),t=g("./lib/rationalize"),c=g("./div");S.exports=s;function s(i,x){if(e(i))return x?c(i,s(x)):[i[0].clone(),i[1].clone()];var p=0,v,f;if(a(i))v=i.clone();else if(typeof i=="string")v=r(i);else{if(i===0)return[n(0),n(1)];if(i===Math.floor(i))v=n(i);else{for(;i!==Math.floor(i);)i=i*Math.pow(2,256),p-=256;v=n(i)}}if(e(x))v.mul(x[1]),f=x[0].clone();else if(a(x))f=x.clone();else if(typeof x=="string")f=r(x);else if(!x)f=n(1);else if(x===Math.floor(x))f=n(x);else{for(;x!==Math.floor(x);)x=x*Math.pow(2,256),p+=256;f=n(x)}return p>0?v=v.ushln(p):p<0&&(f=f.ushln(-p)),t(v,f)}},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(g,S,M){var e=g("./lib/is-bn");S.exports=a;function a(n){return Array.isArray(n)&&n.length===2&&e(n[0])&&e(n[1])}},{"./lib/is-bn":23}],20:[function(g,S,M){var e=g("bn.js");S.exports=a;function a(n){return n.cmp(new e(0))}},{"bn.js":33}],21:[function(g,S,M){var e=g("./bn-sign");S.exports=a;function a(n){var r=n.length,t=n.words,c=0;if(r===1)c=t[0];else if(r===2)c=t[0]+t[1]*67108864;else for(var s=0;s<r;s++){var i=t[s];c+=i*Math.pow(67108864,s)}return e(n)*c}},{"./bn-sign":20}],22:[function(g,S,M){var e=g("double-bits"),a=g("bit-twiddle").countTrailingZeros;S.exports=n;function n(r){var t=a(e.lo(r));if(t<32)return t;var c=a(e.hi(r));return c>20?52:c+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(g,S,M){g("bn.js"),S.exports=e;function e(a){return a&&typeof a=="object"&&Boolean(a.words)}},{"bn.js":33}],24:[function(g,S,M){var e=g("bn.js"),a=g("double-bits");S.exports=n;function n(r){var t=a.exponent(r);return t<52?new e(r):new e(r*Math.pow(2,52-t)).ushln(t-52)}},{"bn.js":33,"double-bits":64}],25:[function(g,S,M){var e=g("./num-to-bn"),a=g("./bn-sign");S.exports=n;function n(r,t){var c=a(r),s=a(t);if(c===0)return[e(0),e(1)];if(s===0)return[e(0),e(0)];s<0&&(r=r.neg(),t=t.neg());var i=r.gcd(t);return i.cmpn(1)?[r.div(i),t.div(i)]:[r,t]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(g,S,M){var e=g("bn.js");S.exports=a;function a(n){return new e(n)}},{"bn.js":33}],27:[function(g,S,M){var e=g("./lib/rationalize");S.exports=a;function a(n,r){return e(n[0].mul(r[0]),n[1].mul(r[1]))}},{"./lib/rationalize":25}],28:[function(g,S,M){var e=g("./lib/bn-sign");S.exports=a;function a(n){return e(n[0])*e(n[1])}},{"./lib/bn-sign":20}],29:[function(g,S,M){var e=g("./lib/rationalize");S.exports=a;function a(n,r){return e(n[0].mul(r[1]).sub(n[1].mul(r[0])),n[1].mul(r[1]))}},{"./lib/rationalize":25}],30:[function(g,S,M){var e=g("./lib/bn-to-num"),a=g("./lib/ctz");S.exports=n;function n(r){var t=r[0],c=r[1];if(t.cmpn(0)===0)return 0;var s=t.abs().divmod(c.abs()),i=s.div,x=e(i),p=s.mod,v=t.negative!==c.negative?-1:1;if(p.cmpn(0)===0)return v*x;if(x){var f=a(x)+4,y=e(p.ushln(f).divRound(c));return v*(x+y*Math.pow(2,-f))}else{var o=c.bitLength()-p.bitLength()+53,y=e(p.ushln(o).divRound(c));return o<1023?v*y*Math.pow(2,-o):(y*=Math.pow(2,-1023),v*y*Math.pow(2,1023-o))}}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(g,S,M){function e(s,i,x,p,v){for(var f=v+1;p<=v;){var y=p+v>>>1,o=s[y],m=x!==void 0?x(o,i):o-i;m>=0?(f=y,v=y-1):p=y+1}return f}function a(s,i,x,p,v){for(var f=v+1;p<=v;){var y=p+v>>>1,o=s[y],m=x!==void 0?x(o,i):o-i;m>0?(f=y,v=y-1):p=y+1}return f}function n(s,i,x,p,v){for(var f=p-1;p<=v;){var y=p+v>>>1,o=s[y],m=x!==void 0?x(o,i):o-i;m<0?(f=y,p=y+1):v=y-1}return f}function r(s,i,x,p,v){for(var f=p-1;p<=v;){var y=p+v>>>1,o=s[y],m=x!==void 0?x(o,i):o-i;m<=0?(f=y,p=y+1):v=y-1}return f}function t(s,i,x,p,v){for(;p<=v;){var f=p+v>>>1,y=s[f],o=x!==void 0?x(y,i):y-i;if(o===0)return f;o<=0?p=f+1:v=f-1}return-1}function c(s,i,x,p,v,f){return typeof x=="function"?f(s,i,x,p===void 0?0:p|0,v===void 0?s.length-1:v|0):f(s,i,void 0,x===void 0?0:x|0,p===void 0?s.length-1:p|0)}S.exports={ge:function(s,i,x,p,v){return c(s,i,x,p,v,e)},gt:function(s,i,x,p,v){return c(s,i,x,p,v,a)},lt:function(s,i,x,p,v){return c(s,i,x,p,v,n)},le:function(s,i,x,p,v){return c(s,i,x,p,v,r)},eq:function(s,i,x,p,v){return c(s,i,x,p,v,t)}}},{}],32:[function(g,S,M){var e=32;M.INT_BITS=e,M.INT_MAX=2147483647,M.INT_MIN=-1<<e-1,M.sign=function(r){return(r>0)-(r<0)},M.abs=function(r){var t=r>>e-1;return(r^t)-t},M.min=function(r,t){return t^(r^t)&-(r<t)},M.max=function(r,t){return r^(r^t)&-(r<t)},M.isPow2=function(r){return!(r&r-1)&&!!r},M.log2=function(r){var t,c;return t=(r>65535)<<4,r>>>=t,c=(r>255)<<3,r>>>=c,t|=c,c=(r>15)<<2,r>>>=c,t|=c,c=(r>3)<<1,r>>>=c,t|=c,t|r>>1},M.log10=function(r){return r>=1e9?9:r>=1e8?8:r>=1e7?7:r>=1e6?6:r>=1e5?5:r>=1e4?4:r>=1e3?3:r>=100?2:r>=10?1:0},M.popCount=function(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),(r+(r>>>4)&252645135)*16843009>>>24};function a(r){var t=32;return r&=-r,r&&t--,r&65535&&(t-=16),r&16711935&&(t-=8),r&252645135&&(t-=4),r&858993459&&(t-=2),r&1431655765&&(t-=1),t}M.countTrailingZeros=a,M.nextPow2=function(r){return r+=r===0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1},M.prevPow2=function(r){return r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r-(r>>>1)},M.parity=function(r){return r^=r>>>16,r^=r>>>8,r^=r>>>4,r&=15,27030>>>r&1};var n=new Array(256);(function(r){for(var t=0;t<256;++t){var c=t,s=t,i=7;for(c>>>=1;c;c>>>=1)s<<=1,s|=c&1,--i;r[t]=s<<i&255}})(n),M.reverse=function(r){return n[r&255]<<24|n[r>>>8&255]<<16|n[r>>>16&255]<<8|n[r>>>24&255]},M.interleave2=function(r,t){return r&=65535,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t&=65535,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1},M.deinterleave2=function(r,t){return r=r>>>t&1431655765,r=(r|r>>>1)&858993459,r=(r|r>>>2)&252645135,r=(r|r>>>4)&16711935,r=(r|r>>>16)&65535,r<<16>>16},M.interleave3=function(r,t,c){return r&=1023,r=(r|r<<16)&4278190335,r=(r|r<<8)&251719695,r=(r|r<<4)&3272356035,r=(r|r<<2)&1227133513,t&=1023,t=(t|t<<16)&4278190335,t=(t|t<<8)&251719695,t=(t|t<<4)&3272356035,t=(t|t<<2)&1227133513,r|=t<<1,c&=1023,c=(c|c<<16)&4278190335,c=(c|c<<8)&251719695,c=(c|c<<4)&3272356035,c=(c|c<<2)&1227133513,r|c<<2},M.deinterleave3=function(r,t){return r=r>>>t&1227133513,r=(r|r>>>2)&3272356035,r=(r|r>>>4)&251719695,r=(r|r>>>8)&4278190335,r=(r|r>>>16)&1023,r<<22>>22},M.nextCombination=function(r){var t=r|r-1;return t+1|(~t&-~t)-1>>>a(r)+1}},{}],33:[function(g,S,M){(function(e,a){function n(I,D){if(!I)throw new Error(D||"Assertion failed")}function r(I,D){I.super_=D;var R=function(){};R.prototype=D.prototype,I.prototype=new R,I.prototype.constructor=I}function t(I,D,R){if(t.isBN(I))return I;this.negative=0,this.words=null,this.length=0,this.red=null,I!==null&&((D==="le"||D==="be")&&(R=D,D=10),this._init(I||0,D||10,R||"be"))}typeof e=="object"?e.exports=t:a.BN=t,t.BN=t,t.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=g("buffer").Buffer}catch{}t.isBN=function(D){return D instanceof t?!0:D!==null&&typeof D=="object"&&D.constructor.wordSize===t.wordSize&&Array.isArray(D.words)},t.max=function(D,R){return D.cmp(R)>0?D:R},t.min=function(D,R){return D.cmp(R)<0?D:R},t.prototype._init=function(D,R,O){if(typeof D=="number")return this._initNumber(D,R,O);if(typeof D=="object")return this._initArray(D,R,O);R==="hex"&&(R=16),n(R===(R|0)&&R>=2&&R<=36),D=D.toString().replace(/\s+/g,"");var F=0;D[0]==="-"&&(F++,this.negative=1),F<D.length&&(R===16?this._parseHex(D,F,O):(this._parseBase(D,R,F),O==="le"&&this._initArray(this.toArray(),R,O)))},t.prototype._initNumber=function(D,R,O){D<0&&(this.negative=1,D=-D),D<67108864?(this.words=[D&67108863],this.length=1):D<4503599627370496?(this.words=[D&67108863,D/67108864&67108863],this.length=2):(n(D<9007199254740992),this.words=[D&67108863,D/67108864&67108863,1],this.length=3),O==="le"&&this._initArray(this.toArray(),R,O)},t.prototype._initArray=function(D,R,O){if(n(typeof D.length=="number"),D.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(D.length/3),this.words=new Array(this.length);for(var F=0;F<this.length;F++)this.words[F]=0;var N,G,K=0;if(O==="be")for(F=D.length-1,N=0;F>=0;F-=3)G=D[F]|D[F-1]<<8|D[F-2]<<16,this.words[N]|=G<<K&67108863,this.words[N+1]=G>>>26-K&67108863,K+=24,K>=26&&(K-=26,N++);else if(O==="le")for(F=0,N=0;F<D.length;F+=3)G=D[F]|D[F+1]<<8|D[F+2]<<16,this.words[N]|=G<<K&67108863,this.words[N+1]=G>>>26-K&67108863,K+=24,K>=26&&(K-=26,N++);return this.strip()};function s(I,D){var R=I.charCodeAt(D);return R>=65&&R<=70?R-55:R>=97&&R<=102?R-87:R-48&15}function i(I,D,R){var O=s(I,R);return R-1>=D&&(O|=s(I,R-1)<<4),O}t.prototype._parseHex=function(D,R,O){this.length=Math.ceil((D.length-R)/6),this.words=new Array(this.length);for(var F=0;F<this.length;F++)this.words[F]=0;var N=0,G=0,K;if(O==="be")for(F=D.length-1;F>=R;F-=2)K=i(D,R,F)<<N,this.words[G]|=K&67108863,N>=18?(N-=18,G+=1,this.words[G]|=K>>>26):N+=8;else{var W=D.length-R;for(F=W%2===0?R+1:R;F<D.length;F+=2)K=i(D,R,F)<<N,this.words[G]|=K&67108863,N>=18?(N-=18,G+=1,this.words[G]|=K>>>26):N+=8}this.strip()};function x(I,D,R,O){for(var F=0,N=Math.min(I.length,R),G=D;G<N;G++){var K=I.charCodeAt(G)-48;F*=O,K>=49?F+=K-49+10:K>=17?F+=K-17+10:F+=K}return F}t.prototype._parseBase=function(D,R,O){this.words=[0],this.length=1;for(var F=0,N=1;N<=67108863;N*=R)F++;F--,N=N/R|0;for(var G=D.length-O,K=G%F,W=Math.min(G,G-K)+O,Y=0,re=O;re<W;re+=F)Y=x(D,re,re+F,R),this.imuln(N),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y);if(K!==0){var ue=1;for(Y=x(D,re,D.length,R),re=0;re<K;re++)ue*=R;this.imuln(ue),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y)}this.strip()},t.prototype.copy=function(D){D.words=new Array(this.length);for(var R=0;R<this.length;R++)D.words[R]=this.words[R];D.length=this.length,D.negative=this.negative,D.red=this.red},t.prototype.clone=function(){var D=new t(null);return this.copy(D),D},t.prototype._expand=function(D){for(;this.length<D;)this.words[this.length++]=0;return this},t.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},t.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},t.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];t.prototype.toString=function(D,R){D=D||10,R=R|0||1;var O;if(D===16||D==="hex"){O="";for(var F=0,N=0,G=0;G<this.length;G++){var K=this.words[G],W=((K<<F|N)&16777215).toString(16);N=K>>>24-F&16777215,N!==0||G!==this.length-1?O=p[6-W.length]+W+O:O=W+O,F+=2,F>=26&&(F-=26,G--)}for(N!==0&&(O=N.toString(16)+O);O.length%R!==0;)O="0"+O;return this.negative!==0&&(O="-"+O),O}if(D===(D|0)&&D>=2&&D<=36){var Y=v[D],re=f[D];O="";var ue=this.clone();for(ue.negative=0;!ue.isZero();){var j=ue.modn(re).toString(D);ue=ue.idivn(re),ue.isZero()?O=j+O:O=p[Y-j.length]+j+O}for(this.isZero()&&(O="0"+O);O.length%R!==0;)O="0"+O;return this.negative!==0&&(O="-"+O),O}n(!1,"Base should be between 2 and 36")},t.prototype.toNumber=function(){var D=this.words[0];return this.length===2?D+=this.words[1]*67108864:this.length===3&&this.words[2]===1?D+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-D:D},t.prototype.toJSON=function(){return this.toString(16)},t.prototype.toBuffer=function(D,R){return n(typeof c<"u"),this.toArrayLike(c,D,R)},t.prototype.toArray=function(D,R){return this.toArrayLike(Array,D,R)},t.prototype.toArrayLike=function(D,R,O){var F=this.byteLength(),N=O||Math.max(1,F);n(F<=N,"byte array longer than desired length"),n(N>0,"Requested array length <= 0"),this.strip();var G=R==="le",K=new D(N),W,Y,re=this.clone();if(G){for(Y=0;!re.isZero();Y++)W=re.andln(255),re.iushrn(8),K[Y]=W;for(;Y<N;Y++)K[Y]=0}else{for(Y=0;Y<N-F;Y++)K[Y]=0;for(Y=0;!re.isZero();Y++)W=re.andln(255),re.iushrn(8),K[N-Y-1]=W}return K},Math.clz32?t.prototype._countBits=function(D){return 32-Math.clz32(D)}:t.prototype._countBits=function(D){var R=D,O=0;return R>=4096&&(O+=13,R>>>=13),R>=64&&(O+=7,R>>>=7),R>=8&&(O+=4,R>>>=4),R>=2&&(O+=2,R>>>=2),O+R},t.prototype._zeroBits=function(D){if(D===0)return 26;var R=D,O=0;return(R&8191)===0&&(O+=13,R>>>=13),(R&127)===0&&(O+=7,R>>>=7),(R&15)===0&&(O+=4,R>>>=4),(R&3)===0&&(O+=2,R>>>=2),(R&1)===0&&O++,O},t.prototype.bitLength=function(){var D=this.words[this.length-1],R=this._countBits(D);return(this.length-1)*26+R};function y(I){for(var D=new Array(I.bitLength()),R=0;R<D.length;R++){var O=R/26|0,F=R%26;D[R]=(I.words[O]&1<<F)>>>F}return D}t.prototype.zeroBits=function(){if(this.isZero())return 0;for(var D=0,R=0;R<this.length;R++){var O=this._zeroBits(this.words[R]);if(D+=O,O!==26)break}return D},t.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},t.prototype.toTwos=function(D){return this.negative!==0?this.abs().inotn(D).iaddn(1):this.clone()},t.prototype.fromTwos=function(D){return this.testn(D-1)?this.notn(D).iaddn(1).ineg():this.clone()},t.prototype.isNeg=function(){return this.negative!==0},t.prototype.neg=function(){return this.clone().ineg()},t.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},t.prototype.iuor=function(D){for(;this.length<D.length;)this.words[this.length++]=0;for(var R=0;R<D.length;R++)this.words[R]=this.words[R]|D.words[R];return this.strip()},t.prototype.ior=function(D){return n((this.negative|D.negative)===0),this.iuor(D)},t.prototype.or=function(D){return this.length>D.length?this.clone().ior(D):D.clone().ior(this)},t.prototype.uor=function(D){return this.length>D.length?this.clone().iuor(D):D.clone().iuor(this)},t.prototype.iuand=function(D){var R;this.length>D.length?R=D:R=this;for(var O=0;O<R.length;O++)this.words[O]=this.words[O]&D.words[O];return this.length=R.length,this.strip()},t.prototype.iand=function(D){return n((this.negative|D.negative)===0),this.iuand(D)},t.prototype.and=function(D){return this.length>D.length?this.clone().iand(D):D.clone().iand(this)},t.prototype.uand=function(D){return this.length>D.length?this.clone().iuand(D):D.clone().iuand(this)},t.prototype.iuxor=function(D){var R,O;this.length>D.length?(R=this,O=D):(R=D,O=this);for(var F=0;F<O.length;F++)this.words[F]=R.words[F]^O.words[F];if(this!==R)for(;F<R.length;F++)this.words[F]=R.words[F];return this.length=R.length,this.strip()},t.prototype.ixor=function(D){return n((this.negative|D.negative)===0),this.iuxor(D)},t.prototype.xor=function(D){return this.length>D.length?this.clone().ixor(D):D.clone().ixor(this)},t.prototype.uxor=function(D){return this.length>D.length?this.clone().iuxor(D):D.clone().iuxor(this)},t.prototype.inotn=function(D){n(typeof D=="number"&&D>=0);var R=Math.ceil(D/26)|0,O=D%26;this._expand(R),O>0&&R--;for(var F=0;F<R;F++)this.words[F]=~this.words[F]&67108863;return O>0&&(this.words[F]=~this.words[F]&67108863>>26-O),this.strip()},t.prototype.notn=function(D){return this.clone().inotn(D)},t.prototype.setn=function(D,R){n(typeof D=="number"&&D>=0);var O=D/26|0,F=D%26;return this._expand(O+1),R?this.words[O]=this.words[O]|1<<F:this.words[O]=this.words[O]&~(1<<F),this.strip()},t.prototype.iadd=function(D){var R;if(this.negative!==0&&D.negative===0)return this.negative=0,R=this.isub(D),this.negative^=1,this._normSign();if(this.negative===0&&D.negative!==0)return D.negative=0,R=this.isub(D),D.negative=1,R._normSign();var O,F;this.length>D.length?(O=this,F=D):(O=D,F=this);for(var N=0,G=0;G<F.length;G++)R=(O.words[G]|0)+(F.words[G]|0)+N,this.words[G]=R&67108863,N=R>>>26;for(;N!==0&&G<O.length;G++)R=(O.words[G]|0)+N,this.words[G]=R&67108863,N=R>>>26;if(this.length=O.length,N!==0)this.words[this.length]=N,this.length++;else if(O!==this)for(;G<O.length;G++)this.words[G]=O.words[G];return this},t.prototype.add=function(D){var R;return D.negative!==0&&this.negative===0?(D.negative=0,R=this.sub(D),D.negative^=1,R):D.negative===0&&this.negative!==0?(this.negative=0,R=D.sub(this),this.negative=1,R):this.length>D.length?this.clone().iadd(D):D.clone().iadd(this)},t.prototype.isub=function(D){if(D.negative!==0){D.negative=0;var R=this.iadd(D);return D.negative=1,R._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(D),this.negative=1,this._normSign();var O=this.cmp(D);if(O===0)return this.negative=0,this.length=1,this.words[0]=0,this;var F,N;O>0?(F=this,N=D):(F=D,N=this);for(var G=0,K=0;K<N.length;K++)R=(F.words[K]|0)-(N.words[K]|0)+G,G=R>>26,this.words[K]=R&67108863;for(;G!==0&&K<F.length;K++)R=(F.words[K]|0)+G,G=R>>26,this.words[K]=R&67108863;if(G===0&&K<F.length&&F!==this)for(;K<F.length;K++)this.words[K]=F.words[K];return this.length=Math.max(this.length,K),F!==this&&(this.negative=1),this.strip()},t.prototype.sub=function(D){return this.clone().isub(D)};function o(I,D,R){R.negative=D.negative^I.negative;var O=I.length+D.length|0;R.length=O,O=O-1|0;var F=I.words[0]|0,N=D.words[0]|0,G=F*N,K=G&67108863,W=G/67108864|0;R.words[0]=K;for(var Y=1;Y<O;Y++){for(var re=W>>>26,ue=W&67108863,j=Math.min(Y,D.length-1),q=Math.max(0,Y-I.length+1);q<=j;q++){var V=Y-q|0;F=I.words[V]|0,N=D.words[q]|0,G=F*N+ue,re+=G/67108864|0,ue=G&67108863}R.words[Y]=ue|0,W=re|0}return W!==0?R.words[Y]=W|0:R.length--,R.strip()}var m=function(D,R,O){var F=D.words,N=R.words,G=O.words,K=0,W,Y,re,ue=F[0]|0,j=ue&8191,q=ue>>>13,V=F[1]|0,U=V&8191,$=V>>>13,ne=F[2]|0,X=ne&8191,Q=ne>>>13,ie=F[3]|0,se=ie&8191,ae=ie>>>13,oe=F[4]|0,be=oe&8191,ce=oe>>>13,de=F[5]|0,ye=de&8191,ge=de>>>13,me=F[6]|0,Ee=me&8191,Pe=me>>>13,Ne=F[7]|0,we=Ne&8191,ke=Ne>>>13,Xe=F[8]|0,He=Xe&8191,Ie=Xe>>>13,De=F[9]|0,Ge=De&8191,ht=De>>>13,Rt=N[0]|0,Kt=Rt&8191,It=Rt>>>13,Mt=N[1]|0,Yt=Mt&8191,zt=Mt>>>13,St=N[2]|0,Ye=St&8191,rt=St>>>13,Ve=N[3]|0,Ae=Ve&8191,Ue=Ve>>>13,Ze=N[4]|0,Qe=Ze&8191,_t=Ze>>>13,gt=N[5]|0,wt=gt&8191,Ut=gt>>>13,Dt=N[6]|0,Nt=Dt&8191,Xt=Dt>>>13,Ht=N[7]|0,ar=Ht&8191,Vr=Ht>>>13,nn=N[8]|0,jr=nn&8191,at=nn>>>13,$t=N[9]|0,Zt=$t&8191,ur=$t>>>13;O.negative=D.negative^R.negative,O.length=19,W=Math.imul(j,Kt),Y=Math.imul(j,It),Y=Y+Math.imul(q,Kt)|0,re=Math.imul(q,It);var wr=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(wr>>>26)|0,wr&=67108863,W=Math.imul(U,Kt),Y=Math.imul(U,It),Y=Y+Math.imul($,Kt)|0,re=Math.imul($,It),W=W+Math.imul(j,Yt)|0,Y=Y+Math.imul(j,zt)|0,Y=Y+Math.imul(q,Yt)|0,re=re+Math.imul(q,zt)|0;var $e=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+($e>>>26)|0,$e&=67108863,W=Math.imul(X,Kt),Y=Math.imul(X,It),Y=Y+Math.imul(Q,Kt)|0,re=Math.imul(Q,It),W=W+Math.imul(U,Yt)|0,Y=Y+Math.imul(U,zt)|0,Y=Y+Math.imul($,Yt)|0,re=re+Math.imul($,zt)|0,W=W+Math.imul(j,Ye)|0,Y=Y+Math.imul(j,rt)|0,Y=Y+Math.imul(q,Ye)|0,re=re+Math.imul(q,rt)|0;var Je=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(Je>>>26)|0,Je&=67108863,W=Math.imul(se,Kt),Y=Math.imul(se,It),Y=Y+Math.imul(ae,Kt)|0,re=Math.imul(ae,It),W=W+Math.imul(X,Yt)|0,Y=Y+Math.imul(X,zt)|0,Y=Y+Math.imul(Q,Yt)|0,re=re+Math.imul(Q,zt)|0,W=W+Math.imul(U,Ye)|0,Y=Y+Math.imul(U,rt)|0,Y=Y+Math.imul($,Ye)|0,re=re+Math.imul($,rt)|0,W=W+Math.imul(j,Ae)|0,Y=Y+Math.imul(j,Ue)|0,Y=Y+Math.imul(q,Ae)|0,re=re+Math.imul(q,Ue)|0;var it=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(it>>>26)|0,it&=67108863,W=Math.imul(be,Kt),Y=Math.imul(be,It),Y=Y+Math.imul(ce,Kt)|0,re=Math.imul(ce,It),W=W+Math.imul(se,Yt)|0,Y=Y+Math.imul(se,zt)|0,Y=Y+Math.imul(ae,Yt)|0,re=re+Math.imul(ae,zt)|0,W=W+Math.imul(X,Ye)|0,Y=Y+Math.imul(X,rt)|0,Y=Y+Math.imul(Q,Ye)|0,re=re+Math.imul(Q,rt)|0,W=W+Math.imul(U,Ae)|0,Y=Y+Math.imul(U,Ue)|0,Y=Y+Math.imul($,Ae)|0,re=re+Math.imul($,Ue)|0,W=W+Math.imul(j,Qe)|0,Y=Y+Math.imul(j,_t)|0,Y=Y+Math.imul(q,Qe)|0,re=re+Math.imul(q,_t)|0;var lt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(lt>>>26)|0,lt&=67108863,W=Math.imul(ye,Kt),Y=Math.imul(ye,It),Y=Y+Math.imul(ge,Kt)|0,re=Math.imul(ge,It),W=W+Math.imul(be,Yt)|0,Y=Y+Math.imul(be,zt)|0,Y=Y+Math.imul(ce,Yt)|0,re=re+Math.imul(ce,zt)|0,W=W+Math.imul(se,Ye)|0,Y=Y+Math.imul(se,rt)|0,Y=Y+Math.imul(ae,Ye)|0,re=re+Math.imul(ae,rt)|0,W=W+Math.imul(X,Ae)|0,Y=Y+Math.imul(X,Ue)|0,Y=Y+Math.imul(Q,Ae)|0,re=re+Math.imul(Q,Ue)|0,W=W+Math.imul(U,Qe)|0,Y=Y+Math.imul(U,_t)|0,Y=Y+Math.imul($,Qe)|0,re=re+Math.imul($,_t)|0,W=W+Math.imul(j,wt)|0,Y=Y+Math.imul(j,Ut)|0,Y=Y+Math.imul(q,wt)|0,re=re+Math.imul(q,Ut)|0;var Tt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,W=Math.imul(Ee,Kt),Y=Math.imul(Ee,It),Y=Y+Math.imul(Pe,Kt)|0,re=Math.imul(Pe,It),W=W+Math.imul(ye,Yt)|0,Y=Y+Math.imul(ye,zt)|0,Y=Y+Math.imul(ge,Yt)|0,re=re+Math.imul(ge,zt)|0,W=W+Math.imul(be,Ye)|0,Y=Y+Math.imul(be,rt)|0,Y=Y+Math.imul(ce,Ye)|0,re=re+Math.imul(ce,rt)|0,W=W+Math.imul(se,Ae)|0,Y=Y+Math.imul(se,Ue)|0,Y=Y+Math.imul(ae,Ae)|0,re=re+Math.imul(ae,Ue)|0,W=W+Math.imul(X,Qe)|0,Y=Y+Math.imul(X,_t)|0,Y=Y+Math.imul(Q,Qe)|0,re=re+Math.imul(Q,_t)|0,W=W+Math.imul(U,wt)|0,Y=Y+Math.imul(U,Ut)|0,Y=Y+Math.imul($,wt)|0,re=re+Math.imul($,Ut)|0,W=W+Math.imul(j,Nt)|0,Y=Y+Math.imul(j,Xt)|0,Y=Y+Math.imul(q,Nt)|0,re=re+Math.imul(q,Xt)|0;var Bt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,W=Math.imul(we,Kt),Y=Math.imul(we,It),Y=Y+Math.imul(ke,Kt)|0,re=Math.imul(ke,It),W=W+Math.imul(Ee,Yt)|0,Y=Y+Math.imul(Ee,zt)|0,Y=Y+Math.imul(Pe,Yt)|0,re=re+Math.imul(Pe,zt)|0,W=W+Math.imul(ye,Ye)|0,Y=Y+Math.imul(ye,rt)|0,Y=Y+Math.imul(ge,Ye)|0,re=re+Math.imul(ge,rt)|0,W=W+Math.imul(be,Ae)|0,Y=Y+Math.imul(be,Ue)|0,Y=Y+Math.imul(ce,Ae)|0,re=re+Math.imul(ce,Ue)|0,W=W+Math.imul(se,Qe)|0,Y=Y+Math.imul(se,_t)|0,Y=Y+Math.imul(ae,Qe)|0,re=re+Math.imul(ae,_t)|0,W=W+Math.imul(X,wt)|0,Y=Y+Math.imul(X,Ut)|0,Y=Y+Math.imul(Q,wt)|0,re=re+Math.imul(Q,Ut)|0,W=W+Math.imul(U,Nt)|0,Y=Y+Math.imul(U,Xt)|0,Y=Y+Math.imul($,Nt)|0,re=re+Math.imul($,Xt)|0,W=W+Math.imul(j,ar)|0,Y=Y+Math.imul(j,Vr)|0,Y=Y+Math.imul(q,ar)|0,re=re+Math.imul(q,Vr)|0;var Ce=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,W=Math.imul(He,Kt),Y=Math.imul(He,It),Y=Y+Math.imul(Ie,Kt)|0,re=Math.imul(Ie,It),W=W+Math.imul(we,Yt)|0,Y=Y+Math.imul(we,zt)|0,Y=Y+Math.imul(ke,Yt)|0,re=re+Math.imul(ke,zt)|0,W=W+Math.imul(Ee,Ye)|0,Y=Y+Math.imul(Ee,rt)|0,Y=Y+Math.imul(Pe,Ye)|0,re=re+Math.imul(Pe,rt)|0,W=W+Math.imul(ye,Ae)|0,Y=Y+Math.imul(ye,Ue)|0,Y=Y+Math.imul(ge,Ae)|0,re=re+Math.imul(ge,Ue)|0,W=W+Math.imul(be,Qe)|0,Y=Y+Math.imul(be,_t)|0,Y=Y+Math.imul(ce,Qe)|0,re=re+Math.imul(ce,_t)|0,W=W+Math.imul(se,wt)|0,Y=Y+Math.imul(se,Ut)|0,Y=Y+Math.imul(ae,wt)|0,re=re+Math.imul(ae,Ut)|0,W=W+Math.imul(X,Nt)|0,Y=Y+Math.imul(X,Xt)|0,Y=Y+Math.imul(Q,Nt)|0,re=re+Math.imul(Q,Xt)|0,W=W+Math.imul(U,ar)|0,Y=Y+Math.imul(U,Vr)|0,Y=Y+Math.imul($,ar)|0,re=re+Math.imul($,Vr)|0,W=W+Math.imul(j,jr)|0,Y=Y+Math.imul(j,at)|0,Y=Y+Math.imul(q,jr)|0,re=re+Math.imul(q,at)|0;var Me=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(Me>>>26)|0,Me&=67108863,W=Math.imul(Ge,Kt),Y=Math.imul(Ge,It),Y=Y+Math.imul(ht,Kt)|0,re=Math.imul(ht,It),W=W+Math.imul(He,Yt)|0,Y=Y+Math.imul(He,zt)|0,Y=Y+Math.imul(Ie,Yt)|0,re=re+Math.imul(Ie,zt)|0,W=W+Math.imul(we,Ye)|0,Y=Y+Math.imul(we,rt)|0,Y=Y+Math.imul(ke,Ye)|0,re=re+Math.imul(ke,rt)|0,W=W+Math.imul(Ee,Ae)|0,Y=Y+Math.imul(Ee,Ue)|0,Y=Y+Math.imul(Pe,Ae)|0,re=re+Math.imul(Pe,Ue)|0,W=W+Math.imul(ye,Qe)|0,Y=Y+Math.imul(ye,_t)|0,Y=Y+Math.imul(ge,Qe)|0,re=re+Math.imul(ge,_t)|0,W=W+Math.imul(be,wt)|0,Y=Y+Math.imul(be,Ut)|0,Y=Y+Math.imul(ce,wt)|0,re=re+Math.imul(ce,Ut)|0,W=W+Math.imul(se,Nt)|0,Y=Y+Math.imul(se,Xt)|0,Y=Y+Math.imul(ae,Nt)|0,re=re+Math.imul(ae,Xt)|0,W=W+Math.imul(X,ar)|0,Y=Y+Math.imul(X,Vr)|0,Y=Y+Math.imul(Q,ar)|0,re=re+Math.imul(Q,Vr)|0,W=W+Math.imul(U,jr)|0,Y=Y+Math.imul(U,at)|0,Y=Y+Math.imul($,jr)|0,re=re+Math.imul($,at)|0,W=W+Math.imul(j,Zt)|0,Y=Y+Math.imul(j,ur)|0,Y=Y+Math.imul(q,Zt)|0,re=re+Math.imul(q,ur)|0;var nt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(nt>>>26)|0,nt&=67108863,W=Math.imul(Ge,Yt),Y=Math.imul(Ge,zt),Y=Y+Math.imul(ht,Yt)|0,re=Math.imul(ht,zt),W=W+Math.imul(He,Ye)|0,Y=Y+Math.imul(He,rt)|0,Y=Y+Math.imul(Ie,Ye)|0,re=re+Math.imul(Ie,rt)|0,W=W+Math.imul(we,Ae)|0,Y=Y+Math.imul(we,Ue)|0,Y=Y+Math.imul(ke,Ae)|0,re=re+Math.imul(ke,Ue)|0,W=W+Math.imul(Ee,Qe)|0,Y=Y+Math.imul(Ee,_t)|0,Y=Y+Math.imul(Pe,Qe)|0,re=re+Math.imul(Pe,_t)|0,W=W+Math.imul(ye,wt)|0,Y=Y+Math.imul(ye,Ut)|0,Y=Y+Math.imul(ge,wt)|0,re=re+Math.imul(ge,Ut)|0,W=W+Math.imul(be,Nt)|0,Y=Y+Math.imul(be,Xt)|0,Y=Y+Math.imul(ce,Nt)|0,re=re+Math.imul(ce,Xt)|0,W=W+Math.imul(se,ar)|0,Y=Y+Math.imul(se,Vr)|0,Y=Y+Math.imul(ae,ar)|0,re=re+Math.imul(ae,Vr)|0,W=W+Math.imul(X,jr)|0,Y=Y+Math.imul(X,at)|0,Y=Y+Math.imul(Q,jr)|0,re=re+Math.imul(Q,at)|0,W=W+Math.imul(U,Zt)|0,Y=Y+Math.imul(U,ur)|0,Y=Y+Math.imul($,Zt)|0,re=re+Math.imul($,ur)|0;var st=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(st>>>26)|0,st&=67108863,W=Math.imul(Ge,Ye),Y=Math.imul(Ge,rt),Y=Y+Math.imul(ht,Ye)|0,re=Math.imul(ht,rt),W=W+Math.imul(He,Ae)|0,Y=Y+Math.imul(He,Ue)|0,Y=Y+Math.imul(Ie,Ae)|0,re=re+Math.imul(Ie,Ue)|0,W=W+Math.imul(we,Qe)|0,Y=Y+Math.imul(we,_t)|0,Y=Y+Math.imul(ke,Qe)|0,re=re+Math.imul(ke,_t)|0,W=W+Math.imul(Ee,wt)|0,Y=Y+Math.imul(Ee,Ut)|0,Y=Y+Math.imul(Pe,wt)|0,re=re+Math.imul(Pe,Ut)|0,W=W+Math.imul(ye,Nt)|0,Y=Y+Math.imul(ye,Xt)|0,Y=Y+Math.imul(ge,Nt)|0,re=re+Math.imul(ge,Xt)|0,W=W+Math.imul(be,ar)|0,Y=Y+Math.imul(be,Vr)|0,Y=Y+Math.imul(ce,ar)|0,re=re+Math.imul(ce,Vr)|0,W=W+Math.imul(se,jr)|0,Y=Y+Math.imul(se,at)|0,Y=Y+Math.imul(ae,jr)|0,re=re+Math.imul(ae,at)|0,W=W+Math.imul(X,Zt)|0,Y=Y+Math.imul(X,ur)|0,Y=Y+Math.imul(Q,Zt)|0,re=re+Math.imul(Q,ur)|0;var ct=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(ct>>>26)|0,ct&=67108863,W=Math.imul(Ge,Ae),Y=Math.imul(Ge,Ue),Y=Y+Math.imul(ht,Ae)|0,re=Math.imul(ht,Ue),W=W+Math.imul(He,Qe)|0,Y=Y+Math.imul(He,_t)|0,Y=Y+Math.imul(Ie,Qe)|0,re=re+Math.imul(Ie,_t)|0,W=W+Math.imul(we,wt)|0,Y=Y+Math.imul(we,Ut)|0,Y=Y+Math.imul(ke,wt)|0,re=re+Math.imul(ke,Ut)|0,W=W+Math.imul(Ee,Nt)|0,Y=Y+Math.imul(Ee,Xt)|0,Y=Y+Math.imul(Pe,Nt)|0,re=re+Math.imul(Pe,Xt)|0,W=W+Math.imul(ye,ar)|0,Y=Y+Math.imul(ye,Vr)|0,Y=Y+Math.imul(ge,ar)|0,re=re+Math.imul(ge,Vr)|0,W=W+Math.imul(be,jr)|0,Y=Y+Math.imul(be,at)|0,Y=Y+Math.imul(ce,jr)|0,re=re+Math.imul(ce,at)|0,W=W+Math.imul(se,Zt)|0,Y=Y+Math.imul(se,ur)|0,Y=Y+Math.imul(ae,Zt)|0,re=re+Math.imul(ae,ur)|0;var At=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(At>>>26)|0,At&=67108863,W=Math.imul(Ge,Qe),Y=Math.imul(Ge,_t),Y=Y+Math.imul(ht,Qe)|0,re=Math.imul(ht,_t),W=W+Math.imul(He,wt)|0,Y=Y+Math.imul(He,Ut)|0,Y=Y+Math.imul(Ie,wt)|0,re=re+Math.imul(Ie,Ut)|0,W=W+Math.imul(we,Nt)|0,Y=Y+Math.imul(we,Xt)|0,Y=Y+Math.imul(ke,Nt)|0,re=re+Math.imul(ke,Xt)|0,W=W+Math.imul(Ee,ar)|0,Y=Y+Math.imul(Ee,Vr)|0,Y=Y+Math.imul(Pe,ar)|0,re=re+Math.imul(Pe,Vr)|0,W=W+Math.imul(ye,jr)|0,Y=Y+Math.imul(ye,at)|0,Y=Y+Math.imul(ge,jr)|0,re=re+Math.imul(ge,at)|0,W=W+Math.imul(be,Zt)|0,Y=Y+Math.imul(be,ur)|0,Y=Y+Math.imul(ce,Zt)|0,re=re+Math.imul(ce,ur)|0;var dt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(dt>>>26)|0,dt&=67108863,W=Math.imul(Ge,wt),Y=Math.imul(Ge,Ut),Y=Y+Math.imul(ht,wt)|0,re=Math.imul(ht,Ut),W=W+Math.imul(He,Nt)|0,Y=Y+Math.imul(He,Xt)|0,Y=Y+Math.imul(Ie,Nt)|0,re=re+Math.imul(Ie,Xt)|0,W=W+Math.imul(we,ar)|0,Y=Y+Math.imul(we,Vr)|0,Y=Y+Math.imul(ke,ar)|0,re=re+Math.imul(ke,Vr)|0,W=W+Math.imul(Ee,jr)|0,Y=Y+Math.imul(Ee,at)|0,Y=Y+Math.imul(Pe,jr)|0,re=re+Math.imul(Pe,at)|0,W=W+Math.imul(ye,Zt)|0,Y=Y+Math.imul(ye,ur)|0,Y=Y+Math.imul(ge,Zt)|0,re=re+Math.imul(ge,ur)|0;var Ct=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,W=Math.imul(Ge,Nt),Y=Math.imul(Ge,Xt),Y=Y+Math.imul(ht,Nt)|0,re=Math.imul(ht,Xt),W=W+Math.imul(He,ar)|0,Y=Y+Math.imul(He,Vr)|0,Y=Y+Math.imul(Ie,ar)|0,re=re+Math.imul(Ie,Vr)|0,W=W+Math.imul(we,jr)|0,Y=Y+Math.imul(we,at)|0,Y=Y+Math.imul(ke,jr)|0,re=re+Math.imul(ke,at)|0,W=W+Math.imul(Ee,Zt)|0,Y=Y+Math.imul(Ee,ur)|0,Y=Y+Math.imul(Pe,Zt)|0,re=re+Math.imul(Pe,ur)|0;var Gt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,W=Math.imul(Ge,ar),Y=Math.imul(Ge,Vr),Y=Y+Math.imul(ht,ar)|0,re=Math.imul(ht,Vr),W=W+Math.imul(He,jr)|0,Y=Y+Math.imul(He,at)|0,Y=Y+Math.imul(Ie,jr)|0,re=re+Math.imul(Ie,at)|0,W=W+Math.imul(we,Zt)|0,Y=Y+Math.imul(we,ur)|0,Y=Y+Math.imul(ke,Zt)|0,re=re+Math.imul(ke,ur)|0;var rr=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(rr>>>26)|0,rr&=67108863,W=Math.imul(Ge,jr),Y=Math.imul(Ge,at),Y=Y+Math.imul(ht,jr)|0,re=Math.imul(ht,at),W=W+Math.imul(He,Zt)|0,Y=Y+Math.imul(He,ur)|0,Y=Y+Math.imul(Ie,Zt)|0,re=re+Math.imul(Ie,ur)|0;var kr=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(kr>>>26)|0,kr&=67108863,W=Math.imul(Ge,Zt),Y=Math.imul(Ge,ur),Y=Y+Math.imul(ht,Zt)|0,re=Math.imul(ht,ur);var br=(K+W|0)+((Y&8191)<<13)|0;return K=(re+(Y>>>13)|0)+(br>>>26)|0,br&=67108863,G[0]=wr,G[1]=$e,G[2]=Je,G[3]=it,G[4]=lt,G[5]=Tt,G[6]=Bt,G[7]=Ce,G[8]=Me,G[9]=nt,G[10]=st,G[11]=ct,G[12]=At,G[13]=dt,G[14]=Ct,G[15]=Gt,G[16]=rr,G[17]=kr,G[18]=br,K!==0&&(G[19]=K,O.length++),O};Math.imul||(m=o);function l(I,D,R){R.negative=D.negative^I.negative,R.length=I.length+D.length;for(var O=0,F=0,N=0;N<R.length-1;N++){var G=F;F=0;for(var K=O&67108863,W=Math.min(N,D.length-1),Y=Math.max(0,N-I.length+1);Y<=W;Y++){var re=N-Y,ue=I.words[re]|0,j=D.words[Y]|0,q=ue*j,V=q&67108863;G=G+(q/67108864|0)|0,V=V+K|0,K=V&67108863,G=G+(V>>>26)|0,F+=G>>>26,G&=67108863}R.words[N]=K,O=G,G=F}return O!==0?R.words[N]=O:R.length--,R.strip()}function w(I,D,R){var O=new _;return O.mulp(I,D,R)}t.prototype.mulTo=function(D,R){var O,F=this.length+D.length;return this.length===10&&D.length===10?O=m(this,D,R):F<63?O=o(this,D,R):F<1024?O=l(this,D,R):O=w(this,D,R),O};function _(I,D){this.x=I,this.y=D}_.prototype.makeRBT=function(D){for(var R=new Array(D),O=t.prototype._countBits(D)-1,F=0;F<D;F++)R[F]=this.revBin(F,O,D);return R},_.prototype.revBin=function(D,R,O){if(D===0||D===O-1)return D;for(var F=0,N=0;N<R;N++)F|=(D&1)<<R-N-1,D>>=1;return F},_.prototype.permute=function(D,R,O,F,N,G){for(var K=0;K<G;K++)F[K]=R[D[K]],N[K]=O[D[K]]},_.prototype.transform=function(D,R,O,F,N,G){this.permute(G,D,R,O,F,N);for(var K=1;K<N;K<<=1)for(var W=K<<1,Y=Math.cos(2*Math.PI/W),re=Math.sin(2*Math.PI/W),ue=0;ue<N;ue+=W)for(var j=Y,q=re,V=0;V<K;V++){var U=O[ue+V],$=F[ue+V],ne=O[ue+V+K],X=F[ue+V+K],Q=j*ne-q*X;X=j*X+q*ne,ne=Q,O[ue+V]=U+ne,F[ue+V]=$+X,O[ue+V+K]=U-ne,F[ue+V+K]=$-X,V!==W&&(Q=Y*j-re*q,q=Y*q+re*j,j=Q)}},_.prototype.guessLen13b=function(D,R){var O=Math.max(R,D)|1,F=O&1,N=0;for(O=O/2|0;O;O=O>>>1)N++;return 1<<N+1+F},_.prototype.conjugate=function(D,R,O){if(!(O<=1))for(var F=0;F<O/2;F++){var N=D[F];D[F]=D[O-F-1],D[O-F-1]=N,N=R[F],R[F]=-R[O-F-1],R[O-F-1]=-N}},_.prototype.normalize13b=function(D,R){for(var O=0,F=0;F<R/2;F++){var N=Math.round(D[2*F+1]/R)*8192+Math.round(D[2*F]/R)+O;D[F]=N&67108863,N<67108864?O=0:O=N/67108864|0}return D},_.prototype.convert13b=function(D,R,O,F){for(var N=0,G=0;G<R;G++)N=N+(D[G]|0),O[2*G]=N&8191,N=N>>>13,O[2*G+1]=N&8191,N=N>>>13;for(G=2*R;G<F;++G)O[G]=0;n(N===0),n((N&-8192)===0)},_.prototype.stub=function(D){for(var R=new Array(D),O=0;O<D;O++)R[O]=0;return R},_.prototype.mulp=function(D,R,O){var F=2*this.guessLen13b(D.length,R.length),N=this.makeRBT(F),G=this.stub(F),K=new Array(F),W=new Array(F),Y=new Array(F),re=new Array(F),ue=new Array(F),j=new Array(F),q=O.words;q.length=F,this.convert13b(D.words,D.length,K,F),this.convert13b(R.words,R.length,re,F),this.transform(K,G,W,Y,F,N),this.transform(re,G,ue,j,F,N);for(var V=0;V<F;V++){var U=W[V]*ue[V]-Y[V]*j[V];Y[V]=W[V]*j[V]+Y[V]*ue[V],W[V]=U}return this.conjugate(W,Y,F),this.transform(W,Y,q,G,F,N),this.conjugate(q,G,F),this.normalize13b(q,F),O.negative=D.negative^R.negative,O.length=D.length+R.length,O.strip()},t.prototype.mul=function(D){var R=new t(null);return R.words=new Array(this.length+D.length),this.mulTo(D,R)},t.prototype.mulf=function(D){var R=new t(null);return R.words=new Array(this.length+D.length),w(this,D,R)},t.prototype.imul=function(D){return this.clone().mulTo(D,this)},t.prototype.imuln=function(D){n(typeof D=="number"),n(D<67108864);for(var R=0,O=0;O<this.length;O++){var F=(this.words[O]|0)*D,N=(F&67108863)+(R&67108863);R>>=26,R+=F/67108864|0,R+=N>>>26,this.words[O]=N&67108863}return R!==0&&(this.words[O]=R,this.length++),this},t.prototype.muln=function(D){return this.clone().imuln(D)},t.prototype.sqr=function(){return this.mul(this)},t.prototype.isqr=function(){return this.imul(this.clone())},t.prototype.pow=function(D){var R=y(D);if(R.length===0)return new t(1);for(var O=this,F=0;F<R.length&&R[F]===0;F++,O=O.sqr());if(++F<R.length)for(var N=O.sqr();F<R.length;F++,N=N.sqr())R[F]!==0&&(O=O.mul(N));return O},t.prototype.iushln=function(D){n(typeof D=="number"&&D>=0);var R=D%26,O=(D-R)/26,F=67108863>>>26-R<<26-R,N;if(R!==0){var G=0;for(N=0;N<this.length;N++){var K=this.words[N]&F,W=(this.words[N]|0)-K<<R;this.words[N]=W|G,G=K>>>26-R}G&&(this.words[N]=G,this.length++)}if(O!==0){for(N=this.length-1;N>=0;N--)this.words[N+O]=this.words[N];for(N=0;N<O;N++)this.words[N]=0;this.length+=O}return this.strip()},t.prototype.ishln=function(D){return n(this.negative===0),this.iushln(D)},t.prototype.iushrn=function(D,R,O){n(typeof D=="number"&&D>=0);var F;R?F=(R-R%26)/26:F=0;var N=D%26,G=Math.min((D-N)/26,this.length),K=67108863^67108863>>>N<<N,W=O;if(F-=G,F=Math.max(0,F),W){for(var Y=0;Y<G;Y++)W.words[Y]=this.words[Y];W.length=G}if(G!==0)if(this.length>G)for(this.length-=G,Y=0;Y<this.length;Y++)this.words[Y]=this.words[Y+G];else this.words[0]=0,this.length=1;var re=0;for(Y=this.length-1;Y>=0&&(re!==0||Y>=F);Y--){var ue=this.words[Y]|0;this.words[Y]=re<<26-N|ue>>>N,re=ue&K}return W&&re!==0&&(W.words[W.length++]=re),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},t.prototype.ishrn=function(D,R,O){return n(this.negative===0),this.iushrn(D,R,O)},t.prototype.shln=function(D){return this.clone().ishln(D)},t.prototype.ushln=function(D){return this.clone().iushln(D)},t.prototype.shrn=function(D){return this.clone().ishrn(D)},t.prototype.ushrn=function(D){return this.clone().iushrn(D)},t.prototype.testn=function(D){n(typeof D=="number"&&D>=0);var R=D%26,O=(D-R)/26,F=1<<R;if(this.length<=O)return!1;var N=this.words[O];return!!(N&F)},t.prototype.imaskn=function(D){n(typeof D=="number"&&D>=0);var R=D%26,O=(D-R)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=O)return this;if(R!==0&&O++,this.length=Math.min(O,this.length),R!==0){var F=67108863^67108863>>>R<<R;this.words[this.length-1]&=F}return this.strip()},t.prototype.maskn=function(D){return this.clone().imaskn(D)},t.prototype.iaddn=function(D){return n(typeof D=="number"),n(D<67108864),D<0?this.isubn(-D):this.negative!==0?this.length===1&&(this.words[0]|0)<D?(this.words[0]=D-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(D),this.negative=1,this):this._iaddn(D)},t.prototype._iaddn=function(D){this.words[0]+=D;for(var R=0;R<this.length&&this.words[R]>=67108864;R++)this.words[R]-=67108864,R===this.length-1?this.words[R+1]=1:this.words[R+1]++;return this.length=Math.max(this.length,R+1),this},t.prototype.isubn=function(D){if(n(typeof D=="number"),n(D<67108864),D<0)return this.iaddn(-D);if(this.negative!==0)return this.negative=0,this.iaddn(D),this.negative=1,this;if(this.words[0]-=D,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var R=0;R<this.length&&this.words[R]<0;R++)this.words[R]+=67108864,this.words[R+1]-=1;return this.strip()},t.prototype.addn=function(D){return this.clone().iaddn(D)},t.prototype.subn=function(D){return this.clone().isubn(D)},t.prototype.iabs=function(){return this.negative=0,this},t.prototype.abs=function(){return this.clone().iabs()},t.prototype._ishlnsubmul=function(D,R,O){var F=D.length+O,N;this._expand(F);var G,K=0;for(N=0;N<D.length;N++){G=(this.words[N+O]|0)+K;var W=(D.words[N]|0)*R;G-=W&67108863,K=(G>>26)-(W/67108864|0),this.words[N+O]=G&67108863}for(;N<this.length-O;N++)G=(this.words[N+O]|0)+K,K=G>>26,this.words[N+O]=G&67108863;if(K===0)return this.strip();for(n(K===-1),K=0,N=0;N<this.length;N++)G=-(this.words[N]|0)+K,K=G>>26,this.words[N]=G&67108863;return this.negative=1,this.strip()},t.prototype._wordDiv=function(D,R){var O=this.length-D.length,F=this.clone(),N=D,G=N.words[N.length-1]|0,K=this._countBits(G);O=26-K,O!==0&&(N=N.ushln(O),F.iushln(O),G=N.words[N.length-1]|0);var W=F.length-N.length,Y;if(R!=="mod"){Y=new t(null),Y.length=W+1,Y.words=new Array(Y.length);for(var re=0;re<Y.length;re++)Y.words[re]=0}var ue=F.clone()._ishlnsubmul(N,1,W);ue.negative===0&&(F=ue,Y&&(Y.words[W]=1));for(var j=W-1;j>=0;j--){var q=(F.words[N.length+j]|0)*67108864+(F.words[N.length+j-1]|0);for(q=Math.min(q/G|0,67108863),F._ishlnsubmul(N,q,j);F.negative!==0;)q--,F.negative=0,F._ishlnsubmul(N,1,j),F.isZero()||(F.negative^=1);Y&&(Y.words[j]=q)}return Y&&Y.strip(),F.strip(),R!=="div"&&O!==0&&F.iushrn(O),{div:Y||null,mod:F}},t.prototype.divmod=function(D,R,O){if(n(!D.isZero()),this.isZero())return{div:new t(0),mod:new t(0)};var F,N,G;return this.negative!==0&&D.negative===0?(G=this.neg().divmod(D,R),R!=="mod"&&(F=G.div.neg()),R!=="div"&&(N=G.mod.neg(),O&&N.negative!==0&&N.iadd(D)),{div:F,mod:N}):this.negative===0&&D.negative!==0?(G=this.divmod(D.neg(),R),R!=="mod"&&(F=G.div.neg()),{div:F,mod:G.mod}):(this.negative&D.negative)!==0?(G=this.neg().divmod(D.neg(),R),R!=="div"&&(N=G.mod.neg(),O&&N.negative!==0&&N.isub(D)),{div:G.div,mod:N}):D.length>this.length||this.cmp(D)<0?{div:new t(0),mod:this}:D.length===1?R==="div"?{div:this.divn(D.words[0]),mod:null}:R==="mod"?{div:null,mod:new t(this.modn(D.words[0]))}:{div:this.divn(D.words[0]),mod:new t(this.modn(D.words[0]))}:this._wordDiv(D,R)},t.prototype.div=function(D){return this.divmod(D,"div",!1).div},t.prototype.mod=function(D){return this.divmod(D,"mod",!1).mod},t.prototype.umod=function(D){return this.divmod(D,"mod",!0).mod},t.prototype.divRound=function(D){var R=this.divmod(D);if(R.mod.isZero())return R.div;var O=R.div.negative!==0?R.mod.isub(D):R.mod,F=D.ushrn(1),N=D.andln(1),G=O.cmp(F);return G<0||N===1&&G===0?R.div:R.div.negative!==0?R.div.isubn(1):R.div.iaddn(1)},t.prototype.modn=function(D){n(D<=67108863);for(var R=(1<<26)%D,O=0,F=this.length-1;F>=0;F--)O=(R*O+(this.words[F]|0))%D;return O},t.prototype.idivn=function(D){n(D<=67108863);for(var R=0,O=this.length-1;O>=0;O--){var F=(this.words[O]|0)+R*67108864;this.words[O]=F/D|0,R=F%D}return this.strip()},t.prototype.divn=function(D){return this.clone().idivn(D)},t.prototype.egcd=function(D){n(D.negative===0),n(!D.isZero());var R=this,O=D.clone();R.negative!==0?R=R.umod(D):R=R.clone();for(var F=new t(1),N=new t(0),G=new t(0),K=new t(1),W=0;R.isEven()&&O.isEven();)R.iushrn(1),O.iushrn(1),++W;for(var Y=O.clone(),re=R.clone();!R.isZero();){for(var ue=0,j=1;(R.words[0]&j)===0&&ue<26;++ue,j<<=1);if(ue>0)for(R.iushrn(ue);ue-- >0;)(F.isOdd()||N.isOdd())&&(F.iadd(Y),N.isub(re)),F.iushrn(1),N.iushrn(1);for(var q=0,V=1;(O.words[0]&V)===0&&q<26;++q,V<<=1);if(q>0)for(O.iushrn(q);q-- >0;)(G.isOdd()||K.isOdd())&&(G.iadd(Y),K.isub(re)),G.iushrn(1),K.iushrn(1);R.cmp(O)>=0?(R.isub(O),F.isub(G),N.isub(K)):(O.isub(R),G.isub(F),K.isub(N))}return{a:G,b:K,gcd:O.iushln(W)}},t.prototype._invmp=function(D){n(D.negative===0),n(!D.isZero());var R=this,O=D.clone();R.negative!==0?R=R.umod(D):R=R.clone();for(var F=new t(1),N=new t(0),G=O.clone();R.cmpn(1)>0&&O.cmpn(1)>0;){for(var K=0,W=1;(R.words[0]&W)===0&&K<26;++K,W<<=1);if(K>0)for(R.iushrn(K);K-- >0;)F.isOdd()&&F.iadd(G),F.iushrn(1);for(var Y=0,re=1;(O.words[0]&re)===0&&Y<26;++Y,re<<=1);if(Y>0)for(O.iushrn(Y);Y-- >0;)N.isOdd()&&N.iadd(G),N.iushrn(1);R.cmp(O)>=0?(R.isub(O),F.isub(N)):(O.isub(R),N.isub(F))}var ue;return R.cmpn(1)===0?ue=F:ue=N,ue.cmpn(0)<0&&ue.iadd(D),ue},t.prototype.gcd=function(D){if(this.isZero())return D.abs();if(D.isZero())return this.abs();var R=this.clone(),O=D.clone();R.negative=0,O.negative=0;for(var F=0;R.isEven()&&O.isEven();F++)R.iushrn(1),O.iushrn(1);do{for(;R.isEven();)R.iushrn(1);for(;O.isEven();)O.iushrn(1);var N=R.cmp(O);if(N<0){var G=R;R=O,O=G}else if(N===0||O.cmpn(1)===0)break;R.isub(O)}while(!0);return O.iushln(F)},t.prototype.invm=function(D){return this.egcd(D).a.umod(D)},t.prototype.isEven=function(){return(this.words[0]&1)===0},t.prototype.isOdd=function(){return(this.words[0]&1)===1},t.prototype.andln=function(D){return this.words[0]&D},t.prototype.bincn=function(D){n(typeof D=="number");var R=D%26,O=(D-R)/26,F=1<<R;if(this.length<=O)return this._expand(O+1),this.words[O]|=F,this;for(var N=F,G=O;N!==0&&G<this.length;G++){var K=this.words[G]|0;K+=N,N=K>>>26,K&=67108863,this.words[G]=K}return N!==0&&(this.words[G]=N,this.length++),this},t.prototype.isZero=function(){return this.length===1&&this.words[0]===0},t.prototype.cmpn=function(D){var R=D<0;if(this.negative!==0&&!R)return-1;if(this.negative===0&&R)return 1;this.strip();var O;if(this.length>1)O=1;else{R&&(D=-D),n(D<=67108863,"Number is too big");var F=this.words[0]|0;O=F===D?0:F<D?-1:1}return this.negative!==0?-O|0:O},t.prototype.cmp=function(D){if(this.negative!==0&&D.negative===0)return-1;if(this.negative===0&&D.negative!==0)return 1;var R=this.ucmp(D);return this.negative!==0?-R|0:R},t.prototype.ucmp=function(D){if(this.length>D.length)return 1;if(this.length<D.length)return-1;for(var R=0,O=this.length-1;O>=0;O--){var F=this.words[O]|0,N=D.words[O]|0;if(F!==N){F<N?R=-1:F>N&&(R=1);break}}return R},t.prototype.gtn=function(D){return this.cmpn(D)===1},t.prototype.gt=function(D){return this.cmp(D)===1},t.prototype.gten=function(D){return this.cmpn(D)>=0},t.prototype.gte=function(D){return this.cmp(D)>=0},t.prototype.ltn=function(D){return this.cmpn(D)===-1},t.prototype.lt=function(D){return this.cmp(D)===-1},t.prototype.lten=function(D){return this.cmpn(D)<=0},t.prototype.lte=function(D){return this.cmp(D)<=0},t.prototype.eqn=function(D){return this.cmpn(D)===0},t.prototype.eq=function(D){return this.cmp(D)===0},t.red=function(D){return new P(D)},t.prototype.toRed=function(D){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),D.convertTo(this)._forceRed(D)},t.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},t.prototype._forceRed=function(D){return this.red=D,this},t.prototype.forceRed=function(D){return n(!this.red,"Already a number in reduction context"),this._forceRed(D)},t.prototype.redAdd=function(D){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,D)},t.prototype.redIAdd=function(D){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,D)},t.prototype.redSub=function(D){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,D)},t.prototype.redISub=function(D){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,D)},t.prototype.redShl=function(D){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,D)},t.prototype.redMul=function(D){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,D),this.red.mul(this,D)},t.prototype.redIMul=function(D){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,D),this.red.imul(this,D)},t.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},t.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},t.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},t.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},t.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},t.prototype.redPow=function(D){return n(this.red&&!D.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,D)};var h={k256:null,p224:null,p192:null,p25519:null};function b(I,D){this.name=I,this.p=new t(D,16),this.n=this.p.bitLength(),this.k=new t(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}b.prototype._tmp=function(){var D=new t(null);return D.words=new Array(Math.ceil(this.n/13)),D},b.prototype.ireduce=function(D){var R=D,O;do this.split(R,this.tmp),R=this.imulK(R),R=R.iadd(this.tmp),O=R.bitLength();while(O>this.n);var F=O<this.n?-1:R.ucmp(this.p);return F===0?(R.words[0]=0,R.length=1):F>0?R.isub(this.p):R.strip!==void 0?R.strip():R._strip(),R},b.prototype.split=function(D,R){D.iushrn(this.n,0,R)},b.prototype.imulK=function(D){return D.imul(this.k)};function u(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}r(u,b),u.prototype.split=function(D,R){for(var O=4194303,F=Math.min(D.length,9),N=0;N<F;N++)R.words[N]=D.words[N];if(R.length=F,D.length<=9){D.words[0]=0,D.length=1;return}var G=D.words[9];for(R.words[R.length++]=G&O,N=10;N<D.length;N++){var K=D.words[N]|0;D.words[N-10]=(K&O)<<4|G>>>22,G=K}G>>>=22,D.words[N-10]=G,G===0&&D.length>10?D.length-=10:D.length-=9},u.prototype.imulK=function(D){D.words[D.length]=0,D.words[D.length+1]=0,D.length+=2;for(var R=0,O=0;O<D.length;O++){var F=D.words[O]|0;R+=F*977,D.words[O]=R&67108863,R=F*64+(R/67108864|0)}return D.words[D.length-1]===0&&(D.length--,D.words[D.length-1]===0&&D.length--),D};function L(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}r(L,b);function T(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}r(T,b);function k(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}r(k,b),k.prototype.imulK=function(D){for(var R=0,O=0;O<D.length;O++){var F=(D.words[O]|0)*19+R,N=F&67108863;F>>>=26,D.words[O]=N,R=F}return R!==0&&(D.words[D.length++]=R),D},t._prime=function(D){if(h[D])return h[D];var R;if(D==="k256")R=new u;else if(D==="p224")R=new L;else if(D==="p192")R=new T;else if(D==="p25519")R=new k;else throw new Error("Unknown prime "+D);return h[D]=R,R};function P(I){if(typeof I=="string"){var D=t._prime(I);this.m=D.p,this.prime=D}else n(I.gtn(1),"modulus must be greater than 1"),this.m=I,this.prime=null}P.prototype._verify1=function(D){n(D.negative===0,"red works only with positives"),n(D.red,"red works only with red numbers")},P.prototype._verify2=function(D,R){n((D.negative|R.negative)===0,"red works only with positives"),n(D.red&&D.red===R.red,"red works only with red numbers")},P.prototype.imod=function(D){return this.prime?this.prime.ireduce(D)._forceRed(this):D.umod(this.m)._forceRed(this)},P.prototype.neg=function(D){return D.isZero()?D.clone():this.m.sub(D)._forceRed(this)},P.prototype.add=function(D,R){this._verify2(D,R);var O=D.add(R);return O.cmp(this.m)>=0&&O.isub(this.m),O._forceRed(this)},P.prototype.iadd=function(D,R){this._verify2(D,R);var O=D.iadd(R);return O.cmp(this.m)>=0&&O.isub(this.m),O},P.prototype.sub=function(D,R){this._verify2(D,R);var O=D.sub(R);return O.cmpn(0)<0&&O.iadd(this.m),O._forceRed(this)},P.prototype.isub=function(D,R){this._verify2(D,R);var O=D.isub(R);return O.cmpn(0)<0&&O.iadd(this.m),O},P.prototype.shl=function(D,R){return this._verify1(D),this.imod(D.ushln(R))},P.prototype.imul=function(D,R){return this._verify2(D,R),this.imod(D.imul(R))},P.prototype.mul=function(D,R){return this._verify2(D,R),this.imod(D.mul(R))},P.prototype.isqr=function(D){return this.imul(D,D.clone())},P.prototype.sqr=function(D){return this.mul(D,D)},P.prototype.sqrt=function(D){if(D.isZero())return D.clone();var R=this.m.andln(3);if(n(R%2===1),R===3){var O=this.m.add(new t(1)).iushrn(2);return this.pow(D,O)}for(var F=this.m.subn(1),N=0;!F.isZero()&&F.andln(1)===0;)N++,F.iushrn(1);n(!F.isZero());var G=new t(1).toRed(this),K=G.redNeg(),W=this.m.subn(1).iushrn(1),Y=this.m.bitLength();for(Y=new t(2*Y*Y).toRed(this);this.pow(Y,W).cmp(K)!==0;)Y.redIAdd(K);for(var re=this.pow(Y,F),ue=this.pow(D,F.addn(1).iushrn(1)),j=this.pow(D,F),q=N;j.cmp(G)!==0;){for(var V=j,U=0;V.cmp(G)!==0;U++)V=V.redSqr();n(U<q);var $=this.pow(re,new t(1).iushln(q-U-1));ue=ue.redMul($),re=$.redSqr(),j=j.redMul(re),q=U}return ue},P.prototype.invm=function(D){var R=D._invmp(this.m);return R.negative!==0?(R.negative=0,this.imod(R).redNeg()):this.imod(R)},P.prototype.pow=function(D,R){if(R.isZero())return new t(1).toRed(this);if(R.cmpn(1)===0)return D.clone();var O=4,F=new Array(1<<O);F[0]=new t(1).toRed(this),F[1]=D;for(var N=2;N<F.length;N++)F[N]=this.mul(F[N-1],D);var G=F[0],K=0,W=0,Y=R.bitLength()%26;for(Y===0&&(Y=26),N=R.length-1;N>=0;N--){for(var re=R.words[N],ue=Y-1;ue>=0;ue--){var j=re>>ue&1;if(G!==F[0]&&(G=this.sqr(G)),j===0&&K===0){W=0;continue}K<<=1,K|=j,W++,!(W!==O&&(N!==0||ue!==0))&&(G=this.mul(G,F[K]),W=0,K=0)}Y=26}return G},P.prototype.convertTo=function(D){var R=D.umod(this.m);return R===D?R.clone():R},P.prototype.convertFrom=function(D){var R=D.clone();return R.red=null,R},t.mont=function(D){return new z(D)};function z(I){P.call(this,I),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new t(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}r(z,P),z.prototype.convertTo=function(D){return this.imod(D.ushln(this.shift))},z.prototype.convertFrom=function(D){var R=this.imod(D.mul(this.rinv));return R.red=null,R},z.prototype.imul=function(D,R){if(D.isZero()||R.isZero())return D.words[0]=0,D.length=1,D;var O=D.imul(R),F=O.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),N=O.isub(F).iushrn(this.shift),G=N;return N.cmp(this.m)>=0?G=N.isub(this.m):N.cmpn(0)<0&&(G=N.iadd(this.m)),G._forceRed(this)},z.prototype.mul=function(D,R){if(D.isZero()||R.isZero())return new t(0)._forceRed(this);var O=D.mul(R),F=O.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),N=O.isub(F).iushrn(this.shift),G=N;return N.cmp(this.m)>=0?G=N.isub(this.m):N.cmpn(0)<0&&(G=N.iadd(this.m)),G._forceRed(this)},z.prototype.invm=function(D){var R=this.imod(D._invmp(this.m).mul(this.r2));return R._forceRed(this)}})(typeof S>"u"||S,this)},{buffer:2}],34:[function(g,S,M){S.exports=e;function e(a){var n,r,t,c=a.length,s=0;for(n=0;n<c;++n)s+=a[n].length;var i=new Array(s),x=0;for(n=0;n<c;++n){var p=a[n],v=p.length;for(r=0;r<v;++r){var f=i[x++]=new Array(v-1),y=0;for(t=0;t<v;++t)t!==r&&(f[y++]=p[t]);if(r&1){var o=f[1];f[1]=f[0],f[0]=o}}}return i}},{}],35:[function(g,S,M){S.exports=v;var e=g("typedarray-pool"),a=g("./lib/sweep"),n=g("./lib/intersect");function r(f,y){for(var o=0;o<f;++o)if(!(y[o]<=y[o+f]))return!0;return!1}function t(f,y,o,m){for(var l=0,w=0,_=0,h=f.length;_<h;++_){var b=f[_];if(!r(y,b)){for(var u=0;u<2*y;++u)o[l++]=b[u];m[w++]=_}}return w}function c(f,y,o,m){var l=f.length,w=y.length;if(!(l<=0||w<=0)){var _=f[0].length>>>1;if(!(_<=0)){var h,b=e.mallocDouble(2*_*l),u=e.mallocInt32(l);if(l=t(f,_,b,u),l>0){if(_===1&&m)a.init(l),h=a.sweepComplete(_,o,0,l,b,u,0,l,b,u);else{var L=e.mallocDouble(2*_*w),T=e.mallocInt32(w);w=t(y,_,L,T),w>0&&(a.init(l+w),_===1?h=a.sweepBipartite(_,o,0,l,b,u,0,w,L,T):h=n(_,o,m,l,b,u,w,L,T),e.free(L),e.free(T))}e.free(b),e.free(u)}return h}}}var s;function i(f,y){s.push([f,y])}function x(f){return s=[],c(f,f,i,!0),s}function p(f,y){return s=[],c(f,y,i,!1),s}function v(f,y,o){switch(arguments.length){case 1:return x(f);case 2:return typeof y=="function"?c(f,f,y,!0):p(f,y);case 3:return c(f,y,o,!1);default:throw new Error("box-intersect: Invalid arguments")}}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(g,S,M){function e(){function r(s,i,x,p,v,f,y,o,m,l,w){for(var _=2*s,h=p,b=_*p;h<v;++h,b+=_){var u=f[i+b],L=f[i+b+s],T=y[h];e:for(var k=o,P=_*o;k<m;++k,P+=_){var z=l[i+P],I=l[i+P+s],D=w[k];if(!(I<u||L<z)){for(var R=i+1;R<s;++R){var O=f[R+b],F=f[R+s+b],N=l[R+P],G=l[R+s+P];if(F<N||G<O)continue e}var K=x(T,D);if(K!==void 0)return K}}}}function t(s,i,x,p,v,f,y,o,m,l,w){for(var _=2*s,h=o,b=_*o;h<m;++h,b+=_){var u=l[i+b],L=l[i+b+s],T=w[h];e:for(var k=p,P=_*p;k<v;++k,P+=_){var z=f[i+P],I=f[i+P+s],D=y[k];if(!(L<z||I<u)){for(var R=i+1;R<s;++R){var O=f[R+P],F=f[R+s+P],N=l[R+b],G=l[R+s+b];if(F<N||G<O)continue e}var K=x(D,T);if(K!==void 0)return K}}}}function c(s,i,x,p,v,f,y,o,m,l,w){return v-p>m-o?r(s,i,x,p,v,f,y,o,m,l,w):t(s,i,x,p,v,f,y,o,m,l,w)}return c}function a(){function r(x,p,v,f,y,o,m,l,w,_,h){for(var b=2*x,u=f,L=b*f;u<y;++u,L+=b){var T=o[p+L],k=o[p+L+x],P=m[u];e:for(var z=l,I=b*l;z<w;++z,I+=b){var D=_[p+I],R=h[z];if(!(D<=T||k<D)){for(var O=p+1;O<x;++O){var F=o[O+L],N=o[O+x+L],G=_[O+I],K=_[O+x+I];if(N<G||K<F)continue e}var W=v(R,P);if(W!==void 0)return W}}}}function t(x,p,v,f,y,o,m,l,w,_,h){for(var b=2*x,u=f,L=b*f;u<y;++u,L+=b){var T=o[p+L],k=o[p+L+x],P=m[u];e:for(var z=l,I=b*l;z<w;++z,I+=b){var D=_[p+I],R=h[z];if(!(D<T||k<D)){for(var O=p+1;O<x;++O){var F=o[O+L],N=o[O+x+L],G=_[O+I],K=_[O+x+I];if(N<G||K<F)continue e}var W=v(P,R);if(W!==void 0)return W}}}}function c(x,p,v,f,y,o,m,l,w,_,h){for(var b=2*x,u=l,L=b*l;u<w;++u,L+=b){var T=_[p+L],k=h[u];e:for(var P=f,z=b*f;P<y;++P,z+=b){var I=o[p+z],D=o[p+z+x],R=m[P];if(!(T<=I||D<T)){for(var O=p+1;O<x;++O){var F=o[O+z],N=o[O+x+z],G=_[O+L],K=_[O+x+L];if(N<G||K<F)continue e}var W=v(k,R);if(W!==void 0)return W}}}}function s(x,p,v,f,y,o,m,l,w,_,h){for(var b=2*x,u=l,L=b*l;u<w;++u,L+=b){var T=_[p+L],k=h[u];e:for(var P=f,z=b*f;P<y;++P,z+=b){var I=o[p+z],D=o[p+z+x],R=m[P];if(!(T<I||D<T)){for(var O=p+1;O<x;++O){var F=o[O+z],N=o[O+x+z],G=_[O+L],K=_[O+x+L];if(N<G||K<F)continue e}var W=v(R,k);if(W!==void 0)return W}}}}function i(x,p,v,f,y,o,m,l,w,_,h,b){return o-y>_-w?f?r(x,p,v,y,o,m,l,w,_,h,b):t(x,p,v,y,o,m,l,w,_,h,b):f?c(x,p,v,y,o,m,l,w,_,h,b):s(x,p,v,y,o,m,l,w,_,h,b)}return i}function n(r){return r?e():a()}M.partial=n(!1),M.full=n(!0)},{}],37:[function(g,S,M){S.exports=I;var e=g("typedarray-pool"),a=g("bit-twiddle"),n=g("./brute"),r=n.partial,t=n.full,c=g("./sweep"),s=g("./median"),i=g("./partition"),x=128,p=1<<22,v=1<<22,f=i("!(lo>=p0)&&!(p1>=hi)"),y=i("lo===p0"),o=i("lo<p0"),m=i("hi<=p0"),l=i("lo<=p0&&p0<=hi"),w=i("lo<p0&&p0<=hi"),_=6,h=2,b=1024,u=e.mallocInt32(b),L=e.mallocDouble(b);function T(D,R){var O=8*a.log2(R+1)*(D+1)|0,F=a.nextPow2(_*O);u.length<F&&(e.free(u),u=e.mallocInt32(F));var N=a.nextPow2(h*O);L.length<N&&(e.free(L),L=e.mallocDouble(N))}function k(D,R,O,F,N,G,K,W,Y){var re=_*D;u[re]=R,u[re+1]=O,u[re+2]=F,u[re+3]=N,u[re+4]=G,u[re+5]=K;var ue=h*D;L[ue]=W,L[ue+1]=Y}function P(D,R,O,F,N,G,K,W,Y,re,ue){var j=2*D,q=Y*j,V=re[q+R];e:for(var U=N,$=N*j;U<G;++U,$+=j){var ne=K[$+R],X=K[$+R+D];if(!(V<ne||X<V)&&!(F&&V===ne)){for(var Q=W[U],ie=R+1;ie<D;++ie){var ne=K[$+ie],X=K[$+ie+D],se=re[q+ie],ae=re[q+ie+D];if(X<se||ae<ne)continue e}var oe;if(F?oe=O(ue,Q):oe=O(Q,ue),oe!==void 0)return oe}}}function z(D,R,O,F,N,G,K,W,Y,re){var ue=2*D,j=W*ue,q=Y[j+R];e:for(var V=F,U=F*ue;V<N;++V,U+=ue){var $=K[V];if($!==re){var ne=G[U+R],X=G[U+R+D];if(!(q<ne||X<q)){for(var Q=R+1;Q<D;++Q){var ne=G[U+Q],X=G[U+Q+D],ie=Y[j+Q],se=Y[j+Q+D];if(X<ie||se<ne)continue e}var ae=O($,re);if(ae!==void 0)return ae}}}}function I(D,R,O,F,N,G,K,W,Y){T(D,F+K);var re=0,ue=2*D,j;for(k(re++,0,0,F,0,K,O?16:0,-1/0,1/0),O||k(re++,0,0,K,0,F,1,-1/0,1/0);re>0;){re-=1;var q=re*_,V=u[q],U=u[q+1],$=u[q+2],ne=u[q+3],X=u[q+4],Q=u[q+5],ie=re*h,se=L[ie],ae=L[ie+1],oe=Q&1,be=!!(Q&16),ce=N,de=G,ye=W,ge=Y;if(oe&&(ce=W,de=Y,ye=N,ge=G),!(Q&2&&($=o(D,V,U,$,ce,de,ae),U>=$))&&!(Q&4&&(U=m(D,V,U,$,ce,de,se),U>=$))){var me=$-U,Ee=X-ne;if(be){if(D*me*(me+Ee)<v){if(j=c.scanComplete(D,V,R,U,$,ce,de,ne,X,ye,ge),j!==void 0)return j;continue}}else if(D*Math.min(me,Ee)<x){if(j=r(D,V,R,oe,U,$,ce,de,ne,X,ye,ge),j!==void 0)return j;continue}else if(D*me*Ee<p){if(j=c.scanBipartite(D,V,R,oe,U,$,ce,de,ne,X,ye,ge),j!==void 0)return j;continue}var Pe=f(D,V,U,$,ce,de,se,ae);if(U<Pe)if(D*(Pe-U)<x){if(j=t(D,V+1,R,U,Pe,ce,de,ne,X,ye,ge),j!==void 0)return j}else if(V===D-2){if(oe?j=c.sweepBipartite(D,R,ne,X,ye,ge,U,Pe,ce,de):j=c.sweepBipartite(D,R,U,Pe,ce,de,ne,X,ye,ge),j!==void 0)return j}else k(re++,V+1,U,Pe,ne,X,oe,-1/0,1/0),k(re++,V+1,ne,X,U,Pe,oe^1,-1/0,1/0);if(Pe<$){var Ne=s(D,V,ne,X,ye,ge),we=ye[ue*Ne+V],ke=y(D,V,Ne,X,ye,ge,we);if(ke<X&&k(re++,V,Pe,$,ke,X,(oe|4)+(be?16:0),we,ae),ne<Ne&&k(re++,V,Pe,$,ne,Ne,(oe|2)+(be?16:0),se,we),Ne+1===ke){if(be?j=z(D,V,R,Pe,$,ce,de,Ne,ye,ge[Ne]):j=P(D,V,R,oe,Pe,$,ce,de,Ne,ye,ge[Ne]),j!==void 0)return j}else if(Ne<ke){var Xe;if(be){if(Xe=l(D,V,Pe,$,ce,de,we),Pe<Xe){var He=y(D,V,Pe,Xe,ce,de,we);if(V===D-2){if(Pe<He&&(j=c.sweepComplete(D,R,Pe,He,ce,de,Ne,ke,ye,ge),j!==void 0)||He<Xe&&(j=c.sweepBipartite(D,R,He,Xe,ce,de,Ne,ke,ye,ge),j!==void 0))return j}else Pe<He&&k(re++,V+1,Pe,He,Ne,ke,16,-1/0,1/0),He<Xe&&(k(re++,V+1,He,Xe,Ne,ke,0,-1/0,1/0),k(re++,V+1,Ne,ke,He,Xe,1,-1/0,1/0))}}else oe?Xe=w(D,V,Pe,$,ce,de,we):Xe=l(D,V,Pe,$,ce,de,we),Pe<Xe&&(V===D-2?oe?j=c.sweepBipartite(D,R,Ne,ke,ye,ge,Pe,Xe,ce,de):j=c.sweepBipartite(D,R,Pe,Xe,ce,de,Ne,ke,ye,ge):(k(re++,V+1,Pe,Xe,Ne,ke,oe,-1/0,1/0),k(re++,V+1,Ne,ke,Pe,Xe,oe^1,-1/0,1/0)))}}}}}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(g,S,M){S.exports=t;var e=g("./partition"),a=e("lo<p0"),n=8;function r(c,s,i,x,p,v){for(var f=2*c,y=f*(i+1)+s,o=i+1;o<x;++o,y+=f)for(var m=p[y],l=o,w=f*(o-1);l>i&&p[w+s]>m;--l,w-=f){for(var _=w,h=w+f,b=0;b<f;++b,++_,++h){var u=p[_];p[_]=p[h],p[h]=u}var L=v[l];v[l]=v[l-1],v[l-1]=L}}function t(c,s,i,x,p,v){if(x<=i+1)return i;for(var f=i,y=x,o=x+i>>>1,m=2*c,l=o,w=p[m*o+s];f<y;){if(y-f<n){r(c,s,f,y,p,v),w=p[m*o+s];break}var _=y-f,h=Math.random()*_+f|0,b=p[m*h+s],u=Math.random()*_+f|0,L=p[m*u+s],T=Math.random()*_+f|0,k=p[m*T+s];b<=L?k>=L?(l=u,w=L):b>=k?(l=h,w=b):(l=T,w=k):L>=k?(l=u,w=L):k>=b?(l=h,w=b):(l=T,w=k);for(var I=m*(y-1),D=m*l,P=0;P<m;++P,++I,++D){var z=p[I];p[I]=p[D],p[D]=z}var R=v[y-1];v[y-1]=v[l],v[l]=R,l=a(c,s,f,y-1,p,v,w);for(var I=m*(y-1),D=m*l,P=0;P<m;++P,++I,++D){var z=p[I];p[I]=p[D],p[D]=z}var R=v[y-1];if(v[y-1]=v[l],v[l]=R,o<l){for(y=l-1;f<y&&p[m*(y-1)+s]===w;)y-=1;y+=1}else if(l<o)for(f=l+1;f<y&&p[m*f+s]===w;)f+=1;else break}return a(c,s,i,o,p,v,p[m*o+s])}},{"./partition":39}],39:[function(g,S,M){S.exports=a;var e={"lo===p0":n,"lo<p0":r,"lo<=p0":t,"hi<=p0":c,"lo<p0&&p0<=hi":i,"lo<=p0&&p0<=hi":s,"!(lo>=p0)&&!(p1>=hi)":x};function a(p){return e[p]}function n(p,v,f,y,o,m,l){for(var w=2*p,_=w*f,h=_,b=f,u=v,L=p+v,T=f;y>T;++T,_+=w){var k=o[_+u];if(k===l)if(b===T)b+=1,h+=w;else{for(var P=0;w>P;++P){var z=o[_+P];o[_+P]=o[h],o[h++]=z}var I=m[T];m[T]=m[b],m[b++]=I}}return b}function r(p,v,f,y,o,m,l){for(var w=2*p,_=w*f,h=_,b=f,u=v,L=p+v,T=f;y>T;++T,_+=w){var k=o[_+u];if(k<l)if(b===T)b+=1,h+=w;else{for(var P=0;w>P;++P){var z=o[_+P];o[_+P]=o[h],o[h++]=z}var I=m[T];m[T]=m[b],m[b++]=I}}return b}function t(p,v,f,y,o,m,l){for(var w=2*p,_=w*f,h=_,b=f,u=v,L=p+v,T=f;y>T;++T,_+=w){var k=o[_+L];if(k<=l)if(b===T)b+=1,h+=w;else{for(var P=0;w>P;++P){var z=o[_+P];o[_+P]=o[h],o[h++]=z}var I=m[T];m[T]=m[b],m[b++]=I}}return b}function c(p,v,f,y,o,m,l){for(var w=2*p,_=w*f,h=_,b=f,u=v,L=p+v,T=f;y>T;++T,_+=w){var k=o[_+L];if(k<=l)if(b===T)b+=1,h+=w;else{for(var P=0;w>P;++P){var z=o[_+P];o[_+P]=o[h],o[h++]=z}var I=m[T];m[T]=m[b],m[b++]=I}}return b}function s(p,v,f,y,o,m,l){for(var w=2*p,_=w*f,h=_,b=f,u=v,L=p+v,T=f;y>T;++T,_+=w){var k=o[_+u],P=o[_+L];if(k<=l&&l<=P)if(b===T)b+=1,h+=w;else{for(var z=0;w>z;++z){var I=o[_+z];o[_+z]=o[h],o[h++]=I}var D=m[T];m[T]=m[b],m[b++]=D}}return b}function i(p,v,f,y,o,m,l){for(var w=2*p,_=w*f,h=_,b=f,u=v,L=p+v,T=f;y>T;++T,_+=w){var k=o[_+u],P=o[_+L];if(k<l&&l<=P)if(b===T)b+=1,h+=w;else{for(var z=0;w>z;++z){var I=o[_+z];o[_+z]=o[h],o[h++]=I}var D=m[T];m[T]=m[b],m[b++]=D}}return b}function x(p,v,f,y,o,m,l,w){for(var _=2*p,h=_*f,b=h,u=f,L=v,T=p+v,k=f;y>k;++k,h+=_){var P=o[h+L],z=o[h+T];if(!(P>=l)&&!(w>=z))if(u===k)u+=1,b+=_;else{for(var I=0;_>I;++I){var D=o[h+I];o[h+I]=o[b],o[b++]=D}var R=m[k];m[k]=m[u],m[u++]=R}}return u}},{}],40:[function(g,S,M){S.exports=a;var e=32;function a(v,f){f<=4*e?n(0,f-1,v):p(0,f-1,v)}function n(v,f,y){for(var o=2*(v+1),m=v+1;m<=f;++m){for(var l=y[o++],w=y[o++],_=m,h=o-2;_-- >v;){var b=y[h-2],u=y[h-1];if(b<l)break;if(b===l&&u<w)break;y[h]=b,y[h+1]=u,h-=2}y[h]=l,y[h+1]=w}}function r(v,f,y){v*=2,f*=2;var o=y[v],m=y[v+1];y[v]=y[f],y[v+1]=y[f+1],y[f]=o,y[f+1]=m}function t(v,f,y){v*=2,f*=2,y[v]=y[f],y[v+1]=y[f+1]}function c(v,f,y,o){v*=2,f*=2,y*=2;var m=o[v],l=o[v+1];o[v]=o[f],o[v+1]=o[f+1],o[f]=o[y],o[f+1]=o[y+1],o[y]=m,o[y+1]=l}function s(v,f,y,o,m){v*=2,f*=2,m[v]=m[f],m[f]=y,m[v+1]=m[f+1],m[f+1]=o}function i(v,f,y){v*=2,f*=2;var o=y[v],m=y[f];return o<m?!1:o===m?y[v+1]>y[f+1]:!0}function x(v,f,y,o){v*=2;var m=o[v];return m<f?!0:m===f?o[v+1]<y:!1}function p(v,f,y){var o=(f-v+1)/6|0,m=v+o,l=f-o,w=v+f>>1,_=w-o,h=w+o,b=m,u=_,L=w,T=h,k=l,P=v+1,z=f-1,I=0;i(b,u,y)&&(I=b,b=u,u=I),i(T,k,y)&&(I=T,T=k,k=I),i(b,L,y)&&(I=b,b=L,L=I),i(u,L,y)&&(I=u,u=L,L=I),i(b,T,y)&&(I=b,b=T,T=I),i(L,T,y)&&(I=L,L=T,T=I),i(u,k,y)&&(I=u,u=k,k=I),i(u,L,y)&&(I=u,u=L,L=I),i(T,k,y)&&(I=T,T=k,k=I);for(var D=y[2*u],R=y[2*u+1],O=y[2*T],F=y[2*T+1],N=2*b,G=2*L,K=2*k,W=2*m,Y=2*w,re=2*l,ue=0;ue<2;++ue){var j=y[N+ue],q=y[G+ue],V=y[K+ue];y[W+ue]=j,y[Y+ue]=q,y[re+ue]=V}t(_,v,y),t(h,f,y);for(var U=P;U<=z;++U)if(x(U,D,R,y))U!==P&&r(U,P,y),++P;else if(!x(U,O,F,y))for(;;)if(x(z,O,F,y)){x(z,D,R,y)?(c(U,P,z,y),++P,--z):(r(U,z,y),--z);break}else{if(--z<U)break;continue}s(v,P-1,D,R,y),s(f,z+1,O,F,y),P-2-v<=e?n(v,P-2,y):p(v,P-2,y),f-(z+2)<=e?n(z+2,f,y):p(z+2,f,y),z-P<=e?n(P,z,y):p(P,z,y)}},{}],41:[function(g,S,M){S.exports={init:y,sweepBipartite:l,sweepComplete:w,scanBipartite:_,scanComplete:h};var e=g("typedarray-pool"),a=g("bit-twiddle"),n=g("./sort"),r=1<<28,t=1024,c=e.mallocInt32(t),s=e.mallocInt32(t),i=e.mallocInt32(t),x=e.mallocInt32(t),p=e.mallocInt32(t),v=e.mallocInt32(t),f=e.mallocDouble(t*8);function y(b){var u=a.nextPow2(b);c.length<u&&(e.free(c),c=e.mallocInt32(u)),s.length<u&&(e.free(s),s=e.mallocInt32(u)),i.length<u&&(e.free(i),i=e.mallocInt32(u)),x.length<u&&(e.free(x),x=e.mallocInt32(u)),p.length<u&&(e.free(p),p=e.mallocInt32(u)),v.length<u&&(e.free(v),v=e.mallocInt32(u));var L=8*u;f.length<L&&(e.free(f),f=e.mallocDouble(L))}function o(b,u,L,T){var k=u[T],P=b[L-1];b[k]=P,u[P]=k}function m(b,u,L,T){b[L]=T,u[T]=L}function l(b,u,L,T,k,P,z,I,D,R){for(var O=0,F=2*b,N=b-1,G=F-1,K=L;K<T;++K){var W=P[K],Y=F*K;f[O++]=k[Y+N],f[O++]=-(W+1),f[O++]=k[Y+G],f[O++]=W}for(var K=z;K<I;++K){var W=R[K]+r,re=F*K;f[O++]=D[re+N],f[O++]=-W,f[O++]=D[re+G],f[O++]=W}var ue=O>>>1;n(f,ue);for(var j=0,q=0,K=0;K<ue;++K){var V=f[2*K+1]|0;if(V>=r)V=V-r|0,o(i,x,q--,V);else if(V>=0)o(c,s,j--,V);else if(V<=-r){V=-V-r|0;for(var U=0;U<j;++U){var $=u(c[U],V);if($!==void 0)return $}m(i,x,q++,V)}else{V=-V-1|0;for(var U=0;U<q;++U){var $=u(V,i[U]);if($!==void 0)return $}m(c,s,j++,V)}}}function w(b,u,L,T,k,P,z,I,D,R){for(var O=0,F=2*b,N=b-1,G=F-1,K=L;K<T;++K){var W=P[K]+1<<1,Y=F*K;f[O++]=k[Y+N],f[O++]=-W,f[O++]=k[Y+G],f[O++]=W}for(var K=z;K<I;++K){var W=R[K]+1<<1,re=F*K;f[O++]=D[re+N],f[O++]=-W|1,f[O++]=D[re+G],f[O++]=W|1}var ue=O>>>1;n(f,ue);for(var j=0,q=0,V=0,K=0;K<ue;++K){var U=f[2*K+1]|0,$=U&1;if(K<ue-1&&U>>1===f[2*K+3]>>1&&($=2,K+=1),U<0){for(var ne=-(U>>1)-1,X=0;X<V;++X){var Q=u(p[X],ne);if(Q!==void 0)return Q}if($!==0)for(var X=0;X<j;++X){var Q=u(c[X],ne);if(Q!==void 0)return Q}if($!==1)for(var X=0;X<q;++X){var Q=u(i[X],ne);if(Q!==void 0)return Q}$===0?m(c,s,j++,ne):$===1?m(i,x,q++,ne):$===2&&m(p,v,V++,ne)}else{var ne=(U>>1)-1;$===0?o(c,s,j--,ne):$===1?o(i,x,q--,ne):$===2&&o(p,v,V--,ne)}}}function _(b,u,L,T,k,P,z,I,D,R,O,F){var N=0,G=2*b,K=u,W=u+b,Y=1,re=1;T?re=r:Y=r;for(var ue=k;ue<P;++ue){var j=ue+Y,q=G*ue;f[N++]=z[q+K],f[N++]=-j,f[N++]=z[q+W],f[N++]=j}for(var ue=D;ue<R;++ue){var j=ue+re,V=G*ue;f[N++]=O[V+K],f[N++]=-j}var U=N>>>1;n(f,U);for(var $=0,ue=0;ue<U;++ue){var ne=f[2*ue+1]|0;if(ne<0){var j=-ne,X=!1;if(j>=r?(X=!T,j-=r):(X=!!T,j-=1),X)m(c,s,$++,j);else{var Q=F[j],ie=G*j,se=O[ie+u+1],ae=O[ie+u+1+b];e:for(var oe=0;oe<$;++oe){var be=c[oe],ce=G*be;if(!(ae<z[ce+u+1]||z[ce+u+1+b]<se)){for(var de=u+2;de<b;++de)if(O[ie+de+b]<z[ce+de]||z[ce+de+b]<O[ie+de])continue e;var ye=I[be],ge;if(T?ge=L(Q,ye):ge=L(ye,Q),ge!==void 0)return ge}}}}else o(c,s,$--,ne-Y)}}function h(b,u,L,T,k,P,z,I,D,R,O){for(var F=0,N=2*b,G=u,K=u+b,W=T;W<k;++W){var Y=W+r,re=N*W;f[F++]=P[re+G],f[F++]=-Y,f[F++]=P[re+K],f[F++]=Y}for(var W=I;W<D;++W){var Y=W+1,ue=N*W;f[F++]=R[ue+G],f[F++]=-Y}var j=F>>>1;n(f,j);for(var q=0,W=0;W<j;++W){var V=f[2*W+1]|0;if(V<0){var Y=-V;if(Y>=r)c[q++]=Y-r;else{Y-=1;var U=O[Y],$=N*Y,ne=R[$+u+1],X=R[$+u+1+b];e:for(var Q=0;Q<q;++Q){var ie=c[Q],se=z[ie];if(se===U)break;var ae=N*ie;if(!(X<P[ae+u+1]||P[ae+u+1+b]<ne)){for(var oe=u+2;oe<b;++oe)if(R[$+oe+b]<P[ae+oe]||P[ae+oe+b]<R[$+oe])continue e;var be=L(se,U);if(be!==void 0)return be}}}}else{for(var Y=V-r,Q=q-1;Q>=0;--Q)if(c[Q]===Y){for(var oe=Q+1;oe<q;++oe)c[oe-1]=c[oe];break}--q}}}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(g,S,M){var e=g("./lib/monotone"),a=g("./lib/triangulation"),n=g("./lib/delaunay"),r=g("./lib/filter");S.exports=x;function t(p){return[Math.min(p[0],p[1]),Math.max(p[0],p[1])]}function c(p,v){return p[0]-v[0]||p[1]-v[1]}function s(p){return p.map(t).sort(c)}function i(p,v,f){return v in p?p[v]:f}function x(p,v,f){Array.isArray(v)?(f=f||{},v=v||[]):(f=v||{},v=[]);var y=!!i(f,"delaunay",!0),o=!!i(f,"interior",!0),m=!!i(f,"exterior",!0),l=!!i(f,"infinity",!1);if(!o&&!m||p.length===0)return[];var w=e(p,v);if(y||o!==m||l){for(var _=a(p.length,s(v)),h=0;h<w.length;++h){var b=w[h];_.addTriangle(b[0],b[1],b[2])}return y&&n(p,_),m?o?l?r(_,0,l):_.cells():r(_,1,l):r(_,-1)}else return w}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(g,S,M){var e=g("robust-in-sphere")[4];g("binary-search-bounds"),S.exports=n;function a(r,t,c,s,i,x){var p=t.opposite(s,i);if(!(p<0)){if(i<s){var v=s;s=i,i=v,v=x,x=p,p=v}t.isConstraint(s,i)||e(r[s],r[i],r[x],r[p])<0&&c.push(s,i)}}function n(r,t){for(var c=[],s=r.length,i=t.stars,x=0;x<s;++x)for(var p=i[x],v=1;v<p.length;v+=2){var f=p[v];if(!(f<x)&&!t.isConstraint(x,f)){for(var y=p[v-1],o=-1,m=1;m<p.length;m+=2)if(p[m-1]===f){o=p[m];break}o<0||e(r[x],r[f],r[y],r[o])<0&&c.push(x,f)}}for(;c.length>0;){for(var f=c.pop(),x=c.pop(),y=-1,o=-1,p=i[x],l=1;l<p.length;l+=2){var w=p[l-1],_=p[l];w===f?o=_:_===f&&(y=w)}y<0||o<0||e(r[x],r[f],r[y],r[o])>=0||(t.flip(x,f),a(r,t,c,y,x,o),a(r,t,c,x,o,y),a(r,t,c,o,f,y),a(r,t,c,f,y,o))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(g,S,M){var e=g("binary-search-bounds");S.exports=s;function a(i,x,p,v,f,y,o){this.cells=i,this.neighbor=x,this.flags=v,this.constraint=p,this.active=f,this.next=y,this.boundary=o}var n=a.prototype;function r(i,x){return i[0]-x[0]||i[1]-x[1]||i[2]-x[2]}n.locate=function(){var i=[0,0,0];return function(x,p,v){var f=x,y=p,o=v;return p<v?p<x&&(f=p,y=v,o=x):v<x&&(f=v,y=x,o=p),f<0?-1:(i[0]=f,i[1]=y,i[2]=o,e.eq(this.cells,i,r))}}();function t(i,x){for(var p=i.cells(),v=p.length,f=0;f<v;++f){var y=p[f],o=y[0],m=y[1],l=y[2];m<l?m<o&&(y[0]=m,y[1]=l,y[2]=o):l<o&&(y[0]=l,y[1]=o,y[2]=m)}p.sort(r);for(var w=new Array(v),f=0;f<w.length;++f)w[f]=0;var _=[],h=[],b=new Array(3*v),u=new Array(3*v),L=null;x&&(L=[]);for(var T=new a(p,b,u,w,_,h,L),f=0;f<v;++f)for(var y=p[f],k=0;k<3;++k){var o=y[k],m=y[(k+1)%3],P=b[3*f+k]=T.locate(m,o,i.opposite(m,o)),z=u[3*f+k]=i.isConstraint(o,m);P<0&&(z?h.push(f):(_.push(f),w[f]=1),x&&L.push([m,o,-1]))}return T}function c(i,x,p){for(var v=0,f=0;f<i.length;++f)x[f]===p&&(i[v++]=i[f]);return i.length=v,i}function s(i,x,p){var v=t(i,p);if(x===0)return p?v.cells.concat(v.boundary):v.cells;for(var f=1,y=v.active,o=v.next,m=v.flags,l=v.cells,w=v.constraint,_=v.neighbor;y.length>0||o.length>0;){for(;y.length>0;){var h=y.pop();if(m[h]!==-f){m[h]=f,l[h];for(var b=0;b<3;++b){var u=_[3*h+b];u>=0&&m[u]===0&&(w[3*h+b]?o.push(u):(y.push(u),m[u]=f))}}}var L=o;o=y,y=L,o.length=0,f=-f}var T=c(l,m,x);return p?T.concat(v.boundary):T}},{"binary-search-bounds":31}],45:[function(g,S,M){var e=g("binary-search-bounds"),a=g("robust-orientation")[3],n=0,r=1,t=2;S.exports=o;function c(m,l,w,_,h){this.a=m,this.b=l,this.idx=w,this.lowerIds=_,this.upperIds=h}function s(m,l,w,_){this.a=m,this.b=l,this.type=w,this.idx=_}function i(m,l){var w=m.a[0]-l.a[0]||m.a[1]-l.a[1]||m.type-l.type;return w||m.type!==n&&(w=a(m.a,m.b,l.b),w)?w:m.idx-l.idx}function x(m,l){return a(m.a,m.b,l)}function p(m,l,w,_,h){for(var b=e.lt(l,_,x),u=e.gt(l,_,x),L=b;L<u;++L){for(var T=l[L],k=T.lowerIds,z=k.length;z>1&&a(w[k[z-2]],w[k[z-1]],_)>0;)m.push([k[z-1],k[z-2],h]),z-=1;k.length=z,k.push(h);for(var P=T.upperIds,z=P.length;z>1&&a(w[P[z-2]],w[P[z-1]],_)<0;)m.push([P[z-2],P[z-1],h]),z-=1;P.length=z,P.push(h)}}function v(m,l){var w;return m.a[0]<l.a[0]?w=a(m.a,m.b,l.a):w=a(l.b,l.a,m.a),w||(l.b[0]<m.b[0]?w=a(m.a,m.b,l.b):w=a(l.b,l.a,m.b),w||m.idx-l.idx)}function f(m,l,w){var _=e.le(m,w,v),h=m[_],b=h.upperIds,u=b[b.length-1];h.upperIds=[u],m.splice(_+1,0,new c(w.a,w.b,w.idx,[u],b))}function y(m,l,w){var _=w.a;w.a=w.b,w.b=_;var h=e.eq(m,w,v),b=m[h],u=m[h-1];u.upperIds=b.upperIds,m.splice(h,1)}function o(m,l){for(var w=m.length,_=l.length,h=[],b=0;b<w;++b)h.push(new s(m[b],null,n,b));for(var b=0;b<_;++b){var u=l[b],L=m[u[0]],T=m[u[1]];L[0]<T[0]?h.push(new s(L,T,t,b),new s(T,L,r,b)):L[0]>T[0]&&h.push(new s(T,L,t,b),new s(L,T,r,b))}h.sort(i);for(var k=h[0].a[0]-(1+Math.abs(h[0].a[0]))*Math.pow(2,-52),P=[new c([k,1],[k,0],-1,[],[])],z=[],b=0,I=h.length;b<I;++b){var D=h[b],R=D.type;R===n?p(z,P,m,D.a,D.idx):R===t?f(P,m,D):y(P,m,D)}return z}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(g,S,M){var e=g("binary-search-bounds");S.exports=t;function a(c,s){this.stars=c,this.edges=s}var n=a.prototype;function r(c,s,i){for(var x=1,p=c.length;x<p;x+=2)if(c[x-1]===s&&c[x]===i){c[x-1]=c[p-2],c[x]=c[p-1],c.length=p-2;return}}n.isConstraint=function(){var c=[0,0];function s(i,x){return i[0]-x[0]||i[1]-x[1]}return function(i,x){return c[0]=Math.min(i,x),c[1]=Math.max(i,x),e.eq(this.edges,c,s)>=0}}(),n.removeTriangle=function(c,s,i){var x=this.stars;r(x[c],s,i),r(x[s],i,c),r(x[i],c,s)},n.addTriangle=function(c,s,i){var x=this.stars;x[c].push(s,i),x[s].push(i,c),x[i].push(c,s)},n.opposite=function(c,s){for(var i=this.stars[s],x=1,p=i.length;x<p;x+=2)if(i[x]===c)return i[x-1];return-1},n.flip=function(c,s){var i=this.opposite(c,s),x=this.opposite(s,c);this.removeTriangle(c,s,i),this.removeTriangle(s,c,x),this.addTriangle(c,x,i),this.addTriangle(s,i,x)},n.edges=function(){for(var c=this.stars,s=[],i=0,x=c.length;i<x;++i)for(var p=c[i],v=0,f=p.length;v<f;v+=2)s.push([p[v],p[v+1]]);return s},n.cells=function(){for(var c=this.stars,s=[],i=0,x=c.length;i<x;++i)for(var p=c[i],v=0,f=p.length;v<f;v+=2){var y=p[v],o=p[v+1];i<Math.min(y,o)&&s.push([i,y,o])}return s};function t(c,s){for(var i=new Array(c),x=0;x<c;++x)i[x]=[];return new a(i,s)}},{"binary-search-bounds":31}],47:[function(g,S,M){S.exports=e;function e(a){for(var n=1,r=1;r<a.length;++r)for(var t=0;t<r;++t)if(a[r]<a[t])n=-n;else if(a[t]===a[r])return 0;return n}},{}],48:[function(g,S,M){var e=g("dup"),a=g("robust-linear-solve");function n(c,s){for(var i=0,x=c.length,p=0;p<x;++p)i+=c[p]*s[p];return i}function r(c){var s=c.length;if(s===0)return[];c[0].length;var i=e([c.length+1,c.length+1],1),x=e([c.length+1],1);i[s][s]=0;for(var p=0;p<s;++p){for(var v=0;v<=p;++v)i[v][p]=i[p][v]=2*n(c[p],c[v]);x[p]=n(c[p],c[p])}for(var f=a(i,x),y=0,o=f[s+1],p=0;p<o.length;++p)y+=o[p];for(var m=new Array(s),p=0;p<s;++p){for(var o=f[p],l=0,v=0;v<o.length;++v)l+=o[v];m[p]=l/y}return m}function t(c){if(c.length===0)return[];for(var s=c[0].length,i=e([s]),x=r(c),p=0;p<c.length;++p)for(var v=0;v<s;++v)i[v]+=c[p][v]*x[p];return i}t.barycenetric=r,S.exports=t},{dup:65,"robust-linear-solve":283}],49:[function(g,S,M){S.exports=a;var e=g("circumcenter");function a(n){for(var r=e(n),t=0,c=0;c<n.length;++c)for(var s=n[c],i=0;i<r.length;++i)t+=Math.pow(s[i]-r[i],2);return Math.sqrt(t/n.length)}},{circumcenter:48}],50:[function(g,S,M){S.exports=L;var e=g("union-find"),a=g("box-intersect"),n=g("robust-segment-intersect"),r=g("big-rat"),t=g("big-rat/cmp"),c=g("big-rat/to-float"),s=g("rat-vec"),i=g("nextafter"),x=g("./lib/rat-seg-intersect");function p(T){var k=c(T);return[i(k,-1/0),i(k,1/0)]}function v(T,k){for(var P=new Array(k.length),z=0;z<k.length;++z){var I=k[z],D=T[I[0]],R=T[I[1]];P[z]=[i(Math.min(D[0],R[0]),-1/0),i(Math.min(D[1],R[1]),-1/0),i(Math.max(D[0],R[0]),1/0),i(Math.max(D[1],R[1]),1/0)]}return P}function f(T){for(var k=new Array(T.length),P=0;P<T.length;++P){var z=T[P];k[P]=[i(z[0],-1/0),i(z[1],-1/0),i(z[0],1/0),i(z[1],1/0)]}return k}function y(T,k,P){var z=[];return a(P,function(I,D){var R=k[I],O=k[D];if(!(R[0]===O[0]||R[0]===O[1]||R[1]===O[0]||R[1]===O[1])){var F=T[R[0]],N=T[R[1]],G=T[O[0]],K=T[O[1]];n(F,N,G,K)&&z.push([I,D])}}),z}function o(T,k,P,z){var I=[];return a(P,z,function(D,R){var O=k[D];if(!(O[0]===R||O[1]===R)){var F=T[R],N=T[O[0]],G=T[O[1]];n(N,G,F,F)&&I.push([D,R])}}),I}function m(T,k,P,z,I){var D,R,O=T.map(function(ie){return[r(ie[0]),r(ie[1])]});for(D=0;D<P.length;++D){var F=P[D];R=F[0];var N=F[1],G=k[R],K=k[N],W=x(s(T[G[0]]),s(T[G[1]]),s(T[K[0]]),s(T[K[1]]));if(!!W){var Y=T.length;T.push([c(W[0]),c(W[1])]),O.push(W),z.push([R,Y],[N,Y])}}for(z.sort(function(ie,se){if(ie[0]!==se[0])return ie[0]-se[0];var ae=O[ie[1]],oe=O[se[1]];return t(ae[0],oe[0])||t(ae[1],oe[1])}),D=z.length-1;D>=0;--D){var re=z[D];R=re[0];var ue=k[R],j=ue[0],q=ue[1],V=T[j],U=T[q];if((V[0]-U[0]||V[1]-U[1])<0){var $=j;j=q,q=$}ue[0]=j;var ne=ue[1]=re[1],X;for(I&&(X=ue[2]);D>0&&z[D-1][0]===R;){var re=z[--D],Q=re[1];I?k.push([ne,Q,X]):k.push([ne,Q]),ne=Q}I?k.push([ne,q,X]):k.push([ne,q])}return O}function l(T,k,P){for(var z=k.length,I=new e(z),D=[],R=0;R<k.length;++R){var O=k[R],F=p(O[0]),N=p(O[1]);D.push([i(F[0],-1/0),i(N[0],-1/0),i(F[1],1/0),i(N[1],1/0)])}a(D,function(re,ue){I.link(re,ue)});for(var G=!0,K=new Array(z),R=0;R<z;++R){var W=I.find(R);W!==R&&(G=!1,T[W]=[Math.min(T[R][0],T[W][0]),Math.min(T[R][1],T[W][1])])}if(G)return null;for(var Y=0,R=0;R<z;++R){var W=I.find(R);W===R?(K[R]=Y,T[Y++]=T[R]):K[R]=-1}T.length=Y;for(var R=0;R<z;++R)K[R]<0&&(K[R]=K[I.find(R)]);return K}function w(T,k){return T[0]-k[0]||T[1]-k[1]}function _(T,k){var P=T[0]-k[0]||T[1]-k[1];return P||(T[2]<k[2]?-1:T[2]>k[2]?1:0)}function h(T,k,P){if(T.length!==0){if(k)for(var z=0;z<T.length;++z){var I=T[z],D=k[I[0]],R=k[I[1]];I[0]=Math.min(D,R),I[1]=Math.max(D,R)}else for(var z=0;z<T.length;++z){var I=T[z],D=I[0],R=I[1];I[0]=Math.min(D,R),I[1]=Math.max(D,R)}P?T.sort(_):T.sort(w);for(var O=1,z=1;z<T.length;++z){var F=T[z-1],N=T[z];N[0]===F[0]&&N[1]===F[1]&&(!P||N[2]===F[2])||(T[O++]=N)}T.length=O}}function b(T,k,P){var z=l(T,[],f(T));return h(k,z,P),!!z}function u(T,k,P){var z=v(T,k),I=y(T,k,z),D=f(T),R=o(T,k,z,D),O=m(T,k,I,R,P),F=l(T,O);return h(k,F,P),F?!0:I.length>0||R.length>0}function L(T,k,P){var z;if(P){z=k;for(var I=new Array(k.length),D=0;D<k.length;++D){var R=k[D];I[D]=[R[0],R[1],P[D]]}k=I}for(var O=b(T,k,!!P);u(T,k,!!P);)O=!0;if(!!P&&O){z.length=0,P.length=0;for(var D=0;D<k.length;++D){var R=k[D];z.push([R[0],R[1]]),P.push(R[2])}}return O}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(g,S,M){S.exports=x;var e=g("big-rat/mul"),a=g("big-rat/div"),n=g("big-rat/sub"),r=g("big-rat/sign"),t=g("rat-vec/sub"),c=g("rat-vec/add"),s=g("rat-vec/muls");function i(p,v){return n(e(p[0],v[1]),e(p[1],v[0]))}function x(p,v,f,y){var o=t(v,p),m=t(y,f),l=i(o,m);if(r(l)===0)return null;var w=t(p,f),_=i(m,w),h=a(_,l),b=s(o,h),u=c(p,b);return u}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(g,S,M){S.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(g,S,M){var e=g("./colorScale"),a=g("lerp");S.exports=n;function n(s){var i,x,p,v,f,y,o,m,h,l,w;if(s||(s={}),m=(s.nshades||72)-1,o=s.format||"hex",y=s.colormap,y||(y="jet"),typeof y=="string"){if(y=y.toLowerCase(),!e[y])throw Error(y+" not a supported colorscale");f=e[y]}else if(Array.isArray(y))f=y.slice();else throw Error("unsupported colormap option",y);if(f.length>m+1)throw new Error(y+" map requires nshades to be at least size "+f.length);Array.isArray(s.alpha)?s.alpha.length!==2?l=[1,1]:l=s.alpha.slice():typeof s.alpha=="number"?l=[s.alpha,s.alpha]:l=[1,1],i=f.map(function(L){return Math.round(L.index*m)}),l[0]=Math.min(Math.max(l[0],0),1),l[1]=Math.min(Math.max(l[1],0),1);var _=f.map(function(L,T){var k=f[T].index,P=f[T].rgb.slice();return P.length===4&&P[3]>=0&&P[3]<=1||(P[3]=l[0]+(l[1]-l[0])*k),P}),h=[];for(w=0;w<i.length-1;++w){v=i[w+1]-i[w],x=_[w],p=_[w+1];for(var b=0;b<v;b++){var u=b/v;h.push([Math.round(a(x[0],p[0],u)),Math.round(a(x[1],p[1],u)),Math.round(a(x[2],p[2],u)),a(x[3],p[3],u)])}}return h.push(f[f.length-1].rgb.concat(l[1])),o==="hex"?h=h.map(t):o==="rgbaString"?h=h.map(c):o==="float"&&(h=h.map(r)),h}function r(s){return[s[0]/255,s[1]/255,s[2]/255,s[3]]}function t(s){for(var i,x="#",p=0;p<3;++p)i=s[p],i=i.toString(16),x+=("00"+i).substr(i.length);return x}function c(s){return"rgba("+s.join(",")+")"}},{"./colorScale":52,lerp:240}],54:[function(g,S,M){S.exports=s;var e=g("robust-orientation"),a=g("signum"),n=g("two-sum"),r=g("robust-product"),t=g("robust-sum");function c(i,x,p){var v=n(i[0],-x[0]),f=n(i[1],-x[1]),y=n(p[0],-x[0]),o=n(p[1],-x[1]),m=t(r(v,y),r(f,o));return m[m.length-1]>=0}function s(i,x,p,v){var f=e(x,p,v);if(f===0){var y=a(e(i,x,p)),o=a(e(i,x,v));if(y===o){if(y===0){var m=c(i,x,p),l=c(i,x,v);return m===l?0:m?1:-1}return 0}else{if(o===0)return y>0||c(i,x,v)?-1:1;if(y===0)return o>0||c(i,x,p)?1:-1}return a(o-y)}var w=e(i,x,p);if(w>0)return f>0&&e(i,x,v)>0?1:-1;if(w<0)return f>0||e(i,x,v)>0?1:-1;var _=e(i,x,v);return _>0||c(i,x,p)?1:-1}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(g,S,M){S.exports=function(a){return a<0?-1:a>0?1:0}},{}],56:[function(g,S,M){S.exports=n;var e=Math.min;function a(r,t){return r-t}function n(r,t){var c=r.length,s=r.length-t.length;if(s)return s;switch(c){case 0:return 0;case 1:return r[0]-t[0];case 2:return r[0]+r[1]-t[0]-t[1]||e(r[0],r[1])-e(t[0],t[1]);case 3:var i=r[0]+r[1],x=t[0]+t[1];if(s=i+r[2]-(x+t[2]),s)return s;var p=e(r[0],r[1]),v=e(t[0],t[1]);return e(p,r[2])-e(v,t[2])||e(p+r[2],i)-e(v+t[2],x);case 4:var f=r[0],y=r[1],o=r[2],m=r[3],l=t[0],w=t[1],_=t[2],h=t[3];return f+y+o+m-(l+w+_+h)||e(f,y,o,m)-e(l,w,_,h,l)||e(f+y,f+o,f+m,y+o,y+m,o+m)-e(l+w,l+_,l+h,w+_,w+h,_+h)||e(f+y+o,f+y+m,f+o+m,y+o+m)-e(l+w+_,l+w+h,l+_+h,w+_+h);default:for(var b=r.slice().sort(a),u=t.slice().sort(a),L=0;L<c;++L)if(s=b[L]-u[L],s)return s;return 0}}},{}],57:[function(g,S,M){var e=g("compare-cell"),a=g("cell-orientation");S.exports=n;function n(r,t){return e(r,t)||a(r)-a(t)}},{"cell-orientation":47,"compare-cell":56}],58:[function(g,S,M){var e=g("./lib/ch1d"),a=g("./lib/ch2d"),n=g("./lib/chnd");S.exports=r;function r(t){var c=t.length;if(c===0)return[];if(c===1)return[[0]];var s=t[0].length;return s===0?[]:s===1?e(t):s===2?a(t):n(t,s)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(g,S,M){S.exports=e;function e(a){for(var n=0,r=0,t=1;t<a.length;++t)a[t][0]<a[n][0]&&(n=t),a[t][0]>a[r][0]&&(r=t);return n<r?[[n],[r]]:n>r?[[r],[n]]:[[n]]}},{}],60:[function(g,S,M){S.exports=a;var e=g("monotone-convex-hull-2d");function a(n){var r=e(n),t=r.length;if(t<=2)return[];for(var c=new Array(t),s=r[t-1],i=0;i<t;++i){var x=r[i];c[i]=[s,x],s=x}return c}},{"monotone-convex-hull-2d":246}],61:[function(g,S,M){S.exports=t;var e=g("incremental-convex-hull"),a=g("affine-hull");function n(c,s){for(var i=c.length,x=new Array(i),p=0;p<s.length;++p)x[p]=c[s[p]];for(var v=s.length,p=0;p<i;++p)s.indexOf(p)<0&&(x[v++]=c[p]);return x}function r(c,s){for(var i=c.length,x=s.length,p=0;p<i;++p)for(var v=c[p],f=0;f<v.length;++f){var y=v[f];if(y<x)v[f]=s[y];else{y=y-x;for(var o=0;o<x;++o)y>=s[o]&&(y+=1);v[f]=y}}return c}function t(c,s){try{return e(c,!0)}catch{var i=a(c);if(i.length<=s)return[];var x=n(c,i),p=e(x,!0);return r(p,i)}}},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(g,S,M){function e(n,r,t,c,s,i){var x=6*s*s-6*s,p=3*s*s-4*s+1,v=-6*s*s+6*s,f=3*s*s-2*s;if(n.length){i||(i=new Array(n.length));for(var y=n.length-1;y>=0;--y)i[y]=x*n[y]+p*r[y]+v*t[y]+f*c[y];return i}return x*n+p*r+v*t[y]+f*c}function a(n,r,t,c,s,i){var x=s-1,p=s*s,v=x*x,f=(1+2*s)*v,y=s*v,o=p*(3-2*s),m=p*x;if(n.length){i||(i=new Array(n.length));for(var l=n.length-1;l>=0;--l)i[l]=f*n[l]+y*r[l]+o*t[l]+m*c[l];return i}return f*n+y*r+o*t+m*c}S.exports=a,S.exports.derivative=e},{}],63:[function(g,S,M){var e=g("incremental-convex-hull"),a=g("uniq");S.exports=c;function n(s,i){this.point=s,this.index=i}function r(s,i){for(var x=s.point,p=i.point,v=x.length,f=0;f<v;++f){var y=p[f]-x[f];if(y)return y}return 0}function t(s,i,x){if(s===1)return x?[[-1,0]]:[];var p=i.map(function(m,l){return[m[0],l]});p.sort(function(m,l){return m[0]-l[0]});for(var v=new Array(s-1),f=1;f<s;++f){var y=p[f-1],o=p[f];v[f-1]=[y[1],o[1]]}return x&&v.push([-1,v[0][1]],[v[s-1][1],-1]),v}function c(s,i){var x=s.length;if(x===0)return[];var p=s[0].length;if(p<1)return[];if(p===1)return t(x,s,i);for(var v=new Array(x),f=1,y=0;y<x;++y){for(var o=s[y],m=new Array(p+1),l=0,w=0;w<p;++w){var _=o[w];m[w]=_,l+=_*_}m[p]=l,v[y]=new n(m,y),f=Math.max(l,f)}a(v,r),x=v.length;for(var h=new Array(x+p+1),b=new Array(x+p+1),u=(p+1)*(p+1)*f,L=new Array(p+1),y=0;y<=p;++y)L[y]=0;L[p]=u,h[0]=L.slice(),b[0]=-1;for(var y=0;y<=p;++y){var m=L.slice();m[y]=1,h[y+1]=m,b[y+1]=-1}for(var y=0;y<x;++y){var T=v[y];h[y+p+1]=T.point,b[y+p+1]=T.index}var k=e(h,!1);if(i?k=k.filter(function(P){for(var z=0,I=0;I<=p;++I){var D=b[P[I]];if(D<0&&++z>=2)return!1;P[I]=D}return!0}):k=k.filter(function(P){for(var z=0;z<=p;++z){var I=b[P[z]];if(I<0)return!1;P[z]=I}return!0}),p&1)for(var y=0;y<k.length;++y){var T=k[y],m=T[0];T[0]=T[1],T[1]=m}return k}},{"incremental-convex-hull":233,uniq:310}],64:[function(g,S,M){(function(e){(function(){var a=!1;if(typeof Float64Array<"u"){var n=new Float64Array(1),r=new Uint32Array(n.buffer);if(n[0]=1,a=!0,r[1]===1072693248){let m=function(_,h){return r[0]=_,r[1]=h,n[0]},l=function(_){return n[0]=_,r[0]},w=function(_){return n[0]=_,r[1]};var c=m,s=l,i=w;S.exports=function(h){return n[0]=h,[r[0],r[1]]},S.exports.pack=m,S.exports.lo=l,S.exports.hi=w}else if(r[0]===1072693248){let m=function(_,h){return r[1]=_,r[0]=h,n[0]},l=function(_){return n[0]=_,r[1]},w=function(_){return n[0]=_,r[0]};var x=m,p=l,v=w;S.exports=function(h){return n[0]=h,[r[1],r[0]]},S.exports.pack=m,S.exports.lo=l,S.exports.hi=w}else a=!1}if(!a){let m=function(_,h){return t.writeUInt32LE(_,0,!0),t.writeUInt32LE(h,4,!0),t.readDoubleLE(0,!0)},l=function(_){return t.writeDoubleLE(_,0,!0),t.readUInt32LE(0,!0)},w=function(_){return t.writeDoubleLE(_,0,!0),t.readUInt32LE(4,!0)};var f=m,y=l,o=w,t=new e(8);S.exports=function(h){return t.writeDoubleLE(h,0,!0),[t.readUInt32LE(0,!0),t.readUInt32LE(4,!0)]},S.exports.pack=m,S.exports.lo=l,S.exports.hi=w}S.exports.sign=function(m){return S.exports.hi(m)>>>31},S.exports.exponent=function(m){var l=S.exports.hi(m);return(l<<1>>>21)-1023},S.exports.fraction=function(m){var l=S.exports.lo(m),w=S.exports.hi(m),_=w&(1<<20)-1;return w&2146435072&&(_+=1<<20),[l,_]},S.exports.denormalized=function(m){var l=S.exports.hi(m);return!(l&2146435072)}}).call(this)}).call(this,g("buffer").Buffer)},{buffer:3}],65:[function(g,S,M){function e(r,t,c){var s=r[c]|0;if(s<=0)return[];var i=new Array(s),x;if(c===r.length-1)for(x=0;x<s;++x)i[x]=t;else for(x=0;x<s;++x)i[x]=e(r,t,c+1);return i}function a(r,t){var c,s;for(c=new Array(r),s=0;s<r;++s)c[s]=t;return c}function n(r,t){switch(typeof t>"u"&&(t=0),typeof r){case"number":if(r>0)return a(r|0,t);break;case"object":if(typeof r.length=="number")return e(r,t,0);break}return[]}S.exports=n},{}],66:[function(g,S,M){S.exports=a;var e=g("uniq");function a(n,r){var t=n.length;if(typeof r!="number"){r=0;for(var c=0;c<t;++c){var s=n[c];r=Math.max(r,s[0],s[1])}r=(r|0)+1}r=r|0;for(var i=new Array(r),c=0;c<r;++c)i[c]=[];for(var c=0;c<t;++c){var s=n[c];i[s[0]].push(s[1]),i[s[1]].push(s[0])}for(var x=0;x<r;++x)e(i[x],function(p,v){return p-v});return i}},{uniq:310}],67:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n||0,c=r||1;return[[a[12]+a[0],a[13]+a[1],a[14]+a[2],a[15]+a[3]],[a[12]-a[0],a[13]-a[1],a[14]-a[2],a[15]-a[3]],[a[12]+a[4],a[13]+a[5],a[14]+a[6],a[15]+a[7]],[a[12]-a[4],a[13]-a[5],a[14]-a[6],a[15]-a[7]],[t*a[12]+a[8],t*a[13]+a[9],t*a[14]+a[10],t*a[15]+a[11]],[c*a[12]-a[8],c*a[13]-a[9],c*a[14]-a[10],c*a[15]-a[11]]]}},{}],68:[function(g,S,M){S.exports=s;var e=g("cubic-hermite"),a=g("binary-search-bounds");function n(i,x,p){return Math.min(x,Math.max(i,p))}function r(i,x,p){this.dimension=i.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var v=0;v<this.dimension;++v)this.bounds[0][v]=-1/0,this.bounds[1][v]=1/0;this._state=i.slice().reverse(),this._velocity=x.slice().reverse(),this._time=[p],this._scratch=[i.slice(),i.slice(),i.slice(),i.slice(),i.slice()]}var t=r.prototype;t.flush=function(i){var x=a.gt(this._time,i)-1;x<=0||(this._time.splice(0,x),this._state.splice(0,x*this.dimension),this._velocity.splice(0,x*this.dimension))},t.curve=function(i){var x=this._time,p=x.length,v=a.le(x,i),f=this._scratch[0],y=this._state,o=this._velocity,m=this.dimension,l=this.bounds;if(v<0)for(var w=m-1,_=0;_<m;++_,--w)f[_]=y[w];else if(v>=p-1)for(var w=y.length-1,h=i-x[p-1],_=0;_<m;++_,--w)f[_]=y[w]+h*o[w];else{for(var w=m*(v+1)-1,b=x[v],u=x[v+1],L=u-b||1,T=this._scratch[1],k=this._scratch[2],P=this._scratch[3],z=this._scratch[4],I=!0,_=0;_<m;++_,--w)T[_]=y[w],P[_]=o[w]*L,k[_]=y[w+m],z[_]=o[w+m]*L,I=I&&T[_]===k[_]&&P[_]===z[_]&&P[_]===0;if(I)for(var _=0;_<m;++_)f[_]=T[_];else e(T,P,k,z,(i-b)/L,f)}for(var D=l[0],R=l[1],_=0;_<m;++_)f[_]=n(D[_],R[_],f[_]);return f},t.dcurve=function(i){var x=this._time,p=x.length,v=a.le(x,i),f=this._scratch[0],y=this._state,o=this._velocity,m=this.dimension;if(v>=p-1){var l=y.length-1;i-x[p-1];for(var w=0;w<m;++w,--l)f[w]=o[l]}else{for(var l=m*(v+1)-1,_=x[v],h=x[v+1],b=h-_||1,u=this._scratch[1],L=this._scratch[2],T=this._scratch[3],k=this._scratch[4],P=!0,w=0;w<m;++w,--l)u[w]=y[l],T[w]=o[l]*b,L[w]=y[l+m],k[w]=o[l+m]*b,P=P&&u[w]===L[w]&&T[w]===k[w]&&T[w]===0;if(P)for(var w=0;w<m;++w)f[w]=0;else{e.derivative(u,T,L,k,(i-_)/b,f);for(var w=0;w<m;++w)f[w]/=b}}return f},t.lastT=function(){var i=this._time;return i[i.length-1]},t.stable=function(){for(var i=this._velocity,x=i.length,p=this.dimension-1;p>=0;--p)if(i[--x])return!1;return!0},t.jump=function(i){var x=this.lastT(),p=this.dimension;if(!(i<x||arguments.length!==p+1)){var v=this._state,f=this._velocity,y=v.length-this.dimension,o=this.bounds,m=o[0],l=o[1];this._time.push(x,i);for(var w=0;w<2;++w)for(var _=0;_<p;++_)v.push(v[y++]),f.push(0);this._time.push(i);for(var _=p;_>0;--_)v.push(n(m[_-1],l[_-1],arguments[_])),f.push(0)}},t.push=function(i){var x=this.lastT(),p=this.dimension;if(!(i<x||arguments.length!==p+1)){var v=this._state,f=this._velocity,y=v.length-this.dimension,o=i-x,m=this.bounds,l=m[0],w=m[1],_=o>1e-6?1/o:0;this._time.push(i);for(var h=p;h>0;--h){var b=n(l[h-1],w[h-1],arguments[h]);v.push(b),f.push((b-v[y++])*_)}}},t.set=function(i){var x=this.dimension;if(!(i<this.lastT()||arguments.length!==x+1)){var p=this._state,v=this._velocity,f=this.bounds,y=f[0],o=f[1];this._time.push(i);for(var m=x;m>0;--m)p.push(n(y[m-1],o[m-1],arguments[m])),v.push(0)}},t.move=function(i){var x=this.lastT(),p=this.dimension;if(!(i<=x||arguments.length!==p+1)){var v=this._state,f=this._velocity,y=v.length-this.dimension,o=this.bounds,m=o[0],l=o[1],w=i-x,_=w>1e-6?1/w:0;this._time.push(i);for(var h=p;h>0;--h){var b=arguments[h];v.push(n(m[h-1],l[h-1],v[y++]+b)),f.push(b*_)}}},t.idle=function(i){var x=this.lastT();if(!(i<x)){var p=this.dimension,v=this._state,f=this._velocity,y=v.length-p,o=this.bounds,m=o[0],l=o[1],w=i-x;this._time.push(i);for(var _=p-1;_>=0;--_)v.push(n(m[_],l[_],v[y]+w*f[y])),f.push(0),y+=1}};function c(i){for(var x=new Array(i),p=0;p<i;++p)x[p]=0;return x}function s(i,x,p){switch(arguments.length){case 0:return new r([0],[0],0);case 1:if(typeof i=="number"){var v=c(i);return new r(v,v,0)}else return new r(i,c(i.length),0);case 2:if(typeof x=="number"){var v=c(i.length);return new r(i,v,+x)}else p=0;case 3:if(i.length!==x.length)throw new Error("state and velocity lengths must match");return new r(i,x,p)}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(g,S,M){S.exports=w;var e=0,a=1;function n(_,h,b,u,L,T){this._color=_,this.key=h,this.value=b,this.left=u,this.right=L,this._count=T}function r(_){return new n(_._color,_.key,_.value,_.left,_.right,_._count)}function t(_,h){return new n(_,h.key,h.value,h.left,h.right,h._count)}function c(_){_._count=1+(_.left?_.left._count:0)+(_.right?_.right._count:0)}function s(_,h){this._compare=_,this.root=h}var i=s.prototype;Object.defineProperty(i,"keys",{get:function(){var _=[];return this.forEach(function(h,b){_.push(h)}),_}}),Object.defineProperty(i,"values",{get:function(){var _=[];return this.forEach(function(h,b){_.push(b)}),_}}),Object.defineProperty(i,"length",{get:function(){return this.root?this.root._count:0}}),i.insert=function(_,h){for(var b=this._compare,u=this.root,L=[],T=[];u;){var k=b(_,u.key);L.push(u),T.push(k),k<=0?u=u.left:u=u.right}L.push(new n(e,_,h,null,null,1));for(var P=L.length-2;P>=0;--P){var u=L[P];T[P]<=0?L[P]=new n(u._color,u.key,u.value,L[P+1],u.right,u._count+1):L[P]=new n(u._color,u.key,u.value,u.left,L[P+1],u._count+1)}for(var P=L.length-1;P>1;--P){var z=L[P-1],u=L[P];if(z._color===a||u._color===a)break;var I=L[P-2];if(I.left===z)if(z.left===u){var D=I.right;if(D&&D._color===e)z._color=a,I.right=t(a,D),I._color=e,P-=1;else{if(I._color=e,I.left=z.right,z._color=a,z.right=I,L[P-2]=z,L[P-1]=u,c(I),c(z),P>=3){var R=L[P-3];R.left===I?R.left=z:R.right=z}break}}else{var D=I.right;if(D&&D._color===e)z._color=a,I.right=t(a,D),I._color=e,P-=1;else{if(z.right=u.left,I._color=e,I.left=u.right,u._color=a,u.left=z,u.right=I,L[P-2]=u,L[P-1]=z,c(I),c(z),c(u),P>=3){var R=L[P-3];R.left===I?R.left=u:R.right=u}break}}else if(z.right===u){var D=I.left;if(D&&D._color===e)z._color=a,I.left=t(a,D),I._color=e,P-=1;else{if(I._color=e,I.right=z.left,z._color=a,z.left=I,L[P-2]=z,L[P-1]=u,c(I),c(z),P>=3){var R=L[P-3];R.right===I?R.right=z:R.left=z}break}}else{var D=I.left;if(D&&D._color===e)z._color=a,I.left=t(a,D),I._color=e,P-=1;else{if(z.left=u.right,I._color=e,I.right=u.left,u._color=a,u.right=z,u.left=I,L[P-2]=u,L[P-1]=z,c(I),c(z),c(u),P>=3){var R=L[P-3];R.right===I?R.right=u:R.left=u}break}}}return L[0]._color=a,new s(b,L[0])};function x(_,h){if(h.left){var b=x(_,h.left);if(b)return b}var b=_(h.key,h.value);if(b)return b;if(h.right)return x(_,h.right)}function p(_,h,b,u){var L=h(_,u.key);if(L<=0){if(u.left){var T=p(_,h,b,u.left);if(T)return T}var T=b(u.key,u.value);if(T)return T}if(u.right)return p(_,h,b,u.right)}function v(_,h,b,u,L){var T=b(_,L.key),k=b(h,L.key),P;if(T<=0&&(L.left&&(P=v(_,h,b,u,L.left),P)||k>0&&(P=u(L.key,L.value),P)))return P;if(k>0&&L.right)return v(_,h,b,u,L.right)}i.forEach=function(h,b,u){if(!!this.root)switch(arguments.length){case 1:return x(h,this.root);case 2:return p(b,this._compare,h,this.root);case 3:return this._compare(b,u)>=0?void 0:v(b,u,this._compare,h,this.root)}},Object.defineProperty(i,"begin",{get:function(){for(var _=[],h=this.root;h;)_.push(h),h=h.left;return new f(this,_)}}),Object.defineProperty(i,"end",{get:function(){for(var _=[],h=this.root;h;)_.push(h),h=h.right;return new f(this,_)}}),i.at=function(_){if(_<0)return new f(this,[]);for(var h=this.root,b=[];;){if(b.push(h),h.left){if(_<h.left._count){h=h.left;continue}_-=h.left._count}if(!_)return new f(this,b);if(_-=1,h.right){if(_>=h.right._count)break;h=h.right}else break}return new f(this,[])},i.ge=function(_){for(var h=this._compare,b=this.root,u=[],L=0;b;){var T=h(_,b.key);u.push(b),T<=0&&(L=u.length),T<=0?b=b.left:b=b.right}return u.length=L,new f(this,u)},i.gt=function(_){for(var h=this._compare,b=this.root,u=[],L=0;b;){var T=h(_,b.key);u.push(b),T<0&&(L=u.length),T<0?b=b.left:b=b.right}return u.length=L,new f(this,u)},i.lt=function(_){for(var h=this._compare,b=this.root,u=[],L=0;b;){var T=h(_,b.key);u.push(b),T>0&&(L=u.length),T<=0?b=b.left:b=b.right}return u.length=L,new f(this,u)},i.le=function(_){for(var h=this._compare,b=this.root,u=[],L=0;b;){var T=h(_,b.key);u.push(b),T>=0&&(L=u.length),T<0?b=b.left:b=b.right}return u.length=L,new f(this,u)},i.find=function(_){for(var h=this._compare,b=this.root,u=[];b;){var L=h(_,b.key);if(u.push(b),L===0)return new f(this,u);L<=0?b=b.left:b=b.right}return new f(this,[])},i.remove=function(_){var h=this.find(_);return h?h.remove():this},i.get=function(_){for(var h=this._compare,b=this.root;b;){var u=h(_,b.key);if(u===0)return b.value;u<=0?b=b.left:b=b.right}};function f(_,h){this.tree=_,this._stack=h}var y=f.prototype;Object.defineProperty(y,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(y,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),y.clone=function(){return new f(this.tree,this._stack.slice())};function o(_,h){_.key=h.key,_.value=h.value,_.left=h.left,_.right=h.right,_._color=h._color,_._count=h._count}function m(_){for(var h,b,u,L,T=_.length-1;T>=0;--T){if(h=_[T],T===0){h._color=a;return}if(b=_[T-1],b.left===h){if(u=b.right,u.right&&u.right._color===e){if(u=b.right=r(u),L=u.right=r(u.right),b.right=u.left,u.left=b,u.right=L,u._color=b._color,h._color=a,b._color=a,L._color=a,c(b),c(u),T>1){var k=_[T-2];k.left===b?k.left=u:k.right=u}_[T-1]=u;return}else if(u.left&&u.left._color===e){if(u=b.right=r(u),L=u.left=r(u.left),b.right=L.left,u.left=L.right,L.left=b,L.right=u,L._color=b._color,b._color=a,u._color=a,h._color=a,c(b),c(u),c(L),T>1){var k=_[T-2];k.left===b?k.left=L:k.right=L}_[T-1]=L;return}if(u._color===a)if(b._color===e){b._color=a,b.right=t(e,u);return}else{b.right=t(e,u);continue}else{if(u=r(u),b.right=u.left,u.left=b,u._color=b._color,b._color=e,c(b),c(u),T>1){var k=_[T-2];k.left===b?k.left=u:k.right=u}_[T-1]=u,_[T]=b,T+1<_.length?_[T+1]=h:_.push(h),T=T+2}}else{if(u=b.left,u.left&&u.left._color===e){if(u=b.left=r(u),L=u.left=r(u.left),b.left=u.right,u.right=b,u.left=L,u._color=b._color,h._color=a,b._color=a,L._color=a,c(b),c(u),T>1){var k=_[T-2];k.right===b?k.right=u:k.left=u}_[T-1]=u;return}else if(u.right&&u.right._color===e){if(u=b.left=r(u),L=u.right=r(u.right),b.left=L.right,u.right=L.left,L.right=b,L.left=u,L._color=b._color,b._color=a,u._color=a,h._color=a,c(b),c(u),c(L),T>1){var k=_[T-2];k.right===b?k.right=L:k.left=L}_[T-1]=L;return}if(u._color===a)if(b._color===e){b._color=a,b.left=t(e,u);return}else{b.left=t(e,u);continue}else{if(u=r(u),b.left=u.right,u.right=b,u._color=b._color,b._color=e,c(b),c(u),T>1){var k=_[T-2];k.right===b?k.right=u:k.left=u}_[T-1]=u,_[T]=b,T+1<_.length?_[T+1]=h:_.push(h),T=T+2}}}}y.remove=function(){var _=this._stack;if(_.length===0)return this.tree;var h=new Array(_.length),b=_[_.length-1];h[h.length-1]=new n(b._color,b.key,b.value,b.left,b.right,b._count);for(var u=_.length-2;u>=0;--u){var b=_[u];b.left===_[u+1]?h[u]=new n(b._color,b.key,b.value,h[u+1],b.right,b._count):h[u]=new n(b._color,b.key,b.value,b.left,h[u+1],b._count)}if(b=h[h.length-1],b.left&&b.right){var L=h.length;for(b=b.left;b.right;)h.push(b),b=b.right;var T=h[L-1];h.push(new n(b._color,T.key,T.value,b.left,b.right,b._count)),h[L-1].key=b.key,h[L-1].value=b.value;for(var u=h.length-2;u>=L;--u)b=h[u],h[u]=new n(b._color,b.key,b.value,b.left,h[u+1],b._count);h[L-1].left=h[L]}if(b=h[h.length-1],b._color===e){var k=h[h.length-2];k.left===b?k.left=null:k.right===b&&(k.right=null),h.pop();for(var u=0;u<h.length;++u)h[u]._count--;return new s(this.tree._compare,h[0])}else if(b.left||b.right){b.left?o(b,b.left):b.right&&o(b,b.right),b._color=a;for(var u=0;u<h.length-1;++u)h[u]._count--;return new s(this.tree._compare,h[0])}else{if(h.length===1)return new s(this.tree._compare,null);for(var u=0;u<h.length;++u)h[u]._count--;var P=h[h.length-2];m(h),P.left===b?P.left=null:P.right=null}return new s(this.tree._compare,h[0])},Object.defineProperty(y,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(y,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(y,"index",{get:function(){var _=0,h=this._stack;if(h.length===0){var b=this.tree.root;return b?b._count:0}else h[h.length-1].left&&(_=h[h.length-1].left._count);for(var u=h.length-2;u>=0;--u)h[u+1]===h[u].right&&(++_,h[u].left&&(_+=h[u].left._count));return _},enumerable:!0}),y.next=function(){var _=this._stack;if(_.length!==0){var h=_[_.length-1];if(h.right)for(h=h.right;h;)_.push(h),h=h.left;else for(_.pop();_.length>0&&_[_.length-1].right===h;)h=_[_.length-1],_.pop()}},Object.defineProperty(y,"hasNext",{get:function(){var _=this._stack;if(_.length===0)return!1;if(_[_.length-1].right)return!0;for(var h=_.length-1;h>0;--h)if(_[h-1].left===_[h])return!0;return!1}}),y.update=function(_){var h=this._stack;if(h.length===0)throw new Error("Can't update empty node!");var b=new Array(h.length),u=h[h.length-1];b[b.length-1]=new n(u._color,u.key,_,u.left,u.right,u._count);for(var L=h.length-2;L>=0;--L)u=h[L],u.left===h[L+1]?b[L]=new n(u._color,u.key,u.value,b[L+1],u.right,u._count):b[L]=new n(u._color,u.key,u.value,u.left,b[L+1],u._count);return new s(this.tree._compare,b[0])},y.prev=function(){var _=this._stack;if(_.length!==0){var h=_[_.length-1];if(h.left)for(h=h.left;h;)_.push(h),h=h.right;else for(_.pop();_.length>0&&_[_.length-1].left===h;)h=_[_.length-1],_.pop()}},Object.defineProperty(y,"hasPrev",{get:function(){var _=this._stack;if(_.length===0)return!1;if(_[_.length-1].left)return!0;for(var h=_.length-1;h>0;--h)if(_[h-1].right===_[h])return!0;return!1}});function l(_,h){return _<h?-1:_>h?1:0}function w(_){return new s(_||l,null)}},{}],70:[function(g,S,M){S.exports=h;var e=g("./lib/text.js"),a=g("./lib/lines.js"),n=g("./lib/background.js"),r=g("./lib/cube.js"),t=g("./lib/ticks.js"),c=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function s(b,u){return b[0]=u[0],b[1]=u[1],b[2]=u[2],b}function i(b){this.gl=b,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=n(b)}var x=i.prototype;x.update=function(b){b=b||{};function u(G,K,W){if(W in b){var Y=b[W],re=this[W],ue;(G?Array.isArray(Y)&&Array.isArray(Y[0]):Array.isArray(Y))?this[W]=ue=[K(Y[0]),K(Y[1]),K(Y[2])]:this[W]=ue=[K(Y),K(Y),K(Y)];for(var j=0;j<3;++j)if(ue[j]!==re[j])return!0}return!1}var L=u.bind(this,!1,Number),T=u.bind(this,!1,Boolean),k=u.bind(this,!1,String),P=u.bind(this,!0,function(G){if(Array.isArray(G)){if(G.length===3)return[+G[0],+G[1],+G[2],1];if(G.length===4)return[+G[0],+G[1],+G[2],+G[3]]}return[0,0,0,1]}),z,I=!1,D=!1;if("bounds"in b)for(var R=b.bounds,O=0;O<2;++O)for(var F=0;F<3;++F)R[O][F]!==this.bounds[O][F]&&(D=!0),this.bounds[O][F]=R[O][F];if("ticks"in b){z=b.ticks,I=!0,this.autoTicks=!1;for(var O=0;O<3;++O)this.tickSpacing[O]=0}else L("tickSpacing")&&(this.autoTicks=!0,D=!0);if(this._firstInit&&("ticks"in b||"tickSpacing"in b||(this.autoTicks=!0),D=!0,I=!0,this._firstInit=!1),D&&this.autoTicks&&(z=t.create(this.bounds,this.tickSpacing),I=!0),I){for(var O=0;O<3;++O)z[O].sort(function(K,W){return K.x-W.x});t.equal(z,this.ticks)?I=!1:this.ticks=z}T("tickEnable"),k("tickFont")&&(I=!0),L("tickSize"),L("tickAngle"),L("tickPad"),P("tickColor");var N=k("labels");k("labelFont")&&(N=!0),T("labelEnable"),L("labelSize"),L("labelPad"),P("labelColor"),T("lineEnable"),T("lineMirror"),L("lineWidth"),P("lineColor"),T("lineTickEnable"),T("lineTickMirror"),L("lineTickLength"),L("lineTickWidth"),P("lineTickColor"),T("gridEnable"),L("gridWidth"),P("gridColor"),T("zeroEnable"),P("zeroLineColor"),L("zeroLineWidth"),T("backgroundEnable"),P("backgroundColor"),this._text?this._text&&(N||I)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=e(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&I&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=a(this.gl,this.bounds,this.ticks))};function p(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}var v=[new p,new p,new p];function f(b,u,L,T,k){for(var P=b.primalOffset,z=b.primalMinor,I=b.mirrorOffset,D=b.mirrorMinor,R=T[u],O=0;O<3;++O)if(u!==O){var F=P,N=I,G=z,K=D;R&1<<O&&(F=I,N=P,G=D,K=z),F[O]=L[0][O],N[O]=L[1][O],k[O]>0?(G[O]=-1,K[O]=0):(G[O]=0,K[O]=1)}}var y=[0,0,0],o={model:c,view:c,projection:c,_ortho:!1};x.isOpaque=function(){return!0},x.isTransparent=function(){return!1},x.drawTransparent=function(b){};var m=0,l=[0,0,0],w=[0,0,0],_=[0,0,0];x.draw=function(b){b=b||o;for(var re=this.gl,u=b.model||c,L=b.view||c,T=b.projection||c,k=this.bounds,P=b._ortho||!1,z=r(u,L,T,k,P),I=z.cubeEdges,D=z.axis,R=L[12],O=L[13],F=L[14],N=L[15],G=P?2:1,K=G*this.pixelRatio*(T[3]*R+T[7]*O+T[11]*F+T[15]*N)/re.drawingBufferHeight,W=0;W<3;++W)this.lastCubeProps.cubeEdges[W]=I[W],this.lastCubeProps.axis[W]=D[W];for(var Y=v,W=0;W<3;++W)f(v[W],W,this.bounds,I,D);for(var re=this.gl,ue=y,W=0;W<3;++W)this.backgroundEnable[W]?ue[W]=D[W]:ue[W]=0;this._background.draw(u,L,T,k,ue,this.backgroundColor),this._lines.bind(u,L,T,this);for(var W=0;W<3;++W){var j=[0,0,0];D[W]>0?j[W]=k[1][W]:j[W]=k[0][W];for(var q=0;q<2;++q){var V=(W+1+q)%3,U=(W+1+(q^1))%3;this.gridEnable[V]&&this._lines.drawGrid(V,U,this.bounds,j,this.gridColor[V],this.gridWidth[V]*this.pixelRatio)}for(var q=0;q<2;++q){var V=(W+1+q)%3,U=(W+1+(q^1))%3;this.zeroEnable[U]&&Math.min(k[0][U],k[1][U])<=0&&Math.max(k[0][U],k[1][U])>=0&&this._lines.drawZero(V,U,this.bounds,j,this.zeroLineColor[U],this.zeroLineWidth[U]*this.pixelRatio)}}for(var W=0;W<3;++W){this.lineEnable[W]&&this._lines.drawAxisLine(W,this.bounds,Y[W].primalOffset,this.lineColor[W],this.lineWidth[W]*this.pixelRatio),this.lineMirror[W]&&this._lines.drawAxisLine(W,this.bounds,Y[W].mirrorOffset,this.lineColor[W],this.lineWidth[W]*this.pixelRatio);for(var $=s(l,Y[W].primalMinor),ne=s(w,Y[W].mirrorMinor),X=this.lineTickLength,q=0;q<3;++q){var Q=K/u[5*q];$[q]*=X[q]*Q,ne[q]*=X[q]*Q}this.lineTickEnable[W]&&this._lines.drawAxisTicks(W,Y[W].primalOffset,$,this.lineTickColor[W],this.lineTickWidth[W]*this.pixelRatio),this.lineTickMirror[W]&&this._lines.drawAxisTicks(W,Y[W].mirrorOffset,ne,this.lineTickColor[W],this.lineTickWidth[W]*this.pixelRatio)}this._lines.unbind(),this._text.bind(u,L,T,this.pixelRatio);var ie,se=.5,ae,oe;function be(Ee){oe=[0,0,0],oe[Ee]=1}function ce(Ee,Pe,Ne){var we=(Ee+1)%3,ke=(Ee+2)%3,Xe=Pe[we],He=Pe[ke],Ie=Ne[we],De=Ne[ke];if(Xe>0&&De>0){be(we);return}else if(Xe>0&&De<0){be(we);return}else if(Xe<0&&De>0){be(we);return}else if(Xe<0&&De<0){be(we);return}else if(He>0&&Ie>0){be(ke);return}else if(He>0&&Ie<0){be(ke);return}else if(He<0&&Ie>0){be(ke);return}else if(He<0&&Ie<0){be(ke);return}}for(var W=0;W<3;++W){for(var de=Y[W].primalMinor,ye=Y[W].mirrorMinor,ge=s(_,Y[W].primalOffset),q=0;q<3;++q)this.lineTickEnable[W]&&(ge[q]+=K*de[q]*Math.max(this.lineTickLength[q],0)/u[5*q]);var me=[0,0,0];if(me[W]=1,this.tickEnable[W]){this.tickAngle[W]===-3600?(this.tickAngle[W]=0,this.tickAlign[W]="auto"):this.tickAlign[W]=-1,ae=1,ie=[this.tickAlign[W],se,ae],ie[0]==="auto"?ie[0]=m:ie[0]=parseInt(""+ie[0]),oe=[0,0,0],ce(W,de,ye);for(var q=0;q<3;++q)ge[q]+=K*de[q]*this.tickPad[q]/u[5*q];this._text.drawTicks(W,this.tickSize[W],this.tickAngle[W],ge,this.tickColor[W],me,oe,ie)}if(this.labelEnable[W]){ae=0,oe=[0,0,0],this.labels[W].length>4&&(be(W),ae=1),ie=[this.labelAlign[W],se,ae],ie[0]==="auto"?ie[0]=m:ie[0]=parseInt(""+ie[0]);for(var q=0;q<3;++q)ge[q]+=K*de[q]*this.labelPad[q]/u[5*q];ge[W]+=.5*(k[0][W]+k[1][W]),this._text.drawLabel(W,this.labelSize[W],this.labelAngle[W],ge,this.labelColor[W],[0,0,0],oe,ie)}}this._text.unbind()},x.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null};function h(b,u){var L=new i(b);return L.update(u),L}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(g,S,M){S.exports=c;var e=g("gl-buffer"),a=g("gl-vao"),n=g("./shaders").bg;function r(s,i,x,p){this.gl=s,this.buffer=i,this.vao=x,this.shader=p}var t=r.prototype;t.draw=function(s,i,x,p,v,f){for(var y=!1,o=0;o<3;++o)y=y||v[o];if(!!y){var m=this.gl;m.enable(m.POLYGON_OFFSET_FILL),m.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:s,view:i,projection:x,bounds:p,enable:v,colors:f},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),m.disable(m.POLYGON_OFFSET_FILL)}},t.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};function c(s){for(var i=[],x=[],p=0,v=0;v<3;++v)for(var f=(v+1)%3,y=(v+2)%3,o=[0,0,0],m=[0,0,0],l=-1;l<=1;l+=2){x.push(p,p+2,p+1,p+1,p+2,p+3),o[v]=l,m[v]=l;for(var w=-1;w<=1;w+=2){o[f]=w;for(var _=-1;_<=1;_+=2)o[y]=_,i.push(o[0],o[1],o[2],m[0],m[1],m[2]),p+=1}var h=f;f=y,y=h}var b=e(s,new Float32Array(i)),u=e(s,new Uint16Array(x),s.ELEMENT_ARRAY_BUFFER),L=a(s,[{buffer:b,type:s.FLOAT,size:3,offset:0,stride:24},{buffer:b,type:s.FLOAT,size:3,offset:12,stride:24}],u),T=n(s);return T.attributes.position.location=0,T.attributes.normal.location=1,new r(s,b,L,T)}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(g,S,M){S.exports=l;var e=g("bit-twiddle"),a=g("gl-mat4/multiply"),n=g("split-polygon"),r=g("robust-orientation"),t=new Array(16),c=new Array(8),s=new Array(8),i=new Array(3),x=[0,0,0];(function(){for(var w=0;w<8;++w)c[w]=[1,1,1,1],s[w]=[1,1,1]})();function p(w,_,h){for(var b=0;b<4;++b){w[b]=h[12+b];for(var u=0;u<3;++u)w[b]+=_[u]*h[4*u+b]}}var v=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function f(w){for(var _=0;_<v.length;++_)if(w=n.positive(w,v[_]),w.length<3)return 0;for(var h=w[0],b=h[0]/h[3],u=h[1]/h[3],L=0,_=1;_+1<w.length;++_){var T=w[_],k=w[_+1],P=T[0]/T[3],z=T[1]/T[3],I=k[0]/k[3],D=k[1]/k[3],R=P-b,O=z-u,F=I-b,N=D-u;L+=Math.abs(R*N-O*F)}return L}var y=[1,1,1],o=[0,0,0],m={cubeEdges:y,axis:o};function l(w,_,h,b,u){a(t,_,w),a(t,h,t);for(var L=0,T=0;T<2;++T){i[2]=b[T][2];for(var k=0;k<2;++k){i[1]=b[k][1];for(var P=0;P<2;++P)i[0]=b[P][0],p(c[L],i,t),L+=1}}for(var z=-1,T=0;T<8;++T){for(var I=c[T][3],D=0;D<3;++D)s[T][D]=c[T][D]/I;u&&(s[T][2]*=-1),I<0&&(z<0||s[T][2]<s[z][2])&&(z=T)}if(z<0){z=0;for(var R=0;R<3;++R){for(var O=(R+2)%3,F=(R+1)%3,N=-1,G=-1,K=0;K<2;++K){var W=K<<R,Y=W+(K<<O)+(1-K<<F),re=W+(1-K<<O)+(K<<F);r(s[W],s[Y],s[re],x)<0||(K?N=1:G=1)}if(N<0||G<0){G>N&&(z|=1<<R);continue}for(var K=0;K<2;++K){var W=K<<R,Y=W+(K<<O)+(1-K<<F),re=W+(1-K<<O)+(K<<F),ue=f([c[W],c[Y],c[re],c[W+(1<<O)+(1<<F)]]);K?N=ue:G=ue}if(G>N){z|=1<<R;continue}}}for(var j=7^z,q=-1,T=0;T<8;++T)T===z||T===j||(q<0||s[q][1]>s[T][1])&&(q=T);for(var V=-1,T=0;T<3;++T){var U=q^1<<T;if(!(U===z||U===j)){V<0&&(V=U);var F=s[U];F[0]<s[V][0]&&(V=U)}}for(var $=-1,T=0;T<3;++T){var U=q^1<<T;if(!(U===z||U===j||U===V)){$<0&&($=U);var F=s[U];F[0]>s[$][0]&&($=U)}}var ne=y;ne[0]=ne[1]=ne[2]=0,ne[e.log2(V^q)]=q&V,ne[e.log2(q^$)]=q&$;var X=$^7;X===z||X===j?(X=V^7,ne[e.log2($^X)]=X&$):ne[e.log2(V^X)]=X&V;for(var Q=o,ie=z,R=0;R<3;++R)ie&1<<R?Q[R]=-1:Q[R]=1;return m}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(g,S,M){S.exports=y;var e=g("gl-buffer"),a=g("gl-vao"),n=g("./shaders").line,r=[0,0,0],t=[0,0,0],c=[0,0,0],s=[0,0,0],i=[1,1];function x(o){return o[0]=o[1]=o[2]=0,o}function p(o,m){return o[0]=m[0],o[1]=m[1],o[2]=m[2],o}function v(o,m,l,w,_,h,b,u){this.gl=o,this.vertBuffer=m,this.vao=l,this.shader=w,this.tickCount=_,this.tickOffset=h,this.gridCount=b,this.gridOffset=u}var f=v.prototype;f.bind=function(o,m,l){this.shader.bind(),this.shader.uniforms.model=o,this.shader.uniforms.view=m,this.shader.uniforms.projection=l,i[0]=this.gl.drawingBufferWidth,i[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=i,this.vao.bind()},f.unbind=function(){this.vao.unbind()},f.drawAxisLine=function(o,m,l,w,_){var h=x(t);this.shader.uniforms.majorAxis=t,h[o]=m[1][o]-m[0][o],this.shader.uniforms.minorAxis=h;var b=p(s,l);b[o]+=m[0][o],this.shader.uniforms.offset=b,this.shader.uniforms.lineWidth=_,this.shader.uniforms.color=w;var u=x(c);u[(o+2)%3]=1,this.shader.uniforms.screenAxis=u,this.vao.draw(this.gl.TRIANGLES,6);var u=x(c);u[(o+1)%3]=1,this.shader.uniforms.screenAxis=u,this.vao.draw(this.gl.TRIANGLES,6)},f.drawAxisTicks=function(o,m,l,w,_){if(!!this.tickCount[o]){var h=x(r);h[o]=1,this.shader.uniforms.majorAxis=h,this.shader.uniforms.offset=m,this.shader.uniforms.minorAxis=l,this.shader.uniforms.color=w,this.shader.uniforms.lineWidth=_;var b=x(c);b[o]=1,this.shader.uniforms.screenAxis=b,this.vao.draw(this.gl.TRIANGLES,this.tickCount[o],this.tickOffset[o])}},f.drawGrid=function(o,m,l,w,_,h){if(!!this.gridCount[o]){var b=x(t);b[m]=l[1][m]-l[0][m],this.shader.uniforms.minorAxis=b;var u=p(s,w);u[m]+=l[0][m],this.shader.uniforms.offset=u;var L=x(r);L[o]=1,this.shader.uniforms.majorAxis=L;var T=x(c);T[o]=1,this.shader.uniforms.screenAxis=T,this.shader.uniforms.lineWidth=h,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,this.gridCount[o],this.gridOffset[o])}},f.drawZero=function(o,m,l,w,_,h){var b=x(t);this.shader.uniforms.majorAxis=b,b[o]=l[1][o]-l[0][o],this.shader.uniforms.minorAxis=b;var u=p(s,w);u[o]+=l[0][o],this.shader.uniforms.offset=u;var L=x(c);L[m]=1,this.shader.uniforms.screenAxis=L,this.shader.uniforms.lineWidth=h,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,6)},f.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()};function y(o,m,l){var w=[],_=[0,0,0],h=[0,0,0],b=[0,0,0],u=[0,0,0];w.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var L=0;L<3;++L){for(var P=w.length/3|0,T=0;T<l[L].length;++T){var k=+l[L][T].x;w.push(k,0,1,k,1,1,k,0,-1,k,0,-1,k,1,1,k,1,-1)}var I=w.length/3|0;_[L]=P,h[L]=I-P;for(var P=w.length/3|0,z=0;z<l[L].length;++z){var k=+l[L][z].x;w.push(k,0,1,k,1,1,k,0,-1,k,0,-1,k,1,1,k,1,-1)}var I=w.length/3|0;b[L]=P,u[L]=I-P}var D=e(o,new Float32Array(w)),R=a(o,[{buffer:D,type:o.FLOAT,size:3,stride:0,offset:0}]),O=n(o);return O.attributes.position.location=0,new v(o,D,R,O,h,_,u,b)}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(g,S,M){var e=g("glslify"),a=g("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);M.line=function(x){return a(x,n,r,null,[{name:"position",type:"vec3"}])};var t=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),c=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);M.text=function(x){return a(x,t,c,null,[{name:"position",type:"vec3"}])};var s=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),i=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);M.bg=function(x){return a(x,s,i,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(g,S,M){(function(e){(function(){S.exports=y;var a=g("gl-buffer"),n=g("gl-vao"),r=g("vectorize-text"),t=g("./shaders").text,c=window||e.global||{},s=c.__TEXT_CACHE||{};c.__TEXT_CACHE={};var i=3;function x(o,m,l,w){this.gl=o,this.shader=m,this.buffer=l,this.vao=w,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var p=x.prototype,v=[0,0];p.bind=function(o,m,l,w){this.vao.bind(),this.shader.bind();var _=this.shader.uniforms;_.model=o,_.view=m,_.projection=l,_.pixelScale=w,v[0]=this.gl.drawingBufferWidth,v[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=v},p.unbind=function(){this.vao.unbind()},p.update=function(o,m,l,w,_){var h=[];function b(R,O,F,N,G,K){var W=s[F];W||(W=s[F]={});var Y=W[O];Y||(Y=W[O]=f(O,{triangles:!0,font:F,textAlign:"center",textBaseline:"middle",lineSpacing:G,styletags:K}));for(var re=(N||12)/12,ue=Y.positions,j=Y.cells,q=0,V=j.length;q<V;++q)for(var U=j[q],$=2;$>=0;--$){var ne=ue[U[$]];h.push(re*ne[0],-re*ne[1],R)}}for(var u=[0,0,0],L=[0,0,0],T=[0,0,0],k=[0,0,0],P=1.25,z={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},I=0;I<3;++I){T[I]=h.length/i|0,b(.5*(o[0][I]+o[1][I]),m[I],l[I],12,P,z),k[I]=(h.length/i|0)-T[I],u[I]=h.length/i|0;for(var D=0;D<w[I].length;++D)!w[I][D].text||b(w[I][D].x,w[I][D].text,w[I][D].font||_,w[I][D].fontSize||12,P,z);L[I]=(h.length/i|0)-u[I]}this.buffer.update(h),this.tickOffset=u,this.tickCount=L,this.labelOffset=T,this.labelCount=k},p.drawTicks=function(o,m,l,w,_,h,b,u){!this.tickCount[o]||(this.shader.uniforms.axis=h,this.shader.uniforms.color=_,this.shader.uniforms.angle=l,this.shader.uniforms.scale=m,this.shader.uniforms.offset=w,this.shader.uniforms.alignDir=b,this.shader.uniforms.alignOpt=u,this.vao.draw(this.gl.TRIANGLES,this.tickCount[o],this.tickOffset[o]))},p.drawLabel=function(o,m,l,w,_,h,b,u){!this.labelCount[o]||(this.shader.uniforms.axis=h,this.shader.uniforms.color=_,this.shader.uniforms.angle=l,this.shader.uniforms.scale=m,this.shader.uniforms.offset=w,this.shader.uniforms.alignDir=b,this.shader.uniforms.alignOpt=u,this.vao.draw(this.gl.TRIANGLES,this.labelCount[o],this.labelOffset[o]))},p.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()};function f(o,m){try{return r(o,m)}catch(l){return console.warn('error vectorizing text:"'+o+'" error:',l),{cells:[],positions:[]}}}function y(o,m,l,w,_,h){var b=a(o),u=n(o,[{buffer:b,size:3}]),L=t(o);L.attributes.position.location=0;var T=new x(o,L,b,u);return T.update(m,l,w,_,h),T}}).call(this)}).call(this,g("_process"))},{"./shaders":74,_process:5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(g,S,M){M.create=a,M.equal=n;function e(r,t){var c=r+"",s=c.indexOf("."),i=0;s>=0&&(i=c.length-s-1);var x=Math.pow(10,i),p=Math.round(r*t*x),v=p+"";if(v.indexOf("e")>=0)return v;var f=p/x,y=p%x;p<0?(f=-Math.ceil(f)|0,y=-y|0):(f=Math.floor(f)|0,y=y|0);var o=""+f;if(p<0&&(o="-"+o),i){for(var m=""+y;m.length<i;)m="0"+m;return o+"."+m}else return o}function a(r,t){for(var c=[],s=0;s<3;++s){var i=[];.5*(r[0][s]+r[1][s]);for(var x=0;x*t[s]<=r[1][s];++x)i.push({x:x*t[s],text:e(t[s],x)});for(var x=-1;x*t[s]>=r[0][s];--x)i.push({x:x*t[s],text:e(t[s],x)});c.push(i)}return c}function n(r,t){for(var c=0;c<3;++c){if(r[c].length!==t[c].length)return!1;for(var s=0;s<r[c].length;++s){var i=r[c][s],x=t[c][s];if(i.x!==x.x||i.text!==x.text||i.font!==x.font||i.fontColor!==x.fontColor||i.fontSize!==x.fontSize||i.dx!==x.dx||i.dy!==x.dy)return!1}}return!0}},{}],77:[function(g,S,M){S.exports=m;var e=g("extract-frustum-planes"),a=g("split-polygon"),n=g("./lib/cube.js"),r=g("gl-mat4/multiply"),t=g("gl-mat4/transpose"),c=g("gl-vec4/transformMat4"),s=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),i=new Float32Array(16);function x(l,w,_){this.lo=l,this.hi=w,this.pixelsPerDataUnit=_}var p=[0,0,0,1],v=[0,0,0,1];function f(l,w,_,h,b){for(var u=0;u<3;++u){for(var L=p,T=v,k=0;k<3;++k)T[k]=L[k]=_[k];T[3]=L[3]=1,T[u]+=1,c(T,T,w),T[3]<0&&(l[u]=1/0),L[u]-=1,c(L,L,w),L[3]<0&&(l[u]=1/0);var P=(L[0]/L[3]-T[0]/T[3])*h,z=(L[1]/L[3]-T[1]/T[3])*b;l[u]=.25*Math.sqrt(P*P+z*z)}return l}var y=[new x(1/0,-1/0,1/0),new x(1/0,-1/0,1/0),new x(1/0,-1/0,1/0)],o=[0,0,0];function m(l,w,_,h,z){var u=w.model||s,L=w.view||s,T=w.projection||s,k=w._ortho||!1,P=l.bounds,z=z||n(u,L,T,P,k),I=z.axis;r(i,L,u),r(i,T,i);for(var D=y,R=0;R<3;++R)D[R].lo=1/0,D[R].hi=-1/0,D[R].pixelsPerDataUnit=1/0;var O=e(t(i,i));t(i,i);for(var F=0;F<3;++F){var N=(F+1)%3,G=(F+2)%3,K=o;e:for(var R=0;R<2;++R){var W=[];if(I[F]<0!=!!R){K[F]=P[R][F];for(var Y=0;Y<2;++Y){K[N]=P[Y^R][N];for(var re=0;re<2;++re)K[G]=P[re^Y^R][G],W.push(K.slice())}for(var ue=k?5:4,Y=ue;Y===ue;++Y){if(W.length===0)continue e;W=a.positive(W,O[Y])}for(var Y=0;Y<W.length;++Y)for(var G=W[Y],j=f(o,i,G,_,h),re=0;re<3;++re)D[re].lo=Math.min(D[re].lo,G[re]),D[re].hi=Math.max(D[re].hi,G[re]),re!==F&&(D[re].pixelsPerDataUnit=Math.min(D[re].pixelsPerDataUnit,Math.abs(j[re])))}}}return D}},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(g,S,M){var e=g("typedarray-pool"),a=g("ndarray-ops"),n=g("ndarray"),r=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function t(v,f,y,o,m){this.gl=v,this.type=f,this.handle=y,this.length=o,this.usage=m}var c=t.prototype;c.bind=function(){this.gl.bindBuffer(this.type,this.handle)},c.unbind=function(){this.gl.bindBuffer(this.type,null)},c.dispose=function(){this.gl.deleteBuffer(this.handle)};function s(v,f,y,o,m,l){var w=m.length*m.BYTES_PER_ELEMENT;if(l<0)return v.bufferData(f,m,o),w;if(w+l>y)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return v.bufferSubData(f,l,m),y}function i(v,f){for(var y=e.malloc(v.length,f),o=v.length,m=0;m<o;++m)y[m]=v[m];return y}function x(v,f){for(var y=1,o=f.length-1;o>=0;--o){if(f[o]!==y)return!1;y*=v[o]}return!0}c.update=function(v,f){if(typeof f!="number"&&(f=-1),this.bind(),typeof v=="object"&&typeof v.shape<"u"){var y=v.dtype;if(r.indexOf(y)<0&&(y="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var o=gl.getExtension("OES_element_index_uint");o&&y!=="uint16"?y="uint32":y="uint16"}if(y===v.dtype&&x(v.shape,v.stride))v.offset===0&&v.data.length===v.shape[0]?this.length=s(this.gl,this.type,this.length,this.usage,v.data,f):this.length=s(this.gl,this.type,this.length,this.usage,v.data.subarray(v.offset,v.shape[0]),f);else{var m=e.malloc(v.size,y),l=n(m,v.shape);a.assign(l,v),f<0?this.length=s(this.gl,this.type,this.length,this.usage,m,f):this.length=s(this.gl,this.type,this.length,this.usage,m.subarray(0,v.size),f),e.free(m)}}else if(Array.isArray(v)){var w;this.type===this.gl.ELEMENT_ARRAY_BUFFER?w=i(v,"uint16"):w=i(v,"float32"),f<0?this.length=s(this.gl,this.type,this.length,this.usage,w,f):this.length=s(this.gl,this.type,this.length,this.usage,w.subarray(0,v.length),f),e.free(w)}else if(typeof v=="object"&&typeof v.length=="number")this.length=s(this.gl,this.type,this.length,this.usage,v,f);else if(typeof v=="number"||v===void 0){if(f>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");v=v|0,v<=0&&(v=1),this.gl.bufferData(this.type,v|0,this.usage),this.length=v}else throw new Error("gl-buffer: Invalid data type")};function p(v,f,y,o){if(y=y||v.ARRAY_BUFFER,o=o||v.DYNAMIC_DRAW,y!==v.ARRAY_BUFFER&&y!==v.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(o!==v.DYNAMIC_DRAW&&o!==v.STATIC_DRAW&&o!==v.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var m=v.createBuffer(),l=new t(v,y,m,0,o);return l.update(f),l}S.exports=p},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(g,S,M){var e=g("gl-vec3");S.exports=function(n,r){var t=n.positions,c=n.vectors,s={positions:[],vertexIntensity:[],vertexIntensityBounds:n.vertexIntensityBounds,vectors:[],cells:[],coneOffset:n.coneOffset,colormap:n.colormap};if(n.positions.length===0)return r&&(r[0]=[0,0,0],r[1]=[0,0,0]),s;for(var i=0,x=1/0,p=-1/0,v=1/0,f=-1/0,y=1/0,o=-1/0,m=null,l=null,w=[],_=1/0,h=!1,b=0;b<t.length;b++){var u=t[b];x=Math.min(u[0],x),p=Math.max(u[0],p),v=Math.min(u[1],v),f=Math.max(u[1],f),y=Math.min(u[2],y),o=Math.max(u[2],o);var L=c[b];if(e.length(L)>i&&(i=e.length(L)),b){var T=2*e.distance(m,u)/(e.length(l)+e.length(L));T?(_=Math.min(_,T),h=!1):h=!0}h||(m=u,l=L),w.push(L)}var k=[x,v,y],P=[p,f,o];r&&(r[0]=k,r[1]=P),i===0&&(i=1);var z=1/i;isFinite(_)||(_=1),s.vectorScale=_;var I=n.coneSize||.5;n.absoluteConeSize&&(I=n.absoluteConeSize*z),s.coneScale=I;for(var b=0,D=0;b<t.length;b++)for(var u=t[b],R=u[0],O=u[1],F=u[2],N=w[b],G=e.length(N)*z,K=0,W=8;K<W;K++){s.positions.push([R,O,F,D++]),s.positions.push([R,O,F,D++]),s.positions.push([R,O,F,D++]),s.positions.push([R,O,F,D++]),s.positions.push([R,O,F,D++]),s.positions.push([R,O,F,D++]),s.vectors.push(N),s.vectors.push(N),s.vectors.push(N),s.vectors.push(N),s.vectors.push(N),s.vectors.push(N),s.vertexIntensity.push(G,G,G),s.vertexIntensity.push(G,G,G);var Y=s.positions.length;s.cells.push([Y-6,Y-5,Y-4],[Y-3,Y-2,Y-1])}return s};var a=g("./lib/shaders");S.exports.createMesh=g("./create_mesh"),S.exports.createConeMesh=function(n,r){return S.exports.createMesh(n,r,{shaders:a,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(g,S,M){var e=g("gl-shader"),a=g("gl-buffer"),n=g("gl-vao"),r=g("gl-texture2d"),t=g("gl-mat4/multiply"),c=g("gl-mat4/invert"),s=g("ndarray"),i=g("colormap"),x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function p(w,_,h,b,u,L,T,k,P,z,I){this.gl=w,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=_,this.dirty=!0,this.triShader=h,this.pickShader=b,this.trianglePositions=u,this.triangleVectors=L,this.triangleColors=k,this.triangleUVs=P,this.triangleIds=T,this.triangleVAO=z,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=I,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=x,this._view=x,this._projection=x,this._resolution=[1,1]}var v=p.prototype;v.isOpaque=function(){return this.opacity>=1},v.isTransparent=function(){return this.opacity<1},v.pickSlots=1,v.setPickBase=function(w){this.pickId=w};function f(w){for(var _=i({colormap:w,nshades:256,format:"rgba"}),h=new Uint8Array(256*4),b=0;b<256;++b){for(var u=_[b],L=0;L<3;++L)h[4*b+L]=u[L];h[4*b+3]=u[3]*255}return s(h,[256,256,4],[4,0,1])}function y(w){for(var _=w.length,h=new Array(_),b=0;b<_;++b)h[b]=w[b][2];return h}v.update=function(w){w=w||{};var _=this.gl;this.dirty=!0,"lightPosition"in w&&(this.lightPosition=w.lightPosition),"opacity"in w&&(this.opacity=w.opacity),"ambient"in w&&(this.ambientLight=w.ambient),"diffuse"in w&&(this.diffuseLight=w.diffuse),"specular"in w&&(this.specularLight=w.specular),"roughness"in w&&(this.roughness=w.roughness),"fresnel"in w&&(this.fresnel=w.fresnel),w.tubeScale!==void 0&&(this.tubeScale=w.tubeScale),w.vectorScale!==void 0&&(this.vectorScale=w.vectorScale),w.coneScale!==void 0&&(this.coneScale=w.coneScale),w.coneOffset!==void 0&&(this.coneOffset=w.coneOffset),w.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=_.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=_.LINEAR,this.texture.setPixels(f(w.colormap)),this.texture.generateMipmap());var h=w.cells,b=w.positions,u=w.vectors;if(!b||!h||!u)return;var L=[],T=[],k=[],P=[],z=[];this.cells=h,this.positions=b,this.vectors=u;var I=w.meshColor||[1,1,1,1],D=w.vertexIntensity,R=1/0,O=-1/0;if(D)if(w.vertexIntensityBounds)R=+w.vertexIntensityBounds[0],O=+w.vertexIntensityBounds[1];else for(var F=0;F<D.length;++F){var N=D[F];R=Math.min(R,N),O=Math.max(O,N)}else for(var F=0;F<b.length;++F){var N=b[F][2];R=Math.min(R,N),O=Math.max(O,N)}D?this.intensity=D:this.intensity=y(b),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var F=0;F<b.length;++F)for(var G=b[F],K=0;K<3;++K)isNaN(G[K])||!isFinite(G[K])||(this.bounds[0][K]=Math.min(this.bounds[0][K],G[K]),this.bounds[1][K]=Math.max(this.bounds[1][K],G[K]));var W=0;e:for(var F=0;F<h.length;++F){var Y=h[F];switch(Y.length){case 3:for(var K=0;K<3;++K)for(var re=Y[K],G=b[re],ue=0;ue<3;++ue)if(isNaN(G[ue])||!isFinite(G[ue]))continue e;for(var K=0;K<3;++K){var re=Y[2-K],G=b[re];L.push(G[0],G[1],G[2],G[3]);var j=u[re];T.push(j[0],j[1],j[2],j[3]||0);var q=I;q.length===3?k.push(q[0],q[1],q[2],1):k.push(q[0],q[1],q[2],q[3]);var V;D?V=[(D[re]-R)/(O-R),0]:V=[(G[2]-R)/(O-R),0],P.push(V[0],V[1]),z.push(F)}W+=1;break}}this.triangleCount=W,this.trianglePositions.update(L),this.triangleVectors.update(T),this.triangleColors.update(k),this.triangleUVs.update(P),this.triangleIds.update(new Uint32Array(z))},v.drawTransparent=v.draw=function(w){w=w||{};for(var _=this.gl,h=w.model||x,b=w.view||x,u=w.projection||x,L=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)L[0][T]=Math.max(L[0][T],this.clipBounds[0][T]),L[1][T]=Math.min(L[1][T],this.clipBounds[1][T]);var k={model:h,view:b,projection:u,inverseModel:x.slice(),clipBounds:L,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};k.inverseModel=c(k.inverseModel,k.model),_.disable(_.CULL_FACE),this.texture.bind(0);var P=new Array(16);t(P,k.view,k.model),t(P,k.projection,P),c(P,P);for(var T=0;T<3;++T)k.eyePosition[T]=P[12+T]/P[15];for(var z=P[15],T=0;T<3;++T)z+=this.lightPosition[T]*P[4*T+3];for(var T=0;T<3;++T){for(var I=P[12+T],D=0;D<3;++D)I+=P[4*D+T]*this.lightPosition[D];k.lightPosition[T]=I/z}if(this.triangleCount>0){var R=this.triShader;R.bind(),R.uniforms=k,this.triangleVAO.bind(),_.drawArrays(_.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()}},v.drawPick=function(w){w=w||{};for(var _=this.gl,h=w.model||x,b=w.view||x,u=w.projection||x,L=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)L[0][T]=Math.max(L[0][T],this.clipBounds[0][T]),L[1][T]=Math.min(L[1][T],this.clipBounds[1][T]);this._model=[].slice.call(h),this._view=[].slice.call(b),this._projection=[].slice.call(u),this._resolution=[_.drawingBufferWidth,_.drawingBufferHeight];var k={model:h,view:b,projection:u,clipBounds:L,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},P=this.pickShader;P.bind(),P.uniforms=k,this.triangleCount>0&&(this.triangleVAO.bind(),_.drawArrays(_.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind())},v.pick=function(w){if(!w||w.id!==this.pickId)return null;var _=w.value[0]+256*w.value[1]+65536*w.value[2],h=this.cells[_],b=this.positions[h[1]].slice(0,3),u={position:b,dataCoordinate:b,index:Math.floor(h[1]/48)};return this.traceType==="cone"?u.index=Math.floor(h[1]/48):this.traceType==="streamtube"&&(u.intensity=this.intensity[h[1]],u.velocity=this.vectors[h[1]].slice(0,3),u.divergence=this.vectors[h[1]][3],u.index=_),u},v.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()};function o(w,_){var h=e(w,_.meshShader.vertex,_.meshShader.fragment,null,_.meshShader.attributes);return h.attributes.position.location=0,h.attributes.color.location=2,h.attributes.uv.location=3,h.attributes.vector.location=4,h}function m(w,_){var h=e(w,_.pickShader.vertex,_.pickShader.fragment,null,_.pickShader.attributes);return h.attributes.position.location=0,h.attributes.id.location=1,h.attributes.vector.location=4,h}function l(w,_,h){var b=h.shaders;arguments.length===1&&(_=w,w=_.gl);var u=o(w,b),L=m(w,b),T=r(w,s(new Uint8Array([255,255,255,255]),[1,1,4]));T.generateMipmap(),T.minFilter=w.LINEAR_MIPMAP_LINEAR,T.magFilter=w.LINEAR;var k=a(w),P=a(w),z=a(w),I=a(w),D=a(w),R=n(w,[{buffer:k,type:w.FLOAT,size:4},{buffer:D,type:w.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:z,type:w.FLOAT,size:4},{buffer:I,type:w.FLOAT,size:2},{buffer:P,type:w.FLOAT,size:4}]),O=new p(w,T,u,L,k,P,D,z,I,R,h.traceType||"cone");return O.update(_),O}S.exports=l},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(g,S,M){var e=g("glslify"),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),r=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),t=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);M.meshShader={vertex:a,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},M.pickShader={vertex:r,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(g,S,M){S.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(g,S,M){var e=g("./1.0/numbers");S.exports=function(n){return e[n]}},{"./1.0/numbers":82}],84:[function(g,S,M){S.exports=p;var e=g("gl-buffer"),a=g("gl-vao"),n=g("./shaders/index"),r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(v,f,y,o){this.gl=v,this.shader=o,this.buffer=f,this.vao=y,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var c=t.prototype;c.isOpaque=function(){return!this.hasAlpha},c.isTransparent=function(){return this.hasAlpha},c.drawTransparent=c.draw=function(v){var f=this.gl,y=this.shader.uniforms;this.shader.bind();var o=y.view=v.view||r,m=y.projection=v.projection||r;y.model=v.model||r,y.clipBounds=this.clipBounds,y.opacity=this.opacity;var l=o[12],w=o[13],_=o[14],h=o[15],b=v._ortho||!1,u=b?2:1,L=u*this.pixelRatio*(m[3]*l+m[7]*w+m[11]*_+m[15]*h)/f.drawingBufferHeight;this.vao.bind();for(var T=0;T<3;++T)f.lineWidth(this.lineWidth[T]*this.pixelRatio),y.capSize=this.capSize[T]*L,this.lineCount[T]&&f.drawArrays(f.LINES,this.lineOffset[T],this.lineCount[T]);this.vao.unbind()};function s(v,f){for(var y=0;y<3;++y)v[0][y]=Math.min(v[0][y],f[y]),v[1][y]=Math.max(v[1][y],f[y])}var i=function(){for(var v=new Array(3),f=0;f<3;++f){for(var y=[],o=1;o<=2;++o)for(var m=-1;m<=1;m+=2){var l=(o+f)%3,w=[0,0,0];w[l]=m,y.push(w)}v[f]=y}return v}();function x(v,f,y,o){for(var m=i[o],l=0;l<m.length;++l){var w=m[l];v.push(f[0],f[1],f[2],y[0],y[1],y[2],y[3],w[0],w[1],w[2])}return m.length}c.update=function(v){v=v||{},"lineWidth"in v&&(this.lineWidth=v.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in v&&(this.capSize=v.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in v&&(this.opacity=+v.opacity,this.opacity<1&&(this.hasAlpha=!0));var f=v.color||[[0,0,0],[0,0,0],[0,0,0]],y=v.position,o=v.error;if(Array.isArray(f[0])||(f=[f,f,f]),y&&o){var m=[],l=y.length,w=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var _=0;_<3;++_){this.lineOffset[_]=w;e:for(var h=0;h<l;++h){for(var b=y[h],u=0;u<3;++u)if(isNaN(b[u])||!isFinite(b[u]))continue e;var L=o[h],T=f[_];if(Array.isArray(T[0])&&(T=f[h]),T.length===3?T=[T[0],T[1],T[2],1]:T.length===4&&(T=[T[0],T[1],T[2],T[3]],!this.hasAlpha&&T[3]<1&&(this.hasAlpha=!0)),!(isNaN(L[0][_])||isNaN(L[1][_]))){if(L[0][_]<0){var k=b.slice();k[_]+=L[0][_],m.push(b[0],b[1],b[2],T[0],T[1],T[2],T[3],0,0,0,k[0],k[1],k[2],T[0],T[1],T[2],T[3],0,0,0),s(this.bounds,k),w+=2+x(m,k,T,_)}if(L[1][_]>0){var k=b.slice();k[_]+=L[1][_],m.push(b[0],b[1],b[2],T[0],T[1],T[2],T[3],0,0,0,k[0],k[1],k[2],T[0],T[1],T[2],T[3],0,0,0),s(this.bounds,k),w+=2+x(m,k,T,_)}}}this.lineCount[_]=w-this.lineOffset[_]}this.buffer.update(m)}},c.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()};function p(v){var f=v.gl,y=e(f),o=a(f,[{buffer:y,type:f.FLOAT,size:3,offset:0,stride:40},{buffer:y,type:f.FLOAT,size:4,offset:12,stride:40},{buffer:y,type:f.FLOAT,size:3,offset:28,stride:40}]),m=n(f);m.attributes.position.location=0,m.attributes.color.location=1,m.attributes.offset.location=2;var l=new t(f,y,o,m);return l.update(v),l}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(g,S,M){var e=g("glslify"),a=g("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);S.exports=function(t){return a(t,n,r,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(g,S,M){var e=g("gl-texture2d");S.exports=w;var a=null,n,r,t,c;function s(_){var h=_.getParameter(_.FRAMEBUFFER_BINDING),b=_.getParameter(_.RENDERBUFFER_BINDING),u=_.getParameter(_.TEXTURE_BINDING_2D);return[h,b,u]}function i(_,h){_.bindFramebuffer(_.FRAMEBUFFER,h[0]),_.bindRenderbuffer(_.RENDERBUFFER,h[1]),_.bindTexture(_.TEXTURE_2D,h[2])}function x(_,h){var b=_.getParameter(h.MAX_COLOR_ATTACHMENTS_WEBGL);a=new Array(b+1);for(var u=0;u<=b;++u){for(var L=new Array(b),T=0;T<u;++T)L[T]=_.COLOR_ATTACHMENT0+T;for(var T=u;T<b;++T)L[T]=_.NONE;a[u]=L}}function p(_){switch(_){case n:throw new Error("gl-fbo: Framebuffer unsupported");case r:throw new Error("gl-fbo: Framebuffer incomplete attachment");case t:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case c:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function v(_,h,b,u,L,T){if(!u)return null;var k=e(_,h,b,L,u);return k.magFilter=_.NEAREST,k.minFilter=_.NEAREST,k.mipSamples=1,k.bind(),_.framebufferTexture2D(_.FRAMEBUFFER,T,_.TEXTURE_2D,k.handle,0),k}function f(_,h,b,u,L){var T=_.createRenderbuffer();return _.bindRenderbuffer(_.RENDERBUFFER,T),_.renderbufferStorage(_.RENDERBUFFER,u,h,b),_.framebufferRenderbuffer(_.FRAMEBUFFER,L,_.RENDERBUFFER,T),T}function y(_){var h=s(_.gl),b=_.gl,u=_.handle=b.createFramebuffer(),L=_._shape[0],T=_._shape[1],k=_.color.length,P=_._ext,z=_._useStencil,I=_._useDepth,D=_._colorType;b.bindFramebuffer(b.FRAMEBUFFER,u);for(var R=0;R<k;++R)_.color[R]=v(b,L,T,D,b.RGBA,b.COLOR_ATTACHMENT0+R);k===0?(_._color_rb=f(b,L,T,b.RGBA4,b.COLOR_ATTACHMENT0),P&&P.drawBuffersWEBGL(a[0])):k>1&&P.drawBuffersWEBGL(a[k]);var O=b.getExtension("WEBGL_depth_texture");O?z?_.depth=v(b,L,T,O.UNSIGNED_INT_24_8_WEBGL,b.DEPTH_STENCIL,b.DEPTH_STENCIL_ATTACHMENT):I&&(_.depth=v(b,L,T,b.UNSIGNED_SHORT,b.DEPTH_COMPONENT,b.DEPTH_ATTACHMENT)):I&&z?_._depth_rb=f(b,L,T,b.DEPTH_STENCIL,b.DEPTH_STENCIL_ATTACHMENT):I?_._depth_rb=f(b,L,T,b.DEPTH_COMPONENT16,b.DEPTH_ATTACHMENT):z&&(_._depth_rb=f(b,L,T,b.STENCIL_INDEX,b.STENCIL_ATTACHMENT));var F=b.checkFramebufferStatus(b.FRAMEBUFFER);if(F!==b.FRAMEBUFFER_COMPLETE){_._destroyed=!0,b.bindFramebuffer(b.FRAMEBUFFER,null),b.deleteFramebuffer(_.handle),_.handle=null,_.depth&&(_.depth.dispose(),_.depth=null),_._depth_rb&&(b.deleteRenderbuffer(_._depth_rb),_._depth_rb=null);for(var R=0;R<_.color.length;++R)_.color[R].dispose(),_.color[R]=null;_._color_rb&&(b.deleteRenderbuffer(_._color_rb),_._color_rb=null),i(b,h),p(F)}i(b,h)}function o(_,h,b,u,L,T,k,P){this.gl=_,this._shape=[h|0,b|0],this._destroyed=!1,this._ext=P,this.color=new Array(L);for(var z=0;z<L;++z)this.color[z]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=u,this._useDepth=T,this._useStencil=k;var I=this,D=[h|0,b|0];Object.defineProperties(D,{0:{get:function(){return I._shape[0]},set:function(R){return I.width=R}},1:{get:function(){return I._shape[1]},set:function(R){return I.height=R}}}),this._shapeVector=D,y(this)}var m=o.prototype;function l(_,h,b){if(_._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(!(_._shape[0]===h&&_._shape[1]===b)){var u=_.gl,L=u.getParameter(u.MAX_RENDERBUFFER_SIZE);if(h<0||h>L||b<0||b>L)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");_._shape[0]=h,_._shape[1]=b;for(var T=s(u),k=0;k<_.color.length;++k)_.color[k].shape=_._shape;_._color_rb&&(u.bindRenderbuffer(u.RENDERBUFFER,_._color_rb),u.renderbufferStorage(u.RENDERBUFFER,u.RGBA4,_._shape[0],_._shape[1])),_.depth&&(_.depth.shape=_._shape),_._depth_rb&&(u.bindRenderbuffer(u.RENDERBUFFER,_._depth_rb),_._useDepth&&_._useStencil?u.renderbufferStorage(u.RENDERBUFFER,u.DEPTH_STENCIL,_._shape[0],_._shape[1]):_._useDepth?u.renderbufferStorage(u.RENDERBUFFER,u.DEPTH_COMPONENT16,_._shape[0],_._shape[1]):_._useStencil&&u.renderbufferStorage(u.RENDERBUFFER,u.STENCIL_INDEX,_._shape[0],_._shape[1])),u.bindFramebuffer(u.FRAMEBUFFER,_.handle);var P=u.checkFramebufferStatus(u.FRAMEBUFFER);P!==u.FRAMEBUFFER_COMPLETE&&(_.dispose(),i(u,T),p(P)),i(u,T)}}Object.defineProperties(m,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(_){if(Array.isArray(_)||(_=[_|0,_|0]),_.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var h=_[0]|0,b=_[1]|0;return l(this,h,b),[h,b]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(_){return _=_|0,l(this,_,this._shape[1]),_},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(_){return _=_|0,l(this,this._shape[0],_),_},enumerable:!1}}),m.bind=function(){if(!this._destroyed){var _=this.gl;_.bindFramebuffer(_.FRAMEBUFFER,this.handle),_.viewport(0,0,this._shape[0],this._shape[1])}},m.dispose=function(){if(!this._destroyed){this._destroyed=!0;var _=this.gl;_.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(_.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var h=0;h<this.color.length;++h)this.color[h].dispose(),this.color[h]=null;this._color_rb&&(_.deleteRenderbuffer(this._color_rb),this._color_rb=null)}};function w(_,h,b,u){n||(n=_.FRAMEBUFFER_UNSUPPORTED,r=_.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,t=_.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,c=_.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var L=_.getExtension("WEBGL_draw_buffers");if(!a&&L&&x(_,L),Array.isArray(h)&&(u=b,b=h[1]|0,h=h[0]|0),typeof h!="number")throw new Error("gl-fbo: Missing shape parameter");var T=_.getParameter(_.MAX_RENDERBUFFER_SIZE);if(h<0||h>T||b<0||b>T)throw new Error("gl-fbo: Parameters are too large for FBO");u=u||{};var k=1;if("color"in u){if(k=Math.max(u.color|0,0),k<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(k>1)if(L){if(k>_.getParameter(L.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+k+" draw buffers")}else throw new Error("gl-fbo: Multiple draw buffer extension not supported")}var P=_.UNSIGNED_BYTE,z=_.getExtension("OES_texture_float");if(u.float&&k>0){if(!z)throw new Error("gl-fbo: Context does not support floating point textures");P=_.FLOAT}else u.preferFloat&&k>0&&z&&(P=_.FLOAT);var I=!0;"depth"in u&&(I=!!u.depth);var D=!1;return"stencil"in u&&(D=!!u.stencil),new o(_,h,b,P,k,I,D,L)}},{"gl-texture2d":146}],87:[function(g,S,M){var e=g("sprintf-js").sprintf,a=g("gl-constants/lookup"),n=g("glsl-shader-name"),r=g("add-line-numbers");S.exports=t;function t(c,s,i){var x=n(s)||"of unknown name (see npm glsl-shader-name)",p="unknown type";i!==void 0&&(p=i===a.FRAGMENT_SHADER?"fragment":"vertex");for(var v=e(`Error compiling %s shader %s:
`,p,x),f=e("%s%s",v,c),y=c.split(`
`),o={},m=0;m<y.length;m++){var l=y[m];if(!(l===""||l==="\0")){var w=parseInt(l.split(":")[2]);if(isNaN(w))throw new Error(e("Could not parse error: %s",l));o[w]=l}}for(var _=r(s).split(`
`),m=0;m<_.length;m++)if(!(!o[m+3]&&!o[m+2]&&!o[m+1])){var h=_[m];if(v+=h+`
`,o[m+1]){var b=o[m+1];b=b.substr(b.split(":",3).join(":").length+1).trim(),v+=e(`^^^ %s

`,b)}}return{long:v.trim(),short:f.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(g,S,M){S.exports=p;var e=g("binary-search-bounds"),a=g("iota-array"),n=g("typedarray-pool"),r=g("gl-shader"),t=g("gl-buffer"),c=g("./lib/shaders");function s(v,f,y,o,m,l,w){this.plot=v,this.shader=f,this.pickShader=y,this.positionBuffer=o,this.weightBuffer=m,this.colorBuffer=l,this.idBuffer=w,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var i=s.prototype,x=[0,0,1,0,0,1,1,0,1,1,0,1];i.draw=function(){var v=[1,0,0,0,1,0,0,0,1];return function(){var f=this.plot,y=this.shader,o=this.bounds,m=this.numVertices;if(!(m<=0)){var l=f.gl,w=f.dataBox,_=o[2]-o[0],h=o[3]-o[1],b=w[2]-w[0],u=w[3]-w[1];v[0]=2*_/b,v[4]=2*h/u,v[6]=2*(o[0]-w[0])/b-1,v[7]=2*(o[1]-w[1])/u-1,y.bind();var L=y.uniforms;L.viewTransform=v,L.shape=this.shape;var T=y.attributes;this.positionBuffer.bind(),T.position.pointer(),this.weightBuffer.bind(),T.weight.pointer(l.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),T.color.pointer(l.UNSIGNED_BYTE,!0),l.drawArrays(l.TRIANGLES,0,m)}}}(),i.drawPick=function(){var v=[1,0,0,0,1,0,0,0,1],f=[0,0,0,0];return function(y){var o=this.plot,m=this.pickShader,l=this.bounds,w=this.numVertices;if(!(w<=0)){var _=o.gl,h=o.dataBox,b=l[2]-l[0],u=l[3]-l[1],L=h[2]-h[0],T=h[3]-h[1];v[0]=2*b/L,v[4]=2*u/T,v[6]=2*(l[0]-h[0])/L-1,v[7]=2*(l[1]-h[1])/T-1;for(var k=0;k<4;++k)f[k]=y>>k*8&255;this.pickOffset=y,m.bind();var P=m.uniforms;P.viewTransform=v,P.pickOffset=f,P.shape=this.shape;var z=m.attributes;return this.positionBuffer.bind(),z.position.pointer(),this.weightBuffer.bind(),z.weight.pointer(_.UNSIGNED_BYTE,!1),this.idBuffer.bind(),z.pickId.pointer(_.UNSIGNED_BYTE,!1),_.drawArrays(_.TRIANGLES,0,w),y+this.shape[0]*this.shape[1]}}}(),i.pick=function(v,f,y){var o=this.pickOffset,m=this.shape[0]*this.shape[1];if(y<o||y>=o+m)return null;var l=y-o,w=this.xData,_=this.yData;return{object:this,pointId:l,dataCoord:[w[l%this.shape[0]],_[l/this.shape[0]|0]]}},i.update=function(v){v=v||{};var f=v.shape||[0,0],y=v.x||a(f[0]),o=v.y||a(f[1]),m=v.z||new Float32Array(f[0]*f[1]),l=v.zsmooth!==!1;this.xData=y,this.yData=o;var w=v.colorLevels||[0],_=v.colorValues||[0,0,0,1],h=w.length,b=this.bounds,u,L,T,k;l?(u=b[0]=y[0],L=b[1]=o[0],T=b[2]=y[y.length-1],k=b[3]=o[o.length-1]):(u=b[0]=y[0]+(y[1]-y[0])/2,L=b[1]=o[0]+(o[1]-o[0])/2,T=b[2]=y[y.length-1]+(y[y.length-1]-y[y.length-2])/2,k=b[3]=o[o.length-1]+(o[o.length-1]-o[o.length-2])/2);var P=1/(T-u),z=1/(k-L),I=f[0],D=f[1];this.shape=[I,D];var R=(l?(I-1)*(D-1):I*D)*(x.length>>>1);this.numVertices=R;for(var O=n.mallocUint8(R*4),F=n.mallocFloat32(R*2),N=n.mallocUint8(R*2),G=n.mallocUint32(R),K=0,W=l?I-1:I,Y=l?D-1:D,re=0;re<Y;++re){var ue,j;l?(ue=z*(o[re]-L),j=z*(o[re+1]-L)):(ue=re<D-1?z*(o[re]-(o[re+1]-o[re])/2-L):z*(o[re]-(o[re]-o[re-1])/2-L),j=re<D-1?z*(o[re]+(o[re+1]-o[re])/2-L):z*(o[re]+(o[re]-o[re-1])/2-L));for(var q=0;q<W;++q){var V,U;l?(V=P*(y[q]-u),U=P*(y[q+1]-u)):(V=q<I-1?P*(y[q]-(y[q+1]-y[q])/2-u):P*(y[q]-(y[q]-y[q-1])/2-u),U=q<I-1?P*(y[q]+(y[q+1]-y[q])/2-u):P*(y[q]+(y[q]-y[q-1])/2-u));for(var $=0;$<x.length;$+=2){var ne=x[$],X=x[$+1],Q=l?(re+X)*I+(q+ne):re*I+q,ie=m[Q],se=e.le(w,ie),ae,oe,be,ce;if(se<0)ae=_[0],oe=_[1],be=_[2],ce=_[3];else if(se===h-1)ae=_[4*h-4],oe=_[4*h-3],be=_[4*h-2],ce=_[4*h-1];else{var de=(ie-w[se])/(w[se+1]-w[se]),ye=1-de,ge=4*se,me=4*(se+1);ae=ye*_[ge]+de*_[me],oe=ye*_[ge+1]+de*_[me+1],be=ye*_[ge+2]+de*_[me+2],ce=ye*_[ge+3]+de*_[me+3]}O[4*K]=255*ae,O[4*K+1]=255*oe,O[4*K+2]=255*be,O[4*K+3]=255*ce,F[2*K]=V*.5+U*.5,F[2*K+1]=ue*.5+j*.5,N[2*K]=ne,N[2*K+1]=X,G[K]=re*I+q,K+=1}}}this.positionBuffer.update(F),this.weightBuffer.update(N),this.colorBuffer.update(O),this.idBuffer.update(G),n.free(F),n.free(O),n.free(N),n.free(G)},i.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)};function p(v,f){var y=v.gl,o=r(y,c.vertex,c.fragment),m=r(y,c.pickVertex,c.pickFragment),l=t(y),w=t(y),_=t(y),h=t(y),b=new s(v,o,m,l,w,_,h);return b.update(f),v.addObject(b),b}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(g,S,M){var e=g("glslify");S.exports={fragment:e([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:231}],90:[function(g,S,M){var e=g("glslify"),a=g("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),t=e([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),c=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];M.createShader=function(s){return a(s,n,r,null,c)},M.createPickShader=function(s){return a(s,n,t,null,c)}},{"gl-shader":132,glslify:231}],91:[function(g,S,M){S.exports=_;var e=g("gl-buffer"),a=g("gl-vao"),n=g("gl-texture2d"),r=new Uint8Array(4),t=new Float32Array(r.buffer);function c(h,b,u,L){return r[0]=L,r[1]=u,r[2]=b,r[3]=h,t[0]}var s=g("binary-search-bounds"),i=g("ndarray"),x=g("./lib/shaders"),p=x.createShader,v=x.createPickShader,f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function y(h,b){for(var u=0,L=0;L<3;++L){var T=h[L]-b[L];u+=T*T}return Math.sqrt(u)}function o(h){for(var b=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],u=0;u<3;++u)b[0][u]=Math.max(h[0][u],b[0][u]),b[1][u]=Math.min(h[1][u],b[1][u]);return b}function m(h,b,u,L){this.arcLength=h,this.position=b,this.index=u,this.dataCoordinate=L}function l(h,b,u,L,T,k){this.gl=h,this.shader=b,this.pickShader=u,this.buffer=L,this.vao=T,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=k,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var w=l.prototype;w.isTransparent=function(){return this.hasAlpha},w.isOpaque=function(){return!this.hasAlpha},w.pickSlots=1,w.setPickBase=function(h){this.pickId=h},w.drawTransparent=w.draw=function(h){if(!!this.vertexCount){var b=this.gl,u=this.shader,L=this.vao;u.bind(),u.uniforms={model:h.model||f,view:h.view||f,projection:h.projection||f,clipBounds:o(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},L.bind(),L.draw(b.TRIANGLE_STRIP,this.vertexCount),L.unbind()}},w.drawPick=function(h){if(!!this.vertexCount){var b=this.gl,u=this.pickShader,L=this.vao;u.bind(),u.uniforms={model:h.model||f,view:h.view||f,projection:h.projection||f,pickId:this.pickId,clipBounds:o(this.clipBounds),screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},L.bind(),L.draw(b.TRIANGLE_STRIP,this.vertexCount),L.unbind()}},w.update=function(h){var b,u;this.dirty=!0;var L=!!h.connectGaps;"dashScale"in h&&(this.dashScale=h.dashScale),this.hasAlpha=!1,"opacity"in h&&(this.opacity=+h.opacity,this.opacity<1&&(this.hasAlpha=!0));var T=[],k=[],P=[],z=0,I=0,D=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],R=h.position||h.positions;if(R){var O=h.color||h.colors||[0,0,0,1],F=h.lineWidth||1,N=!1;e:for(b=1;b<R.length;++b){var G=R[b-1],K=R[b];for(k.push(z),P.push(G.slice()),u=0;u<3;++u){if(isNaN(G[u])||isNaN(K[u])||!isFinite(G[u])||!isFinite(K[u])){if(!L&&T.length>0){for(var W=0;W<24;++W)T.push(T[T.length-12]);I+=2,N=!0}continue e}D[0][u]=Math.min(D[0][u],G[u],K[u]),D[1][u]=Math.max(D[1][u],G[u],K[u])}var Y,re;Array.isArray(O[0])?(Y=O.length>b-1?O[b-1]:O.length>0?O[O.length-1]:[0,0,0,1],re=O.length>b?O[b]:O.length>0?O[O.length-1]:[0,0,0,1]):Y=re=O,Y.length===3&&(Y=[Y[0],Y[1],Y[2],1]),re.length===3&&(re=[re[0],re[1],re[2],1]),!this.hasAlpha&&Y[3]<1&&(this.hasAlpha=!0);var ue;Array.isArray(F)?ue=F.length>b-1?F[b-1]:F.length>0?F[F.length-1]:[0,0,0,1]:ue=F;var j=z;if(z+=y(G,K),N){for(u=0;u<2;++u)T.push(G[0],G[1],G[2],K[0],K[1],K[2],j,ue,Y[0],Y[1],Y[2],Y[3]);I+=2,N=!1}T.push(G[0],G[1],G[2],K[0],K[1],K[2],j,ue,Y[0],Y[1],Y[2],Y[3],G[0],G[1],G[2],K[0],K[1],K[2],j,-ue,Y[0],Y[1],Y[2],Y[3],K[0],K[1],K[2],G[0],G[1],G[2],z,-ue,re[0],re[1],re[2],re[3],K[0],K[1],K[2],G[0],G[1],G[2],z,ue,re[0],re[1],re[2],re[3]),I+=4}}if(this.buffer.update(T),k.push(z),P.push(R[R.length-1].slice()),this.bounds=D,this.vertexCount=I,this.points=P,this.arcLength=k,"dashes"in h){var q=h.dashes,V=q.slice();for(V.unshift(0),b=1;b<V.length;++b)V[b]=V[b-1]+V[b];var U=i(new Array(256*4),[256,1,4]);for(b=0;b<256;++b){for(u=0;u<4;++u)U.set(b,0,u,0);s.le(V,V[V.length-1]*b/255)&1?U.set(b,0,0,0):U.set(b,0,0,255)}this.texture.setPixels(U)}},w.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},w.pick=function(h){if(!h||h.id!==this.pickId)return null;var b=c(h.value[0],h.value[1],h.value[2],0),u=s.le(this.arcLength,b);if(u<0)return null;if(u===this.arcLength.length-1)return new m(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),u);for(var L=this.points[u],T=this.points[Math.min(u+1,this.points.length-1)],k=(b-this.arcLength[u])/(this.arcLength[u+1]-this.arcLength[u]),P=1-k,z=[0,0,0],I=0;I<3;++I)z[I]=P*L[I]+k*T[I];var D=Math.min(k<.5?u:u+1,this.points.length-1);return new m(b,z,D,this.points[D])};function _(h){var b=h.gl||h.scene&&h.scene.gl,u=p(b);u.attributes.position.location=0,u.attributes.nextPosition.location=1,u.attributes.arcLength.location=2,u.attributes.lineWidth.location=3,u.attributes.color.location=4;var L=v(b);L.attributes.position.location=0,L.attributes.nextPosition.location=1,L.attributes.arcLength.location=2,L.attributes.lineWidth.location=3,L.attributes.color.location=4;for(var T=e(b),k=a(b,[{buffer:T,size:3,offset:0,stride:48},{buffer:T,size:3,offset:12,stride:48},{buffer:T,size:1,offset:24,stride:48},{buffer:T,size:1,offset:28,stride:48},{buffer:T,size:4,offset:32,stride:48}]),P=i(new Array(256*4),[256,1,4]),z=0;z<256*4;++z)P.data[z]=255;var I=n(b,P);I.wrap=b.REPEAT;var D=new l(b,u,L,T,k,I);return D.update(h),D}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(g,S,M){S.exports=e;function e(a){var n=new Float32Array(16);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[5],n[6]=a[6],n[7]=a[7],n[8]=a[8],n[9]=a[9],n[10]=a[10],n[11]=a[11],n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15],n}},{}],93:[function(g,S,M){S.exports=e;function e(){var a=new Float32Array(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],94:[function(g,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2],c=a[3],s=a[4],i=a[5],x=a[6],p=a[7],v=a[8],f=a[9],y=a[10],o=a[11],m=a[12],l=a[13],w=a[14],_=a[15],h=n*i-r*s,b=n*x-t*s,u=n*p-c*s,L=r*x-t*i,T=r*p-c*i,k=t*p-c*x,P=v*l-f*m,z=v*w-y*m,I=v*_-o*m,D=f*w-y*l,R=f*_-o*l,O=y*_-o*w;return h*O-b*R+u*D+L*I-T*z+k*P}},{}],95:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0],t=n[1],c=n[2],s=n[3],i=r+r,x=t+t,p=c+c,v=r*i,f=t*i,y=t*x,o=c*i,m=c*x,l=c*p,w=s*i,_=s*x,h=s*p;return a[0]=1-y-l,a[1]=f+h,a[2]=o-_,a[3]=0,a[4]=f-h,a[5]=1-v-l,a[6]=m+w,a[7]=0,a[8]=o+_,a[9]=m-w,a[10]=1-v-y,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],96:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],s=n[2],i=n[3],x=t+t,p=c+c,v=s+s,f=t*x,y=t*p,o=t*v,m=c*p,l=c*v,w=s*v,_=i*x,h=i*p,b=i*v;return a[0]=1-(m+w),a[1]=y+b,a[2]=o-h,a[3]=0,a[4]=y-b,a[5]=1-(f+w),a[6]=l+_,a[7]=0,a[8]=o+h,a[9]=l-_,a[10]=1-(f+m),a[11]=0,a[12]=r[0],a[13]=r[1],a[14]=r[2],a[15]=1,a}},{}],97:[function(g,S,M){S.exports=e;function e(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],98:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0],t=n[1],c=n[2],s=n[3],i=n[4],x=n[5],p=n[6],v=n[7],f=n[8],y=n[9],o=n[10],m=n[11],l=n[12],w=n[13],_=n[14],h=n[15],b=r*x-t*i,u=r*p-c*i,L=r*v-s*i,T=t*p-c*x,k=t*v-s*x,P=c*v-s*p,z=f*w-y*l,I=f*_-o*l,D=f*h-m*l,R=y*_-o*w,O=y*h-m*w,F=o*h-m*_,N=b*F-u*O+L*R+T*D-k*I+P*z;return N?(N=1/N,a[0]=(x*F-p*O+v*R)*N,a[1]=(c*O-t*F-s*R)*N,a[2]=(w*P-_*k+h*T)*N,a[3]=(o*k-y*P-m*T)*N,a[4]=(p*D-i*F-v*I)*N,a[5]=(r*F-c*D+s*I)*N,a[6]=(_*L-l*P-h*u)*N,a[7]=(f*P-o*L+m*u)*N,a[8]=(i*O-x*D+v*z)*N,a[9]=(t*D-r*O-s*z)*N,a[10]=(l*k-w*L+h*b)*N,a[11]=(y*L-f*k-m*b)*N,a[12]=(x*I-i*R-p*z)*N,a[13]=(r*R-t*I+c*z)*N,a[14]=(w*u-l*T-_*b)*N,a[15]=(f*T-y*u+o*b)*N,a):null}},{}],99:[function(g,S,M){var e=g("./identity");S.exports=a;function a(n,r,t,c){var s,i,x,p,v,f,y,o,m,l,w=r[0],_=r[1],h=r[2],b=c[0],u=c[1],L=c[2],T=t[0],k=t[1],P=t[2];return Math.abs(w-T)<1e-6&&Math.abs(_-k)<1e-6&&Math.abs(h-P)<1e-6?e(n):(y=w-T,o=_-k,m=h-P,l=1/Math.sqrt(y*y+o*o+m*m),y*=l,o*=l,m*=l,s=u*m-L*o,i=L*y-b*m,x=b*o-u*y,l=Math.sqrt(s*s+i*i+x*x),l?(l=1/l,s*=l,i*=l,x*=l):(s=0,i=0,x=0),p=o*x-m*i,v=m*s-y*x,f=y*i-o*s,l=Math.sqrt(p*p+v*v+f*f),l?(l=1/l,p*=l,v*=l,f*=l):(p=0,v=0,f=0),n[0]=s,n[1]=p,n[2]=y,n[3]=0,n[4]=i,n[5]=v,n[6]=o,n[7]=0,n[8]=x,n[9]=f,n[10]=m,n[11]=0,n[12]=-(s*w+i*_+x*h),n[13]=-(p*w+v*_+f*h),n[14]=-(y*w+o*_+m*h),n[15]=1,n)}},{"./identity":97}],100:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],s=n[2],i=n[3],x=n[4],p=n[5],v=n[6],f=n[7],y=n[8],o=n[9],m=n[10],l=n[11],w=n[12],_=n[13],h=n[14],b=n[15],u=r[0],L=r[1],T=r[2],k=r[3];return a[0]=u*t+L*x+T*y+k*w,a[1]=u*c+L*p+T*o+k*_,a[2]=u*s+L*v+T*m+k*h,a[3]=u*i+L*f+T*l+k*b,u=r[4],L=r[5],T=r[6],k=r[7],a[4]=u*t+L*x+T*y+k*w,a[5]=u*c+L*p+T*o+k*_,a[6]=u*s+L*v+T*m+k*h,a[7]=u*i+L*f+T*l+k*b,u=r[8],L=r[9],T=r[10],k=r[11],a[8]=u*t+L*x+T*y+k*w,a[9]=u*c+L*p+T*o+k*_,a[10]=u*s+L*v+T*m+k*h,a[11]=u*i+L*f+T*l+k*b,u=r[12],L=r[13],T=r[14],k=r[15],a[12]=u*t+L*x+T*y+k*w,a[13]=u*c+L*p+T*o+k*_,a[14]=u*s+L*v+T*m+k*h,a[15]=u*i+L*f+T*l+k*b,a}},{}],101:[function(g,S,M){S.exports=e;function e(a,n,r,t,c,s,i){var x=1/(n-r),p=1/(t-c),v=1/(s-i);return a[0]=-2*x,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*p,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*v,a[11]=0,a[12]=(n+r)*x,a[13]=(c+t)*p,a[14]=(i+s)*v,a[15]=1,a}},{}],102:[function(g,S,M){S.exports=e;function e(a,n,r,t,c){var s=1/Math.tan(n/2),i=1/(t-c);return a[0]=s/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(c+t)*i,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*c*t*i,a[15]=0,a}},{}],103:[function(g,S,M){S.exports=e;function e(a,n,r,t){var c=t[0],s=t[1],i=t[2],x=Math.sqrt(c*c+s*s+i*i),p,v,f,y,o,m,l,w,_,h,b,u,L,T,k,P,z,I,D,R,O,F,N,G;return Math.abs(x)<1e-6?null:(x=1/x,c*=x,s*=x,i*=x,p=Math.sin(r),v=Math.cos(r),f=1-v,y=n[0],o=n[1],m=n[2],l=n[3],w=n[4],_=n[5],h=n[6],b=n[7],u=n[8],L=n[9],T=n[10],k=n[11],P=c*c*f+v,z=s*c*f+i*p,I=i*c*f-s*p,D=c*s*f-i*p,R=s*s*f+v,O=i*s*f+c*p,F=c*i*f+s*p,N=s*i*f-c*p,G=i*i*f+v,a[0]=y*P+w*z+u*I,a[1]=o*P+_*z+L*I,a[2]=m*P+h*z+T*I,a[3]=l*P+b*z+k*I,a[4]=y*D+w*R+u*O,a[5]=o*D+_*R+L*O,a[6]=m*D+h*R+T*O,a[7]=l*D+b*R+k*O,a[8]=y*F+w*N+u*G,a[9]=o*F+_*N+L*G,a[10]=m*F+h*N+T*G,a[11]=l*F+b*N+k*G,n!==a&&(a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a)}},{}],104:[function(g,S,M){S.exports=e;function e(a,n,r){var t=Math.sin(r),c=Math.cos(r),s=n[4],i=n[5],x=n[6],p=n[7],v=n[8],f=n[9],y=n[10],o=n[11];return n!==a&&(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[4]=s*c+v*t,a[5]=i*c+f*t,a[6]=x*c+y*t,a[7]=p*c+o*t,a[8]=v*c-s*t,a[9]=f*c-i*t,a[10]=y*c-x*t,a[11]=o*c-p*t,a}},{}],105:[function(g,S,M){S.exports=e;function e(a,n,r){var t=Math.sin(r),c=Math.cos(r),s=n[0],i=n[1],x=n[2],p=n[3],v=n[8],f=n[9],y=n[10],o=n[11];return n!==a&&(a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=s*c-v*t,a[1]=i*c-f*t,a[2]=x*c-y*t,a[3]=p*c-o*t,a[8]=s*t+v*c,a[9]=i*t+f*c,a[10]=x*t+y*c,a[11]=p*t+o*c,a}},{}],106:[function(g,S,M){S.exports=e;function e(a,n,r){var t=Math.sin(r),c=Math.cos(r),s=n[0],i=n[1],x=n[2],p=n[3],v=n[4],f=n[5],y=n[6],o=n[7];return n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=s*c+v*t,a[1]=i*c+f*t,a[2]=x*c+y*t,a[3]=p*c+o*t,a[4]=v*c-s*t,a[5]=f*c-i*t,a[6]=y*c-x*t,a[7]=o*c-p*t,a}},{}],107:[function(g,S,M){S.exports=e;function e(a,n,r){var t=r[0],c=r[1],s=r[2];return a[0]=n[0]*t,a[1]=n[1]*t,a[2]=n[2]*t,a[3]=n[3]*t,a[4]=n[4]*c,a[5]=n[5]*c,a[6]=n[6]*c,a[7]=n[7]*c,a[8]=n[8]*s,a[9]=n[9]*s,a[10]=n[10]*s,a[11]=n[11]*s,a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a}},{}],108:[function(g,S,M){S.exports=e;function e(a,n,r){var t=r[0],c=r[1],s=r[2],i,x,p,v,f,y,o,m,l,w,_,h;return n===a?(a[12]=n[0]*t+n[4]*c+n[8]*s+n[12],a[13]=n[1]*t+n[5]*c+n[9]*s+n[13],a[14]=n[2]*t+n[6]*c+n[10]*s+n[14],a[15]=n[3]*t+n[7]*c+n[11]*s+n[15]):(i=n[0],x=n[1],p=n[2],v=n[3],f=n[4],y=n[5],o=n[6],m=n[7],l=n[8],w=n[9],_=n[10],h=n[11],a[0]=i,a[1]=x,a[2]=p,a[3]=v,a[4]=f,a[5]=y,a[6]=o,a[7]=m,a[8]=l,a[9]=w,a[10]=_,a[11]=h,a[12]=i*t+f*c+l*s+n[12],a[13]=x*t+y*c+w*s+n[13],a[14]=p*t+o*c+_*s+n[14],a[15]=v*t+m*c+h*s+n[15]),a}},{}],109:[function(g,S,M){S.exports=e;function e(a,n){if(a===n){var r=n[1],t=n[2],c=n[3],s=n[6],i=n[7],x=n[11];a[1]=n[4],a[2]=n[8],a[3]=n[12],a[4]=r,a[6]=n[9],a[7]=n[13],a[8]=t,a[9]=s,a[11]=n[14],a[12]=c,a[13]=i,a[14]=x}else a[0]=n[0],a[1]=n[4],a[2]=n[8],a[3]=n[12],a[4]=n[1],a[5]=n[5],a[6]=n[9],a[7]=n[13],a[8]=n[2],a[9]=n[6],a[10]=n[10],a[11]=n[14],a[12]=n[3],a[13]=n[7],a[14]=n[11],a[15]=n[15];return a}},{}],110:[function(g,S,M){var e=g("barycentric"),a=g("polytope-closest-point/lib/closest_point_2d.js");S.exports=s;function n(i,x){for(var p=[0,0,0,0],v=0;v<4;++v)for(var f=0;f<4;++f)p[f]+=i[4*v+f]*x[v];return p}function r(i,x,p,v,f){for(var y=n(v,n(p,n(x,[i[0],i[1],i[2],1]))),o=0;o<3;++o)y[o]/=y[3];return[.5*f[0]*(1+y[0]),.5*f[1]*(1-y[1])]}function t(i,x){if(i.length===2){for(var p=0,v=0,f=0;f<2;++f)p+=Math.pow(x[f]-i[0][f],2),v+=Math.pow(x[f]-i[1][f],2);return p=Math.sqrt(p),v=Math.sqrt(v),p+v<1e-6?[1,0]:[v/(p+v),p/(v+p)]}else if(i.length===3){var y=[0,0];return a(i[0],i[1],i[2],x,y),e(i,y)}return[]}function c(i,x){for(var p=[0,0,0],v=0;v<i.length;++v)for(var f=i[v],y=x[v],o=0;o<3;++o)p[o]+=y*f[o];return p}function s(i,x,p,v,f,y){if(i.length===1)return[0,i[0].slice()];for(var o=new Array(i.length),m=0;m<i.length;++m)o[m]=r(i[m],p,v,f,y);for(var l=0,w=1/0,m=0;m<o.length;++m){for(var _=0,h=0;h<2;++h)_+=Math.pow(o[m][h]-x[h],2);_<w&&(w=_,l=m)}for(var b=t(o,x),u=0,m=0;m<3;++m){if(b[m]<-.001||b[m]>1.0001)return null;u+=b[m]}return Math.abs(u-1)>.001?null:[l,c(i,b),b]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(g,S,M){var e=g("glslify"),a=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),t=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),c=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),s=e([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),i=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),x=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),p=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),v=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),f=e([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);M.meshShader={vertex:a,fragment:n,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},M.wireShader={vertex:r,fragment:t,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},M.pointShader={vertex:c,fragment:s,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},M.pickShader={vertex:i,fragment:x,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},M.pointPickShader={vertex:p,fragment:x,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},M.contourShader={vertex:v,fragment:f,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(g,S,M){var e=1e-6,a=1e-6,n=g("gl-shader"),r=g("gl-buffer"),t=g("gl-vao"),c=g("gl-texture2d"),s=g("normals"),i=g("gl-mat4/multiply"),x=g("gl-mat4/invert"),p=g("ndarray"),v=g("colormap"),f=g("simplicial-complex-contour"),y=g("typedarray-pool"),o=g("./lib/shaders"),m=g("./lib/closest-point"),l=o.meshShader,w=o.wireShader,_=o.pointShader,h=o.pickShader,b=o.pointPickShader,u=o.contourShader,L=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function T(W,Y,re,ue,j,q,V,U,$,ne,X,Q,ie,se,ae,oe,be,ce,de,ye,ge,me,Ee,Pe,Ne,we,ke){this.gl=W,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=Y,this.dirty=!0,this.triShader=re,this.lineShader=ue,this.pointShader=j,this.pickShader=q,this.pointPickShader=V,this.contourShader=U,this.trianglePositions=$,this.triangleColors=X,this.triangleNormals=ie,this.triangleUVs=Q,this.triangleIds=ne,this.triangleVAO=se,this.triangleCount=0,this.lineWidth=1,this.edgePositions=ae,this.edgeColors=be,this.edgeUVs=ce,this.edgeIds=oe,this.edgeVAO=de,this.edgeCount=0,this.pointPositions=ye,this.pointColors=me,this.pointUVs=Ee,this.pointSizes=Pe,this.pointIds=ge,this.pointVAO=Ne,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=we,this.contourVAO=ke,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=L,this._view=L,this._projection=L,this._resolution=[1,1]}var k=T.prototype;k.isOpaque=function(){return!this.hasAlpha},k.isTransparent=function(){return this.hasAlpha},k.pickSlots=1,k.setPickBase=function(W){this.pickId=W};function P(W,Y){if(!Y||!Y.length)return 1;for(var re=0;re<Y.length;++re){if(Y.length<2)return 1;if(Y[re][0]===W)return Y[re][1];if(Y[re][0]>W&&re>0){var ue=(Y[re][0]-W)/(Y[re][0]-Y[re-1][0]);return Y[re][1]*(1-ue)+ue*Y[re-1][1]}}return 1}function z(W,Y){for(var re=v({colormap:W,nshades:256,format:"rgba"}),ue=new Uint8Array(256*4),j=0;j<256;++j){for(var q=re[j],V=0;V<3;++V)ue[4*j+V]=q[V];Y?ue[4*j+3]=255*P(j/255,Y):ue[4*j+3]=255*q[3]}return p(ue,[256,256,4],[4,0,1])}function I(W){for(var Y=W.length,re=new Array(Y),ue=0;ue<Y;++ue)re[ue]=W[ue][2];return re}k.highlight=function(W){if(!W||!this.contourEnable){this.contourCount=0;return}for(var Y=f(this.cells,this.intensity,W.intensity),re=Y.cells,ue=Y.vertexIds,j=Y.vertexWeights,q=re.length,V=y.mallocFloat32(2*3*q),U=0,$=0;$<q;++$)for(var ne=re[$],X=0;X<2;++X){var Q=ne[0];ne.length===2&&(Q=ne[X]);for(var ie=ue[Q][0],se=ue[Q][1],ae=j[Q],oe=1-ae,be=this.positions[ie],ce=this.positions[se],de=0;de<3;++de)V[U++]=ae*be[de]+oe*ce[de]}this.contourCount=U/3|0,this.contourPositions.update(V.subarray(0,U)),y.free(V)},k.update=function(W){W=W||{};var Y=this.gl;this.dirty=!0,"contourEnable"in W&&(this.contourEnable=W.contourEnable),"contourColor"in W&&(this.contourColor=W.contourColor),"lineWidth"in W&&(this.lineWidth=W.lineWidth),"lightPosition"in W&&(this.lightPosition=W.lightPosition),this.hasAlpha=!1,"opacity"in W&&(this.opacity=W.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in W&&(this.opacityscale=W.opacityscale,this.hasAlpha=!0),"ambient"in W&&(this.ambientLight=W.ambient),"diffuse"in W&&(this.diffuseLight=W.diffuse),"specular"in W&&(this.specularLight=W.specular),"roughness"in W&&(this.roughness=W.roughness),"fresnel"in W&&(this.fresnel=W.fresnel),W.texture?(this.texture.dispose(),this.texture=c(Y,W.texture)):W.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=Y.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=Y.LINEAR,this.texture.setPixels(z(W.colormap,this.opacityscale)),this.texture.generateMipmap());var re=W.cells,ue=W.positions;if(!ue||!re)return;var j=[],q=[],V=[],U=[],$=[],ne=[],X=[],Q=[],ie=[],se=[],ae=[],oe=[],be=[],ce=[];this.cells=re,this.positions=ue;var de=W.vertexNormals,ye=W.cellNormals,ge=W.vertexNormalsEpsilon===void 0?e:W.vertexNormalsEpsilon,me=W.faceNormalsEpsilon===void 0?a:W.faceNormalsEpsilon;W.useFacetNormals&&!ye&&(ye=s.faceNormals(re,ue,me)),!ye&&!de&&(de=s.vertexNormals(re,ue,ge));var Ee=W.vertexColors,Pe=W.cellColors,Ne=W.meshColor||[1,1,1,1],we=W.vertexUVs,ke=W.vertexIntensity,Xe=W.cellUVs,He=W.cellIntensity,Ie=1/0,De=-1/0;if(!we&&!Xe)if(ke)if(W.vertexIntensityBounds)Ie=+W.vertexIntensityBounds[0],De=+W.vertexIntensityBounds[1];else for(var Ge=0;Ge<ke.length;++Ge){var ht=ke[Ge];Ie=Math.min(Ie,ht),De=Math.max(De,ht)}else if(He)if(W.cellIntensityBounds)Ie=+W.cellIntensityBounds[0],De=+W.cellIntensityBounds[1];else for(var Ge=0;Ge<He.length;++Ge){var ht=He[Ge];Ie=Math.min(Ie,ht),De=Math.max(De,ht)}else for(var Ge=0;Ge<ue.length;++Ge){var ht=ue[Ge][2];Ie=Math.min(Ie,ht),De=Math.max(De,ht)}ke?this.intensity=ke:He?this.intensity=He:this.intensity=I(ue),this.pickVertex=!(He||Pe);var Rt=W.pointSizes,Kt=W.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var Ge=0;Ge<ue.length;++Ge)for(var It=ue[Ge],Mt=0;Mt<3;++Mt)isNaN(It[Mt])||!isFinite(It[Mt])||(this.bounds[0][Mt]=Math.min(this.bounds[0][Mt],It[Mt]),this.bounds[1][Mt]=Math.max(this.bounds[1][Mt],It[Mt]));var Yt=0,zt=0,St=0;e:for(var Ge=0;Ge<re.length;++Ge){var Ye=re[Ge];switch(Ye.length){case 1:for(var rt=Ye[0],It=ue[rt],Mt=0;Mt<3;++Mt)if(isNaN(It[Mt])||!isFinite(It[Mt]))continue e;se.push(It[0],It[1],It[2]);var Ve;Ee?Ve=Ee[rt]:Pe?Ve=Pe[Ge]:Ve=Ne,this.opacityscale&&ke?q.push(Ve[0],Ve[1],Ve[2],this.opacity*P((ke[rt]-Ie)/(De-Ie),this.opacityscale)):Ve.length===3?ae.push(Ve[0],Ve[1],Ve[2],this.opacity):(ae.push(Ve[0],Ve[1],Ve[2],Ve[3]*this.opacity),Ve[3]<1&&(this.hasAlpha=!0));var Ae;we?Ae=we[rt]:ke?Ae=[(ke[rt]-Ie)/(De-Ie),0]:Xe?Ae=Xe[Ge]:He?Ae=[(He[Ge]-Ie)/(De-Ie),0]:Ae=[(It[2]-Ie)/(De-Ie),0],oe.push(Ae[0],Ae[1]),Rt?be.push(Rt[rt]):be.push(Kt),ce.push(Ge),St+=1;break;case 2:for(var Mt=0;Mt<2;++Mt)for(var rt=Ye[Mt],It=ue[rt],Ue=0;Ue<3;++Ue)if(isNaN(It[Ue])||!isFinite(It[Ue]))continue e;for(var Mt=0;Mt<2;++Mt){var rt=Ye[Mt],It=ue[rt];ne.push(It[0],It[1],It[2]);var Ve;Ee?Ve=Ee[rt]:Pe?Ve=Pe[Ge]:Ve=Ne,this.opacityscale&&ke?q.push(Ve[0],Ve[1],Ve[2],this.opacity*P((ke[rt]-Ie)/(De-Ie),this.opacityscale)):Ve.length===3?X.push(Ve[0],Ve[1],Ve[2],this.opacity):(X.push(Ve[0],Ve[1],Ve[2],Ve[3]*this.opacity),Ve[3]<1&&(this.hasAlpha=!0));var Ae;we?Ae=we[rt]:ke?Ae=[(ke[rt]-Ie)/(De-Ie),0]:Xe?Ae=Xe[Ge]:He?Ae=[(He[Ge]-Ie)/(De-Ie),0]:Ae=[(It[2]-Ie)/(De-Ie),0],Q.push(Ae[0],Ae[1]),ie.push(Ge)}zt+=1;break;case 3:for(var Mt=0;Mt<3;++Mt)for(var rt=Ye[Mt],It=ue[rt],Ue=0;Ue<3;++Ue)if(isNaN(It[Ue])||!isFinite(It[Ue]))continue e;for(var Mt=0;Mt<3;++Mt){var rt=Ye[2-Mt],It=ue[rt];j.push(It[0],It[1],It[2]);var Ve;Ee?Ve=Ee[rt]:Pe?Ve=Pe[Ge]:Ve=Ne,Ve?this.opacityscale&&ke?q.push(Ve[0],Ve[1],Ve[2],this.opacity*P((ke[rt]-Ie)/(De-Ie),this.opacityscale)):Ve.length===3?q.push(Ve[0],Ve[1],Ve[2],this.opacity):(q.push(Ve[0],Ve[1],Ve[2],Ve[3]*this.opacity),Ve[3]<1&&(this.hasAlpha=!0)):q.push(.5,.5,.5,1);var Ae;we?Ae=we[rt]:ke?Ae=[(ke[rt]-Ie)/(De-Ie),0]:Xe?Ae=Xe[Ge]:He?Ae=[(He[Ge]-Ie)/(De-Ie),0]:Ae=[(It[2]-Ie)/(De-Ie),0],U.push(Ae[0],Ae[1]);var Ze;de?Ze=de[rt]:Ze=ye[Ge],V.push(Ze[0],Ze[1],Ze[2]),$.push(Ge)}Yt+=1;break}}this.pointCount=St,this.edgeCount=zt,this.triangleCount=Yt,this.pointPositions.update(se),this.pointColors.update(ae),this.pointUVs.update(oe),this.pointSizes.update(be),this.pointIds.update(new Uint32Array(ce)),this.edgePositions.update(ne),this.edgeColors.update(X),this.edgeUVs.update(Q),this.edgeIds.update(new Uint32Array(ie)),this.trianglePositions.update(j),this.triangleColors.update(q),this.triangleUVs.update(U),this.triangleNormals.update(V),this.triangleIds.update(new Uint32Array($))},k.drawTransparent=k.draw=function(W){W=W||{};for(var Y=this.gl,re=W.model||L,ue=W.view||L,j=W.projection||L,q=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],V=0;V<3;++V)q[0][V]=Math.max(q[0][V],this.clipBounds[0][V]),q[1][V]=Math.min(q[1][V],this.clipBounds[1][V]);var U={model:re,view:ue,projection:j,inverseModel:L.slice(),clipBounds:q,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};U.inverseModel=x(U.inverseModel,U.model),Y.disable(Y.CULL_FACE),this.texture.bind(0);var $=new Array(16);i($,U.view,U.model),i($,U.projection,$),x($,$);for(var V=0;V<3;++V)U.eyePosition[V]=$[12+V]/$[15];for(var ne=$[15],V=0;V<3;++V)ne+=this.lightPosition[V]*$[4*V+3];for(var V=0;V<3;++V){for(var X=$[12+V],Q=0;Q<3;++Q)X+=$[4*Q+V]*this.lightPosition[Q];U.lightPosition[V]=X/ne}if(this.triangleCount>0){var ie=this.triShader;ie.bind(),ie.uniforms=U,this.triangleVAO.bind(),Y.drawArrays(Y.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var ie=this.lineShader;ie.bind(),ie.uniforms=U,this.edgeVAO.bind(),Y.lineWidth(this.lineWidth*this.pixelRatio),Y.drawArrays(Y.LINES,0,this.edgeCount*2),this.edgeVAO.unbind()}if(this.pointCount>0){var ie=this.pointShader;ie.bind(),ie.uniforms=U,this.pointVAO.bind(),Y.drawArrays(Y.POINTS,0,this.pointCount),this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var ie=this.contourShader;ie.bind(),ie.uniforms=U,this.contourVAO.bind(),Y.drawArrays(Y.LINES,0,this.contourCount),this.contourVAO.unbind()}},k.drawPick=function(W){W=W||{};for(var Y=this.gl,re=W.model||L,ue=W.view||L,j=W.projection||L,q=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],V=0;V<3;++V)q[0][V]=Math.max(q[0][V],this.clipBounds[0][V]),q[1][V]=Math.min(q[1][V],this.clipBounds[1][V]);this._model=[].slice.call(re),this._view=[].slice.call(ue),this._projection=[].slice.call(j),this._resolution=[Y.drawingBufferWidth,Y.drawingBufferHeight];var U={model:re,view:ue,projection:j,clipBounds:q,pickId:this.pickId/255},$=this.pickShader;if($.bind(),$.uniforms=U,this.triangleCount>0&&(this.triangleVAO.bind(),Y.drawArrays(Y.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),Y.lineWidth(this.lineWidth*this.pixelRatio),Y.drawArrays(Y.LINES,0,this.edgeCount*2),this.edgeVAO.unbind()),this.pointCount>0){var $=this.pointPickShader;$.bind(),$.uniforms=U,this.pointVAO.bind(),Y.drawArrays(Y.POINTS,0,this.pointCount),this.pointVAO.unbind()}},k.pick=function(W){if(!W||W.id!==this.pickId)return null;for(var Y=W.value[0]+256*W.value[1]+65536*W.value[2],re=this.cells[Y],ue=this.positions,j=new Array(re.length),q=0;q<re.length;++q)j[q]=ue[re[q]];var V=W.coord[0],U=W.coord[1];if(!this.pickVertex){var $=this.positions[re[0]],ne=this.positions[re[1]],X=this.positions[re[2]],Q=[($[0]+ne[0]+X[0])/3,($[1]+ne[1]+X[1])/3,($[2]+ne[2]+X[2])/3];return{_cellCenter:!0,position:[V,U],index:Y,cell:re,cellId:Y,intensity:this.intensity[Y],dataCoordinate:Q}}var ie=m(j,[V*this.pixelRatio,this._resolution[1]-U*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!ie)return null;for(var se=ie[2],ae=0,q=0;q<re.length;++q)ae+=se[q]*this.intensity[re[q]];return{position:ie[1],index:re[ie[0]],cell:re,cellId:Y,intensity:ae,dataCoordinate:this.positions[re[ie[0]]]}},k.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()};function D(W){var Y=n(W,l.vertex,l.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y.attributes.normal.location=4,Y}function R(W){var Y=n(W,w.vertex,w.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y}function O(W){var Y=n(W,_.vertex,_.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y.attributes.pointSize.location=4,Y}function F(W){var Y=n(W,h.vertex,h.fragment);return Y.attributes.position.location=0,Y.attributes.id.location=1,Y}function N(W){var Y=n(W,b.vertex,b.fragment);return Y.attributes.position.location=0,Y.attributes.id.location=1,Y.attributes.pointSize.location=4,Y}function G(W){var Y=n(W,u.vertex,u.fragment);return Y.attributes.position.location=0,Y}function K(W,Y){arguments.length===1&&(Y=W,W=Y.gl);var re=W.getExtension("OES_standard_derivatives")||W.getExtension("MOZ_OES_standard_derivatives")||W.getExtension("WEBKIT_OES_standard_derivatives");if(!re)throw new Error("derivatives not supported");var ue=D(W),j=R(W),q=O(W),V=F(W),U=N(W),$=G(W),ne=c(W,p(new Uint8Array([255,255,255,255]),[1,1,4]));ne.generateMipmap(),ne.minFilter=W.LINEAR_MIPMAP_LINEAR,ne.magFilter=W.LINEAR;var X=r(W),Q=r(W),ie=r(W),se=r(W),ae=r(W),oe=t(W,[{buffer:X,type:W.FLOAT,size:3},{buffer:ae,type:W.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:Q,type:W.FLOAT,size:4},{buffer:ie,type:W.FLOAT,size:2},{buffer:se,type:W.FLOAT,size:3}]),be=r(W),ce=r(W),de=r(W),ye=r(W),ge=t(W,[{buffer:be,type:W.FLOAT,size:3},{buffer:ye,type:W.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ce,type:W.FLOAT,size:4},{buffer:de,type:W.FLOAT,size:2}]),me=r(W),Ee=r(W),Pe=r(W),Ne=r(W),we=r(W),ke=t(W,[{buffer:me,type:W.FLOAT,size:3},{buffer:we,type:W.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:Ee,type:W.FLOAT,size:4},{buffer:Pe,type:W.FLOAT,size:2},{buffer:Ne,type:W.FLOAT,size:1}]),Xe=r(W),He=t(W,[{buffer:Xe,type:W.FLOAT,size:3}]),Ie=new T(W,ne,ue,j,q,V,U,$,X,ae,Q,ie,se,oe,be,ye,ce,de,ge,me,we,Ee,Pe,Ne,ke,Xe,He);return Ie.update(Y),Ie}S.exports=K},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(g,S,M){S.exports=c;var e=g("gl-buffer"),a=g("gl-shader"),n=g("./shaders");function r(s,i,x){this.plot=s,this.vbo=i,this.shader=x}var t=r.prototype;t.bind=function(){var s=this.shader;this.vbo.bind(),this.shader.bind(),s.attributes.coord.pointer(),s.uniforms.screenBox=this.plot.screenBox},t.drawBox=function(){var s=[0,0],i=[0,0];return function(x,p,v,f,y){var o=this.plot,m=this.shader,l=o.gl;s[0]=x,s[1]=p,i[0]=v,i[1]=f,m.uniforms.lo=s,m.uniforms.hi=i,m.uniforms.color=y,l.drawArrays(l.TRIANGLE_STRIP,0,4)}}(),t.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function c(s){var i=s.gl,x=e(i,[0,0,0,1,1,0,1,1]),p=a(i,n.boxVert,n.lineFrag);return new r(s,x,p)}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(g,S,M){S.exports=i;var e=g("gl-buffer"),a=g("gl-shader"),n=g("binary-search-bounds"),r=g("./shaders");function t(x,p,v,f){this.plot=x,this.vbo=p,this.shader=v,this.tickShader=f,this.ticks=[[],[]]}function c(x,p){return x-p}var s=t.prototype;s.draw=function(){var x=[0,0],p=[0,0],v=[0,0];return function(){for(var f=this.plot,y=this.vbo,o=this.shader,m=this.ticks,l=f.gl,w=f._tickBounds,_=f.dataBox,h=f.viewBox,b=f.gridLineWidth,u=f.gridLineColor,L=f.gridLineEnable,T=f.pixelRatio,k=0;k<2;++k){var P=w[k],z=w[k+2],I=z-P,D=.5*(_[k+2]+_[k]),R=_[k+2]-_[k];p[k]=2*I/R,x[k]=2*(P-D)/R}o.bind(),y.bind(),o.attributes.dataCoord.pointer(),o.uniforms.dataShift=x,o.uniforms.dataScale=p;for(var O=0,k=0;k<2;++k){v[0]=v[1]=0,v[k]=1,o.uniforms.dataAxis=v,o.uniforms.lineWidth=b[k]/(h[k+2]-h[k])*T,o.uniforms.color=u[k];var F=m[k].length*6;L[k]&&F&&l.drawArrays(l.TRIANGLES,O,F),O+=F}}}(),s.drawTickMarks=function(){var x=[0,0],p=[0,0],v=[1,0],f=[0,1],y=[0,0],o=[0,0];return function(){for(var m=this.plot,l=this.vbo,w=this.tickShader,_=this.ticks,h=m.gl,b=m._tickBounds,u=m.dataBox,L=m.viewBox,T=m.pixelRatio,k=m.screenBox,P=k[2]-k[0],z=k[3]-k[1],I=L[2]-L[0],D=L[3]-L[1],R=0;R<2;++R){var O=b[R],F=b[R+2],N=F-O,G=.5*(u[R+2]+u[R]),K=u[R+2]-u[R];p[R]=2*N/K,x[R]=2*(O-G)/K}p[0]*=I/P,x[0]*=I/P,p[1]*=D/z,x[1]*=D/z,w.bind(),l.bind(),w.attributes.dataCoord.pointer();var W=w.uniforms;W.dataShift=x,W.dataScale=p;var Y=m.tickMarkLength,re=m.tickMarkWidth,ue=m.tickMarkColor,j=0,q=_[0].length*6,V=Math.min(n.ge(_[0],(u[0]-b[0])/(b[2]-b[0]),c),_[0].length),U=Math.min(n.gt(_[0],(u[2]-b[0])/(b[2]-b[0]),c),_[0].length),$=j+6*V,ne=6*Math.max(0,U-V),X=Math.min(n.ge(_[1],(u[1]-b[1])/(b[3]-b[1]),c),_[1].length),Q=Math.min(n.gt(_[1],(u[3]-b[1])/(b[3]-b[1]),c),_[1].length),ie=q+6*X,se=6*Math.max(0,Q-X);y[0]=2*(L[0]-Y[1])/P-1,y[1]=(L[3]+L[1])/z-1,o[0]=Y[1]*T/P,o[1]=re[1]*T/z,se&&(W.color=ue[1],W.tickScale=o,W.dataAxis=f,W.screenOffset=y,h.drawArrays(h.TRIANGLES,ie,se)),y[0]=(L[2]+L[0])/P-1,y[1]=2*(L[1]-Y[0])/z-1,o[0]=re[0]*T/P,o[1]=Y[0]*T/z,ne&&(W.color=ue[0],W.tickScale=o,W.dataAxis=v,W.screenOffset=y,h.drawArrays(h.TRIANGLES,$,ne)),y[0]=2*(L[2]+Y[3])/P-1,y[1]=(L[3]+L[1])/z-1,o[0]=Y[3]*T/P,o[1]=re[3]*T/z,se&&(W.color=ue[3],W.tickScale=o,W.dataAxis=f,W.screenOffset=y,h.drawArrays(h.TRIANGLES,ie,se)),y[0]=(L[2]+L[0])/P-1,y[1]=2*(L[3]+Y[2])/z-1,o[0]=re[2]*T/P,o[1]=Y[2]*T/z,ne&&(W.color=ue[2],W.tickScale=o,W.dataAxis=v,W.screenOffset=y,h.drawArrays(h.TRIANGLES,$,ne))}}(),s.update=function(){var x=[1,1,-1,-1,1,-1],p=[1,-1,1,1,-1,-1];return function(v){var f=v.ticks,y=v.bounds,o=new Float32Array(6*3*(f[0].length+f[1].length));this.plot.zeroLineEnable;for(var m=0,l=[[],[]],w=0;w<2;++w)for(var _=l[w],h=f[w],b=y[w],u=y[w+2],L=0;L<h.length;++L){var T=(h[L].x-b)/(u-b);_.push(T);for(var k=0;k<6;++k)o[m++]=T,o[m++]=x[k],o[m++]=p[k]}this.ticks=l,this.vbo.update(o)}}(),s.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()};function i(x){var p=x.gl,v=e(p),f=a(p,r.gridVert,r.gridFrag),y=a(p,r.tickVert,r.gridFrag),o=new t(x,v,f,y);return o}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(g,S,M){S.exports=c;var e=g("gl-buffer"),a=g("gl-shader"),n=g("./shaders");function r(s,i,x){this.plot=s,this.vbo=i,this.shader=x}var t=r.prototype;t.bind=function(){var s=this.shader;this.vbo.bind(),this.shader.bind(),s.attributes.coord.pointer(),s.uniforms.screenBox=this.plot.screenBox},t.drawLine=function(){var s=[0,0],i=[0,0];return function(x,p,v,f,y,o){var m=this.plot,l=this.shader,w=m.gl;s[0]=x,s[1]=p,i[0]=v,i[1]=f,l.uniforms.start=s,l.uniforms.end=i,l.uniforms.width=y*m.pixelRatio,l.uniforms.color=o,w.drawArrays(w.TRIANGLE_STRIP,0,4)}}(),t.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function c(s){var i=s.gl,x=e(i,[-1,-1,-1,1,1,-1,1,1]),p=a(i,n.lineVert,n.lineFrag),v=new r(s,x,p);return v}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(g,S,M){var e=g("glslify"),a=e([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);S.exports={lineVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:a,textVert:e([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:a,gridVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:a,boxVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:231}],117:[function(g,S,M){S.exports=i;var e=g("gl-buffer"),a=g("gl-shader"),n=g("text-cache"),r=g("binary-search-bounds"),t=g("./shaders");function c(x,p,v){this.plot=x,this.vbo=p,this.shader=v,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var s=c.prototype;s.drawTicks=function(){var x=[0,0],p=[0,0],v=[0,0];return function(f){var y=this.plot,o=this.shader,m=this.tickX[f],l=this.tickOffset[f],w=y.gl,_=y.viewBox,h=y.dataBox,b=y.screenBox,u=y.pixelRatio,L=y.tickEnable,T=y.tickPad,k=y.tickColor,P=y.tickAngle,z=y.labelEnable,I=y.labelPad,D=y.labelColor,R=y.labelAngle,O=this.labelOffset[f],F=this.labelCount[f],N=r.lt(m,h[f]),G=r.le(m,h[f+2]);x[0]=x[1]=0,x[f]=1,p[f]=(_[2+f]+_[f])/(b[2+f]-b[f])-1;var K=2/b[2+(f^1)]-b[f^1];p[f^1]=K*_[f^1]-1,L[f]&&(p[f^1]-=K*u*T[f],N<G&&l[G]>l[N]&&(o.uniforms.dataAxis=x,o.uniforms.screenOffset=p,o.uniforms.color=k[f],o.uniforms.angle=P[f],w.drawArrays(w.TRIANGLES,l[N],l[G]-l[N]))),z[f]&&F&&(p[f^1]-=K*u*I[f],o.uniforms.dataAxis=v,o.uniforms.screenOffset=p,o.uniforms.color=D[f],o.uniforms.angle=R[f],w.drawArrays(w.TRIANGLES,O,F)),p[f^1]=K*_[2+(f^1)]-1,L[f+2]&&(p[f^1]+=K*u*T[f+2],N<G&&l[G]>l[N]&&(o.uniforms.dataAxis=x,o.uniforms.screenOffset=p,o.uniforms.color=k[f+2],o.uniforms.angle=P[f+2],w.drawArrays(w.TRIANGLES,l[N],l[G]-l[N]))),z[f+2]&&F&&(p[f^1]+=K*u*I[f+2],o.uniforms.dataAxis=v,o.uniforms.screenOffset=p,o.uniforms.color=D[f+2],o.uniforms.angle=R[f+2],w.drawArrays(w.TRIANGLES,O,F))}}(),s.drawTitle=function(){var x=[0,0],p=[0,0];return function(){var v=this.plot,f=this.shader,y=v.gl,o=v.screenBox,m=v.titleCenter,l=v.titleAngle,w=v.titleColor,_=v.pixelRatio;if(!!this.titleCount){for(var h=0;h<2;++h)p[h]=2*(m[h]*_-o[h])/(o[2+h]-o[h])-1;f.bind(),f.uniforms.dataAxis=x,f.uniforms.screenOffset=p,f.uniforms.angle=l,f.uniforms.color=w,y.drawArrays(y.TRIANGLES,this.titleOffset,this.titleCount)}}}(),s.bind=function(){var x=[0,0],p=[0,0],v=[0,0];return function(){var f=this.plot,y=this.shader,o=f._tickBounds,m=f.dataBox,l=f.screenBox,w=f.viewBox;y.bind();for(var _=0;_<2;++_){var h=o[_],b=o[_+2],u=b-h,L=.5*(m[_+2]+m[_]),T=m[_+2]-m[_],k=w[_],P=w[_+2],z=P-k,I=l[_],D=l[_+2],R=D-I;p[_]=2*u/T*z/R,x[_]=2*(h-L)/T*z/R}v[1]=2*f.pixelRatio/(l[3]-l[1]),v[0]=v[1]*(l[3]-l[1])/(l[2]-l[0]),y.uniforms.dataScale=p,y.uniforms.dataShift=x,y.uniforms.textScale=v,this.vbo.bind(),y.attributes.textCoordinate.pointer()}}(),s.update=function(x){var p=[],v=x.ticks,f=x.bounds,y,o,m,l,w;for(w=0;w<2;++w){var _=[Math.floor(p.length/3)],h=[-1/0],b=v[w];for(y=0;y<b.length;++y){var u=b[y],L=u.x,T=u.text,k=u.font||"sans-serif";l=u.fontSize||12;for(var P=1/(f[w+2]-f[w]),z=f[w],I=T.split(`
`),D=0;D<I.length;D++)for(m=n(k,I[D]).data,o=0;o<m.length;o+=2)p.push(m[o]*l,-m[o+1]*l-D*l*1.2,(L-z)*P);_.push(Math.floor(p.length/3)),h.push(L)}this.tickOffset[w]=_,this.tickX[w]=h}for(w=0;w<2;++w){for(this.labelOffset[w]=Math.floor(p.length/3),m=n(x.labelFont[w],x.labels[w],{textAlign:"center"}).data,l=x.labelSize[w],y=0;y<m.length;y+=2)p.push(m[y]*l,-m[y+1]*l,0);this.labelCount[w]=Math.floor(p.length/3)-this.labelOffset[w]}for(this.titleOffset=Math.floor(p.length/3),m=n(x.titleFont,x.title).data,l=x.titleSize,y=0;y<m.length;y+=2)p.push(m[y]*l,-m[y+1]*l,0);this.titleCount=Math.floor(p.length/3)-this.titleOffset,this.vbo.update(p)},s.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function i(x){var p=x.gl,v=e(p),f=a(p,t.textVert,t.textFrag),y=new c(x,v,f);return y}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(g,S,M){S.exports=p;var e=g("gl-select-static"),a=g("./lib/grid"),n=g("./lib/text"),r=g("./lib/line"),t=g("./lib/box");function c(v,f){this.gl=v,this.pickBuffer=f,this.screenBox=[0,0,v.drawingBufferWidth,v.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var s=c.prototype;s.setDirty=function(){this.dirty=this.pickDirty=!0},s.setOverlayDirty=function(){this.dirty=!0},s.nextDepthValue=function(){return this._depthCounter++/65536},s.draw=function(){return function(){var v=this.gl,f=this.screenBox,y=this.viewBox,o=this.dataBox,m=this.pixelRatio,l=this.grid,w=this.line,_=this.text,h=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),!!this.dirty){if(this.dirty=!1,v.bindFramebuffer(v.FRAMEBUFFER,null),v.enable(v.SCISSOR_TEST),v.disable(v.DEPTH_TEST),v.depthFunc(v.LESS),v.depthMask(!1),v.enable(v.BLEND),v.blendEquation(v.FUNC_ADD,v.FUNC_ADD),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),this.borderColor){v.scissor(f[0],f[1],f[2]-f[0],f[3]-f[1]);var b=this.borderColor;v.clearColor(b[0]*b[3],b[1]*b[3],b[2]*b[3],b[3]),v.clear(v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT)}v.scissor(y[0],y[1],y[2]-y[0],y[3]-y[1]),v.viewport(y[0],y[1],y[2]-y[0],y[3]-y[1]);var u=this.backgroundColor;v.clearColor(u[0]*u[3],u[1]*u[3],u[2]*u[3],u[3]),v.clear(v.COLOR_BUFFER_BIT),l.draw();var L=this.zeroLineEnable,T=this.zeroLineColor,k=this.zeroLineWidth;if(L[0]||L[1]){w.bind();for(var P=0;P<2;++P)if(!(!L[P]||!(o[P]<=0&&o[P+2]>=0))){var z=f[P]-o[P]*(f[P+2]-f[P])/(o[P+2]-o[P]);P===0?w.drawLine(z,f[1],z,f[3],k[P],T[P]):w.drawLine(f[0],z,f[2],z,k[P],T[P])}}for(var P=0;P<h.length;++P)h[P].draw();v.viewport(f[0],f[1],f[2]-f[0],f[3]-f[1]),v.scissor(f[0],f[1],f[2]-f[0],f[3]-f[1]),this.grid.drawTickMarks(),w.bind();var I=this.borderLineEnable,D=this.borderLineWidth,R=this.borderLineColor;I[1]&&w.drawLine(y[0],y[1]-.5*D[1]*m,y[0],y[3]+.5*D[3]*m,D[1],R[1]),I[0]&&w.drawLine(y[0]-.5*D[0]*m,y[1],y[2]+.5*D[2]*m,y[1],D[0],R[0]),I[3]&&w.drawLine(y[2],y[1]-.5*D[1]*m,y[2],y[3]+.5*D[3]*m,D[3],R[3]),I[2]&&w.drawLine(y[0]-.5*D[0]*m,y[3],y[2]+.5*D[2]*m,y[3],D[2],R[2]),_.bind();for(var P=0;P<2;++P)_.drawTicks(P);this.titleEnable&&_.drawTitle();for(var O=this.overlays,P=0;P<O.length;++P)O[P].draw();v.disable(v.SCISSOR_TEST),v.disable(v.BLEND),v.depthMask(!0)}}}(),s.drawPick=function(){return function(){if(!this.static){var v=this.pickBuffer;this.gl,this._pickTimeout=null,v.begin();for(var f=1,y=this.objects,o=0;o<y.length;++o)f=y[o].drawPick(f);v.end()}}}(),s.pick=function(){return function(v,f){if(!this.static){var y=this.pixelRatio,o=this.pickPixelRatio,m=this.viewBox,l=Math.round((v-m[0]/y)*o)|0,w=Math.round((f-m[1]/y)*o)|0,_=this.pickBuffer.query(l,w,this.pickRadius);if(!_)return null;for(var h=_.id+(_.value[0]<<8)+(_.value[1]<<16)+(_.value[2]<<24),b=this.objects,u=0;u<b.length;++u){var L=b[u].pick(l,w,h);if(L)return L}return null}}}();function i(v){for(var f=v.slice(),y=0;y<f.length;++y)f[y]=f[y].slice();return f}function x(v,f){return v.x-f.x}s.setScreenBox=function(v){var f=this.screenBox,y=this.pixelRatio;f[0]=Math.round(v[0]*y)|0,f[1]=Math.round(v[1]*y)|0,f[2]=Math.round(v[2]*y)|0,f[3]=Math.round(v[3]*y)|0,this.setDirty()},s.setDataBox=function(v){var f=this.dataBox,y=f[0]!==v[0]||f[1]!==v[1]||f[2]!==v[2]||f[3]!==v[3];y&&(f[0]=v[0],f[1]=v[1],f[2]=v[2],f[3]=v[3],this.setDirty())},s.setViewBox=function(v){var f=this.pixelRatio,y=this.viewBox;y[0]=Math.round(v[0]*f)|0,y[1]=Math.round(v[1]*f)|0,y[2]=Math.round(v[2]*f)|0,y[3]=Math.round(v[3]*f)|0;var o=this.pickPixelRatio;this.pickBuffer.shape=[Math.round((v[2]-v[0])*o)|0,Math.round((v[3]-v[1])*o)|0],this.setDirty()},s.update=function(v){v=v||{};var f=this.gl;this.pixelRatio=v.pixelRatio||1;var y=this.pixelRatio;this.pickPixelRatio=Math.max(y,1),this.setScreenBox(v.screenBox||[0,0,f.drawingBufferWidth/y,f.drawingBufferHeight/y]),this.screenBox,this.setViewBox(v.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/y,.125*(this.screenBox[3]-this.screenBox[1])/y,.875*(this.screenBox[2]-this.screenBox[0])/y,.875*(this.screenBox[3]-this.screenBox[1])/y]);var o=this.viewBox,m=(o[2]-o[0])/(o[3]-o[1]);this.setDataBox(v.dataBox||[-10,-10/m,10,10/m]),this.borderColor=v.borderColor!==!1?(v.borderColor||[0,0,0,0]).slice():!1,this.backgroundColor=(v.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(v.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(v.gridLineWidth||[1,1]).slice(),this.gridLineColor=i(v.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(v.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(v.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=i(v.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(v.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(v.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=i(v.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(v.titleCenter||[.5*(o[0]+o[2])/y,(o[3]+120)/y]).slice(),this.titleEnable=!("titleEnable"in v)||!!v.titleEnable,this.titleAngle=v.titleAngle||0,this.titleColor=(v.titleColor||[0,0,0,1]).slice(),this.labelPad=(v.labelPad||[15,15,15,15]).slice(),this.labelAngle=(v.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(v.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=i(v.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(v.tickPad||[15,15,15,15]).slice(),this.tickAngle=(v.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(v.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=i(v.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(v.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(v.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=i(v.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var l=v.ticks||[[],[]],w=this._tickBounds;w[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(var _=0;_<2;++_){var h=l[_].slice(0);h.length!==0&&(h.sort(x),w[_]=Math.min(w[_],h[0].x),w[_+2]=Math.max(w[_+2],h[h.length-1].x))}this.grid.update({bounds:w,ticks:l}),this.text.update({bounds:w,ticks:l,labels:v.labels||["x","y"],labelSize:v.labelSize||[12,12],labelFont:v.labelFont||["sans-serif","sans-serif"],title:v.title||"",titleSize:v.titleSize||18,titleFont:v.titleFont||"sans-serif"}),this.static=!!v.static,this.setDirty()},s.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var v=this.objects.length-1;v>=0;--v)this.objects[v].dispose();this.objects.length=0;for(var v=this.overlays.length-1;v>=0;--v)this.overlays[v].dispose();this.overlays.length=0,this.gl=null},s.addObject=function(v){this.objects.indexOf(v)<0&&(this.objects.push(v),this.setDirty())},s.removeObject=function(v){for(var f=this.objects,y=0;y<f.length;++y)if(f[y]===v){f.splice(y,1),this.setDirty();break}},s.addOverlay=function(v){this.overlays.indexOf(v)<0&&(this.overlays.push(v),this.setOverlayDirty())},s.removeOverlay=function(v){for(var f=this.overlays,y=0;y<f.length;++y)if(f[y]===v){f.splice(y,1),this.setOverlayDirty();break}};function p(v){var f=v.gl,y=e(f,[f.drawingBufferWidth,f.drawingBufferHeight]),o=new c(f,y);return o.grid=a(o),o.text=n(o),o.line=r(o),o.box=t(o),o.update(v),o}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(g,S,M){S.exports=s;var e=g("right-now"),a=g("3d-view"),n=g("mouse-change"),r=g("mouse-wheel"),t=g("mouse-event-offset"),c=g("has-passive-events");function s(i,x){i=i||document.body,x=x||{};var p=[.01,1/0];"distanceLimits"in x&&(p[0]=x.distanceLimits[0],p[1]=x.distanceLimits[1]),"zoomMin"in x&&(p[0]=x.zoomMin),"zoomMax"in x&&(p[1]=x.zoomMax);var v=a({center:x.center||[0,0,0],up:x.up||[0,1,0],eye:x.eye||[0,0,10],mode:x.mode||"orbit",distanceLimits:p}),f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],y=0,o=i.clientWidth,m=i.clientHeight,l={keyBindingMode:"rotate",enableWheel:!0,view:v,element:i,delay:x.delay||16,rotateSpeed:x.rotateSpeed||1,zoomSpeed:x.zoomSpeed||1,translateSpeed:x.translateSpeed||1,flipX:!!x.flipX,flipY:!!x.flipY,modes:v.modes,_ortho:x._ortho||x.projection&&x.projection.type==="orthographic"||!1,tick:function(){var w=e(),_=this.delay,h=w-2*_;v.idle(w-_),v.recalcMatrix(h),v.flush(w-(100+_*2));for(var b=!0,u=v.computedMatrix,L=0;L<16;++L)b=b&&f[L]===u[L],f[L]=u[L];var T=i.clientWidth===o&&i.clientHeight===m;return o=i.clientWidth,m=i.clientHeight,b?!T:(y=Math.exp(v.computedRadius[0]),!0)},lookAt:function(w,_,h){v.lookAt(v.lastT(),w,_,h)},rotate:function(w,_,h){v.rotate(v.lastT(),w,_,h)},pan:function(w,_,h){v.pan(v.lastT(),w,_,h)},translate:function(w,_,h){v.translate(v.lastT(),w,_,h)}};return Object.defineProperties(l,{matrix:{get:function(){return v.computedMatrix},set:function(w){return v.setMatrix(v.lastT(),w),v.computedMatrix},enumerable:!0},mode:{get:function(){return v.getMode()},set:function(w){var _=v.computedUp.slice(),h=v.computedEye.slice(),b=v.computedCenter.slice();if(v.setMode(w),w==="turntable"){var u=e();v._active.lookAt(u,h,b,_),v._active.lookAt(u+500,h,b,[0,0,1]),v._active.flush(u)}return v.getMode()},enumerable:!0},center:{get:function(){return v.computedCenter},set:function(w){return v.lookAt(v.lastT(),null,w),v.computedCenter},enumerable:!0},eye:{get:function(){return v.computedEye},set:function(w){return v.lookAt(v.lastT(),w),v.computedEye},enumerable:!0},up:{get:function(){return v.computedUp},set:function(w){return v.lookAt(v.lastT(),null,null,w),v.computedUp},enumerable:!0},distance:{get:function(){return y},set:function(w){return v.setDistance(v.lastT(),w),w},enumerable:!0},distanceLimits:{get:function(){return v.getDistanceLimits(p)},set:function(w){return v.setDistanceLimits(w),w},enumerable:!0}}),i.addEventListener("contextmenu",function(w){return w.preventDefault(),!1}),l._lastX=-1,l._lastY=-1,l._lastMods={shift:!1,control:!1,alt:!1,meta:!1},l.enableMouseListeners=function(){l.mouseListener=n(i,w),i.addEventListener("touchstart",function(_){var h=t(_.changedTouches[0],i);w(0,h[0],h[1],l._lastMods),w(1,h[0],h[1],l._lastMods)},c?{passive:!0}:!1),i.addEventListener("touchmove",function(_){var h=t(_.changedTouches[0],i);w(1,h[0],h[1],l._lastMods),_.preventDefault()},c?{passive:!1}:!1),i.addEventListener("touchend",function(_){w(0,l._lastX,l._lastY,l._lastMods)},c?{passive:!0}:!1);function w(_,h,b,u){var L=l.keyBindingMode;if(L!==!1){var T=L==="rotate",k=L==="pan",P=L==="zoom",z=!!u.control,I=!!u.alt,D=!!u.shift,R=!!(_&1),O=!!(_&2),F=!!(_&4),N=1/i.clientHeight,G=N*(h-l._lastX),K=N*(b-l._lastY),W=l.flipX?1:-1,Y=l.flipY?1:-1,re=Math.PI*l.rotateSpeed,ue=e();if(l._lastX!==-1&&l._lastY!==-1&&((T&&R&&!z&&!I&&!D||R&&!z&&!I&&D)&&v.rotate(ue,W*re*G,-Y*re*K,0),(k&&R&&!z&&!I&&!D||O||R&&z&&!I&&!D)&&v.pan(ue,-l.translateSpeed*G*y,l.translateSpeed*K*y,0),P&&R&&!z&&!I&&!D||F||R&&!z&&I&&!D)){var j=-l.zoomSpeed*K/window.innerHeight*(ue-v.lastT())*100;v.pan(ue,0,0,y*(Math.exp(j)-1))}return l._lastX=h,l._lastY=b,l._lastMods=u,!0}}l.wheelListener=r(i,function(_,h){if(l.keyBindingMode!==!1&&!!l.enableWheel){var b=l.flipX?1:-1,u=l.flipY?1:-1,L=e();if(Math.abs(_)>Math.abs(h))v.rotate(L,0,0,-_*b*Math.PI*l.rotateSpeed/window.innerWidth);else if(!l._ortho){var T=-l.zoomSpeed*u*h/window.innerHeight*(L-v.lastT())/20;v.pan(L,0,0,y*(Math.exp(T)-1))}}},!0)},l.enableMouseListeners(),l}},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(g,S,M){var e=g("glslify"),a=g("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),r=e([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);S.exports=function(t){return a(t,n,r,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(g,S,M){var e=g("./camera.js"),a=g("gl-axes3d"),n=g("gl-axes3d/properties"),r=g("gl-spikes3d"),t=g("gl-select-static"),c=g("gl-fbo"),s=g("a-big-triangle"),i=g("mouse-change"),x=g("gl-mat4/perspective"),p=g("gl-mat4/ortho"),v=g("./lib/shader"),f=g("is-mobile")({tablet:!0,featureDetect:!0});S.exports={createScene:w,createCamera:e};function y(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function o(h,b){var u=null;try{u=h.getContext("webgl",b),u||(u=h.getContext("experimental-webgl",b))}catch{return null}return u}function m(h){var b=Math.round(Math.log(Math.abs(h))/Math.log(10));if(b<0){var u=Math.round(Math.pow(10,-b));return Math.ceil(h*u)/u}else if(b>0){var u=Math.round(Math.pow(10,b));return Math.ceil(h/u)*u}return Math.ceil(h)}function l(h){return typeof h=="boolean"?h:!0}function w(h){h=h||{},h.camera=h.camera||{};var b=h.canvas;if(!b)if(b=document.createElement("canvas"),h.container){var u=h.container;u.appendChild(b)}else document.body.appendChild(b);var L=h.gl;if(L||(h.glOptions&&(f=!!h.glOptions.preserveDrawingBuffer),L=o(b,h.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:f})),!L)throw new Error("webgl not supported");var T=h.bounds||[[-10,-10,-10],[10,10,10]],k=new y,P=c(L,L.drawingBufferWidth,L.drawingBufferHeight,{preferFloat:!f}),z=v(L),I=h.cameraObject&&h.cameraObject._ortho===!0||h.camera.projection&&h.camera.projection.type==="orthographic"||!1,D={eye:h.camera.eye||[2,0,0],center:h.camera.center||[0,0,0],up:h.camera.up||[0,1,0],zoomMin:h.camera.zoomMax||.1,zoomMax:h.camera.zoomMin||100,mode:h.camera.mode||"turntable",_ortho:I},R=h.axes||{},O=a(L,R);O.enable=!R.disable;var F=h.spikes||{},N=r(L,F),G=[],K=[],W=[],Y=[],re=!0,V=!0,ue=new Array(16),j=new Array(16),q={view:null,projection:ue,model:j,_ortho:!1},V=!0,U=[L.drawingBufferWidth,L.drawingBufferHeight],$=h.cameraObject||e(b,D),ne={gl:L,contextLost:!1,pixelRatio:h.pixelRatio||1,canvas:b,selection:k,camera:$,axes:O,axesPixels:null,spikes:N,bounds:T,objects:G,shape:U,aspect:h.aspectRatio||[1,1,1],pickRadius:h.pickRadius||10,zNear:h.zNear||.01,zFar:h.zFar||1e3,fovy:h.fovy||Math.PI/4,clearColor:h.clearColor||[0,0,0,0],autoResize:l(h.autoResize),autoBounds:l(h.autoBounds),autoScale:!!h.autoScale,autoCenter:l(h.autoCenter),clipToBounds:l(h.clipToBounds),snapToData:!!h.snapToData,onselect:h.onselect||null,onrender:h.onrender||null,onclick:h.onclick||null,cameraParams:q,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(ye){this.aspect[0]=ye.x,this.aspect[1]=ye.y,this.aspect[2]=ye.z,V=!0},setBounds:function(ye,ge){this.bounds[0][ye]=ge.min,this.bounds[1][ye]=ge.max},setClearColor:function(ye){this.clearColor=ye},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},X=[L.drawingBufferWidth/ne.pixelRatio|0,L.drawingBufferHeight/ne.pixelRatio|0];function Q(){if(!ne._stopped&&!!ne.autoResize){var ye=b.parentNode,ge=1,me=1;ye&&ye!==document.body?(ge=ye.clientWidth,me=ye.clientHeight):(ge=window.innerWidth,me=window.innerHeight);var Ee=Math.ceil(ge*ne.pixelRatio)|0,Pe=Math.ceil(me*ne.pixelRatio)|0;if(Ee!==b.width||Pe!==b.height){b.width=Ee,b.height=Pe;var Ne=b.style;Ne.position=Ne.position||"absolute",Ne.left="0px",Ne.top="0px",Ne.width=ge+"px",Ne.height=me+"px",re=!0}}}ne.autoResize&&Q(),window.addEventListener("resize",Q);function ie(){for(var ye=G.length,ge=Y.length,me=0;me<ge;++me)W[me]=0;e:for(var me=0;me<ye;++me){var Ee=G[me],Pe=Ee.pickSlots;if(!Pe){K[me]=-1;continue}for(var Ne=0;Ne<ge;++Ne)if(W[Ne]+Pe<255){K[me]=Ne,Ee.setPickBase(W[Ne]+1),W[Ne]+=Pe;continue e}var we=t(L,U);K[me]=ge,Y.push(we),W.push(Pe),Ee.setPickBase(1),ge+=1}for(;ge>0&&W[ge-1]===0;)W.pop(),Y.pop().dispose()}ne.update=function(ye){ne._stopped||(re=!0,V=!0)},ne.add=function(ye){ne._stopped||(ye.axes=O,G.push(ye),K.push(-1),re=!0,V=!0,ie())},ne.remove=function(ye){if(!ne._stopped){var ge=G.indexOf(ye);ge<0||(G.splice(ge,1),K.pop(),re=!0,V=!0,ie())}},ne.dispose=function(){if(!ne._stopped&&(ne._stopped=!0,window.removeEventListener("resize",Q),b.removeEventListener("webglcontextlost",se),ne.mouseListener.enabled=!1,!ne.contextLost)){O.dispose(),N.dispose();for(var ye=0;ye<G.length;++ye)G[ye].dispose();P.dispose();for(var ye=0;ye<Y.length;++ye)Y[ye].dispose();z.dispose(),L=null,O=null,N=null,G=[]}},ne._mouseRotating=!1,ne._prevButtons=0,ne.enableMouseListeners=function(){ne.mouseListener=i(b,function(ye,ge,me){if(!ne._stopped){var Ee=Y.length,Pe=G.length,Ne=k.object;k.distance=1/0,k.mouse[0]=ge,k.mouse[1]=me,k.object=null,k.screen=null,k.dataCoordinate=k.dataPosition=null;var we=!1;if(ye&&ne._prevButtons)ne._mouseRotating=!0;else{ne._mouseRotating&&(V=!0),ne._mouseRotating=!1;for(var ke=0;ke<Ee;++ke){var Xe=Y[ke].query(ge,X[1]-me-1,ne.pickRadius);if(Xe){if(Xe.distance>k.distance)continue;for(var He=0;He<Pe;++He){var Ie=G[He];if(K[He]===ke){var De=Ie.pick(Xe);De&&(k.buttons=ye,k.screen=Xe.coord,k.distance=Xe.distance,k.object=Ie,k.index=De.distance,k.dataPosition=De.position,k.dataCoordinate=De.dataCoordinate,k.data=De,we=!0)}}}}}Ne&&Ne!==k.object&&(Ne.highlight&&Ne.highlight(null),re=!0),k.object&&(k.object.highlight&&k.object.highlight(k.data),re=!0),we=we||k.object!==Ne,we&&ne.onselect&&ne.onselect(k),ye&1&&!(ne._prevButtons&1)&&ne.onclick&&ne.onclick(k),ne._prevButtons=ye}})};function se(){if(ne.contextLost)return!0;L.isContextLost()&&(ne.contextLost=!0,ne.mouseListener.enabled=!1,ne.selection.object=null,ne.oncontextloss&&ne.oncontextloss())}b.addEventListener("webglcontextlost",se);function ae(){if(!se()){L.colorMask(!0,!0,!0,!0),L.depthMask(!0),L.disable(L.BLEND),L.enable(L.DEPTH_TEST),L.depthFunc(L.LEQUAL);for(var ye=G.length,ge=Y.length,me=0;me<ge;++me){var Ee=Y[me];Ee.shape=X,Ee.begin();for(var Pe=0;Pe<ye;++Pe)if(K[Pe]===me){var Ne=G[Pe];Ne.drawPick&&(Ne.pixelRatio=1,Ne.drawPick(q))}Ee.end()}}}var oe=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],be=[oe[0].slice(),oe[1].slice()];function ce(){if(!se()){Q();var ye=ne.camera.tick();q.view=ne.camera.matrix,re=re||ye,V=V||ye,O.pixelRatio=ne.pixelRatio,N.pixelRatio=ne.pixelRatio;var ge=G.length,me=oe[0],Ee=oe[1];me[0]=me[1]=me[2]=1/0,Ee[0]=Ee[1]=Ee[2]=-1/0;for(var Pe=0;Pe<ge;++Pe){var Ne=G[Pe];Ne.pixelRatio=ne.pixelRatio,Ne.axes=ne.axes,re=re||!!Ne.dirty,V=V||!!Ne.dirty;var we=Ne.bounds;if(we)for(var ke=we[0],Xe=we[1],He=0;He<3;++He)me[He]=Math.min(me[He],ke[He]),Ee[He]=Math.max(Ee[He],Xe[He])}var Ie=ne.bounds;if(ne.autoBounds)for(var He=0;He<3;++He){if(Ee[He]<me[He])me[He]=-1,Ee[He]=1;else{me[He]===Ee[He]&&(me[He]-=1,Ee[He]+=1);var De=.05*(Ee[He]-me[He]);me[He]=me[He]-De,Ee[He]=Ee[He]+De}Ie[0][He]=me[He],Ie[1][He]=Ee[He]}for(var Ge=!1,He=0;He<3;++He)Ge=Ge||be[0][He]!==Ie[0][He]||be[1][He]!==Ie[1][He],be[0][He]=Ie[0][He],be[1][He]=Ie[1][He];if(V=V||Ge,re=re||Ge,!!re){if(Ge){for(var ht=[0,0,0],Pe=0;Pe<3;++Pe)ht[Pe]=m((Ie[1][Pe]-Ie[0][Pe])/10);O.autoTicks?O.update({bounds:Ie,tickSpacing:ht}):O.update({bounds:Ie})}var Rt=L.drawingBufferWidth,Kt=L.drawingBufferHeight;U[0]=Rt,U[1]=Kt,X[0]=Math.max(Rt/ne.pixelRatio,1)|0,X[1]=Math.max(Kt/ne.pixelRatio,1)|0,_(ne,I);for(var Pe=0;Pe<ge;++Pe){var Ne=G[Pe];Ne.axesBounds=Ie,ne.clipToBounds&&(Ne.clipBounds=Ie)}k.object&&(ne.snapToData?N.position=k.dataCoordinate:N.position=k.dataPosition,N.bounds=Ie),V&&(V=!1,ae()),ne.axesPixels=n(ne.axes,q,Rt,Kt),ne.onrender&&ne.onrender(),L.bindFramebuffer(L.FRAMEBUFFER,null),L.viewport(0,0,Rt,Kt),ne.clearRGBA(),L.depthMask(!0),L.colorMask(!0,!0,!0,!0),L.enable(L.DEPTH_TEST),L.depthFunc(L.LEQUAL),L.disable(L.BLEND),L.disable(L.CULL_FACE);var It=!1;O.enable&&(It=It||O.isTransparent(),O.draw(q)),N.axes=O,k.object&&N.draw(q),L.disable(L.CULL_FACE);for(var Pe=0;Pe<ge;++Pe){var Ne=G[Pe];Ne.axes=O,Ne.pixelRatio=ne.pixelRatio,Ne.isOpaque&&Ne.isOpaque()&&Ne.draw(q),Ne.isTransparent&&Ne.isTransparent()&&(It=!0)}if(It){P.shape=U,P.bind(),L.clear(L.DEPTH_BUFFER_BIT),L.colorMask(!1,!1,!1,!1),L.depthMask(!0),L.depthFunc(L.LESS),O.enable&&O.isTransparent()&&O.drawTransparent(q);for(var Pe=0;Pe<ge;++Pe){var Ne=G[Pe];Ne.isOpaque&&Ne.isOpaque()&&Ne.draw(q)}L.enable(L.BLEND),L.blendEquation(L.FUNC_ADD),L.blendFunc(L.ONE,L.ONE_MINUS_SRC_ALPHA),L.colorMask(!0,!0,!0,!0),L.depthMask(!1),L.clearColor(0,0,0,0),L.clear(L.COLOR_BUFFER_BIT),O.isTransparent()&&O.drawTransparent(q);for(var Pe=0;Pe<ge;++Pe){var Ne=G[Pe];Ne.isTransparent&&Ne.isTransparent()&&Ne.drawTransparent(q)}L.bindFramebuffer(L.FRAMEBUFFER,null),L.blendFunc(L.ONE,L.ONE_MINUS_SRC_ALPHA),L.disable(L.DEPTH_TEST),z.bind(),P.color[0].bind(0),z.uniforms.accumBuffer=0,s(L),L.disable(L.BLEND)}re=!1;for(var Pe=0;Pe<ge;++Pe)G[Pe].dirty=!1}}}function de(){ne._stopped||ne.contextLost||(ce(),requestAnimationFrame(de))}return ne.enableMouseListeners(),de(),ne.redraw=function(){ne._stopped||(re=!0,ce())},ne}function _(h,b){var u=h.bounds,L=h.cameraParams,T=L.projection,k=L.model,P=h.gl.drawingBufferWidth,z=h.gl.drawingBufferHeight,I=h.zNear,D=h.zFar,R=h.fovy,O=P/z;b?(p(T,-O,O,-1,1,I,D),L._ortho=!0):(x(T,R,O,I,D),L._ortho=!1);for(var F=0;F<16;++F)k[F]=0;k[15]=1;for(var N=0,F=0;F<3;++F)N=Math.max(N,u[1][F]-u[0][F]);for(var F=0;F<3;++F)h.autoScale?k[5*F]=h.aspect[F]/(u[1][F]-u[0][F]):k[5*F]=1/N,h.autoCenter&&(k[12+F]=-k[5*F]*.5*(u[0][F]+u[1][F]))}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(g,S,M){var e=g("glslify");M.pointVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),M.pointFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),M.pickVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),M.pickFragment=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:231}],123:[function(g,S,M){var e=g("gl-shader"),a=g("gl-buffer"),n=g("typedarray-pool"),r=g("./lib/shader");S.exports=i;function t(x,p,v,f,y){this.plot=x,this.offsetBuffer=p,this.pickBuffer=v,this.shader=f,this.pickShader=y,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}var c=t.prototype;c.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},c.update=function(x){var p;x=x||{};function v(_,h){return _ in x?x[_]:h}this.sizeMin=v("sizeMin",.5),this.sizeMax=v("sizeMax",20),this.color=v("color",[1,0,0,1]).slice(),this.areaRatio=v("areaRatio",1),this.borderColor=v("borderColor",[0,0,0,1]).slice(),this.blend=v("blend",!1);var f=x.positions.length>>>1,y=x.positions instanceof Float32Array,o=x.idToIndex instanceof Int32Array&&x.idToIndex.length>=f,m=x.positions,l=y?m:n.mallocFloat32(m.length),w=o?x.idToIndex:n.mallocInt32(f);if(y||l.set(m),!o)for(l.set(m),p=0;p<f;p++)w[p]=p;this.points=m,this.offsetBuffer.update(l),this.pickBuffer.update(w),y||n.free(l),o||n.free(w),this.pointCount=f,this.pickOffset=0};function s(x,p){var v=0,f=x.length>>>1,y;for(y=0;y<f;y++){var o=x[y*2],m=x[y*2+1];o>=p[0]&&o<=p[2]&&m>=p[1]&&m<=p[3]&&v++}return v}c.unifiedDraw=function(){var x=[1,0,0,0,1,0,0,0,1],p=[0,0,0,0];return function(v){var f=v!==void 0,y=f?this.pickShader:this.shader,o=this.plot.gl,m=this.plot.dataBox;if(this.pointCount===0)return v;var l=m[2]-m[0],w=m[3]-m[1],_=s(this.points,m),h=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(_,.33333)));x[0]=2/l,x[4]=2/w,x[6]=-2*m[0]/l-1,x[7]=-2*m[1]/w-1,this.offsetBuffer.bind(),y.bind(),y.attributes.position.pointer(),y.uniforms.matrix=x,y.uniforms.color=this.color,y.uniforms.borderColor=this.borderColor,y.uniforms.pointCloud=h<5,y.uniforms.pointSize=h,y.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),f&&(p[0]=v&255,p[1]=v>>8&255,p[2]=v>>16&255,p[3]=v>>24&255,this.pickBuffer.bind(),y.attributes.pickId.pointer(o.UNSIGNED_BYTE),y.uniforms.pickOffset=p,this.pickOffset=v);var b=o.getParameter(o.BLEND),u=o.getParameter(o.DITHER);return b&&!this.blend&&o.disable(o.BLEND),u&&o.disable(o.DITHER),o.drawArrays(o.POINTS,0,this.pointCount),b&&!this.blend&&o.enable(o.BLEND),u&&o.enable(o.DITHER),v+this.pointCount}}(),c.draw=c.unifiedDraw,c.drawPick=c.unifiedDraw,c.pick=function(x,p,v){var f=this.pickOffset,y=this.pointCount;if(v<f||v>=f+y)return null;var o=v-f,m=this.points;return{object:this,pointId:o,dataCoord:[m[2*o],m[2*o+1]]}};function i(x,p){var v=x.gl,f=a(v),y=a(v),o=e(v,r.pointVertex,r.pointFragment),m=e(v,r.pickVertex,r.pickFragment),l=new t(x,f,y,o,m);return l.update(p),x.addObject(l),l}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(g,S,M){S.exports=e;function e(a,n,r,t){var c=n[0],s=n[1],i=n[2],x=n[3],p=r[0],v=r[1],f=r[2],y=r[3],o,m,l,w,_;return m=c*p+s*v+i*f+x*y,m<0&&(m=-m,p=-p,v=-v,f=-f,y=-y),1-m>1e-6?(o=Math.acos(m),l=Math.sin(o),w=Math.sin((1-t)*o)/l,_=Math.sin(t*o)/l):(w=1-t,_=t),a[0]=w*c+_*p,a[1]=w*s+_*v,a[2]=w*i+_*f,a[3]=w*x+_*y,a}},{}],125:[function(g,S,M){S.exports=function(e){return!e&&e!==0?"":e.toString()}},{}],126:[function(g,S,M){var e=g("vectorize-text");S.exports=n;var a={};function n(r,t,c){var s=a[t];if(s||(s=a[t]={}),r in s)return s[r];var i={textAlign:"center",textBaseline:"middle",lineHeight:1,font:t,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}};i.triangles=!0;var x=e(r,i);i.triangles=!1;var p=e(r,i),v,f;if(c&&c!==1){for(v=0;v<x.positions.length;++v)for(f=0;f<x.positions[v].length;++f)x.positions[v][f]/=c;for(v=0;v<p.positions.length;++v)for(f=0;f<p.positions[v].length;++f)p.positions[v][f]/=c}var y=[[1/0,1/0],[-1/0,-1/0]],o=p.positions.length;for(v=0;v<o;++v){var m=p.positions[v];for(f=0;f<2;++f)y[0][f]=Math.min(y[0][f],m[f]),y[1][f]=Math.max(y[1][f],m[f])}return s[r]=[x,p,y]}},{"vectorize-text":311}],127:[function(g,S,M){var e=g("gl-shader"),a=g("glslify"),n=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),r=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),t=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),c=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),s=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),i=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],x={vertex:n,fragment:c,attributes:i},p={vertex:r,fragment:c,attributes:i},v={vertex:t,fragment:c,attributes:i},f={vertex:n,fragment:s,attributes:i},y={vertex:r,fragment:s,attributes:i},o={vertex:t,fragment:s,attributes:i};function m(l,w){var _=e(l,w),h=_.attributes;return h.position.location=0,h.color.location=1,h.glyph.location=2,h.id.location=3,_}M.createPerspective=function(l){return m(l,x)},M.createOrtho=function(l){return m(l,p)},M.createProject=function(l){return m(l,v)},M.createPickPerspective=function(l){return m(l,f)},M.createPickOrtho=function(l){return m(l,y)},M.createPickProject=function(l){return m(l,o)}},{"gl-shader":132,glslify:231}],128:[function(g,S,M){var e=g("is-string-blank"),a=g("gl-buffer"),n=g("gl-vao"),r=g("typedarray-pool"),t=g("gl-mat4/multiply"),c=g("./lib/shaders"),s=g("./lib/glyphs"),i=g("./lib/get-simple-string"),x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];S.exports=K;function p(W,Y){var re=W[0],ue=W[1],j=W[2],q=W[3];return W[0]=Y[0]*re+Y[4]*ue+Y[8]*j+Y[12]*q,W[1]=Y[1]*re+Y[5]*ue+Y[9]*j+Y[13]*q,W[2]=Y[2]*re+Y[6]*ue+Y[10]*j+Y[14]*q,W[3]=Y[3]*re+Y[7]*ue+Y[11]*j+Y[15]*q,W}function v(W,Y,re,ue){return p(ue,ue),p(ue,ue),p(ue,ue)}function f(W,Y){this.index=W,this.dataCoordinate=this.position=Y}function y(W){return W===!0||W>1?1:W}function o(W,Y,re,ue,j,q,V,U,$,ne,X,Q){this.gl=W,this.pixelRatio=1,this.shader=Y,this.orthoShader=re,this.projectShader=ue,this.pointBuffer=j,this.colorBuffer=q,this.glyphBuffer=V,this.idBuffer=U,this.vao=$,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=ne,this.pickOrthoShader=X,this.pickProjectShader=Q,this.points=[],this._selectResult=new f(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}var m=o.prototype;m.pickSlots=1,m.setPickBase=function(W){this.pickId=W},m.isTransparent=function(){if(this.hasAlpha)return!0;for(var W=0;W<3;++W)if(this.axesProject[W]&&this.projectHasAlpha)return!0;return!1},m.isOpaque=function(){if(!this.hasAlpha)return!0;for(var W=0;W<3;++W)if(this.axesProject[W]&&!this.projectHasAlpha)return!0;return!1};var l=[0,0],w=[0,0,0],_=[0,0,0],h=[0,0,0,1],b=[0,0,0,1],u=x.slice(),L=[0,0,0],T=[[0,0,0],[0,0,0]];function k(W){return W[0]=W[1]=W[2]=0,W}function P(W,Y){return W[0]=Y[0],W[1]=Y[1],W[2]=Y[2],W[3]=1,W}function z(W,Y,re,ue){return W[0]=Y[0],W[1]=Y[1],W[2]=Y[2],W[re]=ue,W}function I(W){for(var Y=T,re=0;re<2;++re)for(var ue=0;ue<3;++ue)Y[re][ue]=Math.max(Math.min(W[re][ue],1e8),-1e8);return Y}function D(W,Y,re,ue){var j=Y.axesProject,q=Y.gl,V=W.uniforms,U=re.model||x,$=re.view||x,ne=re.projection||x,X=Y.axesBounds,Q=I(Y.clipBounds),ie;Y.axes&&Y.axes.lastCubeProps?ie=Y.axes.lastCubeProps.axis:ie=[1,1,1],l[0]=2/q.drawingBufferWidth,l[1]=2/q.drawingBufferHeight,W.bind(),V.view=$,V.projection=ne,V.screenSize=l,V.highlightId=Y.highlightId,V.highlightScale=Y.highlightScale,V.clipBounds=Q,V.pickGroup=Y.pickId/255,V.pixelRatio=ue;for(var se=0;se<3;++se)if(!!j[se]){V.scale=Y.projectScale[se],V.opacity=Y.projectOpacity[se];for(var ae=u,oe=0;oe<16;++oe)ae[oe]=0;for(var oe=0;oe<4;++oe)ae[5*oe]=1;ae[5*se]=0,ie[se]<0?ae[12+se]=X[0][se]:ae[12+se]=X[1][se],t(ae,U,ae),V.model=ae;var be=(se+1)%3,ce=(se+2)%3,de=k(w),ye=k(_);de[be]=1,ye[ce]=1;var ge=v(ne,$,U,P(h,de)),me=v(ne,$,U,P(b,ye));if(Math.abs(ge[1])>Math.abs(me[1])){var Ee=ge;ge=me,me=Ee,Ee=de,de=ye,ye=Ee;var Pe=be;be=ce,ce=Pe}ge[0]<0&&(de[be]=-1),me[1]>0&&(ye[ce]=-1);for(var Ne=0,we=0,oe=0;oe<4;++oe)Ne+=Math.pow(U[4*be+oe],2),we+=Math.pow(U[4*ce+oe],2);de[be]/=Math.sqrt(Ne),ye[ce]/=Math.sqrt(we),V.axes[0]=de,V.axes[1]=ye,V.fragClipBounds[0]=z(L,Q[0],se,-1e8),V.fragClipBounds[1]=z(L,Q[1],se,1e8),Y.vao.bind(),Y.vao.draw(q.TRIANGLES,Y.vertexCount),Y.lineWidth>0&&(q.lineWidth(Y.lineWidth*ue),Y.vao.draw(q.LINES,Y.lineVertexCount,Y.vertexCount)),Y.vao.unbind()}}var R=[-1e8,-1e8,-1e8],O=[1e8,1e8,1e8],F=[R,O];function N(W,Y,re,ue,j,q,V){var U=re.gl;if((q===re.projectHasAlpha||V)&&D(Y,re,ue,j),q===re.hasAlpha||V){W.bind();var $=W.uniforms;$.model=ue.model||x,$.view=ue.view||x,$.projection=ue.projection||x,l[0]=2/U.drawingBufferWidth,l[1]=2/U.drawingBufferHeight,$.screenSize=l,$.highlightId=re.highlightId,$.highlightScale=re.highlightScale,$.fragClipBounds=F,$.clipBounds=re.axes.bounds,$.opacity=re.opacity,$.pickGroup=re.pickId/255,$.pixelRatio=j,re.vao.bind(),re.vao.draw(U.TRIANGLES,re.vertexCount),re.lineWidth>0&&(U.lineWidth(re.lineWidth*j),re.vao.draw(U.LINES,re.lineVertexCount,re.vertexCount)),re.vao.unbind()}}m.draw=function(W){var Y=this.useOrtho?this.orthoShader:this.shader;N(Y,this.projectShader,this,W,this.pixelRatio,!1,!1)},m.drawTransparent=function(W){var Y=this.useOrtho?this.orthoShader:this.shader;N(Y,this.projectShader,this,W,this.pixelRatio,!0,!1)},m.drawPick=function(W){var Y=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;N(Y,this.pickProjectShader,this,W,1,!0,!0)},m.pick=function(W){if(!W||W.id!==this.pickId)return null;var Y=W.value[2]+(W.value[1]<<8)+(W.value[0]<<16);if(Y>=this.pointCount||Y<0)return null;var re=this.points[Y],ue=this._selectResult;ue.index=Y;for(var j=0;j<3;++j)ue.position[j]=ue.dataCoordinate[j]=re[j];return ue},m.highlight=function(W){if(!W)this.highlightId=[1,1,1,1];else{var Y=W.index,re=Y&255,ue=Y>>8&255,j=Y>>16&255;this.highlightId=[re/255,ue/255,j/255,0]}};function G(W,Y,re,ue){var j;Array.isArray(W)?Y<W.length?j=W[Y]:j=void 0:j=W,j=i(j);var q=!0;e(j)&&(j="\u25BC",q=!1);var V=s(j,re,ue);return{mesh:V[0],lines:V[1],bounds:V[2],visible:q}}m.update=function(W){if(W=W||{},"perspective"in W&&(this.useOrtho=!W.perspective),"orthographic"in W&&(this.useOrtho=!!W.orthographic),"lineWidth"in W&&(this.lineWidth=W.lineWidth),"project"in W)if(Array.isArray(W.project))this.axesProject=W.project;else{var Y=!!W.project;this.axesProject=[Y,Y,Y]}if("projectScale"in W)if(Array.isArray(W.projectScale))this.projectScale=W.projectScale.slice();else{var re=+W.projectScale;this.projectScale=[re,re,re]}if(this.projectHasAlpha=!1,"projectOpacity"in W){if(Array.isArray(W.projectOpacity))this.projectOpacity=W.projectOpacity.slice();else{var re=+W.projectOpacity;this.projectOpacity=[re,re,re]}for(var ue=0;ue<3;++ue)this.projectOpacity[ue]=y(this.projectOpacity[ue]),this.projectOpacity[ue]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in W&&(this.opacity=y(W.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var j=W.position,q=W.font||"normal",V=W.alignment||[0,0],U,$;if(V.length===2)U=V[0],$=V[1];else{U=[],$=[];for(var ue=0;ue<V.length;++ue)U[ue]=V[ue][0],$[ue]=V[ue][1]}var ne=[1/0,1/0,1/0],X=[-1/0,-1/0,-1/0],Q=W.glyph,ie=W.color,se=W.size,ae=W.angle,oe=W.lineColor,be=-1,ce=0,de=0,ye=0;if(j.length){ye=j.length;e:for(var ue=0;ue<ye;++ue){for(var ge=j[ue],me=0;me<3;++me)if(isNaN(ge[me])||!isFinite(ge[me]))continue e;var Ee=G(Q,ue,q,this.pixelRatio),Pe=Ee.mesh,Ne=Ee.lines,we=Ee.bounds;ce+=Pe.cells.length*3,de+=Ne.edges.length*2}}var ke=ce+de,Xe=r.mallocFloat(3*ke),He=r.mallocFloat(4*ke),Ie=r.mallocFloat(2*ke),De=r.mallocUint32(ke);if(ke>0){var Ge=0,ht=ce,Rt=[0,0,0,1],Kt=[0,0,0,1],It=Array.isArray(ie)&&Array.isArray(ie[0]),Mt=Array.isArray(oe)&&Array.isArray(oe[0]);e:for(var ue=0;ue<ye;++ue){be+=1;for(var ge=j[ue],me=0;me<3;++me){if(isNaN(ge[me])||!isFinite(ge[me]))continue e;X[me]=Math.max(X[me],ge[me]),ne[me]=Math.min(ne[me],ge[me])}var Ee=G(Q,ue,q,this.pixelRatio),Pe=Ee.mesh,Ne=Ee.lines,we=Ee.bounds,Yt=Ee.visible;if(!Yt)Rt=[1,1,1,0];else if(Array.isArray(ie)){var zt;if(It?ue<ie.length?zt=ie[ue]:zt=[0,0,0,0]:zt=ie,zt.length===3){for(var me=0;me<3;++me)Rt[me]=zt[me];Rt[3]=1}else if(zt.length===4){for(var me=0;me<4;++me)Rt[me]=zt[me];!this.hasAlpha&&zt[3]<1&&(this.hasAlpha=!0)}}else Rt[0]=Rt[1]=Rt[2]=0,Rt[3]=1;if(!Yt)Kt=[1,1,1,0];else if(Array.isArray(oe)){var zt;if(Mt?ue<oe.length?zt=oe[ue]:zt=[0,0,0,0]:zt=oe,zt.length===3){for(var me=0;me<3;++me)Kt[me]=zt[me];Kt[me]=1}else if(zt.length===4){for(var me=0;me<4;++me)Kt[me]=zt[me];!this.hasAlpha&&zt[3]<1&&(this.hasAlpha=!0)}}else Kt[0]=Kt[1]=Kt[2]=0,Kt[3]=1;var St=.5;Yt?Array.isArray(se)?ue<se.length?St=+se[ue]:St=12:se?St=+se:this.useOrtho&&(St=12):St=0;var Ye=0;Array.isArray(ae)?ue<ae.length?Ye=+ae[ue]:Ye=0:ae&&(Ye=+ae);for(var rt=Math.cos(Ye),Ve=Math.sin(Ye),ge=j[ue],me=0;me<3;++me)X[me]=Math.max(X[me],ge[me]),ne[me]=Math.min(ne[me],ge[me]);var Ae=U,Ue=$,Ae=0;Array.isArray(U)?ue<U.length?Ae=U[ue]:Ae=0:U&&(Ae=U);var Ue=0;Array.isArray($)?ue<$.length?Ue=$[ue]:Ue=0:$&&(Ue=$),Ae*=Ae>0?1-we[0][0]:Ae<0?1+we[1][0]:1,Ue*=Ue>0?1-we[0][1]:Ue<0?1+we[1][1]:1;for(var Ze=[Ae,Ue],Ut=Pe.cells||[],Dt=Pe.positions||[],me=0;me<Ut.length;++me)for(var Qe=Ut[me],_t=0;_t<3;++_t){for(var gt=0;gt<3;++gt)Xe[3*Ge+gt]=ge[gt];for(var gt=0;gt<4;++gt)He[4*Ge+gt]=Rt[gt];De[Ge]=be;var wt=Dt[Qe[_t]];Ie[2*Ge]=St*(rt*wt[0]-Ve*wt[1]+Ze[0]),Ie[2*Ge+1]=St*(Ve*wt[0]+rt*wt[1]+Ze[1]),Ge+=1}for(var Ut=Ne.edges,Dt=Ne.positions,me=0;me<Ut.length;++me)for(var Qe=Ut[me],_t=0;_t<2;++_t){for(var gt=0;gt<3;++gt)Xe[3*ht+gt]=ge[gt];for(var gt=0;gt<4;++gt)He[4*ht+gt]=Kt[gt];De[ht]=be;var wt=Dt[Qe[_t]];Ie[2*ht]=St*(rt*wt[0]-Ve*wt[1]+Ze[0]),Ie[2*ht+1]=St*(Ve*wt[0]+rt*wt[1]+Ze[1]),ht+=1}}}this.bounds=[ne,X],this.points=j,this.pointCount=j.length,this.vertexCount=ce,this.lineVertexCount=de,this.pointBuffer.update(Xe),this.colorBuffer.update(He),this.glyphBuffer.update(Ie),this.idBuffer.update(De),r.free(Xe),r.free(He),r.free(Ie),r.free(De)},m.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()};function K(W){var Y=W.gl,re=c.createPerspective(Y),ue=c.createOrtho(Y),j=c.createProject(Y),q=c.createPickPerspective(Y),V=c.createPickOrtho(Y),U=c.createPickProject(Y),$=a(Y),ne=a(Y),X=a(Y),Q=a(Y),ie=n(Y,[{buffer:$,size:3,type:Y.FLOAT},{buffer:ne,size:4,type:Y.FLOAT},{buffer:X,size:2,type:Y.FLOAT},{buffer:Q,size:4,type:Y.UNSIGNED_BYTE,normalized:!0}]),se=new o(Y,re,ue,j,$,ne,X,Q,ie,q,V,U);return se.update(W),se}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(g,S,M){var e=g("glslify");M.boxVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),M.boxFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:231}],130:[function(g,S,M){var e=g("gl-shader"),a=g("gl-buffer"),n=g("./lib/shaders");S.exports=c;function r(s,i,x){this.plot=s,this.boxBuffer=i,this.boxShader=x,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}var t=r.prototype;t.draw=function(){if(!!this.enabled){var s=this.plot,i=this.selectBox,x=this.borderWidth;this.innerFill;var p=this.innerColor;this.outerFill;var v=this.outerColor,f=this.borderColor,y=s.box,o=s.screenBox,m=s.dataBox,l=s.viewBox,w=s.pixelRatio,_=(i[0]-m[0])*(l[2]-l[0])/(m[2]-m[0])+l[0],h=(i[1]-m[1])*(l[3]-l[1])/(m[3]-m[1])+l[1],b=(i[2]-m[0])*(l[2]-l[0])/(m[2]-m[0])+l[0],u=(i[3]-m[1])*(l[3]-l[1])/(m[3]-m[1])+l[1];if(_=Math.max(_,l[0]),h=Math.max(h,l[1]),b=Math.min(b,l[2]),u=Math.min(u,l[3]),!(b<_||u<h)){y.bind();var L=o[2]-o[0],T=o[3]-o[1];if(this.outerFill&&(y.drawBox(0,0,L,h,v),y.drawBox(0,h,_,u,v),y.drawBox(0,u,L,T,v),y.drawBox(b,h,L,u,v)),this.innerFill&&y.drawBox(_,h,b,u,p),x>0){var k=x*w;y.drawBox(_-k,h-k,b+k,h+k,f),y.drawBox(_-k,u-k,b+k,u+k,f),y.drawBox(_-k,h-k,_+k,u+k,f),y.drawBox(b-k,h-k,b+k,u+k,f)}}}},t.update=function(s){s=s||{},this.innerFill=!!s.innerFill,this.outerFill=!!s.outerFill,this.innerColor=(s.innerColor||[0,0,0,.5]).slice(),this.outerColor=(s.outerColor||[0,0,0,.5]).slice(),this.borderColor=(s.borderColor||[0,0,0,1]).slice(),this.borderWidth=s.borderWidth||0,this.selectBox=(s.selectBox||this.selectBox).slice()},t.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)};function c(s,i){var x=s.gl,p=a(x,[0,0,0,1,1,0,1,1]),v=e(x,n.boxVertex,n.boxFragment),f=new r(s,p,v);return f.update(i),s.addOverlay(f),f}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(g,S,M){S.exports=x;var e=g("gl-fbo"),a=g("typedarray-pool"),n=g("ndarray"),r=g("bit-twiddle").nextPow2,t=function(p,v,f){for(var y=1e8,o=-1,m=-1,l=p.shape[0],w=p.shape[1],_=0;_<l;_++)for(var h=0;h<w;h++){var b=p.get(_,h,0),u=p.get(_,h,1),L=p.get(_,h,2),T=p.get(_,h,3);if(b<255||u<255||L<255||T<255){var k=v-_,P=f-h,z=k*k+P*P;z<y&&(y=z,o=_,m=h)}}return[o,m,y]};function c(p,v,f,y,o){this.coord=[p,v],this.id=f,this.value=y,this.distance=o}function s(p,v,f){this.gl=p,this.fbo=v,this.buffer=f,this._readTimeout=null;var y=this;this._readCallback=function(){!y.gl||(v.bind(),p.readPixels(0,0,v.shape[0],v.shape[1],p.RGBA,p.UNSIGNED_BYTE,y.buffer),y._readTimeout=null)}}var i=s.prototype;Object.defineProperty(i,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(p){if(!!this.gl){this.fbo.shape=p;var v=this.fbo.shape[0],f=this.fbo.shape[1];if(f*v*4>this.buffer.length){a.free(this.buffer);for(var y=this.buffer=a.mallocUint8(r(f*v*4)),o=0;o<f*v*4;++o)y[o]=255}return p}}}),i.begin=function(){var p=this.gl;this.shape,p&&(this.fbo.bind(),p.clearColor(1,1,1,1),p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT))},i.end=function(){var p=this.gl;!p||(p.bindFramebuffer(p.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},i.query=function(p,v,f){if(!this.gl)return null;var y=this.fbo.shape.slice();p=p|0,v=v|0,typeof f!="number"&&(f=1);var o=Math.min(Math.max(p-f,0),y[0])|0,m=Math.min(Math.max(p+f,0),y[0])|0,l=Math.min(Math.max(v-f,0),y[1])|0,w=Math.min(Math.max(v+f,0),y[1])|0;if(m<=o||w<=l)return null;var _=[m-o,w-l],h=n(this.buffer,[_[0],_[1],4],[4,y[0]*4,1],4*(o+y[0]*l)),b=t(h.hi(_[0],_[1],1),f,f),u=b[0],L=b[1];if(u<0||Math.pow(this.radius,2)<b[2])return null;var T=h.get(u,L,0),k=h.get(u,L,1),P=h.get(u,L,2),z=h.get(u,L,3);return new c(u+o|0,L+l|0,T,[k,P,z],Math.sqrt(b[2]))},i.dispose=function(){!this.gl||(this.fbo.dispose(),a.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))};function x(p,v){var f=v[0],y=v[1],o={},m=e(p,f,y,o),l=a.mallocUint8(f*y*4);return new s(p,m,l)}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(g,S,M){var e=g("./lib/create-uniforms"),a=g("./lib/create-attributes"),n=g("./lib/reflect"),r=g("./lib/shader-cache"),t=g("./lib/runtime-reflect"),c=g("./lib/GLError");function s(v){this.gl=v,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var i=s.prototype;i.bind=function(){this.program||this._relink();var v,f=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),y=this.gl.lastAttribCount;if(f>y)for(v=y;v<f;v++)this.gl.enableVertexAttribArray(v);else if(y>f)for(v=f;v<y;v++)this.gl.disableVertexAttribArray(v);this.gl.lastAttribCount=f,this.gl.useProgram(this.program)},i.dispose=function(){for(var v=this.gl.lastAttribCount,f=0;f<v;f++)this.gl.disableVertexAttribArray(f);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null};function x(v,f){return v.name<f.name?-1:1}i.update=function(v,f,y,o){if(!f||arguments.length===1){var m=v;v=m.vertex,f=m.fragment,y=m.uniforms,o=m.attributes}var l=this,w=l.gl,_=l._vref;l._vref=r.shader(w,w.VERTEX_SHADER,v),_&&_.dispose(),l.vertShader=l._vref.shader;var h=this._fref;if(l._fref=r.shader(w,w.FRAGMENT_SHADER,f),h&&h.dispose(),l.fragShader=l._fref.shader,!y||!o){var b=w.createProgram();if(w.attachShader(b,l.fragShader),w.attachShader(b,l.vertShader),w.linkProgram(b),!w.getProgramParameter(b,w.LINK_STATUS)){var u=w.getProgramInfoLog(b);throw new c(u,"Error linking program:"+u)}y=y||t.uniforms(w,b),o=o||t.attributes(w,b),w.deleteProgram(b)}o=o.slice(),o.sort(x);var L=[],T=[],k=[],P;for(P=0;P<o.length;++P){var z=o[P];if(z.type.indexOf("mat")>=0){for(var I=z.type.charAt(z.type.length-1)|0,D=new Array(I),R=0;R<I;++R)D[R]=k.length,T.push(z.name+"["+R+"]"),typeof z.location=="number"?k.push(z.location+R):Array.isArray(z.location)&&z.location.length===I&&typeof z.location[R]=="number"?k.push(z.location[R]|0):k.push(-1);L.push({name:z.name,type:z.type,locations:D})}else L.push({name:z.name,type:z.type,locations:[k.length]}),T.push(z.name),typeof z.location=="number"?k.push(z.location|0):k.push(-1)}var O=0;for(P=0;P<k.length;++P)if(k[P]<0){for(;k.indexOf(O)>=0;)O+=1;k[P]=O}var F=new Array(y.length);function N(){l.program=r.program(w,l._vref,l._fref,T,k);for(var G=0;G<y.length;++G)F[G]=w.getUniformLocation(l.program,y[G].name)}N(),l._relink=N,l.types={uniforms:n(y),attributes:n(o)},l.attributes=a(w,l,L,k),Object.defineProperty(l,"uniforms",e(w,l,y,F))};function p(v,f,y,o,m){var l=new s(v);return l.update(f,y,o,m),l}S.exports=p},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(g,S,M){function e(a,n,r){this.shortMessage=n||"",this.longMessage=r||"",this.rawError=a||"",this.message="gl-shader: "+(n||a||"")+(r?`
`+r:""),this.stack=new Error().stack}e.prototype=new Error,e.prototype.name="GLError",e.prototype.constructor=e,S.exports=e},{}],134:[function(g,S,M){S.exports=s;var e=g("./GLError");function a(i,x,p,v,f,y){this._gl=i,this._wrapper=x,this._index=p,this._locations=v,this._dimension=f,this._constFunc=y}var n=a.prototype;n.pointer=function(x,p,v,f){var y=this,o=y._gl,m=y._locations[y._index];o.vertexAttribPointer(m,y._dimension,x||o.FLOAT,!!p,v||0,f||0),o.enableVertexAttribArray(m)},n.set=function(i,x,p,v){return this._constFunc(this._locations[this._index],i,x,p,v)},Object.defineProperty(n,"location",{get:function(){return this._locations[this._index]},set:function(i){return i!==this._locations[this._index]&&(this._locations[this._index]=i|0,this._wrapper.program=null),i|0}});var r=[function(i,x,p){return p.length===void 0?i.vertexAttrib1f(x,p):i.vertexAttrib1fv(x,p)},function(i,x,p,v){return p.length===void 0?i.vertexAttrib2f(x,p,v):i.vertexAttrib2fv(x,p)},function(i,x,p,v,f){return p.length===void 0?i.vertexAttrib3f(x,p,v,f):i.vertexAttrib3fv(x,p)},function(i,x,p,v,f,y){return p.length===void 0?i.vertexAttrib4f(x,p,v,f,y):i.vertexAttrib4fv(x,p)}];function t(i,x,p,v,f,y,o){var m=r[f],l=new a(i,x,p,v,f,m);Object.defineProperty(y,o,{set:function(w){return i.disableVertexAttribArray(v[p]),m(i,v[p],w),w},get:function(){return l},enumerable:!0})}function c(i,x,p,v,f,y,o){for(var m=new Array(f),l=new Array(f),w=0;w<f;++w)t(i,x,p[w],v,f,m,w),l[w]=m[w];Object.defineProperty(m,"location",{set:function(b){if(Array.isArray(b))for(var u=0;u<f;++u)l[u].location=b[u];else for(var u=0;u<f;++u)l[u].location=b+u;return b},get:function(){for(var b=new Array(f),u=0;u<f;++u)b[u]=v[p[u]];return b},enumerable:!0}),m.pointer=function(b,u,L,T){b=b||i.FLOAT,u=!!u,L=L||f*f,T=T||0;for(var k=0;k<f;++k){var P=v[p[k]];i.vertexAttribPointer(P,f,b,u,L,T+k*f),i.enableVertexAttribArray(P)}};var _=new Array(f),h=i["vertexAttrib"+f+"fv"];Object.defineProperty(y,o,{set:function(b){for(var u=0;u<f;++u){var L=v[p[u]];if(i.disableVertexAttribArray(L),Array.isArray(b[0]))h.call(i,L,b[u]);else{for(var T=0;T<f;++T)_[T]=b[f*u+T];h.call(i,L,_)}}return b},get:function(){return m},enumerable:!0})}function s(i,x,p,v){for(var f={},y=0,o=p.length;y<o;++y){var m=p[y],l=m.name,w=m.type,_=m.locations;switch(w){case"bool":case"int":case"float":t(i,x,_[0],v,1,f,l);break;default:if(w.indexOf("vec")>=0){var h=w.charCodeAt(w.length-1)-48;if(h<2||h>4)throw new e("","Invalid data type for attribute "+l+": "+w);t(i,x,_[0],v,h,f,l)}else if(w.indexOf("mat")>=0){var h=w.charCodeAt(w.length-1)-48;if(h<2||h>4)throw new e("","Invalid data type for attribute "+l+": "+w);c(i,x,_,v,h,f,l)}else throw new e("","Unknown data type for attribute "+l+": "+w);break}}return f}},{"./GLError":133}],135:[function(g,S,M){var e=g("./reflect"),a=g("./GLError");S.exports=t;function n(c){return function(){return c}}function r(c,s){for(var i=new Array(c),x=0;x<c;++x)i[x]=s;return i}function t(c,s,i,x){function p(w){return function(_,h,b){return _.getUniform(h.program,b[w])}}function v(w){return function(h){for(var b=f("",w),u=0;u<b.length;++u){var L=b[u],T=L[0],k=L[1];if(x[k]){var P=h;if(typeof T=="string"&&(T.indexOf(".")===0||T.indexOf("[")===0)){var z=T;if(T.indexOf(".")===0&&(z=T.slice(1)),z.indexOf("]")===z.length-1){var I=z.indexOf("["),D=z.slice(0,I),R=z.slice(I+1,z.length-1);P=D?h[D][R]:h[R]}else P=h[z]}var O=i[k].type,F;switch(O){case"bool":case"int":case"sampler2D":case"samplerCube":c.uniform1i(x[k],P);break;case"float":c.uniform1f(x[k],P);break;default:var N=O.indexOf("vec");if(0<=N&&N<=1&&O.length===4+N){if(F=O.charCodeAt(O.length-1)-48,F<2||F>4)throw new a("","Invalid data type");switch(O.charAt(0)){case"b":case"i":c["uniform"+F+"iv"](x[k],P);break;case"v":c["uniform"+F+"fv"](x[k],P);break;default:throw new a("","Unrecognized data type for vector "+name+": "+O)}}else if(O.indexOf("mat")===0&&O.length===4){if(F=O.charCodeAt(O.length-1)-48,F<2||F>4)throw new a("","Invalid uniform dimension type for matrix "+name+": "+O);c["uniformMatrix"+F+"fv"](x[k],!1,P);break}else throw new a("","Unknown uniform data type for "+name+": "+O)}}}}}function f(w,_){if(typeof _!="object")return[[w,_]];var h=[];for(var b in _){var u=_[b],L=w;parseInt(b)+""===b?L+="["+b+"]":L+="."+b,typeof u=="object"?h.push.apply(h,f(L,u)):h.push([L,u])}return h}function y(w){switch(w){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var _=w.indexOf("vec");if(0<=_&&_<=1&&w.length===4+_){var h=w.charCodeAt(w.length-1)-48;if(h<2||h>4)throw new a("","Invalid data type");return w.charAt(0)==="b"?r(h,!1):r(h,0)}else if(w.indexOf("mat")===0&&w.length===4){var h=w.charCodeAt(w.length-1)-48;if(h<2||h>4)throw new a("","Invalid uniform dimension type for matrix "+name+": "+w);return r(h*h,0)}else throw new a("","Unknown uniform data type for "+name+": "+w)}}function o(w,_,h){if(typeof h=="object"){var b=m(h);Object.defineProperty(w,_,{get:n(b),set:v(h),enumerable:!0,configurable:!1})}else x[h]?Object.defineProperty(w,_,{get:p(h),set:v(h),enumerable:!0,configurable:!1}):w[_]=y(i[h].type)}function m(w){var _;if(Array.isArray(w)){_=new Array(w.length);for(var h=0;h<w.length;++h)o(_,h,w[h])}else{_={};for(var b in w)o(_,b,w[b])}return _}var l=e(i,!0);return{get:n(m(l)),set:v(l),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(g,S,M){S.exports=e;function e(a,n){for(var r={},t=0;t<a.length;++t)for(var c=a[t].name,s=c.split("."),i=r,x=0;x<s.length;++x){var p=s[x].split("[");if(p.length>1){p[0]in i||(i[p[0]]=[]),i=i[p[0]];for(var v=1;v<p.length;++v){var f=parseInt(p[v]);v<p.length-1||x<s.length-1?(f in i||(v<p.length-1?i[f]=[]:i[f]={}),i=i[f]):n?i[f]=t:i[f]=a[t].type}}else x<s.length-1?(p[0]in i||(i[p[0]]={}),i=i[p[0]]):n?i[p[0]]=t:i[p[0]]=a[t].type}return r}},{}],137:[function(g,S,M){M.uniforms=r,M.attributes=t;var e={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},a=null;function n(c,s){if(!a){var i=Object.keys(e);a={};for(var x=0;x<i.length;++x){var p=i[x];a[c[p]]=e[p]}}return a[s]}function r(c,s){for(var i=c.getProgramParameter(s,c.ACTIVE_UNIFORMS),x=[],p=0;p<i;++p){var v=c.getActiveUniform(s,p);if(v){var f=n(c,v.type);if(v.size>1)for(var y=0;y<v.size;++y)x.push({name:v.name.replace("[0]","["+y+"]"),type:f});else x.push({name:v.name,type:f})}}return x}function t(c,s){for(var i=c.getProgramParameter(s,c.ACTIVE_ATTRIBUTES),x=[],p=0;p<i;++p){var v=c.getActiveAttrib(s,p);v&&x.push({name:v.name,type:n(c,v.type)})}return x}},{}],138:[function(g,S,M){M.shader=f,M.program=y;var e=g("./GLError"),a=g("gl-format-compiler-error"),n=typeof WeakMap>"u"?g("weakmap-shim"):WeakMap,r=new n,t=0;function c(o,m,l,w,_,h,b){this.id=o,this.src=m,this.type=l,this.shader=w,this.count=h,this.programs=[],this.cache=b}c.prototype.dispose=function(){if(--this.count===0){for(var o=this.cache,m=o.gl,l=this.programs,w=0,_=l.length;w<_;++w){var h=o.programs[l[w]];h&&(delete o.programs[w],m.deleteProgram(h))}m.deleteShader(this.shader),delete o.shaders[this.type===m.FRAGMENT_SHADER|0][this.src]}};function s(o){this.gl=o,this.shaders=[{},{}],this.programs={}}var i=s.prototype;function x(o,m,l){var w=o.createShader(m);if(o.shaderSource(w,l),o.compileShader(w),!o.getShaderParameter(w,o.COMPILE_STATUS)){var _=o.getShaderInfoLog(w);try{var h=a(_,l,m)}catch(b){throw console.warn("Failed to format compiler error: "+b),new e(_,`Error compiling shader:
`+_)}throw new e(_,h.short,h.long)}return w}i.getShaderReference=function(o,m){var l=this.gl,w=this.shaders[o===l.FRAGMENT_SHADER|0],_=w[m];if(!_||!l.isShader(_.shader)){var h=x(l,o,m);_=w[m]=new c(t++,m,o,h,[],1,this)}else _.count+=1;return _};function p(o,m,l,w,_){var h=o.createProgram();o.attachShader(h,m),o.attachShader(h,l);for(var b=0;b<w.length;++b)o.bindAttribLocation(h,_[b],w[b]);if(o.linkProgram(h),!o.getProgramParameter(h,o.LINK_STATUS)){var u=o.getProgramInfoLog(h);throw new e(u,"Error linking program: "+u)}return h}i.getProgram=function(o,m,l,w){var _=[o.id,m.id,l.join(":"),w.join(":")].join("@"),h=this.programs[_];return(!h||!this.gl.isProgram(h))&&(this.programs[_]=h=p(this.gl,o.shader,m.shader,l,w),o.programs.push(_),m.programs.push(_)),h};function v(o){var m=r.get(o);return m||(m=new s(o),r.set(o,m)),m}function f(o,m,l){return v(o).getShaderReference(m,l)}function y(o,m,l,w,_){return v(o).getProgram(m,l,w,_)}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(g,S,M){S.exports=n;function e(r){this.plot=r,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}var a=e.prototype;a.update=function(r){r=r||{},this.enable=(r.enable||[!0,!0,!1,!1]).slice(),this.width=(r.width||[1,1,1,1]).slice(),this.color=(r.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(t){return t.slice()}),this.center=(r.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},a.draw=function(){var r=this.enable,t=this.width,c=this.color,s=this.center,i=this.plot,x=i.line,p=i.dataBox,v=i.viewBox;if(x.bind(),p[0]<=s[0]&&s[0]<=p[2]&&p[1]<=s[1]&&s[1]<=p[3]){var f=v[0]+(s[0]-p[0])/(p[2]-p[0])*(v[2]-v[0]),y=v[1]+(s[1]-p[1])/(p[3]-p[1])*(v[3]-v[1]);r[0]&&x.drawLine(f,y,v[0],y,t[0],c[0]),r[1]&&x.drawLine(f,y,f,v[1],t[1],c[1]),r[2]&&x.drawLine(f,y,v[2],y,t[2],c[2]),r[3]&&x.drawLine(f,y,f,v[3],t[3],c[3])}},a.dispose=function(){this.plot.removeOverlay(this)};function n(r,t){var c=new e(r);return c.update(t),r.addOverlay(c),c}},{}],140:[function(g,S,M){var e=g("glslify"),a=g("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),r=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);S.exports=function(t){return a(t,n,r,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(g,S,M){var e=g("gl-buffer"),a=g("gl-vao"),n=g("./shaders/index");S.exports=p;var r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(v,f,y,o){this.gl=v,this.buffer=f,this.vao=y,this.shader=o,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var c=t.prototype,s=[0,0,0],i=[0,0,0],x=[0,0];c.isTransparent=function(){return!1},c.drawTransparent=function(v){},c.draw=function(v){var f=this.gl,y=this.vao,o=this.shader;y.bind(),o.bind();var m=v.model||r,l=v.view||r,w=v.projection||r,_;this.axes&&(_=this.axes.lastCubeProps.axis);for(var h=s,b=i,u=0;u<3;++u)_&&_[u]<0?(h[u]=this.bounds[0][u],b[u]=this.bounds[1][u]):(h[u]=this.bounds[1][u],b[u]=this.bounds[0][u]);x[0]=f.drawingBufferWidth,x[1]=f.drawingBufferHeight,o.uniforms.model=m,o.uniforms.view=l,o.uniforms.projection=w,o.uniforms.coordinates=[this.position,h,b],o.uniforms.colors=this.colors,o.uniforms.screenShape=x;for(var u=0;u<3;++u)o.uniforms.lineWidth=this.lineWidth[u]*this.pixelRatio,this.enabled[u]&&(y.draw(f.TRIANGLES,6,6*u),this.drawSides[u]&&y.draw(f.TRIANGLES,12,18+12*u));y.unbind()},c.update=function(v){!v||("bounds"in v&&(this.bounds=v.bounds),"position"in v&&(this.position=v.position),"lineWidth"in v&&(this.lineWidth=v.lineWidth),"colors"in v&&(this.colors=v.colors),"enabled"in v&&(this.enabled=v.enabled),"drawSides"in v&&(this.drawSides=v.drawSides))},c.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};function p(v,f){var y=[];function o(h,b,u,L,T,k){var P=[h,b,u,0,0,0,1];P[L+3]=1,P[L]=T,y.push.apply(y,P),P[6]=-1,y.push.apply(y,P),P[L]=k,y.push.apply(y,P),y.push.apply(y,P),P[6]=1,y.push.apply(y,P),P[L]=T,y.push.apply(y,P)}o(0,0,0,0,0,1),o(0,0,0,1,0,1),o(0,0,0,2,0,1),o(1,0,0,1,-1,1),o(1,0,0,2,-1,1),o(0,1,0,0,-1,1),o(0,1,0,2,-1,1),o(0,0,1,0,-1,1),o(0,0,1,1,-1,1);var m=e(v,y),l=a(v,[{type:v.FLOAT,buffer:m,size:3,offset:0,stride:28},{type:v.FLOAT,buffer:m,size:3,offset:12,stride:28},{type:v.FLOAT,buffer:m,size:1,offset:24,stride:28}]),w=n(v);w.attributes.position.location=0,w.attributes.color.location=1,w.attributes.weight.location=2;var _=new t(v,m,l,w);return _.update(f),_}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(g,S,M){var e=g("glslify"),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),r=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),t=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);M.meshShader={vertex:a,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},M.pickShader={vertex:r,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(g,S,M){var e=g("gl-vec3"),a=g("gl-vec4"),n=["xyz","xzy","yxz","yzx","zxy","zyx"],r=function(y,o,m,l){for(var w=y.points,_=y.velocities,h=y.divergences,b=[],u=[],L=[],T=[],k=[],P=[],z=0,I=0,D=a.create(),R=a.create(),O=8,F=0;F<w.length;F++){var N=w[F],G=_[F],K=h[F];o===0&&(K=m*.05),I=e.length(G)/l,D=a.create(),e.copy(D,G),D[3]=K;for(var W=0;W<O;W++)k[W]=[N[0],N[1],N[2],W];if(T.length>0)for(var W=0;W<O;W++){var Y=(W+1)%O;b.push(T[W],k[W],k[Y],k[Y],T[Y],T[W]),L.push(R,D,D,D,R,R),P.push(z,I,I,I,z,z);var re=b.length;u.push([re-6,re-5,re-4],[re-3,re-2,re-1])}var ue=T;T=k,k=ue;var j=R;R=D,D=j;var q=z;z=I,I=q}return{positions:b,cells:u,vectors:L,vertexIntensity:P}},t=function(y,o,m,l){for(var w=0,_=0;_<y.length;_++)for(var h=y[_].velocities,b=0;b<h.length;b++)w=Math.max(w,e.length(h[b]));for(var u=y.map(function(F){return r(F,m,l,w)}),L=[],T=[],k=[],P=[],_=0;_<u.length;_++){var z=u[_],I=L.length;L=L.concat(z.positions),k=k.concat(z.vectors),P=P.concat(z.vertexIntensity);for(var b=0;b<z.cells.length;b++){var D=z.cells[b],R=[];T.push(R);for(var O=0;O<D.length;O++)R.push(D[O]+I)}}return{positions:L,cells:T,vectors:k,vertexIntensity:P,colormap:o}},c=function(y,o){var m=y.length,l;for(l=0;l<m;l++){var w=y[l];if(w===o)return l;if(w>o)return l-1}return l},s=function(y,o,m){return y<o?o:y>m?m:y},i=function(y,o,m){var l=o.vectors,w=o.meshgrid,_=y[0],h=y[1],b=y[2],u=w[0].length,L=w[1].length,T=w[2].length,k=c(w[0],_),P=c(w[1],h),z=c(w[2],b),I=k+1,D=P+1,R=z+1;if(k=s(k,0,u-1),I=s(I,0,u-1),P=s(P,0,L-1),D=s(D,0,L-1),z=s(z,0,T-1),R=s(R,0,T-1),k<0||P<0||z<0||I>u-1||D>L-1||R>T-1)return e.create();var O=w[0][k],F=w[0][I],N=w[1][P],G=w[1][D],K=w[2][z],W=w[2][R],Y=(_-O)/(F-O),re=(h-N)/(G-N),ue=(b-K)/(W-K);isFinite(Y)||(Y=.5),isFinite(re)||(re=.5),isFinite(ue)||(ue=.5);var j,q,V,U,$,ne;switch(m.reversedX&&(k=u-1-k,I=u-1-I),m.reversedY&&(P=L-1-P,D=L-1-D),m.reversedZ&&(z=T-1-z,R=T-1-R),m.filled){case 5:$=z,ne=R,V=P*T,U=D*T,j=k*T*L,q=I*T*L;break;case 4:$=z,ne=R,j=k*T,q=I*T,V=P*T*u,U=D*T*u;break;case 3:V=P,U=D,$=z*L,ne=R*L,j=k*L*T,q=I*L*T;break;case 2:V=P,U=D,j=k*L,q=I*L,$=z*L*u,ne=R*L*u;break;case 1:j=k,q=I,$=z*u,ne=R*u,V=P*u*T,U=D*u*T;break;default:j=k,q=I,V=P*u,U=D*u,$=z*u*L,ne=R*u*L;break}var X=l[j+V+$],Q=l[j+V+ne],ie=l[j+U+$],se=l[j+U+ne],ae=l[q+V+$],oe=l[q+V+ne],be=l[q+U+$],ce=l[q+U+ne],de=e.create(),ye=e.create(),ge=e.create(),me=e.create();e.lerp(de,X,ae,Y),e.lerp(ye,Q,oe,Y),e.lerp(ge,ie,be,Y),e.lerp(me,se,ce,Y);var Ee=e.create(),Pe=e.create();e.lerp(Ee,de,ge,re),e.lerp(Pe,ye,me,re);var Ne=e.create();return e.lerp(Ne,Ee,Pe,ue),Ne},x=function(y){var o=1/0;y.sort(function(_,h){return _-h});for(var m=y.length,l=1;l<m;l++){var w=Math.abs(y[l]-y[l-1]);w<o&&(o=w)}return o},p=function(y){for(var o=[],m=[],l=[],w={},_={},h={},b=y.length,u=0;u<b;u++){var L=y[u],T=L[0],k=L[1],P=L[2];w[T]||(o.push(T),w[T]=!0),_[k]||(m.push(k),_[k]=!0),h[P]||(l.push(P),h[P]=!0)}var z=x(o),I=x(m),D=x(l),R=Math.min(z,I,D);return isFinite(R)?R:1};S.exports=function(y,o){var m=y.startingPositions,l=y.maxLength||1e3,w=y.tubeSize||1,_=y.absoluteTubeSize,h=y.gridFill||"+x+y+z",b={};h.indexOf("-x")!==-1&&(b.reversedX=!0),h.indexOf("-y")!==-1&&(b.reversedY=!0),h.indexOf("-z")!==-1&&(b.reversedZ=!0),b.filled=n.indexOf(h.replace(/-/g,"").replace(/\+/g,""));var u=y.getVelocity||function(oe){return i(oe,y,b)},L=y.getDivergence||function(oe,be){var ce=e.create(),de=1e-4;e.add(ce,oe,[de,0,0]);var ye=u(ce);e.subtract(ye,ye,be),e.scale(ye,ye,1/de),e.add(ce,oe,[0,de,0]);var ge=u(ce);e.subtract(ge,ge,be),e.scale(ge,ge,1/de),e.add(ce,oe,[0,0,de]);var me=u(ce);return e.subtract(me,me,be),e.scale(me,me,1/de),e.add(ce,ye,ge),e.add(ce,ce,me),ce},T=[],k=o[0][0],P=o[0][1],z=o[0][2],I=o[1][0],D=o[1][1],R=o[1][2],O=function(oe){var be=oe[0],ce=oe[1],de=oe[2];return!(be<k||be>I||ce<P||ce>D||de<z||de>R)},F=e.distance(o[0],o[1]),N=10*F/l,G=N*N,K=1,W=0,Y=m.length;Y>1&&(K=p(m));for(var re=0;re<Y;re++){var ue=e.create();e.copy(ue,m[re]);var j=[ue],q=[],V=u(ue),U=ue;q.push(V);var $=[],ne=L(ue,V),X=e.length(ne);isFinite(X)&&X>W&&(W=X),$.push(X),T.push({points:j,velocities:q,divergences:$});for(var Q=0;Q<l*100&&j.length<l&&O(ue);){Q++;var ie=e.clone(V),se=e.squaredLength(ie);if(se===0)break;if(se>G&&e.scale(ie,ie,N/Math.sqrt(se)),e.add(ie,ie,ue),V=u(ie),e.squaredDistance(U,ie)-G>-1e-4*G){j.push(ie),U=ie,q.push(V);var ne=L(ie,V),X=e.length(ne);isFinite(X)&&X>W&&(W=X),$.push(X)}ue=ie}}var ae=t(T,y.colormap,W,K);return _?ae.tubeScale=_:(W===0&&(W=1),ae.tubeScale=w*.5*K/W),ae};var v=g("./lib/shaders"),f=g("gl-cone3d").createMesh;S.exports.createTubeMesh=function(y,o){return f(y,o,{shaders:v,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(g,S,M){var e=g("gl-shader"),a=g("glslify"),n=a([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),r=a([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color \u2014 in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),t=a([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),c=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);M.createShader=function(s){var i=e(s,n,r,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},M.createPickShader=function(s){var i=e(s,n,c,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},M.createContourShader=function(s){var i=e(s,t,r,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i},M.createPickContourShader=function(s){var i=e(s,t,c,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i}},{"gl-shader":132,glslify:231}],145:[function(g,S,M){S.exports=q;var e=g("bit-twiddle"),a=g("gl-buffer"),n=g("gl-vao"),r=g("gl-texture2d"),t=g("typedarray-pool"),c=g("colormap"),s=g("ndarray-ops"),i=g("ndarray-pack"),x=g("ndarray"),p=g("surface-nets"),v=g("gl-mat4/multiply"),f=g("gl-mat4/invert"),y=g("binary-search-bounds"),o=g("ndarray-gradient"),m=g("./lib/shaders"),l=m.createShader,w=m.createContourShader,_=m.createPickShader,h=m.createPickContourShader,b=4*(4+3+3),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],L=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],T=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var V=0;V<3;++V){var U=T[V],$=(V+1)%3,ne=(V+2)%3;U[$+0]=1,U[ne+3]=1,U[V+6]=1}})();function k(V,U,$,ne,X){this.position=V,this.index=U,this.uv=$,this.level=ne,this.dataCoordinate=X}var P=256;function z(V,U,$,ne,X,Q,ie,se,ae,oe,be,ce,de,ye,ge){this.gl=V,this.shape=U,this.bounds=$,this.objectOffset=ge,this.intensityBounds=[],this._shader=ne,this._pickShader=X,this._coordinateBuffer=Q,this._vao=ie,this._colorMap=se,this._contourShader=ae,this._contourPickShader=oe,this._contourBuffer=be,this._contourVAO=ce,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new k([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=de,this._dynamicVAO=ye,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[x(t.mallocFloat(1024),[0,0]),x(t.mallocFloat(1024),[0,0]),x(t.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var I=z.prototype;I.genColormap=function(V,U){var $=!1,ne=i([c({colormap:V,nshades:P,format:"rgba"}).map(function(X,Q){var ie=U?D(Q/255,U):X[3];return ie<1&&($=!0),[X[0],X[1],X[2],255*ie]})]);return s.divseq(ne,255),this.hasAlphaScale=$,ne},I.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},I.isOpaque=function(){return!this.isTransparent()},I.pickSlots=1,I.setPickBase=function(V){this.pickId=V};function D(V,U){if(!U||!U.length)return 1;for(var $=0;$<U.length;++$){if(U.length<2)return 1;if(U[$][0]===V)return U[$][1];if(U[$][0]>V&&$>0){var ne=(U[$][0]-V)/(U[$][0]-U[$-1][0]);return U[$][1]*(1-ne)+ne*U[$-1][1]}}return 1}var R=[0,0,0],O={showSurface:!1,showContour:!1,projections:[u.slice(),u.slice(),u.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function F(V,U){var $,ne,X,Q=U.axes&&U.axes.lastCubeProps.axis||R,ie=U.showSurface,se=U.showContour;for($=0;$<3;++$)for(ie=ie||U.surfaceProject[$],ne=0;ne<3;++ne)se=se||U.contourProject[$][ne];for($=0;$<3;++$){var ae=O.projections[$];for(ne=0;ne<16;++ne)ae[ne]=0;for(ne=0;ne<4;++ne)ae[5*ne]=1;ae[5*$]=0,ae[12+$]=U.axesBounds[+(Q[$]>0)][$],v(ae,V.model,ae);var oe=O.clipBounds[$];for(X=0;X<2;++X)for(ne=0;ne<3;++ne)oe[X][ne]=V.clipBounds[X][ne];oe[0][$]=-1e8,oe[1][$]=1e8}return O.showSurface=ie,O.showContour=se,O}var N={model:u,view:u,projection:u,inverseModel:u.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},G=u.slice(),K=[1,0,0,0,1,0,0,0,1];function W(V,U){V=V||{};var $=this.gl;$.disable($.CULL_FACE),this._colorMap.bind(0);var ne=N;ne.model=V.model||u,ne.view=V.view||u,ne.projection=V.projection||u,ne.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],ne.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],ne.objectOffset=this.objectOffset,ne.contourColor=this.contourColor[0],ne.inverseModel=f(ne.inverseModel,ne.model);for(var X=0;X<2;++X)for(var Q=ne.clipBounds[X],ie=0;ie<3;++ie)Q[ie]=Math.min(Math.max(this.clipBounds[X][ie],-1e8),1e8);ne.kambient=this.ambientLight,ne.kdiffuse=this.diffuseLight,ne.kspecular=this.specularLight,ne.roughness=this.roughness,ne.fresnel=this.fresnel,ne.opacity=this.opacity,ne.height=0,ne.permutation=K,ne.vertexColor=this.vertexColor;var se=G;for(v(se,ne.view,ne.model),v(se,ne.projection,se),f(se,se),X=0;X<3;++X)ne.eyePosition[X]=se[12+X]/se[15];var ae=se[15];for(X=0;X<3;++X)ae+=this.lightPosition[X]*se[4*X+3];for(X=0;X<3;++X){var oe=se[12+X];for(ie=0;ie<3;++ie)oe+=se[4*ie+X]*this.lightPosition[ie];ne.lightPosition[X]=oe/ae}var be=F(ne,this);if(be.showSurface){for(this._shader.bind(),this._shader.uniforms=ne,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw($.TRIANGLES,this._vertexCount),X=0;X<3;++X)!this.surfaceProject[X]||!this.vertexCount||(this._shader.uniforms.model=be.projections[X],this._shader.uniforms.clipBounds=be.clipBounds[X],this._vao.draw($.TRIANGLES,this._vertexCount));this._vao.unbind()}if(be.showContour){var ce=this._contourShader;ne.kambient=1,ne.kdiffuse=0,ne.kspecular=0,ne.opacity=1,ce.bind(),ce.uniforms=ne;var de=this._contourVAO;for(de.bind(),X=0;X<3;++X)for(ce.uniforms.permutation=T[X],$.lineWidth(this.contourWidth[X]*this.pixelRatio),ie=0;ie<this.contourLevels[X].length;++ie)ie===this.highlightLevel[X]?(ce.uniforms.contourColor=this.highlightColor[X],ce.uniforms.contourTint=this.highlightTint[X]):(ie===0||ie-1===this.highlightLevel[X])&&(ce.uniforms.contourColor=this.contourColor[X],ce.uniforms.contourTint=this.contourTint[X]),this._contourCounts[X][ie]&&(ce.uniforms.height=this.contourLevels[X][ie],de.draw($.LINES,this._contourCounts[X][ie],this._contourOffsets[X][ie]));for(X=0;X<3;++X)for(ce.uniforms.model=be.projections[X],ce.uniforms.clipBounds=be.clipBounds[X],ie=0;ie<3;++ie)if(!!this.contourProject[X][ie]){ce.uniforms.permutation=T[ie],$.lineWidth(this.contourWidth[ie]*this.pixelRatio);for(var ye=0;ye<this.contourLevels[ie].length;++ye)ye===this.highlightLevel[ie]?(ce.uniforms.contourColor=this.highlightColor[ie],ce.uniforms.contourTint=this.highlightTint[ie]):(ye===0||ye-1===this.highlightLevel[ie])&&(ce.uniforms.contourColor=this.contourColor[ie],ce.uniforms.contourTint=this.contourTint[ie]),this._contourCounts[ie][ye]&&(ce.uniforms.height=this.contourLevels[ie][ye],de.draw($.LINES,this._contourCounts[ie][ye],this._contourOffsets[ie][ye]))}for(de.unbind(),de=this._dynamicVAO,de.bind(),X=0;X<3;++X)if(this._dynamicCounts[X]!==0)for(ce.uniforms.model=ne.model,ce.uniforms.clipBounds=ne.clipBounds,ce.uniforms.permutation=T[X],$.lineWidth(this.dynamicWidth[X]*this.pixelRatio),ce.uniforms.contourColor=this.dynamicColor[X],ce.uniforms.contourTint=this.dynamicTint[X],ce.uniforms.height=this.dynamicLevel[X],de.draw($.LINES,this._dynamicCounts[X],this._dynamicOffsets[X]),ie=0;ie<3;++ie)!this.contourProject[ie][X]||(ce.uniforms.model=be.projections[ie],ce.uniforms.clipBounds=be.clipBounds[ie],de.draw($.LINES,this._dynamicCounts[X],this._dynamicOffsets[X]));de.unbind()}}I.draw=function(V){return W.call(this,V,!1)},I.drawTransparent=function(V){return W.call(this,V,!0)};var Y={model:u,view:u,projection:u,inverseModel:u,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};I.drawPick=function(V){V=V||{};var U=this.gl;U.disable(U.CULL_FACE);var $=Y;$.model=V.model||u,$.view=V.view||u,$.projection=V.projection||u,$.shape=this._field[2].shape,$.pickId=this.pickId/255,$.lowerBound=this.bounds[0],$.upperBound=this.bounds[1],$.objectOffset=this.objectOffset,$.permutation=K;for(var ne=0;ne<2;++ne)for(var X=$.clipBounds[ne],Q=0;Q<3;++Q)X[Q]=Math.min(Math.max(this.clipBounds[ne][Q],-1e8),1e8);var ie=F($,this);if(ie.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=$,this._vao.bind(),this._vao.draw(U.TRIANGLES,this._vertexCount),ne=0;ne<3;++ne)!this.surfaceProject[ne]||(this._pickShader.uniforms.model=ie.projections[ne],this._pickShader.uniforms.clipBounds=ie.clipBounds[ne],this._vao.draw(U.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ie.showContour){var se=this._contourPickShader;se.bind(),se.uniforms=$;var ae=this._contourVAO;for(ae.bind(),Q=0;Q<3;++Q)for(U.lineWidth(this.contourWidth[Q]*this.pixelRatio),se.uniforms.permutation=T[Q],ne=0;ne<this.contourLevels[Q].length;++ne)this._contourCounts[Q][ne]&&(se.uniforms.height=this.contourLevels[Q][ne],ae.draw(U.LINES,this._contourCounts[Q][ne],this._contourOffsets[Q][ne]));for(ne=0;ne<3;++ne)for(se.uniforms.model=ie.projections[ne],se.uniforms.clipBounds=ie.clipBounds[ne],Q=0;Q<3;++Q)if(!!this.contourProject[ne][Q]){se.uniforms.permutation=T[Q],U.lineWidth(this.contourWidth[Q]*this.pixelRatio);for(var oe=0;oe<this.contourLevels[Q].length;++oe)this._contourCounts[Q][oe]&&(se.uniforms.height=this.contourLevels[Q][oe],ae.draw(U.LINES,this._contourCounts[Q][oe],this._contourOffsets[Q][oe]))}ae.unbind()}},I.pick=function(V){if(!V||V.id!==this.pickId)return null;var U=this._field[2].shape,$=this._pickResult,ne=U[0]*(V.value[0]+(V.value[2]>>4)/16)/255,X=Math.floor(ne),Q=ne-X,ie=U[1]*(V.value[1]+(V.value[2]&15)/16)/255,se=Math.floor(ie),ae=ie-se;X+=1,se+=1;var oe=$.position;oe[0]=oe[1]=oe[2]=0;for(var be=0;be<2;++be)for(var ce=be?Q:1-Q,de=0;de<2;++de)for(var ye=de?ae:1-ae,ge=X+be,me=se+de,Ee=ce*ye,Pe=0;Pe<3;++Pe)oe[Pe]+=this._field[Pe].get(ge,me)*Ee;for(var Ne=this._pickResult.level,we=0;we<3;++we)if(Ne[we]=y.le(this.contourLevels[we],oe[we]),Ne[we]<0)this.contourLevels[we].length>0&&(Ne[we]=0);else if(Ne[we]<this.contourLevels[we].length-1){var ke=this.contourLevels[we][Ne[we]],Xe=this.contourLevels[we][Ne[we]+1];Math.abs(ke-oe[we])>Math.abs(Xe-oe[we])&&(Ne[we]+=1)}for($.index[0]=Q<.5?X:X+1,$.index[1]=ae<.5?se:se+1,$.uv[0]=ne/U[0],$.uv[1]=ie/U[1],Pe=0;Pe<3;++Pe)$.dataCoordinate[Pe]=this._field[Pe].get($.index[0],$.index[1]);return $},I.padField=function(V,U){var $=U.shape.slice(),ne=V.shape.slice();s.assign(V.lo(1,1).hi($[0],$[1]),U),s.assign(V.lo(1).hi($[0],1),U.hi($[0],1)),s.assign(V.lo(1,ne[1]-1).hi($[0],1),U.lo(0,$[1]-1).hi($[0],1)),s.assign(V.lo(0,1).hi(1,$[1]),U.hi(1)),s.assign(V.lo(ne[0]-1,1).hi(1,$[1]),U.lo($[0]-1)),V.set(0,0,U.get(0,0)),V.set(0,ne[1]-1,U.get(0,$[1]-1)),V.set(ne[0]-1,0,U.get($[0]-1,0)),V.set(ne[0]-1,ne[1]-1,U.get($[0]-1,$[1]-1))};function re(V,U){return Array.isArray(V)?[U(V[0]),U(V[1]),U(V[2])]:[U(V),U(V),U(V)]}function ue(V){return Array.isArray(V)?V.length===3?[V[0],V[1],V[2],1]:[V[0],V[1],V[2],V[3]]:[0,0,0,1]}function j(V){if(Array.isArray(V)){if(Array.isArray(V))return[ue(V[0]),ue(V[1]),ue(V[2])];var U=ue(V);return[U.slice(),U.slice(),U.slice()]}}I.update=function(V){V=V||{},this.objectOffset=V.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in V&&(this.contourWidth=re(V.contourWidth,Number)),"showContour"in V&&(this.showContour=re(V.showContour,Boolean)),"showSurface"in V&&(this.showSurface=!!V.showSurface),"contourTint"in V&&(this.contourTint=re(V.contourTint,Boolean)),"contourColor"in V&&(this.contourColor=j(V.contourColor)),"contourProject"in V&&(this.contourProject=re(V.contourProject,function(st){return re(st,Boolean)})),"surfaceProject"in V&&(this.surfaceProject=V.surfaceProject),"dynamicColor"in V&&(this.dynamicColor=j(V.dynamicColor)),"dynamicTint"in V&&(this.dynamicTint=re(V.dynamicTint,Number)),"dynamicWidth"in V&&(this.dynamicWidth=re(V.dynamicWidth,Number)),"opacity"in V&&(this.opacity=V.opacity),"opacityscale"in V&&(this.opacityscale=V.opacityscale),"colorBounds"in V&&(this.colorBounds=V.colorBounds),"vertexColor"in V&&(this.vertexColor=V.vertexColor?1:0),"colormap"in V&&this._colorMap.setPixels(this.genColormap(V.colormap,this.opacityscale));var U=V.field||V.coords&&V.coords[2]||null,$=!1;if(U||(this._field[2].shape[0]||this._field[2].shape[2]?U=this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):U=this._field[2].hi(0,0)),"field"in V||"coords"in V){var ne=(U.shape[0]+2)*(U.shape[1]+2);ne>this._field[2].data.length&&(t.freeFloat(this._field[2].data),this._field[2].data=t.mallocFloat(e.nextPow2(ne))),this._field[2]=x(this._field[2].data,[U.shape[0]+2,U.shape[1]+2]),this.padField(this._field[2],U),this.shape=U.shape.slice();for(var X=this.shape,Q=0;Q<2;++Q)this._field[2].size>this._field[Q].data.length&&(t.freeFloat(this._field[Q].data),this._field[Q].data=t.mallocFloat(this._field[2].size)),this._field[Q]=x(this._field[Q].data,[X[0]+2,X[1]+2]);if(V.coords){var ie=V.coords;if(!Array.isArray(ie)||ie.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(Q=0;Q<2;++Q){var se=ie[Q];for(de=0;de<2;++de)if(se.shape[de]!==X[de])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[Q],se)}}else if(V.ticks){var ae=V.ticks;if(!Array.isArray(ae)||ae.length!==2)throw new Error("gl-surface: invalid ticks");for(Q=0;Q<2;++Q){var oe=ae[Q];if((Array.isArray(oe)||oe.length)&&(oe=x(oe)),oe.shape[0]!==X[Q])throw new Error("gl-surface: invalid tick length");var be=x(oe.data,X);be.stride[Q]=oe.stride[0],be.stride[Q^1]=0,this.padField(this._field[Q],be)}}else{for(Q=0;Q<2;++Q){var ce=[0,0];ce[Q]=1,this._field[Q]=x(this._field[Q].data,[X[0]+2,X[1]+2],ce,0)}this._field[0].set(0,0,0);for(var de=0;de<X[0];++de)this._field[0].set(de+1,0,de);for(this._field[0].set(X[0]+1,0,X[0]-1),this._field[1].set(0,0,0),de=0;de<X[1];++de)this._field[1].set(0,de+1,de);this._field[1].set(0,X[1]+1,X[1]-1)}var ye=this._field,ge=x(t.mallocFloat(ye[2].size*3*2),[3,X[0]+2,X[1]+2,2]);for(Q=0;Q<3;++Q)o(ge.pick(Q),ye[Q],"mirror");var me=x(t.mallocFloat(ye[2].size*3),[X[0]+2,X[1]+2,3]);for(Q=0;Q<X[0]+2;++Q)for(de=0;de<X[1]+2;++de){var Ee=ge.get(0,Q,de,0),Pe=ge.get(0,Q,de,1),Ne=ge.get(1,Q,de,0),we=ge.get(1,Q,de,1),ke=ge.get(2,Q,de,0),Xe=ge.get(2,Q,de,1),He=Ne*Xe-we*ke,Ie=ke*Pe-Xe*Ee,De=Ee*we-Pe*Ne,Ge=Math.sqrt(He*He+Ie*Ie+De*De);Ge<1e-8?(Ge=Math.max(Math.abs(He),Math.abs(Ie),Math.abs(De)),Ge<1e-8?(De=1,Ie=He=0,Ge=1):Ge=1/Ge):Ge=1/Math.sqrt(Ge),me.set(Q,de,0,He*Ge),me.set(Q,de,1,Ie*Ge),me.set(Q,de,2,De*Ge)}t.free(ge.data);var ht=[1/0,1/0,1/0],Rt=[-1/0,-1/0,-1/0],Kt=1/0,It=-1/0,Mt=(X[0]-1)*(X[1]-1)*6,Yt=t.mallocFloat(e.nextPow2(10*Mt)),zt=0,St=0;for(Q=0;Q<X[0]-1;++Q){e:for(de=0;de<X[1]-1;++de){for(var Ye=0;Ye<2;++Ye)for(var rt=0;rt<2;++rt)for(var Ve=0;Ve<3;++Ve){var Ae=this._field[Ve].get(1+Q+Ye,1+de+rt);if(isNaN(Ae)||!isFinite(Ae))continue e}for(Ve=0;Ve<6;++Ve){var Ue=Q+L[Ve][0],Ze=de+L[Ve][1],Qe=this._field[0].get(Ue+1,Ze+1),_t=this._field[1].get(Ue+1,Ze+1);Ae=this._field[2].get(Ue+1,Ze+1),He=me.get(Ue+1,Ze+1,0),Ie=me.get(Ue+1,Ze+1,1),De=me.get(Ue+1,Ze+1,2),V.intensity&&(gt=V.intensity.get(Ue,Ze));var gt=V.intensity?V.intensity.get(Ue,Ze):Ae+this.objectOffset[2];Yt[zt++]=Ue,Yt[zt++]=Ze,Yt[zt++]=Qe,Yt[zt++]=_t,Yt[zt++]=Ae,Yt[zt++]=0,Yt[zt++]=gt,Yt[zt++]=He,Yt[zt++]=Ie,Yt[zt++]=De,ht[0]=Math.min(ht[0],Qe+this.objectOffset[0]),ht[1]=Math.min(ht[1],_t+this.objectOffset[1]),ht[2]=Math.min(ht[2],Ae+this.objectOffset[2]),Kt=Math.min(Kt,gt),Rt[0]=Math.max(Rt[0],Qe+this.objectOffset[0]),Rt[1]=Math.max(Rt[1],_t+this.objectOffset[1]),Rt[2]=Math.max(Rt[2],Ae+this.objectOffset[2]),It=Math.max(It,gt),St+=1}}}for(V.intensityBounds&&(Kt=+V.intensityBounds[0],It=+V.intensityBounds[1]),Q=6;Q<zt;Q+=10)Yt[Q]=(Yt[Q]-Kt)/(It-Kt);this._vertexCount=St,this._coordinateBuffer.update(Yt.subarray(0,zt)),t.freeFloat(Yt),t.free(me.data),this.bounds=[ht,Rt],this.intensity=V.intensity||this._field[2],(this.intensityBounds[0]!==Kt||this.intensityBounds[1]!==It)&&($=!0),this.intensityBounds=[Kt,It]}if("levels"in V){var wt=V.levels;for(Array.isArray(wt[0])?wt=wt.slice():wt=[[],[],wt],Q=0;Q<3;++Q)wt[Q]=wt[Q].slice(),wt[Q].sort(function(st,ct){return st-ct});for(Q=0;Q<3;++Q)for(de=0;de<wt[Q].length;++de)wt[Q][de]-=this.objectOffset[Q];e:for(Q=0;Q<3;++Q){if(wt[Q].length!==this.contourLevels[Q].length){$=!0;break}for(de=0;de<wt[Q].length;++de)if(wt[Q][de]!==this.contourLevels[Q][de]){$=!0;break e}}this.contourLevels=wt}if($){ye=this._field,X=this.shape;for(var Ut=[],Dt=0;Dt<3;++Dt){var Nt=this.contourLevels[Dt],Xt=[],Ht=[],ar=[0,0,0];for(Q=0;Q<Nt.length;++Q){var Vr=p(this._field[Dt],Nt[Q]);Xt.push(Ut.length/5|0),St=0;e:for(de=0;de<Vr.cells.length;++de){var nn=Vr.cells[de];for(Ve=0;Ve<2;++Ve){var jr=Vr.positions[nn[Ve]],at=jr[0],$t=Math.floor(at)|0,Zt=at-$t,ur=jr[1],wr=Math.floor(ur)|0,$e=ur-wr,Je=!1;t:for(var it=0;it<3;++it){ar[it]=0;var lt=(Dt+it+1)%3;for(Ye=0;Ye<2;++Ye){var Tt=Ye?Zt:1-Zt;for(Ue=Math.min(Math.max($t+Ye,0),X[0])|0,rt=0;rt<2;++rt){var Bt=rt?$e:1-$e;if(Ze=Math.min(Math.max(wr+rt,0),X[1])|0,it<2?Ae=this._field[lt].get(Ue,Ze):Ae=(this.intensity.get(Ue,Ze)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(Ae)||isNaN(Ae)){Je=!0;break t}var Ce=Tt*Bt;ar[it]+=Ce*Ae}}}if(!Je)Ut.push(ar[0],ar[1],jr[0],jr[1],ar[2]),St+=1;else{if(Ve>0){for(var Me=0;Me<5;++Me)Ut.pop();St-=1}continue e}}}Ht.push(St)}this._contourOffsets[Dt]=Xt,this._contourCounts[Dt]=Ht}var nt=t.mallocFloat(Ut.length);for(Q=0;Q<Ut.length;++Q)nt[Q]=Ut[Q];this._contourBuffer.update(nt),t.freeFloat(nt)}},I.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var V=0;V<3;++V)t.freeFloat(this._field[V].data)},I.highlight=function(V){var U;if(!V){this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],this.highlightLevel=[-1,-1,-1];return}for(U=0;U<3;++U)this.enableHighlight[U]?this.highlightLevel[U]=V.level[U]:this.highlightLevel[U]=-1;var $;for(this.snapToData?$=V.dataCoordinate:$=V.position,U=0;U<3;++U)$[U]-=this.objectOffset[U];if(!((!this.enableDynamic[0]||$[0]===this.dynamicLevel[0])&&(!this.enableDynamic[1]||$[1]===this.dynamicLevel[1])&&(!this.enableDynamic[2]||$[2]===this.dynamicLevel[2]))){for(var ne=0,X=this.shape,Q=t.mallocFloat(12*X[0]*X[1]),ie=0;ie<3;++ie){if(!this.enableDynamic[ie]){this.dynamicLevel[ie]=NaN,this._dynamicCounts[ie]=0;continue}this.dynamicLevel[ie]=$[ie];var se=(ie+1)%3,ae=(ie+2)%3,oe=this._field[ie],be=this._field[se],ce=this._field[ae],de=p(oe,$[ie]),ye=de.cells,ge=de.positions;for(this._dynamicOffsets[ie]=ne,U=0;U<ye.length;++U)for(var me=ye[U],Ee=0;Ee<2;++Ee){var Pe=ge[me[Ee]],Ne=+Pe[0],we=Ne|0,ke=Math.min(we+1,X[0])|0,Xe=Ne-we,He=1-Xe,Ie=+Pe[1],De=Ie|0,Ge=Math.min(De+1,X[1])|0,ht=Ie-De,Rt=1-ht,Kt=He*Rt,It=He*ht,Mt=Xe*Rt,Yt=Xe*ht,zt=Kt*be.get(we,De)+It*be.get(we,Ge)+Mt*be.get(ke,De)+Yt*be.get(ke,Ge),St=Kt*ce.get(we,De)+It*ce.get(we,Ge)+Mt*ce.get(ke,De)+Yt*ce.get(ke,Ge);if(isNaN(zt)||isNaN(St)){Ee&&(ne-=1);break}Q[2*ne+0]=zt,Q[2*ne+1]=St,ne+=1}this._dynamicCounts[ie]=ne-this._dynamicOffsets[ie]}this._dynamicBuffer.update(Q.subarray(0,2*ne)),t.freeFloat(Q)}};function q(V){var U=V.gl,$=l(U),ne=_(U),X=w(U),Q=h(U),ie=a(U),se=n(U,[{buffer:ie,size:4,stride:b,offset:0},{buffer:ie,size:3,stride:b,offset:16},{buffer:ie,size:3,stride:b,offset:28}]),ae=a(U),oe=n(U,[{buffer:ae,size:4,stride:20,offset:0},{buffer:ae,size:1,stride:20,offset:16}]),be=a(U),ce=n(U,[{buffer:be,size:2,type:U.FLOAT}]),de=r(U,1,P,U.RGBA,U.UNSIGNED_BYTE);de.minFilter=U.LINEAR,de.magFilter=U.LINEAR;var ye=new z(U,[0,0],[[0,0,0],[0,0,0]],$,ne,ie,se,de,X,Q,ae,oe,be,ce,[0,0,0]),ge={levels:[[],[],[]]};for(var me in V)ge[me]=V[me];return ge.colormap=ge.colormap||"jet",ye.update(ge),ye}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(g,S,M){var e=g("ndarray"),a=g("ndarray-ops"),n=g("typedarray-pool");S.exports=h;var r=null,t=null,c=null;function s(b){r=[b.LINEAR,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_NEAREST],t=[b.NEAREST,b.LINEAR,b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR],c=[b.REPEAT,b.CLAMP_TO_EDGE,b.MIRRORED_REPEAT]}function i(b){return typeof HTMLCanvasElement<"u"&&b instanceof HTMLCanvasElement||typeof HTMLImageElement<"u"&&b instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&b instanceof HTMLVideoElement||typeof ImageData<"u"&&b instanceof ImageData}var x=function(b,u){a.muls(b,u,255)};function p(b,u,L){var T=b.gl,k=T.getParameter(T.MAX_TEXTURE_SIZE);if(u<0||u>k||L<0||L>k)throw new Error("gl-texture2d: Invalid texture size");return b._shape=[u,L],b.bind(),T.texImage2D(T.TEXTURE_2D,0,b.format,u,L,0,b.format,b.type,null),b._mipLevels=[0],b}function v(b,u,L,T,k,P){this.gl=b,this.handle=u,this.format=k,this.type=P,this._shape=[L,T],this._mipLevels=[0],this._magFilter=b.NEAREST,this._minFilter=b.NEAREST,this._wrapS=b.CLAMP_TO_EDGE,this._wrapT=b.CLAMP_TO_EDGE,this._anisoSamples=1;var z=this,I=[this._wrapS,this._wrapT];Object.defineProperties(I,[{get:function(){return z._wrapS},set:function(R){return z.wrapS=R}},{get:function(){return z._wrapT},set:function(R){return z.wrapT=R}}]),this._wrapVector=I;var D=[this._shape[0],this._shape[1]];Object.defineProperties(D,[{get:function(){return z._shape[0]},set:function(R){return z.width=R}},{get:function(){return z._shape[1]},set:function(R){return z.height=R}}]),this._shapeVector=D}var f=v.prototype;Object.defineProperties(f,{minFilter:{get:function(){return this._minFilter},set:function(b){this.bind();var u=this.gl;if(this.type===u.FLOAT&&r.indexOf(b)>=0&&(u.getExtension("OES_texture_float_linear")||(b=u.NEAREST)),t.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,b),this._minFilter=b}},magFilter:{get:function(){return this._magFilter},set:function(b){this.bind();var u=this.gl;if(this.type===u.FLOAT&&r.indexOf(b)>=0&&(u.getExtension("OES_texture_float_linear")||(b=u.NEAREST)),t.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,b),this._magFilter=b}},mipSamples:{get:function(){return this._anisoSamples},set:function(b){var u=this._anisoSamples;if(this._anisoSamples=Math.max(b,1)|0,u!==this._anisoSamples){var L=this.gl.getExtension("EXT_texture_filter_anisotropic");L&&this.gl.texParameterf(this.gl.TEXTURE_2D,L.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(b){if(this.bind(),c.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,b),this._wrapS=b}},wrapT:{get:function(){return this._wrapT},set:function(b){if(this.bind(),c.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,b),this._wrapT=b}},wrap:{get:function(){return this._wrapVector},set:function(b){if(Array.isArray(b)||(b=[b,b]),b.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var u=0;u<2;++u)if(c.indexOf(b[u])<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);this._wrapS=b[0],this._wrapT=b[1];var L=this.gl;return this.bind(),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_S,this._wrapS),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_T,this._wrapT),b}},shape:{get:function(){return this._shapeVector},set:function(b){if(!Array.isArray(b))b=[b|0,b|0];else if(b.length!==2)throw new Error("gl-texture2d: Invalid texture shape");return p(this,b[0]|0,b[1]|0),[b[0]|0,b[1]|0]}},width:{get:function(){return this._shape[0]},set:function(b){return b=b|0,p(this,b,this._shape[1]),b}},height:{get:function(){return this._shape[1]},set:function(b){return b=b|0,p(this,this._shape[0],b),b}}}),f.bind=function(b){var u=this.gl;return b!==void 0&&u.activeTexture(u.TEXTURE0+(b|0)),u.bindTexture(u.TEXTURE_2D,this.handle),b!==void 0?b|0:u.getParameter(u.ACTIVE_TEXTURE)-u.TEXTURE0},f.dispose=function(){this.gl.deleteTexture(this.handle)},f.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var b=Math.min(this._shape[0],this._shape[1]),u=0;b>0;++u,b>>>=1)this._mipLevels.indexOf(u)<0&&this._mipLevels.push(u)},f.setPixels=function(b,u,L,T){var k=this.gl;this.bind(),Array.isArray(u)?(T=L,L=u[1]|0,u=u[0]|0):(u=u||0,L=L||0),T=T||0;var P=i(b)?b:b.raw;if(P){var z=this._mipLevels.indexOf(T)<0;z?(k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,this.type,P),this._mipLevels.push(T)):k.texSubImage2D(k.TEXTURE_2D,T,u,L,this.format,this.type,P)}else if(b.shape&&b.stride&&b.data){if(b.shape.length<2||u+b.shape[1]>this._shape[1]>>>T||L+b.shape[0]>this._shape[0]>>>T||u<0||L<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");o(k,u,L,T,this.format,this.type,this._mipLevels,b)}else throw new Error("gl-texture2d: Unsupported data type")};function y(b,u){return b.length===3?u[2]===1&&u[1]===b[0]*b[2]&&u[0]===b[2]:u[0]===1&&u[1]===b[0]}function o(b,u,L,T,k,P,z,I){var D=I.dtype,R=I.shape.slice();if(R.length<2||R.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var O=0,F=0,N=y(R,I.stride.slice());if(D==="float32"?O=b.FLOAT:D==="float64"?(O=b.FLOAT,N=!1,D="float32"):D==="uint8"?O=b.UNSIGNED_BYTE:(O=b.UNSIGNED_BYTE,N=!1,D="uint8"),R.length===2)F=b.LUMINANCE,R=[R[0],R[1],1],I=e(I.data,R,[I.stride[0],I.stride[1],1],I.offset);else if(R.length===3){if(R[2]===1)F=b.ALPHA;else if(R[2]===2)F=b.LUMINANCE_ALPHA;else if(R[2]===3)F=b.RGB;else if(R[2]===4)F=b.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");R[2]}else throw new Error("gl-texture2d: Invalid shape for texture");if((F===b.LUMINANCE||F===b.ALPHA)&&(k===b.LUMINANCE||k===b.ALPHA)&&(F=k),F!==k)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var G=I.size,K=z.indexOf(T)<0;if(K&&z.push(T),O===P&&N)I.offset===0&&I.data.length===G?K?b.texImage2D(b.TEXTURE_2D,T,k,R[0],R[1],0,k,P,I.data):b.texSubImage2D(b.TEXTURE_2D,T,u,L,R[0],R[1],k,P,I.data):K?b.texImage2D(b.TEXTURE_2D,T,k,R[0],R[1],0,k,P,I.data.subarray(I.offset,I.offset+G)):b.texSubImage2D(b.TEXTURE_2D,T,u,L,R[0],R[1],k,P,I.data.subarray(I.offset,I.offset+G));else{var W;P===b.FLOAT?W=n.mallocFloat32(G):W=n.mallocUint8(G);var Y=e(W,R,[R[2],R[2]*R[0],1]);O===b.FLOAT&&P===b.UNSIGNED_BYTE?x(Y,I):a.assign(Y,I),K?b.texImage2D(b.TEXTURE_2D,T,k,R[0],R[1],0,k,P,W.subarray(0,G)):b.texSubImage2D(b.TEXTURE_2D,T,u,L,R[0],R[1],k,P,W.subarray(0,G)),P===b.FLOAT?n.freeFloat32(W):n.freeUint8(W)}}function m(b){var u=b.createTexture();return b.bindTexture(b.TEXTURE_2D,u),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),u}function l(b,u,L,T,k){var P=b.getParameter(b.MAX_TEXTURE_SIZE);if(u<0||u>P||L<0||L>P)throw new Error("gl-texture2d: Invalid texture shape");if(k===b.FLOAT&&!b.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var z=m(b);return b.texImage2D(b.TEXTURE_2D,0,T,u,L,0,T,k,null),new v(b,z,u,L,T,k)}function w(b,u,L,T,k,P){var z=m(b);return b.texImage2D(b.TEXTURE_2D,0,k,k,P,u),new v(b,z,L,T,k,P)}function _(b,u){var L=u.dtype,T=u.shape.slice(),k=b.getParameter(b.MAX_TEXTURE_SIZE);if(T[0]<0||T[0]>k||T[1]<0||T[1]>k)throw new Error("gl-texture2d: Invalid texture size");var P=y(T,u.stride.slice()),z=0;L==="float32"?z=b.FLOAT:L==="float64"?(z=b.FLOAT,P=!1,L="float32"):L==="uint8"?z=b.UNSIGNED_BYTE:(z=b.UNSIGNED_BYTE,P=!1,L="uint8");var I=0;if(T.length===2)I=b.LUMINANCE,T=[T[0],T[1],1],u=e(u.data,T,[u.stride[0],u.stride[1],1],u.offset);else if(T.length===3)if(T[2]===1)I=b.ALPHA;else if(T[2]===2)I=b.LUMINANCE_ALPHA;else if(T[2]===3)I=b.RGB;else if(T[2]===4)I=b.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");else throw new Error("gl-texture2d: Invalid shape for texture");z===b.FLOAT&&!b.getExtension("OES_texture_float")&&(z=b.UNSIGNED_BYTE,P=!1);var D,R,O=u.size;if(P)u.offset===0&&u.data.length===O?D=u.data:D=u.data.subarray(u.offset,u.offset+O);else{var F=[T[2],T[2]*T[0],1];R=n.malloc(O,L);var N=e(R,T,F,0);(L==="float32"||L==="float64")&&z===b.UNSIGNED_BYTE?x(N,u):a.assign(N,u),D=R.subarray(0,O)}var G=m(b);return b.texImage2D(b.TEXTURE_2D,0,I,T[0],T[1],0,I,z,D),P||n.free(R),new v(b,G,T[0],T[1],I,z)}function h(b){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(r||s(b),typeof arguments[1]=="number")return l(b,arguments[1],arguments[2],arguments[3]||b.RGBA,arguments[4]||b.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return l(b,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var u=arguments[1],L=i(u)?u:u.raw;if(L)return w(b,L,u.width|0,u.height|0,arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if(u.shape&&u.data&&u.stride)return _(b,u)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(g,S,M){function e(a,n,r){n?n.bind():a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);var t=a.getParameter(a.MAX_VERTEX_ATTRIBS)|0;if(r){if(r.length>t)throw new Error("gl-vao: Too many vertex attributes");for(var c=0;c<r.length;++c){var s=r[c];if(s.buffer){var i=s.buffer,x=s.size||4,p=s.type||a.FLOAT,v=!!s.normalized,f=s.stride||0,y=s.offset||0;i.bind(),a.enableVertexAttribArray(c),a.vertexAttribPointer(c,x,p,v,f,y)}else{if(typeof s=="number")a.vertexAttrib1f(c,s);else if(s.length===1)a.vertexAttrib1f(c,s[0]);else if(s.length===2)a.vertexAttrib2f(c,s[0],s[1]);else if(s.length===3)a.vertexAttrib3f(c,s[0],s[1],s[2]);else if(s.length===4)a.vertexAttrib4f(c,s[0],s[1],s[2],s[3]);else throw new Error("gl-vao: Invalid vertex attribute");a.disableVertexAttribArray(c)}}for(;c<t;++c)a.disableVertexAttribArray(c)}else{a.bindBuffer(a.ARRAY_BUFFER,null);for(var c=0;c<t;++c)a.disableVertexAttribArray(c)}}S.exports=e},{}],148:[function(g,S,M){var e=g("./do-bind.js");function a(r){this.gl=r,this._elements=null,this._attributes=null,this._elementsType=r.UNSIGNED_SHORT}a.prototype.bind=function(){e(this.gl,this._elements,this._attributes)},a.prototype.update=function(r,t,c){this._elements=t,this._attributes=r,this._elementsType=c||this.gl.UNSIGNED_SHORT},a.prototype.dispose=function(){},a.prototype.unbind=function(){},a.prototype.draw=function(r,t,c){c=c||0;var s=this.gl;this._elements?s.drawElements(r,t,this._elementsType,c):s.drawArrays(r,c,t)};function n(r){return new a(r)}S.exports=n},{"./do-bind.js":147}],149:[function(g,S,M){var e=g("./do-bind.js");function a(t,c,s,i,x,p){this.location=t,this.dimension=c,this.a=s,this.b=i,this.c=x,this.d=p}a.prototype.bind=function(t){switch(this.dimension){case 1:t.vertexAttrib1f(this.location,this.a);break;case 2:t.vertexAttrib2f(this.location,this.a,this.b);break;case 3:t.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:t.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function n(t,c,s){this.gl=t,this._ext=c,this.handle=s,this._attribs=[],this._useElements=!1,this._elementsType=t.UNSIGNED_SHORT}n.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var t=0;t<this._attribs.length;++t)this._attribs[t].bind(this.gl)},n.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},n.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},n.prototype.update=function(t,c,s){if(this.bind(),e(this.gl,c,t),this.unbind(),this._attribs.length=0,t)for(var i=0;i<t.length;++i){var x=t[i];typeof x=="number"?this._attribs.push(new a(i,1,x)):Array.isArray(x)&&this._attribs.push(new a(i,x.length,x[0],x[1],x[2],x[3]))}this._useElements=!!c,this._elementsType=s||this.gl.UNSIGNED_SHORT},n.prototype.draw=function(t,c,s){s=s||0;var i=this.gl;this._useElements?i.drawElements(t,c,this._elementsType,s):i.drawArrays(t,s,c)};function r(t,c){return new n(t,c,c.createVertexArrayOES())}S.exports=r},{"./do-bind.js":147}],150:[function(g,S,M){var e=g("./lib/vao-native.js"),a=g("./lib/vao-emulated.js");function n(t){this.bindVertexArrayOES=t.bindVertexArray.bind(t),this.createVertexArrayOES=t.createVertexArray.bind(t),this.deleteVertexArrayOES=t.deleteVertexArray.bind(t)}function r(t,c,s,i){var x=t.createVertexArray?new n(t):t.getExtension("OES_vertex_array_object"),p;return x?p=e(t,x):p=a(t),p.update(c,s,i),p}S.exports=r},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a[2]=n[2]+r[2],a}},{}],152:[function(g,S,M){S.exports=r;var e=g("./fromValues"),a=g("./normalize"),n=g("./dot");function r(t,c){var s=e(t[0],t[1],t[2]),i=e(c[0],c[1],c[2]);a(s,s),a(i,i);var x=n(s,i);return x>1?0:Math.acos(x)}},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=Math.ceil(n[0]),a[1]=Math.ceil(n[1]),a[2]=Math.ceil(n[2]),a}},{}],154:[function(g,S,M){S.exports=e;function e(a){var n=new Float32Array(3);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n}},{}],155:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a}},{}],156:[function(g,S,M){S.exports=e;function e(){var a=new Float32Array(3);return a[0]=0,a[1]=0,a[2]=0,a}},{}],157:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],s=n[2],i=r[0],x=r[1],p=r[2];return a[0]=c*p-s*x,a[1]=s*i-t*p,a[2]=t*x-c*i,a}},{}],158:[function(g,S,M){S.exports=g("./distance")},{"./distance":159}],159:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],c=n[2]-a[2];return Math.sqrt(r*r+t*t+c*c)}},{}],160:[function(g,S,M){S.exports=g("./divide")},{"./divide":161}],161:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]/r[0],a[1]=n[1]/r[1],a[2]=n[2]/r[2],a}},{}],162:[function(g,S,M){S.exports=e;function e(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]}},{}],163:[function(g,S,M){S.exports=1e-6},{}],164:[function(g,S,M){S.exports=a;var e=g("./epsilon");function a(n,r){var t=n[0],c=n[1],s=n[2],i=r[0],x=r[1],p=r[2];return Math.abs(t-i)<=e*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(c-x)<=e*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(s-p)<=e*Math.max(1,Math.abs(s),Math.abs(p))}},{"./epsilon":163}],165:[function(g,S,M){S.exports=e;function e(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]}},{}],166:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=Math.floor(n[0]),a[1]=Math.floor(n[1]),a[2]=Math.floor(n[2]),a}},{}],167:[function(g,S,M){S.exports=a;var e=g("./create")();function a(n,r,t,c,s,i){var x,p;for(r||(r=3),t||(t=0),c?p=Math.min(c*r+t,n.length):p=n.length,x=t;x<p;x+=r)e[0]=n[x],e[1]=n[x+1],e[2]=n[x+2],s(e,e,i),n[x]=e[0],n[x+1]=e[1],n[x+2]=e[2];return n}},{"./create":156}],168:[function(g,S,M){S.exports=e;function e(a,n,r){var t=new Float32Array(3);return t[0]=a,t[1]=n,t[2]=r,t}},{}],169:[function(g,S,M){S.exports={EPSILON:g("./epsilon"),create:g("./create"),clone:g("./clone"),angle:g("./angle"),fromValues:g("./fromValues"),copy:g("./copy"),set:g("./set"),equals:g("./equals"),exactEquals:g("./exactEquals"),add:g("./add"),subtract:g("./subtract"),sub:g("./sub"),multiply:g("./multiply"),mul:g("./mul"),divide:g("./divide"),div:g("./div"),min:g("./min"),max:g("./max"),floor:g("./floor"),ceil:g("./ceil"),round:g("./round"),scale:g("./scale"),scaleAndAdd:g("./scaleAndAdd"),distance:g("./distance"),dist:g("./dist"),squaredDistance:g("./squaredDistance"),sqrDist:g("./sqrDist"),length:g("./length"),len:g("./len"),squaredLength:g("./squaredLength"),sqrLen:g("./sqrLen"),negate:g("./negate"),inverse:g("./inverse"),normalize:g("./normalize"),dot:g("./dot"),cross:g("./cross"),lerp:g("./lerp"),random:g("./random"),transformMat4:g("./transformMat4"),transformMat3:g("./transformMat3"),transformQuat:g("./transformQuat"),rotateX:g("./rotateX"),rotateY:g("./rotateY"),rotateZ:g("./rotateZ"),forEach:g("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=1/n[0],a[1]=1/n[1],a[2]=1/n[2],a}},{}],171:[function(g,S,M){S.exports=g("./length")},{"./length":172}],172:[function(g,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2];return Math.sqrt(n*n+r*r+t*t)}},{}],173:[function(g,S,M){S.exports=e;function e(a,n,r,t){var c=n[0],s=n[1],i=n[2];return a[0]=c+t*(r[0]-c),a[1]=s+t*(r[1]-s),a[2]=i+t*(r[2]-i),a}},{}],174:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=Math.max(n[0],r[0]),a[1]=Math.max(n[1],r[1]),a[2]=Math.max(n[2],r[2]),a}},{}],175:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=Math.min(n[0],r[0]),a[1]=Math.min(n[1],r[1]),a[2]=Math.min(n[2],r[2]),a}},{}],176:[function(g,S,M){S.exports=g("./multiply")},{"./multiply":177}],177:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]*r[0],a[1]=n[1]*r[1],a[2]=n[2]*r[2],a}},{}],178:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=-n[0],a[1]=-n[1],a[2]=-n[2],a}},{}],179:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0],t=n[1],c=n[2],s=r*r+t*t+c*c;return s>0&&(s=1/Math.sqrt(s),a[0]=n[0]*s,a[1]=n[1]*s,a[2]=n[2]*s),a}},{}],180:[function(g,S,M){S.exports=e;function e(a,n){n=n||1;var r=Math.random()*2*Math.PI,t=Math.random()*2-1,c=Math.sqrt(1-t*t)*n;return a[0]=Math.cos(r)*c,a[1]=Math.sin(r)*c,a[2]=t*n,a}},{}],181:[function(g,S,M){S.exports=e;function e(a,n,r,t){var c=r[1],s=r[2],i=n[1]-c,x=n[2]-s,p=Math.sin(t),v=Math.cos(t);return a[0]=n[0],a[1]=c+i*v-x*p,a[2]=s+i*p+x*v,a}},{}],182:[function(g,S,M){S.exports=e;function e(a,n,r,t){var c=r[0],s=r[2],i=n[0]-c,x=n[2]-s,p=Math.sin(t),v=Math.cos(t);return a[0]=c+x*p+i*v,a[1]=n[1],a[2]=s+x*v-i*p,a}},{}],183:[function(g,S,M){S.exports=e;function e(a,n,r,t){var c=r[0],s=r[1],i=n[0]-c,x=n[1]-s,p=Math.sin(t),v=Math.cos(t);return a[0]=c+i*v-x*p,a[1]=s+i*p+x*v,a[2]=n[2],a}},{}],184:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=Math.round(n[0]),a[1]=Math.round(n[1]),a[2]=Math.round(n[2]),a}},{}],185:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]*r,a[1]=n[1]*r,a[2]=n[2]*r,a}},{}],186:[function(g,S,M){S.exports=e;function e(a,n,r,t){return a[0]=n[0]+r[0]*t,a[1]=n[1]+r[1]*t,a[2]=n[2]+r[2]*t,a}},{}],187:[function(g,S,M){S.exports=e;function e(a,n,r,t){return a[0]=n,a[1]=r,a[2]=t,a}},{}],188:[function(g,S,M){S.exports=g("./squaredDistance")},{"./squaredDistance":190}],189:[function(g,S,M){S.exports=g("./squaredLength")},{"./squaredLength":191}],190:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],c=n[2]-a[2];return r*r+t*t+c*c}},{}],191:[function(g,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2];return n*n+r*r+t*t}},{}],192:[function(g,S,M){S.exports=g("./subtract")},{"./subtract":193}],193:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],a}},{}],194:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],s=n[2];return a[0]=t*r[0]+c*r[3]+s*r[6],a[1]=t*r[1]+c*r[4]+s*r[7],a[2]=t*r[2]+c*r[5]+s*r[8],a}},{}],195:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],s=n[2],i=r[3]*t+r[7]*c+r[11]*s+r[15];return i=i||1,a[0]=(r[0]*t+r[4]*c+r[8]*s+r[12])/i,a[1]=(r[1]*t+r[5]*c+r[9]*s+r[13])/i,a[2]=(r[2]*t+r[6]*c+r[10]*s+r[14])/i,a}},{}],196:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],s=n[2],i=r[0],x=r[1],p=r[2],v=r[3],f=v*t+x*s-p*c,y=v*c+p*t-i*s,o=v*s+i*c-x*t,m=-i*t-x*c-p*s;return a[0]=f*v+m*-i+y*-p-o*-x,a[1]=y*v+m*-x+o*-i-f*-p,a[2]=o*v+m*-p+f*-x-y*-i,a}},{}],197:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a[2]=n[2]+r[2],a[3]=n[3]+r[3],a}},{}],198:[function(g,S,M){S.exports=e;function e(a){var n=new Float32Array(4);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n}},{}],199:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a}},{}],200:[function(g,S,M){S.exports=e;function e(){var a=new Float32Array(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a}},{}],201:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],c=n[2]-a[2],s=n[3]-a[3];return Math.sqrt(r*r+t*t+c*c+s*s)}},{}],202:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]/r[0],a[1]=n[1]/r[1],a[2]=n[2]/r[2],a[3]=n[3]/r[3],a}},{}],203:[function(g,S,M){S.exports=e;function e(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]+a[3]*n[3]}},{}],204:[function(g,S,M){S.exports=e;function e(a,n,r,t){var c=new Float32Array(4);return c[0]=a,c[1]=n,c[2]=r,c[3]=t,c}},{}],205:[function(g,S,M){S.exports={create:g("./create"),clone:g("./clone"),fromValues:g("./fromValues"),copy:g("./copy"),set:g("./set"),add:g("./add"),subtract:g("./subtract"),multiply:g("./multiply"),divide:g("./divide"),min:g("./min"),max:g("./max"),scale:g("./scale"),scaleAndAdd:g("./scaleAndAdd"),distance:g("./distance"),squaredDistance:g("./squaredDistance"),length:g("./length"),squaredLength:g("./squaredLength"),negate:g("./negate"),inverse:g("./inverse"),normalize:g("./normalize"),dot:g("./dot"),lerp:g("./lerp"),random:g("./random"),transformMat4:g("./transformMat4"),transformQuat:g("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=1/n[0],a[1]=1/n[1],a[2]=1/n[2],a[3]=1/n[3],a}},{}],207:[function(g,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2],c=a[3];return Math.sqrt(n*n+r*r+t*t+c*c)}},{}],208:[function(g,S,M){S.exports=e;function e(a,n,r,t){var c=n[0],s=n[1],i=n[2],x=n[3];return a[0]=c+t*(r[0]-c),a[1]=s+t*(r[1]-s),a[2]=i+t*(r[2]-i),a[3]=x+t*(r[3]-x),a}},{}],209:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=Math.max(n[0],r[0]),a[1]=Math.max(n[1],r[1]),a[2]=Math.max(n[2],r[2]),a[3]=Math.max(n[3],r[3]),a}},{}],210:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=Math.min(n[0],r[0]),a[1]=Math.min(n[1],r[1]),a[2]=Math.min(n[2],r[2]),a[3]=Math.min(n[3],r[3]),a}},{}],211:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]*r[0],a[1]=n[1]*r[1],a[2]=n[2]*r[2],a[3]=n[3]*r[3],a}},{}],212:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=-n[0],a[1]=-n[1],a[2]=-n[2],a[3]=-n[3],a}},{}],213:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0],t=n[1],c=n[2],s=n[3],i=r*r+t*t+c*c+s*s;return i>0&&(i=1/Math.sqrt(i),a[0]=r*i,a[1]=t*i,a[2]=c*i,a[3]=s*i),a}},{}],214:[function(g,S,M){var e=g("./normalize"),a=g("./scale");S.exports=n;function n(r,t){return t=t||1,r[0]=Math.random(),r[1]=Math.random(),r[2]=Math.random(),r[3]=Math.random(),e(r,r),a(r,r,t),r}},{"./normalize":213,"./scale":215}],215:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]*r,a[1]=n[1]*r,a[2]=n[2]*r,a[3]=n[3]*r,a}},{}],216:[function(g,S,M){S.exports=e;function e(a,n,r,t){return a[0]=n[0]+r[0]*t,a[1]=n[1]+r[1]*t,a[2]=n[2]+r[2]*t,a[3]=n[3]+r[3]*t,a}},{}],217:[function(g,S,M){S.exports=e;function e(a,n,r,t,c){return a[0]=n,a[1]=r,a[2]=t,a[3]=c,a}},{}],218:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],c=n[2]-a[2],s=n[3]-a[3];return r*r+t*t+c*c+s*s}},{}],219:[function(g,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2],c=a[3];return n*n+r*r+t*t+c*c}},{}],220:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],a[3]=n[3]-r[3],a}},{}],221:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],s=n[2],i=n[3];return a[0]=r[0]*t+r[4]*c+r[8]*s+r[12]*i,a[1]=r[1]*t+r[5]*c+r[9]*s+r[13]*i,a[2]=r[2]*t+r[6]*c+r[10]*s+r[14]*i,a[3]=r[3]*t+r[7]*c+r[11]*s+r[15]*i,a}},{}],222:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],s=n[2],i=r[0],x=r[1],p=r[2],v=r[3],f=v*t+x*s-p*c,y=v*c+p*t-i*s,o=v*s+i*c-x*t,m=-i*t-x*c-p*s;return a[0]=f*v+m*-i+y*-p-o*-x,a[1]=y*v+m*-x+o*-i-f*-p,a[2]=o*v+m*-p+f*-x-y*-i,a[3]=n[3],a}},{}],223:[function(g,S,M){var e=g("glsl-tokenizer"),a=g("atob-lite");S.exports=n;function n(r){for(var t=Array.isArray(r)?r:e(r),c=0;c<t.length;c++){var s=t[c];if(s.type==="preprocessor"){var i=s.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(!!i&&!!i[2]){var x=i[1],p=i[2];return(x?a(p):p).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(g,S,M){S.exports=u;var e=g("./lib/literals"),a=g("./lib/operators"),n=g("./lib/builtins"),r=g("./lib/literals-300es"),t=g("./lib/builtins-300es"),c=999,s=9999,i=0,x=1,p=2,v=3,f=4,y=5,o=6,m=7,l=8,w=9,_=10,h=11,b=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function u(L){var T=0,k=0,P=c,z,I,D=[],R=[],O=1,F=0,N=0,G=!1,K=!1,W="",Y;L=L||{};var re=n,ue=e;L.version==="300 es"&&(re=t,ue=r);for(var j={},q={},T=0;T<re.length;T++)j[re[T]]=!0;for(var T=0;T<ue.length;T++)q[ue[T]]=!0;return function(ge){return R=[],ge!==null?U(ge):$()};function V(ge){ge.length&&R.push({type:b[P],data:ge,position:N,line:O,column:F})}function U(ge){T=0,ge.toString&&(ge=ge.toString()),W+=ge.replace(/\r\n/g,`
`),Y=W.length;for(var me;z=W[T],T<Y;){switch(me=T,P){case i:T=se();break;case x:T=ie();break;case p:T=Q();break;case v:T=ae();break;case f:T=ce();break;case h:T=be();break;case y:T=de();break;case s:T=ye();break;case w:T=X();break;case c:T=ne();break}if(me!==T)switch(W[me]){case`
`:F=0,++O;break;default:++F;break}}return k+=T,W=W.slice(T),R}function $(ge){return D.length&&V(D.join("")),P=_,V("(eof)"),R}function ne(){return D=D.length?[]:D,I==="/"&&z==="*"?(N=k+T-1,P=i,I=z,T+1):I==="/"&&z==="/"?(N=k+T-1,P=x,I=z,T+1):z==="#"?(P=p,N=k+T,T):/\s/.test(z)?(P=w,N=k+T,T):(G=/\d/.test(z),K=/[^\w_]/.test(z),N=k+T,P=G?f:K?v:s,T)}function X(){return/[^\s]/g.test(z)?(V(D.join("")),P=c,T):(D.push(z),I=z,T+1)}function Q(){return(z==="\r"||z===`
`)&&I!=="\\"?(V(D.join("")),P=c,T):(D.push(z),I=z,T+1)}function ie(){return Q()}function se(){return z==="/"&&I==="*"?(D.push(z),V(D.join("")),P=c,T+1):(D.push(z),I=z,T+1)}function ae(){if(I==="."&&/\d/.test(z))return P=y,T;if(I==="/"&&z==="*")return P=i,T;if(I==="/"&&z==="/")return P=x,T;if(z==="."&&D.length){for(;oe(D););return P=y,T}if(z===";"||z===")"||z==="("){if(D.length)for(;oe(D););return V(z),P=c,T+1}var ge=D.length===2&&z!=="=";if(/[\w_\d\s]/.test(z)||ge){for(;oe(D););return P=c,T}return D.push(z),I=z,T+1}function oe(ge){var me=0,Ee,Pe;do{if(Ee=a.indexOf(ge.slice(0,ge.length+me).join("")),Pe=a[Ee],Ee===-1){if(me--+ge.length>0)continue;Pe=ge.slice(0,1).join("")}return V(Pe),N+=Pe.length,D=D.slice(Pe.length),D.length}while(1)}function be(){return/[^a-fA-F0-9]/.test(z)?(V(D.join("")),P=c,T):(D.push(z),I=z,T+1)}function ce(){return z==="."||/[eE]/.test(z)?(D.push(z),P=y,I=z,T+1):z==="x"&&D.length===1&&D[0]==="0"?(P=h,D.push(z),I=z,T+1):/[^\d]/.test(z)?(V(D.join("")),P=c,T):(D.push(z),I=z,T+1)}function de(){return z==="f"&&(D.push(z),I=z,T+=1),/[eE]/.test(z)||(z==="-"||z==="+")&&/[eE]/.test(I)?(D.push(z),I=z,T+1):/[^\d]/.test(z)?(V(D.join("")),P=c,T):(D.push(z),I=z,T+1)}function ye(){if(/[^\d\w_]/.test(z)){var ge=D.join("");return q[ge]?P=l:j[ge]?P=m:P=o,V(D.join("")),P=c,T}return D.push(z),I=z,T+1}}},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(g,S,M){var e=g("./builtins");e=e.slice().filter(function(a){return!/^(gl\_|texture)/.test(a)}),S.exports=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(g,S,M){S.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(g,S,M){var e=g("./literals");S.exports=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(g,S,M){S.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(g,S,M){S.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(g,S,M){var e=g("./index");S.exports=a;function a(n,r){var t=e(r),c=[];return c=c.concat(t(n)),c=c.concat(t(null)),c}},{"./index":224}],231:[function(g,S,M){S.exports=function(e){typeof e=="string"&&(e=[e]);for(var a=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],a[r]||"");return n.push(e[r]),n.join("")}},{}],232:[function(g,S,M){var e=g("is-browser");function a(){var n=!1;try{var r=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("test",null,r),window.removeEventListener("test",null,r)}catch{n=!1}return n}S.exports=e&&a()},{"is-browser":236}],233:[function(g,S,M){S.exports=v;var e=g("robust-orientation"),a=g("simplicial-complex").compareCells;function n(f,y,o){this.vertices=f,this.adjacent=y,this.boundary=o,this.lastVisited=-1}n.prototype.flip=function(){var f=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=f;var y=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=y};function r(f,y,o){this.vertices=f,this.cell=y,this.index=o}function t(f,y){return a(f.vertices,y.vertices)}function c(f){return function(){var y=this.tuple;return f.apply(this,y)}}function s(f){var y=e[f+1];return y||(y=e),c(y)}var i=[];function x(f,y,o){this.dimension=f,this.vertices=y,this.simplices=o,this.interior=o.filter(function(w){return!w.boundary}),this.tuple=new Array(f+1);for(var m=0;m<=f;++m)this.tuple[m]=this.vertices[m];var l=i[f];l||(l=i[f]=s(f)),this.orient=l}var p=x.prototype;p.handleBoundaryDegeneracy=function(f,y){var o=this.dimension,m=this.vertices.length-1,l=this.tuple,w=this.vertices,_=[f];for(f.lastVisited=-m;_.length>0;){f=_.pop();for(var h=f.adjacent,b=0;b<=o;++b){var u=h[b];if(!(!u.boundary||u.lastVisited<=-m)){for(var L=u.vertices,T=0;T<=o;++T){var k=L[T];k<0?l[T]=y:l[T]=w[k]}var P=this.orient();if(P>0)return u;u.lastVisited=-m,P===0&&_.push(u)}}}return null},p.walk=function(f,y){var o=this.vertices.length-1,m=this.dimension,l=this.vertices,w=this.tuple,_=y?this.interior.length*Math.random()|0:this.interior.length-1,h=this.interior[_];e:for(;!h.boundary;){for(var b=h.vertices,u=h.adjacent,L=0;L<=m;++L)w[L]=l[b[L]];h.lastVisited=o;for(var L=0;L<=m;++L){var T=u[L];if(!(T.lastVisited>=o)){var k=w[L];w[L]=f;var P=this.orient();if(w[L]=k,P<0){h=T;continue e}else T.boundary?T.lastVisited=-o:T.lastVisited=o}}return}return h},p.addPeaks=function(f,y){var o=this.vertices.length-1,m=this.dimension,l=this.vertices,w=this.tuple,_=this.interior,h=this.simplices,b=[y];y.lastVisited=o,y.vertices[y.vertices.indexOf(-1)]=o,y.boundary=!1,_.push(y);for(var u=[];b.length>0;){var y=b.pop(),L=y.vertices,T=y.adjacent,k=L.indexOf(o);if(!(k<0)){for(var P=0;P<=m;++P)if(P!==k){var z=T[P];if(!(!z.boundary||z.lastVisited>=o)){var I=z.vertices;if(z.lastVisited!==-o){for(var D=0,R=0;R<=m;++R)I[R]<0?(D=R,w[R]=f):w[R]=l[I[R]];var O=this.orient();if(O>0){I[D]=o,z.boundary=!1,_.push(z),b.push(z),z.lastVisited=o;continue}else z.lastVisited=-o}var F=z.adjacent,N=L.slice(),G=T.slice(),K=new n(N,G,!0);h.push(K);var W=F.indexOf(y);if(!(W<0)){F[W]=K,G[k]=z,N[P]=-1,G[P]=y,T[P]=K,K.flip();for(var R=0;R<=m;++R){var Y=N[R];if(!(Y<0||Y===o)){for(var re=new Array(m-1),ue=0,j=0;j<=m;++j){var q=N[j];q<0||j===R||(re[ue++]=q)}u.push(new r(re,K,R))}}}}}}}u.sort(t);for(var P=0;P+1<u.length;P+=2){var V=u[P],U=u[P+1],$=V.index,ne=U.index;$<0||ne<0||(V.cell.adjacent[V.index]=U.cell,U.cell.adjacent[U.index]=V.cell)}},p.insert=function(f,y){var o=this.vertices;o.push(f);var m=this.walk(f,y);if(!!m){for(var l=this.dimension,w=this.tuple,_=0;_<=l;++_){var h=m.vertices[_];h<0?w[_]=f:w[_]=o[h]}var b=this.orient(w);b<0||b===0&&(m=this.handleBoundaryDegeneracy(m,f),!m)||this.addPeaks(f,m)}},p.boundary=function(){for(var f=this.dimension,y=[],o=this.simplices,m=o.length,l=0;l<m;++l){var w=o[l];if(w.boundary){for(var _=new Array(f),h=w.vertices,b=0,u=0,L=0;L<=f;++L)h[L]>=0?_[b++]=h[L]:u=L&1;if(u===(f&1)){var T=_[0];_[0]=_[1],_[1]=T}y.push(_)}}return y};function v(f,y){var o=f.length;if(o===0)throw new Error("Must have at least d+1 points");var m=f[0].length;if(o<=m)throw new Error("Must input at least d+1 points");var l=f.slice(0,m+1),w=e.apply(void 0,l);if(w===0)throw new Error("Input not in general position");for(var _=new Array(m+1),h=0;h<=m;++h)_[h]=h;w<0&&(_[0]=1,_[1]=0);for(var b=new n(_,new Array(m+1),!1),u=b.adjacent,L=new Array(m+2),h=0;h<=m;++h){for(var T=_.slice(),k=0;k<=m;++k)k===h&&(T[k]=-1);var P=T[0];T[0]=T[1],T[1]=P;var z=new n(T,new Array(m+1),!0);u[h]=z,L[h]=z}L[m+1]=b;for(var h=0;h<=m;++h)for(var T=u[h].vertices,I=u[h].adjacent,k=0;k<=m;++k){var D=T[k];if(D<0){I[k]=b;continue}for(var R=0;R<=m;++R)u[R].vertices.indexOf(D)<0&&(I[k]=u[R])}for(var O=new x(m,l,L),F=!!y,h=m+1;h<o;++h)O.insert(f[h],F);return O.boundary()}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(g,S,M){var e=g("binary-search-bounds"),a=0,n=1,r=2;S.exports=b;function t(u,L,T,k,P){this.mid=u,this.left=L,this.right=T,this.leftPoints=k,this.rightPoints=P,this.count=(L?L.count:0)+(T?T.count:0)+k.length}var c=t.prototype;function s(u,L){u.mid=L.mid,u.left=L.left,u.right=L.right,u.leftPoints=L.leftPoints,u.rightPoints=L.rightPoints,u.count=L.count}function i(u,L){var T=w(L);u.mid=T.mid,u.left=T.left,u.right=T.right,u.leftPoints=T.leftPoints,u.rightPoints=T.rightPoints,u.count=T.count}function x(u,L){var T=u.intervals([]);T.push(L),i(u,T)}function p(u,L){var T=u.intervals([]),k=T.indexOf(L);return k<0?a:(T.splice(k,1),i(u,T),n)}c.intervals=function(u){return u.push.apply(u,this.leftPoints),this.left&&this.left.intervals(u),this.right&&this.right.intervals(u),u},c.insert=function(u){var L=this.count-this.leftPoints.length;if(this.count+=1,u[1]<this.mid)this.left?4*(this.left.count+1)>3*(L+1)?x(this,u):this.left.insert(u):this.left=w([u]);else if(u[0]>this.mid)this.right?4*(this.right.count+1)>3*(L+1)?x(this,u):this.right.insert(u):this.right=w([u]);else{var T=e.ge(this.leftPoints,u,m),k=e.ge(this.rightPoints,u,l);this.leftPoints.splice(T,0,u),this.rightPoints.splice(k,0,u)}},c.remove=function(u){var L=this.count-this.leftPoints;if(u[1]<this.mid){if(!this.left)return a;var T=this.right?this.right.count:0;if(4*T>3*(L-1))return p(this,u);var k=this.left.remove(u);return k===r?(this.left=null,this.count-=1,n):(k===n&&(this.count-=1),k)}else if(u[0]>this.mid){if(!this.right)return a;var P=this.left?this.left.count:0;if(4*P>3*(L-1))return p(this,u);var k=this.right.remove(u);return k===r?(this.right=null,this.count-=1,n):(k===n&&(this.count-=1),k)}else{if(this.count===1)return this.leftPoints[0]===u?r:a;if(this.leftPoints.length===1&&this.leftPoints[0]===u){if(this.left&&this.right){for(var z=this,I=this.left;I.right;)z=I,I=I.right;if(z===this)I.right=this.right;else{var D=this.left,k=this.right;z.count-=I.count,z.right=I.left,I.left=D,I.right=k}s(this,I),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?s(this,this.left):s(this,this.right);return n}for(var D=e.ge(this.leftPoints,u,m);D<this.leftPoints.length&&this.leftPoints[D][0]===u[0];++D)if(this.leftPoints[D]===u){this.count-=1,this.leftPoints.splice(D,1);for(var k=e.ge(this.rightPoints,u,l);k<this.rightPoints.length&&this.rightPoints[k][1]===u[1];++k)if(this.rightPoints[k]===u)return this.rightPoints.splice(k,1),n}return a}};function v(u,L,T){for(var k=0;k<u.length&&u[k][0]<=L;++k){var P=T(u[k]);if(P)return P}}function f(u,L,T){for(var k=u.length-1;k>=0&&u[k][1]>=L;--k){var P=T(u[k]);if(P)return P}}function y(u,L){for(var T=0;T<u.length;++T){var k=L(u[T]);if(k)return k}}c.queryPoint=function(u,L){if(u<this.mid){if(this.left){var T=this.left.queryPoint(u,L);if(T)return T}return v(this.leftPoints,u,L)}else if(u>this.mid){if(this.right){var T=this.right.queryPoint(u,L);if(T)return T}return f(this.rightPoints,u,L)}else return y(this.leftPoints,L)},c.queryInterval=function(u,L,T){if(u<this.mid&&this.left){var k=this.left.queryInterval(u,L,T);if(k)return k}if(L>this.mid&&this.right){var k=this.right.queryInterval(u,L,T);if(k)return k}return L<this.mid?v(this.leftPoints,L,T):u>this.mid?f(this.rightPoints,u,T):y(this.leftPoints,T)};function o(u,L){return u-L}function m(u,L){var T=u[0]-L[0];return T||u[1]-L[1]}function l(u,L){var T=u[1]-L[1];return T||u[0]-L[0]}function w(u){if(u.length===0)return null;for(var L=[],T=0;T<u.length;++T)L.push(u[T][0],u[T][1]);L.sort(o);for(var k=L[L.length>>1],P=[],z=[],I=[],T=0;T<u.length;++T){var D=u[T];D[1]<k?P.push(D):k<D[0]?z.push(D):I.push(D)}var R=I,O=I.slice();return R.sort(m),O.sort(l),new t(k,w(P),w(z),R,O)}function _(u){this.root=u}var h=_.prototype;h.insert=function(u){this.root?this.root.insert(u):this.root=new t(u[0],null,null,[u],[u])},h.remove=function(u){if(this.root){var L=this.root.remove(u);return L===r&&(this.root=null),L!==a}return!1},h.queryPoint=function(u,L){if(this.root)return this.root.queryPoint(u,L)},h.queryInterval=function(u,L,T){if(u<=L&&this.root)return this.root.queryInterval(u,L,T)},Object.defineProperty(h,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(h,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});function b(u){return!u||u.length===0?new _(null):new _(w(u))}},{"binary-search-bounds":31}],235:[function(g,S,M){function e(a){for(var n=new Array(a),r=0;r<a;++r)n[r]=r;return n}S.exports=e},{}],236:[function(g,S,M){S.exports=!0},{}],237:[function(g,S,M){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */S.exports=function(n){return n!=null&&(e(n)||a(n)||!!n._isBuffer)};function e(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function a(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&e(n.slice(0,0))}},{}],238:[function(g,S,M){S.exports=n,S.exports.isMobile=n,S.exports.default=n;var e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,a=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function n(r){r||(r={});var t=r.ua;if(!t&&typeof navigator<"u"&&(t=navigator.userAgent),t&&t.headers&&typeof t.headers["user-agent"]=="string"&&(t=t.headers["user-agent"]),typeof t!="string")return!1;var c=r.tablet?a.test(t):e.test(t);return!c&&r.tablet&&r.featureDetect&&navigator&&navigator.maxTouchPoints>1&&t.indexOf("Macintosh")!==-1&&t.indexOf("Safari")!==-1&&(c=!0),c}},{}],239:[function(g,S,M){S.exports=function(e){for(var a=e.length,n,r=0;r<a;r++)if(n=e.charCodeAt(r),(n<9||n>13)&&n!==32&&n!==133&&n!==160&&n!==5760&&n!==6158&&(n<8192||n>8205)&&n!==8232&&n!==8233&&n!==8239&&n!==8287&&n!==8288&&n!==12288&&n!==65279)return!1;return!0}},{}],240:[function(g,S,M){function e(a,n,r){return a*(1-r)+n*r}S.exports=e},{}],241:[function(g,S,M){var e=g("./normalize"),a=g("gl-mat4/create"),n=g("gl-mat4/clone"),r=g("gl-mat4/determinant"),t=g("gl-mat4/invert"),c=g("gl-mat4/transpose"),s={length:g("gl-vec3/length"),normalize:g("gl-vec3/normalize"),dot:g("gl-vec3/dot"),cross:g("gl-vec3/cross")},i=a(),x=a(),p=[0,0,0,0],v=[[0,0,0],[0,0,0],[0,0,0]],f=[0,0,0];S.exports=function(w,_,h,b,u,L){if(_||(_=[0,0,0]),h||(h=[0,0,0]),b||(b=[0,0,0]),u||(u=[0,0,0,1]),L||(L=[0,0,0,1]),!e(i,w)||(n(x,i),x[3]=0,x[7]=0,x[11]=0,x[15]=1,Math.abs(r(x)<1e-8)))return!1;var T=i[3],k=i[7],P=i[11],z=i[12],I=i[13],D=i[14],R=i[15];if(T!==0||k!==0||P!==0){p[0]=T,p[1]=k,p[2]=P,p[3]=R;var O=t(x,x);if(!O)return!1;c(x,x),y(u,p,x)}else u[0]=u[1]=u[2]=0,u[3]=1;if(_[0]=z,_[1]=I,_[2]=D,o(v,i),h[0]=s.length(v[0]),s.normalize(v[0],v[0]),b[0]=s.dot(v[0],v[1]),m(v[1],v[1],v[0],1,-b[0]),h[1]=s.length(v[1]),s.normalize(v[1],v[1]),b[0]/=h[1],b[1]=s.dot(v[0],v[2]),m(v[2],v[2],v[0],1,-b[1]),b[2]=s.dot(v[1],v[2]),m(v[2],v[2],v[1],1,-b[2]),h[2]=s.length(v[2]),s.normalize(v[2],v[2]),b[1]/=h[2],b[2]/=h[2],s.cross(f,v[1],v[2]),s.dot(v[0],f)<0)for(var F=0;F<3;F++)h[F]*=-1,v[F][0]*=-1,v[F][1]*=-1,v[F][2]*=-1;return L[0]=.5*Math.sqrt(Math.max(1+v[0][0]-v[1][1]-v[2][2],0)),L[1]=.5*Math.sqrt(Math.max(1-v[0][0]+v[1][1]-v[2][2],0)),L[2]=.5*Math.sqrt(Math.max(1-v[0][0]-v[1][1]+v[2][2],0)),L[3]=.5*Math.sqrt(Math.max(1+v[0][0]+v[1][1]+v[2][2],0)),v[2][1]>v[1][2]&&(L[0]=-L[0]),v[0][2]>v[2][0]&&(L[1]=-L[1]),v[1][0]>v[0][1]&&(L[2]=-L[2]),!0};function y(l,w,_){var h=w[0],b=w[1],u=w[2],L=w[3];return l[0]=_[0]*h+_[4]*b+_[8]*u+_[12]*L,l[1]=_[1]*h+_[5]*b+_[9]*u+_[13]*L,l[2]=_[2]*h+_[6]*b+_[10]*u+_[14]*L,l[3]=_[3]*h+_[7]*b+_[11]*u+_[15]*L,l}function o(l,w){l[0][0]=w[0],l[0][1]=w[1],l[0][2]=w[2],l[1][0]=w[4],l[1][1]=w[5],l[1][2]=w[6],l[2][0]=w[8],l[2][1]=w[9],l[2][2]=w[10]}function m(l,w,_,h,b){l[0]=w[0]*h+_[0]*b,l[1]=w[1]*h+_[1]*b,l[2]=w[2]*h+_[2]*b}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(g,S,M){S.exports=function(a,n){var r=n[15];if(r===0)return!1;for(var t=1/r,c=0;c<16;c++)a[c]=n[c]*t;return!0}},{}],243:[function(g,S,M){var e=g("gl-vec3/lerp"),a=g("mat4-recompose"),n=g("mat4-decompose"),r=g("gl-mat4/determinant"),t=g("quat-slerp"),c=p(),s=p(),i=p();S.exports=x;function x(y,o,m,l){if(r(o)===0||r(m)===0)return!1;var w=n(o,c.translate,c.scale,c.skew,c.perspective,c.quaternion),_=n(m,s.translate,s.scale,s.skew,s.perspective,s.quaternion);return!w||!_?!1:(e(i.translate,c.translate,s.translate,l),e(i.skew,c.skew,s.skew,l),e(i.scale,c.scale,s.scale,l),e(i.perspective,c.perspective,s.perspective,l),t(i.quaternion,c.quaternion,s.quaternion,l),a(y,i.translate,i.scale,i.skew,i.perspective,i.quaternion),!0)}function p(){return{translate:v(),scale:v(1),skew:v(),perspective:f(),quaternion:f()}}function v(y){return[y||0,y||0,y||0]}function f(){return[0,0,0,1]}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(g,S,M){var e={identity:g("gl-mat4/identity"),translate:g("gl-mat4/translate"),multiply:g("gl-mat4/multiply"),create:g("gl-mat4/create"),scale:g("gl-mat4/scale"),fromRotationTranslation:g("gl-mat4/fromRotationTranslation")};e.create();var a=e.create();S.exports=function(r,t,c,s,i,x){return e.identity(r),e.fromRotationTranslation(r,x,t),r[3]=i[0],r[7]=i[1],r[11]=i[2],r[15]=i[3],e.identity(a),s[2]!==0&&(a[9]=s[2],e.multiply(r,r,a)),s[1]!==0&&(a[9]=0,a[8]=s[1],e.multiply(r,r,a)),s[0]!==0&&(a[8]=0,a[4]=s[0],e.multiply(r,r,a)),e.scale(r,r,c),r}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(g,S,M){var e=g("binary-search-bounds"),a=g("mat4-interpolate"),n=g("gl-mat4/invert"),r=g("gl-mat4/rotateX"),t=g("gl-mat4/rotateY"),c=g("gl-mat4/rotateZ"),s=g("gl-mat4/lookAt"),i=g("gl-mat4/translate");g("gl-mat4/scale");var x=g("gl-vec3/normalize"),p=[0,0,0];S.exports=o;function v(m){this._components=m.slice(),this._time=[0],this.prevMatrix=m.slice(),this.nextMatrix=m.slice(),this.computedMatrix=m.slice(),this.computedInverse=m.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}var f=v.prototype;f.recalcMatrix=function(m){var l=this._time,w=e.le(l,m),_=this.computedMatrix;if(!(w<0)){var h=this._components;if(w===l.length-1)for(var b=16*w,u=0;u<16;++u)_[u]=h[b++];else{for(var L=l[w+1]-l[w],b=16*w,T=this.prevMatrix,k=!0,u=0;u<16;++u)T[u]=h[b++];for(var P=this.nextMatrix,u=0;u<16;++u)P[u]=h[b++],k=k&&T[u]===P[u];if(L<1e-6||k)for(var u=0;u<16;++u)_[u]=T[u];else a(_,T,P,(m-l[w])/L)}var z=this.computedUp;z[0]=_[1],z[1]=_[5],z[2]=_[9],x(z,z);var I=this.computedInverse;n(I,_);var D=this.computedEye,R=I[15];D[0]=I[12]/R,D[1]=I[13]/R,D[2]=I[14]/R;for(var O=this.computedCenter,F=Math.exp(this.computedRadius[0]),u=0;u<3;++u)O[u]=D[u]-_[2+4*u]*F}},f.idle=function(m){if(!(m<this.lastT())){for(var l=this._components,w=l.length-16,_=0;_<16;++_)l.push(l[w++]);this._time.push(m)}},f.flush=function(m){var l=e.gt(this._time,m)-2;l<0||(this._time.splice(0,l),this._components.splice(0,16*l))},f.lastT=function(){return this._time[this._time.length-1]},f.lookAt=function(m,l,w,_){this.recalcMatrix(m),l=l||this.computedEye,w=w||p,_=_||this.computedUp,this.setMatrix(m,s(this.computedMatrix,l,w,_));for(var h=0,b=0;b<3;++b)h+=Math.pow(w[b]-l[b],2);h=Math.log(Math.sqrt(h)),this.computedRadius[0]=h},f.rotate=function(m,l,w,_){this.recalcMatrix(m);var h=this.computedInverse;l&&t(h,h,l),w&&r(h,h,w),_&&c(h,h,_),this.setMatrix(m,n(this.computedMatrix,h))};var y=[0,0,0];f.pan=function(m,l,w,_){y[0]=-(l||0),y[1]=-(w||0),y[2]=-(_||0),this.recalcMatrix(m);var h=this.computedInverse;i(h,h,y),this.setMatrix(m,n(h,h))},f.translate=function(m,l,w,_){y[0]=l||0,y[1]=w||0,y[2]=_||0,this.recalcMatrix(m);var h=this.computedMatrix;i(h,h,y),this.setMatrix(m,h)},f.setMatrix=function(m,l){if(!(m<this.lastT())){this._time.push(m);for(var w=0;w<16;++w)this._components.push(l[w])}},f.setDistance=function(m,l){this.computedRadius[0]=l},f.setDistanceLimits=function(m,l){var w=this._limits;w[0]=m,w[1]=l},f.getDistanceLimits=function(m){var l=this._limits;return m?(m[0]=l[0],m[1]=l[1],m):l};function o(m){m=m||{};var l=m.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new v(l)}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(g,S,M){S.exports=a;var e=g("robust-orientation")[3];function a(n){var r=n.length;if(r<3){for(var f=new Array(r),t=0;t<r;++t)f[t]=t;return r===2&&n[0][0]===n[1][0]&&n[0][1]===n[1][1]?[0]:f}for(var c=new Array(r),t=0;t<r;++t)c[t]=t;c.sort(function(l,w){var _=n[l][0]-n[w][0];return _||n[l][1]-n[w][1]});for(var s=[c[0],c[1]],i=[c[0],c[1]],t=2;t<r;++t){for(var x=c[t],p=n[x],v=s.length;v>1&&e(n[s[v-2]],n[s[v-1]],p)<=0;)v-=1,s.pop();for(s.push(x),v=i.length;v>1&&e(n[i[v-2]],n[i[v-1]],p)>=0;)v-=1,i.pop();i.push(x)}for(var f=new Array(i.length+s.length-2),y=0,t=0,o=s.length;t<o;++t)f[y++]=s[t];for(var m=i.length-2;m>0;--m)f[y++]=i[m];return f}},{"robust-orientation":284}],247:[function(g,S,M){S.exports=a;var e=g("mouse-event");function a(n,r){r||(r=n,n=window);var t=0,c=0,s=0,i={shift:!1,alt:!1,control:!1,meta:!1},x=!1;function p(u){var L=!1;return"altKey"in u&&(L=L||u.altKey!==i.alt,i.alt=!!u.altKey),"shiftKey"in u&&(L=L||u.shiftKey!==i.shift,i.shift=!!u.shiftKey),"ctrlKey"in u&&(L=L||u.ctrlKey!==i.control,i.control=!!u.ctrlKey),"metaKey"in u&&(L=L||u.metaKey!==i.meta,i.meta=!!u.metaKey),L}function v(u,L){var T=e.x(L),k=e.y(L);"buttons"in L&&(u=L.buttons|0),(u!==t||T!==c||k!==s||p(L))&&(t=u|0,c=T||0,s=k||0,r&&r(t,c,s,i))}function f(u){v(0,u)}function y(){(t||c||s||i.shift||i.alt||i.meta||i.control)&&(c=s=0,t=0,i.shift=i.alt=i.control=i.meta=!1,r&&r(0,0,0,i))}function o(u){p(u)&&r&&r(t,c,s,i)}function m(u){e.buttons(u)===0?v(0,u):v(t,u)}function l(u){v(t|e.buttons(u),u)}function w(u){v(t&~e.buttons(u),u)}function _(){x||(x=!0,n.addEventListener("mousemove",m),n.addEventListener("mousedown",l),n.addEventListener("mouseup",w),n.addEventListener("mouseleave",f),n.addEventListener("mouseenter",f),n.addEventListener("mouseout",f),n.addEventListener("mouseover",f),n.addEventListener("blur",y),n.addEventListener("keyup",o),n.addEventListener("keydown",o),n.addEventListener("keypress",o),n!==window&&(window.addEventListener("blur",y),window.addEventListener("keyup",o),window.addEventListener("keydown",o),window.addEventListener("keypress",o)))}function h(){!x||(x=!1,n.removeEventListener("mousemove",m),n.removeEventListener("mousedown",l),n.removeEventListener("mouseup",w),n.removeEventListener("mouseleave",f),n.removeEventListener("mouseenter",f),n.removeEventListener("mouseout",f),n.removeEventListener("mouseover",f),n.removeEventListener("blur",y),n.removeEventListener("keyup",o),n.removeEventListener("keydown",o),n.removeEventListener("keypress",o),n!==window&&(window.removeEventListener("blur",y),window.removeEventListener("keyup",o),window.removeEventListener("keydown",o),window.removeEventListener("keypress",o)))}_();var b={element:n};return Object.defineProperties(b,{enabled:{get:function(){return x},set:function(u){u?_():h()},enumerable:!0},buttons:{get:function(){return t},enumerable:!0},x:{get:function(){return c},enumerable:!0},y:{get:function(){return s},enumerable:!0},mods:{get:function(){return i},enumerable:!0}}),b}},{"mouse-event":249}],248:[function(g,S,M){var e={left:0,top:0};S.exports=a;function a(r,t,c){t=t||r.currentTarget||r.srcElement,Array.isArray(c)||(c=[0,0]);var s=r.clientX||0,i=r.clientY||0,x=n(t);return c[0]=s-x.left,c[1]=i-x.top,c}function n(r){return r===window||r===document||r===document.body?e:r.getBoundingClientRect()}},{}],249:[function(g,S,M){function e(t){if(typeof t=="object"){if("buttons"in t)return t.buttons;if("which"in t){var c=t.which;if(c===2)return 4;if(c===3)return 2;if(c>0)return 1<<c-1}else if("button"in t){var c=t.button;if(c===1)return 4;if(c===2)return 2;if(c>=0)return 1<<c}}return 0}M.buttons=e;function a(t){return t.target||t.srcElement||window}M.element=a;function n(t){if(typeof t=="object"){if("offsetX"in t)return t.offsetX;var c=a(t),s=c.getBoundingClientRect();return t.clientX-s.left}return 0}M.x=n;function r(t){if(typeof t=="object"){if("offsetY"in t)return t.offsetY;var c=a(t),s=c.getBoundingClientRect();return t.clientY-s.top}return 0}M.y=r},{}],250:[function(g,S,M){var e=g("to-px");S.exports=a;function a(n,r,t){typeof n=="function"&&(t=!!r,r=n,n=window);var c=e("ex",n),s=function(i){t&&i.preventDefault();var x=i.deltaX||0,p=i.deltaY||0,v=i.deltaZ||0,f=i.deltaMode,y=1;switch(f){case 1:y=c;break;case 2:y=window.innerHeight;break}if(x*=y,p*=y,v*=y,x||p||v)return r(x,p,v,i)};return n.addEventListener("wheel",s),s}},{"to-px":304}],251:[function(g,S,M){var e=g("typedarray-pool");S.exports=r;var a={"false,0,1":function(c,s,i,x,p){return function(f,y,o,m){var l=f.shape[0]|0,w=f.shape[1]|0,_=f.data,h=f.offset|0,b=f.stride[0]|0,u=f.stride[1]|0,L=h,T,k=-b|0,P=0,z=-u|0,I=0,D=-b-u|0,R=0,O=b|0,F=u-b*l|0,N=0,G=0,K=0,W=2*l|0,Y=x(W),re=x(W),ue=0,j=0,q=-1,V=-1,U=0,$=-l|0,ne=l|0,X=0,Q=-l-1|0,ie=l-1|0,se=0,ae=0,oe=0;for(N=0;N<l;++N)Y[ue++]=i(_[L],y,o,m),L+=O;if(L+=F,w>0){if(G=1,Y[ue++]=i(_[L],y,o,m),L+=O,l>0)for(N=1,T=_[L],j=Y[ue]=i(T,y,o,m),U=Y[ue+q],X=Y[ue+$],se=Y[ue+Q],(j!==U||j!==X||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],c(N,G,T,P,I,R,j,U,X,se,y,o,m),ae=re[ue]=K++),ue+=1,L+=O,N=2;N<l;++N)T=_[L],j=Y[ue]=i(T,y,o,m),U=Y[ue+q],X=Y[ue+$],se=Y[ue+Q],(j!==U||j!==X||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],c(N,G,T,P,I,R,j,U,X,se,y,o,m),ae=re[ue]=K++,se!==U&&s(re[ue+q],ae,R,P,se,U,y,o,m)),ue+=1,L+=O;for(L+=F,ue=0,oe=q,q=V,V=oe,oe=$,$=ne,ne=oe,oe=Q,Q=ie,ie=oe,G=2;G<w;++G){if(Y[ue++]=i(_[L],y,o,m),L+=O,l>0)for(N=1,T=_[L],j=Y[ue]=i(T,y,o,m),U=Y[ue+q],X=Y[ue+$],se=Y[ue+Q],(j!==U||j!==X||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],c(N,G,T,P,I,R,j,U,X,se,y,o,m),ae=re[ue]=K++,se!==X&&s(re[ue+$],ae,I,R,X,se,y,o,m)),ue+=1,L+=O,N=2;N<l;++N)T=_[L],j=Y[ue]=i(T,y,o,m),U=Y[ue+q],X=Y[ue+$],se=Y[ue+Q],(j!==U||j!==X||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],c(N,G,T,P,I,R,j,U,X,se,y,o,m),ae=re[ue]=K++,se!==X&&s(re[ue+$],ae,I,R,X,se,y,o,m),se!==U&&s(re[ue+q],ae,R,P,se,U,y,o,m)),ue+=1,L+=O;G&1&&(ue=0),oe=q,q=V,V=oe,oe=$,$=ne,ne=oe,oe=Q,Q=ie,ie=oe,L+=F}}p(re),p(Y)}},"false,1,0":function(c,s,i,x,p){return function(f,y,o,m){var l=f.shape[0]|0,w=f.shape[1]|0,_=f.data,h=f.offset|0,b=f.stride[0]|0,u=f.stride[1]|0,L=h,T,k=-b|0,P=0,z=-u|0,I=0,D=-b-u|0,R=0,O=u|0,F=b-u*w|0,N=0,G=0,K=0,W=2*w|0,Y=x(W),re=x(W),ue=0,j=0,q=-1,V=-1,U=0,$=-w|0,ne=w|0,X=0,Q=-w-1|0,ie=w-1|0,se=0,ae=0,oe=0;for(G=0;G<w;++G)Y[ue++]=i(_[L],y,o,m),L+=O;if(L+=F,l>0){if(N=1,Y[ue++]=i(_[L],y,o,m),L+=O,w>0)for(G=1,T=_[L],j=Y[ue]=i(T,y,o,m),X=Y[ue+$],U=Y[ue+q],se=Y[ue+Q],(j!==X||j!==U||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],c(N,G,T,P,I,R,j,X,U,se,y,o,m),ae=re[ue]=K++),ue+=1,L+=O,G=2;G<w;++G)T=_[L],j=Y[ue]=i(T,y,o,m),X=Y[ue+$],U=Y[ue+q],se=Y[ue+Q],(j!==X||j!==U||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],c(N,G,T,P,I,R,j,X,U,se,y,o,m),ae=re[ue]=K++,se!==U&&s(re[ue+q],ae,I,R,U,se,y,o,m)),ue+=1,L+=O;for(L+=F,ue=0,oe=$,$=ne,ne=oe,oe=q,q=V,V=oe,oe=Q,Q=ie,ie=oe,N=2;N<l;++N){if(Y[ue++]=i(_[L],y,o,m),L+=O,w>0)for(G=1,T=_[L],j=Y[ue]=i(T,y,o,m),X=Y[ue+$],U=Y[ue+q],se=Y[ue+Q],(j!==X||j!==U||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],c(N,G,T,P,I,R,j,X,U,se,y,o,m),ae=re[ue]=K++,se!==X&&s(re[ue+$],ae,R,P,se,X,y,o,m)),ue+=1,L+=O,G=2;G<w;++G)T=_[L],j=Y[ue]=i(T,y,o,m),X=Y[ue+$],U=Y[ue+q],se=Y[ue+Q],(j!==X||j!==U||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],c(N,G,T,P,I,R,j,X,U,se,y,o,m),ae=re[ue]=K++,se!==U&&s(re[ue+q],ae,I,R,U,se,y,o,m),se!==X&&s(re[ue+$],ae,R,P,se,X,y,o,m)),ue+=1,L+=O;N&1&&(ue=0),oe=$,$=ne,ne=oe,oe=q,q=V,V=oe,oe=Q,Q=ie,ie=oe,L+=F}}p(re),p(Y)}}};function n(t,c,s,i,x,p){var v=[p,x].join(","),f=a[v];return f(t,c,s,e.mallocUint32,e.freeUint32)}function r(t){function c(y){throw new Error("ndarray-extract-contour: "+y)}typeof t!="object"&&c("Must specify arguments");var s=t.order;Array.isArray(s)||c("Must specify order");var i=t.arrayArguments||1;i<1&&c("Must have at least one array argument");var x=t.scalarArguments||0;x<0&&c("Scalar arg count must be > 0"),typeof t.vertex!="function"&&c("Must specify vertex creation function"),typeof t.cell!="function"&&c("Must specify cell creation function"),typeof t.phase!="function"&&c("Must specify phase function");for(var p=t.getters||[],v=new Array(i),f=0;f<i;++f)p.indexOf(f)>=0?v[f]=!0:v[f]=!1;return n(t.vertex,t.cell,t.phase,x,s,v)}},{"typedarray-pool":308}],252:[function(g,S,M){var e=g("dup"),a={zero:function(o,m,l,w){var _=o[0],h=l[0];w|=0;var b=0,u=h;for(b=0;b<_;++b)m[w]=0,w+=u},fdTemplate1:function(o,m,l,w,_,h,b){var u=o[0],L=l[0],T=h[0],k=-1*L,P=L;w|=0,b|=0;var z=0,I=L,D=T;for(z=0;z<u;++z)_[b]=.5*(m[w+k]-m[w+P]),w+=I,b+=D},fdTemplate2:function(o,m,l,w,_,h,b,u,L,T){var k=o[0],P=o[1],z=l[0],I=l[1],D=h[0],R=h[1],O=L[0],F=L[1],N=-1*z,G=z,K=-1*I,W=I;w|=0,b|=0,T|=0;var Y=0,re=0,ue=I,j=z-P*I,q=R,V=D-P*R,U=F,$=O-P*F;for(re=0;re<k;++re){for(Y=0;Y<P;++Y)_[b]=.5*(m[w+N]-m[w+G]),u[T]=.5*(m[w+K]-m[w+W]),w+=ue,b+=q,T+=U;w+=j,b+=V,T+=$}}},n={cdiff:function(o){var m={};return function(w,_,h){var b=w.dtype,u=w.order,L=_.dtype,T=_.order,k=h.dtype,P=h.order,z=[b,u.join(),L,T.join(),k,P.join()].join(),I=m[z];return I||(m[z]=I=o([b,u,L,T,k,P])),I(w.shape.slice(0),w.data,w.stride,w.offset|0,_.data,_.stride,_.offset|0,h.data,h.stride,h.offset|0)}},zero:function(o){var m={};return function(w){var _=w.dtype,h=w.order,b=[_,h.join()].join(),u=m[b];return u||(m[b]=u=o([_,h])),u(w.shape.slice(0),w.data,w.stride,w.offset|0)}},fdTemplate1:function(o){var m={};return function(w,_){var h=w.dtype,b=w.order,u=_.dtype,L=_.order,T=[h,b.join(),u,L.join()].join(),k=m[T];return k||(m[T]=k=o([h,b,u,L])),k(w.shape.slice(0),w.data,w.stride,w.offset|0,_.data,_.stride,_.offset|0)}},fdTemplate2:function(o){var m={};return function(w,_,h){var b=w.dtype,u=w.order,L=_.dtype,T=_.order,k=h.dtype,P=h.order,z=[b,u.join(),L,T.join(),k,P.join()].join(),I=m[z];return I||(m[z]=I=o([b,u,L,T,k,P])),I(w.shape.slice(0),w.data,w.stride,w.offset|0,_.data,_.stride,_.offset|0,h.data,h.stride,h.offset|0)}}};function r(o){var m=n[o.funcName];return m(t.bind(void 0,o))}function t(o){return a[o.funcName]}function c(o){return r({funcName:o.funcName})}var s={},i={},x=c({funcName:"cdiff"}),p=c({funcName:"zero"});function v(o){return o in s?s[o]:s[o]=c({funcName:"fdTemplate"+o})}function f(o,m,l,w){return function(_,h){var b=h.shape.slice();return b[0]>2&&b[1]>2&&w(h.pick(-1,-1).lo(1,1).hi(b[0]-2,b[1]-2),_.pick(-1,-1,0).lo(1,1).hi(b[0]-2,b[1]-2),_.pick(-1,-1,1).lo(1,1).hi(b[0]-2,b[1]-2)),b[1]>2&&(l(h.pick(0,-1).lo(1).hi(b[1]-2),_.pick(0,-1,1).lo(1).hi(b[1]-2)),m(_.pick(0,-1,0).lo(1).hi(b[1]-2))),b[1]>2&&(l(h.pick(b[0]-1,-1).lo(1).hi(b[1]-2),_.pick(b[0]-1,-1,1).lo(1).hi(b[1]-2)),m(_.pick(b[0]-1,-1,0).lo(1).hi(b[1]-2))),b[0]>2&&(l(h.pick(-1,0).lo(1).hi(b[0]-2),_.pick(-1,0,0).lo(1).hi(b[0]-2)),m(_.pick(-1,0,1).lo(1).hi(b[0]-2))),b[0]>2&&(l(h.pick(-1,b[1]-1).lo(1).hi(b[0]-2),_.pick(-1,b[1]-1,0).lo(1).hi(b[0]-2)),m(_.pick(-1,b[1]-1,1).lo(1).hi(b[0]-2))),_.set(0,0,0,0),_.set(0,0,1,0),_.set(b[0]-1,0,0,0),_.set(b[0]-1,0,1,0),_.set(0,b[1]-1,0,0),_.set(0,b[1]-1,1,0),_.set(b[0]-1,b[1]-1,0,0),_.set(b[0]-1,b[1]-1,1,0),_}}function y(o){var m=o.join(),b=i[m];if(b)return b;for(var l=o.length,w=[x,p],_=1;_<=l;++_)w.push(v(_));var h=f,b=h.apply(void 0,w);return i[m]=b,b}S.exports=function(m,l,w){if(Array.isArray(w)||(typeof w=="string"?w=e(l.dimension,w):w=e(l.dimension,"clamp")),l.size===0)return m;if(l.dimension===0)return m.set(0),m;var _=y(w);return _(m,l)}},{dup:65}],253:[function(g,S,M){function e(c,s){var i=Math.floor(s),x=s-i,p=0<=i&&i<c.shape[0],v=0<=i+1&&i+1<c.shape[0],f=p?+c.get(i):0,y=v?+c.get(i+1):0;return(1-x)*f+x*y}function a(c,s,i){var x=Math.floor(s),p=s-x,v=0<=x&&x<c.shape[0],f=0<=x+1&&x+1<c.shape[0],y=Math.floor(i),o=i-y,m=0<=y&&y<c.shape[1],l=0<=y+1&&y+1<c.shape[1],w=v&&m?c.get(x,y):0,_=v&&l?c.get(x,y+1):0,h=f&&m?c.get(x+1,y):0,b=f&&l?c.get(x+1,y+1):0;return(1-o)*((1-p)*w+p*h)+o*((1-p)*_+p*b)}function n(c,s,i,x){var p=Math.floor(s),v=s-p,f=0<=p&&p<c.shape[0],y=0<=p+1&&p+1<c.shape[0],o=Math.floor(i),m=i-o,l=0<=o&&o<c.shape[1],w=0<=o+1&&o+1<c.shape[1],_=Math.floor(x),h=x-_,b=0<=_&&_<c.shape[2],u=0<=_+1&&_+1<c.shape[2],L=f&&l&&b?c.get(p,o,_):0,T=f&&w&&b?c.get(p,o+1,_):0,k=y&&l&&b?c.get(p+1,o,_):0,P=y&&w&&b?c.get(p+1,o+1,_):0,z=f&&l&&u?c.get(p,o,_+1):0,I=f&&w&&u?c.get(p,o+1,_+1):0,D=y&&l&&u?c.get(p+1,o,_+1):0,R=y&&w&&u?c.get(p+1,o+1,_+1):0;return(1-h)*((1-m)*((1-v)*L+v*k)+m*((1-v)*T+v*P))+h*((1-m)*((1-v)*z+v*D)+m*((1-v)*I+v*R))}function r(c){var s=c.shape.length|0,i=new Array(s),x=new Array(s),p=new Array(s),v=new Array(s),f,y;for(f=0;f<s;++f)y=+arguments[f+1],i[f]=Math.floor(y),x[f]=y-i[f],p[f]=0<=i[f]&&i[f]<c.shape[f],v[f]=0<=i[f]+1&&i[f]+1<c.shape[f];var o=0,m,l,w;e:for(f=0;f<1<<s;++f){for(l=1,w=c.offset,m=0;m<s;++m)if(f&1<<m){if(!v[m])continue e;l*=x[m],w+=c.stride[m]*(i[m]+1)}else{if(!p[m])continue e;l*=1-x[m],w+=c.stride[m]*i[m]}o+=l*c.data[w]}return o}function t(c,s,i,x){switch(c.shape.length){case 0:return 0;case 1:return e(c,s);case 2:return a(c,s,i);case 3:return n(c,s,i,x);default:return r.apply(void 0,arguments)}}S.exports=t,S.exports.d1=e,S.exports.d2=a,S.exports.d3=n},{}],254:[function(g,S,M){var e={"float64,2,1,0":function(){return function(x,p,v,f,y){var o=x[0],m=x[1],l=x[2],w=v[0],_=v[1],h=v[2];f|=0;var b=0,u=0,L=0,T=h,k=_-l*h,P=w-m*_;for(L=0;L<o;++L){for(u=0;u<m;++u){for(b=0;b<l;++b)p[f]/=y,f+=T;f+=k}f+=P}}},"uint8,2,0,1,float64,2,1,0":function(){return function(x,p,v,f,y,o,m,l){var w=x[0],_=x[1],h=x[2],b=v[0],u=v[1],L=v[2],T=o[0],k=o[1],P=o[2];f|=0,m|=0;for(var z=f,I=m,D=x[0]|0;D>0;){D<64?(w=D,D=0):(w=64,D-=64);for(var R=x[1]|0;R>0;){R<64?(_=R,R=0):(_=64,R-=64),f=z+D*b+R*u,m=I+D*T+R*k;var O=0,F=0,N=0,G=L,K=b-h*L,W=u-w*b,Y=P,re=T-h*P,ue=k-w*T;for(N=0;N<_;++N){for(F=0;F<w;++F){for(O=0;O<h;++O)p[f]=y[m]*l,f+=G,m+=Y;f+=K,m+=re}f+=W,m+=ue}}}}},"float32,1,0,float32,1,0":function(){return function(x,p,v,f,y,o,m){var l=x[0],w=x[1],_=v[0],h=v[1],b=o[0],u=o[1];f|=0,m|=0;var L=0,T=0,k=h,P=_-w*h,z=u,I=b-w*u;for(T=0;T<l;++T){for(L=0;L<w;++L)p[f]=y[m],f+=k,m+=z;f+=P,m+=I}}},"float32,1,0,float32,0,1":function(){return function(x,p,v,f,y,o,m){var l=x[0],w=x[1],_=v[0],h=v[1],b=o[0],u=o[1];f|=0,m|=0;for(var L=f,T=m,k=x[1]|0;k>0;){k<64?(w=k,k=0):(w=64,k-=64);for(var P=x[0]|0;P>0;){P<64?(l=P,P=0):(l=64,P-=64),f=L+k*h+P*_,m=T+k*u+P*b;var z=0,I=0,D=h,R=_-w*h,O=u,F=b-w*u;for(I=0;I<l;++I){for(z=0;z<w;++z)p[f]=y[m],f+=D,m+=O;f+=R,m+=F}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(x,p,v,f,y,o,m){var l=x[0],w=x[1],_=x[2],h=v[0],b=v[1],u=v[2],L=o[0],T=o[1],k=o[2];f|=0,m|=0;for(var P=f,z=m,I=x[2]|0;I>0;){I<64?(_=I,I=0):(_=64,I-=64);for(var D=x[0]|0;D>0;){D<64?(l=D,D=0):(l=64,D-=64);for(var R=x[1]|0;R>0;){R<64?(w=R,R=0):(w=64,R-=64),f=P+I*u+D*h+R*b,m=z+I*k+D*L+R*T;var O=0,F=0,N=0,G=u,K=h-_*u,W=b-l*h,Y=k,re=L-_*k,ue=T-l*L;for(N=0;N<w;++N){for(F=0;F<l;++F){for(O=0;O<_;++O)p[f]=y[m],f+=G,m+=Y;f+=K,m+=re}f+=W,m+=ue}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(x,p,v,f,y,o,m){var l=x[0],w=x[1],_=x[2],h=v[0],b=v[1],u=v[2],L=o[0],T=o[1],k=o[2];f|=0,m|=0;var P=0,z=0,I=0,D=u,R=h-_*u,O=b-l*h,F=k,N=L-_*k,G=T-l*L;for(I=0;I<w;++I){for(z=0;z<l;++z){for(P=0;P<_;++P)p[f]=y[m],f+=D,m+=F;f+=R,m+=N}f+=O,m+=G}}}};function a(i,x){var p=x.join(","),v=e[p];return v()}var n=a,r={mul:function(i){var x={};return function(v,f,y){var o=v.dtype,m=v.order,l=f.dtype,w=f.order,_=y.dtype,h=y.order,b=[o,m.join(),l,w.join(),_,h.join()].join(),u=x[b];return u||(x[b]=u=i([o,m,l,w,_,h])),u(v.shape.slice(0),v.data,v.stride,v.offset|0,f.data,f.stride,f.offset|0,y.data,y.stride,y.offset|0)}},muls:function(i){var x={};return function(v,f,y){var o=v.dtype,m=v.order,l=f.dtype,w=f.order,_=[o,m.join(),l,w.join()].join(),h=x[_];return h||(x[_]=h=i([o,m,l,w])),h(v.shape.slice(0),v.data,v.stride,v.offset|0,f.data,f.stride,f.offset|0,y)}},mulseq:function(i){var x={};return function(v,f){var y=v.dtype,o=v.order,m=[y,o.join()].join(),l=x[m];return l||(x[m]=l=i([y,o])),l(v.shape.slice(0),v.data,v.stride,v.offset|0,f)}},div:function(i){var x={};return function(v,f,y){var o=v.dtype,m=v.order,l=f.dtype,w=f.order,_=y.dtype,h=y.order,b=[o,m.join(),l,w.join(),_,h.join()].join(),u=x[b];return u||(x[b]=u=i([o,m,l,w,_,h])),u(v.shape.slice(0),v.data,v.stride,v.offset|0,f.data,f.stride,f.offset|0,y.data,y.stride,y.offset|0)}},divs:function(i){var x={};return function(v,f,y){var o=v.dtype,m=v.order,l=f.dtype,w=f.order,_=[o,m.join(),l,w.join()].join(),h=x[_];return h||(x[_]=h=i([o,m,l,w])),h(v.shape.slice(0),v.data,v.stride,v.offset|0,f.data,f.stride,f.offset|0,y)}},divseq:function(i){var x={};return function(v,f){var y=v.dtype,o=v.order,m=[y,o.join()].join(),l=x[m];return l||(x[m]=l=i([y,o])),l(v.shape.slice(0),v.data,v.stride,v.offset|0,f)}},assign:function(i){var x={};return function(v,f){var y=v.dtype,o=v.order,m=f.dtype,l=f.order,w=[y,o.join(),m,l.join()].join(),_=x[w];return _||(x[w]=_=i([y,o,m,l])),_(v.shape.slice(0),v.data,v.stride,v.offset|0,f.data,f.stride,f.offset|0)}}};function t(i){var x=r[i.funcName];return x(n.bind(void 0,i))}function c(i){return t({funcName:i.funcName})}var s={mul:"*",div:"/"};(function(){for(var i in s)M[i]=c({funcName:i}),M[i+"s"]=c({funcName:i+"s"}),M[i+"seq"]=c({funcName:i+"seq"})})(),M.assign=c({funcName:"assign"})},{}],255:[function(g,S,M){var e=g("ndarray"),a=g("./doConvert.js");S.exports=function(r,t){for(var c=[],s=r,i=1;Array.isArray(s);)c.push(s.length),i*=s.length,s=s[0];return c.length===0?e():(t||(t=e(new Float64Array(i),c)),a(t,r),t)}},{"./doConvert.js":256,ndarray:259}],256:[function(g,S,M){function e(){return function(s,i,x,p,v){var f=s[0],y=s[1],o=s[2],m=x[0],l=x[1],w=x[2],_=[0,0,0];p|=0;var h=0,b=0,u=0,L=w,T=l-o*w,k=m-y*l;for(u=0;u<f;++u){for(b=0;b<y;++b){for(h=0;h<o;++h){{var P=v,z;for(z=0;z<_.length-1;++z)P=P[_[z]];i[p]=P[_[_.length-1]]}p+=L,++_[2]}p+=T,_[2]-=o,++_[1]}p+=k,_[1]-=y,++_[0]}}}function a(){return e()}var n=a;function r(s){var i={};return function(p,v){var f=p.dtype,y=p.order,o=[f,y.join()].join(),m=i[o];return m||(i[o]=m=s([f,y])),m(p.shape.slice(0),p.data,p.stride,p.offset|0,v)}}function t(s){return r(n.bind(void 0,s))}function c(s){return t({funcName:s.funcName})}S.exports=c({funcName:"convert"})},{}],257:[function(g,S,M){var e=g("typedarray-pool");function a(x){switch(x){case"uint32":return[e.mallocUint32,e.freeUint32];default:return null}}var n={"uint32,1,0":function(x,p){return function(f,y,o,m,l,w,_,h,b,u,L){var T,k,P,z=f*l+m,I,D=x(h),R,O,F,N;for(T=f+1;T<=y;++T){for(k=T,z+=l,P=z,R=0,O=z,I=0;I<h;++I)D[R++]=o[O],O+=b;e:for(;k-- >f;){R=0,O=P-l;t:for(I=0;I<h;++I){if(F=o[O],N=D[R],F<N)break e;if(F>N)break t;O+=u,R+=L}for(R=P,O=P-l,I=0;I<h;++I)o[R]=o[O],R+=b,O+=b;P-=l}for(R=P,O=0,I=0;I<h;++I)o[R]=D[O++],R+=b}p(D)}}};function r(x,p){var v=a(p),f=[p,x].join(","),y=n[f];return v?y(v[0],v[1]):y()}var t={"uint32,1,0":function(x,p,v){return function f(y,o,m,l,w,_,h,b,u,L,T){var k=(o-y+1)/6|0,P=y+k,z=o-k,I=y+o>>1,D=I-k,R=I+k,O=P,F=D,N=I,G=R,K=z,W=y+1,Y=o-1,re=!0,ue,j,q,V,U,$,ne,X,Q,ie=0,se=0,ae=0,oe,be,ce,de,ye,ge,me,Ee,Pe,Ne,we,ke,Xe,He,Ie,De,Ge=b,ht=p(Ge),Rt=p(Ge);be=w*O,ce=w*F,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=O,O=F,F=j;break e}if(ae<0)break e;De+=L}be=w*G,ce=w*K,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=G,G=K,K=j;break e}if(ae<0)break e;De+=L}be=w*O,ce=w*N,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=O,O=N,N=j;break e}if(ae<0)break e;De+=L}be=w*F,ce=w*N,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=F,F=N,N=j;break e}if(ae<0)break e;De+=L}be=w*O,ce=w*G,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=O,O=G,G=j;break e}if(ae<0)break e;De+=L}be=w*N,ce=w*G,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=N,N=G,G=j;break e}if(ae<0)break e;De+=L}be=w*F,ce=w*K,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=F,F=K,K=j;break e}if(ae<0)break e;De+=L}be=w*F,ce=w*N,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=F,F=N,N=j;break e}if(ae<0)break e;De+=L}be=w*G,ce=w*K,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=G,G=K,K=j;break e}if(ae<0)break e;De+=L}for(be=w*O,ce=w*F,de=w*N,ye=w*G,ge=w*K,me=w*P,Ee=w*I,Pe=w*z,Ie=0,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,Q=de+De,Ne=ye+De,we=ge+De,ke=me+De,Xe=Ee+De,He=Pe+De,ht[Ie]=m[X],Rt[Ie]=m[Ne],re=re&&ht[Ie]===Rt[Ie],q=m[ne],V=m[Q],U=m[we],m[ke]=q,m[Xe]=V,m[He]=U,++Ie,De+=u;for(be=w*D,ce=w*y,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,m[ne]=m[X],De+=u;for(be=w*R,ce=w*o,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,m[ne]=m[X],De+=u;if(re)for($=W;$<=Y;++$){ne=l+$*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ae=m[ne]-ht[Ie],ae!==0)break e;Ie+=T,ne+=L}if(ae!==0)if(ae<0){if($!==W)for(be=w*$,ce=w*W,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,ue=m[ne],m[ne]=m[X],m[X]=ue,De+=u;++W}else for(;;){ne=l+Y*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ae=m[ne]-ht[Ie],ae!==0)break e;Ie+=T,ne+=L}if(ae>0)Y--;else if(ae<0){for(be=w*$,ce=w*W,de=w*Y,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,Q=de+De,ue=m[ne],m[ne]=m[X],m[X]=m[Q],m[Q]=ue,De+=u;++W,--Y;break}else{for(be=w*$,ce=w*Y,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,ue=m[ne],m[ne]=m[X],m[X]=ue,De+=u;--Y;break}}}else for($=W;$<=Y;++$){ne=l+$*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ie=m[ne]-ht[Ie],ie!==0)break e;Ie+=T,ne+=L}if(ie<0){if($!==W)for(be=w*$,ce=w*W,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,ue=m[ne],m[ne]=m[X],m[X]=ue,De+=u;++W}else{ne=l+$*w,Ie=0;e:for(oe=0;oe<b;++oe){if(se=m[ne]-Rt[Ie],se!==0)break e;Ie+=T,ne+=L}if(se>0)for(;;){ne=l+Y*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ae=m[ne]-Rt[Ie],ae!==0)break e;Ie+=T,ne+=L}if(ae>0){if(--Y<$)break;continue}else{ne=l+Y*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ae=m[ne]-ht[Ie],ae!==0)break e;Ie+=T,ne+=L}if(ae<0){for(be=w*$,ce=w*W,de=w*Y,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,Q=de+De,ue=m[ne],m[ne]=m[X],m[X]=m[Q],m[Q]=ue,De+=u;++W,--Y}else{for(be=w*$,ce=w*Y,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,ue=m[ne],m[ne]=m[X],m[X]=ue,De+=u;--Y}break}}}}for(be=w*y,ce=w*(W-1),Ie=0,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,m[ne]=m[X],m[X]=ht[Ie],++Ie,De+=u;for(be=w*o,ce=w*(Y+1),Ie=0,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,m[ne]=m[X],m[X]=Rt[Ie],++Ie,De+=u;if(W-2-y<=32?x(y,W-2,m,l,w,_,h,b,u,L,T):f(y,W-2,m,l,w,_,h,b,u,L,T),o-(Y+2)<=32?x(Y+2,o,m,l,w,_,h,b,u,L,T):f(Y+2,o,m,l,w,_,h,b,u,L,T),re){v(ht),v(Rt);return}if(W<P&&Y>z){e:for(;;){for(ne=l+W*w,Ie=0,De=l,oe=0;oe<b;++oe){if(m[ne]!==ht[Ie])break e;++Ie,ne+=u}++W}e:for(;;){for(ne=l+Y*w,Ie=0,De=l,oe=0;oe<b;++oe){if(m[ne]!==Rt[Ie])break e;++Ie,ne+=u}--Y}for($=W;$<=Y;++$){ne=l+$*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ie=m[ne]-ht[Ie],ie!==0)break e;Ie+=T,ne+=L}if(ie===0){if($!==W)for(be=w*$,ce=w*W,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,ue=m[ne],m[ne]=m[X],m[X]=ue,De+=u;++W}else{ne=l+$*w,Ie=0;e:for(oe=0;oe<b;++oe){if(se=m[ne]-Rt[Ie],se!==0)break e;Ie+=T,ne+=L}if(se===0)for(;;){ne=l+Y*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ae=m[ne]-Rt[Ie],ae!==0)break e;Ie+=T,ne+=L}if(ae===0){if(--Y<$)break;continue}else{ne=l+Y*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ae=m[ne]-ht[Ie],ae!==0)break e;Ie+=T,ne+=L}if(ae<0){for(be=w*$,ce=w*W,de=w*Y,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,Q=de+De,ue=m[ne],m[ne]=m[X],m[X]=m[Q],m[Q]=ue,De+=u;++W,--Y}else{for(be=w*$,ce=w*Y,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,ue=m[ne],m[ne]=m[X],m[X]=ue,De+=u;--Y}break}}}}}v(ht),v(Rt),Y-W<=32?x(W,Y,m,l,w,_,h,b,u,L,T):f(W,Y,m,l,w,_,h,b,u,L,T)}}};function c(x,p,v){var f=a(p),y=[p,x].join(","),o=t[y];return x.length>1&&f?o(v,f[0],f[1]):o(v)}var s={"uint32,1,0":function(x,p){return function(v){var f=v.data,y=v.offset|0,o=v.shape,m=v.stride,l=m[0]|0,w=o[0]|0,_=m[1]|0,h=o[1]|0,b=_,u=_,L=1;w<=32?x(0,w-1,f,y,l,_,w,h,b,u,L):p(0,w-1,f,y,l,_,w,h,b,u,L)}}};function i(x,p){var v=[p,x].join(","),f=s[v],y=r(x,p),o=c(x,p,y);return f(y,o)}S.exports=i},{"typedarray-pool":308}],258:[function(g,S,M){var e=g("./lib/compile_sort.js"),a={};function n(r){var t=r.order,c=r.dtype,s=[t,c],i=s.join(":"),x=a[i];return x||(a[i]=x=e(t,c)),x(r),r}S.exports=n},{"./lib/compile_sort.js":257}],259:[function(g,S,M){var e=g("is-buffer"),a=typeof Float64Array<"u";function n(p,v){return p[0]-v[0]}function r(){var p=this.stride,v=new Array(p.length),f;for(f=0;f<v.length;++f)v[f]=[Math.abs(p[f]),f];v.sort(n);var y=new Array(v.length);for(f=0;f<y.length;++f)y[f]=v[f][1];return y}var t={T:function(p){function v(y){this.data=y}var f=v.prototype;return f.dtype=p,f.index=function(){return-1},f.size=0,f.dimension=-1,f.shape=f.stride=f.order=[],f.lo=f.hi=f.transpose=f.step=function(){return new v(this.data)},f.get=f.set=function(){},f.pick=function(){return null},function(o){return new v(o)}},0:function(p,v){function f(o,m){this.data=o,this.offset=m}var y=f.prototype;return y.dtype=p,y.index=function(){return this.offset},y.dimension=0,y.size=1,y.shape=y.stride=y.order=[],y.lo=y.hi=y.transpose=y.step=function(){return new f(this.data,this.offset)},y.pick=function(){return v(this.data)},y.valueOf=y.get=function(){return p==="generic"?this.data.get(this.offset):this.data[this.offset]},y.set=function(m){return p==="generic"?this.data.set(this.offset,m):this.data[this.offset]=m},function(m,l,w,_){return new f(m,_)}},1:function(p,v,f){function y(m,l,w,_){this.data=m,this.shape=[l],this.stride=[w],this.offset=_|0}var o=y.prototype;return o.dtype=p,o.dimension=1,Object.defineProperty(o,"size",{get:function(){return this.shape[0]}}),o.order=[0],o.set=function(l,w){return p==="generic"?this.data.set(this.offset+this.stride[0]*l,w):this.data[this.offset+this.stride[0]*l]=w},o.get=function(l){return p==="generic"?this.data.get(this.offset+this.stride[0]*l):this.data[this.offset+this.stride[0]*l]},o.index=function(l){return this.offset+this.stride[0]*l},o.hi=function(l){return new y(this.data,typeof l!="number"||l<0?this.shape[0]:l|0,this.stride[0],this.offset)},o.lo=function(l){var w=this.offset,_=0,h=this.shape[0],b=this.stride[0];return typeof l=="number"&&l>=0&&(_=l|0,w+=b*_,h-=_),new y(this.data,h,b,w)},o.step=function(l){var w=this.shape[0],_=this.stride[0],h=this.offset,b=0,u=Math.ceil;return typeof l=="number"&&(b=l|0,b<0?(h+=_*(w-1),w=u(-w/b)):w=u(w/b),_*=b),new y(this.data,w,_,h)},o.transpose=function(l){l=l===void 0?0:l|0;var w=this.shape,_=this.stride;return new y(this.data,w[l],_[l],this.offset)},o.pick=function(l){var w=[],_=[],h=this.offset;typeof l=="number"&&l>=0?h=h+this.stride[0]*l|0:(w.push(this.shape[0]),_.push(this.stride[0]));var b=v[w.length+1];return b(this.data,w,_,h)},function(l,w,_,h){return new y(l,w[0],_[0],h)}},2:function(p,v,f){function y(m,l,w,_,h,b){this.data=m,this.shape=[l,w],this.stride=[_,h],this.offset=b|0}var o=y.prototype;return o.dtype=p,o.dimension=2,Object.defineProperty(o,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(o,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),o.set=function(l,w,_){return p==="generic"?this.data.set(this.offset+this.stride[0]*l+this.stride[1]*w,_):this.data[this.offset+this.stride[0]*l+this.stride[1]*w]=_},o.get=function(l,w){return p==="generic"?this.data.get(this.offset+this.stride[0]*l+this.stride[1]*w):this.data[this.offset+this.stride[0]*l+this.stride[1]*w]},o.index=function(l,w){return this.offset+this.stride[0]*l+this.stride[1]*w},o.hi=function(l,w){return new y(this.data,typeof l!="number"||l<0?this.shape[0]:l|0,typeof w!="number"||w<0?this.shape[1]:w|0,this.stride[0],this.stride[1],this.offset)},o.lo=function(l,w){var _=this.offset,h=0,b=this.shape[0],u=this.shape[1],L=this.stride[0],T=this.stride[1];return typeof l=="number"&&l>=0&&(h=l|0,_+=L*h,b-=h),typeof w=="number"&&w>=0&&(h=w|0,_+=T*h,u-=h),new y(this.data,b,u,L,T,_)},o.step=function(l,w){var _=this.shape[0],h=this.shape[1],b=this.stride[0],u=this.stride[1],L=this.offset,T=0,k=Math.ceil;return typeof l=="number"&&(T=l|0,T<0?(L+=b*(_-1),_=k(-_/T)):_=k(_/T),b*=T),typeof w=="number"&&(T=w|0,T<0?(L+=u*(h-1),h=k(-h/T)):h=k(h/T),u*=T),new y(this.data,_,h,b,u,L)},o.transpose=function(l,w){l=l===void 0?0:l|0,w=w===void 0?1:w|0;var _=this.shape,h=this.stride;return new y(this.data,_[l],_[w],h[l],h[w],this.offset)},o.pick=function(l,w){var _=[],h=[],b=this.offset;typeof l=="number"&&l>=0?b=b+this.stride[0]*l|0:(_.push(this.shape[0]),h.push(this.stride[0])),typeof w=="number"&&w>=0?b=b+this.stride[1]*w|0:(_.push(this.shape[1]),h.push(this.stride[1]));var u=v[_.length+1];return u(this.data,_,h,b)},function(l,w,_,h){return new y(l,w[0],w[1],_[0],_[1],h)}},3:function(p,v,f){function y(m,l,w,_,h,b,u,L){this.data=m,this.shape=[l,w,_],this.stride=[h,b,u],this.offset=L|0}var o=y.prototype;return o.dtype=p,o.dimension=3,Object.defineProperty(o,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(o,"order",{get:function(){var l=Math.abs(this.stride[0]),w=Math.abs(this.stride[1]),_=Math.abs(this.stride[2]);return l>w?w>_?[2,1,0]:l>_?[1,2,0]:[1,0,2]:l>_?[2,0,1]:_>w?[0,1,2]:[0,2,1]}}),o.set=function(l,w,_,h){return p==="generic"?this.data.set(this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_,h):this.data[this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_]=h},o.get=function(l,w,_){return p==="generic"?this.data.get(this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_):this.data[this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_]},o.index=function(l,w,_){return this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_},o.hi=function(l,w,_){return new y(this.data,typeof l!="number"||l<0?this.shape[0]:l|0,typeof w!="number"||w<0?this.shape[1]:w|0,typeof _!="number"||_<0?this.shape[2]:_|0,this.stride[0],this.stride[1],this.stride[2],this.offset)},o.lo=function(l,w,_){var h=this.offset,b=0,u=this.shape[0],L=this.shape[1],T=this.shape[2],k=this.stride[0],P=this.stride[1],z=this.stride[2];return typeof l=="number"&&l>=0&&(b=l|0,h+=k*b,u-=b),typeof w=="number"&&w>=0&&(b=w|0,h+=P*b,L-=b),typeof _=="number"&&_>=0&&(b=_|0,h+=z*b,T-=b),new y(this.data,u,L,T,k,P,z,h)},o.step=function(l,w,_){var h=this.shape[0],b=this.shape[1],u=this.shape[2],L=this.stride[0],T=this.stride[1],k=this.stride[2],P=this.offset,z=0,I=Math.ceil;return typeof l=="number"&&(z=l|0,z<0?(P+=L*(h-1),h=I(-h/z)):h=I(h/z),L*=z),typeof w=="number"&&(z=w|0,z<0?(P+=T*(b-1),b=I(-b/z)):b=I(b/z),T*=z),typeof _=="number"&&(z=_|0,z<0?(P+=k*(u-1),u=I(-u/z)):u=I(u/z),k*=z),new y(this.data,h,b,u,L,T,k,P)},o.transpose=function(l,w,_){l=l===void 0?0:l|0,w=w===void 0?1:w|0,_=_===void 0?2:_|0;var h=this.shape,b=this.stride;return new y(this.data,h[l],h[w],h[_],b[l],b[w],b[_],this.offset)},o.pick=function(l,w,_){var h=[],b=[],u=this.offset;typeof l=="number"&&l>=0?u=u+this.stride[0]*l|0:(h.push(this.shape[0]),b.push(this.stride[0])),typeof w=="number"&&w>=0?u=u+this.stride[1]*w|0:(h.push(this.shape[1]),b.push(this.stride[1])),typeof _=="number"&&_>=0?u=u+this.stride[2]*_|0:(h.push(this.shape[2]),b.push(this.stride[2]));var L=v[h.length+1];return L(this.data,h,b,u)},function(l,w,_,h){return new y(l,w[0],w[1],w[2],_[0],_[1],_[2],h)}},4:function(p,v,f){function y(m,l,w,_,h,b,u,L,T,k){this.data=m,this.shape=[l,w,_,h],this.stride=[b,u,L,T],this.offset=k|0}var o=y.prototype;return o.dtype=p,o.dimension=4,Object.defineProperty(o,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(o,"order",{get:f}),o.set=function(l,w,_,h,b){return p==="generic"?this.data.set(this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_+this.stride[3]*h,b):this.data[this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_+this.stride[3]*h]=b},o.get=function(l,w,_,h){return p==="generic"?this.data.get(this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_+this.stride[3]*h):this.data[this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_+this.stride[3]*h]},o.index=function(l,w,_,h){return this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_+this.stride[3]*h},o.hi=function(l,w,_,h){return new y(this.data,typeof l!="number"||l<0?this.shape[0]:l|0,typeof w!="number"||w<0?this.shape[1]:w|0,typeof _!="number"||_<0?this.shape[2]:_|0,typeof h!="number"||h<0?this.shape[3]:h|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},o.lo=function(l,w,_,h){var b=this.offset,u=0,L=this.shape[0],T=this.shape[1],k=this.shape[2],P=this.shape[3],z=this.stride[0],I=this.stride[1],D=this.stride[2],R=this.stride[3];return typeof l=="number"&&l>=0&&(u=l|0,b+=z*u,L-=u),typeof w=="number"&&w>=0&&(u=w|0,b+=I*u,T-=u),typeof _=="number"&&_>=0&&(u=_|0,b+=D*u,k-=u),typeof h=="number"&&h>=0&&(u=h|0,b+=R*u,P-=u),new y(this.data,L,T,k,P,z,I,D,R,b)},o.step=function(l,w,_,h){var b=this.shape[0],u=this.shape[1],L=this.shape[2],T=this.shape[3],k=this.stride[0],P=this.stride[1],z=this.stride[2],I=this.stride[3],D=this.offset,R=0,O=Math.ceil;return typeof l=="number"&&(R=l|0,R<0?(D+=k*(b-1),b=O(-b/R)):b=O(b/R),k*=R),typeof w=="number"&&(R=w|0,R<0?(D+=P*(u-1),u=O(-u/R)):u=O(u/R),P*=R),typeof _=="number"&&(R=_|0,R<0?(D+=z*(L-1),L=O(-L/R)):L=O(L/R),z*=R),typeof h=="number"&&(R=h|0,R<0?(D+=I*(T-1),T=O(-T/R)):T=O(T/R),I*=R),new y(this.data,b,u,L,T,k,P,z,I,D)},o.transpose=function(l,w,_,h){l=l===void 0?0:l|0,w=w===void 0?1:w|0,_=_===void 0?2:_|0,h=h===void 0?3:h|0;var b=this.shape,u=this.stride;return new y(this.data,b[l],b[w],b[_],b[h],u[l],u[w],u[_],u[h],this.offset)},o.pick=function(l,w,_,h){var b=[],u=[],L=this.offset;typeof l=="number"&&l>=0?L=L+this.stride[0]*l|0:(b.push(this.shape[0]),u.push(this.stride[0])),typeof w=="number"&&w>=0?L=L+this.stride[1]*w|0:(b.push(this.shape[1]),u.push(this.stride[1])),typeof _=="number"&&_>=0?L=L+this.stride[2]*_|0:(b.push(this.shape[2]),u.push(this.stride[2])),typeof h=="number"&&h>=0?L=L+this.stride[3]*h|0:(b.push(this.shape[3]),u.push(this.stride[3]));var T=v[b.length+1];return T(this.data,b,u,L)},function(l,w,_,h){return new y(l,w[0],w[1],w[2],w[3],_[0],_[1],_[2],_[3],h)}},5:function(v,f,y){function o(l,w,_,h,b,u,L,T,k,P,z,I){this.data=l,this.shape=[w,_,h,b,u],this.stride=[L,T,k,P,z],this.offset=I|0}var m=o.prototype;return m.dtype=v,m.dimension=5,Object.defineProperty(m,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(m,"order",{get:y}),m.set=function(w,_,h,b,u,L){return v==="generic"?this.data.set(this.offset+this.stride[0]*w+this.stride[1]*_+this.stride[2]*h+this.stride[3]*b+this.stride[4]*u,L):this.data[this.offset+this.stride[0]*w+this.stride[1]*_+this.stride[2]*h+this.stride[3]*b+this.stride[4]*u]=L},m.get=function(w,_,h,b,u){return v==="generic"?this.data.get(this.offset+this.stride[0]*w+this.stride[1]*_+this.stride[2]*h+this.stride[3]*b+this.stride[4]*u):this.data[this.offset+this.stride[0]*w+this.stride[1]*_+this.stride[2]*h+this.stride[3]*b+this.stride[4]*u]},m.index=function(w,_,h,b,u){return this.offset+this.stride[0]*w+this.stride[1]*_+this.stride[2]*h+this.stride[3]*b+this.stride[4]*u},m.hi=function(w,_,h,b,u){return new o(this.data,typeof w!="number"||w<0?this.shape[0]:w|0,typeof _!="number"||_<0?this.shape[1]:_|0,typeof h!="number"||h<0?this.shape[2]:h|0,typeof b!="number"||b<0?this.shape[3]:b|0,typeof u!="number"||u<0?this.shape[4]:u|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},m.lo=function(w,_,h,b,u){var L=this.offset,T=0,k=this.shape[0],P=this.shape[1],z=this.shape[2],I=this.shape[3],D=this.shape[4],R=this.stride[0],O=this.stride[1],F=this.stride[2],N=this.stride[3],G=this.stride[4];return typeof w=="number"&&w>=0&&(T=w|0,L+=R*T,k-=T),typeof _=="number"&&_>=0&&(T=_|0,L+=O*T,P-=T),typeof h=="number"&&h>=0&&(T=h|0,L+=F*T,z-=T),typeof b=="number"&&b>=0&&(T=b|0,L+=N*T,I-=T),typeof u=="number"&&u>=0&&(T=u|0,L+=G*T,D-=T),new o(this.data,k,P,z,I,D,R,O,F,N,G,L)},m.step=function(w,_,h,b,u){var L=this.shape[0],T=this.shape[1],k=this.shape[2],P=this.shape[3],z=this.shape[4],I=this.stride[0],D=this.stride[1],R=this.stride[2],O=this.stride[3],F=this.stride[4],N=this.offset,G=0,K=Math.ceil;return typeof w=="number"&&(G=w|0,G<0?(N+=I*(L-1),L=K(-L/G)):L=K(L/G),I*=G),typeof _=="number"&&(G=_|0,G<0?(N+=D*(T-1),T=K(-T/G)):T=K(T/G),D*=G),typeof h=="number"&&(G=h|0,G<0?(N+=R*(k-1),k=K(-k/G)):k=K(k/G),R*=G),typeof b=="number"&&(G=b|0,G<0?(N+=O*(P-1),P=K(-P/G)):P=K(P/G),O*=G),typeof u=="number"&&(G=u|0,G<0?(N+=F*(z-1),z=K(-z/G)):z=K(z/G),F*=G),new o(this.data,L,T,k,P,z,I,D,R,O,F,N)},m.transpose=function(w,_,h,b,u){w=w===void 0?0:w|0,_=_===void 0?1:_|0,h=h===void 0?2:h|0,b=b===void 0?3:b|0,u=u===void 0?4:u|0;var L=this.shape,T=this.stride;return new o(this.data,L[w],L[_],L[h],L[b],L[u],T[w],T[_],T[h],T[b],T[u],this.offset)},m.pick=function(w,_,h,b,u){var L=[],T=[],k=this.offset;typeof w=="number"&&w>=0?k=k+this.stride[0]*w|0:(L.push(this.shape[0]),T.push(this.stride[0])),typeof _=="number"&&_>=0?k=k+this.stride[1]*_|0:(L.push(this.shape[1]),T.push(this.stride[1])),typeof h=="number"&&h>=0?k=k+this.stride[2]*h|0:(L.push(this.shape[2]),T.push(this.stride[2])),typeof b=="number"&&b>=0?k=k+this.stride[3]*b|0:(L.push(this.shape[3]),T.push(this.stride[3])),typeof u=="number"&&u>=0?k=k+this.stride[4]*u|0:(L.push(this.shape[4]),T.push(this.stride[4]));var P=f[L.length+1];return P(this.data,L,T,k)},function(w,_,h,b){return new o(w,_[0],_[1],_[2],_[3],_[4],h[0],h[1],h[2],h[3],h[4],b)}}};function c(p,v){var f=v===-1?"T":String(v),y=t[f];return v===-1?y(p):v===0?y(p,i[p][0]):y(p,i[p],r)}function s(p){if(e(p))return"buffer";if(a)switch(Object.prototype.toString.call(p)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(p)?"array":"generic"}var i={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};function x(p,v,f,y){if(p===void 0){var h=i.array[0];return h([])}else typeof p=="number"&&(p=[p]);v===void 0&&(v=[p.length]);var o=v.length;if(f===void 0){f=new Array(o);for(var m=o-1,l=1;m>=0;--m)f[m]=l,l*=v[m]}if(y===void 0){y=0;for(var m=0;m<o;++m)f[m]<0&&(y-=(v[m]-1)*f[m])}for(var w=s(p),_=i[w];_.length<=o+1;)_.push(c(w,_.length-1));var h=_[o+1];return h(p,v,f,y)}S.exports=x},{"is-buffer":237}],260:[function(g,S,M){var e=g("double-bits"),a=Math.pow(2,-1074),n=-1>>>0;S.exports=r;function r(t,c){if(isNaN(t)||isNaN(c))return NaN;if(t===c)return t;if(t===0)return c<0?-a:a;var s=e.hi(t),i=e.lo(t);return c>t==t>0?i===n?(s+=1,i=0):i+=1:i===0?(i=n,s-=1):i-=1,e.pack(i,s)}},{"double-bits":64}],261:[function(g,S,M){var e=1e-6,a=1e-6;M.vertexNormals=function(n,r,t){for(var c=r.length,s=new Array(c),i=t===void 0?e:t,x=0;x<c;++x)s[x]=[0,0,0];for(var x=0;x<n.length;++x)for(var p=n[x],v=0,f=p[p.length-1],y=p[0],o=0;o<p.length;++o){v=f,f=y,y=p[(o+1)%p.length];for(var m=r[v],l=r[f],w=r[y],_=new Array(3),h=0,b=new Array(3),u=0,L=0;L<3;++L)_[L]=m[L]-l[L],h+=_[L]*_[L],b[L]=w[L]-l[L],u+=b[L]*b[L];if(h*u>i)for(var T=s[f],k=1/Math.sqrt(h*u),L=0;L<3;++L){var P=(L+1)%3,z=(L+2)%3;T[L]+=k*(b[P]*_[z]-b[z]*_[P])}}for(var x=0;x<c;++x){for(var T=s[x],I=0,L=0;L<3;++L)I+=T[L]*T[L];if(I>i)for(var k=1/Math.sqrt(I),L=0;L<3;++L)T[L]*=k;else for(var L=0;L<3;++L)T[L]=0}return s},M.faceNormals=function(n,r,t){for(var c=n.length,s=new Array(c),i=t===void 0?a:t,x=0;x<c;++x){for(var p=n[x],v=new Array(3),f=0;f<3;++f)v[f]=r[p[f]];for(var y=new Array(3),o=new Array(3),f=0;f<3;++f)y[f]=v[1][f]-v[0][f],o[f]=v[2][f]-v[0][f];for(var m=new Array(3),l=0,f=0;f<3;++f){var w=(f+1)%3,_=(f+2)%3;m[f]=y[w]*o[_]-y[_]*o[w],l+=m[f]*m[f]}l>i?l=1/Math.sqrt(l):l=0;for(var f=0;f<3;++f)m[f]*=l;s[x]=m}return s}},{}],262:[function(g,S,M){S.exports=e;function e(a,n,r,t,c,s,i,x,p,v){var f=n+s+v;if(y>0){var y=Math.sqrt(f+1);a[0]=.5*(i-p)/y,a[1]=.5*(x-t)/y,a[2]=.5*(r-s)/y,a[3]=.5*y}else{var o=Math.max(n,s,v),y=Math.sqrt(2*o-f+1);n>=o?(a[0]=.5*y,a[1]=.5*(c+r)/y,a[2]=.5*(x+t)/y,a[3]=.5*(i-p)/y):s>=o?(a[0]=.5*(r+c)/y,a[1]=.5*y,a[2]=.5*(p+i)/y,a[3]=.5*(x-t)/y):(a[0]=.5*(t+x)/y,a[1]=.5*(i+p)/y,a[2]=.5*y,a[3]=.5*(r-c)/y)}return a}},{}],263:[function(g,S,M){S.exports=v;var e=g("filtered-vector"),a=g("gl-mat4/lookAt"),n=g("gl-mat4/fromQuat"),r=g("gl-mat4/invert"),t=g("./lib/quatFromFrame");function c(f,y,o){return Math.sqrt(Math.pow(f,2)+Math.pow(y,2)+Math.pow(o,2))}function s(f,y,o,m){return Math.sqrt(Math.pow(f,2)+Math.pow(y,2)+Math.pow(o,2)+Math.pow(m,2))}function i(f,y){var o=y[0],m=y[1],l=y[2],w=y[3],_=s(o,m,l,w);_>1e-6?(f[0]=o/_,f[1]=m/_,f[2]=l/_,f[3]=w/_):(f[0]=f[1]=f[2]=0,f[3]=1)}function x(f,y,o){this.radius=e([o]),this.center=e(y),this.rotation=e(f),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var p=x.prototype;p.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},p.recalcMatrix=function(f){this.radius.curve(f),this.center.curve(f),this.rotation.curve(f);var y=this.computedRotation;i(y,y);var o=this.computedMatrix;n(o,y);var m=this.computedCenter,l=this.computedEye,w=this.computedUp,_=Math.exp(this.computedRadius[0]);l[0]=m[0]+_*o[2],l[1]=m[1]+_*o[6],l[2]=m[2]+_*o[10],w[0]=o[1],w[1]=o[5],w[2]=o[9];for(var h=0;h<3;++h){for(var b=0,u=0;u<3;++u)b+=o[h+4*u]*l[u];o[12+h]=-b}},p.getMatrix=function(f,y){this.recalcMatrix(f);var o=this.computedMatrix;if(y){for(var m=0;m<16;++m)y[m]=o[m];return y}return o},p.idle=function(f){this.center.idle(f),this.radius.idle(f),this.rotation.idle(f)},p.flush=function(f){this.center.flush(f),this.radius.flush(f),this.rotation.flush(f)},p.pan=function(f,y,o,m){y=y||0,o=o||0,m=m||0,this.recalcMatrix(f);var l=this.computedMatrix,w=l[1],_=l[5],h=l[9],b=c(w,_,h);w/=b,_/=b,h/=b;var u=l[0],L=l[4],T=l[8],k=u*w+L*_+T*h;u-=w*k,L-=_*k,T-=h*k;var P=c(u,L,T);u/=P,L/=P,T/=P,l[2],l[6],l[10];var z=u*y+w*o,I=L*y+_*o,D=T*y+h*o;this.center.move(f,z,I,D);var R=Math.exp(this.computedRadius[0]);R=Math.max(1e-4,R+m),this.radius.set(f,Math.log(R))},p.rotate=function(f,y,o,m){this.recalcMatrix(f),y=y||0,o=o||0;var l=this.computedMatrix,w=l[0],_=l[4],h=l[8],b=l[1],u=l[5],L=l[9],T=l[2],k=l[6],P=l[10],z=y*w+o*b,I=y*_+o*u,D=y*h+o*L,R=-(k*D-P*I),O=-(P*z-T*D),F=-(T*I-k*z),N=Math.sqrt(Math.max(0,1-Math.pow(R,2)-Math.pow(O,2)-Math.pow(F,2))),G=s(R,O,F,N);G>1e-6?(R/=G,O/=G,F/=G,N/=G):(R=O=F=0,N=1);var K=this.computedRotation,W=K[0],Y=K[1],re=K[2],ue=K[3],j=W*N+ue*R+Y*F-re*O,q=Y*N+ue*O+re*R-W*F,V=re*N+ue*F+W*O-Y*R,U=ue*N-W*R-Y*O-re*F;if(m){R=T,O=k,F=P;var $=Math.sin(m)/c(R,O,F);R*=$,O*=$,F*=$,N=Math.cos(y),j=j*N+U*R+q*F-V*O,q=q*N+U*O+V*R-j*F,V=V*N+U*F+j*O-q*R,U=U*N-j*R-q*O-V*F}var ne=s(j,q,V,U);ne>1e-6?(j/=ne,q/=ne,V/=ne,U/=ne):(j=q=V=0,U=1),this.rotation.set(f,j,q,V,U)},p.lookAt=function(f,y,o,m){this.recalcMatrix(f),o=o||this.computedCenter,y=y||this.computedEye,m=m||this.computedUp;var l=this.computedMatrix;a(l,y,o,m);var w=this.computedRotation;t(w,l[0],l[1],l[2],l[4],l[5],l[6],l[8],l[9],l[10]),i(w,w),this.rotation.set(f,w[0],w[1],w[2],w[3]);for(var _=0,h=0;h<3;++h)_+=Math.pow(o[h]-y[h],2);this.radius.set(f,.5*Math.log(Math.max(_,1e-6))),this.center.set(f,o[0],o[1],o[2])},p.translate=function(f,y,o,m){this.center.move(f,y||0,o||0,m||0)},p.setMatrix=function(f,y){var o=this.computedRotation;t(o,y[0],y[1],y[2],y[4],y[5],y[6],y[8],y[9],y[10]),i(o,o),this.rotation.set(f,o[0],o[1],o[2],o[3]);var m=this.computedMatrix;r(m,y);var l=m[15];if(Math.abs(l)>1e-6){var w=m[12]/l,_=m[13]/l,h=m[14]/l;this.recalcMatrix(f);var b=Math.exp(this.computedRadius[0]);this.center.set(f,w-m[2]*b,_-m[6]*b,h-m[10]*b),this.radius.idle(f)}else this.center.idle(f),this.radius.idle(f)},p.setDistance=function(f,y){y>0&&this.radius.set(f,Math.log(y))},p.setDistanceLimits=function(f,y){f>0?f=Math.log(f):f=-1/0,y>0?y=Math.log(y):y=1/0,y=Math.max(y,f),this.radius.bounds[0][0]=f,this.radius.bounds[1][0]=y},p.getDistanceLimits=function(f){var y=this.radius.bounds;return f?(f[0]=Math.exp(y[0][0]),f[1]=Math.exp(y[1][0]),f):[Math.exp(y[0][0]),Math.exp(y[1][0])]},p.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},p.fromJSON=function(f){var y=this.lastT(),o=f.center;o&&this.center.set(y,o[0],o[1],o[2]);var m=f.rotation;m&&this.rotation.set(y,m[0],m[1],m[2],m[3]);var l=f.distance;l&&l>0&&this.radius.set(y,Math.log(l)),this.setDistanceLimits(f.zoomMin,f.zoomMax)};function v(f){f=f||{};var y=f.center||[0,0,0],o=f.rotation||[0,0,0,1],m=f.radius||1;y=[].slice.call(y,0,3),o=[].slice.call(o,0,4),i(o,o);var l=new x(o,y,Math.log(m));return l.setDistanceLimits(f.zoomMin,f.zoomMax),("eye"in f||"up"in f)&&l.lookAt(0,f.eye,f.center,f.up),l}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(g,S,M){var e=g("repeat-string");S.exports=function(n,r,t){return t=typeof t<"u"?t+"":" ",e(t,r)+n}},{"repeat-string":277}],265:[function(g,S,M){S.exports=function(a,n){n||(n=[0,""]),a=String(a);var r=parseFloat(a,10);return n[0]=r,n[1]=a.match(/[\d.\-\+]*\s*(.*)/)[1]||"",n}},{}],266:[function(g,S,M){S.exports=a;var e=g("compare-angle");function a(n,r){for(var t=r.length|0,c=n.length,s=[new Array(t),new Array(t)],i=0;i<t;++i)s[0][i]=[],s[1][i]=[];for(var i=0;i<c;++i){var x=n[i];s[0][x[0]].push(x),s[1][x[1]].push(x)}for(var p=[],i=0;i<t;++i)s[0][i].length+s[1][i].length===0&&p.push([i]);function v(_,h){var b=s[h][_[h]];b.splice(b.indexOf(_),1)}function f(_,h,b){for(var u,L,T,k=0;k<2;++k)if(s[k][h].length>0){u=s[k][h][0],T=k;break}L=u[T^1];for(var P=0;P<2;++P)for(var z=s[P][h],I=0;I<z.length;++I){var D=z[I],R=D[P^1],O=e(r[_],r[h],r[L],r[R]);O>0&&(u=D,L=R,T=P)}return b||u&&v(u,T),L}function y(_,h){var b=s[h][_][0],u=[_];v(b,h);for(var L=b[h^1];;){for(;L!==_;)u.push(L),L=f(u[u.length-2],L,!1);if(s[0][_].length+s[1][_].length===0)break;var T=u[u.length-1],k=_,P=u[1],z=f(T,k,!0);if(e(r[T],r[k],r[P],r[z])<0)break;u.push(_),L=f(T,k)}return u}function o(_,h){return h[1]===h[h.length-1]}for(var i=0;i<t;++i)for(var m=0;m<2;++m){for(var l=[];s[m][i].length>0;){s[0][i].length;var w=y(i,m);o(l,w)?l.push.apply(l,w):(l.length>0&&p.push(l),l=w)}l.length>0&&p.push(l)}return p}},{"compare-angle":54}],267:[function(g,S,M){S.exports=a;var e=g("edges-to-adjacency-list");function a(n,r){for(var t=e(n,r.length),c=new Array(r.length),s=new Array(r.length),i=[],x=0;x<r.length;++x){var p=t[x].length;s[x]=p,c[x]=!0,p<=1&&i.push(x)}for(;i.length>0;){var v=i.pop();c[v]=!1;for(var f=t[v],x=0;x<f.length;++x){var y=f[x];--s[y]===0&&i.push(y)}}for(var o=new Array(r.length),m=[],x=0;x<r.length;++x)if(c[x]){var v=m.length;o[x]=v,m.push(r[x])}else o[x]=-1;for(var l=[],x=0;x<n.length;++x){var w=n[x];c[w[0]]&&c[w[1]]&&l.push([o[w[0]],o[w[1]]])}return[l,m]}},{"edges-to-adjacency-list":66}],268:[function(g,S,M){S.exports=p;var e=g("edges-to-adjacency-list"),a=g("planar-dual"),n=g("point-in-big-polygon"),r=g("two-product"),t=g("robust-sum"),c=g("uniq"),s=g("./lib/trim-leaves");function i(v,f){for(var y=new Array(v),o=0;o<v;++o)y[o]=f;return y}function x(v){for(var f=new Array(v),y=0;y<v;++y)f[y]=[];return f}function p(v,f){var U=s(v,f);v=U[0],f=U[1];var y=f.length;v.length;for(var o=e(v,f.length),m=0;m<y;++m)if(o[m].length%2===1)throw new Error("planar-graph-to-polyline: graph must be manifold");var l=a(v,f);function w(ae){for(var oe=ae.length,be=[0],ce=0;ce<oe;++ce){var de=f[ae[ce]],ye=f[ae[(ce+1)%oe]],ge=r(-de[0],de[1]),me=r(-de[0],ye[1]),Ee=r(ye[0],de[1]),Pe=r(ye[0],ye[1]);be=t(be,t(t(ge,me),t(Ee,Pe)))}return be[be.length-1]>0}l=l.filter(w);for(var _=l.length,h=new Array(_),b=new Array(_),m=0;m<_;++m){h[m]=m;var u=new Array(_),L=l[m].map(function(oe){return f[oe]}),T=n([L]),k=0;e:for(var P=0;P<_;++P)if(u[P]=0,m!==P){for(var z=l[P],I=z.length,D=0;D<I;++D){var R=T(f[z[D]]);if(R!==0){R<0&&(u[P]=1,k+=1);continue e}}u[P]=1,k+=1}b[m]=[k,m,u]}b.sort(function(ae,oe){return oe[0]-ae[0]});for(var m=0;m<_;++m)for(var u=b[m],O=u[1],F=u[2],P=0;P<_;++P)F[P]&&(h[P]=O);for(var N=x(_),m=0;m<_;++m)N[m].push(h[m]),N[h[m]].push(m);for(var G={},K=i(y,!1),m=0;m<_;++m)for(var z=l[m],I=z.length,P=0;P<I;++P){var W=z[P],Y=z[(P+1)%I],re=Math.min(W,Y)+":"+Math.max(W,Y);if(re in G){var ue=G[re];N[ue].push(m),N[m].push(ue),K[W]=K[Y]=!0}else G[re]=m}function j(ae){for(var oe=ae.length,be=0;be<oe;++be)if(!K[ae[be]])return!1;return!0}for(var q=[],V=i(_,-1),m=0;m<_;++m)h[m]===m&&!j(l[m])?(q.push(m),V[m]=0):V[m]=-1;for(var U=[];q.length>0;){var $=q.pop(),ne=N[$];c(ne,function(ae,oe){return ae-oe});var X=ne.length,Q=V[$],ie;if(Q===0){var z=l[$];ie=[z]}for(var m=0;m<X;++m){var se=ne[m];if(!(V[se]>=0)&&(V[se]=Q^1,q.push(se),Q===0)){var z=l[se];j(z)||(z.reverse(),ie.push(z))}}Q===0&&U.push(ie)}return U}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(g,S,M){S.exports=f;var e=g("robust-orientation")[3],a=g("slab-decomposition"),n=g("interval-tree-1d"),r=g("binary-search-bounds");function t(){return!0}function c(y){return function(o,m){var l=y[o];return l?!!l.queryPoint(m,t):!1}}function s(y){for(var o={},m=0;m<y.length;++m){var l=y[m],w=l[0][0],_=l[0][1],h=l[1][1],b=[Math.min(_,h),Math.max(_,h)];w in o?o[w].push(b):o[w]=[b]}for(var u={},L=Object.keys(o),m=0;m<L.length;++m){var T=o[L[m]];u[L[m]]=n(T)}return c(u)}function i(y,o){return function(m){var l=r.le(o,m[0]);if(l<0)return 1;var w=y[l];if(!w)if(l>0&&o[l]===m[0])w=y[l-1];else return 1;for(var _=1;w;){var h=w.key,b=e(m,h[0],h[1]);if(h[0][0]<h[1][0])if(b<0)w=w.left;else if(b>0)_=-1,w=w.right;else return 0;else if(b>0)w=w.left;else if(b<0)_=1,w=w.right;else return 0}return _}}function x(y){return 1}function p(y){return function(m){return y(m[0],m[1])?0:1}}function v(y,o){return function(l){return y(l[0],l[1])?0:o(l)}}function f(y){for(var o=y.length,m=[],l=[],w=0;w<o;++w)for(var _=y[w],h=_.length,b=h-1,u=0;u<h;b=u++){var L=_[b],T=_[u];L[0]===T[0]?l.push([L,T]):m.push([L,T])}if(m.length===0)return l.length===0?x:p(s(l));var k=a(m),P=i(k.slabs,k.coordinates);return l.length===0?P:v(s(l),P)}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(g,S,M){var e=new Float64Array(4),a=new Float64Array(4),n=new Float64Array(4);function r(t,c,s,i,x){e.length<i.length&&(e=new Float64Array(i.length),a=new Float64Array(i.length),n=new Float64Array(i.length));for(var p=0;p<i.length;++p)e[p]=t[p]-i[p],a[p]=c[p]-t[p],n[p]=s[p]-t[p];for(var v=0,f=0,y=0,o=0,m=0,l=0,p=0;p<i.length;++p){var w=a[p],_=n[p],h=e[p];v+=w*w,f+=w*_,y+=_*_,o+=h*w,m+=h*_,l+=h*h}var b=Math.abs(v*y-f*f),u=f*m-y*o,L=f*o-v*m,T;if(u+L<=b)if(u<0)L<0&&o<0?(L=0,-o>=v?(u=1,T=v+2*o+l):(u=-o/v,T=o*u+l)):(u=0,m>=0?(L=0,T=l):-m>=y?(L=1,T=y+2*m+l):(L=-m/y,T=m*L+l));else if(L<0)L=0,o>=0?(u=0,T=l):-o>=v?(u=1,T=v+2*o+l):(u=-o/v,T=o*u+l);else{var k=1/b;u*=k,L*=k,T=u*(v*u+f*L+2*o)+L*(f*u+y*L+2*m)+l}else{var P,z,I,D;u<0?(P=f+o,z=y+m,z>P?(I=z-P,D=v-2*f+y,I>=D?(u=1,L=0,T=v+2*o+l):(u=I/D,L=1-u,T=u*(v*u+f*L+2*o)+L*(f*u+y*L+2*m)+l)):(u=0,z<=0?(L=1,T=y+2*m+l):m>=0?(L=0,T=l):(L=-m/y,T=m*L+l))):L<0?(P=f+m,z=v+o,z>P?(I=z-P,D=v-2*f+y,I>=D?(L=1,u=0,T=y+2*m+l):(L=I/D,u=1-L,T=u*(v*u+f*L+2*o)+L*(f*u+y*L+2*m)+l)):(L=0,z<=0?(u=1,T=v+2*o+l):o>=0?(u=0,T=l):(u=-o/v,T=o*u+l))):(I=y+m-f-o,I<=0?(u=0,L=1,T=y+2*m+l):(D=v-2*f+y,I>=D?(u=1,L=0,T=v+2*o+l):(u=I/D,L=1-u,T=u*(v*u+f*L+2*o)+L*(f*u+y*L+2*m)+l)))}for(var R=1-u-L,p=0;p<i.length;++p)x[p]=R*t[p]+u*c[p]+L*s[p];return T<0?0:T}S.exports=r},{}],271:[function(g,S,M){S.exports=g("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(g,S,M){var e=g("big-rat/add");S.exports=a;function a(n,r){for(var t=n.length,c=new Array(t),s=0;s<t;++s)c[s]=e(n[s],r[s]);return c}},{"big-rat/add":15}],273:[function(g,S,M){S.exports=a;var e=g("big-rat");function a(n){for(var r=new Array(n.length),t=0;t<n.length;++t)r[t]=e(n[t]);return r}},{"big-rat":18}],274:[function(g,S,M){var e=g("big-rat"),a=g("big-rat/mul");S.exports=n;function n(r,t){for(var c=e(t),s=r.length,i=new Array(s),x=0;x<s;++x)i[x]=a(r[x],c);return i}},{"big-rat":18,"big-rat/mul":27}],275:[function(g,S,M){var e=g("big-rat/sub");S.exports=a;function a(n,r){for(var t=n.length,c=new Array(t),s=0;s<t;++s)c[s]=e(n[s],r[s]);return c}},{"big-rat/sub":29}],276:[function(g,S,M){var e=g("compare-cell"),a=g("compare-oriented-cell"),n=g("cell-orientation");S.exports=r;function r(t){t.sort(a);for(var c=t.length,s=0,i=0;i<c;++i){var x=t[i],p=n(x);if(p!==0){if(s>0){var v=t[s-1];if(e(x,v)===0&&n(v)!==p){s-=1;continue}}t[s++]=x}}return t.length=s,t}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(g,S,M){var e="",a;S.exports=n;function n(r,t){if(typeof r!="string")throw new TypeError("expected a string");if(t===1)return r;if(t===2)return r+r;var c=r.length*t;if(a!==r||typeof a>"u")a=r,e="";else if(e.length>=c)return e.substr(0,c);for(;c>e.length&&t>1;)t&1&&(e+=r),t>>=1,r+=r;return e+=r,e=e.substr(0,c),e}},{}],278:[function(g,S,M){(function(e){(function(){S.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,typeof A<"u"?A:typeof self<"u"?self:typeof window<"u"?window:{})},{}],279:[function(g,S,M){S.exports=e;function e(a){for(var n=a.length,r=a[a.length-1],t=n,c=n-2;c>=0;--c){var s=r,i=a[c];r=s+i;var x=r-s,p=i-x;p&&(a[--t]=r,r=p)}for(var v=0,c=t;c<n;++c){var s=a[c],i=r;r=s+i;var x=r-s,p=i-x;p&&(a[v++]=p)}return a[v++]=r,a.length=v,a}},{}],280:[function(g,S,M){var e=g("two-product"),a=g("robust-sum"),n=g("robust-scale"),r=g("robust-compress"),t=6;function c(o,m,l,w){return function(h){return w(o(l(h[0][0],h[1][1]),l(-h[0][1],h[1][0])))}}function s(o,m,l,w){return function(h){return w(o(m(o(l(h[1][1],h[2][2]),l(-h[1][2],h[2][1])),h[0][0]),o(m(o(l(h[1][0],h[2][2]),l(-h[1][2],h[2][0])),-h[0][1]),m(o(l(h[1][0],h[2][1]),l(-h[1][1],h[2][0])),h[0][2]))))}}function i(o,m,l,w){return function(h){return w(o(o(m(o(m(o(l(h[2][2],h[3][3]),l(-h[2][3],h[3][2])),h[1][1]),o(m(o(l(h[2][1],h[3][3]),l(-h[2][3],h[3][1])),-h[1][2]),m(o(l(h[2][1],h[3][2]),l(-h[2][2],h[3][1])),h[1][3]))),h[0][0]),m(o(m(o(l(h[2][2],h[3][3]),l(-h[2][3],h[3][2])),h[1][0]),o(m(o(l(h[2][0],h[3][3]),l(-h[2][3],h[3][0])),-h[1][2]),m(o(l(h[2][0],h[3][2]),l(-h[2][2],h[3][0])),h[1][3]))),-h[0][1])),o(m(o(m(o(l(h[2][1],h[3][3]),l(-h[2][3],h[3][1])),h[1][0]),o(m(o(l(h[2][0],h[3][3]),l(-h[2][3],h[3][0])),-h[1][1]),m(o(l(h[2][0],h[3][1]),l(-h[2][1],h[3][0])),h[1][3]))),h[0][2]),m(o(m(o(l(h[2][1],h[3][2]),l(-h[2][2],h[3][1])),h[1][0]),o(m(o(l(h[2][0],h[3][2]),l(-h[2][2],h[3][0])),-h[1][1]),m(o(l(h[2][0],h[3][1]),l(-h[2][1],h[3][0])),h[1][2]))),-h[0][3]))))}}function x(o,m,l,w){return function(h){return w(o(o(m(o(o(m(o(m(o(l(h[3][3],h[4][4]),l(-h[3][4],h[4][3])),h[2][2]),o(m(o(l(h[3][2],h[4][4]),l(-h[3][4],h[4][2])),-h[2][3]),m(o(l(h[3][2],h[4][3]),l(-h[3][3],h[4][2])),h[2][4]))),h[1][1]),m(o(m(o(l(h[3][3],h[4][4]),l(-h[3][4],h[4][3])),h[2][1]),o(m(o(l(h[3][1],h[4][4]),l(-h[3][4],h[4][1])),-h[2][3]),m(o(l(h[3][1],h[4][3]),l(-h[3][3],h[4][1])),h[2][4]))),-h[1][2])),o(m(o(m(o(l(h[3][2],h[4][4]),l(-h[3][4],h[4][2])),h[2][1]),o(m(o(l(h[3][1],h[4][4]),l(-h[3][4],h[4][1])),-h[2][2]),m(o(l(h[3][1],h[4][2]),l(-h[3][2],h[4][1])),h[2][4]))),h[1][3]),m(o(m(o(l(h[3][2],h[4][3]),l(-h[3][3],h[4][2])),h[2][1]),o(m(o(l(h[3][1],h[4][3]),l(-h[3][3],h[4][1])),-h[2][2]),m(o(l(h[3][1],h[4][2]),l(-h[3][2],h[4][1])),h[2][3]))),-h[1][4]))),h[0][0]),m(o(o(m(o(m(o(l(h[3][3],h[4][4]),l(-h[3][4],h[4][3])),h[2][2]),o(m(o(l(h[3][2],h[4][4]),l(-h[3][4],h[4][2])),-h[2][3]),m(o(l(h[3][2],h[4][3]),l(-h[3][3],h[4][2])),h[2][4]))),h[1][0]),m(o(m(o(l(h[3][3],h[4][4]),l(-h[3][4],h[4][3])),h[2][0]),o(m(o(l(h[3][0],h[4][4]),l(-h[3][4],h[4][0])),-h[2][3]),m(o(l(h[3][0],h[4][3]),l(-h[3][3],h[4][0])),h[2][4]))),-h[1][2])),o(m(o(m(o(l(h[3][2],h[4][4]),l(-h[3][4],h[4][2])),h[2][0]),o(m(o(l(h[3][0],h[4][4]),l(-h[3][4],h[4][0])),-h[2][2]),m(o(l(h[3][0],h[4][2]),l(-h[3][2],h[4][0])),h[2][4]))),h[1][3]),m(o(m(o(l(h[3][2],h[4][3]),l(-h[3][3],h[4][2])),h[2][0]),o(m(o(l(h[3][0],h[4][3]),l(-h[3][3],h[4][0])),-h[2][2]),m(o(l(h[3][0],h[4][2]),l(-h[3][2],h[4][0])),h[2][3]))),-h[1][4]))),-h[0][1])),o(m(o(o(m(o(m(o(l(h[3][3],h[4][4]),l(-h[3][4],h[4][3])),h[2][1]),o(m(o(l(h[3][1],h[4][4]),l(-h[3][4],h[4][1])),-h[2][3]),m(o(l(h[3][1],h[4][3]),l(-h[3][3],h[4][1])),h[2][4]))),h[1][0]),m(o(m(o(l(h[3][3],h[4][4]),l(-h[3][4],h[4][3])),h[2][0]),o(m(o(l(h[3][0],h[4][4]),l(-h[3][4],h[4][0])),-h[2][3]),m(o(l(h[3][0],h[4][3]),l(-h[3][3],h[4][0])),h[2][4]))),-h[1][1])),o(m(o(m(o(l(h[3][1],h[4][4]),l(-h[3][4],h[4][1])),h[2][0]),o(m(o(l(h[3][0],h[4][4]),l(-h[3][4],h[4][0])),-h[2][1]),m(o(l(h[3][0],h[4][1]),l(-h[3][1],h[4][0])),h[2][4]))),h[1][3]),m(o(m(o(l(h[3][1],h[4][3]),l(-h[3][3],h[4][1])),h[2][0]),o(m(o(l(h[3][0],h[4][3]),l(-h[3][3],h[4][0])),-h[2][1]),m(o(l(h[3][0],h[4][1]),l(-h[3][1],h[4][0])),h[2][3]))),-h[1][4]))),h[0][2]),o(m(o(o(m(o(m(o(l(h[3][2],h[4][4]),l(-h[3][4],h[4][2])),h[2][1]),o(m(o(l(h[3][1],h[4][4]),l(-h[3][4],h[4][1])),-h[2][2]),m(o(l(h[3][1],h[4][2]),l(-h[3][2],h[4][1])),h[2][4]))),h[1][0]),m(o(m(o(l(h[3][2],h[4][4]),l(-h[3][4],h[4][2])),h[2][0]),o(m(o(l(h[3][0],h[4][4]),l(-h[3][4],h[4][0])),-h[2][2]),m(o(l(h[3][0],h[4][2]),l(-h[3][2],h[4][0])),h[2][4]))),-h[1][1])),o(m(o(m(o(l(h[3][1],h[4][4]),l(-h[3][4],h[4][1])),h[2][0]),o(m(o(l(h[3][0],h[4][4]),l(-h[3][4],h[4][0])),-h[2][1]),m(o(l(h[3][0],h[4][1]),l(-h[3][1],h[4][0])),h[2][4]))),h[1][2]),m(o(m(o(l(h[3][1],h[4][2]),l(-h[3][2],h[4][1])),h[2][0]),o(m(o(l(h[3][0],h[4][2]),l(-h[3][2],h[4][0])),-h[2][1]),m(o(l(h[3][0],h[4][1]),l(-h[3][1],h[4][0])),h[2][2]))),-h[1][4]))),-h[0][3]),m(o(o(m(o(m(o(l(h[3][2],h[4][3]),l(-h[3][3],h[4][2])),h[2][1]),o(m(o(l(h[3][1],h[4][3]),l(-h[3][3],h[4][1])),-h[2][2]),m(o(l(h[3][1],h[4][2]),l(-h[3][2],h[4][1])),h[2][3]))),h[1][0]),m(o(m(o(l(h[3][2],h[4][3]),l(-h[3][3],h[4][2])),h[2][0]),o(m(o(l(h[3][0],h[4][3]),l(-h[3][3],h[4][0])),-h[2][2]),m(o(l(h[3][0],h[4][2]),l(-h[3][2],h[4][0])),h[2][3]))),-h[1][1])),o(m(o(m(o(l(h[3][1],h[4][3]),l(-h[3][3],h[4][1])),h[2][0]),o(m(o(l(h[3][0],h[4][3]),l(-h[3][3],h[4][0])),-h[2][1]),m(o(l(h[3][0],h[4][1]),l(-h[3][1],h[4][0])),h[2][3]))),h[1][2]),m(o(m(o(l(h[3][1],h[4][2]),l(-h[3][2],h[4][1])),h[2][0]),o(m(o(l(h[3][0],h[4][2]),l(-h[3][2],h[4][0])),-h[2][1]),m(o(l(h[3][0],h[4][1]),l(-h[3][1],h[4][0])),h[2][2]))),-h[1][3]))),h[0][4])))))}}function p(o){var m=o===2?c:o===3?s:o===4?i:o===5?x:void 0;return m(a,n,e,r)}var v=[function(){return[0]},function(m){return[m[0][0]]}];function f(o,m,l,w,_,h,b,u){return function(T){switch(T.length){case 0:return o(T);case 1:return m(T);case 2:return l(T);case 3:return w(T);case 4:return _(T);case 5:return h(T)}var k=b[T.length];return k||(k=b[T.length]=u(T.length)),k(T)}}function y(){for(;v.length<t;)v.push(p(v.length));S.exports=f.apply(void 0,v.concat([v,p]));for(var o=0;o<v.length;++o)S.exports[o]=v[o]}y()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(g,S,M){var e=g("two-product"),a=g("robust-sum");S.exports=n;function n(r,t){for(var c=e(r[0],t[0]),s=1;s<r.length;++s)c=a(c,e(r[s],t[s]));return c}},{"robust-sum":289,"two-product":306}],282:[function(g,S,M){var e=g("two-product"),a=g("robust-sum"),n=g("robust-subtract"),r=g("robust-scale"),t=6;function c(_){var h=_===3?p:_===4?v:_===5?f:y;return h(a,n,e,r)}function s(){return 0}function i(){return 0}function x(){return 0}function p(_,h,b,u){function L(T,k,P){var z=b(T[0],T[0]),I=u(z,k[0]),D=u(z,P[0]),R=b(k[0],k[0]),O=u(R,T[0]),F=u(R,P[0]),N=b(P[0],P[0]),G=u(N,T[0]),K=u(N,k[0]),W=_(h(K,F),h(O,I)),Y=h(G,D),re=h(W,Y);return re[re.length-1]}return L}function v(_,h,b,u){function L(T,k,P,z){var I=_(b(T[0],T[0]),b(T[1],T[1])),D=u(I,k[0]),R=u(I,P[0]),O=u(I,z[0]),F=_(b(k[0],k[0]),b(k[1],k[1])),N=u(F,T[0]),G=u(F,P[0]),K=u(F,z[0]),W=_(b(P[0],P[0]),b(P[1],P[1])),Y=u(W,T[0]),re=u(W,k[0]),ue=u(W,z[0]),j=_(b(z[0],z[0]),b(z[1],z[1])),q=u(j,T[0]),V=u(j,k[0]),U=u(j,P[0]),$=_(_(u(h(U,ue),k[1]),_(u(h(V,K),-P[1]),u(h(re,G),z[1]))),_(u(h(V,K),T[1]),_(u(h(q,O),-k[1]),u(h(N,D),z[1])))),ne=_(_(u(h(U,ue),T[1]),_(u(h(q,O),-P[1]),u(h(Y,R),z[1]))),_(u(h(re,G),T[1]),_(u(h(Y,R),-k[1]),u(h(N,D),P[1])))),X=h($,ne);return X[X.length-1]}return L}function f(_,h,b,u){function L(T,k,P,z,I){var D=_(b(T[0],T[0]),_(b(T[1],T[1]),b(T[2],T[2]))),R=u(D,k[0]),O=u(D,P[0]),F=u(D,z[0]),N=u(D,I[0]),G=_(b(k[0],k[0]),_(b(k[1],k[1]),b(k[2],k[2]))),K=u(G,T[0]),W=u(G,P[0]),Y=u(G,z[0]),re=u(G,I[0]),ue=_(b(P[0],P[0]),_(b(P[1],P[1]),b(P[2],P[2]))),j=u(ue,T[0]),q=u(ue,k[0]),V=u(ue,z[0]),U=u(ue,I[0]),$=_(b(z[0],z[0]),_(b(z[1],z[1]),b(z[2],z[2]))),ne=u($,T[0]),X=u($,k[0]),Q=u($,P[0]),ie=u($,I[0]),se=_(b(I[0],I[0]),_(b(I[1],I[1]),b(I[2],I[2]))),ae=u(se,T[0]),oe=u(se,k[0]),be=u(se,P[0]),ce=u(se,z[0]),de=_(_(_(u(_(u(h(ce,ie),P[1]),_(u(h(be,U),-z[1]),u(h(Q,V),I[1]))),k[2]),_(u(_(u(h(ce,ie),k[1]),_(u(h(oe,re),-z[1]),u(h(X,Y),I[1]))),-P[2]),u(_(u(h(be,U),k[1]),_(u(h(oe,re),-P[1]),u(h(q,W),I[1]))),z[2]))),_(u(_(u(h(Q,V),k[1]),_(u(h(X,Y),-P[1]),u(h(q,W),z[1]))),-I[2]),_(u(_(u(h(ce,ie),k[1]),_(u(h(oe,re),-z[1]),u(h(X,Y),I[1]))),T[2]),u(_(u(h(ce,ie),T[1]),_(u(h(ae,N),-z[1]),u(h(ne,F),I[1]))),-k[2])))),_(_(u(_(u(h(oe,re),T[1]),_(u(h(ae,N),-k[1]),u(h(K,R),I[1]))),z[2]),_(u(_(u(h(X,Y),T[1]),_(u(h(ne,F),-k[1]),u(h(K,R),z[1]))),-I[2]),u(_(u(h(Q,V),k[1]),_(u(h(X,Y),-P[1]),u(h(q,W),z[1]))),T[2]))),_(u(_(u(h(Q,V),T[1]),_(u(h(ne,F),-P[1]),u(h(j,O),z[1]))),-k[2]),_(u(_(u(h(X,Y),T[1]),_(u(h(ne,F),-k[1]),u(h(K,R),z[1]))),P[2]),u(_(u(h(q,W),T[1]),_(u(h(j,O),-k[1]),u(h(K,R),P[1]))),-z[2]))))),ye=_(_(_(u(_(u(h(ce,ie),P[1]),_(u(h(be,U),-z[1]),u(h(Q,V),I[1]))),T[2]),u(_(u(h(ce,ie),T[1]),_(u(h(ae,N),-z[1]),u(h(ne,F),I[1]))),-P[2])),_(u(_(u(h(be,U),T[1]),_(u(h(ae,N),-P[1]),u(h(j,O),I[1]))),z[2]),u(_(u(h(Q,V),T[1]),_(u(h(ne,F),-P[1]),u(h(j,O),z[1]))),-I[2]))),_(_(u(_(u(h(be,U),k[1]),_(u(h(oe,re),-P[1]),u(h(q,W),I[1]))),T[2]),u(_(u(h(be,U),T[1]),_(u(h(ae,N),-P[1]),u(h(j,O),I[1]))),-k[2])),_(u(_(u(h(oe,re),T[1]),_(u(h(ae,N),-k[1]),u(h(K,R),I[1]))),P[2]),u(_(u(h(q,W),T[1]),_(u(h(j,O),-k[1]),u(h(K,R),P[1]))),-I[2])))),ge=h(de,ye);return ge[ge.length-1]}return L}function y(_,h,b,u){function L(T,k,P,z,I,D){var R=_(_(b(T[0],T[0]),b(T[1],T[1])),_(b(T[2],T[2]),b(T[3],T[3]))),O=u(R,k[0]),F=u(R,P[0]),N=u(R,z[0]),G=u(R,I[0]),K=u(R,D[0]),W=_(_(b(k[0],k[0]),b(k[1],k[1])),_(b(k[2],k[2]),b(k[3],k[3]))),Y=u(W,T[0]),re=u(W,P[0]),ue=u(W,z[0]),j=u(W,I[0]),q=u(W,D[0]),V=_(_(b(P[0],P[0]),b(P[1],P[1])),_(b(P[2],P[2]),b(P[3],P[3]))),U=u(V,T[0]),$=u(V,k[0]),ne=u(V,z[0]),X=u(V,I[0]),Q=u(V,D[0]),ie=_(_(b(z[0],z[0]),b(z[1],z[1])),_(b(z[2],z[2]),b(z[3],z[3]))),se=u(ie,T[0]),ae=u(ie,k[0]),oe=u(ie,P[0]),be=u(ie,I[0]),ce=u(ie,D[0]),de=_(_(b(I[0],I[0]),b(I[1],I[1])),_(b(I[2],I[2]),b(I[3],I[3]))),ye=u(de,T[0]),ge=u(de,k[0]),me=u(de,P[0]),Ee=u(de,z[0]),Pe=u(de,D[0]),Ne=_(_(b(D[0],D[0]),b(D[1],D[1])),_(b(D[2],D[2]),b(D[3],D[3]))),we=u(Ne,T[0]),ke=u(Ne,k[0]),Xe=u(Ne,P[0]),He=u(Ne,z[0]),Ie=u(Ne,I[0]),De=_(_(_(u(_(_(u(_(u(h(Ie,Pe),z[1]),_(u(h(He,ce),-I[1]),u(h(Ee,be),D[1]))),P[2]),u(_(u(h(Ie,Pe),P[1]),_(u(h(Xe,Q),-I[1]),u(h(me,X),D[1]))),-z[2])),_(u(_(u(h(He,ce),P[1]),_(u(h(Xe,Q),-z[1]),u(h(oe,ne),D[1]))),I[2]),u(_(u(h(Ee,be),P[1]),_(u(h(me,X),-z[1]),u(h(oe,ne),I[1]))),-D[2]))),k[3]),_(u(_(_(u(_(u(h(Ie,Pe),z[1]),_(u(h(He,ce),-I[1]),u(h(Ee,be),D[1]))),k[2]),u(_(u(h(Ie,Pe),k[1]),_(u(h(ke,q),-I[1]),u(h(ge,j),D[1]))),-z[2])),_(u(_(u(h(He,ce),k[1]),_(u(h(ke,q),-z[1]),u(h(ae,ue),D[1]))),I[2]),u(_(u(h(Ee,be),k[1]),_(u(h(ge,j),-z[1]),u(h(ae,ue),I[1]))),-D[2]))),-P[3]),u(_(_(u(_(u(h(Ie,Pe),P[1]),_(u(h(Xe,Q),-I[1]),u(h(me,X),D[1]))),k[2]),u(_(u(h(Ie,Pe),k[1]),_(u(h(ke,q),-I[1]),u(h(ge,j),D[1]))),-P[2])),_(u(_(u(h(Xe,Q),k[1]),_(u(h(ke,q),-P[1]),u(h($,re),D[1]))),I[2]),u(_(u(h(me,X),k[1]),_(u(h(ge,j),-P[1]),u(h($,re),I[1]))),-D[2]))),z[3]))),_(_(u(_(_(u(_(u(h(He,ce),P[1]),_(u(h(Xe,Q),-z[1]),u(h(oe,ne),D[1]))),k[2]),u(_(u(h(He,ce),k[1]),_(u(h(ke,q),-z[1]),u(h(ae,ue),D[1]))),-P[2])),_(u(_(u(h(Xe,Q),k[1]),_(u(h(ke,q),-P[1]),u(h($,re),D[1]))),z[2]),u(_(u(h(oe,ne),k[1]),_(u(h(ae,ue),-P[1]),u(h($,re),z[1]))),-D[2]))),-I[3]),u(_(_(u(_(u(h(Ee,be),P[1]),_(u(h(me,X),-z[1]),u(h(oe,ne),I[1]))),k[2]),u(_(u(h(Ee,be),k[1]),_(u(h(ge,j),-z[1]),u(h(ae,ue),I[1]))),-P[2])),_(u(_(u(h(me,X),k[1]),_(u(h(ge,j),-P[1]),u(h($,re),I[1]))),z[2]),u(_(u(h(oe,ne),k[1]),_(u(h(ae,ue),-P[1]),u(h($,re),z[1]))),-I[2]))),D[3])),_(u(_(_(u(_(u(h(Ie,Pe),z[1]),_(u(h(He,ce),-I[1]),u(h(Ee,be),D[1]))),k[2]),u(_(u(h(Ie,Pe),k[1]),_(u(h(ke,q),-I[1]),u(h(ge,j),D[1]))),-z[2])),_(u(_(u(h(He,ce),k[1]),_(u(h(ke,q),-z[1]),u(h(ae,ue),D[1]))),I[2]),u(_(u(h(Ee,be),k[1]),_(u(h(ge,j),-z[1]),u(h(ae,ue),I[1]))),-D[2]))),T[3]),u(_(_(u(_(u(h(Ie,Pe),z[1]),_(u(h(He,ce),-I[1]),u(h(Ee,be),D[1]))),T[2]),u(_(u(h(Ie,Pe),T[1]),_(u(h(we,K),-I[1]),u(h(ye,G),D[1]))),-z[2])),_(u(_(u(h(He,ce),T[1]),_(u(h(we,K),-z[1]),u(h(se,N),D[1]))),I[2]),u(_(u(h(Ee,be),T[1]),_(u(h(ye,G),-z[1]),u(h(se,N),I[1]))),-D[2]))),-k[3])))),_(_(_(u(_(_(u(_(u(h(Ie,Pe),k[1]),_(u(h(ke,q),-I[1]),u(h(ge,j),D[1]))),T[2]),u(_(u(h(Ie,Pe),T[1]),_(u(h(we,K),-I[1]),u(h(ye,G),D[1]))),-k[2])),_(u(_(u(h(ke,q),T[1]),_(u(h(we,K),-k[1]),u(h(Y,O),D[1]))),I[2]),u(_(u(h(ge,j),T[1]),_(u(h(ye,G),-k[1]),u(h(Y,O),I[1]))),-D[2]))),z[3]),u(_(_(u(_(u(h(He,ce),k[1]),_(u(h(ke,q),-z[1]),u(h(ae,ue),D[1]))),T[2]),u(_(u(h(He,ce),T[1]),_(u(h(we,K),-z[1]),u(h(se,N),D[1]))),-k[2])),_(u(_(u(h(ke,q),T[1]),_(u(h(we,K),-k[1]),u(h(Y,O),D[1]))),z[2]),u(_(u(h(ae,ue),T[1]),_(u(h(se,N),-k[1]),u(h(Y,O),z[1]))),-D[2]))),-I[3])),_(u(_(_(u(_(u(h(Ee,be),k[1]),_(u(h(ge,j),-z[1]),u(h(ae,ue),I[1]))),T[2]),u(_(u(h(Ee,be),T[1]),_(u(h(ye,G),-z[1]),u(h(se,N),I[1]))),-k[2])),_(u(_(u(h(ge,j),T[1]),_(u(h(ye,G),-k[1]),u(h(Y,O),I[1]))),z[2]),u(_(u(h(ae,ue),T[1]),_(u(h(se,N),-k[1]),u(h(Y,O),z[1]))),-I[2]))),D[3]),u(_(_(u(_(u(h(He,ce),P[1]),_(u(h(Xe,Q),-z[1]),u(h(oe,ne),D[1]))),k[2]),u(_(u(h(He,ce),k[1]),_(u(h(ke,q),-z[1]),u(h(ae,ue),D[1]))),-P[2])),_(u(_(u(h(Xe,Q),k[1]),_(u(h(ke,q),-P[1]),u(h($,re),D[1]))),z[2]),u(_(u(h(oe,ne),k[1]),_(u(h(ae,ue),-P[1]),u(h($,re),z[1]))),-D[2]))),T[3]))),_(_(u(_(_(u(_(u(h(He,ce),P[1]),_(u(h(Xe,Q),-z[1]),u(h(oe,ne),D[1]))),T[2]),u(_(u(h(He,ce),T[1]),_(u(h(we,K),-z[1]),u(h(se,N),D[1]))),-P[2])),_(u(_(u(h(Xe,Q),T[1]),_(u(h(we,K),-P[1]),u(h(U,F),D[1]))),z[2]),u(_(u(h(oe,ne),T[1]),_(u(h(se,N),-P[1]),u(h(U,F),z[1]))),-D[2]))),-k[3]),u(_(_(u(_(u(h(He,ce),k[1]),_(u(h(ke,q),-z[1]),u(h(ae,ue),D[1]))),T[2]),u(_(u(h(He,ce),T[1]),_(u(h(we,K),-z[1]),u(h(se,N),D[1]))),-k[2])),_(u(_(u(h(ke,q),T[1]),_(u(h(we,K),-k[1]),u(h(Y,O),D[1]))),z[2]),u(_(u(h(ae,ue),T[1]),_(u(h(se,N),-k[1]),u(h(Y,O),z[1]))),-D[2]))),P[3])),_(u(_(_(u(_(u(h(Xe,Q),k[1]),_(u(h(ke,q),-P[1]),u(h($,re),D[1]))),T[2]),u(_(u(h(Xe,Q),T[1]),_(u(h(we,K),-P[1]),u(h(U,F),D[1]))),-k[2])),_(u(_(u(h(ke,q),T[1]),_(u(h(we,K),-k[1]),u(h(Y,O),D[1]))),P[2]),u(_(u(h($,re),T[1]),_(u(h(U,F),-k[1]),u(h(Y,O),P[1]))),-D[2]))),-z[3]),u(_(_(u(_(u(h(oe,ne),k[1]),_(u(h(ae,ue),-P[1]),u(h($,re),z[1]))),T[2]),u(_(u(h(oe,ne),T[1]),_(u(h(se,N),-P[1]),u(h(U,F),z[1]))),-k[2])),_(u(_(u(h(ae,ue),T[1]),_(u(h(se,N),-k[1]),u(h(Y,O),z[1]))),P[2]),u(_(u(h($,re),T[1]),_(u(h(U,F),-k[1]),u(h(Y,O),P[1]))),-z[2]))),D[3]))))),Ge=_(_(_(u(_(_(u(_(u(h(Ie,Pe),z[1]),_(u(h(He,ce),-I[1]),u(h(Ee,be),D[1]))),P[2]),u(_(u(h(Ie,Pe),P[1]),_(u(h(Xe,Q),-I[1]),u(h(me,X),D[1]))),-z[2])),_(u(_(u(h(He,ce),P[1]),_(u(h(Xe,Q),-z[1]),u(h(oe,ne),D[1]))),I[2]),u(_(u(h(Ee,be),P[1]),_(u(h(me,X),-z[1]),u(h(oe,ne),I[1]))),-D[2]))),T[3]),_(u(_(_(u(_(u(h(Ie,Pe),z[1]),_(u(h(He,ce),-I[1]),u(h(Ee,be),D[1]))),T[2]),u(_(u(h(Ie,Pe),T[1]),_(u(h(we,K),-I[1]),u(h(ye,G),D[1]))),-z[2])),_(u(_(u(h(He,ce),T[1]),_(u(h(we,K),-z[1]),u(h(se,N),D[1]))),I[2]),u(_(u(h(Ee,be),T[1]),_(u(h(ye,G),-z[1]),u(h(se,N),I[1]))),-D[2]))),-P[3]),u(_(_(u(_(u(h(Ie,Pe),P[1]),_(u(h(Xe,Q),-I[1]),u(h(me,X),D[1]))),T[2]),u(_(u(h(Ie,Pe),T[1]),_(u(h(we,K),-I[1]),u(h(ye,G),D[1]))),-P[2])),_(u(_(u(h(Xe,Q),T[1]),_(u(h(we,K),-P[1]),u(h(U,F),D[1]))),I[2]),u(_(u(h(me,X),T[1]),_(u(h(ye,G),-P[1]),u(h(U,F),I[1]))),-D[2]))),z[3]))),_(_(u(_(_(u(_(u(h(He,ce),P[1]),_(u(h(Xe,Q),-z[1]),u(h(oe,ne),D[1]))),T[2]),u(_(u(h(He,ce),T[1]),_(u(h(we,K),-z[1]),u(h(se,N),D[1]))),-P[2])),_(u(_(u(h(Xe,Q),T[1]),_(u(h(we,K),-P[1]),u(h(U,F),D[1]))),z[2]),u(_(u(h(oe,ne),T[1]),_(u(h(se,N),-P[1]),u(h(U,F),z[1]))),-D[2]))),-I[3]),u(_(_(u(_(u(h(Ee,be),P[1]),_(u(h(me,X),-z[1]),u(h(oe,ne),I[1]))),T[2]),u(_(u(h(Ee,be),T[1]),_(u(h(ye,G),-z[1]),u(h(se,N),I[1]))),-P[2])),_(u(_(u(h(me,X),T[1]),_(u(h(ye,G),-P[1]),u(h(U,F),I[1]))),z[2]),u(_(u(h(oe,ne),T[1]),_(u(h(se,N),-P[1]),u(h(U,F),z[1]))),-I[2]))),D[3])),_(u(_(_(u(_(u(h(Ie,Pe),P[1]),_(u(h(Xe,Q),-I[1]),u(h(me,X),D[1]))),k[2]),u(_(u(h(Ie,Pe),k[1]),_(u(h(ke,q),-I[1]),u(h(ge,j),D[1]))),-P[2])),_(u(_(u(h(Xe,Q),k[1]),_(u(h(ke,q),-P[1]),u(h($,re),D[1]))),I[2]),u(_(u(h(me,X),k[1]),_(u(h(ge,j),-P[1]),u(h($,re),I[1]))),-D[2]))),T[3]),u(_(_(u(_(u(h(Ie,Pe),P[1]),_(u(h(Xe,Q),-I[1]),u(h(me,X),D[1]))),T[2]),u(_(u(h(Ie,Pe),T[1]),_(u(h(we,K),-I[1]),u(h(ye,G),D[1]))),-P[2])),_(u(_(u(h(Xe,Q),T[1]),_(u(h(we,K),-P[1]),u(h(U,F),D[1]))),I[2]),u(_(u(h(me,X),T[1]),_(u(h(ye,G),-P[1]),u(h(U,F),I[1]))),-D[2]))),-k[3])))),_(_(_(u(_(_(u(_(u(h(Ie,Pe),k[1]),_(u(h(ke,q),-I[1]),u(h(ge,j),D[1]))),T[2]),u(_(u(h(Ie,Pe),T[1]),_(u(h(we,K),-I[1]),u(h(ye,G),D[1]))),-k[2])),_(u(_(u(h(ke,q),T[1]),_(u(h(we,K),-k[1]),u(h(Y,O),D[1]))),I[2]),u(_(u(h(ge,j),T[1]),_(u(h(ye,G),-k[1]),u(h(Y,O),I[1]))),-D[2]))),P[3]),u(_(_(u(_(u(h(Xe,Q),k[1]),_(u(h(ke,q),-P[1]),u(h($,re),D[1]))),T[2]),u(_(u(h(Xe,Q),T[1]),_(u(h(we,K),-P[1]),u(h(U,F),D[1]))),-k[2])),_(u(_(u(h(ke,q),T[1]),_(u(h(we,K),-k[1]),u(h(Y,O),D[1]))),P[2]),u(_(u(h($,re),T[1]),_(u(h(U,F),-k[1]),u(h(Y,O),P[1]))),-D[2]))),-I[3])),_(u(_(_(u(_(u(h(me,X),k[1]),_(u(h(ge,j),-P[1]),u(h($,re),I[1]))),T[2]),u(_(u(h(me,X),T[1]),_(u(h(ye,G),-P[1]),u(h(U,F),I[1]))),-k[2])),_(u(_(u(h(ge,j),T[1]),_(u(h(ye,G),-k[1]),u(h(Y,O),I[1]))),P[2]),u(_(u(h($,re),T[1]),_(u(h(U,F),-k[1]),u(h(Y,O),P[1]))),-I[2]))),D[3]),u(_(_(u(_(u(h(Ee,be),P[1]),_(u(h(me,X),-z[1]),u(h(oe,ne),I[1]))),k[2]),u(_(u(h(Ee,be),k[1]),_(u(h(ge,j),-z[1]),u(h(ae,ue),I[1]))),-P[2])),_(u(_(u(h(me,X),k[1]),_(u(h(ge,j),-P[1]),u(h($,re),I[1]))),z[2]),u(_(u(h(oe,ne),k[1]),_(u(h(ae,ue),-P[1]),u(h($,re),z[1]))),-I[2]))),T[3]))),_(_(u(_(_(u(_(u(h(Ee,be),P[1]),_(u(h(me,X),-z[1]),u(h(oe,ne),I[1]))),T[2]),u(_(u(h(Ee,be),T[1]),_(u(h(ye,G),-z[1]),u(h(se,N),I[1]))),-P[2])),_(u(_(u(h(me,X),T[1]),_(u(h(ye,G),-P[1]),u(h(U,F),I[1]))),z[2]),u(_(u(h(oe,ne),T[1]),_(u(h(se,N),-P[1]),u(h(U,F),z[1]))),-I[2]))),-k[3]),u(_(_(u(_(u(h(Ee,be),k[1]),_(u(h(ge,j),-z[1]),u(h(ae,ue),I[1]))),T[2]),u(_(u(h(Ee,be),T[1]),_(u(h(ye,G),-z[1]),u(h(se,N),I[1]))),-k[2])),_(u(_(u(h(ge,j),T[1]),_(u(h(ye,G),-k[1]),u(h(Y,O),I[1]))),z[2]),u(_(u(h(ae,ue),T[1]),_(u(h(se,N),-k[1]),u(h(Y,O),z[1]))),-I[2]))),P[3])),_(u(_(_(u(_(u(h(me,X),k[1]),_(u(h(ge,j),-P[1]),u(h($,re),I[1]))),T[2]),u(_(u(h(me,X),T[1]),_(u(h(ye,G),-P[1]),u(h(U,F),I[1]))),-k[2])),_(u(_(u(h(ge,j),T[1]),_(u(h(ye,G),-k[1]),u(h(Y,O),I[1]))),P[2]),u(_(u(h($,re),T[1]),_(u(h(U,F),-k[1]),u(h(Y,O),P[1]))),-I[2]))),-z[3]),u(_(_(u(_(u(h(oe,ne),k[1]),_(u(h(ae,ue),-P[1]),u(h($,re),z[1]))),T[2]),u(_(u(h(oe,ne),T[1]),_(u(h(se,N),-P[1]),u(h(U,F),z[1]))),-k[2])),_(u(_(u(h(ae,ue),T[1]),_(u(h(se,N),-k[1]),u(h(Y,O),z[1]))),P[2]),u(_(u(h($,re),T[1]),_(u(h(U,F),-k[1]),u(h(Y,O),P[1]))),-z[2]))),I[3]))))),ht=h(De,Ge);return ht[ht.length-1]}return L}var o=[s,i,x];function m(_){var h=o[_.length];return h||(h=o[_.length]=c(_.length)),h.apply(void 0,_)}function l(_,h,b,u,L,T,k,P){function z(I,D,R,O,F,N){switch(arguments.length){case 0:case 1:return 0;case 2:return u(I,D);case 3:return L(I,D,R);case 4:return T(I,D,R,O);case 5:return k(I,D,R,O,F);case 6:return P(I,D,R,O,F,N)}for(var G=new Array(arguments.length),K=0;K<arguments.length;++K)G[K]=arguments[K];return _(G)}return z}function w(){for(;o.length<=t;)o.push(c(o.length));S.exports=l.apply(void 0,[m].concat(o));for(var _=0;_<=t;++_)S.exports[_]=o[_]}w()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(g,S,M){var e=g("robust-determinant"),a=6;function n(o){var m=o===2?c:o===3?s:o===4?i:o===5?x:p;return o<6?m(e[o]):m(e)}function r(){return[[0]]}function t(o,m){return[[m[0]],[o[0][0]]]}function c(o){return function(l,w){return[o([[+w[0],+l[0][1]],[+w[1],+l[1][1]]]),o([[+l[0][0],+w[0]],[+l[1][0],+w[1]]]),o(l)]}}function s(o){return function(l,w){return[o([[+w[0],+l[0][1],+l[0][2]],[+w[1],+l[1][1],+l[1][2]],[+w[2],+l[2][1],+l[2][2]]]),o([[+l[0][0],+w[0],+l[0][2]],[+l[1][0],+w[1],+l[1][2]],[+l[2][0],+w[2],+l[2][2]]]),o([[+l[0][0],+l[0][1],+w[0]],[+l[1][0],+l[1][1],+w[1]],[+l[2][0],+l[2][1],+w[2]]]),o(l)]}}function i(o){return function(l,w){return[o([[+w[0],+l[0][1],+l[0][2],+l[0][3]],[+w[1],+l[1][1],+l[1][2],+l[1][3]],[+w[2],+l[2][1],+l[2][2],+l[2][3]],[+w[3],+l[3][1],+l[3][2],+l[3][3]]]),o([[+l[0][0],+w[0],+l[0][2],+l[0][3]],[+l[1][0],+w[1],+l[1][2],+l[1][3]],[+l[2][0],+w[2],+l[2][2],+l[2][3]],[+l[3][0],+w[3],+l[3][2],+l[3][3]]]),o([[+l[0][0],+l[0][1],+w[0],+l[0][3]],[+l[1][0],+l[1][1],+w[1],+l[1][3]],[+l[2][0],+l[2][1],+w[2],+l[2][3]],[+l[3][0],+l[3][1],+w[3],+l[3][3]]]),o([[+l[0][0],+l[0][1],+l[0][2],+w[0]],[+l[1][0],+l[1][1],+l[1][2],+w[1]],[+l[2][0],+l[2][1],+l[2][2],+w[2]],[+l[3][0],+l[3][1],+l[3][2],+w[3]]]),o(l)]}}function x(o){return function(l,w){return[o([[+w[0],+l[0][1],+l[0][2],+l[0][3],+l[0][4]],[+w[1],+l[1][1],+l[1][2],+l[1][3],+l[1][4]],[+w[2],+l[2][1],+l[2][2],+l[2][3],+l[2][4]],[+w[3],+l[3][1],+l[3][2],+l[3][3],+l[3][4]],[+w[4],+l[4][1],+l[4][2],+l[4][3],+l[4][4]]]),o([[+l[0][0],+w[0],+l[0][2],+l[0][3],+l[0][4]],[+l[1][0],+w[1],+l[1][2],+l[1][3],+l[1][4]],[+l[2][0],+w[2],+l[2][2],+l[2][3],+l[2][4]],[+l[3][0],+w[3],+l[3][2],+l[3][3],+l[3][4]],[+l[4][0],+w[4],+l[4][2],+l[4][3],+l[4][4]]]),o([[+l[0][0],+l[0][1],+w[0],+l[0][3],+l[0][4]],[+l[1][0],+l[1][1],+w[1],+l[1][3],+l[1][4]],[+l[2][0],+l[2][1],+w[2],+l[2][3],+l[2][4]],[+l[3][0],+l[3][1],+w[3],+l[3][3],+l[3][4]],[+l[4][0],+l[4][1],+w[4],+l[4][3],+l[4][4]]]),o([[+l[0][0],+l[0][1],+l[0][2],+w[0],+l[0][4]],[+l[1][0],+l[1][1],+l[1][2],+w[1],+l[1][4]],[+l[2][0],+l[2][1],+l[2][2],+w[2],+l[2][4]],[+l[3][0],+l[3][1],+l[3][2],+w[3],+l[3][4]],[+l[4][0],+l[4][1],+l[4][2],+w[4],+l[4][4]]]),o([[+l[0][0],+l[0][1],+l[0][2],+l[0][3],+w[0]],[+l[1][0],+l[1][1],+l[1][2],+l[1][3],+w[1]],[+l[2][0],+l[2][1],+l[2][2],+l[2][3],+w[2]],[+l[3][0],+l[3][1],+l[3][2],+l[3][3],+w[3]],[+l[4][0],+l[4][1],+l[4][2],+l[4][3],+w[4]]]),o(l)]}}function p(o){return function(l,w){return[o([[+w[0],+l[0][1],+l[0][2],+l[0][3],+l[0][4],+l[0][5]],[+w[1],+l[1][1],+l[1][2],+l[1][3],+l[1][4],+l[1][5]],[+w[2],+l[2][1],+l[2][2],+l[2][3],+l[2][4],+l[2][5]],[+w[3],+l[3][1],+l[3][2],+l[3][3],+l[3][4],+l[3][5]],[+w[4],+l[4][1],+l[4][2],+l[4][3],+l[4][4],+l[4][5]],[+w[5],+l[5][1],+l[5][2],+l[5][3],+l[5][4],+l[5][5]]]),o([[+l[0][0],+w[0],+l[0][2],+l[0][3],+l[0][4],+l[0][5]],[+l[1][0],+w[1],+l[1][2],+l[1][3],+l[1][4],+l[1][5]],[+l[2][0],+w[2],+l[2][2],+l[2][3],+l[2][4],+l[2][5]],[+l[3][0],+w[3],+l[3][2],+l[3][3],+l[3][4],+l[3][5]],[+l[4][0],+w[4],+l[4][2],+l[4][3],+l[4][4],+l[4][5]],[+l[5][0],+w[5],+l[5][2],+l[5][3],+l[5][4],+l[5][5]]]),o([[+l[0][0],+l[0][1],+w[0],+l[0][3],+l[0][4],+l[0][5]],[+l[1][0],+l[1][1],+w[1],+l[1][3],+l[1][4],+l[1][5]],[+l[2][0],+l[2][1],+w[2],+l[2][3],+l[2][4],+l[2][5]],[+l[3][0],+l[3][1],+w[3],+l[3][3],+l[3][4],+l[3][5]],[+l[4][0],+l[4][1],+w[4],+l[4][3],+l[4][4],+l[4][5]],[+l[5][0],+l[5][1],+w[5],+l[5][3],+l[5][4],+l[5][5]]]),o([[+l[0][0],+l[0][1],+l[0][2],+w[0],+l[0][4],+l[0][5]],[+l[1][0],+l[1][1],+l[1][2],+w[1],+l[1][4],+l[1][5]],[+l[2][0],+l[2][1],+l[2][2],+w[2],+l[2][4],+l[2][5]],[+l[3][0],+l[3][1],+l[3][2],+w[3],+l[3][4],+l[3][5]],[+l[4][0],+l[4][1],+l[4][2],+w[4],+l[4][4],+l[4][5]],[+l[5][0],+l[5][1],+l[5][2],+w[5],+l[5][4],+l[5][5]]]),o([[+l[0][0],+l[0][1],+l[0][2],+l[0][3],+w[0],+l[0][5]],[+l[1][0],+l[1][1],+l[1][2],+l[1][3],+w[1],+l[1][5]],[+l[2][0],+l[2][1],+l[2][2],+l[2][3],+w[2],+l[2][5]],[+l[3][0],+l[3][1],+l[3][2],+l[3][3],+w[3],+l[3][5]],[+l[4][0],+l[4][1],+l[4][2],+l[4][3],+w[4],+l[4][5]],[+l[5][0],+l[5][1],+l[5][2],+l[5][3],+w[5],+l[5][5]]]),o([[+l[0][0],+l[0][1],+l[0][2],+l[0][3],+l[0][4],+w[0]],[+l[1][0],+l[1][1],+l[1][2],+l[1][3],+l[1][4],+w[1]],[+l[2][0],+l[2][1],+l[2][2],+l[2][3],+l[2][4],+w[2]],[+l[3][0],+l[3][1],+l[3][2],+l[3][3],+l[3][4],+w[3]],[+l[4][0],+l[4][1],+l[4][2],+l[4][3],+l[4][4],+w[4]],[+l[5][0],+l[5][1],+l[5][2],+l[5][3],+l[5][4],+w[5]]]),o(l)]}}var v=[r,t];function f(o,m,l,w,_,h,b,u){return function(T,k){switch(T.length){case 0:return o(T,k);case 1:return m(T,k);case 2:return l(T,k);case 3:return w(T,k);case 4:return _(T,k);case 5:return h(T,k)}var P=b[T.length];return P||(P=b[T.length]=u(T.length)),P(T,k)}}function y(){for(;v.length<a;)v.push(n(v.length));S.exports=f.apply(void 0,v.concat([v,n]));for(var o=0;o<a;++o)S.exports[o]=v[o]}y()},{"robust-determinant":280}],284:[function(g,S,M){var e=g("two-product"),a=g("robust-sum"),n=g("robust-scale"),r=g("robust-subtract"),t=5,c=11102230246251565e-32,s=(3+16*c)*c,i=(7+56*c)*c;function x(h,b,u,L){return function(k,P,z){var I=h(h(b(P[1],z[0]),b(-z[1],P[0])),h(b(k[1],P[0]),b(-P[1],k[0]))),D=h(b(k[1],z[0]),b(-z[1],k[0])),R=L(I,D);return R[R.length-1]}}function p(h,b,u,L){return function(k,P,z,I){var D=h(h(u(h(b(z[1],I[0]),b(-I[1],z[0])),P[2]),h(u(h(b(P[1],I[0]),b(-I[1],P[0])),-z[2]),u(h(b(P[1],z[0]),b(-z[1],P[0])),I[2]))),h(u(h(b(P[1],I[0]),b(-I[1],P[0])),k[2]),h(u(h(b(k[1],I[0]),b(-I[1],k[0])),-P[2]),u(h(b(k[1],P[0]),b(-P[1],k[0])),I[2])))),R=h(h(u(h(b(z[1],I[0]),b(-I[1],z[0])),k[2]),h(u(h(b(k[1],I[0]),b(-I[1],k[0])),-z[2]),u(h(b(k[1],z[0]),b(-z[1],k[0])),I[2]))),h(u(h(b(P[1],z[0]),b(-z[1],P[0])),k[2]),h(u(h(b(k[1],z[0]),b(-z[1],k[0])),-P[2]),u(h(b(k[1],P[0]),b(-P[1],k[0])),z[2])))),O=L(D,R);return O[O.length-1]}}function v(h,b,u,L){return function(k,P,z,I,D){var R=h(h(h(u(h(u(h(b(I[1],D[0]),b(-D[1],I[0])),z[2]),h(u(h(b(z[1],D[0]),b(-D[1],z[0])),-I[2]),u(h(b(z[1],I[0]),b(-I[1],z[0])),D[2]))),P[3]),h(u(h(u(h(b(I[1],D[0]),b(-D[1],I[0])),P[2]),h(u(h(b(P[1],D[0]),b(-D[1],P[0])),-I[2]),u(h(b(P[1],I[0]),b(-I[1],P[0])),D[2]))),-z[3]),u(h(u(h(b(z[1],D[0]),b(-D[1],z[0])),P[2]),h(u(h(b(P[1],D[0]),b(-D[1],P[0])),-z[2]),u(h(b(P[1],z[0]),b(-z[1],P[0])),D[2]))),I[3]))),h(u(h(u(h(b(z[1],I[0]),b(-I[1],z[0])),P[2]),h(u(h(b(P[1],I[0]),b(-I[1],P[0])),-z[2]),u(h(b(P[1],z[0]),b(-z[1],P[0])),I[2]))),-D[3]),h(u(h(u(h(b(I[1],D[0]),b(-D[1],I[0])),P[2]),h(u(h(b(P[1],D[0]),b(-D[1],P[0])),-I[2]),u(h(b(P[1],I[0]),b(-I[1],P[0])),D[2]))),k[3]),u(h(u(h(b(I[1],D[0]),b(-D[1],I[0])),k[2]),h(u(h(b(k[1],D[0]),b(-D[1],k[0])),-I[2]),u(h(b(k[1],I[0]),b(-I[1],k[0])),D[2]))),-P[3])))),h(h(u(h(u(h(b(P[1],D[0]),b(-D[1],P[0])),k[2]),h(u(h(b(k[1],D[0]),b(-D[1],k[0])),-P[2]),u(h(b(k[1],P[0]),b(-P[1],k[0])),D[2]))),I[3]),h(u(h(u(h(b(P[1],I[0]),b(-I[1],P[0])),k[2]),h(u(h(b(k[1],I[0]),b(-I[1],k[0])),-P[2]),u(h(b(k[1],P[0]),b(-P[1],k[0])),I[2]))),-D[3]),u(h(u(h(b(z[1],I[0]),b(-I[1],z[0])),P[2]),h(u(h(b(P[1],I[0]),b(-I[1],P[0])),-z[2]),u(h(b(P[1],z[0]),b(-z[1],P[0])),I[2]))),k[3]))),h(u(h(u(h(b(z[1],I[0]),b(-I[1],z[0])),k[2]),h(u(h(b(k[1],I[0]),b(-I[1],k[0])),-z[2]),u(h(b(k[1],z[0]),b(-z[1],k[0])),I[2]))),-P[3]),h(u(h(u(h(b(P[1],I[0]),b(-I[1],P[0])),k[2]),h(u(h(b(k[1],I[0]),b(-I[1],k[0])),-P[2]),u(h(b(k[1],P[0]),b(-P[1],k[0])),I[2]))),z[3]),u(h(u(h(b(P[1],z[0]),b(-z[1],P[0])),k[2]),h(u(h(b(k[1],z[0]),b(-z[1],k[0])),-P[2]),u(h(b(k[1],P[0]),b(-P[1],k[0])),z[2]))),-I[3]))))),O=h(h(h(u(h(u(h(b(I[1],D[0]),b(-D[1],I[0])),z[2]),h(u(h(b(z[1],D[0]),b(-D[1],z[0])),-I[2]),u(h(b(z[1],I[0]),b(-I[1],z[0])),D[2]))),k[3]),u(h(u(h(b(I[1],D[0]),b(-D[1],I[0])),k[2]),h(u(h(b(k[1],D[0]),b(-D[1],k[0])),-I[2]),u(h(b(k[1],I[0]),b(-I[1],k[0])),D[2]))),-z[3])),h(u(h(u(h(b(z[1],D[0]),b(-D[1],z[0])),k[2]),h(u(h(b(k[1],D[0]),b(-D[1],k[0])),-z[2]),u(h(b(k[1],z[0]),b(-z[1],k[0])),D[2]))),I[3]),u(h(u(h(b(z[1],I[0]),b(-I[1],z[0])),k[2]),h(u(h(b(k[1],I[0]),b(-I[1],k[0])),-z[2]),u(h(b(k[1],z[0]),b(-z[1],k[0])),I[2]))),-D[3]))),h(h(u(h(u(h(b(z[1],D[0]),b(-D[1],z[0])),P[2]),h(u(h(b(P[1],D[0]),b(-D[1],P[0])),-z[2]),u(h(b(P[1],z[0]),b(-z[1],P[0])),D[2]))),k[3]),u(h(u(h(b(z[1],D[0]),b(-D[1],z[0])),k[2]),h(u(h(b(k[1],D[0]),b(-D[1],k[0])),-z[2]),u(h(b(k[1],z[0]),b(-z[1],k[0])),D[2]))),-P[3])),h(u(h(u(h(b(P[1],D[0]),b(-D[1],P[0])),k[2]),h(u(h(b(k[1],D[0]),b(-D[1],k[0])),-P[2]),u(h(b(k[1],P[0]),b(-P[1],k[0])),D[2]))),z[3]),u(h(u(h(b(P[1],z[0]),b(-z[1],P[0])),k[2]),h(u(h(b(k[1],z[0]),b(-z[1],k[0])),-P[2]),u(h(b(k[1],P[0]),b(-P[1],k[0])),z[2]))),-D[3])))),F=L(R,O);return F[F.length-1]}}function f(h){var b=h===3?x:h===4?p:v;return b(a,e,n,r)}var y=f(3),o=f(4),m=[function(){return 0},function(){return 0},function(b,u){return u[0]-b[0]},function(b,u,L){var T=(b[1]-L[1])*(u[0]-L[0]),k=(b[0]-L[0])*(u[1]-L[1]),P=T-k,z;if(T>0){if(k<=0)return P;z=T+k}else if(T<0){if(k>=0)return P;z=-(T+k)}else return P;var I=s*z;return P>=I||P<=-I?P:y(b,u,L)},function(b,u,L,T){var k=b[0]-T[0],P=u[0]-T[0],z=L[0]-T[0],I=b[1]-T[1],D=u[1]-T[1],R=L[1]-T[1],O=b[2]-T[2],F=u[2]-T[2],N=L[2]-T[2],G=P*R,K=z*D,W=z*I,Y=k*R,re=k*D,ue=P*I,j=O*(G-K)+F*(W-Y)+N*(re-ue),q=(Math.abs(G)+Math.abs(K))*Math.abs(O)+(Math.abs(W)+Math.abs(Y))*Math.abs(F)+(Math.abs(re)+Math.abs(ue))*Math.abs(N),V=i*q;return j>V||-j>V?j:o(b,u,L,T)}];function l(h){var b=m[h.length];return b||(b=m[h.length]=f(h.length)),b.apply(void 0,h)}function w(h,b,u,L,T,k,P){return function(I,D,R,O,F){switch(arguments.length){case 0:case 1:return 0;case 2:return L(I,D);case 3:return T(I,D,R);case 4:return k(I,D,R,O);case 5:return P(I,D,R,O,F)}for(var N=new Array(arguments.length),G=0;G<arguments.length;++G)N[G]=arguments[G];return h(N)}}function _(){for(;m.length<=t;)m.push(f(m.length));S.exports=w.apply(void 0,[l].concat(m));for(var h=0;h<=t;++h)S.exports[h]=m[h]}_()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(g,S,M){var e=g("robust-sum"),a=g("robust-scale");S.exports=n;function n(r,t){if(r.length===1)return a(t,r[0]);if(t.length===1)return a(r,t[0]);if(r.length===0||t.length===0)return[0];var c=[0];if(r.length<t.length)for(var s=0;s<r.length;++s)c=e(c,a(t,r[s]));else for(var s=0;s<t.length;++s)c=e(c,a(r,t[s]));return c}},{"robust-scale":286,"robust-sum":289}],286:[function(g,S,M){var e=g("two-product"),a=g("two-sum");S.exports=n;function n(r,t){var c=r.length;if(c===1){var s=e(r[0],t);return s[0]?s:[s[1]]}var i=new Array(2*c),x=[.1,.1],p=[.1,.1],v=0;e(r[0],t,x),x[0]&&(i[v++]=x[0]);for(var f=1;f<c;++f){e(r[f],t,p);var y=x[1];a(y,p[0],x),x[0]&&(i[v++]=x[0]);var o=p[1],m=x[1],l=o+m,w=l-o,_=m-w;x[1]=l,_&&(i[v++]=_)}return x[1]&&(i[v++]=x[1]),v===0&&(i[v++]=0),i.length=v,i}},{"two-product":306,"two-sum":307}],287:[function(g,S,M){S.exports=n;var e=g("robust-orientation")[3];function a(r,t,c,s){for(var i=0;i<2;++i){var x=r[i],p=t[i],v=Math.min(x,p),f=Math.max(x,p),y=c[i],o=s[i],m=Math.min(y,o),l=Math.max(y,o);if(l<v||f<m)return!1}return!0}function n(r,t,c,s){var i=e(r,c,s),x=e(t,c,s);if(i>0&&x>0||i<0&&x<0)return!1;var p=e(c,r,t),v=e(s,r,t);return p>0&&v>0||p<0&&v<0?!1:i===0&&x===0&&p===0&&v===0?a(r,t,c,s):!0}},{"robust-orientation":284}],288:[function(g,S,M){S.exports=a;function e(n,r){var t=n+r,c=t-n,s=t-c,i=r-c,x=n-s,p=x+i;return p?[p,t]:[t]}function a(n,r){var t=n.length|0,c=r.length|0;if(t===1&&c===1)return e(n[0],-r[0]);var s=t+c,i=new Array(s),x=0,p=0,v=0,f=Math.abs,y=n[p],o=f(y),m=-r[v],l=f(m),w,_;o<l?(_=y,p+=1,p<t&&(y=n[p],o=f(y))):(_=m,v+=1,v<c&&(m=-r[v],l=f(m))),p<t&&o<l||v>=c?(w=y,p+=1,p<t&&(y=n[p],o=f(y))):(w=m,v+=1,v<c&&(m=-r[v],l=f(m)));for(var h=w+_,b=h-w,u=_-b,L=u,T=h,k,P,z,I,D;p<t&&v<c;)o<l?(w=y,p+=1,p<t&&(y=n[p],o=f(y))):(w=m,v+=1,v<c&&(m=-r[v],l=f(m))),_=L,h=w+_,b=h-w,u=_-b,u&&(i[x++]=u),k=T+h,P=k-T,z=k-P,I=h-P,D=T-z,L=D+I,T=k;for(;p<t;)w=y,_=L,h=w+_,b=h-w,u=_-b,u&&(i[x++]=u),k=T+h,P=k-T,z=k-P,I=h-P,D=T-z,L=D+I,T=k,p+=1,p<t&&(y=n[p]);for(;v<c;)w=m,_=L,h=w+_,b=h-w,u=_-b,u&&(i[x++]=u),k=T+h,P=k-T,z=k-P,I=h-P,D=T-z,L=D+I,T=k,v+=1,v<c&&(m=-r[v]);return L&&(i[x++]=L),T&&(i[x++]=T),x||(i[x++]=0),i.length=x,i}},{}],289:[function(g,S,M){S.exports=a;function e(n,r){var t=n+r,c=t-n,s=t-c,i=r-c,x=n-s,p=x+i;return p?[p,t]:[t]}function a(n,r){var t=n.length|0,c=r.length|0;if(t===1&&c===1)return e(n[0],r[0]);var s=t+c,i=new Array(s),x=0,p=0,v=0,f=Math.abs,y=n[p],o=f(y),m=r[v],l=f(m),w,_;o<l?(_=y,p+=1,p<t&&(y=n[p],o=f(y))):(_=m,v+=1,v<c&&(m=r[v],l=f(m))),p<t&&o<l||v>=c?(w=y,p+=1,p<t&&(y=n[p],o=f(y))):(w=m,v+=1,v<c&&(m=r[v],l=f(m)));for(var h=w+_,b=h-w,u=_-b,L=u,T=h,k,P,z,I,D;p<t&&v<c;)o<l?(w=y,p+=1,p<t&&(y=n[p],o=f(y))):(w=m,v+=1,v<c&&(m=r[v],l=f(m))),_=L,h=w+_,b=h-w,u=_-b,u&&(i[x++]=u),k=T+h,P=k-T,z=k-P,I=h-P,D=T-z,L=D+I,T=k;for(;p<t;)w=y,_=L,h=w+_,b=h-w,u=_-b,u&&(i[x++]=u),k=T+h,P=k-T,z=k-P,I=h-P,D=T-z,L=D+I,T=k,p+=1,p<t&&(y=n[p]);for(;v<c;)w=m,_=L,h=w+_,b=h-w,u=_-b,u&&(i[x++]=u),k=T+h,P=k-T,z=k-P,I=h-P,D=T-z,L=D+I,T=k,v+=1,v<c&&(m=r[v]);return L&&(i[x++]=L),T&&(i[x++]=T),x||(i[x++]=0),i.length=x,i}},{}],290:[function(g,S,M){S.exports=n;var e=g("boundary-cells"),a=g("reduce-simplicial-complex");function n(r){return a(e(r))}},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(g,S,M){S.exports=v;var e=g("ndarray"),a=g("typedarray-pool"),n=g("ndarray-sort"),r=g("./lib/codegen");function t(f){for(var y=f.length,o=0,m=0;m<y;++m)o=Math.max(o,f[m].length)|0;return o-1}function c(f,y){for(var o=f.length,m=a.mallocUint8(o),l=0;l<o;++l)m[l]=f[l]<y|0;return m}function s(f,y){for(var o=f.length,m=y*(y+1)/2*o|0,l=a.mallocUint32(m*2),w=0,_=0;_<o;++_)for(var h=f[_],y=h.length,b=0;b<y;++b)for(var u=0;u<b;++u){var L=h[u],T=h[b];l[w++]=Math.min(L,T)|0,l[w++]=Math.max(L,T)|0}var k=w/2|0;n(e(l,[k,2]));for(var P=2,_=2;_<w;_+=2)l[_-2]===l[_]&&l[_-1]===l[_+1]||(l[P++]=l[_],l[P++]=l[_+1]);return e(l,[P/2|0,2])}function i(f,y,o,m){for(var l=f.data,w=f.shape[0],_=a.mallocDouble(w),h=0,b=0;b<w;++b){var u=l[2*b],L=l[2*b+1];if(o[u]!==o[L]){var T=y[u],k=y[L];l[2*h]=u,l[2*h+1]=L,_[h++]=(k-m)/(k-T)}}return f.shape[0]=h,e(_,[h])}function x(f,y){var o=a.mallocInt32(y*2),m=f.shape[0],l=f.data;o[0]=0;for(var w=0,_=0;_<m;++_){var h=l[2*_];if(h!==w){for(o[2*w+1]=_;++w<h;)o[2*w]=_,o[2*w+1]=_;o[2*w]=_}}for(o[2*w+1]=m;++w<y;)o[2*w]=o[2*w+1]=m;return o}function p(f){for(var y=f.shape[0]|0,o=f.data,m=new Array(y),l=0;l<y;++l)m[l]=[o[2*l],o[2*l+1]];return m}function v(f,y,o,m){o=o||0,typeof m>"u"&&(m=t(f));var l=f.length;if(l===0||m<1)return{cells:[],vertexIds:[],vertexWeights:[]};var w=c(y,+o),_=s(f,m),h=i(_,y,w,+o),b=x(_,y.length|0),u=r(m)(f,_.data,b,w),L=p(_),T=[].slice.call(h.data,0,h.shape[0]);return a.free(w),a.free(_.data),a.free(h.data),a.free(b),{cells:u,vertexIds:L,vertexWeights:T}}},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(g,S,M){S.exports=a;var e=[function(){function r(t,c,s,i){for(var x=t.length,p=[],v=0;v<x;++v){var f=t[v];f.length}return p}return r},function(){function r(c,s,i,x){for(var p=Math.min(i,x)|0,v=Math.max(i,x)|0,f=c[2*p],y=c[2*p+1];f<y;){var o=f+y>>1,m=s[2*o+1];if(m===v)return o;v<m?y=o:f=o+1}return f}function t(c,s,i,x){for(var p=c.length,v=[],f=0;f<p;++f){var y=c[f],o=y.length;if(o===2){var m=(x[y[0]]<<0)+(x[y[1]]<<1);if(m===0||m===3)continue;switch(m){case 0:break;case 1:v.push([r(i,s,y[0],y[1])]);break;case 2:v.push([r(i,s,y[1],y[0])]);break}}}return v}return t},function(){function r(c,s,i,x){for(var p=Math.min(i,x)|0,v=Math.max(i,x)|0,f=c[2*p],y=c[2*p+1];f<y;){var o=f+y>>1,m=s[2*o+1];if(m===v)return o;v<m?y=o:f=o+1}return f}function t(c,s,i,x){for(var p=c.length,v=[],f=0;f<p;++f){var y=c[f],o=y.length;if(o===3){var m=(x[y[0]]<<0)+(x[y[1]]<<1)+(x[y[2]]<<2);if(m===0||m===7)continue;switch(m){case 0:break;case 1:v.push([r(i,s,y[0],y[2]),r(i,s,y[0],y[1])]);break;case 2:v.push([r(i,s,y[1],y[0]),r(i,s,y[1],y[2])]);break;case 3:v.push([r(i,s,y[0],y[2]),r(i,s,y[1],y[2])]);break;case 4:v.push([r(i,s,y[2],y[1]),r(i,s,y[2],y[0])]);break;case 5:v.push([r(i,s,y[2],y[1]),r(i,s,y[0],y[1])]);break;case 6:v.push([r(i,s,y[1],y[0]),r(i,s,y[2],y[0])]);break}}else if(o===2){var m=(x[y[0]]<<0)+(x[y[1]]<<1);if(m===0||m===3)continue;switch(m){case 0:break;case 1:v.push([r(i,s,y[0],y[1])]);break;case 2:v.push([r(i,s,y[1],y[0])]);break}}}return v}return t},function(){function r(c,s,i,x){for(var p=Math.min(i,x)|0,v=Math.max(i,x)|0,f=c[2*p],y=c[2*p+1];f<y;){var o=f+y>>1,m=s[2*o+1];if(m===v)return o;v<m?y=o:f=o+1}return f}function t(c,s,i,x){for(var p=c.length,v=[],f=0;f<p;++f){var y=c[f],o=y.length;if(o===4){var m=(x[y[0]]<<0)+(x[y[1]]<<1)+(x[y[2]]<<2)+(x[y[3]]<<3);if(m===0||m===15)continue;switch(m){case 0:break;case 1:v.push([r(i,s,y[0],y[1]),r(i,s,y[0],y[2]),r(i,s,y[0],y[3])]);break;case 2:v.push([r(i,s,y[1],y[2]),r(i,s,y[1],y[0]),r(i,s,y[1],y[3])]);break;case 3:v.push([r(i,s,y[1],y[2]),r(i,s,y[0],y[2]),r(i,s,y[0],y[3])],[r(i,s,y[1],y[3]),r(i,s,y[1],y[2]),r(i,s,y[0],y[3])]);break;case 4:v.push([r(i,s,y[2],y[0]),r(i,s,y[2],y[1]),r(i,s,y[2],y[3])]);break;case 5:v.push([r(i,s,y[0],y[1]),r(i,s,y[2],y[1]),r(i,s,y[0],y[3])],[r(i,s,y[2],y[1]),r(i,s,y[2],y[3]),r(i,s,y[0],y[3])]);break;case 6:v.push([r(i,s,y[2],y[0]),r(i,s,y[1],y[0]),r(i,s,y[1],y[3])],[r(i,s,y[2],y[3]),r(i,s,y[2],y[0]),r(i,s,y[1],y[3])]);break;case 7:v.push([r(i,s,y[0],y[3]),r(i,s,y[1],y[3]),r(i,s,y[2],y[3])]);break;case 8:v.push([r(i,s,y[3],y[1]),r(i,s,y[3],y[0]),r(i,s,y[3],y[2])]);break;case 9:v.push([r(i,s,y[3],y[1]),r(i,s,y[0],y[1]),r(i,s,y[0],y[2])],[r(i,s,y[3],y[2]),r(i,s,y[3],y[1]),r(i,s,y[0],y[2])]);break;case 10:v.push([r(i,s,y[1],y[0]),r(i,s,y[3],y[0]),r(i,s,y[1],y[2])],[r(i,s,y[3],y[0]),r(i,s,y[3],y[2]),r(i,s,y[1],y[2])]);break;case 11:v.push([r(i,s,y[1],y[2]),r(i,s,y[0],y[2]),r(i,s,y[3],y[2])]);break;case 12:v.push([r(i,s,y[3],y[0]),r(i,s,y[2],y[0]),r(i,s,y[2],y[1])],[r(i,s,y[3],y[1]),r(i,s,y[3],y[0]),r(i,s,y[2],y[1])]);break;case 13:v.push([r(i,s,y[0],y[1]),r(i,s,y[2],y[1]),r(i,s,y[3],y[1])]);break;case 14:v.push([r(i,s,y[2],y[0]),r(i,s,y[1],y[0]),r(i,s,y[3],y[0])]);break}}else if(o===3){var m=(x[y[0]]<<0)+(x[y[1]]<<1)+(x[y[2]]<<2);if(m===0||m===7)continue;switch(m){case 0:break;case 1:v.push([r(i,s,y[0],y[2]),r(i,s,y[0],y[1])]);break;case 2:v.push([r(i,s,y[1],y[0]),r(i,s,y[1],y[2])]);break;case 3:v.push([r(i,s,y[0],y[2]),r(i,s,y[1],y[2])]);break;case 4:v.push([r(i,s,y[2],y[1]),r(i,s,y[2],y[0])]);break;case 5:v.push([r(i,s,y[2],y[1]),r(i,s,y[0],y[1])]);break;case 6:v.push([r(i,s,y[1],y[0]),r(i,s,y[2],y[0])]);break}}else if(o===2){var m=(x[y[0]]<<0)+(x[y[1]]<<1);if(m===0||m===3)continue;switch(m){case 0:break;case 1:v.push([r(i,s,y[0],y[1])]);break;case 2:v.push([r(i,s,y[1],y[0])]);break}}}return v}return t}];function a(n){return e[n]()}},{}],293:[function(g,S,M){var e=g("bit-twiddle"),a=g("union-find");function n(h){for(var b=0,u=Math.max,L=0,T=h.length;L<T;++L)b=u(b,h[L].length);return b-1}M.dimension=n;function r(h){for(var b=-1,u=Math.max,L=0,T=h.length;L<T;++L)for(var k=h[L],P=0,z=k.length;P<z;++P)b=u(b,k[P]);return b+1}M.countVertices=r;function t(h){for(var b=new Array(h.length),u=0,L=h.length;u<L;++u)b[u]=h[u].slice(0);return b}M.cloneCells=t;function c(h,b){var u=h.length,L=h.length-b.length,T=Math.min;if(L)return L;switch(u){case 0:return 0;case 1:return h[0]-b[0];case 2:var D=h[0]+h[1]-b[0]-b[1];return D||T(h[0],h[1])-T(b[0],b[1]);case 3:var k=h[0]+h[1],P=b[0]+b[1];if(D=k+h[2]-(P+b[2]),D)return D;var z=T(h[0],h[1]),I=T(b[0],b[1]),D=T(z,h[2])-T(I,b[2]);return D||T(z+h[2],k)-T(I+b[2],P);default:var R=h.slice(0);R.sort();var O=b.slice(0);O.sort();for(var F=0;F<u;++F)if(L=R[F]-O[F],L)return L;return 0}}M.compareCells=c;function s(h,b){return c(h[0],b[0])}function i(h,b){if(b){for(var u=h.length,L=new Array(u),T=0;T<u;++T)L[T]=[h[T],b[T]];L.sort(s);for(var T=0;T<u;++T)h[T]=L[T][0],b[T]=L[T][1];return h}else return h.sort(c),h}M.normalize=i;function x(h){if(h.length===0)return[];for(var b=1,u=h.length,L=1;L<u;++L){var T=h[L];if(c(T,h[L-1])){if(L===b){b++;continue}h[b++]=T}}return h.length=b,h}M.unique=x;function p(h,b){for(var u=0,L=h.length-1,T=-1;u<=L;){var k=u+L>>1,P=c(h[k],b);P<=0?(P===0&&(T=k),u=k+1):P>0&&(L=k-1)}return T}M.findCell=p;function v(h,b){for(var u=new Array(h.length),L=0,T=u.length;L<T;++L)u[L]=[];for(var k=[],L=0,P=b.length;L<P;++L)for(var z=b[L],I=z.length,D=1,R=1<<I;D<R;++D){k.length=e.popCount(D);for(var O=0,F=0;F<I;++F)D&1<<F&&(k[O++]=z[F]);var N=p(h,k);if(!(N<0))for(;u[N++].push(L),!(N>=h.length||c(h[N],k)!==0););}return u}M.incidence=v;function f(h,b){if(!b)return v(x(o(h,0)),h);for(var u=new Array(b),L=0;L<b;++L)u[L]=[];for(var L=0,T=h.length;L<T;++L)for(var k=h[L],P=0,z=k.length;P<z;++P)u[k[P]].push(L);return u}M.dual=f;function y(h){for(var b=[],u=0,L=h.length;u<L;++u)for(var T=h[u],k=T.length|0,P=1,z=1<<k;P<z;++P){for(var I=[],D=0;D<k;++D)P>>>D&1&&I.push(T[D]);b.push(I)}return i(b)}M.explode=y;function o(h,b){if(b<0)return[];for(var u=[],L=(1<<b+1)-1,T=0;T<h.length;++T)for(var k=h[T],P=L;P<1<<k.length;P=e.nextCombination(P)){for(var z=new Array(b+1),I=0,D=0;D<k.length;++D)P&1<<D&&(z[I++]=k[D]);u.push(z)}return i(u)}M.skeleton=o;function m(h){for(var b=[],u=0,L=h.length;u<L;++u)for(var T=h[u],k=0,P=T.length;k<P;++k){for(var z=new Array(T.length-1),I=0,D=0;I<P;++I)I!==k&&(z[D++]=T[I]);b.push(z)}return i(b)}M.boundary=m;function l(h,b){for(var u=new a(b),L=0;L<h.length;++L)for(var T=h[L],k=0;k<T.length;++k)for(var P=k+1;P<T.length;++P)u.link(T[k],T[P]);for(var z=[],I=u.ranks,L=0;L<I.length;++L)I[L]=-1;for(var L=0;L<h.length;++L){var D=u.find(h[L][0]);I[D]<0?(I[D]=z.length,z.push([h[L].slice(0)])):z[I[D]].push(h[L].slice(0))}return z}function w(h){for(var b=x(i(o(h,0))),u=new a(b.length),L=0;L<h.length;++L)for(var T=h[L],k=0;k<T.length;++k)for(var P=p(b,[T[k]]),z=k+1;z<T.length;++z)u.link(P,p(b,[T[z]]));for(var I=[],D=u.ranks,L=0;L<D.length;++L)D[L]=-1;for(var L=0;L<h.length;++L){var R=u.find(p(b,[h[L][0]]));D[R]<0?(D[R]=I.length,I.push([h[L].slice(0)])):I[D[R]].push(h[L].slice(0))}return I}function _(h,b){return b?l(h,b):w(h)}M.connectedComponents=_},{"bit-twiddle":32,"union-find":309}],294:[function(g,S,M){arguments[4][32][0].apply(M,arguments)},{dup:32}],295:[function(g,S,M){arguments[4][293][0].apply(M,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(g,S,M){S.exports=e;function e(a){this.roots=new Array(a),this.ranks=new Array(a);for(var n=0;n<a;++n)this.roots[n]=n,this.ranks[n]=0}e.prototype.length=function(){return this.roots.length},e.prototype.makeSet=function(){var a=this.roots.length;return this.roots.push(a),this.ranks.push(0),a},e.prototype.find=function(a){for(var n=this.roots;n[a]!==a;){var r=n[a];n[a]=n[r],a=r}return a},e.prototype.link=function(a,n){var r=this.find(a),t=this.find(n);if(r!==t){var c=this.ranks,s=this.roots,i=c[r],x=c[t];i<x?s[r]=t:x<i?s[t]=r:(s[t]=r,++c[r])}}},{}],297:[function(g,S,M){S.exports=r;var e=g("robust-orientation"),a=g("simplicial-complex");function n(t,c,s){var i=Math.abs(e(t,c,s)),x=Math.sqrt(Math.pow(c[0]-s[0],2)+Math.pow(c[1]-s[1],2));return i/x}function r(t,c,s){for(var i=c.length,x=t.length,p=new Array(i),v=new Array(i),f=new Array(i),y=new Array(i),o=0;o<i;++o)p[o]=v[o]=-1,f[o]=1/0,y[o]=!1;for(var o=0;o<x;++o){var m=t[o];if(m.length!==2)throw new Error("Input must be a graph");var l=m[1],w=m[0];v[w]!==-1?v[w]=-2:v[w]=l,p[l]!==-1?p[l]=-2:p[l]=w}function _(W){if(y[W])return 1/0;var Y=p[W],re=v[W];return Y<0||re<0?1/0:n(c[W],c[Y],c[re])}function h(W,Y){var re=I[W],ue=I[Y];I[W]=ue,I[Y]=re,D[re]=Y,D[ue]=W}function b(W){return f[I[W]]}function u(W){return W&1?W-1>>1:(W>>1)-1}function L(W){for(var Y=b(W);;){var re=Y,ue=2*W+1,j=2*(W+1),q=W;if(ue<O){var V=b(ue);V<re&&(q=ue,re=V)}if(j<O){var U=b(j);U<re&&(q=j)}if(q===W)return W;h(W,q),W=q}}function T(W){for(var Y=b(W);W>0;){var re=u(W);if(re>=0){var ue=b(re);if(Y<ue){h(W,re),W=re;continue}}return W}}function k(){if(O>0){var W=I[0];return h(0,O-1),O-=1,L(0),W}return-1}function P(W,Y){var re=I[W];return f[re]===Y?W:(f[re]=-1/0,T(W),k(),f[re]=Y,O+=1,T(O-1))}function z(W){if(!y[W]){y[W]=!0;var Y=p[W],re=v[W];p[re]>=0&&(p[re]=Y),v[Y]>=0&&(v[Y]=re),D[Y]>=0&&P(D[Y],_(Y)),D[re]>=0&&P(D[re],_(re))}}for(var I=[],D=new Array(i),o=0;o<i;++o){var R=f[o]=_(o);R<1/0?(D[o]=I.length,I.push(o)):D[o]=-1}for(var O=I.length,o=O>>1;o>=0;--o)L(o);for(;;){var F=k();if(F<0||f[F]>s)break;z(F)}for(var N=[],o=0;o<i;++o)y[o]||(D[o]=N.length,N.push(c[o].slice()));N.length;function G(W,Y){if(W[Y]<0)return Y;var re=Y,ue=Y;do{var j=W[ue];if(!y[ue]||j<0||j===ue||(ue=j,j=W[ue],!y[ue]||j<0||j===ue))break;ue=j,re=W[re]}while(re!==ue);for(var q=Y;q!==ue;q=W[q])W[q]=ue;return ue}var K=[];return t.forEach(function(W){var Y=G(p,W[0]),re=G(v,W[1]);if(Y>=0&&re>=0&&Y!==re){var ue=D[Y],j=D[re];ue!==j&&K.push([ue,j])}}),a.unique(a.normalize(K)),{positions:N,edges:K}}},{"robust-orientation":284,"simplicial-complex":295}],298:[function(g,S,M){S.exports=n;var e=g("robust-orientation");function a(r,t){var c,s;if(t[0][0]<t[1][0])c=t[0],s=t[1];else if(t[0][0]>t[1][0])c=t[1],s=t[0];else{var i=Math.min(r[0][1],r[1][1]),x=Math.max(r[0][1],r[1][1]),p=Math.min(t[0][1],t[1][1]),v=Math.max(t[0][1],t[1][1]);return x<p?x-p:i>v?i-v:x-v}var f,y;r[0][1]<r[1][1]?(f=r[0],y=r[1]):(f=r[1],y=r[0]);var o=e(s,c,f);return o||(o=e(s,c,y),o)?o:y-s}function n(r,t){var c,s;if(t[0][0]<t[1][0])c=t[0],s=t[1];else if(t[0][0]>t[1][0])c=t[1],s=t[0];else return a(t,r);var i,x;if(r[0][0]<r[1][0])i=r[0],x=r[1];else if(r[0][0]>r[1][0])i=r[1],x=r[0];else return-a(r,t);var p=e(c,s,x),v=e(c,s,i);if(p<0){if(v<=0)return p}else if(p>0){if(v>=0)return p}else if(v)return v;if(p=e(x,i,s),v=e(x,i,c),p<0){if(v<=0)return p}else if(p>0){if(v>=0)return p}else if(v)return v;return s[0]-x[0]}},{"robust-orientation":284}],299:[function(g,S,M){S.exports=v;var e=g("binary-search-bounds"),a=g("functional-red-black-tree"),n=g("robust-orientation"),r=g("./lib/order-segments");function t(f,y,o){this.slabs=f,this.coordinates=y,this.horizontal=o}var c=t.prototype;function s(f,y){return f.y-y}function i(f,y){for(var o=null;f;){var m=f.key,l,w;m[0][0]<m[1][0]?(l=m[0],w=m[1]):(l=m[1],w=m[0]);var _=n(l,w,y);if(_<0)f=f.left;else if(_>0)if(y[0]!==m[1][0])o=f,f=f.right;else{var h=i(f.right,y);if(h)return h;f=f.left}else{if(y[0]!==m[1][0])return f;var h=i(f.right,y);if(h)return h;f=f.left}}return o}c.castUp=function(f){var y=e.le(this.coordinates,f[0]);if(y<0)return-1;this.slabs[y];var o=i(this.slabs[y],f),m=-1;if(o&&(m=o.value),this.coordinates[y]===f[0]){var l=null;if(o&&(l=o.key),y>0){var w=i(this.slabs[y-1],f);w&&(l?r(w.key,l)>0&&(l=w.key,m=w.value):(m=w.value,l=w.key))}var _=this.horizontal[y];if(_.length>0){var h=e.ge(_,f[1],s);if(h<_.length){var b=_[h];if(f[1]===b.y){if(b.closed)return b.index;for(;h<_.length-1&&_[h+1].y===f[1];)if(h=h+1,b=_[h],b.closed)return b.index;if(b.y===f[1]&&!b.start){if(h=h+1,h>=_.length)return m;b=_[h]}}if(b.start)if(l){var u=n(l[0],l[1],[f[0],b.y]);l[0][0]>l[1][0]&&(u=-u),u>0&&(m=b.index)}else m=b.index;else b.y!==f[1]&&(m=b.index)}}}return m};function x(f,y,o,m){this.y=f,this.index=y,this.start=o,this.closed=m}function p(f,y,o,m){this.x=f,this.segment=y,this.create=o,this.index=m}function v(f){for(var y=f.length,o=2*y,m=new Array(o),l=0;l<y;++l){var w=f[l],_=w[0][0]<w[1][0];m[2*l]=new p(w[0][0],w,_,l),m[2*l+1]=new p(w[1][0],w,!_,l)}m.sort(function(z,I){var D=z.x-I.x;return D||(D=z.create-I.create,D)?D:Math.min(z.segment[0][1],z.segment[1][1])-Math.min(I.segment[0][1],I.segment[1][1])});for(var h=a(r),b=[],u=[],L=[],l=0;l<o;){for(var T=m[l].x,k=[];l<o;){var P=m[l];if(P.x!==T)break;l+=1,P.segment[0][0]===P.x&&P.segment[1][0]===P.x?P.create&&(P.segment[0][1]<P.segment[1][1]?(k.push(new x(P.segment[0][1],P.index,!0,!0)),k.push(new x(P.segment[1][1],P.index,!1,!1))):(k.push(new x(P.segment[1][1],P.index,!0,!1)),k.push(new x(P.segment[0][1],P.index,!1,!0)))):P.create?h=h.insert(P.segment,P.index):h=h.remove(P.segment)}b.push(h.root),u.push(T),L.push(k)}return new t(b,u,L)}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(g,S,M){var e=g("robust-dot-product"),a=g("robust-sum");S.exports=t,S.exports.positive=c,S.exports.negative=s;function n(i,x){var p=a(e(i,x),[x[x.length-1]]);return p[p.length-1]}function r(i,x,p,v){var f=v-x,y=-x/f;y<0?y=0:y>1&&(y=1);for(var o=1-y,m=i.length,l=new Array(m),w=0;w<m;++w)l[w]=y*i[w]+o*p[w];return l}function t(i,x){for(var p=[],v=[],f=n(i[i.length-1],x),y=i[i.length-1],o=i[0],m=0;m<i.length;++m,y=o){o=i[m];var l=n(o,x);if(f<0&&l>0||f>0&&l<0){var w=r(y,l,o,f);p.push(w),v.push(w.slice())}l<0?v.push(o.slice()):l>0?p.push(o.slice()):(p.push(o.slice()),v.push(o.slice())),f=l}return{positive:p,negative:v}}function c(i,x){for(var p=[],v=n(i[i.length-1],x),f=i[i.length-1],y=i[0],o=0;o<i.length;++o,f=y){y=i[o];var m=n(y,x);(v<0&&m>0||v>0&&m<0)&&p.push(r(f,m,y,v)),m>=0&&p.push(y.slice()),v=m}return p}function s(i,x){for(var p=[],v=n(i[i.length-1],x),f=i[i.length-1],y=i[0],o=0;o<i.length;++o,f=y){y=i[o];var m=n(y,x);(v<0&&m>0||v>0&&m<0)&&p.push(r(f,m,y,v)),m<=0&&p.push(y.slice()),v=m}return p}},{"robust-dot-product":281,"robust-sum":289}],301:[function(g,S,M){(function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function a(s){return r(c(s),arguments)}function n(s,i){return a.apply(null,[s].concat(i||[]))}function r(s,i){var x=1,p=s.length,v,f="",y,o,m,l,w,_,h,b;for(y=0;y<p;y++)if(typeof s[y]=="string")f+=s[y];else if(typeof s[y]=="object"){if(m=s[y],m.keys)for(v=i[x],o=0;o<m.keys.length;o++){if(v==null)throw new Error(a('[sprintf] Cannot access property "%s" of undefined value "%s"',m.keys[o],m.keys[o-1]));v=v[m.keys[o]]}else m.param_no?v=i[m.param_no]:v=i[x++];if(e.not_type.test(m.type)&&e.not_primitive.test(m.type)&&v instanceof Function&&(v=v()),e.numeric_arg.test(m.type)&&typeof v!="number"&&isNaN(v))throw new TypeError(a("[sprintf] expecting number but found %T",v));switch(e.number.test(m.type)&&(h=v>=0),m.type){case"b":v=parseInt(v,10).toString(2);break;case"c":v=String.fromCharCode(parseInt(v,10));break;case"d":case"i":v=parseInt(v,10);break;case"j":v=JSON.stringify(v,null,m.width?parseInt(m.width):0);break;case"e":v=m.precision?parseFloat(v).toExponential(m.precision):parseFloat(v).toExponential();break;case"f":v=m.precision?parseFloat(v).toFixed(m.precision):parseFloat(v);break;case"g":v=m.precision?String(Number(v.toPrecision(m.precision))):parseFloat(v);break;case"o":v=(parseInt(v,10)>>>0).toString(8);break;case"s":v=String(v),v=m.precision?v.substring(0,m.precision):v;break;case"t":v=String(!!v),v=m.precision?v.substring(0,m.precision):v;break;case"T":v=Object.prototype.toString.call(v).slice(8,-1).toLowerCase(),v=m.precision?v.substring(0,m.precision):v;break;case"u":v=parseInt(v,10)>>>0;break;case"v":v=v.valueOf(),v=m.precision?v.substring(0,m.precision):v;break;case"x":v=(parseInt(v,10)>>>0).toString(16);break;case"X":v=(parseInt(v,10)>>>0).toString(16).toUpperCase();break}e.json.test(m.type)?f+=v:(e.number.test(m.type)&&(!h||m.sign)?(b=h?"+":"-",v=v.toString().replace(e.sign,"")):b="",w=m.pad_char?m.pad_char==="0"?"0":m.pad_char.charAt(1):" ",_=m.width-(b+v).length,l=m.width&&_>0?w.repeat(_):"",f+=m.align?b+v+l:w==="0"?b+l+v:l+b+v)}return f}var t=Object.create(null);function c(s){if(t[s])return t[s];for(var i=s,x,p=[],v=0;i;){if((x=e.text.exec(i))!==null)p.push(x[0]);else if((x=e.modulo.exec(i))!==null)p.push("%");else if((x=e.placeholder.exec(i))!==null){if(x[2]){v|=1;var f=[],y=x[2],o=[];if((o=e.key.exec(y))!==null)for(f.push(o[1]);(y=y.substring(o[0].length))!=="";)if((o=e.key_access.exec(y))!==null)f.push(o[1]);else if((o=e.index_access.exec(y))!==null)f.push(o[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");x[2]=f}else v|=2;if(v===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");p.push({placeholder:x[0],param_no:x[1],keys:x[2],sign:x[3],pad_char:x[4],align:x[5],width:x[6],precision:x[7],type:x[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");i=i.substring(x[0].length)}return t[s]=p}typeof M<"u"&&(M.sprintf=a,M.vsprintf=n),typeof window<"u"&&(window.sprintf=a,window.vsprintf=n)})()},{}],302:[function(g,S,M){S.exports=s;var e=g("ndarray-extract-contour"),a=g("zero-crossings"),n={"2d":function(i,x,p){var v=i({order:x,scalarArguments:3,getters:p==="generic"?[0]:void 0,phase:function(y,o,m,l){return y>l|0},vertex:function(y,o,m,l,w,_,h,b,u,L,T,k,P){var z=(h<<0)+(b<<1)+(u<<2)+(L<<3)|0;if(!(z===0||z===15))switch(z){case 0:T.push([y-.5,o-.5]);break;case 1:T.push([y-.25-.25*(l+m-2*P)/(m-l),o-.25-.25*(w+m-2*P)/(m-w)]);break;case 2:T.push([y-.75-.25*(-l-m+2*P)/(l-m),o-.25-.25*(_+l-2*P)/(l-_)]);break;case 3:T.push([y-.5,o-.5-.5*(w+m+_+l-4*P)/(m-w+l-_)]);break;case 4:T.push([y-.25-.25*(_+w-2*P)/(w-_),o-.75-.25*(-w-m+2*P)/(w-m)]);break;case 5:T.push([y-.5-.5*(l+m+_+w-4*P)/(m-l+w-_),o-.5]);break;case 6:T.push([y-.5-.25*(-l-m+_+w)/(l-m+w-_),o-.5-.25*(-w-m+_+l)/(w-m+l-_)]);break;case 7:T.push([y-.75-.25*(_+w-2*P)/(w-_),o-.75-.25*(_+l-2*P)/(l-_)]);break;case 8:T.push([y-.75-.25*(-_-w+2*P)/(_-w),o-.75-.25*(-_-l+2*P)/(_-l)]);break;case 9:T.push([y-.5-.25*(l+m+-_-w)/(m-l+_-w),o-.5-.25*(w+m+-_-l)/(m-w+_-l)]);break;case 10:T.push([y-.5-.5*(-l-m+-_-w+4*P)/(l-m+_-w),o-.5]);break;case 11:T.push([y-.25-.25*(-_-w+2*P)/(_-w),o-.75-.25*(w+m-2*P)/(m-w)]);break;case 12:T.push([y-.5,o-.5-.5*(-w-m+-_-l+4*P)/(w-m+_-l)]);break;case 13:T.push([y-.75-.25*(l+m-2*P)/(m-l),o-.25-.25*(-_-l+2*P)/(_-l)]);break;case 14:T.push([y-.25-.25*(-l-m+2*P)/(l-m),o-.25-.25*(-w-m+2*P)/(w-m)]);break;case 15:T.push([y-.5,o-.5]);break}},cell:function(y,o,m,l,w,_,h,b,u){w?b.push([y,o]):b.push([o,y])}});return function(f,y){var o=[],m=[];return v(f,o,m,y),{positions:o,cells:m}}}};function r(i,x){var p=i.length+"d",v=n[p];if(v)return v(e,i,x)}function t(i,x){for(var p=a(i,x),v=p.length,f=new Array(v),y=new Array(v),o=0;o<v;++o)f[o]=[p[o]],y[o]=[o];return{positions:f,cells:y}}var c={};function s(i,f){if(i.dimension<=0)return{positions:[],cells:[]};if(i.dimension===1)return t(i,f);var p=i.order.join()+"-"+i.dtype,v=c[p],f=+f||0;return v||(v=c[p]=r(i.order,i.dtype)),v(i,f)}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(g,S,M){(function(e){(function(){S.exports=c;var a=g("vectorize-text"),n=window||e.global||{},r=n.__TEXT_CACHE||{};n.__TEXT_CACHE={};function t(s){for(var i=s.cells,x=s.positions,p=new Float32Array(i.length*6),v=0,f=0,y=0;y<i.length;++y)for(var o=i[y],m=0;m<3;++m){var l=x[o[m]];p[v++]=l[0],p[v++]=l[1]+1.4,f=Math.max(l[0],f)}return{data:p,shape:f}}function c(s,i,p){var p=p||{},v=r[s];v||(v=r[s]={" ":{data:new Float32Array(0),shape:.2}});var f=v[i];if(!f)if(i.length<=1||!/\d/.test(i))f=v[i]=t(a(i,{triangles:!0,font:s,textAlign:p.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var y=i.split(/(\d|\s)/),o=new Array(y.length),m=0,l=0,w=0;w<y.length;++w)o[w]=c(s,y[w]),m+=o[w].data.length,l+=o[w].shape,w>0&&(l+=.02);for(var _=new Float32Array(m),h=0,b=-.5*l,w=0;w<o.length;++w){for(var u=o[w].data,L=0;L<u.length;L+=2)_[h++]=u[L]+b,_[h++]=u[L+1];b+=o[w].shape+.02}f=v[i]={data:_,shape:l}}return f}}).call(this)}).call(this,g("_process"))},{_process:5,"vectorize-text":311}],304:[function(g,S,M){var e=g("parse-unit");S.exports=t;var a=96;function n(c,s){var i=e(getComputedStyle(c).getPropertyValue(s));return i[0]*t(i[1],c)}function r(c,s){var i=document.createElement("div");i.style["font-size"]="128"+c,s.appendChild(i);var x=n(i,"font-size")/128;return s.removeChild(i),x}function t(c,s){switch(s=s||document.body,c=(c||"px").trim().toLowerCase(),(s===window||s===document)&&(s=document.body),c){case"%":return s.clientHeight/100;case"ch":case"ex":return r(c,s);case"em":return n(s,"font-size");case"rem":return n(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return a;case"cm":return a/2.54;case"mm":return a/25.4;case"pt":return a/72;case"pc":return a/6}return 1}},{"parse-unit":265}],305:[function(g,S,M){S.exports=y;var e=g("filtered-vector"),a=g("gl-mat4/invert"),n=g("gl-mat4/rotate"),r=g("gl-vec3/cross"),t=g("gl-vec3/normalize"),c=g("gl-vec3/dot");function s(o,m,l){return Math.sqrt(Math.pow(o,2)+Math.pow(m,2)+Math.pow(l,2))}function i(o){return Math.min(1,Math.max(-1,o))}function x(o){var m=Math.abs(o[0]),l=Math.abs(o[1]),w=Math.abs(o[2]),_=[0,0,0];m>Math.max(l,w)?_[2]=1:l>Math.max(m,w)?_[0]=1:_[1]=1;for(var h=0,b=0,u=0;u<3;++u)h+=o[u]*o[u],b+=_[u]*o[u];for(var u=0;u<3;++u)_[u]-=b/h*o[u];return t(_,_),_}function p(o,m,l,w,_,h,b,u){this.center=e(l),this.up=e(w),this.right=e(_),this.radius=e([h]),this.angle=e([b,u]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(o,m),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var L=0;L<16;++L)this.computedMatrix[L]=.5;this.recalcMatrix(0)}var v=p.prototype;v.setDistanceLimits=function(o,m){o>0?o=Math.log(o):o=-1/0,m>0?m=Math.log(m):m=1/0,m=Math.max(m,o),this.radius.bounds[0][0]=o,this.radius.bounds[1][0]=m},v.getDistanceLimits=function(o){var m=this.radius.bounds[0];return o?(o[0]=Math.exp(m[0][0]),o[1]=Math.exp(m[1][0]),o):[Math.exp(m[0][0]),Math.exp(m[1][0])]},v.recalcMatrix=function(o){this.center.curve(o),this.up.curve(o),this.right.curve(o),this.radius.curve(o),this.angle.curve(o);for(var m=this.computedUp,l=this.computedRight,w=0,_=0,h=0;h<3;++h)_+=m[h]*l[h],w+=m[h]*m[h];for(var b=Math.sqrt(w),u=0,h=0;h<3;++h)l[h]-=m[h]*_/w,u+=l[h]*l[h],m[h]/=b;for(var L=Math.sqrt(u),h=0;h<3;++h)l[h]/=L;var T=this.computedToward;r(T,m,l),t(T,T);for(var k=Math.exp(this.computedRadius[0]),P=this.computedAngle[0],z=this.computedAngle[1],I=Math.cos(P),D=Math.sin(P),R=Math.cos(z),O=Math.sin(z),F=this.computedCenter,N=I*R,G=D*R,K=O,W=-I*O,Y=-D*O,re=R,ue=this.computedEye,j=this.computedMatrix,h=0;h<3;++h){var q=N*l[h]+G*T[h]+K*m[h];j[4*h+1]=W*l[h]+Y*T[h]+re*m[h],j[4*h+2]=q,j[4*h+3]=0}var V=j[1],U=j[5],$=j[9],ne=j[2],X=j[6],Q=j[10],ie=U*Q-$*X,se=$*ne-V*Q,ae=V*X-U*ne,oe=s(ie,se,ae);ie/=oe,se/=oe,ae/=oe,j[0]=ie,j[4]=se,j[8]=ae;for(var h=0;h<3;++h)ue[h]=F[h]+j[2+4*h]*k;for(var h=0;h<3;++h){for(var u=0,be=0;be<3;++be)u+=j[h+4*be]*ue[be];j[12+h]=-u}j[15]=1},v.getMatrix=function(o,m){this.recalcMatrix(o);var l=this.computedMatrix;if(m){for(var w=0;w<16;++w)m[w]=l[w];return m}return l};var f=[0,0,0];v.rotate=function(o,m,l,w){if(this.angle.move(o,m,l),w){this.recalcMatrix(o);var _=this.computedMatrix;f[0]=_[2],f[1]=_[6],f[2]=_[10];for(var h=this.computedUp,b=this.computedRight,u=this.computedToward,L=0;L<3;++L)_[4*L]=h[L],_[4*L+1]=b[L],_[4*L+2]=u[L];n(_,_,w,f);for(var L=0;L<3;++L)h[L]=_[4*L],b[L]=_[4*L+1];this.up.set(o,h[0],h[1],h[2]),this.right.set(o,b[0],b[1],b[2])}},v.pan=function(o,m,l,w){m=m||0,l=l||0,w=w||0,this.recalcMatrix(o);var _=this.computedMatrix;Math.exp(this.computedRadius[0]);var h=_[1],b=_[5],u=_[9],L=s(h,b,u);h/=L,b/=L,u/=L;var T=_[0],k=_[4],P=_[8],z=T*h+k*b+P*u;T-=h*z,k-=b*z,P-=u*z;var I=s(T,k,P);T/=I,k/=I,P/=I;var D=T*m+h*l,R=k*m+b*l,O=P*m+u*l;this.center.move(o,D,R,O);var F=Math.exp(this.computedRadius[0]);F=Math.max(1e-4,F+w),this.radius.set(o,Math.log(F))},v.translate=function(o,m,l,w){this.center.move(o,m||0,l||0,w||0)},v.setMatrix=function(o,m,l,w){var _=1;typeof l=="number"&&(_=l|0),(_<0||_>3)&&(_=1);var h=(_+2)%3;m||(this.recalcMatrix(o),m=this.computedMatrix);var b=m[_],u=m[_+4],L=m[_+8];if(w){var k=Math.abs(b),P=Math.abs(u),z=Math.abs(L),I=Math.max(k,P,z);k===I?(b=b<0?-1:1,u=L=0):z===I?(L=L<0?-1:1,b=u=0):(u=u<0?-1:1,b=L=0)}else{var T=s(b,u,L);b/=T,u/=T,L/=T}var D=m[h],R=m[h+4],O=m[h+8],F=D*b+R*u+O*L;D-=b*F,R-=u*F,O-=L*F;var N=s(D,R,O);D/=N,R/=N,O/=N;var G=u*O-L*R,K=L*D-b*O,W=b*R-u*D,Y=s(G,K,W);G/=Y,K/=Y,W/=Y,this.center.jump(o,ge,me,Ee),this.radius.idle(o),this.up.jump(o,b,u,L),this.right.jump(o,D,R,O);var re,ue;if(_===2){var j=m[1],q=m[5],V=m[9],U=j*D+q*R+V*O,$=j*G+q*K+V*W;ie<0?re=-Math.PI/2:re=Math.PI/2,ue=Math.atan2($,U)}else{var ne=m[2],X=m[6],Q=m[10],ie=ne*b+X*u+Q*L,se=ne*D+X*R+Q*O,ae=ne*G+X*K+Q*W;re=Math.asin(i(ie)),ue=Math.atan2(ae,se)}this.angle.jump(o,ue,re),this.recalcMatrix(o);var oe=m[2],be=m[6],ce=m[10],de=this.computedMatrix;a(de,m);var ye=de[15],ge=de[12]/ye,me=de[13]/ye,Ee=de[14]/ye,Pe=Math.exp(this.computedRadius[0]);this.center.jump(o,ge-oe*Pe,me-be*Pe,Ee-ce*Pe)},v.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},v.idle=function(o){this.center.idle(o),this.up.idle(o),this.right.idle(o),this.radius.idle(o),this.angle.idle(o)},v.flush=function(o){this.center.flush(o),this.up.flush(o),this.right.flush(o),this.radius.flush(o),this.angle.flush(o)},v.setDistance=function(o,m){m>0&&this.radius.set(o,Math.log(m))},v.lookAt=function(o,m,l,w){this.recalcMatrix(o),m=m||this.computedEye,l=l||this.computedCenter,w=w||this.computedUp;var _=w[0],h=w[1],b=w[2],u=s(_,h,b);if(!(u<1e-6)){_/=u,h/=u,b/=u;var L=m[0]-l[0],T=m[1]-l[1],k=m[2]-l[2],P=s(L,T,k);if(!(P<1e-6)){L/=P,T/=P,k/=P;var z=this.computedRight,I=z[0],D=z[1],R=z[2],O=_*I+h*D+b*R;I-=O*_,D-=O*h,R-=O*b;var F=s(I,D,R);if(!(F<.01&&(I=h*k-b*T,D=b*L-_*k,R=_*T-h*L,F=s(I,D,R),F<1e-6))){I/=F,D/=F,R/=F,this.up.set(o,_,h,b),this.right.set(o,I,D,R),this.center.set(o,l[0],l[1],l[2]),this.radius.set(o,Math.log(P));var N=h*R-b*D,G=b*I-_*R,K=_*D-h*I,W=s(N,G,K);N/=W,G/=W,K/=W;var Y=_*L+h*T+b*k,re=I*L+D*T+R*k,ue=N*L+G*T+K*k,j=Math.asin(i(Y)),q=Math.atan2(ue,re),V=this.angle._state,U=V[V.length-1],$=V[V.length-2];U=U%(2*Math.PI);var ne=Math.abs(U+2*Math.PI-q),X=Math.abs(U-q),Q=Math.abs(U-2*Math.PI-q);ne<X&&(U+=2*Math.PI),Q<X&&(U-=2*Math.PI),this.angle.jump(this.angle.lastT(),U,$),this.angle.set(o,q,j)}}}};function y(o){o=o||{};var m=o.center||[0,0,0],l=o.up||[0,1,0],w=o.right||x(l),_=o.radius||1,h=o.theta||0,b=o.phi||0;if(m=[].slice.call(m,0,3),l=[].slice.call(l,0,3),t(l,l),w=[].slice.call(w,0,3),t(w,w),"eye"in o){var u=o.eye,L=[u[0]-m[0],u[1]-m[1],u[2]-m[2]];r(w,L,l),s(w[0],w[1],w[2])<1e-6?w=x(l):t(w,w),_=s(L[0],L[1],L[2]);var T=c(l,L)/_,k=c(w,L)/_;b=Math.acos(T),h=Math.acos(k)}return _=Math.log(_),new p(o.zoomMin,o.zoomMax,m,l,w,_,h,b)}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(g,S,M){S.exports=a;var e=+(Math.pow(2,27)+1);function a(n,r,t){var c=n*r,s=e*n,i=s-n,x=s-i,p=n-x,v=e*r,f=v-r,y=v-f,o=r-y,m=c-x*y,l=m-p*y,w=l-x*o,_=p*o-w;return t?(t[0]=_,t[1]=c,t):[_,c]}},{}],307:[function(g,S,M){S.exports=e;function e(a,n,r){var t=a+n,c=t-a,s=t-c,i=n-c,x=a-s;return r?(r[0]=x+i,r[1]=t,r):[x+i,t]}},{}],308:[function(g,S,M){(function(e){(function(){var a=g("bit-twiddle"),n=g("dup"),r=g("buffer").Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:n([32,0]),UINT16:n([32,0]),UINT32:n([32,0]),BIGUINT64:n([32,0]),INT8:n([32,0]),INT16:n([32,0]),INT32:n([32,0]),BIGINT64:n([32,0]),FLOAT:n([32,0]),DOUBLE:n([32,0]),DATA:n([32,0]),UINT8C:n([32,0]),BUFFER:n([32,0])});var t=typeof Uint8ClampedArray<"u",c=typeof BigUint64Array<"u",s=typeof BigInt64Array<"u",i=e.__TYPEDARRAY_POOL;i.UINT8C||(i.UINT8C=n([32,0])),i.BIGUINT64||(i.BIGUINT64=n([32,0])),i.BIGINT64||(i.BIGINT64=n([32,0])),i.BUFFER||(i.BUFFER=n([32,0]));var x=i.DATA,p=i.BUFFER;M.free=function(D){if(r.isBuffer(D))p[a.log2(D.length)].push(D);else{if(Object.prototype.toString.call(D)!=="[object ArrayBuffer]"&&(D=D.buffer),!D)return;var R=D.length||D.byteLength,O=a.log2(R)|0;x[O].push(D)}};function v(I){if(!!I){var D=I.length||I.byteLength,R=a.log2(D);x[R].push(I)}}function f(I){v(I.buffer)}M.freeUint8=M.freeUint16=M.freeUint32=M.freeBigUint64=M.freeInt8=M.freeInt16=M.freeInt32=M.freeBigInt64=M.freeFloat32=M.freeFloat=M.freeFloat64=M.freeDouble=M.freeUint8Clamped=M.freeDataView=f,M.freeArrayBuffer=v,M.freeBuffer=function(D){p[a.log2(D.length)].push(D)},M.malloc=function(D,R){if(R===void 0||R==="arraybuffer")return y(D);switch(R){case"uint8":return o(D);case"uint16":return m(D);case"uint32":return l(D);case"int8":return w(D);case"int16":return _(D);case"int32":return h(D);case"float":case"float32":return b(D);case"double":case"float64":return u(D);case"uint8_clamped":return L(D);case"bigint64":return k(D);case"biguint64":return T(D);case"buffer":return z(D);case"data":case"dataview":return P(D);default:return null}return null};function y(D){var D=a.nextPow2(D),R=a.log2(D),O=x[R];return O.length>0?O.pop():new ArrayBuffer(D)}M.mallocArrayBuffer=y;function o(I){return new Uint8Array(y(I),0,I)}M.mallocUint8=o;function m(I){return new Uint16Array(y(2*I),0,I)}M.mallocUint16=m;function l(I){return new Uint32Array(y(4*I),0,I)}M.mallocUint32=l;function w(I){return new Int8Array(y(I),0,I)}M.mallocInt8=w;function _(I){return new Int16Array(y(2*I),0,I)}M.mallocInt16=_;function h(I){return new Int32Array(y(4*I),0,I)}M.mallocInt32=h;function b(I){return new Float32Array(y(4*I),0,I)}M.mallocFloat32=M.mallocFloat=b;function u(I){return new Float64Array(y(8*I),0,I)}M.mallocFloat64=M.mallocDouble=u;function L(I){return t?new Uint8ClampedArray(y(I),0,I):o(I)}M.mallocUint8Clamped=L;function T(I){return c?new BigUint64Array(y(8*I),0,I):null}M.mallocBigUint64=T;function k(I){return s?new BigInt64Array(y(8*I),0,I):null}M.mallocBigInt64=k;function P(I){return new DataView(y(I),0,I)}M.mallocDataView=P;function z(I){I=a.nextPow2(I);var D=a.log2(I),R=p[D];return R.length>0?R.pop():new r(I)}M.mallocBuffer=z,M.clearCache=function(){for(var D=0;D<32;++D)i.UINT8[D].length=0,i.UINT16[D].length=0,i.UINT32[D].length=0,i.INT8[D].length=0,i.INT16[D].length=0,i.INT32[D].length=0,i.FLOAT[D].length=0,i.DOUBLE[D].length=0,i.BIGUINT64[D].length=0,i.BIGINT64[D].length=0,i.UINT8C[D].length=0,x[D].length=0,p[D].length=0}}).call(this)}).call(this,typeof A<"u"?A:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(g,S,M){S.exports=e;function e(n){this.roots=new Array(n),this.ranks=new Array(n);for(var r=0;r<n;++r)this.roots[r]=r,this.ranks[r]=0}var a=e.prototype;Object.defineProperty(a,"length",{get:function(){return this.roots.length}}),a.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n},a.find=function(n){for(var r=n,t=this.roots;t[n]!==n;)n=t[n];for(;t[r]!==n;){var c=t[r];t[r]=n,r=c}return n},a.link=function(n,r){var t=this.find(n),c=this.find(r);if(t!==c){var s=this.ranks,i=this.roots,x=s[t],p=s[c];x<p?i[t]=c:p<x?i[c]=t:(i[c]=t,++s[t])}}},{}],310:[function(g,S,M){function e(r,t){for(var c=1,s=r.length,i=r[0],x=r[0],p=1;p<s;++p)if(x=i,i=r[p],t(i,x)){if(p===c){c++;continue}r[c++]=i}return r.length=c,r}function a(r){for(var t=1,c=r.length,s=r[0],i=r[0],x=1;x<c;++x,i=s)if(i=s,s=r[x],s!==i){if(x===t){t++;continue}r[t++]=s}return r.length=t,r}function n(r,t,c){return r.length===0?r:t?(c||r.sort(t),e(r,t)):(c||r.sort(),a(r))}S.exports=n},{}],311:[function(g,S,M){S.exports=r;var e=g("./lib/vtext"),a=null,n=null;typeof document<"u"&&(a=document.createElement("canvas"),a.width=8192,a.height=1024,n=a.getContext("2d"));function r(t,c){return(typeof c!="object"||c===null)&&(c={}),e(t,c.canvas||a,c.context||n,c)}},{"./lib/vtext":312}],312:[function(g,S,M){S.exports=T,S.exports.processPixels=L;var e=g("surface-nets"),a=g("ndarray"),n=g("simplify-planar-graph"),r=g("clean-pslg"),t=g("cdt2d"),c=g("planar-graph-to-polyline"),s="b",i="b|",x="i",p="i|",v="sup",f="+",y="+1",o="sub",m="-",l="-1";function w(k,P,z,I){for(var D="<"+k+">",R="</"+k+">",O=D.length,F=R.length,N=P[0]===f||P[0]===m,G=0,K=-F;G>-1&&(G=z.indexOf(D,G),!(G===-1||(K=z.indexOf(R,G+O),K===-1)||K<=G));){for(var W=G;W<K+F;++W)if(W<G+O||W>=K)I[W]=null,z=z.substr(0,W)+" "+z.substr(W+1);else if(I[W]!==null){var Y=I[W].indexOf(P[0]);Y===-1?I[W]+=P:N&&(I[W]=I[W].substr(0,Y+1)+(1+parseInt(I[W][Y+1]))+I[W].substr(Y+2))}var re=G+O,ue=z.substr(re,K-re),j=ue.indexOf(D);j!==-1?G=j:G=K+F}return I}function _(k,P,z){for(var I=P.textAlign||"start",D=P.textBaseline||"alphabetic",R=[1<<30,1<<30],O=[0,0],F=k.length,N=0;N<F;++N)for(var G=k[N],K=0;K<2;++K)R[K]=Math.min(R[K],G[K])|0,O[K]=Math.max(O[K],G[K])|0;var W=0;switch(I){case"center":W=-.5*(R[0]+O[0]);break;case"right":case"end":W=-O[0];break;case"left":case"start":W=-R[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+I+"'")}var Y=0;switch(D){case"hanging":case"top":Y=-R[1];break;case"middle":Y=-.5*(R[1]+O[1]);break;case"alphabetic":case"ideographic":Y=-3*z;break;case"bottom":Y=-O[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+D+"'")}var re=1/z;return"lineHeight"in P?re*=+P.lineHeight:"width"in P?re=P.width/(O[0]-R[0]):"height"in P&&(re=P.height/(O[1]-R[1])),k.map(function(ue){return[re*(ue[0]+W),re*(ue[1]+Y)]})}function h(k,P,z,I,D,R){z=z.replace(/\n/g,""),R.breaklines===!0?z=z.replace(/\<br\>/g,`
`):z=z.replace(/\<br\>/g," ");var O="",F=[];for(U=0;U<z.length;++U)F[U]=O;R.bolds===!0&&(F=w(s,i,z,F)),R.italics===!0&&(F=w(x,p,z,F)),R.superscripts===!0&&(F=w(v,y,z,F)),R.subscripts===!0&&(F=w(o,l,z,F));var N=[],G="";for(U=0;U<z.length;++U)F[U]!==null&&(G+=z[U],N.push(F[U]));var K=G.split(`
`),W=K.length,Y=Math.round(D*I),re=I,ue=I*2,j=0,q=W*Y+ue;k.height<q&&(k.height=q),P.fillStyle="#000",P.fillRect(0,0,k.width,k.height),P.fillStyle="#fff";var V,U,$,ne,X,Q=0,ie="";function se(){if(ie!==""){var Ee=P.measureText(ie).width;P.fillText(ie,re+$,ue+ne),$+=Ee}}function ae(){return""+Math.round(X)+"px "}function oe(Ee,Pe){var Ne=""+P.font;if(R.subscripts===!0){var we=Ee.indexOf(m),ke=Pe.indexOf(m),Xe=we>-1?parseInt(Ee[1+we]):0,He=ke>-1?parseInt(Pe[1+ke]):0;Xe!==He&&(Ne=Ne.replace(ae(),"?px "),X*=Math.pow(.75,He-Xe),Ne=Ne.replace("?px ",ae())),ne+=.25*Y*(He-Xe)}if(R.superscripts===!0){var Ie=Ee.indexOf(f),De=Pe.indexOf(f),Ge=Ie>-1?parseInt(Ee[1+Ie]):0,ht=De>-1?parseInt(Pe[1+De]):0;Ge!==ht&&(Ne=Ne.replace(ae(),"?px "),X*=Math.pow(.75,ht-Ge),Ne=Ne.replace("?px ",ae())),ne-=.25*Y*(ht-Ge)}if(R.bolds===!0){var Rt=Ee.indexOf(i)>-1,Kt=Pe.indexOf(i)>-1;!Rt&&Kt&&(It?Ne=Ne.replace("italic ","italic bold "):Ne="bold "+Ne),Rt&&!Kt&&(Ne=Ne.replace("bold ",""))}if(R.italics===!0){var It=Ee.indexOf(p)>-1,Mt=Pe.indexOf(p)>-1;!It&&Mt&&(Ne="italic "+Ne),It&&!Mt&&(Ne=Ne.replace("italic ",""))}P.font=Ne}for(V=0;V<W;++V){var be=K[V]+`
`;for($=0,ne=V*Y,X=I,ie="",U=0;U<be.length;++U){var ce=U+Q<N.length?N[U+Q]:N[N.length-1];O===ce?ie+=be[U]:(se(),ie=be[U],ce!==void 0&&(oe(O,ce),O=ce))}se(),Q+=be.length;var de=Math.round($+2*re)|0;j<de&&(j=de)}var ye=j,ge=ue+Y*W,me=a(P.getImageData(0,0,ye,ge).data,[ge,ye,4]);return me.pick(-1,-1,0).transpose(1,0)}function b(k,P){var z=e(k,128);return P?n(z.cells,z.positions,.25):{edges:z.cells,positions:z.positions}}function u(k,P,z,I){var D=b(k,I),R=_(D.positions,P,z),O=D.edges,F=P.orientation==="ccw";if(r(R,O),P.polygons||P.polygon||P.polyline){for(var N=c(O,R),G=new Array(N.length),K=0;K<N.length;++K){for(var W=N[K],Y=new Array(W.length),re=0;re<W.length;++re){for(var ue=W[re],j=new Array(ue.length),q=0;q<ue.length;++q)j[q]=R[ue[q]].slice();F&&j.reverse(),Y[re]=j}G[K]=Y}return G}else return P.triangles||P.triangulate||P.triangle?{cells:t(R,O,{delaunay:!1,exterior:!1,interior:!0}),positions:R}:{edges:O,positions:R}}function L(k,P,z){try{return u(k,P,z,!0)}catch{}try{return u(k,P,z,!1)}catch{}return P.polygons||P.polyline||P.polygon?[]:P.triangles||P.triangulate||P.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}function T(k,P,z,I){var D=64,R=1.25,O={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};I&&(I.size&&I.size>0&&(D=I.size),I.lineSpacing&&I.lineSpacing>0&&(R=I.lineSpacing),I.styletags&&I.styletags.breaklines&&(O.breaklines=!!I.styletags.breaklines),I.styletags&&I.styletags.bolds&&(O.bolds=!!I.styletags.bolds),I.styletags&&I.styletags.italics&&(O.italics=!!I.styletags.italics),I.styletags&&I.styletags.subscripts&&(O.subscripts=!!I.styletags.subscripts),I.styletags&&I.styletags.superscripts&&(O.superscripts=!!I.styletags.superscripts)),z.font=[I.fontStyle,I.fontVariant,I.fontWeight,D+"px",I.font].filter(function(N){return N}).join(" "),z.textAlign="start",z.textBaseline="alphabetic",z.direction="ltr";var F=h(P,z,k,D,R,O);return L(F,I,D)}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(g,S,M){(function(){if(typeof ses<"u"&&ses.ok&&!ses.ok())return;function a(L){L.permitHostObjects___&&L.permitHostObjects___(a)}typeof ses<"u"&&(ses.weakMapPermitHostObjects=a);var n=!1;if(typeof WeakMap=="function"){var r=WeakMap;if(!(typeof navigator<"u"&&/Firefox/.test(navigator.userAgent))){var t=new r,c=Object.freeze({});if(t.set(c,1),t.get(c)!==1)n=!0;else{S.exports=WeakMap;return}}}var s=Object.getOwnPropertyNames,i=Object.defineProperty,x=Object.isExtensible,p="weakmap:",v=p+"ident:"+Math.random()+"___";if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var f=new ArrayBuffer(25),y=new Uint8Array(f);crypto.getRandomValues(y),v=p+"rand:"+Array.prototype.map.call(y,function(L){return(L%36).toString(36)}).join("")+"___"}function o(L){return!(L.substr(0,p.length)==p&&L.substr(L.length-3)==="___")}if(i(Object,"getOwnPropertyNames",{value:function(T){return s(T).filter(o)}}),"getPropertyNames"in Object){var m=Object.getPropertyNames;i(Object,"getPropertyNames",{value:function(T){return m(T).filter(o)}})}function l(L){if(L!==Object(L))throw new TypeError("Not an object: "+L);var T=L[v];if(T&&T.key===L)return T;if(!!x(L)){T={key:L};try{return i(L,v,{value:T,writable:!1,enumerable:!1,configurable:!1}),T}catch{return}}}(function(){var L=Object.freeze;i(Object,"freeze",{value:function(z){return l(z),L(z)}});var T=Object.seal;i(Object,"seal",{value:function(z){return l(z),T(z)}});var k=Object.preventExtensions;i(Object,"preventExtensions",{value:function(z){return l(z),k(z)}})})();function w(L){return L.prototype=null,Object.freeze(L)}var _=!1;function h(){!_&&typeof console<"u"&&(_=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}var b=0,u=function(){this instanceof u||h();var L=[],T=[],k=b++;function P(R,O){var F,N=l(R);return N?k in N?N[k]:O:(F=L.indexOf(R),F>=0?T[F]:O)}function z(R){var O=l(R);return O?k in O:L.indexOf(R)>=0}function I(R,O){var F,N=l(R);return N?N[k]=O:(F=L.indexOf(R),F>=0?T[F]=O:(F=L.length,T[F]=O,L[F]=R)),this}function D(R){var O=l(R),F,N;return O?k in O&&delete O[k]:(F=L.indexOf(R),F<0?!1:(N=L.length-1,L[F]=void 0,T[F]=T[N],L[F]=L[N],L.length=N,T.length=N,!0))}return Object.create(u.prototype,{get___:{value:w(P)},has___:{value:w(z)},set___:{value:w(I)},delete___:{value:w(D)}})};u.prototype=Object.create(Object.prototype,{get:{value:function(T,k){return this.get___(T,k)},writable:!0,configurable:!0},has:{value:function(T){return this.has___(T)},writable:!0,configurable:!0},set:{value:function(T,k){return this.set___(T,k)},writable:!0,configurable:!0},delete:{value:function(T){return this.delete___(T)},writable:!0,configurable:!0}}),typeof r=="function"?function(){n&&typeof Proxy<"u"&&(Proxy=void 0);function L(){this instanceof u||h();var T=new r,k=void 0,P=!1;function z(O,F){return k?T.has(O)?T.get(O):k.get___(O,F):T.get(O,F)}function I(O){return T.has(O)||(k?k.has___(O):!1)}var D;n?D=function(O,F){return T.set(O,F),T.has(O)||(k||(k=new u),k.set(O,F)),this}:D=function(O,F){if(P)try{T.set(O,F)}catch{k||(k=new u),k.set___(O,F)}else T.set(O,F);return this};function R(O){var F=!!T.delete(O);return k&&k.delete___(O)||F}return Object.create(u.prototype,{get___:{value:w(z)},has___:{value:w(I)},set___:{value:w(D)},delete___:{value:w(R)},permitHostObjects___:{value:w(function(O){if(O===a)P=!0;else throw new Error("bogus call to permitHostObjects___")})}})}L.prototype=u.prototype,S.exports=L,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy<"u"&&(Proxy=void 0),S.exports=u)})()},{}],314:[function(g,S,M){var e=g("./hidden-store.js");S.exports=a;function a(){var n={};return function(r){if((typeof r!="object"||r===null)&&typeof r!="function")throw new Error("Weakmap-shim: Key must be object");var t=r.valueOf(n);return t&&t.identity===n?t:e(r,n)}}},{"./hidden-store.js":315}],315:[function(g,S,M){S.exports=e;function e(a,n){var r={identity:n},t=a.valueOf;return Object.defineProperty(a,"valueOf",{value:function(c){return c!==n?t.apply(this,arguments):r},writable:!0}),r}},{}],316:[function(g,S,M){var e=g("./create-store.js");S.exports=a;function a(){var n=e();return{get:function(r,t){var c=n(r);return c.hasOwnProperty("value")?c.value:t},set:function(r,t){return n(r).value=t,this},has:function(r){return"value"in n(r)},delete:function(r){return delete n(r).value}}}},{"./create-store.js":314}],317:[function(g,S,M){function e(){return function(s,i,x,p,v,f){var y=s[0],o=x[0],m=[0],l=o;p|=0;var w=0,_=o;for(w=0;w<y;++w){{var h=i[p]-f,b=i[p+l]-f;h>=0!=b>=0&&v.push(m[0]+.5+.5*(h+b)/(h-b))}p+=_,++m[0]}}}function a(){return e()}var n=a;function r(s){var i={};return function(p,v,f){var y=p.dtype,o=p.order,m=[y,o.join()].join(),l=i[m];return l||(i[m]=l=s([y,o])),l(p.shape.slice(0),p.data,p.stride,p.offset|0,v,f)}}function t(s){return r(n.bind(void 0,s))}function c(s){return t({funcName:s.funcName})}S.exports=c({funcName:"zeroCrossings"})},{}],318:[function(g,S,M){S.exports=a;var e=g("./lib/zc-core");function a(n,r){var t=[];return r=+r||0,e(n.hi(n.shape[0]-1),t,r),t}},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,typeof Mo<"u"?Mo:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[27])(27)})})(sp);const ag=ng(sp.exports);class ig extends rc{constructor(){super(rg)}async validateData(){var A,g;let Ii=await this.dataLoaderFn(),d=Ii.x!==void 0&&Ii.y!==void 0,ee=((A=Ii.x)==null?void 0:A.length)===((g=Ii.y)==null?void 0:g.length);d&&ee?this.data=Ii:this.displayError("Data format error","data loader function returns data in invalid format")}analyzeAndVisualizeData(){let Ii=[{x:this.data.x,y:this.data.y,type:"scatter",mode:"markers",marker:{size:12}}],d={title:"Scatter plot example"},ee={scrollZoom:!0,displayModeBar:!1};ag.newPlot(this.plotSpace,Ii,d,ee)}}window.addEventListener("load",()=>{window.customElements.define("scatter-plot",ig)});
